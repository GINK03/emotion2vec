{"context": " More than 1 year has passed since last update.\n\n\u660e\u65e5\u6674\u308c\u308b\u304b\u306a\n\u6bce\u6669\u660e\u65e5\u306e\u5929\u6c17\u3092\u901a\u77e5\u3057\u3066\u304f\u308c\u308b\u3068\u4fbf\u5229\u3060\u3068\u601d\u3063\u3066\u2026\n\nlivedoor\u5929\u6c17API\u306e\u4ed5\u69d8\nhttp://weather.livedoor.com/weather_hacks/webservice\n\n\uff08\u4f8b\uff09\u300c\u798f\u5ca1\u770c\u30fb\u4e45\u7559\u7c73\u306e\u5929\u6c17\u300d\u3092\u53d6\u5f97\u3059\u308b\u5834\u5408\n\u4e0b\u8a18URL\u306b\u30a2\u30af\u30bb\u30b9\u3057\u3066JSON\u30c7\u30fc\u30bf\u3092\u53d6\u5f97\u3057\u307e\u3059\u3002\n\u57fa\u672cURL + \u4e45\u7559\u7c73\u306eID\uff08400040\uff09\nhttp://weather.livedoor.com/forecast/webservice/json/v1?city=400040\n\n\nphp\u3067chatwork\u3078\u6295\u7a3f\u3059\u308b\n\nchatwork\n<?php\n\n  $cityid = \u53d6\u5f97\u3057\u305f\u3044\u5730\u533a\u306eID;\n  $url = 'http://weather.livedoor.com/forecast/webservice/json/v1?city='.$cityid.'';\n  $json = file_get_contents($url, true);\n  $json = json_decode($json, true);\n\n  // Public\n  $title = $json['title'];\n  $description = $json['description']['text'];\n  $publicTime = $json['publicTime'];\n  $copyright = $json['copyright']['title'];\n  $copyrightLink = 'http://weather.livedoor.com/area/forecast/';\n  //$json['copyright']['link']\n\n  // Location\n  $city = $json['location']['city'];                \n  $area = $json['location']['area'];               \n  $prefecture = $json['location']['prefecture'];    \n  $link = $json['link'];\n  $pinpoint = $json['pinpointLocations'];\n\n\n  //forecasts\n  foreach ($json['forecasts'] as $entry) {\n    $dateLabel = $entry['dateLabel'];                               \n    $telop = $entry['telop'];                                       \n    $date = $entry['date'];                                         \n    $min = $entry['temperature']['min'];                            \n    $max = $entry['temperature']['max'];                            \n    $mincelsius = $entry['temperature']['min'][\"celsius\"];          \n    $minfahrenheit = $entry['temperature']['min'][\"fahrenheit\"];    \n    $maxcelsius = $entry['temperature']['max'][\"celsius\"];          \n    $maxfahrenheit = $entry['temperature']['max'][\"fahrenheit\"];    \n    $image = $entry['image'][\"url\"];                               \n\n    // NULL\n    if (!isset($min)) { $mincelsius = \"--\"; }\n    if (!isset($max)) { $maxcelsius = \"--\"; }\n    if (!isset($celsius)) { $min = \"--\"; }\n    if (!isset($fahrenheit)) { $min = \"--\"; }\n\n    }\n\n    $forecasts = $json['forecasts'];\n\n    $body  = \"\";\n    $body .= \"[info][title]\u660e\u65e5\".$forecasts[1]['date'].\"\u306e\u304a\u5929\u6c17[/title]\".\n             \"\u660e\u65e5\u306f\u300e\".$forecasts[1]['telop'].\"\u300f\\n\".\n             \"\u6700\u9ad8\u6c17\u6e29\".$forecasts[1]['temperature']['max'][\"celsius\"].\"\u2103\\n\".\n             \"\u6700\u4f4e\u6c17\u6e29\".$forecasts[1]['temperature']['min'][\"celsius\"].\"\u2103\\n\".\n             \"\u00a9\".$copyrightLink;\n             \"[/info]\".\"\\n\".\n    $option = array('body' => $body);\n    $ch = curl_init();\n    /*\u8868\u793a\u3055\u305b\u305f\u3044\u30c1\u30e3\u30c3\u30c8\u306e\u30eb\u30fc\u30e0ID*/\n    $room_id = 000000;\n    curl_setopt($ch, CURLOPT_URL, 'https://api.chatwork.com/v1/rooms/'.$room_id.'/messages');\n    curl_setopt($ch, CURLOPT_HTTPHEADER, array('X-ChatWorkToken:\u30c1\u30e3\u30c3\u30c8\u30ef\u30fc\u30af\u306eAPI\u30ad\u30fc'));\n    curl_setopt($ch, CURLOPT_POST, true);\n    curl_setopt($ch, CURLOPT_POSTFIELDS, http_build_query($option, '', '&'));\n    $response = curl_exec($ch);\n    curl_close($ch);\n\n\n\ncron\u3067\u6bce\u6669\u5b9a\u523b\u306bphp\u3092\u8d77\u52d5\n\u30ec\u30f3\u30bf\u30eb\u30b5\u30fc\u30d0\u3060\u3063\u305f\u3089\u30b3\u30f3\u30d1\u30cd\u304b\u3089\u7c21\u5358\u306b\u8a2d\u5b9a\u3067\u304d\u308b\uff08\u306f\u305a\uff09\n\u3055\u304f\u3089\u30b5\u30fc\u30d0\u3067\u306f\u3067\u304d\u307e\u3057\u305f\u3002\n\n\u30a4\u30e1\u30fc\u30b8\n\n\n\u53c2\u8003\u30b5\u30a4\u30c8\n\u304a\u5929\u6c17\u60c5\u5831 API Weather Hacks \u3092 PHP \u3067\u4f7f\u3063\u3066\u307f\u305f\nwebrawl\u69d8\u3001Livedoor\u5929\u6c17\u90e8\u5206\u30d1\u30af\u3089\u53c2\u8003\u306b\u3055\u305b\u3066\u9802\u304d\u307e\u3057\u305f\u3002\n#\u660e\u65e5\u6674\u308c\u308b\u304b\u306a\n\u6bce\u6669\u660e\u65e5\u306e\u5929\u6c17\u3092\u901a\u77e5\u3057\u3066\u304f\u308c\u308b\u3068\u4fbf\u5229\u3060\u3068\u601d\u3063\u3066\u2026\n\n#livedoor\u5929\u6c17API\u306e\u4ed5\u69d8\nhttp://weather.livedoor.com/weather_hacks/webservice\n\n>\uff08\u4f8b\uff09\u300c\u798f\u5ca1\u770c\u30fb\u4e45\u7559\u7c73\u306e\u5929\u6c17\u300d\u3092\u53d6\u5f97\u3059\u308b\u5834\u5408\n>\u4e0b\u8a18URL\u306b\u30a2\u30af\u30bb\u30b9\u3057\u3066JSON\u30c7\u30fc\u30bf\u3092\u53d6\u5f97\u3057\u307e\u3059\u3002\n>\u57fa\u672cURL + \u4e45\u7559\u7c73\u306eID\uff08400040\uff09\n>http://weather.livedoor.com/forecast/webservice/json/v1?city=400040\n\n#php\u3067chatwork\u3078\u6295\u7a3f\u3059\u308b\n```php:chatwork\n<?php\n\n  $cityid = \u53d6\u5f97\u3057\u305f\u3044\u5730\u533a\u306eID;\n  $url = 'http://weather.livedoor.com/forecast/webservice/json/v1?city='.$cityid.'';\n  $json = file_get_contents($url, true);\n  $json = json_decode($json, true);\n \n  // Public\n  $title = $json['title'];\n  $description = $json['description']['text'];\n  $publicTime = $json['publicTime'];\n  $copyright = $json['copyright']['title'];\n  $copyrightLink = 'http://weather.livedoor.com/area/forecast/';\n  //$json['copyright']['link']\n \n  // Location\n  $city = $json['location']['city'];                \n  $area = $json['location']['area'];               \n  $prefecture = $json['location']['prefecture'];    \n  $link = $json['link'];\n  $pinpoint = $json['pinpointLocations'];\n\n  \n  //forecasts\n  foreach ($json['forecasts'] as $entry) {\n    $dateLabel = $entry['dateLabel'];                               \n    $telop = $entry['telop'];                                       \n    $date = $entry['date'];                                         \n    $min = $entry['temperature']['min'];                            \n    $max = $entry['temperature']['max'];                            \n    $mincelsius = $entry['temperature']['min'][\"celsius\"];          \n    $minfahrenheit = $entry['temperature']['min'][\"fahrenheit\"];    \n    $maxcelsius = $entry['temperature']['max'][\"celsius\"];          \n    $maxfahrenheit = $entry['temperature']['max'][\"fahrenheit\"];    \n    $image = $entry['image'][\"url\"];                               \n \n    // NULL\n    if (!isset($min)) { $mincelsius = \"--\"; }\n    if (!isset($max)) { $maxcelsius = \"--\"; }\n    if (!isset($celsius)) { $min = \"--\"; }\n    if (!isset($fahrenheit)) { $min = \"--\"; }\n    \n    }\n    \n    $forecasts = $json['forecasts'];\n    \n    $body  = \"\";\n    $body .= \"[info][title]\u660e\u65e5\".$forecasts[1]['date'].\"\u306e\u304a\u5929\u6c17[/title]\".\n             \"\u660e\u65e5\u306f\u300e\".$forecasts[1]['telop'].\"\u300f\\n\".\n             \"\u6700\u9ad8\u6c17\u6e29\".$forecasts[1]['temperature']['max'][\"celsius\"].\"\u2103\\n\".\n             \"\u6700\u4f4e\u6c17\u6e29\".$forecasts[1]['temperature']['min'][\"celsius\"].\"\u2103\\n\".\n             \"\u00a9\".$copyrightLink;\n             \"[/info]\".\"\\n\".\n    $option = array('body' => $body);\n    $ch = curl_init();\n    /*\u8868\u793a\u3055\u305b\u305f\u3044\u30c1\u30e3\u30c3\u30c8\u306e\u30eb\u30fc\u30e0ID*/\n    $room_id = 000000;\n    curl_setopt($ch, CURLOPT_URL, 'https://api.chatwork.com/v1/rooms/'.$room_id.'/messages');\n    curl_setopt($ch, CURLOPT_HTTPHEADER, array('X-ChatWorkToken:\u30c1\u30e3\u30c3\u30c8\u30ef\u30fc\u30af\u306eAPI\u30ad\u30fc'));\n    curl_setopt($ch, CURLOPT_POST, true);\n    curl_setopt($ch, CURLOPT_POSTFIELDS, http_build_query($option, '', '&'));\n    $response = curl_exec($ch);\n    curl_close($ch);\n```\n\n#cron\u3067\u6bce\u6669\u5b9a\u523b\u306bphp\u3092\u8d77\u52d5\n\u30ec\u30f3\u30bf\u30eb\u30b5\u30fc\u30d0\u3060\u3063\u305f\u3089\u30b3\u30f3\u30d1\u30cd\u304b\u3089\u7c21\u5358\u306b\u8a2d\u5b9a\u3067\u304d\u308b\uff08\u306f\u305a\uff09\n\u3055\u304f\u3089\u30b5\u30fc\u30d0\u3067\u306f\u3067\u304d\u307e\u3057\u305f\u3002\n\n#\u30a4\u30e1\u30fc\u30b8\n![tenki.jpg](https://qiita-image-store.s3.amazonaws.com/0/38503/df2b207b-a2b3-1f65-e54b-5edeb5fa5d18.jpeg)\n\n\n#\u53c2\u8003\u30b5\u30a4\u30c8\n[\u304a\u5929\u6c17\u60c5\u5831 API Weather Hacks \u3092 PHP \u3067\u4f7f\u3063\u3066\u307f\u305f](http://webrawl.org/weather-haks-api/)\n\nwebrawl\u69d8\u3001Livedoor\u5929\u6c17\u90e8\u5206~~\u30d1\u30af\u3089~~\u53c2\u8003\u306b\u3055\u305b\u3066\u9802\u304d\u307e\u3057\u305f\u3002\n", "tags": ["PHP", "chatwork"]}