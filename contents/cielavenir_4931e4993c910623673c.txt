{"context": " More than 1 year has passed since last update.\npemmerge.rb\n#!/usr/bin/ruby\n\n#PEMMerge: concatenate PEMs in a file.\n#Output formatting is based on:\n#http://wiki.cementhorizon.com/display/CH/Convert+PEM+Certificate+to+ca-bundle.crt+format\n\nrequire 'openssl'\ncerts=[]\ncert_str=''\nin_cert=false\n$<.each{|line|\n    if line.chomp=='-----BEGIN CERTIFICATE-----'\n        in_cert=true\n    end\n    cert_str<<line if in_cert\n    if line.chomp=='-----END CERTIFICATE-----'\n        certs<<cert_str\n        in_cert=false\n        cert_str=''\n    end\n}\ncerts.uniq{|e|e[1...-1].tr(\"\\n\",'')}.each{|e|\n    cert=OpenSSL::X509::Certificate.new(e)\n    h=Hash[*cert.issuer.to_a.map{|a,b,*c|[a,b]}.flatten(1)]\n    name=h['CN']||h['OU']||h['O']\n    puts name\n    puts '='*name.size\n    #puts 'MD5 Fingerprint: '+Digest::MD5.hexdigest(cert.to_der).upcase.scan(/../).join(':')\n    #puts 'SHA1 Fingerprint: '+Digest::SHA1.hexdigest(cert.to_der).upcase.scan(/../).join(':')\n    #puts 'PEM Data:'\n    puts cert.to_s\n    #puts cert.to_text.sub('Certificate:','Certificate Ingredients:')\n    puts\n}\n\n\n#In (at least) Vine Linux, this merged curl-ca-bundle.crt is required to support both bitbucket and codebreak.\nwget http://curl.haxx.se/ca/cacert.pem\nwget -O novell.crt http://support.novell.com/products/desktop/curl-ca-bundle.crt\nruby pemmerge.rb cacert.pem novell.crt > curl-ca-bundle.crt\n\n```rb:pemmerge.rb\n#!/usr/bin/ruby\n\n#PEMMerge: concatenate PEMs in a file.\n#Output formatting is based on:\n#http://wiki.cementhorizon.com/display/CH/Convert+PEM+Certificate+to+ca-bundle.crt+format\n\nrequire 'openssl'\ncerts=[]\ncert_str=''\nin_cert=false\n$<.each{|line|\n\tif line.chomp=='-----BEGIN CERTIFICATE-----'\n\t\tin_cert=true\n\tend\n\tcert_str<<line if in_cert\n\tif line.chomp=='-----END CERTIFICATE-----'\n\t\tcerts<<cert_str\n\t\tin_cert=false\n\t\tcert_str=''\n\tend\n}\ncerts.uniq{|e|e[1...-1].tr(\"\\n\",'')}.each{|e|\n\tcert=OpenSSL::X509::Certificate.new(e)\n\th=Hash[*cert.issuer.to_a.map{|a,b,*c|[a,b]}.flatten(1)]\n\tname=h['CN']||h['OU']||h['O']\n\tputs name\n\tputs '='*name.size\n\t#puts 'MD5 Fingerprint: '+Digest::MD5.hexdigest(cert.to_der).upcase.scan(/../).join(':')\n\t#puts 'SHA1 Fingerprint: '+Digest::SHA1.hexdigest(cert.to_der).upcase.scan(/../).join(':')\n\t#puts 'PEM Data:'\n\tputs cert.to_s\n\t#puts cert.to_text.sub('Certificate:','Certificate Ingredients:')\n\tputs\n}\n```\n\n```\n#In (at least) Vine Linux, this merged curl-ca-bundle.crt is required to support both bitbucket and codebreak.\nwget http://curl.haxx.se/ca/cacert.pem\nwget -O novell.crt http://support.novell.com/products/desktop/curl-ca-bundle.crt\nruby pemmerge.rb cacert.pem novell.crt > curl-ca-bundle.crt\n```\n", "tags": ["Ruby", "openssl"]}