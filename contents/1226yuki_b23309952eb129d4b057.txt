{"context": "KiiCloud\u306e\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb\u3092\u7de8\u96c6\u3057\u3066\u3001\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3059\u308bbitmap\u306e\u30b5\u30a4\u30ba\u3092\u534a\u5206\u306b\u3059\u308b\u65b9\u6cd5\u3002\n\nPostActivity.java\n//uri\u304b\u3089\u30d5\u30a1\u30a4\u30eb\u306e\u30d1\u30b9\u3092\u53d6\u5f97\u3059\u308b\u3002\u30d0\u30fc\u30b8\u30e7\u30f3\u306b\u3088\u3063\u3066\u51e6\u7406\u304c\u9055\u3046\u3002\n//KiiCloud\u306e\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb\u304b\u3089\u53d6\u308a\u8fbc\u3093\u3060\u3002\u6c4e\u7528\u7684\u306b\u4f7f\u3048\u307e\u3059\u3002\n    private String getFilePathByUri(Uri selectedFileUri) {\n        //4.2\u4ee5\u964d\u306e\u6642\n        if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.JELLY_BEAN_MR1) {\n            // Workaround of retrieving file image through ContentResolver\n            // for Android4.2 or later\n            String filePath = null;\n            FileOutputStream fos = null;\n            try {\n                //\u30d3\u30c3\u30c8\u30de\u30c3\u30d7\u306e\u5909\u63db\u30b5\u30a4\u30ba\u3092\u5b9a\u7fa9\n                Matrix varMat = new Matrix();\n                varMat.postScale(0.5F, 0.5F);\n                //\u30d3\u30c3\u30c8\u30de\u30c3\u30d7\u3092\u53d6\u5f97\n                Bitmap bmp = MediaStore.Images.Media.getBitmap(\n                        this.getContentResolver(), selectedFileUri);\n                //\u30d3\u30c3\u30c8\u30de\u30c3\u30d7\u3092\u5b9a\u7fa9\u3057\u305f\u30b5\u30a4\u30ba\u306b\u5909\u63db\n                Bitmap bmp2 = Bitmap.createBitmap(\n                        bmp, 0, 0,\n                        bmp.getWidth(),\n                        bmp.getHeight(),\n                        varMat, true\n                );\n                //\u4e00\u6642\u4fdd\u5b58\u3059\u308b\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3002\u30a2\u30d7\u30ea\u306b\u5fdc\u3058\u3066app\u306e\u90e8\u5206\u3092\u5909\u66f4\u3057\u305f\u307b\u3046\u304c\u826f\u3044\n                String cacheDir = Environment.getExternalStorageDirectory()\n                        .getAbsolutePath() + File.separator + \"app\";\n                //\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u4f5c\u6210\n                File createDir = new File(cacheDir);\n                if (!createDir.exists()) {\n                    createDir.mkdir();\n                }\n                //\u4e00\u6642\u30d5\u30a1\u30a4\u30eb\u540d\u3092\u4f5c\u6210\u3002\u6bce\u56de\u4e0a\u66f8\u304d\n                filePath = cacheDir + File.separator + \"upload.jpg\";\n                File file = new File(filePath);\n                //\u30d3\u30c3\u30c8\u30de\u30c3\u30d7\u3092jpg\u306b\u5909\u63db\u3057\u3066\u4e00\u6642\u7684\u306b\u4fdd\u5b58\u3059\u308b\u3002\n                fos = new FileOutputStream(file);\n                bmp2.compress(Bitmap.CompressFormat.JPEG, 95, fos);\n                fos.flush();\n                fos.getFD().sync();\n            } catch (Exception e) {\n                filePath = null;\n            } finally {//\u304b\u306a\u3089\u305a\u6700\u5f8c\u306b\u5b9f\u884c\u3059\u308b\u51e6\u7406\n                if (fos != null) {\n                    try {\n                        //\u30d5\u30a1\u30a4\u30eb\u3092\u9589\u3058\u308b\n                        fos.close();\n                    } catch (Exception e) {\n                        // Nothing to do\n                    }\n                }\n            }\n            return filePath;\n        } \n\n\n\nKiiCloud\u306e\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb\u3092\u7de8\u96c6\u3057\u3066\u3001\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3059\u308bbitmap\u306e\u30b5\u30a4\u30ba\u3092\u534a\u5206\u306b\u3059\u308b\u65b9\u6cd5\u3002\n\n\n```java:PostActivity.java\n//uri\u304b\u3089\u30d5\u30a1\u30a4\u30eb\u306e\u30d1\u30b9\u3092\u53d6\u5f97\u3059\u308b\u3002\u30d0\u30fc\u30b8\u30e7\u30f3\u306b\u3088\u3063\u3066\u51e6\u7406\u304c\u9055\u3046\u3002\n//KiiCloud\u306e\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb\u304b\u3089\u53d6\u308a\u8fbc\u3093\u3060\u3002\u6c4e\u7528\u7684\u306b\u4f7f\u3048\u307e\u3059\u3002\n    private String getFilePathByUri(Uri selectedFileUri) {\n        //4.2\u4ee5\u964d\u306e\u6642\n        if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.JELLY_BEAN_MR1) {\n            // Workaround of retrieving file image through ContentResolver\n            // for Android4.2 or later\n            String filePath = null;\n            FileOutputStream fos = null;\n            try {\n                //\u30d3\u30c3\u30c8\u30de\u30c3\u30d7\u306e\u5909\u63db\u30b5\u30a4\u30ba\u3092\u5b9a\u7fa9\n                Matrix varMat = new Matrix();\n                varMat.postScale(0.5F, 0.5F);\n                //\u30d3\u30c3\u30c8\u30de\u30c3\u30d7\u3092\u53d6\u5f97\n                Bitmap bmp = MediaStore.Images.Media.getBitmap(\n                        this.getContentResolver(), selectedFileUri);\n                //\u30d3\u30c3\u30c8\u30de\u30c3\u30d7\u3092\u5b9a\u7fa9\u3057\u305f\u30b5\u30a4\u30ba\u306b\u5909\u63db\n                Bitmap bmp2 = Bitmap.createBitmap(\n                        bmp, 0, 0,\n                        bmp.getWidth(),\n                        bmp.getHeight(),\n                        varMat, true\n                );\n                //\u4e00\u6642\u4fdd\u5b58\u3059\u308b\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3002\u30a2\u30d7\u30ea\u306b\u5fdc\u3058\u3066app\u306e\u90e8\u5206\u3092\u5909\u66f4\u3057\u305f\u307b\u3046\u304c\u826f\u3044\n                String cacheDir = Environment.getExternalStorageDirectory()\n                        .getAbsolutePath() + File.separator + \"app\";\n                //\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u4f5c\u6210\n                File createDir = new File(cacheDir);\n                if (!createDir.exists()) {\n                    createDir.mkdir();\n                }\n                //\u4e00\u6642\u30d5\u30a1\u30a4\u30eb\u540d\u3092\u4f5c\u6210\u3002\u6bce\u56de\u4e0a\u66f8\u304d\n                filePath = cacheDir + File.separator + \"upload.jpg\";\n                File file = new File(filePath);\n                //\u30d3\u30c3\u30c8\u30de\u30c3\u30d7\u3092jpg\u306b\u5909\u63db\u3057\u3066\u4e00\u6642\u7684\u306b\u4fdd\u5b58\u3059\u308b\u3002\n                fos = new FileOutputStream(file);\n                bmp2.compress(Bitmap.CompressFormat.JPEG, 95, fos);\n                fos.flush();\n                fos.getFD().sync();\n            } catch (Exception e) {\n                filePath = null;\n            } finally {//\u304b\u306a\u3089\u305a\u6700\u5f8c\u306b\u5b9f\u884c\u3059\u308b\u51e6\u7406\n                if (fos != null) {\n                    try {\n                        //\u30d5\u30a1\u30a4\u30eb\u3092\u9589\u3058\u308b\n                        fos.close();\n                    } catch (Exception e) {\n                        // Nothing to do\n                    }\n                }\n            }\n            return filePath;\n        } \n\n```\n\n", "tags": ["AndroidStudio", "postScale", "bitmap", "KiiCloud"]}