{"context": " More than 1 year has passed since last update.\u521d\u56de\u30a2\u30af\u30bb\u30b9\u6642\u306f\u30bb\u30c3\u30b7\u30e7\u30f3\u7dad\u6301\u306bcookie\u304c\u4f7f\u3048\u308b\u304b\u5224\u65ad\u3067\u304d\u305a\u3001\u57cb\u3081\u8fbc\u3080URL\u306b\u30bb\u30c3\u30b7\u30e7\u30f3ID\u3092\u5165\u308c\u308b\u52d5\u304d\u3092\u3057\u307e\u3059\u3002\n\u30d5\u30ec\u30fc\u30e0\u30ef\u30fc\u30af\u3084JSTL\u3067\u4f7f\u7528\u3055\u308c\u308bencodeURL\u306e\u7d50\u679c\u306bjsessionid\u304c\u542b\u307e\u308c\u308b\u306e\u3067\n\u305d\u306e\u7d50\u679c\u304b\u3089jsessionid\u3092\u7121\u7406\u3084\u308a\u6d88\u3059\u5f62\u3067\u5bfe\u5fdc\u3002\n\nCutJsessionidFilter.java\npackage ex.web.interceptor;\n\nimport java.io.IOException;\n\nimport javax.servlet.Filter;\nimport javax.servlet.FilterChain;\nimport javax.servlet.FilterConfig;\nimport javax.servlet.ServletException;\nimport javax.servlet.ServletRequest;\nimport javax.servlet.ServletResponse;\nimport javax.servlet.http.HttpServletResponse;\nimport javax.servlet.http.HttpServletResponseWrapper;\n\npublic class CutJsessionidFilter implements Filter {\n\n    private static class CutJsessionidResponseWrapper extends\n            HttpServletResponseWrapper {\n\n        public CutJsessionidResponseWrapper(final HttpServletResponse response) {\n            super(response);\n        }\n\n        @Override\n        public String encodeURL(final String url) {\n            String encurl = super.encodeURL(url).replaceAll(\n                    \";jsessionid=[0-9a-zA-Z]+\", \"\");\n            return encurl;\n        }\n    }\n\n    @Override\n    public void init(final FilterConfig filterConfig) throws ServletException {\n\n    }\n\n    @Override\n    public void doFilter(final ServletRequest request,\n            final ServletResponse response, final FilterChain chain)\n            throws IOException, ServletException {\n        if (response instanceof HttpServletResponse\n                && !(response instanceof CutJsessionidResponseWrapper)) {\n            chain.doFilter(request, new CutJsessionidResponseWrapper(\n                    (HttpServletResponse) response));\n            return;\n        }\n        chain.doFilter(request, response);\n    }\n\n    @Override\n    public void destroy() {\n    }\n}\n\n\n\nweb.xml\n<filter>\n  <filter-name>cutJsessionidFilter</filter-name>\n  <filter-class>ex.web.interceptor.CutJsessionidFilter</filter-class>\n</filter>\n\n<filter-mapping>\n  <filter-name>cutJsessionidFilter</filter-name>\n  <url-pattern>/*</url-pattern>\n  <dispatcher>REQUEST</dispatcher>\n  <dispatcher>INCLUDE</dispatcher>\n</filter-mapping>\n\n\nJSP\u3067\u8272\u3005\u3084\u3063\u3066\u3044\u308b\u5834\u5408\u306fINCLUDE\u306e\u6307\u5b9a\u3082\u5fc5\u8981\u306b\u306a\u308b\u5834\u5408\u304c\u3042\u308a\u307e\u3059\u3002\nApache Tiles \u3092\u4f7f\u7528\u3057\u3066\u304a\u308a\u3001\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u304b\u3089JSP\u3092\u57cb\u3081\u8fbc\u3093\u3067\u3044\u305f\u305f\u3081\u5bfe\u5fdc\u304c\u5fc5\u8981\u3067\u3057\u305f\u3002\n\u61d0\u304b\u3057\u3055\u3082\u3042\u308b\u8a71\u304b\u3068\u601d\u3044\u307e\u3059\u304c\u3001Tiles\u306e\u7f60\u306b\u6c17\u3065\u304b\u305a\u610f\u5916\u3068\u6642\u9593\u3092\u53d6\u3089\u308c\u305f\u306e\u3067\u3002\n\u7d50\u8ad6\nServlet 3.0\u3092\u4f7f\u304a\u3046\uff01\n\u521d\u56de\u30a2\u30af\u30bb\u30b9\u6642\u306f\u30bb\u30c3\u30b7\u30e7\u30f3\u7dad\u6301\u306bcookie\u304c\u4f7f\u3048\u308b\u304b\u5224\u65ad\u3067\u304d\u305a\u3001\u57cb\u3081\u8fbc\u3080URL\u306b\u30bb\u30c3\u30b7\u30e7\u30f3ID\u3092\u5165\u308c\u308b\u52d5\u304d\u3092\u3057\u307e\u3059\u3002\n\n\u30d5\u30ec\u30fc\u30e0\u30ef\u30fc\u30af\u3084JSTL\u3067\u4f7f\u7528\u3055\u308c\u308bencodeURL\u306e\u7d50\u679c\u306bjsessionid\u304c\u542b\u307e\u308c\u308b\u306e\u3067\n\u305d\u306e\u7d50\u679c\u304b\u3089jsessionid\u3092\u7121\u7406\u3084\u308a\u6d88\u3059\u5f62\u3067\u5bfe\u5fdc\u3002\n\n\n```java:CutJsessionidFilter.java\npackage ex.web.interceptor;\n\nimport java.io.IOException;\n\nimport javax.servlet.Filter;\nimport javax.servlet.FilterChain;\nimport javax.servlet.FilterConfig;\nimport javax.servlet.ServletException;\nimport javax.servlet.ServletRequest;\nimport javax.servlet.ServletResponse;\nimport javax.servlet.http.HttpServletResponse;\nimport javax.servlet.http.HttpServletResponseWrapper;\n\npublic class CutJsessionidFilter implements Filter {\n\n    private static class CutJsessionidResponseWrapper extends\n            HttpServletResponseWrapper {\n\n        public CutJsessionidResponseWrapper(final HttpServletResponse response) {\n            super(response);\n        }\n\n        @Override\n        public String encodeURL(final String url) {\n            String encurl = super.encodeURL(url).replaceAll(\n                    \";jsessionid=[0-9a-zA-Z]+\", \"\");\n            return encurl;\n        }\n    }\n\n    @Override\n    public void init(final FilterConfig filterConfig) throws ServletException {\n\n    }\n\n    @Override\n    public void doFilter(final ServletRequest request,\n            final ServletResponse response, final FilterChain chain)\n            throws IOException, ServletException {\n        if (response instanceof HttpServletResponse\n                && !(response instanceof CutJsessionidResponseWrapper)) {\n            chain.doFilter(request, new CutJsessionidResponseWrapper(\n                    (HttpServletResponse) response));\n            return;\n        }\n        chain.doFilter(request, response);\n    }\n\n    @Override\n    public void destroy() {\n    }\n}\n```\n\n```xml:web.xml\n<filter>\n  <filter-name>cutJsessionidFilter</filter-name>\n  <filter-class>ex.web.interceptor.CutJsessionidFilter</filter-class>\n</filter>\n  \n<filter-mapping>\n  <filter-name>cutJsessionidFilter</filter-name>\n  <url-pattern>/*</url-pattern>\n  <dispatcher>REQUEST</dispatcher>\n  <dispatcher>INCLUDE</dispatcher>\n</filter-mapping>\n```\n\nJSP\u3067\u8272\u3005\u3084\u3063\u3066\u3044\u308b\u5834\u5408\u306fINCLUDE\u306e\u6307\u5b9a\u3082\u5fc5\u8981\u306b\u306a\u308b\u5834\u5408\u304c\u3042\u308a\u307e\u3059\u3002\n[Apache Tiles](http://tiles.apache.org/2.2/framework/index.html) \u3092\u4f7f\u7528\u3057\u3066\u304a\u308a\u3001\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u304b\u3089JSP\u3092\u57cb\u3081\u8fbc\u3093\u3067\u3044\u305f\u305f\u3081\u5bfe\u5fdc\u304c\u5fc5\u8981\u3067\u3057\u305f\u3002\n\n\u61d0\u304b\u3057\u3055\u3082\u3042\u308b\u8a71\u304b\u3068\u601d\u3044\u307e\u3059\u304c\u3001Tiles\u306e\u7f60\u306b\u6c17\u3065\u304b\u305a\u610f\u5916\u3068\u6642\u9593\u3092\u53d6\u3089\u308c\u305f\u306e\u3067\u3002\n\n\u7d50\u8ad6\n**Servlet 3.0\u3092\u4f7f\u304a\u3046\uff01**\n\n", "tags": ["Tomcat6.0.24", "Java7", "servlet2.5"]}