{"tags": ["Scala", "java8"], "context": " More than 1 year has passed since last update.\u3053\u308c\u306f\u3001Scala\u3067\u6b63\u898f\u8868\u73fe\u3068\u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u3092\u4f7f\u3063\u3066\u6587\u5b57\u5217\u3092\u62bd\u51fa\u3057\u3066\u64cd\u4f5c\u3059\u308b\u306e\u7d9a\u7de8\u3067\u3059\u3002\n\u4ee5\u524d\u306e\u30a8\u30f3\u30c8\u30ea\u30fc\u3092\u793e\u5185\u306e\u30c1\u30e3\u30c3\u30c8\u3067\u5171\u6709\uff08\u5927\u559c\u5229\uff09\u3057\u305f\u3068\u3053\u308d\u3001\u4f55\u540d\u306e\u65b9\u304b\u3089\u5225\u306e\u66f8\u304d\u65b9\u3092\u6559\u3048\u3066\u3082\u3089\u3044\u307e\u3057\u305f\u3002\n\n\u79d2\u306b\u5909\u63db\u3059\u308b\u51e6\u7406\u3092\u5225\u95a2\u6570\u5316\u3057\u3066\u51e6\u7406\u3059\u308b\u65b9\u6cd5\n\u3053\u308c\u306f\u79d2\u306b\u5909\u63db\u3059\u308b\u51e6\u7406\u3092\u95a2\u6570\u3068\u3057\u3066\u307e\u3068\u3081\u3066\u3042\u308a\u307e\u3059\u3002\u91cd\u8907\u304c\u306a\u304f\u306a\u308a\u3001\u304b\u3064\u51e6\u7406\u306b\u540d\u524d\u304c\u4ed8\u3044\u305f\u306e\u3067\u4ee5\u524d\u306e\u3082\u3068\u306e\u3088\u308a\u308f\u304b\u308a\u3084\u3059\u3044\u3093\u3058\u3083\u306a\u3044\u304b\u3068\u601d\u3044\u307e\u3059\u3002\u6b63\u898f\u8868\u73fe\u3082\u4ee5\u524d\u306e\u3068\u6bd4\u3079\u308b\u3068?:\uff08\u524d\u65b9\u53c2\u7167\u3092\u884c\u308f\u306a\u3044\u6b63\u898f\u8868\u73fe\u30b0\u30eb\u30fc\u30d7\uff09\u3092\u4f7f\u3063\u3066\u3001\u672c\u5f53\u306b\u5fc5\u8981\u306a\u6642\u5206\u79d2\u306e\uff13\u3064\u3060\u3051\u3092\u62bd\u51fa\u3059\u308b\u5f62\u3067\u66f8\u304b\u308c\u3066\u3044\u307e\u3059\u3002\nval youtubeDurationPattern = \"PT(?:([0-9])+H)?(?:([0-9])+M)?(?:([0-9])+S)?\".r\ndef toSec(s: String, unit: Int) = Option(s).map { _.toInt * unit }\ndef duration(s: String) = s match {\n  case youtubeDurationPattern(h, m, s) =>\n    (toSec(h, 3600) ++ toSec(m, 60) ++ toSec(s, 1)).sum\n}\n\nprintln(duration(\"PT2H7M56S\"))\nprintln(duration(\"PT7M56S\"))\n\n\n\u62bd\u51fa\u5b50\u3092\u5229\u7528\u3059\u308b\u65b9\u6cd5\n\u3053\u308c\u304c\u4e00\u756aScala\u3063\u307d\u3044\u304b\u3082\u3002Time\u3067\u5b9a\u7fa9\u3057\u3066\u3044\u308bunapply\u30e1\u30bd\u30c3\u30c9\u3092\u4f7f\u3063\u3066\u3001\u5024\u3092Int\u578b\u3068\u3057\u3066\u62bd\u51fa\u3057\u3066\u305d\u306e\u307e\u307ematch\u306ecase\u7bc0\u306b\u9069\u7528\u3067\u304d\u3066\u3044\u307e\u3059\u3002Time\u3092\u5b9a\u7fa9\u3059\u308b\u306e\u304c\u5c11\u3057\u9762\u5012\u3067\u3059\u304c\u3001\u6700\u7d42\u7684\u306a\u30b3\u30fc\u30c9\u306f\u76f4\u611f\u7684\u3067\u53ef\u8aad\u6027\u304c\u9ad8\u3044\u3068\u601d\u3044\u307e\u3057\u305f\u3002\nobject Time{\n  def unapply(s: String): Option[Int] = Some(if(s == null) 0 else s.toInt)\n}\n\nobject YoutubeDuration {\n  val youtubeDurationPattern = \"PT(?:([0-9])+H)?(?:([0-9])+M)?(?:([0-9])+S)?\".r\n\n  def unapply(st: String):Option[Int] = {\n    st match {\n      case youtubeDurationPattern(Time(h), Time(m), Time(s)) =>\n        Some(h * 3600 + m * 60 + s)\n      case _ => None\n    }\n  }\n}\n\nval YoutubeDuration(s) = \"PT2H7M56S\"\n\n\n\u304a\u307e\u3051\uff1aJava\u7248\nJava8\u306eOptional.ofNullable\u3068orElse\u3092\u4f7f\u3063\u305f\u30d1\u30bf\u30fc\u30f3\u3067\u3059\u3002Java\u306eif\u6587\u3067\u306f\u5024\u304c\u8fd4\u305b\u306a\u3044\u306e\u3067\u3001\u5225\u306e\u30e1\u30bd\u30c3\u30c9\u3084\u96c6\u8a08\u7528\u306e\u5909\u6570\u3092\u4f7f\u308f\u305a\u306b\u3084\u308b\u306a\u3089\u3053\u3093\u306a\u611f\u3058\u306b\u306a\u308b\u3068\u601d\u3044\u307e\u3059\u3002\npublic class YT {\n\n    private final static Pattern YOUTUBE_DURATION_PATTERN\n            = Pattern.compile(\"PT(([0-9]+)H)?(([0-9]+)M)?(([0-9]+)S)?\");\n\n    public long duration(String s) {\n        final Matcher matcher = YOUTUBE_DURATION_PATTERN.matcher(s);\n        if (matcher.find()) {\n            return\n                Optional.ofNullable(matcher.group(2))\n                    .map(it -> Long.parseLong(it)).orElse(0L) * 3600L +\n                Optional.ofNullable(matcher.group(4))\n                    .map(it -> Long.parseLong(it)).orElse(0L) * 60L +\n                Optional.ofNullable(matcher.group(6))\n                    .map(it -> Long.parseLong(it)).orElse(0L);\n        }\n        return 0L;\n    }\n\n    @Test\n    public void xxx() {\n        System.out.println(duration(\"PT2H7M56S\"));\n        System.out.println(duration(\"PT7M56S\"));\n    }\n\n}\n\n\n\u7d50\u8ad6\n\u793e\u5185\u5927\u559c\u5229\u304a\u3082\u3057\u308d\u3044\uff01  \n\u3053\u308c\u306f\u3001[Scala\u3067\u6b63\u898f\u8868\u73fe\u3068\u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u3092\u4f7f\u3063\u3066\u6587\u5b57\u5217\u3092\u62bd\u51fa\u3057\u3066\u64cd\u4f5c\u3059\u308b](http://qiita.com/agata/items/46790c751ce235527592)\u306e\u7d9a\u7de8\u3067\u3059\u3002\n\n\u4ee5\u524d\u306e\u30a8\u30f3\u30c8\u30ea\u30fc\u3092\u793e\u5185\u306e\u30c1\u30e3\u30c3\u30c8\u3067\u5171\u6709\uff08\u5927\u559c\u5229\uff09\u3057\u305f\u3068\u3053\u308d\u3001\u4f55\u540d\u306e\u65b9\u304b\u3089\u5225\u306e\u66f8\u304d\u65b9\u3092\u6559\u3048\u3066\u3082\u3089\u3044\u307e\u3057\u305f\u3002\n\n# \u79d2\u306b\u5909\u63db\u3059\u308b\u51e6\u7406\u3092\u5225\u95a2\u6570\u5316\u3057\u3066\u51e6\u7406\u3059\u308b\u65b9\u6cd5\n\n\u3053\u308c\u306f\u79d2\u306b\u5909\u63db\u3059\u308b\u51e6\u7406\u3092\u95a2\u6570\u3068\u3057\u3066\u307e\u3068\u3081\u3066\u3042\u308a\u307e\u3059\u3002\u91cd\u8907\u304c\u306a\u304f\u306a\u308a\u3001\u304b\u3064\u51e6\u7406\u306b\u540d\u524d\u304c\u4ed8\u3044\u305f\u306e\u3067\u4ee5\u524d\u306e\u3082\u3068\u306e\u3088\u308a\u308f\u304b\u308a\u3084\u3059\u3044\u3093\u3058\u3083\u306a\u3044\u304b\u3068\u601d\u3044\u307e\u3059\u3002\u6b63\u898f\u8868\u73fe\u3082\u4ee5\u524d\u306e\u3068\u6bd4\u3079\u308b\u3068`?:`\uff08\u524d\u65b9\u53c2\u7167\u3092\u884c\u308f\u306a\u3044\u6b63\u898f\u8868\u73fe\u30b0\u30eb\u30fc\u30d7\uff09\u3092\u4f7f\u3063\u3066\u3001\u672c\u5f53\u306b\u5fc5\u8981\u306a\u6642\u5206\u79d2\u306e\uff13\u3064\u3060\u3051\u3092\u62bd\u51fa\u3059\u308b\u5f62\u3067\u66f8\u304b\u308c\u3066\u3044\u307e\u3059\u3002\n\n```scala\nval youtubeDurationPattern = \"PT(?:([0-9])+H)?(?:([0-9])+M)?(?:([0-9])+S)?\".r\ndef toSec(s: String, unit: Int) = Option(s).map { _.toInt * unit }\ndef duration(s: String) = s match {\n  case youtubeDurationPattern(h, m, s) =>\n    (toSec(h, 3600) ++ toSec(m, 60) ++ toSec(s, 1)).sum\n}\n\nprintln(duration(\"PT2H7M56S\"))\nprintln(duration(\"PT7M56S\"))\n```\n\n# \u62bd\u51fa\u5b50\u3092\u5229\u7528\u3059\u308b\u65b9\u6cd5\n\n\u3053\u308c\u304c\u4e00\u756aScala\u3063\u307d\u3044\u304b\u3082\u3002Time\u3067\u5b9a\u7fa9\u3057\u3066\u3044\u308bunapply\u30e1\u30bd\u30c3\u30c9\u3092\u4f7f\u3063\u3066\u3001\u5024\u3092Int\u578b\u3068\u3057\u3066\u62bd\u51fa\u3057\u3066\u305d\u306e\u307e\u307ematch\u306ecase\u7bc0\u306b\u9069\u7528\u3067\u304d\u3066\u3044\u307e\u3059\u3002Time\u3092\u5b9a\u7fa9\u3059\u308b\u306e\u304c\u5c11\u3057\u9762\u5012\u3067\u3059\u304c\u3001\u6700\u7d42\u7684\u306a\u30b3\u30fc\u30c9\u306f\u76f4\u611f\u7684\u3067\u53ef\u8aad\u6027\u304c\u9ad8\u3044\u3068\u601d\u3044\u307e\u3057\u305f\u3002\n\n```scala\nobject Time{\n  def unapply(s: String): Option[Int] = Some(if(s == null) 0 else s.toInt)\n}\n\nobject YoutubeDuration {\n  val youtubeDurationPattern = \"PT(?:([0-9])+H)?(?:([0-9])+M)?(?:([0-9])+S)?\".r\n\n  def unapply(st: String):Option[Int] = {\n    st match {\n      case youtubeDurationPattern(Time(h), Time(m), Time(s)) =>\n        Some(h * 3600 + m * 60 + s)\n      case _ => None\n    }\n  }\n}\n\nval YoutubeDuration(s) = \"PT2H7M56S\"\n```\n\n# \u304a\u307e\u3051\uff1aJava\u7248\n\nJava8\u306e`Optional.ofNullable`\u3068`orElse`\u3092\u4f7f\u3063\u305f\u30d1\u30bf\u30fc\u30f3\u3067\u3059\u3002Java\u306eif\u6587\u3067\u306f\u5024\u304c\u8fd4\u305b\u306a\u3044\u306e\u3067\u3001\u5225\u306e\u30e1\u30bd\u30c3\u30c9\u3084\u96c6\u8a08\u7528\u306e\u5909\u6570\u3092\u4f7f\u308f\u305a\u306b\u3084\u308b\u306a\u3089\u3053\u3093\u306a\u611f\u3058\u306b\u306a\u308b\u3068\u601d\u3044\u307e\u3059\u3002\n\n```java\npublic class YT {\n\n    private final static Pattern YOUTUBE_DURATION_PATTERN\n            = Pattern.compile(\"PT(([0-9]+)H)?(([0-9]+)M)?(([0-9]+)S)?\");\n\n    public long duration(String s) {\n        final Matcher matcher = YOUTUBE_DURATION_PATTERN.matcher(s);\n        if (matcher.find()) {\n            return\n                Optional.ofNullable(matcher.group(2))\n                    .map(it -> Long.parseLong(it)).orElse(0L) * 3600L +\n                Optional.ofNullable(matcher.group(4))\n                    .map(it -> Long.parseLong(it)).orElse(0L) * 60L +\n                Optional.ofNullable(matcher.group(6))\n                    .map(it -> Long.parseLong(it)).orElse(0L);\n        }\n        return 0L;\n    }\n\n    @Test\n    public void xxx() {\n        System.out.println(duration(\"PT2H7M56S\"));\n        System.out.println(duration(\"PT7M56S\"));\n    }\n\n}\n```\n\n## \u7d50\u8ad6\n\n\u793e\u5185\u5927\u559c\u5229\u304a\u3082\u3057\u308d\u3044\uff01 :blush: \n"}