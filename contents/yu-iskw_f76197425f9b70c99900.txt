{"context": " More than 1 year has passed since last update.\n\n\u6982\u8981\nHive \u306b\u306f Hive \u306e\u6a5f\u80fd\u3068\u3057\u3066 MapReduce \u3092\u5b9f\u884c\u3059\u308b Custom MapReduce \u3068\u3044\u3046\u6a5f\u80fd\u304c\u3042\u308b\u3002\nCustom Mapreduce \u3067\u306f\u3001Hadoop Streaming \u3068\u540c\u69d8\u306b\u6a19\u6e96\u5165\u51fa\u529b\u304c\u4f7f\u3048\u308b\u3082\u306e\u3067\u3042\u308c\u3070\u57fa\u672c\u7684\u306b\u306f\u306a\u3093\u3067\u3082\u4f7f\u3048\u308b\u3002\n\u305d\u306e\u57fa\u672c\u7684\u306a\u4f7f\u3044\u65b9\u306b\u3064\u3044\u3066\u89e3\u8aac\u3059\u308b\u3002\n\nCustom MapReduce \u306e\u57fa\u672c\u7684\u306a\u4f7f\u3044\u65b9\n\n\u30c6\u30b9\u30c8\u30c7\u30fc\u30bf(CSV)\n\u3053\u306e CSV \u30d5\u30a1\u30a4\u30eb\u3092 /tmp/test.csv \u3068\u3057\u3066\u4fdd\u5b58\u3059\u308b\u3002\n1,2,3\n1,2,3\n1,2,3\n1,2,3\n1,2,3\n1,2,3\n\n\nCustom MapReduce \u3067\u5229\u7528\u3059\u308b Perl\n\u3053\u306e\u30b3\u30fc\u30c9\u3092/tmp/map.pl\u3068\u3057\u3066\u4fdd\u5b58\u3059\u308b\u3002\n#!/bin/env perl\nuse strict;\nuse warnings;\n\nmy $comma_count = 0;\n\nwhile (<>) {\n    my $line = $_;\n    chomp($line);\n    $comma_count = (() = $line =~ /\\\"/g);\n    print $comma_count, \"\\n\";\n}\n\n\nHive DDL \u3068 SELECT \u6587\u4f8b\nadd file /tmp/map.pl;\n\n\nCREATE DATABASE IF NOT EXISTS test;\n\nDROP TABLE IF EXISTS test.cmr_test;\nCREATE TABLE IF NOT EXISTS test.cmr_test (\n    line STRING\n)\n;\n\nLOAD DATA LOCAL INPATH '/tmp/test.csv'\nOVERWRITE INTO TABLE test.cmr_test;\n\nSELECT\n  transform(line) USING 'map.pl' AS clm\nFROM\n  test.cmr_test;\n\n## \u6982\u8981\n\nHive \u306b\u306f Hive \u306e\u6a5f\u80fd\u3068\u3057\u3066 MapReduce \u3092\u5b9f\u884c\u3059\u308b Custom MapReduce \u3068\u3044\u3046\u6a5f\u80fd\u304c\u3042\u308b\u3002\nCustom Mapreduce \u3067\u306f\u3001Hadoop Streaming \u3068\u540c\u69d8\u306b\u6a19\u6e96\u5165\u51fa\u529b\u304c\u4f7f\u3048\u308b\u3082\u306e\u3067\u3042\u308c\u3070\u57fa\u672c\u7684\u306b\u306f\u306a\u3093\u3067\u3082\u4f7f\u3048\u308b\u3002\n\u305d\u306e\u57fa\u672c\u7684\u306a\u4f7f\u3044\u65b9\u306b\u3064\u3044\u3066\u89e3\u8aac\u3059\u308b\u3002\n\n## Custom MapReduce \u306e\u57fa\u672c\u7684\u306a\u4f7f\u3044\u65b9\n\n### \u30c6\u30b9\u30c8\u30c7\u30fc\u30bf(CSV)\n\n\u3053\u306e CSV \u30d5\u30a1\u30a4\u30eb\u3092 `/tmp/test.csv` \u3068\u3057\u3066\u4fdd\u5b58\u3059\u308b\u3002\n\n```\n1,2,3\n1,2,3\n1,2,3\n1,2,3\n1,2,3\n1,2,3\n```\n\n### Custom MapReduce \u3067\u5229\u7528\u3059\u308b Perl\n\n\u3053\u306e\u30b3\u30fc\u30c9\u3092`/tmp/map.pl`\u3068\u3057\u3066\u4fdd\u5b58\u3059\u308b\u3002\n\n```pl\n#!/bin/env perl\nuse strict;\nuse warnings;\n\nmy $comma_count = 0;\n\nwhile (<>) {\n    my $line = $_;\n    chomp($line);\n    $comma_count = (() = $line =~ /\\\"/g);\n    print $comma_count, \"\\n\";\n}\n```\n\n### Hive DDL \u3068 SELECT \u6587\u4f8b\n\n```sql\nadd file /tmp/map.pl;\n\n\nCREATE DATABASE IF NOT EXISTS test;\n\nDROP TABLE IF EXISTS test.cmr_test;\nCREATE TABLE IF NOT EXISTS test.cmr_test (\n    line STRING\n)\n;\n\nLOAD DATA LOCAL INPATH '/tmp/test.csv'\nOVERWRITE INTO TABLE test.cmr_test;\n\nSELECT\n  transform(line) USING 'map.pl' AS clm\nFROM\n  test.cmr_test;\n```", "tags": ["hive"]}