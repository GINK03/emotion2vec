{"context": "\n\nExcel VBA \u3067 SHA256\n\u30a8\u30af\u30bb\u30eb\u306e\u30de\u30af\u30ed\u3067SHA256\u5024\u3092\u7b97\u51fa\u3057\u307e\u3059\n\u5fc5\u8981\u306b\u8feb\u3089\u308c\u3066\u691c\u7d22\u3057\u305f\u3089\u3001\u7a0b\u3088\u3044\u3082\u306e\u304c\u3042\u308a\u307e\u3057\u305f\n\u30db\u30f3\u30c8\u3001\u611f\u8b1d\u3067\u3059\n\u53c2\u8003\u30b5\u30a4\u30c8\uff1a   http://www.se-japan.com/memo/vbscript/\nFunction SHA256(s As String) As String\n    Dim objSHA256\n    Dim objUTF8\n\n    Dim bytes() As Byte\n    Dim hash() As Byte\n\n    Dim i\n    Dim wk\n\n    '// INIT\n    Set objSHA256 = CreateObject(\"System.Security.Cryptography.SHA256Managed\")\n    Set objUTF8 = CreateObject(\"System.Text.UTF8Encoding\")\n\n    '// \u6587\u5b57\u5217\u3092 UTF8 \u306b\u30a8\u30f3\u30b3\u30fc\u30c9\u3057\u3001\u30d0\u30a4\u30c8\u914d\u5217\u306b\u5909\u63db\n    bytes = objUTF8.GetBytes_4(s)\n\n    '// \u30cf\u30c3\u30b7\u30e5\u5024\u3092\u8a08\u7b97\uff08\u30d0\u30a4\u30ca\u30ea\uff09\n    hash = objSHA256.ComputeHash_2((bytes))\n\n    '// \u30d0\u30a4\u30ca\u30ea\u309216\u9032\u6570\u6587\u5b57\u5217\u306b\u5909\u63db\n    For i = 1 To UBound(hash) + 1\n        wk = wk & Right(\"0\" & Hex(AscB(MidB(hash, i, 1))), 2)\n    Next i\n\n    '// \u7d50\u679c\u3092\u8fd4\u3059\n    SHA256 = LCase(wk)\n\nEnd Function\n\n# Excel VBA \u3067 SHA256\n\u30a8\u30af\u30bb\u30eb\u306e\u30de\u30af\u30ed\u3067SHA256\u5024\u3092\u7b97\u51fa\u3057\u307e\u3059\n\u5fc5\u8981\u306b\u8feb\u3089\u308c\u3066\u691c\u7d22\u3057\u305f\u3089\u3001\u7a0b\u3088\u3044\u3082\u306e\u304c\u3042\u308a\u307e\u3057\u305f\n\u30db\u30f3\u30c8\u3001\u611f\u8b1d\u3067\u3059\n\n\u53c2\u8003\u30b5\u30a4\u30c8\uff1a  [ http://www.se-japan.com/memo/vbscript/](http://www.se-japan.com/memo/vbscript/)\n\n\n\n```VBA:\nFunction SHA256(s As String) As String\n    Dim objSHA256\n    Dim objUTF8\n    \n    Dim bytes() As Byte\n    Dim hash() As Byte\n    \n    Dim i\n    Dim wk\n    \n    '// INIT\n    Set objSHA256 = CreateObject(\"System.Security.Cryptography.SHA256Managed\")\n    Set objUTF8 = CreateObject(\"System.Text.UTF8Encoding\")\n    \n    '// \u6587\u5b57\u5217\u3092 UTF8 \u306b\u30a8\u30f3\u30b3\u30fc\u30c9\u3057\u3001\u30d0\u30a4\u30c8\u914d\u5217\u306b\u5909\u63db\n    bytes = objUTF8.GetBytes_4(s)\n    \n    '// \u30cf\u30c3\u30b7\u30e5\u5024\u3092\u8a08\u7b97\uff08\u30d0\u30a4\u30ca\u30ea\uff09\n    hash = objSHA256.ComputeHash_2((bytes))\n    \n    '// \u30d0\u30a4\u30ca\u30ea\u309216\u9032\u6570\u6587\u5b57\u5217\u306b\u5909\u63db\n    For i = 1 To UBound(hash) + 1\n        wk = wk & Right(\"0\" & Hex(AscB(MidB(hash, i, 1))), 2)\n    Next i\n    \n    '// \u7d50\u679c\u3092\u8fd4\u3059\n    SHA256 = LCase(wk)\n\nEnd Function\n```\n", "tags": ["VBA", "Excel", "sha256"]}