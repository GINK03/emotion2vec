{"context": "PHP\u304b\u3089\u30ab\u30b9\u30bf\u30e0RestAPI\u3092\u547c\u3073\u51fa\u3059\u30b5\u30f3\u30d7\u30eb\u3067\u3059\u3002\u4f5c\u6210\u3057\u305f\u30ab\u30b9\u30bf\u30e0RestAPI\u306e\u52d5\u4f5c\u30c1\u30a7\u30c3\u30af\u306a\u3069\u306b\u5229\u7528\u3057\u3066\u3044\u307e\u3059\u3002\n\n\u524d\u63d0\u6761\u4ef6\n\u547c\u3073\u51fa\u3059\u30ab\u30b9\u30bf\u30e0RestAPI\u306e\u30d1\u30b9\u306f/example/\u3068\u3057\u3001\u3053\u306e\u30ab\u30b9\u30bf\u30e0RestAPI\u306f\u53d6\u5f15\u5148\u306eSalesforce ID\u3092GET\u30d1\u30e9\u30e1\u30fc\u30bfaid\u3067\u53d7\u3051\u53d6\u3063\u3066\u3001\u5f53\u8a72\u53d6\u5f15\u5148\u306e\u60c5\u5831\u3092json\u5f62\u5f0f\u3067\u8fd4\u3059\u3082\u306e\u3068\u3057\u307e\u3059\u3002\n\n\u30b5\u30f3\u30d7\u30eb\u30b3\u30fc\u30c9\n\nsample.php\n<?php\n// Salesforce \u63a5\u7d9a\u5171\u901a\u8a2d\u5b9a\n$username = ''; // Salesforce\u306e\u63a5\u7d9a\u306b\u7528\u3044\u308b\u30a2\u30ab\u30a6\u30f3\u30c8\u540d\uff08\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\uff09\n$password = ''; // Salesforce\u306e\u63a5\u7d9a\u306b\u7528\u3044\u308b\u30a2\u30ab\u30a6\u30f3\u30c8\u306e\u30d1\u30b9\u30ef\u30fc\u30c9\n$token = ''; // \u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30fc\u30c8\u30fc\u30af\u30f3\u3002\u63a5\u7d9a\u5143IP\u5236\u9650\u3057\u3066\u3044\u308b\u5834\u5408\u306f\u4e0d\u8981\n$client_id = ''; // \u30b3\u30f3\u30b7\u30e5\u30fc\u30de\u9375\n$client_secret = ''; // \u30b3\u30f3\u30b7\u30e5\u30fc\u30de\u306e\u79d8\u5bc6\n$oauth2 = 'https://login.salesforce.com/services/oauth2/token'; // OAuth API's URL\n$api_version = 'v28.0';\n\n// \u30ab\u30b9\u30bf\u30e0RestAPI\u306e\u30d1\u30b9\n$apipath = '/example/';\n// \u30ab\u30b9\u30bf\u30e0RestAPI\u306b\u6e21\u3059\u30d1\u30e9\u30e1\u30fc\u30bf\u8a2d\u5b9a\n$aid = ''; // \u60c5\u5831\u3092\u53d6\u5f97\u3059\u308b\u5bfe\u8c61\u306e\u53d6\u5f15\u5148\u306eSalesforce ID\n\n// \u30a2\u30af\u30bb\u30b9\u30c8\u30fc\u30af\u30f3\u53d6\u5f97\n$post = array(\n    \"grant_type\" => \"password\",\n    \"client_id\" => $client_id,\n    \"client_secret\" => $client_secret,\n    \"username\" => $username,\n    \"password\" => $password . $token,\n);\n\n$curl = curl_init();\ncurl_setopt( $curl, CURLOPT_URL, $oauth2 );\ncurl_setopt( $curl, CURLOPT_RETURNTRANSFER, 1 );\ncurl_setopt( $curl, CURLOPT_HTTP_VERSION, CURL_HTTP_VERSION_1_1 );\ncurl_setopt( $curl, CURLOPT_POSTFIELDS, $post );\n$buf = curl_exec( $curl );\nif ( curl_errno( $curl ) ) {\n    exit;\n}\ncurl_close( $curl );\n$json = json_decode( $buf );\n$instance_url = '';\n$access_token = '';\ntry {\n    $json = json_decode( $buf );\n    $instance_url = $json->instance_url;\n    $access_token = $json->access_token;\n} catch ( SalesforceApiException $e ) {\n    exit;\n}\n\n// \u30ab\u30b9\u30bf\u30e0RestAPI\u60c5\u5831\u53d6\u5f97\n$endpoint = $instance_url . '/services/apexrest' . $apipath . '?aid=' . $aid;\n$result = salesforce_curl_get( $endpoint, $access_token );\nif (! $result ) { exit; }\n$json = json_decode( $result );\n\n// \u53d6\u5f97\u3057\u305f\u60c5\u5831\u3092\u51fa\u529b\u3057\u3066\u7d42\u4e86\necho var_dump( $json );\nexit;\n\nfunction salesforce_curl_get( $api, $access_token ) {\n    $curl = curl_init();\n    curl_setopt( $curl, CURLOPT_HTTPHEADER, array( \"Authorization: OAuth ${access_token}\" ) );\n    curl_setopt( $curl, CURLOPT_URL, $api );\n    curl_setopt( $curl, CURLOPT_RETURNTRANSFER, 1 );\n    curl_setopt( $curl, CURLOPT_HTTP_VERSION, CURL_HTTP_VERSION_1_1 );\n    $buf = curl_exec( $curl );\n    if ( curl_errno( $curl ) ) {\n        return '';\n    }\n    curl_close( $curl );\n    return $buf;\n}\n?>\n\n\n\n\u5b9f\u884c\u65b9\u6cd5\n\u30b3\u30de\u30f3\u30c9\u30e9\u30a4\u30f3\u304b\u3089\u5b9f\u884c\u3057\u307e\u3059\u3002\nphp sample.php\n\nRestAPI\u3092POST\u3067\u30b3\u30fc\u30eb\u3059\u308b\u306b\u306f\uff1f\n\u30b5\u30f3\u30d7\u30eb\u3067\u306fGET\u3067\u30ab\u30b9\u30bf\u30e0RestAPI\u3092\u30b3\u30fc\u30eb\u3057\u3066\u3044\u307e\u3059\uff08salesforce_curl_get\uff09\u304c\u3001\u6b21\u306e\u3088\u3046\u306bPOST\u3067\u30b3\u30fc\u30eb\u3059\u308b\u4e8b\u3082\u3067\u304d\u307e\u3059\u3002POST\u3067\u9001\u308a\u305f\u3044\u30d1\u30e9\u30e1\u30fc\u30bf\u3092\u9023\u60f3\u914d\u5217 $send \u306b\u6307\u5b9a\u3057\u3066\u4f7f\u3044\u307e\u3059\u3002\nfunction salesforce_curl_post( $api, $access_token, $send=array() ) {\n    $curl = curl_init();\n    curl_setopt( $curl, CURLOPT_HTTPHEADER, array( \"Authorization: OAuth ${access_token}\", \"Content-Type: application/json\" ) );\n    curl_setopt( $curl, CURLOPT_URL, $api );\n    curl_setopt( $curl, CURLOPT_RETURNTRANSFER, 1 );\n    curl_setopt( $curl, CURLOPT_HTTP_VERSION, CURL_HTTP_VERSION_1_1 );\n    curl_setopt( $curl, CURLOPT_CUSTOMREQUEST, 'PATCH' );\n    curl_setopt( $curl, CURLOPT_POSTFIELDS, json_encode( $send ) );\n    $buf = curl_exec( $curl );\n    if ( curl_errno( $curl ) ) {\n        return '';\n    }\n    curl_close( $curl );\n    return $buf;\n\n    // \u8fd4\u5374\u5024\u3067\u306f\u306a\u304fHTTP\u30b9\u30c6\u30fc\u30bf\u30b9\u3092\u8fd4\u3057\u305f\u3044\u5834\u5408\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u3059\u308b\u3002\n    // $http_code = curl_getinfo($curl, CURLINFO_HTTP_CODE);\n    // curl_close( $curl );\n    // return $http_code;\n}\n\nPHP\u304b\u3089\u30ab\u30b9\u30bf\u30e0RestAPI\u3092\u547c\u3073\u51fa\u3059\u30b5\u30f3\u30d7\u30eb\u3067\u3059\u3002\u4f5c\u6210\u3057\u305f\u30ab\u30b9\u30bf\u30e0RestAPI\u306e\u52d5\u4f5c\u30c1\u30a7\u30c3\u30af\u306a\u3069\u306b\u5229\u7528\u3057\u3066\u3044\u307e\u3059\u3002\n\n### \u524d\u63d0\u6761\u4ef6\n\n\u547c\u3073\u51fa\u3059\u30ab\u30b9\u30bf\u30e0RestAPI\u306e\u30d1\u30b9\u306f/example/\u3068\u3057\u3001\u3053\u306e\u30ab\u30b9\u30bf\u30e0RestAPI\u306f\u53d6\u5f15\u5148\u306eSalesforce ID\u3092GET\u30d1\u30e9\u30e1\u30fc\u30bfaid\u3067\u53d7\u3051\u53d6\u3063\u3066\u3001\u5f53\u8a72\u53d6\u5f15\u5148\u306e\u60c5\u5831\u3092json\u5f62\u5f0f\u3067\u8fd4\u3059\u3082\u306e\u3068\u3057\u307e\u3059\u3002\n\n### \u30b5\u30f3\u30d7\u30eb\u30b3\u30fc\u30c9\n\n```php:sample.php\n<?php\n// Salesforce \u63a5\u7d9a\u5171\u901a\u8a2d\u5b9a\n$username = ''; // Salesforce\u306e\u63a5\u7d9a\u306b\u7528\u3044\u308b\u30a2\u30ab\u30a6\u30f3\u30c8\u540d\uff08\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\uff09\n$password = ''; // Salesforce\u306e\u63a5\u7d9a\u306b\u7528\u3044\u308b\u30a2\u30ab\u30a6\u30f3\u30c8\u306e\u30d1\u30b9\u30ef\u30fc\u30c9\n$token = ''; // \u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30fc\u30c8\u30fc\u30af\u30f3\u3002\u63a5\u7d9a\u5143IP\u5236\u9650\u3057\u3066\u3044\u308b\u5834\u5408\u306f\u4e0d\u8981\n$client_id = ''; // \u30b3\u30f3\u30b7\u30e5\u30fc\u30de\u9375\n$client_secret = ''; // \u30b3\u30f3\u30b7\u30e5\u30fc\u30de\u306e\u79d8\u5bc6\n$oauth2 = 'https://login.salesforce.com/services/oauth2/token'; // OAuth API's URL\n$api_version = 'v28.0';\n\n// \u30ab\u30b9\u30bf\u30e0RestAPI\u306e\u30d1\u30b9\n$apipath = '/example/';\n// \u30ab\u30b9\u30bf\u30e0RestAPI\u306b\u6e21\u3059\u30d1\u30e9\u30e1\u30fc\u30bf\u8a2d\u5b9a\n$aid = ''; // \u60c5\u5831\u3092\u53d6\u5f97\u3059\u308b\u5bfe\u8c61\u306e\u53d6\u5f15\u5148\u306eSalesforce ID\n\n// \u30a2\u30af\u30bb\u30b9\u30c8\u30fc\u30af\u30f3\u53d6\u5f97\n$post = array(\n    \"grant_type\" => \"password\",\n    \"client_id\" => $client_id,\n    \"client_secret\" => $client_secret,\n    \"username\" => $username,\n    \"password\" => $password . $token,\n);\n\n$curl = curl_init();\ncurl_setopt( $curl, CURLOPT_URL, $oauth2 );\ncurl_setopt( $curl, CURLOPT_RETURNTRANSFER, 1 );\ncurl_setopt( $curl, CURLOPT_HTTP_VERSION, CURL_HTTP_VERSION_1_1 );\ncurl_setopt( $curl, CURLOPT_POSTFIELDS, $post );\n$buf = curl_exec( $curl );\nif ( curl_errno( $curl ) ) {\n    exit;\n}\ncurl_close( $curl );\n$json = json_decode( $buf );\n$instance_url = '';\n$access_token = '';\ntry {\n    $json = json_decode( $buf );\n    $instance_url = $json->instance_url;\n    $access_token = $json->access_token;\n} catch ( SalesforceApiException $e ) {\n    exit;\n}\n\n// \u30ab\u30b9\u30bf\u30e0RestAPI\u60c5\u5831\u53d6\u5f97\n$endpoint = $instance_url . '/services/apexrest' . $apipath . '?aid=' . $aid;\n$result = salesforce_curl_get( $endpoint, $access_token );\nif (! $result ) { exit; }\n$json = json_decode( $result );\n\n// \u53d6\u5f97\u3057\u305f\u60c5\u5831\u3092\u51fa\u529b\u3057\u3066\u7d42\u4e86\necho var_dump( $json );\nexit;\n\nfunction salesforce_curl_get( $api, $access_token ) {\n    $curl = curl_init();\n    curl_setopt( $curl, CURLOPT_HTTPHEADER, array( \"Authorization: OAuth ${access_token}\" ) );\n    curl_setopt( $curl, CURLOPT_URL, $api );\n    curl_setopt( $curl, CURLOPT_RETURNTRANSFER, 1 );\n    curl_setopt( $curl, CURLOPT_HTTP_VERSION, CURL_HTTP_VERSION_1_1 );\n    $buf = curl_exec( $curl );\n    if ( curl_errno( $curl ) ) {\n        return '';\n    }\n    curl_close( $curl );\n    return $buf;\n}\n?>\n```\n\n### \u5b9f\u884c\u65b9\u6cd5\n\n\u30b3\u30de\u30f3\u30c9\u30e9\u30a4\u30f3\u304b\u3089\u5b9f\u884c\u3057\u307e\u3059\u3002\n\n`php sample.php`\n\n### RestAPI\u3092POST\u3067\u30b3\u30fc\u30eb\u3059\u308b\u306b\u306f\uff1f\n\n\u30b5\u30f3\u30d7\u30eb\u3067\u306fGET\u3067\u30ab\u30b9\u30bf\u30e0RestAPI\u3092\u30b3\u30fc\u30eb\u3057\u3066\u3044\u307e\u3059\uff08salesforce_curl_get\uff09\u304c\u3001\u6b21\u306e\u3088\u3046\u306bPOST\u3067\u30b3\u30fc\u30eb\u3059\u308b\u4e8b\u3082\u3067\u304d\u307e\u3059\u3002POST\u3067\u9001\u308a\u305f\u3044\u30d1\u30e9\u30e1\u30fc\u30bf\u3092\u9023\u60f3\u914d\u5217 *$send* \u306b\u6307\u5b9a\u3057\u3066\u4f7f\u3044\u307e\u3059\u3002\n\n```php:\nfunction salesforce_curl_post( $api, $access_token, $send=array() ) {\n    $curl = curl_init();\n    curl_setopt( $curl, CURLOPT_HTTPHEADER, array( \"Authorization: OAuth ${access_token}\", \"Content-Type: application/json\" ) );\n    curl_setopt( $curl, CURLOPT_URL, $api );\n    curl_setopt( $curl, CURLOPT_RETURNTRANSFER, 1 );\n    curl_setopt( $curl, CURLOPT_HTTP_VERSION, CURL_HTTP_VERSION_1_1 );\n    curl_setopt( $curl, CURLOPT_CUSTOMREQUEST, 'PATCH' );\n    curl_setopt( $curl, CURLOPT_POSTFIELDS, json_encode( $send ) );\n    $buf = curl_exec( $curl );\n    if ( curl_errno( $curl ) ) {\n        return '';\n    }\n    curl_close( $curl );\n    return $buf;\n\n    // \u8fd4\u5374\u5024\u3067\u306f\u306a\u304fHTTP\u30b9\u30c6\u30fc\u30bf\u30b9\u3092\u8fd4\u3057\u305f\u3044\u5834\u5408\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u3059\u308b\u3002\n    // $http_code = curl_getinfo($curl, CURLINFO_HTTP_CODE);\n    // curl_close( $curl );\n    // return $http_code;\n}\n```\n", "tags": ["Salesforce", "PHP", "\u30ab\u30b9\u30bf\u30e0RestAPI", "\u30b5\u30f3\u30d7\u30eb\u30b3\u30fc\u30c9"]}