{"context": " More than 1 year has passed since last update.\n\nSoftLayer \u3067\u306e Chef Server \u7528\u4eee\u60f3\u30b5\u30fc\u30d0\u30fc\u306e\u6ce8\u6587\nslcli \u30b3\u30de\u30f3\u30c9\u304b\u3089\u4ee5\u4e0b\u306e\u30b9\u30af\u30ea\u30d7\u30c8\u3067\u30aa\u30fc\u30c0\u30fc\u3057\u307e\u3057\u305f\u3002\n#!/bin/bash\nslcli vs create \\\n--hostname chefserver --domain takara.org \\\n--datacenter tok02 \\\n--cpu 1 --memory 2048 \\\n--billing hourly \\\n--public \\\n--os UBUNTU_14_64 \\\n--postinstall https://raw.githubusercontent.com/takara9/ProvisioningScript/master/ubuntu_basic_config \\\n--key 370981 \\\n--network 100\n\n\u3053\u306e\u30b7\u30a7\u30eb\u304c\u5b9f\u884c\u3059\u308b\u305f\u3081\u306b\u4e8b\u524d\u6e96\u5099\u3068\u3057\u3066\u3001\u4ee5\u4e0b\u306e\u30ea\u30f3\u30af\u3092\u53c2\u7167\u3059\u308b\u3068\u624b\u52a9\u3051\u306b\u306a\u308b\u3068\u601d\u3044\u307e\u3059\u3002\n\nslcli \u30b3\u30de\u30f3\u30c9\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\nsshkey \u306e\u8a2d\u5b9a\n\u30d7\u30ed\u30d3\u30b8\u30e7\u30cb\u30f3\u30b0\uff0f\u30dd\u30b9\u30c8\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u30b9\u30af\u30ea\u30d7\u30c8\nSoftLayer DNS \u306b\u30c9\u30e1\u30a4\u30f3 (\u3053\u3053\u3067\u306ftakara.org)\u3092\u8ffd\u52a0\n\n\u30d7\u30ed\u30d3\u30b8\u30e7\u30cb\u30f3\u30b0\u304c\u7d42\u4e86\u3059\u308b\u3068\u3001\u4ee5\u4e0b\u306e\u69d8\u306b\"action\"\u306e\u6b04\u304c\u7a7a\u6b04\"-\"\u306b\u306a\u308a\u307e\u3059\u3002\nchef@ChefWs:~/shells$ slcli vs list\n:..........:............:.................:...............:............:........:\n:    id    :  hostname  :    primary_ip   :   backend_ip  : datacenter : action :\n:..........:............:.................:...............:............:........:\n: 13307427 : chefserver : 161.202.142.196 :  10.132.253.7 :   tok02    :   -    :\n:..........:............:.................:...............:............:........:\n\n\n\u6e96\u5099\u4f5c\u696d\n\u524d\u63d0\u6761\u4ef6\u306e https://docs.chef.io/install_server_pre.html#uids-and-gids \u3092\u30c1\u30a7\u30c3\u30af\u3057\u3066\u8a72\u5f53\u7b87\u6240\u3092\u5b9f\u65bd\u3057\u307e\u3059\u3002\n\n\u30db\u30b9\u30c8\u540d\nChef-Server\u306e\u30db\u30b9\u30c8\u540d\u306f\u3001\u3059\u3079\u3066\u5c0f\u6587\u5b57\u3067\u306a\u3051\u308c\u3070\u3001\u306a\u308a\u307e\u305b\u3093\u3002\u3000\u3053\u306e\u6761\u4ef6\u306b\u5f93\u3063\u3066\u3044\u306a\u3044\u5834\u5408\u3001\u30c6\u30b9\u30c8\u30b3\u30de\u30f3\u30c9\u304c\u7570\u5e38\u7d42\u4e86\u3057\u3066\u3057\u307e\u3044\u307e\u3059\u3002\n\u6b21\u306fNG\u30b1\u30fc\u30b9\u3067\u3059\u3002 \u3053\u306e\u30db\u30b9\u30c8\u540d\u3067\u306f\u3001chef-server-ctl test \u3067\u30a8\u30e9\u30fc\u306b\u306a\u308a\u307e\u3059\u3002\n# hostname\n# ChefServer.takara.org\n\n\u6b21\u306fOK\u30b1\u30fc\u30b9\u3067\u3059\u3002 \u3053\u306e\u5c0f\u6587\u5b57\u3060\u3051\u306e\u30db\u30b9\u30c8\u540d\u3067\u306f\u3001\u30a8\u30e9\u30fc\u306b\u306a\u308b\u4e8b\u306f\u3042\u308a\u307e\u305b\u3093\u3002\n# hostname\n# chefserver.takara.org\n\n\n\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u30fb\u30a2\u30fc\u30de\u30fc\u306e\u505c\u6b62\nRedHat \u7cfb\u306e SELinux \u306b\u76f8\u5f53\u3059\u308b Ubuntu \u306e AppArmor \u306f\u3001\u30c7\u30d5\u30a9\u30eb\u30c8\u3067 enforce \u30e2\u30fc\u30c9\u306b\u306a\u3063\u3066\u3044\u308b\u306e\u3067 complain \u30e2\u30fc\u30c9\u306b\u5909\u66f4\u3057\u307e\u3059\u3002\n\u5909\u66f4\u306b\u5fc5\u8981\u306a\u30e6\u30fc\u30b6\u30fc\u30fb\u30a4\u30f3\u30bf\u30d5\u30a7\u30fc\u30b9\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\n# apt-get install apparmor-utils -y\n\n\u8a2d\u5b9a\u3092complain \u30e2\u30fc\u30c9\u306b\u5909\u66f4\u3057\u307e\u3059\u3002\n# aa-complain /etc/apparmor.d/*\n\n\u505c\u6b62\u3057\u3066\u3001\u81ea\u52d5\u8d77\u52d5\u3057\u306a\u3044\u69d8\u306b\u3057\u307e\u3059\u3002\n# invoke-rc.d apparmor stop\n# update-rc.d -f apparmor remove\n\n\u72b6\u614b\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002 complain mode \u306e\u884c\u306b\u3001\u3059\u3079\u3066\u5165\u3063\u3066\u3044\u308c\u3070\u5b8c\u4e86\u3067\u3059\u3002\n# apparmor_status\napparmor module is loaded.\n4 profiles are loaded.\n0 profiles are in enforce mode.\n4 profiles are in complain mode.\n   /sbin/dhclient\n   /usr/lib/NetworkManager/nm-dhcp-client.action\n   /usr/lib/connman/scripts/dhclient-script\n   /usr/sbin/tcpdump\n\n\nChef-Server \u306e\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9 \u3068 \u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\nChef\u306e\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u30da\u30fc\u30b8 https://downloads.chef.io/chef-server/ubuntu/ \u304b\u3089\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u7528\u306eURL\u3092\u53d6\u5f97\u3057\u3066\u304a\u304d\u3001\u4eee\u60f3\u30b5\u30fc\u30d0\u30fc\u3067\u3001wget\u30b3\u30de\u30f3\u30c9\u3092\u4f7f\u3063\u3066\u30c0\u30a6\u30ed\u30fc\u30c9\u3057\u307e\u3059\u3002\nroot@ChefServer:~# wget https://web-dl.packagecloud.io/chef/stable/packages/ubuntu/trusty/chef-server-core_12.2.0-1_amd64.deb\n\n\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3057\u305f\u30d5\u30a1\u30a4\u30eb\u3092 dpkg \u30b3\u30de\u30f3\u30c9\u3067\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\nroot@ChefServer:~# dpkg -i chef-server-core_12.2.0-1_amd64.deb \n\nhttps://docs.chef.io/release/server_12-2/install_server.html \u306e\u5c0e\u5165\u624b\u9806\u306b\u5f93\u3063\u3066\u3001\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3092\u9032\u3081\u3066\u3044\u304d\u307e\u3059\u3002\nroot@ChefServer:~# chef-server-ctl reconfigure\n\n\n\u7ba1\u7406\u8005\u3092\u4f5c\u6210\n\u6700\u521d\u306e\u7ba1\u7406\u8005\u30e6\u30fc\u30b6\u30fc\u3092\u767b\u9332\u3057\u307e\u3059\u3002\u3053\u3053\u3067\u8868\u793a\u3055\u308c\u308bprivate RSA\u9375\u306f\u3001knife.rb \u306b\u8a2d\u5b9a\u3059\u308b chef.pem \u306b\u306a\u308a\u307e\u3059\u304b\u3089\u3001\u30b3\u30d4\u30da\u3057\u3066\u4fdd\u6751\u3057\u3066\u304a\u304d\u307e\u3059\u3002\nroot@chefserver:~# chef-server-ctl user-create chef Maho Takara takara9@gmail.com mAnhatt0n \n-----BEGIN RSA PRIVATE KEY-----\nMIIEpQIBAAKCAQEAuBz/3agiINbw2vX0Vf2s8h7rwaxVz7tWPH4HAOmW6jd2h3/B\nsFfJ2FEQtJuZFZqxqhRVJvNx7bS39YWww/W7d3XdXU15hWWlF5mo0HU2NveMqawb\nY96Gsod4Qqgrg7dmoWkglsBDnAXC4nJNEKnNjZKfW393ynrRzr+rqqJcaaoWKkKW\nvDQ9b7HOxynpyrQcecN2XAkjGhdT9twkmKGQINpI3gN695OBl5Wwt7Iyg7KGUi4l\nCR4IaKDtVeNcmneSOUJedWcosOr54DBMdWNYi7hgzyjWKq0VmQyhyljm0fLF1UM5\no8svL2KlxVJBQR9u9fyJta4w9T5rJXi+DCG7QQIDAQABAoIBAH8z0fdztXiY6Dlv\nmstag4WYpWvexD7MgK00qWQQ/yp8/VBqjQhn7tWcVH1jz2VkxoDqoVZS9hC0PjDM\nmC8bdNT5QuK2p1HpwyFGEaNMiBN7/twvQ5FBajCodgcfp0jOioLUXiapWUzPkjDf\npazwlErO1Xji3YGwT4qXVGSE3nJFXBeSg1Ty5LUBRkmQ653N6AHDMoDEzyYtDHFh\nXqsu0aimhigAqYguDJ9K7gUt1k0PMHCH3TqQYGlkrTXDGUKMq9/uctiN+YTvD9A+\nR0JaZYlN4xyP6n+S7I7SoAwSYl8VXOwx8bNWnmanwmrBDD9AAx0bnECWcSNQUDG/\n6AYe6EECgYEA3OT+IK74EXS//rIuuQEs6eQmoSHMFTdzwpfjrHNz2+E2IFJ2p4kv\nzFoHfuRgmPlFc0yHlfl++VBC04WfaNChrHQHALZyH/5oCJrKHdFb9EHGCf96kiR7\nyt9FycB8HxfTIz+cYx+DyJrs+dqVqjqKRLLqVnm37UUg+Mx14IVGKrkCgYEA1V+T\nsz8G7+5zICzSf7dgWHM1OB/jzaKdIVrSXLiTsFm3N/LnOkrVuuAZn0E8WwhSqZRi\nuEZqNQFlQsXpWXaciXfaB/F8i2/mfyKpVeoTgL2a0L1EGnLimG2C2JDoUTEWYTY3\nOedk/Rsn3PGwMlz3VhKoq1T1lPOv5pcW+L6DsMkCgYEAzh8YS6M5dAB/j8jw9E12\nfaIZsc35w+qEqJZXKvpoqErU2QBaHCdVZNi1meC9isE/30EQXA/+PeJ5GSvc/k+A\nLY3vYujcQaKBrVXTOFO9/ITLqVSuKWTF5x7E3mgw6kqvCHs5EP29WRnH+7XOZpRN\npaFWLe9Sg6M4CzGu5R03xnECgYEAnVNFkkqMkOheVoD2DFlnXpBD00ggLYUTGn7e\n0KL/sm3UHBqrx11aTdniynvNRsnSOVtBluHEeaS3xw4qSl6cePe3+VdjH2S4rVEf\nTkuzaZ9jwTlsN5wx23YTnh7qTMNG3xKckcM9wSn+sHg8FEZb0EkduIaCNPug3QLW\nWz4N15ECgYEArHfHI0fpYngmnE9fQOBDt0x6uJWwcyevTaE+7UMeVMNOu0OvTy3u\nt14rvboXo+f+EsNvGXoBTSuehGXiYwnkNIAKhycZc613bnSbcKsX6lu5L5cMbhN2\niK0/EoO/PoYZG5tv9QN+yxeoO8XI9w+voivyBcxAWa3k3aYPw3GlqS4=\n-----END RSA PRIVATE KEY-----\n\n\n\u7d44\u7e54\u3092\u4f5c\u6210\n\u7ba1\u7406\u8005\u306e\u6240\u5c5e\u3059\u308b\u7d44\u7e54\u3092\u767b\u9332\u3057\u307e\u3059\u3002 \u3053\u3053\u3067\u8868\u793a\u3055\u308c\u308b private RSA\u9375\u306f\u3001tech_team-validator.pem\u306e\u30d5\u30a1\u30a4\u30eb\u306b\u306a\u308a\u307e\u3059\u306e\u3067\u3001\u540c\u69d8\u306b\u4fdd\u5b58\u3057\u3066\u304a\u304d\u307e\u3059\u3002\nroot@chefserver:~# chef-server-ctl org-create tech-team \"Cloud Technical Service\" --association_user chef\n-----BEGIN RSA PRIVATE KEY-----\nMIIEogIBAAKCAQEAvIba+RuHpREKSagkSCckrYu38QiqM1RlUjURDoXezIli6FYn\nRzl/31LckKqTTDP3wysnXKpIa01BJaPLhPRlfTEEKVhiPzuzsjH6htKsAqCxJtk+\n4euFQ1r+uRFgCP9TmvB2dFjl1jn5LDJx/9SITobCOo5ft+VR8u+D/PUeveXj2NYq\nNRPqXAJsGoTLPeh6qFS6gihgqkNrShiFz02S8/No623BgN36yvLqvpsVSUrlfYZO\nQbCnp/hnZYgNnMuySLXQD9j59HVNwBak0i3iG/yoCdlactQTYstuvYHuenTpgSJ+\n0gwbPo62cSPkZctFDYykfK12AAywCSqJrmO+/wIDAQABAoIBAGVrRrFsFfS+zgIB\n6kLGi/ywhSuttaIXbMpkseBWNB1ka0kBz++JBzlkojNREByWeFsOBAbdtEfFL57I\nFtxXfaFzlQGJApFx1KGwMU4GV3Kyb5qulB2FThOGCDIXHsq4UImxgofkqwAr/9e+\n64TtGMblx+coYGXVf9ho8WBLnVYaQYMOArA195M00KP1p2KHeEr7y23bMk9HnNCh\n2TMWn03GDfM9zdursmfaTbjNTNQ/GEjAO10hChDiOGSZKzOZnf3CtcU9pQq1KR6r\nBAXiEqWBl7Nm8z1lyQ3u1P1HT9BPTmLlC1qnIF3EkXxl3NURIyHcBRsxanTaxRlg\ncSh89gECgYEA5IjKa6vNc7CKrqY1pXmnG6DaXUrnQHMWsKznNqCFKlM+uqJ5Wfsm\nQY7Fuukb3KTiVc3csJBhcFSbAe55pSoyFTqxiyo7WawBRI4mT6iHOHc3YHrmrtr3\n0OCvONZE2Cff616qfWvKyZoOsi4z8EkWaUtkV2uU/pf3OsXK4EyTEV8CgYEA0y8r\ntbg07A9ZgXE+KUArGjvJb3Gk7Bdix8xt0z4A6Y3nbISzkZF/n4ilZDVDsmLpxv0I\nra+1hHRUF8ABVt66P4kLgTGwI9pbnE7Hee1AesS/Qi2Kszq8UmXSTLPbOkhdWj+a\n0FDrF6JBwA64PKT/u/Y2MSGpaqO0JOU6hixUFmECgYAQjaPz1pbkGVaCPgHGwaAM\nDUOj3EgR0ARFudBpkYjzvuHdTOVzUhC8UOYbmsTs33iRdH7Wvy5/n3E225ouD3df\nOEgh52YzIZVZ7N3ziSZ6PZBiSaSp56xpkcy/Vi3YZlL+znWU7hjbL3B/EX+rmO+p\nos9a0a0SH9nFhQwj4QgKCwKBgFTysohkUpVqDzzsSm7Zav0gc4SqmAaH2ao45yyD\n0mYgOKkEMB8sAcQweSb37gVBmHv8qJMFDOT8zh7Hk0JYUV7hR4lubUXevd8AKWk4\nMCmyHqUGILa7t6kFYDSOXG7zUOnOj/2frxFQqVYSFbX/QQdgoKfevIEy3HHC62mx\nRxnBAoGAAZ1WKHrkKFKXqm9lx4kh7aFfvH5SZkOzUUpxJTX5pbuaGrLJZFkKln2a\nYEgGdPnjq10xzuZ4XTin3PyWTemHbT5cJG47p1ODfnxJ8Qm8IRC8/Vhtwv9LOkfl\nyQqEhPUY3095kp3soOr1EjnPgJlpJ9DEY90nnGOjj33BEgWuyRE=\n-----END RSA PRIVATE KEY-----\n\n\n\u52d5\u4f5c\u30c1\u30a7\u30c3\u30af\ntest\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3057\u3066\u3001\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\nroot@chefserver:~# chef-server-ctl test\nConfiguring logging...\nCreating platform...\nConfigured URL: https://chefserver.takara.org\nCreating org pedant_testorg_chefserver_14802\nValidating Org Creation\nRun options: include {:focus=>true, :smoke=>true}\n\nAll examples were filtered out; ignoring {:focus=>true, :smoke=>true}\n\nRandomized with seed 20209\n\n.................................\n\nFinished in 1.14 seconds\n33 examples, 0 failures\n\nRandomized with seed 20209\n\nStarting Pedant Run: 2015-10-30 08:32:28 UTC\n _______  _______  _______  _______  _______  ______   _______\n|       ||       ||       ||       ||       ||      | |       |\n|   _   ||    _  ||  _____||       ||   _   ||  _    ||    ___|\n|  | |  ||   |_| || |_____ |       ||  | |  || | |   ||   |___\n|  |_|  ||    ___||_____  ||      _||  |_|  || |_|   ||    ___|\n|       ||   |     _____| ||     |_ |       ||       ||   |___\n|_______||___|    |_______||_______||_______||______| |_______|\n\n     _______  _______  ______   _______  __    _  _______\n    |       ||       ||      | |   _   ||  |  | ||       |\n    |    _  ||    ___||  _    ||  |_|  ||   |_| ||_     _|\n    |   |_| ||   |___ | | |   ||       ||       |  |   |\n    |    ___||    ___|| |_|   ||       ||  _    |  |   |\n    |   |    |   |___ |       ||   _   || | |   |  |   |\n    |___|    |_______||______| |__| |__||_|  |__|  |___|\n\n                    \"Accuracy Over Tact\"\n\n                  === Testing Environment ===\n                 Config File: /var/opt/opscode/oc-chef-pedant/etc/pedant_config.rb\n       HTTP Traffic Log File: /var/log/opscode/oc-chef-pedant/http-traffic.log\n\nRunning tests from the following directories:\n/opt/opscode/embedded/service/oc-chef-pedant/spec/api\nRun options:\n  include {:focus=>true, :smoke=>true}\n  exclude {:intermittent_failure=>true, :cleanup=>true}\n\n\nUI\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\u3053\u3053\u307e\u3067\u3067\u3001nginx\u306f\u8d77\u52d5\u3057\u3066\u308b\u304c\u3001\u30a6\u30a7\u30d6\u30da\u30fc\u30b8\u304c\u7121\u3044\u72b6\u614b\u306b\u306a\u3063\u3066\u3044\u308b\u306e\u3067\u3001CHEF-Server \u306e\u30a6\u30a7\u30d6\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u8ffd\u52a0\u3059\u308b\u3002\nroot@ChefServer:~# chef-server-ctl install opscode-manage\nroot@ChefServer:~# chef-server-ctl reconfigure\nroot@ChefServer:~# opscode-manage-ctl reconfigure\n\n\n\u3053\u308c\u3067\u3001\u30d6\u30e9\u30a6\u30b6\u304b\u3089\u30a2\u30af\u30bb\u30b9\u3067\u304d\u308b\u69d8\u306b\u306a\u308b\u3002 \u5148\u306b\u767b\u9332\u3057\u305f\u7ba1\u7406\u8005\u540d\u3068\u30d1\u30b9\u30ef\u30fc\u30c9\u3067\u30ed\u30b0\u30a4\u30f3\u3057\u307e\u3059\u3002\n\n\n\u30ec\u30dd\u30fc\u30c8\u6a5f\u80fd\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\nroot@ChefServer:~# chef-server-ctl install opscode-reporting\nroot@ChefServer:~# chef-server-ctl reconfigure\nroot@ChefServer:~# opscode-reporting-ctl reconfigure\n\n\u3053\u308c\u3067Chef-Server\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u5b8c\u4e86\u3067\u3059\u3002\n# SoftLayer \u3067\u306e Chef Server \u7528\u4eee\u60f3\u30b5\u30fc\u30d0\u30fc\u306e\u6ce8\u6587\n\nslcli \u30b3\u30de\u30f3\u30c9\u304b\u3089\u4ee5\u4e0b\u306e\u30b9\u30af\u30ea\u30d7\u30c8\u3067\u30aa\u30fc\u30c0\u30fc\u3057\u307e\u3057\u305f\u3002\n\n```\n#!/bin/bash\nslcli vs create \\\n--hostname chefserver --domain takara.org \\\n--datacenter tok02 \\\n--cpu 1 --memory 2048 \\\n--billing hourly \\\n--public \\\n--os UBUNTU_14_64 \\\n--postinstall https://raw.githubusercontent.com/takara9/ProvisioningScript/master/ubuntu_basic_config \\\n--key 370981 \\\n--network 100\n```\n\u3053\u306e\u30b7\u30a7\u30eb\u304c\u5b9f\u884c\u3059\u308b\u305f\u3081\u306b\u4e8b\u524d\u6e96\u5099\u3068\u3057\u3066\u3001\u4ee5\u4e0b\u306e\u30ea\u30f3\u30af\u3092\u53c2\u7167\u3059\u308b\u3068\u624b\u52a9\u3051\u306b\u306a\u308b\u3068\u601d\u3044\u307e\u3059\u3002\n\n- slcli \u30b3\u30de\u30f3\u30c9\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n- sshkey \u306e\u8a2d\u5b9a\n- \u30d7\u30ed\u30d3\u30b8\u30e7\u30cb\u30f3\u30b0\uff0f\u30dd\u30b9\u30c8\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u30b9\u30af\u30ea\u30d7\u30c8\n- SoftLayer DNS \u306b\u30c9\u30e1\u30a4\u30f3 (\u3053\u3053\u3067\u306ftakara.org)\u3092\u8ffd\u52a0\n\n\u30d7\u30ed\u30d3\u30b8\u30e7\u30cb\u30f3\u30b0\u304c\u7d42\u4e86\u3059\u308b\u3068\u3001\u4ee5\u4e0b\u306e\u69d8\u306b\"action\"\u306e\u6b04\u304c\u7a7a\u6b04\"-\"\u306b\u306a\u308a\u307e\u3059\u3002\n\n```\nchef@ChefWs:~/shells$ slcli vs list\n:..........:............:.................:...............:............:........:\n:    id    :  hostname  :    primary_ip   :   backend_ip  : datacenter : action :\n:..........:............:.................:...............:............:........:\n: 13307427 : chefserver : 161.202.142.196 :  10.132.253.7 :   tok02    :   -    :\n:..........:............:.................:...............:............:........:\n```\n\n# \u6e96\u5099\u4f5c\u696d\n\u524d\u63d0\u6761\u4ef6\u306e https://docs.chef.io/install_server_pre.html#uids-and-gids \u3092\u30c1\u30a7\u30c3\u30af\u3057\u3066\u8a72\u5f53\u7b87\u6240\u3092\u5b9f\u65bd\u3057\u307e\u3059\u3002\n\n## \u30db\u30b9\u30c8\u540d\nChef-Server\u306e\u30db\u30b9\u30c8\u540d\u306f\u3001\u3059\u3079\u3066\u5c0f\u6587\u5b57\u3067\u306a\u3051\u308c\u3070\u3001\u306a\u308a\u307e\u305b\u3093\u3002\u3000\u3053\u306e\u6761\u4ef6\u306b\u5f93\u3063\u3066\u3044\u306a\u3044\u5834\u5408\u3001\u30c6\u30b9\u30c8\u30b3\u30de\u30f3\u30c9\u304c\u7570\u5e38\u7d42\u4e86\u3057\u3066\u3057\u307e\u3044\u307e\u3059\u3002\n\u6b21\u306fNG\u30b1\u30fc\u30b9\u3067\u3059\u3002 \u3053\u306e\u30db\u30b9\u30c8\u540d\u3067\u306f\u3001chef-server-ctl test \u3067\u30a8\u30e9\u30fc\u306b\u306a\u308a\u307e\u3059\u3002\n\n```\n# hostname\n# ChefServer.takara.org\n```\n\u6b21\u306fOK\u30b1\u30fc\u30b9\u3067\u3059\u3002 \u3053\u306e\u5c0f\u6587\u5b57\u3060\u3051\u306e\u30db\u30b9\u30c8\u540d\u3067\u306f\u3001\u30a8\u30e9\u30fc\u306b\u306a\u308b\u4e8b\u306f\u3042\u308a\u307e\u305b\u3093\u3002\n\n```\n# hostname\n# chefserver.takara.org\n```\n\n\n## \u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u30fb\u30a2\u30fc\u30de\u30fc\u306e\u505c\u6b62\n\nRedHat \u7cfb\u306e SELinux \u306b\u76f8\u5f53\u3059\u308b Ubuntu \u306e AppArmor \u306f\u3001\u30c7\u30d5\u30a9\u30eb\u30c8\u3067 enforce \u30e2\u30fc\u30c9\u306b\u306a\u3063\u3066\u3044\u308b\u306e\u3067 complain \u30e2\u30fc\u30c9\u306b\u5909\u66f4\u3057\u307e\u3059\u3002\n\u5909\u66f4\u306b\u5fc5\u8981\u306a\u30e6\u30fc\u30b6\u30fc\u30fb\u30a4\u30f3\u30bf\u30d5\u30a7\u30fc\u30b9\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\n\n```\n# apt-get install apparmor-utils -y\n```\n\u8a2d\u5b9a\u3092complain \u30e2\u30fc\u30c9\u306b\u5909\u66f4\u3057\u307e\u3059\u3002\n\n```\n# aa-complain /etc/apparmor.d/*\n```\n\u505c\u6b62\u3057\u3066\u3001\u81ea\u52d5\u8d77\u52d5\u3057\u306a\u3044\u69d8\u306b\u3057\u307e\u3059\u3002\n\n```\n# invoke-rc.d apparmor stop\n# update-rc.d -f apparmor remove\n```\n\u72b6\u614b\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002 complain mode \u306e\u884c\u306b\u3001\u3059\u3079\u3066\u5165\u3063\u3066\u3044\u308c\u3070\u5b8c\u4e86\u3067\u3059\u3002\n\n```\n# apparmor_status\napparmor module is loaded.\n4 profiles are loaded.\n0 profiles are in enforce mode.\n4 profiles are in complain mode.\n   /sbin/dhclient\n   /usr/lib/NetworkManager/nm-dhcp-client.action\n   /usr/lib/connman/scripts/dhclient-script\n   /usr/sbin/tcpdump\n```\n\n\n\n# Chef-Server \u306e\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9 \u3068 \u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\nChef\u306e\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u30da\u30fc\u30b8 https://downloads.chef.io/chef-server/ubuntu/ \u304b\u3089\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u7528\u306eURL\u3092\u53d6\u5f97\u3057\u3066\u304a\u304d\u3001\u4eee\u60f3\u30b5\u30fc\u30d0\u30fc\u3067\u3001wget\u30b3\u30de\u30f3\u30c9\u3092\u4f7f\u3063\u3066\u30c0\u30a6\u30ed\u30fc\u30c9\u3057\u307e\u3059\u3002\n\n```\nroot@ChefServer:~# wget https://web-dl.packagecloud.io/chef/stable/packages/ubuntu/trusty/chef-server-core_12.2.0-1_amd64.deb\n```\n\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3057\u305f\u30d5\u30a1\u30a4\u30eb\u3092 dpkg \u30b3\u30de\u30f3\u30c9\u3067\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\n\n```\nroot@ChefServer:~# dpkg -i chef-server-core_12.2.0-1_amd64.deb \n```\nhttps://docs.chef.io/release/server_12-2/install_server.html \u306e\u5c0e\u5165\u624b\u9806\u306b\u5f93\u3063\u3066\u3001\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3092\u9032\u3081\u3066\u3044\u304d\u307e\u3059\u3002\n\n```\nroot@ChefServer:~# chef-server-ctl reconfigure\n```\n\n##\u7ba1\u7406\u8005\u3092\u4f5c\u6210\n\u6700\u521d\u306e\u7ba1\u7406\u8005\u30e6\u30fc\u30b6\u30fc\u3092\u767b\u9332\u3057\u307e\u3059\u3002\u3053\u3053\u3067\u8868\u793a\u3055\u308c\u308bprivate RSA\u9375\u306f\u3001knife.rb \u306b\u8a2d\u5b9a\u3059\u308b chef.pem \u306b\u306a\u308a\u307e\u3059\u304b\u3089\u3001\u30b3\u30d4\u30da\u3057\u3066\u4fdd\u6751\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n\n```\nroot@chefserver:~# chef-server-ctl user-create chef Maho Takara takara9@gmail.com mAnhatt0n \n-----BEGIN RSA PRIVATE KEY-----\nMIIEpQIBAAKCAQEAuBz/3agiINbw2vX0Vf2s8h7rwaxVz7tWPH4HAOmW6jd2h3/B\nsFfJ2FEQtJuZFZqxqhRVJvNx7bS39YWww/W7d3XdXU15hWWlF5mo0HU2NveMqawb\nY96Gsod4Qqgrg7dmoWkglsBDnAXC4nJNEKnNjZKfW393ynrRzr+rqqJcaaoWKkKW\nvDQ9b7HOxynpyrQcecN2XAkjGhdT9twkmKGQINpI3gN695OBl5Wwt7Iyg7KGUi4l\nCR4IaKDtVeNcmneSOUJedWcosOr54DBMdWNYi7hgzyjWKq0VmQyhyljm0fLF1UM5\no8svL2KlxVJBQR9u9fyJta4w9T5rJXi+DCG7QQIDAQABAoIBAH8z0fdztXiY6Dlv\nmstag4WYpWvexD7MgK00qWQQ/yp8/VBqjQhn7tWcVH1jz2VkxoDqoVZS9hC0PjDM\nmC8bdNT5QuK2p1HpwyFGEaNMiBN7/twvQ5FBajCodgcfp0jOioLUXiapWUzPkjDf\npazwlErO1Xji3YGwT4qXVGSE3nJFXBeSg1Ty5LUBRkmQ653N6AHDMoDEzyYtDHFh\nXqsu0aimhigAqYguDJ9K7gUt1k0PMHCH3TqQYGlkrTXDGUKMq9/uctiN+YTvD9A+\nR0JaZYlN4xyP6n+S7I7SoAwSYl8VXOwx8bNWnmanwmrBDD9AAx0bnECWcSNQUDG/\n6AYe6EECgYEA3OT+IK74EXS//rIuuQEs6eQmoSHMFTdzwpfjrHNz2+E2IFJ2p4kv\nzFoHfuRgmPlFc0yHlfl++VBC04WfaNChrHQHALZyH/5oCJrKHdFb9EHGCf96kiR7\nyt9FycB8HxfTIz+cYx+DyJrs+dqVqjqKRLLqVnm37UUg+Mx14IVGKrkCgYEA1V+T\nsz8G7+5zICzSf7dgWHM1OB/jzaKdIVrSXLiTsFm3N/LnOkrVuuAZn0E8WwhSqZRi\nuEZqNQFlQsXpWXaciXfaB/F8i2/mfyKpVeoTgL2a0L1EGnLimG2C2JDoUTEWYTY3\nOedk/Rsn3PGwMlz3VhKoq1T1lPOv5pcW+L6DsMkCgYEAzh8YS6M5dAB/j8jw9E12\nfaIZsc35w+qEqJZXKvpoqErU2QBaHCdVZNi1meC9isE/30EQXA/+PeJ5GSvc/k+A\nLY3vYujcQaKBrVXTOFO9/ITLqVSuKWTF5x7E3mgw6kqvCHs5EP29WRnH+7XOZpRN\npaFWLe9Sg6M4CzGu5R03xnECgYEAnVNFkkqMkOheVoD2DFlnXpBD00ggLYUTGn7e\n0KL/sm3UHBqrx11aTdniynvNRsnSOVtBluHEeaS3xw4qSl6cePe3+VdjH2S4rVEf\nTkuzaZ9jwTlsN5wx23YTnh7qTMNG3xKckcM9wSn+sHg8FEZb0EkduIaCNPug3QLW\nWz4N15ECgYEArHfHI0fpYngmnE9fQOBDt0x6uJWwcyevTaE+7UMeVMNOu0OvTy3u\nt14rvboXo+f+EsNvGXoBTSuehGXiYwnkNIAKhycZc613bnSbcKsX6lu5L5cMbhN2\niK0/EoO/PoYZG5tv9QN+yxeoO8XI9w+voivyBcxAWa3k3aYPw3GlqS4=\n-----END RSA PRIVATE KEY-----\n```\n\n##\u7d44\u7e54\u3092\u4f5c\u6210\n\u7ba1\u7406\u8005\u306e\u6240\u5c5e\u3059\u308b\u7d44\u7e54\u3092\u767b\u9332\u3057\u307e\u3059\u3002 \u3053\u3053\u3067\u8868\u793a\u3055\u308c\u308b private RSA\u9375\u306f\u3001tech_team-validator.pem\u306e\u30d5\u30a1\u30a4\u30eb\u306b\u306a\u308a\u307e\u3059\u306e\u3067\u3001\u540c\u69d8\u306b\u4fdd\u5b58\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n\n```\nroot@chefserver:~# chef-server-ctl org-create tech-team \"Cloud Technical Service\" --association_user chef\n-----BEGIN RSA PRIVATE KEY-----\nMIIEogIBAAKCAQEAvIba+RuHpREKSagkSCckrYu38QiqM1RlUjURDoXezIli6FYn\nRzl/31LckKqTTDP3wysnXKpIa01BJaPLhPRlfTEEKVhiPzuzsjH6htKsAqCxJtk+\n4euFQ1r+uRFgCP9TmvB2dFjl1jn5LDJx/9SITobCOo5ft+VR8u+D/PUeveXj2NYq\nNRPqXAJsGoTLPeh6qFS6gihgqkNrShiFz02S8/No623BgN36yvLqvpsVSUrlfYZO\nQbCnp/hnZYgNnMuySLXQD9j59HVNwBak0i3iG/yoCdlactQTYstuvYHuenTpgSJ+\n0gwbPo62cSPkZctFDYykfK12AAywCSqJrmO+/wIDAQABAoIBAGVrRrFsFfS+zgIB\n6kLGi/ywhSuttaIXbMpkseBWNB1ka0kBz++JBzlkojNREByWeFsOBAbdtEfFL57I\nFtxXfaFzlQGJApFx1KGwMU4GV3Kyb5qulB2FThOGCDIXHsq4UImxgofkqwAr/9e+\n64TtGMblx+coYGXVf9ho8WBLnVYaQYMOArA195M00KP1p2KHeEr7y23bMk9HnNCh\n2TMWn03GDfM9zdursmfaTbjNTNQ/GEjAO10hChDiOGSZKzOZnf3CtcU9pQq1KR6r\nBAXiEqWBl7Nm8z1lyQ3u1P1HT9BPTmLlC1qnIF3EkXxl3NURIyHcBRsxanTaxRlg\ncSh89gECgYEA5IjKa6vNc7CKrqY1pXmnG6DaXUrnQHMWsKznNqCFKlM+uqJ5Wfsm\nQY7Fuukb3KTiVc3csJBhcFSbAe55pSoyFTqxiyo7WawBRI4mT6iHOHc3YHrmrtr3\n0OCvONZE2Cff616qfWvKyZoOsi4z8EkWaUtkV2uU/pf3OsXK4EyTEV8CgYEA0y8r\ntbg07A9ZgXE+KUArGjvJb3Gk7Bdix8xt0z4A6Y3nbISzkZF/n4ilZDVDsmLpxv0I\nra+1hHRUF8ABVt66P4kLgTGwI9pbnE7Hee1AesS/Qi2Kszq8UmXSTLPbOkhdWj+a\n0FDrF6JBwA64PKT/u/Y2MSGpaqO0JOU6hixUFmECgYAQjaPz1pbkGVaCPgHGwaAM\nDUOj3EgR0ARFudBpkYjzvuHdTOVzUhC8UOYbmsTs33iRdH7Wvy5/n3E225ouD3df\nOEgh52YzIZVZ7N3ziSZ6PZBiSaSp56xpkcy/Vi3YZlL+znWU7hjbL3B/EX+rmO+p\nos9a0a0SH9nFhQwj4QgKCwKBgFTysohkUpVqDzzsSm7Zav0gc4SqmAaH2ao45yyD\n0mYgOKkEMB8sAcQweSb37gVBmHv8qJMFDOT8zh7Hk0JYUV7hR4lubUXevd8AKWk4\nMCmyHqUGILa7t6kFYDSOXG7zUOnOj/2frxFQqVYSFbX/QQdgoKfevIEy3HHC62mx\nRxnBAoGAAZ1WKHrkKFKXqm9lx4kh7aFfvH5SZkOzUUpxJTX5pbuaGrLJZFkKln2a\nYEgGdPnjq10xzuZ4XTin3PyWTemHbT5cJG47p1ODfnxJ8Qm8IRC8/Vhtwv9LOkfl\nyQqEhPUY3095kp3soOr1EjnPgJlpJ9DEY90nnGOjj33BEgWuyRE=\n-----END RSA PRIVATE KEY-----\n```\n\n##\u52d5\u4f5c\u30c1\u30a7\u30c3\u30af\ntest\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3057\u3066\u3001\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\n\n```\nroot@chefserver:~# chef-server-ctl test\nConfiguring logging...\nCreating platform...\nConfigured URL: https://chefserver.takara.org\nCreating org pedant_testorg_chefserver_14802\nValidating Org Creation\nRun options: include {:focus=>true, :smoke=>true}\n\nAll examples were filtered out; ignoring {:focus=>true, :smoke=>true}\n\nRandomized with seed 20209\n\n.................................\n\nFinished in 1.14 seconds\n33 examples, 0 failures\n\nRandomized with seed 20209\n\nStarting Pedant Run: 2015-10-30 08:32:28 UTC\n _______  _______  _______  _______  _______  ______   _______\n|       ||       ||       ||       ||       ||      | |       |\n|   _   ||    _  ||  _____||       ||   _   ||  _    ||    ___|\n|  | |  ||   |_| || |_____ |       ||  | |  || | |   ||   |___\n|  |_|  ||    ___||_____  ||      _||  |_|  || |_|   ||    ___|\n|       ||   |     _____| ||     |_ |       ||       ||   |___\n|_______||___|    |_______||_______||_______||______| |_______|\n\n     _______  _______  ______   _______  __    _  _______\n    |       ||       ||      | |   _   ||  |  | ||       |\n    |    _  ||    ___||  _    ||  |_|  ||   |_| ||_     _|\n    |   |_| ||   |___ | | |   ||       ||       |  |   |\n    |    ___||    ___|| |_|   ||       ||  _    |  |   |\n    |   |    |   |___ |       ||   _   || | |   |  |   |\n    |___|    |_______||______| |__| |__||_|  |__|  |___|\n\n                    \"Accuracy Over Tact\"\n\n                  === Testing Environment ===\n                 Config File: /var/opt/opscode/oc-chef-pedant/etc/pedant_config.rb\n       HTTP Traffic Log File: /var/log/opscode/oc-chef-pedant/http-traffic.log\n\nRunning tests from the following directories:\n/opt/opscode/embedded/service/oc-chef-pedant/spec/api\nRun options:\n  include {:focus=>true, :smoke=>true}\n  exclude {:intermittent_failure=>true, :cleanup=>true}\n```\n\n\n##UI\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\u3053\u3053\u307e\u3067\u3067\u3001nginx\u306f\u8d77\u52d5\u3057\u3066\u308b\u304c\u3001\u30a6\u30a7\u30d6\u30da\u30fc\u30b8\u304c\u7121\u3044\u72b6\u614b\u306b\u306a\u3063\u3066\u3044\u308b\u306e\u3067\u3001CHEF-Server \u306e\u30a6\u30a7\u30d6\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u8ffd\u52a0\u3059\u308b\u3002\n\n```\nroot@ChefServer:~# chef-server-ctl install opscode-manage\nroot@ChefServer:~# chef-server-ctl reconfigure\nroot@ChefServer:~# opscode-manage-ctl reconfigure\n\n```\n\n\u3053\u308c\u3067\u3001\u30d6\u30e9\u30a6\u30b6\u304b\u3089\u30a2\u30af\u30bb\u30b9\u3067\u304d\u308b\u69d8\u306b\u306a\u308b\u3002 \u5148\u306b\u767b\u9332\u3057\u305f\u7ba1\u7406\u8005\u540d\u3068\u30d1\u30b9\u30ef\u30fc\u30c9\u3067\u30ed\u30b0\u30a4\u30f3\u3057\u307e\u3059\u3002\n![\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2015-10-19 21.28.58.png](https://qiita-image-store.s3.amazonaws.com/0/42829/30a87150-7c2a-5047-777e-c66de97c5745.png)\n\n\n##\u30ec\u30dd\u30fc\u30c8\u6a5f\u80fd\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n\n```\nroot@ChefServer:~# chef-server-ctl install opscode-reporting\nroot@ChefServer:~# chef-server-ctl reconfigure\nroot@ChefServer:~# opscode-reporting-ctl reconfigure\n```\n\n\u3053\u308c\u3067Chef-Server\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u5b8c\u4e86\u3067\u3059\u3002\n", "tags": ["chef", "SoftLayer", "Ubuntu"]}