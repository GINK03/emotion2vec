{"context": " More than 1 year has passed since last update.\n\n\u6982\u8981\nApache Spark \u3067\u30ed\u30b0\u89e3\u6790\u306a\u3069\u3092\u3057\u3066\u3044\u308b\u3068\u304d\u306b\uff0c\u5358\u7d14\u306b\u884c\u6570\u756a\u53f7\u3092\u4ed8\u4e0e\u3057\u305f\u3044\u3068\u304d\u304c\u3042\u308b\uff0e\n\u305d\u306e\u3088\u3046\u306a\u3068\u304d\u306f\uff0cRDD \u306e\u30e1\u30bd\u30c3\u30c9 zipWithIndex \u3092\u5229\u7528\u3059\u308b\u3068\u826f\u3044\uff0e\n\u6ce8\u610f\u3059\u308b\u70b9\u3068\u3057\u3066\u306f\uff0c\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u306e\u4ed8\u4e0e\u306f 0 \u304b\u3089\u59cb\u307e\u308b\u70b9\u3067\u3042\u308b\uff0e\n\nApache Spark \u3067\u306e\u30b3\u30fc\u30c9\n// Read a local file\nval data = sc.textFile(\"file:///tmp/access-log.txt\")\n\n// take file lines in the file\ndata.take(5)\nres1: Array[String] = Array(::1 - - [25/Jun/2013:11:41:41 -0400] \"OPTIONS * HTTP/1.0\" 200 126 \"-\" \"Apache/2.2.22 (Ubuntu) (internal dummy connection)\", ::1 - - [25/Jun/2013:11:41:41 -0400] \"OPTIONS * HTTP/1.0\" 200 126 \"-\" \"Apache/2.2.22 (Ubuntu) (internal dummy connection)\", ::1 - - [25/Jun/2013:11:41:41 -0400] \"OPTIONS * HTTP/1.0\" 200 126 \"-\" \"Apache/2.2.22 (Ubuntu) (internal dummy connection)\", ::1 - - [25/Jun/2013:11:41:41 -0400] \"OPTIONS * HTTP/1.0\" 200 126 \"-\" \"Apache/2.2.22 (Ubuntu) (internal dummy connection)\", ::1 - - [25/Jun/2013:11:41:41 -0400] \"OPTIONS * HTTP/1.0\" 200 126 \"-\" \"Apache/2.2.22 (Ubuntu) (internal dummy connection)\")\n\n// get each line with index\ndata.zipWithIndex().take(5)\nres2: Array[(String, Long)] = Array((::1 - - [25/Jun/2013:11:41:41 -0400] \"OPTIONS * HTTP/1.0\" 200 126 \"-\" \"Apache/2.2.22 (Ubuntu) (internal dummy connection)\",0), (::1 - - [25/Jun/2013:11:41:41 -0400] \"OPTIONS * HTTP/1.0\" 200 126 \"-\" \"Apache/2.2.22 (Ubuntu) (internal dummy connection)\",1), (::1 - - [25/Jun/2013:11:41:41 -0400] \"OPTIONS * HTTP/1.0\" 200 126 \"-\" \"Apache/2.2.22 (Ubuntu) (internal dummy connection)\",2), (::1 - - [25/Jun/2013:11:41:41 -0400] \"OPTIONS * HTTP/1.0\" 200 126 \"-\" \"Apache/2.2.22 (Ubuntu) (internal dummy connection)\",3), (::1 - - [25/Jun/2013:11:41:41 -0400] \"OPTIONS * HTTP/1.0\" 200 126 \"-\" \"Apache/2.2.22 (Ubuntu) (internal dummy connection)\",4))\n\n// if you want to get first element as index\ndata.zipWithIndex().map(x => x.swap).take(5)\nres3: Array[(Long, String)] = Array((0,::1 - - [25/Jun/2013:11:41:41 -0400] \"OPTIONS * HTTP/1.0\" 200 126 \"-\" \"Apache/2.2.22 (Ubuntu) (internal dummy connection)\"), (1,::1 - - [25/Jun/2013:11:41:41 -0400] \"OPTIONS * HTTP/1.0\" 200 126 \"-\" \"Apache/2.2.22 (Ubuntu) (internal dummy connection)\"), (2,::1 - - [25/Jun/2013:11:41:41 -0400] \"OPTIONS * HTTP/1.0\" 200 126 \"-\" \"Apache/2.2.22 (Ubuntu) (internal dummy connection)\"), (3,::1 - - [25/Jun/2013:11:41:41 -0400] \"OPTIONS * HTTP/1.0\" 200 126 \"-\" \"Apache/2.2.22 (Ubuntu) (internal dummy connection)\"), (4,::1 - - [25/Jun/2013:11:41:41 -0400] \"OPTIONS * HTTP/1.0\" 200 126 \"-\" \"Apache/2.2.22 (Ubuntu) (internal dummy connection)\"))\n\n\n## \u6982\u8981\n\nApache Spark \u3067\u30ed\u30b0\u89e3\u6790\u306a\u3069\u3092\u3057\u3066\u3044\u308b\u3068\u304d\u306b\uff0c\u5358\u7d14\u306b\u884c\u6570\u756a\u53f7\u3092\u4ed8\u4e0e\u3057\u305f\u3044\u3068\u304d\u304c\u3042\u308b\uff0e\n\u305d\u306e\u3088\u3046\u306a\u3068\u304d\u306f\uff0c`RDD` \u306e\u30e1\u30bd\u30c3\u30c9 `zipWithIndex` \u3092\u5229\u7528\u3059\u308b\u3068\u826f\u3044\uff0e\n\u6ce8\u610f\u3059\u308b\u70b9\u3068\u3057\u3066\u306f\uff0c\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u306e\u4ed8\u4e0e\u306f 0 \u304b\u3089\u59cb\u307e\u308b\u70b9\u3067\u3042\u308b\uff0e\n\n## Apache Spark \u3067\u306e\u30b3\u30fc\u30c9\n\n```\n// Read a local file\nval data = sc.textFile(\"file:///tmp/access-log.txt\")\n\n// take file lines in the file\ndata.take(5)\nres1: Array[String] = Array(::1 - - [25/Jun/2013:11:41:41 -0400] \"OPTIONS * HTTP/1.0\" 200 126 \"-\" \"Apache/2.2.22 (Ubuntu) (internal dummy connection)\", ::1 - - [25/Jun/2013:11:41:41 -0400] \"OPTIONS * HTTP/1.0\" 200 126 \"-\" \"Apache/2.2.22 (Ubuntu) (internal dummy connection)\", ::1 - - [25/Jun/2013:11:41:41 -0400] \"OPTIONS * HTTP/1.0\" 200 126 \"-\" \"Apache/2.2.22 (Ubuntu) (internal dummy connection)\", ::1 - - [25/Jun/2013:11:41:41 -0400] \"OPTIONS * HTTP/1.0\" 200 126 \"-\" \"Apache/2.2.22 (Ubuntu) (internal dummy connection)\", ::1 - - [25/Jun/2013:11:41:41 -0400] \"OPTIONS * HTTP/1.0\" 200 126 \"-\" \"Apache/2.2.22 (Ubuntu) (internal dummy connection)\")\n\n// get each line with index\ndata.zipWithIndex().take(5)\nres2: Array[(String, Long)] = Array((::1 - - [25/Jun/2013:11:41:41 -0400] \"OPTIONS * HTTP/1.0\" 200 126 \"-\" \"Apache/2.2.22 (Ubuntu) (internal dummy connection)\",0), (::1 - - [25/Jun/2013:11:41:41 -0400] \"OPTIONS * HTTP/1.0\" 200 126 \"-\" \"Apache/2.2.22 (Ubuntu) (internal dummy connection)\",1), (::1 - - [25/Jun/2013:11:41:41 -0400] \"OPTIONS * HTTP/1.0\" 200 126 \"-\" \"Apache/2.2.22 (Ubuntu) (internal dummy connection)\",2), (::1 - - [25/Jun/2013:11:41:41 -0400] \"OPTIONS * HTTP/1.0\" 200 126 \"-\" \"Apache/2.2.22 (Ubuntu) (internal dummy connection)\",3), (::1 - - [25/Jun/2013:11:41:41 -0400] \"OPTIONS * HTTP/1.0\" 200 126 \"-\" \"Apache/2.2.22 (Ubuntu) (internal dummy connection)\",4))\n\n// if you want to get first element as index\ndata.zipWithIndex().map(x => x.swap).take(5)\nres3: Array[(Long, String)] = Array((0,::1 - - [25/Jun/2013:11:41:41 -0400] \"OPTIONS * HTTP/1.0\" 200 126 \"-\" \"Apache/2.2.22 (Ubuntu) (internal dummy connection)\"), (1,::1 - - [25/Jun/2013:11:41:41 -0400] \"OPTIONS * HTTP/1.0\" 200 126 \"-\" \"Apache/2.2.22 (Ubuntu) (internal dummy connection)\"), (2,::1 - - [25/Jun/2013:11:41:41 -0400] \"OPTIONS * HTTP/1.0\" 200 126 \"-\" \"Apache/2.2.22 (Ubuntu) (internal dummy connection)\"), (3,::1 - - [25/Jun/2013:11:41:41 -0400] \"OPTIONS * HTTP/1.0\" 200 126 \"-\" \"Apache/2.2.22 (Ubuntu) (internal dummy connection)\"), (4,::1 - - [25/Jun/2013:11:41:41 -0400] \"OPTIONS * HTTP/1.0\" 200 126 \"-\" \"Apache/2.2.22 (Ubuntu) (internal dummy connection)\"))\n```\n", "tags": ["Spark"]}