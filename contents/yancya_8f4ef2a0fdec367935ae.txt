{"context": " More than 1 year has passed since last update.\u95a2\u9023: http://qiita.com/yancya/items/1167e9764719151d0c80\nPostgreSQL \u306e\u518d\u5e30 SQL \u3092\u4f7f\u3063\u3066\u9811\u5f35\u3063\u3066\u66f8\u3044\u305f\n\nSQL\nWITH RECURSIVE t(w) AS (\n        VALUES ('')\n         UNION\n        SELECT w || ('{\u30ba\u30f3, \u30c9\u30b3}'::TEXT[])[TRUNC(RANDOM() * 2) + 1]\n          FROM t\n         WHERE NOT w ~ '\u30ba\u30f3\u30ba\u30f3\u30ba\u30f3\u30ba\u30f3\u30c9\u30b3$'\n               )\n        SELECT w || '\u30ad\u30fb\u30e8\u30fb\u30b7\uff01'\n          FROM t\n      ORDER BY LENGTH(w) DESC\n         LIMIT 1;\n\n\n\u89e3\u8aac\n\n\u6700\u521d\u3001t \u306f '' \u3068\u3044\u3046 w \u3092\u6301\u3064\u884c\u306e\u307f\n\u6b21\u306e\u30eb\u30fc\u30d7\u3067\u3001t \u306e\u5404\u884c\u306e w \u306e\u672b\u5c3e\u306b '\u30ba\u30f3' \u304b '\u30c9\u30b3' \u3092\u7d50\u5408\u3057\u305f\u884c\u3092 UNION\uff08\u91cd\u8907\u3092\u9664\u304f\uff09 \u3059\u308b\u3002\u305f\u3060\u3057\u3001\u672b\u5c3e\u304c '\u30ba\u30f3\u30ba\u30f3\u30ba\u30f3\u30ba\u30f3\u30c9\u30b3' \u3068\u306a\u3063\u3066\u3044\u308b\u884c\u3092\u9664\u304f\u3002\u3053\u308c\u3092\u7e70\u308a\u8fd4\u3057\u3066\u3044\u304f\n\u672b\u5c3e\u304c '\u30ba\u30f3\u30ba\u30f3\u30ba\u30f3\u30ba\u30f3\u30c9\u30b3' \u3068\u306a\u3063\u3066\u3044\u308b\u884c\u304c\u3042\u308b\u72b6\u614b\u306e\u30eb\u30fc\u30d7\u3067\u306f\u3001UNION \u306b\u3088\u308a\uff11\u884c\u3082\u5897\u52a0\u3057\u306a\u3044\u306e\u3067\u3001\u305d\u3053\u3067\u518d\u5e30\u304c\u7d42\u4e86\u3057\u3066 t \u304c\u8fd4\u308b\nt \u306e\u4e2d\u3067 w \u304c\u4e00\u756a\u9577\u3044\u884c\u306e\u672b\u5c3e\u304c '\u30ba\u30f3\u30ba\u30f3\u30ba\u30f3\u30ba\u30f3\u30c9\u30b3' \u3068\u306a\u3063\u3066\u3044\u308b\u306f\u305a\u306a\u306e\u3067\u3001\u305d\u306e\u884c\u3060\u3051\u3092\u5bfe\u8c61\u306b '\u30ad\u30fb\u30e8\u30fb\u30b7\uff01' \u3092\u7d50\u5408\u3057\u3066\u8fd4\u3059\n\n\u95a2\u9023: http://qiita.com/yancya/items/1167e9764719151d0c80\n\nPostgreSQL \u306e[\u518d\u5e30 SQL](http://www.postgresql.jp/document/9.5/html/queries-with.html) \u3092\u4f7f\u3063\u3066\u9811\u5f35\u3063\u3066\u66f8\u3044\u305f\n\n## SQL\n\n```sql\nWITH RECURSIVE t(w) AS (\n        VALUES ('')\n         UNION\n        SELECT w || ('{\u30ba\u30f3, \u30c9\u30b3}'::TEXT[])[TRUNC(RANDOM() * 2) + 1]\n          FROM t\n         WHERE NOT w ~ '\u30ba\u30f3\u30ba\u30f3\u30ba\u30f3\u30ba\u30f3\u30c9\u30b3$'\n               )\n        SELECT w || '\u30ad\u30fb\u30e8\u30fb\u30b7\uff01'\n          FROM t\n      ORDER BY LENGTH(w) DESC\n         LIMIT 1;\n```\n\n## \u89e3\u8aac\n\n1. \u6700\u521d\u3001t \u306f '' \u3068\u3044\u3046 w \u3092\u6301\u3064\u884c\u306e\u307f\n2. \u6b21\u306e\u30eb\u30fc\u30d7\u3067\u3001t \u306e\u5404\u884c\u306e w \u306e\u672b\u5c3e\u306b '\u30ba\u30f3' \u304b '\u30c9\u30b3' \u3092\u7d50\u5408\u3057\u305f\u884c\u3092 UNION\uff08\u91cd\u8907\u3092\u9664\u304f\uff09 \u3059\u308b\u3002\u305f\u3060\u3057\u3001\u672b\u5c3e\u304c '\u30ba\u30f3\u30ba\u30f3\u30ba\u30f3\u30ba\u30f3\u30c9\u30b3' \u3068\u306a\u3063\u3066\u3044\u308b\u884c\u3092\u9664\u304f\u3002\u3053\u308c\u3092\u7e70\u308a\u8fd4\u3057\u3066\u3044\u304f\n3. \u672b\u5c3e\u304c '\u30ba\u30f3\u30ba\u30f3\u30ba\u30f3\u30ba\u30f3\u30c9\u30b3' \u3068\u306a\u3063\u3066\u3044\u308b\u884c\u304c\u3042\u308b\u72b6\u614b\u306e\u30eb\u30fc\u30d7\u3067\u306f\u3001UNION \u306b\u3088\u308a\uff11\u884c\u3082\u5897\u52a0\u3057\u306a\u3044\u306e\u3067\u3001\u305d\u3053\u3067\u518d\u5e30\u304c\u7d42\u4e86\u3057\u3066 t \u304c\u8fd4\u308b\n4. t \u306e\u4e2d\u3067 w \u304c\u4e00\u756a\u9577\u3044\u884c\u306e\u672b\u5c3e\u304c '\u30ba\u30f3\u30ba\u30f3\u30ba\u30f3\u30ba\u30f3\u30c9\u30b3' \u3068\u306a\u3063\u3066\u3044\u308b\u306f\u305a\u306a\u306e\u3067\u3001\u305d\u306e\u884c\u3060\u3051\u3092\u5bfe\u8c61\u306b '\u30ad\u30fb\u30e8\u30fb\u30b7\uff01' \u3092\u7d50\u5408\u3057\u3066\u8fd4\u3059\n", "tags": ["PostgreSQL", "\u30ba\u30f3\u30c9\u30b3\u30ad\u30e8\u30b7"]}