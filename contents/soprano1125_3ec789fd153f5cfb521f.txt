{"context": "\u300c8.8.8.8\u300dIPv6\u672c\u30b5\u30fc\u30d3\u30b9\u63d0\u4f9b\u958b\u59cb\u3001 \u300cIPv6\u63a5\u7d9a\u30b5\u30fc\u30d3\u30b9\u300d\u63d0\u4f9b\u958b\u59cb\u306e\u3054\u6848\u5185\n\u307e\u305a\u306f\u4e2d\u306e\u4eba\u306e\u5bfe\u5fdc\u304a\u75b2\u308c\u69d8\u3067\u3057\u305f\uff018888 \u78ba\u304b\u306b\u300c\u3069\u3053\u304b\u3067\u898b\u305f\u3088\u3046\u306a\u6570\u5b57\u300d\u306b\u30af\u30b9\u30ea\u3068\u3057\u307e\u3057\u305f\uff57 \n\u305d\u3093\u306a\u308f\u3051\u3067\u904e\u53bb\u306e\u6587\u732e\u306b\u6cbf\u3063\u3066\u5bb6\u306e NAT \u7bb1\u306b\u8a2d\u5b9a\u3092\u6295\u3052\u5165\u308c\u3066 Google \u306b IPv6 \u3067 ping \u3059\u308b\u3068\u3053\u308d\u307e\u3067\u3084\u3063\u3066\u307f\u307e\u3057\u305f\u3002\n\u3053\u3053\u3067\u306f\u3059\u3067\u306b\u30b5\u30fc\u30d3\u30b9\u306e\u7533\u3057\u8fbc\u307f\u304c\u6e08\u3093\u3067\u3044\u308b(\u300c\u3010IPv6 \u63a5\u7d9a\u30b5\u30fc\u30d3\u30b9\u3011\u3054\u5951\u7d04\u60c5\u5831\u306e\u3054\u6848\u5185\u300d\u3068\u3044\u3046\u3088\u3046\u306a\u30e1\u30fc\u30eb\u304c\u5c4a\u3044\u3066\u3044\u308b)\u3068\u3044\u3046\u524d\u63d0\u3067\u9032\u3081\u305f\u3044\u3068\u601d\u3044\u307e\u3059\u3002\n\nWhat I'm doing?\n\n\u30c8\u30f3\u30cd\u30eb\u3092\u6398\u308b\n\u30d7\u30ec\u30d5\u30a3\u30c3\u30af\u30b9\u3092 DHCPv6 \u3067\u53d6\u5f97\u3059\u308b\n\u30c7\u30d5\u30a9\u30eb\u30c8\u30eb\u30fc\u30c8\u3092\u6307\u5b9a\u3059\u308b\n\n\u3053\u306e3\u70b9\u3092\u30af\u30ea\u30a2\u3059\u308c\u3070\u3069\u3093\u306a\u74b0\u5883\u3067\u3082\u7d20\u6575\u306a IPv6 \u751f\u6d3b\u3092\u904e\u3054\u3059\u3053\u3068\u304c\u51fa\u6765\u308b\u3053\u3068\u3067\u3057\u3087\u3046(\u3049\n\nSpec\n\nNAT Box\nFreeBSD(10.1-RELEASE amd64)\nmpd(5.8)\ndhcp6(20080615_7)\nPF\n\n\nDig tunnel\n\nmpd.conf\nstartup:\n\ndefault:\n    load ispv6\n\nispv6:\n    create bundle static bISPv6\n    set iface idle 0\n    set iface disable on-demand\n    set iface enable tcpmssfix\n    set iface route default\n    set link accept chap pap \n    set bundle disable ipcp\n    set bundle enable ipv6cp\n\n    create link static lISPv6 pppoe\n    set link action bundle bISPv6\n    set auth authname [\u30e1\u30fc\u30eb\u306b\u8a18\u8f09\u3057\u3066\u3044\u308b\u30ed\u30b0\u30a4\u30f3ID]\n    set auth password [\u30e1\u30fc\u30eb\u306b\u8a18\u8f09\u3057\u3066\u3044\u308b\u30d1\u30b9\u30ef\u30fc\u30c9]\n\n    set link max-redial 0\n    set link keep-alive 10 60\n    set pppoe iface re1\n    set pppoe service \"InterLinkv6\"\n    open\n\n\n\nGet prefix\n\ndhcp6c.conf\ninterface [mpd5 \u3067\u6398\u3063\u305f\u30c8\u30f3\u30cd\u30eb\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9] {\n    send ia-pd 0;\n};\n\nid-assoc pd 0 {\n    prefix-interface [IPv6 \u30a2\u30c9\u30ec\u30b9\u3092\u5272\u308a\u5f53\u3066\u308b\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9] {\n        sla-id 0;\n        sla-len 0;\n    };\n};\n\n\n\npf.conf\npass quick on [mpd5 \u3067\u6398\u3063\u305f\u30c8\u30f3\u30cd\u30eb\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9] all\n\n\nDHCPv6 \u3067 prefix \u3092\u53d6\u5f97\u3059\u308b\u3068\u304d\u306f FW \u306e\u8a2d\u5b9a\u3092\u78ba\u8a8d\u3057\u3066\u304a\u304d\u307e\u3057\u3087\u3046\u3002\u30d6\u30ed\u30c3\u30af\u3057\u305f\u307e\u307e\u3060\u3068\u53d6\u5f97\u3067\u304d\u306a\u3044\u3067\u3059\u3002(\u81ea\u5206\u306f\u305d\u3053\u3067\u30cf\u30de\u308a\u307e\u3057\u305f\u3002)\n\nSet route\n\nconsole\n# route -6 add default -iface [mpd5 \u3067\u6398\u3063\u305f\u30c8\u30f3\u30cd\u30eb\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9]\n\n\n\ncheck ping\n\nconsole\n# ping6 -c 10 google.com\n# ping6 -c 10 2404:6800:4004:818::200e\n\n\nUnbound \u306a\u3069\u3067 AAAA \u30d5\u30a3\u30eb\u30bf\u30fc\u3092\u304b\u3051\u3066\u3044\u308b\u5834\u5408\u306f\u30d5\u30a3\u30eb\u30bf\u30fc\u3092\u5916\u3057\u3066\u304a\u304d\u307e\u3059\u3002\u758e\u901a\u3067\u304d\u3066\u3044\u308c\u3070\u716e\u308b\u306a\u308a\u713c\u304f\u306a\u308a IPv6 \u3068\u622f\u308c\u3066\u304f\u3060\u3055\u3044\u3002 Have a good IPv6 Life!\n\nsuddenly thought\n\u03b1\u30c6\u30b9\u30c8\u306e\u6642\u306b\u3082(\u3046\u3063\u304b\u308a\u9375\u3092\u3064\u3051\u305f\u307e\u307e)\u3064\u3076\u3084\u304d\u307e\u3057\u305f\u304c\u500b\u4eba\u7684\u306b HE \u306e Tunnel Broker \u306e\u3088\u3046\u306b /48, /64 \u304c\u914d\u308c\u3066\u9006\u5f15\u304d\u59d4\u8b72\u3067\u304d\u305f\u3089\u3082\u3046\u6e80\u8db3\u3060\u306a\u3041\u3068\u601d\u3063\u305f\u3068\u3053\u308d\u3067\u3059\u3002\u307e\u3041 IPv6 \u306f\u3068\u308a\u3042\u3048\u305a\u4f7f\u3048\u308b\u306e\u3067\u3044\u3044\u304b\u306a\u3041\u3068\u73fe\u72b6\u6e80\u8db3\u3057\u3066\u307e\u3059\u3002(\u3044\u3064\u304b\u3069\u3053\u304b\u304c\u5bfe\u5fdc\u3059\u308b\u3053\u3068\u3067\u3057\u3087\u3046\uff57)\n\nLink\n\nFreeBSD\u306eVPN Server\u3067IPv6\u3092\u30d0\u30e9\u307e\u304f\n\u4ed9\u77f3\u6d69\u660e\u306e\u65e5\u8a18: \u30d5\u30ec\u30c3\u30c4 \u5149\u30cd\u30af\u30b9\u30c8\u306e IPv6 PPPoE \u63a5\u7d9a\u3092 OCN \u5149\u30a2\u30af\u30bb\u30b9\u3067\u4f7f\u3063\u3066\u307f\u305f\n\u30d5\u30ec\u30c3\u30c4\u5149\u30cd\u30af\u30b9\u30c8\u7528IPv6 PPPoE\u30a2\u30c0\u30d7\u30bf\u30fc\u3092\u4f5c\u3063\u3066\u307f\u308b \u2014 SOUM/misc\nFreeBSD \u3067 IIJmio\u3078 pppoe+DHCPv6\u3067 \u63a5\u7d9a\u3059\u308b\u3068\u304d\u306e\u30e1\u30e2\n\n[\u300c8.8.8.8\u300dIPv6\u672c\u30b5\u30fc\u30d3\u30b9\u63d0\u4f9b\u958b\u59cb](http://blog.interlink.or.jp/2016/08/%e3%80%8c%ef%bc%98-%ef%bc%98-%ef%bc%98-%ef%bc%98%e3%80%8dipv6%e6%9c%ac%e3%82%b5%e3%83%bc%e3%83%93%e3%82%b9%e6%8f%90%e4%be%9b%e9%96%8b%e5%a7%8b.html)\u3001 [\u300cIPv6\u63a5\u7d9a\u30b5\u30fc\u30d3\u30b9\u300d\u63d0\u4f9b\u958b\u59cb\u306e\u3054\u6848\u5185](http://www.interlink.or.jp/new/news/2016/0808.html)\n\u307e\u305a\u306f\u4e2d\u306e\u4eba\u306e\u5bfe\u5fdc\u304a\u75b2\u308c\u69d8\u3067\u3057\u305f\uff018888 ~~\u78ba\u304b\u306b\u300c\u3069\u3053\u304b\u3067\u898b\u305f\u3088\u3046\u306a\u6570\u5b57\u300d\u306b\u30af\u30b9\u30ea\u3068\u3057\u307e\u3057\u305f\uff57~~ \n\u305d\u3093\u306a\u308f\u3051\u3067\u904e\u53bb\u306e\u6587\u732e\u306b\u6cbf\u3063\u3066\u5bb6\u306e NAT \u7bb1\u306b\u8a2d\u5b9a\u3092\u6295\u3052\u5165\u308c\u3066 Google \u306b IPv6 \u3067 ping \u3059\u308b\u3068\u3053\u308d\u307e\u3067\u3084\u3063\u3066\u307f\u307e\u3057\u305f\u3002\n\u3053\u3053\u3067\u306f\u3059\u3067\u306b\u30b5\u30fc\u30d3\u30b9\u306e\u7533\u3057\u8fbc\u307f\u304c\u6e08\u3093\u3067\u3044\u308b(\u300c\u3010IPv6 \u63a5\u7d9a\u30b5\u30fc\u30d3\u30b9\u3011\u3054\u5951\u7d04\u60c5\u5831\u306e\u3054\u6848\u5185\u300d\u3068\u3044\u3046\u3088\u3046\u306a\u30e1\u30fc\u30eb\u304c\u5c4a\u3044\u3066\u3044\u308b)\u3068\u3044\u3046\u524d\u63d0\u3067\u9032\u3081\u305f\u3044\u3068\u601d\u3044\u307e\u3059\u3002\n## What I'm doing?\n1. \u30c8\u30f3\u30cd\u30eb\u3092\u6398\u308b\n2. \u30d7\u30ec\u30d5\u30a3\u30c3\u30af\u30b9\u3092 DHCPv6 \u3067\u53d6\u5f97\u3059\u308b\n3. \u30c7\u30d5\u30a9\u30eb\u30c8\u30eb\u30fc\u30c8\u3092\u6307\u5b9a\u3059\u308b\n\n\u3053\u306e3\u70b9\u3092\u30af\u30ea\u30a2\u3059\u308c\u3070\u3069\u3093\u306a\u74b0\u5883\u3067\u3082\u7d20\u6575\u306a IPv6 \u751f\u6d3b\u3092\u904e\u3054\u3059\u3053\u3068\u304c\u51fa\u6765\u308b\u3053\u3068\u3067\u3057\u3087\u3046(\u3049\n\n## Spec\n<dl>\n  <dt>NAT Box</dt>\n  <dd>FreeBSD(10.1-RELEASE amd64)</dd>\n  <dd>mpd(5.8)</dd>\n  <dd>dhcp6(20080615_7)</dd>\n  <dd>PF</dd>\n</dl>\n\n## Dig tunnel\n```mpd.conf\nstartup:\n\ndefault:\n\tload ispv6\n\nispv6:\n\tcreate bundle static bISPv6\n\tset iface idle 0\n\tset iface disable on-demand\n\tset iface enable tcpmssfix\n\tset iface route default\n\tset link accept chap pap \n\tset bundle disable ipcp\n\tset bundle enable ipv6cp\n\n\tcreate link static lISPv6 pppoe\n\tset link action bundle bISPv6\n\tset auth authname [\u30e1\u30fc\u30eb\u306b\u8a18\u8f09\u3057\u3066\u3044\u308b\u30ed\u30b0\u30a4\u30f3ID]\n\tset auth password [\u30e1\u30fc\u30eb\u306b\u8a18\u8f09\u3057\u3066\u3044\u308b\u30d1\u30b9\u30ef\u30fc\u30c9]\n\n\tset link max-redial 0\n\tset link keep-alive 10 60\n\tset pppoe iface re1\n\tset pppoe service \"InterLinkv6\"\n\topen\n```\n\n## Get prefix\n```dhcp6c.conf\ninterface [mpd5 \u3067\u6398\u3063\u305f\u30c8\u30f3\u30cd\u30eb\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9] {\n    send ia-pd 0;\n};\n\nid-assoc pd 0 {\n    prefix-interface [IPv6 \u30a2\u30c9\u30ec\u30b9\u3092\u5272\u308a\u5f53\u3066\u308b\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9] {\n        sla-id 0;\n        sla-len 0;\n    };\n};\n```\n```pf.conf\npass quick on [mpd5 \u3067\u6398\u3063\u305f\u30c8\u30f3\u30cd\u30eb\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9] all\n```\nDHCPv6 \u3067 prefix \u3092\u53d6\u5f97\u3059\u308b\u3068\u304d\u306f FW \u306e\u8a2d\u5b9a\u3092\u78ba\u8a8d\u3057\u3066\u304a\u304d\u307e\u3057\u3087\u3046\u3002\u30d6\u30ed\u30c3\u30af\u3057\u305f\u307e\u307e\u3060\u3068\u53d6\u5f97\u3067\u304d\u306a\u3044\u3067\u3059\u3002(\u81ea\u5206\u306f\u305d\u3053\u3067\u30cf\u30de\u308a\u307e\u3057\u305f\u3002)\n\n## Set route\n```console:console\n# route -6 add default -iface [mpd5 \u3067\u6398\u3063\u305f\u30c8\u30f3\u30cd\u30eb\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9]\n```\n\n## check ping\n```console:console\n# ping6 -c 10 google.com\n# ping6 -c 10 2404:6800:4004:818::200e\n```\nUnbound \u306a\u3069\u3067 AAAA \u30d5\u30a3\u30eb\u30bf\u30fc\u3092\u304b\u3051\u3066\u3044\u308b\u5834\u5408\u306f\u30d5\u30a3\u30eb\u30bf\u30fc\u3092\u5916\u3057\u3066\u304a\u304d\u307e\u3059\u3002\u758e\u901a\u3067\u304d\u3066\u3044\u308c\u3070\u716e\u308b\u306a\u308a\u713c\u304f\u306a\u308a IPv6 \u3068\u622f\u308c\u3066\u304f\u3060\u3055\u3044\u3002 Have a good IPv6 Life!\n\n## suddenly thought\n\u03b1\u30c6\u30b9\u30c8\u306e\u6642\u306b\u3082(\u3046\u3063\u304b\u308a\u9375\u3092\u3064\u3051\u305f\u307e\u307e)[\u3064\u3076\u3084\u304d](http://twitter.com/soprano1125/status/710720041533235200)\u307e\u3057\u305f\u304c\u500b\u4eba\u7684\u306b HE \u306e Tunnel Broker \u306e\u3088\u3046\u306b /48, /64 \u304c\u914d\u308c\u3066\u9006\u5f15\u304d\u59d4\u8b72\u3067\u304d\u305f\u3089\u3082\u3046\u6e80\u8db3\u3060\u306a\u3041\u3068\u601d\u3063\u305f\u3068\u3053\u308d\u3067\u3059\u3002\u307e\u3041 IPv6 \u306f\u3068\u308a\u3042\u3048\u305a\u4f7f\u3048\u308b\u306e\u3067\u3044\u3044\u304b\u306a\u3041\u3068\u73fe\u72b6\u6e80\u8db3\u3057\u3066\u307e\u3059\u3002(\u3044\u3064\u304b\u3069\u3053\u304b\u304c\u5bfe\u5fdc\u3059\u308b\u3053\u3068\u3067\u3057\u3087\u3046\uff57)\n\n## Link\n- [FreeBSD\u306eVPN Server\u3067IPv6\u3092\u30d0\u30e9\u307e\u304f](http://blog.hiroaki.home.group.jp/2012/09/freebsdvpn-serveripv6.html#PtRKsiP.twitter_tweet_count_no_m)\n- [\u4ed9\u77f3\u6d69\u660e\u306e\u65e5\u8a18: \u30d5\u30ec\u30c3\u30c4 \u5149\u30cd\u30af\u30b9\u30c8\u306e IPv6 PPPoE \u63a5\u7d9a\u3092 OCN \u5149\u30a2\u30af\u30bb\u30b9\u3067\u4f7f\u3063\u3066\u307f\u305f](http://www.gcd.org/blog/2011/06/812/)\n- [\u30d5\u30ec\u30c3\u30c4\u5149\u30cd\u30af\u30b9\u30c8\u7528IPv6 PPPoE\u30a2\u30c0\u30d7\u30bf\u30fc\u3092\u4f5c\u3063\u3066\u307f\u308b &mdash; SOUM/misc](http://www.soum.co.jp/misc/ko/flets-ipv6-pppoe/1.html)\n- [FreeBSD \u3067 IIJmio\u3078 pppoe+DHCPv6\u3067 \u63a5\u7d9a\u3059\u308b\u3068\u304d\u306e\u30e1\u30e2](http://ror.hj.to/ja/issei/entries/142i5p-r3vhxi2yz4ur/node)\n", "tags": ["FreeBSD", "InterLink", "IPv6", "pppoe"]}