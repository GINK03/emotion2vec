{"context": " More than 1 year has passed since last update.\n\n\u6982\u8981\n\u30c7\u30fc\u30bf\u306e\u69cb\u6210\u3084\u4f7f\u3044\u52dd\u624b\u306e\u7406\u89e3\u3092\u6df1\u3081\u308b\u70ba\u3001\u4ee5\u524d\u69cb\u7bc9\u3057\u305fAerospike\u306e\u74b0\u5883\uff08Aerospike\u74b0\u5883\u69cb\u7bc9\u30e1\u30e2 on GCP\uff09\u3092\u4f7f\u3063\u3066CLI\u30d9\u30fc\u30b9\u3067\u3044\u3058\u3063\u3066\u307f\u305f\u306e\u3067\u305d\u306e\u30e1\u30e2\u3002\n\nAerospike\u306e\u30c7\u30fc\u30bf\u69cb\u6210\n\n\n\n\n\u533a\u5206\n\u5b9a\u7fa9\n\n\n\n\nCluster\nAerospike\u306e\u30af\u30e9\u30b9\u30bf\u30fc\n\n\nNode\n\u30af\u30e9\u30b9\u30bf\u30fc\u306e\u69cb\u6210\u8981\u7d20\n\n\nNamespace\n\u72ec\u7acb\u3057\u305f\u30b9\u30c8\u30ec\u30fc\u30b8\u9818\u57df\u3002\u8907\u6570\u5b9a\u7fa9\u53ef\u80fd\u3060\u304cNamespace\u3092\u8de8\u3044\u3060\u53c2\u7167\u306f\u3067\u304d\u306a\u3044\u3002RBD\u3067\u3044\u3046\u3068\u3053\u308d\u306edatabase\u3084scheme\u306b\u8fd1\u3044\u3002\n\n\nSet\nRecord\u3092\u30b0\u30eb\u30fc\u30d4\u30f3\u30b0\u3057\u305f\u9818\u57df\u3002RDB\u306eTable\u306b\u8fd1\u3044\u3002\n\n\nRecord\n\u30c7\u30fc\u30bf\u3092\u51fa\u3057\u5165\u308c\u3059\u308b\u5358\u4f4d\u3002Value\u306fJSON\u5f62\u5f0f\u3002RDB\u306eRaw\u306b\u8fd1\u3044\u3002\n\n\nBin\n\u30c7\u30fc\u30bf\u306e\u6700\u5c0f\u5358\u4f4d\u3002Record\u3092\u69cb\u6210\u3059\u308b\u30d1\u30fc\u30c4\u3002Json\u306e\u8981\u7d20\u306b\u5f53\u305f\u308b\u3002\n\n\n\n\nnamespace\n\n\u516c\u5f0f\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\nnamespace\u306fConfig\u30d5\u30a1\u30a4\u30eb\uff08/etc/aerospike/aerospike.conf\uff09\u3092\u7de8\u96c6\u3057\u3066\u518d\u8d77\u52d5\u3059\u308c\u3070\u8ffd\u52a0\u3084\u5909\u66f4\u304c\u3067\u304d\u308b\n\u8a2d\u5b9a\u53ef\u80fd\u306a\u9805\u76ee\u306fConfiguration Reference\u3092\u53c2\u7167\n\u8a2d\u5b9a\u306e\u53cd\u6620\u306b\u306fNode\u306e\u518d\u8d77\u52d5\u304c\u5fc5\u8981\n\u5168\u3066\u306eNode\u306b\u8a2d\u5b9a\u3092\u53cd\u6620\u3057\u306a\u3044\u3068\u30af\u30e9\u30b9\u30bf\u30fc\u9593\u306e\u6574\u5408\u304c\u53d6\u308c\u306a\u304f\u306a\u308b\n\u5168Node\u306b\u4e00\u62ec\u53cd\u6620\u307f\u305f\u3044\u306e\u306f\u306a\u3055\u305d\u3046\n\u3088\u3063\u3066\u3001\u305d\u3093\u306a\u306b\u983b\u7e41\u306b\u4f5c\u3063\u305f\u308a\u6d88\u3057\u305f\u308a\u3059\u308b\u3082\u306e\u3067\u306f\u306a\u3055\u305d\u3046\n\n\n\u30c7\u30fc\u30bf\u3092\u64cd\u4f5c\u3059\u308b(AQL\u7248)\nAerospike\u3000Query Language(AQL)\u3068\u3044\u3046SQL\u30e9\u30a4\u30af\u306b\u30c7\u30fc\u30bf\u3092\u64cd\u4f5c\u3067\u304d\u308b\u30b3\u30de\u30f3\u30c9\u30e9\u30a4\u30f3\u30c4\u30fc\u30eb\u304c\u7528\u610f\u3055\u308c\u3066\u3044\u308b\u306e\u3067\u305d\u308c\u3092\u4f7f\u3063\u3066\u30c7\u30fc\u30bf\u3092\u64cd\u4f5c\u3057\u3066\u307f\u308b\u3002\n\nAQL\u306e\u30d7\u30ed\u30f3\u30d7\u30c8\u3092\u958b\u304f\n$ aql\n\n\u30c7\u30d5\u30a9\u30eb\u30c8\u306eAerospike\u30b5\u30fc\u30d0\u5185\u306b\u3044\u308b\u306a\u3089\u3053\u308c\u3067OK\u3002\n\u5916\u90e8\u304b\u3089\u30a2\u30af\u30bb\u30b9\u3059\u308b\u5834\u5408\u306f\u30de\u30cb\u30e5\u30a2\u30eb\u306b\u5247\u3063\u3066-h\u3084-p\u306a\u3069\u306e\u30aa\u30d7\u30b7\u30e7\u30f3\u3092\u6307\u5b9a\u3059\u308b\u3002\n\n\u30c7\u30fc\u30bf\u306e\u633f\u5165\nINSERT INTO <ns>[.<set>] (PK, <bins>) VALUES (<key>, <values>)\n\n\nSQL\u306e\u69cb\u6587\u3068\u307b\u307c\u540c\u3058\u3060\u3051\u3069\u3001\u30b9\u30ad\u30fc\u30de\u30ec\u30b9\u306a\u306e\u3067(PK, <bins>)\u90e8\u5206\u306e\u7701\u7565\u304c\u3067\u304d\u306a\u3044\u306e\u3068\u3001\uff08\u305f\u3076\u3093\uff091\u30b3\u30de\u30f3\u30c9\u30671\u30ec\u30b3\u30fc\u30c9\u3057\u304b\u5165\u3089\u306a\u3044\u3002\n\n\u4f8b\uff1a\naql> insert into test.person (PK, name, age, gender, phone_number) values (1, 'Taro', 20, 'M', 09011112222)\nOK, 1 record affected.\n\n\n\u30c7\u30fc\u30bf\u306e\u53c2\u7167\nSELECT * FROM <ns>[.<set>]\n\n\u4f8b\uff1a\naql> select * from test.person\n+----------+-----+--------+--------------+\n| name     | age | gender | phone_number |\n+----------+-----+--------+--------------+\n| \"Hanako\" | 22  | \"F\"    | 9011113333   |\n| \"Taro\"   | 20  | \"M\"    | 9011112223   |\n+----------+-----+--------+--------------+\n2 rows in set (0.022 secs)\n\nnamespace\u307e\u305f\u306fset\u306e\u30c7\u30fc\u30bf\u3092\u53c2\u7167\u3059\u308b\u3002\naql> select name, age from test.person\n+----------+-----+\n| name     | age |\n+----------+-----+\n| \"Hanako\" | 22  |\n| \"Taro\"   | 20  |\n+----------+-----+\n2 rows in set (0.022 secs)\n\n\u53d6\u5f97\u9805\u76ee\u3092Bin\u3067\u7d5e\u308b\u3053\u3068\u3082\u53ef\u80fd\naql> select * from test.person where PK = 1\n+--------+-----+--------+--------------+\n| name   | age | gender | phone_number |\n+--------+-----+--------+--------------+\n| \"Taro\" | 20  | \"M\"    | 9011112223   |\n+--------+-----+--------+--------------+\n1 row in set (0.001 secs)\n\nWHERE\u53e5\u306f\u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u306fPK\uff08Record-Key\uff09\u306e\u7b49\u4fa1\u6bd4\u8f03\u3067\u306e\u307f\u53ef\u80fd\nBin\u5358\u4f4d\u3067\u7d5e\u308b\u306b\u306f\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u3092\u8cbc\u3089\u306a\u3044\u3068\u3044\u3051\u306a\u3044(\u5f8c\u8ff0)\n[note]\nAQL\u3067\u306f\u73fe\u72b6Record-Key\u3092\u53c2\u7167\u3067\u304d\u306a\u3044\u3089\u3057\u3044\n\u66f4\u65b0\u3084\u524a\u9664\u306b\u306fKey\u304c\u5fc5\u8981\u306a\u3053\u3068\u3092\u8003\u3048\u308b\u3068AQL\u3067\u30c7\u30fc\u30bf\u64cd\u4f5c\u3059\u308b\u306b\u306f\u9650\u754c\u304c\u3042\u308b\n\n\u30c7\u30fc\u30bf\u306e\u66f4\u65b0\n\nUPDAET\u69cb\u6587\u306f\u306a\u3044\u3002\n\u540c\u3058Key\u540d\u3067INSERT\u3059\u308c\u3070\u4e0a\u66f8\u304b\u308c\u308b\u306e\u3067\u66f4\u65b0\u306b\u306a\u308b\u3002\n\u305f\u3060\u3057\u3001\u66f4\u65b0\u7bc4\u56f2\u306fRecord\u5358\u4f4d\u3067\u306f\u306a\u304fBin\u5358\u4f4d\u3067\u5b9f\u884c\u3055\u308c\u308b\u70ba\u3001\u66f4\u65b0\u3057\u306a\u304b\u3063\u305fBin\u306f\u305d\u306e\u307e\u307e\u6b8b\u308b\u3002\n\n\u4f8b\uff1a\naql> select * from test.person where pk = 1\n+--------+-----+--------+--------------+\n| name   | age | gender | phone_number |\n+--------+-----+--------+--------------+\n| \"Taro\" | 20  | \"M\"    | 9011112222   |\n+--------+-----+--------+--------------+\n1 row in set (0.001 secs)\n\naql> insert into test.person (PK, age) values (1, 21)OK, 1 record affected.\n\naql> select * from test.person where pk = 1\n+--------+-----+--------+--------------+\n| name   | age | gender | phone_number |\n+--------+-----+--------+--------------+\n| \"Taro\" | 21  | \"M\"    | 9011112222   |\n+--------+-----+--------+--------------+\n1 row in set (0.000 secs)\n\n\n\u30c7\u30fc\u30bf\u306e\u524a\u9664\nDELETE FROM <ns>[.<set>] WHERE PK=<key>\n\n\u524a\u9664\u306b\u306fPK\uff08Record-key\uff09\u304c\u5fc5\u8981\n\u4f8b\uff1a\naql> delete from test.person where PK = 1\nOK, 1 record affected.\n\n\n\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u3092\u8cbc\u308b\nCREATE INDEX <index> ON <ns>[.<set>] (<bin>) <type>\n\n\n\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u540d\u306fnamespace\u3067\u30e6\u30cb\u30fc\u30af\u3067\u306a\u3044\u3051\u308c\u3070\u306a\u3089\u306a\u3044\ntype\u306fNUMERIC or STRING\n\n\n\u4f8b\uff1a\naql> create index idx_person_age_numeric on test.person (age) numeric\nOK, 1 index added.\n\n\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u3092\u8cbc\u308b\u3068\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u304c\u8cbc\u3089\u308c\u305fBin\u3067where\u53e5\u3092\u4f7f\u3048\u308b\u3002\n\u4f8b\uff1a\naql> select * from test.person where age = 18\n+--------+-----+--------+--------------+\n| name   | age | gender | phone_number |\n+--------+-----+--------+--------------+\n| \"Jiro\" | 18  | \"M\"    | 9022223333   |\n+--------+-----+--------+--------------+\n1 row in set (0.002 secs)\n\naql> select * from test.person where age between 18 and 20\n+--------+-----+--------+--------------+\n| name   | age | gender | phone_number |\n+--------+-----+--------+--------------+\n| \"Jiro\" | 18  | \"M\"    | 9022223333   |\n| \"Taro\" | 20  | \"M\"    | 9011112222   |\n+--------+-----+--------+--------------+\n2 rows in set (0.002 secs)\n\n\n\u30c7\u30fc\u30bf\u3092\u64cd\u4f5c\u3059\u308b\uff08ascli\u7248\uff09\n\u5358\u7d14\u306bKey\u6307\u5b9a\u3067\u30c7\u30fc\u30bf\u306e\u51fa\u3057\u5165\u308c\u3084\u53c2\u7167\u3092\u3059\u308b\u3060\u3051\u306a\u3089Aerospike CLI\n\u3092\u4f7f\u3063\u3066\u3082\u53ef\u80fd\u3002\n\n\u30c7\u30fc\u30bf\u64cd\u4f5c\u7cfb\n\nput\nrecord\u306e\u633f\u5165\nascli put <ns> <set> <record-key> <record-value>\n\n\nrecord-value\u306fJSON\u5f62\u5f0f\u3002\n\u6210\u5426\u306f\u7d42\u4e86\u30b3\u30fc\u30c9\u304c0\u304b\u3069\u3046\u304b\nnamespace/set/record-key\u304c\u5168\u3066\u540c\u4e00\u306e\u30c7\u30fc\u30bf\u304c\u3042\u308b\u5834\u5408\u306f\u4e0a\u66f8\u304b\u308c\u308b\n\n\u4f8b\uff1a\n$ ascli put test settest keytest '{\"name\":\"hoge\", \"age\":30, \"array\":[1,2,3], \"map\":{\"mapkey\":\"mapvalue\"}}'\n$ echo $?\n0\n\n\nget\nrecord-value\u306e\u53d6\u5f97\nascli get <ns> <set> <record-key>\n\n\u4f8b\uff1a\n$ ascli get test settest keytest\n{\"map\": { \"mapkey\": \"mapvalue\" }, \"array\": [ 1, 2, 3 ], \"name\": \"hoge\", \"age\": 30}\n\n\nexists\nrecord-key\u306e\u5b58\u5728\u78ba\u8a8d\nascli exists <ns> <set> <record-key>\n\n\n\u5b58\u5728\u306e\u6709\u7121\u306f\u7d42\u4e86\u30b3\u30fc\u30c9\u304c0\u304b\u3069\u3046\u304b\n\n\u4f8b\uff1a\n$ ascli exists test settest keytest\nKey keytest exists.\n$ echo $?\n0\n\n$ ascli exists test settest keytest2\nKey keytest2 does not exist.\n$ echo $?\n2\n\n\nremove\nrecord\u306e\u524a\u9664\nascli remove <ns> <set> <record-key>\n\n\n\u6210\u5426\u306f\u7d42\u4e86\u30b3\u30fc\u30c9\u304c0\u304b\u3069\u3046\u304b\n\n\u4f8b\uff1a\n$ ascli remove test settest keytest\n$ echo $?\n0\n\n$ ascli remove test settest keytest\nERROR 2 AEROSPIKE_ERR_RECORD_NOT_FOUND\n$ echo $?\n2\n\n\nScripting\n\neval\n\u4e00\u9023\u306eascli\u306e\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3067\u304d\u308b\u30b7\u30f3\u30d7\u30eb\u306a\u30b9\u30af\u30ea\u30d7\u30c6\u30a3\u30f3\u30b0\u74b0\u5883\u3092\u547c\u3073\u51fa\u3059\u3002\nascli eval\n\n\n\u6a19\u6e96\u5165\u529b\u304b\u3089\u306e\u30b3\u30de\u30f3\u30c9\u3092\u8aad\u307f\u8fbc\u3080\u306e\u3067\u9069\u5f53\u306aFile\u306b\u66f8\u3044\u305f\u30b3\u30de\u30f3\u30c9\u3092\u30d1\u30a4\u30d4\u30f3\u30b0\u3057\u3066\u5b9f\u884c\u3082\u3067\u304d\u308b\neval\u72ec\u81ea\u306e\u30b3\u30de\u30f3\u30c9\u3082\u3042\u308b\n\u30b3\u30de\u30f3\u30c9\u306f\u30b9\u30bf\u30c3\u30af\u306b\u4fdd\u6301\u3055\u308c\u308b\n\u30b9\u30bf\u30c3\u30af\u306f1\u30b3\u30de\u30f3\u30c91000\u6587\u5b57\u307e\u3067\u3067\u30011000\u30b3\u30de\u30f3\u30c9\u307e\u3067\u4fdd\u6301\u3059\u308b\u3002\n\n[Note]\neval\u306f\u30b7\u30f3\u30b0\u30eb\u30b9\u30ec\u30c3\u30c9\u3067\u52d5\u4f5c\u3057\u3001\u5168\u3066\u306e\u547c\u3073\u51fa\u3057\u3092\u30d6\u30ed\u30c3\u30af\u3059\u308b\u3053\u3068\u306b\u6ce8\u610f\u3059\u308b\neval\u306e\u72ec\u81ea\u30b3\u30de\u30f3\u30c9\u306f\u4ee5\u4e0b\u3002\n\n\n\n\u30b3\u30de\u30f3\u30c9\n\u8aac\u660e\n\n\n\n\n:print\n\u6700\u5f8c\u306e\u30b3\u30de\u30f3\u30c9\u304b\u3089\u306e\u7d71\u8a08\u60c5\u5831\u3092\u8868\u793a\u3059\u308b\n\n\n:reset\n\u84c4\u7a4d\u3055\u308c\u305f\u7d71\u8a08\u60c5\u5831\u3092\u30ea\u30bb\u30c3\u30c8\u3059\u308b\n\n\n:repeat n\n\u30b9\u30bf\u30c3\u30af\u4e0a\u306e\u5168\u3066\u306e\u30b3\u30de\u30f3\u30c9\u3092n\u56de\u7e70\u308a\u8fd4\u3059\n\n\n:clear\n\u30b9\u30bf\u30c3\u30af\u3092\u7a7a\u306b\u3059\u308b\n\n\n:quit\neval\u304b\u3089\u629c\u3051\u308b\n\n\n\n\u4f8b\uff1a\n$ ascli eval\nput test evaltest test1 '{\"name\":\"hoge\"}'\n:print\n>>\n  time:    0.94500 ms\n  success: 1\n  failure: 0\n:reset\n:print\n>>\n  time:    0.00000 ms\n  success: 0\n  failure: 0\n:clear\nget test evaltest test1\n{\"name\": \"hoge\"}\n:reset\n:repeat 10\n{\"name\": \"hoge\"}\n{\"name\": \"hoge\"}\n{\"name\": \"hoge\"}\n{\"name\": \"hoge\"}\n{\"name\": \"hoge\"}\n{\"name\": \"hoge\"}\n{\"name\": \"hoge\"}\n{\"name\": \"hoge\"}\n{\"name\": \"hoge\"}\n{\"name\": \"hoge\"}\n:print\n>>\n  time:    4.98200 ms\n  success: 10\n  failure: 0\n:quit\n\n\u30d5\u30a1\u30a4\u30eb\u304b\u3089\u5b9f\u884c\u3059\u308b\u5834\u5408\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u611f\u3058\u3067OK\u3002\n$ cat {evalfile} | ascli eval\n\n\n\u6240\u611f\n\u5358\u7d14\u306a\u30c7\u30fc\u30bf\u64cd\u4f5c\u306a\u3089\u3044\u3044\u3051\u3069\u3001\u3061\u3087\u3063\u3068\u8907\u96d1\u306a\u3053\u3068\u3084\u308d\u3046\u3068\u3059\u308b\u3068\u624b\u8a70\u307e\u308a\u305d\u3046\u306a\u611f\u3058\u3002Aerospike\u306fUDF\u304c\u5b9a\u7fa9\u3067\u304d\u308b\u307f\u305f\u3044\u306a\u306e\u3067\u8907\u96d1\u306a\u51e6\u7406\u306f\u305d\u3063\u3061\u3067\u3084\u308c\u3063\u3066\u3068\u3053\u308d\u304b\u306a\u3001\u3068\u601d\u3044\u307e\u3057\u305f\u3002\n\u3068\u308a\u3042\u3048\u305a\u4eca\u56de\u306e\u76ee\u7684\u306f\u30c7\u30fc\u30bf\u69cb\u6210\u306e\u7406\u89e3\u306a\u306e\u3067\u4e00\u65e6\u3053\u3093\u306a\u3082\u3093\u3067\u3002\n\u6b21\u306fClient\u3092\u4f7f\u3063\u3066\u3054\u306b\u3087\u3054\u306b\u3087\u3084\u308b\u4e88\u5b9a\u3002\n# \u6982\u8981\n\u30c7\u30fc\u30bf\u306e\u69cb\u6210\u3084\u4f7f\u3044\u52dd\u624b\u306e\u7406\u89e3\u3092\u6df1\u3081\u308b\u70ba\u3001\u4ee5\u524d\u69cb\u7bc9\u3057\u305f[Aerospike](http://www.aerospike.com/)\u306e\u74b0\u5883\uff08[Aerospike\u74b0\u5883\u69cb\u7bc9\u30e1\u30e2 on GCP](http://qiita.com/toremo/items/b3b19831a4235f259301)\uff09\u3092\u4f7f\u3063\u3066CLI\u30d9\u30fc\u30b9\u3067\u3044\u3058\u3063\u3066\u307f\u305f\u306e\u3067\u305d\u306e\u30e1\u30e2\u3002\n\n# Aerospike\u306e\u30c7\u30fc\u30bf\u69cb\u6210\n![Configuring Aerospike - Part 2 2015-10-07 18-40-31.png](https://qiita-image-store.s3.amazonaws.com/0/63069/f3eb4955-2557-82ba-780d-f774eb433b28.png \"Configuring Aerospike - Part 2 2015-10-07 18-40-31.png\")\n\n|\u533a\u5206|\u5b9a\u7fa9|\n|:--|:--|\n|Cluster|Aerospike\u306e\u30af\u30e9\u30b9\u30bf\u30fc|\n|Node|\u30af\u30e9\u30b9\u30bf\u30fc\u306e\u69cb\u6210\u8981\u7d20|\n|Namespace|\u72ec\u7acb\u3057\u305f\u30b9\u30c8\u30ec\u30fc\u30b8\u9818\u57df\u3002\u8907\u6570\u5b9a\u7fa9\u53ef\u80fd\u3060\u304cNamespace\u3092\u8de8\u3044\u3060\u53c2\u7167\u306f\u3067\u304d\u306a\u3044\u3002RBD\u3067\u3044\u3046\u3068\u3053\u308d\u306e`database`\u3084`scheme`\u306b\u8fd1\u3044\u3002|\n|Set|Record\u3092\u30b0\u30eb\u30fc\u30d4\u30f3\u30b0\u3057\u305f\u9818\u57df\u3002RDB\u306e`Table`\u306b\u8fd1\u3044\u3002|\n|Record|\u30c7\u30fc\u30bf\u3092\u51fa\u3057\u5165\u308c\u3059\u308b\u5358\u4f4d\u3002Value\u306fJSON\u5f62\u5f0f\u3002RDB\u306e`Raw`\u306b\u8fd1\u3044\u3002|\n|Bin|\u30c7\u30fc\u30bf\u306e\u6700\u5c0f\u5358\u4f4d\u3002Record\u3092\u69cb\u6210\u3059\u308b\u30d1\u30fc\u30c4\u3002Json\u306e\u8981\u7d20\u306b\u5f53\u305f\u308b\u3002|\n\n## namespace\n* [\u516c\u5f0f\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8](http://www.aerospike.com/docs/operations/configure/namespace/)\n* namespace\u306fConfig\u30d5\u30a1\u30a4\u30eb\uff08`/etc/aerospike/aerospike.conf`\uff09\u3092\u7de8\u96c6\u3057\u3066\u518d\u8d77\u52d5\u3059\u308c\u3070\u8ffd\u52a0\u3084\u5909\u66f4\u304c\u3067\u304d\u308b\n* \u8a2d\u5b9a\u53ef\u80fd\u306a\u9805\u76ee\u306f[Configuration Reference](http://www.aerospike.com/docs/reference/configuration/)\u3092\u53c2\u7167\n* \u8a2d\u5b9a\u306e\u53cd\u6620\u306b\u306fNode\u306e\u518d\u8d77\u52d5\u304c\u5fc5\u8981\n* \u5168\u3066\u306eNode\u306b\u8a2d\u5b9a\u3092\u53cd\u6620\u3057\u306a\u3044\u3068\u30af\u30e9\u30b9\u30bf\u30fc\u9593\u306e\u6574\u5408\u304c\u53d6\u308c\u306a\u304f\u306a\u308b\n* \u5168Node\u306b\u4e00\u62ec\u53cd\u6620\u307f\u305f\u3044\u306e\u306f\u306a\u3055\u305d\u3046\n* \u3088\u3063\u3066\u3001\u305d\u3093\u306a\u306b\u983b\u7e41\u306b\u4f5c\u3063\u305f\u308a\u6d88\u3057\u305f\u308a\u3059\u308b\u3082\u306e\u3067\u306f\u306a\u3055\u305d\u3046\n\n# \u30c7\u30fc\u30bf\u3092\u64cd\u4f5c\u3059\u308b(AQL\u7248)\n[Aerospike\u3000Query Language(AQL)](http://www.aerospike.com/docs/tools/aql/)\u3068\u3044\u3046SQL\u30e9\u30a4\u30af\u306b\u30c7\u30fc\u30bf\u3092\u64cd\u4f5c\u3067\u304d\u308b\u30b3\u30de\u30f3\u30c9\u30e9\u30a4\u30f3\u30c4\u30fc\u30eb\u304c\u7528\u610f\u3055\u308c\u3066\u3044\u308b\u306e\u3067\u305d\u308c\u3092\u4f7f\u3063\u3066\u30c7\u30fc\u30bf\u3092\u64cd\u4f5c\u3057\u3066\u307f\u308b\u3002\n\n## AQL\u306e\u30d7\u30ed\u30f3\u30d7\u30c8\u3092\u958b\u304f\n```\n$ aql\n```\n\u30c7\u30d5\u30a9\u30eb\u30c8\u306eAerospike\u30b5\u30fc\u30d0\u5185\u306b\u3044\u308b\u306a\u3089\u3053\u308c\u3067OK\u3002\n\u5916\u90e8\u304b\u3089\u30a2\u30af\u30bb\u30b9\u3059\u308b\u5834\u5408\u306f\u30de\u30cb\u30e5\u30a2\u30eb\u306b\u5247\u3063\u3066`-h`\u3084`-p`\u306a\u3069\u306e\u30aa\u30d7\u30b7\u30e7\u30f3\u3092\u6307\u5b9a\u3059\u308b\u3002\n\n## \u30c7\u30fc\u30bf\u306e\u633f\u5165\n```\nINSERT INTO <ns>[.<set>] (PK, <bins>) VALUES (<key>, <values>)\n```\n\n* SQL\u306e\u69cb\u6587\u3068\u307b\u307c\u540c\u3058\u3060\u3051\u3069\u3001\u30b9\u30ad\u30fc\u30de\u30ec\u30b9\u306a\u306e\u3067`(PK, <bins>)`\u90e8\u5206\u306e\u7701\u7565\u304c\u3067\u304d\u306a\u3044\u306e\u3068\u3001\uff08\u305f\u3076\u3093\uff091\u30b3\u30de\u30f3\u30c9\u30671\u30ec\u30b3\u30fc\u30c9\u3057\u304b\u5165\u3089\u306a\u3044\u3002\n\n\u4f8b\uff1a\n\n```\naql> insert into test.person (PK, name, age, gender, phone_number) values (1, 'Taro', 20, 'M', 09011112222)\nOK, 1 record affected.\n```\n\n## \u30c7\u30fc\u30bf\u306e\u53c2\u7167\n```\nSELECT * FROM <ns>[.<set>]\n```\n\n\u4f8b\uff1a\n\n```bash\naql> select * from test.person\n+----------+-----+--------+--------------+\n| name     | age | gender | phone_number |\n+----------+-----+--------+--------------+\n| \"Hanako\" | 22  | \"F\"    | 9011113333   |\n| \"Taro\"   | 20  | \"M\"    | 9011112223   |\n+----------+-----+--------+--------------+\n2 rows in set (0.022 secs)\n```\nnamespace\u307e\u305f\u306fset\u306e\u30c7\u30fc\u30bf\u3092\u53c2\u7167\u3059\u308b\u3002\n\n```bash\naql> select name, age from test.person\n+----------+-----+\n| name     | age |\n+----------+-----+\n| \"Hanako\" | 22  |\n| \"Taro\"   | 20  |\n+----------+-----+\n2 rows in set (0.022 secs)\n```\n\u53d6\u5f97\u9805\u76ee\u3092Bin\u3067\u7d5e\u308b\u3053\u3068\u3082\u53ef\u80fd\n\n```bash\naql> select * from test.person where PK = 1\n+--------+-----+--------+--------------+\n| name   | age | gender | phone_number |\n+--------+-----+--------+--------------+\n| \"Taro\" | 20  | \"M\"    | 9011112223   |\n+--------+-----+--------+--------------+\n1 row in set (0.001 secs)\n```\nWHERE\u53e5\u306f\u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u306fPK\uff08Record-Key\uff09\u306e\u7b49\u4fa1\u6bd4\u8f03\u3067\u306e\u307f\u53ef\u80fd\nBin\u5358\u4f4d\u3067\u7d5e\u308b\u306b\u306f\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u3092\u8cbc\u3089\u306a\u3044\u3068\u3044\u3051\u306a\u3044(\u5f8c\u8ff0)\n\n**[note]\nAQL\u3067\u306f\u73fe\u72b6Record-Key\u3092\u53c2\u7167\u3067\u304d\u306a\u3044\u3089\u3057\u3044\n\u66f4\u65b0\u3084\u524a\u9664\u306b\u306fKey\u304c\u5fc5\u8981\u306a\u3053\u3068\u3092\u8003\u3048\u308b\u3068AQL\u3067\u30c7\u30fc\u30bf\u64cd\u4f5c\u3059\u308b\u306b\u306f\u9650\u754c\u304c\u3042\u308b**\n\n## \u30c7\u30fc\u30bf\u306e\u66f4\u65b0\n* UPDAET\u69cb\u6587\u306f\u306a\u3044\u3002\n* \u540c\u3058Key\u540d\u3067INSERT\u3059\u308c\u3070\u4e0a\u66f8\u304b\u308c\u308b\u306e\u3067\u66f4\u65b0\u306b\u306a\u308b\u3002\n* \u305f\u3060\u3057\u3001\u66f4\u65b0\u7bc4\u56f2\u306fRecord\u5358\u4f4d\u3067\u306f\u306a\u304fBin\u5358\u4f4d\u3067\u5b9f\u884c\u3055\u308c\u308b\u70ba\u3001\u66f4\u65b0\u3057\u306a\u304b\u3063\u305fBin\u306f\u305d\u306e\u307e\u307e\u6b8b\u308b\u3002\n\n\u4f8b\uff1a\n\n```bash\naql> select * from test.person where pk = 1\n+--------+-----+--------+--------------+\n| name   | age | gender | phone_number |\n+--------+-----+--------+--------------+\n| \"Taro\" | 20  | \"M\"    | 9011112222   |\n+--------+-----+--------+--------------+\n1 row in set (0.001 secs)\n\naql> insert into test.person (PK, age) values (1, 21)OK, 1 record affected.\n\naql> select * from test.person where pk = 1\n+--------+-----+--------+--------------+\n| name   | age | gender | phone_number |\n+--------+-----+--------+--------------+\n| \"Taro\" | 21  | \"M\"    | 9011112222   |\n+--------+-----+--------+--------------+\n1 row in set (0.000 secs)\n```\n\n## \u30c7\u30fc\u30bf\u306e\u524a\u9664\n```\nDELETE FROM <ns>[.<set>] WHERE PK=<key>\n```\n\u524a\u9664\u306b\u306fPK\uff08Record-key\uff09\u304c\u5fc5\u8981\n\n\u4f8b\uff1a\n\n```bash\naql> delete from test.person where PK = 1\nOK, 1 record affected.\n```\n\n## \u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u3092\u8cbc\u308b\n```\nCREATE INDEX <index> ON <ns>[.<set>] (<bin>) <type>\n```\n\n* \u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u540d\u306fnamespace\u3067\u30e6\u30cb\u30fc\u30af\u3067\u306a\u3044\u3051\u308c\u3070\u306a\u3089\u306a\u3044\n* type\u306f`NUMERIC` or `STRING`\n\n\u4f8b\uff1a\n\n```bash\naql> create index idx_person_age_numeric on test.person (age) numeric\nOK, 1 index added.\n```\n\n\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u3092\u8cbc\u308b\u3068\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u304c\u8cbc\u3089\u308c\u305fBin\u3067where\u53e5\u3092\u4f7f\u3048\u308b\u3002\n\n\u4f8b\uff1a\n\n```bash\naql> select * from test.person where age = 18\n+--------+-----+--------+--------------+\n| name   | age | gender | phone_number |\n+--------+-----+--------+--------------+\n| \"Jiro\" | 18  | \"M\"    | 9022223333   |\n+--------+-----+--------+--------------+\n1 row in set (0.002 secs)\n```\n\n```bash\naql> select * from test.person where age between 18 and 20\n+--------+-----+--------+--------------+\n| name   | age | gender | phone_number |\n+--------+-----+--------+--------------+\n| \"Jiro\" | 18  | \"M\"    | 9022223333   |\n| \"Taro\" | 20  | \"M\"    | 9011112222   |\n+--------+-----+--------+--------------+\n2 rows in set (0.002 secs)\n```\n\n# \u30c7\u30fc\u30bf\u3092\u64cd\u4f5c\u3059\u308b\uff08ascli\u7248\uff09\n\u5358\u7d14\u306bKey\u6307\u5b9a\u3067\u30c7\u30fc\u30bf\u306e\u51fa\u3057\u5165\u308c\u3084\u53c2\u7167\u3092\u3059\u308b\u3060\u3051\u306a\u3089[Aerospike CLI](http://www.aerospike.com/docs/tools/ascli/)\n\u3092\u4f7f\u3063\u3066\u3082\u53ef\u80fd\u3002\n\n## \u30c7\u30fc\u30bf\u64cd\u4f5c\u7cfb\n### put\nrecord\u306e\u633f\u5165\n\n```\nascli put <ns> <set> <record-key> <record-value>\n```\n* record-value\u306fJSON\u5f62\u5f0f\u3002\n* \u6210\u5426\u306f\u7d42\u4e86\u30b3\u30fc\u30c9\u304c0\u304b\u3069\u3046\u304b\n* namespace/set/record-key\u304c\u5168\u3066\u540c\u4e00\u306e\u30c7\u30fc\u30bf\u304c\u3042\u308b\u5834\u5408\u306f\u4e0a\u66f8\u304b\u308c\u308b\n\n\u4f8b\uff1a\n\n```bash\n$ ascli put test settest keytest '{\"name\":\"hoge\", \"age\":30, \"array\":[1,2,3], \"map\":{\"mapkey\":\"mapvalue\"}}'\n$ echo $?\n0\n```\n\n### get\nrecord-value\u306e\u53d6\u5f97\n\n```\nascli get <ns> <set> <record-key>\n```\n\n\u4f8b\uff1a\n\n```bash\n$ ascli get test settest keytest\n{\"map\": { \"mapkey\": \"mapvalue\" }, \"array\": [ 1, 2, 3 ], \"name\": \"hoge\", \"age\": 30}\n```\n\n### exists\nrecord-key\u306e\u5b58\u5728\u78ba\u8a8d\n\n```\nascli exists <ns> <set> <record-key>\n```\n\n* \u5b58\u5728\u306e\u6709\u7121\u306f\u7d42\u4e86\u30b3\u30fc\u30c9\u304c0\u304b\u3069\u3046\u304b\n\n\u4f8b\uff1a\n\n```bash\n$ ascli exists test settest keytest\nKey keytest exists.\n$ echo $?\n0\n\n$ ascli exists test settest keytest2\nKey keytest2 does not exist.\n$ echo $?\n2\n```\n\n### remove\nrecord\u306e\u524a\u9664\n\n```\nascli remove <ns> <set> <record-key>\n```\n\n* \u6210\u5426\u306f\u7d42\u4e86\u30b3\u30fc\u30c9\u304c0\u304b\u3069\u3046\u304b\n\n\u4f8b\uff1a\n\n```bash\n$ ascli remove test settest keytest\n$ echo $?\n0\n\n$ ascli remove test settest keytest\nERROR 2 AEROSPIKE_ERR_RECORD_NOT_FOUND\n$ echo $?\n2\n```\n\n## Scripting\n### eval\n\u4e00\u9023\u306eascli\u306e\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3067\u304d\u308b\u30b7\u30f3\u30d7\u30eb\u306a\u30b9\u30af\u30ea\u30d7\u30c6\u30a3\u30f3\u30b0\u74b0\u5883\u3092\u547c\u3073\u51fa\u3059\u3002\n\n```\nascli eval\n```\n\n* \u6a19\u6e96\u5165\u529b\u304b\u3089\u306e\u30b3\u30de\u30f3\u30c9\u3092\u8aad\u307f\u8fbc\u3080\u306e\u3067\u9069\u5f53\u306aFile\u306b\u66f8\u3044\u305f\u30b3\u30de\u30f3\u30c9\u3092\u30d1\u30a4\u30d4\u30f3\u30b0\u3057\u3066\u5b9f\u884c\u3082\u3067\u304d\u308b\n* eval\u72ec\u81ea\u306e\u30b3\u30de\u30f3\u30c9\u3082\u3042\u308b\n* \u30b3\u30de\u30f3\u30c9\u306f\u30b9\u30bf\u30c3\u30af\u306b\u4fdd\u6301\u3055\u308c\u308b\n* \u30b9\u30bf\u30c3\u30af\u306f1\u30b3\u30de\u30f3\u30c91000\u6587\u5b57\u307e\u3067\u3067\u30011000\u30b3\u30de\u30f3\u30c9\u307e\u3067\u4fdd\u6301\u3059\u308b\u3002\n\n**[Note]\neval\u306f\u30b7\u30f3\u30b0\u30eb\u30b9\u30ec\u30c3\u30c9\u3067\u52d5\u4f5c\u3057\u3001\u5168\u3066\u306e\u547c\u3073\u51fa\u3057\u3092\u30d6\u30ed\u30c3\u30af\u3059\u308b\u3053\u3068\u306b\u6ce8\u610f\u3059\u308b**\n\neval\u306e\u72ec\u81ea\u30b3\u30de\u30f3\u30c9\u306f\u4ee5\u4e0b\u3002\n\n|\u30b3\u30de\u30f3\u30c9|\u8aac\u660e|\n|:--|:--|\n|:print|\u6700\u5f8c\u306e\u30b3\u30de\u30f3\u30c9\u304b\u3089\u306e\u7d71\u8a08\u60c5\u5831\u3092\u8868\u793a\u3059\u308b|\n|:reset|\u84c4\u7a4d\u3055\u308c\u305f\u7d71\u8a08\u60c5\u5831\u3092\u30ea\u30bb\u30c3\u30c8\u3059\u308b|\n|:repeat n|\u30b9\u30bf\u30c3\u30af\u4e0a\u306e\u5168\u3066\u306e\u30b3\u30de\u30f3\u30c9\u3092n\u56de\u7e70\u308a\u8fd4\u3059|\n|:clear|\u30b9\u30bf\u30c3\u30af\u3092\u7a7a\u306b\u3059\u308b|\n|:quit|eval\u304b\u3089\u629c\u3051\u308b|\n\n\u4f8b\uff1a\n\n```bash\n$ ascli eval\nput test evaltest test1 '{\"name\":\"hoge\"}'\n:print\n>>\n  time:    0.94500 ms\n  success: 1\n  failure: 0\n:reset\n:print\n>>\n  time:    0.00000 ms\n  success: 0\n  failure: 0\n:clear\nget test evaltest test1\n{\"name\": \"hoge\"}\n:reset\n:repeat 10\n{\"name\": \"hoge\"}\n{\"name\": \"hoge\"}\n{\"name\": \"hoge\"}\n{\"name\": \"hoge\"}\n{\"name\": \"hoge\"}\n{\"name\": \"hoge\"}\n{\"name\": \"hoge\"}\n{\"name\": \"hoge\"}\n{\"name\": \"hoge\"}\n{\"name\": \"hoge\"}\n:print\n>>\n  time:    4.98200 ms\n  success: 10\n  failure: 0\n:quit\n```\n\n\u30d5\u30a1\u30a4\u30eb\u304b\u3089\u5b9f\u884c\u3059\u308b\u5834\u5408\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u611f\u3058\u3067OK\u3002\n\n```bash\n$ cat {evalfile} | ascli eval\n```\n\n# \u6240\u611f\n\u5358\u7d14\u306a\u30c7\u30fc\u30bf\u64cd\u4f5c\u306a\u3089\u3044\u3044\u3051\u3069\u3001\u3061\u3087\u3063\u3068\u8907\u96d1\u306a\u3053\u3068\u3084\u308d\u3046\u3068\u3059\u308b\u3068\u624b\u8a70\u307e\u308a\u305d\u3046\u306a\u611f\u3058\u3002Aerospike\u306fUDF\u304c\u5b9a\u7fa9\u3067\u304d\u308b\u307f\u305f\u3044\u306a\u306e\u3067\u8907\u96d1\u306a\u51e6\u7406\u306f\u305d\u3063\u3061\u3067\u3084\u308c\u3063\u3066\u3068\u3053\u308d\u304b\u306a\u3001\u3068\u601d\u3044\u307e\u3057\u305f\u3002\n\u3068\u308a\u3042\u3048\u305a\u4eca\u56de\u306e\u76ee\u7684\u306f\u30c7\u30fc\u30bf\u69cb\u6210\u306e\u7406\u89e3\u306a\u306e\u3067\u4e00\u65e6\u3053\u3093\u306a\u3082\u3093\u3067\u3002\n\u6b21\u306fClient\u3092\u4f7f\u3063\u3066\u3054\u306b\u3087\u3054\u306b\u3087\u3084\u308b\u4e88\u5b9a\u3002\n", "tags": ["Aerospike"]}