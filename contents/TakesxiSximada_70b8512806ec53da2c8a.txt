{"context": "\n\u6d41\u308c\u3068\u3057\u3066\u306f\u3053\u3093\u306a\u611f\u3058\u3002\n\nAPI\u3067\u524d\u56de\u306e\u6210\u529f\u30c6\u30b9\u30c8\u306e\u30ea\u30d3\u30b8\u30e7\u30f3\u3092\u53d6\u5f97\n\ngit dif --stat --name-only \u3067\u30d5\u30a1\u30a4\u30eb\u306e\u4e00\u89a7\u3092\u53d6\u5f97\u3059\u308b\n\n\nCirleCI\u306eAPI\u3067\u524d\u56de\u306e\u6210\u529f\u30c6\u30b9\u30c8\u306e\u60c5\u5831\u3092\u53d6\u5f97\u3059\u308b\n\nGET: /project/:vcs-type/:username/:project\nBuild summary for each of the last 30 builds for a single git repo.\n\nCircleCI REST API - CircleCI (https://circleci.com/docs/api/#summary) \u3088\u308a\n\u3053\u308c\u3092\u4f7f\u3048\u3070\u6700\u8fd1\u6210\u529f\u3057\u305f\u30c6\u30b9\u30c8\u306e\u60c5\u5831\u3092\u53d6\u5f97\u3067\u304d\u305d\u3046\u3067\u3059\u3002cURL\u3067\u6700\u3082\u65b0\u3057\u3044\u6210\u529f\u3057\u305f\u30c6\u30b9\u30c8API\u3067\u53d6\u5f97\u3057\u3066\u307f\u307e\u3059\u3002circle-token\u306f\u4e8b\u524d\u306b https://circleci.com/account/api \u3067\u4f5c\u6210\u3057\u3066\u304a\u304d\u307e\u3057\u305f\u3002\n\n\ncURL\u3067\u6700\u3082\u65b0\u3057\u3044\u6210\u529f\u3057\u305f\u30c6\u30b9\u30c8API\u3067\u53d6\u5f97\u3057\u3066\u307f\u308b\n$ curl 'https://circleci.com/api/v1.1/project/github/PROJECT/REPOSITORY?circle-token=MASKMASKMASKMASKMASKMASKMASKMASKMASK&limit=1&offset=0&filter=completed'\n\n\n\u6b21\u306e\u3088\u3046\u306a\u30ec\u30b9\u30dd\u30f3\u30b9\u304c\u8fd4\u3055\u308c\u307e\u3059\u3002\n[\n  {\n    \"compare\": \"https://github.com/MASKMASK/MASK/compare/9849be5efbe1...b31f4f224547\",\n    \"previous_successful_build\": null,\n    \"build_parameters\": null,\n    \"oss\": true,\n    \"all_commit_details_truncated\": false,\n    \"committer_date\": \"2016-09-23T00:17:41+09:00\",\n    \"body\": \"\",\n    \"usage_queued_at\": \"2016-09-22T15:17:58.886Z\",\n    \"fail_reason\": null,\n    \"retry_of\": null,\n    \"reponame\": \"MASK\",\n    \"ssh_users\": [],\n    \"build_url\": \"https://circleci.com/gh/MASKMASK/MASK/5\",\n    \"parallel\": 1,\n    \"failed\": null,\n    \"branch\": \"master\",\n    \"username\": \"MASKMASK\",\n    \"author_date\": \"2016-09-23T00:17:41+09:00\",\n    \"why\": \"github\",\n    \"user\": {\n      \"is_user\": false,\n      \"login\": \"MASKMASK\",\n      \"vcs_type\": \"github\"\n    },\n    \"vcs_revision\": \"b31f4f2245476f5f834049ad1bd70557f4b8ef8b\",\n    \"vcs_tag\": null,\n    \"build_num\": 5,\n    \"infrastructure_fail\": false,\n    \"committer_email\": \"test@example.com\",\n    \"previous\": {\n      \"build_num\": 2,\n      \"status\": \"failed\",\n      \"build_time_millis\": 14155\n    },\n    \"status\": \"no_tests\",\n    \"committer_name\": \"MASKMASK\",\n    \"retries\": null,\n    \"subject\": \"update readme\",\n    \"vcs_type\": \"github\",\n    \"timedout\": false,\n    \"dont_build\": null,\n    \"lifecycle\": \"finished\",\n    \"no_dependency_cache\": false,\n    \"stop_time\": \"2016-09-22T15:18:08.591Z\",\n    \"ssh_disabled\": false,\n    \"build_time_millis\": 18472,\n    \"circle_yml\": null,\n    \"messages\": [],\n    \"is_first_green_build\": false,\n    \"job_name\": null,\n    \"start_time\": \"2016-09-22T15:17:50.119Z\",\n    \"canceler\": null,\n    \"all_commit_details\": [\n      {\n        \"committer_date\": \"2016-09-23T00:17:41+09:00\",\n        \"body\": \"\",\n        \"branch\": \"master\",\n        \"author_date\": \"2016-09-23T00:17:41+09:00\",\n        \"committer_email\": \"test@example.com\",\n        \"commit\": \"b31f4f2245476f5f834049ad1bd70557f4b8ef8b\",\n        \"committer_login\": \"MASKMASK\",\n        \"committer_name\": \"MASKMASK\",\n        \"subject\": \"update readme\",\n        \"commit_url\": \"https://github.com/MASKMASK/MASK/commit/b31f4f2245476f5f834049ad1bd70557f4b8ef8b\",\n        \"author_login\": \"MASKMASK\",\n        \"author_name\": \"MASKMASK\",\n        \"author_email\": \"test@example.com\"\n      }\n    ],\n    \"outcome\": \"no_tests\",\n    \"vcs_url\": \"https://github.com/MASKMASK/MASK\",\n    \"author_name\": \"MASKMASK\",\n    \"node\": null,\n    \"queued_at\": \"2016-09-22T15:17:50.037Z\",\n    \"canceled\": false,\n    \"author_email\": \"test@example.com\"\n  }\n]\n\n\n\u53d6\u308c\u3066\u3044\u307e\u3059\u306d\u3002\n\n(\u8ffd\u8a18: 2017\u5e74 1\u670828\u65e5)\n\u6700\u3082\u65b0\u3057\u3044\u6210\u529f\u3057\u305f\u30c6\u30b9\u30c8API\u3067\u53d6\u5f97\u3059\u308b https://circleci.com/api/v1.1/:project/github/:PROJECT/:REPOSITORY \u306eAPI\u306fPersonal API Token(\u30a2\u30ab\u30a6\u30f3\u30c8\u306b\u7d10\u4ed8\u304fAPI\u30c8\u30fc\u30af\u30f3)\u3067\u306f\u306a\u304f\u3001API Permission(\u30ea\u30dd\u30b8\u30c8\u30ea\u306b\u7d10\u4ed8\u304fAPI\u30c8\u30fc\u30af\u30f3)\u3067\u3082\u53d6\u5f97\u3067\u304d\u307e\u3059\u3002API Permission\u306e\u5834\u5408\u306f\u30b9\u30b3\u30fc\u30d7\u3092Build Artifacts(view-builds)\u4ee5\u4e0a\u306b\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002Personal API Token\u3067\u306f\u4ed6\u306e\u30ea\u30dd\u30b8\u30c8\u30ea\u306b\u5bfe\u3057\u3066\u3082\u6a29\u9650\u3092\u4e0e\u3048\u308b\u3053\u3068\u306b\u306a\u308b\u306e\u3067\u3001API Permission\u306e\u65b9\u304c\u9069\u5207\u306a\u5834\u5408\u304c\u591a\u3044\u3067\u3059\u3002\n(\u8ffd\u8a18\u3053\u3053\u307e\u3067)\n\nAPI\u306e\u30ec\u30b9\u30dd\u30f3\u30b9\u304b\u3089\u5f53\u6642\u4f7f\u308f\u308c\u305f\u30ea\u30d3\u30b8\u30e7\u30f3\u756a\u53f7\u3092\u53d6\u5f97\u3059\u308b\n\u5148\u307b\u3069\u306e\u30ec\u30b9\u30dd\u30f3\u30b9\u3092\u898b\u308b\u3068vcs_revision\u304c\u3042\u3063\u3066\u3053\u308c\u304cgit\u306e\u30ea\u30d3\u30b8\u30e7\u30f3\u306b\u306a\u3063\u3066\u3044\u308b\u3088\u3046\u3067\u3059\u3002jq\u3092\u4f7f\u3063\u3066\u30ea\u30d3\u30b8\u30e7\u30f3\u756a\u53f7\u3060\u3051\u53d6\u5f97\u3057\u3066\u307f\u307e\u3059\u3002\n\n\u30ec\u30b9\u30dd\u30f3\u30b9\u304b\u3089revision\u3092\u53d6\u5f97\u3059\u308b\n$ cat response.json | jq .[0].vcs_revision\n\"b31f4f2245476f5f834049ad1bd70557f4b8ef8b\"\n\n\n\u53d6\u5f97\u3067\u304d\u3066\u3044\u305d\u3046\u3067\u3059\u3002\n\nGit\u3067\u5dee\u5206\u306e\u3042\u3063\u305f\u30d5\u30a1\u30a4\u30eb\u306e\u4e00\u89a7\u3092\u53d6\u5f97\u3059\u308b\ngit diff --stat --name-only dce394e22941ebc4ef9c3cb6988b0bd2c12ec668...\nsrc/qiitap/__init__.py\nsrc/qiitap/articles.py\nsrc/qiitap/commands/render.py\n\n\ncircle.yml\u306b\u307e\u3068\u3081\u308b\n\ncircle.yml\ndeployment:\n  production:\n    branch: master\n    commands:\n      - curl 'https://circleci.com/api/v1.1/project/github/TakesxiSximada/TIL?circle-token=$CIRCLE_TOKEN&limit=1&offset=0&filter=completed' | jq -r .[0].vcs_revision > PREV_REVISION\n      - git diff --stat --name-only `cat PREV_REVISION`...\n\n\n\n<!---\n\n\n--->\n\n\u6d41\u308c\u3068\u3057\u3066\u306f\u3053\u3093\u306a\u611f\u3058\u3002\n\n1. API\u3067\u524d\u56de\u306e\u6210\u529f\u30c6\u30b9\u30c8\u306e\u30ea\u30d3\u30b8\u30e7\u30f3\u3092\u53d6\u5f97\n2. `git dif --stat --name-only` \u3067\u30d5\u30a1\u30a4\u30eb\u306e\u4e00\u89a7\u3092\u53d6\u5f97\u3059\u308b\n\n## CirleCI\u306eAPI\u3067\u524d\u56de\u306e\u6210\u529f\u30c6\u30b9\u30c8\u306e\u60c5\u5831\u3092\u53d6\u5f97\u3059\u308b\n\n> GET: /project/:vcs-type/:username/:project\n> Build summary for each of the last 30 builds for a single git repo.\n\n[CircleCI REST API - CircleCI (https://circleci.com/docs/api/#summary)](https://circleci.com/docs/api/#summary) \u3088\u308a\n\n\u3053\u308c\u3092\u4f7f\u3048\u3070\u6700\u8fd1\u6210\u529f\u3057\u305f\u30c6\u30b9\u30c8\u306e\u60c5\u5831\u3092\u53d6\u5f97\u3067\u304d\u305d\u3046\u3067\u3059\u3002cURL\u3067\u6700\u3082\u65b0\u3057\u3044\u6210\u529f\u3057\u305f\u30c6\u30b9\u30c8API\u3067\u53d6\u5f97\u3057\u3066\u307f\u307e\u3059\u3002circle-token\u306f\u4e8b\u524d\u306b https://circleci.com/account/api \u3067\u4f5c\u6210\u3057\u3066\u304a\u304d\u307e\u3057\u305f\u3002\n\n![img](https://github.com/TakesxiSximada/TIL/raw/master/circleci/difference-files/img/circleci-api-token.png)\n\n```sh:cURL\u3067\u6700\u3082\u65b0\u3057\u3044\u6210\u529f\u3057\u305f\u30c6\u30b9\u30c8API\u3067\u53d6\u5f97\u3057\u3066\u307f\u308b\n$ curl 'https://circleci.com/api/v1.1/project/github/PROJECT/REPOSITORY?circle-token=MASKMASKMASKMASKMASKMASKMASKMASKMASK&limit=1&offset=0&filter=completed'\n```\n\n\u6b21\u306e\u3088\u3046\u306a\u30ec\u30b9\u30dd\u30f3\u30b9\u304c\u8fd4\u3055\u308c\u307e\u3059\u3002\n\n```\n[\n  {\n    \"compare\": \"https://github.com/MASKMASK/MASK/compare/9849be5efbe1...b31f4f224547\",\n    \"previous_successful_build\": null,\n    \"build_parameters\": null,\n    \"oss\": true,\n    \"all_commit_details_truncated\": false,\n    \"committer_date\": \"2016-09-23T00:17:41+09:00\",\n    \"body\": \"\",\n    \"usage_queued_at\": \"2016-09-22T15:17:58.886Z\",\n    \"fail_reason\": null,\n    \"retry_of\": null,\n    \"reponame\": \"MASK\",\n    \"ssh_users\": [],\n    \"build_url\": \"https://circleci.com/gh/MASKMASK/MASK/5\",\n    \"parallel\": 1,\n    \"failed\": null,\n    \"branch\": \"master\",\n    \"username\": \"MASKMASK\",\n    \"author_date\": \"2016-09-23T00:17:41+09:00\",\n    \"why\": \"github\",\n    \"user\": {\n      \"is_user\": false,\n      \"login\": \"MASKMASK\",\n      \"vcs_type\": \"github\"\n    },\n    \"vcs_revision\": \"b31f4f2245476f5f834049ad1bd70557f4b8ef8b\",\n    \"vcs_tag\": null,\n    \"build_num\": 5,\n    \"infrastructure_fail\": false,\n    \"committer_email\": \"test@example.com\",\n    \"previous\": {\n      \"build_num\": 2,\n      \"status\": \"failed\",\n      \"build_time_millis\": 14155\n    },\n    \"status\": \"no_tests\",\n    \"committer_name\": \"MASKMASK\",\n    \"retries\": null,\n    \"subject\": \"update readme\",\n    \"vcs_type\": \"github\",\n    \"timedout\": false,\n    \"dont_build\": null,\n    \"lifecycle\": \"finished\",\n    \"no_dependency_cache\": false,\n    \"stop_time\": \"2016-09-22T15:18:08.591Z\",\n    \"ssh_disabled\": false,\n    \"build_time_millis\": 18472,\n    \"circle_yml\": null,\n    \"messages\": [],\n    \"is_first_green_build\": false,\n    \"job_name\": null,\n    \"start_time\": \"2016-09-22T15:17:50.119Z\",\n    \"canceler\": null,\n    \"all_commit_details\": [\n      {\n        \"committer_date\": \"2016-09-23T00:17:41+09:00\",\n        \"body\": \"\",\n        \"branch\": \"master\",\n        \"author_date\": \"2016-09-23T00:17:41+09:00\",\n        \"committer_email\": \"test@example.com\",\n        \"commit\": \"b31f4f2245476f5f834049ad1bd70557f4b8ef8b\",\n        \"committer_login\": \"MASKMASK\",\n        \"committer_name\": \"MASKMASK\",\n        \"subject\": \"update readme\",\n        \"commit_url\": \"https://github.com/MASKMASK/MASK/commit/b31f4f2245476f5f834049ad1bd70557f4b8ef8b\",\n        \"author_login\": \"MASKMASK\",\n        \"author_name\": \"MASKMASK\",\n        \"author_email\": \"test@example.com\"\n      }\n    ],\n    \"outcome\": \"no_tests\",\n    \"vcs_url\": \"https://github.com/MASKMASK/MASK\",\n    \"author_name\": \"MASKMASK\",\n    \"node\": null,\n    \"queued_at\": \"2016-09-22T15:17:50.037Z\",\n    \"canceled\": false,\n    \"author_email\": \"test@example.com\"\n  }\n]\n\n```\n\n\u53d6\u308c\u3066\u3044\u307e\u3059\u306d\u3002\n\n###### (\u8ffd\u8a18: 2017\u5e74 1\u670828\u65e5)\n\n\u6700\u3082\u65b0\u3057\u3044\u6210\u529f\u3057\u305f\u30c6\u30b9\u30c8API\u3067\u53d6\u5f97\u3059\u308b https://circleci.com/api/v1.1/:project/github/:PROJECT/:REPOSITORY \u306eAPI\u306fPersonal API Token(\u30a2\u30ab\u30a6\u30f3\u30c8\u306b\u7d10\u4ed8\u304fAPI\u30c8\u30fc\u30af\u30f3)\u3067\u306f\u306a\u304f\u3001API Permission(\u30ea\u30dd\u30b8\u30c8\u30ea\u306b\u7d10\u4ed8\u304fAPI\u30c8\u30fc\u30af\u30f3)\u3067\u3082\u53d6\u5f97\u3067\u304d\u307e\u3059\u3002API Permission\u306e\u5834\u5408\u306f\u30b9\u30b3\u30fc\u30d7\u3092Build Artifacts(view-builds)\u4ee5\u4e0a\u306b\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002Personal API Token\u3067\u306f\u4ed6\u306e\u30ea\u30dd\u30b8\u30c8\u30ea\u306b\u5bfe\u3057\u3066\u3082\u6a29\u9650\u3092\u4e0e\u3048\u308b\u3053\u3068\u306b\u306a\u308b\u306e\u3067\u3001API Permission\u306e\u65b9\u304c\u9069\u5207\u306a\u5834\u5408\u304c\u591a\u3044\u3067\u3059\u3002\n\n(\u8ffd\u8a18\u3053\u3053\u307e\u3067)\n\n\n## API\u306e\u30ec\u30b9\u30dd\u30f3\u30b9\u304b\u3089\u5f53\u6642\u4f7f\u308f\u308c\u305f\u30ea\u30d3\u30b8\u30e7\u30f3\u756a\u53f7\u3092\u53d6\u5f97\u3059\u308b\n\n\u5148\u307b\u3069\u306e\u30ec\u30b9\u30dd\u30f3\u30b9\u3092\u898b\u308b\u3068vcs_revision\u304c\u3042\u3063\u3066\u3053\u308c\u304cgit\u306e\u30ea\u30d3\u30b8\u30e7\u30f3\u306b\u306a\u3063\u3066\u3044\u308b\u3088\u3046\u3067\u3059\u3002jq\u3092\u4f7f\u3063\u3066\u30ea\u30d3\u30b8\u30e7\u30f3\u756a\u53f7\u3060\u3051\u53d6\u5f97\u3057\u3066\u307f\u307e\u3059\u3002\n\n\n```sh:\u30ec\u30b9\u30dd\u30f3\u30b9\u304b\u3089revision\u3092\u53d6\u5f97\u3059\u308b\n$ cat response.json | jq .[0].vcs_revision\n\"b31f4f2245476f5f834049ad1bd70557f4b8ef8b\"\n```\n\n\u53d6\u5f97\u3067\u304d\u3066\u3044\u305d\u3046\u3067\u3059\u3002\n\n## Git\u3067\u5dee\u5206\u306e\u3042\u3063\u305f\u30d5\u30a1\u30a4\u30eb\u306e\u4e00\u89a7\u3092\u53d6\u5f97\u3059\u308b\n\n```\ngit diff --stat --name-only dce394e22941ebc4ef9c3cb6988b0bd2c12ec668...\nsrc/qiitap/__init__.py\nsrc/qiitap/articles.py\nsrc/qiitap/commands/render.py\n```\n\n## circle.yml\u306b\u307e\u3068\u3081\u308b\n\n\n```yaml:circle.yml\ndeployment:\n  production:\n    branch: master\n    commands:\n      - curl 'https://circleci.com/api/v1.1/project/github/TakesxiSximada/TIL?circle-token=$CIRCLE_TOKEN&limit=1&offset=0&filter=completed' | jq -r .[0].vcs_revision > PREV_REVISION\n      - git diff --stat --name-only `cat PREV_REVISION`...\n\n```\n", "tags": ["CircleCI"]}