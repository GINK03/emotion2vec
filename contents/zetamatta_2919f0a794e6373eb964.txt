{"context": " More than 1 year has passed since last update.\u3068\u3044\u3046 VBScript \u3092\u66f8\u3044\u3066\u307f\u307e\u3057\u305f(Windows7 \u5411\u3051)\n\n\u8d77\u52d5\u3059\u308b\u3068\u3001UAC \u306e\u30c0\u30a4\u30a2\u30ed\u30b0\u304c\u8868\u793a\u3055\u308c\u307e\u3059\u3002\n\u300c\u306f\u3044(Y)\u300d\u3068\u3059\u308b\u3068\u3001\u30e1\u30e2\u5e33\u3067 %PATH% \u306e\u5185\u5bb9\u304c\u958b\u304b\u308c\u307e\u3059\n\uff08\u3053\u306e\u6642\u70b9\u3067\u3001\u30bb\u30df\u30b3\u30ed\u30f3\u300c;\u300d\u306f\u6539\u884c\u306b\u7f6e\u63db\u3055\u308c\u3066\u3044\u307e\u3059\uff09\u3002\n\u4fee\u6b63\u3057\u3066\u30bb\u30fc\u30d6\u3059\u308b\u3068\uff08\u6539\u884c\u3092\u30bb\u30df\u30b3\u30ed\u30f3\u300c;\u300d\u306b\u7f6e\u304d\u63db\u3048\u3066\uff09\u30b7\u30b9\u30c6\u30e0\u74b0\u5883\u5909\u6570\u306e\u30c7\u30d5\u30a9\u30eb\u30c8\u5024\u3078\u5909\u66f4\u5185\u5bb9\u3092\u66f8\u304d\u8fbc\u307f\u307e\u3059\u3002\n\n\u304a\u4f7f\u3044\u306e PC \u306e\u8a2d\u5b9a\u3092\u5909\u66f4\u3059\u308b\u30b9\u30af\u30ea\u30d7\u30c8\u3067\u3059\u306e\u3067\u3001 \u3054\u5229\u7528\u306f\u8a08\u753b\u7684\u306b\u3002\n\nchpath.vbs\nif WScript.Arguments.Count <= 0 then\n    Set shellApp = CreateObject(\"Shell.Application\")\n    shellApp.ShellExecute \"wscript.exe\",\"\"\"\" & WScript.ScriptFullName & \"\"\" uac\" , \"\" , \"runas\"\n    Set shellApp = Nothing\n    WScript.Quit\nend if\nSet wshShell=CreateObject(\"WScript.Shell\")\nSet objFSO = CreateObject(\"Scripting.FileSystemObject\")\nSet sysEnv=wshShell.Environment\nPath = sysEnv.Item(\"Path\")\nTempName = objFSO.GetTempName()\n\nSet objWriter = objFSO.CreateTextFile(TempName,True,False)\nobjWriter.WriteLine( Replace(Path,\";\",vbcrlf) )\nobjWriter.Close()\nSet objWriter = Nothing\n\nSet objExec = wshShell.Exec(\"notepad \" & TempName)\nDo While objExec.Status = 0\n    WScript.Sleep 100\nLoop\noutput = objExec.StdOut.ReadAll\nif len(output) > 0 then\n    WScript.Echo output\nend if\noutput = objExec.Stderr.ReadAll\nif len(output) > 0 then\n    WScript.Echo output\nend if\n\nSet objReader = objFSO.OpenTextFile(TempName,1)\nPath = Replace(objReader.ReadAll,vbcrlf,\";\")\nif Right(Path,1) = \";\" then\n    Path = Left(path,len(path)-1)\nend if\nobjReader.Close()\nSet objReader = nothing\n\nrem WScript.Echo Path\nobjFSO.DeleteFile(TempName)\nsysEnv.Item(\"Path\") = Path\nSet objFSO = Nothing\n\n\n\n\u53c2\u8003\u306b\u3057\u305f\u30da\u30fc\u30b8\n\nServer World - VBScript \u3092\u7ba1\u7406\u8005\u6a29\u9650\u3067\u5b9f\u884c\n\n\u3068\u3044\u3046 VBScript \u3092\u66f8\u3044\u3066\u307f\u307e\u3057\u305f(Windows7 \u5411\u3051)\n\n1. \u8d77\u52d5\u3059\u308b\u3068\u3001UAC \u306e\u30c0\u30a4\u30a2\u30ed\u30b0\u304c\u8868\u793a\u3055\u308c\u307e\u3059\u3002\n2. \u300c\u306f\u3044(Y)\u300d\u3068\u3059\u308b\u3068\u3001\u30e1\u30e2\u5e33\u3067 %PATH% \u306e\u5185\u5bb9\u304c\u958b\u304b\u308c\u307e\u3059\n\uff08\u3053\u306e\u6642\u70b9\u3067\u3001\u30bb\u30df\u30b3\u30ed\u30f3\u300c`;`\u300d\u306f\u6539\u884c\u306b\u7f6e\u63db\u3055\u308c\u3066\u3044\u307e\u3059\uff09\u3002\n4. \u4fee\u6b63\u3057\u3066\u30bb\u30fc\u30d6\u3059\u308b\u3068\uff08\u6539\u884c\u3092\u30bb\u30df\u30b3\u30ed\u30f3\u300c`;`\u300d\u306b\u7f6e\u304d\u63db\u3048\u3066\uff09\u30b7\u30b9\u30c6\u30e0\u74b0\u5883\u5909\u6570\u306e\u30c7\u30d5\u30a9\u30eb\u30c8\u5024\u3078\u5909\u66f4\u5185\u5bb9\u3092\u66f8\u304d\u8fbc\u307f\u307e\u3059\u3002\n\n\u304a\u4f7f\u3044\u306e PC \u306e\u8a2d\u5b9a\u3092\u5909\u66f4\u3059\u308b\u30b9\u30af\u30ea\u30d7\u30c8\u3067\u3059\u306e\u3067\u3001 **\u3054\u5229\u7528\u306f\u8a08\u753b\u7684\u306b**\u3002\n\n```chpath.vbs\nif WScript.Arguments.Count <= 0 then\n    Set shellApp = CreateObject(\"Shell.Application\")\n    shellApp.ShellExecute \"wscript.exe\",\"\"\"\" & WScript.ScriptFullName & \"\"\" uac\" , \"\" , \"runas\"\n    Set shellApp = Nothing\n    WScript.Quit\nend if\nSet wshShell=CreateObject(\"WScript.Shell\")\nSet objFSO = CreateObject(\"Scripting.FileSystemObject\")\nSet sysEnv=wshShell.Environment\nPath = sysEnv.Item(\"Path\")\nTempName = objFSO.GetTempName()\n\nSet objWriter = objFSO.CreateTextFile(TempName,True,False)\nobjWriter.WriteLine( Replace(Path,\";\",vbcrlf) )\nobjWriter.Close()\nSet objWriter = Nothing\n\nSet objExec = wshShell.Exec(\"notepad \" & TempName)\nDo While objExec.Status = 0\n    WScript.Sleep 100\nLoop\noutput = objExec.StdOut.ReadAll\nif len(output) > 0 then\n    WScript.Echo output\nend if\noutput = objExec.Stderr.ReadAll\nif len(output) > 0 then\n    WScript.Echo output\nend if\n\nSet objReader = objFSO.OpenTextFile(TempName,1)\nPath = Replace(objReader.ReadAll,vbcrlf,\";\")\nif Right(Path,1) = \";\" then\n    Path = Left(path,len(path)-1)\nend if\nobjReader.Close()\nSet objReader = nothing\n\nrem WScript.Echo Path\nobjFSO.DeleteFile(TempName)\nsysEnv.Item(\"Path\") = Path\nSet objFSO = Nothing\n```\n\n# \u53c2\u8003\u306b\u3057\u305f\u30da\u30fc\u30b8\n\n* [Server World - VBScript \u3092\u7ba1\u7406\u8005\u6a29\u9650\u3067\u5b9f\u884c](http://www.server-world.info/query?os=Other&p=vbs&f=1)\n", "tags": ["Windows7", "VBScript5.8"]}