{"context": "\u518d\u73fe\u65b9\u6cd5\u304c\u308f\u304b\u3063\u305f\u306e\u3067\u8ffd\u8a18\u3057\u307e\u3057\u305f(2016/06/21)\nCoreData\u306b\u304a\u3044\u3066\u3001\u4e26\u5217\u51e6\u7406\u9055\u53cd\u6642\u306b\u4f8b\u5916\u3092\u5410\u3044\u3066\u304f\u308c\u308b\u3001-com.apple.CoreData.ConcurrencyDebug 1\u3068\u3044\u3046\u30c7\u30d0\u30c3\u30b0\u30aa\u30d7\u30b7\u30e7\u30f3\u304c\u3042\u308a\u307e\u3059\u3002\nhttp://qiita.com/hongmhoon/items/606a352b1e96dfb0bec5#\u30c7\u30d0\u30c3\u30b0\u3053\u308c\u304c\u91cd\u8981\n\u305f\u3060\u3057\u3053\u306e\u30aa\u30d7\u30b7\u30e7\u30f3\u3001\u30b3\u30fc\u30c9\u4e0a\u306f\u554f\u984c\u306a\u3044\u306f\u305a\u306a\u306e\u306b\u8aa4\u3063\u3066\u4f8b\u5916\u3092\u5410\u3044\u3066\u3057\u307e\u3046\u30b1\u30fc\u30b9\u304c\u3042\u308a\u307e\u3059\u3002\n\n\u518d\u73fe\u4f8b\n\u4f8b\u3048\u3070\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u30b3\u30fc\u30c9\u304c\u3042\u3063\u305f\u3068\u3057\u307e\u3059\u3002\n[privateContext performBlock:^{\n    NSEntityDescription* entADesc = [NSEntityDescription entityForName:@\"EntityA\" inManagedObjectContext:privateContext];\n    EntityA* entA = [[EntityA alloc] initWithEntity:entADesc insertIntoManagedObjectContext:privateContext];\n    entA.foo = @\"aaa\";\n\n    [privateContext save:&error];\n\n    NSManagedObjectContext* parentContext = privateContext.parentContext;\n    [parentContext performBlock:^{\n        [parentContext save:&error];\n    }];\n}];\n\n//fetch EntityB (asyn on main context)    \n[mainContext performBlock:^{\n    NSFetchRequest* req = [NSFetchRequest fetchRequestWithEntityName:@\"EntityB\"];\n    NSArray* results = [mainContext executeFetchRequest:req error:&error];\n}];\n\n//fetch EntityA (asyn on main context)\n[mainContext performBlock:^{\n    NSFetchRequest* req = [NSFetchRequest fetchRequestWithEntityName:@\"EntityA\"];\n    req.fetchBatchSize = 20;\u3000//(1)\n    req.predicate = [NSPredicate predicateWithFormat:@\"foo = %@\", @\"wwww\"]; //(2)\n    NSArray* results = [mainContext executeFetchRequest:req error:&error];  //(3)\n}];\n\n\u3053\u306e\u30b3\u30fc\u30c9\u3092com.apple.CoreData.ConcurrencyDebug\u30aa\u30d7\u30b7\u30e7\u30f3\u4ed8\u304d\u3067\u5b9f\u884c\u3059\u308b\u3068\u3001//(3) \u306e\u884c\u3067\u306a\u305c\u304b\u9055\u53cd\u3092\u691c\u77e5\u3057\u3066\u3001\u4f8b\u5916\u304c\u767a\u751f\u3057\u3066\u3057\u307e\u3044\u307e\u3059\u3002\n\u3084\u3084\u8907\u96d1\u3067\u3059\u304c\u3084\u3063\u3066\u3044\u308b\u3053\u3068\u306f\u3001\n- RootSaving Context ( private queue) \n - Main Context ( main queue )\n - Private Context (private queue) \n\n\u3053\u306e\u3088\u3046\u306a\u30b3\u30f3\u30c6\u30ad\u30b9\u30c8\u306e\u89aa\u5b50\u95a2\u4fc2\u304c\u3042\u308a\u3001\u5404context\u4e0a\u3067EntityA\u3001EntityB\u3092insert\u3057\u305f\u308afetch\u3057\u305f\u308a\u3057\u3066\u3044\u308b\u3060\u3051\u3067\u3059\u3002\n\u3055\u3089\u306b\u8b0e\u306a\u306e\u304c\n    req.fetchBatchSize = 20;\u3000//(1)\n    req.predicate = [NSPredicate predicateWithFormat:@\"foo = %@\", @\"wwww\"]; //(2)\n\n\u3053\u306e\u3069\u3061\u3089\u304b\u306e\u884c\u3092\u30b3\u30e1\u30f3\u30c8\u30a2\u30a6\u30c8\u3059\u308c\u3070\u9055\u53cd\u306f\u767a\u751f\u3057\u306a\u304f\u306a\u308a\u307e\u3059\u3002\u3042\u304d\u3089\u304b\u306bcom.apple.CoreData.ConcurrencyDebug\u30aa\u30d7\u30b7\u30e7\u30f3\u306e\u30d0\u30b0\u3063\u307d\u3044\u3067\u3059\u3088\u306d\u3002\n\u3053\u306e\u4ef6\u306b\u3064\u3044\u3066\u306f\u73fe\u5728Apple\u306b\u554f\u3044\u5408\u308f\u305b\u4e2d\u3067\u3059\u3002\nhttps://openradar.appspot.com/radar?id=4944086339420160\n\u3061\u306a\u307f\u306b\u3001iOS8.4\u306e\u6642\u4ee3\u306b\u3082\u540c\u69d8\u306e\u5831\u544a\u304c\u3042\u3063\u305f\u3088\u3046\u3067\u3059\u3002\u3053\u306e\u4e0d\u5177\u5408\uff1f\u304c\u73fe\u5728\u3082\u307e\u3060\u7d9a\u3044\u3066\u3044\u308b\u306e\u3067\u3057\u3087\u3046\u304b\u30fb\u30fb\u3002\nhttp://stackoverflow.com/questions/29741359/coredata-multithreading-violation-debugging\n\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u30df\u30b9\u3092\u9632\u6b62\u3059\u308b\u305f\u3081\u306b\u3082\u6709\u7528\u306a\u30aa\u30d7\u30b7\u30e7\u30f3\u306a\u306e\u3067\u3001\u305c\u3072\u6b63\u3057\u304f\u52d5\u304f\u3088\u3046\u306b\u306a\u3063\u3066\u307b\u3057\u3044\u3082\u306e\u3067\u3059\u3002\n**\u518d\u73fe\u65b9\u6cd5\u304c\u308f\u304b\u3063\u305f\u306e\u3067\u8ffd\u8a18\u3057\u307e\u3057\u305f(2016/06/21)**\n\nCoreData\u306b\u304a\u3044\u3066\u3001\u4e26\u5217\u51e6\u7406\u9055\u53cd\u6642\u306b\u4f8b\u5916\u3092\u5410\u3044\u3066\u304f\u308c\u308b\u3001`-com.apple.CoreData.ConcurrencyDebug 1`\u3068\u3044\u3046\u30c7\u30d0\u30c3\u30b0\u30aa\u30d7\u30b7\u30e7\u30f3\u304c\u3042\u308a\u307e\u3059\u3002\nhttp://qiita.com/hongmhoon/items/606a352b1e96dfb0bec5#\u30c7\u30d0\u30c3\u30b0\u3053\u308c\u304c\u91cd\u8981\n\n\u305f\u3060\u3057\u3053\u306e\u30aa\u30d7\u30b7\u30e7\u30f3\u3001\u30b3\u30fc\u30c9\u4e0a\u306f\u554f\u984c\u306a\u3044\u306f\u305a\u306a\u306e\u306b\u8aa4\u3063\u3066\u4f8b\u5916\u3092\u5410\u3044\u3066\u3057\u307e\u3046\u30b1\u30fc\u30b9\u304c\u3042\u308a\u307e\u3059\u3002\n\n### \u518d\u73fe\u4f8b\n\n\u4f8b\u3048\u3070\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u30b3\u30fc\u30c9\u304c\u3042\u3063\u305f\u3068\u3057\u307e\u3059\u3002\n\n```objc\n[privateContext performBlock:^{\n    NSEntityDescription* entADesc = [NSEntityDescription entityForName:@\"EntityA\" inManagedObjectContext:privateContext];\n    EntityA* entA = [[EntityA alloc] initWithEntity:entADesc insertIntoManagedObjectContext:privateContext];\n    entA.foo = @\"aaa\";\n\n    [privateContext save:&error];\n\n    NSManagedObjectContext* parentContext = privateContext.parentContext;\n    [parentContext performBlock:^{\n        [parentContext save:&error];\n    }];\n}];\n\n//fetch EntityB (asyn on main context)    \n[mainContext performBlock:^{\n    NSFetchRequest* req = [NSFetchRequest fetchRequestWithEntityName:@\"EntityB\"];\n    NSArray* results = [mainContext executeFetchRequest:req error:&error];\n}];\n\n//fetch EntityA (asyn on main context)\n[mainContext performBlock:^{\n    NSFetchRequest* req = [NSFetchRequest fetchRequestWithEntityName:@\"EntityA\"];\n    req.fetchBatchSize = 20;\u3000//(1)\n    req.predicate = [NSPredicate predicateWithFormat:@\"foo = %@\", @\"wwww\"]; //(2)\n    NSArray* results = [mainContext executeFetchRequest:req error:&error];  //(3)\n}];\n```\n\n\u3053\u306e\u30b3\u30fc\u30c9\u3092`com.apple.CoreData.ConcurrencyDebug`\u30aa\u30d7\u30b7\u30e7\u30f3\u4ed8\u304d\u3067\u5b9f\u884c\u3059\u308b\u3068\u3001`//(3)` \u306e\u884c\u3067\u306a\u305c\u304b\u9055\u53cd\u3092\u691c\u77e5\u3057\u3066\u3001\u4f8b\u5916\u304c\u767a\u751f\u3057\u3066\u3057\u307e\u3044\u307e\u3059\u3002\n\n\u3084\u3084\u8907\u96d1\u3067\u3059\u304c\u3084\u3063\u3066\u3044\u308b\u3053\u3068\u306f\u3001\n\n```\n- RootSaving Context ( private queue) \n - Main Context ( main queue )\n - Private Context (private queue) \n```\n\u3053\u306e\u3088\u3046\u306a\u30b3\u30f3\u30c6\u30ad\u30b9\u30c8\u306e\u89aa\u5b50\u95a2\u4fc2\u304c\u3042\u308a\u3001\u5404context\u4e0a\u3067`EntityA`\u3001`EntityB`\u3092insert\u3057\u305f\u308afetch\u3057\u305f\u308a\u3057\u3066\u3044\u308b\u3060\u3051\u3067\u3059\u3002\n\n\u3055\u3089\u306b\u8b0e\u306a\u306e\u304c\n\n```objc\n    req.fetchBatchSize = 20;\u3000//(1)\n    req.predicate = [NSPredicate predicateWithFormat:@\"foo = %@\", @\"wwww\"]; //(2)\n```\n\u3053\u306e\u3069\u3061\u3089\u304b\u306e\u884c\u3092\u30b3\u30e1\u30f3\u30c8\u30a2\u30a6\u30c8\u3059\u308c\u3070\u9055\u53cd\u306f\u767a\u751f\u3057\u306a\u304f\u306a\u308a\u307e\u3059\u3002\u3042\u304d\u3089\u304b\u306b`com.apple.CoreData.ConcurrencyDebug`\u30aa\u30d7\u30b7\u30e7\u30f3\u306e\u30d0\u30b0\u3063\u307d\u3044\u3067\u3059\u3088\u306d\u3002\n\n\u3053\u306e\u4ef6\u306b\u3064\u3044\u3066\u306f\u73fe\u5728Apple\u306b\u554f\u3044\u5408\u308f\u305b\u4e2d\u3067\u3059\u3002\nhttps://openradar.appspot.com/radar?id=4944086339420160\n\n\u3061\u306a\u307f\u306b\u3001iOS8.4\u306e\u6642\u4ee3\u306b\u3082\u540c\u69d8\u306e\u5831\u544a\u304c\u3042\u3063\u305f\u3088\u3046\u3067\u3059\u3002\u3053\u306e\u4e0d\u5177\u5408\uff1f\u304c\u73fe\u5728\u3082\u307e\u3060\u7d9a\u3044\u3066\u3044\u308b\u306e\u3067\u3057\u3087\u3046\u304b\u30fb\u30fb\u3002\nhttp://stackoverflow.com/questions/29741359/coredata-multithreading-violation-debugging\n\n\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u30df\u30b9\u3092\u9632\u6b62\u3059\u308b\u305f\u3081\u306b\u3082\u6709\u7528\u306a\u30aa\u30d7\u30b7\u30e7\u30f3\u306a\u306e\u3067\u3001\u305c\u3072\u6b63\u3057\u304f\u52d5\u304f\u3088\u3046\u306b\u306a\u3063\u3066\u307b\u3057\u3044\u3082\u306e\u3067\u3059\u3002\n", "tags": ["CoreData", "iOS"]}