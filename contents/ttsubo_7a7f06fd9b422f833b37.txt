{"tags": ["openstack", "Heat", "NETCONF", "junos"], "context": "NetOpsCoding Advent Calendar 2016 12/3\u5206\u306e\u30a8\u30f3\u30c8\u30ea\u30fc\u3067\u3059\n\n\u25a0 \u4eca\u56de\u3001\u30c1\u30e3\u30ec\u30f3\u30b8\u3059\u308b\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u904b\u7528\u306e\u81ea\u52d5\u5316\u30cd\u30bf\nOpenStack\u306b\u306f\u3001\"Heat\"\u3068\u3044\u3046\u30aa\u30fc\u30b1\u30b9\u30c8\u30ec\u30fc\u30b7\u30e7\u30f3\u6a5f\u69cb\u304c\u5099\u308f\u3063\u3066\u3044\u307e\u3059\u3002\n\u4e00\u822c\u306b\u3001Heat\u306e\u6d3b\u7528\u30b7\u30fc\u30f3\u306f\u3001\u6240\u8b02\u3001\u30b3\u30f3\u30d4\u30e5\u30fc\u30c8\u30ea\u30bd\u30fc\u30b9\uff08\u30b5\u30fc\u30d0\u3001\u30b9\u30c8\u30ec\u30fc\u30b8\u3001\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\uff09\u306e\u5b9f\u74b0\u5883\u3078\u306e\u30c7\u30d7\u30ed\u30a4\u306b\u306a\u308a\u307e\u3059\u3002\n\u3061\u306a\u307f\u306b\u3001Heat\u3067\u5b9a\u7fa9\u3055\u308c\u308b\u30ea\u30bd\u30fc\u30b9\u30e2\u30c7\u30eb\u306f\u3001\u81ea\u7531\u306b\u30ab\u30b9\u30bf\u30de\u30a4\u30ba\u304c\u53ef\u80fd\u3067\u3059\u3002Python\u30b9\u30af\u30ea\u30d7\u30c8\u3067\u5236\u5fa1\u3067\u304d\u308b\u7d20\u6750\u3067\u3042\u308c\u3070\u3001Heat\u30aa\u30fc\u30b1\u30b9\u30c8\u30ec\u30fc\u30b7\u30e7\u30f3\u306e\u30ea\u30bd\u30fc\u30b9\u5019\u88dc\u306b\u306a\u308a\u307e\u3059\u3002\n\u305d\u3053\u3067\u3001Python\u30b9\u30af\u30ea\u30d7\u30c8\u3067\u5236\u5fa1\u3067\u304d\u308b\u7d20\u6750\u306e\u5fdc\u7528\u4f8b\u3068\u3057\u3066\u3001JUNOS\u30eb\u30fc\u30bf\u3092Netconf\u3067\u5236\u5fa1\u3059\u308b\"Heat Plugin\"\u3092\u62e1\u5f35\u3057\u3066\u307f\u307e\u3057\u305f\u3002\u3082\u3068\u30cd\u30bf\u306f\u3001\u3053\u3061\u3089\u306e\u30d6\u30ed\u30b0\u8a18\u4e8b\uff1a\"Python / JUNOS\u74b0\u5883\u3067\u3001NETCONF\u52d5\u4f5c\u3092\u8a66\u3057\u3066\u307f\u308b\"\u306b\u306a\u308a\u307e\u3059\u3002\n\n\"Heat Plugin\"\u62e1\u5f35\u306e\u3084\u308a\u65b9\u306f\u3001Heat Resource Plug-in Development Guide\u3092\u53c2\u8003\u306b\u3057\u3066\u304f\u3060\u3055\u3044\u3002\nNETCONF\u5bfe\u5fdc\u306e\"Heat Plugin\"\u306f\u3001github\u30ea\u30dd\u30b8\u30c8\u30ea\uff1a\"ttsubo/netconf_heat\" \u306b\u3066\u516c\u958b\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n\n\u25a0 NETCONF\u5bfe\u5fdc\u306e\"Heat Plugin\"\u3092\u8a66\u3059\u305f\u3081\u306e\u74b0\u5883\u6e96\u5099\n\u6b21\u306e\u3088\u3046\u306a\u5b9f\u9a13\u7528\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u3092\u69cb\u7bc9\u3059\u308b\u306b\u3042\u305f\u308a\u3001SRX\u6a5f\u5668\uff08\uff12\u53f0\uff09\u304c\u30bf\u30fc\u30b2\u30c3\u30c8\u306b\u306a\u308a\u307e\u3059\u3002\n\u3061\u306a\u307f\u306b\u3001 \"192.168.100.0/24\"\u306e\u30bb\u30b0\u30e1\u30f3\u30c8\u306e\u5148\u306b\u306f\u3001\u5bb6\u5ead\u7528\u30a4\u30f3\u30bf\u30cd\u30c3\u30c8\u74b0\u5883\u3068\u7e4b\u304c\u3063\u3066\u3044\u307e\u3059\u306e\u3067\u3001\u672b\u7aef\u306epc1\u5074\u304b\u3089\u3001\u30a4\u30f3\u30bf\u30cd\u30c3\u30c8\u306b\u629c\u3051\u3066\u3044\u304f\u3053\u3068\u304c\u30b4\u30fc\u30eb\u306b\u306a\u308a\u307e\u3059\u3002\n\n(1) \u5b9f\u9a13\u7528\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u5168\u4f53\u69cb\u6210\nOpenStack Heat\u30aa\u30fc\u30b1\u30b9\u30c8\u30ec\u30fc\u30b7\u30e7\u30f3\u3092\u4f7f\u3063\u3066\u3001JUNOS\u30eb\u30fc\u30c6\u30a3\u30f3\u30b0\u3092\u5236\u5fa1\u3092\u884c\u3046\u5bfe\u8c61\u88c5\u7f6e\u306f\u3001SRX\u6a5f\u5668\uff12\u53f0\u306b\u306a\u308a\u307e\u3059\u3002\u305d\u308c\u4ee5\u5916\u306e\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u6a5f\u5668\u306b\u306f\u3001\u4e8b\u524d\u306b\u5fc5\u8981\u306a\u8a2d\u5b9a\u304c\u884c\u308f\u308c\u3066\u3044\u308b\u524d\u63d0\u3067\u3059\u3002\n                                              < AS65000 >                 < AS65001 >                  < AS65001 >                  < 650002 >\n                   +\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014+                  +--------+                  +---------+                  +---------+                  +--------+                  +-----+\n              .201 |        | .1          .101 |        | .1   e-BGP    .2 |         | .1   i-BGP    .2 |         | .1   e-BGP   .2  |        | .1           .2  |     |\n Internet +-------+|Quagga-1| +--------------+ | SRX-1  | +--------------+ | GoBGP-1 | +--------------+ | GoBGP-3 | +--------------+ |Quagga-2|+----------------+| pc1 |\n  192.168.100.0/24 |        |  192.168.3.0/24  |        |  192.168.0.0/24  |         |   172.16.0.0/24  |         |  192.168.2.0/24  |        | 192.168.101.0/24 |     |\n                   +------\u2014-+         +        +--------+                  +---------+                  +---------+                  +--------+                  +-----+\n                                      |                                                                   .2 +\n                                      |                                                                      |\n                                     Vrrp                                                                    |\n                             (VIP: 192.168.3.100)                                                            |\n                                      |                                                                      |\n                                      |         +--------+                  +---------+                      |\n                                      |    .102 |        | .1   e-BGP    .2 |         | .1      i-BGP        |\n                                      +-------+ | SRX-2  | +--------------+ | GoBGP-2 | +--------------------+\n                                                |        |  192.168.1.0/24  |         |      172.16.1.0/24\n                                                +--------+                  +---------+\n                                                < AS65000 >                 < AS65001 >\n\n\n\n(2) \u30bf\u30fc\u30b2\u30c3\u30c8\u6a5f\u5668\nSRX\u6a5f\u5668\u306f\u3001SRX100H\uff08\u5b9f\u6a5f\uff09\u3067\u8a66\u3057\u3066\u3044\u307e\u3059\u3002\n\n\u305d\u3057\u3066\u3001\u6b21\u306e\u3088\u3046\u306a\u521d\u671f\u30b3\u30f3\u30d5\u30a3\u30b0\u72b6\u614b\u304b\u3089\u3001OoenStack Heat\u30aa\u30fc\u30b1\u30b9\u30c8\u30ec\u30fc\u30b7\u30e7\u30f3\u3092\u6d3b\u7528\u3057\u3066\u3001BGP\u52d5\u4f5c\u306b\u5fc5\u8981\u306a\u30b3\u30f3\u30d5\u30a3\u30b0\u8ffd\u52a0\u3092\u884c\u3046\u3053\u3068\u306b\u3057\u307e\u3057\u305f\u3002\u306a\u304a\u3001VRRP\u306e\u8a2d\u5b9a\u306f\u3001\u521d\u671f\u72b6\u614b\u3067\u8a2d\u5b9a\u5b8c\u4e86\u6e08\u307f\u3068\u3057\u307e\u3059\u3002\n\nSRX\u6a5f\u5668\uff11\u53f7\u6a5f\u306e\u521d\u671f\u30b3\u30f3\u30d5\u30a3\u30b0\u72b6\u614b\n\ntsubo@SRX-1> show configuration |display set |except \"set security\" |except \"set system\"\nset version 12.1X44-D35.5\nset interfaces fe-0/0/0 unit 0 family inet address 192.168.200.101/24\nset interfaces fe-0/0/1 unit 0 family inet address 192.168.0.1/24\nset interfaces fe-0/0/2 unit 0 family inet address 192.168.3.101/24 vrrp-group 10 virtual-address 192.168.3.100\nset interfaces fe-0/0/2 unit 0 family inet address 192.168.3.101/24 vrrp-group 10 priority 254\nset interfaces lo0 unit 0 family inet address 10.0.0.1/32\n\n\nSRX\u6a5f\u5668\uff12\u53f7\u6a5f\u306e\u521d\u671f\u30b3\u30f3\u30d5\u30a3\u30b0\u72b6\u614b\n\ntsubo@SRX-2> show configuration |display set |except \"set security\" |except \"set system\"\nset version 12.1X44-D30.4\nset interfaces fe-0/0/0 unit 0 family inet address 192.168.200.102/24\nset interfaces fe-0/0/1 unit 0 family inet address 192.168.1.1/24\nset interfaces fe-0/0/2 unit 0 family inet address 192.168.3.102/24 vrrp-group 10 virtual-address 192.168.3.100\nset interfaces fe-0/0/2 unit 0 family inet address 192.168.3.102/24 vrrp-group 10 priority 200\nset interfaces lo0 unit 0 family inet address 10.0.0.2/32\n\n\n(3) SRX\u6a5f\u5668\u3067\u306e\u74b0\u5883\u6574\u5099\n\n\u4eca\u56de\u3001OpenStack Heat\u3092\u4f7f\u7528\u3057\u3066\u3001SRX\u6a5f\u5668\u306e\u30b3\u30f3\u30d5\u30a3\u30b0\u8a2d\u5b9a\u3092\u884c\u3044\u307e\u3059\u3002\u5f93\u3063\u3066\u3001SRX\u6a5f\u5668\u5074\u3067\u306f\u3001NETCONF\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u74b0\u5883\u304b\u3089\u306e\u5236\u5fa1\u3092\u53d7\u4fe1\u3067\u304d\u308b\u3088\u3046\u306b\u6e96\u5099\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n\u5177\u4f53\u7684\u306b\u306f\u3001NETCONF\u30d7\u30ed\u30c8\u30b3\u30eb\uff08830\u30dd\u30fc\u30c8\uff09\u3092\u6709\u52b9\u306b\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n\ntsubo@SRX-1> configure \nEntering configuration mode\n\n[edit]\ntsubo@SRX-1# set system services netconf ssh port 830\n\n\n(4) OpenStack Heat\u306e\u74b0\u5883\u6574\u5099\n\n\u307e\u305a\u3001Qiita\u8a18\u4e8b\u300cMitaka\u7248 OpenStack Heat\u74b0\u5883\u3092\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\u3057\u3066\u307f\u305f\u300d\u306b\u5f93\u3063\u3066\u3001Heat\u74b0\u5883\u3092\u69cb\u7bc9\u3057\u307e\u3059\u3002\nNcclient\u30d1\u30c3\u30b1\u30fc\u30b8\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\n\n$ sudo apt-get install python-ncclient\n\n\nHeat\u74b0\u5883\u304c\u3001netconf\u30d7\u30ed\u30c8\u30b3\u30eb\u3092\u4ecb\u3057\u3066\u3001JUNOS\u30eb\u30fc\u30bf\u306b\u30b3\u30f3\u30d5\u30a3\u30b0\u8a2d\u5b9a\u304c\u884c\u3048\u308b\u3088\u3046\u306b\u3001Plugin\u62e1\u5f35\u3092\u884c\u3044\u307e\u3059\u3002\u3053\u3053\u3067\u306e\u4f8b\u3067\u306f\u3001\"/sample\"\u914d\u4e0b\u306bPlugin\u62e1\u5f35\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3059\u308b\u3082\u306e\u3068\u3057\u3066\u8aac\u660e\u3057\u3066\u304a\u308a\u307e\u3059\u3002\n\n$ mkdir /sample\n$ cd /sample\n$ git clone https://github.com/ttsubo/netconf_heat.git\n\n\nPlugin\u62e1\u5f35\u3092\u6709\u52b9\u306b\u3059\u308b\u305f\u3081\u3001Heat-engine\u3092\u505c\u6b62\u3057\u307e\u3059\u3002\n\n$ sudo service heat-engine stop\n\n\nHeat\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u306b\u3001Plugin\u62e1\u5f35\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u4f4d\u7f6e\u3092\u30a8\u30f3\u30c8\u30ea\u3057\u307e\u3059\u3002\n\n$ sudo vi /etc/heat/heat.conf\n\n\n/etc/heat/heat.conf\n[DEFAULT]\n...\n\ninfo = True\nplugin_dirs = /sample/netconf_heat/resources\n\n\n\n\n\u3057\u3070\u3089\u304f\u306f\u3001Heat-engine\u3092\u624b\u52d5\u8d77\u52d5\u3057\u3066\u3001Plugin\u62e1\u5f35\u304c\u671f\u5f85\u901a\u308a\u306b\u52d5\u4f5c\u3057\u3066\u3044\u308b\u304b\u78ba\u8a8d\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n\n$ sudo python /usr/bin/heat-engine --config-file /etc/heat/heat.conf\n...\n\n\n\u25a0 JUNOS\u30b3\u30f3\u30d5\u30a3\u30b0\u8a2d\u5b9a\u306e\u81ea\u52d5\u5316\u3092\u958b\u59cb\u3057\u3066\u307f\u308b ...\n\u3044\u3088\u3044\u3088\u3001Heat\u3092\u6d3b\u7528\u3057\u3066\u3001\u30b3\u30f3\u30d5\u30a3\u30b0\u8a2d\u5b9a\u3092\u884c\u3044\u307e\u3059\u3002\n\n(1) SRX\u6a5f\u5668\uff11\u53f7\u6a5f\u5411\u3051\u306e\u30b3\u30f3\u30d5\u30a3\u30b0\u8a2d\u5b9a\u3092\u958b\u59cb\u3059\u308b\n\nHeat\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u3092\u4f7f\u3063\u3066\u3001Heat\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u5b9a\u7fa9\u3057\u305f\u30d1\u30e9\u30e1\u30fc\u30bf\u3092\u6307\u5b9a\u3057\u305f\u4e0a\u3067\u3001Heat\u30b9\u30bf\u30c3\u30af\"SRX_1_stack\"\u4f5c\u6210\u3092\u958b\u59cb\u3057\u307e\u3059\u3002\uff08username=xxxx;password=xxxx\u306f\u3001\u9069\u6642\u3001\u7f6e\u304d\u63db\u3048\u3066\u304f\u3060\u3055\u3044\u3002\uff09\n\n$ openstack stack create --parameter \"router_ipaddr=192.168.200.101;username=xxxx;password=xxxx;router_port=830;policy_name=export-static;group_name=EXTERNAL;bgp_type=external;policy_statement=export-static;neighbor=192.168.0.2;peer_as=65001;static_route=0.0.0.0/0;next_hop=192.168.3.1;router_id=10.0.0.1;my_as=65000\" --template junos_netconf.yaml SRX_1_stack\n+---------------------+--------------------------------------+\n| Field               | Value                                |\n+---------------------+--------------------------------------+\n| id                  | 34db21af-a024-4953-80ca-cbd5b15f8d06 |\n| stack_name          | SRX_1_stack                          |\n| description         | Netconf for Junos                    |\n|                     |                                      |\n| creation_time       | 2016-11-26T06:18:51                  |\n| updated_time        | None                                 |\n| stack_status        | CREATE_IN_PROGRESS                   |\n| stack_status_reason | Stack CREATE started                 |\n+---------------------+--------------------------------------+\n\n\n\u8a2d\u5b9a\u304c\u5b8c\u4e86\u3059\u308b\u306b\u306f\u3001\u6570\u5206\u306e\u6642\u9593\u3092\u8981\u3059\u308b\u306e\u3067\u3001Heat\u30b9\u30bf\u30c3\u30af\u52d5\u4f5c\u72b6\u614b\u3092\u3001\u9069\u6642\u3001\u78ba\u8a8d\u3057\u307e\u3059\u3002\nHeat\u30b9\u30bf\u30c3\u30af\u306e\u30b9\u30c6\u30fc\u30bf\u30b9\u304c\u3001\"CREATE_COMPLETE\"\u3068\u306a\u308c\u3070\u3001\u5b8c\u4e86\u3067\u3059\u3002\n\n$ openstack stack list\n+--------------------------------------+-------------+--------------------+---------------------+--------------+\n| ID                                   | Stack Name  | Stack Status       | Creation Time       | Updated Time |\n+--------------------------------------+-------------+--------------------+---------------------+--------------+\n| 34db21af-a024-4953-80ca-cbd5b15f8d06 | SRX_1_stack | CREATE_IN_PROGRESS | 2016-11-26T06:18:51 | None         |\n+--------------------------------------+-------------+--------------------+---------------------+--------------+\n...\n\n$ openstack stack list\n+--------------------------------------+-------------+-----------------+---------------------+--------------+\n| ID                                   | Stack Name  | Stack Status    | Creation Time       | Updated Time |\n+--------------------------------------+-------------+-----------------+---------------------+--------------+\n| 34db21af-a024-4953-80ca-cbd5b15f8d06 | SRX_1_stack | CREATE_COMPLETE | 2016-11-26T06:18:51 | None         |\n+--------------------------------------+-------------+-----------------+---------------------+--------------+\n\n\nHeat\u30b9\u30bf\u30c3\u30af\u306e\u8a73\u7d30\u3092\u78ba\u8a8d\u3057\u3066\u307f\u307e\u3059\u3002\u3061\u306a\u307f\u306b\u3001show\u30b3\u30de\u30f3\u30c9\u3067\u8a73\u7d30\u3092\u78ba\u8a8d\u3059\u308b\u3068\u3001SRX\u6a5f\u5668\u306b\u5b9f\u969b\u3001\u30b3\u30f3\u30d5\u30a3\u30b0\u60c5\u5831\u306e\u53d6\u5f97\u3092\u884c\u3046\u305f\u3081\u3001\u30b3\u30de\u30f3\u30c9\u5b8c\u4e86\u306b\u3001\u3057\u3070\u3089\u304f\u6642\u9593\u3092\u8981\u3059\u308b\u3088\u3046\u3067\u3059\u3002\uff08output\u30d5\u30a3\u30fc\u30eb\u30c9\u3092\u78ba\u8a8d\u3057\u3066\u3082\u3089\u3048\u308c\u3070\u3001\u5b9f\u969b\u3001netconf\u7d4c\u7531\u3067\u3001\u30b3\u30f3\u30d5\u30a3\u30b0\u53d6\u5f97\u3057\u305f\u7d50\u679c\u304c\u4fdd\u6301\u3055\u308c\u3066\u3044\u308b\u69d8\u5b50\u3082\u78ba\u8a8d\u3067\u304d\u307e\u3059\u3002\uff09\n\n$ openstack stack show SRX_1_stack\n+-----------------------+---------------------------------------------------------------------------------------------------------------------------+\n| Field                 | Value                                                                                                                     |\n+-----------------------+---------------------------------------------------------------------------------------------------------------------------+\n| id                    | 34db21af-a024-4953-80ca-cbd5b15f8d06                                                                                      |\n| stack_name            | SRX_1_stack                                                                                                               |\n| description           | Netconf for Junos                                                                                                         |\n|                       |                                                                                                                           |\n| creation_time         | 2016-11-26T06:18:51                                                                                                       |\n| updated_time          | None                                                                                                                      |\n| stack_status          | CREATE_COMPLETE                                                                                                           |\n| stack_status_reason   | Stack CREATE completed successfully                                                                                       |\n| parameters            | OS::project_id: 6f1763f7643e4ee9bb2d2d9dd9bb0bc6                                                                          |\n|                       | OS::stack_id: 34db21af-a024-4953-80ca-cbd5b15f8d06                                                                        |\n|                       | OS::stack_name: SRX_1_stack                                                                                               |\n|                       | bgp_type: external                                                                                                        |\n|                       | group_name: EXTERNAL                                                                                                      |\n|                       | my_as: '65000'                                                                                                            |\n|                       | neighbor: 192.168.0.2                                                                                                     |\n|                       | next_hop: 192.168.3.1                                                                                                     |\n|                       | password: xxxx                                                                                                            |\n|                       | peer_as: '65001'                                                                                                          |\n|                       | policy_name: export-static                                                                                                |\n|                       | policy_statement: export-static                                                                                           |\n|                       | router_id: 10.0.0.1                                                                                                       |\n|                       | router_ipaddr: 192.168.200.101                                                                                            |\n|                       | router_port: '830'                                                                                                        |\n|                       | static_route: 0.0.0.0/0                                                                                                   |\n|                       | username: xxxx                                                                                                            |\n|                       |                                                                                                                           |\n| outputs               | - description: display config_routing_options                                                                             |\n|                       |   output_key: display_routing_options                                                                                     |\n|                       |   output_value:                                                                                                           |\n|                       |     config_routing_options: \"\\n## Last changed: 2016-11-26 15:19:04 JST\\nrouting-options\\                                 |\n|                       |       \\ {\\n    static {\\n        route 0.0.0.0/0 next-hop 192.168.3.1;\\n    }\\n  \\                                        |\n|                       |       \\  router-id 10.0.0.1;\\n    autonomous-system 65000;\\n}\\n\"                                                          |\n|                       | - description: display config_protocols                                                                                   |\n|                       |   output_key: display_protocols                                                                                           |\n|                       |   output_value:                                                                                                           |\n|                       |     config_protocols: \"\\n## Last changed: 2016-11-26 15:19:04 JST\\nprotocols {\\n \\                                        |\n|                       |       \\   bgp {\\n        group EXTERNAL {\\n            type external;\\n          \\                                        |\n|                       |       \\  export export-static;\\n            neighbor 192.168.0.2 {\\n             \\                                        |\n|                       |       \\   peer-as 65001;\\n            }\\n        }\\n    }\\n}\\n\"                                                           |\n|                       | - description: display config_policy_options                                                                              |\n|                       |   output_key: display_policy_options                                                                                      |\n|                       |   output_value:                                                                                                           |\n|                       |     config_routing_options: \"\\n## Last changed: 2016-11-26 15:19:04 JST\\npolicy-options\\                                  |\n|                       |       \\ {\\n    policy-statement export-static {\\n        term 1 {\\n            from\\                                      |\n|                       |       \\ protocol static;\\n            then accept;\\n        }\\n    }\\n}\\n\"                                                |\n|                       |                                                                                                                           |\n| links                 | - href: http://localhost:8004/v1/6f1763f7643e4ee9bb2d2d9dd9bb0bc6/stacks/SRX_1_stack/34db21af-a024-4953-80ca-cbd5b15f8d06 |\n|                       |   rel: self                                                                                                               |\n|                       |                                                                                                                           |\n| disable_rollback      | True                                                                                                                      |\n| parent                | None                                                                                                                      |\n| tags                  | null                                                                                                                      |\n|                       | ...                                                                                                                       |\n|                       |                                                                                                                           |\n| stack_user_project_id | 4d93e1ad2a1045179a492c8d072f5827                                                                                          |\n| capabilities          | []                                                                                                                        |\n| notification_topics   | []                                                                                                                        |\n| timeout_mins          | None                                                                                                                      |\n| stack_owner           | None                                                                                                                      |\n+-----------------------+---------------------------------------------------------------------------------------------------------------------------+\n\n\n\n\u3042\u3068\u3001\u4f59\u8ac7\u3067\u3059\u304c\u3001Heat\u30b9\u30bf\u30c3\u30af\u3092\u69cb\u6210\u3059\u308b\u5404\u7a2e\u30ea\u30bd\u30fc\u30b9\u60c5\u5831\u3082\u78ba\u8a8d\u3059\u308b\u3053\u3068\u304c\u53ef\u80fd\u3067\u3059\u3002\n\n$ openstack stack resource list SRX_1_stack\n+-----------------+--------------------------------------+-------------------------------------+-----------------+---------------------+\n| resource_name   | physical_resource_id                 | resource_type                       | resource_status | updated_time        |\n+-----------------+--------------------------------------+-------------------------------------+-----------------+---------------------+\n| policy-options  | cd9b1616-f728-4984-9cbb-97072219269f | OS::Netconf::PolicyOptionsResource  | CREATE_COMPLETE | 2016-11-26T06:18:51 |\n| routing-options | 871f05d7-bd3f-49e9-b21f-fa3e6d401365 | OS::Netconf::RoutingOptionsResource | CREATE_COMPLETE | 2016-11-26T06:18:51 |\n| protocols       | cb1ae2ad-329b-4225-a0ca-f8138c7b45a5 | OS::Netconf::ProtocolsResource      | CREATE_COMPLETE | 2016-11-26T06:18:51 |\n+-----------------+--------------------------------------+-------------------------------------+-----------------+---------------------+\n\n$ openstack stack resource show SRX_1_stack policy-options\n+------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\n| Field                  | Value                                                                                                                                                                                                                                                                                                                          |\n+------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\n| attributes             | {u'config_routing_options': u'\\n## Last changed: 2016-11-26 15:19:04 JST\\npolicy-options {\\n    policy-statement export-static {\\n        term 1 {\\n            from protocol static;\\n            then accept;\\n        }\\n    }\\n}\\n'}                                                                                       |\n| creation_time          | 2016-11-26T06:18:51                                                                                                                                                                                                                                                                                                            |\n| description            |                                                                                                                                                                                                                                                                                                                                |\n| links                  | [{u'href': u'http://localhost:8004/v1/6f1763f7643e4ee9bb2d2d9dd9bb0bc6/stacks/SRX_1_stack/34db21af-a024-4953-80ca-cbd5b15f8d06/resources/policy-options', u'rel': u'self'}, {u'href': u'http://localhost:8004/v1/6f1763f7643e4ee9bb2d2d9dd9bb0bc6/stacks/SRX_1_stack/34db21af-a024-4953-80ca-cbd5b15f8d06', u'rel': u'stack'}] |\n| logical_resource_id    | policy-options                                                                                                                                                                                                                                                                                                                 |\n| physical_resource_id   | cd9b1616-f728-4984-9cbb-97072219269f                                                                                                                                                                                                                                                                                           |\n| required_by            | [u'protocols']                                                                                                                                                                                                                                                                                                                 |\n| resource_name          | policy-options                                                                                                                                                                                                                                                                                                                 |\n| resource_status        | CREATE_COMPLETE                                                                                                                                                                                                                                                                                                                |\n| resource_status_reason | state changed                                                                                                                                                                                                                                                                                                                  |\n| resource_type          | OS::Netconf::PolicyOptionsResource                                                                                                                                                                                                                                                                                             |\n| updated_time           | 2016-11-26T06:18:51                                                                                                                                                                                                                                                                                                            |\n+------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\n\n$ openstack stack resource show SRX_1_stack routing-options\n+------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\n| Field                  | Value                                                                                                                                                                                                                                                                                                                           |\n+------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\n| attributes             | {u'config_routing_options': u'\\n## Last changed: 2016-11-26 15:19:04 JST\\nrouting-options {\\n    static {\\n        route 0.0.0.0/0 next-hop 192.168.3.1;\\n    }\\n    router-id 10.0.0.1;\\n    autonomous-system 65000;\\n}\\n'}                                                                                                   |\n| creation_time          | 2016-11-26T06:18:51                                                                                                                                                                                                                                                                                                             |\n| description            |                                                                                                                                                                                                                                                                                                                                 |\n| links                  | [{u'href': u'http://localhost:8004/v1/6f1763f7643e4ee9bb2d2d9dd9bb0bc6/stacks/SRX_1_stack/34db21af-a024-4953-80ca-cbd5b15f8d06/resources/routing-options', u'rel': u'self'}, {u'href': u'http://localhost:8004/v1/6f1763f7643e4ee9bb2d2d9dd9bb0bc6/stacks/SRX_1_stack/34db21af-a024-4953-80ca-cbd5b15f8d06', u'rel': u'stack'}] |\n| logical_resource_id    | routing-options                                                                                                                                                                                                                                                                                                                 |\n| physical_resource_id   | 871f05d7-bd3f-49e9-b21f-fa3e6d401365                                                                                                                                                                                                                                                                                            |\n| required_by            | [u'protocols']                                                                                                                                                                                                                                                                                                                  |\n| resource_name          | routing-options                                                                                                                                                                                                                                                                                                                 |\n| resource_status        | CREATE_COMPLETE                                                                                                                                                                                                                                                                                                                 |\n| resource_status_reason | state changed                                                                                                                                                                                                                                                                                                                   |\n| resource_type          | OS::Netconf::RoutingOptionsResource                                                                                                                                                                                                                                                                                             |\n| updated_time           | 2016-11-26T06:18:51                                                                                                                                                                                                                                                                                                             |\n+------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\n\n$ openstack stack resource show SRX_1_stack protocols\n+------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\n| Field                  | Value                                                                                                                                                                                                                                                                                                                     |\n+------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\n| attributes             | {u'config_protocols': u'\\n## Last changed: 2016-11-26 15:19:04 JST\\nprotocols {\\n    bgp {\\n        group EXTERNAL {\\n            type external;\\n            export export-static;\\n            neighbor 192.168.0.2 {\\n                peer-as 65001;\\n            }\\n        }\\n    }\\n}\\n'}                           |\n| creation_time          | 2016-11-26T06:18:51                                                                                                                                                                                                                                                                                                       |\n| description            |                                                                                                                                                                                                                                                                                                                           |\n| links                  | [{u'href': u'http://localhost:8004/v1/6f1763f7643e4ee9bb2d2d9dd9bb0bc6/stacks/SRX_1_stack/34db21af-a024-4953-80ca-cbd5b15f8d06/resources/protocols', u'rel': u'self'}, {u'href': u'http://localhost:8004/v1/6f1763f7643e4ee9bb2d2d9dd9bb0bc6/stacks/SRX_1_stack/34db21af-a024-4953-80ca-cbd5b15f8d06', u'rel': u'stack'}] |\n| logical_resource_id    | protocols                                                                                                                                                                                                                                                                                                                 |\n| physical_resource_id   | cb1ae2ad-329b-4225-a0ca-f8138c7b45a5                                                                                                                                                                                                                                                                                      |\n| required_by            | []                                                                                                                                                                                                                                                                                                                        |\n| resource_name          | protocols                                                                                                                                                                                                                                                                                                                 |\n| resource_status        | CREATE_COMPLETE                                                                                                                                                                                                                                                                                                           |\n| resource_status_reason | state changed                                                                                                                                                                                                                                                                                                             |\n| resource_type          | OS::Netconf::ProtocolsResource                                                                                                                                                                                                                                                                                            |\n| updated_time           | 2016-11-26T06:18:51                                                                                                                                                                                                                                                                                                       |\n+------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\n\n\n(2) SRX\u6a5f\u5668\uff12\u53f7\u6a5f\u5411\u3051\u306e\u30b3\u30f3\u30d5\u30a3\u30b0\u8a2d\u5b9a\u3092\u958b\u59cb\u3059\u308b\n\nSRX\u6a5f\u5668\uff12\u53f7\u6a5f\u5411\u3051\u306b\u3001Heat\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u5b9a\u7fa9\u3057\u305f\u30d1\u30e9\u30e1\u30fc\u30bf\u3092\u6307\u5b9a\u3057\u305f\u4e0a\u3067\u3001Heat\u30b9\u30bf\u30c3\u30af\"SRX_2_stack\"\u4f5c\u6210\u3092\u958b\u59cb\u3057\u307e\u3059\u3002\n\n$ openstack stack create --parameter \"router_ipaddr=192.168.200.102;username=xxxx;password=xxxx;router_port=830;policy_name=export-static;group_name=EXTERNAL;bgp_type=external;policy_statement=export-static;neighbor=192.168.1.2;peer_as=65001;static_route=0.0.0.0/0;next_hop=192.168.3.1;router_id=10.0.0.2;my_as=65000\" --template junos_netconf.yaml SRX_2_stack\n+---------------------+--------------------------------------+\n| Field               | Value                                |\n+---------------------+--------------------------------------+\n| id                  | 1435cb65-0923-492f-b485-e5e1a3a266e3 |\n| stack_name          | SRX_2_stack                          |\n| description         | Netconf for Junos                    |\n|                     |                                      |\n| creation_time       | 2016-11-26T06:29:29                  |\n| updated_time        | None                                 |\n| stack_status        | CREATE_IN_PROGRESS                   |\n| stack_status_reason | Stack CREATE started                 |\n+---------------------+--------------------------------------+\n\n\n\u9069\u6642\u3001Heat\u30b9\u30bf\u30c3\u30af\u4f5c\u6210\u306e\u69d8\u5b50\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\n\n$ openstack stack list\n+--------------------------------------+-------------+--------------------+---------------------+--------------+\n| ID                                   | Stack Name  | Stack Status       | Creation Time       | Updated Time |\n+--------------------------------------+-------------+--------------------+---------------------+--------------+\n| 1435cb65-0923-492f-b485-e5e1a3a266e3 | SRX_2_stack | CREATE_IN_PROGRESS | 2016-11-26T06:29:29 | None         |\n| 34db21af-a024-4953-80ca-cbd5b15f8d06 | SRX_1_stack | CREATE_COMPLETE    | 2016-11-26T06:18:51 | None         |\n+--------------------------------------+-------------+--------------------+---------------------+--------------+\n...\n\n$ openstack stack list\n+--------------------------------------+-------------+-----------------+---------------------+--------------+\n| ID                                   | Stack Name  | Stack Status    | Creation Time       | Updated Time |\n+--------------------------------------+-------------+-----------------+---------------------+--------------+\n| 1435cb65-0923-492f-b485-e5e1a3a266e3 | SRX_2_stack | CREATE_COMPLETE | 2016-11-26T06:29:29 | None         |\n| 34db21af-a024-4953-80ca-cbd5b15f8d06 | SRX_1_stack | CREATE_COMPLETE | 2016-11-26T06:18:51 | None         |\n+--------------------------------------+-------------+-----------------+---------------------+--------------+\n\n\n\u25a0 \u5b9f\u9a13\u7528\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u74b0\u5883\u304c\u6574\u3063\u305f\u306e\u3067\u3001\u3057\u3070\u3089\u304f\u3001\u904a\u3093\u3067\u307f\u308b\u3002\n\u3082\u3046\u4e00\u5ea6\u3001\u5b9f\u9a13\u7528\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u5168\u4f53\u69cb\u6210\u56f3\u3092\u518d\u63b2\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n                                              < AS65000 >                 < AS65001 >                  < AS65001 >                  < 650002 >\n                   +\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014+                  +--------+                  +---------+                  +---------+                  +--------+                  +-----+\n              .201 |        | .1          .101 |        | .1   e-BGP    .2 |         | .1   i-BGP    .2 |         | .1   e-BGP   .2  |        | .1           .2  |     |\n Internet +-------+|Quagga-1| +--------------+ | SRX-1  | +--------------+ | GoBGP-1 | +--------------+ | GoBGP-3 | +--------------+ |Quagga-2|+----------------+| pc1 |\n  192.168.100.0/24 |        |  192.168.3.0/24  |        |  192.168.0.0/24  |         |   172.16.0.0/24  |         |  192.168.2.0/24  |        | 192.168.101.0/24 |     |\n                   +------\u2014-+         +        +--------+                  +---------+                  +---------+                  +--------+                  +-----+\n                                      |                                                                   .2 +\n                                      |                                                                      |\n                                     Vrrp                                                                    |\n                             (VIP: 192.168.3.100)                                                            |\n                                      |                                                                      |\n                                      |         +--------+                  +---------+                      |\n                                      |    .102 |        | .1   e-BGP    .2 |         | .1      i-BGP        |\n                                      +-------+ | SRX-2  | +--------------+ | GoBGP-2 | +--------------------+\n                                                |        |  192.168.1.0/24  |         |      172.16.1.0/24\n                                                +--------+                  +---------+\n                                                < AS65000 >                 < AS65001 >\n\n\n\n(1) \u307e\u305a\u306f\u3001\u30b3\u30f3\u30d5\u30a3\u30b0\u60c5\u5831\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\n\nSRX\u6a5f\u5668\uff11\u53f7\u6a5f\u304b\u3089 ...\n\ntsubo@SRX-1> show configuration |display set |except \"set security\" |except \"set system\"\nset version 12.1X44-D35.5\nset interfaces fe-0/0/0 unit 0 family inet address 192.168.200.101/24\nset interfaces fe-0/0/1 unit 0 family inet address 192.168.0.1/24\nset interfaces fe-0/0/2 unit 0 family inet address 192.168.3.101/24 vrrp-group 10 virtual-address 192.168.3.100\nset interfaces fe-0/0/2 unit 0 family inet address 192.168.3.101/24 vrrp-group 10 priority 254\nset interfaces lo0 unit 0 family inet address 10.0.0.1/32\nset routing-options static route 0.0.0.0/0 next-hop 192.168.3.1\nset routing-options router-id 10.0.0.1\nset routing-options autonomous-system 65000\nset protocols bgp group EXTERNAL type external\nset protocols bgp group EXTERNAL export export-static\nset protocols bgp group EXTERNAL neighbor 192.168.0.2 peer-as 65001\nset policy-options policy-statement export-static term 1 from protocol static\nset policy-options policy-statement export-static term 1 then accept\n\n\n\u3064\u3065\u3044\u3066\u3001SRX\u6a5f\u5668\uff12\u53f7\u6a5f ...\n\ntsubo@SRX-2> show configuration |display set |except \"set security\" |except \"set system\"\nset version 12.1X44-D30.4\nset interfaces fe-0/0/0 unit 0 family inet address 192.168.200.102/24\nset interfaces fe-0/0/1 unit 0 family inet address 192.168.1.1/24\nset interfaces fe-0/0/2 unit 0 family inet address 192.168.3.102/24 vrrp-group 10 virtual-address 192.168.3.100\nset interfaces fe-0/0/2 unit 0 family inet address 192.168.3.102/24 vrrp-group 10 priority 200\nset interfaces lo0 unit 0 family inet address 10.0.0.2/32\nset routing-options static route 0.0.0.0/0 next-hop 192.168.3.1\nset routing-options router-id 10.0.0.2\nset routing-options autonomous-system 65000\nset protocols bgp group EXTERNAL type external\nset protocols bgp group EXTERNAL export export-static\nset protocols bgp group EXTERNAL neighbor 192.168.1.2 peer-as 65001\nset policy-options policy-statement export-static term 1 from protocol static\nset policy-options policy-statement export-static term 1 then accept\n\n\nGoBGP\uff13\u53f7\u6a5f\u3067\u306eBGP\u30c6\u30fc\u30d6\u30eb\u3092\u78ba\u8a8d\u3057\u3066\u307f\u308b\u3002\n\npi@gobgp3:~ $ gobgp global rib\n    Network             Next Hop             AS_PATH              Age        Attrs\n*>  0.0.0.0/0           172.16.0.1           65000                00:28:23   [{Origin: i} {LocalPref: 100}]\n*   0.0.0.0/0           172.16.1.1           65000                00:17:36   [{Origin: i} {LocalPref: 100}]\n*>  192.168.101.0/24    192.168.2.2          65002                00:59:49   [{Origin: i} {Med: 0}]\n\n\u306f\u3044\u3001SRX\u6a5f\u5668\u3067\u914d\u4fe1\u3055\u308c\u305f\u30c7\u30d5\u30a9\u30eb\u30c8\u30eb\u30fc\u30c8\u304c\u3001GoBGP\uff13\u53f7\u6a5f\u3067\u6b63\u3057\u304f\u5b66\u7fd2\u3067\u304d\u3066\u3044\u308b\u3088\u3046\u3067\u3059\u3002\n\n(2) \u30a8\u30f3\u30c9\u30a8\u30f3\u30c9\u3067\u3001\u901a\u4fe1\u3057\u3066\u307f\u308b\n\n\u307e\u305a\u306f\u3001pc1\u5074\u304b\u3089\u3001\u5b9a\u756a\u306eping\u78ba\u8a8d\u3057\u3066\u307f\u308b\u3068 ...\n\n$ ping 192.168.100.1\nPING 192.168.100.1 (192.168.100.1): 56 data bytes\n64 bytes from 192.168.100.1: icmp_seq=0 ttl=250 time=1.964 ms\n64 bytes from 192.168.100.1: icmp_seq=1 ttl=250 time=1.982 ms\n64 bytes from 192.168.100.1: icmp_seq=2 ttl=250 time=1.889 ms\n64 bytes from 192.168.100.1: icmp_seq=3 ttl=250 time=1.958 ms\n^C\n--- 192.168.100.1 ping statistics ---\n4 packets transmitted, 4 packets received, 0.0% packet loss\nround-trip min/avg/max/stddev = 1.889/1.948/1.982/0.035 ms\n\n\n\u3055\u3089\u306b\u3001pc1\u5074\u304b\u3089\u3001YouTube\u3092\u95b2\u89a7\u3057\u3066\u307f\u307e\u3057\u305f ...\n\n\n\u304a\u3063!!\u3000\u61d0\u304b\u3057\u306e\u3001\u30ca\u30a4\u30c8\u30ec\u30f3\u30b8\u30e3\u30fc\u3060\uff01\n\n(3) \u3064\u3044\u3067\u3001BGP\u7d4c\u8def\u5197\u9577\u306e\u52d5\u4f5c\u3082\u78ba\u8a8d\u3057\u3066\u307f\u308b\u3002\n\nSRX\u6a5f\u5668\uff11\u53f7\u6a5f\u5074\u3067\u3001\u7269\u7406IF\u3092\u65ad\u7dda\u3055\u305b\u308b\u3068\u3001ICMP ECHO Reply\u30d1\u30b1\u30c3\u30c8\uff14\u767a\u7a0b\u5ea6\u306e\u53d6\u308a\u3053\u307c\u3057\u304c\u767a\u751f\u3057\u307e\u3057\u305f\u304c\u3001\u305d\u306e\u5f8c\u3001\u5fa9\u65e7\u3057\u3066\u3044\u307e\u3059\u3002\n\n$ ping 192.168.100.1\nPING 192.168.100.1 (192.168.100.1): 56 data bytes\n64 bytes from 192.168.100.1: icmp_seq=0 ttl=250 time=1.860 ms\n64 bytes from 192.168.100.1: icmp_seq=1 ttl=250 time=1.922 ms\n64 bytes from 192.168.100.1: icmp_seq=2 ttl=250 time=1.963 ms\n64 bytes from 192.168.100.1: icmp_seq=3 ttl=250 time=1.973 ms\n64 bytes from 192.168.100.1: icmp_seq=4 ttl=250 time=2.260 ms\nRequest timeout for icmp_seq 5\nRequest timeout for icmp_seq 6\nRequest timeout for icmp_seq 7\nRequest timeout for icmp_seq 8\n64 bytes from 192.168.100.1: icmp_seq=9 ttl=250 time=1.945 ms\n64 bytes from 192.168.100.1: icmp_seq=10 ttl=250 time=2.064 ms\n64 bytes from 192.168.100.1: icmp_seq=11 ttl=250 time=2.156 ms\n64 bytes from 192.168.100.1: icmp_seq=12 ttl=250 time=1.992 ms\n^C\n\n\n\u3053\u306e\u6642\u3001GoBGP\uff13\u53f7\u6a5f\u3067\u306eBGP\u30c6\u30fc\u30d6\u30eb\u3092\u78ba\u8a8d\u3057\u3066\u307f\u308b\u3068\u3001\u7d4c\u8def\u304c\u5207\u308a\u66ff\u308f\u3063\u305f\u3053\u3068\u304c\u78ba\u8a8d\u3067\u304d\u307e\u3057\u305f\u3002\n\npi@gobgp3:~ $ gobgp global rib\n    Network             Next Hop             AS_PATH              Age        Attrs\n*>  0.0.0.0/0           172.16.1.1           65000                00:05:31   [{Origin: i} {LocalPref: 100}]\n*>  192.168.101.0/24    192.168.2.2          65002                00:05:40   [{Origin: i} {Med: 0}]\n\n\n\u25a0 \u5f8c\u4f5c\u696d\u3068\u3057\u3066\u3001SRX\u6a5f\u5668\u306e\u30b3\u30f3\u30d5\u30a3\u30b0\u74b0\u5883\u3092\u5143\u306b\u623b\u3057\u3066\u304a\u304f ...\n\u697d\u3057\u3044\u3001\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u5b9f\u9a13\u304c\u7d42\u308f\u3063\u305f\u306e\u3067\u3001\u6700\u5f8c\u306b\u5f8c\u7247\u4ed8\u3051\u3067\u3059\u3002\nOpenStack Heat\u30aa\u30fc\u30b1\u30b9\u30c8\u30ec\u30fc\u30b7\u30e7\u30f3\u3092\u6d3b\u7528\u3057\u3066\u3044\u308b\u306e\u3067\u3001\u3053\u3053\u3067\u306f\u3001Heat\u30b9\u30bf\u30c3\u30af\u3092\u524a\u9664\u3059\u308b\u3060\u3051\u3067\u3059\uff01\uff01\n\n(1) Heat\u30b9\u30bf\u30c3\u30af\u3092\u524a\u9664\u3057\u307e\u3059\u3002\n\n\u307e\u305a\u306f\u3001SRX\u6a5f\u5668\uff11\u53f7\u6a5f\u304b\u3089 ...\n\n$ openstack stack delete SRX_1_stack\nAre you sure you want to delete this stack(s) [y/N]? y\n\n\n\u524a\u9664\u8a2d\u5b9a\u304c\u5b8c\u4e86\u3059\u308b\u306b\u306f\u3001\u6570\u5206\u306e\u6642\u9593\u3092\u8981\u3059\u308b\u306e\u3067\u3001Heat\u30b9\u30bf\u30c3\u30af\u52d5\u4f5c\u72b6\u614b\u3092\u3001\u9069\u6642\u3001\u78ba\u8a8d\u3057\u307e\u3059\u3002Heat\u30b9\u30bf\u30c3\u30af\u306e\u30ec\u30b3\u30fc\u30c9\u304c\u524a\u9664\u3055\u308c\u3066\u3044\u308c\u3070\u3001\u5b8c\u4e86\u3067\u3059\u3002\n\nopenstack stack list\n+--------------------------------------+-------------+--------------------+---------------------+--------------+\n| ID                                   | Stack Name  | Stack Status       | Creation Time       | Updated Time |\n+--------------------------------------+-------------+--------------------+---------------------+--------------+\n| 1435cb65-0923-492f-b485-e5e1a3a266e3 | SRX_2_stack | CREATE_COMPLETE    | 2016-11-26T06:29:29 | None         |\n| 34db21af-a024-4953-80ca-cbd5b15f8d06 | SRX_1_stack | DELETE_IN_PROGRESS | 2016-11-26T06:18:51 | None         |\n+--------------------------------------+-------------+--------------------+---------------------+--------------+\n...\n\n$ openstack stack list\n+--------------------------------------+-------------+-----------------+---------------------+--------------+\n| ID                                   | Stack Name  | Stack Status    | Creation Time       | Updated Time |\n+--------------------------------------+-------------+-----------------+---------------------+--------------+\n| 1435cb65-0923-492f-b485-e5e1a3a266e3 | SRX_2_stack | CREATE_COMPLETE | 2016-11-26T06:29:29 | None         |\n+--------------------------------------+-------------+-----------------+---------------------+--------------+\n\n\n\u3064\u3065\u3044\u3066\u3001SRX\u6a5f\u5668\uff12\u53f7\u6a5f ...\n\n$ openstack stack delete SRX_2_stack\nAre you sure you want to delete this stack(s) [y/N]? y\n\n\n\u306f\u3044\u3001Heat\u30b9\u30bf\u30c3\u30af\u306f\u3001\u3059\u3079\u3066\u524a\u9664\u3055\u308c\u307e\u3057\u305f\u3002\n\n$ openstack stack list\n\n\n\n(2) \u3044\u3061\u304a\u3046\u3001\u30b3\u30f3\u30d5\u30a3\u30b0\u60c5\u5831\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\n\n\u307e\u305a\u306f\u3001SRX\u6a5f\u5668\uff11\u53f7\u6a5f\u304b\u3089 ...\n\ntsubo@SRX-1> show configuration |display set |except \"set security\" |except \"set system\"\nset version 12.1X44-D35.5\nset interfaces fe-0/0/0 unit 0 family inet address 192.168.200.101/24\nset interfaces fe-0/0/1 unit 0 family inet address 192.168.0.1/24\nset interfaces fe-0/0/2 unit 0 family inet address 192.168.3.101/24 vrrp-group 10 virtual-address 192.168.3.100\nset interfaces fe-0/0/2 unit 0 family inet address 192.168.3.101/24 vrrp-group 10 priority 254\nset interfaces lo0 unit 0 family inet address 10.0.0.1/32\n\n\n\u3064\u3065\u3044\u3066\u3001SRX\u6a5f\u5668\uff12\u53f7\u6a5f ...\n\ntsubo@SRX-2> show configuration |display set |except \"set security\" |except \"set system\"\nset version 12.1X44-D30.4\nset interfaces fe-0/0/0 unit 0 family inet address 192.168.200.102/24\nset interfaces fe-0/0/1 unit 0 family inet address 192.168.1.1/24\nset interfaces fe-0/0/2 unit 0 family inet address 192.168.3.102/24 vrrp-group 10 virtual-address 192.168.3.100\nset interfaces fe-0/0/2 unit 0 family inet address 192.168.3.102/24 vrrp-group 10 priority 200\nset interfaces lo0 unit 0 family inet address 10.0.0.2/32\n\n\u671f\u5f85\u901a\u308a\u306b\u3001\u6700\u521d\u306e\u30b3\u30f3\u30d5\u30a3\u30b0\u72b6\u614b\u306b\u623b\u308a\u307e\u3057\u305f\u306d\uff01\n\n\u25a0 \u6700\u5f8c\u306b ...\nOpenStack Heat\u3092\u6d3b\u7528\u3059\u308c\u3070\u3001\u5f93\u6765\u306e\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u6a5f\u5668\u3055\u3048\u3082\u3001\u30aa\u30fc\u30b1\u30b9\u30c8\u30ec\u30fc\u30b7\u30e7\u30f3\u5bfe\u5fdc\u306e\u30b3\u30f3\u30d5\u30a3\u30b0\u8a2d\u5b9a\u306e\u81ea\u52d5\u5316\u304c\u5b9f\u73fe\u3067\u304d\u3066\u3057\u307e\u3046\u6642\u4ee3\u306b\u306a\u308a\u307e\u3057\u305f\u3002\n\u305f\u3060\u3057\u3001\u96e3\u70b9\u306a\u306e\u304c\u3001\u5404\u81ea\u306e\u74b0\u5883\u306b\u5373\u3057\u305fHeat\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u3092\u8a18\u8ff0\u3059\u308b\u30b9\u30ad\u30eb\u306e\u7fd2\u5f97\u304c\u5fc5\u8981\u4e0d\u53ef\u6b20\u3067\u3059\u3002\n\u65e5\u672cOpenStack\u30e6\u30fc\u30b6\u4f1a \u7b2c28\u56de\u52c9\u5f37\u4f1a\u3067\u306f\u3001\u201dHeat \u306b\u3088\u308b\u30aa\u30fc\u30b1\u30b9\u30c8\u30ec\u30fc\u30b7\u30e7\u30f3\u5165\u9580\u201d\u3092\u30c6\u30fc\u30de\u3068\u3057\u3066\u53d6\u308a\u4e0a\u3052\u3089\u308c\u3066\u304a\u308a\u307e\u3057\u305f\u306e\u3067\u3001\u5b66\u7fd2\u7d20\u6750\u3068\u3057\u3066\u5927\u5909\u6709\u76ca\u3060\u3068\u601d\u3044\u307e\u3057\u305f\u3002\n\n\u25a0 \u305d\u306e\u4ed6\u3001\u53c2\u8003\u306b\u3057\u305fURL\u60c5\u5831\n\nncclient: Python library for NETCONF clients Docs\nMapping Configuration Statements to Junos XML Tag Elements\nDeleting Configuration Elements Using NETCONF\nError during commit: \"error: configuration database locked by\"\n\n[NetOpsCoding Advent Calendar 2016](http://qiita.com/advent-calendar/2016/netopscoding) 12/3\u5206\u306e\u30a8\u30f3\u30c8\u30ea\u30fc\u3067\u3059\n\n# \u25a0 \u4eca\u56de\u3001\u30c1\u30e3\u30ec\u30f3\u30b8\u3059\u308b\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u904b\u7528\u306e\u81ea\u52d5\u5316\u30cd\u30bf\nOpenStack\u306b\u306f\u3001\"Heat\"\u3068\u3044\u3046\u30aa\u30fc\u30b1\u30b9\u30c8\u30ec\u30fc\u30b7\u30e7\u30f3\u6a5f\u69cb\u304c\u5099\u308f\u3063\u3066\u3044\u307e\u3059\u3002\n\u4e00\u822c\u306b\u3001Heat\u306e\u6d3b\u7528\u30b7\u30fc\u30f3\u306f\u3001\u6240\u8b02\u3001\u30b3\u30f3\u30d4\u30e5\u30fc\u30c8\u30ea\u30bd\u30fc\u30b9\uff08\u30b5\u30fc\u30d0\u3001\u30b9\u30c8\u30ec\u30fc\u30b8\u3001\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\uff09\u306e\u5b9f\u74b0\u5883\u3078\u306e\u30c7\u30d7\u30ed\u30a4\u306b\u306a\u308a\u307e\u3059\u3002\n\n\u3061\u306a\u307f\u306b\u3001Heat\u3067\u5b9a\u7fa9\u3055\u308c\u308b\u30ea\u30bd\u30fc\u30b9\u30e2\u30c7\u30eb\u306f\u3001\u81ea\u7531\u306b\u30ab\u30b9\u30bf\u30de\u30a4\u30ba\u304c\u53ef\u80fd\u3067\u3059\u3002Python\u30b9\u30af\u30ea\u30d7\u30c8\u3067\u5236\u5fa1\u3067\u304d\u308b\u7d20\u6750\u3067\u3042\u308c\u3070\u3001Heat\u30aa\u30fc\u30b1\u30b9\u30c8\u30ec\u30fc\u30b7\u30e7\u30f3\u306e\u30ea\u30bd\u30fc\u30b9\u5019\u88dc\u306b\u306a\u308a\u307e\u3059\u3002\n\n\u305d\u3053\u3067\u3001Python\u30b9\u30af\u30ea\u30d7\u30c8\u3067\u5236\u5fa1\u3067\u304d\u308b\u7d20\u6750\u306e\u5fdc\u7528\u4f8b\u3068\u3057\u3066\u3001JUNOS\u30eb\u30fc\u30bf\u3092Netconf\u3067\u5236\u5fa1\u3059\u308b\"Heat Plugin\"\u3092\u62e1\u5f35\u3057\u3066\u307f\u307e\u3057\u305f\u3002\u3082\u3068\u30cd\u30bf\u306f\u3001\u3053\u3061\u3089\u306e\u30d6\u30ed\u30b0\u8a18\u4e8b\uff1a[\"Python / JUNOS\u74b0\u5883\u3067\u3001NETCONF\u52d5\u4f5c\u3092\u8a66\u3057\u3066\u307f\u308b\"](http://ttsubo.hatenablog.com/entry/2016/04/16/224133)\u306b\u306a\u308a\u307e\u3059\u3002\n\n![Heat Architecture.001.jpeg](https://qiita-image-store.s3.amazonaws.com/0/103595/c691813f-0179-dbe2-5dae-91ccbfc411d2.jpeg)\n\n\"Heat Plugin\"\u62e1\u5f35\u306e\u3084\u308a\u65b9\u306f\u3001[Heat Resource Plug-in Development Guide](http://docs.openstack.org/developer/heat/pluginguide.html)\u3092\u53c2\u8003\u306b\u3057\u3066\u304f\u3060\u3055\u3044\u3002\nNETCONF\u5bfe\u5fdc\u306e\"Heat Plugin\"\u306f\u3001github\u30ea\u30dd\u30b8\u30c8\u30ea\uff1a[\"ttsubo/netconf_heat\"](https://github.com/ttsubo/netconf_heat) \u306b\u3066\u516c\u958b\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n\n# \u25a0 NETCONF\u5bfe\u5fdc\u306e\"Heat Plugin\"\u3092\u8a66\u3059\u305f\u3081\u306e\u74b0\u5883\u6e96\u5099\n\u6b21\u306e\u3088\u3046\u306a\u5b9f\u9a13\u7528\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u3092\u69cb\u7bc9\u3059\u308b\u306b\u3042\u305f\u308a\u3001SRX\u6a5f\u5668\uff08\uff12\u53f0\uff09\u304c\u30bf\u30fc\u30b2\u30c3\u30c8\u306b\u306a\u308a\u307e\u3059\u3002\n\u3061\u306a\u307f\u306b\u3001 \"192.168.100.0/24\"\u306e\u30bb\u30b0\u30e1\u30f3\u30c8\u306e\u5148\u306b\u306f\u3001\u5bb6\u5ead\u7528\u30a4\u30f3\u30bf\u30cd\u30c3\u30c8\u74b0\u5883\u3068\u7e4b\u304c\u3063\u3066\u3044\u307e\u3059\u306e\u3067\u3001\u672b\u7aef\u306epc1\u5074\u304b\u3089\u3001\u30a4\u30f3\u30bf\u30cd\u30c3\u30c8\u306b\u629c\u3051\u3066\u3044\u304f\u3053\u3068\u304c\u30b4\u30fc\u30eb\u306b\u306a\u308a\u307e\u3059\u3002\n\n### (1) \u5b9f\u9a13\u7528\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u5168\u4f53\u69cb\u6210\nOpenStack Heat\u30aa\u30fc\u30b1\u30b9\u30c8\u30ec\u30fc\u30b7\u30e7\u30f3\u3092\u4f7f\u3063\u3066\u3001JUNOS\u30eb\u30fc\u30c6\u30a3\u30f3\u30b0\u3092\u5236\u5fa1\u3092\u884c\u3046\u5bfe\u8c61\u88c5\u7f6e\u306f\u3001SRX\u6a5f\u5668\uff12\u53f0\u306b\u306a\u308a\u307e\u3059\u3002\u305d\u308c\u4ee5\u5916\u306e\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u6a5f\u5668\u306b\u306f\u3001\u4e8b\u524d\u306b\u5fc5\u8981\u306a\u8a2d\u5b9a\u304c\u884c\u308f\u308c\u3066\u3044\u308b\u524d\u63d0\u3067\u3059\u3002\n\n```\n                                              < AS65000 >                 < AS65001 >                  < AS65001 >                  < 650002 >\n                   +\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014+                  +--------+                  +---------+                  +---------+                  +--------+                  +-----+\n              .201 |        | .1          .101 |        | .1   e-BGP    .2 |         | .1   i-BGP    .2 |         | .1   e-BGP   .2  |        | .1           .2  |     |\n Internet +-------+|Quagga-1| +--------------+ | SRX-1  | +--------------+ | GoBGP-1 | +--------------+ | GoBGP-3 | +--------------+ |Quagga-2|+----------------+| pc1 |\n  192.168.100.0/24 |        |  192.168.3.0/24  |        |  192.168.0.0/24  |         |   172.16.0.0/24  |         |  192.168.2.0/24  |        | 192.168.101.0/24 |     |\n                   +------\u2014-+         +        +--------+                  +---------+                  +---------+                  +--------+                  +-----+\n                                      |                                                                   .2 +\n                                      |                                                                      |\n                                     Vrrp                                                                    |\n                             (VIP: 192.168.3.100)                                                            |\n                                      |                                                                      |\n                                      |         +--------+                  +---------+                      |\n                                      |    .102 |        | .1   e-BGP    .2 |         | .1      i-BGP        |\n                                      +-------+ | SRX-2  | +--------------+ | GoBGP-2 | +--------------------+\n                                                |        |  192.168.1.0/24  |         |      172.16.1.0/24\n                                                +--------+                  +---------+\n                                                < AS65000 >                 < AS65001 >\n\n```\n\n### (2) \u30bf\u30fc\u30b2\u30c3\u30c8\u6a5f\u5668 \nSRX\u6a5f\u5668\u306f\u3001SRX100H\uff08\u5b9f\u6a5f\uff09\u3067\u8a66\u3057\u3066\u3044\u307e\u3059\u3002\n\n![SRX\u6a5f\u5668.png](https://qiita-image-store.s3.amazonaws.com/0/103595/da76c0c0-e2ca-5642-78ef-deee89c41a01.png)\n\n\u305d\u3057\u3066\u3001\u6b21\u306e\u3088\u3046\u306a\u521d\u671f\u30b3\u30f3\u30d5\u30a3\u30b0\u72b6\u614b\u304b\u3089\u3001OoenStack Heat\u30aa\u30fc\u30b1\u30b9\u30c8\u30ec\u30fc\u30b7\u30e7\u30f3\u3092\u6d3b\u7528\u3057\u3066\u3001BGP\u52d5\u4f5c\u306b\u5fc5\u8981\u306a\u30b3\u30f3\u30d5\u30a3\u30b0\u8ffd\u52a0\u3092\u884c\u3046\u3053\u3068\u306b\u3057\u307e\u3057\u305f\u3002\u306a\u304a\u3001VRRP\u306e\u8a2d\u5b9a\u306f\u3001\u521d\u671f\u72b6\u614b\u3067\u8a2d\u5b9a\u5b8c\u4e86\u6e08\u307f\u3068\u3057\u307e\u3059\u3002\n\n- SRX\u6a5f\u5668\uff11\u53f7\u6a5f\u306e\u521d\u671f\u30b3\u30f3\u30d5\u30a3\u30b0\u72b6\u614b\n\n```\ntsubo@SRX-1> show configuration |display set |except \"set security\" |except \"set system\"\nset version 12.1X44-D35.5\nset interfaces fe-0/0/0 unit 0 family inet address 192.168.200.101/24\nset interfaces fe-0/0/1 unit 0 family inet address 192.168.0.1/24\nset interfaces fe-0/0/2 unit 0 family inet address 192.168.3.101/24 vrrp-group 10 virtual-address 192.168.3.100\nset interfaces fe-0/0/2 unit 0 family inet address 192.168.3.101/24 vrrp-group 10 priority 254\nset interfaces lo0 unit 0 family inet address 10.0.0.1/32\n```\n- SRX\u6a5f\u5668\uff12\u53f7\u6a5f\u306e\u521d\u671f\u30b3\u30f3\u30d5\u30a3\u30b0\u72b6\u614b\n\n```\ntsubo@SRX-2> show configuration |display set |except \"set security\" |except \"set system\"\nset version 12.1X44-D30.4\nset interfaces fe-0/0/0 unit 0 family inet address 192.168.200.102/24\nset interfaces fe-0/0/1 unit 0 family inet address 192.168.1.1/24\nset interfaces fe-0/0/2 unit 0 family inet address 192.168.3.102/24 vrrp-group 10 virtual-address 192.168.3.100\nset interfaces fe-0/0/2 unit 0 family inet address 192.168.3.102/24 vrrp-group 10 priority 200\nset interfaces lo0 unit 0 family inet address 10.0.0.2/32\n```\n\n### (3) SRX\u6a5f\u5668\u3067\u306e\u74b0\u5883\u6574\u5099\n\n- \u4eca\u56de\u3001OpenStack Heat\u3092\u4f7f\u7528\u3057\u3066\u3001SRX\u6a5f\u5668\u306e\u30b3\u30f3\u30d5\u30a3\u30b0\u8a2d\u5b9a\u3092\u884c\u3044\u307e\u3059\u3002\u5f93\u3063\u3066\u3001SRX\u6a5f\u5668\u5074\u3067\u306f\u3001NETCONF\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u74b0\u5883\u304b\u3089\u306e\u5236\u5fa1\u3092\u53d7\u4fe1\u3067\u304d\u308b\u3088\u3046\u306b\u6e96\u5099\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n\u5177\u4f53\u7684\u306b\u306f\u3001NETCONF\u30d7\u30ed\u30c8\u30b3\u30eb\uff08830\u30dd\u30fc\u30c8\uff09\u3092\u6709\u52b9\u306b\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n\n```\ntsubo@SRX-1> configure \nEntering configuration mode\n\n[edit]\ntsubo@SRX-1# set system services netconf ssh port 830\n```\n\n### (4) OpenStack Heat\u306e\u74b0\u5883\u6574\u5099\n\n- \u307e\u305a\u3001[Qiita\u8a18\u4e8b\u300cMitaka\u7248 OpenStack Heat\u74b0\u5883\u3092\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\u3057\u3066\u307f\u305f\u300d](http://qiita.com/ttsubo/items/7439116ab0e0484ef654)\u306b\u5f93\u3063\u3066\u3001Heat\u74b0\u5883\u3092\u69cb\u7bc9\u3057\u307e\u3059\u3002\n\n- Ncclient\u30d1\u30c3\u30b1\u30fc\u30b8\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\n\n```\n$ sudo apt-get install python-ncclient\n```\n\n- Heat\u74b0\u5883\u304c\u3001netconf\u30d7\u30ed\u30c8\u30b3\u30eb\u3092\u4ecb\u3057\u3066\u3001JUNOS\u30eb\u30fc\u30bf\u306b\u30b3\u30f3\u30d5\u30a3\u30b0\u8a2d\u5b9a\u304c\u884c\u3048\u308b\u3088\u3046\u306b\u3001Plugin\u62e1\u5f35\u3092\u884c\u3044\u307e\u3059\u3002\u3053\u3053\u3067\u306e\u4f8b\u3067\u306f\u3001\"/sample\"\u914d\u4e0b\u306bPlugin\u62e1\u5f35\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3059\u308b\u3082\u306e\u3068\u3057\u3066\u8aac\u660e\u3057\u3066\u304a\u308a\u307e\u3059\u3002\n\n```\n$ mkdir /sample\n$ cd /sample\n$ git clone https://github.com/ttsubo/netconf_heat.git\n```\n- Plugin\u62e1\u5f35\u3092\u6709\u52b9\u306b\u3059\u308b\u305f\u3081\u3001Heat-engine\u3092\u505c\u6b62\u3057\u307e\u3059\u3002\n\n```\n$ sudo service heat-engine stop\n```\n- Heat\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u306b\u3001Plugin\u62e1\u5f35\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u4f4d\u7f6e\u3092\u30a8\u30f3\u30c8\u30ea\u3057\u307e\u3059\u3002\n\n```\n$ sudo vi /etc/heat/heat.conf\n```\n```text:/etc/heat/heat.conf\n[DEFAULT]\n...\n\ninfo = True\nplugin_dirs = /sample/netconf_heat/resources\n\n```\n- \u3057\u3070\u3089\u304f\u306f\u3001Heat-engine\u3092\u624b\u52d5\u8d77\u52d5\u3057\u3066\u3001Plugin\u62e1\u5f35\u304c\u671f\u5f85\u901a\u308a\u306b\u52d5\u4f5c\u3057\u3066\u3044\u308b\u304b\u78ba\u8a8d\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n\n```\n$ sudo python /usr/bin/heat-engine --config-file /etc/heat/heat.conf\n...\n```\n\n# \u25a0 JUNOS\u30b3\u30f3\u30d5\u30a3\u30b0\u8a2d\u5b9a\u306e\u81ea\u52d5\u5316\u3092\u958b\u59cb\u3057\u3066\u307f\u308b ...\n\u3044\u3088\u3044\u3088\u3001Heat\u3092\u6d3b\u7528\u3057\u3066\u3001\u30b3\u30f3\u30d5\u30a3\u30b0\u8a2d\u5b9a\u3092\u884c\u3044\u307e\u3059\u3002\n\n### (1) SRX\u6a5f\u5668\uff11\u53f7\u6a5f\u5411\u3051\u306e\u30b3\u30f3\u30d5\u30a3\u30b0\u8a2d\u5b9a\u3092\u958b\u59cb\u3059\u308b\n- Heat\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u3092\u4f7f\u3063\u3066\u3001Heat\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u5b9a\u7fa9\u3057\u305f\u30d1\u30e9\u30e1\u30fc\u30bf\u3092\u6307\u5b9a\u3057\u305f\u4e0a\u3067\u3001Heat\u30b9\u30bf\u30c3\u30af\"SRX_1_stack\"\u4f5c\u6210\u3092\u958b\u59cb\u3057\u307e\u3059\u3002\uff08username=xxxx;password=xxxx\u306f\u3001\u9069\u6642\u3001\u7f6e\u304d\u63db\u3048\u3066\u304f\u3060\u3055\u3044\u3002\uff09\n\n```\n$ openstack stack create --parameter \"router_ipaddr=192.168.200.101;username=xxxx;password=xxxx;router_port=830;policy_name=export-static;group_name=EXTERNAL;bgp_type=external;policy_statement=export-static;neighbor=192.168.0.2;peer_as=65001;static_route=0.0.0.0/0;next_hop=192.168.3.1;router_id=10.0.0.1;my_as=65000\" --template junos_netconf.yaml SRX_1_stack\n+---------------------+--------------------------------------+\n| Field               | Value                                |\n+---------------------+--------------------------------------+\n| id                  | 34db21af-a024-4953-80ca-cbd5b15f8d06 |\n| stack_name          | SRX_1_stack                          |\n| description         | Netconf for Junos                    |\n|                     |                                      |\n| creation_time       | 2016-11-26T06:18:51                  |\n| updated_time        | None                                 |\n| stack_status        | CREATE_IN_PROGRESS                   |\n| stack_status_reason | Stack CREATE started                 |\n+---------------------+--------------------------------------+\n```\n- \u8a2d\u5b9a\u304c\u5b8c\u4e86\u3059\u308b\u306b\u306f\u3001\u6570\u5206\u306e\u6642\u9593\u3092\u8981\u3059\u308b\u306e\u3067\u3001Heat\u30b9\u30bf\u30c3\u30af\u52d5\u4f5c\u72b6\u614b\u3092\u3001\u9069\u6642\u3001\u78ba\u8a8d\u3057\u307e\u3059\u3002\nHeat\u30b9\u30bf\u30c3\u30af\u306e\u30b9\u30c6\u30fc\u30bf\u30b9\u304c\u3001\"CREATE_COMPLETE\"\u3068\u306a\u308c\u3070\u3001\u5b8c\u4e86\u3067\u3059\u3002\n\n```\n$ openstack stack list\n+--------------------------------------+-------------+--------------------+---------------------+--------------+\n| ID                                   | Stack Name  | Stack Status       | Creation Time       | Updated Time |\n+--------------------------------------+-------------+--------------------+---------------------+--------------+\n| 34db21af-a024-4953-80ca-cbd5b15f8d06 | SRX_1_stack | CREATE_IN_PROGRESS | 2016-11-26T06:18:51 | None         |\n+--------------------------------------+-------------+--------------------+---------------------+--------------+\n...\n\n$ openstack stack list\n+--------------------------------------+-------------+-----------------+---------------------+--------------+\n| ID                                   | Stack Name  | Stack Status    | Creation Time       | Updated Time |\n+--------------------------------------+-------------+-----------------+---------------------+--------------+\n| 34db21af-a024-4953-80ca-cbd5b15f8d06 | SRX_1_stack | CREATE_COMPLETE | 2016-11-26T06:18:51 | None         |\n+--------------------------------------+-------------+-----------------+---------------------+--------------+\n```\n\n- Heat\u30b9\u30bf\u30c3\u30af\u306e\u8a73\u7d30\u3092\u78ba\u8a8d\u3057\u3066\u307f\u307e\u3059\u3002\u3061\u306a\u307f\u306b\u3001show\u30b3\u30de\u30f3\u30c9\u3067\u8a73\u7d30\u3092\u78ba\u8a8d\u3059\u308b\u3068\u3001SRX\u6a5f\u5668\u306b\u5b9f\u969b\u3001\u30b3\u30f3\u30d5\u30a3\u30b0\u60c5\u5831\u306e\u53d6\u5f97\u3092\u884c\u3046\u305f\u3081\u3001\u30b3\u30de\u30f3\u30c9\u5b8c\u4e86\u306b\u3001\u3057\u3070\u3089\u304f\u6642\u9593\u3092\u8981\u3059\u308b\u3088\u3046\u3067\u3059\u3002\uff08output\u30d5\u30a3\u30fc\u30eb\u30c9\u3092\u78ba\u8a8d\u3057\u3066\u3082\u3089\u3048\u308c\u3070\u3001\u5b9f\u969b\u3001netconf\u7d4c\u7531\u3067\u3001\u30b3\u30f3\u30d5\u30a3\u30b0\u53d6\u5f97\u3057\u305f\u7d50\u679c\u304c\u4fdd\u6301\u3055\u308c\u3066\u3044\u308b\u69d8\u5b50\u3082\u78ba\u8a8d\u3067\u304d\u307e\u3059\u3002\uff09\n\n```\n$ openstack stack show SRX_1_stack\n+-----------------------+---------------------------------------------------------------------------------------------------------------------------+\n| Field                 | Value                                                                                                                     |\n+-----------------------+---------------------------------------------------------------------------------------------------------------------------+\n| id                    | 34db21af-a024-4953-80ca-cbd5b15f8d06                                                                                      |\n| stack_name            | SRX_1_stack                                                                                                               |\n| description           | Netconf for Junos                                                                                                         |\n|                       |                                                                                                                           |\n| creation_time         | 2016-11-26T06:18:51                                                                                                       |\n| updated_time          | None                                                                                                                      |\n| stack_status          | CREATE_COMPLETE                                                                                                           |\n| stack_status_reason   | Stack CREATE completed successfully                                                                                       |\n| parameters            | OS::project_id: 6f1763f7643e4ee9bb2d2d9dd9bb0bc6                                                                          |\n|                       | OS::stack_id: 34db21af-a024-4953-80ca-cbd5b15f8d06                                                                        |\n|                       | OS::stack_name: SRX_1_stack                                                                                               |\n|                       | bgp_type: external                                                                                                        |\n|                       | group_name: EXTERNAL                                                                                                      |\n|                       | my_as: '65000'                                                                                                            |\n|                       | neighbor: 192.168.0.2                                                                                                     |\n|                       | next_hop: 192.168.3.1                                                                                                     |\n|                       | password: xxxx                                                                                                            |\n|                       | peer_as: '65001'                                                                                                          |\n|                       | policy_name: export-static                                                                                                |\n|                       | policy_statement: export-static                                                                                           |\n|                       | router_id: 10.0.0.1                                                                                                       |\n|                       | router_ipaddr: 192.168.200.101                                                                                            |\n|                       | router_port: '830'                                                                                                        |\n|                       | static_route: 0.0.0.0/0                                                                                                   |\n|                       | username: xxxx                                                                                                            |\n|                       |                                                                                                                           |\n| outputs               | - description: display config_routing_options                                                                             |\n|                       |   output_key: display_routing_options                                                                                     |\n|                       |   output_value:                                                                                                           |\n|                       |     config_routing_options: \"\\n## Last changed: 2016-11-26 15:19:04 JST\\nrouting-options\\                                 |\n|                       |       \\ {\\n    static {\\n        route 0.0.0.0/0 next-hop 192.168.3.1;\\n    }\\n  \\                                        |\n|                       |       \\  router-id 10.0.0.1;\\n    autonomous-system 65000;\\n}\\n\"                                                          |\n|                       | - description: display config_protocols                                                                                   |\n|                       |   output_key: display_protocols                                                                                           |\n|                       |   output_value:                                                                                                           |\n|                       |     config_protocols: \"\\n## Last changed: 2016-11-26 15:19:04 JST\\nprotocols {\\n \\                                        |\n|                       |       \\   bgp {\\n        group EXTERNAL {\\n            type external;\\n          \\                                        |\n|                       |       \\  export export-static;\\n            neighbor 192.168.0.2 {\\n             \\                                        |\n|                       |       \\   peer-as 65001;\\n            }\\n        }\\n    }\\n}\\n\"                                                           |\n|                       | - description: display config_policy_options                                                                              |\n|                       |   output_key: display_policy_options                                                                                      |\n|                       |   output_value:                                                                                                           |\n|                       |     config_routing_options: \"\\n## Last changed: 2016-11-26 15:19:04 JST\\npolicy-options\\                                  |\n|                       |       \\ {\\n    policy-statement export-static {\\n        term 1 {\\n            from\\                                      |\n|                       |       \\ protocol static;\\n            then accept;\\n        }\\n    }\\n}\\n\"                                                |\n|                       |                                                                                                                           |\n| links                 | - href: http://localhost:8004/v1/6f1763f7643e4ee9bb2d2d9dd9bb0bc6/stacks/SRX_1_stack/34db21af-a024-4953-80ca-cbd5b15f8d06 |\n|                       |   rel: self                                                                                                               |\n|                       |                                                                                                                           |\n| disable_rollback      | True                                                                                                                      |\n| parent                | None                                                                                                                      |\n| tags                  | null                                                                                                                      |\n|                       | ...                                                                                                                       |\n|                       |                                                                                                                           |\n| stack_user_project_id | 4d93e1ad2a1045179a492c8d072f5827                                                                                          |\n| capabilities          | []                                                                                                                        |\n| notification_topics   | []                                                                                                                        |\n| timeout_mins          | None                                                                                                                      |\n| stack_owner           | None                                                                                                                      |\n+-----------------------+---------------------------------------------------------------------------------------------------------------------------+\n\n```\n- \u3042\u3068\u3001\u4f59\u8ac7\u3067\u3059\u304c\u3001Heat\u30b9\u30bf\u30c3\u30af\u3092\u69cb\u6210\u3059\u308b\u5404\u7a2e\u30ea\u30bd\u30fc\u30b9\u60c5\u5831\u3082\u78ba\u8a8d\u3059\u308b\u3053\u3068\u304c\u53ef\u80fd\u3067\u3059\u3002\n\n```\n$ openstack stack resource list SRX_1_stack\n+-----------------+--------------------------------------+-------------------------------------+-----------------+---------------------+\n| resource_name   | physical_resource_id                 | resource_type                       | resource_status | updated_time        |\n+-----------------+--------------------------------------+-------------------------------------+-----------------+---------------------+\n| policy-options  | cd9b1616-f728-4984-9cbb-97072219269f | OS::Netconf::PolicyOptionsResource  | CREATE_COMPLETE | 2016-11-26T06:18:51 |\n| routing-options | 871f05d7-bd3f-49e9-b21f-fa3e6d401365 | OS::Netconf::RoutingOptionsResource | CREATE_COMPLETE | 2016-11-26T06:18:51 |\n| protocols       | cb1ae2ad-329b-4225-a0ca-f8138c7b45a5 | OS::Netconf::ProtocolsResource      | CREATE_COMPLETE | 2016-11-26T06:18:51 |\n+-----------------+--------------------------------------+-------------------------------------+-----------------+---------------------+\n\n$ openstack stack resource show SRX_1_stack policy-options\n+------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\n| Field                  | Value                                                                                                                                                                                                                                                                                                                          |\n+------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\n| attributes             | {u'config_routing_options': u'\\n## Last changed: 2016-11-26 15:19:04 JST\\npolicy-options {\\n    policy-statement export-static {\\n        term 1 {\\n            from protocol static;\\n            then accept;\\n        }\\n    }\\n}\\n'}                                                                                       |\n| creation_time          | 2016-11-26T06:18:51                                                                                                                                                                                                                                                                                                            |\n| description            |                                                                                                                                                                                                                                                                                                                                |\n| links                  | [{u'href': u'http://localhost:8004/v1/6f1763f7643e4ee9bb2d2d9dd9bb0bc6/stacks/SRX_1_stack/34db21af-a024-4953-80ca-cbd5b15f8d06/resources/policy-options', u'rel': u'self'}, {u'href': u'http://localhost:8004/v1/6f1763f7643e4ee9bb2d2d9dd9bb0bc6/stacks/SRX_1_stack/34db21af-a024-4953-80ca-cbd5b15f8d06', u'rel': u'stack'}] |\n| logical_resource_id    | policy-options                                                                                                                                                                                                                                                                                                                 |\n| physical_resource_id   | cd9b1616-f728-4984-9cbb-97072219269f                                                                                                                                                                                                                                                                                           |\n| required_by            | [u'protocols']                                                                                                                                                                                                                                                                                                                 |\n| resource_name          | policy-options                                                                                                                                                                                                                                                                                                                 |\n| resource_status        | CREATE_COMPLETE                                                                                                                                                                                                                                                                                                                |\n| resource_status_reason | state changed                                                                                                                                                                                                                                                                                                                  |\n| resource_type          | OS::Netconf::PolicyOptionsResource                                                                                                                                                                                                                                                                                             |\n| updated_time           | 2016-11-26T06:18:51                                                                                                                                                                                                                                                                                                            |\n+------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\n\n$ openstack stack resource show SRX_1_stack routing-options\n+------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\n| Field                  | Value                                                                                                                                                                                                                                                                                                                           |\n+------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\n| attributes             | {u'config_routing_options': u'\\n## Last changed: 2016-11-26 15:19:04 JST\\nrouting-options {\\n    static {\\n        route 0.0.0.0/0 next-hop 192.168.3.1;\\n    }\\n    router-id 10.0.0.1;\\n    autonomous-system 65000;\\n}\\n'}                                                                                                   |\n| creation_time          | 2016-11-26T06:18:51                                                                                                                                                                                                                                                                                                             |\n| description            |                                                                                                                                                                                                                                                                                                                                 |\n| links                  | [{u'href': u'http://localhost:8004/v1/6f1763f7643e4ee9bb2d2d9dd9bb0bc6/stacks/SRX_1_stack/34db21af-a024-4953-80ca-cbd5b15f8d06/resources/routing-options', u'rel': u'self'}, {u'href': u'http://localhost:8004/v1/6f1763f7643e4ee9bb2d2d9dd9bb0bc6/stacks/SRX_1_stack/34db21af-a024-4953-80ca-cbd5b15f8d06', u'rel': u'stack'}] |\n| logical_resource_id    | routing-options                                                                                                                                                                                                                                                                                                                 |\n| physical_resource_id   | 871f05d7-bd3f-49e9-b21f-fa3e6d401365                                                                                                                                                                                                                                                                                            |\n| required_by            | [u'protocols']                                                                                                                                                                                                                                                                                                                  |\n| resource_name          | routing-options                                                                                                                                                                                                                                                                                                                 |\n| resource_status        | CREATE_COMPLETE                                                                                                                                                                                                                                                                                                                 |\n| resource_status_reason | state changed                                                                                                                                                                                                                                                                                                                   |\n| resource_type          | OS::Netconf::RoutingOptionsResource                                                                                                                                                                                                                                                                                             |\n| updated_time           | 2016-11-26T06:18:51                                                                                                                                                                                                                                                                                                             |\n+------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\n\n$ openstack stack resource show SRX_1_stack protocols\n+------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\n| Field                  | Value                                                                                                                                                                                                                                                                                                                     |\n+------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\n| attributes             | {u'config_protocols': u'\\n## Last changed: 2016-11-26 15:19:04 JST\\nprotocols {\\n    bgp {\\n        group EXTERNAL {\\n            type external;\\n            export export-static;\\n            neighbor 192.168.0.2 {\\n                peer-as 65001;\\n            }\\n        }\\n    }\\n}\\n'}                           |\n| creation_time          | 2016-11-26T06:18:51                                                                                                                                                                                                                                                                                                       |\n| description            |                                                                                                                                                                                                                                                                                                                           |\n| links                  | [{u'href': u'http://localhost:8004/v1/6f1763f7643e4ee9bb2d2d9dd9bb0bc6/stacks/SRX_1_stack/34db21af-a024-4953-80ca-cbd5b15f8d06/resources/protocols', u'rel': u'self'}, {u'href': u'http://localhost:8004/v1/6f1763f7643e4ee9bb2d2d9dd9bb0bc6/stacks/SRX_1_stack/34db21af-a024-4953-80ca-cbd5b15f8d06', u'rel': u'stack'}] |\n| logical_resource_id    | protocols                                                                                                                                                                                                                                                                                                                 |\n| physical_resource_id   | cb1ae2ad-329b-4225-a0ca-f8138c7b45a5                                                                                                                                                                                                                                                                                      |\n| required_by            | []                                                                                                                                                                                                                                                                                                                        |\n| resource_name          | protocols                                                                                                                                                                                                                                                                                                                 |\n| resource_status        | CREATE_COMPLETE                                                                                                                                                                                                                                                                                                           |\n| resource_status_reason | state changed                                                                                                                                                                                                                                                                                                             |\n| resource_type          | OS::Netconf::ProtocolsResource                                                                                                                                                                                                                                                                                            |\n| updated_time           | 2016-11-26T06:18:51                                                                                                                                                                                                                                                                                                       |\n+------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\n```\n\n### (2) SRX\u6a5f\u5668\uff12\u53f7\u6a5f\u5411\u3051\u306e\u30b3\u30f3\u30d5\u30a3\u30b0\u8a2d\u5b9a\u3092\u958b\u59cb\u3059\u308b\n- SRX\u6a5f\u5668\uff12\u53f7\u6a5f\u5411\u3051\u306b\u3001Heat\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u5b9a\u7fa9\u3057\u305f\u30d1\u30e9\u30e1\u30fc\u30bf\u3092\u6307\u5b9a\u3057\u305f\u4e0a\u3067\u3001Heat\u30b9\u30bf\u30c3\u30af\"SRX_2_stack\"\u4f5c\u6210\u3092\u958b\u59cb\u3057\u307e\u3059\u3002\n\n```\n$ openstack stack create --parameter \"router_ipaddr=192.168.200.102;username=xxxx;password=xxxx;router_port=830;policy_name=export-static;group_name=EXTERNAL;bgp_type=external;policy_statement=export-static;neighbor=192.168.1.2;peer_as=65001;static_route=0.0.0.0/0;next_hop=192.168.3.1;router_id=10.0.0.2;my_as=65000\" --template junos_netconf.yaml SRX_2_stack\n+---------------------+--------------------------------------+\n| Field               | Value                                |\n+---------------------+--------------------------------------+\n| id                  | 1435cb65-0923-492f-b485-e5e1a3a266e3 |\n| stack_name          | SRX_2_stack                          |\n| description         | Netconf for Junos                    |\n|                     |                                      |\n| creation_time       | 2016-11-26T06:29:29                  |\n| updated_time        | None                                 |\n| stack_status        | CREATE_IN_PROGRESS                   |\n| stack_status_reason | Stack CREATE started                 |\n+---------------------+--------------------------------------+\n```\n- \u9069\u6642\u3001Heat\u30b9\u30bf\u30c3\u30af\u4f5c\u6210\u306e\u69d8\u5b50\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\n\n```\n$ openstack stack list\n+--------------------------------------+-------------+--------------------+---------------------+--------------+\n| ID                                   | Stack Name  | Stack Status       | Creation Time       | Updated Time |\n+--------------------------------------+-------------+--------------------+---------------------+--------------+\n| 1435cb65-0923-492f-b485-e5e1a3a266e3 | SRX_2_stack | CREATE_IN_PROGRESS | 2016-11-26T06:29:29 | None         |\n| 34db21af-a024-4953-80ca-cbd5b15f8d06 | SRX_1_stack | CREATE_COMPLETE    | 2016-11-26T06:18:51 | None         |\n+--------------------------------------+-------------+--------------------+---------------------+--------------+\n...\n\n$ openstack stack list\n+--------------------------------------+-------------+-----------------+---------------------+--------------+\n| ID                                   | Stack Name  | Stack Status    | Creation Time       | Updated Time |\n+--------------------------------------+-------------+-----------------+---------------------+--------------+\n| 1435cb65-0923-492f-b485-e5e1a3a266e3 | SRX_2_stack | CREATE_COMPLETE | 2016-11-26T06:29:29 | None         |\n| 34db21af-a024-4953-80ca-cbd5b15f8d06 | SRX_1_stack | CREATE_COMPLETE | 2016-11-26T06:18:51 | None         |\n+--------------------------------------+-------------+-----------------+---------------------+--------------+\n```\n# \u25a0 \u5b9f\u9a13\u7528\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u74b0\u5883\u304c\u6574\u3063\u305f\u306e\u3067\u3001\u3057\u3070\u3089\u304f\u3001\u904a\u3093\u3067\u307f\u308b\u3002\n\n\u3082\u3046\u4e00\u5ea6\u3001\u5b9f\u9a13\u7528\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u5168\u4f53\u69cb\u6210\u56f3\u3092\u518d\u63b2\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n\n```\n                                              < AS65000 >                 < AS65001 >                  < AS65001 >                  < 650002 >\n                   +\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014+                  +--------+                  +---------+                  +---------+                  +--------+                  +-----+\n              .201 |        | .1          .101 |        | .1   e-BGP    .2 |         | .1   i-BGP    .2 |         | .1   e-BGP   .2  |        | .1           .2  |     |\n Internet +-------+|Quagga-1| +--------------+ | SRX-1  | +--------------+ | GoBGP-1 | +--------------+ | GoBGP-3 | +--------------+ |Quagga-2|+----------------+| pc1 |\n  192.168.100.0/24 |        |  192.168.3.0/24  |        |  192.168.0.0/24  |         |   172.16.0.0/24  |         |  192.168.2.0/24  |        | 192.168.101.0/24 |     |\n                   +------\u2014-+         +        +--------+                  +---------+                  +---------+                  +--------+                  +-----+\n                                      |                                                                   .2 +\n                                      |                                                                      |\n                                     Vrrp                                                                    |\n                             (VIP: 192.168.3.100)                                                            |\n                                      |                                                                      |\n                                      |         +--------+                  +---------+                      |\n                                      |    .102 |        | .1   e-BGP    .2 |         | .1      i-BGP        |\n                                      +-------+ | SRX-2  | +--------------+ | GoBGP-2 | +--------------------+\n                                                |        |  192.168.1.0/24  |         |      172.16.1.0/24\n                                                +--------+                  +---------+\n                                                < AS65000 >                 < AS65001 >\n\n```\n\n### (1) \u307e\u305a\u306f\u3001\u30b3\u30f3\u30d5\u30a3\u30b0\u60c5\u5831\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\n\n- SRX\u6a5f\u5668\uff11\u53f7\u6a5f\u304b\u3089 ...\n\n```\ntsubo@SRX-1> show configuration |display set |except \"set security\" |except \"set system\"\nset version 12.1X44-D35.5\nset interfaces fe-0/0/0 unit 0 family inet address 192.168.200.101/24\nset interfaces fe-0/0/1 unit 0 family inet address 192.168.0.1/24\nset interfaces fe-0/0/2 unit 0 family inet address 192.168.3.101/24 vrrp-group 10 virtual-address 192.168.3.100\nset interfaces fe-0/0/2 unit 0 family inet address 192.168.3.101/24 vrrp-group 10 priority 254\nset interfaces lo0 unit 0 family inet address 10.0.0.1/32\nset routing-options static route 0.0.0.0/0 next-hop 192.168.3.1\nset routing-options router-id 10.0.0.1\nset routing-options autonomous-system 65000\nset protocols bgp group EXTERNAL type external\nset protocols bgp group EXTERNAL export export-static\nset protocols bgp group EXTERNAL neighbor 192.168.0.2 peer-as 65001\nset policy-options policy-statement export-static term 1 from protocol static\nset policy-options policy-statement export-static term 1 then accept\n```\n- \u3064\u3065\u3044\u3066\u3001SRX\u6a5f\u5668\uff12\u53f7\u6a5f ...\n\n```\ntsubo@SRX-2> show configuration |display set |except \"set security\" |except \"set system\"\nset version 12.1X44-D30.4\nset interfaces fe-0/0/0 unit 0 family inet address 192.168.200.102/24\nset interfaces fe-0/0/1 unit 0 family inet address 192.168.1.1/24\nset interfaces fe-0/0/2 unit 0 family inet address 192.168.3.102/24 vrrp-group 10 virtual-address 192.168.3.100\nset interfaces fe-0/0/2 unit 0 family inet address 192.168.3.102/24 vrrp-group 10 priority 200\nset interfaces lo0 unit 0 family inet address 10.0.0.2/32\nset routing-options static route 0.0.0.0/0 next-hop 192.168.3.1\nset routing-options router-id 10.0.0.2\nset routing-options autonomous-system 65000\nset protocols bgp group EXTERNAL type external\nset protocols bgp group EXTERNAL export export-static\nset protocols bgp group EXTERNAL neighbor 192.168.1.2 peer-as 65001\nset policy-options policy-statement export-static term 1 from protocol static\nset policy-options policy-statement export-static term 1 then accept\n```\n- GoBGP\uff13\u53f7\u6a5f\u3067\u306eBGP\u30c6\u30fc\u30d6\u30eb\u3092\u78ba\u8a8d\u3057\u3066\u307f\u308b\u3002\n\n```\npi@gobgp3:~ $ gobgp global rib\n    Network             Next Hop             AS_PATH              Age        Attrs\n*>  0.0.0.0/0           172.16.0.1           65000                00:28:23   [{Origin: i} {LocalPref: 100}]\n*   0.0.0.0/0           172.16.1.1           65000                00:17:36   [{Origin: i} {LocalPref: 100}]\n*>  192.168.101.0/24    192.168.2.2          65002                00:59:49   [{Origin: i} {Med: 0}]\n```\n\u306f\u3044\u3001SRX\u6a5f\u5668\u3067\u914d\u4fe1\u3055\u308c\u305f\u30c7\u30d5\u30a9\u30eb\u30c8\u30eb\u30fc\u30c8\u304c\u3001GoBGP\uff13\u53f7\u6a5f\u3067\u6b63\u3057\u304f\u5b66\u7fd2\u3067\u304d\u3066\u3044\u308b\u3088\u3046\u3067\u3059\u3002\n\n### (2) \u30a8\u30f3\u30c9\u30a8\u30f3\u30c9\u3067\u3001\u901a\u4fe1\u3057\u3066\u307f\u308b\n\n- \u307e\u305a\u306f\u3001pc1\u5074\u304b\u3089\u3001\u5b9a\u756a\u306eping\u78ba\u8a8d\u3057\u3066\u307f\u308b\u3068 ...\n\n```\n$ ping 192.168.100.1\nPING 192.168.100.1 (192.168.100.1): 56 data bytes\n64 bytes from 192.168.100.1: icmp_seq=0 ttl=250 time=1.964 ms\n64 bytes from 192.168.100.1: icmp_seq=1 ttl=250 time=1.982 ms\n64 bytes from 192.168.100.1: icmp_seq=2 ttl=250 time=1.889 ms\n64 bytes from 192.168.100.1: icmp_seq=3 ttl=250 time=1.958 ms\n^C\n--- 192.168.100.1 ping statistics ---\n4 packets transmitted, 4 packets received, 0.0% packet loss\nround-trip min/avg/max/stddev = 1.889/1.948/1.982/0.035 ms\n```\n- \u3055\u3089\u306b\u3001pc1\u5074\u304b\u3089\u3001YouTube\u3092\u95b2\u89a7\u3057\u3066\u307f\u307e\u3057\u305f ...\n\n![youtube.png](https://qiita-image-store.s3.amazonaws.com/0/103595/cfbb6aa0-caec-2205-efcc-16538be3ea87.png)\n\n\u304a\u3063!!\u3000\u61d0\u304b\u3057\u306e\u3001\u30ca\u30a4\u30c8\u30ec\u30f3\u30b8\u30e3\u30fc\u3060\uff01\n\n### (3) \u3064\u3044\u3067\u3001BGP\u7d4c\u8def\u5197\u9577\u306e\u52d5\u4f5c\u3082\u78ba\u8a8d\u3057\u3066\u307f\u308b\u3002\n\n- SRX\u6a5f\u5668\uff11\u53f7\u6a5f\u5074\u3067\u3001\u7269\u7406IF\u3092\u65ad\u7dda\u3055\u305b\u308b\u3068\u3001ICMP ECHO Reply\u30d1\u30b1\u30c3\u30c8\uff14\u767a\u7a0b\u5ea6\u306e\u53d6\u308a\u3053\u307c\u3057\u304c\u767a\u751f\u3057\u307e\u3057\u305f\u304c\u3001\u305d\u306e\u5f8c\u3001\u5fa9\u65e7\u3057\u3066\u3044\u307e\u3059\u3002\n\n```\n$ ping 192.168.100.1\nPING 192.168.100.1 (192.168.100.1): 56 data bytes\n64 bytes from 192.168.100.1: icmp_seq=0 ttl=250 time=1.860 ms\n64 bytes from 192.168.100.1: icmp_seq=1 ttl=250 time=1.922 ms\n64 bytes from 192.168.100.1: icmp_seq=2 ttl=250 time=1.963 ms\n64 bytes from 192.168.100.1: icmp_seq=3 ttl=250 time=1.973 ms\n64 bytes from 192.168.100.1: icmp_seq=4 ttl=250 time=2.260 ms\nRequest timeout for icmp_seq 5\nRequest timeout for icmp_seq 6\nRequest timeout for icmp_seq 7\nRequest timeout for icmp_seq 8\n64 bytes from 192.168.100.1: icmp_seq=9 ttl=250 time=1.945 ms\n64 bytes from 192.168.100.1: icmp_seq=10 ttl=250 time=2.064 ms\n64 bytes from 192.168.100.1: icmp_seq=11 ttl=250 time=2.156 ms\n64 bytes from 192.168.100.1: icmp_seq=12 ttl=250 time=1.992 ms\n^C\n```\n- \u3053\u306e\u6642\u3001GoBGP\uff13\u53f7\u6a5f\u3067\u306eBGP\u30c6\u30fc\u30d6\u30eb\u3092\u78ba\u8a8d\u3057\u3066\u307f\u308b\u3068\u3001\u7d4c\u8def\u304c\u5207\u308a\u66ff\u308f\u3063\u305f\u3053\u3068\u304c\u78ba\u8a8d\u3067\u304d\u307e\u3057\u305f\u3002\n\n```\npi@gobgp3:~ $ gobgp global rib\n    Network             Next Hop             AS_PATH              Age        Attrs\n*>  0.0.0.0/0           172.16.1.1           65000                00:05:31   [{Origin: i} {LocalPref: 100}]\n*>  192.168.101.0/24    192.168.2.2          65002                00:05:40   [{Origin: i} {Med: 0}]\n```\n\n# \u25a0 \u5f8c\u4f5c\u696d\u3068\u3057\u3066\u3001SRX\u6a5f\u5668\u306e\u30b3\u30f3\u30d5\u30a3\u30b0\u74b0\u5883\u3092\u5143\u306b\u623b\u3057\u3066\u304a\u304f ...\n\u697d\u3057\u3044\u3001\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u5b9f\u9a13\u304c\u7d42\u308f\u3063\u305f\u306e\u3067\u3001\u6700\u5f8c\u306b\u5f8c\u7247\u4ed8\u3051\u3067\u3059\u3002\nOpenStack Heat\u30aa\u30fc\u30b1\u30b9\u30c8\u30ec\u30fc\u30b7\u30e7\u30f3\u3092\u6d3b\u7528\u3057\u3066\u3044\u308b\u306e\u3067\u3001\u3053\u3053\u3067\u306f\u3001Heat\u30b9\u30bf\u30c3\u30af\u3092\u524a\u9664\u3059\u308b\u3060\u3051\u3067\u3059\uff01\uff01\n\n### (1) Heat\u30b9\u30bf\u30c3\u30af\u3092\u524a\u9664\u3057\u307e\u3059\u3002\n\n- \u307e\u305a\u306f\u3001SRX\u6a5f\u5668\uff11\u53f7\u6a5f\u304b\u3089 ...\n\n```\n$ openstack stack delete SRX_1_stack\nAre you sure you want to delete this stack(s) [y/N]? y\n```\n- \u524a\u9664\u8a2d\u5b9a\u304c\u5b8c\u4e86\u3059\u308b\u306b\u306f\u3001\u6570\u5206\u306e\u6642\u9593\u3092\u8981\u3059\u308b\u306e\u3067\u3001Heat\u30b9\u30bf\u30c3\u30af\u52d5\u4f5c\u72b6\u614b\u3092\u3001\u9069\u6642\u3001\u78ba\u8a8d\u3057\u307e\u3059\u3002Heat\u30b9\u30bf\u30c3\u30af\u306e\u30ec\u30b3\u30fc\u30c9\u304c\u524a\u9664\u3055\u308c\u3066\u3044\u308c\u3070\u3001\u5b8c\u4e86\u3067\u3059\u3002\n\n```\nopenstack stack list\n+--------------------------------------+-------------+--------------------+---------------------+--------------+\n| ID                                   | Stack Name  | Stack Status       | Creation Time       | Updated Time |\n+--------------------------------------+-------------+--------------------+---------------------+--------------+\n| 1435cb65-0923-492f-b485-e5e1a3a266e3 | SRX_2_stack | CREATE_COMPLETE    | 2016-11-26T06:29:29 | None         |\n| 34db21af-a024-4953-80ca-cbd5b15f8d06 | SRX_1_stack | DELETE_IN_PROGRESS | 2016-11-26T06:18:51 | None         |\n+--------------------------------------+-------------+--------------------+---------------------+--------------+\n...\n\n$ openstack stack list\n+--------------------------------------+-------------+-----------------+---------------------+--------------+\n| ID                                   | Stack Name  | Stack Status    | Creation Time       | Updated Time |\n+--------------------------------------+-------------+-----------------+---------------------+--------------+\n| 1435cb65-0923-492f-b485-e5e1a3a266e3 | SRX_2_stack | CREATE_COMPLETE | 2016-11-26T06:29:29 | None         |\n+--------------------------------------+-------------+-----------------+---------------------+--------------+\n```\n- \u3064\u3065\u3044\u3066\u3001SRX\u6a5f\u5668\uff12\u53f7\u6a5f ...\n\n```\n$ openstack stack delete SRX_2_stack\nAre you sure you want to delete this stack(s) [y/N]? y\n```\n- \u306f\u3044\u3001Heat\u30b9\u30bf\u30c3\u30af\u306f\u3001\u3059\u3079\u3066\u524a\u9664\u3055\u308c\u307e\u3057\u305f\u3002\n\n```\n$ openstack stack list\n\n```\n\n### (2) \u3044\u3061\u304a\u3046\u3001\u30b3\u30f3\u30d5\u30a3\u30b0\u60c5\u5831\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\n\n- \u307e\u305a\u306f\u3001SRX\u6a5f\u5668\uff11\u53f7\u6a5f\u304b\u3089 ...\n\n```\ntsubo@SRX-1> show configuration |display set |except \"set security\" |except \"set system\"\nset version 12.1X44-D35.5\nset interfaces fe-0/0/0 unit 0 family inet address 192.168.200.101/24\nset interfaces fe-0/0/1 unit 0 family inet address 192.168.0.1/24\nset interfaces fe-0/0/2 unit 0 family inet address 192.168.3.101/24 vrrp-group 10 virtual-address 192.168.3.100\nset interfaces fe-0/0/2 unit 0 family inet address 192.168.3.101/24 vrrp-group 10 priority 254\nset interfaces lo0 unit 0 family inet address 10.0.0.1/32\n```\n- \u3064\u3065\u3044\u3066\u3001SRX\u6a5f\u5668\uff12\u53f7\u6a5f ...\n\n```\ntsubo@SRX-2> show configuration |display set |except \"set security\" |except \"set system\"\nset version 12.1X44-D30.4\nset interfaces fe-0/0/0 unit 0 family inet address 192.168.200.102/24\nset interfaces fe-0/0/1 unit 0 family inet address 192.168.1.1/24\nset interfaces fe-0/0/2 unit 0 family inet address 192.168.3.102/24 vrrp-group 10 virtual-address 192.168.3.100\nset interfaces fe-0/0/2 unit 0 family inet address 192.168.3.102/24 vrrp-group 10 priority 200\nset interfaces lo0 unit 0 family inet address 10.0.0.2/32\n```\n\u671f\u5f85\u901a\u308a\u306b\u3001\u6700\u521d\u306e\u30b3\u30f3\u30d5\u30a3\u30b0\u72b6\u614b\u306b\u623b\u308a\u307e\u3057\u305f\u306d\uff01:grinning:\n\n# \u25a0 \u6700\u5f8c\u306b ...\nOpenStack Heat\u3092\u6d3b\u7528\u3059\u308c\u3070\u3001\u5f93\u6765\u306e\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u6a5f\u5668\u3055\u3048\u3082\u3001\u30aa\u30fc\u30b1\u30b9\u30c8\u30ec\u30fc\u30b7\u30e7\u30f3\u5bfe\u5fdc\u306e\u30b3\u30f3\u30d5\u30a3\u30b0\u8a2d\u5b9a\u306e\u81ea\u52d5\u5316\u304c\u5b9f\u73fe\u3067\u304d\u3066\u3057\u307e\u3046\u6642\u4ee3\u306b\u306a\u308a\u307e\u3057\u305f\u3002\n\u305f\u3060\u3057\u3001\u96e3\u70b9\u306a\u306e\u304c\u3001\u5404\u81ea\u306e\u74b0\u5883\u306b\u5373\u3057\u305fHeat\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u3092\u8a18\u8ff0\u3059\u308b\u30b9\u30ad\u30eb\u306e\u7fd2\u5f97\u304c\u5fc5\u8981\u4e0d\u53ef\u6b20\u3067\u3059\u3002\n[\u65e5\u672cOpenStack\u30e6\u30fc\u30b6\u4f1a \u7b2c28\u56de\u52c9\u5f37\u4f1a](https://openstack-jp.connpass.com/event/29795/)\u3067\u306f\u3001\u201dHeat \u306b\u3088\u308b\u30aa\u30fc\u30b1\u30b9\u30c8\u30ec\u30fc\u30b7\u30e7\u30f3\u5165\u9580\u201d\u3092\u30c6\u30fc\u30de\u3068\u3057\u3066\u53d6\u308a\u4e0a\u3052\u3089\u308c\u3066\u304a\u308a\u307e\u3057\u305f\u306e\u3067\u3001\u5b66\u7fd2\u7d20\u6750\u3068\u3057\u3066\u5927\u5909\u6709\u76ca\u3060\u3068\u601d\u3044\u307e\u3057\u305f\u3002\n\n# \u25a0 \u305d\u306e\u4ed6\u3001\u53c2\u8003\u306b\u3057\u305fURL\u60c5\u5831\n\n- [ncclient: Python library for NETCONF clients Docs](http://ncclient.readthedocs.io/en/latest/)\n- [Mapping Configuration Statements to Junos XML Tag Elements]\n(https://www.juniper.net/documentation/en_US/junos13.2/topics/reference/general/junos-xml-mapping-configuration-statements-to-junos-xml-tag-elements.html#X3jxH1bEUalu4XLZ.97)\n- [Deleting Configuration Elements Using NETCONF](https://www.juniper.net/documentation/en_US/junos14.2/topics/task/configuration/netconf-configuration-elements-deleting.html#GA3BlzparKBRvBsv.97)\n- [Error during commit: \"error: configuration database locked by\"](https://kb.juniper.net/InfoCenter/index?page=content&id=KB13067&actp=search#2kKg91L6HzVmZWgz.97)\n"}