{"tags": ["textexpander", "AppleScript", "Safari"], "context": " More than 1 year has passed since last update.\nTextExpander\u306b\u300cContent: \u30a2\u30c3\u30d7\u30eb\u30b9\u30af\u30ea\u30d7\u30c8\u300d\u3068\u3057\u3066\u767b\u9332\nSafari\u3067\u5f15\u7528\u90e8\u5206\u3092\u9078\u629e\u3057\u3066\u304a\u304d\u3001\u30c6\u30ad\u30b9\u30c8\u30a8\u30c7\u30a3\u30bf\u4e0a\u3067Abbreviation\u3092\u5165\u529b\u3057\u3066\u5b9f\u884c\nHTML\u30bf\u30b0\u3092\u542b\u3081\u3066\u5f15\u7528\u3059\u308b\u306e\u304c\u7279\u5fb4\n\n\n\u30ea\u30f3\u30af\u3092\u53cd\u6620\u3067\u304d\u308b\n\n\nThanks: Happy-Go-Lucky: Web\u30da\u30fc\u30b8\u3092 HTML \u306e\u307e\u307e\u5f15\u7528\u3059\u308b\u30d6\u30c3\u30af\u30de\u30fc\u30af\u30ec\u30c3\u30c8\n\n\n\nblockquote.scpt\ntell application \"Safari\"\n    tell current tab of window 1\n        do JavaScript \"var htmlText = '';\nif (document.selection) {\n    var c = document.selection.createRange();\n    htmlText = c.htmlText;\n} else {\n    var nNd = document.createElement(\\\"div\\\");\n    var sel = getSelection();\n    if (sel == null || sel == '') {\n        htmlText = '';\n    } else {\n        var w = getSelection().getRangeAt(0).cloneContents();\n        nNd.appendChild(w);\n        htmlText = nNd.innerHTML;\n    }\n}\n'<blockquote cite=\\\"' + location.href + '\\\" title=\\\"' + document.title + '\\\">\\\\n' + htmlText + '\\\\n' + '<cite><a href=\\\"' + location.href + '\\\" target=\\\"_blank\\\">' + document.title + '</a></cite>\\\\n' + '</blockquote>\\\\n';\"\n    end tell\nend tell\n\n\n\n\u66f4\u65b0\u5c65\u6b74\n\n2012-10-31: Google Chrome\u7248\u3068\u3057\u3066\u4f5c\u6210\n2015-12-25: Safari\u7248\u306b\u4fee\u6b63\n\n\n\n* TextExpander\u306b\u300cContent: \u30a2\u30c3\u30d7\u30eb\u30b9\u30af\u30ea\u30d7\u30c8\u300d\u3068\u3057\u3066\u767b\u9332\n* Safari\u3067\u5f15\u7528\u90e8\u5206\u3092\u9078\u629e\u3057\u3066\u304a\u304d\u3001\u30c6\u30ad\u30b9\u30c8\u30a8\u30c7\u30a3\u30bf\u4e0a\u3067Abbreviation\u3092\u5165\u529b\u3057\u3066\u5b9f\u884c\n* HTML\u30bf\u30b0\u3092\u542b\u3081\u3066\u5f15\u7528\u3059\u308b\u306e\u304c\u7279\u5fb4\n\t* \u30ea\u30f3\u30af\u3092\u53cd\u6620\u3067\u304d\u308b\n* Thanks: <a href=\"http://www.toshiya240.com/2012/07/web-html.html\" target=\"_blank\">Happy-Go-Lucky: Web\u30da\u30fc\u30b8\u3092 HTML \u306e\u307e\u307e\u5f15\u7528\u3059\u308b\u30d6\u30c3\u30af\u30de\u30fc\u30af\u30ec\u30c3\u30c8</a>\n\n\n```applescript:blockquote.scpt\ntell application \"Safari\"\n\ttell current tab of window 1\n\t\tdo JavaScript \"var htmlText = '';\nif (document.selection) {\n\tvar c = document.selection.createRange();\n\thtmlText = c.htmlText;\n} else {\n\tvar nNd = document.createElement(\\\"div\\\");\n\tvar sel = getSelection();\n\tif (sel == null || sel == '') {\n\t\thtmlText = '';\n\t} else {\n\t\tvar w = getSelection().getRangeAt(0).cloneContents();\n\t\tnNd.appendChild(w);\n\t\thtmlText = nNd.innerHTML;\n\t}\n}\n'<blockquote cite=\\\"' + location.href + '\\\" title=\\\"' + document.title + '\\\">\\\\n' + htmlText + '\\\\n' + '<cite><a href=\\\"' + location.href + '\\\" target=\\\"_blank\\\">' + document.title + '</a></cite>\\\\n' + '</blockquote>\\\\n';\"\n\tend tell\nend tell\n```\n\n\n\n## \u66f4\u65b0\u5c65\u6b74\n\n* 2012-10-31: Google Chrome\u7248\u3068\u3057\u3066\u4f5c\u6210\n* 2015-12-25: Safari\u7248\u306b\u4fee\u6b63\n"}