{"context": " More than 1 year has passed since last update.http://qiita.com/items/660eac769fa1a82fbf42 \u3068\nhttp://qiita.com/items/a7a1f51726ea2cb2e274 \u306e\u7d9a\u304d\u3002\n\u4ee5\u964d\u3001\u95a2\u6570\u547c\u3073\u51fa\u3057\u6642\u306e\u30d7\u30ed\u30df\u30b9\uff0b\u9045\u5ef6\u8a55\u4fa1\u3067\u306f\u307e\u308a\u304c\u3061\u306a\u3068\u3053\u308d\u3002\n\u4eca\u56de\u306fsubstitute\u3067\u3059\u3002\n\nsubstitute\u3068\u306f\u3002\n\u3088\u304f\u300c\u95a2\u6570\u547c\u3073\u51fa\u3057\u6642\u306e\u5f15\u6570\u304c\u3069\u3093\u306a\u3060\u3063\u305f\u304b\u77e5\u308b\u306b\u306fsubstitute\u3092\u4f7f\u3048\u3070\u3044\u3044\u300d\u3068\u3044\u3046\u8a71\u3092\u805e\u304d\u307e\u3059\u3002\n> f <- function(a) {\n+   print(substitute(a))\n+ }\n> \n> f(1)\n[1] 1\n> f(x+y)\nx + y\n> f(for (i in 1:3) {print(i)})\nfor (i in 1:3) {\n    print(i)\n}\n\n\u306f\u3044\u3002\u3053\u308c\u306f\u4f8b\u3048\u3070plot\u3067\u5f15\u6570\u3092label\u3067\u8868\u793a\u3059\u308b\u3068\u304d\u3068\u304b\u306b\u4f7f\u308f\u308c\u307e\u3059\u3002\u9045\u5ef6\u8a55\u4fa1\u306e\u5f37\u307f\u3067\u3059\u306d\u3002\n\u3068\u3053\u308d\u3067substitute\u306e\u672c\u5f53\u306e\u6a5f\u80fd\u3068\u3044\u3046\u306e\u306f\u3001\u3053\u308c\u5927\u4e8b\u306a\u3068\u3053\u306a\u306e\u3067?substitute\u304b\u3089\u629c\u7c8b\u3057\u3066\u304a\u304d\u307e\u3059\u304c\u3001\n\nsubstitute returns the parse tree for the (unevaluated) expression expr, substituting any variables bound in env.\n\n\u548c\u8a33\u3059\u308b\u3068\u3001\u300csubstitute\u306f\u3001env\u3067\u675f\u7e1b\u3055\u308c\u305f\u5909\u6570\u3092\u7f6e\u63db\u3057\u3064\u3064\u3001\uff08\u672a\u8a55\u4fa1\u306e\uff09\u5f0fexpr\u306b\u5bfe\u3059\u308b\u69cb\u6587\u6728\u3092\u8fd4\u3059\u300d\u3001\u3068\u3002\n\nsubstitute\u306f\u7f6e\u63db\u3059\u308b\n\u8981\u3059\u308b\u306b\u3001substitute\u306f\u5f0f\u3092\u306a\u3093\u3068\u306a\u304f\u7f6e\u63db\u3059\u308b\u95a2\u6570\u3060\u3001\u3068\u3044\u3046\u3053\u3068\u3067\u3059\u3002\n\u3069\u3046\u3084\u3063\u3066\u7f6e\u63db\u3059\u308b\u304b\u3068\u3044\u3046\u3068\u3001\n\nSubstitution takes place by examining each component of the parse tree as follows: If it is not a bound symbol in env, it is unchanged. If it is a promise object, i.e., a formal argument to a function or explicitly created using delayedAssign(), the expression slot of the promise replaces the symbol. If it is an ordinary variable, its value is substituted, unless env is .GlobalEnv in which case the symbol is left unchanged.\n\n\u300csubstitution\uff08\u7f6e\u63db\uff09\u306f\u69cb\u6587\u6728\u306e\u5404\u8981\u7d20\u3092\u4ee5\u4e0b\u306e\u901a\u308a\u306b\u7cbe\u67fb\u3059\u308b\uff1a\u3082\u3057env\u306b\u675f\u7e1b\u3055\u308c\u305f\u30b7\u30f3\u30dc\u30eb\u3058\u3083\u306a\u3051\u308c\u3070\u305d\u306e\u307e\u307e\u3002\u3082\u3057\u95a2\u6570\u306e\u4eee\u5f15\u6570\u3060\u3063\u305f\u308adelayedAssing()\u3067\u3064\u304f\u3089\u308c\u305f\u308a\u3057\u305f\u30d7\u30ed\u30df\u30b9\u306a\u3089\u3001\u30b7\u30f3\u30d6\u30eb\u306f\u30d7\u30ed\u30df\u30b9\u306e\u5f0f\u3067\u7f6e\u63db\u3055\u308c\u308b\u3002\u666e\u901a\u306e\u5909\u6570\u306a\u3089\u3001\u5024\u306b\u7f6e\u63db\u3055\u308c\u308b\u3002\u305f\u3060\u3057 env \u304c .GlobalEnv \u306e\u6642\u306b\u306f\u30b7\u30f3\u30dc\u30eb\u306f\u7f6e\u63db\u3055\u308c\u306a\u3044\u300d\u3068\u3002\n\u3067\u3001env\u306e\u30c7\u30d5\u30a9\u30eb\u30c8\u306f\u73fe\u5728\u306e\u74b0\u5883\u306a\u306e\u3067\u3001\n> delayedAssign(\"x\", {a+b}) # \u30c8\u30c3\u30d7\u30ec\u30d9\u30eb\u3067\u30d7\u30ed\u30df\u30b9\u4f5c\u6210\n> print(substitute(x)) # \u30d7\u30ed\u30df\u30b9\u306e\u5f0f\u5e30\u3063\u3066\u3053\u306a\u3044\u30fb\u30fb\u30fb\nx\n> \n> f <- function() { # \u95a2\u6570\u306e\u4e2d\u3067\n+   delayedAssign(\"x\", {a+b}) # \u5168\u304f\u540c\u3058\u3053\u3068\u3092\u884c\u3046\u3068\u30fb\u30fb\u30fb\n+   print(substitute(x))\n+ }\n> f() # \u3061\u3083\u3093\u3068\u5f0f\u5e30\u3063\u3066\u304f\u308b\n{\n    a + b\n}\n\n\u3053\u308c\u3092\u77e5\u3089\u306a\u304b\u3063\u305f\u9593\u306f\u3001\u6b63\u76f4substitute\u306e\u6319\u52d5\u304c\u8b0e\u3059\u304e\u3066\u610f\u5473\u308f\u304b\u308a\u307e\u305b\u3093\u3067\u3057\u305f\u3002\n\u3088\u304f\u4f7f\u308f\u308c\u308b\u300csubstitute\u3067\u95a2\u6570\u3078\u306e\u5f15\u6570\u3092\u77e5\u308b\u300d\u3063\u3066\u3044\u3046\u306e\u306f\u3001substitute\u306e\u4e2d\u306e\u307b\u3093\u306e\u4e00\u90e8\u306e\u6a5f\u80fd\u3060\u3068\u3044\u3046\u3053\u3068\u3067\u3059\u3002\u3063\u3066\u3044\u3046\u304b\u3001\u3053\u306e\u95a2\u6570\u304a\u304b\u3057\u3059\u304e\u3060\u308d\u3002\n\nsubstitute\u306e\u7f6e\u63db\u306f\u30ec\u30ad\u30b7\u30ab\u30eb\nsubstitute\u306f\u5168\u304f\u8a55\u4fa1\u3092\u884c\u308f\u306a\u3044\u306e\u3067\u3001\u6587\u6cd5\u7684\u306b\u8aa4\u3063\u305f\u5f0f\u306f\u30a8\u30e9\u30fc\u3067\u3059\u304c\u3001\n\u51fa\u6765\u4e0a\u304c\u3063\u305f\u69cb\u6587\u6728\u304c\u6b63\u3057\u304f\u8a55\u4fa1\u3055\u308c\u308b\u304b\u3069\u3046\u304b\u306f\u77e5\u308a\u307e\u305b\u3093\u3002\n> f <- function() {\n+   delayedAssign(\"x\", a+b)\n+   z <- 2\n+   print(substitute(x <- z))\n+ }\n> f()\na + b <- 2 # \u6587\u6cd5\u7684\u306b\u306f\u6b63\u3057\u3044\u3093\u3060\u3051\u3069\u3001\u3053\u308c\u306f\u30c0\u30e1\u3002\n\n\u8ab0\u304b\u3001substitute\u304c\u3053\u3046\u306a\u3063\u305f\u6b74\u53f2\u306b\u3064\u3044\u3066\u77e5\u3063\u3066\u305f\u3089\u6559\u3048\u3066\u4e0b\u3055\u3044\u3002\n\n\u74b0\u5883\u3058\u3083\u306a\u304f\u3066\u30ea\u30b9\u30c8\u3067OK\n> z <- list(a = 1, b = 2)\n> substitute(a + b, z) # \u30ea\u30b9\u30c8\u306b\u675f\u7e1b\u3055\u308c\u305f\u5024\u3067\u7f6e\u63db\u3002\u305f\u3060\u3057\u8a55\u4fa1\u306f\u3055\u308c\u306a\u3044\u3002\n1 + 2\n\n\nplotmath\u306b\u304a\u3051\u308bsubstitute\n\u3060\u3093\u3060\u3093\u30d7\u30ed\u30df\u30b9\u3068\u95a2\u4fc2\u306a\u304f\u306a\u3063\u3066\u6765\u307e\u3057\u305f\u304c\u3002\u30e6\u30fc\u30b6\u30ec\u30d9\u30eb\u3067substitute\u3092\u4f7f\u3046\u306e\u306f\u3082\u3057\u304b\u3057\u305f\u3089\u30b0\u30e9\u30d5\u306b\u6570\u5f0f\u3092\uff08\u52d5\u7684\u306b\uff09\u66f8\u304d\u305f\u3044\u6642\u3001\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u3002\u3053\u308c\u3082\u4e0a\u306esubstitute\u306e\u57fa\u672c\u3092\u77e5\u3063\u3068\u3051\u3070\u6050\u308c\u308b\u3053\u3068\u306f\u3042\u308a\u307e\u305b\u3093\u3002\nplotmath\u306e\u4f8b\u304b\u3089\uff1a\n> plot(1:10, type=\"n\", xlab=\"\", ylab=\"\", main = \"plot math & numbers\") # plot\n> theta <- 1.23\n> mtext(bquote(hat(theta) == .(theta)), line= .25) # bquote\u306fsubstitute\u306e\u30b7\u30f3\u30bf\u30c3\u30af\u30b9\u30b7\u30e5\u30ac\u30fc\n> for(i in 2:9)\n+     text(i,i+1, substitute(list(xi,eta) == group(\"(\",list(x,y),\")\"), # *1\n+                            list(x=i, y=i+1))) # *2\n\n*1 \u306e\u4e2d\u306ex\u306f*2\u306ei\u3067\u3001y\u304c*2\u306ei+1\u3067\u7f6e\u63db\u3055\u308c\u308b\u3001\u3068\u3044\u3046\u3060\u3051\u306e\u8a71\u3067\u3059\u3002\nsubstitute\u306e\u5f15\u6570env\u306f\u8a55\u4fa1\u3055\u308c\u308b\u306e\u3067\u3001\u6700\u521d\u306fx\u304c2\u3001y\u304c3\u3001\u6700\u5f8c\u306fx\u304c9\u3001y\u304c10\u3068\u306a\u308a\u307e\u3059\u3002\n\nhttp://qiita.com/items/660eac769fa1a82fbf42 \u3068\nhttp://qiita.com/items/a7a1f51726ea2cb2e274 \u306e\u7d9a\u304d\u3002\n\n\u4ee5\u964d\u3001\u95a2\u6570\u547c\u3073\u51fa\u3057\u6642\u306e\u30d7\u30ed\u30df\u30b9\uff0b\u9045\u5ef6\u8a55\u4fa1\u3067\u306f\u307e\u308a\u304c\u3061\u306a\u3068\u3053\u308d\u3002\n\n\u4eca\u56de\u306fsubstitute\u3067\u3059\u3002\n\n## substitute\u3068\u306f\u3002\n\n\u3088\u304f\u300c\u95a2\u6570\u547c\u3073\u51fa\u3057\u6642\u306e\u5f15\u6570\u304c\u3069\u3093\u306a\u3060\u3063\u305f\u304b\u77e5\u308b\u306b\u306f`substitute`\u3092\u4f7f\u3048\u3070\u3044\u3044\u300d\u3068\u3044\u3046\u8a71\u3092\u805e\u304d\u307e\u3059\u3002\n\n```R\n> f <- function(a) {\n+ \tprint(substitute(a))\n+ }\n> \n> f(1)\n[1] 1\n> f(x+y)\nx + y\n> f(for (i in 1:3) {print(i)})\nfor (i in 1:3) {\n    print(i)\n}\n```\n\n\u306f\u3044\u3002\u3053\u308c\u306f\u4f8b\u3048\u3070plot\u3067\u5f15\u6570\u3092label\u3067\u8868\u793a\u3059\u308b\u3068\u304d\u3068\u304b\u306b\u4f7f\u308f\u308c\u307e\u3059\u3002\u9045\u5ef6\u8a55\u4fa1\u306e\u5f37\u307f\u3067\u3059\u306d\u3002\n\n\u3068\u3053\u308d\u3067`substitute`\u306e\u672c\u5f53\u306e\u6a5f\u80fd\u3068\u3044\u3046\u306e\u306f\u3001\u3053\u308c\u5927\u4e8b\u306a\u3068\u3053\u306a\u306e\u3067?substitute\u304b\u3089\u629c\u7c8b\u3057\u3066\u304a\u304d\u307e\u3059\u304c\u3001\n\n>`substitute` returns the parse tree for the (unevaluated) expression `expr`, substituting any variables bound in `env`.\n\n\u548c\u8a33\u3059\u308b\u3068\u3001\u300c`substitute`\u306f\u3001`env`\u3067\u675f\u7e1b\u3055\u308c\u305f\u5909\u6570\u3092\u7f6e\u63db\u3057\u3064\u3064\u3001\uff08\u672a\u8a55\u4fa1\u306e\uff09\u5f0f`expr`\u306b\u5bfe\u3059\u308b\u69cb\u6587\u6728\u3092\u8fd4\u3059\u300d\u3001\u3068\u3002\n\n# substitute\u306f\u7f6e\u63db\u3059\u308b\n\n\u8981\u3059\u308b\u306b\u3001substitute\u306f\u5f0f\u3092\u306a\u3093\u3068\u306a\u304f\u7f6e\u63db\u3059\u308b\u95a2\u6570\u3060\u3001\u3068\u3044\u3046\u3053\u3068\u3067\u3059\u3002\n\u3069\u3046\u3084\u3063\u3066\u7f6e\u63db\u3059\u308b\u304b\u3068\u3044\u3046\u3068\u3001\n\n>Substitution takes place by examining each component of the parse tree as follows: If it is not a bound symbol in env, it is unchanged. If it is a promise object, i.e., a formal argument to a function or explicitly created using delayedAssign(), the expression slot of the promise replaces the symbol. If it is an ordinary variable, its value is substituted, unless env is .GlobalEnv in which case the symbol is left unchanged.\n\n\u300csubstitution\uff08\u7f6e\u63db\uff09\u306f\u69cb\u6587\u6728\u306e\u5404\u8981\u7d20\u3092\u4ee5\u4e0b\u306e\u901a\u308a\u306b\u7cbe\u67fb\u3059\u308b\uff1a\u3082\u3057`env`\u306b\u675f\u7e1b\u3055\u308c\u305f\u30b7\u30f3\u30dc\u30eb\u3058\u3083\u306a\u3051\u308c\u3070\u305d\u306e\u307e\u307e\u3002\u3082\u3057\u95a2\u6570\u306e\u4eee\u5f15\u6570\u3060\u3063\u305f\u308a`delayedAssing()`\u3067\u3064\u304f\u3089\u308c\u305f\u308a\u3057\u305f\u30d7\u30ed\u30df\u30b9\u306a\u3089\u3001\u30b7\u30f3\u30d6\u30eb\u306f\u30d7\u30ed\u30df\u30b9\u306e\u5f0f\u3067\u7f6e\u63db\u3055\u308c\u308b\u3002\u666e\u901a\u306e\u5909\u6570\u306a\u3089\u3001\u5024\u306b\u7f6e\u63db\u3055\u308c\u308b\u3002**\u305f\u3060\u3057** `env` \u304c `.GlobalEnv` \u306e\u6642\u306b\u306f\u30b7\u30f3\u30dc\u30eb\u306f\u7f6e\u63db\u3055\u308c\u306a\u3044\u300d\u3068\u3002\n\n\u3067\u3001`env`\u306e\u30c7\u30d5\u30a9\u30eb\u30c8\u306f\u73fe\u5728\u306e\u74b0\u5883\u306a\u306e\u3067\u3001\n\n```R\n> delayedAssign(\"x\", {a+b}) # \u30c8\u30c3\u30d7\u30ec\u30d9\u30eb\u3067\u30d7\u30ed\u30df\u30b9\u4f5c\u6210\n> print(substitute(x)) # \u30d7\u30ed\u30df\u30b9\u306e\u5f0f\u5e30\u3063\u3066\u3053\u306a\u3044\u30fb\u30fb\u30fb\nx\n> \n> f <- function() { # \u95a2\u6570\u306e\u4e2d\u3067\n+   delayedAssign(\"x\", {a+b}) # \u5168\u304f\u540c\u3058\u3053\u3068\u3092\u884c\u3046\u3068\u30fb\u30fb\u30fb\n+   print(substitute(x))\n+ }\n> f() # \u3061\u3083\u3093\u3068\u5f0f\u5e30\u3063\u3066\u304f\u308b\n{\n    a + b\n}\n```\n\n\u3053\u308c\u3092\u77e5\u3089\u306a\u304b\u3063\u305f\u9593\u306f\u3001\u6b63\u76f4`substitute`\u306e\u6319\u52d5\u304c\u8b0e\u3059\u304e\u3066\u610f\u5473\u308f\u304b\u308a\u307e\u305b\u3093\u3067\u3057\u305f\u3002\n\n\u3088\u304f\u4f7f\u308f\u308c\u308b\u300c`substitute`\u3067\u95a2\u6570\u3078\u306e\u5f15\u6570\u3092\u77e5\u308b\u300d\u3063\u3066\u3044\u3046\u306e\u306f\u3001substitute\u306e\u4e2d\u306e\u307b\u3093\u306e\u4e00\u90e8\u306e\u6a5f\u80fd\u3060\u3068\u3044\u3046\u3053\u3068\u3067\u3059\u3002\u3063\u3066\u3044\u3046\u304b\u3001\u3053\u306e\u95a2\u6570\u304a\u304b\u3057\u3059\u304e\u3060\u308d\u3002\n\n## substitute\u306e\u7f6e\u63db\u306f\u30ec\u30ad\u30b7\u30ab\u30eb\n\nsubstitute\u306f\u5168\u304f\u8a55\u4fa1\u3092\u884c\u308f\u306a\u3044\u306e\u3067\u3001\u6587\u6cd5\u7684\u306b\u8aa4\u3063\u305f\u5f0f\u306f\u30a8\u30e9\u30fc\u3067\u3059\u304c\u3001\n\u51fa\u6765\u4e0a\u304c\u3063\u305f\u69cb\u6587\u6728\u304c\u6b63\u3057\u304f\u8a55\u4fa1\u3055\u308c\u308b\u304b\u3069\u3046\u304b\u306f\u77e5\u308a\u307e\u305b\u3093\u3002\n\n```R\n> f <- function() {\n+   delayedAssign(\"x\", a+b)\n+   z <- 2\n+   print(substitute(x <- z))\n+ }\n> f()\na + b <- 2 # \u6587\u6cd5\u7684\u306b\u306f\u6b63\u3057\u3044\u3093\u3060\u3051\u3069\u3001\u3053\u308c\u306f\u30c0\u30e1\u3002\n```\n\n\u8ab0\u304b\u3001substitute\u304c\u3053\u3046\u306a\u3063\u305f\u6b74\u53f2\u306b\u3064\u3044\u3066\u77e5\u3063\u3066\u305f\u3089\u6559\u3048\u3066\u4e0b\u3055\u3044\u3002\n\n## \u74b0\u5883\u3058\u3083\u306a\u304f\u3066\u30ea\u30b9\u30c8\u3067OK\n\n```R\n> z <- list(a = 1, b = 2)\n> substitute(a + b, z) # \u30ea\u30b9\u30c8\u306b\u675f\u7e1b\u3055\u308c\u305f\u5024\u3067\u7f6e\u63db\u3002\u305f\u3060\u3057\u8a55\u4fa1\u306f\u3055\u308c\u306a\u3044\u3002\n1 + 2\n```\n\n## plotmath\u306b\u304a\u3051\u308bsubstitute\n\n\u3060\u3093\u3060\u3093\u30d7\u30ed\u30df\u30b9\u3068\u95a2\u4fc2\u306a\u304f\u306a\u3063\u3066\u6765\u307e\u3057\u305f\u304c\u3002\u30e6\u30fc\u30b6\u30ec\u30d9\u30eb\u3067substitute\u3092\u4f7f\u3046\u306e\u306f\u3082\u3057\u304b\u3057\u305f\u3089\u30b0\u30e9\u30d5\u306b\u6570\u5f0f\u3092\uff08\u52d5\u7684\u306b\uff09\u66f8\u304d\u305f\u3044\u6642\u3001\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u3002\u3053\u308c\u3082\u4e0a\u306esubstitute\u306e\u57fa\u672c\u3092\u77e5\u3063\u3068\u3051\u3070\u6050\u308c\u308b\u3053\u3068\u306f\u3042\u308a\u307e\u305b\u3093\u3002\n\n`plotmath`\u306e\u4f8b\u304b\u3089\uff1a\n\n```R\n> plot(1:10, type=\"n\", xlab=\"\", ylab=\"\", main = \"plot math & numbers\") # plot\n> theta <- 1.23\n> mtext(bquote(hat(theta) == .(theta)), line= .25) # bquote\u306fsubstitute\u306e\u30b7\u30f3\u30bf\u30c3\u30af\u30b9\u30b7\u30e5\u30ac\u30fc\n> for(i in 2:9)\n+     text(i,i+1, substitute(list(xi,eta) == group(\"(\",list(x,y),\")\"), # *1\n+                            list(x=i, y=i+1))) # *2\n```\n\n*1 \u306e\u4e2d\u306ex\u306f*2\u306ei\u3067\u3001y\u304c*2\u306ei+1\u3067\u7f6e\u63db\u3055\u308c\u308b\u3001\u3068\u3044\u3046\u3060\u3051\u306e\u8a71\u3067\u3059\u3002\n`substitute`\u306e\u5f15\u6570`env`\u306f\u8a55\u4fa1\u3055\u308c\u308b\u306e\u3067\u3001\u6700\u521d\u306fx\u304c2\u3001y\u304c3\u3001\u6700\u5f8c\u306fx\u304c9\u3001y\u304c10\u3068\u306a\u308a\u307e\u3059\u3002\n\n\n\n\n\n", "tags": ["R", "promise"]}