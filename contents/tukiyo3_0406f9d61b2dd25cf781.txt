{"tags": ["sqlite", "shell"], "context": "\n\n\u4f7f\u3044\u65b9\n\n\u30d8\u30eb\u30d7\n$ ./sqlite.sh -h\n2016.sqlite3\u306b\u4fdd\u5b58\u3055\u308c\u307e\u3059\u3002\u30c6\u30fc\u30d6\u30eb\u540d\u306f records\u3002\n  * \u633f\u5165:      \u30b3\u30de\u30f3\u30c9 | ./sqlite.sh\n  * \u53c2\u7167:      ./sqlite.sh limit\u5024\n  * \u633f\u5165&\u53c2\u7167: \u30b3\u30de\u30f3\u30c9 | ./sqlite.sh limit\u5024\n\n\n\ndate\u306e\u7d50\u679c\u3092\u4fdd\u5b58\ndate | ./sqlite.sh\ndate | ./sqlite.sh\n\n\n\n\u76f4\u8fd1\u306e1\u4ef6\u53d6\u5f97\n$ ./sqlite.sh 1\n2|2016-06-18 17:53:32|2016\u5e74  6\u6708 18\u65e5 \u571f\u66dc\u65e5 17:53:32 JST\n\n\n\n\u76f4\u8fd1\u306e2\u4ef6\u53d6\u5f97\n$ ./sqlite.sh 2\n2|2016-06-18 17:53:32|2016\u5e74  6\u6708 18\u65e5 \u571f\u66dc\u65e5 17:53:32 JST\n1|2016-06-18 17:43:12|2016\u5e74  6\u6708 18\u65e5 \u571f\u66dc\u65e5 17:43:12 JST\n\n\n\n\u4fdd\u5b58\u5f8c\u3001\u7d50\u679c\u3092\u8868\u793a\n$ w | ./sqlite.sh 1\n3|2016-06-18 17:58:27| 17:57:23 up 1 day, 12:52,  3 users,  load average: 0.36, 0.29, 0.31\nUSER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT\nuser01  tty7     :0               \u91d105   36:56m 11:57   3.86s /usr/bin/lxsession -s Lubuntu -e LXDE\nuser01  pts/2    :0.0             14:18    3:38m  0.29s  0.00s sh /home/user01/hoge.sh\nuser01  pts/4    :0.0             14:26    3.00s  3.30s 16.74s xfce4-terminal\n\n\n\n\u30bd\u30fc\u30b9\n\nsqlite.sh\n#!/bin/sh\nset -eu\nY=`date \"+%Y\"`\nDB=\"${Y}.sqlite3\"\nTABLENAME=\"records\"\n#----------------------------------------------------------------\nhelp() {\n   echo \"${DB}\u306b\u4fdd\u5b58\u3055\u308c\u307e\u3059\u3002\u30c6\u30fc\u30d6\u30eb\u540d\u306f ${TABLENAME}\u3002\"\n   echo \"  * \u633f\u5165:      \u30b3\u30de\u30f3\u30c9 | $0\"\n   echo \"  * \u53c2\u7167:      $0 limit\u5024\"\n   echo \"  * \u633f\u5165&\u53c2\u7167: \u30b3\u30de\u30f3\u30c9 | $0 limit\u5024\"\n   exit 1\n}\ncreate_table() {\n    sqlite3 $DB << EOL\ncreate table ${TABLENAME} (\n    id integer primary key autoincrement\n    ,t timestamp DATE DEFAULT (datetime('now','localtime'))\n    ,data text\n);\nEOL\n}\nsql() { echo \"$@\" | sqlite3 $DB; }\nshow() { echo \".show\" | sqlite3 $DB; }\nschema() { echo \".schema $1\" | sqlite3 $DB; }\ninsert() { echo \"INSERT INTO ${TABLENAME} (data) VALUES ('$@');\" | sqlite3 $DB; }\n#----------------------------------------------------------------\n## \u30d8\u30eb\u30d7\nif [ $# -eq 1 ];then\n    if [ ${1} = \"-h\" ];then\n        help\n    fi\nfi\n## DB\u4f5c\u6210\nif [ ! -e \"${DB}\" ];then\n    create_table\n    schema ${TABLENAME}\nfi\n## \u30b3\u30de\u30f3\u30c9\u7d50\u679c\u306e\u4fdd\u5b58\n# -0\u3092\u4ed8\u3051\u306a\u3044\u3068\u6539\u884c\u304c\u6d88\u30481\u884c\u306b\u306a\u308b\u305f\u3081\u3002\nif [ -p /dev/stdin ]; then\n    insert \"`xargs -0 echo $@`\"\nfi\n## \u30b3\u30de\u30f3\u30c9\u7d50\u679c\u306e\u51fa\u529b\nif [ $# -eq 1 ];then\n    # 0<=$1 && $1<=100\n    if [ 1 -le ${1} -a ${1} -le 100 ];then\n        sql \"select * from ${TABLENAME} order by id desc limit ${1};\"\n        exit 0\n    fi\nfi\n#----------------------------------------------------------------\n\n\n\nMIT\n\n## \u4f7f\u3044\u65b9\n\n```bash:\u30d8\u30eb\u30d7\n$ ./sqlite.sh -h\n2016.sqlite3\u306b\u4fdd\u5b58\u3055\u308c\u307e\u3059\u3002\u30c6\u30fc\u30d6\u30eb\u540d\u306f records\u3002\n  * \u633f\u5165:      \u30b3\u30de\u30f3\u30c9 | ./sqlite.sh\n  * \u53c2\u7167:      ./sqlite.sh limit\u5024\n  * \u633f\u5165&\u53c2\u7167: \u30b3\u30de\u30f3\u30c9 | ./sqlite.sh limit\u5024\n```\n\n```bash:date\u306e\u7d50\u679c\u3092\u4fdd\u5b58\ndate | ./sqlite.sh\ndate | ./sqlite.sh\n```\n\n```bash:\u76f4\u8fd1\u306e1\u4ef6\u53d6\u5f97\n$ ./sqlite.sh 1\n2|2016-06-18 17:53:32|2016\u5e74  6\u6708 18\u65e5 \u571f\u66dc\u65e5 17:53:32 JST\n```\n\n```bash:\u76f4\u8fd1\u306e2\u4ef6\u53d6\u5f97\n$ ./sqlite.sh 2\n2|2016-06-18 17:53:32|2016\u5e74  6\u6708 18\u65e5 \u571f\u66dc\u65e5 17:53:32 JST\n1|2016-06-18 17:43:12|2016\u5e74  6\u6708 18\u65e5 \u571f\u66dc\u65e5 17:43:12 JST\n```\n\n```bash:\u4fdd\u5b58\u5f8c\u3001\u7d50\u679c\u3092\u8868\u793a\n$ w | ./sqlite.sh 1\n3|2016-06-18 17:58:27| 17:57:23 up 1 day, 12:52,  3 users,  load average: 0.36, 0.29, 0.31\nUSER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT\nuser01  tty7     :0               \u91d105   36:56m 11:57   3.86s /usr/bin/lxsession -s Lubuntu -e LXDE\nuser01  pts/2    :0.0             14:18    3:38m  0.29s  0.00s sh /home/user01/hoge.sh\nuser01  pts/4    :0.0             14:26    3.00s  3.30s 16.74s xfce4-terminal\n```\n\n## \u30bd\u30fc\u30b9\n\n```rb:sqlite.sh\n#!/bin/sh\nset -eu\nY=`date \"+%Y\"`\nDB=\"${Y}.sqlite3\"\nTABLENAME=\"records\"\n#----------------------------------------------------------------\nhelp() {\n   echo \"${DB}\u306b\u4fdd\u5b58\u3055\u308c\u307e\u3059\u3002\u30c6\u30fc\u30d6\u30eb\u540d\u306f ${TABLENAME}\u3002\"\n   echo \"  * \u633f\u5165:      \u30b3\u30de\u30f3\u30c9 | $0\"\n   echo \"  * \u53c2\u7167:      $0 limit\u5024\"\n   echo \"  * \u633f\u5165&\u53c2\u7167: \u30b3\u30de\u30f3\u30c9 | $0 limit\u5024\"\n   exit 1\n}\ncreate_table() {\n    sqlite3 $DB << EOL\ncreate table ${TABLENAME} (\n    id integer primary key autoincrement\n    ,t timestamp DATE DEFAULT (datetime('now','localtime'))\n    ,data text\n);\nEOL\n}\nsql() { echo \"$@\" | sqlite3 $DB; }\nshow() { echo \".show\" | sqlite3 $DB; }\nschema() { echo \".schema $1\" | sqlite3 $DB; }\ninsert() { echo \"INSERT INTO ${TABLENAME} (data) VALUES ('$@');\" | sqlite3 $DB; }\n#----------------------------------------------------------------\n## \u30d8\u30eb\u30d7\nif [ $# -eq 1 ];then\n    if [ ${1} = \"-h\" ];then\n        help\n    fi\nfi\n## DB\u4f5c\u6210\nif [ ! -e \"${DB}\" ];then\n    create_table\n    schema ${TABLENAME}\nfi\n## \u30b3\u30de\u30f3\u30c9\u7d50\u679c\u306e\u4fdd\u5b58\n# -0\u3092\u4ed8\u3051\u306a\u3044\u3068\u6539\u884c\u304c\u6d88\u30481\u884c\u306b\u306a\u308b\u305f\u3081\u3002\nif [ -p /dev/stdin ]; then\n    insert \"`xargs -0 echo $@`\"\nfi\n## \u30b3\u30de\u30f3\u30c9\u7d50\u679c\u306e\u51fa\u529b\nif [ $# -eq 1 ];then\n    # 0<=$1 && $1<=100\n    if [ 1 -le ${1} -a ${1} -le 100 ];then\n        sql \"select * from ${TABLENAME} order by id desc limit ${1};\"\n        exit 0\n    fi\nfi\n#----------------------------------------------------------------\n````\n\n* MIT\n"}