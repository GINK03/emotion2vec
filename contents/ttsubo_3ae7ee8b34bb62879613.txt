{"context": " More than 1 year has passed since last update.\u524d\u56de\u306eApache Kafka\u8a18\u4e8b\u306e\u3064\u3065\u304d\u3067\u3059\u3002\u4eca\u56de\u306f\u3001Kafka\u30af\u30e9\u30b9\u30bf\u69cb\u6210\u3092\u78ba\u8a8d\u3057\u3066\u307f\u307e\u3059\u3002\n\n\u25fc\ufe0e \u4eca\u56de\u3001\u8a66\u3057\u3066\u307f\u308b Kafka\u30af\u30e9\u30b9\u30bf\u69cb\u6210\nKafka\u30af\u30e9\u30b9\u30bf\u306f\u3001\u3064\u304e\u306e\u3088\u3046\u306a\u69cb\u6210\u3068\u3057\u307e\u3057\u305f\u3002\n\nMac OS X\u74b0\u5883\uff12\u53f0\u3067\u3001\u30af\u30e9\u30b9\u30bf\u69cb\u6210\u3092\u69cb\u7bc9\u3059\u308b\nProducer\u5074\u306f\u3001\u72ec\u7acb\u3057\u305f\u30b5\u30fc\u30d0\u74b0\u5883\u3067\u52d5\u4f5c\u3055\u305b\u308b\nConsumer\u5074\u306f\u3001Kafka\u30af\u30e9\u30b9\u30bf\u306e\u30b5\u30fc\u30d0\u74b0\u5883\u306b\u540c\u5c45\u3055\u305b\u308b \nzookeeper\u306f\u3001192.168.100.201\u5074\u3092\u4f7f\u7528\u3059\u308b\nConsumer\u5074\u3067\u306f\u3001\u540c\u3058\u30bf\u30a4\u30df\u30f3\u30b0\u3067Producer\u5074\u306e\u9001\u4fe1\u30c7\u30fc\u30bf\u3092\u53d6\u5f97\u3059\u308b\n\n\n\u5b9f\u969b\u3001topic\"kafkaesque\"\u3092\u518d\u4f5c\u6210\u3057\u3066\u3001\u3064\u304e\u306e\u3088\u3046\u306aKafka\u30af\u30e9\u30b9\u30bf\u69cb\u6210\u3092\u69cb\u7bc9\u3057\u307e\u3059\u3002\n\ntopic\u4f5c\u6210\u6642\u306b\u3001\u30ec\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u6709\u52b9\u306b\u3059\u308b\n\u30d1\u30fc\u30c6\u30b7\u30e7\u30f3\u306f\u3001\uff11\u3064\u306e\u307f\u4f5c\u6210\u3059\u308b\n\n$ kafka-topics.sh --describe --zookeeper 192.168.100.201:2181 --topic kafkaesque\nTopic:kafkaesque    PartitionCount:1    ReplicationFactor:2 Configs:\n    Topic: kafkaesque   Partition: 0    Leader: 1   Replicas: 2,1   Isr: 1,2\n\n\u306a\u304a\u3001\u4eca\u56de\u3001\u4f7f\u7528\u3057\u305fkafka\u306e\u30bd\u30d5\u30c8\u30a6\u30a7\u30a2\u306f\u30010.8.2.1\u3068\u5c11\u3057\u53e4\u3081\u306e\u3082\u306e\u306b\u306a\u308a\u307e\u3059\u3002\n$ brew list kafka\n/usr/local/Cellar/kafka/0.8.2.1/bin/kafka-console-consumer.sh\n/usr/local/Cellar/kafka/0.8.2.1/bin/kafka-console-producer.sh\n/usr/local/Cellar/kafka/0.8.2.1/bin/kafka-consumer-offset-checker.sh\n/usr/local/Cellar/kafka/0.8.2.1/bin/kafka-consumer-perf-test.sh\n/usr/local/Cellar/kafka/0.8.2.1/bin/kafka-mirror-maker.sh\n/usr/local/Cellar/kafka/0.8.2.1/bin/kafka-preferred-replica-election.sh\n/usr/local/Cellar/kafka/0.8.2.1/bin/kafka-producer-perf-test.sh\n/usr/local/Cellar/kafka/0.8.2.1/bin/kafka-reassign-partitions.sh\n/usr/local/Cellar/kafka/0.8.2.1/bin/kafka-replay-log-producer.sh\n/usr/local/Cellar/kafka/0.8.2.1/bin/kafka-replica-verification.sh\n/usr/local/Cellar/kafka/0.8.2.1/bin/kafka-run-class.sh\n/usr/local/Cellar/kafka/0.8.2.1/bin/kafka-server-start.sh\n/usr/local/Cellar/kafka/0.8.2.1/bin/kafka-server-stop.sh\n/usr/local/Cellar/kafka/0.8.2.1/bin/kafka-simple-consumer-shell.sh\n/usr/local/Cellar/kafka/0.8.2.1/bin/kafka-topics.sh\n/usr/local/Cellar/kafka/0.8.2.1/bin/zookeeper-server-start.sh\n/usr/local/Cellar/kafka/0.8.2.1/bin/zookeeper-server-stop.sh\n/usr/local/Cellar/kafka/0.8.2.1/bin/zookeeper-shell.sh\n/usr/local/Cellar/kafka/0.8.2.1/homebrew.mxcl.kafka.plist\n/usr/local/Cellar/kafka/0.8.2.1/libexec/bin/ (18 files)\n/usr/local/Cellar/kafka/0.8.2.1/libexec/clients/ (390 files)\n/usr/local/Cellar/kafka/0.8.2.1/libexec/contrib/ (49 files)\n/usr/local/Cellar/kafka/0.8.2.1/libexec/core/ (3072 files)\n/usr/local/Cellar/kafka/0.8.2.1/libexec/examples/ (18 files)\n/usr/local/Cellar/kafka/0.8.2.1/libexec/logs/ (83 files)\n/usr/local/Cellar/kafka/0.8.2.1/libexec/system_test/ (247 files)\n\n\n\u25fc\ufe0e Kafka\u30af\u30e9\u30b9\u30bf\u52d5\u4f5c\u74b0\u5883\u3092\u3064\u304f\u308b\n\n\u524d\u56de\u3001\u4f5c\u6210\u306e topic\"kafkaesque\"\u3092\u524a\u9664\n\n$ kafka-topics.sh --delete  --zookeeper localhost:2181  --topic kafkaesque\n\n\nkafka\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u7de8\u96c6\n\n\n192.168.100.201\u5074\u30d1\u30e9\u30e1\u30fc\u30bf\u4f8b\n$ vi /usr/local/etc/kafka/server.properties\n------------------\nbroker.id=1\nport=9092\nhost.name=192.168.100.201\nzookeeper.connect=192.168.100.201:2181\ndelete.topic.enable=true\n\n\n\n192.168.100.202\u5074\u30d1\u30e9\u30e1\u30fc\u30bf\u4f8b\n$ vi /usr/local/etc/kafka/server.properties\n------------------\nbroker.id=2\nport=9092\nhost.name=192.168.100.202\nzookeeper.connect=192.168.100.201:2181\ndelete.topic.enable=true\n\n\n\nkafka\u3092\u8d77\u52d5\n\n$ kafka-server-start.sh /usr/local/etc/kafka/server.properties\n\n\ntopic: \"kafkaesque\"\u3092\u4f5c\u6210 & \u78ba\u8a8d\n\n$ kafka-topics.sh --create --zookeeper 192.168.100.201:2181 --replication-factor 2 --partitions 1 --topic kafkaesque\nCreated topic \"kafkaesque\".\n\n$ kafka-topics.sh --describe --zookeeper 192.168.100.201:2181 --topic kafkaesque\nTopic:kafkaesque    PartitionCount:1    ReplicationFactor:2 Configs:\n    Topic: kafkaesque   Partition: 0    Leader: 1   Replicas: 2,1   Isr: 1,2\n\n\nProducer\u5074\u30b5\u30f3\u30d7\u30eb\u30a2\u30d7\u30ea\u3092\u914d\u5099\uff08\u524d\u56de\u306ekafka_producer.py\u3092\u4fee\u6b63\u3057\u3066\u3001\u30d5\u30a7\u30a4\u30eb\u30aa\u30fc\u30d0\u306b\u5bfe\u5fdc\u3057\u307e\u3057\u305f\u3002\uff09\n\n\nkafka_producer.py\nfrom kafka.client import KafkaClient\nfrom kafka.producer import SimpleProducer\nfrom kafka.common import FailedPayloadsError\nfrom kafka.common import KafkaUnavailableError\nfrom time import sleep\nfrom datetime import datetime\n\nproducer = None\n\ntry:\n    kafka = KafkaClient(\"192.168.100.201:9092, 192.168.100.202:9092\")\n    producer = SimpleProducer(kafka)\nexcept KafkaUnavailableError as e:\n    print \"KafkaUnavailableError: [%s]\"% e\n\n\nwhile 1:\n    # \"kafkaesque\" is the name of our topic\n    if producer is None:\n        exit(1)\n    else:\n        try:\n            nowtime = str(datetime.now().time())\n            producer.send_messages(\"kafkaesque\", \"Metamorphosis! \" + nowtime)\n            print \"Metamorphosis! \" + nowtime\n        except FailedPayloadsError as e:\n            print \"FailedPayloadsError: [%s]\"% e\n            producer.client.close()\n            producer = SimpleProducer(kafka)\n        except KafkaUnavailableError as e:\n            print \"KafkaUnavailableError: [%s]\"% e\n            producer.client.close()\n            producer = None\n    sleep(1)\n\n\n\nConsumer\u5074\u30b5\u30f3\u30d7\u30eb\u30a2\u30d7\u30ea\u3092\u914d\u5099\uff08\u524d\u56de\u306ekafka_consumer.go\u3068\u540c\u3058\u30b5\u30f3\u30d7\u30eb\u30a2\u30d7\u30ea\u3092\u4f7f\u7528\u3057\u307e\u3059\u3002\uff09\nConsumer\u5074\u30b5\u30f3\u30d7\u30eb\u30a2\u30d7\u30ea\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\n\n\n192.168.100.201\u5074\u306econsumers.properties\n#Consumer identity\nclient_id=go-consumer1\ngroup_id=cs-rebalance-group1\nnum_consumers=1\ntopic=kafkaesque\nlog_level=warn\n\n#Zookeeper connection settings\nzookeeper_connect=192.168.100.201:2181\nzookeeper_timeout=1s\n...\n\n\n\n192.168.100.202\u5074\u306econsumers.properties\n#Consumer identity\nclient_id=go-consumer2\ngroup_id=cs-rebalance-group2\nnum_consumers=1\ntopic=kafkaesque\nlog_level=warn\n\n#Zookeeper connection settings\nzookeeper_connect=192.168.100.201:2181\nzookeeper_timeout=1s\n...\n\n\n\n\u25fc\ufe0e \u3055\u3063\u305d\u304f\u3001kafka\u30af\u30e9\u30b9\u30bf\u74b0\u5883\u3067\u52d5\u304b\u3057\u3066\u307f\u308b\n\u4eca\u56de\u3001Consumer\u5074\u306egroup_id\u306f\u3001\u5404\u3005\u3067\u7570\u306a\u308b\u5024\u3092\u8a2d\u5b9a\u3057\u307e\u3057\u305f\u3002\n\u3053\u308c\u306b\u3088\u3063\u3066\u3001Producer\u5074\u304b\u3089\u306e\u9001\u4fe1\u30c7\u30fc\u30bf\u304c\u540c\u5831\u7684\u306b\u53d6\u5f97\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u308b\u306f\u305a\u3067\u3059\u3002\n\n\u307e\u305a\u306f\u3001\u969c\u5bb3\u304c\u767a\u751f\u3057\u3066\u3044\u306a\u3044\u5834\u5408\u306eKafka\u30af\u30e9\u30b9\u30bf\u52d5\u4f5c\u3092\u78ba\u8a8d\u3057\u3066\u307f\u307e\u3057\u305f\u3002\n\n\n192.168.100.200\u306eProducer\u5074\u30b5\u30f3\u30d7\u30eb\u30a2\u30d7\u30ea\u8d77\u52d5\n$ python kafka_producer.py \nMetamorphosis! 20:29:17.478683\nMetamorphosis! 20:29:18.483005\nMetamorphosis! 20:29:19.487480\nMetamorphosis! 20:29:20.491742\nMetamorphosis! 20:29:21.496180\nMetamorphosis! 20:29:22.500724\nMetamorphosis! 20:29:23.505113\nMetamorphosis! 20:29:24.509501\nMetamorphosis! 20:29:25.513620\nMetamorphosis! 20:29:26.517824\nMetamorphosis! 20:29:27.522053\nMetamorphosis! 20:29:28.526435\nMetamorphosis! 20:29:29.530428\nMetamorphosis! 20:29:30.534616\n...\n\n\n\n192.168.100.201\u306eConsumer\u5074\u30b5\u30f3\u30d7\u30eb\u30a2\u30d7\u30ea\u8d77\u52d5\n$ go run kafka_consumer.go \n2016/01/10 20:28:32 Connected to 192.168.100.201:2181\n2016/01/10 20:28:32 Authenticated: id=95184864121651345, timeout=4000\nmsg.Value=[Metamorphosis! 20:29:17.478683]\nmsg.Value=[Metamorphosis! 20:29:18.483005]\nmsg.Value=[Metamorphosis! 20:29:19.487480]\nmsg.Value=[Metamorphosis! 20:29:20.491742]\nmsg.Value=[Metamorphosis! 20:29:21.496180]\nmsg.Value=[Metamorphosis! 20:29:22.500724]\nmsg.Value=[Metamorphosis! 20:29:23.505113]\nmsg.Value=[Metamorphosis! 20:29:24.509501]\nmsg.Value=[Metamorphosis! 20:29:25.513620]\nmsg.Value=[Metamorphosis! 20:29:26.517824]\nmsg.Value=[Metamorphosis! 20:29:27.522053]\nmsg.Value=[Metamorphosis! 20:29:28.526435]\nmsg.Value=[Metamorphosis! 20:29:29.530428]\nmsg.Value=[Metamorphosis! 20:29:30.534616]\n...\n\n\n\n192.168.100.202\u306eConsumer\u5074\u30b5\u30f3\u30d7\u30eb\u30a2\u30d7\u30ea\u8d77\u52d5\n$ go run kafka_consumer.go \nmsg.Value=[Metamorphosis! 20:29:17.478683]\nmsg.Value=[Metamorphosis! 20:29:18.483005]\nmsg.Value=[Metamorphosis! 20:29:19.487480]\nmsg.Value=[Metamorphosis! 20:29:20.491742]\nmsg.Value=[Metamorphosis! 20:29:21.496180]\nmsg.Value=[Metamorphosis! 20:29:22.500724]\nmsg.Value=[Metamorphosis! 20:29:23.505113]\nmsg.Value=[Metamorphosis! 20:29:24.509501]\nmsg.Value=[Metamorphosis! 20:29:25.513620]\nmsg.Value=[Metamorphosis! 20:29:26.517824]\nmsg.Value=[Metamorphosis! 20:29:27.522053]\nmsg.Value=[Metamorphosis! 20:29:28.526435]\nmsg.Value=[Metamorphosis! 20:29:29.530428]\nmsg.Value=[Metamorphosis! 20:29:30.534616]\n...\n\n\nProducer\u5074\u304b\u3089\u523b\u3005\u3068\u9001\u4fe1\u3055\u308c\u3066\u304f\u308b\u6642\u523b\u7b49\u306e\u30c7\u30fc\u30bf\u3092\u3001\u5404\u3005\u306eCousumer\u5074\u3067\u968f\u6642\u8868\u793a\u3055\u308c\u308b\u3053\u3068\u304c\u78ba\u8a8d\u3067\u304d\u307e\u3057\u305f\u3002\n\n\u6b21\u306b\u3001\u969c\u5bb3\u304c\u767a\u751f\u3057\u305f\u5834\u5408\u306eKafka\u30af\u30e9\u30b9\u30bf\u52d5\u4f5c\u3092\u78ba\u8a8d\u3057\u3066\u307f\u307e\u3057\u305f\u3002\n\nKafka\u30af\u30e9\u30b9\u30bf\u69cb\u6210\u306b\u304a\u3044\u3066\u3001broker.id=1\u306eKafka\u30b5\u30fc\u30d0\u304c\u3001leader\u306b\u9078\u5b9a\u3055\u308c\u3066\u304a\u308a\u307e\u3059\u3002\n$ kafka-topics.sh --describe --zookeeper 192.168.100.201:2181 --topic kafkaesque\nTopic:kafkaesque    PartitionCount:1    ReplicationFactor:2 Configs:\n    Topic: kafkaesque   Partition: 0    Leader: 1   Replicas: 2,1   Isr: 1,2\n\nProducer\u5074\u304b\u3089\u523b\u3005\u3068\u9001\u4fe1\u3055\u308c\u3066\u304f\u308b\u6642\u523b\u7b49\u306e\u30c7\u30fc\u30bf\u3092\u3001\u5404\u3005\u306eCousumer\u5074\u3067\u968f\u6642\u8868\u793a\u3055\u308c\u308b\u72b6\u614b\u306b\u3066\u3001leader\u306b\u9078\u5b9a\u3055\u308c\u3066\u3044\u308bKafka\u30d7\u30ed\u30bb\u30b9\u3092\u3001\"Ctrl+C\"\u306b\u3066\u5f37\u5236\u505c\u6b62\u3055\u305b\u3066\u307f\u307e\u3059\u3002\u3059\u308b\u3068Kafka\u30af\u30e9\u30b9\u30bf\u52d5\u4f5c\u3068\u3057\u3066\u306f\u3001\u30d5\u30a7\u30a4\u30eb\u30aa\u30fc\u30d0\u306b\u3088\u3063\u3066\u3001\u305d\u306e\u5f8c\u3082\u3001\u5404\u3005\u306eCousumer\u5074\u3067\u968f\u6642\u8868\u793a\u3055\u308c\u3064\u3065\u3051\u308b\u306f\u305a\u3067\u3059\u3002\n\n192.168.100.200\u306eProducer\u5074\u30b5\u30f3\u30d7\u30eb\u30a2\u30d7\u30ea\u8d77\u52d5\n$ python kafka_producer.py \nMetamorphosis! 21:20:14.368620\nMetamorphosis! 21:20:15.385962\nMetamorphosis! 21:20:16.390473\nMetamorphosis! 21:20:17.394782\nMetamorphosis! 21:20:18.399187\nMetamorphosis! 21:20:19.403492\nMetamorphosis! 21:20:20.407589\nMetamorphosis! 21:20:21.411884\nMetamorphosis! 21:20:22.415718\nMetamorphosis! 21:20:23.419357\nMetamorphosis! 21:20:24.423614\nNo handlers could be found for logger \"kafka.conn\"\nFailedPayloadsError: []\nMetamorphosis! 21:20:26.430648\nMetamorphosis! 21:20:27.452339\nMetamorphosis! 21:20:28.458493\nMetamorphosis! 21:20:29.464982\nMetamorphosis! 21:20:30.470309\nMetamorphosis! 21:20:31.476017\nMetamorphosis! 21:20:32.481460\nMetamorphosis! 21:20:33.488170\nMetamorphosis! 21:20:34.493129\nMetamorphosis! 21:20:35.498406\nMetamorphosis! 21:20:36.503719\n...\n\n\nProducer\u5074\u30b5\u30f3\u30d7\u30eb\u30a2\u30d7\u30ea\u5b9f\u884c\u7d50\u679c\u3068\u3057\u3066\u306f\u300121:20:25\u306b\u3001Kafka\u30b5\u30fc\u30d0\u3068\u306e\u30b3\u30cd\u30af\u30b7\u30e7\u30f3\u65ad\u304c\u767a\u751f\u3057\u305f\u305f\u3081\u3001Producer\u5074\u304b\u3089\u306e\u30c7\u30fc\u30bf\u9001\u4fe1\u306f\u3001\u884c\u308f\u308c\u307e\u305b\u3093\u3067\u3057\u305f\u3002\n\n192.168.100.201\u306eConsumer\u5074\u30b5\u30f3\u30d7\u30eb\u30a2\u30d7\u30ea\u8d77\u52d5\n$ go run kafka_consumer.go \n2016/01/10 21:19:42 Connected to 192.168.100.201:2181\n2016/01/10 21:19:42 Authenticated: id=95184864121651392, timeout=4000\n2016-01-10/21:19:42 [WARN] [6707d3a7-f5c3-1dc7-d652-fa941fad8628] Consumer failed to reflect all partitions 0 of 1\n2016-01-10/21:19:42 [ERROR] [6707d3a7-f5c3-1dc7-d652-fa941fad8628] Failed to reflect partition ownership during rebalance\n2016-01-10/21:19:47 [WARN] [6707d3a7-f5c3-1dc7-d652-fa941fad8628] Consumer failed to reflect all partitions 0 of 1\n2016-01-10/21:19:47 [ERROR] [6707d3a7-f5c3-1dc7-d652-fa941fad8628] Failed to reflect partition ownership during rebalance\nmsg.Value=[Metamorphosis! 21:20:14.368620]\nmsg.Value=[Metamorphosis! 21:20:15.385962]\nmsg.Value=[Metamorphosis! 21:20:16.390473]\nmsg.Value=[Metamorphosis! 21:20:17.394782]\nmsg.Value=[Metamorphosis! 21:20:18.399187]\nmsg.Value=[Metamorphosis! 21:20:19.403492]\nmsg.Value=[Metamorphosis! 21:20:20.407589]\nmsg.Value=[Metamorphosis! 21:20:21.411884]\nmsg.Value=[Metamorphosis! 21:20:22.415718]\n2016-01-10/21:20:24 [WARN] [ConsumerFetcherRoutine-6707d3a7-f5c3-1dc7-d652-fa941fad8628-0] Got a fetch error for topic kafkaesque, partition 0: EOF\n2016-01-10/21:20:24 [WARN] [6707d3a7-f5c3-1dc7-d652-fa941fad8628] Consumer failed to reflect all partitions 0 of 1\n2016-01-10/21:20:24 [ERROR] [6707d3a7-f5c3-1dc7-d652-fa941fad8628] Failed to reflect partition ownership during rebalance\n2016-01-10/21:20:25 [WARN] [ConsumerFetcherRoutine-6707d3a7-f5c3-1dc7-d652-fa941fad8628-0] Got a fetch error for topic kafkaesque, partition 0: EOF\nmsg.Value=[Metamorphosis! 21:20:23.419357]\nmsg.Value=[Metamorphosis! 21:20:24.423614]\nmsg.Value=[Metamorphosis! 21:20:26.430648]\nmsg.Value=[Metamorphosis! 21:20:27.452339]\n2016-01-10/21:20:29 [WARN] [6707d3a7-f5c3-1dc7-d652-fa941fad8628] Consumer failed to reflect all partitions 0 of 1\n2016-01-10/21:20:29 [ERROR] [6707d3a7-f5c3-1dc7-d652-fa941fad8628] Failed to reflect partition ownership during rebalance\nmsg.Value=[Metamorphosis! 21:20:28.458493]\nmsg.Value=[Metamorphosis! 21:20:29.464982]\nmsg.Value=[Metamorphosis! 21:20:30.470309]\nmsg.Value=[Metamorphosis! 21:20:31.476017]\nmsg.Value=[Metamorphosis! 21:20:32.481460]\n2016-01-10/21:20:34 [WARN] [6707d3a7-f5c3-1dc7-d652-fa941fad8628] Consumer failed to reflect all partitions 0 of 1\n2016-01-10/21:20:34 [ERROR] [6707d3a7-f5c3-1dc7-d652-fa941fad8628] Failed to reflect partition ownership during rebalance\nmsg.Value=[Metamorphosis! 21:20:33.488170]\nmsg.Value=[Metamorphosis! 21:20:34.493129]\nmsg.Value=[Metamorphosis! 21:20:35.498406]\nmsg.Value=[Metamorphosis! 21:20:36.503719]\n...\n\n\n\n192.168.100.202\u306eConsumer\u5074\u30b5\u30f3\u30d7\u30eb\u30a2\u30d7\u30ea\u8d77\u52d5\n$ go run kafka_consumer.go \nmsg.Value=[Metamorphosis! 21:20:14.368620]\nmsg.Value=[Metamorphosis! 21:20:15.385962]\nmsg.Value=[Metamorphosis! 21:20:16.390473]\nmsg.Value=[Metamorphosis! 21:20:17.394782]\nmsg.Value=[Metamorphosis! 21:20:18.399187]\nmsg.Value=[Metamorphosis! 21:20:19.403492]\nmsg.Value=[Metamorphosis! 21:20:20.407589]\nmsg.Value=[Metamorphosis! 21:20:21.411884]\nmsg.Value=[Metamorphosis! 21:20:22.415718]\nmsg.Value=[Metamorphosis! 21:20:23.419357]\nmsg.Value=[Metamorphosis! 21:20:24.423614]\n2016-01-10/21:20:24 [WARN] [ConsumerFetcherRoutine-d6e58d92-0576-94e5-a316-380d4474cc02-0] Got a fetch error for topic kafkaesque, partition 0: EOF\n2016-01-10/21:20:25 [WARN] [d6e58d92-0576-94e5-a316-380d4474cc02] Consumer failed to reflect all partitions 0 of 1\n2016-01-10/21:20:25 [ERROR] [d6e58d92-0576-94e5-a316-380d4474cc02] Failed to reflect partition ownership during rebalance\n2016-01-10/21:20:25 [WARN] [ConsumerFetcherRoutine-d6e58d92-0576-94e5-a316-380d4474cc02-0] Got a fetch error for topic kafkaesque, partition 0: EOF\nmsg.Value=[Metamorphosis! 21:20:26.430648]\nmsg.Value=[Metamorphosis! 21:20:27.452339]\nmsg.Value=[Metamorphosis! 21:20:28.458493]\nmsg.Value=[Metamorphosis! 21:20:29.464982]\n2016-01-10/21:20:30 [WARN] [d6e58d92-0576-94e5-a316-380d4474cc02] Consumer failed to reflect all partitions 0 of 1\n2016-01-10/21:20:30 [ERROR] [d6e58d92-0576-94e5-a316-380d4474cc02] Failed to reflect partition ownership during rebalance\nmsg.Value=[Metamorphosis! 21:20:30.470309]\nmsg.Value=[Metamorphosis! 21:20:31.476017]\nmsg.Value=[Metamorphosis! 21:20:32.481460]\nmsg.Value=[Metamorphosis! 21:20:33.488170]\nmsg.Value=[Metamorphosis! 21:20:34.493129]\nmsg.Value=[Metamorphosis! 21:20:35.498406]\nmsg.Value=[Metamorphosis! 21:20:36.503719]\n\n\nConsumer\u5074\u30b5\u30f3\u30d7\u30eb\u30a2\u30d7\u30ea\u5b9f\u884c\u7d50\u679c\u3068\u3057\u3066\u306f\u3001\u3068\u3053\u308d\u3069\u3053\u308d\u3067\u3001\"WARN\", \"ERROR\"\u304c\u51fa\u529b\u3055\u308c\u3066\u3044\u307e\u3059\u304c\u3001Producer\u5074\u304b\u3089\u306e\u30c7\u30fc\u30bf\u9001\u4fe1\u306f\u3001\u53d6\u308a\u3053\u307c\u3057\u306a\u304f\u3001\u5404\u3005\u306eCousumer\u5074\u3067\u968f\u6642\u8868\u793a\u3055\u308c\u308b\u3053\u3068\u304c\u78ba\u8a8d\u3067\u304d\u307e\u3057\u305f\u3002\n$ kafka-topics.sh --describe --zookeeper 192.168.100.201:2181 --topic kafkaesque\nTopic:kafkaesque    PartitionCount:1    ReplicationFactor:2 Configs:\n    Topic: kafkaesque   Partition: 0    Leader: 2   Replicas: 2,1   Isr: 2\n\n\u6700\u5f8c\u306b\u3001Kafka\u30af\u30e9\u30b9\u30bf\u69cb\u6210\u306b\u304a\u3044\u3066\u3001leader\u306b\u9078\u5b9a\u3055\u308c\u3066\u3044\u308bKafka\u30d7\u30ed\u30bb\u30b9\u3092\u3001\"Ctrl+C\"\u306b\u3066\u5f37\u5236\u505c\u6b62\u3055\u305b\u305f\u3053\u3068\u306b\u3088\u308a\u3001broker.id=2\u306eKafka\u30b5\u30fc\u30d0\u304c\u3001leader\u306b\u9078\u5b9a\u3055\u308c\u3066\u3044\u308b\u3088\u3046\u3059\u304c\u78ba\u8a8d\u3067\u304d\u307e\u3057\u305f\u3002\n\n\u25fc\ufe0e \u53c2\u7167\u5143\n\nKafka\u30af\u30e9\u30b9\u30bf\u3067Consumer\u3092\u63a5\u7d9a\u3057\u305f\u969b\u306e\u52d5\u4f5c\n\n\u524d\u56de\u306e[Apache Kafka\u8a18\u4e8b](http://qiita.com/ttsubo/items/97f3ccfb1812635479a5)\u306e\u3064\u3065\u304d\u3067\u3059\u3002\u4eca\u56de\u306f\u3001Kafka\u30af\u30e9\u30b9\u30bf\u69cb\u6210\u3092\u78ba\u8a8d\u3057\u3066\u307f\u307e\u3059\u3002\n\n# \u25fc\ufe0e \u4eca\u56de\u3001\u8a66\u3057\u3066\u307f\u308b Kafka\u30af\u30e9\u30b9\u30bf\u69cb\u6210\nKafka\u30af\u30e9\u30b9\u30bf\u306f\u3001\u3064\u304e\u306e\u3088\u3046\u306a\u69cb\u6210\u3068\u3057\u307e\u3057\u305f\u3002\n\n+ Mac OS X\u74b0\u5883\uff12\u53f0\u3067\u3001\u30af\u30e9\u30b9\u30bf\u69cb\u6210\u3092\u69cb\u7bc9\u3059\u308b\n+ Producer\u5074\u306f\u3001\u72ec\u7acb\u3057\u305f\u30b5\u30fc\u30d0\u74b0\u5883\u3067\u52d5\u4f5c\u3055\u305b\u308b\n+ Consumer\u5074\u306f\u3001Kafka\u30af\u30e9\u30b9\u30bf\u306e\u30b5\u30fc\u30d0\u74b0\u5883\u306b\u540c\u5c45\u3055\u305b\u308b \n+ zookeeper\u306f\u3001192.168.100.201\u5074\u3092\u4f7f\u7528\u3059\u308b\n+ Consumer\u5074\u3067\u306f\u3001\u540c\u3058\u30bf\u30a4\u30df\u30f3\u30b0\u3067Producer\u5074\u306e\u9001\u4fe1\u30c7\u30fc\u30bf\u3092\u53d6\u5f97\u3059\u308b\n\n![kafka\u69cb\u6210.jpeg](https://qiita-image-store.s3.amazonaws.com/0/103595/18fc0d9e-6eda-8956-7bcb-ef69f3c6a4e3.jpeg)\n\n\u5b9f\u969b\u3001topic\"kafkaesque\"\u3092\u518d\u4f5c\u6210\u3057\u3066\u3001\u3064\u304e\u306e\u3088\u3046\u306aKafka\u30af\u30e9\u30b9\u30bf\u69cb\u6210\u3092\u69cb\u7bc9\u3057\u307e\u3059\u3002\n\n+ topic\u4f5c\u6210\u6642\u306b\u3001\u30ec\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u6709\u52b9\u306b\u3059\u308b\n+ \u30d1\u30fc\u30c6\u30b7\u30e7\u30f3\u306f\u3001\uff11\u3064\u306e\u307f\u4f5c\u6210\u3059\u308b\n\n```\n$ kafka-topics.sh --describe --zookeeper 192.168.100.201:2181 --topic kafkaesque\nTopic:kafkaesque\tPartitionCount:1\tReplicationFactor:2\tConfigs:\n\tTopic: kafkaesque\tPartition: 0\tLeader: 1\tReplicas: 2,1\tIsr: 1,2\n```\n\n\u306a\u304a\u3001\u4eca\u56de\u3001\u4f7f\u7528\u3057\u305fkafka\u306e\u30bd\u30d5\u30c8\u30a6\u30a7\u30a2\u306f\u30010.8.2.1\u3068\u5c11\u3057\u53e4\u3081\u306e\u3082\u306e\u306b\u306a\u308a\u307e\u3059\u3002\n\n```\n$ brew list kafka\n/usr/local/Cellar/kafka/0.8.2.1/bin/kafka-console-consumer.sh\n/usr/local/Cellar/kafka/0.8.2.1/bin/kafka-console-producer.sh\n/usr/local/Cellar/kafka/0.8.2.1/bin/kafka-consumer-offset-checker.sh\n/usr/local/Cellar/kafka/0.8.2.1/bin/kafka-consumer-perf-test.sh\n/usr/local/Cellar/kafka/0.8.2.1/bin/kafka-mirror-maker.sh\n/usr/local/Cellar/kafka/0.8.2.1/bin/kafka-preferred-replica-election.sh\n/usr/local/Cellar/kafka/0.8.2.1/bin/kafka-producer-perf-test.sh\n/usr/local/Cellar/kafka/0.8.2.1/bin/kafka-reassign-partitions.sh\n/usr/local/Cellar/kafka/0.8.2.1/bin/kafka-replay-log-producer.sh\n/usr/local/Cellar/kafka/0.8.2.1/bin/kafka-replica-verification.sh\n/usr/local/Cellar/kafka/0.8.2.1/bin/kafka-run-class.sh\n/usr/local/Cellar/kafka/0.8.2.1/bin/kafka-server-start.sh\n/usr/local/Cellar/kafka/0.8.2.1/bin/kafka-server-stop.sh\n/usr/local/Cellar/kafka/0.8.2.1/bin/kafka-simple-consumer-shell.sh\n/usr/local/Cellar/kafka/0.8.2.1/bin/kafka-topics.sh\n/usr/local/Cellar/kafka/0.8.2.1/bin/zookeeper-server-start.sh\n/usr/local/Cellar/kafka/0.8.2.1/bin/zookeeper-server-stop.sh\n/usr/local/Cellar/kafka/0.8.2.1/bin/zookeeper-shell.sh\n/usr/local/Cellar/kafka/0.8.2.1/homebrew.mxcl.kafka.plist\n/usr/local/Cellar/kafka/0.8.2.1/libexec/bin/ (18 files)\n/usr/local/Cellar/kafka/0.8.2.1/libexec/clients/ (390 files)\n/usr/local/Cellar/kafka/0.8.2.1/libexec/contrib/ (49 files)\n/usr/local/Cellar/kafka/0.8.2.1/libexec/core/ (3072 files)\n/usr/local/Cellar/kafka/0.8.2.1/libexec/examples/ (18 files)\n/usr/local/Cellar/kafka/0.8.2.1/libexec/logs/ (83 files)\n/usr/local/Cellar/kafka/0.8.2.1/libexec/system_test/ (247 files)\n```\n\n# \u25fc\ufe0e Kafka\u30af\u30e9\u30b9\u30bf\u52d5\u4f5c\u74b0\u5883\u3092\u3064\u304f\u308b\n\n+ \u524d\u56de\u3001\u4f5c\u6210\u306e topic\"kafkaesque\"\u3092\u524a\u9664\n\n```\n$ kafka-topics.sh --delete  --zookeeper localhost:2181  --topic kafkaesque\n```\n\n+ kafka\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u7de8\u96c6\n\n\n```text:192.168.100.201\u5074\u30d1\u30e9\u30e1\u30fc\u30bf\u4f8b\n$ vi /usr/local/etc/kafka/server.properties\n------------------\nbroker.id=1\nport=9092\nhost.name=192.168.100.201\nzookeeper.connect=192.168.100.201:2181\ndelete.topic.enable=true\n```\n\n\n```text:192.168.100.202\u5074\u30d1\u30e9\u30e1\u30fc\u30bf\u4f8b\n$ vi /usr/local/etc/kafka/server.properties\n------------------\nbroker.id=2\nport=9092\nhost.name=192.168.100.202\nzookeeper.connect=192.168.100.201:2181\ndelete.topic.enable=true\n```\n+ kafka\u3092\u8d77\u52d5\n\n```\n$ kafka-server-start.sh /usr/local/etc/kafka/server.properties\n```\n\n+ topic: \"kafkaesque\"\u3092\u4f5c\u6210 & \u78ba\u8a8d\n\n```\n$ kafka-topics.sh --create --zookeeper 192.168.100.201:2181 --replication-factor 2 --partitions 1 --topic kafkaesque\nCreated topic \"kafkaesque\".\n\n$ kafka-topics.sh --describe --zookeeper 192.168.100.201:2181 --topic kafkaesque\nTopic:kafkaesque\tPartitionCount:1\tReplicationFactor:2\tConfigs:\n\tTopic: kafkaesque\tPartition: 0\tLeader: 1\tReplicas: 2,1\tIsr: 1,2\n```\n\n+ Producer\u5074\u30b5\u30f3\u30d7\u30eb\u30a2\u30d7\u30ea\u3092\u914d\u5099\uff08\u524d\u56de\u306ekafka_producer.py\u3092\u4fee\u6b63\u3057\u3066\u3001\u30d5\u30a7\u30a4\u30eb\u30aa\u30fc\u30d0\u306b\u5bfe\u5fdc\u3057\u307e\u3057\u305f\u3002\uff09\n\n```py:kafka_producer.py\nfrom kafka.client import KafkaClient\nfrom kafka.producer import SimpleProducer\nfrom kafka.common import FailedPayloadsError\nfrom kafka.common import KafkaUnavailableError\nfrom time import sleep\nfrom datetime import datetime\n\nproducer = None\n\ntry:\n    kafka = KafkaClient(\"192.168.100.201:9092, 192.168.100.202:9092\")\n    producer = SimpleProducer(kafka)\nexcept KafkaUnavailableError as e:\n    print \"KafkaUnavailableError: [%s]\"% e\n\n\nwhile 1:\n    # \"kafkaesque\" is the name of our topic\n    if producer is None:\n        exit(1)\n    else:\n        try:\n            nowtime = str(datetime.now().time())\n            producer.send_messages(\"kafkaesque\", \"Metamorphosis! \" + nowtime)\n            print \"Metamorphosis! \" + nowtime\n        except FailedPayloadsError as e:\n            print \"FailedPayloadsError: [%s]\"% e\n            producer.client.close()\n            producer = SimpleProducer(kafka)\n        except KafkaUnavailableError as e:\n            print \"KafkaUnavailableError: [%s]\"% e\n            producer.client.close()\n            producer = None\n    sleep(1)\n```\n\n+ Consumer\u5074\u30b5\u30f3\u30d7\u30eb\u30a2\u30d7\u30ea\u3092\u914d\u5099\uff08[\u524d\u56de\u306ekafka_consumer.go](http://qiita.com/ttsubo/items/97f3ccfb1812635479a5)\u3068\u540c\u3058\u30b5\u30f3\u30d7\u30eb\u30a2\u30d7\u30ea\u3092\u4f7f\u7528\u3057\u307e\u3059\u3002\uff09\n\n+ Consumer\u5074\u30b5\u30f3\u30d7\u30eb\u30a2\u30d7\u30ea\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\n\n```text:192.168.100.201\u5074\u306econsumers.properties\n#Consumer identity\nclient_id=go-consumer1\ngroup_id=cs-rebalance-group1\nnum_consumers=1\ntopic=kafkaesque\nlog_level=warn\n\n#Zookeeper connection settings\nzookeeper_connect=192.168.100.201:2181\nzookeeper_timeout=1s\n...\n```\n\n```text:192.168.100.202\u5074\u306econsumers.properties\n#Consumer identity\nclient_id=go-consumer2\ngroup_id=cs-rebalance-group2\nnum_consumers=1\ntopic=kafkaesque\nlog_level=warn\n\n#Zookeeper connection settings\nzookeeper_connect=192.168.100.201:2181\nzookeeper_timeout=1s\n...\n```\n\n# \u25fc\ufe0e \u3055\u3063\u305d\u304f\u3001kafka\u30af\u30e9\u30b9\u30bf\u74b0\u5883\u3067\u52d5\u304b\u3057\u3066\u307f\u308b\n\u4eca\u56de\u3001Consumer\u5074\u306egroup_id\u306f\u3001\u5404\u3005\u3067\u7570\u306a\u308b\u5024\u3092\u8a2d\u5b9a\u3057\u307e\u3057\u305f\u3002\n\u3053\u308c\u306b\u3088\u3063\u3066\u3001Producer\u5074\u304b\u3089\u306e\u9001\u4fe1\u30c7\u30fc\u30bf\u304c\u540c\u5831\u7684\u306b\u53d6\u5f97\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u308b\u306f\u305a\u3067\u3059\u3002\n\n+ \u307e\u305a\u306f\u3001\u969c\u5bb3\u304c\u767a\u751f\u3057\u3066\u3044\u306a\u3044\u5834\u5408\u306eKafka\u30af\u30e9\u30b9\u30bf\u52d5\u4f5c\u3092\u78ba\u8a8d\u3057\u3066\u307f\u307e\u3057\u305f\u3002\n\n```text:192.168.100.200\u306eProducer\u5074\u30b5\u30f3\u30d7\u30eb\u30a2\u30d7\u30ea\u8d77\u52d5\n$ python kafka_producer.py \nMetamorphosis! 20:29:17.478683\nMetamorphosis! 20:29:18.483005\nMetamorphosis! 20:29:19.487480\nMetamorphosis! 20:29:20.491742\nMetamorphosis! 20:29:21.496180\nMetamorphosis! 20:29:22.500724\nMetamorphosis! 20:29:23.505113\nMetamorphosis! 20:29:24.509501\nMetamorphosis! 20:29:25.513620\nMetamorphosis! 20:29:26.517824\nMetamorphosis! 20:29:27.522053\nMetamorphosis! 20:29:28.526435\nMetamorphosis! 20:29:29.530428\nMetamorphosis! 20:29:30.534616\n...\n```\n\n```text:192.168.100.201\u306eConsumer\u5074\u30b5\u30f3\u30d7\u30eb\u30a2\u30d7\u30ea\u8d77\u52d5\n$ go run kafka_consumer.go \n2016/01/10 20:28:32 Connected to 192.168.100.201:2181\n2016/01/10 20:28:32 Authenticated: id=95184864121651345, timeout=4000\nmsg.Value=[Metamorphosis! 20:29:17.478683]\nmsg.Value=[Metamorphosis! 20:29:18.483005]\nmsg.Value=[Metamorphosis! 20:29:19.487480]\nmsg.Value=[Metamorphosis! 20:29:20.491742]\nmsg.Value=[Metamorphosis! 20:29:21.496180]\nmsg.Value=[Metamorphosis! 20:29:22.500724]\nmsg.Value=[Metamorphosis! 20:29:23.505113]\nmsg.Value=[Metamorphosis! 20:29:24.509501]\nmsg.Value=[Metamorphosis! 20:29:25.513620]\nmsg.Value=[Metamorphosis! 20:29:26.517824]\nmsg.Value=[Metamorphosis! 20:29:27.522053]\nmsg.Value=[Metamorphosis! 20:29:28.526435]\nmsg.Value=[Metamorphosis! 20:29:29.530428]\nmsg.Value=[Metamorphosis! 20:29:30.534616]\n...\n```\n\n```text:192.168.100.202\u306eConsumer\u5074\u30b5\u30f3\u30d7\u30eb\u30a2\u30d7\u30ea\u8d77\u52d5\n$ go run kafka_consumer.go \nmsg.Value=[Metamorphosis! 20:29:17.478683]\nmsg.Value=[Metamorphosis! 20:29:18.483005]\nmsg.Value=[Metamorphosis! 20:29:19.487480]\nmsg.Value=[Metamorphosis! 20:29:20.491742]\nmsg.Value=[Metamorphosis! 20:29:21.496180]\nmsg.Value=[Metamorphosis! 20:29:22.500724]\nmsg.Value=[Metamorphosis! 20:29:23.505113]\nmsg.Value=[Metamorphosis! 20:29:24.509501]\nmsg.Value=[Metamorphosis! 20:29:25.513620]\nmsg.Value=[Metamorphosis! 20:29:26.517824]\nmsg.Value=[Metamorphosis! 20:29:27.522053]\nmsg.Value=[Metamorphosis! 20:29:28.526435]\nmsg.Value=[Metamorphosis! 20:29:29.530428]\nmsg.Value=[Metamorphosis! 20:29:30.534616]\n...\n```\nProducer\u5074\u304b\u3089\u523b\u3005\u3068\u9001\u4fe1\u3055\u308c\u3066\u304f\u308b\u6642\u523b\u7b49\u306e\u30c7\u30fc\u30bf\u3092\u3001\u5404\u3005\u306eCousumer\u5074\u3067\u968f\u6642\u8868\u793a\u3055\u308c\u308b\u3053\u3068\u304c\u78ba\u8a8d\u3067\u304d\u307e\u3057\u305f\u3002\n\n+ \u6b21\u306b\u3001\u969c\u5bb3\u304c\u767a\u751f\u3057\u305f\u5834\u5408\u306eKafka\u30af\u30e9\u30b9\u30bf\u52d5\u4f5c\u3092\u78ba\u8a8d\u3057\u3066\u307f\u307e\u3057\u305f\u3002\n\nKafka\u30af\u30e9\u30b9\u30bf\u69cb\u6210\u306b\u304a\u3044\u3066\u3001broker.id=1\u306eKafka\u30b5\u30fc\u30d0\u304c\u3001leader\u306b\u9078\u5b9a\u3055\u308c\u3066\u304a\u308a\u307e\u3059\u3002\n\n```\n$ kafka-topics.sh --describe --zookeeper 192.168.100.201:2181 --topic kafkaesque\nTopic:kafkaesque\tPartitionCount:1\tReplicationFactor:2\tConfigs:\n\tTopic: kafkaesque\tPartition: 0\tLeader: 1\tReplicas: 2,1\tIsr: 1,2\n```\n\nProducer\u5074\u304b\u3089\u523b\u3005\u3068\u9001\u4fe1\u3055\u308c\u3066\u304f\u308b\u6642\u523b\u7b49\u306e\u30c7\u30fc\u30bf\u3092\u3001\u5404\u3005\u306eCousumer\u5074\u3067\u968f\u6642\u8868\u793a\u3055\u308c\u308b\u72b6\u614b\u306b\u3066\u3001leader\u306b\u9078\u5b9a\u3055\u308c\u3066\u3044\u308bKafka\u30d7\u30ed\u30bb\u30b9\u3092\u3001\"Ctrl+C\"\u306b\u3066\u5f37\u5236\u505c\u6b62\u3055\u305b\u3066\u307f\u307e\u3059\u3002\u3059\u308b\u3068Kafka\u30af\u30e9\u30b9\u30bf\u52d5\u4f5c\u3068\u3057\u3066\u306f\u3001\u30d5\u30a7\u30a4\u30eb\u30aa\u30fc\u30d0\u306b\u3088\u3063\u3066\u3001\u305d\u306e\u5f8c\u3082\u3001\u5404\u3005\u306eCousumer\u5074\u3067\u968f\u6642\u8868\u793a\u3055\u308c\u3064\u3065\u3051\u308b\u306f\u305a\u3067\u3059\u3002\n\n```text:192.168.100.200\u306eProducer\u5074\u30b5\u30f3\u30d7\u30eb\u30a2\u30d7\u30ea\u8d77\u52d5\n$ python kafka_producer.py \nMetamorphosis! 21:20:14.368620\nMetamorphosis! 21:20:15.385962\nMetamorphosis! 21:20:16.390473\nMetamorphosis! 21:20:17.394782\nMetamorphosis! 21:20:18.399187\nMetamorphosis! 21:20:19.403492\nMetamorphosis! 21:20:20.407589\nMetamorphosis! 21:20:21.411884\nMetamorphosis! 21:20:22.415718\nMetamorphosis! 21:20:23.419357\nMetamorphosis! 21:20:24.423614\nNo handlers could be found for logger \"kafka.conn\"\nFailedPayloadsError: []\nMetamorphosis! 21:20:26.430648\nMetamorphosis! 21:20:27.452339\nMetamorphosis! 21:20:28.458493\nMetamorphosis! 21:20:29.464982\nMetamorphosis! 21:20:30.470309\nMetamorphosis! 21:20:31.476017\nMetamorphosis! 21:20:32.481460\nMetamorphosis! 21:20:33.488170\nMetamorphosis! 21:20:34.493129\nMetamorphosis! 21:20:35.498406\nMetamorphosis! 21:20:36.503719\n...\n```\nProducer\u5074\u30b5\u30f3\u30d7\u30eb\u30a2\u30d7\u30ea\u5b9f\u884c\u7d50\u679c\u3068\u3057\u3066\u306f\u300121:20:25\u306b\u3001Kafka\u30b5\u30fc\u30d0\u3068\u306e\u30b3\u30cd\u30af\u30b7\u30e7\u30f3\u65ad\u304c\u767a\u751f\u3057\u305f\u305f\u3081\u3001Producer\u5074\u304b\u3089\u306e\u30c7\u30fc\u30bf\u9001\u4fe1\u306f\u3001\u884c\u308f\u308c\u307e\u305b\u3093\u3067\u3057\u305f\u3002\n\n```text:192.168.100.201\u306eConsumer\u5074\u30b5\u30f3\u30d7\u30eb\u30a2\u30d7\u30ea\u8d77\u52d5\n$ go run kafka_consumer.go \n2016/01/10 21:19:42 Connected to 192.168.100.201:2181\n2016/01/10 21:19:42 Authenticated: id=95184864121651392, timeout=4000\n2016-01-10/21:19:42 [WARN] [6707d3a7-f5c3-1dc7-d652-fa941fad8628] Consumer failed to reflect all partitions 0 of 1\n2016-01-10/21:19:42 [ERROR] [6707d3a7-f5c3-1dc7-d652-fa941fad8628] Failed to reflect partition ownership during rebalance\n2016-01-10/21:19:47 [WARN] [6707d3a7-f5c3-1dc7-d652-fa941fad8628] Consumer failed to reflect all partitions 0 of 1\n2016-01-10/21:19:47 [ERROR] [6707d3a7-f5c3-1dc7-d652-fa941fad8628] Failed to reflect partition ownership during rebalance\nmsg.Value=[Metamorphosis! 21:20:14.368620]\nmsg.Value=[Metamorphosis! 21:20:15.385962]\nmsg.Value=[Metamorphosis! 21:20:16.390473]\nmsg.Value=[Metamorphosis! 21:20:17.394782]\nmsg.Value=[Metamorphosis! 21:20:18.399187]\nmsg.Value=[Metamorphosis! 21:20:19.403492]\nmsg.Value=[Metamorphosis! 21:20:20.407589]\nmsg.Value=[Metamorphosis! 21:20:21.411884]\nmsg.Value=[Metamorphosis! 21:20:22.415718]\n2016-01-10/21:20:24 [WARN] [ConsumerFetcherRoutine-6707d3a7-f5c3-1dc7-d652-fa941fad8628-0] Got a fetch error for topic kafkaesque, partition 0: EOF\n2016-01-10/21:20:24 [WARN] [6707d3a7-f5c3-1dc7-d652-fa941fad8628] Consumer failed to reflect all partitions 0 of 1\n2016-01-10/21:20:24 [ERROR] [6707d3a7-f5c3-1dc7-d652-fa941fad8628] Failed to reflect partition ownership during rebalance\n2016-01-10/21:20:25 [WARN] [ConsumerFetcherRoutine-6707d3a7-f5c3-1dc7-d652-fa941fad8628-0] Got a fetch error for topic kafkaesque, partition 0: EOF\nmsg.Value=[Metamorphosis! 21:20:23.419357]\nmsg.Value=[Metamorphosis! 21:20:24.423614]\nmsg.Value=[Metamorphosis! 21:20:26.430648]\nmsg.Value=[Metamorphosis! 21:20:27.452339]\n2016-01-10/21:20:29 [WARN] [6707d3a7-f5c3-1dc7-d652-fa941fad8628] Consumer failed to reflect all partitions 0 of 1\n2016-01-10/21:20:29 [ERROR] [6707d3a7-f5c3-1dc7-d652-fa941fad8628] Failed to reflect partition ownership during rebalance\nmsg.Value=[Metamorphosis! 21:20:28.458493]\nmsg.Value=[Metamorphosis! 21:20:29.464982]\nmsg.Value=[Metamorphosis! 21:20:30.470309]\nmsg.Value=[Metamorphosis! 21:20:31.476017]\nmsg.Value=[Metamorphosis! 21:20:32.481460]\n2016-01-10/21:20:34 [WARN] [6707d3a7-f5c3-1dc7-d652-fa941fad8628] Consumer failed to reflect all partitions 0 of 1\n2016-01-10/21:20:34 [ERROR] [6707d3a7-f5c3-1dc7-d652-fa941fad8628] Failed to reflect partition ownership during rebalance\nmsg.Value=[Metamorphosis! 21:20:33.488170]\nmsg.Value=[Metamorphosis! 21:20:34.493129]\nmsg.Value=[Metamorphosis! 21:20:35.498406]\nmsg.Value=[Metamorphosis! 21:20:36.503719]\n...\n```\n\n```text:192.168.100.202\u306eConsumer\u5074\u30b5\u30f3\u30d7\u30eb\u30a2\u30d7\u30ea\u8d77\u52d5\n$ go run kafka_consumer.go \nmsg.Value=[Metamorphosis! 21:20:14.368620]\nmsg.Value=[Metamorphosis! 21:20:15.385962]\nmsg.Value=[Metamorphosis! 21:20:16.390473]\nmsg.Value=[Metamorphosis! 21:20:17.394782]\nmsg.Value=[Metamorphosis! 21:20:18.399187]\nmsg.Value=[Metamorphosis! 21:20:19.403492]\nmsg.Value=[Metamorphosis! 21:20:20.407589]\nmsg.Value=[Metamorphosis! 21:20:21.411884]\nmsg.Value=[Metamorphosis! 21:20:22.415718]\nmsg.Value=[Metamorphosis! 21:20:23.419357]\nmsg.Value=[Metamorphosis! 21:20:24.423614]\n2016-01-10/21:20:24 [WARN] [ConsumerFetcherRoutine-d6e58d92-0576-94e5-a316-380d4474cc02-0] Got a fetch error for topic kafkaesque, partition 0: EOF\n2016-01-10/21:20:25 [WARN] [d6e58d92-0576-94e5-a316-380d4474cc02] Consumer failed to reflect all partitions 0 of 1\n2016-01-10/21:20:25 [ERROR] [d6e58d92-0576-94e5-a316-380d4474cc02] Failed to reflect partition ownership during rebalance\n2016-01-10/21:20:25 [WARN] [ConsumerFetcherRoutine-d6e58d92-0576-94e5-a316-380d4474cc02-0] Got a fetch error for topic kafkaesque, partition 0: EOF\nmsg.Value=[Metamorphosis! 21:20:26.430648]\nmsg.Value=[Metamorphosis! 21:20:27.452339]\nmsg.Value=[Metamorphosis! 21:20:28.458493]\nmsg.Value=[Metamorphosis! 21:20:29.464982]\n2016-01-10/21:20:30 [WARN] [d6e58d92-0576-94e5-a316-380d4474cc02] Consumer failed to reflect all partitions 0 of 1\n2016-01-10/21:20:30 [ERROR] [d6e58d92-0576-94e5-a316-380d4474cc02] Failed to reflect partition ownership during rebalance\nmsg.Value=[Metamorphosis! 21:20:30.470309]\nmsg.Value=[Metamorphosis! 21:20:31.476017]\nmsg.Value=[Metamorphosis! 21:20:32.481460]\nmsg.Value=[Metamorphosis! 21:20:33.488170]\nmsg.Value=[Metamorphosis! 21:20:34.493129]\nmsg.Value=[Metamorphosis! 21:20:35.498406]\nmsg.Value=[Metamorphosis! 21:20:36.503719]\n```\nConsumer\u5074\u30b5\u30f3\u30d7\u30eb\u30a2\u30d7\u30ea\u5b9f\u884c\u7d50\u679c\u3068\u3057\u3066\u306f\u3001\u3068\u3053\u308d\u3069\u3053\u308d\u3067\u3001\"WARN\", \"ERROR\"\u304c\u51fa\u529b\u3055\u308c\u3066\u3044\u307e\u3059\u304c\u3001Producer\u5074\u304b\u3089\u306e\u30c7\u30fc\u30bf\u9001\u4fe1\u306f\u3001\u53d6\u308a\u3053\u307c\u3057\u306a\u304f\u3001\u5404\u3005\u306eCousumer\u5074\u3067\u968f\u6642\u8868\u793a\u3055\u308c\u308b\u3053\u3068\u304c\u78ba\u8a8d\u3067\u304d\u307e\u3057\u305f\u3002\n\n```\n$ kafka-topics.sh --describe --zookeeper 192.168.100.201:2181 --topic kafkaesque\nTopic:kafkaesque\tPartitionCount:1\tReplicationFactor:2\tConfigs:\n\tTopic: kafkaesque\tPartition: 0\tLeader: 2\tReplicas: 2,1\tIsr: 2\n```\n\u6700\u5f8c\u306b\u3001Kafka\u30af\u30e9\u30b9\u30bf\u69cb\u6210\u306b\u304a\u3044\u3066\u3001leader\u306b\u9078\u5b9a\u3055\u308c\u3066\u3044\u308bKafka\u30d7\u30ed\u30bb\u30b9\u3092\u3001\"Ctrl+C\"\u306b\u3066\u5f37\u5236\u505c\u6b62\u3055\u305b\u305f\u3053\u3068\u306b\u3088\u308a\u3001broker.id=2\u306eKafka\u30b5\u30fc\u30d0\u304c\u3001leader\u306b\u9078\u5b9a\u3055\u308c\u3066\u3044\u308b\u3088\u3046\u3059\u304c\u78ba\u8a8d\u3067\u304d\u307e\u3057\u305f\u3002\n\n# \u25fc\ufe0e \u53c2\u7167\u5143\n+ [Kafka\u30af\u30e9\u30b9\u30bf\u3067Consumer\u3092\u63a5\u7d9a\u3057\u305f\u969b\u306e\u52d5\u4f5c](http://kimutansk.hatenablog.com/entry/20140402/1396391975)\n", "tags": ["Kafka", "bigdata", "IoT"]}