{"context": " More than 1 year has passed since last update.\u300c\u95a2\u6570\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u5b9f\u8df5\u5165\u9580\u300d\u306b\u8a18\u8f09\u3055\u308c\u3066\u3044\u308b\u554f\u984c\u306b\u3064\u3044\u3066\u306e\u89e3\u8aac\u8a18\u4e8b\u3092\u5225\u306e\u3068\u3053\u308d\u3067\u898b\u304b\u3051\u305f\u3002\u89e3\u8aac\u304c\u9762\u767d\u304b\u3063\u305f\u3057\u3001VBAHaskell\u3067\u5b9f\u88c5\u3092\u8a66\u307f\u308b\u306e\u306b\u624b\u9803\u3060\u3063\u305f\u306e\u3067\u3084\u3063\u3066\u307f\u305f\u304c\u3001\u3042\u307e\u308a\u3044\u3044\u7d50\u679c\u306b\u306f\u306a\u3089\u305a\u8ab2\u984c\u304c\u6b8b\u3063\u305f\u3002\nsegments \u3068\u3044\u3046\u95a2\u6570\u3067\u3001\u5f15\u6570\u306b\u6587\u5b57\u5217\u3092\u6e21\u3059\u3068\u90e8\u5206\u6587\u5b57\u5217\u306e\u30ea\u30b9\u30c8\u304c\u53d6\u308a\u51fa\u305b\u308b\u3002\u4f8b\u3048\u3070 \"ABC\" \u306b\u5bfe\u3057\u3066\u3001[\"A\",\"AB\",\"ABC\",\"B\",\"BC\",\"C\"] \u3092\u51fa\u529b\u3059\u308b\u3082\u306e\u3060\u3002\n\u672c\u306b\u8f09\u3063\u3066\u3044\u308b\u5b9f\u88c5\u306f\u4ee5\u4e0b\u306e\u3082\u306e\u3089\u3057\u3044\u3002\nsegments :: [a] -> [[a]]\nsegments = foldr (++) [] . scanr (\\a b -> [a] : map (a:) b) []\n\n\u69cb\u6210\u8981\u7d20\u3092\u307e\u3068\u3081\u308b\u3068\u3053\u3046\u306a\u308b\u3002\n\n\n\n\u8a00\u8a9e\u8981\u7d20\nVBAHaskell\n\u4eca\u56de\u306e\u5b9f\u88c5\n\n\n\n\nfoldr, scanr\nfoldr, scanr 1\n\n-\n\n\n\u30ea\u30b9\u30c8\u7d50\u5408 (++)\ncatV \u95a2\u6570 2\n\n-\n\n\n\u30ea\u30b9\u30c8\u751f\u6210\u6f14\u7b97(:)\n\u306a\u3057\n\u65b0\u898f\u4f5c\u6210\n\n\n\u95a2\u6570\u5408\u6210 .\n\u4e0d\u5341\u5206\n\u51e6\u7406\u3092\u5206\u3051\u308b\n\n\n\u30e9\u30e0\u30c0\u5f0f \\\n\u4e0d\u5341\u5206\n\u72ec\u7acb\u3057\u305f\u95a2\u6570\u306b\u3059\u308b\n\n\n\n\u3053\u308c\u3092\u5b9f\u88c5\u3059\u308b\u305f\u3081\u306b\u3084\u3063\u305f\u3053\u3068\u306f\u4ee5\u4e0b\u306e\u901a\u308a\u3060\u304c\u3001VBAHaskell\u306e\u5408\u6210\u95a2\u6570\u306e\u4ed5\u7d44\u307f\u3067\u306f\u4eca\u56de\u306e\u554f\u984c\u306b\u5bfe\u5fdc\u3059\u308b\u306b\u306f\u4e0d\u5341\u5206\u3060\u3068\u3044\u3046\u3053\u3068\u304c\u308f\u304b\u3063\u305f\u3002\n\nHaskell\u3067cons\u3068\u547c\u3070\u308c\u3066\u3044\u308b\u30ea\u30b9\u30c8\u751f\u6210\u6f14\u7b97\u3092\u7528\u610f\u3057\u3066\u3044\u306a\u304b\u3063\u305f\u306e\u3067\u3001\u6a19\u6e96\u95a2\u6570\u3068\u3057\u3066Haskell_4_vector.bas\u30e2\u30b8\u30e5\u30fc\u30eb\u306b cons \u95a2\u6570\u3092\u8ffd\u52a0\u3057\u305f\u3002\u3053\u308c\u306f\u5225\u306b\u554f\u984c\u3067\u306f\u306a\u3044\u3002\nHaskell\u306e\u6587\u5b57\u5217\u306f\u6587\u5b57\u306e\u30ea\u30b9\u30c8\u3060\u304c\u3001VBA\u306f\u305d\u3046\u3067\u306f\u306a\u3044\u305f\u3081\u3001\u7d50\u679c\u8868\u793a\u306e\u3068\u304d\u914d\u5217\u3092\u6587\u5b57\u5217\u306b\u5909\u63db\u3059\u308b\u5fc5\u8981\u304c\u3042\u308b\u3002foldl\u3092\u4f7f\u3063\u3066\u3084\u308c\u3070\u3067\u304d\u308b\u304c\u3001\u52b9\u7387\u9762\u3082\u8003\u3048\u3066 StdFun\u30e2\u30b8\u30e5\u30fc\u30eb \u306b\u914d\u5217\u8981\u7d20\u3092\u9023\u7d50\u3059\u308b\u95a2\u6570 joinFun \u3092\u5b9f\u88c5\u3057\u305f\uff08VBA\u7d44\u307f\u8fbc\u307f\u95a2\u6570 Join \u76f8\u5f53\uff09\u3002\u3053\u308c\u3082\u554f\u984c\u306a\u3044\u3002\n\u30e9\u30e0\u30c0\u5f0f\u3000\\a b -> [a] : map (a:) b \u3000\u306e\u5185\u90e8\u306b\u3042\u308bmap (a:) b \u304c\u554f\u984c\u306b\u306a\u3063\u305f\u3002\u30a4\u30f3\u30e9\u30a4\u30f3\u3067\u306f\u66f8\u3051\u305a\u3001\u4ee5\u4e0b\u306e\u95a2\u6570\u3092\u5b9f\u88c5\u3059\u308b\u3053\u3068\u306b\u306a\u3063\u305f\u3002\n\n' \\a b -> [a] : map (a:) b \u306e\u3046\u3061\u3001\n' map (a:) b \u306e\u90e8\u5206\nFunction consMap(ByRef a As Variant, ByRef v As Variant) As Variant\n    consMap = mapF(p_cons(a), v)\nEnd Function\n    Function p_consMap(\u7565\n\n\u3053\u308c\u3089\u3092\u6e96\u5099\u3057\u3066\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u30d7\u30ed\u30b0\u30e9\u30e0\u3092\u66f8\u3044\u305f\u30023\na = Array(\"A\", \"B\", \"C\", \"D\", \"E\")\n'   [a] : map (a:) b  \u306e\u90e8\u5206\nf = p_cons(p_makeSole, p_consMap(ph_1, ph_2))         ' \u30dd\u30a4\u30f3\u30c81\n'   foldr (++) []  \u3068  scanr f []  \u306e\u5b9f\u884c\nm = foldr(p_catV, Array(), scanr(f, Array(), a))      ' \u30dd\u30a4\u30f3\u30c82\n'   \u6587\u5b57\u5217\u3068\u3057\u3066\u8868\u793a\nprintM mapF(p_join(, \"\"), m)\n'A  AB  ABC  ABCD  ABCDE  B  BC  BCD  BCDE  C  CD  CDE  D  DE  E\n\n\u300c\u30dd\u30a4\u30f3\u30c81\u300d\u306e\u3068\u3053\u308d\u3067\u3001\u7279\u5316\u3057\u305f\u95a2\u6570consMap\u3092\u7d44\u307f\u8fbc\u3093\u3067\u3044\u308b\u3002\u300c\u30dd\u30a4\u30f3\u30c82\u300d\u306e\u3068\u3053\u308d\u3067\u306f\u3001foldr\u3068scanr\u306b\u5b9f\u5f15\u6570\u3092\u4e0e\u3048\u3066\u5b9f\u969b\u306b\u8a55\u4fa1\u3057\u3066\u3057\u307e\u3063\u3066\u3044\u3066\u3001\u4e8b\u524d\u306b\u3072\u3068\u307e\u3068\u307e\u308a\u306e\u95a2\u6570\u3068\u3057\u3066\u5b9a\u7fa9\u3067\u304d\u3066\u3044\u306a\u3044\u3002\nVBAHaskell\u3067\u5b9f\u88c5\u3057\u3066\u3044\u308b\u95a2\u6570\u5408\u6210\u306f\u30b9\u30b3\u30fc\u30d7\u304c\u30d5\u30e9\u30c3\u30c8\u3067\u3001\u3059\u3079\u3066\u306e\u30d7\u30ec\u30fc\u30b9\u30db\u30eb\u30c0\u306b\u5b9f\u5f15\u6570\u3092\u6e21\u3057\u3066\u4e00\u6589\u306b\u8a55\u4fa1\u3059\u308b\u3053\u3068\u3057\u304b\u3067\u304d\u306a\u3044\u306e\u304c\u554f\u984c\u3067\u3001\u3053\u306e\u307e\u307e\u3067\u306f\u672c\u7269\u306e\u30e9\u30e0\u30c0\u5f0f\u304b\u3089\u306f\u307b\u3069\u9060\u3044\u3002\nVBAHaskell\u306e\u7d39\u4ecb \u305d\u306e14\uff08\u5909\u6570\u306e\u30e0\u30fc\u30d6\uff09\nVBAHaskell\u306e\u7d39\u4ecb \u305d\u306e13\uff08\u30d7\u30ec\u30fc\u30b9\u30db\u30eb\u30c0\u306e\u8ffd\u52a0\uff1a_1\u3068_2\uff09\nVBAHaskell\u306e\u7d39\u4ecb \u305d\u306e1\uff08\u6700\u521d\u306fmapF\uff09\n\n\n\n\nHaskell_0_declare\u30e2\u30b8\u30e5\u30fc\u30eb \u306b\u5ba3\u8a00\u00a0\u21a9\n\n\nHaskell_4_vector\u30e2\u30b8\u30e5\u30fc\u30eb\u3067\u5b9f\u88c5\u00a0\u21a9\n\n\n\u30c6\u30b9\u30c8\u30e2\u30b8\u30e5\u30fc\u30eb \u306b \u30b5\u30f3\u30d7\u30ebsegmentsTest \u3068\u3057\u3066\u8ffd\u52a0\u00a0\u21a9\n\n\n\n\u300c[\u95a2\u6570\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u5b9f\u8df5\u5165\u9580](http://www.amazon.co.jp/%E9%96%A2%E6%95%B0%E3%83%97%E3%83%AD%E3%82%B0%E3%83%A9%E3%83%9F%E3%83%B3%E3%82%B0%E5%AE%9F%E8%B7%B5%E5%85%A5%E9%96%80-%E2%94%80%E2%94%80%E7%B0%A1%E6%BD%94%E3%81%A7%E3%80%81%E6%AD%A3%E3%81%97%E3%81%84%E3%82%B3%E3%83%BC%E3%83%89%E3%82%92%E6%9B%B8%E3%81%8F%E3%81%9F%E3%82%81%E3%81%AB-WEB-PRESS-plus/dp/4774169269)\u300d\u306b\u8a18\u8f09\u3055\u308c\u3066\u3044\u308b\u554f\u984c\u306b\u3064\u3044\u3066\u306e\u89e3\u8aac\u8a18\u4e8b\u3092\u5225\u306e\u3068\u3053\u308d\u3067\u898b\u304b\u3051\u305f\u3002\u89e3\u8aac\u304c\u9762\u767d\u304b\u3063\u305f\u3057\u3001VBAHaskell\u3067\u5b9f\u88c5\u3092\u8a66\u307f\u308b\u306e\u306b\u624b\u9803\u3060\u3063\u305f\u306e\u3067\u3084\u3063\u3066\u307f\u305f\u304c\u3001\u3042\u307e\u308a\u3044\u3044\u7d50\u679c\u306b\u306f\u306a\u3089\u305a\u8ab2\u984c\u304c\u6b8b\u3063\u305f\u3002\n\n`segments` \u3068\u3044\u3046\u95a2\u6570\u3067\u3001\u5f15\u6570\u306b\u6587\u5b57\u5217\u3092\u6e21\u3059\u3068\u90e8\u5206\u6587\u5b57\u5217\u306e\u30ea\u30b9\u30c8\u304c\u53d6\u308a\u51fa\u305b\u308b\u3002\u4f8b\u3048\u3070 \"ABC\" \u306b\u5bfe\u3057\u3066\u3001[\"A\",\"AB\",\"ABC\",\"B\",\"BC\",\"C\"] \u3092\u51fa\u529b\u3059\u308b\u3082\u306e\u3060\u3002\n\u672c\u306b\u8f09\u3063\u3066\u3044\u308b\u5b9f\u88c5\u306f\u4ee5\u4e0b\u306e\u3082\u306e\u3089\u3057\u3044\u3002\n\n```hs\nsegments :: [a] -> [[a]]\nsegments = foldr (++) [] . scanr (\\a b -> [a] : map (a:) b) []\n```\n\n\u69cb\u6210\u8981\u7d20\u3092\u307e\u3068\u3081\u308b\u3068\u3053\u3046\u306a\u308b\u3002\n\n|     \u8a00\u8a9e\u8981\u7d20       |  VBAHaskell          |\u4eca\u56de\u306e\u5b9f\u88c5 |\n|:------------------|:------------ |:--------|\n|foldr, scanr     | foldr, scanr [^1] | - |                       \n|\u30ea\u30b9\u30c8\u7d50\u5408 (++)   | catV \u95a2\u6570 [^2]   | - |\n|\u30ea\u30b9\u30c8\u751f\u6210\u6f14\u7b97(:) |     \u306a\u3057        | \u65b0\u898f\u4f5c\u6210|\n|\u95a2\u6570\u5408\u6210 .        | \u4e0d\u5341\u5206          | \u51e6\u7406\u3092\u5206\u3051\u308b |\n|\u30e9\u30e0\u30c0\u5f0f \\        |  \u4e0d\u5341\u5206      |\u72ec\u7acb\u3057\u305f\u95a2\u6570\u306b\u3059\u308b |\n\n\u3053\u308c\u3092\u5b9f\u88c5\u3059\u308b\u305f\u3081\u306b\u3084\u3063\u305f\u3053\u3068\u306f\u4ee5\u4e0b\u306e\u901a\u308a\u3060\u304c\u3001VBAHaskell\u306e\u5408\u6210\u95a2\u6570\u306e\u4ed5\u7d44\u307f\u3067\u306f\u4eca\u56de\u306e\u554f\u984c\u306b\u5bfe\u5fdc\u3059\u308b\u306b\u306f\u4e0d\u5341\u5206\u3060\u3068\u3044\u3046\u3053\u3068\u304c\u308f\u304b\u3063\u305f\u3002\n\n1. Haskell\u3067`cons`\u3068\u547c\u3070\u308c\u3066\u3044\u308b\u30ea\u30b9\u30c8\u751f\u6210\u6f14\u7b97\u3092\u7528\u610f\u3057\u3066\u3044\u306a\u304b\u3063\u305f\u306e\u3067\u3001\u6a19\u6e96\u95a2\u6570\u3068\u3057\u3066[Haskell_4_vector.bas](https://github.com/mYmd/VBA/blob/master/Haskell_4_vector.bas)\u30e2\u30b8\u30e5\u30fc\u30eb\u306b `cons` \u95a2\u6570\u3092\u8ffd\u52a0\u3057\u305f\u3002\u3053\u308c\u306f\u5225\u306b\u554f\u984c\u3067\u306f\u306a\u3044\u3002\n2. Haskell\u306e\u6587\u5b57\u5217\u306f\u6587\u5b57\u306e\u30ea\u30b9\u30c8\u3060\u304c\u3001VBA\u306f\u305d\u3046\u3067\u306f\u306a\u3044\u305f\u3081\u3001\u7d50\u679c\u8868\u793a\u306e\u3068\u304d\u914d\u5217\u3092\u6587\u5b57\u5217\u306b\u5909\u63db\u3059\u308b\u5fc5\u8981\u304c\u3042\u308b\u3002`foldl`\u3092\u4f7f\u3063\u3066\u3084\u308c\u3070\u3067\u304d\u308b\u304c\u3001\u52b9\u7387\u9762\u3082\u8003\u3048\u3066 [StdFun\u30e2\u30b8\u30e5\u30fc\u30eb](https://github.com/mYmd/VBA/blob/master/Haskell_2_stdFun.bas) \u306b\u914d\u5217\u8981\u7d20\u3092\u9023\u7d50\u3059\u308b\u95a2\u6570 `joinFun` \u3092\u5b9f\u88c5\u3057\u305f\uff08VBA\u7d44\u307f\u8fbc\u307f\u95a2\u6570 `Join` \u76f8\u5f53\uff09\u3002\u3053\u308c\u3082\u554f\u984c\u306a\u3044\u3002\n3. \u30e9\u30e0\u30c0\u5f0f\u3000`\\a b -> [a] : map (a:) b` \u3000\u306e\u5185\u90e8\u306b\u3042\u308b`map (a:) b` \u304c\u554f\u984c\u306b\u306a\u3063\u305f\u3002\u30a4\u30f3\u30e9\u30a4\u30f3\u3067\u306f\u66f8\u3051\u305a\u3001\u4ee5\u4e0b\u306e\u95a2\u6570\u3092\u5b9f\u88c5\u3059\u308b\u3053\u3068\u306b\u306a\u3063\u305f\u3002\n\n```vbnet\n' \\a b -> [a] : map (a:) b \u306e\u3046\u3061\u3001\n' map (a:) b \u306e\u90e8\u5206\nFunction consMap(ByRef a As Variant, ByRef v As Variant) As Variant\n    consMap = mapF(p_cons(a), v)\nEnd Function\n    Function p_consMap(\u7565\n```\n\u3053\u308c\u3089\u3092\u6e96\u5099\u3057\u3066\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u30d7\u30ed\u30b0\u30e9\u30e0\u3092\u66f8\u3044\u305f\u3002[^3]\n\n```vbnet\na = Array(\"A\", \"B\", \"C\", \"D\", \"E\")\n'   [a] : map (a:) b  \u306e\u90e8\u5206\nf = p_cons(p_makeSole, p_consMap(ph_1, ph_2))         ' \u30dd\u30a4\u30f3\u30c81\n'   foldr (++) []  \u3068  scanr f []  \u306e\u5b9f\u884c\nm = foldr(p_catV, Array(), scanr(f, Array(), a))      ' \u30dd\u30a4\u30f3\u30c82\n'   \u6587\u5b57\u5217\u3068\u3057\u3066\u8868\u793a\nprintM mapF(p_join(, \"\"), m)\n'A  AB  ABC  ABCD  ABCDE  B  BC  BCD  BCDE  C  CD  CDE  D  DE  E\n```\n\u300c\u30dd\u30a4\u30f3\u30c81\u300d\u306e\u3068\u3053\u308d\u3067\u3001\u7279\u5316\u3057\u305f\u95a2\u6570`consMap`\u3092\u7d44\u307f\u8fbc\u3093\u3067\u3044\u308b\u3002\u300c\u30dd\u30a4\u30f3\u30c82\u300d\u306e\u3068\u3053\u308d\u3067\u306f\u3001`foldr`\u3068`scanr`\u306b\u5b9f\u5f15\u6570\u3092\u4e0e\u3048\u3066\u5b9f\u969b\u306b\u8a55\u4fa1\u3057\u3066\u3057\u307e\u3063\u3066\u3044\u3066\u3001\u4e8b\u524d\u306b\u3072\u3068\u307e\u3068\u307e\u308a\u306e\u95a2\u6570\u3068\u3057\u3066\u5b9a\u7fa9\u3067\u304d\u3066\u3044\u306a\u3044\u3002\nVBAHaskell\u3067\u5b9f\u88c5\u3057\u3066\u3044\u308b\u95a2\u6570\u5408\u6210\u306f\u30b9\u30b3\u30fc\u30d7\u304c\u30d5\u30e9\u30c3\u30c8\u3067\u3001\u3059\u3079\u3066\u306e\u30d7\u30ec\u30fc\u30b9\u30db\u30eb\u30c0\u306b\u5b9f\u5f15\u6570\u3092\u6e21\u3057\u3066\u4e00\u6589\u306b\u8a55\u4fa1\u3059\u308b\u3053\u3068\u3057\u304b\u3067\u304d\u306a\u3044\u306e\u304c\u554f\u984c\u3067\u3001\u3053\u306e\u307e\u307e\u3067\u306f\u672c\u7269\u306e\u30e9\u30e0\u30c0\u5f0f\u304b\u3089\u306f\u307b\u3069\u9060\u3044\u3002\n\n[VBAHaskell\u306e\u7d39\u4ecb \u305d\u306e14\uff08\u5909\u6570\u306e\u30e0\u30fc\u30d6\uff09](http://qiita.com/mmYYmmdd/items/5f5ef2ff2d48489dc0cb)\n[VBAHaskell\u306e\u7d39\u4ecb \u305d\u306e13\uff08\u30d7\u30ec\u30fc\u30b9\u30db\u30eb\u30c0\u306e\u8ffd\u52a0\uff1a_1\u3068_2\uff09](http://qiita.com/mmYYmmdd/items/2988b653c3dc3d5e01e0)\n[VBAHaskell\u306e\u7d39\u4ecb \u305d\u306e1\uff08\u6700\u521d\u306fmapF\uff09](http://qiita.com/mmYYmmdd/items/c731edf943acc0a0ebe9)\n\n[^1]: [Haskell_0_declare\u30e2\u30b8\u30e5\u30fc\u30eb](http://qiita.com/mmYYmmdd/items/2988b653c3dc3d5e01e0) \u306b\u5ba3\u8a00\n[^2]: [Haskell_4_vector\u30e2\u30b8\u30e5\u30fc\u30eb](https://github.com/mYmd/VBA/blob/master/Haskell_4_vector.bas)\u3067\u5b9f\u88c5\n[^3]: [\u30c6\u30b9\u30c8\u30e2\u30b8\u30e5\u30fc\u30eb](https://github.com/mYmd/VBA/blob/master/test_module.bas) \u306b \u30b5\u30f3\u30d7\u30eb`segmentsTest` \u3068\u3057\u3066\u8ffd\u52a0\n", "tags": ["VBA", "Haskell"]}