{"context": " More than 1 year has passed since last update.\n\nInstall\n\n\u516c\u5f0f\u3088\u308aOpenAM\u306ewar\u30d5\u30a1\u30a4\u30eb\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3002\n\u4f9d\u5b58\u30d1\u30c3\u30b1\u30fc\u30b8\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\nyum install java-1.6.0-openjdk\nyum install tomcat6 tomcat6-webapps tomcat6-admin-webapps\n\n\nhostname\u306e\u8a2d\u5b9a\n\n\u203b\u3053\u3053\u3068\u5f8c\u8ff0\u306eOpenAM\u8a2d\u5b9a\u306ehostname\u304c\u4e00\u81f4\u3057\u3066\u3044\u306a\u3044\u3068\u30a8\u30e9\u30fc\u3067\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u51fa\u6765\u306a\u3044\u306e\u3067\u6ce8\u610f\u3002\n$ cat /etc/sysconfig/networkk\n\nopenam-test.example.com\n\n\nSELinux\u3092Disabled\n\ncat /etc/sysconfig/selinux\nSELINUX=disabled\n\n\ntomcat\u306emanager\u30e6\u30fc\u30b6\u8ffd\u52a0\n\nvim /etc/tomcat6/tomcat-users.xml\n\n# \u4ee5\u4e0b\u3092\u8ffd\u52a0\n<role rolename=\"manager\"/>\n  <user username=\"admin\" password=\"password\" roles=\"manager\"/>\n\n\n\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u306e\u66f8\u304d\u8fbc\u307f\u304c\u51fa\u6765\u308b\u3088\u3046\u306b\u3059\u308b\u3002\n\nchown -R root:tomcat /usr/share/tomcat6\n\n\nexample.com:8080\u306b\u30a2\u30af\u30bb\u30b9\u3002\n\u30ab\u30b9\u30bf\u30e0\u8a2d\u5b9a\u304b\u3089\u8a2d\u5b9a\u3092\u3057\u3066\u3044\u304f\n\u30c7\u30d5\u30a9\u30eb\u30c8\u30e6\u30fc\u30b6\npass: password\n\u30dd\u30ea\u30b7\u30fc\u30a8\u30fc\u30b8\u30a7\u30f3\u30c8\npass: agentpassword\n\n\u8a2d\u5b9a\u30b9\u30c8\u30a2\u306e\u8a73\u7d30 \u7de8\u96c6...\nSSL \u304c\u6709\u52b9 \n\u30db\u30b9\u30c8\u540d \n\u5f85\u6a5f\u30dd\u30fc\u30c8 \n\u30eb\u30fc\u30c8\u30b5\u30d5\u30a3\u30c3\u30af\u30b9 \n\u30e6\u30fc\u30b6\u30fc\u540d \n\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u540d   \u3044\u3044\u3048 \nlocalhost \n50389 \ndc=example,dc=com \ncn=Directory Manager \n/usr/share/tomcat6/OpenAM-11.0.0\n\u30e6\u30fc\u30b6\u30fc\u30b9\u30c8\u30a2\u306e\u8a73\u7d30 \u7de8\u96c6...\nSSL \u304c\u6709\u52b9\n\u30db\u30b9\u30c8\u540d\n\u5f85\u6a5f\u30dd\u30fc\u30c8\n\u30eb\u30fc\u30c8\u30b5\u30d5\u30a3\u30c3\u30af\u30b9\n\u30e6\u30fc\u30b6\u30fc\u540d\n\u30e6\u30fc\u30b6\u30fc\u30c7\u30fc\u30bf\u30b9\u30c8\u30a2\u30bf\u30a4\u30d7 \u3044\u3044\u3048\n172.16.42.120\n389\ndc=example,dc=com\ncn=Directory Manager\nOpenDJ\n\u30b5\u30a4\u30c8\u8a2d\u5b9a\u306e\u8a73\u7d30 \u7de8\u96c6...\n\u3053\u306e\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306f\u3001\u30ed\u30fc\u30c9\u30d0\u30e9\u30f3\u30b5\u306e\u80cc\u5f8c\u306b\u306f\u8a2d\u5b9a\u3055\u308c\u307e\u305b\u3093\u3002\n\n\n\u30a8\u30e9\u30fc\u304c\u51fa\u305f\u3089\u8a2d\u5b9a\u7528\u306e\u30d5\u30a9\u30eb\u30c0\u304c\u65e2\u306b\u51fa\u6765\u3066\u3044\u308b\u306e\u3067\u4e00\u5ea6\u524a\u9664\u3057\u3066\u304b\u3089\u518d\u5ea6\u5165\u308c\u306a\u304a\u3059\n\nGoogleApps\u3067SSO\u9023\u643a\n\n\u65b9\u91dd\n\nGoogle Apps\u3068LDAP\u306e\u30a2\u30ab\u30a6\u30f3\u30c8\u3092\u3072\u3082\u3065\u3051\u308b\n\u57fa\u672c\u7684\u306bLDAP\u306b\u3042\u308b\u30a2\u30ab\u30a6\u30f3\u30c8\u3092\u5143\u306bGoogle Apps\u306bprovisioning\u3059\u308b\nSSO\u304c\u5fc5\u8981\u306a\u793e\u5185\u30b5\u30a4\u30c8\u306b\u3064\u3044\u3066\u306fapache\u3084nginx\u306bwebagent\u3092\u5165\u308c\u308b\n\u65e2\u306bGoogle Apps\u3068\u9023\u643a\u3067\u304d\u3066\u3044\u308b\u30b7\u30b9\u30c6\u30e0(Gitlab\u3001Jenkins)\u306b\u3064\u3044\u3066\u306f\u305d\u306e\u307e\u307e\u7d99\u7d9a\u3002\u30ed\u30b0\u30a4\u30f3\u306e\u969b\u306bOpenAM\u306b\u98db\u3070\u3055\u308c\u308b\u3060\u308d\u3046\u304b\u3089\u554f\u984c\u306a\u3057\u3002\nGoogleApps\u3067\u30d1\u30b9\u30ef\u30fc\u30c9\u5909\u66f4\u3057\u3088\u3046\u3068\u3059\u308b\u3068OpenAM\u306b\u98db\u3070\u3055\u308c\u308b\u4ed5\u7d44\u307f\u3002\n\u30e6\u30fc\u30b6\u304b\u3089\u898b\u308c\u3070GoogleApps\u306e\u30e6\u30fc\u30b6\u3068\u30d1\u30b9\u30ef\u30fc\u30c9\u3067\u30ed\u30b0\u30a4\u30f3\u3057\u3066\u308b\u3088\u3046\u306b\u898b\u3048\u308c\u3070OK\u3002\nOpenAM\u306e\u30c7\u30fc\u30bf\u30b9\u30c8\u30a2\u3092\u3069\u3046\u3059\u308b\u304b\u3002\n\n\nOpenAM\u8a2d\u5b9a\n\u53c2\u7167 :SIOS \"OSS\u3088\u308d\u305a\" \u30d6\u30ed\u30b0\u51fa\u5f35\u6240: OpenAM \u3092\u4f7f\u3063\u3066\u30b7\u30f3\u30b0\u30eb\u30b5\u30a4\u30f3\u30aa\u30f3\u3092\u69cb\u7bc9\u3059\u308b (Google Apps \u9023\u643a\u7de8)\n\n\u30db\u30b9\u30c8\u30a2\u30a4\u30c7\u30f3\u30c6\u30a3\u30c6\u30a3\u30fc\u30d7\u30ed\u30d0\u30a4\u30c0\u3092\u8ffd\u52a0\n\u7ba1\u7406\u8005\u753b\u9762\u300c\u5171\u901a\u30bf\u30b9\u30af\u300d->\u30db\u30b9\u30c8\u30a2\u30a4\u30c7\u30f3\u30c6\u30a3\u30c6\u30a3\u30fc\u30d7\u30ed\u30d0\u30a4\u30c0\u306e\u4f5c\u6210\n\n\u30e1\u30bf\u30c7\u30fc\u30bf\n\nhttp://openam-test.example.com:8080/openam\n\n\u30c8\u30e9\u30b9\u30c8\u30b5\u30fc\u30af\u30eb\n\nexample_cot\n\n\u9375\ntest\n\n\u300c\u30b7\u30f3\u30b0\u30eb\u30b5\u30a4\u30f3\u30aa\u30f3\u7528\u306e Google Apps \u306e\u8a2d\u5b9a\u300d\n\u3088\u308atako.asia\u3092\u65b0\u3057\u3044\u5024\u306b\u8ffd\u52a0->\u4f5c\u6210\u3092\u62bc\u4e0b\u3057SSO\u7528\u306eURL\u3092\u8868\u793a\u3055\u305b\u308b\u3002\n\n\u30b5\u30a4\u30f3\u30a4\u30f3\u30da\u30fc\u30b8\u306eURL\n\nhttp://openam-test.example.com:8080/openam/SSORedirect/metaAlias/idp\n\n\u30b5\u30a4\u30f3\u30a2\u30a6\u30c8\u30da\u30fc\u30b8\u306eURL\n\nhttp://openam-test.example.com:8080/openam/UI/Logout?goto=http://openam-test.example.com:8080/openam\n\n\u30d1\u30b9\u30ef\u30fc\u30c9\u5909\u66f4\u306eURL\n\nhttp://openam-test.example.com:8080/openam/idm/EndUser\n\n\u691c\u8a3c\u8a3c\u660e\u66f8\n\n-----BEGIN CERTIFICATE-----\nMIICQDCCAakCBEeNB0swDQYJKoZIhvcNAQEEBQAwZzELMAkGA1UEBhMCVVMxEzARBgNVBAgTCkNh\nbGlmb3JuaWExFDASBgNVBAcTC1NhbnRhIENsYXJhMQwwCgYDVQQKEwNTdW4xEDAOBgNVBAsTB09w\n\u301c\u4e2d\u7565\u301c\nQzPKTPTYi9upbFXlrAKMwtFf2OW4yvGWWvlcwcNSZJmTJ8ARvVYOMEVNbsT4OFcfu2/PeYoAdiDA\ncGy/F2Zuj8XJJpuQRSE6PtQqBuDEHjjmOQJ0rV/r8mO1ZCtHRhpZ5zYRjhRC9eCbjx9VrFax0JDC\n/FfwWigmrW0Y0Q==\n-----END CERTIFICATE-----\n\n\nSSO\u306e\u691c\u8a3c\u9805\u76ee\n\n\n\u6709\u52b9\u306b\u3059\u308b\u307e\u3048\u306b\u3084\u3089\u306a\u3051\u308c\u3070\u3044\u3051\u306a\u3044\u3053\u3068\n\nSSO\u3092\u6709\u52b9\u3059\u308b\u524d\u306b\u5b58\u5728\u3059\u308b\u30e6\u30fc\u30b6\u306e\u4f5c\u6210(\u305d\u306e\u30e6\u30fc\u30b6\u306e\u30c7\u30fc\u30bf\u306f\u3069\u3046\u306a\u308b\u304b\u306e\u691c\u8a3c)\n-> \u65e2\u306b\u5b58\u5728\u3059\u308bID\u306e\u5834\u5408\u6d88\u3048\u308b\u3068\u3044\u3046\u3053\u3068\u306f\u306a\u304b\u3063\u305f\nSSO\u3092\u6709\u52b9\u306b\u3059\u308b\u524d\u306e\u30e6\u30fc\u30b6\u306e\u30d1\u30b9\u30ef\u30fc\u30c9\u306f\u3069\u3046\u306a\u308b\u304b(\u6709\u52b9\u5f8c\u306b\u3082\u540c\u3058\u30d1\u30b9\u30ef\u30fc\u30c9\u3067\u51fa\u6765\u308b\u306e\u304b)\n-> SSO\u3092\u7d4c\u7531\u3057\u306a\u3044\u8a8d\u8a3c\u306e\u307fSSO\u304c\u6709\u52b9\u306b\u306a\u308b\u524d\u306e\u30d1\u30b9\u30ef\u30fc\u30c9\u304c\u4f7f\u308f\u308c\u308b\u3002\n\n\n\n\u6709\u52b9\u306b\u3057\u305f\u5f8c\u306b\u3084\u308b\u3053\u3068\n\nSSO\u3092\u6709\u52b9\u306b\u3059\u308b\u524d\u304b\u3089\u5b58\u5728\u3059\u308b\u30e6\u30fc\u30b6\u306e\u30c7\u30fc\u30bf\u306e\u78ba\u8a8d\n-> \u7279\u306b\u5909\u5316\u306a\u3057\u3002\u30e1\u30fc\u30eb\u3001\u30c9\u30e9\u30a4\u30d6\u306e\u30c7\u30fc\u30bf\u3082\u6d88\u3048\u306a\u3044\u3002\u4e07\u304c\u4e00\u9593\u9055\u3063\u3066\u30e6\u30fc\u30b6\u3092\u6d88\u3057\u3066\u3057\u307e\u3063\u305f\u5834\u5408\u306f\u7ba1\u7406\u8005\u30e1\u30cb\u30e5\u30fc\u306e\u5fa9\u5143\u304b\u3089\u30e6\u30fc\u30b6\u3092\u5fa9\u5143\u3059\u308b\u3053\u3068\u304c\u51fa\u6765\u308b\u3002\u6d88\u3057\u305f\u30e6\u30fc\u30b6ID\u3067\u5148\u306b\u30e6\u30fc\u30b6\u3092\u65b0\u898f\u4f5c\u6210\u3057\u3066\u3057\u307e\u3046\u3068\u5fa9\u5143\u304c\u51fa\u6765\u306a\u304f\u306a\u308b\u306e\u3067\u6ce8\u610f\u3002\nSSO\u3092\u6709\u52b9\u306b\u3057\u305f\u5f8cLDAP\u306b\u4f5c\u6210\u3057\u305f\u30e6\u30fc\u30b6\u306eprovisioning&\u30c7\u30fc\u30bf\u306e\u78ba\u8a8d\n-> ID\u3001\u540d\u524d\u7b49\u306f\u53cd\u6620\u3055\u308c\u308b\u3082\u306e\u306e\u30d1\u30b9\u30ef\u30fc\u30c9\u304c\u53cd\u6620\u3055\u308c\u305a\u4e0d\u5b8c\u5168\u3002SSO\u3092\u6709\u52b9\u306b\u3057\u305f\u3053\u3068\u306b\u3088\u308a\u30d1\u30b9\u30ef\u30fc\u30c9\u306eprovisioning\u304c\u51fa\u6765\u306a\u304f\u306a\u3063\u305f\u306e\u304b\u3082\u3057\u308c\u306a\u3044\u304c\u3001\u30e1\u30fc\u30eb\u30bd\u30d5\u30c8\u7b49\u4f7f\u3063\u3066\u308b\u5834\u5408\u3069\u3046\u306a\u308b\u3060\u308d\u3046\uff1fiPhone\u6a19\u6e96\u30e1\u30fc\u30eb\u30a2\u30d7\u30ea\u306fSSO\u306b\u5bfe\u5fdc\u3057\u3066\u306a\u3055\u305d\u3046\u306a\u306e\u3067\u7121\u7406\u304b\u3082\u3057\u308c\u306a\u3044\u304c\u3001Gmail\u30a2\u30d7\u30ea\u306a\u3089\u898b\u308c\u305d\u3046\u306a\u611f\u3058\u3060\u3063\u305f\u3002\nSSO\u3092\u4ecb\u3055\u306a\u3044\u8a8d\u8a3c\u306fLDAP\u3068GoogleApps\u3069\u3061\u3089\u306e\u30d1\u30b9\u30ef\u30fc\u30c9\u304c\u4f7f\u308f\u308c\u308b\u304b\u3002\n-> \n\n\n\n\nOpenAM\u306b\u30ab\u30b9\u30bf\u30e0\u5c5e\u6027\u3092\u8ffd\u52a0\n\u53c2\u7167: Chapter\u00a014.\u00a0Customizing Profile Attributes\n\n/usr/share/tomcat6/openam/config/xml/amUser.xml\n\u4ee5\u4e0b\u306e\u884c\u3092<User>\u5185\u306b\u8ffd\u52a0\n<AttributeSchema name=\"customAttribute\"\n    type=\"single\"\n    syntax=\"string\"\n    any=\"display\"\n    i18nKey=\"Custom Attribute\">\n</AttributeSchema>\n\n\niPlanetService\u3092\u524a\u9664\u3057\u3066\u8ffd\u52a0\u3057\u306a\u304a\u3059\n$ cd /path/to/tools/openam/bin/\n$ ssoadm\n delete-svc\n --adminid amadmin\n --password-file /tmp/pwd.txt\n --servicename iPlanetAMUserService\n\nService was deleted.\n$ ssoadm\n create-svc\n --adminid amadmin\n --password-file /tmp/pwd.txt\n --xmlfile $HOME/openam/config/xml/amUser.xml\n\nService was added.\n\n\nopenam\u306e\u8a2d\u5b9a\u3092\u5909\u66f4\u3059\u308b(LDAP\u7ba1\u7406)\n\n./opends/bin/ldapsearch -h localhost -p 50389 -D \"cn=Directory Manager\" -w password -b \"dc=example,dc=com\" ou=SelfWriteAttributes\n\ndn: ou=SelfWriteAttributes,ou=Policies,ou=default,ou=OrganizationConfig,ou=1.0,o\n u=iPlanetAMPolicyService,ou=services,o=sunamhiddenrealmdelegationservicepermiss\n ions,ou=services,dc=example,dc=com\nou: SelfWriteAttributes\nobjectClass: organizationalUnit\nobjectClass: sunServiceComponent\nobjectClass: top\nsunserviceID: NamedPolicy\nsunKeyValue:: eG1scG9saWN5PTw/eG1sIHZlcnNpb249IjEuMCIgZW5jb2Rpbmc9IlVURi04Ij8+Cj\n xQb2xpY3kgbmFtZT0iU2VsZldyaXRlQXR0cmlidXRlcyIgY3JlYXRlZGJ5PSJjbj1kc2FtZXVzZXIsb\n 3U9RFNBTUUgVXNlcnMsZGM9ZXhhbXBsZSxkYz1jb20iIGxhc3Rtb2RpZmllZGJ5PSJjbj1kc2FtZXVz\n ZXIsb3U9RFNBTUUgVXNlcnMsZGM9ZXhhbXBsZSxkYz1jb20iIGNyZWF0aW9uZGF0ZT0iMTQwOTg5NjY\n 3NjM4MiIgbGFzdG1vZGlmaWVkZGF0ZT0iMTQwOTg5NjY3NjM4MiIgcmVmZXJyYWxQb2xpY3k9ImZhbH\n NlIiBhY3RpdmU9InRydWUiID4KPFJ1bGUgbmFtZT0idXNlci1yZWFkLXJ1bGUiPgo8U2VydmljZU5hb\n WUgbmFtZT0ic3VuQU1EZWxlZ2F0aW9uU2VydmljZSIgLz4KPFJlc291cmNlTmFtZSBuYW1lPSJzbXM6\n Ly8qZGM9ZXhhbXBsZSxkYz1jb20vc3VuSWRlbnRpdHlSZXBvc2l0b3J5U2VydmljZS8xLjAvYXBwbGl\n jYXRpb24vKiIgLz4KPEF0dHJpYnV0ZVZhbHVlUGFpcj4KPEF0dHJpYnV0ZSBuYW1lPSJNT0RJRlkiIC\n 8+CjxWYWx1ZT5hbGxvdzwvVmFsdWU+CjwvQXR0cmlidXRlVmFsdWVQYWlyPgo8L1J1bGU+CjxTdWJqZ\n WN0cyBuYW1lPSJTdWJqZWN0cyIgZGVzY3JpcHRpb249IiI+CjxTdWJqZWN0IG5hbWU9ImRlbGVnYXRp\n b24tc3ViamVjdCIgdHlwZT0iQXV0aGVudGljYXRlZFVzZXJzIiBpbmNsdWRlVHlwZT0iaW5jbHVzaXZ\n lIj4KPC9TdWJqZWN0Pgo8L1N1YmplY3RzPgo8Q29uZGl0aW9ucyBuYW1lPSJBdHRyQ29uZGl0aW9uIi\n BkZXNjcmlwdGlvbj0iIj4KPENvbmRpdGlvbiBuYW1lPSJjb25kaXRpb24iIHR5cGU9IlVzZXJTZWxmQ\n 2hlY2tDb25kaXRpb24iPgo8QXR0cmlidXRlVmFsdWVQYWlyPjxBdHRyaWJ1dGUgbmFtZT0iYXR0cmli\n dXRlcyIvPjxWYWx1ZT5naXZlbm5hbWU8L1ZhbHVlPjxWYWx1ZT5zbjwvVmFsdWU+PFZhbHVlPmNuPC9\n WYWx1ZT48VmFsdWU+dXNlcnBhc3N3b3JkPC9WYWx1ZT48VmFsdWU+bWFpbDwvVmFsdWU+PFZhbHVlPn\n RlbGVwaG9uZW51bWJlcjwvVmFsdWU+PFZhbHVlPnBvc3RhbGFkZHJlc3M8L1ZhbHVlPjxWYWx1ZT5wc\n mVmZXJyZWRsb2NhbGU8L1ZhbHVlPjxWYWx1ZT5pcGxhbmV0LWFtLXVzZXItcGFzc3dvcmQtcmVzZXQt\n b3B0aW9uczwvVmFsdWU+PFZhbHVlPmlwbGFuZXQtYW0tdXNlci1wYXNzd29yZC1yZXNldC1xdWVzdGl\n vbi1hbnN3ZXI8L1ZhbHVlPjxWYWx1ZT5kZXNjcmlwdGlvbjwvVmFsdWU+PFZhbHVlPnN1bklkZW50aX\n R5U2VydmVyRGV2aWNlS2V5VmFsdWU8L1ZhbHVlPjxWYWx1ZT5zdW5JZGVudGl0eVNlcnZlckRldmljZ\n VN0YXR1czwvVmFsdWU+CjwvQXR0cmlidXRlVmFsdWVQYWlyPgo8L0NvbmRpdGlvbj4KPC9Db25kaXRp\n b25zPgo8L1BvbGljeT4=\nsunsmspriority: 0\n\ndn: ou=SelfWriteAttributes,ou=default,ou=default,ou=OrganizationConfig,ou=1.0,ou\n =sunEntitlementIndexes,ou=services,o=sunamhiddenrealmdelegationservicepermissio\n ns,ou=services,dc=example,dc=com\nou: 1409896676382=lastmodifieddate\nou: application=sunAMDelegationService\nou: lastmodifiedby=cn=dsameuser,ou=DSAME Users,dc=example,dc=com\nou: name=SelfWriteAttributes\nou: 1409896676382=creationdate\nou: |1409896676382=creationdate\nou: createdby=cn=dsameuser,ou=DSAME Users,dc=example,dc=com\nou: |1409896676382=lastmodifieddate\nou: SelfWriteAttributes\nobjectClass: organizationalUnit\nobjectClass: sunServiceComponent\nobjectClass: top\nsunserviceID: indexes\nsunKeyValue: serializable={\"creationDate\":1409896676382,\"policyName\":\"SelfWriteA\n ttributes\",\"createdBy\":\"cn=dsameuser,ou=DSAME Users,dc=example,dc=com\",\"name\":\"\n SelfWriteAttributes\",\"lastModifiedBy\":\"cn=dsameuser,ou=DSAME Users,dc=example,d\n c=com\",\"eSubject\":{\"state\":\"{\\n  \\\"className\\\": \\\"com.sun.identity.policy.plugi\n ns.AuthenticatedUsers\\\",\\n  \\\"exclusive\\\": false,\\n  \\\"name\\\": \\\"delegation-sub\n ject\\\",\\n  \\\"values\\\": []\\n}\",\"className\":\"com.sun.identity.entitlement.opensso\n .PolicySubject\"},\"lastModifiedDate\":1409896676382,\"active\":\"true\",\"className\":\"\n com.sun.identity.entitlement.opensso.OpenSSOPrivilege\",\"eCondition\":{\"state\":\"{\n \\n  \\\"className\\\": \\\"com.sun.identity.policy.plugins.UserSelfCheckCondition\\\",\\\n n  \\\"name\\\": \\\"condition\\\",\\n  \\\"properties\\\": {\\\"attributes\\\": [\\n    \\\"givenn\n ame\\\",\\n    \\\"sn\\\",\\n    \\\"cn\\\",\\n    \\\"userpassword\\\",\\n    \\\"mail\\\",\\n    \\\"t\n elephonenumber\\\",\\n    \\\"postaladdress\\\",\\n    \\\"preferredlocale\\\",\\n    \\\"ipla\n net-am-user-password-reset-options\\\",\\n    \\\"iplanet-am-user-password-reset-que\n stion-answer\\\",\\n    \\\"description\\\",\\n    \\\"sunIdentityServerDeviceKeyValue\\\",\n \\n    \\\"sunIdentityServerDeviceStatus\\\"\\n  ]}\\n}\",\"className\":\"com.sun.identity\n .entitlement.opensso.PolicyCondition\"},\"entitlement\":{\"actionsValues\":{\"MODIFY\"\n :true},\"applicationName\":\"sunAMDelegationService\",\"name\":\"user-read-rule\",\"reso\n urceNames\":[\"sms://*dc=example,dc=com/sunIdentityRepositoryService/1.0/applicat\n ion/*\"]}}\nsunxmlKeyValue: pathparentindex=/sunidentityrepositoryservice/1.0\nsunxmlKeyValue: pathparentindex=/sunidentityrepositoryservice\nsunxmlKeyValue: pathparentindex=/sunidentityrepositoryservice/1.0/application\nsunxmlKeyValue: hostindex=://dc=example,dc=com\nsunxmlKeyValue: pathparentindex=/\nsunxmlKeyValue: pathindex=/sunidentityrepositoryservice/1.0/application\nsunxmlKeyValue: subjectindex=identity:=all\n\n\niPlanetAMPolicyService\u306esunKeyValue\u3092base64\u30c7\u30b3\u30fc\u30c9\u3057\u3066\u306e\u30da\u30a2\u306b\u30ab\u30b9\u30bf\u30e0\u5c5e\u6027\u3092\u8ffd\u52a0\u3059\u308b\u3002\n\u305f\u3076\u3093\u30a8\u30f3\u30b3\u30fc\u30c9\u3057\u306a\u304a\u3057\u3066\u4fdd\u5b58\u3059\u308c\u3070OK.\nsunEntitlementIndexes\u306esunKeyValue\u306eselfwrite\u304c\u53ef\u80fd\u306a\u30ea\u30b9\u30c8\u306e\u6700\u5f8c\u306b\\n \\\"customAttribute\\\"\\n\u3092\u8ffd\u52a0\u3059\u308b\u3002\nservice tomcat6 restart\n\n\u3067\u5909\u66f4\u3092\u53cd\u6620\u3055\u305b\u308b\u3002\n\u3053\u308c\u304c\u51fa\u6765\u308c\u3070pwm\u3044\u3089\u306a\u3044\u3068\u3044\u3048\u3070\u3044\u3089\u306a\u3044\u3002\n\u793e\u5185\u306e\u4ed6\u306e\u30e6\u30fc\u30b6\u306e\u691c\u7d22\u3068\u304b\u3092\u3057\u305f\u3044\u3068\u304b\u306f\u305f\u3076\u3093\u5185\u3068\u601d\u3046\u3051\u3069\u3002\npwm\u306fpwm\u3067\u4e0d\u5b89\u5b9a\u3067\u5fae\u5999\u306a\u3068\u3053\u308d\u3082\u3042\u308b\u306e\u3067OpenAM\u3067\u307e\u304b\u306a\u3048\u308b\u306a\u3089\u305d\u3046\u3057\u305f\u3044\u3002\n\u4eca\u5f8c\u306e\u30a2\u30c3\u30d7\u30c7\u30fc\u30c8\u3082\u542b\u3081\u3066OpenAM\u306e\u65b9\u304c\u5b89\u5b9a\u3057\u3066\u3044\u308b\u3060\u308d\u3046\u3057\u3002\n\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9\u306fOpenAM\u4e38\u51fa\u3057\u3060\u3068\u9055\u548c\u611f\u304c\u3042\u308b\u306e\u3067\u30e6\u30fc\u30b6\u60c5\u5831\u7de8\u96c6\u753b\u9762\u3060\u3051\u3067\u3082Google Apps\u3082\u3057\u304f\u306fManaged\u3067\u3042\u308b\u3053\u3068\u304c\u5206\u304b\u308b\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9\u306b\u51fa\u6765\u308b\u3068\u3044\u3044\u3068\u601d\u3046\u3002\nGoogle Apps SSO\u3092\u4ecb\u3055\u306a\u3044\u3067\u76f4\u63a5Google\u306e\u30d1\u30b9\u30ef\u30fc\u30c9\u3092\u554f\u3044\u5408\u308f\u305b\u306b\u884c\u304f\u30a2\u30d7\u30ea\u3001\u4f8b\u3048\u3070web\u753b\u9762\u3092\u4f7f\u308f\u306a\u3044\u30a2\u30d7\u30ea\u306a\u3069\u306fOpenDJ\u306e\u5909\u66f4\u3068\u540c\u6642\u306bGoogle Apps\u3082provisioning\u3057\u306a\u3044\u3068\u3044\u3051\u306a\u3044\u3002\nOpenIDM\u306eGoogle Apps Connector\u3092\u4f7f\u3048\u3070OpenDJ\u3092\u30ea\u30a2\u30eb\u30bf\u30a4\u30e0\u306b\u30d7\u30ed\u30d3\u30b8\u30e7\u30f3\u51fa\u6765\u305d\u3046\u306a\u306e\u3067\u4f7f\u3063\u3066\u307f\u3088\u3046\u3002\n\n\u5197\u9577\u5316\n\nRequirement\n\nApache(LB)\nOpenAM2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\n\n\nInstall\n\n\uff11\u53f0\u76ee\u306e\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306f\u4e0a\u8a18\u901a\u308a\u306b\u666e\u901a\u306b\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\u3002\u30ed\u30fc\u30c9\u30d0\u30e9\u30f3\u30b5\u306e\u8a2d\u5b9a\u3092\u3059\u308b\u306e\u306f\uff12\u53f0\u76ee\u304b\u3089\u3002\nApache\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\nyum install httpd mod_ssl\n\n\nApache\u306e\u30ed\u30fc\u30c9\u30d0\u30e9\u30f3\u30b5\u5316\n\n\u4ee5\u4e0b\u306e\u30db\u30b9\u30c8\u7b49\u306f\u9069\u5b9c\u7f6e\u63db\u3002\n\n/etc/httpd/conf.d/virtualhost.conf\n<VirtualHost *:80>\n    ServerName \"lb.example.com\"\n    ProxyRequests off\n    ProxyPreserveHost on\n\n    <Proxy *>\n        order deny,allow\n        Allow from all\n    </Proxy>\n\n    <Proxy balancer://opensso>\n        BalancerMember http://openam-test.example.com:8080 retry=300 route=server1\n        BalancerMember http://opendj-test2.example.com:8080 retry=300 route=server2\n        ProxySet lbmethod=byrequests\n        ProxySet stickysession=APLBCOOKIE\n    </Proxy>\n\n    Header add Set-Cookie \"APLBCOOKIE=APACHE.%{BALANCER_WORKER_ROUTE}e; path=/;\" env=BALANCER_ROUTE_CHANGED\n\n    ProxyPass /       balancer://opensso/\n\n    ProxyPassReverse / http://openam-test.example.com:8080/\n    ProxyPassReverse / http://opendj-test2.example.com:8080/\n\n</VirtualHost>\n\n\n2\u53f0\u76ee\u306e\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306f\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u6642\u306b\u65e2\u5b58\u306e\u30b5\u30a4\u30c8\u306b\u8ffd\u52a0\u3059\u308b\u3088\u3046\u306b\u3059\u308b\u3002\n\u65e2\u5b58\u306e\u914d\u5099\u306b\u8ffd\u52a0\u3067\u65e2\u306b\u5b58\u5728\u3059\u308bOpenAM\u306eURL\u3092\u5165\u529b\u3059\u308b\u3002\n\u30b5\u30a4\u30c8\u540d: test\n\u30ed\u30fc\u30c9\u30d0\u30e9\u30f3\u30b5\u306eURL: http://lb.example.com:80/openam\n\n\u81ea\u52d5\u7684\u306b\u8a2d\u5b9a\u304c\u57cb\u307e\u308b\u306e\u3067\u300c\u6b21\u3078\u300d\u3092\u62bc\u3059\u3002\n\u30b5\u30a4\u30c8\u540d\u3001\u30ed\u30fc\u30c9\u30d0\u30e9\u30f3\u30b5\u306eURL\u3092\u5165\u529b\u3057\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3092\u9032\u3081\u308b\u3002\u3053\u3053\u3067\u5931\u6557\u304c\u9593\u9055\u3063\u3066\u3044\u3066\u3082\u30ed\u30b0\u30a4\u30f3\u5f8c\u300c\u8a2d\u5b9a\u300d\u2192\u300c\u30b5\u30fc\u30d0\u30fc\u304a\u3088\u3073\u30b5\u30a4\u30c8\u300d\u3088\u308a\u8a2d\u5b9a\u3092\u76f4\u305b\u308b\u306e\u3067\u554f\u984c\u306a\u3044\u3002\n\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u304c\u7d42\u4e86\u3057\u305f\u3089\u5404\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u3078\u30ed\u30b0\u30a4\u30f3\u3057\u300c\u8a2d\u5b9a\u300d\u2192\u300c\u30b5\u30fc\u30d0\u30fc\u304a\u3088\u3073\u30b5\u30a4\u30c8\u300d\u3088\u308a\u89aa\u30b5\u30a4\u30c8\u306e\u7b87\u6240\u304c\u7a7a\u6b04\u306b\u306a\u3063\u3066\u3044\u308b\u30db\u30b9\u30c8\u306e\u89aa\u30db\u30b9\u30c8\u3092\u8a2d\u5b9a\u3057\u305f\u30b5\u30a4\u30c8\u306b\u5909\u66f4\u3059\u308b\u3002\n\n## Install\n\n- [\u516c\u5f0f](https://backstage.forgerock.com/#!/downloads)\u3088\u308aOpenAM\u306ewar\u30d5\u30a1\u30a4\u30eb\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3002\n\n- \u4f9d\u5b58\u30d1\u30c3\u30b1\u30fc\u30b8\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n```\nyum install java-1.6.0-openjdk\nyum install tomcat6 tomcat6-webapps tomcat6-admin-webapps\n```\n\n- hostname\u306e\u8a2d\u5b9a\n\n\u203b\u3053\u3053\u3068\u5f8c\u8ff0\u306eOpenAM\u8a2d\u5b9a\u306ehostname\u304c\u4e00\u81f4\u3057\u3066\u3044\u306a\u3044\u3068\u30a8\u30e9\u30fc\u3067\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u51fa\u6765\u306a\u3044\u306e\u3067\u6ce8\u610f\u3002\n\n```bash\n$ cat /etc/sysconfig/networkk\n\nopenam-test.example.com\n```\n\n- SELinux\u3092Disabled\n\n```\ncat /etc/sysconfig/selinux\nSELINUX=disabled\n```\n\n- tomcat\u306emanager\u30e6\u30fc\u30b6\u8ffd\u52a0\n\n```\nvim /etc/tomcat6/tomcat-users.xml\n\n# \u4ee5\u4e0b\u3092\u8ffd\u52a0\n<role rolename=\"manager\"/>\n  <user username=\"admin\" password=\"password\" roles=\"manager\"/>\n```\n\n- \u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u306e\u66f8\u304d\u8fbc\u307f\u304c\u51fa\u6765\u308b\u3088\u3046\u306b\u3059\u308b\u3002\n\n```\nchown -R root:tomcat /usr/share/tomcat6\n```\n\n- example.com:8080\u306b\u30a2\u30af\u30bb\u30b9\u3002\n\n- \u30ab\u30b9\u30bf\u30e0\u8a2d\u5b9a\u304b\u3089\u8a2d\u5b9a\u3092\u3057\u3066\u3044\u304f\n\n- \u30c7\u30d5\u30a9\u30eb\u30c8\u30e6\u30fc\u30b6\npass: password\n\n- \u30dd\u30ea\u30b7\u30fc\u30a8\u30fc\u30b8\u30a7\u30f3\u30c8\npass: agentpassword\n\n```\n\u8a2d\u5b9a\u30b9\u30c8\u30a2\u306e\u8a73\u7d30 \u7de8\u96c6...\nSSL \u304c\u6709\u52b9 \n\u30db\u30b9\u30c8\u540d \n\u5f85\u6a5f\u30dd\u30fc\u30c8 \n\u30eb\u30fc\u30c8\u30b5\u30d5\u30a3\u30c3\u30af\u30b9 \n\u30e6\u30fc\u30b6\u30fc\u540d \n\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u540d\t\u3044\u3044\u3048 \nlocalhost \n50389 \ndc=example,dc=com \ncn=Directory Manager \n/usr/share/tomcat6/OpenAM-11.0.0\n\u30e6\u30fc\u30b6\u30fc\u30b9\u30c8\u30a2\u306e\u8a73\u7d30 \u7de8\u96c6...\nSSL \u304c\u6709\u52b9\n\u30db\u30b9\u30c8\u540d\n\u5f85\u6a5f\u30dd\u30fc\u30c8\n\u30eb\u30fc\u30c8\u30b5\u30d5\u30a3\u30c3\u30af\u30b9\n\u30e6\u30fc\u30b6\u30fc\u540d\n\u30e6\u30fc\u30b6\u30fc\u30c7\u30fc\u30bf\u30b9\u30c8\u30a2\u30bf\u30a4\u30d7\t\u3044\u3044\u3048\n172.16.42.120\n389\ndc=example,dc=com\ncn=Directory Manager\nOpenDJ\n\u30b5\u30a4\u30c8\u8a2d\u5b9a\u306e\u8a73\u7d30 \u7de8\u96c6...\n\u3053\u306e\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306f\u3001\u30ed\u30fc\u30c9\u30d0\u30e9\u30f3\u30b5\u306e\u80cc\u5f8c\u306b\u306f\u8a2d\u5b9a\u3055\u308c\u307e\u305b\u3093\u3002\n\n```\n\n\u30a8\u30e9\u30fc\u304c\u51fa\u305f\u3089\u8a2d\u5b9a\u7528\u306e\u30d5\u30a9\u30eb\u30c0\u304c\u65e2\u306b\u51fa\u6765\u3066\u3044\u308b\u306e\u3067\u4e00\u5ea6\u524a\u9664\u3057\u3066\u304b\u3089\u518d\u5ea6\u5165\u308c\u306a\u304a\u3059\n\n\n## GoogleApps\u3067SSO\u9023\u643a\n\n### \u65b9\u91dd\n\n- Google Apps\u3068LDAP\u306e\u30a2\u30ab\u30a6\u30f3\u30c8\u3092\u3072\u3082\u3065\u3051\u308b\n- \u57fa\u672c\u7684\u306bLDAP\u306b\u3042\u308b\u30a2\u30ab\u30a6\u30f3\u30c8\u3092\u5143\u306bGoogle Apps\u306bprovisioning\u3059\u308b\n- SSO\u304c\u5fc5\u8981\u306a\u793e\u5185\u30b5\u30a4\u30c8\u306b\u3064\u3044\u3066\u306fapache\u3084nginx\u306bwebagent\u3092\u5165\u308c\u308b\n- \u65e2\u306bGoogle Apps\u3068\u9023\u643a\u3067\u304d\u3066\u3044\u308b\u30b7\u30b9\u30c6\u30e0(Gitlab\u3001Jenkins)\u306b\u3064\u3044\u3066\u306f\u305d\u306e\u307e\u307e\u7d99\u7d9a\u3002\u30ed\u30b0\u30a4\u30f3\u306e\u969b\u306bOpenAM\u306b\u98db\u3070\u3055\u308c\u308b\u3060\u308d\u3046\u304b\u3089\u554f\u984c\u306a\u3057\u3002\n- GoogleApps\u3067\u30d1\u30b9\u30ef\u30fc\u30c9\u5909\u66f4\u3057\u3088\u3046\u3068\u3059\u308b\u3068OpenAM\u306b\u98db\u3070\u3055\u308c\u308b\u4ed5\u7d44\u307f\u3002\n- \u30e6\u30fc\u30b6\u304b\u3089\u898b\u308c\u3070GoogleApps\u306e\u30e6\u30fc\u30b6\u3068\u30d1\u30b9\u30ef\u30fc\u30c9\u3067\u30ed\u30b0\u30a4\u30f3\u3057\u3066\u308b\u3088\u3046\u306b\u898b\u3048\u308c\u3070OK\u3002\n- OpenAM\u306e\u30c7\u30fc\u30bf\u30b9\u30c8\u30a2\u3092\u3069\u3046\u3059\u308b\u304b\u3002\n\n### OpenAM\u8a2d\u5b9a\n\n\u53c2\u7167 :[SIOS \"OSS\u3088\u308d\u305a\" \u30d6\u30ed\u30b0\u51fa\u5f35\u6240: OpenAM \u3092\u4f7f\u3063\u3066\u30b7\u30f3\u30b0\u30eb\u30b5\u30a4\u30f3\u30aa\u30f3\u3092\u69cb\u7bc9\u3059\u308b (Google Apps \u9023\u643a\u7de8)](http://sios-oss.blogspot.jp/2012/10/openam-google-apps.html)\n\n#### \u30db\u30b9\u30c8\u30a2\u30a4\u30c7\u30f3\u30c6\u30a3\u30c6\u30a3\u30fc\u30d7\u30ed\u30d0\u30a4\u30c0\u3092\u8ffd\u52a0\n\n\u7ba1\u7406\u8005\u753b\u9762\u300c\u5171\u901a\u30bf\u30b9\u30af\u300d->\u30db\u30b9\u30c8\u30a2\u30a4\u30c7\u30f3\u30c6\u30a3\u30c6\u30a3\u30fc\u30d7\u30ed\u30d0\u30a4\u30c0\u306e\u4f5c\u6210\n\n   - \u30e1\u30bf\u30c7\u30fc\u30bf\n\n   http://openam-test.example.com:8080/openam\n\n   - \u30c8\u30e9\u30b9\u30c8\u30b5\u30fc\u30af\u30eb\n\n  example_cot\n\n   - \u9375\n   test\n\n\u300c\u30b7\u30f3\u30b0\u30eb\u30b5\u30a4\u30f3\u30aa\u30f3\u7528\u306e Google Apps \u306e\u8a2d\u5b9a\u300d\n\u3088\u308atako.asia\u3092\u65b0\u3057\u3044\u5024\u306b\u8ffd\u52a0->\u4f5c\u6210\u3092\u62bc\u4e0b\u3057SSO\u7528\u306eURL\u3092\u8868\u793a\u3055\u305b\u308b\u3002\n\n- \u30b5\u30a4\u30f3\u30a4\u30f3\u30da\u30fc\u30b8\u306eURL\n\nhttp://openam-test.example.com:8080/openam/SSORedirect/metaAlias/idp\n\n- \u30b5\u30a4\u30f3\u30a2\u30a6\u30c8\u30da\u30fc\u30b8\u306eURL\n\nhttp://openam-test.example.com:8080/openam/UI/Logout?goto=http://openam-test.example.com:8080/openam\n\n- \u30d1\u30b9\u30ef\u30fc\u30c9\u5909\u66f4\u306eURL\n\nhttp://openam-test.example.com:8080/openam/idm/EndUser\n\n\n- \u691c\u8a3c\u8a3c\u660e\u66f8\n\n```\n-----BEGIN CERTIFICATE-----\nMIICQDCCAakCBEeNB0swDQYJKoZIhvcNAQEEBQAwZzELMAkGA1UEBhMCVVMxEzARBgNVBAgTCkNh\nbGlmb3JuaWExFDASBgNVBAcTC1NhbnRhIENsYXJhMQwwCgYDVQQKEwNTdW4xEDAOBgNVBAsTB09w\n\u301c\u4e2d\u7565\u301c\nQzPKTPTYi9upbFXlrAKMwtFf2OW4yvGWWvlcwcNSZJmTJ8ARvVYOMEVNbsT4OFcfu2/PeYoAdiDA\ncGy/F2Zuj8XJJpuQRSE6PtQqBuDEHjjmOQJ0rV/r8mO1ZCtHRhpZ5zYRjhRC9eCbjx9VrFax0JDC\n/FfwWigmrW0Y0Q==\n-----END CERTIFICATE-----\n```\n\n#### SSO\u306e\u691c\u8a3c\u9805\u76ee\n\n- \u6709\u52b9\u306b\u3059\u308b\u307e\u3048\u306b\u3084\u3089\u306a\u3051\u308c\u3070\u3044\u3051\u306a\u3044\u3053\u3068\n  \n  - SSO\u3092\u6709\u52b9\u3059\u308b\u524d\u306b\u5b58\u5728\u3059\u308b\u30e6\u30fc\u30b6\u306e\u4f5c\u6210(\u305d\u306e\u30e6\u30fc\u30b6\u306e\u30c7\u30fc\u30bf\u306f\u3069\u3046\u306a\u308b\u304b\u306e\u691c\u8a3c)\n     -> \u65e2\u306b\u5b58\u5728\u3059\u308bID\u306e\u5834\u5408\u6d88\u3048\u308b\u3068\u3044\u3046\u3053\u3068\u306f\u306a\u304b\u3063\u305f\n  - SSO\u3092\u6709\u52b9\u306b\u3059\u308b\u524d\u306e\u30e6\u30fc\u30b6\u306e\u30d1\u30b9\u30ef\u30fc\u30c9\u306f\u3069\u3046\u306a\u308b\u304b(\u6709\u52b9\u5f8c\u306b\u3082\u540c\u3058\u30d1\u30b9\u30ef\u30fc\u30c9\u3067\u51fa\u6765\u308b\u306e\u304b)\n     -> SSO\u3092\u7d4c\u7531\u3057\u306a\u3044\u8a8d\u8a3c\u306e\u307fSSO\u304c\u6709\u52b9\u306b\u306a\u308b\u524d\u306e\u30d1\u30b9\u30ef\u30fc\u30c9\u304c\u4f7f\u308f\u308c\u308b\u3002\n- \u6709\u52b9\u306b\u3057\u305f\u5f8c\u306b\u3084\u308b\u3053\u3068\n  - SSO\u3092\u6709\u52b9\u306b\u3059\u308b\u524d\u304b\u3089\u5b58\u5728\u3059\u308b\u30e6\u30fc\u30b6\u306e\u30c7\u30fc\u30bf\u306e\u78ba\u8a8d\n     -> \u7279\u306b\u5909\u5316\u306a\u3057\u3002\u30e1\u30fc\u30eb\u3001\u30c9\u30e9\u30a4\u30d6\u306e\u30c7\u30fc\u30bf\u3082\u6d88\u3048\u306a\u3044\u3002\u4e07\u304c\u4e00\u9593\u9055\u3063\u3066\u30e6\u30fc\u30b6\u3092\u6d88\u3057\u3066\u3057\u307e\u3063\u305f\u5834\u5408\u306f\u7ba1\u7406\u8005\u30e1\u30cb\u30e5\u30fc\u306e\u5fa9\u5143\u304b\u3089\u30e6\u30fc\u30b6\u3092\u5fa9\u5143\u3059\u308b\u3053\u3068\u304c\u51fa\u6765\u308b\u3002\u6d88\u3057\u305f\u30e6\u30fc\u30b6ID\u3067\u5148\u306b\u30e6\u30fc\u30b6\u3092\u65b0\u898f\u4f5c\u6210\u3057\u3066\u3057\u307e\u3046\u3068\u5fa9\u5143\u304c\u51fa\u6765\u306a\u304f\u306a\u308b\u306e\u3067\u6ce8\u610f\u3002\n  - SSO\u3092\u6709\u52b9\u306b\u3057\u305f\u5f8cLDAP\u306b\u4f5c\u6210\u3057\u305f\u30e6\u30fc\u30b6\u306eprovisioning&\u30c7\u30fc\u30bf\u306e\u78ba\u8a8d\n     -> ID\u3001\u540d\u524d\u7b49\u306f\u53cd\u6620\u3055\u308c\u308b\u3082\u306e\u306e\u30d1\u30b9\u30ef\u30fc\u30c9\u304c\u53cd\u6620\u3055\u308c\u305a\u4e0d\u5b8c\u5168\u3002SSO\u3092\u6709\u52b9\u306b\u3057\u305f\u3053\u3068\u306b\u3088\u308a\u30d1\u30b9\u30ef\u30fc\u30c9\u306eprovisioning\u304c\u51fa\u6765\u306a\u304f\u306a\u3063\u305f\u306e\u304b\u3082\u3057\u308c\u306a\u3044\u304c\u3001\u30e1\u30fc\u30eb\u30bd\u30d5\u30c8\u7b49\u4f7f\u3063\u3066\u308b\u5834\u5408\u3069\u3046\u306a\u308b\u3060\u308d\u3046\uff1fiPhone\u6a19\u6e96\u30e1\u30fc\u30eb\u30a2\u30d7\u30ea\u306fSSO\u306b\u5bfe\u5fdc\u3057\u3066\u306a\u3055\u305d\u3046\u306a\u306e\u3067\u7121\u7406\u304b\u3082\u3057\u308c\u306a\u3044\u304c\u3001Gmail\u30a2\u30d7\u30ea\u306a\u3089\u898b\u308c\u305d\u3046\u306a\u611f\u3058\u3060\u3063\u305f\u3002\n  - SSO\u3092\u4ecb\u3055\u306a\u3044\u8a8d\u8a3c\u306fLDAP\u3068GoogleApps\u3069\u3061\u3089\u306e\u30d1\u30b9\u30ef\u30fc\u30c9\u304c\u4f7f\u308f\u308c\u308b\u304b\u3002\n     -> \n\n\n## OpenAM\u306b\u30ab\u30b9\u30bf\u30e0\u5c5e\u6027\u3092\u8ffd\u52a0\n\n\u53c2\u7167: [Chapter\u00a014.\u00a0Customizing Profile Attributes](http://docs.forgerock.org/en/openam/11.0.0/dev-guide/index/chap-custom-attr.html)\n\n```/usr/share/tomcat6/openam/config/xml/amUser.xml\n\u4ee5\u4e0b\u306e\u884c\u3092<User>\u5185\u306b\u8ffd\u52a0\n<AttributeSchema name=\"customAttribute\"\n    type=\"single\"\n    syntax=\"string\"\n    any=\"display\"\n    i18nKey=\"Custom Attribute\">\n</AttributeSchema>\n```\n\niPlanetService\u3092\u524a\u9664\u3057\u3066\u8ffd\u52a0\u3057\u306a\u304a\u3059\n\n```bash\n$ cd /path/to/tools/openam/bin/\n$ ssoadm\n delete-svc\n --adminid amadmin\n --password-file /tmp/pwd.txt\n --servicename iPlanetAMUserService\n \nService was deleted.\n$ ssoadm\n create-svc\n --adminid amadmin\n --password-file /tmp/pwd.txt\n --xmlfile $HOME/openam/config/xml/amUser.xml\n \nService was added.\n```\n\n- openam\u306e\u8a2d\u5b9a\u3092\u5909\u66f4\u3059\u308b(LDAP\u7ba1\u7406)\n\n```bash\n./opends/bin/ldapsearch -h localhost -p 50389 -D \"cn=Directory Manager\" -w password -b \"dc=example,dc=com\" ou=SelfWriteAttributes\n\ndn: ou=SelfWriteAttributes,ou=Policies,ou=default,ou=OrganizationConfig,ou=1.0,o\n u=iPlanetAMPolicyService,ou=services,o=sunamhiddenrealmdelegationservicepermiss\n ions,ou=services,dc=example,dc=com\nou: SelfWriteAttributes\nobjectClass: organizationalUnit\nobjectClass: sunServiceComponent\nobjectClass: top\nsunserviceID: NamedPolicy\nsunKeyValue:: eG1scG9saWN5PTw/eG1sIHZlcnNpb249IjEuMCIgZW5jb2Rpbmc9IlVURi04Ij8+Cj\n xQb2xpY3kgbmFtZT0iU2VsZldyaXRlQXR0cmlidXRlcyIgY3JlYXRlZGJ5PSJjbj1kc2FtZXVzZXIsb\n 3U9RFNBTUUgVXNlcnMsZGM9ZXhhbXBsZSxkYz1jb20iIGxhc3Rtb2RpZmllZGJ5PSJjbj1kc2FtZXVz\n ZXIsb3U9RFNBTUUgVXNlcnMsZGM9ZXhhbXBsZSxkYz1jb20iIGNyZWF0aW9uZGF0ZT0iMTQwOTg5NjY\n 3NjM4MiIgbGFzdG1vZGlmaWVkZGF0ZT0iMTQwOTg5NjY3NjM4MiIgcmVmZXJyYWxQb2xpY3k9ImZhbH\n NlIiBhY3RpdmU9InRydWUiID4KPFJ1bGUgbmFtZT0idXNlci1yZWFkLXJ1bGUiPgo8U2VydmljZU5hb\n WUgbmFtZT0ic3VuQU1EZWxlZ2F0aW9uU2VydmljZSIgLz4KPFJlc291cmNlTmFtZSBuYW1lPSJzbXM6\n Ly8qZGM9ZXhhbXBsZSxkYz1jb20vc3VuSWRlbnRpdHlSZXBvc2l0b3J5U2VydmljZS8xLjAvYXBwbGl\n jYXRpb24vKiIgLz4KPEF0dHJpYnV0ZVZhbHVlUGFpcj4KPEF0dHJpYnV0ZSBuYW1lPSJNT0RJRlkiIC\n 8+CjxWYWx1ZT5hbGxvdzwvVmFsdWU+CjwvQXR0cmlidXRlVmFsdWVQYWlyPgo8L1J1bGU+CjxTdWJqZ\n WN0cyBuYW1lPSJTdWJqZWN0cyIgZGVzY3JpcHRpb249IiI+CjxTdWJqZWN0IG5hbWU9ImRlbGVnYXRp\n b24tc3ViamVjdCIgdHlwZT0iQXV0aGVudGljYXRlZFVzZXJzIiBpbmNsdWRlVHlwZT0iaW5jbHVzaXZ\n lIj4KPC9TdWJqZWN0Pgo8L1N1YmplY3RzPgo8Q29uZGl0aW9ucyBuYW1lPSJBdHRyQ29uZGl0aW9uIi\n BkZXNjcmlwdGlvbj0iIj4KPENvbmRpdGlvbiBuYW1lPSJjb25kaXRpb24iIHR5cGU9IlVzZXJTZWxmQ\n 2hlY2tDb25kaXRpb24iPgo8QXR0cmlidXRlVmFsdWVQYWlyPjxBdHRyaWJ1dGUgbmFtZT0iYXR0cmli\n dXRlcyIvPjxWYWx1ZT5naXZlbm5hbWU8L1ZhbHVlPjxWYWx1ZT5zbjwvVmFsdWU+PFZhbHVlPmNuPC9\n WYWx1ZT48VmFsdWU+dXNlcnBhc3N3b3JkPC9WYWx1ZT48VmFsdWU+bWFpbDwvVmFsdWU+PFZhbHVlPn\n RlbGVwaG9uZW51bWJlcjwvVmFsdWU+PFZhbHVlPnBvc3RhbGFkZHJlc3M8L1ZhbHVlPjxWYWx1ZT5wc\n mVmZXJyZWRsb2NhbGU8L1ZhbHVlPjxWYWx1ZT5pcGxhbmV0LWFtLXVzZXItcGFzc3dvcmQtcmVzZXQt\n b3B0aW9uczwvVmFsdWU+PFZhbHVlPmlwbGFuZXQtYW0tdXNlci1wYXNzd29yZC1yZXNldC1xdWVzdGl\n vbi1hbnN3ZXI8L1ZhbHVlPjxWYWx1ZT5kZXNjcmlwdGlvbjwvVmFsdWU+PFZhbHVlPnN1bklkZW50aX\n R5U2VydmVyRGV2aWNlS2V5VmFsdWU8L1ZhbHVlPjxWYWx1ZT5zdW5JZGVudGl0eVNlcnZlckRldmljZ\n VN0YXR1czwvVmFsdWU+CjwvQXR0cmlidXRlVmFsdWVQYWlyPgo8L0NvbmRpdGlvbj4KPC9Db25kaXRp\n b25zPgo8L1BvbGljeT4=\nsunsmspriority: 0\n\ndn: ou=SelfWriteAttributes,ou=default,ou=default,ou=OrganizationConfig,ou=1.0,ou\n =sunEntitlementIndexes,ou=services,o=sunamhiddenrealmdelegationservicepermissio\n ns,ou=services,dc=example,dc=com\nou: 1409896676382=lastmodifieddate\nou: application=sunAMDelegationService\nou: lastmodifiedby=cn=dsameuser,ou=DSAME Users,dc=example,dc=com\nou: name=SelfWriteAttributes\nou: 1409896676382=creationdate\nou: |1409896676382=creationdate\nou: createdby=cn=dsameuser,ou=DSAME Users,dc=example,dc=com\nou: |1409896676382=lastmodifieddate\nou: SelfWriteAttributes\nobjectClass: organizationalUnit\nobjectClass: sunServiceComponent\nobjectClass: top\nsunserviceID: indexes\nsunKeyValue: serializable={\"creationDate\":1409896676382,\"policyName\":\"SelfWriteA\n ttributes\",\"createdBy\":\"cn=dsameuser,ou=DSAME Users,dc=example,dc=com\",\"name\":\"\n SelfWriteAttributes\",\"lastModifiedBy\":\"cn=dsameuser,ou=DSAME Users,dc=example,d\n c=com\",\"eSubject\":{\"state\":\"{\\n  \\\"className\\\": \\\"com.sun.identity.policy.plugi\n ns.AuthenticatedUsers\\\",\\n  \\\"exclusive\\\": false,\\n  \\\"name\\\": \\\"delegation-sub\n ject\\\",\\n  \\\"values\\\": []\\n}\",\"className\":\"com.sun.identity.entitlement.opensso\n .PolicySubject\"},\"lastModifiedDate\":1409896676382,\"active\":\"true\",\"className\":\"\n com.sun.identity.entitlement.opensso.OpenSSOPrivilege\",\"eCondition\":{\"state\":\"{\n \\n  \\\"className\\\": \\\"com.sun.identity.policy.plugins.UserSelfCheckCondition\\\",\\\n n  \\\"name\\\": \\\"condition\\\",\\n  \\\"properties\\\": {\\\"attributes\\\": [\\n    \\\"givenn\n ame\\\",\\n    \\\"sn\\\",\\n    \\\"cn\\\",\\n    \\\"userpassword\\\",\\n    \\\"mail\\\",\\n    \\\"t\n elephonenumber\\\",\\n    \\\"postaladdress\\\",\\n    \\\"preferredlocale\\\",\\n    \\\"ipla\n net-am-user-password-reset-options\\\",\\n    \\\"iplanet-am-user-password-reset-que\n stion-answer\\\",\\n    \\\"description\\\",\\n    \\\"sunIdentityServerDeviceKeyValue\\\",\n \\n    \\\"sunIdentityServerDeviceStatus\\\"\\n  ]}\\n}\",\"className\":\"com.sun.identity\n .entitlement.opensso.PolicyCondition\"},\"entitlement\":{\"actionsValues\":{\"MODIFY\"\n :true},\"applicationName\":\"sunAMDelegationService\",\"name\":\"user-read-rule\",\"reso\n urceNames\":[\"sms://*dc=example,dc=com/sunIdentityRepositoryService/1.0/applicat\n ion/*\"]}}\nsunxmlKeyValue: pathparentindex=/sunidentityrepositoryservice/1.0\nsunxmlKeyValue: pathparentindex=/sunidentityrepositoryservice\nsunxmlKeyValue: pathparentindex=/sunidentityrepositoryservice/1.0/application\nsunxmlKeyValue: hostindex=://dc=example,dc=com\nsunxmlKeyValue: pathparentindex=/\nsunxmlKeyValue: pathindex=/sunidentityrepositoryservice/1.0/application\nsunxmlKeyValue: subjectindex=identity:=all\n\n```\n\n`iPlanetAMPolicyService`\u306esunKeyValue\u3092base64\u30c7\u30b3\u30fc\u30c9\u3057\u3066<Value></Value>\u306e\u30da\u30a2\u306b\u30ab\u30b9\u30bf\u30e0\u5c5e\u6027\u3092\u8ffd\u52a0\u3059\u308b\u3002\n\u305f\u3076\u3093\u30a8\u30f3\u30b3\u30fc\u30c9\u3057\u306a\u304a\u3057\u3066\u4fdd\u5b58\u3059\u308c\u3070OK.\n\n`sunEntitlementIndexes`\u306esunKeyValue\u306eselfwrite\u304c\u53ef\u80fd\u306a\u30ea\u30b9\u30c8\u306e\u6700\u5f8c\u306b\\n \\\"customAttribute\\\"\\n\u3092\u8ffd\u52a0\u3059\u308b\u3002\n\n```\nservice tomcat6 restart\n```\n\u3067\u5909\u66f4\u3092\u53cd\u6620\u3055\u305b\u308b\u3002\n\u3053\u308c\u304c\u51fa\u6765\u308c\u3070pwm\u3044\u3089\u306a\u3044\u3068\u3044\u3048\u3070\u3044\u3089\u306a\u3044\u3002\n\u793e\u5185\u306e\u4ed6\u306e\u30e6\u30fc\u30b6\u306e\u691c\u7d22\u3068\u304b\u3092\u3057\u305f\u3044\u3068\u304b\u306f\u305f\u3076\u3093\u5185\u3068\u601d\u3046\u3051\u3069\u3002\npwm\u306fpwm\u3067\u4e0d\u5b89\u5b9a\u3067\u5fae\u5999\u306a\u3068\u3053\u308d\u3082\u3042\u308b\u306e\u3067OpenAM\u3067\u307e\u304b\u306a\u3048\u308b\u306a\u3089\u305d\u3046\u3057\u305f\u3044\u3002\n\u4eca\u5f8c\u306e\u30a2\u30c3\u30d7\u30c7\u30fc\u30c8\u3082\u542b\u3081\u3066OpenAM\u306e\u65b9\u304c\u5b89\u5b9a\u3057\u3066\u3044\u308b\u3060\u308d\u3046\u3057\u3002\n\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9\u306fOpenAM\u4e38\u51fa\u3057\u3060\u3068\u9055\u548c\u611f\u304c\u3042\u308b\u306e\u3067\u30e6\u30fc\u30b6\u60c5\u5831\u7de8\u96c6\u753b\u9762\u3060\u3051\u3067\u3082Google Apps\u3082\u3057\u304f\u306fManaged\u3067\u3042\u308b\u3053\u3068\u304c\u5206\u304b\u308b\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9\u306b\u51fa\u6765\u308b\u3068\u3044\u3044\u3068\u601d\u3046\u3002\n\nGoogle Apps SSO\u3092\u4ecb\u3055\u306a\u3044\u3067\u76f4\u63a5Google\u306e\u30d1\u30b9\u30ef\u30fc\u30c9\u3092\u554f\u3044\u5408\u308f\u305b\u306b\u884c\u304f\u30a2\u30d7\u30ea\u3001\u4f8b\u3048\u3070web\u753b\u9762\u3092\u4f7f\u308f\u306a\u3044\u30a2\u30d7\u30ea\u306a\u3069\u306fOpenDJ\u306e\u5909\u66f4\u3068\u540c\u6642\u306bGoogle Apps\u3082provisioning\u3057\u306a\u3044\u3068\u3044\u3051\u306a\u3044\u3002\nOpenIDM\u306eGoogle Apps Connector\u3092\u4f7f\u3048\u3070OpenDJ\u3092\u30ea\u30a2\u30eb\u30bf\u30a4\u30e0\u306b\u30d7\u30ed\u30d3\u30b8\u30e7\u30f3\u51fa\u6765\u305d\u3046\u306a\u306e\u3067\u4f7f\u3063\u3066\u307f\u3088\u3046\u3002\n\n## \u5197\u9577\u5316\n\n### Requirement \n- Apache(LB)\n- OpenAM2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\n\n### Install\n\n- \uff11\u53f0\u76ee\u306e\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306f\u4e0a\u8a18\u901a\u308a\u306b\u666e\u901a\u306b\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\u3002\u30ed\u30fc\u30c9\u30d0\u30e9\u30f3\u30b5\u306e\u8a2d\u5b9a\u3092\u3059\u308b\u306e\u306f\uff12\u53f0\u76ee\u304b\u3089\u3002\n- Apache\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n```\nyum install httpd mod_ssl\n```\n\n- Apache\u306e\u30ed\u30fc\u30c9\u30d0\u30e9\u30f3\u30b5\u5316\n\n\u4ee5\u4e0b\u306e\u30db\u30b9\u30c8\u7b49\u306f\u9069\u5b9c\u7f6e\u63db\u3002\n\n```/etc/httpd/conf.d/virtualhost.conf\n<VirtualHost *:80>\n    ServerName \"lb.example.com\"\n    ProxyRequests off\n    ProxyPreserveHost on\n\n    <Proxy *>\n        order deny,allow\n        Allow from all\n    </Proxy>\n\n    <Proxy balancer://opensso>\n        BalancerMember http://openam-test.example.com:8080 retry=300 route=server1\n        BalancerMember http://opendj-test2.example.com:8080 retry=300 route=server2\n        ProxySet lbmethod=byrequests\n        ProxySet stickysession=APLBCOOKIE\n    </Proxy>\n\n    Header add Set-Cookie \"APLBCOOKIE=APACHE.%{BALANCER_WORKER_ROUTE}e; path=/;\" env=BALANCER_ROUTE_CHANGED\n\n    ProxyPass /       balancer://opensso/\n\n    ProxyPassReverse / http://openam-test.example.com:8080/\n    ProxyPassReverse / http://opendj-test2.example.com:8080/\n\n</VirtualHost>\n```\n\n2\u53f0\u76ee\u306e\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306f\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u6642\u306b\u65e2\u5b58\u306e\u30b5\u30a4\u30c8\u306b\u8ffd\u52a0\u3059\u308b\u3088\u3046\u306b\u3059\u308b\u3002\n\u65e2\u5b58\u306e\u914d\u5099\u306b\u8ffd\u52a0\u3067\u65e2\u306b\u5b58\u5728\u3059\u308bOpenAM\u306eURL\u3092\u5165\u529b\u3059\u308b\u3002\n\n```\n\u30b5\u30a4\u30c8\u540d: test\n\u30ed\u30fc\u30c9\u30d0\u30e9\u30f3\u30b5\u306eURL: http://lb.example.com:80/openam\n```\n\n\n\u81ea\u52d5\u7684\u306b\u8a2d\u5b9a\u304c\u57cb\u307e\u308b\u306e\u3067\u300c\u6b21\u3078\u300d\u3092\u62bc\u3059\u3002\n\u30b5\u30a4\u30c8\u540d\u3001\u30ed\u30fc\u30c9\u30d0\u30e9\u30f3\u30b5\u306eURL\u3092\u5165\u529b\u3057\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3092\u9032\u3081\u308b\u3002\u3053\u3053\u3067\u5931\u6557\u304c\u9593\u9055\u3063\u3066\u3044\u3066\u3082\u30ed\u30b0\u30a4\u30f3\u5f8c\u300c\u8a2d\u5b9a\u300d\u2192\u300c\u30b5\u30fc\u30d0\u30fc\u304a\u3088\u3073\u30b5\u30a4\u30c8\u300d\u3088\u308a\u8a2d\u5b9a\u3092\u76f4\u305b\u308b\u306e\u3067\u554f\u984c\u306a\u3044\u3002\n\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u304c\u7d42\u4e86\u3057\u305f\u3089\u5404\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u3078\u30ed\u30b0\u30a4\u30f3\u3057\u300c\u8a2d\u5b9a\u300d\u2192\u300c\u30b5\u30fc\u30d0\u30fc\u304a\u3088\u3073\u30b5\u30a4\u30c8\u300d\u3088\u308a\u89aa\u30b5\u30a4\u30c8\u306e\u7b87\u6240\u304c\u7a7a\u6b04\u306b\u306a\u3063\u3066\u3044\u308b\u30db\u30b9\u30c8\u306e\u89aa\u30db\u30b9\u30c8\u3092\u8a2d\u5b9a\u3057\u305f\u30b5\u30a4\u30c8\u306b\u5909\u66f4\u3059\u308b\u3002\n\n\n", "tags": ["OpenAM"]}