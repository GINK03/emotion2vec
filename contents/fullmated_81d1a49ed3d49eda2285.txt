{"context": "\n\n0.\u306f\u3058\u3081\u306b\n\u5f53\u8a18\u4e8b\u3067\u306f\u3001\n\u30fbHeroku\u4f7f\u3063\u305f\u3053\u3068\u306a\u3044\n\u30fbRuby\u5c11\u3057\u306f\u89e6\u3063\u305f\u3053\u3068\u3042\u308b\n\u30fbSinatra\u306f\u5168\u304f\u77e5\u3089\u306a\u3044\n\u3068\u3044\u3046\u4eba\u5411\u3051\u306b\u3001Line Messaging API\u3092\u4f7f\u3063\u305f\u30aa\u30a6\u30e0\u8fd4\u3057\u306eLineBot\uff08hoge\u3063\u3066\u6253\u3064\u3068hoge\u3063\u3066\u8fd4\u3057\u3066\u304f\u308c\u308bBot\uff09\u3092\u7c21\u5358\u306b\u4f5c\u308b\u305f\u3081\u306e\u624b\u9806\u3092\u8aac\u660e\u3057\u305f\u3044\u3068\u601d\u3044\u307e\u3059\u3002\u3068\u3044\u3046\u304b\u79c1\u304c\u305d\u3046\u3060\u3063\u305f\u306e\u3067\u5fa9\u7fd2\u3068\u3044\u3046\u5f62\u3067\u3053\u306e\u8a18\u4e8b\u3092\u6295\u7a3f\u3057\u307e\u3057\u305f\u3002\u9593\u9055\u3044\u7b49\u306e\u3054\u6307\u6458\u3001\u5feb\u304f\u627f\u308a\u307e\u3059\uff01\n\u74b0\u5883\u306fMacOSX El Capitan 10.11.6\u3067\u3059\u3002\n\u5f53\u8a18\u4e8b\u3092\u66f8\u304f\u306b\u3042\u305f\u3063\u3066\u69d8\u3005\u306a\u65b9\u306e\u8a18\u4e8b\u3092\u53c2\u8003\u306b\u3055\u305b\u3066\u3082\u3089\u3063\u305f\u306e\u3067\u3001\u305d\u308c\u305e\u308c\u306e\u624b\u9806\u3067\u53c2\u8003\u306b\u306a\u308c\u3070\u3068\u601d\u3044URL\u3092\u5404\u6240\u306b\u8cbc\u3089\u305b\u3066\u3044\u305f\u3060\u304d\u307e\u3057\u305f\u3002\u554f\u984c\u304c\u3042\u308c\u3070\u6d88\u3057\u307e\u3059\u3002\n\n1. Heroku\u306e\u6e96\u5099\u3092\u3059\u308b\nHeroku\u516c\u5f0f\u30b5\u30a4\u30c8\u304b\u3089Sign up\u3057\u3066\u30a2\u30ab\u30a6\u30f3\u30c8\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\nhttps://www.heroku.com/home\n\u6b21\u306bHeroku Command Line Interface\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3057\u3001\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\u4ee5\u4e0b\u306e\u30b5\u30a4\u30c8\u304b\u3089OS X Installer\u3092\u30af\u30ea\u30c3\u30af\u3057\u3066\u6d41\u308c\u306b\u6cbf\u3063\u3066\u3044\u3051\u3070\u5927\u4e08\u592b\u3060\u3068\u601d\u3044\u307e\u3059\u3002\u3053\u308c\u3092\u5165\u308c\u308b\u3068\u30b3\u30de\u30f3\u30c9\u30e9\u30a4\u30f3\u4e0a\u3067heroku\u306e\u64cd\u4f5c\u304c\u53ef\u80fd\u306b\u306a\u308a\u307e\u3059\u3002\nhttps://devcenter.heroku.com/articles/heroku-cli\n\u4ee5\u4e0b\u306e\u3088\u3046\u306bheroku\u30b3\u30de\u30f3\u30c9\u304c\u53e9\u3051\u3066\u3001Login\u3082\u3067\u304d\u305f\u3089OK.\n$ heroku login\nEnter your Heroku credentials.\nEmail: example@gmail.com\u2190\u767b\u9332\u3057\u305f\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u3092\u5165\u529b\nPassword (typing will be hidden):\nLogged in as example@gmail.com\n\n\u6b21\u306bHeroku\u306e\u4f5c\u696d\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\u4eca\u56de\u306e\u540d\u524d\u306ffreechat_app\u3068\u3057\u307e\u3057\u305f\u3002\n$ mkdir freechat_app\n$ cd freechat_app/\n$ heroku create\n\n\u3053\u308c\u3067Heroku\u3092\u5229\u7528\u3059\u308b\u6e96\u5099\u304c\u3067\u304d\u307e\u3057\u305f\u3002\nHeroku\u306b\u3064\u3044\u3066\u306e\u8a73\u3057\u3044\u8a18\u4e8b\u306f\u3001Arashi\u6c0f\u306e\u8a18\u4e8b\u304c\u53c2\u8003\u306b\u306a\u308a\u307e\u3059\uff01\nhttp://qiita.com/Arashi/items/b2f2e01259238235e187\n\n2. Sinatra\u3092\u4f7f\u3063\u3066\u307f\u308b\nSinatra\u306fRuby\u3067\u4f7f\u3048\u308b\u30e9\u30a4\u30d6\u30e9\u30ea\u306e\u4e00\u3064\u3067\u3042\u308a\u3001Sinatra\u3092\u4f7f\u3046\u3068\u7c21\u5358\u306bweb\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u5236\u4f5c\u304c\u3067\u304d\u307e\u3059\u3002Ruby on Rails\u3067\u306f\u6577\u5c45\u304c\u9ad8\u3044\u3068\u611f\u3058\u305f\u3089Sinatra\u3092\u8a66\u3057\u306b\u4f7f\u3063\u3066\u307f\u308b\u306e\u3082\u30a2\u30ea\u306a\u306e\u3067\u306f\u306a\u3044\u3067\u3057\u3087\u3046\u304b\u3002\n\u4eca\u56de\u4f5c\u308b\u3082\u306e\u306f\u4ee5\u4e0b\u306e\u56f3\u306eMessaging Servers\u306b\u3042\u305f\u308a\u307e\u3059\u3002(\u8a73\u3057\u304f\u306fhttps://developers.line.me/messaging-api/overview)\n\n\u3068\u3044\u3046\u308f\u3051\u3067Sinatra\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\u306a\u304a\u3001ruby\u306e\u74b0\u5883\u306f\u6574\u3063\u3066\u3044\u308b\u3082\u306e\u3068\u3057\u307e\u3059\u3002\nBundler\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u3066\u306a\u3044\u5834\u5408\u306f\u4ee5\u4e0b\u3092\u5b9f\u884c\u3002\u30d0\u30fc\u30b8\u30e7\u30f3\u3082\u78ba\u8a8d\u3057\u3066\u307f\u307e\u3057\u305f\u3002\nBundler\u306b\u3064\u3044\u3066\u8a73\u3057\u3044\u8a18\u4e8b\u306f\u3053\u3061\u3089\uff1a\nhttp://qiita.com/oshou/items/6283c2315dc7dd244aef\n$ gem install bundler\n$ bundler -v\nBundler version 1.13.7\n\n\u6b21\u306bSinatra\u3092Bundler\u7d4c\u7531\u3067\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\n$ bundle init\n$ vim Gemfile\n\n\u4ee5\u4e0b\u306e\u3088\u3046\u306aGemfile\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\nGemfile\nsource \"https://rubygems.org\"\ngem 'sinatra'\ngem 'line-bot-api'\n\n\npath\u3092\u6307\u5b9a\u3057\u3066\u30e9\u30a4\u30d6\u30e9\u30ea\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002path\u3092\u6307\u5b9a\u3059\u308b\u7406\u7531\u306f\u3001\u30b7\u30b9\u30c6\u30e0\u306bgem install\u3059\u308b\u3068\u7dba\u9e97\u3067\u306f\u306a\u3044\u306e\u3067\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3054\u3068\u306b\u5206\u3051\u305f\u65b9\u304c\u3044\u3044\u304b\u3089\u3060\u3068\u601d\u308f\u308c\u307e\u3059\u3002Sinatra\u306e\u3088\u3046\u306b\u6c4e\u7528\u7684\u306b\u4f7f\u308f\u308c\u308b\u30e9\u30a4\u30d6\u30e9\u30ea\u306a\u3089\u30b7\u30b9\u30c6\u30e0\u306b\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u3066\u3082\u3044\u3044\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u304c\u3001LINE Bot\u5236\u4f5c\u306b\u7279\u5316\u3057\u305fline-bot-api\u306a\u3093\u304b\u306f\u30b7\u30b9\u30c6\u30e0\u306b\u5165\u308c\u305f\u304f\u306a\u3044\u306f\u305a\u3067\u3059\u3002\u4ee5\u4e0b\u3092\u5b9f\u884c\u3059\u308b\u3068sinatra\u3068line-bot-api\u306b\u52a0\u3048\u3066\u3001\u4f9d\u5b58\u3059\u308b\u30e9\u30a4\u30d6\u30e9\u30ea\u3082\u4e00\u7dd2\u306b\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u3066\u304f\u308c\u307e\u3059\u3002\u3053\u308c\u306fBundler\u306e\u6a5f\u80fd\u3067\u3059\u3002\n$ bundle install --path=vendor/bundle\nFetching gem metadata from https://rubygems.org/..........\nFetching version metadata from https://rubygems.org/.\nResolving dependencies...\nInstalling line-bot-api 1.0.0\nInstalling rack 1.6.5\nInstalling tilt 2.0.5\nUsing bundler 1.13.7\nInstalling rack-protection 1.5.3\nInstalling sinatra 1.4.7\nBundle complete! 2 Gemfile dependencies, 6 gems now installed.\nBundled gems are installed into ./vendor/bundle.```\n\n\u6b21\u306bRuby\u306e\u30b3\u30fc\u30c9\u3092\u66f8\u304d\u307e\u3059\u3002\n\napp_main.rb\nrequire 'sinatra'\nrequire 'line/bot'\n\nget '/' do\n  \"Hello world\"\nend\n\n\n\u5b9f\u884c\u3057\u307e\u3059\u3002\n$ bundle exec ruby app_main.rb\n[2017-01-01 20:03:05] INFO  WEBrick 1.3.1\n[2017-01-01 20:03:05] INFO  ruby 2.3.3 (2016-11-21) [x86_64-darwin15]\n== Sinatra (v1.4.7) has taken the stage on 4567 for development with backup from WEBrick\n[2017-01-01 20:03:05] INFO  WEBrick::HTTPServer#start: pid=15617 port=4567\n\n\u3053\u306e\u72b6\u614b\u3067\nhttp://localhost:4567\n\u306b\u30a2\u30af\u30bb\u30b9\u3057\u3066Hello world\u3067\u304d\u305f\u3089OK. \n\n\u3061\u306a\u307f\u306b\u3001\n$ ruby app_main.rb\n\n\u3068\u3059\u308b\u3068\u3001\u30b7\u30b9\u30c6\u30e0\u306e\u30e9\u30a4\u30d6\u30e9\u30ea\u30d1\u30b9\u3092\u53c2\u7167\u3059\u308b\u3053\u3068\u306b\u306a\u3063\u3066\u3057\u307e\u3046\u306e\u3067\u3053\u3053\u306f\u3001\n$ bundle exec ruby app_main.rb\n\n\u3068\u3057\u307e\u3057\u305f\u3002\u3053\u3046\u3059\u308b\u3053\u3068\u3067\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306e\u30ed\u30fc\u30ab\u30eb\u74b0\u5883\u3067\u5b9f\u884c\u3067\u304d\u307e\u3059\u3002\n\n3. Line Bot\u30a2\u30ab\u30a6\u30f3\u30c8\u3092\u7528\u610f\u3059\u308b\n\u4e0b\u8a18\u30b5\u30a4\u30c8\u306e\u624b\u9806\u306b\u6cbf\u3063\u3066\u9032\u3081\u3066\u3044\u304d\u307e\u3059\u3002\nhttps://developers.line.me/messaging-api/getting-started\n\nLINE@\u30a2\u30ab\u30a6\u30f3\u30c8\u3092\u4f5c\u3063\u3066Messaging API\u3092\u5229\u7528\u53ef\u80fd\u306b\u3059\u308b\n\n\nLINE Business Center\u306e\u4e0a\u5074\u306e\u30b5\u30fc\u30d3\u30b9\u3092\u9078\u629e\u3057\u3066\u3001\u300cMessaging API\u3092\u59cb\u3081\u308b\u300d\u3092\u62bc\u3057\u307e\u3059\u3002\n\u4f1a\u793e\u540d\u3092\u6c42\u3081\u3089\u308c\u307e\u3059\u304c\u3001\u500b\u4eba\u540d\u3067OK\u3067\u3059\u3002\n\u30a2\u30ab\u30a6\u30f3\u30c8\u306b\u5fc5\u8981\u306a\u60c5\u5831\u3092\u5165\u529b\u3002\u3053\u308c\u3067LINE@\u30a2\u30ab\u30a6\u30f3\u30c8\u306e\u4f5c\u6210\u5b8c\u4e86\u3067\u3059\u3002\n\nLINE Business Center\u306e\u4e0a\u5074\u306e\u30a2\u30ab\u30a6\u30f3\u30c8\u30ea\u30b9\u30c8\u3092\u9078\u629e\u3057\u3066\u3001\u4f5c\u6210\u3057\u305f\u30a2\u30ab\u30a6\u30f3\u30c8\u306eLINE@ Manager\u306b\u79fb\u52d5\u3059\u308b\u3002\n\u300c\u30a2\u30ab\u30a6\u30f3\u30c8\u8a2d\u5b9a\u300d\u2192\u300cBot\u8a2d\u5b9a\u300d\u3067\u3001Message API\u3092\u6709\u52b9\u306b\u3059\u308b\u3002(\u78ba\u8a8d\u3092\u6c42\u3081\u3089\u308c\u307e\u3059)\n\u540c\u30da\u30fc\u30b8\u306e\u300cWebhook\u9001\u4fe1\u300d\u3092\u6709\u52b9\u306b\u3059\u308b\u3002\n\nLINE Business Center\u306e\u4e0a\u5074\u306e\u30a2\u30ab\u30a6\u30f3\u30c8\u30ea\u30b9\u30c8\u3092\u9078\u629e\u3002Line Developper\u3068\u3044\u3046\u30dc\u30bf\u30f3\u304c\u73fe\u308c\u305f\u306e\u3067\u305d\u3053\u306b\u98db\u3076\u3002\n\u30da\u30fc\u30b8\u4e0b\u306e\u65b9\u306b\u3042\u308bChannel access token\u53f3\u5074\u306eissue\u30dc\u30bf\u30f3\u3092\u62bc\u3057\u3001Channel access token\u3092\u767a\u884c\u3059\u308b\u3002\nChannel Secret\u3068Channel access token\u306f\u5f8c\u3067\u4f7f\u3046\u306e\u3067\u63a7\u3048\u3066\u304a\u304f\u3002\n\n\n4. Bot\u306bLine Messaging API\u3092\u53e9\u304b\u305b\u308b\n\u5c02\u3089\u4ee5\u4e0b\u306e\u30b5\u30a4\u30c8\u306e\u30b3\u30fc\u30c9\u3092\u5229\u7528\u3057\u307e\u3059\u3002Line\u793e\u516c\u5f0f\u306e\u3082\u306e\u3067\u3059\u3002\u5f53\u8a18\u4e8b\u306b\u5fae\u5c0f\u306b\u5909\u66f4\u3057\u305f\u30b3\u30fc\u30c9\u3092\u63b2\u8f09\u3057\u307e\u3059\u304c\u3001\u554f\u984c\u304c\u3042\u3063\u305f\u3089\u6d88\u3057\u307e\u3059\u3002\nhttps://github.com/line/line-bot-sdk-ruby\n\napp_main.rb\nrequire 'sinatra'\nrequire 'line/bot'\n\n# \u5fae\u5c0f\u5909\u66f4\u90e8\u5206\uff01\u78ba\u8a8d\u7528\u3002\nget '/' do\n  \"Hello world\"\nend\n\ndef client\n  @client ||= Line::Bot::Client.new { |config|\n    config.channel_secret = ENV[\"LINE_CHANNEL_SECRET\"]\n    config.channel_token = ENV[\"LINE_CHANNEL_TOKEN\"]\n  }\nend\n\npost '/callback' do\n  body = request.body.read\n\n  signature = request.env['HTTP_X_LINE_SIGNATURE']\n  unless client.validate_signature(body, signature)\n    error 400 do 'Bad Request' end\n  end\n\n  events = client.parse_events_from(body)\n  events.each { |event|\n    case event\n    when Line::Bot::Event::Message\n      case event.type\n      when Line::Bot::Event::MessageType::Text\n        message = {\n          type: 'text',\n          text: event.message['text']\n        }\n        client.reply_message(event['replyToken'], message)\n      when Line::Bot::Event::MessageType::Image, Line::Bot::Event::MessageType::Video\n        response = client.get_message_content(event.message['id'])\n        tf = Tempfile.open(\"content\")\n        tf.write(response.body)\n      end\n    end\n  }\n\n  \"OK\"\nend\n\n\n\u6b21\u306bProcfile\u3068config.ru\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n$ touch Procfile config.ru\n\n\nProcfile\nweb: bundle exec rackup config.ru -p $PORT\n\n\n\nconfig.ru\nrequire './app_main'\nrun Sinatra::Application\n\n\nProcfile\u306f\"Heroku\u306b\u4f55\u3092\u3055\u305b\u308b\u304b\"\u304c\u66f8\u304b\u308c\u305f\u6307\u793a\u66f8\u306e\u3088\u3046\u306a\u30d5\u30a1\u30a4\u30eb\u306e\u3088\u3046\u3067\u3059\u3002\u4eca\u56de\u306eProcfile\u306f\u3001config.ru\u306e\u8a2d\u5b9a\u306b\u5f93\u3063\u3066Rack\u3092\u8d77\u52d5\u3059\u308b\u3068\u3044\u3046\u3082\u306e\u3067\u3059\u3002\u3044\u304d\u306a\u308aru\u3068\u304bRack\u3068\u304b\u304c\u73fe\u308c\u3066\u6238\u60d1\u3044\u307e\u3059\u304c\u2026\u3002\n\nRack\u306fRuby\u306b\u3088\u308bWeb\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u958b\u767a\u306eHTTP\u9001\u53d7\u4fe1\u51e6\u7406\u3092\u62c5\u5f53\u3059\u308b\u30e2\u30b8\u30e5\u30fc\u30eb(gem)\u3067\u3001Ruby on Rails\u3092\u59cb\u3081\u3068\u3059\u308b\u591a\u304f\u306eWeb\u30d5\u30ec\u30fc\u30e0\u30ef\u30fc\u30af\u306e\u4e00\u756a\u4e0b\u306e\u30ec\u30d9\u30eb\u3067\u5229\u7528\u3055\u308c\u3066\u3044\u307e\u3059\u3002\n\u53c2\u8003\uff1aRack\u89e3\u8aac - Rack\u306e\u69cb\u9020\u3068Rack DSL\n\nRack\u306fRuby\u306e\u5404Web\u30d5\u30ec\u30fc\u30e0\u30ef\u30fc\u30af\u306b\u7d44\u307f\u8fbc\u307e\u308c\u305fHTTP\u30e2\u30b8\u30e5\u30fc\u30eb\u306e\u3088\u3046\u3067\u3059\u3002\u305d\u3046\u3044\u3048\u3070\u3055\u3063\u304dbundle install\u3057\u305f\u6642\u306b\u4f9d\u5b58\u3067\u5165\u3063\u3066\u307e\u3057\u305f\u306d\uff01\n\nHeroku\u306b\u30c7\u30d7\u30ed\u30a4\u3059\u308b\n\u4f5c\u6210\u3057\u305fWeb\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u5229\u7528\u53ef\u80fd\u306b\u3059\u308b\u305f\u3081\u306b\u305d\u308c\u3089\u3092Heroku\u306b\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3059\u308b\u3053\u3068\u3092\u3001\u30c7\u30d7\u30ed\u30a4\u3068\u8a00\u3044\u307e\u3059\u3002\u3053\u3053\u307e\u3067\u3067\u4f5c\u3063\u305f\u30d5\u30a1\u30a4\u30eb\u4e00\u89a7\u306f\u3053\u306e\u901a\u308a\u306b\u306a\u308a\u307e\u3059\u3002\n$ ls -a\n.            .bundle      Gemfile.lock app_main.rb  vendor\n..           Gemfile      Procfile     config.ru\n\nHeroku\u306e\u30c7\u30d7\u30ed\u30a4\u306b\u306fGit\u3092\u4f7f\u7528\u3059\u308b\u306e\u3067Git\u306e\u6e96\u5099\u3092\u3057\u307e\u3059\u3002\n\u307e\u305a.gitignore\u3092\u66f8\u304d\u307e\u3059\u3002Heroku\u5074\u306b\u5fc5\u8981\u306e\u306a\u3044\u30d5\u30a1\u30a4\u30eb\u3092\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3057\u306a\u3044\u305f\u3081\u3067\u3059\u3002\n\u4ee5\u4e0b\u306e\u30b5\u30a4\u30c8\u306e\u30b3\u30fc\u30c9\u306fRails\u7528\u3067\u3059\u304c\u4eca\u56de\u306f\u3053\u3061\u3089\u3092\u4f7f\u7528\u3055\u305b\u3066\u3044\u305f\u3060\u304d\u307e\u3057\u305f\u3002\nhttp://qiita.com/seri_k/items/2945dbbc3e09e651b538\n$ vim .gitignore\n\n\n.gitignore\n#----------------------------------------------------------------------------\n# This is the .gitignore file for the rails-composer repository.\n#\n# Rails Composer is an application template that creates a Rails starter app.\n#\n# The Rails Composer application template is generated by the rails_apps_composer gem:\n# https://github.com/RailsApps/rails_apps_composer\n#\n# The Rails Composer application template will create a .gitignore file for any starter app.\n# This file isn't used by the Rails Composer application template; instead the template uses:\n# https://github.com/RailsApps/rails-composer/blob/master/files/gitignore.txt\n#\n# Corrections? Improvements? Create a GitHub issue: \n# http://github.com/RailsApps/rails-composer/issues\n#----------------------------------------------------------------------------\n\n# bundler state\n/.bundle\n/vendor/bundle/\n/vendor/ruby/\n\n# minimal Rails specific artifacts\ndb/*.sqlite3\n/log/*\n/tmp/*\n\n# various artifacts\n**.war\n*.rbc\n*.sassc\n.rspec\n.redcar/\n.sass-cache\n/coverage.data\n/coverage/\n/db/*.javadb/\n/db/*.sqlite3\n/doc/api/\n/doc/app/\n/doc/features.html\n/doc/specs.html\n/public/cache\n/public/stylesheets/compiled\n/public/system/*\n/spec/tmp/*\n/cache\n/capybara*\n/capybara-*.html\n/gems\n/spec/requests\n/spec/routing\n/spec/views\n/specifications\nrerun.txt\npickle-email-*.html\n\n# If you find yourself ignoring temporary files generated by your text editor\n# or operating system, you probably want to add a global ignore instead:\n#   git config --global core.excludesfile ~/.gitignore_global\n#\n# Here are some files you may want to ignore globally:\n\n# scm revert files\n**.orig\n\n# Mac finder artifacts\n.DS_Store\n\n# Netbeans project directory\n/nbproject/\n\n# RubyMine project files\n.idea\n\n# Textmate project files\n/*.tmproj\n\n# vim artifacts\n**.swp\n\n\n\u521d\u671f\u5316\u3057\u3066add\u3057\u3066commit\u3057\u3066push\u3057\u307e\u3059\u3002\n$ git init\n$ git add -A\n$ git commit -m 'first commit'\n$ git push heroku master\n$ heroku open\n\nheroku open\u3059\u308b\u3068Hello world\u304c\u8868\u793a\u3055\u308c\u3066\u3044\u308b\u3068\u601d\u3044\u307e\u3059\u3002\u3053\u308c\u306f\u30ea\u30e2\u30fc\u30c8\u3067\u52d5\u4f5c\u3057\u305f\u3053\u3068\u3092\u610f\u5473\u3057\u3066\u3044\u307e\u3059\u3002\n\n\u6700\u5f8c\u306b\u3001Messaging API\u3092\u5229\u7528\u3059\u308b\u305f\u3081\u306e\u8a2d\u5b9a\u3092\u3057\u307e\u3059\u3002Heroku\u30b3\u30f3\u30c8\u30ed\u30fc\u30eb\u30d1\u30cd\u30eb\u304b\u3089Settings->Config Variables\u3067Reveal Config Vars\u3092\u62bc\u3057\u307e\u3059\u3002\u3059\u308b\u3068Heroku\u74b0\u5883\u4e0b\u3067\u306e\u74b0\u5883\u5909\u6570\u304c\u8868\u793a\u3055\u308c\u307e\u3059\u3002\n\u3053\u3053\u306b\u3001\u5148\u307b\u3069\u30e1\u30e2\u3063\u305fChannel Secret\u3068Channel access token\u3092\u30bb\u30c3\u30c8\u3057\u307e\u3059\u3002\nLINE_CHANNEL_SECRET   xxxxxx\u2190\u30e1\u30e2\u3063\u305fChannel Secret\nLINE_CHANNEL_TOKEN    yyyyyy\u2190\u30e1\u30e2\u3063\u305fChannel access token\n\n\u6b21\u306bLine developers\u306e\u30da\u30fc\u30b8\u306b\u884c\u304d\u3001Webhook URL\u306bAPI\u306eURL\u3092\u5165\u529b\u3057\u307e\u3059\u3002\n\u3053\u306e\u3088\u3046\u306a\u611f\u3058\u306eURL\u3060\u3068\u601d\u3044\u307e\u3059\u3002\nhttps://fathomless-waters-27765.herokuapp.com/callback\n\u3053\u308c\u3067API\u304c\u4f7f\u3048\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3057\u305f\u3002\u5148\u307b\u3069\u4f5c\u3063\u305fLINE@\u30a2\u30ab\u30a6\u30f3\u30c8\u3068\u53cb\u9054\u306b\u306a\u3063\u3066\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u6295\u3052\u307e\u3059\u3002\n\n\u51fa\u6765\u307e\u3057\u305f\uff01\n\u203b\u5348\u5f8c7:15\u307e\u3067\u53cd\u5fdc\u3057\u306a\u304b\u3063\u305f\u306e\u306fLINE Developper\u3067IP WhiteList\u3092\u8a2d\u5b9a\u3057\u3066\u3044\u305f\u305f\u3081\u3067\u3057\u305f\u3002heroku\u306e\u30ed\u30b0\u306b\u53d7\u4fe1\u30ed\u30b0\u304c\u6b8b\u3063\u3066\u3044\u305f\u306e\u3067heroku->LINE\u3067\u554f\u984c\u304c\u3042\u3063\u305f\u3053\u3068\u306f\u78ba\u5b9f\u306a\u306e\u3067\u3059\u304c\u3053\u308c\u304c\u539f\u56e0\u3060\u3068\u306f\u2026\u3002Fixie\u3067\u5f97\u305f\u30a2\u30c9\u30ec\u30b9\u3092\u5165\u529b\u3057\u305f\u306e\u306b\u901a\u3089\u306a\u304b\u3063\u305f\u3053\u3068\u304c\u8b0e\u3067\u3059\n\u30ed\u30b0\u3092\u898b\u3066\u602a\u3057\u3044\u30a8\u30e9\u30fc\u304c\u306a\u3051\u308c\u3070\u5b8c\u74a7\u3067\u3059\u306d\u3002\n$ heroku logs\n\n\u304a\u75b2\u308c\u69d8\u3067\u3057\u305f\uff01\n\n\u53c2\u8003\u8a18\u4e8b\n\nBundler\nBundler\u306e\u4f7f\u3044\u65b9\nbundle install\u3059\u308b\u3068\u304d\u306fpath\u3092\u6307\u5b9a\u3057\u3088\u3046\nrails\u3067bundle install\u3059\u308b\u6642\u306b\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u30d1\u30b9\u3092\u6307\u5b9a\nbundler\u3067gem\u3092\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3054\u3068\u306b\u7ba1\u7406\u3059\u308b\nRuby\u66f8\u304f\u306a\u3089Bundler\u4f7f\u3048\n\nHeroku\nGetting Started with Ruby on Heroku\nHeroku\u306b\u901f\u653b\u30c7\u30d7\u30ed\u30a4\u3059\u308bSinatra\u30a2\u30d7\u30ea\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u3092\u3064\u304f\u308b #1\n\nSinatra\nSinatra\u3092\u52d5\u304b\u3059\u307e\u3067\nRack\u89e3\u8aac - Rack\u306e\u69cb\u9020\u3068Rack DSL\n\nLINE API\nLINE developers(\u516c\u5f0f\u30ea\u30d5\u30a1\u30ec\u30f3\u30b9)\nLINE BusinessConnect\u306e\u6280\u8853\u8a71\n#0.\u306f\u3058\u3081\u306b\n\n\u5f53\u8a18\u4e8b\u3067\u306f\u3001\n\u30fbHeroku\u4f7f\u3063\u305f\u3053\u3068\u306a\u3044\n\u30fbRuby\u5c11\u3057\u306f\u89e6\u3063\u305f\u3053\u3068\u3042\u308b\n\u30fbSinatra\u306f\u5168\u304f\u77e5\u3089\u306a\u3044\n\u3068\u3044\u3046\u4eba\u5411\u3051\u306b\u3001Line Messaging API\u3092\u4f7f\u3063\u305f\u30aa\u30a6\u30e0\u8fd4\u3057\u306eLineBot\uff08hoge\u3063\u3066\u6253\u3064\u3068hoge\u3063\u3066\u8fd4\u3057\u3066\u304f\u308c\u308bBot\uff09\u3092\u7c21\u5358\u306b\u4f5c\u308b\u305f\u3081\u306e\u624b\u9806\u3092\u8aac\u660e\u3057\u305f\u3044\u3068\u601d\u3044\u307e\u3059\u3002\u3068\u3044\u3046\u304b\u79c1\u304c\u305d\u3046\u3060\u3063\u305f\u306e\u3067\u5fa9\u7fd2\u3068\u3044\u3046\u5f62\u3067\u3053\u306e\u8a18\u4e8b\u3092\u6295\u7a3f\u3057\u307e\u3057\u305f\u3002\u9593\u9055\u3044\u7b49\u306e\u3054\u6307\u6458\u3001\u5feb\u304f\u627f\u308a\u307e\u3059\uff01\n\n\u74b0\u5883\u306fMacOSX El Capitan 10.11.6\u3067\u3059\u3002\n\n\u5f53\u8a18\u4e8b\u3092\u66f8\u304f\u306b\u3042\u305f\u3063\u3066\u69d8\u3005\u306a\u65b9\u306e\u8a18\u4e8b\u3092\u53c2\u8003\u306b\u3055\u305b\u3066\u3082\u3089\u3063\u305f\u306e\u3067\u3001\u305d\u308c\u305e\u308c\u306e\u624b\u9806\u3067\u53c2\u8003\u306b\u306a\u308c\u3070\u3068\u601d\u3044URL\u3092\u5404\u6240\u306b\u8cbc\u3089\u305b\u3066\u3044\u305f\u3060\u304d\u307e\u3057\u305f\u3002\u554f\u984c\u304c\u3042\u308c\u3070\u6d88\u3057\u307e\u3059\u3002\n\n#1. Heroku\u306e\u6e96\u5099\u3092\u3059\u308b\nHeroku\u516c\u5f0f\u30b5\u30a4\u30c8\u304b\u3089Sign up\u3057\u3066\u30a2\u30ab\u30a6\u30f3\u30c8\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\nhttps://www.heroku.com/home\n\n\u6b21\u306bHeroku Command Line Interface\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3057\u3001\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\u4ee5\u4e0b\u306e\u30b5\u30a4\u30c8\u304b\u3089OS X Installer\u3092\u30af\u30ea\u30c3\u30af\u3057\u3066\u6d41\u308c\u306b\u6cbf\u3063\u3066\u3044\u3051\u3070\u5927\u4e08\u592b\u3060\u3068\u601d\u3044\u307e\u3059\u3002\u3053\u308c\u3092\u5165\u308c\u308b\u3068\u30b3\u30de\u30f3\u30c9\u30e9\u30a4\u30f3\u4e0a\u3067heroku\u306e\u64cd\u4f5c\u304c\u53ef\u80fd\u306b\u306a\u308a\u307e\u3059\u3002\nhttps://devcenter.heroku.com/articles/heroku-cli\n\n\u4ee5\u4e0b\u306e\u3088\u3046\u306bheroku\u30b3\u30de\u30f3\u30c9\u304c\u53e9\u3051\u3066\u3001Login\u3082\u3067\u304d\u305f\u3089OK.\n\n```\n$ heroku login\nEnter your Heroku credentials.\nEmail: example@gmail.com\u2190\u767b\u9332\u3057\u305f\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u3092\u5165\u529b\nPassword (typing will be hidden):\nLogged in as example@gmail.com\n```\n\n\u6b21\u306bHeroku\u306e\u4f5c\u696d\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\u4eca\u56de\u306e\u540d\u524d\u306ffreechat_app\u3068\u3057\u307e\u3057\u305f\u3002\n\n```\n$ mkdir freechat_app\n$ cd freechat_app/\n$ heroku create\n```\n\n\u3053\u308c\u3067Heroku\u3092\u5229\u7528\u3059\u308b\u6e96\u5099\u304c\u3067\u304d\u307e\u3057\u305f\u3002\n\nHeroku\u306b\u3064\u3044\u3066\u306e\u8a73\u3057\u3044\u8a18\u4e8b\u306f\u3001Arashi\u6c0f\u306e\u8a18\u4e8b\u304c\u53c2\u8003\u306b\u306a\u308a\u307e\u3059\uff01\nhttp://qiita.com/Arashi/items/b2f2e01259238235e187\n\n\n#2. Sinatra\u3092\u4f7f\u3063\u3066\u307f\u308b\nSinatra\u306fRuby\u3067\u4f7f\u3048\u308b\u30e9\u30a4\u30d6\u30e9\u30ea\u306e\u4e00\u3064\u3067\u3042\u308a\u3001Sinatra\u3092\u4f7f\u3046\u3068\u7c21\u5358\u306bweb\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u5236\u4f5c\u304c\u3067\u304d\u307e\u3059\u3002Ruby on Rails\u3067\u306f\u6577\u5c45\u304c\u9ad8\u3044\u3068\u611f\u3058\u305f\u3089Sinatra\u3092\u8a66\u3057\u306b\u4f7f\u3063\u3066\u307f\u308b\u306e\u3082\u30a2\u30ea\u306a\u306e\u3067\u306f\u306a\u3044\u3067\u3057\u3087\u3046\u304b\u3002\n\u4eca\u56de\u4f5c\u308b\u3082\u306e\u306f\u4ee5\u4e0b\u306e\u56f3\u306eMessaging Servers\u306b\u3042\u305f\u308a\u307e\u3059\u3002(\u8a73\u3057\u304f\u306fhttps://developers.line.me/messaging-api/overview)\n![bottrial-fig1.png](https://qiita-image-store.s3.amazonaws.com/0/37881/4aef1cd1-b242-e484-7726-2a7f3bc2eec0.png)\n\n\u3068\u3044\u3046\u308f\u3051\u3067Sinatra\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\u306a\u304a\u3001ruby\u306e\u74b0\u5883\u306f\u6574\u3063\u3066\u3044\u308b\u3082\u306e\u3068\u3057\u307e\u3059\u3002\n\nBundler\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u3066\u306a\u3044\u5834\u5408\u306f\u4ee5\u4e0b\u3092\u5b9f\u884c\u3002\u30d0\u30fc\u30b8\u30e7\u30f3\u3082\u78ba\u8a8d\u3057\u3066\u307f\u307e\u3057\u305f\u3002\nBundler\u306b\u3064\u3044\u3066\u8a73\u3057\u3044\u8a18\u4e8b\u306f\u3053\u3061\u3089\uff1a\nhttp://qiita.com/oshou/items/6283c2315dc7dd244aef\n\n```\n$ gem install bundler\n$ bundler -v\nBundler version 1.13.7\n```\n\n\u6b21\u306bSinatra\u3092Bundler\u7d4c\u7531\u3067\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\n\n```\n$ bundle init\n$ vim Gemfile\n```\n\n\u4ee5\u4e0b\u306e\u3088\u3046\u306aGemfile\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\n```:Gemfile\nsource \"https://rubygems.org\"\ngem 'sinatra'\ngem 'line-bot-api'\n```\n\npath\u3092\u6307\u5b9a\u3057\u3066\u30e9\u30a4\u30d6\u30e9\u30ea\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002path\u3092\u6307\u5b9a\u3059\u308b\u7406\u7531\u306f\u3001\u30b7\u30b9\u30c6\u30e0\u306bgem install\u3059\u308b\u3068\u7dba\u9e97\u3067\u306f\u306a\u3044\u306e\u3067\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3054\u3068\u306b\u5206\u3051\u305f\u65b9\u304c\u3044\u3044\u304b\u3089\u3060\u3068\u601d\u308f\u308c\u307e\u3059\u3002Sinatra\u306e\u3088\u3046\u306b\u6c4e\u7528\u7684\u306b\u4f7f\u308f\u308c\u308b\u30e9\u30a4\u30d6\u30e9\u30ea\u306a\u3089\u30b7\u30b9\u30c6\u30e0\u306b\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u3066\u3082\u3044\u3044\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u304c\u3001LINE Bot\u5236\u4f5c\u306b\u7279\u5316\u3057\u305fline-bot-api\u306a\u3093\u304b\u306f\u30b7\u30b9\u30c6\u30e0\u306b\u5165\u308c\u305f\u304f\u306a\u3044\u306f\u305a\u3067\u3059\u3002\u4ee5\u4e0b\u3092\u5b9f\u884c\u3059\u308b\u3068sinatra\u3068line-bot-api\u306b\u52a0\u3048\u3066\u3001\u4f9d\u5b58\u3059\u308b\u30e9\u30a4\u30d6\u30e9\u30ea\u3082\u4e00\u7dd2\u306b\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u3066\u304f\u308c\u307e\u3059\u3002\u3053\u308c\u306fBundler\u306e\u6a5f\u80fd\u3067\u3059\u3002\n\n```\n$ bundle install --path=vendor/bundle\nFetching gem metadata from https://rubygems.org/..........\nFetching version metadata from https://rubygems.org/.\nResolving dependencies...\nInstalling line-bot-api 1.0.0\nInstalling rack 1.6.5\nInstalling tilt 2.0.5\nUsing bundler 1.13.7\nInstalling rack-protection 1.5.3\nInstalling sinatra 1.4.7\nBundle complete! 2 Gemfile dependencies, 6 gems now installed.\nBundled gems are installed into ./vendor/bundle.```\n```\n\n\u6b21\u306bRuby\u306e\u30b3\u30fc\u30c9\u3092\u66f8\u304d\u307e\u3059\u3002\n\n```ruby:app_main.rb\nrequire 'sinatra'\nrequire 'line/bot'\n\nget '/' do\n  \"Hello world\"\nend\n```\n\n\u5b9f\u884c\u3057\u307e\u3059\u3002\n\n```\n$ bundle exec ruby app_main.rb\n[2017-01-01 20:03:05] INFO  WEBrick 1.3.1\n[2017-01-01 20:03:05] INFO  ruby 2.3.3 (2016-11-21) [x86_64-darwin15]\n== Sinatra (v1.4.7) has taken the stage on 4567 for development with backup from WEBrick\n[2017-01-01 20:03:05] INFO  WEBrick::HTTPServer#start: pid=15617 port=4567\n```\n\n\u3053\u306e\u72b6\u614b\u3067\nhttp://localhost:4567\n\u306b\u30a2\u30af\u30bb\u30b9\u3057\u3066Hello world\u3067\u304d\u305f\u3089OK. \n<img width=\"1256\" alt=\"\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2017-01-01 20.03.41.png\" src=\"https://qiita-image-store.s3.amazonaws.com/0/37881/4ddd6600-63bb-e656-de45-bba00f8bb87f.png\">\n\u3061\u306a\u307f\u306b\u3001\n\n```\n$ ruby app_main.rb\n```\n\n\u3068\u3059\u308b\u3068\u3001\u30b7\u30b9\u30c6\u30e0\u306e\u30e9\u30a4\u30d6\u30e9\u30ea\u30d1\u30b9\u3092\u53c2\u7167\u3059\u308b\u3053\u3068\u306b\u306a\u3063\u3066\u3057\u307e\u3046\u306e\u3067\u3053\u3053\u306f\u3001\n\n```\n$ bundle exec ruby app_main.rb\n```\n\n\u3068\u3057\u307e\u3057\u305f\u3002\u3053\u3046\u3059\u308b\u3053\u3068\u3067\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306e\u30ed\u30fc\u30ab\u30eb\u74b0\u5883\u3067\u5b9f\u884c\u3067\u304d\u307e\u3059\u3002\n\n#3. Line Bot\u30a2\u30ab\u30a6\u30f3\u30c8\u3092\u7528\u610f\u3059\u308b\n\u4e0b\u8a18\u30b5\u30a4\u30c8\u306e\u624b\u9806\u306b\u6cbf\u3063\u3066\u9032\u3081\u3066\u3044\u304d\u307e\u3059\u3002\nhttps://developers.line.me/messaging-api/getting-started\n\n## LINE@\u30a2\u30ab\u30a6\u30f3\u30c8\u3092\u4f5c\u3063\u3066Messaging API\u3092\u5229\u7528\u53ef\u80fd\u306b\u3059\u308b\n1. [LINE Business Center](https://business.line.me/ja/services/bot)\u306e\u4e0a\u5074\u306e\u30b5\u30fc\u30d3\u30b9\u3092\u9078\u629e\u3057\u3066\u3001\u300cMessaging API\u3092\u59cb\u3081\u308b\u300d\u3092\u62bc\u3057\u307e\u3059\u3002\n2. \u4f1a\u793e\u540d\u3092\u6c42\u3081\u3089\u308c\u307e\u3059\u304c\u3001\u500b\u4eba\u540d\u3067OK\u3067\u3059\u3002\n3. \u30a2\u30ab\u30a6\u30f3\u30c8\u306b\u5fc5\u8981\u306a\u60c5\u5831\u3092\u5165\u529b\u3002\u3053\u308c\u3067LINE@\u30a2\u30ab\u30a6\u30f3\u30c8\u306e\u4f5c\u6210\u5b8c\u4e86\u3067\u3059\u3002\n4. [LINE Business Center](https://business.line.me/ja/services/bot)\u306e\u4e0a\u5074\u306e\u30a2\u30ab\u30a6\u30f3\u30c8\u30ea\u30b9\u30c8\u3092\u9078\u629e\u3057\u3066\u3001\u4f5c\u6210\u3057\u305f\u30a2\u30ab\u30a6\u30f3\u30c8\u306eLINE@ Manager\u306b\u79fb\u52d5\u3059\u308b\u3002\n5. \u300c\u30a2\u30ab\u30a6\u30f3\u30c8\u8a2d\u5b9a\u300d\u2192\u300cBot\u8a2d\u5b9a\u300d\u3067\u3001Message API\u3092\u6709\u52b9\u306b\u3059\u308b\u3002(\u78ba\u8a8d\u3092\u6c42\u3081\u3089\u308c\u307e\u3059)\n6. \u540c\u30da\u30fc\u30b8\u306e\u300cWebhook\u9001\u4fe1\u300d\u3092\u6709\u52b9\u306b\u3059\u308b\u3002\n7. [LINE Business Center](https://business.line.me/ja/services/bot)\u306e\u4e0a\u5074\u306e\u30a2\u30ab\u30a6\u30f3\u30c8\u30ea\u30b9\u30c8\u3092\u9078\u629e\u3002Line Developper\u3068\u3044\u3046\u30dc\u30bf\u30f3\u304c\u73fe\u308c\u305f\u306e\u3067\u305d\u3053\u306b\u98db\u3076\u3002\n8. \u30da\u30fc\u30b8\u4e0b\u306e\u65b9\u306b\u3042\u308bChannel access token\u53f3\u5074\u306eissue\u30dc\u30bf\u30f3\u3092\u62bc\u3057\u3001Channel access token\u3092\u767a\u884c\u3059\u308b\u3002\n9. Channel Secret\u3068Channel access token\u306f\u5f8c\u3067\u4f7f\u3046\u306e\u3067\u63a7\u3048\u3066\u304a\u304f\u3002\n\n\n#4. Bot\u306bLine Messaging API\u3092\u53e9\u304b\u305b\u308b\n\u5c02\u3089\u4ee5\u4e0b\u306e\u30b5\u30a4\u30c8\u306e\u30b3\u30fc\u30c9\u3092\u5229\u7528\u3057\u307e\u3059\u3002Line\u793e\u516c\u5f0f\u306e\u3082\u306e\u3067\u3059\u3002\u5f53\u8a18\u4e8b\u306b\u5fae\u5c0f\u306b\u5909\u66f4\u3057\u305f\u30b3\u30fc\u30c9\u3092\u63b2\u8f09\u3057\u307e\u3059\u304c\u3001\u554f\u984c\u304c\u3042\u3063\u305f\u3089\u6d88\u3057\u307e\u3059\u3002\nhttps://github.com/line/line-bot-sdk-ruby\n\n```ruby:app_main.rb\nrequire 'sinatra'\nrequire 'line/bot'\n\n# \u5fae\u5c0f\u5909\u66f4\u90e8\u5206\uff01\u78ba\u8a8d\u7528\u3002\nget '/' do\n  \"Hello world\"\nend\n\ndef client\n  @client ||= Line::Bot::Client.new { |config|\n    config.channel_secret = ENV[\"LINE_CHANNEL_SECRET\"]\n    config.channel_token = ENV[\"LINE_CHANNEL_TOKEN\"]\n  }\nend\n\npost '/callback' do\n  body = request.body.read\n\n  signature = request.env['HTTP_X_LINE_SIGNATURE']\n  unless client.validate_signature(body, signature)\n    error 400 do 'Bad Request' end\n  end\n\n  events = client.parse_events_from(body)\n  events.each { |event|\n    case event\n    when Line::Bot::Event::Message\n      case event.type\n      when Line::Bot::Event::MessageType::Text\n        message = {\n          type: 'text',\n          text: event.message['text']\n        }\n        client.reply_message(event['replyToken'], message)\n      when Line::Bot::Event::MessageType::Image, Line::Bot::Event::MessageType::Video\n        response = client.get_message_content(event.message['id'])\n        tf = Tempfile.open(\"content\")\n        tf.write(response.body)\n      end\n    end\n  }\n\n  \"OK\"\nend\n```\n\n\u6b21\u306bProcfile\u3068config.ru\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\n```\n$ touch Procfile config.ru\n```\n\n```:Procfile\nweb: bundle exec rackup config.ru -p $PORT\n```\n\n```ruby:config.ru\nrequire './app_main'\nrun Sinatra::Application\n```\n\nProcfile\u306f\"Heroku\u306b\u4f55\u3092\u3055\u305b\u308b\u304b\"\u304c\u66f8\u304b\u308c\u305f\u6307\u793a\u66f8\u306e\u3088\u3046\u306a\u30d5\u30a1\u30a4\u30eb\u306e\u3088\u3046\u3067\u3059\u3002\u4eca\u56de\u306eProcfile\u306f\u3001config.ru\u306e\u8a2d\u5b9a\u306b\u5f93\u3063\u3066Rack\u3092\u8d77\u52d5\u3059\u308b\u3068\u3044\u3046\u3082\u306e\u3067\u3059\u3002\u3044\u304d\u306a\u308aru\u3068\u304bRack\u3068\u304b\u304c\u73fe\u308c\u3066\u6238\u60d1\u3044\u307e\u3059\u304c\u2026\u3002\n>Rack\u306fRuby\u306b\u3088\u308bWeb\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u958b\u767a\u306eHTTP\u9001\u53d7\u4fe1\u51e6\u7406\u3092\u62c5\u5f53\u3059\u308b\u30e2\u30b8\u30e5\u30fc\u30eb(gem)\u3067\u3001Ruby on Rails\u3092\u59cb\u3081\u3068\u3059\u308b\u591a\u304f\u306eWeb\u30d5\u30ec\u30fc\u30e0\u30ef\u30fc\u30af\u306e\u4e00\u756a\u4e0b\u306e\u30ec\u30d9\u30eb\u3067\u5229\u7528\u3055\u308c\u3066\u3044\u307e\u3059\u3002\n>*\u53c2\u8003\uff1a[Rack\u89e3\u8aac - Rack\u306e\u69cb\u9020\u3068Rack DSL](http://qiita.com/higuma/items/838f4f58bc4a0645950a)*\n\nRack\u306fRuby\u306e\u5404Web\u30d5\u30ec\u30fc\u30e0\u30ef\u30fc\u30af\u306b\u7d44\u307f\u8fbc\u307e\u308c\u305fHTTP\u30e2\u30b8\u30e5\u30fc\u30eb\u306e\u3088\u3046\u3067\u3059\u3002\u305d\u3046\u3044\u3048\u3070\u3055\u3063\u304dbundle install\u3057\u305f\u6642\u306b\u4f9d\u5b58\u3067\u5165\u3063\u3066\u307e\u3057\u305f\u306d\uff01\n\n## Heroku\u306b\u30c7\u30d7\u30ed\u30a4\u3059\u308b\n\u4f5c\u6210\u3057\u305fWeb\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u5229\u7528\u53ef\u80fd\u306b\u3059\u308b\u305f\u3081\u306b\u305d\u308c\u3089\u3092Heroku\u306b\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3059\u308b\u3053\u3068\u3092\u3001\u30c7\u30d7\u30ed\u30a4\u3068\u8a00\u3044\u307e\u3059\u3002\u3053\u3053\u307e\u3067\u3067\u4f5c\u3063\u305f\u30d5\u30a1\u30a4\u30eb\u4e00\u89a7\u306f\u3053\u306e\u901a\u308a\u306b\u306a\u308a\u307e\u3059\u3002\n\n```\n$ ls -a\n.            .bundle      Gemfile.lock app_main.rb  vendor\n..           Gemfile      Procfile     config.ru\n```\n\nHeroku\u306e\u30c7\u30d7\u30ed\u30a4\u306b\u306fGit\u3092\u4f7f\u7528\u3059\u308b\u306e\u3067Git\u306e\u6e96\u5099\u3092\u3057\u307e\u3059\u3002\n\u307e\u305a.gitignore\u3092\u66f8\u304d\u307e\u3059\u3002Heroku\u5074\u306b\u5fc5\u8981\u306e\u306a\u3044\u30d5\u30a1\u30a4\u30eb\u3092\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3057\u306a\u3044\u305f\u3081\u3067\u3059\u3002\n\u4ee5\u4e0b\u306e\u30b5\u30a4\u30c8\u306e\u30b3\u30fc\u30c9\u306fRails\u7528\u3067\u3059\u304c\u4eca\u56de\u306f\u3053\u3061\u3089\u3092\u4f7f\u7528\u3055\u305b\u3066\u3044\u305f\u3060\u304d\u307e\u3057\u305f\u3002\nhttp://qiita.com/seri_k/items/2945dbbc3e09e651b538\n\n```\n$ vim .gitignore\n```\n\n```:.gitignore\n#----------------------------------------------------------------------------\n# This is the .gitignore file for the rails-composer repository.\n#\n# Rails Composer is an application template that creates a Rails starter app.\n#\n# The Rails Composer application template is generated by the rails_apps_composer gem:\n# https://github.com/RailsApps/rails_apps_composer\n#\n# The Rails Composer application template will create a .gitignore file for any starter app.\n# This file isn't used by the Rails Composer application template; instead the template uses:\n# https://github.com/RailsApps/rails-composer/blob/master/files/gitignore.txt\n#\n# Corrections? Improvements? Create a GitHub issue: \n# http://github.com/RailsApps/rails-composer/issues\n#----------------------------------------------------------------------------\n\n# bundler state\n/.bundle\n/vendor/bundle/\n/vendor/ruby/\n\n# minimal Rails specific artifacts\ndb/*.sqlite3\n/log/*\n/tmp/*\n\n# various artifacts\n**.war\n*.rbc\n*.sassc\n.rspec\n.redcar/\n.sass-cache\n/coverage.data\n/coverage/\n/db/*.javadb/\n/db/*.sqlite3\n/doc/api/\n/doc/app/\n/doc/features.html\n/doc/specs.html\n/public/cache\n/public/stylesheets/compiled\n/public/system/*\n/spec/tmp/*\n/cache\n/capybara*\n/capybara-*.html\n/gems\n/spec/requests\n/spec/routing\n/spec/views\n/specifications\nrerun.txt\npickle-email-*.html\n\n# If you find yourself ignoring temporary files generated by your text editor\n# or operating system, you probably want to add a global ignore instead:\n#   git config --global core.excludesfile ~/.gitignore_global\n#\n# Here are some files you may want to ignore globally:\n\n# scm revert files\n**.orig\n\n# Mac finder artifacts\n.DS_Store\n\n# Netbeans project directory\n/nbproject/\n\n# RubyMine project files\n.idea\n\n# Textmate project files\n/*.tmproj\n\n# vim artifacts\n**.swp\n```\n\n\u521d\u671f\u5316\u3057\u3066add\u3057\u3066commit\u3057\u3066push\u3057\u307e\u3059\u3002\n\n```\n$ git init\n$ git add -A\n$ git commit -m 'first commit'\n$ git push heroku master\n$ heroku open\n```\n\nheroku open\u3059\u308b\u3068Hello world\u304c\u8868\u793a\u3055\u308c\u3066\u3044\u308b\u3068\u601d\u3044\u307e\u3059\u3002\u3053\u308c\u306f\u30ea\u30e2\u30fc\u30c8\u3067\u52d5\u4f5c\u3057\u305f\u3053\u3068\u3092\u610f\u5473\u3057\u3066\u3044\u307e\u3059\u3002\n<img width=\"731\" alt=\"\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2017-01-01 21.54.37.png\" src=\"https://qiita-image-store.s3.amazonaws.com/0/37881/f24b765f-8fb6-d31e-5214-ca805deddcbf.png\">\n\n\u6700\u5f8c\u306b\u3001Messaging API\u3092\u5229\u7528\u3059\u308b\u305f\u3081\u306e\u8a2d\u5b9a\u3092\u3057\u307e\u3059\u3002Heroku\u30b3\u30f3\u30c8\u30ed\u30fc\u30eb\u30d1\u30cd\u30eb\u304b\u3089Settings->Config Variables\u3067Reveal Config Vars\u3092\u62bc\u3057\u307e\u3059\u3002\u3059\u308b\u3068Heroku\u74b0\u5883\u4e0b\u3067\u306e\u74b0\u5883\u5909\u6570\u304c\u8868\u793a\u3055\u308c\u307e\u3059\u3002\n\u3053\u3053\u306b\u3001\u5148\u307b\u3069\u30e1\u30e2\u3063\u305fChannel Secret\u3068Channel access token\u3092\u30bb\u30c3\u30c8\u3057\u307e\u3059\u3002\n\n```\nLINE_CHANNEL_SECRET   xxxxxx\u2190\u30e1\u30e2\u3063\u305fChannel Secret\nLINE_CHANNEL_TOKEN    yyyyyy\u2190\u30e1\u30e2\u3063\u305fChannel access token\n```\n\n\u6b21\u306bLine developers\u306e\u30da\u30fc\u30b8\u306b\u884c\u304d\u3001Webhook URL\u306bAPI\u306eURL\u3092\u5165\u529b\u3057\u307e\u3059\u3002\n\u3053\u306e\u3088\u3046\u306a\u611f\u3058\u306eURL\u3060\u3068\u601d\u3044\u307e\u3059\u3002\nhttps://fathomless-waters-27765.herokuapp.com/callback\n\n\u3053\u308c\u3067API\u304c\u4f7f\u3048\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3057\u305f\u3002\u5148\u307b\u3069\u4f5c\u3063\u305fLINE@\u30a2\u30ab\u30a6\u30f3\u30c8\u3068\u53cb\u9054\u306b\u306a\u3063\u3066\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u6295\u3052\u307e\u3059\u3002\n<img width=\"401\" alt=\"\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2016-12-30 19.42.27.png\" src=\"https://qiita-image-store.s3.amazonaws.com/0/37881/01c753a5-daae-3c7e-ef67-cefe0cb1f3d7.png\">\n\n\u51fa\u6765\u307e\u3057\u305f\uff01\n\n\u203b\u5348\u5f8c7:15\u307e\u3067\u53cd\u5fdc\u3057\u306a\u304b\u3063\u305f\u306e\u306fLINE Developper\u3067IP WhiteList\u3092\u8a2d\u5b9a\u3057\u3066\u3044\u305f\u305f\u3081\u3067\u3057\u305f\u3002heroku\u306e\u30ed\u30b0\u306b\u53d7\u4fe1\u30ed\u30b0\u304c\u6b8b\u3063\u3066\u3044\u305f\u306e\u3067heroku->LINE\u3067\u554f\u984c\u304c\u3042\u3063\u305f\u3053\u3068\u306f\u78ba\u5b9f\u306a\u306e\u3067\u3059\u304c\u3053\u308c\u304c\u539f\u56e0\u3060\u3068\u306f\u2026\u3002Fixie\u3067\u5f97\u305f\u30a2\u30c9\u30ec\u30b9\u3092\u5165\u529b\u3057\u305f\u306e\u306b\u901a\u3089\u306a\u304b\u3063\u305f\u3053\u3068\u304c\u8b0e\u3067\u3059\n\n\u30ed\u30b0\u3092\u898b\u3066\u602a\u3057\u3044\u30a8\u30e9\u30fc\u304c\u306a\u3051\u308c\u3070\u5b8c\u74a7\u3067\u3059\u306d\u3002\n\n```\n$ heroku logs\n```\n\n\u304a\u75b2\u308c\u69d8\u3067\u3057\u305f\uff01\n\n#\u53c2\u8003\u8a18\u4e8b\n### Bundler\n[Bundler\u306e\u4f7f\u3044\u65b9](http://qiita.com/oshou/items/6283c2315dc7dd244aef#%E5%8F%82%E8%80%83)\n[bundle install\u3059\u308b\u3068\u304d\u306fpath\u3092\u6307\u5b9a\u3057\u3088\u3046](https://blog.dakatsuka.jp/2010/11/09/bundle-install.html)\n[rails\u3067bundle install\u3059\u308b\u6642\u306b\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u30d1\u30b9\u3092\u6307\u5b9a](http://qiita.com/osamtimizer/items/3a241f365c85356394a8)\n[bundler\u3067gem\u3092\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3054\u3068\u306b\u7ba1\u7406\u3059\u308b](http://dev.classmethod.jp/server-side/language/bundler-gem-management/)\n[Ruby\u66f8\u304f\u306a\u3089Bundler\u4f7f\u3048](http://shokai.org/blog/archives/7262)\n### Heroku\n[Getting Started with Ruby on Heroku](https://devcenter.heroku.com/articles/getting-started-with-ruby-o)\n[Heroku\u306b\u901f\u653b\u30c7\u30d7\u30ed\u30a4\u3059\u308bSinatra\u30a2\u30d7\u30ea\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u3092\u3064\u304f\u308b #1](http://totutotu.hatenablog.com/entry/2015/06/10/Heroku%E3%81%AB%E9%80%9F%E6%94%BB%E3%83%87%E3%83%97%E3%83%AD%E3%82%A4%E3%81%99%E3%82%8BSinatra%E3%82%A2%E3%83%97%E3%83%AA%E3%83%86%E3%83%B3%E3%83%97%E3%83%AC%E3%83%BC%E3%83%88%E3%82%92%E3%81%A4)\n### Sinatra\n[Sinatra\u3092\u52d5\u304b\u3059\u307e\u3067](http://qiita.com/kk2170/items/5343f452080e0897d139)\n[Rack\u89e3\u8aac - Rack\u306e\u69cb\u9020\u3068Rack DSL](http://qiita.com/higuma/items/838f4f58bc4a0645950a)\n### LINE API\n[LINE developers(\u516c\u5f0f\u30ea\u30d5\u30a1\u30ec\u30f3\u30b9)](https://developers.line.me/)\n[LINE BusinessConnect\u306e\u6280\u8853\u8a71](http://developers.linecorp.com/blog/ja/?p=3169)\n\n", "tags": ["Ruby", "Sinatra", "Heroku", "Line"]}