{"context": " More than 1 year has passed since last update.layout\u306b\u3044\u308c\u3066\u3070\u3044\u3044\u306e\u3067\u3059\u304c\u3001\u3044\u308d\u3044\u308d\u4e8b\u60c5\u304c\u3042\u3063\u3066layout\u3092\u4f7f\u308f\u306a\u3044\u30da\u30fc\u30b8\u3068\u304b\u3042\u308a\u307e\u3059\u3002\n\u305d\u306e\u6642\u554f\u984c\u306a\u306e\u304c\n\u30fbGA\u8a2d\u7f6e\u3057\u5fd8\u308c\u308b\n\u30fbGA\u8a2d\u7f6e\u3057\u3066\u3044\u308b\u30da\u30fc\u30b8\u3068\u3057\u3066\u306a\u3044\u30da\u30fc\u30b8\u304c\u3042\u308b\n  (\u3069\u3063\u3061\u304b\u306b\u7d71\u4e00\u3059\u308b\u306e\u3082\u4eca\u66f4\u9762\u5012)\n\u306a\u306e\u3067 \u3068\u308a\u3042\u3048\u305a filter\u3067\u89e3\u6c7a\u3057\u3066\u307f\u307e\u3057\u305f\u3002\n\u30da\u30fc\u30b8\u5185\u306b _setAccount \u3068\u3044\u3046\u6587\u5b57\u5217\u304c\u3042\u3063\u305f\u3089 \u4f55\u3082\u3057\u306a\u3044\u3002\n\u306a\u304b\u3063\u305f\u5834\u5408\u306f GA\u3092\u57cb\u3081\u8fbc\u3080\u611f\u3058\u3067\u3059\u3002\n\u5f8c\u306f\u3001filter\u306e\u8a2d\u5b9a\u3067 'after' => 'ga' \u3059\u308c\u3070\u3044\u3044\u3002\n\nroutes.php\nRoute::filter('ga', function( $response = null )\n{\n// Google Analytics\n$ga_tag = <<<EOM\n<script type=\"text/javascript\">\n  var _gaq = _gaq || [];\n  _gaq.push(['_setAccount', 'UA-XXX-XXX']);\n  _gaq.push(['_trackPageview']);\n  (function() {\n    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;\n    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';\n    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);\n  })();\n</script>\nEOM;\n// 200 OK \u306e\u6642\u3060\u3051\u5165\u308c\u308b\u3002\nif ( $response->status() == 200 ){\n  if ( !preg_match('/_setAccount/', $response->content ) ) {\n    $response->content = preg_replace('/(<\\/head>)/i', $ga_tag . '$1', $response->content );\n  }\n}\n});\n\n\n\nlayout\u306b\u3044\u308c\u3066\u3070\u3044\u3044\u306e\u3067\u3059\u304c\u3001\u3044\u308d\u3044\u308d\u4e8b\u60c5\u304c\u3042\u3063\u3066layout\u3092\u4f7f\u308f\u306a\u3044\u30da\u30fc\u30b8\u3068\u304b\u3042\u308a\u307e\u3059\u3002\n\u305d\u306e\u6642\u554f\u984c\u306a\u306e\u304c\n\u30fbGA\u8a2d\u7f6e\u3057\u5fd8\u308c\u308b\n\u30fbGA\u8a2d\u7f6e\u3057\u3066\u3044\u308b\u30da\u30fc\u30b8\u3068\u3057\u3066\u306a\u3044\u30da\u30fc\u30b8\u304c\u3042\u308b\n  (\u3069\u3063\u3061\u304b\u306b\u7d71\u4e00\u3059\u308b\u306e\u3082\u4eca\u66f4\u9762\u5012)\n\n\u306a\u306e\u3067 \u3068\u308a\u3042\u3048\u305a filter\u3067\u89e3\u6c7a\u3057\u3066\u307f\u307e\u3057\u305f\u3002\n\u30da\u30fc\u30b8\u5185\u306b _setAccount \u3068\u3044\u3046\u6587\u5b57\u5217\u304c\u3042\u3063\u305f\u3089 \u4f55\u3082\u3057\u306a\u3044\u3002\n\u306a\u304b\u3063\u305f\u5834\u5408\u306f GA\u3092\u57cb\u3081\u8fbc\u3080\u611f\u3058\u3067\u3059\u3002\n\u5f8c\u306f\u3001filter\u306e\u8a2d\u5b9a\u3067 'after' => 'ga' \u3059\u308c\u3070\u3044\u3044\u3002\n\n```routes.php\nRoute::filter('ga', function( $response = null )\n{\n// Google Analytics\n$ga_tag = <<<EOM\n<script type=\"text/javascript\">\n  var _gaq = _gaq || [];\n  _gaq.push(['_setAccount', 'UA-XXX-XXX']);\n  _gaq.push(['_trackPageview']);\n  (function() {\n    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;\n    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';\n    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);\n  })();\n</script>\nEOM;\n// 200 OK \u306e\u6642\u3060\u3051\u5165\u308c\u308b\u3002\nif ( $response->status() == 200 ){\n  if ( !preg_match('/_setAccount/', $response->content ) ) {\n    $response->content = preg_replace('/(<\\/head>)/i', $ga_tag . '$1', $response->content );\n  }\n}\n});\n```\n", "tags": ["laravel3", "PHP", "GoogleAnalytics"]}