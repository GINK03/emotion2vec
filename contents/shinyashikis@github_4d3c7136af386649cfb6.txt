{"context": " More than 1 year has passed since last update.\n\n\u3057\u305f\u3044\u3053\u3068\nUbuntu14.10\u306bPostgreSQL\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3092\u69cb\u7bc9\u3059\u308b\n\n\u624b\u9806\n\n\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n$ sudo apt-get install -y postgresql-9.4\n\n\n\u8d77\u52d5\n$ sudo /etc/init.d/postgresql start\n * Starting PostgreSQL 9.4 database server              [ OK ]\n\n\n\u63a5\u7d9a\n\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306bUnix\u30ed\u30b0\u30a4\u30f3\u30e6\u30fc\u30b6 USER \u304c\u30ed\u30fc\u30eb\u3068\u3057\u3066\u5b58\u5728\u3057\u306a\u3044\u306e\u3067\u63a5\u7d9a\u3067\u304d\u306a\u3044\n$ psql\npsql: FATAL:  role \"USER\" does not exist\n\n\n\u30ed\u30fc\u30eb\u4f5c\u6210\n\u30e6\u30fc\u30b6 postgres \u3068\u3057\u3066\u63a5\u7d9a\n$ su - postgres\n$ psql\npsql (9.4.4)\nType \"help\" for help.\n\npostgres=#\n\n\u30ed\u30fc\u30eb\u78ba\u8a8d\npostgres=# \\du\n                             List of roles\n Role name |                   Attributes                   | Member of \n-----------+------------------------------------------------+-----------\n postgres  | Superuser, Create role, Create DB, Replication | {}\n\n\u30ed\u30fc\u30eb sample_role \u4f5c\u6210\npostgres=# CREATE ROLE sample_role WITH LOGIN CREATEDB PASSWORD 'sample_role';\n\n\u30ed\u30fc\u30eb sample_role \u304c\u4f5c\u6210\u3055\u308c\u305f\u306e\u3092\u78ba\u8a8d\npostgres=# \\du\n                              List of roles\n  Role name  |                   Attributes                   | Member of \n-------------+------------------------------------------------+-----------\n postgres    | Superuser, Create role, Create DB, Replication | {}\n sample_role | Create DB                                      | {}\n\n\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9 sample \u4f5c\u6210\npostgres=# CREATE DATABASE sample OWNER sample_role;\nCREATE DATABASE\n\n\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9 sample \u304c\u4f5c\u6210\u3055\u308c\u305f\u306e\u3092\u78ba\u8a8d\npostgres=# \\l\n                                   List of databases\n   Name    |    Owner    | Encoding |   Collate   |    Ctype    |   Access privileges   \n-----------+-------------+----------+-------------+-------------+-----------------------\n postgres  | postgres    | UTF8     | ja_JP.UTF-8 | ja_JP.UTF-8 | \n sample    | sample_role | UTF8     | ja_JP.UTF-8 | ja_JP.UTF-8 | \n template0 | postgres    | UTF8     | ja_JP.UTF-8 | ja_JP.UTF-8 | =c/postgres          +\n           |             |          |             |             | postgres=CTc/postgres\n template1 | postgres    | UTF8     | ja_JP.UTF-8 | ja_JP.UTF-8 | =c/postgres          +\n           |             |          |             |             | postgres=CTc/postgres\n(4 rows)\n\n\n\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u8a8d\u8a3c\u306e\u8a2d\u5b9a\n\u73fe\u72b6\u3067\u306fpeer\u8a8d\u8a3c\u3068\u306a\u3063\u3066\u3044\u3066\u3001\u30ed\u30fc\u30eb\u3068Unix\u30e6\u30fc\u30b6\u540d\u304c\u4e00\u81f4\u3057\u3066\u3044\u306a\u3044\u3068\u30ed\u30b0\u30a4\u30f3\u3067\u304d\u306a\u3044\u72b6\u614b\u3068\u306a\u3063\u3066\u3044\u308b\u306e\u30671\n$ psql -U sample_role sample\npsql: FATAL:  Peer authentication failed for user \"sample_role\"\n\n\n/etc/postgresql/9.4/main/pg_hba.conf\n# \"local\" is for Unix domain socket connections only\nlocal   all             all                                     peer\n\n\npeer\u8a8d\u8a3c\u3092md5\u8a8d\u8a3c\u306b\u5909\u66f4\u3057\u3001\n\n/etc/postgresql/9.4/main/pg_hba.conf\n# \"local\" is for Unix domain socket connections only\nlocal   all             all                                     md5\n\n\n\u518d\u8d77\u52d5\n$ sudo /etc/init.d/postgresql restart\n * Restarting PostgreSQL 9.4 database server              [ OK ]\n\nsample_role \u3067\u30ed\u30b0\u30a4\u30f3\u3067\u304d\u308b\u3053\u3068\u3092\u78ba\u8a8d\n$ psql -U sample_role sample\nPassword for user sample_role: \npsql (9.4.4)\nType \"help\" for help.\n\nsample=> \n\n\n\n\n\nhttps://www.postgresql.jp/document/9.4/html/auth-pg-hba-conf.html\u00a0\u21a9\n\n\n\n# \u3057\u305f\u3044\u3053\u3068\nUbuntu14.10\u306bPostgreSQL\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3092\u69cb\u7bc9\u3059\u308b\n\n# \u624b\u9806\n\n### \u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n```\n$ sudo apt-get install -y postgresql-9.4\n```\n\n### \u8d77\u52d5\n\n```\n$ sudo /etc/init.d/postgresql start\n * Starting PostgreSQL 9.4 database server              [ OK ]\n```\n\n### \u63a5\u7d9a\n\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306bUnix\u30ed\u30b0\u30a4\u30f3\u30e6\u30fc\u30b6 USER \u304c\u30ed\u30fc\u30eb\u3068\u3057\u3066\u5b58\u5728\u3057\u306a\u3044\u306e\u3067\u63a5\u7d9a\u3067\u304d\u306a\u3044\n\n```\n$ psql\npsql: FATAL:  role \"USER\" does not exist\n```\n\n### \u30ed\u30fc\u30eb\u4f5c\u6210\n\u30e6\u30fc\u30b6 postgres \u3068\u3057\u3066\u63a5\u7d9a\n\n```\n$ su - postgres\n$ psql\npsql (9.4.4)\nType \"help\" for help.\n\npostgres=#\n```\n\n\u30ed\u30fc\u30eb\u78ba\u8a8d\n\n```\npostgres=# \\du\n                             List of roles\n Role name |                   Attributes                   | Member of \n-----------+------------------------------------------------+-----------\n postgres  | Superuser, Create role, Create DB, Replication | {}\n```\n\n\u30ed\u30fc\u30eb sample_role \u4f5c\u6210\n\n```\npostgres=# CREATE ROLE sample_role WITH LOGIN CREATEDB PASSWORD 'sample_role';\n```\n\n\u30ed\u30fc\u30eb sample_role \u304c\u4f5c\u6210\u3055\u308c\u305f\u306e\u3092\u78ba\u8a8d\n\n```\npostgres=# \\du\n                              List of roles\n  Role name  |                   Attributes                   | Member of \n-------------+------------------------------------------------+-----------\n postgres    | Superuser, Create role, Create DB, Replication | {}\n sample_role | Create DB                                      | {}\n```\n\n\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9 sample \u4f5c\u6210\n\n```\npostgres=# CREATE DATABASE sample OWNER sample_role;\nCREATE DATABASE\n```\n\n\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9 sample \u304c\u4f5c\u6210\u3055\u308c\u305f\u306e\u3092\u78ba\u8a8d\n\n```\npostgres=# \\l\n                                   List of databases\n   Name    |    Owner    | Encoding |   Collate   |    Ctype    |   Access privileges   \n-----------+-------------+----------+-------------+-------------+-----------------------\n postgres  | postgres    | UTF8     | ja_JP.UTF-8 | ja_JP.UTF-8 | \n sample    | sample_role | UTF8     | ja_JP.UTF-8 | ja_JP.UTF-8 | \n template0 | postgres    | UTF8     | ja_JP.UTF-8 | ja_JP.UTF-8 | =c/postgres          +\n           |             |          |             |             | postgres=CTc/postgres\n template1 | postgres    | UTF8     | ja_JP.UTF-8 | ja_JP.UTF-8 | =c/postgres          +\n           |             |          |             |             | postgres=CTc/postgres\n(4 rows)\n```\n\n### \u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u8a8d\u8a3c\u306e\u8a2d\u5b9a\n\u73fe\u72b6\u3067\u306fpeer\u8a8d\u8a3c\u3068\u306a\u3063\u3066\u3044\u3066\u3001\u30ed\u30fc\u30eb\u3068Unix\u30e6\u30fc\u30b6\u540d\u304c\u4e00\u81f4\u3057\u3066\u3044\u306a\u3044\u3068\u30ed\u30b0\u30a4\u30f3\u3067\u304d\u306a\u3044\u72b6\u614b\u3068\u306a\u3063\u3066\u3044\u308b\u306e\u3067[^1]\n\n```\n$ psql -U sample_role sample\npsql: FATAL:  Peer authentication failed for user \"sample_role\"\n```\n\n```/etc/postgresql/9.4/main/pg_hba.conf\n# \"local\" is for Unix domain socket connections only\nlocal   all             all                                     peer\n```\n\npeer\u8a8d\u8a3c\u3092md5\u8a8d\u8a3c\u306b\u5909\u66f4\u3057\u3001\n\n```/etc/postgresql/9.4/main/pg_hba.conf\n# \"local\" is for Unix domain socket connections only\nlocal   all             all                                     md5\n```\n\n\u518d\u8d77\u52d5\n\n```\n$ sudo /etc/init.d/postgresql restart\n * Restarting PostgreSQL 9.4 database server              [ OK ]\n```\n\nsample_role \u3067\u30ed\u30b0\u30a4\u30f3\u3067\u304d\u308b\u3053\u3068\u3092\u78ba\u8a8d\n\n```\n$ psql -U sample_role sample\nPassword for user sample_role: \npsql (9.4.4)\nType \"help\" for help.\n\nsample=> \n```\n\n[^1]: https://www.postgresql.jp/document/9.4/html/auth-pg-hba-conf.html\n", "tags": ["Ubuntu", "PostgreSQL", "\u74b0\u5883\u69cb\u7bc9"]}