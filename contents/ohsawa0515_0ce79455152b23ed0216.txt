{"context": " More than 1 year has passed since last update.\n\nIcinga\u3068\u306f\nIcinga(\u30a2\u30a4\u30b7\u30f3\u30ac)\u306fNagios\u304b\u3089fork\u3057\u305f\u30e2\u30cb\u30bf\u30ea\u30f3\u30b0\u30b7\u30b9\u30c6\u30e0\u3002\n\n\u30d0\u30fc\u30b8\u30e7\u30f3\u306e\u9055\u3044\n\nIcinga 1\n\nNagios\u306e\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3001\u30d7\u30e9\u30b0\u30a4\u30f3\u3001\u30a2\u30c9\u30aa\u30f3\u3068\u4e92\u63db\u6027\u304c\u3042\u308b\nNagios\u6642\u4ee3\u306e\u6570\u591a\u304f\u306eBugfix\u3084\u6a5f\u80fd\u304c\u8ffd\u52a0\u3055\u308c\u3066\u3044\u308b\n\n\nIcinga 2\n\n\u30b3\u30a2\u304b\u3089\u4f5c\u308a\u66ff\u3048\u3089\u308c\u3066\u304a\u308a\u3001Icinga 1\u304a\u3088\u3073Nagios\u3068\u306f\u4e92\u63db\u6027\u304c\u306a\u3044\n\n\u4eca\u56de\u306fNagios\u3068\u306e\u4e92\u63db\u6027\u304c\u3042\u308b\u3001Icinga 1\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\n\nIcinga Classic\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\nUI\u304cNagios\u306b\u8fd1\u3044Icinga Classic\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\n\n\u4f9d\u5b58\u30d1\u30c3\u30b1\u30fc\u30b8\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n$ sudo yum install gcc httpd glibc glibc-common gd\n\nMySQL Server\u3092\u4f7f\u3046\u306e\u3067\u5165\u308c\u307e\u3059\u3002\n\u5225\u9014MySQL\u30b5\u30fc\u30d0\u304c\u3042\u308b\u5834\u5408\u306f\u3001mysql client\u3067\u3082\u826f\u3044\u3067\u3059\u3002\n$ sudo yum install mysql-server\n\n\nIcinga\u306e\u30ea\u30dd\u30b8\u30c8\u30ea\u8ffd\u52a0\nIcinga\u306e\u30ea\u30dd\u30b8\u30c8\u30ea\u3092\u8ffd\u52a0\u3057\u3066\u30d1\u30c3\u30b1\u30fc\u30b8\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\n$ cd /etc/yum.repos.d/\n$ sudo wget http://packages.icinga.org/epel/ICINGA-release.repo\n\nIcinga\u30d1\u30c3\u30b1\u30fc\u30b8\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\n$ sudo yum install icinga icinga-gui icinga-idoutils icinga-idoutils-libdbi-mysql nagios-plugins nagios-plugins-mysql\n\nnrpe, nagios\u30d7\u30e9\u30b0\u30a4\u30f3\u304c\u4f7f\u3048\u308b\u306e\u3067\u3001\u4f75\u305b\u3066\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\n$ sudo yum install nrpe nagios-plugins-nrpe\n$ sudo yum install nagios-plugins-all\n\n\n\u8a2d\u5b9a\n\nMySQL\n\n/etc/my.cnf\n# \u4ee5\u4e0b\u3092\u8ffd\u52a0\n[mysqld]\ncharacter-set-server = utf8\n\n[client]\ndefault-character-set = utf8\n\n\n$ sudo chkconfig mysqld --add\n$ sudo chkconfig mysqld on\n$ sudo service mysqld start\n$ /usr/bin/mysqladmin -u root password 'new-password'\n\n$ echo \"CREATE DATABASE icinga; \\\nGRANT USAGE ON icinga.* TO 'icinga'@'localhost' IDENTIFIED BY 'icinga' WITH MAX_QUERIES_PER_HOUR 0 MAX_CONNECTIONS_PER_HOUR 0 MAX_UPDATES_PER_HOUR 0; \\\nGRANT SELECT, INSERT, UPDATE, DELETE, DROP, CREATE, CREATE VIEW, INDEX, EXECUTE ON icinga.* TO 'icinga'@'localhost'; \\\nFLUSH PRIVILEGES;\" | mysql -u root -p -h localhost\n\n$ mysql -u root -p -h localhost icinga < /usr/share/doc/icinga-idoutils-libdbi-mysql-*/db/mysql/mysql.sql\n\n\nIcinga\n$ sudo sed -i'' 's/^ *enable_environment_macros *=.*/enable_environment_macros=1/' /etc/icinga/icinga.cfg\n$ sudo sed -i'' 's/^ *date_format *=.*/date_format=iso8601/' /etc/icinga/icinga.cfg\n\n\u6b63\u3057\u304f\u8a2d\u5b9a\u3055\u308c\u305f\u304b\u306e\u78ba\u8a8d\u3092\u3057\u307e\u3059\u3002\n$ sudo icinga -v /etc/icinga/icinga.cfg\n\nTotal Warnings: 0\nTotal Errors:   0\n\n\u3068\u8868\u793a\u3055\u308c\u3066\u3044\u308c\u3070OK\u3002\n$ sudo chkconfig httpd --add\n$ sudo chkconfig httpd on\n$ sudo chkconfig icinga --add\n$ sudo chkconfig icinga on\n$ sudo chkconfig ido2db --add\n$ sudo chkconfig ido2db on\n$ sudo service httpd start\n$ sudo service icinga start\n$ sudo service ido2db start\n\n\u30d6\u30e9\u30a6\u30b6\u304b\u3089\u78ba\u8a8d\u3057\u3066\u6b21\u306e\u3088\u3046\u306a\u753b\u9762\u304c\u8868\u793a\u3055\u308c\u308c\u3070OK\u3067\u3059\u3002\nhttp://[Domain]/icinga/\nID: icingaadmin PW: icingaadmin\n\nnagios\u3068\u4f3c\u3066\u3044\u307e\u3059\u304c\u3001\u898b\u3084\u3059\u304f\u306a\u3063\u3066\u3044\u308b\u3068\u601d\u3044\u307e\u3059\u3002\n\npnp4nagios\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\u53d6\u5f97\u3057\u305f\u30d1\u30d5\u30a9\u30fc\u30de\u30f3\u30b9\u30c7\u30fc\u30bf\u3092\u30b0\u30e9\u30d5\u8868\u793a\u3055\u305b\u3066\u307f\u307e\u3059\u3002\npnp4nagios\u306f\u30bd\u30fc\u30b9\u304b\u3089\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\n# \u4f9d\u5b58\u30d1\u30c3\u30b1\u30fc\u30b8\n$ sudo yum install php php-gd rrdtool rrdtool-perl perl-Time-HiRes\n\n$ cd /usr/local/src\n$ sudo wget http://downloads.sourceforge.net/project/pnp4nagios/PNP-0.6/pnp4nagios-0.6.25.tar.gz\n$ sudo tar zxvf pnp4nagios-0.6.25.tar.gz\n$ cd pnp4nagios-0.6.25\n$ sudo ./configure --with-nagios-user=icinga --with-nagios-group=icinga\n$ sudo make all\n$ sudo make fullinstall\n\n\n\u8a2d\u5b9a\n\nApache\nBasic\u8a8d\u8a3c\u8a2d\u5b9a\u3092\u3059\u308b\u304b\u3001\u751f\u6210\u3055\u308c\u305f/etc/httpd/conf.d/pnp4nagios.conf\u306e\u8a2d\u5b9a\u3092\u5f04\u3063\u3066\u304f\u3060\u3055\u3044\u3002\n$ sudo mkdir -p /usr/local/nagios/etc\n$ sudo htpasswd -c /usr/local/nagios/etc/htpasswd.users icingaadmin\nNew password: icingaadmin\nRe-type new password: icingaadmin\n\n\nPHP\n\u30bf\u30a4\u30e0\u30be\u30fc\u30f3\u304c\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u306a\u3051\u308c\u3070\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n$ sudo sed -i'' \"s|^[ ;]*date.timezone *=.*|date.timezone='Asia/Tokyo'|\" /etc/php.ini\n\n\npnp4nagios\nNagios\u7528\u306e\u8a2d\u5b9a\u306b\u306a\u3063\u3066\u3044\u308b\u306e\u3067Icinga\u7528\u306b\u5909\u66f4\u3057\u307e\u3059\u3002\n\n/usr/local/pnp4nagios/etc/config_local.php\n- $conf['nagios_base'] = \"/nagios/cgi-bin\";\n+ $conf['nagios_base'] = \"/icinga/cgi-bin\";\n\n- $conf['date_fmt'] = \"d.m.y G:i\";\n+ $conf['date_fmt'] = \"Y.m.d G:i\";  // \u65e5\u4ed8\u5f62\u5f0f\u3092YYYY.MM.DD\u306b\u3059\u308b\n\n\n\n/usr/local/pnp4nagios/etc/config.php\n- $conf['nagios_base'] = \"/nagios/cgi-bin\";\n+ $conf['nagios_base'] = \"/icinga/cgi-bin\";\n\n- $conf['date_fmt'] = \"d.m.y G:i\";\n+ $conf['date_fmt'] = \"Y.m.d G:i\";  // \u65e5\u4ed8\u5f62\u5f0f\u3092YYYY.MM.DD\u306b\u3059\u308b\n\n\n$ cd /usr/local/pnp4nagios/etc/\n$ sudo mv rra.cfg-sample rra.cfg\n$ sudo mv nagios.cfg-sample icinga.cfg\n$ sudo mv misccommands.cfg-sample misccommands.cfg\n\n$ sudo sed -i'' 's/^ *user *=.*/user = icinga/' /usr/local/pnp4nagios/etc/npcd.cfg\n$ sudo sed -i'' 's/^ *group *=.*/group = icinga/' /usr/local/pnp4nagios/etc/npcd.cfg\n$ sudo sed -i'' 's/^ *log_type *=.*/log_type = file/' /usr/local/pnp4nagios/etc/npcd.cfg\n$ sudo sed -i'' 's/^ *load_threshold *=.*/load_threshold = 10.0/' /usr/local/pnp4nagios/etc/npcd.cfg\n$ sudo sed -i'' 's|^ *log_file *=.*|log_file = /var/log/pnp4nagios/npcd.log|' /usr/local/pnp4nagios/etc/npcd.cfg\n\n\n/usr/local/pnp4nagios/etc/misccommands.cfg\n# \u30b3\u30e1\u30f3\u30c8\u5916\u3059\n#\n# Bulk with NPCD mode\n#\ndefine command {\n       command_name    process-service-perfdata-file\n       command_line    /bin/mv /usr/local/pnp4nagios/var/service-perfdata /usr/local/pnp4nagios/var/spool/service-perfdata.$TIMET$\n}\n\ndefine command {\n       command_name    process-host-perfdata-file\n       command_line    /bin/mv /usr/local/pnp4nagios/var/host-perfdata /usr/local/pnp4nagios/var/spool/host-perfdata.$TIMET$\n}\n\n\n$ sudo sed -i'' 's|^ *LOG_FILE *=.*|LOG_FILE = /var/log/icinga/perfdata.log|' /usr/local/pnp4nagios/etc/process_perfdata.cfg\n\n\u8a2d\u5b9a\u304c\u5b8c\u4e86\u3057\u305f\u3089Icinga\u3068Apache\u3092\u518d\u8d77\u52d5\u3057\u307e\u3059\u3002\n$ sudo service icinga restart\n$ sudo service httpd restart\n\n\u6b63\u3057\u304f\u8a2d\u5b9a\u3055\u308c\u305f\u304b\u78ba\u8a8d\u3057\u307e\u3059\u3002\nhttp://[domain]/pnp4nagios/\nID: nagiosadmin PW: nagiosadmin\n\u6b63\u3057\u304f\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u5834\u5408\u306f\u3059\u3079\u3066\u30b0\u30ea\u30fc\u30f3OK\u306b\u306a\u308b\u306e\u3067\u3001index.php\u3092\u524a\u9664\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n$ sudo rm /usr/local/pnp4nagios/share/install.php\n\n\nIcinga\u3068\u306e\u9023\u643a\npnp4nagios\u3068Icinga\u3092\u9023\u643a\u3057\u3066Icinga\u304b\u3089\u30b0\u30e9\u30d5\u8868\u793a\u3067\u304d\u308b\u3088\u3046\u306b\u3057\u307e\u3059\u3002\n\u4eca\u56de\u306f\u3001Bulk with NPCD \u30e2\u30fc\u30c9\u3067\u306e\u8a2d\u5b9a\u3092\u7d39\u4ecb\u3057\u307e\u3059\u3002\n\u203b\u6700\u3082\u30d1\u30d5\u30a9\u30fc\u30de\u30f3\u30b9\u304c\u826f\u3044\u3002\n$ sudo sed -i'' 's/^ *process_performance_data *=.*/process_performance_data=1/' /etc/icinga/icinga.cfg\n$ sudo sed -i'' \"s|^ *# *host_perfdata_file *=.*|host_perfdata_file=/usr/local/pnp4nagios/var/host-perfdata|\" /etc/icinga/icinga.cfg\n$ sudo sed -i'' \"s|^ *# *service_perfdata_file *=.*|service_perfdata_file=/usr/local/pnp4nagios/var/service-perfdata|\" /etc/icinga/icinga.cfg\n$ sudo sed -i'' 's/^ *# *host_perfdata_file_mode *=.*/host_perfdata_file_mode=a/' /etc/icinga/icinga.cfg\n$ sudo sed -i'' 's/^ *# *service_perfdata_file_mode *=.*/service_perfdata_file_mode=a/' /etc/icinga/icinga.cfg\n$ sudo sed -i'' 's/^ *# *host_perfdata_file_processing_interval *=.*/host_perfdata_file_processing_interval=30/' /etc/icinga/icinga.cfg\n$ sudo sed -i'' 's/^ *# *service_perfdata_file_processing_interval *=.*/service_perfdata_file_processing_interval=30/' /etc/icinga/icinga.cfg\n$ sudo sed -i'' 's/^ *# *host_perfdata_file_processing_command *=.*/host_perfdata_file_processing_command=process-host-perfdata-file/' /etc/icinga/icinga.cfg\n$ sudo sed -i'' 's/^ *# *service_perfdata_file_processing_command *=.*/service_perfdata_file_processing_command=process-service-perfdata-file/' /etc/icinga/icinga.cfg\n\n\n/etc/icinga/icinga.cfg\n- #host_perfdata_file_template=[HOSTPERFDATA]\\t$TIMET$\\t$HOSTNAME$\\t$HOSTEXECUTIONTIME$\\t$HOSTOUTPUT$\\t$HOSTPERFDATA$\n- #service_perfdata_file_template=[SERVICEPERFDATA]\\t$TIMET$\\t$HOSTNAME$\\t$SERVICEDESC$\\t$SERVICEEXECUTIONTIME$\\t$SERVICELATENCY$\\t$SERVICEOUTPUT$\\t$SERVICEPERFDATA$\n\n+ host_perfdata_file_template=DATATYPE::HOSTPERFDATA\\tTIMET::$TIMET$\\tHOSTNAME::$HOSTNAME$\\tHOSTPERFDATA::$HOSTPERFDATA$\\tHOSTCHECKCOMMAND::$HOSTCHECKCOMMAND$\\tHOSTSTATE::$HOSTSTATE$\\tHOSTSTATETYPE::$HOSTSTATETYPE$\n+ service_perfdata_file_template=DATATYPE::SERVICEPERFDATA\\tTIMET::$TIMET$\\tHOSTNAME::$HOSTNAME$\\tSERVICEDESC::$SERVICEDESC$\\tSERVICEPERFDATA::$SERVICEPERFDATA$\\tSERVICECHECKCOMMAND::$SERVICECHECKCOMMAND$\\tHOSTSTATE::$HOSTSTATE$\\tHOSTSTATETYPE::$HOSTSTATETYPE$\\tSERVICESTATE::$SERVICESTATE$\\tSERVICESTATETYPE::$SERVICESTATETYPE$\n\n\n\n/etc/icinga/objects/commands.cfg\n# \u30b3\u30e1\u30f3\u30c8\u30a2\u30a6\u30c8\n# 'process-host-perfdata' command definition\n#define command{\n#       command_name    process-host-perfdata\n#       command_line    /usr/bin/printf \"%b\" \"$LASTHOSTCHECK$\\t$HOSTNAME$\\t$HOSTSTATE$\\t$HOSTATTEMPT$\\t$HOSTSTATETYPE$\\t$HOSTEXECUTIONTIME$\\t$HOSTOUTPUT$\\t$HOSTPERFDATA$\\n\" >> /var/spool/icinga/host-perfdata.out\n#       }\n\n\n# 'process-service-perfdata' command definition\n#define command{\n#       command_name    process-service-perfdata\n#       command_line    /usr/bin/printf \"%b\" \"$LASTSERVICECHECK$\\t$HOSTNAME$\\t$SERVICEDESC$\\t$SERVICESTATE$\\t$SERVICEATTEMPT$\\t$SERVICESTATETYPE$\\t$SERVICEEXECUTIONTIME$\\t$SERVICELATENCY$\\t$SERVICEOUTPUT$\\t$SERVICEPERFDATA$\\n\" >> /var/spool/icinga/service-perfdata.out\n#       }\n\n# \u4ee5\u4e0b\u3001\u8ffd\u52a0\ndefine command {\n       command_name    process-service-perfdata-file\n       command_line    /bin/mv /usr/local/pnp4nagios/var/service-perfdata /usr/local/pnp4nagios/var/spool/service-perfdata.$TIMET$\n}\n\ndefine command {\n       command_name    process-host-perfdata-file\n       command_line    /bin/mv /usr/local/pnp4nagios/var/host-perfdata /usr/local/pnp4nagios/var/spool/host-perfdata.$TIMET$\n}\n\n\n\n/etc/icinga/objects/templates.cfg\ndefine host{\n        name                            generic-host\n        ...(\u7701\u7565)...\n        register                        0\n        action_url                      /pnp4nagios/index.php/graph?host=$HOSTNAME$&srv=_HOST_  ; \u8ffd\u52a0\n\n...(\u7701\u7565)...\n\ndefine service{\n        name                            generic-service\n        ...\n        register                        0\n        action_url                      /pnp4nagios/index.php/graph?host=$HOSTNAME$&srv=$SERVICEDESC$  ; \u8ffd\u52a0\n\n\n\nnpcd\n$ sudo sed -i'' 's|^ *config=.*|config=\"/usr/local/pnp4nagios/etc/npcd.cfg\"|' /etc/init.d/npcd\n$ sudo chown -R icinga:icinga /var/log/pnp4nagios\n\n$ sudo chkconfig npcd --add\n$ sudo chkconfig npcd on\n$ sudo service npcd start\n$ sudo service icinga restart\n$ sudo service httpd restart\n\n\n\u78ba\u8a8d\n$ ls /usr/local/pnp4nagios/var/host-perfdata\n/usr/local/pnp4nagios/var/host-perfdata\n$ ls /usr/local/pnp4nagios/var/service-perfdata\n/usr/local/pnp4nagios/var/service-perfdata\n# \u30bf\u30a4\u30df\u30f3\u30b0\u306b\u3088\u3063\u3066\u306f\u30d5\u30a1\u30a4\u30eb\u304c\u306a\u3044\u5834\u5408\u3082\u3042\u308b\n$ ls /usr/local/pnp4nagios/var/spool/\nhost-perfdata.1424428761  perfdata.1424428761  service-perfdata.1424428761\n\nhttp://[Domain]/icinga/ \u306b\u30a2\u30af\u30bb\u30b9\u3057\u3066\u4e0b\u56f3\u306e\u3088\u3046\u306b\u6b6f\u8eca\u304c\u8868\u793a\u3055\u308c\u308b\u306e\u3067\u3001\u30af\u30ea\u30c3\u30af\u3059\u308b\u3068\u30b0\u30e9\u30d5\u8868\u793a\u3055\u308c\u308b\u306f\u305a\u3067\u3059\u3002\n\u753b\u50cf\u8868\u793a\u3055\u308c\u308b\u307e\u3067\u306b\u591a\u5c11\u6642\u9593\u304c\u304b\u304b\u308a\u307e\u3059\u3002\n\n\n\u753b\u50cf\u8868\u793a\u3055\u308c\u306a\u304b\u3063\u305f\u3089\u30ed\u30b0\u3092\u78ba\u8a8d\u3057\u3066\u8a2d\u5b9a\u3092\u898b\u76f4\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n$ tail -f /var/log/icinga/perfdata.log\n\n\nIcinga-web\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\nIcinga Classic\u3088\u308a\u3082\u30ea\u30c3\u30c1\u306aUI\u3067\u3042\u308bIcinga-web\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\nIcinga\u30ea\u30dd\u30b8\u30c8\u30ea\u304c\u3042\u308b\u306e\u3067yum\u3067\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3067\u304d\u307e\u3059\u3002\n$ sudo yum install icinga-web icinga-web-mysql icinga-web-module-pnp\n\n\n\u8a2d\u5b9a\n\nMySQL\n$ echo \"CREATE DATABASE icinga_web; \\\nGRANT USAGE ON icinga_web.* TO 'icinga_web'@'localhost' IDENTIFIED BY 'icinga_web' WITH MAX_QUERIES_PER_HOUR 0 MAX_CONNECTIONS_PER_HOUR 0 MAX_UPDATES_PER_HOUR 0; \\\nGRANT SELECT, INSERT, UPDATE, DELETE, DROP, CREATE, CREATE VIEW, INDEX, EXECUTE ON icinga_web.* TO 'icinga_web'@'localhost'; \\\nFLUSH PRIVILEGES;\" | mysql -u root -p -h localhost\n$ mysql -u root -p -h localhost icinga_web < /usr/share/doc/icinga-web-*/schema/mysql.sql\n\n$ sudo service httpd restart\n$ sudo service icinga restart\n\n\n\u78ba\u8a8d\nhttp://[Domain]/icinga-web/\nID: root PW: password\n\nUI\u304c\u30ea\u30c3\u30c1\u306b\u306a\u3063\u305f\u304c\u8868\u793a\u304c\u91cd\u304b\u3063\u305f\u308a\u3001\u5c11\u3005\u4f7f\u3044\u3065\u3089\u3044\u3067\u3059\u3002\n\n\u88dc\u8db3\nicinga-web\u3092yum\u3067\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u305f\u5834\u5408\u3001pnp4nagios\u3082\u4f9d\u5b58\u95a2\u4fc2\u3067\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u307e\u3059\u3002\n\u305d\u306e\u305f\u3081\u3001\u5148\u306b\u30bd\u30fc\u30b9\u3067\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u305fpnp4nagios\u306e\u8a2d\u5b9a\u304c\u4e0a\u66f8\u304d\u3055\u308c\u308b\u3053\u3068\u304c\u3042\u308a\u307e\u3059\u3002\n\u5909\u66f4\u3055\u308c\u305f\u7b87\u6240\u3092\u3082\u3046\u4e00\u5ea6\u4fee\u6b63\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u3001\u4e0b\u8a18\u306e\u30b3\u30de\u30f3\u30c9\u3092\u3082\u3046\u4e00\u5ea6\u5b9f\u884c\u3057\u307e\u3059\u3002\n$ sudo sed -i'' 's|^ *config=.*|config=\"/usr/local/pnp4nagios/etc/npcd.cfg\"|' /etc/init.d/npcd\n$ sudo chown -R icinga:icinga /var/log/pnp4nagios\n$ sudo service npcd restart\n\n\n\u88dc\u8db32\nIcinga-web\u3067\u30a8\u30e9\u30fc\u304c\u51fa\u305f\u306e\u3067\u5bfe\u5fdc\u65b9\u6cd5\u3092\u6295\u7a3f\u3057\u307e\u3057\u305f\u3002\nhttp://qiita.com/shu1/items/33951764f1edfde7a5ec\n\n# Icinga\u3068\u306f\n\nIcinga(\u30a2\u30a4\u30b7\u30f3\u30ac)\u306fNagios\u304b\u3089fork\u3057\u305f\u30e2\u30cb\u30bf\u30ea\u30f3\u30b0\u30b7\u30b9\u30c6\u30e0\u3002\n\n# \u30d0\u30fc\u30b8\u30e7\u30f3\u306e\u9055\u3044\n\n## Icinga 1\n\n* Nagios\u306e\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3001\u30d7\u30e9\u30b0\u30a4\u30f3\u3001\u30a2\u30c9\u30aa\u30f3\u3068\u4e92\u63db\u6027\u304c\u3042\u308b\n* Nagios\u6642\u4ee3\u306e\u6570\u591a\u304f\u306eBugfix\u3084\u6a5f\u80fd\u304c\u8ffd\u52a0\u3055\u308c\u3066\u3044\u308b\n\n## Icinga 2\n\n* \u30b3\u30a2\u304b\u3089\u4f5c\u308a\u66ff\u3048\u3089\u308c\u3066\u304a\u308a\u3001Icinga 1\u304a\u3088\u3073Nagios\u3068\u306f\u4e92\u63db\u6027\u304c\u306a\u3044\n\n\u4eca\u56de\u306fNagios\u3068\u306e\u4e92\u63db\u6027\u304c\u3042\u308b\u3001Icinga 1\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\n\n# Icinga Classic\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\nUI\u304cNagios\u306b\u8fd1\u3044Icinga Classic\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\n\n## \u4f9d\u5b58\u30d1\u30c3\u30b1\u30fc\u30b8\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n```bash\n$ sudo yum install gcc httpd glibc glibc-common gd\n```\n\nMySQL Server\u3092\u4f7f\u3046\u306e\u3067\u5165\u308c\u307e\u3059\u3002\n\u5225\u9014MySQL\u30b5\u30fc\u30d0\u304c\u3042\u308b\u5834\u5408\u306f\u3001mysql client\u3067\u3082\u826f\u3044\u3067\u3059\u3002\n\n```bash\n$ sudo yum install mysql-server\n```\n\n## Icinga\u306e\u30ea\u30dd\u30b8\u30c8\u30ea\u8ffd\u52a0\n\nIcinga\u306e\u30ea\u30dd\u30b8\u30c8\u30ea\u3092\u8ffd\u52a0\u3057\u3066\u30d1\u30c3\u30b1\u30fc\u30b8\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\n\n```\n$ cd /etc/yum.repos.d/\n$ sudo wget http://packages.icinga.org/epel/ICINGA-release.repo\n```\n\nIcinga\u30d1\u30c3\u30b1\u30fc\u30b8\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\n\n```bash\n$ sudo yum install icinga icinga-gui icinga-idoutils icinga-idoutils-libdbi-mysql nagios-plugins nagios-plugins-mysql\n```\n\nnrpe, nagios\u30d7\u30e9\u30b0\u30a4\u30f3\u304c\u4f7f\u3048\u308b\u306e\u3067\u3001\u4f75\u305b\u3066\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\n\n```bash\n$ sudo yum install nrpe nagios-plugins-nrpe\n$ sudo yum install nagios-plugins-all\n```\n\n## \u8a2d\u5b9a\n\n### MySQL\n\n```/etc/my.cnf\n# \u4ee5\u4e0b\u3092\u8ffd\u52a0\n[mysqld]\ncharacter-set-server = utf8\n\n[client]\ndefault-character-set = utf8\n```\n\n```bash\n$ sudo chkconfig mysqld --add\n$ sudo chkconfig mysqld on\n$ sudo service mysqld start\n$ /usr/bin/mysqladmin -u root password 'new-password'\n\n$ echo \"CREATE DATABASE icinga; \\\nGRANT USAGE ON icinga.* TO 'icinga'@'localhost' IDENTIFIED BY 'icinga' WITH MAX_QUERIES_PER_HOUR 0 MAX_CONNECTIONS_PER_HOUR 0 MAX_UPDATES_PER_HOUR 0; \\\nGRANT SELECT, INSERT, UPDATE, DELETE, DROP, CREATE, CREATE VIEW, INDEX, EXECUTE ON icinga.* TO 'icinga'@'localhost'; \\\nFLUSH PRIVILEGES;\" | mysql -u root -p -h localhost\n\n$ mysql -u root -p -h localhost icinga < /usr/share/doc/icinga-idoutils-libdbi-mysql-*/db/mysql/mysql.sql\n```\n\n### Icinga\n\n```bash\n$ sudo sed -i'' 's/^ *enable_environment_macros *=.*/enable_environment_macros=1/' /etc/icinga/icinga.cfg\n$ sudo sed -i'' 's/^ *date_format *=.*/date_format=iso8601/' /etc/icinga/icinga.cfg\n```\n\n\u6b63\u3057\u304f\u8a2d\u5b9a\u3055\u308c\u305f\u304b\u306e\u78ba\u8a8d\u3092\u3057\u307e\u3059\u3002\n\n```bash\n$ sudo icinga -v /etc/icinga/icinga.cfg\n```\n\n```\nTotal Warnings: 0\nTotal Errors:   0\n```\n\u3068\u8868\u793a\u3055\u308c\u3066\u3044\u308c\u3070OK\u3002\n\n```bash\n$ sudo chkconfig httpd --add\n$ sudo chkconfig httpd on\n$ sudo chkconfig icinga --add\n$ sudo chkconfig icinga on\n$ sudo chkconfig ido2db --add\n$ sudo chkconfig ido2db on\n$ sudo service httpd start\n$ sudo service icinga start\n$ sudo service ido2db start\n```\n\n\u30d6\u30e9\u30a6\u30b6\u304b\u3089\u78ba\u8a8d\u3057\u3066\u6b21\u306e\u3088\u3046\u306a\u753b\u9762\u304c\u8868\u793a\u3055\u308c\u308c\u3070OK\u3067\u3059\u3002\n\nhttp://[Domain]/icinga/\nID: icingaadmin PW: icingaadmin\n\n![icinga_top.png](https://qiita-image-store.s3.amazonaws.com/227/10729/861e1492-8392-74ab-4924-7154413bbb7b.png)\n\nnagios\u3068\u4f3c\u3066\u3044\u307e\u3059\u304c\u3001\u898b\u3084\u3059\u304f\u306a\u3063\u3066\u3044\u308b\u3068\u601d\u3044\u307e\u3059\u3002\n\n# pnp4nagios\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n\u53d6\u5f97\u3057\u305f\u30d1\u30d5\u30a9\u30fc\u30de\u30f3\u30b9\u30c7\u30fc\u30bf\u3092\u30b0\u30e9\u30d5\u8868\u793a\u3055\u305b\u3066\u307f\u307e\u3059\u3002\n\npnp4nagios\u306f\u30bd\u30fc\u30b9\u304b\u3089\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\n\n```bash\n# \u4f9d\u5b58\u30d1\u30c3\u30b1\u30fc\u30b8\n$ sudo yum install php php-gd rrdtool rrdtool-perl perl-Time-HiRes\n\n$ cd /usr/local/src\n$ sudo wget http://downloads.sourceforge.net/project/pnp4nagios/PNP-0.6/pnp4nagios-0.6.25.tar.gz\n$ sudo tar zxvf pnp4nagios-0.6.25.tar.gz\n$ cd pnp4nagios-0.6.25\n$ sudo ./configure --with-nagios-user=icinga --with-nagios-group=icinga\n$ sudo make all\n$ sudo make fullinstall\n```\n\n## \u8a2d\u5b9a\n\n### Apache\n\nBasic\u8a8d\u8a3c\u8a2d\u5b9a\u3092\u3059\u308b\u304b\u3001\u751f\u6210\u3055\u308c\u305f`/etc/httpd/conf.d/pnp4nagios.conf`\u306e\u8a2d\u5b9a\u3092\u5f04\u3063\u3066\u304f\u3060\u3055\u3044\u3002\n\n```bash\n$ sudo mkdir -p /usr/local/nagios/etc\n$ sudo htpasswd -c /usr/local/nagios/etc/htpasswd.users icingaadmin\nNew password: icingaadmin\nRe-type new password: icingaadmin\n```\n\n### PHP\n\n\u30bf\u30a4\u30e0\u30be\u30fc\u30f3\u304c\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u306a\u3051\u308c\u3070\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n\n```bash\n$ sudo sed -i'' \"s|^[ ;]*date.timezone *=.*|date.timezone='Asia/Tokyo'|\" /etc/php.ini\n```\n\n### pnp4nagios\n\nNagios\u7528\u306e\u8a2d\u5b9a\u306b\u306a\u3063\u3066\u3044\u308b\u306e\u3067Icinga\u7528\u306b\u5909\u66f4\u3057\u307e\u3059\u3002\n\n```/usr/local/pnp4nagios/etc/config_local.php\n- $conf['nagios_base'] = \"/nagios/cgi-bin\";\n+ $conf['nagios_base'] = \"/icinga/cgi-bin\";\n\n- $conf['date_fmt'] = \"d.m.y G:i\";\n+ $conf['date_fmt'] = \"Y.m.d G:i\";  // \u65e5\u4ed8\u5f62\u5f0f\u3092YYYY.MM.DD\u306b\u3059\u308b\n```\n\n```/usr/local/pnp4nagios/etc/config.php\n- $conf['nagios_base'] = \"/nagios/cgi-bin\";\n+ $conf['nagios_base'] = \"/icinga/cgi-bin\";\n\n- $conf['date_fmt'] = \"d.m.y G:i\";\n+ $conf['date_fmt'] = \"Y.m.d G:i\";  // \u65e5\u4ed8\u5f62\u5f0f\u3092YYYY.MM.DD\u306b\u3059\u308b\n```\n\n```bash\n$ cd /usr/local/pnp4nagios/etc/\n$ sudo mv rra.cfg-sample rra.cfg\n$ sudo mv nagios.cfg-sample icinga.cfg\n$ sudo mv misccommands.cfg-sample misccommands.cfg\n\n$ sudo sed -i'' 's/^ *user *=.*/user = icinga/' /usr/local/pnp4nagios/etc/npcd.cfg\n$ sudo sed -i'' 's/^ *group *=.*/group = icinga/' /usr/local/pnp4nagios/etc/npcd.cfg\n$ sudo sed -i'' 's/^ *log_type *=.*/log_type = file/' /usr/local/pnp4nagios/etc/npcd.cfg\n$ sudo sed -i'' 's/^ *load_threshold *=.*/load_threshold = 10.0/' /usr/local/pnp4nagios/etc/npcd.cfg\n$ sudo sed -i'' 's|^ *log_file *=.*|log_file = /var/log/pnp4nagios/npcd.log|' /usr/local/pnp4nagios/etc/npcd.cfg\n```\n\n```/usr/local/pnp4nagios/etc/misccommands.cfg\n# \u30b3\u30e1\u30f3\u30c8\u5916\u3059\n#\n# Bulk with NPCD mode\n#\ndefine command {\n       command_name    process-service-perfdata-file\n       command_line    /bin/mv /usr/local/pnp4nagios/var/service-perfdata /usr/local/pnp4nagios/var/spool/service-perfdata.$TIMET$\n}\n\ndefine command {\n       command_name    process-host-perfdata-file\n       command_line    /bin/mv /usr/local/pnp4nagios/var/host-perfdata /usr/local/pnp4nagios/var/spool/host-perfdata.$TIMET$\n}\n```\n\n```bash\n$ sudo sed -i'' 's|^ *LOG_FILE *=.*|LOG_FILE = /var/log/icinga/perfdata.log|' /usr/local/pnp4nagios/etc/process_perfdata.cfg\n```\n\n\u8a2d\u5b9a\u304c\u5b8c\u4e86\u3057\u305f\u3089Icinga\u3068Apache\u3092\u518d\u8d77\u52d5\u3057\u307e\u3059\u3002\n\n```bash\n$ sudo service icinga restart\n$ sudo service httpd restart\n```\n\n\u6b63\u3057\u304f\u8a2d\u5b9a\u3055\u308c\u305f\u304b\u78ba\u8a8d\u3057\u307e\u3059\u3002\n\nhttp://[domain]/pnp4nagios/\n\nID: nagiosadmin PW: nagiosadmin\n\n\u6b63\u3057\u304f\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u5834\u5408\u306f\u3059\u3079\u3066\u30b0\u30ea\u30fc\u30f3OK\u306b\u306a\u308b\u306e\u3067\u3001`index.php`\u3092\u524a\u9664\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n```bash\n$ sudo rm /usr/local/pnp4nagios/share/install.php\n```\n\n## Icinga\u3068\u306e\u9023\u643a\n\npnp4nagios\u3068Icinga\u3092\u9023\u643a\u3057\u3066Icinga\u304b\u3089\u30b0\u30e9\u30d5\u8868\u793a\u3067\u304d\u308b\u3088\u3046\u306b\u3057\u307e\u3059\u3002\n\u4eca\u56de\u306f\u3001Bulk with NPCD \u30e2\u30fc\u30c9\u3067\u306e\u8a2d\u5b9a\u3092\u7d39\u4ecb\u3057\u307e\u3059\u3002\n\u203b\u6700\u3082\u30d1\u30d5\u30a9\u30fc\u30de\u30f3\u30b9\u304c\u826f\u3044\u3002\n\n```bash\n$ sudo sed -i'' 's/^ *process_performance_data *=.*/process_performance_data=1/' /etc/icinga/icinga.cfg\n$ sudo sed -i'' \"s|^ *# *host_perfdata_file *=.*|host_perfdata_file=/usr/local/pnp4nagios/var/host-perfdata|\" /etc/icinga/icinga.cfg\n$ sudo sed -i'' \"s|^ *# *service_perfdata_file *=.*|service_perfdata_file=/usr/local/pnp4nagios/var/service-perfdata|\" /etc/icinga/icinga.cfg\n$ sudo sed -i'' 's/^ *# *host_perfdata_file_mode *=.*/host_perfdata_file_mode=a/' /etc/icinga/icinga.cfg\n$ sudo sed -i'' 's/^ *# *service_perfdata_file_mode *=.*/service_perfdata_file_mode=a/' /etc/icinga/icinga.cfg\n$ sudo sed -i'' 's/^ *# *host_perfdata_file_processing_interval *=.*/host_perfdata_file_processing_interval=30/' /etc/icinga/icinga.cfg\n$ sudo sed -i'' 's/^ *# *service_perfdata_file_processing_interval *=.*/service_perfdata_file_processing_interval=30/' /etc/icinga/icinga.cfg\n$ sudo sed -i'' 's/^ *# *host_perfdata_file_processing_command *=.*/host_perfdata_file_processing_command=process-host-perfdata-file/' /etc/icinga/icinga.cfg\n$ sudo sed -i'' 's/^ *# *service_perfdata_file_processing_command *=.*/service_perfdata_file_processing_command=process-service-perfdata-file/' /etc/icinga/icinga.cfg\n```\n\n```/etc/icinga/icinga.cfg\n- #host_perfdata_file_template=[HOSTPERFDATA]\\t$TIMET$\\t$HOSTNAME$\\t$HOSTEXECUTIONTIME$\\t$HOSTOUTPUT$\\t$HOSTPERFDATA$\n- #service_perfdata_file_template=[SERVICEPERFDATA]\\t$TIMET$\\t$HOSTNAME$\\t$SERVICEDESC$\\t$SERVICEEXECUTIONTIME$\\t$SERVICELATENCY$\\t$SERVICEOUTPUT$\\t$SERVICEPERFDATA$\n\n+ host_perfdata_file_template=DATATYPE::HOSTPERFDATA\\tTIMET::$TIMET$\\tHOSTNAME::$HOSTNAME$\\tHOSTPERFDATA::$HOSTPERFDATA$\\tHOSTCHECKCOMMAND::$HOSTCHECKCOMMAND$\\tHOSTSTATE::$HOSTSTATE$\\tHOSTSTATETYPE::$HOSTSTATETYPE$\n+ service_perfdata_file_template=DATATYPE::SERVICEPERFDATA\\tTIMET::$TIMET$\\tHOSTNAME::$HOSTNAME$\\tSERVICEDESC::$SERVICEDESC$\\tSERVICEPERFDATA::$SERVICEPERFDATA$\\tSERVICECHECKCOMMAND::$SERVICECHECKCOMMAND$\\tHOSTSTATE::$HOSTSTATE$\\tHOSTSTATETYPE::$HOSTSTATETYPE$\\tSERVICESTATE::$SERVICESTATE$\\tSERVICESTATETYPE::$SERVICESTATETYPE$\n```\n\n\n```/etc/icinga/objects/commands.cfg\n# \u30b3\u30e1\u30f3\u30c8\u30a2\u30a6\u30c8\n# 'process-host-perfdata' command definition\n#define command{\n#       command_name    process-host-perfdata\n#       command_line    /usr/bin/printf \"%b\" \"$LASTHOSTCHECK$\\t$HOSTNAME$\\t$HOSTSTATE$\\t$HOSTATTEMPT$\\t$HOSTSTATETYPE$\\t$HOSTEXECUTIONTIME$\\t$HOSTOUTPUT$\\t$HOSTPERFDATA$\\n\" >> /var/spool/icinga/host-perfdata.out\n#       }\n\n\n# 'process-service-perfdata' command definition\n#define command{\n#       command_name    process-service-perfdata\n#       command_line    /usr/bin/printf \"%b\" \"$LASTSERVICECHECK$\\t$HOSTNAME$\\t$SERVICEDESC$\\t$SERVICESTATE$\\t$SERVICEATTEMPT$\\t$SERVICESTATETYPE$\\t$SERVICEEXECUTIONTIME$\\t$SERVICELATENCY$\\t$SERVICEOUTPUT$\\t$SERVICEPERFDATA$\\n\" >> /var/spool/icinga/service-perfdata.out\n#       }\n\n# \u4ee5\u4e0b\u3001\u8ffd\u52a0\ndefine command {\n       command_name    process-service-perfdata-file\n       command_line    /bin/mv /usr/local/pnp4nagios/var/service-perfdata /usr/local/pnp4nagios/var/spool/service-perfdata.$TIMET$\n}\n\ndefine command {\n       command_name    process-host-perfdata-file\n       command_line    /bin/mv /usr/local/pnp4nagios/var/host-perfdata /usr/local/pnp4nagios/var/spool/host-perfdata.$TIMET$\n}\n```\n\n```/etc/icinga/objects/templates.cfg\ndefine host{\n        name                            generic-host\n        ...(\u7701\u7565)...\n        register                        0\n        action_url                      /pnp4nagios/index.php/graph?host=$HOSTNAME$&srv=_HOST_  ; \u8ffd\u52a0\n\n...(\u7701\u7565)...\n\ndefine service{\n        name                            generic-service\n        ...\n        register                        0\n        action_url                      /pnp4nagios/index.php/graph?host=$HOSTNAME$&srv=$SERVICEDESC$  ; \u8ffd\u52a0\n```\n\n### npcd\n\n```bash\n$ sudo sed -i'' 's|^ *config=.*|config=\"/usr/local/pnp4nagios/etc/npcd.cfg\"|' /etc/init.d/npcd\n$ sudo chown -R icinga:icinga /var/log/pnp4nagios\n```\n\n```bash\n$ sudo chkconfig npcd --add\n$ sudo chkconfig npcd on\n$ sudo service npcd start\n$ sudo service icinga restart\n$ sudo service httpd restart\n```\n\n### \u78ba\u8a8d\n\n```bash\n$ ls /usr/local/pnp4nagios/var/host-perfdata\n/usr/local/pnp4nagios/var/host-perfdata\n$ ls /usr/local/pnp4nagios/var/service-perfdata\n/usr/local/pnp4nagios/var/service-perfdata\n# \u30bf\u30a4\u30df\u30f3\u30b0\u306b\u3088\u3063\u3066\u306f\u30d5\u30a1\u30a4\u30eb\u304c\u306a\u3044\u5834\u5408\u3082\u3042\u308b\n$ ls /usr/local/pnp4nagios/var/spool/\nhost-perfdata.1424428761  perfdata.1424428761  service-perfdata.1424428761\n```\n\nhttp://[Domain]/icinga/ \u306b\u30a2\u30af\u30bb\u30b9\u3057\u3066\u4e0b\u56f3\u306e\u3088\u3046\u306b\u6b6f\u8eca\u304c\u8868\u793a\u3055\u308c\u308b\u306e\u3067\u3001\u30af\u30ea\u30c3\u30af\u3059\u308b\u3068\u30b0\u30e9\u30d5\u8868\u793a\u3055\u308c\u308b\u306f\u305a\u3067\u3059\u3002\n\u753b\u50cf\u8868\u793a\u3055\u308c\u308b\u307e\u3067\u306b\u591a\u5c11\u6642\u9593\u304c\u304b\u304b\u308a\u307e\u3059\u3002\n\n![icinga_pnp4nagios_1.png](https://qiita-image-store.s3.amazonaws.com/227/10729/0b36c9bb-1eab-e791-400b-837da1f83b64.png)\n\n\n![icinga_pnp4nagios_2.png](https://qiita-image-store.s3.amazonaws.com/227/10729/537f5a18-5ae6-4505-1e2a-feba3a726a2c.png)\n\n\u753b\u50cf\u8868\u793a\u3055\u308c\u306a\u304b\u3063\u305f\u3089\u30ed\u30b0\u3092\u78ba\u8a8d\u3057\u3066\u8a2d\u5b9a\u3092\u898b\u76f4\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n```bash\n$ tail -f /var/log/icinga/perfdata.log\n```\n\n# Icinga-web\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\nIcinga Classic\u3088\u308a\u3082\u30ea\u30c3\u30c1\u306aUI\u3067\u3042\u308bIcinga-web\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\n\nIcinga\u30ea\u30dd\u30b8\u30c8\u30ea\u304c\u3042\u308b\u306e\u3067yum\u3067\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3067\u304d\u307e\u3059\u3002\n\n```bash\n$ sudo yum install icinga-web icinga-web-mysql icinga-web-module-pnp\n```\n\n## \u8a2d\u5b9a\n\n### MySQL\n\n```bash\n$ echo \"CREATE DATABASE icinga_web; \\\nGRANT USAGE ON icinga_web.* TO 'icinga_web'@'localhost' IDENTIFIED BY 'icinga_web' WITH MAX_QUERIES_PER_HOUR 0 MAX_CONNECTIONS_PER_HOUR 0 MAX_UPDATES_PER_HOUR 0; \\\nGRANT SELECT, INSERT, UPDATE, DELETE, DROP, CREATE, CREATE VIEW, INDEX, EXECUTE ON icinga_web.* TO 'icinga_web'@'localhost'; \\\nFLUSH PRIVILEGES;\" | mysql -u root -p -h localhost\n$ mysql -u root -p -h localhost icinga_web < /usr/share/doc/icinga-web-*/schema/mysql.sql\n```\n\n```bash\n$ sudo service httpd restart\n$ sudo service icinga restart\n```\n\n### \u78ba\u8a8d\n\nhttp://[Domain]/icinga-web/\n\nID: root PW: password\n\n![icinga-web.png](https://qiita-image-store.s3.amazonaws.com/227/10729/b8a50177-ea2d-3b46-c1ad-725e70874529.png)\n\nUI\u304c\u30ea\u30c3\u30c1\u306b\u306a\u3063\u305f\u304c\u8868\u793a\u304c\u91cd\u304b\u3063\u305f\u308a\u3001\u5c11\u3005\u4f7f\u3044\u3065\u3089\u3044\u3067\u3059\u3002\n\n## \u88dc\u8db3\n\nicinga-web\u3092yum\u3067\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u305f\u5834\u5408\u3001pnp4nagios\u3082\u4f9d\u5b58\u95a2\u4fc2\u3067\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u307e\u3059\u3002\n\u305d\u306e\u305f\u3081\u3001\u5148\u306b\u30bd\u30fc\u30b9\u3067\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u305fpnp4nagios\u306e\u8a2d\u5b9a\u304c\u4e0a\u66f8\u304d\u3055\u308c\u308b\u3053\u3068\u304c\u3042\u308a\u307e\u3059\u3002\n\u5909\u66f4\u3055\u308c\u305f\u7b87\u6240\u3092\u3082\u3046\u4e00\u5ea6\u4fee\u6b63\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u3001\u4e0b\u8a18\u306e\u30b3\u30de\u30f3\u30c9\u3092\u3082\u3046\u4e00\u5ea6\u5b9f\u884c\u3057\u307e\u3059\u3002\n\n```bash\n$ sudo sed -i'' 's|^ *config=.*|config=\"/usr/local/pnp4nagios/etc/npcd.cfg\"|' /etc/init.d/npcd\n$ sudo chown -R icinga:icinga /var/log/pnp4nagios\n$ sudo service npcd restart\n```\n\n## \u88dc\u8db32\n\nIcinga-web\u3067\u30a8\u30e9\u30fc\u304c\u51fa\u305f\u306e\u3067\u5bfe\u5fdc\u65b9\u6cd5\u3092\u6295\u7a3f\u3057\u307e\u3057\u305f\u3002\nhttp://qiita.com/shu1/items/33951764f1edfde7a5ec\n\n", "tags": ["Nagios", "icinga"]}