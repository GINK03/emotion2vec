{"context": " More than 1 year has passed since last update.\u53c2\u8003webglorg;\n\u539f\u5247\u3068\u3057\u3066\u4e0a\u8a18\u30da\u30fc\u30b8\u3092\u898b\u306a\u304c\u3089\u5b66\u7fd2\u3057\u305f\u8a18\u9332\u3067\u3059\u3002\n\n\u30ab\u30ea\u30f3\u30b0\u3068\u306f\n\u88cf\u8868\u3092\u5224\u65ad\u57fa\u6e96\u306b\u305d\u306e\u30dd\u30ea\u30b4\u30f3\u3092\u30ec\u30f3\u30c0\u30ea\u30f3\u30b0\u3059\u308b\u304b\u3069\u3046\u304b\u5224\u65ad\u3059\u308b\u3053\u3068\u3002\nWebGL\u3067\u306f\u3053\u306e\u30ab\u30ea\u30f3\u30b0\u304c\u57fa\u672c\u7684\u306b\u306ffalse\u306b\u306a\u3063\u3066\u3044\u308b\u3002\n\u30ab\u30ea\u30f3\u30b0\u3092\u6709\u52b9\u306b\u3059\u308b\u306b\u306f\ngl.enable(gl.CULL_FACE);\n\n\n\u6df1\u5ea6\u30c6\u30b9\u30c8\u3068\u306f\n\u4e09\u6b21\u5143\u7a7a\u9593\u306e\u5965\u884c\u304d\u3092\u8868\u73fe\u3059\u308b\u305f\u3081\u306b\u6b20\u304b\u305b\u306a\u3044\u8981\u7d20\u306e\u4e00\u3064\u3002\n\u30d7\u30ed\u30b0\u30e9\u30e0\u306e\u5b9f\u884c\u306e\u9806\u756a\u3067\u306f\u306a\u304f\u3001\uff13D\u7a7a\u9593\u3067\u306e\u5965\u884c\u304d\u3092\u57fa\u6e96\u3068\u3057\u3066\u63cf\u5199\u3055\u308c\u308b\u3088\u3046\u306b\u3059\u308b\u3053\u3068\u3067\u3001\u5f8c\u308d\u306b\u3042\u308b\u3082\u306e\u306f\u624b\u524d\u306e\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306b\u96a0\u308c\u3066\u63cf\u5199\u3055\u308c\u306a\u3044\u3001\u3068\u3044\u3063\u305f\u5f53\u305f\u308a\u524d\u306e\u3053\u3068\u304c\u8868\u73fe\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u308b\u3002\ngl.enable(gl.DEPTH_TEST);\n\n\n\u7acb\u4f53\u30e2\u30c7\u30eb\u306e\u63cf\u5199\n\n\u30c8\u30fc\u30e9\u30b9\u30e2\u30c7\u30eb\u3068\u3044\u3046\u3001\u30c9\u30fc\u30ca\u30c3\u30c4\u578b\u3092\u63cf\u5199\u3057\u307e\u3059\u3002\n\n\u3000\u30c8\u30fc\u30e9\u30b9\u30e2\u30c7\u30eb\u3092\u63cf\u304f\u95a2\u6570\nfunction torus(row, column, irad, orad){\n    var pos = new Array(), col = new Array(), idx = new Array();\n    for(var i = 0; i <= row; i++){\n        var r = Math.PI * 2 / row * i;\n        var rr = Math.cos(r);\n        var ry = Math.sin(r);\n        for(var ii = 0; ii <= column; ii++){\n            var tr = Math.PI * 2 / column * ii;\n            var tx = (rr * irad + orad) * Math.cos(tr);\n            var ty = ry * irad;\n            var tz = (rr * irad + orad) * Math.sin(tr);\n            pos.push(tx, ty, tz);\n            var tc = hsva(360 / column * ii, 1, 1, 1);\n            col.push(tc[0], tc[1], tc[2], tc[3]);\n        }\n    }\n    for(i = 0; i < row; i++){\n        for(ii = 0; ii < column; ii++){\n            r = (column + 1) * i + ii;\n            idx.push(r, r + column + 1, r + 1);\n            idx.push(r + column + 1, r + column + 2, r + 1);\n        }\n    }\n    return [pos, col, idx];\n}\n\n\u3055\u3089\u306bHSV\u3067\u306e\u8272\u6307\u5b9a\u3092RGB\u306b\u5909\u63db\u3059\u308b\u95a2\u6570\u3082\u7528\u610f\u3002\nfunction hsva(h, s, v, a){\n    if(s > 1 || v > 1 || a > 1){return;}\n    var th = h % 360;\n    var i = Math.floor(th / 60);\n    var f = th / 60 - i;\n    var m = v * (1 - s);\n    var n = v * (1 - s * f);\n    var k = v * (1 - s * (1 - f));\n    var color = new Array();\n    if(!s > 0 && !s < 0){\n        color.push(v, v, v, a); \n    } else {\n        var r = new Array(v, n, m, m, k, v);\n        var g = new Array(k, v, v, n, m, m);\n        var b = new Array(m, m, k, v, v, n);\n        color.push(r[i], g[i], b[i], a);\n    }\n    return color;\n}\n\n\n\u5168\u6587\n// sample_008\n//\n// WebGL\u3067\u7acb\u4f53\u7684\u306a\u30c8\u30fc\u30e9\u30b9\u3092\u63cf\u753b\u3059\u308b\n\nonload = function(){\n    // canvas\u30a8\u30ec\u30e1\u30f3\u30c8\u3092\u53d6\u5f97\n    var c = document.getElementById('canvas');\n    c.width = 500;\n    c.height = 300;\n\n    // webgl\u30b3\u30f3\u30c6\u30ad\u30b9\u30c8\u3092\u53d6\u5f97\n    var gl = c.getContext('webgl') || c.getContext('experimental-webgl');\n\n    // \u9802\u70b9\u30b7\u30a7\u30fc\u30c0\u3068\u30d5\u30e9\u30b0\u30e1\u30f3\u30c8\u30b7\u30a7\u30fc\u30c0\u306e\u751f\u6210\n    var v_shader = create_shader('vs');\n    var f_shader = create_shader('fs');\n\n    // \u30d7\u30ed\u30b0\u30e9\u30e0\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306e\u751f\u6210\u3068\u30ea\u30f3\u30af\n    var prg = create_program(v_shader, f_shader);\n\n    // attributeLocation\u3092\u914d\u5217\u306b\u53d6\u5f97\n    var attLocation = new Array();\n    attLocation[0] = gl.getAttribLocation(prg, 'position');\n    attLocation[1] = gl.getAttribLocation(prg, 'color');\n\n    // attribute\u306e\u8981\u7d20\u6570\u3092\u914d\u5217\u306b\u683c\u7d0d\n    var attStride = new Array();\n    attStride[0] = 3;\n    attStride[1] = 4;\n\n    // \u30c8\u30fc\u30e9\u30b9\u306e\u9802\u70b9\u30c7\u30fc\u30bf\u3092\u751f\u6210\n    var torusData = torus(32, 32, 1.0, 2.0);\n    var position = torusData[0];\n    var color = torusData[1];\n    var index = torusData[2];\n\n    // VBO\u306e\u751f\u6210\n    var pos_vbo = create_vbo(position);\n    var col_vbo = create_vbo(color);\n\n    // VBO \u3092\u767b\u9332\u3059\u308b\n    set_attribute([pos_vbo, col_vbo], attLocation, attStride);\n\n    // IBO\u306e\u751f\u6210\n    var ibo = create_ibo(index);\n\n    // IBO\u3092\u30d0\u30a4\u30f3\u30c9\u3057\u3066\u767b\u9332\u3059\u308b\n    gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, ibo);\n\n    // uniformLocation\u306e\u53d6\u5f97\n    var uniLocation = gl.getUniformLocation(prg, 'mvpMatrix');\n\n    // minMatrix.js \u3092\u7528\u3044\u305f\u884c\u5217\u95a2\u9023\u51e6\u7406\n    // matIV\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u751f\u6210\n    var m = new matIV();\n\n    // \u5404\u7a2e\u884c\u5217\u306e\u751f\u6210\u3068\u521d\u671f\u5316\n    var mMatrix = m.identity(m.create());\n    var vMatrix = m.identity(m.create());\n    var pMatrix = m.identity(m.create());\n    var tmpMatrix = m.identity(m.create());\n    var mvpMatrix = m.identity(m.create());\n\n    // \u30d3\u30e5\u30fc\u00d7\u30d7\u30ed\u30b8\u30a7\u30af\u30b7\u30e7\u30f3\u5ea7\u6a19\u5909\u63db\u884c\u5217\n    m.lookAt([0.0, 0.0, 20.0], [0, 0, 0], [0, 1, 0], vMatrix);\n    m.perspective(45, c.width / c.height, 0.1, 100, pMatrix);\n    m.multiply(pMatrix, vMatrix, tmpMatrix);\n\n    // \u30ab\u30a6\u30f3\u30bf\u306e\u5ba3\u8a00\n    var count = 0;\n\n    // \u30ab\u30ea\u30f3\u30b0\u3068\u6df1\u5ea6\u30c6\u30b9\u30c8\u3092\u6709\u52b9\u306b\u3059\u308b\n    gl.enable(gl.DEPTH_TEST);\n    gl.depthFunc(gl.LEQUAL);\n    gl.enable(gl.CULL_FACE);\n\n    // \u6052\u5e38\u30eb\u30fc\u30d7\n    (function(){\n        // canvas\u3092\u521d\u671f\u5316\n        gl.clearColor(0.0, 0.0, 0.0, 1.0);\n        gl.clearDepth(1.0);\n        gl.clear(gl.COLOR_BUFFER_BIT | gl.DEPTH_BUFFER_BIT);\n\n        // \u30ab\u30a6\u30f3\u30bf\u3092\u30a4\u30f3\u30af\u30ea\u30e1\u30f3\u30c8\u3059\u308b\n        count++;\n\n        // \u30ab\u30a6\u30f3\u30bf\u3092\u5143\u306b\u30e9\u30b8\u30a2\u30f3\u3092\u7b97\u51fa\n        var rad = (count % 360) * Math.PI / 180;\n\n        // \u30e2\u30c7\u30eb\u5ea7\u6a19\u5909\u63db\u884c\u5217\u306e\u751f\u6210\n        m.identity(mMatrix);\n        m.rotate(mMatrix, rad, [0, 1, 1], mMatrix);\n        m.multiply(tmpMatrix, mMatrix, mvpMatrix);\n        gl.uniformMatrix4fv(uniLocation, false, mvpMatrix);\n        gl.drawElements(gl.TRIANGLES, index.length, gl.UNSIGNED_SHORT, 0);\n\n        // \u30b3\u30f3\u30c6\u30ad\u30b9\u30c8\u306e\u518d\u63cf\u753b\n        gl.flush();\n\n        // \u30eb\u30fc\u30d7\u306e\u305f\u3081\u306b\u518d\u5e30\u547c\u3073\u51fa\u3057\n        setTimeout(arguments.callee, 1000 / 30);\n    })();\n\n    // \u30b7\u30a7\u30fc\u30c0\u3092\u751f\u6210\u3059\u308b\u95a2\u6570\n    function create_shader(id){\n        // \u30b7\u30a7\u30fc\u30c0\u3092\u683c\u7d0d\u3059\u308b\u5909\u6570\n        var shader;\n\n        // HTML\u304b\u3089script\u30bf\u30b0\u3078\u306e\u53c2\u7167\u3092\u53d6\u5f97\n        var scriptElement = document.getElementById(id);\n\n        // script\u30bf\u30b0\u304c\u5b58\u5728\u3057\u306a\u3044\u5834\u5408\u306f\u629c\u3051\u308b\n        if(!scriptElement){return;}\n\n        // script\u30bf\u30b0\u306etype\u5c5e\u6027\u3092\u30c1\u30a7\u30c3\u30af\n        switch(scriptElement.type){\n\n            // \u9802\u70b9\u30b7\u30a7\u30fc\u30c0\u306e\u5834\u5408\n            case 'x-shader/x-vertex':\n                shader = gl.createShader(gl.VERTEX_SHADER);\n                break;\n\n            // \u30d5\u30e9\u30b0\u30e1\u30f3\u30c8\u30b7\u30a7\u30fc\u30c0\u306e\u5834\u5408\n            case 'x-shader/x-fragment':\n                shader = gl.createShader(gl.FRAGMENT_SHADER);\n                break;\n            default :\n                return;\n        }\n\n        // \u751f\u6210\u3055\u308c\u305f\u30b7\u30a7\u30fc\u30c0\u306b\u30bd\u30fc\u30b9\u3092\u5272\u308a\u5f53\u3066\u308b\n        gl.shaderSource(shader, scriptElement.text);\n\n        // \u30b7\u30a7\u30fc\u30c0\u3092\u30b3\u30f3\u30d1\u30a4\u30eb\u3059\u308b\n        gl.compileShader(shader);\n\n        // \u30b7\u30a7\u30fc\u30c0\u304c\u6b63\u3057\u304f\u30b3\u30f3\u30d1\u30a4\u30eb\u3055\u308c\u305f\u304b\u30c1\u30a7\u30c3\u30af\n        if(gl.getShaderParameter(shader, gl.COMPILE_STATUS)){\n\n            // \u6210\u529f\u3057\u3066\u3044\u305f\u3089\u30b7\u30a7\u30fc\u30c0\u3092\u8fd4\u3057\u3066\u7d42\u4e86\n            return shader;\n        }else{\n\n            // \u5931\u6557\u3057\u3066\u3044\u305f\u3089\u30a8\u30e9\u30fc\u30ed\u30b0\u3092\u30a2\u30e9\u30fc\u30c8\u3059\u308b\n            alert(gl.getShaderInfoLog(shader));\n        }\n    }\n\n    // \u30d7\u30ed\u30b0\u30e9\u30e0\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u751f\u6210\u3057\u30b7\u30a7\u30fc\u30c0\u3092\u30ea\u30f3\u30af\u3059\u308b\u95a2\u6570\n    function create_program(vs, fs){\n        // \u30d7\u30ed\u30b0\u30e9\u30e0\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306e\u751f\u6210\n        var program = gl.createProgram();\n\n        // \u30d7\u30ed\u30b0\u30e9\u30e0\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306b\u30b7\u30a7\u30fc\u30c0\u3092\u5272\u308a\u5f53\u3066\u308b\n        gl.attachShader(program, vs);\n        gl.attachShader(program, fs);\n\n        // \u30b7\u30a7\u30fc\u30c0\u3092\u30ea\u30f3\u30af\n        gl.linkProgram(program);\n\n        // \u30b7\u30a7\u30fc\u30c0\u306e\u30ea\u30f3\u30af\u304c\u6b63\u3057\u304f\u884c\u306a\u308f\u308c\u305f\u304b\u30c1\u30a7\u30c3\u30af\n        if(gl.getProgramParameter(program, gl.LINK_STATUS)){\n\n            // \u6210\u529f\u3057\u3066\u3044\u305f\u3089\u30d7\u30ed\u30b0\u30e9\u30e0\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u6709\u52b9\u306b\u3059\u308b\n            gl.useProgram(program);\n\n            // \u30d7\u30ed\u30b0\u30e9\u30e0\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u8fd4\u3057\u3066\u7d42\u4e86\n            return program;\n        }else{\n\n            // \u5931\u6557\u3057\u3066\u3044\u305f\u3089\u30a8\u30e9\u30fc\u30ed\u30b0\u3092\u30a2\u30e9\u30fc\u30c8\u3059\u308b\n            alert(gl.getProgramInfoLog(program));\n        }\n    }\n\n    // VBO\u3092\u751f\u6210\u3059\u308b\u95a2\u6570\n    function create_vbo(data){\n        // \u30d0\u30c3\u30d5\u30a1\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306e\u751f\u6210\n        var vbo = gl.createBuffer();\n\n        // \u30d0\u30c3\u30d5\u30a1\u3092\u30d0\u30a4\u30f3\u30c9\u3059\u308b\n        gl.bindBuffer(gl.ARRAY_BUFFER, vbo);\n\n        // \u30d0\u30c3\u30d5\u30a1\u306b\u30c7\u30fc\u30bf\u3092\u30bb\u30c3\u30c8\n        gl.bufferData(gl.ARRAY_BUFFER, new Float32Array(data), gl.STATIC_DRAW);\n\n        // \u30d0\u30c3\u30d5\u30a1\u306e\u30d0\u30a4\u30f3\u30c9\u3092\u7121\u52b9\u5316\n        gl.bindBuffer(gl.ARRAY_BUFFER, null);\n\n        // \u751f\u6210\u3057\u305f VBO \u3092\u8fd4\u3057\u3066\u7d42\u4e86\n        return vbo;\n    }\n\n    // VBO\u3092\u30d0\u30a4\u30f3\u30c9\u3057\u767b\u9332\u3059\u308b\u95a2\u6570\n    function set_attribute(vbo, attL, attS){\n        // \u5f15\u6570\u3068\u3057\u3066\u53d7\u3051\u53d6\u3063\u305f\u914d\u5217\u3092\u51e6\u7406\u3059\u308b\n        for(var i in vbo){\n            // \u30d0\u30c3\u30d5\u30a1\u3092\u30d0\u30a4\u30f3\u30c9\u3059\u308b\n            gl.bindBuffer(gl.ARRAY_BUFFER, vbo[i]);\n\n            // attributeLocation\u3092\u6709\u52b9\u306b\u3059\u308b\n            gl.enableVertexAttribArray(attL[i]);\n\n            // attributeLocation\u3092\u901a\u77e5\u3057\u767b\u9332\u3059\u308b\n            gl.vertexAttribPointer(attL[i], attS[i], gl.FLOAT, false, 0, 0);\n        }\n    }\n\n    // IBO\u3092\u751f\u6210\u3059\u308b\u95a2\u6570\n    function create_ibo(data){\n        // \u30d0\u30c3\u30d5\u30a1\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306e\u751f\u6210\n        var ibo = gl.createBuffer();\n\n        // \u30d0\u30c3\u30d5\u30a1\u3092\u30d0\u30a4\u30f3\u30c9\u3059\u308b\n        gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, ibo);\n\n        // \u30d0\u30c3\u30d5\u30a1\u306b\u30c7\u30fc\u30bf\u3092\u30bb\u30c3\u30c8\n        gl.bufferData(gl.ELEMENT_ARRAY_BUFFER, new Int16Array(data), gl.STATIC_DRAW);\n\n        // \u30d0\u30c3\u30d5\u30a1\u306e\u30d0\u30a4\u30f3\u30c9\u3092\u7121\u52b9\u5316\n        gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, null);\n\n        // \u751f\u6210\u3057\u305fIBO\u3092\u8fd4\u3057\u3066\u7d42\u4e86\n        return ibo;\n    }\n\n    function torus(row, column, irad, orad){\n        var pos = new Array(), col = new Array(), idx = new Array();\n        for(var i = 0; i <= row; i++){\n            var r = Math.PI * 2 / row * i;\n            var rr = Math.cos(r);\n            var ry = Math.sin(r);\n            for(var ii = 0; ii <= column; ii++){\n                var tr = Math.PI * 2 / column * ii;\n                var tx = (rr * irad + orad) * Math.cos(tr);\n                var ty = ry * irad;\n                var tz = (rr * irad + orad) * Math.sin(tr);\n                pos.push(tx, ty, tz);\n                var tc = hsva(360 / column * ii, 1, 1, 1);\n                col.push(tc[0], tc[1], tc[2], tc[3]);\n            }\n        }\n        for(i = 0; i < row; i++){\n            for(ii = 0; ii < column; ii++){\n                r = (column + 1) * i + ii;\n                idx.push(r, r + column + 1, r + 1);\n                idx.push(r + column + 1, r + column + 2, r + 1);\n            }\n        }\n        return [pos, col, idx];\n    }\n\n    // HSV\u30ab\u30e9\u30fc\u53d6\u5f97\u7528\u95a2\u6570\n    function hsva(h, s, v, a){\n        if(s > 1 || v > 1 || a > 1){return;}\n        var th = h % 360;\n        var i = Math.floor(th / 60);\n        var f = th / 60 - i;\n        var m = v * (1 - s);\n        var n = v * (1 - s * f);\n        var k = v * (1 - s * (1 - f));\n        var color = new Array();\n        if(!s > 0 && !s < 0){\n            color.push(v, v, v, a); \n        } else {\n            var r = new Array(v, n, m, m, k, v);\n            var g = new Array(k, v, v, n, m, m);\n            var b = new Array(m, m, k, v, v, n);\n            color.push(r[i], g[i], b[i], a);\n        }\n        return color;\n    }\n};\n\n\n\u53c2\u8003[webglorg](http://wgld.org/);\n\u539f\u5247\u3068\u3057\u3066\u4e0a\u8a18\u30da\u30fc\u30b8\u3092\u898b\u306a\u304c\u3089\u5b66\u7fd2\u3057\u305f\u8a18\u9332\u3067\u3059\u3002\n\n## \u30ab\u30ea\u30f3\u30b0\u3068\u306f\n\u88cf\u8868\u3092\u5224\u65ad\u57fa\u6e96\u306b\u305d\u306e\u30dd\u30ea\u30b4\u30f3\u3092\u30ec\u30f3\u30c0\u30ea\u30f3\u30b0\u3059\u308b\u304b\u3069\u3046\u304b\u5224\u65ad\u3059\u308b\u3053\u3068\u3002\nWebGL\u3067\u306f\u3053\u306e\u30ab\u30ea\u30f3\u30b0\u304c\u57fa\u672c\u7684\u306b\u306ffalse\u306b\u306a\u3063\u3066\u3044\u308b\u3002\n\n\u30ab\u30ea\u30f3\u30b0\u3092\u6709\u52b9\u306b\u3059\u308b\u306b\u306f\n\n```javascript\ngl.enable(gl.CULL_FACE);\n```\n\n## \u6df1\u5ea6\u30c6\u30b9\u30c8\u3068\u306f\n\u4e09\u6b21\u5143\u7a7a\u9593\u306e\u5965\u884c\u304d\u3092\u8868\u73fe\u3059\u308b\u305f\u3081\u306b\u6b20\u304b\u305b\u306a\u3044\u8981\u7d20\u306e\u4e00\u3064\u3002\n\u30d7\u30ed\u30b0\u30e9\u30e0\u306e\u5b9f\u884c\u306e\u9806\u756a\u3067\u306f\u306a\u304f\u3001\uff13D\u7a7a\u9593\u3067\u306e\u5965\u884c\u304d\u3092\u57fa\u6e96\u3068\u3057\u3066\u63cf\u5199\u3055\u308c\u308b\u3088\u3046\u306b\u3059\u308b\u3053\u3068\u3067\u3001\u5f8c\u308d\u306b\u3042\u308b\u3082\u306e\u306f\u624b\u524d\u306e\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306b\u96a0\u308c\u3066\u63cf\u5199\u3055\u308c\u306a\u3044\u3001\u3068\u3044\u3063\u305f\u5f53\u305f\u308a\u524d\u306e\u3053\u3068\u304c\u8868\u73fe\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u308b\u3002\n\n```javascript\ngl.enable(gl.DEPTH_TEST);\n```\n\n## \u7acb\u4f53\u30e2\u30c7\u30eb\u306e\u63cf\u5199\n\n![Screen Shot 2015-10-30 at 18.48.48.png](https://qiita-image-store.s3.amazonaws.com/0/54225/aed62a57-6524-cf10-9262-557762df6e45.png \"Screen Shot 2015-10-30 at 18.48.48.png\")\n\u30c8\u30fc\u30e9\u30b9\u30e2\u30c7\u30eb\u3068\u3044\u3046\u3001\u30c9\u30fc\u30ca\u30c3\u30c4\u578b\u3092\u63cf\u5199\u3057\u307e\u3059\u3002\n\n##\u3000\u30c8\u30fc\u30e9\u30b9\u30e2\u30c7\u30eb\u3092\u63cf\u304f\u95a2\u6570\n\n```javascript\nfunction torus(row, column, irad, orad){\n    var pos = new Array(), col = new Array(), idx = new Array();\n    for(var i = 0; i <= row; i++){\n        var r = Math.PI * 2 / row * i;\n        var rr = Math.cos(r);\n        var ry = Math.sin(r);\n        for(var ii = 0; ii <= column; ii++){\n            var tr = Math.PI * 2 / column * ii;\n            var tx = (rr * irad + orad) * Math.cos(tr);\n            var ty = ry * irad;\n            var tz = (rr * irad + orad) * Math.sin(tr);\n            pos.push(tx, ty, tz);\n            var tc = hsva(360 / column * ii, 1, 1, 1);\n            col.push(tc[0], tc[1], tc[2], tc[3]);\n        }\n    }\n    for(i = 0; i < row; i++){\n        for(ii = 0; ii < column; ii++){\n            r = (column + 1) * i + ii;\n            idx.push(r, r + column + 1, r + 1);\n            idx.push(r + column + 1, r + column + 2, r + 1);\n        }\n    }\n    return [pos, col, idx];\n}\n```\n\n\u3055\u3089\u306bHSV\u3067\u306e\u8272\u6307\u5b9a\u3092RGB\u306b\u5909\u63db\u3059\u308b\u95a2\u6570\u3082\u7528\u610f\u3002\n\n```jacasctipt\nfunction hsva(h, s, v, a){\n    if(s > 1 || v > 1 || a > 1){return;}\n    var th = h % 360;\n    var i = Math.floor(th / 60);\n    var f = th / 60 - i;\n    var m = v * (1 - s);\n    var n = v * (1 - s * f);\n    var k = v * (1 - s * (1 - f));\n    var color = new Array();\n    if(!s > 0 && !s < 0){\n        color.push(v, v, v, a); \n    } else {\n        var r = new Array(v, n, m, m, k, v);\n        var g = new Array(k, v, v, n, m, m);\n        var b = new Array(m, m, k, v, v, n);\n        color.push(r[i], g[i], b[i], a);\n    }\n    return color;\n}\n```\n\n\n## \u5168\u6587\n```javascript\n// sample_008\n//\n// WebGL\u3067\u7acb\u4f53\u7684\u306a\u30c8\u30fc\u30e9\u30b9\u3092\u63cf\u753b\u3059\u308b\n\nonload = function(){\n    // canvas\u30a8\u30ec\u30e1\u30f3\u30c8\u3092\u53d6\u5f97\n    var c = document.getElementById('canvas');\n    c.width = 500;\n    c.height = 300;\n    \n    // webgl\u30b3\u30f3\u30c6\u30ad\u30b9\u30c8\u3092\u53d6\u5f97\n    var gl = c.getContext('webgl') || c.getContext('experimental-webgl');\n    \n    // \u9802\u70b9\u30b7\u30a7\u30fc\u30c0\u3068\u30d5\u30e9\u30b0\u30e1\u30f3\u30c8\u30b7\u30a7\u30fc\u30c0\u306e\u751f\u6210\n    var v_shader = create_shader('vs');\n    var f_shader = create_shader('fs');\n    \n    // \u30d7\u30ed\u30b0\u30e9\u30e0\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306e\u751f\u6210\u3068\u30ea\u30f3\u30af\n    var prg = create_program(v_shader, f_shader);\n    \n    // attributeLocation\u3092\u914d\u5217\u306b\u53d6\u5f97\n    var attLocation = new Array();\n    attLocation[0] = gl.getAttribLocation(prg, 'position');\n    attLocation[1] = gl.getAttribLocation(prg, 'color');\n    \n    // attribute\u306e\u8981\u7d20\u6570\u3092\u914d\u5217\u306b\u683c\u7d0d\n    var attStride = new Array();\n    attStride[0] = 3;\n    attStride[1] = 4;\n    \n    // \u30c8\u30fc\u30e9\u30b9\u306e\u9802\u70b9\u30c7\u30fc\u30bf\u3092\u751f\u6210\n    var torusData = torus(32, 32, 1.0, 2.0);\n    var position = torusData[0];\n    var color = torusData[1];\n    var index = torusData[2];\n    \n    // VBO\u306e\u751f\u6210\n    var pos_vbo = create_vbo(position);\n    var col_vbo = create_vbo(color);\n    \n    // VBO \u3092\u767b\u9332\u3059\u308b\n    set_attribute([pos_vbo, col_vbo], attLocation, attStride);\n    \n    // IBO\u306e\u751f\u6210\n    var ibo = create_ibo(index);\n    \n    // IBO\u3092\u30d0\u30a4\u30f3\u30c9\u3057\u3066\u767b\u9332\u3059\u308b\n    gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, ibo);\n    \n    // uniformLocation\u306e\u53d6\u5f97\n    var uniLocation = gl.getUniformLocation(prg, 'mvpMatrix');\n    \n    // minMatrix.js \u3092\u7528\u3044\u305f\u884c\u5217\u95a2\u9023\u51e6\u7406\n    // matIV\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u751f\u6210\n    var m = new matIV();\n    \n    // \u5404\u7a2e\u884c\u5217\u306e\u751f\u6210\u3068\u521d\u671f\u5316\n    var mMatrix = m.identity(m.create());\n    var vMatrix = m.identity(m.create());\n    var pMatrix = m.identity(m.create());\n    var tmpMatrix = m.identity(m.create());\n    var mvpMatrix = m.identity(m.create());\n    \n    // \u30d3\u30e5\u30fc\u00d7\u30d7\u30ed\u30b8\u30a7\u30af\u30b7\u30e7\u30f3\u5ea7\u6a19\u5909\u63db\u884c\u5217\n    m.lookAt([0.0, 0.0, 20.0], [0, 0, 0], [0, 1, 0], vMatrix);\n    m.perspective(45, c.width / c.height, 0.1, 100, pMatrix);\n    m.multiply(pMatrix, vMatrix, tmpMatrix);\n    \n    // \u30ab\u30a6\u30f3\u30bf\u306e\u5ba3\u8a00\n    var count = 0;\n    \n    // \u30ab\u30ea\u30f3\u30b0\u3068\u6df1\u5ea6\u30c6\u30b9\u30c8\u3092\u6709\u52b9\u306b\u3059\u308b\n    gl.enable(gl.DEPTH_TEST);\n    gl.depthFunc(gl.LEQUAL);\n    gl.enable(gl.CULL_FACE);\n    \n    // \u6052\u5e38\u30eb\u30fc\u30d7\n    (function(){\n        // canvas\u3092\u521d\u671f\u5316\n        gl.clearColor(0.0, 0.0, 0.0, 1.0);\n        gl.clearDepth(1.0);\n        gl.clear(gl.COLOR_BUFFER_BIT | gl.DEPTH_BUFFER_BIT);\n        \n        // \u30ab\u30a6\u30f3\u30bf\u3092\u30a4\u30f3\u30af\u30ea\u30e1\u30f3\u30c8\u3059\u308b\n        count++;\n        \n        // \u30ab\u30a6\u30f3\u30bf\u3092\u5143\u306b\u30e9\u30b8\u30a2\u30f3\u3092\u7b97\u51fa\n        var rad = (count % 360) * Math.PI / 180;\n        \n        // \u30e2\u30c7\u30eb\u5ea7\u6a19\u5909\u63db\u884c\u5217\u306e\u751f\u6210\n        m.identity(mMatrix);\n        m.rotate(mMatrix, rad, [0, 1, 1], mMatrix);\n        m.multiply(tmpMatrix, mMatrix, mvpMatrix);\n        gl.uniformMatrix4fv(uniLocation, false, mvpMatrix);\n        gl.drawElements(gl.TRIANGLES, index.length, gl.UNSIGNED_SHORT, 0);\n        \n        // \u30b3\u30f3\u30c6\u30ad\u30b9\u30c8\u306e\u518d\u63cf\u753b\n        gl.flush();\n        \n        // \u30eb\u30fc\u30d7\u306e\u305f\u3081\u306b\u518d\u5e30\u547c\u3073\u51fa\u3057\n        setTimeout(arguments.callee, 1000 / 30);\n    })();\n    \n    // \u30b7\u30a7\u30fc\u30c0\u3092\u751f\u6210\u3059\u308b\u95a2\u6570\n    function create_shader(id){\n        // \u30b7\u30a7\u30fc\u30c0\u3092\u683c\u7d0d\u3059\u308b\u5909\u6570\n        var shader;\n        \n        // HTML\u304b\u3089script\u30bf\u30b0\u3078\u306e\u53c2\u7167\u3092\u53d6\u5f97\n        var scriptElement = document.getElementById(id);\n        \n        // script\u30bf\u30b0\u304c\u5b58\u5728\u3057\u306a\u3044\u5834\u5408\u306f\u629c\u3051\u308b\n        if(!scriptElement){return;}\n        \n        // script\u30bf\u30b0\u306etype\u5c5e\u6027\u3092\u30c1\u30a7\u30c3\u30af\n        switch(scriptElement.type){\n            \n            // \u9802\u70b9\u30b7\u30a7\u30fc\u30c0\u306e\u5834\u5408\n            case 'x-shader/x-vertex':\n                shader = gl.createShader(gl.VERTEX_SHADER);\n                break;\n                \n            // \u30d5\u30e9\u30b0\u30e1\u30f3\u30c8\u30b7\u30a7\u30fc\u30c0\u306e\u5834\u5408\n            case 'x-shader/x-fragment':\n                shader = gl.createShader(gl.FRAGMENT_SHADER);\n                break;\n            default :\n                return;\n        }\n        \n        // \u751f\u6210\u3055\u308c\u305f\u30b7\u30a7\u30fc\u30c0\u306b\u30bd\u30fc\u30b9\u3092\u5272\u308a\u5f53\u3066\u308b\n        gl.shaderSource(shader, scriptElement.text);\n        \n        // \u30b7\u30a7\u30fc\u30c0\u3092\u30b3\u30f3\u30d1\u30a4\u30eb\u3059\u308b\n        gl.compileShader(shader);\n        \n        // \u30b7\u30a7\u30fc\u30c0\u304c\u6b63\u3057\u304f\u30b3\u30f3\u30d1\u30a4\u30eb\u3055\u308c\u305f\u304b\u30c1\u30a7\u30c3\u30af\n        if(gl.getShaderParameter(shader, gl.COMPILE_STATUS)){\n            \n            // \u6210\u529f\u3057\u3066\u3044\u305f\u3089\u30b7\u30a7\u30fc\u30c0\u3092\u8fd4\u3057\u3066\u7d42\u4e86\n            return shader;\n        }else{\n            \n            // \u5931\u6557\u3057\u3066\u3044\u305f\u3089\u30a8\u30e9\u30fc\u30ed\u30b0\u3092\u30a2\u30e9\u30fc\u30c8\u3059\u308b\n            alert(gl.getShaderInfoLog(shader));\n        }\n    }\n    \n    // \u30d7\u30ed\u30b0\u30e9\u30e0\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u751f\u6210\u3057\u30b7\u30a7\u30fc\u30c0\u3092\u30ea\u30f3\u30af\u3059\u308b\u95a2\u6570\n    function create_program(vs, fs){\n        // \u30d7\u30ed\u30b0\u30e9\u30e0\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306e\u751f\u6210\n        var program = gl.createProgram();\n        \n        // \u30d7\u30ed\u30b0\u30e9\u30e0\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306b\u30b7\u30a7\u30fc\u30c0\u3092\u5272\u308a\u5f53\u3066\u308b\n        gl.attachShader(program, vs);\n        gl.attachShader(program, fs);\n        \n        // \u30b7\u30a7\u30fc\u30c0\u3092\u30ea\u30f3\u30af\n        gl.linkProgram(program);\n        \n        // \u30b7\u30a7\u30fc\u30c0\u306e\u30ea\u30f3\u30af\u304c\u6b63\u3057\u304f\u884c\u306a\u308f\u308c\u305f\u304b\u30c1\u30a7\u30c3\u30af\n        if(gl.getProgramParameter(program, gl.LINK_STATUS)){\n        \n            // \u6210\u529f\u3057\u3066\u3044\u305f\u3089\u30d7\u30ed\u30b0\u30e9\u30e0\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u6709\u52b9\u306b\u3059\u308b\n            gl.useProgram(program);\n            \n            // \u30d7\u30ed\u30b0\u30e9\u30e0\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u8fd4\u3057\u3066\u7d42\u4e86\n            return program;\n        }else{\n            \n            // \u5931\u6557\u3057\u3066\u3044\u305f\u3089\u30a8\u30e9\u30fc\u30ed\u30b0\u3092\u30a2\u30e9\u30fc\u30c8\u3059\u308b\n            alert(gl.getProgramInfoLog(program));\n        }\n    }\n    \n    // VBO\u3092\u751f\u6210\u3059\u308b\u95a2\u6570\n    function create_vbo(data){\n        // \u30d0\u30c3\u30d5\u30a1\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306e\u751f\u6210\n        var vbo = gl.createBuffer();\n        \n        // \u30d0\u30c3\u30d5\u30a1\u3092\u30d0\u30a4\u30f3\u30c9\u3059\u308b\n        gl.bindBuffer(gl.ARRAY_BUFFER, vbo);\n        \n        // \u30d0\u30c3\u30d5\u30a1\u306b\u30c7\u30fc\u30bf\u3092\u30bb\u30c3\u30c8\n        gl.bufferData(gl.ARRAY_BUFFER, new Float32Array(data), gl.STATIC_DRAW);\n        \n        // \u30d0\u30c3\u30d5\u30a1\u306e\u30d0\u30a4\u30f3\u30c9\u3092\u7121\u52b9\u5316\n        gl.bindBuffer(gl.ARRAY_BUFFER, null);\n        \n        // \u751f\u6210\u3057\u305f VBO \u3092\u8fd4\u3057\u3066\u7d42\u4e86\n        return vbo;\n    }\n    \n    // VBO\u3092\u30d0\u30a4\u30f3\u30c9\u3057\u767b\u9332\u3059\u308b\u95a2\u6570\n    function set_attribute(vbo, attL, attS){\n        // \u5f15\u6570\u3068\u3057\u3066\u53d7\u3051\u53d6\u3063\u305f\u914d\u5217\u3092\u51e6\u7406\u3059\u308b\n        for(var i in vbo){\n            // \u30d0\u30c3\u30d5\u30a1\u3092\u30d0\u30a4\u30f3\u30c9\u3059\u308b\n            gl.bindBuffer(gl.ARRAY_BUFFER, vbo[i]);\n            \n            // attributeLocation\u3092\u6709\u52b9\u306b\u3059\u308b\n            gl.enableVertexAttribArray(attL[i]);\n            \n            // attributeLocation\u3092\u901a\u77e5\u3057\u767b\u9332\u3059\u308b\n            gl.vertexAttribPointer(attL[i], attS[i], gl.FLOAT, false, 0, 0);\n        }\n    }\n    \n    // IBO\u3092\u751f\u6210\u3059\u308b\u95a2\u6570\n    function create_ibo(data){\n        // \u30d0\u30c3\u30d5\u30a1\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306e\u751f\u6210\n        var ibo = gl.createBuffer();\n        \n        // \u30d0\u30c3\u30d5\u30a1\u3092\u30d0\u30a4\u30f3\u30c9\u3059\u308b\n        gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, ibo);\n        \n        // \u30d0\u30c3\u30d5\u30a1\u306b\u30c7\u30fc\u30bf\u3092\u30bb\u30c3\u30c8\n        gl.bufferData(gl.ELEMENT_ARRAY_BUFFER, new Int16Array(data), gl.STATIC_DRAW);\n        \n        // \u30d0\u30c3\u30d5\u30a1\u306e\u30d0\u30a4\u30f3\u30c9\u3092\u7121\u52b9\u5316\n        gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, null);\n        \n        // \u751f\u6210\u3057\u305fIBO\u3092\u8fd4\u3057\u3066\u7d42\u4e86\n        return ibo;\n    }\n    \n    function torus(row, column, irad, orad){\n        var pos = new Array(), col = new Array(), idx = new Array();\n        for(var i = 0; i <= row; i++){\n            var r = Math.PI * 2 / row * i;\n            var rr = Math.cos(r);\n            var ry = Math.sin(r);\n            for(var ii = 0; ii <= column; ii++){\n                var tr = Math.PI * 2 / column * ii;\n                var tx = (rr * irad + orad) * Math.cos(tr);\n                var ty = ry * irad;\n                var tz = (rr * irad + orad) * Math.sin(tr);\n                pos.push(tx, ty, tz);\n                var tc = hsva(360 / column * ii, 1, 1, 1);\n                col.push(tc[0], tc[1], tc[2], tc[3]);\n            }\n        }\n        for(i = 0; i < row; i++){\n            for(ii = 0; ii < column; ii++){\n                r = (column + 1) * i + ii;\n                idx.push(r, r + column + 1, r + 1);\n                idx.push(r + column + 1, r + column + 2, r + 1);\n            }\n        }\n        return [pos, col, idx];\n    }\n    \n    // HSV\u30ab\u30e9\u30fc\u53d6\u5f97\u7528\u95a2\u6570\n    function hsva(h, s, v, a){\n        if(s > 1 || v > 1 || a > 1){return;}\n        var th = h % 360;\n        var i = Math.floor(th / 60);\n        var f = th / 60 - i;\n        var m = v * (1 - s);\n        var n = v * (1 - s * f);\n        var k = v * (1 - s * (1 - f));\n        var color = new Array();\n        if(!s > 0 && !s < 0){\n            color.push(v, v, v, a); \n        } else {\n            var r = new Array(v, n, m, m, k, v);\n            var g = new Array(k, v, v, n, m, m);\n            var b = new Array(m, m, k, v, v, n);\n            color.push(r[i], g[i], b[i], a);\n        }\n        return color;\n    }\n};\n```\n\n\n", "tags": ["WebGL", "GLSL"]}