{"context": " More than 1 year has passed since last update.tag\u4f7f\u3063\u305f\u307b\u3046\u304c\uff11\uff10\uff10\u500d\u7c21\u5358\u3060\u3063\u305f\u3053\u3068\u306b\u66f8\u304d\u7d42\u308f\u3063\u3066\u304b\u3089\u6c17\u3065\u3044\u305f\u306e\u3067\u3059\u304c\u4f9b\u990a\u306e\u305f\u3081\n---\n- name: hogehoge\n  hosts: 127.0.0.1\n  connection: local\n  sudo: false\n\n  tasks:\n    - name: get autoscaling group name\n      shell: aws elasticbeanstalk describe-environment-resources --environment-name environmentname \\\n        | python -c \"exec(\\\"import json,sys\\\\nobj=json.load(sys.stdin)\\\\nfor group in obj['EnvironmentResources']['AutoScalingGroups']:\\\\n print group['Name']\\\")\"\n      register: asg\n    - name: debug asg\n      debug: var=asg\n    - name: get instance ids\n      shell: aws autoscaling describe-auto-scaling-groups --auto-scaling-group-names {{ asg.stdout }} \\\n        | python -c \"exec(\\\"import json,sys\\\\nobj=json.load(sys.stdin)\\\\ndef instanceId(i):\\\\n  return i['InstanceId']\\\\nprint ' '.join(map(instanceId, obj['AutoScalingGroups'][0]['Instances']))\\\")\"\n      register: group\n    - name: debug group\n      debug: var=group.stdout\n    - name: get instances\n      shell: aws ec2 describe-instances --instance-ids {{ group.stdout }} \\\n        | python -c \"exec(\\\"import json,sys\\\\nobj=json.load(sys.stdin)\\\\ndef extractInstances(i):\\\\n  return i['Instances']\\\\ndef publicDnsName(i):\\\\n  print i['PublicDnsName']\\\\nmap(publicDnsName, sum(map(extractInstances, obj['Reservations']), []))\\\")\"\n      register: instances\n    - name: debug instances\n      debug: var=item\n      with_items:\n        - \"{{ instances.stdout_lines }}\"\n\ntag\u4f7f\u3063\u305f\u307b\u3046\u304c\uff11\uff10\uff10\u500d\u7c21\u5358\u3060\u3063\u305f\u3053\u3068\u306b\u66f8\u304d\u7d42\u308f\u3063\u3066\u304b\u3089\u6c17\u3065\u3044\u305f\u306e\u3067\u3059\u304c\u4f9b\u990a\u306e\u305f\u3081\n\n```\n---\n- name: hogehoge\n  hosts: 127.0.0.1\n  connection: local\n  sudo: false\n\n  tasks:\n    - name: get autoscaling group name\n      shell: aws elasticbeanstalk describe-environment-resources --environment-name environmentname \\\n        | python -c \"exec(\\\"import json,sys\\\\nobj=json.load(sys.stdin)\\\\nfor group in obj['EnvironmentResources']['AutoScalingGroups']:\\\\n print group['Name']\\\")\"\n      register: asg\n    - name: debug asg\n      debug: var=asg\n    - name: get instance ids\n      shell: aws autoscaling describe-auto-scaling-groups --auto-scaling-group-names {{ asg.stdout }} \\\n        | python -c \"exec(\\\"import json,sys\\\\nobj=json.load(sys.stdin)\\\\ndef instanceId(i):\\\\n  return i['InstanceId']\\\\nprint ' '.join(map(instanceId, obj['AutoScalingGroups'][0]['Instances']))\\\")\"\n      register: group\n    - name: debug group\n      debug: var=group.stdout\n    - name: get instances\n      shell: aws ec2 describe-instances --instance-ids {{ group.stdout }} \\\n        | python -c \"exec(\\\"import json,sys\\\\nobj=json.load(sys.stdin)\\\\ndef extractInstances(i):\\\\n  return i['Instances']\\\\ndef publicDnsName(i):\\\\n  print i['PublicDnsName']\\\\nmap(publicDnsName, sum(map(extractInstances, obj['Reservations']), []))\\\")\"\n      register: instances\n    - name: debug instances\n      debug: var=item\n      with_items:\n        - \"{{ instances.stdout_lines }}\"\n```\n", "tags": ["AWS", "ElasticBeanstalk"]}