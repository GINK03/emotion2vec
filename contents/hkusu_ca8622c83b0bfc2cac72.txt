{"context": " More than 1 year has passed since last update.\u3053\u3093\u306b\u3061\u308f\u3002\u3053\u308c\u306f mod_mruby ngx_mruby Advent Calendar 2014 \u306e\uff13\u65e5\u76ee(12/3)\u306e\u6295\u7a3f\u3067\u3059\u3002\u30a2\u30c9\u30d9\u30f3\u30c8\u30ab\u30ec\u30f3\u30c0\u30fc\u306a\u306e\u3067 mod_murby \u306b\u95a2\u3059\u308b\u8aac\u660e\u306f\u7701\u304d\u307e\u3059\u3002\n\u4eca\u56de\u306f Aazon EC2 (OS: Amazon Linux) \u4e0a\u306e Apache2.4 \u306b mod_mruby \u3092\u5c0e\u5165\u3059\u308b\u624b\u9806\u306b\u3064\u3044\u3066\u66f8\u304d\u305f\u3044\u3068\u601d\u3044\u307e\u3059\u3002\n\n\u3061\u306a\u307f\u306b\u79c1\u306f\u30a4\u30f3\u30d5\u30e9\u5c02\u696d\u3067\u306f\u306a\u3044\u306e\u3067\u3001\u304a\u304b\u3057\u306a\u3068\u3053\u308d\u304c\u3042\u3063\u305f\u3089\u9069\u5f53\u306b\u8aad\u307f\u66ff\u3048\u3066\u304f\u3060\u3055\u3044^^; \u307e\u305f Apache2.2 \u306b\u5c0e\u5165\u3059\u308b\u624b\u9806\u306b\u3064\u3044\u3066\u306f\u4ee5\u524d\u306b\u66f8\u304d\u307e\u3057\u305f\u3002\n\u21d2 mod_mruby \u3092 Amazon EC2\u3001Apache2.2 \u3078\u5c0e\u5165\u3059\u308b\n\n\u8a73\u7d30\u306a\u30d0\u30fc\u30b8\u30e7\u30f3\u306f\u6b21\u306e\u3068\u304a\u308a\u3067\u3059\u3002\n\nApache \u30d0\u30fc\u30b8\u30e7\u30f3\uff1a2.4.10\nmod_mruby \u30d0\u30fc\u30b8\u30e7\u30f3\uff1a1.9.7\nAmazon Linux\uff1a\n\n\nApache \u306e\u5c0e\u5165\u624b\u9806\u306f\u4e0b\u8a18\u306e\u901a\u308a\u306a\u306e\u3067\u3059\u304c\u3001\u6050\u3089\u304f\u30c7\u30d5\u30a9\u30eb\u30c8\u306e event mpm \u30e2\u30fc\u30c9\u3067\u52d5\u3044\u3066\u3044\u308b\u3068\u601d\u3044\u307e\u3059\u3002\uff08\u5f8c\u304b\u3089\u601d\u3046\u3068\u7121\u96e3\u306b prefork \u306b\u3057\u3066\u304a\u3051\u3070\u826f\u304b\u3063\u305f\u3068\u601d\u308f\u306a\u304f\u3082\u306a\u3044\u3002\uff09\n\nEC2 \u3078 Apache2.4 \u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\nApache 2.4 \u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u624b\u9806\u306b\u3064\u3044\u3066\u306f\u4ee5\u524d\u306b\u66f8\u3044\u305f\u306e\u3067\u3001\u3053\u3061\u3089\u3092\u53c2\u8003\u306b\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\u21d2 Apache2.4 \uff06 Amazon EC2 \u3067 Apache\u30e2\u30b8\u30e5\u30fc\u30eb\u958b\u767a\n\u7d50\u679c\u7684\u306b\u3001\u5404\u30d1\u30b9\u306f\u6b21\u306e\u3088\u3046\u306b\u306a\u3063\u3066\u3044\u307e\u3059\u3002\n\n\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u306e\u5834\u6240\uff1a/usr/local/apache2/conf/\n\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u30eb\u30fc\u30c8\uff1a/usr/local/apache2/htdocs/\n\u5404\u30b3\u30de\u30f3\u30c9\u306e\u30d1\u30b9\uff1a/usr/local/apache2/bin/\n\n\nmod_mruby \u306e\u5c0e\u5165\n\u307e\u305a\u3001Git \u304c\u5fc5\u8981\u306a\u306e\u3067\u3001Git \u3092 yum \u3067\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\n$ sudo yum -y install git\n\nGitHub \u304b\u3089 mod_mruby \u3092 clone \u3057\u3001\n$ git clone git://github.com/matsumoto-r/mod_mruby.git\n\n\u30b3\u30f3\u30d1\u30a4\u30eb\u7528\u306e\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u5b9f\u884c\u3057\u307e\u3059\u3002\n$ cd mod_mruby\n$ APXS_PATH_ENV='--with-apxs=/usr/local/apache2/bin/apxs' APACHECTL_PATH_ENV='--with-apachectl=/usr/local/apache2/bin/apachectl' sh build.sh\n\n\napxs \u3068 apachectl \u306e\u30d1\u30b9\u306f\u305d\u306e\u74b0\u5883\u3078\u5408\u308f\u305b\u3066\u304f\u3060\u3055\u3044\u3002\n\n\u79c1\u306e\u5834\u5408\u3001\u30b3\u30f3\u30d1\u30a4\u30eb\u30a8\u30e9\u30fc\u304c\u51fa\u307e\u3057\u305f\u3002\u30a8\u30e9\u30fc\u306e\u5ea6\u306b\u5fc5\u8981\u306a\u3082\u306e\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u3066\u518d\u5b9f\u884c\u3059\u308c\u3070\u3044\u3044\u306e\u3067\u3059\u304c\u3001\u7d50\u679c\u7684\u306b\u4e0b\u8a18\u306e\uff12\u3064\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308c\u3070OK\u3067\u3057\u305f\u3002\n$ sudo yum -y install bison openssl-devel\n\n\ngcc \u306f Apache \u306e\u30b3\u30f3\u30d1\u30a4\u30eb\u306e\u969b\u306b\u5c0e\u5165\u6e08\u307f\u3060\u3063\u305f\u3002\n\n\u307e\u305f\u3001mod_mruby \u3067\u306f mruby\u7528\u306egem \u3092\u7d44\u307f\u8fbc\u3081\u308b\u306e\u3067\u3059\u304c\u3001\u3069\u308c\u3092\u7d44\u307f\u8fbc\u3080\u304b\u306f build_config.rb \u3067\u8a2d\u5b9a\u3059\u308b\u3088\u3046\u3067\u3059\uff08\u308f\u305f\u3057\u8abf\u3079\uff09\u3002\n\u3053\u306e\u4e2d\u3067\u3001mruby-redis \u306f hiredis(KVS \u306e Redis \u306e\u3053\u3068\uff1f)\u304c\u5fc5\u8981\u305d\u3046\u306a\u306e\u3067\u5916\u3057\u3066\u3044\u307e\u3059\u3002\n\nbuild_config.rb\n\u301c\nconf.gem :github => 'mattn/mruby-json'\n+#conf.gem :github => 'matsumoto-r/mruby-redis'\nconf.gem :github => 'matsumoto-r/mruby-vedis'\n\u301c\n\n\n\u30b3\u30f3\u30d1\u30a4\u30eb\u304c\u6210\u529f\u3057\u305f\u3089\u3001\u6b21\u306e\u3088\u3046\u306b Apache \u3078\u7d44\u307f\u8fbc\u307f\u307e\u3059\u3002\n$ cd mod_mruby\n$ sudo make install\n\n\u3059\u308b\u3068\u3001/usr/local/apache2/modules/ \u914d\u4e0b\u306b mod_mruby.so \u304c\u914d\u7f6e\u3055\u308c\u3001Apache \u306e\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\uff08/usr/local/apache2/conf/httpd.conf\uff09\u3092\u898b\u3066\u307f\u308b\u3068\u3001mod_mruby \u3092\u30ed\u30fc\u30c9\u3059\u308b\u8a18\u8ff0\u304c\u81ea\u52d5\u3067\u8ffd\u8a18\u3055\u308c\u3066\u3044\u307e\u3059\u3002\n\n/usr/local/apache2/conf/httpd.conf\n\u301c\nLoadModule mruby_module       modules/mod_mruby.so\n\u301c\n\n\nApache \u3092\u518d\u8d77\u52d5\u3057\u3066\u3001\u6709\u52b9\u306b\u3057\u307e\u3059\u3002\n$ sudo /usr/local/apache2/bin/httpd -k restart\n\n\u4ee5\u4e0a\u3067\u5c0e\u5165\u306f\u5b8c\u4e86\u3067\u3059\uff01\n\nmod_mruby \u306e\u52d5\u4f5c\u78ba\u8a8d\n/usr/local/apache2 \u3042\u305f\u308a\u306b mruby \u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092\u4f5c\u6210\u3057\u3001\u305d\u306e\u914d\u4e0b\u306b mod_mruby \u7528\u306e\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u7f6e\u304f\u3053\u3068\u306b\u3057\u307e\u3059\u3002\uff08\u3053\u306e\u3042\u305f\u308a\u306f\u4efb\u610f\uff09\n\u6b21\u306e\u3088\u3046\u306b\u66f8\u304d\u307e\u3059\u3002\n\n/usr/local/apache2/mruby/test.rb\nApache.echo \"Hello World\"\n\n\nApache\u5074\u3067\u3001mod_mruby \u306e\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3092\u65b0\u898f\u306b\u4f5c\u308a\u307e\u3059\u3002\n$ sudo touch /usr/local/apache2/conf/extra/mruby.conf\n\n\u6b21\u306e\u3088\u3046\u306b\u8a18\u8f09\u3057\u307e\u3059\u3002\n\n/usr/local/apache2/conf/extra/mruby.conf\n<Location /test>\n    mrubyHandlerMiddle /usr/local/apache2/mruby/test.rb\n</Location>\n\n\nApache \u672c\u4f53\u306e\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u304b\u3089\u3001\u4e0a\u8a18\u306e mod_mruby \u7528\u306e\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3092\u8aad\u3080\u3053\u3080\u3088\u3046\u306b\u3057\u307e\u3059\u3002\n\n/usr/local/apache2/conf/httpd.conf\n\u301c\nInclude conf/extra/mruby.conf\n\u301c\n\n\n\u4fdd\u5b58\u3057\u305f\u3089 Apache \u3092\u518d\u8d77\u52d5\u3057\u3001\n$ sudo /usr/local/apache2/bin/httpd -k restart\n\n\u30d6\u30e9\u30a6\u30b6\u3067 /test \u3078\u30a2\u30af\u30bb\u30b9\u3057\u3066\u307f\u307e\u3059\u3002\n\n\u4e0a\u8a18\u306e test.rb \u306f\u3001\u4fee\u6b63\u3057\u305f\u5834\u5408\u3067\u3082 Apache \u306e\u518d\u8d77\u52d5\u306a\u3057\u3067\u9069\u7528\u3055\u308c\u307e\u3059\u3057\u3001\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u304b\u3089\u8aad\u307f\u8fbc\u3080\u969b\u306b .. /usr/local/apache2/mruby/test.rb cache \u3068\u3044\u3046\u98a8\u306b cache \u30aa\u30d7\u30b7\u30e7\u30f3\u3092\u3064\u3051\u3066\u304a\u3051\u3070\u3001\u30b9\u30af\u30ea\u30d7\u30c8\u306f Apache(mod_mruby) \u306b\u30ad\u30e3\u30c3\u30b7\u30e5\u3055\u308c\u308b\u3088\u3046\u3067\u3059\u3002\n\uff08\u30ad\u30e3\u30b7\u30e5\u3057\u305f\u5834\u5408\u306f\u3001\u30b9\u30af\u30ea\u30d7\u30c8\u4fee\u6b63\u306e\u5ea6\u306b Apache \u306e\u518d\u8d77\u52d5\u306f\u5fc5\u8981\uff1f\uff09\n\n\u304a\u308f\u308a\u306b\n\u3042\u3068\u306f /usr/local/apache2/mruby/ \u914d\u4e0b\u306b\u4efb\u610f\u306e\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u7f6e\u304d\u3001mod_mruby \u306b\u95a2\u3059\u308b Apache \u306e\u8a2d\u5b9a\u306f /usr/local/apache2/conf/extra/mruby.conf \u306b\u66f8\u3044\u3066\u3044\u3051\u3070\u3088\u3044\u304b\u3068\u3002\n\n\u958b\u767a\u306e\u53c2\u8003\u306b\u306a\u308a\u305d\u3046\u306a\u3082\u306e\uff1a\n\nmod_mruby \u306e Wiki\uff08GitHub\uff09\n\n\nhttps://github.com/matsumoto-r/mod_mruby/wiki\n\u30b9\u30af\u30ea\u30d7\u30c8\u306e\u30b5\u30f3\u30d7\u30eb\n\n\nhttps://github.com/matsumoto-r/mod_mruby/tree/master/example\n\n\n\n\nmruby\u7528\u306e gem\n\n\nhttps://github.com/mruby/mgem-list\n\u3044\u308d\u3044\u308d\u3042\u308b\u306e\u3067\u3001\u4fbf\u5229\u305d\u3046\u306a\u3082\u306e\u3092\u7d44\u307f\u8fbc\u3093\u3067\u307f\u305f\u308a\u3001\u8db3\u308a\u306a\u3044\u3082\u306e\u306f\u81ea\u5206\u3067\u4f5c\u3063\u3066\u307f\u3066\u3082\u3044\u3044\u304b\u3082\u3067\u3059\u306d\u3002\n\n\n\n\uff14\u65e5\u76ee\u306f hfm \u3055\u3093\u306b\u3088\u308b ngx_mruby \u306e\u8a18\u4e8b\u306b\u306a\u308a\u307e\u3059\uff01\n\n\u3053\u3093\u306b\u3061\u308f\u3002\u3053\u308c\u306f [mod_mruby ngx_mruby Advent Calendar 2014](http://qiita.com/advent-calendar/2014/mod-ngx-mruby) \u306e\uff13\u65e5\u76ee(12/3)\u306e\u6295\u7a3f\u3067\u3059\u3002\u30a2\u30c9\u30d9\u30f3\u30c8\u30ab\u30ec\u30f3\u30c0\u30fc\u306a\u306e\u3067 [mod_murby](https://github.com/matsumoto-r/mod_mruby) \u306b\u95a2\u3059\u308b\u8aac\u660e\u306f\u7701\u304d\u307e\u3059\u3002\n\n\u4eca\u56de\u306f Aazon EC2 (OS: Amazon Linux) \u4e0a\u306e Apache2.4 \u306b mod_mruby \u3092\u5c0e\u5165\u3059\u308b\u624b\u9806\u306b\u3064\u3044\u3066\u66f8\u304d\u305f\u3044\u3068\u601d\u3044\u307e\u3059\u3002\n\n> \u3061\u306a\u307f\u306b\u79c1\u306f\u30a4\u30f3\u30d5\u30e9\u5c02\u696d\u3067\u306f\u306a\u3044\u306e\u3067\u3001\u304a\u304b\u3057\u306a\u3068\u3053\u308d\u304c\u3042\u3063\u305f\u3089\u9069\u5f53\u306b\u8aad\u307f\u66ff\u3048\u3066\u304f\u3060\u3055\u3044^^; \u307e\u305f Apache2.2 \u306b\u5c0e\u5165\u3059\u308b\u624b\u9806\u306b\u3064\u3044\u3066\u306f\u4ee5\u524d\u306b\u66f8\u304d\u307e\u3057\u305f\u3002\n> \u21d2 [mod_mruby \u3092 Amazon EC2\u3001Apache2.2 \u3078\u5c0e\u5165\u3059\u308b](http://qiita.com/hkusu/items/09d0515c80206d264bee)\n\n\u8a73\u7d30\u306a\u30d0\u30fc\u30b8\u30e7\u30f3\u306f\u6b21\u306e\u3068\u304a\u308a\u3067\u3059\u3002\n\n> Apache \u30d0\u30fc\u30b8\u30e7\u30f3\uff1a`2.4.10`\n> mod_mruby \u30d0\u30fc\u30b8\u30e7\u30f3\uff1a`1.9.7`\n> Amazon Linux\uff1a\n> ![\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2014-11-27 19.28.17.png](https://qiita-image-store.s3.amazonaws.com/0/35733/bf40eeb3-588e-11d1-342e-f9bd16f1924d.png \"\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2014-11-27 19.28.17.png\")\n\nApache \u306e\u5c0e\u5165\u624b\u9806\u306f\u4e0b\u8a18\u306e\u901a\u308a\u306a\u306e\u3067\u3059\u304c\u3001\u6050\u3089\u304f\u30c7\u30d5\u30a9\u30eb\u30c8\u306e `event mpm` \u30e2\u30fc\u30c9\u3067\u52d5\u3044\u3066\u3044\u308b\u3068\u601d\u3044\u307e\u3059\u3002\uff08\u5f8c\u304b\u3089\u601d\u3046\u3068\u7121\u96e3\u306b `prefork` \u306b\u3057\u3066\u304a\u3051\u3070\u826f\u304b\u3063\u305f\u3068\u601d\u308f\u306a\u304f\u3082\u306a\u3044\u3002\uff09\n\n## EC2 \u3078 Apache2.4 \u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\nApache 2.4 \u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u624b\u9806\u306b\u3064\u3044\u3066\u306f\u4ee5\u524d\u306b\u66f8\u3044\u305f\u306e\u3067\u3001\u3053\u3061\u3089\u3092\u53c2\u8003\u306b\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\u21d2 [Apache2.4 \uff06 Amazon EC2 \u3067 Apache\u30e2\u30b8\u30e5\u30fc\u30eb\u958b\u767a](http://qiita.com/hkusu/items/29014c70119223e6b555)\n\n\u7d50\u679c\u7684\u306b\u3001\u5404\u30d1\u30b9\u306f\u6b21\u306e\u3088\u3046\u306b\u306a\u3063\u3066\u3044\u307e\u3059\u3002\n\n> \u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u306e\u5834\u6240\uff1a/usr/local/apache2/conf/\n> \u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u30eb\u30fc\u30c8\uff1a/usr/local/apache2/htdocs/\n> \u5404\u30b3\u30de\u30f3\u30c9\u306e\u30d1\u30b9\uff1a/usr/local/apache2/bin/\n\n## mod_mruby \u306e\u5c0e\u5165\n\n\u307e\u305a\u3001Git \u304c\u5fc5\u8981\u306a\u306e\u3067\u3001Git \u3092 yum \u3067\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\n\n```shell\n$ sudo yum -y install git\n```\n\nGitHub \u304b\u3089 mod_mruby \u3092 clone \u3057\u3001\n\n```shell\n$ git clone git://github.com/matsumoto-r/mod_mruby.git\n```\n\n\u30b3\u30f3\u30d1\u30a4\u30eb\u7528\u306e\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u5b9f\u884c\u3057\u307e\u3059\u3002\n\n```shell\n$ cd mod_mruby\n$ APXS_PATH_ENV='--with-apxs=/usr/local/apache2/bin/apxs' APACHECTL_PATH_ENV='--with-apachectl=/usr/local/apache2/bin/apachectl' sh build.sh\n```\n\n> `apxs` \u3068 `apachectl` \u306e\u30d1\u30b9\u306f\u305d\u306e\u74b0\u5883\u3078\u5408\u308f\u305b\u3066\u304f\u3060\u3055\u3044\u3002\n\n\u79c1\u306e\u5834\u5408\u3001\u30b3\u30f3\u30d1\u30a4\u30eb\u30a8\u30e9\u30fc\u304c\u51fa\u307e\u3057\u305f\u3002\u30a8\u30e9\u30fc\u306e\u5ea6\u306b\u5fc5\u8981\u306a\u3082\u306e\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u3066\u518d\u5b9f\u884c\u3059\u308c\u3070\u3044\u3044\u306e\u3067\u3059\u304c\u3001\u7d50\u679c\u7684\u306b\u4e0b\u8a18\u306e\uff12\u3064\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308c\u3070OK\u3067\u3057\u305f\u3002\n\n```\n$ sudo yum -y install bison openssl-devel\n```\n\n> gcc \u306f Apache \u306e\u30b3\u30f3\u30d1\u30a4\u30eb\u306e\u969b\u306b\u5c0e\u5165\u6e08\u307f\u3060\u3063\u305f\u3002\n\n\u307e\u305f\u3001mod_mruby \u3067\u306f [mruby\u7528\u306egem](https://github.com/mruby/mgem-list) \u3092\u7d44\u307f\u8fbc\u3081\u308b\u306e\u3067\u3059\u304c\u3001\u3069\u308c\u3092\u7d44\u307f\u8fbc\u3080\u304b\u306f `build_config.rb` \u3067\u8a2d\u5b9a\u3059\u308b\u3088\u3046\u3067\u3059\uff08\u308f\u305f\u3057\u8abf\u3079\uff09\u3002\n\u3053\u306e\u4e2d\u3067\u3001`mruby-redis` \u306f `hiredis`(KVS \u306e Redis \u306e\u3053\u3068\uff1f)\u304c\u5fc5\u8981\u305d\u3046\u306a\u306e\u3067\u5916\u3057\u3066\u3044\u307e\u3059\u3002\n\n```diff:build_config.rb\n\u301c\nconf.gem :github => 'mattn/mruby-json'\n+#conf.gem :github => 'matsumoto-r/mruby-redis'\nconf.gem :github => 'matsumoto-r/mruby-vedis'\n\u301c\n```\n\n\u30b3\u30f3\u30d1\u30a4\u30eb\u304c\u6210\u529f\u3057\u305f\u3089\u3001\u6b21\u306e\u3088\u3046\u306b Apache \u3078\u7d44\u307f\u8fbc\u307f\u307e\u3059\u3002\n\n```shell\n$ cd mod_mruby\n$ sudo make install\n```\n\n\u3059\u308b\u3068\u3001`/usr/local/apache2/modules/` \u914d\u4e0b\u306b `mod_mruby.so` \u304c\u914d\u7f6e\u3055\u308c\u3001Apache \u306e\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\uff08`/usr/local/apache2/conf/httpd.conf`\uff09\u3092\u898b\u3066\u307f\u308b\u3068\u3001mod_mruby \u3092\u30ed\u30fc\u30c9\u3059\u308b\u8a18\u8ff0\u304c\u81ea\u52d5\u3067\u8ffd\u8a18\u3055\u308c\u3066\u3044\u307e\u3059\u3002\n\n```apacheconf:/usr/local/apache2/conf/httpd.conf\n\u301c\nLoadModule mruby_module       modules/mod_mruby.so\n\u301c\n```\n\nApache \u3092\u518d\u8d77\u52d5\u3057\u3066\u3001\u6709\u52b9\u306b\u3057\u307e\u3059\u3002\n\n```shell\n$ sudo /usr/local/apache2/bin/httpd -k restart\n```\n\n\u4ee5\u4e0a\u3067\u5c0e\u5165\u306f\u5b8c\u4e86\u3067\u3059\uff01\n\n# mod_mruby \u306e\u52d5\u4f5c\u78ba\u8a8d\n\n`/usr/local/apache2` \u3042\u305f\u308a\u306b `mruby` \u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092\u4f5c\u6210\u3057\u3001\u305d\u306e\u914d\u4e0b\u306b mod_mruby \u7528\u306e\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u7f6e\u304f\u3053\u3068\u306b\u3057\u307e\u3059\u3002\uff08\u3053\u306e\u3042\u305f\u308a\u306f\u4efb\u610f\uff09\n\n\u6b21\u306e\u3088\u3046\u306b\u66f8\u304d\u307e\u3059\u3002\n\n```ruby:/usr/local/apache2/mruby/test.rb\nApache.echo \"Hello World\"\n```\n\nApache\u5074\u3067\u3001mod_mruby \u306e\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3092\u65b0\u898f\u306b\u4f5c\u308a\u307e\u3059\u3002\n\n```shell\n$ sudo touch /usr/local/apache2/conf/extra/mruby.conf\n```\n\n\u6b21\u306e\u3088\u3046\u306b\u8a18\u8f09\u3057\u307e\u3059\u3002\n\n```apache:/usr/local/apache2/conf/extra/mruby.conf\n<Location /test>\n    mrubyHandlerMiddle /usr/local/apache2/mruby/test.rb\n</Location>\n```\n\nApache \u672c\u4f53\u306e\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u304b\u3089\u3001\u4e0a\u8a18\u306e mod_mruby \u7528\u306e\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3092\u8aad\u3080\u3053\u3080\u3088\u3046\u306b\u3057\u307e\u3059\u3002\n\n```apache:/usr/local/apache2/conf/httpd.conf\n\u301c\nInclude conf/extra/mruby.conf\n\u301c\n```\n\n\u4fdd\u5b58\u3057\u305f\u3089 Apache \u3092\u518d\u8d77\u52d5\u3057\u3001\n\n```shell\n$ sudo /usr/local/apache2/bin/httpd -k restart\n```\n\n\u30d6\u30e9\u30a6\u30b6\u3067 `/test` \u3078\u30a2\u30af\u30bb\u30b9\u3057\u3066\u307f\u307e\u3059\u3002\n\n![\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8_2014-11-27_19_00_12.png](https://qiita-image-store.s3.amazonaws.com/0/35733/112d21da-74dc-c4db-d5c5-f42fe2cddeb1.png \"\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8_2014-11-27_19_00_12.png\")\n\n\u4e0a\u8a18\u306e `test.rb` \u306f\u3001\u4fee\u6b63\u3057\u305f\u5834\u5408\u3067\u3082 Apache \u306e\u518d\u8d77\u52d5\u306a\u3057\u3067\u9069\u7528\u3055\u308c\u307e\u3059\u3057\u3001\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u304b\u3089\u8aad\u307f\u8fbc\u3080\u969b\u306b `.. /usr/local/apache2/mruby/test.rb cache` \u3068\u3044\u3046\u98a8\u306b `cache` \u30aa\u30d7\u30b7\u30e7\u30f3\u3092\u3064\u3051\u3066\u304a\u3051\u3070\u3001\u30b9\u30af\u30ea\u30d7\u30c8\u306f Apache(mod_mruby) \u306b\u30ad\u30e3\u30c3\u30b7\u30e5\u3055\u308c\u308b\u3088\u3046\u3067\u3059\u3002\n\uff08\u30ad\u30e3\u30b7\u30e5\u3057\u305f\u5834\u5408\u306f\u3001\u30b9\u30af\u30ea\u30d7\u30c8\u4fee\u6b63\u306e\u5ea6\u306b Apache \u306e\u518d\u8d77\u52d5\u306f\u5fc5\u8981\uff1f\uff09\n\n## \u304a\u308f\u308a\u306b\n\n\u3042\u3068\u306f `/usr/local/apache2/mruby/` \u914d\u4e0b\u306b\u4efb\u610f\u306e\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u7f6e\u304d\u3001mod_mruby \u306b\u95a2\u3059\u308b Apache \u306e\u8a2d\u5b9a\u306f `/usr/local/apache2/conf/extra/mruby.conf` \u306b\u66f8\u3044\u3066\u3044\u3051\u3070\u3088\u3044\u304b\u3068\u3002\n\n### \u958b\u767a\u306e\u53c2\u8003\u306b\u306a\u308a\u305d\u3046\u306a\u3082\u306e\uff1a\n\n- mod_mruby \u306e Wiki\uff08GitHub\uff09\n\t- https://github.com/matsumoto-r/mod_mruby/wiki\n\t- \u30b9\u30af\u30ea\u30d7\u30c8\u306e\u30b5\u30f3\u30d7\u30eb\n\t\t- https://github.com/matsumoto-r/mod_mruby/tree/master/example\n- mruby\u7528\u306e gem\n\t- https://github.com/mruby/mgem-list\n\t- \u3044\u308d\u3044\u308d\u3042\u308b\u306e\u3067\u3001\u4fbf\u5229\u305d\u3046\u306a\u3082\u306e\u3092\u7d44\u307f\u8fbc\u3093\u3067\u307f\u305f\u308a\u3001\u8db3\u308a\u306a\u3044\u3082\u306e\u306f\u81ea\u5206\u3067\u4f5c\u3063\u3066\u307f\u3066\u3082\u3044\u3044\u304b\u3082\u3067\u3059\u306d\u3002\n\n\uff14\u65e5\u76ee\u306f [hfm](http://qiita.com/hfm) \u3055\u3093\u306b\u3088\u308b ngx_mruby \u306e\u8a18\u4e8b\u306b\u306a\u308a\u307e\u3059\uff01\n", "tags": ["AWS", "mruby", "AdventCalendar", "Apache", "mod_mruby"]}