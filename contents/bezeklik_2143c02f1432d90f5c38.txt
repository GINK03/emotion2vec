{"context": "\n\nOSSEC\nOSSEC \u306f inotify \u3092\u5229\u7528\u3057\u305f\u30ea\u30a2\u30eb\u30bf\u30a4\u30e0\u306e\u30d5\u30a1\u30a4\u30eb\u6539\u3056\u3093\u691c\u77e5\u304c\u3067\u304d\u308b HIDS \u3067\u3042\u308b\u3002\nOSSEC \u306f Daniel B. Cid \u306b\u3088\u3063\u3066\u66f8\u304b\u308c2004\u5e74\u306b\u516c\u958b\u3055\u308c\u305f\u3002\u305d\u306e\u5f8c2008\u5e74\u306b Third Brigade \u793e\u304c\u53d6\u5f97\u3057\u30012009\u5e74\u306b\u3055\u3089\u306b\u305d\u308c\u3092 Trend Micro \u793e\u304c\u8cb7\u53ce\u3057\u305f\u3002\n\nHIDS\nOSSEC \u4ee5\u5916\u306e\u4e3b\u306a HIDS \u306f\u4ee5\u4e0b\u306e\u901a\u308a\u3002\n\n\nAFICK 3.5.2 (2016/08/05) - SourceForge \u306b rpm \u30d1\u30c3\u30b1\u30fc\u30b8\u304c\u3042\u308b\u3002\n\nAIDE 0.16 (2016/07/25) - CentOS \u306e Base \u30ea\u30dd\u30b8\u30c8\u30ea\u30fc\u306b\u3042\u308b\u3002\n\nOSSEC 2.9_beta5 (2016/04/26) - inotify \u5bfe\u5fdc\u3002Atomic \u30ea\u30dd\u30b8\u30c8\u30ea\u30fc\u306b\u3042\u308b\u3002\n\nSamhain 4.2.0 (2016/10/13) - inotify \u5bfe\u5fdc\u3002\n\nTripwire 2.4.3.1 (2016/04/24)- EPEL \u30ea\u30dd\u30b8\u30c8\u30ea\u30fc\u306b\u3042\u308b\u3002\n\n\n\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\u30b7\u30a7\u30eb\u30b9\u30af\u30ea\u30d7\u30c8\u3067\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\u65b9\u6cd5\u3082\u3042\u308b\u304c\u3001Atomic \u30ea\u30dd\u30b8\u30c8\u30ea\u3092\u5229\u7528\u3057\u305f\u30d1\u30c3\u30b1\u30fc\u30b8\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u306b\u3053\u3060\u308f\u308b\u3002\n\nEPEL \u30ea\u30dd\u30b8\u30c8\u30ea\u30fc\u306e\u8ffd\u52a0\nyum install epel-release\nyum update epel-release\n\ninotify-tools \u306f EPEL \u30ea\u30dd\u30b8\u30c8\u30ea\u30fc\u306e\u65b9\u304c\u65b0\u3057\u3044\u3002\nepel-release \u306f CentOS Extras \u30ea\u30dd\u30b8\u30c8\u30ea\u30fc\u3067\u306f 7-6 \u3068\u53e4\u3044\u306e\u3067\u3001\u30a2\u30c3\u30d7\u30c7\u30fc\u30c8\u3057\u3066 7-8 \u306b\u3059\u308b\u3002\n\nAtomic \u30ea\u30dd\u30b8\u30c8\u30ea\u30fc\u306e\u8ffd\u52a0\nyum install wget\ncurl -s http://www.atomicorp.com/installers/atomic | sh\n\n\u30b9\u30af\u30ea\u30d7\u30c8\u5185\u3067 wget \u3092\u4f7f\u7528\u3057\u3066\u3044\u308b\u306e\u3067\u30b3\u30de\u30f3\u30c9\u304c\u306a\u3044\u3068\u30a8\u30e9\u30fc\u306a\u3057\u3067\u3053\u3051\u308b\u3002\n\nOSSEC HIDS Server \u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\nyum install ossec-hids-server\nsystemctl enable ossec-hids\n\n\nossec-configure\n/var/ossec/bin/ossec-configure\n\nOSSEC Configuration utility v0.1\n\n1- What kind of installation do you want? (server, agent, local) [Default: server]: local\n\n2- Setting up the configuration environment.\n\n3- Configuring the OSSEC HIDS.\n\n  3.1- Do you want e-mail notification? (y/n) [Default: y]:\n   - What's your e-mail address? root@localhost\n   - What's your SMTP server ip/host? localhost\n\n  3.2- Do you want to run the integrity check daemon? (y/n) [y]:\n\n  3.3- Do you want to run the rootkit detection engine? (y/n) [y]:\n\n  3.4- Active response allows you to execute a specific\n       command based on the events received. For example,\n       you can block an IP address or disable access for\n       a specific user.\n       More information at:\n       http://www.ossec.net/en/manual.html#active-response\n\n\n   - Do you want to enable active response? (y/n) [y]: n\n\n  3.5- Do you want to enable remote syslog (port 514 udp)? (y/n) [y]:\n\n    -- /var/log/messages (syslog)\n    -- /var/log/secure (syslog)\n    -- /var/log/maillog (syslog)\n    -- /var/log/httpd/error_log (apache log)\n    -- /var/log/httpd/access_log (apache log)\nConfiguration complete.\n\n/var/ossec/etc/ossec.conf \u304c\u66f4\u65b0\u3055\u308c\u3001\u65e7\u30d5\u30a1\u30a4\u30eb\u306f /var/ossec/etc/ossec.conf.bak \u3068\u3057\u3066\u4fdd\u5b58\u3055\u308c\u308b\u3002\n\n\u30ea\u30a2\u30eb\u30bf\u30a4\u30e0\u76e3\u8996\u306e\u6709\u52b9\u5316\nsed -i '/directories check_all/s/\"yes\"/\"yes\" realtime=\"yes\"/' /var/ossec/etc/ossec.conf\nsystemctl start ossec-hids\ntail -f /var/ossec/logs/ossec.log\n\n\u30ed\u30b0\u306b Real time file monitoring started. \u3068\u51fa\u529b\u3055\u308c\u308b\u307e\u3067\u30ea\u30a2\u30eb\u30bf\u30a4\u30e0\u76e3\u8996\u306f\u958b\u59cb\u3055\u308c\u306a\u3044\u3002\u691c\u8a3c\u74b0\u5883\u3067\u306f\u958b\u59cb\u307e\u306710\u5206\u7a0b\u5ea6\u304b\u304b\u3063\u305f\u3002\nhttp://ossec-docs.readthedocs.io/en/latest/manual/syscheck/#realtime-options\nhttp://ossec-docs.readthedocs.io/en/latest/manual/syscheck/#real-time-monitoring\n\nOSSEC Web UI\nREADME \u306b\u306f\u300cOSSEC Web UI \u306f\u73fe\u5728\u30e1\u30f3\u30c6\u30ca\u30f3\u30b9\u3055\u308c\u3066\u304a\u3089\u305a\u3001\u975e\u63a8\u5968\u3002\u30a2\u30e9\u30fc\u30c8\u76e3\u8996\u306b\u306f Kibana \u304b Splunk \u307e\u305f\u306f\u540c\u69d8\u306e\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092\u4f7f\u7528\u3059\u308b\u3053\u3068\u3092\u52e7\u3081\u308b\u300d\u3068\u306e\u8a18\u8f09\u3002\nAtomic \u30ea\u30dd\u30b8\u30c8\u30ea\u306b ossec-wui \u30d1\u30c3\u30b1\u30fc\u30b8\u304c\u4e00\u5fdc\u3042\u308b\u304c\u3001\u3042\u307e\u308a\u30d1\u30c3\u30b1\u30fc\u30b8\u306e\u30e1\u30ea\u30c3\u30c8\u304c\u306a\u3044\u306e\u3067 GitHub \u304b\u3089\u6700\u65b0\u3092\u53d6\u5f97\u3059\u308b\u3002\nyum install php php-gd\nsed -i 's/;date.timezone =/date.timezone = Asia\\/Tokyo/' /etc/php.ini\nsystemctl enable httpd\ncurl -L https://github.com/ossec/ossec-wui/archive/master.tar.gz -o ossec-wui.tar.gz\ntar vzxf ossec-wui.tar.gz --strip=1 -C /var/www/html\ncd /var/www/html\n./setup.sh\n\nSetting up ossec ui...\n\nUsername: <username>\nNew password: <password>\nRe-type new password: <password>\nAdding password for user ossec\nEnter your web server user name (e.g. apache, www, nobody, www-data, ...)\napache\nYou must restart your web server after this setup is done.\n\nSetup completed successfully.\n\nchown apache:apache -R /var/www/html\nchcon -t httpd_sys_content_t /var/ossec\nchcon -R -t httpd_sys_content_t /var/ossec/{logs,stats}/\nchcon -R -t httpd_sys_content_t /var/ossec/queue/{agent-info,syscheck}/\nsystemctl start httpd\n\n\n\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u95a2\u9023\u8a18\u4e8b\n\nPHP\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u5f37\u5316\u30e2\u30b8\u30e5\u30fc\u30eb Suhosin\nDoS\u653b\u6483/\u30d6\u30eb\u30fc\u30c8\u30d5\u30a9\u30fc\u30b9\u653b\u6483\u5bfe\u7b56\u30a2\u30d7\u30ea\u306e\u8fd1\u6cc1\nLinux\u30a2\u30f3\u30c1\u30a6\u30a4\u30eb\u30b9\u30bd\u30d5\u30c8 ClamAV\nLinux Malware Detect\n\u30eb\u30fc\u30c8\u30ad\u30c3\u30c8\u691c\u51fa\u30c4\u30fc\u30eb Rootkit Hunter (rkhunter)\n\u30eb\u30fc\u30c8\u30ad\u30c3\u30c8\u691c\u51fa\u30c4\u30fc\u30eb chkrootkit\n\u30d5\u30a1\u30a4\u30eb\u6539\u3056\u3093\u691c\u77e5\u30c4\u30fc\u30eb AFICK\n\u30d5\u30a1\u30a4\u30eb\u6539\u3056\u3093\u691c\u77e5\u30c4\u30fc\u30eb AIDE\n\u30d5\u30a1\u30a4\u30eb\u6539\u3056\u3093\u691c\u77e5\u30c4\u30fc\u30eb OSSEC\n\u30d5\u30a1\u30a4\u30eb\u6539\u3056\u3093\u691c\u77e5\u30c4\u30fc\u30eb Samhain\n\u8106\u5f31\u6027\u30b9\u30ad\u30e3\u30ca\u30fc OpenVAS\n\u8106\u5f31\u6027\u30b9\u30ad\u30e3\u30ca\u30fc Nikto\nLinux\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u76e3\u67fb\u30c4\u30fc\u30eb Lynis\n\n# OSSEC\nOSSEC \u306f inotify \u3092\u5229\u7528\u3057\u305f\u30ea\u30a2\u30eb\u30bf\u30a4\u30e0\u306e\u30d5\u30a1\u30a4\u30eb\u6539\u3056\u3093\u691c\u77e5\u304c\u3067\u304d\u308b HIDS \u3067\u3042\u308b\u3002\nOSSEC \u306f Daniel B. Cid \u306b\u3088\u3063\u3066\u66f8\u304b\u308c2004\u5e74\u306b\u516c\u958b\u3055\u308c\u305f\u3002\u305d\u306e\u5f8c2008\u5e74\u306b Third Brigade \u793e\u304c\u53d6\u5f97\u3057\u30012009\u5e74\u306b\u3055\u3089\u306b\u305d\u308c\u3092 Trend Micro \u793e\u304c\u8cb7\u53ce\u3057\u305f\u3002\n\n# HIDS\nOSSEC \u4ee5\u5916\u306e\u4e3b\u306a HIDS \u306f\u4ee5\u4e0b\u306e\u901a\u308a\u3002\n\n* [AFICK](http://qiita.com/bezeklik/items/298dafd2aeb053b4ca88) 3.5.2 (2016/08/05) - SourceForge \u306b rpm \u30d1\u30c3\u30b1\u30fc\u30b8\u304c\u3042\u308b\u3002\n* [AIDE](http://qiita.com/bezeklik/items/d144d77a3e54cd35c06b) 0.16 (2016/07/25) - CentOS \u306e Base \u30ea\u30dd\u30b8\u30c8\u30ea\u30fc\u306b\u3042\u308b\u3002\n* [OSSEC](http://qiita.com/bezeklik/items/2143c02f1432d90f5c38) 2.9_beta5 (2016/04/26) - inotify \u5bfe\u5fdc\u3002Atomic \u30ea\u30dd\u30b8\u30c8\u30ea\u30fc\u306b\u3042\u308b\u3002\n* [Samhain](http://qiita.com/bezeklik/items/6b7fb75f1a37b0fc41a2) 4.2.0 (2016/10/13) - inotify \u5bfe\u5fdc\u3002\n* [Tripwire](http://qiita.com/bezeklik/items/2dfb871b9397211c735b) 2.4.3.1 (2016/04/24)- EPEL \u30ea\u30dd\u30b8\u30c8\u30ea\u30fc\u306b\u3042\u308b\u3002\n\n# \u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\u30b7\u30a7\u30eb\u30b9\u30af\u30ea\u30d7\u30c8\u3067\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\u65b9\u6cd5\u3082\u3042\u308b\u304c\u3001Atomic \u30ea\u30dd\u30b8\u30c8\u30ea\u3092\u5229\u7528\u3057\u305f\u30d1\u30c3\u30b1\u30fc\u30b8\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u306b\u3053\u3060\u308f\u308b\u3002\n\n## EPEL \u30ea\u30dd\u30b8\u30c8\u30ea\u30fc\u306e\u8ffd\u52a0\n```bash\nyum install epel-release\nyum update epel-release\n```\ninotify-tools \u306f EPEL \u30ea\u30dd\u30b8\u30c8\u30ea\u30fc\u306e\u65b9\u304c\u65b0\u3057\u3044\u3002\nepel-release \u306f CentOS Extras \u30ea\u30dd\u30b8\u30c8\u30ea\u30fc\u3067\u306f 7-6 \u3068\u53e4\u3044\u306e\u3067\u3001\u30a2\u30c3\u30d7\u30c7\u30fc\u30c8\u3057\u3066 7-8 \u306b\u3059\u308b\u3002\n\n## Atomic \u30ea\u30dd\u30b8\u30c8\u30ea\u30fc\u306e\u8ffd\u52a0\n```bash\nyum install wget\ncurl -s http://www.atomicorp.com/installers/atomic | sh\n```\n\u30b9\u30af\u30ea\u30d7\u30c8\u5185\u3067 wget \u3092\u4f7f\u7528\u3057\u3066\u3044\u308b\u306e\u3067\u30b3\u30de\u30f3\u30c9\u304c\u306a\u3044\u3068\u30a8\u30e9\u30fc\u306a\u3057\u3067\u3053\u3051\u308b\u3002\n\n## OSSEC HIDS Server \u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n```bash\nyum install ossec-hids-server\nsystemctl enable ossec-hids\n```\n\n## ossec-configure\n```bash\n/var/ossec/bin/ossec-configure\n```\n```text\nOSSEC Configuration utility v0.1\n\n1- What kind of installation do you want? (server, agent, local) [Default: server]: local\n\n2- Setting up the configuration environment.\n\n3- Configuring the OSSEC HIDS.\n\n  3.1- Do you want e-mail notification? (y/n) [Default: y]:\n   - What's your e-mail address? root@localhost\n   - What's your SMTP server ip/host? localhost\n\n  3.2- Do you want to run the integrity check daemon? (y/n) [y]:\n\n  3.3- Do you want to run the rootkit detection engine? (y/n) [y]:\n\n  3.4- Active response allows you to execute a specific\n       command based on the events received. For example,\n       you can block an IP address or disable access for\n       a specific user.\n       More information at:\n       http://www.ossec.net/en/manual.html#active-response\n\n\n   - Do you want to enable active response? (y/n) [y]: n\n\n  3.5- Do you want to enable remote syslog (port 514 udp)? (y/n) [y]:\n\n    -- /var/log/messages (syslog)\n    -- /var/log/secure (syslog)\n    -- /var/log/maillog (syslog)\n    -- /var/log/httpd/error_log (apache log)\n    -- /var/log/httpd/access_log (apache log)\nConfiguration complete.\n```\n/var/ossec/etc/ossec.conf \u304c\u66f4\u65b0\u3055\u308c\u3001\u65e7\u30d5\u30a1\u30a4\u30eb\u306f /var/ossec/etc/ossec.conf.bak \u3068\u3057\u3066\u4fdd\u5b58\u3055\u308c\u308b\u3002\n\n### \u30ea\u30a2\u30eb\u30bf\u30a4\u30e0\u76e3\u8996\u306e\u6709\u52b9\u5316\n```\nsed -i '/directories check_all/s/\"yes\"/\"yes\" realtime=\"yes\"/' /var/ossec/etc/ossec.conf\nsystemctl start ossec-hids\ntail -f /var/ossec/logs/ossec.log\n```\n\u30ed\u30b0\u306b `Real time file monitoring started.` \u3068\u51fa\u529b\u3055\u308c\u308b\u307e\u3067\u30ea\u30a2\u30eb\u30bf\u30a4\u30e0\u76e3\u8996\u306f\u958b\u59cb\u3055\u308c\u306a\u3044\u3002\u691c\u8a3c\u74b0\u5883\u3067\u306f\u958b\u59cb\u307e\u306710\u5206\u7a0b\u5ea6\u304b\u304b\u3063\u305f\u3002\n\nhttp://ossec-docs.readthedocs.io/en/latest/manual/syscheck/#realtime-options\nhttp://ossec-docs.readthedocs.io/en/latest/manual/syscheck/#real-time-monitoring\n\n## OSSEC Web UI\nREADME \u306b\u306f\u300cOSSEC Web UI \u306f\u73fe\u5728\u30e1\u30f3\u30c6\u30ca\u30f3\u30b9\u3055\u308c\u3066\u304a\u3089\u305a\u3001\u975e\u63a8\u5968\u3002\u30a2\u30e9\u30fc\u30c8\u76e3\u8996\u306b\u306f Kibana \u304b Splunk \u307e\u305f\u306f\u540c\u69d8\u306e\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092\u4f7f\u7528\u3059\u308b\u3053\u3068\u3092\u52e7\u3081\u308b\u300d\u3068\u306e\u8a18\u8f09\u3002\n\nAtomic \u30ea\u30dd\u30b8\u30c8\u30ea\u306b ossec-wui \u30d1\u30c3\u30b1\u30fc\u30b8\u304c\u4e00\u5fdc\u3042\u308b\u304c\u3001\u3042\u307e\u308a\u30d1\u30c3\u30b1\u30fc\u30b8\u306e\u30e1\u30ea\u30c3\u30c8\u304c\u306a\u3044\u306e\u3067 GitHub \u304b\u3089\u6700\u65b0\u3092\u53d6\u5f97\u3059\u308b\u3002\n\n```bash\nyum install php php-gd\nsed -i 's/;date.timezone =/date.timezone = Asia\\/Tokyo/' /etc/php.ini\nsystemctl enable httpd\ncurl -L https://github.com/ossec/ossec-wui/archive/master.tar.gz -o ossec-wui.tar.gz\ntar vzxf ossec-wui.tar.gz --strip=1 -C /var/www/html\ncd /var/www/html\n./setup.sh\n```\n```\nSetting up ossec ui...\n\nUsername: <username>\nNew password: <password>\nRe-type new password: <password>\nAdding password for user ossec\nEnter your web server user name (e.g. apache, www, nobody, www-data, ...)\napache\nYou must restart your web server after this setup is done.\n\nSetup completed successfully.\n```\n```bash\nchown apache:apache -R /var/www/html\nchcon -t httpd_sys_content_t /var/ossec\nchcon -R -t httpd_sys_content_t /var/ossec/{logs,stats}/\nchcon -R -t httpd_sys_content_t /var/ossec/queue/{agent-info,syscheck}/\nsystemctl start httpd\n```\n\n# \u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u95a2\u9023\u8a18\u4e8b\n* [PHP\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u5f37\u5316\u30e2\u30b8\u30e5\u30fc\u30eb Suhosin](http://qiita.com/bezeklik/items/5e8b1f76465e39dc6cd0)\n* [DoS\u653b\u6483/\u30d6\u30eb\u30fc\u30c8\u30d5\u30a9\u30fc\u30b9\u653b\u6483\u5bfe\u7b56\u30a2\u30d7\u30ea\u306e\u8fd1\u6cc1](http://qiita.com/bezeklik/items/6d86a162e278f576e4ca)\n* [Linux\u30a2\u30f3\u30c1\u30a6\u30a4\u30eb\u30b9\u30bd\u30d5\u30c8 ClamAV](http://qiita.com/bezeklik/items/4696e15c889ffff6bc41)\n* [Linux Malware Detect](http://qiita.com/bezeklik/items/43a7d4fce6bc23fe84d3)\n* [\u30eb\u30fc\u30c8\u30ad\u30c3\u30c8\u691c\u51fa\u30c4\u30fc\u30eb Rootkit Hunter (rkhunter)](http://qiita.com/bezeklik/items/bc7affef8afe7c63f2ce)\n* [\u30eb\u30fc\u30c8\u30ad\u30c3\u30c8\u691c\u51fa\u30c4\u30fc\u30eb chkrootkit](http://qiita.com/bezeklik/items/7964ce67f1a1363b694e)\n* [\u30d5\u30a1\u30a4\u30eb\u6539\u3056\u3093\u691c\u77e5\u30c4\u30fc\u30eb AFICK](http://qiita.com/bezeklik/items/298dafd2aeb053b4ca88)\n* [\u30d5\u30a1\u30a4\u30eb\u6539\u3056\u3093\u691c\u77e5\u30c4\u30fc\u30eb AIDE](http://qiita.com/bezeklik/items/d144d77a3e54cd35c06b)\n* [\u30d5\u30a1\u30a4\u30eb\u6539\u3056\u3093\u691c\u77e5\u30c4\u30fc\u30eb OSSEC](http://qiita.com/bezeklik/items/2143c02f1432d90f5c38)\n* [\u30d5\u30a1\u30a4\u30eb\u6539\u3056\u3093\u691c\u77e5\u30c4\u30fc\u30eb Samhain](http://qiita.com/bezeklik/items/6b7fb75f1a37b0fc41a2)\n* [\u8106\u5f31\u6027\u30b9\u30ad\u30e3\u30ca\u30fc OpenVAS](http://qiita.com/bezeklik/items/a64cad37eb03a1db2de4)\n* [\u8106\u5f31\u6027\u30b9\u30ad\u30e3\u30ca\u30fc Nikto](http://qiita.com/bezeklik/items/12643654dc0c45f4eb29)\n* [Linux\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u76e3\u67fb\u30c4\u30fc\u30eb Lynis](http://qiita.com/bezeklik/items/cf9be2deb546c69123e7)\n", "tags": ["OSSEC2.8.3", "CentOS7", "\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3"]}