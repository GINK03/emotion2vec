{"tags": ["Unity", "Unity3D", "Android", "AndroidStudio"], "context": "\n\n\u306f\u3058\u3081\u306b\nAndroid Java\u3067\u306eUnity Plugin\u3092\u4f5c\u6210\u3092\u307e\u3068\u3081\u307e\u3057\u305f\u3002\n\u30c4\u30fc\u30eb\u306f\u4ee5\u4e0b\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u3092\u4f7f\u7528\u3057\u3066\u3044\u307e\u3059\u3002\n\u4ed6\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u3067\u3082\u5927\u4e08\u592b\u3060\u3068\u601d\u3044\u307e\u3059\u304caar\u3092\u6271\u3046\u305f\u3081Unity5\u4ee5\u4e0a\u3092\u5bfe\u8c61\u3068\u3057\u3066\u3044\u307e\u3059\u3002\n\nmacOS 10.12\nUnity 5.3.4\nAndroid Studio 2.2.3\n\n\u306a\u305c\u3053\u306e\u8a18\u4e8b\u3092\u66f8\u3053\u3046\u3068\u601d\u3063\u305f\u304b\u3068\u3044\u3046\u3068\u66f8\u7c4d\u306a\u3069\u3067\u306fAndroid Plugin\u306e\u9805\u306f\u5927\u4f53Toast\u8868\u793a\u7b49\u3067\u7d42\u308f\u3063\u3066\u3057\u307e\u3046\u304b\u3089\u3067\u3059..\n(Unity\u2192Android\u306e\u547c\u3073\u51fa\u3057\u306e\u307f)\n\u4eca\u56de\u306fUnity\u304b\u3089Android\u306e\u30bd\u30fc\u30b9\u3092\u547c\u3073\u51fa\u3057\u30b3\u30fc\u30eb\u30d0\u30c3\u30af\u3092\u53d7\u3051\u53d6\u308b\u3068\u3053\u308d\u307e\u3067\u884c\u3044\u307e\u3059\u3002\n(Unity\u2192Android, Android\u2192Unity\u306e\u547c\u3073\u51fa\u3057)\n\u3055\u308a\u3052\u306a\u304f\u524d\u56de\u306e\u8a18\u4e8b\u304b\u30899\u30f6\u6708\u8d8a\u3057\u306e\u7d9a\u7de8\u3067\u3059\u3002\n\u4ee5\u4e0b\u306e\u9806\u5e8f\u3067\u8aac\u660e\u3057\u307e\u3059\u3002\n\n1 \u958b\u767a\u65b9\u6cd5\u306b\u3064\u3044\u3066\n\n\n1.1 aar\u306e\u4f5c\u6210\u306b\u3064\u3044\u3066(AndroidStudio)\n1.2 Unity\u306eaar\u7d44\u307f\u8fbc\u307f\u306b\u3064\u3044\u3066(Unity)\n\n\n2 \u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u306b\u3064\u3044\u3066\n\n\n2.1 Unity\u2192Android\u306e\u547c\u3073\u51fa\u3057\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u306b\u3064\u3044\u3066(Unity)\n2.2 Android\u2192Unity\u306e\u547c\u3073\u51fa\u3057\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9(AndroidStudio)\n\n\n3 Tips\n\n\n1 \u958b\u767a\u65b9\u6cd5\u306b\u3064\u3044\u3066\n\n1.1 aar\u306e\u4f5c\u6210\u306b\u3064\u3044\u3066(AndroidStudio)\nAndroid\u3067\u9069\u5f53\u306a\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092\u4f5c\u6210\u3057\u3001New Module\u3067Android Library\u3092\u6307\u5b9a\u3057\u307e\u3059\u3002\n\nModule\u306elibs\u30d5\u30a9\u30eb\u30c0\u306bunity\u306eclasses.jar\u3092\u8ffd\u52a0\u3057\u307e\u3059\u3002(\u3053\u3053\u3067\u306funity5.3.4-classes.jar\u306brename\u3057\u307e\u3057\u305f)\nclasses.jar\u306e\u5834\u6240\u306f\u4ee5\u4e0bUnity\u30de\u30cb\u30e5\u30a2\u30eb\u306b\u66f8\u3044\u3066\u3042\u308a\u307e\u3059\u3002\n\n\u5f15\u7528) UnityPlayerActivity Java \u30b3\u30fc\u30c9\u306e\u62e1\u5f35\nhttps://docs.unity3d.com/ja/current/Manual/PluginsForAndroid.html\n\n\u307e\u305a Unity/Android \u306b\u4ed8\u5c5e\u3057\u3066\u3044\u308b classes.jar \u3092\u63a2\u3057\u307e\u3059\u3002\u3053\u306e\u30d5\u30a1\u30a4\u30eb\u306f Unity \u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u305f\u30d5\u30a9\u30eb\u30c0\u30fc\uff08Windows \u3067\u3042\u308c\u3070 C:\\Program Files\\Unity\\Editor\\Data \u3001MacOSX \u3067\u3042\u308c\u3070 /Applications/Unity \uff09\u306e\u30b5\u30d6\u30d5\u30a9\u30eb\u30c0\u30fc PlaybackEngines/AndroidPlayer/Variations/mono \u307e\u305f\u306f il2cpp/Development or Release/Classes/ \u306b\u3042\u308a\u307e\u3059\u3002\n\nclasses.jar\u3092\u8ffd\u52a0\u3057Sync\u3092\u304a\u3053\u306a\u3046\u3068Unity\u306e\u30af\u30e9\u30b9\u304c\u4f7f\u7528\u53ef\u80fd\u306b\u306a\u308a\u307e\u3059\u2193\n\n\u30d3\u30eb\u30c9\u6642\u306bunity\u306eclasses.jar\u306f\u4f5c\u6210\u3059\u308baar\u304b\u3089\u5916\u3059\u3088\u3046\u306b\u3057\u307e\u3059\u3002\nunity\u306eclasses.jar\u3092\u5916\u3055\u306a\u3044\u3068unity\u3067Android\u5411\u3051\u30d3\u30eb\u30c9\u3092\u884c\u3063\u305f\u3068\u304d\u306bunity\u306eclasses.jar\u304c\u91cd\u8907\u3068\u306a\u308a\u30d3\u30eb\u30c9\u306b\u5931\u6557\u3057\u307e\u3059\u3002\n\nbuild.gradle\nandroid.libraryVariants.all { variant ->\n    variant.outputs.each { output ->\n        output.packageLibrary.exclude('libs/unity5.3.4-classes.jar')\n    }\n}\n\n\n\u4e0a\u8a18\u3067Unity\u5411\u3051Android\u30e9\u30a4\u30d6\u30e9\u30ea\u4f5c\u6210\u306e\u6e96\u5099\u306f\u5b8c\u4e86\u3067\u3059\u3002\nAndroidStudio\u306e\u30e1\u30cb\u30e5\u30fc > Build > Make Module\n\u3092\u9078\u629e\u3059\u308b\u3068aar\u304c\u4f5c\u6210\u3055\u308c\u307e\u3059\u3002\n\u3053\u306e\u6642\u3001Proguard\u306e\u8a2d\u5b9a\u306b\u3054\u6ce8\u610f\u304f\u3060\u3055\u3044\u3002\nProguard\u3067\u30e1\u30bd\u30c3\u30c9\u540d\u3084\u30af\u30e9\u30b9\u540d\u304c\u5909\u308f\u308b\u3068Unity\u304b\u3089\u547c\u3073\u51fa\u3059\u6642\u306bClassNotFoundException\u306b\u306a\u308a\u307e\u3059\u3002\n\n1.2 Unity\u306eaar\u7d44\u307f\u8fbc\u307f\u306b\u3064\u3044\u3066(Unity)\n1.1\u3067\u4f5c\u6210\u3057\u305faar\u3092Assets > Plugins > Android\u306b\u30c9\u30e9\u30c3\u30b0\u3059\u308b\u3060\u3051\u3067\u3059\u3002\n\n\u306a\u305c\u3053\u308c\u3060\u3051\u3067\u52d5\u4f5c\u3059\u308b\u306e\u304b\u3068\u3044\u3046\u3068\u3001\u305d\u3046\u3044\u3046unity\u306e\u4ed5\u69d8\u306e\u305f\u3081\u3067\u3059\u3002\n\u8a73\u7d30\u306f\u4ee5\u4e0b\u3092\u898b\u3066\u304f\u3060\u3055\u3044\u3002\n\u53c2\u8003) Android \u30e9\u30a4\u30d6\u30e9\u30ea\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\nhttps://docs.unity3d.com/ja/current/Manual/PluginsForAndroid.html\n\u53c2\u8003) \u7279\u6b8a\u306a\u30d5\u30a9\u30eb\u30c0\u30fc\u540d\nhttps://docs.unity3d.com/jp/current/Manual/SpecialFolders.html\n\u307e\u305f\u3001Activity\u8ffd\u52a0\u3084\u6a29\u9650\u5909\u66f4\u306a\u3069\u3067AndroidManifest.xml\u3092\u5909\u66f4\u3059\u308b\u5834\u5408\u3001\u540c\u3058\u304fAssets > Plugins > Android\u306b\u8ffd\u52a0\u3057\u307e\u3059\u3002\n\u5f15\u7528) UnityPlayerActivity Java \u30b3\u30fc\u30c9\u306e\u62e1\u5f35\nhttps://docs.unity3d.com/ja/current/Manual/PluginsForAndroid.html\n\n\u65b0\u3057\u3044AndroidManifest.xml \u3092\u4f5c\u6210\u3059\u308b\u3053\u3068\u3082\u5fc5\u8981\u3067\u3059\u3002\nAndroidManifest.xml \u30d5\u30a1\u30a4\u30eb\u3082 Assets->Plugins->Android \u30d5\u30a9\u30eb\u30c0\u30fc\u306b\u914d\u7f6e\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\uff08\u30ab\u30b9\u30bf\u30e0\u30de\u30cb\u30d5\u30a7\u30b9\u30c8\u3092\u914d\u7f6e\u3059\u308b\u3068\u3001\u30c7\u30d5\u30a9\u30eb\u30c8\u306e Unity Android \u30de\u30cb\u30d5\u30a7\u30b9\u30c8\u3092\u5b8c\u5168\u306b\u30aa\u30fc\u30d0\u30fc\u30e9\u30a4\u30c9\u3057\u307e\u3059\uff09\u3002\n\n\u301c\u301c\n\u3053\u3053\u307e\u3067\u304cPlugin\u4f5c\u6210\u3068\u7d44\u307f\u8fbc\u307f\u624b\u9806\u3067\u3059\uff01(\u3068\u3066\u3082\u3056\u3063\u304f\u308a)\n\u6b21\u306f\u5b9f\u969b\u306e\u30b3\u30fc\u30c9\u547c\u3073\u51fa\u3057\u65b9\u6cd5\u3092\u8aac\u660e\u3057\u307e\u3059\u3002\n\u301c\u301c\n\n2. \u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u306b\u3064\u3044\u3066\n\n2.1 Unity\u2192Android\u306e\u547c\u3073\u51fa\u3057\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u306b\u3064\u3044\u3066(Unity)\n\u4e00\u756a\u7c21\u5358\u306a\u65b9\u6cd5\u306fAndroidJavaObject(AndroidJavaClass)\u306e\u4f7f\u7528\u3067\u3059\n\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u3067\u3042\u308c\u3070AndroidJavaObject\u3001\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u4e0d\u8981\u306a\u30af\u30e9\u30b9\u3078\u306e\u30a2\u30af\u30bb\u30b9\u306fAndroidJavaClass\u3067\u4f7f\u3044\u5206\u3051\u307e\u3059\u3002\nstatic\u306a\u30e1\u30bd\u30c3\u30c9\u3067\u3042\u308c\u3070CallStatic\u3001\u901a\u5e38\u306e\u30e1\u30bd\u30c3\u30c9\u306fCall\u3092\u547c\u3073\u307e\u3059\u3002\n\u4ee5\u4e0b\u30de\u30cb\u30e5\u30a2\u30eb\u306b\u30b5\u30f3\u30d7\u30eb\u30b3\u30fc\u30c9\u304c\u63b2\u8f09\u3055\u308c\u3066\u3044\u307e\u3059\u3002\n\u53c2\u8003) AndroidJavaObject Call\nhttps://docs.unity3d.com/ja/current/ScriptReference/AndroidJavaObject.Call.html\n\n2.2 Android\u2192Unity\u306e\u547c\u3073\u51fa\u3057\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9(AndroidStudio)\nAndroid\u5074\u304b\u3089Unity\u306e\u51e6\u7406\u3092\u547c\u3073\u51fa\u3059\u3053\u3068\u304c\u5fc5\u8981\u306a\u30b1\u30fc\u30b9\u304c\u3042\u308a\u307e\u3059\u3002\nAndroid Java\u5074\u3067\u30a4\u30d9\u30f3\u30c8\u30cf\u30f3\u30c9\u30e9\u3092\u304a\u3053\u306a\u3046\u5834\u5408\u3084\nUnity\u304cJava\u306e\u30af\u30e9\u30b9\u3092\u547c\u3073\u51fa\u3059\u969b\u306b\u975e\u540c\u671f\u3067\u5024\u3092\u8fd4\u3057\u3066\u6b32\u3057\u3044\u5834\u5408\u306a\u3069\u3067\u3059\u3002\n\u4e0a\u8a18\u306e\u3088\u3046\u306a\u5834\u5408\u306fcom.unity3d.player.UnityPlayer\u30af\u30e9\u30b9\u306eUnitySendMessage\u30e1\u30bd\u30c3\u30c9\u3092\u4f7f\u7528\u3057\u307e\u3059\u3002\n\nJava\u5074\u306e\u51e6\u7406\ncom.unity3d.player.UnityPlayer.UnitySendMessage(\n    GameObjectName, //string \u30b2\u30fc\u30e0\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u540d\n    MethodName, //string \u30e1\u30bd\u30c3\u30c9\u540d\n    message //string \u9001\u4fe1\u3059\u308b\u5024\n);\n\n\n\u4ee5\u4e0b\u30de\u30cb\u30e5\u30a2\u30eb\u306e\u901a\u308a\u3001Unity\u5074\u3067\u5bfe\u8c61\u306e\u30b2\u30fc\u30e0\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u5185\u30b3\u30f3\u30dd\u30fc\u30cd\u30f3\u30c8\u306b\u4ee5\u4e0b\u5f62\u5f0f\u3067\u30e1\u30bd\u30c3\u30c9\u3092\u5b9a\u7fa9\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\n\u5f15\u6570\u306f\u6587\u5b57\u5217\u30671\u3064\u306e\u307f\u306a\u306e\u3067\u8907\u6570\u30c7\u30fc\u30bf\u9001\u4fe1\u306fJSON\u306a\u3069\u306b\u5909\u63db\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\n\u8907\u6570\u4eba\u3067\u306e\u958b\u767a\u306e\u969b\u306f\u3042\u3089\u304b\u3058\u3081\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30a4\u30b9\u3092\u5b9a\u7fa9\u3059\u308b\u306e\u304c\u826f\u3044\u3068\u601d\u3044\u307e\u3059\u3002\n\nC#\nvoid MethodName(string message)\n\n\n\nJavascript\nfunction MethodName(message:string)\n\n\n\u53c2\u8003) \u30cd\u30a4\u30c6\u30a3\u30d6\u30b3\u30fc\u30c9\u304b\u3089 C#/JavaScript \u3092\u30b3\u30fc\u30eb\u30d0\u30c3\u30af\u3059\u308b\nhttps://docs.unity3d.com/jp/current/Manual/PluginsForIOS.html\n\n3 Tips\nAndroid Java\u4e0a\u3067UI\u64cd\u4f5c\u3092\u6271\u3046\u5834\u5408\u3001UI\u30b9\u30ec\u30c3\u30c9\u4ee5\u5916\u304b\u3089\u64cd\u4f5c\u3092\u884c\u3046\u3068IllegalStateException\u304c\u767a\u751f\u3057\u307e\u3059\u3002\nUnity\u304b\u3089\u547c\u3073\u51fa\u3059\u51e6\u7406\u3067UI\u64cd\u4f5c\u3092\u884c\u3046\u5834\u5408\u306f\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306bUI\u30b9\u30ec\u30c3\u30c9\u3067\u884c\u3046\u3088\u3046\u306b\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\nJava\u5074\u306e\u51e6\u7406\nimport android.app.Activity;\nimport com.unity3d.player.UnityPlayer;\n\npublic void someUIAction() {\n    final Activity activity = UnityPlayer.currentActivity;\n    activity.runOnUiThread(new Runnable() {\n        @Override\n        public void run() {\n            //UI\u64cd\u4f5c\u306e\u51e6\u7406\n        }\n    });\n}\n\n\n\n\u307e\u3068\u3081\nUnity\u304b\u3089Android Java\u306e\u547c\u3073\u51fa\u3057\u306fAndroidJavaObject, \u9006\u306fUnitySendMessage\u3067\u3068\u3044\u3046\u8a71\u3067\u3057\u305f\u3002\n\u3064\u307e\u3065\u304d\u3069\u3053\u308d\u3001\u74b0\u5883\u69cb\u7bc9\u3082\u307e\u3068\u3081\u305f\u306e\u3067Unity\u3067\u306eAndroid Plugin\u958b\u767a\u306f\n// C++\u3067\u306e\u958b\u767a\u306a\u3069\u306b\u624b\u3092\u51fa\u3055\u306a\u3051\u308c\u3070\n\u4e0a\u8a18\u3067\u5927\u4f53\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u308b\u3068\u601d\u3044\u307e\u3059\u3002\n\u53c2\u8003\u306b\u306a\u308c\u3070\u5e78\u3044\u3067\u3059\u3002\n# \u306f\u3058\u3081\u306b\nAndroid Java\u3067\u306eUnity Plugin\u3092\u4f5c\u6210\u3092\u307e\u3068\u3081\u307e\u3057\u305f\u3002\n\u30c4\u30fc\u30eb\u306f\u4ee5\u4e0b\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u3092\u4f7f\u7528\u3057\u3066\u3044\u307e\u3059\u3002\n\u4ed6\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u3067\u3082\u5927\u4e08\u592b\u3060\u3068\u601d\u3044\u307e\u3059\u304caar\u3092\u6271\u3046\u305f\u3081Unity5\u4ee5\u4e0a\u3092\u5bfe\u8c61\u3068\u3057\u3066\u3044\u307e\u3059\u3002\n\n - macOS 10.12\n - Unity 5.3.4\n - Android Studio 2.2.3\n\n\u306a\u305c\u3053\u306e\u8a18\u4e8b\u3092\u66f8\u3053\u3046\u3068\u601d\u3063\u305f\u304b\u3068\u3044\u3046\u3068\u66f8\u7c4d\u306a\u3069\u3067\u306fAndroid Plugin\u306e\u9805\u306f\u5927\u4f53Toast\u8868\u793a\u7b49\u3067\u7d42\u308f\u3063\u3066\u3057\u307e\u3046\u304b\u3089\u3067\u3059..\n(Unity\u2192Android\u306e\u547c\u3073\u51fa\u3057\u306e\u307f)\n\u4eca\u56de\u306fUnity\u304b\u3089Android\u306e\u30bd\u30fc\u30b9\u3092\u547c\u3073\u51fa\u3057\u30b3\u30fc\u30eb\u30d0\u30c3\u30af\u3092\u53d7\u3051\u53d6\u308b\u3068\u3053\u308d\u307e\u3067\u884c\u3044\u307e\u3059\u3002\n(Unity\u2192Android, Android\u2192Unity\u306e\u547c\u3073\u51fa\u3057)\n\n\u3055\u308a\u3052\u306a\u304f[\u524d\u56de\u306e\u8a18\u4e8b](http://qiita.com/keidroid/items/a513598bfcd718defb6a)\u304b\u30899\u30f6\u6708\u8d8a\u3057\u306e\u7d9a\u7de8\u3067\u3059\u3002\n\n\u4ee5\u4e0b\u306e\u9806\u5e8f\u3067\u8aac\u660e\u3057\u307e\u3059\u3002\n\n - 1 \u958b\u767a\u65b9\u6cd5\u306b\u3064\u3044\u3066\n  - 1.1 aar\u306e\u4f5c\u6210\u306b\u3064\u3044\u3066(AndroidStudio)\n  - 1.2 Unity\u306eaar\u7d44\u307f\u8fbc\u307f\u306b\u3064\u3044\u3066(Unity)\n - 2 \u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u306b\u3064\u3044\u3066\n  - 2.1 Unity\u2192Android\u306e\u547c\u3073\u51fa\u3057\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u306b\u3064\u3044\u3066(Unity)\n  - 2.2 Android\u2192Unity\u306e\u547c\u3073\u51fa\u3057\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9(AndroidStudio)\n - 3 Tips\n\n# 1 \u958b\u767a\u65b9\u6cd5\u306b\u3064\u3044\u3066\n## 1.1 aar\u306e\u4f5c\u6210\u306b\u3064\u3044\u3066(AndroidStudio)\n\nAndroid\u3067\u9069\u5f53\u306a\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092\u4f5c\u6210\u3057\u3001New Module\u3067Android Library\u3092\u6307\u5b9a\u3057\u307e\u3059\u3002\n\n<img width=\"1082\" alt=\"\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2017-02-28 1.32.10.png\" src=\"https://qiita-image-store.s3.amazonaws.com/0/19692/4aba2b01-b4af-f267-b6e5-8d7139a50845.png\">\n\nModule\u306elibs\u30d5\u30a9\u30eb\u30c0\u306bunity\u306eclasses.jar\u3092\u8ffd\u52a0\u3057\u307e\u3059\u3002(\u3053\u3053\u3067\u306funity5.3.4-classes.jar\u306brename\u3057\u307e\u3057\u305f)\nclasses.jar\u306e\u5834\u6240\u306f\u4ee5\u4e0bUnity\u30de\u30cb\u30e5\u30a2\u30eb\u306b\u66f8\u3044\u3066\u3042\u308a\u307e\u3059\u3002\n\n<img width=\"1105\" alt=\"\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2017-02-28 1.37.41.png\" src=\"https://qiita-image-store.s3.amazonaws.com/0/19692/83c3464a-01de-0df3-ac8b-9cce41f7ff3c.png\">\n\n\u5f15\u7528) UnityPlayerActivity Java \u30b3\u30fc\u30c9\u306e\u62e1\u5f35\nhttps://docs.unity3d.com/ja/current/Manual/PluginsForAndroid.html\n\n> \u307e\u305a Unity/Android \u306b\u4ed8\u5c5e\u3057\u3066\u3044\u308b classes.jar \u3092\u63a2\u3057\u307e\u3059\u3002\u3053\u306e\u30d5\u30a1\u30a4\u30eb\u306f Unity \u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u305f\u30d5\u30a9\u30eb\u30c0\u30fc\uff08Windows \u3067\u3042\u308c\u3070 C:\\Program Files\\Unity\\Editor\\Data \u3001MacOSX \u3067\u3042\u308c\u3070 /Applications/Unity \uff09\u306e\u30b5\u30d6\u30d5\u30a9\u30eb\u30c0\u30fc PlaybackEngines/AndroidPlayer/Variations/mono \u307e\u305f\u306f il2cpp/Development or Release/Classes/ \u306b\u3042\u308a\u307e\u3059\u3002\n\nclasses.jar\u3092\u8ffd\u52a0\u3057Sync\u3092\u304a\u3053\u306a\u3046\u3068Unity\u306e\u30af\u30e9\u30b9\u304c\u4f7f\u7528\u53ef\u80fd\u306b\u306a\u308a\u307e\u3059\u2193\n\n<img width=\"1033\" alt=\"\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2017-02-28 1.41.43.png\" src=\"https://qiita-image-store.s3.amazonaws.com/0/19692/f7754ef4-1522-3d81-afa6-ed1efcb76347.png\">\n\n\n\u30d3\u30eb\u30c9\u6642\u306bunity\u306eclasses.jar\u306f\u4f5c\u6210\u3059\u308baar\u304b\u3089\u5916\u3059\u3088\u3046\u306b\u3057\u307e\u3059\u3002\nunity\u306eclasses.jar\u3092\u5916\u3055\u306a\u3044\u3068unity\u3067Android\u5411\u3051\u30d3\u30eb\u30c9\u3092\u884c\u3063\u305f\u3068\u304d\u306bunity\u306eclasses.jar\u304c\u91cd\u8907\u3068\u306a\u308a\u30d3\u30eb\u30c9\u306b\u5931\u6557\u3057\u307e\u3059\u3002\n\n``` build.gradle\nandroid.libraryVariants.all { variant ->\n    variant.outputs.each { output ->\n        output.packageLibrary.exclude('libs/unity5.3.4-classes.jar')\n    }\n}\n```\n\n\u4e0a\u8a18\u3067Unity\u5411\u3051Android\u30e9\u30a4\u30d6\u30e9\u30ea\u4f5c\u6210\u306e\u6e96\u5099\u306f\u5b8c\u4e86\u3067\u3059\u3002\nAndroidStudio\u306e\u30e1\u30cb\u30e5\u30fc > Build > Make Module\n\u3092\u9078\u629e\u3059\u308b\u3068aar\u304c\u4f5c\u6210\u3055\u308c\u307e\u3059\u3002\n\n\u3053\u306e\u6642\u3001Proguard\u306e\u8a2d\u5b9a\u306b\u3054\u6ce8\u610f\u304f\u3060\u3055\u3044\u3002\nProguard\u3067\u30e1\u30bd\u30c3\u30c9\u540d\u3084\u30af\u30e9\u30b9\u540d\u304c\u5909\u308f\u308b\u3068Unity\u304b\u3089\u547c\u3073\u51fa\u3059\u6642\u306bClassNotFoundException\u306b\u306a\u308a\u307e\u3059\u3002\n\n## 1.2 Unity\u306eaar\u7d44\u307f\u8fbc\u307f\u306b\u3064\u3044\u3066(Unity)\n\n1.1\u3067\u4f5c\u6210\u3057\u305faar\u3092Assets > Plugins > Android\u306b\u30c9\u30e9\u30c3\u30b0\u3059\u308b\u3060\u3051\u3067\u3059\u3002\n\n<img width=\"627\" alt=\"\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2017-02-28 2.08.39.png\" src=\"https://qiita-image-store.s3.amazonaws.com/0/19692/cb8eb691-443f-034d-1a2a-33abe91d0a60.png\">\n\n\u306a\u305c\u3053\u308c\u3060\u3051\u3067\u52d5\u4f5c\u3059\u308b\u306e\u304b\u3068\u3044\u3046\u3068\u3001\u305d\u3046\u3044\u3046unity\u306e\u4ed5\u69d8\u306e\u305f\u3081\u3067\u3059\u3002\n\u8a73\u7d30\u306f\u4ee5\u4e0b\u3092\u898b\u3066\u304f\u3060\u3055\u3044\u3002\n\n\u53c2\u8003) Android \u30e9\u30a4\u30d6\u30e9\u30ea\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\nhttps://docs.unity3d.com/ja/current/Manual/PluginsForAndroid.html\n\u53c2\u8003) \u7279\u6b8a\u306a\u30d5\u30a9\u30eb\u30c0\u30fc\u540d\nhttps://docs.unity3d.com/jp/current/Manual/SpecialFolders.html\n\n\u307e\u305f\u3001Activity\u8ffd\u52a0\u3084\u6a29\u9650\u5909\u66f4\u306a\u3069\u3067AndroidManifest.xml\u3092\u5909\u66f4\u3059\u308b\u5834\u5408\u3001\u540c\u3058\u304fAssets > Plugins > Android\u306b\u8ffd\u52a0\u3057\u307e\u3059\u3002\n\n\u5f15\u7528) UnityPlayerActivity Java \u30b3\u30fc\u30c9\u306e\u62e1\u5f35\nhttps://docs.unity3d.com/ja/current/Manual/PluginsForAndroid.html\n\n> \u65b0\u3057\u3044AndroidManifest.xml \u3092\u4f5c\u6210\u3059\u308b\u3053\u3068\u3082\u5fc5\u8981\u3067\u3059\u3002\nAndroidManifest.xml \u30d5\u30a1\u30a4\u30eb\u3082 Assets->Plugins->Android \u30d5\u30a9\u30eb\u30c0\u30fc\u306b\u914d\u7f6e\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\uff08\u30ab\u30b9\u30bf\u30e0\u30de\u30cb\u30d5\u30a7\u30b9\u30c8\u3092\u914d\u7f6e\u3059\u308b\u3068\u3001\u30c7\u30d5\u30a9\u30eb\u30c8\u306e Unity Android \u30de\u30cb\u30d5\u30a7\u30b9\u30c8\u3092\u5b8c\u5168\u306b\u30aa\u30fc\u30d0\u30fc\u30e9\u30a4\u30c9\u3057\u307e\u3059\uff09\u3002\n\n\n\u301c\u301c\n\n\u3053\u3053\u307e\u3067\u304cPlugin\u4f5c\u6210\u3068\u7d44\u307f\u8fbc\u307f\u624b\u9806\u3067\u3059\uff01(\u3068\u3066\u3082\u3056\u3063\u304f\u308a)\n\u6b21\u306f\u5b9f\u969b\u306e\u30b3\u30fc\u30c9\u547c\u3073\u51fa\u3057\u65b9\u6cd5\u3092\u8aac\u660e\u3057\u307e\u3059\u3002\n\n\u301c\u301c\n\n# 2. \u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u306b\u3064\u3044\u3066\n## 2.1 Unity\u2192Android\u306e\u547c\u3073\u51fa\u3057\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u306b\u3064\u3044\u3066(Unity)\n\n\u4e00\u756a\u7c21\u5358\u306a\u65b9\u6cd5\u306fAndroidJavaObject(AndroidJavaClass)\u306e\u4f7f\u7528\u3067\u3059\n\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u3067\u3042\u308c\u3070AndroidJavaObject\u3001\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u4e0d\u8981\u306a\u30af\u30e9\u30b9\u3078\u306e\u30a2\u30af\u30bb\u30b9\u306fAndroidJavaClass\u3067\u4f7f\u3044\u5206\u3051\u307e\u3059\u3002\nstatic\u306a\u30e1\u30bd\u30c3\u30c9\u3067\u3042\u308c\u3070CallStatic\u3001\u901a\u5e38\u306e\u30e1\u30bd\u30c3\u30c9\u306fCall\u3092\u547c\u3073\u307e\u3059\u3002\n\u4ee5\u4e0b\u30de\u30cb\u30e5\u30a2\u30eb\u306b\u30b5\u30f3\u30d7\u30eb\u30b3\u30fc\u30c9\u304c\u63b2\u8f09\u3055\u308c\u3066\u3044\u307e\u3059\u3002\n\n\u53c2\u8003) AndroidJavaObject Call\nhttps://docs.unity3d.com/ja/current/ScriptReference/AndroidJavaObject.Call.html\n\n## 2.2 Android\u2192Unity\u306e\u547c\u3073\u51fa\u3057\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9(AndroidStudio)\n\nAndroid\u5074\u304b\u3089Unity\u306e\u51e6\u7406\u3092\u547c\u3073\u51fa\u3059\u3053\u3068\u304c\u5fc5\u8981\u306a\u30b1\u30fc\u30b9\u304c\u3042\u308a\u307e\u3059\u3002\nAndroid Java\u5074\u3067\u30a4\u30d9\u30f3\u30c8\u30cf\u30f3\u30c9\u30e9\u3092\u304a\u3053\u306a\u3046\u5834\u5408\u3084\nUnity\u304cJava\u306e\u30af\u30e9\u30b9\u3092\u547c\u3073\u51fa\u3059\u969b\u306b\u975e\u540c\u671f\u3067\u5024\u3092\u8fd4\u3057\u3066\u6b32\u3057\u3044\u5834\u5408\u306a\u3069\u3067\u3059\u3002\n\n\u4e0a\u8a18\u306e\u3088\u3046\u306a\u5834\u5408\u306fcom.unity3d.player.UnityPlayer\u30af\u30e9\u30b9\u306eUnitySendMessage\u30e1\u30bd\u30c3\u30c9\u3092\u4f7f\u7528\u3057\u307e\u3059\u3002\n\n``` java:Java\u5074\u306e\u51e6\u7406\ncom.unity3d.player.UnityPlayer.UnitySendMessage(\n    GameObjectName, //string \u30b2\u30fc\u30e0\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u540d\n    MethodName, //string \u30e1\u30bd\u30c3\u30c9\u540d\n    message //string \u9001\u4fe1\u3059\u308b\u5024\n);\n```\n\n\u4ee5\u4e0b\u30de\u30cb\u30e5\u30a2\u30eb\u306e\u901a\u308a\u3001Unity\u5074\u3067\u5bfe\u8c61\u306e\u30b2\u30fc\u30e0\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u5185\u30b3\u30f3\u30dd\u30fc\u30cd\u30f3\u30c8\u306b\u4ee5\u4e0b\u5f62\u5f0f\u3067\u30e1\u30bd\u30c3\u30c9\u3092\u5b9a\u7fa9\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\n\u5f15\u6570\u306f\u6587\u5b57\u5217\u30671\u3064\u306e\u307f\u306a\u306e\u3067\u8907\u6570\u30c7\u30fc\u30bf\u9001\u4fe1\u306fJSON\u306a\u3069\u306b\u5909\u63db\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\n\u8907\u6570\u4eba\u3067\u306e\u958b\u767a\u306e\u969b\u306f\u3042\u3089\u304b\u3058\u3081\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30a4\u30b9\u3092\u5b9a\u7fa9\u3059\u308b\u306e\u304c\u826f\u3044\u3068\u601d\u3044\u307e\u3059\u3002\n\n``` C#:C#\nvoid MethodName(string message)\n```\n\n``` javascript:Javascript\nfunction MethodName(message:string)\n```\n\n\u53c2\u8003) \u30cd\u30a4\u30c6\u30a3\u30d6\u30b3\u30fc\u30c9\u304b\u3089 C#/JavaScript \u3092\u30b3\u30fc\u30eb\u30d0\u30c3\u30af\u3059\u308b\nhttps://docs.unity3d.com/jp/current/Manual/PluginsForIOS.html\n\n# 3 Tips\nAndroid Java\u4e0a\u3067UI\u64cd\u4f5c\u3092\u6271\u3046\u5834\u5408\u3001UI\u30b9\u30ec\u30c3\u30c9\u4ee5\u5916\u304b\u3089\u64cd\u4f5c\u3092\u884c\u3046\u3068IllegalStateException\u304c\u767a\u751f\u3057\u307e\u3059\u3002\nUnity\u304b\u3089\u547c\u3073\u51fa\u3059\u51e6\u7406\u3067UI\u64cd\u4f5c\u3092\u884c\u3046\u5834\u5408\u306f\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306bUI\u30b9\u30ec\u30c3\u30c9\u3067\u884c\u3046\u3088\u3046\u306b\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n``` java:Java\u5074\u306e\u51e6\u7406\nimport android.app.Activity;\nimport com.unity3d.player.UnityPlayer;\n\npublic void someUIAction() {\n    final Activity activity = UnityPlayer.currentActivity;\n    activity.runOnUiThread(new Runnable() {\n        @Override\n        public void run() {\n            //UI\u64cd\u4f5c\u306e\u51e6\u7406\n        }\n    });\n}\n```\n\n# \u307e\u3068\u3081\nUnity\u304b\u3089Android Java\u306e\u547c\u3073\u51fa\u3057\u306fAndroidJavaObject, \u9006\u306fUnitySendMessage\u3067\u3068\u3044\u3046\u8a71\u3067\u3057\u305f\u3002\n\u3064\u307e\u3065\u304d\u3069\u3053\u308d\u3001\u74b0\u5883\u69cb\u7bc9\u3082\u307e\u3068\u3081\u305f\u306e\u3067Unity\u3067\u306eAndroid Plugin\u958b\u767a\u306f\n// C++\u3067\u306e\u958b\u767a\u306a\u3069\u306b\u624b\u3092\u51fa\u3055\u306a\u3051\u308c\u3070\n\u4e0a\u8a18\u3067\u5927\u4f53\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u308b\u3068\u601d\u3044\u307e\u3059\u3002\n\u53c2\u8003\u306b\u306a\u308c\u3070\u5e78\u3044\u3067\u3059\u3002\n"}