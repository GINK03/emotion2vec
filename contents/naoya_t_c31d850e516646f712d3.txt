{"context": " More than 1 year has passed since last update.\uff08\u8ab0\u5f97Octave\u30b3\u30fc\u30c9\u3092Qiita\u306b\u8cbc\u308a\u4ed8\u3051\u3066\u3044\u304f\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\uff09\n1;\n\nfunction g = gaussian(x, mu,sigma)\n  g = 1/sqrt(2*pi*sigma^2) * exp(-1/(2*sigma^2)*(x-mu)^2);\nendfunction\n\nfunction g = gaussian2(x, mu,Sigma)\n  g = 1/(2*pi*sqrt(det(Sigma))) * exp(-1/2*(x-mu)'*inv(Sigma)*(x-mu));\nendfunction\n\nfunction plotfun2(fun, param)\n  x = linspace(-1, 1, 3);\n  plot(x, arrayfun(fun, x), param);\nendfunction\n\nfunction plotfun3(fun)\n  [xx, yy] = meshgrid(linspace(-1, 1, 51));\n  mesh(xx, yy, arrayfun(fun, xx, yy));\n  view(-15, 80);\nendfunction\n\nfunction savegif(id)\n  filename = sprintf(\"fig37_%03d.gif\", id);\n  print(filename, \"-dgif\");\nendfunction\n\nN = 20;\na = [-0.3 0.5];\n\nxs = rand(N, 1)*2-1; % U(x|-1,1)\nts = arrayfun(@(x)[1 x]*a', xs) + 0.2*randn(N, 1);\n\nalpha = 2.0;\nbeta  = 25; % = (1/0.2)^2\n\n%% \u521d\u671f\u5024\nmu       = [0; 0];\nSigma    = eye(2);\ninvSigma = inv(Sigma);\n\nfor i = 1:N\n  printf(\"w\u7a7a\u9593\u306e\u4e8b\u524d\u5206\u5e03\u00a5n\");\n  clf;\n  hold on;\n  title(\"prior/posterior\");\n  xlabel(\"w0\");\n  ylabel(\"w1\");\n  plot3(a(1), a(2), 0, 'x');\n  plotfun3(@(w0,w1) gaussian2([w0;w1],mu,Sigma));\n  hold off;\n  % savegif((i-1)*3+1);\n  pause\n\n  printf(\"\u73fe\u5728\u306e\u4e8b\u524d\u5206\u5e03\u304b\u3089 w \u3092\u30e9\u30f3\u30c0\u30e0\u306b6\u500b\u9078\u3093\u3067 y(x,w) \u3092\u30d7\u30ed\u30c3\u30c8\u00a5n\");\n  clf;\n  hold on;\n  axis([-1, 1, -1, 1])\n  title(\"6 samples from w\");\n  xlabel(\"x\");\n  ylabel(\"y\");\n  for j = 1:6\n    %% \u4e8c\u6b21\u5143\u30ac\u30a6\u30b9\u5206\u5e03 N(_mu,_Sigma) \u306b\u5f93\u3046\u4e71\u6570\u3092\u6c42\u3081\u308b\n    L = chol(Sigma);\n    w = mu + L*rand(2, 1);\n    plotfun2(@(x) [1 x]*w, 'r');\n  endfor\n  plot(xs(1:i), ts(1:i), 'o');\n  drawnow()\n  % savegif((i-1)*3+2);\n  hold off;\n  pause\n\n  xi = xs(i);\n  ti = ts(i);\n  phi = [1 xi]; % \u8a08\u753b\u884c\u5217 \u03a6 \u306f\u5358\u7d14\u306b [1 x] \u3067\n\n  printf(\"\u5c24\u5ea6\u95a2\u6570 p(t|x, w) \u3092 w\u306e\u95a2\u6570\u3068\u3057\u3066\u30d7\u30ed\u30c3\u30c8\u00a5n\");\n  clf;\n  hold on;\n  title(\"likelihood\");\n  xlabel(\"w0\");\n  ylabel(\"w1\");\n  plotfun3(@(w0,w1) gaussian(ti, phi*[w0;w1], 1/beta));\n  % savegif((i-1)*3+3);\n  hold off;\n  pause\n\n  printf(\"\u300c\u4e8b\u5f8c\u5206\u5e03 = \u4e8b\u524d\u5206\u5e03 \u00d7 \u5c24\u5ea6\u300d\u00a5n\");\n  % \u5f0f (3.50) (3.51) \u3067\u5206\u5e03\u306e \u03bc \u3068 \u03a3 \u3092\u66f4\u65b0\n  next_invSigma = invSigma + beta*phi'*phi;\n  next_Sigma    = inv(next_invSigma);\n  next_mu       = next_Sigma * (invSigma*mu + beta*phi'*ti);\n\n  Sigma    = next_Sigma;\n  invSigma = next_invSigma;\n  mu       = next_mu;\nendfor\n\n\n\u30a2\u30cb\u30e1\u30fc\u30b7\u30e7\u30f3GIF\u5316\n$ convert -delay 100 fig37_*.gif -loop 0 fig37_anim.gif\n\n\n\uff08\u8ab0\u5f97Octave\u30b3\u30fc\u30c9\u3092Qiita\u306b\u8cbc\u308a\u4ed8\u3051\u3066\u3044\u304f\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\uff09\n\n```octave\n1;\n\nfunction g = gaussian(x, mu,sigma)\n  g = 1/sqrt(2*pi*sigma^2) * exp(-1/(2*sigma^2)*(x-mu)^2);\nendfunction\n\nfunction g = gaussian2(x, mu,Sigma)\n  g = 1/(2*pi*sqrt(det(Sigma))) * exp(-1/2*(x-mu)'*inv(Sigma)*(x-mu));\nendfunction\n\nfunction plotfun2(fun, param)\n  x = linspace(-1, 1, 3);\n  plot(x, arrayfun(fun, x), param);\nendfunction\n\nfunction plotfun3(fun)\n  [xx, yy] = meshgrid(linspace(-1, 1, 51));\n  mesh(xx, yy, arrayfun(fun, xx, yy));\n  view(-15, 80);\nendfunction\n\nfunction savegif(id)\n  filename = sprintf(\"fig37_%03d.gif\", id);\n  print(filename, \"-dgif\");\nendfunction\n\nN = 20;\na = [-0.3 0.5];\n\nxs = rand(N, 1)*2-1; % U(x|-1,1)\nts = arrayfun(@(x)[1 x]*a', xs) + 0.2*randn(N, 1);\n\nalpha = 2.0;\nbeta  = 25; % = (1/0.2)^2\n\n%% \u521d\u671f\u5024\nmu       = [0; 0];\nSigma    = eye(2);\ninvSigma = inv(Sigma);\n\nfor i = 1:N\n  printf(\"w\u7a7a\u9593\u306e\u4e8b\u524d\u5206\u5e03\u00a5n\");\n  clf;\n  hold on;\n  title(\"prior/posterior\");\n  xlabel(\"w0\");\n  ylabel(\"w1\");\n  plot3(a(1), a(2), 0, 'x');\n  plotfun3(@(w0,w1) gaussian2([w0;w1],mu,Sigma));\n  hold off;\n  % savegif((i-1)*3+1);\n  pause\n\n  printf(\"\u73fe\u5728\u306e\u4e8b\u524d\u5206\u5e03\u304b\u3089 w \u3092\u30e9\u30f3\u30c0\u30e0\u306b6\u500b\u9078\u3093\u3067 y(x,w) \u3092\u30d7\u30ed\u30c3\u30c8\u00a5n\");\n  clf;\n  hold on;\n  axis([-1, 1, -1, 1])\n  title(\"6 samples from w\");\n  xlabel(\"x\");\n  ylabel(\"y\");\n  for j = 1:6\n    %% \u4e8c\u6b21\u5143\u30ac\u30a6\u30b9\u5206\u5e03 N(_mu,_Sigma) \u306b\u5f93\u3046\u4e71\u6570\u3092\u6c42\u3081\u308b\n    L = chol(Sigma);\n    w = mu + L*rand(2, 1);\n    plotfun2(@(x) [1 x]*w, 'r');\n  endfor\n  plot(xs(1:i), ts(1:i), 'o');\n  drawnow()\n  % savegif((i-1)*3+2);\n  hold off;\n  pause\n\n  xi = xs(i);\n  ti = ts(i);\n  phi = [1 xi]; % \u8a08\u753b\u884c\u5217 \u03a6 \u306f\u5358\u7d14\u306b [1 x] \u3067\n\n  printf(\"\u5c24\u5ea6\u95a2\u6570 p(t|x, w) \u3092 w\u306e\u95a2\u6570\u3068\u3057\u3066\u30d7\u30ed\u30c3\u30c8\u00a5n\");\n  clf;\n  hold on;\n  title(\"likelihood\");\n  xlabel(\"w0\");\n  ylabel(\"w1\");\n  plotfun3(@(w0,w1) gaussian(ti, phi*[w0;w1], 1/beta));\n  % savegif((i-1)*3+3);\n  hold off;\n  pause\n\n  printf(\"\u300c\u4e8b\u5f8c\u5206\u5e03 = \u4e8b\u524d\u5206\u5e03 \u00d7 \u5c24\u5ea6\u300d\u00a5n\");\n  % \u5f0f (3.50) (3.51) \u3067\u5206\u5e03\u306e \u03bc \u3068 \u03a3 \u3092\u66f4\u65b0\n  next_invSigma = invSigma + beta*phi'*phi;\n  next_Sigma    = inv(next_invSigma);\n  next_mu       = next_Sigma * (invSigma*mu + beta*phi'*ti);\n\n  Sigma    = next_Sigma;\n  invSigma = next_invSigma;\n  mu       = next_mu;\nendfor\n```\n\n### \u30a2\u30cb\u30e1\u30fc\u30b7\u30e7\u30f3GIF\u5316\n\n```\n$ convert -delay 100 fig37_*.gif -loop 0 fig37_anim.gif\n```\n![fig37_anim](http://www1419ue.sakura.ne.jp/fig37_anim.gif)\n", "tags": ["PRML", "Octave"]}