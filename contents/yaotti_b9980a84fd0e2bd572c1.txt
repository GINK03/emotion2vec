{"context": " More than 1 year has passed since last update.\u4ee5\u4e0b\u306e\u5909\u66f4\u3067Qiita\u306e\u30c7\u30d7\u30ed\u30a4\u304c2\u520646\u79d2\u304b\u308925\u79d2\u7a0b\u5ea6\u306b\u307e\u3067\u65e9\u304f\u306a\u3063\u305f\uff0e\n\u30c7\u30d7\u30ed\u30a4\u6642\u9593\u304c7\u5206\u306e1\u306b\uff0e\u8d85\u5feb\u9069\uff0e\nhttp://stackoverflow.com/questions/9016002/speed-up-assetsprecompile-with-rails-3-1-3-2-capistrano-deployment \u306e\u901a\u308a\uff0c\u4ee5\u4e0b\u3092deploy.rb\u306enamespace :deploy\u30d6\u30ed\u30c3\u30af\u306b\u8ffd\u52a0\u3059\u308b\uff0e\n\ndeploy.rb\n  namespace :assets do\n    task :precompile, :roles => :web, :except => { :no_release => true } do\n      from = source.next_revision(current_revision)\n      if capture(\"cd #{latest_release} && #{source.local.log(from)} app/assets/ | wc -l\").to_i > 0\n        run %Q{cd #{latest_release} && #{rake} RAILS_ENV=#{rails_env} #{asset_env} assets:precompile}\n      else\n        logger.info \"Skipping asset pre-compilation because there were no asset changes\"\n      end\n    end\n  end\n\n\nCapfile\u3067\u81ea\u5206\u306edeploy.rb\u3092capistrano\u306edeploy/assets.rb\u3088\u308a\u3082\u5f8c\u3067\u30ed\u30fc\u30c9\u3059\u308b\u3088\u3046\u306b\u5909\u66f4\u3059\u308b\uff0e\n\u3053\u3046\u3057\u306a\u3044\u3068\u81ea\u5206\u306e\u30bf\u30b9\u30af\u304c\u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u4e0a\u66f8\u304d\u3055\u308c\u3066\u3057\u307e\u3046\uff0e\n--- a/Capfile\n+++ b/Capfile\n@@ -2,5 +2,5 @@\n load 'deploy' if respond_to?(:namespace) # cap2 differentiator\n Dir['vendor/gems/*/recipes/*.rb','vendor/plugins/*/recipes/*.rb'].each { |plugin| load(plugin) }\n\n-load 'config/deploy' # remove this line to skip loading any of the default tasks\n load 'deploy/assets'            # for 'rake assets:precompile'\n+load 'config/deploy' # remove this line to skip loading any of the default tasks\n\n\u3053\u308c\u306fgit\u3067\u3057\u304b\u4f7f\u3048\u306a\u3044\u3051\u3069\uff0c\u4ed6\u306eCVS\u306b\u3082\u5bfe\u5fdc\u3057\u305f\u30d1\u30c3\u30c1\u9001\u308b\u3068\u5e78\u305b\u306b\u306a\u308b\u4eba\u591a\u305d\u3046\n\u4ee5\u4e0b\u306e\u5909\u66f4\u3067Qiita\u306e\u30c7\u30d7\u30ed\u30a4\u304c2\u520646\u79d2\u304b\u308925\u79d2\u7a0b\u5ea6\u306b\u307e\u3067\u65e9\u304f\u306a\u3063\u305f\uff0e\n\u30c7\u30d7\u30ed\u30a4\u6642\u9593\u304c7\u5206\u306e1\u306b\uff0e\u8d85\u5feb\u9069\uff0e\n\nhttp://stackoverflow.com/questions/9016002/speed-up-assetsprecompile-with-rails-3-1-3-2-capistrano-deployment \u306e\u901a\u308a\uff0c\u4ee5\u4e0b\u3092deploy.rb\u306e`namespace :deploy`\u30d6\u30ed\u30c3\u30af\u306b\u8ffd\u52a0\u3059\u308b\uff0e\n\n```ruby:deploy.rb\n  namespace :assets do\n    task :precompile, :roles => :web, :except => { :no_release => true } do\n      from = source.next_revision(current_revision)\n      if capture(\"cd #{latest_release} && #{source.local.log(from)} app/assets/ | wc -l\").to_i > 0\n        run %Q{cd #{latest_release} && #{rake} RAILS_ENV=#{rails_env} #{asset_env} assets:precompile}\n      else\n        logger.info \"Skipping asset pre-compilation because there were no asset changes\"\n      end\n    end\n  end\n```\n\n`Capfile`\u3067\u81ea\u5206\u306edeploy.rb\u3092capistrano\u306edeploy/assets.rb\u3088\u308a\u3082\u5f8c\u3067\u30ed\u30fc\u30c9\u3059\u308b\u3088\u3046\u306b\u5909\u66f4\u3059\u308b\uff0e\n\u3053\u3046\u3057\u306a\u3044\u3068\u81ea\u5206\u306e\u30bf\u30b9\u30af\u304c\u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u4e0a\u66f8\u304d\u3055\u308c\u3066\u3057\u307e\u3046\uff0e\n\n```diff\n--- a/Capfile\n+++ b/Capfile\n@@ -2,5 +2,5 @@\n load 'deploy' if respond_to?(:namespace) # cap2 differentiator\n Dir['vendor/gems/*/recipes/*.rb','vendor/plugins/*/recipes/*.rb'].each { |plugin| load(plugin) }\n \n-load 'config/deploy' # remove this line to skip loading any of the default tasks\n load 'deploy/assets'            # for 'rake assets:precompile'\n+load 'config/deploy' # remove this line to skip loading any of the default tasks\n```\n\n\u3053\u308c\u306fgit\u3067\u3057\u304b\u4f7f\u3048\u306a\u3044\u3051\u3069\uff0c\u4ed6\u306eCVS\u306b\u3082\u5bfe\u5fdc\u3057\u305f\u30d1\u30c3\u30c1\u9001\u308b\u3068\u5e78\u305b\u306b\u306a\u308b\u4eba\u591a\u305d\u3046", "tags": ["capistrano"]}