{"context": " More than 1 year has passed since last update.\u203b 2015/09\u306b\u4fee\u6b63\n\nRPi2\u306e\u6761\u4ef6\n\n\u30e6\u30fc\u30b6\n\n$ whoami\npi\n\n\n\u5b9f\u884c\u3057\u305f\u30a2\u30c3\u30d7\u30c7\u30fc\u30c8\n\n$ sudo apt-get -y update && sudo apt-get -y upgrade\n$ sudo rpi-update\n\n\n\u74b0\u5883\n\n$ cat /etc/debian_version\n7.8\n\n$ uname -a\nLinux raspberrypi 4.1.6-v7+ #810 SMP PREEMPT Tue Aug 18 15:32:12 BST 2015 armv7l GNU/Linux\n\n$ which ruby\n/home/pi/.rbenv/shims/ruby\n\n$ ruby -v\nruby 2.2.3p173 (2015-08-18 revision 51636) [armv7l-linux-eabihf]\n\n$ gem -v\n2.4.5.1\n\n\nTrema\u306e\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\n$ gem install trema -V\n\n\n\u30c1\u30a7\u30c3\u30af\n\n$ trema --version\ntrema version 0.6.0\n\n$ gem which trema\n/home/pi/.rbenv/versions/2.2.3/lib/ruby/gems/2.2.0/gems/trema-0.6.0/lib/trema.rb\n\n\nOpen vSwitch\u306e\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7(\u30bd\u30fc\u30b9\u304b\u3089)\n\n\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\n\n$ wget http://openvswitch.org/releases/openvswitch-2.4.0.tar.gz\n\n\n\u89e3\u51cd\n\n$ tar xzf openvswitch-2.4.0.tar.gz\n\n\n\u30d3\u30eb\u30c9(\u89e3\u51cd\u3055\u308c\u305f\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306eINSTALL.Debian\u3092\u898b\u306a\u304c\u3089)\n\n$ sudo apt-get -y install build-essential fakeroot\n$ cd openvswitch-2.4.0 && dpkg-checkbuilddeps\n$ sudo apt-get install [\u51fa\u529b\u3055\u308c\u305f\u30d1\u30c3\u30b1\u30fc\u30b8]\n$ # .deb \u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u308b(test\u304c\u6709\u52b9\u3060\u3068\u6642\u9593\u304c\u304b\u304b\u308b\u306e\u3067\u3084\u3081\u305f)\n$ DEB_BUILD_OPTIONS='nocheck' fakeroot debian/rules binary\n\n\n\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n$ dpkg -l | grep openvswitch # \u3067\u51fa\u3066\u304d\u305f\u3082\u306e\u3092\u6d88\u3059\n$ sudo apt-get purge openvswitch-switch\n$ sudo apt-get purge openvswitch-common\n\n$ # \u4ee5\u4e0b1\u3067dkms\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u308d\u3068\u8a00\u308f\u308c\u3066\u3057\u305f\u304c\u3001\n$ sudo apt-get install dkms\n\n$ # \u3053\u306e\u3088\u3046\u306b\u30a8\u30e9\u30fc\u304c\u51fa\u308b\u3002\n$ # Your kernel headers for kernel 4.1.6-v7+ cannot be found at\n$ # /lib/modules/4.1.6-v7+/build or /lib/modules/4.1.6-v7+/source.\n$ # [apt-cache search linux-headers-$(uname -r)] \u3067\u898b\u3064\u304b\u3089\u306a\u3044\u306e\u3067\u3053\u306e\u307e\u307e\u9032\u3080\n\n$ # 1\n$ sudo dpkg -i openvswitch-datapath-dkms_2.4.0-1_all.deb\n\n$ sudo dpkg -i openvswitch-common_2.4.0-1_armhf.deb\n$ sudo dpkg -i openvswitch-switch_2.4.0-1_armhf.deb\n\n\n\u30b9\u30bf\u30fc\u30c8\n\n$ sudo service openvswitch-switch start\novsdb-server is already running.\novs-vswitchd is already running.\nEnabling remote OVSDB managers.\n\n\nHello Trema\n\nraspbian\u3067IPv6\u3092\u6709\u52b9\u306b\u3059\u308b(\u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u7121\u52b9\u306b\u306a\u3063\u3066\u3044\u308b)\u3002\n\n\u307e\u305a\u3001IPv6\u3092\u6709\u52b9\u306b\n\n\n\u4eca\u3059\u3050\n\n\n\n  $ sudo modprobe ipv6\n\n\n\u305d\u3057\u3066\u3053\u308c\u304b\u3089\u3082(boot\u6642\u306benable)\n\n  $ echo ipv6 | sudo tee -a /etc/modules\n\n\n\u7406\u7531\u306f\u3001\u3042\u3089\u304b\u3058\u3081IPv6\u304c\u6709\u52b9\u3067\u306a\u3044\u3068\u4e0b\u8a18\u3067\u30a8\u30e9\u30fc(No such file ...)\u306b\u306a\u308b\u304b\u3089\u3002\n\n  sh \"sudo /sbin/sysctl -w net.ipv6.conf.#{bridge_name}.disable_ipv6=1 -q\"\n\n\n\u53c2\u8003\n\n\nhttps://www.raspbian.org/RaspbianFAQ#How_do_I_enable_or_use_IPv6.3F\n\n\n\n\nHello! (yay! )\n$ git clone https://github.com/trema/hello_trema.git\n$ cd hello_trema\n$ trema run lib/hello_trema.rb -c trema.conf\n[sudo] password for pi:\nTrema started.\nHello 0xabc!\n\n$ bundle install --binstubs\n$ bundle exec ./bin/trema run ./lib/hello_trema.\n[sudo] password for pi:\nTrema started.\nHello 0xabc!\n\n\n\n\u30a8\u30e9\u30fc\u3067\u9014\u4e2d\u7d42\u4e86\u3057\u305f\u5834\u5408\u306a\u3069\u306e\u53c2\u8003\u60c5\u5831\nphut\u306a\u3069\u3001\u5225\u30e2\u30b8\u30e5\u30fc\u30eb\u3067\u30a8\u30e9\u30fc\u304c\u8d77\u304d\u308b\u3068\u3001.pid\u304c\u6b8b\u3063\u305f\u308a\u3059\u308b\u306e\u3067\u3001\n\n\u4f59\u8a08\u306a\u30d5\u30a1\u30a4\u30eb\u3092\u6d88\u3059\n\n$ rm -v /tmp/HelloTrema.*\nremoved `/tmp/HelloTrema.log'\nremoved `/tmp/HelloTrema.pid'\n\n\n\u30b9\u30a4\u30c3\u30c1\u3092\u6d88\u3059(*.conf\u306b\u66f8\u3044\u3066\u3042\u308bdatapath_id\u3092\u53c2\u7167)\n\n$ sudo ovs-vsctl del-br br0xabc\n\n\n\u307e\u305f\u30ed\u30b0\u3092\u898b\u308b(.rb\u306b\u66f8\u3044\u305f\u30b3\u30f3\u30c8\u30ed\u30fc\u30e9\u540d\u3092\u53c2\u7167(class HelloTrema < Trema::Controller))\u306e\u3082\u826f\u3044\n\n$ less /tmp/HelloTrema.log\n\n\n\u203b 2015/09\u306b\u4fee\u6b63\n\n## RPi2\u306e\u6761\u4ef6\n\n- \u30e6\u30fc\u30b6\n\n```shell-session\n$ whoami\npi\n```\n\n- \u5b9f\u884c\u3057\u305f\u30a2\u30c3\u30d7\u30c7\u30fc\u30c8\n\n```shell-session:\n$ sudo apt-get -y update && sudo apt-get -y upgrade\n$ sudo rpi-update\n```\n\n- \u74b0\u5883\n\n```shell-session\n$ cat /etc/debian_version\n7.8\n\n$ uname -a\nLinux raspberrypi 4.1.6-v7+ #810 SMP PREEMPT Tue Aug 18 15:32:12 BST 2015 armv7l GNU/Linux\n\n$ which ruby\n/home/pi/.rbenv/shims/ruby\n\n$ ruby -v\nruby 2.2.3p173 (2015-08-18 revision 51636) [armv7l-linux-eabihf]\n\n$ gem -v\n2.4.5.1\n```\n\n\n## Trema\u306e\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\n\n```shell-session:\n$ gem install trema -V\n```\n\n- \u30c1\u30a7\u30c3\u30af\n\n```shell-session:\n$ trema --version\ntrema version 0.6.0\n\n$ gem which trema\n/home/pi/.rbenv/versions/2.2.3/lib/ruby/gems/2.2.0/gems/trema-0.6.0/lib/trema.rb\n```\n\n## Open vSwitch\u306e\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7(\u30bd\u30fc\u30b9\u304b\u3089)\n- \u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\n\n```shell-session:\n$ wget http://openvswitch.org/releases/openvswitch-2.4.0.tar.gz\n```\n\n- \u89e3\u51cd\n\n```shell-session:\n$ tar xzf openvswitch-2.4.0.tar.gz\n```\n\n- \u30d3\u30eb\u30c9(\u89e3\u51cd\u3055\u308c\u305f\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306eINSTALL.Debian\u3092\u898b\u306a\u304c\u3089)\n\n```shell-session:\n$ sudo apt-get -y install build-essential fakeroot\n$ cd openvswitch-2.4.0 && dpkg-checkbuilddeps\n$ sudo apt-get install [\u51fa\u529b\u3055\u308c\u305f\u30d1\u30c3\u30b1\u30fc\u30b8]\n$ # .deb \u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u308b(test\u304c\u6709\u52b9\u3060\u3068\u6642\u9593\u304c\u304b\u304b\u308b\u306e\u3067\u3084\u3081\u305f)\n$ DEB_BUILD_OPTIONS='nocheck' fakeroot debian/rules binary\n```\n\n- \u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n```shell-session:\n$ dpkg -l | grep openvswitch # \u3067\u51fa\u3066\u304d\u305f\u3082\u306e\u3092\u6d88\u3059\n$ sudo apt-get purge openvswitch-switch\n$ sudo apt-get purge openvswitch-common\n\n$ # \u4ee5\u4e0b1\u3067dkms\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u308d\u3068\u8a00\u308f\u308c\u3066\u3057\u305f\u304c\u3001\n$ sudo apt-get install dkms\n\n$ # \u3053\u306e\u3088\u3046\u306b\u30a8\u30e9\u30fc\u304c\u51fa\u308b\u3002\n$ # Your kernel headers for kernel 4.1.6-v7+ cannot be found at\n$ # /lib/modules/4.1.6-v7+/build or /lib/modules/4.1.6-v7+/source.\n$ # [apt-cache search linux-headers-$(uname -r)] \u3067\u898b\u3064\u304b\u3089\u306a\u3044\u306e\u3067\u3053\u306e\u307e\u307e\u9032\u3080\n\n$ # 1\n$ sudo dpkg -i openvswitch-datapath-dkms_2.4.0-1_all.deb\n\n$ sudo dpkg -i openvswitch-common_2.4.0-1_armhf.deb\n$ sudo dpkg -i openvswitch-switch_2.4.0-1_armhf.deb\n```\n\n- \u30b9\u30bf\u30fc\u30c8\n\n```shell-session:\n$ sudo service openvswitch-switch start\novsdb-server is already running.\novs-vswitchd is already running.\nEnabling remote OVSDB managers.\n```\n\n## Hello Trema\n### raspbian\u3067IPv6\u3092\u6709\u52b9\u306b\u3059\u308b(\u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u7121\u52b9\u306b\u306a\u3063\u3066\u3044\u308b)\u3002\n- \u307e\u305a\u3001IPv6\u3092\u6709\u52b9\u306b\n  * \u4eca\u3059\u3050\n\n  ```shell-session:\n  $ sudo modprobe ipv6\n  ```\n\n  * \u305d\u3057\u3066\u3053\u308c\u304b\u3089\u3082(boot\u6642\u306benable)\n\n  ```shell-session:\n  $ echo ipv6 | sudo tee -a /etc/modules\n  ```\n\n- \u7406\u7531\u306f\u3001\u3042\u3089\u304b\u3058\u3081IPv6\u304c\u6709\u52b9\u3067\u306a\u3044\u3068\u4e0b\u8a18\u3067\u30a8\u30e9\u30fc(No such file ...)\u306b\u306a\u308b\u304b\u3089\u3002\n\n```ruby:\n  sh \"sudo /sbin/sysctl -w net.ipv6.conf.#{bridge_name}.disable_ipv6=1 -q\"\n```\n\n- \u53c2\u8003\n\t- https://www.raspbian.org/RaspbianFAQ#How_do_I_enable_or_use_IPv6.3F\n\n### Hello! (yay! :smile:)\n\n\n```shell-session:\n$ git clone https://github.com/trema/hello_trema.git\n$ cd hello_trema\n$ trema run lib/hello_trema.rb -c trema.conf\n[sudo] password for pi:\nTrema started.\nHello 0xabc!\n\n$ bundle install --binstubs\n$ bundle exec ./bin/trema run ./lib/hello_trema.\n[sudo] password for pi:\nTrema started.\nHello 0xabc!\n```\n\n----\n\n### \u30a8\u30e9\u30fc\u3067\u9014\u4e2d\u7d42\u4e86\u3057\u305f\u5834\u5408\u306a\u3069\u306e\u53c2\u8003\u60c5\u5831\n\n`phut`\u306a\u3069\u3001\u5225\u30e2\u30b8\u30e5\u30fc\u30eb\u3067\u30a8\u30e9\u30fc\u304c\u8d77\u304d\u308b\u3068\u3001`.pid`\u304c\u6b8b\u3063\u305f\u308a\u3059\u308b\u306e\u3067\u3001\n\n- \u4f59\u8a08\u306a\u30d5\u30a1\u30a4\u30eb\u3092\u6d88\u3059\n\n```shell-session:\n$ rm -v /tmp/HelloTrema.*\nremoved `/tmp/HelloTrema.log'\nremoved `/tmp/HelloTrema.pid'\n```\n\n- \u30b9\u30a4\u30c3\u30c1\u3092\u6d88\u3059(`*.conf`\u306b\u66f8\u3044\u3066\u3042\u308b`datapath_id`\u3092\u53c2\u7167)\n\n```shell-session:\n$ sudo ovs-vsctl del-br br0xabc\n```\n\n- \u307e\u305f\u30ed\u30b0\u3092\u898b\u308b(`.rb`\u306b\u66f8\u3044\u305f\u30b3\u30f3\u30c8\u30ed\u30fc\u30e9\u540d\u3092\u53c2\u7167(`class HelloTrema < Trema::Controller`))\u306e\u3082\u826f\u3044\n\n```shell-session:\n$ less /tmp/HelloTrema.log\n```\n\n", "tags": ["OpenFlow", "RaspberryPi", "trema", "OpenVSwitch"]}