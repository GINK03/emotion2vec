{"tags": ["F#", "PowerShell"], "context": " More than 1 year has passed since last update.\u307e\u305a\u306f\u53c2\u7167\u8a2d\u5b9a\u3002\nSystem.Management.Automation.dll \u306fGAC\u304b\u3089\u3002\nSystem.Configuration.Install \u306fVisual Studio \u306e\u53c2\u7167\u30de\u30cd\u30fc\u30b8\u30e3\u306e\u30d5\u30ec\u30fc\u30e0\u30ef\u30fc\u30af\u306b\u3042\u308b\u3082\u306e\u3002\n\u305d\u3057\u3066\u3053\u3093\u306a\u30b3\u30fc\u30c9\u3092\u66f8\u3044\u3066\u307f\u305f\u3002\nopen System\nopen System.ComponentModel\nopen System.IO\nopen System.Management.Automation\n\ntype SpecifiedLinesData(data) =\n    member val Data = Some(data) with get \n\n[<Cmdlet(VerbsCommon.Select, \"SpecifiedLines\", SupportsShouldProcess=true)>]\ntype SelectSpecifiedLinesCommand() =\n    inherit PSCmdlet()\n\n    let inputLines data file =\n        match data with\n        | Some(x) -> x\n        | None ->\n            use r = \n                if String.IsNullOrEmpty(file)\n                then Console.In\n                else new StreamReader(file) :> TextReader\n            seq {\n                while r.Peek()>= 0 do\n                    yield r.ReadLine()\n            }\n            |> Seq.toList :> seq<string>\n\n    let outputLines data file =\n        use w = \n            if String.IsNullOrEmpty(file)\n            then Console.Out\n            else new StreamWriter(file) :> TextWriter\n\n        for s : string in data do\n            w.WriteLine(s)\n\n    [<Parameter>]\n    member val InFile = \"\" with get, set\n    [<Parameter>]\n    member val OutFile = \"\" with get, set\n    [<Parameter(DontShow=true, ValueFromPipelineByPropertyName=true)>]\n    member val Data = None with get, set\n    [<Parameter(Mandatory=true)>]\n    member val MaxLineLength = 0 with get, set\n\n    override this.ProcessRecord() =\n        let d =\n            inputLines this.Data this.InFile\n            |> Seq.filter (fun x -> x.Length <= this.MaxLineLength)\n\n        outputLines d this.OutFile\n\n        base.WriteObject(new SpecifiedLinesData(d))\n\n[<RunInstaller(true)>]\ntype SelectSpecifiedLinesCmdlets() =\n    inherit PSSnapIn()\n    override val Name = \"SelectSpecifiedLinesCmdlets\" with get\n    override val Vendor = \"minfuk\" with get\n    override val Description = \"Select SpecifiedLines Cmdlets\" with get\n\n\u30af\u30e9\u30b9\u30e9\u30a4\u30d6\u30e9\u30ea\u3068\u3057\u3066\u30d3\u30eb\u30c9\u3057\u3066\u3067\u304d\u305f.dll\u3092PowerShell\u306b\u767b\u9332\u3002\nF#\u3060\u304b\u3089\u3068\u8a00\u3063\u3066\u7279\u5225\u306b\u5fc5\u8981\u306a\u624b\u9806\u3082\u306a\u304f\u3001\u666e\u901a\u306b\u767b\u9332\u3059\u308b\u624b\u9806(installutil \u306e\u5f8c\u306bPowerShell\u4e0a\u3067Add-PSSnapIn)\u3067OK\u3067\u3057\u305f\u3002 \n\u3067\u6b21\u306e\u3088\u3046\u306a sample.txt \u3092\u4f5c\u3063\u3066\u3001\n\nsample.txt\n7aaaaaa\n8bbbbbbb\n2c\n4ddd\n9eeeeeeee\n5ffff\n3gg\n6hhhhh\n1\n\n\n\u3053\u3093\u306a\u611f\u3058\u3067\u5b9f\u884c\u3002\nSelect-SpecifiedLines -InFile {sample.txt\u306e\u30d5\u30eb\u30d1\u30b9} -MaxLineLength 7\n\n\u3059\u308b\u3068\u7d50\u679c\u306f\u3001\n7aaaaaa\n2c\n4ddd\n5ffff\n3gg\n6hhhhh\n1\n\nData\n----\nSome(Microsoft.FSharp.Core.CompilerServices.RuntimeHelpers+mkSeq@550[System.String])\n\n-MaxLineLength \u306b\u6307\u5b9a\u3057\u305f7\u6587\u5b57\u4ee5\u4e0b\u306e\u9577\u3055\u306e\u884c\u3060\u3051\u62bd\u51fa\u3067\u304d\u305f\u3002\n\u3055\u3089\u306b\u6b21\u306e\u3088\u3046\u306b\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u3067\u3064\u306a\u3052\u3066\u307f\u308b\u3068\u3001\nSelect-SpecifiedLines -InFile {sample.txt\u306e\u30d5\u30eb\u30d1\u30b9} -MaxLineLength 7 | Select-SpecifiedLines -MaxLineLength 4\n\n\u7d50\u679c\u306f\u3001\n7aaaaaa\n2c\n4ddd\n5ffff\n3gg\n6hhhhh\n1\n2c\n4ddd\n3gg\n1\n\nData\n----\nSome(Microsoft.FSharp.Core.CompilerServices.RuntimeHelpers+mkSeq@550[System.String])\n\n-MaxLineLength \u306b\u6307\u5b9a\u3057\u305f7\u6587\u5b57\u4ee5\u4e0b\u306e\u9577\u3055\u306e\u884c\u3060\u3051\u62bd\u51fa\u3057\u305f\u5f8c\u3067\u3001\u305d\u306e\u6b21\u306b-MaxLineLength \u306b\u6307\u5b9a\u3057\u305f4\u6587\u5b57\u4ee5\u4e0b\u306e\u9577\u3055\u306e\u884c\u3060\u3051\u62bd\u51fa\u3067\u304d\u305f\u3002\n\u307e\u305a\u306f\u53c2\u7167\u8a2d\u5b9a\u3002\nSystem.Management.Automation.dll \u306fGAC\u304b\u3089\u3002\nSystem.Configuration.Install \u306fVisual Studio \u306e\u53c2\u7167\u30de\u30cd\u30fc\u30b8\u30e3\u306e\u30d5\u30ec\u30fc\u30e0\u30ef\u30fc\u30af\u306b\u3042\u308b\u3082\u306e\u3002\n\n\u305d\u3057\u3066\u3053\u3093\u306a\u30b3\u30fc\u30c9\u3092\u66f8\u3044\u3066\u307f\u305f\u3002\n\n```fsharp\nopen System\nopen System.ComponentModel\nopen System.IO\nopen System.Management.Automation\n\ntype SpecifiedLinesData(data) =\n    member val Data = Some(data) with get \n\n[<Cmdlet(VerbsCommon.Select, \"SpecifiedLines\", SupportsShouldProcess=true)>]\ntype SelectSpecifiedLinesCommand() =\n    inherit PSCmdlet()\n\n    let inputLines data file =\n        match data with\n        | Some(x) -> x\n        | None ->\n            use r = \n                if String.IsNullOrEmpty(file)\n                then Console.In\n                else new StreamReader(file) :> TextReader\n            seq {\n                while r.Peek()>= 0 do\n                    yield r.ReadLine()\n            }\n            |> Seq.toList :> seq<string>\n\n    let outputLines data file =\n        use w = \n            if String.IsNullOrEmpty(file)\n            then Console.Out\n            else new StreamWriter(file) :> TextWriter\n        \n        for s : string in data do\n            w.WriteLine(s)\n\n    [<Parameter>]\n    member val InFile = \"\" with get, set\n    [<Parameter>]\n    member val OutFile = \"\" with get, set\n    [<Parameter(DontShow=true, ValueFromPipelineByPropertyName=true)>]\n    member val Data = None with get, set\n    [<Parameter(Mandatory=true)>]\n    member val MaxLineLength = 0 with get, set\n\n    override this.ProcessRecord() =\n        let d =\n            inputLines this.Data this.InFile\n            |> Seq.filter (fun x -> x.Length <= this.MaxLineLength)\n        \n        outputLines d this.OutFile\n\n        base.WriteObject(new SpecifiedLinesData(d))\n\n[<RunInstaller(true)>]\ntype SelectSpecifiedLinesCmdlets() =\n    inherit PSSnapIn()\n    override val Name = \"SelectSpecifiedLinesCmdlets\" with get\n    override val Vendor = \"minfuk\" with get\n    override val Description = \"Select SpecifiedLines Cmdlets\" with get\n```\n\n\u30af\u30e9\u30b9\u30e9\u30a4\u30d6\u30e9\u30ea\u3068\u3057\u3066\u30d3\u30eb\u30c9\u3057\u3066\u3067\u304d\u305f.dll\u3092PowerShell\u306b\u767b\u9332\u3002\nF#\u3060\u304b\u3089\u3068\u8a00\u3063\u3066\u7279\u5225\u306b\u5fc5\u8981\u306a\u624b\u9806\u3082\u306a\u304f\u3001\u666e\u901a\u306b\u767b\u9332\u3059\u308b\u624b\u9806(installutil \u306e\u5f8c\u306bPowerShell\u4e0a\u3067Add-PSSnapIn)\u3067OK\u3067\u3057\u305f\u3002 \n\n\u3067\u6b21\u306e\u3088\u3046\u306a sample.txt \u3092\u4f5c\u3063\u3066\u3001\n\n```text:sample.txt\n7aaaaaa\n8bbbbbbb\n2c\n4ddd\n9eeeeeeee\n5ffff\n3gg\n6hhhhh\n1\n```\n\n\u3053\u3093\u306a\u611f\u3058\u3067\u5b9f\u884c\u3002\n\n```text\nSelect-SpecifiedLines -InFile {sample.txt\u306e\u30d5\u30eb\u30d1\u30b9} -MaxLineLength 7\n```\n\n\u3059\u308b\u3068\u7d50\u679c\u306f\u3001\n\n```text\n7aaaaaa\n2c\n4ddd\n5ffff\n3gg\n6hhhhh\n1\n\nData\n----\nSome(Microsoft.FSharp.Core.CompilerServices.RuntimeHelpers+mkSeq@550[System.String])\n```\n\n-MaxLineLength \u306b\u6307\u5b9a\u3057\u305f7\u6587\u5b57\u4ee5\u4e0b\u306e\u9577\u3055\u306e\u884c\u3060\u3051\u62bd\u51fa\u3067\u304d\u305f\u3002\n\n\u3055\u3089\u306b\u6b21\u306e\u3088\u3046\u306b\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u3067\u3064\u306a\u3052\u3066\u307f\u308b\u3068\u3001\n\n```text\nSelect-SpecifiedLines -InFile {sample.txt\u306e\u30d5\u30eb\u30d1\u30b9} -MaxLineLength 7 | Select-SpecifiedLines -MaxLineLength 4\n```\n\n\u7d50\u679c\u306f\u3001\n\n```text\n7aaaaaa\n2c\n4ddd\n5ffff\n3gg\n6hhhhh\n1\n2c\n4ddd\n3gg\n1\n\nData\n----\nSome(Microsoft.FSharp.Core.CompilerServices.RuntimeHelpers+mkSeq@550[System.String])\n```\n\n-MaxLineLength \u306b\u6307\u5b9a\u3057\u305f7\u6587\u5b57\u4ee5\u4e0b\u306e\u9577\u3055\u306e\u884c\u3060\u3051\u62bd\u51fa\u3057\u305f\u5f8c\u3067\u3001\u305d\u306e\u6b21\u306b-MaxLineLength \u306b\u6307\u5b9a\u3057\u305f4\u6587\u5b57\u4ee5\u4e0b\u306e\u9577\u3055\u306e\u884c\u3060\u3051\u62bd\u51fa\u3067\u304d\u305f\u3002\n"}