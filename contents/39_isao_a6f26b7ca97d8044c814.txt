{"context": " More than 1 year has passed since last update.\nofApp.h\n#pragma once\n\n#include \"ofMain.h\"\n#include \"ofxOpenCv.h\"\n\nclass ofApp : public ofBaseApp{\n\n    public:\n        void setup();\n        void update();\n        void draw();\n\n        void keyPressed(int key);\n        void keyReleased(int key);\n        void mouseMoved(int x, int y );\n        void mouseDragged(int x, int y, int button);\n        void mousePressed(int x, int y, int button);\n        void mouseReleased(int x, int y, int button);\n        void windowResized(int w, int h);\n        void dragEvent(ofDragInfo dragInfo);\n        void gotMessage(ofMessage msg);\n\n    ofVideoGrabber videoGrabber; // \u30d3\u30c7\u30aa\u5165\u529b\n    ofxCvColorImage colorImg; // openCv\u3067\u6271\u3046\u30a4\u30e1\u30fc\u30b8\n    ofxCvGrayscaleImage grayImage; // openCv\u3067\u6271\u3046\u30b0\u30ec\u30fc\u30b9\u30b1\u30fc\u30eb\u30a4\u30e1\u30fc\u30b8\n    ofxCvGrayscaleImage grayBg; // \u80cc\u666f\u306e\u30b0\u30ec\u30fc\u30b9\u30b1\u30fc\u30eb\n    ofxCvGrayscaleImage grayDiff; // \u80cc\u666f\u3068\u5dee\u5206\n    ofxCvContourFinder conntourFinder; // \u8f2a\u90ed\u62bd\u51fa\u306e\u305f\u3081\u306e\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\n\n    bool bLearnBackground; // \u80cc\u666f\u8a18\u9332\u30e2\u30fc\u30c9\u304b\u3069\u3046\u304b\n    int treshold; // \u60b6\u5024     \n};\n\n\n\nofApp.cpp\n#include \"ofApp.h\"\n\n//--------------------------------------------------------------\nvoid ofApp::setup(){\n\n    ofBackground(0, 0, 0);\n\n    // 360 * 240 \u3067\u30d3\u30c7\u30aa\u53d6\u308a\u8fbc\u307f\u521d\u671f\u5316\n    videoGrabber.initGrabber(320, 240);\n\n    // openCv\u3067\u89e3\u6790\u3059\u308b\u9818\u57df\u78ba\u4fdd\n    colorImg.allocate(320, 240);\n\n    // \u30b0\u30ec\u30fc\u30b9\u30b1\u30fc\u30eb\n    grayImage.allocate(320, 240);\n\n    //\u80cc\u666f\u753b\u50cf\n    grayBg.allocate(320, 240);\n\n    // \u80cc\u666f\u3068\u306e\u5dee\u5206\n    grayDiff.allocate(320, 240);\n\n    bLearnBackground = true;\n\n    treshold = 100;\n\n}\n\n//--------------------------------------------------------------\nvoid ofApp::update(){\n\n    videoGrabber.update();\n\n\n    if(videoGrabber.isFrameNew()){\n\n        // OpenCV\u3067\u89e3\u6790\u3059\u308b\u30ab\u30e9\u30fc\u753b\u50cf\u9818\u57df\u306b\u53d6\u5f97\u3057\u305f\u6620\u50cf\u3092\u683c\u7d0d\n        colorImg.setFromPixels(videoGrabber.getPixels(), 320, 240);\n\n        // \u753b\u50cf\u3092\u30b0\u30ec\u30fc\u30b9\u30b1\u30fc\u30eb\u306b\u5909\u63db\n        grayImage = colorImg;\n\n        if(bLearnBackground){\n\n            // \u30b0\u30ec\u30fc\u30b9\u30b1\u30fc\u30eb\u30a4\u30e1\u30fc\u30b8\u8a18\u9332\n            grayBg = grayImage;\n            // \u8a18\u9332\u3057\u306a\u3044\u30e2\u30fc\u30c9\u306b\n            bLearnBackground = false;\n        }\n\n        // \u80cc\u666f\u753b\u50cf\u3068\u73fe\u5728\u306e\u753b\u50cf\u306e\u5dee\u5206\u306e\u7d76\u5bfe\u5024\u3092\u53d6\u5f97\n        grayDiff.absDiff(grayBg, grayImage);\n\n        // \u5dee\u5206\u753b\u50cf\u3092\u8a2d\u5b9a\u3057\u305f\u60b6\u5024\u3092\u5883\u306b\u4e8c\u5024\u5316\n        grayDiff.threshold(treshold);\n\n        // \u4e8c\u5024\u5316\u3057\u305f\u5dee\u5206\u753b\u50cf\u304b\u3089\u3001\u8f2a\u90ed\u62bd\u51fa\n        // findContours(\u5206\u6790\u3059\u308b\u753b\u50cf:ofxCvGrayscaleImage, \u6700\u5c0f\u30a8\u30ea\u30a2, \u6700\u5927\u30a8\u30ea\u30a2, \u8a8d\u8b58\u3059\u308b\u7269\u4f53\u306e\u6570, \u7a74\u3092\u691c\u51fa\u3059\u308b\u304b);\n        conntourFinder.findContours(grayDiff, 20, (340*240)/3, 10, true);\n    }\n\n\n\n}\n\n//--------------------------------------------------------------\nvoid ofApp::draw(){\n\n    // \u53d6\u308a\u8fbc\u3093\u3060\u753b\u50cf\u3092\u8868\u793a\n    colorImg.draw(0, 0);\n\n    // \u30b0\u30ec\u30fc\u30b9\u30b1\u30fc\u30eb\u753b\u50cf\n    grayImage.draw(340, 10);\n\n    // \u80cc\u666f\u753b\u50cf\u3092\u8868\u793a\n    grayBg.draw(10, 260);\n\n    // \u5dee\u5206\u8868\u793a\n    grayDiff.draw(340, 260);\n\n    // \u8f2a\u90ed\u7dda\u8868\u793a\n    conntourFinder.draw(340, 500);\n\n}\n\n//--------------------------------------------------------------\nvoid ofApp::keyPressed(int key){\n\n    switch (key) {\n        case ' ':\n            bLearnBackground = true;\n            break;\n        case '+':\n            treshold ++;\n            if(treshold > 255){\n                treshold = 255;\n            }\n            break;\n        case '-':\n            treshold --;\n            if(treshold < 0){\n                treshold = 0;\n            }\n            break;\n        default:\n            break;\n    }\n\n}\n\n\n```cpp:ofApp.h\n#pragma once\n\n#include \"ofMain.h\"\n#include \"ofxOpenCv.h\"\n\nclass ofApp : public ofBaseApp{\n\n\tpublic:\n\t\tvoid setup();\n\t\tvoid update();\n\t\tvoid draw();\n\n\t\tvoid keyPressed(int key);\n\t\tvoid keyReleased(int key);\n\t\tvoid mouseMoved(int x, int y );\n\t\tvoid mouseDragged(int x, int y, int button);\n\t\tvoid mousePressed(int x, int y, int button);\n\t\tvoid mouseReleased(int x, int y, int button);\n\t\tvoid windowResized(int w, int h);\n\t\tvoid dragEvent(ofDragInfo dragInfo);\n\t\tvoid gotMessage(ofMessage msg);\n    \n    ofVideoGrabber videoGrabber; // \u30d3\u30c7\u30aa\u5165\u529b\n    ofxCvColorImage colorImg; // openCv\u3067\u6271\u3046\u30a4\u30e1\u30fc\u30b8\n    ofxCvGrayscaleImage grayImage; // openCv\u3067\u6271\u3046\u30b0\u30ec\u30fc\u30b9\u30b1\u30fc\u30eb\u30a4\u30e1\u30fc\u30b8\n    ofxCvGrayscaleImage grayBg; // \u80cc\u666f\u306e\u30b0\u30ec\u30fc\u30b9\u30b1\u30fc\u30eb\n    ofxCvGrayscaleImage grayDiff; // \u80cc\u666f\u3068\u5dee\u5206\n    ofxCvContourFinder conntourFinder; // \u8f2a\u90ed\u62bd\u51fa\u306e\u305f\u3081\u306e\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\n    \n    bool bLearnBackground; // \u80cc\u666f\u8a18\u9332\u30e2\u30fc\u30c9\u304b\u3069\u3046\u304b\n    int treshold; // \u60b6\u5024\t\t\n};\n```\n\n\n\n```cpp:ofApp.cpp\n#include \"ofApp.h\"\n\n//--------------------------------------------------------------\nvoid ofApp::setup(){\n    \n    ofBackground(0, 0, 0);\n    \n    // 360 * 240 \u3067\u30d3\u30c7\u30aa\u53d6\u308a\u8fbc\u307f\u521d\u671f\u5316\n    videoGrabber.initGrabber(320, 240);\n    \n    // openCv\u3067\u89e3\u6790\u3059\u308b\u9818\u57df\u78ba\u4fdd\n    colorImg.allocate(320, 240);\n    \n    // \u30b0\u30ec\u30fc\u30b9\u30b1\u30fc\u30eb\n    grayImage.allocate(320, 240);\n    \n    //\u80cc\u666f\u753b\u50cf\n    grayBg.allocate(320, 240);\n    \n    // \u80cc\u666f\u3068\u306e\u5dee\u5206\n    grayDiff.allocate(320, 240);\n    \n    bLearnBackground = true;\n    \n    treshold = 100;\n\n}\n\n//--------------------------------------------------------------\nvoid ofApp::update(){\n    \n    videoGrabber.update();\n    \n    \n    if(videoGrabber.isFrameNew()){\n        \n        // OpenCV\u3067\u89e3\u6790\u3059\u308b\u30ab\u30e9\u30fc\u753b\u50cf\u9818\u57df\u306b\u53d6\u5f97\u3057\u305f\u6620\u50cf\u3092\u683c\u7d0d\n        colorImg.setFromPixels(videoGrabber.getPixels(), 320, 240);\n        \n        // \u753b\u50cf\u3092\u30b0\u30ec\u30fc\u30b9\u30b1\u30fc\u30eb\u306b\u5909\u63db\n        grayImage = colorImg;\n        \n        if(bLearnBackground){\n            \n            // \u30b0\u30ec\u30fc\u30b9\u30b1\u30fc\u30eb\u30a4\u30e1\u30fc\u30b8\u8a18\u9332\n            grayBg = grayImage;\n            // \u8a18\u9332\u3057\u306a\u3044\u30e2\u30fc\u30c9\u306b\n            bLearnBackground = false;\n        }\n        \n        // \u80cc\u666f\u753b\u50cf\u3068\u73fe\u5728\u306e\u753b\u50cf\u306e\u5dee\u5206\u306e\u7d76\u5bfe\u5024\u3092\u53d6\u5f97\n        grayDiff.absDiff(grayBg, grayImage);\n        \n        // \u5dee\u5206\u753b\u50cf\u3092\u8a2d\u5b9a\u3057\u305f\u60b6\u5024\u3092\u5883\u306b\u4e8c\u5024\u5316\n        grayDiff.threshold(treshold);\n        \n        // \u4e8c\u5024\u5316\u3057\u305f\u5dee\u5206\u753b\u50cf\u304b\u3089\u3001\u8f2a\u90ed\u62bd\u51fa\n        // findContours(\u5206\u6790\u3059\u308b\u753b\u50cf:ofxCvGrayscaleImage, \u6700\u5c0f\u30a8\u30ea\u30a2, \u6700\u5927\u30a8\u30ea\u30a2, \u8a8d\u8b58\u3059\u308b\u7269\u4f53\u306e\u6570, \u7a74\u3092\u691c\u51fa\u3059\u308b\u304b);\n        conntourFinder.findContours(grayDiff, 20, (340*240)/3, 10, true);\n    }\n    \n    \n\n}\n\n//--------------------------------------------------------------\nvoid ofApp::draw(){\n    \n    // \u53d6\u308a\u8fbc\u3093\u3060\u753b\u50cf\u3092\u8868\u793a\n    colorImg.draw(0, 0);\n    \n    // \u30b0\u30ec\u30fc\u30b9\u30b1\u30fc\u30eb\u753b\u50cf\n    grayImage.draw(340, 10);\n    \n    // \u80cc\u666f\u753b\u50cf\u3092\u8868\u793a\n    grayBg.draw(10, 260);\n    \n    // \u5dee\u5206\u8868\u793a\n    grayDiff.draw(340, 260);\n    \n    // \u8f2a\u90ed\u7dda\u8868\u793a\n    conntourFinder.draw(340, 500);\n\n}\n\n//--------------------------------------------------------------\nvoid ofApp::keyPressed(int key){\n    \n    switch (key) {\n        case ' ':\n            bLearnBackground = true;\n            break;\n        case '+':\n            treshold ++;\n            if(treshold > 255){\n                treshold = 255;\n            }\n            break;\n        case '-':\n            treshold --;\n            if(treshold < 0){\n                treshold = 0;\n            }\n            break;\n        default:\n            break;\n    }\n    \n}\n```\n", "tags": ["openFrameworks"]}