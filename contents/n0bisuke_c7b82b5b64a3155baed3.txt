{"tags": ["api", "chatwork", "Express", "Node.js"], "context": " More than 1 year has passed since last update.\u3084\u3063\u3068\u5229\u7528\u7533\u8acb\u3057\u3066\u3044\u305f\u30c1\u30e3\u30c3\u30c8\u30ef\u30fc\u30afAPI\u306e\u5229\u7528\u8a31\u53ef\u304c\u304a\u308a\u307e\u3057\u305f!!\n\u306e\u3067\u3001\u5b9f\u969b\u306b\u4f7f\u3063\u3066\u307f\u307e\u3059\u3002\n\n\u30c1\u30e3\u30c3\u30c8\u30ef\u30fc\u30afAPI\n\u3053\u306eAPI\u306f\u81ea\u5206\u53f2\u4e0a\u521d\u3081\u3066\u306e\u30bf\u30a4\u30d7\u3067header\u306btoken\u3092\u30bb\u30c3\u30c8\u3057\u3066\u9001\u4fe1\u3059\u308b\u3053\u3068\u3067GET\u3084POST\u3067\u5024\u3092\u53d6\u308c\u307e\u3059\u3002\n\n\u30b5\u30f3\u30d7\u30eb\u30ea\u30af\u30a8\u30b9\u30c8\n\u30b5\u30f3\u30d7\u30eb\u30ea\u30af\u30a8\u30b9\u30c8\u306ecurl\u30b3\u30de\u30f3\u30c9\u306b -H\u30aa\u30d7\u30b7\u30e7\u30f3\u3067\u30d8\u30c3\u30c0\u30fc\u60c5\u5831\u3092\u9001\u3063\u3066\u3044\u308b\u306e\u304c\u5206\u304b\u308a\u307e\u3059\u3002\n$ curl -X GET -H \"X-ChatWorkToken: YOUR API KEY\" \"https://api.chatwork.com/v1/rooms\"\n\n\"X-ChatWorkToken: YOUR API KEY\"\u3068\u3044\u3046\u5f62\u3067API KEY\u3092\u6e21\u3057\u307e\u3059\u3002\n\nnode.js\u304b\u3089\u63a5\u7d9a\u3057\u305f\u3089connect ECONNREFUSED\u3063\u3066\u30a8\u30e9\u30fc\nhttp.request()\u3084http.get()\u3067\u4e0a\u624b\u304f\u63a5\u7d9a\u51fa\u6765\u307e\u305b\u3093\u3067\u3057\u305f\u6c57\n\u3053\u306e\u30a8\u30e9\u30fc\u304c\u51fa\u3066\u305f\u3093\u3067\u3059\u3051\u3069\u3001\u30a4\u30de\u30a4\u30c1\u5206\u304b\u3089\u305a...\u30a8\u30e2\u3044\u4eba\u6559\u3048\u3066\u4e0b\u3055\u3044\u6c57\n\u53c2\u8003: Node.js v0.10.29 Manual & Documentation\n\u53c2\u8003: Node.js Error: connect ECONNREFUSED when using http.request - Stack Overflow\n\nexpress\u3067\u30da\u30fc\u30b8\u30a2\u30af\u30bb\u30b9\u3057\u305f\u969b\u306b\u30c1\u30e3\u30c3\u30c8\u4e00\u89a7\u3092\u8868\u793a\n\nrequest\u30e2\u30b8\u30e5\u30fc\u30eb\u3067\u3068\u308a\u3042\u3048\u305a\u89e3\u6c7a\n\u30c7\u30d5\u30a9\u30eb\u30c8\u306eHTTP\u30e2\u30b8\u30e5\u30fc\u30eb\u3060\u3068\u4e0a\u624b\u304f\u3044\u304b\u306a\u304b\u3063\u305f\u306e\u3068\u3001\nNode.js\u306echatwork\u63a5\u7d9a\u7528\u306e\u30e2\u30b8\u30e5\u30fc\u30eb\u306e\u5185\u90e8\u3067request\u30e2\u30b8\u30e5\u30fc\u30eb\u3092\u5229\u7528\u3057\u3066\u3044\u305f\u3053\u3068\u304b\u3089\u3001request\u30e2\u30b8\u30e5\u30fc\u30eb\u3092\u4f7f\u3063\u3066\u8a66\u3057\u305f\u3089\u4e0a\u624b\u304f\u3044\u304d\u307e\u3057\u305f\u3002\n$ express -e chatwork\n$ cd chatwork\n$ npm install\n$ npm install request\n\n\nroutes/index.js\nvar express = require('express');\nvar router = express.Router();\nvar request = require('request');\n\nrouter.get('/', function(req, res){\n    var options = {\n        url: 'https://api.chatwork.com/v1/rooms',\n        headers: {\n            'X-ChatWorkToken': 'YOUR API KEY'\n        },\n        json: true\n    };\n\n    request.get(options, function (error, response, body) {\n        if (!error && response.statusCode == 200) {\n\n            console.log(body[0]);\n            res.render('index', {data:body});\n        }else{\n            console.log('error: '+ response.statusCode);\n        }\n    });\n});\n\nmodule.exports = router;\n\n\n\u4eca\u56de\u306f\u30c1\u30e3\u30c3\u30c8\u30eb\u30fc\u30e0\u540d\u3068\u30c1\u30e3\u30c3\u30c8\u30eb\u30fc\u30e0\u306eicon\u753b\u50cf\u3092\u8868\u793a\u3055\u305b\u307e\u3059\u3002\n\nindex.ejs\n<!DOCTYPE html>\n<html>\n  <head>\n    <title>get\u3066\u3059\u3068</title>\n    <link rel='stylesheet' href='/stylesheets/style.css' />\n  </head>\n  <body>\n    <ul>\n    <% data.forEach(function(val){ %>\n        <li><%/*= val.room_id*/ %></li>\n        <li><%= val.name %></li>\n        <img src=\"<%= val.icon_path %>\" alt=\"\">\n        <br />\n    <% }) %>\n  </ul>\n  </body>\n</html>\n\n\nlocalhost:3000\u306b\u30a2\u30af\u30bb\u30b9\u3059\u308b\u3068\n\n\u3053\u3093\u306a\u611f\u3058\u3067\u30ea\u30b9\u30c8\u304c\u8868\u793a\u3055\u308c\u307e\u3057\u305f! \u3081\u3067\u305f\u3057!\n\u53c2\u8003: Request\u30e2\u30b8\u30e5\u30fc\u30eb\n\u53c2\u8003: Node.js: request \u30e2\u30b8\u30e5\u30fc\u30eb\u3092\u4f7f\u3063\u3066 GET \u30ea\u30af\u30a8\u30b9\u30c8\u3092\u884c\u3046\n\u3044\u305a\u308c\u306fhubot\u3067ChatworkBot\u3092\u4f5c\u308b\u3068\u3053\u308d\u307e\u3067\u3084\u308a\u305f\u3044\u3067\u3059\u3002\n\n\u3084\u3063\u3068\u5229\u7528\u7533\u8acb\u3057\u3066\u3044\u305f[\u30c1\u30e3\u30c3\u30c8\u30ef\u30fc\u30afAPI](http://developer.chatwork.com/ja/index.html)\u306e\u5229\u7528\u8a31\u53ef\u304c\u304a\u308a\u307e\u3057\u305f!!\n\u306e\u3067\u3001\u5b9f\u969b\u306b\u4f7f\u3063\u3066\u307f\u307e\u3059\u3002\n\n##\u30c1\u30e3\u30c3\u30c8\u30ef\u30fc\u30afAPI\n\u3053\u306eAPI\u306f\u81ea\u5206\u53f2\u4e0a\u521d\u3081\u3066\u306e\u30bf\u30a4\u30d7\u3067header\u306btoken\u3092\u30bb\u30c3\u30c8\u3057\u3066\u9001\u4fe1\u3059\u308b\u3053\u3068\u3067GET\u3084POST\u3067\u5024\u3092\u53d6\u308c\u307e\u3059\u3002\n\n###\u30b5\u30f3\u30d7\u30eb\u30ea\u30af\u30a8\u30b9\u30c8\n\u30b5\u30f3\u30d7\u30eb\u30ea\u30af\u30a8\u30b9\u30c8\u306ecurl\u30b3\u30de\u30f3\u30c9\u306b -H\u30aa\u30d7\u30b7\u30e7\u30f3\u3067\u30d8\u30c3\u30c0\u30fc\u60c5\u5831\u3092\u9001\u3063\u3066\u3044\u308b\u306e\u304c\u5206\u304b\u308a\u307e\u3059\u3002\n\n```\n$ curl -X GET -H \"X-ChatWorkToken: YOUR API KEY\" \"https://api.chatwork.com/v1/rooms\"\n```\n\n\"X-ChatWorkToken: YOUR API KEY\"\u3068\u3044\u3046\u5f62\u3067API KEY\u3092\u6e21\u3057\u307e\u3059\u3002\n\n###node.js\u304b\u3089\u63a5\u7d9a\u3057\u305f\u3089connect ECONNREFUSED\u3063\u3066\u30a8\u30e9\u30fc\n\nhttp.request()\u3084http.get()\u3067\u4e0a\u624b\u304f\u63a5\u7d9a\u51fa\u6765\u307e\u305b\u3093\u3067\u3057\u305f\u6c57\n\u3053\u306e\u30a8\u30e9\u30fc\u304c\u51fa\u3066\u305f\u3093\u3067\u3059\u3051\u3069\u3001\u30a4\u30de\u30a4\u30c1\u5206\u304b\u3089\u305a...\u30a8\u30e2\u3044\u4eba\u6559\u3048\u3066\u4e0b\u3055\u3044\u6c57\n\n\u53c2\u8003: [Node.js v0.10.29 Manual & Documentation](http://nodejs.org/api/http.html#http_http_request_options_callback)\n\u53c2\u8003: [Node.js Error: connect ECONNREFUSED when using http.request - Stack Overflow](http://go.shr.lc/VqZ6ik)\n\n\n##express\u3067\u30da\u30fc\u30b8\u30a2\u30af\u30bb\u30b9\u3057\u305f\u969b\u306b\u30c1\u30e3\u30c3\u30c8\u4e00\u89a7\u3092\u8868\u793a\n###request\u30e2\u30b8\u30e5\u30fc\u30eb\u3067\u3068\u308a\u3042\u3048\u305a\u89e3\u6c7a\n\u30c7\u30d5\u30a9\u30eb\u30c8\u306eHTTP\u30e2\u30b8\u30e5\u30fc\u30eb\u3060\u3068\u4e0a\u624b\u304f\u3044\u304b\u306a\u304b\u3063\u305f\u306e\u3068\u3001\n[Node.js\u306echatwork\u63a5\u7d9a\u7528\u306e\u30e2\u30b8\u30e5\u30fc\u30eb](https://github.com/nanopx/chatwork-api)\u306e\u5185\u90e8\u3067request\u30e2\u30b8\u30e5\u30fc\u30eb\u3092\u5229\u7528\u3057\u3066\u3044\u305f\u3053\u3068\u304b\u3089\u3001request\u30e2\u30b8\u30e5\u30fc\u30eb\u3092\u4f7f\u3063\u3066\u8a66\u3057\u305f\u3089\u4e0a\u624b\u304f\u3044\u304d\u307e\u3057\u305f\u3002\n\n\n```\n$ express -e chatwork\n$ cd chatwork\n$ npm install\n$ npm install request\n```\n\n```routes/index.js\nvar express = require('express');\nvar router = express.Router();\nvar request = require('request');\n\nrouter.get('/', function(req, res){\n\tvar options = {\n\t\turl: 'https://api.chatwork.com/v1/rooms',\n\t\theaders: {\n\t\t\t'X-ChatWorkToken': 'YOUR API KEY'\n\t\t},\n\t\tjson: true\n\t};\n\n\trequest.get(options, function (error, response, body) {\n\t\tif (!error && response.statusCode == 200) {\n\t\t\t\n\t\t\tconsole.log(body[0]);\n\t\t\tres.render('index', {data:body});\n\t\t}else{\n\t\t\tconsole.log('error: '+ response.statusCode);\n\t\t}\n\t});\n});\n\nmodule.exports = router;\n```\n\n\u4eca\u56de\u306f\u30c1\u30e3\u30c3\u30c8\u30eb\u30fc\u30e0\u540d\u3068\u30c1\u30e3\u30c3\u30c8\u30eb\u30fc\u30e0\u306eicon\u753b\u50cf\u3092\u8868\u793a\u3055\u305b\u307e\u3059\u3002\n\n```index.ejs\n<!DOCTYPE html>\n<html>\n  <head>\n    <title>get\u3066\u3059\u3068</title>\n    <link rel='stylesheet' href='/stylesheets/style.css' />\n  </head>\n  <body>\n    <ul>\n    <% data.forEach(function(val){ %>\n    \t<li><%/*= val.room_id*/ %></li>\n    \t<li><%= val.name %></li>\n    \t<img src=\"<%= val.icon_path %>\" alt=\"\">\n    \t<br />\n    <% }) %>\n  </ul>\n  </body>\n</html>\n```\n\nlocalhost:3000\u306b\u30a2\u30af\u30bb\u30b9\u3059\u308b\u3068\n![](http://i.gyazo.com/e32a93afdea57c593924b5d063cd3763.png)\n\u3053\u3093\u306a\u611f\u3058\u3067\u30ea\u30b9\u30c8\u304c\u8868\u793a\u3055\u308c\u307e\u3057\u305f! \u3081\u3067\u305f\u3057!\n\n\u53c2\u8003: [Request\u30e2\u30b8\u30e5\u30fc\u30eb](https://github.com/mikeal/request)\n\u53c2\u8003: [Node.js: request \u30e2\u30b8\u30e5\u30fc\u30eb\u3092\u4f7f\u3063\u3066 GET \u30ea\u30af\u30a8\u30b9\u30c8\u3092\u884c\u3046](http://blog.sarabande.jp/post/52095868617)\n\n\u3044\u305a\u308c\u306fhubot\u3067ChatworkBot\u3092\u4f5c\u308b\u3068\u3053\u308d\u307e\u3067\u3084\u308a\u305f\u3044\u3067\u3059\u3002\n"}