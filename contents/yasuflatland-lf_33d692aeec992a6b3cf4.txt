{"context": "\n\n\u5bfe\u5fdc\u30d0\u30fc\u30b8\u30e7\u30f3\nLiferay DXP SP1\u4ee5\u964d / Liferay 7 CE\n\n\u306f\u3058\u3081\u306b\n\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306e\u8981\u4ef6\u3067\u3001Liferay\u306e\u4e0a\u90e8\u306b\u8868\u793a\u3055\u308c\u308b\u7ba1\u7406\u30ca\u30d3\u30b2\u30fc\u30b7\u30e7\u30f3\u30d0\u30fc(Control Menu)\u306e\u8868\u793a\u3092\u5236\u5fa1\u3057\u305f\u3044\u3068\u3044\u3046\u8981\u4ef6\u306f\u591a\u304f\u3042\u308b\u3002\u305d\u306e\u5834\u5408\u306e\u5bfe\u5fdc\u65b9\u6cd5\u3092\u8aac\u660e\u3059\u308b\u3002\n\u516c\u5f0f\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8:THEME CONTRIBUTORS\n\u516c\u5f0f\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8:CONTEXT CONTRIBUTORS\n\u306b\u5bfe\u5fdc\u65b9\u6cd5\u306e\u8aac\u660e\u304c\u8f09\u3063\u3066\u3044\u308b\u304c\u3001\u5b9f\u969b\u306e\u30dd\u30fc\u30c8\u30ec\u30c3\u30c8\u306e\u4f5c\u6210\u65b9\u6cd5\u3092\u3053\u3053\u306b\u8aac\u660e\u3059\u308b\u3002\n\n\u524d\u63d0\u6761\u4ef6\nLiferay workspace\u306f\u4f5c\u6210\u3055\u308c\u3066\u3044\u3066\u3001blade\u30c4\u30fc\u30eb\u3001Theme\u4f5c\u6210\u30c4\u30fc\u30eb\u5404\u7a2e\u306f\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u3066\u3044\u308b\u524d\u63d0\u3068\u3059\u308b\u3002\u4ee5\u4e0b\u306e\u8cc7\u6599\u3067\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\u65b9\u6cd5\u306f\u8aac\u660e\u3057\u3066\u3044\u308b\u3002\n\nLiferay DXP / 7\u306b\u304a\u3051\u308b\u30b5\u30fc\u30d3\u30b9\u30d3\u30eb\u30c0\u30fc\u30dd\u30fc\u30c8\u30ec\u30c3\u30c8\u306e\u4f5c\u6210\u65b9\u6cd5\nLiferay 7 / DXP\u3067\u306e\u30c6\u30fc\u30de\u306e\u4f5c\u308a\u65b9\n\n\u30c6\u30b9\u30c8\u30b7\u30ca\u30ea\u30aa\u3068\u3057\u3066\u3001Liferay\u306e\u6a19\u6e96\u30ed\u30fc\u30eb\u3001Administrator\u6a29\u9650\u304c\u3042\u308b\u30e6\u30fc\u30b6\u30fc\u306b\u306e\u307fControl Menu\u3092\u8868\u793a\u3055\u305b\u308b\u3001\u3068\u3044\u3046\u4ed5\u69d8\u3067\u5b9f\u88c5\u3059\u308b\u3002\n\nTheme contributor\u306e\u4f5c\u6210\n$(liferay_workspace)/modules\u306e\u4e0b\u306b\u79fb\u52d5\u3002\n\u305d\u3053\u3067Control Menu\u306e\u30d0\u30f3\u30c9\u30eb\u3092\u7f6e\u63db\u3059\u308b\u305f\u3081\u306eTheme contributer\u3092\u4f5c\u6210\u3059\u308b\u5fc5\u8981\u304c\u3042\u308b\u3002Liferay Developer Studio / IDE\u306e File -> New -> Liferay Module Project\u3092\u9078\u629e\u3001Project Template Name\u3067templatecontextcontributor\u3092\u9078\u629e\u3002\n\u3082\u3057\u304f\u306f\u30b3\u30de\u30f3\u30c9\u30e9\u30a4\u30f3\u3067\nblade create -t template-context-contributor -p com.liferay.product.navigation.control.menu.theme.contributor -c SampleProductNavigationControlMenu sample-product-navigation-control-menu-theme-contributor\n\n\u3067blade\u30c4\u30fc\u30eb\u3092\u4f7f\u3063\u3066\u30e2\u30b8\u30e5\u30fc\u30eb\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092\u4f5c\u6210\u3059\u308b\u3002\n\nSampleProductNavigationControlMenuTemplateContextContributor\u306e\u4f5c\u6210\nControl Menu\u306e\u30d9\u30fc\u30b9\u3068\u306a\u308b\u30d5\u30a1\u30a4\u30eb\u3092\u958b\u304f\n\nProductNavigationControlMenuTemplateContextContributor.java\nvi /liferay-portal/modules/apps/web-experience/product-navigation/product-navigation-control-menu-theme-contributor/src/main/java/com/liferay/product/navigation/control/menu/theme/contributor/internal/ProductNavigationControlMenuTemplateContextContributor.java\n\n\n\u4ee5\u4e0b\u306e\u90e8\u5206\u3092SampleProductNavigationControlMenuTemplateContextContributor.java\u306b\u30b3\u30d4\u30fc\u3059\u308b\u3002\n    @Override\n    public void prepare(\n        Map<String, Object> contextObjects, HttpServletRequest request) {\n\n        if (!isShowControlMenu(request)) {\n            return;\n        }\n\n        String cssClass = GetterUtil.getString(\n            contextObjects.get(\"bodyCssClass\"));\n\n        contextObjects.put(\"bodyCssClass\", cssClass + \" has-control-menu\");\n    }\n\n    protected boolean isShowControlMenu(HttpServletRequest request) {\n        ThemeDisplay themeDisplay = (ThemeDisplay)request.getAttribute(\n            WebKeys.THEME_DISPLAY);\n\n        if (themeDisplay.isImpersonated()) {\n            return true;\n        }\n\n        if (!themeDisplay.isSignedIn()) {\n            return false;\n        }\n\n        User user = themeDisplay.getUser();\n\n        if (!user.isSetupComplete()) {\n            return false;\n        }\n\n        return true;\n    }\n\n\u6b21\u306b\u3001\u6a19\u6e96\u30ed\u30fc\u30eb\u306eAdministrator\u6a29\u9650\u304c\u3042\u308b\u5834\u5408\u306b\u306e\u307f\u8868\u793a\u3092\u7d5e\u308b\u3001\u307e\u305f\u305d\u306e\u8868\u793a\u6761\u4ef6\u3092Theme\u5074\u306b\u51fa\u529b\u3059\u308b\u5909\u6570\u3092\u30bb\u30c3\u30c8\u3059\u308b\u51e6\u7406\u3092\u8ffd\u52a0\u3059\u308b\u3068\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u306a\u308b\u3002\n    @Override\n    public void prepare(\n        Map<String, Object> contextObjects, HttpServletRequest request) {\n\n        //Theme\u5074\u3067\u30e1\u30cb\u30e5\u30fc\u306e\u8868\u793a\u975e\u8868\u793a\u3092\u5224\u65ad\u3067\u304d\u308b\u3088\u3046\u306b\u3059\u308b\u305f\u3081\u306e\u5909\u6570\u3092\u66f8\u304d\u8fbc\u3080\u3002\n        boolean isShowControlMenu = isShowControlMenu(request);\n        contextObjects.put(\"isShowControlMenu\", String.valueOf(isShowControlMenu));\n\n        String cssClass = GetterUtil.getString(\n                contextObjects.get(\"bodyCssClass\"));\n\n        if (!isShowControlMenu) {\n            //isShowControlMenu\u304cfalse\u306e\u6642\u306f\u3001has-control-menu\u304cclass\u5b9a\u7fa9\u304b\u3089\u524a\u9664\u3055\u308c\u308b\u5fc5\u8981\u304c\u3042\u308b\u3002\n            contextObjects.put(\"bodyCssClass\", cssClass.replaceAll(\"has-control-menu\", \"\"));\n            return;\n        } else {\n            contextObjects.put(\"bodyCssClass\", cssClass + \" has-control-menu\");\n        }\n    }\n\n    protected boolean isShowControlMenu(HttpServletRequest request) {\n        ThemeDisplay themeDisplay = (ThemeDisplay)request.getAttribute(\n            WebKeys.THEME_DISPLAY);\n\n        if(!isAdmin(request)) {\n            return false;\n        }\n\n        if (themeDisplay.isImpersonated()) {\n            return true;\n        }\n\n        if (!themeDisplay.isSignedIn()) {\n            return false;\n        }\n\n        User user = themeDisplay.getUser();\n\n        if (!user.isSetupComplete()) {\n            return false;\n        }\n\n        return true;\n    }\n\n    /**\n     * Extra check for test\n     * \n     * @param request\n     * @return\n     */\n    protected boolean isAdmin(HttpServletRequest request) {\n        ThemeDisplay themeDisplay = (ThemeDisplay)request.getAttribute(\n                WebKeys.THEME_DISPLAY);\n        boolean bRet = false;\n\n        try {\n\n            //\u7ba1\u7406\u8005\u6a29\u9650\u304c\u3042\u308b\u6642\u306e\u307f\u8868\u793a\u3057\u305f\u3044\u3002\n            //\u3053\u3053\u3067\u306f\u8aac\u660e\u7684\u306b\u308f\u304b\u308a\u3084\u3059\u3088\u3046\u306b\u3001\u6587\u5b57\u5217\u3067\u30ed\u30fc\u30eb\u3092\u53d6\u5f97\u3057\u3066\u3044\u308b\u304c\u3001\u5b9f\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3067\u306f\u30ed\u30fc\u30ebID\u3092\u4f7f\u3046\u3088\u3046\u306b\u3059\u308b\u65b9\u304c\u3088\u3044\u304b\u3082\u3057\u308c\u306a\u3044\u3002\n            //\uff08\u5b9f\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3067\u306f\u7ba1\u7406\u8005\u306e\u30ed\u30fc\u30eb\u540d\u304c\u5909\u66f4\u3055\u308c\u308b\u53ef\u80fd\u6027\u3082\u3042\u308b\u306e\u3067\u3002\u30ed\u30fc\u30ebID\u304cDB\u6bce\u306b\u5909\u308f\u308b\u53ef\u80fd\u6027\u304c\u3042\u308b\u5834\u5408\u306f\u3001Administrator\u306a\u3069\u306e\u6587\u5b57\u5217\u3092\u30ad\u30fc\u306b\u3059\u308b\u65b9\u304c\u3044\u3044\u30b1\u30fc\u30b9\u3082\u3042\u308b\u3002)\n            Role adminRole = RoleLocalServiceUtil.getRole(themeDisplay.getCompanyId(), \"Administrator\");\n\n            List<Role> roles = themeDisplay.getUser().getRoles();\n\n            for(Role role : roles) {\n                if(role.getName().equals(adminRole.getName())) {\n                    bRet = true;\n                }\n            }\n        } catch (Exception e) {\n            e.printStackTrace();\n        }\n        return bRet;\n    }   \n\n\u6b21\u306b\u3001bnd.bnd\u30d5\u30a1\u30a4\u30eb\u3092\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u5909\u66f4\u3059\u308b\u3002\n\nbnd.bnd\nBundle-SymbolicName: sampleproductnavigationcontrolmenutemplatecontextcontributor\nBundle-Version: 2.0.6\nLiferay-Releng-Module-Group-Description:\nLiferay-Releng-Module-Group-Title: Product Navigation\nLiferay-Theme-Contributor-Type: product-navigation-control-menu\nWeb-ContextPath: /product-navigation-control-menu-theme-contributor\n\n\nBundle-Version\u3001Liferay-Theme-Contributor-Type\u3001Web-ContextPath\u306f\u73fe\u884c\u306eDXP\u306b\u542b\u307e\u308c\u3066\u3044\u308bProductNavigationControlMenuTemplateContextContributor.java\u306ebnd.bnd\u3092\u30b3\u30d4\u30fc\u3059\u308b\u3002\n\u3053\u308c\u3067Theme Contributor\u306e\u6e96\u5099\u304c\u3067\u304d\u305f\u306e\u3067\u3001\nblade deploy\n\n\u3067\u30c7\u30d7\u30ed\u30a4\u3001\u7d9a\u3044\u3066Theme\u306e\u4f5c\u6210\u3092\u884c\u3046\u3002\n\nTheme\u306e\u4f5c\u6210\n$(liferay_workspace)/themes\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u79fb\u52d5\u3057\u3001Liferay CE\u306e\u30af\u30e9\u30b7\u30c3\u30af\u30c6\u30fc\u30de\u3092\u6301\u3064\u30c6\u30fc\u30de\u3092\u4f5c\u6210\u3059\u308b\u3002(Liferay 7 / DXP\u3067\u306e\u30c6\u30fc\u30de\u306e\u4f5c\u308a\u65b9\u3092\u53c2\u7167)\n\u4ee5\u4e0b\u3092\u5909\u66f4\n\nportal_normal.ftl\n<@liferay.control_menu />\n\n\n\u3092\n\nportal_normal.ftl\n<#assign isShowControlMenu = htmlUtil.escape(isShowControlMenu!) />\n<#if \"true\" == isShowControlMenu >\n    <@liferay.control_menu />\n</#if>\n\n\n\u306b\u5909\u66f4\u3001\ngulp deploy\n\n\u3067\u30c7\u30d7\u30ed\u30a4\u3002\n\u4e0a\u8a18\u306eContributor / Theme\u3092\u30c7\u30d7\u30ed\u30a4\u3057\u305f\u5834\u5408\u3001Administrator\u6a29\u9650\u3092\u3082\u3064\u30e6\u30fc\u30b6\u30fc\u306b\u306fControl Menu\u304c\u8868\u793a\u3055\u308c\u3001\u305d\u308c\u4ee5\u5916\u306e\u30e6\u30fc\u30b6\u30fc\u306b\u307b\u8868\u793a\u3055\u308c\u306a\u304f\u306a\u308b\u306f\u305a\u3002\n## \u5bfe\u5fdc\u30d0\u30fc\u30b8\u30e7\u30f3\nLiferay DXP SP1\u4ee5\u964d / Liferay 7 CE\n\n\n## \u306f\u3058\u3081\u306b\n\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306e\u8981\u4ef6\u3067\u3001Liferay\u306e\u4e0a\u90e8\u306b\u8868\u793a\u3055\u308c\u308b\u7ba1\u7406\u30ca\u30d3\u30b2\u30fc\u30b7\u30e7\u30f3\u30d0\u30fc(Control Menu)\u306e\u8868\u793a\u3092\u5236\u5fa1\u3057\u305f\u3044\u3068\u3044\u3046\u8981\u4ef6\u306f\u591a\u304f\u3042\u308b\u3002\u305d\u306e\u5834\u5408\u306e\u5bfe\u5fdc\u65b9\u6cd5\u3092\u8aac\u660e\u3059\u308b\u3002\n\n[\u516c\u5f0f\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8:THEME CONTRIBUTORS](https://dev.liferay.com/develop/tutorials/-/knowledge_base/7-0/theme-contributors)\n[\u516c\u5f0f\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8:CONTEXT CONTRIBUTORS](https://dev.liferay.com/develop/tutorials/-/knowledge_base/7-0/context-contributors)\n\u306b\u5bfe\u5fdc\u65b9\u6cd5\u306e\u8aac\u660e\u304c\u8f09\u3063\u3066\u3044\u308b\u304c\u3001\u5b9f\u969b\u306e\u30dd\u30fc\u30c8\u30ec\u30c3\u30c8\u306e\u4f5c\u6210\u65b9\u6cd5\u3092\u3053\u3053\u306b\u8aac\u660e\u3059\u308b\u3002\n\n## \u524d\u63d0\u6761\u4ef6\nLiferay workspace\u306f\u4f5c\u6210\u3055\u308c\u3066\u3044\u3066\u3001blade\u30c4\u30fc\u30eb\u3001Theme\u4f5c\u6210\u30c4\u30fc\u30eb\u5404\u7a2e\u306f\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u3066\u3044\u308b\u524d\u63d0\u3068\u3059\u308b\u3002\u4ee5\u4e0b\u306e\u8cc7\u6599\u3067\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\u65b9\u6cd5\u306f\u8aac\u660e\u3057\u3066\u3044\u308b\u3002\n\n- [Liferay DXP / 7\u306b\u304a\u3051\u308b\u30b5\u30fc\u30d3\u30b9\u30d3\u30eb\u30c0\u30fc\u30dd\u30fc\u30c8\u30ec\u30c3\u30c8\u306e\u4f5c\u6210\u65b9\u6cd5](http://qiita.com/yasuflatland-lf/items/df60ef27b7710bca1607)\n- [Liferay 7 / DXP\u3067\u306e\u30c6\u30fc\u30de\u306e\u4f5c\u308a\u65b9](http://qiita.com/yasuflatland-lf/items/857b009ccbc9f9e3ae59)\n\n\u30c6\u30b9\u30c8\u30b7\u30ca\u30ea\u30aa\u3068\u3057\u3066\u3001Liferay\u306e\u6a19\u6e96\u30ed\u30fc\u30eb\u3001Administrator\u6a29\u9650\u304c\u3042\u308b\u30e6\u30fc\u30b6\u30fc\u306b\u306e\u307fControl Menu\u3092\u8868\u793a\u3055\u305b\u308b\u3001\u3068\u3044\u3046\u4ed5\u69d8\u3067\u5b9f\u88c5\u3059\u308b\u3002\n\n## Theme contributor\u306e\u4f5c\u6210\n$(liferay_workspace)/modules\u306e\u4e0b\u306b\u79fb\u52d5\u3002\n\n\u305d\u3053\u3067Control Menu\u306e\u30d0\u30f3\u30c9\u30eb\u3092\u7f6e\u63db\u3059\u308b\u305f\u3081\u306eTheme contributer\u3092\u4f5c\u6210\u3059\u308b\u5fc5\u8981\u304c\u3042\u308b\u3002Liferay Developer Studio / IDE\u306e File -> New -> Liferay Module Project\u3092\u9078\u629e\u3001Project Template Name\u3067templatecontextcontributor\u3092\u9078\u629e\u3002\n\n\u3082\u3057\u304f\u306f\u30b3\u30de\u30f3\u30c9\u30e9\u30a4\u30f3\u3067\n\n```bash\nblade create -t template-context-contributor -p com.liferay.product.navigation.control.menu.theme.contributor -c SampleProductNavigationControlMenu sample-product-navigation-control-menu-theme-contributor\n```\n\n\u3067blade\u30c4\u30fc\u30eb\u3092\u4f7f\u3063\u3066\u30e2\u30b8\u30e5\u30fc\u30eb\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092\u4f5c\u6210\u3059\u308b\u3002\n\n### SampleProductNavigationControlMenuTemplateContextContributor\u306e\u4f5c\u6210\n\nControl Menu\u306e\u30d9\u30fc\u30b9\u3068\u306a\u308b\u30d5\u30a1\u30a4\u30eb\u3092\u958b\u304f\n\n```bash:ProductNavigationControlMenuTemplateContextContributor.java\nvi /liferay-portal/modules/apps/web-experience/product-navigation/product-navigation-control-menu-theme-contributor/src/main/java/com/liferay/product/navigation/control/menu/theme/contributor/internal/ProductNavigationControlMenuTemplateContextContributor.java\n```\n\n\u4ee5\u4e0b\u306e\u90e8\u5206\u3092SampleProductNavigationControlMenuTemplateContextContributor.java\u306b\u30b3\u30d4\u30fc\u3059\u308b\u3002\n\n```java\n\t@Override\n\tpublic void prepare(\n\t\tMap<String, Object> contextObjects, HttpServletRequest request) {\n\n\t\tif (!isShowControlMenu(request)) {\n\t\t\treturn;\n\t\t}\n\n\t\tString cssClass = GetterUtil.getString(\n\t\t\tcontextObjects.get(\"bodyCssClass\"));\n\n\t\tcontextObjects.put(\"bodyCssClass\", cssClass + \" has-control-menu\");\n\t}\n\n\tprotected boolean isShowControlMenu(HttpServletRequest request) {\n\t\tThemeDisplay themeDisplay = (ThemeDisplay)request.getAttribute(\n\t\t\tWebKeys.THEME_DISPLAY);\n\n\t\tif (themeDisplay.isImpersonated()) {\n\t\t\treturn true;\n\t\t}\n\n\t\tif (!themeDisplay.isSignedIn()) {\n\t\t\treturn false;\n\t\t}\n\n\t\tUser user = themeDisplay.getUser();\n\n\t\tif (!user.isSetupComplete()) {\n\t\t\treturn false;\n\t\t}\n\n\t\treturn true;\n\t}\n```\n\n\u6b21\u306b\u3001\u6a19\u6e96\u30ed\u30fc\u30eb\u306eAdministrator\u6a29\u9650\u304c\u3042\u308b\u5834\u5408\u306b\u306e\u307f\u8868\u793a\u3092\u7d5e\u308b\u3001\u307e\u305f\u305d\u306e\u8868\u793a\u6761\u4ef6\u3092Theme\u5074\u306b\u51fa\u529b\u3059\u308b\u5909\u6570\u3092\u30bb\u30c3\u30c8\u3059\u308b\u51e6\u7406\u3092\u8ffd\u52a0\u3059\u308b\u3068\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u306a\u308b\u3002\n\n```java\n    @Override\n    public void prepare(\n        Map<String, Object> contextObjects, HttpServletRequest request) {\n\n        //Theme\u5074\u3067\u30e1\u30cb\u30e5\u30fc\u306e\u8868\u793a\u975e\u8868\u793a\u3092\u5224\u65ad\u3067\u304d\u308b\u3088\u3046\u306b\u3059\u308b\u305f\u3081\u306e\u5909\u6570\u3092\u66f8\u304d\u8fbc\u3080\u3002\n        boolean isShowControlMenu = isShowControlMenu(request);\n        contextObjects.put(\"isShowControlMenu\", String.valueOf(isShowControlMenu));\n\n        String cssClass = GetterUtil.getString(\n                contextObjects.get(\"bodyCssClass\"));\n\n        if (!isShowControlMenu) {\n            //isShowControlMenu\u304cfalse\u306e\u6642\u306f\u3001has-control-menu\u304cclass\u5b9a\u7fa9\u304b\u3089\u524a\u9664\u3055\u308c\u308b\u5fc5\u8981\u304c\u3042\u308b\u3002\n            contextObjects.put(\"bodyCssClass\", cssClass.replaceAll(\"has-control-menu\", \"\"));\n            return;\n        } else {\n            contextObjects.put(\"bodyCssClass\", cssClass + \" has-control-menu\");\n        }\n    }\n\n    protected boolean isShowControlMenu(HttpServletRequest request) {\n        ThemeDisplay themeDisplay = (ThemeDisplay)request.getAttribute(\n            WebKeys.THEME_DISPLAY);\n\n        if(!isAdmin(request)) {\n            return false;\n        }\n\n        if (themeDisplay.isImpersonated()) {\n            return true;\n        }\n\n        if (!themeDisplay.isSignedIn()) {\n            return false;\n        }\n\n        User user = themeDisplay.getUser();\n\n        if (!user.isSetupComplete()) {\n            return false;\n        }\n\n        return true;\n    }\n\n    /**\n     * Extra check for test\n     * \n     * @param request\n     * @return\n     */\n    protected boolean isAdmin(HttpServletRequest request) {\n        ThemeDisplay themeDisplay = (ThemeDisplay)request.getAttribute(\n                WebKeys.THEME_DISPLAY);\n        boolean bRet = false;\n\n        try {\n\n            //\u7ba1\u7406\u8005\u6a29\u9650\u304c\u3042\u308b\u6642\u306e\u307f\u8868\u793a\u3057\u305f\u3044\u3002\n            //\u3053\u3053\u3067\u306f\u8aac\u660e\u7684\u306b\u308f\u304b\u308a\u3084\u3059\u3088\u3046\u306b\u3001\u6587\u5b57\u5217\u3067\u30ed\u30fc\u30eb\u3092\u53d6\u5f97\u3057\u3066\u3044\u308b\u304c\u3001\u5b9f\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3067\u306f\u30ed\u30fc\u30ebID\u3092\u4f7f\u3046\u3088\u3046\u306b\u3059\u308b\u65b9\u304c\u3088\u3044\u304b\u3082\u3057\u308c\u306a\u3044\u3002\n            //\uff08\u5b9f\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3067\u306f\u7ba1\u7406\u8005\u306e\u30ed\u30fc\u30eb\u540d\u304c\u5909\u66f4\u3055\u308c\u308b\u53ef\u80fd\u6027\u3082\u3042\u308b\u306e\u3067\u3002\u30ed\u30fc\u30ebID\u304cDB\u6bce\u306b\u5909\u308f\u308b\u53ef\u80fd\u6027\u304c\u3042\u308b\u5834\u5408\u306f\u3001Administrator\u306a\u3069\u306e\u6587\u5b57\u5217\u3092\u30ad\u30fc\u306b\u3059\u308b\u65b9\u304c\u3044\u3044\u30b1\u30fc\u30b9\u3082\u3042\u308b\u3002)\n            Role adminRole = RoleLocalServiceUtil.getRole(themeDisplay.getCompanyId(), \"Administrator\");\n\n            List<Role> roles = themeDisplay.getUser().getRoles();\n\n            for(Role role : roles) {\n                if(role.getName().equals(adminRole.getName())) {\n                    bRet = true;\n                }\n            }\n        } catch (Exception e) {\n            e.printStackTrace();\n        }\n        return bRet;\n    }\t\n```\n\n\u6b21\u306b\u3001bnd.bnd\u30d5\u30a1\u30a4\u30eb\u3092\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u5909\u66f4\u3059\u308b\u3002\n\n```bash:bnd.bnd\nBundle-SymbolicName: sampleproductnavigationcontrolmenutemplatecontextcontributor\nBundle-Version: 2.0.6\nLiferay-Releng-Module-Group-Description:\nLiferay-Releng-Module-Group-Title: Product Navigation\nLiferay-Theme-Contributor-Type: product-navigation-control-menu\nWeb-ContextPath: /product-navigation-control-menu-theme-contributor\n```\n\nBundle-Version\u3001Liferay-Theme-Contributor-Type\u3001Web-ContextPath\u306f\u73fe\u884c\u306eDXP\u306b\u542b\u307e\u308c\u3066\u3044\u308bProductNavigationControlMenuTemplateContextContributor.java\u306ebnd.bnd\u3092\u30b3\u30d4\u30fc\u3059\u308b\u3002\n\n\u3053\u308c\u3067Theme Contributor\u306e\u6e96\u5099\u304c\u3067\u304d\u305f\u306e\u3067\u3001\n\n```bash\nblade deploy\n```\n\n\u3067\u30c7\u30d7\u30ed\u30a4\u3001\u7d9a\u3044\u3066Theme\u306e\u4f5c\u6210\u3092\u884c\u3046\u3002\n\n## Theme\u306e\u4f5c\u6210\n$(liferay_workspace)/themes\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u79fb\u52d5\u3057\u3001Liferay CE\u306e\u30af\u30e9\u30b7\u30c3\u30af\u30c6\u30fc\u30de\u3092\u6301\u3064\u30c6\u30fc\u30de\u3092\u4f5c\u6210\u3059\u308b\u3002([Liferay 7 / DXP\u3067\u306e\u30c6\u30fc\u30de\u306e\u4f5c\u308a\u65b9](http://qiita.com/yasuflatland-lf/items/857b009ccbc9f9e3ae59)\u3092\u53c2\u7167)\n\n\u4ee5\u4e0b\u3092\u5909\u66f4\n\n```freemarker:portal_normal.ftl\n<@liferay.control_menu />\n```\n\n\u3092\n\n```freemarker:portal_normal.ftl\n<#assign isShowControlMenu = htmlUtil.escape(isShowControlMenu!) />\n<#if \"true\" == isShowControlMenu >\n\t<@liferay.control_menu />\n</#if>\n```\n\n\u306b\u5909\u66f4\u3001\n\n```bash\ngulp deploy\n```\n\n\u3067\u30c7\u30d7\u30ed\u30a4\u3002\n\n\u4e0a\u8a18\u306eContributor / Theme\u3092\u30c7\u30d7\u30ed\u30a4\u3057\u305f\u5834\u5408\u3001Administrator\u6a29\u9650\u3092\u3082\u3064\u30e6\u30fc\u30b6\u30fc\u306b\u306fControl Menu\u304c\u8868\u793a\u3055\u308c\u3001\u305d\u308c\u4ee5\u5916\u306e\u30e6\u30fc\u30b6\u30fc\u306b\u307b\u8868\u793a\u3055\u308c\u306a\u304f\u306a\u308b\u306f\u305a\u3002\n\n\n", "tags": ["Liferay", "Java", "OSGi", "CMS", "portal"]}