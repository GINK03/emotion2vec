{"context": " More than 1 year has passed since last update.\nBrowserSync \u3092 open:true \u3067\u4f7f\u3063\u3066\u3044\u308b\u3068\u304d\u3001\u958b\u3044\u305f\u30d6\u30e9\u30a6\u30b6\u306e\u30bf\u30d6\u3092\u9589\u3058\u305f\u3089 BrowserSync \u306b\u3082\u7d42\u4e86\u3057\u3066\u307b\u3057\u3044\u3053\u3068\u304c\u3042\u308a\u307e\u3059\u3002\n\n\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u304c disconnect \u3057\u305f\u3068\u304d\u306b\u63a5\u7d9a\u3055\u308c\u3066\u3044\u308b\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u306e\u6570\u3092\u8abf\u3079\u3066\u3001\u30bc\u30ed\u306a\u3089\u30d7\u30ed\u30bb\u30b9\u3092\u7d42\u4e86\u3057\u307e\u3059\u3002\n\u305f\u3060\u3057\u3001disconnect \u306e\u5f8c\u306e\u5373\u6642\u3060\u3068\u30ea\u30ed\u30fc\u30c9\u3067\u9589\u3058\u3066\u3057\u307e\u3046\u306e\u3067\u30012\u79d2\u306e\u30c7\u30a3\u30ec\u30a4\u3092\u304b\u3051\u3066\u3044\u307e\u3059\u3002\nvar util = require(\"util\");\nvar bs = require(\"browser-sync\").create();\n\nbs.init({\n    logLevel: \"debug\",\n    files: [\"web/*.html\"],\n    server: \"./web\",\n    open: true,\n    port: 16845,\n    online: false,\n    ui: false\n}, function () {\n    var logger = bs.instance.getLogger(\"autoexit\");\n    var sockets = bs.instance.io.sockets;\n    var timer = null;\n\n    sockets.on(\"connection\", function(socket){\n        logger.info(util.format(\"Socket connection (%s clients)\", socket.client.conn.server.clientsCount));\n\n        socket.on('disconnect', function () {\n            logger.info(util.format(\"Socket disconnect (%s clients)\", socket.client.conn.server.clientsCount));\n\n            clearTimeout(timer);\n            timer = setTimeout(function(){\n                logger.info(util.format(\"Delay timeout (%s clients)\", socket.client.conn.server.clientsCount));\n                if (socket.client.conn.server.clientsCount == 0) {\n                    logger.info(\"Exit process\");\n                    process.exit();\n                }\n            }, 2000);\n        });\n    });\n});\n\n\n\u6b21\u306e\u3088\u3046\u306a\u30e2\u30b8\u30e5\u30fc\u30eb\u3092\u4f5c\u6210\u3057\u3001\nbs-autoexit.js\nvar util = require(\"util\");\n\nfunction plugin(opts, bs)\n{\n    var logger = bs.getLogger(\"autoexit\");\n    var sockets = bs.io.sockets;\n    var timer = null;\n\n    sockets.on(\"connection\", function(socket){\n        logger.info(util.format(\"Socket connection (%s clients)\", socket.client.conn.server.clientsCount));\n\n        socket.on('disconnect', function () {\n            logger.info(util.format(\"Socket disconnect (%s clients)\", socket.client.conn.server.clientsCount));\n\n            clearTimeout(timer);\n            timer = setTimeout(function(){\n                logger.info(util.format(\"Delay timeout (%s clients)\", socket.client.conn.server.clientsCount));\n                if (socket.client.conn.server.clientsCount == 0) {\n                    logger.info(\"Exit process\");\n                    process.exit();\n                }\n            }, 2000);\n        });\n    });\n}\n\nmodule.exports = {\n    plugin: plugin\n}\n\n\u6b21\u306e\u3088\u3046\u306b use \u3067\u4f7f\u7528\u3059\u308b\u3053\u3068\u3082\u53ef\u80fd\u3067\u3059\u3002\nvar bs = require(\"browser-sync\").create();\nbs.use(require(\"./bs-autoexit\"));\nbs.init({\n    logLevel: \"debug\",\n    files: [\"web/*.html\"],\n    server: \"./web\",\n    open: true,\n    port: 16845,\n    online: false,\n    ui: false\n});\n\n\n\u30d6\u30e9\u30a6\u30b6\u3092\u9023\u7d9a\u3067\u30ea\u30ed\u30fc\u30c9\u3057\u307e\u304f\u308b\u3068\u63a5\u7d9a\u6570\u304c\u3069\u3093\u3069\u3093\u5897\u3048\u3066\u3044\u3063\u3066\u3001\u30bf\u30d6\u3092\u9589\u3058\u3066\u3082 BrowserSync \u304c\u6b7b\u306a\u306a\u304f\u306a\u308b\u30fb\u30fb\u30fb\n<!--\ntitle: \u30d6\u30e9\u30a6\u30b6\u306e\u30bf\u30d6\u3092\u9589\u3058\u305f\u6642\u306b BrowserSync \u3092\u7d42\u4e86\u3055\u305b\u308b\ntags: Node.js BrowserSync\n-->\n\nBrowserSync \u3092 `open:true` \u3067\u4f7f\u3063\u3066\u3044\u308b\u3068\u304d\u3001\u958b\u3044\u305f\u30d6\u30e9\u30a6\u30b6\u306e\u30bf\u30d6\u3092\u9589\u3058\u305f\u3089 BrowserSync \u306b\u3082\u7d42\u4e86\u3057\u3066\u307b\u3057\u3044\u3053\u3068\u304c\u3042\u308a\u307e\u3059\u3002\n\n----\n\n\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u304c `disconnect` \u3057\u305f\u3068\u304d\u306b\u63a5\u7d9a\u3055\u308c\u3066\u3044\u308b\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u306e\u6570\u3092\u8abf\u3079\u3066\u3001\u30bc\u30ed\u306a\u3089\u30d7\u30ed\u30bb\u30b9\u3092\u7d42\u4e86\u3057\u307e\u3059\u3002\n\n\u305f\u3060\u3057\u3001`disconnect` \u306e\u5f8c\u306e\u5373\u6642\u3060\u3068\u30ea\u30ed\u30fc\u30c9\u3067\u9589\u3058\u3066\u3057\u307e\u3046\u306e\u3067\u30012\u79d2\u306e\u30c7\u30a3\u30ec\u30a4\u3092\u304b\u3051\u3066\u3044\u307e\u3059\u3002\n\n```js\nvar util = require(\"util\");\nvar bs = require(\"browser-sync\").create();\n\nbs.init({\n    logLevel: \"debug\",\n    files: [\"web/*.html\"],\n    server: \"./web\",\n    open: true,\n    port: 16845,\n    online: false,\n    ui: false\n}, function () {\n    var logger = bs.instance.getLogger(\"autoexit\");\n    var sockets = bs.instance.io.sockets;\n    var timer = null;\n\n    sockets.on(\"connection\", function(socket){\n        logger.info(util.format(\"Socket connection (%s clients)\", socket.client.conn.server.clientsCount));\n\n        socket.on('disconnect', function () {\n            logger.info(util.format(\"Socket disconnect (%s clients)\", socket.client.conn.server.clientsCount));\n\n            clearTimeout(timer);\n            timer = setTimeout(function(){\n                logger.info(util.format(\"Delay timeout (%s clients)\", socket.client.conn.server.clientsCount));\n                if (socket.client.conn.server.clientsCount == 0) {\n                    logger.info(\"Exit process\");\n                    process.exit();\n                }\n            }, 2000);\n        });\n    });\n});\n```\n\n----\n\n\u6b21\u306e\u3088\u3046\u306a\u30e2\u30b8\u30e5\u30fc\u30eb\u3092\u4f5c\u6210\u3057\u3001\n\n*bs-autoexit.js*\n\n```js\nvar util = require(\"util\");\n\nfunction plugin(opts, bs)\n{\n    var logger = bs.getLogger(\"autoexit\");\n    var sockets = bs.io.sockets;\n    var timer = null;\n\n    sockets.on(\"connection\", function(socket){\n        logger.info(util.format(\"Socket connection (%s clients)\", socket.client.conn.server.clientsCount));\n\n        socket.on('disconnect', function () {\n            logger.info(util.format(\"Socket disconnect (%s clients)\", socket.client.conn.server.clientsCount));\n\n            clearTimeout(timer);\n            timer = setTimeout(function(){\n                logger.info(util.format(\"Delay timeout (%s clients)\", socket.client.conn.server.clientsCount));\n                if (socket.client.conn.server.clientsCount == 0) {\n                    logger.info(\"Exit process\");\n                    process.exit();\n                }\n            }, 2000);\n        });\n    });\n}\n\nmodule.exports = {\n    plugin: plugin\n}\n```\n\n\u6b21\u306e\u3088\u3046\u306b use \u3067\u4f7f\u7528\u3059\u308b\u3053\u3068\u3082\u53ef\u80fd\u3067\u3059\u3002\n\n```js\nvar bs = require(\"browser-sync\").create();\nbs.use(require(\"./bs-autoexit\"));\nbs.init({\n    logLevel: \"debug\",\n    files: [\"web/*.html\"],\n    server: \"./web\",\n    open: true,\n    port: 16845,\n    online: false,\n    ui: false\n});\n```\n\n----\n\n\u30d6\u30e9\u30a6\u30b6\u3092\u9023\u7d9a\u3067\u30ea\u30ed\u30fc\u30c9\u3057\u307e\u304f\u308b\u3068\u63a5\u7d9a\u6570\u304c\u3069\u3093\u3069\u3093\u5897\u3048\u3066\u3044\u3063\u3066\u3001\u30bf\u30d6\u3092\u9589\u3058\u3066\u3082 BrowserSync \u304c\u6b7b\u306a\u306a\u304f\u306a\u308b\u30fb\u30fb\u30fb\n", "tags": ["Node.js", "BrowserSync"]}