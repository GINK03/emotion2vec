{"context": " More than 1 year has passed since last update.\n\njavascript\u3067DOCX,ODT\u3092\u30d7\u30ec\u30fc\u30f3\u30c6\u30ad\u30b9\u30c8\u306b\nMSWord\u306e.docx\u53ca\u3073LibreOffice\u306e.odt\u306fXML\u3092zip\u3067\u56fa\u3081\u305f\u3082\u306e\u306a\u306e\u3067javascript\u3067\u3082\u89e3\u8aad\u306f\u53ef\u80fd(\u306a\u306f\u305a)\u3002\u6a5f\u4f1a\u304c\u3042\u3063\u305f\u306e\u3067\u8a66\u3057\u3066\u307f\u305f\u3002\n\n\u52d5\u4f5c\u74b0\u5883\n\nDOMParser\u304c\u4f7f\u3048\u308b\u30d6\u30e9\u30a6\u30b6\nJSZip ( https://stuk.github.io/jszip/ ) js\u3067zip\u30d5\u30a1\u30a4\u30eb\u3092\u8aad\u307f\u66f8\u304d\u3059\u308b\u305f\u3081\n\n\nDOCX\u306e\u69cb\u9020\u8abf\u67fb\nWord\u3067\u4f5c\u3089\u308c\u305fdocx\u3092\u5c55\u958b\u3057\u305f\u3068\u3053\u308d\u3001\u30c6\u30ad\u30b9\u30c8\u60c5\u5831\u306f word/document.xml \u306b\u3042\u308a\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u69cb\u9020\u3060\u3063\u305f\u3002\n\nword/document.xml\n<w:document>\n  <w:body>\n    <w:p>\n      <w:r>\n        <w:t>plain text</w:t>\n      </w:r>\n      <w:r>\n        <w:tab/>\n      </w:r>\n    </w:p>\n    <w:p>....</w:p>\n  </w:body>\n</w:document>\n\n\n\n\n<w:p>\u306fHTML\u306eP\u8981\u7d20\u306e\u3088\u3046\u306b\u6539\u884c\u3055\u308c\u3066\u8868\u793a\u3055\u308c\u308b\n\u305f\u304f\u3055\u3093\u306e<w:r>\u3067\u7d30\u304b\u304f\u30c6\u30ad\u30b9\u30c8\u304c\u5206\u5272\u3055\u308c\u3066\u3044\u308b\n\u30bf\u30d6(U+0009)\u306f<w:t>\u5185\u306b\u306f\u5b58\u5728\u305b\u305a\u3001\u5225\u306e<w:r>\u5185\u306e<w:tab>\u306b\u5909\u63db\u3055\u308c\u308b\u3088\u3046\u3060\n\n\ndocx2txt\u306e\u5b9f\u88c5\n\"use strict\";\n/**\n * .docx\u30d5\u30a1\u30a4\u30eb\u3092\u8aad\u307f\u53d6\u308a\u30d7\u30ec\u30fc\u30f3\u30c6\u30ad\u30b9\u30c8\u306b\u3059\u308b\n * @param file {File|Blob} docx\u306e\u30d5\u30a1\u30a4\u30eb\n * @param callback {function} \u30d7\u30ec\u30fc\u30f3\u30c6\u30ad\u30b9\u30c8\u3092\u5f15\u6570\u306b\u3059\u308b\u95a2\u6570\n */\nvar docx2txt = function(file, callback) {\n  var fr = new FileReader();\n  fr.onload = function() {\n    var xml,dom,txt,p,i,r,j,t,k;\n    xml = new JSZip(fr.result).file('word/document.xml').asText();\n    dom = (new DOMParser()).parseFromString(xml, 'application/xml');\n    txt = \"\";\n    p = dom.firstChild.firstChild.childNodes; //w:document>w:body>w:p\n    for(i=0; i<p.length; i++) {\n      if (p[i].nodeName !== 'w:p') {continue;}\n      r = p[i].childNodes;\n      for(j=0; j<r.length; j++) {\n        if (r[j].nodeName !== 'w:r') {continue;}\n        t = r[j].childNodes;\n        for(k=0; k<t.length; k++) {\n          if (t[k].nodeName === 'w:t') {txt += t[k].textContent;}\n          else if (t[k].nodeName === 'w:tab') {txt += \"\\t\";}\n        }\n      }\n      txt += \"\\n\";\n    }\n    callback(txt);\n  };\n  fr.readAsArrayBuffer(file);\n};\n\n//File\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306fDrag and Drop\u3084input[type='file']\u306a\u3069\u3067\u4f5c\u6210\u3002\u4ee5\u4e0b\u306e\u4f8b\u306finput\u30bf\u30b0\ndocument.getElementById('inputFile').onchange = function(e) {\n  var file = e.target.files[0];\n  if (file && file.name.match(/\\.docx$/i)) {\n    docx2txt(file, function(txt) {\n      console.info(txt);\n    });\n  }\n};\n\n\nODT\u306e\u69cb\u9020\u8abf\u67fb\n\u30c6\u30ad\u30b9\u30c8\u60c5\u5831\u306f .odt \u3092\u5c55\u958b\u3057\u305f\u76f4\u4e0b\u306e content.xml \u306b\u3042\u308a\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u69cb\u9020\u3092\u3057\u3066\u3044\u308b\n\ncontent.xml\n<office:document-content>\n  <office:body>\n    <office:text>\n      <text:h>\n        <text:span>plain text</text:span>\n      </text:h>\n      <text:p>\n        <text:span>\n          <text:s/>\u306f\u30b9\u30da\u30fc\u30b9\n          <text:tab/>\u306f\u30bf\u30d6\n        </text:span>\n      </text:p>\n      ...\n    </office:text>\n  </office:body>\n</office:document-content>\n\n\n\nDOCX\u306b\u4f3c\u3066\u3044\u308b\u304c\u591a\u5c11\u9055\u3046\n\n<office:text>\u4ee5\u4e0b\u306b\u306f<text:h>\u304b<text:p>\u304c\u3042\u308b\n\n<text:p>(\u307e\u305f\u306fh)\u76f4\u4e0b\u306e<text:span>\u5185\u306bplainText\u304c\u3042\u308b\n\n<text:span>\u306e\u4e2d\u306b\u306fplainText\u4ee5\u5916\u306b\u3001\u30b9\u30da\u30fc\u30b9\u3092\u8868\u3059<text:s/>\u3084\u30bf\u30d6\u3092\u8868\u3059<text:tab/>\u304c\u5b58\u5728\u3059\u308b\u3053\u3068\u3082\u3042\u308b\n\n\nodt2txt\u306e\u5b9f\u88c5\n\u307b\u307c\u540c\u3058\u306a\u306e\u3067\u7565:P\n\n\u8003\u5bdf\njavascript\u3067DOCX\u3084ODT\u304b\u3089\u30d7\u30ec\u30fc\u30f3\u30c6\u30ad\u30b9\u30c8\u3092\u629c\u304d\u51fa\u3059\u306e\u306f\u305d\u3046\u96e3\u3057\u304f\u306f\u306a\u304b\u3063\u305f\u3002\n1MB\u7a0b\u5ea6\u306e\u30d5\u30a1\u30a4\u30eb\u3067\u8a66\u3057\u305f\u304c\u51e6\u7406\u306f\u6570\u79d2\u3060\u3063\u305f\u3002\n\u8a73\u7d30\u306b\u691c\u8a3c\u3057\u305f\u308f\u3051\u3067\u306f\u306a\u3044\u306e\u3067\u5909\u63db\u3067\u304d\u3066\u3044\u306a\u3044\u6587\u5b57\u304c\u3042\u308b\u304b\u3082\u3057\u308c\u306a\u3044\u3002\n# javascript\u3067DOCX,ODT\u3092\u30d7\u30ec\u30fc\u30f3\u30c6\u30ad\u30b9\u30c8\u306b\nMSWord\u306e.docx\u53ca\u3073LibreOffice\u306e.odt\u306fXML\u3092zip\u3067\u56fa\u3081\u305f\u3082\u306e\u306a\u306e\u3067javascript\u3067\u3082\u89e3\u8aad\u306f\u53ef\u80fd(\u306a\u306f\u305a)\u3002\u6a5f\u4f1a\u304c\u3042\u3063\u305f\u306e\u3067\u8a66\u3057\u3066\u307f\u305f\u3002\n\n## \u52d5\u4f5c\u74b0\u5883\n* DOMParser\u304c\u4f7f\u3048\u308b\u30d6\u30e9\u30a6\u30b6\n* JSZip ( https://stuk.github.io/jszip/ ) js\u3067zip\u30d5\u30a1\u30a4\u30eb\u3092\u8aad\u307f\u66f8\u304d\u3059\u308b\u305f\u3081\n\n## DOCX\u306e\u69cb\u9020\u8abf\u67fb\nWord\u3067\u4f5c\u3089\u308c\u305fdocx\u3092\u5c55\u958b\u3057\u305f\u3068\u3053\u308d\u3001\u30c6\u30ad\u30b9\u30c8\u60c5\u5831\u306f word/document.xml \u306b\u3042\u308a\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u69cb\u9020\u3060\u3063\u305f\u3002\n\n```word/document.xml\n<w:document>\n  <w:body>\n    <w:p>\n      <w:r>\n        <w:t>plain text</w:t>\n      </w:r>\n      <w:r>\n        <w:tab/>\n      </w:r>\n    </w:p>\n    <w:p>....</w:p>\n  </w:body>\n</w:document>\n```\n* ``<w:p>``\u306fHTML\u306eP\u8981\u7d20\u306e\u3088\u3046\u306b\u6539\u884c\u3055\u308c\u3066\u8868\u793a\u3055\u308c\u308b\n* \u305f\u304f\u3055\u3093\u306e``<w:r>``\u3067\u7d30\u304b\u304f\u30c6\u30ad\u30b9\u30c8\u304c\u5206\u5272\u3055\u308c\u3066\u3044\u308b\n* \u30bf\u30d6(U+0009)\u306f``<w:t>``\u5185\u306b\u306f\u5b58\u5728\u305b\u305a\u3001\u5225\u306e``<w:r>``\u5185\u306e``<w:tab>``\u306b\u5909\u63db\u3055\u308c\u308b\u3088\u3046\u3060\n\n## docx2txt\u306e\u5b9f\u88c5\n\n```js\n\"use strict\";\n/**\n * .docx\u30d5\u30a1\u30a4\u30eb\u3092\u8aad\u307f\u53d6\u308a\u30d7\u30ec\u30fc\u30f3\u30c6\u30ad\u30b9\u30c8\u306b\u3059\u308b\n * @param file {File|Blob} docx\u306e\u30d5\u30a1\u30a4\u30eb\n * @param callback {function} \u30d7\u30ec\u30fc\u30f3\u30c6\u30ad\u30b9\u30c8\u3092\u5f15\u6570\u306b\u3059\u308b\u95a2\u6570\n */\nvar docx2txt = function(file, callback) {\n  var fr = new FileReader();\n  fr.onload = function() {\n    var xml,dom,txt,p,i,r,j,t,k;\n    xml = new JSZip(fr.result).file('word/document.xml').asText();\n    dom = (new DOMParser()).parseFromString(xml, 'application/xml');\n    txt = \"\";\n    p = dom.firstChild.firstChild.childNodes; //w:document>w:body>w:p\n    for(i=0; i<p.length; i++) {\n      if (p[i].nodeName !== 'w:p') {continue;}\n      r = p[i].childNodes;\n      for(j=0; j<r.length; j++) {\n        if (r[j].nodeName !== 'w:r') {continue;}\n        t = r[j].childNodes;\n        for(k=0; k<t.length; k++) {\n          if (t[k].nodeName === 'w:t') {txt += t[k].textContent;}\n          else if (t[k].nodeName === 'w:tab') {txt += \"\\t\";}\n        }\n      }\n      txt += \"\\n\";\n    }\n    callback(txt);\n  };\n  fr.readAsArrayBuffer(file);\n};\n\n//File\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306fDrag and Drop\u3084input[type='file']\u306a\u3069\u3067\u4f5c\u6210\u3002\u4ee5\u4e0b\u306e\u4f8b\u306finput\u30bf\u30b0\ndocument.getElementById('inputFile').onchange = function(e) {\n  var file = e.target.files[0];\n  if (file && file.name.match(/\\.docx$/i)) {\n    docx2txt(file, function(txt) {\n      console.info(txt);\n    });\n  }\n};\n```\n\n## ODT\u306e\u69cb\u9020\u8abf\u67fb\n\u30c6\u30ad\u30b9\u30c8\u60c5\u5831\u306f .odt \u3092\u5c55\u958b\u3057\u305f\u76f4\u4e0b\u306e content.xml \u306b\u3042\u308a\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u69cb\u9020\u3092\u3057\u3066\u3044\u308b\n\n```content.xml\n<office:document-content>\n  <office:body>\n    <office:text>\n      <text:h>\n        <text:span>plain text</text:span>\n      </text:h>\n      <text:p>\n        <text:span>\n          <text:s/>\u306f\u30b9\u30da\u30fc\u30b9\n          <text:tab/>\u306f\u30bf\u30d6\n        </text:span>\n      </text:p>\n      ...\n    </office:text>\n  </office:body>\n</office:document-content>\n```\n\n* DOCX\u306b\u4f3c\u3066\u3044\u308b\u304c\u591a\u5c11\u9055\u3046\n* ``<office:text>``\u4ee5\u4e0b\u306b\u306f``<text:h>``\u304b``<text:p>``\u304c\u3042\u308b\n* ``<text:p>``(\u307e\u305f\u306fh)\u76f4\u4e0b\u306e``<text:span>``\u5185\u306bplainText\u304c\u3042\u308b\n* ``<text:span>``\u306e\u4e2d\u306b\u306fplainText\u4ee5\u5916\u306b\u3001\u30b9\u30da\u30fc\u30b9\u3092\u8868\u3059``<text:s/>``\u3084\u30bf\u30d6\u3092\u8868\u3059``<text:tab/>``\u304c\u5b58\u5728\u3059\u308b\u3053\u3068\u3082\u3042\u308b\n\n## odt2txt\u306e\u5b9f\u88c5\n\n\u307b\u307c\u540c\u3058\u306a\u306e\u3067\u7565:P\n\n## \u8003\u5bdf\njavascript\u3067DOCX\u3084ODT\u304b\u3089\u30d7\u30ec\u30fc\u30f3\u30c6\u30ad\u30b9\u30c8\u3092\u629c\u304d\u51fa\u3059\u306e\u306f\u305d\u3046\u96e3\u3057\u304f\u306f\u306a\u304b\u3063\u305f\u3002\n1MB\u7a0b\u5ea6\u306e\u30d5\u30a1\u30a4\u30eb\u3067\u8a66\u3057\u305f\u304c\u51e6\u7406\u306f\u6570\u79d2\u3060\u3063\u305f\u3002\n\u8a73\u7d30\u306b\u691c\u8a3c\u3057\u305f\u308f\u3051\u3067\u306f\u306a\u3044\u306e\u3067\u5909\u63db\u3067\u304d\u3066\u3044\u306a\u3044\u6587\u5b57\u304c\u3042\u308b\u304b\u3082\u3057\u308c\u306a\u3044\u3002\n", "tags": ["JavaScript", "office"]}