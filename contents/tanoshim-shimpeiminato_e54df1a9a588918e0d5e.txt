{"context": " More than 1 year has passed since last update.\u5927\u91cf\u751f\u7523\u3055\u308c\u305f\u30d7\u30ec\u30cf\u30d6\u3092\u6a5f\u68b0\u7684\u306b\u3044\u3058\u308b\u6a5f\u4f1a\u304c\u3061\u3087\u3044\u3061\u3087\u3044\u3042\u308b\u306e\u3067\u66f8\u3044\u3066\u307f\u305f\u3002\npublic class PrefabChanger\n{\n    public static void ExecuteChange(List<string> targets, System.Action<GameObject> onChange)\n    {\n        if (onChange == null) return;\n\n        foreach (string path in targets)\n        {\n            var prefabAsset = AssetDatabase.LoadAssetAtPath(path, typeof(GameObject)) as GameObject;\n            if (prefabAsset == null) continue;\n\n            var prefab = PrefabUtility.InstantiatePrefab(prefabAsset) as GameObject;\n            if (prefab == null) continue;\n\n            onChange(prefab);\n            PrefabUtility.ReplacePrefab(prefab, prefabAsset);    // \u53cd\u6620.\n\n            GameObject.DestroyImmediate(prefab);\n        }\n    }\n\n    // \u5b50\u3069\u3082\u306eGameObject\u3092\u8d70\u67fb\u3057\u3066\u51e6\u7406\u3092\u9069\u7528\u3059\u308b\u305f\u3081\u306e\u30d8\u30eb\u30d1.\n    public static void ScanTree(GameObject gameObj, System.Action<GameObject> onExecute)\n    {\n        if (gameObj == null) return;\n        if (onExecute == null) return;\n\n        onExecute(gameObj);\n\n        if (gameObj.transform.childCount > 0)\n        {\n            for (int i = 0; i < gameObj.transform.childCount; ++i)\n            {\n                var child = gameObj.transform.GetChild(i);\n                ScanTree(child.gameObject, onExecute);\n            }\n        }\n    }\n}\n\n\n\u4f7f\u3044\u65b9\nList<string> targets = new List<string>();\n// \u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u30d1\u30b9\u3092\u6307\u5b9a.\ntargets.Add(\"Assets/Prefabs/PrefabA.prefab\");\ntargets.Add(\"Assets/Prefabs/PrefabB.prefab\");\ntargets.Add(\"Assets/Resources/Prefabs/Prefab01.prefab\");\ntargets.Add(\"Assets/Resources/Prefabs/Prefab02.prefab\");\n\nPrefabChanger.ExecuteChange(targets, prefab => {\n    // \u65b0\u3057\u3044\u5b50\u30ce\u30fc\u30c9\u3092\u8ffd\u52a0\u3057\u3066\u3042\u3052\u305f\u308a\u3068\u304b\u3001\n    GameObject child = new GameObject();\n    child.transform.parent = prefab.transform;\n    // \u8981\u3089\u306a\u304f\u306a\u3063\u305f\u30b3\u30f3\u30dd\u30fc\u30cd\u30f3\u30c8\u3092\u524a\u9664\u3059\u308b\u3068\u304b\u3001\n    PrefabChanger.ScanTree(prefab, gameObj => {\n        GameObject.DestroyImmediate(gameObj.GetComponent<Hoge>());\n    });\n});\n\n\u5927\u91cf\u751f\u7523\u3055\u308c\u305f\u30d7\u30ec\u30cf\u30d6\u3092\u6a5f\u68b0\u7684\u306b\u3044\u3058\u308b\u6a5f\u4f1a\u304c\u3061\u3087\u3044\u3061\u3087\u3044\u3042\u308b\u306e\u3067\u66f8\u3044\u3066\u307f\u305f\u3002\n\n```csharp\npublic class PrefabChanger\n{\n    public static void ExecuteChange(List<string> targets, System.Action<GameObject> onChange)\n    {\n        if (onChange == null) return;\n\n        foreach (string path in targets)\n        {\n            var prefabAsset = AssetDatabase.LoadAssetAtPath(path, typeof(GameObject)) as GameObject;\n            if (prefabAsset == null) continue;\n\n            var prefab = PrefabUtility.InstantiatePrefab(prefabAsset) as GameObject;\n            if (prefab == null) continue;\n\n            onChange(prefab);\n            PrefabUtility.ReplacePrefab(prefab, prefabAsset);    // \u53cd\u6620.\n\n            GameObject.DestroyImmediate(prefab);\n        }\n    }\n\n    // \u5b50\u3069\u3082\u306eGameObject\u3092\u8d70\u67fb\u3057\u3066\u51e6\u7406\u3092\u9069\u7528\u3059\u308b\u305f\u3081\u306e\u30d8\u30eb\u30d1.\n    public static void ScanTree(GameObject gameObj, System.Action<GameObject> onExecute)\n    {\n        if (gameObj == null) return;\n        if (onExecute == null) return;\n\n        onExecute(gameObj);\n\n        if (gameObj.transform.childCount > 0)\n        {\n            for (int i = 0; i < gameObj.transform.childCount; ++i)\n            {\n                var child = gameObj.transform.GetChild(i);\n                ScanTree(child.gameObject, onExecute);\n            }\n        }\n    }\n}\n```\n\n\u4f7f\u3044\u65b9\n----\n\n```csharp\nList<string> targets = new List<string>();\n// \u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u30d1\u30b9\u3092\u6307\u5b9a.\ntargets.Add(\"Assets/Prefabs/PrefabA.prefab\");\ntargets.Add(\"Assets/Prefabs/PrefabB.prefab\");\ntargets.Add(\"Assets/Resources/Prefabs/Prefab01.prefab\");\ntargets.Add(\"Assets/Resources/Prefabs/Prefab02.prefab\");\n\nPrefabChanger.ExecuteChange(targets, prefab => {\n    // \u65b0\u3057\u3044\u5b50\u30ce\u30fc\u30c9\u3092\u8ffd\u52a0\u3057\u3066\u3042\u3052\u305f\u308a\u3068\u304b\u3001\n    GameObject child = new GameObject();\n    child.transform.parent = prefab.transform;\n    // \u8981\u3089\u306a\u304f\u306a\u3063\u305f\u30b3\u30f3\u30dd\u30fc\u30cd\u30f3\u30c8\u3092\u524a\u9664\u3059\u308b\u3068\u304b\u3001\n    PrefabChanger.ScanTree(prefab, gameObj => {\n        GameObject.DestroyImmediate(gameObj.GetComponent<Hoge>());\n    });\n});\n```\n", "tags": ["Unity\u62e1\u5f35", "C#"]}