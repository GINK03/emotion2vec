{"context": " More than 1 year has passed since last update.\n\n\u6982\u8981\nInternetExplorer\u3092Excel-VBA\u7d4c\u7531\u3067\u64cd\u4f5c\u3059\u308b\u30b5\u30f3\u30d7\u30eb\u3092\u8a18\u8ff0\u3059\u308b\u3002\nGoogle\u691c\u7d22\u3092\u81ea\u52d5\u3067\u884c\u3044\u3001\u691c\u7d22\u6570\u3092\u53d6\u5f97\u3057\u3066\u307f\u308b\u3002\nExcel\u5358\u4f53\u30c6\u30b9\u30c8\u4ed5\u69d8\u66f8\u3068\u306e\u9023\u643a\u304c\u5f85\u305f\u308c\u306a\u3044\u3002\n\n\u30b3\u30fc\u30c9\n\u53c2\u7167\u8a2d\u5b9a:\n  Microsoft HTML Object Library\n  Microsoft Internet Controls\n\nModule1.bat\nAttribute VB_Name = \"Module1\"\nOption Explicit\n\nPrivate Const URL_TARGET As String = \"http://google.co.jp/\"\nPrivate Const TIME_MINIMUMWAIT As Integer = 1\nPrivate Const TIME_MAXWAIT As Integer = 3\n\nPublic Sub Main()\n    Dim ie As InternetExplorer\n    Dim doc As HTMLDocument\n\n    Set ie = CreateObject(\"InternetExplorer.Application\")\n    ie.Visible = True\n\n    IENavigate ie, URL_TARGET\n\n    Set doc = ie.document\n    With doc\n        .getElementById(\"gbqfq\").Value = \"google\"\n        .getElementById(\"gbqfba\").Click\n    End With\n    IEWaitReady ie\n\n    Range(\"A1\").Value = doc.getElementById(\"resultStats\").innerText\n\n    ie.Quit\n\n    Set doc = Nothing\n    Set ie = Nothing\nEnd Sub\n\nPublic Sub IENavigate(ByRef ie As InternetExplorer, ByVal url As String)\n    ie.navigate url\n    IEWaitReady ie\n    IEWaitFor\nEnd Sub\n\nPublic Sub IEWaitReady(ByRef ie As InternetExplorer)\n    Do While ie.Busy = True Or ie.readyState <> 4\n        DoEvents\n    Loop\n    IEWaitFor\nEnd Sub\n\nPublic Sub IEWaitFor(Optional ByVal second As Integer = -1)\n    Dim endTime As Date\n\n    If (second < 0) Then\n        Do While second < TIME_MINIMUMWAIT\n            second = Int(Rnd * TIME_MAXWAIT)\n        Loop\n    End If\n\n    endTime = DateAdd(\"s\", second, Now)\n    While Now < endTime\n       DoEvents\n    Wend\nEnd Sub\n\n\n#\u6982\u8981\nInternetExplorer\u3092Excel-VBA\u7d4c\u7531\u3067\u64cd\u4f5c\u3059\u308b\u30b5\u30f3\u30d7\u30eb\u3092\u8a18\u8ff0\u3059\u308b\u3002\nGoogle\u691c\u7d22\u3092\u81ea\u52d5\u3067\u884c\u3044\u3001\u691c\u7d22\u6570\u3092\u53d6\u5f97\u3057\u3066\u307f\u308b\u3002\nExcel\u5358\u4f53\u30c6\u30b9\u30c8\u4ed5\u69d8\u66f8\u3068\u306e\u9023\u643a\u304c\u5f85\u305f\u308c\u306a\u3044\u3002\n\n#\u30b3\u30fc\u30c9\n\u53c2\u7167\u8a2d\u5b9a:\n  Microsoft HTML Object Library\n  Microsoft Internet Controls\n\n```bat:Module1.bat\nAttribute VB_Name = \"Module1\"\nOption Explicit\n  \nPrivate Const URL_TARGET As String = \"http://google.co.jp/\"\nPrivate Const TIME_MINIMUMWAIT As Integer = 1\nPrivate Const TIME_MAXWAIT As Integer = 3\n \nPublic Sub Main()\n    Dim ie As InternetExplorer\n    Dim doc As HTMLDocument\n    \n    Set ie = CreateObject(\"InternetExplorer.Application\")\n    ie.Visible = True\n    \n    IENavigate ie, URL_TARGET\n    \n    Set doc = ie.document\n    With doc\n        .getElementById(\"gbqfq\").Value = \"google\"\n        .getElementById(\"gbqfba\").Click\n    End With\n    IEWaitReady ie\n    \n    Range(\"A1\").Value = doc.getElementById(\"resultStats\").innerText\n    \n    ie.Quit\n    \n    Set doc = Nothing\n    Set ie = Nothing\nEnd Sub\n \nPublic Sub IENavigate(ByRef ie As InternetExplorer, ByVal url As String)\n    ie.navigate url\n    IEWaitReady ie\n    IEWaitFor\nEnd Sub\n \nPublic Sub IEWaitReady(ByRef ie As InternetExplorer)\n    Do While ie.Busy = True Or ie.readyState <> 4\n        DoEvents\n    Loop\n    IEWaitFor\nEnd Sub\n \nPublic Sub IEWaitFor(Optional ByVal second As Integer = -1)\n    Dim endTime As Date\n    \n    If (second < 0) Then\n        Do While second < TIME_MINIMUMWAIT\n            second = Int(Rnd * TIME_MAXWAIT)\n        Loop\n    End If\n \n    endTime = DateAdd(\"s\", second, Now)\n    While Now < endTime\n       DoEvents\n    Wend\nEnd Sub\n```", "tags": ["VBA", "Excel", "ExcelVBA", "TDD", "IE"]}