{"context": "Erlang\u306e\u5024\u306f\u4e0d\u5909\uff08immutable\uff09\u3067\u3059\u3002\n\u3053\u306e\u4e0d\u5909\u3068\u3044\u3046\u306e\u306f\u3001Erlang\u3092\u5229\u7528\u3059\u308b\u5074\u304b\u3089\u306f\u4e0d\u5909\u306b\u898b\u3048\u308b\u3068\u3044\u3046\u3060\u3051\u306e\u8a71\u3067\u3059\u3002\n\u5b9f\u969b\u306e\u3068\u3053\u308dErlang\u306f\u3001\u4e00\u5ea6\u751f\u6210\u3057\u305f\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306e\u5024\u3092\u30ac\u30f3\u30ac\u30f3\u66f8\u304d\u63db\u3048\u307e\u3059\u30021\nErlang\u30d0\u30a4\u30ca\u30ea\u3082\u305d\u306e\u5bfe\u8c61\u3067\u3042\u308a\u3001\u5916\u304b\u3089\u898b\u3066\u308b\u9650\u308a\u3067\u306f\u64cd\u4f5c\u3092\u52a0\u3048\u308b\u5ea6\u306b\u30b3\u30d4\u30fc\u3057\u3066\u3044\u308b\u3088\u3046\u306b\u898b\u3048\u307e\u3059\u304c\u3001\u5185\u90e8\u3067\u306f\u5168\u304f\u7570\u306a\u308b\u52d5\u4f5c\u306b\u306a\u3063\u3066\u3044\u307e\u3059\u3002\n\u7279\u306b\u3001\u30d0\u30a4\u30ca\u30ea\u306e\u5f8c\u65b9\u306b\u5024\u3092\u8ffd\u52a0\u3059\u308b\u969b\u306b\u306f\u3068\u3066\u3082\u826f\u3044\u30d1\u30d5\u30a9\u30fc\u30de\u30f3\u30b9\u3092\u767a\u63ee\u3059\u308b\u3088\u3046\u306b\u6700\u9069\u5316\u3055\u308c\u3066\u3044\u307e\u3059\u3002\n\u4eca\u56de\u306f\u3001Erlang\u306e\u30d0\u30a4\u30ca\u30ea\u304c\u5185\u90e8\u7684\u306b\u3069\u306e\u3088\u3046\u306a\u69cb\u9020\u306b\u306a\u3063\u3066\u3044\u308b\u304b\u3068\u3001\u30d0\u30a4\u30ca\u30ea\u3092\u5f8c\u65b9\u306b\u8ffd\u52a0\u3059\u308b\u6642\u306b\u305d\u308c\u3089\u304c\u3069\u306e\u3088\u3046\u306a\u6319\u52d5\u306b\u306a\u308b\u304b\u3092\u8aac\u660e\u3057\u307e\u3059\u3002\n\u306a\u304a\u3001\u4eca\u56de\u306e\u8a71\u306f Erlang -- Constructing and Matching Binaries \u306e 4.2  Constructing Binaries \u3092\u6df1\u304f\u6398\u308a\u4e0b\u3052\u305f\u5185\u5bb9\u306b\u306a\u3063\u3066\u3044\u307e\u3059\u3002\n\nErlang\u30d0\u30a4\u30ca\u30ea\u306e\u7a2e\u985e\nErlang\u306e\u30d0\u30a4\u30ca\u30ea\u306f\u3001\u5185\u90e8\u7684\u306b\u306f\uff14\u7a2e\u985e\u3042\u308a\u307e\u3059\u3002\nHeapBin, ProcBin, SubBin, BinMatchState \u3067\u3059\u3002\nBinMatchState \u306f\u3001\u4eca\u56de\u306e\u8a71\u3067\u306f\u4f7f\u308f\u306a\u3044\u306e\u3067\u7701\u3044\u3066\u3044\u307e\u3059\u3002\n\nHeapBin\n\nHeapBin\u306f\u3001\u5c0f\u3055\u3044\u30d0\u30a4\u30ca\u30ea\uff0864\u30d0\u30a4\u30c8\u4ee5\u4e0b\uff09\u3092\u683c\u7d0d\u3059\u308b\u969b\u306b\u4f7f\u3044\u307e\u3059\u3002\n2\u30ef\u30fc\u30c9+data\u30d0\u30a4\u30c8\u5206\u3057\u304b\u5bb9\u91cf\u3092\u53d6\u3089\u306a\u3044\u306e\u3067\u7701\u30e1\u30e2\u30ea\u3067\u3059\u3002\n\u307e\u305f\u3001HeapBin\u306e\u4e2d\u306b\u5b9f\u30c7\u30fc\u30bf\u304c\u683c\u7d0d\u3055\u308c\u3066\u3044\u3066\u30c7\u30ea\u30d5\u30a1\u30ec\u30f3\u30b9\u4e0d\u8981\u3067\u3042\u308b\u305f\u3081\u3001\u30a2\u30af\u30bb\u30b9\u306f\u9ad8\u901f\u3067\u3059\u3002\nthing_word\u3068\u3044\u3046\u306e\u306f\u3001\u30d0\u30a4\u30ca\u30ea\u3092\u7a2e\u5225\u3059\u308b\u305f\u3081\u306e\u30bf\u30b01\u3067\u3059\u3002\nsize\u306f\u5b9f\u30c7\u30fc\u30bf\u306e\u30d0\u30a4\u30c8\u6570\u3067\u3059\u3002\n\nProcBin\n\nProcBin\u306f\u3001\u5b9f\u30c7\u30fc\u30bf\u3092\u683c\u7d0d\u3059\u308b\u305f\u3081\u306eBinary\u3068\u3001\u305d\u308c\u3092\u53c2\u7167\u3059\u308bProcBin\u306e\uff12\u3064\u306b\u5206\u304b\u308c\u3066\u3044\u307e\u3059\u3002\nHeapBin\u306b\u53ce\u307e\u3089\u306a\u3044\u3001\u5927\u304d\u3044\u30d0\u30a4\u30ca\u30ea\u3092\u6271\u3046\u969b\u306b\u4f7f\u3044\u307e\u3059\u3002\nProcBin\u304c6\u30ef\u30fc\u30c9\u3001Binary\u304c3\u30ef\u30fc\u30c9+orig_bytes\u30d0\u30a4\u30c8\u5206\u53d6\u308b\u306e\u3067\u3001\u305d\u3053\u305d\u3053\u30e1\u30e2\u30ea\u3092\u4f7f\u3044\u307e\u3059\u3002\n\u307e\u305f\u3001\uff12\u3064\u306e\u8981\u7d20\u306b\u5206\u304b\u308c\u3066\u3044\u308b\u305f\u3081\u3001\u30a2\u30af\u30bb\u30b9\u306f\u305d\u3053\u307e\u3067\u65e9\u304f\u3042\u308a\u307e\u305b\u3093\u3002\n\u305f\u3060\u3057\u3001Binary\u306f\u5168\u30d7\u30ed\u30bb\u30b9\u304c\u5171\u6709\u3057\u3066\u3044\u308b\u5171\u6709\u30d2\u30fc\u30d7\u4e0a\u306b\u683c\u7d0d\u3055\u308c\u307e\u3059\u3002\n\u305d\u306e\u305f\u3081\u3001\u30e1\u30c3\u30bb\u30fc\u30b8\u30d1\u30c3\u30b7\u30f3\u30b0\u306e\u969b\u306b\u3053\u306e\u30d0\u30a4\u30ca\u30ea\u3092\u30b3\u30d4\u30fc\u3059\u308b\u5fc5\u8981\u304c\u7121\u304f\u306a\u308b\u306e\u304c\u30e1\u30ea\u30c3\u30c8\u3067\u3059\u3002\norig_bytes\u304c\u5b9f\u30c7\u30fc\u30bf\u3092\u683c\u7d0d\u3059\u308b\u305f\u3081\u306e\u9818\u57df\u3067\u3001\u305d\u306e\u9818\u57df\u306e\u30d0\u30a4\u30c8\u6570\u304corig_size\u306b\u683c\u7d0d\u3055\u308c\u3066\u3044\u307e\u3059\u3002\nsize\u306b\u306f\u3001orig_bytes\u306e\u9818\u57df\u306e\u3046\u3061\u3001\u73fe\u5728\u4f55\u30d0\u30a4\u30c8\u3092\u4f7f\u3063\u3066\u3044\u308b\u304b\u3068\u3044\u3046\u5024\u3092\u683c\u7d0d\u3057\u3066\u3044\u307e\u3059\u3002\n\u306a\u304a\u3001\u4eca\u56de\u306e\u8aac\u660e\u3067\u4f7f\u308f\u306a\u3044\u90e8\u5206\u306f\u7070\u8272\u306e\u6587\u5b57\u306b\u3057\u3066\u3044\u307e\u3059\u3002\n\nSubBin\n\nSubBin\u306f\u3001HeapBin\u3084ProcBin\u306e\u4e00\u90e8\u3092\u53c2\u7167\u3059\u308b\u969b\u306b\u4f7f\u3044\u307e\u3059\u3002\norig\u306f\u3001HeapBin\u304bProcBin\u306e\u3069\u3061\u3089\u304b\u3092\u6307\u3057\u3066\u3044\u3066\u3001orig\u306e\u6307\u3059\u5148\u306b\u3042\u308b\u5b9f\u30c7\u30fc\u30bf\u306e\u3001off\u30d0\u30a4\u30c8\u304b\u3089off + size\u30d0\u30a4\u30c8\u307e\u3067\u3092\u5b9f\u30c7\u30fc\u30bf\u3068\u3057\u3066\u6271\u3044\u307e\u3059\u3002\norig\u304cProcBin\u3092\u6307\u3057\u3066\u3044\u308b\u5834\u5408\u3001\u5b9f\u30c7\u30fc\u30bf\u306b\u30a2\u30af\u30bb\u30b9\u3059\u308b\u305f\u3081\u306b\u9593\u63a5\u53c2\u7167\u304c\uff12\u56de\u5fc5\u8981\u306b\u306a\u308b\u305f\u3081\u3001\u9045\u304f\u306a\u308a\u307e\u3059\u3002\n\u305f\u3060\u3057\u3001\u5b9f\u30c7\u30fc\u30bf\u306e\u5168\u90e8\u307e\u305f\u306f\u4e00\u90e8\u3092\u4ed6\u306e\u30d0\u30a4\u30ca\u30ea\u3068\u5171\u6709\u3067\u304d\u308b\u305f\u3081\u3001\u7701\u30e1\u30e2\u30ea\u306b\u306a\u308b\u3057\u3001\u69cb\u7bc9\u3082\u30b3\u30d4\u30fc\u304c\u4e0d\u8981\u306a\u5206\u3001\u9ad8\u901f\u306b\u306a\u308a\u307e\u3059\u3002\nis_writable\u30d5\u30e9\u30b0\u306f\u3001\u3053\u306e\u30d0\u30a4\u30ca\u30ea\u306b\u5024\u3092\u8ffd\u52a0\u3059\u308b\u969b\u306b\u3001\u65e2\u5b58\u306e\u5b9f\u30c7\u30fc\u30bf\u306b\u8ffd\u52a0\u3057\u3066\u3044\u3044\u304b\u3069\u3046\u304b\u3092\u5224\u65ad\u3059\u308b\u305f\u3081\u306e\u30d5\u30e9\u30b0\u3067\u3059\u3002\n\u306a\u304a\u3001bitoff\u3084bitsize\u3068\u3044\u3046\u30d5\u30a3\u30fc\u30eb\u30c9\u304cis_writable\u3068\u540c\u3058\u30ef\u30fc\u30c9\u306e\u5834\u6240\u306b\u3042\u308b\u306e\u3067\u3059\u304c\u3001\u56f3\u306b\u5165\u308c\u308b\u306e\u304c\u9762\u5012\u3060\u3063\u305f\u306e\u3067\u7701\u3044\u3066\u3044\u307e\u3059\u3002\n\u3053\u308c\u3089\u306e\u30d5\u30a3\u30fc\u30eb\u30c9\u306f\u30d3\u30c3\u30c8\u3092\u6271\u3046\u6642\u306b\u5fc5\u8981\u306a\u30d5\u30a3\u30fc\u30eb\u30c9\u3067\u3001\u3053\u308c\u3092\u6301\u3063\u3066\u3044\u308b\u306e\u306fSubBin\u3060\u3051\u3067\u3042\u308b\u305f\u3081\u3001\u30d3\u30c3\u30c8\u30ec\u30d9\u30eb\u3067\u30d0\u30a4\u30ca\u30ea\u3092\u6271\u3046\u969b\u306b\u306f\u5fc5\u305aSubBin\u306b\u306a\u308a\u307e\u3059\u3002\n\n\u30d0\u30a4\u30ca\u30ea\u306b\u5024\u3092\u8ffd\u52a0\u3059\u308b\n\u30d0\u30a4\u30ca\u30ea\u306b\u5024\u3092\u8ffd\u52a0\u3059\u308b\u3068\u3044\u3046\u51e6\u7406\u306f\u3001\u983b\u7e41\u306b\u51fa\u73fe\u3057\u307e\u3059\u3002\n\u4f8b\u3048\u3070 Erlang -- Constructing and Matching Binaries \u3067\u306f\u3001\u4ee5\u4e0b\u306e\u4f8b\u304c\u8f09\u3063\u3066\u3044\u307e\u3059\u3002\nmy_list_to_binary(List) ->\n    my_list_to_binary(List, <<>>).\n\nmy_list_to_binary([H|T], Acc) ->\n    my_list_to_binary(T, <<Acc/binary,H>>);\nmy_list_to_binary([], Acc) ->\n    Acc.\n\n\u3053\u306e\u3088\u3046\u306a\u30b3\u30fc\u30c9\u306f\u3088\u304f\u66f8\u304f\u3053\u3068\u306b\u306a\u308b\u305f\u3081\u3001Erlang\u306f\u305d\u306e\u51e6\u7406\u306e\u305f\u3081\u306b\u6700\u9069\u5316\u3057\u3066\u3044\u307e\u3059\u3002\n\u826f\u3044\u30d1\u30d5\u30a9\u30fc\u30de\u30f3\u30b9\u3092\u4efb\u610f\u306b\u5f15\u304d\u51fa\u305b\u308b\u3088\u3046\u306b\u3059\u308b\u305f\u3081\u306b\u3001\u3053\u306e\u6700\u9069\u5316\u304c\u3069\u306e\u3088\u3046\u306b\u52d5\u3044\u3066\u3044\u308b\u306e\u304b\u3092\u77e5\u3063\u3066\u304a\u304f\u306e\u306f\u91cd\u8981\u3067\u3057\u3087\u3046\u3002\n\n\u6226\u7565\n\u57fa\u672c\u7684\u306b\u306f\u3001\u30d0\u30a4\u30ca\u30ea\u306b\u5024\u3092\u8ffd\u52a0\u3059\u308b\u969b\u306b\u78ba\u4fdd\u3059\u308b\u969b\u306b\u3001\u30e1\u30e2\u30ea\u306f\u4f59\u5206\u306b\u78ba\u4fdd\u3057\u3066\u304a\u304f \u3068\u3044\u3046\u6226\u7565\u306b\u306a\u308a\u307e\u3059\u3002\n\u305d\u3046\u3059\u308c\u3070\u3001\u6b21\u306e\u5024\u306e\u8ffd\u52a0\u3067\u306f\u3001\u4f59\u5206\u306b\u78ba\u4fdd\u3057\u3066\u304a\u3044\u305f\u9818\u57df\u306b\u5024\u3092\u8ffd\u52a0\u3059\u308c\u3070\u3044\u3044\u3060\u3051\u306a\u306e\u3067\u3001\u8ffd\u52a0\u3059\u308b\u64cd\u4f5c\u3092\u3059\u308b\u5ea6\u306b\u65b0\u3057\u304f\u30e1\u30e2\u30ea\u3092\u78ba\u4fdd\u3059\u308b\u3001\u3068\u3044\u3046\u3053\u3068\u304c\u4e0d\u8981\u306b\u306a\u308a\u307e\u3059\u3002\n\u305f\u3060\u3057\u3001\u5916\u304b\u3089\u898b\u305f\u969b\u306b\u4e0d\u5909\u306b\u898b\u3048\u306a\u3051\u308c\u3070\u306a\u3089\u306a\u3044 \u3068\u3044\u3046\u524d\u63d0\u304c\u3042\u308a\u307e\u3059\u3002\n\u305d\u306e\u305f\u3081\u3001\u3044\u3064\u3067\u3082\u7a7a\u304d\u9818\u57df\u306b\u5024\u3092\u8ffd\u52a0\u3057\u3066\u826f\u3044\u3068\u3044\u3046\u8a33\u3067\u306f\u3042\u308a\u307e\u305b\u3093\u3002\n\u305d\u306e\u8fba\u3092\u3046\u307e\u304f\u3084\u308d\u3046\u3068\u3059\u308b\u3068\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\n\n\u5177\u4f53\u7684\u306a\u624b\u9806\n\u5177\u4f53\u7684\u306a\u624b\u9806\u3092\u6587\u5b57\u3067\u66f8\u304f\u3068\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\nA\u3068\u3044\u3046\u30d0\u30a4\u30ca\u30ea\u306bB\u3068\u3044\u3046\u5024\u3092\u8ffd\u52a0\u3059\u308b\u6642\u3001\n\n\nA\u306b\u8ffd\u8a18\u4e0d\u53ef\u306e\u5834\u5408:\n\n\uff08\u3064\u307e\u308aA\u304cHeapBin \u307e\u305f\u306f\u3001A\u304cProcBin \u307e\u305f\u306f\u3001A\u304cSubBin\u304b\u3064is_writable==0\u306e\u5834\u5408\uff09\nN\u30d0\u30a4\u30c8\u306eBinary\u3092\u53c2\u7167\u3059\u308bProcBin\u3092\u4f5c\u308b\n\n\nN: A\u3068B\u306e\u30b5\u30a4\u30ba\u306e\uff12\u500d\u3002\u305f\u3060\u3057\u305d\u308c\u304c256\u3088\u308a\u5c0f\u3055\u3051\u308c\u3070256\n\n\n\u65b0\u3057\u3044SubBin\u3092\u751f\u6210\u3057\u3001is_writable\u30921\u306b\u3057\u3066\u3001\u305d\u306eProcBin\u3092\u53c2\u7167\u3059\u308b\n\n\n\nA\u306b\u8ffd\u8a18\u53ef\u80fd\u306a\u5834\u5408:\n\n\uff08\u3064\u307e\u308aA\u304cSubBin\u304b\u3064is_writable==1\u306e\u5834\u5408\uff09\nA\u306eis_writable\u30920\u306b\u3059\u308b\nB\u306e\u30b5\u30a4\u30ba\u3092\u8db3\u3059\u3068\u3001Binary\u306eorig_size\u306e\u30b5\u30a4\u30ba\u3092\u8d85\u3048\u3066\u3057\u307e\u3046\u5834\u5408:\n\n\nN\u30d0\u30a4\u30c8\u306e\u9818\u57df\u3092\u6301\u3064\u3088\u3046\u306bBinary\u3092realloc\u3057\u3001ProcBin\u306f\u305d\u306eBinary\u3092\u6307\u3059\u3088\u3046\u306b\u3059\u308b\n\n\nN: A\u3068B\u306e\u30b5\u30a4\u30ba\u306e\uff12\u500d\u3002\u305f\u3060\u3057\u305d\u308c\u304c256\u3088\u308a\u5c0f\u3055\u3051\u308c\u3070256\n\n\n\n\n\u65b0\u3057\u3044SubBin\u3092\u751f\u6210\u3057\u3001is_writable\u30921\u306b\u3057\u3066\u3001ProcBin\u3092\u53c2\u7167\u3059\u308b\n\n\n\u5f97\u3089\u308c\u305fSubBin\u306e\u6307\u3059\u30d0\u30a4\u30ca\u30ea\u306bB\u306e\u5185\u5bb9\u3092\u66f8\u304d\u8fbc\u3080\n\n\u3068\u3044\u3046\u52d5\u4f5c\u306b\u306a\u308a\u307e\u3059\u30022\n\u6587\u5b57\u3060\u3068\u5206\u304b\u308a\u306b\u304f\u3044\u306e\u3067\u3001\u5177\u4f53\u7684\u306a\u51e6\u7406\u304b\u3089\u56f3\u3092\u66f8\u3044\u3066\u3044\u304d\u307e\u3059\u3002\n%% A. \u521d\u671f\u5316\nA = binary:copy(<<1, 2, 3>>),\n\n%% B. A\u306b3\u30d0\u30a4\u30c8\u8ffd\u52a0\nB = <<A/binary, 4, 5, 6>>,\n\n%% C. B\u306b3\u30d0\u30a4\u30c8\u8ffd\u52a0\nC = <<B/binary, 7, 8, 9>>,\n\n%% D. C\u306b3\u30d0\u30a4\u30c8\u8ffd\u52a0\nD = <<C/binary, 10, 11, 12>>,\n\n%% E. D\u306b1000\u30d0\u30a4\u30c8\u8ffd\u52a0\nE = <<D/binary, (binary:copy(<<100>>, 1000))/binary>>,\n\n%% F. D\u306b3\u30d0\u30a4\u30c8\u8ffd\u52a0\nF = <<D/binary, 13, 14, 15>>,\n\n\u3053\u306e\u3088\u3046\u306a\u30b3\u30fc\u30c9\u3092\u66f8\u3044\u305f\u5834\u5408\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u52d5\u4f5c\u306b\u306a\u308a\u307e\u3059\u3002\n\nA. \u521d\u671f\u5316\nA = binary:copy(<<1, 2, 3>>),\n\n\u7d50\u679c:\n\n\u3053\u308c\u306f\u8981\u7d20\u306e\u8ffd\u52a0\u3067\u306f\u306a\u304f\u3001\u5358\u306b\u65b0\u3057\u304f\u30d0\u30a4\u30ca\u30ea\u3092\u751f\u6210\u3059\u308b\u51e6\u7406\u306b\u306a\u308a\u307e\u3059\u3002\n64\u30d0\u30a4\u30c8\u4ee5\u4e0b\u306e\u30d0\u30a4\u30ca\u30ea\u3067\u3042\u308b\u305f\u3081\u3001HeapBin\u3092\u751f\u6210\u3057\u307e\u3059\u3002\n\u307e\u305f\u3001\u65b0\u3057\u304f\u751f\u6210\u3055\u308c\u305f\u308a\u3001\u66f8\u304d\u63db\u308f\u3063\u305f\u8981\u7d20\u306f\u8272\u3092\u5909\u3048\u308b\u3088\u3046\u306b\u3057\u3066\u3044\u307e\u3059\u3002\uff08\u305f\u3060\u3057thing_word\u3092\u9664\u304f\uff09\n\u306a\u304a\u3001\u5024\u3092\u8ffd\u52a0\u3059\u308b\u6642\u306bbinary:copy/1\u3067<<1, 2, 3>>\u3092\u30b3\u30d4\u30fc\u3057\u3066\u3044\u308b\u306e\u306f\u3001\u5b9a\u6570\u7573\u307f\u8fbc\u307f\u306e\u6700\u9069\u5316\u3092\u6291\u5236\u3059\u308b\u305f\u3081\u3067\u3059\u3002\nBEAM\u306e\u95a2\u6570\u3092\u30c7\u30a3\u30b9\u30a2\u30bb\u30f3\u30d6\u30eb\u3059\u308b\u3067\u66f8\u3044\u305f\u3088\u3046\u306b\u3001\u5358\u306b<<1, 2, 3>>\u3068\u66f8\u304f\u3060\u3051\u3060\u3068\u5168\u3066\u7573\u307f\u8fbc\u307e\u308c\u3066\u610f\u56f3\u3057\u305f\u52d5\u4f5c\u3092\u3057\u307e\u305b\u3093\u3002\n\u3064\u307e\u308a\u3001\u5c11\u306a\u304f\u3068\u3082 OTP 19.2 \u306b\u304a\u3044\u3066\u3001 Erlang -- Constructing and Matching Binaries \u306e 4.2  Constructing Binaries \u306b\u3042\u308b\u4f8b\u306f\u8aac\u660e\u306e\u901a\u308a\u306e\u52d5\u4f5c\u3092\u3057\u307e\u305b\u3093\u3002\n\nB. A\u306b3\u30d0\u30a4\u30c8\u8ffd\u52a0\nB = <<A/binary, 4, 5, 6>>,\n\n\u7d50\u679c:\n\nA\u306fHeapBin\u3067\u3042\u308b\u305f\u3081\u3001\u8ffd\u8a18\u4e0d\u53ef\u3067\u3059\u3002\n\u305d\u306e\u305f\u3081\u65b0\u3057\u304f\u30d0\u30a4\u30ca\u30ea\u3092\u751f\u6210\u3057\u307e\u3059\u3002\n\u3053\u306e\u6642\u3001Binary\u306eorig_bytes\u306e\u9818\u57df\u3068\u3057\u3066 256\u30d0\u30a4\u30c8\u78ba\u4fdd\u3057\u307e\u3059\u3002\n\u5b9f\u969b\u5229\u7528\u3059\u308b\u9818\u57df\u306f6\u30d0\u30a4\u30c8\u3067\u3042\u308b\u305f\u3081\u3001ProcBin:size\u306b\u306f6\u3092\u5165\u308c\u307e\u3059\u3002\n\u3064\u307e\u308aBinary\u306eorig_bytes\u306f\u3001250\u30d0\u30a4\u30c8\u304c\u672a\u4f7f\u7528\u9818\u57df\u306b\u306a\u308a\u307e\u3059\u3002\n\u307e\u305f\u3001SubBin:size\u3084SubBin:off\u306b\u3082\u5024\u3092\u8a2d\u5b9a\u3057\u3001is_writable\u30921\u306b\u3057\u307e\u3059\u3002\n\u3053\u308c\u306b\u3088\u3063\u3066\u3001\u6b21\u306e\u66f8\u304d\u8fbc\u307f\u3067\u8ffd\u8a18\u304c\u53ef\u80fd\u306b\u306a\u308a\u307e\u3059\u3002\n\nC. B\u306b3\u30d0\u30a4\u30c8\u8ffd\u52a0\nC = <<B/binary, 7, 8, 9>>,\n\n\u7d50\u679c:\n\nB\u306fSubBin\u304b\u3064is_writable\u304c1\u3067\u3042\u308b\u305f\u3081\u3001\u8ffd\u8a18\u53ef\u80fd\u3067\u3059\u3002\n\u305d\u306e\u305f\u3081\u3001\u65b0\u3057\u3044\u30d0\u30a4\u30ca\u30ea\u3092\u78ba\u4fdd\u3059\u308b\u3053\u3068\u306a\u304f\u3001C\u306e\u5185\u5bb9\u304cB->orig->bytes->orig_bytes\u306b\u8ffd\u52a0\u3055\u308c\u307e\u3059\u3002\n\u4f7f\u7528\u30b5\u30a4\u30ba\u304c\u5897\u3048\u305f\u306e\u3067\u3001B->orig->size\u30926\u304b\u30899\u306b\u3057\u307e\u3059\u3002\n\u307e\u305f\u3001B->is_writable\u306f0\u306b\u66f8\u304d\u63db\u3048\u307e\u3059\u3002\nC\u306e\u305f\u3081\u306b\u65b0\u3057\u304fSubBin\u3092\u751f\u6210\u3057\u3001orig_bytes\u306e[1..9]\u30d0\u30a4\u30c8\u3092\u53c2\u7167\u3059\u308b\u3088\u3046\u306b\u3057\u307e\u3059\u3002\nis_writable\u306f1\u306b\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n\u3053\u306e\u6642\u3001ProcBin\u306f9\u30d0\u30a4\u30c8\u4f7f\u7528\u3057\u3066\u3044\u308b\u3001\u3068\u30de\u30fc\u30af\u3057\u3066\u3044\u307e\u3059\u304c\u3001B\u306fSubBin\u3067\u3042\u308a\u3001[1..6]\u30d0\u30a4\u30c8\u3092\u5229\u7528\u3059\u308b\u3053\u3068\u306b\u306a\u3063\u3066\u3044\u308b\u305f\u3081\u3001B\u306e\u6307\u3057\u3066\u3044\u308b\u5185\u5bb9\u306f\u5909\u308f\u3063\u3066\u3044\u307e\u305b\u3093\u3002\n\u305d\u306e\u305f\u3081\u4e0d\u5909\u6027\u306f\u5b88\u3089\u308c\u3066\u3044\u307e\u3059\u3002\n\nD. C\u306b3\u30d0\u30a4\u30c8\u8ffd\u52a0\nD = <<C/binary, 10, 11, 12>>,\n\n\u7d50\u679c:\n\n\u5148\u307b\u3069\u3068\u540c\u3058\u3067\u3059\u3002A\u306f\u3082\u3046\u8aac\u660e\u3059\u308b\u4e0a\u3067\u4f7f\u308f\u306a\u3044\u306e\u3067\u975e\u8868\u793a\u306b\u3057\u307e\u3057\u305f\u3002\nC\u306fSubBin\u304b\u3064is_writable\u304c1\u3067\u3042\u308b\u305f\u3081\u3001\u8ffd\u8a18\u53ef\u80fd\u3067\u3059\u3002\n\u305d\u306e\u305f\u3081\u3001\u65b0\u3057\u3044\u30d0\u30a4\u30ca\u30ea\u3092\u78ba\u4fdd\u3059\u308b\u3053\u3068\u306a\u304f\u3001D\u306e\u5185\u5bb9\u304cC->orig->bytes->orig_bytes\u306b\u8ffd\u52a0\u3055\u308c\u307e\u3059\u3002\n\u4f7f\u7528\u30b5\u30a4\u30ba\u304c\u5897\u3048\u305f\u306e\u3067\u3001C->orig->size\u30929\u304b\u308912\u306b\u3057\u307e\u3059\u3002\n\u307e\u305f\u3001C->is_writable\u306f0\u306b\u66f8\u304d\u63db\u3048\u307e\u3059\u3002\nD\u306e\u305f\u3081\u306b\u65b0\u3057\u304fSubBin\u3092\u751f\u6210\u3057\u3001orig_bytes\u306e[1..12]\u30d0\u30a4\u30c8\u3092\u53c2\u7167\u3059\u308b\u3088\u3046\u306b\u3057\u307e\u3059\u3002\nis_writable\u306f1\u306b\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n\u3053\u306e\u6642\u3001Binary\u3084ProcBin\u306f12\u30d0\u30a4\u30c8\u4f7f\u7528\u3057\u3066\u3044\u308b\u3001\u3068\u30de\u30fc\u30af\u3057\u3066\u3044\u307e\u3059\u304c\u3001C\u306fSubBin\u3067\u3042\u308a\u3001[1..9]\u30d0\u30a4\u30c8\u3092\u5229\u7528\u3059\u308b\u3053\u3068\u306b\u306a\u3063\u3066\u3044\u308b\u305f\u3081\u3001C\u306e\u5185\u5bb9\u306f\u5909\u308f\u3063\u3066\u3044\u307e\u305b\u3093\u3002\n\u305d\u306e\u305f\u3081\u4e0d\u5909\u6027\u306f\u5b88\u3089\u308c\u3066\u3044\u307e\u3059\u3002\n\nE. D\u306b1000\u30d0\u30a4\u30c8\u8ffd\u52a0\nE = <<D/binary, (binary:copy(<<100>>, 1000))/binary>>,\n\n\u7d50\u679c:\n\nBinary\u306e\u4f59\u5206\u306a\u9818\u57df\u3092\u8d85\u3048\u308b\u30b5\u30a4\u30ba\u3092\u8ffd\u52a0\u3059\u308b\u3068\u3069\u3046\u306a\u308b\u304b\u3001\u3068\u3044\u3046\u5b9f\u9a13\u3067\u3059\u3002\nD\u306fSubBin\u304b\u3064is_writable\u304c1\u3067\u3042\u308b\u305f\u3081\u3001\u8ffd\u8a18\u53ef\u80fd\u3067\u3059\u3002\n\u3057\u304b\u3057 D->orig->bytes->orig_bytes \u306e\u9818\u57df\u306b\u306f1000\u30d0\u30a4\u30c8\u306e\u4f59\u5206\u306a\u9818\u57df\u306f\u3042\u308a\u307e\u305b\u3093\u3002\n\u305d\u306e\u305f\u3081 D->orig->bytes\u306e\u6307\u3059Binary\u3092realloc\u3057\u3066\u3001\u65b0\u3057\u304fBinary\u3092\u751f\u6210\u3057\u307e\u3059\u3002\n\u3053\u306e\u6642orig_bytes\u306e\u9818\u57df\u306f\u3001\u65b0\u3057\u304f\u5fc5\u8981\u306a\u9818\u57df\u306e\uff12\u500d\u3001\u3064\u307e\u308a1012*2\u306e2024\u30d0\u30a4\u30c8\u306b\u306a\u308a\u307e\u3059\u3002\nD->orig->bytes\u306f\u65b0\u3057\u304f\u751f\u6210\u3057\u305f\u9818\u57df\u3092\u6307\u3059\u3088\u3046\u306b\u5207\u308a\u66ff\u3048\u3001\u4f7f\u7528\u30b5\u30a4\u30ba\u30921024\u30d0\u30a4\u30c8\u306b\u3057\u307e\u3059\u3002\n\u307e\u305f\u3001D->is_writable\u306f0\u306b\u3057\u3066\u304a\u304d\u307e\u3059\u3002\nE\u306e\u305f\u3081\u306b\u65b0\u3057\u304fSubBin\u3092\u751f\u6210\u3057\u3001orig_bytes\u306e[1..1012]\u30d0\u30a4\u30c8\u3092\u53c2\u7167\u3059\u308b\u3088\u3046\u306b\u3057\u307e\u3059\u3002\nis_writable\u306f1\u306b\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n\u3053\u306e\u6642\u3001Binary\u3084ProcBin\u306f1024\u30d0\u30a4\u30c8\u4f7f\u7528\u3057\u3066\u3044\u308b\u3001\u3068\u30de\u30fc\u30af\u3057\u3066\u3044\u307e\u3059\u304c\u3001D\u306fSubBin\u3067\u3042\u308a\u3001[1..12]\u30d0\u30a4\u30c8\u3092\u5229\u7528\u3059\u308b\u3053\u3068\u306b\u306a\u3063\u3066\u3044\u308b\u305f\u3081\u3001D\u306e\u5185\u5bb9\u306f\u5909\u308f\u3063\u3066\u3044\u307e\u305b\u3093\u3002\n\u305d\u306e\u305f\u3081\u4e0d\u5909\u6027\u306f\u5b88\u3089\u308c\u3066\u3044\u307e\u3059\u3002\n\nF. D\u306b3\u30d0\u30a4\u30c8\u8ffd\u52a0\nF = <<D/binary, 13, 14, 15>>,\n\n\n\u4eca\u5ea6\u306f\u3001E\u3067\u306f\u306a\u304f\u3001D\u306b3\u30d0\u30a4\u30c8\u8ffd\u52a0\u3057\u3066\u3044\u307e\u3059\u3002B, C\u306f\u3082\u3046\u8aac\u660e\u3059\u308b\u4e0a\u3067\u306f\u4f7f\u308f\u306a\u3044\u306e\u3067\u975e\u8868\u793a\u306b\u3057\u307e\u3057\u305f\u3002\nD\u306fSubBin\u3067\u3059\u304c\u3001\u65e2\u306bis_writable\u304c0\u306a\u306e\u3067\u3001\u8ffd\u8a18\u4e0d\u53ef\u3067\u3059\u3002\n\u305d\u306e\u305f\u3081\u3001F\u306e\u305f\u3081\u306b\u65b0\u3057\u304fBinary, ProcBin, SubBin\u3092\u751f\u6210\u3057\u307e\u3059\u3002\n\u3053\u306e\u6642\u3001Binary\u306eorig_bytes\u306e\u9818\u57df\u3068\u3057\u3066256\u30d0\u30a4\u30c8\u78ba\u4fdd\u3057\u307e\u3059\u3002\nBinary\u306b\u306f\u3001D->orig->bytes\u306e\u6307\u3059\u9818\u57df\u304b\u3089[1..12]\u30d0\u30a4\u30c8\u3092\u30b3\u30d4\u30fc\u3057\u3001\u65b0\u3057\u3044\u8981\u7d20\u306e3\u30d0\u30a4\u30c8\u3092\u8ffd\u52a0\u3067\u66f8\u304d\u8fbc\u307f\u3001\u5408\u8a08\u306e\u4f7f\u7528\u9818\u57df\u306f15\u30d0\u30a4\u30c8\u3068\u306a\u308a\u307e\u3059\u3002\n\u3082\u3057\u3053\u3053\u3067D\u306eis_writable\u3092\u8003\u616e\u3057\u306a\u304b\u3063\u305f\u5834\u5408\u3001D->orig->bytes\u306e\u6307\u3059\u9818\u57df\u304c\u66f8\u304d\u63db\u3048\u3089\u308c\u308b\u3053\u3068\u306b\u306a\u308a\u3001E\u306e\u4e0d\u5909\u6027\u304c\u5d29\u308c\u308b\u3053\u3068\u306b\u6ce8\u610f\u3057\u3066\u4e0b\u3055\u3044\u3002\nis_writable\u3092\u4f7f\u3063\u3066\u65b0\u3057\u3044\u9818\u57df\u3092\u78ba\u4fdd\u3055\u305b\u308b\u3053\u3068\u3067\u3001\u305d\u306e\u3088\u3046\u306a\u308b\u306e\u3092\u9632\u3044\u3067\u3044\u307e\u3059\u3002\n\n\u307e\u3068\u3081\n\u91cd\u8981\u306a\u306e\u306f\u3001\n\nSubBin\u3092\u3046\u307e\u304f\u4f7f\u3063\u3066\u30d0\u30a4\u30ca\u30ea\u3092\u5171\u6709\u3059\u308b\u3053\u3068\u3067\u3001\u7701\u30e1\u30e2\u30ea\u30fb\u69cb\u7bc9\u306e\u9ad8\u901f\u5316\u3092\u3057\u3066\u3044\u308b\u3002\n\nis_writable\u304c1\u306e\u6642\u306f\u30d0\u30a4\u30ca\u30ea\u306e\u5f8c\u65b9\u306b\u8ffd\u8a18\u53ef\u80fd\u3068\u3044\u3046\u610f\u5473\u3067\u3042\u308a\u3001\u4e00\u5ea6\u3067\u3082\u30d0\u30a4\u30ca\u30ea\u306b\u5024\u3092\u8ffd\u52a0\u3059\u308b\u3068is_writable\u304c0\u306b\u306a\u308b\u3002\u3053\u308c\u306b\u3088\u3063\u3066\u5916\u304b\u3089\u898b\u305f\u3068\u304d\u306e\u4e0d\u5909\u6027\u3092\u4fdd\u3063\u3066\u3044\u308b\u3002\n\n\u3068\u3044\u3046\u70b9\u3067\u3059\u3002\n\u3064\u307e\u308a\u30d0\u30a4\u30ca\u30ea\u306f \u5f8c\u65b9\u306b\u3001\u304b\u3064\uff11\u5ea6\u3060\u3051\u8ffd\u52a0\u3059\u308b\u5834\u5408 \u3068\u3066\u3082\u826f\u3044\u52b9\u7387\u306b\u306a\u308a\u307e\u3059\u3002\n\u3053\u306e\u30eb\u30fc\u30eb\u3092\u7406\u89e3\u3057\u3066\u5229\u7528\u3059\u308b\u3053\u3068\u3067\u3001\u30d0\u30a4\u30ca\u30ea\u3092\u4f7f\u3063\u3066\u3042\u308b\u7a0b\u5ea6\u9ad8\u901f\u306b\u52d5\u4f5c\u3059\u308b\u30b3\u30fc\u30c9\u304c\u66f8\u3051\u308b\u3088\u3046\u306b\u306a\u308b\u3067\u3057\u3087\u3046\u3002\n\n\u53c2\u8003\n\nErlang -- Constructing and Matching Binaries\notp/erts/emulator/beam at OTP-19.2 \u00b7 erlang/otp\n\n\n\n\n\n\u4f8b\u3048\u3070setelement/3\u306f\u3001\u7279\u5b9a\u306e\u6761\u4ef6\u3092\u6e80\u305f\u3059\u3068 in-place \u3067\u66f8\u304d\u63db\u3048\u3066\u304f\u308c\u307e\u3059\u3002\u00a0\u21a9\n\n\nOTP-19.2 \u6642\u70b9\u306e\u52d5\u4f5c\u3067\u3059\u3002\u00a0\u21a9\n\n\n\nErlang\u306e\u5024\u306f\u4e0d\u5909\uff08immutable\uff09\u3067\u3059\u3002\n\n\u3053\u306e\u4e0d\u5909\u3068\u3044\u3046\u306e\u306f\u3001Erlang\u3092\u5229\u7528\u3059\u308b\u5074\u304b\u3089\u306f\u4e0d\u5909\u306b\u898b\u3048\u308b\u3068\u3044\u3046\u3060\u3051\u306e\u8a71\u3067\u3059\u3002\n\u5b9f\u969b\u306e\u3068\u3053\u308dErlang\u306f\u3001\u4e00\u5ea6\u751f\u6210\u3057\u305f\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306e\u5024\u3092\u30ac\u30f3\u30ac\u30f3\u66f8\u304d\u63db\u3048\u307e\u3059\u3002[^1]\n\n[^1]: \u4f8b\u3048\u3070`setelement/3`\u306f\u3001[\u7279\u5b9a\u306e\u6761\u4ef6](http://erlang.org/doc/efficiency_guide/commoncaveats.html#id63352)\u3092\u6e80\u305f\u3059\u3068 in-place \u3067\u66f8\u304d\u63db\u3048\u3066\u304f\u308c\u307e\u3059\u3002\n\nErlang\u30d0\u30a4\u30ca\u30ea\u3082\u305d\u306e\u5bfe\u8c61\u3067\u3042\u308a\u3001\u5916\u304b\u3089\u898b\u3066\u308b\u9650\u308a\u3067\u306f\u64cd\u4f5c\u3092\u52a0\u3048\u308b\u5ea6\u306b\u30b3\u30d4\u30fc\u3057\u3066\u3044\u308b\u3088\u3046\u306b\u898b\u3048\u307e\u3059\u304c\u3001\u5185\u90e8\u3067\u306f\u5168\u304f\u7570\u306a\u308b\u52d5\u4f5c\u306b\u306a\u3063\u3066\u3044\u307e\u3059\u3002\n\u7279\u306b\u3001\u30d0\u30a4\u30ca\u30ea\u306e\u5f8c\u65b9\u306b\u5024\u3092\u8ffd\u52a0\u3059\u308b\u969b\u306b\u306f\u3068\u3066\u3082\u826f\u3044\u30d1\u30d5\u30a9\u30fc\u30de\u30f3\u30b9\u3092\u767a\u63ee\u3059\u308b\u3088\u3046\u306b\u6700\u9069\u5316\u3055\u308c\u3066\u3044\u307e\u3059\u3002\n\n\u4eca\u56de\u306f\u3001Erlang\u306e\u30d0\u30a4\u30ca\u30ea\u304c\u5185\u90e8\u7684\u306b\u3069\u306e\u3088\u3046\u306a\u69cb\u9020\u306b\u306a\u3063\u3066\u3044\u308b\u304b\u3068\u3001\u30d0\u30a4\u30ca\u30ea\u3092\u5f8c\u65b9\u306b\u8ffd\u52a0\u3059\u308b\u6642\u306b\u305d\u308c\u3089\u304c\u3069\u306e\u3088\u3046\u306a\u6319\u52d5\u306b\u306a\u308b\u304b\u3092\u8aac\u660e\u3057\u307e\u3059\u3002\n\n\u306a\u304a\u3001\u4eca\u56de\u306e\u8a71\u306f [Erlang -- Constructing and Matching Binaries](http://erlang.org/doc/efficiency_guide/binaryhandling.html) \u306e 4.2  Constructing Binaries \u3092\u6df1\u304f\u6398\u308a\u4e0b\u3052\u305f\u5185\u5bb9\u306b\u306a\u3063\u3066\u3044\u307e\u3059\u3002\n\n# Erlang\u30d0\u30a4\u30ca\u30ea\u306e\u7a2e\u985e\n\nErlang\u306e\u30d0\u30a4\u30ca\u30ea\u306f\u3001\u5185\u90e8\u7684\u306b\u306f\uff14\u7a2e\u985e\u3042\u308a\u307e\u3059\u3002\nHeapBin, ProcBin, SubBin, BinMatchState \u3067\u3059\u3002\nBinMatchState \u306f\u3001\u4eca\u56de\u306e\u8a71\u3067\u306f\u4f7f\u308f\u306a\u3044\u306e\u3067\u7701\u3044\u3066\u3044\u307e\u3059\u3002\n\n## HeapBin\n\n![image](https://qiita-image-store.s3.amazonaws.com/0/64060/730c1b5c-aff5-20cd-deac-b17dfc3dbcc2.png)\n\nHeapBin\u306f\u3001\u5c0f\u3055\u3044\u30d0\u30a4\u30ca\u30ea\uff0864\u30d0\u30a4\u30c8\u4ee5\u4e0b\uff09\u3092\u683c\u7d0d\u3059\u308b\u969b\u306b\u4f7f\u3044\u307e\u3059\u3002\n2\u30ef\u30fc\u30c9+`data`\u30d0\u30a4\u30c8\u5206\u3057\u304b\u5bb9\u91cf\u3092\u53d6\u3089\u306a\u3044\u306e\u3067\u7701\u30e1\u30e2\u30ea\u3067\u3059\u3002\n\u307e\u305f\u3001HeapBin\u306e\u4e2d\u306b\u5b9f\u30c7\u30fc\u30bf\u304c\u683c\u7d0d\u3055\u308c\u3066\u3044\u3066\u30c7\u30ea\u30d5\u30a1\u30ec\u30f3\u30b9\u4e0d\u8981\u3067\u3042\u308b\u305f\u3081\u3001\u30a2\u30af\u30bb\u30b9\u306f\u9ad8\u901f\u3067\u3059\u3002\n\n`thing_word`\u3068\u3044\u3046\u306e\u306f\u3001\u30d0\u30a4\u30ca\u30ea\u3092\u7a2e\u5225\u3059\u308b\u305f\u3081\u306e\u30bf\u30b0[^1]\u3067\u3059\u3002\n`size`\u306f\u5b9f\u30c7\u30fc\u30bf\u306e\u30d0\u30a4\u30c8\u6570\u3067\u3059\u3002\n\n[^1]: \u6b63\u78ba\u306b\u306f\u30bf\u30b0\u60c5\u5831+\u5b9f\u30c7\u30fc\u30bf\u306e\u30ef\u30fc\u30c9\u6570\u306a\u306e\u3067\u3059\u304c\u3001HeapBin\u4ee5\u5916\u306e\u30b5\u30a4\u30ba\u306f\u56fa\u5b9a\u306a\u306e\u3067\u307b\u307c\u56fa\u5b9a\u5024\u3068\u5909\u308f\u308a\u307e\u305b\u3093\u3002\n\n\n## ProcBin\n\n![image](https://qiita-image-store.s3.amazonaws.com/0/64060/89fcbd9d-ece1-6261-35d1-9d6f13819cc6.png)\n\nProcBin\u306f\u3001\u5b9f\u30c7\u30fc\u30bf\u3092\u683c\u7d0d\u3059\u308b\u305f\u3081\u306eBinary\u3068\u3001\u305d\u308c\u3092\u53c2\u7167\u3059\u308bProcBin\u306e\uff12\u3064\u306b\u5206\u304b\u308c\u3066\u3044\u307e\u3059\u3002\nHeapBin\u306b\u53ce\u307e\u3089\u306a\u3044\u3001\u5927\u304d\u3044\u30d0\u30a4\u30ca\u30ea\u3092\u6271\u3046\u969b\u306b\u4f7f\u3044\u307e\u3059\u3002\n\nProcBin\u304c6\u30ef\u30fc\u30c9\u3001Binary\u304c3\u30ef\u30fc\u30c9+`orig_bytes`\u30d0\u30a4\u30c8\u5206\u53d6\u308b\u306e\u3067\u3001\u305d\u3053\u305d\u3053\u30e1\u30e2\u30ea\u3092\u4f7f\u3044\u307e\u3059\u3002\n\u307e\u305f\u3001\uff12\u3064\u306e\u8981\u7d20\u306b\u5206\u304b\u308c\u3066\u3044\u308b\u305f\u3081\u3001\u30a2\u30af\u30bb\u30b9\u306f\u305d\u3053\u307e\u3067\u65e9\u304f\u3042\u308a\u307e\u305b\u3093\u3002\n\n\u305f\u3060\u3057\u3001Binary\u306f\u5168\u30d7\u30ed\u30bb\u30b9\u304c\u5171\u6709\u3057\u3066\u3044\u308b\u5171\u6709\u30d2\u30fc\u30d7\u4e0a\u306b\u683c\u7d0d\u3055\u308c\u307e\u3059\u3002\n\u305d\u306e\u305f\u3081\u3001\u30e1\u30c3\u30bb\u30fc\u30b8\u30d1\u30c3\u30b7\u30f3\u30b0\u306e\u969b\u306b\u3053\u306e\u30d0\u30a4\u30ca\u30ea\u3092\u30b3\u30d4\u30fc\u3059\u308b\u5fc5\u8981\u304c\u7121\u304f\u306a\u308b\u306e\u304c\u30e1\u30ea\u30c3\u30c8\u3067\u3059\u3002\n\n`orig_bytes`\u304c\u5b9f\u30c7\u30fc\u30bf\u3092\u683c\u7d0d\u3059\u308b\u305f\u3081\u306e\u9818\u57df\u3067\u3001\u305d\u306e\u9818\u57df\u306e\u30d0\u30a4\u30c8\u6570\u304c`orig_size`\u306b\u683c\u7d0d\u3055\u308c\u3066\u3044\u307e\u3059\u3002\n\n`size`\u306b\u306f\u3001`orig_bytes`\u306e\u9818\u57df\u306e\u3046\u3061\u3001\u73fe\u5728\u4f55\u30d0\u30a4\u30c8\u3092\u4f7f\u3063\u3066\u3044\u308b\u304b\u3068\u3044\u3046\u5024\u3092\u683c\u7d0d\u3057\u3066\u3044\u307e\u3059\u3002\n\n\u306a\u304a\u3001\u4eca\u56de\u306e\u8aac\u660e\u3067\u4f7f\u308f\u306a\u3044\u90e8\u5206\u306f\u7070\u8272\u306e\u6587\u5b57\u306b\u3057\u3066\u3044\u307e\u3059\u3002\n\n## SubBin\n\n![image](https://qiita-image-store.s3.amazonaws.com/0/64060/efa0d7fb-c729-ca7f-c1fc-3da6e9d6d1d1.png)\n\nSubBin\u306f\u3001HeapBin\u3084ProcBin\u306e\u4e00\u90e8\u3092\u53c2\u7167\u3059\u308b\u969b\u306b\u4f7f\u3044\u307e\u3059\u3002\n\n`orig`\u306f\u3001HeapBin\u304bProcBin\u306e\u3069\u3061\u3089\u304b\u3092\u6307\u3057\u3066\u3044\u3066\u3001`orig`\u306e\u6307\u3059\u5148\u306b\u3042\u308b\u5b9f\u30c7\u30fc\u30bf\u306e\u3001`off`\u30d0\u30a4\u30c8\u304b\u3089`off + size`\u30d0\u30a4\u30c8\u307e\u3067\u3092\u5b9f\u30c7\u30fc\u30bf\u3068\u3057\u3066\u6271\u3044\u307e\u3059\u3002\n`orig`\u304cProcBin\u3092\u6307\u3057\u3066\u3044\u308b\u5834\u5408\u3001\u5b9f\u30c7\u30fc\u30bf\u306b\u30a2\u30af\u30bb\u30b9\u3059\u308b\u305f\u3081\u306b\u9593\u63a5\u53c2\u7167\u304c\uff12\u56de\u5fc5\u8981\u306b\u306a\u308b\u305f\u3081\u3001\u9045\u304f\u306a\u308a\u307e\u3059\u3002\n\u305f\u3060\u3057\u3001\u5b9f\u30c7\u30fc\u30bf\u306e\u5168\u90e8\u307e\u305f\u306f\u4e00\u90e8\u3092\u4ed6\u306e\u30d0\u30a4\u30ca\u30ea\u3068\u5171\u6709\u3067\u304d\u308b\u305f\u3081\u3001\u7701\u30e1\u30e2\u30ea\u306b\u306a\u308b\u3057\u3001\u69cb\u7bc9\u3082\u30b3\u30d4\u30fc\u304c\u4e0d\u8981\u306a\u5206\u3001\u9ad8\u901f\u306b\u306a\u308a\u307e\u3059\u3002\n\n`is_writable`\u30d5\u30e9\u30b0\u306f\u3001\u3053\u306e\u30d0\u30a4\u30ca\u30ea\u306b\u5024\u3092\u8ffd\u52a0\u3059\u308b\u969b\u306b\u3001\u65e2\u5b58\u306e\u5b9f\u30c7\u30fc\u30bf\u306b\u8ffd\u52a0\u3057\u3066\u3044\u3044\u304b\u3069\u3046\u304b\u3092\u5224\u65ad\u3059\u308b\u305f\u3081\u306e\u30d5\u30e9\u30b0\u3067\u3059\u3002\n\n\u306a\u304a\u3001`bitoff`\u3084`bitsize`\u3068\u3044\u3046\u30d5\u30a3\u30fc\u30eb\u30c9\u304c`is_writable`\u3068\u540c\u3058\u30ef\u30fc\u30c9\u306e\u5834\u6240\u306b\u3042\u308b\u306e\u3067\u3059\u304c\u3001\u56f3\u306b\u5165\u308c\u308b\u306e\u304c\u9762\u5012\u3060\u3063\u305f\u306e\u3067\u7701\u3044\u3066\u3044\u307e\u3059\u3002\n\u3053\u308c\u3089\u306e\u30d5\u30a3\u30fc\u30eb\u30c9\u306f\u30d3\u30c3\u30c8\u3092\u6271\u3046\u6642\u306b\u5fc5\u8981\u306a\u30d5\u30a3\u30fc\u30eb\u30c9\u3067\u3001\u3053\u308c\u3092\u6301\u3063\u3066\u3044\u308b\u306e\u306fSubBin\u3060\u3051\u3067\u3042\u308b\u305f\u3081\u3001\u30d3\u30c3\u30c8\u30ec\u30d9\u30eb\u3067\u30d0\u30a4\u30ca\u30ea\u3092\u6271\u3046\u969b\u306b\u306f\u5fc5\u305aSubBin\u306b\u306a\u308a\u307e\u3059\u3002\n\n# \u30d0\u30a4\u30ca\u30ea\u306b\u5024\u3092\u8ffd\u52a0\u3059\u308b\n\n\u30d0\u30a4\u30ca\u30ea\u306b\u5024\u3092\u8ffd\u52a0\u3059\u308b\u3068\u3044\u3046\u51e6\u7406\u306f\u3001\u983b\u7e41\u306b\u51fa\u73fe\u3057\u307e\u3059\u3002\n\u4f8b\u3048\u3070 [Erlang -- Constructing and Matching Binaries](http://erlang.org/doc/efficiency_guide/binaryhandling.html) \u3067\u306f\u3001\u4ee5\u4e0b\u306e\u4f8b\u304c\u8f09\u3063\u3066\u3044\u307e\u3059\u3002\n\n```erlang\nmy_list_to_binary(List) ->\n    my_list_to_binary(List, <<>>).\n\nmy_list_to_binary([H|T], Acc) ->\n    my_list_to_binary(T, <<Acc/binary,H>>);\nmy_list_to_binary([], Acc) ->\n    Acc.\n```\n\n\u3053\u306e\u3088\u3046\u306a\u30b3\u30fc\u30c9\u306f\u3088\u304f\u66f8\u304f\u3053\u3068\u306b\u306a\u308b\u305f\u3081\u3001Erlang\u306f\u305d\u306e\u51e6\u7406\u306e\u305f\u3081\u306b\u6700\u9069\u5316\u3057\u3066\u3044\u307e\u3059\u3002\n\u826f\u3044\u30d1\u30d5\u30a9\u30fc\u30de\u30f3\u30b9\u3092\u4efb\u610f\u306b\u5f15\u304d\u51fa\u305b\u308b\u3088\u3046\u306b\u3059\u308b\u305f\u3081\u306b\u3001\u3053\u306e\u6700\u9069\u5316\u304c\u3069\u306e\u3088\u3046\u306b\u52d5\u3044\u3066\u3044\u308b\u306e\u304b\u3092\u77e5\u3063\u3066\u304a\u304f\u306e\u306f\u91cd\u8981\u3067\u3057\u3087\u3046\u3002\n\n## \u6226\u7565\n\n\u57fa\u672c\u7684\u306b\u306f\u3001\u30d0\u30a4\u30ca\u30ea\u306b\u5024\u3092\u8ffd\u52a0\u3059\u308b\u969b\u306b\u78ba\u4fdd\u3059\u308b\u969b\u306b\u3001**\u30e1\u30e2\u30ea\u306f\u4f59\u5206\u306b\u78ba\u4fdd\u3057\u3066\u304a\u304f** \u3068\u3044\u3046\u6226\u7565\u306b\u306a\u308a\u307e\u3059\u3002\n\u305d\u3046\u3059\u308c\u3070\u3001\u6b21\u306e\u5024\u306e\u8ffd\u52a0\u3067\u306f\u3001\u4f59\u5206\u306b\u78ba\u4fdd\u3057\u3066\u304a\u3044\u305f\u9818\u57df\u306b\u5024\u3092\u8ffd\u52a0\u3059\u308c\u3070\u3044\u3044\u3060\u3051\u306a\u306e\u3067\u3001\u8ffd\u52a0\u3059\u308b\u64cd\u4f5c\u3092\u3059\u308b\u5ea6\u306b\u65b0\u3057\u304f\u30e1\u30e2\u30ea\u3092\u78ba\u4fdd\u3059\u308b\u3001\u3068\u3044\u3046\u3053\u3068\u304c\u4e0d\u8981\u306b\u306a\u308a\u307e\u3059\u3002\n\n\u305f\u3060\u3057\u3001**\u5916\u304b\u3089\u898b\u305f\u969b\u306b\u4e0d\u5909\u306b\u898b\u3048\u306a\u3051\u308c\u3070\u306a\u3089\u306a\u3044** \u3068\u3044\u3046\u524d\u63d0\u304c\u3042\u308a\u307e\u3059\u3002\n\u305d\u306e\u305f\u3081\u3001\u3044\u3064\u3067\u3082\u7a7a\u304d\u9818\u57df\u306b\u5024\u3092\u8ffd\u52a0\u3057\u3066\u826f\u3044\u3068\u3044\u3046\u8a33\u3067\u306f\u3042\u308a\u307e\u305b\u3093\u3002\n\u305d\u306e\u8fba\u3092\u3046\u307e\u304f\u3084\u308d\u3046\u3068\u3059\u308b\u3068\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\n\n## \u5177\u4f53\u7684\u306a\u624b\u9806\n\n\u5177\u4f53\u7684\u306a\u624b\u9806\u3092\u6587\u5b57\u3067\u66f8\u304f\u3068\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\n\nA\u3068\u3044\u3046\u30d0\u30a4\u30ca\u30ea\u306bB\u3068\u3044\u3046\u5024\u3092\u8ffd\u52a0\u3059\u308b\u6642\u3001\n\n- A\u306b\u8ffd\u8a18\u4e0d\u53ef\u306e\u5834\u5408:\n    - \uff08\u3064\u307e\u308aA\u304cHeapBin \u307e\u305f\u306f\u3001A\u304cProcBin \u307e\u305f\u306f\u3001A\u304cSubBin\u304b\u3064`is_writable==0`\u306e\u5834\u5408\uff09\n    - N\u30d0\u30a4\u30c8\u306eBinary\u3092\u53c2\u7167\u3059\u308bProcBin\u3092\u4f5c\u308b\n        - N: A\u3068B\u306e\u30b5\u30a4\u30ba\u306e\uff12\u500d\u3002\u305f\u3060\u3057\u305d\u308c\u304c256\u3088\u308a\u5c0f\u3055\u3051\u308c\u3070256\n    - \u65b0\u3057\u3044SubBin\u3092\u751f\u6210\u3057\u3001`is_writable`\u30921\u306b\u3057\u3066\u3001\u305d\u306eProcBin\u3092\u53c2\u7167\u3059\u308b\n\n- A\u306b\u8ffd\u8a18\u53ef\u80fd\u306a\u5834\u5408:\n    - \uff08\u3064\u307e\u308aA\u304cSubBin\u304b\u3064`is_writable==1`\u306e\u5834\u5408\uff09\n    - A\u306e`is_writable`\u30920\u306b\u3059\u308b\n    - B\u306e\u30b5\u30a4\u30ba\u3092\u8db3\u3059\u3068\u3001Binary\u306e`orig_size`\u306e\u30b5\u30a4\u30ba\u3092\u8d85\u3048\u3066\u3057\u307e\u3046\u5834\u5408:\n        - N\u30d0\u30a4\u30c8\u306e\u9818\u57df\u3092\u6301\u3064\u3088\u3046\u306bBinary\u3092realloc\u3057\u3001ProcBin\u306f\u305d\u306eBinary\u3092\u6307\u3059\u3088\u3046\u306b\u3059\u308b\n            - N: A\u3068B\u306e\u30b5\u30a4\u30ba\u306e\uff12\u500d\u3002\u305f\u3060\u3057\u305d\u308c\u304c256\u3088\u308a\u5c0f\u3055\u3051\u308c\u3070256\n    - \u65b0\u3057\u3044SubBin\u3092\u751f\u6210\u3057\u3001`is_writable`\u30921\u306b\u3057\u3066\u3001ProcBin\u3092\u53c2\u7167\u3059\u308b\n\n- \u5f97\u3089\u308c\u305fSubBin\u306e\u6307\u3059\u30d0\u30a4\u30ca\u30ea\u306bB\u306e\u5185\u5bb9\u3092\u66f8\u304d\u8fbc\u3080\n\n\u3068\u3044\u3046\u52d5\u4f5c\u306b\u306a\u308a\u307e\u3059\u3002[^2]\n\n[^2]: [OTP-19.2](https://github.com/erlang/otp/tree/OTP-19.2) \u6642\u70b9\u306e\u52d5\u4f5c\u3067\u3059\u3002\n\n\u6587\u5b57\u3060\u3068\u5206\u304b\u308a\u306b\u304f\u3044\u306e\u3067\u3001\u5177\u4f53\u7684\u306a\u51e6\u7406\u304b\u3089\u56f3\u3092\u66f8\u3044\u3066\u3044\u304d\u307e\u3059\u3002\n\n```erlang\n%% A. \u521d\u671f\u5316\nA = binary:copy(<<1, 2, 3>>),\n\n%% B. A\u306b3\u30d0\u30a4\u30c8\u8ffd\u52a0\nB = <<A/binary, 4, 5, 6>>,\n\n%% C. B\u306b3\u30d0\u30a4\u30c8\u8ffd\u52a0\nC = <<B/binary, 7, 8, 9>>,\n\n%% D. C\u306b3\u30d0\u30a4\u30c8\u8ffd\u52a0\nD = <<C/binary, 10, 11, 12>>,\n\n%% E. D\u306b1000\u30d0\u30a4\u30c8\u8ffd\u52a0\nE = <<D/binary, (binary:copy(<<100>>, 1000))/binary>>,\n\n%% F. D\u306b3\u30d0\u30a4\u30c8\u8ffd\u52a0\nF = <<D/binary, 13, 14, 15>>,\n```\n\n\u3053\u306e\u3088\u3046\u306a\u30b3\u30fc\u30c9\u3092\u66f8\u3044\u305f\u5834\u5408\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u52d5\u4f5c\u306b\u306a\u308a\u307e\u3059\u3002\n\n## A. \u521d\u671f\u5316\n\n```erlang\nA = binary:copy(<<1, 2, 3>>),\n```\n\n\u7d50\u679c:\n\n![image](https://qiita-image-store.s3.amazonaws.com/0/64060/338bbbec-bd5a-8e34-9bc4-7b2f44a93a24.png)\n\n\u3053\u308c\u306f\u8981\u7d20\u306e\u8ffd\u52a0\u3067\u306f\u306a\u304f\u3001\u5358\u306b\u65b0\u3057\u304f\u30d0\u30a4\u30ca\u30ea\u3092\u751f\u6210\u3059\u308b\u51e6\u7406\u306b\u306a\u308a\u307e\u3059\u3002\n64\u30d0\u30a4\u30c8\u4ee5\u4e0b\u306e\u30d0\u30a4\u30ca\u30ea\u3067\u3042\u308b\u305f\u3081\u3001HeapBin\u3092\u751f\u6210\u3057\u307e\u3059\u3002\n\n\u307e\u305f\u3001\u65b0\u3057\u304f\u751f\u6210\u3055\u308c\u305f\u308a\u3001\u66f8\u304d\u63db\u308f\u3063\u305f\u8981\u7d20\u306f\u8272\u3092\u5909\u3048\u308b\u3088\u3046\u306b\u3057\u3066\u3044\u307e\u3059\u3002\uff08\u305f\u3060\u3057`thing_word`\u3092\u9664\u304f\uff09\n\n\u306a\u304a\u3001\u5024\u3092\u8ffd\u52a0\u3059\u308b\u6642\u306b`binary:copy/1`\u3067`<<1, 2, 3>>`\u3092\u30b3\u30d4\u30fc\u3057\u3066\u3044\u308b\u306e\u306f\u3001\u5b9a\u6570\u7573\u307f\u8fbc\u307f\u306e\u6700\u9069\u5316\u3092\u6291\u5236\u3059\u308b\u305f\u3081\u3067\u3059\u3002\n[BEAM\u306e\u95a2\u6570\u3092\u30c7\u30a3\u30b9\u30a2\u30bb\u30f3\u30d6\u30eb\u3059\u308b](http://qiita.com/melpon/items/2e96caf2bfaebbd46bb3)\u3067\u66f8\u3044\u305f\u3088\u3046\u306b\u3001\u5358\u306b`<<1, 2, 3>>`\u3068\u66f8\u304f\u3060\u3051\u3060\u3068\u5168\u3066\u7573\u307f\u8fbc\u307e\u308c\u3066\u610f\u56f3\u3057\u305f\u52d5\u4f5c\u3092\u3057\u307e\u305b\u3093\u3002\n\n\u3064\u307e\u308a\u3001\u5c11\u306a\u304f\u3068\u3082 OTP 19.2 \u306b\u304a\u3044\u3066\u3001 [Erlang -- Constructing and Matching Binaries](http://erlang.org/doc/efficiency_guide/binaryhandling.html) \u306e 4.2  Constructing Binaries \u306b\u3042\u308b\u4f8b\u306f\u8aac\u660e\u306e\u901a\u308a\u306e\u52d5\u4f5c\u3092\u3057\u307e\u305b\u3093\u3002\n\n## B. A\u306b3\u30d0\u30a4\u30c8\u8ffd\u52a0\n\n```erlang\nB = <<A/binary, 4, 5, 6>>,\n```\n\n\u7d50\u679c:\n\n![image](https://qiita-image-store.s3.amazonaws.com/0/64060/0ba3c52a-1097-232a-d16d-c10f2e826e6a.png)\n\nA\u306fHeapBin\u3067\u3042\u308b\u305f\u3081\u3001\u8ffd\u8a18\u4e0d\u53ef\u3067\u3059\u3002\n\u305d\u306e\u305f\u3081\u65b0\u3057\u304f\u30d0\u30a4\u30ca\u30ea\u3092\u751f\u6210\u3057\u307e\u3059\u3002\n\n\u3053\u306e\u6642\u3001Binary\u306e`orig_bytes`\u306e\u9818\u57df\u3068\u3057\u3066 **256\u30d0\u30a4\u30c8\u78ba\u4fdd\u3057\u307e\u3059**\u3002\n\u5b9f\u969b\u5229\u7528\u3059\u308b\u9818\u57df\u306f6\u30d0\u30a4\u30c8\u3067\u3042\u308b\u305f\u3081\u3001`ProcBin:size`\u306b\u306f6\u3092\u5165\u308c\u307e\u3059\u3002\n\u3064\u307e\u308aBinary\u306e`orig_bytes`\u306f\u3001250\u30d0\u30a4\u30c8\u304c\u672a\u4f7f\u7528\u9818\u57df\u306b\u306a\u308a\u307e\u3059\u3002\n\n\u307e\u305f\u3001`SubBin:size`\u3084`SubBin:off`\u306b\u3082\u5024\u3092\u8a2d\u5b9a\u3057\u3001**`is_writable`\u30921\u306b\u3057\u307e\u3059**\u3002\n\u3053\u308c\u306b\u3088\u3063\u3066\u3001\u6b21\u306e\u66f8\u304d\u8fbc\u307f\u3067\u8ffd\u8a18\u304c\u53ef\u80fd\u306b\u306a\u308a\u307e\u3059\u3002\n\n## C. B\u306b3\u30d0\u30a4\u30c8\u8ffd\u52a0\n\n```erlang\nC = <<B/binary, 7, 8, 9>>,\n```\n\n\u7d50\u679c:\n\n![image](https://qiita-image-store.s3.amazonaws.com/0/64060/3dce5acf-4691-773c-d049-4d928980da9f.png)\n\nB\u306fSubBin\u304b\u3064`is_writable`\u304c1\u3067\u3042\u308b\u305f\u3081\u3001**\u8ffd\u8a18\u53ef\u80fd**\u3067\u3059\u3002\n\u305d\u306e\u305f\u3081\u3001\u65b0\u3057\u3044\u30d0\u30a4\u30ca\u30ea\u3092\u78ba\u4fdd\u3059\u308b\u3053\u3068\u306a\u304f\u3001C\u306e\u5185\u5bb9\u304c`B->orig->bytes->orig_bytes`\u306b\u8ffd\u52a0\u3055\u308c\u307e\u3059\u3002\n\u4f7f\u7528\u30b5\u30a4\u30ba\u304c\u5897\u3048\u305f\u306e\u3067\u3001`B->orig->size`\u30926\u304b\u30899\u306b\u3057\u307e\u3059\u3002\n\u307e\u305f\u3001**`B->is_writable`\u306f0\u306b\u66f8\u304d\u63db\u3048\u307e\u3059**\u3002\n\nC\u306e\u305f\u3081\u306b\u65b0\u3057\u304fSubBin\u3092\u751f\u6210\u3057\u3001`orig_bytes`\u306e[1..9]\u30d0\u30a4\u30c8\u3092\u53c2\u7167\u3059\u308b\u3088\u3046\u306b\u3057\u307e\u3059\u3002\n`is_writable`\u306f1\u306b\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n\n\u3053\u306e\u6642\u3001ProcBin\u306f9\u30d0\u30a4\u30c8\u4f7f\u7528\u3057\u3066\u3044\u308b\u3001\u3068\u30de\u30fc\u30af\u3057\u3066\u3044\u307e\u3059\u304c\u3001B\u306fSubBin\u3067\u3042\u308a\u3001[1..6]\u30d0\u30a4\u30c8\u3092\u5229\u7528\u3059\u308b\u3053\u3068\u306b\u306a\u3063\u3066\u3044\u308b\u305f\u3081\u3001B\u306e\u6307\u3057\u3066\u3044\u308b\u5185\u5bb9\u306f\u5909\u308f\u3063\u3066\u3044\u307e\u305b\u3093\u3002\n\u305d\u306e\u305f\u3081**\u4e0d\u5909\u6027\u306f\u5b88\u3089\u308c\u3066\u3044\u307e\u3059**\u3002\n\n## D. C\u306b3\u30d0\u30a4\u30c8\u8ffd\u52a0\n\n```erlang\nD = <<C/binary, 10, 11, 12>>,\n```\n\n\u7d50\u679c:\n\n![image](https://qiita-image-store.s3.amazonaws.com/0/64060/66002e8f-7ec6-ddc9-158d-cc73922a0aa6.png)\n\n\u5148\u307b\u3069\u3068\u540c\u3058\u3067\u3059\u3002A\u306f\u3082\u3046\u8aac\u660e\u3059\u308b\u4e0a\u3067\u4f7f\u308f\u306a\u3044\u306e\u3067\u975e\u8868\u793a\u306b\u3057\u307e\u3057\u305f\u3002\n\nC\u306fSubBin\u304b\u3064`is_writable`\u304c1\u3067\u3042\u308b\u305f\u3081\u3001\u8ffd\u8a18\u53ef\u80fd\u3067\u3059\u3002\n\u305d\u306e\u305f\u3081\u3001\u65b0\u3057\u3044\u30d0\u30a4\u30ca\u30ea\u3092\u78ba\u4fdd\u3059\u308b\u3053\u3068\u306a\u304f\u3001D\u306e\u5185\u5bb9\u304c`C->orig->bytes->orig_bytes`\u306b\u8ffd\u52a0\u3055\u308c\u307e\u3059\u3002\n\u4f7f\u7528\u30b5\u30a4\u30ba\u304c\u5897\u3048\u305f\u306e\u3067\u3001`C->orig->size`\u30929\u304b\u308912\u306b\u3057\u307e\u3059\u3002\n\u307e\u305f\u3001`C->is_writable`\u306f0\u306b\u66f8\u304d\u63db\u3048\u307e\u3059\u3002\n\nD\u306e\u305f\u3081\u306b\u65b0\u3057\u304fSubBin\u3092\u751f\u6210\u3057\u3001`orig_bytes`\u306e[1..12]\u30d0\u30a4\u30c8\u3092\u53c2\u7167\u3059\u308b\u3088\u3046\u306b\u3057\u307e\u3059\u3002\n`is_writable`\u306f1\u306b\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n\n\u3053\u306e\u6642\u3001Binary\u3084ProcBin\u306f12\u30d0\u30a4\u30c8\u4f7f\u7528\u3057\u3066\u3044\u308b\u3001\u3068\u30de\u30fc\u30af\u3057\u3066\u3044\u307e\u3059\u304c\u3001C\u306fSubBin\u3067\u3042\u308a\u3001[1..9]\u30d0\u30a4\u30c8\u3092\u5229\u7528\u3059\u308b\u3053\u3068\u306b\u306a\u3063\u3066\u3044\u308b\u305f\u3081\u3001C\u306e\u5185\u5bb9\u306f\u5909\u308f\u3063\u3066\u3044\u307e\u305b\u3093\u3002\n\u305d\u306e\u305f\u3081\u4e0d\u5909\u6027\u306f\u5b88\u3089\u308c\u3066\u3044\u307e\u3059\u3002\n\n## E. D\u306b1000\u30d0\u30a4\u30c8\u8ffd\u52a0\n\n```erlang\nE = <<D/binary, (binary:copy(<<100>>, 1000))/binary>>,\n```\n\n\u7d50\u679c:\n\n![image](https://qiita-image-store.s3.amazonaws.com/0/64060/572101e9-7bf7-5048-3b8d-831af645b1c7.png)\n\nBinary\u306e\u4f59\u5206\u306a\u9818\u57df\u3092\u8d85\u3048\u308b\u30b5\u30a4\u30ba\u3092\u8ffd\u52a0\u3059\u308b\u3068\u3069\u3046\u306a\u308b\u304b\u3001\u3068\u3044\u3046\u5b9f\u9a13\u3067\u3059\u3002\n\nD\u306fSubBin\u304b\u3064`is_writable`\u304c1\u3067\u3042\u308b\u305f\u3081\u3001\u8ffd\u8a18\u53ef\u80fd\u3067\u3059\u3002\n\u3057\u304b\u3057 `D->orig->bytes->orig_bytes` \u306e\u9818\u57df\u306b\u306f1000\u30d0\u30a4\u30c8\u306e\u4f59\u5206\u306a\u9818\u57df\u306f\u3042\u308a\u307e\u305b\u3093\u3002\n\u305d\u306e\u305f\u3081 **`D->orig->bytes`\u306e\u6307\u3059Binary\u3092realloc\u3057\u3066\u3001\u65b0\u3057\u304fBinary\u3092\u751f\u6210\u3057\u307e\u3059**\u3002\n\u3053\u306e\u6642`orig_bytes`\u306e\u9818\u57df\u306f\u3001\u65b0\u3057\u304f\u5fc5\u8981\u306a\u9818\u57df\u306e\uff12\u500d\u3001\u3064\u307e\u308a1012*2\u306e2024\u30d0\u30a4\u30c8\u306b\u306a\u308a\u307e\u3059\u3002\n`D->orig->bytes`\u306f\u65b0\u3057\u304f\u751f\u6210\u3057\u305f\u9818\u57df\u3092\u6307\u3059\u3088\u3046\u306b\u5207\u308a\u66ff\u3048\u3001\u4f7f\u7528\u30b5\u30a4\u30ba\u30921024\u30d0\u30a4\u30c8\u306b\u3057\u307e\u3059\u3002\n\u307e\u305f\u3001`D->is_writable`\u306f0\u306b\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n\nE\u306e\u305f\u3081\u306b\u65b0\u3057\u304fSubBin\u3092\u751f\u6210\u3057\u3001`orig_bytes`\u306e[1..1012]\u30d0\u30a4\u30c8\u3092\u53c2\u7167\u3059\u308b\u3088\u3046\u306b\u3057\u307e\u3059\u3002\n`is_writable`\u306f1\u306b\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n\n\u3053\u306e\u6642\u3001Binary\u3084ProcBin\u306f1024\u30d0\u30a4\u30c8\u4f7f\u7528\u3057\u3066\u3044\u308b\u3001\u3068\u30de\u30fc\u30af\u3057\u3066\u3044\u307e\u3059\u304c\u3001D\u306fSubBin\u3067\u3042\u308a\u3001[1..12]\u30d0\u30a4\u30c8\u3092\u5229\u7528\u3059\u308b\u3053\u3068\u306b\u306a\u3063\u3066\u3044\u308b\u305f\u3081\u3001D\u306e\u5185\u5bb9\u306f\u5909\u308f\u3063\u3066\u3044\u307e\u305b\u3093\u3002\n\u305d\u306e\u305f\u3081\u4e0d\u5909\u6027\u306f\u5b88\u3089\u308c\u3066\u3044\u307e\u3059\u3002\n\n## F. D\u306b3\u30d0\u30a4\u30c8\u8ffd\u52a0\n\n```erlang\nF = <<D/binary, 13, 14, 15>>,\n```\n\n![image](https://qiita-image-store.s3.amazonaws.com/0/64060/28d2dafc-a4d2-cc67-ff5b-b870b58a65cc.png)\n\n\u4eca\u5ea6\u306f\u3001E\u3067\u306f\u306a\u304f\u3001D\u306b3\u30d0\u30a4\u30c8\u8ffd\u52a0\u3057\u3066\u3044\u307e\u3059\u3002B, C\u306f\u3082\u3046\u8aac\u660e\u3059\u308b\u4e0a\u3067\u306f\u4f7f\u308f\u306a\u3044\u306e\u3067\u975e\u8868\u793a\u306b\u3057\u307e\u3057\u305f\u3002\n\nD\u306fSubBin\u3067\u3059\u304c\u3001**\u65e2\u306bis_writable\u304c0\u306a\u306e\u3067\u3001\u8ffd\u8a18\u4e0d\u53ef\u3067\u3059**\u3002\n\u305d\u306e\u305f\u3081\u3001F\u306e\u305f\u3081\u306b\u65b0\u3057\u304fBinary, ProcBin, SubBin\u3092\u751f\u6210\u3057\u307e\u3059\u3002\n\n\u3053\u306e\u6642\u3001Binary\u306e`orig_bytes`\u306e\u9818\u57df\u3068\u3057\u3066256\u30d0\u30a4\u30c8\u78ba\u4fdd\u3057\u307e\u3059\u3002\nBinary\u306b\u306f\u3001D->orig->bytes\u306e\u6307\u3059\u9818\u57df\u304b\u3089[1..12]\u30d0\u30a4\u30c8\u3092\u30b3\u30d4\u30fc\u3057\u3001\u65b0\u3057\u3044\u8981\u7d20\u306e3\u30d0\u30a4\u30c8\u3092\u8ffd\u52a0\u3067\u66f8\u304d\u8fbc\u307f\u3001\u5408\u8a08\u306e\u4f7f\u7528\u9818\u57df\u306f15\u30d0\u30a4\u30c8\u3068\u306a\u308a\u307e\u3059\u3002\n\n\u3082\u3057\u3053\u3053\u3067D\u306e`is_writable`\u3092\u8003\u616e\u3057\u306a\u304b\u3063\u305f\u5834\u5408\u3001`D->orig->bytes`\u306e\u6307\u3059\u9818\u57df\u304c\u66f8\u304d\u63db\u3048\u3089\u308c\u308b\u3053\u3068\u306b\u306a\u308a\u3001E\u306e\u4e0d\u5909\u6027\u304c\u5d29\u308c\u308b\u3053\u3068\u306b\u6ce8\u610f\u3057\u3066\u4e0b\u3055\u3044\u3002\n`is_writable`\u3092\u4f7f\u3063\u3066\u65b0\u3057\u3044\u9818\u57df\u3092\u78ba\u4fdd\u3055\u305b\u308b\u3053\u3068\u3067\u3001\u305d\u306e\u3088\u3046\u306a\u308b\u306e\u3092\u9632\u3044\u3067\u3044\u307e\u3059\u3002\n\n# \u307e\u3068\u3081\n\n\u91cd\u8981\u306a\u306e\u306f\u3001\n\n- SubBin\u3092\u3046\u307e\u304f\u4f7f\u3063\u3066\u30d0\u30a4\u30ca\u30ea\u3092\u5171\u6709\u3059\u308b\u3053\u3068\u3067\u3001\u7701\u30e1\u30e2\u30ea\u30fb\u69cb\u7bc9\u306e\u9ad8\u901f\u5316\u3092\u3057\u3066\u3044\u308b\u3002\n- `is_writable`\u304c1\u306e\u6642\u306f\u30d0\u30a4\u30ca\u30ea\u306e\u5f8c\u65b9\u306b\u8ffd\u8a18\u53ef\u80fd\u3068\u3044\u3046\u610f\u5473\u3067\u3042\u308a\u3001\u4e00\u5ea6\u3067\u3082\u30d0\u30a4\u30ca\u30ea\u306b\u5024\u3092\u8ffd\u52a0\u3059\u308b\u3068`is_writable`\u304c0\u306b\u306a\u308b\u3002\u3053\u308c\u306b\u3088\u3063\u3066\u5916\u304b\u3089\u898b\u305f\u3068\u304d\u306e\u4e0d\u5909\u6027\u3092\u4fdd\u3063\u3066\u3044\u308b\u3002\n\n\u3068\u3044\u3046\u70b9\u3067\u3059\u3002\n\n\u3064\u307e\u308a\u30d0\u30a4\u30ca\u30ea\u306f **\u5f8c\u65b9\u306b\u3001\u304b\u3064\uff11\u5ea6\u3060\u3051\u8ffd\u52a0\u3059\u308b\u5834\u5408** \u3068\u3066\u3082\u826f\u3044\u52b9\u7387\u306b\u306a\u308a\u307e\u3059\u3002\n\u3053\u306e\u30eb\u30fc\u30eb\u3092\u7406\u89e3\u3057\u3066\u5229\u7528\u3059\u308b\u3053\u3068\u3067\u3001\u30d0\u30a4\u30ca\u30ea\u3092\u4f7f\u3063\u3066\u3042\u308b\u7a0b\u5ea6\u9ad8\u901f\u306b\u52d5\u4f5c\u3059\u308b\u30b3\u30fc\u30c9\u304c\u66f8\u3051\u308b\u3088\u3046\u306b\u306a\u308b\u3067\u3057\u3087\u3046\u3002\n\n# \u53c2\u8003\n\n- [Erlang -- Constructing and Matching Binaries](http://erlang.org/doc/efficiency_guide/binaryhandling.html)\n- [otp/erts/emulator/beam at OTP-19.2 \u00b7 erlang/otp](https://github.com/erlang/otp/tree/OTP-19.2/erts/emulator/beam)\n", "tags": ["Erlang"]}