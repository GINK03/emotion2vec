{"context": "Serverless Framework\u3067web\u30da\u30fc\u30b8\u3092\u4f5c\u308b\u306e\u7d9a\u304d\u3067\u3059\u3002\n\n\u3067\u304d\u305f\u3082\u306e\n\n\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\uff1ahttps://github.com/hideokamoto/sls-wordpress-frontend\n\n\u30e9\u30a4\u30d6\u30e9\u30ea\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\nnode-wpapi\u3068\u3044\u3046superagent\u306e\u30e9\u30c3\u30d1\u30fc\u30e9\u30a4\u30d6\u30e9\u30ea\u304c\u3042\u308a\u307e\u3059\u306e\u3067\u3001\u305d\u308c\u3092\u4f7f\u3044\u307e\u3059\u3002WP API\u306e\u958b\u767a\u306b\u3082\u95a2\u308f\u3063\u3066\u308b\u65b9\u304c\u4f5c\u3089\u308c\u305f\u30e9\u30a4\u30d6\u30e9\u30ea\u306a\u306e\u3067\u3001WP API\u3067\u4f55\u304b\u3057\u305f\u3044\u6642\u306f\u3068\u308a\u3042\u3048\u305a\u3053\u306e\u30e9\u30a4\u30d6\u30e9\u30ea\u4f7f\u3063\u3068\u304f\u3068\u91cd\u5b9d\u3057\u307e\u3059\u3002\n$ npm install --save wpapi\n\nnode_module\u3092Lambda\u540c\u68b1\u3059\u308b\u5fc5\u8981\u304c\u3042\u308b\u306e\u3067\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u3057\u3066\u6307\u5b9a\u3057\u3066\u304a\u304d\u307e\u3057\u3087\u3046\u3002\n\nserverless.yml\npackage:\n  include:\n    - node_modules/\n\n\n\nLambda\u304b\u3089WP API\u3092\u30b3\u30fc\u30eb\u3059\u308b\n\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u3057\u3066\u3001WPAPI\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306bWP API\u30a8\u30f3\u30c9\u30dd\u30a4\u30f3\u30c8\u3092\u6307\u5b9a\u5f8c\u3001posts()\u30e1\u30bd\u30c3\u30c9\u3067\u6295\u7a3f\u3092\u53d6\u5f97\u3057\u307e\u3059\u3002Promise\u306b\u5bfe\u5fdc\u3057\u3066\u3044\u308b\u306e\u3067\u3001then\u3068cach\u3067\u51e6\u7406\u3057\u3061\u3083\u3044\u307e\u3057\u3087\u3046\u3002\n\nindex.js\nmodule.exports.index = (event, context, callback) => {\n    const wp = new WPAPI({ endpoint: 'http://wp-kyoto.net/wp-json' });\n    wp.posts().then(function( data ) {\n      const renderedContent = createListHtml(data)\n      const renderedPage = renderFullPage( renderedContent, data );\n      callback(null, renderedPage);\n    }).catch(function( err ) {\n        callback(err);\n    });\n};\n\n\n\u3042\u3068\u306f\u53d6\u5f97\u3057\u305f\u5024\u3092HTML\u306b\u62bc\u3057\u8fbc\u3093\u3067\u3001callback\u306e\u7b2c\u4e8c\u5f15\u6570\u306b\u6e21\u305b\u3070OK\u3067\u3059\u3002\n\nAPI Gateway\u5074\u306e\u8a2d\u5b9a\nAPI Gateway\u306f\u30c7\u30d5\u30a9\u30eb\u30c8\u3060\u3068JSON\u3092\u8fd4\u3059\u3088\u3046\u306b\u306a\u3063\u3066\u3044\u308b\u306e\u3067\u3001\u30ec\u30b9\u30dd\u30f3\u30b9\u30d8\u30c3\u30c0\u30fc\u3092\u66f8\u304d\u63db\u3048\u307e\u3059\u3002\n\nserverless.yml\nfunctions:\n  index:\n    handler: src/index.index\n    events:\n      - http:\n          path: v1\n          method: get\n          integration: lambda\n          response:\n            headers:\n              Content-Type: \"'text/html'\"\n            template: $input.path('$')\n\n\n\u3053\u3053\u307e\u3067\u5b9f\u65bd\u3057\u305f\u5f8c\u3001sls deploy\u3059\u308c\u3070API\u30a8\u30f3\u30c9\u30dd\u30a4\u30f3\u30c8\u304c\u8868\u793a\u3055\u308c\u307e\u3059\u306e\u3067\u3001\u52d5\u4f5c\u78ba\u8a8d\u3057\u3066\u304a\u304d\u307e\u3057\u3087\u3046\u3002\n\nNEXT:React ServerSide Rendering\nApex\u3067\u306f\u65e2\u306b\u30c8\u30e9\u30a4\u6e08\u3067\u3059\u304c\u3001Serverless Framework\u3067\u306f\u307e\u3060\u306a\u306e\u3067\u3053\u3061\u3089\u3082\u3084\u3063\u3066\u307f\u307e\u3059\u3002\nServerless Webpack \u306e\u4f7f\u3044\u65b9\u307e\u3068\u3081\u3068\u3044\u3046\u8a18\u4e8b\u304c\u5e78\u3044\u306b\u3082\u3053\u306e\u9593\u51fa\u3066\u304d\u305f\u3070\u304b\u308a\u306a\u306e\u3067\u3001\u3053\u308c\u3092\u53c2\u8003\u306bwebpack\u3067\u3084\u308b\u4e88\u5b9a\u3002\n\n[Serverless Framework\u3067web\u30da\u30fc\u30b8\u3092\u4f5c\u308b](http://qiita.com/motchi0214/items/56b3780aa5884057fbd5)\u306e\u7d9a\u304d\u3067\u3059\u3002\n\n## \u3067\u304d\u305f\u3082\u306e\n![\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2016-12-29 0.07.41.png](https://qiita-image-store.s3.amazonaws.com/0/23936/ec2f2159-6561-53dc-cb9c-6b46c7790b6d.png \"\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2016-12-29 0.07.41.png\")\n\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\uff1ahttps://github.com/hideokamoto/sls-wordpress-frontend\n\n\n## \u30e9\u30a4\u30d6\u30e9\u30ea\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n[node-wpapi](https://github.com/WP-API/node-wpapi)\u3068\u3044\u3046superagent\u306e\u30e9\u30c3\u30d1\u30fc\u30e9\u30a4\u30d6\u30e9\u30ea\u304c\u3042\u308a\u307e\u3059\u306e\u3067\u3001\u305d\u308c\u3092\u4f7f\u3044\u307e\u3059\u3002WP API\u306e\u958b\u767a\u306b\u3082\u95a2\u308f\u3063\u3066\u308b\u65b9\u304c\u4f5c\u3089\u308c\u305f\u30e9\u30a4\u30d6\u30e9\u30ea\u306a\u306e\u3067\u3001WP API\u3067\u4f55\u304b\u3057\u305f\u3044\u6642\u306f\u3068\u308a\u3042\u3048\u305a\u3053\u306e\u30e9\u30a4\u30d6\u30e9\u30ea\u4f7f\u3063\u3068\u304f\u3068\u91cd\u5b9d\u3057\u307e\u3059\u3002\n\n```bash\n$ npm install --save wpapi\n```\n\nnode_module\u3092Lambda\u540c\u68b1\u3059\u308b\u5fc5\u8981\u304c\u3042\u308b\u306e\u3067\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u3057\u3066\u6307\u5b9a\u3057\u3066\u304a\u304d\u307e\u3057\u3087\u3046\u3002\n\n```serverless.yml\npackage:\n  include:\n    - node_modules/\n```\n\n## Lambda\u304b\u3089WP API\u3092\u30b3\u30fc\u30eb\u3059\u308b\n\n\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u3057\u3066\u3001WPAPI\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306bWP API\u30a8\u30f3\u30c9\u30dd\u30a4\u30f3\u30c8\u3092\u6307\u5b9a\u5f8c\u3001`posts()`\u30e1\u30bd\u30c3\u30c9\u3067\u6295\u7a3f\u3092\u53d6\u5f97\u3057\u307e\u3059\u3002Promise\u306b\u5bfe\u5fdc\u3057\u3066\u3044\u308b\u306e\u3067\u3001then\u3068cach\u3067\u51e6\u7406\u3057\u3061\u3083\u3044\u307e\u3057\u3087\u3046\u3002\n\n```index.js\nmodule.exports.index = (event, context, callback) => {\n    const wp = new WPAPI({ endpoint: 'http://wp-kyoto.net/wp-json' });\n    wp.posts().then(function( data ) {\n      const renderedContent = createListHtml(data)\n      const renderedPage = renderFullPage( renderedContent, data );\n      callback(null, renderedPage);\n    }).catch(function( err ) {\n        callback(err);\n    });\n};\n```\n\n\u3042\u3068\u306f\u53d6\u5f97\u3057\u305f\u5024\u3092HTML\u306b\u62bc\u3057\u8fbc\u3093\u3067\u3001callback\u306e\u7b2c\u4e8c\u5f15\u6570\u306b\u6e21\u305b\u3070OK\u3067\u3059\u3002\n\n## API Gateway\u5074\u306e\u8a2d\u5b9a\n\nAPI Gateway\u306f\u30c7\u30d5\u30a9\u30eb\u30c8\u3060\u3068JSON\u3092\u8fd4\u3059\u3088\u3046\u306b\u306a\u3063\u3066\u3044\u308b\u306e\u3067\u3001\u30ec\u30b9\u30dd\u30f3\u30b9\u30d8\u30c3\u30c0\u30fc\u3092\u66f8\u304d\u63db\u3048\u307e\u3059\u3002\n\n```serverless.yml\nfunctions:\n  index:\n    handler: src/index.index\n    events:\n      - http:\n          path: v1\n          method: get\n          integration: lambda\n          response:\n            headers:\n              Content-Type: \"'text/html'\"\n            template: $input.path('$')\n```\n\n\u3053\u3053\u307e\u3067\u5b9f\u65bd\u3057\u305f\u5f8c\u3001`sls deploy`\u3059\u308c\u3070API\u30a8\u30f3\u30c9\u30dd\u30a4\u30f3\u30c8\u304c\u8868\u793a\u3055\u308c\u307e\u3059\u306e\u3067\u3001\u52d5\u4f5c\u78ba\u8a8d\u3057\u3066\u304a\u304d\u307e\u3057\u3087\u3046\u3002\n\n## NEXT:React ServerSide Rendering\n\n[Apex\u3067\u306f\u65e2\u306b\u30c8\u30e9\u30a4\u6e08](http://qiita.com/motchi0214/items/a299ab71753d88cc1bdc)\u3067\u3059\u304c\u3001Serverless Framework\u3067\u306f\u307e\u3060\u306a\u306e\u3067\u3053\u3061\u3089\u3082\u3084\u3063\u3066\u307f\u307e\u3059\u3002\n\n[Serverless Webpack \u306e\u4f7f\u3044\u65b9\u307e\u3068\u3081](http://qiita.com/mikakane/items/bf992dc6cb6f50a70071)\u3068\u3044\u3046\u8a18\u4e8b\u304c\u5e78\u3044\u306b\u3082\u3053\u306e\u9593\u51fa\u3066\u304d\u305f\u3070\u304b\u308a\u306a\u306e\u3067\u3001\u3053\u308c\u3092\u53c2\u8003\u306bwebpack\u3067\u3084\u308b\u4e88\u5b9a\u3002\n", "tags": ["WP-REST-API", "APIGateway", "ServerlessFramework"]}