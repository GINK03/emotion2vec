{"tags": ["server", "postfix", "PHP", "EC2"], "context": " More than 1 year has passed since last update.\u304a\u6025\u304e\u306e\u304b\u305f\u306f\u3001\u76ee\u6b21:1=>4.5.6.7\u3078\n\u521d\u6b69\u7684\u306a\u4e8b\u304b\u3082\u3057\u308c\u306a\u3044\u3067\u3059\u304c\u3001\u30cf\u30de\u3063\u3066\u8272\u3005\u89e6\u3063\u305f\u306e\u3067\u30e1\u30e2\n\n\u69cb\u6210 AWS\u5229\u7528\n\u30fb\u3000EC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u30922\u53f0\u7acb\u3066\u3044\u308b\u3002\n\u30fb\u3000ELB\u3092\u5229\u7528\u3057\u3066\u632f\u308a\u5206\u3051\u3066\u3044\u308b\u3002\n\n\u554f\u984c\n\u7247\u65b9\u306eServer\u3067Mail\u9001\u4fe1\u6642\u30a8\u30e9\u30fc\u767a\u751f\u3057\u3066\u3044\u308b\u3002\n[000] [error] [client 00.0.0.00] exec exception:\\n\nsendmail: fatal: config variable inet_interfaces: host not found: localhost\n\n\n\u554f\u984c\u78ba\u8a8d\n\u3068\u308a\u3042\u3048\u305a\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3092\u78ba\u8a8d\n\n1.grep\u3067postconf\u8a2d\u5b9a\u5185\u5bb9\u78ba\u8a8d\n [000/root]$ postconf | grep size\nberkeley_db_create_buffer_size = 16777216\nberkeley_db_read_buffer_size = 131072\nbody_checks_size_limit = 51200\nbounce_size_limit = 50000\nheader_size_limit = 102400\nmailbox_size_limit = 51200000\nmessage_size_limit = 10240000\ntcp_windowsize = 0\n\n\n[000 /root]$ postconf | grep size\nberkeley_db_create_buffer_size = 16777216\nberkeley_db_read_buffer_size = 131072\nbody_checks_size_limit = 51200\nbounce_size_limit = 50000\nheader_size_limit = 102400\npostconf: fatal: config variable inet_interfaces: host not found: localhost\n\n\n\u8a2d\u5b9a\u5024\u304c\u304a\u304b\u3057\u3044\uff01\n\u3068\u308a\u3042\u3048\u305a\u3001\n\n2.\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u306e\u5dee\u5206\u3068\u3063\u3066\u307f\u308b\u3002\n[user@ip-00-0-0-000 ~]$ if diff <(ssh -i *****.pem root@00.0.0.00 cat /etc/postfix/main.cf) <(ssh -i *****.pem root@00.0.0.000 cat /etc/postfix/main.cf) ; then\n> echo yes\n> else\n> echo no\n> fi\nyes\n\n\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u5185\u5bb9\u306f\u540c\u3058\u3002\n\u3061\u306a\u307f\u306bPHP.ini\u3082\u539f\u56e0\u3067\u306f\u306a\u3044\u3002\n[0000 /root]$ php -i | grep php.ini\nConfiguration File (php.ini) Path => /etc\nLoaded Configuration File => /etc/php.ini\n\n[user@ip-00-0-0-000 ~]$ if diff <(ssh -i *****.pem root@00.0.0.00 cat /etc/php.ini) <(ssh -i *****.pem root@00.0.0.000 cat /etc/php.ini) ; then\n> echo no\n> else\n> echo yes\n> fi\n453c453\n< error_reporting = E_ALL & ~E_DEPRECATED & ~E_STRICT & ~E_NOTICE & ~E_WARNING\n---\n> error_reporting = E_ALL & ~E_DEPRECATED & ~E_STRICT & ~E_WARNING & ~E_NOTICE\nyes\n\n\n\n3.\u30d7\u30ed\u30bb\u30b9\u306e\u78ba\u8a8d\n[000 /root]$ /etc/init.d/postfix status\n-b dead but pid file exists\n[000 /root]$ ps aux | grep postfix\nroot     18691  0.0  0.0 103240   868 pts/0    S+   14:44   0:00 grep postfix\n\n\n\u30d7\u30ed\u30bb\u30b9\u304c\u5b9f\u884c\u3055\u308c\u3066\u7121\u3044\uff1f\n[000 /root]$ sudo /etc/init.d/postfix stop \nShutting down postfix:                                     [  FIELD  ]\n[000 /root]$ sudo /etc/init.d/postfix start\nStarting postfix:                                          [  FIELD ]\n\n\n???\n\n4. \uff1f\uff1f\uff1f\n\u3042\u308c\u7d50\u5c40\u30a8\u30e9\u30fc\u3063\u3066\u306a\u3093\u3060\u3063\u3051\uff1f\nsendmail: fatal: config variable inet_interfaces: host not found: localhost\n\nlocalhost\u3055\u3093\u306f\u8ab0\u3067\u3059\u304b\uff1f\n[000 /root]$ ping localhost\nping: unknown host localhost\n\n\n5.localhost\u306e\u8a2d\u5b9a\u78ba\u8a8d\n[000 /root]$ vi /etc/hosts\n000.0.0.0               localhost.localdomain ap1\n::1             localhost6.localdomain6 localhost6\n\n00.0.0.000      db\n\n\nlocalhost\u5c45\u306a\u3044\u3058\u3083\u3093!\n\n6.localhost\u306e\u8a2d\u5b9a\n[000 /root]$ vi /etc/hosts\n000.0.0.0               localhost.localdomain ap1 localhost\n::1             localhost6.localdomain6 localhost6\n\n00.0.0.000      db\n\n\n7.postfix\u518d\u8d77\u52d5\n[000 /root]$ sudo /etc/init.d/postfix stop\nShutting down postfix:                                     [  OK  ]\n[000 /root]$ sudo /etc/init.d/postfix start\nStarting postfix:                                          [  OK  ]\n\n\n\u76f4\u3063\u305f\u30fc\uff01\n\n8.\u304a\u307e\u3051\n\nmail_log\u78ba\u8a8d\n[000 /root]$ tail /var/log/maillog\n\n\npostfix_commond\u306e\u5185\u5bb9\u78ba\u8a8d\n[000 /etc/init.d]$ cat postfix\n----------\nRETVAL=0\nprog=\"postfix\"\nlockfile=/var/lock/subsys/$prog\npidfile=/var/spool/postfix/pid/master.pid\n\nALIASESDB_STAMP=/var/lib/misc/postfix.aliasesdb-stamp\n\n# Script to update chroot environment\nCHROOT_UPDATE=/etc/postfix/chroot-update\n\nstatus -p $pidfile -l $(basename $lockfile) -b /usr/libexec/postfix/master master >/dev/null 2>&1\nrunning=$?\n\nconf_check() {\n    [ -x /usr/sbin/postfix ] || exit 5\n    [ -d /etc/postfix ] || exit 6\n    [ -d /var/spool/postfix ] || exit 5\n}\n\nmake_aliasesdb() {\n    if [ \"$(/usr/sbin/postconf -h alias_database)\" == \"hash:/etc/aliases\" ]\n    then\n        # /etc/aliases.db may be used by other MTA, make sure nothing\n        # has touched it since our last newaliases call\n        [ /etc/aliases -nt /etc/aliases.db ] ||\n            [ \"$ALIASESDB_STAMP\" -nt /etc/aliases.db ] ||\n            [ \"$ALIASESDB_STAMP\" -ot /etc/aliases.db ] || return\n        /usr/bin/newaliases\n        touch -r /etc/aliases.db \"$ALIASESDB_STAMP\"\n    else\n        /usr/bin/newaliases\n    fi\n}\n\nstart() {\n    [ \"$EUID\" != \"0\" ] && exit 4\n    # Check that networking is up.\n    [ ${NETWORKING} = \"no\" ] && exit 1\n    conf_check\n    # Start daemons.\n    echo -n $\"Starting postfix: \"\n    make_aliasesdb >/dev/null 2>&1\n    [ -x $CHROOT_UPDATE ] && $CHROOT_UPDATE\n    /usr/sbin/postfix start 2>/dev/null 1>&2 && success || failure $\"$prog start\"\n    RETVAL=$?\n    [ $RETVAL -eq 0 ] && touch $lockfile\n        echo\n    return $RETVAL\n}\n\nstop() {\n    [ \"$EUID\" != \"0\" ] && exit 4\n    conf_check\n        # Stop daemons.\n    echo -n $\"Shutting down postfix: \"\n    /usr/sbin/postfix stop 2>/dev/null 1>&2 && success || failure $\"$prog stop\"\n    RETVAL=$?\n    [ $RETVAL -eq 0 ] && rm -f $lockfile $pidfile\n    echo\n    return $RETVAL\n}\n\nreload() {\n    conf_check\n    echo -n $\"Reloading postfix: \"\n    [ -x $CHROOT_UPDATE ] && $CHROOT_UPDATE\n    /usr/sbin/postfix reload 2>/dev/null 1>&2 && success || failure $\"$prog reload\"\n    RETVAL=$?\n    echo\n    return $RETVAL\n}\n\nabort() {\n    conf_check\n    /usr/sbin/postfix abort 2>/dev/null 1>&2 && success || failure $\"$prog abort\"\n    return $?\n}\n\nflush() {\n    conf_check\n    /usr/sbin/postfix flush 2>/dev/null 1>&2 && success || failure $\"$prog flush\"\n    return $?\n}\n\ncheck() {\n    conf_check\n    /usr/sbin/postfix check 2>/dev/null 1>&2 && success || failure $\"$prog check\"\n    return $?\n}\n\n# See how we were called.\ncase \"$1\" in\n  start)\n    [ $running -eq 0 ] && exit 0\n    start\n    ;;\n  stop)\n    [ $running -eq 0 ] || exit 0\n    stop\n    ;;\n  restart|force-reload)\n    stop\n    start\n    ;;\n  reload)\n    [ $running -eq 0 ] || exit 7\n    reload\n    ;;\n  abort)\n    abort\n    ;;\n  flush)\n    flush\n    ;;\n  check)\n    check\n    ;;\n  status)\n    status -p $pidfile -l $(basename $lockfile) -b /usr/libexec/postfix/master master\n    ;;\n  condrestart)\n    [ $running -eq 0 ] || exit 0\n    stop\n    start\n    ;;\n  *)\n    echo $\"Usage: $0 {start|stop|restart|reload|abort|flush|check|status|condrestart}\"\n    exit 2\nesac\n\nexit $?\n\n\n\n\u304a\u6025\u304e\u306e\u304b\u305f\u306f\u3001\u76ee\u6b21:1=>4.5.6.7\u3078\n\u521d\u6b69\u7684\u306a\u4e8b\u304b\u3082\u3057\u308c\u306a\u3044\u3067\u3059\u304c\u3001\u30cf\u30de\u3063\u3066\u8272\u3005\u89e6\u3063\u305f\u306e\u3067\u30e1\u30e2\n\n##\u69cb\u6210 AWS\u5229\u7528\n\u30fb\u3000EC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u30922\u53f0\u7acb\u3066\u3044\u308b\u3002\n\u30fb\u3000ELB\u3092\u5229\u7528\u3057\u3066\u632f\u308a\u5206\u3051\u3066\u3044\u308b\u3002\n\n##\u554f\u984c\n\u7247\u65b9\u306eServer\u3067Mail\u9001\u4fe1\u6642\u30a8\u30e9\u30fc\u767a\u751f\u3057\u3066\u3044\u308b\u3002\n\n```\n[000] [error] [client 00.0.0.00] exec exception:\\n\nsendmail: fatal: config variable inet_interfaces: host not found: localhost\n```\n\n##\u554f\u984c\u78ba\u8a8d\n\u3068\u308a\u3042\u3048\u305a\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3092\u78ba\u8a8d\n###1.grep\u3067postconf\u8a2d\u5b9a\u5185\u5bb9\u78ba\u8a8d\n\n```\u6b63\u5e38\u306asrver\n [000/root]$ postconf | grep size\nberkeley_db_create_buffer_size = 16777216\nberkeley_db_read_buffer_size = 131072\nbody_checks_size_limit = 51200\nbounce_size_limit = 50000\nheader_size_limit = 102400\nmailbox_size_limit = 51200000\nmessage_size_limit = 10240000\ntcp_windowsize = 0\n\n```\n```\u7570\u5e38\u306asrver\n[000 /root]$ postconf | grep size\nberkeley_db_create_buffer_size = 16777216\nberkeley_db_read_buffer_size = 131072\nbody_checks_size_limit = 51200\nbounce_size_limit = 50000\nheader_size_limit = 102400\npostconf: fatal: config variable inet_interfaces: host not found: localhost\n\n```\n\n\u8a2d\u5b9a\u5024\u304c\u304a\u304b\u3057\u3044\uff01\n\u3068\u308a\u3042\u3048\u305a\u3001\n###2.\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u306e\u5dee\u5206\u3068\u3063\u3066\u307f\u308b\u3002\n\n```\n[user@ip-00-0-0-000 ~]$ if diff <(ssh -i *****.pem root@00.0.0.00 cat /etc/postfix/main.cf) <(ssh -i *****.pem root@00.0.0.000 cat /etc/postfix/main.cf) ; then\n> echo yes\n> else\n> echo no\n> fi\nyes\n```\n\n\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u5185\u5bb9\u306f\u540c\u3058\u3002\n\u3061\u306a\u307f\u306bPHP.ini\u3082\u539f\u56e0\u3067\u306f\u306a\u3044\u3002\n\n```\n[0000 /root]$ php -i | grep php.ini\nConfiguration File (php.ini) Path => /etc\nLoaded Configuration File => /etc/php.ini\n\n[user@ip-00-0-0-000 ~]$ if diff <(ssh -i *****.pem root@00.0.0.00 cat /etc/php.ini) <(ssh -i *****.pem root@00.0.0.000 cat /etc/php.ini) ; then\n> echo no\n> else\n> echo yes\n> fi\n453c453\n< error_reporting = E_ALL & ~E_DEPRECATED & ~E_STRICT & ~E_NOTICE & ~E_WARNING\n---\n> error_reporting = E_ALL & ~E_DEPRECATED & ~E_STRICT & ~E_WARNING & ~E_NOTICE\nyes\n\n```\n\n###3.\u30d7\u30ed\u30bb\u30b9\u306e\u78ba\u8a8d\n\n```\n[000 /root]$ /etc/init.d/postfix status\n-b dead but pid file exists\n[000 /root]$ ps aux | grep postfix\nroot     18691  0.0  0.0 103240   868 pts/0    S+   14:44   0:00 grep postfix\n\n```\n\n\u30d7\u30ed\u30bb\u30b9\u304c\u5b9f\u884c\u3055\u308c\u3066\u7121\u3044\uff1f\n\n```\n[000 /root]$ sudo /etc/init.d/postfix stop \nShutting down postfix:                                     [  FIELD  ]\n[000 /root]$ sudo /etc/init.d/postfix start\nStarting postfix:                                          [  FIELD ]\n\n```\n???\n\n###4. \uff1f\uff1f\uff1f\n\u3042\u308c\u7d50\u5c40\u30a8\u30e9\u30fc\u3063\u3066\u306a\u3093\u3060\u3063\u3051\uff1f\n\n```\nsendmail: fatal: config variable inet_interfaces: host not found: localhost\n```\n\nlocalhost\u3055\u3093\u306f\u8ab0\u3067\u3059\u304b\uff1f\n\n```localhost\u306e\u78ba\u8a8d\n[000 /root]$ ping localhost\nping: unknown host localhost\n```\n\n###5.localhost\u306e\u8a2d\u5b9a\u78ba\u8a8d\n\n```\n[000 /root]$ vi /etc/hosts\n000.0.0.0               localhost.localdomain ap1\n::1             localhost6.localdomain6 localhost6\n\n00.0.0.000      db\n```\n####localhost\u5c45\u306a\u3044\u3058\u3083\u3093!\n\n\n###6.localhost\u306e\u8a2d\u5b9a\n\n```\n[000 /root]$ vi /etc/hosts\n000.0.0.0               localhost.localdomain ap1 localhost\n::1             localhost6.localdomain6 localhost6\n\n00.0.0.000      db\n```\n\n\n###7.postfix\u518d\u8d77\u52d5\n\n\n```postfix\u5b9f\u884c\n[000 /root]$ sudo /etc/init.d/postfix stop\nShutting down postfix:                                     [  OK  ]\n[000 /root]$ sudo /etc/init.d/postfix start\nStarting postfix:                                          [  OK  ]\n\n```\n\u76f4\u3063\u305f\u30fc\uff01\n\n\n###8.\u304a\u307e\u3051\n\n####mail_log\u78ba\u8a8d\n```mail_log\u78ba\u8a8d\n[000 /root]$ tail /var/log/maillog\n```\n\n\n####postfix_commond\u306e\u5185\u5bb9\u78ba\u8a8d\n```postfix_commond\u306e\u5185\u5bb9\u78ba\u8a8d\n[000 /etc/init.d]$ cat postfix\n----------\nRETVAL=0\nprog=\"postfix\"\nlockfile=/var/lock/subsys/$prog\npidfile=/var/spool/postfix/pid/master.pid\n\nALIASESDB_STAMP=/var/lib/misc/postfix.aliasesdb-stamp\n\n# Script to update chroot environment\nCHROOT_UPDATE=/etc/postfix/chroot-update\n\nstatus -p $pidfile -l $(basename $lockfile) -b /usr/libexec/postfix/master master >/dev/null 2>&1\nrunning=$?\n\nconf_check() {\n    [ -x /usr/sbin/postfix ] || exit 5\n    [ -d /etc/postfix ] || exit 6\n    [ -d /var/spool/postfix ] || exit 5\n}\n\nmake_aliasesdb() {\n\tif [ \"$(/usr/sbin/postconf -h alias_database)\" == \"hash:/etc/aliases\" ]\n\tthen\n\t\t# /etc/aliases.db may be used by other MTA, make sure nothing\n\t\t# has touched it since our last newaliases call\n\t\t[ /etc/aliases -nt /etc/aliases.db ] ||\n\t\t\t[ \"$ALIASESDB_STAMP\" -nt /etc/aliases.db ] ||\n\t\t\t[ \"$ALIASESDB_STAMP\" -ot /etc/aliases.db ] || return\n\t\t/usr/bin/newaliases\n\t\ttouch -r /etc/aliases.db \"$ALIASESDB_STAMP\"\n\telse\n\t\t/usr/bin/newaliases\n\tfi\n}\n\nstart() {\n\t[ \"$EUID\" != \"0\" ] && exit 4\n\t# Check that networking is up.\n\t[ ${NETWORKING} = \"no\" ] && exit 1\n\tconf_check\n\t# Start daemons.\n\techo -n $\"Starting postfix: \"\n\tmake_aliasesdb >/dev/null 2>&1\n\t[ -x $CHROOT_UPDATE ] && $CHROOT_UPDATE\n\t/usr/sbin/postfix start 2>/dev/null 1>&2 && success || failure $\"$prog start\"\n\tRETVAL=$?\n\t[ $RETVAL -eq 0 ] && touch $lockfile\n        echo\n\treturn $RETVAL\n}\n\nstop() {\n\t[ \"$EUID\" != \"0\" ] && exit 4\n\tconf_check\n        # Stop daemons.\n\techo -n $\"Shutting down postfix: \"\n\t/usr/sbin/postfix stop 2>/dev/null 1>&2 && success || failure $\"$prog stop\"\n\tRETVAL=$?\n\t[ $RETVAL -eq 0 ] && rm -f $lockfile $pidfile\n\techo\n\treturn $RETVAL\n}\n\nreload() {\n\tconf_check\n\techo -n $\"Reloading postfix: \"\n\t[ -x $CHROOT_UPDATE ] && $CHROOT_UPDATE\n\t/usr/sbin/postfix reload 2>/dev/null 1>&2 && success || failure $\"$prog reload\"\n\tRETVAL=$?\n\techo\n\treturn $RETVAL\n}\n\nabort() {\n\tconf_check\n\t/usr/sbin/postfix abort 2>/dev/null 1>&2 && success || failure $\"$prog abort\"\n\treturn $?\n}\n\nflush() {\n\tconf_check\n\t/usr/sbin/postfix flush 2>/dev/null 1>&2 && success || failure $\"$prog flush\"\n\treturn $?\n}\n\ncheck() {\n\tconf_check\n\t/usr/sbin/postfix check 2>/dev/null 1>&2 && success || failure $\"$prog check\"\n\treturn $?\n}\n\n# See how we were called.\ncase \"$1\" in\n  start)\n\t[ $running -eq 0 ] && exit 0\n\tstart\n\t;;\n  stop)\n\t[ $running -eq 0 ] || exit 0\n\tstop\n\t;;\n  restart|force-reload)\n\tstop\n\tstart\n\t;;\n  reload)\n\t[ $running -eq 0 ] || exit 7\n\treload\n\t;;\n  abort)\n\tabort\n\t;;\n  flush)\n\tflush\n\t;;\n  check)\n\tcheck\n\t;;\n  status)\n\tstatus -p $pidfile -l $(basename $lockfile) -b /usr/libexec/postfix/master master\n\t;;\n  condrestart)\n\t[ $running -eq 0 ] || exit 0\n\tstop\n\tstart\n\t;;\n  *)\n\techo $\"Usage: $0 {start|stop|restart|reload|abort|flush|check|status|condrestart}\"\n\texit 2\nesac\n\nexit $?\n\n```\n\n\n"}