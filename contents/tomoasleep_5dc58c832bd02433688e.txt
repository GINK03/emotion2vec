{"context": " More than 1 year has passed since last update.Capybara\u306eRackTest\u30c9\u30e9\u30a4\u30d0\u306e\u8a2d\u5b9a\u4e2d\u3067\u30c6\u30b9\u30c8\u5bfe\u8c61\u306eapp\u3092\u3084\u308a\u3068\u308a\u3057\u3066\u3044\u308b\u306e\u3067\u3001\u3053\u3053\u3067\u6e21\u3059app\u3092\u5f04\u308b\u3068\u30d8\u30c3\u30c0\u3092\u8997\u304f\u3053\u3068\u304c\u51fa\u6765\u308b\u3002(env\u306f\u30d8\u30c3\u30c0\u305d\u306e\u3082\u306e\u3067\u306f\u306a\u3044\u304c\u305d\u306e\u60c5\u5831\u3092\u542b\u3093\u3067\u3044\u308b)\noriginal = Capybara.drivers[:rack_test]\nCapybara.register_driver :rack_test do |app|\n  spied_app = lambda { |env| p env; app[env].tap { |status, header| p [status, header] } }\n  original[spied_app]\nend\n\n\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u51fa\u529b\u306b\u306a\u308b(\u4e00\u90e8\u7701\u7565)\n{\"rack.version\"=>[1, 3], \"rack.multithread\"=>true, \"rack.multiprocess\"=>true, \"rack.run_once\"=>false, ..., \"REQUEST_METHOD\"=>\"GET\", \"PATH_INFO\"=>\"/\", \"rack.url_scheme\"=>\"https\", \"HTTPS\"=>\"on\", \"SCRIPT_NAME\"=>\"\", \"CONTENT_LENGTH\"=>\"0\", \"rack.test\"=>true, \"REMOTE_ADDR\"=>\"127.0.0.1\", \"HTTP_REFERER\"=>\"https://hoge.fuga.jp\", \"HTTP_HOST\"=>\"hoge.fuga.jp\", \"HTTP_COOKIE\"=>\"\"}\n\n[302, {\"Content-Length\"=>\"74\", \"Location\"=>\"https://hoge.fuga.jp/\", \"Cache-Control\"=>\"no-cache\", \"Set-Cookie\"=>\"_session_key=....; domain=.fuga.jp; path=/; expires=Sun, 17 Jul 2016 04:14:29 -0000; HttpOnly\", \"Vary\"=>\"Origin\"}]\n\n[Capybara](https://github.com/jnicklas/capybara)\u306e[RackTest\u30c9\u30e9\u30a4\u30d0\u306e\u8a2d\u5b9a\u4e2d\u3067](https://github.com/jnicklas/capybara#racktest)\u30c6\u30b9\u30c8\u5bfe\u8c61\u306eapp\u3092\u3084\u308a\u3068\u308a\u3057\u3066\u3044\u308b\u306e\u3067\u3001\u3053\u3053\u3067\u6e21\u3059app\u3092\u5f04\u308b\u3068\u30d8\u30c3\u30c0\u3092\u8997\u304f\u3053\u3068\u304c\u51fa\u6765\u308b\u3002(env\u306f\u30d8\u30c3\u30c0\u305d\u306e\u3082\u306e\u3067\u306f\u306a\u3044\u304c\u305d\u306e\u60c5\u5831\u3092\u542b\u3093\u3067\u3044\u308b)\n\n```ruby\noriginal = Capybara.drivers[:rack_test]\nCapybara.register_driver :rack_test do |app|\n  spied_app = lambda { |env| p env; app[env].tap { |status, header| p [status, header] } }\n  original[spied_app]\nend\n```\n\n\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u51fa\u529b\u306b\u306a\u308b(\u4e00\u90e8\u7701\u7565)\n\n```\n{\"rack.version\"=>[1, 3], \"rack.multithread\"=>true, \"rack.multiprocess\"=>true, \"rack.run_once\"=>false, ..., \"REQUEST_METHOD\"=>\"GET\", \"PATH_INFO\"=>\"/\", \"rack.url_scheme\"=>\"https\", \"HTTPS\"=>\"on\", \"SCRIPT_NAME\"=>\"\", \"CONTENT_LENGTH\"=>\"0\", \"rack.test\"=>true, \"REMOTE_ADDR\"=>\"127.0.0.1\", \"HTTP_REFERER\"=>\"https://hoge.fuga.jp\", \"HTTP_HOST\"=>\"hoge.fuga.jp\", \"HTTP_COOKIE\"=>\"\"}\n\n[302, {\"Content-Length\"=>\"74\", \"Location\"=>\"https://hoge.fuga.jp/\", \"Cache-Control\"=>\"no-cache\", \"Set-Cookie\"=>\"_session_key=....; domain=.fuga.jp; path=/; expires=Sun, 17 Jul 2016 04:14:29 -0000; HttpOnly\", \"Vary\"=>\"Origin\"}]\n```\n", "tags": ["Ruby", "Capybara"]}