{"context": "# http://stackoverflow.com/questions/35803601/reading-a-file-from-a-private-s3-bucket-to-a-pandas-dataframe\n# \u4eca\u5f8c\u306e\u52d5\u304d\u306f\u3053\u306eissue https://github.com/pydata/pandas/issues/11915\n# milestone 0.18.1\u3068\u306e\u3053\u3068\nimport boto3\nimport pandas as pd\n\ndef read_s3(key, **kwargs):\n    \"\"\"read_csv(\"s3://xx|https://s3-xxx\")\u304c\u3046\u307e\u304f\u3044\u304b\u306a\u304b\u3063\u305f... py3.5.1\"\"\"\n    s3_cleint = boto3.client('s3')\n    obj = s3_cleint.get_object(Bucket='bucket', Key=key)\n    return pd.read_csv(obj['Body'], **kwargs)\n\n# \u3064\u3044\u3067\u306b\u4f5c\u3063\u3066\u307f\u305f\u3002\u3051\u3069\u3001\u5927\u304d\u3059\u304e\u308b\u30d5\u30a1\u30a4\u30eb\u306e\u5834\u5408\u5fae\u5999\u304b\u3082\n# \u305d\u306e\u5834\u5408\u306f\u3001\u3044\u3063\u305f\u3093file -> upload -> os.remove\ndef to_s3(df, key, **kwargs):\n    with io.StringIO() as buf:\n        df.to_csv(buf, **kwargs)\n        s3_client = boto3.client('s3')\n        s3_client.put_object(\n            Bucket='bucket', Key=key, \n            Body=io.BytesIO(buf.getvalue().encode()))\n\n```py3\n# http://stackoverflow.com/questions/35803601/reading-a-file-from-a-private-s3-bucket-to-a-pandas-dataframe\n# \u4eca\u5f8c\u306e\u52d5\u304d\u306f\u3053\u306eissue https://github.com/pydata/pandas/issues/11915\n# milestone 0.18.1\u3068\u306e\u3053\u3068\nimport boto3\nimport pandas as pd\n\ndef read_s3(key, **kwargs):\n    \"\"\"read_csv(\"s3://xx|https://s3-xxx\")\u304c\u3046\u307e\u304f\u3044\u304b\u306a\u304b\u3063\u305f... py3.5.1\"\"\"\n    s3_cleint = boto3.client('s3')\n    obj = s3_cleint.get_object(Bucket='bucket', Key=key)\n    return pd.read_csv(obj['Body'], **kwargs)\n\n# \u3064\u3044\u3067\u306b\u4f5c\u3063\u3066\u307f\u305f\u3002\u3051\u3069\u3001\u5927\u304d\u3059\u304e\u308b\u30d5\u30a1\u30a4\u30eb\u306e\u5834\u5408\u5fae\u5999\u304b\u3082\n# \u305d\u306e\u5834\u5408\u306f\u3001\u3044\u3063\u305f\u3093file -> upload -> os.remove\ndef to_s3(df, key, **kwargs):\n    with io.StringIO() as buf:\n        df.to_csv(buf, **kwargs)\n        s3_client = boto3.client('s3')\n        s3_client.put_object(\n            Bucket='bucket', Key=key, \n            Body=io.BytesIO(buf.getvalue().encode()))\n```\n\n\n\n", "tags": ["memo"]}