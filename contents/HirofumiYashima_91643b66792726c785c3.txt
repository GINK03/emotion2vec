{"context": " More than 1 year has passed since last update.\n\nR\u3067 \u30ab\u30eb\u30de\u30f3\u30d5\u30a3\u30eb\u30bf\u30fc\uff08\uff11\uff09 \uff08\"dlm\"\u30d1\u30c3\u30b1\u30fc\u30b8\uff09\n\n\n\u3010\u4e8b\u4f8b 1\u3011 Nikkei225 \u65e5\u7d4c\u5e73\u5747\u682a\u4fa1\u30c7\u30fc\u30bf\n\n\u76ee\u7684\n\n\u3010\u73fe\u6642\u70b9\u304b\u3089\u3001\u904e\u53bb\u6642\u70b9\u306e\u30c7\u30fc\u30bf\u306e\u63a8\u8a08\u3011\n- \u904e\u53bb\u306e\u65e5\u7d4c\u5e73\u5747\u30c7\u30fc\u30bf\u3092\u3082\u3068\u306b\u3001 \u30c7\u30fc\u30bf\u306e\u89b3\u6e2c\u30fb\u96c6\u8a08\u8aa4\u5dee \u3092\u53d6\u308a\u9664\u3044\u305f  \u300c\u771f\u306e\u300d \u65e5\u7d4c\u5e73\u5747\u682a\u4fa1\u306e\u63a8\u79fb (\u7d42\u5024\u30d9\u30fc\u30b9) \u3092\u63a8\u5b9a\u3059\u308b\n\n\n\u3010\u4eee\u5b9a\u3011\n\n\n\u4ee5\u4e0b\u306e2\u3064\u306e\u6642\u7cfb\u5217\u30c7\u30fc\u30bf \u306f\u3001  \u6b63\u898f\u5206\u5e03 \u306b\u5f93\u3046\uff08\u78ba\u7387\u904e\u7a0b\u3067\u3042\u308b\uff09\n\n\n\"\u771f\u306e\" \u65e5\u7d4c\u5e73\u5747\u682a\u4fa1 \u203b\u30c7\u30fc\u30bf\u304b\u3089\u5f97\u3089\u308c\u308b\u6642\u7cfb\u5217\u30c7\u30fc\u30bf\u304b\u3089\u3001\u30c7\u30fc\u30bf\u306e\u8aa4\u5dee\u3092\u9664\u3044\u305f\u5024\n\u65e5\u7d4c\u5e73\u5747\u30c7\u30fc\u30bf\u306e \"\u30c7\u30fc\u30bf\u89b3\u6e2c\u30fb\u96c6\u8a08\u8aa4\u5dee\" \n\n\n\n\u53c2\u8003\u306b\u3055\u305b\u3066\u9802\u3044\u305f\u30a6\u30a7\u30d6\u30b5\u30a4\u30c8\n\ndlm \u30d1\u30c3\u30b1\u30fc\u30b8 \u3092\u7528\u3044\u305f\u30ab\u30eb\u30de\u30f3\u30d5\u30a3\u30eb\u30bf\u30fc\u306e\u5b9f\u884c\u6cd5\n\n(1) \u6d77\u3068\u9b5a\u3068\u7d71\u8a08\u89e3 \uff08\u8a18\u4e8b\u300cdlm\u306e\u4f7f\u3044\u65b9\u300d\uff09\n(2) Journal of statistical software (article of Octover, 2011)\n(3) CRAN R Project\n\n\nD \u30c7\u30fc\u30bf\u306e\u6e96\u5099\n\n\u65e5\u7d4c\u5e73\u5747\u682a\u4fa1 \u30c7\u30fc\u30bf\u306e\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\n\u65e5\u672c\u7d4c\u6e08\u65b0\u805e\u793e \u30a6\u30a7\u30d6\u30b5\u30a4\u30c8\u3078\u306e\u30ea\u30f3\u30af\naddress <- \"http://indexes.nikkei.co.jp/nkave/historical/nikkei_stock_average_daily_jp.csv\"\nnikkei225 <- read.csv(file=url(address), header=TRUE, sep=\",\")\n\ncolnames(nikkei225) <- c(\"date\",\"close\", \"open\", \"high\", \"low\")\n\n\n\n\u30c7\u30fc\u30bf\u306e\u52a0\u5de5\u30fb\u6574\u5f62\n\n\u548c\u6587\u7b87\u6240\u306e\u9664\u53bb \uff08\u8457\u4f5c\u6a29 \u6587\u8a00\u90e8\u5206\uff09\n\nnikkei225 <- nikkei225[-838, ]\n\nhead(nikkei225)\n\n\n##         date close  open  high   low\n## 1 2011/01/04 10398 10352 10409 10321\n## 2 2011/01/05 10381 10388 10413 10358\n## 3 2011/01/06 10530 10478 10530 10478\n## 4 2011/01/07 10541 10507 10551 10503\n## 5 2011/01/11 10511 10485 10538 10476\n## 6 2011/01/12 10513 10562 10577 10503\n\n\n\u300c\u7d42\u5024\u300d\u7cfb\u5217\u306e\u307f\u3092\u62bd\u51fa\n\n##\u30c7\u30fc\u30bf\u671f\u999614\u65e5\u9593\u5206\u306e\u307f## \u3092\u5229\u7528\nprices <- nikkei225[1:14, 2]\n\nhead(prices)\n\n## [1] 10398 10381 10530 10541 10511 10513\n\nprint(length(prices))\n\n## [1] 14\n\n\nts\u578b\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306b\u578b\u5909\u63db\nprices.ts <- as.ts(prices, start=c(2011,01,04), frequency=365)\n\nclass(prices.ts)\n\n## [1] \"ts\"\n\nhead(prices.ts)\n\n## [1] 10398 10381 10530 10541 10511 10513\n\n\n\u6642\u7cfb\u5217\u63a8\u79fb\u3092\u6298\u308c\u7dda\u30b0\u30e9\u30d5\u8868\u793a\nplot(prices.ts,type=\"o\",col=\"black\", ylab=\"\",main=\"Nikkei225\")\n\n\n\n\ndlm \u30d1\u30c3\u30b1\u30fc\u30b8\u306e\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9 \u53ca\u3073 \u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\ninstall.packages(\"dlm\")\n\n## Installing package into 'C:/Users/owner/Documents/R/win-library/3.0'\n## (as 'lib' is unspecified)\n\nlibrary(dlm)\n\n\n## Warning: package 'dlm' was built under R version 3.0.3\n\n\n\n\u81ea\u4f5c\u95a2\u6570 ( dlm \u30e2\u30c7\u30eb) \u306e\u5ba3\u8a00 \u203b \u95a2\u6570\u540d\uff1abuild.1()\n\n\u5f15\u6570\uff1a \"theta\" \u3092 (\u95a2\u6570\u5185\u90e8\u3067\u6319\u52d5\u3059\u308b ) dlmModPoly \u95a2\u6570\u306b\u6e21\u3059\u69cb\u9020\n\u30e2\u30c7\u30eb\u8a2d\u5b9a\uff1a local level model ( dlmModPoly \u95a2\u6570\u306e \"order\u30aa\u30d7\u30b7\u30e7\u30f31\" \u30921\u306b\u8a2d\u5b9a\n\n\nbuild.1<-function(theta){\n    dlmModPoly(order=1,dV=exp(theta[1]),dW=exp(theta[2]))\n}\n\n\n\n\u4f5c\u6210\u3057\u305f build.1() \u95a2\u6570\u306b\u4e0e\u3048\u308b2\u3064\u306e\u5f15\u6570\u3092\u63a8\u5b9a\n\n\u63a8\u5b9a\u3059\u308b\u30d1\u30e9\u30e1\u30fc\u30bf\n\n(1) \u89b3\u6e2c\u30fb\u96c6\u8a08\u8aa4\u5dee \n(2) \u65e5\u7d4c\u5e73\u5747\u30c7\u30fc\u30bf\u304b\u3089\u3001 (1)\u3092\u53d6\u308a\u9664\u3044\u305f \u771f\u306e \u65e5\u7d4c\u5e73\u5747\u682a\u4fa1\u306e\u5024\n\n\n\u4e0a\u8a182\u30d1\u30e9\u30e1\u30fc\u30bf\u306e  \u521d\u671f\u5024 \u8a2d\u5b9a\n\n(1) 1\n(2) 1\n\n\n\u203b parm = c(1,1) \u3067\u8a2d\u5b9a\n\nfit.1<-dlmMLE(prices.ts,parm=c(1,1),build.1)\n\n\n\n\u95a2\u6570  build.1() \u306e2\u3064\u306e\u5f15\u6570\u306e\u5024\u63a8\u5b9a\u4f5c\u696d \u7d42\u4e86\nstr(fit.1)\n\n## List of 5\n##  $ par        : num [1:2] 6.51 8.57\n##  $ value      : num 77.1\n##  $ counts     : Named int [1:2] 26 26\n##   ..- attr(*, \"names\")= chr [1:2] \"function\" \"gradient\"\n##  $ convergence: int 0\n##  $ message    : chr \"CONVERGENCE: REL_REDUCTION_OF_F <= FACTR*EPSMCH\"\n\nprint(fit.1)\n\n## $par\n## [1] 6.505 8.566\n## \n## $value\n## [1] 77.05\n## \n## $counts\n## function gradient \n##       26       26 \n## \n## $convergence\n## [1] 0\n## \n## $message\n## [1] \"CONVERGENCE: REL_REDUCTION_OF_F <= FACTR*EPSMCH\"\n\n\n\u95a2\u6570  build.1() \u306e\u518d\u5b9a\u7fa9 \u203b \u63a8\u5b9a\u3057\u305f2\u3064\u306e\u5f15\u6570\u3092\u4e0e\u3048\u3066\u3001\u95a2\u6570\u3092\u518d\u5ea6\u3001\u5ba3\u8a00\n\nmod.Nikkei.225 <- build.1(fit.1$par)\n\n\n\n\n\u3053\u3053\u3067\u3001\u3088\u3046\u3084\u304f\u95a2\u6570  build.1() \u306e\u8fd4\u308a\u5024\uff08\u623b\u308a\u5024\uff0f\u51fa\u529b\uff09\u304c\u5f97\u3089\u308c\u305f\n\n\n$V: \u89b3\u6e2c\u30fb\u96c6\u8a08\u8aa4\u5dee \u306e  \u5206\u6563\n\n\n$W: \u771f\u306e\u65e5\u7d4c\u5e73\u5747\u682a\u4fa1\u7cfb\u5217 \u306e \u5206\u6563\n\n\nprint(mod.Nikkei.225)\n\n## $FF\n##      [,1]\n## [1,]    1\n## \n## $V\n##       [,1]\n## [1,] 668.8\n## \n## $GG\n##      [,1]\n## [1,]    1\n## \n## $W\n##      [,1]\n## [1,] 5251\n## \n## $m0\n## [1] 0\n## \n## $C0\n##       [,1]\n## [1,] 1e+07\n\n\n\u30ab\u30eb\u30de\u30f3\u30fb\u30d5\u30a3\u30eb\u30bf\u30fc\uff08\u63a8\u8a08\uff09\u306e\u5b9f\u884c\n\ndlmFilter()** \u95a2\u6570\u306e\u5f15\u6570\u306b\u3001\u65e5\u7d4c\u5e73\u5747\u306e\u30c7\u30fc\u30bf\u30bb\u30c3\u30c8\u3068\u3001\u5b9a\u7fa9\u3057\u305f\u81ea\u4f5c\u95a2\u6570 mod.Nikkei.225\" \u3092\u6e21\u3059\n\ndlmFilter (dataset name, an object of class dlm)\n\nNikkei225.Filt<-dlmFilter(prices.ts, mod.Nikkei.225)\n\n\n\"Nikkei225.Fit\" \u306e  $m \u306b\u3001\u63a8\u5b9a\u3055\u308c\u305f \"\u771f\u306e\" \u65e5\u7d4c\u5e73\u5747\u682a\u4fa1\u306e\u63a8\u79fb \u304c\u683c\u7d0d\u3055\u308c\u3066\u3044\u308b\n(\u63a8\u5b9a\u904e\u7a0b\u4f8b\uff1a\u30c7\u30fc\u30bf\u958b\u59cb\u671f\u304b\u30895\u65e5\u76ee\u306e\u201d\u771f\u306e\u201d\u65e5\u7d4c\u5e73\u5747\u682a\u4fa1\u306f\u3001\u30c7\u30fc\u30bf\u30bb\u30c3\u30c8\u306e\u3046\u3061\u3001\u306f\u3058\u3081\u306e1\u65e5\u76ee\u304b\u30894\u65e5\u76ee\u307e\u3067\u306e\u30c7\u30fc\u30bf\u3092\u7528\u3044\u3066\u63a8\u5b9a\u3055\u308c\u3066\u3044\u308b\uff09\nprint(Nikkei225.Filt$m)\n\n## Time Series:\n## Start = 0 \n## End = 14 \n## Frequency = 1 \n##  [1]     0 10397 10382 10515 10538 10514 10513 10582 10508 10503 10517\n## [12] 10553 10449 10292 10340\n\n\n\u30ab\u30eb\u30de\u30f3\u30fb\u30d5\u30a3\u30eb\u30bf\u30fc\u306e\u63a8\u5b9a\u5024\u306e \u5206\u6563\uff08\u3070\u3089\u3064\u304d\uff09 \u306f\u3001\u5143\u30c7\u30fc\u30bf\uff08\u539f\u7cfb\u5217\uff09\u3088\u308a\u3082 \u5e45\u304c\u5c0f\u3055\u3044 \u3053\u3068\u304c\u307f\u3066\u3068\u308c\u308b\nplot(prices.ts,type=\"o\",col=\"black\",ylab=\"\",main=\"Nikkei225 Filtering\")\nlines(dropFirst(Nikkei225.Filt$m),col=\"red\",lwd=2)\n\n\nNikkei225.Smooth <- dlmSmooth(Nikkei225.Filt)\n\n\n\"Nikkei225.Smooth\" \u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306e $s \u8981\u7d20\u306b\u3001 smoothed\u3055\u308c\u305f \u771f\u306e \u65e5\u7d4c\u5e73\u5747\u682a\u4fa1\u7d42\u5024\u306e\u6642\u7cfb\u5217\u30c7\u30fc\u30bf\uff08\u63a8\u8a08\u5024\uff09\u304c\u683c\u7d0d\u3055\u308c\u3066\u3044\u308b\n\n(\u63a8\u5b9a\u904e\u7a0b\u4f8b\uff1a\u30c7\u30fc\u30bf\u958b\u59cb\u671f\u304b\u30895\u65e5\u76ee\u306e\u201d\u771f\u306e\u201d\u65e5\u7d4c\u5e73\u5747\u682a\u4fa1\u306f\u3001\u30c7\u30fc\u30bf\u30bb\u30c3\u30c8\u306e\u3046\u3061\u30011\u65e5\u76ee\u304b\u3089\u6700\u7d42\u65e5\u307e\u3067\u3001\u3059\u3079\u3066\u306e\u30c7\u30fc\u30bf\u3092\u7528\u3044\u3066\u63a8\u8a08\u3055\u308c\u3066\u3044\u308b\uff09\nprint(Nikkei225.Smooth$s)\n\n## Time Series:\n## Start = 0 \n## End = 14 \n## Frequency = 1 \n##  [1] 10392 10397 10396 10517 10536 10514 10519 10574 10507 10505 10520\n## [12] 10541 10434 10297 10340\n\n\nplot(prices.ts,type=\"o\",col=\"black\",ylab=\"\",main=\"Nikkei225 Smoothing\")\nlines(dropFirst(Nikkei225.Smooth$s),col=\"blue\",lwd=2)\n\n\n\n'smoothed'\u3055\u308c\u305f\u30ab\u30eb\u30de\u30f3\u30fb\u30d5\u30a3\u30eb\u30bf\u30fc\u306e\u63a8\u5b9a\u5024\u306e \u5206\u6563\uff08\u3070\u3089\u3064\u304d\uff09 \u306f\u3001\u5143\u30c7\u30fc\u30bf\uff08\u539f\u7cfb\u5217\uff09\u3088\u308a\u3082 \u5e45\u304c\u5c0f\u3055\u3044 \u3053\u3068\u304c\u307f\u3066\u3068\u308c\u308b\nplot(prices.ts,type=\"o\",col=\"black\",ylab=\"\",main=\"Nikkei225 Filtering & Smoothing\")\nlines(dropFirst(Nikkei225.Filt$m),col=\"red\",lwd=2)\nlines(dropFirst(Nikkei225.Smooth$s),col=\"blue\",lwd=2)\n\n\n\n\n# R\u3067 ***_\u30ab\u30eb\u30de\u30f3\u30d5\u30a3\u30eb\u30bf\u30fc\uff08\uff11\uff09_***  _\uff08\"dlm\"\u30d1\u30c3\u30b1\u30fc\u30b8\uff09_ \n#\u3010\u4e8b\u4f8b 1\u3011 Nikkei225 \u65e5\u7d4c\u5e73\u5747\u682a\u4fa1\u30c7\u30fc\u30bf\n\n# \u76ee\u7684\n---------------------------------------------------------\n\u3010\u73fe\u6642\u70b9\u304b\u3089\u3001\u904e\u53bb\u6642\u70b9\u306e\u30c7\u30fc\u30bf\u306e\u63a8\u8a08\u3011\n- \u904e\u53bb\u306e\u65e5\u7d4c\u5e73\u5747\u30c7\u30fc\u30bf\u3092\u3082\u3068\u306b\u3001 ***_\u30c7\u30fc\u30bf\u306e\u89b3\u6e2c\u30fb\u96c6\u8a08\u8aa4\u5dee_*** \u3092\u53d6\u308a\u9664\u3044\u305f  ***_\u300c\u771f\u306e\u300d_*** \u65e5\u7d4c\u5e73\u5747\u682a\u4fa1\u306e\u63a8\u79fb (\u7d42\u5024\u30d9\u30fc\u30b9) \u3092\u63a8\u5b9a\u3059\u308b\n\n---------------------------------------------------------\n\n# \u3010\u4eee\u5b9a\u3011\n---------------------------------------------------------\n\n#### ***_\u4ee5\u4e0b\u306e2\u3064\u306e\u6642\u7cfb\u5217\u30c7\u30fc\u30bf_*** \u306f\u3001  ***_\u6b63\u898f\u5206\u5e03_*** \u306b\u5f93\u3046\uff08\u78ba\u7387\u904e\u7a0b\u3067\u3042\u308b\uff09 \n\n- ***_\"\u771f\u306e\"_*** \u65e5\u7d4c\u5e73\u5747\u682a\u4fa1 \u203b\u30c7\u30fc\u30bf\u304b\u3089\u5f97\u3089\u308c\u308b\u6642\u7cfb\u5217\u30c7\u30fc\u30bf\u304b\u3089\u3001\u30c7\u30fc\u30bf\u306e\u8aa4\u5dee\u3092\u9664\u3044\u305f\u5024\n- \u65e5\u7d4c\u5e73\u5747\u30c7\u30fc\u30bf\u306e ***_\"\u30c7\u30fc\u30bf\u89b3\u6e2c\u30fb\u96c6\u8a08\u8aa4\u5dee\"_*** \n\n---------------------------------------------------------\n## \u53c2\u8003\u306b\u3055\u305b\u3066\u9802\u3044\u305f\u30a6\u30a7\u30d6\u30b5\u30a4\u30c8\n\n### ***_dlm \u30d1\u30c3\u30b1\u30fc\u30b8_*** \u3092\u7528\u3044\u305f\u30ab\u30eb\u30de\u30f3\u30d5\u30a3\u30eb\u30bf\u30fc\u306e\u5b9f\u884c\u6cd5\n\n- (1) [\u6d77\u3068\u9b5a\u3068\u7d71\u8a08\u89e3 \uff08\u8a18\u4e8b\u300cdlm\u306e\u4f7f\u3044\u65b9\u300d\uff09](http://sakana.soregashi.com/yosoku.z%2011%20SSM2.html)\n \n\n- (2) [Journal of statistical software (article of Octover, 2011)]\n(http://www.jstatsoft.org/v36/i12/paper)\n\n- (3) [CRAN R Project](http://cran.r-project.org/web/packages/dlm/dlm.pdf)\n    \n\n#D \u30c7\u30fc\u30bf\u306e\u6e96\u5099\n\n### \u65e5\u7d4c\u5e73\u5747\u682a\u4fa1 \u30c7\u30fc\u30bf\u306e\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\n[\u65e5\u672c\u7d4c\u6e08\u65b0\u805e\u793e \u30a6\u30a7\u30d6\u30b5\u30a4\u30c8\u3078\u306e\u30ea\u30f3\u30af](http://indexes.nikkei.co.jp/nkave/historical)\n\n```\naddress <- \"http://indexes.nikkei.co.jp/nkave/historical/nikkei_stock_average_daily_jp.csv\"\nnikkei225 <- read.csv(file=url(address), header=TRUE, sep=\",\")\n\ncolnames(nikkei225) <- c(\"date\",\"close\", \"open\", \"high\", \"low\")\n\n```\n# \u30c7\u30fc\u30bf\u306e\u52a0\u5de5\u30fb\u6574\u5f62\n\n##### \u548c\u6587\u7b87\u6240\u306e\u9664\u53bb \uff08\u8457\u4f5c\u6a29 \u6587\u8a00\u90e8\u5206\uff09\n```\n\nnikkei225 <- nikkei225[-838, ]\n\nhead(nikkei225)\n\n```\n\n```\n##         date close  open  high   low\n## 1 2011/01/04 10398 10352 10409 10321\n## 2 2011/01/05 10381 10388 10413 10358\n## 3 2011/01/06 10530 10478 10530 10478\n## 4 2011/01/07 10541 10507 10551 10503\n## 5 2011/01/11 10511 10485 10538 10476\n## 6 2011/01/12 10513 10562 10577 10503\n```\n\n\n### \u300c\u7d42\u5024\u300d\u7cfb\u5217\u306e\u307f\u3092\u62bd\u51fa\n### ##_\u30c7\u30fc\u30bf\u671f\u999614\u65e5\u9593\u5206\u306e\u307f_## \u3092\u5229\u7528\n```\nprices <- nikkei225[1:14, 2]\n\nhead(prices)\n```\n\n```\n## [1] 10398 10381 10530 10541 10511 10513\n```\n\n```\nprint(length(prices))\n```\n\n```\n## [1] 14\n```\n \n### ts\u578b\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306b\u578b\u5909\u63db\n```\nprices.ts <- as.ts(prices, start=c(2011,01,04), frequency=365)\n\nclass(prices.ts)\n```\n\n```\n## [1] \"ts\"\n```\n\n```\nhead(prices.ts)\n```\n\n``` \n## [1] 10398 10381 10530 10541 10511 10513\n```\n\n\n# \u6642\u7cfb\u5217\u63a8\u79fb\u3092\u6298\u308c\u7dda\u30b0\u30e9\u30d5\u8868\u793a\n\n``` \nplot(prices.ts,type=\"o\",col=\"black\", ylab=\"\",main=\"Nikkei225\")\n\n```\n\n![graph.1.png](https://qiita-image-store.s3.amazonaws.com/0/43487/d795b125-67ba-98fe-b7bc-fb31149e54f7.png)\n\n#  ***_dlm_*** \u30d1\u30c3\u30b1\u30fc\u30b8\u306e\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9 \u53ca\u3073 \u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n``` \ninstall.packages(\"dlm\")\n```\n\n``` \n## Installing package into 'C:/Users/owner/Documents/R/win-library/3.0'\n## (as 'lib' is unspecified)\n```\n\n```\nlibrary(dlm)\n\n```\n\n```\n## Warning: package 'dlm' was built under R version 3.0.3\n\n```\n# \u81ea\u4f5c\u95a2\u6570 ( ***_dlm_*** \u30e2\u30c7\u30eb) \u306e\u5ba3\u8a00 \u203b \u95a2\u6570\u540d\uff1abuild.1() \n- \u5f15\u6570\uff1a \"theta\" \u3092 (\u95a2\u6570\u5185\u90e8\u3067\u6319\u52d5\u3059\u308b ) dlmModPoly \u95a2\u6570\u306b\u6e21\u3059\u69cb\u9020\n- \u30e2\u30c7\u30eb\u8a2d\u5b9a\uff1a ***_local level model_*** ( **_dlmModPoly_** \u95a2\u6570\u306e **_\"order\u30aa\u30d7\u30b7\u30e7\u30f31\"_** \u30921\u306b\u8a2d\u5b9a\n\n```\n\nbuild.1<-function(theta){\n    dlmModPoly(order=1,dV=exp(theta[1]),dW=exp(theta[2]))\n}\n\n```\n\n# \u4f5c\u6210\u3057\u305f **_build.1()_** \u95a2\u6570\u306b\u4e0e\u3048\u308b2\u3064\u306e\u5f15\u6570\u3092\u63a8\u5b9a \n\n### \u63a8\u5b9a\u3059\u308b\u30d1\u30e9\u30e1\u30fc\u30bf\n- (1) ***_\u89b3\u6e2c\u30fb\u96c6\u8a08\u8aa4\u5dee_*** \n- (2) \u65e5\u7d4c\u5e73\u5747\u30c7\u30fc\u30bf\u304b\u3089\u3001 (1)\u3092\u53d6\u308a\u9664\u3044\u305f ***_\u771f\u306e_*** \u65e5\u7d4c\u5e73\u5747\u682a\u4fa1\u306e\u5024\n\n### \u4e0a\u8a182\u30d1\u30e9\u30e1\u30fc\u30bf\u306e  **_\u521d\u671f\u5024_** \u8a2d\u5b9a \n- (1) 1\n- (2) 1\n\n### \u203b _parm = c(1,1)_ \u3067\u8a2d\u5b9a\n\n```\n\nfit.1<-dlmMLE(prices.ts,parm=c(1,1),build.1)\n\n```\n\n# \u95a2\u6570  **_build.1()_** \u306e2\u3064\u306e\u5f15\u6570\u306e\u5024\u63a8\u5b9a\u4f5c\u696d \u7d42\u4e86\n\n\n```\nstr(fit.1)\n```\n\n```\n## List of 5\n##  $ par        : num [1:2] 6.51 8.57\n##  $ value      : num 77.1\n##  $ counts     : Named int [1:2] 26 26\n##   ..- attr(*, \"names\")= chr [1:2] \"function\" \"gradient\"\n##  $ convergence: int 0\n##  $ message    : chr \"CONVERGENCE: REL_REDUCTION_OF_F <= FACTR*EPSMCH\"\n```\n\n\n```\nprint(fit.1)\n```\n\n```\n## $par\n## [1] 6.505 8.566\n## \n## $value\n## [1] 77.05\n## \n## $counts\n## function gradient \n##       26       26 \n## \n## $convergence\n## [1] 0\n## \n## $message\n## [1] \"CONVERGENCE: REL_REDUCTION_OF_F <= FACTR*EPSMCH\"\n```\n\n# \u95a2\u6570  **_build.1()_** \u306e\u518d\u5b9a\u7fa9 \u203b \u63a8\u5b9a\u3057\u305f2\u3064\u306e\u5f15\u6570\u3092\u4e0e\u3048\u3066\u3001\u95a2\u6570\u3092\u518d\u5ea6\u3001\u5ba3\u8a00\n\n```\n\nmod.Nikkei.225 <- build.1(fit.1$par)\n\n\n```\n\n# \u3053\u3053\u3067\u3001\u3088\u3046\u3084\u304f\u95a2\u6570  **_build.1()_** \u306e\u8fd4\u308a\u5024\uff08\u623b\u308a\u5024\uff0f\u51fa\u529b\uff09\u304c\u5f97\u3089\u308c\u305f\n\n- ***_$V_***: ***_\u89b3\u6e2c\u30fb\u96c6\u8a08\u8aa4\u5dee_*** \u306e  ***_\u5206\u6563_***\n- ***_$W_***: ***_\u771f\u306e\u65e5\u7d4c\u5e73\u5747\u682a\u4fa1\u7cfb\u5217_*** \u306e ***_\u5206\u6563_***\n\n\n```\nprint(mod.Nikkei.225)\n```\n\n```\n## $FF\n##      [,1]\n## [1,]    1\n## \n## $V\n##       [,1]\n## [1,] 668.8\n## \n## $GG\n##      [,1]\n## [1,]    1\n## \n## $W\n##      [,1]\n## [1,] 5251\n## \n## $m0\n## [1] 0\n## \n## $C0\n##       [,1]\n## [1,] 1e+07\n```\n\n# \u30ab\u30eb\u30de\u30f3\u30fb\u30d5\u30a3\u30eb\u30bf\u30fc\uff08\u63a8\u8a08\uff09\u306e\u5b9f\u884c\n## _dlmFilter()_** \u95a2\u6570\u306e\u5f15\u6570\u306b\u3001\u65e5\u7d4c\u5e73\u5747\u306e\u30c7\u30fc\u30bf\u30bb\u30c3\u30c8\u3068\u3001\u5b9a\u7fa9\u3057\u305f\u81ea\u4f5c\u95a2\u6570 **_mod.Nikkei.225\"_** \u3092\u6e21\u3059\n\n- dlmFilter (dataset name, an object of class dlm)\n\n```\nNikkei225.Filt<-dlmFilter(prices.ts, mod.Nikkei.225)\n```\n\n#  **\"Nikkei225.Fit\"** \u306e  **_$m_** \u306b\u3001\u63a8\u5b9a\u3055\u308c\u305f ***_\"\u771f\u306e\"_***  **\u65e5\u7d4c\u5e73\u5747\u682a\u4fa1\u306e\u63a8\u79fb** \u304c\u683c\u7d0d\u3055\u308c\u3066\u3044\u308b\n (\u63a8\u5b9a\u904e\u7a0b\u4f8b\uff1a\u30c7\u30fc\u30bf\u958b\u59cb\u671f\u304b\u30895\u65e5\u76ee\u306e\u201d\u771f\u306e\u201d\u65e5\u7d4c\u5e73\u5747\u682a\u4fa1\u306f\u3001\u30c7\u30fc\u30bf\u30bb\u30c3\u30c8\u306e\u3046\u3061\u3001\u306f\u3058\u3081\u306e1\u65e5\u76ee\u304b\u30894\u65e5\u76ee\u307e\u3067\u306e\u30c7\u30fc\u30bf\u3092\u7528\u3044\u3066\u63a8\u5b9a\u3055\u308c\u3066\u3044\u308b\uff09\n\n```\nprint(Nikkei225.Filt$m)\n```\n\n```\n## Time Series:\n## Start = 0 \n## End = 14 \n## Frequency = 1 \n##  [1]     0 10397 10382 10515 10538 10514 10513 10582 10508 10503 10517\n## [12] 10553 10449 10292 10340\n```\n\n# \u30ab\u30eb\u30de\u30f3\u30fb\u30d5\u30a3\u30eb\u30bf\u30fc\u306e\u63a8\u5b9a\u5024\u306e ***_\u5206\u6563\uff08\u3070\u3089\u3064\u304d\uff09_*** \u306f\u3001\u5143\u30c7\u30fc\u30bf\uff08\u539f\u7cfb\u5217\uff09\u3088\u308a\u3082 **_\u5e45\u304c\u5c0f\u3055\u3044_** \u3053\u3068\u304c\u307f\u3066\u3068\u308c\u308b\n```\nplot(prices.ts,type=\"o\",col=\"black\",ylab=\"\",main=\"Nikkei225 Filtering\")\nlines(dropFirst(Nikkei225.Filt$m),col=\"red\",lwd=2)\n```\n\n![graph.2.png](https://qiita-image-store.s3.amazonaws.com/0/43487/4e9c489d-902f-afa5-386f-df9408315b42.png)\n\n\n```\nNikkei225.Smooth <- dlmSmooth(Nikkei225.Filt)\n```\n# **_\"Nikkei225.Smooth\"_** \u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306e ***_$s_*** \u8981\u7d20\u306b\u3001 ***_smoothed\u3055\u308c\u305f_*** **_\u771f\u306e_** \u65e5\u7d4c\u5e73\u5747\u682a\u4fa1\u7d42\u5024\u306e\u6642\u7cfb\u5217\u30c7\u30fc\u30bf\uff08\u63a8\u8a08\u5024\uff09\u304c\u683c\u7d0d\u3055\u308c\u3066\u3044\u308b\n###  (\u63a8\u5b9a\u904e\u7a0b\u4f8b\uff1a\u30c7\u30fc\u30bf\u958b\u59cb\u671f\u304b\u30895\u65e5\u76ee\u306e\u201d\u771f\u306e\u201d\u65e5\u7d4c\u5e73\u5747\u682a\u4fa1\u306f\u3001\u30c7\u30fc\u30bf\u30bb\u30c3\u30c8\u306e\u3046\u3061\u30011\u65e5\u76ee\u304b\u3089\u6700\u7d42\u65e5\u307e\u3067\u3001\u3059\u3079\u3066\u306e\u30c7\u30fc\u30bf\u3092\u7528\u3044\u3066\u63a8\u8a08\u3055\u308c\u3066\u3044\u308b\uff09\n\n```\nprint(Nikkei225.Smooth$s)\n```\n\n```\n## Time Series:\n## Start = 0 \n## End = 14 \n## Frequency = 1 \n##  [1] 10392 10397 10396 10517 10536 10514 10519 10574 10507 10505 10520\n## [12] 10541 10434 10297 10340\n\n```\n\n```\nplot(prices.ts,type=\"o\",col=\"black\",ylab=\"\",main=\"Nikkei225 Smoothing\")\nlines(dropFirst(Nikkei225.Smooth$s),col=\"blue\",lwd=2)\n```\n\n![graph.3.png](https://qiita-image-store.s3.amazonaws.com/0/43487/9c3bb3d5-e3bd-8e3d-78b5-9e0152cd5e69.png)\n\n\n# 'smoothed'\u3055\u308c\u305f\u30ab\u30eb\u30de\u30f3\u30fb\u30d5\u30a3\u30eb\u30bf\u30fc\u306e\u63a8\u5b9a\u5024\u306e ***_\u5206\u6563\uff08\u3070\u3089\u3064\u304d\uff09_*** \u306f\u3001\u5143\u30c7\u30fc\u30bf\uff08\u539f\u7cfb\u5217\uff09\u3088\u308a\u3082 **_\u5e45\u304c\u5c0f\u3055\u3044_** \u3053\u3068\u304c\u307f\u3066\u3068\u308c\u308b\n\n\n```\nplot(prices.ts,type=\"o\",col=\"black\",ylab=\"\",main=\"Nikkei225 Filtering & Smoothing\")\nlines(dropFirst(Nikkei225.Filt$m),col=\"red\",lwd=2)\nlines(dropFirst(Nikkei225.Smooth$s),col=\"blue\",lwd=2)\n``` \n\n![graph.4.png](https://qiita-image-store.s3.amazonaws.com/0/43487/cc057c72-8ad6-4a17-50e1-85fa835d1116.png)\n", "tags": ["R", "\u30ab\u30eb\u30de\u30f3\u30d5\u30a3\u30eb\u30bf\u30fc", "\u6642\u7cfb\u5217\u89e3\u6790", "\u7d71\u8a08\u5b66", "statistics"]}