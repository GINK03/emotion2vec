{"tags": ["Perl", "Memcached"], "context": " More than 1 year has passed since last update.Linux\u30b5\u30fc\u30d0\u3068\u3057\u3066\u52d5\u4f5c\u3057\u3001\u4efb\u610f\u306e\u30ad\u30fc\u3084\u5024\u3092\u30ad\u30e3\u30c3\u30b7\u30e5\u3057\u3066\u304f\u308c\u308b\u3002RDBMS\u3068\u9023\u643a\u3057\u3066\u30c7\u30fc\u30bf\u53c2\u7167\u306e\u9ad8\u901f\u5316\u306b\u3088\u304f\u4f7f\u308f\u308c\u308b\u3051\u3069\u3001\u4eca\u56de\u306fPerl\u3067\u306eAPI\u3092\u901a\u3057\u3066\u30d5\u30a9\u30fc\u30e0\u306e2\u91cd\u6295\u7a3f\u5bfe\u7b56\u3068\u3057\u3066\u4f7f\u3063\u3066\u307f\u308b\u30e1\u30e2\u3002\n\n\u6e96\u5099\n\nMemcached\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n\u6280\u8a55\u3055\u3093\u3092\u53c2\u8003\u306b\u3057\u307e\u3057\u305f\u3002Memcached\u306e\u64cd\u4f5c\u65b9\u6cd5\u3082\u3053\u3061\u3089\u3092\u53c2\u7167\u3002\n\nPerl\u306eAPI\u5c0e\u5165\n\nCache::Memcached::Fast\u3092\u4f7f\u3044\u307e\u3059\u3002set\u3068get\u3068delete\u3057\u304b\u4f7f\u308f\u306a\u3044\u306e\u3067\u3053\u308c\u3067\u5341\u5206\u3002\n\n\u30b3\u30fc\u30c9\u306f\u3053\u3093\u306a\u611f\u3058\nuse Cache::Memcached::Fast;\nuse Digest::MD5 qw(md5_hex)\n\nmy $mc = new Cache::Memcached::Fast(\n    {servers => [{address => 'localhost:11211'}]}\n);\n\nsub set_double_post_check {\n    my ($user_id, $expiration_second) = @_;\n\n    my $key = \"double-post-check-$user_id\";\n    my $value = md5_hex($user_id);\n    $expiration_second ||= 300;\n\n    return $mc->set($key, $value, $expiration_second);\n}\nsub check_double_post_check {\n    my $user_id = shift;\n\n    my $key = \"double-post-check-$user_id\";\n    my $value = $mc->get($key);\n    if ( $value eq md5_hex($user_id) ) {\n        $mc->delete($key);\n        return 1;\n    }\n    return 0;\n}\n\n\u5373\u5e2d\u3067\u3084\u308c\u3070\u3053\u3093\u306a\u3082\u3093\u3002\u672c\u5f53\u306fkey\u3082\u6697\u53f7\u5316\u3057\u305f\u307b\u3046\u304c\u3044\u3044\u3057\u3001value\u306f\u6642\u9593\u60c5\u5831\u306a\u3069\u3082\u542b\u3081\u3066\u6697\u53f7\u5316\u3059\u3079\u304d\u3002\n\u3068\u308a\u3042\u3048\u305a\u3053\u3093\u306a\u611f\u3058\u3067Memcached\u3092\u4f7f\u3063\u3066\u30d5\u30a9\u30fc\u30e0\u306e2\u91cd\u6295\u7a3f\u5bfe\u7b56\u304c\u5b9f\u88c5\u3067\u304d\u308b\u306e\u3067\u3001cookie\u4ee5\u5916\u3067\u306e2\u91cd\u6295\u7a3f\u5bfe\u7b56\u3092\u304a\u63a2\u3057\u306e\u65b9\u306f\u305c\u3072\u304a\u8a66\u3057\u3042\u308c\u3002\n\nLinux\u30b5\u30fc\u30d0\u3068\u3057\u3066\u52d5\u4f5c\u3057\u3001\u4efb\u610f\u306e\u30ad\u30fc\u3084\u5024\u3092\u30ad\u30e3\u30c3\u30b7\u30e5\u3057\u3066\u304f\u308c\u308b\u3002RDBMS\u3068\u9023\u643a\u3057\u3066\u30c7\u30fc\u30bf\u53c2\u7167\u306e\u9ad8\u901f\u5316\u306b\u3088\u304f\u4f7f\u308f\u308c\u308b\u3051\u3069\u3001\u4eca\u56de\u306fPerl\u3067\u306eAPI\u3092\u901a\u3057\u3066\u30d5\u30a9\u30fc\u30e0\u306e2\u91cd\u6295\u7a3f\u5bfe\u7b56\u3068\u3057\u3066\u4f7f\u3063\u3066\u307f\u308b\u30e1\u30e2\u3002\n\n##\u6e96\u5099\n\n1. Memcached\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n[\u6280\u8a55](http://gihyo.jp/dev/feature/01/memcached/0001?page=2)\u3055\u3093\u3092\u53c2\u8003\u306b\u3057\u307e\u3057\u305f\u3002Memcached\u306e\u64cd\u4f5c\u65b9\u6cd5\u3082\u3053\u3061\u3089\u3092\u53c2\u7167\u3002\n\n2. Perl\u306eAPI\u5c0e\u5165\n\n[Cache::Memcached::Fast](http://search.cpan.org/~kroki/Cache-Memcached-Fast-0.21/lib/Cache/Memcached/Fast.pm)\u3092\u4f7f\u3044\u307e\u3059\u3002set\u3068get\u3068delete\u3057\u304b\u4f7f\u308f\u306a\u3044\u306e\u3067\u3053\u308c\u3067\u5341\u5206\u3002\n\n##\u30b3\u30fc\u30c9\u306f\u3053\u3093\u306a\u611f\u3058\n\n```Perl\nuse Cache::Memcached::Fast;\nuse Digest::MD5 qw(md5_hex)\n\nmy $mc = new Cache::Memcached::Fast(\n\t{servers => [{address => 'localhost:11211'}]}\n);\n\nsub set_double_post_check {\n\tmy ($user_id, $expiration_second) = @_;\n\n\tmy $key = \"double-post-check-$user_id\";\n\tmy $value = md5_hex($user_id);\n\t$expiration_second ||= 300;\n\n\treturn $mc->set($key, $value, $expiration_second);\n}\nsub check_double_post_check {\n\tmy $user_id = shift;\n\n\tmy $key = \"double-post-check-$user_id\";\n\tmy $value = $mc->get($key);\n\tif ( $value eq md5_hex($user_id) ) {\n\t\t$mc->delete($key);\n\t\treturn 1;\n\t}\n\treturn 0;\n}\n```\n\n\u5373\u5e2d\u3067\u3084\u308c\u3070\u3053\u3093\u306a\u3082\u3093\u3002\u672c\u5f53\u306fkey\u3082\u6697\u53f7\u5316\u3057\u305f\u307b\u3046\u304c\u3044\u3044\u3057\u3001value\u306f\u6642\u9593\u60c5\u5831\u306a\u3069\u3082\u542b\u3081\u3066\u6697\u53f7\u5316\u3059\u3079\u304d\u3002\n\n\u3068\u308a\u3042\u3048\u305a\u3053\u3093\u306a\u611f\u3058\u3067Memcached\u3092\u4f7f\u3063\u3066\u30d5\u30a9\u30fc\u30e0\u306e2\u91cd\u6295\u7a3f\u5bfe\u7b56\u304c\u5b9f\u88c5\u3067\u304d\u308b\u306e\u3067\u3001cookie\u4ee5\u5916\u3067\u306e2\u91cd\u6295\u7a3f\u5bfe\u7b56\u3092\u304a\u63a2\u3057\u306e\u65b9\u306f\u305c\u3072\u304a\u8a66\u3057\u3042\u308c\u3002"}