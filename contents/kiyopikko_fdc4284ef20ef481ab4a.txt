{"context": "\u4ee5\u4e0b\u306e\u30b3\u30df\u30c3\u30c8\u3067\u3001CSS\u306e\u30b9\u30c8\u30ea\u30fc\u30e0\u3092bundle.on()\u3067\u306f\u306a\u304f\u3001browserify\u306e\u30a4\u30d9\u30f3\u30c8\u3068\u540c\u3058b.on\u3067\u76e3\u8996\u3059\u308b\u3088\u3046\u306b\u306a\u3063\u3066\u307e\u3057\u305f\u3002\nhttps://github.com/css-modules/css-modulesify/commit/0759bb0ade779b81d9384007ca2abbeccd61f137\n\u3053\u308c\u3067\u524d\u56de\u306e\u8a18\u4e8b\uff08PostCSS\u30d7\u30e9\u30b0\u30a4\u30f3\u3092\u4f7f\u3046\u3084\u3064\uff09\u3092\u3001watchify\u3067\u3082\u4f7f\u3048\u308b\u3088\u3046\u306b\u306a\u3063\u305f\u306e\u3067\u4ee5\u4e0b\u306b\u4f7f\u7528\u4f8b\u3092\u66f8\u304d\u307e\u3059\u3002\nvar fs         = require('fs');\nvar through2   = require('through2');\nvar browserify = require('browserify');\nvar watchify   = require('watchify');\nvar postcss    = require('postcss');\nvar gutil      = require('gulp-util');\n\nvar cssProcessors = [\n    require('postcss-nested'),\n    require('cssnano')\n];\n\nvar b = browserify('src/index.js');\n\nb.transform(\"babelify\", {presets: [\"es2015\", \"react\"]});\nb.plugin(watchify);\nb.plugin(require('css-modulesify'), {\n  rootDir: __dirname\n});\n\nb.on('update', bundleFunc);\nb.on('log', gutil.log);\nb.on('css stream', function (css) {\n  var postcssStream = through2(\n    function transform(chunk, enc, next){\n      postcss(cssProcessors)\n        .process(chunk)\n        .then(function (result) {\n            next(null, result.css);\n        });\n    }\n  );\n\n  css\n    .pipe(postcssStream)\n    .pipe(fs.createWriteStream('dist/modules.css'));\n});\n\nbundleFunc();\n\nfunction bundleFunc () {\n  return b.bundle()\n          .pipe(fs.createWriteStream('dist/index.js'));\n}\n\n\u4ee5\u4e0b\u306e\u30b3\u30df\u30c3\u30c8\u3067\u3001CSS\u306e\u30b9\u30c8\u30ea\u30fc\u30e0\u3092`bundle.on()`\u3067\u306f\u306a\u304f\u3001browserify\u306e\u30a4\u30d9\u30f3\u30c8\u3068\u540c\u3058`b.on`\u3067\u76e3\u8996\u3059\u308b\u3088\u3046\u306b\u306a\u3063\u3066\u307e\u3057\u305f\u3002\nhttps://github.com/css-modules/css-modulesify/commit/0759bb0ade779b81d9384007ca2abbeccd61f137\n\n\u3053\u308c\u3067[\u524d\u56de\u306e\u8a18\u4e8b\uff08PostCSS\u30d7\u30e9\u30b0\u30a4\u30f3\u3092\u4f7f\u3046\u3084\u3064\uff09](http://qiita.com/kiyopikko/items/e11f501964930856b916)\u3092\u3001watchify\u3067\u3082\u4f7f\u3048\u308b\u3088\u3046\u306b\u306a\u3063\u305f\u306e\u3067\u4ee5\u4e0b\u306b\u4f7f\u7528\u4f8b\u3092\u66f8\u304d\u307e\u3059\u3002\n\n```js\nvar fs         = require('fs');\nvar through2   = require('through2');\nvar browserify = require('browserify');\nvar watchify   = require('watchify');\nvar postcss    = require('postcss');\nvar gutil      = require('gulp-util');\n\nvar cssProcessors = [\n    require('postcss-nested'),\n    require('cssnano')\n];\n\nvar b = browserify('src/index.js');\n\nb.transform(\"babelify\", {presets: [\"es2015\", \"react\"]});\nb.plugin(watchify);\nb.plugin(require('css-modulesify'), {\n  rootDir: __dirname\n});\n\nb.on('update', bundleFunc);\nb.on('log', gutil.log);\nb.on('css stream', function (css) {\n  var postcssStream = through2(\n    function transform(chunk, enc, next){\n      postcss(cssProcessors)\n        .process(chunk)\n        .then(function (result) {\n            next(null, result.css);\n        });\n    }\n  );\n\n  css\n    .pipe(postcssStream)\n    .pipe(fs.createWriteStream('dist/modules.css'));\n});\n\nbundleFunc();\n\nfunction bundleFunc () {\n  return b.bundle()\n          .pipe(fs.createWriteStream('dist/index.js'));\n}\n```\n", "tags": ["browserify", "CSS", "reactjs", "postcss", "css-modules"]}