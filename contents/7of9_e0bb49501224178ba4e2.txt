{"context": " More than 1 year has passed since last update.\n\u52d5\u4f5c\u78ba\u8a8d\nWindows 7Pro 32bit\n\n\nC++ Builder\u304b\u3089\u5225\u30bd\u30d5\u30c8\u3092\u64cd\u4f5c\u3059\u308b\u305f\u3081\u306e\u65b9\u6cd5\u3002\n\u8a66\u3057\u306bnotepad\u3092\u8868\u793a\u3057\u3066\u3001[\u8868\u793a(V)]->[\u30b9\u30c6\u30fc\u30bf\u30b9\u30d0\u30fc(S)]\u3092\u5b9f\u884c\u3057\u3066\u307f\u308b\u3002\n\u53c2\u80031: http://www.gesource.jp/weblog/?p=5143\n\nsample.cpp\nvoid __fastcall TForm1::Button1Click(TObject *Sender)\n{\n\n    STARTUPINFO si = {};\n    si.cb = sizeof(si);\n    PROCESS_INFORMATION pi = {};\n\n    CreateProcess(NULL, L\"notepad.exe\", NULL, NULL, FALSE, 0, NULL, NULL, &si, &pi);\n\n    WaitForInputIdle(pi.hProcess, INFINITE);\n    CloseHandle(pi.hThread);\n    CloseHandle(pi.hProcess);\n\n    HWND hwnd = GetDesktopWindow();\n    hwnd = FindWindowEx(hwnd, NULL, L\"Notepad\", NULL);\n\n    SetForegroundWindow(hwnd);\n\n    for(int loop=0; loop<3; loop++) {\n        Sleep(3000);\n        keybd_event(VK_MENU, 0, 0, 0); // Alt\u30ad\u30fc\n        keybd_event('V', 0, 0, 0);\n        keybd_event('S', 0, 0, 0);\n        keybd_event(VK_MENU, 0, KEYEVENTF_KEYUP, 0); // \u3053\u308c\u304c\u306a\u3044\u3068Alt\u3092\u62bc\u3057\u305f\u307e\u307e\u306b\u306a\u308b\n    }\n\n    keybd_event(VK_RETURN, 0, 0, 0);\n\n}\n\n\nKEYEVENTF_KEYUP\u306f\u5927\u5207\u3002\u3053\u308c\u304c\u306a\u3044\u3068Alt\u304c\u62bc\u3057\u3063\u3071\u306a\u3057\u306b\u306a\u308a\u3001\u4f55\u5ea6\u304b\u3084\u3063\u3066\u3057\u307e\u3063\u3066\u3001\u4e0d\u81ea\u7531\u306b\u306a\u308a\u3001Windows\u3092\u30ed\u30b0\u30a2\u30a6\u30c8\u3057\u305f\u3002\n\n\u3072\u3063\u304b\u304b\u308a\n.\u306b\u3064\u3044\u3066\u306f\u305d\u306e\u307e\u307e\u9001\u306e\u3067\u306f\u306a\u304fVK_DECIMAL\u3092\u9001\u3089\u306a\u3044\u3068\u3044\u3051\u306a\u3044\u3002\nhttp://homepage3.nifty.com/ic/help/rmfunc/vkey.htm\nIP\u30a2\u30c9\u30ec\u30b9\u3092\u9001\u308b\u3068\u304d\u306b\u5931\u6557\u3057\u305f\u3002\n```txt:\u52d5\u4f5c\u78ba\u8a8d\nWindows 7Pro 32bit\n```\n\nC++ Builder\u304b\u3089\u5225\u30bd\u30d5\u30c8\u3092\u64cd\u4f5c\u3059\u308b\u305f\u3081\u306e\u65b9\u6cd5\u3002\n\n\u8a66\u3057\u306bnotepad\u3092\u8868\u793a\u3057\u3066\u3001[\u8868\u793a(V)]->[\u30b9\u30c6\u30fc\u30bf\u30b9\u30d0\u30fc(S)]\u3092\u5b9f\u884c\u3057\u3066\u307f\u308b\u3002\n\n\u53c2\u80031: http://www.gesource.jp/weblog/?p=5143\n\n```sample.cpp\nvoid __fastcall TForm1::Button1Click(TObject *Sender)\n{\n\n\tSTARTUPINFO si = {};\n\tsi.cb = sizeof(si);\n\tPROCESS_INFORMATION pi = {};\n\n\tCreateProcess(NULL, L\"notepad.exe\", NULL, NULL, FALSE, 0, NULL, NULL, &si, &pi);\n\n\tWaitForInputIdle(pi.hProcess, INFINITE);\n\tCloseHandle(pi.hThread);\n\tCloseHandle(pi.hProcess);\n\n\tHWND hwnd = GetDesktopWindow();\n\thwnd = FindWindowEx(hwnd, NULL, L\"Notepad\", NULL);\n\n\tSetForegroundWindow(hwnd);\n\n\tfor(int loop=0; loop<3; loop++) {\n\t\tSleep(3000);\n\t\tkeybd_event(VK_MENU, 0, 0, 0); // Alt\u30ad\u30fc\n\t\tkeybd_event('V', 0, 0, 0);\n\t\tkeybd_event('S', 0, 0, 0);\n\t\tkeybd_event(VK_MENU, 0, KEYEVENTF_KEYUP, 0); // \u3053\u308c\u304c\u306a\u3044\u3068Alt\u3092\u62bc\u3057\u305f\u307e\u307e\u306b\u306a\u308b\n\t}\n\n\tkeybd_event(VK_RETURN, 0, 0, 0);\n\n}\n```\n\nKEYEVENTF_KEYUP\u306f\u5927\u5207\u3002\u3053\u308c\u304c\u306a\u3044\u3068Alt\u304c\u62bc\u3057\u3063\u3071\u306a\u3057\u306b\u306a\u308a\u3001\u4f55\u5ea6\u304b\u3084\u3063\u3066\u3057\u307e\u3063\u3066\u3001\u4e0d\u81ea\u7531\u306b\u306a\u308a\u3001Windows\u3092\u30ed\u30b0\u30a2\u30a6\u30c8\u3057\u305f\u3002\n\n#\u3072\u3063\u304b\u304b\u308a\n\n`.`\u306b\u3064\u3044\u3066\u306f\u305d\u306e\u307e\u307e\u9001\u306e\u3067\u306f\u306a\u304fVK_DECIMAL\u3092\u9001\u3089\u306a\u3044\u3068\u3044\u3051\u306a\u3044\u3002\nhttp://homepage3.nifty.com/ic/help/rmfunc/vkey.htm\n\nIP\u30a2\u30c9\u30ec\u30b9\u3092\u9001\u308b\u3068\u304d\u306b\u5931\u6557\u3057\u305f\u3002\n\n\n", "tags": ["cppBuilder", "appOperation"]}