{"context": " More than 1 year has passed since last update.\u30d5\u30a9\u30fc\u30e0\u30d0\u30ea\u30c7\u30fc\u30b7\u30e7\u30f3\u306f\u30d0\u30ea\u30c7\u30fc\u30b7\u30e7\u30f3\u3059\u308b\u30e1\u30bd\u30c3\u30c9\u306b@FormValidation\u3068\u30a2\u30ce\u30c6\u30fc\u30b7\u30e7\u30f3\u3068\u3059\u308b\u3053\u3068\u3067\u884c\u308f\u308c\u307e\u3059\u3002\n\nForm\u30af\u30e9\u30b9\nForm\u306e\u30da\u30fc\u30b8\u3092\u4f5c\u6210\u3059\u308b\u305f\u3081\u306b\u6700\u521d\u306bForm\u30af\u30e9\u30b9\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002Form\u30af\u30e9\u30b9\u306f\u30d5\u30a9\u30fc\u30e0\u306e\u767b\u9332\u3068\u521d\u671f\u5316\u3001\u30eb\u30fc\u30eb\u9069\u7528\u3001HTML\u8868\u73fe\u306a\u3069\u30d5\u30a9\u30fc\u30e0\u306b\u95a2\u9023\u3059\u308b\u8981\u7d20\u304c\uff11\u3064\u306b\u96c6\u7d04\u3055\u308c\u3066\u3044\u307e\u3059\u3002\nclass MyForm extends AbstractForm\n{\n    /**\n     * {@inheritdoc}\n     */\n    public function init()\n\n        $this->setField('name')\n            ->setAttribs([\n                'id' => 'name',\n                'name' => 'name',\n                'size' => 20,\n                'maxlength' => 20,\n                'class' => 'form-control',\n                'placeholder' => 'Your Name'\n            ]);\n        $this->setField('submit', 'submit')\n            ->setAttribs([\n                'name' => 'submit',\n                'value' => 'Submit'\n            ]);\n        $this->filter->validate('name')->isNot('blank');\n        $this->filter->validate('name')->is('alnum');\n        $this->filter->useFieldMessage('name', 'Name must be alphabetic only !!.');\n\n\u30d5\u30a9\u30fc\u30e0\u3067\u4f7f\u3046\u5024\u3067\u30ea\u30bd\u30fc\u30b9\u3084\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306e\u30a2\u30af\u30bb\u30b9\u304c\u5fc5\u8981\u306a\u5834\u5408\u306f\u3001\u30a4\u30f3\u30b8\u30a7\u30af\u30c8\u3057\u3066\u4f7f\u3044\u307e\u3059\u3002\n\n\u30d5\u30a9\u30fc\u30e0\u521d\u671f\u5316\ninit()\u30e1\u30bd\u30c3\u30c9\u3067\u306f\u30d5\u30a9\u30fc\u30e0\u306e\u30d5\u30a3\u30fc\u30eb\u30c9\u306b\u30a2\u30c8\u30ea\u30d3\u30e5\u30fc\u30c8\u3084\u30eb\u30fc\u30eb\u3092\u767b\u9332\u3057\u3066\u30d5\u30a9\u30fc\u30e0\u3092\u521d\u671f\u5316\u3057\u307e\u3059\u3002\n\n\u30d5\u30a3\u30fc\u30eb\u30c9\u767b\u9332\n\u307e\u305a\u30d5\u30a9\u30fc\u30e0\u30d5\u30a3\u30fc\u30eb\u30c9name\u3092\u30a2\u30c8\u30ea\u30d3\u30e5\u30fc\u30c8\u3068\u4e00\u7dd2\u306b\u30bb\u30c3\u30c8\u3057\u307e\u3059\u3002\n$this->setField('name', 'text')->setAttribs(['id' => 'name']);\n\n\n\u30d0\u30ea\u30c7\u30fc\u30b7\u30e7\u30f3\u767b\u9332\n\u6b21\u306b\u30bb\u30c3\u30c8\u3057\u305f\u30d5\u30a3\u30fc\u30eb\u30c9\u306b\u5bfe\u3057\u3066\u30d0\u30ea\u30c7\u30fc\u30b7\u30e7\u30f3\u3092\u30bb\u30c3\u30c8\u3057\u307e\u3059\u3002\n$this->filter->validate('name')->is('alnum');\n$this->filter->validate('name')->is('alpha');\n$this->filter->validate('name')->is('between', $min, $max);\n$this->filter->validate('name')->is('blank');\n$this->filter->validate('name')->is('bool');\n$this->filter->validate('name')->is('callback', function ($subject, $field) {\n    if ($subject->$field === 'foo') {\n        return true;\n    }\n    return false;\n});\n// ...\n\n\u30d0\u30ea\u30fc\u30c7\u30fc\u30bf\u306fAura.Filter v2\u3067\u3059\u3002\u30d0\u30ea\u30c7\u30fc\u30b7\u30e7\u30f3\u304c\u5fc5\u8981\u306afilter\u3068\u6307\u5b9a\u306e\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u306b\u5909\u63db\u3059\u308bsanitize\u304c\u3042\u308a\u307e\u3059\u3002\n\u30d0\u30ea\u30c7\u30fc\u30b7\u30e7\u30f3\u306f\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3084\u30a2\u30ce\u30c6\u30fc\u30b7\u30e7\u30f3\u3067\u6307\u5b9a\u3059\u308b\u306e\u3067\u306f\u306a\u304f\u3001PHP\u3067\u8a18\u8ff0\u3057\u307e\u3059\u3002\n\n\u30e1\u30c3\u30bb\u30fc\u30b8\n$this->filter->useFieldMessage('name', 'Name must be alphabetic only.');\n\n\u30a8\u30e9\u30fc\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u30d5\u30a3\u30fc\u30eb\u30c9\u306b\u5bfe\u3057\u3066\u30bb\u30c3\u30c8\u3057\u307e\u3059\u3002\n\nID\u306f\u30a2\u30eb\u30d5\u30a1\u30d9\u30c3\u30c8\u3067\u6307\u5b9a\u3057\u3066\u304f\u3060\u3055\u3044\nID\u306f\uff14\u6587\u5b57\u4ee5\u4e0a\u3067\u6307\u5b9a\u3057\u3066\u304f\u3060\u3055\u3044\n\n\u306e\u3088\u3046\u306b\u30eb\u30fc\u30eb\u5358\u4f4d\u3067\u30a8\u30e9\u30fc\u304c\u51fa\u308b\u306e\u3067\u306f\u306a\u304f\u300cID\u306f\u30a2\u30eb\u30d5\u30a1\u30d9\u30c3\u30c8\uff14\u6587\u5b57\u4ee5\u4e0a\u3067\u6307\u5b9a\u3057\u3066\u304f\u3060\u3055\u3044\u300d\u3068\u3044\u3046\u98a8\u306b\u30d5\u30a3\u30fc\u30eb\u30c9\u5358\u4f4d\u3067\u306e\u30a8\u30e9\u30fc\u306b\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n\u30d5\u30a9\u30fc\u30e0\u306eHTML\nForm\u30af\u30e9\u30b9\u306e__toString()\u30e1\u30bd\u30c3\u30c9\u3067html\u51fa\u529b\u3092\u8fd4\u3057\u307e\u3059\u3002\n    /**\n     * {@inheritdoc}\n     */\n    public function __toString()\n    {\n        $form = $this->form([\n            'method' => 'post',\n            'action' => '/min'\n        ]);\n        // name\n        /** @var $tag Tag */\n        $tag  = $this->helper->get('tag');\n        $form .= $tag('div', ['class' => 'form-group']);\n        $form .= $this->helper->tag('div', ['class' => 'form-group']);\n        $form .= $this->helper->tag('label', ['for' => 'name']);\n        $form .= 'Name:';\n        $form .= $this->helper->tag('/label') . PHP_EOL;\n        $form .= $this->input('name');\n        $form .= $this->error('name');\n        $form .= $this->helper->tag('/div') . PHP_EOL;\n        // submit\n        $form .= $this->input('submit');\n        $form .= $this->helper->tag('/form');\n\n        return $form;\n    }\n\n\u57fa\u672c\u7684\u306b\u4ee5\u4e0b\u306e\uff12\u3064\u306e\u52d5\u7684\u30a8\u30ec\u30e1\u30f3\u30c8\u3092\u4f7f\u3063\u3066\u4ed6\u306e\u30bf\u30b0\u3092\u7d44\u307f\u7acb\u3066\u3066\u3044\u307e\u3059\u3002\n$this->input('name'); // og\u30d5\u30a9\u30fc\u30e0\u30d5\u30a3\u30fc\u30eb\u30c9\n$this->error('name'); // \u30a8\u30e9\u30fc\u30e1\u30c3\u30bb\u30fc\u30b8\n\n\u5b9f\u969b\u306b\u306f\u4f8b\u3048\u3070Bootstrap\u4f7f\u7528\u306a\u3069\u30d5\u30a9\u30fc\u30e0\u30a8\u30ec\u30e1\u30f3\u30c8\u306e\u305f\u3081\u540c\u3058\u30de\u30fc\u30af\u30a2\u30c3\u30d7\u3092\u884c\u3046\u3053\u3068\u304c\u591a\u304f\u3001\u3053\u306e\u3088\u3046\u306a\u30e1\u30bd\u30c3\u30c9\u3092\u8a2d\u7f6e\u3059\u308b\u3068\u4fbf\u5229\u3067\u3059\u3002\u30af\u30e9\u30b9\u306b\u3057\u3066\u30a4\u30f3\u30b8\u30a7\u30af\u30c8\u3059\u308b\u3068\u518d\u5229\u7528\u6027\u304c\u9ad8\u307e\u308a\u307e\u3059\u3002\n    private function inputGroup($input, $label)\n    {\n        /** @var $tag Tag */\n        $tag = $this->helper->get('tag');\n        $html = $tag('div', ['class' => 'form-group']);\n        $html .= $tag('label', ['for' => $input, 'class' => 'col-sm-4 control-label']);\n        $html .= $label;\n        $html .= $tag('/label') . PHP_EOL;\n        $html .= $tag('div', ['class' => 'col-sm-8']);\n        $html .= $this->input($input);\n        $html .= $this->error($input);\n        $html .= $tag('/div') . PHP_EOL;\n        $html .= $tag('/div') . PHP_EOL;\n\n        return $html;\n    }\n\nTwig\u3084\u4ed6\u306e\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u30a8\u30f3\u30b8\u30f3\u3092\u4f7f\u3046\u5834\u5408\u306f\u30d5\u30a9\u30fc\u30e0\u30af\u30e9\u30b9\u306b\u30a4\u30f3\u30b8\u30a7\u30af\u30c8\u3057\u3066\u4f7f\u3044\u307e\u3059\u3002\n\n\u30d5\u30a9\u30fc\u30e0\u306e\u30c6\u30b9\u30c8\n\u30d5\u30a9\u30fc\u30e0\u306e\u30c6\u30b9\u30c8\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u306a\u308a\u307e\u3059apply()\u3067\u30d0\u30ea\u30c7\u30fc\u30b7\u30e7\u30f3\u304c\u3001(string)\u8a55\u4fa1\u3067HTML\u306e\u78ba\u8a8d\u304c\u3067\u304d\u307e\u3059\u3002\nclass NameFormTest extends \\PHPUnit_Framework_TestCase\n{\n    /**\n     * @var AbstractForm\n     */\n    private $form;\n\n    protected function setUp()\n    {\n        parent::setUp();\n        /* @var $form MinForm */\n        $this->form = (new FormFactory)->newInstance(MinForm::class);\n    }\n\n    public function testValdationFailed()\n    {\n        $isValid = $this->form->apply([]);\n        $this->assertFalse($isValid);\n    }\n\n    public function testValidationSuccess()\n    {\n        $isValid = $this->form->apply([\n            'name' => 'BEAR'\n        ]);\n        $this->assertTrue($isValid);\n    }\n\n    public function testHtml()\n    {\n        $html = (string) $this->form;\n        $this->assertContains('<form method=\"post\"', $html);\n        $this->assertContains('<input id=\"name\" type=\"text\" name=\"name\" size=\"20\" maxlength=\"20\"', $html);\n    }\n}\n\n\u91cd\u8981:\n\u30d5\u30a9\u30fc\u30e0\u3092\u5b9f\u969b\u306b\u30da\u30fc\u30b8\u306b\u8a2d\u7f6e\u3059\u308b\u524d\u306b\u3001\u30d5\u30a9\u30fc\u30e0\u30af\u30e9\u30b9\u306e\u4f5c\u6210\u3068\u30c6\u30b9\u30c8\u3092\u7d42\u308f\u3089\u305b\u3066\u304a\u304f\u3053\u3068\u3092\u52e7\u3081\u307e\u3059\u3002\n\n\u30d5\u30a9\u30fc\u30e0\u3092\u30da\u30fc\u30b8\u306b\u8a2d\u7f6e\n\u30d5\u30a9\u30fc\u30e0\u3092\u30da\u30fc\u30b8\u306b\u30a4\u30f3\u30b8\u30a7\u30af\u30c8\u3057\u3066\u3001\u30d5\u30a9\u30fc\u30e0\u30d0\u30ea\u30c7\u30fc\u30b7\u30e7\u30f3\u3092\u884c\u3046\u30e1\u30bd\u30c3\u30c9\u306b\uff20FormValidation\u3068\u30a2\u30ce\u30c6\u30fc\u30c8\u3057\u307e\u3059\u3002\n@FormValidation\u3067\u306f\u30d0\u30ea\u30c7\u30fc\u30b7\u30e7\u30f3\u304c\u5931\u6557\u3059\u308c\u3070ValidationFailed()\u306e\u30b5\u30d5\u30a3\u30c3\u30af\u30b9\u304c\u3064\u3044\u305f\u30e1\u30bd\u30c3\u30c9onPostValidationFailed()\u304c\u547c\u3070\u308c\u307e\u3059\u3002\n\nclass Min extends ResourceObject\n{\n    /**\n     * @var FormInterface\n     */\n    protected $form;\n\n    /**\n     * @param FormInterface $form\n     *\n     * @Inject\n     * @Named(\"name\")\n     */\n    public function __construct(FormInterface $form)\n    {\n        $this->form = $form;\n    }\n\n    public function onGet()\n    {\n        $this['form'] = $this->form;\n        return $this;\n    }\n\n    /**\n     * @FormValidation\n     *\n     * @param $name\n     *\n     * @return $this\n     */\n    public function onPost($name)\n    {\n        $this->code = 201;\n        $this['name'] = $name;\n        return $this;\n    }\n\n    public function onPostValidationFailed()\n    {\n        $this->code = 400;\n        return $this->onGet();\n    }\n}\n\n@FormValidation\u30a2\u30ce\u30c6\u30fc\u30b7\u30e7\u30f3\u3067\u306f\u30d5\u30a9\u30fc\u30e0\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306e\u30d7\u30ed\u30d1\u30c6\u30a3\u540d\u3068\u30d0\u30ea\u30c7\u30fc\u30b7\u30e7\u30f3\u5931\u6557\u6642\u306b\u30b3\u30fc\u30eb\u3059\u308b\u30e1\u30bd\u30c3\u30c9\u540d\u304c\u6307\u5b9a\u3067\u304d\u307e\u3059\u3002\u7121\u6307\u5b9a\u3060\u3068\u305d\u308c\u305e\u308cform, \u30e1\u30bd\u30c3\u30c9\u540d + ValidationFailed()\u3067\u3059\u3002(onPostValidationFailed\u306a\u3069\uff09\n@FormValidation(form=\"loginForm\", onFailure=\"onFailure\")\n\n\n\u4f8b\u5916\n@FormValidation\u306e\u4ee3\u308f\u308a\u306b@InputValidation\u3068\u30a2\u30ce\u30c6\u30fc\u30c8\u3059\u308b\u3068ValidationException\u4f8b\u5916\u304c\u6295\u3052\u3089\u308c\u307e\u3059\u3002\n\u30ad\u30e3\u30c3\u30c1\u3057\u305f$e\u306e$e->error\u306b\u306fapplication/vnd.error+json\u30e1\u30c7\u30a3\u30a2\u30bf\u30a4\u30d7\u306e\u30a8\u30e9\u30fc\u3068\u3057\u3066\u6271\u3048\u308b\u6587\u5b57\u5217\u304c\u3042\u308a\u307e\u3059\u3002\nheader('Content-Type: application/vnd.error+json');\necho $e->error;\n\n//{\n//    \"message\": \"Validation failed\",\n//    \"path\": \"/path/to/error\",\n//    \"validation_messages\": {\n//        \"name\": [\n//            \"Name must be alphabetic only.\"\n//        ]\n//    }\n//} \n\nVndErrorModule\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\u3068@FormValidation\u3068\u30a2\u30ce\u30c6\u30fc\u30c8\u3055\u308c\u3066\u3044\u3066\u3082@InputValidation\u3068\u540c\u3058\u3088\u3046\u306b\u4f8b\u5916\u3092\u767a\u751f\u3057\u307e\u3059\u3002\n\n\u30da\u30fc\u30b8\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\nform\u306ehtml\u5168\u4f53\u306f{{ form|raw }}\u3067\u30ec\u30f3\u30c0\u30ea\u30f3\u30b0\u3055\u308c\u307e\u3059\u3002\n{% if _code == 201 %}\n    <h1>201</h1>\n    <p>Name: {{ name }}</p>\n{% else %}\n    <h1>{{ _code }}</h1>\n    {{ form|raw }}\n{% endif %}\n\n_code\u306b\u306f\u30ea\u30bd\u30fc\u30b9\u306e\u30b9\u30c6\u30fc\u30bf\u30b9\u30b3\u30fc\u30c9\u304c\u5165\u308b\u306e\u3067\u305d\u308c\u3067\u5185\u5bb9\u3092\u5909\u3048\u3066\u3044\u307e\u3059\u3002\u30b3\u30fc\u30c9\u306e\u898f\u6a21\u304c\u5897\u3048\u308c\u3070\u5225\u306e\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u306b\u3059\u308b\u306e\u304c\u826f\u3044\u3067\u3057\u3087\u3046\u3002\nhtml,error\u306e\u30e1\u30bd\u30c3\u30c9\u3092\u4f7f\u3063\u3066\u500b\u5225\u306b\u30a8\u30ec\u30e1\u30f3\u30c8\u3060\u3051\u3092\u30ec\u30f3\u30c0\u30ea\u30f3\u30b0\u3059\u308b\u3053\u3068\u3082\u3067\u304d\u307e\u3059\u3002\n\n{{ form.input('name') }}\n{{ form.error('name') }}\n\n\n\u30da\u30fc\u30b8\u306e\u30c6\u30b9\u30c8\n\u30d5\u30a9\u30fc\u30e0\u306e\u30c6\u30b9\u30c8\u3067\u30d0\u30ea\u30c7\u30fc\u30b7\u30e7\u30f3\u3084HTML\u8868\u73fe\u306e\u30c6\u30b9\u30c8\u306f\u3067\u304d\u3066\u3044\u308c\u3070\u3001\u30d5\u30a9\u30fc\u30e0\u306b\u95a2\u9023\u3059\u308b\u30da\u30fc\u30b8\u306e\u30c6\u30b9\u30c8\u306f\u307b\u3068\u3093\u3069\u5fc5\u8981\u304c\u3042\u308a\u307e\u305b\u3093\u3002\u305d\u308c\u305e\u308c\u5225\u306e\u5834\u6240\u3067\u540c\u7b49\u306e\u52b9\u679c\u3092\u6301\u3064\u30c6\u30b9\u30c8\u3092\u7d42\u3048\u3066\u3044\u308b\u305f\u3081\u3067\u3059\u3002\u30d5\u30a9\u30fc\u30e0\u306e\u305f\u3081\u306eWeb\u30d6\u30e9\u30a6\u30b6\u3092\u4f7f\u3063\u305f\u81ea\u52d5\u30c6\u30b9\u30c8\u3082\u3042\u307e\u308a\u5fc5\u8981\u3042\u308a\u307e\u305b\u3093\u3002\n\n\u30d5\u30a9\u30fc\u30e0\u3068DI\n\u30d5\u30a9\u30fc\u30e0\u306f\u30a4\u30f3\u30b8\u30a7\u30af\u30c8\u3055\u308c\u308b\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306a\u306e\u3067\u30b3\u30f3\u30c6\u30ad\u30b9\u30c8\u3084\u30ea\u30bd\u30fc\u30b9\u306e\u72b6\u614b\u306b\u3088\u3063\u3066\u52d5\u7684\u306b\u5909\u3048\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\u4f8b\u3048\u3070\u30ed\u30b0\u30a4\u30f3\u3057\u3066\u308b\u304b\u3057\u3066\u306a\u3044\u304b\u3067\u30da\u30fc\u30b8\u30af\u30e9\u30b9\u306e\u5909\u66f4\u306a\u3057\u306b\"\u30b3\u30e1\u30f3\u30c8\u6295\u7a3f\"\u306e\u30d5\u30a9\u30fc\u30e0\u3092\u5909\u3048\u308b\u304c\u3067\u304d\u307e\u3059\u3002\n\n\u53c2\u8003\u30ea\u30f3\u30af\n\nRay.WebFormModule - https://github.com/ray-di/Ray.WebFormModule\n\n\u30d5\u30a9\u30fc\u30e0 - http://bearsunday.github.io/manuals/1.0/ja/form.html\n\n\n\u30d5\u30a9\u30fc\u30e0\u30d0\u30ea\u30c7\u30fc\u30b7\u30e7\u30f3\u306f\u30d0\u30ea\u30c7\u30fc\u30b7\u30e7\u30f3\u3059\u308b\u30e1\u30bd\u30c3\u30c9\u306b`@FormValidation`\u3068\u30a2\u30ce\u30c6\u30fc\u30b7\u30e7\u30f3\u3068\u3059\u308b\u3053\u3068\u3067\u884c\u308f\u308c\u307e\u3059\u3002\n\n# Form\u30af\u30e9\u30b9\n\nForm\u306e\u30da\u30fc\u30b8\u3092\u4f5c\u6210\u3059\u308b\u305f\u3081\u306b\u6700\u521d\u306bForm\u30af\u30e9\u30b9\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002Form\u30af\u30e9\u30b9\u306f\u30d5\u30a9\u30fc\u30e0\u306e\u767b\u9332\u3068\u521d\u671f\u5316\u3001\u30eb\u30fc\u30eb\u9069\u7528\u3001HTML\u8868\u73fe\u306a\u3069\u30d5\u30a9\u30fc\u30e0\u306b\u95a2\u9023\u3059\u308b\u8981\u7d20\u304c\uff11\u3064\u306b\u96c6\u7d04\u3055\u308c\u3066\u3044\u307e\u3059\u3002\n\n\n```php\nclass MyForm extends AbstractForm\n{\n    /**\n     * {@inheritdoc}\n     */\n    public function init()\n\n        $this->setField('name')\n            ->setAttribs([\n                'id' => 'name',\n                'name' => 'name',\n                'size' => 20,\n                'maxlength' => 20,\n                'class' => 'form-control',\n                'placeholder' => 'Your Name'\n            ]);\n        $this->setField('submit', 'submit')\n            ->setAttribs([\n                'name' => 'submit',\n                'value' => 'Submit'\n            ]);\n        $this->filter->validate('name')->isNot('blank');\n        $this->filter->validate('name')->is('alnum');\n        $this->filter->useFieldMessage('name', 'Name must be alphabetic only !!.');\n```\n\n\u30d5\u30a9\u30fc\u30e0\u3067\u4f7f\u3046\u5024\u3067\u30ea\u30bd\u30fc\u30b9\u3084\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306e\u30a2\u30af\u30bb\u30b9\u304c\u5fc5\u8981\u306a\u5834\u5408\u306f\u3001\u30a4\u30f3\u30b8\u30a7\u30af\u30c8\u3057\u3066\u4f7f\u3044\u307e\u3059\u3002\n\n## \u30d5\u30a9\u30fc\u30e0\u521d\u671f\u5316\n\n`init()`\u30e1\u30bd\u30c3\u30c9\u3067\u306f\u30d5\u30a9\u30fc\u30e0\u306e\u30d5\u30a3\u30fc\u30eb\u30c9\u306b\u30a2\u30c8\u30ea\u30d3\u30e5\u30fc\u30c8\u3084\u30eb\u30fc\u30eb\u3092\u767b\u9332\u3057\u3066\u30d5\u30a9\u30fc\u30e0\u3092\u521d\u671f\u5316\u3057\u307e\u3059\u3002\n\n### \u30d5\u30a3\u30fc\u30eb\u30c9\u767b\u9332\n\n\u307e\u305a\u30d5\u30a9\u30fc\u30e0\u30d5\u30a3\u30fc\u30eb\u30c9`name`\u3092\u30a2\u30c8\u30ea\u30d3\u30e5\u30fc\u30c8\u3068\u4e00\u7dd2\u306b\u30bb\u30c3\u30c8\u3057\u307e\u3059\u3002\n\n```php\n$this->setField('name', 'text')->setAttribs(['id' => 'name']);\n```\n\n### \u30d0\u30ea\u30c7\u30fc\u30b7\u30e7\u30f3\u767b\u9332\n\n\u6b21\u306b\u30bb\u30c3\u30c8\u3057\u305f\u30d5\u30a3\u30fc\u30eb\u30c9\u306b\u5bfe\u3057\u3066\u30d0\u30ea\u30c7\u30fc\u30b7\u30e7\u30f3\u3092\u30bb\u30c3\u30c8\u3057\u307e\u3059\u3002\n\n```php\n$this->filter->validate('name')->is('alnum');\n$this->filter->validate('name')->is('alpha');\n$this->filter->validate('name')->is('between', $min, $max);\n$this->filter->validate('name')->is('blank');\n$this->filter->validate('name')->is('bool');\n$this->filter->validate('name')->is('callback', function ($subject, $field) {\n    if ($subject->$field === 'foo') {\n        return true;\n    }\n    return false;\n});\n// ...\n```\n\u30d0\u30ea\u30fc\u30c7\u30fc\u30bf\u306f[Aura.Filter v2](https://github.com/auraphp/Aura.Filter/tree/2.x)\u3067\u3059\u3002\u30d0\u30ea\u30c7\u30fc\u30b7\u30e7\u30f3\u304c\u5fc5\u8981\u306a[filter](https://github.com/auraphp/Aura.Filter/blob/2.x/docs/validate.md)\u3068\u6307\u5b9a\u306e\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u306b\u5909\u63db\u3059\u308b[sanitize](https://github.com/auraphp/Aura.Filter/blob/2.x/docs/sanitize.md)\u304c\u3042\u308a\u307e\u3059\u3002\n\n\u30d0\u30ea\u30c7\u30fc\u30b7\u30e7\u30f3\u306f\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3084\u30a2\u30ce\u30c6\u30fc\u30b7\u30e7\u30f3\u3067\u6307\u5b9a\u3059\u308b\u306e\u3067\u306f\u306a\u304f\u3001PHP\u3067\u8a18\u8ff0\u3057\u307e\u3059\u3002\n\n### \u30e1\u30c3\u30bb\u30fc\u30b8\n\n```php\n$this->filter->useFieldMessage('name', 'Name must be alphabetic only.');\n```\n\n\u30a8\u30e9\u30fc\u30e1\u30c3\u30bb\u30fc\u30b8\u3092**\u30d5\u30a3\u30fc\u30eb\u30c9**\u306b\u5bfe\u3057\u3066\u30bb\u30c3\u30c8\u3057\u307e\u3059\u3002\n\n * ID\u306f\u30a2\u30eb\u30d5\u30a1\u30d9\u30c3\u30c8\u3067\u6307\u5b9a\u3057\u3066\u304f\u3060\u3055\u3044\n * ID\u306f\uff14\u6587\u5b57\u4ee5\u4e0a\u3067\u6307\u5b9a\u3057\u3066\u304f\u3060\u3055\u3044\n\n\u306e\u3088\u3046\u306b\u30eb\u30fc\u30eb\u5358\u4f4d\u3067\u30a8\u30e9\u30fc\u304c\u51fa\u308b\u306e\u3067\u306f\u306a\u304f**\u300cID\u306f\u30a2\u30eb\u30d5\u30a1\u30d9\u30c3\u30c8\uff14\u6587\u5b57\u4ee5\u4e0a\u3067\u6307\u5b9a\u3057\u3066\u304f\u3060\u3055\u3044\u300d**\u3068\u3044\u3046\u98a8\u306b\u30d5\u30a3\u30fc\u30eb\u30c9\u5358\u4f4d\u3067\u306e\u30a8\u30e9\u30fc\u306b\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n## \u30d5\u30a9\u30fc\u30e0\u306eHTML\n\nForm\u30af\u30e9\u30b9\u306e`__toString()`\u30e1\u30bd\u30c3\u30c9\u3067html\u51fa\u529b\u3092\u8fd4\u3057\u307e\u3059\u3002\n\n```php\n    /**\n     * {@inheritdoc}\n     */\n    public function __toString()\n    {\n        $form = $this->form([\n            'method' => 'post',\n            'action' => '/min'\n        ]);\n        // name\n        /** @var $tag Tag */\n        $tag  = $this->helper->get('tag');\n        $form .= $tag('div', ['class' => 'form-group']);\n        $form .= $this->helper->tag('div', ['class' => 'form-group']);\n        $form .= $this->helper->tag('label', ['for' => 'name']);\n        $form .= 'Name:';\n        $form .= $this->helper->tag('/label') . PHP_EOL;\n        $form .= $this->input('name');\n        $form .= $this->error('name');\n        $form .= $this->helper->tag('/div') . PHP_EOL;\n        // submit\n        $form .= $this->input('submit');\n        $form .= $this->helper->tag('/form');\n\n        return $form;\n    }\n```\n\n\u57fa\u672c\u7684\u306b\u4ee5\u4e0b\u306e\uff12\u3064\u306e\u52d5\u7684\u30a8\u30ec\u30e1\u30f3\u30c8\u3092\u4f7f\u3063\u3066\u4ed6\u306e\u30bf\u30b0\u3092\u7d44\u307f\u7acb\u3066\u3066\u3044\u307e\u3059\u3002\n\n```php\n$this->input('name'); // og\u30d5\u30a9\u30fc\u30e0\u30d5\u30a3\u30fc\u30eb\u30c9\n$this->error('name'); // \u30a8\u30e9\u30fc\u30e1\u30c3\u30bb\u30fc\u30b8\n```\n\n\u5b9f\u969b\u306b\u306f\u4f8b\u3048\u3070Bootstrap\u4f7f\u7528\u306a\u3069\u30d5\u30a9\u30fc\u30e0\u30a8\u30ec\u30e1\u30f3\u30c8\u306e\u305f\u3081\u540c\u3058\u30de\u30fc\u30af\u30a2\u30c3\u30d7\u3092\u884c\u3046\u3053\u3068\u304c\u591a\u304f\u3001\u3053\u306e\u3088\u3046\u306a\u30e1\u30bd\u30c3\u30c9\u3092\u8a2d\u7f6e\u3059\u308b\u3068\u4fbf\u5229\u3067\u3059\u3002\u30af\u30e9\u30b9\u306b\u3057\u3066\u30a4\u30f3\u30b8\u30a7\u30af\u30c8\u3059\u308b\u3068\u518d\u5229\u7528\u6027\u304c\u9ad8\u307e\u308a\u307e\u3059\u3002\n\n```php\n    private function inputGroup($input, $label)\n    {\n        /** @var $tag Tag */\n        $tag = $this->helper->get('tag');\n        $html = $tag('div', ['class' => 'form-group']);\n        $html .= $tag('label', ['for' => $input, 'class' => 'col-sm-4 control-label']);\n        $html .= $label;\n        $html .= $tag('/label') . PHP_EOL;\n        $html .= $tag('div', ['class' => 'col-sm-8']);\n        $html .= $this->input($input);\n        $html .= $this->error($input);\n        $html .= $tag('/div') . PHP_EOL;\n        $html .= $tag('/div') . PHP_EOL;\n\n        return $html;\n    }\n```\n\nTwig\u3084\u4ed6\u306e\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u30a8\u30f3\u30b8\u30f3\u3092\u4f7f\u3046\u5834\u5408\u306f\u30d5\u30a9\u30fc\u30e0\u30af\u30e9\u30b9\u306b\u30a4\u30f3\u30b8\u30a7\u30af\u30c8\u3057\u3066\u4f7f\u3044\u307e\u3059\u3002\n\n## \u30d5\u30a9\u30fc\u30e0\u306e\u30c6\u30b9\u30c8\n\n\u30d5\u30a9\u30fc\u30e0\u306e\u30c6\u30b9\u30c8\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u306a\u308a\u307e\u3059`apply()`\u3067\u30d0\u30ea\u30c7\u30fc\u30b7\u30e7\u30f3\u304c\u3001`(string)`\u8a55\u4fa1\u3067HTML\u306e\u78ba\u8a8d\u304c\u3067\u304d\u307e\u3059\u3002\n\n\n```php\nclass NameFormTest extends \\PHPUnit_Framework_TestCase\n{\n    /**\n     * @var AbstractForm\n     */\n    private $form;\n\n    protected function setUp()\n    {\n        parent::setUp();\n        /* @var $form MinForm */\n        $this->form = (new FormFactory)->newInstance(MinForm::class);\n    }\n\n    public function testValdationFailed()\n    {\n        $isValid = $this->form->apply([]);\n        $this->assertFalse($isValid);\n    }\n\n    public function testValidationSuccess()\n    {\n        $isValid = $this->form->apply([\n            'name' => 'BEAR'\n        ]);\n        $this->assertTrue($isValid);\n    }\n\n    public function testHtml()\n    {\n        $html = (string) $this->form;\n        $this->assertContains('<form method=\"post\"', $html);\n        $this->assertContains('<input id=\"name\" type=\"text\" name=\"name\" size=\"20\" maxlength=\"20\"', $html);\n    }\n}\n```\n\n**\u91cd\u8981:**\n\n\u30d5\u30a9\u30fc\u30e0\u3092\u5b9f\u969b\u306b\u30da\u30fc\u30b8\u306b\u8a2d\u7f6e\u3059\u308b\u524d\u306b\u3001\u30d5\u30a9\u30fc\u30e0\u30af\u30e9\u30b9\u306e\u4f5c\u6210\u3068\u30c6\u30b9\u30c8\u3092\u7d42\u308f\u3089\u305b\u3066\u304a\u304f\u3053\u3068\u3092\u52e7\u3081\u307e\u3059\u3002\n\n## \u30d5\u30a9\u30fc\u30e0\u3092\u30da\u30fc\u30b8\u306b\u8a2d\u7f6e\n\n\u30d5\u30a9\u30fc\u30e0\u3092\u30da\u30fc\u30b8\u306b\u30a4\u30f3\u30b8\u30a7\u30af\u30c8\u3057\u3066\u3001\u30d5\u30a9\u30fc\u30e0\u30d0\u30ea\u30c7\u30fc\u30b7\u30e7\u30f3\u3092\u884c\u3046\u30e1\u30bd\u30c3\u30c9\u306b`\uff20FormValidation`\u3068\u30a2\u30ce\u30c6\u30fc\u30c8\u3057\u307e\u3059\u3002\n\n`@FormValidation`\u3067\u306f\u30d0\u30ea\u30c7\u30fc\u30b7\u30e7\u30f3\u304c\u5931\u6557\u3059\u308c\u3070`ValidationFailed()`\u306e\u30b5\u30d5\u30a3\u30c3\u30af\u30b9\u304c\u3064\u3044\u305f\u30e1\u30bd\u30c3\u30c9`onPostValidationFailed()`\u304c\u547c\u3070\u308c\u307e\u3059\u3002\n\n```php\n\nclass Min extends ResourceObject\n{\n    /**\n     * @var FormInterface\n     */\n    protected $form;\n\n    /**\n     * @param FormInterface $form\n     *\n     * @Inject\n     * @Named(\"name\")\n     */\n    public function __construct(FormInterface $form)\n    {\n        $this->form = $form;\n    }\n\n    public function onGet()\n    {\n        $this['form'] = $this->form;\n        return $this;\n    }\n\n    /**\n     * @FormValidation\n     *\n     * @param $name\n     *\n     * @return $this\n     */\n    public function onPost($name)\n    {\n        $this->code = 201;\n        $this['name'] = $name;\n        return $this;\n    }\n\n    public function onPostValidationFailed()\n    {\n        $this->code = 400;\n        return $this->onGet();\n    }\n}\n```\n`@FormValidation`\u30a2\u30ce\u30c6\u30fc\u30b7\u30e7\u30f3\u3067\u306f\u30d5\u30a9\u30fc\u30e0\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306e\u30d7\u30ed\u30d1\u30c6\u30a3\u540d\u3068\u30d0\u30ea\u30c7\u30fc\u30b7\u30e7\u30f3\u5931\u6557\u6642\u306b\u30b3\u30fc\u30eb\u3059\u308b\u30e1\u30bd\u30c3\u30c9\u540d\u304c\u6307\u5b9a\u3067\u304d\u307e\u3059\u3002\u7121\u6307\u5b9a\u3060\u3068\u305d\u308c\u305e\u308c`form`, \u30e1\u30bd\u30c3\u30c9\u540d + `ValidationFailed()`\u3067\u3059\u3002(`onPostValidationFailed`\u306a\u3069\uff09\n\n```\n@FormValidation(form=\"loginForm\", onFailure=\"onFailure\")\n```\n\n## \u4f8b\u5916\n\n`@FormValidation`\u306e\u4ee3\u308f\u308a\u306b`@InputValidation`\u3068\u30a2\u30ce\u30c6\u30fc\u30c8\u3059\u308b\u3068`ValidationException`\u4f8b\u5916\u304c\u6295\u3052\u3089\u308c\u307e\u3059\u3002\n\n\u30ad\u30e3\u30c3\u30c1\u3057\u305f`$e`\u306e`$e->error`\u306b\u306f[application/vnd.error+json](https://github.com/blongden/vnd.error)\u30e1\u30c7\u30a3\u30a2\u30bf\u30a4\u30d7\u306e\u30a8\u30e9\u30fc\u3068\u3057\u3066\u6271\u3048\u308b\u6587\u5b57\u5217\u304c\u3042\u308a\u307e\u3059\u3002\n\n```php\nheader('Content-Type: application/vnd.error+json');\necho $e->error;\n\n//{\n//    \"message\": \"Validation failed\",\n//    \"path\": \"/path/to/error\",\n//    \"validation_messages\": {\n//        \"name\": [\n//            \"Name must be alphabetic only.\"\n//        ]\n//    }\n//} \n```\n`VndErrorModule`\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\u3068`@FormValidation`\u3068\u30a2\u30ce\u30c6\u30fc\u30c8\u3055\u308c\u3066\u3044\u3066\u3082`@InputValidation`\u3068\u540c\u3058\u3088\u3046\u306b\u4f8b\u5916\u3092\u767a\u751f\u3057\u307e\u3059\u3002\n\n## \u30da\u30fc\u30b8\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\n\nform\u306ehtml\u5168\u4f53\u306f`{{ form|raw }}`\u3067\u30ec\u30f3\u30c0\u30ea\u30f3\u30b0\u3055\u308c\u307e\u3059\u3002\n\n```\n{% if _code == 201 %}\n    <h1>201</h1>\n    <p>Name: {{ name }}</p>\n{% else %}\n    <h1>{{ _code }}</h1>\n    {{ form|raw }}\n{% endif %}\n```\n\n `_code`\u306b\u306f\u30ea\u30bd\u30fc\u30b9\u306e\u30b9\u30c6\u30fc\u30bf\u30b9\u30b3\u30fc\u30c9\u304c\u5165\u308b\u306e\u3067\u305d\u308c\u3067\u5185\u5bb9\u3092\u5909\u3048\u3066\u3044\u307e\u3059\u3002\u30b3\u30fc\u30c9\u306e\u898f\u6a21\u304c\u5897\u3048\u308c\u3070\u5225\u306e\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u306b\u3059\u308b\u306e\u304c\u826f\u3044\u3067\u3057\u3087\u3046\u3002\n\n\n`html`,`error`\u306e\u30e1\u30bd\u30c3\u30c9\u3092\u4f7f\u3063\u3066\u500b\u5225\u306b\u30a8\u30ec\u30e1\u30f3\u30c8\u3060\u3051\u3092\u30ec\u30f3\u30c0\u30ea\u30f3\u30b0\u3059\u308b\u3053\u3068\u3082\u3067\u304d\u307e\u3059\u3002\n\n * `{{ form.input('name') }}`\n * `{{ form.error('name') }}`\n\n## \u30da\u30fc\u30b8\u306e\u30c6\u30b9\u30c8\n\n\u30d5\u30a9\u30fc\u30e0\u306e\u30c6\u30b9\u30c8\u3067\u30d0\u30ea\u30c7\u30fc\u30b7\u30e7\u30f3\u3084HTML\u8868\u73fe\u306e\u30c6\u30b9\u30c8\u306f\u3067\u304d\u3066\u3044\u308c\u3070\u3001\u30d5\u30a9\u30fc\u30e0\u306b\u95a2\u9023\u3059\u308b\u30da\u30fc\u30b8\u306e\u30c6\u30b9\u30c8\u306f\u307b\u3068\u3093\u3069\u5fc5\u8981\u304c\u3042\u308a\u307e\u305b\u3093\u3002\u305d\u308c\u305e\u308c\u5225\u306e\u5834\u6240\u3067\u540c\u7b49\u306e\u52b9\u679c\u3092\u6301\u3064\u30c6\u30b9\u30c8\u3092\u7d42\u3048\u3066\u3044\u308b\u305f\u3081\u3067\u3059\u3002\u30d5\u30a9\u30fc\u30e0\u306e\u305f\u3081\u306eWeb\u30d6\u30e9\u30a6\u30b6\u3092\u4f7f\u3063\u305f\u81ea\u52d5\u30c6\u30b9\u30c8\u3082\u3042\u307e\u308a\u5fc5\u8981\u3042\u308a\u307e\u305b\u3093\u3002\n\n## \u30d5\u30a9\u30fc\u30e0\u3068DI\n\n\u30d5\u30a9\u30fc\u30e0\u306f\u30a4\u30f3\u30b8\u30a7\u30af\u30c8\u3055\u308c\u308b\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306a\u306e\u3067\u30b3\u30f3\u30c6\u30ad\u30b9\u30c8\u3084\u30ea\u30bd\u30fc\u30b9\u306e\u72b6\u614b\u306b\u3088\u3063\u3066\u52d5\u7684\u306b\u5909\u3048\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\u4f8b\u3048\u3070\u30ed\u30b0\u30a4\u30f3\u3057\u3066\u308b\u304b\u3057\u3066\u306a\u3044\u304b\u3067\u30da\u30fc\u30b8\u30af\u30e9\u30b9\u306e\u5909\u66f4\u306a\u3057\u306b\"\u30b3\u30e1\u30f3\u30c8\u6295\u7a3f\"\u306e\u30d5\u30a9\u30fc\u30e0\u3092\u5909\u3048\u308b\u304c\u3067\u304d\u307e\u3059\u3002\n\n## \u53c2\u8003\u30ea\u30f3\u30af\n\n * Ray.WebFormModule - https://github.com/ray-di/Ray.WebFormModule\n * \u30d5\u30a9\u30fc\u30e0 - http://bearsunday.github.io/manuals/1.0/ja/form.html\n", "tags": ["BEAR.Sunday"]}