{"context": "\n\n1. \u306f\u3058\u3081\u306b\n\u30aa\u30d7\u30b7\u30e7\u30f3\u304c\u305f\u304f\u3055\u3093\u3042\u3063\u3066\u8907\u96d1\u306aSTP\u306e\u8a2d\u5b9a\u65b9\u6cd5\u3092\u307e\u3068\u3081\u307e\u3059\u3002\n\n2. \u524d\u63d0\n\u4f7f\u3046\u306e\u306fRPVST (Rapid Per-Vlan Spanning-Tree)\u3002\n\n3. \u8a2d\u5b9a\u65b9\u6cd5\nRPVST\u306e\u6709\u52b9\u5316\uff1a\n(config)#spanning-tree mode rapid-pvst\n\nPrimary/Secondry\u30d6\u30ea\u30c3\u30b8\u306e\u8a2d\u5b9a\uff1a\n\u30001\u7cfb\u30b9\u30a4\u30c3\u30c1\u306b\u5bfe\u3057\u3066\n(config)#spanning-tree vlan 1-4094 priority 0\n\n\u30002\u7cfb\u30b9\u30a4\u30c3\u30c1\u306b\u5bfe\u3057\u3066\n(config)#spanning-tree vlan 1-4094 priority 4096\n\nBPDU Guard\u306e\u6709\u52b9\u5316\uff1a\n(config)#spanning-tree portfast bpduguard default\n\nPortfast\u306e\u8a2d\u5b9a\uff1a\n\u3000\u30a2\u30af\u30bb\u30b9\u30ea\u30f3\u30af\u306b\u5bfe\u3057\u3066\ntc0001(config-if)#spanning-tree portfast\n\n\u3000\u30c8\u30e9\u30f3\u30af\u30ea\u30f3\u30af\u306b\u5bfe\u3057\u3066\ntc0001(config-if)#spanning-tree portfast trunk\n\n\n4. \u89e3\u8aac\n\n4-1. RPVST\u306e\u6709\u52b9\u5316\n\u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u306fRPVST\u3067\u306f\u306a\u304fPVST\u304c\u6709\u52b9\u306b\u306a\u3063\u3066\u3044\u307e\u3059\u306e\u3067\u3001RPVST\u306b\u5909\u66f4\u3057\u307e\u3059\u3002\ntc0001#show spanning-tree\n\nVLAN0001\n  Spanning tree enabled protocol ieee\n\uff08\u4ee5\u4e0b\u7701\u7565\uff09\n\ntc0001#conf t\nEnter configuration commands, one per line.  End with CNTL/Z.\ntc0001(config)#spanning-tree mode rapid-pvst\ntc0001(config)#end\ntc0001#show spanning-tree\n\nVLAN0001\n  Spanning tree enabled protocol rstp\n\uff08\u4ee5\u4e0b\u7701\u7565\uff09\n\n\u305f\u307e\u306bno spanning-tree\u3068\u3044\u3046\u60aa\u9b54\u306e\u30b3\u30de\u30f3\u30c9\u3092\u4f7f\u3063\u3066STP\u3092\u5207\u3063\u3066\u3044\u308b\u30b9\u30a4\u30c3\u30c1\u304c\u3042\u308a\u307e\u3059\u304c\u3001\u30b9\u30a4\u30c3\u30c1\u304c\u30b7\u30f3\u30b0\u30eb\u69cb\u6210\u3067\u3042\u3063\u3066\u3082\u7d76\u5bfe\u306b\u8f9e\u3081\u307e\u3057\u3087\u3046\u3002\u4eba\u306f\u30b1\u30fc\u30d6\u30eb\u304c\u3042\u308b\u3068\u7a7a\u304d\u30dd\u30fc\u30c8\u306b\u633f\u3057\u305f\u304f\u306a\u308b\u751f\u304d\u7269\u306a\u306e\u3067\u3059\u3002STP\u3092\u6709\u52b9\u306b\u3059\u308b\u3053\u3068\u306b\u3088\u308b\u30c7\u30e1\u30ea\u30c3\u30c8\u306f\u3042\u308a\u307e\u305b\u3093\u3002\n\n4-2. Primary/Secondary\u30d6\u30ea\u30c3\u30b8\u306e\u8a2d\u5b9a\n\u4e0a\u4f4d\u30b9\u30a4\u30c3\u30c1\u304c2\u53f0\u3042\u308b\u74b0\u5883\u3067\u306f1\u7cfb\u3092primary\u30012\u7cfb\u3092secondary\u306b\u8a2d\u5b9a\u3057\u307e\u3057\u3087\u3046\u3002\u307e\u305a\u306fCisco\u63a8\u5968\u306eroot primary\u3068\u3044\u3046\u30aa\u30d7\u30b7\u30e7\u30f3\u3092\u4f7f\u3063\u3066\u307f\u307e\u3059\u3002\ntc0001#show spanning-tree\nVLAN0001\n  Spanning tree enabled protocol rstp\n  Root ID    Priority    32769\n             Address     0015.6256.6300\n             Cost        19\n             Port        25 (FastEthernet1/0/23)\n\uff08\u4ee5\u4e0b\u7701\u7565\uff09\ntc0001#configure terminal\nEnter configuration commands, one per line.  End with CNTL/Z.\ntc0001(config)#spanning-tree vlan 1-4094 root primary\ntc0001(config)#end\ntc0001#show spanning-tree\n\nVLAN0001\n  Spanning tree enabled protocol rstp\n  Root ID    Priority    24577\n             Address     0016.4779.5500\n             This bridge is the root\n             Hello Time   2 sec  Max Age 20 sec  Forward Delay 15 sec\n\uff08\u4ee5\u4e0b\u7701\u7565\uff09\n\ntc0002#conf t\nEnter configuration commands, one per line.  End with CNTL/Z.\ntc0002(config)#spanning-tree vlan 1-4094 root secondary\ntc0002(config)#end\ntc0002#show spanning-tree\n\uff08\u4ee5\u4e0b\u7701\u7565\uff09\n  Bridge ID  Priority    28673  (priority 28672 sys-id-ext 1)\n             Address     0015.6256.6300\n             Hello Time   2 sec  Max Age 20 sec  Forward Delay 15 sec\n             Aging Time 300\n\nPriority\u304c24576\u306b\u5909\u66f4\u3055\u308c\u307e\u3057\u305f\u3002\u3061\u3087\u3063\u3068\u4e2d\u9014\u534a\u7aef\u3067\u3001\u7d0d\u5f97\u306e\u3044\u304b\u306a\u3044\u6570\u5b57\u3067\u3059\u3002\u65e2\u306b\u4ed6\u306e\u30d6\u30ea\u30c3\u30b8\u306bpriority\u304c\u8a2d\u5b9a\u3057\u3066\u3042\u308b\u6642\u306bprimary\u30aa\u30d7\u30b7\u30e7\u30f3\u3092\u8a2d\u5b9a\u3059\u308b\u3068\u3069\u3046\u306a\u308b\u304b\u3084\u3063\u3066\u307f\u307e\u3057\u3087\u3046\u30022\u7cfb\u30b9\u30a4\u30c3\u30c1\u306bPriority 8192\u3092\u8a2d\u5b9a\u3057\u305f\u72b6\u614b\u304b\u3089\u59cb\u3081\u307e\u3059\u3002\ntc0001#show spanning-tree\n\nVLAN0001\n  Spanning tree enabled protocol rstp\n  Root ID    Priority    8193\n             Address     0015.6256.6300\n             Cost        19\n             Port        26 (FastEthernet1/0/24)\n             Hello Time   2 sec  Max Age 20 sec  Forward Delay 15 sec\n\uff08\u7701\u7565\uff09\ntc0001#configure terminal\ntc0001(config)#spanning-tree vlan 1-4094 root primary\ntc0001(config)#end\ntc0001#show spanning-tree\n\nVLAN0001\n  Spanning tree enabled protocol rstp\n  Root ID    Priority    4097\n             Address     0016.4779.5500\n             This bridge is the root\n             Hello Time   2 sec  Max Age 20 sec  Forward Delay 15 sec\n\uff08\u7701\u7565\uff09\n\n\u4eca\u5ea6\u306fpriority\u304c4096\u306b\u306a\u308a\u307e\u3057\u305f\u3002\u3053\u308c\u306f\u3069\u3046\u3044\u3046\u3053\u3068\u3067\u3057\u3087\u3046\u304b\uff1f\u3000show run\u3067\u8a2d\u5b9a\u3092\u78ba\u8a8d\u3057\u3066\u307f\u307e\u3059\u3002\ntc0001#show running-config | include priority\nspanning-tree vlan 1 priority 4096\nspanning-tree vlan 2-4094 priority 24576\ntc0001#\n\nroot primary\u3068\u3044\u3046\u8a2d\u5b9a\u3092\u5165\u308c\u305f\u306f\u305a\u306a\u306e\u306b\u3001vlan 1\u306epriority\u304c4096\u306b\u3001\u305d\u308c\u4ee5\u5916\u304c24576\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u307e\u3059\u3002\u3069\u3046\u3084\u3089\u3001root primary\u306f\u30b3\u30de\u30f3\u30c9\u304c\u767a\u52b9\u3055\u308c\u305f\u77ac\u9593\u306broot bridge\u306epriority\u3092\u898b\u3066\u3001\u305d\u308c\u3092\u4e0a\u56de\u308b\u3088\u3046\u306b\u8a2d\u5b9a\u3055\u308c\u308b\u3088\u3046\u3067\u3059\u306d\u30022\u7cfb\u30b9\u30a4\u30c3\u30c1\u306epriority\u30920\u306b\u8a2d\u5b9a\u3057\u305f\u72b6\u614b\u3067\u30b3\u30de\u30f3\u30c9\u3092\u5165\u308c\u308b\u3068\u5931\u6557\u3057\u307e\u3059\u3002\ntc0001(config)#spanning-tree vlan 1-4094 root primary\n% Failed to make the bridge root for vlan 1\n% It may be possible to make the bridge root by setting the priority\n% for some (or all) of these instances to zero.\n\n\u3053\u308c\u306fcisco\u306e\u63a8\u5968\u30b3\u30de\u30f3\u30c9\u3067\u306f\u3042\u308a\u307e\u3059\u304c\u3001\u8a2d\u8a08\u3068\u306f\u547c\u3079\u306a\u3044\u3067\u3059\u306d\u3002priority\u306f\u5b9a\u6570\u3067\u8a2d\u5b9a\u3057\u307e\u3057\u3087\u3046\u3002\u5b9f\u969b\u306b\u30eb\u30fc\u30d7\u69cb\u6210\u3092\u53d6\u308b\u8a2d\u8a08\u3060\u3068\u30011\u7cfb\u30b3\u30a2\u30b9\u30a4\u30c3\u30c1\u30012\u7cfb\u30b3\u30a2\u30b9\u30a4\u30c3\u30c1\u3001\u5404\u30a2\u30af\u30bb\u30b9\u30b9\u30a4\u30c3\u30c1\u306e\u9806\u3067priority\u304c\u9ad8\u304f\u306a\u3063\u3066\u3044\u304f\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u30021\u7cfb\u306b\u306f0\u3092\u30012\u7cfb\u306b\u306f4096\u3092\u8a2d\u5b9a\u3057\u307e\u3057\u3087\u3046\u3002\ntc0001(config)#spanning-tree vlan 1-4094 priority 0\ntc0002(config)#spanning-tree vlan 1-4094 priority 4096\n\n\n4-3. BPDU Guard\u306e\u6709\u52b9\u5316\u3068Portfast\nPortfast\u306f\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9\u306b\u8a2d\u5b9a\u3057\u3001\u5bfe\u8c61\u306e\u30dd\u30fc\u30c8\u3067Link up\u304c\u767a\u751f\u3057\u305f\u969b\u306b\u3001Listening\u3068Learning\u306e\u30d7\u30ed\u30bb\u30b9\u3092\u30b9\u30ad\u30c3\u30d7\u3057\u3066\u901f\u3084\u304b\u306bForwarding\u72b6\u614b\u306b\u79fb\u884c\u3055\u305b\u308b\u30b3\u30de\u30f3\u30c9\u3067\u3059\u3002STP\u3068\u306f\u95a2\u4fc2\u306e\u306a\u3044\u30b5\u30fc\u30d0\u3001PC\u3001\u30eb\u30fc\u30bf\u7b49\u304c\u63a5\u7d9a\u3055\u308c\u308b\u30dd\u30fc\u30c8\u3067\u4f7f\u7528\u3057\u307e\u3059\u3002\nSTP\u3067BLK\u72b6\u614b\u306eport\u306b\u5bfe\u3057\u3066\u8aa4\u3063\u3066portfast\u3092\u5165\u308c\u308b\u3068\u3069\u3046\u306a\u308b\u3067\u3057\u3087\u3046\u304b\uff1f\u3000Fa1/0/23\u3068Fa1/0/24\u3092\u63a5\u7d9a\u3057\u3066\u30012\u7cfb\u306e\u30b9\u30a4\u30c3\u30c1\u306eFa1/0/24\u304cBLK\u306b\u306a\u3063\u305f\u72b6\u614b\u304b\u3089\u59cb\u3081\u307e\u3059\u3002\ntc0002#show spanning-tree\n\uff08\u7701\u7565\uff09\n\nInterface        Role Sts Cost      Prio.Nbr Type\n---------------- ---- --- --------- -------- --------------------------------\nFa1/0/23         Root FWD 19        128.25   P2p\nFa1/0/24         Altn BLK 19        128.26   P2p\n\ntc0002#debug spanning-tree events\nSpanning Tree event debugging is on\ntc0002#configure terminal\nEnter configuration commands, one per line.  End with CNTL/Z.\ntc0002(config)#interface FastEthernet 1/0/24\ntc0002(config-if)#spanning-tree portfast\n%Warning: portfast should only be enabled on ports connected to a single\n host. Connecting hubs, concentrators, switches, bridges, etc... to this\n interface  when portfast is enabled, can cause temporary bridging loops.\n Use with CAUTION\n\n%Portfast has been configured on FastEthernet1/0/24 but will only\n have effect when the interface is in a non-trunking mode.\ntc0002(config-if)#end\n\n...\n...\n\n\u4f55\u3082\u8d77\u304d\u307e\u305b\u3093\u3067\u3057\u305f\u306d\u3002Portfast\u306e\u7d30\u304b\u3044\u691c\u8a3c\u306f\u5225\u306e\u56de\u306b\u518d\u5ea6\u3084\u308d\u3046\u3068\u601d\u3044\u307e\u3059\u3002\nBPDU Guard\u306f\u6a5f\u5668\u5168\u4f53\u306b\u8a2d\u5b9a\u3057\u307e\u3059\u3002Portfast\u306b\u8a2d\u5b9a\u3055\u308c\u305f\u30dd\u30fc\u30c8\u306b\u5bfe\u3057\u3066BPDU\u304c\u98db\u3093\u3067\u304d\u305f\u6642\u3001\u3064\u307e\u308a\u8a2d\u8a08\u3068\u306f\u7570\u306a\u308b\u6a5f\u5668\u304c\u63a5\u7d9a\u3055\u308c\u3066\u3057\u307e\u3063\u305f\u6642\u306b\u3001\u305d\u306e\u30dd\u30fc\u30c8\u3092\u5f37\u5236\u7684\u306bdisable\u306b\u3057\u307e\u3059\u3002\nBPDU Guard\u306fPortfast\u306e\u5f31\u70b9\u3092\u88dc\u5b8c\u3059\u308b\u30b3\u30de\u30f3\u30c9\u3067\u3001\u30c7\u30e1\u30ea\u30c3\u30c8\u3082\u7121\u3044\u305f\u3081\u5fc5\u305a\u8a2d\u5b9a\u3057\u307e\u3057\u3087\u3046\u3002\ntc0001#show spanning-tree summary\n\uff08\u7565\uff09\nPortFast BPDU Guard Default  is disabled\n\uff08\u7565\uff09\ntc0001#configure terminal\nEnter configuration commands, one per line.  End with CNTL/Z.\ntc0001(config)#spanning-tree portfast bpduguard default\ntc0001(config)#end\ntc0001#show spanning-tree summary\n\uff08\u7565\uff09\nPortFast BPDU Guard Default  is enabled\n\n\n4. \u304a\u308f\u308a\u306b\n\u3084\u306f\u308a\u5206\u91cf\u304c\u591a\u304f\u306a\u3063\u3066\u3057\u307e\u3044\u307e\u3057\u305f\u3002\u6b21\u56de\u3082stp\u7de8\u3067\u3059\u3002\n# 1. \u306f\u3058\u3081\u306b\n\u30aa\u30d7\u30b7\u30e7\u30f3\u304c\u305f\u304f\u3055\u3093\u3042\u3063\u3066\u8907\u96d1\u306aSTP\u306e\u8a2d\u5b9a\u65b9\u6cd5\u3092\u307e\u3068\u3081\u307e\u3059\u3002\n\n# 2. \u524d\u63d0\n\u4f7f\u3046\u306e\u306fRPVST (Rapid Per-Vlan Spanning-Tree)\u3002\n\n# 3. \u8a2d\u5b9a\u65b9\u6cd5\n\nRPVST\u306e\u6709\u52b9\u5316\uff1a\n\n```\n(config)#spanning-tree mode rapid-pvst\n```\n\nPrimary/Secondry\u30d6\u30ea\u30c3\u30b8\u306e\u8a2d\u5b9a\uff1a\n\u30001\u7cfb\u30b9\u30a4\u30c3\u30c1\u306b\u5bfe\u3057\u3066\n\n```\n(config)#spanning-tree vlan 1-4094 priority 0\n```\n\n\u30002\u7cfb\u30b9\u30a4\u30c3\u30c1\u306b\u5bfe\u3057\u3066\n\n```\n(config)#spanning-tree vlan 1-4094 priority 4096\n```\n\nBPDU Guard\u306e\u6709\u52b9\u5316\uff1a\n\n```\n(config)#spanning-tree portfast bpduguard default\n```\n\nPortfast\u306e\u8a2d\u5b9a\uff1a\n\u3000\u30a2\u30af\u30bb\u30b9\u30ea\u30f3\u30af\u306b\u5bfe\u3057\u3066\n\n```\ntc0001(config-if)#spanning-tree portfast\n```\n\n\u3000\u30c8\u30e9\u30f3\u30af\u30ea\u30f3\u30af\u306b\u5bfe\u3057\u3066\n\n```\ntc0001(config-if)#spanning-tree portfast trunk\n```\n\n# 4. \u89e3\u8aac\n\n## 4-1. RPVST\u306e\u6709\u52b9\u5316\n\u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u306fRPVST\u3067\u306f\u306a\u304fPVST\u304c\u6709\u52b9\u306b\u306a\u3063\u3066\u3044\u307e\u3059\u306e\u3067\u3001RPVST\u306b\u5909\u66f4\u3057\u307e\u3059\u3002\n\n```\ntc0001#show spanning-tree\n\nVLAN0001\n  Spanning tree enabled protocol ieee\n\uff08\u4ee5\u4e0b\u7701\u7565\uff09\n\ntc0001#conf t\nEnter configuration commands, one per line.  End with CNTL/Z.\ntc0001(config)#spanning-tree mode rapid-pvst\ntc0001(config)#end\ntc0001#show spanning-tree\n\nVLAN0001\n  Spanning tree enabled protocol rstp\n\uff08\u4ee5\u4e0b\u7701\u7565\uff09\n```\n\n\u305f\u307e\u306b`no spanning-tree`\u3068\u3044\u3046\u60aa\u9b54\u306e\u30b3\u30de\u30f3\u30c9\u3092\u4f7f\u3063\u3066STP\u3092\u5207\u3063\u3066\u3044\u308b\u30b9\u30a4\u30c3\u30c1\u304c\u3042\u308a\u307e\u3059\u304c\u3001\u30b9\u30a4\u30c3\u30c1\u304c\u30b7\u30f3\u30b0\u30eb\u69cb\u6210\u3067\u3042\u3063\u3066\u3082\u7d76\u5bfe\u306b\u8f9e\u3081\u307e\u3057\u3087\u3046\u3002\u4eba\u306f\u30b1\u30fc\u30d6\u30eb\u304c\u3042\u308b\u3068\u7a7a\u304d\u30dd\u30fc\u30c8\u306b\u633f\u3057\u305f\u304f\u306a\u308b\u751f\u304d\u7269\u306a\u306e\u3067\u3059\u3002STP\u3092\u6709\u52b9\u306b\u3059\u308b\u3053\u3068\u306b\u3088\u308b\u30c7\u30e1\u30ea\u30c3\u30c8\u306f\u3042\u308a\u307e\u305b\u3093\u3002\n\n## 4-2. Primary/Secondary\u30d6\u30ea\u30c3\u30b8\u306e\u8a2d\u5b9a\n\u4e0a\u4f4d\u30b9\u30a4\u30c3\u30c1\u304c2\u53f0\u3042\u308b\u74b0\u5883\u3067\u306f1\u7cfb\u3092primary\u30012\u7cfb\u3092secondary\u306b\u8a2d\u5b9a\u3057\u307e\u3057\u3087\u3046\u3002\u307e\u305a\u306fCisco\u63a8\u5968\u306e`root primary`\u3068\u3044\u3046\u30aa\u30d7\u30b7\u30e7\u30f3\u3092\u4f7f\u3063\u3066\u307f\u307e\u3059\u3002\n\n```\ntc0001#show spanning-tree\nVLAN0001\n  Spanning tree enabled protocol rstp\n  Root ID    Priority    32769\n             Address     0015.6256.6300\n             Cost        19\n             Port        25 (FastEthernet1/0/23)\n\uff08\u4ee5\u4e0b\u7701\u7565\uff09\ntc0001#configure terminal\nEnter configuration commands, one per line.  End with CNTL/Z.\ntc0001(config)#spanning-tree vlan 1-4094 root primary\ntc0001(config)#end\ntc0001#show spanning-tree\n\nVLAN0001\n  Spanning tree enabled protocol rstp\n  Root ID    Priority    24577\n             Address     0016.4779.5500\n             This bridge is the root\n             Hello Time   2 sec  Max Age 20 sec  Forward Delay 15 sec\n\uff08\u4ee5\u4e0b\u7701\u7565\uff09\n```\n\n```\ntc0002#conf t\nEnter configuration commands, one per line.  End with CNTL/Z.\ntc0002(config)#spanning-tree vlan 1-4094 root secondary\ntc0002(config)#end\ntc0002#show spanning-tree\n\uff08\u4ee5\u4e0b\u7701\u7565\uff09\n  Bridge ID  Priority    28673  (priority 28672 sys-id-ext 1)\n             Address     0015.6256.6300\n             Hello Time   2 sec  Max Age 20 sec  Forward Delay 15 sec\n             Aging Time 300\n```\n\nPriority\u304c24576\u306b\u5909\u66f4\u3055\u308c\u307e\u3057\u305f\u3002\u3061\u3087\u3063\u3068\u4e2d\u9014\u534a\u7aef\u3067\u3001\u7d0d\u5f97\u306e\u3044\u304b\u306a\u3044\u6570\u5b57\u3067\u3059\u3002\u65e2\u306b\u4ed6\u306e\u30d6\u30ea\u30c3\u30b8\u306bpriority\u304c\u8a2d\u5b9a\u3057\u3066\u3042\u308b\u6642\u306b`primary`\u30aa\u30d7\u30b7\u30e7\u30f3\u3092\u8a2d\u5b9a\u3059\u308b\u3068\u3069\u3046\u306a\u308b\u304b\u3084\u3063\u3066\u307f\u307e\u3057\u3087\u3046\u30022\u7cfb\u30b9\u30a4\u30c3\u30c1\u306bPriority 8192\u3092\u8a2d\u5b9a\u3057\u305f\u72b6\u614b\u304b\u3089\u59cb\u3081\u307e\u3059\u3002\n\n```\ntc0001#show spanning-tree\n\nVLAN0001\n  Spanning tree enabled protocol rstp\n  Root ID    Priority    8193\n             Address     0015.6256.6300\n             Cost        19\n             Port        26 (FastEthernet1/0/24)\n             Hello Time   2 sec  Max Age 20 sec  Forward Delay 15 sec\n\uff08\u7701\u7565\uff09\ntc0001#configure terminal\ntc0001(config)#spanning-tree vlan 1-4094 root primary\ntc0001(config)#end\ntc0001#show spanning-tree\n\nVLAN0001\n  Spanning tree enabled protocol rstp\n  Root ID    Priority    4097\n             Address     0016.4779.5500\n             This bridge is the root\n             Hello Time   2 sec  Max Age 20 sec  Forward Delay 15 sec\n\uff08\u7701\u7565\uff09\n```\n\n\u4eca\u5ea6\u306fpriority\u304c4096\u306b\u306a\u308a\u307e\u3057\u305f\u3002\u3053\u308c\u306f\u3069\u3046\u3044\u3046\u3053\u3068\u3067\u3057\u3087\u3046\u304b\uff1f\u3000show run\u3067\u8a2d\u5b9a\u3092\u78ba\u8a8d\u3057\u3066\u307f\u307e\u3059\u3002\n\n```\ntc0001#show running-config | include priority\nspanning-tree vlan 1 priority 4096\nspanning-tree vlan 2-4094 priority 24576\ntc0001#\n```\n\n`root primary`\u3068\u3044\u3046\u8a2d\u5b9a\u3092\u5165\u308c\u305f\u306f\u305a\u306a\u306e\u306b\u3001vlan 1\u306epriority\u304c4096\u306b\u3001\u305d\u308c\u4ee5\u5916\u304c24576\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u307e\u3059\u3002\u3069\u3046\u3084\u3089\u3001`root primary`\u306f\u30b3\u30de\u30f3\u30c9\u304c\u767a\u52b9\u3055\u308c\u305f\u77ac\u9593\u306broot bridge\u306epriority\u3092\u898b\u3066\u3001\u305d\u308c\u3092\u4e0a\u56de\u308b\u3088\u3046\u306b\u8a2d\u5b9a\u3055\u308c\u308b\u3088\u3046\u3067\u3059\u306d\u30022\u7cfb\u30b9\u30a4\u30c3\u30c1\u306epriority\u30920\u306b\u8a2d\u5b9a\u3057\u305f\u72b6\u614b\u3067\u30b3\u30de\u30f3\u30c9\u3092\u5165\u308c\u308b\u3068\u5931\u6557\u3057\u307e\u3059\u3002\n\n```\ntc0001(config)#spanning-tree vlan 1-4094 root primary\n% Failed to make the bridge root for vlan 1\n% It may be possible to make the bridge root by setting the priority\n% for some (or all) of these instances to zero.\n```\n\n\u3053\u308c\u306fcisco\u306e\u63a8\u5968\u30b3\u30de\u30f3\u30c9\u3067\u306f\u3042\u308a\u307e\u3059\u304c\u3001\u8a2d\u8a08\u3068\u306f\u547c\u3079\u306a\u3044\u3067\u3059\u306d\u3002priority\u306f\u5b9a\u6570\u3067\u8a2d\u5b9a\u3057\u307e\u3057\u3087\u3046\u3002\u5b9f\u969b\u306b\u30eb\u30fc\u30d7\u69cb\u6210\u3092\u53d6\u308b\u8a2d\u8a08\u3060\u3068\u30011\u7cfb\u30b3\u30a2\u30b9\u30a4\u30c3\u30c1\u30012\u7cfb\u30b3\u30a2\u30b9\u30a4\u30c3\u30c1\u3001\u5404\u30a2\u30af\u30bb\u30b9\u30b9\u30a4\u30c3\u30c1\u306e\u9806\u3067priority\u304c\u9ad8\u304f\u306a\u3063\u3066\u3044\u304f\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u30021\u7cfb\u306b\u306f0\u3092\u30012\u7cfb\u306b\u306f4096\u3092\u8a2d\u5b9a\u3057\u307e\u3057\u3087\u3046\u3002\n\n```\ntc0001(config)#spanning-tree vlan 1-4094 priority 0\ntc0002(config)#spanning-tree vlan 1-4094 priority 4096\n```\n\n## 4-3. BPDU Guard\u306e\u6709\u52b9\u5316\u3068Portfast\n\nPortfast\u306f\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9\u306b\u8a2d\u5b9a\u3057\u3001\u5bfe\u8c61\u306e\u30dd\u30fc\u30c8\u3067Link up\u304c\u767a\u751f\u3057\u305f\u969b\u306b\u3001Listening\u3068Learning\u306e\u30d7\u30ed\u30bb\u30b9\u3092\u30b9\u30ad\u30c3\u30d7\u3057\u3066\u901f\u3084\u304b\u306bForwarding\u72b6\u614b\u306b\u79fb\u884c\u3055\u305b\u308b\u30b3\u30de\u30f3\u30c9\u3067\u3059\u3002STP\u3068\u306f\u95a2\u4fc2\u306e\u306a\u3044\u30b5\u30fc\u30d0\u3001PC\u3001\u30eb\u30fc\u30bf\u7b49\u304c\u63a5\u7d9a\u3055\u308c\u308b\u30dd\u30fc\u30c8\u3067\u4f7f\u7528\u3057\u307e\u3059\u3002\n\nSTP\u3067BLK\u72b6\u614b\u306eport\u306b\u5bfe\u3057\u3066\u8aa4\u3063\u3066portfast\u3092\u5165\u308c\u308b\u3068\u3069\u3046\u306a\u308b\u3067\u3057\u3087\u3046\u304b\uff1f\u3000Fa1/0/23\u3068Fa1/0/24\u3092\u63a5\u7d9a\u3057\u3066\u30012\u7cfb\u306e\u30b9\u30a4\u30c3\u30c1\u306eFa1/0/24\u304cBLK\u306b\u306a\u3063\u305f\u72b6\u614b\u304b\u3089\u59cb\u3081\u307e\u3059\u3002\n\n```\ntc0002#show spanning-tree\n\uff08\u7701\u7565\uff09\n\nInterface        Role Sts Cost      Prio.Nbr Type\n---------------- ---- --- --------- -------- --------------------------------\nFa1/0/23         Root FWD 19        128.25   P2p\nFa1/0/24         Altn BLK 19        128.26   P2p\n\ntc0002#debug spanning-tree events\nSpanning Tree event debugging is on\ntc0002#configure terminal\nEnter configuration commands, one per line.  End with CNTL/Z.\ntc0002(config)#interface FastEthernet 1/0/24\ntc0002(config-if)#spanning-tree portfast\n%Warning: portfast should only be enabled on ports connected to a single\n host. Connecting hubs, concentrators, switches, bridges, etc... to this\n interface  when portfast is enabled, can cause temporary bridging loops.\n Use with CAUTION\n\n%Portfast has been configured on FastEthernet1/0/24 but will only\n have effect when the interface is in a non-trunking mode.\ntc0002(config-if)#end\n\n...\n...\n```\n\n\u4f55\u3082\u8d77\u304d\u307e\u305b\u3093\u3067\u3057\u305f\u306d\u3002Portfast\u306e\u7d30\u304b\u3044\u691c\u8a3c\u306f\u5225\u306e\u56de\u306b\u518d\u5ea6\u3084\u308d\u3046\u3068\u601d\u3044\u307e\u3059\u3002\n\nBPDU Guard\u306f\u6a5f\u5668\u5168\u4f53\u306b\u8a2d\u5b9a\u3057\u307e\u3059\u3002Portfast\u306b\u8a2d\u5b9a\u3055\u308c\u305f\u30dd\u30fc\u30c8\u306b\u5bfe\u3057\u3066BPDU\u304c\u98db\u3093\u3067\u304d\u305f\u6642\u3001\u3064\u307e\u308a\u8a2d\u8a08\u3068\u306f\u7570\u306a\u308b\u6a5f\u5668\u304c\u63a5\u7d9a\u3055\u308c\u3066\u3057\u307e\u3063\u305f\u6642\u306b\u3001\u305d\u306e\u30dd\u30fc\u30c8\u3092\u5f37\u5236\u7684\u306bdisable\u306b\u3057\u307e\u3059\u3002\nBPDU Guard\u306fPortfast\u306e\u5f31\u70b9\u3092\u88dc\u5b8c\u3059\u308b\u30b3\u30de\u30f3\u30c9\u3067\u3001\u30c7\u30e1\u30ea\u30c3\u30c8\u3082\u7121\u3044\u305f\u3081\u5fc5\u305a\u8a2d\u5b9a\u3057\u307e\u3057\u3087\u3046\u3002\n\n```\ntc0001#show spanning-tree summary\n\uff08\u7565\uff09\nPortFast BPDU Guard Default  is disabled\n\uff08\u7565\uff09\ntc0001#configure terminal\nEnter configuration commands, one per line.  End with CNTL/Z.\ntc0001(config)#spanning-tree portfast bpduguard default\ntc0001(config)#end\ntc0001#show spanning-tree summary\n\uff08\u7565\uff09\nPortFast BPDU Guard Default  is enabled\n```\n\n# 4. \u304a\u308f\u308a\u306b\n\n\u3084\u306f\u308a\u5206\u91cf\u304c\u591a\u304f\u306a\u3063\u3066\u3057\u307e\u3044\u307e\u3057\u305f\u3002\u6b21\u56de\u3082stp\u7de8\u3067\u3059\u3002\n\n\n\n\n\n\n\n", "tags": ["Cisco"]}