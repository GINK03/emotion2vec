{"context": " More than 1 year has passed since last update.\n\n\u30b9\u30af\u30ed\u30fc\u30eb\u306b\u5408\u308f\u305b\u305f\u4ed6\u306e\u30d3\u30e5\u30fc\u306b\u5bfe\u3059\u308b\u64cd\u4f5c\n\u4eca\u56de\u306fAirbnb\u306e\u304a\u90e8\u5c4b\u306e\u8a73\u7d30\u30da\u30fc\u30b8\u306b\u3042\u308b\u3088\u3046\u306a\u30b9\u30af\u30ed\u30fc\u30eb\u306b\u5408\u308f\u305b\u3066\u753b\u50cf\u3092\u96a0\u3057\u305f\u308a\u3001\u62e1\u5927\u3055\u305b\u305f\u308a\u3059\u308b\u753b\u9762\u3092\u4f5c\u308a\u305f\u3044\u3068\u601d\u3044\u307e\u3059\u3002\n\u5b8c\u6210\u30a4\u30e1\u30fc\u30b8\u306f\u3053\u3093\u306a\u611f\u3058\u3002\n\n\n\u51e6\u7406\u306e\u6d41\u308c\n\nUIViewController\u306bUIScrollView\u3092\u8a2d\u7f6e\n\u52d5\u304b\u3059UIImageView\u3092\u7528\u610f\uff08\u4eca\u56de\u306fxib\u30d5\u30a1\u30a4\u30eb\u3067\u4f5c\u3063\u305f\uff09\n\nscrollViewDidScroll\u3067\u30b9\u30af\u30ed\u30fc\u30eb\u91cf\u306b\u5fdc\u3058\u3066\u753b\u50cf\u3092\u5909\u5316\u3055\u305b\u308b\n\n\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u306fGithub\u306b\u4e0a\u3052\u3066\u3042\u308a\u307e\u3059\u306e\u3067\u305d\u3061\u3089\u3082\u53c2\u8003\u306b\u3057\u3066\u9802\u3051\u308b\u3068\u3088\u308d\u3057\u3044\u304b\u3068\u601d\u3044\u307e\u3059\u3002\n\n\u5b9f\u88c5\u90e8\u5206\uff08\u8981\u70b9\u3060\u3051\uff09\n\n1. \u307e\u305a\u306f\u5fc5\u8981\u306a\u30e1\u30a4\u30f3\u306e\u30b3\u30f3\u30c6\u30f3\u30c4\u3092\u30b9\u30af\u30ed\u30fc\u30eb\u3055\u305b\u308b\u753b\u9762\u3068\u30b9\u30af\u30ed\u30fc\u30eb\u3068\u540c\u671f\u3055\u305b\u308b\u753b\u50cf\u306eStoryboard\u3084\u30af\u30e9\u30b9\u3092\u7528\u610f\u3057\u307e\u3057\u3087\u3046\u3002\n\nContentMainStoryboard.storyboard\nContentMainViewController.swift\nContentMediaView.xib\nContentMediaView.swift\n\n\n2. \u6b21\u306bContentMediaView.swift\u306e\u51e6\u7406\u3092\u66f8\u3044\u3066\u3044\u304d\u307e\u3059\u3002\n\nContentMediaView.swift\nimport UIKit\n\nclass ContentMediaView: UIView {\n\n  @IBOutlet var contentMedia: UIView!\n  @IBOutlet weak var mediaImage: UIImageView!\n\n  required init(coder aDecoder:NSCoder) {\n\n    super.init(coder: aDecoder)!\n    sharedInit()\n\n  }\n\n  override init(frame:CGRect) {\n\n    super.init(frame:frame)\n    sharedInit()\n\n  }\n\n  private func sharedInit() {\n\n    NSBundle.mainBundle().loadNibNamed(\"ContentMediaView\", owner: self, options: nil)\n    addSubview(contentMedia)\n\n  }\n}\n\n\n\n3. ContentMainViewController.swift\u306e\u51e6\u7406\n\u3053\u3053\u3067\u30b9\u30af\u30ed\u30fc\u30eb\u3068\u306e\u540c\u671f\u51e6\u7406\u3092\u66f8\u3044\u3066\u3044\u304d\u307e\u3059\u3002\n\nContentMainViewController.swift\nimport UIKit\n\nclass ContentMainViewController: UIViewController {\n\n  @IBOutlet weak var mainScrollView: UIScrollView!\n  @IBOutlet weak var contentView: UIView!\n\n  var contentMediaView:ContentMediaView!\n  var mediaFrameHight:CGFloat!\n\n  override func viewDidLoad() {\n    super.viewDidLoad()\n    mediaFrameHight = (view.frame.width * 3) / 4\n\n    contentMediaView = ContentMediaView(frame: CGRectMake(0.0,0.0, view.frame.width, mediaFrameHight))\n    contentMediaView.backgroundColor = UIColor.blackColor()\n    mainScrollView.delegate = self\n    view.insertSubview(contentMediaView, belowSubview: mainScrollView)\n\n    self.navigationController?.navigationBarHidden = true\n\n  }\n\n  override func viewDidLayoutSubviews() {\n    let inset = UIEdgeInsetsMake(mediaFrameHight, 0.0, 0.0, 0.0)\n    mainScrollView.contentInset = inset\n  }\n}\n\n// MARK: -UIScrollViewDelegate\nextension ContentMainViewController:UIScrollViewDelegate {\n\n  func scrollViewDidScroll(scrollView: UIScrollView) {\n\n    // \u30b9\u30af\u30ed\u30fc\u30eb\u91cf\u306b\u5fdc\u3058\u3066\u898b\u51fa\u3057\u306e\u753b\u50cf\u306e\u30d5\u30ec\u30fc\u30e0\u3092\u66f4\u65b0\n    updateMediaFrame()\n\n  }\n\n  func updateMediaFrame() {\n\n    // \u898b\u51fa\u3057\u30e1\u30c7\u30a3\u30a2\u306e\u30b9\u30af\u30ed\u30fc\u30eb\u4e21\n    var scroll = mediaFrameHight + mainScrollView.contentOffset.y\n    if (mainScrollView.contentOffset.y >= -mediaFrameHight) {\n      scroll = scroll / 2\n    }\n\n    let offsetY = (mainScrollView.contentOffset.y + mainScrollView.contentInset.top) * -1;\n\n    if(mainScrollView.contentOffset.y <= -mediaFrameHight) { // \u753b\u50cf\u30d3\u30e8\u30fc\u30f3\n\n      let scale = (1.0 + offsetY / mediaFrameHight);\n      contentMediaView.transform = CGAffineTransformMakeScale(scale, scale);\n      contentMediaView.frame.origin.y = 0.0\n      contentMediaView.mediaImage.alpha = 1\n\n    } else {\n\n      contentMediaView.mediaImage.alpha = 1 - (offsetY / mediaFrameHight) * -1\n      contentMediaView.frame.origin.y = -scroll\n\n    }\n\n    mainScrollView.scrollIndicatorInsets.top = -mainScrollView.contentOffset.y\n  }\n\n}\n\n\n\u3053\u3093\u306a\u611f\u3058\u3067\u3059\u3002\n\n4. \u5b8c\u6210\n\u3053\u3053\u307e\u3067\u3067\u5192\u982d\u306e\u3088\u3046\u306aAirbnb\u98a8\u306eUI\u304c\u51fa\u6765\u4e0a\u304c\u308a\u307e\u3059\u3002\n\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u306fGithub\u306b\u4e0a\u3052\u3066\u3042\u308a\u307e\u3059\u306e\u3067\u3054\u81ea\u7531\u306b\u3054\u89a7\u304f\u3060\u3055\u3044\u3002\n# \u30b9\u30af\u30ed\u30fc\u30eb\u306b\u5408\u308f\u305b\u305f\u4ed6\u306e\u30d3\u30e5\u30fc\u306b\u5bfe\u3059\u308b\u64cd\u4f5c\n\u4eca\u56de\u306fAirbnb\u306e\u304a\u90e8\u5c4b\u306e\u8a73\u7d30\u30da\u30fc\u30b8\u306b\u3042\u308b\u3088\u3046\u306a\u30b9\u30af\u30ed\u30fc\u30eb\u306b\u5408\u308f\u305b\u3066\u753b\u50cf\u3092\u96a0\u3057\u305f\u308a\u3001\u62e1\u5927\u3055\u305b\u305f\u308a\u3059\u308b\u753b\u9762\u3092\u4f5c\u308a\u305f\u3044\u3068\u601d\u3044\u307e\u3059\u3002\n\n\u5b8c\u6210\u30a4\u30e1\u30fc\u30b8\u306f\u3053\u3093\u306a\u611f\u3058\u3002\n\n\n![asynchroscroll.gif](https://qiita-image-store.s3.amazonaws.com/0/24991/85897289-6ebe-8dd3-3311-bc55cd59a362.gif)\n\n\n## \u51e6\u7406\u306e\u6d41\u308c\n1. UIViewController\u306bUIScrollView\u3092\u8a2d\u7f6e\n2. \u52d5\u304b\u3059UIImageView\u3092\u7528\u610f\uff08\u4eca\u56de\u306fxib\u30d5\u30a1\u30a4\u30eb\u3067\u4f5c\u3063\u305f\uff09\n3. `scrollViewDidScroll`\u3067\u30b9\u30af\u30ed\u30fc\u30eb\u91cf\u306b\u5fdc\u3058\u3066\u753b\u50cf\u3092\u5909\u5316\u3055\u305b\u308b\n\n\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u306f[Github](https://github.com/yuji-suzuki/continuance)\u306b\u4e0a\u3052\u3066\u3042\u308a\u307e\u3059\u306e\u3067\u305d\u3061\u3089\u3082\u53c2\u8003\u306b\u3057\u3066\u9802\u3051\u308b\u3068\u3088\u308d\u3057\u3044\u304b\u3068\u601d\u3044\u307e\u3059\u3002\n\n## \u5b9f\u88c5\u90e8\u5206\uff08\u8981\u70b9\u3060\u3051\uff09\n### 1. \u307e\u305a\u306f\u5fc5\u8981\u306a`\u30e1\u30a4\u30f3\u306e\u30b3\u30f3\u30c6\u30f3\u30c4\u3092\u30b9\u30af\u30ed\u30fc\u30eb\u3055\u305b\u308b\u753b\u9762`\u3068`\u30b9\u30af\u30ed\u30fc\u30eb\u3068\u540c\u671f\u3055\u305b\u308b\u753b\u50cf`\u306eStoryboard\u3084\u30af\u30e9\u30b9\u3092\u7528\u610f\u3057\u307e\u3057\u3087\u3046\u3002\n  - ContentMainStoryboard.storyboard\n  - ContentMainViewController.swift\n  - ContentMediaView.xib\n  - ContentMediaView.swift\n\n### 2. \u6b21\u306b`ContentMediaView.swift`\u306e\u51e6\u7406\u3092\u66f8\u3044\u3066\u3044\u304d\u307e\u3059\u3002\n\n```lang:ContentMediaView.swift\nimport UIKit\n\nclass ContentMediaView: UIView {\n\n  @IBOutlet var contentMedia: UIView!\n  @IBOutlet weak var mediaImage: UIImageView!\n\n  required init(coder aDecoder:NSCoder) {\n\n    super.init(coder: aDecoder)!\n    sharedInit()\n\n  }\n\n  override init(frame:CGRect) {\n\n    super.init(frame:frame)\n    sharedInit()\n\n  }\n\n  private func sharedInit() {\n\n    NSBundle.mainBundle().loadNibNamed(\"ContentMediaView\", owner: self, options: nil)\n    addSubview(contentMedia)\n\n  }\n}\n```\n### 3. `ContentMainViewController.swift`\u306e\u51e6\u7406\n\u3053\u3053\u3067\u30b9\u30af\u30ed\u30fc\u30eb\u3068\u306e\u540c\u671f\u51e6\u7406\u3092\u66f8\u3044\u3066\u3044\u304d\u307e\u3059\u3002\n\n```lang:ContentMainViewController.swift\nimport UIKit\n\nclass ContentMainViewController: UIViewController {\n\n  @IBOutlet weak var mainScrollView: UIScrollView!\n  @IBOutlet weak var contentView: UIView!\n\n  var contentMediaView:ContentMediaView!\n  var mediaFrameHight:CGFloat!\n\n  override func viewDidLoad() {\n    super.viewDidLoad()\n    mediaFrameHight = (view.frame.width * 3) / 4\n\n    contentMediaView = ContentMediaView(frame: CGRectMake(0.0,0.0, view.frame.width, mediaFrameHight))\n    contentMediaView.backgroundColor = UIColor.blackColor()\n    mainScrollView.delegate = self\n    view.insertSubview(contentMediaView, belowSubview: mainScrollView)\n\n    self.navigationController?.navigationBarHidden = true\n\n  }\n\n  override func viewDidLayoutSubviews() {\n    let inset = UIEdgeInsetsMake(mediaFrameHight, 0.0, 0.0, 0.0)\n    mainScrollView.contentInset = inset\n  }\n}\n\n// MARK: -UIScrollViewDelegate\nextension ContentMainViewController:UIScrollViewDelegate {\n\n  func scrollViewDidScroll(scrollView: UIScrollView) {\n\n    // \u30b9\u30af\u30ed\u30fc\u30eb\u91cf\u306b\u5fdc\u3058\u3066\u898b\u51fa\u3057\u306e\u753b\u50cf\u306e\u30d5\u30ec\u30fc\u30e0\u3092\u66f4\u65b0\n    updateMediaFrame()\n\n  }\n\n  func updateMediaFrame() {\n\n    // \u898b\u51fa\u3057\u30e1\u30c7\u30a3\u30a2\u306e\u30b9\u30af\u30ed\u30fc\u30eb\u4e21\n    var scroll = mediaFrameHight + mainScrollView.contentOffset.y\n    if (mainScrollView.contentOffset.y >= -mediaFrameHight) {\n      scroll = scroll / 2\n    }\n\n    let offsetY = (mainScrollView.contentOffset.y + mainScrollView.contentInset.top) * -1;\n\n    if(mainScrollView.contentOffset.y <= -mediaFrameHight) { // \u753b\u50cf\u30d3\u30e8\u30fc\u30f3\n\n      let scale = (1.0 + offsetY / mediaFrameHight);\n      contentMediaView.transform = CGAffineTransformMakeScale(scale, scale);\n      contentMediaView.frame.origin.y = 0.0\n      contentMediaView.mediaImage.alpha = 1\n\n    } else {\n\n      contentMediaView.mediaImage.alpha = 1 - (offsetY / mediaFrameHight) * -1\n      contentMediaView.frame.origin.y = -scroll\n\n    }\n\n    mainScrollView.scrollIndicatorInsets.top = -mainScrollView.contentOffset.y\n  }\n\n}\n```\n\n\u3053\u3093\u306a\u611f\u3058\u3067\u3059\u3002\n\n### 4. \u5b8c\u6210\n\u3053\u3053\u307e\u3067\u3067\u5192\u982d\u306e\u3088\u3046\u306aAirbnb\u98a8\u306eUI\u304c\u51fa\u6765\u4e0a\u304c\u308a\u307e\u3059\u3002\n\n\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u306f[Github](https://github.com/yuji-suzuki/continuance)\u306b\u4e0a\u3052\u3066\u3042\u308a\u307e\u3059\u306e\u3067\u3054\u81ea\u7531\u306b\u3054\u89a7\u304f\u3060\u3055\u3044\u3002\n", "tags": ["Swift2.0", "iOS", "iPhone", "iPhone\u958b\u767a"]}