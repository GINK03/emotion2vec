{"context": "\n\n\u306f\u3058\u3081\u306b\n\u5916\u90e8\u30b5\u30fc\u30d3\u30b9\u3068\u9023\u643a\u3057\u305f\u3044\uff01\u30a2\u30d7\u30ea\u958b\u767a\u3092\u3057\u305f\u3044\uff01\u969b\u306bAPI\u30b5\u30fc\u30d0\u3092\u4f5c\u6210\u3059\u308b\u3053\u3068\u304c\u3042\u308b\u304b\u3068\u601d\u3044\u307e\u3059\u3002\n\u4eca\u56de\u306fruby\u3092\u4f7f\u3063\u305f\u8272\u3005\u306aAPI\u306e\u5b9f\u88c5\u65b9\u6cd5\u3092\u3054\u7d39\u4ecb\u3057\u305f\u3044\u3068\u601d\u3044\u307e\u3059\u3002\n\n\u767b\u5834\u4eba\u7269\n\u4eca\u56de\u306f\u4e0b\u8a18\u306e\u6240\u611f\u3001\u5b9f\u88c5\u65b9\u6cd5\u3092\u3054\u7d39\u4ecb\u3057\u3066\u3044\u304d\u307e\u3059\u3002\n\n\u30ea\u30af\u30a8\u30b9\u30c8\u53d6\u5f97\u90e8\u5206\n\nRails\nGrape\n\n\n\u30ec\u30b9\u30dd\u30f3\u30b9\u90e8\u5206\n\nRails\nRABL\nJbuilder\n\n\n\u524d\u63d0\n\u4eca\u56de\u306f\u5168\u3066\u306e\u691c\u8a3c\u3067\u4e0b\u8a18\u306e\u30c6\u30fc\u30d6\u30eb\u3001URL\u3001\u51fa\u529b\u306b\u306a\u308b\u3088\u3046\u306b\u306a\u3063\u3066\u3044\u307e\u3059\u3002\nUser\u30c6\u30fc\u30d6\u30eb\u306e\u69cb\u6210\n\n\n\nid\nname\naddr1\naddr2\n\n\n\n\n1\n\u7530\u4e2d\n\u6771\u4eac\u90fd\u5343\u4ee3\u7530\u533a\n0-0-0\n\n\n2\n\u5c71\u7530\n\u6771\u4eac\u90fd\u5343\u4ee3\u7530\u533a\n1-1-1\n\n\n\n\u30ea\u30af\u30a8\u30b9\u30c8URL\n\u4eca\u56de\u306f\u30d0\u30fc\u30b8\u30e7\u30f3\u7ba1\u7406\u51fa\u6765\u308b\u3088\u3046\u306bapi/v1/\u3068\u3057\u307e\u3057\u305f\u3002\nhttp://example.com/api/v1/users?addr1=\u6771\u4eac\u90fd\u5343\u4ee3\u7530\u533a\n\n\u30ec\u30b9\u30dd\u30f3\u30b9\n[\n    {\n        id: 1,\n        name: \"\u7530\u4e2d\",\n        address: {\n            addr1: \"\u6771\u4eac\u90fd\u5343\u4ee3\u7530\u533a\",\n            addr2: \"0-0-0\"\n        }\n    },\n    {\n        id: 2,\n        name: \"\u5c71\u7530\"\n        address: {\n            addr1: \"\u6771\u4eac\u90fd\u5343\u4ee3\u7530\u533a\",\n            addr2: \"1-1-1\"\n        }\n    },\n]\n\n\n\u30ea\u30af\u30a8\u30b9\u30c8\u306e\u53d6\u5f97\u90e8\u5206\n\nRails\n\u6240\u611f\n\nRails\u306e\u898f\u5247\u901a\u308a\u306a\u306e\u3067Rails\u306b\u6163\u308c\u3066\u3044\u308b\u4eba\u306a\u3089\u6577\u5c45\u304c\u4f4e\u3044\nGem\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u30fb\u8a2d\u5b9a\u304c\u7279\u306b\u306a\u3044\n\n\u3063\u3066\u611f\u3058\u3067\u3059\u304b\u306d\u3002\u8a66\u3057\u306b\u30b5\u30af\u30c3\u3068API\u3092\u4f5c\u308b\u306b\u306f\u5411\u3044\u3066\u3044\u308b\u3068\u601d\u3044\u307e\u3057\u305f\u3002 \n\n\u5b9f\u88c5\u65b9\u6cd5\n\ncontroller\u914d\u4e0b\u306bAPI\u7528\u306e\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092\u4f5c\u6210\u3059\u308b\n\n\n\u30eb\u30fc\u30c6\u30a3\u30f3\u30b0\u306e\u8a2d\u5b9a\n\u901a\u5e38\u306eRails\u3068\u540c\u69d8\u306broutes\u306b\u8a2d\u5b9a\u3092\u3057\u307e\u3059\u3002\n\nconfig/routes.rb\n# API\u7528\nnamespace :api, {format: 'json'} do\n  namespace :v1 do\n    namespace :users do\n      get \"/\" , :action => \"index\"\n    end\n  end\nend\n\n\n\ncontroller\u306e\u5b9f\u88c5\ncontroller\u3092\u5b9f\u88c5\u3057\u3066\u3044\u304d\u307e\u3059\u3002\nrails\u3092\u66f8\u304d\u6163\u308c\u3066\u3044\u308b\u4eba\u306a\u3089\u7279\u306b\u9055\u548c\u611f\u306f\u306a\u3044\u304b\u3068\u601d\u3044\u307e\u3059\u3002\nparams.permit\u306b\u3066\u30ea\u30af\u30a8\u30b9\u30c8\u30d1\u30e9\u30e1\u30fc\u30bf\u306e\u30d0\u30ea\u30c7\u30fc\u30b7\u30e7\u30f3\u3092\u304b\u3051\u3066\u3044\u307e\u3059\u3002\n\napp/controllers/api/v1/users_controller.rb\nclass Api::V1::UsersController < ApplicationController\n  def index\n    @users = User.where(\"addr1 = ?\", user_params[:addr1])\n  end\n\n\n  private\n  # \u30ea\u30af\u30a8\u30b9\u30c8\u30d1\u30e9\u30e1\u30fc\u30bf\u306e\u30d0\u30ea\u30c7\u30fc\u30b7\u30e7\u30f3\n  def user_params\n    params.permit(:addr1)\n  end\nend\n\n\n\u203b JSON\u3068\u3057\u3066\u51fa\u529b\u3059\u308b\u90e8\u5206\u306f\u30ec\u30b9\u30dd\u30f3\u30b9\u90e8\u5206\u306b\u3066\u89e3\u8aac\u3057\u307e\u3059\u3002\n\ngrape\n\ngrape\u3068\u306f\n\nruby\u3067\u7c21\u5358\u306bAPI\u3092\u4f5c\u6210\u3059\u308b\u305f\u3081\u306eDSL\n\u5358\u4f53\u3001\u3082\u3057\u304f\u306fRails\u3084Sinatra\u3068\u7d44\u307f\u5408\u308f\u305b\u4f7f\u3046\n\n\n\u6240\u611f\n\nAPI\u5c02\u7528\u306eDSL\u306a\u306e\u3067\u30b7\u30f3\u30d7\u30eb\u306b\u304b\u3051\u308b\n\u82e5\u5e72\u521d\u671f\u8a2d\u5b9a\u304c\u591a\u3044\n\n\u3063\u3066\u611f\u3058\u3067\u3059\u3002Rails\u306b\u6bd4\u3079\u308b\u3068\u5927\u304d\u3081\u306e\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306b\u5411\u3044\u3066\u3044\u308b\u306e\u304b\u306a\u3068\u611f\u3058\u307e\u3057\u305f\u3002\n\n\u5b9f\u88c5\u65b9\u6cd5\n\nGem\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\nGemfile.rb\ngem 'grape'\n\n\n\n\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\nbundle install\n\n\n\nroutes\u306e\u8a2d\u5b9a\n\nconfig/routes.rb\nmount API::Root => '/api'\n\n\n\ngrape\u3092\u8aad\u307f\u8fbc\u3081\u308b\u3088\u3046\u306b\u8a2d\u5b9a\n\nconfig/application.rb\n# API\u306e\u8aad\u307f\u8fbc\u307f\nconfig.paths.add File.join('app', 'apis'), glob: File.join('**', '*.rb')\nconfig.autoload_paths += Dir[Rails.root.join('app', 'apis', '*')]\n\n# Grape+JBuilder\u3092\u4f7f\u3046\u305f\u3081\u306e\u8a2d\u5b9a\nconfig.middleware.use(Rack::Config) do |env|\n  env['api.tilt.root'] = Rails.root.join 'app', 'views', 'api'\nend\n\n\n\n\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306e\u4f5c\u6210\ngrape\u306e\u5834\u5408\u306f\u3001app\u914d\u4e0b\u306b\u4e0b\u8a18\u56f3\u306e\u3088\u3046\u306b\u4f5c\u6210\u3057\u307e\u3057\u305f\u3002\n\n\nroot\u306e\u8a2d\u5b9a\napis/api \u914d\u4e0b\u306broot.rb\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\napis/api/root.rb\nmodule API\n  class Root < Grape::API\n    mount API::Ver1::Root\n  end\nend\n\n\napis/api/ver1 \u914d\u4e0b\u306broot.rb\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\napis/api/ver1/root.rb\nmodule API\n  module Ver1\n    class Root < Grape::API\n\n      # \u3053\u308c\u3067domain/api/v1\u3067\u30a2\u30af\u30bb\u30b9\u51fa\u6765\u308b\u3088\u3046\u306b\u306a\u308b\u3002\n      version 'v1', using: :path\n      format :json\n\n      mount API::Ver1::Users\n\n      # 404NotFound\u306e\u6271\u3044\n      route :any, '*path' do\n        error! I18n.t('grape.errors.not_found'), 404\n      end\n\n    end\n  end\nend\n\n\n\n\nAPI\u90e8\u5206\u306e\u5b9f\u88c5\n\napp/apis/api/ver1/user.rb\nmodule API\n  module Ver1\n    class Users < Grape::API\n      format :json\n\n      # /api/v1/users/\n      get '/users' do\n        @users = User.where(\"addr1 = ?\", user_params[:addr1])\n      end\n\n    end\n  end\nend\n\n\n\u203b JSON\u3068\u3057\u3066\u51fa\u529b\u3059\u308b\u90e8\u5206\u306f\u30ec\u30b9\u30dd\u30f3\u30b9\u90e8\u5206\u306b\u3066\u89e3\u8aac\u3057\u307e\u3059\u3002\n\n\u30ec\u30b9\u30dd\u30f3\u30b9\u90e8\u5206\n\u7d9a\u3044\u3066\u30ec\u30b9\u30dd\u30f3\u30b9(View)\u306e\u90e8\u5206\u3092Rails\u3001RABL\u3001Jbuilder\u3092\u4f7f\u3063\u305f\u6240\u611f\u3001\u5b9f\u88c5\u65b9\u6cd5\u3092\u3054\u7d39\u4ecb\u3057\u307e\u3059\u3002\n\nRails\n\n\u6240\u611f\n\n\u7c21\u5358\u306a\u3082\u306e\u306a\u3089\u4e8b\u8db3\u308a\u308b\u304c\u3001\u8907\u96d1\u306a\u30ec\u30b9\u30dd\u30f3\u30b9\u306f\u53b3\u3057\u305d\u3046\u3002\ncontroller\u5185\u306b\u30ec\u30b9\u30dd\u30f3\u30b9\u306e\u51e6\u7406\u304c\u542b\u307e\u308c\u308b\u306e\u3067\u3001\u7ba1\u7406\u304c\u758e\u304b\u306b\u306a\u308a\u304c\u3061\n\n\u3063\u3066\u611f\u3058\u3067\u3059\u3002\u30c7\u30e2\u7b49\u306e\u7c21\u5358\u306a\u3082\u306e\u306a\u3089\u826f\u3044\u3067\u3059\u304c\u3001\u8907\u96d1\u306a\u3082\u306e\u306f\u3061\u3087\u3063\u3068\u53b3\u3057\u305d\u3046\u306a\u5370\u8c61\u3067\u3059\u3002\n\n\u5b9f\u88c5\u65b9\u6cd5\n\u5148\u307b\u3069\u30ea\u30af\u30a8\u30b9\u30c8\u306e\u53d6\u5f97\u90e8\u5206\u306eRails\u306e\u9805\u76ee\u3067\u4f5c\u6210\u3057\u305f\u30b3\u30fc\u30c9\u3092\u5143\u306bJSON\u3057\u3066\u51fa\u529b\u51fa\u6765\u308b\u3088\u3046\u306b\u3057\u307e\u3059\u3002\n\napp/controllers/api/v1/users_controller.rb\nclass Api::V1::UsersController < ApplicationController\n  def index\n    @users = User.where(\"addr1 = ?\", user_params[:addr1])\n    @users = @users.map do |user|\n      {\n          id: user.id,\n           name: user.name,\n          address:{\n              addr1: user.addr1,\n              addr2: user.addr2\n          },\n      }\n    end\n    render json: @users\n  end\n\n\n  private\n  # \u30ea\u30af\u30a8\u30b9\u30c8\u30d1\u30e9\u30e1\u30fc\u30bf\u306e\u30d0\u30ea\u30c7\u30fc\u30b7\u30e7\u30f3\n  def user_params\n    params.permit(:addr1)\n  end\nend\n\n\n\nRABL\n\nRABL\u306e\u7279\u5fb4\n\nView\u306e\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u306a\u306e\u3067controller\u306b\u8a18\u8ff0\u3057\u306a\u304f\u3066\u3082\u826f\u304f\u306a\u308b\nJSON\u4ee5\u5916\u306e\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u306b\u3082\u5bfe\u5fdc\u3057\u3066\u3044\u308b\nAPI\u51fa\u529b\u306f\u57fa\u672c\u7684\u306b\u30e2\u30c7\u30eb\u306b\u7d10\u3065\u304f\n\u4ed6\u306eRails\u3001Jbuilder\u306b\u6bd4\u3079\u3066\u82e5\u5e72\u9045\u3044\n\n\n\u6240\u611f\n\n\u8a18\u8ff0\u304c\u72ec\u7279\u306a\u306e\u3067\u6163\u308c\u308b\u307e\u3067\u5c11\u3057\u6642\u9593\u304c\u304b\u304b\u308b\n\u7279\u5b9a\u306e\u30e2\u30c7\u30eb\u306b\u7d10\u3065\u304f\u30d7\u30ed\u30d1\u30c6\u30a3\u3092\u8868\u3059\u306e\u306b\u306f\u4fbf\u5229\u305d\u3046\n\n\u3063\u3066\u611f\u3058\u3067\u3059\u3002\u30e2\u30c7\u30eb\u306b\u7d10\u3065\u304f\u51fa\u529b\u306fRABL\u304c\u304b\u306a\u308a\u30b5\u30dd\u30fc\u30c8\u3057\u3066\u304f\u308c\u308b\u304c\u3001\u7d10\u4ed8\u304b\u306a\u3044\u30e2\u30ce\u3092\u8907\u96d1\u306b\u8868\u73fe\u3059\u308b\u306b\u306f\u82e6\u624b\u305d\u3046\u3002\n\u307e\u305f\u3001\u8a18\u8ff0\u304c\u72ec\u7279\u306a\u306e\u3067\u3001\u305d\u3053\u306f\u6163\u308c\u304c\u5fc5\u8981\u305d\u3046\u3067\u3059\u3002\n\n\u5b9f\u88c5\u65b9\u6cd5\n\nbundle install\n\nGemfile\ngem 'rabl'\n\n\n\nshell\nbundle install\n\n\n\n\u30b3\u30fc\u30c9\u306e\u4fee\u6b63\n\u3053\u3061\u3089\u3082\u30ea\u30af\u30a8\u30b9\u30c8\u306e\u53d6\u5f97\u90e8\u5206\u306eRails\u306e\u9805\u76ee\u3067\u4f5c\u6210\u3057\u305f\u30b3\u30fc\u30c9\u3092\u5143\u306bJSON\u3057\u3066\u51fa\u529b\u51fa\u6765\u308b\u3088\u3046\u306b\u3057\u307e\u3059\u3002\n\napp/controllers/api/v1/users_controller.rb\nclass Api::V1::UsersController < ApplicationController\n  def index\n    @users = User.where(\"addr1 = ?\", user_params[:addr1])\n    render \"api/ver1/users\"\n  end\n\n\n  private\n  def user_params\n    params.permit(:addr1)\n  end\n\nend\n\n\n\nRABL\u30d5\u30a1\u30a4\u30eb\u3092\u683c\u7d0d\u3059\u308b\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306e\u4f5c\u6210\napp/views/api/ver1/users.json.rabl\u306e\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u69cb\u9020\u306b\u3059\u308b\n\n\napp/views/api/ver1/users.json.rabl\ncollection @users, :object_root => false\nattribute :id => :id, :name => :name\n\nnode (:address) do |user|\n  {\n   addr1: user.addr1,\n   addr2: user.addr2\n  }\nend\n\n\n\nJbuilder\n\nJbuilder\u306e\u7279\u5fb4\n\nView\u306e\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u306a\u306e\u3067controller\u306b\u8a18\u8ff0\u3057\u306a\u304f\u3066\u3082\u826f\u304f\u306a\u308b\n\u8a18\u8ff0\u65b9\u6cd5\u304c\u30b7\u30f3\u30d7\u30eb\u3067\u89e3\u308a\u3084\u3059\u3044\n\u30e2\u30c7\u30eb\u306b\u7d10\u3065\u304b\u306a\u304f\u3066\u3082\u7c21\u5358\u306b\u6271\u3048\u308b\n\n\n\u6240\u611f\n\n\u8907\u96d1\u306a\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u3082\u8868\u73fe\u3057\u3084\u3059\u3044\n\u6761\u4ef6\u5f0f\u3001\u30e2\u30c7\u30eb\u306b\u7d10\u4ed8\u304b\u306a\u3044\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3082\u7c21\u5358\u306b\u6271\u3048\u308b\u306e\u3067\u53d6\u308a\u56de\u3057\u3084\u3059\u3044\n\n\u3063\u3066\u611f\u3058\u3067\u3059\u3002RABL\u306b\u6bd4\u3079\u308b\u3068\u76f4\u611f\u7684\u3067\u89e3\u308a\u3084\u3059\u3044\u3068\u611f\u3058\u307e\u3057\u305f\u3002\u4f55\u3088\u308a\u30e2\u30c7\u30eb\u306b\u7d10\u4ed8\u304b\u306a\u3044\u51e6\u7406\u3082\u8868\u73fe\u3057\u3084\u3059\u3044\u306e\u306f\u304b\u306a\u308a\u826f\u3044\u3067\u3059\u306d\u3002\n\n\u5b9f\u88c5\u65b9\u6cd5\n\nGemfile\ngem 'grape'\ngem 'grape-jbuilder'\n\n\n\nshell\nbundle install\n\n\n\nAPI\u90e8\u5206\u306e\u4fee\u6b63\n\u5148\u307b\u3069\u30ea\u30af\u30a8\u30b9\u30c8\u306e\u53d6\u5f97\u90e8\u5206\u306eGrape\u306e\u9805\u76ee\u3067\u4f5c\u6210\u3057\u305f\u30b3\u30fc\u30c9\u3092\u5143\u306bJSON\u51fa\u529b\u51fa\u6765\u308b\u3088\u3046\u306b\u3057\u307e\u3059\u3002\n\napp/apis/api/ver1/user.rb\nmodule API\n  module Ver1\n    class Users < Grape::API\n      format :json\n      formatter :json, Grape::Formatter::Jbuilder\n\n      # /api/v1/users/\n      get '/users', jbuilder: 'ver1/users/user' do\n        @users = User.where(\"addr1 = ?\", user_params[:addr1])\n      end\n\n    end\n  end\nend\n\n\n\nView\u90e8\u5206\u3092Jbuilder\u3067\u5b9f\u88c5\njson.array! @users do |user|\n  json.id   user.id\n  json.name user.name\n  json.address {\n    json.addr1   user.addr1\n    json.addr2   user.addr2\n  }\nend\n\n\n\u7d42\u308f\u308a\u306b\nAPI\u4e00\u3064\u4f5c\u6210\u3059\u308b\u306e\u3067\u3082\u304b\u306a\u308a\u9078\u629e\u3057\u304c\u3042\u308a\u307e\u3057\u305f\u3002\n\u500b\u4eba\u7684\u306b\u3001\u7c21\u5358\u306aAPI\u306a\u3089 Rails\u5358\u4f53\u3001\u5c11\u3057\u5927\u304d\u3081\u306e\u3082\u306e\u306a\u3089Greap + Jbuilder\n\u304c\u826f\u3055\u305d\u3046\u3060\u3068\u611f\u3058\u307e\u3057\u305f\u3002\n# \u306f\u3058\u3081\u306b\n\u5916\u90e8\u30b5\u30fc\u30d3\u30b9\u3068\u9023\u643a\u3057\u305f\u3044\uff01\u30a2\u30d7\u30ea\u958b\u767a\u3092\u3057\u305f\u3044\uff01\u969b\u306bAPI\u30b5\u30fc\u30d0\u3092\u4f5c\u6210\u3059\u308b\u3053\u3068\u304c\u3042\u308b\u304b\u3068\u601d\u3044\u307e\u3059\u3002\n\u4eca\u56de\u306fruby\u3092\u4f7f\u3063\u305f\u8272\u3005\u306aAPI\u306e\u5b9f\u88c5\u65b9\u6cd5\u3092\u3054\u7d39\u4ecb\u3057\u305f\u3044\u3068\u601d\u3044\u307e\u3059\u3002\n\n\n# \u767b\u5834\u4eba\u7269\n\u4eca\u56de\u306f\u4e0b\u8a18\u306e\u6240\u611f\u3001\u5b9f\u88c5\u65b9\u6cd5\u3092\u3054\u7d39\u4ecb\u3057\u3066\u3044\u304d\u307e\u3059\u3002\n## \u30ea\u30af\u30a8\u30b9\u30c8\u53d6\u5f97\u90e8\u5206\n- Rails\n- Grape\n\n## \u30ec\u30b9\u30dd\u30f3\u30b9\u90e8\u5206\n- Rails\n- RABL\n- Jbuilder\n\n# \u524d\u63d0\n\u4eca\u56de\u306f\u5168\u3066\u306e\u691c\u8a3c\u3067\u4e0b\u8a18\u306e\u30c6\u30fc\u30d6\u30eb\u3001URL\u3001\u51fa\u529b\u306b\u306a\u308b\u3088\u3046\u306b\u306a\u3063\u3066\u3044\u307e\u3059\u3002\n\n**User\u30c6\u30fc\u30d6\u30eb\u306e\u69cb\u6210**\n\n|id |name|addr1|addr2|\n|---|---|---|---|\n|1  |\u7530\u4e2d  | \u6771\u4eac\u90fd\u5343\u4ee3\u7530\u533a |0-0-0|\n|2  |\u5c71\u7530  | \u6771\u4eac\u90fd\u5343\u4ee3\u7530\u533a| 1-1-1|\n\n**\u30ea\u30af\u30a8\u30b9\u30c8URL**\n\u4eca\u56de\u306f\u30d0\u30fc\u30b8\u30e7\u30f3\u7ba1\u7406\u51fa\u6765\u308b\u3088\u3046\u306b``api/v1/``\u3068\u3057\u307e\u3057\u305f\u3002\n\n```\nhttp://example.com/api/v1/users?addr1=\u6771\u4eac\u90fd\u5343\u4ee3\u7530\u533a\n```\n\n**\u30ec\u30b9\u30dd\u30f3\u30b9**\n\n```\n[\n\t{\n\t\tid: 1,\n\t\tname: \"\u7530\u4e2d\",\n\t\taddress: {\n\t\t\taddr1: \"\u6771\u4eac\u90fd\u5343\u4ee3\u7530\u533a\",\n\t\t\taddr2: \"0-0-0\"\n\t\t}\n\t},\n\t{\n\t\tid: 2,\n\t\tname: \"\u5c71\u7530\"\n\t\taddress: {\n\t\t\taddr1: \"\u6771\u4eac\u90fd\u5343\u4ee3\u7530\u533a\",\n\t\t\taddr2: \"1-1-1\"\n\t\t}\n\t},\n]\n```\n\n\n\n# \u30ea\u30af\u30a8\u30b9\u30c8\u306e\u53d6\u5f97\u90e8\u5206\n\n\n## Rails\n\u6240\u611f\n\n- Rails\u306e\u898f\u5247\u901a\u308a\u306a\u306e\u3067Rails\u306b\u6163\u308c\u3066\u3044\u308b\u4eba\u306a\u3089\u6577\u5c45\u304c\u4f4e\u3044\n- Gem\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u30fb\u8a2d\u5b9a\u304c\u7279\u306b\u306a\u3044\n\n\u3063\u3066\u611f\u3058\u3067\u3059\u304b\u306d\u3002\u8a66\u3057\u306b\u30b5\u30af\u30c3\u3068API\u3092\u4f5c\u308b\u306b\u306f\u5411\u3044\u3066\u3044\u308b\u3068\u601d\u3044\u307e\u3057\u305f\u3002 \n\n### \u5b9f\u88c5\u65b9\u6cd5\n\n#### controller\u914d\u4e0b\u306bAPI\u7528\u306e\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092\u4f5c\u6210\u3059\u308b\n![users_controller_rb_-_canvath_-____Sites_canvath_canvath_.png](https://qiita-image-store.s3.amazonaws.com/0/49347/7cbc33ef-66b6-4207-a85e-463e309be4b7.png \"users_controller_rb_-_canvath_-____Sites_canvath_canvath_.png\")\n\n\n#### \u30eb\u30fc\u30c6\u30a3\u30f3\u30b0\u306e\u8a2d\u5b9a\n\u901a\u5e38\u306eRails\u3068\u540c\u69d8\u306broutes\u306b\u8a2d\u5b9a\u3092\u3057\u307e\u3059\u3002\n\n```rb:config/routes.rb\n# API\u7528\nnamespace :api, {format: 'json'} do\n  namespace :v1 do\n    namespace :users do\n      get \"/\" , :action => \"index\"\n    end\n  end\nend\n```\n\n\n\n#### controller\u306e\u5b9f\u88c5\ncontroller\u3092\u5b9f\u88c5\u3057\u3066\u3044\u304d\u307e\u3059\u3002\nrails\u3092\u66f8\u304d\u6163\u308c\u3066\u3044\u308b\u4eba\u306a\u3089\u7279\u306b\u9055\u548c\u611f\u306f\u306a\u3044\u304b\u3068\u601d\u3044\u307e\u3059\u3002\n**params.permit**\u306b\u3066\u30ea\u30af\u30a8\u30b9\u30c8\u30d1\u30e9\u30e1\u30fc\u30bf\u306e\u30d0\u30ea\u30c7\u30fc\u30b7\u30e7\u30f3\u3092\u304b\u3051\u3066\u3044\u307e\u3059\u3002\n\n```rb:app/controllers/api/v1/users_controller.rb\nclass Api::V1::UsersController < ApplicationController\n  def index\n\t@users = User.where(\"addr1 = ?\", user_params[:addr1])\n  end\n\n\n  private\n  # \u30ea\u30af\u30a8\u30b9\u30c8\u30d1\u30e9\u30e1\u30fc\u30bf\u306e\u30d0\u30ea\u30c7\u30fc\u30b7\u30e7\u30f3\n  def user_params\n    params.permit(:addr1)\n  end\nend\n```\n\u203b JSON\u3068\u3057\u3066\u51fa\u529b\u3059\u308b\u90e8\u5206\u306f\u30ec\u30b9\u30dd\u30f3\u30b9\u90e8\u5206\u306b\u3066\u89e3\u8aac\u3057\u307e\u3059\u3002\n\n\n\n## grape\n### grape\u3068\u306f\n\n- ruby\u3067\u7c21\u5358\u306bAPI\u3092\u4f5c\u6210\u3059\u308b\u305f\u3081\u306eDSL\n- \u5358\u4f53\u3001\u3082\u3057\u304f\u306fRails\u3084Sinatra\u3068\u7d44\u307f\u5408\u308f\u305b\u4f7f\u3046\n\n### \u6240\u611f\n- API\u5c02\u7528\u306eDSL\u306a\u306e\u3067\u30b7\u30f3\u30d7\u30eb\u306b\u304b\u3051\u308b\n- \u82e5\u5e72\u521d\u671f\u8a2d\u5b9a\u304c\u591a\u3044\n\n\u3063\u3066\u611f\u3058\u3067\u3059\u3002Rails\u306b\u6bd4\u3079\u308b\u3068\u5927\u304d\u3081\u306e\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306b\u5411\u3044\u3066\u3044\u308b\u306e\u304b\u306a\u3068\u611f\u3058\u307e\u3057\u305f\u3002\n\n\n### \u5b9f\u88c5\u65b9\u6cd5\n\n#### Gem\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n```rb:Gemfile.rb\ngem 'grape'\n```\n\n```bash:\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\nbundle install\n```\n\n####routes\u306e\u8a2d\u5b9a\n\n```rb:config/routes.rb\nmount API::Root => '/api'\n```\n#### grape\u3092\u8aad\u307f\u8fbc\u3081\u308b\u3088\u3046\u306b\u8a2d\u5b9a\n\n```rb:config/application.rb\n# API\u306e\u8aad\u307f\u8fbc\u307f\nconfig.paths.add File.join('app', 'apis'), glob: File.join('**', '*.rb')\nconfig.autoload_paths += Dir[Rails.root.join('app', 'apis', '*')]\n\n# Grape+JBuilder\u3092\u4f7f\u3046\u305f\u3081\u306e\u8a2d\u5b9a\nconfig.middleware.use(Rack::Config) do |env|\n  env['api.tilt.root'] = Rails.root.join 'app', 'views', 'api'\nend\n```\n\n#### \u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306e\u4f5c\u6210\ngrape\u306e\u5834\u5408\u306f\u3001app\u914d\u4e0b\u306b\u4e0b\u8a18\u56f3\u306e\u3088\u3046\u306b\u4f5c\u6210\u3057\u307e\u3057\u305f\u3002\n![api_root_rb_-_canvath_-____Sites_canvath_canvath_.png](https://qiita-image-store.s3.amazonaws.com/0/49347/7e554a51-cfb7-9c6e-f16a-219f307b6e08.png \"api_root_rb_-_canvath_-____Sites_canvath_canvath_.png\")\n\n\n\n#### root\u306e\u8a2d\u5b9a\n``apis/api`` \u914d\u4e0b\u306b``root.rb``\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\n```apis/api/root.rb\nmodule API\n  class Root < Grape::API\n    mount API::Ver1::Root\n  end\nend\n```\n\n``apis/api/ver1`` \u914d\u4e0b\u306b``root.rb``\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\n```rb:apis/api/ver1/root.rb\nmodule API\n  module Ver1\n    class Root < Grape::API\n\n      # \u3053\u308c\u3067domain/api/v1\u3067\u30a2\u30af\u30bb\u30b9\u51fa\u6765\u308b\u3088\u3046\u306b\u306a\u308b\u3002\n      version 'v1', using: :path\n      format :json\n\n      mount API::Ver1::Users\n\n      # 404NotFound\u306e\u6271\u3044\n      route :any, '*path' do\n        error! I18n.t('grape.errors.not_found'), 404\n      end\n\n    end\n  end\nend\n\n```\n\n#### API\u90e8\u5206\u306e\u5b9f\u88c5\n\n```rb:app/apis/api/ver1/user.rb\nmodule API\n  module Ver1\n    class Users < Grape::API\n      format :json\n\n      # /api/v1/users/\n      get '/users' do\n        @users = User.where(\"addr1 = ?\", user_params[:addr1])\n      end\n\n    end\n  end\nend\n```\n\u203b JSON\u3068\u3057\u3066\u51fa\u529b\u3059\u308b\u90e8\u5206\u306f\u30ec\u30b9\u30dd\u30f3\u30b9\u90e8\u5206\u306b\u3066\u89e3\u8aac\u3057\u307e\u3059\u3002\n\n## \u30ec\u30b9\u30dd\u30f3\u30b9\u90e8\u5206\n\u7d9a\u3044\u3066\u30ec\u30b9\u30dd\u30f3\u30b9(View)\u306e\u90e8\u5206\u3092**Rails**\u3001**RABL**\u3001**Jbuilder**\u3092\u4f7f\u3063\u305f\u6240\u611f\u3001\u5b9f\u88c5\u65b9\u6cd5\u3092\u3054\u7d39\u4ecb\u3057\u307e\u3059\u3002\n\n## Rails\n\n### \u6240\u611f\n- \u7c21\u5358\u306a\u3082\u306e\u306a\u3089\u4e8b\u8db3\u308a\u308b\u304c\u3001\u8907\u96d1\u306a\u30ec\u30b9\u30dd\u30f3\u30b9\u306f\u53b3\u3057\u305d\u3046\u3002\n- controller\u5185\u306b\u30ec\u30b9\u30dd\u30f3\u30b9\u306e\u51e6\u7406\u304c\u542b\u307e\u308c\u308b\u306e\u3067\u3001\u7ba1\u7406\u304c\u758e\u304b\u306b\u306a\u308a\u304c\u3061\n\n\u3063\u3066\u611f\u3058\u3067\u3059\u3002\u30c7\u30e2\u7b49\u306e\u7c21\u5358\u306a\u3082\u306e\u306a\u3089\u826f\u3044\u3067\u3059\u304c\u3001\u8907\u96d1\u306a\u3082\u306e\u306f\u3061\u3087\u3063\u3068\u53b3\u3057\u305d\u3046\u306a\u5370\u8c61\u3067\u3059\u3002\n\n### \u5b9f\u88c5\u65b9\u6cd5\n\u5148\u307b\u3069\u30ea\u30af\u30a8\u30b9\u30c8\u306e\u53d6\u5f97\u90e8\u5206\u306eRails\u306e\u9805\u76ee\u3067\u4f5c\u6210\u3057\u305f\u30b3\u30fc\u30c9\u3092\u5143\u306bJSON\u3057\u3066\u51fa\u529b\u51fa\u6765\u308b\u3088\u3046\u306b\u3057\u307e\u3059\u3002\n\n```rb:app/controllers/api/v1/users_controller.rb\nclass Api::V1::UsersController < ApplicationController\n  def index\n\t@users = User.where(\"addr1 = ?\", user_params[:addr1])\n    @users = @users.map do |user|\n      {\n          id: user.id,\n\t\t   name: user.name,\n          address:{\n              addr1: user.addr1,\n              addr2: user.addr2\n          },\n      }\n    end\n    render json: @users\n  end\n\n\n  private\n  # \u30ea\u30af\u30a8\u30b9\u30c8\u30d1\u30e9\u30e1\u30fc\u30bf\u306e\u30d0\u30ea\u30c7\u30fc\u30b7\u30e7\u30f3\n  def user_params\n    params.permit(:addr1)\n  end\nend\n```\n\n\n## RABL\n\n### RABL\u306e\u7279\u5fb4\n- View\u306e\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u306a\u306e\u3067controller\u306b\u8a18\u8ff0\u3057\u306a\u304f\u3066\u3082\u826f\u304f\u306a\u308b\n- JSON\u4ee5\u5916\u306e\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u306b\u3082\u5bfe\u5fdc\u3057\u3066\u3044\u308b\n- API\u51fa\u529b\u306f\u57fa\u672c\u7684\u306b\u30e2\u30c7\u30eb\u306b\u7d10\u3065\u304f\n- \u4ed6\u306eRails\u3001Jbuilder\u306b\u6bd4\u3079\u3066\u82e5\u5e72\u9045\u3044\n\n### \u6240\u611f\n- \u8a18\u8ff0\u304c\u72ec\u7279\u306a\u306e\u3067\u6163\u308c\u308b\u307e\u3067\u5c11\u3057\u6642\u9593\u304c\u304b\u304b\u308b\n- \u7279\u5b9a\u306e\u30e2\u30c7\u30eb\u306b\u7d10\u3065\u304f\u30d7\u30ed\u30d1\u30c6\u30a3\u3092\u8868\u3059\u306e\u306b\u306f\u4fbf\u5229\u305d\u3046\n\n\u3063\u3066\u611f\u3058\u3067\u3059\u3002\u30e2\u30c7\u30eb\u306b\u7d10\u3065\u304f\u51fa\u529b\u306fRABL\u304c\u304b\u306a\u308a\u30b5\u30dd\u30fc\u30c8\u3057\u3066\u304f\u308c\u308b\u304c\u3001\u7d10\u4ed8\u304b\u306a\u3044\u30e2\u30ce\u3092\u8907\u96d1\u306b\u8868\u73fe\u3059\u308b\u306b\u306f\u82e6\u624b\u305d\u3046\u3002\n\u307e\u305f\u3001\u8a18\u8ff0\u304c\u72ec\u7279\u306a\u306e\u3067\u3001\u305d\u3053\u306f\u6163\u308c\u304c\u5fc5\u8981\u305d\u3046\u3067\u3059\u3002\n\n### \u5b9f\u88c5\u65b9\u6cd5\n\n#### bundle install\n\n```rb:Gemfile\ngem 'rabl'\n```\n\n```bash:shell\nbundle install\n```\n\n#### \u30b3\u30fc\u30c9\u306e\u4fee\u6b63\n\u3053\u3061\u3089\u3082\u30ea\u30af\u30a8\u30b9\u30c8\u306e\u53d6\u5f97\u90e8\u5206\u306eRails\u306e\u9805\u76ee\u3067\u4f5c\u6210\u3057\u305f\u30b3\u30fc\u30c9\u3092\u5143\u306bJSON\u3057\u3066\u51fa\u529b\u51fa\u6765\u308b\u3088\u3046\u306b\u3057\u307e\u3059\u3002\n\n```rb:app/controllers/api/v1/users_controller.rb\nclass Api::V1::UsersController < ApplicationController\n  def index\n    @users = User.where(\"addr1 = ?\", user_params[:addr1])\n    render \"api/ver1/users\"\n  end\n\n\n  private\n  def user_params\n    params.permit(:addr1)\n  end\n\nend\n```\n\n#### RABL\u30d5\u30a1\u30a4\u30eb\u3092\u683c\u7d0d\u3059\u308b\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306e\u4f5c\u6210\n\n``app/views/api/ver1/users.json.rabl``\u306e\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u69cb\u9020\u306b\u3059\u308b\n\n![user_rb_-_canvath_-____Sites_canvath_canvath_.png](https://qiita-image-store.s3.amazonaws.com/0/49347/bf6c88e5-92c6-ee35-56b2-d4cbbbd79d83.png)\n\n\n```rb:app/views/api/ver1/users.json.rabl\ncollection @users, :object_root => false\nattribute :id => :id, :name => :name\n\nnode (:address) do |user|\n  {\n   addr1: user.addr1,\n   addr2: user.addr2\n  }\nend\n```\n\n## Jbuilder\n\n### Jbuilder\u306e\u7279\u5fb4\n- View\u306e\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u306a\u306e\u3067controller\u306b\u8a18\u8ff0\u3057\u306a\u304f\u3066\u3082\u826f\u304f\u306a\u308b\n- \u8a18\u8ff0\u65b9\u6cd5\u304c\u30b7\u30f3\u30d7\u30eb\u3067\u89e3\u308a\u3084\u3059\u3044\n- \u30e2\u30c7\u30eb\u306b\u7d10\u3065\u304b\u306a\u304f\u3066\u3082\u7c21\u5358\u306b\u6271\u3048\u308b\n\n### \u6240\u611f\n- \u8907\u96d1\u306a\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u3082\u8868\u73fe\u3057\u3084\u3059\u3044\n- \u6761\u4ef6\u5f0f\u3001\u30e2\u30c7\u30eb\u306b\u7d10\u4ed8\u304b\u306a\u3044\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3082\u7c21\u5358\u306b\u6271\u3048\u308b\u306e\u3067\u53d6\u308a\u56de\u3057\u3084\u3059\u3044\n\n\u3063\u3066\u611f\u3058\u3067\u3059\u3002RABL\u306b\u6bd4\u3079\u308b\u3068\u76f4\u611f\u7684\u3067\u89e3\u308a\u3084\u3059\u3044\u3068\u611f\u3058\u307e\u3057\u305f\u3002\u4f55\u3088\u308a\u30e2\u30c7\u30eb\u306b\u7d10\u4ed8\u304b\u306a\u3044\u51e6\u7406\u3082\u8868\u73fe\u3057\u3084\u3059\u3044\u306e\u306f\u304b\u306a\u308a\u826f\u3044\u3067\u3059\u306d\u3002\n\n### \u5b9f\u88c5\u65b9\u6cd5\n\n```rb:Gemfile\ngem 'grape'\ngem 'grape-jbuilder'\n```\n\n```bash:shell\nbundle install\n```\n\n\n#### API\u90e8\u5206\u306e\u4fee\u6b63\n\u5148\u307b\u3069\u30ea\u30af\u30a8\u30b9\u30c8\u306e\u53d6\u5f97\u90e8\u5206\u306eGrape\u306e\u9805\u76ee\u3067\u4f5c\u6210\u3057\u305f\u30b3\u30fc\u30c9\u3092\u5143\u306bJSON\u51fa\u529b\u51fa\u6765\u308b\u3088\u3046\u306b\u3057\u307e\u3059\u3002\n\n```rb:app/apis/api/ver1/user.rb\nmodule API\n  module Ver1\n    class Users < Grape::API\n      format :json\n      formatter :json, Grape::Formatter::Jbuilder\n\n      # /api/v1/users/\n      get '/users', jbuilder: 'ver1/users/user' do\n        @users = User.where(\"addr1 = ?\", user_params[:addr1])\n      end\n\n    end\n  end\nend\n```\n\n#### View\u90e8\u5206\u3092Jbuilder\u3067\u5b9f\u88c5\n\n```rb:\njson.array! @users do |user|\n  json.id   user.id\n  json.name user.name\n  json.address {\n    json.addr1   user.addr1\n    json.addr2   user.addr2\n  }\nend\n```\n\n# \u7d42\u308f\u308a\u306b\nAPI\u4e00\u3064\u4f5c\u6210\u3059\u308b\u306e\u3067\u3082\u304b\u306a\u308a\u9078\u629e\u3057\u304c\u3042\u308a\u307e\u3057\u305f\u3002\n\u500b\u4eba\u7684\u306b\u3001\u7c21\u5358\u306aAPI\u306a\u3089 Rails\u5358\u4f53\u3001\u5c11\u3057\u5927\u304d\u3081\u306e\u3082\u306e\u306a\u3089Greap + Jbuilder\n\u304c\u826f\u3055\u305d\u3046\u3060\u3068\u611f\u3058\u307e\u3057\u305f\u3002\n", "tags": ["Ruby", "Rails", "api", "rabl", "grape"]}