{"context": " More than 1 year has passed since last update.\u3053\u308c\u306f\u5927\u3005\u7684\u306b\u767a\u8868\u3055\u308c\u305f\u5272\u306b\u306f\u8ab0\u3082\u4f7f\u3063\u3066\u3044\u308b\u3068\u3044\u3046\u5642\u3092\u805e\u304b\u306a\u3044 Google \u304c\u63d0\u4f9b\u3059\u308b Docker \u306e Private repository \u30b5\u30fc\u30d3\u30b9\u3067\u3042\u308b Google Container Registry \u3092\u3001Google Container Engine (\u4ee5\u964d\u3001GKE\uff09\u3068\u7d44\u307f\u5408\u308f\u305b\u3066\u4f7f\u3063\u3066\u307f\u3088\u3046\u3068\u3044\u3044\u3046\u8a18\u4e8b\u3067\u3059\u3002\n\n\u7d50\u8ad6\n\nGKE \u4f7f\u3046\u306a\u3089\u3001Google Container Registry\u306f\u3068\u3066\u3082\u4fbf\u5229\u306a\u306e\u3067\u3001\u5229\u7528\u3092\u5f37\u304f\u63a8\u5968\u3057\u307e\u3059\u3002\nGKE \u306e\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u304c\u306a\u3055\u3059\u304e\u308b\u306e\u304c\u666e\u53ca\u306b\u3057\u306a\u3044\u539f\u56e0\u306a\u3093\u3058\u3083\u306a\u3044\u304b\u3068\u601d\u3046\u3002\n\n\n\u5229\u70b9\nDocker \u306e Private \u30ea\u30dd\u30b8\u30c8\u30ea\u30b5\u30fc\u30d3\u30b9\u306f\u672c\u5bb6\u306e Docker Hub \u3068\u304b Quay.IO\u306a\u3069\u304c\u3042\u308a\u307e\u3059\u304c\u3001Google Container Registry \u306e\u5229\u70b9\u306f\u3001\n\nPrivate \u30ea\u30dd\u30b8\u30c8\u30ea\u306e\u6570\u306f\u7121\u5236\u9650\u3067\u3001\u5b89\u3044\uff08GCS \u306e\u30b9\u30c8\u30ec\u30fc\u30b8\u3068\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u6599\u91d1\u3060\u3051\u3067\u6e08\u3080 = \u7d043\u5186/GB/\u6708\uff09\nGKE \u304b\u3089\u306e\u30a4\u30e1\u30fc\u30b8\u306e\u53d6\u5f97\u304c\u901f\u3044\n\n\u3068\u3044\u3063\u305f\u3068\u3053\u308d\u3067\u3057\u3087\u3046\u304b\u3002\n\n\u5229\u7528\u624b\u9806\n\u5229\u7528\u624b\u9806\u306f\u516c\u5f0f\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u306b\u66f8\u3044\u3066\u3042\u308b\u306e\u3067\u3001\u8a73\u7d30\u306f\u305d\u3061\u3089\u3092\u53c2\u7167\u3057\u3066\u304f\u3060\u3055\u3044\u3002\nhttps://cloud.google.com/tools/container-registry/\n\u304c\u3001\u76f8\u5909\u308f\u3089\u305a\u65e5\u672c\u8a9e\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u306f\u306a\u3044\u306e\u3067\u3001\u4e0a\u8a18\u304b\u3089\u91cd\u8981\u306a\u90e8\u5206\u3060\u3051\u629c\u7c8b\u3057\u3066\u89e3\u8aac\u3057\u3066\u3044\u304d\u307e\u3059\u3002\n\ngcloud tool\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\nhttps://cloud.google.com/sdk/#Quick_Start\n\ngcloud preview commands CLI \u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\nGoogle Container Registry \u306f\u307e\u3060 preview \u306a\u306e\u3067\u3001gcloud preive commands \u7d4c\u7531\u3067\u64cd\u4f5c\u3057\u307e\u3059\u3002\u4ee5\u4e0b\u306e\u30b3\u30de\u30f3\u30c9\u3067\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\n$ gcloud components update preview\n\n\n\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306e\u4f5c\u6210\nGKE\u3092\u5229\u7528\u3059\u308b\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092\u4f5c\u308b\uff0f\u9078\u629e\u3057\u3066\u3001gcloud CLI \u306e\u30c7\u30d5\u30a9\u30eb\u30c8\u3068\u3057\u3066\u8a2d\u5b9a\u3057\u305f\u304a\u304d\u307e\u3059\u3002\u3053\u306e\u5f8c\u306e\u305f\u3081\u306b\u3001\u81ea\u5206\u304c owner \u304b editor \u6a29\u9650\u306e\u3042\u308b\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092\u9078\u3093\u3067\u304f\u3060\u3055\u3044\u3002\n$ gcloud auth login\n$ gcloud config set project your-project-id\n\n\nDocker \u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\nhttps://docs.docker.com/installation/ \u3092\u53c2\u7167\u3002\n\nDocker \u30a4\u30e1\u30fc\u30b8\u306e build & push\n\u30a4\u30e1\u30fc\u30b8\u306f\u4f55\u3067\u3082\u826f\u3044\u306e\u3067\u3001\u3068\u308a\u3042\u3048\u305a\u4ee5\u4e0b\u306e1\u884c\u3092\u66f8\u3044\u305f Dockerfile \u3068\u3044\u3046\u540d\u524d\u306e\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u308a\u307e\u3059\u3002\nFROM dockerfile/nginx\n\n\u6b21\u306b\u3053\u308c\u3092\u7279\u5225\u306a\u30bf\u30b0\u540d\u3092\u4ed8\u3051\u3066\u30d3\u30eb\u30c9\u3057\u307e\u3059\u3002\u30bf\u30b0\u540d\u306e\u898f\u5247\u306f\u3001project ID\u304c your-project-id \u3060\u3063\u305f\u5834\u5408\u3001\ngcr.io/your_project_id/image-name\n\n\u3067\u3059\u3002\u6ce8\u610f\u70b9\u3068\u3057\u3066\u306f\u3001Image \u306e tag \u540d\u306b '-'\uff08\u30cf\u30a4\u30d5\u30f3\uff09\u306f\u4f7f\u3048\u306a\u3044\u306e\u3067\u3001Project ID \u306b\u30cf\u30a4\u30d5\u30f3\u304c\u5165\u3063\u3066\u3044\u308b\u5834\u5408\u3001\u30a2\u30f3\u30c0\u30fc\u30b9\u30b3\u30a2\u306b\u7f6e\u63db\u3057\u306a\u3051\u308c\u3070\u3044\u3051\u306a\u3044\u3053\u3068\u3067\u3059\u3002\n\u306a\u306e\u3067\u3001\u30d3\u30eb\u30c9\u3059\u308b\u306b\u306f\u3001\n$ docker build -t gcr.io/your_project_id/nginx .\n\n\u3067\u3001\u6700\u5f8c\u306b gcloud preview docker \u30b3\u30de\u30f3\u30c9\u3067 push \u3057\u307e\u3059\u3002\n$ gcloud preview docker push gcr.io/your_project_id/nginx\n\n\u3053\u306e\u30b3\u30de\u30f3\u30c9\u306f\u81ea\u52d5\u7684\u306b artifacts.your-project-id.appspot.com \u3068\u3044\u3046\u540d\u524d\u306e GCS \u30d0\u30b1\u30c3\u30c8\u3092 US \u30ea\u30fc\u30b8\u30e7\u30f3\u306b\u4f5c\u6210\u3057\u307e\u3059\u3002\u306a\u306e\u3067\u3001GKE \u30af\u30e9\u30b9\u30bf\u3092 US \u30ea\u30fc\u30b8\u30e7\u30f3\u4ee5\u5916\u306b\u7acb\u3066\u308b\u3068\u3001\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u8ee2\u9001\u91cf\u304c\u304b\u304b\u308b\u306e\u3067\u3054\u6ce8\u610f\u3092\u3002\n\nDocker \u30a4\u30e1\u30fc\u30b8\u306e Pull\uff08\u304a\u307e\u3051\uff09\n\u4eca\u56de\u306f GKE \u304b\u3089\u306e\u5229\u7528\u3092\u60f3\u5b9a\u3057\u3066\u3044\u308b\u306e\u3067\u4f7f\u3044\u307e\u305b\u3093\u304c\u3001\u666e\u901a\u306b pull \u3082\u3067\u304d\u307e\u3059\u3002\u958b\u767a\u7528\u30a4\u30e1\u30fc\u30b8\u306e\u5171\u6709\u3068\u304b\u306b\u4f7f\u3048\u308b\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u3002\n$ gcloud preview docker pull gcr.io/your_project_id/nginx\n\n\nGKE \u30af\u30e9\u30b9\u30bf\u306e\u7acb\u3061\u4e0a\u3052\nGKE\u30af\u30e9\u30b9\u30bf\u306e\u7acb\u3061\u4e0a\u3052\u306e\u65b9\u6cd5\u304c\u516c\u5f0f\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u306b\u66f8\u3044\u3066\u3044\u306a\u3044\u306e\u3067\u3001\u3084\u308a\u65b9\u3092\u66f8\u3044\u3066\u304a\u304d\u307e\u3059\u3002\u6b63\u76f4\u3001preview \u30b5\u30fc\u30d3\u30b9\u3067\u7d50\u69cb\u30b3\u30de\u30f3\u30c9\u4f53\u7cfb\u304c\u5909\u308f\u308b\u306e\u304c\u60a9\u307f\u3069\u3053\u308d\u3067\u3059\u3002\n#\n# \u5229\u7528\u3059\u308b\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u3092\u4f5c\u6210\n#\n$ gcloud compute networks create gketest-network \\\n  --range 10.241.0.0/16\n#\n# SSH/HTTP \u30dd\u30fc\u30c8\u3092\u89e3\u653e\n#\n$ gcloud compute firewall-rules create gketest-network-allow-ssh \\\n  --allow tcp:22 \\\n  --network gketest-network \\\n  --source-ranges 0.0.0.0/0 # \u6c17\u306b\u306a\u308b\u306a\u3089\u3053\u3053\u306f\u81ea\u5206\u306eIP\u306b\u9650\u5b9a\u3059\u308b\n$ gcloud compute firewall-rules create gketest-network-allow-http \\\n  --allow tcp:80 \\\n  --network gketest-network \\\n  --source-ranges 0.0.0.0/0\n#\n# \u4f5c\u6210\u3057\u305f\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u3092\u5229\u7528\u3059\u308b\u30af\u30e9\u30b9\u30bf\u306e\u8d77\u52d5\n#\n$ gcloud preview container clusters create gketest \\\n    --zone us-central1-a \\\n    --network gketest-network \\\n    --num-nodes 1 \\\n    --machine-type n1-standard-1 \\\n    --no-set-default\n\n\u3067\u3001\u30af\u30e9\u30b9\u30bf\u304c\u8d77\u52d5\u3057\u305f\u3089\u3001\u3053\u306e\u30af\u30e9\u30b9\u30bf\u306b\u5148\u307b\u3069\u4f5c\u6210\u3057\u305f\u30a4\u30e1\u30fc\u30b8\u3092\u5229\u7528\u3059\u308b Pod \u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\u4ee5\u4e0b\u306e\u3088\u3046\u306a JSON \u5f62\u5f0f\u306e\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3092 nginx-pod.json \u3068\u3044\u3046\u540d\u524d\u3067\u4f5c\u6210\u3057\u3001\n{\n  \"id\": \"nginx\",\n  \"kind\": \"Pod\",\n  \"apiVersion\": \"v1beta1\",\n  \"desiredState\": {\n    \"manifest\": {\n      \"version\": \"v1beta1\",\n      \"containers\": [{\n        \"name\": \"nginx\",\n        \"image\": \"gcr.io/your_project_id/nginx\",\n        \"ports\": [{\n          \"containerPort\": 80,\n          \"hostPort\": 80\n        }]\n      }]\n    }\n  },\n  \"labels\": {\n    \"name\": \"nginx\"\n  }\n}\n\n\u3053\u308c\u3092\u4f7f\u3063\u3066 pod \u3092\u4f5c\u6210\u3057\u307e\u3059\u3002pod \u306e\u4f5c\u6210\u306b\u306f gcloud preview container kubectl \u30b3\u30de\u30f3\u30c9\u3092\u5229\u7528\u3057\u307e\u3059\u3002\n$ gcloud preview container kubectl \\\n    --cluster gketest \\\n    --zone us-central1-a \\\n    create -f nginx-pod.json\n\n\u5927\u4f53\u300130\u79d2\u301c1\u5206\u3050\u3089\u3044\u3067\u30a2\u30af\u30bb\u30b9\u3067\u304d\u308b\u69d8\u306b\u306a\u308a\u307e\u3059\u3002\u4ee5\u4e0b\u306e\u30b3\u30de\u30f3\u30c9\u3067\u3001status \u304c Running \u306b\u306a\u3063\u3066\u3044\u308c\u3070\u3001\u6e96\u5099\u5b8c\u4e86\u3067\u3059\u3002\n$ gcloud preview container kubectl \\\n    --cluster gketest \\\n    --zone us-central1-a \\\n    get pods\n\n\u6700\u5f8c\u306b\u30b5\u30fc\u30d3\u30b9\u5b9a\u7fa9 nginx-service.json \u3092\u4f5c\u3063\u3066\u3001\n{\n  \"id\": \"nginx-service\",\n  \"apiVersion\": \"v1beta1\",\n  \"kind\": \"Service\",\n  \"port\": 80,\n  \"containerPort\": 80,\n  \"selector\": {\n    \"name\": \"nginx\"\n  },\n  \"createExternalLoadBalancer\": true\n}\n\n\u30b5\u30fc\u30d3\u30b9\u3092\u7acb\u3061\u4e0a\u3052\u307e\u3059\u3002\n$ gcloud preview container kubectl \\\n    --cluster gketest \\\n    --zone us-central1-a \\\n    create -f nginx-service.json\n\n\u30b5\u30fc\u30d3\u30b9\u306eIP\u30a2\u30c9\u30ec\u30b9\u306f\u3001Compute Engine -> Network \u30e1\u30cb\u30e5\u30fc\u304b\u3089\u307f\u3064\u3051\u3089\u308c\u307e\u3059\u3002\n\n\u3053\u308c\u3092\u30d6\u30e9\u30a6\u30b6\u3067\u958b\u3044\u3066\u3001nginx \u306e\u753b\u50cf\u304c\u78ba\u8a8d\u3067\u304d\u308c\u3070\u6210\u529f\u3067\u3059\u3002\n\n\u3053\u308c\u306f\u5927\u3005\u7684\u306b\u767a\u8868\u3055\u308c\u305f\u5272\u306b\u306f\u8ab0\u3082\u4f7f\u3063\u3066\u3044\u308b\u3068\u3044\u3046\u5642\u3092\u805e\u304b\u306a\u3044 Google \u304c\u63d0\u4f9b\u3059\u308b Docker \u306e Private repository \u30b5\u30fc\u30d3\u30b9\u3067\u3042\u308b Google Container Registry \u3092\u3001Google Container Engine (\u4ee5\u964d\u3001GKE\uff09\u3068\u7d44\u307f\u5408\u308f\u305b\u3066\u4f7f\u3063\u3066\u307f\u3088\u3046\u3068\u3044\u3044\u3046\u8a18\u4e8b\u3067\u3059\u3002\n\n## \u7d50\u8ad6\n\n- GKE \u4f7f\u3046\u306a\u3089\u3001Google Container Registry\u306f\u3068\u3066\u3082\u4fbf\u5229\u306a\u306e\u3067\u3001\u5229\u7528\u3092\u5f37\u304f\u63a8\u5968\u3057\u307e\u3059\u3002\n- GKE \u306e\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u304c\u306a\u3055\u3059\u304e\u308b\u306e\u304c\u666e\u53ca\u306b\u3057\u306a\u3044\u539f\u56e0\u306a\u3093\u3058\u3083\u306a\u3044\u304b\u3068\u601d\u3046\u3002\n\n## \u5229\u70b9\n\nDocker \u306e Private \u30ea\u30dd\u30b8\u30c8\u30ea\u30b5\u30fc\u30d3\u30b9\u306f\u672c\u5bb6\u306e [Docker Hub](https://hub.docker.com) \u3068\u304b [Quay.IO](https://quay.io/)\u306a\u3069\u304c\u3042\u308a\u307e\u3059\u304c\u3001Google Container Registry \u306e\u5229\u70b9\u306f\u3001\n\n- Private \u30ea\u30dd\u30b8\u30c8\u30ea\u306e\u6570\u306f\u7121\u5236\u9650\u3067\u3001\u5b89\u3044\uff08GCS \u306e\u30b9\u30c8\u30ec\u30fc\u30b8\u3068\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u6599\u91d1\u3060\u3051\u3067\u6e08\u3080 = \u7d043\u5186/GB/\u6708\uff09\n- GKE \u304b\u3089\u306e\u30a4\u30e1\u30fc\u30b8\u306e\u53d6\u5f97\u304c\u901f\u3044\n\n\u3068\u3044\u3063\u305f\u3068\u3053\u308d\u3067\u3057\u3087\u3046\u304b\u3002\n\n## \u5229\u7528\u624b\u9806\n\n\u5229\u7528\u624b\u9806\u306f\u516c\u5f0f\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u306b\u66f8\u3044\u3066\u3042\u308b\u306e\u3067\u3001\u8a73\u7d30\u306f\u305d\u3061\u3089\u3092\u53c2\u7167\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\nhttps://cloud.google.com/tools/container-registry/\n\n\u304c\u3001\u76f8\u5909\u308f\u3089\u305a\u65e5\u672c\u8a9e\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u306f\u306a\u3044\u306e\u3067\u3001\u4e0a\u8a18\u304b\u3089\u91cd\u8981\u306a\u90e8\u5206\u3060\u3051\u629c\u7c8b\u3057\u3066\u89e3\u8aac\u3057\u3066\u3044\u304d\u307e\u3059\u3002\n\n### gcloud tool\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\nhttps://cloud.google.com/sdk/#Quick_Start\n\n### gcloud preview commands CLI \u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\nGoogle Container Registry \u306f\u307e\u3060 preview \u306a\u306e\u3067\u3001gcloud preive commands \u7d4c\u7531\u3067\u64cd\u4f5c\u3057\u307e\u3059\u3002\u4ee5\u4e0b\u306e\u30b3\u30de\u30f3\u30c9\u3067\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\n\n```bash\n$ gcloud components update preview\n```\n\n### \u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306e\u4f5c\u6210\n\nGKE\u3092\u5229\u7528\u3059\u308b\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092\u4f5c\u308b\uff0f\u9078\u629e\u3057\u3066\u3001gcloud CLI \u306e\u30c7\u30d5\u30a9\u30eb\u30c8\u3068\u3057\u3066\u8a2d\u5b9a\u3057\u305f\u304a\u304d\u307e\u3059\u3002\u3053\u306e\u5f8c\u306e\u305f\u3081\u306b\u3001\u81ea\u5206\u304c owner \u304b editor \u6a29\u9650\u306e\u3042\u308b\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092\u9078\u3093\u3067\u304f\u3060\u3055\u3044\u3002\n\n```\n$ gcloud auth login\n$ gcloud config set project your-project-id\n```\n\n### Docker \u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\nhttps://docs.docker.com/installation/ \u3092\u53c2\u7167\u3002\n\n### Docker \u30a4\u30e1\u30fc\u30b8\u306e build & push\n\n\u30a4\u30e1\u30fc\u30b8\u306f\u4f55\u3067\u3082\u826f\u3044\u306e\u3067\u3001\u3068\u308a\u3042\u3048\u305a\u4ee5\u4e0b\u306e1\u884c\u3092\u66f8\u3044\u305f Dockerfile \u3068\u3044\u3046\u540d\u524d\u306e\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u308a\u307e\u3059\u3002\n\n```\nFROM dockerfile/nginx\n```\n\n\u6b21\u306b\u3053\u308c\u3092\u7279\u5225\u306a\u30bf\u30b0\u540d\u3092\u4ed8\u3051\u3066\u30d3\u30eb\u30c9\u3057\u307e\u3059\u3002\u30bf\u30b0\u540d\u306e\u898f\u5247\u306f\u3001project ID\u304c `your-project-id` \u3060\u3063\u305f\u5834\u5408\u3001\n\n```\ngcr.io/your_project_id/image-name\n```\n\n\u3067\u3059\u3002\u6ce8\u610f\u70b9\u3068\u3057\u3066\u306f\u3001Image \u306e tag \u540d\u306b `'-'\uff08\u30cf\u30a4\u30d5\u30f3\uff09`\u306f\u4f7f\u3048\u306a\u3044\u306e\u3067\u3001Project ID \u306b\u30cf\u30a4\u30d5\u30f3\u304c\u5165\u3063\u3066\u3044\u308b\u5834\u5408\u3001\u30a2\u30f3\u30c0\u30fc\u30b9\u30b3\u30a2\u306b\u7f6e\u63db\u3057\u306a\u3051\u308c\u3070\u3044\u3051\u306a\u3044\u3053\u3068\u3067\u3059\u3002\n\n\u306a\u306e\u3067\u3001\u30d3\u30eb\u30c9\u3059\u308b\u306b\u306f\u3001\n\n```\n$ docker build -t gcr.io/your_project_id/nginx .\n```\n\n\u3067\u3001\u6700\u5f8c\u306b `gcloud preview docker` \u30b3\u30de\u30f3\u30c9\u3067 push \u3057\u307e\u3059\u3002\n\n```\n$ gcloud preview docker push gcr.io/your_project_id/nginx\n```\n\n\u3053\u306e\u30b3\u30de\u30f3\u30c9\u306f\u81ea\u52d5\u7684\u306b `artifacts.your-project-id.appspot.com` \u3068\u3044\u3046\u540d\u524d\u306e GCS \u30d0\u30b1\u30c3\u30c8\u3092 US \u30ea\u30fc\u30b8\u30e7\u30f3\u306b\u4f5c\u6210\u3057\u307e\u3059\u3002\u306a\u306e\u3067\u3001GKE \u30af\u30e9\u30b9\u30bf\u3092 US \u30ea\u30fc\u30b8\u30e7\u30f3\u4ee5\u5916\u306b\u7acb\u3066\u308b\u3068\u3001\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u8ee2\u9001\u91cf\u304c\u304b\u304b\u308b\u306e\u3067\u3054\u6ce8\u610f\u3092\u3002\n\n### Docker \u30a4\u30e1\u30fc\u30b8\u306e Pull\uff08\u304a\u307e\u3051\uff09\n\n\u4eca\u56de\u306f GKE \u304b\u3089\u306e\u5229\u7528\u3092\u60f3\u5b9a\u3057\u3066\u3044\u308b\u306e\u3067\u4f7f\u3044\u307e\u305b\u3093\u304c\u3001\u666e\u901a\u306b pull \u3082\u3067\u304d\u307e\u3059\u3002\u958b\u767a\u7528\u30a4\u30e1\u30fc\u30b8\u306e\u5171\u6709\u3068\u304b\u306b\u4f7f\u3048\u308b\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u3002\n\n```bash\n$ gcloud preview docker pull gcr.io/your_project_id/nginx\n```\n\n### GKE \u30af\u30e9\u30b9\u30bf\u306e\u7acb\u3061\u4e0a\u3052\n\nGKE\u30af\u30e9\u30b9\u30bf\u306e\u7acb\u3061\u4e0a\u3052\u306e\u65b9\u6cd5\u304c\u516c\u5f0f\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u306b\u66f8\u3044\u3066\u3044\u306a\u3044\u306e\u3067\u3001\u3084\u308a\u65b9\u3092\u66f8\u3044\u3066\u304a\u304d\u307e\u3059\u3002\u6b63\u76f4\u3001preview \u30b5\u30fc\u30d3\u30b9\u3067\u7d50\u69cb\u30b3\u30de\u30f3\u30c9\u4f53\u7cfb\u304c\u5909\u308f\u308b\u306e\u304c\u60a9\u307f\u3069\u3053\u308d\u3067\u3059\u3002\n\n```bash\n#\n# \u5229\u7528\u3059\u308b\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u3092\u4f5c\u6210\n#\n$ gcloud compute networks create gketest-network \\\n  --range 10.241.0.0/16\n#\n# SSH/HTTP \u30dd\u30fc\u30c8\u3092\u89e3\u653e\n#\n$ gcloud compute firewall-rules create gketest-network-allow-ssh \\\n  --allow tcp:22 \\\n  --network gketest-network \\\n  --source-ranges 0.0.0.0/0 # \u6c17\u306b\u306a\u308b\u306a\u3089\u3053\u3053\u306f\u81ea\u5206\u306eIP\u306b\u9650\u5b9a\u3059\u308b\n$ gcloud compute firewall-rules create gketest-network-allow-http \\\n  --allow tcp:80 \\\n  --network gketest-network \\\n  --source-ranges 0.0.0.0/0\n#\n# \u4f5c\u6210\u3057\u305f\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u3092\u5229\u7528\u3059\u308b\u30af\u30e9\u30b9\u30bf\u306e\u8d77\u52d5\n#\n$ gcloud preview container clusters create gketest \\\n    --zone us-central1-a \\\n    --network gketest-network \\\n    --num-nodes 1 \\\n    --machine-type n1-standard-1 \\\n    --no-set-default\n```\n\n\u3067\u3001\u30af\u30e9\u30b9\u30bf\u304c\u8d77\u52d5\u3057\u305f\u3089\u3001\u3053\u306e\u30af\u30e9\u30b9\u30bf\u306b\u5148\u307b\u3069\u4f5c\u6210\u3057\u305f\u30a4\u30e1\u30fc\u30b8\u3092\u5229\u7528\u3059\u308b Pod \u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\n\u4ee5\u4e0b\u306e\u3088\u3046\u306a JSON \u5f62\u5f0f\u306e\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3092 `nginx-pod.json` \u3068\u3044\u3046\u540d\u524d\u3067\u4f5c\u6210\u3057\u3001\n\n```json\n{\n  \"id\": \"nginx\",\n  \"kind\": \"Pod\",\n  \"apiVersion\": \"v1beta1\",\n  \"desiredState\": {\n    \"manifest\": {\n      \"version\": \"v1beta1\",\n      \"containers\": [{\n        \"name\": \"nginx\",\n        \"image\": \"gcr.io/your_project_id/nginx\",\n        \"ports\": [{\n          \"containerPort\": 80,\n          \"hostPort\": 80\n        }]\n      }]\n    }\n  },\n  \"labels\": {\n    \"name\": \"nginx\"\n  }\n}\n```\n\n\u3053\u308c\u3092\u4f7f\u3063\u3066 pod \u3092\u4f5c\u6210\u3057\u307e\u3059\u3002pod \u306e\u4f5c\u6210\u306b\u306f `gcloud preview container kubectl` \u30b3\u30de\u30f3\u30c9\u3092\u5229\u7528\u3057\u307e\u3059\u3002\n\n```bash\n$ gcloud preview container kubectl \\\n    --cluster gketest \\\n    --zone us-central1-a \\\n    create -f nginx-pod.json\n```\n\n\u5927\u4f53\u300130\u79d2\u301c1\u5206\u3050\u3089\u3044\u3067\u30a2\u30af\u30bb\u30b9\u3067\u304d\u308b\u69d8\u306b\u306a\u308a\u307e\u3059\u3002\u4ee5\u4e0b\u306e\u30b3\u30de\u30f3\u30c9\u3067\u3001status \u304c Running \u306b\u306a\u3063\u3066\u3044\u308c\u3070\u3001\u6e96\u5099\u5b8c\u4e86\u3067\u3059\u3002\n\n```bash\n$ gcloud preview container kubectl \\\n    --cluster gketest \\\n    --zone us-central1-a \\\n    get pods\n```\n\n\u6700\u5f8c\u306b\u30b5\u30fc\u30d3\u30b9\u5b9a\u7fa9 `nginx-service.json` \u3092\u4f5c\u3063\u3066\u3001\n\n```json\n{\n  \"id\": \"nginx-service\",\n  \"apiVersion\": \"v1beta1\",\n  \"kind\": \"Service\",\n  \"port\": 80,\n  \"containerPort\": 80,\n  \"selector\": {\n    \"name\": \"nginx\"\n  },\n  \"createExternalLoadBalancer\": true\n}\n```\n\n\u30b5\u30fc\u30d3\u30b9\u3092\u7acb\u3061\u4e0a\u3052\u307e\u3059\u3002\n\n```bash\n$ gcloud preview container kubectl \\\n    --cluster gketest \\\n    --zone us-central1-a \\\n    create -f nginx-service.json\n```\n\n\u30b5\u30fc\u30d3\u30b9\u306eIP\u30a2\u30c9\u30ec\u30b9\u306f\u3001Compute Engine -> Network \u30e1\u30cb\u30e5\u30fc\u304b\u3089\u307f\u3064\u3051\u3089\u308c\u307e\u3059\u3002\n\n![\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2015-03-20 22.50.02.png](https://qiita-image-store.s3.amazonaws.com/0/25774/17d035b1-c780-461c-3dfe-589fed3c01db.png)\n\n\u3053\u308c\u3092\u30d6\u30e9\u30a6\u30b6\u3067\u958b\u3044\u3066\u3001nginx \u306e\u753b\u50cf\u304c\u78ba\u8a8d\u3067\u304d\u308c\u3070\u6210\u529f\u3067\u3059\u3002\n\n![\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2015-03-20 22.58.15.png](https://qiita-image-store.s3.amazonaws.com/0/25774/638a358f-e182-5604-2cb9-c1d3b24de192.png)\n", "tags": ["GoogleCloudPlatform", "docker", "GoogleContainerEngine", "GoogleContainerRegistry"]}