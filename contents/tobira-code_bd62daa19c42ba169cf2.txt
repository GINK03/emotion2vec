{"tags": ["processing", "\u30b7\u30df\u30e5\u30ec\u30fc\u30b7\u30e7\u30f3"], "context": " More than 1 year has passed since last update.\n\n\u306f\u3058\u3081\u306b\n\u6ce2\u304c\u5883\u754c\u306b\u9054\u3057\u305f\u3068\u304d\u53cd\u5c04\u3057\u306a\u3044\u3067\u6d88\u3048\u53bb\u3063\u3066\u307b\u3057\u3044\u3053\u3068\u304c\u3042\u308a\u307e\u3059\u3002\n\u3053\u308c\u3092\u5b9f\u73fe\u3059\u308bPerfectly matched layer\u3068\u3044\u3046\u624b\u6cd5\u306b\u3064\u3044\u3066\u8a18\u8f09\u3057\u307e\u3059\u3002\n\nPerfectly matched layer(PML)\n\u6b21\u306ePaper\u304c\u5206\u304b\u308a\u3084\u3059\u304b\u3063\u305f\u3067\u3059\u3002\u3053\u306e\u5185\u5bb9\u3092\u8a18\u8f09\u3057\u307e\u3059\u3002\n\nNotes on Perfectly Matched Layers (PMLs)\n\n\n\u6ce2\u52d5\u65b9\u7a0b\u5f0f\nu(t,x,y,z)u(t,x,y,z)\u306f\u6ce2\u3092\u8868\u3057\u307e\u3059\u3002\n\u2207=(\u2202\u2202x,\u2202\u2202y,\u2202\u2202z)\\nabla = (\\frac{\\partial}{\\partial x}, \\frac{\\partial}{\\partial y}, \\frac{\\partial}{\\partial z})\u3067\u3059\u3002\"\u22c5\\cdot\"\u306f\u5185\u7a4d\u3067\u3059\u3002\n\u4ee5\u4e0b\u304c\u6ce2\u52d5\u65b9\u7a0b\u5f0f\u3067\u3059\u3002\u5c11\u3057\u4e0d\u81ea\u7136\u306a\u5f62\u5f0f\u306b\u898b\u3048\u307e\u3059\u304c2\u3064\u306e\u65b9\u7a0b\u5f0f\u306b\u5206\u3051\u308b\u4fbf\u5b9c\u4e0a\u3053\u306e\u3088\u3046\u306b\u3057\u307e\u3059\u3002\n\\nabla \\cdot (a \\nabla u) = \\frac{1}{b} \\frac{\\partial^2 u}{\\partial t^2}\n\u2207\u22c5(a\u2207u)=1b\u22022u\u2202t2{\\nabla \\cdot (a \\nabla u) = \\frac{1}{b} \\frac{\\partial^2 u}{\\partial t^2}\n}\n\u5fae\u5206\u306e\u968e\u6570\u3092\u6e1b\u3089\u3059(2\u968e\u21921\u968e)\u305f\u3081\u306b2\u3064\u306e\u65b9\u7a0b\u5f0f\u306b\u5206\u89e3\u3057\u307e\u3059\u3002\n\u2192v(t,x,y,z)\\vec{v}(t,x,y,z)\u3067\u3059\u3002\n\\frac{\\partial u}{\\partial t} = b \\nabla \\cdot \\vec{v} \\\\\n\\frac{\\partial \\vec{v}}{\\partial t} = a \\nabla u\n\u2202u\u2202t=b\u2207\u22c5\u2192v\u2202\u2192v\u2202t=a\u2207u{\\frac{\\partial u}{\\partial t} = b \\nabla \\cdot \\vec{v} \\\\\n\\frac{\\partial \\vec{v}}{\\partial t} = a \\nabla u\n}\n\u4e0a\u8a18\u65b9\u7a0b\u5f0f\u3092\u307e\u3068\u3081\u307e\u3059\u3002\u5358\u306a\u308b\u66f8\u304d\u63db\u3048\u3067\u3059\u3002\n\u2192w\\vec{w}\u306fuu\u3068\u2192v\\vec{v}\u3092\u4e26\u3079\u305f\u30d9\u30af\u30c8\u30eb\u3067\u3059\u3002\u02c6D\\hat{D}\u306f4x4\u306e\u6f14\u7b97\u5b50\u3067\u3059\u3002\n\\frac{\\partial \\vec{w}}{\\partial t} = \n\\frac{\\partial}{\\partial t}\n\\left(\n    \\begin{array}{r}\n      u \\\\\n      \\vec{v} \\\\\n    \\end{array}\n\\right) = \n\\left(\n    \\begin{array}{rr}\n       & b\\nabla \\cdot \\\\\n      a\\nabla & \\\\\n    \\end{array}\n\\right)\n\\left(\n    \\begin{array}{r}\n      u \\\\\n      \\vec{v} \\\\\n    \\end{array}\n\\right) =\n\\hat{D} \\vec{w} \\\\\n\n\\hat{D} = \n\\left(\n    \\begin{array}{rr}\n       & b\\nabla \\cdot \\\\\n      a\\nabla & \\\\\n    \\end{array}\n\\right)\n\u2202\u2192w\u2202t=\u2202\u2202t(u\u2192v)=(b\u2207\u22c5a\u2207)(u\u2192v)=\u02c6D\u2192w\u02c6D=(b\u2207\u22c5a\u2207){\\frac{\\partial \\vec{w}}{\\partial t} = \n\\frac{\\partial}{\\partial t}\n\\left(\n    \\begin{array}{r}\n      u \\\\\n      \\vec{v} \\\\\n    \\end{array}\n\\right) = \n\\left(\n    \\begin{array}{rr}\n       & b\\nabla \\cdot \\\\\n      a\\nabla & \\\\\n    \\end{array}\n\\right)\n\\left(\n    \\begin{array}{r}\n      u \\\\\n      \\vec{v} \\\\\n    \\end{array}\n\\right) =\n\\hat{D} \\vec{w} \\\\\n\n\\hat{D} = \n\\left(\n    \\begin{array}{rr}\n       & b\\nabla \\cdot \\\\\n      a\\nabla & \\\\\n    \\end{array}\n\\right)\n}\n\u6b21\u306e\u4eee\u5b9a\u3092\u7f6e\u304d\u307e\u3059\u3002\u539f\u6587\u629c\u7c8b\n\n\nWe will assume that the space far from the region of interest is homogeneous.\nWe will assume that the space far from the region of interest is linear and time-invariant.\n\n\n\u4e0a\u8a18\u4eee\u5b9a\u306e\u3082\u3068\u3067\u2192w(\u2192x,t)\\vec{w}(\\vec{x},t)\u306f\u6b21\u306e\u3088\u3046\u306a\u89e3\u306b\u306a\u308b\u3068\u306e\u3053\u3068\u3002plane wave\u306e\u91cd\u306d\u5408\u308f\u305b\u8868\u73fe\u306b\u306a\u3063\u3066\u3044\u307e\u3059\u3002\n\u03c9\\omega\u306f\u89d2\u5468\u6ce2\u6570,\u2192k\\vec{k}\u306f\u6ce2\u6570\u30d9\u30af\u30c8\u30eb\u3067\u3059\u3002\u2192W\\vec{W}\u306f\u632f\u5e45\u3067\u3059\u3002\n\\vec{w}(\\vec{x},t) = \\sum_{\\vec{k},\\omega}{\\vec{W}_{\\vec{k},\\omega}exp(i(\\vec{k} \\cdot \\vec{x} - \\omega t))}\n\u2192w(\u2192x,t)=\u2211\u2192k,\u03c9\u2192W\u2192k,\u03c9exp(i(\u2192k\u22c5\u2192x\u2212\u03c9t)){\\vec{w}(\\vec{x},t) = \\sum_{\\vec{k},\\omega}{\\vec{W}_{\\vec{k},\\omega}exp(i(\\vec{k} \\cdot \\vec{x} - \\omega t))}\n}\n\u4e0a\u8a18\u4f8b\u3068\u3057\u3066\u4ee5\u4e0b\u304c\u793a\u3055\u308c\u3066\u3044\u307e\u3059\u3002\u5f0f(A)\u3068\u3057\u307e\u3059\u3002\n\\vec{W}(y,z) exp(i(kx - \\omega t))\n\u2192W(y,z)exp(i(kx\u2212\u03c9t)){\\vec{W}(y,z) exp(i(kx - \\omega t))\n}\n\n\u89e3\u6790\u63a5\u7d9a\n\u5f0f(A)\u306fx\u306b\u3064\u3044\u3066\u89e3\u6790\u95a2\u6570\u3067\u3059\u3002\u3057\u305f\u304c\u3063\u3066\u89e3\u6790\u63a5\u7d9a\u3067\u304d\u307e\u3059\u3002\n\u3053\u306e\u3053\u3068\u306f\u5fae\u5206\u65b9\u7a0b\u5f0f\u3092\u6e80\u305f\u3057\u306a\u304c\u3089\u5909\u6570\u304c\u52d5\u304f\u7d4c\u8def\u3092\u5909\u3048\u3089\u308c\u308b\u3053\u3068\u3092\u610f\u5473\u3057\u3066\u3044\u307e\u3059\u3002\n\u307e\u305f\u3001exp()\u3067\u3042\u308b\u3053\u3068\u304b\u3089\u632f\u5e45\u3092\u6307\u6570\u95a2\u6570\u7684\u306b\u6e1b\u8870\u3055\u305b\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\u3053\u308c\u304c\u53cd\u5c04\u3092\u6291\u3048\u3066\u6ce2\u3092\u6025\u6fc0\u306b\u6e1b\u8870\u3055\u305b\u3089\u308c\u308b\u7406\u7531\u306b\u306a\u308a\u307e\u3059\u3002\n\u5206\u304b\u308a\u3084\u3059\u3044\u56f3\u304c\u8a18\u8f09\u3055\u308c\u3066\u3044\u307e\u3057\u305f\u306e\u3067\u629c\u7c8b\u3057\u307e\u3059\u3002\nexp(ikx)exp(ikx)\u306e\u30b0\u30e9\u30d5\u3067\u3059\u3002\u632f\u5e451, \u6642\u9593\u9805\u306f\u7701\u7565\u3055\u308c\u3066\u3044\u307e\u3059\u3002\n\n\u4e0a\u5074\u306fx\u304c\u5b9f\u6570\u6210\u5206\u306e\u307f\u306e\u5834\u5408\u3067\u3059\u3002\u6e1b\u8870\u306f\u307f\u3089\u308c\u307e\u305b\u3093\u3002\n\u4e0b\u5074\u306fx\u306e\u865a\u6570\u6210\u5206\u3092\u5c11\u3057\u305a\u3064\u5897\u3084\u3057\u305f\u5834\u5408\u3067\u3059\u3002\u6ce2\u5f62\u304c\u6e1b\u8870\u3057\u3066\u3044\u308b\u3053\u3068\u304c\u5206\u304b\u308a\u307e\u3059\u3002\n\u3053\u306e\u3088\u3046\u306b\u3057\u3066\u865a\u6570\u6210\u5206\u3092\u5897\u3084\u3059\u3053\u3068\u3067\u6ce2\u5f62\u3092\u6e1b\u8870\u3055\u305b\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n\u8907\u7d20\u6570\u3078\u306e\u5909\u63db\n\u02dcx=x+if(x)\\tilde{x} = x + if(x)\u3068\u3057\u307e\u3059\u3002\n\u2202\u02dcx=(1+idfdx)\u2202x\\partial \\tilde{x} = (1 + i \\frac{df}{dx})\\partial x\u306b\u306a\u308a\u307e\u3059\u3002dfdx=\u03c3x(x)\u03c9\\frac{df}{dx}=\\frac{\\sigma_x(x)}{\\omega}\u3068\u304a\u304d\u307e\u3059\u3002\n\u03c3x(x)\\sigma_x(x)\u306f\u865a\u6570\u90e8\u3092\u5897\u52a0\u3055\u305b\u308b\u95a2\u6570\u3067\u3059\u3002\n\u5fae\u5206\u6f14\u7b97\u5b50\u3092\u6b21\u306e\u3088\u3046\u306b\u7f6e\u304d\u63db\u3048\u308b\u3053\u3068\u3067PML\u306b\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\u5909\u63db(B)\u3068\u3057\u307e\u3059\u3002\n\\frac{\\partial}{\\partial x} \\to \\frac{1}{1+i\\frac{\\sigma_x(x)}{\\omega}} \\frac{\\partial}{\\partial x}\n\u2202\u2202x\u219211+i\u03c3x(x)\u03c9\u2202\u2202x{\\frac{\\partial}{\\partial x} \\to \\frac{1}{1+i\\frac{\\sigma_x(x)}{\\omega}} \\frac{\\partial}{\\partial x}\n}\n\n1\u6b21\u5143PML\nu(t,x),v(t,x)u(t,x),v(t,x)\u306b\u3064\u3044\u3066\u6b21\u306e\u5f0f\u304c1\u6b21\u5143\u6ce2\u52d5\u65b9\u7a0b\u5f0f\u3067\u3059\u3002\u5f0f(C)\u3068\u3057\u307e\u3059\u3002\nuu\u3068vv\u306e\u6642\u9593\u4f9d\u5b58\u306e\u90e8\u5206\u306fexp(\u2212i\u03c9t)exp(-i\\omega t)\u3068\u3057\u307e\u3059\u3002\n\\frac{\\partial u}{\\partial t} = b \\frac{\\partial v}{\\partial x} = -i\\omega u \\\\\n\\frac{\\partial v}{\\partial t} = a \\frac{\\partial u}{\\partial x} = -i\\omega v \\\\\n\u2202u\u2202t=b\u2202v\u2202x=\u2212i\u03c9u\u2202v\u2202t=a\u2202u\u2202x=\u2212i\u03c9v{\\frac{\\partial u}{\\partial t} = b \\frac{\\partial v}{\\partial x} = -i\\omega u \\\\\n\\frac{\\partial v}{\\partial t} = a \\frac{\\partial u}{\\partial x} = -i\\omega v \\\\\n}\n\u4e0a\u8a18\u5f0f\u306b\u5909\u63db(B)\u3092\u884c\u3044\u307e\u3059\u3002\nb \\frac{\\partial v}{\\partial x} = -i\\omega u + \\sigma_x u \\\\\na \\frac{\\partial u}{\\partial x} = -i\\omega v + \\sigma_x v \\\\\nb\u2202v\u2202x=\u2212i\u03c9u+\u03c3xua\u2202u\u2202x=\u2212i\u03c9v+\u03c3xv{b \\frac{\\partial v}{\\partial x} = -i\\omega u + \\sigma_x u \\\\\na \\frac{\\partial u}{\\partial x} = -i\\omega v + \\sigma_x v \\\\\n}\n\u4e0a\u8a18\u5f0f\u3068\u5f0f(C)\u304b\u3089\u2212i\u03c9u-i\\omega u\u3068\u2212i\u03c9v-i\\omega v\u3092\u6d88\u53bb\u3057\u307e\u3059\u3002\u2212i\u03c9-i \\omega\u304c\u2202\u2202t\\frac{\\partial}{\\partial t}\u306b\u306a\u308b\u3068\u8003\u3048\u3066\u3082\u3088\u3044\u3067\u3059\u3002\n\u3053\u308c\u304ctime-domain\u306e1\u6b21\u5143PML\u3067\u3059\u3002\n\\frac{\\partial u}{\\partial t} = b \\frac{\\partial v}{\\partial x} - \\sigma_x u \\\\\n\\frac{\\partial v}{\\partial t} = a \\frac{\\partial u}{\\partial x} - \\sigma_x v \\\\\n\u2202u\u2202t=b\u2202v\u2202x\u2212\u03c3xu\u2202v\u2202t=a\u2202u\u2202x\u2212\u03c3xv{\\frac{\\partial u}{\\partial t} = b \\frac{\\partial v}{\\partial x} - \\sigma_x u \\\\\n\\frac{\\partial v}{\\partial t} = a \\frac{\\partial u}{\\partial x} - \\sigma_x v \\\\\n}\n\n\u5dee\u5206\u5316\u30fb\u96e2\u6563\u5316\n\u5dee\u5206\u5316\n\\frac{1}{\u0394t}(u(t+\u0394t,x)-u(t,x)) = b \\frac{1}{\u0394x}(v(t, x)-v(t, x-\u0394x)) - \u03c3_x u(t, x) \\\\\n\\frac{1}{\u0394t}(v(t+\u0394t,x)-v(t,x)) = a \\frac{1}{\u0394x}(u(t+\u0394t, x+\u0394x)-u(t+\u0394t, x)) - \u03c3_x v(t, x) \\\\\n1\u0394t(u(t+\u0394t,x)\u2212u(t,x))=b1\u0394x(v(t,x)\u2212v(t,x\u2212\u0394x))\u2212\u03c3xu(t,x)1\u0394t(v(t+\u0394t,x)\u2212v(t,x))=a1\u0394x(u(t+\u0394t,x+\u0394x)\u2212u(t+\u0394t,x))\u2212\u03c3xv(t,x){\\frac{1}{\u0394t}(u(t+\u0394t,x)-u(t,x)) = b \\frac{1}{\u0394x}(v(t, x)-v(t, x-\u0394x)) - \u03c3_x u(t, x) \\\\\n\\frac{1}{\u0394t}(v(t+\u0394t,x)-v(t,x)) = a \\frac{1}{\u0394x}(u(t+\u0394t, x+\u0394x)-u(t+\u0394t, x)) - \u03c3_x v(t, x) \\\\\n}\n(*)\n2\u756a\u76ee\u306e\u5f0f\u306eu(t+\u0394t,x+\u0394x),u(t+\u0394t,x)u(t+\u0394t,x+\u0394x),u(t+\u0394t,x)\u306e\u9805\u3067\u6642\u9593\u30fb\u7a7a\u9593\u5dee\u5206\u30921\u756a\u76ee\u306e\u5f0f\u306b\u5bfe\u3057\u30661\u3064\u305a\u3089\u3057\u3066\u3044\u307e\u3059\u3002\n\u30b7\u30df\u30e5\u30ec\u30fc\u30b7\u30e7\u30f3\u7d50\u679c\u304c\u4e0d\u5b89\u5b9a\u306b\u306a\u3063\u305f\u305f\u3081\u3053\u306e\u3088\u3046\u306b\u3057\u307e\u3057\u305f\u3002\n\u96e2\u6563\u5316\n\u0394t=1,t=0,1,2,...\u0394t=1, t=0,1,2,...\n\u0394x=1,x=0,1,2,...,len\u0394x=1, x=0,1,2,...,len\n\u3068\u3057\u307e\u3059\u3002\nu(t+1,x) = u(t,x) + b(v(t,x)-v(t,x-1)) - \u03c3_x u(t,x) \\\\\nv(t+1,x) = v(t,x) + a(u(t+1,x+1)-u(t+1,x)) - \u03c3_x v(t,x) \\\\\nu(t+1,x)=u(t,x)+b(v(t,x)\u2212v(t,x\u22121))\u2212\u03c3xu(t,x)v(t+1,x)=v(t,x)+a(u(t+1,x+1)\u2212u(t+1,x))\u2212\u03c3xv(t,x){u(t+1,x) = u(t,x) + b(v(t,x)-v(t,x-1)) - \u03c3_x u(t,x) \\\\\nv(t+1,x) = v(t,x) + a(u(t+1,x+1)-u(t+1,x)) - \u03c3_x v(t,x) \\\\\n}\nt=0\u306e\u3068\u304d\nu(1,x) = u(0,x) + b(v(0,x)-v(0,x-1)) - \u03c3_x u(0,x) \\\\\nv(1,x) = v(0,x) + a(u(1,x+1)-u(1,x)) - \u03c3_x v(0,x) \\\\\nu(1,x)=u(0,x)+b(v(0,x)\u2212v(0,x\u22121))\u2212\u03c3xu(0,x)v(1,x)=v(0,x)+a(u(1,x+1)\u2212u(1,x))\u2212\u03c3xv(0,x){u(1,x) = u(0,x) + b(v(0,x)-v(0,x-1)) - \u03c3_x u(0,x) \\\\\nv(1,x) = v(0,x) + a(u(1,x+1)-u(1,x)) - \u03c3_x v(0,x) \\\\\n}\n\u521d\u671f\u6761\u4ef6\nu(0,x),v(0,x)u(0,x),v(0,x)\n\u5883\u754c\u6761\u4ef6\nu(t,0),u(t,len)u(t,0),u(t,len)\n\u6e1b\u8870\u6761\u4ef6\n\u03c3x(x)\u03c3_x(x)\n\nProcessing\u3067\u53ef\u8996\u5316 PML\u72481\u6b21\u5143\u6ce2\u52d5\u65b9\u7a0b\u5f0f\nu1,v1\u306f\u73fe\u5728\u306e\u5206\u5e03\u3001u0,v0\u306f1\u6642\u523b\u524d\u306e\u5206\u5e03\u3067\u3059\u3002\n\u5de6\u7aef\u306eu0\u3092sin\u95a2\u6570\u3067\u632f\u3063\u3066\u3044\u307e\u3059\u3002\nu1,v1\u306e\u53f3\u7aef\u6570\u70b9\u306f0\u56fa\u5b9a\u306b\u3057\u3066\u3044\u307e\u3059\u3002float\u7bc4\u56f2\u3067\u53ce\u675f\u3057\u304d\u308c\u306a\u3044\u5024\u304c\u53cd\u5c04\u3059\u308b\u306e\u3092\u5f37\u5236\u7684\u306b\u6291\u3048\u3066\u3044\u307e\u3059\u3002\n\u53f3\u5074\u534a\u5206\u304c\u6e1b\u8870\u9818\u57df\u306b\u306a\u308a\u307e\u3059\u3002\nfloat a = 0.7;\nfloat b = 0.7;\nfloat[] u0;\nfloat[] v0;\nfloat[] u1;\nfloat[] v1;\nfloat[] s; // sigma\nint step = 100;\nfloat w = 0;\nint time = 0;\n\nvoid setup() {\n  size(600, 300);\n  init();\n  //noSmooth();\n  frameRate(20);\n  background(0);\n  fill(0, 0, 0, 0);\n  stroke(255, 255, 255);\n}\n\nvoid draw() {\n  background(0);\n  for (int i=0; i<step; i++) {\n    float x1,x2,y1,y2;\n    x1 = w*i;\n    y1 = height/2+u1[i];\n    ellipse(x1, y1, 2, 2);\n    if (i < step-1) {\n      y2 = height/2+u1[i+1];\n      x2 = w*(i+1);\n      line(x1, y1, x2, y2);\n    }\n  }\n  for (int i=0; i<1; i++) // speed up\n    updateTime();\n}\n\nvoid init()\n{\n  w = width/(step-1);\n  u0 = new float[step];\n  v0 = new float[step];\n  u1 = new float[step];\n  v1 = new float[step];\n  s = new float[step];\n  int llen = step/2; // length of layer\n  float inc_step = 0.5/llen;\n  for (int i=step-llen; i<step; i++) {\n    s[i] = inc_step*(i-(step-llen));\n  }\n}\n\nvoid updateTime()\n{\n  int force_zero_len = 5;\n  u1[0] = 100*sin(2*PI/20*time);\n\n  for (int i=1; i<step-1; i++) {\n    u1[i]  = u0[i] + b*(v0[i] - v0[i-1]) - s[i]*u0[i];\n  }\n  for (int i=0; i<step-1; i++) {\n    v1[i]  = v0[i] + a*(u1[i+1] - u1[i]) - s[i]*v0[i];\n  }\n  for (int i=0; i<step-force_zero_len; i++) {\n    u0[i] = u1[i];\n    v0[i] = v1[i];\n  }\n\n  time++;\n}\n\n\n\n2\u6b21\u5143PML\nu(t,x,y),vx(t,x,y),vy(t,x,y)u(t,x,y),v_x(t,x,y),v_y(t,x,y)\u306b\u3064\u3044\u3066\u6b21\u306e\u5f0f\u304c2\u6b21\u5143\u6ce2\u52d5\u65b9\u7a0b\u5f0f\u3067\u3059\u3002\nuu\u3068vx,vyv_x,v_y\u306e\u6642\u9593\u4f9d\u5b58\u306e\u90e8\u5206\u306fexp(\u2212i\u03c9t)exp(\u2212i\u03c9t)\u3068\u3057\u307e\u3059\u3002\n\\frac{\\partial u}{\\partial t} = b \\nabla \\cdot v = b \\frac{\\partial v_x}{\\partial  x} + b \\frac{\\partial v_y}{\\partial  y} = -i \\omega u \\\\\n\\frac{\\partial v_x}{\\partial t} = a \\frac{\\partial u}{\\partial x} = -i \\omega v_x \\\\\n\\frac{\\partial v_y}{\\partial t} = a \\frac{\\partial u}{\\partial y} = -i \\omega v_y \\\\\n\u2202u\u2202t=b\u2207\u22c5v=b\u2202vx\u2202x+b\u2202vy\u2202y=\u2212i\u03c9u\u2202vx\u2202t=a\u2202u\u2202x=\u2212i\u03c9vx\u2202vy\u2202t=a\u2202u\u2202y=\u2212i\u03c9vy{\\frac{\\partial u}{\\partial t} = b \\nabla \\cdot v = b \\frac{\\partial v_x}{\\partial  x} + b \\frac{\\partial v_y}{\\partial  y} = -i \\omega u \\\\\n\\frac{\\partial v_x}{\\partial t} = a \\frac{\\partial u}{\\partial x} = -i \\omega v_x \\\\\n\\frac{\\partial v_y}{\\partial t} = a \\frac{\\partial u}{\\partial y} = -i \\omega v_y \\\\\n}\n\u4e0a\u8a18\u5f0f\u306b\u5909\u63db(B)\u3092\u884c\u3044\u307e\u3059\u3002y\u65b9\u5411\u306b\u3082\u5909\u63db\u3057\u307e\u3059\u3002\n\u2202x\u2192(1+i\u03c3x\u03c9)\u2202x\\partial x \\to (1+i \\frac{\\sigma_x}{\\omega})\\partial x\n\u2202y\u2192(1+i\u03c3y\u03c9)\u2202y\\partial y \\to (1+i \\frac{\\sigma_y}{\\omega})\\partial y\nb \\frac{\\partial v_x}{\\partial  x}(1+i\\frac{\\sigma_y}{\\omega}) + b \\frac{\\partial v_y}{\\partial  y}(1+i\\frac{\\sigma_x}{\\omega}) =\n -i \\omega u + (\\sigma_x + \\sigma_y) u + i\\frac{\\sigma_x \\sigma_y}{\\omega} u\\\\\na \\frac{\\partial u}{\\partial x} = -i \\omega v_x + \\sigma_x v_x\\\\\na \\frac{\\partial u}{\\partial y} = -i \\omega v_y + \\sigma_y v_y\\\\\nb\u2202vx\u2202x(1+i\u03c3y\u03c9)+b\u2202vy\u2202y(1+i\u03c3x\u03c9)=\u2212i\u03c9u+(\u03c3x+\u03c3y)u+i\u03c3x\u03c3y\u03c9ua\u2202u\u2202x=\u2212i\u03c9vx+\u03c3xvxa\u2202u\u2202y=\u2212i\u03c9vy+\u03c3yvy{b \\frac{\\partial v_x}{\\partial  x}(1+i\\frac{\\sigma_y}{\\omega}) + b \\frac{\\partial v_y}{\\partial  y}(1+i\\frac{\\sigma_x}{\\omega}) =\n -i \\omega u + (\\sigma_x + \\sigma_y) u + i\\frac{\\sigma_x \\sigma_y}{\\omega} u\\\\\na \\frac{\\partial u}{\\partial x} = -i \\omega v_x + \\sigma_x v_x\\\\\na \\frac{\\partial u}{\\partial y} = -i \\omega v_y + \\sigma_y v_y\\\\\n}\n2,3\u756a\u76ee\u306e\u5f0f\u3092\u2212i\u03c9-i\\omega\u3092\u2202\u2202t\\frac{\\partial}{\\partial t}\u306b\u7f6e\u304d\u63db\u3048\u307e\u3059\u3002\n\\frac{\\partial v_x}{\\partial t} = a \\frac{\\partial u}{\\partial x} - \\sigma_x u \\\\\n\\frac{\\partial v_y}{\\partial t} = a \\frac{\\partial u}{\\partial y} - \\sigma_y u \\\\\n\u2202vx\u2202t=a\u2202u\u2202x\u2212\u03c3xu\u2202vy\u2202t=a\u2202u\u2202y\u2212\u03c3yu{\\frac{\\partial v_x}{\\partial t} = a \\frac{\\partial u}{\\partial x} - \\sigma_x u \\\\\n\\frac{\\partial v_y}{\\partial t} = a \\frac{\\partial u}{\\partial y} - \\sigma_y u \\\\\n}\n1\u756a\u76ee\u306e\u5f0f\u3092time-domain\u306b\u66f8\u304d\u63db\u3048\u308b\u305f\u3081\u3001i\u03c9\\frac{i}{\\omega}\u3092\u6642\u9593\u7a4d\u5206\u3068\u8003\u3048\u307e\u3059\u3002\n\u4efb\u610f\u95a2\u6570\u03c8x(t,x,y)\\psi_x(t,x,y)\u3092\u5c0e\u5165\u3057\u307e\u3059\u30021\u756a\u76ee\u306e\u5f0f\u306ei\u03c3x\u03c9i\\frac{\\sigma_x}{\\omega}\u306e\u9805\u3092\u6b21\u306e\u3088\u3046\u306b\u3057\u307e\u3059\u3002\n\\psi_x = \\frac{ib\\sigma_x}{\\omega} \\frac{\\partial v_y}{\\partial y}\u3000\\\\\n-i \\omega \\psi_x = b\\sigma_x \\frac{\\partial v_y}{\\partial y}\u3000\\\\\n\\frac{\\partial \\psi_x}{\\partial t} = b\\sigma_x \\frac{\\partial v_y}{\\partial y}\u3000\\\\\n\u03c8x=ib\u03c3x\u03c9\u2202vy\u2202y\u3000\u2212i\u03c9\u03c8x=b\u03c3x\u2202vy\u2202y\u3000\u2202\u03c8x\u2202t=b\u03c3x\u2202vy\u2202y\u3000{\\psi_x = \\frac{ib\\sigma_x}{\\omega} \\frac{\\partial v_y}{\\partial y}\u3000\\\\\n-i \\omega \\psi_x = b\\sigma_x \\frac{\\partial v_y}{\\partial y}\u3000\\\\\n\\frac{\\partial \\psi_x}{\\partial t} = b\\sigma_x \\frac{\\partial v_y}{\\partial y}\u3000\\\\\n}\n1\u756a\u76ee\u306e\u5f0f\u306ei\u03c3y\u03c9i\\frac{\\sigma_y}{\\omega}\u306e\u9805\u306b\u3064\u3044\u3066\u3082\u95a2\u6570\u03c8y(t,x,y)\\psi_y(t,x,y)\u3092\u5c0e\u5165\u3057\u307e\u3059\u3002\n\\psi_y = \\frac{ib\\sigma_y}{\\omega} \\frac{\\partial v_x}{\\partial x}\u3000\\\\\n-i \\omega \\psi_y = b\\sigma_y \\frac{\\partial v_x}{\\partial x}\u3000\\\\\n\\frac{\\partial \\psi_y}{\\partial t} = b\\sigma_y \\frac{\\partial v_x}{\\partial x}\u3000\\\\\n\u03c8y=ib\u03c3y\u03c9\u2202vx\u2202x\u3000\u2212i\u03c9\u03c8y=b\u03c3y\u2202vx\u2202x\u3000\u2202\u03c8y\u2202t=b\u03c3y\u2202vx\u2202x\u3000{\\psi_y = \\frac{ib\\sigma_y}{\\omega} \\frac{\\partial v_x}{\\partial x}\u3000\\\\\n-i \\omega \\psi_y = b\\sigma_y \\frac{\\partial v_x}{\\partial x}\u3000\\\\\n\\frac{\\partial \\psi_y}{\\partial t} = b\\sigma_y \\frac{\\partial v_x}{\\partial x}\u3000\\\\\n}\n1\u756a\u76ee\u306e\u5f0f\u306ei\u03c3x\u03c3y\u03c9i\\frac{\\sigma_x \\sigma_y}{\\omega}\u306e\u9805\u306b\u3064\u3044\u3066\u3082\u95a2\u6570\u03c8xy(t,x,y)\\psi_{xy}(t,x,y)\u3092\u5c0e\u5165\u3057\u307e\u3059\u3002\n\\psi_{xy} = \\frac{i\\sigma_x \\sigma_y}{\\omega} u\u3000\\\\\n-i \\omega \\psi_{xy} = \\sigma_x \\sigma_y u\u3000\\\\\n\\frac{\\partial \\psi_{xy}}{\\partial t} = \\sigma_x \\sigma_y u\u3000\\\\\n\u03c8xy=i\u03c3x\u03c3y\u03c9u\u3000\u2212i\u03c9\u03c8xy=\u03c3x\u03c3yu\u3000\u2202\u03c8xy\u2202t=\u03c3x\u03c3yu\u3000{\\psi_{xy} = \\frac{i\\sigma_x \\sigma_y}{\\omega} u\u3000\\\\\n-i \\omega \\psi_{xy} = \\sigma_x \\sigma_y u\u3000\\\\\n\\frac{\\partial \\psi_{xy}}{\\partial t} = \\sigma_x \\sigma_y u\u3000\\\\\n}\n\u4ee5\u4e0a\u3092\u307e\u3068\u3081\u308b\u30682\u6b21\u5143\u306etime-domain PML\u306f\u6b21\u306e\u5f0f\u306b\u306a\u308a\u307e\u3059\u3002\n\\frac{\\partial u}{\\partial t} = b \\nabla \\cdot v - (\\sigma_x + \\sigma_y)u + \\psi_x + \\psi_y - \\psi_{xy} \\\\\n\\frac{\\partial v_x}{\\partial t} = a \\frac{\\partial u}{\\partial x} - \\sigma_x v_x \\\\\n\\frac{\\partial v_y}{\\partial t} = a \\frac{\\partial u}{\\partial y} - \\sigma_y v_y \\\\\n\\frac{\\partial \\psi_x}{\\partial t} = b\\sigma_x \\frac{\\partial v_y}{\\partial y}\u3000\\\\\n\\frac{\\partial \\psi_y}{\\partial t} = b\\sigma_y \\frac{\\partial v_x}{\\partial x}\u3000\\\\\n\\frac{\\partial \\psi_{xy}}{\\partial t} = \\sigma_x \\sigma_y u\u3000\\\\\n\u2202u\u2202t=b\u2207\u22c5v\u2212(\u03c3x+\u03c3y)u+\u03c8x+\u03c8y\u2212\u03c8xy\u2202vx\u2202t=a\u2202u\u2202x\u2212\u03c3xvx\u2202vy\u2202t=a\u2202u\u2202y\u2212\u03c3yvy\u2202\u03c8x\u2202t=b\u03c3x\u2202vy\u2202y\u3000\u2202\u03c8y\u2202t=b\u03c3y\u2202vx\u2202x\u3000\u2202\u03c8xy\u2202t=\u03c3x\u03c3yu\u3000{\\frac{\\partial u}{\\partial t} = b \\nabla \\cdot v - (\\sigma_x + \\sigma_y)u + \\psi_x + \\psi_y - \\psi_{xy} \\\\\n\\frac{\\partial v_x}{\\partial t} = a \\frac{\\partial u}{\\partial x} - \\sigma_x v_x \\\\\n\\frac{\\partial v_y}{\\partial t} = a \\frac{\\partial u}{\\partial y} - \\sigma_y v_y \\\\\n\\frac{\\partial \\psi_x}{\\partial t} = b\\sigma_x \\frac{\\partial v_y}{\\partial y}\u3000\\\\\n\\frac{\\partial \\psi_y}{\\partial t} = b\\sigma_y \\frac{\\partial v_x}{\\partial x}\u3000\\\\\n\\frac{\\partial \\psi_{xy}}{\\partial t} = \\sigma_x \\sigma_y u\u3000\\\\\n}\n\n\u5dee\u5206\u5316\u30fb\u96e2\u6563\u5316\n\u5dee\u5206\u5316\n\\frac{1}{\u0394t}(u(t+\u0394t,x,y)-u(t,x,y)) = \\\\ \nb(\\frac{1}{\u0394x}(v_x(t,x,y)-v_x(t,x-\u0394x,y) + \\frac{1}{\u0394y}(v_y(t,x,y)-v_y(t,x,y-\u0394y))) - (\\sigma_x + \\sigma_y) u(t,x,y) + \\psi_x(t,x,y) + \\psi_y(t,x,y) - \\psi_{xy}(t,x,y) \\\\\n\\frac{1}{\u0394t}(v_x(t+\u0394t,x,y)-v_x(t,x,y)) = a(\\frac{1}{\u0394x}(u(t+\u0394t,x+\u0394x,y)-u(t+\u0394t,x,y))) - \\sigma_x v_x(t,x,y) \\\\\n\\frac{1}{\u0394t}(v_y(t+\u0394t,x,y)-v_y(t,x,y)) = a(\\frac{1}{\u0394y}(u(t+\u0394t,x,y+\u0394y)-u(t+\u0394t,x,y))) - \\sigma_y v_x(t,x,y) \\\\\n\\frac{1}{\u0394t}(\\psi_x(t+\u0394t,x,y)-\\psi_x(t,x,y)) = b \\sigma_x(\\frac{1}{\u0394y}(v_y(t+\u0394t,x,y+\u0394y)-v_y(t+\u0394t,x,y))) \\\\\n\\frac{1}{\u0394t}(\\psi_y(t+\u0394t,x,y)-\\psi_y(t,x,y)) = b \\sigma_y(\\frac{1}{\u0394x}(v_x(t+\u0394t,x+\u0394x,y)-v_x(t+\u0394t,x,y))) \\\\\n\\frac{1}{\u0394t}(\\psi_{xy}(t+\u0394t,x,y)-\\psi_{xy}(t,x,y)) = \\sigma_x \\sigma_y u(t,x,y) \\\\\n1\u0394t(u(t+\u0394t,x,y)\u2212u(t,x,y))=b(1\u0394x(vx(t,x,y)\u2212vx(t,x\u2212\u0394x,y)+1\u0394y(vy(t,x,y)\u2212vy(t,x,y\u2212\u0394y)))\u2212(\u03c3x+\u03c3y)u(t,x,y)+\u03c8x(t,x,y)+\u03c8y(t,x,y)\u2212\u03c8xy(t,x,y)1\u0394t(vx(t+\u0394t,x,y)\u2212vx(t,x,y))=a(1\u0394x(u(t+\u0394t,x+\u0394x,y)\u2212u(t+\u0394t,x,y)))\u2212\u03c3xvx(t,x,y)1\u0394t(vy(t+\u0394t,x,y)\u2212vy(t,x,y))=a(1\u0394y(u(t+\u0394t,x,y+\u0394y)\u2212u(t+\u0394t,x,y)))\u2212\u03c3yvx(t,x,y)1\u0394t(\u03c8x(t+\u0394t,x,y)\u2212\u03c8x(t,x,y))=b\u03c3x(1\u0394y(vy(t+\u0394t,x,y+\u0394y)\u2212vy(t+\u0394t,x,y)))1\u0394t(\u03c8y(t+\u0394t,x,y)\u2212\u03c8y(t,x,y))=b\u03c3y(1\u0394x(vx(t+\u0394t,x+\u0394x,y)\u2212vx(t+\u0394t,x,y)))1\u0394t(\u03c8xy(t+\u0394t,x,y)\u2212\u03c8xy(t,x,y))=\u03c3x\u03c3yu(t,x,y){\\frac{1}{\u0394t}(u(t+\u0394t,x,y)-u(t,x,y)) = \\\\ \nb(\\frac{1}{\u0394x}(v_x(t,x,y)-v_x(t,x-\u0394x,y) + \\frac{1}{\u0394y}(v_y(t,x,y)-v_y(t,x,y-\u0394y))) - (\\sigma_x + \\sigma_y) u(t,x,y) + \\psi_x(t,x,y) + \\psi_y(t,x,y) - \\psi_{xy}(t,x,y) \\\\\n\\frac{1}{\u0394t}(v_x(t+\u0394t,x,y)-v_x(t,x,y)) = a(\\frac{1}{\u0394x}(u(t+\u0394t,x+\u0394x,y)-u(t+\u0394t,x,y))) - \\sigma_x v_x(t,x,y) \\\\\n\\frac{1}{\u0394t}(v_y(t+\u0394t,x,y)-v_y(t,x,y)) = a(\\frac{1}{\u0394y}(u(t+\u0394t,x,y+\u0394y)-u(t+\u0394t,x,y))) - \\sigma_y v_x(t,x,y) \\\\\n\\frac{1}{\u0394t}(\\psi_x(t+\u0394t,x,y)-\\psi_x(t,x,y)) = b \\sigma_x(\\frac{1}{\u0394y}(v_y(t+\u0394t,x,y+\u0394y)-v_y(t+\u0394t,x,y))) \\\\\n\\frac{1}{\u0394t}(\\psi_y(t+\u0394t,x,y)-\\psi_y(t,x,y)) = b \\sigma_y(\\frac{1}{\u0394x}(v_x(t+\u0394t,x+\u0394x,y)-v_x(t+\u0394t,x,y))) \\\\\n\\frac{1}{\u0394t}(\\psi_{xy}(t+\u0394t,x,y)-\\psi_{xy}(t,x,y)) = \\sigma_x \\sigma_y u(t,x,y) \\\\\n}\n\u96e2\u6563\u5316\n\u0394t=1,t=0,1,2,...\u0394t=1, t=0,1,2,...\n\u0394x=1,x=0,1,2,...,len\u0394x=1, x=0,1,2,...,len\n\u0394y=1,y=0,1,2,...,len\u0394y=1, y=0,1,2,...,len\n\u3068\u3057\u307e\u3059\u3002\nu(t+1,x,y)-u(t,x,y) = b(v_x(t,x,y)-v_x(t,x-1,y) + v_y(t,x,y)-v_y(t,x,y-1)) - (\\sigma_x + \\sigma_y) u(t,x,y) + \\psi_x(t,x,y) + \\psi_y(t,x,y) - \\psi_{xy}(t,x,y) \\\\\nv_x(t+1,x,y)-v_x(t,x,y) = a(u(t+1,x+1,y)-u(t+1,x,y)) - \\sigma_x v_x(t,x,y) \\\\\nv_y(t+1,x,y)-v_y(t,x,y) = a(u(t+1,x,y+1)-u(t+1,x,y)) - \\sigma_y v_y(t,x,y) \\\\\n\\psi_x(t+1,x,y)-\\psi_x(t,x,y) = b \\sigma_x(v_y(t+1,x,y+1)-v_y(t+1,x,y)) \\\\\n\\psi_y(t+1,x,y)-\\psi_y(t,x,y) = b \\sigma_y(v_x(t+1,x+1,y)-v_x(t+1,x,y)) \\\\\n\\psi_{xy}(t+1,x,y)-\\psi_{xy}(t,x,y) = \\sigma_x \\sigma_y u(t,x,y) \\\\\nu(t+1,x,y)\u2212u(t,x,y)=b(vx(t,x,y)\u2212vx(t,x\u22121,y)+vy(t,x,y)\u2212vy(t,x,y\u22121))\u2212(\u03c3x+\u03c3y)u(t,x,y)+\u03c8x(t,x,y)+\u03c8y(t,x,y)\u2212\u03c8xy(t,x,y)vx(t+1,x,y)\u2212vx(t,x,y)=a(u(t+1,x+1,y)\u2212u(t+1,x,y))\u2212\u03c3xvx(t,x,y)vy(t+1,x,y)\u2212vy(t,x,y)=a(u(t+1,x,y+1)\u2212u(t+1,x,y))\u2212\u03c3yvy(t,x,y)\u03c8x(t+1,x,y)\u2212\u03c8x(t,x,y)=b\u03c3x(vy(t+1,x,y+1)\u2212vy(t+1,x,y))\u03c8y(t+1,x,y)\u2212\u03c8y(t,x,y)=b\u03c3y(vx(t+1,x+1,y)\u2212vx(t+1,x,y))\u03c8xy(t+1,x,y)\u2212\u03c8xy(t,x,y)=\u03c3x\u03c3yu(t,x,y){u(t+1,x,y)-u(t,x,y) = b(v_x(t,x,y)-v_x(t,x-1,y) + v_y(t,x,y)-v_y(t,x,y-1)) - (\\sigma_x + \\sigma_y) u(t,x,y) + \\psi_x(t,x,y) + \\psi_y(t,x,y) - \\psi_{xy}(t,x,y) \\\\\nv_x(t+1,x,y)-v_x(t,x,y) = a(u(t+1,x+1,y)-u(t+1,x,y)) - \\sigma_x v_x(t,x,y) \\\\\nv_y(t+1,x,y)-v_y(t,x,y) = a(u(t+1,x,y+1)-u(t+1,x,y)) - \\sigma_y v_y(t,x,y) \\\\\n\\psi_x(t+1,x,y)-\\psi_x(t,x,y) = b \\sigma_x(v_y(t+1,x,y+1)-v_y(t+1,x,y)) \\\\\n\\psi_y(t+1,x,y)-\\psi_y(t,x,y) = b \\sigma_y(v_x(t+1,x+1,y)-v_x(t+1,x,y)) \\\\\n\\psi_{xy}(t+1,x,y)-\\psi_{xy}(t,x,y) = \\sigma_x \\sigma_y u(t,x,y) \\\\\n}\nt=0\u306e\u3068\u304d\nu(1,x,y) = u(0,x,y) + b(v_x(0,x,y)-v_x(0,x-1,y) + v_y(0,x,y)-v_y(0,x,y-1)) - (\\sigma_x + \\sigma_y) u(0,x,y) + \\psi_x(0,x,y) + \\psi_y(0,x,y) - \\psi_{xy}(0,x,y) \\\\\nv_x(1,x,y) = v_x(0,x,y) + a(u(1,x+1,y)-u(1,x,y)) - \\sigma_x v_x(0,x,y) \\\\\nv_y(1,x,y) = v_y(0,x,y) + a(u(1,x,y+1)-u(1,x,y)) - \\sigma_y v_y(0,x,y) \\\\\n\\psi_x(1,x,y) = \\psi_x(0,x,y) + b \\sigma_x(v_y(1,x,y+1)-v_y(1,x,y)) \\\\\n\\psi_y(1,x,y) = \\psi_y(0,x,y) + b \\sigma_y(v_x(1,x+1,y)-v_x(1,x,y)) \\\\\n\\psi_{xy}(1,x,y) = \\psi_{xy}(0,x,y) + \\sigma_x \\sigma_y u(0,x,y) \\\\\nu(1,x,y)=u(0,x,y)+b(vx(0,x,y)\u2212vx(0,x\u22121,y)+vy(0,x,y)\u2212vy(0,x,y\u22121))\u2212(\u03c3x+\u03c3y)u(0,x,y)+\u03c8x(0,x,y)+\u03c8y(0,x,y)\u2212\u03c8xy(0,x,y)vx(1,x,y)=vx(0,x,y)+a(u(1,x+1,y)\u2212u(1,x,y))\u2212\u03c3xvx(0,x,y)vy(1,x,y)=vy(0,x,y)+a(u(1,x,y+1)\u2212u(1,x,y))\u2212\u03c3yvy(0,x,y)\u03c8x(1,x,y)=\u03c8x(0,x,y)+b\u03c3x(vy(1,x,y+1)\u2212vy(1,x,y))\u03c8y(1,x,y)=\u03c8y(0,x,y)+b\u03c3y(vx(1,x+1,y)\u2212vx(1,x,y))\u03c8xy(1,x,y)=\u03c8xy(0,x,y)+\u03c3x\u03c3yu(0,x,y){u(1,x,y) = u(0,x,y) + b(v_x(0,x,y)-v_x(0,x-1,y) + v_y(0,x,y)-v_y(0,x,y-1)) - (\\sigma_x + \\sigma_y) u(0,x,y) + \\psi_x(0,x,y) + \\psi_y(0,x,y) - \\psi_{xy}(0,x,y) \\\\\nv_x(1,x,y) = v_x(0,x,y) + a(u(1,x+1,y)-u(1,x,y)) - \\sigma_x v_x(0,x,y) \\\\\nv_y(1,x,y) = v_y(0,x,y) + a(u(1,x,y+1)-u(1,x,y)) - \\sigma_y v_y(0,x,y) \\\\\n\\psi_x(1,x,y) = \\psi_x(0,x,y) + b \\sigma_x(v_y(1,x,y+1)-v_y(1,x,y)) \\\\\n\\psi_y(1,x,y) = \\psi_y(0,x,y) + b \\sigma_y(v_x(1,x+1,y)-v_x(1,x,y)) \\\\\n\\psi_{xy}(1,x,y) = \\psi_{xy}(0,x,y) + \\sigma_x \\sigma_y u(0,x,y) \\\\\n}\n\u521d\u671f\u6761\u4ef6\nu(0,x,y),vx(0,x,y),vy(0,x,y),\u03c8x(0,x,y),\u03c8y(0,x,y),\u03c8xy(0,x,y)u(0,x,y),v_x(0,x,y),v_y(0,x,y),\\psi_x(0,x,y),\\psi_y(0,x,y),\\psi_{xy}(0,x,y)\n\u5883\u754c\u6761\u4ef6\nu(t,x,0),u(t,x,len),u(t,0,y),u(t,len,y)u(t,x,0),u(t,x,len),u(t,0,y),u(t,len,y)\n\u6e1b\u8870\u6761\u4ef6\n\u03c3x,\u03c3y\\sigma_x,\\sigma_y\n\nProcessing\u3067\u53ef\u8996\u5316 PML\u72482\u6b21\u5143\u6ce2\u52d5\u65b9\u7a0b\u5f0f\nfloat a = 0.5;\nfloat b = 0.5;\nfloat[][][] u;\nfloat[][][] vx;\nfloat[][][] vy;\nfloat[][][] px; // psi\nfloat[][][] py;\nfloat[][][] pxy;\nfloat[] sx; // sigma\nfloat[] sy;\nPImage img;\nint step = 101;\nint time = 0;\n\nvoid setup() {\n  size(500, 500);\n  init();\n  //noSmooth();\n  frameRate(30);\n}\n\nvoid draw() {\n  for (int i=0; i<step; i++)\n    for (int j=0; j<step; j++)\n      img.pixels[j*step+i] = color(127-u[i][j][1], 100, 100);\n  img.updatePixels();\n  image(img, 0, 0, width, height);\n  for (int i=0; i<1; i++) // speed up\n    updateTime();\n}\n\nvoid init()\n{\n  u   = new float[step][step][2];\n  vx  = new float[step][step][2];\n  vy  = new float[step][step][2];\n  px  = new float[step][step][2];\n  py  = new float[step][step][2];\n  pxy = new float[step][step][2];\n  sx  = new float[step];\n  sy  = new float[step];\n  int llen = 10; // length of layer\n  float gain = 0.5;\n  float inc_step = gain/llen;\n\n  for (int i=step-llen; i<step; i++) {\n      sx[i] = sy[i] = inc_step*(i-(step-llen));\n  }\n  for (int i=0; i<llen; i++) {\n      sx[i] = sy[i] = gain - inc_step*i;\n  }\n\n  img = createImage(step, step, RGB);\n  colorMode(HSB, 255*100/68, 100, 100);\n}\n\nvoid updateTime()\n{\n  u[step/2][step/2][0] = 3000*sin(2.0*PI/25.0*(float)time);\n\n  /* du/dt */\n  for (int i=1; i<step; i++) {\n    for (int j=1; j<step; j++) {\n      u[i][j][1] = u[i][j][0] + b*(vx[i][j][0]-vx[i-1][j][0]+vy[i][j][0]-vy[i][j-1][0])\n        -(sx[i]+sy[j])*u[i][j][0]+px[i][j][0]+py[i][j][0]-pxy[i][j][0];\n    }\n  }\n  /* dvx/dt */\n  for (int i=0; i<step-1; i++) {\n    for (int j=0; j<step; j++) {\n      vx[i][j][1] = vx[i][j][0] + a*(u[i+1][j][1]-u[i][j][1])-sx[i]*vx[i][j][0];\n    }\n  }\n  /* dvy/dt */\n  for (int i=0; i<step; i++) {\n    for (int j=0; j<step-1; j++) {\n      vy[i][j][1] = vy[i][j][0] + a*(u[i][j+1][1]-u[i][j][1])-sy[j]*vy[i][j][0];\n    }\n  }\n  /* dpx/dt */\n  for (int i=0; i<step; i++) {\n    for (int j=1; j<step; j++) {\n      px[i][j][1] = px[i][j][0] + b*sx[i]*(vy[i][j][0]-vy[i][j-1][0]);\n    }\n  }\n  /* dpy/dt */\n  for (int i=1; i<step; i++) {\n    for (int j=0; j<step; j++) {\n     py[i][j][1] = py[i][j][0] + b*sy[j]*(vx[i][j][0]-vx[i-1][j][0]);\n    }\n  }\n  /* dpxy/dt */\n  for (int i=0; i<step; i++) {\n    for (int j=0; j<step; j++) {\n      pxy[i][j][1] = pxy[i][j][0] + sx[i]*sy[j]*u[i][j][0];\n    }\n  }\n\n  for (int i=0; i<step; i++) {\n    for (int j=0; j<step; j++) {\n         u[i][j][0] =   u[i][j][1];\n        vx[i][j][0] =  vx[i][j][1];\n        vy[i][j][0] =  vy[i][j][1];\n        px[i][j][0] =  px[i][j][1];\n        py[i][j][0] =  py[i][j][1];\n       pxy[i][j][0] = pxy[i][j][1];\n    }\n  }\n\n  time++;\n}\n\n\n# \u306f\u3058\u3081\u306b\n\u6ce2\u304c\u5883\u754c\u306b\u9054\u3057\u305f\u3068\u304d\u53cd\u5c04\u3057\u306a\u3044\u3067\u6d88\u3048\u53bb\u3063\u3066\u307b\u3057\u3044\u3053\u3068\u304c\u3042\u308a\u307e\u3059\u3002\n\u3053\u308c\u3092\u5b9f\u73fe\u3059\u308bPerfectly matched layer\u3068\u3044\u3046\u624b\u6cd5\u306b\u3064\u3044\u3066\u8a18\u8f09\u3057\u307e\u3059\u3002\n\n# Perfectly matched layer(PML)\n\u6b21\u306ePaper\u304c\u5206\u304b\u308a\u3084\u3059\u304b\u3063\u305f\u3067\u3059\u3002\u3053\u306e\u5185\u5bb9\u3092\u8a18\u8f09\u3057\u307e\u3059\u3002\n> Notes on Perfectly Matched Layers (PMLs)\n\n## \u6ce2\u52d5\u65b9\u7a0b\u5f0f\n$u(t,x,y,z)$\u306f\u6ce2\u3092\u8868\u3057\u307e\u3059\u3002\n$\\nabla = (\\frac{\\partial}{\\partial x}, \\frac{\\partial}{\\partial y}, \\frac{\\partial}{\\partial z})$\u3067\u3059\u3002\"$\\cdot$\"\u306f\u5185\u7a4d\u3067\u3059\u3002\n\u4ee5\u4e0b\u304c\u6ce2\u52d5\u65b9\u7a0b\u5f0f\u3067\u3059\u3002\u5c11\u3057\u4e0d\u81ea\u7136\u306a\u5f62\u5f0f\u306b\u898b\u3048\u307e\u3059\u304c2\u3064\u306e\u65b9\u7a0b\u5f0f\u306b\u5206\u3051\u308b\u4fbf\u5b9c\u4e0a\u3053\u306e\u3088\u3046\u306b\u3057\u307e\u3059\u3002\n\n```math\n\\nabla \\cdot (a \\nabla u) = \\frac{1}{b} \\frac{\\partial^2 u}{\\partial t^2}\n```\n\n\u5fae\u5206\u306e\u968e\u6570\u3092\u6e1b\u3089\u3059(2\u968e\u21921\u968e)\u305f\u3081\u306b2\u3064\u306e\u65b9\u7a0b\u5f0f\u306b\u5206\u89e3\u3057\u307e\u3059\u3002\n$\\vec{v}(t,x,y,z)$\u3067\u3059\u3002\n\n```math\n\\frac{\\partial u}{\\partial t} = b \\nabla \\cdot \\vec{v} \\\\\n\\frac{\\partial \\vec{v}}{\\partial t} = a \\nabla u\n```\n\n\u4e0a\u8a18\u65b9\u7a0b\u5f0f\u3092\u307e\u3068\u3081\u307e\u3059\u3002\u5358\u306a\u308b\u66f8\u304d\u63db\u3048\u3067\u3059\u3002\n$\\vec{w}$\u306f$u$\u3068$\\vec{v}$\u3092\u4e26\u3079\u305f\u30d9\u30af\u30c8\u30eb\u3067\u3059\u3002$\\hat{D}$\u306f4x4\u306e\u6f14\u7b97\u5b50\u3067\u3059\u3002\n\n```math\n\\frac{\\partial \\vec{w}}{\\partial t} = \n\\frac{\\partial}{\\partial t}\n\\left(\n    \\begin{array}{r}\n      u \\\\\n      \\vec{v} \\\\\n    \\end{array}\n\\right) = \n\\left(\n    \\begin{array}{rr}\n       & b\\nabla \\cdot \\\\\n      a\\nabla & \\\\\n    \\end{array}\n\\right)\n\\left(\n    \\begin{array}{r}\n      u \\\\\n      \\vec{v} \\\\\n    \\end{array}\n\\right) =\n\\hat{D} \\vec{w} \\\\\n\n\\hat{D} = \n\\left(\n    \\begin{array}{rr}\n       & b\\nabla \\cdot \\\\\n      a\\nabla & \\\\\n    \\end{array}\n\\right)\n```\n\n\u6b21\u306e\u4eee\u5b9a\u3092\u7f6e\u304d\u307e\u3059\u3002\u539f\u6587\u629c\u7c8b\n> - We will assume that the space far from the region of interest is homogeneous.\n> - We will assume that the space far from the region of interest is linear and time-invariant.\n\n\u4e0a\u8a18\u4eee\u5b9a\u306e\u3082\u3068\u3067$\\vec{w}(\\vec{x},t)$\u306f\u6b21\u306e\u3088\u3046\u306a\u89e3\u306b\u306a\u308b\u3068\u306e\u3053\u3068\u3002plane wave\u306e\u91cd\u306d\u5408\u308f\u305b\u8868\u73fe\u306b\u306a\u3063\u3066\u3044\u307e\u3059\u3002\n$\\omega$\u306f\u89d2\u5468\u6ce2\u6570,$\\vec{k}$\u306f\u6ce2\u6570\u30d9\u30af\u30c8\u30eb\u3067\u3059\u3002$\\vec{W}$\u306f\u632f\u5e45\u3067\u3059\u3002\n\n```math\n\\vec{w}(\\vec{x},t) = \\sum_{\\vec{k},\\omega}{\\vec{W}_{\\vec{k},\\omega}exp(i(\\vec{k} \\cdot \\vec{x} - \\omega t))}\n```\n\n\u4e0a\u8a18\u4f8b\u3068\u3057\u3066\u4ee5\u4e0b\u304c\u793a\u3055\u308c\u3066\u3044\u307e\u3059\u3002\u5f0f(A)\u3068\u3057\u307e\u3059\u3002\n\n```math\n\\vec{W}(y,z) exp(i(kx - \\omega t))\n```\n\n## \u89e3\u6790\u63a5\u7d9a\n\u5f0f(A)\u306fx\u306b\u3064\u3044\u3066\u89e3\u6790\u95a2\u6570\u3067\u3059\u3002\u3057\u305f\u304c\u3063\u3066\u89e3\u6790\u63a5\u7d9a\u3067\u304d\u307e\u3059\u3002\n\u3053\u306e\u3053\u3068\u306f\u5fae\u5206\u65b9\u7a0b\u5f0f\u3092\u6e80\u305f\u3057\u306a\u304c\u3089\u5909\u6570\u304c\u52d5\u304f\u7d4c\u8def\u3092\u5909\u3048\u3089\u308c\u308b\u3053\u3068\u3092\u610f\u5473\u3057\u3066\u3044\u307e\u3059\u3002\n\u307e\u305f\u3001exp()\u3067\u3042\u308b\u3053\u3068\u304b\u3089\u632f\u5e45\u3092\u6307\u6570\u95a2\u6570\u7684\u306b\u6e1b\u8870\u3055\u305b\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\u3053\u308c\u304c\u53cd\u5c04\u3092\u6291\u3048\u3066\u6ce2\u3092\u6025\u6fc0\u306b\u6e1b\u8870\u3055\u305b\u3089\u308c\u308b\u7406\u7531\u306b\u306a\u308a\u307e\u3059\u3002\n\n\u5206\u304b\u308a\u3084\u3059\u3044\u56f3\u304c\u8a18\u8f09\u3055\u308c\u3066\u3044\u307e\u3057\u305f\u306e\u3067\u629c\u7c8b\u3057\u307e\u3059\u3002\n$exp(ikx)$\u306e\u30b0\u30e9\u30d5\u3067\u3059\u3002\u632f\u5e451, \u6642\u9593\u9805\u306f\u7701\u7565\u3055\u308c\u3066\u3044\u307e\u3059\u3002\n![1.JPG](https://qiita-image-store.s3.amazonaws.com/0/84205/51a67530-e1d0-4950-8002-5cf32f832745.jpeg)\n\n\u4e0a\u5074\u306fx\u304c\u5b9f\u6570\u6210\u5206\u306e\u307f\u306e\u5834\u5408\u3067\u3059\u3002\u6e1b\u8870\u306f\u307f\u3089\u308c\u307e\u305b\u3093\u3002\n\u4e0b\u5074\u306fx\u306e\u865a\u6570\u6210\u5206\u3092\u5c11\u3057\u305a\u3064\u5897\u3084\u3057\u305f\u5834\u5408\u3067\u3059\u3002\u6ce2\u5f62\u304c\u6e1b\u8870\u3057\u3066\u3044\u308b\u3053\u3068\u304c\u5206\u304b\u308a\u307e\u3059\u3002\n\u3053\u306e\u3088\u3046\u306b\u3057\u3066\u865a\u6570\u6210\u5206\u3092\u5897\u3084\u3059\u3053\u3068\u3067\u6ce2\u5f62\u3092\u6e1b\u8870\u3055\u305b\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n## \u8907\u7d20\u6570\u3078\u306e\u5909\u63db\n$\\tilde{x} = x + if(x)$\u3068\u3057\u307e\u3059\u3002\n$\\partial \\tilde{x} = (1 + i \\frac{df}{dx})\\partial x$\u306b\u306a\u308a\u307e\u3059\u3002$\\frac{df}{dx}=\\frac{\\sigma_x(x)}{\\omega}$\u3068\u304a\u304d\u307e\u3059\u3002\n$\\sigma_x(x)$\u306f\u865a\u6570\u90e8\u3092\u5897\u52a0\u3055\u305b\u308b\u95a2\u6570\u3067\u3059\u3002\n\n\u5fae\u5206\u6f14\u7b97\u5b50\u3092\u6b21\u306e\u3088\u3046\u306b\u7f6e\u304d\u63db\u3048\u308b\u3053\u3068\u3067PML\u306b\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\u5909\u63db(B)\u3068\u3057\u307e\u3059\u3002\n\n```math\n\\frac{\\partial}{\\partial x} \\to \\frac{1}{1+i\\frac{\\sigma_x(x)}{\\omega}} \\frac{\\partial}{\\partial x}\n```\n\n# 1\u6b21\u5143PML\n$u(t,x),v(t,x)$\u306b\u3064\u3044\u3066\u6b21\u306e\u5f0f\u304c1\u6b21\u5143\u6ce2\u52d5\u65b9\u7a0b\u5f0f\u3067\u3059\u3002\u5f0f(C)\u3068\u3057\u307e\u3059\u3002\n$u$\u3068$v$\u306e\u6642\u9593\u4f9d\u5b58\u306e\u90e8\u5206\u306f$exp(-i\\omega t)$\u3068\u3057\u307e\u3059\u3002\n\n```math\n\\frac{\\partial u}{\\partial t} = b \\frac{\\partial v}{\\partial x} = -i\\omega u \\\\\n\\frac{\\partial v}{\\partial t} = a \\frac{\\partial u}{\\partial x} = -i\\omega v \\\\\n```\n\n\u4e0a\u8a18\u5f0f\u306b\u5909\u63db(B)\u3092\u884c\u3044\u307e\u3059\u3002\n\n```math\nb \\frac{\\partial v}{\\partial x} = -i\\omega u + \\sigma_x u \\\\\na \\frac{\\partial u}{\\partial x} = -i\\omega v + \\sigma_x v \\\\\n```\n\n\u4e0a\u8a18\u5f0f\u3068\u5f0f(C)\u304b\u3089$-i\\omega u$\u3068$-i\\omega v$\u3092\u6d88\u53bb\u3057\u307e\u3059\u3002$-i \\omega$\u304c$\\frac{\\partial}{\\partial t}$\u306b\u306a\u308b\u3068\u8003\u3048\u3066\u3082\u3088\u3044\u3067\u3059\u3002\n\u3053\u308c\u304ctime-domain\u306e1\u6b21\u5143PML\u3067\u3059\u3002\n\n```math\n\\frac{\\partial u}{\\partial t} = b \\frac{\\partial v}{\\partial x} - \\sigma_x u \\\\\n\\frac{\\partial v}{\\partial t} = a \\frac{\\partial u}{\\partial x} - \\sigma_x v \\\\\n```\n\n## \u5dee\u5206\u5316\u30fb\u96e2\u6563\u5316\n\u5dee\u5206\u5316\n\n```math\n\\frac{1}{\u0394t}(u(t+\u0394t,x)-u(t,x)) = b \\frac{1}{\u0394x}(v(t, x)-v(t, x-\u0394x)) - \u03c3_x u(t, x) \\\\\n\\frac{1}{\u0394t}(v(t+\u0394t,x)-v(t,x)) = a \\frac{1}{\u0394x}(u(t+\u0394t, x+\u0394x)-u(t+\u0394t, x)) - \u03c3_x v(t, x) \\\\\n```\n\n(*)\n2\u756a\u76ee\u306e\u5f0f\u306e$u(t+\u0394t,x+\u0394x),u(t+\u0394t,x)$\u306e\u9805\u3067\u6642\u9593\u30fb\u7a7a\u9593\u5dee\u5206\u30921\u756a\u76ee\u306e\u5f0f\u306b\u5bfe\u3057\u30661\u3064\u305a\u3089\u3057\u3066\u3044\u307e\u3059\u3002\n\u30b7\u30df\u30e5\u30ec\u30fc\u30b7\u30e7\u30f3\u7d50\u679c\u304c\u4e0d\u5b89\u5b9a\u306b\u306a\u3063\u305f\u305f\u3081\u3053\u306e\u3088\u3046\u306b\u3057\u307e\u3057\u305f\u3002\n\n\u96e2\u6563\u5316\n$\u0394t=1, t=0,1,2,...$\n$\u0394x=1, x=0,1,2,...,len$\n\u3068\u3057\u307e\u3059\u3002\n\n```math\nu(t+1,x) = u(t,x) + b(v(t,x)-v(t,x-1)) - \u03c3_x u(t,x) \\\\\nv(t+1,x) = v(t,x) + a(u(t+1,x+1)-u(t+1,x)) - \u03c3_x v(t,x) \\\\\n```\n\nt=0\u306e\u3068\u304d\n\n```math\nu(1,x) = u(0,x) + b(v(0,x)-v(0,x-1)) - \u03c3_x u(0,x) \\\\\nv(1,x) = v(0,x) + a(u(1,x+1)-u(1,x)) - \u03c3_x v(0,x) \\\\\n```\n\n\u521d\u671f\u6761\u4ef6\n$u(0,x),v(0,x)$\n\n\u5883\u754c\u6761\u4ef6\n$u(t,0),u(t,len)$\n\n\u6e1b\u8870\u6761\u4ef6\n$\u03c3_x(x)$\n\n# Processing\u3067\u53ef\u8996\u5316 PML\u72481\u6b21\u5143\u6ce2\u52d5\u65b9\u7a0b\u5f0f\nu1,v1\u306f\u73fe\u5728\u306e\u5206\u5e03\u3001u0,v0\u306f1\u6642\u523b\u524d\u306e\u5206\u5e03\u3067\u3059\u3002\n\u5de6\u7aef\u306eu0\u3092sin\u95a2\u6570\u3067\u632f\u3063\u3066\u3044\u307e\u3059\u3002\nu1,v1\u306e\u53f3\u7aef\u6570\u70b9\u306f0\u56fa\u5b9a\u306b\u3057\u3066\u3044\u307e\u3059\u3002float\u7bc4\u56f2\u3067\u53ce\u675f\u3057\u304d\u308c\u306a\u3044\u5024\u304c\u53cd\u5c04\u3059\u308b\u306e\u3092\u5f37\u5236\u7684\u306b\u6291\u3048\u3066\u3044\u307e\u3059\u3002\n\u53f3\u5074\u534a\u5206\u304c\u6e1b\u8870\u9818\u57df\u306b\u306a\u308a\u307e\u3059\u3002\n\n```java\nfloat a = 0.7;\nfloat b = 0.7;\nfloat[] u0;\nfloat[] v0;\nfloat[] u1;\nfloat[] v1;\nfloat[] s; // sigma\nint step = 100;\nfloat w = 0;\nint time = 0;\n\nvoid setup() {\n  size(600, 300);\n  init();\n  //noSmooth();\n  frameRate(20);\n  background(0);\n  fill(0, 0, 0, 0);\n  stroke(255, 255, 255);\n}\n\nvoid draw() {\n  background(0);\n  for (int i=0; i<step; i++) {\n    float x1,x2,y1,y2;\n    x1 = w*i;\n    y1 = height/2+u1[i];\n    ellipse(x1, y1, 2, 2);\n    if (i < step-1) {\n      y2 = height/2+u1[i+1];\n      x2 = w*(i+1);\n      line(x1, y1, x2, y2);\n    }\n  }\n  for (int i=0; i<1; i++) // speed up\n    updateTime();\n}\n\nvoid init()\n{\n  w = width/(step-1);\n  u0 = new float[step];\n  v0 = new float[step];\n  u1 = new float[step];\n  v1 = new float[step];\n  s = new float[step];\n  int llen = step/2; // length of layer\n  float inc_step = 0.5/llen;\n  for (int i=step-llen; i<step; i++) {\n    s[i] = inc_step*(i-(step-llen));\n  }\n}\n\nvoid updateTime()\n{\n  int force_zero_len = 5;\n  u1[0] = 100*sin(2*PI/20*time);\n\n  for (int i=1; i<step-1; i++) {\n    u1[i]  = u0[i] + b*(v0[i] - v0[i-1]) - s[i]*u0[i];\n  }\n  for (int i=0; i<step-1; i++) {\n    v1[i]  = v0[i] + a*(u1[i+1] - u1[i]) - s[i]*v0[i];\n  }\n  for (int i=0; i<step-force_zero_len; i++) {\n    u0[i] = u1[i];\n    v0[i] = v1[i];\n  }\n\n  time++;\n}\n```\n\n[![IMAGE ALT TEXT HERE](http://img.youtube.com/vi/_3azQAcA8zA/0.jpg)](http://www.youtube.com/watch?v=_3azQAcA8zA)\n\n# 2\u6b21\u5143PML\n$u(t,x,y),v_x(t,x,y),v_y(t,x,y)$\u306b\u3064\u3044\u3066\u6b21\u306e\u5f0f\u304c2\u6b21\u5143\u6ce2\u52d5\u65b9\u7a0b\u5f0f\u3067\u3059\u3002\n$u$\u3068$v_x,v_y$\u306e\u6642\u9593\u4f9d\u5b58\u306e\u90e8\u5206\u306f$exp(\u2212i\u03c9t)$\u3068\u3057\u307e\u3059\u3002\n\n```math\n\\frac{\\partial u}{\\partial t} = b \\nabla \\cdot v = b \\frac{\\partial v_x}{\\partial  x} + b \\frac{\\partial v_y}{\\partial  y} = -i \\omega u \\\\\n\\frac{\\partial v_x}{\\partial t} = a \\frac{\\partial u}{\\partial x} = -i \\omega v_x \\\\\n\\frac{\\partial v_y}{\\partial t} = a \\frac{\\partial u}{\\partial y} = -i \\omega v_y \\\\\n```\n\n\u4e0a\u8a18\u5f0f\u306b\u5909\u63db(B)\u3092\u884c\u3044\u307e\u3059\u3002y\u65b9\u5411\u306b\u3082\u5909\u63db\u3057\u307e\u3059\u3002\n$\\partial x \\to (1+i \\frac{\\sigma_x}{\\omega})\\partial x$\n$\\partial y \\to (1+i \\frac{\\sigma_y}{\\omega})\\partial y$\n\n```math\nb \\frac{\\partial v_x}{\\partial  x}(1+i\\frac{\\sigma_y}{\\omega}) + b \\frac{\\partial v_y}{\\partial  y}(1+i\\frac{\\sigma_x}{\\omega}) =\n -i \\omega u + (\\sigma_x + \\sigma_y) u + i\\frac{\\sigma_x \\sigma_y}{\\omega} u\\\\\na \\frac{\\partial u}{\\partial x} = -i \\omega v_x + \\sigma_x v_x\\\\\na \\frac{\\partial u}{\\partial y} = -i \\omega v_y + \\sigma_y v_y\\\\\n```\n\n2,3\u756a\u76ee\u306e\u5f0f\u3092$-i\\omega$\u3092$\\frac{\\partial}{\\partial t}$\u306b\u7f6e\u304d\u63db\u3048\u307e\u3059\u3002\n\n```math\n\\frac{\\partial v_x}{\\partial t} = a \\frac{\\partial u}{\\partial x} - \\sigma_x u \\\\\n\\frac{\\partial v_y}{\\partial t} = a \\frac{\\partial u}{\\partial y} - \\sigma_y u \\\\\n```\n\n1\u756a\u76ee\u306e\u5f0f\u3092time-domain\u306b\u66f8\u304d\u63db\u3048\u308b\u305f\u3081\u3001$\\frac{i}{\\omega}$\u3092\u6642\u9593\u7a4d\u5206\u3068\u8003\u3048\u307e\u3059\u3002\n\u4efb\u610f\u95a2\u6570$\\psi_x(t,x,y)$\u3092\u5c0e\u5165\u3057\u307e\u3059\u30021\u756a\u76ee\u306e\u5f0f\u306e$i\\frac{\\sigma_x}{\\omega}$\u306e\u9805\u3092\u6b21\u306e\u3088\u3046\u306b\u3057\u307e\u3059\u3002\n\n```math\n\\psi_x = \\frac{ib\\sigma_x}{\\omega} \\frac{\\partial v_y}{\\partial y}\u3000\\\\\n-i \\omega \\psi_x = b\\sigma_x \\frac{\\partial v_y}{\\partial y}\u3000\\\\\n\\frac{\\partial \\psi_x}{\\partial t} = b\\sigma_x \\frac{\\partial v_y}{\\partial y}\u3000\\\\\n```\n\n1\u756a\u76ee\u306e\u5f0f\u306e$i\\frac{\\sigma_y}{\\omega}$\u306e\u9805\u306b\u3064\u3044\u3066\u3082\u95a2\u6570$\\psi_y(t,x,y)$\u3092\u5c0e\u5165\u3057\u307e\u3059\u3002\n\n```math\n\\psi_y = \\frac{ib\\sigma_y}{\\omega} \\frac{\\partial v_x}{\\partial x}\u3000\\\\\n-i \\omega \\psi_y = b\\sigma_y \\frac{\\partial v_x}{\\partial x}\u3000\\\\\n\\frac{\\partial \\psi_y}{\\partial t} = b\\sigma_y \\frac{\\partial v_x}{\\partial x}\u3000\\\\\n```\n\n1\u756a\u76ee\u306e\u5f0f\u306e$i\\frac{\\sigma_x \\sigma_y}{\\omega}$\u306e\u9805\u306b\u3064\u3044\u3066\u3082\u95a2\u6570$\\psi_{xy}(t,x,y)$\u3092\u5c0e\u5165\u3057\u307e\u3059\u3002\n\n```math\n\\psi_{xy} = \\frac{i\\sigma_x \\sigma_y}{\\omega} u\u3000\\\\\n-i \\omega \\psi_{xy} = \\sigma_x \\sigma_y u\u3000\\\\\n\\frac{\\partial \\psi_{xy}}{\\partial t} = \\sigma_x \\sigma_y u\u3000\\\\\n```\n\n\u4ee5\u4e0a\u3092\u307e\u3068\u3081\u308b\u30682\u6b21\u5143\u306etime-domain PML\u306f\u6b21\u306e\u5f0f\u306b\u306a\u308a\u307e\u3059\u3002\n\n```math\n\\frac{\\partial u}{\\partial t} = b \\nabla \\cdot v - (\\sigma_x + \\sigma_y)u + \\psi_x + \\psi_y - \\psi_{xy} \\\\\n\\frac{\\partial v_x}{\\partial t} = a \\frac{\\partial u}{\\partial x} - \\sigma_x v_x \\\\\n\\frac{\\partial v_y}{\\partial t} = a \\frac{\\partial u}{\\partial y} - \\sigma_y v_y \\\\\n\\frac{\\partial \\psi_x}{\\partial t} = b\\sigma_x \\frac{\\partial v_y}{\\partial y}\u3000\\\\\n\\frac{\\partial \\psi_y}{\\partial t} = b\\sigma_y \\frac{\\partial v_x}{\\partial x}\u3000\\\\\n\\frac{\\partial \\psi_{xy}}{\\partial t} = \\sigma_x \\sigma_y u\u3000\\\\\n```\n\n## \u5dee\u5206\u5316\u30fb\u96e2\u6563\u5316\n\u5dee\u5206\u5316\n\n```math\n\\frac{1}{\u0394t}(u(t+\u0394t,x,y)-u(t,x,y)) = \\\\ \nb(\\frac{1}{\u0394x}(v_x(t,x,y)-v_x(t,x-\u0394x,y) + \\frac{1}{\u0394y}(v_y(t,x,y)-v_y(t,x,y-\u0394y))) - (\\sigma_x + \\sigma_y) u(t,x,y) + \\psi_x(t,x,y) + \\psi_y(t,x,y) - \\psi_{xy}(t,x,y) \\\\\n\\frac{1}{\u0394t}(v_x(t+\u0394t,x,y)-v_x(t,x,y)) = a(\\frac{1}{\u0394x}(u(t+\u0394t,x+\u0394x,y)-u(t+\u0394t,x,y))) - \\sigma_x v_x(t,x,y) \\\\\n\\frac{1}{\u0394t}(v_y(t+\u0394t,x,y)-v_y(t,x,y)) = a(\\frac{1}{\u0394y}(u(t+\u0394t,x,y+\u0394y)-u(t+\u0394t,x,y))) - \\sigma_y v_x(t,x,y) \\\\\n\\frac{1}{\u0394t}(\\psi_x(t+\u0394t,x,y)-\\psi_x(t,x,y)) = b \\sigma_x(\\frac{1}{\u0394y}(v_y(t+\u0394t,x,y+\u0394y)-v_y(t+\u0394t,x,y))) \\\\\n\\frac{1}{\u0394t}(\\psi_y(t+\u0394t,x,y)-\\psi_y(t,x,y)) = b \\sigma_y(\\frac{1}{\u0394x}(v_x(t+\u0394t,x+\u0394x,y)-v_x(t+\u0394t,x,y))) \\\\\n\\frac{1}{\u0394t}(\\psi_{xy}(t+\u0394t,x,y)-\\psi_{xy}(t,x,y)) = \\sigma_x \\sigma_y u(t,x,y) \\\\\n```\n\n\u96e2\u6563\u5316\n$\u0394t=1, t=0,1,2,...$\n$\u0394x=1, x=0,1,2,...,len$\n$\u0394y=1, y=0,1,2,...,len$\n\u3068\u3057\u307e\u3059\u3002\n\n```math\nu(t+1,x,y)-u(t,x,y) = b(v_x(t,x,y)-v_x(t,x-1,y) + v_y(t,x,y)-v_y(t,x,y-1)) - (\\sigma_x + \\sigma_y) u(t,x,y) + \\psi_x(t,x,y) + \\psi_y(t,x,y) - \\psi_{xy}(t,x,y) \\\\\nv_x(t+1,x,y)-v_x(t,x,y) = a(u(t+1,x+1,y)-u(t+1,x,y)) - \\sigma_x v_x(t,x,y) \\\\\nv_y(t+1,x,y)-v_y(t,x,y) = a(u(t+1,x,y+1)-u(t+1,x,y)) - \\sigma_y v_y(t,x,y) \\\\\n\\psi_x(t+1,x,y)-\\psi_x(t,x,y) = b \\sigma_x(v_y(t+1,x,y+1)-v_y(t+1,x,y)) \\\\\n\\psi_y(t+1,x,y)-\\psi_y(t,x,y) = b \\sigma_y(v_x(t+1,x+1,y)-v_x(t+1,x,y)) \\\\\n\\psi_{xy}(t+1,x,y)-\\psi_{xy}(t,x,y) = \\sigma_x \\sigma_y u(t,x,y) \\\\\n```\n\nt=0\u306e\u3068\u304d\n\n```math\nu(1,x,y) = u(0,x,y) + b(v_x(0,x,y)-v_x(0,x-1,y) + v_y(0,x,y)-v_y(0,x,y-1)) - (\\sigma_x + \\sigma_y) u(0,x,y) + \\psi_x(0,x,y) + \\psi_y(0,x,y) - \\psi_{xy}(0,x,y) \\\\\nv_x(1,x,y) = v_x(0,x,y) + a(u(1,x+1,y)-u(1,x,y)) - \\sigma_x v_x(0,x,y) \\\\\nv_y(1,x,y) = v_y(0,x,y) + a(u(1,x,y+1)-u(1,x,y)) - \\sigma_y v_y(0,x,y) \\\\\n\\psi_x(1,x,y) = \\psi_x(0,x,y) + b \\sigma_x(v_y(1,x,y+1)-v_y(1,x,y)) \\\\\n\\psi_y(1,x,y) = \\psi_y(0,x,y) + b \\sigma_y(v_x(1,x+1,y)-v_x(1,x,y)) \\\\\n\\psi_{xy}(1,x,y) = \\psi_{xy}(0,x,y) + \\sigma_x \\sigma_y u(0,x,y) \\\\\n```\n\n\u521d\u671f\u6761\u4ef6\n$u(0,x,y),v_x(0,x,y),v_y(0,x,y),\\psi_x(0,x,y),\\psi_y(0,x,y),\\psi_{xy}(0,x,y)$\n\n\u5883\u754c\u6761\u4ef6\n$u(t,x,0),u(t,x,len),u(t,0,y),u(t,len,y)$\n\n\u6e1b\u8870\u6761\u4ef6\n$\\sigma_x,\\sigma_y$\n\n# Processing\u3067\u53ef\u8996\u5316 PML\u72482\u6b21\u5143\u6ce2\u52d5\u65b9\u7a0b\u5f0f\n\n```java\nfloat a = 0.5;\nfloat b = 0.5;\nfloat[][][] u;\nfloat[][][] vx;\nfloat[][][] vy;\nfloat[][][] px; // psi\nfloat[][][] py;\nfloat[][][] pxy;\nfloat[] sx; // sigma\nfloat[] sy;\nPImage img;\nint step = 101;\nint time = 0;\n\nvoid setup() {\n  size(500, 500);\n  init();\n  //noSmooth();\n  frameRate(30);\n}\n\nvoid draw() {\n  for (int i=0; i<step; i++)\n    for (int j=0; j<step; j++)\n      img.pixels[j*step+i] = color(127-u[i][j][1], 100, 100);\n  img.updatePixels();\n  image(img, 0, 0, width, height);\n  for (int i=0; i<1; i++) // speed up\n    updateTime();\n}\n\nvoid init()\n{\n  u   = new float[step][step][2];\n  vx  = new float[step][step][2];\n  vy  = new float[step][step][2];\n  px  = new float[step][step][2];\n  py  = new float[step][step][2];\n  pxy = new float[step][step][2];\n  sx  = new float[step];\n  sy  = new float[step];\n  int llen = 10; // length of layer\n  float gain = 0.5;\n  float inc_step = gain/llen;\n  \n  for (int i=step-llen; i<step; i++) {\n      sx[i] = sy[i] = inc_step*(i-(step-llen));\n  }\n  for (int i=0; i<llen; i++) {\n      sx[i] = sy[i] = gain - inc_step*i;\n  }\n  \n  img = createImage(step, step, RGB);\n  colorMode(HSB, 255*100/68, 100, 100);\n}\n\nvoid updateTime()\n{\n  u[step/2][step/2][0] = 3000*sin(2.0*PI/25.0*(float)time);\n  \n  /* du/dt */\n  for (int i=1; i<step; i++) {\n    for (int j=1; j<step; j++) {\n      u[i][j][1] = u[i][j][0] + b*(vx[i][j][0]-vx[i-1][j][0]+vy[i][j][0]-vy[i][j-1][0])\n        -(sx[i]+sy[j])*u[i][j][0]+px[i][j][0]+py[i][j][0]-pxy[i][j][0];\n    }\n  }\n  /* dvx/dt */\n  for (int i=0; i<step-1; i++) {\n    for (int j=0; j<step; j++) {\n      vx[i][j][1] = vx[i][j][0] + a*(u[i+1][j][1]-u[i][j][1])-sx[i]*vx[i][j][0];\n    }\n  }\n  /* dvy/dt */\n  for (int i=0; i<step; i++) {\n    for (int j=0; j<step-1; j++) {\n      vy[i][j][1] = vy[i][j][0] + a*(u[i][j+1][1]-u[i][j][1])-sy[j]*vy[i][j][0];\n    }\n  }\n  /* dpx/dt */\n  for (int i=0; i<step; i++) {\n    for (int j=1; j<step; j++) {\n      px[i][j][1] = px[i][j][0] + b*sx[i]*(vy[i][j][0]-vy[i][j-1][0]);\n    }\n  }\n  /* dpy/dt */\n  for (int i=1; i<step; i++) {\n    for (int j=0; j<step; j++) {\n     py[i][j][1] = py[i][j][0] + b*sy[j]*(vx[i][j][0]-vx[i-1][j][0]);\n    }\n  }\n  /* dpxy/dt */\n  for (int i=0; i<step; i++) {\n    for (int j=0; j<step; j++) {\n      pxy[i][j][1] = pxy[i][j][0] + sx[i]*sy[j]*u[i][j][0];\n    }\n  }\n  \n  for (int i=0; i<step; i++) {\n    for (int j=0; j<step; j++) {\n         u[i][j][0] =   u[i][j][1];\n        vx[i][j][0] =  vx[i][j][1];\n        vy[i][j][0] =  vy[i][j][1];\n        px[i][j][0] =  px[i][j][1];\n        py[i][j][0] =  py[i][j][1];\n       pxy[i][j][0] = pxy[i][j][1];\n    }\n  }\n      \n  time++;\n}\n```\n\n[![IMAGE ALT TEXT HERE](http://img.youtube.com/vi/UhkzVgv7HnM/0.jpg)](http://www.youtube.com/watch?v=UhkzVgv7HnM)\n"}