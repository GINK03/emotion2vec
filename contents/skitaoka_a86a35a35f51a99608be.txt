{"tags": ["\u5f37\u5316\u5b66\u7fd2", "\u6a5f\u68b0\u5b66\u7fd2"], "context": "\u65b9\u7b56\u52fe\u914d\u6cd5 (policy gradient algorithm) \u306f\u5f37\u5316\u5b66\u7fd2\u306e\u624b\u6cd5\u3067\u3042\u308b\u3002\n\u6642\u523b tt \u306e\u72b6\u614b xtx_{t} \u3067\u884c\u52d5 ata_{t} \u3092\u9078\u629e\u3059\u308b\u78ba\u7387\u3092\n\\pi(a_{t} \\mid x_{t} ; \\Theta) = \\frac{1}{Z_{x_{t}}} e^{\\frac{1}{T} E(a_{t}, x_{t} ; \\Theta)}\n\u03c0(at\u2223xt;\u0398)=1Zxte1TE(at,xt;\u0398){\\pi(a_{t} \\mid x_{t} ; \\Theta) = \\frac{1}{Z_{x_{t}}} e^{\\frac{1}{T} E(a_{t}, x_{t} ; \\Theta)}\n}\n\u3067\u5b9a\u7fa9\u3059\u308b\u3002\u3053\u3053\u3067\u3001\u0398\\Theta \u306f\u5b66\u7fd2\u30d1\u30e9\u30e1\u30fc\u30bf\u3001TT \u306f\u5b66\u7fd2\u3092\u30b3\u30f3\u30c8\u30ed\u30fc\u30eb\u3059\u308b\u305f\u3081\u306e\u6e29\u5ea6\u30d1\u30e9\u30e1\u30fc\u30bf\u3001Zxt=\u2211a\u2032\u2208Axte1TE(a\u2032,xt;\u0398)Z_{x_{t}} = \\sum_{a' \\in A_{x_{t}}} e^{\\frac{1}{T} E(a', x_{t} ; \\Theta)} \u306f\u884c\u52d5\u5206\u5e03\u306e\u6b63\u898f\u5316\u5b9a\u6570\u3001AxtA_{x_{t}} \u306f\u72b6\u614b xtx_{t} \u3067\u3067\u304d\u308b\u884c\u52d5\u306e\u96c6\u5408\u3067\u3042\u308b\u3002\n1 \u56de\u306e\u30a8\u30d4\u30bd\u30fc\u30c9\u3067\u5f97\u3089\u308c\u305f\u5831\u916c\u3092 rr \u3068\u3057\u3066\u3001\u305d\u306e\u671f\u5f85\u5831\u916c\u3092\u6700\u5927\u5316\u3059\u308b\u30d1\u30e9\u30e1\u30fc\u30bf \u0398\\Theta \u3092\u5b66\u7fd2\u3059\u308b\u3002\n\u5831\u916c\u306e\u671f\u5f85\u5024\u3092\n\\begin{align}\n\\mathbb{E}[R; \\Theta]\n &= \\sum_{i} r_{i} \\prod_{t=1}^{L_{i}} \\pi(a_{i,t} \\mid x_{i,t} ; \\Theta) \\\\\n &= \\sum_{i} r_{i} p(x_{i} ; \\Theta) \\\\\n\\end{align}\nE[R;\u0398]=\u2211iriLi\u220ft=1\u03c0(ai,t\u2223xi,t;\u0398)=\u2211irip(xi;\u0398){\\begin{align}\n\\mathbb{E}[R; \\Theta]\n &= \\sum_{i} r_{i} \\prod_{t=1}^{L_{i}} \\pi(a_{i,t} \\mid x_{i,t} ; \\Theta) \\\\\n &= \\sum_{i} r_{i} p(x_{i} ; \\Theta) \\\\\n\\end{align}\n}\n\u3068\u8a08\u7b97\u3067\u304d\u308b\u3002LiL_{i} \u306f ii \u756a\u76ee\u306e\u30a8\u30d4\u30bd\u30fc\u30c9\u306e\u9577\u3055\u3001rir_{i} \u306f ii \u756a\u76ee\u306e\u30a8\u30d4\u30bd\u30fc\u30c9\u306e\u5831\u916c\u3067\u3042\u308b\u3002\u3053\u3053\u3067 p(xi;\u0398)=\u220fLit=1\u03c0(ai,t\u2223xi,t;\u0398)p(x_{i} ; \\Theta) = \\prod_{t=1}^{L_{i}} \\pi(a_{i,t} \\mid x_{i,t} ; \\Theta) \u3068\u304a\u3044\u305f\u3002\n\u3053\u308c\u3092\u52fe\u914d\u6cd5\u3067\u6700\u5927\u5316\u3059\u308b\u3053\u3068\u3092\u8003\u3048\u308b\u3002\n\\begin{align}\n\\nabla_{\\Theta} \\mathbb{E}[R; \\Theta]\n  &= \\sum_{i} r_{i} \\nabla_{\\Theta} p(x_{i} ; \\Theta) \\\\\n  &= \\sum_{i} r_{i} p(x_{i} ; \\Theta) \\left(\n     \\sum_{t=1}^{L_{i}}\n       \\frac{\\nabla_{\\Theta} \\pi(a_{i,t} \\mid x_{i,t} ; \\Theta)}\n            {\\pi(a_{i,t} \\mid x_{i,t} ; \\Theta)} \\right) \\\\\n  &= \\sum_{i} r_{i} p(x_{i} ; \\Theta) \\left(\n     \\sum_{t=1}^{L_{i}} \\nabla_{\\Theta}\n         \\log \\pi(a_{i,t} \\mid x_{i,t} ; \\Theta) \\right) \\\\\n  &= \\sum_{i} r_{i} p(x_{i} ; \\Theta)\n     \\sum_{t=1}^{L_{i}} \\left(\n       \\frac{1}{T} \\nabla_{\\Theta} E(a_{i,t}, x_{i,t} ; \\Theta) -\n                   \\nabla_{\\Theta} \\log Z_{x_{i,t}} \\right) \\\\\n  &= \\frac{1}{T} \\sum_{i} r_{i} p(x_{i} ; \\Theta)\n     \\sum_{t=1}^{L_{i}} \\left(\n       \\nabla_{\\Theta} E(a_{i,t}, x_{i,t} ; \\Theta) -\n       \\sum_{a' \\in A_{x_{i,t}}} \\pi(a' \\mid x_{i,t} ; \\Theta) \\nabla_{\\Theta} E(a', x_{i,t} ; \\Theta) \\right)\n\\end{align}\n\u2207\u0398E[R;\u0398]=\u2211iri\u2207\u0398p(xi;\u0398)=\u2211irip(xi;\u0398)(Li\u2211t=1\u2207\u0398\u03c0(ai,t\u2223xi,t;\u0398)\u03c0(ai,t\u2223xi,t;\u0398))=\u2211irip(xi;\u0398)(Li\u2211t=1\u2207\u0398log\u03c0(ai,t\u2223xi,t;\u0398))=\u2211irip(xi;\u0398)Li\u2211t=1(1T\u2207\u0398E(ai,t,xi,t;\u0398)\u2212\u2207\u0398logZxi,t)=1T\u2211irip(xi;\u0398)Li\u2211t=1(\u2207\u0398E(ai,t,xi,t;\u0398)\u2212\u2211a\u2032\u2208Axi,t\u03c0(a\u2032\u2223xi,t;\u0398)\u2207\u0398E(a\u2032,xi,t;\u0398)){\\begin{align}\n\\nabla_{\\Theta} \\mathbb{E}[R; \\Theta]\n  &= \\sum_{i} r_{i} \\nabla_{\\Theta} p(x_{i} ; \\Theta) \\\\\n  &= \\sum_{i} r_{i} p(x_{i} ; \\Theta) \\left(\n     \\sum_{t=1}^{L_{i}}\n       \\frac{\\nabla_{\\Theta} \\pi(a_{i,t} \\mid x_{i,t} ; \\Theta)}\n            {\\pi(a_{i,t} \\mid x_{i,t} ; \\Theta)} \\right) \\\\\n  &= \\sum_{i} r_{i} p(x_{i} ; \\Theta) \\left(\n     \\sum_{t=1}^{L_{i}} \\nabla_{\\Theta}\n         \\log \\pi(a_{i,t} \\mid x_{i,t} ; \\Theta) \\right) \\\\\n  &= \\sum_{i} r_{i} p(x_{i} ; \\Theta)\n     \\sum_{t=1}^{L_{i}} \\left(\n       \\frac{1}{T} \\nabla_{\\Theta} E(a_{i,t}, x_{i,t} ; \\Theta) -\n                   \\nabla_{\\Theta} \\log Z_{x_{i,t}} \\right) \\\\\n  &= \\frac{1}{T} \\sum_{i} r_{i} p(x_{i} ; \\Theta)\n     \\sum_{t=1}^{L_{i}} \\left(\n       \\nabla_{\\Theta} E(a_{i,t}, x_{i,t} ; \\Theta) -\n       \\sum_{a' \\in A_{x_{i,t}}} \\pi(a' \\mid x_{i,t} ; \\Theta) \\nabla_{\\Theta} E(a', x_{i,t} ; \\Theta) \\right)\n\\end{align}\n}\n\u3068\u306a\u308b\u3002\u7d50\u679c\u3068\u3057\u3066\n\\Theta \\leftarrow \\Theta + \\frac{\\eta}{T} \\sum_{i} r_{i} p(x_{i} ; \\Theta) \\sum_{t=1}^{L_{i}} \\left( \\nabla_{\\Theta} E(a_{i,t}, x_{i,t} ; \\Theta) - \\sum_{a' \\in A_{x_{i,t}}} \\pi(a' \\mid x_{i,t} ; \\Theta) \\nabla_{\\Theta} E(a', x_{i,t} ; \\Theta) \\right)\n\u0398\u2190\u0398+\u03b7T\u2211irip(xi;\u0398)Li\u2211t=1(\u2207\u0398E(ai,t,xi,t;\u0398)\u2212\u2211a\u2032\u2208Axi,t\u03c0(a\u2032\u2223xi,t;\u0398)\u2207\u0398E(a\u2032,xi,t;\u0398)){\\Theta \\leftarrow \\Theta + \\frac{\\eta}{T} \\sum_{i} r_{i} p(x_{i} ; \\Theta) \\sum_{t=1}^{L_{i}} \\left( \\nabla_{\\Theta} E(a_{i,t}, x_{i,t} ; \\Theta) - \\sum_{a' \\in A_{x_{i,t}}} \\pi(a' \\mid x_{i,t} ; \\Theta) \\nabla_{\\Theta} E(a', x_{i,t} ; \\Theta) \\right)\n}\n\u3068\u30d1\u30e9\u30e1\u30fc\u30bf\u3092\u66f4\u65b0\u3059\u308c\u3070\u3088\u3044\u3002\u3053\u3053\u3067 \u03b7\\eta \u306f\u5c0f\u3055\u306a\u6b63\u306e\u30d1\u30e9\u30e1\u30fc\u30bf\u3067\u3042\u308b\u3002\n\u3069\u306e\u3088\u3046\u306a\u5831\u916c\u3092\u4e0e\u3048\u308b\u304b\u306f\u3001\u8a2d\u8a08\u8005\u304c\u4efb\u610f\u306b\u8a2d\u5b9a\u3067\u304d\u308b\u3002\n\n\u7dda\u5f62\u95a2\u6570\n\u5c40\u9762 xtx_{t} \u306e\u304b\u3089\u884c\u52d5 ata_{t} \u3092\u3057\u305f\u3042\u3068\u306e\u7279\u5fb4\u30d9\u30af\u30c8\u30eb\u3092 \u03d5at(xt)\\phi_{a_{t}}(x_{t}) \u3068\u3057\u3066\nE(a_{t}, x_{t} ; \\vec{w}) = \\vec{w}^{\\top} \\phi_{a_{t}}(x_{t})\nE(at,xt;\u2192w)=\u2192w\u22a4\u03d5at(xt){E(a_{t}, x_{t} ; \\vec{w}) = \\vec{w}^{\\top} \\phi_{a_{t}}(x_{t})\n}\n\u3068\u5b9a\u7fa9\u3059\u308b (\u0398=\u2192w\\Theta = \\vec{w} \u3068\u304a\u304f) \u3068\n\\nabla_{\\vec{w}} E(a_{t}, x_{t} ; \\Theta) = \\phi_{a_{t}}(x_{t})\n\u2207\u2192wE(at,xt;\u0398)=\u03d5at(xt){\\nabla_{\\vec{w}} E(a_{t}, x_{t} ; \\Theta) = \\phi_{a_{t}}(x_{t})\n}\n\u3067\u3042\u308b\u304b\u3089\n\\nabla_{\\vec{w}} \\mathbb{E}[R; \\vec{w}]\n   = \\frac{1}{T} \\sum_{i} r_{i} p(x_{i}) \\sum_{t=1}^{L_{i}} \\left( \\phi_{a_{i,t}}(x_{i,t}) - \\sum_{a' \\in A_{x_{i,t}}} \\pi(a' \\mid x_{i,t} ; \\Theta) \\phi_{a'}(x_{i,t}) \\right)\n{\\nabla_{\\vec{w}} \\mathbb{E}[R; \\vec{w}]\n   = \\frac{1}{T} \\sum_{i} r_{i} p(x_{i}) \\sum_{t=1}^{L_{i}} \\left( \\phi_{a_{i,t}}(x_{i,t}) - \\sum_{a' \\in A_{x_{i,t}}} \\pi(a' \\mid x_{i,t} ; \\Theta) \\phi_{a'}(x_{i,t}) \\right)\n}{\\nabla_{\\vec{w}} \\mathbb{E}[R; \\vec{w}]\n   = \\frac{1}{T} \\sum_{i} r_{i} p(x_{i}) \\sum_{t=1}^{L_{i}} \\left( \\phi_{a_{i,t}}(x_{i,t}) - \\sum_{a' \\in A_{x_{i,t}}} \\pi(a' \\mid x_{i,t} ; \\Theta) \\phi_{a'}(x_{i,t}) \\right)\n}\n\u3068\u306a\u308b\u3002\n\n\u30b5\u30f3\u30d7\u30ea\u30f3\u30b0\nNN \u500b\u306e\u30a8\u30d4\u30bd\u30fc\u30c9\u3092 p(x_{i})p(x_{i}) \u304b\u3089\u306e\u30b5\u30f3\u30d7\u30ea\u30f3\u30b0\u3067\u751f\u6210\u3059\u308b\u3068\u3059\u308b\u3068\n\\nabla_{\\vec{w}} \\mathbb{E}[R; \\vec{w}]\n   = \\frac{1}{N T} \\sum_{i=1}^{N} r_{i} \\sum_{t=1}^{L_{i}} \\left( \\phi_{a_{i,t}}(x_{i,t}) - \\sum_{a' \\in A_{x_{i,t}}} \\pi(a' \\mid x_{i,t} ; \\Theta) \\phi_{a'}(x_{i,t}) \\right)\n{\\nabla_{\\vec{w}} \\mathbb{E}[R; \\vec{w}]\n   = \\frac{1}{N T} \\sum_{i=1}^{N} r_{i} \\sum_{t=1}^{L_{i}} \\left( \\phi_{a_{i,t}}(x_{i,t}) - \\sum_{a' \\in A_{x_{i,t}}} \\pi(a' \\mid x_{i,t} ; \\Theta) \\phi_{a'}(x_{i,t}) \\right)\n}{\\nabla_{\\vec{w}} \\mathbb{E}[R; \\vec{w}]\n   = \\frac{1}{N T} \\sum_{i=1}^{N} r_{i} \\sum_{t=1}^{L_{i}} \\left( \\phi_{a_{i,t}}(x_{i,t}) - \\sum_{a' \\in A_{x_{i,t}}} \\pi(a' \\mid x_{i,t} ; \\Theta) \\phi_{a'}(x_{i,t}) \\right)\n}\n\u3068\u52fe\u914d\u3092\u8a08\u7b97\u3067\u304d\u308b\u3002\u30b5\u30f3\u30d7\u30ea\u30f3\u30b0\u3059\u308b\u306e\u306f\u591a\u4eba\u6570\u30b2\u30fc\u30e0\u3068\u304b\u3067\u306f\u610f\u5473\u304c\u306a\u3055\u305d\u3046\u3002\n\n\u53c2\u8003\u6587\u732e\n\n\u4e94\u5341\u5d50\u6cbb\u4e00, \u68ee\u5ca1\u7950\u4e00, \u5c71\u672c\u4e00\u5c06: \"\u65b9\u7b56\u52fe\u914d\u6cd5\u306b\u3088\u308b\u5c40\u9762\u8a55\u4fa1\u95a2\u6570\u3068\u30b7\u30df\u30e5\u30ec\u30fc\u30b7\u30e7\u30f3\u65b9\u7b56\u306e\u5b66\u7fd2,\" \u7814\u7a76\u5831\u544a\u30b2\u30fc\u30e0\u60c5\u5831\u5b66 (GI), Vol. 2013-GI-30, No. 6, pp. 1-8, 2013.\n\n\u65b9\u7b56\u52fe\u914d\u6cd5 (policy gradient algorithm) \u306f\u5f37\u5316\u5b66\u7fd2\u306e\u624b\u6cd5\u3067\u3042\u308b\u3002\n\n\u6642\u523b $t$ \u306e\u72b6\u614b $x\\_{t}$ \u3067\u884c\u52d5 $a\\_{t}$ \u3092\u9078\u629e\u3059\u308b\u78ba\u7387\u3092\n\n```math\n\\pi(a_{t} \\mid x_{t} ; \\Theta) = \\frac{1}{Z_{x_{t}}} e^{\\frac{1}{T} E(a_{t}, x_{t} ; \\Theta)}\n```\n\n\u3067\u5b9a\u7fa9\u3059\u308b\u3002\u3053\u3053\u3067\u3001$\\Theta$ \u306f\u5b66\u7fd2\u30d1\u30e9\u30e1\u30fc\u30bf\u3001$T$ \u306f\u5b66\u7fd2\u3092\u30b3\u30f3\u30c8\u30ed\u30fc\u30eb\u3059\u308b\u305f\u3081\u306e\u6e29\u5ea6\u30d1\u30e9\u30e1\u30fc\u30bf\u3001$Z\\_{x\\_{t}} = \\sum\\_{a' \\in A\\_{x\\_{t}}} e^{\\frac{1}{T} E(a', x\\_{t} ; \\Theta)}$ \u306f\u884c\u52d5\u5206\u5e03\u306e\u6b63\u898f\u5316\u5b9a\u6570\u3001$A\\_{x_{t}}$ \u306f\u72b6\u614b $x\\_{t}$ \u3067\u3067\u304d\u308b\u884c\u52d5\u306e\u96c6\u5408\u3067\u3042\u308b\u3002\n\n1 \u56de\u306e\u30a8\u30d4\u30bd\u30fc\u30c9\u3067\u5f97\u3089\u308c\u305f\u5831\u916c\u3092 $r$ \u3068\u3057\u3066\u3001\u305d\u306e\u671f\u5f85\u5831\u916c\u3092\u6700\u5927\u5316\u3059\u308b\u30d1\u30e9\u30e1\u30fc\u30bf $\\Theta$ \u3092\u5b66\u7fd2\u3059\u308b\u3002\n\n\u5831\u916c\u306e\u671f\u5f85\u5024\u3092\n\n```math\n\\begin{align}\n\\mathbb{E}[R; \\Theta]\n &= \\sum_{i} r_{i} \\prod_{t=1}^{L_{i}} \\pi(a_{i,t} \\mid x_{i,t} ; \\Theta) \\\\\n &= \\sum_{i} r_{i} p(x_{i} ; \\Theta) \\\\\n\\end{align}\n```\n\n\u3068\u8a08\u7b97\u3067\u304d\u308b\u3002$L\\_{i}$ \u306f $i$ \u756a\u76ee\u306e\u30a8\u30d4\u30bd\u30fc\u30c9\u306e\u9577\u3055\u3001$r\\_{i}$ \u306f $i$ \u756a\u76ee\u306e\u30a8\u30d4\u30bd\u30fc\u30c9\u306e\u5831\u916c\u3067\u3042\u308b\u3002\u3053\u3053\u3067 $p(x\\_{i} ; \\Theta) = \\prod\\_{t=1}^{L\\_{i}} \\pi(a\\_{i,t} \\mid x\\_{i,t} ; \\Theta)$ \u3068\u304a\u3044\u305f\u3002\n\n\u3053\u308c\u3092\u52fe\u914d\u6cd5\u3067\u6700\u5927\u5316\u3059\u308b\u3053\u3068\u3092\u8003\u3048\u308b\u3002\n\n```math\n\\begin{align}\n\\nabla_{\\Theta} \\mathbb{E}[R; \\Theta]\n  &= \\sum_{i} r_{i} \\nabla_{\\Theta} p(x_{i} ; \\Theta) \\\\\n  &= \\sum_{i} r_{i} p(x_{i} ; \\Theta) \\left(\n     \\sum_{t=1}^{L_{i}}\n       \\frac{\\nabla_{\\Theta} \\pi(a_{i,t} \\mid x_{i,t} ; \\Theta)}\n            {\\pi(a_{i,t} \\mid x_{i,t} ; \\Theta)} \\right) \\\\\n  &= \\sum_{i} r_{i} p(x_{i} ; \\Theta) \\left(\n     \\sum_{t=1}^{L_{i}} \\nabla_{\\Theta}\n         \\log \\pi(a_{i,t} \\mid x_{i,t} ; \\Theta) \\right) \\\\\n  &= \\sum_{i} r_{i} p(x_{i} ; \\Theta)\n     \\sum_{t=1}^{L_{i}} \\left(\n       \\frac{1}{T} \\nabla_{\\Theta} E(a_{i,t}, x_{i,t} ; \\Theta) -\n                   \\nabla_{\\Theta} \\log Z_{x_{i,t}} \\right) \\\\\n  &= \\frac{1}{T} \\sum_{i} r_{i} p(x_{i} ; \\Theta)\n     \\sum_{t=1}^{L_{i}} \\left(\n       \\nabla_{\\Theta} E(a_{i,t}, x_{i,t} ; \\Theta) -\n       \\sum_{a' \\in A_{x_{i,t}}} \\pi(a' \\mid x_{i,t} ; \\Theta) \\nabla_{\\Theta} E(a', x_{i,t} ; \\Theta) \\right)\n\\end{align}\n```\n\n\u3068\u306a\u308b\u3002\u7d50\u679c\u3068\u3057\u3066\n\n```math\n\\Theta \\leftarrow \\Theta + \\frac{\\eta}{T} \\sum_{i} r_{i} p(x_{i} ; \\Theta) \\sum_{t=1}^{L_{i}} \\left( \\nabla_{\\Theta} E(a_{i,t}, x_{i,t} ; \\Theta) - \\sum_{a' \\in A_{x_{i,t}}} \\pi(a' \\mid x_{i,t} ; \\Theta) \\nabla_{\\Theta} E(a', x_{i,t} ; \\Theta) \\right)\n```\n\n\u3068\u30d1\u30e9\u30e1\u30fc\u30bf\u3092\u66f4\u65b0\u3059\u308c\u3070\u3088\u3044\u3002\u3053\u3053\u3067 $\\eta$ \u306f\u5c0f\u3055\u306a\u6b63\u306e\u30d1\u30e9\u30e1\u30fc\u30bf\u3067\u3042\u308b\u3002\n\n\u3069\u306e\u3088\u3046\u306a\u5831\u916c\u3092\u4e0e\u3048\u308b\u304b\u306f\u3001\u8a2d\u8a08\u8005\u304c\u4efb\u610f\u306b\u8a2d\u5b9a\u3067\u304d\u308b\u3002\n\n# \u7dda\u5f62\u95a2\u6570\n\n\u5c40\u9762 $x\\_{t}$ \u306e\u304b\u3089\u884c\u52d5 $a\\_{t}$ \u3092\u3057\u305f\u3042\u3068\u306e\u7279\u5fb4\u30d9\u30af\u30c8\u30eb\u3092 $\\phi\\_{a\\_{t}}(x\\_{t})$ \u3068\u3057\u3066\n\n```math\nE(a_{t}, x_{t} ; \\vec{w}) = \\vec{w}^{\\top} \\phi_{a_{t}}(x_{t})\n```\n\n\u3068\u5b9a\u7fa9\u3059\u308b ($\\Theta = \\vec{w}$ \u3068\u304a\u304f) \u3068\n\n```math\n\\nabla_{\\vec{w}} E(a_{t}, x_{t} ; \\Theta) = \\phi_{a_{t}}(x_{t})\n```\n\n\u3067\u3042\u308b\u304b\u3089\n\n```math\n\\nabla_{\\vec{w}} \\mathbb{E}[R; \\vec{w}]\n   = \\frac{1}{T} \\sum_{i} r_{i} p(x_{i}) \\sum_{t=1}^{L_{i}} \\left( \\phi_{a_{i,t}}(x_{i,t}) - \\sum_{a' \\in A_{x_{i,t}}} \\pi(a' \\mid x_{i,t} ; \\Theta) \\phi_{a'}(x_{i,t}) \\right)\n```\n\n\u3068\u306a\u308b\u3002\n\n## \u30b5\u30f3\u30d7\u30ea\u30f3\u30b0\n\n$N$ \u500b\u306e\u30a8\u30d4\u30bd\u30fc\u30c9\u3092 $p(x\\_{i})$ \u304b\u3089\u306e\u30b5\u30f3\u30d7\u30ea\u30f3\u30b0\u3067\u751f\u6210\u3059\u308b\u3068\u3059\u308b\u3068\n\n```math\n\\nabla_{\\vec{w}} \\mathbb{E}[R; \\vec{w}]\n   = \\frac{1}{N T} \\sum_{i=1}^{N} r_{i} \\sum_{t=1}^{L_{i}} \\left( \\phi_{a_{i,t}}(x_{i,t}) - \\sum_{a' \\in A_{x_{i,t}}} \\pi(a' \\mid x_{i,t} ; \\Theta) \\phi_{a'}(x_{i,t}) \\right)\n```\n\n\u3068\u52fe\u914d\u3092\u8a08\u7b97\u3067\u304d\u308b\u3002\u30b5\u30f3\u30d7\u30ea\u30f3\u30b0\u3059\u308b\u306e\u306f\u591a\u4eba\u6570\u30b2\u30fc\u30e0\u3068\u304b\u3067\u306f\u610f\u5473\u304c\u306a\u3055\u305d\u3046\u3002\n\n# \u53c2\u8003\u6587\u732e\n\n0. \u4e94\u5341\u5d50\u6cbb\u4e00, \u68ee\u5ca1\u7950\u4e00, \u5c71\u672c\u4e00\u5c06: \"[\u65b9\u7b56\u52fe\u914d\u6cd5\u306b\u3088\u308b\u5c40\u9762\u8a55\u4fa1\u95a2\u6570\u3068\u30b7\u30df\u30e5\u30ec\u30fc\u30b7\u30e7\u30f3\u65b9\u7b56\u306e\u5b66\u7fd2](http://id.nii.ac.jp/1001/00092711/),\" \u7814\u7a76\u5831\u544a\u30b2\u30fc\u30e0\u60c5\u5831\u5b66 (GI), Vol. 2013-GI-30, No. 6, pp. 1-8, 2013.\n"}