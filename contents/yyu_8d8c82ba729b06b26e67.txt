{"context": " More than 1 year has passed since last update.\u516c\u5e73\u306a\u7b2c\u4e09\u8005\u306a\u3057\u306b\u30d7\u30ec\u30a4\u30e4\u30fc\u306e\u60c5\u5831\u79d8\u5bc6\u3092\u4fdd\u3064Mental Poker\u306e\u30d7\u30ed\u30c8\u30b3\u30eb \u3068\u3044\u3046\u65b9\u6cd5\u304cContribution to Mental Poker\u3068\u3044\u3046\u672c\u306eChapter 6\u3067\u7d39\u4ecb\u3055\u308c\u3066\u3044\u307e\u3059\u3002\u3053\u308c\u306b\u3064\u3044\u3066\u8aad\u3093\u3067\u5206\u304b\u3063\u305f\u3053\u3068\u3092\u307e\u3068\u3081\u307e\u3059\u3002\n\u307e\u305f\u3001\u3053\u308c\u3092\u3082\u3068\u306bPython\u3068Charm-Crypt\u3092\u7528\u3044\u3066\u66f8\u3044\u305f\u30b3\u30fc\u30c9\u304c\u4e0b\u8a18\u306eGist\u306b\u3042\u308a\u307e\u3059\u3002\nhttps://gist.github.com/yoshimuraYuu/d8897e9dce479b620606\n\n\u3084\u308a\u305f\u3044\u3053\u3068\n\nTTP\uff08 Trusted Third Party \uff09\u3092\u5fc5\u8981\u3068\u3057\u306a\u3044\n\u30d7\u30ec\u30a4\u30e4\u30fc\u306e\u6226\u7565\u306e\u79d8\u5bc6\u6027\u304c\u3042\u308b\n\n\n\u30d7\u30ed\u30c8\u30b3\u30eb\nProtocol \u3084 Procedure \u306e\u6570\u5b57\u306f\u3082\u3068\u306b\u306a\u3063\u305fContribution to Mental Poker\u306b\u4f75\u305b\u3066\u3044\u308b\u306e\u3067\u3001\u5999\u306a\u756a\u53f7\u304b\u3089\u59cb\u307e\u308a\u307e\u3059\u304c\u6c17\u306b\u3059\u308b\u5fc5\u8981\u306f\u3042\u308a\u307e\u305b\u3093\u3002\n\n\u6e96\u5099\n\u307e\u305a\u3001\u6b21\u306e\u5185\u5bb9\u306f\u5168\u3066\u306e\u30d7\u30ec\u30a4\u30e4\u30fc\u306e\u9593\u306e\u4e2d\u3067\u5171\u901a\u306e\u3082\u306e\u3092\u7528\u3044\u307e\u3059\u3002\n\n\u30d7\u30ec\u30a4\u30e4\u30fc\u306fP1P1P_1\u304b\u3089PnPnP_n\u307e\u3067\u306ennn\u4eba\np=2q+1\u2227q>2p=2q+1\u2227q>2p = 2q + 1 \\wedge q > 2\u3068\u306a\u308b\u3088\u3046\u306a\u7d20\u6570p,qp,qp, q\n\n\u539f\u59cb\u5143\u03b1\u03b1\\alpha\uff08\u3053\u306e\u03b1\u03b1\\alpha\u306fppp\u3068\u5e73\u65b9\u975e\u5270\u4f59\uff09\n\u30d1\u30e9\u30e1\u30fc\u30bf\u30fcsss\n\u4f7f\u7528\u3059\u308b\u30ab\u30fc\u30c9\u306f525252\u679a\nX=x1,\u2026,xi,\u2026,x52X=x1,\u2026,xi,\u2026,x52X = x_1, \\dots, x_i, \\dots, x_{52}\uff08\u305f\u3060\u30572<xi<q2<xi<q2 < x_i < q\u304b\u3064xixix_i\u306f\u5947\u6570\uff09\n\n\u305d\u3057\u3066\u3001\u30d7\u30ec\u30a4\u30e4\u30fcPiPiP_i\u306f\u6b21\u306e\u3088\u3046\u306a\u8a08\u7b97\u3092\u3057\u307e\u3059\u3002\n\n2<Ki<q2<Ki<q2 < K_i < q\u3068\u306a\u308b\u4efb\u610f\u306e\u5947\u6570\u3092\u30d7\u30ec\u30a4\u30e4\u30fcPiPiP_i\u306e\u79d8\u5bc6\u9375KiKiK_i\u3068\u3059\u308b\n\u03b2i=\u03b1Ki\u03b2i=\u03b1Ki\\beta_i = \\alpha^{K_i}\u3068\u306a\u308b\u03b2i\u03b2i\\beta_i\u3092\u4ed6\u306e\u30d7\u30ec\u30a4\u30e4\u30fc\u306b\u516c\u958b\u3059\u308b\n\u03b2=\u03b1K1,\u2026,Kn\u03b2=\u03b1K1,\u2026,Kn\\beta = \\alpha^{K_1, \\dots, K_n}\u3068\u306a\u308b\u03b2\u03b2\\beta\u3092\u3001KiKiK_i\u3092\u516c\u958b\u3059\u308b\u3053\u3068\u306a\u304f\u5171\u6709\u3059\u308b\uff08\u3053\u306e\u5171\u6709\u306b\u306fDiffie-Hellman\u9375\u4ea4\u63db\u3092\u4f7f\u3044\u307e\u3059\uff09\n\n\n\u30ab\u30fc\u30c9\u306e\u30b7\u30e3\u30c3\u30d5\u30eb\n\u76f4\u611f\u7684\u306a\u30a4\u30e1\u30fc\u30b8\u306f\u5168\u3066\u306e\u30d7\u30ec\u30a4\u30e4\u30fc\u304c\u88cf\u306b\u3057\u305f\u5c71\u672d\u3092\u9806\u306b\u30b7\u30e3\u30c3\u30d5\u30eb\u3057\u3066\u3086\u304f\u3088\u3046\u306a\u611f\u3058\u3067\u3059\u3002\n\n\u30b7\u30e3\u30c3\u30d5\u30eb\u306e\u6e96\u5099\n\u307e\u305a\u3001\u3053\u3053\u3067\u6b21\u306e\u3088\u3046\u306a\u521d\u671f\u306e\u5c71\u672dC0C0C_0\u3092\u30bb\u30c3\u30c8\u3057\u307e\u3059\u3002\nC_0 = c_{0, 1}, \\dots, c_{0, 52} \\\\\nwhere\\, c_{0,j} = (d_{0,j}, \\alpha_{0,j}) = (\\alpha^{x_j}, \\beta)\nC0=c0,1,\u2026,c0,52wherec0,j=(d0,j,\u03b10,j)=(\u03b1xj,\u03b2)C0=c0,1,\u2026,c0,52wherec0,j=(d0,j,\u03b10,j)=(\u03b1xj,\u03b2){C_0 = c_{0, 1}, \\dots, c_{0, 52} \\\\\nwhere\\, c_{0,j} = (d_{0,j}, \\alpha_{0,j}) = (\\alpha^{x_j}, \\beta)\n}\n\u3053\u3053\u3067\u3001\u3044\u304b\u306a\u308b\u03b1xj\\alpha^{x_j}\u3082\u5e73\u65b9\u975e\u5270\u4f59\u3067\u3059\u3002\n\u305d\u306e\u5f8c\u3001\u30d7\u30ec\u30a4\u30e4\u30fcPiP_i\u306f\u5c71\u672dCi\u22121C_{i-1}\u3092\u5f97\u3066\u5c71\u672dCiC_i\u3092\u751f\u6210\u3057\u307e\u3059\u3002\u30b7\u30e3\u30c3\u30d5\u30eb\u3092P1P_1\u304b\u3089PnP_n\u307e\u3067\u9806\u756a\u306b\u5b9f\u884c\u3057\u3066\u3001\u6700\u5f8c\u306bPnP_n\u304c\u751f\u6210\u3057\u305f\u5c71\u672dCnC_n\u304c\u6700\u7d42\u7684\u306a\u5c71\u672d\u3068\u306a\u308a\u307e\u3059\u3002\n\n\u30b7\u30e3\u30c3\u30d5\u30eb\u306e\u624b\u9806\uff08Protocol 47\uff09\n\n\u30d7\u30ec\u30a4\u30e4\u30fcPiP_i\u306f\u3001\u4e00\u3064\u524d\u306e\u30d7\u30ec\u30a4\u30e4\u30fcPi\u22121P_{i-1}\u304c\u8a08\u7b97\u3057\u305f\u5c71\u672dCi\u22121C_{i-1}\u304b\u3089 Procedure 32 \u3092\u7528\u3044\u3066Ci,Ri,\u03c0iC_i, R_i, \\pi_i\u3092\u8a08\u7b97\u3059\u308b\n\nProtocol 48 \u3092\u7528\u3044\u3066\u3001\u4e00\u3064\u524d\u306e\u30d7\u30ec\u30a4\u30e4\u30fcPi\u22121P_{i-1}\u304c\u8a08\u7b97\u3057\u305fCi\u22121C_{i-1}\u304c\u59a5\u5f53\u304b\u691c\u67fb\nCiC_i\u3092\u5168\u3066\u306e\u30d7\u30ec\u30a4\u30e4\u30fc\u3078\u516c\u958b\u3059\u308b\n\n\n\u5c71\u672d\u306e\u4e26\u3073\u306e\u5165\u624b\uff08Procedure 32\uff09\n\u307e\u305a\u30d7\u30ec\u30a4\u30e4\u30fcPiP_i\u306f\u524d\u306e\u30d7\u30ec\u30a4\u30e4\u30fcPi\u22121P_{i-1}\u304c\u751f\u6210\u3057\u305f\u5c71\u672dCi\u22121=c1,\u2026,c52C_{i-1} = c_1, \\dots, c_{52}\uff08\u305f\u3060\u3057cj=(dj,\u03b1j)c_j = (d_j, \\alpha_j)\uff09\u3092\u7528\u3044\u3066\u6b21\u306e\u3088\u3046\u306b\u30b7\u30e3\u30c3\u30d5\u30eb\u3092\u884c\u3044\u307e\u3059\u3002\n\n\u53d7\u3051\u53d6\u308b\u60c5\u5831\n\n\u5c71\u672dCC\n\n\n\u624b\u9806\n\nR=r1,\u2026,r52R = r_1, \\dots, r_{52}\u3068\u3044\u3046RR\u3092\u751f\u6210\u3059\u308b\uff08\u305f\u3060\u3057rj=2<rj<qr_j = 2 < r_j < q\u3092\u6e80\u3059\u30e9\u30f3\u30c0\u30e0\u306a\u5947\u6570\uff09\nc\u2032j=(drjj,\u03b1rjj)c_j' = (d_j^{r_j}, \\alpha_j^{r_j})\u3092j=1\u202652j = 1 \\dots 52\u306b\u3064\u3044\u3066\u8a08\u7b97\u3059\u308b\uff08\u305f\u3060\u3057jj\u306fCC\u306ejj\u756a\u76ee\uff09\n1,2,\u2026,521, 2, \\dots, 52\u3092\u30e9\u30f3\u30c0\u30e0\u306b\u4e26\u3079\u305f\u9806\u5e8f\u03c0\\pi\u3092\u751f\u6210\u3059\u308b\nC\u2217=c\u2032\u03c0(1),\u2026,c\u2032\u03c0(52)C^* = c_{\\pi(1)}', \\dots, c_{\\pi(52)}'\u3068\u3044\u3046C\u2217C^*\u3092\u5f97\u308b\nC\u2217,R,\u03c0C^*, R, \\pi\u3092\u8fd4\u3059\n\n\n\u5c71\u672d\u306e\u30b7\u30e3\u30c3\u30d5\u30eb\u3068\u691c\u8a3c\uff08Protocol 48\uff09\n\u30d7\u30ec\u30a4\u30e4\u30fcPiP_i\u304c\u5c71\u672dCi\u22121C_{i-1}\u3092\u5165\u624b\u3057\u3066\u3082\u3001\u524d\u306e\u30d7\u30ec\u30a4\u30e4\u30fcPi\u22121P_{i-1}\u304c\u304d\u3061\u3093\u3068\u5c71\u672dCi\u22121C_{i-1}\u3092\u8a08\u7b97\u3057\u305f\u306e\u304b\u691c\u8a3c\u3057\u3066\u3001\u81ea\u8eab\u3082 Procedure 32 \u3067\u5c71\u672dCiC_i\u3092\u8a08\u7b97\u3057\u307e\u3059\u3002\n\u305f\u3060\u3057\u3001\u691c\u8a3c\u306e\u969b\u306b\u5c71\u672d\u306e\u4e2d\u5473\u304c\u5206\u3063\u3066\u3057\u307e\u3046\u3068\u516c\u5e73\u306a\u30b2\u30fc\u30e0\u306b\u306a\u3089\u306a\u3044\u306e\u3067\u3001 Procedure 32 \u3067\u751f\u6210\u3057\u305f\u60c5\u5831RR\u3092\u7528\u3044\u3066\u78ba\u7387\u7684\u306b\u691c\u8a3c\u3092\u884c\u3044\u307e\u3059\u3002\n\n\u53d7\u3051\u53d6\u308b\u60c5\u5831\n\n\u524d\u306e\u30d7\u30ec\u30a4\u30e4\u30fcPi\u22121P_{i-1}\u306e\u5c71\u672dCi\u22121C_{i-1}\n\u8a08\u7b97\u3057\u3066\u3044\u308b\u30d7\u30ec\u30a4\u30e4\u30fcPiP_i\u306e\u5c71\u672dCiC_i\n\u60c5\u5831RiR_i\n\u9806\u5e8f\u03c0i\\pi_i\n\u30d1\u30e9\u30e1\u30fc\u30bf\u30fcss\n\n\n\u624b\u9806\n\n\u30d7\u30ec\u30a4\u30e4\u30fcPiP_i\u306fCi,k,Ri,k,\u03c0i,k=Procedure32(Ci)C_{i,k}, R_{i,k}, \\pi_{i,k} = \\mathit{Procedure\\, 32}(C_i)\u3092\u5f97\u3066\u3001Ci,kC_{i,k}\u3092\u4ed6\u306e\u30d7\u30ec\u30a4\u30e4\u30fc\u3078\u516c\u958b\u3059\u308b\uff08kk\u306f11\u304b\u3089ss\uff09\nPiP_i\u4ee5\u5916\u306e\u30d7\u30ec\u30a4\u30e4\u30fc\u306fss\u6841\u306e\u30e9\u30f3\u30c0\u30e0\u306a\u30d3\u30c3\u30c8\u5217U=ui,\u2026,usU = u_i, \\dots, u_s\u3092PiP_i\u3078\u9001\u308b\n\u9001\u3089\u308c\u3066\u304d\u305fuk\u2208Uu_k \\in U\u306b\u3064\u3044\u3066\n\n\nuk=1u_k = 1\u306a\u3089\u3070\n\n\n\u30d7\u30ec\u30a4\u30e4\u30fcPiP_i\u306fRi,k,\u03c0i,kR_{i,k}, \\pi_{i,k}\u3092\u516c\u958b\u3059\u308b\n\u4ed6\u306e\u30d7\u30ec\u30a4\u30e4\u30fc\u306f Procedure 33 \u3067Ci,Ci,kC_i, C_{i,k}\u3092\u691c\u8a3c\u3059\u308b\n\n\nuk=0u_k = 0\u306a\u3089\u3070\n\n\n\u30d7\u30ec\u30a4\u30e4\u30fcPiP_i\u306f\u03c0\u2032i,k=\u03c0i,k\u2218\u03c0i\\pi_{i,k}' = \\pi_{i,k} \\circ \\pi_i\u3068R\u2032i,k=r\u2032i,k,1,\u2026,r\u2032i,k,52R_{i,k}' = r_{i,k,1}', \\dots, r_{i,k,52}'\u3092\u5f97\u308b\uff08\u305f\u3060\u3057\u3001ri,k,j=ri,\u03c0\u2032\u22121i,k(j))\u22c5ri,k,\u03c0i,k(j)r_{i,k,j} = r_{i, \\pi_{i,k}'^{-1}(j))} \\cdot r_{i, k, \\pi_{i,k}(j)}\uff09\n\u30d7\u30ec\u30a4\u30e4\u30fcPiP_i\u306fR\u2032i,k,\u03c0\u2032i,kR_{i,k}', \\pi_{i,k}'\u3092\u516c\u958b\u3059\u308b\n\u4ed6\u306e\u30d7\u30ec\u30a4\u30e4\u30fc\u306f Procedure 33 \u3067Ci\u22121,Ci,kC_{i-1}, C_{i,k}\u3092\u691c\u8a3c\u3059\u308b\n\n\n\n\n\n\n\u5c71\u672d\u306e\u691c\u8a3c\uff08Procedure 33\uff09\n\n\u53d7\u3051\u53d6\u308b\u60c5\u5831\n\n\u5c71\u672dCaC_a\n\u5c71\u672dCbC_b\n\u60c5\u5831RR\n\u9806\u5e8f\u03c0\\pi\n\n\n\u624b\u9806\n\u5c71\u672dCaC_a\u3068\u5c71\u672dCbC_b\u306b\u3064\u3044\u3066\u3001\u60c5\u5831RR\u3068\u9806\u5e8f\u03c0\\pi\u304c\u304d\u3061\u3093\u3068\u5bfe\u5fdc\u3057\u3066\u3044\u308b\u306e\u304b\u3092\u5c71\u672d\u3092\u5148\u982d\u304b\u3089\u6700\u5f8c\u307e\u3067\u4e00\u679a\u305a\u3064\u691c\u67fb\u3057\u307e\u3059\u3002jj\u3092\u5c71\u672d\u304b\u3089jj\u756a\u76ee\u306e\u30ab\u30fc\u30c9\u3068\u3057\u307e\u3059\u3002\uff08\u3064\u307e\u308a1\u2264j\u2264521 \\le j \\le 52\uff09\n\ncb,j=(dd,j,\u03b1b,j)\u2208Cbc_{b,j} = (d_{d,j}, \\alpha_{b,j}) \\in C_b\u3068\u3057\u3001\u307e\u305fca,\u03c0(j)=(da,\u03c0(j),\u03b1a,\u03c0(j))\u2208Cac_{a,\\pi(j)} = (d_{a,\\pi(j)}, \\alpha_{a, \\pi(j)}) \\in C_a\u3068\u3059\u308b\ndb,j=(da,\u03c0(j))r\u03c0(j)d_{b,j} = (d_{a,\\pi(j)})^{r_{\\pi(j)}}\u304b\u3069\u3046\u304b\u691c\u67fb\u3059\u308b\n\u03b1b,j=(\u03b1a,\u03c0(j))r\u03c0(j)\\alpha_{b,j} = (\\alpha_{a, \\pi(j)})^{r_{\\pi(j)}}\u304b\u3069\u3046\u304b\u691c\u67fb\u3059\u308b\n\n\n\u30ab\u30fc\u30c9\u306e\u30c9\u30ed\u30fc\uff08Protocol 49\uff09\n\u4e0d\u6b63\u306e\u7121\u3055\u3092\u30bc\u30ed\u77e5\u8b58\u8a3c\u660e\u3067\u793a\u3057\u307e\u3059\u3002\n\n\u30d7\u30ec\u30a4\u30e4\u30fcPuP_u\u306f\u3001\u307e\u3060\u8ab0\u3082\u30c9\u30ed\u30fc\u3057\u3066\u3044\u306a\u3044\u5c71\u672dCnC_n\u306ejj\u756a\u76ee\u3092\u9078\u3073\u3001\u305d\u306e\u30ab\u30fc\u30c9\u3092cn,j=(dn,j,\u03b1n,j)c_{n,j} = (d_{n,j}, \\alpha_{n,j})\u3068\u3059\u308b\nPuP_u\u306fe0=\u03b1n,je_0 = \\alpha_{n,j}\u3092\u516c\u958b\u3057\u3001r=0r = 0\u3068\u3059\u308b\ni=1,2,\u2026,u\u22121,u+1,\u2026,ni = 1, 2, \\dots, u - 1, u + 1, \\dots, n\u3068\u3044\u3046ii\u306b\u3064\u3044\u3066\u3001\n\n\nr=r+1r = r + 1\u3068\u3059\u308b\nPiP_i\u306fer=(er\u22121)K\u22121ie_r = (e_{r-1})^{K_i^{-1}}\u3092\u516c\u958b\u3059\u308b\nPiP_i\u306f\u30bc\u30ed\u77e5\u8b58\u8a3c\u660e\u3067log\u03b1\u03b2i=logerer\u22121\\log_\\alpha{\\beta_i} = \\log_{e_r}{e_{r-1}}\u3092\u8a3c\u660e\u3059\u308b\u3002\u3053\u308c\u306fChaum-Pedersen\u306e\u8a3c\u660e\u3092\u7528\u3044\u3066\u52b9\u679c\u7684\u306b\u884c\u3048\u308b\n\n\nPuP_u\u306fen=(en\u22121)K\u22121ue_n = (e_{n-1})^{K_u^{-1}}\u3092\u8a08\u7b97\u3059\u308b\n\u5c71\u672d\u304b\u3089\u629c\u3044\u305f\u30ab\u30fc\u30c9x\u2208Xx \\in X\u306fdn,j=(en)xd_{n,j} = (e_n)^x\u3092\u6e80\u3059\nPuP_u\u306fxx\u3092\u30ab\u30fc\u30c9\u3068\u3057\u3066\u5f97\u308b\n\n\n\u30ab\u30fc\u30c9\u306e\u516c\u958b\uff08Protocol 50\uff09\n\u307e\u305a\u3001\u30d7\u30ec\u30a4\u30e4\u30fcPuP_u\u306f\u5c71\u672d\u306ejj\u756a\u76ee\u306e\u30ab\u30fc\u30c9cn,jc_{n,j}\u3092\u30c9\u30ed\u30fc\u3059\u308b\u3068\u304d\u3001 Protocol 49 \u3067\u30d7\u30ec\u30a4\u30e4\u30fcPnP_n\u304b\u3089en\u22121e_{n-1}\u3092\u5f97\u3066\u3044\u308b\u3068\u4eee\u5b9a\u3059\u308b\u3068\u3001en\u22121e_{n-1}\u304c Protocol 49 \u306e\u9593\u306b\u5f97\u3089\u308c\u3066\u3044\u3066\u3001\u304b\u3064\u30ab\u30fc\u30c9\u304cPuP_u\u306e\u30cf\u30f3\u30c9\u306e\u4e2d\u306b\u3042\u308b\u3053\u3068\u304c\u660e\u3089\u304b\u306b\u306a\u308a\u307e\u3059\u3002\n\n\u30d7\u30ec\u30a4\u30e4\u30fcPuP_u\u306fen=(en\u22121)K\u22121ue_n = (e_{n-1})^{K_u^{-1}}\u3092\u516c\u958b\u3059\u308b\n\u30bc\u30ed\u77e5\u8b58\u8a3c\u660e\u3067logenen\u22121=log\u03b1\u03b2u\\log_{e_n}{e_{n-1}} = \\log_\\alpha{\\beta_u}\u3092\u8a3c\u660e\u3059\u308b\u3002\u3053\u308c\u306fChaum-Pedersen\u306e\u8a3c\u660e\u3092\u7528\u3044\u3066\u52b9\u679c\u7684\u306b\u884c\u3048\u308b\n\n\u5168\u3066\u306e\u30d7\u30ec\u30a4\u30e4\u30fc\u306fdn,j=(en)xd_{n,j} = (e_n)^x\u3092\u6e80\u3059x\u2208Xx \\in X\u3092\u691c\u8a3c\u3067\u304d\u307e\u3059\u3002\n\n\u30ab\u30fc\u30c9\u3092\u6368\u3066\u308b\n\u6368\u3066\u308b\u5834\u5408\u306f\u4ed6\u306e\u30d7\u30ec\u30a4\u30e4\u30fc\u5168\u54e1\u306b\u30ab\u30fc\u30c9cn,jc_{n,j}\u3092\u6368\u3066\u305f\u3053\u3068\u3092\u544a\u77e5\u3057\u307e\u3059\u3002\n\nMental Mahjong\u3078\n\u3044\u304f\u3064\u304b\u306e\u554f\u984c\u304c\u3042\u308a\u307e\u3059\u3002\n\n\u30cf\u30f3\u30c9\u3092\u516c\u958b\u3059\u308b\u969b\u306b\u3001\u3069\u306e\u30cf\u30f3\u30c9\u3092\u5c71\u672d\u306e\u4f55\u756a\u76ee\u304b\u3089\u30c9\u30ed\u30fc\u3057\u305f\u306e\u304b\u516c\u958b\u3059\u308b\u5fc5\u8981\u304c\u3042\u308b\n\n\n\u53c2\u8003\n\u3053\u306e\u30d7\u30ed\u30c8\u30b3\u30eb\u3067\u4f7f\u308f\u308c\u3066\u3044\u308b\u6280\u8853\u306b\u3064\u3044\u3066\u3001\u3055\u3089\u306b\u7d30\u304b\u304f\u8abf\u3079\u305f\u3082\u306e\u3067\u3059\u3002\n\n\u5b89\u5168\u7d20\u6570\u3068\u3079\u304d\u4e57\u3068\u9006\u5143\nChaum-Pedersen\u306e\u8a3c\u660e\n\n_\u516c\u5e73\u306a\u7b2c\u4e09\u8005\u306a\u3057\u306b\u30d7\u30ec\u30a4\u30e4\u30fc\u306e\u60c5\u5831\u79d8\u5bc6\u3092\u4fdd\u3064Mental Poker\u306e\u30d7\u30ed\u30c8\u30b3\u30eb_ \u3068\u3044\u3046\u65b9\u6cd5\u304c[Contribution to Mental Poker](http://www.tdx.cat/bitstream/handle/10803/5804/jcr1de1.pdf)\u3068\u3044\u3046\u672c\u306eChapter 6\u3067\u7d39\u4ecb\u3055\u308c\u3066\u3044\u307e\u3059\u3002\u3053\u308c\u306b\u3064\u3044\u3066\u8aad\u3093\u3067\u5206\u304b\u3063\u305f\u3053\u3068\u3092\u307e\u3068\u3081\u307e\u3059\u3002\n\u307e\u305f\u3001\u3053\u308c\u3092\u3082\u3068\u306bPython\u3068[Charm-Crypt](http://www.charm-crypto.com/Main.html)\u3092\u7528\u3044\u3066\u66f8\u3044\u305f\u30b3\u30fc\u30c9\u304c\u4e0b\u8a18\u306eGist\u306b\u3042\u308a\u307e\u3059\u3002\nhttps://gist.github.com/yoshimuraYuu/d8897e9dce479b620606\n\n# \u3084\u308a\u305f\u3044\u3053\u3068\n\n- TTP\uff08 _Trusted Third Party_ \uff09\u3092\u5fc5\u8981\u3068\u3057\u306a\u3044\n- \u30d7\u30ec\u30a4\u30e4\u30fc\u306e\u6226\u7565\u306e\u79d8\u5bc6\u6027\u304c\u3042\u308b\n\n# \u30d7\u30ed\u30c8\u30b3\u30eb\n_Protocol_ \u3084 _Procedure_ \u306e\u6570\u5b57\u306f\u3082\u3068\u306b\u306a\u3063\u305fContribution to Mental Poker\u306b\u4f75\u305b\u3066\u3044\u308b\u306e\u3067\u3001\u5999\u306a\u756a\u53f7\u304b\u3089\u59cb\u307e\u308a\u307e\u3059\u304c\u6c17\u306b\u3059\u308b\u5fc5\u8981\u306f\u3042\u308a\u307e\u305b\u3093\u3002\n\n## \u6e96\u5099\n\n\u307e\u305a\u3001\u6b21\u306e\u5185\u5bb9\u306f\u5168\u3066\u306e\u30d7\u30ec\u30a4\u30e4\u30fc\u306e\u9593\u306e\u4e2d\u3067\u5171\u901a\u306e\u3082\u306e\u3092\u7528\u3044\u307e\u3059\u3002\n\n- \u30d7\u30ec\u30a4\u30e4\u30fc\u306f$P_1$\u304b\u3089$P_n$\u307e\u3067\u306e$n$\u4eba\n- $p = 2q + 1 \\wedge q > 2$\u3068\u306a\u308b\u3088\u3046\u306a\u7d20\u6570$p, q$\n- [\u539f\u59cb\u5143](http://akademeia.info/index.php?%B8%B6%BB%CF%B8%B5)$\\alpha$\uff08\u3053\u306e$\\alpha$\u306f$p$\u3068[\u5e73\u65b9\u975e\u5270\u4f59](http://ja.wikipedia.org/wiki/%E5%B9%B3%E6%96%B9%E5%89%B0%E4%BD%99)\uff09\n- \u30d1\u30e9\u30e1\u30fc\u30bf\u30fc$s$\n- \u4f7f\u7528\u3059\u308b\u30ab\u30fc\u30c9\u306f$52$\u679a\n- $X = x_1, \\dots, x_i, \\dots, x_{52}$\uff08\u305f\u3060\u3057$2 < x_i < q$\u304b\u3064$x_i$\u306f\u5947\u6570\uff09\n\n\u305d\u3057\u3066\u3001\u30d7\u30ec\u30a4\u30e4\u30fc$P_i$\u306f\u6b21\u306e\u3088\u3046\u306a\u8a08\u7b97\u3092\u3057\u307e\u3059\u3002\n\n1. $2 < K_i < q$\u3068\u306a\u308b\u4efb\u610f\u306e\u5947\u6570\u3092\u30d7\u30ec\u30a4\u30e4\u30fc$P_i$\u306e\u79d8\u5bc6\u9375$K_i$\u3068\u3059\u308b\n2. $\\beta_i = \\alpha^{K_i}$\u3068\u306a\u308b$\\beta_i$\u3092\u4ed6\u306e\u30d7\u30ec\u30a4\u30e4\u30fc\u306b\u516c\u958b\u3059\u308b\n3. $\\beta = \\alpha^{K_1, \\dots, K_n}$\u3068\u306a\u308b$\\beta$\u3092\u3001$K_i$\u3092\u516c\u958b\u3059\u308b\u3053\u3068\u306a\u304f\u5171\u6709\u3059\u308b\uff08\u3053\u306e\u5171\u6709\u306b\u306f[Diffie-Hellman\u9375\u4ea4\u63db](http://crypto.stackexchange.com/questions/1025/can-one-generalize-the-diffie-hellman-key-exchange-to-three-or-more-parties)\u3092\u4f7f\u3044\u307e\u3059\uff09\n\n## \u30ab\u30fc\u30c9\u306e\u30b7\u30e3\u30c3\u30d5\u30eb\n\n\u76f4\u611f\u7684\u306a\u30a4\u30e1\u30fc\u30b8\u306f\u5168\u3066\u306e\u30d7\u30ec\u30a4\u30e4\u30fc\u304c\u88cf\u306b\u3057\u305f\u5c71\u672d\u3092\u9806\u306b\u30b7\u30e3\u30c3\u30d5\u30eb\u3057\u3066\u3086\u304f\u3088\u3046\u306a\u611f\u3058\u3067\u3059\u3002\n\n### \u30b7\u30e3\u30c3\u30d5\u30eb\u306e\u6e96\u5099\n\n\u307e\u305a\u3001\u3053\u3053\u3067\u6b21\u306e\u3088\u3046\u306a\u521d\u671f\u306e\u5c71\u672d$C_0$\u3092\u30bb\u30c3\u30c8\u3057\u307e\u3059\u3002\n\n```math\nC_0 = c_{0, 1}, \\dots, c_{0, 52} \\\\\nwhere\\, c_{0,j} = (d_{0,j}, \\alpha_{0,j}) = (\\alpha^{x_j}, \\beta)\n```\n\n\u3053\u3053\u3067\u3001\u3044\u304b\u306a\u308b$\\alpha^{x_j}$\u3082\u5e73\u65b9\u975e\u5270\u4f59\u3067\u3059\u3002\n\n\u305d\u306e\u5f8c\u3001\u30d7\u30ec\u30a4\u30e4\u30fc$P_i$\u306f\u5c71\u672d$C_{i-1}$\u3092\u5f97\u3066\u5c71\u672d$C_i$\u3092\u751f\u6210\u3057\u307e\u3059\u3002\u30b7\u30e3\u30c3\u30d5\u30eb\u3092$P_1$\u304b\u3089$P_n$\u307e\u3067\u9806\u756a\u306b\u5b9f\u884c\u3057\u3066\u3001\u6700\u5f8c\u306b$P_n$\u304c\u751f\u6210\u3057\u305f\u5c71\u672d$C_n$\u304c\u6700\u7d42\u7684\u306a\u5c71\u672d\u3068\u306a\u308a\u307e\u3059\u3002\n\n### \u30b7\u30e3\u30c3\u30d5\u30eb\u306e\u624b\u9806\uff08Protocol 47\uff09\n\n1. \u30d7\u30ec\u30a4\u30e4\u30fc$P_i$\u306f\u3001\u4e00\u3064\u524d\u306e\u30d7\u30ec\u30a4\u30e4\u30fc$P_{i-1}$\u304c\u8a08\u7b97\u3057\u305f\u5c71\u672d$C_{i-1}$\u304b\u3089 _Procedure 32_ \u3092\u7528\u3044\u3066$C_i, R_i, \\pi_i$\u3092\u8a08\u7b97\u3059\u308b\n2. _Protocol 48_ \u3092\u7528\u3044\u3066\u3001\u4e00\u3064\u524d\u306e\u30d7\u30ec\u30a4\u30e4\u30fc$P_{i-1}$\u304c\u8a08\u7b97\u3057\u305f$C_{i-1}$\u304c\u59a5\u5f53\u304b\u691c\u67fb\n3. $C_i$\u3092\u5168\u3066\u306e\u30d7\u30ec\u30a4\u30e4\u30fc\u3078\u516c\u958b\u3059\u308b\n\n### \u5c71\u672d\u306e\u4e26\u3073\u306e\u5165\u624b\uff08Procedure 32\uff09\n\n\u307e\u305a\u30d7\u30ec\u30a4\u30e4\u30fc$P_i$\u306f\u524d\u306e\u30d7\u30ec\u30a4\u30e4\u30fc$P_{i-1}$\u304c\u751f\u6210\u3057\u305f\u5c71\u672d$C_{i-1} = c_1, \\dots, c_{52}$\uff08\u305f\u3060\u3057$c_j = (d_j, \\alpha_j)$\uff09\u3092\u7528\u3044\u3066\u6b21\u306e\u3088\u3046\u306b\u30b7\u30e3\u30c3\u30d5\u30eb\u3092\u884c\u3044\u307e\u3059\u3002\n\n#### \u53d7\u3051\u53d6\u308b\u60c5\u5831\n\n- \u5c71\u672d$C$\n\n#### \u624b\u9806\n\n1. $R = r_1, \\dots, r_{52}$\u3068\u3044\u3046$R$\u3092\u751f\u6210\u3059\u308b\uff08\u305f\u3060\u3057$r_j = 2 < r_j < q$\u3092\u6e80\u3059\u30e9\u30f3\u30c0\u30e0\u306a\u5947\u6570\uff09\n2. $c_j' = (d_j^{r_j}, \\alpha_j^{r_j})$\u3092$j = 1 \\dots 52$\u306b\u3064\u3044\u3066\u8a08\u7b97\u3059\u308b\uff08\u305f\u3060\u3057$j$\u306f$C$\u306e$j$\u756a\u76ee\uff09\n3. $1, 2, \\dots, 52$\u3092\u30e9\u30f3\u30c0\u30e0\u306b\u4e26\u3079\u305f\u9806\u5e8f$\\pi$\u3092\u751f\u6210\u3059\u308b\n4. $C^* = c_{\\pi(1)}', \\dots, c_{\\pi(52)}'$\u3068\u3044\u3046$C^*$\u3092\u5f97\u308b\n5. $C^*, R, \\pi$\u3092\u8fd4\u3059\n\n### \u5c71\u672d\u306e\u30b7\u30e3\u30c3\u30d5\u30eb\u3068\u691c\u8a3c\uff08Protocol 48\uff09\n\n\u30d7\u30ec\u30a4\u30e4\u30fc$P_i$\u304c\u5c71\u672d$C_{i-1}$\u3092\u5165\u624b\u3057\u3066\u3082\u3001\u524d\u306e\u30d7\u30ec\u30a4\u30e4\u30fc$P_{i-1}$\u304c\u304d\u3061\u3093\u3068\u5c71\u672d$C_{i-1}$\u3092\u8a08\u7b97\u3057\u305f\u306e\u304b\u691c\u8a3c\u3057\u3066\u3001\u81ea\u8eab\u3082 _Procedure 32_ \u3067\u5c71\u672d$C_i$\u3092\u8a08\u7b97\u3057\u307e\u3059\u3002\n\u305f\u3060\u3057\u3001\u691c\u8a3c\u306e\u969b\u306b\u5c71\u672d\u306e\u4e2d\u5473\u304c\u5206\u3063\u3066\u3057\u307e\u3046\u3068\u516c\u5e73\u306a\u30b2\u30fc\u30e0\u306b\u306a\u3089\u306a\u3044\u306e\u3067\u3001 _Procedure 32_ \u3067\u751f\u6210\u3057\u305f\u60c5\u5831$R$\u3092\u7528\u3044\u3066\u78ba\u7387\u7684\u306b\u691c\u8a3c\u3092\u884c\u3044\u307e\u3059\u3002\n\n#### \u53d7\u3051\u53d6\u308b\u60c5\u5831\n\n- \u524d\u306e\u30d7\u30ec\u30a4\u30e4\u30fc$P_{i-1}$\u306e\u5c71\u672d$C_{i-1}$\n- \u8a08\u7b97\u3057\u3066\u3044\u308b\u30d7\u30ec\u30a4\u30e4\u30fc$P_i$\u306e\u5c71\u672d$C_i$\n- \u60c5\u5831$R_i$\n- \u9806\u5e8f$\\pi_i$\n- \u30d1\u30e9\u30e1\u30fc\u30bf\u30fc$s$\n\n#### \u624b\u9806\n\n1. \u30d7\u30ec\u30a4\u30e4\u30fc$P_i$\u306f$C_{i,k}, R_{i,k}, \\pi_{i,k} = \\mathit{Procedure\\, 32}(C_i)$\u3092\u5f97\u3066\u3001$C_{i,k}$\u3092\u4ed6\u306e\u30d7\u30ec\u30a4\u30e4\u30fc\u3078\u516c\u958b\u3059\u308b\uff08$k$\u306f$1$\u304b\u3089$s$\uff09\n2. $P_i$\u4ee5\u5916\u306e\u30d7\u30ec\u30a4\u30e4\u30fc\u306f$s$\u6841\u306e\u30e9\u30f3\u30c0\u30e0\u306a\u30d3\u30c3\u30c8\u5217$U = u_i, \\dots, u_s$\u3092$P_i$\u3078\u9001\u308b\n3. \u9001\u3089\u308c\u3066\u304d\u305f$u_k \\in U$\u306b\u3064\u3044\u3066\n  - $u_k = 1$\u306a\u3089\u3070\n      1. \u30d7\u30ec\u30a4\u30e4\u30fc$P_i$\u306f$R_{i,k}, \\pi_{i,k}$\u3092\u516c\u958b\u3059\u308b\n      2. \u4ed6\u306e\u30d7\u30ec\u30a4\u30e4\u30fc\u306f _Procedure 33_ \u3067$C_i, C_{i,k}$\u3092\u691c\u8a3c\u3059\u308b\n  - $u_k = 0$\u306a\u3089\u3070\n      1. \u30d7\u30ec\u30a4\u30e4\u30fc$P_i$\u306f$\\pi_{i,k}' = \\pi_{i,k} \\circ \\pi_i$\u3068$R_{i,k}' = r_{i,k,1}', \\dots, r_{i,k,52}'$\u3092\u5f97\u308b\uff08\u305f\u3060\u3057\u3001$r_{i,k,j} = r_{i, \\pi_{i,k}'^{-1}(j))} \\cdot r_{i, k, \\pi_{i,k}(j)}$\uff09\n      2. \u30d7\u30ec\u30a4\u30e4\u30fc$P_i$\u306f$R_{i,k}', \\pi_{i,k}'$\u3092\u516c\u958b\u3059\u308b\n      3. \u4ed6\u306e\u30d7\u30ec\u30a4\u30e4\u30fc\u306f _Procedure 33_ \u3067$C_{i-1}, C_{i,k}$\u3092\u691c\u8a3c\u3059\u308b\n\n### \u5c71\u672d\u306e\u691c\u8a3c\uff08Procedure 33\uff09\n\n#### \u53d7\u3051\u53d6\u308b\u60c5\u5831\n\n- \u5c71\u672d$C_a$\n- \u5c71\u672d$C_b$\n- \u60c5\u5831$R$\n- \u9806\u5e8f$\\pi$\n\n#### \u624b\u9806\n\n\u5c71\u672d$C_a$\u3068\u5c71\u672d$C_b$\u306b\u3064\u3044\u3066\u3001\u60c5\u5831$R$\u3068\u9806\u5e8f$\\pi$\u304c\u304d\u3061\u3093\u3068\u5bfe\u5fdc\u3057\u3066\u3044\u308b\u306e\u304b\u3092\u5c71\u672d\u3092\u5148\u982d\u304b\u3089\u6700\u5f8c\u307e\u3067\u4e00\u679a\u305a\u3064\u691c\u67fb\u3057\u307e\u3059\u3002$j$\u3092\u5c71\u672d\u304b\u3089$j$\u756a\u76ee\u306e\u30ab\u30fc\u30c9\u3068\u3057\u307e\u3059\u3002\uff08\u3064\u307e\u308a$1 \\le j \\le 52$\uff09\n\n1. $c_{b,j} = (d_{d,j}, \\alpha_{b,j}) \\in C_b$\u3068\u3057\u3001\u307e\u305f$c_{a,\\pi(j)} = (d_{a,\\pi(j)}, \\alpha_{a, \\pi(j)}) \\in C_a$\u3068\u3059\u308b\n2. $d_{b,j} = (d_{a,\\pi(j)})^{r_{\\pi(j)}}$\u304b\u3069\u3046\u304b\u691c\u67fb\u3059\u308b\n3. $\\alpha_{b,j} = (\\alpha_{a, \\pi(j)})^{r_{\\pi(j)}}$\u304b\u3069\u3046\u304b\u691c\u67fb\u3059\u308b\n\n## \u30ab\u30fc\u30c9\u306e\u30c9\u30ed\u30fc\uff08Protocol 49\uff09\n\n\u4e0d\u6b63\u306e\u7121\u3055\u3092[\u30bc\u30ed\u77e5\u8b58\u8a3c\u660e](http://ja.wikipedia.org/wiki/%E3%82%BC%E3%83%AD%E7%9F%A5%E8%AD%98%E8%A8%BC%E6%98%8E)\u3067\u793a\u3057\u307e\u3059\u3002\n\n1. \u30d7\u30ec\u30a4\u30e4\u30fc$P_u$\u306f\u3001\u307e\u3060\u8ab0\u3082\u30c9\u30ed\u30fc\u3057\u3066\u3044\u306a\u3044\u5c71\u672d$C_n$\u306e$j$\u756a\u76ee\u3092\u9078\u3073\u3001\u305d\u306e\u30ab\u30fc\u30c9\u3092$c_{n,j} = (d_{n,j}, \\alpha_{n,j})$\u3068\u3059\u308b\n2. $P_u$\u306f$e_0 = \\alpha_{n,j}$\u3092\u516c\u958b\u3057\u3001$r = 0$\u3068\u3059\u308b\n3. $i = 1, 2, \\dots, u - 1, u + 1, \\dots, n$\u3068\u3044\u3046$i$\u306b\u3064\u3044\u3066\u3001\n  1. $r = r + 1$\u3068\u3059\u308b\n  2. $P_i$\u306f$e_r = (e_{r-1})^{K_i^{-1}}$\u3092\u516c\u958b\u3059\u308b\n  3. $P_i$\u306f\u30bc\u30ed\u77e5\u8b58\u8a3c\u660e\u3067$\\log_\\alpha{\\beta_i} = \\log_{e_r}{e_{r-1}}$\u3092\u8a3c\u660e\u3059\u308b\u3002\u3053\u308c\u306f[Chaum-Pedersen\u306e\u8a3c\u660e](http://www.cs.elte.hu/~rfid/chaum_pedersen.pdf)\u3092\u7528\u3044\u3066\u52b9\u679c\u7684\u306b\u884c\u3048\u308b\n4. $P_u$\u306f$e_n = (e_{n-1})^{K_u^{-1}}$\u3092\u8a08\u7b97\u3059\u308b\n5. \u5c71\u672d\u304b\u3089\u629c\u3044\u305f\u30ab\u30fc\u30c9$x \\in X$\u306f$d_{n,j} = (e_n)^x$\u3092\u6e80\u3059\n6. $P_u$\u306f$x$\u3092\u30ab\u30fc\u30c9\u3068\u3057\u3066\u5f97\u308b\n\n## \u30ab\u30fc\u30c9\u306e\u516c\u958b\uff08Protocol 50\uff09\n\n\u307e\u305a\u3001\u30d7\u30ec\u30a4\u30e4\u30fc$P_u$\u306f\u5c71\u672d\u306e$j$\u756a\u76ee\u306e\u30ab\u30fc\u30c9$c_{n,j}$\u3092\u30c9\u30ed\u30fc\u3059\u308b\u3068\u304d\u3001 _Protocol 49_ \u3067\u30d7\u30ec\u30a4\u30e4\u30fc$P_n$\u304b\u3089$e_{n-1}$\u3092\u5f97\u3066\u3044\u308b\u3068\u4eee\u5b9a\u3059\u308b\u3068\u3001$e_{n-1}$\u304c _Protocol 49_ \u306e\u9593\u306b\u5f97\u3089\u308c\u3066\u3044\u3066\u3001\u304b\u3064\u30ab\u30fc\u30c9\u304c$P_u$\u306e\u30cf\u30f3\u30c9\u306e\u4e2d\u306b\u3042\u308b\u3053\u3068\u304c\u660e\u3089\u304b\u306b\u306a\u308a\u307e\u3059\u3002\n\n1. \u30d7\u30ec\u30a4\u30e4\u30fc$P_u$\u306f$e_n = (e_{n-1})^{K_u^{-1}}$\u3092\u516c\u958b\u3059\u308b\n2. \u30bc\u30ed\u77e5\u8b58\u8a3c\u660e\u3067$\\log_{e_n}{e_{n-1}} = \\log_\\alpha{\\beta_u}$\u3092\u8a3c\u660e\u3059\u308b\u3002\u3053\u308c\u306f[Chaum-Pedersen\u306e\u8a3c\u660e](http://www.cs.elte.hu/~rfid/chaum_pedersen.pdf)\u3092\u7528\u3044\u3066\u52b9\u679c\u7684\u306b\u884c\u3048\u308b\n\n\u5168\u3066\u306e\u30d7\u30ec\u30a4\u30e4\u30fc\u306f$d_{n,j} = (e_n)^x$\u3092\u6e80\u3059$x \\in X$\u3092\u691c\u8a3c\u3067\u304d\u307e\u3059\u3002\n\n## \u30ab\u30fc\u30c9\u3092\u6368\u3066\u308b\n\n\u6368\u3066\u308b\u5834\u5408\u306f\u4ed6\u306e\u30d7\u30ec\u30a4\u30e4\u30fc\u5168\u54e1\u306b\u30ab\u30fc\u30c9$c_{n,j}$\u3092\u6368\u3066\u305f\u3053\u3068\u3092\u544a\u77e5\u3057\u307e\u3059\u3002\n\n# Mental Mahjong\u3078\n\n\u3044\u304f\u3064\u304b\u306e\u554f\u984c\u304c\u3042\u308a\u307e\u3059\u3002\n\n- \u30cf\u30f3\u30c9\u3092\u516c\u958b\u3059\u308b\u969b\u306b\u3001\u3069\u306e\u30cf\u30f3\u30c9\u3092\u5c71\u672d\u306e\u4f55\u756a\u76ee\u304b\u3089\u30c9\u30ed\u30fc\u3057\u305f\u306e\u304b\u516c\u958b\u3059\u308b\u5fc5\u8981\u304c\u3042\u308b\n\n# \u53c2\u8003\n\n\u3053\u306e\u30d7\u30ed\u30c8\u30b3\u30eb\u3067\u4f7f\u308f\u308c\u3066\u3044\u308b\u6280\u8853\u306b\u3064\u3044\u3066\u3001\u3055\u3089\u306b\u7d30\u304b\u304f\u8abf\u3079\u305f\u3082\u306e\u3067\u3059\u3002\n\n- [\u5b89\u5168\u7d20\u6570\u3068\u3079\u304d\u4e57\u3068\u9006\u5143](http://qiita.com/_yyu_/items/6c099ba0480f8fea6513)\n- [Chaum-Pedersen\u306e\u8a3c\u660e](http://qiita.com/_yyu_/items/b2277fceefc5359e591a)\n", "tags": ["MentalPoker", "Python", "Cryptocurrency"]}