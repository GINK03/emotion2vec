{"context": " More than 1 year has passed since last update.\n\nGLib \u306e g_utf8_to_ucs4_fast() \u3092\u3064\u304b\u3046\nUTF-8 \u306e\u6587\u5b57\u5217\u304b\u3089 Unicode \u306e\u30b3\u30fc\u30c9\u30dd\u30a4\u30f3\u30c8\u3092\u53d6\u5f97\u3059\u308b\u306b\u306f\u3001UTF-8 \u3092 UTF-32 (UCS4) \u306b\u5909\u63db\u3057\u3066\u3042\u3052\u308c\u3070\u826f\u3044\u3002\niconv(3) \u3092\u3064\u304b\u3063\u3066\u3082\u3044\u3044\u3051\u3069\u3001GLib \u306b g_utf8_to_ucs4_fast() \u3068\u3044\u3046\u305d\u306e\u3082\u306e\u30ba\u30d0\u30ea\u306a\u95a2\u6570\u304c\u3042\u3063\u305f\u306e\u3067\u305d\u308c\u3092\u4f7f\u3063\u3066\u3084\u3063\u3066\u307f\u305f\u3002\n\n\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\n\nutf8_to_codepoint.c\n#include <stdio.h>\n#include <glib.h>\n\nint main (int argc, char* argv[]) {\n\n  // \u5f15\u304d\u6570\u304c\u6e21\u3055\u308c\u3066\u306a\u304b\u3063\u305f\u3089\u7d42\u4e86\n  if (argc < 2) {\n    fprintf(stderr, \"usage: %s text\\n\", argv[0]);\n    return 1;\n  }\n\n  // \u5f15\u304d\u6570\u3068\u3057\u3066\u6e21\u3055\u308c\u305f\u6587\u5b57\u5217\u3092\u4ee3\u5165\n  char* utf8_text = argv[1];\n\n  // \u30c6\u30ad\u30b9\u30c8\u306e\u6587\u5b57\u6570\u3092\u53d6\u5f97\n  glong length = g_utf8_strlen(utf8_text, -1);\n\n  // UCS4\u306b\u5909\u63db\n  gunichar* codepoints = g_utf8_to_ucs4_fast(utf8_text, -1, NULL); \n\n  // 1\u6587\u5b57\u3065\u3064 code point \u3092\u51fa\u529b\n  for (int i = 0; i < length; i++) {\n    printf(\"[U+%04X] \", codepoints[i]);\n  }\n  printf(\"\\n\");\n\n  // \u7d42\u4e86\u51e6\u7406\n  g_free(codepoints);\n  return 0;\n}\n\n\n\n\u30e1\u30a4\u30f3\u306e\u90e8\u5206\u306f\u4e0b\u8a18\u306b\u306a\u308a\u307e\u3059\u3002\n// UCS4\u306b\u5909\u63db\ngunichar* codepoints = g_utf8_to_ucs4_fast(utf8_text, -1, NULL); \n\n\n\u30b3\u30f3\u30d1\u30a4\u30eb\uff08OS X \u306e\u5834\u5408\uff09\n\nglib \u304c\u5165\u3063\u3066\u306a\u304b\u3063\u305f\u3089 brew \u3067\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n$ brew install glib\n\n\n\u30b3\u30f3\u30d1\u30a4\u30eb\u3057\u307e\u3059\n$ gcc -Wall -I/usr/local/include/glib-2.0 -I/usr/local/lib/glib-2.0/include -lglib-2.0 -o utf8_to_codepoint utf8_to_codepoint.c\n\n\n\u7d50\u679c\n$ ./utf8_to_codepoint \"UTF-8\u306e\u6587\u5b57\u5217\u3092\u5909\u63db\"\n[U+0055] [U+0054] [U+0046] [U+002D] [U+0038] [U+306E] [U+6587] [U+5B57] [U+5217] [U+3092] [U+5909] [U+63DB] \n\n\u7121\u4e8b\u3001Unicode \u306e\u30b3\u30fc\u30c9\u30dd\u30a4\u30f3\u30c8\u304c\u53d6\u5f97\u3067\u304d\u307e\u3057\u305f\u3002\n\u2193\u30b5\u30ed\u30b2\u30fc\u30c8\u30da\u30a2\u3082OK\n$ ./utf8_to_codepoint \"????\"\n[U+2000B] [U+2123D] [U+2131B] [U+2146E] \n\n\ng_utf8_to_ucs4_fast() \u306b\u3064\u3044\u3066\n\n\n\u66f8\u5f0f\n#include <glib.h>\n\ngunichar* g_utf8_to_ucs4_fast(const gchar *str,\n                              glong len,\n                              glong *items_written);\n\n\n\u8aac\u660e\n\u6709\u52b9\u306aUTF-8\u306e\u5165\u529b\u3092\u60f3\u5b9a\u3057\u3066\u3001UTF-8\u6587\u5b57\u5217\u304b\u308932\u30d3\u30c3\u30c8\u56fa\u5b9a\u5e45\u306e UCS-4\u306b\u5909\u63db\u3057\u307e\u3059\u3002\u3053\u306e\u6a5f\u80fd\u306f\u3001g_utf8_to_ucs4() \u3088\u308a\u7d042\u500d\u306e\u51e6\u7406\u901f\u5ea6\u3067\u3059\u304c\u3001\u5165\u529b\u5024\u306e\u30a8\u30e9\u30fc\u30c1\u30a7\u30c3\u30af\u3092\u3057\u307e\u305b\u3093\u3002\u5909\u63db\u3055\u308c\u305f\u6587\u5b57\u5217\u306e\u672b\u5c3e\u306b'\\0'\u304c\u8ffd\u52a0\u3055\u308c\u307e\u3059\u3002\nstr :\u3000UTF-8 \u3067\u30a8\u30f3\u30b3\u30fc\u30c7\u30a3\u30f3\u30b0\u3055\u308c\u305f\u6587\u5b57\u5217\u3002\nlen :\u3000str \u306e\u6709\u52b9\u9577\u3068\u3057\u3066\u4f7f\u7528\u30020 \u4ee5\u4e0b\u306e\u5834\u5408\u306f\u3001\u6587\u5b57\u5217\u306e\u6709\u52b9\u9577\u306f\u30cc\u30eb\u6587\u5b57\u307e\u3067\u3068\u306a\u308a\u307e\u3059\u3002\nitems_written :\u3000\u7d50\u679c\u3092\u30b9\u30c8\u30a2\u3059\u308b\u30dd\u30a4\u30f3\u30bf\u304b NULL \u3092\u6307\u5b9a\u3002\uff08\u7701\u7565\u53ef\uff09\n\u623b\u308a\u5024  :\u3000\u65b0\u3057\u304f\u5272\u308a\u5f53\u3066\u3089\u308c\u305f UCS-4 \u6587\u5b57\u5217\u3078\u306e\u30dd\u30a4\u30f3\u30bf\u3002\u3053\u306e\u5024\u306f\u3001g_free() \u3067\u958b\u653e\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\n\n\n\u53c2\u8003\n\ng_utf8_to_ucs4()\n\u8d85\u521d\u5fc3\u8005\u306e\u305f\u3081\u306e Unicode\uff08\u30e6\u30cb\u30b3\u30fc\u30c9\uff09 \u5165\u9580\nUTF-32 (UCS4) - Wikipedia\n\n\u4ee5\u4e0a\u3002\n\n## [GLib](https://developer.gnome.org/glib/stable/) \u306e `g_utf8_to_ucs4_fast()` \u3092\u3064\u304b\u3046\n\nUTF-8 \u306e\u6587\u5b57\u5217\u304b\u3089 Unicode \u306e\u30b3\u30fc\u30c9\u30dd\u30a4\u30f3\u30c8\u3092\u53d6\u5f97\u3059\u308b\u306b\u306f\u3001UTF-8 \u3092 UTF-32 (UCS4) \u306b\u5909\u63db\u3057\u3066\u3042\u3052\u308c\u3070\u826f\u3044\u3002\n\n`iconv(3)` \u3092\u3064\u304b\u3063\u3066\u3082\u3044\u3044\u3051\u3069\u3001GLib \u306b [`g_utf8_to_ucs4_fast()`](https://developer.gnome.org/glib/stable/glib-Unicode-Manipulation.html#g-utf8-to-ucs4-fast) \u3068\u3044\u3046\u305d\u306e\u3082\u306e\u30ba\u30d0\u30ea\u306a\u95a2\u6570\u304c\u3042\u3063\u305f\u306e\u3067\u305d\u308c\u3092\u4f7f\u3063\u3066\u3084\u3063\u3066\u307f\u305f\u3002\n\n## \u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\n\n```c:utf8_to_codepoint.c\n#include <stdio.h>\n#include <glib.h>\n\nint main (int argc, char* argv[]) {\n\n  // \u5f15\u304d\u6570\u304c\u6e21\u3055\u308c\u3066\u306a\u304b\u3063\u305f\u3089\u7d42\u4e86\n  if (argc < 2) {\n    fprintf(stderr, \"usage: %s text\\n\", argv[0]);\n    return 1;\n  }\n  \n  // \u5f15\u304d\u6570\u3068\u3057\u3066\u6e21\u3055\u308c\u305f\u6587\u5b57\u5217\u3092\u4ee3\u5165\n  char* utf8_text = argv[1];\n  \n  // \u30c6\u30ad\u30b9\u30c8\u306e\u6587\u5b57\u6570\u3092\u53d6\u5f97\n  glong length = g_utf8_strlen(utf8_text, -1);\n\n  // UCS4\u306b\u5909\u63db\n  gunichar* codepoints = g_utf8_to_ucs4_fast(utf8_text, -1, NULL); \n \n  // 1\u6587\u5b57\u3065\u3064 code point \u3092\u51fa\u529b\n  for (int i = 0; i < length; i++) {\n    printf(\"[U+%04X] \", codepoints[i]);\n  }\n  printf(\"\\n\");\n\n  // \u7d42\u4e86\u51e6\u7406\n  g_free(codepoints);\n  return 0;\n}\n\n```\n\n\u30e1\u30a4\u30f3\u306e\u90e8\u5206\u306f\u4e0b\u8a18\u306b\u306a\u308a\u307e\u3059\u3002\n\n```c\n// UCS4\u306b\u5909\u63db\ngunichar* codepoints = g_utf8_to_ucs4_fast(utf8_text, -1, NULL); \n```\n\n\n## \u30b3\u30f3\u30d1\u30a4\u30eb\uff08OS X \u306e\u5834\u5408\uff09\n### glib \u304c\u5165\u3063\u3066\u306a\u304b\u3063\u305f\u3089 `brew` \u3067\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n```bash\n$ brew install glib\n```\n\n### \u30b3\u30f3\u30d1\u30a4\u30eb\u3057\u307e\u3059\n\n```bash\n$ gcc -Wall -I/usr/local/include/glib-2.0 -I/usr/local/lib/glib-2.0/include -lglib-2.0 -o utf8_to_codepoint utf8_to_codepoint.c\n```\n\n## \u7d50\u679c\n\n```bash\n$ ./utf8_to_codepoint \"UTF-8\u306e\u6587\u5b57\u5217\u3092\u5909\u63db\"\n[U+0055] [U+0054] [U+0046] [U+002D] [U+0038] [U+306E] [U+6587] [U+5B57] [U+5217] [U+3092] [U+5909] [U+63DB] \n```\n\n\u7121\u4e8b\u3001Unicode \u306e\u30b3\u30fc\u30c9\u30dd\u30a4\u30f3\u30c8\u304c\u53d6\u5f97\u3067\u304d\u307e\u3057\u305f\u3002\n\n\u2193\u30b5\u30ed\u30b2\u30fc\u30c8\u30da\u30a2\u3082OK\n\n```bash\n$ ./utf8_to_codepoint \"????\"\n[U+2000B] [U+2123D] [U+2131B] [U+2146E] \n```\n\n## `g_utf8_to_ucs4_fast()` \u306b\u3064\u3044\u3066\n\n>### \u66f8\u5f0f\n>\n>```c\n>#include <glib.h>\n>\ngunichar* g_utf8_to_ucs4_fast(const gchar *str,\n                              glong len,\n                              glong *items_written);\n```\n>\n>### \u8aac\u660e\n> \u6709\u52b9\u306aUTF-8\u306e\u5165\u529b\u3092\u60f3\u5b9a\u3057\u3066\u3001UTF-8\u6587\u5b57\u5217\u304b\u308932\u30d3\u30c3\u30c8\u56fa\u5b9a\u5e45\u306e UCS-4\u306b\u5909\u63db\u3057\u307e\u3059\u3002\u3053\u306e\u6a5f\u80fd\u306f\u3001`g_utf8_to_ucs4()` \u3088\u308a\u7d042\u500d\u306e\u51e6\u7406\u901f\u5ea6\u3067\u3059\u304c\u3001\u5165\u529b\u5024\u306e\u30a8\u30e9\u30fc\u30c1\u30a7\u30c3\u30af\u3092\u3057\u307e\u305b\u3093\u3002\u5909\u63db\u3055\u308c\u305f\u6587\u5b57\u5217\u306e\u672b\u5c3e\u306b'\\0'\u304c\u8ffd\u52a0\u3055\u308c\u307e\u3059\u3002\n>\n>__`str`__ :\u3000UTF-8 \u3067\u30a8\u30f3\u30b3\u30fc\u30c7\u30a3\u30f3\u30b0\u3055\u308c\u305f\u6587\u5b57\u5217\u3002\n>\n>__`len`__ :\u3000`str` \u306e\u6709\u52b9\u9577\u3068\u3057\u3066\u4f7f\u7528\u30020 \u4ee5\u4e0b\u306e\u5834\u5408\u306f\u3001\u6587\u5b57\u5217\u306e\u6709\u52b9\u9577\u306f\u30cc\u30eb\u6587\u5b57\u307e\u3067\u3068\u306a\u308a\u307e\u3059\u3002\n>\n>__`items_written`__ :\u3000\u7d50\u679c\u3092\u30b9\u30c8\u30a2\u3059\u308b\u30dd\u30a4\u30f3\u30bf\u304b NULL \u3092\u6307\u5b9a\u3002\uff08\u7701\u7565\u53ef\uff09\n>\n>__\u623b\u308a\u5024__  :\u3000\u65b0\u3057\u304f\u5272\u308a\u5f53\u3066\u3089\u308c\u305f UCS-4 \u6587\u5b57\u5217\u3078\u306e\u30dd\u30a4\u30f3\u30bf\u3002\u3053\u306e\u5024\u306f\u3001`g_free()` \u3067\u958b\u653e\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\n\n## \u53c2\u8003\n* [g_utf8_to_ucs4()](https://developer.gnome.org/glib/stable/glib-Unicode-Manipulation.html#g-utf8-to-ucs4)\n* [\u8d85\u521d\u5fc3\u8005\u306e\u305f\u3081\u306e Unicode\uff08\u30e6\u30cb\u30b3\u30fc\u30c9\uff09 \u5165\u9580](http://bearmini.net/blog/View.aspx?bid=1&aid=99)\n* [UTF-32 (UCS4) - Wikipedia](http://ja.wikipedia.org/wiki/UTF-32)\n\n\n\u4ee5\u4e0a\u3002", "tags": ["glib", "C", "unicode"]}