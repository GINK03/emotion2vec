{"tags": ["Go", "Facebook"], "context": "\u3053\u306e\u8a18\u4e8b\u306fWACUL Advent Calendar \u306e22\u65e5\u76ee\u3067\u3059\u3002\n\n\u306f\u3058\u3081\u306b\nFacebook\u306eAPI\u3092go\u8a00\u8a9e\u304b\u3089\u6271\u3044\u305f\u3044\u3068\u601d\u3044\u307e\u3059\u3002\nFacebook\u306eAPI\u306fOauth\u306e\u8a8d\u8a3c\u3092\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\u30e6\u30fc\u30b6\u306e\u8a8d\u8a3c\u3092\u7d4c\u3066\u3001\u30c8\u30fc\u30af\u30f3\u3092\u53d6\u5f97\u3057\u3001\u305d\u306e\u30c8\u30fc\u30af\u30f3\u3092\u4f7f\u7528\u3057\u3066API\u3092\u547c\u3073\u307e\u3059\u3002\n\n\u4e0b\u6e96\u5099\n\u9069\u5f53\u306bFacebook\u30a2\u30d7\u30ea\u3092\u767b\u9332\u3057\u3001\u30a2\u30d7\u30eaID\u3068app secret \u3092\u63a7\u3048\u3066\u304a\u304d\u307e\u3059\u3002\n\u305d\u3057\u3066\u3001Reidirect URL \u306b http://localhost:8080\u3092\u767b\u9332\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n\n\nAPI\u3092\u547c\u3076\n\u4ee5\u4e0b\u306e\u624b\u9806\u3092\u5b9f\u88c5\u3057\u307e\u3059\u3002\n\n\u8a8d\u8a3c\u30da\u30fc\u30b8\u306eURL\u3092\u8868\u793a\n\u30b3\u30fc\u30eb\u30d0\u30c3\u30af\u3055\u308c\u305f\u3068\u304d\u306e\u305f\u3081\u306b:8080\u3067\u30b5\u30fc\u30d0\u3092\u8d77\u52d5\n\u30e6\u30fc\u30b6\u306fURL\u3092\u30b3\u30d4\u30fc\u3057\u3066\u30d6\u30e9\u30a6\u30b6\u306b\u8cbc\u308a\u4ed8\u3051\n\u8a8d\u8a3c\u3059\u308b\u3068localhost:8080\u306b\u30b3\u30fc\u30eb\u30d0\u30c3\u30af\n\u30b3\u30fc\u30eb\u30d0\u30c3\u30af\u306e\u5b9f\u88c5\u3067\u306f\u3001\u30d1\u30e9\u30e1\u30fc\u30bf\u3067\u6e21\u3063\u3066\u304f\u308b\u30b3\u30fc\u30c9\u304b\u3089\u30c8\u30fc\u30af\u30f3\u306b\u5909\u63db\u3057\u3001\u30c8\u30fc\u30af\u30f3\u3092\u4f7f\u3063\u3066API\u3092\u547c\u3076\n\n\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u306f\u4ee5\u4e0b\u3067\u3059\u3002\npackage main\n\nimport (\n    \"fmt\"\n    \"log\"\n    \"net/http\"\n\n    fb \"github.com/huandu/facebook\"\n    \"golang.org/x/oauth2\"\n    fbauth \"golang.org/x/oauth2/facebook\"\n)\n\nvar conf *oauth2.Config\n\nfunc main() {\n    conf = &oauth2.Config{\n        ClientID:     \"11111111111111\",\n        ClientSecret: \"xxxxxxxxxxxxxxxxxxxxxxxxxx\",\n        Endpoint:     fbauth.Endpoint,\n        RedirectURL:  \"http://localhost:8080/\",\n    }\n    //\u8a8d\u8a3c\u30da\u30fc\u30b8\u306eURL\n    url := conf.AuthCodeURL(\"\")\n    fmt.Println(url)\n    fmt.Println(\"Please access the URL\")\n    //\u30ea\u30c0\u30a4\u30ec\u30af\u30c8URL\u3067\u6307\u5b9a\u3057\u305f\u30b5\u30fc\u30d0\u3092\u8d77\u52d5\u3057\u3066\u304a\u304f\n    http.HandleFunc(\"/\", handler)\n    http.ListenAndServe(\":8080\", nil)\n}\n\nfunc handler(w http.ResponseWriter, r *http.Request) {\n    code := r.FormValue(\"code\") //code\u304c\u8fd4\u3063\u3066\u304f\u308b\u306e\u3067\u53d6\u5f97\n    //code\u3092\u4f7f\u3063\u3066AccessToken\u3092\u53d6\u5f97\u3059\u308b\n    token, err := conf.Exchange(oauth2.NoContext, code)\n    if err != nil {\n        log.Fatal(\"exchange error\", err.Error())\n    }\n    client := conf.Client(oauth2.NoContext, token)\n\n    session := &fb.Session{\n        Version:    \"v2.8\",\n        HttpClient: client,\n    }\n\n    //API\u3092\u4f7f\u3063\u3066\u81ea\u8eab\u306e\u60c5\u5831\u3092\u53d6\u5f97\n    res, err := session.Get(\"/me?fields=id,name\", nil)\n    if err != nil {\n        log.Fatal(\"api get error\", err.Error())\n    }\n    fmt.Println(res[\"name\"])  // your facebook name\n}\n\n\n\u4ee5\u4e0a\u3067\u3001facebook API\u3092\u547c\u3076\u3053\u3068\u304c\u3067\u304d\u307e\u3057\u305f\u3002\n\u3053\u306e\u8a18\u4e8b\u306f[WACUL Advent Calendar](http://qiita.com/advent-calendar/2016/wacul) \u306e22\u65e5\u76ee\u3067\u3059\u3002\n\n## \u306f\u3058\u3081\u306b\n\nFacebook\u306eAPI\u3092go\u8a00\u8a9e\u304b\u3089\u6271\u3044\u305f\u3044\u3068\u601d\u3044\u307e\u3059\u3002\nFacebook\u306eAPI\u306fOauth\u306e\u8a8d\u8a3c\u3092\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\u30e6\u30fc\u30b6\u306e\u8a8d\u8a3c\u3092\u7d4c\u3066\u3001\u30c8\u30fc\u30af\u30f3\u3092\u53d6\u5f97\u3057\u3001\u305d\u306e\u30c8\u30fc\u30af\u30f3\u3092\u4f7f\u7528\u3057\u3066API\u3092\u547c\u3073\u307e\u3059\u3002\n\n## \u4e0b\u6e96\u5099\n\n\u9069\u5f53\u306bFacebook\u30a2\u30d7\u30ea\u3092\u767b\u9332\u3057\u3001\u30a2\u30d7\u30eaID\u3068app secret \u3092\u63a7\u3048\u3066\u304a\u304d\u307e\u3059\u3002\n\u305d\u3057\u3066\u3001Reidirect URL \u306b `http://localhost:8080`\u3092\u767b\u9332\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n\n![test_\u2015_Facebook\u30ed\u30af\u3099\u30a4\u30f3_-_\u958b\u767a\u8005\u5411\u3051Facebook.png](https://qiita-image-store.s3.amazonaws.com/0/85771/6e37f5ee-0934-0251-893b-1904ab56d194.png)\n\n## API\u3092\u547c\u3076\n\n\u4ee5\u4e0b\u306e\u624b\u9806\u3092\u5b9f\u88c5\u3057\u307e\u3059\u3002\n\n1. \u8a8d\u8a3c\u30da\u30fc\u30b8\u306eURL\u3092\u8868\u793a\n2. \u30b3\u30fc\u30eb\u30d0\u30c3\u30af\u3055\u308c\u305f\u3068\u304d\u306e\u305f\u3081\u306b:8080\u3067\u30b5\u30fc\u30d0\u3092\u8d77\u52d5\n3. \u30e6\u30fc\u30b6\u306fURL\u3092\u30b3\u30d4\u30fc\u3057\u3066\u30d6\u30e9\u30a6\u30b6\u306b\u8cbc\u308a\u4ed8\u3051\n4. \u8a8d\u8a3c\u3059\u308b\u3068localhost:8080\u306b\u30b3\u30fc\u30eb\u30d0\u30c3\u30af\n5. \u30b3\u30fc\u30eb\u30d0\u30c3\u30af\u306e\u5b9f\u88c5\u3067\u306f\u3001\u30d1\u30e9\u30e1\u30fc\u30bf\u3067\u6e21\u3063\u3066\u304f\u308b\u30b3\u30fc\u30c9\u304b\u3089\u30c8\u30fc\u30af\u30f3\u306b\u5909\u63db\u3057\u3001\u30c8\u30fc\u30af\u30f3\u3092\u4f7f\u3063\u3066API\u3092\u547c\u3076\n\n\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u306f\u4ee5\u4e0b\u3067\u3059\u3002\n\n```go\npackage main\n\nimport (\n\t\"fmt\"\n\t\"log\"\n\t\"net/http\"\n\n\tfb \"github.com/huandu/facebook\"\n\t\"golang.org/x/oauth2\"\n\tfbauth \"golang.org/x/oauth2/facebook\"\n)\n\nvar conf *oauth2.Config\n\nfunc main() {\n\tconf = &oauth2.Config{\n\t\tClientID:     \"11111111111111\",\n\t\tClientSecret: \"xxxxxxxxxxxxxxxxxxxxxxxxxx\",\n\t\tEndpoint:     fbauth.Endpoint,\n\t\tRedirectURL:  \"http://localhost:8080/\",\n\t}\n    //\u8a8d\u8a3c\u30da\u30fc\u30b8\u306eURL\n\turl := conf.AuthCodeURL(\"\")\n\tfmt.Println(url)\n\tfmt.Println(\"Please access the URL\")\n\t//\u30ea\u30c0\u30a4\u30ec\u30af\u30c8URL\u3067\u6307\u5b9a\u3057\u305f\u30b5\u30fc\u30d0\u3092\u8d77\u52d5\u3057\u3066\u304a\u304f\n\thttp.HandleFunc(\"/\", handler)\n\thttp.ListenAndServe(\":8080\", nil)\n}\n\nfunc handler(w http.ResponseWriter, r *http.Request) {\n\tcode := r.FormValue(\"code\") //code\u304c\u8fd4\u3063\u3066\u304f\u308b\u306e\u3067\u53d6\u5f97\n    //code\u3092\u4f7f\u3063\u3066AccessToken\u3092\u53d6\u5f97\u3059\u308b\n\ttoken, err := conf.Exchange(oauth2.NoContext, code)\n\tif err != nil {\n\t\tlog.Fatal(\"exchange error\", err.Error())\n\t}\n\tclient := conf.Client(oauth2.NoContext, token)\n\n\tsession := &fb.Session{\n\t\tVersion:    \"v2.8\",\n\t\tHttpClient: client,\n\t}\n\n\t//API\u3092\u4f7f\u3063\u3066\u81ea\u8eab\u306e\u60c5\u5831\u3092\u53d6\u5f97\n\tres, err := session.Get(\"/me?fields=id,name\", nil)\n\tif err != nil {\n\t\tlog.Fatal(\"api get error\", err.Error())\n\t}\n\tfmt.Println(res[\"name\"])  // your facebook name\n}\n\n```\n\n\u4ee5\u4e0a\u3067\u3001facebook API\u3092\u547c\u3076\u3053\u3068\u304c\u3067\u304d\u307e\u3057\u305f\u3002\n"}