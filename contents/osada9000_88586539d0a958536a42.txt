{"tags": ["PowerShell", "ActiveDirectory", "WindowsServer 2012 R2"], "context": " More than 1 year has passed since last update.\n\n\u80cc\u666f\nMicrosoft Dynamics Lifecycle Service\u3067Azure\u306b\u30c7\u30d7\u30ed\u30a4\u3057\u305fVM\u306b\u30e6\u30fc\u30b6\u30fc\u3092\u8ffd\u52a0\u3059\u308b\u4f5c\u696d\u304c\u3060\u308b\u3044\u306e\u3067\u3001PowerShell\u3067\u540c\u69d8\u306e\u64cd\u4f5c\u3092\u884c\u3048\u308b\u3088\u3046\u306b\u3057\u305f\u3002\n\u8a2d\u5b9a\u5024\u3092\u8a18\u8ff0\u3057\u305fCSV\u3092\u8aad\u307f\u8fbc\u3082\u3046\u304b\u3068\u3082\u601d\u3063\u305f\u304c\u3001\u8ffd\u52a0\u3057\u305f\u3044\u30e6\u30fc\u30b6\u30fc\u6570\u304c\u4e21\u624b\u306b\u53ce\u307e\u308b\u304f\u3089\u3044\u306a\u306e\u3067\u3001\u3084\u3081\u305f\u3002\n\n\u4f7f\u3044\u65b9\n\u307e\u305a\u3001Powershell\u3092\u7acb\u3061\u4e0a\u3052\u3001\u4ee5\u4e0b\u306e\u30b3\u30de\u30f3\u30c9\u3092\u5165\u529b\u3057\u3001\u5b9f\u884c\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30dd\u30ea\u30b7\u30fc\u3092\u8a2d\u5b9a\u3059\u308b\u3002\nPS C:\\Users\\Administrator> Set-ExecutionPolicy RemoteSigned\n\u6b21\u306b\u3001\u4e0b\u8a18\u306e\u30b3\u30fc\u30c9\u3092\u4efb\u610f\u306e\u5834\u6240\u306b\u4fdd\u5b58\u3057\u3001\u305d\u306eps1\u30d5\u30a1\u30a4\u30eb\u3092\u547c\u3073\u51fa\u3059\u3002\nPS C:\\Users\\Administrator> C:\\ps\\AddUsers.ps1\n\n\u30b3\u30fc\u30c9\n\nAddUsers.ps1\nImport-Module ActiveDirectory\n$password = ConvertTo-SecureString -AsPlainText \"pass@word1\" -Force\n\nNew-ADUser  -Name \"guest01\"`\n    -Surname \"guest\" `\n    -GivenName \"guest\" `\n    -DisplayName \"guest01\" `\n    -UserPrincipalName \"guest01@Contoso.com\" `\n    -AccountPassword $password `\n    -PasswordNeverExpires $true `\n    -Enabled $True\n\nNew-ADUser  -Name \"guest02\"`\n    -Surname \"guest\" `\n    -GivenName \"guest\" `\n    -DisplayName \"guest02\" `\n    -UserPrincipalName \"guest02@Contoso.com\" `\n    -AccountPassword $password `\n    -PasswordNeverExpires $true `\n    -Enabled $true \n\n\n$groups =@(\"Remote Desktop Users\";\n           \"Microsoft Dynamics AX Data Import Export Framework Service Users\";\n           \"Microsoft Dynamics AX Debugging Users\";\n           \"Microsoft Dynamics AX Web Service Administrators\";\n          )\nforeach($group in $groups)\n{\n    Add-ADGroupMember -Identity $group -Members guest01, guest02\n} \n\n\n\n\u78ba\u8a8d\n\u4f5c\u6210\u3055\u308c\u305f\u30e6\u30fc\u30b6\u30fc\u306f\u3001\u4e0b\u8a18\u306e\u3088\u3046\u306b\u306a\u3063\u3066\u3044\u308b\u3002\n\n\n\n#\u80cc\u666f\nMicrosoft Dynamics Lifecycle Service\u3067Azure\u306b\u30c7\u30d7\u30ed\u30a4\u3057\u305fVM\u306b\u30e6\u30fc\u30b6\u30fc\u3092\u8ffd\u52a0\u3059\u308b\u4f5c\u696d\u304c\u3060\u308b\u3044\u306e\u3067\u3001PowerShell\u3067\u540c\u69d8\u306e\u64cd\u4f5c\u3092\u884c\u3048\u308b\u3088\u3046\u306b\u3057\u305f\u3002\n\n\u8a2d\u5b9a\u5024\u3092\u8a18\u8ff0\u3057\u305fCSV\u3092\u8aad\u307f\u8fbc\u3082\u3046\u304b\u3068\u3082\u601d\u3063\u305f\u304c\u3001\u8ffd\u52a0\u3057\u305f\u3044\u30e6\u30fc\u30b6\u30fc\u6570\u304c\u4e21\u624b\u306b\u53ce\u307e\u308b\u304f\u3089\u3044\u306a\u306e\u3067\u3001\u3084\u3081\u305f\u3002\n\n#\u4f7f\u3044\u65b9\n\u307e\u305a\u3001Powershell\u3092\u7acb\u3061\u4e0a\u3052\u3001\u4ee5\u4e0b\u306e\u30b3\u30de\u30f3\u30c9\u3092\u5165\u529b\u3057\u3001\u5b9f\u884c\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30dd\u30ea\u30b7\u30fc\u3092\u8a2d\u5b9a\u3059\u308b\u3002\n`PS C:\\Users\\Administrator> Set-ExecutionPolicy RemoteSigned`\n\n\u6b21\u306b\u3001\u4e0b\u8a18\u306e\u30b3\u30fc\u30c9\u3092\u4efb\u610f\u306e\u5834\u6240\u306b\u4fdd\u5b58\u3057\u3001\u305d\u306eps1\u30d5\u30a1\u30a4\u30eb\u3092\u547c\u3073\u51fa\u3059\u3002\n`PS C:\\Users\\Administrator> C:\\ps\\AddUsers.ps1`\n\n##\u30b3\u30fc\u30c9\n```ps1:AddUsers.ps1\nImport-Module ActiveDirectory\n$password = ConvertTo-SecureString -AsPlainText \"pass@word1\" -Force\n\nNew-ADUser\t-Name \"guest01\"`\n\t-Surname \"guest\" `\n\t-GivenName \"guest\" `\n\t-DisplayName \"guest01\" `\n\t-UserPrincipalName \"guest01@Contoso.com\" `\n\t-AccountPassword $password `\n\t-PasswordNeverExpires $true `\n\t-Enabled $True\n\t\nNew-ADUser\t-Name \"guest02\"`\n\t-Surname \"guest\" `\n\t-GivenName \"guest\" `\n\t-DisplayName \"guest02\" `\n\t-UserPrincipalName \"guest02@Contoso.com\" `\n\t-AccountPassword $password `\n\t-PasswordNeverExpires $true `\n\t-Enabled $true \n\n\n$groups =@(\"Remote Desktop Users\";\n           \"Microsoft Dynamics AX Data Import Export Framework Service Users\";\n           \"Microsoft Dynamics AX Debugging Users\";\n           \"Microsoft Dynamics AX Web Service Administrators\";\n          )\nforeach($group in $groups)\n{\n\tAdd-ADGroupMember -Identity $group -Members guest01, guest02\n} \n```\n\n##\u78ba\u8a8d\n\u4f5c\u6210\u3055\u308c\u305f\u30e6\u30fc\u30b6\u30fc\u306f\u3001\u4e0b\u8a18\u306e\u3088\u3046\u306b\u306a\u3063\u3066\u3044\u308b\u3002\n![ad1.png](https://qiita-image-store.s3.amazonaws.com/0/46647/dda7be7a-a8be-954c-0ad2-984fb16e8fb5.png)\n![ad2.png](https://qiita-image-store.s3.amazonaws.com/0/46647/1b85685e-34e9-9962-3a9e-382f7bfe77c6.png)\n![ad3.png](https://qiita-image-store.s3.amazonaws.com/0/46647/276d9f33-7125-7f3a-0b3f-9c57203d4891.png)\n"}