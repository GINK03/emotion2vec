{"tags": ["Arduino", "MIDI", "mocoLUFA"], "context": " More than 1 year has passed since last update.\n\n\u81ea\u5206\u3067\u4f5c\u308bMIDI\u97f3\u6e90 Hello World\n\n2015.11.12 \u67d0\u30a4\u30d9\u30f3\u30c8\u5411\u3051\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb\n\nMIDI\u97f3\u6e90\u3068\u3044\u3046\u3001\u3061\u3087\u3063\u3068\u53e4\u3081\u304b\u3057\u3044\u8a00\u3044\u65b9\u306b\u30d4\u30fc\u30f3\u3068\u6765\u305f\u3042\u306a\u305f\uff01\nArduino\u3092\u4f7f\u3048\u3070\u7c21\u5358\u306b\u4f5c\u308c\u3061\u3083\u3044\u307e\u3059\u3088\uff01\n\u3068\u3044\u3046\u308f\u3051\u3067\u3001\u4f5c\u3063\u3066\u307f\u307e\u3057\u3087\u3046\u3002\n\u3053\u3093\u306a\u306e\u304c\u7c21\u5358\u306b\u4f5c\u308c\u307e\u3059\u3002\n\u30d8\u30bf\u30af\u30bd\u306a\u6f14\u594f\u4f8bw\n\n\u7528\u610f\u3059\u308b\u3082\u306e\n\nArduino UNO Rev.3 (mocoLUFA\u3092\u713c\u304d\u8fbc\u3093\u3060\u3082\u306e)\n\u3057\u3087\u307c\u3044\u30b9\u30d4\u30fc\u30ab\u30fc\nUSB\u30b1\u30fc\u30d6\u30eb (Arduino\u3068PC/Mac\u3092\u7e4b\u3050\u3084\u3064)\nPC/Mac\nISP\u7aef\u5b50\u3092\u30b7\u30e7\u30fc\u30c8\u3059\u308b\u305f\u3081\u306e\u30b8\u30e3\u30f3\u30d1\u30fc\u30d4\u30f3\n\n\nmocoLUFA\u306e\u713c\u304d\u65b9\u306f \u304b\u308f\u3044\u3055\u3093\u306e\u624b\u9806\u66f8\u3042\u305f\u308a\u3092\u53c2\u8003\u306b\u3057\u3066\u304f\u3060\u3055\u3044\uff01\n\n\n\u4f5c\u308a\u65b9\n\n\u30cf\u30fc\u30c9\uff01\nArduino\u306e11\u756a\u30d4\u30f3\u306b\u30b9\u30d4\u30fc\u30ab\u30fc\u306e\u30d7\u30e9\u30b9\u5074\u3092\u3001Arduino\u306eGND\u30d4\u30f3\u306b\u30b9\u30d4\u30fc\u30ab\u30fc\u306e\u30de\u30a4\u30ca\u30b9\u5074\u3092\u7e4b\u3044\u3067\u304f\u3060\u3055\u3044\u3002\n\u4ee5\u4e0a\uff01\uff01\n\n\u30b9\u30b1\u30c3\u30c1\uff01\n\u4e0b\u8a18\u30b9\u30b1\u30c3\u30c1\u3092Arduino\u306b\u66f8\u304d\u8fbc\u3093\u3067\u304f\u3060\u3055\u3044\n// MIDI to Tone Sounder\n// 2015.11.11 D.F.Mac.\n\n#include <avr/pgmspace.h> \n#include <MIDI.h>\n\nMIDI_CREATE_DEFAULT_INSTANCE();\n\n// Note Number -> Frequency\nPROGMEM const int freqs[] = {\n  8,8,9,9,10,11,11,12,13,14,15,15,16,17,18,19,\n  21,22,23,24,26,28,29,31,33,35,37,39,41,44,46,49,\n  52,55,58,62,65,69,73,78,82,87,93,98,104,110,117,123,\n  131,139,147,156,165,175,185,196,208,220,233,247,262,277,294,311,\n  330,349,370,392,415,440,466,494,523,554,587,623,659,698,740,784,\n  831,880,932,988,1047,1109,1175,1245,1319,1397,1480,1568,1661,1760,1865,1976,\n  2093,2217,2349,2489,2637,2794,2960,3136,3322,3520,3729,3951,4186,4435,4699,4978,\n  5274,5588,5920,6272,6645,7040,7459,7902,8372,8870,9397,9956,10548,11175,11840,12544\n};\n\nconst int SPEAKER = 11;      // Speaker PIN \nconst int LED = 13;\nint isplay = 0;\n\nvoid setup() {\n  pinMode(SPEAKER,OUTPUT);  // Speaker\n  pinMode(LED,OUTPUT);      // LED\n  MIDI.begin();             // Start MIDI\n  MIDI.turnThruOff();       // MIDI Thru Off\n}\n\nvoid loop() {\n  if(MIDI.read()) {\n    int kind = MIDI.getType();\n    if(kind==midi::NoteOn){\n      digitalWrite(LED,HIGH);\n      isplay ++;\n      int playnote = MIDI.getData1();\n      int freq = pgm_read_word(freqs + playnote);\n      tone(SPEAKER,freq);\n    }else if(kind==midi::NoteOff){\n      digitalWrite(LED,LOW);\n      isplay --;\n      if(isplay == 0){\n        noTone(SPEAKER);\n      }\n    }\n  }\n}\n\n\n\u9cf4\u3089\u3059\u306b\u306f\uff01\uff1f\nMIDI\u30ad\u30fc\u30dc\u30fc\u30c9\u3092\u7e4b\u3044\u3067\u3001MIDI\u30c7\u30d0\u30a4\u30b9\u304b\u3089\u300cMIDI/MOCO for LUFA\u300d\u3092\u9078\u3093\u3067\u5f3e\u304f\u3060\u3051\uff01\n\u3057\u3087\u307c\u3044\u30d3\u30fc\u30d7\u97f3\uff08\u5358\u97f3\uff09\u304c\u9cf4\u3063\u305f\u3089\u6210\u529f\uff01\n\nMIDI\u30ad\u30fc\u30dc\u30fc\u30c9\u6301\u3063\u3066\u304d\u3066\u306d\u30fc\uff01\n\u30ce https://ryoyakawai.github.io/x-webmidi/src/\n\n\u6b21\u306f\uff01\uff1f\n\u3053\u3061\u3089\u3082\u662f\u975e\uff01\n[WIP] Arduino\u3067\u97f3\u3092\u51fa\u3057\u305f\u3044\uff08\u30e1\u30e2\uff09\n# \u81ea\u5206\u3067\u4f5c\u308bMIDI\u97f3\u6e90 Hello World\n\n> 2015.11.12 \u67d0\u30a4\u30d9\u30f3\u30c8\u5411\u3051\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb\n\nMIDI\u97f3\u6e90\u3068\u3044\u3046\u3001\u3061\u3087\u3063\u3068\u53e4\u3081\u304b\u3057\u3044\u8a00\u3044\u65b9\u306b\u30d4\u30fc\u30f3\u3068\u6765\u305f\u3042\u306a\u305f\uff01\nArduino\u3092\u4f7f\u3048\u3070\u7c21\u5358\u306b\u4f5c\u308c\u3061\u3083\u3044\u307e\u3059\u3088\uff01\n\u3068\u3044\u3046\u308f\u3051\u3067\u3001\u4f5c\u3063\u3066\u307f\u307e\u3057\u3087\u3046\u3002\n\n\u3053\u3093\u306a\u306e\u304c\u7c21\u5358\u306b\u4f5c\u308c\u307e\u3059\u3002\n\n[\u30d8\u30bf\u30af\u30bd\u306a\u6f14\u594f\u4f8bw](https://instagram.com/p/98XyC3nCsZ/?taken-by=tadfmac)\n\n# \u7528\u610f\u3059\u308b\u3082\u306e\n\n- Arduino UNO Rev.3 (mocoLUFA\u3092\u713c\u304d\u8fbc\u3093\u3060\u3082\u306e)\n- \u3057\u3087\u307c\u3044\u30b9\u30d4\u30fc\u30ab\u30fc\n- USB\u30b1\u30fc\u30d6\u30eb (Arduino\u3068PC/Mac\u3092\u7e4b\u3050\u3084\u3064)\n- PC/Mac\n- ISP\u7aef\u5b50\u3092\u30b7\u30e7\u30fc\u30c8\u3059\u308b\u305f\u3081\u306e\u30b8\u30e3\u30f3\u30d1\u30fc\u30d4\u30f3\n\n> mocoLUFA\u306e\u713c\u304d\u65b9\u306f [\u304b\u308f\u3044\u3055\u3093\u306e\u624b\u9806\u66f8](https://webmusicdevelopers.appspot.com/codelabs/arduino-mocolufa/index.html?ja-jp)\u3042\u305f\u308a\u3092\u53c2\u8003\u306b\u3057\u3066\u304f\u3060\u3055\u3044\uff01\n\n# \u4f5c\u308a\u65b9\n\n## \u30cf\u30fc\u30c9\uff01\n\nArduino\u306e11\u756a\u30d4\u30f3\u306b\u30b9\u30d4\u30fc\u30ab\u30fc\u306e\u30d7\u30e9\u30b9\u5074\u3092\u3001Arduino\u306eGND\u30d4\u30f3\u306b\u30b9\u30d4\u30fc\u30ab\u30fc\u306e\u30de\u30a4\u30ca\u30b9\u5074\u3092\u7e4b\u3044\u3067\u304f\u3060\u3055\u3044\u3002\n\n\u4ee5\u4e0a\uff01\uff01\n\n## \u30b9\u30b1\u30c3\u30c1\uff01\n\n\u4e0b\u8a18\u30b9\u30b1\u30c3\u30c1\u3092Arduino\u306b\u66f8\u304d\u8fbc\u3093\u3067\u304f\u3060\u3055\u3044\n\n```c\n// MIDI to Tone Sounder\n// 2015.11.11 D.F.Mac.\n\n#include <avr/pgmspace.h> \n#include <MIDI.h>\n\nMIDI_CREATE_DEFAULT_INSTANCE();\n\n// Note Number -> Frequency\nPROGMEM const int freqs[] = {\n  8,8,9,9,10,11,11,12,13,14,15,15,16,17,18,19,\n  21,22,23,24,26,28,29,31,33,35,37,39,41,44,46,49,\n  52,55,58,62,65,69,73,78,82,87,93,98,104,110,117,123,\n  131,139,147,156,165,175,185,196,208,220,233,247,262,277,294,311,\n  330,349,370,392,415,440,466,494,523,554,587,623,659,698,740,784,\n  831,880,932,988,1047,1109,1175,1245,1319,1397,1480,1568,1661,1760,1865,1976,\n  2093,2217,2349,2489,2637,2794,2960,3136,3322,3520,3729,3951,4186,4435,4699,4978,\n  5274,5588,5920,6272,6645,7040,7459,7902,8372,8870,9397,9956,10548,11175,11840,12544\n};\n\nconst int SPEAKER = 11;      // Speaker PIN \nconst int LED = 13;\nint isplay = 0;\n\nvoid setup() {\n  pinMode(SPEAKER,OUTPUT);  // Speaker\n  pinMode(LED,OUTPUT);      // LED\n  MIDI.begin();             // Start MIDI\n  MIDI.turnThruOff();       // MIDI Thru Off\n}\n\nvoid loop() {\n  if(MIDI.read()) {\n    int kind = MIDI.getType();\n    if(kind==midi::NoteOn){\n      digitalWrite(LED,HIGH);\n      isplay ++;\n      int playnote = MIDI.getData1();\n      int freq = pgm_read_word(freqs + playnote);\n      tone(SPEAKER,freq);\n    }else if(kind==midi::NoteOff){\n      digitalWrite(LED,LOW);\n      isplay --;\n      if(isplay == 0){\n        noTone(SPEAKER);\n      }\n    }\n  }\n}\n```\n\n# \u9cf4\u3089\u3059\u306b\u306f\uff01\uff1f\n\nMIDI\u30ad\u30fc\u30dc\u30fc\u30c9\u3092\u7e4b\u3044\u3067\u3001MIDI\u30c7\u30d0\u30a4\u30b9\u304b\u3089\u300cMIDI/MOCO for LUFA\u300d\u3092\u9078\u3093\u3067\u5f3e\u304f\u3060\u3051\uff01\n\n\u3057\u3087\u307c\u3044\u30d3\u30fc\u30d7\u97f3\uff08\u5358\u97f3\uff09\u304c\u9cf4\u3063\u305f\u3089\u6210\u529f\uff01\n\n# MIDI\u30ad\u30fc\u30dc\u30fc\u30c9\u6301\u3063\u3066\u304d\u3066\u306d\u30fc\uff01\n\n\u30ce https://ryoyakawai.github.io/x-webmidi/src/\n\n# \u6b21\u306f\uff01\uff1f\n\n\u3053\u3061\u3089\u3082\u662f\u975e\uff01\n\n[[WIP] Arduino\u3067\u97f3\u3092\u51fa\u3057\u305f\u3044\uff08\u30e1\u30e2\uff09](http://qiita.com/tadfmac/items/7fb26596fe6240959c48)\n"}