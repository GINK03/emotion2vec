{"tags": ["Ruby", "Gem"], "context": "\n\n\u6982\u8981\n\u4eca\u66f4\u3067\u306f\u3042\u308a\u307e\u3059\u304c\u3001gem\u4f5c\u3063\u3066\u5916\u90e8\u516c\u958b\u3059\u308b\u3068\u3044\u3046\u3053\u3068\u3092\u3084\u3063\u3066\u307f\u305f\u304f\u3066\u3084\u308a\u307e\u3057\u305f\u3002\n\u516c\u958b\u3057\u305fgem\u306f\u65e5\u4ed8\u306e\u8868\u793a\u5f62\u5f0f\u3092\u6574\u3048\u308b\u30e1\u30bd\u30c3\u30c9\u3092\u81ea\u52d5\u3067\u3084\u3063\u3066\u304f\u308c\u308b\u7c21\u5358\u306a\u3082\u306e\u3067\u3059\u3002\u307e\u3060\u6539\u5584\u306e\u4f59\u5730\u304c\u3042\u308b\u306e\u3067\u3059\u304c  \n\u4f5c\u6210\u3057\u305fgem\u306f\u3053\u3061\u3089\u3067\u3059\u3002\n\n\u74b0\u5883\n\nruby 2.3.1\nrails 4.2.7\n\n\n\u958b\u767a\u306e\u6d41\u308c\n1.gem\u306e\u96db\u5f62\u3092\u4f5c\u6210\n\u3053\u3061\u3089\u3092\u53c2\u8003\u306b\u3057\u307e\u3057\u305f\u3002\n> bundle exec rails plugin new dog_formatter\n\n2.gem\u306e\u4e2d\u8eab\u306e\u4f5c\u6210\n2-1.dog_formatter.gemspec\u306e\u7de8\u96c6\n\u4f9d\u5b58\u304c\u5fc5\u8981\u3060\u3063\u305f\u308a\u958b\u767a\u6642\u306b\u4f7f\u3063\u305f\u308a\u3059\u308bgem\u3092\u8ffd\u8a18\u3057\u307e\u3059\u3002\u307e\u305f\u4eca\u56de\u4f5c\u6210\u3059\u308bgem\u306b\u95a2\u3059\u308b\u60c5\u5831\u3082\u8a18\u8ff0\u3057\u307e\u3059\u3002\n 1 $:.push File.expand_path(\"../lib\", __FILE__)\n  2\n  3 # Maintain your gem's version:\n  4 require \"dog_formatter/version\"\n  5\n  6 # Describe your gem and declare its dependencies:\n  7 Gem::Specification.new do |s|\n  8   s.name        = \"dog_formatter\"\n  9   s.version     = DogFormatter::VERSION\n 10   s.authors     = [\"\u30db\u30b2\u30db\u30b2\u30db\u30b2\"]\n 11   s.email       = [\"hogehoge@gmail.com\"]\n 12   s.homepage    = \"\"\n 13   s.summary     = \"\u65e5\u4ed8\u3051\u306eFormatter\"\n 14   s.description = \"\u65e5\u4ed8\u3051\u306eFormatter\u3092\u3059\u308bgem\"\n 15   s.license     = \"MIT\"\n 16\n 17   s.files = Dir[\"{app,config,db,lib}/**/*\", \"MIT-LICENSE\", \"Rakefile\", \"README.rdoc\"    ]\n 18   s.test_files = Dir[\"test/**/*\"]\n 19\n 20   s.add_dependency \"rails\", \"~> 4.2.6\"\n 21\n 22   s.add_development_dependency \"sqlite3\"\n 23   s.add_development_dependency \"ridgepole\"\n 24 end\n\n2-2. lib/dog_formatter/model.rb\u3092\u4f5c\u6210\u3057\u7de8\u96c6\n\u4eca\u56de\u306egem\u306f\u300c~_at\u300d\u3000\u3063\u3066\u540d\u524d\u306e\u30ab\u30e9\u30e0\u304c\u3042\u3063\u305f\u3089\u3001\u305d\u308c\u306e\u30ab\u30e9\u30e0\u306b\u5bfe\u3057\u81ea\u52d5\u7684\u306b\u300c~_at_ymd\u300d\u3068\u3044\u540d\u524d\u306e\u30e1\u30bd\u30c3\u30c9\u3092\u8ffd\u52a0\u3059\u308bgem\u306a\u306e\u3067ActiveRecord\u3092\u62e1\u5f35\u3059\u308b\u3068\u3044\u3046\u610f\u5473\u304b\u3089model\u3063\u3066\u540d\u524d\u306e\u30af\u30e9\u30b9\u3092\u4f5c\u6210\u3057\u3066\u305d\u3053\u306b\u66f8\u304f\u3053\u3068\u306b\u3057\u307e\u3057\u305f\u3002\n\nlib/dog_formatter/model.rb\n  1 module DogFormatter\n  2   module Model\n  3    extend ActiveSupport::Concern\n  4\n  5    included do\n  6    end\n  7\n  8     def method_missing(method_name, *_args, &_block)\n  9       method_name_suffix =  matched_method_name_suffix(method_name.to_s)\n 10       return unless method_name_suffix\n 11\n 12       suffix_pattern = Regexp.new(method_name_suffix)\n 13       attribute_name_except_format_value = method_name.to_s.sub!(suffix_pattern, '')\n 14\n 15       return unless exist_column?(attribute_name_except_format_value)\n 16\n 17       formatted_with_method_name_suffix(attribute_name_except_format_value, method_n    ame_suffix)\n 18     end\n 19\n 20     private\n 21     def format_suffixs\n 22       ['_ymd', '_ymd_ja', '_ym', '_ym_ja']\n 23     end\n 24\n 25     def matched_method_name_suffix(method_name)\n 26       format_suffixs.each { |suffix| return suffix if method_name.end_with?(suffix)     }\n 27     end\n 28\n 29     def date_columns\n 30       self.class.column_names.select { |column_name| column_name =~ /.*_at/ } # TODO: \u3061\u3083\u3093\u3068\u30c7\u30fc\u30bf\u306e\u578b\u3082\u898b\u308b\u3088\u3046\u306b\u3059\u308b\n 31     end\n 32\n 33     def exist_column?(attribute_name)\n 34       date_columns.include?(attribute_name)\n 35     end\n36\n 37     def formatted_with_method_name_suffix(attribute_name, method_name_suffix)\n 38       read_attribute(attribute_name).strftime(format_text(method_name_suffix))\n 39     end\n 40\n 41     def format_text(method_name_suffix)\n 42       # TODO: \u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u306a\u3069\u306b\u5916\u51fa\u3057\u3057\u305f\u3082\u306e\u3092\u8aad\u307f\u8fbc\u3080\u5f62\u5f0f\u306b\u5909\u66f4\u3059\u308b\n 43       case method_name_suffix\n 44       when '_ymd'\n 45         '%Y/%m/%d'\n 46       when '_ymd_ja'\n 47         '%Y\u5e74%m\u6708%d\u65e5'\n 48       when '_ym'\n 49         '%Y/%m'\n 50       when '_ym_ja'\n 51         '%Y\u5e74%m\u6708'\n 52       else\n 53         raise '\u5909\u63db\u3067\u304d\u307e\u305b\u3093\u3002\u8a72\u5f53\u3059\u308b\u65e5\u4ed8\u5f62\u5f0f\u304c\u3042\u308a\u307e\u305b\u3093'\n 54       end\n 55     end\n 56   end\n 57 end\n 58\n 59 ActiveRecord::Base.send :include, DogFormatter::Model\n\n\n3.test\n\u30c6\u30b9\u30c8\u3067\u306fActiveRecord\u3092\u4f7f\u3063\u3066\u5b9f\u969b\u306e\u52d5\u304d\u3092\u78ba\u8a8d\u3057\u305f\u3044\u306e\u3067\u3001ridgepole\u3092\u4f7f\u3063\u3066\u7c21\u5358\u306b\u30c6\u30fc\u30d6\u30eb\u3092\u4f5c\u3063\u3066\u3084\u308a\u307e\u3057\u305f\u3002\n\uff13\u2212\uff11.\u30c6\u30fc\u30d6\u30eb\u4f5c\u6210\nridgepole\u306e\u30b9\u30ad\u30fc\u30de\u30d5\u30a1\u30a4\u30eb\u306f\u6b21\u306e\u3088\u3046\u306b\u66f8\u304d\u3001ridgepole\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3055\u305b\u3066\u30c6\u30fc\u30d6\u30eb\u4f5c\u6210\u3057\u307e\u3057\u305f\u3002(\u8a73\u7d30\u306f\u7701\u7565\uff09\n\ntest/dummy/db/schemas/users.schema\n1 create_table \"users\", force: :cascade do |t|\n2   t.string   \"name\",               limit: 255\n3   t.datetime \"created_at\"\n4   t.datetime \"updated_at\"\n5 end\n\n\n4.github\u3078\u306e\u767b\u9332\ngithub\u306bpush\u3002(\u8a73\u7d30\u306f\u7701\u7565\uff09\n5.rubygem\u3078\u306e\u767b\u9332\n\u3053\u3061\u3089\u3092\u53c2\u7167\u3055\u305b\u3066\u3044\u305f\u3060\u304d\u307e\u3057\u305f\u3002\n5-1. rubygem\u306bsign up\n\u3053\u3061\u3089\u3067e-mail/handle\u540d/password(\uff11\uff10\u6587\u5b57\u4ee5\u4e0a)\u3092\u5165\u308c\u3066\u767b\u9332\n5-2. rubygem\u306eapi\u30a2\u30af\u30bb\u30b9\u30ad\u30fc\u306e\u767b\u9332\ncurl -u Handle\u540d https://rubygems.org/api/v1/api_key.yaml > ~/.gem/credentials; chmod 0600 ~/.gem/credentials\n6.\u3044\u3056\u3001release!\n\u3053\u3053\u307e\u3067\u304d\u305f\u3089\u3044\u3088\u3044\u3088\u30ea\u30ea\u30fc\u30b9\u3067\u3059\u3002\n> bundle exec rake release\n\n\n\u4f7f\u3063\u3066\u307f\u308b\n\u601d\u3063\u305f\u3088\u3046\u306a\u52d5\u4f5c\u3092\u3057\u3066\u3044\u308b  \n1 require 'dog_formatter/model'\n2\n3 class User < ActiveRecord::Base\n4 end\n\nuser.created_at_ymd\n=> \"2016/11/04\"\nuser.created_at_ymd_ja\n=> \"2016\u5e7411\u670804\u65e5\"\nuser.created_at_ym\n=> \"2016/11\"\nuser.created_at_ym_ja\n=> \"2016\u5e7411\u6708\"\n\n\n\u6240\u611f\n\u4ed6\u3067\u3082\u4f7f\u3048\u308b\u3088\u3046\u306a\u5171\u901a\u51e6\u7406\u306f\u306fgem\u5316\u3059\u308b\u3068\u826f\u3044\u306a\u3068\u306f\u601d\u3063\u3066\u3044\u305f\u306e\u3067\u3001\u3053\u308c\u304b\u3089\u307e\u305f\u8272\u3005\u3068\u4f5c\u3063\u3066\u307f\u305f\u3044\u3068\u601d\u3044\u307e\u3057\u305f\u3002\n# \u6982\u8981\n\u4eca\u66f4\u3067\u306f\u3042\u308a\u307e\u3059\u304c\u3001gem\u4f5c\u3063\u3066\u5916\u90e8\u516c\u958b\u3059\u308b\u3068\u3044\u3046\u3053\u3068\u3092\u3084\u3063\u3066\u307f\u305f\u304f\u3066\u3084\u308a\u307e\u3057\u305f\u3002\n\u516c\u958b\u3057\u305fgem\u306f\u65e5\u4ed8\u306e\u8868\u793a\u5f62\u5f0f\u3092\u6574\u3048\u308b\u30e1\u30bd\u30c3\u30c9\u3092\u81ea\u52d5\u3067\u3084\u3063\u3066\u304f\u308c\u308b\u7c21\u5358\u306a\u3082\u306e\u3067\u3059\u3002\u307e\u3060\u6539\u5584\u306e\u4f59\u5730\u304c\u3042\u308b\u306e\u3067\u3059\u304c :smiley: \n\u4f5c\u6210\u3057\u305fgem\u306f[\u3053\u3061\u3089](https://github.com/nakaearth/dog_formatter)\u3067\u3059\u3002\n\n# \u74b0\u5883\n- ruby 2.3.1\n- rails 4.2.7\n\n# \u958b\u767a\u306e\u6d41\u308c\n1.gem\u306e\u96db\u5f62\u3092\u4f5c\u6210\n[\u3053\u3061\u3089](http://railsguides.jp/plugins.html)\u3092\u53c2\u8003\u306b\u3057\u307e\u3057\u305f\u3002\n\n```\n> bundle exec rails plugin new dog_formatter\n```\n\n2.gem\u306e\u4e2d\u8eab\u306e\u4f5c\u6210\n2-1.dog_formatter.gemspec\u306e\u7de8\u96c6\n\u4f9d\u5b58\u304c\u5fc5\u8981\u3060\u3063\u305f\u308a\u958b\u767a\u6642\u306b\u4f7f\u3063\u305f\u308a\u3059\u308bgem\u3092\u8ffd\u8a18\u3057\u307e\u3059\u3002\u307e\u305f\u4eca\u56de\u4f5c\u6210\u3059\u308bgem\u306b\u95a2\u3059\u308b\u60c5\u5831\u3082\u8a18\u8ff0\u3057\u307e\u3059\u3002\n\n```\n 1 $:.push File.expand_path(\"../lib\", __FILE__)\n  2\n  3 # Maintain your gem's version:\n  4 require \"dog_formatter/version\"\n  5\n  6 # Describe your gem and declare its dependencies:\n  7 Gem::Specification.new do |s|\n  8   s.name        = \"dog_formatter\"\n  9   s.version     = DogFormatter::VERSION\n 10   s.authors     = [\"\u30db\u30b2\u30db\u30b2\u30db\u30b2\"]\n 11   s.email       = [\"hogehoge@gmail.com\"]\n 12   s.homepage    = \"\"\n 13   s.summary     = \"\u65e5\u4ed8\u3051\u306eFormatter\"\n 14   s.description = \"\u65e5\u4ed8\u3051\u306eFormatter\u3092\u3059\u308bgem\"\n 15   s.license     = \"MIT\"\n 16\n 17   s.files = Dir[\"{app,config,db,lib}/**/*\", \"MIT-LICENSE\", \"Rakefile\", \"README.rdoc\"    ]\n 18   s.test_files = Dir[\"test/**/*\"]\n 19\n 20   s.add_dependency \"rails\", \"~> 4.2.6\"\n 21\n 22   s.add_development_dependency \"sqlite3\"\n 23   s.add_development_dependency \"ridgepole\"\n 24 end\n```\n2-2. <code>lib/dog_formatter/model.rb</code>\u3092\u4f5c\u6210\u3057\u7de8\u96c6\n\u4eca\u56de\u306egem\u306f\u300c~_at\u300d\u3000\u3063\u3066\u540d\u524d\u306e\u30ab\u30e9\u30e0\u304c\u3042\u3063\u305f\u3089\u3001\u305d\u308c\u306e\u30ab\u30e9\u30e0\u306b\u5bfe\u3057\u81ea\u52d5\u7684\u306b\u300c~_at_ymd\u300d\u3068\u3044\u540d\u524d\u306e\u30e1\u30bd\u30c3\u30c9\u3092\u8ffd\u52a0\u3059\u308bgem\u306a\u306e\u3067ActiveRecord\u3092\u62e1\u5f35\u3059\u308b\u3068\u3044\u3046\u610f\u5473\u304b\u3089model\u3063\u3066\u540d\u524d\u306e\u30af\u30e9\u30b9\u3092\u4f5c\u6210\u3057\u3066\u305d\u3053\u306b\u66f8\u304f\u3053\u3068\u306b\u3057\u307e\u3057\u305f\u3002\n\n```lib/dog_formatter/model.rb\n  1 module DogFormatter\n  2   module Model\n  3    extend ActiveSupport::Concern\n  4\n  5    included do\n  6    end\n  7\n  8     def method_missing(method_name, *_args, &_block)\n  9       method_name_suffix =  matched_method_name_suffix(method_name.to_s)\n 10       return unless method_name_suffix\n 11\n 12       suffix_pattern = Regexp.new(method_name_suffix)\n 13       attribute_name_except_format_value = method_name.to_s.sub!(suffix_pattern, '')\n 14\n 15       return unless exist_column?(attribute_name_except_format_value)\n 16\n 17       formatted_with_method_name_suffix(attribute_name_except_format_value, method_n    ame_suffix)\n 18     end\n 19\n 20     private\n 21     def format_suffixs\n 22       ['_ymd', '_ymd_ja', '_ym', '_ym_ja']\n 23     end\n 24\n 25     def matched_method_name_suffix(method_name)\n 26       format_suffixs.each { |suffix| return suffix if method_name.end_with?(suffix)     }\n 27     end\n 28\n 29     def date_columns\n 30       self.class.column_names.select { |column_name| column_name =~ /.*_at/ } # TODO: \u3061\u3083\u3093\u3068\u30c7\u30fc\u30bf\u306e\u578b\u3082\u898b\u308b\u3088\u3046\u306b\u3059\u308b\n 31     end\n 32\n 33     def exist_column?(attribute_name)\n 34       date_columns.include?(attribute_name)\n 35     end\n36\n 37     def formatted_with_method_name_suffix(attribute_name, method_name_suffix)\n 38       read_attribute(attribute_name).strftime(format_text(method_name_suffix))\n 39     end\n 40\n 41     def format_text(method_name_suffix)\n 42       # TODO: \u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u306a\u3069\u306b\u5916\u51fa\u3057\u3057\u305f\u3082\u306e\u3092\u8aad\u307f\u8fbc\u3080\u5f62\u5f0f\u306b\u5909\u66f4\u3059\u308b\n 43       case method_name_suffix\n 44       when '_ymd'\n 45         '%Y/%m/%d'\n 46       when '_ymd_ja'\n 47         '%Y\u5e74%m\u6708%d\u65e5'\n 48       when '_ym'\n 49         '%Y/%m'\n 50       when '_ym_ja'\n 51         '%Y\u5e74%m\u6708'\n 52       else\n 53         raise '\u5909\u63db\u3067\u304d\u307e\u305b\u3093\u3002\u8a72\u5f53\u3059\u308b\u65e5\u4ed8\u5f62\u5f0f\u304c\u3042\u308a\u307e\u305b\u3093'\n 54       end\n 55     end\n 56   end\n 57 end\n 58\n 59 ActiveRecord::Base.send :include, DogFormatter::Model\n```\n\n3.test\n\u30c6\u30b9\u30c8\u3067\u306fActiveRecord\u3092\u4f7f\u3063\u3066\u5b9f\u969b\u306e\u52d5\u304d\u3092\u78ba\u8a8d\u3057\u305f\u3044\u306e\u3067\u3001ridgepole\u3092\u4f7f\u3063\u3066\u7c21\u5358\u306b\u30c6\u30fc\u30d6\u30eb\u3092\u4f5c\u3063\u3066\u3084\u308a\u307e\u3057\u305f\u3002\n\uff13\u2212\uff11.\u30c6\u30fc\u30d6\u30eb\u4f5c\u6210\nridgepole\u306e\u30b9\u30ad\u30fc\u30de\u30d5\u30a1\u30a4\u30eb\u306f\u6b21\u306e\u3088\u3046\u306b\u66f8\u304d\u3001ridgepole\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3055\u305b\u3066\u30c6\u30fc\u30d6\u30eb\u4f5c\u6210\u3057\u307e\u3057\u305f\u3002(\u8a73\u7d30\u306f\u7701\u7565\uff09\n\n\n```test/dummy/db/schemas/users.schema\n1 create_table \"users\", force: :cascade do |t|\n2   t.string   \"name\",               limit: 255\n3   t.datetime \"created_at\"\n4   t.datetime \"updated_at\"\n5 end\n```\n\n4.github\u3078\u306e\u767b\u9332\ngithub\u306bpush\u3002(\u8a73\u7d30\u306f\u7701\u7565\uff09\n\n5.rubygem\u3078\u306e\u767b\u9332\n[\u3053\u3061\u3089](http://qiita.com/katsuhiko/items/bc99e8580d8cbbc35f31)\u3092\u53c2\u7167\u3055\u305b\u3066\u3044\u305f\u3060\u304d\u307e\u3057\u305f\u3002\n5-1. rubygem\u306bsign up\n[\u3053\u3061\u3089](https://rubygems.org/sign_up)\u3067e-mail/handle\u540d/password(\uff11\uff10\u6587\u5b57\u4ee5\u4e0a)\u3092\u5165\u308c\u3066\u767b\u9332\n5-2. rubygem\u306eapi\u30a2\u30af\u30bb\u30b9\u30ad\u30fc\u306e\u767b\u9332\n<code>curl -u Handle\u540d https://rubygems.org/api/v1/api_key.yaml > ~/.gem/credentials; chmod 0600 ~/.gem/credentials</code>\n\n6.\u3044\u3056\u3001release!\n\u3053\u3053\u307e\u3067\u304d\u305f\u3089\u3044\u3088\u3044\u3088\u30ea\u30ea\u30fc\u30b9\u3067\u3059\u3002\n\n```\n> bundle exec rake release\n```\n\n# \u4f7f\u3063\u3066\u307f\u308b\n\u601d\u3063\u305f\u3088\u3046\u306a\u52d5\u4f5c\u3092\u3057\u3066\u3044\u308b :smile: \n\n```\n1 require 'dog_formatter/model'\n2\n3 class User < ActiveRecord::Base\n4 end\n```\n\n```\nuser.created_at_ymd\n=> \"2016/11/04\"\nuser.created_at_ymd_ja\n=> \"2016\u5e7411\u670804\u65e5\"\nuser.created_at_ym\n=> \"2016/11\"\nuser.created_at_ym_ja\n=> \"2016\u5e7411\u6708\"\n```\n\n# \u6240\u611f\n\u4ed6\u3067\u3082\u4f7f\u3048\u308b\u3088\u3046\u306a\u5171\u901a\u51e6\u7406\u306f\u306fgem\u5316\u3059\u308b\u3068\u826f\u3044\u306a\u3068\u306f\u601d\u3063\u3066\u3044\u305f\u306e\u3067\u3001\u3053\u308c\u304b\u3089\u307e\u305f\u8272\u3005\u3068\u4f5c\u3063\u3066\u307f\u305f\u3044\u3068\u601d\u3044\u307e\u3057\u305f\u3002\n"}