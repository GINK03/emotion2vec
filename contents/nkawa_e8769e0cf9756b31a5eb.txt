{"context": " More than 1 year has passed since last update.\n\n\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u3092\u30af\u30ec\u30f3\u30b8\u30f3\u30b0\n\u30e1\u30fc\u30ea\u30f3\u30b0\u30ea\u30b9\u30c8\u306e\u7ba1\u7406\u3092\u3057\u3066\u3044\u305f\u308a\u3001\u540d\u7c3f\u306e\u6574\u7406\u3092\u3057\u3066\u3044\u308b\u3068\u3001\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u3092\u7ba1\u7406\u3057\u305f\u304f\u306a\u308b\u3053\u3068\u3042\u308a\u307e\u3059\u3088\u306d\u3002\n\u3067\u3001\u3053\u308c\u307e\u3067\u306f\u3001\u6bce\u56de\u30b7\u30a7\u30eb\u30b9\u30af\u30ea\u30d7\u30c8\u3067 uniq, sort \u3068\u304b\u3057\u3066\u305f\u306e\u3067\u3059\u304c\u3001\u524d\u5f8c\u306e\u30ab\u30c3\u30b3\u3092\u7701\u3044\u305f\u308a\u3001\u30b3\u30f3\u30de\u3084\u6539\u884c\u3092\u5909\u3048\u305f\u308a\u3068\u3001\u30a4\u30e4\u30fc\u306a\u611f\u3058\u3067\u3057\u305f\u3002\u7279\u306b\u30a2\u30c9\u30ec\u30b9\u304c\u91cd\u8907\u3057\u3066\u305f\u308a\u3059\u308b\u3068\u9762\u5012\u3002\n\u307e\u305f\u3001\u30a2\u30c9\u30ec\u30b9\u3092\u9006\u9806\u306b\u30c9\u30e1\u30a4\u30f3\u6bce\u306b\u6574\u7406\u3057\u305f\u3044\uff08\u4e26\u3079\u305f\u3044\uff09\u3053\u3068\u3063\u3066\u3042\u308a\u307e\u3059\u3088\u306d\uff1f\n\u3067\u3001\u4eca\u56deNode-red \u306e\u52c9\u5f37\u304c\u3066\u3089\u3001\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u3092\u30af\u30ec\u30f3\u30b8\u30f3\u30b0\u3059\u308b Web\u30b5\u30fc\u30d3\u30b9\u3092\u4f5c\u3063\u3066\u307f\u307e\u3057\u305f\u3002\nNode-red \u306e\u30b5\u30a4\u30c8\u306b\u30c7\u30d7\u30ed\u30a4\u3057\u3066\u3000\"/MailClean\" \u3092\u30a2\u30af\u30bb\u30b9\u3059\u308b\u3068\uff0c\u4ee5\u4e0b\u306e\u30d5\u30a9\u30fc\u30e0\u304c\u51fa\u307e\u3059\u3002\n\u3053\u306e\u30c6\u30ad\u30b9\u30c8\u30a8\u30ea\u30a2\u306b\u3001\u9069\u5f53\u306a\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u3092\u5165\u308c\u307e\u3059\u3002CC \u306b\u66f8\u3044\u3066\u3042\u308b\u3088\u3046\u306a\u306e\u3092\u76f4\u63a5\u30c9\u30ab\u30fc\u30f3\u3068\u5165\u308c\u308b\u3060\u3051\u3067\u52d5\u304f\u306f\u305a\u3067\u3059\u3002\n\n\u304a\u8a66\u3057\u3042\u308c\u3002\u500b\u4eba\u7684\u306b\u306f\u3068\u3063\u3066\u3082\u4fbf\u5229\uff01\n\uff08\u30b3\u30fc\u30c9\u306f\u975e\u5e38\u306b\u60c5\u3051\u306a\u3044\u306e\u3067\u8aad\u307e\u306a\u3044\u30c7\u30fc\u3002\u3002\u3002\uff09\n\u306a\u304a\u30b3\u30fc\u30c9\u306f\u3001\u4ee5\u4e0b\u3092 Node-red \u306b\u30a4\u30f3\u30dd\u30fc\u30c8\u3057\u3066\u3082\u3089\u3048\u308c\u3070\uff2f\uff2b\u3067\u3059\u3002\n\nnode\n[{\"id\":\"2216a8b6.dde958\",\"type\":\"http in\",\"name\":\"MailClean\",\"url\":\"/MailClean\",\"method\":\"get\",\"swaggerDoc\":\"\",\"x\":197.51483154296875,\"y\":253.5407485961914,\"z\":\"f183c3c.f0e7c4\",\"wires\":[[\"63ba28e2.9c45d8\"]]},{\"id\":\"ad9bb4a0.526448\",\"type\":\"http response\",\"name\":\"\",\"x\":587.5148315429688,\"y\":307.5407485961914,\"z\":\"f183c3c.f0e7c4\",\"wires\":[]},{\"id\":\"63ba28e2.9c45d8\",\"type\":\"template\",\"name\":\"Form Template\",\"field\":\"payload\",\"format\":\"html\",\"template\":\"<HTML>\\n    <head>\\n        <title> Mail Address Cleaning</title>\\n    </head>\\n    <body>\\n        \\n        Mail Address Cleaning\\n        <form method=\\\"post\\\">\\n            \\n            <textarea cols=\\\"80\\\" rows=\\\"50\\\" name=\\\"addresses\\\" >\\n                please put mail addresses\\n            </textarea>\\n            <br>\\n            <input type=\\\"checkbox\\\" name=\\\"comma\\\" />\\n            \u30b3\u30f3\u30de\u3067\u5206\u5272\u3059\u308b\uff1f\\n            <br>\\n            <input type=\\\"checkbox\\\" name=\\\"ret\\\" checked=\\\"checked\\\"/>\\n            \u6539\u884c\u3059\u308b\uff1f\\n            <br>\\n            <input type=\\\"checkbox\\\" name=\\\"rev\\\" />\\n            \u53cd\u8ee2\u3059\u308b\uff1f\\n            <br>\\n            <input type=\\\"checkbox\\\" name=\\\"sort\\\" />\\n            \u30bd\u30fc\u30c8\u3059\u308b\uff1f\\n            <br>\\n            <input type=\\\"checkbox\\\" name=\\\"uniq\\\" />\\n            uniq\u3059\u308b?\\n            <br>\\n            <button> Doit! </button>\\n        </form>\\n        \\n\\n    </body>\\n    \\n    \\n    \\n</HTML>\",\"x\":397.51483154296875,\"y\":274.5407485961914,\"z\":\"f183c3c.f0e7c4\",\"wires\":[[\"ad9bb4a0.526448\"]]},{\"id\":\"f2cd30c8.0d32d\",\"type\":\"http in\",\"name\":\"MailClean POST\",\"url\":\"/MailClean\",\"method\":\"post\",\"swaggerDoc\":\"\",\"x\":188.51483154296875,\"y\":428.5407485961914,\"z\":\"f183c3c.f0e7c4\",\"wires\":[[\"8ff2665c.700d98\"]]},{\"id\":\"8ff2665c.700d98\",\"type\":\"function\",\"name\":\"Check Mail\",\"func\":\"var ads = msg.payload.addresses;\\nvar com = msg.payload.comma;\u3000//\u30b3\u30f3\u30de\\nvar ret = msg.payload.ret;// \u6539\u884c\\nvar rev = msg.payload.rev;// \u53cd\u8ee2\\n\\n//\\\"<\\\" \\\">\\\" \u3067\u533a\u5207\u308b\\n\\nvar splitter = /[<>\\\\r\\\\n\\\\t ]/;\\n\\nvar dds = ads.split(splitter);\\n\\n// \u3053\u3053\u304b\u306f\u30d5\u30a3\u30eb\u30bf\\n\\nvar isMail = /^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\\\\.[a-zA-Z0-9-]+)*$/;\\n\\nvar res = [];\\n\\nfor (var i = 0; i < dds.length; i++){\\n    var match=isMail.exec(dds[i]);\\n    if(match !== null){\\n        res.push(match[0]);\\n    }\\n}\\n\\nif(msg.payload.sort ==\\\"on\\\"){// sort option!\\n    res.sort();\\n    //function(a,b){\\n    //    if(a < b ) return -1;\\n    //    if(b > a ) return 1;\\n    //    return 0;\\n    //});\\n}\\n\\n\\nvar res2=[];\\nif(msg.payload.uniq == \\\"on\\\"){ // uniq option!\\n    var last = \\\"\\\";\\n    for(var i = 0; i < res.length; i++){\\n        if(last != res[i]){\\n            res2.push(res[i]);\\n        }\\n        last = res[i];\\n    }\\n    res = res2;\\n}\\n\\n\\nvar out = \\\"\\\";\\n\\n\\n\\nfor( var i = 0; i < res.length; i++){\\n    if(rev==\\\"on\\\") {\\n        out = out+res[i].split(\\\"\\\").reverse().join(\\\"\\\");// \u53cd\u8ee2\u6587\u5b57\u5217\u3092\u8ffd\u52a0\\n    }else{\\n        out = out+res[i];\\n    }\\n    if(com==\\\"on\\\") out = out +\\\",\\\";\\n    if(ret==\\\"on\\\") out = out+\\\"\\\\n\\\";\\n    \\n}\\n\\nmsg.payload = out;\\n\\nreturn msg;\",\"outputs\":1,\"noerr\":0,\"x\":322.51483154296875,\"y\":531.5406875610352,\"z\":\"f183c3c.f0e7c4\",\"wires\":[[\"28841218.d77bee\"]]},{\"id\":\"28841218.d77bee\",\"type\":\"template\",\"name\":\"Result\",\"field\":\"payload\",\"format\":\"html\",\"template\":\"<HTML>\\n    <BODY>\\n        <pre>\\n{{payload}}\\n        </pre>\\n    </BODY>\\n\\n</HTML>\",\"x\":376.51483154296875,\"y\":703.5407333374023,\"z\":\"f183c3c.f0e7c4\",\"wires\":[[\"a8522596.57add8\"]]},{\"id\":\"a8522596.57add8\",\"type\":\"http response\",\"name\":\"\",\"x\":631.5148315429688,\"y\":716.5406875610352,\"z\":\"f183c3c.f0e7c4\",\"wires\":[]}]\n\n\n#\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u3092\u30af\u30ec\u30f3\u30b8\u30f3\u30b0\n\n\u30e1\u30fc\u30ea\u30f3\u30b0\u30ea\u30b9\u30c8\u306e\u7ba1\u7406\u3092\u3057\u3066\u3044\u305f\u308a\u3001\u540d\u7c3f\u306e\u6574\u7406\u3092\u3057\u3066\u3044\u308b\u3068\u3001\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u3092\u7ba1\u7406\u3057\u305f\u304f\u306a\u308b\u3053\u3068\u3042\u308a\u307e\u3059\u3088\u306d\u3002\n\n\u3067\u3001\u3053\u308c\u307e\u3067\u306f\u3001\u6bce\u56de\u30b7\u30a7\u30eb\u30b9\u30af\u30ea\u30d7\u30c8\u3067 uniq, sort \u3068\u304b\u3057\u3066\u305f\u306e\u3067\u3059\u304c\u3001\u524d\u5f8c\u306e\u30ab\u30c3\u30b3\u3092\u7701\u3044\u305f\u308a\u3001\u30b3\u30f3\u30de\u3084\u6539\u884c\u3092\u5909\u3048\u305f\u308a\u3068\u3001\u30a4\u30e4\u30fc\u306a\u611f\u3058\u3067\u3057\u305f\u3002\u7279\u306b\u30a2\u30c9\u30ec\u30b9\u304c\u91cd\u8907\u3057\u3066\u305f\u308a\u3059\u308b\u3068\u9762\u5012\u3002\n\u307e\u305f\u3001\u30a2\u30c9\u30ec\u30b9\u3092\u9006\u9806\u306b\u30c9\u30e1\u30a4\u30f3\u6bce\u306b\u6574\u7406\u3057\u305f\u3044\uff08\u4e26\u3079\u305f\u3044\uff09\u3053\u3068\u3063\u3066\u3042\u308a\u307e\u3059\u3088\u306d\uff1f\n\n\u3067\u3001\u4eca\u56deNode-red \u306e\u52c9\u5f37\u304c\u3066\u3089\u3001\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u3092\u30af\u30ec\u30f3\u30b8\u30f3\u30b0\u3059\u308b Web\u30b5\u30fc\u30d3\u30b9\u3092\u4f5c\u3063\u3066\u307f\u307e\u3057\u305f\u3002\n\nNode-red \u306e\u30b5\u30a4\u30c8\u306b\u30c7\u30d7\u30ed\u30a4\u3057\u3066\u3000\"/MailClean\" \u3092\u30a2\u30af\u30bb\u30b9\u3059\u308b\u3068\uff0c\u4ee5\u4e0b\u306e\u30d5\u30a9\u30fc\u30e0\u304c\u51fa\u307e\u3059\u3002\n\u3053\u306e\u30c6\u30ad\u30b9\u30c8\u30a8\u30ea\u30a2\u306b\u3001\u9069\u5f53\u306a\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u3092\u5165\u308c\u307e\u3059\u3002CC \u306b\u66f8\u3044\u3066\u3042\u308b\u3088\u3046\u306a\u306e\u3092\u76f4\u63a5\u30c9\u30ab\u30fc\u30f3\u3068\u5165\u308c\u308b\u3060\u3051\u3067\u52d5\u304f\u306f\u305a\u3067\u3059\u3002\n\n![MailClean.png](https://qiita-image-store.s3.amazonaws.com/0/28113/a9ede898-32af-0ab6-80ac-ead7d63d7fd5.png)\n\n\u304a\u8a66\u3057\u3042\u308c\u3002\u500b\u4eba\u7684\u306b\u306f\u3068\u3063\u3066\u3082\u4fbf\u5229\uff01\n\uff08\u30b3\u30fc\u30c9\u306f\u975e\u5e38\u306b\u60c5\u3051\u306a\u3044\u306e\u3067\u8aad\u307e\u306a\u3044\u30c7\u30fc\u3002\u3002\u3002\uff09\n\n\n\u306a\u304a\u30b3\u30fc\u30c9\u306f\u3001\u4ee5\u4e0b\u3092 Node-red \u306b\u30a4\u30f3\u30dd\u30fc\u30c8\u3057\u3066\u3082\u3089\u3048\u308c\u3070\uff2f\uff2b\u3067\u3059\u3002\n\n```js:node\n[{\"id\":\"2216a8b6.dde958\",\"type\":\"http in\",\"name\":\"MailClean\",\"url\":\"/MailClean\",\"method\":\"get\",\"swaggerDoc\":\"\",\"x\":197.51483154296875,\"y\":253.5407485961914,\"z\":\"f183c3c.f0e7c4\",\"wires\":[[\"63ba28e2.9c45d8\"]]},{\"id\":\"ad9bb4a0.526448\",\"type\":\"http response\",\"name\":\"\",\"x\":587.5148315429688,\"y\":307.5407485961914,\"z\":\"f183c3c.f0e7c4\",\"wires\":[]},{\"id\":\"63ba28e2.9c45d8\",\"type\":\"template\",\"name\":\"Form Template\",\"field\":\"payload\",\"format\":\"html\",\"template\":\"<HTML>\\n    <head>\\n        <title> Mail Address Cleaning</title>\\n    </head>\\n    <body>\\n        \\n        Mail Address Cleaning\\n        <form method=\\\"post\\\">\\n            \\n            <textarea cols=\\\"80\\\" rows=\\\"50\\\" name=\\\"addresses\\\" >\\n                please put mail addresses\\n            </textarea>\\n            <br>\\n            <input type=\\\"checkbox\\\" name=\\\"comma\\\" />\\n            \u30b3\u30f3\u30de\u3067\u5206\u5272\u3059\u308b\uff1f\\n            <br>\\n            <input type=\\\"checkbox\\\" name=\\\"ret\\\" checked=\\\"checked\\\"/>\\n            \u6539\u884c\u3059\u308b\uff1f\\n            <br>\\n            <input type=\\\"checkbox\\\" name=\\\"rev\\\" />\\n            \u53cd\u8ee2\u3059\u308b\uff1f\\n            <br>\\n            <input type=\\\"checkbox\\\" name=\\\"sort\\\" />\\n            \u30bd\u30fc\u30c8\u3059\u308b\uff1f\\n            <br>\\n            <input type=\\\"checkbox\\\" name=\\\"uniq\\\" />\\n            uniq\u3059\u308b?\\n            <br>\\n            <button> Doit! </button>\\n        </form>\\n        \\n\\n    </body>\\n    \\n    \\n    \\n</HTML>\",\"x\":397.51483154296875,\"y\":274.5407485961914,\"z\":\"f183c3c.f0e7c4\",\"wires\":[[\"ad9bb4a0.526448\"]]},{\"id\":\"f2cd30c8.0d32d\",\"type\":\"http in\",\"name\":\"MailClean POST\",\"url\":\"/MailClean\",\"method\":\"post\",\"swaggerDoc\":\"\",\"x\":188.51483154296875,\"y\":428.5407485961914,\"z\":\"f183c3c.f0e7c4\",\"wires\":[[\"8ff2665c.700d98\"]]},{\"id\":\"8ff2665c.700d98\",\"type\":\"function\",\"name\":\"Check Mail\",\"func\":\"var ads = msg.payload.addresses;\\nvar com = msg.payload.comma;\u3000//\u30b3\u30f3\u30de\\nvar ret = msg.payload.ret;// \u6539\u884c\\nvar rev = msg.payload.rev;// \u53cd\u8ee2\\n\\n//\\\"<\\\" \\\">\\\" \u3067\u533a\u5207\u308b\\n\\nvar splitter = /[<>\\\\r\\\\n\\\\t ]/;\\n\\nvar dds = ads.split(splitter);\\n\\n// \u3053\u3053\u304b\u306f\u30d5\u30a3\u30eb\u30bf\\n\\nvar isMail = /^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\\\\.[a-zA-Z0-9-]+)*$/;\\n\\nvar res = [];\\n\\nfor (var i = 0; i < dds.length; i++){\\n    var match=isMail.exec(dds[i]);\\n    if(match !== null){\\n        res.push(match[0]);\\n    }\\n}\\n\\nif(msg.payload.sort ==\\\"on\\\"){// sort option!\\n    res.sort();\\n    //function(a,b){\\n    //    if(a < b ) return -1;\\n    //    if(b > a ) return 1;\\n    //    return 0;\\n    //});\\n}\\n\\n\\nvar res2=[];\\nif(msg.payload.uniq == \\\"on\\\"){ // uniq option!\\n    var last = \\\"\\\";\\n    for(var i = 0; i < res.length; i++){\\n        if(last != res[i]){\\n            res2.push(res[i]);\\n        }\\n        last = res[i];\\n    }\\n    res = res2;\\n}\\n\\n\\nvar out = \\\"\\\";\\n\\n\\n\\nfor( var i = 0; i < res.length; i++){\\n    if(rev==\\\"on\\\") {\\n        out = out+res[i].split(\\\"\\\").reverse().join(\\\"\\\");// \u53cd\u8ee2\u6587\u5b57\u5217\u3092\u8ffd\u52a0\\n    }else{\\n        out = out+res[i];\\n    }\\n    if(com==\\\"on\\\") out = out +\\\",\\\";\\n    if(ret==\\\"on\\\") out = out+\\\"\\\\n\\\";\\n    \\n}\\n\\nmsg.payload = out;\\n\\nreturn msg;\",\"outputs\":1,\"noerr\":0,\"x\":322.51483154296875,\"y\":531.5406875610352,\"z\":\"f183c3c.f0e7c4\",\"wires\":[[\"28841218.d77bee\"]]},{\"id\":\"28841218.d77bee\",\"type\":\"template\",\"name\":\"Result\",\"field\":\"payload\",\"format\":\"html\",\"template\":\"<HTML>\\n    <BODY>\\n        <pre>\\n{{payload}}\\n        </pre>\\n    </BODY>\\n\\n</HTML>\",\"x\":376.51483154296875,\"y\":703.5407333374023,\"z\":\"f183c3c.f0e7c4\",\"wires\":[[\"a8522596.57add8\"]]},{\"id\":\"a8522596.57add8\",\"type\":\"http response\",\"name\":\"\",\"x\":631.5148315429688,\"y\":716.5406875610352,\"z\":\"f183c3c.f0e7c4\",\"wires\":[]}]\n```\n\n\n", "tags": ["Node.js", "node-red", "JavaScript", "mail", "cleaning"]}