{"context": " More than 1 year has passed since last update.\n\n\u5fc5\u8981\u306a\u3082\u306e\n\u30fbaws-cli\n\u30fbnode\n\ns3\u306b\u3042\u308b\u753b\u50cf\u3092gulp\u3092\u4f7f\u3063\u3066\u6700\u9069\u5316\u3059\u308b\u624b\u9806\n\ns3\u304b\u3089\u753b\u50cf\u3092\u6301\u3063\u3066\u304f\u308b\n\n mkdir s3\n aws s3 sync s3://[\u30d0\u30b1\u30c3\u30c8\u540d] s3\n\n\nnpm\u306e\u521d\u671f\u5316\u3068\u30d1\u30c3\u30b1\u30fc\u30b8\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n npm init\n npm install --save-dev gulp\n npm install --save-dev gulp-debug\n npm install --save-dev gulp-imagemin\n npm install --save-dev gulp-plumber\n npm install --save-dev gulp-image-resize1\n npm install --save-dev gulp-rename\n npm install --save-dev gulp-ignore\n\n\ngulpfile\u4f5c\u6210\n\n\ngulpfile.js\nvar gulp        = require('gulp');\nvar path        = require('path');\nvar debug       = require('gulp-debug');\nvar imagemin    = require('gulp-imagemin');\nvar plumber     = require('gulp-plumber');\nvar imageResize = require('gulp-image-resize');\nvar rename      = require(\"gulp-rename\");\nvar ignore      = require(\"gulp-ignore\");\nvar paths = {\n  srcDir : 's3',\n  dstDir : 'local'\n}\n// \u753b\u50cf\u306e\u30ea\u30b5\u30a4\u30ba\uff06\u6700\u9069\u5316\ngulp.task( 'imageresize', function(){\n        var srcGlob = paths.srcDir + '/**/*.+(jpg|jpeg|png|gif|svg)';\n        var dstGlob = paths.dstDir;\n        var imageWidth = 730;\n        var imageHeight = 306;\n\n        var imageminOptions = {\n            optimizationLevel: 7\n        };\n\n        gulp.src( srcGlob )\n        // \u753b\u50cf\u306e\u30ea\u30b5\u30a4\u30ba\n        .pipe(plumber())\n        .pipe(ignore.exclude(/-/))\n        .pipe(imageResize({\n            width: imageWidth,\n            height: imageHeight,\n            crop: true,\n            upscale: false\n        }))\n        // \u753b\u50cf\u306e\u6700\u9069\u5316\n        .pipe(imagemin( imageminOptions ))\n        // \u30d5\u30a1\u30a4\u30eb\u540d\u5909\u66f4\n        .pipe(rename(function(path){ path.basename += \"-\"+imageWidth+\"x\"+imageHeight}))\n        .pipe(debug({title: 'image:'}))\n        // \u30d5\u30a1\u30a4\u30eb\u79fb\u52d5\n        .pipe(gulp.dest( dstGlob ));\n});\n\n\n\n\ngulp\u5b9f\u884c\n\n mkdir local\n gulp imageresize\n\n\ns3\u306b\u30d5\u30a1\u30a4\u30eb\u3092upload\n\n aws s3 sync local s3://[\u30d0\u30b1\u30c3\u30c8\u540d]/ --expires 2025-6-18 --recursive --acl public-read\n\n\n\u306f\u307e\u3063\u305f\u30dd\u30a4\u30f3\u30c8\n\u30fbwordpress\u306e\u5834\u5408\u3001postmeta\u30c7\u30fc\u30bf\u3082\u66f8\u304d\u63db\u3048\u306a\u3044\u3068\u3044\u3051\u306a\u304b\u3063\u305f\u3002\n\u30fb--acl\u3092\u6307\u5b9a\u305b\u305a\u306bsync\u3059\u308b\u3068\u3001\u306a\u305c\u304bs3\u306e\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u304cprivate\u306b\u306a\u3063\u3066\u3057\u307e\u3044\u3001cloudfront\u3067AccessDenied\uff01\u4e00\u6642\u753b\u50cf\u304c\u898b\u308c\u306a\u304f\u306a\u3063\u305f\n\n## \u5fc5\u8981\u306a\u3082\u306e\n\u30fbaws-cli\n\u30fbnode\n\n## s3\u306b\u3042\u308b\u753b\u50cf\u3092gulp\u3092\u4f7f\u3063\u3066\u6700\u9069\u5316\u3059\u308b\u624b\u9806\n\n\n1. s3\u304b\u3089\u753b\u50cf\u3092\u6301\u3063\u3066\u304f\u308b\n\n ```\n mkdir s3\n aws s3 sync s3://[\u30d0\u30b1\u30c3\u30c8\u540d] s3\n ```\n\n2. npm\u306e\u521d\u671f\u5316\u3068\u30d1\u30c3\u30b1\u30fc\u30b8\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n ``` \n npm init\n npm install --save-dev gulp\n npm install --save-dev gulp-debug\n npm install --save-dev gulp-imagemin\n npm install --save-dev gulp-plumber\n npm install --save-dev gulp-image-resize1\n npm install --save-dev gulp-rename\n npm install --save-dev gulp-ignore\n ```\n\n3. gulpfile\u4f5c\u6210\n\n ```gulpfile.js\nvar gulp        = require('gulp');\nvar path        = require('path');\nvar debug       = require('gulp-debug');\nvar imagemin    = require('gulp-imagemin');\nvar plumber     = require('gulp-plumber');\nvar imageResize = require('gulp-image-resize');\nvar rename      = require(\"gulp-rename\");\nvar ignore      = require(\"gulp-ignore\");\nvar paths = {\n  srcDir : 's3',\n  dstDir : 'local'\n}\n// \u753b\u50cf\u306e\u30ea\u30b5\u30a4\u30ba\uff06\u6700\u9069\u5316\ngulp.task( 'imageresize', function(){\n\t\tvar srcGlob = paths.srcDir + '/**/*.+(jpg|jpeg|png|gif|svg)';\n  \t\tvar dstGlob = paths.dstDir;\n  \t\tvar imageWidth = 730;\n  \t\tvar imageHeight = 306;\n\n  \t\tvar imageminOptions = {\n  \t\t\toptimizationLevel: 7\n  \t\t};\n\n  \t\tgulp.src( srcGlob )\n  \t\t// \u753b\u50cf\u306e\u30ea\u30b5\u30a4\u30ba\n  \t\t.pipe(plumber())\n  \t\t.pipe(ignore.exclude(/-/))\n  \t\t.pipe(imageResize({\n    \t\twidth: imageWidth,\n    \t\theight: imageHeight,\n    \t\tcrop: true,\n    \t\tupscale: false\n  \t\t}))\n  \t\t// \u753b\u50cf\u306e\u6700\u9069\u5316\n  \t\t.pipe(imagemin( imageminOptions ))\n  \t\t// \u30d5\u30a1\u30a4\u30eb\u540d\u5909\u66f4\n  \t\t.pipe(rename(function(path){ path.basename += \"-\"+imageWidth+\"x\"+imageHeight}))\n\t  \t.pipe(debug({title: 'image:'}))\n\t  \t// \u30d5\u30a1\u30a4\u30eb\u79fb\u52d5\n  \t\t.pipe(gulp.dest( dstGlob ));\n});\n\n ```\n \n4. gulp\u5b9f\u884c\n\n ```\n mkdir local\n gulp imageresize\n ```\n\n5. s3\u306b\u30d5\u30a1\u30a4\u30eb\u3092upload\n\n ```\n aws s3 sync local s3://[\u30d0\u30b1\u30c3\u30c8\u540d]/ --expires 2025-6-18 --recursive --acl public-read\n ```\n \n## \u306f\u307e\u3063\u305f\u30dd\u30a4\u30f3\u30c8\n\u30fbwordpress\u306e\u5834\u5408\u3001postmeta\u30c7\u30fc\u30bf\u3082\u66f8\u304d\u63db\u3048\u306a\u3044\u3068\u3044\u3051\u306a\u304b\u3063\u305f\u3002\n\u30fb```--acl```\u3092\u6307\u5b9a\u305b\u305a\u306bsync\u3059\u308b\u3068\u3001\u306a\u305c\u304bs3\u306e\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u304cprivate\u306b\u306a\u3063\u3066\u3057\u307e\u3044\u3001cloudfront\u3067AccessDenied\uff01\u4e00\u6642\u753b\u50cf\u304c\u898b\u308c\u306a\u304f\u306a\u3063\u305f\n", "tags": ["aws-cli", "gulp", "\u753b\u50cf\u6700\u9069\u5316", "S3"]}