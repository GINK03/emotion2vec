{"tags": ["AWS", "Kinesis"], "context": "Kinesis\u3092\u4f7f\u304a\u3046\u3068\u3057\u3066\u3001Producer\u306bfluentd\u4ee5\u5916\u306b\n\u6700\u8fd1\u300cKinesis \u30a8\u30fc\u30b8\u30a7\u30f3\u30c8\u300d\u3068\u3044\u3046\u3082\u306e\u304c\u3042\u308b\u4e8b\u3092\u77e5\u3063\u305f\u306e\u3067\u8a66\u3057\u3066\u307f\u308b\u3002\n\n\u30a8\u30fc\u30b8\u30a7\u30f3\u30c8\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\nhttp://docs.aws.amazon.com/ja_jp/kinesis/latest/dev/writing-with-agents.html\n\u3053\u3061\u3089\u3092\u53c2\u8003\u306b\u3057\u3066\u9032\u3081\u305f\u304c\u3001\u82e5\u5e72\u5206\u304b\u308a\u3065\u3089\u3044\u6240\u3082\u3042\u3063\u305f\u306e\u3067\u30e1\u30e2\u3059\u308b\u3002\n\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u30b5\u30fc\u30d0(EC2)\u306b\u3001\u30a8\u30fc\u30b8\u30a7\u30f3\u30c8\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\u3002\nsudo yum install \u2013y aws-kinesis-agent\n\n\n\u30a8\u30fc\u30b8\u30a7\u30f3\u30c8\u8a2d\u5b9a\n/etc/aws-kinesis/agent.json\n\u3092\u7de8\u96c6\u3059\u308b\u3002\n{\n  \"cloudwatch.emitMetrics\": true,\n  \"cloudwatch.endpoint\": \"monitoring.ap-northeast-1.amazonaws.com\",\n  \"kinesis.endpoint\": \"https://kinesis.ap-northeast-1.amazonaws.com\",\n  \"awsAccessKeyId\": \"ACCESSKEY\",\n  \"awsSecretAccessKey\": \"SECRETKEY\",\n  \"flows\": [\n    {\n      \"filePattern\": \"/tmp/app.log*\",\n      \"kinesisStream\": \"yourkinesisstream\"\n    }\n  ]\n}\n\n\n\nkinesis.endpoint \u3092\u8a2d\u5b9a\u3057\u3066\u3044\u306a\u3044\u3068\u3001\u30ed\u30b0\u306b\u4e0b\u8a18\u306e\u5185\u5bb9\u304c\u51fa\u529b\u3055\u308c\u3066\u30d1\u30fc\u30b9\u307e\u3067\u306f\u884c\u3046\u304c\u9001\u4fe1\u3057\u306a\u3044\u3067\u7d42\u308f\u308b\u3002  \nXXX records parsed (XXX bytes), and 0 records sent successfully to destinations\n\n\ncloudwatch.emitMetrics cloudwatch.endpoint \u3092\u8a2d\u5b9a\u3057\u3066\u304a\u3051\u3070\nCloudWatch\u306e\u30ab\u30b9\u30bf\u30e0\u30e1\u30c8\u30ea\u30af\u30b9\u3068\u3044\u3046\u6240\u306b\u3001AWSKinesisAgent\u3068\u3044\u3046\u9805\u76ee\u304c\u9078\u629e\u51fa\u6765\u308b\u3088\u3046\u306b\u306a\u3063\u3066\nBytesSent\u3001RecordSendAttempts\u3001RecordSendErrors\u3001ServiceErrors\u306a\u3069\u306e\u30e1\u30c8\u30ea\u30af\u30b9\u304c\u53d6\u308c\u308b\u3002\nhttp://docs.aws.amazon.com/ja_jp/kinesis/latest/dev/agent-health.html\nawsAccessKeyId\u3067\u8a2d\u5b9a\u3057\u305f\u30e6\u30fc\u30b6\u306b\u306f\u3001AmazonKinesisFullAccess\u306e\u3088\u3046\u306a\u30dd\u30ea\u30b7\u30fc\u6a29\u9650\u304c\u5fc5\u8981\u3002\n\n\n\u30a8\u30fc\u30b8\u30a7\u30f3\u30c8\u5b9f\u884c\n/etc/aws-kinesis/agent.json\n\u306e\u30b1\u30c4\u30ab\u30f3\u30de\u306b\u6ce8\u610f\u3057\u3066\u3001\u7de8\u96c6\u304c\u7d42\u308f\u3063\u305f\u3089\u30b5\u30fc\u30d3\u30b9\u3092\u8d77\u52d5\u3059\u308b\u3002\nsudo service aws-kinesis-agent start\n\n/var/log/aws-kinesis-agent/aws-kinesis-agent.log\n\u3053\u3053\u306b\u30ed\u30b0\u304c\u51fa\u529b\u3055\u308c\u308b\u3002\nKinesis Streams\u306e\u8a2d\u5b9a\u306f\u7701\u7565\u3057\u305f\u3051\u3069\n\u30b9\u30c8\u30ea\u30fc\u30e0\u540d\u3068\u3001\u30b7\u30e3\u30fc\u30c9\u6570\u306e\u8a2d\u5b9a\u3060\u3051\u306a\u306e\u3067\u3001\u305d\u3093\u306a\u306b\u30cf\u30de\u308b\u30dd\u30a4\u30f3\u30c8\u306f\u306a\u3044\u3002\nHappy Kinesising!!\nKinesis\u3092\u4f7f\u304a\u3046\u3068\u3057\u3066\u3001Producer\u306bfluentd\u4ee5\u5916\u306b\n\u6700\u8fd1\u300cKinesis \u30a8\u30fc\u30b8\u30a7\u30f3\u30c8\u300d\u3068\u3044\u3046\u3082\u306e\u304c\u3042\u308b\u4e8b\u3092\u77e5\u3063\u305f\u306e\u3067\u8a66\u3057\u3066\u307f\u308b\u3002\n\n## \u30a8\u30fc\u30b8\u30a7\u30f3\u30c8\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\nhttp://docs.aws.amazon.com/ja_jp/kinesis/latest/dev/writing-with-agents.html\n\u3053\u3061\u3089\u3092\u53c2\u8003\u306b\u3057\u3066\u9032\u3081\u305f\u304c\u3001\u82e5\u5e72\u5206\u304b\u308a\u3065\u3089\u3044\u6240\u3082\u3042\u3063\u305f\u306e\u3067\u30e1\u30e2\u3059\u308b\u3002\n\n\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u30b5\u30fc\u30d0(EC2)\u306b\u3001\u30a8\u30fc\u30b8\u30a7\u30f3\u30c8\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\u3002\n\n```\nsudo yum install \u2013y aws-kinesis-agent\n```\n\n## \u30a8\u30fc\u30b8\u30a7\u30f3\u30c8\u8a2d\u5b9a\n\n/etc/aws-kinesis/agent.json\n\u3092\u7de8\u96c6\u3059\u308b\u3002\n\n```\n{\n  \"cloudwatch.emitMetrics\": true,\n  \"cloudwatch.endpoint\": \"monitoring.ap-northeast-1.amazonaws.com\",\n  \"kinesis.endpoint\": \"https://kinesis.ap-northeast-1.amazonaws.com\",\n  \"awsAccessKeyId\": \"ACCESSKEY\",\n  \"awsSecretAccessKey\": \"SECRETKEY\",\n  \"flows\": [\n    {\n      \"filePattern\": \"/tmp/app.log*\",\n      \"kinesisStream\": \"yourkinesisstream\"\n    }\n  ]\n}\n```\n\n\n- `kinesis.endpoint` \u3092\u8a2d\u5b9a\u3057\u3066\u3044\u306a\u3044\u3068\u3001\u30ed\u30b0\u306b\u4e0b\u8a18\u306e\u5185\u5bb9\u304c\u51fa\u529b\u3055\u308c\u3066\u30d1\u30fc\u30b9\u307e\u3067\u306f\u884c\u3046\u304c\u9001\u4fe1\u3057\u306a\u3044\u3067\u7d42\u308f\u308b\u3002  \n\n    ```\n    XXX records parsed (XXX bytes), and 0 records sent successfully to destinations\n    ```\n\n- `cloudwatch.emitMetrics` `cloudwatch.endpoint` \u3092\u8a2d\u5b9a\u3057\u3066\u304a\u3051\u3070\n    CloudWatch\u306e\u30ab\u30b9\u30bf\u30e0\u30e1\u30c8\u30ea\u30af\u30b9\u3068\u3044\u3046\u6240\u306b\u3001AWSKinesisAgent\u3068\u3044\u3046\u9805\u76ee\u304c\u9078\u629e\u51fa\u6765\u308b\u3088\u3046\u306b\u306a\u3063\u3066\n    BytesSent\u3001RecordSendAttempts\u3001RecordSendErrors\u3001ServiceErrors\u306a\u3069\u306e\u30e1\u30c8\u30ea\u30af\u30b9\u304c\u53d6\u308c\u308b\u3002\n    http://docs.aws.amazon.com/ja_jp/kinesis/latest/dev/agent-health.html\n\n- awsAccessKeyId\u3067\u8a2d\u5b9a\u3057\u305f\u30e6\u30fc\u30b6\u306b\u306f\u3001AmazonKinesisFullAccess\u306e\u3088\u3046\u306a\u30dd\u30ea\u30b7\u30fc\u6a29\u9650\u304c\u5fc5\u8981\u3002\n\n## \u30a8\u30fc\u30b8\u30a7\u30f3\u30c8\u5b9f\u884c\n\n/etc/aws-kinesis/agent.json\n\u306e\u30b1\u30c4\u30ab\u30f3\u30de\u306b\u6ce8\u610f\u3057\u3066\u3001\u7de8\u96c6\u304c\u7d42\u308f\u3063\u305f\u3089\u30b5\u30fc\u30d3\u30b9\u3092\u8d77\u52d5\u3059\u308b\u3002\n\n```\nsudo service aws-kinesis-agent start\n```\n\n/var/log/aws-kinesis-agent/aws-kinesis-agent.log\n\u3053\u3053\u306b\u30ed\u30b0\u304c\u51fa\u529b\u3055\u308c\u308b\u3002\n\nKinesis Streams\u306e\u8a2d\u5b9a\u306f\u7701\u7565\u3057\u305f\u3051\u3069\n\u30b9\u30c8\u30ea\u30fc\u30e0\u540d\u3068\u3001\u30b7\u30e3\u30fc\u30c9\u6570\u306e\u8a2d\u5b9a\u3060\u3051\u306a\u306e\u3067\u3001\u305d\u3093\u306a\u306b\u30cf\u30de\u308b\u30dd\u30a4\u30f3\u30c8\u306f\u306a\u3044\u3002\n\nHappy Kinesising!!\n\n"}