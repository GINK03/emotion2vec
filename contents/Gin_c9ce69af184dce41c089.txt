{"context": " More than 1 year has passed since last update.\n\nRHEL7.1\u3067Docker\u3092\u5165\u308c\u3066\u3064\u307e\u3063\u3068\u3053\n\u516c\u5f0f\u30b5\u30a4\u30c8\u306b\u3042\u308b\u624b\u9806\u901a\u308aDocker\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u305f\u3089\u3001docker pull\u304c\u51fa\u6765\u307e\u305b\u3093\u3067\u3057\u305f\u3002\n\u3069\u3046\u3044\u3046\u3053\u3063\u3061\u3083\uff01\n\n\u74b0\u5883\u60c5\u5831\n[root system]# uname -a\nLinux xxxxx 3.10.0-229.el7.x86_64 #1 SMP Thu Jan 29 18:37:38 EST 2015 x86_64 x86_64 x86_64 GNU/Linux\n\n[root system]# docker version\nClient version: 1.6.2\nClient API version: 1.18\nGo version (client): go1.4.2\nGit commit (client): ba1f6c3/1.6.2\nOS/Arch (client): linux/amd64\nServer version: 1.6.2\nServer API version: 1.18\nGo version (server): go1.4.2\nGit commit (server): ba1f6c3/1.6.2\nOS/Arch (server): linux/amd64\n\n\n\n\u516c\u5f0f\u306e\u624b\u9806\n# RHEL\u306e\u8ffd\u52a0\u3001\u30ea\u30dd\u30b8\u30c8\u30ea\u8ffd\u52a0\nsubscription-manager register --username=rhnuser --password=rhnpasswd\nsubscription-manager list --available  Find pool ID for RHEL subscription\nsubscription-manager attach --pool=pool_id\nsubscription-manager repos --enable=rhel-7-server-extras-rpms\nsubscription-manager repos --enable=rhel-7-server-optional-rpms\n\n\n# docker\u8ffd\u52a0\nyum install docker docker-registry\nyum install device-mapper-libs device-mapper-event-libs\n\n# firewalld\u505c\u6b62\nsystemctl stop firewalld.service\nsystemctl disable firewalld.service\n\n# docker\u8d77\u52d5\nsystemctl start docker.service\nsystemctl enable docker.service\n\n# \u30ec\u30b8\u30b9\u30c8\u30ea\u8d77\u52d5\nsystemctl enable docker-registry\nsystemctl start docker-registry\nsystemctl status docker-registry\n\n# RHEL\u30a4\u30e1\u30fc\u30b8\u306e\u53d6\u5f97\ndocker pull registry.access.redhat.com/rhel\n\n\n\u30a8\u30e9\u30fc\u305d\u306e\uff11\uff08\u8a8d\u8a3c\u30a8\u30e9\u30fc\uff09\n[root /]# docker pull registry.access.redhat.com/rhel\nFATA[0015] Error response from daemon: v1 ping attempt failed with error: Get https://registry.access.redhat.com/v1/_ping: dial tcp: i/o timeout. If this private registry supports only HTTP or HTTPS with an unknown CA certificate, please add `--insecure-registry registry.access.redhat.com` to the daemon's arguments. In the case of HTTPS, if you have access to the registry's CA certificate, no need for the flag; simply place the CA certificate at /etc/docker/certs.d/registry.access.redhat.com/ca.crt\n\n\n\u5bfe\u7b56\u65b9\u6cd5\n/etc/sysconfig/docker\u5185\u3067\u8a18\u8f09\u3092\u8ffd\u8a18\n\n/etc/sysconfig/docker\nINSECURE_REGISTRY='--insecure-registry registry.access.redhat.com'\n\n\n\n\u30a8\u30e9\u30fc\u305d\u306e2\uff08\u66f8\u304d\u8fbc\u3081\u307e\u305b\u3093\uff09\nFATA[0036] Error pulling image (latest) from docker.io/httpd, Driver devicemapper failed to create image rootfs 902b87aaaec929e80541486828959f14fa061f529ad7f37ab300d4ef9f3a0dbf: Error running DeviceCreate (createSnapDevice) dm_task_run failed\n\n\n\u5bfe\u7b56\u65b9\u6cd5\n\u3059\u307f\u307e\u305b\u3093\u3001\u5b8c\u74a7\u307c\u304f\u306e\u30df\u30b9\u3067\u3059\u3002\n\u30c7\u30a3\u30b9\u30af\u9818\u57df\u304c\u305f\u308a\u3066\u307e\u305b\u3093\u3067\u3057\u305f\u30fb\u30fb\u30fb\uff01\uff01lvextend\u3057\u307e\u3059!\n[root docker]# df -h\n\u30d5\u30a1\u30a4\u30eb\u30b7\u30b9                  \u30b5\u30a4\u30ba  \u4f7f\u7528  \u6b8b\u308a \u4f7f\u7528% \u30de\u30a6\u30f3\u30c8\u4f4d\u7f6e\n/dev/mapper/rhel_root   6.7G  3.5G  3.3G   52% /\ndevtmpfs                         95G     0   95G    0% /dev\ntmpfs                            95G  136K   95G    1% /dev/shm\ntmpfs                            95G   57M   95G    1% /run\ntmpfs                            95G     0   95G    0% /sys/fs/cgroup\n/dev/sda1                       497M  124M  373M   25% /boot\n\n\u306a\u3093\u3067\u3060\u304b\u3088\u304f\u308f\u304b\u3089\u306a\u3044\u306e\u3067\u3059\u304c\u3001RHEL\u3067Docker\u3092\u5165\u308c\u308b\u3068centos\u3068\u306f\u9055\u3046\u3068\u3053\u308d\u306bdocker--pool\u3068\u3044\u3046\u306e\u304c\u8a95\u751f\u3057\u3066\u3044\u307e\u3059\u3002\n\uff08300G\u307b\u3069lvextend\u3057\u307e\u3057\u305f\u3001\u3061\u306a\u307f\u306b\u30d5\u30a1\u30a4\u30eb\u30b7\u30b9\u30c6\u30e0\u306fext4\u3067\u3059\uff09\n\u3046\u30fc\u3080\u306a\u305c\u3060\u308d\u3046\uff1f\n[rootdocker]# lsblk\nNAME                                MAJ:MIN RM  SIZE RO TYPE MOUNTPOINT\nsda                                   8:0    0  300G  0 disk\n\u251c\u2500sda1                                8:1    0  500M  0 part /boot\n\u251c\u2500sda2                                8:2    0  7.5G  0 part\n\u2502 \u251c\u2500rhel_******-swap               253:0    0  820M  0 lvm  [SWAP]\n\u2502 \u251c\u2500rhel_******-root               253:1    0  6.7G  0 lvm  /\n\u2502 \u251c\u2500rhel_******-docker--pool_tmeta 253:2    0    8M  0 lvm\n\u2502 \u2502 \u2514\u2500rhel_******-docker--pool     253:4    0  300G  0 lvm\n\u2502 \u2514\u2500rhel_******-docker--pool_tdata 253:3    0  300G  0 lvm\n\u2502   \u2514\u2500rhel_******-docker--pool     253:4    0  300G  0 lvm\n\u2514\u2500sda3                                8:3    0    1K  0 part\nsdb                                   8:16   0  300G  0 disk\nsdc                                   8:32   0  300G  0 disk\n\u2514\u2500rhel_******-docker--pool_tdata   253:3    0  300G  0 lvm\n  \u2514\u2500rhel_******-docker--pool       253:4    0  300G  0 lvm\nsr0                                  11:0    1 1024M  0 rom\nloop0                                 7:0    0  100G  0 loop\n\u2514\u2500docker-253:1-1087458-pool         253:5    0  100G  0 dm\n  \u2514\u2500docker-253:1-1087458-base       253:6    0   10G  0 dm\nloop1                                 7:1    0    2G  0 loop\n\u2514\u2500docker-253:1-1087458-pool         253:5    0  100G  0 dm\n  \u2514\u2500docker-253:1-1087458-base       253:6    0   10G  0 dm\n\nlvdisplay\u3067\u78ba\u8a8d\u3059\u308b\u3068\u5b58\u5728\u3057\u307e\u3059\u306e\u3067\u3001lvm\u30dc\u30ea\u30e5\u30fc\u30e0\u3067\u3059\u306d\u3002\uff08\u66f8\u3044\u3066\u3042\u308a\u307e\u3059\u304c\uff09\n[root dev]# lvdisplay /dev/rhel_awcmm03/docker-pool\n  --- Logical volume ---\n  LV Name                docker-pool\n  VG Name                rhel_******\n  LV UUID                Ci6BdL-nhNW-UttG-papt-Yzp3-R6jm-XWNZs0\n  LV Write Access        read/write\n  LV Creation host, time ******, 2015-07-14 12:16:37 +0900\n  LV Pool metadata       docker-pool_tmeta\n  LV Pool data           docker-pool_tdata\n  LV Status              available\n  # open                 0\n  LV Size                300.02 GiB\n  Allocated pool data    0.01%\n  Allocated metadata     2.34%\n  Current LE             76805\n  Segments               1\n  Allocation             inherit\n  Read ahead sectors     auto\n  - currently set to     8192\n  Block device           253:4\n\n\u306a\u3093\u3060\u304b\u3088\u304f\u308f\u304b\u3089\u306a\u304f\u306a\u3063\u3066\u304d\u305f\u2026\u3002\n\u5f8c\u65e5\u65b0\u3057\u304f\u5165\u308c\u306a\u304a\u3057\u3066\u898b\u3066\u307f\u3088\u3046\u3002\n#RHEL7.1\u3067Docker\u3092\u5165\u308c\u3066\u3064\u307e\u3063\u3068\u3053\n\n[\u516c\u5f0f\u30b5\u30a4\u30c8](https://access.redhat.com/ja/node/1365643)\u306b\u3042\u308b\u624b\u9806\u901a\u308aDocker\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u305f\u3089\u3001`docker pull`\u304c\u51fa\u6765\u307e\u305b\u3093\u3067\u3057\u305f\u3002\n\n\u3069\u3046\u3044\u3046\u3053\u3063\u3061\u3083\uff01\n\n#\u74b0\u5883\u60c5\u5831\n\n```\n[root system]# uname -a\nLinux xxxxx 3.10.0-229.el7.x86_64 #1 SMP Thu Jan 29 18:37:38 EST 2015 x86_64 x86_64 x86_64 GNU/Linux\n\n[root system]# docker version\nClient version: 1.6.2\nClient API version: 1.18\nGo version (client): go1.4.2\nGit commit (client): ba1f6c3/1.6.2\nOS/Arch (client): linux/amd64\nServer version: 1.6.2\nServer API version: 1.18\nGo version (server): go1.4.2\nGit commit (server): ba1f6c3/1.6.2\nOS/Arch (server): linux/amd64\n\n```\n\n\n#\u516c\u5f0f\u306e\u624b\u9806\n\n```\n# RHEL\u306e\u8ffd\u52a0\u3001\u30ea\u30dd\u30b8\u30c8\u30ea\u8ffd\u52a0\nsubscription-manager register --username=rhnuser --password=rhnpasswd\nsubscription-manager list --available  Find pool ID for RHEL subscription\nsubscription-manager attach --pool=pool_id\nsubscription-manager repos --enable=rhel-7-server-extras-rpms\nsubscription-manager repos --enable=rhel-7-server-optional-rpms\n\n\n# docker\u8ffd\u52a0\nyum install docker docker-registry\nyum install device-mapper-libs device-mapper-event-libs\n\n# firewalld\u505c\u6b62\nsystemctl stop firewalld.service\nsystemctl disable firewalld.service\n\n# docker\u8d77\u52d5\nsystemctl start docker.service\nsystemctl enable docker.service\n\n# \u30ec\u30b8\u30b9\u30c8\u30ea\u8d77\u52d5\nsystemctl enable docker-registry\nsystemctl start docker-registry\nsystemctl status docker-registry\n\n# RHEL\u30a4\u30e1\u30fc\u30b8\u306e\u53d6\u5f97\ndocker pull registry.access.redhat.com/rhel\n```\n\n# \u30a8\u30e9\u30fc\u305d\u306e\uff11\uff08\u8a8d\u8a3c\u30a8\u30e9\u30fc\uff09\n```\n[root /]# docker pull registry.access.redhat.com/rhel\nFATA[0015] Error response from daemon: v1 ping attempt failed with error: Get https://registry.access.redhat.com/v1/_ping: dial tcp: i/o timeout. If this private registry supports only HTTP or HTTPS with an unknown CA certificate, please add `--insecure-registry registry.access.redhat.com` to the daemon's arguments. In the case of HTTPS, if you have access to the registry's CA certificate, no need for the flag; simply place the CA certificate at /etc/docker/certs.d/registry.access.redhat.com/ca.crt\n```\n\n##\u5bfe\u7b56\u65b9\u6cd5\n\n`/etc/sysconfig/docker`\u5185\u3067\u8a18\u8f09\u3092\u8ffd\u8a18\n\n```:/etc/sysconfig/docker\nINSECURE_REGISTRY='--insecure-registry registry.access.redhat.com'\n```\n\n#\u30a8\u30e9\u30fc\u305d\u306e2\uff08\u66f8\u304d\u8fbc\u3081\u307e\u305b\u3093\uff09\n\n```\nFATA[0036] Error pulling image (latest) from docker.io/httpd, Driver devicemapper failed to create image rootfs 902b87aaaec929e80541486828959f14fa061f529ad7f37ab300d4ef9f3a0dbf: Error running DeviceCreate (createSnapDevice) dm_task_run failed\n```\n\n##\u5bfe\u7b56\u65b9\u6cd5\n\n\u3059\u307f\u307e\u305b\u3093\u3001\u5b8c\u74a7\u307c\u304f\u306e\u30df\u30b9\u3067\u3059\u3002\n\u30c7\u30a3\u30b9\u30af\u9818\u57df\u304c\u305f\u308a\u3066\u307e\u305b\u3093\u3067\u3057\u305f\u30fb\u30fb\u30fb\uff01\uff01lvextend\u3057\u307e\u3059!\n\n\n```\n[root docker]# df -h\n\u30d5\u30a1\u30a4\u30eb\u30b7\u30b9                  \u30b5\u30a4\u30ba  \u4f7f\u7528  \u6b8b\u308a \u4f7f\u7528% \u30de\u30a6\u30f3\u30c8\u4f4d\u7f6e\n/dev/mapper/rhel_root   6.7G  3.5G  3.3G   52% /\ndevtmpfs                         95G     0   95G    0% /dev\ntmpfs                            95G  136K   95G    1% /dev/shm\ntmpfs                            95G   57M   95G    1% /run\ntmpfs                            95G     0   95G    0% /sys/fs/cgroup\n/dev/sda1                       497M  124M  373M   25% /boot\n```\n\n\n\u306a\u3093\u3067\u3060\u304b\u3088\u304f\u308f\u304b\u3089\u306a\u3044\u306e\u3067\u3059\u304c\u3001RHEL\u3067Docker\u3092\u5165\u308c\u308b\u3068centos\u3068\u306f\u9055\u3046\u3068\u3053\u308d\u306bdocker--pool\u3068\u3044\u3046\u306e\u304c\u8a95\u751f\u3057\u3066\u3044\u307e\u3059\u3002\n\uff08300G\u307b\u3069lvextend\u3057\u307e\u3057\u305f\u3001\u3061\u306a\u307f\u306b\u30d5\u30a1\u30a4\u30eb\u30b7\u30b9\u30c6\u30e0\u306fext4\u3067\u3059\uff09\n\u3046\u30fc\u3080\u306a\u305c\u3060\u308d\u3046\uff1f\n\n```\n[rootdocker]# lsblk\nNAME                                MAJ:MIN RM  SIZE RO TYPE MOUNTPOINT\nsda                                   8:0    0  300G  0 disk\n\u251c\u2500sda1                                8:1    0  500M  0 part /boot\n\u251c\u2500sda2                                8:2    0  7.5G  0 part\n\u2502 \u251c\u2500rhel_******-swap               253:0    0  820M  0 lvm  [SWAP]\n\u2502 \u251c\u2500rhel_******-root               253:1    0  6.7G  0 lvm  /\n\u2502 \u251c\u2500rhel_******-docker--pool_tmeta 253:2    0    8M  0 lvm\n\u2502 \u2502 \u2514\u2500rhel_******-docker--pool     253:4    0  300G  0 lvm\n\u2502 \u2514\u2500rhel_******-docker--pool_tdata 253:3    0  300G  0 lvm\n\u2502   \u2514\u2500rhel_******-docker--pool     253:4    0  300G  0 lvm\n\u2514\u2500sda3                                8:3    0    1K  0 part\nsdb                                   8:16   0  300G  0 disk\nsdc                                   8:32   0  300G  0 disk\n\u2514\u2500rhel_******-docker--pool_tdata   253:3    0  300G  0 lvm\n  \u2514\u2500rhel_******-docker--pool       253:4    0  300G  0 lvm\nsr0                                  11:0    1 1024M  0 rom\nloop0                                 7:0    0  100G  0 loop\n\u2514\u2500docker-253:1-1087458-pool         253:5    0  100G  0 dm\n  \u2514\u2500docker-253:1-1087458-base       253:6    0   10G  0 dm\nloop1                                 7:1    0    2G  0 loop\n\u2514\u2500docker-253:1-1087458-pool         253:5    0  100G  0 dm\n  \u2514\u2500docker-253:1-1087458-base       253:6    0   10G  0 dm\n```\n\n`lvdisplay`\u3067\u78ba\u8a8d\u3059\u308b\u3068\u5b58\u5728\u3057\u307e\u3059\u306e\u3067\u3001lvm\u30dc\u30ea\u30e5\u30fc\u30e0\u3067\u3059\u306d\u3002\uff08\u66f8\u3044\u3066\u3042\u308a\u307e\u3059\u304c\uff09\n\n```\n[root dev]# lvdisplay /dev/rhel_awcmm03/docker-pool\n  --- Logical volume ---\n  LV Name                docker-pool\n  VG Name                rhel_******\n  LV UUID                Ci6BdL-nhNW-UttG-papt-Yzp3-R6jm-XWNZs0\n  LV Write Access        read/write\n  LV Creation host, time ******, 2015-07-14 12:16:37 +0900\n  LV Pool metadata       docker-pool_tmeta\n  LV Pool data           docker-pool_tdata\n  LV Status              available\n  # open                 0\n  LV Size                300.02 GiB\n  Allocated pool data    0.01%\n  Allocated metadata     2.34%\n  Current LE             76805\n  Segments               1\n  Allocation             inherit\n  Read ahead sectors     auto\n  - currently set to     8192\n  Block device           253:4\n```\n\n\u306a\u3093\u3060\u304b\u3088\u304f\u308f\u304b\u3089\u306a\u304f\u306a\u3063\u3066\u304d\u305f\u2026\u3002\n\u5f8c\u65e5\u65b0\u3057\u304f\u5165\u308c\u306a\u304a\u3057\u3066\u898b\u3066\u307f\u3088\u3046\u3002\n", "tags": ["docker", "redhat", "RHEL", "RHEL7"]}