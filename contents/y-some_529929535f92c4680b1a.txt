{"context": "\n\n\u6982\u8981\n\u30a2\u30e1\u30c0\u30b9\u306e\u89b3\u6e2c\u7d50\u679c\u306e\u30da\u30fc\u30b8\u306f\u3001\u524d\u65e5\uff0f\u5f53\u65e5\u306b\u5206\u304b\u308c\u3066\u3044\u307e\u3059\u3002\n\u3053\u306e2\u3064\u306eHTML\u305d\u308c\u305e\u308c\u306e\u300c\u6c17\u6e29\u300d\u306e\u5217\u3092\u30b9\u30af\u30ec\u30a4\u30d4\u30f3\u30b0\u3057\u30661\u3064\u306eArray\u306b\u4ed5\u7acb\u3066\u307e\u3059\u3002\n\u3010\u672d\u5e4c\u306e\u30a2\u30e1\u30c0\u30b9\u3011\n\u524d\u65e5\u306e\u89b3\u6e2c\u30c7\u30fc\u30bf\u306e\u30da\u30fc\u30b8\n\n\u5f53\u65e5\u306e\u89b3\u6e2c\u30c7\u30fc\u30bf\u306e\u30da\u30fc\u30b8\n\n\u305d\u3057\u3066\u3001\u3053\u3093\u306a\u611f\u3058\u3067\u3001UITextView\u306b\u8868\u793a\u3057\u3066\u307f\u307e\u3057\u305f\u3002\n\n\n\u30dd\u30a4\u30f3\u30c8\n\n\u30b9\u30af\u30ec\u30a4\u30d4\u30f3\u30b0\u306b\u306f\u30e9\u30a4\u30d6\u30e9\u30ea\"Kanna\"\u3092\u5229\u7528\nxPath\u8a18\u6cd5\u3067table\u306e\u7279\u5b9a\u5217\u3092\u30b9\u30af\u30ec\u30a4\u30d4\u30f3\u30b0\n2\u30da\u30fc\u30b8\u3092\u5225\u306eQueue\u3067\u30b9\u30af\u30ec\u30a4\u30d4\u30f3\u30b0\u3057\u3066\u5225\u306eArray\u306b\u4e00\u6642\u683c\u7d0d\u3001\u5168Queue\u304c\u7d42\u4e86\u5f8c\u306bArray\u3092\u7d71\u5408\n\n\nKanna\u306b\u3064\u3044\u3066\nKanna\u306e\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\u3068\u4f7f\u3044\u65b9\u306b\u3064\u3044\u3066\u306f\u3001\u4ee5\u4e0b\u306e\u8a18\u4e8b\u3092\u53c2\u8003\u306b\u3055\u305b\u3066\u3044\u305f\u3060\u304d\u307e\u3057\u305f\u3002\nSwift\u88fdHTML\u30d1\u30fc\u30b5\u300cKanna\u300d\n\n\u74b0\u5883\n\n\n\nItems\nVersion\n\n\n\n\nXcode\n8.2\n\n\nSwift\n3.0.2\n\n\n\n\n\u30b3\u30fc\u30c9\n\nViewController.swift\nimport UIKit\nimport Kanna\n\n/// Array\u306e\u8981\u7d20\nclass element {\n    var day = \"\"\n    var hour = \"\"\n    var temperature: Double = 0\n}\n\nclass ViewController: UIViewController {\n\n    // MARK: - Variable\n\n    /// \u6700\u7d42\u30c7\u30fc\u30bf\u306eArray\n    var finalData: [element] = []\n    /// \u6628\u65e5\u306e\u30c7\u30fc\u30bf\u306eArray\n    var yesterdayData: [element] = []\n    /// \u4eca\u65e5\u306e\u30c7\u30fc\u30bf\u306eArray\n    var todayData: [element] = []\n\n    // MARK: - IBOutlet\n\n    @IBOutlet weak var button: UIButton!\n    @IBOutlet weak var activityIndicator: UIActivityIndicatorView!\n    @IBOutlet weak var textView: UITextView!\n\n    // MARK: - UIViewController LifeCycle\n\n    override func viewDidLoad() {\n        super.viewDidLoad()\n    }\n\n    override func didReceiveMemoryWarning() {\n        super.didReceiveMemoryWarning()\n    }\n\n    // MARK: - IBAction\n\n    @IBAction func buttonTapped(_ sender: Any) {\n        self.execute()\n    }\n\n    // MARK: - Method\n\n    /// \u30e1\u30a4\u30f3\u51e6\u7406\n    func execute() {\n        self.activityIndicator.startAnimating()\n\n        // DispatchGroup\u3068Queue\u3092\u751f\u6210\n        let group = DispatchGroup()\n        let queue1 = DispatchQueue(label: \"hoge.fuga.queue1\")\n        let queue2 = DispatchQueue(label: \"hoge.fuga.queue2\")\n\n        // \u30ad\u30e5\u30fc\u3068\u30b0\u30eb\u30fc\u30d7\u3092\u7d10\u4ed8\u3051\u308b\n        queue1.async(group: group) {\n            // \u672d\u5e4c\u306e\u30a2\u30e1\u30c0\u30b9\uff08\u6628\u65e5\uff09\n            guard let url = URL(string: \"http://www.jma.go.jp/jp/amedas_h/yesterday-14163.html\") else {\n                fatalError(\"Error: URL\")\n            }\n            let data = self.getHtml(url: url)\n            self.yesterdayData = self.parseHtml(day: \"yesterday\", data: data)\n        }\n        queue2.async(group: group) {\n            // \u672d\u5e4c\u306e\u30a2\u30e1\u30c0\u30b9\uff08\u4eca\u65e5\uff09\n            guard let url = URL(string: \"http://www.jma.go.jp/jp/amedas_h/today-14163.html\") else {\n                fatalError(\"Error: URL\")\n            }\n            let data = self.getHtml(url: url)\n            self.todayData = self.parseHtml(day: \"today\", data: data)\n        }\n\n        // \u30bf\u30b9\u30af\u304c\u5168\u3066\u5b8c\u4e86\u3057\u305f\u3089\u30e1\u30a4\u30f3\u30b9\u30ec\u30c3\u30c9\u4e0a\u3067\u51e6\u7406\u3092\u5b9f\u884c\u3059\u308b\n        group.notify(queue: DispatchQueue.main) {\n            // \u4eca\u65e5\u306eArray\u3068\u6628\u65e5\u306eArray\u3092\u7d50\u5408\n            self.finalData =  self.yesterdayData + self.todayData\n            // \u7de8\u96c6\u3057\u3066UITextView\u306b\u8868\u793a\n            var s = \"\"\n            for e in self.finalData {\n                s += e.day + \"-\" + e.hour + \"h: \" + String(e.temperature) + \"\\n\"\n            }\n            self.textView.text = s\n            self.activityIndicator.stopAnimating()\n        }\n\n    }\n\n    /// HTML\u53d6\u5f97\n    /// - parameter url: URL\n    /// - returns Data\n    func getHtml(url: URL) -> Data {\n        do {\n            return try Data(contentsOf: url)\n        } catch {\n            fatalError(\"fail to download\")\n        }\n    }\n\n    /// \u30b9\u30af\u30ec\u30a4\u30d4\u30f3\u30b0\n    /// - parameter day: \"today\"/\"yesterday\"\n    /// - parameter data: Data\n    /// - returns [element]\n    func parseHtml(day: String, data: Data) -> [element] {\n        // Kanna\u3067HTMLDocument\u3092\u751f\u6210\n        guard let doc = HTML(html: data, encoding: String.Encoding.utf8) else {\n            fatalError(\"Error: HTML\")\n        }\n        var retData: [element] = []\n        // HTML\u306e<table>\u306e\u6642\u523b\u306e\u5217\u3092\u57fa\u6e96\u306bLoop\u3057\u3001\u8a72\u5f53\u884c\u306e\u6c17\u6e29\u306e\u5217\u3092Kanna\u3067\u30b9\u30af\u30ec\u30a4\u30d4\u30f3\u30b0\n        for i in (1...24) {\n            let node = doc.xpath(\"//*[@id='tbl_list']//tr[td[1][text()='\\(i)']]/td[2]\")\n            if let nodeFirst = node.first, let content = nodeFirst.content, let value = Double(content) {\n                // \u5024\u304c\u5165\u3063\u3066\u3044\u308b\u5834\u5408\u306e\u307f\u53d6\u5f97\n                let e = element()\n                e.day = day\n                e.hour = String(i)\n                e.temperature = value\n                retData.append(e)\n            }\n        }\n        return retData\n    }\n\n}\n\n\nSwift\u3067\u306fArray\u306e\u7d50\u5408\u304c\"+\"\u3067\u3067\u304d\u308b\u3093\u3067\u3059\u306d\u3002\n\u76f4\u611f\u7684\u3067\u30a4\u30a4\uff01!\n\n\u6ce8\u610f\u4e8b\u9805\n\u6c17\u8c61\u5e81\u306e\u30b5\u30a4\u30c8\u306b\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u6ce8\u610f\u4e8b\u9805\u304c\u63b2\u8f09\u3055\u308c\u3066\u3044\u307e\u3059\u3002\n\u6c17\u8c61\u5e81\u30db\u30fc\u30e0\u30da\u30fc\u30b8\u306b\u3064\u3044\u3066\uff1e\u5229\u7528\u4e0a\u306e\u6ce8\u610f\u306b\u3064\u3044\u3066\n\n\u5f53\u30db\u30fc\u30e0\u30da\u30fc\u30b8\u306f\u3001\u901a\u5e38\u306e\u30d6\u30e9\u30a6\u30b6\u3067\u95b2\u89a7\u3059\u308b\u3053\u3068\u3092\u524d\u63d0\u306b\u5404\u7a2e\u60c5\u5831\u3092\u63b2\u8f09\u3057\u3066\u304a\u308a\u307e\u3059\u3002\u81ea\u52d5\u5de1\u56de\u30bd\u30d5\u30c8\u7b49\u306b\u3088\u308b\u3001\u5b9a\u671f\u7684\u3001\u81ea\u52d5\u7684\u306a\u6c17\u8c61\u30c7\u30fc\u30bf\u306e\u53ce\u96c6\u7b49\u306f\u3001\u30b5\u30fc\u30d0\u30fc\u306b\u8ca0\u8377\u304c\u304b\u304b\u308b\u7b49\u306e\u7406\u7531\u304b\u3089\u3001\u539f\u5247\u3068\u3057\u3066\u3054\u9060\u616e\u3044\u305f\u3060\u3044\u3066\u304a\u308a\u307e\u3059\u3002\u3054\u7406\u89e3\u304a\u9858\u3044\u3057\u307e\u3059\u3002\n\n\u672c\u8a18\u4e8b\u306e\u5185\u5bb9\u3092\u6d3b\u7528\u3059\u308b\u969b\u306f\u3001\u30b9\u30af\u30ec\u30a4\u30d4\u30f3\u30b0\u5bfe\u8c61\u30b5\u30a4\u30c8\u306e\u5229\u7528\u898f\u7d04\u3092\u78ba\u8a8d\u306e\u4e0a\u3001\u81ea\u5df1\u8cac\u4efb\u3067\u304a\u9858\u3044\u3057\u307e\u3059\u3002\n# \u6982\u8981\n\n\u30a2\u30e1\u30c0\u30b9\u306e\u89b3\u6e2c\u7d50\u679c\u306e\u30da\u30fc\u30b8\u306f\u3001\u524d\u65e5\uff0f\u5f53\u65e5\u306b\u5206\u304b\u308c\u3066\u3044\u307e\u3059\u3002\n\u3053\u306e2\u3064\u306eHTML\u305d\u308c\u305e\u308c\u306e\u300c\u6c17\u6e29\u300d\u306e\u5217\u3092\u30b9\u30af\u30ec\u30a4\u30d4\u30f3\u30b0\u3057\u30661\u3064\u306eArray\u306b\u4ed5\u7acb\u3066\u307e\u3059\u3002\n\n\u3010\u672d\u5e4c\u306e\u30a2\u30e1\u30c0\u30b9\u3011\n[\u524d\u65e5\u306e\u89b3\u6e2c\u30c7\u30fc\u30bf\u306e\u30da\u30fc\u30b8](http://www.jma.go.jp/jp/amedas_h/yesterday-14163.html)\n<img width=\"504\" alt=\"\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2017-02-23 22.26.54.png\" src=\"https://qiita-image-store.s3.amazonaws.com/0/122917/0bbbdacc-ba2b-e2a3-e7e6-cd40237bac30.png\">\n\n[\u5f53\u65e5\u306e\u89b3\u6e2c\u30c7\u30fc\u30bf\u306e\u30da\u30fc\u30b8](http://www.jma.go.jp/jp/amedas_h/today-14163.html)\n<img width=\"500\" alt=\"\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2017-02-23 22.27.48.png\" src=\"https://qiita-image-store.s3.amazonaws.com/0/122917/35247b55-b262-4a99-2c86-6266bd5f8650.png\">\n\n\u305d\u3057\u3066\u3001\u3053\u3093\u306a\u611f\u3058\u3067\u3001UITextView\u306b\u8868\u793a\u3057\u3066\u307f\u307e\u3057\u305f\u3002\n<img width=\"508\" alt=\"\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2017-02-23 22.49.46.png\" src=\"https://qiita-image-store.s3.amazonaws.com/0/122917/8a0b4f05-6932-28bf-d84f-34dee1f600d8.png\">\n\n# \u30dd\u30a4\u30f3\u30c8\n\n- \u30b9\u30af\u30ec\u30a4\u30d4\u30f3\u30b0\u306b\u306f\u30e9\u30a4\u30d6\u30e9\u30ea\"Kanna\"\u3092\u5229\u7528\n- xPath\u8a18\u6cd5\u3067table\u306e\u7279\u5b9a\u5217\u3092\u30b9\u30af\u30ec\u30a4\u30d4\u30f3\u30b0\n- 2\u30da\u30fc\u30b8\u3092\u5225\u306eQueue\u3067\u30b9\u30af\u30ec\u30a4\u30d4\u30f3\u30b0\u3057\u3066\u5225\u306eArray\u306b\u4e00\u6642\u683c\u7d0d\u3001\u5168Queue\u304c\u7d42\u4e86\u5f8c\u306bArray\u3092\u7d71\u5408\n\n# Kanna\u306b\u3064\u3044\u3066\n\nKanna\u306e\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\u3068\u4f7f\u3044\u65b9\u306b\u3064\u3044\u3066\u306f\u3001\u4ee5\u4e0b\u306e\u8a18\u4e8b\u3092\u53c2\u8003\u306b\u3055\u305b\u3066\u3044\u305f\u3060\u304d\u307e\u3057\u305f\u3002\n\n[Swift\u88fdHTML\u30d1\u30fc\u30b5\u300cKanna\u300d](http://qiita.com/_tid_/items/c228b1931cd9b23d52d3)\n\n# \u74b0\u5883\n\n| Items | Version |\n|:--    |:--      |\n| Xcode | 8.2     |\n| Swift | 3.0.2   |\n\n# \u30b3\u30fc\u30c9\n\n```swift:ViewController.swift\nimport UIKit\nimport Kanna\n\n/// Array\u306e\u8981\u7d20\nclass element {\n    var day = \"\"\n    var hour = \"\"\n    var temperature: Double = 0\n}\n\nclass ViewController: UIViewController {\n\n    // MARK: - Variable\n    \n    /// \u6700\u7d42\u30c7\u30fc\u30bf\u306eArray\n    var finalData: [element] = []\n    /// \u6628\u65e5\u306e\u30c7\u30fc\u30bf\u306eArray\n    var yesterdayData: [element] = []\n    /// \u4eca\u65e5\u306e\u30c7\u30fc\u30bf\u306eArray\n    var todayData: [element] = []\n    \n    // MARK: - IBOutlet\n    \n    @IBOutlet weak var button: UIButton!\n    @IBOutlet weak var activityIndicator: UIActivityIndicatorView!\n    @IBOutlet weak var textView: UITextView!\n    \n    // MARK: - UIViewController LifeCycle\n    \n    override func viewDidLoad() {\n        super.viewDidLoad()\n    }\n\n    override func didReceiveMemoryWarning() {\n        super.didReceiveMemoryWarning()\n    }\n\n    // MARK: - IBAction\n    \n    @IBAction func buttonTapped(_ sender: Any) {\n        self.execute()\n    }\n    \n    // MARK: - Method\n    \n    /// \u30e1\u30a4\u30f3\u51e6\u7406\n    func execute() {\n        self.activityIndicator.startAnimating()\n        \n        // DispatchGroup\u3068Queue\u3092\u751f\u6210\n        let group = DispatchGroup()\n        let queue1 = DispatchQueue(label: \"hoge.fuga.queue1\")\n        let queue2 = DispatchQueue(label: \"hoge.fuga.queue2\")\n        \n        // \u30ad\u30e5\u30fc\u3068\u30b0\u30eb\u30fc\u30d7\u3092\u7d10\u4ed8\u3051\u308b\n        queue1.async(group: group) {\n            // \u672d\u5e4c\u306e\u30a2\u30e1\u30c0\u30b9\uff08\u6628\u65e5\uff09\n            guard let url = URL(string: \"http://www.jma.go.jp/jp/amedas_h/yesterday-14163.html\") else {\n                fatalError(\"Error: URL\")\n            }\n            let data = self.getHtml(url: url)\n            self.yesterdayData = self.parseHtml(day: \"yesterday\", data: data)\n        }\n        queue2.async(group: group) {\n            // \u672d\u5e4c\u306e\u30a2\u30e1\u30c0\u30b9\uff08\u4eca\u65e5\uff09\n            guard let url = URL(string: \"http://www.jma.go.jp/jp/amedas_h/today-14163.html\") else {\n                fatalError(\"Error: URL\")\n            }\n            let data = self.getHtml(url: url)\n            self.todayData = self.parseHtml(day: \"today\", data: data)\n        }\n        \n        // \u30bf\u30b9\u30af\u304c\u5168\u3066\u5b8c\u4e86\u3057\u305f\u3089\u30e1\u30a4\u30f3\u30b9\u30ec\u30c3\u30c9\u4e0a\u3067\u51e6\u7406\u3092\u5b9f\u884c\u3059\u308b\n        group.notify(queue: DispatchQueue.main) {\n            // \u4eca\u65e5\u306eArray\u3068\u6628\u65e5\u306eArray\u3092\u7d50\u5408\n            self.finalData =  self.yesterdayData + self.todayData\n            // \u7de8\u96c6\u3057\u3066UITextView\u306b\u8868\u793a\n            var s = \"\"\n            for e in self.finalData {\n                s += e.day + \"-\" + e.hour + \"h: \" + String(e.temperature) + \"\\n\"\n            }\n            self.textView.text = s\n            self.activityIndicator.stopAnimating()\n        }\n        \n    }\n    \n    /// HTML\u53d6\u5f97\n    /// - parameter url: URL\n    /// - returns Data\n    func getHtml(url: URL) -> Data {\n        do {\n            return try Data(contentsOf: url)\n        } catch {\n            fatalError(\"fail to download\")\n        }\n    }\n    \n    /// \u30b9\u30af\u30ec\u30a4\u30d4\u30f3\u30b0\n    /// - parameter day: \"today\"/\"yesterday\"\n    /// - parameter data: Data\n    /// - returns [element]\n    func parseHtml(day: String, data: Data) -> [element] {\n        // Kanna\u3067HTMLDocument\u3092\u751f\u6210\n        guard let doc = HTML(html: data, encoding: String.Encoding.utf8) else {\n            fatalError(\"Error: HTML\")\n        }\n        var retData: [element] = []\n        // HTML\u306e<table>\u306e\u6642\u523b\u306e\u5217\u3092\u57fa\u6e96\u306bLoop\u3057\u3001\u8a72\u5f53\u884c\u306e\u6c17\u6e29\u306e\u5217\u3092Kanna\u3067\u30b9\u30af\u30ec\u30a4\u30d4\u30f3\u30b0\n        for i in (1...24) {\n            let node = doc.xpath(\"//*[@id='tbl_list']//tr[td[1][text()='\\(i)']]/td[2]\")\n            if let nodeFirst = node.first, let content = nodeFirst.content, let value = Double(content) {\n                // \u5024\u304c\u5165\u3063\u3066\u3044\u308b\u5834\u5408\u306e\u307f\u53d6\u5f97\n                let e = element()\n                e.day = day\n                e.hour = String(i)\n                e.temperature = value\n                retData.append(e)\n            }\n        }\n        return retData\n    }\n    \n}\n```\n\nSwift\u3067\u306fArray\u306e\u7d50\u5408\u304c\"+\"\u3067\u3067\u304d\u308b\u3093\u3067\u3059\u306d\u3002\n\u76f4\u611f\u7684\u3067\u30a4\u30a4\uff01!\n\n# \u6ce8\u610f\u4e8b\u9805\n\n\u6c17\u8c61\u5e81\u306e\u30b5\u30a4\u30c8\u306b\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u6ce8\u610f\u4e8b\u9805\u304c\u63b2\u8f09\u3055\u308c\u3066\u3044\u307e\u3059\u3002\n\n[\u6c17\u8c61\u5e81\u30db\u30fc\u30e0\u30da\u30fc\u30b8\u306b\u3064\u3044\u3066\uff1e\u5229\u7528\u4e0a\u306e\u6ce8\u610f\u306b\u3064\u3044\u3066](http://www.jma.go.jp/jma/kishou/info/coment.html#exclusion)\n\n>\u5f53\u30db\u30fc\u30e0\u30da\u30fc\u30b8\u306f\u3001\u901a\u5e38\u306e\u30d6\u30e9\u30a6\u30b6\u3067\u95b2\u89a7\u3059\u308b\u3053\u3068\u3092\u524d\u63d0\u306b\u5404\u7a2e\u60c5\u5831\u3092\u63b2\u8f09\u3057\u3066\u304a\u308a\u307e\u3059\u3002\u81ea\u52d5\u5de1\u56de\u30bd\u30d5\u30c8\u7b49\u306b\u3088\u308b\u3001\u5b9a\u671f\u7684\u3001\u81ea\u52d5\u7684\u306a\u6c17\u8c61\u30c7\u30fc\u30bf\u306e\u53ce\u96c6\u7b49\u306f\u3001\u30b5\u30fc\u30d0\u30fc\u306b\u8ca0\u8377\u304c\u304b\u304b\u308b\u7b49\u306e\u7406\u7531\u304b\u3089\u3001\u539f\u5247\u3068\u3057\u3066\u3054\u9060\u616e\u3044\u305f\u3060\u3044\u3066\u304a\u308a\u307e\u3059\u3002\u3054\u7406\u89e3\u304a\u9858\u3044\u3057\u307e\u3059\u3002\n\n\u672c\u8a18\u4e8b\u306e\u5185\u5bb9\u3092\u6d3b\u7528\u3059\u308b\u969b\u306f\u3001\u30b9\u30af\u30ec\u30a4\u30d4\u30f3\u30b0\u5bfe\u8c61\u30b5\u30a4\u30c8\u306e\u5229\u7528\u898f\u7d04\u3092\u78ba\u8a8d\u306e\u4e0a\u3001\u81ea\u5df1\u8cac\u4efb\u3067\u304a\u9858\u3044\u3057\u307e\u3059\u3002\n", "tags": ["iOS", "Swift", "\u30b9\u30af\u30ec\u30a4\u30d4\u30f3\u30b0"]}