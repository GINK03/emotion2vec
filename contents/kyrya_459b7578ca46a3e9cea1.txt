{"context": " More than 1 year has passed since last update.\n\n\u80cc\u666f\n\u3042\u308bDC\u5185\u306b\u3042\u308b\u30b5\u30fc\u30d0\u30fc(\u30b5\u30fc\u30d0\u30fcB)\u306b\u9650\u5b9aIP(\u30db\u30b9\u30c8A)\u304b\u3089SSH\u3067\u5165\u308c\u308b\u3088\u3046\u306b\u306a\u3063\u305f\u304c\u3001\u30c7\u30d5\u30a9\u30eb\u30c8GW\u306fDC\u5185\u9650\u5b9a\u306a\u306e\u3067\u3001yum\u306a\u3069\u3092\u3057\u3088\u3046\u3068\u3059\u308b\u3068FW\u304c\u90aa\u9b54\u3057\u3066\u30d5\u30a1\u30a4\u30eb\u3092\u6301\u3063\u3066\u304f\u308b\u3053\u3068\u304c\u3067\u304d\u306a\u3044\u3002Google DNS\u306a\u3069\u3092\u4f7f\u3063\u3066\u540d\u524d\u89e3\u6c7a\u306f\u3067\u304d\u308b\u3057\u3001ICMP\u306f\u901a\u308b\u3002\n\u30db\u30b9\u30c8A <==SSH==|=FW=> \u30b5\u30fc\u30d0\u30fcB <==> DC\u5185NW\n\n\u89e3\u6c7a\u65b9\u6cd5\n\u30ea\u30e2\u30fc\u30c8\u3067\u3057\u304b\u7ba1\u7406\u3067\u304d\u306a\u3044\u306e\u3067\u3001\u30b5\u30fc\u30d0\u30fc\u306e\u30c7\u30d5\u30a9\u30eb\u30c8GW\u306a\u3069\u306e\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u8a2d\u5b9a\u306f\u5909\u3048\u305f\u304f\u306a\u3044\u3002\n\u3068\u308a\u3042\u3048\u305ayum\u3068\u304b\u304c\u51fa\u6765\u308c\u3070\u3044\u3044\u306e\u3067\u3001yum\u306e\u901a\u4fe1\u3092\u30db\u30b9\u30c8A\u7d4c\u7531\u306b\u3059\u308b\u65b9\u6cd5\u3002\n\u3064\u307e\u308a\u3001\u30b5\u30fc\u30d0\u30fcB\u304b\u3089\u30db\u30b9\u30c8A\u306b\u5bfe\u3057\u3066SSH\u3067\u30c0\u30a4\u30ca\u30df\u30c3\u30af\u30dd\u30fc\u30c8\u30d5\u30a9\u30ef\u30fc\u30c7\u30a3\u30f3\u30b0\u3092\u5f35\u308a\u3001\u30db\u30b9\u30c8A\u3092SOCKS\u30d7\u30ed\u30af\u30b7\u3068\u3057\u3066\u4f7f\u3046\u3002\n\u307e\u305fCentOS\u306b\u4ed8\u3044\u3066\u3044\u308byum\u3060\u3068socks5\u30d7\u30ed\u30af\u30b7\u304c\u4f7f\u3048\u306a\u3044\u306e\u3067\u3001\u4ed6\u306eproxy\u30bd\u30d5\u30c8\u3092\u4f7f\u3046\u3002\u8abf\u3079\u308b\u3068tsock,proxychain\u306a\u3069\u304c\u3042\u308b\u3002\u30b3\u30f3\u30d1\u30a4\u30eb\u304c\u7d20\u76f4\u306b\u901a\u3063\u305f\u306e\u304cproxychains\u3060\u3063\u305f\u306e\u3067\u3001\u3053\u3053\u3067\u306fproxychains\u3092\u4f7f\u3046\u65b9\u6cd5\u3002\n(\u4ed6\u306b\u3082\u3042\u308b\u304b\u3082\u3057\u308c\u306a\u3044\u3051\u3069\u3001\u56de\u308a\u304f\u3069\u3044\u304c\uff09\n\n\u624b\u9806\n1.\u30db\u30b9\u30c8A\u3092\u8d77\u70b9\u306bSSH\u30ea\u30d0\u30fc\u30b9\u30dd\u30fc\u30c8\u30d5\u30a9\u30ef\u30fc\u30c7\u30a3\u30f3\u30b0\u3092\u30b5\u30fc\u30d0\u30fcB\u306b\u5f35\u308b\u3002\nhostA $ ssh -R 12222:(hostA IP):22 (server B IP) \n\n\u3053\u308c\u3067\u30b5\u30fc\u30d0\u30fcB\u304b\u3089\u30db\u30b9\u30c8A\u306b\u5bfe\u3057\u3066\u30dd\u30fc\u30c812222\u3067SSH\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u308b\u3002\n2.\u30b5\u30fc\u30d0\u30fcB\u3067SCREEN\u3092\u7acb\u3061\u4e0a\u3052\u3001\u305d\u3053\u304b\u3089\u30db\u30b9\u30c8A\u306b\u30c0\u30a4\u30ca\u30df\u30c3\u30af\u30dd\u30fc\u30c8\u30d5\u30a9\u30ef\u30fc\u30c7\u30a3\u30f3\u30b0\u3092\u5f35\u308b\u3002\nserver B $ ssh -D8888 -p12222 (hostA\u3067\u306e\u30e6\u30fc\u30b6\u30fc\u540d)@127.0.0.1\n\n\u3053\u308c\u3067\u30dd\u30fc\u30c88888\u3067\u30db\u30b9\u30c8A\u7d4c\u7531\u306eSOCKS5\u30d7\u30ed\u30af\u30b7\u3068\u306a\u308b\u3002\n3.proxychains\u3092DL\u3057\u3066\u3001scp\u3067\u30db\u30b9\u30c8A=>\u30b5\u30fc\u30d0\u30fcB\u3078\u30b3\u30d4\u30fc\n4.\u30b5\u30fc\u30d0\u30fcB\u4e0a\u3067\u3001\nserver B $ tar vxzf proxychains-3.1.tar.gz\nserver B $ cd proxychains-3.1\nserver B $ ./configure; make\nserver B $ sudo make istall\n\n\u3053\u308c\u3067proxychains\u30b3\u30de\u30f3\u30c9\u304c\u4f7f\u3048\u308b\u3002\u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u306f/bin/proxychains\u306b\u306a\u308b\u3002\n\u4f46\u3057\u3053\u306e\u307e\u307e\u3060\u3068\u3001\nERROR: ld.so: object 'libproxychains.so.3' from LD_PRELOAD cannot be preloaded: ignored\n\n\u3053\u3046\u3044\u3046\u30a8\u30e9\u30fc\u304c\u3067\u308b\u306e\u3067\u3001/bin/proxychains\u3092\u4fee\u6b63\u3059\u308b\u3002\nproxychains\u306f\u30b9\u30af\u30ea\u30d7\u30c8\u306b\u306a\u3063\u3066\u3044\u308b\u306e\u3067\u3001vim\u306a\u3069\u3067\u958b\u3044\u3066\nexport LD_PRELOAD=libproxychains.so\n\u3092\nexport LD_PRELOAD=/lib/libproxychains.so\n\u306b\u4fee\u6b63\u3059\u308b\n\n\u307e\u305f/etc/proxychains.conf\u3092\u958b\u3044\u3066\n[ProxyList]\nsocks5  127.0.0.1 8888\n\n\u3068\u3059\u308b\u3002\n\u4ee5\u4e0a\u3067\u3001proxychains\u30b3\u30de\u30f3\u30c9\u3067yum\u306a\u3069\u304c\u3067\u304d\u308b\u3002\nserver B $ sudo proxychains yum install lynx\n\n\nVPN\u3092\u5f35\u308b\n\u3053\u3053\u307e\u3067\u306fssh\u30b3\u30cd\u30af\u30b7\u30e7\u30f3\u3067socks5\u30d7\u30ed\u30af\u30b7\u3068\u3059\u308b\u5834\u5408\u3060\u3063\u305f\u304c\u3001\u66f4\u306btun,tap\u30c7\u30d0\u30a4\u30b9\u3092\u4f5c\u308b\u3053\u3068\u3067vpn\u3092\u5f35\u308b\u3053\u3068\u304c\u3067\u304d\u308b\u3002\u3053\u3053\u3067\u306ftap\u30c7\u30d0\u30a4\u30b9\u3092\u4f5c\u308aL2\u30d6\u30ea\u30c3\u30b8\u306b\u3059\u308b\u5834\u5408\u3002\nserver\u5074\u304cNAT\u5185\u306b\u306a\u3063\u3066\u3044\u308b\u306e\u3067\u3001\u3053\u3053\u3067\u306fserver\u3092vpn\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u3001host\u5074\u3092vpn\u30b5\u30fc\u30d0\u30fc\u3068\u3059\u308b\u3002\n\u8a2d\u5b9a\u306f\u3001\n- \u30c7\u30d0\u30a4\u30b9\u540dtap0\n- vpn\u30b5\u30fc\u30d0\u30fc(host)IP\u30a2\u30c9\u30ec\u30b9 10.0.0.1\n- vpn\u30af\u30e9\u30a4\u30a2\u30f3\u30c8(server)IP\u30a2\u30c9\u30ec\u30b9 10.0.0.2\n\u3068\u3059\u308b\nserver\u5074\u3067\u3001vpn\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u3068\u3057\u3066\u3001\u9375\u751f\u6210\u3092\u884c\u3046\u3002\n\u30b9\u30af\u30ea\u30d7\u30c8\u5236\u5fa1\u3092\u884c\u3063\u305f\u308a\u3001\u81ea\u52d5\u8d77\u52d5\u3059\u308b\u5834\u5408\u306f\u30d1\u30b9\u30d5\u30ec\u30fc\u30ba\u306a\u3057\u306e\u8a2d\u5b9a\u3068\u3059\u308b\u3002\nserver # ssh-keygen -f /root/.ssh/vpntest\n\n\u3053\u3053\u3067private key\u3068public key\u304c\u3067\u304d\u308b\u306e\u3067\u3001public key\u3092vpn\u30b5\u30fc\u30d0\u30fc\u5074(host)\u3078\u6301\u3063\u3066\u884c\u304d\u3001/root/.ssh/authorized_keys\u3078\u8ffd\u52a0\u3059\u308b\n\u8ffd\u52a0\u306e\u3055\u3044\u306b\u4ee5\u4e0b\u306ecommand\u3092\u8ffd\u52a0\u3059\u308bpublic key\u306b\u52a0\u3048\u308b\n no-X11-forwarding,no-agent-forwarding,no-pty,command=\"ifconfig tap0 10.0.0.1 netmask 255.255.255.0\" ssh-rsa ...\n\n\u307e\u305f\u3001vpn\u30b5\u30fc\u30d0\u30fc\u5074(host)\u306esshd_config\u3092\n  PermitTunnel ethernet\n\n\u3068\u3057\u3001sshd\u30b5\u30fc\u30d3\u30b9\u3092reload\u3059\u308b\u3002\nvpn\u30af\u30e9\u30a4\u30a2\u30f3\u30c8(server)\u3067\u306f\u3001/root/.ssh/config\u307e\u305f\u306f/etc/ssh/ssh_config\u306b\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u8a2d\u5b9a\u3092\u52a0\u3048\u308b\u3002\n\u3053\u308c\u307e\u3067\u306e\u30dd\u30fc\u30c8\u30d5\u30a9\u30ef\u30fc\u30c7\u30a3\u30f3\u30b0\u8a2d\u5b9a\u3067\u3001localhost\u306e12222\u304cvpn\u30b5\u30fc\u30d0\u30fc(host)\u306b\u5411\u3044\u3066\u3044\u308b\u306e\u3067\u3001\u305d\u306e\u3088\u3046\u306b\u8a2d\u5b9a\u3059\u308b\u3002\nHost vpntest2\n  HostName 127.0.0.1\n  Port 12222\n  IdentityFile /root/.ssh/vpntest\n  Tunnel ethernet\n  TunnelDevice 0:0\n  #RequestTTY no\n  PermitLocalCommand yes\n  LocalCommand ifconfig tap0 10.0.0.2 netmask 255.255.255.0\n\n(CentOS\u30c7\u30d5\u30a9\u30eb\u30c8\u306essh\u3067\u306fRequestTTY\u30aa\u30d7\u30b7\u30e7\u30f3\u304c\u3064\u3051\u3089\u308c\u306a\u3044\u306e\u3067\u3001\u30b3\u30e1\u30f3\u30c8\u30a2\u30a6\u30c8)\n# ssh vpntest2\n\n\u3067\u30c8\u30f3\u30cd\u30eb\u304c\u5f35\u3089\u308c\u308b\u306e\u3067\u3001route\u30b3\u30de\u30f3\u30c9\u306a\u3069\u3067\u78ba\u8a8d\u3059\u308b\u3002\n\u5148\u307b\u3069\u306eRequestTTY\u306e\u4ee3\u308f\u308a\u306b-T\u30aa\u30d7\u30b7\u30e7\u30f3\u3067\u306e\u8d77\u52d5\u3067\u30d0\u30c3\u30af\u30b0\u30e9\u30a6\u30f3\u30c9\u5316\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u308b\u3002\n# ssh -T vpntest2\n\n\u53c2\u8003:\nSSH\u30dd\u30fc\u30c8\u30d5\u30a9\u30ef\u30fc\u30c7\u30a3\u30f3\u30b0\nhttp://www.xdip.com/?id=ssh-tunnel\nhttp://www.xmisao.com/2013/09/12/ssh-portforwarding.html\nhttp://qiita.com/yakumo3/items/1e3be0a6e2190f11a4c0\nProxyChains\nhttp://proxychains.sourceforge.net/\nhttp://blog.kteru.net/proxychains-tips/\nhttp://askubuntu.com/questions/293649/proxychains-ld-preload-cannot-be-preloaded\nSSH VPN\nhttp://www.usupi.org/sysad/248.html\nProxychains-ng\nhttp://inaz2.hatenablog.com/entry/2014/08/20/004106\n\n##\u80cc\u666f\n\n\u3042\u308bDC\u5185\u306b\u3042\u308b\u30b5\u30fc\u30d0\u30fc(\u30b5\u30fc\u30d0\u30fcB)\u306b\u9650\u5b9aIP(\u30db\u30b9\u30c8A)\u304b\u3089SSH\u3067\u5165\u308c\u308b\u3088\u3046\u306b\u306a\u3063\u305f\u304c\u3001\u30c7\u30d5\u30a9\u30eb\u30c8GW\u306fDC\u5185\u9650\u5b9a\u306a\u306e\u3067\u3001yum\u306a\u3069\u3092\u3057\u3088\u3046\u3068\u3059\u308b\u3068FW\u304c\u90aa\u9b54\u3057\u3066\u30d5\u30a1\u30a4\u30eb\u3092\u6301\u3063\u3066\u304f\u308b\u3053\u3068\u304c\u3067\u304d\u306a\u3044\u3002Google DNS\u306a\u3069\u3092\u4f7f\u3063\u3066\u540d\u524d\u89e3\u6c7a\u306f\u3067\u304d\u308b\u3057\u3001ICMP\u306f\u901a\u308b\u3002\n\n\u30db\u30b9\u30c8A <==SSH==|=FW=> \u30b5\u30fc\u30d0\u30fcB <==> DC\u5185NW\n\n##\u89e3\u6c7a\u65b9\u6cd5\n\u30ea\u30e2\u30fc\u30c8\u3067\u3057\u304b\u7ba1\u7406\u3067\u304d\u306a\u3044\u306e\u3067\u3001\u30b5\u30fc\u30d0\u30fc\u306e\u30c7\u30d5\u30a9\u30eb\u30c8GW\u306a\u3069\u306e\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u8a2d\u5b9a\u306f\u5909\u3048\u305f\u304f\u306a\u3044\u3002\n\u3068\u308a\u3042\u3048\u305ayum\u3068\u304b\u304c\u51fa\u6765\u308c\u3070\u3044\u3044\u306e\u3067\u3001yum\u306e\u901a\u4fe1\u3092\u30db\u30b9\u30c8A\u7d4c\u7531\u306b\u3059\u308b\u65b9\u6cd5\u3002\n\n\u3064\u307e\u308a\u3001\u30b5\u30fc\u30d0\u30fcB\u304b\u3089\u30db\u30b9\u30c8A\u306b\u5bfe\u3057\u3066SSH\u3067\u30c0\u30a4\u30ca\u30df\u30c3\u30af\u30dd\u30fc\u30c8\u30d5\u30a9\u30ef\u30fc\u30c7\u30a3\u30f3\u30b0\u3092\u5f35\u308a\u3001\u30db\u30b9\u30c8A\u3092SOCKS\u30d7\u30ed\u30af\u30b7\u3068\u3057\u3066\u4f7f\u3046\u3002\n\n\u307e\u305fCentOS\u306b\u4ed8\u3044\u3066\u3044\u308byum\u3060\u3068socks5\u30d7\u30ed\u30af\u30b7\u304c\u4f7f\u3048\u306a\u3044\u306e\u3067\u3001\u4ed6\u306eproxy\u30bd\u30d5\u30c8\u3092\u4f7f\u3046\u3002\u8abf\u3079\u308b\u3068tsock,proxychain\u306a\u3069\u304c\u3042\u308b\u3002\u30b3\u30f3\u30d1\u30a4\u30eb\u304c\u7d20\u76f4\u306b\u901a\u3063\u305f\u306e\u304cproxychains\u3060\u3063\u305f\u306e\u3067\u3001\u3053\u3053\u3067\u306fproxychains\u3092\u4f7f\u3046\u65b9\u6cd5\u3002\n\n(\u4ed6\u306b\u3082\u3042\u308b\u304b\u3082\u3057\u308c\u306a\u3044\u3051\u3069\u3001\u56de\u308a\u304f\u3069\u3044\u304c\uff09\n\n##\u624b\u9806\n\n1.\u30db\u30b9\u30c8A\u3092\u8d77\u70b9\u306bSSH\u30ea\u30d0\u30fc\u30b9\u30dd\u30fc\u30c8\u30d5\u30a9\u30ef\u30fc\u30c7\u30a3\u30f3\u30b0\u3092\u30b5\u30fc\u30d0\u30fcB\u306b\u5f35\u308b\u3002\n\n```\nhostA $ ssh -R 12222:(hostA IP):22 (server B IP) \n```\n\n\u3053\u308c\u3067\u30b5\u30fc\u30d0\u30fcB\u304b\u3089\u30db\u30b9\u30c8A\u306b\u5bfe\u3057\u3066\u30dd\u30fc\u30c812222\u3067SSH\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u308b\u3002\n\n2.\u30b5\u30fc\u30d0\u30fcB\u3067SCREEN\u3092\u7acb\u3061\u4e0a\u3052\u3001\u305d\u3053\u304b\u3089\u30db\u30b9\u30c8A\u306b\u30c0\u30a4\u30ca\u30df\u30c3\u30af\u30dd\u30fc\u30c8\u30d5\u30a9\u30ef\u30fc\u30c7\u30a3\u30f3\u30b0\u3092\u5f35\u308b\u3002\n\n```\nserver B $ ssh -D8888 -p12222 (hostA\u3067\u306e\u30e6\u30fc\u30b6\u30fc\u540d)@127.0.0.1\n```\n\n\u3053\u308c\u3067\u30dd\u30fc\u30c88888\u3067\u30db\u30b9\u30c8A\u7d4c\u7531\u306eSOCKS5\u30d7\u30ed\u30af\u30b7\u3068\u306a\u308b\u3002\n\n3.proxychains\u3092DL\u3057\u3066\u3001scp\u3067\u30db\u30b9\u30c8A=>\u30b5\u30fc\u30d0\u30fcB\u3078\u30b3\u30d4\u30fc\n4.\u30b5\u30fc\u30d0\u30fcB\u4e0a\u3067\u3001\n\n```\nserver B $ tar vxzf proxychains-3.1.tar.gz\nserver B $ cd proxychains-3.1\nserver B $ ./configure; make\nserver B $ sudo make istall\n```\n\n\u3053\u308c\u3067proxychains\u30b3\u30de\u30f3\u30c9\u304c\u4f7f\u3048\u308b\u3002\u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u306f/bin/proxychains\u306b\u306a\u308b\u3002\n\u4f46\u3057\u3053\u306e\u307e\u307e\u3060\u3068\u3001\n\n```\nERROR: ld.so: object 'libproxychains.so.3' from LD_PRELOAD cannot be preloaded: ignored\n```\n\n\u3053\u3046\u3044\u3046\u30a8\u30e9\u30fc\u304c\u3067\u308b\u306e\u3067\u3001/bin/proxychains\u3092\u4fee\u6b63\u3059\u308b\u3002\nproxychains\u306f\u30b9\u30af\u30ea\u30d7\u30c8\u306b\u306a\u3063\u3066\u3044\u308b\u306e\u3067\u3001vim\u306a\u3069\u3067\u958b\u3044\u3066\n\n```\nexport LD_PRELOAD=libproxychains.so\n\u3092\nexport LD_PRELOAD=/lib/libproxychains.so\n\u306b\u4fee\u6b63\u3059\u308b\n```\n\n\u307e\u305f/etc/proxychains.conf\u3092\u958b\u3044\u3066\n\n```\n[ProxyList]\nsocks5  127.0.0.1 8888\n```\n\n\u3068\u3059\u308b\u3002\n\n\u4ee5\u4e0a\u3067\u3001proxychains\u30b3\u30de\u30f3\u30c9\u3067yum\u306a\u3069\u304c\u3067\u304d\u308b\u3002\n\n```\nserver B $ sudo proxychains yum install lynx\n```\n\n##VPN\u3092\u5f35\u308b\n\n\u3053\u3053\u307e\u3067\u306fssh\u30b3\u30cd\u30af\u30b7\u30e7\u30f3\u3067socks5\u30d7\u30ed\u30af\u30b7\u3068\u3059\u308b\u5834\u5408\u3060\u3063\u305f\u304c\u3001\u66f4\u306btun,tap\u30c7\u30d0\u30a4\u30b9\u3092\u4f5c\u308b\u3053\u3068\u3067vpn\u3092\u5f35\u308b\u3053\u3068\u304c\u3067\u304d\u308b\u3002\u3053\u3053\u3067\u306ftap\u30c7\u30d0\u30a4\u30b9\u3092\u4f5c\u308aL2\u30d6\u30ea\u30c3\u30b8\u306b\u3059\u308b\u5834\u5408\u3002\n\nserver\u5074\u304cNAT\u5185\u306b\u306a\u3063\u3066\u3044\u308b\u306e\u3067\u3001\u3053\u3053\u3067\u306fserver\u3092vpn\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u3001host\u5074\u3092vpn\u30b5\u30fc\u30d0\u30fc\u3068\u3059\u308b\u3002\n\u8a2d\u5b9a\u306f\u3001\n- \u30c7\u30d0\u30a4\u30b9\u540dtap0\n- vpn\u30b5\u30fc\u30d0\u30fc(host)IP\u30a2\u30c9\u30ec\u30b9 10.0.0.1\n- vpn\u30af\u30e9\u30a4\u30a2\u30f3\u30c8(server)IP\u30a2\u30c9\u30ec\u30b9 10.0.0.2\n\u3068\u3059\u308b\n\nserver\u5074\u3067\u3001vpn\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u3068\u3057\u3066\u3001\u9375\u751f\u6210\u3092\u884c\u3046\u3002\n\u30b9\u30af\u30ea\u30d7\u30c8\u5236\u5fa1\u3092\u884c\u3063\u305f\u308a\u3001\u81ea\u52d5\u8d77\u52d5\u3059\u308b\u5834\u5408\u306f\u30d1\u30b9\u30d5\u30ec\u30fc\u30ba\u306a\u3057\u306e\u8a2d\u5b9a\u3068\u3059\u308b\u3002\n\n```\nserver # ssh-keygen -f /root/.ssh/vpntest\n```\n\n\u3053\u3053\u3067private key\u3068public key\u304c\u3067\u304d\u308b\u306e\u3067\u3001public key\u3092vpn\u30b5\u30fc\u30d0\u30fc\u5074(host)\u3078\u6301\u3063\u3066\u884c\u304d\u3001/root/.ssh/authorized_keys\u3078\u8ffd\u52a0\u3059\u308b\n\u8ffd\u52a0\u306e\u3055\u3044\u306b\u4ee5\u4e0b\u306ecommand\u3092\u8ffd\u52a0\u3059\u308bpublic key\u306b\u52a0\u3048\u308b\n\n```\n no-X11-forwarding,no-agent-forwarding,no-pty,command=\"ifconfig tap0 10.0.0.1 netmask 255.255.255.0\" ssh-rsa ...\n```\n\n\u307e\u305f\u3001vpn\u30b5\u30fc\u30d0\u30fc\u5074(host)\u306esshd_config\u3092\n\n```\n  PermitTunnel ethernet\n```\n\n\u3068\u3057\u3001sshd\u30b5\u30fc\u30d3\u30b9\u3092reload\u3059\u308b\u3002\n\nvpn\u30af\u30e9\u30a4\u30a2\u30f3\u30c8(server)\u3067\u306f\u3001/root/.ssh/config\u307e\u305f\u306f/etc/ssh/ssh_config\u306b\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u8a2d\u5b9a\u3092\u52a0\u3048\u308b\u3002\n\u3053\u308c\u307e\u3067\u306e\u30dd\u30fc\u30c8\u30d5\u30a9\u30ef\u30fc\u30c7\u30a3\u30f3\u30b0\u8a2d\u5b9a\u3067\u3001localhost\u306e12222\u304cvpn\u30b5\u30fc\u30d0\u30fc(host)\u306b\u5411\u3044\u3066\u3044\u308b\u306e\u3067\u3001\u305d\u306e\u3088\u3046\u306b\u8a2d\u5b9a\u3059\u308b\u3002\n\n```\nHost vpntest2\n  HostName 127.0.0.1\n  Port 12222\n  IdentityFile /root/.ssh/vpntest\n  Tunnel ethernet\n  TunnelDevice 0:0\n  #RequestTTY no\n  PermitLocalCommand yes\n  LocalCommand ifconfig tap0 10.0.0.2 netmask 255.255.255.0\n```\n\n(CentOS\u30c7\u30d5\u30a9\u30eb\u30c8\u306essh\u3067\u306fRequestTTY\u30aa\u30d7\u30b7\u30e7\u30f3\u304c\u3064\u3051\u3089\u308c\u306a\u3044\u306e\u3067\u3001\u30b3\u30e1\u30f3\u30c8\u30a2\u30a6\u30c8)\n\n```\n# ssh vpntest2\n```\n\u3067\u30c8\u30f3\u30cd\u30eb\u304c\u5f35\u3089\u308c\u308b\u306e\u3067\u3001route\u30b3\u30de\u30f3\u30c9\u306a\u3069\u3067\u78ba\u8a8d\u3059\u308b\u3002\n\n\u5148\u307b\u3069\u306eRequestTTY\u306e\u4ee3\u308f\u308a\u306b-T\u30aa\u30d7\u30b7\u30e7\u30f3\u3067\u306e\u8d77\u52d5\u3067\u30d0\u30c3\u30af\u30b0\u30e9\u30a6\u30f3\u30c9\u5316\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u308b\u3002\n\n```\n# ssh -T vpntest2\n```\n\n\u53c2\u8003:\nSSH\u30dd\u30fc\u30c8\u30d5\u30a9\u30ef\u30fc\u30c7\u30a3\u30f3\u30b0\nhttp://www.xdip.com/?id=ssh-tunnel\nhttp://www.xmisao.com/2013/09/12/ssh-portforwarding.html\nhttp://qiita.com/yakumo3/items/1e3be0a6e2190f11a4c0\nProxyChains\nhttp://proxychains.sourceforge.net/\nhttp://blog.kteru.net/proxychains-tips/\nhttp://askubuntu.com/questions/293649/proxychains-ld-preload-cannot-be-preloaded\nSSH VPN\nhttp://www.usupi.org/sysad/248.html\n\nProxychains-ng\nhttp://inaz2.hatenablog.com/entry/2014/08/20/004106\n", "tags": ["Linux", "Yum", "SSH", "CentOS"]}