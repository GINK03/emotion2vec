{"context": " More than 1 year has passed since last update.excel\u306e\u30b7\u30fc\u30c8\u306e\u30bb\u30eb\u306b\u3042\u308b\u30c7\u30fc\u30bf\u3092\u5143\u306b\u3001utf-8\u3001BOM\u306a\u3057\u30d5\u30a1\u30a4\u30eb\u3092\u51fa\u529b\u3059\u308b\u305f\u3081\u306b\u5b9f\u88c5\u3057\u305f\u3082\u306e\u3002\n\n\u3053\u30fc\u3069\nPublic Function writeFile(in_filpth As String, in_buf As String) As Boolean\n    writeFile = False\n    On Error GoTo Err\n    Dim st As New ADODB.Stream\n    With st\n        .Type = adTypeText\n        .Charset = \"UTF-8\"\n        .Open\n        .WriteText in_buf\n        .Position = 0\n        .Type = adTypeBinary\n        .Position = 3\n        Dim buf As Variant\n        buf = .Read()\n        .Position = 0\n        .Write buf\n        .SetEOS\n        .SaveToFile in_filpth, adSaveCreateOverWrite\n    End With\n    st.Close\n    Set st = Nothing\n    writeFile = True\nErr:\n    If Err.Number <> 0 Then\n        Debug.Print\u3000\"writeFile(): \" & Err.description\n    End If\nEnd Function\n\n\n\u3053\u30fc\u3069\u306e\u305b\u3064\u3081\u3044\n\nADODB.Stream\u3092\u4f7f\u7528\n\u59cb\u3081\u306b\u30bf\u30a4\u30d7adTypeText\u3001Charset \"UTF-8\"\u3067\u3001\u30d5\u30a1\u30a4\u30eb\u306b\u51fa\u529b\u3059\u308b\u5185\u5bb9\u3092\u66f8\u304d\u8fbc\u3080\n\u6b21\u306b\u3001\u30bf\u30a4\u30d7\u3092adTypeBinary\u306b\u3057\u3066\u3001BOM\u3092\u98db\u3070\u3057\u3066\u3001\u66f8\u304d\u8fbc\u3093\u3060\u5185\u5bb9\u3092\u5909\u6570buf\u306b\u8a2d\u5b9a\u3059\u308b\nBOM\u3092\u6f70\u3059\u305f\u3081\u306b\u3001Position\u30920\u306b\u3057\u3066\u3001\u5909\u6570buf\u306e\u5185\u5bb9\u3092\u66f8\u304d\u623b\u3059\nBOM\u3092\u6f70\u3057\u305f\u5206\u3001\u5f8c\u308d\u306b\u30b4\u30df\u304c\u6b8b\u308b\u306e\u3067\u3001SetEOS\u3067\u53d6\u308a\u9664\u304f\nSaveToFile\u3067\u30d5\u30a1\u30a4\u30eb\u306b\u51fa\u529b\n\nexcel\u306e\u30b7\u30fc\u30c8\u306e\u30bb\u30eb\u306b\u3042\u308b\u30c7\u30fc\u30bf\u3092\u5143\u306b\u3001utf-8\u3001BOM\u306a\u3057\u30d5\u30a1\u30a4\u30eb\u3092\u51fa\u529b\u3059\u308b\u305f\u3081\u306b\u5b9f\u88c5\u3057\u305f\u3082\u306e\u3002\n\n# \u3053\u30fc\u3069\n```vbnet:\nPublic Function writeFile(in_filpth As String, in_buf As String) As Boolean\n    writeFile = False\n    On Error GoTo Err\n    Dim st As New ADODB.Stream\n    With st\n        .Type = adTypeText\n        .Charset = \"UTF-8\"\n        .Open\n        .WriteText in_buf\n        .Position = 0\n        .Type = adTypeBinary\n        .Position = 3\n        Dim buf As Variant\n        buf = .Read()\n        .Position = 0\n        .Write buf\n        .SetEOS\n        .SaveToFile in_filpth, adSaveCreateOverWrite\n    End With\n    st.Close\n    Set st = Nothing\n    writeFile = True\nErr:\n    If Err.Number <> 0 Then\n        Debug.Print\u3000\"writeFile(): \" & Err.description\n    End If\nEnd Function\n```\n# \u3053\u30fc\u3069\u306e\u305b\u3064\u3081\u3044\n* ADODB.Stream\u3092\u4f7f\u7528\n* \u59cb\u3081\u306b\u30bf\u30a4\u30d7adTypeText\u3001Charset \"UTF-8\"\u3067\u3001\u30d5\u30a1\u30a4\u30eb\u306b\u51fa\u529b\u3059\u308b\u5185\u5bb9\u3092\u66f8\u304d\u8fbc\u3080\n* \u6b21\u306b\u3001\u30bf\u30a4\u30d7\u3092adTypeBinary\u306b\u3057\u3066\u3001BOM\u3092\u98db\u3070\u3057\u3066\u3001\u66f8\u304d\u8fbc\u3093\u3060\u5185\u5bb9\u3092\u5909\u6570buf\u306b\u8a2d\u5b9a\u3059\u308b\n* BOM\u3092\u6f70\u3059\u305f\u3081\u306b\u3001Position\u30920\u306b\u3057\u3066\u3001\u5909\u6570buf\u306e\u5185\u5bb9\u3092\u66f8\u304d\u623b\u3059\n* BOM\u3092\u6f70\u3057\u305f\u5206\u3001\u5f8c\u308d\u306b\u30b4\u30df\u304c\u6b8b\u308b\u306e\u3067\u3001SetEOS\u3067\u53d6\u308a\u9664\u304f\n* SaveToFile\u3067\u30d5\u30a1\u30a4\u30eb\u306b\u51fa\u529b\n", "tags": ["VBA"]}