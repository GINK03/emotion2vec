{"tags": ["LiquidFun1.1", "JavaScript", "d3.js", "Emscripten"], "context": " More than 1 year has passed since last update.\n\nLiquidFun\u3063\u3066\uff1f\nLiquidFun\u306fGoogle\u304c\u958b\u767a\u3057\u3066\u3044\u308b2\u6b21\u5143\u6d41\u4f53\u6f14\u7b97\u30a8\u30f3\u30b8\u30f3.\nC++\u3067\u958b\u767a\u3055\u308c\u3066\u3044\u308b\u304c\u3001Emscripten\u3067\u306e\u5909\u63db\u306b\u3088\u308a\u3001JavaScript\u3067\u3082\u5229\u7528\u53ef\u80fd\u3067\u3042\u308b\u3002\n(\u4f3c\u305f\u3088\u3046\u306a\u8a71\u304c3\u6b21\u5143\u7269\u7406\u6f14\u7b97\u30a8\u30f3\u30b8\u30f3\u306eBullet\u3068ammo.js\u304c\u3042\u308a\u307e\u3059\u306d\u3002ammo.js\u306f\u30dd\u30fc\u30c6\u30a3\u30f3\u30b0\u65b9\u6cd5\u3092Emascripten\u304b\u3089\u898b\u76f4\u3059\u3089\u3057\u3044\u3067\u3059\u304c...)\n\nLiquidFun.js\u3092\u89e6\u3063\u3066\u307f\u3088\u3046\n\u3055\u3066\u3001\u3053\u3053\u304b\u3089\u304c\u672c\u984c.\nhttp://google.github.io/liquidfun/ \u306b\u3082liquidfun.js\u306e\u30c7\u30e2(testbed)\u304c\u57cb\u3081\u8fbc\u307e\u308c\u3066\u3044\u308b\u304c\u3001\u81ea\u5206\u306e\u304a\u52c9\u5f37\u3082\u304b\u306d\u3066\u3001\u30b5\u30f3\u30d7\u30eb\u30b3\u30fc\u30c9\u3092\u30ac\u30ea\u30ac\u30ea\u3068\u4f5c\u6210\u3057\u305f\u306e\u3067\u3001\u5b66\u3093\u3060\u3053\u3068\u3092\u66f8\u304d\u9023\u306d\u3066\u307f\u308b.\n\n\u4f5c\u6210\u3057\u305f\u30d6\u30c4\n\n\u6b63\u4e09\u89d2\u5f62\u30fb\u9577\u65b9\u5f62\u306e\u525b\u4f53\u3092\u6db2\u4f53(\u7d2b\u8272\u3068\u9752\u8272\u306e\u30c4\u30d6\u30c4\u30d6\u90e8\u5206)\u306b\u3080\u3051\u3066\u843d\u4e0b\u3055\u305b\u308b\u3060\u3051\u306e\u30b5\u30f3\u30d7\u30eb\u3067\u3042\u308b(jsfiddle\u3067\u52d5\u4f5c\u78ba\u8a8d\u3067\u304d\u307e\u3059).\n\u30b3\u30fc\u30c9\u306f\u5c11\u3057\u9577\u3044\u306e\u3067\u3001\u672b\u5c3e\u306b\u4ed8\u8a18\u3002\n\nLiquidFun.js\u672c\u4f53\u306e\u53d6\u5f97\nhttps://github.com/google/liquidfun/releases/ \u304b\u3089\u6700\u65b0\u7248\u306ezip\u306a\u308a\u3092DL\u30fb\u5c55\u958b\u3059\u308b\u3068\u3001liquidfun/Box2D/lfjs/liquidfun.js \u306b.js\u30d5\u30a1\u30a4\u30eb\u304c\u3042\u308b.\nliquidfun.js\u4ee5\u5916\u306b\u3082\u540c\u30d5\u30a9\u30eb\u30c0\u306b.js\u30d5\u30a1\u30a4\u30eb\u304c\u3042\u308b\u304c\u3001\u7121\u8996\u3057\u3066\u3088\u3044\u3063\u307d\u3044.\n\n\u5168\u4f53\u306e\u6d41\u308c\n\u4ed6\u306e\u30b7\u30df\u30e5\u30ec\u30fc\u30bf\u3068\u540c\u69d8\u3001LifuidFun\u5229\u7528\u6642\u306e\u5927\u307e\u304b\u306a\u6d41\u308c\u306f\u4e0b\u8a18\u3002\n\n\u521d\u671f\u5316\n\n\n\u74b0\u5883(=b2World)\u306e\u5b9a\u7fa9\n\n\n\u30b7\u30df\u30e5\u30ec\u30fc\u30b7\u30e7\u30f3\u5bfe\u8c61\u7269\u4f53\u914d\u7f6e\n\n\n\u525b\u4f53(=b2Body)\u306e\u5b9a\u7fa9, \u74b0\u5883\u3078\u306e\u525b\u4f53\u8ffd\u52a0\n\u6d41\u4f53(=b2ParticleGroup)\u306e\u5b9a\u7fa9, \u74b0\u5883\u3078\u306e\u6d41\u4f53\u8ffd\u52a0\n\n\n\u30eb\u30fc\u30d7\n\n\n\u74b0\u5883\u306e\u66f4\u65b0\n\u74b0\u5883\u304b\u3089\u525b\u4f53\u3084\u6d41\u4f53\u60c5\u5831\u3092\u53d6\u5f97\u3001\u63cf\u753b\n\n\n\nLiquidFun\u81ea\u4f53\u306b\u306f\u3001\u63cf\u753b\u7cfb\u306e\u6a5f\u69cb\u306f\u4e00\u5207\u542b\u307e\u308c\u3066\u3044\u306a\u3044\u306e\u3067\u3001\n\n\u74b0\u5883\u5185\u5f62\u72b6\u306e\u5ea7\u6a19\u3084\u89d2\u5ea6\u3001\u5927\u304d\u3055\u7b49\u306e\u5f62\u72b6\u60c5\u5831\u53d6\u5f97\u307e\u3067\u3092LiquidFun.\n\u53d6\u5f97\u3057\u305f\u60c5\u5831\u306e\u51fa\u529b(\u63cf\u753b)\u306f\u5225\u9014\u63cf\u753b\u7cfb\u306e\u30d7\u30ed\u30b0\u30e9\u30e0\u304c\u5fc5\u8981(WebGL\u30e9\u30a4\u30d6\u30e9\u30ea\u3084Canbas, SVG\u7b49)\n\n\u30ac\u30a4\u30c9\u3092\u8aad\u3080\u9650\u308a\u306f\u3001OpenGL\u3092\u610f\u8b58\u3057\u305f\u4f5c\u308a\u306b\u306a\u3063\u3066\u3044\u308b\u305f\u3081\u3001\u30af\u30e9\u30a4\u30a2\u30f3\u30c8JavaScript\u3067\u3042\u308c\u3070\u3001Three.js\u306a\u3069WebGL\u306e\u30e9\u30a4\u30d6\u30e9\u30ea\u3092\u4f7f\u3046\u306e\u304c\u771f\u3063\u5f53\u304b. \n\n\u74b0\u5883\n\n\u74b0\u5883\u306e\u5b9a\u7fa9\n\u4f55\u306f\u3068\u3082\u3042\u308c\u3001\u74b0\u5883\u5b9a\u7fa9\u3057\u306a\u3044\u3068\u59cb\u307e\u3089\u306a\u3044\u3002\nvar gravity = new b2Vec2(0, -10);\nvar world = new b2World(gravity);\n\n\u3068\u3044\u3063\u3066\u3082\u3001\u91cd\u529b\u306e\u5411\u304d\u3068\u5f37\u3055\u3092\u6307\u5b9a\u3057\u305f\u4e0a\u3067\u3001b2Wolrd\u306e\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u3092\u4f5c\u6210\u3059\u308b\u3060\u3051\u3002\n\u4f46\u3057\u3001\u4e00\u70b9\u6ce8\u610f\u304c\u3042\u308b.\nb2World \u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306f\u3001\u7d76\u5bfe\u306bworld\u306e\u540d\u524d\u3067\u30b0\u30ed\u30fc\u30d0\u30eb\u5909\u6570\u5ba3\u8a00\u3059\u308b\u3053\u3068.\n\u4ed6\u306e\u5909\u6570\u540d\u306b\u3057\u305f\u308a\u3001\u30b0\u30ed\u30fc\u30d0\u30eb\u304b\u3089\u53c2\u7167\u51fa\u6765\u306a\u3044\u30b9\u30b3\u30fc\u30d7\u306b\u5165\u308c\u308b\u3068\u3001\u5f8c\u8ff0\u306eCreateFixtureFromShape()\u30e1\u30bd\u30c3\u30c9\u3067ReferenceError\u304c\u30b9\u30ed\u30fc\u3055\u308c\u308b(\u3069\u3046\u8003\u3048\u3066\u3082\u53ea\u306e\u30d0\u30b0\u3060\u308d\u3046\u304c...).\n\n\u74b0\u5883\u306e\u66f4\u65b0\n\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u30eb\u30fc\u30d7\u51e6\u7406\u306e\u4e2d\u3067\u3001\u30b7\u30df\u30e5\u30ec\u30fc\u30b7\u30e7\u30f3\u72b6\u614b\u3092\u66f4\u65b0\u3057\u3066\u3044\u304f\u305f\u3081\u306b\u547c\u3073\u51fa\u3059\u51e6\u7406\u3002\n\u30d6\u30e9\u30a6\u30b6\u306a\u3089\u3001window.requestAnimationFrame\u3068\u7d44\u307f\u5408\u308f\u305b\u308b\u3053\u3068\u304c\u591a\u3044\u306f\u305a\u3002\nfunction render(){\n  world.Step(1.0/60.0, 8, 3);\n  requiestAnimationFrame(render);\n}\n\nStep()\u30e1\u30bd\u30c3\u30c9\u306e\u5f15\u6570\u306f\u3001\u300c\u6642\u523b\u5dee\u5206\u300d\u3001\u300c\u901f\u5ea6\u6c7a\u5b9a\u306e\u30a4\u30c6\u30ec\u30fc\u30b7\u30e7\u30f3\u56de\u6570\u300d, \u300c\u4f4d\u7f6e\u6c7a\u5b9a\u306e\u30a4\u30c6\u30ec\u30fc\u30b7\u30e7\u30f3\u56de\u6570\u300d\u3067\u3042\u308b.\n\u7b2c2, \u7b2c3\u5f15\u6570\u306e\u30a4\u30c6\u30ec\u30fc\u30b7\u30e7\u30f3\u56de\u6570\u306b\u3064\u3044\u3066\u306f\u3001\u5927\u304d\u304f\u3059\u308c\u3070\u7cbe\u5ea6\u304c\u4e0a\u304c\u308b\u304c\u3001\u8a08\u7b97\u6642\u9593\u3082\u305d\u306e\u5206\u4e0a\u304c\u308b\u985e\u306e\u30d1\u30e9\u30e1\u30fc\u30bf\u3002\n\u4e00\u56de\u306e\u30b9\u30c6\u30c3\u30d7\u5185\u306b\u3066\u3001\u500b\u3005\u306e\u7c92\u5b50\u3084\u525b\u4f53\u901f\u5ea6/\u4f4d\u7f6e\u306e\u6c7a\u5b9a\u306b\u4f55\u56de\u306e\u30a4\u30c6\u30ec\u30fc\u30b7\u30e7\u30f3\u3092\u884c\u3046\u304b\u3001\u3092\u610f\u5473\u3057\u3066\u3044\u308b\u3002\n\u672c\u5bb6\u306e\u958b\u767a\u30ac\u30a4\u30c9\u306b\u3088\u308b\u3068\u3001\u30a4\u30c6\u30ec\u30fc\u30b7\u30e7\u30f3\u56de\u6570\u306f\u7b2c1\u5f15\u6570\u3068\u306e\u30c8\u30ec\u30fc\u30c9\u30aa\u30d5\u3082\u3042\u308b\u3002\n30FPS\u306720\u56de\u30a4\u30c6\u30ec\u30fc\u30b7\u30e7\u30f3\u3059\u308b\u3088\u308a\u3082\u300160FPS\u306710\u56de\u30a4\u30c6\u30ec\u30fc\u30b7\u30e7\u30f3\u3057\u305f\u65b9\u304c\u826f\u3044\u3001\u3068\u306e\u3053\u3068\u3002\n\n\u525b\u4f53\n\u300c\u525b\u4f53\u300d\u306f\u5f62\u72b6\u304c\u5909\u5316\u3057\u306a\u3044\u7269\u4f53\u306e\u3053\u3068.\n\u4eca\u56de\u306e\u30b5\u30f3\u30d7\u30eb\u3067\u306f\u3001\u300c\u5168\u4f53\u306e\u5883\u754c\u3068\u306a\u3063\u3066\u3044\u308b\u7bb1\u300d\u3001\u300c\u843d\u4e0b\u3057\u3066\u304f\u308b\u591a\u89d2\u5f62\u300d\u304c\u525b\u4f53.\n\n\u525b\u4f53\u306e\u4f5c\u6210\nLiquidFun\u3067\u306f\u525b\u4f53\u306e\u7a2e\u985e\u306f\u5e7e\u3064\u304b\u7528\u610f\u3055\u308c\u3066\u3044\u3066\u3001 b2BodyDef.prototype.type\u3067\u6307\u5b9a\u3059\u308b\u3002\n\n\nb2_staticBody\n\u9759\u7684\u525b\u4f53. \u660e\u793a\u7684\u306b\u30dd\u30b8\u30b7\u30e7\u30f3\u3092\u5909\u66f4\u3057\u306a\u3044\u9650\u308a\u52d5\u304b\u306a\u3044. \u30c7\u30d5\u30a9\u30eb\u30c8.\n\nb2_kinematicBody\n\u81ea\u8eab\u306e\u901f\u5ea6\u306b\u3088\u308a\u3001\u79fb\u52d5\u3059\u308b\u525b\u4f53. \u91cd\u529b\u5f71\u97ff\u3084\u885d\u7a81\u5224\u5b9a\u306f\u8a08\u7b97\u3055\u308c\u306a\u3044.\n\u52d5\u7684(b2_dynamicBody)\n\u30d5\u30eb\u30b7\u30df\u30e5\u30ec\u30fc\u30b7\u30e7\u30f3. \u91cd\u529b\u5f71\u97ff\u3084\u525b\u4f53\u9593\u306e\u885d\u7a81\u5224\u5b9a, \u6d41\u4f53 - \u525b\u4f53\u6319\u52d5\u306e\u5168\u3066\u304c\u8a08\u7b97\u3055\u308c\u308b.\n\nvar bodyDef = new b2BodyDef();\nbodyDef.type = b2_dynamicBody;\n\nvar body = world.CreateBode(bodyDef);\n\nb2World.prptotype.CreateBody\u306bbodyDef\u3092\u55b0\u308f\u305b\u308b\u3053\u3068\u3067\u3001\u525b\u4f53\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u304c\u4f5c\u6210\u3067\u304d\u308b\u3002\n\n\u525b\u4f53\u5f62\u72b6\n\u525b\u4f53\u306e\u5f62\u72b6\u3092\u6c7a\u5b9a\u3059\u308b\u306b\u306f\u3001\u5e7e\u3064\u304b\u65b9\u6cd5\u304c\u3042\u308a\u305d\u3046\u3060\u3051\u3069\u3001\u5f62\u72b6\u3092\u4f5c\u6210\u2192\u5f62\u72b6\u3092Fixture\u3068\u3057\u3066\u525b\u4f53\u306b\u30bb\u30c3\u30c8\u3001\u306e\u307f\u628a\u63e1\u3002\nLiquidFun\u306b\u304a\u3044\u3066\u3001\u300c\u5f62\u72b6\u300d\u306fb2****Shape\u3068\u3044\u3046\u540d\u524d\u306e\u30b3\u30f3\u30b9\u30c8\u30e9\u30af\u30bf\u3067\u7528\u610f\u3055\u308c\u3066\u3044\u308b(b2CircleShape(\u5186)\u3068\u304bb2ChainShape(\u30dd\u30ea\u30b4\u30f3)\u3068\u304b).\n\u5f62\u72b6\u7a2e\u985e\u6bce\u306b\u5f62\u72b6\u5b9a\u7fa9\u65b9\u6cd5\u306f\u7570\u306a\u308b\u304c\u3001\u5f62\u72b6\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u3092\u4f5c\u3063\u3066\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306bb2Body\u306b\u55b0\u308f\u305b\u308c\u3070\u3088\u3044\u3002\nbody.CreateFixtureFromShape(shape, 0.5);\n\n\u306a\u304a\u3001\u7b2c\u4e8c\u5f15\u6570\u306f\u5bc6\u5ea6\u30d1\u30e9\u30e1\u30fc\u30bf\u3068\u306e\u3053\u3068\u3002\n\u525b\u4f53\u5f62\u72b6\u306b\u306fworld.bodies[3].fixtures[0].shape\u306e\u3088\u3046\u306b\u3001fixtures\u7d4c\u7531\u3067\u30a2\u30af\u30bb\u30b9\u51fa\u6765\u308b\u3002\n\n\u525b\u4f53\u306e\u8cea\u91cf\n\u525b\u4f53\u306b\u306f\u3001\u8cea\u91cf\u60c5\u5831\u3092\u8a2d\u5b9a\u3067\u304d\u308b\u3002\nvar massData = new b2MassData(1.2, new b2Vec(0, 0), 0.3);\nbody.SetMassData(massData);\n\nb2MassData\u306e\u30b3\u30f3\u30b9\u30c8\u30e9\u30af\u30bf\u5f15\u6570\u306f\u3001\u9806\u306b\u8cea\u91cf(\u30b9\u30ab\u30e9)\u3001\u525b\u4f53\u306e\u91cd\u5fc3\u5ea7\u6a19\u30d9\u30af\u30c8\u30eb\u3001\u6163\u6027\u30e2\u30fc\u30e1\u30f3\u30c8\u5024\u3067\u3042\u308b\u3002\n\u6163\u6027\u30e2\u30fc\u30e1\u30f3\u30c8\u5024\u306e\u30c7\u30d5\u30a9\u30eb\u30c8\u5024\u306f0\u3067\u3042\u308b\u304c\u3001\u3053\u308c\u306f\u300c\u3053\u306e\u525b\u4f53\u306f\u4e00\u5207\u56de\u8ee2\u3057\u307e\u305b\u3093\u300d\u3068\u3044\u3046\u610f\u5473.\n\n\u525b\u4f53\u306e\u4f4d\u7f6e\u60c5\u5831\nb2Body\u306e\u30e1\u30f3\u30d0\u95a2\u6570\u3001GetPosition(), GetAngle()\u3067\u4f4d\u7f6e\u5ea7\u6a19\u3001\u50be\u659c\u89d2(\u30e9\u30b8\u30a2\u30f3)\u304c\u53d6\u5f97\u3067\u304d\u308b(\u89d2\u5ea6\u60c5\u5831\u306fGetRotate()\u3067\u3001cos, sin\u306e\u5024\u3092\u76f4\u306b\u53d6\u5f97\u3059\u308b\u3053\u3068\u3082\u3067\u304d\u308b. \u56de\u8ee2\u884c\u5217\u304c\u6b32\u3057\u3044\u3068\u304d\u306f\u3053\u3063\u3061\u304c\u4fbf\u5229).\n\u4f4d\u7f6e\u3092\u6307\u5b9a\u3059\u308b\u5834\u5408\u306f\u3001b2Body.prototype.SetPosition()\u3092\u53e9\u3051\u3070\u826f\u3044\u3002\u5f15\u6570\u306f\u5ea7\u6a19\u30d9\u30af\u30c8\u30eb\u3068\u56de\u8ee2\u89d2\u3067\u3042\u308b\u3002\n\n\u6d41\u4f53\n\u3055\u3066\u3001LiquidFun\u3068\u3044\u3046\u3060\u3051\u3042\u3063\u3066\u3001\u6d41\u4f53\u306f\u3053\u306e\u30e9\u30a4\u30d6\u30e9\u30ea\u306e\u5927\u304d\u306a\u7279\u5fb4\u3060.\n\u300c\u6d41\u4f53\u300d\u3068\u3044\u3063\u3066\u3044\u308b\u304c\u3001\u30a4\u30e1\u30fc\u30b8\u306f\u5fae\u5c0f\u7c92\u5b50\u306e\u96c6\u5408\u4f53\u3060.\nLiquidFun\u3067\u306f\u3001\u3053\u306e\u300c\u5fae\u5c0f\u7c92\u5b50\u306e\u96c6\u5408\u4f53\u300d\u3092 b2ParticleSystem \u306a\u308b\u30af\u30e9\u30b9\u3067\u7ba1\u7406\u3059\u308b.\n\n\u6d41\u4f53\u306e\u4f5c\u6210\n\u525b\u4f53\u3068\u540c\u69d8\u3001\u6d41\u4f53\u306e\u5834\u5408\u3082\u5b9a\u7fa9\u4f53\u304c\u5b58\u5728\u3059\u308b. b2ParticleSystemDef\u3060.\n\u4e0b\u8a18\u306e\u3088\u3046\u306b\u4f7f\u3046.\nvar psdef = new b2ParticleSystemDef(), ps;\npsdef.radius = 0.01;\npsdef.dampingStrength = 0.1;\n\nps = world.CreateParticleSystem(psdef);\n\n\u4e0a\u8a18\u306f\u3001\u7c92\u5b50\u534a\u5f840.02, \u6e1b\u8870\u5ea6\u5408\u30440.1\u306e\u6d41\u4f53\u3092\u8868\u3059.\n\u4ed6\u306b\u3082\u3001psdef.density\u306f\u6d41\u4f53\u306e\u5bc6\u5ea6\u3067\u3042\u3063\u305f\u308a\u3068\u3001\u6d41\u4f53\u306e\u7269\u7406\u30d1\u30e9\u30e1\u30fc\u30bf\u304c\u5b58\u5728\u3059\u308b(\u4e00\u89a7\u306f\u672c\u5bb6API\u30ea\u30d5\u30a1\u30ec\u30f3\u30b9\u306b\u3066).\n\n\u6d41\u4f53\u3078\u306e\u7c92\u5b50\u914d\u7f6e\nb2ParticleSystem\u306f\u4f5c\u6210\u3057\u305f\u3060\u3051\u3067\u306f\u3001\u7a7a\u3063\u307d\u306a\u306e\u3067\u3001\u7c92\u5b50\u3092\u8ffd\u52a0\u3057\u3066\u3044\u304f\u5fc5\u8981\u304c\u3042\u308b.\n2\u901a\u308a\u306e\u65b9\u6cd5\u304c\u3042\u308b\u306e\u3060\u304c\u3001\u3053\u3053\u3067\u306fb2ParticleGroup\u3092\u5229\u7528\u3059\u308b\u65b9\u6cd5\u3092\u8a18\u8f09\u3059\u308b.\nvar pgdef = new b2ParticleGroupDef(), shape;\n\nshape = new b2CircleShape();\nshape.radius = 1.0;\npgdef.shape = shape;\npgdef.position = new b2Vec(3.0, 2.0);\n\nps.CreateParticleGroup(pgdef);\n\n\u3053\u308c\u306f\u3001\u300c\u4e2d\u5fc3\u5ea7\u6a19(3.0, 2.0)\u306b\u534a\u5f841.0\u306e\u5186\u5f62\u72b6\u300d\u306e\u4e2d\u306b\u307f\u3063\u3061\u308a\u7c92\u5b50\u304c\u3064\u307e\u3063\u3066\u3044\u308b\u72b6\u614b\u3092\u521d\u671f\u5f62\u72b6\u3068\u3057\u305f\u7c92\u5b50\u7fa4\u3092\u4f5c\u6210\u3059\u308b\u3001\u3068\u3044\u3046\u4f8b\u3067\u3042\u308b\u3002\n\u3053\u3053\u3067\u3001\u6ce8\u610f\u304c\u5fc5\u8981\u306a\u306e\u306f\u3001\u7c92\u5b50\u6570\u306fps.radius\u306e\u5024\u3068shape\u306e\u5f62\u72b6\u304b\u3089\u9006\u7b97\u3055\u308c\u3066\u81ea\u52d5\u3067\u6c7a\u5b9a\u3055\u308c\u308b\u70b9\u3067\u3042\u308b.\n\u3082\u3061\u308d\u3093\u3001\u7c92\u5b50\u6570\u304c\u591a\u3044(=\u534a\u5f84\u304c\u5c0f\u3055\u3044)\u65b9\u304c\u9ad8\u7cbe\u5ea6\u3060\u304c\u3001\u5f53\u7136\u3001\u305d\u306e\u5206\u306e\u8a08\u7b97\u30b3\u30b9\u30c8\u304c\u3064\u3044\u3066\u304f\u308b\u3053\u3068\u306b\u306a\u308b.\n\n\u6d41\u4f53\u7c92\u5b50\u306e\u4f4d\u7f6e\u53d6\u5f97\n\u5404\u7c92\u5b50\u306e\u5ea7\u6a19\u4f4d\u7f6e\u3092\u53d6\u5f97\u3059\u308b\u306b\u306f\u3001b2ParticleSystem.prototype.GetPositionBuffer()\u3067\u53d6\u5f97\u3055\u308c\u308bFloat32Array\u914d\u5217\u3092\u7528\u3044\u308b.\n\u3053\u306e\u914d\u5217\u306f\u3001\u4e0b\u8a18\u306e\u69cb\u9020\u3067\u7c92\u5b50\u306e(x, y)\u5ea7\u6a19\u304c\u30da\u30a2\u306e\u5f62\u3067\u4fdd\u5b58\u3055\u308c\u3066\u3044\u308b.\n[x0, y0, x1, y1, x2, y2, x3, y3,...]\n\n\u3057\u305f\u304c\u3063\u3066\u3001\u7c92\u5b50\u3092\u63cf\u753b\u3059\u308b\u985e\u306e\u51e6\u7406\u30a4\u30e1\u30fc\u30b8\u306f\u6b21\u306e\u3088\u3046\u306b\u306a\u308b.\nvar ps = world.particleSystems[0], buf = ps.GetPositionBuffer(), count = buf.length;\n\nfor(var i = 0; i < count; i = i + 2){\n  console.log('x, y:', buf[i], buf[i+1]);\n}\n\nb2ParticleSystem\u306b\u8907\u6570\u306eb2ParticleGroup\u3092\u30bb\u30c3\u30c8\u3057\u3066\u3044\u308b\u5834\u5408\u306b\u30012\u756a\u76ee\u306e\u30b0\u30eb\u30fc\u30d7\u60c5\u5831\u306e\u307f\u306e\u7c92\u5b50\u306b\u5bfe\u3059\u308b\u30eb\u30fc\u30d7\u3092\u884c\u3044\u305f\u3051\u308c\u3070\u3001\u6b21\u306e\u3088\u3046\u306b\u3059\u308c\u3070\u3088\u3044.\nvar ps = world.particleSystem[0], pg = ps.particleGroups[1];\n\nvar offset = pg.GetPositionIndex();\nvar length = pg.GetParticleCount();\n\nfor(var i = offset * 2; i < (offset + length) * 2; i = i + 2){\n  console.log('x, y:', buf[i], buf[i+1]);\n}\n\n\n\u6d41\u4f53\u7c92\u5b50\u306e\u632f\u308b\u821e\u3044\nLiquidFun\u3067\u306f\u6db2\u4f53\u3060\u3051\u3067\u306a\u304f\u3001\u7802\u5875\u306e\u3088\u3046\u306a\u30d1\u30a6\u30c0\u30fc\u3084\u30b0\u30cb\u30e3\u30c3\u3068\u3057\u305f\u8edf\u4f53\u7b49\u3001\u8272\u3005\u306a\u632f\u308b\u821e\u3044\u3092b2ParticleSystem\u3067\u30b7\u30df\u30e5\u30ec\u30fc\u30b7\u30e7\u30f3\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u308b.\n\u7c92\u5b50\u306e\u6319\u52d5\u306f\u3001b2ParicleGroupDef(b2ParticleDef\u3067\u3082\u53ef)\u306eflags\u3068\u3044\u3046\u5c5e\u6027\u3067\u6307\u5b9a\u3059\u308b\u3053\u3068\u304c\u51fa\u6765\u308b.\n\u6307\u5b9a\u53ef\u80fd\u306a\u5024\u306f \"b2_*****Paricle\"\u3068\u3044\u3046\u540d\u524d\u3067\u5b9a\u6570\u5316\u3055\u308c\u3066\u3044\u308b(\u53b3\u5bc6\u306b\u306fC++\u3067\u306f\u5217\u6319\u4f53\u3067\u3042\u3063\u305f\u304c\u3001Emscripten\u306b\u3088\u308a\u53ea\u306e\u5b9a\u6570\u306b\u843d\u3068\u3055\u308c\u3066\u307e\u3059...)\n\n\nb2_waterParticle\n\u6240\u8b02\u6db2\u4f53. \u30c7\u30d5\u30a9\u30eb\u30c8.\n\nb2_elasticParticle\n\u8edf\u4f53. \u30d6\u30e8\u30d6\u30e8\u3068\u3057\u305f\u30b0\u30df\u306e\u3088\u3046\u306a\u7269\u4f53\u3068\u306a\u308b.\n\nb2_powderParticle\n\u7802\u5875\u306e\u3088\u3046\u306a\u7c89\u3063\u307d\u3044\u7c92\u5b50.\n\nb2_biscousParticle\n\u6cb9\u306e\u3088\u3046\u306a\u3001\u7c98\u6027\u306e\u3042\u308b\u6db2\u4f53.\n\nb2_colorMixingParticle\n\u8272\u304c\u6df7\u3056\u3063\u3066\u3044\u304f\u6db2\u4f53. \n\n\u306a\u304a\u3001| \u6f14\u7b97\u5b50\u3067\u7d50\u5408\u3059\u308b\u3053\u3068\u3067\u3001\u8907\u6570\u306e\u30bf\u30a4\u30d7\u306e\u7d44\u307f\u5408\u308f\u305b\u6307\u5b9a\u3082\u53ef\u80fd. \npgdef.flags = b2_elasticParticle | b2_colorMixingParticle;\n\n\u3053\u306e\u8fba\u308a\u306e\u8aac\u660e\u306f\u672c\u5bb6\u30ac\u30a4\u30c9\u306b\u3088\u308a\u8a73\u7d30\u304c\u3042\u308a\u3001\u307e\u305f\u30bf\u30a4\u30d7\u306e\u4e00\u89a7\u306b\u3064\u3044\u3066\u306f\u3053\u3053\u3092\u53c2\u7167\u3055\u308c\u305f\u3057.\n\n\u305d\u306e\u4ed6\u306e\u30c8\u30d4\u30c3\u30af\n\u81ea\u5206\u3067\u306f\u307e\u3060\u5168\u7136\u89e6\u3063\u3066\u306a\u3044\u304c\u3001\u30b2\u30fc\u30e0\u3068\u304b\u4f5c\u308d\u3046\u3068\u3059\u308b\u969b\u306b\u4fbf\u5229\u305d\u3046\u306a\u6a5f\u80fd\u3082LiquidFun\u306b\u3042\u308b\u6a21\u69d8.\n\n\u525b\u4f53\u540c\u58eb\u306b\u675f\u7e1b\u3092\u4e0e\u3048\u308b\u6a5f\u69cb(Joint).\n\u3042\u308b\u9818\u57df\u5185\u306e\u525b\u4f53\u3092\u9ad8\u901f\u691c\u7d22\u3059\u308b\u305f\u3081\u306eAABB\u30af\u30a8\u30ea.\n\u885d\u7a81\u5224\u5b9a\u3068\u885d\u7a81\u6642\u30ea\u30b9\u30ca.\n\n\n\u53c2\u8003\n\u3044\u305a\u308c\u3082\u3001C++\u306e\u30ea\u30d5\u30a1\u30ec\u30f3\u30b9\u306a\u306e\u3067\u3001JavaScript\u3067\u306f\u5c11\u3057\u8aad\u307f\u66ff\u3048\u304c\u5fc5\u8981\u3060\u304c\u3001\u3042\u307e\u308a\u6c17\u306b\u306a\u3089\u306a\u3044\u30ec\u30d9\u30eb.\n\n\u672c\u5bb6\u30d7\u30ed\u30b0\u30e9\u30de\u30ac\u30a4\u30c9 http://google.github.io/liquidfun/Programmers-Guide/html/index.html\n\n\u672c\u5bb6API\u30ea\u30d5\u30a1\u30ec\u30f3\u30b9 http://google.github.io/liquidfun/API-Ref/html/annotated.html\n\n\n\n\u30b3\u30fc\u30c9\n\u3061\u306a\u307f\u306b\u3001\u63cf\u753b\u7cfb\u306bD3.js\u3092\u4f7f\u3063\u3066\u3044\u308b\u304c\u3001\u7279\u306b\u6df1\u3044\u610f\u5473\u304c\u3042\u3063\u3066\u306e\u3053\u3068\u3067\u306f\u306a\u3044\u3002\n\u672c\u5bb6\u306etestbed\u306fWebGL(Three.js)\u3067Renderer\u3092\u5b9f\u88c5\u3057\u3066\u3044\u305f\u304c\u3001\u5168\u304f\u540c\u3058\u65b9\u6cd5\u3067\u5b9f\u88c5\u3057\u3066\u3082\u9762\u767d\u304f\u306a\u3044\u3001\u3068\u3044\u3046\u306e\u3068\u3001D3.js\u306e\u65b9\u304c\u6163\u308c\u3066\u3044\u308b\u3060\u3051\u3067\u3042\u308b\u3002\n\u306a\u306e\u3067\u3001\u52d5\u4f5c\u3055\u305b\u308b\u3068\u304d\u306f\u3001<script src=\"http://d3js.org/d3.v3.min.js\"></script>\u3092\u5fd8\u308c\u305a\u306b\u3002\n'use strict';\n\n//  \u6ce8! \u30b0\u30ed\u30fc\u30d0\u30eb\u5909\u6570\u306bworld\u3068\u3044\u3046\u540d\u524d\u3067b2World\u7528\u5909\u6570\u3092\u7528\u610f\u3057\u3066\u304a\u304b\u306a\u3044\u3068\u843d\u3061\u308b.\nvar world;\nvar boundsNodes = [[-2, 0], [2, 0], [2, 4], [-2, 4]]; //  \u5883\u754c\u5f62\u72b6\nvar floaters = [\n    {nodes:[[-0.1, -0.2],[0.1, -0.2],[0.1, 0.2],[-0.1, 0.2]], pos:[0.5, 2]},\n    {nodes:[[0, 0.2],[0.1732, -0.0866],[-0.1732, -0.0866]], pos:[-1.5, 3]}\n];\nvar pgDefs = [      //  particleGroup\u6bce\u306e\u521d\u671f\u5f62\u72b6\n    {nodes:[[0.5, 0.1], [1.9, 0.1], [1.9, 2.5], [0.5, 1.0]]},\n    {nodes:[[-0.5, 0.1], [-1.9, 0.1], [-1.9, 2.5], [-0.5, 1.0]]}\n];\nvar timeStep = 1.0 / 60.0, velocityIterations = 8, positionIterations = 3;\n\nvar liquidFunWorld = {\n\n    init: function() {\n        var gravity = new b2Vec2(0, -10);\n        var boundsBody, boxShape;\n        var psd, particleSystem;\n\n        // \u74b0\u5883\u5b9a\u7fa9\n        world = new b2World(gravity);\n\n        // \u525b\u4f53(static) \u95a2\u9023\n        boundsBody= world.CreateBody(new b2BodyDef());\n        boxShape = new b2ChainShape();\n        boxShape.vertices = boundsNodes.map(function(node){\n            return new b2Vec2(node[0], node[1]);\n        });\n        boxShape.CreateLoop();\n        boundsBody.CreateFixtureFromShape(boxShape, 0);\n\n        // \u525b\u4f53(dyanmic)\u95a2\u9023\u3053\u3053\u304b\u3089\n        floaters.forEach(function(floaterDef){\n            var dynamicBodyDef = new b2BodyDef(), body, shape;\n            dynamicBodyDef.type = b2_dynamicBody;\n            body = world.CreateBody(dynamicBodyDef);\n            shape = new b2ChainShape();\n            shape.vertices = floaterDef.nodes.map(function(node){\n                return new b2Vec2(node[0], node[1]);\n            });\n            shape.CreateLoop();\n            body.CreateFixtureFromShape(shape, 1);\n            body.SetTransform(new b2Vec2(floaterDef.pos[0], floaterDef.pos[1]), 0);\n            // \u8cea\u91cf\u5b9a\u7fa9\n            body.SetMassData(new b2MassData(0.1, new b2Vec2(0, 0), 0.03));\n        });\n\n        // Particle \u30e2\u30b8\u30e5\u30fc\u30eb\u95a2\u9023\u3053\u3053\u304b\u3089\n        psd = new b2ParticleSystemDef();\n        psd.radius = 0.05;               // \u7c92\u5b50\u534a\u5f84\n        psd.dampingStrength = 0.1; // \u6e1b\u8870\u306e\u5f37\u3055\n\n        particleSystem = world.CreateParticleSystem(psd);\n\n        pgDefs.forEach(function(def){\n            var shape = new b2PolygonShape(), pd = new b2ParticleGroupDef();\n            shape.vertices = def.nodes.map(function(node){\n                return new b2Vec2(node[0], node[1]);\n            });\n            pd.shape = shape;\n            particleSystem.CreateParticleGroup(pd);\n        });\n\n    },\n    update: function(){\n        world.Step(timeStep, velocityIterations, positionIterations);\n    }\n};\n\nvar init = function(){\n    liquidFunWorld.init();\n    d3Renderer.init();\n    window.onresize = d3Renderer.resize;\n    render();\n};\n\nvar render = function(){\n    liquidFunWorld.update();\n    d3Renderer.render(world);\n    window.requestAnimationFrame(render);\n};\n\nvar d3Renderer = {\n    init: function(){\n        var viz = d3.select('body').append('svg').attr('id', 'viz').append('g').classed('world', true);\n        d3Renderer.resize();\n    },\n    render: function(world){\n        var viz = d3.select('svg#viz g.world');\n        d3Renderer.drawBodies(viz, world.bodies);\n        d3Renderer.drawParicles(viz, world.particleSystems[0]);\n    },\n    drawBodies: function(selection, bodies){ // \u525b\u4f53\u63cf\u753b\u7528\n        var bounds = d3.svg.line().x(function(vec){return vec.x;}).y(function(vec){return vec.y;});\n        var bodyGroups = selection.selectAll('g.body').data(bodies, function(b){\n            return b.ptr;\n        });\n        bodyGroups.enter().append('g').classed('body', true).attr('fill', 'none').attr('stroke', 'black').attr('stroke-width', 0.01);\n        bodyGroups.each(function(b){\n            d3.select(this).selectAll('path').data(b.fixtures).enter().append('path').attr('d', function(fixture){\n                return bounds(fixture.shape.vertices);\n            });\n        });\n        bodyGroups.attr('transform', function(b){\n            var pos = b.GetPosition(), angle = b.GetAngle() * 180 / Math.PI;\n            return 'translate(' + pos.x + ', ' + pos.y + '), rotate(' + angle + ')';\n        });\n        bodyGroups.exit().remove();\n    },\n    drawParicles: function(selection, system){ // \u6d41\u4f53\u7c92\u5b50\u63cf\u753b\u7528\n        var particleGroup = selection.selectAll('g.particle').data(system.particleGroups)\n        var positionBuf = system.GetPositionBuffer();\n        particleGroup.enter().append('g').classed('particle', true).attr('fill', function(d, i){\n            return d3.hsl((i * 77 + 200) % 360, 0.8, 0.8);\n        });\n        particleGroup.each(function(pg){\n            var dataSet = d3.select(this).selectAll('circle').data(new Array(pg.GetParticleCount()));\n            var offset = pg.GetBufferIndex();\n            dataSet.enter().append('circle').attr('r', system.radius * 0.75);\n            dataSet.attr('cx', function(d, i){\n                return positionBuf[(i + offset) * 2];\n            }).attr('cy', function(d, i){\n                return positionBuf[(i + offset) * 2 + 1];\n            });\n            dataSet.exit().remove();\n        });\n        particleGroup.exit().remove();\n    },\n    resize: function(){\n        var w = window.innerWidth, h = window.innerHeight;\n        var scale = (w < h ? w : h) * 0.23;\n        var viz = d3.select('svg#viz');\n        viz.style('width', '100%').style('height', h + 'px');\n        var translate = 'translate(' + (w/2) + ', ' + (h/2 + scale*2) + ')';\n        var scale = 'scale(' + scale + ', ' + (-scale) + ')';\n        viz.select('g').attr('transform', [translate, scale].join());\n    }\n};\n\nwindow.onload = init;\n\n## LiquidFun\u3063\u3066\uff1f\n\n[LiquidFun](http://google.github.io/liquidfun/)\u306fGoogle\u304c\u958b\u767a\u3057\u3066\u3044\u308b2\u6b21\u5143\u6d41\u4f53\u6f14\u7b97\u30a8\u30f3\u30b8\u30f3.\nC++\u3067\u958b\u767a\u3055\u308c\u3066\u3044\u308b\u304c\u3001Emscripten\u3067\u306e\u5909\u63db\u306b\u3088\u308a\u3001JavaScript\u3067\u3082\u5229\u7528\u53ef\u80fd\u3067\u3042\u308b\u3002\n(\u4f3c\u305f\u3088\u3046\u306a\u8a71\u304c3\u6b21\u5143\u7269\u7406\u6f14\u7b97\u30a8\u30f3\u30b8\u30f3\u306eBullet\u3068ammo.js\u304c\u3042\u308a\u307e\u3059\u306d\u3002ammo.js\u306f\u30dd\u30fc\u30c6\u30a3\u30f3\u30b0\u65b9\u6cd5\u3092Emascripten\u304b\u3089\u898b\u76f4\u3059\u3089\u3057\u3044\u3067\u3059\u304c...)\n\n## LiquidFun.js\u3092\u89e6\u3063\u3066\u307f\u3088\u3046\n\n\u3055\u3066\u3001\u3053\u3053\u304b\u3089\u304c\u672c\u984c.\n\nhttp://google.github.io/liquidfun/ \u306b\u3082liquidfun.js\u306e\u30c7\u30e2(testbed)\u304c\u57cb\u3081\u8fbc\u307e\u308c\u3066\u3044\u308b\u304c\u3001\u81ea\u5206\u306e\u304a\u52c9\u5f37\u3082\u304b\u306d\u3066\u3001\u30b5\u30f3\u30d7\u30eb\u30b3\u30fc\u30c9\u3092\u30ac\u30ea\u30ac\u30ea\u3068\u4f5c\u6210\u3057\u305f\u306e\u3067\u3001\u5b66\u3093\u3060\u3053\u3068\u3092\u66f8\u304d\u9023\u306d\u3066\u307f\u308b.\n\n### \u4f5c\u6210\u3057\u305f\u30d6\u30c4\n\n![first_liquidfun.png](https://qiita-image-store.s3.amazonaws.com/0/8808/cfb463a6-b05b-404e-748f-f1b2888bcd0b.png)\n\n\u6b63\u4e09\u89d2\u5f62\u30fb\u9577\u65b9\u5f62\u306e\u525b\u4f53\u3092\u6db2\u4f53(\u7d2b\u8272\u3068\u9752\u8272\u306e\u30c4\u30d6\u30c4\u30d6\u90e8\u5206)\u306b\u3080\u3051\u3066\u843d\u4e0b\u3055\u305b\u308b\u3060\u3051\u306e\u30b5\u30f3\u30d7\u30eb\u3067\u3042\u308b([jsfiddle\u3067\u52d5\u4f5c\u78ba\u8a8d\u3067\u304d\u307e\u3059](http://jsfiddle.net/Quramy/291f2vzr/embedded/result/)).\n\n\u30b3\u30fc\u30c9\u306f\u5c11\u3057\u9577\u3044\u306e\u3067\u3001\u672b\u5c3e\u306b\u4ed8\u8a18\u3002\n\n#### LiquidFun.js\u672c\u4f53\u306e\u53d6\u5f97\nhttps://github.com/google/liquidfun/releases/ \u304b\u3089\u6700\u65b0\u7248\u306ezip\u306a\u308a\u3092DL\u30fb\u5c55\u958b\u3059\u308b\u3068\u3001`liquidfun/Box2D/lfjs/liquidfun.js` \u306b.js\u30d5\u30a1\u30a4\u30eb\u304c\u3042\u308b.\n\nliquidfun.js\u4ee5\u5916\u306b\u3082\u540c\u30d5\u30a9\u30eb\u30c0\u306b.js\u30d5\u30a1\u30a4\u30eb\u304c\u3042\u308b\u304c\u3001\u7121\u8996\u3057\u3066\u3088\u3044\u3063\u307d\u3044.\n\n\n### \u5168\u4f53\u306e\u6d41\u308c\n\u4ed6\u306e\u30b7\u30df\u30e5\u30ec\u30fc\u30bf\u3068\u540c\u69d8\u3001LifuidFun\u5229\u7528\u6642\u306e\u5927\u307e\u304b\u306a\u6d41\u308c\u306f\u4e0b\u8a18\u3002\n\n1. \u521d\u671f\u5316\n + \u74b0\u5883(=`b2World`)\u306e\u5b9a\u7fa9\n1. \u30b7\u30df\u30e5\u30ec\u30fc\u30b7\u30e7\u30f3\u5bfe\u8c61\u7269\u4f53\u914d\u7f6e\n + \u525b\u4f53(=`b2Body`)\u306e\u5b9a\u7fa9, \u74b0\u5883\u3078\u306e\u525b\u4f53\u8ffd\u52a0\n + \u6d41\u4f53(=`b2ParticleGroup`)\u306e\u5b9a\u7fa9, \u74b0\u5883\u3078\u306e\u6d41\u4f53\u8ffd\u52a0\n1. \u30eb\u30fc\u30d7\n + \u74b0\u5883\u306e\u66f4\u65b0\n + \u74b0\u5883\u304b\u3089\u525b\u4f53\u3084\u6d41\u4f53\u60c5\u5831\u3092\u53d6\u5f97\u3001\u63cf\u753b\n\nLiquidFun\u81ea\u4f53\u306b\u306f\u3001\u63cf\u753b\u7cfb\u306e\u6a5f\u69cb\u306f\u4e00\u5207\u542b\u307e\u308c\u3066\u3044\u306a\u3044\u306e\u3067\u3001\n\n+ \u74b0\u5883\u5185\u5f62\u72b6\u306e\u5ea7\u6a19\u3084\u89d2\u5ea6\u3001\u5927\u304d\u3055\u7b49\u306e\u5f62\u72b6\u60c5\u5831\u53d6\u5f97\u307e\u3067\u3092LiquidFun.\n+ \u53d6\u5f97\u3057\u305f\u60c5\u5831\u306e\u51fa\u529b(\u63cf\u753b)\u306f\u5225\u9014\u63cf\u753b\u7cfb\u306e\u30d7\u30ed\u30b0\u30e9\u30e0\u304c\u5fc5\u8981(WebGL\u30e9\u30a4\u30d6\u30e9\u30ea\u3084Canbas, SVG\u7b49)\n\n\u30ac\u30a4\u30c9\u3092\u8aad\u3080\u9650\u308a\u306f\u3001OpenGL\u3092\u610f\u8b58\u3057\u305f\u4f5c\u308a\u306b\u306a\u3063\u3066\u3044\u308b\u305f\u3081\u3001\u30af\u30e9\u30a4\u30a2\u30f3\u30c8JavaScript\u3067\u3042\u308c\u3070\u3001Three.js\u306a\u3069WebGL\u306e\u30e9\u30a4\u30d6\u30e9\u30ea\u3092\u4f7f\u3046\u306e\u304c\u771f\u3063\u5f53\u304b. \n\n### \u74b0\u5883\n\n#### \u74b0\u5883\u306e\u5b9a\u7fa9\n\n\u4f55\u306f\u3068\u3082\u3042\u308c\u3001\u74b0\u5883\u5b9a\u7fa9\u3057\u306a\u3044\u3068\u59cb\u307e\u3089\u306a\u3044\u3002\n\n```js\nvar gravity = new b2Vec2(0, -10);\nvar world = new b2World(gravity);\n```\n\n\u3068\u3044\u3063\u3066\u3082\u3001\u91cd\u529b\u306e\u5411\u304d\u3068\u5f37\u3055\u3092\u6307\u5b9a\u3057\u305f\u4e0a\u3067\u3001`b2Wolrd`\u306e\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u3092\u4f5c\u6210\u3059\u308b\u3060\u3051\u3002\n\n\u4f46\u3057\u3001\u4e00\u70b9\u6ce8\u610f\u304c\u3042\u308b.\n`b2World` \u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306f\u3001\u7d76\u5bfe\u306b`world`\u306e\u540d\u524d\u3067\u30b0\u30ed\u30fc\u30d0\u30eb\u5909\u6570\u5ba3\u8a00\u3059\u308b\u3053\u3068.\n\u4ed6\u306e\u5909\u6570\u540d\u306b\u3057\u305f\u308a\u3001\u30b0\u30ed\u30fc\u30d0\u30eb\u304b\u3089\u53c2\u7167\u51fa\u6765\u306a\u3044\u30b9\u30b3\u30fc\u30d7\u306b\u5165\u308c\u308b\u3068\u3001\u5f8c\u8ff0\u306e`CreateFixtureFromShape()`\u30e1\u30bd\u30c3\u30c9\u3067`ReferenceError`\u304c\u30b9\u30ed\u30fc\u3055\u308c\u308b(\u3069\u3046\u8003\u3048\u3066\u3082\u53ea\u306e\u30d0\u30b0\u3060\u308d\u3046\u304c...).\n\n\n#### \u74b0\u5883\u306e\u66f4\u65b0\n\n\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u30eb\u30fc\u30d7\u51e6\u7406\u306e\u4e2d\u3067\u3001\u30b7\u30df\u30e5\u30ec\u30fc\u30b7\u30e7\u30f3\u72b6\u614b\u3092\u66f4\u65b0\u3057\u3066\u3044\u304f\u305f\u3081\u306b\u547c\u3073\u51fa\u3059\u51e6\u7406\u3002\n\u30d6\u30e9\u30a6\u30b6\u306a\u3089\u3001`window.requestAnimationFrame`\u3068\u7d44\u307f\u5408\u308f\u305b\u308b\u3053\u3068\u304c\u591a\u3044\u306f\u305a\u3002\n\n```js\nfunction render(){\n  world.Step(1.0/60.0, 8, 3);\n  requiestAnimationFrame(render);\n}\n```\n\n`Step()`\u30e1\u30bd\u30c3\u30c9\u306e\u5f15\u6570\u306f\u3001\u300c\u6642\u523b\u5dee\u5206\u300d\u3001\u300c\u901f\u5ea6\u6c7a\u5b9a\u306e\u30a4\u30c6\u30ec\u30fc\u30b7\u30e7\u30f3\u56de\u6570\u300d, \u300c\u4f4d\u7f6e\u6c7a\u5b9a\u306e\u30a4\u30c6\u30ec\u30fc\u30b7\u30e7\u30f3\u56de\u6570\u300d\u3067\u3042\u308b.\n\u7b2c2, \u7b2c3\u5f15\u6570\u306e\u30a4\u30c6\u30ec\u30fc\u30b7\u30e7\u30f3\u56de\u6570\u306b\u3064\u3044\u3066\u306f\u3001\u5927\u304d\u304f\u3059\u308c\u3070\u7cbe\u5ea6\u304c\u4e0a\u304c\u308b\u304c\u3001\u8a08\u7b97\u6642\u9593\u3082\u305d\u306e\u5206\u4e0a\u304c\u308b\u985e\u306e\u30d1\u30e9\u30e1\u30fc\u30bf\u3002\n\u4e00\u56de\u306e\u30b9\u30c6\u30c3\u30d7\u5185\u306b\u3066\u3001\u500b\u3005\u306e\u7c92\u5b50\u3084\u525b\u4f53\u901f\u5ea6/\u4f4d\u7f6e\u306e\u6c7a\u5b9a\u306b\u4f55\u56de\u306e\u30a4\u30c6\u30ec\u30fc\u30b7\u30e7\u30f3\u3092\u884c\u3046\u304b\u3001\u3092\u610f\u5473\u3057\u3066\u3044\u308b\u3002\n\n[\u672c\u5bb6\u306e\u958b\u767a\u30ac\u30a4\u30c9](http://google.github.io/liquidfun/Programmers-Guide/html/md__chapter10__world.html)\u306b\u3088\u308b\u3068\u3001\u30a4\u30c6\u30ec\u30fc\u30b7\u30e7\u30f3\u56de\u6570\u306f\u7b2c1\u5f15\u6570\u3068\u306e\u30c8\u30ec\u30fc\u30c9\u30aa\u30d5\u3082\u3042\u308b\u3002\n30FPS\u306720\u56de\u30a4\u30c6\u30ec\u30fc\u30b7\u30e7\u30f3\u3059\u308b\u3088\u308a\u3082\u300160FPS\u306710\u56de\u30a4\u30c6\u30ec\u30fc\u30b7\u30e7\u30f3\u3057\u305f\u65b9\u304c\u826f\u3044\u3001\u3068\u306e\u3053\u3068\u3002\n\n### \u525b\u4f53\n\u300c\u525b\u4f53\u300d\u306f\u5f62\u72b6\u304c\u5909\u5316\u3057\u306a\u3044\u7269\u4f53\u306e\u3053\u3068.\n\u4eca\u56de\u306e\u30b5\u30f3\u30d7\u30eb\u3067\u306f\u3001\u300c\u5168\u4f53\u306e\u5883\u754c\u3068\u306a\u3063\u3066\u3044\u308b\u7bb1\u300d\u3001\u300c\u843d\u4e0b\u3057\u3066\u304f\u308b\u591a\u89d2\u5f62\u300d\u304c\u525b\u4f53.\n\n#### \u525b\u4f53\u306e\u4f5c\u6210\nLiquidFun\u3067\u306f\u525b\u4f53\u306e\u7a2e\u985e\u306f\u5e7e\u3064\u304b\u7528\u610f\u3055\u308c\u3066\u3044\u3066\u3001 `b2BodyDef.prototype.type`\u3067\u6307\u5b9a\u3059\u308b\u3002\n\n+ `b2_staticBody`  \n\u9759\u7684\u525b\u4f53. \u660e\u793a\u7684\u306b\u30dd\u30b8\u30b7\u30e7\u30f3\u3092\u5909\u66f4\u3057\u306a\u3044\u9650\u308a\u52d5\u304b\u306a\u3044. \u30c7\u30d5\u30a9\u30eb\u30c8.\n+ `b2_kinematicBody `    \n\u81ea\u8eab\u306e\u901f\u5ea6\u306b\u3088\u308a\u3001\u79fb\u52d5\u3059\u308b\u525b\u4f53. \u91cd\u529b\u5f71\u97ff\u3084\u885d\u7a81\u5224\u5b9a\u306f\u8a08\u7b97\u3055\u308c\u306a\u3044.\n+ \u52d5\u7684(`b2_dynamicBody`)  \n\u30d5\u30eb\u30b7\u30df\u30e5\u30ec\u30fc\u30b7\u30e7\u30f3. \u91cd\u529b\u5f71\u97ff\u3084\u525b\u4f53\u9593\u306e\u885d\u7a81\u5224\u5b9a, \u6d41\u4f53 - \u525b\u4f53\u6319\u52d5\u306e\u5168\u3066\u304c\u8a08\u7b97\u3055\u308c\u308b.\n\n```js\nvar bodyDef = new b2BodyDef();\nbodyDef.type = b2_dynamicBody;\n\nvar body = world.CreateBode(bodyDef);\n```\n\n`b2World.prptotype.CreateBody`\u306b`bodyDef`\u3092\u55b0\u308f\u305b\u308b\u3053\u3068\u3067\u3001\u525b\u4f53\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u304c\u4f5c\u6210\u3067\u304d\u308b\u3002\n\n#### \u525b\u4f53\u5f62\u72b6\n\u525b\u4f53\u306e\u5f62\u72b6\u3092\u6c7a\u5b9a\u3059\u308b\u306b\u306f\u3001\u5e7e\u3064\u304b\u65b9\u6cd5\u304c\u3042\u308a\u305d\u3046\u3060\u3051\u3069\u3001\u5f62\u72b6\u3092\u4f5c\u6210\u2192\u5f62\u72b6\u3092Fixture\u3068\u3057\u3066\u525b\u4f53\u306b\u30bb\u30c3\u30c8\u3001\u306e\u307f\u628a\u63e1\u3002\n\nLiquidFun\u306b\u304a\u3044\u3066\u3001\u300c\u5f62\u72b6\u300d\u306f`b2****Shape`\u3068\u3044\u3046\u540d\u524d\u306e\u30b3\u30f3\u30b9\u30c8\u30e9\u30af\u30bf\u3067\u7528\u610f\u3055\u308c\u3066\u3044\u308b(`b2CircleShape`(\u5186)\u3068\u304b`b2ChainShape`(\u30dd\u30ea\u30b4\u30f3)\u3068\u304b).\n\u5f62\u72b6\u7a2e\u985e\u6bce\u306b\u5f62\u72b6\u5b9a\u7fa9\u65b9\u6cd5\u306f\u7570\u306a\u308b\u304c\u3001\u5f62\u72b6\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u3092\u4f5c\u3063\u3066\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306b`b2Body`\u306b\u55b0\u308f\u305b\u308c\u3070\u3088\u3044\u3002\n\n```js\nbody.CreateFixtureFromShape(shape, 0.5);\n```\n\n\u306a\u304a\u3001\u7b2c\u4e8c\u5f15\u6570\u306f\u5bc6\u5ea6\u30d1\u30e9\u30e1\u30fc\u30bf\u3068\u306e\u3053\u3068\u3002\n\n\u525b\u4f53\u5f62\u72b6\u306b\u306f`world.bodies[3].fixtures[0].shape`\u306e\u3088\u3046\u306b\u3001`fixtures`\u7d4c\u7531\u3067\u30a2\u30af\u30bb\u30b9\u51fa\u6765\u308b\u3002\n\n#### \u525b\u4f53\u306e\u8cea\u91cf\n\n\u525b\u4f53\u306b\u306f\u3001\u8cea\u91cf\u60c5\u5831\u3092\u8a2d\u5b9a\u3067\u304d\u308b\u3002\n\n```js\nvar massData = new b2MassData(1.2, new b2Vec(0, 0), 0.3);\nbody.SetMassData(massData);\n```\n\n`b2MassData`\u306e\u30b3\u30f3\u30b9\u30c8\u30e9\u30af\u30bf\u5f15\u6570\u306f\u3001\u9806\u306b\u8cea\u91cf(\u30b9\u30ab\u30e9)\u3001\u525b\u4f53\u306e\u91cd\u5fc3\u5ea7\u6a19\u30d9\u30af\u30c8\u30eb\u3001\u6163\u6027\u30e2\u30fc\u30e1\u30f3\u30c8\u5024\u3067\u3042\u308b\u3002\n\n\u6163\u6027\u30e2\u30fc\u30e1\u30f3\u30c8\u5024\u306e\u30c7\u30d5\u30a9\u30eb\u30c8\u5024\u306f0\u3067\u3042\u308b\u304c\u3001\u3053\u308c\u306f\u300c\u3053\u306e\u525b\u4f53\u306f\u4e00\u5207\u56de\u8ee2\u3057\u307e\u305b\u3093\u300d\u3068\u3044\u3046\u610f\u5473.\n\n#### \u525b\u4f53\u306e\u4f4d\u7f6e\u60c5\u5831\n`b2Body`\u306e\u30e1\u30f3\u30d0\u95a2\u6570\u3001`GetPosition()`, `GetAngle()`\u3067\u4f4d\u7f6e\u5ea7\u6a19\u3001\u50be\u659c\u89d2(\u30e9\u30b8\u30a2\u30f3)\u304c\u53d6\u5f97\u3067\u304d\u308b(\u89d2\u5ea6\u60c5\u5831\u306f`GetRotate()`\u3067\u3001cos, sin\u306e\u5024\u3092\u76f4\u306b\u53d6\u5f97\u3059\u308b\u3053\u3068\u3082\u3067\u304d\u308b. \u56de\u8ee2\u884c\u5217\u304c\u6b32\u3057\u3044\u3068\u304d\u306f\u3053\u3063\u3061\u304c\u4fbf\u5229).\n\n\u4f4d\u7f6e\u3092\u6307\u5b9a\u3059\u308b\u5834\u5408\u306f\u3001`b2Body.prototype.SetPosition()`\u3092\u53e9\u3051\u3070\u826f\u3044\u3002\u5f15\u6570\u306f\u5ea7\u6a19\u30d9\u30af\u30c8\u30eb\u3068\u56de\u8ee2\u89d2\u3067\u3042\u308b\u3002\n\n### \u6d41\u4f53\n\u3055\u3066\u3001LiquidFun\u3068\u3044\u3046\u3060\u3051\u3042\u3063\u3066\u3001\u6d41\u4f53\u306f\u3053\u306e\u30e9\u30a4\u30d6\u30e9\u30ea\u306e\u5927\u304d\u306a\u7279\u5fb4\u3060.\n\u300c\u6d41\u4f53\u300d\u3068\u3044\u3063\u3066\u3044\u308b\u304c\u3001\u30a4\u30e1\u30fc\u30b8\u306f\u5fae\u5c0f\u7c92\u5b50\u306e\u96c6\u5408\u4f53\u3060.\n\nLiquidFun\u3067\u306f\u3001\u3053\u306e\u300c\u5fae\u5c0f\u7c92\u5b50\u306e\u96c6\u5408\u4f53\u300d\u3092 `b2ParticleSystem` \u306a\u308b\u30af\u30e9\u30b9\u3067\u7ba1\u7406\u3059\u308b.\n\n#### \u6d41\u4f53\u306e\u4f5c\u6210\n\n\u525b\u4f53\u3068\u540c\u69d8\u3001\u6d41\u4f53\u306e\u5834\u5408\u3082\u5b9a\u7fa9\u4f53\u304c\u5b58\u5728\u3059\u308b. `b2ParticleSystemDef`\u3060.\n\u4e0b\u8a18\u306e\u3088\u3046\u306b\u4f7f\u3046.\n\n```js\nvar psdef = new b2ParticleSystemDef(), ps;\npsdef.radius = 0.01;\npsdef.dampingStrength = 0.1;\n\nps = world.CreateParticleSystem(psdef);\n```\n\n\u4e0a\u8a18\u306f\u3001\u7c92\u5b50\u534a\u5f840.02, \u6e1b\u8870\u5ea6\u5408\u30440.1\u306e\u6d41\u4f53\u3092\u8868\u3059.\n\u4ed6\u306b\u3082\u3001`psdef.density`\u306f\u6d41\u4f53\u306e\u5bc6\u5ea6\u3067\u3042\u3063\u305f\u308a\u3068\u3001\u6d41\u4f53\u306e\u7269\u7406\u30d1\u30e9\u30e1\u30fc\u30bf\u304c\u5b58\u5728\u3059\u308b([\u4e00\u89a7\u306f\u672c\u5bb6API\u30ea\u30d5\u30a1\u30ec\u30f3\u30b9\u306b\u3066](http://google.github.io/liquidfun/API-Ref/html/structb2_particle_system_def.html)).\n\n#### \u6d41\u4f53\u3078\u306e\u7c92\u5b50\u914d\u7f6e\n`b2ParticleSystem`\u306f\u4f5c\u6210\u3057\u305f\u3060\u3051\u3067\u306f\u3001\u7a7a\u3063\u307d\u306a\u306e\u3067\u3001\u7c92\u5b50\u3092\u8ffd\u52a0\u3057\u3066\u3044\u304f\u5fc5\u8981\u304c\u3042\u308b.\n2\u901a\u308a\u306e\u65b9\u6cd5\u304c\u3042\u308b\u306e\u3060\u304c\u3001\u3053\u3053\u3067\u306f`b2ParticleGroup`\u3092\u5229\u7528\u3059\u308b\u65b9\u6cd5\u3092\u8a18\u8f09\u3059\u308b.\n\n```js\nvar pgdef = new b2ParticleGroupDef(), shape;\n\nshape = new b2CircleShape();\nshape.radius = 1.0;\npgdef.shape = shape;\npgdef.position = new b2Vec(3.0, 2.0);\n\nps.CreateParticleGroup(pgdef);\n```\n\n\u3053\u308c\u306f\u3001\u300c\u4e2d\u5fc3\u5ea7\u6a19(3.0, 2.0)\u306b\u534a\u5f841.0\u306e\u5186\u5f62\u72b6\u300d\u306e\u4e2d\u306b\u307f\u3063\u3061\u308a\u7c92\u5b50\u304c\u3064\u307e\u3063\u3066\u3044\u308b\u72b6\u614b\u3092\u521d\u671f\u5f62\u72b6\u3068\u3057\u305f\u7c92\u5b50\u7fa4\u3092\u4f5c\u6210\u3059\u308b\u3001\u3068\u3044\u3046\u4f8b\u3067\u3042\u308b\u3002\n\n\u3053\u3053\u3067\u3001\u6ce8\u610f\u304c\u5fc5\u8981\u306a\u306e\u306f\u3001\u7c92\u5b50\u6570\u306f`ps.radius`\u306e\u5024\u3068`shape`\u306e\u5f62\u72b6\u304b\u3089\u9006\u7b97\u3055\u308c\u3066\u81ea\u52d5\u3067\u6c7a\u5b9a\u3055\u308c\u308b\u70b9\u3067\u3042\u308b.\n\u3082\u3061\u308d\u3093\u3001\u7c92\u5b50\u6570\u304c\u591a\u3044(=\u534a\u5f84\u304c\u5c0f\u3055\u3044)\u65b9\u304c\u9ad8\u7cbe\u5ea6\u3060\u304c\u3001\u5f53\u7136\u3001\u305d\u306e\u5206\u306e\u8a08\u7b97\u30b3\u30b9\u30c8\u304c\u3064\u3044\u3066\u304f\u308b\u3053\u3068\u306b\u306a\u308b.\n\n#### \u6d41\u4f53\u7c92\u5b50\u306e\u4f4d\u7f6e\u53d6\u5f97\n\u5404\u7c92\u5b50\u306e\u5ea7\u6a19\u4f4d\u7f6e\u3092\u53d6\u5f97\u3059\u308b\u306b\u306f\u3001`b2ParticleSystem.prototype.GetPositionBuffer()`\u3067\u53d6\u5f97\u3055\u308c\u308b`Float32Array`\u914d\u5217\u3092\u7528\u3044\u308b.\n\u3053\u306e\u914d\u5217\u306f\u3001\u4e0b\u8a18\u306e\u69cb\u9020\u3067\u7c92\u5b50\u306e(x, y)\u5ea7\u6a19\u304c\u30da\u30a2\u306e\u5f62\u3067\u4fdd\u5b58\u3055\u308c\u3066\u3044\u308b.\n\n    [x0, y0, x1, y1, x2, y2, x3, y3,...]\n\n\u3057\u305f\u304c\u3063\u3066\u3001\u7c92\u5b50\u3092\u63cf\u753b\u3059\u308b\u985e\u306e\u51e6\u7406\u30a4\u30e1\u30fc\u30b8\u306f\u6b21\u306e\u3088\u3046\u306b\u306a\u308b.\n\n```js\nvar ps = world.particleSystems[0], buf = ps.GetPositionBuffer(), count = buf.length;\n\nfor(var i = 0; i < count; i = i + 2){\n  console.log('x, y:', buf[i], buf[i+1]);\n}\n```\n\n`b2ParticleSystem`\u306b\u8907\u6570\u306e`b2ParticleGroup`\u3092\u30bb\u30c3\u30c8\u3057\u3066\u3044\u308b\u5834\u5408\u306b\u30012\u756a\u76ee\u306e\u30b0\u30eb\u30fc\u30d7\u60c5\u5831\u306e\u307f\u306e\u7c92\u5b50\u306b\u5bfe\u3059\u308b\u30eb\u30fc\u30d7\u3092\u884c\u3044\u305f\u3051\u308c\u3070\u3001\u6b21\u306e\u3088\u3046\u306b\u3059\u308c\u3070\u3088\u3044.\n\n```js\nvar ps = world.particleSystem[0], pg = ps.particleGroups[1];\n\nvar offset = pg.GetPositionIndex();\nvar length = pg.GetParticleCount();\n\nfor(var i = offset * 2; i < (offset + length) * 2; i = i + 2){\n  console.log('x, y:', buf[i], buf[i+1]);\n}\n```\n\n#### \u6d41\u4f53\u7c92\u5b50\u306e\u632f\u308b\u821e\u3044\n\nLiquidFun\u3067\u306f\u6db2\u4f53\u3060\u3051\u3067\u306a\u304f\u3001\u7802\u5875\u306e\u3088\u3046\u306a\u30d1\u30a6\u30c0\u30fc\u3084\u30b0\u30cb\u30e3\u30c3\u3068\u3057\u305f\u8edf\u4f53\u7b49\u3001\u8272\u3005\u306a\u632f\u308b\u821e\u3044\u3092`b2ParticleSystem`\u3067\u30b7\u30df\u30e5\u30ec\u30fc\u30b7\u30e7\u30f3\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u308b.\n\n\u7c92\u5b50\u306e\u6319\u52d5\u306f\u3001`b2ParicleGroupDef`(`b2ParticleDef`\u3067\u3082\u53ef)\u306e`flags`\u3068\u3044\u3046\u5c5e\u6027\u3067\u6307\u5b9a\u3059\u308b\u3053\u3068\u304c\u51fa\u6765\u308b.\n\u6307\u5b9a\u53ef\u80fd\u306a\u5024\u306f \"b2_*****Paricle\"\u3068\u3044\u3046\u540d\u524d\u3067\u5b9a\u6570\u5316\u3055\u308c\u3066\u3044\u308b(\u53b3\u5bc6\u306b\u306fC++\u3067\u306f\u5217\u6319\u4f53\u3067\u3042\u3063\u305f\u304c\u3001Emscripten\u306b\u3088\u308a\u53ea\u306e\u5b9a\u6570\u306b\u843d\u3068\u3055\u308c\u3066\u307e\u3059...)\n\n+ `b2_waterParticle`  \n\u6240\u8b02\u6db2\u4f53. \u30c7\u30d5\u30a9\u30eb\u30c8.\n+ `b2_elasticParticle`  \n\u8edf\u4f53. \u30d6\u30e8\u30d6\u30e8\u3068\u3057\u305f\u30b0\u30df\u306e\u3088\u3046\u306a\u7269\u4f53\u3068\u306a\u308b.\n+ `b2_powderParticle`  \n\u7802\u5875\u306e\u3088\u3046\u306a\u7c89\u3063\u307d\u3044\u7c92\u5b50.\n+ `b2_biscousParticle`  \n\u6cb9\u306e\u3088\u3046\u306a\u3001\u7c98\u6027\u306e\u3042\u308b\u6db2\u4f53.\n+ `b2_colorMixingParticle`  \n\u8272\u304c\u6df7\u3056\u3063\u3066\u3044\u304f\u6db2\u4f53. \n\n\u306a\u304a\u3001`|` \u6f14\u7b97\u5b50\u3067\u7d50\u5408\u3059\u308b\u3053\u3068\u3067\u3001\u8907\u6570\u306e\u30bf\u30a4\u30d7\u306e\u7d44\u307f\u5408\u308f\u305b\u6307\u5b9a\u3082\u53ef\u80fd. \n\n```js\npgdef.flags = b2_elasticParticle | b2_colorMixingParticle;\n```\n\n\u3053\u306e\u8fba\u308a\u306e\u8aac\u660e\u306f[\u672c\u5bb6\u30ac\u30a4\u30c9](http://google.github.io/liquidfun/Programmers-Guide/html/md__chapter11__particles.html#pb)\u306b\u3088\u308a\u8a73\u7d30\u304c\u3042\u308a\u3001\u307e\u305f\u30bf\u30a4\u30d7\u306e\u4e00\u89a7\u306b\u3064\u3044\u3066\u306f[\u3053\u3053](http://google.github.io/liquidfun/API-Ref/html/b2_particle_8h.html#a73d3b011893cb87452253b1b67a5cf50)\u3092\u53c2\u7167\u3055\u308c\u305f\u3057.\n\n### \u305d\u306e\u4ed6\u306e\u30c8\u30d4\u30c3\u30af\n\n\u81ea\u5206\u3067\u306f\u307e\u3060\u5168\u7136\u89e6\u3063\u3066\u306a\u3044\u304c\u3001\u30b2\u30fc\u30e0\u3068\u304b\u4f5c\u308d\u3046\u3068\u3059\u308b\u969b\u306b\u4fbf\u5229\u305d\u3046\u306a\u6a5f\u80fd\u3082LiquidFun\u306b\u3042\u308b\u6a21\u69d8.\n\n+ \u525b\u4f53\u540c\u58eb\u306b\u675f\u7e1b\u3092\u4e0e\u3048\u308b\u6a5f\u69cb(Joint).\n+ \u3042\u308b\u9818\u57df\u5185\u306e\u525b\u4f53\u3092\u9ad8\u901f\u691c\u7d22\u3059\u308b\u305f\u3081\u306eAABB\u30af\u30a8\u30ea.\n+ \u885d\u7a81\u5224\u5b9a\u3068\u885d\u7a81\u6642\u30ea\u30b9\u30ca.\n\n\n## \u53c2\u8003\n\n\u3044\u305a\u308c\u3082\u3001C++\u306e\u30ea\u30d5\u30a1\u30ec\u30f3\u30b9\u306a\u306e\u3067\u3001JavaScript\u3067\u306f\u5c11\u3057\u8aad\u307f\u66ff\u3048\u304c\u5fc5\u8981\u3060\u304c\u3001\u3042\u307e\u308a\u6c17\u306b\u306a\u3089\u306a\u3044\u30ec\u30d9\u30eb.\n\n+ \u672c\u5bb6\u30d7\u30ed\u30b0\u30e9\u30de\u30ac\u30a4\u30c9 http://google.github.io/liquidfun/Programmers-Guide/html/index.html\n+ \u672c\u5bb6API\u30ea\u30d5\u30a1\u30ec\u30f3\u30b9 http://google.github.io/liquidfun/API-Ref/html/annotated.html\n\n\n\n## \u30b3\u30fc\u30c9\n\n\u3061\u306a\u307f\u306b\u3001\u63cf\u753b\u7cfb\u306bD3.js\u3092\u4f7f\u3063\u3066\u3044\u308b\u304c\u3001\u7279\u306b\u6df1\u3044\u610f\u5473\u304c\u3042\u3063\u3066\u306e\u3053\u3068\u3067\u306f\u306a\u3044\u3002\n\u672c\u5bb6\u306etestbed\u306fWebGL(Three.js)\u3067Renderer\u3092\u5b9f\u88c5\u3057\u3066\u3044\u305f\u304c\u3001\u5168\u304f\u540c\u3058\u65b9\u6cd5\u3067\u5b9f\u88c5\u3057\u3066\u3082\u9762\u767d\u304f\u306a\u3044\u3001\u3068\u3044\u3046\u306e\u3068\u3001D3.js\u306e\u65b9\u304c\u6163\u308c\u3066\u3044\u308b\u3060\u3051\u3067\u3042\u308b\u3002\n\n\n\u306a\u306e\u3067\u3001\u52d5\u4f5c\u3055\u305b\u308b\u3068\u304d\u306f\u3001`<script src=\"http://d3js.org/d3.v3.min.js\"></script>`\u3092\u5fd8\u308c\u305a\u306b\u3002\n\n```js\n'use strict';\n\n//  \u6ce8! \u30b0\u30ed\u30fc\u30d0\u30eb\u5909\u6570\u306bworld\u3068\u3044\u3046\u540d\u524d\u3067b2World\u7528\u5909\u6570\u3092\u7528\u610f\u3057\u3066\u304a\u304b\u306a\u3044\u3068\u843d\u3061\u308b.\nvar world;\nvar boundsNodes = [[-2, 0], [2, 0], [2, 4], [-2, 4]]; //  \u5883\u754c\u5f62\u72b6\nvar floaters = [\n\t{nodes:[[-0.1, -0.2],[0.1, -0.2],[0.1, 0.2],[-0.1, 0.2]], pos:[0.5, 2]},\n\t{nodes:[[0, 0.2],[0.1732, -0.0866],[-0.1732, -0.0866]], pos:[-1.5, 3]}\n];\nvar pgDefs = [\t\t//  particleGroup\u6bce\u306e\u521d\u671f\u5f62\u72b6\n\t{nodes:[[0.5, 0.1], [1.9, 0.1], [1.9, 2.5], [0.5, 1.0]]},\n\t{nodes:[[-0.5, 0.1], [-1.9, 0.1], [-1.9, 2.5], [-0.5, 1.0]]}\n];\nvar timeStep = 1.0 / 60.0, velocityIterations = 8, positionIterations = 3;\n\nvar liquidFunWorld = {\n\n\tinit: function() {\n\t\tvar gravity = new b2Vec2(0, -10);\n\t\tvar boundsBody, boxShape;\n\t\tvar psd, particleSystem;\n\n\t\t// \u74b0\u5883\u5b9a\u7fa9\n\t\tworld = new b2World(gravity);\n\n\t\t// \u525b\u4f53(static) \u95a2\u9023\n\t\tboundsBody= world.CreateBody(new b2BodyDef());\n\t\tboxShape = new b2ChainShape();\n\t\tboxShape.vertices = boundsNodes.map(function(node){\n\t\t\treturn new b2Vec2(node[0], node[1]);\n\t\t});\n\t\tboxShape.CreateLoop();\n\t\tboundsBody.CreateFixtureFromShape(boxShape, 0);\n\n\t\t// \u525b\u4f53(dyanmic)\u95a2\u9023\u3053\u3053\u304b\u3089\n\t\tfloaters.forEach(function(floaterDef){\n\t\t\tvar dynamicBodyDef = new b2BodyDef(), body, shape;\n\t\t\tdynamicBodyDef.type = b2_dynamicBody;\n\t\t\tbody = world.CreateBody(dynamicBodyDef);\n\t\t\tshape = new b2ChainShape();\n\t\t\tshape.vertices = floaterDef.nodes.map(function(node){\n\t\t\t\treturn new b2Vec2(node[0], node[1]);\n\t\t\t});\n\t\t\tshape.CreateLoop();\n\t\t\tbody.CreateFixtureFromShape(shape, 1);\n\t\t\tbody.SetTransform(new b2Vec2(floaterDef.pos[0], floaterDef.pos[1]), 0);\n\t\t\t// \u8cea\u91cf\u5b9a\u7fa9\n\t\t\tbody.SetMassData(new b2MassData(0.1, new b2Vec2(0, 0), 0.03));\n\t\t});\n\n\t\t// Particle \u30e2\u30b8\u30e5\u30fc\u30eb\u95a2\u9023\u3053\u3053\u304b\u3089\n\t\tpsd = new b2ParticleSystemDef();\n\t\tpsd.radius = 0.05;\t\t\t\t // \u7c92\u5b50\u534a\u5f84\n\t\tpsd.dampingStrength = 0.1; // \u6e1b\u8870\u306e\u5f37\u3055\n\n\t\tparticleSystem = world.CreateParticleSystem(psd);\n\n\t\tpgDefs.forEach(function(def){\n\t\t\tvar shape = new b2PolygonShape(), pd = new b2ParticleGroupDef();\n\t\t\tshape.vertices = def.nodes.map(function(node){\n\t\t\t\treturn new b2Vec2(node[0], node[1]);\n\t\t\t});\n\t\t\tpd.shape = shape;\n\t\t\tparticleSystem.CreateParticleGroup(pd);\n\t\t});\n\n\t},\n\tupdate: function(){\n\t\tworld.Step(timeStep, velocityIterations, positionIterations);\n\t}\n};\n\nvar init = function(){\n\tliquidFunWorld.init();\n\td3Renderer.init();\n\twindow.onresize = d3Renderer.resize;\n\trender();\n};\n\nvar render = function(){\n\tliquidFunWorld.update();\n\td3Renderer.render(world);\n\twindow.requestAnimationFrame(render);\n};\n\nvar d3Renderer = {\n\tinit: function(){\n\t\tvar viz = d3.select('body').append('svg').attr('id', 'viz').append('g').classed('world', true);\n\t\td3Renderer.resize();\n\t},\n\trender: function(world){\n\t\tvar viz = d3.select('svg#viz g.world');\n\t\td3Renderer.drawBodies(viz, world.bodies);\n\t\td3Renderer.drawParicles(viz, world.particleSystems[0]);\n\t},\n\tdrawBodies: function(selection, bodies){ // \u525b\u4f53\u63cf\u753b\u7528\n\t\tvar bounds = d3.svg.line().x(function(vec){return vec.x;}).y(function(vec){return vec.y;});\n\t\tvar bodyGroups = selection.selectAll('g.body').data(bodies, function(b){\n\t\t\treturn b.ptr;\n\t\t});\n\t\tbodyGroups.enter().append('g').classed('body', true).attr('fill', 'none').attr('stroke', 'black').attr('stroke-width', 0.01);\n\t\tbodyGroups.each(function(b){\n\t\t\td3.select(this).selectAll('path').data(b.fixtures).enter().append('path').attr('d', function(fixture){\n\t\t\t\treturn bounds(fixture.shape.vertices);\n\t\t\t});\n\t\t});\n\t\tbodyGroups.attr('transform', function(b){\n\t\t\tvar pos = b.GetPosition(), angle = b.GetAngle() * 180 / Math.PI;\n\t\t\treturn 'translate(' + pos.x + ', ' + pos.y + '), rotate(' + angle + ')';\n\t\t});\n\t\tbodyGroups.exit().remove();\n\t},\n\tdrawParicles: function(selection, system){ // \u6d41\u4f53\u7c92\u5b50\u63cf\u753b\u7528\n\t\tvar particleGroup = selection.selectAll('g.particle').data(system.particleGroups)\n\t\tvar positionBuf = system.GetPositionBuffer();\n\t\tparticleGroup.enter().append('g').classed('particle', true).attr('fill', function(d, i){\n\t\t\treturn d3.hsl((i * 77 + 200) % 360, 0.8, 0.8);\n\t\t});\n\t\tparticleGroup.each(function(pg){\n\t\t\tvar dataSet = d3.select(this).selectAll('circle').data(new Array(pg.GetParticleCount()));\n\t\t\tvar offset = pg.GetBufferIndex();\n\t\t\tdataSet.enter().append('circle').attr('r', system.radius * 0.75);\n\t\t\tdataSet.attr('cx', function(d, i){\n\t\t\t\treturn positionBuf[(i + offset) * 2];\n\t\t\t}).attr('cy', function(d, i){\n\t\t\t\treturn positionBuf[(i + offset) * 2 + 1];\n\t\t\t});\n\t\t\tdataSet.exit().remove();\n\t\t});\n\t\tparticleGroup.exit().remove();\n\t},\n\tresize: function(){\n\t\tvar w = window.innerWidth, h = window.innerHeight;\n\t\tvar scale = (w < h ? w : h) * 0.23;\n\t\tvar viz = d3.select('svg#viz');\n\t\tviz.style('width', '100%').style('height', h + 'px');\n\t\tvar translate = 'translate(' + (w/2) + ', ' + (h/2 + scale*2) + ')';\n\t\tvar scale = 'scale(' + scale + ', ' + (-scale) + ')';\n\t\tviz.select('g').attr('transform', [translate, scale].join());\n\t}\n};\n\nwindow.onload = init;\n```\n"}