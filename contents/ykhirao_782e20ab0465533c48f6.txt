{"context": "\n\n\u6708\u672b\u3063\u3066\u5fd9\u3057\u3044\u3088\u306d\u2026\n\u6708\u672b\u3063\u3066\u5831\u544a\u66f8\u3068\u304b\u3001\u9818\u53ce\u8a3c\u3068\u304b\u2026\u306a\u3093\u304b\u305f\u304f\u3055\u3093\u51fa\u3055\u306a\u304d\u3083\u3044\u3051\u306a\u3044\u3082\u306e\u3042\u308b\u3088\u306d\u3002\u30bb\u30f3\u30d1\u30a4\u304c\u300c\u8ab0\u304b\u4f5c\u3063\u3066\u300d\u3063\u3066\u8a00\u3063\u3066\u305f\u306e\u3092Google apps script\u3067\u4f5c\u6210\u3057\u307e\u3057\u305f\u3002\nGoogle apps script[GAS]\u89e6\u308a\u3060\u3057\u30664\u65e5\u76ee\u304f\u3089\u3044\u3067\u3059\u304c\u3001\u304b\u306a\u308a\u4fbf\u5229\u306a\u306e\u3067\u30a8\u30f3\u30b8\u30cb\u30a2\u4ee5\u5916\u306e\u3082\u3063\u3068\u305f\u304f\u3055\u3093\u306e\u4eba\u306b\u89e6\u308c\u3066\u6b32\u3057\u3044\u306a\u3068\u601d\u3044\u3001\u9023\u65e5\u3067\u3059\u304cGAS\u306e\u5b9f\u7528\u4f8b\u3092\u3042\u3052\u305f\u3044\u3068\u601d\u3044\u307e\u3059\u3002\n\n\u5b8c\u6210\u54c1\n\u6708\u672b\u306e\u55b6\u696d\u65e5\u306bSlack\u6295\u3052\u308b\u3060\u3051\u306e\u30b7\u30f3\u30d7\u30eb\u306a\u5b9f\u88c5\u3067\u3059\u3002\n\u30b3\u30d4\u30da\u3059\u308c\u307010\u5206\u3067\u5b9f\u88c5\u3044\u3051\u308b\u3093\u3058\u3083\u306a\u3044\u304b\u3068\uff01\n\n\n\u5b8c\u6210\u307e\u3067\u306b\u4f7f\u7528\u3059\u308b\u3082\u306e\nGoogle\u30a2\u30ab\u30a6\u30f3\u30c8[Google Apps Script]\nSlack\n\n\u5b8c\u6210\u3057\u305f\u3089\n\u4ee5\u4e0b\u306e2\u3064\u3082\u30b3\u30fc\u30c9\u516c\u958b\u3057\u307e\u3059\n* \u6708\u521d\u3081\u306e\u55b6\u696d\u65e5\u306b\u306a\u306b\u304b\u3092\u3059\u308b\n* \u6708\u59cb\u3081\u306e\u7b2c\u4e00\u91d1\u66dc\u65e5\u306b\u306a\u306b\u304b\u3092\u3059\u308b\n\u3064\u307e\u308a\u3053\u308c\u3092\u5fdc\u7528\u3059\u308c\u3070\u3001\u3044\u3064\u4f55\u6642\u3067\u3082Slack\u3067\u81ea\u52d5\u30c1\u30e3\u30c3\u30c8\u3092\u98db\u3070\u305b\u308b\u3088\u3046\u306b\u306a\u308b\u3002\n\n\u6708\u672b\u7de0\u3081\u2026\uff01\uff01\n\u753b\u50cf\u3042\u308a\u3067\u3069\u3093\u3069\u3093\u3044\u304f\u3088\u301c\u301c\n\nSlack Token\u306e\u53d6\u5f97\n\u3053\u3053\u3092\u53c2\u8003\u306b\u3057\u3066\u307f\u3066\uff01\nhttp://qiita.com/ykhirao/items/0d6b9f4a0cc626884dbb\nxoxp-18127\u3000\u3053\u3093\u306a\u611f\u3058\u306e\u9577\u3044\u6570\u5b57\u3002\nSlack\u6301\u3063\u3066\u306a\u3044\u4eba\u306f\u500b\u4ebaSlack\u306e\u30b9\u30b9\u30e1\u306b\u3057\u305f\u304c\u3063\u3066\u5c0e\u5165\u3092\u3059\u3059\u3081\u307e\u3059\u3002\n\nGAS\u306e\u5c0e\u5165\nGoogle\u30c9\u30e9\u30a4\u30d6\u306b\u30a2\u30af\u30bb\u30b9\nhttps://drive.google.com/drive/my-drive\n\n\u65b0\u898f >> \u305d\u306e\u4ed6 >> \u30a2\u30d7\u30ea\u3092\u8ffd\u52a0\n\u304b\u3089 Google apps script \u3092\u691c\u7d22\u30fb\u8ffd\u52a0\n\n\u305d\u3046\u3059\u308b\u3068\u65b0\u898f >> \u305d\u306e\u4ed6 >> Google apps script\u3092\u62bc\u3057\u3066\u307f\u3066\u304f\u3060\u3055\u3044\u3002\nGAS\u753b\u9762\u306b\u306a\u308b\u3068\u601d\u3044\u307e\u3059\u3002\n\nGAS\u306e\u7de8\u96c6\n\n\u30e1\u30a4\u30f3\u306e\u90e8\u5206\u306b\u3053\u308c\u3092\u8cbc\u308a\u4ed8\u3051\u3066\u307f\u3088\u3046\uff01\n\n/*\n  \u30e1\u30a4\u30f3\u306e\u51e6\u7406\n  setTriggerDay() : \u6700\u7d42\u55b6\u696d\u65e5(0\u6642)\u306b\u6b21\u306e\u51e6\u7406\u3092\u3059\u308b\u547d\u4ee4\u3092\u51fa\u3059\u3002\n  setTriggerHoursLast() : \u6700\u7d42\u55b6\u696d\u65e5\u306e18\u6642\u306b\u6b21\u306e\u547d\u4ee4\u3092\u51fa\u3059\u3002\n  sendSlack() : slack\u306b\u30c7\u30fc\u30bf\u3092\u6295\u3052\u308b\u3002\n\n  \u30b5\u30d6\u7684\u306a\u51e6\u7406\n  deleteTrigger() : \u84c4\u7a4d\u3055\u308c\u3066\u3044\u308b\u547d\u4ee4\u3092\u524a\u9664\u3059\u308b\n  lastBusinessDay() : \u4eca\u6708\u306e\u6700\u7d42\u55b6\u696d\u65e5\u3092\u6c42\u3081\u308b\n  isHoliday() : \u672c\u65e5\u304c[\u65e5\u672c\u306e\u795d\u65e5]\u304b\u3069\u3046\u304b\u30c1\u30a7\u30c3\u30af\u3002\u571f\u65e5\u306f\u66dc\u65e5\u3067\u5224\u5b9a\u3057\u3066\u308b\u30c1\u30a7\u30c3\u30af\n  .getDay()\u3000: Date\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u304b\u3089\u66dc\u65e5\u3092\u6c42\u3081\u308b\u30e1\u30bd\u30c3\u30c9(0:\u65e5, 6:\u571f\u66dc\u65e5)\n*/\n\nfunction setTriggerDay()\n{  \n  var last = lastBusinessDay();\n  ScriptApp.newTrigger(\"setTriggerHoursLast\")\n    .timeBased()\n    .atDate(last.getFullYear(), last.getMonth()+1, last.getDate())\n    .create();\n}\n\nfunction setTriggerHoursLast()\n{\n  deleteTrigger(\"setTriggerHoursLast\");\n  ScriptApp.newTrigger(\"sendSlack\")\n    .timeBased()\n    .after( 18 * 60 * 60 * 1000 )\n    .create();\n}\n\nfunction sendSlack() \n{\n  deleteTrigger(\"sendSlack\");\n  var options = \n  {\n    \"method\" : \"POST\",\n    \"payload\" : \n    {\n      \"token\": \"********************\",\n      \"channel\": \"bot-test\",\n      \"text\": \"\u9818\u53ce\u66f8\u51fa\u3057\u307e\u3057\u305f\u304b\uff1f\u5fd8\u308c\u3066\u306a\u3044\u3088\u306d\u3002\\\uff4ehttp://.../\"\n    }\n  }\n  var url = \"https://slack.com/api/chat.postMessage\"\n  UrlFetchApp.fetch(url, options);\n}\n\nfunction lastBusinessDay() \n{\n  var today = new Date();\n\n  var lastDayOfThisMonth = new Date(today.getFullYear(), today.getMonth()+1, 0);\n  var day; // 0->\u65e5\u66dc\u65e5\n\n  for (var i = 0; i < 30; i++) {\n    day = lastDayOfThisMonth.getDay();\n    if (day == 0 || day == 6 || isHoliday(lastDayOfThisMonth)) {\n      lastDayOfThisMonth = new Date(today.getFullYear(), today.getMonth()+1, -1 * i);\n      continue;\n    }\n  }\n  return lastDayOfThisMonth;\n}\n\nfunction deleteTrigger(name) \n{\n  var triggers = ScriptApp.getProjectTriggers();\n  for(var i=0; i < triggers.length; i++) {\n    if (triggers[i].getHandlerFunction() == name) {\n      ScriptApp.deleteTrigger(triggers[i]);\n    }\n  }\n}\n\nfunction isHoliday(day) \n{\n  var startDate = new Date(day.setHours(0, 0, 0, 0));\n  var endDate = new Date(day.setHours(23, 59, 59));\n  var cal = CalendarApp.getCalendarById(\"ja.japanese#holiday@group.v.calendar.google.com\");\n  var holidays =  cal.getEvents(startDate, endDate);\n  return holidays.length != 0; // \u795d\u65e5\u306a\u3089true\n}\n\n\nsendSlack\u306e\u3053\u3053\u306f\u500b\u4eba\u8a2d\u5b9a\u306b\u5909\u3048\u3066\u304f\u3060\u3055\u3044\uff01\n\n\"token\": \"********************\",\n\"channel\": \"bot-test\",\n\"text\": \"\u9818\u53ce\u66f8\u51fa\u3057\u307e\u3057\u305f\u304b\uff1f\u5fd8\u308c\u3066\u306a\u3044\u3088\u306d\u3002\\\uff4ehttp://.../\"\n\n\nsetTriggerDay()\u306e\u5b9f\u884c\u3068\u53d6\u308a\u6d88\u3057\u3068\u6bce\u6708\u5b9f\u884c\n\u5b9f\u884c >> setTriggerDay\n\u3092\u304a\u3057\u3066\u307f\u3088\u3046\u3002\n\n\u30ea\u30bd\u30fc\u30b9 >> \u73fe\u5728\u306e\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306e\u30c8\u30ea\u30ac\u30fc\n\u3053\u3053\u304b\u3089\u30c8\u30ea\u30ac\u30fc\uff08\u4f55\u6642\u306b\u3042\u308c\u3092\u5b9f\u884c\u3057\u306a\u3055\u3044\uff09\u3092\u78ba\u8a8d\u3067\u304d\u307e\u3059\u3002\n\n\u3053\u3053\u3067 2017/03/21 \u591c\u4e2d\u4e01\u5ea6\u306b setTriggerHoursLast \u304c\u5b9f\u884c\u3055\u308c\u308b\u3088\u3046\u306b\u306a\u3063\u3066\u3044\u305f\u3089\u5927\u4e08\u592b\u3002setTriggerHoursLast\u306f18\u6642\u9593\u5f8c\u306bSlack\u9001\u308a\u306a\u3055\u3044\u3068\u3044\u3046\u547d\u4ee4\u3067\u3059\u3002\n\n\u307e\u305f\u3064\u3044\u3067\u306b\u3053\u306e\u753b\u9762\u3067setTriggerDay\u3092\u6bce\u67081\u65e56\u6642\u304f\u3089\u3044\u306b\u30bb\u30c3\u30c8\u3057\u307e\u3059\u3002\n\n\u305d\u3046\u3059\u308b\u3068\u6bce\u67081\u65e5\u306bsetTriggerDay\u304c\u5b9f\u884c\u3055\u308c\u3066\n-> setTriggerDay :\u6700\u7d42\u65e5\u306b\u6b21\u3092\u5b9f\u884c\n-> setTriggerHoursLast :18\u6642\u306b\u6b21\u3092\u5b9f\u884c\n-> sendSlack :Slack\u3092\u5b9f\u884c\n\u3063\u3066\u611f\u3058\u3067\u6bce\u6708\u3001\u6700\u7d42\u65e5\u30c8\u30ea\u30ac\u30fc\u3092\u4f5c\u6210\u3057\u3066\u304f\u308c\u307e\u3059\u3002\n\nfunction\u3054\u3068\u306b\u898b\u3066\u3044\u304f\n\u7c21\u5358\u306b\u307f\u3066\u3044\u304d\u307e\u3059\u3002\n\nsetTriggerDay\nfunction setTriggerDay()\n{  \n  var last = lastBusinessDay();\n  ScriptApp.newTrigger(\"setTriggerHoursLast\")\n    .timeBased()\n    .atDate(last.getFullYear(), last.getMonth()+1, last.getDate())\n    .create();\n}\n\nlastBusinessDay()\u3067\u55b6\u696d\u65e5\u6700\u7d42\u65e5\u306eDate\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u53d6\u3063\u3066\u304d\u3066\n.atDate(last.getMonth()+1)\u3068\u3057\u3066\u3044\u308b\u3068\u3053\u308d\u306f\u3001\u6708\u306f0\u6708\u59cb\u307e\u308a\u3068\u306a\u3063\u3066\u3044\u308b\u304b\u3089\u3067\u3059\u3002\n\nsetTriggerHoursLast\nfunction setTriggerHoursLast()\n{\n  deleteTrigger(\"setTriggerHoursLast\");\n  ScriptApp.newTrigger(\"sendSlack\")\n    .timeBased()\n    .after( 18 * 60 * 60 * 1000 )\n    .create();\n}\n\n.after( 18 * 60 * 60 * 1000 )\u3067\u30df\u30ea\u79d2\u5f8c\u306b\u30c8\u30ea\u30ac\u30fc\u3092\u30bb\u30c3\u30c8\u3057\u3066\u307e\u3059\u3002\n\nsendSlack\nfunction sendSlack() \n{\n  deleteTrigger(\"sendSlack\");\n  var options = \n  {\n    \"method\" : \"POST\",\n    \"payload\" : \n    {\n      \"token\": \"********************\",\n      \"channel\": \"bot-test\",\n      \"text\": \"\u9818\u53ce\u66f8\u51fa\u3057\u307e\u3057\u305f\u304b\uff1f\u5fd8\u308c\u3066\u306a\u3044\u3088\u306d\u3002\\\uff4ehttp://.../\"\n    }\n  }\n  var url = \"https://slack.com/api/chat.postMessage\"\n  UrlFetchApp.fetch(url, options);\n}\n\n\u3053\u3046\u3044\u3046\u66f8\u304d\u65b9\u3060\u3068\u601d\u3063\u3066\u3044\u305f\u3060\u3051\u308c\u3070\u2026\n\u8a73\u3057\u304f\u306f\u516c\u5f0f\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u3067\u3000https://api.slack.com/methods/chat.postMessage\n\nlastBusinessDay\nfunction lastBusinessDay() \n{\n  var today = new Date();\n  var lastDayOfThisMonth = new Date(today.getFullYear(), today.getMonth()+1, 0);\n  var day; // 0->\u65e5\u66dc\u65e5\n\n  for (var i = 0; i < 30; i++) {\n    day = lastDayOfThisMonth.getDay();\n    if (day == 0 || day == 6 || isHoliday(lastDayOfThisMonth)) {\n      lastDayOfThisMonth = new Date(today.getFullYear(), today.getMonth()+1, -1 * i);\n      continue;\n    }\n    break;\n  }\n  return lastDayOfThisMonth;\n}\n\nday == 0 || day == 6 || isHoliday(lastDayOfThisMonth)\n\u3053\u3053\u3067\u571f\u65e5\u3082\u3057\u304f\u306f\u795d\u65e5\u5224\u5b9a\u3092\u3057\u3066\u3044\u307e\u3059\u3002\n\ndeleteTrigger\n\nfunction deleteTrigger(name) \n{\n  var triggers = ScriptApp.getProjectTriggers();\n  for(var i=0; i < triggers.length; i++) {\n    if (triggers[i].getHandlerFunction() == name) {\n      ScriptApp.deleteTrigger(triggers[i]);\n    }\n  }\n}\n\n\n\u5b9f\u306f\u81ea\u5206\u3067\u30bb\u30c3\u30c8\u3057\u305ftrigger\u3063\u3066\u3053\u3093\u306a\u611f\u3058\u30671\u5206\u3054\u3068\u306b\u305f\u307e\u3063\u3066\u3044\u304d\u307e\u3059\u3002\n\u4eca\u56de\u3060\u3068\"MAIAMAIN\"\u3063\u3066\u540d\u524d\u306e\u30c8\u30ea\u30ac\u30fc\u3092\u5168\u524a\u9664\u3059\u308b\u6a5f\u80fd\u306b\u306a\u3063\u3066\u307e\u3059\u3002\n\n\u53c2\u8003\uff1a\u3000http://qiita.com/sumi-engraphia/items/465dd027e17f44da4d6a\n\nisHoliday\n\nfunction isHoliday(day) \n{\n  var startDate = new Date(day.setHours(0, 0, 0, 0));\n  var endDate = new Date(day.setHours(23, 59, 59));\n  var cal = CalendarApp.getCalendarById(\"ja.japanese#holiday@group.v.calendar.google.com\");\n  var holidays =  cal.getEvents(startDate, endDate);\n  return holidays.length != 0; // \u795d\u65e5\u306a\u3089true\n}\n\n\ngetCalendarById\u3067Google\u306e[\u65e5\u672c\u306e\u795d\u65e5]\u3092\u53d6\u5f97\u3057\u3066\u304d\u3066\u307e\u3059\u3002\n\u53c2\u8003\uff1a\u3000http://qiita.com/kamatama_41/items/be40e05524530920a9d9\n\u7d42\u308f\u308a\u307e\u3057\u305f\u301c\u301c\n\u6b21\u306f\u6708\u521d\u3081\u306e\u55b6\u696d\u65e5\u3092\u53d6\u3063\u3066\u3044\u304d\u307e\u3059\u301c\u301c\n\n\u6708\u521d\u3081\u306e\u55b6\u696d\u65e5\n\n/*\n  \u30e1\u30a4\u30f3\u306e\u51e6\u7406\n  setTriggerDay() : \u306f\u3058\u3081\u306e\u55b6\u696d\u65e5(0\u6642)\u306b\u6b21\u306e\u51e6\u7406\u3092\u3059\u308b\u547d\u4ee4\u3092\u51fa\u3059\u3002\n  setTriggerHoursFirst() : \u306f\u3058\u3081\u306e\u55b6\u696d\u65e5\u306e11\u6642\u306b\u6b21\u306e\u547d\u4ee4\u3092\u51fa\u3059\u3002\n  sendSlack() : slack\u306b\u30c7\u30fc\u30bf\u3092\u6295\u3052\u308b\u3002\n\n  \u30b5\u30d6\u7684\u306a\u51e6\u7406\n  deleteTrigger() : \u84c4\u7a4d\u3055\u308c\u3066\u3044\u308b\u547d\u4ee4\u3092\u524a\u9664\u3059\u308b\n  firstNextBusinessDay() : \u6765\u6708\u306e\u306f\u3058\u3081\u306e\u55b6\u696d\u65e5\u3092\u6c42\u3081\u308b\n  isHoliday() : \u672c\u65e5\u304c[\u65e5\u672c\u306e\u795d\u65e5]\u304b\u3069\u3046\u304b\u30c1\u30a7\u30c3\u30af\u3002\u571f\u65e5\u306f\u66dc\u65e5\u3067\u5224\u5b9a\u3057\u3066\u308b\u30c1\u30a7\u30c3\u30af\n  .getDay()\u3000: Date\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u304b\u3089\u66dc\u65e5\u3092\u6c42\u3081\u308b\u30e1\u30bd\u30c3\u30c9(0:\u65e5, 6:\u571f\u66dc\u65e5)\n*/\n\nfunction setTriggerDay2()\n{  \n  var first = firstNextBusinessDay();\n  ScriptApp.newTrigger(\"setTriggerHoursFirst\")\n    .timeBased()\n    .atDate(first.getFullYear(), first.getMonth()+1, first.getDate())\n    .create();\n}\n\nfunction setTriggerHoursFirst()\n{\n ScriptApp.newTrigger(\"sendSlack\")\n   .timeBased()\n   .after(11 * 60 * 60 * 1000)\n   .create();\n}\n\nfunction sendSlack() \n{\n  var options = \n  {\n    \"method\" : \"POST\",\n    \"payload\" : \n    {\n      \"token\": \"********************\",\n      \"channel\": \"bot-test\",\n      \"text\": \"\u6708\u304c\u59cb\u307e\u308a\u307e\u3057\u305f\u3002\"\n    }\n  }\n  var url = \"https://slack.com/api/chat.postMessage\"\n  UrlFetchApp.fetch(url, options);\n}\n\nfunction firstNextBusinessDay() \n{\n  var today = new Date();  \n  var firstDayOfNextMonth = new Date(today.getFullYear(), today.getMonth()+1, 1);\n  var day; // 0->\u65e5\u66dc\u65e5\n\n  for (var i = 2; i < 32; i++) {\n    day = firstDayOfNextMonth.getDay();\n    if (day == 0 || day == 6 || isHoliday(firstDayOfNextMonth)) {\n      firstDayOfThisMonth = new Date(today.getFullYear(), today.getMonth(), i);\n      continue;\n    }\n  }\n  return firstDayOfNextMonth;\n}\n\nfunction deleteTrigger() \n{\n  var triggers = ScriptApp.getProjectTriggers();\n  for(var i=0; i < triggers.length; i++) {\n    if (triggers[i].getHandlerFunction() == \"main\") {\n      ScriptApp.deleteTrigger(triggers[i]);\n    }\n  }\n}\n\nfunction isHoliday(day) \n{\n  var startDate = new Date(day.setHours(0, 0, 0, 0));\n  var endDate = new Date(day.setHours(23, 59, 59));\n  var cal = CalendarApp.getCalendarById(\"ja.japanese#holiday@group.v.calendar.google.com\");\n  var holidays =  cal.getEvents(startDate, endDate);\n  return holidays.length != 0; // \u795d\u65e5\u306a\u3089true\n}\n\n\n\n\u7b2c\u4e00\u6708\u66dc\u65e5\u55b6\u696d\u65e5\n\nfunction firstNextBusinessMonDay() {\n  var today = new Date();\n\n  var firstDayOfNextMonth = new Date(today.getFullYear(), today.getMonth()+1, 1);\n  var day; // 0->\u65e5\u66dc\u65e5\n\n  for (var i = 2; i < 32; i++) {\n    day = firstDayOfNextMonth.getDay();\n    if (day != 1 || isHoliday(firstDayOfNextMonth)) {\n      firstDayOfThisMonth = new Date(today.getFullYear(), today.getMonth(), i);\n      continue;\n    }\n    break;\n  }\n  return firstDayOfNextMonth;\n}\n\n\n\u3053\u3053\u3060\u3051\u5909\u3048\u308c\u3070\u3044\u3044\u304b\u306a\u3001\u3053\u3093\u306a\u611f\u3058\uff1f\n1\u65e5\u304b\u3089\u63a2\u7d22\u3057\u3066\u3001\u6708\u66dc\u65e5\u4ee5\u5916\u3082\u3057\u304f\u306f\u795d\u65e5\u306a\u3089\u6b21\u306e\u65e5\u306b\u3044\u304f\u3002\n\u4ee5\u4e0a\u3067\u3059\u3002\n\n\u7d42\u308f\u308a\u306b\n\u91cd\u8981\u306a\u3053\u3068\u306f\u305d\u306e\u307e\u307e\u304a\u30b3\u30d4\u30da\u3057\u3066\u306a\u3093\u304b\u3084\u3089\u304b\u3057\u3061\u3083\u3063\u305f\u3068\u304b\u8cac\u4efb\u3068\u308c\u306a\u3044\u3093\u3067(\u30df\u30b9\u3042\u3063\u3066\u3082\u3001Slack\u304c\u3042\u308c\u308b\u3068\u304b\u3001\u3082\u3057\u304f\u306f\u901a\u77e5\u3055\u308c\u306a\u3044\u3068\u304b\uff1f)\u81ea\u8eab\u306e\u74b0\u5883\u3067\u30c7\u30d0\u30c3\u30af\u3057\u3066\u304b\u3089\u304a\u4f7f\u3044\u304f\u3060\u3055\u3044\uff01\nGoogle Apps Script\u697d\u3057\u3044\uff01\n.\n# \u6708\u672b\u3063\u3066\u5fd9\u3057\u3044\u3088\u306d\u2026\n\n\u6708\u672b\u3063\u3066\u5831\u544a\u66f8\u3068\u304b\u3001\u9818\u53ce\u8a3c\u3068\u304b\u2026\u306a\u3093\u304b\u305f\u304f\u3055\u3093\u51fa\u3055\u306a\u304d\u3083\u3044\u3051\u306a\u3044\u3082\u306e\u3042\u308b\u3088\u306d\u3002\u30bb\u30f3\u30d1\u30a4\u304c\u300c\u8ab0\u304b\u4f5c\u3063\u3066\u300d\u3063\u3066\u8a00\u3063\u3066\u305f\u306e\u3092Google apps script\u3067\u4f5c\u6210\u3057\u307e\u3057\u305f\u3002\nGoogle apps script[GAS]\u89e6\u308a\u3060\u3057\u30664\u65e5\u76ee\u304f\u3089\u3044\u3067\u3059\u304c\u3001\u304b\u306a\u308a\u4fbf\u5229\u306a\u306e\u3067\u30a8\u30f3\u30b8\u30cb\u30a2\u4ee5\u5916\u306e\u3082\u3063\u3068\u305f\u304f\u3055\u3093\u306e\u4eba\u306b\u89e6\u308c\u3066\u6b32\u3057\u3044\u306a\u3068\u601d\u3044\u3001\u9023\u65e5\u3067\u3059\u304cGAS\u306e\u5b9f\u7528\u4f8b\u3092\u3042\u3052\u305f\u3044\u3068\u601d\u3044\u307e\u3059\u3002\n\n# \u5b8c\u6210\u54c1\n\n\u6708\u672b\u306e\u55b6\u696d\u65e5\u306bSlack\u6295\u3052\u308b\u3060\u3051\u306e\u30b7\u30f3\u30d7\u30eb\u306a\u5b9f\u88c5\u3067\u3059\u3002\n\u30b3\u30d4\u30da\u3059\u308c\u307010\u5206\u3067\u5b9f\u88c5\u3044\u3051\u308b\u3093\u3058\u3083\u306a\u3044\u304b\u3068\uff01\n\n<img width=\"555\" alt=\"\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2017-03-06 21.29.19.jpg\" src=\"https://qiita-image-store.s3.amazonaws.com/0/112929/e6e7c048-3dcd-0948-0d0d-597bf148ae4d.jpeg\">\n\n## \u5b8c\u6210\u307e\u3067\u306b\u4f7f\u7528\u3059\u308b\u3082\u306e\n\nGoogle\u30a2\u30ab\u30a6\u30f3\u30c8[Google Apps Script]\nSlack\n\n## \u5b8c\u6210\u3057\u305f\u3089\n\n\u4ee5\u4e0b\u306e2\u3064\u3082\u30b3\u30fc\u30c9\u516c\u958b\u3057\u307e\u3059\n* \u6708\u521d\u3081\u306e\u55b6\u696d\u65e5\u306b\u306a\u306b\u304b\u3092\u3059\u308b\n* \u6708\u59cb\u3081\u306e\u7b2c\u4e00\u91d1\u66dc\u65e5\u306b\u306a\u306b\u304b\u3092\u3059\u308b\n\n\u3064\u307e\u308a\u3053\u308c\u3092\u5fdc\u7528\u3059\u308c\u3070\u3001\u3044\u3064\u4f55\u6642\u3067\u3082Slack\u3067\u81ea\u52d5\u30c1\u30e3\u30c3\u30c8\u3092\u98db\u3070\u305b\u308b\u3088\u3046\u306b\u306a\u308b\u3002\n\n# \u6708\u672b\u7de0\u3081\u2026\uff01\uff01\n\n\u753b\u50cf\u3042\u308a\u3067\u3069\u3093\u3069\u3093\u3044\u304f\u3088\u301c\u301c\n\n## Slack Token\u306e\u53d6\u5f97\n\n\u3053\u3053\u3092\u53c2\u8003\u306b\u3057\u3066\u307f\u3066\uff01\nhttp://qiita.com/ykhirao/items/0d6b9f4a0cc626884dbb\n\nxoxp-18127\u3000\u3053\u3093\u306a\u611f\u3058\u306e\u9577\u3044\u6570\u5b57\u3002\n\nSlack\u6301\u3063\u3066\u306a\u3044\u4eba\u306f[\u500b\u4ebaSlack\u306e\u30b9\u30b9\u30e1](http://qiita.com/saitotak/items/ac0eb7ddc0d8d83cbe91)\u306b\u3057\u305f\u304c\u3063\u3066\u5c0e\u5165\u3092\u3059\u3059\u3081\u307e\u3059\u3002\n\n## GAS\u306e\u5c0e\u5165\n\nGoogle\u30c9\u30e9\u30a4\u30d6\u306b\u30a2\u30af\u30bb\u30b9\nhttps://drive.google.com/drive/my-drive\n\n<img width=\"1192\" alt=\"\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2017-03-06 21.59.16.jpg\" src=\"https://qiita-image-store.s3.amazonaws.com/0/112929/f0603105-eb23-a7ca-53be-8e593d104516.jpeg\">\n\n`\u65b0\u898f >> \u305d\u306e\u4ed6 >> \u30a2\u30d7\u30ea\u3092\u8ffd\u52a0`\n\u304b\u3089 Google apps script \u3092\u691c\u7d22\u30fb\u8ffd\u52a0\n\n<img width=\"1196\" alt=\"\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2017-03-06 22.00.23.jpg\" src=\"https://qiita-image-store.s3.amazonaws.com/0/112929/5f579f0d-2d24-34b6-8634-a7f0f4869537.jpeg\">\n\n\u305d\u3046\u3059\u308b\u3068`\u65b0\u898f >> \u305d\u306e\u4ed6 >> Google apps script`\u3092\u62bc\u3057\u3066\u307f\u3066\u304f\u3060\u3055\u3044\u3002\nGAS\u753b\u9762\u306b\u306a\u308b\u3068\u601d\u3044\u307e\u3059\u3002\n\n## GAS\u306e\u7de8\u96c6\n\n<img width=\"816\" alt=\"\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2017-03-06 22.23.56.jpg\" src=\"https://qiita-image-store.s3.amazonaws.com/0/112929/fcfa979d-2652-f795-c5ba-cb7de40cab02.jpeg\">\n\n\u30e1\u30a4\u30f3\u306e\u90e8\u5206\u306b\u3053\u308c\u3092\u8cbc\u308a\u4ed8\u3051\u3066\u307f\u3088\u3046\uff01\n\n```js\n\n/*\n  \u30e1\u30a4\u30f3\u306e\u51e6\u7406\n  setTriggerDay() : \u6700\u7d42\u55b6\u696d\u65e5(0\u6642)\u306b\u6b21\u306e\u51e6\u7406\u3092\u3059\u308b\u547d\u4ee4\u3092\u51fa\u3059\u3002\n  setTriggerHoursLast() : \u6700\u7d42\u55b6\u696d\u65e5\u306e18\u6642\u306b\u6b21\u306e\u547d\u4ee4\u3092\u51fa\u3059\u3002\n  sendSlack() : slack\u306b\u30c7\u30fc\u30bf\u3092\u6295\u3052\u308b\u3002\n\n  \u30b5\u30d6\u7684\u306a\u51e6\u7406\n  deleteTrigger() : \u84c4\u7a4d\u3055\u308c\u3066\u3044\u308b\u547d\u4ee4\u3092\u524a\u9664\u3059\u308b\n  lastBusinessDay() : \u4eca\u6708\u306e\u6700\u7d42\u55b6\u696d\u65e5\u3092\u6c42\u3081\u308b\n  isHoliday() : \u672c\u65e5\u304c[\u65e5\u672c\u306e\u795d\u65e5]\u304b\u3069\u3046\u304b\u30c1\u30a7\u30c3\u30af\u3002\u571f\u65e5\u306f\u66dc\u65e5\u3067\u5224\u5b9a\u3057\u3066\u308b\u30c1\u30a7\u30c3\u30af\n  .getDay()\u3000: Date\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u304b\u3089\u66dc\u65e5\u3092\u6c42\u3081\u308b\u30e1\u30bd\u30c3\u30c9(0:\u65e5, 6:\u571f\u66dc\u65e5)\n*/\n\nfunction setTriggerDay()\n{  \n  var last = lastBusinessDay();\n  ScriptApp.newTrigger(\"setTriggerHoursLast\")\n    .timeBased()\n    .atDate(last.getFullYear(), last.getMonth()+1, last.getDate())\n    .create();\n}\n\nfunction setTriggerHoursLast()\n{\n  deleteTrigger(\"setTriggerHoursLast\");\n  ScriptApp.newTrigger(\"sendSlack\")\n    .timeBased()\n    .after( 18 * 60 * 60 * 1000 )\n    .create();\n}\n\nfunction sendSlack() \n{\n  deleteTrigger(\"sendSlack\");\n  var options = \n  {\n    \"method\" : \"POST\",\n    \"payload\" : \n    {\n      \"token\": \"********************\",\n      \"channel\": \"bot-test\",\n      \"text\": \"\u9818\u53ce\u66f8\u51fa\u3057\u307e\u3057\u305f\u304b\uff1f\u5fd8\u308c\u3066\u306a\u3044\u3088\u306d\u3002\\\uff4ehttp://.../\"\n    }\n  }\n  var url = \"https://slack.com/api/chat.postMessage\"\n  UrlFetchApp.fetch(url, options);\n}\n\nfunction lastBusinessDay() \n{\n  var today = new Date();\n  \n  var lastDayOfThisMonth = new Date(today.getFullYear(), today.getMonth()+1, 0);\n  var day; // 0->\u65e5\u66dc\u65e5\n  \n  for (var i = 0; i < 30; i++) {\n    day = lastDayOfThisMonth.getDay();\n    if (day == 0 || day == 6 || isHoliday(lastDayOfThisMonth)) {\n      lastDayOfThisMonth = new Date(today.getFullYear(), today.getMonth()+1, -1 * i);\n      continue;\n    }\n  }\n  return lastDayOfThisMonth;\n}\n\nfunction deleteTrigger(name) \n{\n  var triggers = ScriptApp.getProjectTriggers();\n  for(var i=0; i < triggers.length; i++) {\n    if (triggers[i].getHandlerFunction() == name) {\n      ScriptApp.deleteTrigger(triggers[i]);\n    }\n  }\n}\n\nfunction isHoliday(day) \n{\n  var startDate = new Date(day.setHours(0, 0, 0, 0));\n  var endDate = new Date(day.setHours(23, 59, 59));\n  var cal = CalendarApp.getCalendarById(\"ja.japanese#holiday@group.v.calendar.google.com\");\n  var holidays =  cal.getEvents(startDate, endDate);\n  return holidays.length != 0; // \u795d\u65e5\u306a\u3089true\n}\n\n```\nsendSlack\u306e\u3053\u3053\u306f\u500b\u4eba\u8a2d\u5b9a\u306b\u5909\u3048\u3066\u304f\u3060\u3055\u3044\uff01\n\n- \"token\": \"********************\",\n- \"channel\": \"bot-test\",\n- \"text\": \"\u9818\u53ce\u66f8\u51fa\u3057\u307e\u3057\u305f\u304b\uff1f\u5fd8\u308c\u3066\u306a\u3044\u3088\u306d\u3002\\\uff4ehttp://.../\"\n\n\n## setTriggerDay()\u306e\u5b9f\u884c\u3068\u53d6\u308a\u6d88\u3057\u3068\u6bce\u6708\u5b9f\u884c\n\u5b9f\u884c >> setTriggerDay\n\u3092\u304a\u3057\u3066\u307f\u3088\u3046\u3002\n\n<img width=\"527\" alt=\"\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2017-03-06 22.26.52.jpg\" src=\"https://qiita-image-store.s3.amazonaws.com/0/112929/6eb86e29-a4f9-4fd0-e62d-76a8af233a72.jpeg\">\n\n\u30ea\u30bd\u30fc\u30b9 >> \u73fe\u5728\u306e\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306e\u30c8\u30ea\u30ac\u30fc\n\u3053\u3053\u304b\u3089\u30c8\u30ea\u30ac\u30fc\uff08\u4f55\u6642\u306b\u3042\u308c\u3092\u5b9f\u884c\u3057\u306a\u3055\u3044\uff09\u3092\u78ba\u8a8d\u3067\u304d\u307e\u3059\u3002\n\n<img width=\"648\" alt=\"\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2017-03-06 22.27.40.jpg\" src=\"https://qiita-image-store.s3.amazonaws.com/0/112929/daefaa91-51fc-0fbf-4057-b316c8be45b1.jpeg\">\n\n\u3053\u3053\u3067 2017/03/21 \u591c\u4e2d\u4e01\u5ea6\u306b setTriggerHoursLast \u304c\u5b9f\u884c\u3055\u308c\u308b\u3088\u3046\u306b\u306a\u3063\u3066\u3044\u305f\u3089\u5927\u4e08\u592b\u3002setTriggerHoursLast\u306f18\u6642\u9593\u5f8c\u306bSlack\u9001\u308a\u306a\u3055\u3044\u3068\u3044\u3046\u547d\u4ee4\u3067\u3059\u3002\n\n<img width=\"838\" alt=\"\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2017-03-06 22.27.47.jpg\" src=\"https://qiita-image-store.s3.amazonaws.com/0/112929/bb6cf9a2-aef7-769c-c69b-ba4eaa9b3e98.jpeg\">\n\n\u307e\u305f\u3064\u3044\u3067\u306b\u3053\u306e\u753b\u9762\u3067setTriggerDay\u3092\u6bce\u67081\u65e56\u6642\u304f\u3089\u3044\u306b\u30bb\u30c3\u30c8\u3057\u307e\u3059\u3002\n\n<img width=\"836\" alt=\"\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2017-03-06 22.37.18.jpg\" src=\"https://qiita-image-store.s3.amazonaws.com/0/112929/3288c9c8-dea7-5bdd-eefa-43fc7735fcfb.jpeg\">\n\n\n\u305d\u3046\u3059\u308b\u3068\u6bce\u67081\u65e5\u306bsetTriggerDay\u304c\u5b9f\u884c\u3055\u308c\u3066\n-> setTriggerDay :\u6700\u7d42\u65e5\u306b\u6b21\u3092\u5b9f\u884c\n-> setTriggerHoursLast :18\u6642\u306b\u6b21\u3092\u5b9f\u884c\n-> sendSlack :Slack\u3092\u5b9f\u884c\n\n\u3063\u3066\u611f\u3058\u3067\u6bce\u6708\u3001\u6700\u7d42\u65e5\u30c8\u30ea\u30ac\u30fc\u3092\u4f5c\u6210\u3057\u3066\u304f\u308c\u307e\u3059\u3002\n\n## function\u3054\u3068\u306b\u898b\u3066\u3044\u304f\n\n\u7c21\u5358\u306b\u307f\u3066\u3044\u304d\u307e\u3059\u3002\n\n### setTriggerDay\n\n```js\nfunction setTriggerDay()\n{  \n  var last = lastBusinessDay();\n  ScriptApp.newTrigger(\"setTriggerHoursLast\")\n    .timeBased()\n    .atDate(last.getFullYear(), last.getMonth()+1, last.getDate())\n    .create();\n}\n```\n\nlastBusinessDay()\u3067\u55b6\u696d\u65e5\u6700\u7d42\u65e5\u306eDate\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u53d6\u3063\u3066\u304d\u3066\n.atDate(last.getMonth()+1)\u3068\u3057\u3066\u3044\u308b\u3068\u3053\u308d\u306f\u3001\u6708\u306f0\u6708\u59cb\u307e\u308a\u3068\u306a\u3063\u3066\u3044\u308b\u304b\u3089\u3067\u3059\u3002\n\n### setTriggerHoursLast\n\n```js\nfunction setTriggerHoursLast()\n{\n  deleteTrigger(\"setTriggerHoursLast\");\n  ScriptApp.newTrigger(\"sendSlack\")\n    .timeBased()\n    .after( 18 * 60 * 60 * 1000 )\n    .create();\n}\n```\n.after( 18 * 60 * 60 * 1000 )\u3067\u30df\u30ea\u79d2\u5f8c\u306b\u30c8\u30ea\u30ac\u30fc\u3092\u30bb\u30c3\u30c8\u3057\u3066\u307e\u3059\u3002\n\n### sendSlack\n\n```js\nfunction sendSlack() \n{\n  deleteTrigger(\"sendSlack\");\n  var options = \n  {\n    \"method\" : \"POST\",\n    \"payload\" : \n    {\n      \"token\": \"********************\",\n      \"channel\": \"bot-test\",\n      \"text\": \"\u9818\u53ce\u66f8\u51fa\u3057\u307e\u3057\u305f\u304b\uff1f\u5fd8\u308c\u3066\u306a\u3044\u3088\u306d\u3002\\\uff4ehttp://.../\"\n    }\n  }\n  var url = \"https://slack.com/api/chat.postMessage\"\n  UrlFetchApp.fetch(url, options);\n}\n```\n\n\u3053\u3046\u3044\u3046\u66f8\u304d\u65b9\u3060\u3068\u601d\u3063\u3066\u3044\u305f\u3060\u3051\u308c\u3070\u2026\n\u8a73\u3057\u304f\u306f\u516c\u5f0f\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u3067\u3000https://api.slack.com/methods/chat.postMessage\n\n### lastBusinessDay\n\n```js\nfunction lastBusinessDay() \n{\n  var today = new Date();\n  var lastDayOfThisMonth = new Date(today.getFullYear(), today.getMonth()+1, 0);\n  var day; // 0->\u65e5\u66dc\u65e5\n\n  for (var i = 0; i < 30; i++) {\n    day = lastDayOfThisMonth.getDay();\n    if (day == 0 || day == 6 || isHoliday(lastDayOfThisMonth)) {\n      lastDayOfThisMonth = new Date(today.getFullYear(), today.getMonth()+1, -1 * i);\n      continue;\n    }\n    break;\n  }\n  return lastDayOfThisMonth;\n}\n```\n\nday == 0 || day == 6 || isHoliday(lastDayOfThisMonth)\n\u3053\u3053\u3067\u571f\u65e5\u3082\u3057\u304f\u306f\u795d\u65e5\u5224\u5b9a\u3092\u3057\u3066\u3044\u307e\u3059\u3002\n\n### deleteTrigger\n\n```js\n\nfunction deleteTrigger(name) \n{\n  var triggers = ScriptApp.getProjectTriggers();\n  for(var i=0; i < triggers.length; i++) {\n    if (triggers[i].getHandlerFunction() == name) {\n      ScriptApp.deleteTrigger(triggers[i]);\n    }\n  }\n}\n\n```\n\n\u5b9f\u306f\u81ea\u5206\u3067\u30bb\u30c3\u30c8\u3057\u305ftrigger\u3063\u3066\u3053\u3093\u306a\u611f\u3058\u30671\u5206\u3054\u3068\u306b\u305f\u307e\u3063\u3066\u3044\u304d\u307e\u3059\u3002\n\u4eca\u56de\u3060\u3068\"MAIAMAIN\"\u3063\u3066\u540d\u524d\u306e\u30c8\u30ea\u30ac\u30fc\u3092\u5168\u524a\u9664\u3059\u308b\u6a5f\u80fd\u306b\u306a\u3063\u3066\u307e\u3059\u3002\n<img width=\"735\" alt=\"\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2017-03-06 23.14.29.jpg\" src=\"https://qiita-image-store.s3.amazonaws.com/0/112929/ac6f4c7c-f142-f4ca-f7dc-f95088bc7118.jpeg\">\n\n\u53c2\u8003\uff1a\u3000http://qiita.com/sumi-engraphia/items/465dd027e17f44da4d6a\n\n### isHoliday\n\n```js\n\nfunction isHoliday(day) \n{\n  var startDate = new Date(day.setHours(0, 0, 0, 0));\n  var endDate = new Date(day.setHours(23, 59, 59));\n  var cal = CalendarApp.getCalendarById(\"ja.japanese#holiday@group.v.calendar.google.com\");\n  var holidays =  cal.getEvents(startDate, endDate);\n  return holidays.length != 0; // \u795d\u65e5\u306a\u3089true\n}\n\n```\n\ngetCalendarById\u3067Google\u306e[\u65e5\u672c\u306e\u795d\u65e5]\u3092\u53d6\u5f97\u3057\u3066\u304d\u3066\u307e\u3059\u3002\n\n\u53c2\u8003\uff1a\u3000http://qiita.com/kamatama_41/items/be40e05524530920a9d9\n\n\u7d42\u308f\u308a\u307e\u3057\u305f\u301c\u301c\n\u6b21\u306f\u6708\u521d\u3081\u306e\u55b6\u696d\u65e5\u3092\u53d6\u3063\u3066\u3044\u304d\u307e\u3059\u301c\u301c\n\n# \u6708\u521d\u3081\u306e\u55b6\u696d\u65e5\n\n```js\n\n/*\n  \u30e1\u30a4\u30f3\u306e\u51e6\u7406\n  setTriggerDay() : \u306f\u3058\u3081\u306e\u55b6\u696d\u65e5(0\u6642)\u306b\u6b21\u306e\u51e6\u7406\u3092\u3059\u308b\u547d\u4ee4\u3092\u51fa\u3059\u3002\n  setTriggerHoursFirst() : \u306f\u3058\u3081\u306e\u55b6\u696d\u65e5\u306e11\u6642\u306b\u6b21\u306e\u547d\u4ee4\u3092\u51fa\u3059\u3002\n  sendSlack() : slack\u306b\u30c7\u30fc\u30bf\u3092\u6295\u3052\u308b\u3002\n\n  \u30b5\u30d6\u7684\u306a\u51e6\u7406\n  deleteTrigger() : \u84c4\u7a4d\u3055\u308c\u3066\u3044\u308b\u547d\u4ee4\u3092\u524a\u9664\u3059\u308b\n  firstNextBusinessDay() : \u6765\u6708\u306e\u306f\u3058\u3081\u306e\u55b6\u696d\u65e5\u3092\u6c42\u3081\u308b\n  isHoliday() : \u672c\u65e5\u304c[\u65e5\u672c\u306e\u795d\u65e5]\u304b\u3069\u3046\u304b\u30c1\u30a7\u30c3\u30af\u3002\u571f\u65e5\u306f\u66dc\u65e5\u3067\u5224\u5b9a\u3057\u3066\u308b\u30c1\u30a7\u30c3\u30af\n  .getDay()\u3000: Date\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u304b\u3089\u66dc\u65e5\u3092\u6c42\u3081\u308b\u30e1\u30bd\u30c3\u30c9(0:\u65e5, 6:\u571f\u66dc\u65e5)\n*/\n\nfunction setTriggerDay2()\n{  \n  var first = firstNextBusinessDay();\n  ScriptApp.newTrigger(\"setTriggerHoursFirst\")\n    .timeBased()\n    .atDate(first.getFullYear(), first.getMonth()+1, first.getDate())\n    .create();\n}\n\nfunction setTriggerHoursFirst()\n{\n ScriptApp.newTrigger(\"sendSlack\")\n   .timeBased()\n   .after(11 * 60 * 60 * 1000)\n   .create();\n}\n\nfunction sendSlack() \n{\n  var options = \n  {\n    \"method\" : \"POST\",\n    \"payload\" : \n    {\n      \"token\": \"********************\",\n      \"channel\": \"bot-test\",\n      \"text\": \"\u6708\u304c\u59cb\u307e\u308a\u307e\u3057\u305f\u3002\"\n    }\n  }\n  var url = \"https://slack.com/api/chat.postMessage\"\n  UrlFetchApp.fetch(url, options);\n}\n\nfunction firstNextBusinessDay() \n{\n  var today = new Date();  \n  var firstDayOfNextMonth = new Date(today.getFullYear(), today.getMonth()+1, 1);\n  var day; // 0->\u65e5\u66dc\u65e5\n  \n  for (var i = 2; i < 32; i++) {\n    day = firstDayOfNextMonth.getDay();\n    if (day == 0 || day == 6 || isHoliday(firstDayOfNextMonth)) {\n      firstDayOfThisMonth = new Date(today.getFullYear(), today.getMonth(), i);\n      continue;\n    }\n  }\n  return firstDayOfNextMonth;\n}\n\nfunction deleteTrigger() \n{\n  var triggers = ScriptApp.getProjectTriggers();\n  for(var i=0; i < triggers.length; i++) {\n    if (triggers[i].getHandlerFunction() == \"main\") {\n      ScriptApp.deleteTrigger(triggers[i]);\n    }\n  }\n}\n\nfunction isHoliday(day) \n{\n  var startDate = new Date(day.setHours(0, 0, 0, 0));\n  var endDate = new Date(day.setHours(23, 59, 59));\n  var cal = CalendarApp.getCalendarById(\"ja.japanese#holiday@group.v.calendar.google.com\");\n  var holidays =  cal.getEvents(startDate, endDate);\n  return holidays.length != 0; // \u795d\u65e5\u306a\u3089true\n}\n\n```\n\n# \u7b2c\u4e00\u6708\u66dc\u65e5\u55b6\u696d\u65e5\n\n```js\n\nfunction firstNextBusinessMonDay() {\n  var today = new Date();\n  \n  var firstDayOfNextMonth = new Date(today.getFullYear(), today.getMonth()+1, 1);\n  var day; // 0->\u65e5\u66dc\u65e5\n  \n  for (var i = 2; i < 32; i++) {\n    day = firstDayOfNextMonth.getDay();\n    if (day != 1 || isHoliday(firstDayOfNextMonth)) {\n      firstDayOfThisMonth = new Date(today.getFullYear(), today.getMonth(), i);\n      continue;\n    }\n    break;\n  }\n  return firstDayOfNextMonth;\n}\n\n```\n\u3053\u3053\u3060\u3051\u5909\u3048\u308c\u3070\u3044\u3044\u304b\u306a\u3001\u3053\u3093\u306a\u611f\u3058\uff1f\n1\u65e5\u304b\u3089\u63a2\u7d22\u3057\u3066\u3001\u6708\u66dc\u65e5\u4ee5\u5916\u3082\u3057\u304f\u306f\u795d\u65e5\u306a\u3089\u6b21\u306e\u65e5\u306b\u3044\u304f\u3002\n\n\n\u4ee5\u4e0a\u3067\u3059\u3002\n\n\n# \u7d42\u308f\u308a\u306b\n\n\u91cd\u8981\u306a\u3053\u3068\u306f\u305d\u306e\u307e\u307e\u304a\u30b3\u30d4\u30da\u3057\u3066\u306a\u3093\u304b\u3084\u3089\u304b\u3057\u3061\u3083\u3063\u305f\u3068\u304b\u8cac\u4efb\u3068\u308c\u306a\u3044\u3093\u3067(\u30df\u30b9\u3042\u3063\u3066\u3082\u3001Slack\u304c\u3042\u308c\u308b\u3068\u304b\u3001\u3082\u3057\u304f\u306f\u901a\u77e5\u3055\u308c\u306a\u3044\u3068\u304b\uff1f)\u81ea\u8eab\u306e\u74b0\u5883\u3067\u30c7\u30d0\u30c3\u30af\u3057\u3066\u304b\u3089\u304a\u4f7f\u3044\u304f\u3060\u3055\u3044\uff01\n\nGoogle Apps Script\u697d\u3057\u3044\uff01\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n.\n", "tags": ["GoogleAppsScript", "JavaScript", "google", "Slack"]}