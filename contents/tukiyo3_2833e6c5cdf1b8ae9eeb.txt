{"context": "\n\n\u53c2\u8003\n\nLinux Containers - LXD - \u306f\u3058\u3081\u306b - \u30b3\u30de\u30f3\u30c9\u30e9\u30a4\u30f3\nUbuntu 16.04 LTS\u3067LXD 2.0\u3092\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\u3057\u3066\u4f7f\u3063\u3066\u307f\u308b \u00b7 hnakamur's blog at github\n\n\nsetup-alpine\niso\u30d6\u30fc\u30c8\u3057setup-alipine\u5b9f\u884c\n\njp\nalpine\n[eth0]\n192.168.9.51/24\n192.168.9.1\n[]\n[]\n8.8.8.8\npassword1\npassword2\nAsia/Tokyo\n[]\n[f]\n[openssh]\n[chrony]\nsda\nsys\ny\n\nreboot\n\n\u518d\u8d77\u52d5\u5f8c\nvi /etc/apk/repositories\n# edge \u3092\u30b3\u30e1\u30f3\u30c8\u30a2\u30a6\u30c8\napk update\n# \napk add lxc lxd\n# \u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u8a2d\u5b9a\u7528\napk add dnsmasq iptables ip6tables\n# \u30d6\u30ea\u30c3\u30b8\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9\u7528\napk add bridge-utils\n# ssl\u901a\u4fe1\u7528\napk add ca-certificates openssl\n\nrc-update add lxd default\n\n\n\u8d77\u52d5\u30b9\u30af\u30ea\u30d7\u30c8\u8ffd\u52a0\n\n\u3053\u306e\u307e\u307e\u3067\u306f service lxd start\u3067lxd dameon\u304c\u8d77\u52d5\u3057\u306a\u3044\u305f\u3081\u4ee5\u4e0b\u4fee\u6b63\n\n\n/etc/init.d/lxd\n  #!/sbin/openrc-run\n  # (c) 2016 Alpine Linux\n\n  command=\"/usr/sbin/lxd\"\n  command_args=\"${LXD_OPTIONS}\"\n  command_background=\"true\"\n  pidfile=\"/var/run/${RC_SVCNAME}.pid\"\n\n  depend() {\n    need net\n    use lxcfs\n    after firewall\n  }\n\n+ start() {\n+   ebegin \"Starting ${SVCNAME}\"\n+   start-stop-daemon --start --background --exec \\\n+             $command $command_args daemon\n+   eend $?\n+ }\n\n\n\nlxd\u306e\u8a2d\u5b9a\n# lxd daemon\nservice lxd start\nlxd init --auto\n\n$ lxc image list images: centos\n+------------------------+--------------+--------+---------------------------------+--------+----------+-------------------------------+\n|         ALIAS          | FINGERPRINT  | PUBLIC |           DESCRIPTION           |  ARCH  |   SIZE   |          UPLOAD DATE          |\n+------------------------+--------------+--------+---------------------------------+--------+----------+-------------------------------+\n| centos/6 (3 more)      | 37b6a126b5af | yes    | Centos 6 amd64 (20170211_02:16) | x86_64 | 124.95MB | Feb 11, 2017 at 12:00am (UTC) |\n+------------------------+--------------+--------+---------------------------------+--------+----------+-------------------------------+\n| centos/6/i386 (1 more) | b8d9470a1866 | yes    | Centos 6 i386 (20170211_02:16)  | i686   | 121.95MB | Feb 11, 2017 at 12:00am (UTC) |\n+------------------------+--------------+--------+---------------------------------+--------+----------+-------------------------------+\n| centos/7 (3 more)      | 3f220a619aba | yes    | Centos 7 amd64 (20170211_02:16) | x86_64 | 65.23MB  | Feb 11, 2017 at 12:00am (UTC) |\n+------------------------+--------------+--------+---------------------------------+--------+----------+-------------------------------+\n\n# lxc launch images:centos/6 cent01\nlxc launch images:centos/6 cent01 -c security.privileged=true\nlxc network attach lxdbr0 cent01\nlxc start cent01 # <- \u8d77\u52d5\u3057\u306a\u3044\u30fb\u30fb\u30fb\u3002\nlxc info cent01\nlxc list\nlxc exec cent01 -- bash # <- \u8d77\u52d5\u3057\u306a\u3044\u30fb\u30fb\u30fb\u3002\n\n\nlxd\u306e\u30a2\u30f3\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\nrc-update del lxd default\napk del lxd\nrm -r /var/lib/lxd\nip link set lxdbr0 down\nbrctl delbr lxdbr0\nreboot\n\n\n\u30c8\u30e9\u30d6\u30eb\u30b7\u30e5\u30fc\u30c6\u30a3\u30f3\u30b0\n\nwget installation does not work on Alpine \u00b7 Issue #73 \u00b7 Yelp/dumb-init \u00b7 GitHub\n\n\nerror: Get https://images.linuxcontainers.org/streams/v1/index.json: x509: failed to load system roots and no roots provided\nwget https://images.linuxcontainers.org/streams/v1/index.json\nwget: can't execute 'ssl_helper': No such file or directory\n\n\nca-certificates, openssl \u30d1\u30c3\u30b1\u30fc\u30b8\u3092\u5165\u308c\u308b\u3002\n\n## \u53c2\u8003\n\n* [Linux Containers - LXD - \u306f\u3058\u3081\u306b - \u30b3\u30de\u30f3\u30c9\u30e9\u30a4\u30f3](https://linuxcontainers.org/ja/lxd/getting-started-cli/)\n* [Ubuntu 16.04 LTS\u3067LXD 2.0\u3092\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\u3057\u3066\u4f7f\u3063\u3066\u307f\u308b \u00b7 hnakamur's blog at github](https://hnakamur.github.io/blog/2016/05/07/start-using-lxd-2.0-on-ubuntu-16.04/)\n\n## setup-alpine\n\niso\u30d6\u30fc\u30c8\u3057setup-alipine\u5b9f\u884c\n\n1. jp\n1. alpine\n1. [eth0]\n1. 192.168.9.51/24\n1. 192.168.9.1\n2. []\n3. []\n4. 8.8.8.8\n5. password1\n5. password2\n6. Asia/Tokyo\n7. []\n8. [f]\n9. [openssh]\n10. [chrony]\n11. sda\n12. sys\n13. y\n\nreboot\n\n## \u518d\u8d77\u52d5\u5f8c\n\n```bash:\nvi /etc/apk/repositories\n# edge \u3092\u30b3\u30e1\u30f3\u30c8\u30a2\u30a6\u30c8\napk update\n# \napk add lxc lxd\n# \u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u8a2d\u5b9a\u7528\napk add dnsmasq iptables ip6tables\n# \u30d6\u30ea\u30c3\u30b8\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9\u7528\napk add bridge-utils\n# ssl\u901a\u4fe1\u7528\napk add ca-certificates openssl\n\nrc-update add lxd default\n```\n\n## \u8d77\u52d5\u30b9\u30af\u30ea\u30d7\u30c8\u8ffd\u52a0\n\n* \u3053\u306e\u307e\u307e\u3067\u306f `service lxd start`\u3067`lxd dameon`\u304c\u8d77\u52d5\u3057\u306a\u3044\u305f\u3081\u4ee5\u4e0b\u4fee\u6b63\n\n```diff:/etc/init.d/lxd\n  #!/sbin/openrc-run\n  # (c) 2016 Alpine Linux\n  \n  command=\"/usr/sbin/lxd\"\n  command_args=\"${LXD_OPTIONS}\"\n  command_background=\"true\"\n  pidfile=\"/var/run/${RC_SVCNAME}.pid\"\n  \n  depend() {\n  \tneed net\n  \tuse lxcfs\n  \tafter firewall\n  }\n  \n+ start() {\n+ \tebegin \"Starting ${SVCNAME}\"\n+ \tstart-stop-daemon --start --background --exec \\\n+             $command $command_args daemon\n+ \teend $?\n+ }\n```\n\n## lxd\u306e\u8a2d\u5b9a\n\n```rb\n# lxd daemon\nservice lxd start\nlxd init --auto\n```\n\n```rb\n$ lxc image list images: centos\n+------------------------+--------------+--------+---------------------------------+--------+----------+-------------------------------+\n|         ALIAS          | FINGERPRINT  | PUBLIC |           DESCRIPTION           |  ARCH  |   SIZE   |          UPLOAD DATE          |\n+------------------------+--------------+--------+---------------------------------+--------+----------+-------------------------------+\n| centos/6 (3 more)      | 37b6a126b5af | yes    | Centos 6 amd64 (20170211_02:16) | x86_64 | 124.95MB | Feb 11, 2017 at 12:00am (UTC) |\n+------------------------+--------------+--------+---------------------------------+--------+----------+-------------------------------+\n| centos/6/i386 (1 more) | b8d9470a1866 | yes    | Centos 6 i386 (20170211_02:16)  | i686   | 121.95MB | Feb 11, 2017 at 12:00am (UTC) |\n+------------------------+--------------+--------+---------------------------------+--------+----------+-------------------------------+\n| centos/7 (3 more)      | 3f220a619aba | yes    | Centos 7 amd64 (20170211_02:16) | x86_64 | 65.23MB  | Feb 11, 2017 at 12:00am (UTC) |\n+------------------------+--------------+--------+---------------------------------+--------+----------+-------------------------------+\n```\n\n```rb\n# lxc launch images:centos/6 cent01\nlxc launch images:centos/6 cent01 -c security.privileged=true\nlxc network attach lxdbr0 cent01\nlxc start cent01 # <- \u8d77\u52d5\u3057\u306a\u3044\u30fb\u30fb\u30fb\u3002\nlxc info cent01\nlxc list\nlxc exec cent01 -- bash # <- \u8d77\u52d5\u3057\u306a\u3044\u30fb\u30fb\u30fb\u3002\n```\n\n## lxd\u306e\u30a2\u30f3\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n```\nrc-update del lxd default\napk del lxd\nrm -r /var/lib/lxd\nip link set lxdbr0 down\nbrctl delbr lxdbr0\nreboot\n```\n\n## \u30c8\u30e9\u30d6\u30eb\u30b7\u30e5\u30fc\u30c6\u30a3\u30f3\u30b0\n\n* [wget installation does not work on Alpine \u00b7 Issue #73 \u00b7 Yelp/dumb-init \u00b7 GitHub](https://github.com/Yelp/dumb-init/issues/73)\n\n> error: Get https://images.linuxcontainers.org/streams/v1/index.json: x509: failed to load system roots and no roots provided\n> wget https://images.linuxcontainers.org/streams/v1/index.json\n> wget: can't execute 'ssl_helper': No such file or directory\n\n* ca-certificates, openssl \u30d1\u30c3\u30b1\u30fc\u30b8\u3092\u5165\u308c\u308b\u3002\n", "tags": ["lxd", "alpine"]}