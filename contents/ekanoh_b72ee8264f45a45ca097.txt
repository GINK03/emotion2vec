{"tags": ["Rails", "\u82f1\u8a9e", "English", "Rails5", "100\u672c\u30ce\u30c3\u30af"], "context": "\n\n\u8cc7\u6599\n\n\u53c2\u7167\u52d5\u753b\n\n\nRuby on Rails 5 - Tutorial\n\n\nGit \u30ec\u30dd\u30b8\u30c8\u30ea\n\n\nhonake/simple_cms\n\n\n\u307e\u3068\u3081\u306e\u307e\u3068\u3081\n\n\n\u3010Rails\u3092\u30ad\u30bd\u304b\u3089\u518d\u5b66\u7fd2\u3011Rails 5 Tutorials \u5168\u4e00\u89a7\n\n\n\n\n\u307e\u3068\u3081\n\n41. One to one associations\n\n\u30a2\u30bd\u30b7\u30a8\u30fc\u30b7\u30e7\u30f3\u306e\u30dd\u30a4\u30f3\u30c8\n\n\nbelongs_to\u3092\u8a18\u8ff0\u3059\u308b\u30af\u30e9\u30b9\u3000\uff1d\u3000\u5916\u90e8\u30ad\u30fc\u3092\u4fdd\u6709\u3057\u3066\u3044\u308b\n\nbelongs_to\u3092\u8a18\u8ff0\u3059\u308b \uff1d has one (many)\u3082\u8a18\u8ff0\u3059\u308b\n\n\nmodels/page.rb\nclass Page < ApplicationRecord\n  belongs_to :subject\nend\n\n\n\nmodels/subject.rb\nclass Subject < ApplicationRecord\n  has_one :page\nend\n\n\n\nOne-to-one\u306e\u6319\u52d5\n# find\u3067subject\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u3092\u53d6\u5f97\nirb(main):001:0> subject = Subject.find(1)\n\n# first_page\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u3092\u4f5c\u6210\uff08DB\u306b\u4fdd\u5b58\u306f\u3055\u308c\u3066\u3044\u306a\u3044\uff09\nirb(main):007:0> first_page = Page.new(name: \"First Page\", permalink: \"first\",\nirb(main):008:1* position: 1, visible: false, created_at: nil, updated_at: nil)\n\n# has_one\u3067\u5b9a\u7fa9\u3057\u305fpage\u3092\u4f7f\u3044\u3001\n# subjects\u30c6\u30fc\u30d6\u30eb\u306e\u5916\u90e8\u30ad\u30fcpage_id\u306b\u5bfe\u5fdc\u3059\u308bPage\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u3068\u3057\u3066first_page\u3092\u4ee3\u5165\u3059\u308b\nirb(main):024:0> subject.page = first_page\n   (0.2ms)  BEGIN\n  SQL (5.0ms)  INSERT INTO `pages` (`subject_id`, `name`, `permalink`, `position`, `created_at`, `updated_at`) VALUES (1, 'First Page', 'first', 1, '2017-01-05 17:15:38', '2017-01-05 17:15:38')\n   (22.5ms)  COMMIT\n=> #<Page id: 1, subject_id: 1, name: \"First Page\", permalink: \"first\", position: 1, visible: false, created_at: \"2017-01-05 17:15:38\", updated_at: \"2017-01-05 17:15:38\">\n\n# \u3053\u306e\u30bf\u30a4\u30df\u30f3\u30b0\u3067first_page\u3082DB\u306b\u4fdd\u5b58\u3055\u308c\u3066\u3044\u308b\nirb(main):025:0> Page.all\n  Page Load (0.4ms)  SELECT `pages`.* FROM `pages`\n=> #<ActiveRecord::Relation [#<Page id: 1, subject_id: 1, name: \"First Page\", permalink: \"first\", position: 1, visible: false, created_at: \"2017-01-05 17:15:38\", updated_at: \"2017-01-05 17:15:38\">]>\n\n# first_page\u306e\u5916\u90e8\u30ad\u30fc\u3082\u66f4\u65b0\u3055\u308c\u3066\u3044\u308b\nirb(main):026:0> first_page.subject_id\n=> 1\n\n# belongs_to\u3067\u5b9a\u7fa9\u3057\u305fsubject\u3092\u4f7f\u3044\u3001\n# pages\u30c6\u30fc\u30d6\u30eb\u306e\u5916\u90e8\u30ad\u30fcsubject_id\u306b\u5bfe\u5fdc\u3059\u308bSubject\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u3092\u53d6\u5f97\u3059\u308b\nirb(main):027:0> first_page.subject\n=> #<Subject id: 1, name: \"Initial Subject\", position: \"1\", visible: true, created_at: \"2017-01-05 07:36:43\", updated_at: \"2017-01-05 07:44:37\">\n\n\n42. One to many associations\n\nOne-to-many\u306e\u30dd\u30a4\u30f3\u30c8\n\none-to-one\u3088\u308a\u3082\u983b\u7e41\u306b\u4f7f\u7528\u3055\u308c\u308b\n\u30ea\u30ec\u30fc\u30b7\u30e7\u30f3\u306f\u8907\u6570\u5f62\n\n\neg) Photographer has_many :photographs\n\n\n\n\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306e\u914d\u5217\u3092\u8fd4\u3059\n\n\nmodels/page.rb\nclass Page < ApplicationRecord\n  belongs_to :subject\nend\n\n\n\nmodels/subject.rb\nclass Subject < ApplicationRecord\n  has_many :pages\nend\n\n\n\nOne-to-many\u3067\u3088\u304f\u4f7f\u3046\u30e1\u30bd\u30c3\u30c9\n\u307b\u3068\u3093\u3069one-to-one\u3068\u6319\u52d5\u306f\u540c\u3058\u306a\u306e\u3067\u3001\u983b\u7e41\u306b\u4f7f\u3046\u30e1\u30bd\u30c3\u30c9\u3060\u3051\u78ba\u8a8d\u3057\u3066\u304a\u304f\u3002\nsubject.pages\nsubject.pages << page\nsubject.pages = [page,page,page]\nsubject.pages.delete(page)\nsubject.pages.destroy(page)\nsubject.pages.clear\nsubject.pages.empty?\nsubject.pages.size\n\n\n43. Belongs to presence validation\n\nRails 5.0\u3067\u5909\u66f4\u3055\u308c\u305f\u30b7\u30b9\u30c6\u30e0\n\nbelongs_to\u306f\u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u5fc5\u9808\n\ndisable\u3057\u305f\u3044 \u2192 config\u3092\u3044\u3058\u308b or \u30b1\u30fc\u30b9\u30d0\u30a4\u30b1\u30fc\u30b9\u3067\u5bfe\u5fdc\n\n\n\nActiveRecord\u306f\u5bfe\u5fdc\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u304c\u5b58\u5728\u3059\u308b\u304bvalidate\u3059\u308b\n\n\n\u3064\u307e\u308a\u3001\u5bfe\u5fdcsubject\u304c\u5b58\u5728\u3057\u306a\u3051\u308c\u3070page\u3092save\u3067\u304d\u306a\u3044\n\n\n\n\n\u30b1\u30fc\u30b9\u30d0\u30a4\u30b1\u30fc\u30b9\u3067\u5bfe\u5fdc\u3059\u308b\u65b9\u6cd5\n\nmodels/page.rb\nclass Page < ApplicationRecord\n  belongs_to :subject, {optional: true}\nend\n\n\n\n# subject_id\u304cnil\u306epage\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u4f5c\u6210\nirb(main):001:0> page = Page.new(name: \"No subject assigned\")\n=> #<Page id: nil, subject_id: nil, name: \"No subject assigned\", permalink: nil, position: nil, visible: false, created_at: nil, updated_at: nil>\n\n# optional: true\u306b\u3088\u308asave\u304c\u53ef\u80fd\nirb(main):002:0> page.save\n   (0.4ms)  BEGIN\n  SQL (1.1ms)  INSERT INTO `pages` (`name`, `created_at`, `updated_at`) VALUES ('No subject assigned', '2017-01-06 06:55:42', '2017-01-06 06:55:42')\n   (37.8ms)  COMMIT\n=> true\n\n\n44. Many to many associations Simple\n\n\u30b7\u30f3\u30d7\u30eb\u306aMany-to-many \u2192 JOIN\u30c6\u30fc\u30d6\u30eb\n\nJOIN\u30c6\u30fc\u30d6\u30eb\n\n\n\uff12\u3064\u306e\u5916\u90e8\u30ad\u30fc\uff1b\u3000\u3068\u3082\u306b\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u3092\u4ed8\u4e0e\n\u4e3b\u30ad\u30fc\u306f\u4e0d\u8981\n\n\n\u547d\u540d\u898f\u5247\n\n\nfirst_table + _ + second_table\u3068\u3059\u308b\u3068\u3088\u3044\n\u8f9e\u66f8\u9806\u306b\u4e26\u3079\u308b\u3068\u3088\u3044\n\n\n\n\n\u4f8b\n\n\u4ee5\u4e0b\u306e\u30a2\u30bd\u30b7\u30a8\u30fc\u30b7\u30e7\u30f3\u3092\u8003\u3048\u308b\n\n\nAdminUser has_and_belongs_to_many :pages\n\nPages has_and_belongs_to_many :admin_users\n\n\n\n\n\u307e\u305a\u3001JOIN\u30c6\u30fc\u30d6\u30eb\u4f5c\u6210\u306e\u305f\u3081\u306emigration\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u6210\n\nrails generate migration CreateAdminUsersPagesJoin\n\n\u751f\u6210\u3055\u308c\u305fmigration\u30d5\u30a1\u30a4\u30eb\u3092\u4ee5\u4e0b\u306e\u5f62\u306b\u3059\u308b\u3002\n\ndb/migrate/20170106070749_create_admin_users_pages_join.rb\nclass CreateAdminUsersPagesJoin < ActiveRecord::Migration[5.0]\n  def up\n    # \u4e3b\u30ad\u30fc\u306f\u4e0d\u8981\u306e\u305f\u3081id: false\u30aa\u30d7\u30b7\u30e7\u30f3\u3092\u8ffd\u52a0\n    create_table :admin_users_pages, id: false do |t|\n      t.integer \"admin_user_id\"\n      t.integer \"page_id\"\n    end\n    # \u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u3092\u4e21\u65b9\u306e\u5916\u90e8\u30ad\u30fc\u306b\u8ffd\u52a0\n    add_index(\"admin_users_pages\", [\"admin_user_id\", \"page_id\"])\n  end\n\n  def down\n    drop_table :admin_users_pages\n  end\nend\n\n\n\u5916\u90e8\u30ad\u30fc\u306b\u5408\u308f\u305b\u3066has_and_belongs_to_many\u3092\u53cc\u65b9\u306e\u30e2\u30c7\u30eb\u306b\u8a18\u8ff0\u3059\u308b\u3002\n\nmodels/admin_user.rb\nclass AdminUser < ApplicationRecord\n  has_and_belongs_to_many :page\nend\n\n\n\n\nmodels/page.rb\nclass Page < ApplicationRecord\n  belongs_to :subject, {optional: true}\n  has_and_belongs_to_many :admin_users\n\n  # \u306a\u304a\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306bjoin\u30c6\u30fc\u30d6\u30eb\u3092\u6307\u5b9a\u3059\u308b\u3053\u3068\u3082\u3067\u304d\u308b\u304c\u3001\n  # \u898f\u7d04\u306b\u305d\u3063\u3066\u8a18\u8ff0\u3057\u3066\u3044\u308b\u305f\u3081\u4e0d\u8981\n  # has_and_belongs_to_many :admin_users, join_table: 'admin_users_pages'\nend\n\n\n\u3059\u308b\u3068\u3001admin_user.pages\u3068page.admin_users\u304c\u4f7f\u7528\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u308b\uff01\n\n45. Many to many associations Rich\n\n\u30ea\u30c3\u30c1\u306aMany-to-many \u2192 JOIN\u30c6\u30fc\u30d6\u30eb + \u4ed6\u306e\u30c7\u30fc\u30bf\n\n\nJOIN\u30c6\u30fc\u30d6\u30eb + \u4ed6\u306e\u30c7\u30fc\u30bf\n\n\uff12\u3064\u306e\u5916\u90e8\u30ad\u30fc\uff1b\u3000\u3068\u3082\u306b\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u3092\u4ed8\u4e0e\n\u4e3b\u30ad\u30fc\u304c\u5fc5\u8981\n\nJOIN\u30c6\u30fc\u30d6\u30eb\u306b\u5bfe\u5fdc\u3059\u308b\u30e2\u30c7\u30eb\u3092\u4f5c\u308b\n\n\n\n\u547d\u540d\u898f\u5247\n\n\u7279\u306b\u6c7a\u307e\u308a\u306f\u306a\u3044\u304c\u3001-ments\u307e\u305f\u306f-ships\u3067\u7d42\u308f\u308b\u5358\u8a9e\u304c\u591a\u3044\n\n\n\n\n\u4f8b\n\n\u4ee5\u4e0b\u306e\u30a2\u30bd\u30b7\u30a8\u30fc\u30b7\u30e7\u30f3\u3092\u8003\u3048\u308b\n\n\nAdminUser has_many :section_edits\n\nSectionEdit belongs_to :admin_user\n\nSection has_many :section_edits\n\nSectionEdit belongs_to :section\n\n\n\n\n\u307e\u305a\u3001\u30ea\u30c3\u30c1\u306aJOIN\u30c6\u30fc\u30d6\u30eb\u4f5c\u6210\u306e\u305f\u3081\u306emigration\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u6210\n\nrails generate migration SectionEdit\n\n\u6b21\u306b\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306b\n\n\u4e3b\u30ad\u30fc\n\u5916\u90e8\u30ad\u30fc\u00d7\uff12\n\n\nadmin_user_id, section_id\n\n\n\u4ed6\u306e\u8981\u7d20\n\n\nsummary\n\n\n\n\u3092\u6301\u3064\u30c6\u30fc\u30d6\u30eb\u3092\u4f5c\u6210\u3002\n\ndb/migrate/20170106082225_create_section_edits.rb\nclass CreateSectionEdits < ActiveRecord::Migration[5.0]\n  def up\n    create_table :section_edits do |t|\n      t.integer 'admin_user_id'\n      t.integer 'section_id'\n      t.string 'summary'\n      t.timestamps\n    end\n    add_index('section_edits', %w(admin_user_id section_id))\n  end\n\n  def down\n    drop_table :section_edits\n  end\nend\n\n\n\u305d\u3057\u3066\u3001\u305d\u308c\u305e\u308c\u306e\u30e2\u30c7\u30eb\u306b\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u30a2\u30bd\u30b7\u30a8\u30fc\u30b7\u30e7\u30f3\u3092\u5b9a\u7fa9\u3002\n\nadmin_user.rb\n\n\nhas_many :section_edits\n\n\nsection.rb\n\n\nhas_many :section_edits\n\n\nsection_edit.rb\n\n\nbelongs_to :admin_user\nbelongs_to :section\n\n\n\n\u3059\u308b\u3068\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u6271\u3048\u308b\u3002\n\n# SectionEdit\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u3092\u4f5c\u6210\u3059\u308b\n# \u30dd\u30a4\u30f3\u30c8\u306f\u3001\u3053\u3053\u3067admin_user\u3068section\u3068\u306e\u95a2\u9023\u6027\u3082\u6e21\u3057\u3066\u3042\u3052\u308b\u3053\u3068\u3002\nirb(main):028:0> edit = SectionEdit.new(summary: \"Test Edit\", admin_user: me, section: section)\n=> #<SectionEdit id: nil, admin_user_id: 1, section_id: 1, summary: \"Test Edit\", created_at: nil, updated_at: nil>\nirb(main):029:0> edit.save\n   (0.2ms)  BEGIN\n  SQL (0.4ms)  INSERT INTO `section_edits` (`admin_user_id`, `section_id`, `summary`, `created_at`, `updated_at`) VALUES (1, 1, 'Test Edit', '2017-01-06 09:14:14', '2017-01-06 09:14:14')\n   (34.2ms)  COMMIT\n=> true\n\n# AdminUser\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u304b\u3089\u7d10\u4ed8\u3044\u305fsection_edits\u306b\u30a2\u30af\u30bb\u30b9\n# \uff08\u3053\u3053\u3067true\u5f15\u6570\u3092\u6e21\u3057\u3066\u3042\u3052\u308b\u3068\u3001section_edits\u30c6\u30fc\u30d6\u30eb\u306e\u30ea\u30ed\u30fc\u30c9\u304c\u884c\u308f\u308c\u308b\u3002\uff09\nirb(main):031:0> me.section_edits(true)\nDEPRECATION WARNING: Passing an argument to force an association to reload is now deprecated and will be removed in Rails 5.1. Please call `reload` on the result collection proxy instead. (called from irb_binding at (irb):31)\n  SectionEdit Load (1.1ms)  SELECT `section_edits`.* FROM `section_edits` WHERE `section_edits`.`admin_user_id` = 1\n=> #<ActiveRecord::Associations::CollectionProxy [#<SectionEdit id: 1, admin_user_id: 1, section_id: 1, summary: \"Test Edit\", created_at: \"2017-01-06 09:14:14\", updated_at: \"2017-01-06 09:14:14\">]>\n\n# Section\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u304b\u3089\u7d10\u4ed8\u3044\u305fsection_edits\u306b\u30a2\u30af\u30bb\u30b9\nirb(main):032:0> section.section_edits\n=> #<ActiveRecord::Associations::CollectionProxy [#<SectionEdit id: nil, admin_user_id: nil, section_id: 1, summary: \"Test edit\", created_at: nil, updated_at: nil>]>\n\n\n46. Traversing a Rich Association\n\ntraverse: \u6a2a\u65ad\u3059\u308b\n\n\nthrough\u30e1\u30bd\u30c3\u30c9\n\u30b7\u30f3\u30d7\u30eb\u306aJOIN\u30c6\u30fc\u30d6\u30eb\u306e\u5834\u5408\u3001admin_user.pages\u3068page.admin_users\u306a\u3069\u3068\u95a2\u9023\u4ed8\u3044\u305f\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\uff11\u30e1\u30bd\u30c3\u30c9\u3067\u53d6\u5f97\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u305f\u3002\n\u3057\u304b\u3057\u3001\u30ea\u30c3\u30c1\u306aJOIN\u30c6\u30fc\u30d6\u30eb\u306e\u5834\u5408\u3001\u305d\u308c\u3092\u5b9f\u73fe\u3059\u308b\u306b\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306bthrough\u30e1\u30bd\u30c3\u30c9\u3067\u6307\u5b9a\u3059\u308b\u5fc5\u8981\u304c\u3042\u308b\u3002\n\nadmin_user.rb\n\n\nhas_many :sections, through: :section_edits\n\n\nsection.rb\n\n\nhas_many :admin_users, through: :section_edits\n\n\n\n\n47. CRUD\n\nRails\u306b\u304a\u3051\u308bCRUD\n\u3053\u308c\u307e\u3067\u3001Rails\u30b3\u30f3\u30bd\u30fc\u30eb\u304b\u3089\u76f4\u63a5\u30e2\u30c7\u30eb\u3068\u3084\u308a\u3068\u308a\u3057\u3066\u304d\u305f\u304c\u3001\u305d\u308c\u3092\u30b3\u30f3\u30c8\u30ed\u30fc\u30e9\u304b\u3089\u3001\u3064\u307e\u308a\u30d6\u30e9\u30a6\u30b6\u304b\u3089\u884c\u3048\u308b\u3088\u3046\u306b\u3059\u308b\u65b9\u6cd5\u3092\u8ff0\u3079\u308b\u3002\nCRUD\u306e\uff14\u3064\u306e\u30a2\u30af\u30b7\u30e7\u30f3\u305d\u308c\u305e\u308c\u306b\u5bfe\u3057Rails\u306e\u547d\u540d\u898f\u5247\u304c\u3042\u308b\u306e\u3067\u305d\u308c\u306b\u5f93\u3046\u3068\u3088\u3044\u3002\n\n\n\u30b3\u30f3\u30c8\u30ed\u30fc\u30e9\u306e\u751f\u6210\n\n\nrails generate controller Subjects index show new edit delete\n\nController\u306f\u8907\u6570\u5f62\n\n\nView\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u304c\u5fc5\u8981\u306a\u30a2\u30af\u30b7\u30e7\u30f3\u3092\u5f8c\u7f6e\u5217\u6319\u3059\u308b\n\n\n\n\n48. REST\n\nREST\u3068\u306f\uff1f\n\nRepresentational\u3000State Transfer\u306e\u7565\n\u300c\u624b\u7d9a\u304d\u300d\u3092\u5b9f\u884c\u3059\u308b\u306e\u3067\u306a\u304f\u3001\u30ea\u30bd\u30fc\u30b9\uff1dDB\u306e\u72b6\u614b\u3092\u5909\u3048\u308b\n\n\nRails\u306b\u304a\u3051\u308bREST\u8a2d\u8a08\n\n\u30ea\u30bd\u30fc\u30b9\u306b\u30a2\u30af\u30bb\u30b9\u3059\u308b\u30b3\u30fc\u30c9\u3092\u8a2d\u8a08\u3059\u308b\n\n\nRails\u306eMVC\u30d5\u30ec\u30fc\u30e0\u30ef\u30fc\u30af\u3067\u306f\u65e2\u306b\u5b9f\u73fe\u3055\u308c\u3066\u3044\u308b\n\n\n\u30ea\u30bd\u30fc\u30b9\u3068\u3084\u308a\u3068\u308a\u3059\u308bHTML\u30d7\u30ed\u30c8\u30b3\u30eb\u3092\u5b66\u3076\n\n\nHTML\u30d7\u30ed\u30c8\u30b3\u30eb\u3068CRUD\u30a2\u30af\u30b7\u30e7\u30f3\u306e\u5bfe\u5fdc\u95a2\u4fc2\u3092\u5b66\u3076\n\n\n\u30b3\u30f3\u30c8\u30ed\u30fc\u30e9\u30a2\u30af\u30b7\u30e7\u30f3\u3068\u65b0\u3057\u3044URL\u3092\u7d10\u4ed8\u3051\u308b\n\n\nroutes.rb\u3092\u3044\u3058\u308b\n\n\n\u30ea\u30f3\u30af\u3084\u30d5\u30a9\u30fc\u30e0\u3092\u65b0\u3057\u3044URL\u306b\u9069\u5fdc\u3055\u305b\u308b\n\n\nResourceful routes\u3092\u4f7f\u3046\n\n\n\n\nREST\u3067\u306eHTTP\u30ea\u30af\u30a8\u30b9\u30c8\n\n\nCreate, Update, Delete\u3059\u3079\u3066\u306b\u5bfe\u3057\u3066POST\u30ea\u30af\u30a8\u30b9\u30c8\u3067\u5bfe\u5fdc\u3059\u308b\u5834\u5408\u3082\u3042\u308b\u304c\u3001REST\u3067\u306fPOST\u30ea\u30af\u30a8\u30b9\u30c8\u306fCreate\u306b\u306e\u307f\u4f7f\u7528\u3055\u308c\u308b\n\n\nPOST\u306f\u57fa\u672c\u7684\u306b\uff11\u5ea6\u306e\u307f\u306e\u5b9f\u884c\u3092\u524d\u63d0\u3068\u3057\u3066\u3044\u308b\nPATCH, DELETE\u306f\u4f55\u5ea6\u5b9f\u884c\u3055\u308c\u3066\u3082\u5dee\u3057\u969c\u308a\u306a\u3044\n\n\n\n\nRails\u30a2\u30af\u30b7\u30e7\u30f3 vs HTTP\u30ea\u30af\u30a8\u30b9\u30c8\n\n\n49. Resourceful Routes\n\n\u306a\u305cResourceful Routes\u3092\u4f7f\u3046\u306e\u304b\n\nRails\u306e\u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u3042\u308b\nREST\u306b\u6700\u9069\u5316\u3055\u308c\u3066\u3044\u308b\n\u30b7\u30f3\u30d7\u30eb\u3067\u4e00\u8cab\u6027\u306e\u9ad8\u3044\u6574\u7406\u3055\u308c\u305f\u69cb\u9020\n\u9ad8\u3044\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\n\u307b\u3068\u3093\u3069\u30d7\u30edRails\u30a8\u30f3\u30b8\u30cb\u30a2\u304c\u4f7f\u7528\nResourceful Helper\u304c\u4f7f\u3048\u308b\uff08\u6b21\u306e\u7ae0\uff09\n\n\nResourceful Routes\u3067\u5b9a\u7fa9\u3055\u308c\u308bURL\n\n\nindex\u3068create\u3001update\u3068destroy\u306e\u30a2\u30af\u30b7\u30e7\u30f3\u306b\u5bfe\u3059\u308bURL\u304c\u540c\u4e00\u3060\u304c\u3001\u4f7f\u7528\u3055\u308c\u308bHTTP\u30d7\u30ed\u30c8\u30b3\u30eb\u3067\u533a\u5225\u3059\u308b\u3002\n\n\nResourceful Routes\u306e\u8a18\u6cd5\n# \u3044\u304f\u3064\u304b\u306e\u30a2\u30af\u30b7\u30e7\u30f3\u3092\u9664\u5916\u3059\u308b\nresources :admin_users, except: [:show]\n# \u3044\u304f\u3064\u304b\u306e\u30a2\u30af\u30b7\u30e7\u30f3\u306e\u307f\u306b\u3059\u308b\nresources :products, only: [:index, :show]\n# \u30a2\u30af\u30b7\u30e7\u30f3\u3092\u8ffd\u52a0\u3059\u308b\nresources :subjects do\n\n  # member\u306f\u30a2\u30c9\u30ec\u30b9\u306bid\u30d1\u30e9\u30e1\u30fc\u30bf\u3092\u6301\u3064\n  member do\n    get :delete\n  end\n\n  # collection\u306f\u30a2\u30c9\u30ec\u30b9\u306bid\u30d1\u30e9\u30e1\u30fc\u30bf\u3092\u6301\u305f\u306a\u3044\n  collection do\n    get :export\n  end\nend\n\n\n50. Resourceful URL helpers\n\n\u4eca\u307e\u3067\n\n<%= link_to('hoge', {action: 'show', id: @subject.id}) %>\n\n\u306a\u3069\u3068\u66f8\u3044\u3066\u3044\u305f\u3082\u306e\u3092\u3001\u4e0a\u8a18\u306e\u66f8\u5f0f\u306b\u5f93\u3063\u3066\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u66f8\u304d\u76f4\u3059\u3053\u3068\u304c\u3067\u304d\u308b\u3002\n\n<%= link_to('hoge', subject_path(@subject.id)) %>\n\n# \u8cc7\u6599\n\n- \u53c2\u7167\u52d5\u753b\n - [Ruby on Rails 5 - Tutorial](https://www.youtube.com/watch?v=cvYVpMK_Vv4&list=PLskZP4iE0Xzb7tp95ruIxJnXW12lOzeLh)\n- Git \u30ec\u30dd\u30b8\u30c8\u30ea\n - [honake/simple_cms](https://www.youtube.com/watch?v=cvYVpMK_Vv4&list=PLskZP4iE0Xzb7tp95ruIxJnXW12lOzeLh)\n- \u307e\u3068\u3081\u306e\u307e\u3068\u3081\n - [\u3010Rails\u3092\u30ad\u30bd\u304b\u3089\u518d\u5b66\u7fd2\u3011Rails 5 Tutorials \u5168\u4e00\u89a7](http://qiita.com/ekanoh/items/fa80ad6519f30b064acc)\n\n# \u307e\u3068\u3081\n\n## 41. One to one associations\n\n### \u30a2\u30bd\u30b7\u30a8\u30fc\u30b7\u30e7\u30f3\u306e\u30dd\u30a4\u30f3\u30c8\n\n- `belongs_to`\u3092\u8a18\u8ff0\u3059\u308b\u30af\u30e9\u30b9\u3000\uff1d\u3000\u5916\u90e8\u30ad\u30fc\u3092\u4fdd\u6709\u3057\u3066\u3044\u308b\n- `belongs_to`\u3092\u8a18\u8ff0\u3059\u308b \uff1d `has one (many)`\u3082\u8a18\u8ff0\u3059\u308b\n\n```models/page.rb\nclass Page < ApplicationRecord\n  belongs_to :subject\nend\n```\n\n```models/subject.rb\nclass Subject < ApplicationRecord\n  has_one :page\nend\n```\n\n### One-to-one\u306e\u6319\u52d5\n\n```irb\n# find\u3067subject\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u3092\u53d6\u5f97\nirb(main):001:0> subject = Subject.find(1)\n\n# first_page\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u3092\u4f5c\u6210\uff08DB\u306b\u4fdd\u5b58\u306f\u3055\u308c\u3066\u3044\u306a\u3044\uff09\nirb(main):007:0> first_page = Page.new(name: \"First Page\", permalink: \"first\",\nirb(main):008:1* position: 1, visible: false, created_at: nil, updated_at: nil)\n\n# has_one\u3067\u5b9a\u7fa9\u3057\u305fpage\u3092\u4f7f\u3044\u3001\n# subjects\u30c6\u30fc\u30d6\u30eb\u306e\u5916\u90e8\u30ad\u30fcpage_id\u306b\u5bfe\u5fdc\u3059\u308bPage\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u3068\u3057\u3066first_page\u3092\u4ee3\u5165\u3059\u308b\nirb(main):024:0> subject.page = first_page\n   (0.2ms)  BEGIN\n  SQL (5.0ms)  INSERT INTO `pages` (`subject_id`, `name`, `permalink`, `position`, `created_at`, `updated_at`) VALUES (1, 'First Page', 'first', 1, '2017-01-05 17:15:38', '2017-01-05 17:15:38')\n   (22.5ms)  COMMIT\n=> #<Page id: 1, subject_id: 1, name: \"First Page\", permalink: \"first\", position: 1, visible: false, created_at: \"2017-01-05 17:15:38\", updated_at: \"2017-01-05 17:15:38\">\n\n# \u3053\u306e\u30bf\u30a4\u30df\u30f3\u30b0\u3067first_page\u3082DB\u306b\u4fdd\u5b58\u3055\u308c\u3066\u3044\u308b\nirb(main):025:0> Page.all\n  Page Load (0.4ms)  SELECT `pages`.* FROM `pages`\n=> #<ActiveRecord::Relation [#<Page id: 1, subject_id: 1, name: \"First Page\", permalink: \"first\", position: 1, visible: false, created_at: \"2017-01-05 17:15:38\", updated_at: \"2017-01-05 17:15:38\">]>\n\n# first_page\u306e\u5916\u90e8\u30ad\u30fc\u3082\u66f4\u65b0\u3055\u308c\u3066\u3044\u308b\nirb(main):026:0> first_page.subject_id\n=> 1\n\n# belongs_to\u3067\u5b9a\u7fa9\u3057\u305fsubject\u3092\u4f7f\u3044\u3001\n# pages\u30c6\u30fc\u30d6\u30eb\u306e\u5916\u90e8\u30ad\u30fcsubject_id\u306b\u5bfe\u5fdc\u3059\u308bSubject\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u3092\u53d6\u5f97\u3059\u308b\nirb(main):027:0> first_page.subject\n=> #<Subject id: 1, name: \"Initial Subject\", position: \"1\", visible: true, created_at: \"2017-01-05 07:36:43\", updated_at: \"2017-01-05 07:44:37\">\n```\n\n\n## 42. One to many associations\n\n### One-to-many\u306e\u30dd\u30a4\u30f3\u30c8\n\n- one-to-one\u3088\u308a\u3082\u983b\u7e41\u306b\u4f7f\u7528\u3055\u308c\u308b\n- \u30ea\u30ec\u30fc\u30b7\u30e7\u30f3\u306f\u8907\u6570\u5f62\n - eg) `Photographer has_many :photographs`\n- \u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306e\u914d\u5217\u3092\u8fd4\u3059\n\n```models/page.rb\nclass Page < ApplicationRecord\n  belongs_to :subject\nend\n```\n\n```models/subject.rb\nclass Subject < ApplicationRecord\n  has_many :pages\nend\n```\n\n### One-to-many\u3067\u3088\u304f\u4f7f\u3046\u30e1\u30bd\u30c3\u30c9\n\n\u307b\u3068\u3093\u3069one-to-one\u3068\u6319\u52d5\u306f\u540c\u3058\u306a\u306e\u3067\u3001\u983b\u7e41\u306b\u4f7f\u3046\u30e1\u30bd\u30c3\u30c9\u3060\u3051\u78ba\u8a8d\u3057\u3066\u304a\u304f\u3002\n\n```ruby\nsubject.pages\nsubject.pages << page\nsubject.pages = [page,page,page]\nsubject.pages.delete(page)\nsubject.pages.destroy(page)\nsubject.pages.clear\nsubject.pages.empty?\nsubject.pages.size\n```\n\n## 43. Belongs to presence validation\n\n- Rails 5.0\u3067\u5909\u66f4\u3055\u308c\u305f\u30b7\u30b9\u30c6\u30e0\n- `belongs_to`\u306f\u30c7\u30d5\u30a9\u30eb\u30c8\u3067**\u5fc5\u9808**\n - disable\u3057\u305f\u3044 \u2192 config\u3092\u3044\u3058\u308b or **\u30b1\u30fc\u30b9\u30d0\u30a4\u30b1\u30fc\u30b9\u3067\u5bfe\u5fdc**\n- ActiveRecord\u306f\u5bfe\u5fdc\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u304c\u5b58\u5728\u3059\u308b\u304bvalidate\u3059\u308b\n - \u3064\u307e\u308a\u3001\u5bfe\u5fdcsubject\u304c\u5b58\u5728\u3057\u306a\u3051\u308c\u3070page\u3092save\u3067\u304d\u306a\u3044\n\n### \u30b1\u30fc\u30b9\u30d0\u30a4\u30b1\u30fc\u30b9\u3067\u5bfe\u5fdc\u3059\u308b\u65b9\u6cd5\n\n```models/page.rb\nclass Page < ApplicationRecord\n  belongs_to :subject, {optional: true}\nend\n```\n\n```irb\n\n# subject_id\u304cnil\u306epage\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u4f5c\u6210\nirb(main):001:0> page = Page.new(name: \"No subject assigned\")\n=> #<Page id: nil, subject_id: nil, name: \"No subject assigned\", permalink: nil, position: nil, visible: false, created_at: nil, updated_at: nil>\n\n# optional: true\u306b\u3088\u308asave\u304c\u53ef\u80fd\nirb(main):002:0> page.save\n   (0.4ms)  BEGIN\n  SQL (1.1ms)  INSERT INTO `pages` (`name`, `created_at`, `updated_at`) VALUES ('No subject assigned', '2017-01-06 06:55:42', '2017-01-06 06:55:42')\n   (37.8ms)  COMMIT\n=> true\n```\n\n## 44. Many to many associations Simple\n\n### \u30b7\u30f3\u30d7\u30eb\u306aMany-to-many \u2192 JOIN\u30c6\u30fc\u30d6\u30eb\n\n- JOIN\u30c6\u30fc\u30d6\u30eb\n - \uff12\u3064\u306e\u5916\u90e8\u30ad\u30fc\uff1b\u3000\u3068\u3082\u306b\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u3092\u4ed8\u4e0e\n - \u4e3b\u30ad\u30fc\u306f\u4e0d\u8981\n- \u547d\u540d\u898f\u5247\n - first_table + _ + second_table\u3068\u3059\u308b\u3068\u3088\u3044\n - \u8f9e\u66f8\u9806\u306b\u4e26\u3079\u308b\u3068\u3088\u3044\n\n### \u4f8b\n- \u4ee5\u4e0b\u306e\u30a2\u30bd\u30b7\u30a8\u30fc\u30b7\u30e7\u30f3\u3092\u8003\u3048\u308b\n - AdminUser `has_and_belongs_to_many :pages`\n - Pages `has_and_belongs_to_many :admin_users`\n\n\u307e\u305a\u3001JOIN\u30c6\u30fc\u30d6\u30eb\u4f5c\u6210\u306e\u305f\u3081\u306emigration\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u6210\n\n- `rails generate migration CreateAdminUsersPagesJoin`\n\n\u751f\u6210\u3055\u308c\u305fmigration\u30d5\u30a1\u30a4\u30eb\u3092\u4ee5\u4e0b\u306e\u5f62\u306b\u3059\u308b\u3002\n\n```db/migrate/20170106070749_create_admin_users_pages_join.rb\nclass CreateAdminUsersPagesJoin < ActiveRecord::Migration[5.0]\n  def up\n    # \u4e3b\u30ad\u30fc\u306f\u4e0d\u8981\u306e\u305f\u3081id: false\u30aa\u30d7\u30b7\u30e7\u30f3\u3092\u8ffd\u52a0\n    create_table :admin_users_pages, id: false do |t|\n      t.integer \"admin_user_id\"\n      t.integer \"page_id\"\n    end\n    # \u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u3092\u4e21\u65b9\u306e\u5916\u90e8\u30ad\u30fc\u306b\u8ffd\u52a0\n    add_index(\"admin_users_pages\", [\"admin_user_id\", \"page_id\"])\n  end\n\n  def down\n    drop_table :admin_users_pages\n  end\nend\n```\n\n\u5916\u90e8\u30ad\u30fc\u306b\u5408\u308f\u305b\u3066has_and_belongs_to_many\u3092\u53cc\u65b9\u306e\u30e2\u30c7\u30eb\u306b\u8a18\u8ff0\u3059\u308b\u3002\n\n```models/admin_user.rb\nclass AdminUser < ApplicationRecord\n  has_and_belongs_to_many :page\nend\n\n```\n\n```models/page.rb\nclass Page < ApplicationRecord\n  belongs_to :subject, {optional: true}\n  has_and_belongs_to_many :admin_users\n\n  # \u306a\u304a\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306bjoin\u30c6\u30fc\u30d6\u30eb\u3092\u6307\u5b9a\u3059\u308b\u3053\u3068\u3082\u3067\u304d\u308b\u304c\u3001\n  # \u898f\u7d04\u306b\u305d\u3063\u3066\u8a18\u8ff0\u3057\u3066\u3044\u308b\u305f\u3081\u4e0d\u8981\n  # has_and_belongs_to_many :admin_users, join_table: 'admin_users_pages'\nend\n```\n\n\u3059\u308b\u3068\u3001`admin_user.pages`\u3068`page.admin_users`\u304c\u4f7f\u7528\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u308b\uff01\n\n## 45. Many to many associations Rich\n\n### \u30ea\u30c3\u30c1\u306aMany-to-many \u2192 JOIN\u30c6\u30fc\u30d6\u30eb + \u4ed6\u306e\u30c7\u30fc\u30bf\n\n- JOIN\u30c6\u30fc\u30d6\u30eb + \u4ed6\u306e\u30c7\u30fc\u30bf\n - \uff12\u3064\u306e\u5916\u90e8\u30ad\u30fc\uff1b\u3000\u3068\u3082\u306b\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u3092\u4ed8\u4e0e\n - \u4e3b\u30ad\u30fc\u304c**\u5fc5\u8981**\n - **JOIN\u30c6\u30fc\u30d6\u30eb\u306b\u5bfe\u5fdc\u3059\u308b\u30e2\u30c7\u30eb\u3092\u4f5c\u308b**\n\n- \u547d\u540d\u898f\u5247\n - \u7279\u306b\u6c7a\u307e\u308a\u306f\u306a\u3044\u304c\u3001-ments\u307e\u305f\u306f-ships\u3067\u7d42\u308f\u308b\u5358\u8a9e\u304c\u591a\u3044\n\n### \u4f8b\n- \u4ee5\u4e0b\u306e\u30a2\u30bd\u30b7\u30a8\u30fc\u30b7\u30e7\u30f3\u3092\u8003\u3048\u308b\n - AdminUser `has_many :section_edits`\n - SectionEdit `belongs_to :admin_user`\n - Section `has_many :section_edits`\n - SectionEdit `belongs_to :section`\n\n\u307e\u305a\u3001\u30ea\u30c3\u30c1\u306aJOIN\u30c6\u30fc\u30d6\u30eb\u4f5c\u6210\u306e\u305f\u3081\u306emigration\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u6210\n\n- `rails generate migration SectionEdit`\n\n\u6b21\u306b\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306b\n\n- \u4e3b\u30ad\u30fc\n- \u5916\u90e8\u30ad\u30fc\u00d7\uff12\n - admin_user_id, section_id\n- \u4ed6\u306e\u8981\u7d20\n - summary\n\n\u3092\u6301\u3064\u30c6\u30fc\u30d6\u30eb\u3092\u4f5c\u6210\u3002\n\n```db/migrate/20170106082225_create_section_edits.rb\nclass CreateSectionEdits < ActiveRecord::Migration[5.0]\n  def up\n    create_table :section_edits do |t|\n      t.integer 'admin_user_id'\n      t.integer 'section_id'\n      t.string 'summary'\n      t.timestamps\n    end\n    add_index('section_edits', %w(admin_user_id section_id))\n  end\n\n  def down\n    drop_table :section_edits\n  end\nend\n```\n\n\u305d\u3057\u3066\u3001\u305d\u308c\u305e\u308c\u306e\u30e2\u30c7\u30eb\u306b\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u30a2\u30bd\u30b7\u30a8\u30fc\u30b7\u30e7\u30f3\u3092\u5b9a\u7fa9\u3002\n\n- admin_user.rb\n - `has_many :section_edits`\n- section.rb\n - `has_many :section_edits`\n- section_edit.rb\n - `belongs_to :admin_user`\n - `belongs_to :section`\n\n\u3059\u308b\u3068\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u6271\u3048\u308b\u3002\n\n```irb\n\n# SectionEdit\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u3092\u4f5c\u6210\u3059\u308b\n# \u30dd\u30a4\u30f3\u30c8\u306f\u3001\u3053\u3053\u3067admin_user\u3068section\u3068\u306e\u95a2\u9023\u6027\u3082\u6e21\u3057\u3066\u3042\u3052\u308b\u3053\u3068\u3002\nirb(main):028:0> edit = SectionEdit.new(summary: \"Test Edit\", admin_user: me, section: section)\n=> #<SectionEdit id: nil, admin_user_id: 1, section_id: 1, summary: \"Test Edit\", created_at: nil, updated_at: nil>\nirb(main):029:0> edit.save\n   (0.2ms)  BEGIN\n  SQL (0.4ms)  INSERT INTO `section_edits` (`admin_user_id`, `section_id`, `summary`, `created_at`, `updated_at`) VALUES (1, 1, 'Test Edit', '2017-01-06 09:14:14', '2017-01-06 09:14:14')\n   (34.2ms)  COMMIT\n=> true\n\n# AdminUser\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u304b\u3089\u7d10\u4ed8\u3044\u305fsection_edits\u306b\u30a2\u30af\u30bb\u30b9\n# \uff08\u3053\u3053\u3067true\u5f15\u6570\u3092\u6e21\u3057\u3066\u3042\u3052\u308b\u3068\u3001section_edits\u30c6\u30fc\u30d6\u30eb\u306e\u30ea\u30ed\u30fc\u30c9\u304c\u884c\u308f\u308c\u308b\u3002\uff09\nirb(main):031:0> me.section_edits(true)\nDEPRECATION WARNING: Passing an argument to force an association to reload is now deprecated and will be removed in Rails 5.1. Please call `reload` on the result collection proxy instead. (called from irb_binding at (irb):31)\n  SectionEdit Load (1.1ms)  SELECT `section_edits`.* FROM `section_edits` WHERE `section_edits`.`admin_user_id` = 1\n=> #<ActiveRecord::Associations::CollectionProxy [#<SectionEdit id: 1, admin_user_id: 1, section_id: 1, summary: \"Test Edit\", created_at: \"2017-01-06 09:14:14\", updated_at: \"2017-01-06 09:14:14\">]>\n\n# Section\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u304b\u3089\u7d10\u4ed8\u3044\u305fsection_edits\u306b\u30a2\u30af\u30bb\u30b9\nirb(main):032:0> section.section_edits\n=> #<ActiveRecord::Associations::CollectionProxy [#<SectionEdit id: nil, admin_user_id: nil, section_id: 1, summary: \"Test edit\", created_at: nil, updated_at: nil>]>\n```\n\n## 46. Traversing a Rich Association\n\n* traverse: \u6a2a\u65ad\u3059\u308b\n\n### through\u30e1\u30bd\u30c3\u30c9\n\n\u30b7\u30f3\u30d7\u30eb\u306aJOIN\u30c6\u30fc\u30d6\u30eb\u306e\u5834\u5408\u3001`admin_user.pages`\u3068`page.admin_users`\u306a\u3069\u3068\u95a2\u9023\u4ed8\u3044\u305f\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\uff11\u30e1\u30bd\u30c3\u30c9\u3067\u53d6\u5f97\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u305f\u3002\n\u3057\u304b\u3057\u3001\u30ea\u30c3\u30c1\u306aJOIN\u30c6\u30fc\u30d6\u30eb\u306e\u5834\u5408\u3001\u305d\u308c\u3092\u5b9f\u73fe\u3059\u308b\u306b\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306bthrough\u30e1\u30bd\u30c3\u30c9\u3067\u6307\u5b9a\u3059\u308b\u5fc5\u8981\u304c\u3042\u308b\u3002\n\n- admin_user.rb\n - `has_many :sections, through: :section_edits`\n- section.rb\n - `has_many :admin_users, through: :section_edits`\n\n## 47. CRUD\n\n### Rails\u306b\u304a\u3051\u308bCRUD\n\n\u3053\u308c\u307e\u3067\u3001Rails\u30b3\u30f3\u30bd\u30fc\u30eb\u304b\u3089\u76f4\u63a5\u30e2\u30c7\u30eb\u3068\u3084\u308a\u3068\u308a\u3057\u3066\u304d\u305f\u304c\u3001\u305d\u308c\u3092\u30b3\u30f3\u30c8\u30ed\u30fc\u30e9\u304b\u3089\u3001\u3064\u307e\u308a\u30d6\u30e9\u30a6\u30b6\u304b\u3089\u884c\u3048\u308b\u3088\u3046\u306b\u3059\u308b\u65b9\u6cd5\u3092\u8ff0\u3079\u308b\u3002\nCRUD\u306e\uff14\u3064\u306e\u30a2\u30af\u30b7\u30e7\u30f3\u305d\u308c\u305e\u308c\u306b\u5bfe\u3057Rails\u306e\u547d\u540d\u898f\u5247\u304c\u3042\u308b\u306e\u3067\u305d\u308c\u306b\u5f93\u3046\u3068\u3088\u3044\u3002\n\n<img src=\"https://qiita-image-store.s3.amazonaws.com/0/120341/7de1209a-af1a-bf04-cc11-d1d591bab09d.png\" width=600px>\n\n### \u30b3\u30f3\u30c8\u30ed\u30fc\u30e9\u306e\u751f\u6210\n\n- `rails generate controller Subjects index show new edit delete`\n - Controller\u306f**\u8907\u6570\u5f62**\n - **View\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u304c\u5fc5\u8981\u306a\u30a2\u30af\u30b7\u30e7\u30f3**\u3092\u5f8c\u7f6e\u5217\u6319\u3059\u308b\n\n## 48. REST\n\n### REST\u3068\u306f\uff1f\n\n- Representational\u3000State Transfer\u306e\u7565\n- \u300c\u624b\u7d9a\u304d\u300d\u3092\u5b9f\u884c\u3059\u308b\u306e\u3067\u306a\u304f\u3001\u30ea\u30bd\u30fc\u30b9\uff1dDB\u306e\u72b6\u614b\u3092\u5909\u3048\u308b\n\n### Rails\u306b\u304a\u3051\u308bREST\u8a2d\u8a08\n\n1. \u30ea\u30bd\u30fc\u30b9\u306b\u30a2\u30af\u30bb\u30b9\u3059\u308b\u30b3\u30fc\u30c9\u3092\u8a2d\u8a08\u3059\u308b\n - Rails\u306eMVC\u30d5\u30ec\u30fc\u30e0\u30ef\u30fc\u30af\u3067\u306f\u65e2\u306b\u5b9f\u73fe\u3055\u308c\u3066\u3044\u308b\n2. \u30ea\u30bd\u30fc\u30b9\u3068\u3084\u308a\u3068\u308a\u3059\u308bHTML\u30d7\u30ed\u30c8\u30b3\u30eb\u3092\u5b66\u3076\n - HTML\u30d7\u30ed\u30c8\u30b3\u30eb\u3068CRUD\u30a2\u30af\u30b7\u30e7\u30f3\u306e\u5bfe\u5fdc\u95a2\u4fc2\u3092\u5b66\u3076\n3. \u30b3\u30f3\u30c8\u30ed\u30fc\u30e9\u30a2\u30af\u30b7\u30e7\u30f3\u3068\u65b0\u3057\u3044URL\u3092\u7d10\u4ed8\u3051\u308b\n - routes.rb\u3092\u3044\u3058\u308b\n4. \u30ea\u30f3\u30af\u3084\u30d5\u30a9\u30fc\u30e0\u3092\u65b0\u3057\u3044URL\u306b\u9069\u5fdc\u3055\u305b\u308b\n - Resourceful routes\u3092\u4f7f\u3046\n\n### REST\u3067\u306eHTTP\u30ea\u30af\u30a8\u30b9\u30c8\n\n<img src=\"https://qiita-image-store.s3.amazonaws.com/0/120341/e7bf75fc-a172-66a1-bdad-e4d4b902beeb.png\" width=600px>\n\n- Create, Update, Delete\u3059\u3079\u3066\u306b\u5bfe\u3057\u3066POST\u30ea\u30af\u30a8\u30b9\u30c8\u3067\u5bfe\u5fdc\u3059\u308b\u5834\u5408\u3082\u3042\u308b\u304c\u3001REST\u3067\u306fPOST\u30ea\u30af\u30a8\u30b9\u30c8\u306fCreate\u306b\u306e\u307f\u4f7f\u7528\u3055\u308c\u308b\n - POST\u306f\u57fa\u672c\u7684\u306b\uff11\u5ea6\u306e\u307f\u306e\u5b9f\u884c\u3092\u524d\u63d0\u3068\u3057\u3066\u3044\u308b\n - PATCH, DELETE\u306f\u4f55\u5ea6\u5b9f\u884c\u3055\u308c\u3066\u3082\u5dee\u3057\u969c\u308a\u306a\u3044\n\n### Rails\u30a2\u30af\u30b7\u30e7\u30f3 vs HTTP\u30ea\u30af\u30a8\u30b9\u30c8\n\n<img src=\"https://qiita-image-store.s3.amazonaws.com/0/120341/beb4e8b3-78e7-8ee1-5c07-ba7fe9ad486e.png\" width=600px>\n\n## 49. Resourceful Routes\n\n### \u306a\u305cResourceful Routes\u3092\u4f7f\u3046\u306e\u304b\n- Rails\u306e\u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u3042\u308b\n- REST\u306b\u6700\u9069\u5316\u3055\u308c\u3066\u3044\u308b\n- \u30b7\u30f3\u30d7\u30eb\u3067\u4e00\u8cab\u6027\u306e\u9ad8\u3044\u6574\u7406\u3055\u308c\u305f\u69cb\u9020\n- \u9ad8\u3044\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\n- \u307b\u3068\u3093\u3069\u30d7\u30edRails\u30a8\u30f3\u30b8\u30cb\u30a2\u304c\u4f7f\u7528\n- Resourceful Helper\u304c\u4f7f\u3048\u308b\uff08\u6b21\u306e\u7ae0\uff09\n\n## Resourceful Routes\u3067\u5b9a\u7fa9\u3055\u308c\u308bURL\n\n<img src=\"https://qiita-image-store.s3.amazonaws.com/0/120341/b930c340-00bc-696f-915d-fd742694543d.png\" width=600px>\n\n- index\u3068create\u3001update\u3068destroy\u306e\u30a2\u30af\u30b7\u30e7\u30f3\u306b\u5bfe\u3059\u308bURL\u304c\u540c\u4e00\u3060\u304c\u3001\u4f7f\u7528\u3055\u308c\u308bHTTP\u30d7\u30ed\u30c8\u30b3\u30eb\u3067\u533a\u5225\u3059\u308b\u3002\n\n## Resourceful Routes\u306e\u8a18\u6cd5\n\n```ruby\n# \u3044\u304f\u3064\u304b\u306e\u30a2\u30af\u30b7\u30e7\u30f3\u3092\u9664\u5916\u3059\u308b\nresources :admin_users, except: [:show]\n# \u3044\u304f\u3064\u304b\u306e\u30a2\u30af\u30b7\u30e7\u30f3\u306e\u307f\u306b\u3059\u308b\nresources :products, only: [:index, :show]\n# \u30a2\u30af\u30b7\u30e7\u30f3\u3092\u8ffd\u52a0\u3059\u308b\nresources :subjects do\n\n  # member\u306f\u30a2\u30c9\u30ec\u30b9\u306bid\u30d1\u30e9\u30e1\u30fc\u30bf\u3092\u6301\u3064\n  member do\n    get :delete\n  end\n\n  # collection\u306f\u30a2\u30c9\u30ec\u30b9\u306bid\u30d1\u30e9\u30e1\u30fc\u30bf\u3092\u6301\u305f\u306a\u3044\n  collection do\n    get :export\n  end\nend\n```\n\n## 50. Resourceful URL helpers\n\n![image](https://qiita-image-store.s3.amazonaws.com/0/120341/df390305-f315-3eef-b74c-718cdff55ae9.png)\n\n\u4eca\u307e\u3067\n\n- `<%= link_to('hoge', {action: 'show', id: @subject.id}) %>`\n\n\u306a\u3069\u3068\u66f8\u3044\u3066\u3044\u305f\u3082\u306e\u3092\u3001\u4e0a\u8a18\u306e\u66f8\u5f0f\u306b\u5f93\u3063\u3066\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u66f8\u304d\u76f4\u3059\u3053\u3068\u304c\u3067\u304d\u308b\u3002\n\n- `<%= link_to('hoge', subject_path(@subject.id)) %>`\n"}