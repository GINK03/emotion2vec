{"context": "\n\n\u306f\u3058\u3081\u306b\n\nJPA\u3067\u30af\u30a8\u30ea\u30e1\u30bd\u30c3\u30c9\u3092\u4f7f\u7528\u3057\u3066\u3001RepositoryItemReader\u3092\u5b9f\u88c5\u3059\u308b\u3068\u304d\u306e\u5099\u5fd8\u3067\u3059\u3002\n\n\n\u30d0\u30fc\u30b8\u30e7\u30f3\n\npom\u304b\u3089\u629c\u7c8b\u3002\n\n<parent>\n    <groupId>org.springframework.boot</groupId>\n    <artifactId>spring-boot-starter-parent</artifactId>\n    <version>1.4.0.RELEASE</version>\n</parent>\n<dependency>\n    <groupId>org.springframework.data</groupId>\n    <artifactId>spring-data-jpa</artifactId>\n    <version>1.10.2.RELEASE</version>\n</dependency>\n<dependency>\n    <groupId>org.springframework.boot</groupId>\n    <artifactId>spring-boot-starter-batch</artifactId>\n    <version>1.4.0.RELEASE</version>\n</dependency>\n\n\n\u5b9f\u88c5\n\nentity\n\n\u8aac\u660e\u306b\u6700\u4f4e\u9650\u5fc5\u8981\u306a\u7269\u3060\u3051\u3002\n\n\nCompany.java\n@Data\n@Entity\npublic class Company implements Serializable {\n    @Id\n    @GeneratedValue(strategy = GenerationType.IDENTITY)\n    @Column(name=\"company_id\")\n    private int companyId;\n\n    @Column(name=\"category_id\")\n    private int categoryId;\n}\n\n\n\nrepository\n\nfindByCategoryId\u304c\u4eca\u56de\u5bfe\u8c61\u306e\u30af\u30a8\u30ea\u30e1\u30bd\u30c3\u30c9\u3067\u3059\u3002\n\n\nCompanyRepository.java\n@Repository\npublic interface CompanyRepository extends JpaRepository<Company, Integer> {\n    public Page<Company> findByCategoryId(int categoryId, Pageable pageable);\n}\n\n\n\n\u672c\u51e6\u7406\u90e8\n\nBatchConfiguration.java\n@Configuration\n@EnableBatchProcessing\npublic class BatchConfiguration {\n    @Autowired\n    public JobBuilderFactory jobBuilderFactory;\n    @Autowired\n    public StepBuilderFactory stepBuilderFactory;\n    @Autowired\n    CompanyRepository companyRepository;\n\n    @Bean\n    public RepositoryItemReader<Company> reader() {\n        RepositoryItemReader<Company> reader = new RepositoryItemReader<>();\n        reader.setRepository(companyRepository);\n\n        // \u30af\u30a8\u30ea\u30e1\u30bd\u30c3\u30c9\u6307\u5b9a\u3002\u30bf\u30a4\u30d7\u30bb\u30fc\u30d5\u306b\u3057\u305f\u3044\u3002\n        reader.setMethodName(\"findByCategoryId\");\n        // \u30af\u30a8\u30ea\u30e1\u30bd\u30c3\u30c9\u306e\u5f15\u6570\u6307\u5b9a\n        List<Object> arguments = new ArrayList<>();\n        arguments.add(CategoryCode.BANK);\n        reader.setArguments(arguments);\n\n        // \u53d6\u5f97\u7d50\u679c\u306e\u30bd\u30fc\u30c8\n        Map<String, Direction> sort = new HashMap<>();\n        sort.put(\"companyId\", Direction.ASC);\n        reader.setSort(sort);\n\n        return reader;\n    }\n\n// \u4ee5\u964d\u3001\u305d\u306e\u4ed6\u306e\u51e6\u7406\n\n\n\n\u30dd\u30a4\u30f3\u30c8\n\n\u30af\u30a8\u30ea\u30e1\u30bd\u30c3\u30c9\u306fPageable\u3067\u306e\u5b9f\u88c5\u304c\u5fc5\u9808\u306e\u3088\u3046\u3067\u3059\u3002\n\u305f\u3068\u3048\u3070repository\u306e\u5b9f\u88c5\u304c\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u306a\u3063\u3066\u3044\u308b\u3068\u3057\u307e\u3059\u3002\npublic List<Company> findByCategoryId(int categoryId);\n\u3053\u306e\u5b9f\u88c5\u3067\u30d0\u30c3\u30c1\u3092\u5b9f\u884c\u3059\u308b\u3068\u4ee5\u4e0b\u306e\u69d8\u306a\u30a8\u30e9\u30fc\u304c\u51fa\u307e\u3059\u3002\njava.lang.NoSuchMethodException: com.sun.proxy.$Proxy66.findByCategoryId(java.lang.Integer, org.springframework.data.domain.PageRequest)\n\nItemReader\u306e\u5b9f\u88c5\u3067\u3001\u30bd\u30fc\u30c8\u306e\u6307\u5b9a\u3082\u5fc5\u9808\u306e\u3088\u3046\u3067\u3059\u3002\n\u3053\u3061\u3089\u3082\u6307\u5b9a\u3057\u306a\u3044\u3068\u4f8b\u5916\u304c\u767a\u751f\u3057\u307e\u3059\u3002\n\n## \u306f\u3058\u3081\u306b\n* JPA\u3067\u30af\u30a8\u30ea\u30e1\u30bd\u30c3\u30c9\u3092\u4f7f\u7528\u3057\u3066\u3001RepositoryItemReader\u3092\u5b9f\u88c5\u3059\u308b\u3068\u304d\u306e\u5099\u5fd8\u3067\u3059\u3002\n\n## \u30d0\u30fc\u30b8\u30e7\u30f3\n* pom\u304b\u3089\u629c\u7c8b\u3002\n\n```xml\n<parent>\n\t<groupId>org.springframework.boot</groupId>\n\t<artifactId>spring-boot-starter-parent</artifactId>\n\t<version>1.4.0.RELEASE</version>\n</parent>\n<dependency>\n\t<groupId>org.springframework.data</groupId>\n\t<artifactId>spring-data-jpa</artifactId>\n\t<version>1.10.2.RELEASE</version>\n</dependency>\n<dependency>\n\t<groupId>org.springframework.boot</groupId>\n\t<artifactId>spring-boot-starter-batch</artifactId>\n\t<version>1.4.0.RELEASE</version>\n</dependency>\n```\n\n## \u5b9f\u88c5\n\n### entity\n* \u8aac\u660e\u306b\u6700\u4f4e\u9650\u5fc5\u8981\u306a\u7269\u3060\u3051\u3002\n\n```java:Company.java\n@Data\n@Entity\npublic class Company implements Serializable {\n\t@Id\n\t@GeneratedValue(strategy = GenerationType.IDENTITY)\n\t@Column(name=\"company_id\")\n\tprivate int companyId;\n\t\n\t@Column(name=\"category_id\")\n\tprivate int categoryId;\n}\n```\n\n### repository\n* findByCategoryId\u304c\u4eca\u56de\u5bfe\u8c61\u306e\u30af\u30a8\u30ea\u30e1\u30bd\u30c3\u30c9\u3067\u3059\u3002\n\n```java:CompanyRepository.java\n@Repository\npublic interface CompanyRepository extends JpaRepository<Company, Integer> {\n\tpublic Page<Company> findByCategoryId(int categoryId, Pageable pageable);\n}\n```\n\n### \u672c\u51e6\u7406\u90e8\n\n\n```java:BatchConfiguration.java\n@Configuration\n@EnableBatchProcessing\npublic class BatchConfiguration {\n\t@Autowired\n\tpublic JobBuilderFactory jobBuilderFactory;\n\t@Autowired\n\tpublic StepBuilderFactory stepBuilderFactory;\n\t@Autowired\n\tCompanyRepository companyRepository;\n\n\t@Bean\n\tpublic RepositoryItemReader<Company> reader() {\n\t\tRepositoryItemReader<Company> reader = new RepositoryItemReader<>();\n\t\treader.setRepository(companyRepository);\n\n\t\t// \u30af\u30a8\u30ea\u30e1\u30bd\u30c3\u30c9\u6307\u5b9a\u3002\u30bf\u30a4\u30d7\u30bb\u30fc\u30d5\u306b\u3057\u305f\u3044\u3002\n\t\treader.setMethodName(\"findByCategoryId\");\n\t\t// \u30af\u30a8\u30ea\u30e1\u30bd\u30c3\u30c9\u306e\u5f15\u6570\u6307\u5b9a\n\t\tList<Object> arguments = new ArrayList<>();\n\t\targuments.add(CategoryCode.BANK);\n\t\treader.setArguments(arguments);\n\n\t\t// \u53d6\u5f97\u7d50\u679c\u306e\u30bd\u30fc\u30c8\n\t\tMap<String, Direction> sort = new HashMap<>();\n\t\tsort.put(\"companyId\", Direction.ASC);\n\t\treader.setSort(sort);\n\n\t\treturn reader;\n\t}\n\n// \u4ee5\u964d\u3001\u305d\u306e\u4ed6\u306e\u51e6\u7406\n```\n\n### \u30dd\u30a4\u30f3\u30c8\n* \u30af\u30a8\u30ea\u30e1\u30bd\u30c3\u30c9\u306fPageable\u3067\u306e\u5b9f\u88c5\u304c\u5fc5\u9808\u306e\u3088\u3046\u3067\u3059\u3002   \n\u305f\u3068\u3048\u3070repository\u306e\u5b9f\u88c5\u304c\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u306a\u3063\u3066\u3044\u308b\u3068\u3057\u307e\u3059\u3002   \n`public List<Company> findByCategoryId(int categoryId);`   \n\u3053\u306e\u5b9f\u88c5\u3067\u30d0\u30c3\u30c1\u3092\u5b9f\u884c\u3059\u308b\u3068\u4ee5\u4e0b\u306e\u69d8\u306a\u30a8\u30e9\u30fc\u304c\u51fa\u307e\u3059\u3002   \n`java.lang.NoSuchMethodException: com.sun.proxy.$Proxy66.findByCategoryId(java.lang.Integer, org.springframework.data.domain.PageRequest)`\n* ItemReader\u306e\u5b9f\u88c5\u3067\u3001\u30bd\u30fc\u30c8\u306e\u6307\u5b9a\u3082\u5fc5\u9808\u306e\u3088\u3046\u3067\u3059\u3002   \n\u3053\u3061\u3089\u3082\u6307\u5b9a\u3057\u306a\u3044\u3068\u4f8b\u5916\u304c\u767a\u751f\u3057\u307e\u3059\u3002\n", "tags": ["spring-batch", "spring-boot"]}