{"context": " More than 1 year has passed since last update.Due to the rootless feature, original pkg installation would be incomplete.\nOf course, homebrew users should use brew, but this is not an option for MacPorts (or Fink) users.\n\nUsing darwin-x86_64.tar.gz\n\nExtract tar.gz into /opt/crystal\nLink /opt/crystal/bin/crystal and /opt/crystal/embedded/bin/shards to /usr/local/bin.\n\n\nUsing pkg\n\nYou need to modify the pkg to symlink safely.\n\n\nPrepare updatepkgscripts.rb.\nPaste following to crystal-update.rb.\nCall crystal-update.rb updatepkgscripts.rb crystal.pkg.\nNow you can install the pkg safely.\n\n\ncrystal-update.rb\n#!/usr/bin/ruby\n#usage: crystal-update.rb updatepkgscripts.rb crystal.pkg\n\nrequire 'tmpdir'\nDir.mktmpdir{|tmp|\n    system('\"'+ARGV[0]+'\" -x \"'+ARGV[1]+'\" crystal-core.pkg/Scripts \"'+tmp+'\"')\n    File.open(tmp+'/postinstall','wb'){|f|\n        f.write DATA.read\n    }\n    system('\"'+ARGV[0]+'\" -u \"'+ARGV[1]+'\" crystal-core.pkg/Scripts \"'+tmp+'\"')\n}\n\n__END__\n#!/bin/bash\n#\n# Perform necessary crystal setup steps\n# after package is installed.\n#\n\nPROGNAME=$(basename $0)\n\nfunction error_exit\n{\n  echo \"${PROGNAME}: ${1:-\"Unknown Error\"}\" 1>&2\n  exit 1\n}\n\nINSTALL_PATH=/usr\nif [ `uname` = \"Darwin\" -a `uname -r|cut -f1 -d.` -ge 15 ]; then\n  INSTALL_PATH=/usr/local\nfi\n\nln -nfs /opt/crystal/bin/crystal ${INSTALL_PATH}/bin/crystal\nln -nfs /opt/crystal/embedded/bin/shards ${INSTALL_PATH}/bin/shards\n\nexit 0\n\n\n\nAppendix\n\norigin: https://github.com/manastech/omnibus-crystal/pull/7\n\n\n\nDue to the rootless feature, [original pkg](https://github.com/manastech/crystal/releases) installation would be incomplete.\n\nOf course, homebrew users should use `brew`, but **this is not an option for MacPorts (or Fink) users.**\n\n## Using darwin-x86_64.tar.gz\n- Extract tar.gz into /opt/crystal\n- Link /opt/crystal/bin/crystal and /opt/crystal/embedded/bin/shards to /usr/local/bin.\n\n## Using pkg\n- You need to modify the pkg to symlink safely.\n\n1. Prepare [updatepkgscripts.rb](https://github.com/cielavenir/updatecontrol).\n2. Paste following to crystal-update.rb.\n3. Call `crystal-update.rb updatepkgscripts.rb crystal.pkg`.\n4. Now you can install the pkg safely.\n\n```crystal-update.rb\n#!/usr/bin/ruby\n#usage: crystal-update.rb updatepkgscripts.rb crystal.pkg\n\nrequire 'tmpdir'\nDir.mktmpdir{|tmp|\n\tsystem('\"'+ARGV[0]+'\" -x \"'+ARGV[1]+'\" crystal-core.pkg/Scripts \"'+tmp+'\"')\n\tFile.open(tmp+'/postinstall','wb'){|f|\n\t\tf.write DATA.read\n\t}\n\tsystem('\"'+ARGV[0]+'\" -u \"'+ARGV[1]+'\" crystal-core.pkg/Scripts \"'+tmp+'\"')\n}\n\n__END__\n#!/bin/bash\n#\n# Perform necessary crystal setup steps\n# after package is installed.\n#\n\nPROGNAME=$(basename $0)\n\nfunction error_exit\n{\n  echo \"${PROGNAME}: ${1:-\"Unknown Error\"}\" 1>&2\n  exit 1\n}\n\nINSTALL_PATH=/usr\nif [ `uname` = \"Darwin\" -a `uname -r|cut -f1 -d.` -ge 15 ]; then\n  INSTALL_PATH=/usr/local\nfi\n\nln -nfs /opt/crystal/bin/crystal ${INSTALL_PATH}/bin/crystal\nln -nfs /opt/crystal/embedded/bin/shards ${INSTALL_PATH}/bin/shards\n\nexit 0\n```\n\n## Appendix\n- origin: https://github.com/manastech/omnibus-crystal/pull/7\n", "tags": ["OSX", "crystal"]}