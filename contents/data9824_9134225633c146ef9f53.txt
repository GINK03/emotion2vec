{"context": " More than 1 year has passed since last update.PRML\u56f34.10\u3068\u540c\u69d8\u306b\u30012\u3064\u306e\u30af\u30e9\u30b9\u306e\u6761\u4ef6\u4ed8\u304d\u78ba\u7387\u5bc6\u5ea6\uff08\u305d\u308c\u305e\u308c\u540c\u3058\u5171\u5206\u6563\u884c\u5217\u3092\u6301\u30642\u6b21\u5143\u6b63\u898f\u5206\u5e03\uff09\u3092\u56f3\u793a\u3057\u3001\u3055\u3089\u306b\u3001\u305d\u308c\u3089\u306e\u6761\u4ef6\u4ed8\u304d\u78ba\u7387\u5bc6\u5ea6\u3068\u30af\u30e9\u30b9\u306e\u4e8b\u524d\u78ba\u7387\u304b\u3089\u6c42\u3081\u305f\u4e8b\u5f8c\u78ba\u7387\u3092\u56f3\u793a\u3057\u307e\u3059\u3002\u307e\u305f\u3001\u3053\u306e\u30e2\u30c7\u30eb\u306b\u5f93\u3063\u3066\u30b5\u30f3\u30d7\u30eb\u3092\u751f\u6210\u3057\u307e\u3059\u3002\u30b5\u30f3\u30d7\u30eb\u304b\u3089\u30e2\u30c7\u30eb\u30d1\u30e9\u30e1\u30fc\u30bf\u3092\u6c42\u3081\u3066\u3044\u308b\u308f\u3051\u3067\u306f\u3042\u308a\u307e\u305b\u3093\u3002\u306a\u304a\u30012\u3064\u306e\u30af\u30e9\u30b9\u306e\u4e8b\u524d\u78ba\u7387\u304c100\u500d\u7570\u306a\u308b\u3082\u306e\u3068\u3057\u3066\u3044\u307e\u3059\u3002\n\nlibrary(mvtnorm)\nframe()\nset.seed(0)\npar(mfrow=c(2, 2))\npar(mar=c(2, 2, 1, 2))\npar(mgp=c(2, 1, 0))\nxrange <- c(-2, 2)\nyrange <- c(-2, 2)\nx1 <- seq(xrange[1], xrange[2], .1)\nx2 <- seq(yrange[1], xrange[2], .1)\n\nsigma <- matrix(c(0.5^2, 0, 0, 0.5^2), 2)\nu1 <- c(-0.5, -0.5)\nu2 <- c(0.5, 0.5)\nN1 <- 100\nN2 <- 10000\nprecision <- solve(sigma)\nw <- precision %*% (u1 - u2)\nw0 <- as.numeric((t(u1) %*% precision %*% u1 + t(u2) %*% precision %*% u2) / 2 + log(N1 / N2))\nprint(w)\nprint(w0)\nbase <- function(x1, x2) {\n        (cbind(x1, x2))\n}\nlogistic <- function(x) {\n        1 / (1 + exp(-x))\n}\nestimate <- function(x1, x2){\n        logistic(t(w) %*% t(base(x1, x2)) + w0)\n}\n\np1 <- function(x1, x2) {\n        dmvnorm(cbind(x1, x2), u1, sigma)\n}\npersp(x1, x2, outer(x1, x2, p1), xlim=xrange, ylim=yrange, border=1, theta=50, ticktype=\"detailed\", main=\"p(x|C1)\")\n\np2 <- function(x1, x2) {\n        dmvnorm(cbind(x1, x2), u2, sigma)\n}\npersp(x1, x2, outer(x1, x2, p2), xlim=xrange, ylim=yrange, border=2, theta=50, ticktype=\"detailed\", main=\"p(x|C2)\")\n\ny <- outer(x1, x2, estimate)\npersp(x1, x2, y, xlim=xrange, ylim=yrange, border=3, theta=50, ticktype=\"detailed\", main=\"p(C1|x)\")\n\nx <- rmvnorm(N1, u1, sigma)\nd <- as.data.frame(cbind(x, 1))\nx <- rmvnorm(N2, u2, sigma)\nd <- rbind(d, as.data.frame(cbind(x, 2)))\nnames(d) <- c(\"x1\", \"x2\", \"class\")\nplot(d$x1, d$x2, col=d$class, xlim=xrange, ylim=yrange)\ncontour(x1, x2, y, xlim=xrange, ylim=yrange, col=3, add=T)\ntitle(main=\"p(C1|x) and samples\")\n\nPRML\u56f34.10\u3068\u540c\u69d8\u306b\u30012\u3064\u306e\u30af\u30e9\u30b9\u306e\u6761\u4ef6\u4ed8\u304d\u78ba\u7387\u5bc6\u5ea6\uff08\u305d\u308c\u305e\u308c\u540c\u3058\u5171\u5206\u6563\u884c\u5217\u3092\u6301\u30642\u6b21\u5143\u6b63\u898f\u5206\u5e03\uff09\u3092\u56f3\u793a\u3057\u3001\u3055\u3089\u306b\u3001\u305d\u308c\u3089\u306e\u6761\u4ef6\u4ed8\u304d\u78ba\u7387\u5bc6\u5ea6\u3068\u30af\u30e9\u30b9\u306e\u4e8b\u524d\u78ba\u7387\u304b\u3089\u6c42\u3081\u305f\u4e8b\u5f8c\u78ba\u7387\u3092\u56f3\u793a\u3057\u307e\u3059\u3002\u307e\u305f\u3001\u3053\u306e\u30e2\u30c7\u30eb\u306b\u5f93\u3063\u3066\u30b5\u30f3\u30d7\u30eb\u3092\u751f\u6210\u3057\u307e\u3059\u3002\u30b5\u30f3\u30d7\u30eb\u304b\u3089\u30e2\u30c7\u30eb\u30d1\u30e9\u30e1\u30fc\u30bf\u3092\u6c42\u3081\u3066\u3044\u308b\u308f\u3051\u3067\u306f\u3042\u308a\u307e\u305b\u3093\u3002\u306a\u304a\u30012\u3064\u306e\u30af\u30e9\u30b9\u306e\u4e8b\u524d\u78ba\u7387\u304c100\u500d\u7570\u306a\u308b\u3082\u306e\u3068\u3057\u3066\u3044\u307e\u3059\u3002\n\n![](https://dl.dropbox.com/sh/cwfemibvr7gk4cy/EVceRjE30H/7.GenerativeModelOfLinearDiscriminant.png)\n\n```r\nlibrary(mvtnorm)\nframe()\nset.seed(0)\npar(mfrow=c(2, 2))\npar(mar=c(2, 2, 1, 2))\npar(mgp=c(2, 1, 0))\nxrange <- c(-2, 2)\nyrange <- c(-2, 2)\nx1 <- seq(xrange[1], xrange[2], .1)\nx2 <- seq(yrange[1], xrange[2], .1)\n \nsigma <- matrix(c(0.5^2, 0, 0, 0.5^2), 2)\nu1 <- c(-0.5, -0.5)\nu2 <- c(0.5, 0.5)\nN1 <- 100\nN2 <- 10000\nprecision <- solve(sigma)\nw <- precision %*% (u1 - u2)\nw0 <- as.numeric((t(u1) %*% precision %*% u1 + t(u2) %*% precision %*% u2) / 2 + log(N1 / N2))\nprint(w)\nprint(w0)\nbase <- function(x1, x2) {\n        (cbind(x1, x2))\n}\nlogistic <- function(x) {\n        1 / (1 + exp(-x))\n}\nestimate <- function(x1, x2){\n        logistic(t(w) %*% t(base(x1, x2)) + w0)\n}\n \np1 <- function(x1, x2) {\n        dmvnorm(cbind(x1, x2), u1, sigma)\n}\npersp(x1, x2, outer(x1, x2, p1), xlim=xrange, ylim=yrange, border=1, theta=50, ticktype=\"detailed\", main=\"p(x|C1)\")\n\np2 <- function(x1, x2) {\n        dmvnorm(cbind(x1, x2), u2, sigma)\n}\npersp(x1, x2, outer(x1, x2, p2), xlim=xrange, ylim=yrange, border=2, theta=50, ticktype=\"detailed\", main=\"p(x|C2)\")\n \ny <- outer(x1, x2, estimate)\npersp(x1, x2, y, xlim=xrange, ylim=yrange, border=3, theta=50, ticktype=\"detailed\", main=\"p(C1|x)\")\n \nx <- rmvnorm(N1, u1, sigma)\nd <- as.data.frame(cbind(x, 1))\nx <- rmvnorm(N2, u2, sigma)\nd <- rbind(d, as.data.frame(cbind(x, 2)))\nnames(d) <- c(\"x1\", \"x2\", \"class\")\nplot(d$x1, d$x2, col=d$class, xlim=xrange, ylim=yrange)\ncontour(x1, x2, y, xlim=xrange, ylim=yrange, col=3, add=T)\ntitle(main=\"p(C1|x) and samples\")\n```\n", "tags": ["R", "PRML"]}