{"context": "\n\n\u4eca\u56de\u306e\u30b4\u30fc\u30eb\nOpenStack\u4e0a\u3067\u4eee\u60f3\u8cc7\u6e90\u3092\u4f5c\u3063\u305f\u969b\u306b\u3001New Relic Infrastructre\u3067\u306f\u3069\u3093\u306a\u98a8\u306b\u898b\u3048\u308b\u306e\u304b\uff1f\u3092\u898b\u3066\u3044\u304d\u307e\u3059\u3002\u4eca\u56de\u306f\u7269\u7406\u3068\u4eee\u60f3\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u3092\u4e2d\u5fc3\u306b\u78ba\u8a8d\u3057\u3066\u307f\u307e\u3059\u3002\n\n\u524d\u63d0\n\ncloud image\u306e\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\nOpenStack\u4e0a\u306bcloud image\u3092\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3057\u3066\u304a\u304d\u307e\u3059\u3002\u4f55\u3067\u3082\u3044\u3044\u306e\u3067\u3059\u304c\u4eca\u56de\u306fUbuntu14\u3092\u4f7f\u3044\u307e\u3059\u3002\n[root@honoka ~]# glance image-list\n+--------------------------------------+-------------+\n| ID                                   | Name        |\n+--------------------------------------+-------------+\n| b77d7a67-a68f-42fe-af7f-b5ceec6fc126 | cirros      |\n| be54e3ba-9f3f-4d37-9a22-e5dc689e795f | Ubuntu14.4  |\n| 2e47061d-8e32-4be6-99ac-9dc23e5071fd | Ubuntu16.04 |\n+--------------------------------------+-------------+\n[root@honoka ~]#\n\n\n\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9\u60c5\u5831\n\u524d\u56de\uff08\u305d\u306e\uff11\uff09\u306e\u6700\u5f8c\u306e\u72b6\u614b\u304b\u3089\u59cb\u3081\u307e\u3059\u3002\n# ip a\n1: lo: <LOOPBACK,UP,LOWER_UP> mtu 65536 qdisc noqueue state UNKNOWN\n    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00\n    inet 127.0.0.1/8 scope host lo\n       valid_lft forever preferred_lft forever\n    inet6 ::1/128 scope host\n       valid_lft forever preferred_lft forever\n2: ens160: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc mq master ovs-system state UP qlen 1000\n    link/ether 00:0c:29:3c:92:39 brd ff:ff:ff:ff:ff:ff\n    inet {\u30b5\u30fc\u30d0\u306eIP} brd {\u30d6\u30ed\u30fc\u30c9\u30ad\u30e3\u30b9\u30c8\u30a2\u30c9\u30ec\u30b9} scope global ens160\n       valid_lft forever preferred_lft forever\n    inet6 fe80::20c:29ff:fe3c:9239/64 scope link\n       valid_lft forever preferred_lft forever\n3: ovs-system: <BROADCAST,MULTICAST> mtu 1500 qdisc noop state DOWN\n    link/ether 92:c4:e8:c3:05:97 brd ff:ff:ff:ff:ff:ff\n4: br-tun: <BROADCAST,MULTICAST> mtu 1500 qdisc noop state DOWN\n    link/ether 12:0c:03:90:fb:43 brd ff:ff:ff:ff:ff:ff\n5: br-ex: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UNKNOWN\n    link/ether 00:0c:29:3c:92:39 brd ff:ff:ff:ff:ff:ff\n    inet {\u30b5\u30fc\u30d0\u306eIP} brd {\u30d6\u30ed\u30fc\u30c9\u30ad\u30e3\u30b9\u30c8\u30a2\u30c9\u30ec\u30b9} scope global br-ex\n       valid_lft forever preferred_lft forever\n    inet6 fe80::20c:29ff:fe3c:9239/64 scope link\n       valid_lft forever preferred_lft forever\n6: br-int: <BROADCAST,MULTICAST> mtu 1450 qdisc noop state DOWN\n    link/ether ca:9b:55:3f:de:4e brd ff:ff:ff:ff:ff:ff\n#\n\novs-vsctl show \u3067\u4eee\u60f3\u30de\u30b7\u30f3\u3068\u30cf\u30a4\u30d1\u30fc\u30d0\u30a4\u30b6\u30fc\u5916\u90e8\u3068\u901a\u4fe1\u3067\u304d\u308b\u3088\u3046\u3001ens160\u304cbr-ex\u306b\u5272\u3042\u305f\u3063\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n\n\u524d\u6e96\u5099\nOpenStack\u4e0a\u306bcloud image\u3092\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3057\u3066\u304a\u304d\u307e\u3059\u3002\u4f55\u3067\u3082\u3044\u3044\u306e\u3067\u3059\u304c\u4eca\u56de\u306fUbuntu14\u3092\u4f7f\u3044\u307e\u3059\u3002\n# source admin-openrc\n# glance image-list\n+--------------------------------------+-------------+\n| ID                                   | Name        |\n+--------------------------------------+-------------+\n| b77d7a67-a68f-42fe-af7f-b5ceec6fc126 | cirros      |\n| be54e3ba-9f3f-4d37-9a22-e5dc689e795f | Ubuntu14.4  |\n| 2e47061d-8e32-4be6-99ac-9dc23e5071fd | Ubuntu16.04 |\n+--------------------------------------+-------------+\n#\n\n\n\u4eee\u60f3\u8cc7\u6e90\u4f5c\u6210\n\u4eee\u60f3\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306e\u4f5c\u6210\u306f\u30b3\u30de\u30f3\u30c9\u3067\u884c\u3044\u307e\u3057\u305f\u3002\u5916\u90e8\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u3068\u5185\u90e8\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306e\u63a5\u7d9a\u78ba\u8a8d\u304c\u3057\u3084\u3059\u3044\u304b\u3089\u3067\u3059\u3002\u3053\u3061\u3089\u3092\u53c2\u8003\u306b\u3055\u305b\u3066\u9802\u304d\u307e\u3057\u305f\u3002\nRDO Neutron \u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306e\u8a2d\u5b9a\n\n\u30eb\u30fc\u30bf\u306e\u4f5c\u6210\n# neutron router-create router1\n\n\n\u4eee\u60f3\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306e\u4f5c\u6210\n\u5916\u90e8\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306fadmin\u30c6\u30ca\u30f3\u30c8\u306b\u6240\u5c5e\u3057\u3001\u30d7\u30e9\u30a4\u30d9\u30fc\u30c8\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306fservices\u306b\u6240\u5c5e\u3055\u305b\u308b\u3053\u3068\u306b\u3057\u307e\u3059\u3002\n# openstack project list\n+----------------------------------+----------+\n| ID                               | Name     |\n+----------------------------------+----------+\n| a9621341aecb44e49110c456b75045b8 | admin    |\n| b39b2ab8bdec41bfa1062d29b21357b6 | services |\n+----------------------------------+----------+\n#\n# neutron net-create public --router:external --tenant-id a9621341aecb44e49110c456b75045b8\n# neutron net-create demo-net --shared --tenant-id 30f2cc33d5f8405895e5558b077a86c6\n#\n\n\n\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u30b5\u30d6\u30cd\u30c3\u30c8\u306e\u767b\u9332\n# neutron subnet-create --name public_subnet --enable_dhcp=False \\\n--allocation-pool=start=172.16.0.115,end=172.16.0.119 --gateway=172.16.0.253 public 172.16.0.0/24\n\n# neutron subnet-create --name demo-net_subnet --enable_dhcp=True \\\n--allocation-pool=start=192.168.1.100,end=192.168.1.254 --gateway=192.168.1.1 \\\n--dns-nameserver 8.8.8.8 demo-net 192.168.1.0/24\n\n\n\u30b2\u30fc\u30c8\u30a6\u30a7\u30a4\u306e\u8a2d\u5b9a\nneutron router-gateway-set router1 public\n\n\n\u5916\u90e8\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u3068\u5185\u90e8\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306e\u63a5\u7d9a\n# neutron router-interface-add router1 subnet=demo-net_subnet\n\n\n\u4eee\u60f3\u30eb\u30fc\u30bf\u304c\u4f5c\u3089\u308c\u305f\u3053\u3068\u3092\u78ba\u8a8d\n# ip netns\nqrouter-f3e74f75-0fb6-4797-acdb-b553f7c874e6\nqdhcp-d137a5f0-171c-481e-9761-81b12bf71b09\n#\n\n# ip netns exec `ip netns|grep qrouter` ip r\ndefault via 172.16.0.253 dev qg-38c8b13d-d4\n172.16.0.0/24 dev qg-38c8b13d-d4  proto kernel  scope link  src 172.16.0.117\n192.168.1.0/24 dev qr-db18e68a-8a  proto kernel  scope link  src 192.168.1.1\n# ip netns exec `ip netns|grep qrouter`  ping -c 3 -I qg-38c8b13d-d4 172.16.0.117\n# ip netns exec `ip netns|grep qrouter`  ping -c 3 -I qr-db18e68a-8a 192.168.1.1\n# ip netns exec `ip netns|grep qrouter`  ping -c 3 -I qg-38c8b13d-d4 8.8.8.8\n\n\n\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u8d77\u52d5\n\u4eee\u60f3\u30de\u30b7\u30f3\u306e\u4f5c\u6210\u306fHorizon\u304b\u3089\u884c\u3044\u307e\u3057\u305f\u3002Ubuntu14\u3092small\u3067\u8d77\u52d5\u3002\u9375\u3092openstack.pem\u3068\u3057\u3066\u53d6\u5f97\u3057\u307e\u3059\u3002\nFloating IP\u3092172.16.0.118\u3068\u3057\u3066\u5272\u308a\u5f53\u3066\u307e\u3057\u305f\u3002\n\n\u4eee\u60f3\u30de\u30b7\u30f3\u3078\u306e\u30ed\u30b0\u30a4\u30f3\u3068\u5916\u90e8\u901a\u4fe1\u304c\u3067\u304d\u308b\u3053\u3068\u3092\u78ba\u8a8d\n\u4eee\u60f3\u30de\u30b7\u30f3\u3078\u306e\u30a2\u30af\u30bb\u30b9\u306b\u306f\u9375\u304c\u5fc5\u8981\u3067\u3059\u3002openstack.pem\u306e\u6a29\u9650\u8a2d\u5b9a\u3082\u5fc5\u8981\u3067\u3059\u3002\n# ssh -i openstack.pem ubuntu@172.16.0.118\nubuntu@ubuntu14:~$\nubuntu@ubuntu14:~$\nubuntu@ubuntu14:~$ sudo apt-get update\n\n\n\u4eee\u60f3\u8cc7\u6e90\u4f5c\u6210\u5f8c\n\u6700\u521d\u3068\u6bd4\u8f03\u3057\u3066\u4eee\u60f3\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u8cc7\u6e90\u304c\u52a0\u308f\u3063\u305f\u3053\u3068\u304c\u78ba\u8a8d\u3067\u304d\u307e\u3059\u3002\n# ip a\n1: lo: <LOOPBACK,UP,LOWER_UP> mtu 65536 qdisc noqueue state UNKNOWN\n    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00\n    inet 127.0.0.1/8 scope host lo\n       valid_lft forever preferred_lft forever\n    inet6 ::1/128 scope host\n       valid_lft forever preferred_lft forever\n2: ens160: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc mq master ovs-system state UP qlen 1000\n    link/ether 00:0c:29:3c:92:39 brd ff:ff:ff:ff:ff:ff\n    inet 172.16.0.120/24 brd 172.16.0.255 scope global ens160\n       valid_lft forever preferred_lft forever\n    inet6 fe80::20c:29ff:fe3c:9239/64 scope link\n       valid_lft forever preferred_lft forever\n3: ovs-system: <BROADCAST,MULTICAST> mtu 1500 qdisc noop state DOWN\n    link/ether 92:c4:e8:c3:05:97 brd ff:ff:ff:ff:ff:ff\n4: br-tun: <BROADCAST,MULTICAST> mtu 1500 qdisc noop state DOWN\n    link/ether 12:0c:03:90:fb:43 brd ff:ff:ff:ff:ff:ff\n5: br-ex: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UNKNOWN\n    link/ether 00:0c:29:3c:92:39 brd ff:ff:ff:ff:ff:ff\n    inet 172.16.0.120/24 brd 172.16.0.255 scope global br-ex\n       valid_lft forever preferred_lft forever\n    inet6 fe80::20c:29ff:fe3c:9239/64 scope link\n       valid_lft forever preferred_lft forever\n6: br-int: <BROADCAST,MULTICAST> mtu 1450 qdisc noop state DOWN\n    link/ether ca:9b:55:3f:de:4e brd ff:ff:ff:ff:ff:ff\n22: qbr4cd007cd-86: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1450 qdisc noqueue state UP\n    link/ether e6:d7:db:a5:3b:45 brd ff:ff:ff:ff:ff:ff\n23: qvo4cd007cd-86@qvb4cd007cd-86: <BROADCAST,MULTICAST,PROMISC,UP,LOWER_UP> mtu 1450 qdisc pfifo_fast master ovs-system state UP qlen 1000\n    link/ether de:dc:ec:6f:f7:5d brd ff:ff:ff:ff:ff:ff\n    inet6 fe80::dcdc:ecff:fe6f:f75d/64 scope link\n       valid_lft forever preferred_lft forever\n24: qvb4cd007cd-86@qvo4cd007cd-86: <BROADCAST,MULTICAST,PROMISC,UP,LOWER_UP> mtu 1450 qdisc pfifo_fast master qbr4cd007cd-86 state UP qlen 1000\n    link/ether e6:d7:db:a5:3b:45 brd ff:ff:ff:ff:ff:ff\n    inet6 fe80::e4d7:dbff:fea5:3b45/64 scope link\n       valid_lft forever preferred_lft forever\n25: tap4cd007cd-86: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1450 qdisc pfifo_fast master qbr4cd007cd-86 state UNKNOWN qlen 500\n    link/ether fe:16:3e:48:06:a0 brd ff:ff:ff:ff:ff:ff\n    inet6 fe80::fc16:3eff:fe48:6a0/64 scope link\n       valid_lft forever preferred_lft forever\n#\n\n\nInfrastructure\u3067\u306e\u898b\u3048\u65b9\n\u7269\u7406\u57fa\u76e4\u5074\u304b\u3089\u307f\u305f\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u304c\u8868\u793a\u3055\u308c\u308b\u3053\u3068\u304c\u308f\u304b\u308a\u307e\u3059\u3002\u4eee\u60f3\u30de\u30b7\u30f3\u304b\u3089\u5916\u90e8\u306bping\u3092\u6253\u3061\u7d9a\u3051\u308b\u3068OVS\u306e\u30a4\u30f3\u30bf\u30fc\u30fc\u30d5\u30a7\u30fc\u30b9\u306a\u3069\u306b\u901a\u4fe1\u304c\u6d41\u308c\u3066\u3044\u308b\u72b6\u614b\u304c\u78ba\u8a8d\u3055\u308c\u307e\u3057\u305f\u3002\u3055\u3059\u304c\u306bOpenStack\u4e0a\u306e\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u540d\u3067\u8868\u793a\u3055\u308c\u308b\u308f\u3051\u3067\u306f\u3042\u308a\u307e\u305b\u3093\u304c\u3001\u8ca0\u8377\u9806\u306b\u30b0\u30e9\u30d5\u304c\u8868\u793a\u3055\u308c\u307e\u3059\u306e\u3067\u969c\u5bb3\u306e\u53ef\u8996\u5316\u30fb\u65e9\u671f\u7279\u5b9a\u306b\u8ca2\u732e\u3057\u305d\u3046\u3067\u3059\u3002\n\n\u4eca\u56de\u306f\u4ee5\u4e0a\u3067\u3059\u3002\n# \u4eca\u56de\u306e\u30b4\u30fc\u30eb\nOpenStack\u4e0a\u3067\u4eee\u60f3\u8cc7\u6e90\u3092\u4f5c\u3063\u305f\u969b\u306b\u3001New Relic Infrastructre\u3067\u306f\u3069\u3093\u306a\u98a8\u306b\u898b\u3048\u308b\u306e\u304b\uff1f\u3092\u898b\u3066\u3044\u304d\u307e\u3059\u3002\u4eca\u56de\u306f\u7269\u7406\u3068\u4eee\u60f3\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u3092\u4e2d\u5fc3\u306b\u78ba\u8a8d\u3057\u3066\u307f\u307e\u3059\u3002\n\n# \u524d\u63d0\n## cloud image\u306e\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\nOpenStack\u4e0a\u306bcloud image\u3092\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3057\u3066\u304a\u304d\u307e\u3059\u3002\u4f55\u3067\u3082\u3044\u3044\u306e\u3067\u3059\u304c\u4eca\u56de\u306fUbuntu14\u3092\u4f7f\u3044\u307e\u3059\u3002\n\n```\n[root@honoka ~]# glance image-list\n+--------------------------------------+-------------+\n| ID                                   | Name        |\n+--------------------------------------+-------------+\n| b77d7a67-a68f-42fe-af7f-b5ceec6fc126 | cirros      |\n| be54e3ba-9f3f-4d37-9a22-e5dc689e795f | Ubuntu14.4  |\n| 2e47061d-8e32-4be6-99ac-9dc23e5071fd | Ubuntu16.04 |\n+--------------------------------------+-------------+\n[root@honoka ~]#\n```\n## \u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9\u60c5\u5831\n\u524d\u56de\uff08\u305d\u306e\uff11\uff09\u306e\u6700\u5f8c\u306e\u72b6\u614b\u304b\u3089\u59cb\u3081\u307e\u3059\u3002\n\n```\n# ip a\n1: lo: <LOOPBACK,UP,LOWER_UP> mtu 65536 qdisc noqueue state UNKNOWN\n    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00\n    inet 127.0.0.1/8 scope host lo\n       valid_lft forever preferred_lft forever\n    inet6 ::1/128 scope host\n       valid_lft forever preferred_lft forever\n2: ens160: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc mq master ovs-system state UP qlen 1000\n    link/ether 00:0c:29:3c:92:39 brd ff:ff:ff:ff:ff:ff\n    inet {\u30b5\u30fc\u30d0\u306eIP} brd {\u30d6\u30ed\u30fc\u30c9\u30ad\u30e3\u30b9\u30c8\u30a2\u30c9\u30ec\u30b9} scope global ens160\n       valid_lft forever preferred_lft forever\n    inet6 fe80::20c:29ff:fe3c:9239/64 scope link\n       valid_lft forever preferred_lft forever\n3: ovs-system: <BROADCAST,MULTICAST> mtu 1500 qdisc noop state DOWN\n    link/ether 92:c4:e8:c3:05:97 brd ff:ff:ff:ff:ff:ff\n4: br-tun: <BROADCAST,MULTICAST> mtu 1500 qdisc noop state DOWN\n    link/ether 12:0c:03:90:fb:43 brd ff:ff:ff:ff:ff:ff\n5: br-ex: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UNKNOWN\n    link/ether 00:0c:29:3c:92:39 brd ff:ff:ff:ff:ff:ff\n    inet {\u30b5\u30fc\u30d0\u306eIP} brd {\u30d6\u30ed\u30fc\u30c9\u30ad\u30e3\u30b9\u30c8\u30a2\u30c9\u30ec\u30b9} scope global br-ex\n       valid_lft forever preferred_lft forever\n    inet6 fe80::20c:29ff:fe3c:9239/64 scope link\n       valid_lft forever preferred_lft forever\n6: br-int: <BROADCAST,MULTICAST> mtu 1450 qdisc noop state DOWN\n    link/ether ca:9b:55:3f:de:4e brd ff:ff:ff:ff:ff:ff\n#\n```\n\novs-vsctl show \u3067\u4eee\u60f3\u30de\u30b7\u30f3\u3068\u30cf\u30a4\u30d1\u30fc\u30d0\u30a4\u30b6\u30fc\u5916\u90e8\u3068\u901a\u4fe1\u3067\u304d\u308b\u3088\u3046\u3001ens160\u304cbr-ex\u306b\u5272\u3042\u305f\u3063\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n\n# \u524d\u6e96\u5099\n\nOpenStack\u4e0a\u306bcloud image\u3092\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3057\u3066\u304a\u304d\u307e\u3059\u3002\u4f55\u3067\u3082\u3044\u3044\u306e\u3067\u3059\u304c\u4eca\u56de\u306fUbuntu14\u3092\u4f7f\u3044\u307e\u3059\u3002\n\n```\n# source admin-openrc\n# glance image-list\n+--------------------------------------+-------------+\n| ID                                   | Name        |\n+--------------------------------------+-------------+\n| b77d7a67-a68f-42fe-af7f-b5ceec6fc126 | cirros      |\n| be54e3ba-9f3f-4d37-9a22-e5dc689e795f | Ubuntu14.4  |\n| 2e47061d-8e32-4be6-99ac-9dc23e5071fd | Ubuntu16.04 |\n+--------------------------------------+-------------+\n#\n```\n\n# \u4eee\u60f3\u8cc7\u6e90\u4f5c\u6210\n\u4eee\u60f3\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306e\u4f5c\u6210\u306f\u30b3\u30de\u30f3\u30c9\u3067\u884c\u3044\u307e\u3057\u305f\u3002\u5916\u90e8\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u3068\u5185\u90e8\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306e\u63a5\u7d9a\u78ba\u8a8d\u304c\u3057\u3084\u3059\u3044\u304b\u3089\u3067\u3059\u3002\u3053\u3061\u3089\u3092\u53c2\u8003\u306b\u3055\u305b\u3066\u9802\u304d\u307e\u3057\u305f\u3002\n[RDO Neutron \u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306e\u8a2d\u5b9a](https://github.com/ytooyama/rdo-kilo/blob/master/2-RDO-QuickStart-Networking.md)\n\n## \u30eb\u30fc\u30bf\u306e\u4f5c\u6210\n\n```\n# neutron router-create router1\n```\n\n## \u4eee\u60f3\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306e\u4f5c\u6210\n\u5916\u90e8\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306fadmin\u30c6\u30ca\u30f3\u30c8\u306b\u6240\u5c5e\u3057\u3001\u30d7\u30e9\u30a4\u30d9\u30fc\u30c8\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306fservices\u306b\u6240\u5c5e\u3055\u305b\u308b\u3053\u3068\u306b\u3057\u307e\u3059\u3002\n\n```\n# openstack project list\n+----------------------------------+----------+\n| ID                               | Name     |\n+----------------------------------+----------+\n| a9621341aecb44e49110c456b75045b8 | admin    |\n| b39b2ab8bdec41bfa1062d29b21357b6 | services |\n+----------------------------------+----------+\n#\n# neutron net-create public --router:external --tenant-id a9621341aecb44e49110c456b75045b8\n# neutron net-create demo-net --shared --tenant-id 30f2cc33d5f8405895e5558b077a86c6\n#\n```\n\n## \u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u30b5\u30d6\u30cd\u30c3\u30c8\u306e\u767b\u9332\n\n```\n# neutron subnet-create --name public_subnet --enable_dhcp=False \\\n--allocation-pool=start=172.16.0.115,end=172.16.0.119 --gateway=172.16.0.253 public 172.16.0.0/24\n\n# neutron subnet-create --name demo-net_subnet --enable_dhcp=True \\\n--allocation-pool=start=192.168.1.100,end=192.168.1.254 --gateway=192.168.1.1 \\\n--dns-nameserver 8.8.8.8 demo-net 192.168.1.0/24\n```\n\n## \u30b2\u30fc\u30c8\u30a6\u30a7\u30a4\u306e\u8a2d\u5b9a\n\n```\nneutron router-gateway-set router1 public\n```\n\n## \u5916\u90e8\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u3068\u5185\u90e8\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306e\u63a5\u7d9a\n\n```\n# neutron router-interface-add router1 subnet=demo-net_subnet\n```\n\n## \u4eee\u60f3\u30eb\u30fc\u30bf\u304c\u4f5c\u3089\u308c\u305f\u3053\u3068\u3092\u78ba\u8a8d\n\n```\n# ip netns\nqrouter-f3e74f75-0fb6-4797-acdb-b553f7c874e6\nqdhcp-d137a5f0-171c-481e-9761-81b12bf71b09\n#\n```\n\n```\n# ip netns exec `ip netns|grep qrouter` ip r\ndefault via 172.16.0.253 dev qg-38c8b13d-d4\n172.16.0.0/24 dev qg-38c8b13d-d4  proto kernel  scope link  src 172.16.0.117\n192.168.1.0/24 dev qr-db18e68a-8a  proto kernel  scope link  src 192.168.1.1\n# ip netns exec `ip netns|grep qrouter`  ping -c 3 -I qg-38c8b13d-d4 172.16.0.117\n# ip netns exec `ip netns|grep qrouter`  ping -c 3 -I qr-db18e68a-8a 192.168.1.1\n# ip netns exec `ip netns|grep qrouter`  ping -c 3 -I qg-38c8b13d-d4 8.8.8.8\n```\n\n# \u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u8d77\u52d5\n\u4eee\u60f3\u30de\u30b7\u30f3\u306e\u4f5c\u6210\u306fHorizon\u304b\u3089\u884c\u3044\u307e\u3057\u305f\u3002Ubuntu14\u3092small\u3067\u8d77\u52d5\u3002\u9375\u3092openstack.pem\u3068\u3057\u3066\u53d6\u5f97\u3057\u307e\u3059\u3002\nFloating IP\u3092172.16.0.118\u3068\u3057\u3066\u5272\u308a\u5f53\u3066\u307e\u3057\u305f\u3002\n\n## \u4eee\u60f3\u30de\u30b7\u30f3\u3078\u306e\u30ed\u30b0\u30a4\u30f3\u3068\u5916\u90e8\u901a\u4fe1\u304c\u3067\u304d\u308b\u3053\u3068\u3092\u78ba\u8a8d\n\u4eee\u60f3\u30de\u30b7\u30f3\u3078\u306e\u30a2\u30af\u30bb\u30b9\u306b\u306f\u9375\u304c\u5fc5\u8981\u3067\u3059\u3002openstack.pem\u306e\u6a29\u9650\u8a2d\u5b9a\u3082\u5fc5\u8981\u3067\u3059\u3002\n\n```\n# ssh -i openstack.pem ubuntu@172.16.0.118\nubuntu@ubuntu14:~$\nubuntu@ubuntu14:~$\nubuntu@ubuntu14:~$ sudo apt-get update\n```\n\n\n\n# \u4eee\u60f3\u8cc7\u6e90\u4f5c\u6210\u5f8c\n\u6700\u521d\u3068\u6bd4\u8f03\u3057\u3066\u4eee\u60f3\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u8cc7\u6e90\u304c\u52a0\u308f\u3063\u305f\u3053\u3068\u304c\u78ba\u8a8d\u3067\u304d\u307e\u3059\u3002\n\n```\n# ip a\n1: lo: <LOOPBACK,UP,LOWER_UP> mtu 65536 qdisc noqueue state UNKNOWN\n    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00\n    inet 127.0.0.1/8 scope host lo\n       valid_lft forever preferred_lft forever\n    inet6 ::1/128 scope host\n       valid_lft forever preferred_lft forever\n2: ens160: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc mq master ovs-system state UP qlen 1000\n    link/ether 00:0c:29:3c:92:39 brd ff:ff:ff:ff:ff:ff\n    inet 172.16.0.120/24 brd 172.16.0.255 scope global ens160\n       valid_lft forever preferred_lft forever\n    inet6 fe80::20c:29ff:fe3c:9239/64 scope link\n       valid_lft forever preferred_lft forever\n3: ovs-system: <BROADCAST,MULTICAST> mtu 1500 qdisc noop state DOWN\n    link/ether 92:c4:e8:c3:05:97 brd ff:ff:ff:ff:ff:ff\n4: br-tun: <BROADCAST,MULTICAST> mtu 1500 qdisc noop state DOWN\n    link/ether 12:0c:03:90:fb:43 brd ff:ff:ff:ff:ff:ff\n5: br-ex: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UNKNOWN\n    link/ether 00:0c:29:3c:92:39 brd ff:ff:ff:ff:ff:ff\n    inet 172.16.0.120/24 brd 172.16.0.255 scope global br-ex\n       valid_lft forever preferred_lft forever\n    inet6 fe80::20c:29ff:fe3c:9239/64 scope link\n       valid_lft forever preferred_lft forever\n6: br-int: <BROADCAST,MULTICAST> mtu 1450 qdisc noop state DOWN\n    link/ether ca:9b:55:3f:de:4e brd ff:ff:ff:ff:ff:ff\n22: qbr4cd007cd-86: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1450 qdisc noqueue state UP\n    link/ether e6:d7:db:a5:3b:45 brd ff:ff:ff:ff:ff:ff\n23: qvo4cd007cd-86@qvb4cd007cd-86: <BROADCAST,MULTICAST,PROMISC,UP,LOWER_UP> mtu 1450 qdisc pfifo_fast master ovs-system state UP qlen 1000\n    link/ether de:dc:ec:6f:f7:5d brd ff:ff:ff:ff:ff:ff\n    inet6 fe80::dcdc:ecff:fe6f:f75d/64 scope link\n       valid_lft forever preferred_lft forever\n24: qvb4cd007cd-86@qvo4cd007cd-86: <BROADCAST,MULTICAST,PROMISC,UP,LOWER_UP> mtu 1450 qdisc pfifo_fast master qbr4cd007cd-86 state UP qlen 1000\n    link/ether e6:d7:db:a5:3b:45 brd ff:ff:ff:ff:ff:ff\n    inet6 fe80::e4d7:dbff:fea5:3b45/64 scope link\n       valid_lft forever preferred_lft forever\n25: tap4cd007cd-86: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1450 qdisc pfifo_fast master qbr4cd007cd-86 state UNKNOWN qlen 500\n    link/ether fe:16:3e:48:06:a0 brd ff:ff:ff:ff:ff:ff\n    inet6 fe80::fc16:3eff:fe48:6a0/64 scope link\n       valid_lft forever preferred_lft forever\n#\n```\n\n# Infrastructure\u3067\u306e\u898b\u3048\u65b9\n\u7269\u7406\u57fa\u76e4\u5074\u304b\u3089\u307f\u305f\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u304c\u8868\u793a\u3055\u308c\u308b\u3053\u3068\u304c\u308f\u304b\u308a\u307e\u3059\u3002\u4eee\u60f3\u30de\u30b7\u30f3\u304b\u3089\u5916\u90e8\u306bping\u3092\u6253\u3061\u7d9a\u3051\u308b\u3068OVS\u306e\u30a4\u30f3\u30bf\u30fc\u30fc\u30d5\u30a7\u30fc\u30b9\u306a\u3069\u306b\u901a\u4fe1\u304c\u6d41\u308c\u3066\u3044\u308b\u72b6\u614b\u304c\u78ba\u8a8d\u3055\u308c\u307e\u3057\u305f\u3002\u3055\u3059\u304c\u306bOpenStack\u4e0a\u306e\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u540d\u3067\u8868\u793a\u3055\u308c\u308b\u308f\u3051\u3067\u306f\u3042\u308a\u307e\u305b\u3093\u304c\u3001\u8ca0\u8377\u9806\u306b\u30b0\u30e9\u30d5\u304c\u8868\u793a\u3055\u308c\u307e\u3059\u306e\u3067\u969c\u5bb3\u306e\u53ef\u8996\u5316\u30fb\u65e9\u671f\u7279\u5b9a\u306b\u8ca2\u732e\u3057\u305d\u3046\u3067\u3059\u3002\n\n![09.jpg](https://qiita-image-store.s3.amazonaws.com/0/150932/796f6088-0087-6072-f705-d1bafa4300b0.jpeg)\n\n\u4eca\u56de\u306f\u4ee5\u4e0a\u3067\u3059\u3002\n", "tags": ["newrelic", "openstack"]}