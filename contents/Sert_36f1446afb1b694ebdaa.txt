{"context": "Android\u306ePush\u901a\u77e5\u5b9f\u88c5\u306f\u3088\u304f\u5909\u308f\u308b\u306e\u3067\u81ea\u5206\u7528\u306b\u7c21\u6f54\u306a\u30e1\u30e2\u3002\n\n\u4e8b\u524d\u6e96\u5099\nAndroid Studio\u3067\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u4f5c\u6210\nFirebase Console\u3067\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u4f5c\u6210\n\ngoogle-services.json\u306e\u751f\u6210\nFirebase Console\u3067\u4ee5\u4e0b\u306e\u4f5c\u696d\u3092\u884c\u3046\u3002\n\nOverview\u306b\u3042\u308b\u300cAndroid\u30a2\u30d7\u30ea\u306bFirebase\u3092\u8ffd\u52a0\u300d\u3092\u30af\u30ea\u30c3\u30af\nAndroid Studio\u3067\u4f5c\u6210\u3057\u305f\u30a2\u30d7\u30ea\u306e\u30d1\u30c3\u30b1\u30fc\u30b8\u540d\u3092\u5165\u529b\n\u300c\u30a2\u30d7\u30ea\u3092\u8ffd\u52a0\u300d\u3092\u30af\u30ea\u30c3\u30af\n\ngoogle-services.json\u304c\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3055\u308c\u308b\n\n\nFirebase\u306e\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\nAndroid Studio\u3067\u4ee5\u4e0b\u306e\u4f5c\u696d\u3092\u884c\u3046\u3002\n\ngoogle-services.json\u3092\u30e2\u30b8\u30e5\u30fc\u30eb\u76f4\u4e0b\u306b\u914d\u7f6e\n\u30c7\u30d5\u30a9\u30eb\u30c8\u306a\u3089\n<PROJECT_ROOT>/app/google-services.json\n\n\n\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u30eb\u30fc\u30c8\u306ebuild.gradle\u3092\u7de8\u96c6\n\n<PROJECT_ROOT>/build.gradle\nbuildscript {\n  dependencies {\n    // \u8ffd\u52a0\n    classpath 'com.google.gms:google-services:3.0.0'\n  }\n}\n\n\n\n\u30e2\u30b8\u30e5\u30fc\u30eb\u306ebuild.gradle\u3092\u7de8\u96c6\n\n<PROJECT_ROOT>/<APP_MODULE>/build.gradle\ndependencies {\n  compile fileTree(dir: 'libs', include: ['*.jar'])\n  testCompile 'junit:junit:4.12'\n  compile 'com.android.support:appcompat-v7:24.1.1'\n\n  // \u4ee5\u4e0b\u3092\u8ffd\u52a0\n  compile 'com.google.firebase:firebase-core:9.2.1'\n  compile 'com.google.firebase:firebase-messaging:9.2.1'\n}\n\n// \u8ffd\u52a0\napply plugin: 'com.google.gms.google-services'\n\n\n\u3053\u3053\u307e\u3067\u3067\u3001Firebase Console\u306eNotification\u304b\u3089\u9001\u4fe1\u3057\u305fPush\u901a\u77e5\u3092\u53d7\u3051\u53d6\u308c\u308b\n\n\u72ec\u81ea\u30b5\u30fc\u30d0\u306btoken\u3092\u9001\u4fe1\u3059\u308b\nFirebase Notification\u3092\u4f7f\u308f\u306a\u3044\u5834\u5408\u306fFCM\u306eToken\u3092\u72ec\u81ea\u30b5\u30fc\u30d0\u306b\u9001\u308b\u5fc5\u8981\u304c\u3042\u308b\u3002\nDocument\u306fInstanceId\u3068\u304bregistration_tokens\u3068\u304b\u66f8\u3044\u3066\u3042\u308b\u3051\u3069\u3001\nGCM\u306fregistration_id\u3060\u3063\u305f\u3001\u540d\u524d\u5909\u308f\u3063\u305f\u306e\u304b\u306a...\n\nService\u3092\u4f5c\u6210\nregistration_token\u306e\u751f\u6210\u3084\u66f4\u65b0\u3092\u53d7\u3051\u53d6\u308b\u305f\u3081\u306b\u3001\nFirebaseInstanceIdService\u3092\u7d99\u627f\u3057\u305fService\u3092\u751f\u6210\u3059\u308b\u5fc5\u8981\u304c\u3042\u308b\u3002\n\nMyFirebaseInstanceIdService.java\npublic class MyFirebaseInstanceIdService extends FirebaseInstanceIdService {\n    @Override\n    public void onTokenRefresh() {\n        String refreshedToken = FirebaseInstanceId.getInstance().getToken();\n\n        // \u30b5\u30fc\u30d0\u306btoken\u3092\u9001\u4fe1\u3059\u308b\u51e6\u7406\u3092\u66f8\u304f\n    }\n}\n\n\n\nManifest\u3078Service\u3092\u767b\u9332\n\nAndroidManifest.xml\n...\n    <service\n      android:name=\".MyFirebaseInstanceIdService\">\n      <intent-filter>\n        <action android:name=\"com.google.firebase.INSTANCE_ID_EVENT\"/>\n      </intent-filter>\n    </service>\n  </application>\n</manifest>\n\n\n\n\u30a2\u30d7\u30ea\u8d77\u52d5\u4e2d\u306bPush\u901a\u77e5\u3092\u53d7\u3051\u53d6\u308b\n\u4e0a\u8a18\u307e\u3067\u3060\u3068\u3001\u30a2\u30d7\u30ea\u3092\u8d77\u52d5\u3057\u3066\u3044\u308b\u6700\u4e2d\u306b\u53d7\u3051\u53d6\u3063\u305fPush\u901a\u77e5\u304c\u8868\u793a\u3055\u308c\u306a\u3044\u3002\n\nService\u3092\u4f5c\u6210\nFirebaseMessagingService\u3092\u7d99\u627f\u3057\u305fService\u3092\u4f5c\u6210\u3059\u308b\u3053\u3068\u3067\u5bfe\u5fdc\u3002\n\nMyFirebaseMessagingService.java\npublic class MyFirebaseMessagingService extends FirebaseMessagingService {\n  private static final int NOTIFICATION_ID = 0;\n\n  @Override\n  public void onMessageReceived(RemoteMessage remoteMessage) {\n    String title = remoteMessage.getNotification().getTitle();\n    String body = remoteMessage.getNotification().getBody();\n\n    NotificationCompat.Builder builder =\n        (NotificationCompat.Builder) new NotificationCompat.Builder(this)\n            .setSmallIcon(R.mipmap.ic_launcher)\n            .setContentTitle(title)\n            .setContentText(body);\n\n    NotificationManager manager = (NotificationManager) getSystemService(NOTIFICATION_SERVICE);\n    manager.notify(NOTIFICATION_ID, builder.build());\n  }\n}\n\n\n\nManifest\u3078Service\u3092\u767b\u9332\n\nAndroidManifest.xml\n...\n    <service\n      android:name=\".MyFirebaseMessagingService\">\n      <intent-filter>\n        <action android:name=\"com.google.firebase.MESSAGING_EVENT\"/>\n      </intent-filter>\n    </service>\n  </application>\n</manifest>\n\n\n\nFirebase Cloud Messaging\u306eAPI\u3092\u53e9\u3044\u3066\u78ba\u8a8d\nFirebase Console -> \u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306e\u8a2d\u5b9a -> \u30af\u30e9\u30a6\u30c9\u30e1\u30c3\u30bb\u30fc\u30b8\u30f3\u30b0\n\u3068\u30af\u30ea\u30c3\u30af\u3057\u3066\u30b5\u30fc\u30d0\u30fc\u30ad\u30fc\u3092\u78ba\u8a8d\u3059\u308b\u3002(\u4ee5\u4e0b<SERVER_KEY>)\nregistration_token\u306fLogcat\u306a\u3069\u306b\u51fa\u529b\u3057\u3066\u78ba\u8a8d\u3059\u308b\u3002(\u4ee5\u4e0b<TARGET_DEVICE_TOKEN>)\n\nAPI\nPOST: https://fcm.googleapis.com/fcm/send\n\nHeader\nContent-Type: application/json\nAuthorization: key=<SERVER_KEY>\n\n\nBody\n{\n    \"to\" : \"<TARGET_DEVICE_TOKEN>\",\n    \"notification\" : {\n      \"body\" : \"test body\",\n      \"title\" : \"test title\"\n    }\n}\n\n\u7aef\u672b\u306bPush\u901a\u77e5\u304c\u5c4a\u3044\u305f\u3089OK\n\n\u8ffd\u8a18\nAPI\u3092\u53e9\u3044\u305f\u3068\u304d\u306e\u30ec\u30b9\u30dd\u30f3\u30b9\n\u6b63\u3057\u304fPush\u901a\u77e5\u304c\u884c\u308f\u308c\u305f\u5834\u5408\n{\n  \"multicast_id\": 8684687898872501766,\n  \"success\": 1,\n  \"failure\": 0,\n  \"canonical_ids\": 0,\n  \"results\": [\n    {\n      \"message_id\": \"0:1469764622452795%a55a89aea55a89ae\"\n    }\n  ]\n}\n\ntoken\u3092\u9593\u9055\u3048\u308b\u306a\u3069\u3001Push\u901a\u77e5\u304c\u6b63\u3057\u304f\u9001\u4fe1\u51fa\u6765\u306a\u304b\u3063\u305f\u5834\u5408\n{\n  \"multicast_id\": 7013707986156482002,\n  \"success\": 0,\n  \"failure\": 1,\n  \"canonical_ids\": 0,\n  \"results\": [\n    {\n      \"error\": \"InvalidRegistration\"\n    }\n  ]\n}\n\nAndroid\u306ePush\u901a\u77e5\u5b9f\u88c5\u306f\u3088\u304f\u5909\u308f\u308b\u306e\u3067\u81ea\u5206\u7528\u306b\u7c21\u6f54\u306a\u30e1\u30e2\u3002\n\n# \u4e8b\u524d\u6e96\u5099\n\nAndroid Studio\u3067\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u4f5c\u6210\nFirebase Console\u3067\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u4f5c\u6210\n\n# google-services.json\u306e\u751f\u6210\nFirebase Console\u3067\u4ee5\u4e0b\u306e\u4f5c\u696d\u3092\u884c\u3046\u3002\n\n- Overview\u306b\u3042\u308b\u300cAndroid\u30a2\u30d7\u30ea\u306bFirebase\u3092\u8ffd\u52a0\u300d\u3092\u30af\u30ea\u30c3\u30af\n- Android Studio\u3067\u4f5c\u6210\u3057\u305f\u30a2\u30d7\u30ea\u306e\u30d1\u30c3\u30b1\u30fc\u30b8\u540d\u3092\u5165\u529b\n- \u300c\u30a2\u30d7\u30ea\u3092\u8ffd\u52a0\u300d\u3092\u30af\u30ea\u30c3\u30af\n- `google-services.json`\u304c\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3055\u308c\u308b\n\n# Firebase\u306e\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\nAndroid Studio\u3067\u4ee5\u4e0b\u306e\u4f5c\u696d\u3092\u884c\u3046\u3002\n\n### `google-services.json`\u3092\u30e2\u30b8\u30e5\u30fc\u30eb\u76f4\u4e0b\u306b\u914d\u7f6e\n\n\u30c7\u30d5\u30a9\u30eb\u30c8\u306a\u3089\n\n```\n<PROJECT_ROOT>/app/google-services.json\n```\n\n### \u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u30eb\u30fc\u30c8\u306ebuild.gradle\u3092\u7de8\u96c6\n\n```&lt;PROJECT_ROOT&gt;/build.gradle\nbuildscript {\n  dependencies {\n    // \u8ffd\u52a0\n    classpath 'com.google.gms:google-services:3.0.0'\n  }\n}\n```\n\n### \u30e2\u30b8\u30e5\u30fc\u30eb\u306ebuild.gradle\u3092\u7de8\u96c6\n\n```&lt;PROJECT_ROOT&gt;/&lt;APP_MODULE&gt;/build.gradle\ndependencies {\n  compile fileTree(dir: 'libs', include: ['*.jar'])\n  testCompile 'junit:junit:4.12'\n  compile 'com.android.support:appcompat-v7:24.1.1'\n\n  // \u4ee5\u4e0b\u3092\u8ffd\u52a0\n  compile 'com.google.firebase:firebase-core:9.2.1'\n  compile 'com.google.firebase:firebase-messaging:9.2.1'\n}\n\n// \u8ffd\u52a0\napply plugin: 'com.google.gms.google-services'\n```\n\n\u3053\u3053\u307e\u3067\u3067\u3001Firebase Console\u306eNotification\u304b\u3089\u9001\u4fe1\u3057\u305fPush\u901a\u77e5\u3092\u53d7\u3051\u53d6\u308c\u308b\n\n# \u72ec\u81ea\u30b5\u30fc\u30d0\u306btoken\u3092\u9001\u4fe1\u3059\u308b\n\nFirebase Notification\u3092\u4f7f\u308f\u306a\u3044\u5834\u5408\u306fFCM\u306eToken\u3092\u72ec\u81ea\u30b5\u30fc\u30d0\u306b\u9001\u308b\u5fc5\u8981\u304c\u3042\u308b\u3002\n\nDocument\u306fInstanceId\u3068\u304bregistration_tokens\u3068\u304b\u66f8\u3044\u3066\u3042\u308b\u3051\u3069\u3001\nGCM\u306fregistration_id\u3060\u3063\u305f\u3001\u540d\u524d\u5909\u308f\u3063\u305f\u306e\u304b\u306a...\n\n\n### Service\u3092\u4f5c\u6210\n\nregistration_token\u306e\u751f\u6210\u3084\u66f4\u65b0\u3092\u53d7\u3051\u53d6\u308b\u305f\u3081\u306b\u3001\nFirebaseInstanceIdService\u3092\u7d99\u627f\u3057\u305fService\u3092\u751f\u6210\u3059\u308b\u5fc5\u8981\u304c\u3042\u308b\u3002\n\n```MyFirebaseInstanceIdService.java\npublic class MyFirebaseInstanceIdService extends FirebaseInstanceIdService {\n    @Override\n    public void onTokenRefresh() {\n        String refreshedToken = FirebaseInstanceId.getInstance().getToken();\n\n        // \u30b5\u30fc\u30d0\u306btoken\u3092\u9001\u4fe1\u3059\u308b\u51e6\u7406\u3092\u66f8\u304f\n    }\n}\n```\n\n### Manifest\u3078Service\u3092\u767b\u9332\n\n```AndroidManifest.xml\n...\n    <service\n      android:name=\".MyFirebaseInstanceIdService\">\n      <intent-filter>\n        <action android:name=\"com.google.firebase.INSTANCE_ID_EVENT\"/>\n      </intent-filter>\n    </service>\n  </application>\n</manifest>\n```\n\n# \u30a2\u30d7\u30ea\u8d77\u52d5\u4e2d\u306bPush\u901a\u77e5\u3092\u53d7\u3051\u53d6\u308b\n\n\u4e0a\u8a18\u307e\u3067\u3060\u3068\u3001\u30a2\u30d7\u30ea\u3092\u8d77\u52d5\u3057\u3066\u3044\u308b\u6700\u4e2d\u306b\u53d7\u3051\u53d6\u3063\u305fPush\u901a\u77e5\u304c\u8868\u793a\u3055\u308c\u306a\u3044\u3002\n\n### Service\u3092\u4f5c\u6210\n\nFirebaseMessagingService\u3092\u7d99\u627f\u3057\u305fService\u3092\u4f5c\u6210\u3059\u308b\u3053\u3068\u3067\u5bfe\u5fdc\u3002\n\n```MyFirebaseMessagingService.java\npublic class MyFirebaseMessagingService extends FirebaseMessagingService {\n  private static final int NOTIFICATION_ID = 0;\n\n  @Override\n  public void onMessageReceived(RemoteMessage remoteMessage) {\n    String title = remoteMessage.getNotification().getTitle();\n    String body = remoteMessage.getNotification().getBody();\n\n    NotificationCompat.Builder builder =\n        (NotificationCompat.Builder) new NotificationCompat.Builder(this)\n            .setSmallIcon(R.mipmap.ic_launcher)\n            .setContentTitle(title)\n            .setContentText(body);\n\n    NotificationManager manager = (NotificationManager) getSystemService(NOTIFICATION_SERVICE);\n    manager.notify(NOTIFICATION_ID, builder.build());\n  }\n}\n```\n\n### Manifest\u3078Service\u3092\u767b\u9332\n\n```AndroidManifest.xml\n...\n    <service\n      android:name=\".MyFirebaseMessagingService\">\n      <intent-filter>\n        <action android:name=\"com.google.firebase.MESSAGING_EVENT\"/>\n      </intent-filter>\n    </service>\n  </application>\n</manifest>\n```\n\n# Firebase Cloud Messaging\u306eAPI\u3092\u53e9\u3044\u3066\u78ba\u8a8d\n\nFirebase Console -> \u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306e\u8a2d\u5b9a -> \u30af\u30e9\u30a6\u30c9\u30e1\u30c3\u30bb\u30fc\u30b8\u30f3\u30b0\n\u3068\u30af\u30ea\u30c3\u30af\u3057\u3066\u30b5\u30fc\u30d0\u30fc\u30ad\u30fc\u3092\u78ba\u8a8d\u3059\u308b\u3002(\u4ee5\u4e0b&lt;SERVER_KEY&gt;)\nregistration_token\u306fLogcat\u306a\u3069\u306b\u51fa\u529b\u3057\u3066\u78ba\u8a8d\u3059\u308b\u3002(\u4ee5\u4e0b&lt;TARGET_DEVICE_TOKEN&gt;)\n\n##### API\n\n`POST: https://fcm.googleapis.com/fcm/send`\n\n##### Header\n\n```\nContent-Type: application/json\nAuthorization: key=<SERVER_KEY>\n```\n\n##### Body\n\n```\n{\n    \"to\" : \"<TARGET_DEVICE_TOKEN>\",\n    \"notification\" : {\n      \"body\" : \"test body\",\n      \"title\" : \"test title\"\n    }\n}\n```\n\n\u7aef\u672b\u306bPush\u901a\u77e5\u304c\u5c4a\u3044\u305f\u3089OK\n\n## \u8ffd\u8a18\n\nAPI\u3092\u53e9\u3044\u305f\u3068\u304d\u306e\u30ec\u30b9\u30dd\u30f3\u30b9\n\n\u6b63\u3057\u304fPush\u901a\u77e5\u304c\u884c\u308f\u308c\u305f\u5834\u5408\n\n```\n{\n  \"multicast_id\": 8684687898872501766,\n  \"success\": 1,\n  \"failure\": 0,\n  \"canonical_ids\": 0,\n  \"results\": [\n    {\n      \"message_id\": \"0:1469764622452795%a55a89aea55a89ae\"\n    }\n  ]\n}\n```\n\ntoken\u3092\u9593\u9055\u3048\u308b\u306a\u3069\u3001Push\u901a\u77e5\u304c\u6b63\u3057\u304f\u9001\u4fe1\u51fa\u6765\u306a\u304b\u3063\u305f\u5834\u5408\n\n```\n{\n  \"multicast_id\": 7013707986156482002,\n  \"success\": 0,\n  \"failure\": 1,\n  \"canonical_ids\": 0,\n  \"results\": [\n    {\n      \"error\": \"InvalidRegistration\"\n    }\n  ]\n}\n```\n", "tags": ["Android", "Firebase", "FirebaseCloudMessaging"]}