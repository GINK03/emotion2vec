{"context": "\n\n\u6982\u8981\n\u30ea\u30e2\u30fc\u30c8\u30c7\u30b9\u30af\u30c8\u30c3\u30d7\u63a5\u7d9a\u3092\u901a\u5e38\u306e\u63a5\u7d9a\u3067\u306f\u306a\u304f\u3001Linux\u30b5\u30fc\u30d0\u3092\u7d4c\u7531\u3057\u3066\u63a5\u7d9a\u3059\u308b\u5834\u5408\u3001ssh\u306e\u30dd\u30fc\u30c8\u30d5\u30a9\u30ef\u30fc\u30c7\u30a3\u30f3\u30b0\u306a\u3069\u306e\u65b9\u6cd5\u304c\u3042\u308a\u307e\u3059\u304c\n\u3053\u308c\u306f\u63a5\u7d9a\u3057\u3088\u3046\u3068\u3059\u308b\u30e6\u30fc\u30b6\u306b\u3001\u3084\u3084\u8ca0\u62c5\u304c\u3042\u308a\u307e\u3059\u3002\n\u307e\u305f\u3001Apache Guacamole\u3092\u5229\u7528\u3057\u3066\u3001\u30d6\u30e9\u30a6\u30b6\u7d4c\u7531\u3067\u30ea\u30e2\u30fc\u30c8\u30c7\u30b9\u30af\u30c8\u30c3\u30d7\u63a5\u7d9a\u3055\u305b\u308b\u3053\u3068\u3082\u3067\u304d\u307e\u3059\u304c\u3001\u74b0\u5883\u69cb\u7bc9\u304c\u3084\u3084\u9762\u5012\u3067\u3059\u3057\u3001\u3067\u304d\u308c\u3070Window\u6a19\u6e96\u306e\u30ea\u30e2\u30fc\u30c8\u30c7\u30b9\u30af\u30c8\u30c3\u30d7\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u3067\u7e4b\u304e\u305f\u3044\u3067\u3059\u3002\n\u305d\u3053\u3067\u3001\u4ee5\u4e0b\u306e\u65b9\u6cd5\u3067\u3088\u308a\u7c21\u6613\u306b\u30d5\u30a9\u30ef\u30fc\u30c7\u30a3\u30f3\u30b0\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n\u30a4\u30e1\u30fc\u30b8\u56f3\n\n\n\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\u307e\u305aLinux\u30b5\u30fc\u30d0\u306bsocat\u304c\u5165\u3063\u3066\u3044\u306a\u3051\u308c\u3070socat\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\n$ uname -a\nLinux ip-hogehoge 4.4.44-39.55.amzn1.x86_64 #1 SMP Mon Jan 30 18:15:53 UTC 2017 x86_64 x86_64 x86_64 GNU/Linux\n$ sudo yum install socat\n$ socat -V\nsocat by Gerhard Rieger - see www.dest-unreach.org\nsocat version 1.7.2.3 on Mar  6 2014 21:44:52\n   running on Linux version #1 SMP Mon Jan 30 18:15:53 UTC 2017, release 4.4.44-39.55.amzn1.x86_64, machine x86_64\nfeatures:\n  #define WITH_STDIO 1\n  #define WITH_FDNUM 1\n  #define WITH_FILE 1\n  #define WITH_CREAT 1\n  #define WITH_GOPEN 1\n  #define WITH_TERMIOS 1\n  #define WITH_PIPE 1\n  #define WITH_UNIX 1\n  #define WITH_ABSTRACT_UNIXSOCKET 1\n  #define WITH_IP4 1\n  #define WITH_IP6 1\n  #define WITH_RAWIP 1\n  #define WITH_GENERICSOCKET 1\n  #define WITH_INTERFACE 1\n  #define WITH_TCP 1\n  #define WITH_UDP 1\n  #define WITH_SCTP 1\n  #define WITH_LISTEN 1\n  #define WITH_SOCKS4 1\n  #define WITH_SOCKS4A 1\n  #define WITH_PROXY 1\n  #define WITH_SYSTEM 1\n  #define WITH_EXEC 1\n  #define WITH_READLINE 1\n  #define WITH_TUN 1\n  #define WITH_PTY 1\n  #define WITH_OPENSSL 1\n  #undef WITH_FIPS\n  #undef WITH_LIBWRAP\n  #define WITH_SYCLS 1\n  #define WITH_FILAN 1\n  #define WITH_RETRY 1\n  #define WITH_MSGLEVEL 0 /*debug*/\n\n\nsocat\u3092\u8d77\u52d5\n\u4ee5\u4e0b\u306e\u3088\u3046\u306b3389\u3067\u5f85\u3061\u3046\u3051\u3066\u3001\u5bfe\u8c61\u30b5\u30fc\u30d0\u3078\u30d5\u30a9\u30ef\u30fc\u30c7\u30a3\u30f3\u30b0\u3057\u307e\u3059\u3002\n$ socat tcp4-listen:3389,reuseaddr,fork TCP:35.160.1.26:3389\n\n\u3059\u308b\u3068\u3001\u300c63.36.3.10\u300d\u3078\u63a5\u7d9a\u3059\u308b\u3060\u3051\u3067\u3001\u3046\u307e\u304f\u63a5\u7d9a\u3092\u300c35.160.1.26\u300d\u3078\u30d5\u30a9\u30ef\u30fc\u30c7\u30a3\u30f3\u30b0\u3057\u3066\u304f\u308c\u307e\u3059\u3002\n\n\n\u8a66\u3057\u3066\u30c0\u30e1\u3060\u3063\u305f\u3053\u3068\n\u6700\u521d\u306fnc(netcat)\u3092\u5229\u7528\u3057\u3066\u3084\u308d\u3046\u3068\u3057\u307e\u3057\u305f\u304c\u3001\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f\u3002\nnc\u306f\u6a19\u6e96\u3067\u5165\u3063\u3066\u3044\u305fnc(BSD\u7248?)\u3084GNU Netcat\u3067\u3084\u308a\u307e\u3057\u305f\u304c\u3001\u7d50\u679c\u306f\u540c\u3058\u304f\u3001\u7e4b\u3044\u3060\u77ac\u9593\u306b\"connection reset by peer\"\u3068\u306a\u308a\u307e\u3057\u305f\u3002\n\nBSD_netcat\n$ mkfifo fifo\n$ nc -l 3389 < fifo | nc 35.160.1.26 3389 > fifo\n\n\n\nGNU_netcat\n$ nc -L 35.160.1.26:3389 -p 3389 -vvv\n\n\n\n\u8ffd\u8a18\n\u8a66\u3057\u306b\u591a\u6bb5\u7d4c\u7531\u3082\u3057\u3066\u307f\u307e\u3057\u305f\u304c\u3001\u554f\u984c\u306a\u304f\u63a5\u7d9a\u3067\u304d\u307e\u3057\u305f\u3002\n\n\u53c2\u8003\n\u30fbproxying through complex situations\n# \u6982\u8981\n\u30ea\u30e2\u30fc\u30c8\u30c7\u30b9\u30af\u30c8\u30c3\u30d7\u63a5\u7d9a\u3092\u901a\u5e38\u306e\u63a5\u7d9a\u3067\u306f\u306a\u304f\u3001Linux\u30b5\u30fc\u30d0\u3092\u7d4c\u7531\u3057\u3066\u63a5\u7d9a\u3059\u308b\u5834\u5408\u3001ssh\u306e\u30dd\u30fc\u30c8\u30d5\u30a9\u30ef\u30fc\u30c7\u30a3\u30f3\u30b0\u306a\u3069\u306e\u65b9\u6cd5\u304c\u3042\u308a\u307e\u3059\u304c\n\u3053\u308c\u306f\u63a5\u7d9a\u3057\u3088\u3046\u3068\u3059\u308b\u30e6\u30fc\u30b6\u306b\u3001\u3084\u3084\u8ca0\u62c5\u304c\u3042\u308a\u307e\u3059\u3002\n\n\u307e\u305f\u3001[Apache Guacamole](http://guacamole.incubator.apache.org/)\u3092\u5229\u7528\u3057\u3066\u3001\u30d6\u30e9\u30a6\u30b6\u7d4c\u7531\u3067\u30ea\u30e2\u30fc\u30c8\u30c7\u30b9\u30af\u30c8\u30c3\u30d7\u63a5\u7d9a\u3055\u305b\u308b\u3053\u3068\u3082\u3067\u304d\u307e\u3059\u304c\u3001\u74b0\u5883\u69cb\u7bc9\u304c\u3084\u3084\u9762\u5012\u3067\u3059\u3057\u3001\u3067\u304d\u308c\u3070Window\u6a19\u6e96\u306e\u30ea\u30e2\u30fc\u30c8\u30c7\u30b9\u30af\u30c8\u30c3\u30d7\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u3067\u7e4b\u304e\u305f\u3044\u3067\u3059\u3002\n\n\u305d\u3053\u3067\u3001\u4ee5\u4e0b\u306e\u65b9\u6cd5\u3067\u3088\u308a\u7c21\u6613\u306b\u30d5\u30a9\u30ef\u30fc\u30c7\u30a3\u30f3\u30b0\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n# \u30a4\u30e1\u30fc\u30b8\u56f3\n![Connection Image](https://qiita-image-store.s3.amazonaws.com/0/138821/bcf54867-808f-4535-50f2-e543d2d87485.png)\n\n# \u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\u307e\u305aLinux\u30b5\u30fc\u30d0\u306bsocat\u304c\u5165\u3063\u3066\u3044\u306a\u3051\u308c\u3070socat\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\n\n```bash\n$ uname -a\nLinux ip-hogehoge 4.4.44-39.55.amzn1.x86_64 #1 SMP Mon Jan 30 18:15:53 UTC 2017 x86_64 x86_64 x86_64 GNU/Linux\n$ sudo yum install socat\n$ socat -V\nsocat by Gerhard Rieger - see www.dest-unreach.org\nsocat version 1.7.2.3 on Mar  6 2014 21:44:52\n   running on Linux version #1 SMP Mon Jan 30 18:15:53 UTC 2017, release 4.4.44-39.55.amzn1.x86_64, machine x86_64\nfeatures:\n  #define WITH_STDIO 1\n  #define WITH_FDNUM 1\n  #define WITH_FILE 1\n  #define WITH_CREAT 1\n  #define WITH_GOPEN 1\n  #define WITH_TERMIOS 1\n  #define WITH_PIPE 1\n  #define WITH_UNIX 1\n  #define WITH_ABSTRACT_UNIXSOCKET 1\n  #define WITH_IP4 1\n  #define WITH_IP6 1\n  #define WITH_RAWIP 1\n  #define WITH_GENERICSOCKET 1\n  #define WITH_INTERFACE 1\n  #define WITH_TCP 1\n  #define WITH_UDP 1\n  #define WITH_SCTP 1\n  #define WITH_LISTEN 1\n  #define WITH_SOCKS4 1\n  #define WITH_SOCKS4A 1\n  #define WITH_PROXY 1\n  #define WITH_SYSTEM 1\n  #define WITH_EXEC 1\n  #define WITH_READLINE 1\n  #define WITH_TUN 1\n  #define WITH_PTY 1\n  #define WITH_OPENSSL 1\n  #undef WITH_FIPS\n  #undef WITH_LIBWRAP\n  #define WITH_SYCLS 1\n  #define WITH_FILAN 1\n  #define WITH_RETRY 1\n  #define WITH_MSGLEVEL 0 /*debug*/\n```\n\n# socat\u3092\u8d77\u52d5\n\u4ee5\u4e0b\u306e\u3088\u3046\u306b3389\u3067\u5f85\u3061\u3046\u3051\u3066\u3001\u5bfe\u8c61\u30b5\u30fc\u30d0\u3078\u30d5\u30a9\u30ef\u30fc\u30c7\u30a3\u30f3\u30b0\u3057\u307e\u3059\u3002\n\n```bash\n$ socat tcp4-listen:3389,reuseaddr,fork TCP:35.160.1.26:3389\n```\n\n\u3059\u308b\u3068\u3001\u300c63.36.3.10\u300d\u3078\u63a5\u7d9a\u3059\u308b\u3060\u3051\u3067\u3001\u3046\u307e\u304f\u63a5\u7d9a\u3092\u300c35.160.1.26\u300d\u3078\u30d5\u30a9\u30ef\u30fc\u30c7\u30a3\u30f3\u30b0\u3057\u3066\u304f\u308c\u307e\u3059\u3002\n![RDP Client](https://qiita-image-store.s3.amazonaws.com/0/138821/6c647e04-543d-b7ef-33ea-2e5e8fd94f08.png)\n\n# \u8a66\u3057\u3066\u30c0\u30e1\u3060\u3063\u305f\u3053\u3068\n\u6700\u521d\u306fnc(netcat)\u3092\u5229\u7528\u3057\u3066\u3084\u308d\u3046\u3068\u3057\u307e\u3057\u305f\u304c\u3001\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f\u3002\nnc\u306f\u6a19\u6e96\u3067\u5165\u3063\u3066\u3044\u305fnc(BSD\u7248?)\u3084GNU Netcat\u3067\u3084\u308a\u307e\u3057\u305f\u304c\u3001\u7d50\u679c\u306f\u540c\u3058\u304f\u3001\u7e4b\u3044\u3060\u77ac\u9593\u306b\"connection reset by peer\"\u3068\u306a\u308a\u307e\u3057\u305f\u3002\n\n```bash:BSD_netcat\n$ mkfifo fifo\n$ nc -l 3389 < fifo | nc 35.160.1.26 3389 > fifo\n```\n\n```bash:GNU_netcat\n$ nc -L 35.160.1.26:3389 -p 3389 -vvv\n```\n\n# \u8ffd\u8a18\n\u8a66\u3057\u306b\u591a\u6bb5\u7d4c\u7531\u3082\u3057\u3066\u307f\u307e\u3057\u305f\u304c\u3001\u554f\u984c\u306a\u304f\u63a5\u7d9a\u3067\u304d\u307e\u3057\u305f\u3002\n\n# \u53c2\u8003\n\u30fb[proxying through complex situations](http://geoffgarside.co.uk/2009/02/06/proxying-through-complex-situations/)\n", "tags": ["RDP", "AmazonLinux", "socat"]}