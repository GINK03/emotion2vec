{"tags": [".NET"], "context": " More than 1 year has passed since last update.\u3053\u306e\u8a18\u4e8b\u3067\u306f\u30de\u30cd\u30fc\u30b8\u30d2\u30fc\u30d7\u306e\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306e\u751f\u5b58\u671f\u9593\u3068\u30ac\u30d9\u30fc\u30b8\u30b3\u30ec\u30af\u30bf\u306e\u52d5\u4f5c\u306b\u3064\u3044\u3066\u306e\u8aac\u660e\u3092\u884c\u3046\n\u30d1\u30ef\u30fc\u30dd\u30a4\u30f3\u30c8\u7b49\u306b\u3064\u3044\u3066\u306f\u4e0b\u8a18\u304b\u3089\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3067\u304d\u308b\u3002\nhttp://needtec.sakura.ne.jp/doc/managedheap.pdf\n\n\u30de\u30cd\u30fc\u30b8\u30d2\u30fc\u30d7\u306b\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u5272\u308a\u5f53\u3066\u308b\n\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u30de\u30cd\u30fc\u30b8\u30d2\u30fc\u30d7\u306b\u683c\u7d0d\u3059\u308b\u5834\u5408\u3001\u4e0b\u8a18\u306e\u60c5\u5831\u304c\u683c\u7d0d\u3055\u308c\u308b\u3088\u3046\u306b\u3059\u308b\u3002\n\u30aa\u30fc\u30d0\u30d8\u30c3\u30c9\u30d5\u30a3\u30fc\u30eb\u30c9 (32bit\u30d7\u30ed\u30bb\u30b9:8byte, 64bit\u30d7\u30ed\u30bb\u30b9:16Byte)\n\u3000\u30fb\u578b\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u30dd\u30a4\u30f3\u30bf\u30fc\n\u3000\u3000...\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306e\u5b9f\u969b\u306e\u578b\u3092\u73fe\u3059\u578b\u69cb\u9020\u4f53\u3078\u306e\u30dd\u30a4\u30f3\u30bf\n\u3000\u30fb\u540c\u671f\u30d6\u30ed\u30c3\u30af\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\n\u3000\u3000...\u30ed\u30c3\u30af\u3068\u304bCOM\u3067\u5229\u7528\u3059\u308b\n\u578b\u306e\u30d5\u30a3\u30fc\u30eb\u30c9 \n\u6b21\u306e\u4f8b\u3067\u306f\u30de\u30cd\u30fc\u30b8\u30d2\u30fc\u30d7\u306b\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u8ffd\u52a0\u3057\u3066\u3044\u304f\u4f8b\u3092\u56f3\u3067\u8868\u3057\u305f\u3082\u306e\u3067\u3042\u308b\u3002\n\n\u3053\u306e\u72b6\u614b\u3067\u30aa\u30d6\u30b8\u30a7\u30af\u30c8A\u3092\u5272\u308a\u5f53\u3066\u3088\u3046\u3068\u3059\u308b\u3002\n\u3053\u306e\u969b\u3001\u30aa\u30fc\u30d0\u30d8\u30c3\u30c9\u30d5\u30a3\u30fc\u30eb\u30c9\u3068\u30d5\u30a3\u30fc\u30eb\u30c9\u304c\u5165\u308b\u3088\u3046\u306bNextObjPtr\u306f\u52a0\u7b97\u3055\u308c\u308b\u3002\n\n\u30aa\u30d6\u30b8\u30a7\u30af\u30c8B\u3092\u5272\u308a\u5f53\u3066\u308b\u5834\u5408\u3082\u540c\u69d8\u306b\u3001NextObjPtr\u306e\u76f4\u5f8c\u304b\u3089\u30aa\u30d6\u30b8\u30a7\u30af\u30c8B\u304c\u5272\u308a\u5f53\u3066\u3089\u308c\u308b\u3002\n\n\u3053\u306e\u3088\u3046\u306b\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306e\u5272\u308a\u5f53\u3066\u306f\u5358\u306a\u308b\u30dd\u30a4\u30f3\u30bf\u306e\u52a0\u7b97\u306a\u306e\u3067\u975e\u5e38\u306b\u901f\u3044\u3002\n\u3057\u304b\u3057\u3001\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u5272\u308a\u5f53\u3066\u7d9a\u3051\u308b\u3068\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u30de\u30cd\u30fc\u30b8\u30d2\u30fc\u30d7\u306b\u683c\u7d0d\u3067\u304d\u306a\u3044\u72b6\u6cc1\u306b\u9665\u308b\u3002\n\n\u3053\u306e\u3068\u304d\u3001\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u304c\u30a2\u30af\u30bb\u30b9\u3057\u306a\u304f\u306a\u3063\u305f\u30d2\u30fc\u30d7\u5185\u306e\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u524a\u9664\u3059\u308b\u305f\u3081\u306b\u30ac\u30d9\u30fc\u30b8\u30b3\u30ec\u30af\u30b7\u30e7\u30f3\u3092\u884c\u3046\u3002\n\n\u30ac\u30d9\u30fc\u30b8\u30b3\u30ec\u30af\u30b7\u30e7\u30f3\n\n\u30ac\u30d9\u30fc\u30b8\u30b3\u30ec\u30af\u30b7\u30e7\u30f3\u306e\u624b\u9806\n\u30ac\u30d9\u30fc\u30b8\u30b3\u30ec\u30af\u30b7\u30e7\u30f3\u306e\u624b\u9806\u306f\u4ee5\u4e0b\u306e\u901a\u308a\u3067\u3042\u308b\u3002\n\uff11\uff0e\u5168\u3066\u306e\u30b9\u30ec\u30c3\u30c9\u3092\u4e00\u6642\u505c\u6b62\n\u3000\u3000\u30ac\u30d9\u30fc\u30b8\u30b3\u30ec\u30af\u30b7\u30e7\u30f3\u7d42\u308f\u308b\u307e\u3067\u3059\u3079\u3066\u306e\u30b9\u30ec\u30c3\u30c9\u304c\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306b\u30a2\u30af\u30bb\u30b9\u3067\u304d\u306a\u3044\n\uff12\uff0e\u30de\u30fc\u30ad\u30f3\u30b0\u30d5\u30a7\u30a4\u30ba\n\u3000\u3000\u4f7f\u3063\u3066\u306a\u3044\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u63a2\u3059\n\uff13\uff0e\u30b3\u30f3\u30d1\u30af\u30b7\u30e7\u30f3\u30d5\u30a7\u30a4\u30ba\n\u3000\u3000\u4e0d\u8981\u306a\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u524a\u9664\u3057\u3066\u5727\u7e2e\u3059\u308b\n\n\u30de\u30fc\u30ad\u30f3\u30b0\u30d5\u30a7\u30a4\u30ba\n\u4f7f\u3063\u3066\u306a\u3044\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u63a2\u3057\u3001\u540c\u671f\u30d6\u30ed\u30c3\u30af\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u30d5\u30a3\u30fc\u30eb\u30c9\u306b\u542b\u307e\u308c\u3066\u3044\u308b\u30d3\u30c3\u30c8\u306b\u30de\u30fc\u30af\u3092\u4ed8\u4e0e\u3057\u3066\u3044\u304f\u4f5c\u696d\u3092\u30de\u30fc\u30ad\u30f3\u30b0\u30d5\u30a7\u30a4\u30ba\u3068\u3044\u3046\u3002\n\u4ee5\u4e0b\u306b\u305d\u306e\u4f8b\u3092\u56f3\u3067\u8868\u3059\u3002\n\n\u30af\u30e9\u30b9\u306e\u9759\u7684\u307e\u305f\u306f\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u30d5\u30a3\u30fc\u30eb\u30c9\u3001 \u30e1\u30bd\u30c3\u30c9\u306e\u5b9f\u5f15\u6570\u3001\u30ed\u30fc\u30ab\u30eb\u5909\u6570\u306a\u3069\u3067 \u53c2\u7167\u578b\u306e\u5909\u6570\u3092\u7dcf\u79f0\u3057\u3066\u30eb\u30fc\u30c8\u3068\u547c\u3076\u3002\n\u3053\u306e\u4f8b\u3060\u3068\u4ee5\u4e0b\u306e\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u304c\u30eb\u30fc\u30c8\u304b\u3089\u53c2\u7167\u3055\u308c\u3066\u3044\u308b\nA,C,D,F\n\u305d\u3057\u3066\u3001\u30aa\u30d6\u30b8\u30a7\u30af\u30c8D\u304b\u3089\u30aa\u30d6\u30b8\u30a7\u30af\u30c8G\u3092\u53c2\u7167\u3055\u308c\u3066\u3044\u308b\u3002\n\u307e\u305a\u3001\u5168\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306e\u540c\u671f\u30d6\u30ed\u30c3\u30af\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u30d5\u30a3\u30fc\u30eb\u30c9\u306b\u542b\u307e\u308c\u3066\u3044\u308b\u30d3\u30c3\u30c8\u306b\uff10\u3092\u6307\u5b9a\u3059\u308b\u3002\u3053\u308c\u306f\u3059\u3079\u3066\u306e\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u524a\u9664\u3059\u308b\u3068\u3044\u3046\u610f\u5473\u3067\u3042\u308b\u3002\n\n\u30eb\u30fc\u30c8\u304b\u3089\u76f4\u63a5\u53c2\u7167\u3055\u308c\u3066\u3044\u308b\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u30de\u30fc\u30af\u3059\u308b\u3002\n\n\u30de\u30fc\u30af\u3092\u3059\u308b\u969b\u306b\u3001\u3082\u3057\u4ed6\u306e\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092 \u53c2\u7167\u3057\u3066\u3044\u308b\u5834\u5408\u306f\u3001\u305d\u306e\u30aa\u30d6\u30b8\u30a7\u30af\u30c8 \u3082\u30de\u30fc\u30af\u3059\u308b\u3002\n\n\u3053\u306e\u4f8b\u3060\u3068\u30aa\u30d6\u30b8\u30a7\u30af\u30c8D\u304c\u53c2\u7167\u3057\u3066\u3044\u308b\u30aa\u30d6\u30b8\u30a7\u30af\u30c8G\u3092\u30de\u30fc\u30af\u3059\u308b\u3002\n\u3059\u3079\u3066\u306e\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306b\u30de\u30fc\u30af\u3092\u3064\u3051\u305f\u3089\u30de\u30fc\u30ad\u30f3\u30b0\u30d5\u30a7\u30a4\u30ba\u306f\u7d42\u4e86\u3067\u3042\u308b\u3002\u30de\u30fc\u30af\u3055\u308c\u305f\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306f\u5230\u9054\u53ef\u80fd \u3068\u3044\u3044\u3002\u30de\u30fc\u30af\u3055\u308c\u3066\u3044\u306a\u3044\u306e\u306f\u5230\u9054\u4e0d\u80fd\u3068\u3044\u3046\u3002\n\n\u30b3\u30f3\u30d1\u30af\u30b7\u30e7\u30f3\u30d5\u30a7\u30a4\u30ba\n\u30de\u30fc\u30af\u3055\u308c\u3066\u3044\u308b\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u79fb\u52d5\u3055\u305b\u3066 \u30e1\u30e2\u30ea\u4e0a\u306b\u9023\u7d9a\u3059\u308b\u3088\u3046\u3059\u308b\u3002\n\n\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u79fb\u52d5\u3055\u305b\u308b\u969b\u306b\u3001 \u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u53c2\u7167\u3057\u3066\u3044\u308b\u30eb\u30fc\u30c8\u306a\u3069\u306f\u79fb\u52d5\u3057\u305f\u5206\u306e\u30d0\u30a4\u30c8\u6570\u3092\u5f15\u304f\u5fc5\u8981\u304c\u3042\u308b\u3002\n\u30de\u30fc\u30af\u3055\u308c\u3066\u3044\u308b\u3059\u3079\u3066\u306e\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306b\u5bfe\u3057\u3066\u3001\u540c\u69d8\u306e\u51e6\u7406\u3092\u884c\u3046\u3002\n\n\u3053\u308c\u306b\u3088\u308a\u3001\u30e1\u30e2\u30ea\u306e\u7a7a\u5bb9\u91cf\u3092\u9023\u7d9a\u7684\u306b\u3057\u3001\u30de\u30cd\u30fc\u30b8\u30d2\u30fc\u30d7\u4e0a\u3067\u30e1\u30e2\u30ea\u306e\u65ad\u7247\u5316\u304c\u306a\u304f\u306a\u308b\u3002\n\n\u30ac\u30d9\u30fc\u30b8\u30b3\u30ec\u30af\u30b7\u30e7\u30f3\u3092\u884c\u3063\u3066\u3082\u30e1\u30e2\u30ea\u304c\u8db3\u308a\u306a\u3044\u5834\u5408\n\u30ac\u30d9\u30fc\u30b8\u30b3\u30ec\u30af\u30b7\u30e7\u30f3\u3092\u884c\u3063\u3066\u3082\u30e1\u30e2\u30ea\u304c\u8db3\u308a\u306a\u3044\u5834\u5408\u306fOutOfMemoryException\u306e\u4f8b\u5916\u304c\u767a\u751f\u3059\u308b\u3002 \u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306f\u305d\u306e\u4f8b\u5916\u3092\u30ad\u30e3\u30c3\u30c1\u3057\u3066\u56de\u5fa9\u3092\u8a66\u307f\u308b\u3053\u3068\u304c\u3067\u304d\u308b\u304c\u3001\u307b\u3068\u3093\u3069\u306e\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306f\u3001\u305d\u306e\u4f8b\u5916\u3092\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0\u3057\u3066\u3044\u306a\u3044\u306e\u3067\u30d7\u30ed\u30bb\u30b9\u304c\u7d42\u4e86\u3057\u3066\u3001OS\u304c\u30d7\u30ed\u30bb\u30b9\u304c\u4f7f\u7528\u3057\u3066\u3044\u305f\u30e1\u30e2\u30ea\u3092\u89e3\u653e\u3059\u308b\u3002\n\n\u30e1\u30bd\u30c3\u30c9\u5185\u306e\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306e\u751f\u5b58\u671f\u9593\u306b\u3064\u3044\u3066\n\u30e1\u30bd\u30c3\u30c9\u5185\u306e\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306e\u751f\u5b58\u671f\u9593\u306f\u6700\u5f8c\u306b\u53c2\u7167\u3057\u305f\u3068\u3053\u308d\u307e\u3067\u3067\u3042\u308b\u3002\n\u30e1\u30bd\u30c3\u30c9\u306e\u7d42\u4e86\u6642\u307e\u3067\u3067\u306f\u306a\u3044\u3002 \n\n\u306a\u304aDebug\u3067\u30d3\u30eb\u30c9\u3057\u305f\u5834\u5408\u3001JIT\u30b3\u30f3\u30d1\u30a4\u30e9\u304c\u751f\u5b58\u671f\u9593\u3092\u6063\u610f\u7684\u306b\u30e1\u30bd\u30c3\u30c9\u306e\u6700\u5f8c\u307e\u3067\u4f38\u3070\u3057\u3066\u3044\u308b\u3002\n\u3053\u306e\u3053\u3068\u306f\u3001Release\u30d3\u30eb\u30c9\u3068Debug\u30d3\u30eb\u30c9\u3067\u52d5\u4f5c\u304c\u7570\u306a\u308b\u3053\u3068\u3092\u610f\u5473\u3059\u308b\u3002\n\n\u4e16\u4ee3\u5225\u30ac\u30d9\u30fc\u30b8\u30b3\u30ec\u30af\u30bf\nCLR\u306eGC\u306f\u4e16\u4ee3\u5225\u30ac\u30ec\u30fc\u30b8\u30b3\u30ec\u30af\u30bf\u3092\u63a1\u7528\u3057\u3066\u3044\u308b\u3002\n\u4e16\u4ee3\u5225\u30ac\u30d9\u30fc\u30b8\u30b3\u30ec\u30af\u30bf\u306b\u306f\u4ee5\u4e0b\u306e\u524d\u63d0\u304c\u3042\u308b\u3002\n\u30fb\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u304c\u65b0\u3057\u3044\u307b\u3069\u3001\u305d\u306e\u751f\u5b58\u671f\u9593\u306f\u77ed\u3044\n\u30fb\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u304c\u53e4\u3044\u307b\u3069\u3001\u305d\u306e\u751f\u5b58\u671f\u9593\u306f\u9577\u3044\n\u30fb\u30d2\u30fc\u30d7\u306e\u4e00\u90e8\u5206\u306e\u56de\u53ce\u306f\u30d2\u30fc\u30d7\u5168\u4f53\u306e\u56de\u53ce\u3088\u308a\u9ad8\u901f\u3067\u3042\u308b\n\u4ee5\u4e0b\u306b\u305d\u306e\u4f8b\u3092\u56f3\u3067\u3042\u3089\u308f\u3059\u3002\n\u307e\u305a\u3001\u65b0\u3057\u304f\u8ffd\u52a0\u3055\u308c\u308b\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306f\u5e38\u306b \u4e16\u4ee3\uff10\u306b\u8ffd\u52a0\u3055\u308c\u308b\u3002\n\n\u30aa\u30d6\u30b8\u30a7\u30af\u30c8C\u3068E\u304c\u5230\u9054\u4e0d\u80fd\u3068\u306a\u308a\u3001\u305d\u306e\u5f8c\u3001\u30ac\u30d9\u30fc\u30b8\u30b3\u30ec\u30af\u30b7\u30e7\u30f3\u304c\u767a\u751f\u3057\u305f\u3068\u3059\u308b\u3002\n\n\u30ac\u30d9\u30fc\u30b8\u30b3\u30ec\u30af\u30b7\u30e7\u30f3\u306e\u5f8c\u306b\u4e16\u4ee3\uff10\u3067\u751f\u304d\u6b8b\u3063\u305f\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u304c\u4e16\u4ee3\uff11\u306b\u79fb\u52d5\u3057\u3066\u4e16\u4ee3\uff10\u306f\u7a7a\u306b\u306a\u308b\u3002\n\n\u65b0\u3057\u3044\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306f\u4e16\u4ee3\uff10\u306b\u5272\u308a\u5f53\u3066\u3089\u308c\u3066\u3044\u304f\u3002\n\u4e16\u4ee3\uff10\u306e\u4e88\u7d04\u30b5\u30a4\u30ba\u3092\u8d85\u3048\u305f\u5834\u5408\u306b \u30ac\u30d9\u30fc\u30b8\u30b3\u30ec\u30af\u30b7\u30e7\u30f3\u304c\u5b9f\u884c\u3055\u308c\u308b\u3002\n\n\u4e16\u4ee3\uff10\u306e\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306e\u307f\u304c\u691c\u67fb\u3055\u308c\u3001\u751f\u304d\u6b8b\u3063\u305f\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306f\u4e16\u4ee3\uff11\u306b\u79fb\u52d5\u3059\u308b\u3002 \u4e16\u4ee3\uff11\u306f\u691c\u67fb\u3057\u3066\u3044\u306a\u3044\u306e\u3067\u3001\u30aa\u30d6\u30b8\u30a7\u30af\u30c8B\u306f \u751f\u304d\u6b8b\u308b\n\n\u30ac\u30d9\u30fc\u30b8\u30b3\u30ec\u30af\u30b7\u30e7\u30f3\u3092\u5b9f\u884c\u3057\u3066\u3044\u304f\u3068\u3053\u306e\u3088\u3046\u306b\u4e16\u4ee3\uff11\u304c\u5f90\u3005\u306b\u5897\u52a0\u3057\u3066\u3044\u304f\u3002\n\n\u4e16\u4ee3\uff11\u306e\u30b5\u30a4\u30ba\u304c\u4e0a\u9650\u3092\u8d85\u3048\u305f\u6642\u306b\u30ac\u30d9\u30fc\u30b8\u30b3\u30ec\u30af\u30b7\u30e7\u30f3\u304c\u767a\u751f\u3057\u305f\u3068\u3059\u308b\u3002\n\n\u3053\u306e\u6642\u306f\u3001\u4e16\u4ee3\uff11\uff5e\u4e16\u4ee3\uff10\u306e\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u691c\u67fb\u3059\u308b\u3002\n\u7d50\u679c\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u306a\u308b\u3002\n\u30fb\u4e16\u4ee3\uff11\u306e\u5230\u9054\u53ef\u80fd\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306f\u4e16\u4ee3\uff12\u3068\u306a\u308b\u3002\n\u30fb\u4e16\u4ee3\uff10\u306e\u5230\u9054\u53ef\u80fd\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306f\u4e16\u4ee3\uff11\u3068\u306a\u308b\n\n\u3053\u306e\u3088\u3046\u306b\u3001\u4e16\u4ee3\u5225\u30ac\u30d9\u30fc\u30b8\u30b3\u30ec\u30af\u30bf\u3067\u306f\u3001\u3059\u3079\u3066\u306e\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u691c\u67fb\u305b\u305a\u306b\u5fc5\u8981\u306a\u4e16\u4ee3\u306e\u307f\u691c\u67fb\u3057\u3066\u3044\u308b\u3002\n\nGC\u306e\u8d77\u52d5\u8981\u56e0\nGC\u306e\u8d77\u52d5\u8981\u56e0\u306f\u4ee5\u4e0b\u306e\u901a\u308a\u3067\u3042\u308b\u3002\n\u30fb\u4e16\u4ee3\uff10\u306e\u4f7f\u7528\u91cf\u304c\u4e88\u7d04\u30b5\u30a4\u30ba\u3092\u8d85\u3048\u305f\n\u3000\u4e88\u7d04\u30b5\u30a4\u30ba\u306fCLR\u304c\u52d5\u7684\u306b\u6c7a\u3081\u308b\n\u30fbSystem.GC\u3092\u30b3\u30fc\u30c9\u3067\u5b9f\u884c\n\u30fbWindows\u304c\u7a7a\u5bb9\u91cf\u4f4e\u4e0b\u306e\u72b6\u6cc1\u3092\u5831\u544a\n\n\u30e9\u30fc\u30b8\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\nCLR\u306f\u500b\u3005\u306e\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u30b9\u30e2\u30fc\u30eb\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u304b\u30e9\u30fc\u30b8\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306e\u3069\u3061\u3089\u304b\u3067\u3042\u308b\u3068\u898b\u306a\u3059\u3002\u73fe\u572885,000\u30d0\u30a4\u30c8\u4ee5\u4e0a\u3092\u30e9\u30fc\u30b8\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3068\u307f\u306a\u3057\u3066\u3044\u308b\u3002\uff08\u203b\u305f\u3060\u3057\u3001\u5909\u66f4\u3055\u308c\u308b\u53ef\u80fd\u6027\u3042\u308b\uff09\n\u30e9\u30fc\u30b8\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306f\u30b9\u30e2\u30fc\u30eb\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3068\u9055\u3046\u30a2\u30c9\u30ec\u30b9\u7a7a\u9593\u306b\u5272\u308a\u5f53\u3066\u3089\u308c\u308b\n\u2022\u30e9\u30fc\u30b8\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u21d2Large Object Heap\uff08LOH)\n\u2022\u30b9\u30e2\u30fc\u30eb\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u21d2Small Object Heap (SOH)\nGC\u306f\u30e9\u30fc\u30b8\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306b\u5bfe\u3057\u3066\u30b3\u30f3\u30d1\u30af\u30b7\u30e7\u30f3\u3092\u884c\u308f\u306a\u3044\u3002\n\u30e9\u30fc\u30b8\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306f\u5272\u308a\u5f53\u3066\u5f8c\u3001\u3059\u3050\u306b\u4e16\u4ee3\uff12\u306e\u4e00\u90e8\u3068\u307f\u306a\u3055\u308c\u308b\u3002\n\u4e16\u4ee3\uff12\u3067GC\u304c\u5b9f\u884c\u3055\u308c\u308b\u6642\u3058\u3083\u306a\u3044\u3068\u30e9\u30fc\u30b8\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306b\u5bfe\u3057\u3066GC\u306f\u884c\u308f\u308c\u306a\u3044\u3002\n\u30e9\u30fc\u30b8\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306b\u30b3\u30f3\u30d1\u30af\u30b7\u30e7\u30f3\u3092\u884c\u308f\u306a\u3044\u3068\u3044\u3046\u3053\u3068\u306f\u30e1\u30e2\u30ea\u306e\u65ad\u7247\u5316\uff08\u30d5\u30e9\u30b0\u30e1\u30f3\u30c6\u30fc\u30b7\u30e7\u30f3\uff09\u304c\u767a\u751f\u3059\u308b\u3053\u3068\u3092\u610f\u5473\u3059\u308b\u3002\n\u3053\u308c\u3089\u306e\u52d5\u304d\u3092\u6b21\u306b\u56f3\u3067\u8868\u3059\u3002\n\n\u30aa\u30d6\u30b8\u30a7\u30af\u30c8B,C\u304c\u5230\u9054\u4e0d\u80fd\u306b\u306a\u3063\u305f\u3068\u3059\u308b\u3002\n\n\u30ac\u30d9\u30fc\u30b8\u30b3\u30ec\u30af\u30b7\u30e7\u30f3\u767a\u751f\u5f8c\u3001\u5230\u9054\u4e0d\u80fd\u306e \u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306f\u89e3\u653e\u3055\u308c\u3001\uff11\u3064\u306e\u7a7a\u304d\u5bb9\u91cf\u3092\u4f5c\u6210\u3059\u308b\u3002\u3053\u306e\u969b\u3001\u30b3\u30f3\u30d1\u30af\u30b7\u30e7\u30f3\u306f\u884c\u308f\u306a\u3044\u3002\n\n\u30aa\u30d6\u30b8\u30a7\u30af\u30c8E\u306e\u5272\u308a\u5f53\u3066\u8981\u6c42\u306b\u5bfe\u5fdc\u3059\u308b\u305f\u3081\u306b \u4f5c\u6210\u3057\u305f\u7a7a\u304d\u5bb9\u91cf\u304c\u4f7f\u7528\u3067\u304d\u308b\u3002\n\n\u3053\u306e\u3088\u3046\u306b\u30b3\u30f3\u30d1\u30af\u30b7\u30e7\u30f3\u3057\u306a\u3044\u3067\u4f7f\u3044\u7d9a\u3051\u308b\u3068\u6b21\u306e\u3088\u3046\u306b\u3001\u30e1\u30e2\u30ea\u304c\u65ad\u7247\u5316\u3059\u308b\u3002\n\n\u30e1\u30e2\u30ea\u304c\u65ad\u7247\u5316\u3059\u308b\u3068\u3001\u30c8\u30fc\u30bf\u30eb\u306e\u7a7a\u304d\u5bb9\u91cf\u3068\u3057\u3066\u306f\u5341\u5206\u306b\u8db3\u308a\u3066\u3044\u3066\u3082\u3001\u30e1\u30e2\u30ea\u304c\u5272\u308a\u5f53\u3066\u3089\u308c\u305aOutOfMemoryException\u304c\u30b9\u30eb\u30fc\u3055\u308c\u308b\u53ef\u80fd\u6027\u304c\u3042\u308b\u3002\n\n.NETFramework\u5225\u306eLOH\u306e\u65ad\u7247\u5316\nAndrew Hunter\u306f\u3001\u30e1\u30e2\u30ea\u306e\u65ad\u7247\u5316\u306b\u95a2\u3057\u3066\u306e\u6700\u60aa\u306e\u5834\u5408\u306e\u4e8b\u4f8b\u3092\u518d\u73fe\u3057\u305f\u30c6\u30b9\u30c8\u30d7\u30ed\u30b0\u30e9\u30e0\u3092\u516c\u958b\u3057\u3066\u3044\u308b\u3002\nThe Dangers of the Large Object Heap \nhttps://www.simple-talk.com/dotnet/.net-framework/the-dangers-of-the-large-object-heap/\n\u5b9f\u9a13\u30b3\u30fc\u30c9\uff1aThe Dangers of the Large Object Heap\u3000\u3088\u308a\nusing System;\nusing System.Collections.Generic;\nusing System.Text;\nusing System.Runtime;\n\n\nnamespace TestLOH\n{\n    class Program\n    {\n        /// https://www.simple-talk.com/dotnet/.net-framework/the-dangers-of-the-large-object-heap/\n        /// Static variable used to store our 'big' block. This ensures that the block is always up for garbage collection.\n        /// </summary>\n        static byte[] bigBlock;\n\n        /// <summary>\n        /// Allocates 90,000 byte blocks, optionally intersperced with larger blocks\n        /// </summary>\n        static void Fill(bool allocateBigBlocks, bool grow, bool alwaysGC)\n        {\n            // Number of bytes in a small block\n            // 90000 bytes, just above the limit for the LOH\n            const int blockSize = 90000;\n\n            // Number of bytes in a larger block: 16Mb initially\n            int largeBlockSize = 1 << 24;\n\n            // Number of small blocks allocated\n            int count = 0;\n\n            try\n            {\n                // We keep the 'small' blocks around\n                // (imagine an algorithm that allocates memory in chunks)\n                List<byte[]> smallBlocks = new List<byte[]>();\n                for (; ;)\n                {\n                    // Write out some status information\n                    if ((count % 1000) == 0)\n                    {\n                        Console.CursorLeft = 0;\n                        Console.Write(new string(' ', 20));\n                        Console.CursorLeft = 0;\n                        Console.Write(\"{0}\", count);\n                        Console.CursorLeft = 0;\n                    }\n\n                    // Force a GC if necessaryry\n                    if (alwaysGC)\n                    {\n                        GCSettings.LargeObjectHeapCompactionMode = GCLargeObjectHeapCompactionMode.CompactOnce;\n                        GC.Collect();\n                    }\n\n                    // Allocate a larger block if we're set up to do soso\n                    if (allocateBigBlocks)\n                    {\n                        bigBlock = new byte[largeBlockSize];\n                    }\n\n\n                    // The next 'large' block will be just slightly largerer\n                    if (grow) largeBlockSize++;\n\n                    // Allocate a new block\n                    smallBlocks.Add(new byte[blockSize]);\n\n                    count++;\n                }\n            }\n            catch (OutOfMemoryException)\n            {\n                // Force a GC, which should empty the LOH again\n                bigBlock = null;\n\n                GC.Collect();\n                // Display the results for the amount of memory we managed to allocate\n                Console.WriteLine(\"{0}: {1}Mb allocated\"\n                                  , (allocateBigBlocks ? \"With large blocks\" : \"Only small blocks\")\n                                  + (alwaysGC?\", frequent garbage collections\":\"\")\n                                  + (grow?\"\":\", large blocks not growing\")\n                                  , (count * blockSize) / (1024 * 1024));\n\n            }\n        }\n\n        static void Main(string[] args)\n        {\n\n            // Display results for cases both with and without the larger blocks\n            Fill(true, true, false);\n            Fill(true, true, true);\n            Fill(false, true, false);\n            Fill(true, false, false);\n\n            Console.ReadLine();\n        }\n    }\n}\n\n\n\u30c6\u30b9\u30c8\u74b0\u5883\uff1a\nVisualStudio2013 Express\u3067x86\u306e\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u4f5c\u6210\nWindows7 SP1 64bit\n\u30e1\u30e2\u30ea 4.00GB\n\u7d50\u679c\uff1a\n\n\n\nConsole\n2.0\n3.0\n3.5\n4.0\n4.5\n\n\n\n\nWith large blocks\n19Mb\n19Mb\n20Mb\n1546Mb\n1546Mb\n\n\nWith large blocks, frequent garbage collection\n23Mb\n23Mb\n23Mb\n1570Mb\n1570Mb\n\n\nOnly small blocks\n1572Mb\n1620Mb\n1588Mb\n1643Mb\n1643Mb\n\n\nWith large blocks, large blocks not growing\n1375Mb\n1596Mb\n1419Mb\n1636Mb\n1620Mb\n\n\n\n\u3053\u306e\u7d50\u679c\u3088\u308a\u3001.NET4.0\u3088\u308a\u524d\u3067\u306fLOH\u306e\u65ad\u7247\u5316\u306e\u72b6\u6cc1\u306b\u3088\u3063\u3066\u306f\u6570\u5341MB\u7a0b\u5ea6\u3057\u304b\u78ba\u4fdd\u3067\u304d\u306a\u304f\u306a\u308b\u5834\u5408\u304c\u3042\u308b\u3053\u3068\u304c\u78ba\u8a8d\u3067\u304d\u308b\u3002\n\u3053\u306e\u3053\u3068\u306f\u3001LOH\u3092\u6271\u3046\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u4f5c\u6210\u3059\u308b\u5834\u5408\u306f\u3001.NET4.0\u4ee5\u964d\u3092\u9078\u629e\u3057\u305f\u65b9\u304c\u306e\u305e\u307e\u3057\u3044\u3053\u3068\u3092\u610f\u5473\u3057\u3066\u3044\u308b\u3002\n\u306a\u304a\u3001.NET4.5.1\u3067\u306fLOH\u9818\u57df\u306b\u5bfe\u3057\u3066\u30b3\u30f3\u30d1\u30af\u30b7\u30e7\u30f3\u3092\u884c\u3046\u547d\u4ee4\u304c\u8ffd\u52a0\u3055\u308c\u3066\u3044\u308b\u3002\nUsing System;\nUsing System.Runtime;\n\n// LOH\u306b\u5bfe\u3059\u308b\u30b3\u30f3\u30d1\u30af\u30b7\u30e7\u30f3\u3092\u8981\u6c42\nGCSettings.LOHCompactionMode =\nGCLargeObjectHeapCompactionMode.CompactOnce;\n\n// GC\u304c\u767a\u751f\u3057\u3066LOH\u304c\u30b3\u30f3\u30d1\u30af\u30b7\u30e7\u30f3\u3055\u308c\u308b\nGC.Collect():\n\n\nFinalization\n\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u304cGC\u306b\u3088\u308a\u56de\u53ce\u5bfe\u8c61\u306b\u306a\u3063\u305f\u5f8c\u3067\u3001\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306e\u30e1\u30e2\u30ea\u304c\u89e3\u653e\u3055\u308c\u308b\u524d\u306b\u4f55\u3089\u304b\u306e\u30b3\u30fc\u30c9\u3092\u5b9f\u884c\u3067\u304d\u308b\u3002\nFinalize\u30e1\u30bd\u30c3\u30c9\u306e\u4f8b\uff1a\nclass Hoge{\n  // Finalize\u30e1\u30bd\u30c3\u30c9\n  ~Hode() {\n  // }\n}\n\nC++\u306e\u30c7\u30b9\u30c8\u30e9\u30af\u30bf\u3068\u4f3c\u3066\u3044\u307e\u3059\u304c\u3001\u52d5\u4f5c\u306f\u7570\u306a\u308b\u3002 \nC++\u3067\u306f\u30b9\u30b3\u30fc\u30d7\u3092\u5916\u308c\u305f\u6642\u306b\u3001\u78ba\u5b9f\u306b\u547c\u3070\u308c\u308b\u3002 \nC#\u3067\u306fFinalize\u30e1\u30bd\u30c3\u30c9\u304c\u5b9f\u884c\u3055\u308c\u308b\u30bf\u30a4\u30df\u30f3\u30b0\u306f\u5168\u304f\u5236\u5fa1\u3067\u304d\u306a\u3044\u3002\nFinalization\u306e\u52d5\u4f5c\u306b\u3064\u3044\u3066\u4ee5\u4e0b\u306b\u56f3\u3067\u3042\u3089\u308f\u3059\u3002\n\nFinalize\u30e1\u30bd\u30c3\u30c9\u304c\u5b9a\u7fa9\u3057\u3066\u3042\u308b\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092 \u5272\u308a\u5f53\u3066\u308b\u969b\u3001\u578b\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u30b3\u30f3\u30b9\u30c8\u30e9\u30af\u30bf\u30fc\u304c\u547c\u3070\u308c\u308b\u524d\u306b\u30d5\u30a1\u30a4\u30ca\u30e9\u30a4\u30bc\u30fc\u30b7\u30e7\u30f3\u30ea\u30b9\u30c8\u306b\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306e\u30dd\u30a4\u30f3\u30bf\u304c\u914d\u7f6e\u3055\u308c\u308b\u3002\n\u30aa\u30d6\u30b8\u30a7\u30af\u30c8C\u3001D\u3001F\u304c\u53c2\u7167\u3055\u308c\u306a\u304f\u306a\u3063\u305f\u3068\u3059\u308b\u3002\n\n\u305d\u306e\u5f8c\u3001\u30ac\u30d9\u30fc\u30b8\u30b3\u30ec\u30af\u30b7\u30e7\u30f3\u3092\u5b9f\u884c\u3059\u308b\u3068\u6b21\u306e\u3088\u3046\u306b\u306a\u308b\u3002\n\nFinalize\u30e1\u30bd\u30c3\u30c9\u306e\u306a\u3044\u30aa\u30d6\u30b8\u30a7\u30af\u30c8D\u306f\u524a\u9664\u3055\u308c\u3001 Finalize\u30e1\u30bd\u30c3\u30c9\u306e\u3042\u308b\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3001C\u3001F\u306fF\u30ea\u30fc\u30c1\u30e3\u30d6\u30eb\u30ad\u30e5\u30fc\u3078\u53c2\u7167\u304c\u79fb\u52d5\u3059\u308b\u3002\nF\u30ea\u30fc\u30c1\u30e3\u30d6\u30eb\u30ad\u30e5\u30fc\u306b\u30c7\u30fc\u30bf\u304c\u5165\u308b\u3068\u3001 Finalize\u7528\u306e\u30b9\u30ec\u30c3\u30c9\u304c\u52d5\u4f5c\u3057\u3066\u30ad\u30e5\u30fc\u304b\u3089\u30c7\u30fc\u30bf\u3092 \u53d6\u308a\u51fa\u3057\u3066\u3001Finalize\u30e1\u30bd\u30c3\u30c9\u3092\u5b9f\u884c\u3059\u308b\u3002\n\u3053\u306e\u7d50\u679c\u3001F\u30ea\u30fc\u30c1\u30e3\u30d6\u30eb\u30ad\u30e5\u30fc\u304b\u3089\u53c2\u7167\u304c\u6d88\u3048\u3066\u3001C,F\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306f\u5230\u9054\u4e0d\u80fd\u3068\u306a\u308b\n\n\u305d\u306e\u5f8c\u3001\u30ac\u30d9\u30fc\u30b8\u30b3\u30ec\u30af\u30b7\u30e7\u30f3\u3092\u5b9f\u884c\u3057\u305f\u5f8c\u3067 \u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306f\u524a\u9664\u3055\u308c\u308b\n\n\u3064\u307e\u308a\u3001Finalize\u3092\u4f7f\u3046\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306f\u524a\u9664\u3055\u308c\u308b\u307e\u3067\u306b\u3001\u6700\u4f4e\uff12\u56de\u306e\u30ac\u30d9\u30fc\u30b8\u30b3\u30ec\u30af\u30b7\u30e7\u30f3\u304c\u5fc5\u8981\u306b\u306a\u308b\u3002\n\n\u53c2\u8003\n\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0 .NET Framework \u7b2c4\u7248 \nhttp://www.amazon.co.jp/dp/4822294951\nCLR \u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u30d8\u30c3\u30c0\u30fc\u306e\u69cb\u9020 \nhttp://shoutakenaka.blogspot.jp/2009/09/clr.html\nThe Dangers of the Large Object Heap \nhttps://www.simple-talk.com/dotnet/.net-framework/the-dangers-of-the-large-object-heap/\n\u3053\u306e\u8a18\u4e8b\u3067\u306f\u30de\u30cd\u30fc\u30b8\u30d2\u30fc\u30d7\u306e\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306e\u751f\u5b58\u671f\u9593\u3068\u30ac\u30d9\u30fc\u30b8\u30b3\u30ec\u30af\u30bf\u306e\u52d5\u4f5c\u306b\u3064\u3044\u3066\u306e\u8aac\u660e\u3092\u884c\u3046\n\n\u30d1\u30ef\u30fc\u30dd\u30a4\u30f3\u30c8\u7b49\u306b\u3064\u3044\u3066\u306f\u4e0b\u8a18\u304b\u3089\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3067\u304d\u308b\u3002\nhttp://needtec.sakura.ne.jp/doc/managedheap.pdf\n\n\n#\u30de\u30cd\u30fc\u30b8\u30d2\u30fc\u30d7\u306b\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u5272\u308a\u5f53\u3066\u308b\n\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u30de\u30cd\u30fc\u30b8\u30d2\u30fc\u30d7\u306b\u683c\u7d0d\u3059\u308b\u5834\u5408\u3001\u4e0b\u8a18\u306e\u60c5\u5831\u304c\u683c\u7d0d\u3055\u308c\u308b\u3088\u3046\u306b\u3059\u308b\u3002\n\n __\u30aa\u30fc\u30d0\u30d8\u30c3\u30c9\u30d5\u30a3\u30fc\u30eb\u30c9__ (32bit\u30d7\u30ed\u30bb\u30b9:8byte, 64bit\u30d7\u30ed\u30bb\u30b9:16Byte)\n\u3000\u30fb\u578b\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u30dd\u30a4\u30f3\u30bf\u30fc\n\u3000\u3000...\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306e\u5b9f\u969b\u306e\u578b\u3092\u73fe\u3059\u578b\u69cb\u9020\u4f53\u3078\u306e\u30dd\u30a4\u30f3\u30bf\n\u3000\u30fb\u540c\u671f\u30d6\u30ed\u30c3\u30af\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\n\u3000\u3000...\u30ed\u30c3\u30af\u3068\u304bCOM\u3067\u5229\u7528\u3059\u308b\n __\u578b\u306e\u30d5\u30a3\u30fc\u30eb\u30c9__ \n\n\u6b21\u306e\u4f8b\u3067\u306f\u30de\u30cd\u30fc\u30b8\u30d2\u30fc\u30d7\u306b\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u8ffd\u52a0\u3057\u3066\u3044\u304f\u4f8b\u3092\u56f3\u3067\u8868\u3057\u305f\u3082\u306e\u3067\u3042\u308b\u3002\n\n![heap.png](https://qiita-image-store.s3.amazonaws.com/0/47856/d2bd9433-62cc-d114-dd3b-ae2636c9760e.png)\n\n\u3053\u306e\u72b6\u614b\u3067\u30aa\u30d6\u30b8\u30a7\u30af\u30c8A\u3092\u5272\u308a\u5f53\u3066\u3088\u3046\u3068\u3059\u308b\u3002\n\u3053\u306e\u969b\u3001\u30aa\u30fc\u30d0\u30d8\u30c3\u30c9\u30d5\u30a3\u30fc\u30eb\u30c9\u3068\u30d5\u30a3\u30fc\u30eb\u30c9\u304c\u5165\u308b\u3088\u3046\u306bNextObjPtr\u306f\u52a0\u7b97\u3055\u308c\u308b\u3002\n\n![heap.png](https://qiita-image-store.s3.amazonaws.com/0/47856/5a7ef010-5621-0544-fd34-6f08ef67f342.png)\n\n\u30aa\u30d6\u30b8\u30a7\u30af\u30c8B\u3092\u5272\u308a\u5f53\u3066\u308b\u5834\u5408\u3082\u540c\u69d8\u306b\u3001NextObjPtr\u306e\u76f4\u5f8c\u304b\u3089\u30aa\u30d6\u30b8\u30a7\u30af\u30c8B\u304c\u5272\u308a\u5f53\u3066\u3089\u308c\u308b\u3002\n![heap.png](https://qiita-image-store.s3.amazonaws.com/0/47856/f40ad465-24d8-a756-9d68-082ec8ca5ad1.png)\n\n\u3053\u306e\u3088\u3046\u306b\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306e\u5272\u308a\u5f53\u3066\u306f\u5358\u306a\u308b\u30dd\u30a4\u30f3\u30bf\u306e\u52a0\u7b97\u306a\u306e\u3067\u975e\u5e38\u306b\u901f\u3044\u3002\n\n\u3057\u304b\u3057\u3001\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u5272\u308a\u5f53\u3066\u7d9a\u3051\u308b\u3068\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u30de\u30cd\u30fc\u30b8\u30d2\u30fc\u30d7\u306b\u683c\u7d0d\u3067\u304d\u306a\u3044\u72b6\u6cc1\u306b\u9665\u308b\u3002\n![heap.png](https://qiita-image-store.s3.amazonaws.com/0/47856/0f6e4da1-3f93-c708-1d1c-e0db11abf298.png)\n\n\u3053\u306e\u3068\u304d\u3001\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u304c\u30a2\u30af\u30bb\u30b9\u3057\u306a\u304f\u306a\u3063\u305f\u30d2\u30fc\u30d7\u5185\u306e\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u524a\u9664\u3059\u308b\u305f\u3081\u306b\u30ac\u30d9\u30fc\u30b8\u30b3\u30ec\u30af\u30b7\u30e7\u30f3\u3092\u884c\u3046\u3002\n\n#\u30ac\u30d9\u30fc\u30b8\u30b3\u30ec\u30af\u30b7\u30e7\u30f3\n##\u30ac\u30d9\u30fc\u30b8\u30b3\u30ec\u30af\u30b7\u30e7\u30f3\u306e\u624b\u9806\n\u30ac\u30d9\u30fc\u30b8\u30b3\u30ec\u30af\u30b7\u30e7\u30f3\u306e\u624b\u9806\u306f\u4ee5\u4e0b\u306e\u901a\u308a\u3067\u3042\u308b\u3002\n\n\uff11\uff0e\u5168\u3066\u306e\u30b9\u30ec\u30c3\u30c9\u3092\u4e00\u6642\u505c\u6b62\n\u3000\u3000\u30ac\u30d9\u30fc\u30b8\u30b3\u30ec\u30af\u30b7\u30e7\u30f3\u7d42\u308f\u308b\u307e\u3067\u3059\u3079\u3066\u306e\u30b9\u30ec\u30c3\u30c9\u304c\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306b\u30a2\u30af\u30bb\u30b9\u3067\u304d\u306a\u3044\n\uff12\uff0e\u30de\u30fc\u30ad\u30f3\u30b0\u30d5\u30a7\u30a4\u30ba\n\u3000\u3000\u4f7f\u3063\u3066\u306a\u3044\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u63a2\u3059\n\uff13\uff0e\u30b3\u30f3\u30d1\u30af\u30b7\u30e7\u30f3\u30d5\u30a7\u30a4\u30ba\n\u3000\u3000\u4e0d\u8981\u306a\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u524a\u9664\u3057\u3066\u5727\u7e2e\u3059\u308b\n\n##\u30de\u30fc\u30ad\u30f3\u30b0\u30d5\u30a7\u30a4\u30ba\n\u4f7f\u3063\u3066\u306a\u3044\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u63a2\u3057\u3001\u540c\u671f\u30d6\u30ed\u30c3\u30af\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u30d5\u30a3\u30fc\u30eb\u30c9\u306b\u542b\u307e\u308c\u3066\u3044\u308b\u30d3\u30c3\u30c8\u306b\u30de\u30fc\u30af\u3092\u4ed8\u4e0e\u3057\u3066\u3044\u304f\u4f5c\u696d\u3092\u30de\u30fc\u30ad\u30f3\u30b0\u30d5\u30a7\u30a4\u30ba\u3068\u3044\u3046\u3002\n\n\u4ee5\u4e0b\u306b\u305d\u306e\u4f8b\u3092\u56f3\u3067\u8868\u3059\u3002\n\n![heap.png](https://qiita-image-store.s3.amazonaws.com/0/47856/3f20c6cb-9f1e-e4b6-5011-2ff5ee37699f.png)\n\n\u30af\u30e9\u30b9\u306e\u9759\u7684\u307e\u305f\u306f\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u30d5\u30a3\u30fc\u30eb\u30c9\u3001 \u30e1\u30bd\u30c3\u30c9\u306e\u5b9f\u5f15\u6570\u3001\u30ed\u30fc\u30ab\u30eb\u5909\u6570\u306a\u3069\u3067 \u53c2\u7167\u578b\u306e\u5909\u6570\u3092\u7dcf\u79f0\u3057\u3066\u30eb\u30fc\u30c8\u3068\u547c\u3076\u3002\n\n\u3053\u306e\u4f8b\u3060\u3068\u4ee5\u4e0b\u306e\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u304c\u30eb\u30fc\u30c8\u304b\u3089\u53c2\u7167\u3055\u308c\u3066\u3044\u308b\nA,C,D,F\n\n\u305d\u3057\u3066\u3001\u30aa\u30d6\u30b8\u30a7\u30af\u30c8D\u304b\u3089\u30aa\u30d6\u30b8\u30a7\u30af\u30c8G\u3092\u53c2\u7167\u3055\u308c\u3066\u3044\u308b\u3002\n\n\u307e\u305a\u3001\u5168\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306e\u540c\u671f\u30d6\u30ed\u30c3\u30af\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u30d5\u30a3\u30fc\u30eb\u30c9\u306b\u542b\u307e\u308c\u3066\u3044\u308b\u30d3\u30c3\u30c8\u306b\uff10\u3092\u6307\u5b9a\u3059\u308b\u3002\u3053\u308c\u306f\u3059\u3079\u3066\u306e\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u524a\u9664\u3059\u308b\u3068\u3044\u3046\u610f\u5473\u3067\u3042\u308b\u3002\n\n![heap.png](https://qiita-image-store.s3.amazonaws.com/0/47856/ea676485-0216-decc-de77-36564e4b3973.png)\n\n\u30eb\u30fc\u30c8\u304b\u3089\u76f4\u63a5\u53c2\u7167\u3055\u308c\u3066\u3044\u308b\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u30de\u30fc\u30af\u3059\u308b\u3002\n![heap.png](https://qiita-image-store.s3.amazonaws.com/0/47856/596855cf-d57d-85bc-17c3-48f62e43cd4b.png)\n\n\u30de\u30fc\u30af\u3092\u3059\u308b\u969b\u306b\u3001\u3082\u3057\u4ed6\u306e\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092 \u53c2\u7167\u3057\u3066\u3044\u308b\u5834\u5408\u306f\u3001\u305d\u306e\u30aa\u30d6\u30b8\u30a7\u30af\u30c8 \u3082\u30de\u30fc\u30af\u3059\u308b\u3002\n![heap.png](https://qiita-image-store.s3.amazonaws.com/0/47856/a83f951b-9a36-7b6e-7444-8ffae206aae5.png)\n\n\u3053\u306e\u4f8b\u3060\u3068\u30aa\u30d6\u30b8\u30a7\u30af\u30c8D\u304c\u53c2\u7167\u3057\u3066\u3044\u308b\u30aa\u30d6\u30b8\u30a7\u30af\u30c8G\u3092\u30de\u30fc\u30af\u3059\u308b\u3002\n\n\u3059\u3079\u3066\u306e\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306b\u30de\u30fc\u30af\u3092\u3064\u3051\u305f\u3089\u30de\u30fc\u30ad\u30f3\u30b0\u30d5\u30a7\u30a4\u30ba\u306f\u7d42\u4e86\u3067\u3042\u308b\u3002\u30de\u30fc\u30af\u3055\u308c\u305f\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306f\u5230\u9054\u53ef\u80fd \u3068\u3044\u3044\u3002\u30de\u30fc\u30af\u3055\u308c\u3066\u3044\u306a\u3044\u306e\u306f\u5230\u9054\u4e0d\u80fd\u3068\u3044\u3046\u3002\n\n##\u30b3\u30f3\u30d1\u30af\u30b7\u30e7\u30f3\u30d5\u30a7\u30a4\u30ba\n\u30de\u30fc\u30af\u3055\u308c\u3066\u3044\u308b\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u79fb\u52d5\u3055\u305b\u3066 \u30e1\u30e2\u30ea\u4e0a\u306b\u9023\u7d9a\u3059\u308b\u3088\u3046\u3059\u308b\u3002\n\n![heap.png](https://qiita-image-store.s3.amazonaws.com/0/47856/a519decc-b49c-3b19-6a8c-6b38af7df08a.png)\n\n\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u79fb\u52d5\u3055\u305b\u308b\u969b\u306b\u3001 \u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u53c2\u7167\u3057\u3066\u3044\u308b\u30eb\u30fc\u30c8\u306a\u3069\u306f\u79fb\u52d5\u3057\u305f\u5206\u306e\u30d0\u30a4\u30c8\u6570\u3092\u5f15\u304f\u5fc5\u8981\u304c\u3042\u308b\u3002\n\n\u30de\u30fc\u30af\u3055\u308c\u3066\u3044\u308b\u3059\u3079\u3066\u306e\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306b\u5bfe\u3057\u3066\u3001\u540c\u69d8\u306e\u51e6\u7406\u3092\u884c\u3046\u3002\n![heap.png](https://qiita-image-store.s3.amazonaws.com/0/47856/9eaf9e29-099f-4fbc-a552-9ef4f998b80c.png)\n\n\u3053\u308c\u306b\u3088\u308a\u3001\u30e1\u30e2\u30ea\u306e\u7a7a\u5bb9\u91cf\u3092\u9023\u7d9a\u7684\u306b\u3057\u3001\u30de\u30cd\u30fc\u30b8\u30d2\u30fc\u30d7\u4e0a\u3067\u30e1\u30e2\u30ea\u306e\u65ad\u7247\u5316\u304c\u306a\u304f\u306a\u308b\u3002\n\n## \u30ac\u30d9\u30fc\u30b8\u30b3\u30ec\u30af\u30b7\u30e7\u30f3\u3092\u884c\u3063\u3066\u3082\u30e1\u30e2\u30ea\u304c\u8db3\u308a\u306a\u3044\u5834\u5408\n\u30ac\u30d9\u30fc\u30b8\u30b3\u30ec\u30af\u30b7\u30e7\u30f3\u3092\u884c\u3063\u3066\u3082\u30e1\u30e2\u30ea\u304c\u8db3\u308a\u306a\u3044\u5834\u5408\u306fOutOfMemoryException\u306e\u4f8b\u5916\u304c\u767a\u751f\u3059\u308b\u3002 \u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306f\u305d\u306e\u4f8b\u5916\u3092\u30ad\u30e3\u30c3\u30c1\u3057\u3066\u56de\u5fa9\u3092\u8a66\u307f\u308b\u3053\u3068\u304c\u3067\u304d\u308b\u304c\u3001\u307b\u3068\u3093\u3069\u306e\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306f\u3001\u305d\u306e\u4f8b\u5916\u3092\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0\u3057\u3066\u3044\u306a\u3044\u306e\u3067\u30d7\u30ed\u30bb\u30b9\u304c\u7d42\u4e86\u3057\u3066\u3001OS\u304c\u30d7\u30ed\u30bb\u30b9\u304c\u4f7f\u7528\u3057\u3066\u3044\u305f\u30e1\u30e2\u30ea\u3092\u89e3\u653e\u3059\u308b\u3002\n\n#\u30e1\u30bd\u30c3\u30c9\u5185\u306e\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306e\u751f\u5b58\u671f\u9593\u306b\u3064\u3044\u3066\n\u30e1\u30bd\u30c3\u30c9\u5185\u306e\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306e\u751f\u5b58\u671f\u9593\u306f\u6700\u5f8c\u306b\u53c2\u7167\u3057\u305f\u3068\u3053\u308d\u307e\u3067\u3067\u3042\u308b\u3002\n __\u30e1\u30bd\u30c3\u30c9\u306e\u7d42\u4e86\u6642\u307e\u3067\u3067\u306f\u306a\u3044\u3002__ \n\n![heap.png](https://qiita-image-store.s3.amazonaws.com/0/47856/99db5af4-d73b-c180-4e6d-15465dd505ea.png)\n\n\u306a\u304aDebug\u3067\u30d3\u30eb\u30c9\u3057\u305f\u5834\u5408\u3001JIT\u30b3\u30f3\u30d1\u30a4\u30e9\u304c\u751f\u5b58\u671f\u9593\u3092\u6063\u610f\u7684\u306b\u30e1\u30bd\u30c3\u30c9\u306e\u6700\u5f8c\u307e\u3067\u4f38\u3070\u3057\u3066\u3044\u308b\u3002\n\u3053\u306e\u3053\u3068\u306f\u3001Release\u30d3\u30eb\u30c9\u3068Debug\u30d3\u30eb\u30c9\u3067\u52d5\u4f5c\u304c\u7570\u306a\u308b\u3053\u3068\u3092\u610f\u5473\u3059\u308b\u3002\n\n#\u4e16\u4ee3\u5225\u30ac\u30d9\u30fc\u30b8\u30b3\u30ec\u30af\u30bf\nCLR\u306eGC\u306f\u4e16\u4ee3\u5225\u30ac\u30ec\u30fc\u30b8\u30b3\u30ec\u30af\u30bf\u3092\u63a1\u7528\u3057\u3066\u3044\u308b\u3002\n\u4e16\u4ee3\u5225\u30ac\u30d9\u30fc\u30b8\u30b3\u30ec\u30af\u30bf\u306b\u306f\u4ee5\u4e0b\u306e\u524d\u63d0\u304c\u3042\u308b\u3002\n\n\u30fb\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u304c\u65b0\u3057\u3044\u307b\u3069\u3001\u305d\u306e\u751f\u5b58\u671f\u9593\u306f\u77ed\u3044\n\u30fb\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u304c\u53e4\u3044\u307b\u3069\u3001\u305d\u306e\u751f\u5b58\u671f\u9593\u306f\u9577\u3044\n\u30fb\u30d2\u30fc\u30d7\u306e\u4e00\u90e8\u5206\u306e\u56de\u53ce\u306f\u30d2\u30fc\u30d7\u5168\u4f53\u306e\u56de\u53ce\u3088\u308a\u9ad8\u901f\u3067\u3042\u308b\n\n\u4ee5\u4e0b\u306b\u305d\u306e\u4f8b\u3092\u56f3\u3067\u3042\u3089\u308f\u3059\u3002\n\u307e\u305a\u3001\u65b0\u3057\u304f\u8ffd\u52a0\u3055\u308c\u308b\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306f\u5e38\u306b \u4e16\u4ee3\uff10\u306b\u8ffd\u52a0\u3055\u308c\u308b\u3002\n![heap.png](https://qiita-image-store.s3.amazonaws.com/0/47856/00427b76-335b-3ce2-67d1-5a602e19d5f3.png)\n\n\u30aa\u30d6\u30b8\u30a7\u30af\u30c8C\u3068E\u304c\u5230\u9054\u4e0d\u80fd\u3068\u306a\u308a\u3001\u305d\u306e\u5f8c\u3001\u30ac\u30d9\u30fc\u30b8\u30b3\u30ec\u30af\u30b7\u30e7\u30f3\u304c\u767a\u751f\u3057\u305f\u3068\u3059\u308b\u3002\n![heap.png](https://qiita-image-store.s3.amazonaws.com/0/47856/8a6fdfe6-0b3f-f967-37fa-b77565f6962f.png)\n\n\u30ac\u30d9\u30fc\u30b8\u30b3\u30ec\u30af\u30b7\u30e7\u30f3\u306e\u5f8c\u306b\u4e16\u4ee3\uff10\u3067\u751f\u304d\u6b8b\u3063\u305f\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u304c\u4e16\u4ee3\uff11\u306b\u79fb\u52d5\u3057\u3066\u4e16\u4ee3\uff10\u306f\u7a7a\u306b\u306a\u308b\u3002\n![heap.png](https://qiita-image-store.s3.amazonaws.com/0/47856/f44f5570-c85d-e0fd-9078-29f05d1d9212.png)\n\n\n\u65b0\u3057\u3044\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306f\u4e16\u4ee3\uff10\u306b\u5272\u308a\u5f53\u3066\u3089\u308c\u3066\u3044\u304f\u3002\n\u4e16\u4ee3\uff10\u306e\u4e88\u7d04\u30b5\u30a4\u30ba\u3092\u8d85\u3048\u305f\u5834\u5408\u306b \u30ac\u30d9\u30fc\u30b8\u30b3\u30ec\u30af\u30b7\u30e7\u30f3\u304c\u5b9f\u884c\u3055\u308c\u308b\u3002\n![heap.png](https://qiita-image-store.s3.amazonaws.com/0/47856/f5466b37-7298-f9cb-4bf7-b8b7992eb833.png)\n\n\n\u4e16\u4ee3\uff10\u306e\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306e\u307f\u304c\u691c\u67fb\u3055\u308c\u3001\u751f\u304d\u6b8b\u3063\u305f\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306f\u4e16\u4ee3\uff11\u306b\u79fb\u52d5\u3059\u308b\u3002 \u4e16\u4ee3\uff11\u306f\u691c\u67fb\u3057\u3066\u3044\u306a\u3044\u306e\u3067\u3001\u30aa\u30d6\u30b8\u30a7\u30af\u30c8B\u306f \u751f\u304d\u6b8b\u308b\n![heap.png](https://qiita-image-store.s3.amazonaws.com/0/47856/19ef2c90-cc99-fb01-5d64-4c4b7f2c474c.png)\n\n\n\u30ac\u30d9\u30fc\u30b8\u30b3\u30ec\u30af\u30b7\u30e7\u30f3\u3092\u5b9f\u884c\u3057\u3066\u3044\u304f\u3068\u3053\u306e\u3088\u3046\u306b\u4e16\u4ee3\uff11\u304c\u5f90\u3005\u306b\u5897\u52a0\u3057\u3066\u3044\u304f\u3002\n![heap.png](https://qiita-image-store.s3.amazonaws.com/0/47856/cab6282e-1e5c-bf09-1ab0-7587c0993e47.png)\n\n\n\u4e16\u4ee3\uff11\u306e\u30b5\u30a4\u30ba\u304c\u4e0a\u9650\u3092\u8d85\u3048\u305f\u6642\u306b\u30ac\u30d9\u30fc\u30b8\u30b3\u30ec\u30af\u30b7\u30e7\u30f3\u304c\u767a\u751f\u3057\u305f\u3068\u3059\u308b\u3002\n![heap.png](https://qiita-image-store.s3.amazonaws.com/0/47856/f600367d-9ddf-98ef-2c03-63d97e4c3d9c.png)\n\n\u3053\u306e\u6642\u306f\u3001\u4e16\u4ee3\uff11\uff5e\u4e16\u4ee3\uff10\u306e\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u691c\u67fb\u3059\u308b\u3002\n\u7d50\u679c\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u306a\u308b\u3002\n\u30fb\u4e16\u4ee3\uff11\u306e\u5230\u9054\u53ef\u80fd\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306f\u4e16\u4ee3\uff12\u3068\u306a\u308b\u3002\n\u30fb\u4e16\u4ee3\uff10\u306e\u5230\u9054\u53ef\u80fd\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306f\u4e16\u4ee3\uff11\u3068\u306a\u308b\n\n![heap.png](https://qiita-image-store.s3.amazonaws.com/0/47856/1627f6e0-700a-267c-1821-11d8c2eb03e6.png)\n\n\u3053\u306e\u3088\u3046\u306b\u3001\u4e16\u4ee3\u5225\u30ac\u30d9\u30fc\u30b8\u30b3\u30ec\u30af\u30bf\u3067\u306f\u3001\u3059\u3079\u3066\u306e\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u691c\u67fb\u305b\u305a\u306b\u5fc5\u8981\u306a\u4e16\u4ee3\u306e\u307f\u691c\u67fb\u3057\u3066\u3044\u308b\u3002\n\n##GC\u306e\u8d77\u52d5\u8981\u56e0\nGC\u306e\u8d77\u52d5\u8981\u56e0\u306f\u4ee5\u4e0b\u306e\u901a\u308a\u3067\u3042\u308b\u3002\n\n\u30fb\u4e16\u4ee3\uff10\u306e\u4f7f\u7528\u91cf\u304c\u4e88\u7d04\u30b5\u30a4\u30ba\u3092\u8d85\u3048\u305f\n\u3000\u4e88\u7d04\u30b5\u30a4\u30ba\u306fCLR\u304c\u52d5\u7684\u306b\u6c7a\u3081\u308b\n\u30fbSystem.GC\u3092\u30b3\u30fc\u30c9\u3067\u5b9f\u884c\n\u30fbWindows\u304c\u7a7a\u5bb9\u91cf\u4f4e\u4e0b\u306e\u72b6\u6cc1\u3092\u5831\u544a\n\n#\u30e9\u30fc\u30b8\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\nCLR\u306f\u500b\u3005\u306e\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u30b9\u30e2\u30fc\u30eb\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u304b\u30e9\u30fc\u30b8\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306e\u3069\u3061\u3089\u304b\u3067\u3042\u308b\u3068\u898b\u306a\u3059\u3002\u73fe\u572885,000\u30d0\u30a4\u30c8\u4ee5\u4e0a\u3092\u30e9\u30fc\u30b8\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3068\u307f\u306a\u3057\u3066\u3044\u308b\u3002\uff08\u203b\u305f\u3060\u3057\u3001\u5909\u66f4\u3055\u308c\u308b\u53ef\u80fd\u6027\u3042\u308b\uff09\n\n\u30e9\u30fc\u30b8\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306f\u30b9\u30e2\u30fc\u30eb\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3068\u9055\u3046\u30a2\u30c9\u30ec\u30b9\u7a7a\u9593\u306b\u5272\u308a\u5f53\u3066\u3089\u308c\u308b\n\u2022\u30e9\u30fc\u30b8\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u21d2Large Object Heap\uff08LOH)\n\u2022\u30b9\u30e2\u30fc\u30eb\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u21d2Small Object Heap (SOH)\n\nGC\u306f\u30e9\u30fc\u30b8\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306b\u5bfe\u3057\u3066\u30b3\u30f3\u30d1\u30af\u30b7\u30e7\u30f3\u3092\u884c\u308f\u306a\u3044\u3002\n\n\u30e9\u30fc\u30b8\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306f\u5272\u308a\u5f53\u3066\u5f8c\u3001\u3059\u3050\u306b\u4e16\u4ee3\uff12\u306e\u4e00\u90e8\u3068\u307f\u306a\u3055\u308c\u308b\u3002\n\u4e16\u4ee3\uff12\u3067GC\u304c\u5b9f\u884c\u3055\u308c\u308b\u6642\u3058\u3083\u306a\u3044\u3068\u30e9\u30fc\u30b8\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306b\u5bfe\u3057\u3066GC\u306f\u884c\u308f\u308c\u306a\u3044\u3002\n\n\u30e9\u30fc\u30b8\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306b\u30b3\u30f3\u30d1\u30af\u30b7\u30e7\u30f3\u3092\u884c\u308f\u306a\u3044\u3068\u3044\u3046\u3053\u3068\u306f\u30e1\u30e2\u30ea\u306e\u65ad\u7247\u5316\uff08\u30d5\u30e9\u30b0\u30e1\u30f3\u30c6\u30fc\u30b7\u30e7\u30f3\uff09\u304c\u767a\u751f\u3059\u308b\u3053\u3068\u3092\u610f\u5473\u3059\u308b\u3002\n\n\u3053\u308c\u3089\u306e\u52d5\u304d\u3092\u6b21\u306b\u56f3\u3067\u8868\u3059\u3002\n![heap.png](https://qiita-image-store.s3.amazonaws.com/0/47856/06be4e26-12b1-c226-2e00-00f46e504451.png)\n\n\u30aa\u30d6\u30b8\u30a7\u30af\u30c8B,C\u304c\u5230\u9054\u4e0d\u80fd\u306b\u306a\u3063\u305f\u3068\u3059\u308b\u3002\n![heap.png](https://qiita-image-store.s3.amazonaws.com/0/47856/d03d8bed-09e0-20e9-60b7-80a5faeb1656.png)\n\n\u30ac\u30d9\u30fc\u30b8\u30b3\u30ec\u30af\u30b7\u30e7\u30f3\u767a\u751f\u5f8c\u3001\u5230\u9054\u4e0d\u80fd\u306e \u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306f\u89e3\u653e\u3055\u308c\u3001\uff11\u3064\u306e\u7a7a\u304d\u5bb9\u91cf\u3092\u4f5c\u6210\u3059\u308b\u3002\u3053\u306e\u969b\u3001\u30b3\u30f3\u30d1\u30af\u30b7\u30e7\u30f3\u306f\u884c\u308f\u306a\u3044\u3002\n![heap.png](https://qiita-image-store.s3.amazonaws.com/0/47856/7583337e-cd2e-571e-332c-60a6c2a317da.png)\n\n\u30aa\u30d6\u30b8\u30a7\u30af\u30c8E\u306e\u5272\u308a\u5f53\u3066\u8981\u6c42\u306b\u5bfe\u5fdc\u3059\u308b\u305f\u3081\u306b \u4f5c\u6210\u3057\u305f\u7a7a\u304d\u5bb9\u91cf\u304c\u4f7f\u7528\u3067\u304d\u308b\u3002\n![heap.png](https://qiita-image-store.s3.amazonaws.com/0/47856/8906c0d2-d06b-b753-216e-e85d68cffc65.png)\n\n\u3053\u306e\u3088\u3046\u306b\u30b3\u30f3\u30d1\u30af\u30b7\u30e7\u30f3\u3057\u306a\u3044\u3067\u4f7f\u3044\u7d9a\u3051\u308b\u3068\u6b21\u306e\u3088\u3046\u306b\u3001\u30e1\u30e2\u30ea\u304c\u65ad\u7247\u5316\u3059\u308b\u3002\n![heap.png](https://qiita-image-store.s3.amazonaws.com/0/47856/04daa6dd-fa3c-8721-cf29-2398e2ce0d05.png)\n\n\u30e1\u30e2\u30ea\u304c\u65ad\u7247\u5316\u3059\u308b\u3068\u3001\u30c8\u30fc\u30bf\u30eb\u306e\u7a7a\u304d\u5bb9\u91cf\u3068\u3057\u3066\u306f\u5341\u5206\u306b\u8db3\u308a\u3066\u3044\u3066\u3082\u3001\u30e1\u30e2\u30ea\u304c\u5272\u308a\u5f53\u3066\u3089\u308c\u305aOutOfMemoryException\u304c\u30b9\u30eb\u30fc\u3055\u308c\u308b\u53ef\u80fd\u6027\u304c\u3042\u308b\u3002\n\n##.NETFramework\u5225\u306eLOH\u306e\u65ad\u7247\u5316\nAndrew Hunter\u306f\u3001\u30e1\u30e2\u30ea\u306e\u65ad\u7247\u5316\u306b\u95a2\u3057\u3066\u306e\u6700\u60aa\u306e\u5834\u5408\u306e\u4e8b\u4f8b\u3092\u518d\u73fe\u3057\u305f\u30c6\u30b9\u30c8\u30d7\u30ed\u30b0\u30e9\u30e0\u3092\u516c\u958b\u3057\u3066\u3044\u308b\u3002\n\n __The Dangers of the Large Object Heap__ \nhttps://www.simple-talk.com/dotnet/.net-framework/the-dangers-of-the-large-object-heap/\n\n\n\u5b9f\u9a13\u30b3\u30fc\u30c9\uff1aThe Dangers of the Large Object Heap\u3000\u3088\u308a\n\n```csharp\nusing System;\nusing System.Collections.Generic;\nusing System.Text;\nusing System.Runtime;\n\n \nnamespace TestLOH\n{\n    class Program\n    {\n        /// https://www.simple-talk.com/dotnet/.net-framework/the-dangers-of-the-large-object-heap/\n        /// Static variable used to store our 'big' block. This ensures that the block is always up for garbage collection.\n        /// </summary>\n        static byte[] bigBlock;\n\n        /// <summary>\n        /// Allocates 90,000 byte blocks, optionally intersperced with larger blocks\n        /// </summary>\n        static void Fill(bool allocateBigBlocks, bool grow, bool alwaysGC)\n        {\n            // Number of bytes in a small block\n            // 90000 bytes, just above the limit for the LOH\n            const int blockSize = 90000;\n\n            // Number of bytes in a larger block: 16Mb initially\n            int largeBlockSize = 1 << 24;\n\n            // Number of small blocks allocated\n            int count = 0;\n\n            try\n            {\n                // We keep the 'small' blocks around\n                // (imagine an algorithm that allocates memory in chunks)\n                List<byte[]> smallBlocks = new List<byte[]>();\n                for (; ;)\n                {\n                    // Write out some status information\n                    if ((count % 1000) == 0)\n                    {\n                        Console.CursorLeft = 0;\n                        Console.Write(new string(' ', 20));\n                        Console.CursorLeft = 0;\n                        Console.Write(\"{0}\", count);\n                        Console.CursorLeft = 0;\n                    }\n\n                    // Force a GC if necessaryry\n                    if (alwaysGC)\n                    {\n                        GCSettings.LargeObjectHeapCompactionMode = GCLargeObjectHeapCompactionMode.CompactOnce;\n                        GC.Collect();\n                    }\n \n                    // Allocate a larger block if we're set up to do soso\n                    if (allocateBigBlocks)\n                    {\n                        bigBlock = new byte[largeBlockSize];\n                    }\n \n\n                    // The next 'large' block will be just slightly largerer\n                    if (grow) largeBlockSize++;\n \n                    // Allocate a new block\n                    smallBlocks.Add(new byte[blockSize]);\n\n                    count++;\n                }\n            }\n            catch (OutOfMemoryException)\n            {\n                // Force a GC, which should empty the LOH again\n                bigBlock = null;\n\n                GC.Collect();\n                // Display the results for the amount of memory we managed to allocate\n                Console.WriteLine(\"{0}: {1}Mb allocated\"\n                                  , (allocateBigBlocks ? \"With large blocks\" : \"Only small blocks\")\n                                  + (alwaysGC?\", frequent garbage collections\":\"\")\n                                  + (grow?\"\":\", large blocks not growing\")\n                                  , (count * blockSize) / (1024 * 1024));\n\n            }\n        }\n \n        static void Main(string[] args)\n        {\n\n            // Display results for cases both with and without the larger blocks\n            Fill(true, true, false);\n            Fill(true, true, true);\n            Fill(false, true, false);\n            Fill(true, false, false);\n        \n            Console.ReadLine();\n        }\n    }\n}\n\n```\n\n\u30c6\u30b9\u30c8\u74b0\u5883\uff1a\nVisualStudio2013 Express\u3067x86\u306e\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u4f5c\u6210\nWindows7 SP1 64bit\n\u30e1\u30e2\u30ea 4.00GB\n\n\u7d50\u679c\uff1a\n\n|Console|2.0|3.0|3.5|4.0|4.5|\n|:------|:--|:--|:--|:--|:--|\n|With large blocks|19Mb|19Mb|20Mb|1546Mb|1546Mb|\n|With large blocks, frequent garbage collection|23Mb|23Mb|23Mb|1570Mb|1570Mb|\n|Only small blocks|1572Mb|1620Mb|1588Mb|1643Mb|1643Mb|\n|With large blocks, large blocks not growing|1375Mb|1596Mb|1419Mb|1636Mb|1620Mb|\n\n\n\u3053\u306e\u7d50\u679c\u3088\u308a\u3001.NET4.0\u3088\u308a\u524d\u3067\u306fLOH\u306e\u65ad\u7247\u5316\u306e\u72b6\u6cc1\u306b\u3088\u3063\u3066\u306f\u6570\u5341MB\u7a0b\u5ea6\u3057\u304b\u78ba\u4fdd\u3067\u304d\u306a\u304f\u306a\u308b\u5834\u5408\u304c\u3042\u308b\u3053\u3068\u304c\u78ba\u8a8d\u3067\u304d\u308b\u3002\n\n\u3053\u306e\u3053\u3068\u306f\u3001LOH\u3092\u6271\u3046\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u4f5c\u6210\u3059\u308b\u5834\u5408\u306f\u3001.NET4.0\u4ee5\u964d\u3092\u9078\u629e\u3057\u305f\u65b9\u304c\u306e\u305e\u307e\u3057\u3044\u3053\u3068\u3092\u610f\u5473\u3057\u3066\u3044\u308b\u3002\n\n\u306a\u304a\u3001.NET4.5.1\u3067\u306fLOH\u9818\u57df\u306b\u5bfe\u3057\u3066\u30b3\u30f3\u30d1\u30af\u30b7\u30e7\u30f3\u3092\u884c\u3046\u547d\u4ee4\u304c\u8ffd\u52a0\u3055\u308c\u3066\u3044\u308b\u3002\n\n```csharp\nUsing System;\nUsing System.Runtime;\n\n// LOH\u306b\u5bfe\u3059\u308b\u30b3\u30f3\u30d1\u30af\u30b7\u30e7\u30f3\u3092\u8981\u6c42\nGCSettings.LOHCompactionMode =\nGCLargeObjectHeapCompactionMode.CompactOnce;\n\n// GC\u304c\u767a\u751f\u3057\u3066LOH\u304c\u30b3\u30f3\u30d1\u30af\u30b7\u30e7\u30f3\u3055\u308c\u308b\nGC.Collect():\n```\n\n#Finalization\n\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u304cGC\u306b\u3088\u308a\u56de\u53ce\u5bfe\u8c61\u306b\u306a\u3063\u305f\u5f8c\u3067\u3001\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306e\u30e1\u30e2\u30ea\u304c\u89e3\u653e\u3055\u308c\u308b\u524d\u306b\u4f55\u3089\u304b\u306e\u30b3\u30fc\u30c9\u3092\u5b9f\u884c\u3067\u304d\u308b\u3002\n\nFinalize\u30e1\u30bd\u30c3\u30c9\u306e\u4f8b\uff1a\n\n```csharp\nclass Hoge{\n  // Finalize\u30e1\u30bd\u30c3\u30c9\n  ~Hode() {\n  // }\n}\n```\n\nC++\u306e\u30c7\u30b9\u30c8\u30e9\u30af\u30bf\u3068\u4f3c\u3066\u3044\u307e\u3059\u304c\u3001\u52d5\u4f5c\u306f\u7570\u306a\u308b\u3002 \nC++\u3067\u306f\u30b9\u30b3\u30fc\u30d7\u3092\u5916\u308c\u305f\u6642\u306b\u3001\u78ba\u5b9f\u306b\u547c\u3070\u308c\u308b\u3002 \nC#\u3067\u306fFinalize\u30e1\u30bd\u30c3\u30c9\u304c\u5b9f\u884c\u3055\u308c\u308b\u30bf\u30a4\u30df\u30f3\u30b0\u306f\u5168\u304f\u5236\u5fa1\u3067\u304d\u306a\u3044\u3002\n\nFinalization\u306e\u52d5\u4f5c\u306b\u3064\u3044\u3066\u4ee5\u4e0b\u306b\u56f3\u3067\u3042\u3089\u308f\u3059\u3002\n![heap.png](https://qiita-image-store.s3.amazonaws.com/0/47856/7321f8be-be21-f042-f33f-d9c4ecdf63d0.png)\n\nFinalize\u30e1\u30bd\u30c3\u30c9\u304c\u5b9a\u7fa9\u3057\u3066\u3042\u308b\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092 \u5272\u308a\u5f53\u3066\u308b\u969b\u3001\u578b\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u30b3\u30f3\u30b9\u30c8\u30e9\u30af\u30bf\u30fc\u304c\u547c\u3070\u308c\u308b\u524d\u306b\u30d5\u30a1\u30a4\u30ca\u30e9\u30a4\u30bc\u30fc\u30b7\u30e7\u30f3\u30ea\u30b9\u30c8\u306b\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306e\u30dd\u30a4\u30f3\u30bf\u304c\u914d\u7f6e\u3055\u308c\u308b\u3002\n\n\u30aa\u30d6\u30b8\u30a7\u30af\u30c8C\u3001D\u3001F\u304c\u53c2\u7167\u3055\u308c\u306a\u304f\u306a\u3063\u305f\u3068\u3059\u308b\u3002\n![heap.png](https://qiita-image-store.s3.amazonaws.com/0/47856/5431ab76-cf0b-1bb9-a62f-a333e7db4950.png)\n\n\n\u305d\u306e\u5f8c\u3001\u30ac\u30d9\u30fc\u30b8\u30b3\u30ec\u30af\u30b7\u30e7\u30f3\u3092\u5b9f\u884c\u3059\u308b\u3068\u6b21\u306e\u3088\u3046\u306b\u306a\u308b\u3002\n![heap.png](https://qiita-image-store.s3.amazonaws.com/0/47856/af9c74e0-858b-a364-6252-955752a81c3d.png)\n\nFinalize\u30e1\u30bd\u30c3\u30c9\u306e\u306a\u3044\u30aa\u30d6\u30b8\u30a7\u30af\u30c8D\u306f\u524a\u9664\u3055\u308c\u3001 Finalize\u30e1\u30bd\u30c3\u30c9\u306e\u3042\u308b\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3001C\u3001F\u306fF\u30ea\u30fc\u30c1\u30e3\u30d6\u30eb\u30ad\u30e5\u30fc\u3078\u53c2\u7167\u304c\u79fb\u52d5\u3059\u308b\u3002\n\nF\u30ea\u30fc\u30c1\u30e3\u30d6\u30eb\u30ad\u30e5\u30fc\u306b\u30c7\u30fc\u30bf\u304c\u5165\u308b\u3068\u3001 Finalize\u7528\u306e\u30b9\u30ec\u30c3\u30c9\u304c\u52d5\u4f5c\u3057\u3066\u30ad\u30e5\u30fc\u304b\u3089\u30c7\u30fc\u30bf\u3092 \u53d6\u308a\u51fa\u3057\u3066\u3001Finalize\u30e1\u30bd\u30c3\u30c9\u3092\u5b9f\u884c\u3059\u308b\u3002\n\u3053\u306e\u7d50\u679c\u3001F\u30ea\u30fc\u30c1\u30e3\u30d6\u30eb\u30ad\u30e5\u30fc\u304b\u3089\u53c2\u7167\u304c\u6d88\u3048\u3066\u3001C,F\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306f\u5230\u9054\u4e0d\u80fd\u3068\u306a\u308b\n\n![heap.png](https://qiita-image-store.s3.amazonaws.com/0/47856/f4ff7784-c6d2-c46e-5e74-bce9cc06ce87.png)\n\n\u305d\u306e\u5f8c\u3001\u30ac\u30d9\u30fc\u30b8\u30b3\u30ec\u30af\u30b7\u30e7\u30f3\u3092\u5b9f\u884c\u3057\u305f\u5f8c\u3067 \u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306f\u524a\u9664\u3055\u308c\u308b\n![heap.png](https://qiita-image-store.s3.amazonaws.com/0/47856/bd9f669a-5766-d271-656c-39a06c8018fa.png)\n\n\u3064\u307e\u308a\u3001Finalize\u3092\u4f7f\u3046\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306f\u524a\u9664\u3055\u308c\u308b\u307e\u3067\u306b\u3001\u6700\u4f4e\uff12\u56de\u306e\u30ac\u30d9\u30fc\u30b8\u30b3\u30ec\u30af\u30b7\u30e7\u30f3\u304c\u5fc5\u8981\u306b\u306a\u308b\u3002\n\n#\u53c2\u8003\n __\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0 .NET Framework \u7b2c4\u7248__ \nhttp://www.amazon.co.jp/dp/4822294951\n\n __CLR \u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u30d8\u30c3\u30c0\u30fc\u306e\u69cb\u9020__ \nhttp://shoutakenaka.blogspot.jp/2009/09/clr.html\n\n __The Dangers of the Large Object Heap__ \nhttps://www.simple-talk.com/dotnet/.net-framework/the-dangers-of-the-large-object-heap/\n"}