{"context": " More than 1 year has passed since last update.\u30aa\u30f3\u30e9\u30a4\u30f3SICP\u8aad\u66f8\u5973\u5b50\u4f1a #5 (1.2.5~1.2.6) \u7528\u306e\u3081\u3082\u301c.\n\nex 1.19\n\n\u7df4\u7fd2\u554f\u984c 1.19: \u30d5\u30a3\u30dc\u30ca\u30c3\u30c1\u6570\u3092\u5bfe\u6570\u7684\u30b9\u30c6\u30c3\u30d7\u6570\u3067\u8a08\u7b97\u3059\u308b\u5de7\u5999\u306a\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u304c\u3042\u308b\u30021.2.2 \u7bc0\u306e fib-iter \u30d7\u30ed\u30bb\u30b9\u3067\u306e\u72b6\u614b\u5909\u6570 a \u3068 b \u306e\u5909\u63db\u3001a \u2190 a + b\u3001b \u2190 a \u3092\u601d\u3044\u51fa\u305d\u3046\u3002\u3053\u306e\u5909\u63db\u3092 T \u3068\u547c\u3076\u3053\u3068\u306b\u3059\u308b\u3002\u3059\u308b\u3068\u30011 \u3068 0 \u304b\u3089\u59cb\u3081\u3066 T \u3092\u7e70\u308a\u8fd4\u3057 n \u56de\u9069\u7528\u3059\u308b\u3068 Fib(n + 1) \u3068 Fib(n) \u3068\u3044\u3046\u30da\u30a2\u304c\u3067\u304d\u308b\u3053\u3068\u306b\u306a\u308b\u3002\u8a00\u3044\u63db\u3048\u308c\u3070\u3001\u30d5\u30a3\u30dc\u30ca\u30c3\u30c1\u6570\u306f\u30da\u30a2 (1, 0) \u306b\u5bfe\u3057\u3066 T n (\u5909\u63db T \u306e n \u4e57) \u3092\u9069\u7528\u3059\u308b\u3053\u3068\u3067\u6c42\u3081\u3089\u308c\u308b\u3068\u3044\u3046\u3053\u3068\u3060\u3002\u3053\u3053\u3067\u3001(a, b) \u3068\u3044\u3046\u30da\u30a2\u3092 a \u2190 bq + aq + ap \u3068 b \u2190 bp + aq \u306b\u5909\u63db\u3059\u308b\u3088\u3046\u306a\u5909\u63db\u65cf T pq \u306e\u7279\u6b8a\u306a\u5834\u5408 (p = 0\u3001q = 1) \u3068\u3057\u3066 T \u3092\u8003\u3048\u308b\u3053\u3068\u306b\u3059\u308b\u3002\u3053\u306e\u3088\u3046\u306a\u5909\u63db T pq \u3092\u4e8c\u56de\u9069\u7528\u3059\u308b\u3068\u3001\u305d\u306e\u52b9\u679c\u306f\u540c\u3058\u5f62\u5f0f\u3092\u6301\u3064 T p \u2032 q \u2032 \u3092\u4e00\u56de\u9069\u7528\u3059\u308b\u306e\u3068\u540c\u3058\u3067\u3042\u308b\u3053\u3068\u3092\u793a\u3057\u3001p \u3068 q \u306b\u5bfe\u3059\u308b p \u2032 \u3068 q \u2032 \u3092\u6c42\u3081\u3088\u3002\u3053\u3046\u3059\u308b\u3068\u3001\u3053\u306e\u7a2e\u306e\u5909\u63db\u306b\u5bfe\u3059\u308b\u4e8c\u4e57\u3092\u660e\u793a\u7684\u306b\u884c\u3046\u3053\u3068\u304c\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u308a\u3001fast-expt \u624b\u7d9a\u304d\u3068\u540c\u3058\u3088\u3046\u306b\u3001T n \u3092\u4e8c\u4e57\u306e\u9023\u7d9a\u306b\u3088\u3063\u3066\u6c42\u3081\u3089\u308c\u308b\u3088\u3046\u306b\u306a\u308b\u3002\u3053\u308c\u3089\u3092\u3059\u3079\u3066\u7d44\u307f\u5408\u308f\u305b\u3066\u3001\u5bfe\u6570\u7684\u30b9\u30c6\u30c3\u30d7\u6570\u3067\u52d5\u304f\u6b21\u306e\u624b\u7d9a\u304d\u3092\u5b8c\u6210\u3055\u305b\u3088\u3002\n(define (fib-1.19 n)\n    (fib-iter 1 0 0 1 n))\n\n(define (fib-iter a b p q count)\n    (cond\n        ((= count 0) b)\n        ((even? count)\n            (fib-iter\n                a\n                b\n                (+ (* p p) (* q q)) ; p\u2019 \u3092\u8a08\u7b97\u3059\u308b\n                (+ (* 2 p q) (* q q)) ; q\u2019 \u3092\u8a08\u7b97\u3059\u308b\n                (/ count 2)))\n        (else\n            (fib-iter\n                (+ (* b q) (* a q) (* a p))\n                (+ (* b p) (* a q))\n                p\n                q\n                (- count 1)))))\n\n\n\u3058\u3076\u3093\u306e\u56de\u7b54.\n; T_pq :: (\u5143\u306e\u6f38\u5316\u5f0f)\n;   a <- bq + aq + ap\n;   b <- bp + aq\n;\n; T_pq x0 :: (i=0 \u306e\u5834\u5408)\n;   (a0, b0)\n;\n; T_pq x1 :: (i=1 \u306e\u5834\u5408)\n;   a1 <- b0q + a0q + a0p\n;   b1 <- b0p + a0q\n;\n; T_pq x2 :: (i=2 \u306e\u5834\u5408, \u304c\u3093\u3070\u3063\u3066\u5c55\u958b\uff06\u518d\u69cb\u6210)\n;\n;   a2 <- b1q + a1q + a1p\n;       = (b0p + a0q)q + (b0q + a0q + a0p)q + (b0q + a0q + a0p)p\n;       = b0pq + a0qq + b0qq + a0qq + a0pq + b0pq + a0pq + a0pp\n;       = b0(pq + qq + pq) + a0(qq + qq + pq + pq + pp)\n;       = b0(2pq + qq) + a0(pp + 2pq + 2qq)\n;       = b0(2pq + qq) + a0(2pq + qq) + a0(pp + qq)\n;   a2.p' = pp + qq\n;   a2.q' = 2pq + qq\n;\n;   b2 <- b1p + a1q\n;       = (b0p + a0q)p + (b0q + a0q + a0p)q\n;       = b0pp + a0pq + b0qq + a0qq + a0pq\n;       = b0(pp + qq) + a0(pq + qq + pq)\n;       = b0(pp + qq) + a0(2pq + qq)\n;   b2.p' = pp + qq\n;   b2.q' = 2pq + qq\n\na(i=2) \u3092\u5c55\u958b\u3057\u305f\u5834\u5408\u3067\u3082 b(i=2) \u3092\u5c55\u958b\u3057\u305f\u5834\u5408\u3067\u3082,\np' \u3068 q' \u304c\u3061\u3083\u3093\u3068\u540c\u3058\u306b\u306a\u308b\u306e\u304c\u306a\u3093\u3060\u304b\u3075\u3057\u304e\u301c.\n\u7b97\u51fa\u3057\u305f p' \u3068 q' \u306e\u5024\u3092\u4f7f\u3063\u3066, \u554f\u984c\u6587\u4e2d\u306b\u3042\u3063\u305f\u5f0f\u306e\u7a7a\u6b04\u3092\u57cb\u3081\u3066\u5b8c\u6210.\n(define (fib-1.19 n)\n    (fib-iter 1 0 0 1 n))\n\n(define (fib-iter a b p q count)\n    (cond\n        ((= count 0) b)\n        ((even? count)\n            (fib-iter\n                a\n                b\n                (+ (* p p) (* q q)) ; p\u2019 \u3092\u8a08\u7b97\u3059\u308b\n                (+ (* 2 p q) (* q q)) ; q\u2019 \u3092\u8a08\u7b97\u3059\u308b\n                (/ count 2)))\n        (else\n            (fib-iter\n                (+ (* b q) (* a q) (* a p))\n                (+ (* b p) (* a q))\n                p\n                q\n                (- count 1)))))\n\n\u691c\u7b97\u301c.\n; gosh> (fib-1.19 0)\n; 0\n; gosh> (fib-1.19 1)\n; 1\n; gosh> (fib-1.19 2)\n; 1\n; gosh> (fib-1.19 3)\n; 2\n; gosh> (fib-1.19 4)\n; 3\n; gosh> (fib-1.19 5)\n; 5\n; gosh> (fib-1.19 6)\n; 8\n; gosh> (fib-1.19 7)\n; 13\n; gosh> (fib-1.19 8)\n; 21\n; gosh> (fib-1.19 9)\n; 34\n; gosh> (fib-1.19 10)\n; 55\n\n; gosh> (fib-1.19 11)\n; 89\n; gosh> (fib-1.19 12)\n; 144\n; gosh> (fib-1.19 13)\n; 233\n; gosh> (fib-1.19 14)\n; 377\n; gosh> (fib-1.19 15)\n; 610\n; gosh> (fib-1.19 16)\n; 987\n; gosh> (fib-1.19 17)\n; 1597\n; gosh> (fib-1.19 18)\n; 2584\n; gosh> (fib-1.19 19)\n; 4181\n; gosh> (fib-1.19 20)\n; 6765\n\n\nex 1.20\n\n\u7df4\u7fd2\u554f\u984c 1.20: \u3042\u308b\u624b\u7d9a\u304d\u304c\u751f\u6210\u3059\u308b\u30d7\u30ed\u30bb\u30b9\u306f\u3001\u3082\u3061\u308d\u3093\u3001\u30a4\u30f3\u30bf\u30d7\u30ea\u30bf\u306e\u898f\u5247\u306b\u3088\u3063\u3066\u7570\u306a\u308b\u3002\u4f8b\u3068\u3057\u3066\u3001\u4e0a\u3067\u8aac\u660e\u3057\u305f\u53cd\u5fa9 gcd \u624b\u7d9a\u304d\u306b\u3064\u3044\u3066\u8003\u3048\u308b\u3002\u3053\u306e\u624b\u7d9a\u304d\u3092\u30011.1.5 \u7bc0\u3067\u8003\u5bdf\u3057\u305f\u6b63\u898f\u9806\u5e8f\u8a55\u4fa1\u306b\u3088\u3063\u3066\u89e3\u91c8\u3059\u308b\u3068\u3059\u308b (if \u306b\u5bfe\u3059\u308b\u6b63\u898f\u9806\u5e8f\u8a55\u4fa1\u898f\u5247\u306f\u7df4\u7fd2\u554f\u984c 1.5\u306b\u8a18\u8ff0\u3055\u308c\u3066\u3044\u308b)\u3002\u7f6e\u63db\u6cd5\u3092 (\u6b63\u898f\u9806\u5e8f\u306b\u5bfe\u3057\u3066) \u4f7f\u3063\u3066\u3001(gcd 206 40) \u3092\u8a55\u4fa1\u3059\u308b\u969b\u306b\u751f\u6210\u3055\u308c\u308b\u30d7\u30ed\u30bb\u30b9\u3092\u56f3\u793a\u3057\u3001\u5b9f\u969b\u306b\u5b9f\u884c\u3055\u308c\u308b remainder \u6f14\u7b97\u3092\u793a\u305b\u3002 (gcd 206 40) \u306e\u6b63\u898f\u9806\u5e8f\u8a55\u4fa1\u3067\u306f\u3001 remainder \u6f14\u7b97\u306f\u4f55\u56de\u5b9f\u884c\u3055\u308c\u308b\u3060\u308d\u3046\u304b\u3002\u9069\u7528\u9806\u5e8f\u8a55\u4fa1\u3067\u306f\u3069\u3046\u3060\u308d\u3046\u304b\u3002\u8aac\u660e\u305b\u3088\u3002\n\n\u4f7f\u3046\u5f0f:\n\n(gcd 206 40)\n(define (gcd a b)\n    (if (= b 0)\n        a\n        (gcd b (remainder a b))))\n\n\n\n\u6b63\u898f\u9806\u5e8f\u8a55\u4fa1\u898f\u5247\u306e\u5834\u5408\n; [\u5165\u529b]\n(gcd 206 40)\n\n; [step 1]\n; a1=206, b1=40. <env:none>\n(if (= b1 0)\n    a1\n    (gcd b1 (remainder a1 b1)))\n; <eval b1> <env:a1=206, b1=40>\nb1\n40\n; pred ==> false.\nelse-clause\n(gcd b1 (remainder a1 b1))\n\n; [step 2]\n; a2=b1, b2=(remainder a1 b1) <env:a1=206, b1=40>\n(if (= b2 0)\n    a2\n    (gcd b2 (remainder a2 b2)))\n; <eval b2> <env:a1=206, b1=40; a2=b1, b2=(remainder a1 b1)>\nb2\n(remainder a1 b1)\n(remainder 206 40)\n; REMAINDER 1 \u56de\u76ee.\n6 ; <env:a1=206, b1=40, a2=b1, b2=6>\n; pred = false\nelse-clause\n(gcd b2 (remainder a2 b2))\n\n; [step 3]\n; a3=b2, b3=(remainder a2 b2) <env:a1=206, b1=40, a2=b1, b2=6>\n(if (= b3 0)\n    a3\n    (gcd b3 (remainder a3 b3)))\n; <eval b3> <env:a1=206, b1=40; a2=b1, b2=6; a3=b2, b3=(remainder a2 b2)>\nb3\n(remainder a2 b2)\n(remainder b1 6)\n(remainder 40 6) ; <env:a1=206, b1=40; a2=40, b2=6; a3=b2, b3=(remainder a2 b2)>\n; REMAINDER 2 \u56de\u76ee.\n4 ; <env:a1=206, b1=40; a2=40, b2=6; a3=b2, b3=4>\n; pred = false\nelse-clause\n(gcd b3 (remainder a3 b3))\n\n; [step 4]\n; a4=b3, b4=(remainder a3 b3) <env:a1=206, b1=40; a2=40, b2=6; a3=b2, b3=4>\n(if (= b4 0)\n    a4\n    (gcd b4 (remainder a4 b4)))\n; <eval b4> <env:a1=206, b1=40; a2=40, b2=6; a3=b2, b3=4; a4=b3, b4=(remainder a3 b3)>\nb4\n(remainder a3 b3)\n(remainder b2 4)\n(remainder 6 4) ; <env:a1=206, b1=40; a2=40, b2=6; a3=6, b3=4; a4=b3, b4=(remainder a3 b3)>\n; REMAINDER 3 \u56de\u76ee.\n2 ; <env:a1=206, b1=40; a2=40, b2=6; a3=6, b3=4; a4=b3, b4=2>\n; pred = false\nelse-clause\n(gcd b4 (remainder a4 b4))\n\n; [step 5]\n; a5=b4, b5=(remainder a4 b4) <env:a1=206, b1=40; a2=40, b2=6; a3=6, b3=4; a4=b3, b4=2>\n(if (= b5 0)\n    a5\n    (gcd b5 (remainder a5 b5)))\n; <eval b5> <env:a1=206, b1=40; a2=40, b2=6; a3=6, b3=4; a4=b3, b4=b3; a5=b4, b5=(remainder a4 b4)>\nb5\n(remainder a4 b4)\n(remainder b3 2)\n(remainder 4 2) ; <env:a1=206, b1=40; a2=40, b2=6; a3=6, b3=4; a4=2, b4=2; a5=b4, b5=(remainder a4 b4)>\n; REMAINDER 4 \u56de\u76ee.\n0 ; <env:a1=206, b1=40; a2=40, b2=6; a3=6, b3=4; a4=2, b4=2; a5=b4, b5=0>\n; pred = true\nthen-clause\na5\n; <eval a5> <env:a1=206, b1=40; a2=40, b2=6; a3=6, b3=4; a4=2, b4=2; a5=b4, b5=0>\na5\nb4\n2 ; answer.\n\n; remainder \u6f14\u7b97\u306f\u5408\u8a084\u56de.\n\n\n\n\n\u9069\u7528\u9806\u5e8f\u8a55\u4fa1\u898f\u5247\u306e\u5834\u5408\n; [\u5165\u529b]\n(gcd 206 40)\n\n; [step 1]\n; a1=206, b1=40. <env:none>\n(if (= b1 0)\n    a1\n    (gcd b1 (remainder a1 b1)))\n; <eval b1> <env:a1=206, b1=40>\nb1\n40\n; pred ==> false.\nelse-clause\n(gcd b1 (remainder a1 b1))\n(gcd 40 (remainder 206 40))\n; REMAINDER 1 \u56de\u76ee.\n(gcd 40 6)\n\n; [step 2]\n; a2=40, b2=6\n(if (= b2 0)\n    a2\n    (gcd b2 (remainder a2 b2)))\n; <eval b2> <env:a2=40, b2=6>\nb2\n6\n; pred ==> false.\nelse-clause\n(gcd b2 (remainder a2 b2))\n(gcd 6 (remainder  40 6))\n; REMAINDER 2 \u56de\u76ee.\n(gcd 6 4)\n\n; [step 3]\n; a3=6 b3=4\n(if (= b3 0)\n    a3\n    (gcd b3 (remainder a3 b3)))\n; <eval b3> <env:a3=6, b3=4>\nb3\n4\n; pred ==> false.\nelse-clause\n(gcd b3 (remainder a3 b3))\n(gcd 4 (remainder  6 4))\n; REMAINDER 3 \u56de\u76ee.\n(gcd 4 2)\n\n; [step 4]\n; a4=4 b4=2\n(if (= b4 0)\n    a4\n    (gcd b4 (remainder a4 b4)))\n; <eval b4> <env:a4=4, b4=2>\nb4\n2\n; pred ==> false.\nelse-clause\n(gcd b4 (remainder a4 b4))\n(gcd 2 (remainder  4 2))\n; REMAINDER 4 \u56de\u76ee.\n(gcd 2 0)\n\n; [step 5]\n; a5=2 b5=0\n(if (= b5 0)\n    a5\n    (gcd b5 (remainder a5 b5)))\n; <eval b5> <env:a5=2, b5=0>\nb5\n0\n; pred ==> true\nthen-clause\na5\n; <eval a5> <env:a5=2, b5=0>\na5\n2 ; answer.\n\n; \u3053\u3061\u3089\u306e\u5834\u5408\u3067\u3082 remainder \u6f14\u7b97\u306f\u5408\u8a084\u56de.\n\n\n\u305d\u308c\u305e\u308c\u306e\u7279\u5fb4\n\u6b63\u898f\u9806\u5e8f\u8a55\u4fa1\u898f\u5247\u306e\u5834\u5408\u306f\u5c55\u958b\u51e6\u7406\u304c\u5148\u306b\u5b9f\u884c\u3055\u308c\u3066, \u5c55\u958b\u306e\u5f8c\u306b\u7279\u6b8a\u5f62\u5f0f if \u306e\u6761\u4ef6\u53e5\u3067 remainder \u306e\u8a55\u4fa1\u304c\u5b9f\u884c\u3055\u308c\u308b.\ngcd \u2192 if \u2192 remainder \u2192 gcd ... \u306e\u9806\u306b\u3050\u308b\u3050\u308b\u53cd\u5fa9\u3055\u308c\u308b\n\u9069\u7528\u9806\u5e8f\u8a55\u4fa1\u898f\u5247\u306e\u5834\u5408\u306f\u5f15\u6570\u306e\u8a55\u4fa1\u304c\u5148\u306b\u5b9f\u884c\u3055\u308c\u3066, \u5f15\u6570\u306e\u5024\u304c\u78ba\u5b9a\u3057\u3066\u304b\u3089\u95a2\u6570\u90e8\u5206\u304c\u5c55\u958b\u3055\u308c\u308b.\n\u3053\u3061\u3089\u306f gcd \u2192 remainder \u2192 if \u2192 gcd ... \u306e\u9806\u306b\u3050\u308b\u3050\u308b.\nif \u3068 remainder \u306e\u9806\u5e8f\u306f\u5165\u308c\u66ff\u308f\u3063\u3066\u3044\u308b\u3051\u308c\u3069, \u6700\u7d42\u7684\u306b remainder \u304c\u8a55\u4fa1\u3055\u308c\u308b\u56de\u6570\u306f\u3069\u3061\u3089\u306e\u5834\u5408\u3067\u3082\u540c\u3058.\n[\u30aa\u30f3\u30e9\u30a4\u30f3SICP\u8aad\u66f8\u5973\u5b50\u4f1a #5 (1.2.5~1.2.6)](http://ladiespp.connpass.com/event/27322/) \u7528\u306e\u3081\u3082\u301c.\n\n# ex 1.19\n\n> \u7df4\u7fd2\u554f\u984c 1.19: \u30d5\u30a3\u30dc\u30ca\u30c3\u30c1\u6570\u3092\u5bfe\u6570\u7684\u30b9\u30c6\u30c3\u30d7\u6570\u3067\u8a08\u7b97\u3059\u308b\u5de7\u5999\u306a\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u304c\u3042\u308b\u30021.2.2 \u7bc0\u306e fib-iter \u30d7\u30ed\u30bb\u30b9\u3067\u306e\u72b6\u614b\u5909\u6570 a \u3068 b \u306e\u5909\u63db\u3001a \u2190 a + b\u3001b \u2190 a \u3092\u601d\u3044\u51fa\u305d\u3046\u3002\u3053\u306e\u5909\u63db\u3092 T \u3068\u547c\u3076\u3053\u3068\u306b\u3059\u308b\u3002\u3059\u308b\u3068\u30011 \u3068 0 \u304b\u3089\u59cb\u3081\u3066 T \u3092\u7e70\u308a\u8fd4\u3057 n \u56de\u9069\u7528\u3059\u308b\u3068 Fib(n + 1) \u3068 Fib(n) \u3068\u3044\u3046\u30da\u30a2\u304c\u3067\u304d\u308b\u3053\u3068\u306b\u306a\u308b\u3002\u8a00\u3044\u63db\u3048\u308c\u3070\u3001\u30d5\u30a3\u30dc\u30ca\u30c3\u30c1\u6570\u306f\u30da\u30a2 (1, 0) \u306b\u5bfe\u3057\u3066 T n (\u5909\u63db T \u306e n \u4e57) \u3092\u9069\u7528\u3059\u308b\u3053\u3068\u3067\u6c42\u3081\u3089\u308c\u308b\u3068\u3044\u3046\u3053\u3068\u3060\u3002\u3053\u3053\u3067\u3001(a, b) \u3068\u3044\u3046\u30da\u30a2\u3092 a \u2190 bq + aq + ap \u3068 b \u2190 bp + aq \u306b\u5909\u63db\u3059\u308b\u3088\u3046\u306a\u5909\u63db\u65cf T pq \u306e\u7279\u6b8a\u306a\u5834\u5408 (p = 0\u3001q = 1) \u3068\u3057\u3066 T \u3092\u8003\u3048\u308b\u3053\u3068\u306b\u3059\u308b\u3002\u3053\u306e\u3088\u3046\u306a\u5909\u63db T pq \u3092\u4e8c\u56de\u9069\u7528\u3059\u308b\u3068\u3001\u305d\u306e\u52b9\u679c\u306f\u540c\u3058\u5f62\u5f0f\u3092\u6301\u3064 T p \u2032 q \u2032 \u3092\u4e00\u56de\u9069\u7528\u3059\u308b\u306e\u3068\u540c\u3058\u3067\u3042\u308b\u3053\u3068\u3092\u793a\u3057\u3001p \u3068 q \u306b\u5bfe\u3059\u308b p \u2032 \u3068 q \u2032 \u3092\u6c42\u3081\u3088\u3002\u3053\u3046\u3059\u308b\u3068\u3001\u3053\u306e\u7a2e\u306e\u5909\u63db\u306b\u5bfe\u3059\u308b\u4e8c\u4e57\u3092\u660e\u793a\u7684\u306b\u884c\u3046\u3053\u3068\u304c\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u308a\u3001fast-expt \u624b\u7d9a\u304d\u3068\u540c\u3058\u3088\u3046\u306b\u3001T n \u3092\u4e8c\u4e57\u306e\u9023\u7d9a\u306b\u3088\u3063\u3066\u6c42\u3081\u3089\u308c\u308b\u3088\u3046\u306b\u306a\u308b\u3002\u3053\u308c\u3089\u3092\u3059\u3079\u3066\u7d44\u307f\u5408\u308f\u305b\u3066\u3001\u5bfe\u6570\u7684\u30b9\u30c6\u30c3\u30d7\u6570\u3067\u52d5\u304f\u6b21\u306e\u624b\u7d9a\u304d\u3092\u5b8c\u6210\u3055\u305b\u3088\u3002\n>\n> ```scm\n(define (fib-1.19 n)\n\t(fib-iter 1 0 0 1 n))\n>\n(define (fib-iter a b p q count)\n\t(cond\n\t\t((= count 0) b)\n\t\t((even? count)\n\t\t\t(fib-iter\n\t\t\t\ta\n\t\t\t\tb\n\t\t\t\t(+ (* p p) (* q q)) ; p\u2019 \u3092\u8a08\u7b97\u3059\u308b\n\t\t\t\t(+ (* 2 p q) (* q q)) ; q\u2019 \u3092\u8a08\u7b97\u3059\u308b\n\t\t\t\t(/ count 2)))\n\t\t(else\n\t\t\t(fib-iter\n\t\t\t\t(+ (* b q) (* a q) (* a p))\n\t\t\t\t(+ (* b p) (* a q))\n\t\t\t\tp\n\t\t\t\tq\n\t\t\t\t(- count 1)))))\n```\n\n\u3058\u3076\u3093\u306e\u56de\u7b54.\n\n``` scm\n; T_pq :: (\u5143\u306e\u6f38\u5316\u5f0f)\n;   a <- bq + aq + ap\n;   b <- bp + aq\n;\n; T_pq x0 :: (i=0 \u306e\u5834\u5408)\n;   (a0, b0)\n;\n; T_pq x1 :: (i=1 \u306e\u5834\u5408)\n;   a1 <- b0q + a0q + a0p\n;   b1 <- b0p + a0q\n;\n; T_pq x2 :: (i=2 \u306e\u5834\u5408, \u304c\u3093\u3070\u3063\u3066\u5c55\u958b\uff06\u518d\u69cb\u6210)\n;\n;   a2 <- b1q + a1q + a1p\n;       = (b0p + a0q)q + (b0q + a0q + a0p)q + (b0q + a0q + a0p)p\n;       = b0pq + a0qq + b0qq + a0qq + a0pq + b0pq + a0pq + a0pp\n;       = b0(pq + qq + pq) + a0(qq + qq + pq + pq + pp)\n;       = b0(2pq + qq) + a0(pp + 2pq + 2qq)\n;       = b0(2pq + qq) + a0(2pq + qq) + a0(pp + qq)\n;   a2.p' = pp + qq\n;   a2.q' = 2pq + qq\n;\n;   b2 <- b1p + a1q\n;       = (b0p + a0q)p + (b0q + a0q + a0p)q\n;       = b0pp + a0pq + b0qq + a0qq + a0pq\n;       = b0(pp + qq) + a0(pq + qq + pq)\n;       = b0(pp + qq) + a0(2pq + qq)\n;   b2.p' = pp + qq\n;   b2.q' = 2pq + qq\n```\n\n`a(i=2)` \u3092\u5c55\u958b\u3057\u305f\u5834\u5408\u3067\u3082 `b(i=2)` \u3092\u5c55\u958b\u3057\u305f\u5834\u5408\u3067\u3082,\n`p'` \u3068 `q'` \u304c\u3061\u3083\u3093\u3068\u540c\u3058\u306b\u306a\u308b\u306e\u304c\u306a\u3093\u3060\u304b\u3075\u3057\u304e\u301c.\n\n\u7b97\u51fa\u3057\u305f `p'` \u3068 `q'` \u306e\u5024\u3092\u4f7f\u3063\u3066, \u554f\u984c\u6587\u4e2d\u306b\u3042\u3063\u305f\u5f0f\u306e\u7a7a\u6b04\u3092\u57cb\u3081\u3066\u5b8c\u6210.\n\n```scm\n(define (fib-1.19 n)\n\t(fib-iter 1 0 0 1 n))\n\n(define (fib-iter a b p q count)\n\t(cond\n\t\t((= count 0) b)\n\t\t((even? count)\n\t\t\t(fib-iter\n\t\t\t\ta\n\t\t\t\tb\n\t\t\t\t(+ (* p p) (* q q)) ; p\u2019 \u3092\u8a08\u7b97\u3059\u308b\n\t\t\t\t(+ (* 2 p q) (* q q)) ; q\u2019 \u3092\u8a08\u7b97\u3059\u308b\n\t\t\t\t(/ count 2)))\n\t\t(else\n\t\t\t(fib-iter\n\t\t\t\t(+ (* b q) (* a q) (* a p))\n\t\t\t\t(+ (* b p) (* a q))\n\t\t\t\tp\n\t\t\t\tq\n\t\t\t\t(- count 1)))))\n```\n\n\u691c\u7b97\u301c.\n\n```scm\n; gosh> (fib-1.19 0)\n; 0\n; gosh> (fib-1.19 1)\n; 1\n; gosh> (fib-1.19 2)\n; 1\n; gosh> (fib-1.19 3)\n; 2\n; gosh> (fib-1.19 4)\n; 3\n; gosh> (fib-1.19 5)\n; 5\n; gosh> (fib-1.19 6)\n; 8\n; gosh> (fib-1.19 7)\n; 13\n; gosh> (fib-1.19 8)\n; 21\n; gosh> (fib-1.19 9)\n; 34\n; gosh> (fib-1.19 10)\n; 55\n\n; gosh> (fib-1.19 11)\n; 89\n; gosh> (fib-1.19 12)\n; 144\n; gosh> (fib-1.19 13)\n; 233\n; gosh> (fib-1.19 14)\n; 377\n; gosh> (fib-1.19 15)\n; 610\n; gosh> (fib-1.19 16)\n; 987\n; gosh> (fib-1.19 17)\n; 1597\n; gosh> (fib-1.19 18)\n; 2584\n; gosh> (fib-1.19 19)\n; 4181\n; gosh> (fib-1.19 20)\n; 6765\n```\n\n# ex 1.20\n\n> \u7df4\u7fd2\u554f\u984c 1.20: \u3042\u308b\u624b\u7d9a\u304d\u304c\u751f\u6210\u3059\u308b\u30d7\u30ed\u30bb\u30b9\u306f\u3001\u3082\u3061\u308d\u3093\u3001\u30a4\u30f3\u30bf\u30d7\u30ea\u30bf\u306e\u898f\u5247\u306b\u3088\u3063\u3066\u7570\u306a\u308b\u3002\u4f8b\u3068\u3057\u3066\u3001\u4e0a\u3067\u8aac\u660e\u3057\u305f\u53cd\u5fa9 `gcd` \u624b\u7d9a\u304d\u306b\u3064\u3044\u3066\u8003\u3048\u308b\u3002\u3053\u306e\u624b\u7d9a\u304d\u3092\u30011.1.5 \u7bc0\u3067\u8003\u5bdf\u3057\u305f\u6b63\u898f\u9806\u5e8f\u8a55\u4fa1\u306b\u3088\u3063\u3066\u89e3\u91c8\u3059\u308b\u3068\u3059\u308b (`if` \u306b\u5bfe\u3059\u308b\u6b63\u898f\u9806\u5e8f\u8a55\u4fa1\u898f\u5247\u306f\u7df4\u7fd2\u554f\u984c 1.5\u306b\u8a18\u8ff0\u3055\u308c\u3066\u3044\u308b)\u3002\u7f6e\u63db\u6cd5\u3092 (\u6b63\u898f\u9806\u5e8f\u306b\u5bfe\u3057\u3066) \u4f7f\u3063\u3066\u3001`(gcd 206 40)` \u3092\u8a55\u4fa1\u3059\u308b\u969b\u306b\u751f\u6210\u3055\u308c\u308b\u30d7\u30ed\u30bb\u30b9\u3092\u56f3\u793a\u3057\u3001\u5b9f\u969b\u306b\u5b9f\u884c\u3055\u308c\u308b `remainder` \u6f14\u7b97\u3092\u793a\u305b\u3002 `(gcd 206 40)` \u306e\u6b63\u898f\u9806\u5e8f\u8a55\u4fa1\u3067\u306f\u3001 `remainder` \u6f14\u7b97\u306f\u4f55\u56de\u5b9f\u884c\u3055\u308c\u308b\u3060\u308d\u3046\u304b\u3002\u9069\u7528\u9806\u5e8f\u8a55\u4fa1\u3067\u306f\u3069\u3046\u3060\u308d\u3046\u304b\u3002\u8aac\u660e\u305b\u3088\u3002\n\n\u4f7f\u3046\u5f0f:\n\n> ```scm\n(gcd 206 40)\n(define (gcd a b)\n\t(if (= b 0)\n\t\ta\n\t\t(gcd b (remainder a b))))\n```\n\n## \u6b63\u898f\u9806\u5e8f\u8a55\u4fa1\u898f\u5247\u306e\u5834\u5408\n\n```scm\n; [\u5165\u529b]\n(gcd 206 40)\n\n; [step 1]\n; a1=206, b1=40. <env:none>\n(if (= b1 0)\n\ta1\n\t(gcd b1 (remainder a1 b1)))\n; <eval b1> <env:a1=206, b1=40>\nb1\n40\n; pred ==> false.\nelse-clause\n(gcd b1 (remainder a1 b1))\n\n; [step 2]\n; a2=b1, b2=(remainder a1 b1) <env:a1=206, b1=40>\n(if (= b2 0)\n\ta2\n\t(gcd b2 (remainder a2 b2)))\n; <eval b2> <env:a1=206, b1=40; a2=b1, b2=(remainder a1 b1)>\nb2\n(remainder a1 b1)\n(remainder 206 40)\n; REMAINDER 1 \u56de\u76ee.\n6 ; <env:a1=206, b1=40, a2=b1, b2=6>\n; pred = false\nelse-clause\n(gcd b2 (remainder a2 b2))\n\n; [step 3]\n; a3=b2, b3=(remainder a2 b2) <env:a1=206, b1=40, a2=b1, b2=6>\n(if (= b3 0)\n\ta3\n\t(gcd b3 (remainder a3 b3)))\n; <eval b3> <env:a1=206, b1=40; a2=b1, b2=6; a3=b2, b3=(remainder a2 b2)>\nb3\n(remainder a2 b2)\n(remainder b1 6)\n(remainder 40 6) ; <env:a1=206, b1=40; a2=40, b2=6; a3=b2, b3=(remainder a2 b2)>\n; REMAINDER 2 \u56de\u76ee.\n4 ; <env:a1=206, b1=40; a2=40, b2=6; a3=b2, b3=4>\n; pred = false\nelse-clause\n(gcd b3 (remainder a3 b3))\n\n; [step 4]\n; a4=b3, b4=(remainder a3 b3) <env:a1=206, b1=40; a2=40, b2=6; a3=b2, b3=4>\n(if (= b4 0)\n\ta4\n\t(gcd b4 (remainder a4 b4)))\n; <eval b4> <env:a1=206, b1=40; a2=40, b2=6; a3=b2, b3=4; a4=b3, b4=(remainder a3 b3)>\nb4\n(remainder a3 b3)\n(remainder b2 4)\n(remainder 6 4) ; <env:a1=206, b1=40; a2=40, b2=6; a3=6, b3=4; a4=b3, b4=(remainder a3 b3)>\n; REMAINDER 3 \u56de\u76ee.\n2 ; <env:a1=206, b1=40; a2=40, b2=6; a3=6, b3=4; a4=b3, b4=2>\n; pred = false\nelse-clause\n(gcd b4 (remainder a4 b4))\n\n; [step 5]\n; a5=b4, b5=(remainder a4 b4) <env:a1=206, b1=40; a2=40, b2=6; a3=6, b3=4; a4=b3, b4=2>\n(if (= b5 0)\n\ta5\n\t(gcd b5 (remainder a5 b5)))\n; <eval b5> <env:a1=206, b1=40; a2=40, b2=6; a3=6, b3=4; a4=b3, b4=b3; a5=b4, b5=(remainder a4 b4)>\nb5\n(remainder a4 b4)\n(remainder b3 2)\n(remainder 4 2) ; <env:a1=206, b1=40; a2=40, b2=6; a3=6, b3=4; a4=2, b4=2; a5=b4, b5=(remainder a4 b4)>\n; REMAINDER 4 \u56de\u76ee.\n0 ; <env:a1=206, b1=40; a2=40, b2=6; a3=6, b3=4; a4=2, b4=2; a5=b4, b5=0>\n; pred = true\nthen-clause\na5\n; <eval a5> <env:a1=206, b1=40; a2=40, b2=6; a3=6, b3=4; a4=2, b4=2; a5=b4, b5=0>\na5\nb4\n2 ; answer.\n\n; remainder \u6f14\u7b97\u306f\u5408\u8a084\u56de.\n\n\n```\n\n## \u9069\u7528\u9806\u5e8f\u8a55\u4fa1\u898f\u5247\u306e\u5834\u5408\n\n```scm\n; [\u5165\u529b]\n(gcd 206 40)\n\n; [step 1]\n; a1=206, b1=40. <env:none>\n(if (= b1 0)\n\ta1\n\t(gcd b1 (remainder a1 b1)))\n; <eval b1> <env:a1=206, b1=40>\nb1\n40\n; pred ==> false.\nelse-clause\n(gcd b1 (remainder a1 b1))\n(gcd 40 (remainder 206 40))\n; REMAINDER 1 \u56de\u76ee.\n(gcd 40 6)\n\n; [step 2]\n; a2=40, b2=6\n(if (= b2 0)\n\ta2\n\t(gcd b2 (remainder a2 b2)))\n; <eval b2> <env:a2=40, b2=6>\nb2\n6\n; pred ==> false.\nelse-clause\n(gcd b2 (remainder a2 b2))\n(gcd 6 (remainder  40 6))\n; REMAINDER 2 \u56de\u76ee.\n(gcd 6 4)\n\n; [step 3]\n; a3=6 b3=4\n(if (= b3 0)\n\ta3\n\t(gcd b3 (remainder a3 b3)))\n; <eval b3> <env:a3=6, b3=4>\nb3\n4\n; pred ==> false.\nelse-clause\n(gcd b3 (remainder a3 b3))\n(gcd 4 (remainder  6 4))\n; REMAINDER 3 \u56de\u76ee.\n(gcd 4 2)\n\n; [step 4]\n; a4=4 b4=2\n(if (= b4 0)\n\ta4\n\t(gcd b4 (remainder a4 b4)))\n; <eval b4> <env:a4=4, b4=2>\nb4\n2\n; pred ==> false.\nelse-clause\n(gcd b4 (remainder a4 b4))\n(gcd 2 (remainder  4 2))\n; REMAINDER 4 \u56de\u76ee.\n(gcd 2 0)\n\n; [step 5]\n; a5=2 b5=0\n(if (= b5 0)\n\ta5\n\t(gcd b5 (remainder a5 b5)))\n; <eval b5> <env:a5=2, b5=0>\nb5\n0\n; pred ==> true\nthen-clause\na5\n; <eval a5> <env:a5=2, b5=0>\na5\n2 ; answer.\n\n; \u3053\u3061\u3089\u306e\u5834\u5408\u3067\u3082 remainder \u6f14\u7b97\u306f\u5408\u8a084\u56de.\n```\n\n## \u305d\u308c\u305e\u308c\u306e\u7279\u5fb4\n\n\u6b63\u898f\u9806\u5e8f\u8a55\u4fa1\u898f\u5247\u306e\u5834\u5408\u306f\u5c55\u958b\u51e6\u7406\u304c\u5148\u306b\u5b9f\u884c\u3055\u308c\u3066, \u5c55\u958b\u306e\u5f8c\u306b\u7279\u6b8a\u5f62\u5f0f `if` \u306e\u6761\u4ef6\u53e5\u3067 `remainder` \u306e\u8a55\u4fa1\u304c\u5b9f\u884c\u3055\u308c\u308b.\n`gcd` \u2192 `if` \u2192 `remainder` \u2192 `gcd` ... \u306e\u9806\u306b\u3050\u308b\u3050\u308b\u53cd\u5fa9\u3055\u308c\u308b\n\n\u9069\u7528\u9806\u5e8f\u8a55\u4fa1\u898f\u5247\u306e\u5834\u5408\u306f\u5f15\u6570\u306e\u8a55\u4fa1\u304c\u5148\u306b\u5b9f\u884c\u3055\u308c\u3066, \u5f15\u6570\u306e\u5024\u304c\u78ba\u5b9a\u3057\u3066\u304b\u3089\u95a2\u6570\u90e8\u5206\u304c\u5c55\u958b\u3055\u308c\u308b.\n\u3053\u3061\u3089\u306f `gcd` \u2192 `remainder` \u2192 `if` \u2192 `gcd` ... \u306e\u9806\u306b\u3050\u308b\u3050\u308b.\n\n`if` \u3068 `remainder` \u306e\u9806\u5e8f\u306f\u5165\u308c\u66ff\u308f\u3063\u3066\u3044\u308b\u3051\u308c\u3069, \u6700\u7d42\u7684\u306b `remainder` \u304c\u8a55\u4fa1\u3055\u308c\u308b\u56de\u6570\u306f\u3069\u3061\u3089\u306e\u5834\u5408\u3067\u3082\u540c\u3058.\n", "tags": ["SICP"]}