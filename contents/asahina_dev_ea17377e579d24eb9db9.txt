{"tags": ["EC-CUBE"], "context": " More than 1 year has passed since last update.\n\n\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u69cb\u6210\n\n\nPluginName\n\n\nhtml\n\nimage\ncss\njs\n\n\n\ntemplates\n\n\nconfig\n\nindex.tpl\n\n\n\n\nconfig.php\nLC_Page_Plugin_PluginName_Config.php\nPluginName.php\nplugin_info.php\n\n\n\n\n\u30d5\u30a1\u30a4\u30eb\u5185\u5bb9\n\nconfig.php\n<?php\n\nrequire_once PLUGIN_UPLOAD_REALDIR . 'PluginName/LC_Page_Plugin_PluginName_Config.php';\n$objPage = new LC_Page_Plugin_PluginName_Config();\nregister_shutdown_function(array(\n    $objPage,\n    'destroy'\n));\n$objPage -> init();\n$objPage -> process();\n\n\nLC_Page_Plugin_PluginName_Config.php\n<?php\n// {{{ requires\nrequire_once CLASS_EX_REALDIR . 'page_extends/admin/LC_Page_Admin_Ex.php';\n\nclass LC_Page_Plugin_PluginName_Config extends LC_Page_Admin_Ex {\n\n    var $plugin_name = \"PluginName\";\n\n    var $arrForm = array();\n\n    /**\n     * \u521d\u671f\u5316\u3059\u308b.\n     *\n     * @return void\n     */\n    function init() {\n        parent::init();\n        $this -> tpl_mainpage = PLUGIN_UPLOAD_REALDIR . $this -> plugin_name . \"/templates/config/index.tpl\";\n        $this -> tpl_subtitle = \"\u8a2d\u5b9a\u753b\u9762\";\n        $this -> tpl_field1 = \"\u9805\u76ee1\";\n        $this -> tpl_field2 = \"\u9805\u76ee2\";\n        $this -> tpl_field3 = \"\u9805\u76ee3\";\n        $this -> tpl_field4 = \"\u9805\u76ee4\";\n        $this -> btn_regist = \"\u767b\u9332\";\n        $this -> th_label = \"\u9805\u76ee\u540d\";\n        $this -> th_input = \"\u8a2d\u5b9a\u5024\";\n\n        // \u4efb\u610f\n    }\n\n    /**\n     * \u30d7\u30ed\u30bb\u30b9.\n     *\n     * @return void\n     */\n    function process() {\n        $this -> action();\n        $this -> sendResponse();\n    }\n\n    /**\n     * Page \u306e\u30a2\u30af\u30b7\u30e7\u30f3.\n     *\n     * @return void\n     */\n    function action() {\n        $objFormParam = new SC_FormParam_Ex();\n        $this -> lfInitParam($objFormParam);\n        $objFormParam -> setParam($_POST);\n        $objFormParam -> convParam();\n\n        $arrForm = array();\n        switch ($this->getMode()) {\n            case 'edit' :\n                $arrForm = $objFormParam -> getHashArray();\n                $this -> arrErr = $objFormParam -> checkError();\n                // \u30a8\u30e9\u30fc\u306a\u3057\u306e\u5834\u5408\u306b\u306f\u30c7\u30fc\u30bf\u3092\u66f4\u65b0\n                if (count($this -> arrErr) == 0) {\n                    // \u30c7\u30fc\u30bf\u66f4\u65b0\n                    $this -> arrErr = $this -> updateData($arrForm);\n                    if (count($this -> arrErr) == 0) {\n                        $this -> tpl_onload = \"\";\n                        $this -> tpl_onload .= \"alert('\u767b\u9332\u304c\u5b8c\u4e86\u3057\u307e\u3057\u305f\u3002');\";\n                        $this -> tpl_onload .= 'window.close();';\n                    }\n                }\n                break;\n            default :\n                // \u30d7\u30e9\u30b0\u30a4\u30f3\u60c5\u5831\u3092\u53d6\u5f97.\n                $plugin = SC_Plugin_Util_Ex::getPluginByPluginCode($this -> plugin_name);\n                // \u5fc5\u8981\u30d5\u30a3\u30fc\u30eb\u30c9\u6570\u5206\u5b9a\u7fa9\n                $arrForm['free_field1'] = $plugin['free_field1'];\n                $arrForm['free_field2'] = $plugin['free_field2'];\n                $arrForm['free_field3'] = $plugin['free_field3'];\n                $arrForm['free_field4'] = $plugin['free_field4'];\n                break;\n        }\n        $this -> arrForm = $arrForm;\n        $this -> setTemplate($this -> tpl_mainpage);\n    }\n\n    /**\n     * \u30c7\u30b9\u30c8\u30e9\u30af\u30bf.\n     *\n     * @return void\n     */\n    function destroy() {\n        parent::destroy();\n    }\n\n    /**\n     * \u30d1\u30e9\u30e1\u30fc\u30bf\u30fc\u60c5\u5831\u306e\u521d\u671f\u5316\n     *\n     * @param object $objFormParam SC_FormParam\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\n     * @return void\n     */\n    function lfInitParam(&$objFormParam) {\n        $objFormParam -> addParam('\u9805\u76ee1', 'free_field1', INT_LEN, 'n', array('MAX_LENGTH_CHECK'));\n        $objFormParam -> addParam('\u9805\u76ee2', 'free_field2', INT_LEN, 'n', array('MAX_LENGTH_CHECK'));\n        $objFormParam -> addParam('\u9805\u76ee3', 'free_field3', INT_LEN, 'n', array('MAX_LENGTH_CHECK'));\n        $objFormParam -> addParam('\u9805\u76ee4', 'free_field4', INT_LEN, 'n', array('MAX_LENGTH_CHECK'));\n    }\n\n    /**\n     *\n     * @param type $arrData\n     * @return type\n     */\n    function updateData($arrData) {\n        $arrErr = array();\n\n        $objQuery = &SC_Query_Ex::getSingletonInstance();\n        $objQuery -> begin();\n        // UPDATE\u3059\u308b\u5024\u3092\u4f5c\u6210\u3059\u308b\u3002\n        $sqlval = array();\n        $sqlval['free_field1'] = $arrData['free_field1'];\n        $sqlval['free_field2'] = $arrData['free_field2'];\n        $sqlval['free_field3'] = $arrData['free_field3'];\n        $sqlval['free_field4'] = $arrData['free_field4'];\n        $sqlval['update_date'] = 'CURRENT_TIMESTAMP';\n        $where = \"plugin_code = ?\";\n        $whereVal = array($this -> plugin_name);\n\n        // UPDATE\u306e\u5b9f\u884c\n        $objQuery -> update('dtb_plugin', $sqlval, $where, $whereVal);\n        $objQuery -> commit();\n        return $arrErr;\n    }\n\n}\n\n\nPluginName.php\n<?php\nclass OrderPoint extends SC_Plugin_Base {\n\n    public function __construct(array $arrSelfInfo) {\n        parent::__construct($arrSelfInfo);\n    }\n\n    function install(array $arrPlugin, SC_Plugin_Installer $installer) {\n        $installer -> copyDirectory(\"html/\", \"\");\n    }\n\n    function uninstall(array $arrPlugin, SC_Plugin_Installer $installer) {\n    }\n\n    function prefilter(&$source, LC_Page_Ex $objPage, $filename) {\n        $objTransform = new SC_Helper_Transform($source);\n\n        $source = $objTransform -> getHTML();\n    }\n\n    function admin_products_product_after($objectPage) {\n    }\n\n    function admin_products_product_class_after($objectPage) {\n    }\n\n    function admin_home_after($objectPage) {\n    }\n\n\n}\n\n\nplugin_info.php\n<?php\nclass plugin_info {\n\n    static $PLUGIN_CODE = \"PluginName\";\n    static $PLUGIN_NAME = \"PluginName\";\n    static $PLUGIN_VERSION = \"0.1\";\n    static $COMPLIANT_VERSION = \"2.13.x\";\n    static $AUTHOR = \"MyName\";\n    static $DESCRIPTION = \"\u30d7\u30e9\u30b0\u30a4\u30f3\u306e\u8aac\u660e\";\n    static $PLUGIN_SITE_URL = \"/#\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u30b5\u30a4\u30c8\";\n    static $AUTHOR_SITE_URL = \"/#\u4f5c\u6210\u8005\u306e\u30b5\u30a4\u30c8\";\n\n    static $CLASS_NAME = \"PluginName\";\n    static $HOOK_POINTS = array(\n        array(\n            \"prefilterTransform\",\n            \"prefilter\"\n        ),\n        array(\n            \"LC_Page_Admin_Products_Product_action_after\",\n            \"admin_products_product_action_after\"\n        ),\n        array(\n            \"LC_Page_Admin_Products_ProductClass_action_after\",\n            \"admin_products_product_class_after\"\n        ),\n        array(\n            \"LC_Page_Admin_Home_action_after\",\n            \"admin_home_after\"\n        )\n    );\n    static $LICENSE = \"LGPL\";\n}\n\n# \u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u69cb\u6210\n\n[1]: #\n\n* [PluginName][1]\n    * [html][1]\n        * [image][1]\n        * [css][1]\n        * [js][1]\n    * [templates][1]\n        * [config][1]\n            * [index.tpl][1]\n    * [config.php][1]\n    * [LC_Page_Plugin_PluginName_Config.php][1]\n    * [PluginName.php][1]\n    * [plugin_info.php][1]\n\n# \u30d5\u30a1\u30a4\u30eb\u5185\u5bb9\n\n## config.php\n\n\n```php\n<?php\n\nrequire_once PLUGIN_UPLOAD_REALDIR . 'PluginName/LC_Page_Plugin_PluginName_Config.php';\n$objPage = new LC_Page_Plugin_PluginName_Config();\nregister_shutdown_function(array(\n\t$objPage,\n\t'destroy'\n));\n$objPage -> init();\n$objPage -> process();\n```\n\n## LC_Page_Plugin_PluginName_Config.php\n\n```php\n<?php\n// {{{ requires\nrequire_once CLASS_EX_REALDIR . 'page_extends/admin/LC_Page_Admin_Ex.php';\n\nclass LC_Page_Plugin_PluginName_Config extends LC_Page_Admin_Ex {\n\n\tvar $plugin_name = \"PluginName\";\n\n\tvar $arrForm = array();\n\n\t/**\n\t * \u521d\u671f\u5316\u3059\u308b.\n\t *\n\t * @return void\n\t */\n\tfunction init() {\n\t\tparent::init();\n\t\t$this -> tpl_mainpage = PLUGIN_UPLOAD_REALDIR . $this -> plugin_name . \"/templates/config/index.tpl\";\n\t\t$this -> tpl_subtitle = \"\u8a2d\u5b9a\u753b\u9762\";\n\t\t$this -> tpl_field1 = \"\u9805\u76ee1\";\n\t\t$this -> tpl_field2 = \"\u9805\u76ee2\";\n\t\t$this -> tpl_field3 = \"\u9805\u76ee3\";\n\t\t$this -> tpl_field4 = \"\u9805\u76ee4\";\n\t\t$this -> btn_regist = \"\u767b\u9332\";\n\t\t$this -> th_label = \"\u9805\u76ee\u540d\";\n\t\t$this -> th_input = \"\u8a2d\u5b9a\u5024\";\n\n\t\t// \u4efb\u610f\n\t}\n\n\t/**\n\t * \u30d7\u30ed\u30bb\u30b9.\n\t *\n\t * @return void\n\t */\n\tfunction process() {\n\t\t$this -> action();\n\t\t$this -> sendResponse();\n\t}\n\n\t/**\n\t * Page \u306e\u30a2\u30af\u30b7\u30e7\u30f3.\n\t *\n\t * @return void\n\t */\n\tfunction action() {\n\t\t$objFormParam = new SC_FormParam_Ex();\n\t\t$this -> lfInitParam($objFormParam);\n\t\t$objFormParam -> setParam($_POST);\n\t\t$objFormParam -> convParam();\n\n\t\t$arrForm = array();\n\t\tswitch ($this->getMode()) {\n\t\t\tcase 'edit' :\n\t\t\t\t$arrForm = $objFormParam -> getHashArray();\n\t\t\t\t$this -> arrErr = $objFormParam -> checkError();\n\t\t\t\t// \u30a8\u30e9\u30fc\u306a\u3057\u306e\u5834\u5408\u306b\u306f\u30c7\u30fc\u30bf\u3092\u66f4\u65b0\n\t\t\t\tif (count($this -> arrErr) == 0) {\n\t\t\t\t\t// \u30c7\u30fc\u30bf\u66f4\u65b0\n\t\t\t\t\t$this -> arrErr = $this -> updateData($arrForm);\n\t\t\t\t\tif (count($this -> arrErr) == 0) {\n\t\t\t\t\t\t$this -> tpl_onload = \"\";\n\t\t\t\t\t\t$this -> tpl_onload .= \"alert('\u767b\u9332\u304c\u5b8c\u4e86\u3057\u307e\u3057\u305f\u3002');\";\n\t\t\t\t\t\t$this -> tpl_onload .= 'window.close();';\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tdefault :\n\t\t\t\t// \u30d7\u30e9\u30b0\u30a4\u30f3\u60c5\u5831\u3092\u53d6\u5f97.\n\t\t\t\t$plugin = SC_Plugin_Util_Ex::getPluginByPluginCode($this -> plugin_name);\n\t\t\t\t// \u5fc5\u8981\u30d5\u30a3\u30fc\u30eb\u30c9\u6570\u5206\u5b9a\u7fa9\n\t\t\t\t$arrForm['free_field1'] = $plugin['free_field1'];\n\t\t\t\t$arrForm['free_field2'] = $plugin['free_field2'];\n\t\t\t\t$arrForm['free_field3'] = $plugin['free_field3'];\n\t\t\t\t$arrForm['free_field4'] = $plugin['free_field4'];\n\t\t\t\tbreak;\n\t\t}\n\t\t$this -> arrForm = $arrForm;\n\t\t$this -> setTemplate($this -> tpl_mainpage);\n\t}\n\n\t/**\n\t * \u30c7\u30b9\u30c8\u30e9\u30af\u30bf.\n\t *\n\t * @return void\n\t */\n\tfunction destroy() {\n\t\tparent::destroy();\n\t}\n\n\t/**\n\t * \u30d1\u30e9\u30e1\u30fc\u30bf\u30fc\u60c5\u5831\u306e\u521d\u671f\u5316\n\t *\n\t * @param object $objFormParam SC_FormParam\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\n\t * @return void\n\t */\n\tfunction lfInitParam(&$objFormParam) {\n\t\t$objFormParam -> addParam('\u9805\u76ee1', 'free_field1', INT_LEN, 'n', array('MAX_LENGTH_CHECK'));\n\t\t$objFormParam -> addParam('\u9805\u76ee2', 'free_field2', INT_LEN, 'n', array('MAX_LENGTH_CHECK'));\n\t\t$objFormParam -> addParam('\u9805\u76ee3', 'free_field3', INT_LEN, 'n', array('MAX_LENGTH_CHECK'));\n\t\t$objFormParam -> addParam('\u9805\u76ee4', 'free_field4', INT_LEN, 'n', array('MAX_LENGTH_CHECK'));\n\t}\n\n\t/**\n\t *\n\t * @param type $arrData\n\t * @return type\n\t */\n\tfunction updateData($arrData) {\n\t\t$arrErr = array();\n\n\t\t$objQuery = &SC_Query_Ex::getSingletonInstance();\n\t\t$objQuery -> begin();\n\t\t// UPDATE\u3059\u308b\u5024\u3092\u4f5c\u6210\u3059\u308b\u3002\n\t\t$sqlval = array();\n\t\t$sqlval['free_field1'] = $arrData['free_field1'];\n\t\t$sqlval['free_field2'] = $arrData['free_field2'];\n\t\t$sqlval['free_field3'] = $arrData['free_field3'];\n\t\t$sqlval['free_field4'] = $arrData['free_field4'];\n\t\t$sqlval['update_date'] = 'CURRENT_TIMESTAMP';\n\t\t$where = \"plugin_code = ?\";\n\t\t$whereVal = array($this -> plugin_name);\n\n\t\t// UPDATE\u306e\u5b9f\u884c\n\t\t$objQuery -> update('dtb_plugin', $sqlval, $where, $whereVal);\n\t\t$objQuery -> commit();\n\t\treturn $arrErr;\n\t}\n\n}\n```\n\n\n## PluginName.php\n\n```php\n<?php\nclass OrderPoint extends SC_Plugin_Base {\n\n\tpublic function __construct(array $arrSelfInfo) {\n\t\tparent::__construct($arrSelfInfo);\n\t}\n\n\tfunction install(array $arrPlugin, SC_Plugin_Installer $installer) {\n\t\t$installer -> copyDirectory(\"html/\", \"\");\n\t}\n\n\tfunction uninstall(array $arrPlugin, SC_Plugin_Installer $installer) {\n\t}\n\n\tfunction prefilter(&$source, LC_Page_Ex $objPage, $filename) {\n\t\t$objTransform = new SC_Helper_Transform($source);\n\n\t\t$source = $objTransform -> getHTML();\n\t}\n\n\tfunction admin_products_product_after($objectPage) {\n\t}\n\n\tfunction admin_products_product_class_after($objectPage) {\n\t}\n\n\tfunction admin_home_after($objectPage) {\n\t}\n\n\n}\n```\n\n## plugin_info.php\n\n```php\n<?php\nclass plugin_info {\n\n\tstatic $PLUGIN_CODE = \"PluginName\";\n\tstatic $PLUGIN_NAME = \"PluginName\";\n\tstatic $PLUGIN_VERSION = \"0.1\";\n\tstatic $COMPLIANT_VERSION = \"2.13.x\";\n\tstatic $AUTHOR = \"MyName\";\n\tstatic $DESCRIPTION = \"\u30d7\u30e9\u30b0\u30a4\u30f3\u306e\u8aac\u660e\";\n\tstatic $PLUGIN_SITE_URL = \"/#\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u30b5\u30a4\u30c8\";\n\tstatic $AUTHOR_SITE_URL = \"/#\u4f5c\u6210\u8005\u306e\u30b5\u30a4\u30c8\";\n\n\tstatic $CLASS_NAME = \"PluginName\";\n\tstatic $HOOK_POINTS = array(\n\t\tarray(\n\t\t\t\"prefilterTransform\",\n\t\t\t\"prefilter\"\n\t\t),\n\t\tarray(\n\t\t\t\"LC_Page_Admin_Products_Product_action_after\",\n\t\t\t\"admin_products_product_action_after\"\n\t\t),\n\t\tarray(\n\t\t\t\"LC_Page_Admin_Products_ProductClass_action_after\",\n\t\t\t\"admin_products_product_class_after\"\n\t\t),\n\t\tarray(\n\t\t\t\"LC_Page_Admin_Home_action_after\",\n\t\t\t\"admin_home_after\"\n\t\t)\n\t);\n\tstatic $LICENSE = \"LGPL\";\n}\n```\n"}