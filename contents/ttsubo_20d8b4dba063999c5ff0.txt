{"context": "VMware Fusion on Mac OS X\u74b0\u5883\u306b\u3066\u3001vMX\u30bd\u30d5\u30c8\u30a6\u30a7\u30a2\u30eb\u30fc\u30bf\u3092\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\u3057\u305f\u5099\u5fd8\u9332\u3067\u3059\u3002\n\nMacBook Pro (Retina, 15-inch, Mid 2015)\n\u30d7\u30ed\u30bb\u30c3\u30b5\uff1a 2.2 GHz Intel Core i7\n\u30e1\u30e2\u30ea\uff1a16 GB 1600 MHz DDR3\n\n\u57fa\u672c\u7684\u306b\u306f\u3001\"vMX Getting Started Guide for KVM\"\u306e\u8a18\u8f09\u306b\u5f93\u3063\u3066\u3001vMX\u74b0\u5883\u3092\u6574\u5099\u3057\u307e\u3057\u305f\u3002\n\n\u25a0 vMX\u30c8\u30e9\u30a4\u30a2\u30eb\u7248\u306e\u5165\u624b\n\u6b21\u306eURL\u304b\u3089\u3001vMX\u30c8\u30e9\u30a4\u30a2\u30eb\u7248\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3057\u307e\u3059\u3002\nhttp://www.juniper.net/us/en/dm/free-vmx-trial\n\u305f\u3076\u3093\u3001\u3053\u3053\u306e\u5de5\u7a0b\u304c\u3001\u4e00\u756a\u96e3\u6613\u5ea6\u304c\u9ad8\u3044\u306e\u304b\u3082\u3057\u308c\u307e\u305b\u3093\n\n\u25a0 vMX\u306e\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\u5099\u5fd8\u9332\n\u6700\u5c0f\u69cb\u6210\u3068\u306a\u308b\u3001\"Lab simulation\"\u74b0\u5883\u306e\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\u3092\u76ee\u6307\u3057\u307e\u3059\u3002\n\n\u6b21\u306a\u308b\u96e3\u95a2\u306f\u3001\u6700\u5c0f\u69cb\u6210\u3068\u3044\u3048\u3069\u3082\u30014CPU, 5GB (+\u6570GB)\u306e\u4eee\u60f3\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u304c\u5fc5\u8981\u306b\u306a\u308b\u70b9\u3067\u3059\u306d\n\uff08\u3061\u306a\u307f\u306b\u3001\u4eca\u56de\u306f\u30014CPU, 8GB\u306e\u4eee\u60f3\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u3067\u4f5c\u696d\u3092\u9032\u3081\u307e\u3057\u305f\u3002\uff09\n\n(1) Ubuntu\u74b0\u5883\u78ba\u8a8d\nVMware Fusion\u4e0a\u306b\u3001\u4eee\u60f3\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\"Ubuntu Server\u7248 16.04.1\"\u3092\u30c7\u30d7\u30ed\u30a4\u3057\u307e\u3057\u305f\u3002\n\nUbuntu\u30d0\u30fc\u30b8\u30e7\u30f3\u306e\u78ba\u8a8d\n\n$ cat /etc/lsb-release \nDISTRIB_ID=Ubuntu\nDISTRIB_RELEASE=16.04\nDISTRIB_CODENAME=xenial\nDISTRIB_DESCRIPTION=\"Ubuntu 16.04.1 LTS\"\n\n\n\u642d\u8f09nic\u306e\u78ba\u8a8d\n\n$ lspci|grep Ethernet\n02:01.0 Ethernet controller: Intel Corporation 82545EM Gigabit Ethernet Controller (Copper) (rev 01)\n02:02.0 Ethernet controller: Intel Corporation 82545EM Gigabit Ethernet Controller (Copper) (rev 01)\n02:03.0 Ethernet controller: Intel Corporation 82545EM Gigabit Ethernet Controller (Copper) (rev 01)\n\n\nnetwork\u8a2d\u5b9a\u306e\u78ba\u8a8d\n\n$ cat /etc/network/interfaces\n\n\n/etc/network/interfaces\n# This file describes the network interfaces available on your system\n# and how to activate them. For more information, see interfaces(5).\n\nsource /etc/network/interfaces.d/*\n\n# The loopback network interface\nauto lo\niface lo inet loopback\n\n# The primary network interface\nauto ens33\niface ens33 inet static\naddress 192.168.100.201\nnetmask 255.255.255.0\ngateway 192.168.100.1\n\n\n$ ip addr\n1: lo: <LOOPBACK,UP,LOWER_UP> mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1\n    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00\n    inet 127.0.0.1/8 scope host lo\n       valid_lft forever preferred_lft forever\n    inet6 ::1/128 scope host \n       valid_lft forever preferred_lft forever\n2: ens33: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc pfifo_fast state UP group default qlen 1000\n    link/ether 00:0c:29:f3:16:bb brd ff:ff:ff:ff:ff:ff\n    inet 192.168.100.201/24 brd 192.168.100.255 scope global ens33\n       valid_lft forever preferred_lft forever\n    inet6 240b:11:53a0:400:20c:29ff:fef3:16bb/64 scope global mngtmpaddr dynamic \n       valid_lft 14378sec preferred_lft 12578sec\n    inet6 fe80::20c:29ff:fef3:16bb/64 scope link \n       valid_lft forever preferred_lft forever\n3: ens34: <BROADCAST,MULTICAST> mtu 1500 qdisc noop state DOWN group default qlen 1000\n    link/ether 00:0c:29:f3:16:c5 brd ff:ff:ff:ff:ff:ff\n4: ens35: <BROADCAST,MULTICAST> mtu 1500 qdisc noop state DOWN group default qlen 1000\n    link/ether 00:0c:29:f3:16:cf brd ff:ff:ff:ff:ff:ff\n\n\nkernel \u30d0\u30fc\u30b8\u30e7\u30f3\u78ba\u8a8d\n\n$ uname -a\nLinux vMX-1 4.4.0-31-generic #50-Ubuntu SMP Wed Jul 13 00:07:12 UTC 2016 x86_64 x86_64 x86_64 GNU/Linux\n\n\n\"vMX-1\"\u4eee\u60f3\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u4e0a\u3067\u3001vt-x\u304c\u6709\u52b9\u306b\u306a\u3063\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\n\n$ cat /proc/cpuinfo | grep vmx\nflags       : fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush dts mmx fxsr sse sse2 ss syscall nx pdpe1gb rdtscp lm constant_tsc arch_perfmon pebs bts nopl xtopology tsc_reliable nonstop_tsc aperfmperf eagerfpu pni pclmulqdq vmx ssse3 fma cx16 pcid sse4_1 sse4_2 x2apic movbe popcnt tsc_deadline_timer aes xsave avx f16c rdrand hypervisor lahf_lm abm epb tpr_shadow vnmi ept vpid fsgsbase tsc_adjust bmi1 avx2 smep bmi2 invpcid xsaveopt dtherm ida arat pln pts\nflags       : fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush dts mmx fxsr sse sse2 ss syscall nx pdpe1gb rdtscp lm constant_tsc arch_perfmon pebs bts nopl xtopology tsc_reliable nonstop_tsc aperfmperf eagerfpu pni pclmulqdq vmx ssse3 fma cx16 pcid sse4_1 sse4_2 x2apic movbe popcnt tsc_deadline_timer aes xsave avx f16c rdrand hypervisor lahf_lm abm epb tpr_shadow vnmi ept vpid fsgsbase tsc_adjust bmi1 avx2 smep bmi2 invpcid xsaveopt dtherm ida arat pln pts\nflags       : fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush dts mmx fxsr sse sse2 ss syscall nx pdpe1gb rdtscp lm constant_tsc arch_perfmon pebs bts nopl xtopology tsc_reliable nonstop_tsc aperfmperf eagerfpu pni pclmulqdq vmx ssse3 fma cx16 pcid sse4_1 sse4_2 x2apic movbe popcnt tsc_deadline_timer aes xsave avx f16c rdrand hypervisor lahf_lm abm epb tpr_shadow vnmi ept vpid fsgsbase tsc_adjust bmi1 avx2 smep bmi2 invpcid xsaveopt dtherm ida arat pln pts\nflags       : fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush dts mmx fxsr sse sse2 ss syscall nx pdpe1gb rdtscp lm constant_tsc arch_perfmon pebs bts nopl xtopology tsc_reliable nonstop_tsc aperfmperf eagerfpu pni pclmulqdq vmx ssse3 fma cx16 pcid sse4_1 sse4_2 x2apic movbe popcnt tsc_deadline_timer aes xsave avx f16c rdrand hypervisor lahf_lm abm epb tpr_shadow vnmi ept vpid fsgsbase tsc_adjust bmi1 avx2 smep bmi2 invpcid xsaveopt dtherm ida arat pln pts\n\n\n(2) vMX\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u306b\u5411\u3051\u3066\u306e\u4e8b\u524d\u6e96\u5099\n\n\u5404\u7a2e\u30d1\u30c3\u30b1\u30fc\u30b8\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n$ sudo apt-get update\n$ sudo apt-get install -y bridge-utils qemu-kvm libvirt-bin\n$ sudo apt-get install -y libyaml-dev python-yaml numactl libparted0-dev libpciaccess-dev\n$ sudo apt-get install -y libnuma-dev libyajl-dev libxml2-dev libglib2.0-dev\n$ sudo apt-get install -y python-pip python-dev libxml2-dev libxslt-dev libnl-3-dev\n$ sudo apt-get install -y python python-netifaces vnc4server\n\n\nlibvirt\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u78ba\u8a8d\n\n$ libvirtd --version\nlibvirtd (libvirt) 1.3.1\n\n\nvirtsh\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u78ba\u8a8d\n\n$ virsh --version\n1.3.1\n\n\n(3) Ubuntu\u74b0\u5883\u306e\u8a2d\u5b9a\u5909\u66f4\n\nKSM\u3092\u7121\u52b9\u306b\u3059\u308b\n\n$ sudo vi /etc/default/qemu-kvm\n\n\nqemu-kvm\nKSM_ENABLED=0\n\n\n\nAPIC\u3092\u7121\u52b9\u306b\u3059\u308b\n\n$ sudo vi /etc/modprobe.d/qemu-system-x86.conf\n\n\nqemu-system-x86.conf\noptions kvm_intel enable_apicv=0 nested=1 enable_apicv=0\n\n\n\n\u518d\u8d77\u52d5 ..\n\n$ sudo reboot\n\n\n\"kvm-intel\"\u30ab\u30fc\u30cd\u30eb\u30e2\u30b8\u30e5\u30fc\u30eb\u3092\u7d44\u307f\u8fbc\u3080\n\n$ sudo modprobe kvm_intel\n\n$ lsmod|grep kvm\nkvm_intel             172032  0\nkvm                   536576  1 kvm_intel\nirqbypass              16384  1 kvm\n\n\n(4) vMX\u30d1\u30c3\u30b1\u30fc\u30b8\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\nvMX\u30d1\u30c3\u30b1\u30fc\u30b8\u3092\u5c55\u958b\u3059\u308b\uff08\u3053\u3053\u3067\u306f\u3001/home/tsubo\u914d\u4e0b\u306b\u5c55\u958b\u3057\u305f\u3082\u306e\u3068\u3059\u308b\uff09\n\n$ ls -l /home/tsubo\ntotal 4\ndrwxrwxr-x 8 tsubo tsubo 4096 Dec 31 04:30 vmx-16.1R1.7\n\n\nvMX\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3092\u914d\u5e03\u3059\u308b\n\n$ vi /home/tsubo/vmx-16.1R1.7/config/vmx.conf \n\n\nvmx.conf\n##############################################################\n#\n#  vmx.conf\n#  Config file for vmx on the hypervisor.\n#  Uses YAML syntax. \n#  Leave a space after \":\" to specify the parameter value.\n#\n##############################################################\n\n--- \n#Configuration on the host side - management interface, VM images etc.\nHOST:\n    identifier                : vmx1   # Maximum 4 characters\n    host-management-interface : ens33\n    routing-engine-image      : \"/home/tsubo/vmx-16.1R1.7/images/junos-vmx-x86-64-16.1R1.7.qcow2\"\n    routing-engine-hdd        : \"/home/tsubo/vmx-16.1R1.7/images/vmxhdd.img\"\n    forwarding-engine-image   : \"/home/tsubo/vmx-16.1R1.7/images/vFPC-20160617.img\"\n\n---\n#External bridge configuration\nBRIDGES:\n    - type  : external\n      name  : br-ext                  # Max 10 characters\n\n--- \n#vRE VM parameters\nCONTROL_PLANE:\n    vcpus       : 1\n    memory-mb   : 1024 \n    console_port: 8601\n\n    interfaces  :\n      - type      : static\n        ipaddr    : 10.102.144.94 \n        macaddr   : \"0A:00:DD:C0:DE:0E\"\n\n--- \n#vPFE VM parameters\nFORWARDING_PLANE:\n    memory-mb   : 4096\n    vcpus       : 3\n    console_port: 8602\n    device-type : virtio \n\n    interfaces  :\n      - type      : static\n        ipaddr    : 10.102.144.98\n        macaddr   : \"0A:00:DD:C0:DE:10\"\n\n--- \n#Interfaces\nJUNOS_DEVICES:\n   - interface            : ge-0/0/0\n     mac-address          : \"02:06:0A:0E:FF:F0\"\n     description          : \"ge-0/0/0 interface\"\n\n   - interface            : ge-0/0/1\n     mac-address          : \"02:06:0A:0E:FF:F1\"\n     description          : \"ge-0/0/1 interface\"\n\n\n\nvMX\u30d1\u30c3\u30b1\u30fc\u30b8\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\n\n$ cd /home/tsubo/vmx-16.1R1.7\n$ sudo ./vmx.sh -lv --install\n==================================================\n    Welcome to VMX\n==================================================\nDate..............................................12/31/16 04:46:07\nVMX Identifier....................................vmx1\nConfig file......................................./home/tsubo/vmx-16.1R1.7/config/vmx.conf\nBuild Directory.................................../home/tsubo/vmx-16.1R1.7/build/vmx1\nEnvironment file................................../home/tsubo/vmx-16.1R1.7/env/ubuntu_virtio.env\nJunos Device Type.................................virtio\nInitialize scripts................................[OK]\nCopy images to build directory....................[OK]\n==================================================\n    VMX Environment Setup Completed\n==================================================\n==================================================\n    VMX Install & Start\n==================================================\nLinux distribution................................ubuntu\nCheck GRUB........................................[Disabled]\nInstallation status of qemu-kvm...................[OK]\nInstallation status of libvirt-bin................[OK]\nInstallation status of bridge-utils...............[OK]\nInstallation status of python.....................[OK]\nInstallation status of libyaml-dev................[OK]\nInstallation status of python-yaml................[OK]\nInstallation status of numactl....................[OK]\nInstallation status of libnuma-dev................[OK]\nInstallation status of libparted0-dev.............[OK]\nInstallation status of libpciaccess-dev...........[OK]\nInstallation status of libyajl-dev................[OK]\nInstallation status of libxml2-dev................[OK]\nInstallation status of libglib2.0-dev.............[OK]\nInstallation status of libnl-dev..................[OK]\nCheck Kernel Version..............................[Disabled]\nCheck Qemu Version................................[Disabled]\nCheck libvirt Version.............................[Disabled]\nCheck virsh connectivity..........................[OK]\nIXGBE Enabled.....................................[Disabled]\n==================================================\n    Pre-Install Checks Completed\n==================================================\nCheck for VM vcp-vmx1.............................[Not Running]\nCheck for VM vfp-vmx1.............................[Not Running]\nCleanup VM states.................................[OK]\nCheck if bridge br-ext exists.....................[No]\nCleanup VM bridge br-ext..........................[OK]\nCleanup VM bridge br-int-vmx1.....................[OK]\n==================================================\n    VMX Stop Completed\n==================================================\nCheck VCP image...................................[OK]\nCheck VFP image...................................[OK]\nVMX Model.........................................FPC\nCheck VCP Config image............................[OK]\nCheck management interface........................[OK]\nCheck interface ens34.............................[OK]\nCheck interface ens35.............................[OK]\nSetup huge pages to 8192..........................[OK]\nAttempt to kill libvirt...........................[OK]\nAttempt to start libvirt..........................[OK]\nSleep 2 secs......................................[OK]\nCheck libvirt support for hugepages...............[OK]\n==================================================\n    System Setup Completed\n==================================================\nGet Management Address of ens33...................[OK]\nGenerate libvirt files............................[OK]\nSleep 2 secs......................................[OK]\nFind configured management interface..............ens33\nFind existing management gateway..................ens33\nCheck if ens33 is already enslaved to br-ext......[No]\nGateway interface needs change....................[Yes]\nCreate br-ext.....................................[OK]\nGet Management Gateway............................192.168.100.1\nFlush ens33.......................................[OK]\nStart br-ext......................................[OK]\nBind ens33 to br-ext..............................[OK]\nGet Management MAC................................00:0c:29:f3:16:bb\nAssign Management MAC 00:0c:29:f3:16:bb...........[OK]\nAdd default gw 192.168.100.1......................[OK]\nCreate br-int-vmx1................................[OK]\nStart br-int-vmx1.................................[OK]\nCheck and start default bridge....................[OK]\nDefine vcp-vmx1...................................[OK]\nDefine vfp-vmx1...................................[OK]\nWait 2 secs.......................................[OK]\nStart vcp-vmx1....................................[OK]\nStart vfp-vmx1....................................[OK]\nWait 2 secs.......................................[OK]\n==================================================\n    VMX Bringup Completed\n==================================================\nCheck if br-ext is created........................[Created]\nCheck if br-int-vmx1 is created...................[Created]\nCheck if VM vcp-vmx1 is running...................[Running]\nCheck if VM vfp-vmx1 is running...................[Running]\nCheck if tap interface vcp_ext-vmx1 exists........[OK]\nCheck if tap interface vcp_int-vmx1 exists........[OK]\nCheck if tap interface vfp_ext-vmx1 exists........[OK]\nCheck if tap interface vfp_int-vmx1 exists........[OK]\n==================================================\n    VMX Status Verification Completed.\n==================================================\nLog file........................................../home/tsubo/vmx-16.1R1.7/build/vmx1/logs/vmx_1483127167.log\n==================================================\n    Thank you for using VMX\n==================================================\n\n\n(5) vMX\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u5f8c\u306e\u521d\u671f\u30b3\u30f3\u30d5\u30a3\u30b0\u8a2d\u5b9a\n\nVCP\u306btelnet\u30ed\u30b0\u30a4\u30f3\u3059\u308b\n\n$ telnet localhost 8601\nTrying ::1...\nTrying 127.0.0.1...\nConnected to localhost.\nEscape character is '^]'.\n\n\nFreeBSD/amd64 (Amnesiac) (ttyu0)\n\nlogin: root\n\n--- JUNOS 16.1R1.7 Kernel 64-bit  JNPR-10.1-20160624.329953_builder_stable_10\nroot@:~ # cli\nroot> configure \nEntering configuration mode\n\n[edit]\nroot# \n\n\nroot\u30e6\u30fc\u30b6\u306e\u30d1\u30b9\u30ef\u30fc\u30c9\u3092\u8a2d\u5b9a\u3059\u308b\n\nroot# set system root-authentication plain-text-password \nNew password:\nRetype new password:\n\n[edit]\n\n\nssh\u7d4c\u7531\u3067\u306e\u30ea\u30e2\u30fc\u30c8\u30ed\u30b0\u30a4\u30f3\u3092\u8a31\u5bb9\u3059\u308b\n\nroot# set system services ssh root-login allow \n\n[edit]\n\n\n\u30de\u30cd\u30fc\u30b8\u30e1\u30f3\u30c8\u30dd\u30fc\u30c8\u306e\u30a2\u30c9\u30ec\u30b9\u8a2d\u5b9a\u3092\u884c\u3046\n\nroot# set interfaces fxp0 unit 0 family inet address 192.168.100.101/24 \n\n[edit]\n\n\nlite mode\u3092\u6709\u52b9\u306b\u3059\u308b\n\nroot# set chassis fpc 0 lite-mode\n\n\n\u521d\u671f\u30b3\u30f3\u30d5\u30a3\u30b0\u8a2d\u5b9a\u3092\u30b3\u30df\u30c3\u30c8\u3059\u308b\n\nroot# commit \nGenerating RSA key /etc/ssh/ssh_host_key\nGenerating DSA key /etc/ssh/ssh_host_dsa_key\nGenerating RSA2 key /etc/ssh/ssh_host_rsa_key\nGenerating ECDSA key /etc/ssh/ssh_host_ecdsa_key\nGenerating ED25519 key /etc/ssh/ssh_host_ed25519_key\ncommit complete\n\n[edit]\n\n\ntelnet\u3092\u7d42\u4e86\u3059\u308b\uff08ctrl + \"]\"\u3067login\u30bb\u30c3\u30b7\u30e7\u30f3\u3092\u7d42\u4e86\u3057\u305f\u306e\u3061\u3001\"quit\"\u306b\u3066\u7d42\u4e86\u3059\u308b\uff09\n\ntelnet> quit\nConnection closed.\n\n\n\u30ea\u30e2\u30fc\u30c8\u30ed\u30b0\u30a4\u30f3\u3067\u304d\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\n\n$ ssh root@192.168.100.101\nPassword:\nLast login: Fri Dec 30 20:01:47 2016\n--- JUNOS 16.1R1.7 Kernel 64-bit  JNPR-10.1-20160624.329953_builder_stable_10\nroot@:~ # cli\nroot> \n\n\nvMX\u306e\u521d\u671f\u30b3\u30f3\u30d5\u30a3\u30b0\u5185\u5bb9\u3092\u78ba\u8a8d\u3057\u3066\u307f\u308b\n\nroot> show configuration |display set \nset version 16.1R1.7\nset system root-authentication encrypted-password \"$5$hb1aiak5$ffPgYwaiom.2CADb.NARz/mLcM4PivxkYCRDU/lSVxC\"\nset system services ssh root-login allow\nset system syslog user * any emergency\nset system syslog file messages any notice\nset system syslog file messages authorization info\nset system syslog file interactive-commands interactive-commands any\nset chassis fpc 0 lite-mode\nset interfaces fxp0 unit 0 family inet address 192.168.100.101/24\n\n\nvMX\u69cb\u6210\u3092\u78ba\u8a8d\u3057\u3066\u307f\u308b\n\nroot> show chassis hardware \nHardware inventory:\nItem             Version  Part number  Serial number     Description\nChassis                                VM5866BB5829      VMX\nMidplane        \nRouting Engine 0                                         RE-VMX\nCB 0                                                     VMX SCB\nCB 1                                                     VMX SCB\nFPC 0                                                    Virtual FPC\n  CPU            Rev. 1.0 RIOT         123XYZ987        \n  MIC 0                                                  Virtual\n    PIC 0                 BUILTIN      BUILTIN           Virtual\n\n\ninterface\u52d5\u4f5c\u72b6\u614b\u3092\u78ba\u8a8d\u3057\u3066\u307f\u308b\n\nroot> show interfaces terse \nInterface               Admin Link Proto    Local                 Remote\nge-0/0/0                up    up\nlc-0/0/0                up    up\nlc-0/0/0.32769          up    up   vpls    \npfe-0/0/0               up    up\npfe-0/0/0.16383         up    up   inet    \n                                   inet6   \npfh-0/0/0               up    up\npfh-0/0/0.16383         up    up   inet    \npfh-0/0/0.16384         up    up   inet    \nge-0/0/1                up    up\nge-0/0/2                up    down\nge-0/0/3                up    down\nge-0/0/4                up    down\nge-0/0/5                up    down\nge-0/0/6                up    down\nge-0/0/7                up    down\nge-0/0/8                up    down\nge-0/0/9                up    down\ncbp0                    up    up\ndemux0                  up    up\ndsc                     up    up\nem1                     up    up\nem1.0                   up    up   inet     10.0.0.4/8      \n                                            128.0.0.1/2     \n                                            128.0.0.4/2     \n                                   inet6    fe80::5254:ff:fe61:3c61/64\n                                            fec0::a:0:0:4/64\n                                   tnp      0x4             \nesi                     up    up\nfxp0                    up    up\nfxp0.0                  up    up   inet     192.168.100.101/24\ngre                     up    up\nipip                    up    up\nirb                     up    up\njsrv                    up    up\njsrv.1                  up    up   inet     128.0.0.127/2   \nlo0                     up    up\nlo0.16384               up    up   inet     127.0.0.1           --> 0/0\nlo0.16385               up    up   inet    \nlsi                     up    up\nmtun                    up    up\npimd                    up    up\npime                    up    up\npip0                    up    up\npp0                     up    up\nrbeb                    up    up\ntap                     up    up\nvtep                    up    up\n\n\u4ee5\u4e0a\u3001vMX\u306e\u521d\u671f\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\u304c\u3001\u5b8c\u4e86\u3067\u304d\u307e\u3057\u305f\u3002\n\n\u25a0 \u6700\u5f8c\u306b\n\u305d\u3082\u305d\u3082\u3001MacBook Pro\u306b\u3001vMX\u30bd\u30d5\u30c8\u30eb\u30fc\u30bf\u3092\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\u3059\u308b\u306e\u306f\u3001\u7121\u8b00\u306a\u30c1\u30e3\u30ec\u30f3\u30b8\u3067\u3057\u305f\u3002\n\u672c\u6765\u3001Intel Xeon\u642d\u8f09\u306e\u30de\u30eb\u30c1\u30b3\u30a2CPU\u3092\u591a\u6570\u642d\u8f09\u3057\u3066\u3044\u308b\u30b5\u30fc\u30d0 / \u30ef\u30fc\u30af\u30b9\u30c6\u30fc\u30b7\u30e7\u30f3\u306b\u3001\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\u3059\u308b\u3079\u304d\u3067\u3057\u305f\u3002\n\u305f\u3060\u3001\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\u4f5c\u696d\u306f\u3001\u3060\u3044\u3076\u719f\u77e5\u3067\u304d\u305f\u306e\u3067\u3001\u4eca\u5f8c\u3001\u65b0\u305f\u306a\u30b5\u30fc\u30d0\u5165\u624b\u3059\u308b\u6a5f\u4f1a\u304c\u3042\u308c\u3070\u3001\u672c\u683c\u7684\u306b\u3001vMX\u30bd\u30d5\u30c8\u30a6\u30a7\u30a2\u30eb\u30fc\u30bf\u306e\u691c\u8a3c\u3092\u884c\u3063\u3066\u307f\u305f\u3044\u3067\u3059\u3002\nVMware Fusion on Mac OS X\u74b0\u5883\u306b\u3066\u3001vMX\u30bd\u30d5\u30c8\u30a6\u30a7\u30a2\u30eb\u30fc\u30bf\u3092\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\u3057\u305f\u5099\u5fd8\u9332\u3067\u3059\u3002\n\n- MacBook Pro (Retina, 15-inch, Mid 2015)\n- \u30d7\u30ed\u30bb\u30c3\u30b5\uff1a 2.2 GHz Intel Core i7\n- \u30e1\u30e2\u30ea\uff1a16 GB 1600 MHz DDR3\n\n\u57fa\u672c\u7684\u306b\u306f\u3001\"[vMX Getting Started Guide for KVM](http://www.juniper.net/techpubs/en_US/vmx16.1/information-products/pathway-pages/getting-started/getting-started.pdf)\"\u306e\u8a18\u8f09\u306b\u5f93\u3063\u3066\u3001vMX\u74b0\u5883\u3092\u6574\u5099\u3057\u307e\u3057\u305f\u3002\n\n## \u25a0 vMX\u30c8\u30e9\u30a4\u30a2\u30eb\u7248\u306e\u5165\u624b\n\n\u6b21\u306eURL\u304b\u3089\u3001vMX\u30c8\u30e9\u30a4\u30a2\u30eb\u7248\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3057\u307e\u3059\u3002\nhttp://www.juniper.net/us/en/dm/free-vmx-trial\n\n**\u305f\u3076\u3093\u3001\u3053\u3053\u306e\u5de5\u7a0b\u304c\u3001\u4e00\u756a\u96e3\u6613\u5ea6\u304c\u9ad8\u3044\u306e\u304b\u3082\u3057\u308c\u307e\u305b\u3093**\n\n## \u25a0 vMX\u306e\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\u5099\u5fd8\u9332\n\n\u6700\u5c0f\u69cb\u6210\u3068\u306a\u308b\u3001\"Lab simulation\"\u74b0\u5883\u306e\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\u3092\u76ee\u6307\u3057\u307e\u3059\u3002\n\n![vMX.png](https://qiita-image-store.s3.amazonaws.com/0/103595/a508414f-73dc-6c12-f55c-dab812d6cae2.png)\n\n**\u6b21\u306a\u308b\u96e3\u95a2\u306f\u3001\u6700\u5c0f\u69cb\u6210\u3068\u3044\u3048\u3069\u3082\u30014CPU, 5GB (+\u6570GB)\u306e\u4eee\u60f3\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u304c\u5fc5\u8981\u306b\u306a\u308b\u70b9\u3067\u3059\u306d**\n\uff08\u3061\u306a\u307f\u306b\u3001\u4eca\u56de\u306f\u30014CPU, 8GB\u306e\u4eee\u60f3\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u3067\u4f5c\u696d\u3092\u9032\u3081\u307e\u3057\u305f\u3002\uff09\n\n\n### (1) Ubuntu\u74b0\u5883\u78ba\u8a8d\nVMware Fusion\u4e0a\u306b\u3001\u4eee\u60f3\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\"Ubuntu Server\u7248 16.04.1\"\u3092\u30c7\u30d7\u30ed\u30a4\u3057\u307e\u3057\u305f\u3002\n\n- Ubuntu\u30d0\u30fc\u30b8\u30e7\u30f3\u306e\u78ba\u8a8d\n\n```\n$ cat /etc/lsb-release \nDISTRIB_ID=Ubuntu\nDISTRIB_RELEASE=16.04\nDISTRIB_CODENAME=xenial\nDISTRIB_DESCRIPTION=\"Ubuntu 16.04.1 LTS\"\n```\n- \u642d\u8f09nic\u306e\u78ba\u8a8d\n\n```\n$ lspci|grep Ethernet\n02:01.0 Ethernet controller: Intel Corporation 82545EM Gigabit Ethernet Controller (Copper) (rev 01)\n02:02.0 Ethernet controller: Intel Corporation 82545EM Gigabit Ethernet Controller (Copper) (rev 01)\n02:03.0 Ethernet controller: Intel Corporation 82545EM Gigabit Ethernet Controller (Copper) (rev 01)\n```\n- network\u8a2d\u5b9a\u306e\u78ba\u8a8d\n\n```\n$ cat /etc/network/interfaces\n```\n\n```text:/etc/network/interfaces\n# This file describes the network interfaces available on your system\n# and how to activate them. For more information, see interfaces(5).\n\nsource /etc/network/interfaces.d/*\n\n# The loopback network interface\nauto lo\niface lo inet loopback\n\n# The primary network interface\nauto ens33\niface ens33 inet static\naddress 192.168.100.201\nnetmask 255.255.255.0\ngateway 192.168.100.1\n```\n```\n$ ip addr\n1: lo: <LOOPBACK,UP,LOWER_UP> mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1\n    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00\n    inet 127.0.0.1/8 scope host lo\n       valid_lft forever preferred_lft forever\n    inet6 ::1/128 scope host \n       valid_lft forever preferred_lft forever\n2: ens33: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc pfifo_fast state UP group default qlen 1000\n    link/ether 00:0c:29:f3:16:bb brd ff:ff:ff:ff:ff:ff\n    inet 192.168.100.201/24 brd 192.168.100.255 scope global ens33\n       valid_lft forever preferred_lft forever\n    inet6 240b:11:53a0:400:20c:29ff:fef3:16bb/64 scope global mngtmpaddr dynamic \n       valid_lft 14378sec preferred_lft 12578sec\n    inet6 fe80::20c:29ff:fef3:16bb/64 scope link \n       valid_lft forever preferred_lft forever\n3: ens34: <BROADCAST,MULTICAST> mtu 1500 qdisc noop state DOWN group default qlen 1000\n    link/ether 00:0c:29:f3:16:c5 brd ff:ff:ff:ff:ff:ff\n4: ens35: <BROADCAST,MULTICAST> mtu 1500 qdisc noop state DOWN group default qlen 1000\n    link/ether 00:0c:29:f3:16:cf brd ff:ff:ff:ff:ff:ff\n```\n\n- kernel \u30d0\u30fc\u30b8\u30e7\u30f3\u78ba\u8a8d\n\n```\n$ uname -a\nLinux vMX-1 4.4.0-31-generic #50-Ubuntu SMP Wed Jul 13 00:07:12 UTC 2016 x86_64 x86_64 x86_64 GNU/Linux\n```\n\n- \"vMX-1\"\u4eee\u60f3\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u4e0a\u3067\u3001vt-x\u304c\u6709\u52b9\u306b\u306a\u3063\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\n\n```\n$ cat /proc/cpuinfo | grep vmx\nflags\t\t: fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush dts mmx fxsr sse sse2 ss syscall nx pdpe1gb rdtscp lm constant_tsc arch_perfmon pebs bts nopl xtopology tsc_reliable nonstop_tsc aperfmperf eagerfpu pni pclmulqdq vmx ssse3 fma cx16 pcid sse4_1 sse4_2 x2apic movbe popcnt tsc_deadline_timer aes xsave avx f16c rdrand hypervisor lahf_lm abm epb tpr_shadow vnmi ept vpid fsgsbase tsc_adjust bmi1 avx2 smep bmi2 invpcid xsaveopt dtherm ida arat pln pts\nflags\t\t: fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush dts mmx fxsr sse sse2 ss syscall nx pdpe1gb rdtscp lm constant_tsc arch_perfmon pebs bts nopl xtopology tsc_reliable nonstop_tsc aperfmperf eagerfpu pni pclmulqdq vmx ssse3 fma cx16 pcid sse4_1 sse4_2 x2apic movbe popcnt tsc_deadline_timer aes xsave avx f16c rdrand hypervisor lahf_lm abm epb tpr_shadow vnmi ept vpid fsgsbase tsc_adjust bmi1 avx2 smep bmi2 invpcid xsaveopt dtherm ida arat pln pts\nflags\t\t: fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush dts mmx fxsr sse sse2 ss syscall nx pdpe1gb rdtscp lm constant_tsc arch_perfmon pebs bts nopl xtopology tsc_reliable nonstop_tsc aperfmperf eagerfpu pni pclmulqdq vmx ssse3 fma cx16 pcid sse4_1 sse4_2 x2apic movbe popcnt tsc_deadline_timer aes xsave avx f16c rdrand hypervisor lahf_lm abm epb tpr_shadow vnmi ept vpid fsgsbase tsc_adjust bmi1 avx2 smep bmi2 invpcid xsaveopt dtherm ida arat pln pts\nflags\t\t: fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush dts mmx fxsr sse sse2 ss syscall nx pdpe1gb rdtscp lm constant_tsc arch_perfmon pebs bts nopl xtopology tsc_reliable nonstop_tsc aperfmperf eagerfpu pni pclmulqdq vmx ssse3 fma cx16 pcid sse4_1 sse4_2 x2apic movbe popcnt tsc_deadline_timer aes xsave avx f16c rdrand hypervisor lahf_lm abm epb tpr_shadow vnmi ept vpid fsgsbase tsc_adjust bmi1 avx2 smep bmi2 invpcid xsaveopt dtherm ida arat pln pts\n```\n\n### (2) vMX\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u306b\u5411\u3051\u3066\u306e\u4e8b\u524d\u6e96\u5099\n\n- \u5404\u7a2e\u30d1\u30c3\u30b1\u30fc\u30b8\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n```\n$ sudo apt-get update\n$ sudo apt-get install -y bridge-utils qemu-kvm libvirt-bin\n$ sudo apt-get install -y libyaml-dev python-yaml numactl libparted0-dev libpciaccess-dev\n$ sudo apt-get install -y libnuma-dev libyajl-dev libxml2-dev libglib2.0-dev\n$ sudo apt-get install -y python-pip python-dev libxml2-dev libxslt-dev libnl-3-dev\n$ sudo apt-get install -y python python-netifaces vnc4server\n```\n\n- libvirt\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u78ba\u8a8d\n\n```\n$ libvirtd --version\nlibvirtd (libvirt) 1.3.1\n```\n- virtsh\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u78ba\u8a8d\n\n```\n$ virsh --version\n1.3.1\n```\n\n### (3) Ubuntu\u74b0\u5883\u306e\u8a2d\u5b9a\u5909\u66f4\n- KSM\u3092\u7121\u52b9\u306b\u3059\u308b\n\n```\n$ sudo vi /etc/default/qemu-kvm\n```\n```text:qemu-kvm\nKSM_ENABLED=0\n```\n- APIC\u3092\u7121\u52b9\u306b\u3059\u308b\n\n```\n$ sudo vi /etc/modprobe.d/qemu-system-x86.conf\n```\n\n```text:qemu-system-x86.conf\noptions kvm_intel enable_apicv=0 nested=1 enable_apicv=0\n```\n\n\n- \u518d\u8d77\u52d5 ..\n\n```\n$ sudo reboot\n```\n\n- \"kvm-intel\"\u30ab\u30fc\u30cd\u30eb\u30e2\u30b8\u30e5\u30fc\u30eb\u3092\u7d44\u307f\u8fbc\u3080\n\n```\n$ sudo modprobe kvm_intel\n\n$ lsmod|grep kvm\nkvm_intel             172032  0\nkvm                   536576  1 kvm_intel\nirqbypass              16384  1 kvm\n```\n\n### (4) vMX\u30d1\u30c3\u30b1\u30fc\u30b8\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n- vMX\u30d1\u30c3\u30b1\u30fc\u30b8\u3092\u5c55\u958b\u3059\u308b\uff08\u3053\u3053\u3067\u306f\u3001/home/tsubo\u914d\u4e0b\u306b\u5c55\u958b\u3057\u305f\u3082\u306e\u3068\u3059\u308b\uff09\n\n```\n$ ls -l /home/tsubo\ntotal 4\ndrwxrwxr-x 8 tsubo tsubo 4096 Dec 31 04:30 vmx-16.1R1.7\n```\n- vMX\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3092\u914d\u5e03\u3059\u308b\n\n```\n$ vi /home/tsubo/vmx-16.1R1.7/config/vmx.conf \n```\n```text:vmx.conf \n##############################################################\n#\n#  vmx.conf\n#  Config file for vmx on the hypervisor.\n#  Uses YAML syntax. \n#  Leave a space after \":\" to specify the parameter value.\n#\n##############################################################\n\n--- \n#Configuration on the host side - management interface, VM images etc.\nHOST:\n    identifier                : vmx1   # Maximum 4 characters\n    host-management-interface : ens33\n    routing-engine-image      : \"/home/tsubo/vmx-16.1R1.7/images/junos-vmx-x86-64-16.1R1.7.qcow2\"\n    routing-engine-hdd        : \"/home/tsubo/vmx-16.1R1.7/images/vmxhdd.img\"\n    forwarding-engine-image   : \"/home/tsubo/vmx-16.1R1.7/images/vFPC-20160617.img\"\n\n---\n#External bridge configuration\nBRIDGES:\n    - type  : external\n      name  : br-ext                  # Max 10 characters\n\n--- \n#vRE VM parameters\nCONTROL_PLANE:\n    vcpus       : 1\n    memory-mb   : 1024 \n    console_port: 8601\n\n    interfaces  :\n      - type      : static\n        ipaddr    : 10.102.144.94 \n        macaddr   : \"0A:00:DD:C0:DE:0E\"\n\n--- \n#vPFE VM parameters\nFORWARDING_PLANE:\n    memory-mb   : 4096\n    vcpus       : 3\n    console_port: 8602\n    device-type : virtio \n\n    interfaces  :\n      - type      : static\n        ipaddr    : 10.102.144.98\n        macaddr   : \"0A:00:DD:C0:DE:10\"\n\n--- \n#Interfaces\nJUNOS_DEVICES:\n   - interface            : ge-0/0/0\n     mac-address          : \"02:06:0A:0E:FF:F0\"\n     description          : \"ge-0/0/0 interface\"\n\n   - interface            : ge-0/0/1\n     mac-address          : \"02:06:0A:0E:FF:F1\"\n     description          : \"ge-0/0/1 interface\"\n```\n- vMX\u30d1\u30c3\u30b1\u30fc\u30b8\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\n\n```\n$ cd /home/tsubo/vmx-16.1R1.7\n$ sudo ./vmx.sh -lv --install\n==================================================\n    Welcome to VMX\n==================================================\nDate..............................................12/31/16 04:46:07\nVMX Identifier....................................vmx1\nConfig file......................................./home/tsubo/vmx-16.1R1.7/config/vmx.conf\nBuild Directory.................................../home/tsubo/vmx-16.1R1.7/build/vmx1\nEnvironment file................................../home/tsubo/vmx-16.1R1.7/env/ubuntu_virtio.env\nJunos Device Type.................................virtio\nInitialize scripts................................[OK]\nCopy images to build directory....................[OK]\n==================================================\n    VMX Environment Setup Completed\n==================================================\n==================================================\n    VMX Install & Start\n==================================================\nLinux distribution................................ubuntu\nCheck GRUB........................................[Disabled]\nInstallation status of qemu-kvm...................[OK]\nInstallation status of libvirt-bin................[OK]\nInstallation status of bridge-utils...............[OK]\nInstallation status of python.....................[OK]\nInstallation status of libyaml-dev................[OK]\nInstallation status of python-yaml................[OK]\nInstallation status of numactl....................[OK]\nInstallation status of libnuma-dev................[OK]\nInstallation status of libparted0-dev.............[OK]\nInstallation status of libpciaccess-dev...........[OK]\nInstallation status of libyajl-dev................[OK]\nInstallation status of libxml2-dev................[OK]\nInstallation status of libglib2.0-dev.............[OK]\nInstallation status of libnl-dev..................[OK]\nCheck Kernel Version..............................[Disabled]\nCheck Qemu Version................................[Disabled]\nCheck libvirt Version.............................[Disabled]\nCheck virsh connectivity..........................[OK]\nIXGBE Enabled.....................................[Disabled]\n==================================================\n    Pre-Install Checks Completed\n==================================================\nCheck for VM vcp-vmx1.............................[Not Running]\nCheck for VM vfp-vmx1.............................[Not Running]\nCleanup VM states.................................[OK]\nCheck if bridge br-ext exists.....................[No]\nCleanup VM bridge br-ext..........................[OK]\nCleanup VM bridge br-int-vmx1.....................[OK]\n==================================================\n    VMX Stop Completed\n==================================================\nCheck VCP image...................................[OK]\nCheck VFP image...................................[OK]\nVMX Model.........................................FPC\nCheck VCP Config image............................[OK]\nCheck management interface........................[OK]\nCheck interface ens34.............................[OK]\nCheck interface ens35.............................[OK]\nSetup huge pages to 8192..........................[OK]\nAttempt to kill libvirt...........................[OK]\nAttempt to start libvirt..........................[OK]\nSleep 2 secs......................................[OK]\nCheck libvirt support for hugepages...............[OK]\n==================================================\n    System Setup Completed\n==================================================\nGet Management Address of ens33...................[OK]\nGenerate libvirt files............................[OK]\nSleep 2 secs......................................[OK]\nFind configured management interface..............ens33\nFind existing management gateway..................ens33\nCheck if ens33 is already enslaved to br-ext......[No]\nGateway interface needs change....................[Yes]\nCreate br-ext.....................................[OK]\nGet Management Gateway............................192.168.100.1\nFlush ens33.......................................[OK]\nStart br-ext......................................[OK]\nBind ens33 to br-ext..............................[OK]\nGet Management MAC................................00:0c:29:f3:16:bb\nAssign Management MAC 00:0c:29:f3:16:bb...........[OK]\nAdd default gw 192.168.100.1......................[OK]\nCreate br-int-vmx1................................[OK]\nStart br-int-vmx1.................................[OK]\nCheck and start default bridge....................[OK]\nDefine vcp-vmx1...................................[OK]\nDefine vfp-vmx1...................................[OK]\nWait 2 secs.......................................[OK]\nStart vcp-vmx1....................................[OK]\nStart vfp-vmx1....................................[OK]\nWait 2 secs.......................................[OK]\n==================================================\n    VMX Bringup Completed\n==================================================\nCheck if br-ext is created........................[Created]\nCheck if br-int-vmx1 is created...................[Created]\nCheck if VM vcp-vmx1 is running...................[Running]\nCheck if VM vfp-vmx1 is running...................[Running]\nCheck if tap interface vcp_ext-vmx1 exists........[OK]\nCheck if tap interface vcp_int-vmx1 exists........[OK]\nCheck if tap interface vfp_ext-vmx1 exists........[OK]\nCheck if tap interface vfp_int-vmx1 exists........[OK]\n==================================================\n    VMX Status Verification Completed.\n==================================================\nLog file........................................../home/tsubo/vmx-16.1R1.7/build/vmx1/logs/vmx_1483127167.log\n==================================================\n    Thank you for using VMX\n==================================================\n```\n\n### (5) vMX\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u5f8c\u306e\u521d\u671f\u30b3\u30f3\u30d5\u30a3\u30b0\u8a2d\u5b9a\n- VCP\u306btelnet\u30ed\u30b0\u30a4\u30f3\u3059\u308b\n\n```\n$ telnet localhost 8601\nTrying ::1...\nTrying 127.0.0.1...\nConnected to localhost.\nEscape character is '^]'.\n\n\nFreeBSD/amd64 (Amnesiac) (ttyu0)\n\nlogin: root\n\n--- JUNOS 16.1R1.7 Kernel 64-bit  JNPR-10.1-20160624.329953_builder_stable_10\nroot@:~ # cli\nroot> configure \nEntering configuration mode\n\n[edit]\nroot# \n```\n- root\u30e6\u30fc\u30b6\u306e\u30d1\u30b9\u30ef\u30fc\u30c9\u3092\u8a2d\u5b9a\u3059\u308b\n\n```\nroot# set system root-authentication plain-text-password \nNew password:\nRetype new password:\n\n[edit]\n```\n- ssh\u7d4c\u7531\u3067\u306e\u30ea\u30e2\u30fc\u30c8\u30ed\u30b0\u30a4\u30f3\u3092\u8a31\u5bb9\u3059\u308b\n\n```\nroot# set system services ssh root-login allow \n\n[edit]\n```\n- \u30de\u30cd\u30fc\u30b8\u30e1\u30f3\u30c8\u30dd\u30fc\u30c8\u306e\u30a2\u30c9\u30ec\u30b9\u8a2d\u5b9a\u3092\u884c\u3046\n\n```\nroot# set interfaces fxp0 unit 0 family inet address 192.168.100.101/24 \n\n[edit]\n```\n- lite mode\u3092\u6709\u52b9\u306b\u3059\u308b\n\n```\nroot# set chassis fpc 0 lite-mode\n```\n- \u521d\u671f\u30b3\u30f3\u30d5\u30a3\u30b0\u8a2d\u5b9a\u3092\u30b3\u30df\u30c3\u30c8\u3059\u308b\n\n```\nroot# commit \nGenerating RSA key /etc/ssh/ssh_host_key\nGenerating DSA key /etc/ssh/ssh_host_dsa_key\nGenerating RSA2 key /etc/ssh/ssh_host_rsa_key\nGenerating ECDSA key /etc/ssh/ssh_host_ecdsa_key\nGenerating ED25519 key /etc/ssh/ssh_host_ed25519_key\ncommit complete\n\n[edit]\n```\n- telnet\u3092\u7d42\u4e86\u3059\u308b\uff08ctrl + \"]\"\u3067login\u30bb\u30c3\u30b7\u30e7\u30f3\u3092\u7d42\u4e86\u3057\u305f\u306e\u3061\u3001\"quit\"\u306b\u3066\u7d42\u4e86\u3059\u308b\uff09\n\n```\ntelnet> quit\nConnection closed.\n```\n- \u30ea\u30e2\u30fc\u30c8\u30ed\u30b0\u30a4\u30f3\u3067\u304d\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\n\n```\n$ ssh root@192.168.100.101\nPassword:\nLast login: Fri Dec 30 20:01:47 2016\n--- JUNOS 16.1R1.7 Kernel 64-bit  JNPR-10.1-20160624.329953_builder_stable_10\nroot@:~ # cli\nroot> \n```\n- vMX\u306e\u521d\u671f\u30b3\u30f3\u30d5\u30a3\u30b0\u5185\u5bb9\u3092\u78ba\u8a8d\u3057\u3066\u307f\u308b\n\n```\nroot> show configuration |display set \nset version 16.1R1.7\nset system root-authentication encrypted-password \"$5$hb1aiak5$ffPgYwaiom.2CADb.NARz/mLcM4PivxkYCRDU/lSVxC\"\nset system services ssh root-login allow\nset system syslog user * any emergency\nset system syslog file messages any notice\nset system syslog file messages authorization info\nset system syslog file interactive-commands interactive-commands any\nset chassis fpc 0 lite-mode\nset interfaces fxp0 unit 0 family inet address 192.168.100.101/24\n```\n\n- vMX\u69cb\u6210\u3092\u78ba\u8a8d\u3057\u3066\u307f\u308b\n\n```\nroot> show chassis hardware \nHardware inventory:\nItem             Version  Part number  Serial number     Description\nChassis                                VM5866BB5829      VMX\nMidplane        \nRouting Engine 0                                         RE-VMX\nCB 0                                                     VMX SCB\nCB 1                                                     VMX SCB\nFPC 0                                                    Virtual FPC\n  CPU            Rev. 1.0 RIOT         123XYZ987        \n  MIC 0                                                  Virtual\n    PIC 0                 BUILTIN      BUILTIN           Virtual\n```\n\n- interface\u52d5\u4f5c\u72b6\u614b\u3092\u78ba\u8a8d\u3057\u3066\u307f\u308b\n\n```\nroot> show interfaces terse \nInterface               Admin Link Proto    Local                 Remote\nge-0/0/0                up    up\nlc-0/0/0                up    up\nlc-0/0/0.32769          up    up   vpls    \npfe-0/0/0               up    up\npfe-0/0/0.16383         up    up   inet    \n                                   inet6   \npfh-0/0/0               up    up\npfh-0/0/0.16383         up    up   inet    \npfh-0/0/0.16384         up    up   inet    \nge-0/0/1                up    up\nge-0/0/2                up    down\nge-0/0/3                up    down\nge-0/0/4                up    down\nge-0/0/5                up    down\nge-0/0/6                up    down\nge-0/0/7                up    down\nge-0/0/8                up    down\nge-0/0/9                up    down\ncbp0                    up    up\ndemux0                  up    up\ndsc                     up    up\nem1                     up    up\nem1.0                   up    up   inet     10.0.0.4/8      \n                                            128.0.0.1/2     \n                                            128.0.0.4/2     \n                                   inet6    fe80::5254:ff:fe61:3c61/64\n                                            fec0::a:0:0:4/64\n                                   tnp      0x4             \nesi                     up    up\nfxp0                    up    up\nfxp0.0                  up    up   inet     192.168.100.101/24\ngre                     up    up\nipip                    up    up\nirb                     up    up\njsrv                    up    up\njsrv.1                  up    up   inet     128.0.0.127/2   \nlo0                     up    up\nlo0.16384               up    up   inet     127.0.0.1           --> 0/0\nlo0.16385               up    up   inet    \nlsi                     up    up\nmtun                    up    up\npimd                    up    up\npime                    up    up\npip0                    up    up\npp0                     up    up\nrbeb                    up    up\ntap                     up    up\nvtep                    up    up\n```\n\n\u4ee5\u4e0a\u3001vMX\u306e\u521d\u671f\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\u304c\u3001\u5b8c\u4e86\u3067\u304d\u307e\u3057\u305f\u3002\n\n## \u25a0 \u6700\u5f8c\u306b\n\u305d\u3082\u305d\u3082\u3001MacBook Pro\u306b\u3001vMX\u30bd\u30d5\u30c8\u30eb\u30fc\u30bf\u3092\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\u3059\u308b\u306e\u306f\u3001\u7121\u8b00\u306a\u30c1\u30e3\u30ec\u30f3\u30b8\u3067\u3057\u305f\u3002\n\u672c\u6765\u3001Intel Xeon\u642d\u8f09\u306e\u30de\u30eb\u30c1\u30b3\u30a2CPU\u3092\u591a\u6570\u642d\u8f09\u3057\u3066\u3044\u308b\u30b5\u30fc\u30d0 / \u30ef\u30fc\u30af\u30b9\u30c6\u30fc\u30b7\u30e7\u30f3\u306b\u3001\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\u3059\u308b\u3079\u304d\u3067\u3057\u305f\u3002\n\u305f\u3060\u3001\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\u4f5c\u696d\u306f\u3001\u3060\u3044\u3076\u719f\u77e5\u3067\u304d\u305f\u306e\u3067\u3001\u4eca\u5f8c\u3001\u65b0\u305f\u306a\u30b5\u30fc\u30d0\u5165\u624b\u3059\u308b\u6a5f\u4f1a\u304c\u3042\u308c\u3070\u3001\u672c\u683c\u7684\u306b\u3001vMX\u30bd\u30d5\u30c8\u30a6\u30a7\u30a2\u30eb\u30fc\u30bf\u306e\u691c\u8a3c\u3092\u884c\u3063\u3066\u307f\u305f\u3044\u3067\u3059\u3002\n", "tags": ["junos", "KVM"]}