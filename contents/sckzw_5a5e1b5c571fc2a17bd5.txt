{"context": " More than 1 year has passed since last update.Emacs\u306b\u304a\u3044\u3066verilog-mode + flymake + verilator\u3067\u81ea\u52d5\u3067lint\u30c1\u30a7\u30c3\u30af\u3092\u884c\u3048\u308b\u3088\u3046\u306b\u3059\u308b\u3002\n\nverilog-mode-flymake.el\n;;; flymake\n(require 'flymake)\n\n;; \u30c1\u30a7\u30c3\u30af\u5f8c\u306b\u30a8\u30e9\u30fc\u3057\u3066\u3082\u7d42\u4e86\u3057\u306a\u3044\u3088\u3046\u306b\u3059\u308b\n(defadvice flymake-post-syntax-check\n  (before flymake-force-check-was-interrupted)\n  (setq flymake-check-was-interrupted t))\n(ad-activate 'flymake-post-syntax-check)\n\n;; Verilog HDL\u7528\u306eflymake\u521d\u671f\u5316\u95a2\u6570\n(defun flymake-verilog-init()\n  (let* ((temp-file (flymake-init-create-temp-buffer-copy 'flymake-create-temp-inplace))\n         (main-file (file-relative-name temp-file (file-name-directory buffer-file-name)))\n         (sub-files (flymake-verilog-get-files)))\n    (list \"verilator_bin\" (append (list \"--lint-only\" main-file) sub-files))))\n\n;; verilog-mode\u306everilog-library-files\u8a2d\u5b9a\u304b\u3089\u30b5\u30d6\u30e2\u30b8\u30e5\u30fc\u30eb\u306e\u30d5\u30a1\u30a4\u30eb\u30ea\u30b9\u30c8\u3092\u53d6\u5f97\u3059\u308b\n(defun flymake-verilog-get-files()\n  (save-excursion\n    (goto-char (point-min))\n    (if (re-search-forward \"verilog-library-files:( *\\\"\\\\([^)]+\\\\)\\\" *)\" nil t)\n        (split-string (match-string-no-properties 1) \"\\\" *\\\"\") (list))))\n\n;; Verilog HDL\u306e\u30d5\u30a1\u30a4\u30eb\u62e1\u5f35\u5b50\u3068\u521d\u671f\u5316\u95a2\u6570\u3092\u767b\u9332\u3059\u308b\n(push '(\".+\\\\.s?v$\" flymake-verilog-init) flymake-allowed-file-name-masks)\n\n;; \u30a8\u30e9\u30fc\u30e1\u30c3\u30bb\u30fc\u30b8\u306e\u30d1\u30bf\u30fc\u30f3\u3092\u767b\u9332\u3059\u308b\n(push '(\"^%.+: \\\\(.+\\\\):\\\\([0-9]+\\\\): \\\\(.*\\\\)$\" 1 2 nil 3) flymake-err-line-patterns)\n\n;; verilog-mode\u3067flymake\u3092\u6709\u52b9\u306b\u3059\u308b\n(add-hook 'verilog-mode-hook '(lambda () (flymake-mode t)))\n\n\nverilog-mode\u306everilog-library-files\u306e\u8a18\u8f09\u304c\u3042\u308c\u3070\u3001\u305d\u3053\u304b\u3089\u30d5\u30a1\u30a4\u30eb\u4e00\u89a7\u3092\u53d6\u5f97\u3057verilator\u3078\u6e21\u3057\u3066\u3044\u308b\u3002\n\u3053\u3046\u3059\u308b\u3053\u3068\u3067\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u3057\u3066\u3044\u308b\u30b5\u30d6\u30e2\u30b8\u30e5\u30fc\u30eb\u3068\u306e\u63a5\u7d9a\u3082\u30c1\u30a7\u30c3\u30af\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u308b\u3002\nLocal Variable\u306e\u5024\u3092\u7de8\u96c6\u3057\u3066\u3082verilog-library-files\u306e\u5024\u306f\u30d5\u30a1\u30a4\u30eb\u3092\u518d\u8aad\u307f\u8fbc\u307f\u3057\u306a\u3044\u3068\u53cd\u6620\u3055\u308c\u306a\u3044\u3088\u3046\u306a\u306e\u3067\u3001\n\u7de8\u96c6\u5f8c\u306b\u53cd\u6620\u3055\u308c\u308b\u3088\u3046\u306b\u30b4\u30ea\u62bc\u3057\u3067\u5b9f\u88c5\u3057\u3066\u3044\u308b\u3002\n\nverilog-mode-flymake-sample.v\nmodule foo( /*AUTOARG*/ );\n    /*AUTOINPUT*/\n    /*AUTOOUTPUT*/\n    /*AUTOWIRE*/\n\n    bar bar( /*AUTOINST*/ );\n    baz baz( /*AUTOINST*/ );\nendmodule\n\n// Local Variables:\n// verilog-library-files:(\"bar.v\" \"baz.v\")\n// End:\n\n\nflymake\u306esyntax-check\u304c\u7570\u5e38\u7d42\u4e86\u3057\u3066\u3082\u7121\u8996\u3059\u308b\u3088\u3046\u306b\u3059\u308b\u3092\u53c2\u8003\u306b\u3057\u305f\u3002\nEmacs\u306b\u304a\u3044\u3066verilog-mode + flymake + verilator\u3067\u81ea\u52d5\u3067lint\u30c1\u30a7\u30c3\u30af\u3092\u884c\u3048\u308b\u3088\u3046\u306b\u3059\u308b\u3002\n\n```el:verilog-mode-flymake.el\n;;; flymake\n(require 'flymake)\n\n;; \u30c1\u30a7\u30c3\u30af\u5f8c\u306b\u30a8\u30e9\u30fc\u3057\u3066\u3082\u7d42\u4e86\u3057\u306a\u3044\u3088\u3046\u306b\u3059\u308b\n(defadvice flymake-post-syntax-check\n  (before flymake-force-check-was-interrupted)\n  (setq flymake-check-was-interrupted t))\n(ad-activate 'flymake-post-syntax-check)\n\n;; Verilog HDL\u7528\u306eflymake\u521d\u671f\u5316\u95a2\u6570\n(defun flymake-verilog-init()\n  (let* ((temp-file (flymake-init-create-temp-buffer-copy 'flymake-create-temp-inplace))\n         (main-file (file-relative-name temp-file (file-name-directory buffer-file-name)))\n         (sub-files (flymake-verilog-get-files)))\n    (list \"verilator_bin\" (append (list \"--lint-only\" main-file) sub-files))))\n\n;; verilog-mode\u306everilog-library-files\u8a2d\u5b9a\u304b\u3089\u30b5\u30d6\u30e2\u30b8\u30e5\u30fc\u30eb\u306e\u30d5\u30a1\u30a4\u30eb\u30ea\u30b9\u30c8\u3092\u53d6\u5f97\u3059\u308b\n(defun flymake-verilog-get-files()\n  (save-excursion\n    (goto-char (point-min))\n    (if (re-search-forward \"verilog-library-files:( *\\\"\\\\([^)]+\\\\)\\\" *)\" nil t)\n        (split-string (match-string-no-properties 1) \"\\\" *\\\"\") (list))))\n\n;; Verilog HDL\u306e\u30d5\u30a1\u30a4\u30eb\u62e1\u5f35\u5b50\u3068\u521d\u671f\u5316\u95a2\u6570\u3092\u767b\u9332\u3059\u308b\n(push '(\".+\\\\.s?v$\" flymake-verilog-init) flymake-allowed-file-name-masks)\n\n;; \u30a8\u30e9\u30fc\u30e1\u30c3\u30bb\u30fc\u30b8\u306e\u30d1\u30bf\u30fc\u30f3\u3092\u767b\u9332\u3059\u308b\n(push '(\"^%.+: \\\\(.+\\\\):\\\\([0-9]+\\\\): \\\\(.*\\\\)$\" 1 2 nil 3) flymake-err-line-patterns)\n\n;; verilog-mode\u3067flymake\u3092\u6709\u52b9\u306b\u3059\u308b\n(add-hook 'verilog-mode-hook '(lambda () (flymake-mode t)))\n```\n\nverilog-mode\u306everilog-library-files\u306e\u8a18\u8f09\u304c\u3042\u308c\u3070\u3001\u305d\u3053\u304b\u3089\u30d5\u30a1\u30a4\u30eb\u4e00\u89a7\u3092\u53d6\u5f97\u3057verilator\u3078\u6e21\u3057\u3066\u3044\u308b\u3002\n\u3053\u3046\u3059\u308b\u3053\u3068\u3067\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u3057\u3066\u3044\u308b\u30b5\u30d6\u30e2\u30b8\u30e5\u30fc\u30eb\u3068\u306e\u63a5\u7d9a\u3082\u30c1\u30a7\u30c3\u30af\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u308b\u3002\nLocal Variable\u306e\u5024\u3092\u7de8\u96c6\u3057\u3066\u3082verilog-library-files\u306e\u5024\u306f\u30d5\u30a1\u30a4\u30eb\u3092\u518d\u8aad\u307f\u8fbc\u307f\u3057\u306a\u3044\u3068\u53cd\u6620\u3055\u308c\u306a\u3044\u3088\u3046\u306a\u306e\u3067\u3001\n\u7de8\u96c6\u5f8c\u306b\u53cd\u6620\u3055\u308c\u308b\u3088\u3046\u306b\u30b4\u30ea\u62bc\u3057\u3067\u5b9f\u88c5\u3057\u3066\u3044\u308b\u3002\n\n```verilog:verilog-mode-flymake-sample.v\nmodule foo( /*AUTOARG*/ );\n    /*AUTOINPUT*/\n    /*AUTOOUTPUT*/\n    /*AUTOWIRE*/\n\n    bar bar( /*AUTOINST*/ );\n    baz baz( /*AUTOINST*/ );\nendmodule\n\n// Local Variables:\n// verilog-library-files:(\"bar.v\" \"baz.v\")\n// End:\n```\n\n[flymake\u306esyntax-check\u304c\u7570\u5e38\u7d42\u4e86\u3057\u3066\u3082\u7121\u8996\u3059\u308b\u3088\u3046\u306b\u3059\u308b](http://d.hatena.ne.jp/sugyan/20100705/1278306885 \"flymake\u306esyntax-check\u304c\u7570\u5e38\u7d42\u4e86\u3057\u3066\u3082\u7121\u8996\u3059\u308b\u3088\u3046\u306b\u3059\u308b\")\u3092\u53c2\u8003\u306b\u3057\u305f\u3002\n", "tags": ["Verilog", "Emacs"]}