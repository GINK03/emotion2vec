{"context": " More than 1 year has passed since last update.\u300c\u3068\u308a\u3042\u3048\u305a\u3001\u3084\u3063\u3066\u307f\u307e\u3057\u305f\u300d\u3068\u3044\u3046\u8a18\u9332\u3067\u3059\u3002\n\nFluent(d) \u3001\u547c\u3073\u65b9\u3059\u3089\u3088\u304f\u5206\u304b\u3063\u3066\u307e\u305b\u3093\nBugsnag\u3001\u6700\u8fd1\u30c8\u30e9\u30a4\u30a2\u30eb\u59cb\u3081\u305f\u7a0b\u5ea6\u306e\u77e5\u898b\u3067\u3059\ngem\u3001\u8ab0\u304b\u306b\u4f7f\u3063\u3066\u3082\u3089\u3046\u4e8b\u3092\u8003\u3048\u305f\u30ea\u30ea\u30fc\u30b9\u306b\u306a\u3063\u3066\u307e\u305b\u3093\n\u958b\u767a\u30fb\u5b9f\u884c\u74b0\u5883\n\n\nOSX 10.10.3\nRails 4.2.1\ntd-agent-2.1.4-0.dmg\n\n\n\n\nTL;DR\n\n\nkoshigoe/logging-bugsnag \u3067 TwP/logging \u3092\u62e1\u5f35\n\n\nerror \u4ee5\u4e0a\u306e\u30ed\u30b0\u3092 bugsnag/bugsnag-ruby \u306e deliver \u306b\u6e21\u3059\n\n\n\nkoshigoe/bugsnag-delivery-fluent \u3067 bugsnag/bugsnag-ruby \u3092\u62e1\u5f35\n\n\ndeliver \u3092\u62e1\u5f35\u3057 Fluent \u306b URL \u3068\u30ea\u30af\u30a8\u30b9\u30c8\u30dc\u30c7\u30a3\u3092\u6e21\u3059\n\n\n\nkoshigoe/fluent-plugin-bugsnag \u3067 Fluentd \u304b\u3089 Bugsnag \u306b\u9001\u4fe1\u3059\u308b\n\n\nFluent\n\nfluent-plugin-bugsnag\nFluent \u304b\u3089 Bugsnag \u3078\u9001\u4fe1\u3059\u308b\u30d7\u30e9\u30b0\u30a4\u30f3 koshigoe/fluent-plugin-bugsnag \u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\u3002\n$ sudo td-agent-gem install fluent-plugin-bugsnag\n\n\ntd-agent.conf\nkoshigoe/bugsnag-delivery-fluent \u306e\u5229\u7528\u3092\u60f3\u5b9a\u3057\u3066\u3044\u308b\u306e\u3067\u3001\u30bf\u30b0 bugsnag.deliver \u3092\u5bfe\u8c61\u306b bugsnag \u30d7\u30e9\u30b0\u30a4\u30f3\u3092\u9069\u7528\u3059\u308b\u8a2d\u5b9a\u3092\u8ffd\u52a0\u3002\n<source>\n  type forward\n</source>\n\n<match bugsnag.deliver>\n  type bugsnag\n\n  # bugsnag_proxy_host localhost\n  # bugsnag_proxy_port 8888\n  # bugsnag_proxy_user user\n  # bugsnag_proxy_password password\n  # bugsnag_timeout 10\n</match>\n\n\u8a2d\u5b9a\u304c\u7528\u610f\u3067\u304d\u305f\u3089 td-agent \u3092\u8d77\u52d5\u3002\n$ td-agent -c td-agent.conf\n\n\n\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\nRails \u30a2\u30d7\u30ea\u3092\u60f3\u5b9a\u3002\n\nGemfile\ngem 'logging-rails'\ngem 'logging-bugsnag'\ngem 'bugsnag-delivery-fluent'\n\n$ bundle install\n\n\nconfig/logging.rb\nTwP/logging-rails \u3092\u4f7f\u3046\u306e\u3067\u3001\u30b8\u30a7\u30cd\u30ec\u30fc\u30bf\u3067\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u6210\u3059\u308b\u3002\n$ rails generate logging:install\n\n\u4f5c\u6210\u3057\u305f config/logging.rb \u306b\u4ee5\u4e0b\u3092\u8ffd\u8a18\u3057\u3066 bugsnag appender \u3092\u4f7f\u3048\u308b\u69d8\u306b\u3057\u3066\u304a\u304f\u3002\nLogging.appenders.bugsnag('bugsnag', level: :error) if config.log_to.include? 'bugsnag'\n\n\nconfig.log_to\nconfig/environments/production.rb \u306a\u3069\u3067 config.log_to \u306b 'bugsnag' \u3092\u8ffd\u52a0\u3059\u308c\u3070 logger \u306b\u7d44\u307f\u8fbc\u307e\u308c\u308b\u3002\nconfig.log_to = %w[file bugsnag]\n\n\nconfig/initializers/bugsnag.rb\n\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u304b\u3089\u76f4\u63a5 Bugsnag \u306b\u9001\u4fe1\u305b\u305a Fluentd \u306b\u9001\u4fe1\u3092\u4efb\u305b\u308b\u305f\u3081\u306b\u3001 delivery_method \u3092 :fluent \u3068\u3059\u308b\u3002\nBugsnag.configure do |config|\n  config.api_key = ENV['BUGSNAG_API_KEY']\n  config.logger = ActiveSupport::Logger.new(Rails.root.join('log/bugsnag.log'), 10, 100.megabytes)\n  config.delivery_method = :fluent\n  # config.fluent_tag_prefix = 'bugsnag'\n  # config.fluent_host = 'localhost'\n  # config.fluent_port = 24224\nend\n\n\n\u5229\u7528\u958b\u59cb\n\u3053\u3053\u307e\u3067\u3067\u3001\u6355\u6349\u3057\u3066\u306a\u3044\u4f8b\u5916\u3068 error \u4ee5\u4e0a\u306e\u30ed\u30b0\u51fa\u529b\u304c Fluent \u306b\u9001\u3089\u308c\u3001Fluent \u3067\u9069\u5b9c Bugsnag \u306b\u9001\u4fe1\u3055\u308c\u308b\u69d8\u306b\u306a\u308b\u3002\n$ rails c\n> Rails.logger.error('TEST TEST TEST')\n> Bugsnag.notify(RuntimeError.new('TETETETE TEST'))\n\n\u300c\u3068\u308a\u3042\u3048\u305a\u3001\u3084\u3063\u3066\u307f\u307e\u3057\u305f\u300d\u3068\u3044\u3046\u8a18\u9332\u3067\u3059\u3002\n\n- Fluent(d) \u3001\u547c\u3073\u65b9\u3059\u3089\u3088\u304f\u5206\u304b\u3063\u3066\u307e\u305b\u3093\n- Bugsnag\u3001\u6700\u8fd1\u30c8\u30e9\u30a4\u30a2\u30eb\u59cb\u3081\u305f\u7a0b\u5ea6\u306e\u77e5\u898b\u3067\u3059\n- gem\u3001\u8ab0\u304b\u306b\u4f7f\u3063\u3066\u3082\u3089\u3046\u4e8b\u3092\u8003\u3048\u305f\u30ea\u30ea\u30fc\u30b9\u306b\u306a\u3063\u3066\u307e\u305b\u3093\n- \u958b\u767a\u30fb\u5b9f\u884c\u74b0\u5883\n    - OSX 10.10.3\n    - Rails 4.2.1\n    - td-agent-2.1.4-0.dmg\n\n\n## TL;DR\n\n1. [koshigoe/logging-bugsnag](https://github.com/koshigoe/logging-bugsnag) \u3067 [TwP/logging](https://github.com/TwP/logging) \u3092\u62e1\u5f35\n    - error \u4ee5\u4e0a\u306e\u30ed\u30b0\u3092 [bugsnag/bugsnag-ruby](https://github.com/bugsnag/bugsnag-ruby) \u306e deliver \u306b\u6e21\u3059\n1. [koshigoe/bugsnag-delivery-fluent](https://github.com/koshigoe/bugsnag-delivery-fluent) \u3067 [bugsnag/bugsnag-ruby](https://github.com/bugsnag/bugsnag-ruby) \u3092\u62e1\u5f35\n    - deliver \u3092\u62e1\u5f35\u3057 Fluent \u306b URL \u3068\u30ea\u30af\u30a8\u30b9\u30c8\u30dc\u30c7\u30a3\u3092\u6e21\u3059\n1. [koshigoe/fluent-plugin-bugsnag](https://github.com/koshigoe/fluent-plugin-bugsnag) \u3067 Fluentd \u304b\u3089 Bugsnag \u306b\u9001\u4fe1\u3059\u308b\n\n\n## Fluent\n\n### fluent-plugin-bugsnag\n\nFluent \u304b\u3089 Bugsnag \u3078\u9001\u4fe1\u3059\u308b\u30d7\u30e9\u30b0\u30a4\u30f3 [koshigoe/fluent-plugin-bugsnag](https://github.com/koshigoe/fluent-plugin-bugsnag) \u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\u3002\n\n```\n$ sudo td-agent-gem install fluent-plugin-bugsnag\n```\n\n### td-agent.conf\n\n[koshigoe/bugsnag-delivery-fluent](https://github.com/koshigoe/bugsnag-delivery-fluent) \u306e\u5229\u7528\u3092\u60f3\u5b9a\u3057\u3066\u3044\u308b\u306e\u3067\u3001\u30bf\u30b0 `bugsnag.deliver` \u3092\u5bfe\u8c61\u306b bugsnag \u30d7\u30e9\u30b0\u30a4\u30f3\u3092\u9069\u7528\u3059\u308b\u8a2d\u5b9a\u3092\u8ffd\u52a0\u3002\n\n```\n<source>\n  type forward\n</source>\n\n<match bugsnag.deliver>\n  type bugsnag\n\n  # bugsnag_proxy_host localhost\n  # bugsnag_proxy_port 8888\n  # bugsnag_proxy_user user\n  # bugsnag_proxy_password password\n  # bugsnag_timeout 10\n</match>\n```\n\n\u8a2d\u5b9a\u304c\u7528\u610f\u3067\u304d\u305f\u3089 `td-agent` \u3092\u8d77\u52d5\u3002\n\n```\n$ td-agent -c td-agent.conf\n```\n\n\n## \u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\n\nRails \u30a2\u30d7\u30ea\u3092\u60f3\u5b9a\u3002\n\n### Gemfile\n\n```ruby\ngem 'logging-rails'\ngem 'logging-bugsnag'\ngem 'bugsnag-delivery-fluent'\n```\n\n```\n$ bundle install\n```\n\n### config/logging.rb\n\n[TwP/logging-rails](https://github.com/TwP/logging-rails) \u3092\u4f7f\u3046\u306e\u3067\u3001\u30b8\u30a7\u30cd\u30ec\u30fc\u30bf\u3067\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u6210\u3059\u308b\u3002\n\n```\n$ rails generate logging:install\n```\n\n\u4f5c\u6210\u3057\u305f `config/logging.rb` \u306b\u4ee5\u4e0b\u3092\u8ffd\u8a18\u3057\u3066 bugsnag appender \u3092\u4f7f\u3048\u308b\u69d8\u306b\u3057\u3066\u304a\u304f\u3002\n\n```ruby\nLogging.appenders.bugsnag('bugsnag', level: :error) if config.log_to.include? 'bugsnag'\n```\n\n### config.log_to\n\n`config/environments/production.rb` \u306a\u3069\u3067 `config.log_to` \u306b `'bugsnag'` \u3092\u8ffd\u52a0\u3059\u308c\u3070 `logger` \u306b\u7d44\u307f\u8fbc\u307e\u308c\u308b\u3002\n\n```\nconfig.log_to = %w[file bugsnag]\n```\n\n### config/initializers/bugsnag.rb\n\n\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u304b\u3089\u76f4\u63a5 Bugsnag \u306b\u9001\u4fe1\u305b\u305a Fluentd \u306b\u9001\u4fe1\u3092\u4efb\u305b\u308b\u305f\u3081\u306b\u3001 `delivery_method` \u3092 `:fluent` \u3068\u3059\u308b\u3002\n\n```ruby\nBugsnag.configure do |config|\n  config.api_key = ENV['BUGSNAG_API_KEY']\n  config.logger = ActiveSupport::Logger.new(Rails.root.join('log/bugsnag.log'), 10, 100.megabytes)\n  config.delivery_method = :fluent\n  # config.fluent_tag_prefix = 'bugsnag'\n  # config.fluent_host = 'localhost'\n  # config.fluent_port = 24224\nend\n```\n\n### \u5229\u7528\u958b\u59cb\n\n\u3053\u3053\u307e\u3067\u3067\u3001\u6355\u6349\u3057\u3066\u306a\u3044\u4f8b\u5916\u3068 error \u4ee5\u4e0a\u306e\u30ed\u30b0\u51fa\u529b\u304c Fluent \u306b\u9001\u3089\u308c\u3001Fluent \u3067\u9069\u5b9c Bugsnag \u306b\u9001\u4fe1\u3055\u308c\u308b\u69d8\u306b\u306a\u308b\u3002\n\n```\n$ rails c\n> Rails.logger.error('TEST TEST TEST')\n> Bugsnag.notify(RuntimeError.new('TETETETE TEST'))\n```\n", "tags": ["Rails4", "fluentd", "bugsnag"]}