{"context": " More than 1 year has passed since last update.\n\nDocker Swarm \u3092\u59cb\u3081\u307e\u3057\u3087\u3046\n\u539f\u6587\uff1ahttps://docs.docker.com/swarm/install-w-machine/\n\u3053\u306e\u30da\u30fc\u30b8\u306f\u3001\u30ed\u30fc\u30ab\u30eb\u30de\u30b7\u30f3\u4e0a\u306b Docker Machine \u3068 VirtualBox \u3092\u4f7f\u3044\u3001Docker Swarm \u3067swarm \u30af\u30e9\u30b9\u30bf\u3092\u4f5c\u6210\u3059\u308b\u65b9\u6cd5\u3092\u7d39\u4ecb\u3057\u307e\u3059\u3002\u4e00\u5ea6 swarm \u3092\u4f5c\u6210\u3057\u3066\u5229\u7528\u3067\u304d\u308c\u3070\u3001\u30af\u30e9\u30a6\u30c9\u30d7\u30ed\u30d0\u30a4\u30c0\u3084\u81ea\u5206\u306e\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u4e0a\u3067\u3001\u30c6\u30b9\u30c8\u7684\u306a\u30c7\u30d7\u30ed\u30a4\u3082\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u308b\u3067\u3057\u3087\u3046\u3002\n\u899a\u3048\u3066\u304a\u3044\u3066\u3044\u305f\u3060\u304d\u305f\u3044\u306e\u306f\u3001Docker Swarm \u306f\u73fe\u6642\u70b9\u3067\u306f\u30d9\u30fc\u30bf\u7248\u306e\u305f\u3081\u3001\u5185\u5bb9\u306f\u5909\u66f4\u3055\u308c\u308b\u5834\u5408\u304c\u3042\u308a\u307e\u3059\u3002\u672c\u756a\u74b0\u5883\u3067\u306e\u5229\u7528\u3082\u3001\u307e\u3060\u63a8\u5968\u3057\u307e\u305b\u3093\u3002\n\n\u5fc5\u8981\u6761\u4ef6\n\u30ed\u30fc\u30ab\u30eb\u306e\u30b7\u30b9\u30c6\u30e0\u4e0a\u306b VirtualBox \u304c\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u3066\u3044\u308b\u304b\u78ba\u8a8d\u3057\u307e\u3059\u3002Mac OS X \u3084 Windows \u3067 Docker \u3092\u4f7f\u3063\u3066\u3044\u308b\u5834\u5408\u306f\u3001\u65e2\u306b VirtualBox \u306f\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u6e08\u307f\u3067\u3059\u3002\n\nDocker Swarm \u306e\u4f5c\u6210\nDocker Machine \u306f\u30db\u30b9\u30c8\u4e0a\u3067 Docker \u30b3\u30f3\u30c6\u30ca\u3092\u5b9f\u884c\u53ef\u80fd\u306b\u3057\u307e\u3059\u3002Docker Swarm \u306e\u5404\u30ce\u30fc\u30c9\u306f\u3001\u30a4\u30e1\u30fc\u30b8\u306e\u53d6\u5f97\u3084\u30b3\u30f3\u30c6\u30ca\u5b9f\u884c\u306e\u305f\u3081\u306b Docker \u306b\u30a2\u30af\u30bb\u30b9\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002Docker Machine \u306f swarm \u30af\u30e9\u30b9\u30bf\u4e0a\u3078\u306e\u30d7\u30ed\u30d3\u30b8\u30e7\u30cb\u30f3\u30b0\u5168\u3066\u3092\u7ba1\u7406\u3057\u307e\u3059\u3002\ndocker-machine \u3067\u30af\u30e9\u30b9\u30bf\u3092\u4f5c\u6210\u3059\u308b\u524d\u306b\u3001\u30c7\u30a3\u30b9\u30ab\u30d0\u30ea\u30fb\u30c8\u30fc\u30af\u30f3(discovery token)\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002Docker Swarm \u306f\u30c7\u30a3\u30b9\u30ab\u30d0\u30ea\uff08\u30ce\u30fc\u30c9\u306e\u767a\u898b\uff09\u3084\u30a8\u30fc\u30b8\u30a7\u30f3\u30c8\u306e\u767b\u9332\u306e\u305f\u3081\u306b\u30c8\u30fc\u30af\u30f3\u3092\u4f7f\u3044\u307e\u3059\u3002\u3053\u306e\u30c8\u30fc\u30af\u30f3\u3092\u4f7f\u3046\u3053\u3068\u3067\u3001swarm \u30af\u30e9\u30b9\u30bf\u306e\u4f5c\u6210\u3092\u5b89\u5168\u306b\u884c\u3048\u307e\u3059\u3002\n\n\u30b7\u30b9\u30c6\u30e0\u4e0a\u306e\u30de\u30b7\u30f3\u4e00\u89a7\u3092\u8868\u793a\u3057\u307e\u3059\u3002\n\n$ docker-machine ls\nNAME   ACTIVE   DRIVER       STATE     URL                         SWARM\ndev    *        virtualbox   Running   tcp://192.168.99.100:2376   \n\n\u3053\u306e\u4f8b\u306f\u3001boot2docker \u304c\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u305f Mac OS X \u30b7\u30b9\u30c6\u30e0\u3067\u3059\u3002boot2docker \u30de\u30b7\u30f3\u4e0a\u306b\u4f5c\u3089\u308c\u305f dev \u3068\u3044\u3046\u74b0\u5883\u304c\u8868\u793a\u3055\u308c\u3066\u3044\u307e\u3059\u3002\n2.\u30b7\u30b9\u30c6\u30e0\u4e0a\u306b local \u3068\u3044\u3046\u540d\u524d\u306e VirtualBox \u30de\u30b7\u30f3\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n$ docker-machine create -d virtualbox local\nINFO[0000] Creating SSH key...                          \nINFO[0000] Creating VirtualBox VM...                    \nINFO[0005] Starting VirtualBox VM...                    \nINFO[0005] Waiting for VM to start...                   \nINFO[0050] \"local\" has been created and is now the active machine. \nINFO[0050] To point your Docker client at it, run this in your shell: eval \"$(docker-machine env local)\" \n\n3.local \u30de\u30b7\u30f3\u3078\u63a5\u7d9a\u3059\u308b\u74b0\u5883\u8a2d\u5b9a\u3092\u3001\u30b7\u30a7\u30eb\u4e0a\u306b\u8aad\u307f\u8fbc\u307f\u307e\u3059\u3002\n$ eval \"$(docker-machine env local)\"\n\n4.Docker Swarm \u30a4\u30e1\u30fc\u30b8\u3092\u4f7f\u3044\u30c7\u30a3\u30b9\u30ab\u30d0\u30ea\u30fb\u30c8\u30fc\u30af\u30f3\u3092\u751f\u6210\u3057\u307e\u3059\u3002\n\u4ee5\u4e0b\u306e swarm create \u30b3\u30de\u30f3\u30c9\u306f\u30b3\u30f3\u30c6\u30ca\u4e0a\u3067\u5b9f\u884c\u3055\u308c\u307e\u3059\u3002\u3082\u3057 swarm:latest \u30a4\u30e1\u30fc\u30b8\u304c\u30ed\u30fc\u30ab\u30eb\u30de\u30b7\u30f3\u306b\u4e0a\u306b\u306a\u3051\u308c\u3070\u3001Docker \u306f\uff08\u81ea\u52d5\u7684\u306b\uff09\u53d6\u5f97\u3057\u307e\u3059\u3002\n$ docker run swarm create\nUnable to find image 'swarm:latest' locally\nlatest: Pulling from swarm\nde939d6ed512: Pull complete \n79195899a8a4: Pull complete \n79ad4f2cc8e0: Pull complete \n0db1696be81b: Pull complete \nae3b6728155e: Pull complete \n57ec2f5f3e06: Pull complete \n73504b2882a3: Already exists \nswarm:latest: The image you are pulling has been verified. Important: image verification is a tech preview feature and should not be relied on to provide security.\nDigest: sha256:aaaf6c18b8be01a75099cc554b4fb372b8ec677ae81764dcdf85470279a61d6f\nStatus: Downloaded newer image for swarm:latest\nfe0cc96a72cf04dba8c1c4aa79536ec3\n\n\u3053\u306e swarm crate \u30b3\u30de\u30f3\u30c9\u306f\u3001\u30c8\u30fc\u30af\u30f3 fe0cc96a72cf04dba8c1c4aa79536ec3 \u3092\u8fd4\u3057\u307e\u3057\u305f\u3002\n5.\u5b89\u5168\u306a\u5834\u6240\u306b\u30c8\u30fc\u30af\u30f3\u3092\u4fdd\u7ba1\u3057\u307e\u3059\u3002\n\u4f5c\u6210\u3057\u305f\u30c8\u30fc\u30af\u30f3\u3092\u4f7f\u3063\u3066\u3001Docker Swarm \u306e\u4f5c\u6210\u3068\u3044\u3046\u6b21\u306e\u624b\u9806\u306b\u9032\u307f\u307e\u3059\u3002\n\nSwarm manager \u306e\u8d77\u52d5\n\u81ea\u5206\u306e\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u4e0a\u306b\u3042\u308b\u5358\u4e00\u306e\u30b7\u30b9\u30c6\u30e0\u3092\u3001Docker Swarm manager \u3068\u547c\u3070\u308c\u3066\u3044\u307e\u3059\u3002Swarm Manager \u306f\u30af\u30e9\u30b9\u30bf\u5168\u4f53\u306b\u304a\u3051\u308b\u30aa\u30fc\u30b1\u30b9\u30c8\u30ec\u30fc\u30b7\u30e7\u30f3\u3084\u30b3\u30f3\u30c6\u30ca\u306e\u30b9\u30b1\u30b8\u30e5\u30fc\u30eb\u3092\u884c\u3044\u307e\u3059\u3002Swam Manager \u306f\u30a8\u30fc\u30b8\u30a7\u30f3\u30c8\u7fa4\uff08\u30ce\u30fc\u30c9\u3084 Docker \u30ce\u30fc\u30c9\u3068\u3082\u547c\u3070\u308c\u307e\u3059\uff09\u3092\u7d71\u7387\u3057\u307e\u3059\u3002\nSwam agent \u306f\u30b3\u30f3\u30c6\u30ca\u306e\u30db\u30b9\u30c6\u30a3\u30f3\u30b0\u3092\u62c5\u3044\u307e\u3059\u3002\u3053\u308c\u3089\u306f\u901a\u5e38\u306e Docker \u30c7\u30fc\u30e2\u30f3\u3067\u3042\u308a\u3001Docker \u30ea\u30e2\u30fc\u30c8 API \u3092\u4f7f\u3063\u3066\u901a\u4fe1\u3067\u304d\u307e\u3059\u3002\n\u3053\u306e\u7ae0\u3067\u306f\u3001Swam Manager \u3068\uff12\u3064\u306e\u30ce\u30fc\u30c9\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\nVirtualBox \u306b Swarm Manager \u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\ndocker-machine create \\\n        -d virtualbox \\\n        --swarm \\\n        --swarm-master \\\n        --swarm-discovery token://<TOKEN-FROM-ABOVE> \\\n        swarm-master\n\n\u5b9f\u884c\u4f8b\uff1a\n$ docker-machine create -d virtualbox --swarm --swarm-master --swarm-discovery token://fe0cc96a72cf04dba8c1c4aa79536ec3 swarm-master\nINFO[0000] Creating SSH key...                          \nINFO[0000] Creating VirtualBox VM...                    \nINFO[0005] Starting VirtualBox VM...                    \nINFO[0005] Waiting for VM to start...                   \nINFO[0060] \"swarm-master\" has been created and is now the active machine. \nINFO[0060] To point your Docker client at it, run this in your shell: eval \"$(docker-machine env swarm-master)\" \n\n2.VirtualBox \u30de\u30cd\u30fc\u30b8\u30e3\u30fc\uff08PC\u4e0a\u306e\uff09\u3092\u958b\u304f\u3068\u3001local \u30de\u30b7\u30f3\u3068\u3001\u65b0\u3057\u3044 swarm-master \u30de\u30b7\u30f3\u304c\u3042\u308a\u307e\u3059\u3002\n3.Swarm \u30ce\u30fc\u30c9\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n    docker-machine create \\\n    -d virtualbox \\\n    --swarm \\\n    --swarm-discovery token://<TOKEN-FROM-ABOVE> \\\n    swarm-agent-00\n\n\u5b9f\u884c\u4f8b\uff1a\n$ docker-machine create -d virtualbox --swarm --swarm-discovery token://fe0cc96a72cf04dba8c1c4aa79536ec3 swarm-agent-00\nINFO[0000] Creating SSH key...                          \nINFO[0000] Creating VirtualBox VM...                    \nINFO[0005] Starting VirtualBox VM...                    \nINFO[0006] Waiting for VM to start...                   \nINFO[0066] \"swarm-agent-00\" has been created and is now the active machine. \nINFO[0066] To point your Docker client at it, run this in your shell: eval \"$(docker-machine env swarm-agent-00)\" \n\n4.swam-agent-01 \u3068\u3044\u3046\u540d\u524d\u306e\u5225\u306e\u30a8\u30fc\u30b8\u30a7\u30f3\u30c8\u3092\u8ffd\u52a0\u3057\u307e\u3059\u3002\n$ docker-machine create -d virtualbox --swarm --swarm-discovery token://fe0cc96a72cf04dba8c1c4aa79536ec3 swarm-agent-01\n\nVirtualBox \u30de\u30cd\u30fc\u30b8\u30e3\u30fc\u306b\u3001\uff12\u3064\u306e\u30a8\u30fc\u30b8\u30a7\u30f3\u30c8\u304c\u8868\u793a\u3055\u308c\u307e\u3059\u3002\n\nSwam \u306b\u76f4\u63a5\u3064\u306a\u3050\n\u3053\u306e\u30b9\u30c6\u30c3\u30d7\u3067\u306f\u3001Swarm \u30de\u30b7\u30f3\u306b\u63a5\u7d9a\u3057\u3001Swarm \u30af\u30e9\u30b9\u30bf\u306b\u95a2\u9023\u3059\u308b\u60c5\u5831\u3092\u8868\u793a\u3057\u3001Swam \u30af\u30e9\u30b9\u30bf\u4e0a\u3067\u30a4\u30e1\u30fc\u30b8\u3092\u8d77\u52d5\u3057\u307e\u3059\u3002\n\nSwarm \u30de\u30b9\u30bf\u304c\u5b9f\u884c\u3057\u3066\u3044\u308b\u30de\u30b7\u30f3\u306e Docker \u74b0\u5883\u5909\u6570\u3092\u6307\u5b9a\u3057\u307e\u3059\u3002\n\n$ eval $(docker-machine env --swarm swarm-master)\n\n2.docker \u30b3\u30de\u30f3\u30c9\u3092\u4f7f\u3044\u3001\u65b0\u305f\u306b\u4f5c\u3063\u305f Swarm \u30af\u30e9\u30b9\u30bf\u306e\u60c5\u5831\u3092\u53d6\u5f97\u3057\u307e\u3059\u3002\n$ docker info\nContainers: 4\nStrategy: spread\nFilters: affinity, health, constraint, port, dependency\nNodes: 3\n swarm-agent-00: 192.168.99.105:2376\n    \u2514 Containers: 1\n    \u2514 Reserved CPUs: 0 / 8\n    \u2514 Reserved Memory: 0 B / 1.023 GiB\n swarm-agent-01: 192.168.99.106:2376\n    \u2514 Containers: 1\n    \u2514 Reserved CPUs: 0 / 8\n    \u2514 Reserved Memory: 0 B / 1.023 GiB\n swarm-master: 192.168.99.104:2376\n    \u2514 Containers: 2\n    \u2514 Reserved CPUs: 0 / 8\n\n\u5404\u30a8\u30fc\u30b8\u30a7\u30f3\u30c8\u3068\u30de\u30b9\u30bf\u5168\u3066\u304c\u3001\u30dd\u30fc\u30c8 2376 \u3092\u516c\u958b\u3057\u3066\u3044\u308b\u3053\u3068\u304c\u5206\u304b\u308a\u307e\u3059\u3002Swam \u30af\u30e9\u30b9\u30bf\u3092\u4f5c\u6210\u3059\u308b\u3068\u304d\u306f\u3001\u4efb\u610f\u306e\u30dd\u30fc\u30c8\u3092\u4f7f\u3048\u307e\u3059\u3057\u3001\u30ce\u30fc\u30c9\u6bce\u306b\u7570\u306a\u3063\u305f\u30dd\u30fc\u30c8\u3082\u4f7f\u3048\u307e\u3059\u3002\u5404 Swam \u30ce\u30fc\u30c9\u306f Swam \u30a8\u30fc\u30b8\u30a7\u30f3\u30c8\u306e\u30b3\u30f3\u30c6\u30ca\u3092\u5b9f\u884c\u3057\u3066\u3044\u307e\u3059\u3002\n\u30de\u30b9\u30bf\u306f Swarm Manager \u3068 Swam \u30a8\u30fc\u30b8\u30a7\u30f3\u30c8\u30fb\u30b3\u30f3\u30c6\u30ca\u306e\u4e21\u65b9\u3067\u52d5\u4f5c\u3057\u3066\u3044\u307e\u3059\u3002\u3053\u306e\u72b6\u614b\u306f\u30a8\u30fc\u30b8\u30a7\u30f3\u30c8\u306e\u30d5\u30a7\u30a4\u30eb\u30aa\u30fc\u30d0\u30fc\u306b\u95a2\u3059\u308b\u554f\u984c\u304c\u3042\u308b\u305f\u3081\u3001\u672c\u756a\u74b0\u5883\u3067\u306e\u5229\u7528\u306f\u63a8\u5968\u3057\u307e\u305b\u3093\u3002\u3057\u304b\u3057\u3001\u4eca\u56de\u306e\u3088\u3046\u306b\u52d5\u4f5c\u74b0\u5883\u3092\u5b66\u3076\u305f\u3081\u306b\u306f\u975e\u5e38\u306b\u5f79\u7acb\u3061\u307e\u3059\u3002\n\nSwam \u30af\u30e9\u30b9\u30bf\u4e0a\u3067\u5b9f\u884c\u4e2d\u306e\u30a4\u30e1\u30fc\u30b8\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\n\n$ docker ps  -a\nCONTAINER ID        IMAGE               COMMAND                CREATED             STATUS              PORTS                                     NAMES\n78be991b58d1        swarm:latest        \"/swarm join --addr    3 minutes ago       Up 2 minutes        2375/tcp                                  swarm-agent-01/swarm-agent        \nda5127e4f0f9        swarm:latest        \"/swarm join --addr    6 minutes ago       Up 6 minutes        2375/tcp                                  swarm-agent-00/swarm-agent        \nef395f316c59        swarm:latest        \"/swarm join --addr    16 minutes ago      Up 16 minutes       2375/tcp                                  swarm-master/swarm-agent          \n45821ca5208e        swarm:latest        \"/swarm manage --tls   16 minutes ago      Up 16 minutes       2375/tcp, 192.168.99.104:3376->3376/tcp   swarm-master/swarm-agent-master \n\n2.Swam \u30af\u30e9\u30b9\u30bf\u4e0a\u3067 Docker \u306e hello-world \u30c6\u30b9\u30c8\u30a4\u30e1\u30fc\u30b8\u3092\u5b9f\u884c\u3057\u307e\u3059\u3002\n$ docker run hello-world\nHello from Docker.\nThis message shows that your installation appears to be working correctly.\n\n\nTo generate this message, Docker took the following steps:\n 1. The Docker client contacted the Docker daemon.\n 2. The Docker daemon pulled the \"hello-world\" image from the Docker Hub.\n        (Assuming it was not already locally available.)\n 3. The Docker daemon created a new container from that image which runs the\n        executable that produces the output you are currently reading.\n 4. The Docker daemon streamed that output to the Docker client, which sent it\n        to your terminal.\n\n\nTo try something more ambitious, you can run an Ubuntu container with:\n $ docker run -it ubuntu bash\n\n\nFor more examples and ideas, visit:\n http://docs.docker.com/userguide/\n\n3.docker ps \u30b3\u30de\u30f3\u30c9\u3092\u4f7f\u3063\u3066\u3001\u3069\u306e\u30ce\u30fc\u30c9\u3067\u4f55\u306e\u30b3\u30f3\u30c6\u30ca\u304c\u52d5\u3044\u3066\u3044\u308b\u304b\u78ba\u8a8d\u3057\u307e\u3059\u3002\n$ docker ps -a\nCONTAINER ID        IMAGE                COMMAND                CREATED             STATUS                     PORTS                                     NAMES\n54a8690043dd        hello-world:latest   \"/hello\"               22 seconds ago      Exited (0) 3 seconds ago                                             swarm-agent-00/modest_goodall     \n78be991b58d1        swarm:latest         \"/swarm join --addr    5 minutes ago       Up 4 minutes               2375/tcp                                  swarm-agent-01/swarm-agent        \nda5127e4f0f9        swarm:latest         \"/swarm join --addr    8 minutes ago       Up 8 minutes               2375/tcp                                  swarm-agent-00/swarm-agent        \nef395f316c59        swarm:latest         \"/swarm join --addr    18 minutes ago      Up 18 minutes              2375/tcp                                  swarm-master/swarm-agent          \n45821ca5208e        swarm:latest         \"/swarm manage --tls   18 minutes ago      Up 18 minutes              2375/tcp, 192.168.99.104:3376->3376/tcp   swarm-master/swarm-agent-master \n\n# Docker Swarm \u3092\u59cb\u3081\u307e\u3057\u3087\u3046\n\u539f\u6587\uff1ahttps://docs.docker.com/swarm/install-w-machine/\n\n\u3053\u306e\u30da\u30fc\u30b8\u306f\u3001\u30ed\u30fc\u30ab\u30eb\u30de\u30b7\u30f3\u4e0a\u306b Docker Machine \u3068 VirtualBox \u3092\u4f7f\u3044\u3001Docker Swarm \u3067swarm \u30af\u30e9\u30b9\u30bf\u3092\u4f5c\u6210\u3059\u308b\u65b9\u6cd5\u3092\u7d39\u4ecb\u3057\u307e\u3059\u3002\u4e00\u5ea6 swarm \u3092\u4f5c\u6210\u3057\u3066\u5229\u7528\u3067\u304d\u308c\u3070\u3001\u30af\u30e9\u30a6\u30c9\u30d7\u30ed\u30d0\u30a4\u30c0\u3084\u81ea\u5206\u306e\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u4e0a\u3067\u3001\u30c6\u30b9\u30c8\u7684\u306a\u30c7\u30d7\u30ed\u30a4\u3082\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u308b\u3067\u3057\u3087\u3046\u3002\n\n\u899a\u3048\u3066\u304a\u3044\u3066\u3044\u305f\u3060\u304d\u305f\u3044\u306e\u306f\u3001Docker Swarm \u306f\u73fe\u6642\u70b9\u3067\u306f\u30d9\u30fc\u30bf\u7248\u306e\u305f\u3081\u3001\u5185\u5bb9\u306f\u5909\u66f4\u3055\u308c\u308b\u5834\u5408\u304c\u3042\u308a\u307e\u3059\u3002\u672c\u756a\u74b0\u5883\u3067\u306e\u5229\u7528\u3082\u3001\u307e\u3060\u63a8\u5968\u3057\u307e\u305b\u3093\u3002\n\n## \u5fc5\u8981\u6761\u4ef6\n\n\u30ed\u30fc\u30ab\u30eb\u306e\u30b7\u30b9\u30c6\u30e0\u4e0a\u306b VirtualBox \u304c\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u3066\u3044\u308b\u304b\u78ba\u8a8d\u3057\u307e\u3059\u3002Mac OS X \u3084 Windows \u3067 Docker \u3092\u4f7f\u3063\u3066\u3044\u308b\u5834\u5408\u306f\u3001\u65e2\u306b VirtualBox \u306f\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u6e08\u307f\u3067\u3059\u3002\n\n## Docker Swarm \u306e\u4f5c\u6210\n\nDocker Machine \u306f\u30db\u30b9\u30c8\u4e0a\u3067 Docker \u30b3\u30f3\u30c6\u30ca\u3092\u5b9f\u884c\u53ef\u80fd\u306b\u3057\u307e\u3059\u3002Docker Swarm \u306e\u5404\u30ce\u30fc\u30c9\u306f\u3001\u30a4\u30e1\u30fc\u30b8\u306e\u53d6\u5f97\u3084\u30b3\u30f3\u30c6\u30ca\u5b9f\u884c\u306e\u305f\u3081\u306b Docker \u306b\u30a2\u30af\u30bb\u30b9\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002Docker Machine \u306f swarm \u30af\u30e9\u30b9\u30bf\u4e0a\u3078\u306e\u30d7\u30ed\u30d3\u30b8\u30e7\u30cb\u30f3\u30b0\u5168\u3066\u3092\u7ba1\u7406\u3057\u307e\u3059\u3002\n\n`docker-machine` \u3067\u30af\u30e9\u30b9\u30bf\u3092\u4f5c\u6210\u3059\u308b\u524d\u306b\u3001\u30c7\u30a3\u30b9\u30ab\u30d0\u30ea\u30fb\u30c8\u30fc\u30af\u30f3(discovery token)\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002Docker Swarm \u306f\u30c7\u30a3\u30b9\u30ab\u30d0\u30ea\uff08\u30ce\u30fc\u30c9\u306e\u767a\u898b\uff09\u3084\u30a8\u30fc\u30b8\u30a7\u30f3\u30c8\u306e\u767b\u9332\u306e\u305f\u3081\u306b\u30c8\u30fc\u30af\u30f3\u3092\u4f7f\u3044\u307e\u3059\u3002\u3053\u306e\u30c8\u30fc\u30af\u30f3\u3092\u4f7f\u3046\u3053\u3068\u3067\u3001swarm \u30af\u30e9\u30b9\u30bf\u306e\u4f5c\u6210\u3092\u5b89\u5168\u306b\u884c\u3048\u307e\u3059\u3002\n\n1. \u30b7\u30b9\u30c6\u30e0\u4e0a\u306e\u30de\u30b7\u30f3\u4e00\u89a7\u3092\u8868\u793a\u3057\u307e\u3059\u3002\n\n```\n$ docker-machine ls\nNAME   ACTIVE   DRIVER       STATE     URL                         SWARM\ndev    *        virtualbox   Running   tcp://192.168.99.100:2376   \n```\n\n\u3053\u306e\u4f8b\u306f\u3001`boot2docker` \u304c\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u305f Mac OS X \u30b7\u30b9\u30c6\u30e0\u3067\u3059\u3002`boot2docker` \u30de\u30b7\u30f3\u4e0a\u306b\u4f5c\u3089\u308c\u305f `dev` \u3068\u3044\u3046\u74b0\u5883\u304c\u8868\u793a\u3055\u308c\u3066\u3044\u307e\u3059\u3002\n\n2.\u30b7\u30b9\u30c6\u30e0\u4e0a\u306b `local` \u3068\u3044\u3046\u540d\u524d\u306e VirtualBox \u30de\u30b7\u30f3\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\n```\n$ docker-machine create -d virtualbox local\nINFO[0000] Creating SSH key...                          \nINFO[0000] Creating VirtualBox VM...                    \nINFO[0005] Starting VirtualBox VM...                    \nINFO[0005] Waiting for VM to start...                   \nINFO[0050] \"local\" has been created and is now the active machine. \nINFO[0050] To point your Docker client at it, run this in your shell: eval \"$(docker-machine env local)\" \n```\n\n3.`local` \u30de\u30b7\u30f3\u3078\u63a5\u7d9a\u3059\u308b\u74b0\u5883\u8a2d\u5b9a\u3092\u3001\u30b7\u30a7\u30eb\u4e0a\u306b\u8aad\u307f\u8fbc\u307f\u307e\u3059\u3002\n\n```\n$ eval \"$(docker-machine env local)\"\n```\n\n4.Docker Swarm \u30a4\u30e1\u30fc\u30b8\u3092\u4f7f\u3044\u30c7\u30a3\u30b9\u30ab\u30d0\u30ea\u30fb\u30c8\u30fc\u30af\u30f3\u3092\u751f\u6210\u3057\u307e\u3059\u3002\n\n\u4ee5\u4e0b\u306e `swarm create` \u30b3\u30de\u30f3\u30c9\u306f\u30b3\u30f3\u30c6\u30ca\u4e0a\u3067\u5b9f\u884c\u3055\u308c\u307e\u3059\u3002\u3082\u3057 `swarm:latest` \u30a4\u30e1\u30fc\u30b8\u304c\u30ed\u30fc\u30ab\u30eb\u30de\u30b7\u30f3\u306b\u4e0a\u306b\u306a\u3051\u308c\u3070\u3001Docker \u306f\uff08\u81ea\u52d5\u7684\u306b\uff09\u53d6\u5f97\u3057\u307e\u3059\u3002\n\n```\n$ docker run swarm create\nUnable to find image 'swarm:latest' locally\nlatest: Pulling from swarm\nde939d6ed512: Pull complete \n79195899a8a4: Pull complete \n79ad4f2cc8e0: Pull complete \n0db1696be81b: Pull complete \nae3b6728155e: Pull complete \n57ec2f5f3e06: Pull complete \n73504b2882a3: Already exists \nswarm:latest: The image you are pulling has been verified. Important: image verification is a tech preview feature and should not be relied on to provide security.\nDigest: sha256:aaaf6c18b8be01a75099cc554b4fb372b8ec677ae81764dcdf85470279a61d6f\nStatus: Downloaded newer image for swarm:latest\nfe0cc96a72cf04dba8c1c4aa79536ec3\n```\n\n\u3053\u306e `swarm crate` \u30b3\u30de\u30f3\u30c9\u306f\u3001\u30c8\u30fc\u30af\u30f3 `fe0cc96a72cf04dba8c1c4aa79536ec3` \u3092\u8fd4\u3057\u307e\u3057\u305f\u3002\n\n5.\u5b89\u5168\u306a\u5834\u6240\u306b\u30c8\u30fc\u30af\u30f3\u3092\u4fdd\u7ba1\u3057\u307e\u3059\u3002\n\n\u4f5c\u6210\u3057\u305f\u30c8\u30fc\u30af\u30f3\u3092\u4f7f\u3063\u3066\u3001Docker Swarm \u306e\u4f5c\u6210\u3068\u3044\u3046\u6b21\u306e\u624b\u9806\u306b\u9032\u307f\u307e\u3059\u3002\n\n## Swarm manager \u306e\u8d77\u52d5\n\n\u81ea\u5206\u306e\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u4e0a\u306b\u3042\u308b\u5358\u4e00\u306e\u30b7\u30b9\u30c6\u30e0\u3092\u3001Docker Swarm manager \u3068\u547c\u3070\u308c\u3066\u3044\u307e\u3059\u3002Swarm Manager \u306f\u30af\u30e9\u30b9\u30bf\u5168\u4f53\u306b\u304a\u3051\u308b\u30aa\u30fc\u30b1\u30b9\u30c8\u30ec\u30fc\u30b7\u30e7\u30f3\u3084\u30b3\u30f3\u30c6\u30ca\u306e\u30b9\u30b1\u30b8\u30e5\u30fc\u30eb\u3092\u884c\u3044\u307e\u3059\u3002Swam Manager \u306f\u30a8\u30fc\u30b8\u30a7\u30f3\u30c8\u7fa4\uff08\u30ce\u30fc\u30c9\u3084 Docker \u30ce\u30fc\u30c9\u3068\u3082\u547c\u3070\u308c\u307e\u3059\uff09\u3092\u7d71\u7387\u3057\u307e\u3059\u3002\n\nSwam agent \u306f\u30b3\u30f3\u30c6\u30ca\u306e\u30db\u30b9\u30c6\u30a3\u30f3\u30b0\u3092\u62c5\u3044\u307e\u3059\u3002\u3053\u308c\u3089\u306f\u901a\u5e38\u306e Docker \u30c7\u30fc\u30e2\u30f3\u3067\u3042\u308a\u3001Docker \u30ea\u30e2\u30fc\u30c8 API \u3092\u4f7f\u3063\u3066\u901a\u4fe1\u3067\u304d\u307e\u3059\u3002\n\n\u3053\u306e\u7ae0\u3067\u306f\u3001Swam Manager \u3068\uff12\u3064\u306e\u30ce\u30fc\u30c9\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\n1. VirtualBox \u306b Swarm Manager \u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\n```\ndocker-machine create \\\n        -d virtualbox \\\n        --swarm \\\n        --swarm-master \\\n        --swarm-discovery token://<TOKEN-FROM-ABOVE> \\\n        swarm-master\n```\n\n\u5b9f\u884c\u4f8b\uff1a\n\n```\n$ docker-machine create -d virtualbox --swarm --swarm-master --swarm-discovery token://fe0cc96a72cf04dba8c1c4aa79536ec3 swarm-master\nINFO[0000] Creating SSH key...                          \nINFO[0000] Creating VirtualBox VM...                    \nINFO[0005] Starting VirtualBox VM...                    \nINFO[0005] Waiting for VM to start...                   \nINFO[0060] \"swarm-master\" has been created and is now the active machine. \nINFO[0060] To point your Docker client at it, run this in your shell: eval \"$(docker-machine env swarm-master)\" \n```\n\n2.VirtualBox \u30de\u30cd\u30fc\u30b8\u30e3\u30fc\uff08PC\u4e0a\u306e\uff09\u3092\u958b\u304f\u3068\u3001`local` \u30de\u30b7\u30f3\u3068\u3001\u65b0\u3057\u3044 `swarm-master` \u30de\u30b7\u30f3\u304c\u3042\u308a\u307e\u3059\u3002\n\n3.Swarm \u30ce\u30fc\u30c9\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\n```\n    docker-machine create \\\n    -d virtualbox \\\n    --swarm \\\n    --swarm-discovery token://<TOKEN-FROM-ABOVE> \\\n    swarm-agent-00\n```\n\n\u5b9f\u884c\u4f8b\uff1a\n\n```\n$ docker-machine create -d virtualbox --swarm --swarm-discovery token://fe0cc96a72cf04dba8c1c4aa79536ec3 swarm-agent-00\nINFO[0000] Creating SSH key...                          \nINFO[0000] Creating VirtualBox VM...                    \nINFO[0005] Starting VirtualBox VM...                    \nINFO[0006] Waiting for VM to start...                   \nINFO[0066] \"swarm-agent-00\" has been created and is now the active machine. \nINFO[0066] To point your Docker client at it, run this in your shell: eval \"$(docker-machine env swarm-agent-00)\" \n```\n\n4.`swam-agent-01` \u3068\u3044\u3046\u540d\u524d\u306e\u5225\u306e\u30a8\u30fc\u30b8\u30a7\u30f3\u30c8\u3092\u8ffd\u52a0\u3057\u307e\u3059\u3002\n\n```\n$ docker-machine create -d virtualbox --swarm --swarm-discovery token://fe0cc96a72cf04dba8c1c4aa79536ec3 swarm-agent-01\n```\n\nVirtualBox \u30de\u30cd\u30fc\u30b8\u30e3\u30fc\u306b\u3001\uff12\u3064\u306e\u30a8\u30fc\u30b8\u30a7\u30f3\u30c8\u304c\u8868\u793a\u3055\u308c\u307e\u3059\u3002\n\n## Swam \u306b\u76f4\u63a5\u3064\u306a\u3050\n\n\u3053\u306e\u30b9\u30c6\u30c3\u30d7\u3067\u306f\u3001Swarm \u30de\u30b7\u30f3\u306b\u63a5\u7d9a\u3057\u3001Swarm \u30af\u30e9\u30b9\u30bf\u306b\u95a2\u9023\u3059\u308b\u60c5\u5831\u3092\u8868\u793a\u3057\u3001Swam \u30af\u30e9\u30b9\u30bf\u4e0a\u3067\u30a4\u30e1\u30fc\u30b8\u3092\u8d77\u52d5\u3057\u307e\u3059\u3002\n\n1. Swarm \u30de\u30b9\u30bf\u304c\u5b9f\u884c\u3057\u3066\u3044\u308b\u30de\u30b7\u30f3\u306e Docker \u74b0\u5883\u5909\u6570\u3092\u6307\u5b9a\u3057\u307e\u3059\u3002\n\n```\n$ eval $(docker-machine env --swarm swarm-master)\n```\n\n2.`docker` \u30b3\u30de\u30f3\u30c9\u3092\u4f7f\u3044\u3001\u65b0\u305f\u306b\u4f5c\u3063\u305f Swarm \u30af\u30e9\u30b9\u30bf\u306e\u60c5\u5831\u3092\u53d6\u5f97\u3057\u307e\u3059\u3002\n\n```\n$ docker info\nContainers: 4\nStrategy: spread\nFilters: affinity, health, constraint, port, dependency\nNodes: 3\n swarm-agent-00: 192.168.99.105:2376\n    \u2514 Containers: 1\n    \u2514 Reserved CPUs: 0 / 8\n    \u2514 Reserved Memory: 0 B / 1.023 GiB\n swarm-agent-01: 192.168.99.106:2376\n    \u2514 Containers: 1\n    \u2514 Reserved CPUs: 0 / 8\n    \u2514 Reserved Memory: 0 B / 1.023 GiB\n swarm-master: 192.168.99.104:2376\n    \u2514 Containers: 2\n    \u2514 Reserved CPUs: 0 / 8\n```\n\n\u5404\u30a8\u30fc\u30b8\u30a7\u30f3\u30c8\u3068\u30de\u30b9\u30bf\u5168\u3066\u304c\u3001\u30dd\u30fc\u30c8 `2376` \u3092\u516c\u958b\u3057\u3066\u3044\u308b\u3053\u3068\u304c\u5206\u304b\u308a\u307e\u3059\u3002Swam \u30af\u30e9\u30b9\u30bf\u3092\u4f5c\u6210\u3059\u308b\u3068\u304d\u306f\u3001\u4efb\u610f\u306e\u30dd\u30fc\u30c8\u3092\u4f7f\u3048\u307e\u3059\u3057\u3001\u30ce\u30fc\u30c9\u6bce\u306b\u7570\u306a\u3063\u305f\u30dd\u30fc\u30c8\u3082\u4f7f\u3048\u307e\u3059\u3002\u5404 Swam \u30ce\u30fc\u30c9\u306f Swam \u30a8\u30fc\u30b8\u30a7\u30f3\u30c8\u306e\u30b3\u30f3\u30c6\u30ca\u3092\u5b9f\u884c\u3057\u3066\u3044\u307e\u3059\u3002\n\n\u30de\u30b9\u30bf\u306f Swarm Manager \u3068 Swam \u30a8\u30fc\u30b8\u30a7\u30f3\u30c8\u30fb\u30b3\u30f3\u30c6\u30ca\u306e\u4e21\u65b9\u3067\u52d5\u4f5c\u3057\u3066\u3044\u307e\u3059\u3002\u3053\u306e\u72b6\u614b\u306f\u30a8\u30fc\u30b8\u30a7\u30f3\u30c8\u306e\u30d5\u30a7\u30a4\u30eb\u30aa\u30fc\u30d0\u30fc\u306b\u95a2\u3059\u308b\u554f\u984c\u304c\u3042\u308b\u305f\u3081\u3001\u672c\u756a\u74b0\u5883\u3067\u306e\u5229\u7528\u306f\u63a8\u5968\u3057\u307e\u305b\u3093\u3002\u3057\u304b\u3057\u3001\u4eca\u56de\u306e\u3088\u3046\u306b\u52d5\u4f5c\u74b0\u5883\u3092\u5b66\u3076\u305f\u3081\u306b\u306f\u975e\u5e38\u306b\u5f79\u7acb\u3061\u307e\u3059\u3002\n\n1. Swam \u30af\u30e9\u30b9\u30bf\u4e0a\u3067\u5b9f\u884c\u4e2d\u306e\u30a4\u30e1\u30fc\u30b8\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\n\n```\n$ docker ps  -a\nCONTAINER ID        IMAGE               COMMAND                CREATED             STATUS              PORTS                                     NAMES\n78be991b58d1        swarm:latest        \"/swarm join --addr    3 minutes ago       Up 2 minutes        2375/tcp                                  swarm-agent-01/swarm-agent        \nda5127e4f0f9        swarm:latest        \"/swarm join --addr    6 minutes ago       Up 6 minutes        2375/tcp                                  swarm-agent-00/swarm-agent        \nef395f316c59        swarm:latest        \"/swarm join --addr    16 minutes ago      Up 16 minutes       2375/tcp                                  swarm-master/swarm-agent          \n45821ca5208e        swarm:latest        \"/swarm manage --tls   16 minutes ago      Up 16 minutes       2375/tcp, 192.168.99.104:3376->3376/tcp   swarm-master/swarm-agent-master \n```\n\n2.Swam \u30af\u30e9\u30b9\u30bf\u4e0a\u3067 Docker \u306e `hello-world` \u30c6\u30b9\u30c8\u30a4\u30e1\u30fc\u30b8\u3092\u5b9f\u884c\u3057\u307e\u3059\u3002\n\n```\n$ docker run hello-world\nHello from Docker.\nThis message shows that your installation appears to be working correctly.\n\n\nTo generate this message, Docker took the following steps:\n 1. The Docker client contacted the Docker daemon.\n 2. The Docker daemon pulled the \"hello-world\" image from the Docker Hub.\n        (Assuming it was not already locally available.)\n 3. The Docker daemon created a new container from that image which runs the\n        executable that produces the output you are currently reading.\n 4. The Docker daemon streamed that output to the Docker client, which sent it\n        to your terminal.\n\n\nTo try something more ambitious, you can run an Ubuntu container with:\n $ docker run -it ubuntu bash\n\n\nFor more examples and ideas, visit:\n http://docs.docker.com/userguide/\n```\n\n3.`docker ps` \u30b3\u30de\u30f3\u30c9\u3092\u4f7f\u3063\u3066\u3001\u3069\u306e\u30ce\u30fc\u30c9\u3067\u4f55\u306e\u30b3\u30f3\u30c6\u30ca\u304c\u52d5\u3044\u3066\u3044\u308b\u304b\u78ba\u8a8d\u3057\u307e\u3059\u3002\n\n```\n$ docker ps -a\nCONTAINER ID        IMAGE                COMMAND                CREATED             STATUS                     PORTS                                     NAMES\n54a8690043dd        hello-world:latest   \"/hello\"               22 seconds ago      Exited (0) 3 seconds ago                                             swarm-agent-00/modest_goodall     \n78be991b58d1        swarm:latest         \"/swarm join --addr    5 minutes ago       Up 4 minutes               2375/tcp                                  swarm-agent-01/swarm-agent        \nda5127e4f0f9        swarm:latest         \"/swarm join --addr    8 minutes ago       Up 8 minutes               2375/tcp                                  swarm-agent-00/swarm-agent        \nef395f316c59        swarm:latest         \"/swarm join --addr    18 minutes ago      Up 18 minutes              2375/tcp                                  swarm-master/swarm-agent          \n45821ca5208e        swarm:latest         \"/swarm manage --tls   18 minutes ago      Up 18 minutes              2375/tcp, 192.168.99.104:3376->3376/tcp   swarm-master/swarm-agent-master \n```\n\n", "tags": ["DockerSwarm0.3.0", "docker"]}