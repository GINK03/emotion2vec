{"context": "\u3055\u304f\u3089VPS\u306e\u304a\u8a66\u3057\u671f\u9593\u306f\u3000\uff12\u9031\u9593\u306a\u3093\u3060\u304c\u3001\u307e\u3060\u3000\u30d7\u30ed\u30b0\u30e9\u30e0\u306e\u5e38\u99d0\u3000\u304c\u3067\u304d\u3066\u3044\u306a\u3044\u3002\n\u3067\u3001\u3055\u3063\u3055\u3068\u6700\u512a\u5148\u3067\u3000\u30d7\u30ed\u30b0\u30e9\u30e0\u306e\u5e38\u99d0\u3000\u304c\u53ef\u80fd\u304b\u3069\u3046\u304b\u3000\u8abf\u3079\u305f\u65b9\u304c\u3044\u3044\u3068\u601d\u3046\u3093\u3060\u304c\u3001\n\u305d\u306e\u4ed6\u306e\u53ef\u80fd\u6027\u3092\u6f70\u3057\u3066\u3044\u304f\u306e\u306b\u3000\u8a18\u4e8b\uff1c\u305d\u306e\uff11\uff1e\uff5e\uff1c\u305d\u306e\uff15\uff1e\u3000\u307e\u3067\u304b\u304b\u3063\u305f\u3002\n\u524d\u56de\u306e\u8a18\u4e8b : http://qiita.com/muzudho1/items/8f940f8b4c679c23a174\n\n\u3084\u308a\u305f\u3044\u3053\u3068\n\u30d7\u30e9\u30f3\uff12\n\n\u30b3\u30f3\u30d4\u30e5\u30fc\u30bf\u5c06\u68cb\u30d7\u30ed\u30b0\u30e9\u30e0\u3000\u3092\u5e38\u99d0\u3055\u305b\u308b\n\u30d6\u30e9\u30a6\u30b6\u3067\u306e\u30da\u30fc\u30b8\u30fb\u30a2\u30af\u30bb\u30b9\u306e\u5ea6\u306bPHP\u306f\u3000\u6307\u3057\u624b\u30d6\u30ed\u30fc\u30ab\u30fc\u4e09\u6cb3\u5c4b\u3000\u3092\u8d77\u52d5\u3057\u3066\u3001\u30ad\u30e5\u30fc\u5f85\u3061\u3000\u3055\u305b\u3001\u30b3\u30f3\u30d4\u30e5\u30fc\u30bf\u30fc\u5c06\u68cb\u30d7\u30ed\u30b0\u30e9\u30e0\u306b\u3000\u6307\u3057\u624b\u306e\u304a\u4f3a\u3044\u3092\u7acb\u3066\u308b\nPHP\u306f\u3001\u6307\u3057\u624b\u30d6\u30ed\u30fc\u30ab\u30fc\u4e09\u6cb3\u5c4b\u3000\u304c\u6301\u3063\u3066\u304d\u305f\u6307\u3057\u624b\u3092\u3000PHP\u3067\u51fa\u529b\u3059\u308b\n\n\u30d7\u30e9\u30f3\uff11\n\n\u30b3\u30f3\u30d4\u30e5\u30fc\u30bf\u5c06\u68cb\u30d7\u30ed\u30b0\u30e9\u30e0\u3000\u3092\u5e38\u99d0\u3055\u305b\u308b\n\u30b2\u30fc\u30e0\u30b5\u30fc\u30d0\u30fc\u3000\u3092\u5e38\u99d0\u3055\u305b\u308b\n\u30b2\u30fc\u30e0\u30b5\u30fc\u30d0\u30fc\u306f\u3000\u30b3\u30f3\u30d4\u30e5\u30fc\u30bf\u30fc\u5c06\u68cb\u30d7\u30ed\u30b0\u30e9\u30e0\u3000\u3068\u5c40\u9762\u691c\u8a0e\u304c\u3067\u304d\u308b\u3082\u306e\u3068\u3059\u308b\n\u30d6\u30e9\u30a6\u30b6\u3067\u306e\u30da\u30fc\u30b8\u30fb\u30a2\u30af\u30bb\u30b9\u306e\u5ea6\u306bPHP\u306f\u3000\u7121\u9650\u30eb\u30fc\u30d7\u306b\u5165\u308a\u3000\u30b2\u30fc\u30e0\u30b5\u30fc\u30d0\u30fc\u306b\u30d7\u30ed\u30bb\u30b9\u9593\u901a\u4fe1\u3001\u30e1\u30c3\u30bb\u30fc\u30b8\u30ad\u30e5\u30fc\u306b\u6307\u3057\u624b\u304c\u5165\u3063\u3066\u3044\u308c\u3070\u3000\u7121\u9650\u30eb\u30fc\u30d7\u3092\u51fa\u3066\u3000\u6307\u3057\u624b\u3092 PHP\u3067\u51fa\u529b\u3059\u308b\n\n\u3067\u3001\u30d7\u30e9\u30f3\uff11\u306f\u3000\u305d\u308c\u304c\u3067\u304d\u306a\u3044\u3068\u3044\u3046\u8a71\u3057\u304c\u3000\u3048\u3093\u3048\u3093\u3068\u3000\u8a18\u4e8b\uff1c\u305d\u306e\uff11\uff1e\uff5e\uff1c\u305d\u306e\uff13\uff1e\u3000\u3050\u3089\u3044\u306b\u66f8\u3044\u3066\u3042\u3063\u305f\u306e\u3060\u3063\u305f\u3002\n\u6b8b\u3063\u3066\u308b\u306e\u306f\u3000\u30d7\u30e9\u30f3\uff12\u3002\n\u8abf\u3079\u3066\u307f\u308b\u3002\n\n\u5e38\u99d0\u3067\u304d\u306a\u3044\u306e\u306f\u3000\u30b3\u30f3\u30d4\u30e5\u30fc\u30bf\u5c06\u68cb\u30d7\u30ed\u30b0\u30e9\u30e0\u3067\u306f\u306a\u3044\nPuTTY\u3067\u9060\u9694\u30ed\u30b0\u30a4\u30f3\u3057\u3001PHP\u3067\u7121\u9650\u30eb\u30fc\u30d7\u3092\u66f8\u3044\u3066\u3000\u30d0\u30c3\u30af\u30b0\u30e9\u30f3\u30c9\u5b9f\u884c\u3057\u3066\u3082\u3000\u30ed\u30b0\u30a2\u30a6\u30c8\u3059\u308b\u3068\u3000\u30b8\u30e7\u30d6\u306f\u6d88\u3048\u3066\u3057\u307e\u3046\u3002\n\u305d\u3053\u3067 Cron \u3092\u4f7f\u3063\u3066\u3000\u7121\u9650\u30eb\u30fc\u30d7PHP\u3000\u3092\u5b9f\u884c\u3059\u308b\u3093\u3060\u304c\u3001\u3059\u3050\u3000S \uff08\u505c\u6b62\uff09\u3057\u3066\u3044\u308b\u3002\nApache \u306f\u5e38\u99d0\u3057\u3066\u3044\u308b\u3002\nPuTTY \u3067\u30bb\u30c3\u30b7\u30e7\u30f3\u30fb\u30ed\u30b0\u30a2\u30a6\u30c8\u3057\u3066\u3082 \u30d6\u30e9\u30a6\u30b6\u3067 http://\u2605.\u2605.\u2605.\u2605/index.php \u3068\u3067\u3082\u6253\u3066\u3070\u753b\u9762\u306f\u51fa\u3066\u304f\u308b\u3002\n\u5e38\u99d0\u306f\u3067\u304d\u308b\u3088\u3046\u3060\u3002\n\u3069\u3046\u3084\u3063\u3066\u5e38\u99d0\u3059\u308b\u306e\u304b\u3002\nWindows 10 \u3060\u3068 \u30bf\u30b9\u30af\u30d0\u30fc\u306e\u300c\u4f55\u3067\u3082\u805e\u3044\u3066\u304f\u3060\u3055\u3044\u300d\u3068\u66f8\u3044\u3066\u3042\u308b\u30c6\u30ad\u30b9\u30c8\u30dc\u30c3\u30af\u30b9\u306b \u300c\u30b3\u30f3\u30d4\u30e5\u30fc\u30bf\u30fc\u306e\u7ba1\u7406\u300d\u3068\u6253\u3061\u8fbc\u3093\u3067 [\u30b5\u30fc\u30d3\u30b9\u3068\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3] - [\u30b5\u30fc\u30d3\u30b9]\u3000\u3068\u9032\u3093\u3067\u3044\u3051\u3070\u3001\u5e38\u99d0\u3057\u3066\u3044\u308b\u30d7\u30ed\u30b0\u30e9\u30e0\u306e\u4e00\u89a7\u304c\u51fa\u3066\u304f\u308b\u3002\nUbuntu16.04 \u3060\u3068\nps aux\n\n\u3068\u6253\u3061\u8fbc\u3081\u3070\u3000\u30d7\u30ed\u30bb\u30b9\u306e\u4e00\u89a7\u304c\u898b\u308c\u308b\u3093\u3060\u304c\u3001\u3053\u308c\u306f\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u4e00\u89a7\u3067\u306f\u306a\u3044\u3002\n# ps aux | grep apache\n\n\u3068\u6253\u3061\u8fbc\u3080\u3068\u4f8b\u3048\u3070\nwww-data  2776  0.0  0.2 352548  2496 ?        S    Mar09   0:00 /usr/sbin/apache2 -k start\nroot     11959  0.0  0.0 351884    76 ?        Ss   Mar07   0:34 /usr/sbin/apache2 -k start\nwww-data 11965  0.0  0.0 352296   148 ?        S    Mar07   0:14 /usr/sbin/apache2 -k start\nroot     19418  0.0  0.0  12936   980 pts/2    S+   03:16   0:00 grep --color=auto apache\nwww-data 29283  0.0  0.1 352164  2004 ?        S    Mar09   0:00 /usr/sbin/apache2 -k start\nwww-data 29284  0.0  0.0 352164   556 ?        S    Mar09   0:00 /usr/sbin/apache2 -k start\nwww-data 29285  0.0  0.1 352164  1944 ?        S    Mar09   0:00 /usr/sbin/apache2 -k start\nwww-data 29286  0.0  0.0 352164     0 ?        S    Mar09   0:00 /usr/sbin/apache2 -k start\nwww-data 29287  0.0  0.1 352164  1776 ?        S    Mar09   0:00 /usr/sbin/apache2 -k start\nwww-data 29318  0.0  0.2 352164  2508 ?        S    Mar09   0:00 /usr/sbin/apache2 -k start\nwww-data 31812  0.0  0.1 352164  1116 ?        S    Mar09   0:00 /usr/sbin/apache2 -k start\n\n\u3068\u51fa\u3066\u304d\u3066\u3001\u3053\u306e\u3046\u3061\u300ccolor=auto apache\u300d\u3068\u3044\u3046\u306e\u306f apache\u306e\u6587\u5b57\u8272\u3092\u8d64\u8272\u306b\u3057\u307e\u3057\u3087\u3046\u3001\u3068\u3044\u3046\u4eca\u53e9\u3044\u305f\u3070\u304b\u308a\u306e\u30b3\u30de\u30f3\u30c9\u3060\u304b\u3089\u7121\u8996\u3059\u308b\u3068\u3057\u3066\u3001\n/usr/sbin/apache2 -k start\n\u3068\u3044\u3046\u30b3\u30de\u30f3\u30c9\u3067\u5b9f\u884c\u3055\u308c\u305f\u30d7\u30ed\u30bb\u30b9\u304c\u3000\u7a3c\u50cd\u3057\u3066\u3044\u308b\u3053\u3068\u304c\u5206\u304b\u308b\u3002\n\u3057\u304b\u3057\u3088\u304f\u898b\u308b\u3068\u3000\u307f\u3093\u306a\u3000S\u3000\u3060\u306a\u3002\nwww-data 15221  197 27.6 712928 281056 pts/3   Rsl+ Mar09 458:47 ./release\n\n\u3053\u308c\u306a\u3093\u304b\u3001\u30d6\u30e9\u30a6\u30b6\u3067\u30a2\u30af\u30bb\u30b9\u3057\u3066\u3000\u53e9\u304d\u8d77\u3053\u3057\u305f\u3000\u30b3\u30f3\u30d4\u30e5\u30fc\u30bf\u5c06\u68cb\u30bd\u30d5\u30c8\u306e\u3000\u6280\u5de7\u3000\u306e\u30d7\u30ed\u30b0\u30e9\u30e0\u306a\u3093\u3058\u3083\u306a\u3044\u304b\uff1f\nRsl+ \u3068\u3044\u3046\u306e\u304c\u3069\u3046\u3044\u3046\u72b6\u6cc1\u306a\u3093\u3060\u3002\n\u300cps\u30b3\u30de\u30f3\u30c9\u307e\u3068\u3081\u300d \uff08Qiita\uff09\nhttp://qiita.com/shell/items/68ed71a7f018e5688f73\n\u300cS\u300d\u306f\u30b9\u30c8\u30c3\u30d7\u3058\u3083\u306a\u304f\u3066\u3000\u30b9\u30ea\u30fc\u30d7\u3000\u306a\u306e\u304b\u2026\u2026\u3002\n# kill 15221\n\n\u3068\u3044\u3046\u3053\u3068\u306f\u3002\n# ps aux\nUSER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND\nroot         1  0.0  0.1  37448  1872 ?        Ss   Mar04   0:56 /lib/systemd/systemd --system --deserialize 19\nroot         2  0.0  0.0      0     0 ?        S    Mar04   0:00 [kthreadd]\nroot         3  0.0  0.0      0     0 ?        S    Mar04   0:03 [ksoftirqd/0]\nroot         5  0.0  0.0      0     0 ?        S<   Mar04   0:00 [kworker/0:0H]\nroot         7  0.0  0.0      0     0 ?        S    Mar04   1:52 [rcu_sched]\nroot         8  0.0  0.0      0     0 ?        S    Mar04   2:16 [rcuos/0]\nroot         9  0.0  0.0      0     0 ?        S    Mar04   0:18 [rcuos/1]\nroot        10  0.0  0.0      0     0 ?        S    Mar04   0:00 [rcu_bh]\nroot        11  0.0  0.0      0     0 ?        S    Mar04   0:00 [rcuob/0]\nroot        12  0.0  0.0      0     0 ?        S    Mar04   0:00 [rcuob/1]\nroot        13  0.0  0.0      0     0 ?        S    Mar04   0:05 [migration/0]\nroot        14  0.0  0.0      0     0 ?        S    Mar04   0:10 [watchdog/0]\nroot        15  0.0  0.0      0     0 ?        S    Mar04   0:07 [watchdog/1]\nroot        16  0.0  0.0      0     0 ?        S    Mar04   0:01 [migration/1]\nroot        17  0.0  0.0      0     0 ?        S    Mar04   0:01 [ksoftirqd/1]\nroot        19  0.0  0.0      0     0 ?        S<   Mar04   0:00 [kworker/1:0H]\nroot        20  0.0  0.0      0     0 ?        S<   Mar04   0:00 [khelper]\nroot        21  0.0  0.0      0     0 ?        S    Mar04   0:00 [kdevtmpfs]\nroot        22  0.0  0.0      0     0 ?        S<   Mar04   0:00 [netns]\nroot        23  0.0  0.0      0     0 ?        S<   Mar04   0:00 [writeback]\nroot        24  0.0  0.0      0     0 ?        S<   Mar04   0:00 [kintegrityd]\nroot        25  0.0  0.0      0     0 ?        S<   Mar04   0:00 [bioset]\nroot        27  0.0  0.0      0     0 ?        S<   Mar04   0:00 [kblockd]\nroot        28  0.0  0.0      0     0 ?        S<   Mar04   0:00 [ata_sff]\nroot        29  0.0  0.0      0     0 ?        S    Mar04   0:00 [khubd]\nroot        30  0.0  0.0      0     0 ?        S<   Mar04   0:00 [md]\nroot        31  0.0  0.0      0     0 ?        S<   Mar04   0:00 [devfreq_wq]\nroot        35  0.0  0.0      0     0 ?        S    Mar04   0:02 [khungtaskd]\nroot        36  0.0  0.0      0     0 ?        S    Mar04   3:27 [kswapd0]\nroot        37  0.0  0.0      0     0 ?        SN   Mar04   0:00 [ksmd]\nroot        38  0.0  0.0      0     0 ?        SN   Mar04   0:11 [khugepaged]\nroot        39  0.0  0.0      0     0 ?        S    Mar04   0:00 [fsnotify_mark]\nroot        40  0.0  0.0      0     0 ?        S    Mar04   0:00 [ecryptfs-kthrea]\nroot        41  0.0  0.0      0     0 ?        S<   Mar04   0:00 [crypto]\nroot        53  0.0  0.0      0     0 ?        S<   Mar04   0:00 [kthrotld]\nroot        55  0.0  0.0      0     0 ?        S    Mar04   0:00 [vballoon]\nroot        56  0.0  0.0      0     0 ?        S    Mar04   0:00 [scsi_eh_0]\nroot        57  0.0  0.0      0     0 ?        S    Mar04   0:00 [scsi_eh_1]\nroot        77  0.0  0.0      0     0 ?        S<   Mar04   0:00 [deferwq]\nroot        78  0.0  0.0      0     0 ?        S<   Mar04   0:00 [charger_manager]\nroot       115  0.0  0.0      0     0 ?        S<   Mar04   0:00 [kpsmoused]\nroot       141  0.0  0.0      0     0 ?        S    Mar04   0:36 [jbd2/vda1-8]\nroot       142  0.0  0.0      0     0 ?        S<   Mar04   0:00 [ext4-rsv-conver]\nroot       185  0.0  0.0  29480  1012 ?        Ss   Mar04   0:47 /lib/systemd/systemd-journald\nroot       196  0.0  0.0      0     0 ?        S    Mar04   0:00 [kauditd]\nroot       234  0.0  0.0  43808     8 ?        Ss   Mar04   0:03 /lib/systemd/systemd-udevd\nsystemd+   417  0.0  0.0 100316    60 ?        Ssl  Mar04   0:03 /lib/systemd/systemd-timesyncd\nsyslog     443  0.0  0.0 256388   376 ?        Ssl  Mar04   0:39 /usr/sbin/rsyslogd -n\nroot       453  0.0  0.0  29872     4 ?        Ss   Mar04   0:00 /sbin/cgmanager -m name=systemd\nroot       469  0.0  0.0 232308   236 ?        S    Mar09   0:02 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot       488  0.0  0.0      0     0 ?        S<   Mar04   0:00 [kvm-irqfd-clean]\nroot       490  0.0  0.1 274560  1356 ?        Ssl  Mar04   1:03 /usr/lib/accountsservice/accounts-daemon\nroot       494  0.0  0.0  28540   880 ?        Ss   Mar04   0:13 /lib/systemd/systemd-logind\nmessage+   515  0.0  0.0  43020   636 ?        Ss   Mar04   0:22 /usr/bin/dbus-daemon --system --address=systemd: --nofork --nopidfile --systemd-a\nroot       551  0.0  0.0  19592   304 ?        Ss   Mar04   0:56 /usr/sbin/irqbalance --pid=/var/run/irqbalance.pid\nroot       709  0.0  0.0  65512   332 ?        Ss   Mar04   0:04 /usr/sbin/sshd -D\nmemcache   714  0.0  0.0 340888   540 ?        Ssl  Mar04   1:32 /usr/bin/memcached -m 64 -p 11211 -u memcache -l 160.16.83.155\nmysql      715  0.1  0.0 1302112    0 ?        Ssl  Mar04  11:35 /usr/sbin/mysqld\nroot       757  0.0  0.0  14468     0 ttyS0    Ss+  Mar04   0:00 /sbin/agetty --keep-baud 115200 38400 9600 ttyS0 vt220\nroot       758  0.0  0.0  14652     0 tty1     Ss+  Mar04   0:00 /sbin/agetty --noclear tty1 linux\nroot      1878  0.0  0.0 232308   108 ?        S    Mar09   0:03 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nwww-data  2776  0.0  0.2 352548  2496 ?        S    Mar09   0:00 /usr/sbin/apache2 -k start\nroot      2866  0.0  0.0      0     0 ?        S    Mar07   0:00 [kworker/0:2]\nroot      2957  0.0  0.0 232308    40 ?        S    Mar09   0:02 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot      4784  0.0  0.0 232308    92 ?        S    Mar09   0:03 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot      4945  0.0  0.0 232308   104 ?        S    Mar08   0:09 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot      5693  0.0  0.0      0     0 ?        S    Mar07   0:49 [kworker/0:0]\nroot      5916  0.0  0.0 232308   172 ?        S    Mar09   0:02 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot      6091  0.0  0.0 311040   312 ?        Ss   Mar07   0:49 php-fpm: master process (/etc/php/7.0/fpm/php-fpm.conf)\nwww-data  6094  0.0  0.0 311040     0 ?        S    Mar07   0:00 php-fpm: pool www\nwww-data  6095  0.0  0.0 311040     0 ?        S    Mar07   0:00 php-fpm: pool www\nroot      6301  0.0  0.0 232308   260 ?        S    Mar08   0:10 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot      6856  0.0  0.0 232308   112 ?        S    Mar09   0:02 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot      7280  0.0  0.0      0     0 ?        S    Mar07   0:18 [kworker/1:1]\nroot      7795  0.0  0.0 232308   112 ?        S    Mar09   0:01 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot      8303  0.0  0.0 232308   132 ?        S    Mar08   0:09 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot      8732  0.0  0.0 232308   132 ?        S    Mar09   0:01 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot      9246  0.0  0.0 232308    80 ?        S    Mar08   0:09 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot      9664  0.0  0.0 232308   272 ?        S    Mar09   0:01 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot     10278  0.0  0.0 232308    52 ?        S    Mar08   0:08 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot     10632  0.0  0.0 232308   124 ?        S    Mar09   0:01 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot     11364  0.0  0.0 232308   276 ?        S    Mar08   0:08 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot     11567  0.0  0.0 232308    72 ?        S    Mar09   0:01 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot     11959  0.0  0.0 351884    76 ?        Ss   Mar07   0:34 /usr/sbin/apache2 -k start\nwww-data 11965  0.0  0.0 352296   148 ?        S    Mar07   0:14 /usr/sbin/apache2 -k start\nroot     12122  0.0  0.0   4500     0 ?        S    Mar07   0:00 /bin/sh /usr/sbin/rabbitmq-server\nroot     12129  0.0  0.0  55128     0 ?        S    Mar07   0:00 su rabbitmq -s /bin/sh -c /usr/lib/rabbitmq/bin/rabbitmq-server\nrabbitmq 12130  0.0  0.0   4500     8 ?        Ss   Mar07   0:00 sh -c /usr/lib/rabbitmq/bin/rabbitmq-server\nrabbitmq 12131  0.0  0.0   4500     0 ?        S    Mar07   0:00 /bin/sh -e /usr/lib/rabbitmq/bin/rabbitmq-server\nrabbitmq 12237  0.6  1.8 2812192 19272 ?       Sl   Mar07  25:13 /usr/lib/erlang/erts-8.1/bin/beam.smp -W w -A 64 -P 1048576 -t 5000000 -stbt db -\nrabbitmq 12333  0.0  0.0   4356    72 ?        Ss   Mar07   0:16 erl_child_setup 1024\nrabbitmq 12343  0.0  0.0  13676    36 ?        Ss   Mar07   0:00 inet_gethost 4\nrabbitmq 12344  0.0  0.0  15796   228 ?        S    Mar07   0:01 inet_gethost 4\nroot     12376  0.0  0.0 232308    76 ?        S    Mar08   0:08 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot     12582  0.0  0.0 232308   164 ?        S    Mar09   0:01 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot     12714  0.0  0.0  99616   332 ?        Ss   Mar09   0:00 sshd: \u2605user [priv]\n\u2605user    12738  0.0  0.0  99616   524 ?        S    Mar09   0:01 sshd: \u2605user@pts/2\n\u2605user    12742  0.0  0.0  21484     0 pts/2    Ss   Mar09   0:00 -bash\nroot     12760  0.0  0.0  55780     4 pts/2    S    Mar09   0:00 sudo su -\nroot     12761  0.0  0.0  55128     0 pts/2    S    Mar09   0:00 su -\nroot     12762  0.0  0.1  21508  1348 pts/2    S    Mar09   0:00 -su\nroot     13304  0.0  0.0 232308   180 ?        S    Mar08   0:07 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot     13713  0.0  0.0 232308    72 ?        S    Mar09   0:00 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot     14237  0.0  0.0 232308   100 ?        S    Mar08   0:07 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot     14600  0.0  0.0  99528   164 ?        Ss   Mar09   0:00 sshd: \u2605user [priv]\n\u2605user    14616  0.0  0.0  99528   584 ?        S    Mar09   0:00 sshd: \u2605user@notty\n\u2605user    14617  0.0  0.0  12876   256 ?        Ss   Mar09   0:00 /usr/lib/openssh/sftp-server\nroot     14706  0.0  0.0 232308   136 ?        S    Mar09   0:00 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot     15183  0.0  0.0 232308   204 ?        S    Mar08   0:07 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot     15608  0.0  0.0      0     0 ?        S    Mar09   0:00 [kworker/u4:2]\nroot     15780  0.0  0.0      0     0 ?        S    00:04   0:00 [kworker/u4:0]\nroot     15791  0.0  0.0 232308    80 ?        S    00:05   0:00 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot     16115  0.0  0.0 232308    80 ?        S    Mar08   0:07 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot     16778  0.0  0.0 232308    60 ?        S    01:05   0:00 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot     17059  0.0  0.0 232308    76 ?        S    Mar08   0:07 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot     17726  0.0  0.0      0     0 ?        S<   02:00   0:00 [kworker/u5:2]\nroot     17967  0.0  0.0 232308   256 ?        S    02:05   0:00 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot     17993  0.0  0.0 232308   252 ?        S    Mar08   0:06 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot     18025  0.0  0.0      0     0 ?        S<   02:07   0:00 [kworker/u5:0]\nroot     18398  0.0  0.0      0     0 ?        S    02:24   0:00 [kworker/1:0]\nroot     19047  0.0  0.0 232308    76 ?        S    Mar08   0:06 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot     19194  0.0  1.3 232308 14048 ?        S    03:05   0:00 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot     19518  0.0  0.0   6004   632 ?        S    03:23   0:00 sleep 1m\nroot     19529  0.0  0.1  36076  1700 pts/2    R+   03:24   0:00 ps aux\nroot     20097  0.0  0.0 232308   212 ?        S    Mar08   0:06 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot     21104  0.0  0.0 232308   224 ?        S    Mar08   0:05 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot     22197  0.0  0.0 232308   264 ?        S    Mar09   0:05 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot     22468  0.0  0.0  11332   556 ?        S    Mar07   0:04 /bin/bash ./loop8.sh\n\u2605user    22666  0.0  0.0  45240     0 ?        Ss   Mar06   0:00 /lib/systemd/systemd --user\n\u2605user    22667  0.0  0.0  63256     4 ?        S    Mar06   0:00 (sd-pam)\nroot     23284  0.0  0.0 232308    96 ?        S    Mar09   0:05 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot     24410  0.0  0.0 232308   192 ?        S    Mar09   0:04 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot     25393  0.0  0.0 232308   196 ?        S    Mar09   0:04 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot     26650  0.0  0.0 232308   232 ?        S    Mar09   0:04 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nrabbitmq 27670  0.0  0.0  13848    64 ?        S    Mar06   0:11 /usr/lib/erlang/erts-8.1/bin/epmd -daemon\nroot     27756  0.0  0.0 232308   228 ?        S    Mar09   0:04 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot     28734  0.0  0.0 232308   128 ?        S    Mar09   0:03 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nwww-data 29283  0.0  0.1 352164  2004 ?        S    Mar09   0:00 /usr/sbin/apache2 -k start\nwww-data 29284  0.0  0.1 352164  1300 ?        S    Mar09   0:00 /usr/sbin/apache2 -k start\nwww-data 29285  0.0  0.1 352164  1944 ?        S    Mar09   0:00 /usr/sbin/apache2 -k start\nwww-data 29286  0.0  0.1 352556  1956 ?        S    Mar09   0:00 /usr/sbin/apache2 -k start\nwww-data 29287  0.0  0.1 352164  1776 ?        S    Mar09   0:00 /usr/sbin/apache2 -k start\nwww-data 29318  0.0  0.2 352164  2508 ?        S    Mar09   0:00 /usr/sbin/apache2 -k start\nroot     29957  0.0  0.0 232308    84 ?        S    Mar09   0:04 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot     30931  0.0  0.0 232308    40 ?        S    Mar09   0:04 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot     31317  0.0  0.0  27720   300 ?        Ss   Mar08   0:02 /usr/sbin/cron -f\nwww-data 31812  0.0  0.1 352164  1116 ?        S    Mar09   0:00 /usr/sbin/apache2 -k start\nroot     31947  0.0  0.0 232308   180 ?        S    Mar09   0:02 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\n\n\u3088\u304f\u898b\u308b\u3068 dequeueBroker.php \u304c\u3000\u305f\u304f\u3055\u3093\u3000\u5e38\u99d0\u3057\u3066\u3044\u308b\u3002\n\u3046\u30fc\u3080\u3001\u4e00\u56de dequeueBroker.php \u5168\u90e8 kill \u3057\u3066\u307f\u308b\u304b\u3002\n# ps aux | grep dequeueBroker.php\n\nroot       469  0.0  0.0 232308   236 ?        S    Mar09   0:02 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot      1878  0.0  0.0 232308   108 ?        S    Mar09   0:03 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot      2957  0.0  0.0 232308    40 ?        S    Mar09   0:02 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot      4784  0.0  0.0 232308    92 ?        S    Mar09   0:03 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot      4945  0.0  0.0 232308   104 ?        S    Mar08   0:09 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot      5916  0.0  0.0 232308   172 ?        S    Mar09   0:02 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot      6301  0.0  0.0 232308   260 ?        S    Mar08   0:10 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot      6856  0.0  0.0 232308   112 ?        S    Mar09   0:02 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot      7795  0.0  0.0 232308   112 ?        S    Mar09   0:01 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot      8303  0.0  0.0 232308   132 ?        S    Mar08   0:09 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot      8732  0.0  0.0 232308   132 ?        S    Mar09   0:01 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot      9246  0.0  0.0 232308    80 ?        S    Mar08   0:09 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot      9664  0.0  0.0 232308   272 ?        S    Mar09   0:01 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot     10278  0.0  0.0 232308    52 ?        S    Mar08   0:08 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot     10632  0.0  0.0 232308   124 ?        S    Mar09   0:01 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot     11364  0.0  0.0 232308   276 ?        S    Mar08   0:08 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot     11567  0.0  0.0 232308    72 ?        S    Mar09   0:01 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot     12376  0.0  0.0 232308    76 ?        S    Mar08   0:08 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot     12582  0.0  0.0 232308   164 ?        S    Mar09   0:01 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot     13304  0.0  0.0 232308   180 ?        S    Mar08   0:07 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot     13713  0.0  0.0 232308    72 ?        S    Mar09   0:00 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot     14237  0.0  0.0 232308   100 ?        S    Mar08   0:07 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot     14706  0.0  0.0 232308   136 ?        S    Mar09   0:00 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot     15183  0.0  0.0 232308   204 ?        S    Mar08   0:07 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot     15791  0.0  0.0 232308    80 ?        S    00:05   0:00 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot     16115  0.0  0.0 232308    80 ?        S    Mar08   0:07 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot     16778  0.0  0.0 232308    60 ?        S    01:05   0:00 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot     17059  0.0  0.0 232308    76 ?        S    Mar08   0:07 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot     17967  0.0  0.0 232308   256 ?        S    02:05   0:00 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot     17993  0.0  0.0 232308   252 ?        S    Mar08   0:06 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot     19047  0.0  0.0 232308    76 ?        S    Mar08   0:06 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot     19194  0.0  1.3 232308 14048 ?        S    03:05   0:00 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot     19588  0.0  0.0  13068   984 pts/2    S+   03:29   0:00 grep --color=auto dequeueBroker.php\nroot     20097  0.0  0.0 232308   212 ?        S    Mar08   0:06 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot     21104  0.0  0.0 232308   224 ?        S    Mar08   0:05 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot     22197  0.0  0.0 232308   264 ?        S    Mar09   0:05 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot     23284  0.0  0.0 232308    96 ?        S    Mar09   0:05 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot     24410  0.0  0.0 232308   192 ?        S    Mar09   0:04 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot     25393  0.0  0.0 232308   196 ?        S    Mar09   0:04 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot     26650  0.0  0.0 232308   232 ?        S    Mar09   0:04 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot     27756  0.0  0.0 232308   228 ?        S    Mar09   0:04 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot     28734  0.0  0.0 232308   128 ?        S    Mar09   0:03 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot     29957  0.0  0.0 232308    84 ?        S    Mar09   0:04 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot     30931  0.0  0.0 232308    40 ?        S    Mar09   0:04 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot     31947  0.0  0.0 232308   180 ?        S    Mar09   0:02 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\n\n\u3067\u3001\u4f55\u5217\u76ee\u3060\u3051\u62bd\u51fa\u3059\u308b\u3068\u3044\u3046\u3000\u30b3\u30de\u30f3\u30c9\u304c\u3042\u3063\u305f\u3068\u601d\u3046\u3093\u3060\u304c\u3001\u899a\u3048\u3066\u306a\u3044\u3093\u3067\u30b0\u30b0\u308b\u3002\n\u300cLinux\u30b3\u30de\u30f3\u30c9\u3067\u30c6\u30ad\u30b9\u30c8\u30c7\u30fc\u30bf\u3092\u81ea\u5728\u306b\u64cd\u308b\u300d \uff08orangain flavor\uff09\nhttp://orangain.hatenablog.com/entry/20100916/1284631280\n\u3048\u3048\u3063\uff01 cat \u3068 cut \u304c\u3042\u308b\u306e\uff01\uff1f\ncat \u3067\u30d5\u30a3\u30fc\u30eb\u30c9\u62bd\u51fa\u3059\u308b\u65b9\u6cd5\u306a\u3093\u304b\u7121\u3044\u3088\u306a\u3001\u3068\u304b\u601d\u3063\u3066\u305f\u3093\u3060\u304c\u3002\n\u3058\u3083\u3042\u3001\u3053\u3046\u3057\u305f\u3089\u3069\u3046\u304b\uff1f\n# ps aux | grep dequeueBroker.php | cut -f 2\n\n\u30c0\u30e1\u3001\u30a2\u30a6\u30c4\u3002\u3000\u306a\u3093\u306b\u3082\u306a\u3089\u306a\u3044\u3002\n\u300c1\u3064\u4ee5\u4e0a\u306e\u9023\u7d9a\u3059\u308b\u30b9\u30da\u30fc\u30b9\u307e\u305f\u306f\u30bf\u30d6\u6587\u5b57\u3092\u533a\u5207\u308a\u3068\u3057\u3066\u51e6\u7406\u3059\u308b\u306b\u306f\u300d \uff08cut \u30b3\u30de\u30f3\u30c9\uff09\nhttps://hydrocul.github.io/wiki/commands/cut.html\n\u3053\u3046\u3044\u3063\u305f\u30d6\u30ed\u30b0\u8a18\u4e8b\u306f\u3000\uff29\uff34\u7cfb\u306e\u4f1a\u793e\u3000\u306b\u52d9\u3081\u3066\u3044\u308b\u3068\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u3067\u898b\u308c\u306a\u3044\u3057\u3001\uff29\uff34\u3058\u3083\u306a\u3044\u7cfb\u306e\u4f1a\u793e\u3000\u306b\u3044\u308b\u3068\u898b\u308c\u305f\u308a\u3059\u308b\u3002\u3000\uff29\uff34\u7cfb\u3068\u306f\u4f55\u306a\u306e\u304b\u2026\u2026\u3002\n\uff11\u3064\uff11\u3064\u306e\u30ea\u30b9\u30af\u3092\u5207\u3063\u3066\u3044\u308b\u3053\u3068\u3067\u4e07\u5168\u3001\u3068\u3044\u3046\u308f\u3051\u306a\u3093\u3060\u308d\u3046\u304c\u3001\u4e0d\u7965\u4e8b\uff11\u767a\u304c\u5e83\u304f\u62e1\u6563\u3059\u308b\uff29\uff34\u30c6\u30af\u30ce\u30ed\u30b8\u30fc\u304c\u4eca\u306e\uff29\uff34\u7cfb\u3092\u4f5c\u3063\u305f\u3002\n\u3058\u3083\u3042\u3001\u3053\u3046\u304b\uff1f\n# ps aux | grep dequeueBroker.php | sed 's/[\\t ]\\+/\\t/g' | cut -f 2\n\n469\n1878\n2957\n4784\n4945\n5916\n6301\n6856\n7795\n8303\n8732\n9246\n9664\n10278\n10632\n11364\n11567\n12376\n12582\n13304\n13713\n14237\n14706\n15183\n15791\n16115\n16778\n17059\n17967\n17993\n19047\n19194\n19795\n20097\n21104\n22197\n23284\n24410\n25393\n26650\n27756\n28734\n29957\n30931\n31947\n\n\u30b0\u30ec\u30fc\u30c8\uff01\n\u3067\u3001kill \u3092 for\u6587\u304b\u4f55\u304b\u3067\u56de\u305b\u306a\u3044\u306e\uff1f\n\u300c\u8907\u6570\u306e\u30d7\u30ed\u30bb\u30b9\u3092\u307e\u3068\u3081\u3066kill\u3059\u308b\u300d \uff08mikage014\u306e\u65e5\u8a18\uff09\nhttp://d.hatena.ne.jp/mikage014/20100205/1265330850\n\u3067\u3001\u3053\u308c\u3092\u8aad\u3080\u3068 kill \u306b\u306f\u305d\u308c\u304c\u3067\u304d\u308b\u3089\u3057\u3044\u3002\u3053\u3046\u304b\uff1f\nkill `ps aux | grep dequeueBroker.php | sed 's/[\\t ]\\+/\\t/g' | cut -f 2`\n\n# kill `ps aux | grep dequeueBroker.php | sed 's/[\\t ]\\+/\\t/g' | cut -f 2`\n-su: kill: (19870) - No such process\n\n\uff1f\n# ps aux | grep dequeueBroker.php\nroot     19889  0.0  0.0  12936   984 pts/2    S+   03:45   0:00 grep --color=auto dequeueBroker.php\n\n\u307e\u3042\u3001\u6d88\u3048\u3066\u304f\u308c\u305f\u3093\u3058\u3083\u306a\u3044\u304b\u3002\n\u3058\u3083\u3042\u3001\u6d6e\u304b\u3080\u702c \u3092\u30d0\u30c3\u30af\u30b0\u30e9\u30a6\u30f3\u30c9\u3067\u8d77\u52d5\u3057\u3066\u307f\u3088\u3046\u3002\n# cd /home/\u2605user/shogi/ukamuse_sdt4/bin\n# ./apery &\n[1] 20023\n# ps aux | grep apery\nroot     20023  0.8 14.0 1325848 142852 pts/2  Tl   03:54   0:00 ./apery\nroot     20033  0.0  0.0  12936   984 pts/2    S+   03:55   0:00 grep --color=auto apery\n\n[1]+  Stopped                 ./apery\n\n\u3053\u308c\u304c\u5206\u304b\u3089\u306a\u3044\u3002 Stopped \u3068\u66f8\u3044\u3066\u308b\u306e\u306a\u3002\n# ps aux | grep apery\nroot     20023  0.1 14.0 1325848 142852 pts/2  Tl   03:54   0:00 ./apery\nroot     20055  0.0  0.0  12936   988 pts/2    S+   03:56   0:00 grep --color=auto apery\n\n\u3082\u3046\uff11\u56de\u898b\u3066\u307f\u308b\u3068\u3001./apery \u30d7\u30ed\u30bb\u30b9\u306f\u307e\u3060\u5c45\u308b\u3088\u3046\u3060\u3002 Tl \u306f\u3000\u505c\u6b62\u4e2d\u3067\u3001\u30d7\u30ed\u30bb\u30b9\u751f\u6210\u4e2d\u306a\u306e\u3060\u308d\u3046\u304b\u3002\u306a\u3093\u306e\u3053\u3063\u3061\u3083\u3002\n\u3067\u306f\u3001\u30b9\u30fc\u30d1\u30fc\u30fb\u30e6\u30fc\u30b6\u30fc\u3068\u3001\u30ed\u30b0\u30a4\u30f3\u7528\u4e00\u822c\u30a2\u30ab\u30a6\u30f3\u30c8\u306e\uff12\u3064\u304b\u3089\u3000\u30ed\u30b0\u30a2\u30a6\u30c8\u3057\u3066\u307f\u308b\u3002\n# logout\nThere are stopped jobs.\n# logout\n# logout\n\n\u3046\u30fc\u3093\uff1f\n\n\u518d\u5ea6\u30ed\u30b0\u30a4\u30f3\n\u4e00\u822c\u30e6\u30fc\u30b6\u30fc\u3067\u30ed\u30b0\u30a4\u30f3\u3057\u3001\n$ sudo su -\n\n\u304b\u3089\n# ps aux | grep apery\nroot     20182  0.0  0.0  12936   988 pts/2    S+   04:02   0:00 grep --color=auto apery\n\n./apery \u306f\u3044\u306a\u304f\u306a\u3063\u3066\u3044\u308b\u3002\u30ed\u30b0\u30a2\u30a6\u30c8\u3059\u308b\u3068\u3000\u30b8\u30e7\u30d6\u306f\u6b62\u307e\u308b\u306e\u3060\u308d\u3046\u304b\u3002\n\u3058\u3083\u3042\u6b21\u3002\n\u300c\u3010 nohup \u3011 \u30ed\u30b0\u30a2\u30a6\u30c8\u3057\u305f\u5f8c\u3082\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3057\u7d9a\u3051\u308b\u300d \uff08ITPro\uff09\nhttp://itpro.nikkeibp.co.jp/article/COLUMN/20060227/230850/\n# cd /home/\u2605user/shogi/ukamuse_sdt4/bin\n# nohup ./apery &\n[1] 20237\nroot@\u2605:/home/\u2605user/shogi/ukamuse_sdt4/bin# nohup: ignoring input and appending output to 'nohup.out'\n\n\u306a\u3093\u3060\u308d\u3046\u3002\n\u5165\u529b\u306f\u7121\u8996\u3055\u308c\u307e\u3059\u3001\u51fa\u529b\u306f nohup.out \u3067\u3059\u3001\u3068\u3044\u3046\u3053\u3068\u3060\u308d\u3046\u304b\u3002\n\u5165\u529b\u304c\u7121\u8996\u3055\u308c\u305f\u3089\u56f0\u308b\u3093\u3058\u3083\u306a\u3044\u304b\uff1f\nnohup php ./apery > apery.out.log 2> apery.err.log < /dev/null &\n\n\u6a19\u6e96\u5165\u529b\u306f\u3000\u4f55\u306b\u3057\u305f\u3089\u3044\u3044\u3093\u3060\uff1f\n\u30b3\u30f3\u30d4\u30e5\u30fc\u30bf\u30fc\u5c06\u68cb\u30bd\u30d5\u30c8\u306f\u3000\u6a19\u6e96\u5165\u529b\u304b\u3089\u3000\u30b3\u30de\u30f3\u30c9\u3092\u53d7\u3051\u4ed8\u3051\u308b\u306e\u3067\u3001\u305d\u308c\u3092\u9589\u3058\u3066\u3057\u307e\u3046\u3068\u3000\u5f79\u306b\u7acb\u305f\u306a\u3044\u3002\n\u305d\u308c\u306f\u3000\u3042\u3068\u3067\u8003\u3048\u308b\u3068\u3057\u3066\u3001 nohup \u3067\u5b9f\u884c\u3057\u305f\u30b3\u30de\u30f3\u30c9\u304c\u3001\u30ed\u30b0\u30a2\u30a6\u30c8\u5f8c\u3082\u6b8b\u3063\u3066\u3044\u308b\u306e\u304b\u8abf\u3079\u3066\u307f\u305f\u3044\u3002\n# ps aux | grep apery      root     20436  0.0  0.0  12936   984 pts/2    S+   04:15   0:00 grep --color=auto apery\n[1]+  Done                    nohup ./apery\n\nDone \u3063\u3066\u4f55\u3060\u308d\u3046\u304b\u3002 nohup \u304c Done \u306a\u306e\u3060\u308d\u3046\u304b\uff1f\n# ps aux | grep apery\nroot     20447  0.0  0.0  12936   988 pts/2    S+   04:16   0:00 grep --color=auto apery\n\n\u30ed\u30b0\u30a2\u30a6\u30c8\u3059\u308b\u9593\u3067\u3082\u306a\u304f\u3000\u6d88\u3048\u3066\u306a\u304f\u306a\u3063\u305f\u3002\nnohup \u306f ./apery \u3092\u5b9f\u884c\u3057\u306a\u304b\u3063\u305f\u306e\u3060\u308d\u3046\u304b\uff1f\n\u3058\u3083\u3042\u3001\u4f55\u304c nohup \u3067\u30d0\u30c3\u30af\u30b0\u30e9\u30a6\u30f3\u30c9\u3067\u5b9f\u884c\u3067\u304d\u308b\u3093\u3060\u308d\u3046\u304b\uff1f\n\u300cPHP while\u6587\u3068\u7121\u9650\u30eb\u30fc\u30d7\u300d \uff08\u30bc\u30ed\u30d7\u30ed \u30d6\u30ed\u30b0\u301c\uff10\u304b\u3089\u306e\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u5b66\u7fd2\u301c\uff09\nhttp://zeropuro.com/blog/?p=248\nloop28.php\n<?php\nwhile(true){\n  sleep(1);\n}\n\n# php loop28.php &\n[1] 20615\n# ps aux | grep php\nroot      6091  0.0  0.0 311040   312 ?        Ss   Mar07   0:50 php-fpm: master process (/etc/php/7.0/fpm/php-fpm.conf)\nwww-data  6094  0.0  0.0 311040     0 ?        S    Mar07   0:00 php-fpm: pool www\nwww-data  6095  0.0  0.0 311040     0 ?        S    Mar07   0:00 php-fpm: pool www\nroot     20224  0.0  1.3 232308 14048 ?        S    04:05   0:00 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot     20615  0.1  1.3 230188 13304 pts/2    S    04:27   0:00 php loop28.php\nroot     20622  0.0  0.0  12936   988 pts/2    S+   04:28   0:00 grep --color=auto php\n\n\u3058\u3083\u3042\u3001\u30ed\u30b0\u30a2\u30a6\u30c8\u3057\u3066\u307f\u308b\u3002\n# logout\n# logout\n\n\u3055\u3063\u304d\u306f\uff13\u56de\u3067\u3001\u4eca\u56de\u306f\uff12\u56de\u3060\u3002\u4f55\u306e\u9055\u3044\u304c\u3042\u308b\u3093\u3060\u308d\u3046\u3002\n# ps aux | grep php\nroot      6091  0.0  0.0 311040   312 ?        Ss   Mar07   0:50 php-fpm: master process (/etc/php/7.0/fpm/php-fpm.conf)\nwww-data  6094  0.0  0.0 311040     0 ?        S    Mar07   0:00 php-fpm: pool www\nwww-data  6095  0.0  0.0 311040     0 ?        S    Mar07   0:00 php-fpm: pool www\nroot     20224  0.0  1.3 232308 14048 ?        S    04:05   0:00 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot     20615  0.0  1.3 230188 13304 ?        S    04:27   0:00 php loop28.php\nroot     20743  0.0  0.0  12936   984 pts/3    S+   04:33   0:00 grep --color=auto php\n\n\u4eca\u5ea6\u306f loop28.php \u304c\u3044\u308b\u3088\u3046\u3060\u3002\n\u3060\u3063\u305f\u3089 PHP \u3068 C#\u3001C++ \u304c\u30d7\u30ed\u30bb\u30b9\u9593\u901a\u4fe1\u3067\u304d\u308b\u3093\u306a\u3089\u3000\u8a71\u3057\u306f\u65e9\u3044\u3093\u3060\u304c\u3001PHP \u3068 C# \u306f\u30d7\u30ed\u30bb\u30b9\u9593\u901a\u4fe1\u304c\u50cd\u304b\u306a\u304b\u3063\u305f\u306e\u306f\u3000\u8a18\u4e8b\uff1c\u305d\u306e\uff11\uff1e\uff5e\uff1c\u305d\u306e\uff13\uff1e\u306e\u3069\u3053\u304b\u306b\u66f8\u3044\u305f\u306e\u3060\u3063\u305f\u3002\n\nC++ \u306e\u7121\u9650\u30eb\u30fc\u30d7\u306f\u5e38\u99d0\u3067\u304d\u308b\u3060\u308d\u3046\u304b\uff1f\n\u300c\u6642\u9593\u30fb\u6642\u523b\u51e6\u7406\u306b\u3064\u3044\u3066(4)\u300d \uff08LinuxC\uff09\nhttp://linuxc.info/time/time6/\n\u3060\u3081\u3001Windows\u3067\u52d5\u304b\u306a\u3044\u3002\n\u300cSleep for milliseconds\u300d \uff08stack overflow\uff09\nhttp://stackoverflow.com/questions/4184468/sleep-for-milliseconds\n\u3058\u3083\u3042\u3001\u3053\u3046\u304b\u3002\n// Cpp_Tamesi28.cpp : Defines the entry point for the console application.\n//\n\n#include <chrono>\n#include <thread>\n\n#if WINDOWS\n#include \"stdafx.h\"\n#endif\n\nint main(void)\n{\n    for (;;) {\n        std::this_thread::sleep_for(std::chrono::seconds(1));\n    }\n    return 0;\n}\n\nVisual Studio 2015 C++ \u3067\u3000\u30d7\u30ea\u30d7\u30ed\u30bb\u30c3\u30b5\u5b9a\u7fa9\u3092\u3000\u30b3\u30de\u30f3\u30c9\u30e9\u30a4\u30f3\u5f15\u6570\u306b\u4ed8\u3051\u308b\u306b\u306f\u3069\u3046\u3084\u308b\u3093\u3060\uff1f\n\u300c/D (\u30d7\u30ea\u30d7\u30ed\u30bb\u30c3\u30b5\u306e\u5b9a\u7fa9)\u300d \uff08MSDN\uff09\nhttps://msdn.microsoft.com/ja-jp/library/hhzbb5c8.aspx\n\u30e1\u30a4\u30f3\u30e1\u30cb\u30e5\u30fc\u306e [Project] \u304b\u3089\u3001\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306e\u30d7\u30ed\u30d1\u30c6\u30a3\u30fc\u306e\u30da\u30fc\u30b8\u3092\u958b\u304d\u3001\n[Configuration Properties] - [C/C++] - [Preprocessor] - [Preprocessor Definitions]\n\u3068\u9032\u3093\u3067\u3001\n_DEBUG;_CONSOLE;%(PreprocessorDefinitions)\n\n\u306e\u672b\u5c3e\u306b WINDOWS \u3068\u3067\u3082\u4ed8\u3051\u3088\u3046\u3002\n_DEBUG;_CONSOLE;%(PreprocessorDefinitions);WINDOWS\n\n\u30c0\u30e1\u3060\u3002\u3053\u3046\u304b\u3002\n_DEBUG;_CONSOLE;WINDOWS;%(PreprocessorDefinitions)\n\n\u3053\u308c\u3082\u30c0\u30e1\u3002\n\u3042\u30fc\uff01 x86 \u306b\u306a\u3063\u3066\u3044\u308b\u3002 x64 \u306b\u5408\u308f\u305b\u3088\u3046\u3002\n\u3053\u308c\u3067\uff2f\uff2b\u3002\nstdafx.h\n// stdafx.h : include file for standard system include files,\n// or project specific include files that are used frequently, but\n// are changed infrequently\n//\n\n#pragma once\n\n#include \"targetver.h\"\n\n#include <stdio.h>\n#include <tchar.h>\n\n\n// TODO: reference additional headers your program requires here\n\n\u306e\u3001\n// stdafx.h : include file for standard system include files,\n// or project specific include files that are used frequently, but\n// are changed infrequently\n//\n\n#pragma once\n\n#if WINDOWS\n#include \"targetver.h\"\n\n#include <stdio.h>\n#include <tchar.h>\n#endif\n\n\n// TODO: reference additional headers your program requires here\n\n\u5185\u5bb9\u3092\n#if WINDOWS\n#endif\n\n\u3067\u56f2\u3093\u3060\u3002\n\u5b9f\u884c\u3059\u308b\u3068\u3001\u5165\u529b\u3092\u53d7\u3051\u4ed8\u3051\u306a\u3044\u30b3\u30de\u30f3\u30c9\u30fb\u30d7\u30ed\u30f3\u30d7\u30c8\u30fb\u30a6\u30a3\u30f3\u30c9\u30a6\u304c\u958b\u3044\u305f\u3002\nUbuntu \u306b\u30bd\u30fc\u30b9\u3092\u6301\u3063\u3066\u3044\u3063\u3066\u3001\u52d5\u304f\u3060\u308d\u3046\u304b\uff1f\n\u3057\u304b\u3057 Makefile \u306e\u66f8\u304d\u65b9\u304c\u5206\u304b\u3089\u306a\u3044\u3002\n# cd /home/\u2605user/shogi\n# mkdir cpp_service\n# mkdir tamesi28.d\n# nano tamesi28.cpp\n\n#include <chrono>\n#include <thread>\n\nint main(void)\n{\n        for (;;) {\n                std::this_thread::sleep_for(std::chrono::seconds(1));\n        }\n        return 0;\n}\n\n\u3053\u3093\u306a\u3093\u3067\u3000\u3044\u3044\u3093\u3060\u308d\u3046\u304b\uff1f\ng++ \u3067\u30b3\u30f3\u30d1\u30a4\u30eb\u3059\u308b\u306b\u306f\uff1f\n\u300cg++\u300d \uff08C++\uff09\nhttp://kaworu.jpn.org/cpp/g++\n\u30d5\u30a1\u30a4\u30eb\u540d\u3092\u4ed8\u3051\u308b\u3060\u3051\u304b\u3002\n# g++ tamesi28.cpp\nIn file included from /usr/include/c++/5/chrono:35:0,\n                 from tamesi28.cpp:1:\n/usr/include/c++/5/bits/c++0x_warning.h:32:2: error: #error This file requires compiler and library support for the ISO C++ 2011 standard. This support must be enabled with the -std=c++11 or -std=gnu++11 compiler options.\n #error This file requires compiler and library support \\\n  ^\ntamesi28.cpp: In function \u2018int main()\u2019:\ntamesi28.cpp:7:8: error: \u2018std::this_thread\u2019 has not been declared\n   std::this_thread::sleep_for(std::chrono::seconds(1));\n        ^\ntamesi28.cpp:7:36: error: \u2018std::chrono\u2019 has not been declared\n   std::this_thread::sleep_for(std::chrono::seconds(1));\n                                    ^\n\nstd::this_thread \u3082\u3001std::chrono \u3082\u4f7f\u3048\u306a\u3044\u306e\u304b\u3002\n\u6d6e\u304b\u3080\u702c usi.cpp\n            std::this_thread::sleep_for(std::chrono::seconds(5)); // \u6307\u5b9a\u79d2\u3060\u3051\u5f85\u6a5f\u3057\u3001\u9032\u6357\u3092\u8868\u793a\u3059\u308b\u3002\n\n\u6d6e\u304b\u3080\u702c\u3067\u306f\u4f7f\u3063\u3066\u3044\u308b\u3057\u3001g++ \u3067\u30b3\u30f3\u30d1\u30a4\u30eb\u3067\u304d\u3066\u3044\u308b\u3068\u601d\u3046\u3093\u3060\u304c\u3002\nMakefile \u306b\u4ed5\u7d44\u307f\u304c\u3042\u308b\u3093\u3060\u308d\u3046\u304b\uff1f\nMakefile \u5192\u982d\u306e\uff13\u884c\nCOMPILER = g++\n#COMPILER = mpicxx\nCFLAGS   = -std=c++11 -fno-exceptions -fno-rtti -Wextra -Ofast -MMD -MP -fopenmp\n\n\u3053\u306e\u3042\u305f\u308a\u3001\u95a2\u4fc2\u304c\u3042\u308b\u3093\u3058\u3083\u306a\u3044\u3060\u308d\u3046\u304b\uff1f\n# g++ -std=c++11 tamesi28.cpp\n\n\u5b9f\u884c\u3067\u304d\u305f\u3088\u3046\u3060\u3002\n# ls\na.out  tamesi28.cpp\n# ./a.out\n\n\n\u3088\u3057\u3001\u7121\u9650\u30eb\u30fc\u30d7\u3057\u3066\u3044\u308b\u3088\u3046\u3060\u3002\n[Ctrl]+[C]\n\u3067\u629c\u3051\u308b\u3002\n# ./a.out &\n[1] 21556\n\n\u3057\u307e\u3063\u305f\u3001\u30d5\u30a1\u30a4\u30eb\u540d\u304c\u691c\u7d22\u3057\u3065\u3089\u3044\u3002\n# ps aux | grep a.out\nroot     21556  0.0  0.0   4216   364 pts/3    S    05:22   0:00 ./a.out\nroot     21569  0.0  0.0  12936   988 pts/3    S+   05:22   0:00 grep --color=auto a.out\n\n\u52d5\u3044\u3066\u3044\u308b\u3088\u3046\u3060\u3002\n\u30ed\u30b0\u30a2\u30a6\u30c8\u3057\u3066\u307f\u308b\u3002\n# logout\n$ logout\n\n\u30ed\u30b0\u30a4\u30f3\u3057\u306a\u304a\u3059\u3002\n# ps aux | grep a.out\nroot     21556  0.0  0.0   4216   364 ?        S    05:22   0:00 ./a.out\nroot     21658  0.0  0.0  12936   984 pts/4    S+   05:25   0:00 grep --color=auto a.out\n\n\u3075\u3064\u3046\u306b\u5c45\u308b\u306a\u2026\u2026\u3002\n\u3058\u3083\u3042\u3001C++ \u306f\u30d7\u30ed\u30bb\u30b9\u9593\u901a\u4fe1\u3067\u304d\u308b\u306e\u304b\u8abf\u3079\u3066\u307f\u3088\u3046\u3002\n\u300cRabbitMQ Tutorials\u300d \uff08RabbitMQ\uff09\nhttp://www.rabbitmq.com/getstarted.html\n\u3046\u30fc\u3093\uff1f RabbitMQ \u306b C++ \u306e\u8aac\u660e\u304c\u7121\u3044\uff1f\n\u300cClients & Developer Tools\u300d \uff08RabbitMQ\uff09\nhttps://www.rabbitmq.com/devtools.html\n\uff14\u3064\u3042\u308b\u3088\u3046\u3060\u304c\u3001\n\u300cAMQP-CPP\u300d \uff08CopernicaMarketingSoftware/AMQP-CPP\uff09\nhttps://github.com/CopernicaMarketingSoftware/AMQP-CPP\n\u30b5\u30f3\u30d7\u30eb\u304c\u66f8\u3044\u3066\u3042\u308b\u3053\u308c\u3092\u8abf\u3079\u3066\u307f\u308b\u304b\u3002\nAMQP-CPP-master \u3092 FileZilla\u3067\u30b3\u30d4\u30fc\u3002\u3053\u308c\u3001RabbitMQ \u3058\u3083\u306a\u304f\u3066\u3001RabbitMQ \u98a8\u306b\u3057\u305f AMQP \u3060\u3088\u306a\u3002\ncd /home/\u2605user/shogi/AMQP-CPP-master\ncd AMQP-CPP-master\n# nano Makefile\n\n\u3058\u3083\u3042\u3001\n# make pure\n\n# ls\namqpcpp.h       include  Makefile   set_cxx_norm.cmake  tests\nCMakeLists.txt  LICENSE  README.md  src\n\n\u5b9f\u884c\u30d5\u30a1\u30a4\u30eb\u306f\u3069\u3053\u306b\u4f5c\u3089\u308c\u305f\u306e\u304b\uff1f\u3000\u3042\u308b\u3044\u306f\u30e9\u30a4\u30d6\u30e9\u30ea\u306f\u3069\u3053\u3060\u3002\n# make\n# make install\n# make pure\nmake -C src pure\nmake[1]: Entering directory '/home/\u2605user/shogi/AMQP-CPP-master/src'\nmake[1]: Nothing to be done for 'pure'.\nmake[1]: Leaving directory '/home/\u2605user/shogi/AMQP-CPP-master/src'\n\n\u3046\u30fc\u3093\u3002 src \u30d5\u30a9\u30eb\u30c0\u30fc\u306e\u4e2d\u3092\u898b\u308c\u3070\u3044\u3044\u306e\u304b\uff1f\n\u5b9f\u884c\u5f62\u5f0f\u306e\u30d5\u30a1\u30a4\u30eb\u304c\uff11\u3064\u3060\u3051\u3042\u308b\u3002\nlibamqpcpp.so.2.6.2\n\u3053\u308c\u3092\u3069\u3046\u3084\u3063\u3066\u4f7f\u3046\u306e\u304b\uff1f\n\u30b5\u30f3\u30d7\u30eb\u30fb\u30d7\u30ed\u30b0\u30e9\u30e0\u306f\u3053\u3053\u3060\u308d\u3046\u304b\uff1f\n\u300camqpcpp/examples/\u300d \uff08akalend/amqpcpp\uff09\nhttps://github.com/akalend/amqpcpp/tree/master/examples\nsrc\u30d5\u30a9\u30eb\u30c0\u30fc\u306e\u4e2d\u306b\u3082 Makefile \u304c\u3042\u308b\u306a\u3002\n/home/\u2605user/shogi/AMQP-CPP-master/src# make pure\n\nlib.so. \u3068\u3044\u3046\u5b9f\u884c\u5f62\u5f0f\u30d5\u30a1\u30a4\u30eb\u304c\u3067\u304d\u305f\u3088\u3046\u3060\u304c\u3001\u306a\u3093\u306e\u3053\u3068\u3084\u3089\u3002\nroot@\u2605:/home/\u2605user/shogi/AMQP-CPP-master# make pure\nmake -C src pure\nmake[1]: Entering directory '/home/\u2605user/shogi/AMQP-CPP-master/src'\nmake[1]: Nothing to be done for 'pure'.\nmake[1]: Leaving directory '/home/\u2605user/shogi/AMQP-CPP-master/src'\nroot@\u2605:/home/\u2605user/shogi/AMQP-CPP-master# make install\nmkdir -p /usr/include/amqpcpp\nmkdir -p /usr/lib\ncp -f amqpcpp.h /usr/include\ncp -f include/*.h /usr/include/amqpcpp\ncp -f src/libamqpcpp.so.2.6.2 /usr/lib\ncp -f src/libamqpcpp.a.2.6.2 /usr/lib\nln -r -s -f /usr/lib/libamqpcpp.so.2.6.2 /usr/lib/libamqpcpp.so.2.6\nln -r -s -f /usr/lib/libamqpcpp.so.2.6.2 /usr/lib/libamqpcpp.so\nln -r -s -f /usr/lib/libamqpcpp.a.2.6.2 /usr/lib/libamqpcpp.a\n\n\u3082\u3046\u3001\u4f7f\u3048\u308b\u3088\u3046\u306b\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\u3057\u3066\u304f\u308c\u3066\u308b\u3093\u3058\u3083\u306a\u3044\u304b\uff1f /usr/lib \u306b\u3002\n\u3058\u3083\u3042\u3001\u30bd\u30fc\u30b9\u3092\u66f8\u3044\u3066\u307f\u3088\u3046\u3002\n/home/\u2605user/shogi/cpp_service# nano tamesi29a7_main.cpp\n\ntamesi29a7_main.cpp\n#include <ev.h>\n#include <amqpcpp.h>\n#include <amqpcpp/libev.h>\n\nint main()\n{\n    // access to the event loop\n    auto *loop = EV_DEFAULT;\n\n    // handler for libev (so we don't have to implement AMQP::TcpHandler!)\n    AMQP::LibEvHandler handler(loop);\n\n    // make a connection\n    AMQP::TcpConnection connection(&handler, AMQP::Address(\"amqp://localhost/\"));\n\n    // we need a channel too\n    AMQP::TcpChannel channel(&connection);\n\n    // create a temporary queue\n    channel.declareQueue(AMQP::exclusive).onSuccess([&connection](const std::string &name, uint32_t messagecount, uint32_t consumercount) {\n\n        // report the name of the temporary queue\n        std::cout << \"declared queue \" << name << std::endl;\n\n        // now we can close the connection\n        connection.close();\n    });\n\n    // run the loop\n    ev_run(loop, 0);\n\n    // done\n    return 0;\n}\n\n# g++ tamesi29a7_main.cpp\ntamesi29a7_main.cpp:1:16: fatal error: ev.h: No such file or directory\ncompilation terminated.\n\n\u9055\u3046\u306e\u304b\u3002\n\nlibev\n\u300clibev\u306eev_async\u3068\u306f\u4f55\u306b\u4f7f\u7528\u3059\u308b\u3082\u306e\u3067\u3059\u304b\uff1f\u300d \uff08stack overflow\uff09\nhttp://ja.stackoverflow.com/questions/9066/libev%E3%81%AEev-async%E3%81%A8%E3%81%AF%E4%BD%95%E3%81%AB%E4%BD%BF%E7%94%A8%E3%81%99%E3%82%8B%E3%82%82%E3%81%AE%E3%81%A7%E3%81%99%E3%81%8B\nev\u30e9\u30a4\u30d6\u30e9\u30ea\u30fc\u3068\u3044\u3046\u306e\u304c\u3042\u308b\u306e\u304b\u3002\n\u300clibev\u306b\u3088\u308b\u975e\u540c\u671f\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u300d\uff08Qiita\uff09\nhttp://qiita.com/0xfffffff7/items/c5287067623fdbd2c3cb\n\u3058\u3083\u3042\u3001\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u3066\u307f\u3088\u3002\n# apt-get -y install libev\nReading package lists... Done\nBuilding dependency tree\nReading state information... Done\nE: Unable to locate package libev\n\n\u305d\u3093\u306a\u30b3\u30de\u30f3\u30c9\u306f\u7121\u3044\u306e\u304b\u2026\u2026\u3002\n\u300cHow to install libev-dev on Ubuntu 14.04 (Trusty Tahr)\u300d\uff08HOW TO INSTALL\uff09\nhttps://www.howtoinstall.co/en/ubuntu/trusty/libev-dev\nsudo apt-get update\nsudo apt-get install libev-dev\n\n\u5165\u3063\u305f\u304b\u306a\u3002\n# g++ tamesi29a7_main.cpp\n\n\u5927\u91cf\u306e\u30a8\u30e9\u30fc\u304c\u51fa\u3066\u304d\u305f\u3002\u3053\u3046\u304b\uff1f\n# g++ -std=c++11 tamesi29a7_main.cpp\n\n/tmp/ccMfSVKb.o: In function `main':\ntamesi29a7_main.cpp:(.text+0x18f): undefined reference to `ev_default_loop'\ntamesi29a7_main.cpp:(.text+0x1e3): undefined reference to `AMQP::TcpConnection::TcpConnection(AMQP::TcpHandler*, AMQP::Address const&)'\ntamesi29a7_main.cpp:(.text+0x22d): undefined reference to `AMQP::exclusive'\ntamesi29a7_main.cpp:(.text+0x276): undefined reference to `ev_run'\n/tmp/ccMfSVKb.o: In function `AMQP::Field::~Field()':\ntamesi29a7_main.cpp:(.text._ZN4AMQP5FieldD2Ev[_ZN4AMQP5FieldD5Ev]+0xd): undefined reference to `vtable for AMQP::Field'\n/tmp/ccMfSVKb.o: In function `AMQP::Field::Field()':\ntamesi29a7_main.cpp:(.text._ZN4AMQP5FieldC2Ev[_ZN4AMQP5FieldC5Ev]+0x9): undefined reference to `vtable for AMQP::Field'\n/tmp/ccMfSVKb.o: In function `AMQP::Table::Table()':\ntamesi29a7_main.cpp:(.text._ZN4AMQP5TableC2Ev[_ZN4AMQP5TableC5Ev]+0x19): undefined reference to `vtable for AMQP::Table'\n/tmp/ccMfSVKb.o: In function `AMQP::Table::~Table()':\ntamesi29a7_main.cpp:(.text._ZN4AMQP5TableD2Ev[_ZN4AMQP5TableD5Ev]+0xd): undefined reference to `vtable for AMQP::Table'\n/tmp/ccMfSVKb.o: In function `AMQP::Channel::Channel(AMQP::Connection*)':\ntamesi29a7_main.cpp:(.text._ZN4AMQP7ChannelC2EPNS_10ConnectionE[_ZN4AMQP7ChannelC5EPNS_10ConnectionE]+0x30): undefined reference to `AMQP::ChannelImpl::ChannelImpl()'\ntamesi29a7_main.cpp:(.text._ZN4AMQP7ChannelC2EPNS_10ConnectionE[_ZN4AMQP7ChannelC5EPNS_10ConnectionE]+0x65): undefined reference to `AMQP::ChannelImpl::attach(AMQP::Connection*)'\n/tmp/ccMfSVKb.o: In function `AMQP::Channel::~Channel()':\ntamesi29a7_main.cpp:(.text._ZN4AMQP7ChannelD2Ev[_ZN4AMQP7ChannelD5Ev]+0x2c): undefined reference to `AMQP::ChannelImpl::close()'\n/tmp/ccMfSVKb.o: In function `AMQP::Channel::declareQueue(int)':\ntamesi29a7_main.cpp:(.text._ZN4AMQP7Channel12declareQueueEi[_ZN4AMQP7Channel12declareQueueEi]+0x68): undefined reference to `AMQP::ChannelImpl::declareQueue(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int, AMQP::Table const&)'\n/tmp/ccMfSVKb.o: In function `AMQP::Connection::~Connection()':\ntamesi29a7_main.cpp:(.text._ZN4AMQP10ConnectionD2Ev[_ZN4AMQP10ConnectionD5Ev]+0x24): undefined reference to `AMQP::ConnectionImpl::~ConnectionImpl()'\n/tmp/ccMfSVKb.o: In function `AMQP::Connection::close()':\ntamesi29a7_main.cpp:(.text._ZN4AMQP10Connection5closeEv[_ZN4AMQP10Connection5closeEv]+0x18): undefined reference to `AMQP::ConnectionImpl::close()'\n/tmp/ccMfSVKb.o: In function `AMQP::TcpConnection::~TcpConnection()':\ntamesi29a7_main.cpp:(.text._ZN4AMQP13TcpConnectionD2Ev[_ZN4AMQP13TcpConnectionD5Ev]+0xd): undefined reference to `vtable for AMQP::TcpConnection'\ntamesi29a7_main.cpp:(.text._ZN4AMQP13TcpConnectionD2Ev[_ZN4AMQP13TcpConnectionD5Ev]+0x19): undefined reference to `vtable for AMQP::TcpConnection'\ntamesi29a7_main.cpp:(.text._ZN4AMQP13TcpConnectionD2Ev[_ZN4AMQP13TcpConnectionD5Ev]+0x51): undefined reference to `AMQP::Watchable::~Watchable()'\n/tmp/ccMfSVKb.o: In function `AMQP::LibEvHandler::Watcher::callback(ev_loop*, ev_io*, int)':\ntamesi29a7_main.cpp:(.text._ZN4AMQP12LibEvHandler7Watcher8callbackEP7ev_loopP5ev_ioi[_ZN4AMQP12LibEvHandler7Watcher8callbackEP7ev_loopP5ev_ioi]+0x33): undefined reference to `AMQP::TcpConnection::process(int, int)'\n/tmp/ccMfSVKb.o: In function `AMQP::LibEvHandler::Watcher::Watcher(ev_loop*, AMQP::TcpConnection*, int, int)':\ntamesi29a7_main.cpp:(.text._ZN4AMQP12LibEvHandler7WatcherC2EP7ev_loopPNS_13TcpConnectionEii[_ZN4AMQP12LibEvHandler7WatcherC5EP7ev_loopPNS_13TcpConnectionEii]+0xbf): undefined reference to `ev_io_start'\n/tmp/ccMfSVKb.o: In function `AMQP::LibEvHandler::Watcher::~Watcher()':\ntamesi29a7_main.cpp:(.text._ZN4AMQP12LibEvHandler7WatcherD2Ev[_ZN4AMQP12LibEvHandler7WatcherD5Ev]+0x2f): undefined reference to `ev_io_stop'\n/tmp/ccMfSVKb.o: In function `AMQP::LibEvHandler::Watcher::events(int)':\ntamesi29a7_main.cpp:(.text._ZN4AMQP12LibEvHandler7Watcher6eventsEi[_ZN4AMQP12LibEvHandler7Watcher6eventsEi]+0x26): undefined reference to `ev_io_stop'\ntamesi29a7_main.cpp:(.text._ZN4AMQP12LibEvHandler7Watcher6eventsEi[_ZN4AMQP12LibEvHandler7Watcher6eventsEi]+0x5d): undefined reference to `ev_io_start'\ncollect2: error: ld returned 1 exit status\n\n\u3069\u3046\u3057\u305f\u3082\u306e\u304b\u3002\n\u300cc libev undefined reference to `ev_default_loop'\u300d \uff08stack overflow\uff09\nhttp://stackoverflow.com/questions/13844309/c-libev-undefined-reference-to-ev-default-loop\n\u300c-lev\u300d\u3068\u3044\u3046\u30aa\u30d7\u30b7\u30e7\u30f3\u3092\u4ed8\u3051\u305f\u3089\u3044\u3044\u306e\u3060\u308d\u3046\u304b\uff1f\n# g++ -std=c++11 tamesi29a7_main.cpp -lev\n\n/tmp/ccbptlAj.o: In function `main':\ntamesi29a7_main.cpp:(.text+0x1e3): undefined reference to `AMQP::TcpConnection::TcpConnection(AMQP::TcpHandler*, AMQP::Address const&)'\ntamesi29a7_main.cpp:(.text+0x22d): undefined reference to `AMQP::exclusive'\n/tmp/ccbptlAj.o: In function `AMQP::Field::~Field()':\ntamesi29a7_main.cpp:(.text._ZN4AMQP5FieldD2Ev[_ZN4AMQP5FieldD5Ev]+0xd): undefined reference to `vtable for AMQP::Field'\n/tmp/ccbptlAj.o: In function `AMQP::Field::Field()':\ntamesi29a7_main.cpp:(.text._ZN4AMQP5FieldC2Ev[_ZN4AMQP5FieldC5Ev]+0x9): undefined reference to `vtable for AMQP::Field'\n/tmp/ccbptlAj.o: In function `AMQP::Table::Table()':\ntamesi29a7_main.cpp:(.text._ZN4AMQP5TableC2Ev[_ZN4AMQP5TableC5Ev]+0x19): undefined reference to `vtable for AMQP::Table'\n/tmp/ccbptlAj.o: In function `AMQP::Table::~Table()':\ntamesi29a7_main.cpp:(.text._ZN4AMQP5TableD2Ev[_ZN4AMQP5TableD5Ev]+0xd): undefined reference to `vtable for AMQP::Table'\n/tmp/ccbptlAj.o: In function `AMQP::Channel::Channel(AMQP::Connection*)':\ntamesi29a7_main.cpp:(.text._ZN4AMQP7ChannelC2EPNS_10ConnectionE[_ZN4AMQP7ChannelC5EPNS_10ConnectionE]+0x30): undefined reference to `AMQP::ChannelImpl::ChannelImpl()'\ntamesi29a7_main.cpp:(.text._ZN4AMQP7ChannelC2EPNS_10ConnectionE[_ZN4AMQP7ChannelC5EPNS_10ConnectionE]+0x65): undefined reference to `AMQP::ChannelImpl::attach(AMQP::Connection*)'\n/tmp/ccbptlAj.o: In function `AMQP::Channel::~Channel()':\ntamesi29a7_main.cpp:(.text._ZN4AMQP7ChannelD2Ev[_ZN4AMQP7ChannelD5Ev]+0x2c): undefined reference to `AMQP::ChannelImpl::close()'\n/tmp/ccbptlAj.o: In function `AMQP::Channel::declareQueue(int)':\ntamesi29a7_main.cpp:(.text._ZN4AMQP7Channel12declareQueueEi[_ZN4AMQP7Channel12declareQueueEi]+0x68): undefined reference to `AMQP::ChannelImpl::declareQueue(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int, AMQP::Table const&)'\n/tmp/ccbptlAj.o: In function `AMQP::Connection::~Connection()':\ntamesi29a7_main.cpp:(.text._ZN4AMQP10ConnectionD2Ev[_ZN4AMQP10ConnectionD5Ev]+0x24): undefined reference to `AMQP::ConnectionImpl::~ConnectionImpl()'\n/tmp/ccbptlAj.o: In function `AMQP::Connection::close()':\ntamesi29a7_main.cpp:(.text._ZN4AMQP10Connection5closeEv[_ZN4AMQP10Connection5closeEv]+0x18): undefined reference to `AMQP::ConnectionImpl::close()'\n/tmp/ccbptlAj.o: In function `AMQP::TcpConnection::~TcpConnection()':\ntamesi29a7_main.cpp:(.text._ZN4AMQP13TcpConnectionD2Ev[_ZN4AMQP13TcpConnectionD5Ev]+0xd): undefined reference to `vtable for AMQP::TcpConnection'\ntamesi29a7_main.cpp:(.text._ZN4AMQP13TcpConnectionD2Ev[_ZN4AMQP13TcpConnectionD5Ev]+0x19): undefined reference to `vtable for AMQP::TcpConnection'\ntamesi29a7_main.cpp:(.text._ZN4AMQP13TcpConnectionD2Ev[_ZN4AMQP13TcpConnectionD5Ev]+0x51): undefined reference to `AMQP::Watchable::~Watchable()'\n/tmp/ccbptlAj.o: In function `AMQP::LibEvHandler::Watcher::callback(ev_loop*, ev_io*, int)':\ntamesi29a7_main.cpp:(.text._ZN4AMQP12LibEvHandler7Watcher8callbackEP7ev_loopP5ev_ioi[_ZN4AMQP12LibEvHandler7Watcher8callbackEP7ev_loopP5ev_ioi]+0x33): undefined reference to `AMQP::TcpConnection::process(int, int)'\ncollect2: error: ld returned 1 exit status\n\n\u30a8\u30e9\u30fc\u306f\u6e1b\u3063\u305f\u3060\u308d\u3046\u304b\u3002\n\u300cBuild against rabbitmq-c\u300d\uff08stack overflow\uff09\nhttp://stackoverflow.com/questions/12028112/build-against-rabbitmq-c\nGit Hub \u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u306e\u8aac\u660e\u3092\u8aad\u3080\u3068\u3001\u30e9\u30a4\u30d6\u30e9\u30ea\u3068\u30ea\u30f3\u30af\u3057\u3066\u304f\u3060\u3055\u3044\u3001\u3068\u66f8\u3044\u3066\u3044\u308b\u306a\u3002\u3053\u3046\u304b\u3002\n# g++ -std=c++11 tamesi29a7_main.cpp -lev -lamqpcpp\n\n/usr/lib/gcc/x86_64-linux-gnu/5/../../../../lib/libamqpcpp.so: undefined reference to `pthread_create'\ncollect2: error: ld returned 1 exit status\n\n\u306a\u3093\u3060\u308d\u3046\uff1f\n\u300cUndefined reference to pthread_create in Linux\u300d\uff08stack overflow\uff09\nhttp://stackoverflow.com/questions/1662909/undefined-reference-to-pthread-create-in-linux\n\u300c-pthread\u300d\u3082\u4ed8\u3051\u305f\u3089\u3044\u3044\u3093\u3060\u308d\u3046\u304b\uff1f\n# g++ -std=c++11 tamesi29a7_main.cpp -lev -lamqpcpp -pthread\n\n\u30b3\u30f3\u30d1\u30a4\u30eb\u306f\u901a\u3063\u305f\u3088\u3046\u3060\u3002\u5b9f\u884c\u30d5\u30a1\u30a4\u30eb\u306e\u540d\u524d\u304c a.out \u306b\u306a\u3063\u3066\u308b\u304c\u2026\u2026\u3002\u3053\u3046\u304b\u3002\n# g++ -std=c++11 tamesi29a7_main.cpp -lev -lamqpcpp -pthread -o tamesi29a7_main.exe\n\n\u3088\u3057\u3001tamesi29a7_main.exe \u3068\u3044\u3046\u30d5\u30a1\u30a4\u30eb\u304c\u3067\u3051\u305f\u3002\n# ./tamesi29a7_main.exe\ndeclared queue amq.gen-R8_7pGx8GdY5EmtcMddvzQ\n\n\u306a\u3093\u306e\u3053\u3063\u3061\u3083\u3002\n\u591a\u5206\u3001\u30ad\u30e5\u30fc\u306e\u540d\u524d\u3067\u3082\u53d6\u5f97\u3057\u305f\u3093\u3060\u308d\u3046\u304b\uff1f\n# rabbitmqctl list_queues\nListing queues ...\n1111    0\n\n\u3046\u30fc\u3080\u3002\n\u300camqpcpp/examples/example_consume.cpp\u300d\uff08akalend/amqpcpp\uff09\nhttps://github.com/akalend/amqpcpp/blob/master/examples/example_consume.cpp\n\u3053\u308c\u3092\u8a66\u3057\u3066\u307f\u3088\u3046\u3002\ntamesi29a8_example_consume.cpp\n#include \"AMQPcpp.h\"\n\nusing namespace std;\n\nint i=0;\n\nint onCancel(AMQPMessage * message ) {\n    cout << \"cancel tag=\"<< message->getDeliveryTag() << endl;\n    return 0;\n}\n\nint  onMessage( AMQPMessage * message  ) {\n    uint32_t j = 0;\n    char * data = message->getMessage(&j);\n    if (data)\n          cout << data << endl;\n\n    i++;\n\n    cout << \"#\" << i << \" tag=\"<< message->getDeliveryTag() << \" content-type:\"<< message->getHeader(\"Content-type\") ;\n    cout << \" encoding:\"<< message->getHeader(\"Content-encoding\")<< \" mode=\"<<message->getHeader(\"Delivery-mode\")<<endl;\n\n    if (i > 10) {\n        AMQPQueue * q = message->getQueue();\n        q->Cancel( message->getConsumerTag() );\n    }\n    return 0;\n};\n\n\nint main () {\n\n\n    try {\n//      AMQP amqp(\"123123:akalend@localhost/private\");\n\n        AMQP amqp(\"123123:akalend@localhost:5673/private\");\n\n        AMQPQueue * qu2 = amqp.createQueue(\"q2\");\n\n        qu2->Declare();\n        qu2->Bind( \"e\", \"\");\n\n        qu2->setConsumerTag(\"tag_123\");\n        qu2->addEvent(AMQP_MESSAGE, onMessage );\n        qu2->addEvent(AMQP_CANCEL, onCancel );\n\n        qu2->Consume(AMQP_NOACK);//\n\n\n    } catch (AMQPException e) {\n        std::cout << e.getMessage() << std::endl;\n    }\n\n    return 0;\n\n}\n\n# g++ -std=c++11 tamesi29a8_example_consume.cpp -lev -lamqpcpp -pthread -o tamesi29a8_example_consume.exe\ntamesi29a8_example_consume.cpp:1:21: fatal error: AMQPcpp.h: No such file or directory\ncompilation terminated.\n\n\u306a\u3093\u306e\u53c2\u8003\u306b\u3082\u306a\u3089\u306a\u3044\u30bd\u30fc\u30b9\u3060\u3063\u305f\u304b\u3002\n# ./tamesi29a7_main.exe\ndeclared queue amq.gen-0n2SmfNgiVabWrTBjd5F3w\n# ./tamesi29a7_main.exe\ndeclared queue amq.gen-MRpMMZ2dX3VRK-HVAJV62w\n# ./tamesi29a7_main.exe\ndeclared queue amq.gen-wCRRD2i98lE52gR8nHjaxw\n\n\u3053\u306e name \u306f\u4f55\u306a\u3093\u3060\u308d\u306a\u3002\n\u300cFLAGS AND TABLES\u300d\uff08CopernicaMarketingSoftware/AMQP-CPP\uff09\nhttps://github.com/CopernicaMarketingSoftware/AMQP-CPP\n\u8aac\u660e\u3092\u8aad\u3093\u3067\u6539\u9020\u3057\u3066\u307f\u308b\u3002\ntamesi29a7_main.cpp\n#include <ev.h>\n#include <amqpcpp.h>\n#include <amqpcpp/libev.h>\n\nint main()\n{\n    // access to the event loop\n    auto *loop = EV_DEFAULT;\n\n    // handler for libev (so we don't have to implement AMQP::TcpHandler!)\n    AMQP::LibEvHandler handler(loop);\n\n    // make a connection\n    AMQP::TcpConnection connection(&handler, AMQP::Address(\"amqp://localhost/\"));\n\n    // we need a channel too\n    AMQP::TcpChannel channel(&connection);\n\n//    // create a temporary queue\n//    channel.declareQueue(AMQP::exclusive).onSuccess([&connection](const std::string &name, uint32_t messagecount, uint32_t consumercount) {\n//\n//        // report the name of the temporary queue\n//        std::cout << \"declared queue \" << name << std::endl;\n//\n//        // now we can close the connection\n//        connection.close();\n//    });\n    // create a custom callback\n    auto callback = [](const std::string &name, int msgcount, int consumercount) {\n\n        // @todo add your own implementation\n\n        // report the name of the temporary queue\n        std::cout << \"declared queue \" << name << std::endl;\n\n        // now we can close the connection\n        connection.close();\n    }\n\n    // declare the queue, and install the callback that is called on success\n    channel.declareQueue(\"1111\").onSuccess(callback);\n\n    // run the loop\n    ev_run(loop, 0);\n\n    // done\n    return 0;\n}\n\n# nano tamesi29a9_main.cpp\n# g++ -std=c++11 tamesi29a9_main.cpp -lev -lamqpcpp -pthread -o tamesi29a9_main.exe\n\ntamesi29a9_main.cpp: In lambda function:\ntamesi29a9_main.cpp:37:9: error: \u2018connection\u2019 is not captured\n         connection.close();\n         ^\ntamesi29a9_main.cpp:29:22: note: the lambda has no capture-default\n     auto callback = [](const std::string &name, int msgcount, int consumercount) {\n                      ^\ntamesi29a9_main.cpp:14:25: note: \u2018AMQP::TcpConnection connection\u2019 declared here\n     AMQP::TcpConnection connection(&handler, AMQP::Address(\"amqp://localhost/\"));\n                         ^\ntamesi29a9_main.cpp: In function \u2018int main()\u2019:\ntamesi29a9_main.cpp:41:5: error: expected \u2018,\u2019 or \u2018;\u2019 before \u2018channel\u2019\n     channel.declareQueue(\"1111\").onSuccess(callback);\n     ^\n\n\u3058\u3083\u3042\u3001\u3053\u3046\u3002\n        // connection.close();\n\n# g++ -std=c++11 tamesi29a9_main.cpp -lev -lamqpcpp -pthread -o tamesi29a9_main.exe\ntamesi29a9_main.cpp: In function \u2018int main()\u2019:\ntamesi29a9_main.cpp:41:5: error: expected \u2018,\u2019 or \u2018;\u2019 before \u2018channel\u2019\n     channel.declareQueue(\"1111\").onSuccess(callback);\n     ^\n\n\u30bb\u30df\u30b3\u30ed\u30f3\u8db3\u308a\u306a\u3044\u306e\u304b\u3001\u30b5\u30f3\u30d7\u30eb\u304b\u3089\u30b3\u30d4\u30fc\u3057\u305f\u306e\u306b\u3002\u3058\u3083\u3042\u8db3\u3059\u3002\n    };\n\n# g++ -std=c++11 tamesi29a9_main.cpp -lev -lamqpcpp -pthread -o tamesi29a9_main.exe\n\n\u30b3\u30f3\u30d1\u30a4\u30eb\u306f\u901a\u3063\u305f\u3002\u30bd\u30fc\u30b9\u306f\u3053\u3093\u306a\u611f\u3058\u3002\ntamesi29a9_main.cpp\n#include <ev.h>\n#include <amqpcpp.h>\n#include <amqpcpp/libev.h>\n\nint main()\n{\n    // access to the event loop\n    auto *loop = EV_DEFAULT;\n\n    // handler for libev (so we don't have to implement AMQP::TcpHandler!)\n    AMQP::LibEvHandler handler(loop);\n\n    // make a connection\n    AMQP::TcpConnection connection(&handler, AMQP::Address(\"amqp://localhost/\"));\n\n    // we need a channel too\n    AMQP::TcpChannel channel(&connection);\n\n//    // create a temporary queue\n//    channel.declareQueue(AMQP::exclusive).onSuccess([&connection](const std::string &name, uint32_t messagecount, uint32_t consumercount) {\n//\n//        // report the name of the temporary queue\n//        std::cout << \"declared queue \" << name << std::endl;\n//\n//        // now we can close the connection\n//        connection.close();\n//    });\n    // create a custom callback\n    auto callback = [](const std::string &name, int msgcount, int consumercount) {\n\n        // @todo add your own implementation\n\n        // report the name of the temporary queue\n        std::cout << \"declared queue \" << name << std::endl;\n\n        // now we can close the connection\n        // connection.close();\n    };\n\n    // declare the queue, and install the callback that is called on success\n    channel.declareQueue(\"1111\").onSuccess(callback);\n\n    // run the loop\n    ev_run(loop, 0);\n\n    // done\n    return 0;\n}\n\n# ./tamesi29a9_main.exe\ndeclared queue 1111\n\n\u306a\u3093\u304b\u5f85\u6a5f\u3057\u3066\u3044\u308b\u3002 \u305f\u3081\u3057\u3055\u3093\u30b7\u30ea\u30fc\u30ba \u3092\u4f7f\u3046\u304b\u3002\nhttp://\u2605.\u2605.\u2605.\u2605/tamesi5.php\nRabbitMQ \u3067\u3000\u30a8\u30f3\u30ad\u30e5\u30fc\u3059\u308b\u3000\u305f\u3081\u3057\u3055\u3093\u3000\u3060\u3002\n[x] Sent 'Flying Dragon!'\n\n\u3068\u304f\u306b\u5909\u5316\u306f\u306a\u3044\u3002\n^Z\n[1]+  Stopped                 ./tamesi29a9_main.exe\n# bg 1\n[1]+ ./tamesi29a9_main.exe &\n\n\u3046\u30fc\u3080\u3002\n# jobs\n[1]+  Running                 ./tamesi29a9_main.exe &\n\n\u3046\u30fc\u3080\u3002\u30d5\u30a1\u30df\u30b3\u30f3\u306e\u3000\u3055\u3093\u307e\u306e\u540d\u63a2\u5075\u3000\u3092\u904a\u3093\u3067\u3044\u305f\u3068\u304d\u306e\u6c17\u5206\u306b\u4f3c\u3066\u3044\u308b\u3002\nls\ntamesi28.d  tamesi29a7_main.cpp  tamesi29a7_main.exe  tamesi29a8_example_consume.cpp  tamesi29a9_main.cpp  tamesi29a9_main.exe\n\n\u4f55\u304b\u304c\u51fa\u529b\u3055\u308c\u3066\u3044\u308b\u69d8\u5b50\u3082\u306a\u3044\u3002\n# rabbitmqctl list_queues\nListing queues ...\n1111    0\n\n\u305d\u3082\u305d\u3082\u3000\u30ad\u30e5\u30fc\u3000\u304c\u7a7a\u3067\u306f\u3002\n# rabbitmqctl list_consumers\nListing consumers ...\n1111    <rabbit@\u2605> amq.ctag-ztANwsUVbqTvGhE7rnXh6w false   0       []\n1111    <rabbit@\u2605> amq.ctag-w-yJ9Fb8Ksb5HY0QX3iRAg false   0       []\n1111    <rabbit@\u2605> amq.ctag-xb6boiuc_Ee1girva-GdkQ false   0       []\n1111    <rabbit@\u2605> amq.ctag-jV7AUun3pc-FyFcK9M_Owg false   0       []\n1111    <rabbit@\u2605>  amq.ctag-Jdt5oPqW4mtCerlx8dUIOw false   0       []\n1111    <rabbit@\u2605> amq.ctag-55NHUikpOIFTxgxOEcipsg false   0       []\n\n\u30b3\u30f3\u30b7\u30e5\u30fc\u30de\u30fc\u306f\u3000\u3044\u3063\u3071\u3044\u3044\u308b\u306e\u306b\u306a\u3002\u3058\u3083\u3042\u3001\u3053\u3044\u3064\u3089\u304c\u53d6\u308a\u5408\u3063\u3066\u308b\u306a\u3093\u3066\u3053\u3068\u304c\u3042\u308b\u306e\u3060\u308d\u3046\u304b\uff1f\n# ps aux | grep rabbit\nroot     12122  0.0  0.0   4500     0 ?        S    Mar07   0:00 /bin/sh /usr/sbin/rabbitmq-server\nroot     12129  0.0  0.0  55128     0 ?        S    Mar07   0:00 su rabbitmq -s /bin/sh -c /usr/lib/rabbitmq/bin/rabbitmq-server\nrabbitmq 12130  0.0  0.0   4500     8 ?        Ss   Mar07   0:00 sh -c /usr/lib/rabbitmq/bin/rabbitmq-server\nrabbitmq 12131  0.0  0.0   4500     0 ?        S    Mar07   0:00 /bin/sh -e /usr/lib/rabbitmq/bin/rabbitmq-server\nrabbitmq 12237  0.6  2.6 2712560 27192 ?       Sl   Mar07  27:01 /usr/lib/erlang/erts-8.1/bin/beam.smp -W w -A 64 -P 1048576 -t 5000000 -stbt db -zdbbl 32000 -K true -B i -- -root /usr/lib/erlang -progname erl -- -home /var/lib/rabbitmq -- -pa /usr/lib/rabbitmq/lib/rabbitmq_server-3.6.6/ebin -noshell -noinput -s rabbit boot -sname rabbit@\u2605 -boot start_sasl -kernel inet_default_connect_options [{nodelay,true}] -sasl errlog_type error -sasl sasl_error_logger false -rabbit error_logger {file,\"/var/log/rabbitmq/rabbit@\u2605.log\"} -rabbit sasl_error_logger {file,\"/var/log/rabbitmq/rabbit@\u2605-sasl.log\"} -rabbit enabled_plugins_file \"/etc/rabbitmq/enabled_plugins\" -rabbit plugins_dir \"/usr/lib/rabbitmq/lib/rabbitmq_server-3.6.6/plugins\" -rabbit plugins_expand_dir \"/var/lib/rabbitmq/mnesia/rabbit@\u2605-plugins-expand\" -os_mon start_cpu_sup false -os_mon start_disksup false -os_mon start_memsup false -mnesia dir \"/var/lib/rabbitmq/mnesia/rabbit@\u2605\" -kernel inet_dist_listen_min 25672 -kernel inet_dist_listen_max 25672\nrabbitmq 12333  0.0  0.0   4356    72 ?        Ss   Mar07   0:18 erl_child_setup 1024\nrabbitmq 12343  0.0  0.0  13676    36 ?        Ss   Mar07   0:00 inet_gethost 4\nrabbitmq 12344  0.0  0.0  15796   228 ?        S    Mar07   0:01 inet_gethost 4\nroot     27067  0.0  0.0  12936   988 pts/4    S+   08:07   0:00 grep --color=auto rabbit\nrabbitmq 27670  0.0  0.0  13848   252 ?        S    Mar06   0:11 /usr/lib/erlang/erts-8.1/bin/epmd -daemon\n\n\u3046\u30fc\u3080\u3002\n\u3082\u3057\u304b\u3057\u3066\u3002\n/home/\u2605user/shogi/php_log# ls -an\ntotal 8\ndrwxr-xr-x  2 0 0 4096 Mar  8 09:50 .\ndrwxr-xrwx 20 0 0 4096 Mar 10 06:04 ..\n-rw-r--r--  1 0 0    0 Mar 10 08:05 dequeueBroker.err.log\n-rw-r--r--  1 0 0    0 Mar 10 08:05 dequeueBroker.out.log\n\n\u66f4\u65b0\u6642\u523b\u304c\u66f4\u65b0\u3055\u308c\u3066\u3044\u308b\u3002\n\u3060\u304c\u4e2d\u8eab\u306f\u7a7a\u3063\u307d\u3060\u3063\u305f\u3002\n# ps aux | grep dequeueBroker.php\nroot     20224  0.0  1.3 232308 14060 ?        S    04:05   0:01 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot     21242  0.0  1.3 232308 14060 ?        S    05:05   0:00 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot     22336  0.0  1.3 232308 14056 ?        S    06:05   0:00 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot     25095  0.0  1.3 232308 14044 ?        S    07:05   0:00 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot     26770  0.0  1.3 232308 14040 ?        S    08:05   0:00 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot     27318  0.0  0.0  13068   988 pts/4    S+   08:19   0:00 grep --color=auto dequeueBroker.php\n\n\u306a\u3093\u304b 5\u5206 \u306b dequeueBroker.php \u304c\u5897\u3048\u3066\u306a\u3044\u304b\u3002\n\u3053\u3093\u306a\u3053\u3068\u304c\u3067\u304d\u308b\u306e\u306f Cron \u3060\u308d\u3046\u3002\n# sudo crontab -e\n\n# Edit this file to introduce tasks to be run by cron.\n#\n# Each task to run has to be defined through a single line\n# indicating with different fields when the task will be run\n# and what command to run for the task\n#\n# To define the time you can provide concrete values for\n# minute (m), hour (h), day of month (dom), month (mon),\n# and day of week (dow) or use '*' in these fields (for 'any').#\n# Notice that tasks will be started based on the cron's system\n# daemon's notion of time and timezones.\n#\n# Output of the crontab jobs (including errors) is sent through\n# email to the user the crontab file belongs to (unless redirected).\n#\n# For example, you can run a backup of all your user accounts\n# at 5 a.m every week with:\n# 0 5 * * 1 tar -zcf /var/backups/home.tgz /home/\n#\n# For more information see the manual pages of crontab(5) and cron(8)\n#\n# m h  dom mon dow   command\n#0-59/30 * * * * /bin/bash /home/\u2605user/shogi/bash_service/tamesi12.sh\n5 * * * * /bin/bash /home/\u2605user/shogi/bash_service/kicker_dequeueBroker.sh\n\n\u307b\u3089\u3001\u3044\u305f\u3002\u30b3\u30e1\u30f3\u30c8\u30a2\u30a6\u30c8\u3057\u3068\u3053\u3002\n\u30d7\u30ed\u30bb\u30b9\u3082\u843d\u3068\u3057\u3068\u3053\u3002\nkill `ps aux | grep dequeueBroker.php | sed 's/[\\t ]\\+/\\t/g' | cut -f 2`\n# ps aux | grep dequeueBroker.php\nroot     27385  0.0  0.0  12936   988 pts/4    S+   08:23   0:00 grep --color=auto dequeueBroker.php\n\n\u3082\u3046\uff11\u56de\u3002\u4eca\u5ea6\u306f\u3000\u305f\u3081\u3057\u3055\u3093\uff11\uff14\u3067\u30a8\u30f3\u30ad\u30e5\u30fc\u3002\nhttp://\u2605.\u2605.\u2605.\u2605/tamesi14.php\n\u3042\u3063\u3001\u305f\u3081\u3057\u3055\u3093\uff11\uff14\u306b\u30d0\u30b0\u304c\u3042\u308b\u3002\u76f4\u305d\u3046\u3002\n\u3068\u601d\u3063\u305f\u3089\u3000\u30d0\u30b0\u306f\u7121\u304b\u3063\u305f\u306e\u3067\u3000\u76f4\u3055\u306a\u304b\u3063\u305f\u3002\n# rabbitmqctl list_queues\nListing queues ...\n1111    0\n\n\u30a8\u30f3\u30ad\u30e5\u30fc\u3055\u308c\u3066\u306a\u3044\u3002\nchmod 666 dequeueBroker.err.log\nchmod 666 dequeueBroker.out.log\n\n\nRabbitMQ\u518d\u8d77\u52d5\n\u4ee3\u308f\u308a\u7121\u3057\u3002\u3058\u3083\u3042 RabbitMQ \u3092\u518d\u8d77\u52d5\u3057\u3066\u307f\u308b\u3002\n# rabbitmqctl stop\nStopping and halting node 'rabbit@\u2605' ...\n[1]+  Done                    ./tamesi29a9_main.exe  (wd: /home/\u2605user/shogi/cpp_service)\n(wd now: /var/www/html)\n# rabbitmq-server\n\n              RabbitMQ 3.6.6. Copyright (C) 2007-2016 Pivotal Software, Inc.\n  ##  ##      Licensed under the MPL.  See http://www.rabbitmq.com/\n  ##  ##\n  ##########  Logs: /var/log/rabbitmq/rabbit@tk2-217-18401.log\n  ######  ##        /var/log/rabbitmq/rabbit@tk2-217-18401-sasl.log\n  ##########\n              Starting broker...\n completed with 0 plugins.\n\n\n[Ctrl]+[Z]\n# bg 1\n\n\u30ed\u30b0\u3092\u898b\u3066\u307f\u308b\u304b\u3002\ncd /var/log/rabbitmq\n\n\u3046\u30fc\u3093\u3002\n\u524d\u306f PHP\u306e\u30a8\u30f3\u30ad\u30e5\u30fc\u306f\u3000\u52d5\u3044\u3066\u3044\u305f\u3093\u3060\u304c\u3001\u4eca\u65e5\u306f\u52d5\u304b\u306a\u3044\u3088\u3046\u3060\u3002\n\u4e00\u5fdc\u3001\u305f\u3081\u3057\u3055\u3093\uff12\u3001\uff13\u3001\uff15\u3000\u3092\u53e9\u3044\u3066\u307f\u308b\u3002\n# rabbitmqctl list_queues\nListing queues ...\n1111    1\n\n\u3046\u30fc\u3093\uff1f\uff1f\n\u3058\u3083\u3042\u3001\u305f\u3081\u3057\u3055\u3093\uff12\u3000\u3092\u53e9\u3044\u3066\u307f\u308b\u3002\n\u5909\u308f\u3089\u306a\u3044\u3002\n\u3058\u3083\u3042\u3001\u305f\u3081\u3057\u3055\u3093\uff13\u3000\u3092\u53e9\u3044\u3066\u307f\u308b\u3002\n\u5909\u308f\u3089\u306a\u3044\u3002\n\u3058\u3083\u3042\u3001\u305f\u3081\u3057\u3055\u3093\uff15\u3000\u3092\u53e9\u3044\u3066\u307f\u308b\u3002\n# rabbitmqctl list_queues\nListing queues ...\n1111    2\n\n\u3058\u3083\u3042\u3001\u305f\u3081\u3057\u3055\u3093\uff11\uff14\u3000\u3092\u53e9\u3044\u3066\u307f\u308b\u3002\n# rabbitmqctl list_queues\nListing queues ...\n1111    3\n\n\u3068\u3044\u3046\u3053\u3068\u306f\u3001RabbitMQ \u306f\u52d5\u3044\u3066\u306a\u304b\u3063\u305f\u306e\u304b\u3002\u4eca\u306f\u30d0\u30c3\u30af\u30b0\u30e9\u30a6\u30f3\u30c9\u3067\u52d5\u3044\u3066\u3044\u308b\u304c\u3001\u3058\u3083\u3042\u3001\u30ed\u30b0\u30a2\u30a6\u30c8\u3057\u3066\u307f\u308b\u3002\n# logout\n$ logout\n\n\u518d\u5ea6\u30ed\u30b0\u30a4\u30f3\u3002\n# sudo su -\n\u203b\u30d1\u30b9\u30ef\u30fc\u30c9\u3092\u5165\u308c\u308b\n# jobs\n\n\u7a7a\u3063\u307d\u3060\u3002\n# ps aux | grep rabbit\nrabbitmq 27670  0.0  0.0  13848   252 ?        S    Mar06   0:12 /usr/lib/erlang/erts-8.1/bin/epmd -daemon\nroot     27924  0.0  0.0   4500   660 ?        S    08:33   0:00 /bin/sh /usr/sbin/rabbitmq-server\nroot     27931  0.0  0.1  55128  1820 ?        S    08:33   0:00 su rabbitmq -s /bin/sh -c /usr/lib/rabbitmq/bin/rabbitmq-server\nrabbitmq 27932  0.0  0.0   4500   656 ?        Ss   08:33   0:00 sh -c /usr/lib/rabbitmq/bin/rabbitmq-server\nrabbitmq 27933  0.0  0.0   4500   756 ?        S    08:33   0:00 /bin/sh -e /usr/lib/rabbitmq/bin/rabbitmq-server\nrabbitmq 28038  0.9  5.8 2698680 59836 ?       Sl   08:33   0:09 /usr/lib/erlang/erts-8.1/bin/beam.smp -W w -A 64 -P 1048576 -t 5000000 -stbt db -zdbbl 32000 -K true -B i -- -root /usr/lib/erlang -progname erl -- -home /var/lib/rabbitmq -- -pa /usr/lib/rabbitmq/lib/rabbitmq_server-3.6.6/ebin -noshell -noinput -s rabbit boot -sname rabbit@tk2-217-18401 -boot start_sasl -kernel inet_default_connect_options [{nodelay,true}] -sasl errlog_type error -sasl sasl_error_logger false -rabbit error_logger {file,\"/var/log/rabbitmq/rabbit@tk2-217-18401.log\"} -rabbit sasl_error_logger {file,\"/var/log/rabbitmq/rabbit@tk2-217-18401-sasl.log\"} -rabbit enabled_plugins_file \"/etc/rabbitmq/enabled_plugins\" -rabbit plugins_dir \"/usr/lib/rabbitmq/lib/rabbitmq_server-3.6.6/plugins\" -rabbit plugins_expand_dir \"/var/lib/rabbitmq/mnesia/rabbit@tk2-217-18401-plugins-expand\" -os_mon start_cpu_sup false -os_mon start_disksup false -os_mon start_memsup false -mnesia dir \"/var/lib/rabbitmq/mnesia/rabbit@tk2-217-18401\" -kernel inet_dist_listen_min 25672 -kernel inet_dist_listen_max 25672\nrabbitmq 28135  0.0  0.0   4356   524 ?        Ss   08:33   0:00 erl_child_setup 1024\nrabbitmq 28145  0.0  0.0  13676   468 ?        Ss   08:33   0:00 inet_gethost 4\nrabbitmq 28146  0.0  0.0  15796   608 ?        S    08:33   0:00 inet_gethost 4\nroot     29169  0.0  0.0  12936   988 pts/0    S+   08:49   0:00 grep --color=auto rabbit\n\n\u3046\u30fc\u3080\u3001\u898b\u3066\u3082\u5206\u304b\u3089\u3093\u3002\n\u305f\u3081\u3057\u3055\u3093\uff15\u3000\u306b\u30a2\u30af\u30bb\u30b9\u3002\n# rabbitmqctl list_queues\nListing queues ...\n1111    5\n\n\u3058\u3083\u3042\u3001\u30b8\u30e7\u30d6\u306f\u898b\u3048\u306a\u3044\u304c\u3001\u52d5\u3044\u3066\u3044\u308b\u306e\u3060\u308d\u3046\u304b\uff1f\n\u3060\u3063\u305f\u3089 .cpp \u306e\u65b9\u306f\u3069\u3046\u304b\uff1f\n# cd /home/\u2605user/shogi/cpp_service\n# ./tamesi29a9_main.exe\ndeclared queue 1111\n\n\n\u306a\u30fc\u3093\u306b\u3082\u5909\u308f\u3089\u306a\u3044\u3002\u78ba\u304b\u306b\u30ad\u30e5\u30fc\u306e\u540d\u524d\u306f\u53d6\u3063\u3066\u304d\u3066\u3044\u308b\u306e\u304b\u3082\u3057\u308c\u306a\u3044\u304c\u3001\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u53d6\u3063\u3066\u304f\u308b\u306b\u306f\u3000\u3069\u3046\u3059\u308c\u3070\u3044\u3044\u306e\u304b\uff1f\n\u66f8\u3044\u3066\u308b\u306e\u304b\uff1f\n\u300cAMQP-CPP\u300d\uff08CopernicaMarketingSoftware/AMQP-CPP\uff09\nhttps://github.com/CopernicaMarketingSoftware/AMQP-CPP\n\n\u305f\u3081\u3057\u3055\u3093\uff12\uff19\uff41\uff11\uff10\ntamesi29a10_main.cpp\n#include <ev.h>\n#include <amqpcpp.h>\n#include <amqpcpp/libev.h>\n\nint main()\n{\n    // access to the event loop\n    auto *loop = EV_DEFAULT;\n\n    // handler for libev (so we don't have to implement AMQP::TcpHandler!)\n    AMQP::LibEvHandler handler(loop);\n\n    // make a connection\n    AMQP::TcpConnection connection(&handler, AMQP::Address(\"amqp://localhost/\"));\n\n    // we need a channel too\n    AMQP::TcpChannel channel(&connection);\n\n//    // create a temporary queue\n//    channel.declareQueue(AMQP::exclusive).onSuccess([&connection](const std::string &name, uint32_t messagecount, uint32_t consumercount) {\n//\n//        // report the name of the temporary queue\n//        std::cout << \"declared queue \" << name << std::endl;\n//\n//        // now we can close the connection\n//        connection.close();\n//    });\n    // create a custom callback\n    auto callback = [](const std::string &name, int msgcount, int consumercount) {\n\n        // @todo add your own implementation\n\n        // report the name of the temporary queue\n        std::cout << \"(^q^)declared queue \" << name << std::endl;\n\n        // now we can close the connection\n        // connection.close();\n    };\n    // declare the queue, and install the callback that is called on success\n    channel.declareQueue(\"1111\").onSuccess(callback);\n\n    // callback function that is called when the consume operation starts\n    auto startCb = [](const std::string &consumertag) {\n\n        std::cout << \"(^q^)consume operation started\" << std::endl;\n    };\n\n    // callback function that is called when the consume operation failed\n    auto errorCb = [](const char *message) {\n\n        std::cout << \"(^q^)consume operation failed\" << std::endl;\n    }\n\n    // callback operation when a message was received\n    auto messageCb = [&channel](const AMQP::Message &message, uint64_t deliveryTag, bool redelivered) {\n\n        std::cout << \"(^q^)message received\" << std::endl;\n\n        // acknowledge the message\n        channel.ack(deliveryTag);\n    }\n\n    // start consuming from the queue, and install the callbacks\n    channel.consume(\"1111\")\n        .onReceived(messageCb)\n        .onSuccess(startCb)\n        .onError(errorCb);\n\n    // run the loop\n    ev_run(loop, 0);\n\n    // done\n    return 0;\n}\n\n\u3053\u3093\u306a\u3093\u3067\u3044\u3044\u3093\u3060\u308d\u3046\u304b\uff1f\n# g++ -std=c++11 tamesi29a10_main.cpp -lev -lamqpcpp -pthread -o tamesi29a10_main.exe\ntamesi29a10_main.cpp: In function \u2018int main()\u2019:\ntamesi29a10_main.cpp:55:5: error: expected \u2018,\u2019 or \u2018;\u2019 before \u2018auto\u2019\n     auto messageCb = [&channel](const AMQP::Message &message, uint64_t deliveryTag, bool redelivered) {\n     ^\ntamesi29a10_main.cpp:65:21: error: \u2018messageCb\u2019 was not declared in this scope\n         .onReceived(messageCb)\n                     ^\n\n\u306a\u3093\u304b\u3000\u30b5\u30f3\u30d7\u30eb\u30fb\u30d7\u30ed\u30b0\u30e9\u30e0\u306f\u3000\u30bb\u30df\u30b3\u30ed\u30f3\u304c\u629c\u3051\u3066\u308b\u3093\u3058\u3083\u306a\u3044\u304b\u306a\u3002\n\u300cSemicolon is missing in sample program.\u300d\uff08CopernicaMarketingSoftware/AMQP-CPP\uff09\nhttps://github.com/CopernicaMarketingSoftware/AMQP-CPP/issues/119\n\u9001\u3063\u3068\u3044\u305f\u3002\n\u3088\u3057\u3001\u30b3\u30f3\u30d1\u30a4\u30eb\u3082\u901a\u3063\u305f\u3002\n# ./tamesi29a10_main.exe\n(^q^)declared queue 1111\n(^q^)consume operation started\n(^q^)message received\n(^q^)message received\n(^q^)message received\n(^q^)message received\n(^q^)message received\n\n[Ctrl]+[C]\u3067\u629c\u3051\u308b\u3002\n\u78ba\u304b\u306b \uff15\u5339\u306e\u3000\u305f\u3081\u3057\u3055\u3093 \u304c\u51fa\u3066\u304d\u305f\u306e\u306f\u6b63\u89e3\u306a\u3093\u3060\u304c\u3001\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u62fe\u3063\u3066\u6b32\u3057\u3044\u3002\n# rabbitmqctl list_queues\nListing queues ...\n1111    0\n\n\u3082\u3046\u7a7a\u3063\u307d\u3060\u3002\n\u3053\u3046\u6539\u9020\u3057\u3066\u3000\u3069\u3046\u304b\uff1f\ntamesi29a10_main.cpp\n#include <ev.h>\n#include <amqpcpp.h>\n#include <amqpcpp/libev.h>\n\nint main()\n{\n    // access to the event loop\n    auto *loop = EV_DEFAULT;\n\n    // handler for libev (so we don't have to implement AMQP::TcpHandler!)\n    AMQP::LibEvHandler handler(loop);\n\n    // make a connection\n    AMQP::TcpConnection connection(&handler, AMQP::Address(\"amqp://localhost/\"));\n\n    // we need a channel too\n    AMQP::TcpChannel channel(&connection);\n\n//    // create a temporary queue\n//    channel.declareQueue(AMQP::exclusive).onSuccess([&connection](const std::string &name, uint32_t messagecount, uint32_t consumercount) {\n//\n//        // report the name of the temporary queue\n//        std::cout << \"declared queue \" << name << std::endl;\n//\n//        // now we can close the connection\n//        connection.close();\n//    });\n    // create a custom callback\n    auto callback = [](const std::string &name, int msgcount, int consumercount) {\n\n        // @todo add your own implementation\n\n        // report the name of the temporary queue\n        std::cout << \"(^q^)declared queue \" << name << std::endl;\n\n        // now we can close the connection\n        // connection.close();\n    };\n    // declare the queue, and install the callback that is called on success\n    channel.declareQueue(\"1111\").onSuccess(callback);\n\n    // callback function that is called when the consume operation starts\n    auto startCb = [](const std::string &consumertag) {\n\n        // std::cout << \"(^q^)consume operation started\" << std::endl;\n        std::cout << \"(^q^)consume operation started [\" << consumertag << \"]\" << std::endl;\n    };\n\n    // callback function that is called when the consume operation failed\n    auto errorCb = [](const char *message) {\n\n        // std::cout << \"(^q^)consume operation failed\" << std::endl;\n        std::cout << \"(^q^)consume operation failed [\" << &message << \"]\" << std::endl;\n    };\n\n    // callback operation when a message was received\n    auto messageCb = [&channel](const AMQP::Message &message, uint64_t deliveryTag, bool redelivered) {\n\n        // std::cout << \"(^q^)message received\" << std::endl;\n        std::cout << \"(^q^)message received [\" << &message << \"]\" << std::endl;\n\n        // acknowledge the message\n        channel.ack(deliveryTag);\n    };\n\n    // start consuming from the queue, and install the callbacks\n    channel.consume(\"1111\")\n        .onReceived(messageCb)\n        .onSuccess(startCb)\n        .onError(errorCb);\n\n    // run the loop\n    ev_run(loop, 0);\n\n    // done\n    return 0;\n}\n\n\u305f\u3081\u3057\u3055\u3093\uff11\uff14\u3000\u3092\u4f7f\u3063\u3066\u3001\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u30a8\u30f3\u30ad\u30e5\u30fc\u3057\u3066\u304a\u304f\u3002\n# rabbitmqctl list_queues\nListing queues ...\n1111    6\n\n# ./tamesi29a10_main.exe\n(^q^)declared queue 1111\n(^q^)consume operation started [amq.ctag-f9-pEPIwqTgyCHuhYm4wiA]\n(^q^)message received [0xc87ea0]\n(^q^)message received [0xc87ea0]\n(^q^)message received [0xc87ea0]\n(^q^)message received [0xc87ea0]\n(^q^)message received [0xc87ea0]\n(^q^)message received [0xc87ea0]\n\n\u306c\u304e\u304e\uff01\u3000\u30e1\u30c3\u30bb\u30fc\u30b8\u3060\u3051\u3000\u306a\u3093\u3068\u304b\u306a\u308c\u3070\u3044\u3044\u3002\u3057\u304b\u3057\u7570\u306a\u308b\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u9001\u3063\u305f\u306e\u306b\u5168\u90e8\u30000xc87ea0\u3000\u3068\u306f\u3069\u3046\u3044\u3046\u3053\u3068\u3060\u3002\n\u4f55\u304b\u306e\u30e1\u30e2\u30ea\u30fb\u30a2\u30c9\u30ec\u30b9\u304b\uff1f\n\nAMQP::Message\nAMQP::Message \u306f\u6587\u5b57\u5217\u3058\u3083\u306a\u3044\u3093\u3058\u3083\u306a\u3044\u304b\u3002\n\n/usr/include/amqpcpp.h\n/usr \u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306e\u4e0b\u3092\u63a2\u3057\u3066\u3044\u308b\u3068\u3001\n/usr/include/amqpcpp.h \u3068\u3044\u3046\u30d5\u30a1\u30a4\u30eb\u304c\u3042\u3063\u305f\u3002\n\u3055\u3089\u306b\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306e\u4e0b\u306b\u30d8\u30c3\u30c0\u30d5\u30a1\u30a4\u30eb\u304c\u3042\u308b\u3088\u3046\u3060\u3002\n/usr/include/amqpcpp# ls\naddress.h     channel.h            copiedbuffer.h          deferredget.h    exception.h     libevent.h  monitor.h            stringfield.h    watchable.h\narray.h       channelimpl.h        decimalfield.h          deferred.h       exchangetype.h  libev.h     numericfield.h       table.h\nbooleanset.h  classes.h            deferredcancel.h        deferredqueue.h  field.h         libuv.h     outbuffer.h          tcpchannel.h\nbuffer.h      connection.h         deferredconsumerbase.h  endian.h         fieldproxy.h    login.h     protocolexception.h  tcpconnection.h\nbytebuffer.h  connectionhandler.h  deferredconsumer.h      entityimpl.h     flags.h         message.h   receivedframe.h      tcpdefines.h\ncallbacks.h   connectionimpl.h     deferreddelete.h        envelope.h       frame.h         metadata.h  stack_ptr.h          tcphandler.h\n\nmessage.h \u3068\u3044\u3046\u30d5\u30a1\u30a4\u30eb\u304c\u6c17\u306b\u306a\u308b\u3002\n\u8457\u4f5c\u8868\u8a18\u3092\u898b\u308b\u3068\u3001Copernica BV \u3068\u3044\u3046\u3068\u3053\u308d\u304c\u4f5c\u3063\u3066\u3044\u308b\u307f\u305f\u3044\u3060\u3002\nconst std::string &exchange() const\n\u3068\u3001\nconst std::string &routingkey() const\n\u3050\u3089\u3044\u3057\u304b\u3000\u30a2\u30af\u30bb\u30b9\u3067\u304d\u305d\u3046\u306a\u3082\u306e\u304c\u7121\u3044\u3093\u3060\u304c\u3002\n        std::cout << \"(^q^)message received exchange=[\" << &message.exchange() << \"] routingkey=[\" << &message.routingkey() << \"]\" << std::endl;\n\n# ./tamesi29a10_main.exe\n(^q^)declared queue 1111\n(^q^)consume operation started [amq.ctag-baH5AqjR3dg-pmSMobsugg]\n(^q^)message received exchange=[0xcdf0d8] routingkey=[0xcdf0f8]\n(^q^)message received exchange=[0xcdf0d8] routingkey=[0xcdf0f8]\n\n\u9055\u3046\u306e\u304b\u3002\nMessage \u30af\u30e9\u30b9\u306f Envelope \u30af\u30e9\u30b9\u3092\u7d99\u627f\u3057\u3066\u3044\u308b\u306e\u3067\u3001Envelope \u3082\u898b\u3066\u307f\u3088\u3046\u3002\n    /**\n     *  Access to the full message data\n     *  @return buffer\n     */\n    const char *body() const\n    {\n        return _body;\n    }\n\n\u3053\u3093\u306a\u306e\u304c\u3042\u308b\u3002\n        std::cout << \"(^q^)message received body=[\" << message.body() << \"]\" << std::endl;\n\n\u3042\u3068\u3001\u982d\u306e\u30a2\u30f3\u30d1\u30b5\u30f3\u30c9\u306f\u8981\u3089\u3093\u306e\u3067\u306f\uff1f\n# ./tamesi29a10_main.exe\n(^q^)declared queue 1111\n(^q^)consume operation started [amq.ctag-FYCpWCbtuoRvXl4XoRReHA]\n(^q^)message received body=[ClickSitanDaze\u2592YCpWCbtuoRvXl4XoRReHA]\n(^q^)message received body=[Dragon\u2592]\n(^q^)message received body=[Tiger\u2592]\n\n\u3088\u3057\u304d\u305f\u9053\u4e2d\u3002\u306a\u3093\u304b\u3000\u8b0e\u306e\u6587\u5b57\u304c\u5f8c\u308d\u306b\u3064\u3044\u3066\u3044\u308b\u304c\u2026\u2026\u3002\n    /**\n     *  Size of the body\n     *  @return uint64_t\n     */\n    uint64_t bodySize() const\n    {\n        return _bodySize;\n    }\n\nC\u8a00\u8a9e\u3067\u3044\u3046\u3068\u3053\u308d\u306e\u3001\u6587\u5b57\u5217\u306e\u30b5\u30a4\u30ba\u304b\u3060\u305c\uff1f\n\u3069\u3046\u3084\u3063\u3066\u4f7f\u3046\u306e\u304b\u3002\n\u300cconvert a char* to std::string\u300d\uff08stack overflow\uff09\nhttp://stackoverflow.com/questions/1195675/convert-a-char-to-stdstring\n        std::string myString(message.body(), message.bodySize());\n        std::cout << \"(^q^)message received myString=[\" << myString << \"]\" << std::endl;\n\n# ./tamesi29a10_main.exe\n(^q^)declared queue 1111\n(^q^)consume operation started [amq.ctag-M2QG32xTPEkdEn-Swcl2Sw]\n(^q^)message received myString=[Tiger]\n\n\u3044\u3051\u305f\u3002\n\u3044\u3063\u305f\u3093\u3000\u5225\u8a18\u4e8b\u306b\u307e\u3068\u3081\u3088\u3046\u3002\n\u3055\u304f\u3089VPS\u306e\u304a\u8a66\u3057\u671f\u9593\u306f\u3000\uff12\u9031\u9593\u306a\u3093\u3060\u304c\u3001\u307e\u3060\u3000\u30d7\u30ed\u30b0\u30e9\u30e0\u306e\u5e38\u99d0\u3000\u304c\u3067\u304d\u3066\u3044\u306a\u3044\u3002\n\n\u3067\u3001\u3055\u3063\u3055\u3068\u6700\u512a\u5148\u3067\u3000\u30d7\u30ed\u30b0\u30e9\u30e0\u306e\u5e38\u99d0\u3000\u304c\u53ef\u80fd\u304b\u3069\u3046\u304b\u3000\u8abf\u3079\u305f\u65b9\u304c\u3044\u3044\u3068\u601d\u3046\u3093\u3060\u304c\u3001\n\u305d\u306e\u4ed6\u306e\u53ef\u80fd\u6027\u3092\u6f70\u3057\u3066\u3044\u304f\u306e\u306b\u3000\u8a18\u4e8b\uff1c\u305d\u306e\uff11\uff1e\uff5e\uff1c\u305d\u306e\uff15\uff1e\u3000\u307e\u3067\u304b\u304b\u3063\u305f\u3002\n\n\u524d\u56de\u306e\u8a18\u4e8b : http://qiita.com/muzudho1/items/8f940f8b4c679c23a174\n\n# \u3084\u308a\u305f\u3044\u3053\u3068\n\n\u30d7\u30e9\u30f3\uff12\n\n- \u30b3\u30f3\u30d4\u30e5\u30fc\u30bf\u5c06\u68cb\u30d7\u30ed\u30b0\u30e9\u30e0\u3000\u3092\u5e38\u99d0\u3055\u305b\u308b\n- \u30d6\u30e9\u30a6\u30b6\u3067\u306e\u30da\u30fc\u30b8\u30fb\u30a2\u30af\u30bb\u30b9\u306e\u5ea6\u306bPHP\u306f\u3000\u6307\u3057\u624b\u30d6\u30ed\u30fc\u30ab\u30fc\u4e09\u6cb3\u5c4b\u3000\u3092\u8d77\u52d5\u3057\u3066\u3001\u30ad\u30e5\u30fc\u5f85\u3061\u3000\u3055\u305b\u3001\u30b3\u30f3\u30d4\u30e5\u30fc\u30bf\u30fc\u5c06\u68cb\u30d7\u30ed\u30b0\u30e9\u30e0\u306b\u3000\u6307\u3057\u624b\u306e\u304a\u4f3a\u3044\u3092\u7acb\u3066\u308b\n- PHP\u306f\u3001\u6307\u3057\u624b\u30d6\u30ed\u30fc\u30ab\u30fc\u4e09\u6cb3\u5c4b\u3000\u304c\u6301\u3063\u3066\u304d\u305f\u6307\u3057\u624b\u3092\u3000PHP\u3067\u51fa\u529b\u3059\u308b\n\n\u30d7\u30e9\u30f3\uff11\n\n- \u30b3\u30f3\u30d4\u30e5\u30fc\u30bf\u5c06\u68cb\u30d7\u30ed\u30b0\u30e9\u30e0\u3000\u3092\u5e38\u99d0\u3055\u305b\u308b\n- \u30b2\u30fc\u30e0\u30b5\u30fc\u30d0\u30fc\u3000\u3092\u5e38\u99d0\u3055\u305b\u308b\n- \u30b2\u30fc\u30e0\u30b5\u30fc\u30d0\u30fc\u306f\u3000\u30b3\u30f3\u30d4\u30e5\u30fc\u30bf\u30fc\u5c06\u68cb\u30d7\u30ed\u30b0\u30e9\u30e0\u3000\u3068\u5c40\u9762\u691c\u8a0e\u304c\u3067\u304d\u308b\u3082\u306e\u3068\u3059\u308b\n- \u30d6\u30e9\u30a6\u30b6\u3067\u306e\u30da\u30fc\u30b8\u30fb\u30a2\u30af\u30bb\u30b9\u306e\u5ea6\u306bPHP\u306f\u3000\u7121\u9650\u30eb\u30fc\u30d7\u306b\u5165\u308a\u3000\u30b2\u30fc\u30e0\u30b5\u30fc\u30d0\u30fc\u306b\u30d7\u30ed\u30bb\u30b9\u9593\u901a\u4fe1\u3001\u30e1\u30c3\u30bb\u30fc\u30b8\u30ad\u30e5\u30fc\u306b\u6307\u3057\u624b\u304c\u5165\u3063\u3066\u3044\u308c\u3070\u3000\u7121\u9650\u30eb\u30fc\u30d7\u3092\u51fa\u3066\u3000\u6307\u3057\u624b\u3092 PHP\u3067\u51fa\u529b\u3059\u308b\n\n\u3067\u3001\u30d7\u30e9\u30f3\uff11\u306f\u3000\u305d\u308c\u304c\u3067\u304d\u306a\u3044\u3068\u3044\u3046\u8a71\u3057\u304c\u3000\u3048\u3093\u3048\u3093\u3068\u3000\u8a18\u4e8b\uff1c\u305d\u306e\uff11\uff1e\uff5e\uff1c\u305d\u306e\uff13\uff1e\u3000\u3050\u3089\u3044\u306b\u66f8\u3044\u3066\u3042\u3063\u305f\u306e\u3060\u3063\u305f\u3002\n\n\u6b8b\u3063\u3066\u308b\u306e\u306f\u3000\u30d7\u30e9\u30f3\uff12\u3002\n\n\u8abf\u3079\u3066\u307f\u308b\u3002\n\n# \u5e38\u99d0\u3067\u304d\u306a\u3044\u306e\u306f\u3000\u30b3\u30f3\u30d4\u30e5\u30fc\u30bf\u5c06\u68cb\u30d7\u30ed\u30b0\u30e9\u30e0\u3067\u306f\u306a\u3044\nPuTTY\u3067\u9060\u9694\u30ed\u30b0\u30a4\u30f3\u3057\u3001PHP\u3067\u7121\u9650\u30eb\u30fc\u30d7\u3092\u66f8\u3044\u3066\u3000\u30d0\u30c3\u30af\u30b0\u30e9\u30f3\u30c9\u5b9f\u884c\u3057\u3066\u3082\u3000\u30ed\u30b0\u30a2\u30a6\u30c8\u3059\u308b\u3068\u3000\u30b8\u30e7\u30d6\u306f\u6d88\u3048\u3066\u3057\u307e\u3046\u3002\n\n\u305d\u3053\u3067 Cron \u3092\u4f7f\u3063\u3066\u3000\u7121\u9650\u30eb\u30fc\u30d7PHP\u3000\u3092\u5b9f\u884c\u3059\u308b\u3093\u3060\u304c\u3001\u3059\u3050\u3000S \uff08\u505c\u6b62\uff09\u3057\u3066\u3044\u308b\u3002\n\nApache \u306f\u5e38\u99d0\u3057\u3066\u3044\u308b\u3002\nPuTTY \u3067\u30bb\u30c3\u30b7\u30e7\u30f3\u30fb\u30ed\u30b0\u30a2\u30a6\u30c8\u3057\u3066\u3082 \u30d6\u30e9\u30a6\u30b6\u3067 http://\u2605.\u2605.\u2605.\u2605/index.php \u3068\u3067\u3082\u6253\u3066\u3070\u753b\u9762\u306f\u51fa\u3066\u304f\u308b\u3002\n\n\u5e38\u99d0\u306f\u3067\u304d\u308b\u3088\u3046\u3060\u3002\n\u3069\u3046\u3084\u3063\u3066\u5e38\u99d0\u3059\u308b\u306e\u304b\u3002\n\nWindows 10 \u3060\u3068 \u30bf\u30b9\u30af\u30d0\u30fc\u306e\u300c\u4f55\u3067\u3082\u805e\u3044\u3066\u304f\u3060\u3055\u3044\u300d\u3068\u66f8\u3044\u3066\u3042\u308b\u30c6\u30ad\u30b9\u30c8\u30dc\u30c3\u30af\u30b9\u306b \u300c\u30b3\u30f3\u30d4\u30e5\u30fc\u30bf\u30fc\u306e\u7ba1\u7406\u300d\u3068\u6253\u3061\u8fbc\u3093\u3067 [\u30b5\u30fc\u30d3\u30b9\u3068\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3] - [\u30b5\u30fc\u30d3\u30b9]\u3000\u3068\u9032\u3093\u3067\u3044\u3051\u3070\u3001\u5e38\u99d0\u3057\u3066\u3044\u308b\u30d7\u30ed\u30b0\u30e9\u30e0\u306e\u4e00\u89a7\u304c\u51fa\u3066\u304f\u308b\u3002\n\nUbuntu16.04 \u3060\u3068\n\n```\nps aux\n```\n\n\u3068\u6253\u3061\u8fbc\u3081\u3070\u3000\u30d7\u30ed\u30bb\u30b9\u306e\u4e00\u89a7\u304c\u898b\u308c\u308b\u3093\u3060\u304c\u3001\u3053\u308c\u306f\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u4e00\u89a7\u3067\u306f\u306a\u3044\u3002\n\n```\n# ps aux | grep apache\n```\n\n\u3068\u6253\u3061\u8fbc\u3080\u3068\u4f8b\u3048\u3070\n\n```\nwww-data  2776  0.0  0.2 352548  2496 ?        S    Mar09   0:00 /usr/sbin/apache2 -k start\nroot     11959  0.0  0.0 351884    76 ?        Ss   Mar07   0:34 /usr/sbin/apache2 -k start\nwww-data 11965  0.0  0.0 352296   148 ?        S    Mar07   0:14 /usr/sbin/apache2 -k start\nroot     19418  0.0  0.0  12936   980 pts/2    S+   03:16   0:00 grep --color=auto apache\nwww-data 29283  0.0  0.1 352164  2004 ?        S    Mar09   0:00 /usr/sbin/apache2 -k start\nwww-data 29284  0.0  0.0 352164   556 ?        S    Mar09   0:00 /usr/sbin/apache2 -k start\nwww-data 29285  0.0  0.1 352164  1944 ?        S    Mar09   0:00 /usr/sbin/apache2 -k start\nwww-data 29286  0.0  0.0 352164     0 ?        S    Mar09   0:00 /usr/sbin/apache2 -k start\nwww-data 29287  0.0  0.1 352164  1776 ?        S    Mar09   0:00 /usr/sbin/apache2 -k start\nwww-data 29318  0.0  0.2 352164  2508 ?        S    Mar09   0:00 /usr/sbin/apache2 -k start\nwww-data 31812  0.0  0.1 352164  1116 ?        S    Mar09   0:00 /usr/sbin/apache2 -k start\n```\n\n\u3068\u51fa\u3066\u304d\u3066\u3001\u3053\u306e\u3046\u3061\u300ccolor=auto apache\u300d\u3068\u3044\u3046\u306e\u306f apache\u306e\u6587\u5b57\u8272\u3092\u8d64\u8272\u306b\u3057\u307e\u3057\u3087\u3046\u3001\u3068\u3044\u3046\u4eca\u53e9\u3044\u305f\u3070\u304b\u308a\u306e\u30b3\u30de\u30f3\u30c9\u3060\u304b\u3089\u7121\u8996\u3059\u308b\u3068\u3057\u3066\u3001\n\n/usr/sbin/apache2 -k start\n\n\u3068\u3044\u3046\u30b3\u30de\u30f3\u30c9\u3067\u5b9f\u884c\u3055\u308c\u305f\u30d7\u30ed\u30bb\u30b9\u304c\u3000\u7a3c\u50cd\u3057\u3066\u3044\u308b\u3053\u3068\u304c\u5206\u304b\u308b\u3002\n\n\u3057\u304b\u3057\u3088\u304f\u898b\u308b\u3068\u3000\u307f\u3093\u306a\u3000S\u3000\u3060\u306a\u3002\n\n```\nwww-data 15221  197 27.6 712928 281056 pts/3   Rsl+ Mar09 458:47 ./release\n```\n\n\u3053\u308c\u306a\u3093\u304b\u3001\u30d6\u30e9\u30a6\u30b6\u3067\u30a2\u30af\u30bb\u30b9\u3057\u3066\u3000\u53e9\u304d\u8d77\u3053\u3057\u305f\u3000\u30b3\u30f3\u30d4\u30e5\u30fc\u30bf\u5c06\u68cb\u30bd\u30d5\u30c8\u306e\u3000\u6280\u5de7\u3000\u306e\u30d7\u30ed\u30b0\u30e9\u30e0\u306a\u3093\u3058\u3083\u306a\u3044\u304b\uff1f\n\nRsl+ \u3068\u3044\u3046\u306e\u304c\u3069\u3046\u3044\u3046\u72b6\u6cc1\u306a\u3093\u3060\u3002\n\n\u300cps\u30b3\u30de\u30f3\u30c9\u307e\u3068\u3081\u300d \uff08Qiita\uff09\nhttp://qiita.com/shell/items/68ed71a7f018e5688f73\n\n\u300cS\u300d\u306f\u30b9\u30c8\u30c3\u30d7\u3058\u3083\u306a\u304f\u3066\u3000\u30b9\u30ea\u30fc\u30d7\u3000\u306a\u306e\u304b\u2026\u2026\u3002\n\n```\n# kill 15221\n```\n\n\u3068\u3044\u3046\u3053\u3068\u306f\u3002\n\n```\n# ps aux\nUSER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND\nroot         1  0.0  0.1  37448  1872 ?        Ss   Mar04   0:56 /lib/systemd/systemd --system --deserialize 19\nroot         2  0.0  0.0      0     0 ?        S    Mar04   0:00 [kthreadd]\nroot         3  0.0  0.0      0     0 ?        S    Mar04   0:03 [ksoftirqd/0]\nroot         5  0.0  0.0      0     0 ?        S<   Mar04   0:00 [kworker/0:0H]\nroot         7  0.0  0.0      0     0 ?        S    Mar04   1:52 [rcu_sched]\nroot         8  0.0  0.0      0     0 ?        S    Mar04   2:16 [rcuos/0]\nroot         9  0.0  0.0      0     0 ?        S    Mar04   0:18 [rcuos/1]\nroot        10  0.0  0.0      0     0 ?        S    Mar04   0:00 [rcu_bh]\nroot        11  0.0  0.0      0     0 ?        S    Mar04   0:00 [rcuob/0]\nroot        12  0.0  0.0      0     0 ?        S    Mar04   0:00 [rcuob/1]\nroot        13  0.0  0.0      0     0 ?        S    Mar04   0:05 [migration/0]\nroot        14  0.0  0.0      0     0 ?        S    Mar04   0:10 [watchdog/0]\nroot        15  0.0  0.0      0     0 ?        S    Mar04   0:07 [watchdog/1]\nroot        16  0.0  0.0      0     0 ?        S    Mar04   0:01 [migration/1]\nroot        17  0.0  0.0      0     0 ?        S    Mar04   0:01 [ksoftirqd/1]\nroot        19  0.0  0.0      0     0 ?        S<   Mar04   0:00 [kworker/1:0H]\nroot        20  0.0  0.0      0     0 ?        S<   Mar04   0:00 [khelper]\nroot        21  0.0  0.0      0     0 ?        S    Mar04   0:00 [kdevtmpfs]\nroot        22  0.0  0.0      0     0 ?        S<   Mar04   0:00 [netns]\nroot        23  0.0  0.0      0     0 ?        S<   Mar04   0:00 [writeback]\nroot        24  0.0  0.0      0     0 ?        S<   Mar04   0:00 [kintegrityd]\nroot        25  0.0  0.0      0     0 ?        S<   Mar04   0:00 [bioset]\nroot        27  0.0  0.0      0     0 ?        S<   Mar04   0:00 [kblockd]\nroot        28  0.0  0.0      0     0 ?        S<   Mar04   0:00 [ata_sff]\nroot        29  0.0  0.0      0     0 ?        S    Mar04   0:00 [khubd]\nroot        30  0.0  0.0      0     0 ?        S<   Mar04   0:00 [md]\nroot        31  0.0  0.0      0     0 ?        S<   Mar04   0:00 [devfreq_wq]\nroot        35  0.0  0.0      0     0 ?        S    Mar04   0:02 [khungtaskd]\nroot        36  0.0  0.0      0     0 ?        S    Mar04   3:27 [kswapd0]\nroot        37  0.0  0.0      0     0 ?        SN   Mar04   0:00 [ksmd]\nroot        38  0.0  0.0      0     0 ?        SN   Mar04   0:11 [khugepaged]\nroot        39  0.0  0.0      0     0 ?        S    Mar04   0:00 [fsnotify_mark]\nroot        40  0.0  0.0      0     0 ?        S    Mar04   0:00 [ecryptfs-kthrea]\nroot        41  0.0  0.0      0     0 ?        S<   Mar04   0:00 [crypto]\nroot        53  0.0  0.0      0     0 ?        S<   Mar04   0:00 [kthrotld]\nroot        55  0.0  0.0      0     0 ?        S    Mar04   0:00 [vballoon]\nroot        56  0.0  0.0      0     0 ?        S    Mar04   0:00 [scsi_eh_0]\nroot        57  0.0  0.0      0     0 ?        S    Mar04   0:00 [scsi_eh_1]\nroot        77  0.0  0.0      0     0 ?        S<   Mar04   0:00 [deferwq]\nroot        78  0.0  0.0      0     0 ?        S<   Mar04   0:00 [charger_manager]\nroot       115  0.0  0.0      0     0 ?        S<   Mar04   0:00 [kpsmoused]\nroot       141  0.0  0.0      0     0 ?        S    Mar04   0:36 [jbd2/vda1-8]\nroot       142  0.0  0.0      0     0 ?        S<   Mar04   0:00 [ext4-rsv-conver]\nroot       185  0.0  0.0  29480  1012 ?        Ss   Mar04   0:47 /lib/systemd/systemd-journald\nroot       196  0.0  0.0      0     0 ?        S    Mar04   0:00 [kauditd]\nroot       234  0.0  0.0  43808     8 ?        Ss   Mar04   0:03 /lib/systemd/systemd-udevd\nsystemd+   417  0.0  0.0 100316    60 ?        Ssl  Mar04   0:03 /lib/systemd/systemd-timesyncd\nsyslog     443  0.0  0.0 256388   376 ?        Ssl  Mar04   0:39 /usr/sbin/rsyslogd -n\nroot       453  0.0  0.0  29872     4 ?        Ss   Mar04   0:00 /sbin/cgmanager -m name=systemd\nroot       469  0.0  0.0 232308   236 ?        S    Mar09   0:02 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot       488  0.0  0.0      0     0 ?        S<   Mar04   0:00 [kvm-irqfd-clean]\nroot       490  0.0  0.1 274560  1356 ?        Ssl  Mar04   1:03 /usr/lib/accountsservice/accounts-daemon\nroot       494  0.0  0.0  28540   880 ?        Ss   Mar04   0:13 /lib/systemd/systemd-logind\nmessage+   515  0.0  0.0  43020   636 ?        Ss   Mar04   0:22 /usr/bin/dbus-daemon --system --address=systemd: --nofork --nopidfile --systemd-a\nroot       551  0.0  0.0  19592   304 ?        Ss   Mar04   0:56 /usr/sbin/irqbalance --pid=/var/run/irqbalance.pid\nroot       709  0.0  0.0  65512   332 ?        Ss   Mar04   0:04 /usr/sbin/sshd -D\nmemcache   714  0.0  0.0 340888   540 ?        Ssl  Mar04   1:32 /usr/bin/memcached -m 64 -p 11211 -u memcache -l 160.16.83.155\nmysql      715  0.1  0.0 1302112    0 ?        Ssl  Mar04  11:35 /usr/sbin/mysqld\nroot       757  0.0  0.0  14468     0 ttyS0    Ss+  Mar04   0:00 /sbin/agetty --keep-baud 115200 38400 9600 ttyS0 vt220\nroot       758  0.0  0.0  14652     0 tty1     Ss+  Mar04   0:00 /sbin/agetty --noclear tty1 linux\nroot      1878  0.0  0.0 232308   108 ?        S    Mar09   0:03 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nwww-data  2776  0.0  0.2 352548  2496 ?        S    Mar09   0:00 /usr/sbin/apache2 -k start\nroot      2866  0.0  0.0      0     0 ?        S    Mar07   0:00 [kworker/0:2]\nroot      2957  0.0  0.0 232308    40 ?        S    Mar09   0:02 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot      4784  0.0  0.0 232308    92 ?        S    Mar09   0:03 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot      4945  0.0  0.0 232308   104 ?        S    Mar08   0:09 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot      5693  0.0  0.0      0     0 ?        S    Mar07   0:49 [kworker/0:0]\nroot      5916  0.0  0.0 232308   172 ?        S    Mar09   0:02 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot      6091  0.0  0.0 311040   312 ?        Ss   Mar07   0:49 php-fpm: master process (/etc/php/7.0/fpm/php-fpm.conf)\nwww-data  6094  0.0  0.0 311040     0 ?        S    Mar07   0:00 php-fpm: pool www\nwww-data  6095  0.0  0.0 311040     0 ?        S    Mar07   0:00 php-fpm: pool www\nroot      6301  0.0  0.0 232308   260 ?        S    Mar08   0:10 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot      6856  0.0  0.0 232308   112 ?        S    Mar09   0:02 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot      7280  0.0  0.0      0     0 ?        S    Mar07   0:18 [kworker/1:1]\nroot      7795  0.0  0.0 232308   112 ?        S    Mar09   0:01 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot      8303  0.0  0.0 232308   132 ?        S    Mar08   0:09 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot      8732  0.0  0.0 232308   132 ?        S    Mar09   0:01 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot      9246  0.0  0.0 232308    80 ?        S    Mar08   0:09 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot      9664  0.0  0.0 232308   272 ?        S    Mar09   0:01 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot     10278  0.0  0.0 232308    52 ?        S    Mar08   0:08 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot     10632  0.0  0.0 232308   124 ?        S    Mar09   0:01 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot     11364  0.0  0.0 232308   276 ?        S    Mar08   0:08 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot     11567  0.0  0.0 232308    72 ?        S    Mar09   0:01 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot     11959  0.0  0.0 351884    76 ?        Ss   Mar07   0:34 /usr/sbin/apache2 -k start\nwww-data 11965  0.0  0.0 352296   148 ?        S    Mar07   0:14 /usr/sbin/apache2 -k start\nroot     12122  0.0  0.0   4500     0 ?        S    Mar07   0:00 /bin/sh /usr/sbin/rabbitmq-server\nroot     12129  0.0  0.0  55128     0 ?        S    Mar07   0:00 su rabbitmq -s /bin/sh -c /usr/lib/rabbitmq/bin/rabbitmq-server\nrabbitmq 12130  0.0  0.0   4500     8 ?        Ss   Mar07   0:00 sh -c /usr/lib/rabbitmq/bin/rabbitmq-server\nrabbitmq 12131  0.0  0.0   4500     0 ?        S    Mar07   0:00 /bin/sh -e /usr/lib/rabbitmq/bin/rabbitmq-server\nrabbitmq 12237  0.6  1.8 2812192 19272 ?       Sl   Mar07  25:13 /usr/lib/erlang/erts-8.1/bin/beam.smp -W w -A 64 -P 1048576 -t 5000000 -stbt db -\nrabbitmq 12333  0.0  0.0   4356    72 ?        Ss   Mar07   0:16 erl_child_setup 1024\nrabbitmq 12343  0.0  0.0  13676    36 ?        Ss   Mar07   0:00 inet_gethost 4\nrabbitmq 12344  0.0  0.0  15796   228 ?        S    Mar07   0:01 inet_gethost 4\nroot     12376  0.0  0.0 232308    76 ?        S    Mar08   0:08 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot     12582  0.0  0.0 232308   164 ?        S    Mar09   0:01 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot     12714  0.0  0.0  99616   332 ?        Ss   Mar09   0:00 sshd: \u2605user [priv]\n\u2605user    12738  0.0  0.0  99616   524 ?        S    Mar09   0:01 sshd: \u2605user@pts/2\n\u2605user    12742  0.0  0.0  21484     0 pts/2    Ss   Mar09   0:00 -bash\nroot     12760  0.0  0.0  55780     4 pts/2    S    Mar09   0:00 sudo su -\nroot     12761  0.0  0.0  55128     0 pts/2    S    Mar09   0:00 su -\nroot     12762  0.0  0.1  21508  1348 pts/2    S    Mar09   0:00 -su\nroot     13304  0.0  0.0 232308   180 ?        S    Mar08   0:07 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot     13713  0.0  0.0 232308    72 ?        S    Mar09   0:00 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot     14237  0.0  0.0 232308   100 ?        S    Mar08   0:07 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot     14600  0.0  0.0  99528   164 ?        Ss   Mar09   0:00 sshd: \u2605user [priv]\n\u2605user    14616  0.0  0.0  99528   584 ?        S    Mar09   0:00 sshd: \u2605user@notty\n\u2605user    14617  0.0  0.0  12876   256 ?        Ss   Mar09   0:00 /usr/lib/openssh/sftp-server\nroot     14706  0.0  0.0 232308   136 ?        S    Mar09   0:00 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot     15183  0.0  0.0 232308   204 ?        S    Mar08   0:07 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot     15608  0.0  0.0      0     0 ?        S    Mar09   0:00 [kworker/u4:2]\nroot     15780  0.0  0.0      0     0 ?        S    00:04   0:00 [kworker/u4:0]\nroot     15791  0.0  0.0 232308    80 ?        S    00:05   0:00 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot     16115  0.0  0.0 232308    80 ?        S    Mar08   0:07 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot     16778  0.0  0.0 232308    60 ?        S    01:05   0:00 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot     17059  0.0  0.0 232308    76 ?        S    Mar08   0:07 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot     17726  0.0  0.0      0     0 ?        S<   02:00   0:00 [kworker/u5:2]\nroot     17967  0.0  0.0 232308   256 ?        S    02:05   0:00 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot     17993  0.0  0.0 232308   252 ?        S    Mar08   0:06 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot     18025  0.0  0.0      0     0 ?        S<   02:07   0:00 [kworker/u5:0]\nroot     18398  0.0  0.0      0     0 ?        S    02:24   0:00 [kworker/1:0]\nroot     19047  0.0  0.0 232308    76 ?        S    Mar08   0:06 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot     19194  0.0  1.3 232308 14048 ?        S    03:05   0:00 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot     19518  0.0  0.0   6004   632 ?        S    03:23   0:00 sleep 1m\nroot     19529  0.0  0.1  36076  1700 pts/2    R+   03:24   0:00 ps aux\nroot     20097  0.0  0.0 232308   212 ?        S    Mar08   0:06 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot     21104  0.0  0.0 232308   224 ?        S    Mar08   0:05 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot     22197  0.0  0.0 232308   264 ?        S    Mar09   0:05 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot     22468  0.0  0.0  11332   556 ?        S    Mar07   0:04 /bin/bash ./loop8.sh\n\u2605user    22666  0.0  0.0  45240     0 ?        Ss   Mar06   0:00 /lib/systemd/systemd --user\n\u2605user    22667  0.0  0.0  63256     4 ?        S    Mar06   0:00 (sd-pam)\nroot     23284  0.0  0.0 232308    96 ?        S    Mar09   0:05 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot     24410  0.0  0.0 232308   192 ?        S    Mar09   0:04 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot     25393  0.0  0.0 232308   196 ?        S    Mar09   0:04 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot     26650  0.0  0.0 232308   232 ?        S    Mar09   0:04 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nrabbitmq 27670  0.0  0.0  13848    64 ?        S    Mar06   0:11 /usr/lib/erlang/erts-8.1/bin/epmd -daemon\nroot     27756  0.0  0.0 232308   228 ?        S    Mar09   0:04 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot     28734  0.0  0.0 232308   128 ?        S    Mar09   0:03 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nwww-data 29283  0.0  0.1 352164  2004 ?        S    Mar09   0:00 /usr/sbin/apache2 -k start\nwww-data 29284  0.0  0.1 352164  1300 ?        S    Mar09   0:00 /usr/sbin/apache2 -k start\nwww-data 29285  0.0  0.1 352164  1944 ?        S    Mar09   0:00 /usr/sbin/apache2 -k start\nwww-data 29286  0.0  0.1 352556  1956 ?        S    Mar09   0:00 /usr/sbin/apache2 -k start\nwww-data 29287  0.0  0.1 352164  1776 ?        S    Mar09   0:00 /usr/sbin/apache2 -k start\nwww-data 29318  0.0  0.2 352164  2508 ?        S    Mar09   0:00 /usr/sbin/apache2 -k start\nroot     29957  0.0  0.0 232308    84 ?        S    Mar09   0:04 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot     30931  0.0  0.0 232308    40 ?        S    Mar09   0:04 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot     31317  0.0  0.0  27720   300 ?        Ss   Mar08   0:02 /usr/sbin/cron -f\nwww-data 31812  0.0  0.1 352164  1116 ?        S    Mar09   0:00 /usr/sbin/apache2 -k start\nroot     31947  0.0  0.0 232308   180 ?        S    Mar09   0:02 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\n```\n\n\u3088\u304f\u898b\u308b\u3068 dequeueBroker.php \u304c\u3000\u305f\u304f\u3055\u3093\u3000\u5e38\u99d0\u3057\u3066\u3044\u308b\u3002\n\n\u3046\u30fc\u3080\u3001\u4e00\u56de dequeueBroker.php \u5168\u90e8 kill \u3057\u3066\u307f\u308b\u304b\u3002\n\n```\n# ps aux | grep dequeueBroker.php\n```\n\n```\nroot       469  0.0  0.0 232308   236 ?        S    Mar09   0:02 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot      1878  0.0  0.0 232308   108 ?        S    Mar09   0:03 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot      2957  0.0  0.0 232308    40 ?        S    Mar09   0:02 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot      4784  0.0  0.0 232308    92 ?        S    Mar09   0:03 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot      4945  0.0  0.0 232308   104 ?        S    Mar08   0:09 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot      5916  0.0  0.0 232308   172 ?        S    Mar09   0:02 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot      6301  0.0  0.0 232308   260 ?        S    Mar08   0:10 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot      6856  0.0  0.0 232308   112 ?        S    Mar09   0:02 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot      7795  0.0  0.0 232308   112 ?        S    Mar09   0:01 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot      8303  0.0  0.0 232308   132 ?        S    Mar08   0:09 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot      8732  0.0  0.0 232308   132 ?        S    Mar09   0:01 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot      9246  0.0  0.0 232308    80 ?        S    Mar08   0:09 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot      9664  0.0  0.0 232308   272 ?        S    Mar09   0:01 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot     10278  0.0  0.0 232308    52 ?        S    Mar08   0:08 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot     10632  0.0  0.0 232308   124 ?        S    Mar09   0:01 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot     11364  0.0  0.0 232308   276 ?        S    Mar08   0:08 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot     11567  0.0  0.0 232308    72 ?        S    Mar09   0:01 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot     12376  0.0  0.0 232308    76 ?        S    Mar08   0:08 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot     12582  0.0  0.0 232308   164 ?        S    Mar09   0:01 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot     13304  0.0  0.0 232308   180 ?        S    Mar08   0:07 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot     13713  0.0  0.0 232308    72 ?        S    Mar09   0:00 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot     14237  0.0  0.0 232308   100 ?        S    Mar08   0:07 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot     14706  0.0  0.0 232308   136 ?        S    Mar09   0:00 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot     15183  0.0  0.0 232308   204 ?        S    Mar08   0:07 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot     15791  0.0  0.0 232308    80 ?        S    00:05   0:00 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot     16115  0.0  0.0 232308    80 ?        S    Mar08   0:07 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot     16778  0.0  0.0 232308    60 ?        S    01:05   0:00 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot     17059  0.0  0.0 232308    76 ?        S    Mar08   0:07 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot     17967  0.0  0.0 232308   256 ?        S    02:05   0:00 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot     17993  0.0  0.0 232308   252 ?        S    Mar08   0:06 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot     19047  0.0  0.0 232308    76 ?        S    Mar08   0:06 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot     19194  0.0  1.3 232308 14048 ?        S    03:05   0:00 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot     19588  0.0  0.0  13068   984 pts/2    S+   03:29   0:00 grep --color=auto dequeueBroker.php\nroot     20097  0.0  0.0 232308   212 ?        S    Mar08   0:06 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot     21104  0.0  0.0 232308   224 ?        S    Mar08   0:05 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot     22197  0.0  0.0 232308   264 ?        S    Mar09   0:05 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot     23284  0.0  0.0 232308    96 ?        S    Mar09   0:05 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot     24410  0.0  0.0 232308   192 ?        S    Mar09   0:04 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot     25393  0.0  0.0 232308   196 ?        S    Mar09   0:04 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot     26650  0.0  0.0 232308   232 ?        S    Mar09   0:04 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot     27756  0.0  0.0 232308   228 ?        S    Mar09   0:04 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot     28734  0.0  0.0 232308   128 ?        S    Mar09   0:03 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot     29957  0.0  0.0 232308    84 ?        S    Mar09   0:04 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot     30931  0.0  0.0 232308    40 ?        S    Mar09   0:04 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot     31947  0.0  0.0 232308   180 ?        S    Mar09   0:02 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\n```\n\n\u3067\u3001\u4f55\u5217\u76ee\u3060\u3051\u62bd\u51fa\u3059\u308b\u3068\u3044\u3046\u3000\u30b3\u30de\u30f3\u30c9\u304c\u3042\u3063\u305f\u3068\u601d\u3046\u3093\u3060\u304c\u3001\u899a\u3048\u3066\u306a\u3044\u3093\u3067\u30b0\u30b0\u308b\u3002\n\n\u300cLinux\u30b3\u30de\u30f3\u30c9\u3067\u30c6\u30ad\u30b9\u30c8\u30c7\u30fc\u30bf\u3092\u81ea\u5728\u306b\u64cd\u308b\u300d \uff08orangain flavor\uff09\nhttp://orangain.hatenablog.com/entry/20100916/1284631280\n\n**\u3048\u3048\u3063\uff01** cat \u3068 cut \u304c\u3042\u308b\u306e\uff01\uff1f\n\ncat \u3067\u30d5\u30a3\u30fc\u30eb\u30c9\u62bd\u51fa\u3059\u308b\u65b9\u6cd5\u306a\u3093\u304b\u7121\u3044\u3088\u306a\u3001\u3068\u304b\u601d\u3063\u3066\u305f\u3093\u3060\u304c\u3002\n\u3058\u3083\u3042\u3001\u3053\u3046\u3057\u305f\u3089\u3069\u3046\u304b\uff1f\n\n```\n# ps aux | grep dequeueBroker.php | cut -f 2\n```\n\n\u30c0\u30e1\u3001\u30a2\u30a6\u30c4\u3002\u3000\u306a\u3093\u306b\u3082\u306a\u3089\u306a\u3044\u3002\n\n\u300c1\u3064\u4ee5\u4e0a\u306e\u9023\u7d9a\u3059\u308b\u30b9\u30da\u30fc\u30b9\u307e\u305f\u306f\u30bf\u30d6\u6587\u5b57\u3092\u533a\u5207\u308a\u3068\u3057\u3066\u51e6\u7406\u3059\u308b\u306b\u306f\u300d \uff08cut \u30b3\u30de\u30f3\u30c9\uff09\nhttps://hydrocul.github.io/wiki/commands/cut.html\n\n\u3053\u3046\u3044\u3063\u305f\u30d6\u30ed\u30b0\u8a18\u4e8b\u306f\u3000\uff29\uff34\u7cfb\u306e\u4f1a\u793e\u3000\u306b\u52d9\u3081\u3066\u3044\u308b\u3068\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u3067\u898b\u308c\u306a\u3044\u3057\u3001\uff29\uff34\u3058\u3083\u306a\u3044\u7cfb\u306e\u4f1a\u793e\u3000\u306b\u3044\u308b\u3068\u898b\u308c\u305f\u308a\u3059\u308b\u3002\u3000\uff29\uff34\u7cfb\u3068\u306f\u4f55\u306a\u306e\u304b\u2026\u2026\u3002\n\uff11\u3064\uff11\u3064\u306e\u30ea\u30b9\u30af\u3092\u5207\u3063\u3066\u3044\u308b\u3053\u3068\u3067\u4e07\u5168\u3001\u3068\u3044\u3046\u308f\u3051\u306a\u3093\u3060\u308d\u3046\u304c\u3001\u4e0d\u7965\u4e8b\uff11\u767a\u304c\u5e83\u304f\u62e1\u6563\u3059\u308b\uff29\uff34\u30c6\u30af\u30ce\u30ed\u30b8\u30fc\u304c\u4eca\u306e\uff29\uff34\u7cfb\u3092\u4f5c\u3063\u305f\u3002\n\n\u3058\u3083\u3042\u3001\u3053\u3046\u304b\uff1f\n\n```\n# ps aux | grep dequeueBroker.php | sed 's/[\\t ]\\+/\\t/g' | cut -f 2\n```\n\n```\n469\n1878\n2957\n4784\n4945\n5916\n6301\n6856\n7795\n8303\n8732\n9246\n9664\n10278\n10632\n11364\n11567\n12376\n12582\n13304\n13713\n14237\n14706\n15183\n15791\n16115\n16778\n17059\n17967\n17993\n19047\n19194\n19795\n20097\n21104\n22197\n23284\n24410\n25393\n26650\n27756\n28734\n29957\n30931\n31947\n```\n\n\u30b0\u30ec\u30fc\u30c8\uff01\n\n\u3067\u3001kill \u3092 for\u6587\u304b\u4f55\u304b\u3067\u56de\u305b\u306a\u3044\u306e\uff1f\n\n\u300c\u8907\u6570\u306e\u30d7\u30ed\u30bb\u30b9\u3092\u307e\u3068\u3081\u3066kill\u3059\u308b\u300d \uff08mikage014\u306e\u65e5\u8a18\uff09\nhttp://d.hatena.ne.jp/mikage014/20100205/1265330850\n\n\u3067\u3001\u3053\u308c\u3092\u8aad\u3080\u3068 kill \u306b\u306f\u305d\u308c\u304c\u3067\u304d\u308b\u3089\u3057\u3044\u3002\u3053\u3046\u304b\uff1f\n\n```\nkill `ps aux | grep dequeueBroker.php | sed 's/[\\t ]\\+/\\t/g' | cut -f 2`\n```\n\n```\n# kill `ps aux | grep dequeueBroker.php | sed 's/[\\t ]\\+/\\t/g' | cut -f 2`\n-su: kill: (19870) - No such process\n```\n\n\uff1f\n\n```\n# ps aux | grep dequeueBroker.php\nroot     19889  0.0  0.0  12936   984 pts/2    S+   03:45   0:00 grep --color=auto dequeueBroker.php\n```\n\n\u307e\u3042\u3001\u6d88\u3048\u3066\u304f\u308c\u305f\u3093\u3058\u3083\u306a\u3044\u304b\u3002\n\n\u3058\u3083\u3042\u3001\u6d6e\u304b\u3080\u702c \u3092\u30d0\u30c3\u30af\u30b0\u30e9\u30a6\u30f3\u30c9\u3067\u8d77\u52d5\u3057\u3066\u307f\u3088\u3046\u3002\n\n```\n# cd /home/\u2605user/shogi/ukamuse_sdt4/bin\n# ./apery &\n[1] 20023\n# ps aux | grep apery\nroot     20023  0.8 14.0 1325848 142852 pts/2  Tl   03:54   0:00 ./apery\nroot     20033  0.0  0.0  12936   984 pts/2    S+   03:55   0:00 grep --color=auto apery\n\n[1]+  Stopped                 ./apery\n```\n\n\u3053\u308c\u304c\u5206\u304b\u3089\u306a\u3044\u3002 **Stopped** \u3068\u66f8\u3044\u3066\u308b\u306e\u306a\u3002\n\n```\n# ps aux | grep apery\nroot     20023  0.1 14.0 1325848 142852 pts/2  Tl   03:54   0:00 ./apery\nroot     20055  0.0  0.0  12936   988 pts/2    S+   03:56   0:00 grep --color=auto apery\n```\n\n\u3082\u3046\uff11\u56de\u898b\u3066\u307f\u308b\u3068\u3001./apery \u30d7\u30ed\u30bb\u30b9\u306f\u307e\u3060\u5c45\u308b\u3088\u3046\u3060\u3002 Tl \u306f\u3000\u505c\u6b62\u4e2d\u3067\u3001\u30d7\u30ed\u30bb\u30b9\u751f\u6210\u4e2d\u306a\u306e\u3060\u308d\u3046\u304b\u3002\u306a\u3093\u306e\u3053\u3063\u3061\u3083\u3002\n\n\u3067\u306f\u3001\u30b9\u30fc\u30d1\u30fc\u30fb\u30e6\u30fc\u30b6\u30fc\u3068\u3001\u30ed\u30b0\u30a4\u30f3\u7528\u4e00\u822c\u30a2\u30ab\u30a6\u30f3\u30c8\u306e\uff12\u3064\u304b\u3089\u3000\u30ed\u30b0\u30a2\u30a6\u30c8\u3057\u3066\u307f\u308b\u3002\n\n```\n# logout\nThere are stopped jobs.\n# logout\n# logout\n```\n\n**\u3046\u30fc\u3093\uff1f**\n\n# \u518d\u5ea6\u30ed\u30b0\u30a4\u30f3\n\n\u4e00\u822c\u30e6\u30fc\u30b6\u30fc\u3067\u30ed\u30b0\u30a4\u30f3\u3057\u3001\n\n```\n$ sudo su -\n```\n\n\u304b\u3089\n\n```\n# ps aux | grep apery\nroot     20182  0.0  0.0  12936   988 pts/2    S+   04:02   0:00 grep --color=auto apery\n```\n\n./apery \u306f\u3044\u306a\u304f\u306a\u3063\u3066\u3044\u308b\u3002\u30ed\u30b0\u30a2\u30a6\u30c8\u3059\u308b\u3068\u3000\u30b8\u30e7\u30d6\u306f\u6b62\u307e\u308b\u306e\u3060\u308d\u3046\u304b\u3002\n\u3058\u3083\u3042\u6b21\u3002\n\n\u300c\u3010 nohup \u3011 \u30ed\u30b0\u30a2\u30a6\u30c8\u3057\u305f\u5f8c\u3082\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3057\u7d9a\u3051\u308b\u300d \uff08ITPro\uff09\nhttp://itpro.nikkeibp.co.jp/article/COLUMN/20060227/230850/\n\n```\n# cd /home/\u2605user/shogi/ukamuse_sdt4/bin\n# nohup ./apery &\n[1] 20237\nroot@\u2605:/home/\u2605user/shogi/ukamuse_sdt4/bin# nohup: ignoring input and appending output to 'nohup.out'\n```\n\n\u306a\u3093\u3060\u308d\u3046\u3002\n\n\u5165\u529b\u306f\u7121\u8996\u3055\u308c\u307e\u3059\u3001\u51fa\u529b\u306f nohup.out \u3067\u3059\u3001\u3068\u3044\u3046\u3053\u3068\u3060\u308d\u3046\u304b\u3002\n\u5165\u529b\u304c\u7121\u8996\u3055\u308c\u305f\u3089\u56f0\u308b\u3093\u3058\u3083\u306a\u3044\u304b\uff1f\n\n```\nnohup php ./apery > apery.out.log 2> apery.err.log < /dev/null &\n```\n\n\u6a19\u6e96\u5165\u529b\u306f\u3000\u4f55\u306b\u3057\u305f\u3089\u3044\u3044\u3093\u3060\uff1f\n\u30b3\u30f3\u30d4\u30e5\u30fc\u30bf\u30fc\u5c06\u68cb\u30bd\u30d5\u30c8\u306f\u3000\u6a19\u6e96\u5165\u529b\u304b\u3089\u3000\u30b3\u30de\u30f3\u30c9\u3092\u53d7\u3051\u4ed8\u3051\u308b\u306e\u3067\u3001\u305d\u308c\u3092\u9589\u3058\u3066\u3057\u307e\u3046\u3068\u3000\u5f79\u306b\u7acb\u305f\u306a\u3044\u3002\n\n\u305d\u308c\u306f\u3000\u3042\u3068\u3067\u8003\u3048\u308b\u3068\u3057\u3066\u3001 nohup \u3067\u5b9f\u884c\u3057\u305f\u30b3\u30de\u30f3\u30c9\u304c\u3001\u30ed\u30b0\u30a2\u30a6\u30c8\u5f8c\u3082\u6b8b\u3063\u3066\u3044\u308b\u306e\u304b\u8abf\u3079\u3066\u307f\u305f\u3044\u3002\n\n```\n# ps aux | grep apery      root     20436  0.0  0.0  12936   984 pts/2    S+   04:15   0:00 grep --color=auto apery\n[1]+  Done                    nohup ./apery\n```\n\nDone \u3063\u3066\u4f55\u3060\u308d\u3046\u304b\u3002 nohup \u304c Done \u306a\u306e\u3060\u308d\u3046\u304b\uff1f\n\n```\n# ps aux | grep apery\nroot     20447  0.0  0.0  12936   988 pts/2    S+   04:16   0:00 grep --color=auto apery\n```\n\n\u30ed\u30b0\u30a2\u30a6\u30c8\u3059\u308b\u9593\u3067\u3082\u306a\u304f\u3000\u6d88\u3048\u3066\u306a\u304f\u306a\u3063\u305f\u3002\nnohup \u306f ./apery \u3092\u5b9f\u884c\u3057\u306a\u304b\u3063\u305f\u306e\u3060\u308d\u3046\u304b\uff1f\n\n\u3058\u3083\u3042\u3001\u4f55\u304c nohup \u3067\u30d0\u30c3\u30af\u30b0\u30e9\u30a6\u30f3\u30c9\u3067\u5b9f\u884c\u3067\u304d\u308b\u3093\u3060\u308d\u3046\u304b\uff1f\n\n\u300cPHP while\u6587\u3068\u7121\u9650\u30eb\u30fc\u30d7\u300d \uff08\u30bc\u30ed\u30d7\u30ed \u30d6\u30ed\u30b0\u301c\uff10\u304b\u3089\u306e\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u5b66\u7fd2\u301c\uff09\nhttp://zeropuro.com/blog/?p=248\n\nloop28.php\n\n```\n<?php\nwhile(true){\n  sleep(1);\n}\n```\n\n```\n# php loop28.php &\n[1] 20615\n# ps aux | grep php\nroot      6091  0.0  0.0 311040   312 ?        Ss   Mar07   0:50 php-fpm: master process (/etc/php/7.0/fpm/php-fpm.conf)\nwww-data  6094  0.0  0.0 311040     0 ?        S    Mar07   0:00 php-fpm: pool www\nwww-data  6095  0.0  0.0 311040     0 ?        S    Mar07   0:00 php-fpm: pool www\nroot     20224  0.0  1.3 232308 14048 ?        S    04:05   0:00 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot     20615  0.1  1.3 230188 13304 pts/2    S    04:27   0:00 php loop28.php\nroot     20622  0.0  0.0  12936   988 pts/2    S+   04:28   0:00 grep --color=auto php\n```\n\n\u3058\u3083\u3042\u3001\u30ed\u30b0\u30a2\u30a6\u30c8\u3057\u3066\u307f\u308b\u3002\n\n```\n# logout\n# logout\n```\n\n\u3055\u3063\u304d\u306f\uff13\u56de\u3067\u3001\u4eca\u56de\u306f\uff12\u56de\u3060\u3002\u4f55\u306e\u9055\u3044\u304c\u3042\u308b\u3093\u3060\u308d\u3046\u3002\n\n```\n# ps aux | grep php\nroot      6091  0.0  0.0 311040   312 ?        Ss   Mar07   0:50 php-fpm: master process (/etc/php/7.0/fpm/php-fpm.conf)\nwww-data  6094  0.0  0.0 311040     0 ?        S    Mar07   0:00 php-fpm: pool www\nwww-data  6095  0.0  0.0 311040     0 ?        S    Mar07   0:00 php-fpm: pool www\nroot     20224  0.0  1.3 232308 14048 ?        S    04:05   0:00 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot     20615  0.0  1.3 230188 13304 ?        S    04:27   0:00 php loop28.php\nroot     20743  0.0  0.0  12936   984 pts/3    S+   04:33   0:00 grep --color=auto php\n```\n\n\u4eca\u5ea6\u306f loop28.php \u304c\u3044\u308b\u3088\u3046\u3060\u3002\n\n\u3060\u3063\u305f\u3089 PHP \u3068 C#\u3001C++ \u304c\u30d7\u30ed\u30bb\u30b9\u9593\u901a\u4fe1\u3067\u304d\u308b\u3093\u306a\u3089\u3000\u8a71\u3057\u306f\u65e9\u3044\u3093\u3060\u304c\u3001PHP \u3068 C# \u306f\u30d7\u30ed\u30bb\u30b9\u9593\u901a\u4fe1\u304c\u50cd\u304b\u306a\u304b\u3063\u305f\u306e\u306f\u3000\u8a18\u4e8b\uff1c\u305d\u306e\uff11\uff1e\uff5e\uff1c\u305d\u306e\uff13\uff1e\u306e\u3069\u3053\u304b\u306b\u66f8\u3044\u305f\u306e\u3060\u3063\u305f\u3002\n\n# C++ \u306e\u7121\u9650\u30eb\u30fc\u30d7\u306f\u5e38\u99d0\u3067\u304d\u308b\u3060\u308d\u3046\u304b\uff1f\n\n\u300c\u6642\u9593\u30fb\u6642\u523b\u51e6\u7406\u306b\u3064\u3044\u3066(4)\u300d \uff08LinuxC\uff09\nhttp://linuxc.info/time/time6/\n\n\u3060\u3081\u3001Windows\u3067\u52d5\u304b\u306a\u3044\u3002\n\n\u300cSleep for milliseconds\u300d \uff08stack overflow\uff09\nhttp://stackoverflow.com/questions/4184468/sleep-for-milliseconds\n\n\u3058\u3083\u3042\u3001\u3053\u3046\u304b\u3002\n\n```\n// Cpp_Tamesi28.cpp : Defines the entry point for the console application.\n//\n\n#include <chrono>\n#include <thread>\n\n#if WINDOWS\n#include \"stdafx.h\"\n#endif\n\nint main(void)\n{\n\tfor (;;) {\n\t\tstd::this_thread::sleep_for(std::chrono::seconds(1));\n\t}\n\treturn 0;\n}\n```\n\nVisual Studio 2015 C++ \u3067\u3000\u30d7\u30ea\u30d7\u30ed\u30bb\u30c3\u30b5\u5b9a\u7fa9\u3092\u3000\u30b3\u30de\u30f3\u30c9\u30e9\u30a4\u30f3\u5f15\u6570\u306b\u4ed8\u3051\u308b\u306b\u306f\u3069\u3046\u3084\u308b\u3093\u3060\uff1f\n\n\u300c/D (\u30d7\u30ea\u30d7\u30ed\u30bb\u30c3\u30b5\u306e\u5b9a\u7fa9)\u300d \uff08MSDN\uff09\nhttps://msdn.microsoft.com/ja-jp/library/hhzbb5c8.aspx\n\n\u30e1\u30a4\u30f3\u30e1\u30cb\u30e5\u30fc\u306e [Project] \u304b\u3089\u3001\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306e\u30d7\u30ed\u30d1\u30c6\u30a3\u30fc\u306e\u30da\u30fc\u30b8\u3092\u958b\u304d\u3001\n[Configuration Properties] - [C/C++] - [Preprocessor] - [Preprocessor Definitions]\n\u3068\u9032\u3093\u3067\u3001\n\n```\n_DEBUG;_CONSOLE;%(PreprocessorDefinitions)\n```\n\n\u306e\u672b\u5c3e\u306b WINDOWS \u3068\u3067\u3082\u4ed8\u3051\u3088\u3046\u3002\n\n```\n_DEBUG;_CONSOLE;%(PreprocessorDefinitions);WINDOWS\n```\n\n\u30c0\u30e1\u3060\u3002\u3053\u3046\u304b\u3002\n\n```\n_DEBUG;_CONSOLE;WINDOWS;%(PreprocessorDefinitions)\n```\n\n\u3053\u308c\u3082\u30c0\u30e1\u3002\n\n**\u3042\u30fc\uff01** x86 \u306b\u306a\u3063\u3066\u3044\u308b\u3002 x64 \u306b\u5408\u308f\u305b\u3088\u3046\u3002\n\u3053\u308c\u3067\uff2f\uff2b\u3002\n\nstdafx.h\n\n```\n// stdafx.h : include file for standard system include files,\n// or project specific include files that are used frequently, but\n// are changed infrequently\n//\n\n#pragma once\n\n#include \"targetver.h\"\n\n#include <stdio.h>\n#include <tchar.h>\n\n\n// TODO: reference additional headers your program requires here\n```\n\n\u306e\u3001\n\n```\n// stdafx.h : include file for standard system include files,\n// or project specific include files that are used frequently, but\n// are changed infrequently\n//\n\n#pragma once\n\n#if WINDOWS\n#include \"targetver.h\"\n\n#include <stdio.h>\n#include <tchar.h>\n#endif\n\n\n// TODO: reference additional headers your program requires here\n```\n\n\u5185\u5bb9\u3092\n\n```\n#if WINDOWS\n#endif\n```\n\n\u3067\u56f2\u3093\u3060\u3002\n\u5b9f\u884c\u3059\u308b\u3068\u3001\u5165\u529b\u3092\u53d7\u3051\u4ed8\u3051\u306a\u3044\u30b3\u30de\u30f3\u30c9\u30fb\u30d7\u30ed\u30f3\u30d7\u30c8\u30fb\u30a6\u30a3\u30f3\u30c9\u30a6\u304c\u958b\u3044\u305f\u3002\n\nUbuntu \u306b\u30bd\u30fc\u30b9\u3092\u6301\u3063\u3066\u3044\u3063\u3066\u3001\u52d5\u304f\u3060\u308d\u3046\u304b\uff1f\n\u3057\u304b\u3057 Makefile \u306e\u66f8\u304d\u65b9\u304c\u5206\u304b\u3089\u306a\u3044\u3002\n\n```\n# cd /home/\u2605user/shogi\n# mkdir cpp_service\n# mkdir tamesi28.d\n# nano tamesi28.cpp\n```\n\n```\n#include <chrono>\n#include <thread>\n\nint main(void)\n{\n        for (;;) {\n                std::this_thread::sleep_for(std::chrono::seconds(1));\n        }\n        return 0;\n}\n```\n\n\u3053\u3093\u306a\u3093\u3067\u3000\u3044\u3044\u3093\u3060\u308d\u3046\u304b\uff1f\ng++ \u3067\u30b3\u30f3\u30d1\u30a4\u30eb\u3059\u308b\u306b\u306f\uff1f\n\n\u300cg++\u300d \uff08C++\uff09\nhttp://kaworu.jpn.org/cpp/g++\n\n\u30d5\u30a1\u30a4\u30eb\u540d\u3092\u4ed8\u3051\u308b\u3060\u3051\u304b\u3002\n\n```\n# g++ tamesi28.cpp\nIn file included from /usr/include/c++/5/chrono:35:0,\n                 from tamesi28.cpp:1:\n/usr/include/c++/5/bits/c++0x_warning.h:32:2: error: #error This file requires compiler and library support for the ISO C++ 2011 standard. This support must be enabled with the -std=c++11 or -std=gnu++11 compiler options.\n #error This file requires compiler and library support \\\n  ^\ntamesi28.cpp: In function \u2018int main()\u2019:\ntamesi28.cpp:7:8: error: \u2018std::this_thread\u2019 has not been declared\n   std::this_thread::sleep_for(std::chrono::seconds(1));\n        ^\ntamesi28.cpp:7:36: error: \u2018std::chrono\u2019 has not been declared\n   std::this_thread::sleep_for(std::chrono::seconds(1));\n                                    ^\n```\n\nstd::this_thread \u3082\u3001std::chrono \u3082\u4f7f\u3048\u306a\u3044\u306e\u304b\u3002\n\n\u6d6e\u304b\u3080\u702c usi.cpp\n\n```\n            std::this_thread::sleep_for(std::chrono::seconds(5)); // \u6307\u5b9a\u79d2\u3060\u3051\u5f85\u6a5f\u3057\u3001\u9032\u6357\u3092\u8868\u793a\u3059\u308b\u3002\n```\n\n\u6d6e\u304b\u3080\u702c\u3067\u306f\u4f7f\u3063\u3066\u3044\u308b\u3057\u3001g++ \u3067\u30b3\u30f3\u30d1\u30a4\u30eb\u3067\u304d\u3066\u3044\u308b\u3068\u601d\u3046\u3093\u3060\u304c\u3002\nMakefile \u306b\u4ed5\u7d44\u307f\u304c\u3042\u308b\u3093\u3060\u308d\u3046\u304b\uff1f\n\nMakefile \u5192\u982d\u306e\uff13\u884c\n\n```\nCOMPILER = g++\n#COMPILER = mpicxx\nCFLAGS   = -std=c++11 -fno-exceptions -fno-rtti -Wextra -Ofast -MMD -MP -fopenmp\n```\n\n\u3053\u306e\u3042\u305f\u308a\u3001\u95a2\u4fc2\u304c\u3042\u308b\u3093\u3058\u3083\u306a\u3044\u3060\u308d\u3046\u304b\uff1f\n\n```\n# g++ -std=c++11 tamesi28.cpp\n```\n\n\u5b9f\u884c\u3067\u304d\u305f\u3088\u3046\u3060\u3002\n\n```\n# ls\na.out  tamesi28.cpp\n# ./a.out\n\n```\n\n\u3088\u3057\u3001\u7121\u9650\u30eb\u30fc\u30d7\u3057\u3066\u3044\u308b\u3088\u3046\u3060\u3002\n\n[Ctrl]+[C]\n\n\u3067\u629c\u3051\u308b\u3002\n\n```\n# ./a.out &\n[1] 21556\n```\n\n\u3057\u307e\u3063\u305f\u3001\u30d5\u30a1\u30a4\u30eb\u540d\u304c\u691c\u7d22\u3057\u3065\u3089\u3044\u3002\n\n```\n# ps aux | grep a.out\nroot     21556  0.0  0.0   4216   364 pts/3    S    05:22   0:00 ./a.out\nroot     21569  0.0  0.0  12936   988 pts/3    S+   05:22   0:00 grep --color=auto a.out\n```\n\n\u52d5\u3044\u3066\u3044\u308b\u3088\u3046\u3060\u3002\n\u30ed\u30b0\u30a2\u30a6\u30c8\u3057\u3066\u307f\u308b\u3002\n\n```\n# logout\n$ logout\n```\n\n\u30ed\u30b0\u30a4\u30f3\u3057\u306a\u304a\u3059\u3002\n\n```\n# ps aux | grep a.out\nroot     21556  0.0  0.0   4216   364 ?        S    05:22   0:00 ./a.out\nroot     21658  0.0  0.0  12936   984 pts/4    S+   05:25   0:00 grep --color=auto a.out\n```\n\n\u3075\u3064\u3046\u306b\u5c45\u308b\u306a\u2026\u2026\u3002\n\n\u3058\u3083\u3042\u3001C++ \u306f\u30d7\u30ed\u30bb\u30b9\u9593\u901a\u4fe1\u3067\u304d\u308b\u306e\u304b\u8abf\u3079\u3066\u307f\u3088\u3046\u3002\n\n\u300cRabbitMQ Tutorials\u300d \uff08RabbitMQ\uff09\nhttp://www.rabbitmq.com/getstarted.html\n\n**\u3046\u30fc\u3093\uff1f** RabbitMQ \u306b C++ \u306e\u8aac\u660e\u304c\u7121\u3044\uff1f\n\n\u300cClients & Developer Tools\u300d \uff08RabbitMQ\uff09\nhttps://www.rabbitmq.com/devtools.html\n\n\uff14\u3064\u3042\u308b\u3088\u3046\u3060\u304c\u3001\n\n\u300cAMQP-CPP\u300d \uff08CopernicaMarketingSoftware/AMQP-CPP\uff09\nhttps://github.com/CopernicaMarketingSoftware/AMQP-CPP\n\n\u30b5\u30f3\u30d7\u30eb\u304c\u66f8\u3044\u3066\u3042\u308b\u3053\u308c\u3092\u8abf\u3079\u3066\u307f\u308b\u304b\u3002\n\nAMQP-CPP-master \u3092 FileZilla\u3067\u30b3\u30d4\u30fc\u3002\u3053\u308c\u3001RabbitMQ \u3058\u3083\u306a\u304f\u3066\u3001RabbitMQ \u98a8\u306b\u3057\u305f AMQP \u3060\u3088\u306a\u3002\n\n```\ncd /home/\u2605user/shogi/AMQP-CPP-master\ncd AMQP-CPP-master\n# nano Makefile\n```\n\n\u3058\u3083\u3042\u3001\n\n```\n# make pure\n```\n\n```\n# ls\namqpcpp.h       include  Makefile   set_cxx_norm.cmake  tests\nCMakeLists.txt  LICENSE  README.md  src\n```\n\n\u5b9f\u884c\u30d5\u30a1\u30a4\u30eb\u306f\u3069\u3053\u306b\u4f5c\u3089\u308c\u305f\u306e\u304b\uff1f\u3000\u3042\u308b\u3044\u306f\u30e9\u30a4\u30d6\u30e9\u30ea\u306f\u3069\u3053\u3060\u3002\n\n```\n# make\n# make install\n# make pure\nmake -C src pure\nmake[1]: Entering directory '/home/\u2605user/shogi/AMQP-CPP-master/src'\nmake[1]: Nothing to be done for 'pure'.\nmake[1]: Leaving directory '/home/\u2605user/shogi/AMQP-CPP-master/src'\n```\n\n\u3046\u30fc\u3093\u3002 src \u30d5\u30a9\u30eb\u30c0\u30fc\u306e\u4e2d\u3092\u898b\u308c\u3070\u3044\u3044\u306e\u304b\uff1f\n\n\u5b9f\u884c\u5f62\u5f0f\u306e\u30d5\u30a1\u30a4\u30eb\u304c\uff11\u3064\u3060\u3051\u3042\u308b\u3002\nlibamqpcpp.so.2.6.2\n\n\u3053\u308c\u3092\u3069\u3046\u3084\u3063\u3066\u4f7f\u3046\u306e\u304b\uff1f\n\n\u30b5\u30f3\u30d7\u30eb\u30fb\u30d7\u30ed\u30b0\u30e9\u30e0\u306f\u3053\u3053\u3060\u308d\u3046\u304b\uff1f\n\n\u300camqpcpp/examples/\u300d \uff08akalend/amqpcpp\uff09\nhttps://github.com/akalend/amqpcpp/tree/master/examples\n\nsrc\u30d5\u30a9\u30eb\u30c0\u30fc\u306e\u4e2d\u306b\u3082 Makefile \u304c\u3042\u308b\u306a\u3002\n\n```\n/home/\u2605user/shogi/AMQP-CPP-master/src# make pure\n```\n\nlib.so. \u3068\u3044\u3046\u5b9f\u884c\u5f62\u5f0f\u30d5\u30a1\u30a4\u30eb\u304c\u3067\u304d\u305f\u3088\u3046\u3060\u304c\u3001\u306a\u3093\u306e\u3053\u3068\u3084\u3089\u3002\n\n```\nroot@\u2605:/home/\u2605user/shogi/AMQP-CPP-master# make pure\nmake -C src pure\nmake[1]: Entering directory '/home/\u2605user/shogi/AMQP-CPP-master/src'\nmake[1]: Nothing to be done for 'pure'.\nmake[1]: Leaving directory '/home/\u2605user/shogi/AMQP-CPP-master/src'\nroot@\u2605:/home/\u2605user/shogi/AMQP-CPP-master# make install\nmkdir -p /usr/include/amqpcpp\nmkdir -p /usr/lib\ncp -f amqpcpp.h /usr/include\ncp -f include/*.h /usr/include/amqpcpp\ncp -f src/libamqpcpp.so.2.6.2 /usr/lib\ncp -f src/libamqpcpp.a.2.6.2 /usr/lib\nln -r -s -f /usr/lib/libamqpcpp.so.2.6.2 /usr/lib/libamqpcpp.so.2.6\nln -r -s -f /usr/lib/libamqpcpp.so.2.6.2 /usr/lib/libamqpcpp.so\nln -r -s -f /usr/lib/libamqpcpp.a.2.6.2 /usr/lib/libamqpcpp.a\n```\n\n\u3082\u3046\u3001\u4f7f\u3048\u308b\u3088\u3046\u306b\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\u3057\u3066\u304f\u308c\u3066\u308b\u3093\u3058\u3083\u306a\u3044\u304b\uff1f /usr/lib \u306b\u3002\n\u3058\u3083\u3042\u3001\u30bd\u30fc\u30b9\u3092\u66f8\u3044\u3066\u307f\u3088\u3046\u3002\n\n```\n/home/\u2605user/shogi/cpp_service# nano tamesi29a7_main.cpp\n```\n\ntamesi29a7_main.cpp\n\n```\n#include <ev.h>\n#include <amqpcpp.h>\n#include <amqpcpp/libev.h>\n\nint main()\n{\n    // access to the event loop\n    auto *loop = EV_DEFAULT;\n\n    // handler for libev (so we don't have to implement AMQP::TcpHandler!)\n    AMQP::LibEvHandler handler(loop);\n\n    // make a connection\n    AMQP::TcpConnection connection(&handler, AMQP::Address(\"amqp://localhost/\"));\n\n    // we need a channel too\n    AMQP::TcpChannel channel(&connection);\n\n    // create a temporary queue\n    channel.declareQueue(AMQP::exclusive).onSuccess([&connection](const std::string &name, uint32_t messagecount, uint32_t consumercount) {\n\n        // report the name of the temporary queue\n        std::cout << \"declared queue \" << name << std::endl;\n\n        // now we can close the connection\n        connection.close();\n    });\n\n    // run the loop\n    ev_run(loop, 0);\n\n    // done\n    return 0;\n}\n```\n\n```\n# g++ tamesi29a7_main.cpp\ntamesi29a7_main.cpp:1:16: fatal error: ev.h: No such file or directory\ncompilation terminated.\n```\n\n\u9055\u3046\u306e\u304b\u3002\n\n# libev\n\n\u300clibev\u306eev_async\u3068\u306f\u4f55\u306b\u4f7f\u7528\u3059\u308b\u3082\u306e\u3067\u3059\u304b\uff1f\u300d \uff08stack overflow\uff09\nhttp://ja.stackoverflow.com/questions/9066/libev%E3%81%AEev-async%E3%81%A8%E3%81%AF%E4%BD%95%E3%81%AB%E4%BD%BF%E7%94%A8%E3%81%99%E3%82%8B%E3%82%82%E3%81%AE%E3%81%A7%E3%81%99%E3%81%8B\n\nev\u30e9\u30a4\u30d6\u30e9\u30ea\u30fc\u3068\u3044\u3046\u306e\u304c\u3042\u308b\u306e\u304b\u3002\n\n\u300clibev\u306b\u3088\u308b\u975e\u540c\u671f\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u300d\uff08Qiita\uff09\nhttp://qiita.com/0xfffffff7/items/c5287067623fdbd2c3cb\n\n\u3058\u3083\u3042\u3001\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u3066\u307f\u3088\u3002\n\n```\n# apt-get -y install libev\nReading package lists... Done\nBuilding dependency tree\nReading state information... Done\nE: Unable to locate package libev\n```\n\n\u305d\u3093\u306a\u30b3\u30de\u30f3\u30c9\u306f\u7121\u3044\u306e\u304b\u2026\u2026\u3002\n\n\u300cHow to install libev-dev on Ubuntu 14.04 (Trusty Tahr)\u300d\uff08HOW TO INSTALL\uff09\nhttps://www.howtoinstall.co/en/ubuntu/trusty/libev-dev\n\n```\nsudo apt-get update\nsudo apt-get install libev-dev\n```\n\n\u5165\u3063\u305f\u304b\u306a\u3002\n\n```\n# g++ tamesi29a7_main.cpp\n```\n\n\u5927\u91cf\u306e\u30a8\u30e9\u30fc\u304c\u51fa\u3066\u304d\u305f\u3002\u3053\u3046\u304b\uff1f\n\n```\n# g++ -std=c++11 tamesi29a7_main.cpp\n```\n\n```\n/tmp/ccMfSVKb.o: In function `main':\ntamesi29a7_main.cpp:(.text+0x18f): undefined reference to `ev_default_loop'\ntamesi29a7_main.cpp:(.text+0x1e3): undefined reference to `AMQP::TcpConnection::TcpConnection(AMQP::TcpHandler*, AMQP::Address const&)'\ntamesi29a7_main.cpp:(.text+0x22d): undefined reference to `AMQP::exclusive'\ntamesi29a7_main.cpp:(.text+0x276): undefined reference to `ev_run'\n/tmp/ccMfSVKb.o: In function `AMQP::Field::~Field()':\ntamesi29a7_main.cpp:(.text._ZN4AMQP5FieldD2Ev[_ZN4AMQP5FieldD5Ev]+0xd): undefined reference to `vtable for AMQP::Field'\n/tmp/ccMfSVKb.o: In function `AMQP::Field::Field()':\ntamesi29a7_main.cpp:(.text._ZN4AMQP5FieldC2Ev[_ZN4AMQP5FieldC5Ev]+0x9): undefined reference to `vtable for AMQP::Field'\n/tmp/ccMfSVKb.o: In function `AMQP::Table::Table()':\ntamesi29a7_main.cpp:(.text._ZN4AMQP5TableC2Ev[_ZN4AMQP5TableC5Ev]+0x19): undefined reference to `vtable for AMQP::Table'\n/tmp/ccMfSVKb.o: In function `AMQP::Table::~Table()':\ntamesi29a7_main.cpp:(.text._ZN4AMQP5TableD2Ev[_ZN4AMQP5TableD5Ev]+0xd): undefined reference to `vtable for AMQP::Table'\n/tmp/ccMfSVKb.o: In function `AMQP::Channel::Channel(AMQP::Connection*)':\ntamesi29a7_main.cpp:(.text._ZN4AMQP7ChannelC2EPNS_10ConnectionE[_ZN4AMQP7ChannelC5EPNS_10ConnectionE]+0x30): undefined reference to `AMQP::ChannelImpl::ChannelImpl()'\ntamesi29a7_main.cpp:(.text._ZN4AMQP7ChannelC2EPNS_10ConnectionE[_ZN4AMQP7ChannelC5EPNS_10ConnectionE]+0x65): undefined reference to `AMQP::ChannelImpl::attach(AMQP::Connection*)'\n/tmp/ccMfSVKb.o: In function `AMQP::Channel::~Channel()':\ntamesi29a7_main.cpp:(.text._ZN4AMQP7ChannelD2Ev[_ZN4AMQP7ChannelD5Ev]+0x2c): undefined reference to `AMQP::ChannelImpl::close()'\n/tmp/ccMfSVKb.o: In function `AMQP::Channel::declareQueue(int)':\ntamesi29a7_main.cpp:(.text._ZN4AMQP7Channel12declareQueueEi[_ZN4AMQP7Channel12declareQueueEi]+0x68): undefined reference to `AMQP::ChannelImpl::declareQueue(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int, AMQP::Table const&)'\n/tmp/ccMfSVKb.o: In function `AMQP::Connection::~Connection()':\ntamesi29a7_main.cpp:(.text._ZN4AMQP10ConnectionD2Ev[_ZN4AMQP10ConnectionD5Ev]+0x24): undefined reference to `AMQP::ConnectionImpl::~ConnectionImpl()'\n/tmp/ccMfSVKb.o: In function `AMQP::Connection::close()':\ntamesi29a7_main.cpp:(.text._ZN4AMQP10Connection5closeEv[_ZN4AMQP10Connection5closeEv]+0x18): undefined reference to `AMQP::ConnectionImpl::close()'\n/tmp/ccMfSVKb.o: In function `AMQP::TcpConnection::~TcpConnection()':\ntamesi29a7_main.cpp:(.text._ZN4AMQP13TcpConnectionD2Ev[_ZN4AMQP13TcpConnectionD5Ev]+0xd): undefined reference to `vtable for AMQP::TcpConnection'\ntamesi29a7_main.cpp:(.text._ZN4AMQP13TcpConnectionD2Ev[_ZN4AMQP13TcpConnectionD5Ev]+0x19): undefined reference to `vtable for AMQP::TcpConnection'\ntamesi29a7_main.cpp:(.text._ZN4AMQP13TcpConnectionD2Ev[_ZN4AMQP13TcpConnectionD5Ev]+0x51): undefined reference to `AMQP::Watchable::~Watchable()'\n/tmp/ccMfSVKb.o: In function `AMQP::LibEvHandler::Watcher::callback(ev_loop*, ev_io*, int)':\ntamesi29a7_main.cpp:(.text._ZN4AMQP12LibEvHandler7Watcher8callbackEP7ev_loopP5ev_ioi[_ZN4AMQP12LibEvHandler7Watcher8callbackEP7ev_loopP5ev_ioi]+0x33): undefined reference to `AMQP::TcpConnection::process(int, int)'\n/tmp/ccMfSVKb.o: In function `AMQP::LibEvHandler::Watcher::Watcher(ev_loop*, AMQP::TcpConnection*, int, int)':\ntamesi29a7_main.cpp:(.text._ZN4AMQP12LibEvHandler7WatcherC2EP7ev_loopPNS_13TcpConnectionEii[_ZN4AMQP12LibEvHandler7WatcherC5EP7ev_loopPNS_13TcpConnectionEii]+0xbf): undefined reference to `ev_io_start'\n/tmp/ccMfSVKb.o: In function `AMQP::LibEvHandler::Watcher::~Watcher()':\ntamesi29a7_main.cpp:(.text._ZN4AMQP12LibEvHandler7WatcherD2Ev[_ZN4AMQP12LibEvHandler7WatcherD5Ev]+0x2f): undefined reference to `ev_io_stop'\n/tmp/ccMfSVKb.o: In function `AMQP::LibEvHandler::Watcher::events(int)':\ntamesi29a7_main.cpp:(.text._ZN4AMQP12LibEvHandler7Watcher6eventsEi[_ZN4AMQP12LibEvHandler7Watcher6eventsEi]+0x26): undefined reference to `ev_io_stop'\ntamesi29a7_main.cpp:(.text._ZN4AMQP12LibEvHandler7Watcher6eventsEi[_ZN4AMQP12LibEvHandler7Watcher6eventsEi]+0x5d): undefined reference to `ev_io_start'\ncollect2: error: ld returned 1 exit status\n```\n\n\u3069\u3046\u3057\u305f\u3082\u306e\u304b\u3002\n\n\u300cc libev undefined reference to `ev_default_loop'\u300d \uff08stack overflow\uff09\nhttp://stackoverflow.com/questions/13844309/c-libev-undefined-reference-to-ev-default-loop\n\n\u300c-lev\u300d\u3068\u3044\u3046\u30aa\u30d7\u30b7\u30e7\u30f3\u3092\u4ed8\u3051\u305f\u3089\u3044\u3044\u306e\u3060\u308d\u3046\u304b\uff1f\n\n```\n# g++ -std=c++11 tamesi29a7_main.cpp -lev\n```\n\n```\n/tmp/ccbptlAj.o: In function `main':\ntamesi29a7_main.cpp:(.text+0x1e3): undefined reference to `AMQP::TcpConnection::TcpConnection(AMQP::TcpHandler*, AMQP::Address const&)'\ntamesi29a7_main.cpp:(.text+0x22d): undefined reference to `AMQP::exclusive'\n/tmp/ccbptlAj.o: In function `AMQP::Field::~Field()':\ntamesi29a7_main.cpp:(.text._ZN4AMQP5FieldD2Ev[_ZN4AMQP5FieldD5Ev]+0xd): undefined reference to `vtable for AMQP::Field'\n/tmp/ccbptlAj.o: In function `AMQP::Field::Field()':\ntamesi29a7_main.cpp:(.text._ZN4AMQP5FieldC2Ev[_ZN4AMQP5FieldC5Ev]+0x9): undefined reference to `vtable for AMQP::Field'\n/tmp/ccbptlAj.o: In function `AMQP::Table::Table()':\ntamesi29a7_main.cpp:(.text._ZN4AMQP5TableC2Ev[_ZN4AMQP5TableC5Ev]+0x19): undefined reference to `vtable for AMQP::Table'\n/tmp/ccbptlAj.o: In function `AMQP::Table::~Table()':\ntamesi29a7_main.cpp:(.text._ZN4AMQP5TableD2Ev[_ZN4AMQP5TableD5Ev]+0xd): undefined reference to `vtable for AMQP::Table'\n/tmp/ccbptlAj.o: In function `AMQP::Channel::Channel(AMQP::Connection*)':\ntamesi29a7_main.cpp:(.text._ZN4AMQP7ChannelC2EPNS_10ConnectionE[_ZN4AMQP7ChannelC5EPNS_10ConnectionE]+0x30): undefined reference to `AMQP::ChannelImpl::ChannelImpl()'\ntamesi29a7_main.cpp:(.text._ZN4AMQP7ChannelC2EPNS_10ConnectionE[_ZN4AMQP7ChannelC5EPNS_10ConnectionE]+0x65): undefined reference to `AMQP::ChannelImpl::attach(AMQP::Connection*)'\n/tmp/ccbptlAj.o: In function `AMQP::Channel::~Channel()':\ntamesi29a7_main.cpp:(.text._ZN4AMQP7ChannelD2Ev[_ZN4AMQP7ChannelD5Ev]+0x2c): undefined reference to `AMQP::ChannelImpl::close()'\n/tmp/ccbptlAj.o: In function `AMQP::Channel::declareQueue(int)':\ntamesi29a7_main.cpp:(.text._ZN4AMQP7Channel12declareQueueEi[_ZN4AMQP7Channel12declareQueueEi]+0x68): undefined reference to `AMQP::ChannelImpl::declareQueue(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int, AMQP::Table const&)'\n/tmp/ccbptlAj.o: In function `AMQP::Connection::~Connection()':\ntamesi29a7_main.cpp:(.text._ZN4AMQP10ConnectionD2Ev[_ZN4AMQP10ConnectionD5Ev]+0x24): undefined reference to `AMQP::ConnectionImpl::~ConnectionImpl()'\n/tmp/ccbptlAj.o: In function `AMQP::Connection::close()':\ntamesi29a7_main.cpp:(.text._ZN4AMQP10Connection5closeEv[_ZN4AMQP10Connection5closeEv]+0x18): undefined reference to `AMQP::ConnectionImpl::close()'\n/tmp/ccbptlAj.o: In function `AMQP::TcpConnection::~TcpConnection()':\ntamesi29a7_main.cpp:(.text._ZN4AMQP13TcpConnectionD2Ev[_ZN4AMQP13TcpConnectionD5Ev]+0xd): undefined reference to `vtable for AMQP::TcpConnection'\ntamesi29a7_main.cpp:(.text._ZN4AMQP13TcpConnectionD2Ev[_ZN4AMQP13TcpConnectionD5Ev]+0x19): undefined reference to `vtable for AMQP::TcpConnection'\ntamesi29a7_main.cpp:(.text._ZN4AMQP13TcpConnectionD2Ev[_ZN4AMQP13TcpConnectionD5Ev]+0x51): undefined reference to `AMQP::Watchable::~Watchable()'\n/tmp/ccbptlAj.o: In function `AMQP::LibEvHandler::Watcher::callback(ev_loop*, ev_io*, int)':\ntamesi29a7_main.cpp:(.text._ZN4AMQP12LibEvHandler7Watcher8callbackEP7ev_loopP5ev_ioi[_ZN4AMQP12LibEvHandler7Watcher8callbackEP7ev_loopP5ev_ioi]+0x33): undefined reference to `AMQP::TcpConnection::process(int, int)'\ncollect2: error: ld returned 1 exit status\n```\n\n\u30a8\u30e9\u30fc\u306f\u6e1b\u3063\u305f\u3060\u308d\u3046\u304b\u3002\n\n\u300cBuild against rabbitmq-c\u300d\uff08stack overflow\uff09\nhttp://stackoverflow.com/questions/12028112/build-against-rabbitmq-c\n\nGit Hub \u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u306e\u8aac\u660e\u3092\u8aad\u3080\u3068\u3001\u30e9\u30a4\u30d6\u30e9\u30ea\u3068\u30ea\u30f3\u30af\u3057\u3066\u304f\u3060\u3055\u3044\u3001\u3068\u66f8\u3044\u3066\u3044\u308b\u306a\u3002\u3053\u3046\u304b\u3002\n\n```\n# g++ -std=c++11 tamesi29a7_main.cpp -lev -lamqpcpp\n```\n\n```\n/usr/lib/gcc/x86_64-linux-gnu/5/../../../../lib/libamqpcpp.so: undefined reference to `pthread_create'\ncollect2: error: ld returned 1 exit status\n```\n\n\u306a\u3093\u3060\u308d\u3046\uff1f\n\n\u300cUndefined reference to pthread_create in Linux\u300d\uff08stack overflow\uff09\nhttp://stackoverflow.com/questions/1662909/undefined-reference-to-pthread-create-in-linux\n\n\u300c-pthread\u300d\u3082\u4ed8\u3051\u305f\u3089\u3044\u3044\u3093\u3060\u308d\u3046\u304b\uff1f\n\n```\n# g++ -std=c++11 tamesi29a7_main.cpp -lev -lamqpcpp -pthread\n```\n\n\u30b3\u30f3\u30d1\u30a4\u30eb\u306f\u901a\u3063\u305f\u3088\u3046\u3060\u3002\u5b9f\u884c\u30d5\u30a1\u30a4\u30eb\u306e\u540d\u524d\u304c a.out \u306b\u306a\u3063\u3066\u308b\u304c\u2026\u2026\u3002\u3053\u3046\u304b\u3002\n\n```\n# g++ -std=c++11 tamesi29a7_main.cpp -lev -lamqpcpp -pthread -o tamesi29a7_main.exe\n```\n\n\u3088\u3057\u3001tamesi29a7_main.exe \u3068\u3044\u3046\u30d5\u30a1\u30a4\u30eb\u304c\u3067\u3051\u305f\u3002\n\n```\n# ./tamesi29a7_main.exe\ndeclared queue amq.gen-R8_7pGx8GdY5EmtcMddvzQ\n```\n\n\u306a\u3093\u306e\u3053\u3063\u3061\u3083\u3002\n\n\u591a\u5206\u3001\u30ad\u30e5\u30fc\u306e\u540d\u524d\u3067\u3082\u53d6\u5f97\u3057\u305f\u3093\u3060\u308d\u3046\u304b\uff1f\n\n```\n# rabbitmqctl list_queues\nListing queues ...\n1111    0\n```\n\n\u3046\u30fc\u3080\u3002\n\n\u300camqpcpp/examples/example_consume.cpp\u300d\uff08akalend/amqpcpp\uff09\nhttps://github.com/akalend/amqpcpp/blob/master/examples/example_consume.cpp\n\n\u3053\u308c\u3092\u8a66\u3057\u3066\u307f\u3088\u3046\u3002\n\ntamesi29a8_example_consume.cpp\n\n```\n#include \"AMQPcpp.h\"\n\nusing namespace std;\n\nint i=0;\n\nint onCancel(AMQPMessage * message ) {\n\tcout << \"cancel tag=\"<< message->getDeliveryTag() << endl;\n\treturn 0;\n}\n\nint  onMessage( AMQPMessage * message  ) {\n\tuint32_t j = 0;\n\tchar * data = message->getMessage(&j);\n\tif (data)\n\t\t  cout << data << endl;\n\n\ti++;\n\n\tcout << \"#\" << i << \" tag=\"<< message->getDeliveryTag() << \" content-type:\"<< message->getHeader(\"Content-type\") ;\n\tcout << \" encoding:\"<< message->getHeader(\"Content-encoding\")<< \" mode=\"<<message->getHeader(\"Delivery-mode\")<<endl;\n\n\tif (i > 10) {\n\t\tAMQPQueue * q = message->getQueue();\n\t\tq->Cancel( message->getConsumerTag() );\n\t}\n\treturn 0;\n};\n\n\nint main () {\n\n\n\ttry {\n//\t\tAMQP amqp(\"123123:akalend@localhost/private\");\n\n\t\tAMQP amqp(\"123123:akalend@localhost:5673/private\");\n\n\t\tAMQPQueue * qu2 = amqp.createQueue(\"q2\");\n\n\t\tqu2->Declare();\n\t\tqu2->Bind( \"e\", \"\");\n\n\t\tqu2->setConsumerTag(\"tag_123\");\n\t\tqu2->addEvent(AMQP_MESSAGE, onMessage );\n\t\tqu2->addEvent(AMQP_CANCEL, onCancel );\n\n\t\tqu2->Consume(AMQP_NOACK);//\n\n\n\t} catch (AMQPException e) {\n\t\tstd::cout << e.getMessage() << std::endl;\n\t}\n\n\treturn 0;\n\n}\n```\n\n```\n# g++ -std=c++11 tamesi29a8_example_consume.cpp -lev -lamqpcpp -pthread -o tamesi29a8_example_consume.exe\ntamesi29a8_example_consume.cpp:1:21: fatal error: AMQPcpp.h: No such file or directory\ncompilation terminated.\n```\n\n\u306a\u3093\u306e\u53c2\u8003\u306b\u3082\u306a\u3089\u306a\u3044\u30bd\u30fc\u30b9\u3060\u3063\u305f\u304b\u3002\n\n```\n# ./tamesi29a7_main.exe\ndeclared queue amq.gen-0n2SmfNgiVabWrTBjd5F3w\n# ./tamesi29a7_main.exe\ndeclared queue amq.gen-MRpMMZ2dX3VRK-HVAJV62w\n# ./tamesi29a7_main.exe\ndeclared queue amq.gen-wCRRD2i98lE52gR8nHjaxw\n```\n\n\u3053\u306e name \u306f\u4f55\u306a\u3093\u3060\u308d\u306a\u3002\n\n\u300cFLAGS AND TABLES\u300d\uff08CopernicaMarketingSoftware/AMQP-CPP\uff09\nhttps://github.com/CopernicaMarketingSoftware/AMQP-CPP\n\n\u8aac\u660e\u3092\u8aad\u3093\u3067\u6539\u9020\u3057\u3066\u307f\u308b\u3002\n\ntamesi29a7_main.cpp\n\n```\n#include <ev.h>\n#include <amqpcpp.h>\n#include <amqpcpp/libev.h>\n\nint main()\n{\n    // access to the event loop\n    auto *loop = EV_DEFAULT;\n\n    // handler for libev (so we don't have to implement AMQP::TcpHandler!)\n    AMQP::LibEvHandler handler(loop);\n\n    // make a connection\n    AMQP::TcpConnection connection(&handler, AMQP::Address(\"amqp://localhost/\"));\n\n    // we need a channel too\n    AMQP::TcpChannel channel(&connection);\n\n//    // create a temporary queue\n//    channel.declareQueue(AMQP::exclusive).onSuccess([&connection](const std::string &name, uint32_t messagecount, uint32_t consumercount) {\n//\n//        // report the name of the temporary queue\n//        std::cout << \"declared queue \" << name << std::endl;\n//\n//        // now we can close the connection\n//        connection.close();\n//    });\n    // create a custom callback\n    auto callback = [](const std::string &name, int msgcount, int consumercount) {\n\n        // @todo add your own implementation\n\n        // report the name of the temporary queue\n        std::cout << \"declared queue \" << name << std::endl;\n\n        // now we can close the connection\n        connection.close();\n    }\n\n    // declare the queue, and install the callback that is called on success\n    channel.declareQueue(\"1111\").onSuccess(callback);\n\n    // run the loop\n    ev_run(loop, 0);\n\n    // done\n    return 0;\n}\n```\n\n```\n# nano tamesi29a9_main.cpp\n# g++ -std=c++11 tamesi29a9_main.cpp -lev -lamqpcpp -pthread -o tamesi29a9_main.exe\n```\n\n```\ntamesi29a9_main.cpp: In lambda function:\ntamesi29a9_main.cpp:37:9: error: \u2018connection\u2019 is not captured\n         connection.close();\n         ^\ntamesi29a9_main.cpp:29:22: note: the lambda has no capture-default\n     auto callback = [](const std::string &name, int msgcount, int consumercount) {\n                      ^\ntamesi29a9_main.cpp:14:25: note: \u2018AMQP::TcpConnection connection\u2019 declared here\n     AMQP::TcpConnection connection(&handler, AMQP::Address(\"amqp://localhost/\"));\n                         ^\ntamesi29a9_main.cpp: In function \u2018int main()\u2019:\ntamesi29a9_main.cpp:41:5: error: expected \u2018,\u2019 or \u2018;\u2019 before \u2018channel\u2019\n     channel.declareQueue(\"1111\").onSuccess(callback);\n     ^\n```\n\n\u3058\u3083\u3042\u3001\u3053\u3046\u3002\n\n```\n        // connection.close();\n```\n\n```\n# g++ -std=c++11 tamesi29a9_main.cpp -lev -lamqpcpp -pthread -o tamesi29a9_main.exe\ntamesi29a9_main.cpp: In function \u2018int main()\u2019:\ntamesi29a9_main.cpp:41:5: error: expected \u2018,\u2019 or \u2018;\u2019 before \u2018channel\u2019\n     channel.declareQueue(\"1111\").onSuccess(callback);\n     ^\n```\n\n\u30bb\u30df\u30b3\u30ed\u30f3\u8db3\u308a\u306a\u3044\u306e\u304b\u3001\u30b5\u30f3\u30d7\u30eb\u304b\u3089\u30b3\u30d4\u30fc\u3057\u305f\u306e\u306b\u3002\u3058\u3083\u3042\u8db3\u3059\u3002\n\n```\n    };\n```\n\n```\n# g++ -std=c++11 tamesi29a9_main.cpp -lev -lamqpcpp -pthread -o tamesi29a9_main.exe\n```\n\n\u30b3\u30f3\u30d1\u30a4\u30eb\u306f\u901a\u3063\u305f\u3002\u30bd\u30fc\u30b9\u306f\u3053\u3093\u306a\u611f\u3058\u3002\n\ntamesi29a9_main.cpp\n\n```\n#include <ev.h>\n#include <amqpcpp.h>\n#include <amqpcpp/libev.h>\n\nint main()\n{\n    // access to the event loop\n    auto *loop = EV_DEFAULT;\n\n    // handler for libev (so we don't have to implement AMQP::TcpHandler!)\n    AMQP::LibEvHandler handler(loop);\n\n    // make a connection\n    AMQP::TcpConnection connection(&handler, AMQP::Address(\"amqp://localhost/\"));\n\n    // we need a channel too\n    AMQP::TcpChannel channel(&connection);\n\n//    // create a temporary queue\n//    channel.declareQueue(AMQP::exclusive).onSuccess([&connection](const std::string &name, uint32_t messagecount, uint32_t consumercount) {\n//\n//        // report the name of the temporary queue\n//        std::cout << \"declared queue \" << name << std::endl;\n//\n//        // now we can close the connection\n//        connection.close();\n//    });\n    // create a custom callback\n    auto callback = [](const std::string &name, int msgcount, int consumercount) {\n\n        // @todo add your own implementation\n\n        // report the name of the temporary queue\n        std::cout << \"declared queue \" << name << std::endl;\n\n        // now we can close the connection\n        // connection.close();\n    };\n\n    // declare the queue, and install the callback that is called on success\n    channel.declareQueue(\"1111\").onSuccess(callback);\n\n    // run the loop\n    ev_run(loop, 0);\n\n    // done\n    return 0;\n}\n```\n\n```\n# ./tamesi29a9_main.exe\ndeclared queue 1111\n```\n\n\u306a\u3093\u304b\u5f85\u6a5f\u3057\u3066\u3044\u308b\u3002 **\u305f\u3081\u3057\u3055\u3093\u30b7\u30ea\u30fc\u30ba** \u3092\u4f7f\u3046\u304b\u3002\n\nhttp://\u2605.\u2605.\u2605.\u2605/tamesi5.php\n\nRabbitMQ \u3067\u3000\u30a8\u30f3\u30ad\u30e5\u30fc\u3059\u308b\u3000\u305f\u3081\u3057\u3055\u3093\u3000\u3060\u3002\n\n```\n[x] Sent 'Flying Dragon!'\n```\n\n\u3068\u304f\u306b\u5909\u5316\u306f\u306a\u3044\u3002\n\n```\n^Z\n[1]+  Stopped                 ./tamesi29a9_main.exe\n# bg 1\n[1]+ ./tamesi29a9_main.exe &\n```\n\n\u3046\u30fc\u3080\u3002\n\n```\n# jobs\n[1]+  Running                 ./tamesi29a9_main.exe &\n```\n\n\u3046\u30fc\u3080\u3002\u30d5\u30a1\u30df\u30b3\u30f3\u306e\u3000\u3055\u3093\u307e\u306e\u540d\u63a2\u5075\u3000\u3092\u904a\u3093\u3067\u3044\u305f\u3068\u304d\u306e\u6c17\u5206\u306b\u4f3c\u3066\u3044\u308b\u3002\n\n```\nls\ntamesi28.d  tamesi29a7_main.cpp  tamesi29a7_main.exe  tamesi29a8_example_consume.cpp  tamesi29a9_main.cpp  tamesi29a9_main.exe\n```\n\n\u4f55\u304b\u304c\u51fa\u529b\u3055\u308c\u3066\u3044\u308b\u69d8\u5b50\u3082\u306a\u3044\u3002\n\n```\n# rabbitmqctl list_queues\nListing queues ...\n1111    0\n```\n\n\u305d\u3082\u305d\u3082\u3000\u30ad\u30e5\u30fc\u3000\u304c\u7a7a\u3067\u306f\u3002\n\n```\n# rabbitmqctl list_consumers\nListing consumers ...\n1111    <rabbit@\u2605> amq.ctag-ztANwsUVbqTvGhE7rnXh6w false   0       []\n1111    <rabbit@\u2605> amq.ctag-w-yJ9Fb8Ksb5HY0QX3iRAg false   0       []\n1111    <rabbit@\u2605> amq.ctag-xb6boiuc_Ee1girva-GdkQ false   0       []\n1111    <rabbit@\u2605> amq.ctag-jV7AUun3pc-FyFcK9M_Owg false   0       []\n1111    <rabbit@\u2605>  amq.ctag-Jdt5oPqW4mtCerlx8dUIOw false   0       []\n1111    <rabbit@\u2605> amq.ctag-55NHUikpOIFTxgxOEcipsg false   0       []\n```\n\n\u30b3\u30f3\u30b7\u30e5\u30fc\u30de\u30fc\u306f\u3000\u3044\u3063\u3071\u3044\u3044\u308b\u306e\u306b\u306a\u3002\u3058\u3083\u3042\u3001\u3053\u3044\u3064\u3089\u304c\u53d6\u308a\u5408\u3063\u3066\u308b\u306a\u3093\u3066\u3053\u3068\u304c\u3042\u308b\u306e\u3060\u308d\u3046\u304b\uff1f\n\n```\n# ps aux | grep rabbit\nroot     12122  0.0  0.0   4500     0 ?        S    Mar07   0:00 /bin/sh /usr/sbin/rabbitmq-server\nroot     12129  0.0  0.0  55128     0 ?        S    Mar07   0:00 su rabbitmq -s /bin/sh -c /usr/lib/rabbitmq/bin/rabbitmq-server\nrabbitmq 12130  0.0  0.0   4500     8 ?        Ss   Mar07   0:00 sh -c /usr/lib/rabbitmq/bin/rabbitmq-server\nrabbitmq 12131  0.0  0.0   4500     0 ?        S    Mar07   0:00 /bin/sh -e /usr/lib/rabbitmq/bin/rabbitmq-server\nrabbitmq 12237  0.6  2.6 2712560 27192 ?       Sl   Mar07  27:01 /usr/lib/erlang/erts-8.1/bin/beam.smp -W w -A 64 -P 1048576 -t 5000000 -stbt db -zdbbl 32000 -K true -B i -- -root /usr/lib/erlang -progname erl -- -home /var/lib/rabbitmq -- -pa /usr/lib/rabbitmq/lib/rabbitmq_server-3.6.6/ebin -noshell -noinput -s rabbit boot -sname rabbit@\u2605 -boot start_sasl -kernel inet_default_connect_options [{nodelay,true}] -sasl errlog_type error -sasl sasl_error_logger false -rabbit error_logger {file,\"/var/log/rabbitmq/rabbit@\u2605.log\"} -rabbit sasl_error_logger {file,\"/var/log/rabbitmq/rabbit@\u2605-sasl.log\"} -rabbit enabled_plugins_file \"/etc/rabbitmq/enabled_plugins\" -rabbit plugins_dir \"/usr/lib/rabbitmq/lib/rabbitmq_server-3.6.6/plugins\" -rabbit plugins_expand_dir \"/var/lib/rabbitmq/mnesia/rabbit@\u2605-plugins-expand\" -os_mon start_cpu_sup false -os_mon start_disksup false -os_mon start_memsup false -mnesia dir \"/var/lib/rabbitmq/mnesia/rabbit@\u2605\" -kernel inet_dist_listen_min 25672 -kernel inet_dist_listen_max 25672\nrabbitmq 12333  0.0  0.0   4356    72 ?        Ss   Mar07   0:18 erl_child_setup 1024\nrabbitmq 12343  0.0  0.0  13676    36 ?        Ss   Mar07   0:00 inet_gethost 4\nrabbitmq 12344  0.0  0.0  15796   228 ?        S    Mar07   0:01 inet_gethost 4\nroot     27067  0.0  0.0  12936   988 pts/4    S+   08:07   0:00 grep --color=auto rabbit\nrabbitmq 27670  0.0  0.0  13848   252 ?        S    Mar06   0:11 /usr/lib/erlang/erts-8.1/bin/epmd -daemon\n```\n\n\u3046\u30fc\u3080\u3002\n\n\u3082\u3057\u304b\u3057\u3066\u3002\n\n```\n/home/\u2605user/shogi/php_log# ls -an\ntotal 8\ndrwxr-xr-x  2 0 0 4096 Mar  8 09:50 .\ndrwxr-xrwx 20 0 0 4096 Mar 10 06:04 ..\n-rw-r--r--  1 0 0    0 Mar 10 08:05 dequeueBroker.err.log\n-rw-r--r--  1 0 0    0 Mar 10 08:05 dequeueBroker.out.log\n```\n\n\u66f4\u65b0\u6642\u523b\u304c\u66f4\u65b0\u3055\u308c\u3066\u3044\u308b\u3002\n\u3060\u304c\u4e2d\u8eab\u306f\u7a7a\u3063\u307d\u3060\u3063\u305f\u3002\n\n```\n# ps aux | grep dequeueBroker.php\nroot     20224  0.0  1.3 232308 14060 ?        S    04:05   0:01 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot     21242  0.0  1.3 232308 14060 ?        S    05:05   0:00 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot     22336  0.0  1.3 232308 14056 ?        S    06:05   0:00 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot     25095  0.0  1.3 232308 14044 ?        S    07:05   0:00 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot     26770  0.0  1.3 232308 14040 ?        S    08:05   0:00 /usr/bin/php /home/\u2605user/shogi/php_service/dequeueBroker.php\nroot     27318  0.0  0.0  13068   988 pts/4    S+   08:19   0:00 grep --color=auto dequeueBroker.php\n```\n\n\u306a\u3093\u304b 5\u5206 \u306b dequeueBroker.php \u304c\u5897\u3048\u3066\u306a\u3044\u304b\u3002\n\n\u3053\u3093\u306a\u3053\u3068\u304c\u3067\u304d\u308b\u306e\u306f Cron \u3060\u308d\u3046\u3002\n\n```\n# sudo crontab -e\n```\n\n```\n# Edit this file to introduce tasks to be run by cron.\n#\n# Each task to run has to be defined through a single line\n# indicating with different fields when the task will be run\n# and what command to run for the task\n#\n# To define the time you can provide concrete values for\n# minute (m), hour (h), day of month (dom), month (mon),\n# and day of week (dow) or use '*' in these fields (for 'any').#\n# Notice that tasks will be started based on the cron's system\n# daemon's notion of time and timezones.\n#\n# Output of the crontab jobs (including errors) is sent through\n# email to the user the crontab file belongs to (unless redirected).\n#\n# For example, you can run a backup of all your user accounts\n# at 5 a.m every week with:\n# 0 5 * * 1 tar -zcf /var/backups/home.tgz /home/\n#\n# For more information see the manual pages of crontab(5) and cron(8)\n#\n# m h  dom mon dow   command\n#0-59/30 * * * * /bin/bash /home/\u2605user/shogi/bash_service/tamesi12.sh\n5 * * * * /bin/bash /home/\u2605user/shogi/bash_service/kicker_dequeueBroker.sh\n```\n\n\u307b\u3089\u3001\u3044\u305f\u3002**\u30b3\u30e1\u30f3\u30c8\u30a2\u30a6\u30c8\u3057\u3068\u3053\u3002**\n\u30d7\u30ed\u30bb\u30b9\u3082\u843d\u3068\u3057\u3068\u3053\u3002\n\n```\nkill `ps aux | grep dequeueBroker.php | sed 's/[\\t ]\\+/\\t/g' | cut -f 2`\n# ps aux | grep dequeueBroker.php\nroot     27385  0.0  0.0  12936   988 pts/4    S+   08:23   0:00 grep --color=auto dequeueBroker.php\n```\n\n\u3082\u3046\uff11\u56de\u3002\u4eca\u5ea6\u306f\u3000\u305f\u3081\u3057\u3055\u3093\uff11\uff14\u3067\u30a8\u30f3\u30ad\u30e5\u30fc\u3002\n\nhttp://\u2605.\u2605.\u2605.\u2605/tamesi14.php\n\n\u3042\u3063\u3001\u305f\u3081\u3057\u3055\u3093\uff11\uff14\u306b\u30d0\u30b0\u304c\u3042\u308b\u3002\u76f4\u305d\u3046\u3002\n\u3068\u601d\u3063\u305f\u3089\u3000\u30d0\u30b0\u306f\u7121\u304b\u3063\u305f\u306e\u3067\u3000\u76f4\u3055\u306a\u304b\u3063\u305f\u3002\n\n```\n# rabbitmqctl list_queues\nListing queues ...\n1111    0\n```\n\n\u30a8\u30f3\u30ad\u30e5\u30fc\u3055\u308c\u3066\u306a\u3044\u3002\n\n```\nchmod 666 dequeueBroker.err.log\nchmod 666 dequeueBroker.out.log\n```\n\n# RabbitMQ\u518d\u8d77\u52d5\n\u4ee3\u308f\u308a\u7121\u3057\u3002\u3058\u3083\u3042 RabbitMQ \u3092\u518d\u8d77\u52d5\u3057\u3066\u307f\u308b\u3002\n\n```\n# rabbitmqctl stop\nStopping and halting node 'rabbit@\u2605' ...\n[1]+  Done                    ./tamesi29a9_main.exe  (wd: /home/\u2605user/shogi/cpp_service)\n(wd now: /var/www/html)\n# rabbitmq-server\n\n              RabbitMQ 3.6.6. Copyright (C) 2007-2016 Pivotal Software, Inc.\n  ##  ##      Licensed under the MPL.  See http://www.rabbitmq.com/\n  ##  ##\n  ##########  Logs: /var/log/rabbitmq/rabbit@tk2-217-18401.log\n  ######  ##        /var/log/rabbitmq/rabbit@tk2-217-18401-sasl.log\n  ##########\n              Starting broker...\n completed with 0 plugins.\n\n```\n\n[Ctrl]+[Z]\n\n```\n# bg 1\n```\n\n\u30ed\u30b0\u3092\u898b\u3066\u307f\u308b\u304b\u3002\n\n```\ncd /var/log/rabbitmq\n```\n\n\u3046\u30fc\u3093\u3002\n\n\u524d\u306f PHP\u306e\u30a8\u30f3\u30ad\u30e5\u30fc\u306f\u3000\u52d5\u3044\u3066\u3044\u305f\u3093\u3060\u304c\u3001\u4eca\u65e5\u306f\u52d5\u304b\u306a\u3044\u3088\u3046\u3060\u3002\n\n\u4e00\u5fdc\u3001\u305f\u3081\u3057\u3055\u3093\uff12\u3001\uff13\u3001\uff15\u3000\u3092\u53e9\u3044\u3066\u307f\u308b\u3002\n\n```\n# rabbitmqctl list_queues\nListing queues ...\n1111    1\n```\n\n**\u3046\u30fc\u3093\uff1f\uff1f**\n\n\u3058\u3083\u3042\u3001\u305f\u3081\u3057\u3055\u3093\uff12\u3000\u3092\u53e9\u3044\u3066\u307f\u308b\u3002\n\n\u5909\u308f\u3089\u306a\u3044\u3002\n\n\u3058\u3083\u3042\u3001\u305f\u3081\u3057\u3055\u3093\uff13\u3000\u3092\u53e9\u3044\u3066\u307f\u308b\u3002\n\n\u5909\u308f\u3089\u306a\u3044\u3002\n\n\u3058\u3083\u3042\u3001\u305f\u3081\u3057\u3055\u3093\uff15\u3000\u3092\u53e9\u3044\u3066\u307f\u308b\u3002\n\n```\n# rabbitmqctl list_queues\nListing queues ...\n1111    2\n```\n\n\u3058\u3083\u3042\u3001\u305f\u3081\u3057\u3055\u3093\uff11\uff14\u3000\u3092\u53e9\u3044\u3066\u307f\u308b\u3002\n\n```\n# rabbitmqctl list_queues\nListing queues ...\n1111    3\n```\n\n\u3068\u3044\u3046\u3053\u3068\u306f\u3001RabbitMQ \u306f\u52d5\u3044\u3066\u306a\u304b\u3063\u305f\u306e\u304b\u3002\u4eca\u306f\u30d0\u30c3\u30af\u30b0\u30e9\u30a6\u30f3\u30c9\u3067\u52d5\u3044\u3066\u3044\u308b\u304c\u3001\u3058\u3083\u3042\u3001**\u30ed\u30b0\u30a2\u30a6\u30c8\u3057\u3066\u307f\u308b\u3002**\n\n```\n# logout\n$ logout\n```\n\n\u518d\u5ea6\u30ed\u30b0\u30a4\u30f3\u3002\n\n```\n# sudo su -\n\u203b\u30d1\u30b9\u30ef\u30fc\u30c9\u3092\u5165\u308c\u308b\n# jobs\n```\n\n\u7a7a\u3063\u307d\u3060\u3002\n\n```\n# ps aux | grep rabbit\nrabbitmq 27670  0.0  0.0  13848   252 ?        S    Mar06   0:12 /usr/lib/erlang/erts-8.1/bin/epmd -daemon\nroot     27924  0.0  0.0   4500   660 ?        S    08:33   0:00 /bin/sh /usr/sbin/rabbitmq-server\nroot     27931  0.0  0.1  55128  1820 ?        S    08:33   0:00 su rabbitmq -s /bin/sh -c /usr/lib/rabbitmq/bin/rabbitmq-server\nrabbitmq 27932  0.0  0.0   4500   656 ?        Ss   08:33   0:00 sh -c /usr/lib/rabbitmq/bin/rabbitmq-server\nrabbitmq 27933  0.0  0.0   4500   756 ?        S    08:33   0:00 /bin/sh -e /usr/lib/rabbitmq/bin/rabbitmq-server\nrabbitmq 28038  0.9  5.8 2698680 59836 ?       Sl   08:33   0:09 /usr/lib/erlang/erts-8.1/bin/beam.smp -W w -A 64 -P 1048576 -t 5000000 -stbt db -zdbbl 32000 -K true -B i -- -root /usr/lib/erlang -progname erl -- -home /var/lib/rabbitmq -- -pa /usr/lib/rabbitmq/lib/rabbitmq_server-3.6.6/ebin -noshell -noinput -s rabbit boot -sname rabbit@tk2-217-18401 -boot start_sasl -kernel inet_default_connect_options [{nodelay,true}] -sasl errlog_type error -sasl sasl_error_logger false -rabbit error_logger {file,\"/var/log/rabbitmq/rabbit@tk2-217-18401.log\"} -rabbit sasl_error_logger {file,\"/var/log/rabbitmq/rabbit@tk2-217-18401-sasl.log\"} -rabbit enabled_plugins_file \"/etc/rabbitmq/enabled_plugins\" -rabbit plugins_dir \"/usr/lib/rabbitmq/lib/rabbitmq_server-3.6.6/plugins\" -rabbit plugins_expand_dir \"/var/lib/rabbitmq/mnesia/rabbit@tk2-217-18401-plugins-expand\" -os_mon start_cpu_sup false -os_mon start_disksup false -os_mon start_memsup false -mnesia dir \"/var/lib/rabbitmq/mnesia/rabbit@tk2-217-18401\" -kernel inet_dist_listen_min 25672 -kernel inet_dist_listen_max 25672\nrabbitmq 28135  0.0  0.0   4356   524 ?        Ss   08:33   0:00 erl_child_setup 1024\nrabbitmq 28145  0.0  0.0  13676   468 ?        Ss   08:33   0:00 inet_gethost 4\nrabbitmq 28146  0.0  0.0  15796   608 ?        S    08:33   0:00 inet_gethost 4\nroot     29169  0.0  0.0  12936   988 pts/0    S+   08:49   0:00 grep --color=auto rabbit\n```\n\n\u3046\u30fc\u3080\u3001\u898b\u3066\u3082\u5206\u304b\u3089\u3093\u3002\n\n\u305f\u3081\u3057\u3055\u3093\uff15\u3000\u306b\u30a2\u30af\u30bb\u30b9\u3002\n\n```\n# rabbitmqctl list_queues\nListing queues ...\n1111    5\n```\n\n\u3058\u3083\u3042\u3001\u30b8\u30e7\u30d6\u306f\u898b\u3048\u306a\u3044\u304c\u3001\u52d5\u3044\u3066\u3044\u308b\u306e\u3060\u308d\u3046\u304b\uff1f\n\u3060\u3063\u305f\u3089 .cpp \u306e\u65b9\u306f\u3069\u3046\u304b\uff1f\n\n```\n# cd /home/\u2605user/shogi/cpp_service\n# ./tamesi29a9_main.exe\ndeclared queue 1111\n\n```\n\n\u306a\u30fc\u3093\u306b\u3082\u5909\u308f\u3089\u306a\u3044\u3002\u78ba\u304b\u306b\u30ad\u30e5\u30fc\u306e\u540d\u524d\u306f\u53d6\u3063\u3066\u304d\u3066\u3044\u308b\u306e\u304b\u3082\u3057\u308c\u306a\u3044\u304c\u3001\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u53d6\u3063\u3066\u304f\u308b\u306b\u306f\u3000\u3069\u3046\u3059\u308c\u3070\u3044\u3044\u306e\u304b\uff1f\n\n\u66f8\u3044\u3066\u308b\u306e\u304b\uff1f\n\n\u300cAMQP-CPP\u300d\uff08CopernicaMarketingSoftware/AMQP-CPP\uff09\nhttps://github.com/CopernicaMarketingSoftware/AMQP-CPP\n\n#\u305f\u3081\u3057\u3055\u3093\uff12\uff19\uff41\uff11\uff10\n\ntamesi29a10_main.cpp\n\n```\n#include <ev.h>\n#include <amqpcpp.h>\n#include <amqpcpp/libev.h>\n\nint main()\n{\n    // access to the event loop\n    auto *loop = EV_DEFAULT;\n\n    // handler for libev (so we don't have to implement AMQP::TcpHandler!)\n    AMQP::LibEvHandler handler(loop);\n\n    // make a connection\n    AMQP::TcpConnection connection(&handler, AMQP::Address(\"amqp://localhost/\"));\n\n    // we need a channel too\n    AMQP::TcpChannel channel(&connection);\n\n//    // create a temporary queue\n//    channel.declareQueue(AMQP::exclusive).onSuccess([&connection](const std::string &name, uint32_t messagecount, uint32_t consumercount) {\n//\n//        // report the name of the temporary queue\n//        std::cout << \"declared queue \" << name << std::endl;\n//\n//        // now we can close the connection\n//        connection.close();\n//    });\n    // create a custom callback\n    auto callback = [](const std::string &name, int msgcount, int consumercount) {\n\n        // @todo add your own implementation\n\n        // report the name of the temporary queue\n        std::cout << \"(^q^)declared queue \" << name << std::endl;\n\n        // now we can close the connection\n        // connection.close();\n    };\n    // declare the queue, and install the callback that is called on success\n    channel.declareQueue(\"1111\").onSuccess(callback);\n\n    // callback function that is called when the consume operation starts\n    auto startCb = [](const std::string &consumertag) {\n\n        std::cout << \"(^q^)consume operation started\" << std::endl;\n    };\n\n    // callback function that is called when the consume operation failed\n    auto errorCb = [](const char *message) {\n\n        std::cout << \"(^q^)consume operation failed\" << std::endl;\n    }\n\n    // callback operation when a message was received\n    auto messageCb = [&channel](const AMQP::Message &message, uint64_t deliveryTag, bool redelivered) {\n\n        std::cout << \"(^q^)message received\" << std::endl;\n\n        // acknowledge the message\n        channel.ack(deliveryTag);\n    }\n\n    // start consuming from the queue, and install the callbacks\n    channel.consume(\"1111\")\n        .onReceived(messageCb)\n        .onSuccess(startCb)\n        .onError(errorCb);\n\n    // run the loop\n    ev_run(loop, 0);\n\n    // done\n    return 0;\n}\n```\n\n\u3053\u3093\u306a\u3093\u3067\u3044\u3044\u3093\u3060\u308d\u3046\u304b\uff1f\n\n```\n# g++ -std=c++11 tamesi29a10_main.cpp -lev -lamqpcpp -pthread -o tamesi29a10_main.exe\ntamesi29a10_main.cpp: In function \u2018int main()\u2019:\ntamesi29a10_main.cpp:55:5: error: expected \u2018,\u2019 or \u2018;\u2019 before \u2018auto\u2019\n     auto messageCb = [&channel](const AMQP::Message &message, uint64_t deliveryTag, bool redelivered) {\n     ^\ntamesi29a10_main.cpp:65:21: error: \u2018messageCb\u2019 was not declared in this scope\n         .onReceived(messageCb)\n                     ^\n```\n\n\u306a\u3093\u304b\u3000\u30b5\u30f3\u30d7\u30eb\u30fb\u30d7\u30ed\u30b0\u30e9\u30e0\u306f\u3000\u30bb\u30df\u30b3\u30ed\u30f3\u304c\u629c\u3051\u3066\u308b\u3093\u3058\u3083\u306a\u3044\u304b\u306a\u3002\n\n\u300cSemicolon is missing in sample program.\u300d\uff08CopernicaMarketingSoftware/AMQP-CPP\uff09\nhttps://github.com/CopernicaMarketingSoftware/AMQP-CPP/issues/119\n\n\u9001\u3063\u3068\u3044\u305f\u3002\n\n\u3088\u3057\u3001\u30b3\u30f3\u30d1\u30a4\u30eb\u3082\u901a\u3063\u305f\u3002\n\n```\n# ./tamesi29a10_main.exe\n(^q^)declared queue 1111\n(^q^)consume operation started\n(^q^)message received\n(^q^)message received\n(^q^)message received\n(^q^)message received\n(^q^)message received\n```\n\n[Ctrl]+[C]\u3067\u629c\u3051\u308b\u3002\n\n\u78ba\u304b\u306b **\uff15\u5339\u306e\u3000\u305f\u3081\u3057\u3055\u3093** \u304c\u51fa\u3066\u304d\u305f\u306e\u306f\u6b63\u89e3\u306a\u3093\u3060\u304c\u3001\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u62fe\u3063\u3066\u6b32\u3057\u3044\u3002\n\n```\n# rabbitmqctl list_queues\nListing queues ...\n1111    0\n```\n\n\u3082\u3046\u7a7a\u3063\u307d\u3060\u3002\n\n\u3053\u3046\u6539\u9020\u3057\u3066\u3000\u3069\u3046\u304b\uff1f\n\ntamesi29a10_main.cpp\n\n```\n#include <ev.h>\n#include <amqpcpp.h>\n#include <amqpcpp/libev.h>\n\nint main()\n{\n    // access to the event loop\n    auto *loop = EV_DEFAULT;\n\n    // handler for libev (so we don't have to implement AMQP::TcpHandler!)\n    AMQP::LibEvHandler handler(loop);\n\n    // make a connection\n    AMQP::TcpConnection connection(&handler, AMQP::Address(\"amqp://localhost/\"));\n\n    // we need a channel too\n    AMQP::TcpChannel channel(&connection);\n\n//    // create a temporary queue\n//    channel.declareQueue(AMQP::exclusive).onSuccess([&connection](const std::string &name, uint32_t messagecount, uint32_t consumercount) {\n//\n//        // report the name of the temporary queue\n//        std::cout << \"declared queue \" << name << std::endl;\n//\n//        // now we can close the connection\n//        connection.close();\n//    });\n    // create a custom callback\n    auto callback = [](const std::string &name, int msgcount, int consumercount) {\n\n        // @todo add your own implementation\n\n        // report the name of the temporary queue\n        std::cout << \"(^q^)declared queue \" << name << std::endl;\n\n        // now we can close the connection\n        // connection.close();\n    };\n    // declare the queue, and install the callback that is called on success\n    channel.declareQueue(\"1111\").onSuccess(callback);\n\n    // callback function that is called when the consume operation starts\n    auto startCb = [](const std::string &consumertag) {\n\n        // std::cout << \"(^q^)consume operation started\" << std::endl;\n        std::cout << \"(^q^)consume operation started [\" << consumertag << \"]\" << std::endl;\n    };\n\n    // callback function that is called when the consume operation failed\n    auto errorCb = [](const char *message) {\n\n        // std::cout << \"(^q^)consume operation failed\" << std::endl;\n        std::cout << \"(^q^)consume operation failed [\" << &message << \"]\" << std::endl;\n    };\n\n    // callback operation when a message was received\n    auto messageCb = [&channel](const AMQP::Message &message, uint64_t deliveryTag, bool redelivered) {\n\n        // std::cout << \"(^q^)message received\" << std::endl;\n        std::cout << \"(^q^)message received [\" << &message << \"]\" << std::endl;\n\n        // acknowledge the message\n        channel.ack(deliveryTag);\n    };\n\n    // start consuming from the queue, and install the callbacks\n    channel.consume(\"1111\")\n        .onReceived(messageCb)\n        .onSuccess(startCb)\n        .onError(errorCb);\n\n    // run the loop\n    ev_run(loop, 0);\n\n    // done\n    return 0;\n}\n```\n\n\u305f\u3081\u3057\u3055\u3093\uff11\uff14\u3000\u3092\u4f7f\u3063\u3066\u3001\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u30a8\u30f3\u30ad\u30e5\u30fc\u3057\u3066\u304a\u304f\u3002\n\n```\n# rabbitmqctl list_queues\nListing queues ...\n1111    6\n```\n\n```\n# ./tamesi29a10_main.exe\n(^q^)declared queue 1111\n(^q^)consume operation started [amq.ctag-f9-pEPIwqTgyCHuhYm4wiA]\n(^q^)message received [0xc87ea0]\n(^q^)message received [0xc87ea0]\n(^q^)message received [0xc87ea0]\n(^q^)message received [0xc87ea0]\n(^q^)message received [0xc87ea0]\n(^q^)message received [0xc87ea0]\n```\n\n\u306c\u304e\u304e\uff01\u3000\u30e1\u30c3\u30bb\u30fc\u30b8\u3060\u3051\u3000\u306a\u3093\u3068\u304b\u306a\u308c\u3070\u3044\u3044\u3002\u3057\u304b\u3057\u7570\u306a\u308b\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u9001\u3063\u305f\u306e\u306b\u5168\u90e8\u30000xc87ea0\u3000\u3068\u306f\u3069\u3046\u3044\u3046\u3053\u3068\u3060\u3002\n\u4f55\u304b\u306e\u30e1\u30e2\u30ea\u30fb\u30a2\u30c9\u30ec\u30b9\u304b\uff1f\n\n# AMQP::Message\nAMQP::Message \u306f\u6587\u5b57\u5217\u3058\u3083\u306a\u3044\u3093\u3058\u3083\u306a\u3044\u304b\u3002\n\n## /usr/include/amqpcpp.h\n/usr \u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306e\u4e0b\u3092\u63a2\u3057\u3066\u3044\u308b\u3068\u3001\n/usr/include/amqpcpp.h \u3068\u3044\u3046\u30d5\u30a1\u30a4\u30eb\u304c\u3042\u3063\u305f\u3002\n\n\u3055\u3089\u306b\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306e\u4e0b\u306b\u30d8\u30c3\u30c0\u30d5\u30a1\u30a4\u30eb\u304c\u3042\u308b\u3088\u3046\u3060\u3002\n\n```\n/usr/include/amqpcpp# ls\naddress.h     channel.h            copiedbuffer.h          deferredget.h    exception.h     libevent.h  monitor.h            stringfield.h    watchable.h\narray.h       channelimpl.h        decimalfield.h          deferred.h       exchangetype.h  libev.h     numericfield.h       table.h\nbooleanset.h  classes.h            deferredcancel.h        deferredqueue.h  field.h         libuv.h     outbuffer.h          tcpchannel.h\nbuffer.h      connection.h         deferredconsumerbase.h  endian.h         fieldproxy.h    login.h     protocolexception.h  tcpconnection.h\nbytebuffer.h  connectionhandler.h  deferredconsumer.h      entityimpl.h     flags.h         message.h   receivedframe.h      tcpdefines.h\ncallbacks.h   connectionimpl.h     deferreddelete.h        envelope.h       frame.h         metadata.h  stack_ptr.h          tcphandler.h\n```\n\nmessage.h \u3068\u3044\u3046\u30d5\u30a1\u30a4\u30eb\u304c\u6c17\u306b\u306a\u308b\u3002\n\u8457\u4f5c\u8868\u8a18\u3092\u898b\u308b\u3068\u3001Copernica BV \u3068\u3044\u3046\u3068\u3053\u308d\u304c\u4f5c\u3063\u3066\u3044\u308b\u307f\u305f\u3044\u3060\u3002\n\nconst std::string &exchange() const\n\u3068\u3001\nconst std::string &routingkey() const\n\n\u3050\u3089\u3044\u3057\u304b\u3000\u30a2\u30af\u30bb\u30b9\u3067\u304d\u305d\u3046\u306a\u3082\u306e\u304c\u7121\u3044\u3093\u3060\u304c\u3002\n\n```\n        std::cout << \"(^q^)message received exchange=[\" << &message.exchange() << \"] routingkey=[\" << &message.routingkey() << \"]\" << std::endl;\n```\n\n```\n# ./tamesi29a10_main.exe\n(^q^)declared queue 1111\n(^q^)consume operation started [amq.ctag-baH5AqjR3dg-pmSMobsugg]\n(^q^)message received exchange=[0xcdf0d8] routingkey=[0xcdf0f8]\n(^q^)message received exchange=[0xcdf0d8] routingkey=[0xcdf0f8]\n```\n\n\u9055\u3046\u306e\u304b\u3002\n\nMessage \u30af\u30e9\u30b9\u306f Envelope \u30af\u30e9\u30b9\u3092\u7d99\u627f\u3057\u3066\u3044\u308b\u306e\u3067\u3001Envelope \u3082\u898b\u3066\u307f\u3088\u3046\u3002\n\n```\n    /**\n     *  Access to the full message data\n     *  @return buffer\n     */\n    const char *body() const\n    {\n        return _body;\n    }\n```\n\n\u3053\u3093\u306a\u306e\u304c\u3042\u308b\u3002\n\n```\n        std::cout << \"(^q^)message received body=[\" << message.body() << \"]\" << std::endl;\n```\n\n\u3042\u3068\u3001\u982d\u306e\u30a2\u30f3\u30d1\u30b5\u30f3\u30c9\u306f\u8981\u3089\u3093\u306e\u3067\u306f\uff1f\n\n```\n# ./tamesi29a10_main.exe\n(^q^)declared queue 1111\n(^q^)consume operation started [amq.ctag-FYCpWCbtuoRvXl4XoRReHA]\n(^q^)message received body=[ClickSitanDaze\u2592YCpWCbtuoRvXl4XoRReHA]\n(^q^)message received body=[Dragon\u2592]\n(^q^)message received body=[Tiger\u2592]\n```\n\n\u3088\u3057\u304d\u305f\u9053\u4e2d\u3002\u306a\u3093\u304b\u3000\u8b0e\u306e\u6587\u5b57\u304c\u5f8c\u308d\u306b\u3064\u3044\u3066\u3044\u308b\u304c\u2026\u2026\u3002\n\n```\n    /**\n     *  Size of the body\n     *  @return uint64_t\n     */\n    uint64_t bodySize() const\n    {\n        return _bodySize;\n    }\n```\n\nC\u8a00\u8a9e\u3067\u3044\u3046\u3068\u3053\u308d\u306e\u3001\u6587\u5b57\u5217\u306e\u30b5\u30a4\u30ba\u304b\u3060\u305c\uff1f\n\u3069\u3046\u3084\u3063\u3066\u4f7f\u3046\u306e\u304b\u3002\n\n\u300cconvert a char* to std::string\u300d\uff08stack overflow\uff09\nhttp://stackoverflow.com/questions/1195675/convert-a-char-to-stdstring\n\n```\n        std::string myString(message.body(), message.bodySize());\n        std::cout << \"(^q^)message received myString=[\" << myString << \"]\" << std::endl;\n```\n\n```\n# ./tamesi29a10_main.exe\n(^q^)declared queue 1111\n(^q^)consume operation started [amq.ctag-M2QG32xTPEkdEn-Swcl2Sw]\n(^q^)message received myString=[Tiger]\n```\n\n\u3044\u3051\u305f\u3002\n\n\u3044\u3063\u305f\u3093\u3000\u5225\u8a18\u4e8b\u306b\u307e\u3068\u3081\u3088\u3046\u3002\n", "tags": ["\u3055\u304f\u3089VPS", "\u30b5\u30fc\u30d0\u30fc", "ubuntu16.04", "C++", "AMQP-CPP"]}