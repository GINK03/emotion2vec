{"tags": ["SQLServer"], "context": "\n\nSQLServer\u3067\u9023\u756a\u30c7\u30fc\u30bf\n\n\u300c\u518d\u5e30SQL\u300d\u3092\u4f7f\u3063\u3066\u6307\u5b9a\u3055\u308c\u305f\u5024\u307e\u3067\u306e\u30c7\u30fc\u30bf\u3092\u53d6\u5f97\n\n0\uff5e9\u306e\u9023\u756a.sql\nWITH serial AS ( \n  SELECT 0 AS N -- \u958b\u59cb\u5024\n  UNION ALL \n  SELECT N + 1 FROM serial \n  WHERE serial.N < 9 -- \u6700\u5927\u5024\n) \nSELECT N FROM serial\n\n\n\n\u7d50\u679c\n\n\n\n\nN\n\n\n\n\n0\n\n\n1\n\n\n2\n\n\n3\n\n\n4\n\n\n5\n\n\n6\n\n\n7\n\n\n8\n\n\n9\n\n\n\n\n\u518d\u5e30\u306f\u591a\u3059\u304e\u308b\u3068\u30c0\u30e1\uff08\u898f\u5b9a\u5024\u3067\u306f100\u56de\u307e\u3067\uff1f\uff09\nMAXRECURSION\u3067\u8a2d\u5b9a\u3067\u304d\u308b\u3089\u3057\u3044\n\u6700\u5927\u518d\u5e30\u6570\u300cMAXRECURSION\u300d\n\u8a2d\u5b9a\u3067\u304d\u308b\u5024\u306f\u300c0\u300d\u304b\u3089\u300c32,767\u300d\u307e\u3067\u3067\u3001\u300c0\u300d\u306f\u4e0a\u9650\u306a\u3057\n\u898f\u5b9a\u5024\u306f\u300c100\u300d\n\n0\uff5e1000\u306e\u9023\u756a.sql\nWITH serial AS ( \n  SELECT 0 AS N -- \u958b\u59cb\u5024\n  UNION ALL \n  SELECT N + 1 FROM serial \n  WHERE serial.N < 1000 -- \u6700\u5927\u5024\n) \nSELECT N FROM serial\nOPTION ( MAXRECURSION 1000 )\n\n\n\n\u5927\u91cf\u30c7\u30fc\u30bf\n\u5927\u91cf\u30c7\u30fc\u30bf\u306e\u5834\u5408\u3001\u518d\u5e30\u3067\u306f\u9045\u304f\u306a\u308b\n100\u4ee5\u4e0a\u5fc5\u8981\u306a\u3068\u304d\u306f\u3053\u3093\u306a\u611f\u3058\u306b\u3059\u308b\u3068\u3044\u3044\u304b\u3082\n\u518d\u5e30\u3060\u3051\u3067\u3084\u308b\u3088\u308a\u3001\u3053\u3063\u3061\u306e\u307b\u3046\u304c150\uff5e200\u500d\u65e9\u304b\u3063\u305f\n\n100\u4e07\u4ef6.sql\nWITH serial AS ( \n  SELECT 1 AS N \n  UNION ALL \n  SELECT N + 1 \n  FROM serial \n  WHERE serial.N < 10\n) \n,K AS (\nSELECT 1 AS N \nFROM serial A, serial B, serial C  -- 10\u00d710\u00d710\u30671000\u4ef6\n)\nSELECT ROW_NUMBER() OVER (ORDER BY A.N) AS N \nFROM K K1, K K2  -- 1000\u00d71000\u3067100\u4e07\u4ef6\n\n\n\nPIVOT\u3082\u7d61\u3081\u3066\u5fdc\u7528\n\n\u4e5d\u4e5d\u306e\u8868\u3092\u4f5c\u3063\u3066\u307f\u305f\n\n\u4e5d\u4e5d\u306e\u8868.sql\nWITH serial AS ( \n  SELECT 1 AS N \n  UNION ALL \n  SELECT N + 1 FROM serial \n  WHERE serial.N < 9\n) \n,base AS (\nSELECT x.N AS X , y.N AS Y ,(x.N * y.N) as A\nFROM serial x,serial y\n)\nSELECT\nY AS [X/Y], \n[1], [2], [3], [4], [5], [6], [7], [8], [9]\nFROM base\nPIVOT (SUM([A]) FOR [X] IN ([1], [2], [3], [4], [5], [6], [7], [8], [9])) AS PV\n\n\n\n\n\u518d\u5e30\u3092\u4f7f\u308f\u306a\u3044\u65b9\u6cd5\n\u30b7\u30b9\u30c6\u30e0\u30c6\u30fc\u30d6\u30eb\u3092\u5229\u7528\u3057\u3066\u5185\u5bb9\u3092\u4f7f\u7528\u3057\u306a\u3044\u3067\u3001\nROW_NUMBER()\u3067\u9023\u756a\u3092\u4f5c\u6210\n\u30b7\u30b9\u30c6\u30e0\u30c6\u30fc\u30d6\u30eb\u306e\u884c\u6570\u307e\u3067\u306e\u7bc4\u56f2\u306a\u3089\u3053\u308c\u3067\u3044\u3044\u304b\u3082\n\u5927\u91cf\u30c7\u30fc\u30bf\u306e\u5834\u5408\u306f\u30b7\u30b9\u30c6\u30e0\u30c6\u30fc\u30d6\u30eb\u3092\u8907\u6570\u91cd\u306d\u308b\u3068\u3067\u304d\u308b\u304c\u3001\u5217\u304c\u8907\u6570\u3042\u308b\u5206\u3001\u518d\u5e30\u3092\u4f7f\u3063\u3066\u306e\u307b\u3046\u304c\u901f\u305d\u3046\n\n\u30b7\u30b9\u30c6\u30e0\u30c6\u30fc\u30d6\u30eb\u3092\u5229\u7528.sql\nSELECT TOP 1000\n  ROW_NUMBER() OVER (ORDER BY A.object_id) AS N  --  ORDER BY \u306b\u306f\u30d7\u30e9\u30a4\u30de\u30ea\u30ad\u30fc\u3092\u6307\u5b9a\nFROM\n  sys.all_columns A  -- \u4ef6\u6570\u304c\u591a\u304f\u3066\u901f\u305d\u3046\u306a\u30b7\u30b9\u30c6\u30e0\u30c6\u30fc\u30d6\u30eb\u3042\u308b\u3044\u306f\u30d3\u30e5\u30fc\n\n\n### SQLServer\u3067\u9023\u756a\u30c7\u30fc\u30bf\n\n#####\u300c\u518d\u5e30SQL\u300d\u3092\u4f7f\u3063\u3066\u6307\u5b9a\u3055\u308c\u305f\u5024\u307e\u3067\u306e\u30c7\u30fc\u30bf\u3092\u53d6\u5f97\n\n\n\n\n```sql:0\uff5e9\u306e\u9023\u756a.sql\nWITH serial AS ( \n  SELECT 0 AS N -- \u958b\u59cb\u5024\n  UNION ALL \n  SELECT N + 1 FROM serial \n  WHERE serial.N < 9 -- \u6700\u5927\u5024\n) \nSELECT N FROM serial\n```\n\n- \u7d50\u679c\n\n|  N  |\n| --- |\n|  0  |\n|  1  |\n|  2  |\n|  3  |\n|  4  |\n|  5  |\n|  6  |\n|  7  |\n|  8  |\n|  9  |\n\n##### \u518d\u5e30\u306f\u591a\u3059\u304e\u308b\u3068\u30c0\u30e1\uff08\u898f\u5b9a\u5024\u3067\u306f100\u56de\u307e\u3067\uff1f\uff09\n\nMAXRECURSION\u3067\u8a2d\u5b9a\u3067\u304d\u308b\u3089\u3057\u3044\n\u6700\u5927\u518d\u5e30\u6570\u300cMAXRECURSION\u300d\n\u8a2d\u5b9a\u3067\u304d\u308b\u5024\u306f\u300c0\u300d\u304b\u3089\u300c32,767\u300d\u307e\u3067\u3067\u3001\u300c0\u300d\u306f\u4e0a\u9650\u306a\u3057\n\u898f\u5b9a\u5024\u306f\u300c100\u300d\n\n```sql:0\uff5e1000\u306e\u9023\u756a.sql\nWITH serial AS ( \n  SELECT 0 AS N -- \u958b\u59cb\u5024\n  UNION ALL \n  SELECT N + 1 FROM serial \n  WHERE serial.N < 1000 -- \u6700\u5927\u5024\n) \nSELECT N FROM serial\nOPTION ( MAXRECURSION 1000 )\n```\n\n\n##### \u5927\u91cf\u30c7\u30fc\u30bf\n\n\u5927\u91cf\u30c7\u30fc\u30bf\u306e\u5834\u5408\u3001\u518d\u5e30\u3067\u306f\u9045\u304f\u306a\u308b\n100\u4ee5\u4e0a\u5fc5\u8981\u306a\u3068\u304d\u306f\u3053\u3093\u306a\u611f\u3058\u306b\u3059\u308b\u3068\u3044\u3044\u304b\u3082\n\u518d\u5e30\u3060\u3051\u3067\u3084\u308b\u3088\u308a\u3001\u3053\u3063\u3061\u306e\u307b\u3046\u304c150\uff5e200\u500d\u65e9\u304b\u3063\u305f\n\n```sql:100\u4e07\u4ef6.sql\nWITH serial AS ( \n  SELECT 1 AS N \n  UNION ALL \n  SELECT N + 1 \n  FROM serial \n  WHERE serial.N < 10\n) \n,K AS (\nSELECT 1 AS N \nFROM serial A, serial B, serial C  -- 10\u00d710\u00d710\u30671000\u4ef6\n)\nSELECT ROW_NUMBER() OVER (ORDER BY A.N) AS N \nFROM K K1, K K2  -- 1000\u00d71000\u3067100\u4e07\u4ef6\n```\n\n##### PIVOT\u3082\u7d61\u3081\u3066\u5fdc\u7528\n\n###### \u4e5d\u4e5d\u306e\u8868\u3092\u4f5c\u3063\u3066\u307f\u305f\n\n\n```sql:\u4e5d\u4e5d\u306e\u8868.sql\nWITH serial AS ( \n  SELECT 1 AS N \n  UNION ALL \n  SELECT N + 1 FROM serial \n  WHERE serial.N < 9\n) \n,base AS (\nSELECT x.N AS X , y.N AS Y ,(x.N * y.N) as A\nFROM serial x,serial y\n)\nSELECT\nY AS [X/Y], \n[1], [2], [3], [4], [5], [6], [7], [8], [9]\nFROM base\nPIVOT (SUM([A]) FOR [X] IN ([1], [2], [3], [4], [5], [6], [7], [8], [9])) AS PV\n\n```\n\n##### \u518d\u5e30\u3092\u4f7f\u308f\u306a\u3044\u65b9\u6cd5\n\n\u30b7\u30b9\u30c6\u30e0\u30c6\u30fc\u30d6\u30eb\u3092\u5229\u7528\u3057\u3066\u5185\u5bb9\u3092\u4f7f\u7528\u3057\u306a\u3044\u3067\u3001\nROW_NUMBER()\u3067\u9023\u756a\u3092\u4f5c\u6210\n\n\u30b7\u30b9\u30c6\u30e0\u30c6\u30fc\u30d6\u30eb\u306e\u884c\u6570\u307e\u3067\u306e\u7bc4\u56f2\u306a\u3089\u3053\u308c\u3067\u3044\u3044\u304b\u3082\n\u5927\u91cf\u30c7\u30fc\u30bf\u306e\u5834\u5408\u306f\u30b7\u30b9\u30c6\u30e0\u30c6\u30fc\u30d6\u30eb\u3092\u8907\u6570\u91cd\u306d\u308b\u3068\u3067\u304d\u308b\u304c\u3001\u5217\u304c\u8907\u6570\u3042\u308b\u5206\u3001\u518d\u5e30\u3092\u4f7f\u3063\u3066\u306e\u307b\u3046\u304c\u901f\u305d\u3046\n\n\n```sql:\u30b7\u30b9\u30c6\u30e0\u30c6\u30fc\u30d6\u30eb\u3092\u5229\u7528.sql\nSELECT TOP 1000\n  ROW_NUMBER() OVER (ORDER BY A.object_id) AS N  --  ORDER BY \u306b\u306f\u30d7\u30e9\u30a4\u30de\u30ea\u30ad\u30fc\u3092\u6307\u5b9a\nFROM\n  sys.all_columns A  -- \u4ef6\u6570\u304c\u591a\u304f\u3066\u901f\u305d\u3046\u306a\u30b7\u30b9\u30c6\u30e0\u30c6\u30fc\u30d6\u30eb\u3042\u308b\u3044\u306f\u30d3\u30e5\u30fc\n```\n\n\n"}