{"tags": ["HTTP", "iOS", "NSURLSession"], "context": " More than 1 year has passed since last update.\u3084\u3063\u3066\u307f\u305f\u3002\u82f1\u8a9e\u306f\u6c17\u5408\u3044\u3002\u521d\u5fc3\u8005\u4e0a\u7b49\u3002\n\u9593\u9055\u3063\u3066\u305f\u3089\u3054\u6307\u6458\u304f\u3060\u3055\u3044\u3002\niOS\u30a2\u30d7\u30ea\u3092\u4f5c\u308a\u306f\u3058\u3081\u3066\u81ea\u524d\u306eweb\u30b5\u30fc\u30d0\u3068\u306e\u9023\u643a\u306e\u691c\u8a3c\u306e\u305f\u3081\u3001\n\u3068\u308a\u3042\u3048\u305a\u8a8d\u8a3c\u3092\u305f\u3081\u3057\u3066\u307f\u305f\u304b\u3063\u305f\u3002\n\n\u53c2\u8003\u30ea\u30f3\u30af\nhttp://dev.classmethod.jp/references/ios-nsurlsession-1/\nhttp://blog.techfirm.co.jp/2013/11/25/ios-7-nsurlsession%E3%81%A7%E3%83%90%E3%83%83%E3%82%AF%E3%82%B0%E3%83%A9%E3%82%A6%E3%83%B3%E3%83%89%E9%80%9A%E4%BF%A1%E3%82%92%E3%81%99%E3%82%8B/\n\n\u3081\u3082\nAFNetworking\u3067\u306f\u306a\u304fNSURLSession\u3092\u4f7f\u3063\u3066\u307f\u305f\u3002\n\n // \u30bb\u30c3\u30b7\u30e7\u30f3\u7a2e\u985e\nNSURLSessionConfiguration *defaultConfigObject = [NSURLSessionConfiguration defaultSessionConfiguration];\n\n// \u30bb\u30c3\u30b7\u30e7\u30f3\u4f5c\u6210\nNSURLSession *urlSession = [NSURLSession sessionWithConfiguration:  defaultConfigObject delegate: nil delegateQueue: [NSOperationQueue mainQueue]];\n\n//cookie\u306e\u30d7\u30ed\u30d1\u30c6\u30a3\u8a2d\u5b9a\nNSMutableDictionary *properties = \n    [NSMutableDictionary    dictionaryWithObjectsAndKeys:\n        @\"http://www.hoge.com\", NSHTTPCookieOriginURL,\n        @\"key\", NSHTTPCookieName,\n        @\"value\", NSHTTPCookieValue,\n        nil\n    ];\n\n//cookie\u4f5c\u6210\nNSHTTPCookie *cookie = [NSHTTPCookie cookieWithProperties:properties];\nNSArray *cookies = [NSArray arrayWithObject:cookie];\nNSDictionary * headers = [NSHTTPCookie requestHeaderFieldsWithCookies:cookies];\n\n//\u30ea\u30af\u30a8\u30b9\u30c8\u4f5c\u6210\nNSMutableURLRequest *request = [NSMutableURLRequest requestWithURL:[NSURL URLWithString:@\"http://www.hoge.com/\"]];\n[request setHTTPMethod:@\"GET\"];\n[request setAllHTTPHeaderFields:headers];\n\n// \u30c7\u30fc\u30bf\u30bf\u30b9\u30af\u3092\u5b9f\u884c\u3057\u307e\u3059\n[[urlSession dataTaskWithRequest:(NSURLRequest *) request\n    completionHandler:^(NSData *data, NSURLResponse *response,NSError *error)\n         {\n            NSLog(@\"Got response %@ with error %@.\\n\", response, error);\n            NSLog(@\"DATA:\\n%@\\nEND DATA\\n\",[[NSString alloc] initWithData: data encoding: NSUTF8StringEncoding]);\n        }] resume];\n\n\u306a\u3093\u3069\u3084\u3063\u3066\u3082cookieWithProperties\u304cnil\u306b\u306a\u3063\u3066\u3057\u307e\u3046\u3002\n\u30b0\u30b0\u3063\u305f\u7d50\u679c\u6b21\u306e\u66f8\u304d\u65b9\u3058\u3083\u306a\u3044\u3068\u3044\u3051\u306a\u3044\u4e8b\u304c\u5224\u660e\u3002\n\nNSMutableDictionary *properties =\n    [NSMutableDictionarydictionaryWithObjectsAndKeys:\n    @\"www.hoge.com\",NSHTTPCookieDomain,\n    @\"\\\\\", NSHTTPCookiePath, // IMPORTANT!\n    @\"key\", NSHTTPCookieName,\n    @\"value\", NSHTTPCookieValue,\n    nil\n];\n\n\u3042\u30fc\u306f\u307e\u3063\u305f\u3002\n\u307e\u3041\u516c\u5f0f\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u3092\u3088\u304f\u898b\u308b\u3068Discussion\u306e\u3068\u3053\u308d\u306b\u66f8\u3044\u3066\u3042\u308b\u3093\u3067\u3059\u306d\u3002\n\u8aad\u307f\u98db\u3070\u3057\u3088\u304f\u306a\u304b\u3063\u305f\u3002\u3067\u3082Discussion\u3063\u3066\u306a\u3093\u3060\uff1f\uff1f\nhttps://developer.apple.com/library/mac/documentation/Cocoa/Reference/Foundation/Classes/NSHTTPCookie_Class/Reference/Reference.html#//apple_ref/occ/clm/NSHTTPCookie/cookieWithProperties:\n\n\u3084\u3063\u3066\u307f\u305f\u3002\u82f1\u8a9e\u306f\u6c17\u5408\u3044\u3002\u521d\u5fc3\u8005\u4e0a\u7b49\u3002\n\u9593\u9055\u3063\u3066\u305f\u3089\u3054\u6307\u6458\u304f\u3060\u3055\u3044\u3002\n\niOS\u30a2\u30d7\u30ea\u3092\u4f5c\u308a\u306f\u3058\u3081\u3066\u81ea\u524d\u306eweb\u30b5\u30fc\u30d0\u3068\u306e\u9023\u643a\u306e\u691c\u8a3c\u306e\u305f\u3081\u3001\n\u3068\u308a\u3042\u3048\u305a\u8a8d\u8a3c\u3092\u305f\u3081\u3057\u3066\u307f\u305f\u304b\u3063\u305f\u3002\n\n#### \u53c2\u8003\u30ea\u30f3\u30af\n\nhttp://dev.classmethod.jp/references/ios-nsurlsession-1/\nhttp://blog.techfirm.co.jp/2013/11/25/ios-7-nsurlsession%E3%81%A7%E3%83%90%E3%83%83%E3%82%AF%E3%82%B0%E3%83%A9%E3%82%A6%E3%83%B3%E3%83%89%E9%80%9A%E4%BF%A1%E3%82%92%E3%81%99%E3%82%8B/\n\n\n## \u3081\u3082\n\nAFNetworking\u3067\u306f\u306a\u304fNSURLSession\u3092\u4f7f\u3063\u3066\u307f\u305f\u3002\n\n\n```objc\n\n // \u30bb\u30c3\u30b7\u30e7\u30f3\u7a2e\u985e\nNSURLSessionConfiguration *defaultConfigObject = [NSURLSessionConfiguration defaultSessionConfiguration];\n\n// \u30bb\u30c3\u30b7\u30e7\u30f3\u4f5c\u6210\nNSURLSession *urlSession = [NSURLSession sessionWithConfiguration: \tdefaultConfigObject delegate: nil delegateQueue: [NSOperationQueue mainQueue]];\n\n//cookie\u306e\u30d7\u30ed\u30d1\u30c6\u30a3\u8a2d\u5b9a\nNSMutableDictionary *properties = \n\t[NSMutableDictionary \tdictionaryWithObjectsAndKeys:\n\t\t@\"http://www.hoge.com\", NSHTTPCookieOriginURL,\n\t\t@\"key\", NSHTTPCookieName,\n\t\t@\"value\", NSHTTPCookieValue,\n\t\tnil\n\t];\n\n//cookie\u4f5c\u6210\nNSHTTPCookie *cookie = [NSHTTPCookie cookieWithProperties:properties];\nNSArray *cookies = [NSArray arrayWithObject:cookie];\nNSDictionary * headers = [NSHTTPCookie requestHeaderFieldsWithCookies:cookies];\n\n//\u30ea\u30af\u30a8\u30b9\u30c8\u4f5c\u6210\nNSMutableURLRequest *request = [NSMutableURLRequest requestWithURL:[NSURL URLWithString:@\"http://www.hoge.com/\"]];\n[request setHTTPMethod:@\"GET\"];\n[request setAllHTTPHeaderFields:headers];\n        \n// \u30c7\u30fc\u30bf\u30bf\u30b9\u30af\u3092\u5b9f\u884c\u3057\u307e\u3059\n[[urlSession dataTaskWithRequest:(NSURLRequest *) request\n\tcompletionHandler:^(NSData *data, NSURLResponse *response,NSError *error)\n\t\t {\n\t\t\tNSLog(@\"Got response %@ with error %@.\\n\", response, error);\n\t\t\tNSLog(@\"DATA:\\n%@\\nEND DATA\\n\",[[NSString alloc] initWithData: data encoding: NSUTF8StringEncoding]);\n\t\t}] resume];\n```\n\n\n\u306a\u3093\u3069\u3084\u3063\u3066\u3082cookieWithProperties\u304cnil\u306b\u306a\u3063\u3066\u3057\u307e\u3046\u3002\n\u30b0\u30b0\u3063\u305f\u7d50\u679c\u6b21\u306e\u66f8\u304d\u65b9\u3058\u3083\u306a\u3044\u3068\u3044\u3051\u306a\u3044\u4e8b\u304c\u5224\u660e\u3002\n\n\n```objc\n\nNSMutableDictionary *properties =\n\t[NSMutableDictionarydictionaryWithObjectsAndKeys:\n\t@\"www.hoge.com\",NSHTTPCookieDomain,\n\t@\"\\\\\", NSHTTPCookiePath, // IMPORTANT!\n\t@\"key\", NSHTTPCookieName,\n\t@\"value\", NSHTTPCookieValue,\n\tnil\n];\n```\n\n\u3042\u30fc\u306f\u307e\u3063\u305f\u3002\n\n\u307e\u3041\u516c\u5f0f\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u3092\u3088\u304f\u898b\u308b\u3068Discussion\u306e\u3068\u3053\u308d\u306b\u66f8\u3044\u3066\u3042\u308b\u3093\u3067\u3059\u306d\u3002\n\u8aad\u307f\u98db\u3070\u3057\u3088\u304f\u306a\u304b\u3063\u305f\u3002\u3067\u3082Discussion\u3063\u3066\u306a\u3093\u3060\uff1f\uff1f\n\nhttps://developer.apple.com/library/mac/documentation/Cocoa/Reference/Foundation/Classes/NSHTTPCookie_Class/Reference/Reference.html#//apple_ref/occ/clm/NSHTTPCookie/cookieWithProperties:\n"}