{"tags": ["spreadsheet", "JavaScript", "gas"], "context": " More than 1 year has passed since last update.\n\n\u306f\u3058\u3081\u306b\n\u7c21\u5358\u306a\u30c7\u30fc\u30bf\u7ba1\u7406\u3092\u3001\u30b9\u30d7\u30ec\u30c3\u30c9\u30b7\u30fc\u30c8 + \u30b9\u30af\u30ea\u30d7\u30c8\u3067\u3055\u3055\u3063\u3068\u6e08\u307e\u305b\u305f\u3044\n\u3051\u3069\u516c\u5f0f\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u3092\u8aad\u3080\u306e\u3082\u9762\u5012\n\u305d\u3093\u306a\u3068\u304d\u306e\u305f\u3081\u306b\u3001\u3088\u304f\u4f7f\u3044\u305d\u3046\u306aAPI\u3092\u307e\u3068\u3081\u3066\u304a\u304d\u307e\u3057\u305f\n\u203b\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u306f\u3053\u3061\u3089\nhttps://developers.google.com/apps-script/reference/spreadsheet/spreadsheet-app\n\n\u57fa\u672c\u7684\u306a\u64cd\u4f5c\nCmd + R\u3067\u5b9f\u884c\nCmd + Enter\u3067\u30ed\u30b0\u3092\u78ba\u8a8d\nLogger.log(log)\u3067\u30ed\u30b0\u3092\u683c\u7d0d\n\n\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306e\u4f5c\u6210\n\nsample.js\n// \u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306e\u4f5c\u6210\u3068\u30a2\u30af\u30bb\u30b9\nvar spreadSheet  = SpreadsheetApp.create(\"Finances\");\nvar spreadSheet2 = spreadSheet.copy(\"Copy of \" + spreadSheet.getName());\n// 2\u3064\u3081\u306b\u5dee\u3057\u8fbc\u307f\nvar sheet        = spreadSheet.insertSheet('piyo', 1)\n// \u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u304b\u3089\u4f5c\u6210\nvar templateSheet = ss.getSheetByName('hoge');\nvar sheet        = spreadSheet.insertSheet('hoge2', 1, {template: templateSheet})\n\n\n\n\u5404\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3078\u306e\u30a2\u30af\u30bb\u30b9\n\nsample2.js\nvar spreadSheet  = SpreadsheetApp.openById(spreadSheet.getId('hogehoge'));\nvar sheet        = spreadSheet.getSheets()[0];\nvar sheet        = spreadSheet.getSheetByName(name);\n\nvar cell         = sheet.getRange('A1');\nvar range        = sheet.getRange('A1:A3'); \nvar cell         = sheet.getRange(1,1); // range object\nvar fullRange    = sheet.getDataRange();  //\u30c7\u30fc\u30bf\u304c\u5165\u3063\u3066\u308b\u30ec\u30f3\u30b8\u5168\u90e8\n\n\n\n\u30d7\u30ed\u30d1\u30c6\u30a3\u306e\u53d6\u5f97\n\nsample3.js\nvar numSheets    = spreadSheet.getNumSheets()\nvar sheetName    = sheet.getIndex()\nvar sheetName    = sheet.getName()\nvar sheetParent  = sheet.getParent()\nvar sheetVlalues = sheet.getSheetValues(1,1,3,3) // List[value]\nvar lastColumn   = sheet.getLastColumn()\nvar lastRow      = sheet.getLastRow()\nvar rangeValue   = range.getValues(\"B1:B3\")      // List[value]\nvar rangeFolmula = range.getFormulas(\"A1:B3\")\n\n\n\n\u30c7\u30fc\u30bf\u306e\u5909\u66f4\n\nsample4.js\nsheet.insertColumnBefore(2);\nsheet.insertColumnBefore(2);\nsheet.deleteColumns(2, 2); //Columns & Rows start at \"1\"\nsheet.sort(1);\nsheet.clear();\ncell.setValue(\"=A1\")\nrange.setvalue([[1],[2],[3]])\nrange.setFontColors([[\"red\"], [\"black\"], [\"blue\"]]);\nrange.clear()\n\n\n\n\u30c7\u30fc\u30bf\u30d0\u30ea\u30c7\u30fc\u30b7\u30e7\u30f3\n\nvalidation.js\n//\u3044\u305a\u308c\u304b\u306e\u5024\u3092\u3068\u308b\nvar cell = sheet.getRange('A1:A3');\nvar rule = SpreadsheetApp.newDataValidation()\n                         .requireValueInList(['Yes', 'No'])\n                         .build();\ncell.setDataValidation(rule);\n//\u3042\u308b\u6587\u5b57\u3092\u542b\u307e\u306a\u3044\nvar cell = sheet.getRange('A1');\nvar rule = SpreadsheetApp.newDataValidation()\n                         .requireTextDoesNotContain('@')\n                         .build();\ncell.setDataValidation(rule);\n//\u4ed6\u306e\u30bb\u30eb\u306e\u5024\u306e\u3069\u308c\u304b\nvar cell = sheet.getRange('A1');\nvar range = SpreadsheetApp.getActive().getRange('B1:B10');\nvar rule = SpreadsheetApp.newDataValidation().requireValueInRange(range).build();\ncell.setDataValidation(rule);\n\n\n## \u306f\u3058\u3081\u306b\n\u7c21\u5358\u306a\u30c7\u30fc\u30bf\u7ba1\u7406\u3092\u3001\u30b9\u30d7\u30ec\u30c3\u30c9\u30b7\u30fc\u30c8 + \u30b9\u30af\u30ea\u30d7\u30c8\u3067\u3055\u3055\u3063\u3068\u6e08\u307e\u305b\u305f\u3044\n\u3051\u3069\u516c\u5f0f\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u3092\u8aad\u3080\u306e\u3082\u9762\u5012\n\u305d\u3093\u306a\u3068\u304d\u306e\u305f\u3081\u306b\u3001\u3088\u304f\u4f7f\u3044\u305d\u3046\u306aAPI\u3092\u307e\u3068\u3081\u3066\u304a\u304d\u307e\u3057\u305f\n\n\u203b\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u306f\u3053\u3061\u3089\nhttps://developers.google.com/apps-script/reference/spreadsheet/spreadsheet-app\n\n## \u57fa\u672c\u7684\u306a\u64cd\u4f5c\n`Cmd + R`\u3067\u5b9f\u884c\n`Cmd + Enter`\u3067\u30ed\u30b0\u3092\u78ba\u8a8d\n`Logger.log(log)`\u3067\u30ed\u30b0\u3092\u683c\u7d0d\n\n## \u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306e\u4f5c\u6210\n```sample.js\n// \u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306e\u4f5c\u6210\u3068\u30a2\u30af\u30bb\u30b9\nvar spreadSheet  = SpreadsheetApp.create(\"Finances\");\nvar spreadSheet2 = spreadSheet.copy(\"Copy of \" + spreadSheet.getName());\n// 2\u3064\u3081\u306b\u5dee\u3057\u8fbc\u307f\nvar sheet        = spreadSheet.insertSheet('piyo', 1)\n// \u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u304b\u3089\u4f5c\u6210\nvar templateSheet = ss.getSheetByName('hoge');\nvar sheet        = spreadSheet.insertSheet('hoge2', 1, {template: templateSheet})\n```\n## \u5404\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3078\u306e\u30a2\u30af\u30bb\u30b9\n```sample2.js\nvar spreadSheet  = SpreadsheetApp.openById(spreadSheet.getId('hogehoge'));\nvar sheet        = spreadSheet.getSheets()[0];\nvar sheet        = spreadSheet.getSheetByName(name);\n\nvar cell         = sheet.getRange('A1');\nvar range        = sheet.getRange('A1:A3'); \nvar cell         = sheet.getRange(1,1); // range object\nvar fullRange    = sheet.getDataRange();  //\u30c7\u30fc\u30bf\u304c\u5165\u3063\u3066\u308b\u30ec\u30f3\u30b8\u5168\u90e8\n```\n## \u30d7\u30ed\u30d1\u30c6\u30a3\u306e\u53d6\u5f97\n```sample3.js\nvar numSheets    = spreadSheet.getNumSheets()\nvar sheetName    = sheet.getIndex()\nvar sheetName    = sheet.getName()\nvar sheetParent  = sheet.getParent()\nvar sheetVlalues = sheet.getSheetValues(1,1,3,3) // List[value]\nvar lastColumn   = sheet.getLastColumn()\nvar lastRow      = sheet.getLastRow()\nvar rangeValue   = range.getValues(\"B1:B3\")      // List[value]\nvar rangeFolmula = range.getFormulas(\"A1:B3\")\n```\n\n## \u30c7\u30fc\u30bf\u306e\u5909\u66f4\n```sample4.js\nsheet.insertColumnBefore(2);\nsheet.insertColumnBefore(2);\nsheet.deleteColumns(2, 2); //Columns & Rows start at \"1\"\nsheet.sort(1);\nsheet.clear();\ncell.setValue(\"=A1\")\nrange.setvalue([[1],[2],[3]])\nrange.setFontColors([[\"red\"], [\"black\"], [\"blue\"]]);\nrange.clear()\n```\n\n## \u30c7\u30fc\u30bf\u30d0\u30ea\u30c7\u30fc\u30b7\u30e7\u30f3\n```validation.js\n//\u3044\u305a\u308c\u304b\u306e\u5024\u3092\u3068\u308b\nvar cell = sheet.getRange('A1:A3');\nvar rule = SpreadsheetApp.newDataValidation()\n                         .requireValueInList(['Yes', 'No'])\n                         .build();\ncell.setDataValidation(rule);\n//\u3042\u308b\u6587\u5b57\u3092\u542b\u307e\u306a\u3044\nvar cell = sheet.getRange('A1');\nvar rule = SpreadsheetApp.newDataValidation()\n                         .requireTextDoesNotContain('@')\n                         .build();\ncell.setDataValidation(rule);\n//\u4ed6\u306e\u30bb\u30eb\u306e\u5024\u306e\u3069\u308c\u304b\nvar cell = sheet.getRange('A1');\nvar range = SpreadsheetApp.getActive().getRange('B1:B10');\nvar rule = SpreadsheetApp.newDataValidation().requireValueInRange(range).build();\ncell.setDataValidation(rule);\n```\n"}