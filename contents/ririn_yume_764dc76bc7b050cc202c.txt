{"context": " More than 1 year has passed since last update.\u3042\u3061\u3053\u3061\u3044\u304f\u304b\u3089\u30e1\u30e2\u308b(\u00b4\u30fb\u03c9\u30fb`)\n\n\u9078\u629e\u7bc4\u56f2\n\n  dim r as range\n  set r = selection\n\n  ' ActiveWindow.RangeSelection\n\n\n\n\u7bc4\u56f2\u306e\u5024\n\n1,000.0\n\nrange(\"a1\").value  ' 1000\nrange(\"a1\").text   ' 1,000.0\n\n\n\n\u30d6\u30c3\u30af\uff08\u30d5\u30a1\u30a4\u30eb\uff09\u30fb\u30aa\u30fc\u30d7\u30f3\n\n\noption explicit\noption private module\n\npublic function bookopen()\n\n  dim file_name as variant\n\n  file_name = application.getopenfilename(\"text file(*.xls;*.xls), *.xls;*.xlsm\")\n\n  if file_name <> false then\n    workbooks.add file_name\n    bookopen = file_name\n  end If\n\nend function\n\n\n\u3076\u3041\u308a\u3042\u3093\u3068\u8fd4\u3063\u3066\u304f\u308b\u3068\u306f\u601d\u308f\u306a\u304b\u3063\u305f\u3088\u3002\n\n\u30c6\u30fc\u30d6\u30eb\u306e\u7a4d\u307f\u4e0a\u3052\n\ndim target as range '\u30c6\u30fc\u30d6\u30eb\u306e\u7bc4\u56f2  e.g. range(\"a2:e2\")\n\nsub ins()\n\n  target.row.hidden = true\n  target.insert xlshiftdown\n\nend sub\n\nsub del()\n\n  target.delte xlshiftup\n\nend sub\n\n' \u30e6\u30fc\u30c6\u30a3\u30ea\u30c6\u30a3\nfunction empty_record() As boolean\n\n  dim idx As Long\n\n  with target\n    for idx = 1 to .columns.count\n      if .offset(1, 0).cells(1, idx).value <> \"\" then\n        empty_record = false\n        exit function\n      end if\n    next\n  end with\n\n  empty_record = true\n\nend function\n\n\u3053\u3093\u306a\u306e\n\n\u633f\u5165\u5f8c\n\n\u884c\u3092\u6d88\u3059\u306e\u306f\u30ab\u30a6\u30f3\u30bf\u30fc\u3042\u3063\u305f\u307b\u3046\u304c\u3044\u3044\u304b\u306a\u3002\n\n\u30d5\u30a3\u30eb\u30bf\u30fc\n\u30aa\u30fc\u30c8\u30d5\u30a3\u30eb\u30bf\n2015/2/1 \uff5e 2015/2/15 \u306e\u9593\u3092\u62bd\u51fa\n\ndim target as range\n\nsub fil()\n\n  dim hit as long\n\n  target.autofilter 1, \">2015/2/1\", xland, \"<=2015/2/15\", true\n\n  ' range_expr.autofilter(filed, criteria1, operator, criteria2, visibledropdown) : variant\n  '  field     \u62bd\u51fa\u6761\u4ef6\u306e\u30bf\u30fc\u30b2\u30c3\u30c8\n  '  criteria1 \u62bd\u51fa\u6761\u4ef61:variant\n  '  operator  XlAutoFilterOperator\u5217\u6319\n  '  criteria2 \u62bd\u51fa\u6761\u4ef62\uff1avariant\n  '  visibledropdown true|false\n\n  ' \u62bd\u51fa\u3055\u308c\u305f\u6570\n  hit = target.autofileter.filters.count\n\nend sub\n\nsub revert\n\n  if worksheets(index).autofiltermode then\n    worksheets(index).autofiltermode = false\n  end if\n\nend sub\n\n\n\n\n\u30a2\u30c9\u30d0\u30f3\u30b9\u30fb\u30d5\u30a3\u30eb\u30bf\u30fc\n\u5bfe\u8c61\u306e\u30c7\u30fc\u30bf\u3001\u62bd\u51fa\u6761\u4ef6\u3001\u62bd\u51fa\u7d50\u679c\u3092\u5225\u3005\u306e\u30b7\u30fc\u30c8\u3067\u3067\u304d\u308b\uff01\n\ndim target as range\n\nsub adv_fil\n\n  dim src as range\n  dim dst as range\n\n  dim cond as worksheet\n  dim query as range\n\n  set src = worksheets(1).target\n  set dst = worksheets(3).target\n\n  set cond = worksheets(2)\n  set query = cond.range(\"...\")\n\n  src.advancedfiletr xlfiltercopy, query, dst, false\n\nend sub\n\n\n\u62bd\u51fa\u6761\u4ef6\n\n\u3088\u304f\u308f\u304b\u3089\u306a\u3044\u3002\nExcel\u306e\u30e6\u30fc\u30b6\u30fc\u8a2d\u5b9a\u306e\u30d5\u30a3\u30eb\u30bf\u30fc\u306b\u8fd1\u3044\u3082\u306e\u304b\u306a\uff1f\n\n\u3053\u307e\u3093\u3069\u3070\u30fc\n\u3081\u3093\u3069\u304f\u3055\u304f\u306a\u3063\u3066\u304d\u305f('A`)\uff73\uff9e\uff67\uff70\n\u3053\u308c\u306f\u3088\u304f\u308f\u304b\u3089\u306a\u3044\u306a\u3089\u5b9f\u884c\u3057\u306a\u3044\u3067\u306d\u3002\nCommandBars.Add \u30e1\u30bd\u30c3\u30c9 (Office)\nhttps://msdn.microsoft.com/ja-jp/library/office/ff861773.aspx\n[\u6a19\u6e96\u30e2\u30b8\u30e5\u30fc\u30eb]\n\nOption Explicit\n\nPrivate Sub f()\n\n  Dim w\n\n  For Each w In Application.CommandBars\n    Debug.Print w.name\n  Next\n\nEnd Sub\n\nSub show()\n\n   Application.CommandBars(\"hoge\").ShowPopup\n\nEnd Sub\n\n\nSub delete_menu()\n\n  Application.CommandBars(\"hoge\").Delete\n\nEnd Sub\n\nSub create_menu()\n\n   With Application.CommandBars.Add(\"hoge\", msoBarPopup, False, True)\n    With .Controls.Add(Type:=msoControlButton)\n         .Caption = \"aaa\"\n         .OnAction = \"'\" & ThisWorkbook.name & \"'!\" & \"hnd\"\n    End With\n   End With\n\nEnd Sub\n\nSub hnd()\n\n  MsgBox \"\"\n\nEnd Sub\n\n\n\n\u3042\u3061\u3053\u3061\u3044\u304f\u304b\u3089\u30e1\u30e2\u308b(\u00b4\u30fb\u03c9\u30fb`)\n\n###\u9078\u629e\u7bc4\u56f2\n\n```vbnet\n\n  dim r as range\n  set r = selection\n\n  ' ActiveWindow.RangeSelection\n\n```\n\n### \u7bc4\u56f2\u306e\u5024\n\n```vbnet\n\n1,000.0\n\nrange(\"a1\").value  ' 1000\nrange(\"a1\").text   ' 1,000.0\n\n```\n\n###\u30d6\u30c3\u30af\uff08\u30d5\u30a1\u30a4\u30eb\uff09\u30fb\u30aa\u30fc\u30d7\u30f3\n\n```vbnet\n\n\noption explicit\noption private module\n\npublic function bookopen()\n\n  dim file_name as variant\n\n  file_name = application.getopenfilename(\"text file(*.xls;*.xls), *.xls;*.xlsm\")\n  \n  if file_name <> false then\n    workbooks.add file_name\n    bookopen = file_name\n  end If\n  \nend function\n\n```\n\n\u3076\u3041\u308a\u3042\u3093\u3068\u8fd4\u3063\u3066\u304f\u308b\u3068\u306f\u601d\u308f\u306a\u304b\u3063\u305f\u3088\u3002\n\n###\u30c6\u30fc\u30d6\u30eb\u306e\u7a4d\u307f\u4e0a\u3052\n\n```vbnet\n\ndim target as range '\u30c6\u30fc\u30d6\u30eb\u306e\u7bc4\u56f2  e.g. range(\"a2:e2\")\n\nsub ins()\n\n  target.row.hidden = true\n  target.insert xlshiftdown\n\nend sub\n\nsub del()\n   \n  target.delte xlshiftup\n \nend sub\n\n' \u30e6\u30fc\u30c6\u30a3\u30ea\u30c6\u30a3\nfunction empty_record() As boolean\n\n  dim idx As Long\n\n  with target\n    for idx = 1 to .columns.count\n      if .offset(1, 0).cells(1, idx).value <> \"\" then\n        empty_record = false\n        exit function\n      end if\n    next\n  end with\n  \n  empty_record = true\n\nend function\n```\n\n\u3053\u3093\u306a\u306e\n\n![tbl1.PNG](https://qiita-image-store.s3.amazonaws.com/0/36817/c9e7a362-7b5e-993d-8a54-a34ad3aa1c3b.png)\n\n\u633f\u5165\u5f8c\n\n![tbl2.PNG](https://qiita-image-store.s3.amazonaws.com/0/36817/f74a1a82-9dd7-8e71-8fda-40c3d089c6ef.png)\n\n\n\u884c\u3092\u6d88\u3059\u306e\u306f\u30ab\u30a6\u30f3\u30bf\u30fc\u3042\u3063\u305f\u307b\u3046\u304c\u3044\u3044\u304b\u306a\u3002\n\n\n### \u30d5\u30a3\u30eb\u30bf\u30fc\n\n\u30aa\u30fc\u30c8\u30d5\u30a3\u30eb\u30bf\n2015/2/1 \uff5e 2015/2/15 \u306e\u9593\u3092\u62bd\u51fa\n\n```vbnet\n\ndim target as range\n\nsub fil()\n \n  dim hit as long\n\n  target.autofilter 1, \">2015/2/1\", xland, \"<=2015/2/15\", true\n  \n  ' range_expr.autofilter(filed, criteria1, operator, criteria2, visibledropdown) : variant\n  '  field     \u62bd\u51fa\u6761\u4ef6\u306e\u30bf\u30fc\u30b2\u30c3\u30c8\n  '  criteria1 \u62bd\u51fa\u6761\u4ef61:variant\n  '  operator  XlAutoFilterOperator\u5217\u6319\n  '  criteria2 \u62bd\u51fa\u6761\u4ef62\uff1avariant\n  '  visibledropdown true|false\n  \n  ' \u62bd\u51fa\u3055\u308c\u305f\u6570\n  hit = target.autofileter.filters.count\n  \nend sub\n\nsub revert\n\n  if worksheets(index).autofiltermode then\n    worksheets(index).autofiltermode = false\n  end if\n  \nend sub\n\n```\n\n![fil.PNG](https://qiita-image-store.s3.amazonaws.com/0/36817/6357326a-6e9a-87b1-8486-5614172546d8.png)\n\n\n### \u30a2\u30c9\u30d0\u30f3\u30b9\u30fb\u30d5\u30a3\u30eb\u30bf\u30fc\n\n\u5bfe\u8c61\u306e\u30c7\u30fc\u30bf\u3001\u62bd\u51fa\u6761\u4ef6\u3001\u62bd\u51fa\u7d50\u679c\u3092\u5225\u3005\u306e\u30b7\u30fc\u30c8\u3067\u3067\u304d\u308b\uff01\n\n```vbnet\n\ndim target as range\n\nsub adv_fil\n\n  dim src as range\n  dim dst as range\n  \n  dim cond as worksheet\n  dim query as range\n  \n  set src = worksheets(1).target\n  set dst = worksheets(3).target\n  \n  set cond = worksheets(2)\n  set query = cond.range(\"...\")\n  \n  src.advancedfiletr xlfiltercopy, query, dst, false\n  \nend sub\n\n```\n\n\u62bd\u51fa\u6761\u4ef6\n\n![cond.PNG](https://qiita-image-store.s3.amazonaws.com/0/36817/b9b4c2eb-8298-6cb9-46e1-38bac96b5f24.png)\n\n\u3088\u304f\u308f\u304b\u3089\u306a\u3044\u3002\nExcel\u306e\u30e6\u30fc\u30b6\u30fc\u8a2d\u5b9a\u306e\u30d5\u30a3\u30eb\u30bf\u30fc\u306b\u8fd1\u3044\u3082\u306e\u304b\u306a\uff1f\n\n\n### \u3053\u307e\u3093\u3069\u3070\u30fc\n\n\u3081\u3093\u3069\u304f\u3055\u304f\u306a\u3063\u3066\u304d\u305f('A`)\uff73\uff9e\uff67\uff70\n\u3053\u308c\u306f\u3088\u304f\u308f\u304b\u3089\u306a\u3044\u306a\u3089\u5b9f\u884c\u3057\u306a\u3044\u3067\u306d\u3002\n\nCommandBars.Add \u30e1\u30bd\u30c3\u30c9 (Office)\nhttps://msdn.microsoft.com/ja-jp/library/office/ff861773.aspx\n\n[\u6a19\u6e96\u30e2\u30b8\u30e5\u30fc\u30eb]\n\n```vbnet\n\nOption Explicit\n\nPrivate Sub f()\n\n  Dim w\n  \n  For Each w In Application.CommandBars\n    Debug.Print w.name\n  Next\n\nEnd Sub\n\nSub show()\n  \n   Application.CommandBars(\"hoge\").ShowPopup\n\nEnd Sub\n\n\nSub delete_menu()\n\n  Application.CommandBars(\"hoge\").Delete\n\nEnd Sub\n\nSub create_menu()\n\n   With Application.CommandBars.Add(\"hoge\", msoBarPopup, False, True)\n    With .Controls.Add(Type:=msoControlButton)\n         .Caption = \"aaa\"\n         .OnAction = \"'\" & ThisWorkbook.name & \"'!\" & \"hnd\"\n    End With\n   End With\n\nEnd Sub\n\nSub hnd()\n\n  MsgBox \"\"\n\nEnd Sub\n\n```\n", "tags": ["VBA"]}