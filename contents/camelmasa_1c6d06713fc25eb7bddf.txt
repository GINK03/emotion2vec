{"context": " More than 1 year has passed since last update.Ruby on Rails Advent Calendar 2\u65e5\u76ee\u9045\u308c\u307e\u3057\u305f(^o^)\n--\n\u30bf\u30a4\u30c8\u30eb\u306e\u901a\u308a\u3067\u3059\u304c\u3001\u4ee5\u524d\u30d6\u30ed\u30b0\u306b\u66f8\u3044\u305f\u4e8b\u304c\u3042\u308b\u81ea\u793e\u30b5\u30fc\u30d3\u30b9\u306e\u6a5f\u80fd\u3092\u7c21\u5358\u306bAPI\u3067\u63d0\u4f9b\u51fa\u6765\u3066\u3057\u307e\u3046\uff01gem doorkeeper\u304c\u51c4\u3044\u3002 \u3068\u3044\u3046\u8a18\u4e8b\u3092\u66f8\u3044\u30661\u5e74\u4ee5\u4e0a\u7d4c\u3061\u307e\u3057\u305f\u3002\ndoorkeeper\u3082\u5927\u5206\u9032\u5316\u3057\u3066\u304a\u308a\u3001Rails4\u5bfe\u5fdc\u3082\u3057\u3066\u3044\u308b\u69d8\u306a\u306e\u3067\u518d\u5ea6\u691c\u8a3c\u3057\u3066\u307f\u308b\u3053\u3068\u306b\u3057\u307e\u3057\u305f\u3002\n\u4e0b\u8a18\u4f5c\u696d\u30ed\u30b0\u306b\u306a\u308a\u307e\u3059\u3002\n\u691c\u8a3c\u74b0\u5883\n\nruby 2.0.0p353\nRails 4.0.1\n\n\nGemfile\u306bdoorkeer\u8ffd\u52a0\nGemfile\u306bdoorkeeper\u3092\u8ffd\u52a0\u3057\u307e\u3059\u3002\ngem 'doorkeeper'\n\n\u305d\u3057\u3066bundle install\n\n\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\nREADME\u306b\u66f8\u3044\u3066\u3042\u308b\u4f5c\u696d\u3092\u884c\u3044\u307e\u3059\u3002\nrails generate doorkeeper:install\n\n\u3053\u306e\u6642routes\u306buse_doorkeeper\u304c\u8ffd\u52a0\u3055\u308c\u308b\nrake routes \u306e\u7d50\u679c\u304c\u4e0b\u8a18\u3002\n                              GET    /oauth/authorize/:code(.:format)             doorkeeper/authorizations#show\n          oauth_authorization GET    /oauth/authorize(.:format)                   doorkeeper/authorizations#new\n                              POST   /oauth/authorize(.:format)                   doorkeeper/authorizations#create\n                              PATCH  /oauth/authorize(.:format)                   doorkeeper/authorizations#update\n                              PUT    /oauth/authorize(.:format)                   doorkeeper/authorizations#update\n                              DELETE /oauth/authorize(.:format)                   doorkeeper/authorizations#destroy\n                  oauth_token POST   /oauth/token(.:format)                       doorkeeper/tokens#create\n           oauth_applications GET    /oauth/applications(.:format)                doorkeeper/applications#index\n                              POST   /oauth/applications(.:format)                doorkeeper/applications#create\n        new_oauth_application GET    /oauth/applications/new(.:format)            doorkeeper/applications#new\n       edit_oauth_application GET    /oauth/applications/:id/edit(.:format)       doorkeeper/applications#edit\n            oauth_application GET    /oauth/applications/:id(.:format)            doorkeeper/applications#show\n                              PATCH  /oauth/applications/:id(.:format)            doorkeeper/applications#update\n                              PUT    /oauth/applications/:id(.:format)            doorkeeper/applications#update\n                              DELETE /oauth/applications/:id(.:format)            doorkeeper/applications#destroy\noauth_authorized_applications GET    /oauth/authorized_applications(.:format)     doorkeeper/authorized_applications#index\n oauth_authorized_application DELETE /oauth/authorized_applications/:id(.:format) doorkeeper/authorized_applications#destroy\n             oauth_token_info GET    /oauth/token/info(.:format)                  doorkeeper/token_info#show\n\nconfig/initializers/doorkeeper.rb \u304c\u8ffd\u52a0\u3055\u308c\u3066\u3044\u308b\u306e\u3067\u3001resource_owner_authenticator \u30d6\u30ed\u30c3\u30af\u3092\u4e0b\u8a18\u306b\u5909\u66f4\u3002\n  resource_owner_authenticator do\n    User.find_by_id(session[:user_id]) || redirect_to(new_user_session_url)\n  end\n\n\u307e\u305fmigrate\u30d5\u30a1\u30a4\u30eb\u3082\u751f\u6210\u3055\u308c\u3066\u3044\u308b\u306e\u3067\u3001rake db:migrate \u3092\u884c\u3044\u307e\u3059\u3002\nrails g scaffold User name:string\nrails generate doorkeeper:migration\nrake db:migrate\n\n\u3053\u308c\u3067\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\u5b8c\u4e86\u3002\n\n\u30d6\u30e9\u30a6\u30b6\u304b\u3089\u30a2\u30af\u30bb\u30b9\u3057\u3066\u307f\u308b\nhttp://localhost:3000/oauth/applications \u306b\u30a2\u30af\u30bb\u30b9\u3002\n\n\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u4e00\u89a7\u304c\u8868\u793a\u3055\u308c\u308b\n\n\n\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u4f5c\u6210\u3057\u3066\u307f\u308b\n\n\n\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u8a8d\u8a3c\n\ncode\u306e\u53d6\u5f97\u3082\u666e\u901a\u306b\u51fa\u6765\u307e\u3057\u305f\uff01\n\n\u611f\u60f3\n\u76f8\u5909\u308f\u3089\u305aprovider\u5074\u306e\u5b9f\u88c5\u306f\u7c21\u5358\u306b\u51fa\u6765\u305d\u3046\u3067\u3059\u304c\u3001API\u306e\u5b9f\u88c5\u3068client\u5074\u306e\u30b5\u30f3\u30d7\u30eb\u306b\u3064\u3044\u3066\u306e\u60c5\u5831\u306f\u307e\u3060\u307e\u3060\u591a\u304f\u306a\u3044\u306a\u3041\u3068\u601d\u3044\u307e\u3057\u305f\u3002\n\n\u53c2\u8003\ngem doorkeeper\u3092\u7528\u3044\u305fAPI\u5074\u306e\u5b9f\u88c5\u3059\u308b\u60c5\u5831\u304c\u8f09\u3063\u3066\u3044\u3066\u4fbf\u5229\u3002\nhttp://blog.n-z.jp/blog/2013-10-08-doorkeeper-api-client.html\nRuby on Rails Advent Calendar 2\u65e5\u76ee\u9045\u308c\u307e\u3057\u305f(^o^)\n\n--\n\n\u30bf\u30a4\u30c8\u30eb\u306e\u901a\u308a\u3067\u3059\u304c\u3001\u4ee5\u524d\u30d6\u30ed\u30b0\u306b\u66f8\u3044\u305f\u4e8b\u304c\u3042\u308b[\u81ea\u793e\u30b5\u30fc\u30d3\u30b9\u306e\u6a5f\u80fd\u3092\u7c21\u5358\u306bAPI\u3067\u63d0\u4f9b\u51fa\u6765\u3066\u3057\u307e\u3046\uff01gem doorkeeper\u304c\u51c4\u3044\u3002](http://d.hatena.ne.jp/camelmasa/20121005/1349459738) \u3068\u3044\u3046\u8a18\u4e8b\u3092\u66f8\u3044\u30661\u5e74\u4ee5\u4e0a\u7d4c\u3061\u307e\u3057\u305f\u3002\n\ndoorkeeper\u3082\u5927\u5206\u9032\u5316\u3057\u3066\u304a\u308a\u3001Rails4\u5bfe\u5fdc\u3082\u3057\u3066\u3044\u308b\u69d8\u306a\u306e\u3067\u518d\u5ea6\u691c\u8a3c\u3057\u3066\u307f\u308b\u3053\u3068\u306b\u3057\u307e\u3057\u305f\u3002\n\n\n\u4e0b\u8a18\u4f5c\u696d\u30ed\u30b0\u306b\u306a\u308a\u307e\u3059\u3002\n\n\u691c\u8a3c\u74b0\u5883\n\n- ruby 2.0.0p353\n- Rails 4.0.1\n\n##  Gemfile\u306bdoorkeer\u8ffd\u52a0\n\nGemfile\u306bdoorkeeper\u3092\u8ffd\u52a0\u3057\u307e\u3059\u3002\n\n```\ngem 'doorkeeper'\n```\n\n\u305d\u3057\u3066`bundle install`\n\n## \u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\n\nREADME\u306b\u66f8\u3044\u3066\u3042\u308b\u4f5c\u696d\u3092\u884c\u3044\u307e\u3059\u3002\n\n```\nrails generate doorkeeper:install\n```\n\u3053\u306e\u6642routes\u306b`use_doorkeeper`\u304c\u8ffd\u52a0\u3055\u308c\u308b\n\n`rake routes` \u306e\u7d50\u679c\u304c\u4e0b\u8a18\u3002\n\n```\n                              GET    /oauth/authorize/:code(.:format)             doorkeeper/authorizations#show\n          oauth_authorization GET    /oauth/authorize(.:format)                   doorkeeper/authorizations#new\n                              POST   /oauth/authorize(.:format)                   doorkeeper/authorizations#create\n                              PATCH  /oauth/authorize(.:format)                   doorkeeper/authorizations#update\n                              PUT    /oauth/authorize(.:format)                   doorkeeper/authorizations#update\n                              DELETE /oauth/authorize(.:format)                   doorkeeper/authorizations#destroy\n                  oauth_token POST   /oauth/token(.:format)                       doorkeeper/tokens#create\n           oauth_applications GET    /oauth/applications(.:format)                doorkeeper/applications#index\n                              POST   /oauth/applications(.:format)                doorkeeper/applications#create\n        new_oauth_application GET    /oauth/applications/new(.:format)            doorkeeper/applications#new\n       edit_oauth_application GET    /oauth/applications/:id/edit(.:format)       doorkeeper/applications#edit\n            oauth_application GET    /oauth/applications/:id(.:format)            doorkeeper/applications#show\n                              PATCH  /oauth/applications/:id(.:format)            doorkeeper/applications#update\n                              PUT    /oauth/applications/:id(.:format)            doorkeeper/applications#update\n                              DELETE /oauth/applications/:id(.:format)            doorkeeper/applications#destroy\noauth_authorized_applications GET    /oauth/authorized_applications(.:format)     doorkeeper/authorized_applications#index\n oauth_authorized_application DELETE /oauth/authorized_applications/:id(.:format) doorkeeper/authorized_applications#destroy\n             oauth_token_info GET    /oauth/token/info(.:format)                  doorkeeper/token_info#show\n```\n\n`config/initializers/doorkeeper.rb` \u304c\u8ffd\u52a0\u3055\u308c\u3066\u3044\u308b\u306e\u3067\u3001`resource_owner_authenticator` \u30d6\u30ed\u30c3\u30af\u3092\u4e0b\u8a18\u306b\u5909\u66f4\u3002\n\n```\n  resource_owner_authenticator do\n    User.find_by_id(session[:user_id]) || redirect_to(new_user_session_url)\n  end\n```\n\n\u307e\u305fmigrate\u30d5\u30a1\u30a4\u30eb\u3082\u751f\u6210\u3055\u308c\u3066\u3044\u308b\u306e\u3067\u3001`rake db:migrate` \u3092\u884c\u3044\u307e\u3059\u3002\n\n```\nrails g scaffold User name:string\nrails generate doorkeeper:migration\nrake db:migrate\n```\n\n\u3053\u308c\u3067\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\u5b8c\u4e86\u3002\n\n## \u30d6\u30e9\u30a6\u30b6\u304b\u3089\u30a2\u30af\u30bb\u30b9\u3057\u3066\u307f\u308b\n\nhttp://localhost:3000/oauth/applications \u306b\u30a2\u30af\u30bb\u30b9\u3002\n\n\n### \u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u4e00\u89a7\u304c\u8868\u793a\u3055\u308c\u308b\n![Doorkeeper_2.png](https://qiita-image-store.s3.amazonaws.com/1/996/140f47d6-81d7-dfd8-1600-c1c8e0a41c9b.png \"Doorkeeper_2.png\")\n\n### \u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u4f5c\u6210\u3057\u3066\u307f\u308b\n![Doorkeeper_1.png](https://qiita-image-store.s3.amazonaws.com/1/996/4aad1c7d-6d0b-2277-843e-aa4abe86702a.png \"Doorkeeper_1.png\")\n\n### \u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u8a8d\u8a3c\n![Doorkeeper.png](https://qiita-image-store.s3.amazonaws.com/1/996/16cf8908-dc1e-81f4-0914-844bd06f6a1c.png \"Doorkeeper.png\")\n\n\ncode\u306e\u53d6\u5f97\u3082\u666e\u901a\u306b\u51fa\u6765\u307e\u3057\u305f\uff01\n\n## \u611f\u60f3\n\n\u76f8\u5909\u308f\u3089\u305aprovider\u5074\u306e\u5b9f\u88c5\u306f\u7c21\u5358\u306b\u51fa\u6765\u305d\u3046\u3067\u3059\u304c\u3001API\u306e\u5b9f\u88c5\u3068client\u5074\u306e\u30b5\u30f3\u30d7\u30eb\u306b\u3064\u3044\u3066\u306e\u60c5\u5831\u306f\u307e\u3060\u307e\u3060\u591a\u304f\u306a\u3044\u306a\u3041\u3068\u601d\u3044\u307e\u3057\u305f\u3002\n\n\n\n\u53c2\u8003\n---\n\ngem doorkeeper\u3092\u7528\u3044\u305fAPI\u5074\u306e\u5b9f\u88c5\u3059\u308b\u60c5\u5831\u304c\u8f09\u3063\u3066\u3044\u3066\u4fbf\u5229\u3002\nhttp://blog.n-z.jp/blog/2013-10-08-doorkeeper-api-client.html\n", "tags": ["Rails", "Ruby", "Gem"]}