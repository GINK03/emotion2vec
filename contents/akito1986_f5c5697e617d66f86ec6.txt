{"context": "\n\n\u3084\u3063\u305f\u3053\u3068\nTerrafform\u3092\u5229\u7528\u3057\u3066\u8907\u6570VM\u306e\u4f5c\u6210\u3002\n\n\u80cc\u666f\n\u4ee5\u524d\u306e\u8a18\u4e8b\u306b\u66f8\u304b\u305b\u3066\u3082\u3089\u3063\u3066\u3044\u308b\u304c\u3001\u691c\u8a3c\u7528\u306e\u30a4\u30f3\u30d5\u30e9\u69cb\u7bc9\u306e\u969b\u306b\u30d6\u30e9\u30a6\u30b6\u3084\u3089\u5358\u7d14\u306aClient\u30c4\u30fc\u30eb\u3067\u8a2d\u5b9a\u3059\u308b\u306e\u304c\u9762\u5012\u3002\nTerraform\u306a\u3089\u7c21\u5358\u306b\u69cb\u7bc9\u3067\u304d\u305d\u3046\u306a\u306e\u3067\u4eca\u691c\u8a3c\u4e2d\u3068\u3044\u3046\u611f\u3058\u3002\n\n\u74b0\u5883\n\nOSX: 10.11.1\nGo: 1.7.3\n\n\n\u524d\u63d0\u6761\u4ef6\n\nIDCF\u30af\u30e9\u30a6\u30c9\u306e\u4ee5\u4e0b\u306e\u60c5\u5831\u3092\u53d6\u5f97\u3057\u3066\u3044\u308b\u3053\u3068\n\nAPIKey\nSecretKey\n\n\nGo\u306e\u30d3\u30eb\u30c9\u74b0\u5883\u304c\u3042\u308b\u3053\u3068\n\n\n\u624b\u9806\n\nTerraform\u306e\u30d3\u30eb\u30c9\n\u4ee5\u524d\u306e\u8a18\u4e8b\u306b\u8a18\u8f09\u306e\u65b9\u6cd5\u3067fork\u3057\u305fterraform\u3092\u30d3\u30eb\u30c9\u3059\u308b\u3002\n\nTerraform\u306e\u8a2d\u5b9a\nTerraform\u3067\u306f\u5171\u901a\u5316\u53ef\u80fd\u306a\u8a2d\u5b9a\u3092\u30e2\u30b8\u30e5\u30fc\u30eb\u3068\u3044\u3046\u5358\u4f4d\u3067\u4fdd\u6301\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u308b\u3002\n\u4eca\u56de\u306f\u3001VM\u306e\u8a2d\u5b9a\u3068\u30dd\u30fc\u30c8\u30d5\u30a9\u30ef\u30fc\u30c7\u30a3\u30f3\u30b0\u306e\u8a2d\u5b9a\u3092\u30e2\u30b8\u30e5\u30fc\u30eb\u5316\u3057\u3066\u3001\u901a\u5e38\u306e\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u304b\u3089\u53c2\u7167\u3059\u308b\u3088\u3046\u306b\u3057\u305f\u3002\n\u4ee5\u4e0b\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u304c\u7f6e\u304b\u308c\u3066\u3044\u308b\u30c7\u30a3\u30af\u30ec\u30c8\u30ea\u304b\u3089\u898b\u305f\u3068\u304d\u306e\u30c7\u30a3\u30af\u30ec\u30af\u30c8\u30ea\u69cb\u9020\u3002\n$ tree .\n.\n\u251c\u2500\u2500 cloudstack.tf // \u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\n\u251c\u2500\u2500 terraform.log // log file\n\u251c\u2500\u2500 terraform.tfstatef\n\u251c\u2500\u2500 terraform.tfstate.backup\n\u251c\u2500\u2500 terraform.tfvars\n\u2514\u2500\u2500 vm_instances\n    \u2514\u2500\u2500 terraform_test // \u30e2\u30b8\u30e5\u30fc\u30eb\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\n        \u2514\u2500\u2500 test.tf\n\n2 directories, 6 files\n$\n\n\nModule\u306e\u4f5c\u6210\n\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u901a\u5e38\u306e\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u306e\u5f62\u5f0f\u3067\u8a2d\u5b9a\u3059\u308b\u3002\n\nvm_instances/terraform_test/test.tf\nvariable counter {}\nvariable public_ipaddress_id {}\n\nresource \"cloudstack_instance\" \"vm\" {\n  name = \"${format(\"terraform-test-0%s\", var.counter)}\"\n  service_offering = \"light.S1\"\n  network_id = \"26a035ad-3802-4622-8657-b0df6e33cb0a\"\n  template = \"CentOS 7.2 64-bit\"\n  zone = \"weber\"\n  keypair = \"aueno\"\n  group = \"terraform-test\"\n  expunge = true\n}\n\nresource \"cloudstack_port_forward\" \"pf_ssh\" {\n  ip_address_id = \"${var.public_ipaddress_id}\"\n  forward {\n    protocol = \"tcp\"\n    private_port = 22\n    public_port = \"${10022 + var.counter - 1}\"\n    virtual_machine_id = \"${cloudstack_instance.vm.id}\"\n  }\n}\n\n\n\u5909\u6570\u5b9a\u7fa9\u3055\u308c\u3066\u3044\u308b\u3082\u306e\u306f\u3001\u547c\u3073\u51fa\u3059\u969b\u306b\u6e21\u3055\u308c\u308b\u5909\u6570\u3067\u3042\u308b\u3002\ncounter \u306fVM\u306e\u540d\u524d\u306b\u5229\u7528\u3057\u3066\u304a\u308a\u3001public_ipaddress_id \u306f\u30dd\u30fc\u30c8\u30d5\u30a9\u30ef\u30fc\u30c7\u30a3\u30f3\u30b0\u8a2d\u5b9a\u3059\u308b\u3068\u304d\u306b\u6307\u5b9a\u3059\u308b\u3082\u306e\u3067\u3042\u308b\u3002\n\n\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u306e\u4f5c\u6210\n\u4eca\u56de\u306f3\u53f0\u306e\u30b5\u30fc\u30d0\u30fc\u3092\u69cb\u7bc9\u3057\u3066\u307f\u308b\u3002\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u8a2d\u5b9a\u3068\u306a\u308b\u3002\nModule\u306b\u6e21\u3059\u3079\u304d\u5f15\u6570\u3092\u8a2d\u5b9a\u3057\u3066\u3044\u308b\u3053\u3068\u304c\u308f\u304b\u308b\u3068\u601d\u3046\u3002\n\u307e\u305f\u3053\u3053\u3067\u306f\u5148\u65e5\u30ea\u30ea\u30fc\u30b9\u3057\u305fGPU\u304c\u4f7f\u3048\u308bIDCF\u30af\u30e9\u30a6\u30c9\u6771\u65e5\u672c\u30ea\u30fc\u30b8\u30e7\u30f32\u306b\u5bfe\u3057\u3066\u8a2d\u5b9a\u3092\u884c\u3063\u3066\u3044\u308b\u3002\n\ncloudstack.tf\nvariable api_key {}\nvariable secret_key {}\nvariable zone {}\nvariable network_id {}\nvariable myips {\n  type = \"list\"\n}\n\nprovider \"cloudstack\" {\n  api_url = \"https://compute.jp-east-2.idcfcloud.com/client/api\"\n  api_key = \"${var.api_key}\"\n  secret_key = \"${var.secret_key}\"\n}\n\nmodule \"vm_instance_1\" {\n  source = \"./vm_instances/terraform_test\"\n  counter = 1\n  public_ipaddress_id = \"${cloudstack_ipaddress.public_ipaddress.id}\"\n}\n\nmodule \"vm_instance_2\" {\n  source = \"./vm_instances/terraform_test\"\n  counter = 2\n  public_ipaddress_id = \"${cloudstack_ipaddress.public_ipaddress.id}\"\n}\n\nmodule \"vm_instance_3\" {\n  source = \"./vm_instances/terraform_test\"\n  counter = 3\n  public_ipaddress_id = \"${cloudstack_ipaddress.public_ipaddress.id}\"\n}\n\nresource \"cloudstack_ipaddress\" \"public_ipaddress\" {\n  network_id = \"${var.network_id}\"\n  zone = \"${var.zone}\"\n}\n\n\nresource \"cloudstack_firewall\" \"myips\" {\n  ip_address_id = \"${cloudstack_ipaddress.public_ipaddress.id}\"\n\n  rule {\n    cidr_list = \"${var.myips}\"\n    protocol = \"tcp\"\n    ports = [\"1-65535\"]\n  }\n}\n\noutput \"public_ipaddress\" {\n  value = \"${cloudstack_ipaddress.public_ipaddress.ip_address}\"\n}\n\n\n\n\u5909\u6570\u30d5\u30a1\u30a4\u30eb\u306e\u4f5c\u6210\n\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u306b\u5909\u6570\u306e\u5b9a\u7fa9\u3082\u3059\u308b\u3053\u3068\u306f\u51fa\u6765\u308b\u304c\u3001\u5c11\u3057\u6c5a\u304f\u306a\u308b\u304b\u306a\u3068\u601d\u3044\u4eca\u56de\u306f\u5909\u6570\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u6210\u3057\u305f\u3002\n\u5909\u6570\u30d5\u30a1\u30a4\u30eb\u306e\u5185\u5bb9\u306f\u4ee5\u4e0b\u3067\u3042\u308b\u3002\n\nterraform.tfvars\nnetwork_id = \"26a035ad-3802-4622-8657-b0df6e33cb0a\"\nzone = \"weber\"\nmyips = [\n  \"sss.sss.sss.ss1/32\",\n  \"sss.sss.sss.ss2/32\",\n]\n\n\nmyips\u306b\u63a5\u7d9a\u3092\u8a31\u53ef\u3055\u305b\u305f\u3044cidr\u3092\u6307\u5b9a\u3059\u308b\u3002\n\u5927\u5143\u306e\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u306e\u540c\u4e00\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b terraform.tfvars \u3068\u3044\u3046\u30d5\u30a1\u30a4\u30eb\u3067\u4f5c\u6210\u3059\u308c\u3070\u30aa\u30d7\u30b7\u30e7\u30f3\u6307\u5b9a\u305b\u305a\u306b\u8aad\u307f\u8fbc\u3093\u3067\u304f\u308c\u307e\u3059\u3002\n\nVM\u4f5c\u6210\n\nModule\u306e\u30a4\u30f3\u30dd\u30fc\u30c8\n\u30ed\u30fc\u30ab\u30eb\u74b0\u5883\u306e\u30e2\u30b8\u30e5\u30fc\u30eb\u306e\u5834\u5408\u3082\u3042\u3089\u304b\u3058\u3081\u3001terraform get \u3067\u30e2\u30b8\u30e5\u30fc\u30eb\u3092\u30a4\u30f3\u30dd\u30fc\u30c8\u3059\u308b\u5fc5\u8981\u304c\u3042\u308b\u3002\n$ terraform get\nGet: file:///Users/aueno/workspace/test/vm_instances/terraform_test\nGet: file:///Users/aueno/workspace/test/vm_instances/terraform_test\nGet: file:///Users/aueno/workspace/test/vm_instances/terraform_test\n$ \n\n\n\u4e8b\u524d\u306e\u72b6\u614b\n\nVM\u4e00\u89a7\n\n\nIP\u30a2\u30c9\u30ec\u30b9\n\n\nApply\u5b9f\u884c\n\u3055\u3066\u3053\u3053\u307e\u3067\u3067\u3001CloudStack\u3092\u5f04\u308b\u6e96\u5099\u304c\u3067\u304d\u307e\u3057\u305f\u3002\n\u307e\u305a\u306fplan\u3067\u4f55\u3092\u3059\u308b\u306e\u304b\u78ba\u8a8d\u3057\u3066\u304a\u304d\u307e\u3059\u3002\nAPIKEY, SECRET_KEY\u306f\u3054\u81ea\u8eab\u306eIDCF\u30af\u30e9\u30a6\u30c9\u306eAPIKey, SecretKey\u3092\u6307\u5b9a\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n$ TF_VAR_api_key=$APIKEY TF_VAR_secret_key=$SECRET_KEY terraform plan\nRefreshing Terraform state in-memory prior to plan...\nThe refreshed state will be used to calculate this plan, but\nwill not be persisted to local or remote state storage.\n\n\nThe Terraform execution plan has been generated and is shown below.\nResources are shown in alphabetical order for quick scanning. Green resources\nwill be created (or destroyed and then created if an existing resource\nexists), yellow resources are being changed in-place, and red resources\nwill be destroyed. Cyan entries are data sources to be read.\n\nNote: You didn't specify an \"-out\" parameter to save this plan, so when\n\"apply\" is called, Terraform can't guarantee this is what will execute.\n\n+ cloudstack_firewall.myips\n    ip_address_id:                        \"<computed>\"\n    managed:                              \"false\"\n    parallelism:                          \"2\"\n    rule.#:                               \"1\"\n    rule.2149869111.cidr_list.#:          \"1\"\n    rule.2149869111.cidr_list.1098773020: \"zzz.zzz.zzz.zz/32\"\n    rule.2149869111.icmp_code:            \"<computed>\"\n    rule.2149869111.icmp_type:            \"<computed>\"\n    rule.2149869111.ports.#:              \"1\"\n    rule.2149869111.ports.1101440173:     \"1-65535\"\n    rule.2149869111.protocol:             \"tcp\"\n    rule.2149869111.uuids.%:              \"<computed>\"\n\n+ cloudstack_ipaddress.public_ipaddress\n    ip_address: \"<computed>\"\n    network_id: \"26a035ad-3802-4622-8657-b0df6e33cb0a\"\n    project:    \"<computed>\"\n    zone:       \"weber\"\n\n+ module.vm_instance_1.cloudstack_instance.vm\n    display_name:     \"<computed>\"\n    expunge:          \"true\"\n    group:            \"terraform-test\"\n    ip_address:       \"<computed>\"\n    keypair:          \"aueno\"\n    name:             \"terraform-test-01\"\n    network_id:       \"26a035ad-3802-4622-8657-b0df6e33cb0a\"\n    project:          \"<computed>\"\n    service_offering: \"light.S1\"\n    template:         \"CentOS 7.2 64-bit\"\n    zone:             \"weber\"\n\n+ module.vm_instance_1.cloudstack_port_forward.pf_ssh\n    forward.#:                              \"1\"\n    forward.~3923475130.private_port:       \"22\"\n    forward.~3923475130.protocol:           \"tcp\"\n    forward.~3923475130.public_port:        \"10022\"\n    forward.~3923475130.uuid:               \"<computed>\"\n    forward.~3923475130.virtual_machine_id: \"<computed>\"\n    ip_address_id:                          \"<computed>\"\n    managed:                                \"false\"\n\n+ module.vm_instance_2.cloudstack_instance.vm\n    display_name:     \"<computed>\"\n    expunge:          \"true\"\n    group:            \"terraform-test\"\n    ip_address:       \"<computed>\"\n    keypair:          \"aueno\"\n    name:             \"terraform-test-02\"\n    network_id:       \"26a035ad-3802-4622-8657-b0df6e33cb0a\"\n    project:          \"<computed>\"\n    service_offering: \"light.S1\"\n    template:         \"CentOS 7.2 64-bit\"\n    zone:             \"weber\"\n\n+ module.vm_instance_2.cloudstack_port_forward.pf_ssh\n    forward.#:                              \"1\"\n    forward.~1844077387.private_port:       \"22\"\n    forward.~1844077387.protocol:           \"tcp\"\n    forward.~1844077387.public_port:        \"10023\"\n    forward.~1844077387.uuid:               \"<computed>\"\n    forward.~1844077387.virtual_machine_id: \"<computed>\"\n    ip_address_id:                          \"<computed>\"\n    managed:                                \"false\"\n\n+ module.vm_instance_3.cloudstack_instance.vm\n    display_name:     \"<computed>\"\n    expunge:          \"true\"\n    group:            \"terraform-test\"\n    ip_address:       \"<computed>\"\n    keypair:          \"aueno\"\n    name:             \"terraform-test-03\"\n    network_id:       \"26a035ad-3802-4622-8657-b0df6e33cb0a\"\n    project:          \"<computed>\"\n    service_offering: \"light.S1\"\n    template:         \"CentOS 7.2 64-bit\"\n    zone:             \"weber\"\n\n+ module.vm_instance_3.cloudstack_port_forward.pf_ssh\n    forward.#:                              \"1\"\n    forward.~1201611294.private_port:       \"22\"\n    forward.~1201611294.protocol:           \"tcp\"\n    forward.~1201611294.public_port:        \"10024\"\n    forward.~1201611294.uuid:               \"<computed>\"\n    forward.~1201611294.virtual_machine_id: \"<computed>\"\n    ip_address_id:                          \"<computed>\"\n    managed:                                \"false\"\n\n\nPlan: 8 to add, 0 to change, 0 to destroy.\n\n8\u3064\u306e\u30ea\u30bd\u30fc\u30b9\u304c\u8ffd\u52a0\u3055\u308c\u308b\u3053\u3068\u304c\u308f\u304b\u308b\u3068\u601d\u3044\u307e\u3059\u3002\n\u4ee5\u4e0b\u3067Apply\u5b9f\u884c\u3002\n  $ TF_VAR_api_key=$APIKEY TF_VAR_secret_key=$SECRET_KEY terraform apply\ncloudstack_ipaddress.public_ipaddress: Creating...\n  ip_address: \"\" => \"<computed>\"\n  network_id: \"\" => \"26a035ad-3802-4622-8657-b0df6e33cb0a\"\n  project:    \"\" => \"<computed>\"\n  zone:       \"\" => \"weber\"\nmodule.vm_instance_2.cloudstack_instance.vm: Creating...\n  display_name:     \"\" => \"<computed>\"\n  expunge:          \"\" => \"true\"\n  group:            \"\" => \"terraform-test\"\n  ip_address:       \"\" => \"<computed>\"\n  keypair:          \"\" => \"aueno\"\n  name:             \"\" => \"terraform-test-02\"\n  network_id:       \"\" => \"26a035ad-3802-4622-8657-b0df6e33cb0a\"\n  project:          \"\" => \"<computed>\"\n  service_offering: \"\" => \"light.S1\"\n  template:         \"\" => \"CentOS 7.2 64-bit\"\n  zone:             \"\" => \"weber\"\nmodule.vm_instance_1.cloudstack_instance.vm: Creating...\n  display_name:     \"\" => \"<computed>\"\n  expunge:          \"\" => \"true\"\n  group:            \"\" => \"terraform-test\"\n  ip_address:       \"\" => \"<computed>\"\n  keypair:          \"\" => \"aueno\"\n  name:             \"\" => \"terraform-test-01\"\n  network_id:       \"\" => \"26a035ad-3802-4622-8657-b0df6e33cb0a\"\n  project:          \"\" => \"<computed>\"\n  service_offering: \"\" => \"light.S1\"\n  template:         \"\" => \"CentOS 7.2 64-bit\"\n  zone:             \"\" => \"weber\"\nmodule.vm_instance_3.cloudstack_instance.vm: Creating...\n  display_name:     \"\" => \"<computed>\"\n  expunge:          \"\" => \"true\"\n  group:            \"\" => \"terraform-test\"\n  ip_address:       \"\" => \"<computed>\"\n  keypair:          \"\" => \"aueno\"\n  name:             \"\" => \"terraform-test-03\"\n  network_id:       \"\" => \"26a035ad-3802-4622-8657-b0df6e33cb0a\"\n  project:          \"\" => \"<computed>\"\n  service_offering: \"\" => \"light.S1\"\n  template:         \"\" => \"CentOS 7.2 64-bit\"\n  zone:             \"\" => \"weber\"\ncloudstack_ipaddress.public_ipaddress: Creation complete\ncloudstack_firewall.myips: Creating...\n  ip_address_id:                        \"\" => \"9692c7c9-f3ca-445a-b375-3a1ba488d886\"\n  managed:                              \"\" => \"false\"\n  parallelism:                          \"\" => \"2\"\n  rule.#:                               \"\" => \"1\"\n  rule.2149869111.cidr_list.#:          \"\" => \"1\"\n  rule.2149869111.cidr_list.1098773020: \"\" => \"sss.sss.sss.sss/32\"\n  rule.2149869111.icmp_code:            \"\" => \"<computed>\"\n  rule.2149869111.icmp_type:            \"\" => \"<computed>\"\n  rule.2149869111.ports.#:              \"\" => \"1\"\n  rule.2149869111.ports.1101440173:     \"\" => \"1-65535\"\n  rule.2149869111.protocol:             \"\" => \"tcp\"\n  rule.2149869111.uuids.%:              \"\" => \"<computed>\"\ncloudstack_firewall.myips: Creation complete\nmodule.vm_instance_1.cloudstack_instance.vm: Still creating... (10s elapsed)\nmodule.vm_instance_2.cloudstack_instance.vm: Still creating... (10s elapsed)\nmodule.vm_instance_3.cloudstack_instance.vm: Still creating... (10s elapsed)\nmodule.vm_instance_2.cloudstack_instance.vm: Still creating... (20s elapsed)\nmodule.vm_instance_1.cloudstack_instance.vm: Still creating... (20s elapsed)\nmodule.vm_instance_3.cloudstack_instance.vm: Still creating... (20s elapsed)\nmodule.vm_instance_3.cloudstack_instance.vm: Creation complete\nmodule.vm_instance_3.cloudstack_port_forward.pf_ssh: Creating...\n  forward.#:                             \"\" => \"1\"\n  forward.1057937353.private_port:       \"\" => \"22\"\n  forward.1057937353.protocol:           \"\" => \"tcp\"\n  forward.1057937353.public_port:        \"\" => \"10024\"\n  forward.1057937353.uuid:               \"\" => \"<computed>\"\n  forward.1057937353.virtual_machine_id: \"\" => \"597c88c6-9bcf-44bf-8166-5412af937abb\"\n  ip_address_id:                         \"\" => \"9692c7c9-f3ca-445a-b375-3a1ba488d886\"\n  managed:                               \"\" => \"false\"\nmodule.vm_instance_1.cloudstack_instance.vm: Creation complete\nmodule.vm_instance_1.cloudstack_port_forward.pf_ssh: Creating...\n  forward.#:                             \"\" => \"1\"\n  forward.3480124144.private_port:       \"\" => \"22\"\n  forward.3480124144.protocol:           \"\" => \"tcp\"\n  forward.3480124144.public_port:        \"\" => \"10022\"\n  forward.3480124144.uuid:               \"\" => \"<computed>\"\n  forward.3480124144.virtual_machine_id: \"\" => \"b1e8ad78-9e3c-4798-9b3d-672cf3eb4363\"\n  ip_address_id:                         \"\" => \"9692c7c9-f3ca-445a-b375-3a1ba488d886\"\n  managed:                               \"\" => \"false\"\nmodule.vm_instance_2.cloudstack_instance.vm: Creation complete\nmodule.vm_instance_2.cloudstack_port_forward.pf_ssh: Creating...\n  forward.#:                             \"\" => \"1\"\n  forward.1508310808.private_port:       \"\" => \"22\"\n  forward.1508310808.protocol:           \"\" => \"tcp\"\n  forward.1508310808.public_port:        \"\" => \"10023\"\n  forward.1508310808.uuid:               \"\" => \"<computed>\"\n  forward.1508310808.virtual_machine_id: \"\" => \"5a7858c1-f84a-47b0-837f-4639530f6ef9\"\n  ip_address_id:                         \"\" => \"9692c7c9-f3ca-445a-b375-3a1ba488d886\"\n  managed:                               \"\" => \"false\"\nmodule.vm_instance_2.cloudstack_port_forward.pf_ssh: Creation complete\nmodule.vm_instance_3.cloudstack_port_forward.pf_ssh: Creation complete\nmodule.vm_instance_1.cloudstack_port_forward.pf_ssh: Creation complete\n\nApply complete! Resources: 8 added, 0 changed, 0 destroyed.\n\nThe state of your infrastructure has been saved to the path\nbelow. This state is required to modify and destroy your\ninfrastructure, so keep it safe. To inspect the complete state\nuse the `terraform show` command.\n\nState path: terraform.tfstate\n\nOutputs:\n\npublic_ipaddress = zzz.zzz.zzz.zzz\n$\n\n\u4e26\u5217\u3067VM\u4f5c\u6210\u306a\u3069\u304c\u884c\u306a\u308f\u308c\u3066\u3044\u308b\u3053\u3068\u304c\u308f\u304b\u308b\u3068\u601d\u3044\u307e\u3059\u3002\n\nApply\u5f8c\u306e\u72b6\u614b\n\nVM\u4e00\u89a7\n\u898b\u4e8b\u306bVM\u304c\u4f5c\u6210\u3055\u308c\u3066\u3044\u308b\uff01\n\u753b\u9762\u3067\u898b\u308b\u3068\u3084\u3063\u305f\u611f\u304c\u51fa\u307e\u3059\u3002\n\n\nIP\u30a2\u30c9\u30ec\u30b9\n\u65b0\u3057\u3044PublicIP\u30a2\u30c9\u30ec\u30b9\u304c\u53d6\u5f97\u3055\u308c\u3066\u3001Firewall\u3084\u30dd\u30fc\u30c8\u30d5\u30a9\u30ef\u30fc\u30c7\u30a3\u30f3\u30b0\u304c\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u304c\u308f\u304b\u308a\u307e\u3059\u3002\n\n\n\u304a\u308f\u308a\u306b\nTerraform\u306f\u72b6\u614b\u3092\u7ba1\u7406\u3059\u308b\u3082\u306e\u306a\u306e\u3067\u305d\u3053\u304c\u826f\u3044\u3068\u601d\u3046\u3057\u3001GO\u88fd\u306e\u30c4\u30fc\u30eb\u306a\u306e\u3067\u30bf\u30b9\u30af\u304c\u666e\u901a\u306b\u4e26\u5217\u5316\u3055\u308c\u308b\u3068\u3053\u308d\u304c\u826f\u3044\u3068\u601d\u3046\u3002\n\u305f\u3060IDCF\u30af\u30e9\u30a6\u30c9\u3067\u540d\u524d\u3092\u7ba1\u7406\u3059\u308b\u305f\u3081\u306b\u5229\u7528\u3057\u3066\u3044\u308bTag\u306e\u8a2d\u5b9a\u304c\u3067\u304d\u305f\u3089\u3082\u3063\u3068\u826f\u3044\u304b\u306a\u3068\u601d\u3046\u3068\u3053\u308d\u3002\n\u81ea\u5206\u3067\u5b9f\u88c5\u3057\u308d\u3088\u3001\u3068\u3044\u3046\u8a71\u3060\u3051\u3067\u3082\n\n# \u3084\u3063\u305f\u3053\u3068\nTerrafform\u3092\u5229\u7528\u3057\u3066\u8907\u6570VM\u306e\u4f5c\u6210\u3002\n\n# \u80cc\u666f\n[\u4ee5\u524d\u306e\u8a18\u4e8b](http://qiita.com/akito1986/items/df84e1015d46f4be7b48)\u306b\u66f8\u304b\u305b\u3066\u3082\u3089\u3063\u3066\u3044\u308b\u304c\u3001\u691c\u8a3c\u7528\u306e\u30a4\u30f3\u30d5\u30e9\u69cb\u7bc9\u306e\u969b\u306b\u30d6\u30e9\u30a6\u30b6\u3084\u3089\u5358\u7d14\u306aClient\u30c4\u30fc\u30eb\u3067\u8a2d\u5b9a\u3059\u308b\u306e\u304c\u9762\u5012\u3002\nTerraform\u306a\u3089\u7c21\u5358\u306b\u69cb\u7bc9\u3067\u304d\u305d\u3046\u306a\u306e\u3067\u4eca\u691c\u8a3c\u4e2d\u3068\u3044\u3046\u611f\u3058\u3002\n\n# \u74b0\u5883\n- OSX: 10.11.1\n- Go: 1.7.3\n\n# \u524d\u63d0\u6761\u4ef6\n- IDCF\u30af\u30e9\u30a6\u30c9\u306e\u4ee5\u4e0b\u306e\u60c5\u5831\u3092\u53d6\u5f97\u3057\u3066\u3044\u308b\u3053\u3068  \n  - APIKey\n  - SecretKey\n- Go\u306e\u30d3\u30eb\u30c9\u74b0\u5883\u304c\u3042\u308b\u3053\u3068\n\n# \u624b\u9806\n## Terraform\u306e\u30d3\u30eb\u30c9\n[\u4ee5\u524d\u306e\u8a18\u4e8b](http://qiita.com/akito1986/items/df84e1015d46f4be7b48)\u306b\u8a18\u8f09\u306e\u65b9\u6cd5\u3067fork\u3057\u305fterraform\u3092\u30d3\u30eb\u30c9\u3059\u308b\u3002\n\n## Terraform\u306e\u8a2d\u5b9a\nTerraform\u3067\u306f\u5171\u901a\u5316\u53ef\u80fd\u306a\u8a2d\u5b9a\u3092\u30e2\u30b8\u30e5\u30fc\u30eb\u3068\u3044\u3046\u5358\u4f4d\u3067\u4fdd\u6301\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u308b\u3002\n\u4eca\u56de\u306f\u3001VM\u306e\u8a2d\u5b9a\u3068\u30dd\u30fc\u30c8\u30d5\u30a9\u30ef\u30fc\u30c7\u30a3\u30f3\u30b0\u306e\u8a2d\u5b9a\u3092\u30e2\u30b8\u30e5\u30fc\u30eb\u5316\u3057\u3066\u3001\u901a\u5e38\u306e\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u304b\u3089\u53c2\u7167\u3059\u308b\u3088\u3046\u306b\u3057\u305f\u3002\n\n\u4ee5\u4e0b\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u304c\u7f6e\u304b\u308c\u3066\u3044\u308b\u30c7\u30a3\u30af\u30ec\u30c8\u30ea\u304b\u3089\u898b\u305f\u3068\u304d\u306e\u30c7\u30a3\u30af\u30ec\u30af\u30c8\u30ea\u69cb\u9020\u3002\n\n```\n$ tree .\n.\n\u251c\u2500\u2500 cloudstack.tf // \u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\n\u251c\u2500\u2500 terraform.log // log file\n\u251c\u2500\u2500 terraform.tfstatef\n\u251c\u2500\u2500 terraform.tfstate.backup\n\u251c\u2500\u2500 terraform.tfvars\n\u2514\u2500\u2500 vm_instances\n    \u2514\u2500\u2500 terraform_test // \u30e2\u30b8\u30e5\u30fc\u30eb\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\n        \u2514\u2500\u2500 test.tf\n\n2 directories, 6 files\n$\n```\n\n### Module\u306e\u4f5c\u6210\n\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u901a\u5e38\u306e\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u306e\u5f62\u5f0f\u3067\u8a2d\u5b9a\u3059\u308b\u3002\n\n```vm_instances/terraform_test/test.tf\nvariable counter {}\nvariable public_ipaddress_id {}\n\nresource \"cloudstack_instance\" \"vm\" {\n  name = \"${format(\"terraform-test-0%s\", var.counter)}\"\n  service_offering = \"light.S1\"\n  network_id = \"26a035ad-3802-4622-8657-b0df6e33cb0a\"\n  template = \"CentOS 7.2 64-bit\"\n  zone = \"weber\"\n  keypair = \"aueno\"\n  group = \"terraform-test\"\n  expunge = true\n}\n\nresource \"cloudstack_port_forward\" \"pf_ssh\" {\n  ip_address_id = \"${var.public_ipaddress_id}\"\n  forward {\n    protocol = \"tcp\"\n    private_port = 22\n    public_port = \"${10022 + var.counter - 1}\"\n    virtual_machine_id = \"${cloudstack_instance.vm.id}\"\n  }\n}\n```\n\n\u5909\u6570\u5b9a\u7fa9\u3055\u308c\u3066\u3044\u308b\u3082\u306e\u306f\u3001\u547c\u3073\u51fa\u3059\u969b\u306b\u6e21\u3055\u308c\u308b\u5909\u6570\u3067\u3042\u308b\u3002\n`counter` \u306fVM\u306e\u540d\u524d\u306b\u5229\u7528\u3057\u3066\u304a\u308a\u3001`public_ipaddress_id` \u306f\u30dd\u30fc\u30c8\u30d5\u30a9\u30ef\u30fc\u30c7\u30a3\u30f3\u30b0\u8a2d\u5b9a\u3059\u308b\u3068\u304d\u306b\u6307\u5b9a\u3059\u308b\u3082\u306e\u3067\u3042\u308b\u3002\n\n## \u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u306e\u4f5c\u6210\n\u4eca\u56de\u306f3\u53f0\u306e\u30b5\u30fc\u30d0\u30fc\u3092\u69cb\u7bc9\u3057\u3066\u307f\u308b\u3002\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u8a2d\u5b9a\u3068\u306a\u308b\u3002\nModule\u306b\u6e21\u3059\u3079\u304d\u5f15\u6570\u3092\u8a2d\u5b9a\u3057\u3066\u3044\u308b\u3053\u3068\u304c\u308f\u304b\u308b\u3068\u601d\u3046\u3002\n\u307e\u305f\u3053\u3053\u3067\u306f\u5148\u65e5\u30ea\u30ea\u30fc\u30b9\u3057\u305f[GPU\u304c\u4f7f\u3048\u308bIDCF\u30af\u30e9\u30a6\u30c9\u6771\u65e5\u672c\u30ea\u30fc\u30b8\u30e7\u30f32](https://www.idcf.jp/service/deeplearning/?cl=lbnr_gpu)\u306b\u5bfe\u3057\u3066\u8a2d\u5b9a\u3092\u884c\u3063\u3066\u3044\u308b\u3002\n\n\n```cloudstack.tf\nvariable api_key {}\nvariable secret_key {}\nvariable zone {}\nvariable network_id {}\nvariable myips {\n  type = \"list\"\n}\n\nprovider \"cloudstack\" {\n  api_url = \"https://compute.jp-east-2.idcfcloud.com/client/api\"\n  api_key = \"${var.api_key}\"\n  secret_key = \"${var.secret_key}\"\n}\n\nmodule \"vm_instance_1\" {\n  source = \"./vm_instances/terraform_test\"\n  counter = 1\n  public_ipaddress_id = \"${cloudstack_ipaddress.public_ipaddress.id}\"\n}\n\nmodule \"vm_instance_2\" {\n  source = \"./vm_instances/terraform_test\"\n  counter = 2\n  public_ipaddress_id = \"${cloudstack_ipaddress.public_ipaddress.id}\"\n}\n\nmodule \"vm_instance_3\" {\n  source = \"./vm_instances/terraform_test\"\n  counter = 3\n  public_ipaddress_id = \"${cloudstack_ipaddress.public_ipaddress.id}\"\n}\n\nresource \"cloudstack_ipaddress\" \"public_ipaddress\" {\n  network_id = \"${var.network_id}\"\n  zone = \"${var.zone}\"\n}\n\n\nresource \"cloudstack_firewall\" \"myips\" {\n  ip_address_id = \"${cloudstack_ipaddress.public_ipaddress.id}\"\n\n  rule {\n    cidr_list = \"${var.myips}\"\n    protocol = \"tcp\"\n    ports = [\"1-65535\"]\n  }\n}\n\noutput \"public_ipaddress\" {\n  value = \"${cloudstack_ipaddress.public_ipaddress.ip_address}\"\n}\n```\n\n## \u5909\u6570\u30d5\u30a1\u30a4\u30eb\u306e\u4f5c\u6210\n\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u306b\u5909\u6570\u306e\u5b9a\u7fa9\u3082\u3059\u308b\u3053\u3068\u306f\u51fa\u6765\u308b\u304c\u3001\u5c11\u3057\u6c5a\u304f\u306a\u308b\u304b\u306a\u3068\u601d\u3044\u4eca\u56de\u306f\u5909\u6570\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u6210\u3057\u305f\u3002\n\u5909\u6570\u30d5\u30a1\u30a4\u30eb\u306e\u5185\u5bb9\u306f\u4ee5\u4e0b\u3067\u3042\u308b\u3002\n\n```terraform.tfvars\nnetwork_id = \"26a035ad-3802-4622-8657-b0df6e33cb0a\"\nzone = \"weber\"\nmyips = [\n  \"sss.sss.sss.ss1/32\",\n  \"sss.sss.sss.ss2/32\",\n]\n```\n\nmyips\u306b\u63a5\u7d9a\u3092\u8a31\u53ef\u3055\u305b\u305f\u3044cidr\u3092\u6307\u5b9a\u3059\u308b\u3002\n\n\u5927\u5143\u306e\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u306e\u540c\u4e00\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b `terraform.tfvars` \u3068\u3044\u3046\u30d5\u30a1\u30a4\u30eb\u3067\u4f5c\u6210\u3059\u308c\u3070\u30aa\u30d7\u30b7\u30e7\u30f3\u6307\u5b9a\u305b\u305a\u306b\u8aad\u307f\u8fbc\u3093\u3067\u304f\u308c\u307e\u3059\u3002\n\n## VM\u4f5c\u6210\n### Module\u306e\u30a4\u30f3\u30dd\u30fc\u30c8\n\u30ed\u30fc\u30ab\u30eb\u74b0\u5883\u306e\u30e2\u30b8\u30e5\u30fc\u30eb\u306e\u5834\u5408\u3082\u3042\u3089\u304b\u3058\u3081\u3001`terraform get` \u3067\u30e2\u30b8\u30e5\u30fc\u30eb\u3092\u30a4\u30f3\u30dd\u30fc\u30c8\u3059\u308b\u5fc5\u8981\u304c\u3042\u308b\u3002\n\n```\n$ terraform get\nGet: file:///Users/aueno/workspace/test/vm_instances/terraform_test\nGet: file:///Users/aueno/workspace/test/vm_instances/terraform_test\nGet: file:///Users/aueno/workspace/test/vm_instances/terraform_test\n$ \n```\n\n### \u4e8b\u524d\u306e\u72b6\u614b\n#### VM\u4e00\u89a7\n![before_vm.png](https://qiita-image-store.s3.amazonaws.com/0/46472/2a0c56d8-cba8-7039-aa7a-a885a1433102.png \"before_vm.png\")\n\n\n### IP\u30a2\u30c9\u30ec\u30b9\n![before_ipaddress.png](https://qiita-image-store.s3.amazonaws.com/0/46472/8ec83fc2-cb89-c81b-7dfa-3974d35b11dc.png \"before_ipaddress.png\")\n\n\n### Apply\u5b9f\u884c\n\u3055\u3066\u3053\u3053\u307e\u3067\u3067\u3001CloudStack\u3092\u5f04\u308b\u6e96\u5099\u304c\u3067\u304d\u307e\u3057\u305f\u3002\n\u307e\u305a\u306f`plan`\u3067\u4f55\u3092\u3059\u308b\u306e\u304b\u78ba\u8a8d\u3057\u3066\u304a\u304d\u307e\u3059\u3002\nAPIKEY, SECRET_KEY\u306f\u3054\u81ea\u8eab\u306eIDCF\u30af\u30e9\u30a6\u30c9\u306eAPIKey, SecretKey\u3092\u6307\u5b9a\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n```\n$ TF_VAR_api_key=$APIKEY TF_VAR_secret_key=$SECRET_KEY terraform plan\nRefreshing Terraform state in-memory prior to plan...\nThe refreshed state will be used to calculate this plan, but\nwill not be persisted to local or remote state storage.\n\n\nThe Terraform execution plan has been generated and is shown below.\nResources are shown in alphabetical order for quick scanning. Green resources\nwill be created (or destroyed and then created if an existing resource\nexists), yellow resources are being changed in-place, and red resources\nwill be destroyed. Cyan entries are data sources to be read.\n\nNote: You didn't specify an \"-out\" parameter to save this plan, so when\n\"apply\" is called, Terraform can't guarantee this is what will execute.\n\n+ cloudstack_firewall.myips\n    ip_address_id:                        \"<computed>\"\n    managed:                              \"false\"\n    parallelism:                          \"2\"\n    rule.#:                               \"1\"\n    rule.2149869111.cidr_list.#:          \"1\"\n    rule.2149869111.cidr_list.1098773020: \"zzz.zzz.zzz.zz/32\"\n    rule.2149869111.icmp_code:            \"<computed>\"\n    rule.2149869111.icmp_type:            \"<computed>\"\n    rule.2149869111.ports.#:              \"1\"\n    rule.2149869111.ports.1101440173:     \"1-65535\"\n    rule.2149869111.protocol:             \"tcp\"\n    rule.2149869111.uuids.%:              \"<computed>\"\n\n+ cloudstack_ipaddress.public_ipaddress\n    ip_address: \"<computed>\"\n    network_id: \"26a035ad-3802-4622-8657-b0df6e33cb0a\"\n    project:    \"<computed>\"\n    zone:       \"weber\"\n\n+ module.vm_instance_1.cloudstack_instance.vm\n    display_name:     \"<computed>\"\n    expunge:          \"true\"\n    group:            \"terraform-test\"\n    ip_address:       \"<computed>\"\n    keypair:          \"aueno\"\n    name:             \"terraform-test-01\"\n    network_id:       \"26a035ad-3802-4622-8657-b0df6e33cb0a\"\n    project:          \"<computed>\"\n    service_offering: \"light.S1\"\n    template:         \"CentOS 7.2 64-bit\"\n    zone:             \"weber\"\n\n+ module.vm_instance_1.cloudstack_port_forward.pf_ssh\n    forward.#:                              \"1\"\n    forward.~3923475130.private_port:       \"22\"\n    forward.~3923475130.protocol:           \"tcp\"\n    forward.~3923475130.public_port:        \"10022\"\n    forward.~3923475130.uuid:               \"<computed>\"\n    forward.~3923475130.virtual_machine_id: \"<computed>\"\n    ip_address_id:                          \"<computed>\"\n    managed:                                \"false\"\n\n+ module.vm_instance_2.cloudstack_instance.vm\n    display_name:     \"<computed>\"\n    expunge:          \"true\"\n    group:            \"terraform-test\"\n    ip_address:       \"<computed>\"\n    keypair:          \"aueno\"\n    name:             \"terraform-test-02\"\n    network_id:       \"26a035ad-3802-4622-8657-b0df6e33cb0a\"\n    project:          \"<computed>\"\n    service_offering: \"light.S1\"\n    template:         \"CentOS 7.2 64-bit\"\n    zone:             \"weber\"\n\n+ module.vm_instance_2.cloudstack_port_forward.pf_ssh\n    forward.#:                              \"1\"\n    forward.~1844077387.private_port:       \"22\"\n    forward.~1844077387.protocol:           \"tcp\"\n    forward.~1844077387.public_port:        \"10023\"\n    forward.~1844077387.uuid:               \"<computed>\"\n    forward.~1844077387.virtual_machine_id: \"<computed>\"\n    ip_address_id:                          \"<computed>\"\n    managed:                                \"false\"\n\n+ module.vm_instance_3.cloudstack_instance.vm\n    display_name:     \"<computed>\"\n    expunge:          \"true\"\n    group:            \"terraform-test\"\n    ip_address:       \"<computed>\"\n    keypair:          \"aueno\"\n    name:             \"terraform-test-03\"\n    network_id:       \"26a035ad-3802-4622-8657-b0df6e33cb0a\"\n    project:          \"<computed>\"\n    service_offering: \"light.S1\"\n    template:         \"CentOS 7.2 64-bit\"\n    zone:             \"weber\"\n\n+ module.vm_instance_3.cloudstack_port_forward.pf_ssh\n    forward.#:                              \"1\"\n    forward.~1201611294.private_port:       \"22\"\n    forward.~1201611294.protocol:           \"tcp\"\n    forward.~1201611294.public_port:        \"10024\"\n    forward.~1201611294.uuid:               \"<computed>\"\n    forward.~1201611294.virtual_machine_id: \"<computed>\"\n    ip_address_id:                          \"<computed>\"\n    managed:                                \"false\"\n\n\nPlan: 8 to add, 0 to change, 0 to destroy.\n```\n\n8\u3064\u306e\u30ea\u30bd\u30fc\u30b9\u304c\u8ffd\u52a0\u3055\u308c\u308b\u3053\u3068\u304c\u308f\u304b\u308b\u3068\u601d\u3044\u307e\u3059\u3002\n\u4ee5\u4e0b\u3067Apply\u5b9f\u884c\u3002\n\n ```\n  $ TF_VAR_api_key=$APIKEY TF_VAR_secret_key=$SECRET_KEY terraform apply\ncloudstack_ipaddress.public_ipaddress: Creating...\n  ip_address: \"\" => \"<computed>\"\n  network_id: \"\" => \"26a035ad-3802-4622-8657-b0df6e33cb0a\"\n  project:    \"\" => \"<computed>\"\n  zone:       \"\" => \"weber\"\nmodule.vm_instance_2.cloudstack_instance.vm: Creating...\n  display_name:     \"\" => \"<computed>\"\n  expunge:          \"\" => \"true\"\n  group:            \"\" => \"terraform-test\"\n  ip_address:       \"\" => \"<computed>\"\n  keypair:          \"\" => \"aueno\"\n  name:             \"\" => \"terraform-test-02\"\n  network_id:       \"\" => \"26a035ad-3802-4622-8657-b0df6e33cb0a\"\n  project:          \"\" => \"<computed>\"\n  service_offering: \"\" => \"light.S1\"\n  template:         \"\" => \"CentOS 7.2 64-bit\"\n  zone:             \"\" => \"weber\"\nmodule.vm_instance_1.cloudstack_instance.vm: Creating...\n  display_name:     \"\" => \"<computed>\"\n  expunge:          \"\" => \"true\"\n  group:            \"\" => \"terraform-test\"\n  ip_address:       \"\" => \"<computed>\"\n  keypair:          \"\" => \"aueno\"\n  name:             \"\" => \"terraform-test-01\"\n  network_id:       \"\" => \"26a035ad-3802-4622-8657-b0df6e33cb0a\"\n  project:          \"\" => \"<computed>\"\n  service_offering: \"\" => \"light.S1\"\n  template:         \"\" => \"CentOS 7.2 64-bit\"\n  zone:             \"\" => \"weber\"\nmodule.vm_instance_3.cloudstack_instance.vm: Creating...\n  display_name:     \"\" => \"<computed>\"\n  expunge:          \"\" => \"true\"\n  group:            \"\" => \"terraform-test\"\n  ip_address:       \"\" => \"<computed>\"\n  keypair:          \"\" => \"aueno\"\n  name:             \"\" => \"terraform-test-03\"\n  network_id:       \"\" => \"26a035ad-3802-4622-8657-b0df6e33cb0a\"\n  project:          \"\" => \"<computed>\"\n  service_offering: \"\" => \"light.S1\"\n  template:         \"\" => \"CentOS 7.2 64-bit\"\n  zone:             \"\" => \"weber\"\ncloudstack_ipaddress.public_ipaddress: Creation complete\ncloudstack_firewall.myips: Creating...\n  ip_address_id:                        \"\" => \"9692c7c9-f3ca-445a-b375-3a1ba488d886\"\n  managed:                              \"\" => \"false\"\n  parallelism:                          \"\" => \"2\"\n  rule.#:                               \"\" => \"1\"\n  rule.2149869111.cidr_list.#:          \"\" => \"1\"\n  rule.2149869111.cidr_list.1098773020: \"\" => \"sss.sss.sss.sss/32\"\n  rule.2149869111.icmp_code:            \"\" => \"<computed>\"\n  rule.2149869111.icmp_type:            \"\" => \"<computed>\"\n  rule.2149869111.ports.#:              \"\" => \"1\"\n  rule.2149869111.ports.1101440173:     \"\" => \"1-65535\"\n  rule.2149869111.protocol:             \"\" => \"tcp\"\n  rule.2149869111.uuids.%:              \"\" => \"<computed>\"\ncloudstack_firewall.myips: Creation complete\nmodule.vm_instance_1.cloudstack_instance.vm: Still creating... (10s elapsed)\nmodule.vm_instance_2.cloudstack_instance.vm: Still creating... (10s elapsed)\nmodule.vm_instance_3.cloudstack_instance.vm: Still creating... (10s elapsed)\nmodule.vm_instance_2.cloudstack_instance.vm: Still creating... (20s elapsed)\nmodule.vm_instance_1.cloudstack_instance.vm: Still creating... (20s elapsed)\nmodule.vm_instance_3.cloudstack_instance.vm: Still creating... (20s elapsed)\nmodule.vm_instance_3.cloudstack_instance.vm: Creation complete\nmodule.vm_instance_3.cloudstack_port_forward.pf_ssh: Creating...\n  forward.#:                             \"\" => \"1\"\n  forward.1057937353.private_port:       \"\" => \"22\"\n  forward.1057937353.protocol:           \"\" => \"tcp\"\n  forward.1057937353.public_port:        \"\" => \"10024\"\n  forward.1057937353.uuid:               \"\" => \"<computed>\"\n  forward.1057937353.virtual_machine_id: \"\" => \"597c88c6-9bcf-44bf-8166-5412af937abb\"\n  ip_address_id:                         \"\" => \"9692c7c9-f3ca-445a-b375-3a1ba488d886\"\n  managed:                               \"\" => \"false\"\nmodule.vm_instance_1.cloudstack_instance.vm: Creation complete\nmodule.vm_instance_1.cloudstack_port_forward.pf_ssh: Creating...\n  forward.#:                             \"\" => \"1\"\n  forward.3480124144.private_port:       \"\" => \"22\"\n  forward.3480124144.protocol:           \"\" => \"tcp\"\n  forward.3480124144.public_port:        \"\" => \"10022\"\n  forward.3480124144.uuid:               \"\" => \"<computed>\"\n  forward.3480124144.virtual_machine_id: \"\" => \"b1e8ad78-9e3c-4798-9b3d-672cf3eb4363\"\n  ip_address_id:                         \"\" => \"9692c7c9-f3ca-445a-b375-3a1ba488d886\"\n  managed:                               \"\" => \"false\"\nmodule.vm_instance_2.cloudstack_instance.vm: Creation complete\nmodule.vm_instance_2.cloudstack_port_forward.pf_ssh: Creating...\n  forward.#:                             \"\" => \"1\"\n  forward.1508310808.private_port:       \"\" => \"22\"\n  forward.1508310808.protocol:           \"\" => \"tcp\"\n  forward.1508310808.public_port:        \"\" => \"10023\"\n  forward.1508310808.uuid:               \"\" => \"<computed>\"\n  forward.1508310808.virtual_machine_id: \"\" => \"5a7858c1-f84a-47b0-837f-4639530f6ef9\"\n  ip_address_id:                         \"\" => \"9692c7c9-f3ca-445a-b375-3a1ba488d886\"\n  managed:                               \"\" => \"false\"\nmodule.vm_instance_2.cloudstack_port_forward.pf_ssh: Creation complete\nmodule.vm_instance_3.cloudstack_port_forward.pf_ssh: Creation complete\nmodule.vm_instance_1.cloudstack_port_forward.pf_ssh: Creation complete\n\nApply complete! Resources: 8 added, 0 changed, 0 destroyed.\n\nThe state of your infrastructure has been saved to the path\nbelow. This state is required to modify and destroy your\ninfrastructure, so keep it safe. To inspect the complete state\nuse the `terraform show` command.\n\nState path: terraform.tfstate\n\nOutputs:\n\npublic_ipaddress = zzz.zzz.zzz.zzz\n$\n```\n\n\u4e26\u5217\u3067VM\u4f5c\u6210\u306a\u3069\u304c\u884c\u306a\u308f\u308c\u3066\u3044\u308b\u3053\u3068\u304c\u308f\u304b\u308b\u3068\u601d\u3044\u307e\u3059\u3002\n\n### Apply\u5f8c\u306e\u72b6\u614b\n#### VM\u4e00\u89a7\n\u898b\u4e8b\u306bVM\u304c\u4f5c\u6210\u3055\u308c\u3066\u3044\u308b\uff01\n\u753b\u9762\u3067\u898b\u308b\u3068\u3084\u3063\u305f\u611f\u304c\u51fa\u307e\u3059\u3002\n![after_vm.png](https://qiita-image-store.s3.amazonaws.com/0/46472/ad7e67f6-6d58-ed8e-eea5-a1d2dc292957.png \"after_vm.png\")\n\n\n#### IP\u30a2\u30c9\u30ec\u30b9\n\u65b0\u3057\u3044PublicIP\u30a2\u30c9\u30ec\u30b9\u304c\u53d6\u5f97\u3055\u308c\u3066\u3001Firewall\u3084\u30dd\u30fc\u30c8\u30d5\u30a9\u30ef\u30fc\u30c7\u30a3\u30f3\u30b0\u304c\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u304c\u308f\u304b\u308a\u307e\u3059\u3002\n![after_ipaddress.png](https://qiita-image-store.s3.amazonaws.com/0/46472/13c6fa8f-bab9-5ec6-fa9b-ce5dc87fa12f.png \"after_ipaddress.png\")\n\n\n# \u304a\u308f\u308a\u306b\nTerraform\u306f`\u72b6\u614b`\u3092\u7ba1\u7406\u3059\u308b\u3082\u306e\u306a\u306e\u3067\u305d\u3053\u304c\u826f\u3044\u3068\u601d\u3046\u3057\u3001GO\u88fd\u306e\u30c4\u30fc\u30eb\u306a\u306e\u3067\u30bf\u30b9\u30af\u304c\u666e\u901a\u306b\u4e26\u5217\u5316\u3055\u308c\u308b\u3068\u3053\u308d\u304c\u826f\u3044\u3068\u601d\u3046\u3002\n\u305f\u3060IDCF\u30af\u30e9\u30a6\u30c9\u3067\u540d\u524d\u3092\u7ba1\u7406\u3059\u308b\u305f\u3081\u306b\u5229\u7528\u3057\u3066\u3044\u308bTag\u306e\u8a2d\u5b9a\u304c\u3067\u304d\u305f\u3089\u3082\u3063\u3068\u826f\u3044\u304b\u306a\u3068\u601d\u3046\u3068\u3053\u308d\u3002\n\u81ea\u5206\u3067\u5b9f\u88c5\u3057\u308d\u3088\u3001\u3068\u3044\u3046\u8a71\u3060\u3051\u3067\u3082:smile:\n", "tags": ["CloudStack", "IDCF\u30af\u30e9\u30a6\u30c9", "Terraform"]}