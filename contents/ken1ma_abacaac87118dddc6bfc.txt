{"tags": ["FreeBSD", "dovecot"], "context": "FreeBSD \u306b Dovecot 2.2.27 \u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u3066\u307f\u305f\u306e\u3067\u30e1\u30e2\u3002\n\uff08\u6ce8\uff1a\u307e\u3060\u66f8\u304d\u304b\u3051\u3067\u3059\uff09\n\n\u74b0\u5883\n\nFreeBSD 11.0 (VirtualBox)\n\n\n\u65b9\u91dd\n\n\nports \u3092\u4f7f\u3063\u3066\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n\npkg \u3067\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3067\u304d\u308b\u306e\u306f\u30d0\u30fc\u30b8\u30e7\u30f3 2.2.25_5 \u3067\u3061\u3087\u3063\u3068\u53e4\u3044\u3002\n% pkg search dovecot2 | grep -v plugin\ndovecot2-2.2.25_5              Secure, fast and powerful IMAP and POP3 server\n\n\n\ndovecot \u30d1\u30c3\u30b1\u30fc\u30b8\u306f\u30d0\u30fc\u30b8\u30e7\u30f3 1.2.17 \u306a\u306e\u3067 dovecot2 \u3092\u4f7f\u7528\n\n\n\n\n\nports \u3092\u66f4\u65b0\u3059\u308b\n\n\nFreeBSD 11.0 \u306b\u540c\u68b1\u3055\u308c\u3066\u3044\u308b ports \u3067\u306f dovecot2 \u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u306f 2.2.24 \u3067\u3061\u3087\u3063\u3068\u53e4\u3044\n% grep ^PORTVERSION /usr/ports/mail/dovecot2/Makefile\nPORTVERSION=    2.2.24\n\n\n\n\nIMAP \u306e\u307f\u3067 POP3 \u306f\u4f7f\u308f\u306a\u3044\nSSL \u5fc5\u9808\nPAM \u3067\u30d1\u30b9\u30ef\u30fc\u30c9\u8a8d\u8a3c\nmaildir \u5f62\u5f0f\n\n\nports \u3092\u66f4\u65b0\n\n\n/usr/ports \u3092\u66f4\u65b0\n% sudo portsnap fetch\n% sudo portsnap extract\n\n\n\ndovecot2 \u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u3092\u78ba\u8a8d\n% grep ^PORTVERSION /usr/ports/mail/dovecot2/Makefile\nPORTVERSION=    2.2.27\n\n\n\n\nDovecot \u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n\nmake\n% cd /usr/ports/mail/dovecot2\n% sudo make install\n\n\n\n\n\n\u30c7\u30d5\u30a9\u30eb\u30c8\u306e\u8a2d\u5b9a\u306e\u307e\u307e\u7d9a\u884c\n\n\n\n\nDovecot \u8a2d\u5b9a\n\n\n/usr/local/etc/dovecot/dovecot.conf \u3092\u4f5c\u6210\n# only imap (no pop3)\n# lmtp is to be used by smtpd\nprotocols = imap lmtp\n\nssl = required\nssl_cert = </etc/mail/certs/host.cert\nssl_key = </etc/mail/certs/host.key\n\n# used in Message-Id and LMTP replies\nhostname = mail.mydomain.jp\n\n# use maildir rather than mbox\nmail_location = maildir:~/Maildir\n\n# don't let users log in as system users\nfirst_valid_uid = 1000\nfirst_valid_gid = 1000\n\n# PAM authentication\npassdb {\n    driver = pam\n    # use /etc/pam.d/imap\n    args = %s\n}\n\n# Get uid, gid, home from /etc/passwd through nsswitch\nuserdb {\n    driver = passwd\n}\n\n#service auth {\n    # smtp-auth\n#   unix_listener /var/spool/smtpd/private/auth {\n#       mode = 0666\n#   }\n#}\n\n# special mailboxes\nnamespace inbox {\n    inbox = yes\n\n    mailbox Drafts {\n        special_use = \\Drafts\n    }\n\n    mailbox Junk {\n        special_use = \\Junk\n    }\n\n    mailbox Trash {\n        special_use = \\Trash\n    }\n\n    mailbox Sent {\n        special_use = \\Sent\n    }\n\n    mailbox virtual/All {\n        special_use = \\All\n    }\n\n    mailbox virtual/Flagged {\n        special_use = \\Flagged\n    }\n}\n\n\n\n/etc/pam.d/imap \u306f FreeBSD 11.0 \u306b\u30d0\u30f3\u30c9\u30eb\u3055\u308c\u3066\u3044\u308b\u3082\u306e\u3092\u305d\u306e\u307e\u307e\u4f7f\u3046\nauth            required        pam_unix.so             no_warn try_first_pass\naccount         required        pam_unix.so\n\n\n\n\nDovecot \u8d77\u52d5\n\n\n\u30b5\u30fc\u30d3\u30b9\u3092\u6709\u52b9\u306b\u3059\u308b\n\n\n/etc/rc.conf \u306b\u8ffd\u52a0\ndovecot_enable=\"YES\"\n\n\n\n\n\n\u8d77\u52d5\n$ sudo service dovecot start\n\n\n\nFreeBSD \u306b Dovecot 2.2.27 \u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u3066\u307f\u305f\u306e\u3067\u30e1\u30e2\u3002\n\uff08\u6ce8\uff1a\u307e\u3060\u66f8\u304d\u304b\u3051\u3067\u3059\uff09\n\n# \u74b0\u5883\n\n1. [FreeBSD 11.0 (VirtualBox)](http://qiita.com/ken1ma/items/86748d03c2e8c192dce6)\n\n# \u65b9\u91dd\n\n1. ports \u3092\u4f7f\u3063\u3066\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n    1. `pkg` \u3067\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3067\u304d\u308b\u306e\u306f\u30d0\u30fc\u30b8\u30e7\u30f3 2.2.25_5 \u3067\u3061\u3087\u3063\u3068\u53e4\u3044\u3002\n\n            % pkg search dovecot2 | grep -v plugin\n            dovecot2-2.2.25_5              Secure, fast and powerful IMAP and POP3 server\n\n      1. `dovecot` \u30d1\u30c3\u30b1\u30fc\u30b8\u306f\u30d0\u30fc\u30b8\u30e7\u30f3 1.2.17 \u306a\u306e\u3067 `dovecot2` \u3092\u4f7f\u7528\n\n2. ports \u3092\u66f4\u65b0\u3059\u308b\n    1. FreeBSD 11.0 \u306b\u540c\u68b1\u3055\u308c\u3066\u3044\u308b ports \u3067\u306f `dovecot2` \u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u306f 2.2.24 \u3067\u3061\u3087\u3063\u3068\u53e4\u3044\n\n            % grep ^PORTVERSION /usr/ports/mail/dovecot2/Makefile\n            PORTVERSION=\t2.2.24\n\n3. IMAP \u306e\u307f\u3067 POP3 \u306f\u4f7f\u308f\u306a\u3044\n4. SSL \u5fc5\u9808\n5. PAM \u3067\u30d1\u30b9\u30ef\u30fc\u30c9\u8a8d\u8a3c\n6. maildir \u5f62\u5f0f\n\n# ports \u3092\u66f4\u65b0\n\n1. `/usr/ports` \u3092\u66f4\u65b0\n\n    ```\n% sudo portsnap fetch\n% sudo portsnap extract\n```\n\n2. dovecot2 \u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u3092\u78ba\u8a8d\n\n    ```\n% grep ^PORTVERSION /usr/ports/mail/dovecot2/Makefile\nPORTVERSION=\t2.2.27\n```\n\n# Dovecot \u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n1. `make`\n\n    ```\n% cd /usr/ports/mail/dovecot2\n% sudo make install\n```\n\n1. ![Screen Shot 2016-12-27 at 9.51.24.png](https://qiita-image-store.s3.amazonaws.com/0/131106/7dfc596a-aaf6-f894-d45f-f3eeb6cdabdf.png)\n    1. \u30c7\u30d5\u30a9\u30eb\u30c8\u306e\u8a2d\u5b9a\u306e\u307e\u307e\u7d9a\u884c\n\n\n# Dovecot \u8a2d\u5b9a\n\n1. `/usr/local/etc/dovecot/dovecot.conf` \u3092\u4f5c\u6210\n\n        # only imap (no pop3)\n        # lmtp is to be used by smtpd\n        protocols = imap lmtp\n        \n        ssl = required\n        ssl_cert = </etc/mail/certs/host.cert\n        ssl_key = </etc/mail/certs/host.key\n        \n        # used in Message-Id and LMTP replies\n        hostname = mail.mydomain.jp\n        \n        # use maildir rather than mbox\n        mail_location = maildir:~/Maildir\n        \n        # don't let users log in as system users\n        first_valid_uid = 1000\n        first_valid_gid = 1000\n        \n        # PAM authentication\n        passdb {\n        \tdriver = pam\n        \t# use /etc/pam.d/imap\n        \targs = %s\n        }\n        \n        # Get uid, gid, home from /etc/passwd through nsswitch\n        userdb {\n        \tdriver = passwd\n        }\n        \n        #service auth {\n        \t# smtp-auth\n        #\tunix_listener /var/spool/smtpd/private/auth {\n        #\t\tmode = 0666\n        #\t}\n        #}\n        \n        # special mailboxes\n        namespace inbox {\n        \tinbox = yes\n        \n        \tmailbox Drafts {\n        \t\tspecial_use = \\Drafts\n        \t}\n        \n        \tmailbox Junk {\n        \t\tspecial_use = \\Junk\n        \t}\n        \n        \tmailbox Trash {\n        \t\tspecial_use = \\Trash\n        \t}\n        \n        \tmailbox Sent {\n        \t\tspecial_use = \\Sent\n        \t}\n        \n        \tmailbox virtual/All {\n        \t\tspecial_use = \\All\n        \t}\n        \n        \tmailbox virtual/Flagged {\n        \t\tspecial_use = \\Flagged\n        \t}\n        }\n\n2. `/etc/pam.d/imap` \u306f FreeBSD 11.0 \u306b\u30d0\u30f3\u30c9\u30eb\u3055\u308c\u3066\u3044\u308b\u3082\u306e\u3092\u305d\u306e\u307e\u307e\u4f7f\u3046\n\n        auth            required        pam_unix.so             no_warn try_first_pass\n        account         required        pam_unix.so\n\n# Dovecot \u8d77\u52d5\n\n1. \u30b5\u30fc\u30d3\u30b9\u3092\u6709\u52b9\u306b\u3059\u308b\n\n    1. `/etc/rc.conf` \u306b\u8ffd\u52a0\n\n            dovecot_enable=\"YES\"\n\n2. \u8d77\u52d5\n\n        $ sudo service dovecot start\n"}