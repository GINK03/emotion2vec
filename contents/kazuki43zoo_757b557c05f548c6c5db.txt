{"context": "\u4eca\u56de\u306f\u3001Spring MVC\u30d9\u30fc\u30b9\u306eWeb\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3(\u753b\u9762\u30a2\u30d7\u30ea or REST API)\u3067\u3001\u30ea\u30af\u30a8\u30b9\u30c8\u51e6\u7406\u5185\u306e\u4efb\u610f\u306e\u30dd\u30a4\u30f3\u30c8\u3067\u5171\u901a\u51e6\u7406\u3092\u5b9f\u884c\u3059\u308b\u65b9\u6cd5\u3092\u306b\u3064\u3044\u3066\u8aac\u660e\u3057\u307e\u3059\u3002\u306a\u304a\u3001Servlet 3.0\u3067\u30b5\u30dd\u30fc\u30c8\u3055\u308c\u305f\u975e\u540c\u671f\u51e6\u7406\u5229\u7528\u6642\u306e\u5171\u901a\u51e6\u7406\u306e\u5b9f\u88c5\u306f\u3001\u4eca\u56de\u306f\u5bfe\u8c61\u5916\u3068\u3057\u3066\u5225\u306e\u56de\u3067\u7d39\u4ecb\u3057\u305f\u3044\u3068\u601d\u3044\u307e\u3059\u3002\uff08\u4e5e\u3046\u3054\u671f\u5f85\uff01\uff01\uff09\n\n\u52d5\u4f5c\u691c\u8a3c\u30d0\u30fc\u30b8\u30e7\u30f3\n\nSpring Framework 4.3.3.RELEASE\nSpring Boot 1.4.1.RELEASE\n\n\n\u5171\u901a\u51e6\u7406\u306e\u5b9f\u88c5\u65b9\u6cd5\n\u5171\u901a\u51e6\u7406\u306f\u4ee5\u4e0b\u306e\u3044\u305a\u308c\u304b\u306e\u65b9\u6cd5\u3067\u5b9f\u88c5\u3057\u307e\u3059\u3002\n\n\n\n\u5b9f\u88c5\u65b9\u6cd5\n\u8aac\u660e\n\n\n\n\njavax.servlet.Filter.ServletRequestListener\n\u30ea\u30af\u30a8\u30b9\u30c8\u958b\u59cb\u6642\u3068\u30ea\u30af\u30a8\u30b9\u30c8\u7d42\u4e86\u6642\u306e\u30bf\u30a4\u30df\u30f3\u30b0\u3067\u4efb\u610f\u306e\u51e6\u7406\u3092\u5b9f\u884c\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n\njavax.servlet.Filter\nServlet\u3001JSP\u3001\u9759\u7684\u30b3\u30f3\u30c6\u30f3\u30c4\u306a\u3069\u306eWeb\u30ea\u30bd\u30fc\u30b9\u3078\u306e\u30a2\u30af\u30bb\u30b9\u306e\u524d\u5f8c\u306b\u3001\u5171\u901a\u51e6\u7406\u3092\u5b9f\u884c\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n\nHandlerInterceptor\nSpring MVC\u306eHandler\u306e\u547c\u3073\u51fa\u3057\u524d\u5f8c\u306b\u3001\u5171\u901a\u51e6\u7406\u3092\u5b9f\u884c\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n\n@ControllerAdvice\nController\u5c02\u7528\u306e\u7279\u6b8a\u306a\u30e1\u30bd\u30c3\u30c9(@InitBainder\u30e1\u30bd\u30c3\u30c9\u3001@ModelAttribute\u30e1\u30bd\u30c3\u30c9\u3001@ExceptionHandler\u30e1\u30bd\u30c3\u30c9)\u3092\u8907\u6570\u306eController\u3067\u5171\u6709\u3067\u304d\u307e\u3059\u3002\n\n\nSpring AOP(AspectJ)\nSpring\u306eDI\u30b3\u30f3\u30c6\u30ca\u3067\u7ba1\u7406\u3055\u308c\u3066\u3044\u308bBean\u306epublic\u30e1\u30bd\u30c3\u30c9\u306e\u547c\u3073\u51fa\u3057\u524d\u5f8c\u306b\u3001\u5171\u901a\u51e6\u7406\u3092\u5b9f\u884c\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n\n\n\n\njavax.servlet.Filter.ServletRequestListener\n\nServlet\u6a19\u6e96\u306eAPI\u3067\u3042\u308bjavax.servlet.ServletRequestListener\u30a4\u30f3\u30bf\u30d5\u30a7\u30fc\u30b9\u3092\u5b9f\u88c5\u3057\u305f\u30af\u30e9\u30b9\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\u4f5c\u6210\u3057\u305f\u30af\u30e9\u30b9\u3092\u30b5\u30fc\u30d6\u30ec\u30c3\u30c8\u30b3\u30f3\u30c6\u30ca\u306b\u767b\u9332\u3059\u308b\u3068\u3001\u30ea\u30af\u30a8\u30b9\u30c8\u958b\u59cb\u6642\u3068\u30ea\u30af\u30a8\u30b9\u30c8\u7d42\u4e86\u6642\u306e\u30bf\u30a4\u30df\u30f3\u30b0\u3067\u4efb\u610f\u306e\u51e6\u7406\u3092\u5b9f\u884c\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\npackage com.example.component;\n\nimport javax.servlet.ServletRequestEvent;\nimport javax.servlet.ServletRequestListener;\n\npublic class CustomServletRequestListener implements ServletRequestListener {\n\n    @Override\n    public void requestInitialized(ServletRequestEvent sre) {\n        // \u30ea\u30af\u30a8\u30b9\u30c8\u958b\u59cb\u6642\u306e\u51e6\u7406\u3092\u884c\u3046\u3002\n        // (\u5b9f\u88c5\u306f\u7701\u7565)\n    }\n    @Override\n    public void requestDestroyed(ServletRequestEvent sre) {\n        // \u30ea\u30af\u30a8\u30b9\u30c8\u7d42\u4e86\u6642\u306e\u51e6\u7406\u3092\u884c\u3046\u3002\n        // (\u5b9f\u88c5\u306f\u7701\u7565)\n    }\n\n}\n\n\u5b9f\u88c5\u3057\u305fServletRequestListener\u30af\u30e9\u30b9\u3092\u30b5\u30fc\u30d6\u30ec\u30c3\u30c8\u30b3\u30f3\u30c6\u30ca\u306b\u767b\u9332\u3057\u307e\u3059\u3002\n\nsrc/main/webapp/WEB-INF/web.xml\n<listener>\n    <listener-class>com.example.component.CustomServletRequestListener</listener-class>\n</listener>\n\n\n\nBean\u306e\u30a4\u30f3\u30b8\u30a7\u30af\u30b7\u30e7\u30f3\nServletRequestListener\u5185\u306e\u51e6\u7406\u3067DI\u30b3\u30f3\u30c6\u30ca\u3067\u7ba1\u7406\u3057\u3066\u3044\u308bBean\u3092\u5229\u7528\u3057\u305f\u3044\u5834\u5408\u306f\u3001ServletRequestListener\u30af\u30e9\u30b9\u3092DI\u30b3\u30f3\u30c6\u30ca\u306b\u767b\u9332\u3057\u3001org.springframework.web.context.ServletContextAware#setServletContext \u30e1\u30bd\u30c3\u30c9\u306e\u4e2d\u3067ServletContext#addListener\u30e1\u30bd\u30c3\u30c9\u3092\u547c\u3073\u51fa\u3059\u3053\u3068\u3067\u5b9f\u73fe\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n@Component\npublic class CustomServletRequestListener implements ServletRequestListener , ServletContextAware {\n    @Autowired\n    MessageSource messageSource; // Bean\u3092\u30a4\u30f3\u30b8\u30a7\u30af\u30b7\u30e7\u30f3\u3059\u308b\n    // ...\n    @Override\n    public void setServletContext(ServletContext servletContext) {\n        servletContext.addListener(this);\n    }\n}\n\n\nWarning: \u30d9\u30b9\u30c8\u30d7\u30e9\u30af\u30c6\u30a3\u30b9\u306b\u3064\u3044\u3066\n\u3053\u306e\u65b9\u6cd5\u304c\u30d9\u30b9\u30c8\u30d7\u30e9\u30af\u30c6\u30a3\u30b9\u306a\u306e\u304b\u306f\u304b\u306a\u308a\u5fae\u5999\u3067\u3059  \n\u5f8c\u307b\u3069\u7d39\u4ecb\u3057\u307e\u3059\u304c\u3001Spring Boot\u3092\u4f7f\u3046\u5834\u5408\u306f\u3001\u5358\u7d14\u306bDI\u30b3\u30f3\u30c6\u30ca\u306b\u767b\u9332\u3059\u308b\u3060\u3051\u3067\u81ea\u52d5\u3067\u30b5\u30fc\u30d6\u30ec\u30c3\u30c8\u30b3\u30f3\u30c6\u30ca\u306b\u767b\u9332\u3055\u308c\u307e\u3059\uff01\uff01\n\n\nSpring\u63d0\u4f9b\u306eServletRequestListener\u30af\u30e9\u30b9\nSpring Web\u53ca\u3073Spring MVC\u63d0\u4f9b\u306eFilter\u30af\u30e9\u30b9\u306f\u4ee5\u4e0b\u306e\u3068\u304a\u308a\u3067\u3059\u3002\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u8981\u4ef6\u306b\u5fdc\u3058\u3066\u4f7f\u7528\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n\n\n\u30af\u30e9\u30b9\n\u8aac\u660e\n\n\n\n\nRequestContextListener\n\u30ea\u30af\u30a8\u30b9\u30c8(HttpServletRequest\u3068HttpServletResponse)+\u30ea\u30af\u30a8\u30b9\u30c8\u306e\u30ed\u30b1\u30fc\u30eb\u60c5\u5831\u3092\u30b9\u30ec\u30c3\u30c9\u30ed\u30fc\u30ab\u30eb\u306b\u8a2d\u5b9a\u3059\u308b\u305f\u3081\u306eServletRequestListener\u30af\u30e9\u30b9\u3002\n\n\n\n\njavax.servlet.Filter\n\nServlet\u6a19\u6e96\u306eAPI\u3067\u3042\u308bjavax.servlet.Filter\u30a4\u30f3\u30bf\u30d5\u30a7\u30fc\u30b9\u3092\u5b9f\u88c5\u3057\u305f\u30af\u30e9\u30b9\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\u4f5c\u6210\u3057\u305f\u30af\u30e9\u30b9\u3092\u30b5\u30fc\u30d6\u30ec\u30c3\u30c8\u30b3\u30f3\u30c6\u30ca\u306b\u767b\u9332\u3059\u308b\u3068\u3001Servlet\u306e\u547c\u3073\u51fa\u3057\u524d\u5f8c\u306b\u4efb\u610f\u306e\u51e6\u7406\u3092\u5b9f\u884c\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\npackage com.example.component;\n\nimport javax.servlet.*;\nimport java.io.IOException;\n\npublic class CustomFilter implements Filter {\n    @Override\n    public void init(FilterConfig filterConfig) throws ServletException {\n        // \u521d\u671f\u5316\u51e6\u7406\u3092\u884c\u3046\u3002\u3053\u306e\u30e1\u30bd\u30c3\u30c9\u306f\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u8d77\u52d5\u6642\u306b\u547c\u3073\u51fa\u3055\u308c\u308b\u3002\n        // \u30b5\u30fc\u30d6\u30ec\u30c3\u30c8\u30d5\u30a3\u30eb\u30bf\u306e\u521d\u671f\u5316\u30d1\u30e9\u30e1\u30fc\u30bf\u306f\u5f15\u6570\u306eFilterConfig\u304b\u3089\u53d6\u5f97\u3067\u304d\u308b\u3002\n        // (\u5b9f\u88c5\u306f\u7701\u7565)\n    }\n    @Override\n    public void doFilter(ServletRequest request, ServletResponse response, FilterChain chain) throws IOException, ServletException {\n        // \u3053\u3053\u306b\u524d\u51e6\u7406\u3092\u5b9f\u88c5\u3059\u308b\n        // (\u5b9f\u88c5\u306f\u7701\u7565)\n        // \u5f8c\u7d9a\u51e6\u7406(\u6b21\u306eFilter\u53c8\u306fServlet)\u3092\u547c\u3073\u51fa\u3057\u305f\u304f\u306a\u3044\u5834\u5408\u306f\u3001\u3053\u306e\u30bf\u30a4\u30df\u30f3\u30b0\u3067\u30e1\u30bd\u30c3\u30c9\u3092\u7d42\u4e86(return)\u3059\u308c\u3070\u3088\u3044\u3002\n\n        // \u5f8c\u7d9a\u51e6\u7406(\u6b21\u306eFilter\u53c8\u306fServlet)\u3092\u547c\u3073\u51fa\u3059\n        chain.doFilter(request, response);\n\n        // \u3053\u3053\u306b\u5f8c\u51e6\u7406\u3092\u5b9f\u88c5\u3059\u308b\n        // (\u5b9f\u88c5\u306f\u7701\u7565)\n   }\n    @Override\n    public void destroy() {\n        // \u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u7d42\u4e86\u6642\u306b\u884c\u3046\u51e6\u7406\u3092\u5b9f\u88c5\u3059\u308b\n        // (\u5b9f\u88c5\u306f\u7701\u7565)\n    }\n}\n\n\u5b9f\u88c5\u3057\u305fFilter\u30af\u30e9\u30b9\u3092\u30b5\u30fc\u30d6\u30ec\u30c3\u30c8\u30b3\u30f3\u30c6\u30ca\u306b\u767b\u9332\u3057\u3001Filter\u3092\u9069\u7528\u3059\u308b\u30ea\u30af\u30a8\u30b9\u30c8\u3092<url-pattern>\u307e\u305f\u306f<servle-name>\u30bf\u30b0\u3092\u4f7f\u7528\u3057\u3066\u6307\u5b9a\u3057\u307e\u3059\u3002\n\nsrc/main/webapp/WEB-INF/web.xml\n<filter>\n    <filter-name>CustomFilter</filter-name>\n    <filter-class>com.example.component.CustomFilter</filter-class>\n</filter>\n<filter-mapping>\n    <filter-name>CustomFilter</filter-name>\n    <url-pattern>/*</url-pattern> <!-- \u30ea\u30af\u30a8\u30b9\u30c8\u30d1\u30b9\u304c\u6307\u5b9a\u3057\u305f\u30d1\u30bf\u30fc\u30f3\u306b\u4e00\u81f4\u3059\u308b\u30ea\u30af\u30a8\u30b9\u30c8\u306b\u5bfe\u3057\u3066\u306e\u307fFilter\u304c\u9069\u7528\u3055\u308c\u307e\u3059\u3002 -->\n    <!-- <servlet-name>app</servlet-name> --> <!-- \u6307\u5b9a\u3057\u305f\u30b5\u30fc\u30d6\u30ec\u30c3\u30c8\u306b\u30de\u30c3\u30d4\u30f3\u30b0\u3055\u308c\u305f\u30ea\u30af\u30a8\u30b9\u30c8\u306b\u5bfe\u3057\u3066\u306e\u307fFilter\u304c\u9069\u7528\u3055\u308c\u307e\u3059\u3002 -->\n</filter-mapping>\n\n\n\u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u306f\u3001Filter\u3092\u9069\u7528\u3059\u308b\u30bf\u30a4\u30df\u30f3\u30b0\u306f\u30ea\u30af\u30a8\u30b9\u30c8\u3092\u53d7\u3051\u305f\u6642\u3060\u3051\u3067\u3059\u304c\u3001\u3053\u306e\u30bf\u30a4\u30df\u30f3\u30b0\u306f\u5909\u66f4\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\u6307\u5b9a\u53ef\u80fd\u306a\u30bf\u30a4\u30df\u30f3\u30b0\u306f\u4ee5\u4e0b\u306e5\u3064\u3067\u3001<dispatcher>\u30bf\u30b0\u3092\u4f7f\u7528\u3057\u3066\u6307\u5b9a\u3057\u307e\u3059\u3002\n\nsrc/main/webapp/WEB-INF/web.xml\n<filter-mapping>\n    <filter-name>CustomFilter</filter-name>\n    <url-pattern>/*</url-pattern>\n    <dispatcher>REQUEST</dispatcher> <!-- \u4e00\u81f4\u3059\u308b\u30d1\u30b9\u3084\u30b5\u30fc\u30d6\u30ec\u30c3\u30c8\u3078\u306e\u30ea\u30af\u30a8\u30b9\u30c8\u3092\u53d7\u3051\u305f\u6642 -->\n    <dispatcher>ASYNC</dispatcher> <!-- \u4e00\u81f4\u3059\u308b\u30d1\u30b9\u3084\u30b5\u30fc\u30d6\u30ec\u30c3\u30c8\u3078\u306e\u975e\u540c\u671f\u30ea\u30af\u30a8\u30b9\u30c8\u3092\u53d7\u3051\u305f\u6642 -->\n    <dispatcher>FORWARD</dispatcher> <!-- \u4e00\u81f4\u3059\u308b\u30d1\u30b9\u3084\u30b5\u30fc\u30d6\u30ec\u30c3\u30c8\u3078\u30d5\u30a9\u30ef\u30fc\u30c9\u3057\u305f\u6642 -->\n    <dispatcher>INCLUDE</dispatcher> <!-- \u4e00\u81f4\u3059\u308b\u30d1\u30b9\u3084\u30b5\u30fc\u30d6\u30ec\u30c3\u30c8\u3092\u30a4\u30f3\u30af\u30eb\u30fc\u30c9\u3057\u305f\u6642 -->\n    <dispatcher>ERROR</dispatcher> <!-- \u4e00\u81f4\u3059\u308b\u30d1\u30b9\u3084\u30b5\u30fc\u30d6\u30ec\u30c3\u30c8\u3078\u30a8\u30e9\u30fc\u9077\u79fb\u3057\u305f\u6642 -->\n</filter-mapping>\n\n\n\nSpring\u63d0\u4f9b\u306e\u30b5\u30dd\u30fc\u30c8\u30af\u30e9\u30b9\u3092\u5229\u7528\u3057\u305fFilter\u30af\u30e9\u30b9\u306e\u4f5c\u6210\nSpring\u306f\u3001Filter\u3092\u4f5c\u6210\u3059\u308b\u305f\u3081\u306e\u30b5\u30dd\u30fc\u30c8\u30af\u30e9\u30b9\u3092\u63d0\u4f9b\u3057\u3066\u3044\u307e\u3059\u3002\n\n\n\n\u30af\u30e9\u30b9\n\u8aac\u660e\n\n\n\n\nGenericFilterBean\nFilter\u306e\u521d\u671f\u5316\u30d1\u30e9\u30e1\u30fc\u30bf\u3092Filter\u30af\u30e9\u30b9\u306e\u30d7\u30ed\u30d1\u30c6\u30a3\u306b\u8a2d\u5b9a\u3059\u308b\u6a5f\u80fd\u3092\u6301\u3064\u57fa\u5e95\u30af\u30e9\u30b9\u3002Spring\u304c\u63d0\u4f9b\u3059\u308bFilter\u30af\u30e9\u30b9\u306e\u591a\u304f\u306f\u3001\u3053\u306e\u30af\u30e9\u30b9\u306e\u5b50\u30af\u30e9\u30b9\u3068\u3057\u3066\u5b9f\u88c5\u3055\u308c\u3066\u3044\u307e\u3059\u3002\n\n\nOncePerRequestFilter\n\u540c\u4e00\u30ea\u30af\u30a8\u30b9\u30c8\u5185\u3067\uff11\u56de\u3060\u3051\u51e6\u7406\u3092\u5b9f\u884c\u3059\u308b\u3053\u3068\u3092\u62c5\u4fdd\u3059\u308b\u6a5f\u80fd\u3092\u6301\u3064\u57fa\u5e95\u30af\u30e9\u30b9\u3002 GenericFilterBean\u3092\u7d99\u627f\u3057\u3066\u304a\u308a\u3001Spring\u304c\u63d0\u4f9b\u3059\u308bFilter\u30af\u30e9\u30b9\u306e\u591a\u304f\u306f\u3001\u3053\u306e\u30af\u30e9\u30b9\u306e\u5b50\u30af\u30e9\u30b9\u3068\u3057\u3066\u5b9f\u88c5\u3055\u308c\u3066\u3044\u307e\u3059\u3002\n\n\n\npackage com.example.component;\n\nimport org.springframework.web.filter.OncePerRequestFilter;\n\nimport javax.servlet.FilterChain;\nimport javax.servlet.ServletException;\nimport javax.servlet.http.HttpServletRequest;\nimport javax.servlet.http.HttpServletResponse;\nimport java.io.IOException;\n\n\npublic class CustomFilter extends OncePerRequestFilter {\n\n    private int limit; // \u540d\u524d\u304c\u4e00\u81f4\u3059\u308b\u521d\u671f\u5316\u30d1\u30e9\u30e1\u30fc\u30bf\u306e\u5024\u304c\u30d0\u30a4\u30f3\u30c9\u3055\u308c\u308b\n\n    public int getLimit() {\n        return limit;\n    }\n\n    public void setLimit(int limit) {\n        this.limit = limit;\n    }\n\n    @Override\n    protected void initFilterBean() throws ServletException {\n        // \u5fc5\u8981\u306b\u5fdc\u3058\u3066\u521d\u671f\u5316\u51e6\u7406\u3092\u884c\u3046\u3002\u3053\u306e\u30e1\u30bd\u30c3\u30c9\u306f\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u8d77\u52d5\u6642\u306b\u547c\u3073\u51fa\u3055\u308c\u308b\u3002\n        // \u30b5\u30fc\u30d6\u30ec\u30c3\u30c8\u30d5\u30a3\u30eb\u30bf\u306e\u521d\u671f\u5316\u30d1\u30e9\u30e1\u30fc\u30bf\u306f\u3001\u3053\u306e\u30af\u30e9\u30b9\u306e\u30d7\u30ed\u30d1\u30c6\u30a3\u306b\u30d0\u30a4\u30f3\u30c9\u3057\u3066\u53d6\u5f97\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u308b\u3002\n        // \u306a\u304a\u3001getFilterConfig()\u3092\u547c\u3073\u51fa\u3057\u3066FilterConfig\u3092\u53d6\u5f97\u3059\u308b\u3053\u3068\u3082\u53ef\u80fd\u3002\n        // \u521d\u671f\u5316\u51e6\u7406\u304c\u4e0d\u8981\u306a\u5834\u5408\u306f\u30aa\u30fc\u30d0\u30fc\u30e9\u30a4\u30c9\u3082\u4e0d\u8981\u3002\n        // (\u5b9f\u88c5\u306f\u7701\u7565)\n    }\n\n    @Override\n    protected void doFilterInternal(HttpServletRequest request, HttpServletResponse response, FilterChain filterChain) throws ServletException, IOException {\n        // \u3053\u3053\u306b\u524d\u51e6\u7406\u3092\u5b9f\u88c5\u3059\u308b\n        // (\u5b9f\u88c5\u306f\u7701\u7565)\n        // \u5f8c\u7d9a\u51e6\u7406(\u6b21\u306eFilter\u53c8\u306fServlet)\u3092\u547c\u3073\u51fa\u3057\u305f\u304f\u306a\u3044\u5834\u5408\u306f\u3001\u3053\u306e\u30bf\u30a4\u30df\u30f3\u30b0\u3067\u30e1\u30bd\u30c3\u30c9\u3092\u7d42\u4e86(return)\u3059\u308c\u3070\u3088\u3044\u3002\n\n        // \u5f8c\u7d9a\u51e6\u7406(\u6b21\u306eFilter\u53c8\u306fServlet)\u3092\u547c\u3073\u51fa\u3059\n        chain.doFilter(request, response);\n\n        // \u3053\u3053\u306b\u5f8c\u51e6\u7406\u3092\u5b9f\u88c5\u3059\u308b\n        // (\u5b9f\u88c5\u306f\u7701\u7565)\n    }\n\n    @Override\n    public void destroy() {\n        // \u5fc5\u8981\u306b\u5fdc\u3058\u3066\u3001\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u7d42\u4e86\u6642\u306b\u884c\u3046\u51e6\u7406\u3092\u5b9f\u88c5\u3059\u308b\u3002\n        // \u7d42\u4e86\u51e6\u7406\u304c\u4e0d\u8981\u306a\u5834\u5408\u306f\u30aa\u30fc\u30d0\u30fc\u30e9\u30a4\u30c9\u3082\u4e0d\u8981\u3002\n        // (\u5b9f\u88c5\u306f\u7701\u7565)\n    }\n\n}\n\n\nsrc/main/webapp/WEB-INF/web.xml\n<filter>\n    <filter-name>CustomFilter</filter-name>\n    <filter-class>com.example.component.CustomFilter</filter-class>\n    <init-param> <!-- Filter\u30af\u30e9\u30b9\u306e\u30d7\u30ed\u30d1\u30c6\u30a3\u306b\u30d0\u30a4\u30f3\u30c9\u3055\u308c\u308b -->\n        <param-name>limit</param-name>\n        <param-value>10</param-value>\n    </init-param>\n</filter>\n\n\n\nBean\u306e\u30a4\u30f3\u30b8\u30a7\u30af\u30b7\u30e7\u30f3\nFilter\u5185\u306e\u51e6\u7406\u3067DI\u30b3\u30f3\u30c6\u30ca\u3067\u7ba1\u7406\u3057\u3066\u3044\u308bBean\u3092\u5229\u7528\u3057\u305f\u3044\u5834\u5408\u306f\u3001Filter\u306e\u5b9f\u88c5\u30af\u30e9\u30b9\u3092DI\u30b3\u30f3\u30c6\u30ca\u306b\u767b\u9332\u3057\u3001org.springframework.web.filter.DelegatingFilterProxy\u7d4c\u7531\u3067Filter\u306e\u51e6\u7406\u3092\u5b9f\u884c\u3057\u307e\u3059\u3002\npublic class CustomFilter implements Filter {\n    @Autowired\n    MessageSource messageSource; // Bean\u3092\u30a4\u30f3\u30b8\u30a7\u30af\u30b7\u30e7\u30f3\u3059\u308b\n    // ...\n}\n\n@Configuration\npublic class AppConfig {\n    @Bean\n    public CustomFilter customFilter() { // Filter\u3092Bean\u767b\u9332\u3059\u308b\n        return new CustomFilter();\n    }\n}\n\n\nsrc/main/webapp/WEB-INF/web.xml\n<filter>\n    <filter-name>customFilter</filter-name> <!-- Filter\u306eBean\u540d\u3092\u6307\u5b9a\u3059\u308b -->\n    <filter-class>org.springframework.web.filter.DelegatingFilterProxy</filter-class>\n</filter>\n\n\n\u306a\u304a\u3001Filter\u306eBean\u306f\u3001org.springframework.web.context.ContextLoaderListener\u7d4c\u7531\u3067DI\u30b3\u30f3\u30c6\u30ca\u306b\u767b\u9332\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002(DispatcherServlet\u6bce\u306eDI\u30b3\u30f3\u30c6\u30ca\u306bFilter\u306eBean\u3092\u767b\u9332\u3057\u3066\u3082\u8a8d\u8b58\u3055\u308c\u307e\u305b\u3093)\n\nSpring\u63d0\u4f9b\u306eFilter\u30af\u30e9\u30b9\nSpring Web\u53ca\u3073Spring MVC\u63d0\u4f9b\u306eFilter\u30af\u30e9\u30b9\u306f\u4ee5\u4e0b\u306e\u3068\u304a\u308a\u3067\u3059\u3002CharacterEncodingFilter\u306f\u5fc5\u305a\u8a2d\u5b9a\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u304c\u3001\u305d\u306e\u4ed6\u306eFilter\u306f\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u8981\u4ef6\u306b\u5fdc\u3058\u3066\u4f7f\u7528\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n\n\n\u30af\u30e9\u30b9\n\u8aac\u660e\n\n\n\n\nCorsFilter\nCORS\u9023\u643a\u7528\u306eFilter\u30af\u30e9\u30b9\u3002\n\n\nHttpPutFormContentFilter\nHTML\u30d5\u30a9\u30fc\u30e0\u304b\u3089\u306e\u30ea\u30af\u30a8\u30b9\u30c8(application/x-www-form-urlencoded)\u3067PUT\u3068PATCH\u30e1\u30bd\u30c3\u30c9\u3092\u5229\u7528\u3067\u304d\u308b\u3088\u3046\u306b\u3059\u308b\u305f\u3081\u306eFilter\u30af\u30e9\u30b9\u3002\n\n\nHiddenHttpMethodFilter\n\u30ea\u30af\u30a8\u30b9\u30c8\u30d1\u30e9\u30e1\u30fc\u30bf(hidden\u30d1\u30e9\u30e1\u30fc\u30bf)\u3067\u6307\u5b9a\u3055\u308c\u305fHTTP\u30e1\u30bd\u30c3\u30c9\u306b\u5909\u63db\u3059\u308b(\u306a\u308a\u3059\u307e\u3059)\u305f\u3081\u306eFilter\u30af\u30e9\u30b9\u3002\n\n\nCharacterEncodingFilter\n\u30ea\u30af\u30a8\u30b9\u30c8\u3068\u30ec\u30b9\u30dd\u30f3\u30b9\u306e\u6587\u5b57\u30a8\u30f3\u30b3\u30fc\u30c7\u30a3\u30f3\u30b0\u3092\u6307\u5b9a\u3059\u308b\u305f\u3081\u306eFilter\u30af\u30e9\u30b9\u3002 \u203b Spring 4.3\u304b\u3089\u30a8\u30f3\u30b3\u30fc\u30c7\u30a3\u30f3\u30b0\u306e\u5f37\u5236\u30d5\u30e9\u30b0\u304c\u30ea\u30af\u30a8\u30b9\u30c8\u3068\u30ec\u30b9\u30dd\u30f3\u30b9\u6bce\u306b\u6307\u5b9a\u53ef\u80fd\u306b\u306a\u3063\u3066\u3044\u308b\u3002\n\n\nRequestContextFilter\n\u30ea\u30af\u30a8\u30b9\u30c8(HttpServletRequest\u3068HttpServletResponse)+\u30ea\u30af\u30a8\u30b9\u30c8\u306e\u30ed\u30b1\u30fc\u30eb\u60c5\u5831\u3092\u30b9\u30ec\u30c3\u30c9\u30ed\u30fc\u30ab\u30eb\u306b\u8a2d\u5b9a\u3059\u308b\u305f\u3081\u306eFilter\u30af\u30e9\u30b9\u3002(RequestContextListener\u306eFilter\u30af\u30e9\u30b9\u7248\u3067\u3059)\n\n\nResourceUrlEncodingFilter\n\u9759\u7684\u30ea\u30bd\u30fc\u30b9\u306b\u30a2\u30af\u30bb\u30b9\u3059\u308b\u305f\u3081\u306eURL\u3092ResourceResolver\u3068\u9023\u643a\u3057\u3066\u751f\u6210\u3059\u308bFilter\u30af\u30e9\u30b9\u3002 \u8a73\u3057\u304f\u306f\u3001\u300cSpring MVC(+Spring Boot)\u4e0a\u3067\u306e\u9759\u7684\u30ea\u30bd\u30fc\u30b9\u3078\u306e\u30a2\u30af\u30bb\u30b9\u3092\u7406\u89e3\u3059\u308b\u300d\u3092\u3054\u89a7\u304f\u3060\u3055\u3044\u3002\n\n\nMultipartFilter\n\u30de\u30eb\u30c1\u30d1\u30fc\u30c8\u30ea\u30af\u30a8\u30b9\u30c8\u3092\u89e3\u6790\u3059\u308b\u305f\u3081\u306eFilter\u30af\u30e9\u30b9\u3002\n\n\nShallowEtagHeaderFilter\nETag\u306e\u5236\u5fa1\u3092\u884c\u3046Filter\u30af\u30e9\u30b9\u3002\n\n\nServletContextRequestLoggingFilter\n\u30ea\u30af\u30a8\u30b9\u30c8\u30c7\u30fc\u30bf\u3092\u30b5\u30fc\u30d6\u30ec\u30c3\u30c8\u30b3\u30f3\u30c6\u30ca\u306e\u30ed\u30b0\u306b\u51fa\u529b\u3059\u308bFilter\u30af\u30e9\u30b9\u3002\n\n\nCommonsRequestLoggingFilter\n\u30ea\u30af\u30a8\u30b9\u30c8\u30c7\u30fc\u30bf\u3092Apache Commons Logging(JCL)\u306eAPI\u7d4c\u7531\u3067\u30ed\u30b0\u306b\u51fa\u529b\u3059\u308bFilter\u30af\u30e9\u30b9\u3002\n\n\nForwardedHeaderFilter\n\nHttpServletRequest\u306egetServerName()\u3001getServerPort()\u3001getScheme()\u3001isSecure()\u3001getContextPath()\u3001getRequestURI()\u3001getRequestURL()\u306e\u5024\u3092\u30ea\u30af\u30a8\u30b9\u30c8\u30d8\u30c3\u30c0\uff08Forwarded\u3084X-Forwarded-*\uff09\u304b\u3089\u53d6\u5f97\u3059\u308b\u3088\u3046\u306b\u3059\u308b\u305f\u3081\u306eFilter\u30af\u30e9\u30b9\u3002 \u203b Spring 4.3\u304b\u3089\u8ffd\u52a0\n\n\n\n\nHandlerInterceptor\n\nSpring MVC\u306eAPI\u3067\u3042\u308borg.springframework.web.servlet.HandlerInterceptor\u30a4\u30f3\u30bf\u30d5\u30a7\u30fc\u30b9\u3092\u5b9f\u88c5\u3057\u305f\u30af\u30e9\u30b9\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\u4f5c\u6210\u3057\u305f\u30af\u30e9\u30b9\u3092Spring MVC\u306e\u30d5\u30ec\u30fc\u30e0\u30ef\u30fc\u30af\u6a5f\u80fd\u306b\u9069\u7528\u3059\u308b\u3068\u3001Handler\u30e1\u30bd\u30c3\u30c9\u306e\u547c\u3073\u51fa\u3057\u524d\u5f8c\u306b\u4efb\u610f\u306e\u51e6\u7406\u3092\u5b9f\u884c\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\npackage com.example.component;\n\nimport org.springframework.web.servlet.HandlerInterceptor;\nimport org.springframework.web.servlet.ModelAndView;\n\nimport javax.servlet.http.HttpServletRequest;\nimport javax.servlet.http.HttpServletResponse;\n\npublic class CustomHandlerInterceptor implements HandlerInterceptor {\n\n    @Override\n    public boolean preHandle(HttpServletRequest request, HttpServletResponse response, Object handler) throws Exception {\n        // Handler\u30e1\u30bd\u30c3\u30c9\u304c\u547c\u3073\u51fa\u3055\u308c\u308b\u524d\u306b\u884c\u3046\u51e6\u7406\u3092\u5b9f\u88c5\u3059\u308b\n        // (\u5b9f\u88c5\u306f\u7701\u7565)\n\n        // Handler\u30e1\u30bd\u30c3\u30c9\u3092\u547c\u3073\u51fa\u3059\u5834\u5408\u306ftrue\u3092\u8fd4\u5374\u3059\u308b\n        return true;\n    }\n\n    @Override\n    public void postHandle(HttpServletRequest request, HttpServletResponse response, Object handler, ModelAndView modelAndView) throws Exception {\n        // Handler\u30e1\u30bd\u30c3\u30c9\u304c\u6b63\u5e38\u7d42\u4e86\u3057\u305f\u5f8c\u306b\u884c\u3046\u51e6\u7406\u3092\u5b9f\u88c5\u3059\u308b(\u4f8b\u5916\u304c\u767a\u751f\u3057\u305f\u5834\u5408\u306f\u3001\u3053\u306e\u30e1\u30bd\u30c3\u30c9\u306f\u547c\u3073\u51fa\u3055\u308c\u306a\u3044)\n        // (\u5b9f\u88c5\u306f\u7701\u7565)\n    }\n\n    @Override\n    public void afterCompletion(HttpServletRequest request, HttpServletResponse response, Object handler, Exception ex) throws Exception {\n        // Handler\u30e1\u30bd\u30c3\u30c9\u306e\u547c\u3073\u51fa\u3057\u304c\u5b8c\u4e86\u3057\u305f\u5f8c\u306b\u884c\u3046\u51e6\u7406\u3092\u5b9f\u88c5\u3059\u308b(\u4f8b\u5916\u304c\u767a\u751f\u3057\u3066\u3082\u3001\u3053\u306e\u30e1\u30bd\u30c3\u30c9\u306f\u547c\u3073\u51fa\u3055\u308c\u308b)\n        // (\u5b9f\u88c5\u306f\u7701\u7565)\n    }\n\n}\n\n\nNote: \u5197\u9577\u306a\u7a7a\u5b9f\u88c5\u306e\u6392\u9664\n\u5b9f\u969b\u306bHandlerInterceptor\u3092\u4f5c\u6210\u3059\u308b\u5834\u5408\u306f\u3001org.springframework.web.servlet.handler.HandlerInterceptorAdapter\u3092\u7d99\u627f\u3057\u3066\u5fc5\u8981\u306a\u30e1\u30bd\u30c3\u30c9\u3060\u3051\u5b9f\u88c5\u3059\u308b\u3088\u3046\u306b\u3057\u307e\u3057\u3087\u3046\u3002\npublic class CustomHandlerInterceptor extends HandlerInterceptorAdapter {\n    // \u5fc5\u8981\u306a\u30e1\u30bd\u30c3\u30c9\u3060\u3051\u30aa\u30fc\u30d0\u30fc\u30e9\u30fc\u30c9\u3057\u3066\u5b9f\u88c5\u3059\u308b\n    // ...\n}\n\n\n\u4f5c\u6210\u3057\u305fHandlerInterceptor\u3092Spring MVC\u306e\u30d5\u30ec\u30fc\u30e0\u30ef\u30fc\u30af\u6a5f\u80fd\u306b\u9069\u7528\u3057\u307e\u3059\u3002\n@Configuration\n@EnableWebMvc // \u6ce8\u610f\uff1aSpring Boot\u306e\u5834\u5408\u306f\u3001@EnableWebMvc\u306f\u3064\u3051\u3061\u3083\u30c0\u30e1\uff01\uff01\npublic class WebMvcConfig extends WebMvcConfigurerAdapter {\n    @Override\n    public void addInterceptors(InterceptorRegistry registry) {\n        registry.addInterceptor(new CustomHandlerInterceptor())\n                .addPathPatterns(\"/**\") // \u9069\u7528\u5bfe\u8c61\u306e\u30d1\u30b9(\u30d1\u30bf\u30fc\u30f3)\u3092\u6307\u5b9a\u3059\u308b\n                .excludePathPatterns(\"/static/**\"); // \u9664\u5916\u3059\u308b\u30d1\u30b9(\u30d1\u30bf\u30fc\u30f3)\u3092\u6307\u5b9a\u3059\u308b\n    }\n}\n\n\u9069\u7528\u5bfe\u8c61\u306e\u30d1\u30b9\u3084\u9664\u5916\u30d1\u30b9\u306b\u306f\u3001Ant\u5f62\u5f0f\u306e\u30d1\u30b9\u30d1\u30bf\u30fc\u30f3\u304c\u5229\u7528\u3067\u304d\u308b\u305f\u3081\u3001\u30b5\u30fc\u30d6\u30ec\u30c3\u30c8\u30d5\u30a3\u30eb\u30bf\u30fc\u306b\u6bd4\u3079\u3066\u67d4\u8edf\u306b\u51e6\u7406\u306e\u9069\u7528\u5bfe\u8c61\u3092\u6307\u5b9a\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\nWarning: Spring Boot\u3067WebMvcConfigurerAdapter\u3092\u5229\u7528\u3059\u308b\u969b\u306e\u6ce8\u610f\u70b9\nSpring Boot\u3067WebMvcConfigurerAdapter\u306e\u5b50\u30af\u30e9\u30b9\u3092\u4f5c\u6210\u3059\u308b\u5834\u5408\u306f\u3001@EnableWebMvc\u306f\u7d76\u5bfe\u306b\u3064\u3051\u306a\u3044\u3067\u304f\u3060\u3055\u3044\u3002@EnableWebMvc\u3092\u3064\u3051\u3066\u3057\u307e\u3046\u3068\u3001Spring Boot\u306eAutoConfigure\u306e\u30b3\u30f3\u30d5\u30a3\u30ae\u30e5\u30ec\u30fc\u30b7\u30e7\u30f3\u304c\u4e00\u90e8\u7121\u52b9\u306b\u306a\u3063\u3066\u3057\u307e\u3044\u307e\u3059\u3002\u3053\u308c\u306fSpring Boot\u306e\u30ea\u30d5\u30a1\u30ec\u30f3\u30b9\u306b\u3082\u8a18\u8ff0\u3055\u308c\u3066\u3044\u307e\u3059\u3002\n\n\nSpring\u63d0\u4f9b\u306eHandlerInterceptor\u306e\u5b9f\u88c5\u30af\u30e9\u30b9\nSpring MVC\u63d0\u4f9b\u306eHandlerInterceptor\u306e\u5b9f\u88c5\u30af\u30e9\u30b9\u306f\u4ee5\u4e0b\u306e\u3068\u304a\u308a\u3067\u3059\u3002\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u8981\u4ef6\u306b\u5fdc\u3058\u3066\u4f7f\u7528\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n\n\n\u30af\u30e9\u30b9\n\u8aac\u660e\n\n\n\n\nLocaleChangeInterceptor\nLocale\u3092UI\u64cd\u4f5c(\u30ea\u30af\u30a8\u30b9\u30c8\u30d1\u30e9\u30e1\u30fc\u30bf)\u3067\u5909\u66f4\u3059\u308b\u6a5f\u80fd\u3092\u5b9f\u88c5\u3059\u308b\u969b\u306b\u5229\u7528\u3059\u308b\u30af\u30e9\u30b9\u3002 LocaleResolver\u3068\u9023\u643a\u3057\u3066\u4f7f\u7528\u3057\u307e\u3059\u3002\n\n\nThemeChangeInterceptor\nTheme\u3092UI\u64cd\u4f5c(\u30ea\u30af\u30a8\u30b9\u30c8\u30d1\u30e9\u30e1\u30fc\u30bf)\u3067\u5909\u66f4\u3059\u308b\u6a5f\u80fd\u3092\u5b9f\u88c5\u3059\u308b\u969b\u306b\u4f7f\u7528\u3059\u308b\u30af\u30e9\u30b9\u3002 ThemeResolver\u3068\u9023\u643a\u3057\u3066\u4f7f\u7528\u3057\u307e\u3059\u3002\n\n\nWebContentInterceptor\n\u30ea\u30bd\u30fc\u30b9\u306e\u30d1\u30b9\u30d1\u30bf\u30fc\u30f3\u6bce\u306bHTTP\u306e\u30ad\u30e3\u30c3\u30b7\u30e5\u5236\u5fa1\u7528\u306e\u30ec\u30b9\u30dd\u30f3\u30b9\u30d8\u30c3\u30c0\u30fc\u3092\u4ed8\u4e0e\u3057\u305f\u3044\u5834\u5408\u306b\u4f7f\u7528\u3059\u308b\u30af\u30e9\u30b9\u3002\u9759\u7684\u30ea\u30bd\u30fc\u30b9\u306e\u30ad\u30e3\u30c3\u30b7\u30e5\u5236\u5fa1\u306b\u3064\u3044\u3066\u306f\u3001\u300cSpring MVC(+Spring Boot)\u4e0a\u3067\u306e\u9759\u7684\u30ea\u30bd\u30fc\u30b9\u3078\u306e\u30a2\u30af\u30bb\u30b9\u3092\u7406\u89e3\u3059\u308b\u300d\u3092\u3054\u89a7\u304f\u3060\u3055\u3044\u3002\n\n\n\n\n@ControllerAdvice\n\n@Controller(@RestController)\u3092\u4ed8\u4e0e\u3057\u305f\u30af\u30e9\u30b9\u306b\u306f\u3001Handler\u30e1\u30bd\u30c3\u30c9(@RequestMapping\u3092\u4ed8\u4e0e\u3057\u305f\u30e1\u30bd\u30c3\u30c9)\u3068\u306f\u5225\u306b\u3001Controller\u5c02\u7528\u306e\u7279\u6b8a\u306a\u30e1\u30bd\u30c3\u30c9(@InitBainder\u30e1\u30bd\u30c3\u30c9\u3001@ModelAttribute\u30e1\u30bd\u30c3\u30c9\u3001@ExceptionHandler\u30e1\u30bd\u30c3\u30c9)\u3092\u5b9f\u88c5\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\u3053\u308c\u3089\u306e\u30e1\u30bd\u30c3\u30c9\u3092\u8907\u6570\u306eController\u30af\u30e9\u30b9\u3067\u5171\u6709\u3057\u305f\u3044\u5834\u5408\u306f\u3001@ControllerAdvice\u306e\u4ed5\u7d44\u307f\u3092\u4f7f\u7528\u3057\u307e\u3059\u3002\n\n\n\n\u30e1\u30bd\u30c3\u30c9\n\u8aac\u660e\n\n\n\n\n\n@InitBinder\u30e1\u30bd\u30c3\u30c9\n\nWebDataBinder\u30aa\u30d6\u30b8\u30a7\u30af\u30c8(\u30ea\u30af\u30a8\u30b9\u30c8\u30c7\u30fc\u30bf\u3092Java\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306b\u30d0\u30a4\u30f3\u30c9\u3059\u308b\u305f\u3081\u306e\u30aa\u30d6\u30b8\u30a7\u30af\u30c8)\u3092\u30ab\u30b9\u30bf\u30de\u30a4\u30ba\u3059\u308b\u305f\u3081\u306e\u30e1\u30bd\u30c3\u30c9\u3002\u578b\u5909\u63db\u3001\u30d5\u30a9\u30fc\u30de\u30c3\u30c6\u30a3\u30f3\u30b0\u3001\u30d0\u30ea\u30c7\u30fc\u30b7\u30e7\u30f3\u306a\u3069\u3092\u30ab\u30b9\u30bf\u30de\u30a4\u30ba\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n\n\n@ModelAttribute\u30e1\u30bd\u30c3\u30c9\n\nModel\u306b\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u683c\u7d0d\u3059\u308b\u305f\u3081\u306e\u30e1\u30bd\u30c3\u30c9\u3002Handler\u30e1\u30bd\u30c3\u30c9\u5b9f\u884c\u524d\u306b\u547c\u3073\u51fa\u3055\u308c\u3001\u8fd4\u5374\u3057\u305f\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306fModel\u306b\u683c\u7d0d\u3055\u308c\u307e\u3059\u3002\n\n\n\n@ExceptionHandler\u30e1\u30bd\u30c3\u30c9\n\u4f8b\u5916\u3092\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0\u3059\u308b\u305f\u3081\u306e\u30e1\u30bd\u30c3\u30c9\u3002\n\n\n\n\npackage com.example.component;\n\nimport org.slf4j.Logger;\nimport org.slf4j.LoggerFactory;\nimport org.springframework.beans.propertyeditors.StringTrimmerEditor;\nimport org.springframework.http.HttpStatus;\nimport org.springframework.web.bind.WebDataBinder;\nimport org.springframework.web.bind.annotation.*;\n\nimport java.util.Optional;\nimport java.util.UUID;\n\n@ControllerAdvice // \u30af\u30e9\u30b9\u30ec\u30d9\u30eb\u306b@ControllerAdvice\u3092\u6307\u5b9a\u3059\u308b\npublic class CustomControllerAdvice {\n\n    private static final Logger logger = LoggerFactory.getLogger(CustomControllerAdvice.class);\n\n    @InitBinder\n    public void initBinder(WebDataBinder dataBinder) {\n        // WebDataBinder\u306e\u30e1\u30bd\u30c3\u30c9\u3092\u547c\u3073\u51fa\u3057\u3066\u30ab\u30b9\u30bf\u30de\u30a4\u30ba\u3059\u308b\n        dataBinder.registerCustomEditor(String.class, new StringTrimmerEditor(true));\n    }\n\n    @ModelAttribute(\"trackingId\")\n    public String addOneObject(@RequestHeader(\"X-Tracking-Id\") Optional<String> trackingId) {\n        // Model\u306b\u8ffd\u52a0\u3059\u308b\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u8fd4\u5374\u3059\u308b\n        return trackingId.orElse(UUID.randomUUID().toString());\n    }\n\n    @ExceptionHandler\n    @ResponseStatus(HttpStatus.INTERNAL_SERVER_ERROR)\n    public String handleSystemException(Exception e) {\n        // \u4f8b\u5916\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0\u3092\u884c\u3046\n        logger.error(\"System Error occurred.\", e);\n        return \"error/system\";\n    }\n\n}\n\n@ControllerAdvice\u306e\u5c5e\u6027\u3092\u3059\u3079\u3066\u7701\u7565\u3057\u305f\u5834\u5408\u306f\u3001\u3059\u3079\u3066\u306eController\u30af\u30e9\u30b9\u306b\u9069\u7528\u3055\u308c\u307e\u3059\u3002\u9069\u7528\u5bfe\u8c61\u3092\u7d5e\u308a\u8fbc\u307f\u305f\u3044\u5834\u5408\u306f\u3001\u300c\u30d9\u30fc\u30b9\u30d1\u30c3\u30b1\u30fc\u30b8(basePackages\u3001basePackageClasses\u5c5e\u6027)\u300d\u300c\u30de\u30fc\u30ab\u30fc\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9(assignableTypes\u5c5e\u6027)\u300d\u300c\u30de\u30fc\u30ab\u30fc\u30a2\u30ce\u30c6\u30fc\u30b7\u30e7\u30f3(annotations\u5c5e\u6027)\u300d\u3092\u4f7f\u7528\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\nNote: @ModelAttribute\u30e1\u30bd\u30c3\u30c9\u306e\u30b7\u30b0\u30cd\u30c1\u30e3\n@ModelAttribute\u30e1\u30bd\u30c3\u30c9\u306e\u8fd4\u308a\u5024\u3092void\u306b\u3057\u3001\u5f15\u6570\u3067\u53d7\u3051\u53d6\u3063\u305fModel\u306b\u76f4\u63a5\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u8ffd\u52a0\u3059\u308b\u3053\u3068\u3082\u3067\u304d\u307e\u3059\u3002\u3053\u308c\u306f\u3001\u3072\u3068\u3064\u306e\u30e1\u30bd\u30c3\u30c9\u3067\u8907\u6570\u306e\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092Model\u306b\u8ffd\u52a0\u3057\u305f\u3044\u5834\u5408\u306b\u4f7f\u3048\u307e\u3059\u3002\n@ModelAttribute\npublic void addSomeObjects(@RequestHeader(\"X-Tracking-Id\") Optional<String> trackingId, Model model) {\n    // Model\u306b\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u8ffd\u52a0\u3059\u308b\n    model.addAttribute(\"trackingId\", trackingId.orElse(UUID.randomUUID().toString()));\n    // ...\n}\n\n\n\nSpring AOP with AspectJ\nSpring\u306eDI\u30b3\u30f3\u30c6\u30ca\u3067\u7ba1\u7406\u3055\u308c\u3066\u3044\u308bBean\u306epublic\u30e1\u30bd\u30c3\u30c9\u306e\u547c\u3073\u51fa\u3057\u524d\u5f8c\u306b\u5171\u901a\u51e6\u7406\u3092\u5b9f\u884c\u3057\u305f\u3044\u5834\u5408\u306f\u3001Spring AOP\u306eAdvice\u3092\u5b9f\u88c5\u3057\u307e\u3059\u3002Spring AOP\u3067\u5b9f\u88c5\u3067\u304d\u308bAdvice\u306f\u4ee5\u4e0b\u306e5\u7a2e\u985e\u3067\u3059\u3002\n\nNote: Advice\u3068\u306f\nJoin Point\u306b\u5bfe\u3057\u3066\u7279\u5b9a\u306e\u30bf\u30a4\u30df\u30f3\u30b0\u3067\u5b9f\u884c\u3059\u308b\u6a2a\u65ad\u7684\u306a\u95a2\u5fc3\u4e8b(\u5171\u901a\u51e6\u7406)\u306e\u3053\u3068\u3067\u3059\u3002 \nNote: Join Point\u3068\u306f\n\u6a2a\u65ad\u7684\u306a\u95a2\u5fc3\u4e8b(\u5171\u901a\u51e6\u7406)\u3092\u9069\u7528\u3059\u308b\u30dd\u30a4\u30f3\u30c8\u306e\u3053\u3068\u3067\u3059\u3002 Spring AOP\u306eJoin Point\u306f\u300c\u30e1\u30bd\u30c3\u30c9\u306e\u5b9f\u884c\u6642\u300d\u3067\u3059\u3002\n\n\n\n\nAdvice\n\u8aac\u660e\n\n\n\n\nBefore\nJoin Point\u306e\u524d\u306b\u5b9f\u884c\u3059\u308bAdvice\u3002Join Point\u3078\u51e6\u7406\u304c\u6d41\u308c\u306a\u3044\u3088\u3046\u306b\u3057\u305f\u3044\u5834\u5408\u306f\u3001\u4f8b\u5916\u306e\u30b9\u30ed\u30fc\u3057\u307e\u3059\u3002\n\n\nAfterReturning\nJoin Point\u304c\u6b63\u5e38\u7d42\u4e86\u3057\u305f\u5f8c\u306b\u5b9f\u884c\u3059\u308bAdvice\u3002Join Point\u3067\u4f8b\u5916\u304c\u767a\u751f\u3057\u305f\u5834\u5408\u306f\u3001\u3053\u306eAdvice\u306f\u5b9f\u884c\u3055\u308c\u307e\u305b\u3093\u3002\n\n\nAfterThrowing\nJoin Point\u304b\u3089\u4f8b\u5916\u304c\u30b9\u30ed\u30fc\u3055\u308c\u305f\u5f8c\u306b\u5b9f\u884c\u3059\u308bAdvice\u3002Join Point\u304c\u6b63\u5e38\u7d42\u4e86\u3057\u305f\u5834\u5408\u306f\u3001\u3053\u306eAdvice\u306f\u5b9f\u884c\u3055\u308c\u307e\u305b\u3093\u3002\n\n\nAfter\nJoin Point\u306e\u5f8c\u306b\u5b9f\u884c\u3059\u308bAdvice\u3002Join Point\u306e\u6b63\u5e38\u7d42\u4e86\u3084\u4f8b\u5916\u306e\u30b9\u30ed\u30fc\u306b\u95a2\u4fc2\u306a\u304f\u5e38\u306b\u5b9f\u884c\u3055\u308c\u307e\u3059\u3002\n\n\nAround\nJoin Point\u306e\u524d\u5f8c\u3067\u5b9f\u884c\u3059\u308bAdvice\u3002\u5171\u901a\u51e6\u7406\u3092\u5b9f\u884c\u3059\u308b\u30bf\u30a4\u30df\u30f3\u30b0\u306a\u3069\u3092\u5b8c\u5168\u306b\u30b3\u30f3\u30c8\u30ed\u30fc\u30eb\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n\n\n\u5404Advice\u304c\u5b9f\u884c\u3055\u308c\u308b\u30bf\u30a4\u30df\u30f3\u30b0\u3092\u56f3\u3067\u8868\u3059\u3068\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\n\nAround Advice\u3092\u4f7f\u3046\u3068Before, AfterReturning, AfterThrowing, After\u3068\u540c\u3058\u3053\u3068\u3092\u5b9f\u73fe\u3067\u304d\u307e\u3059\u304c\u3001\u7528\u9014\u306b\u3042\u3063\u305fAdvice\u3092\u4f7f\u3046\u3088\u3046\u306b\u3057\u307e\u3057\u3087\u3046\u3002\n\nSpring AOP\u3068\u306f\nSpring Framework\u306f\u3001AOP\u3092\u5b9f\u73fe\u3059\u308b\u30b5\u30d6\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3068\u3057\u3066Spring AOP\u3092\u63d0\u4f9b\u3057\u3066\u3044\u307e\u3059\u3002 Spring AOP\u3067\u306f\u3001DI\u30b3\u30f3\u30c6\u30ca\u306b\u7ba1\u7406\u3055\u308c\u3066\u3044\u308bBean\u3092Target\u3068\u3057\u3066Advice\u3092\u57cb\u3081\u8fbc\u3080\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002Spring AOP\u306f\u3001\u6700\u3082\u6709\u540d\u306aAOP\u30d5\u30ec\u30fc\u30e0\u30ef\u30fc\u30af\u3067\u3042\u308bAspectJ\u3092\u5229\u7528\u3057\u3066\u304a\u308a\u3001AspectJ\u304c\u63d0\u4f9b\u3059\u308b\u30a2\u30ce\u30c6\u30fc\u30b7\u30e7\u30f3\u3084PointCut\u306e\u5f0f\u8a00\u8a9e\u3092\u5229\u7528\u3057\u3066\u3044\u307e\u3059\u3002\n\nNote: PointCut\u3068\u306f\nAdvice\u3092\u5b9f\u884c\u3059\u308bJoin Point\u3092\u9078\u629e\u3059\u308b\u8868\u73fe(\u5f0f)\u306e\u3053\u3068\u3067\u3059\u3002\nNote: Weaving\u3068\u306f\n\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u30b3\u30fc\u30c9\u306e\u9069\u5207\u306a\u30dd\u30a4\u30f3\u30c8\u306bAspect\u3092\u5165\u308c\u8fbc\u3080\u51e6\u7406\u306e\u3053\u3068\u3067\u3059\u3002AspectJ\u3067\u306fWeaving\u306e\u30e1\u30ab\u30cb\u30ba\u30e0\u3068\u3057\u3066\u3001\u30b3\u30f3\u30d1\u30a4\u30eb\u6642\u3001\u30af\u30e9\u30b9\u30ed\u30fc\u30c9\u6642\u3001\u5b9f\u884c\u6642\u304c\u30b5\u30dd\u30fc\u30c8\u3055\u308c\u3066\u3044\u307e\u3059\u304c\u3001 Spring AOP\u3067\u306fProxy\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u4f5c\u308b\u3053\u3068\u3067\u5b9f\u884c\u6642\u306eWeaving\u306e\u307f\u30b5\u30dd\u30fc\u30c8\u3057\u3066\u3044\u307e\u3059\u3002\n\n\n\nSpring AOP\u306e\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\nSpring AOP\u3092\u4f7f\u7528\u3059\u308b\u5834\u5408\u306f\u3001spring-aop\u30e2\u30b8\u30e5\u30fc\u30eb\u3068aspectjweaver\u304c\u5fc5\u8981\u306b\u306a\u308a\u307e\u3059\u3002\n\npom.xml\n<dependency>\n    <groupId>org.springframework</groupId>\n    <artifactId>spring-aop</artifactId>\n    <version>4.3.3.RELESAE</version> <!-- \u6295\u7a3f\u6642\u306e\u6700\u65b0\u30d0\u30fc\u30b8\u30e7\u30f3 -->\n</dependency>\n<dependency>\n    <groupId>org.aspectj</groupId>\n    <artifactId>aspectjweaver</artifactId>\n    <version>1.8.9</version> <!-- \u6295\u7a3f\u6642\u306e\u6700\u65b0\u30d0\u30fc\u30b8\u30e7\u30f3 -->\n</dependency>\n\n\nSpring AOP\u3092\u4f7f\u7528\u3059\u308b\u305f\u3081\u306b\u5fc5\u8981\u3068\u306a\u308bBean\u3092\u5b9a\u7fa9\u3057\u307e\u3059\u3002Java Config\u306e\u5834\u5408\u306f\u3001\u30b3\u30f3\u30d5\u30a3\u30ae\u30e5\u30ec\u30fc\u30b7\u30e7\u30f3\u30af\u30e9\u30b9\u306b@org.springframework.context.annotation.EnableAspectJAutoProxy\u3092\u4ed8\u4e0e\u3059\u308b\u3060\u3051\u3067\u3059\u3002\n@Configuration\n@ComponentScan(\"com.example.component\")\n@EnableAspectJAutoProxy\npublic class AppConfig {\n    // ...\n}\n\nSpring AOP\u306fProxy\u3092\u751f\u6210\u3057\u3066Aspect\u3092Weaving\u3057\u307e\u3059\u304c\u3001\u5bfe\u8c61\u3068\u306a\u308b\u30af\u30e9\u30b9\u306e\u72b6\u614b\u306b\u3088\u3063\u3066Proxy\u751f\u6210\u306b\u4f7f\u7528\u3055\u308c\u308b\u4ed5\u7d44\u307f\u304c\u7570\u306a\u308a\u307e\u3059\u3002\n\n\u5bfe\u8c61\u304c\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9\u3092\u5b9f\u88c5\u3057\u3066\u3044\u308c\u3070JDK\u306eProxy\u306e\u4ed5\u7d44\u307f\n\u5bfe\u8c61\u304c\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9\u3092\u5b9f\u88c5\u3057\u3066\u3044\u306a\u3051\u308c\u3070CGLIB\u306eProxy\u306e\u4ed5\u7d44\u307f\n\nCGLIB\u306e\u4ed5\u7d44\u307f\u3092\u4f7f\u3063\u3066Proxy\u3092\u4f5c\u308b\u3053\u3068\u3092\u5f37\u5236\u3057\u305f\u3044\u5834\u5408\u306f\u3001proxyTargetClass\u5c5e\u6027\u3092true\u306b\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n// ...\n@EnableAspectJAutoProxy(proxyTargetClass = true)\npublic class AppConfig {\n    // ...\n}\n\n\n\u5bfe\u8c61\u30af\u30e9\u30b9\u306e\u4f5c\u6210\n\u307e\u305a\u3001Advice\u3092\u57cb\u3081\u8fbc\u3080\u5bfe\u8c61\u3068\u306a\u308b\u30af\u30e9\u30b9\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\u3053\u3053\u3067\u306f\u3001\u6b63\u5e38\u7d42\u4e86\u3059\u308b\u30e1\u30bd\u30c3\u30c9\u3068\u4f8b\u5916\u304c\u767a\u751f\u3059\u308b\uff12\u3064\u306e\u30e1\u30bd\u30c3\u30c9\u3092\u5b9f\u88c5\u3057\u3066\u3044\u307e\u3059\u3002\npackage com.example.component;\n\nimport org.springframework.stereotype.Service;\n\n@Service\npublic class GreetingService {\n\n    public void goodMorning() {\n        System.out.println(\"Good Morning !!\");\n    }\n\n    public void failing() {\n        System.out.println(\"Failing !!\");\n        throw new UnsupportedOperationException();\n    }\n\n}\n\n\u3064\u304e\u306b\u3001\u52d5\u4f5c\u78ba\u8a8d\u7528\u306bJUnit\u306e\u30c6\u30b9\u30c8\u30b1\u30fc\u30b9\u30af\u30e9\u30b9\u3068\u30c6\u30b9\u30c8\u30e1\u30bd\u30c3\u30c9\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\u3053\u3053\u3067\u306f\u3001Spring\u306eDI\u30b3\u30f3\u30c6\u30ca\u3068\u9023\u643a\u3059\u308b\u5fc5\u8981\u304c\u3042\u308b\u305f\u3081\u3001Spring Test\u304c\u63d0\u4f9b\u3057\u3066\u3044\u308bDI\u30b3\u30f3\u30c6\u30ca\u3068\u9023\u643a\u3059\u308b\u4ed5\u7d44\u307f\u3092\u5229\u7528\u3057\u307e\u3059\u3002\npackage com.example.component;\n\nimport org.junit.Test;\nimport org.junit.runner.RunWith;\nimport org.springframework.beans.factory.annotation.Autowired;\nimport org.springframework.test.context.ContextConfiguration;\nimport org.springframework.test.context.junit4.SpringRunner;\nimport springbook.component.GreetingService;\nimport springbook.config.AppConfig;\n\n@RunWith(SpringRunner.class)\n@ContextConfiguration(classes = AppConfig.class)\npublic class GreetingServiceTest {\n\n    @Autowired\n    GreetingService greetingService;\n\n    @Test\n    public void goodMorning() {\n        greetingService.goodMorning();\n    }\n\n    @Test(expected = UnsupportedOperationException.class)\n    public void failing() {\n        greetingService.failing();\n    }\n\n}\n\n\u30c6\u30b9\u30c8\u30b1\u30fc\u30b9\u3092\u5b9f\u884c\u3059\u308b\u3068\u3001\u30b3\u30f3\u30bd\u30fc\u30eb\u306b\u4ee5\u4e0b\u306e\u5185\u5bb9\u304c\u8868\u793a\u3055\u308c\u307e\u3059\u3002\n\n\u30b3\u30f3\u30bd\u30fc\u30eb\nGood Morning !!\nFailing !!\n\n\n\u306a\u304a\u3001\u4e0a\u8a18\u306e\u30b3\u30fc\u30c9\u3092\u30b3\u30f3\u30d1\u30a4\u30eb\u3059\u308b\u305f\u3081\u306b\u306f\u3001\u4ee5\u4e0b\u306e\u30a2\u30fc\u30c6\u30a3\u30d5\u30a1\u30af\u30c8\u3092\u4f9d\u5b58\u30e9\u30a4\u30d6\u30e9\u30ea\u306b\u8ffd\u52a0\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\n\npom.xml\n<dependency>\n    <groupId>junit</groupId>\n    <artifactId>junit</artifactId>\n    <version>4.12</version> <!-- \u6295\u7a3f\u6642\u306e\u6700\u65b0\u30d0\u30fc\u30b8\u30e7\u30f3 -->\n    <scope>test</scope>\n</dependency>\n<dependency>\n    <groupId>org.springframework</groupId>\n    <artifactId>spring-test</artifactId>\n    <version>4.3.3.RELEASE</version> <!-- \u6295\u7a3f\u6642\u306e\u6700\u65b0\u30d0\u30fc\u30b8\u30e7\u30f3 -->\n    <scope>test</scope>\n</dependency>\n\n\n\nAspect\u30af\u30e9\u30b9\u306e\u4f5c\u6210\nAspect\u306f\u3001AOP\u306e\u5358\u4f4d\u3068\u306a\u308b\u6a2a\u65ad\u7684\u306a\u95a2\u5fc3\u4e8b\u3092\u793a\u3059\u30e2\u30b8\u30e5\u30fc\u30eb\u306e\u3053\u3068\u3067\u3059\u3002Spring AOP\u3067\u306f\u3001AspectJ\u306e@org.aspectj.lang.annotation.Aspect\u304c\u4ed8\u4e0e\u3055\u308c\u305f\u30af\u30e9\u30b9\u304cAspect\u3068\u3057\u3066\u8a8d\u8b58\u3055\u308c\u307e\u3059\u3002\npackage com.example.component;\n\nimport org.aspectj.lang.annotation.Aspect;\nimport org.springframework.stereotype.Component;\n\n@Component\n@Aspect\npublic class LoggingAspect {\n}\n\n\nBefore Advice\u306e\u5b9f\u88c5\nBefore Advice\u306f\u3001@org.aspectj.lang.annotation.Before\u3092\u4ed8\u4e0e\u3057\u305f\u30e1\u30bd\u30c3\u30c9\u306b\u5b9f\u88c5\u3057\u307e\u3059\u3002\n@Before(\"execution(* *..*Service.*(..))\")\npublic void startLog(JoinPoint jp) {\n    System.out.println(\"@Before                   : \" + jp.getSignature());\n}\n\n\n\u30b3\u30f3\u30bd\u30fc\u30eb\n@Before                   : void springbook.component.GreetingService.goodMorning()\nGood Morning !!\nFailing !!\n\n\n\nAfterReturning Advice\u306e\u5b9f\u88c5\nAfterReturning Advice\u306f\u3001@org.aspectj.lang.annotation.AfterReturning\u3092\u4ed8\u4e0e\u3057\u305f\u30e1\u30bd\u30c3\u30c9\u306b\u5b9f\u88c5\u3057\u307e\u3059\u3002\n@AfterReturning(value = \"execution(* *..*Service.*(..))\", returning = \"ret\")\npublic void normalEndLog(JoinPoint jp, Object ret) {\n    System.out.println(\"@AfterReturning           : \" + jp.getSignature() + \" ret: \" + ret);\n}\n\n\n\u30b3\u30f3\u30bd\u30fc\u30eb\nGood Morning !!\n@AfterReturning           : void springbook.component.GreetingService.goodMorning() ret: null\nFailing !!\n\n\n\nAfterThrowing Advice\u306e\u5b9f\u88c5\nAfterThrowing Advice\u306f\u3001@org.aspectj.lang.annotation.AfterThrowing\u3092\u4ed8\u4e0e\u3057\u305f\u30e1\u30bd\u30c3\u30c9\u306b\u5b9f\u88c5\u3057\u307e\u3059\u3002\n@AfterThrowing(value = \"execution(* *..*Service.*(..))\", throwing = \"t\")\npublic void failureEndLog(JoinPoint jp, Throwable t) {\n    System.out.println(\"@AfterThrowing            : \" + jp.getSignature() + \" t: \" + t);\n}\n\n\n\u30b3\u30f3\u30bd\u30fc\u30eb\nFailing !!\n@AfterThrowing            : void springbook.component.GreetingService.failing() t: java.lang.UnsupportedOperationException\n\n\n\nAfter Advice\u306e\u5b9f\u88c5\nBefore Advice\u306f\u3001@org.aspectj.lang.annotation.After\u3092\u4ed8\u4e0e\u3057\u305f\u30e1\u30bd\u30c3\u30c9\u306b\u5b9f\u88c5\u3057\u307e\u3059\u3002\n@After(\"execution(* *..*Service.*(..))\")\npublic void completeLog(JoinPoint jp) {\n    System.out.println(\"@After                    : \" + jp.getSignature());\n}\n\n\n\u30b3\u30f3\u30bd\u30fc\u30eb\nGood Morning !!\n@After                    : void springbook.component.GreetingService.goodMorning()\nFailing !!\n@AfterThrowing            : void springbook.component.GreetingService.failing() t: java.lang.UnsupportedOperationException\n\n\n\nAround Advice\nAround Advice\u306f\u3001@org.aspectj.lang.annotation.Around\u3092\u4ed8\u4e0e\u3057\u305f\u30e1\u30bd\u30c3\u30c9\u306b\u5b9f\u88c5\u3057\u307e\u3059\u3002\n@Around(\"execution(* *..*Service.*(..))\")\npublic Object aroundLog(ProceedingJoinPoint jp) throws Throwable {\n    Object ret;\n    try {\n        System.out.println(\"Before by @Around         : \" + jp.getSignature());\n        ret = jp.proceed();\n        System.out.println(\"AfterReturning by @Around : \" + jp.getSignature() + \" ret: \" + ret);\n    }catch (Throwable t) {\n        System.out.println(\"AfterThrowing by @Around  : \" + jp.getSignature() + \" t: \" + t);\n        throw t;\n    } finally {\n        System.out.println(\"After by @Around          : \" + jp.getSignature());\n    }\n    return ret;\n}\n\n\n\u30b3\u30f3\u30bd\u30fc\u30eb(\u6b63\u5e38\u6642)\nBefore by @Around         : void springbook.component.GreetingService.goodMorning()\nGood Morning !!\nAfterReturning by @Around : void springbook.component.GreetingService.goodMorning() ret: null\nAfter by @Around          : void springbook.component.GreetingService.goodMorning()\n\n\n\n\u30b3\u30f3\u30bd\u30fc\u30eb(\u4f8b\u5916\u767a\u751f\u6642)\nBefore by @Around         : void springbook.component.GreetingService.failing()\nFailing !!\nAfterThrowing by @Around  : void springbook.component.GreetingService.failing() t: java.lang.UnsupportedOperationException\nAfter by @Around          : void springbook.component.GreetingService.failing()\n\n\n\nPointCut\u5f0f\nPointCut\u5f0f\u306f\u3001Join Point\u3092\u9078\u629e\u3059\u308b\u8868\u73fe\u306e\u3053\u3068\u3067\u3001\u4e0a\u8a18\u306e\u4f8b\u3060\u3068\u30a2\u30ce\u30c6\u30fc\u30b7\u30e7\u30f3\u306evalue\u5c5e\u6027\u306b\u6307\u5b9a\u3057\u3066\u3044\u308b\u300c\"execution(* *..*Service.*(..))\"\u300d\u304cPointCut\u5f0f\u306b\u306a\u308a\u307e\u3059\u3002AspectJ\u3067\u306f\u69d8\u3005\u306a\u5f0f\u3092\u7528\u3044\u3066JoinPoint\u3092\u9078\u629e\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u3001Spring AOP\u3067\u3082AspectJ\u306ePointCut\u5f0f\u306e\u591a\u304f\u3092\u30b5\u30dd\u30fc\u30c8\u3057\u3066\u3044\u307e\u3059\u3002\nPointCut\u5f0f\u306b\u306f\u3001\u30de\u30c3\u30c1\u30f3\u30b0\u65b9\u6cd5\u6bce\u306b\u6307\u793a\u5b50(designator)\u304c\u7528\u610f\u3055\u308c\u3066\u304a\u308a\u3001\u305d\u308c\u305e\u308c\u66f8\u5f0f\u304c\u7570\u306a\u308a\u307e\u3059\u3002 \nSpring AOP\u3067\u30b5\u30dd\u30fc\u30c8\u3055\u308c\u3066\u3044\u308b\u6307\u793a\u5b50\u306f\u4ee5\u4e0b\u306e\u3068\u304a\u308a\u3067\u3059\u3002\n\n\n\n\u6307\u793a\u5b50\n\u8aac\u660e\n\n\n\n\nexecution\n\u6307\u5b9a\u3057\u305f\u30e1\u30bd\u30c3\u30c9(\u30d1\u30bf\u30fc\u30f3)\u306b\u4e00\u81f4\u3059\u308b\u30e1\u30bd\u30c3\u30c9\u3092JoinPoint\u3068\u3057\u3066\u9078\u629e\u3059\u308b\u3002\n\n\nwithin\n\u6307\u5b9a\u3057\u305f\u30af\u30e9\u30b9(\u30d1\u30bf\u30fc\u30f3)\u306b\u4e00\u81f4\u3059\u308bBean\u304c\u4fdd\u6301\u3059\u308b\u30e1\u30bd\u30c3\u30c9\u3092JoinPoint\u3068\u3057\u3066\u9078\u629e\u3059\u308b\u3002\n\n\nthis\n\u6307\u5b9a\u3057\u305f\u30bf\u30a4\u30d7(\u30af\u30e9\u30b9\u3001\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9)\u306b\u4e00\u81f4\u3059\u308bBean\u3078\u306eProxy\u304c\u4fdd\u6301\u3059\u308b\u30e1\u30bd\u30c3\u30c9\u3092JoinPoint\u3068\u3057\u3066\u9078\u629e\u3059\u308b\u3002\n\n\ntarget\n\u6307\u5b9a\u3057\u305f\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9(\u30af\u30e9\u30b9\u3001\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9)\u306b\u4e00\u81f4\u3059\u308bBean\u304c\u4fdd\u6301\u3059\u308b\u30e1\u30bd\u30c3\u30c9\u3092JoinPoint\u3068\u3057\u3066\u9078\u629e\u3059\u308b\u3002\n\n\nargs\n\u6307\u5b9a\u3057\u305f\u30bf\u30a4\u30d7\u304c\u5f15\u6570\u306b\u5ba3\u8a00\u3055\u308c\u3066\u3044\u308b\u30e1\u30bd\u30c3\u30c9\u3092JoinPoint\u3068\u3057\u3066\u9078\u629e\u3059\u308b\u3002\n\n\n@within\n\u6307\u5b9a\u3057\u305f\u30a2\u30ce\u30c6\u30fc\u30b7\u30e7\u30f3\u304c\u4ed8\u4e0e\u3055\u308c\u305f\u30af\u30e9\u30b9\u304c\u4fdd\u6301\u3059\u308b\u30e1\u30bd\u30c3\u30c9\u3092JoinPoint\u3068\u3057\u3066\u9078\u629e\u3059\u308b\u3002\n\n\n@annotation\n\u6307\u5b9a\u3057\u305f\u30a2\u30ce\u30c6\u30fc\u30b7\u30e7\u30f3\u304c\u30e1\u30bd\u30c3\u30c9\u306b\u4ed8\u4e0e\u3055\u308c\u3066\u3044\u308b\u30e1\u30bd\u30c3\u30c9\u3092JoinPoint\u3068\u3057\u3066\u9078\u629e\u3059\u308b\u3002\n\n\n@args\n\u6307\u5b9a\u3057\u305f\u30a2\u30ce\u30c6\u30fc\u30b7\u30e7\u30f3\u3092\u4fdd\u6301\u3059\u308b\u30bf\u30a4\u30d7\u304c\u5f15\u6570\u306b\u5ba3\u8a00\u3055\u308c\u3066\u3044\u308b\u30e1\u30bd\u30c3\u30c9\u3092JoinPoint\u3068\u3057\u3066\u9078\u629e\u3059\u308b\u3002\n\n\nbean\n\u6307\u5b9a\u3057\u305fbean\u540d\u306b\u4e00\u81f4\u3059\u308bBean\u304c\u4fdd\u6301\u3059\u308b\u30e1\u30bd\u30c3\u30c9\u3092JoinPoint\u3068\u3057\u3066\u9078\u629e\u3059\u308b\u3002 Spring AOP\u306e\u307f\u3067\u4f7f\u7528\u3067\u304d\u308b\u6307\u793a\u5b50\u3002\n\n\n\n\u5404\u6307\u793a\u5b50\u306e\u66f8\u5f0f\u3084\u6307\u5b9a\u4f8b\u306f\u3001 Spring Framework\u306e\u516c\u5f0f\u30ea\u30d5\u30a1\u30ec\u30f3\u30b9\u3092\u53c2\u7167\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\nSpring Boot\u4e0a\u3067\u306e\u5171\u901a\u51e6\u7406\u306e\u5b9f\u88c5\n\u3053\u3053\u3067\u306f\u3001Spring Boot Starter Web\u3092\u30d9\u30fc\u30b9\u306b\u3001Spring Boot\u56fa\u6709\u306e\u4ed5\u7d44\u307f\u3084\u5b9f\u88c5\u65b9\u6cd5\u306b\u3064\u3044\u3066\u8aac\u660e\u3057\u307e\u3059\u3002\nSpring Boot\u306f\u3001Spring-Boot\u5411\u3051\u306e\u958b\u767a\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092\u751f\u6210\u3059\u308b\u305f\u3081\u306eWeb Service\u300cSPRING INITIALIZR\u300d\u3092\u63d0\u4f9b\u3057\u3066\u3044\u307e\u3059\u3002\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306e\u4f5c\u6210\u65b9\u6cd5\u306f\u3001\u3053\u3061\u3089\u3092\u3054\u89a7\u304f\u3060\u3055\u3044(\u306a\u304a\u3001Dependencies\u306f\u300cWeb\u300d\u306b\u3001\u30d0\u30fc\u30b8\u30e7\u30f3\u306f\u6700\u65b0\u30d0\u30fc\u30b8\u30e7\u30f3\u306b\u8aad\u307f\u66ff\u3048\u3066\u304f\u3060\u3055\u3044)\u3002\n\njavax.servlet.ServletRequestListener\n\n\nSpring\u30843rd\u30d1\u30fc\u30c6\u30a3\u88fd\u306eServletRequestListener\u306e\u767b\u9332\nBean\u5b9a\u7fa9\u30d5\u30a1\u30a4\u30eb\u3092\u4f7f\u7528\u3057\u3066DI\u30b3\u30f3\u30c6\u30ca\u306b\u767b\u9332\u3057\u307e\u3059\u3002\n@Bean\npublic RequestContextListener requestContextListener(){\n    return new RequestContextListener();\n}\n\n3rd\u30d1\u30fc\u30c6\u30a3\u88fd\u306eServletRequestListener\u306b@javax.servlet.annotation.WebListener\u304c\u4ed8\u4e0e\u3055\u308c\u3066\u3044\u308b\u5834\u5408\u306f\u3001@org.springframework.boot.web.servlet.ServletComponentScan\u3092\u4f7f\u7528\u3059\u308b\u3053\u3068\u3082\u3067\u304d\u307e\u3059\u3002\n@SpringBootApplication\n@ServletComponentScan\npublic class WebDemoApplication {\n   // ....\n}\n\n\n\u81ea\u4f5c\u306eServletRequestListener\u306e\u767b\u9332\n@Component\u3092\u4ed8\u4e0e\u3057\u305fServletRequestListener\u30af\u30e9\u30b9\u3092\u4f5c\u6210\u3059\u308b\u306e\u304c\u4e00\u756a\u7c21\u5358\u3067\u3057\u3087\u3046\u3002\u9069\u7528\u9806\u5e8f\u3082@org.springframework.core.annotation.Order\u3067\u6307\u5b9a\u3067\u304d\u307e\u3059(\u3082\u3057\u304f\u306f\u3001org.springframework.core.Ordered\u30a4\u30f3\u30bf\u30d5\u30a7\u30fc\u30b9\u3092\u5b9f\u88c5\u3057\u3066\u6307\u5b9a\u3059\u308b)\u3002\n@Component\n@Order(Ordered.HIGHEST_PRECEDENCE) // \u5fc5\u8981\u306b\u5fdc\u3058\u3066\u512a\u5148\u5ea6\u3092\u6307\u5b9a\u3002\u512a\u5148\u5ea6\u304c\u9ad8\u3044\u65b9\u304c\u5148\u306b\u9069\u7528\u3055\u308c\u308b\u3002\npublic class CustomServletRequestListener implements ServletRequestListener {\n    // ...\n}\n\n\u3082\u3061\u308d\u3093@Bean\u3084@ServletComponentScan\u3092\u4f7f\u7528\u3057\u3066DI\u30b3\u30f3\u30c6\u30ca\u306b\u767b\u9332\u3059\u308b\u3053\u3068\u3082\u3067\u304d\u307e\u3059\u3002\n\njavax.servlet.Filter\n\n\nSpring Boot\u63d0\u4f9b\u306eFilter\u30af\u30e9\u30b9\nSpring Boot\u63d0\u4f9b\u306eFilter\u30af\u30e9\u30b9\u306f\u4ee5\u4e0b\u306e\u3068\u304a\u308a\u3067\u3059\u3002\u306a\u304a\u3001\u9069\u7528\u9806\u5e8f\u3092\u5f37\u5236\u3059\u308b\u305f\u3081\u3060\u3051\u306b\u62e1\u5f35\u3057\u3066\u3044\u308bOrderedXxxFilter\u306e\u7d39\u4ecb\u306f\u5272\u611b\u3057\u307e\u3059\u3002\n\n\n\n\u30af\u30e9\u30b9\n\u8aac\u660e\n\n\n\n\nApplicationContextHeaderFilter\n\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u30b3\u30f3\u30c6\u30ad\u30b9\u30c8\u306eID(ApplicationContext#getId())\u3092\u30ec\u30b9\u30dd\u30f3\u30b9\u30d8\u30c3\u30c0(X-Application-Context)\u306b\u51fa\u529b\u3059\u308b\u305f\u3081\u306eFilter\u30af\u30e9\u30b9\u3002 \u203b Spring Boot 1.4\u304b\u3089\u8ffd\u52a0\n\n\n\n\n\u81ea\u52d5\u767b\u9332\u3055\u308c\u308bjavax.servlet.Filter\n\nSpring Boot\u306f\u3001\u81ea\u52d5\u30b3\u30f3\u30d5\u30a3\u30ae\u30e5\u30ec\u30fc\u30b7\u30e7\u30f3\u306b\u3088\u3063\u3066\u4ee5\u4e0b\u306eFilter\u304c\u767b\u9332\u3055\u308c\u307e\u3059\u3002\n\n\n\n\u30af\u30e9\u30b9\n\u30de\u30c3\u30d4\u30f3\u30b0\n\n\n\n\nCharacterEncodingFilter\n/*\n\n\nHiddenHttpMethodFilter\n/*\n\n\nHttpPutFormContentFilter\n/*\n\n\nRequestContextFilter\n/*\n\n\n\n\u767b\u9332\u3055\u308c\u305fFilter\u306f\u30b3\u30f3\u30bd\u30fc\u30eb\u30ed\u30b0\u3067\u78ba\u8a8d\u3067\u304d\u307e\u3059\u3002\n\n\u30b3\u30f3\u30bd\u30fc\u30eb\n...\n2016-10-01 23:54:21.465  INFO 31029 --- [ost-startStop-1] o.s.b.w.servlet.FilterRegistrationBean   : Mapping filter: 'characterEncodingFilter' to: [/*]\n2016-10-01 23:54:21.465  INFO 31029 --- [ost-startStop-1] o.s.b.w.servlet.FilterRegistrationBean   : Mapping filter: 'hiddenHttpMethodFilter' to: [/*]\n2016-10-01 23:54:21.466  INFO 31029 --- [ost-startStop-1] o.s.b.w.servlet.FilterRegistrationBean   : Mapping filter: 'httpPutFormContentFilter' to: [/*]\n2016-10-01 23:54:21.466  INFO 31029 --- [ost-startStop-1] o.s.b.w.servlet.FilterRegistrationBean   : Mapping filter: 'requestContextFilter' to: [/*]\n...\n\n\norg.springframework.boot:spring-boot-starter-web\u4ee5\u5916\u306estarter\u3084\u30e9\u30a4\u30d6\u30e9\u30ea\u3092\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306b\u8ffd\u52a0\u3057\u305f\u5834\u5408\u306f\u3001\u4e0a\u8a18\u4ee5\u5916\u306eFilter\u304c\u81ea\u52d5\u767b\u9332\u3055\u308c\u308b\u53ef\u80fd\u6027\u3082\u3042\u308a\u307e\u3059\u3002\n\njavax.servlet.Filter\u306e\u767b\u9332\nSpring Boot\u306e\u81ea\u52d5\u30b3\u30f3\u30d5\u30a3\u30ae\u30e5\u30ec\u30fc\u30b7\u30e7\u30f3\u306b\u4ed5\u7d44\u307f\u3067\u767b\u9332\u3055\u308c\u306a\u3044Filter\u3084\u81ea\u4f5c\u306eFilter\u3092\u30b5\u30fc\u30d6\u30ec\u30c3\u30c8\u30b3\u30f3\u30c6\u30ca\u306b\u767b\u9332\u3059\u308b\u5834\u5408\u306f\u3001Filter\u30af\u30e9\u30b9\u3092DI\u30b3\u30f3\u30c6\u30ca\u306b\u767b\u9332\u3057\u307e\u3059\u3002\n\nSpring\u30843rd\u30d1\u30fc\u30c6\u30a3\u88fd\u306eFilter\u306e\u767b\u9332\nBean\u5b9a\u7fa9\u30d5\u30a1\u30a4\u30eb\u3092\u4f7f\u7528\u3057\u3066DI\u30b3\u30f3\u30c6\u30ca\u306b\u767b\u9332\u3057\u307e\u3059\u3002\n@Bean\npublic CommonsRequestLoggingFilter commonsRequestLoggingFilter(){\n    return new CommonsRequestLoggingFilter();\n}\n\nFilter\u306e\u9069\u7528\u9806\u5e8f\u306e\u6307\u5b9a\u3084\u7d30\u304b\u3044\u8a2d\u5b9a\u3092\u30ab\u30b9\u30bf\u30de\u30a4\u30ba\u3057\u305f\u3044\u5834\u5408\u306f\u3001org.springframework.boot.context.embedded.FilterRegistrationBean\u3092\u4f7f\u7528\u3057\u3066DI\u30b3\u30f3\u30c6\u30ca\u306b\u767b\u9332\u3057\u307e\u3059\u3002\n@Bean\npublic FilterRegistrationBean commonsRequestLoggingFilter(){\nFilterRegistrationBean registrationBean = new FilterRegistrationBean(new CommonsRequestLoggingFilter());\n    registrationBean.setOrder(Ordered.HIGHEST_PRECEDENCE); // \u512a\u5148\u5ea6\u3092\u6307\u5b9a\u3002\u512a\u5148\u5ea6\u304c\u9ad8\u3044\u65b9\u304c\u5148\u306b\u9069\u7528\u3055\u308c\u308b\u3002\n    return registrationBean;\n}\n\n3rd\u30d1\u30fc\u30c6\u30a3\u88fd\u306eFilter\u306b@javax.servlet.annotation.WebFilter\u304c\u4ed8\u4e0e\u3055\u308c\u3066\u3044\u308b\u5834\u5408\u306f\u3001@org.springframework.boot.web.servlet.ServletComponentScan\u3092\u4f7f\u7528\u3059\u308b\u3053\u3068\u3082\u3067\u304d\u307e\u3059\u3002\n@SpringBootApplication\n@ServletComponentScan\npublic class WebDemoApplication {\n   // ....\n}\n\n\n\u81ea\u4f5c\u306eFilter\u306e\u767b\u9332\n@Component\u3092\u4ed8\u4e0e\u3057\u305fFilter\u30af\u30e9\u30b9\u3092\u4f5c\u6210\u3059\u308b\u306e\u304c\u4e00\u756a\u7c21\u5358\u3067\u3057\u3087\u3046\u3002\u9069\u7528\u9806\u5e8f\u3082@org.springframework.core.annotation.Order\u3067\u6307\u5b9a\u3067\u304d\u307e\u3059(\u3082\u3057\u304f\u306f\u3001org.springframework.core.Ordered\u30a4\u30f3\u30bf\u30d5\u30a7\u30fc\u30b9\u3092\u5b9f\u88c5\u3057\u3066\u6307\u5b9a\u3059\u308b)\u3002\n@Component\n@Order(Ordered.HIGHEST_PRECEDENCE) // \u5fc5\u8981\u306b\u5fdc\u3058\u3066\u512a\u5148\u5ea6\u3092\u6307\u5b9a\u3002\u512a\u5148\u5ea6\u304c\u9ad8\u3044\u65b9\u304c\u5148\u306b\u9069\u7528\u3055\u308c\u308b\u3002\npublic class CustomFilter implements Filter {\n    // ...\n}\n\n\u3082\u3061\u308d\u3093@Bean(+FilterRegistrationBean)\u3084@ServletComponentScan\u3092\u4f7f\u7528\u3057\u3066DI\u30b3\u30f3\u30c6\u30ca\u306b\u767b\u9332\u3059\u308b\u3053\u3068\u3082\u3067\u304d\u307e\u3059\u3002\n\nCharacterEncodingFilter\u306e\u30ab\u30b9\u30bf\u30de\u30a4\u30ba\nSpring Boot\u306e\u81ea\u52d5\u30b3\u30f3\u30d5\u30a3\u30ae\u30e5\u30ec\u30fc\u30b7\u30e7\u30f3\u3067\u306f\u3001CharacterEncodingFilter\u306e\u6587\u5b57\u30a8\u30f3\u30b3\u30fc\u30c7\u30a3\u30f3\u30b0\u306fUTF-8\u306b\u306a\u308a\u307e\u3059\u3002\u3053\u306e\u52d5\u4f5c\u3092\u5909\u66f4\u3057\u305f\u3044\u5834\u5408\u306f\u3001application.properties(or yml)\u306e\u6307\u5b9a\u3067\u5909\u66f4\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\nsrc/main/resources/application.properties\n# CharacterEncodingFilter\u306e\u9069\u7528\u6709\u7121\u3092\u6307\u5b9a(\u30c7\u30d5\u30a9\u30eb\u30c8\u306f\u9069\u7528\u3059\u308b)\nspring.http.encoding.enabled=false\n# \u30a8\u30f3\u30b3\u30fc\u30c7\u30a3\u30f3\u30b0\u3092\u6307\u5b9a(\u30c7\u30d5\u30a9\u30eb\u30c8\u306fUTF-8)\nspring.http.encoding.charset=Windows-31J\n# \u30a8\u30f3\u30b3\u30fc\u30c7\u30a3\u30f3\u30b0\u306e\u9069\u7528\u3092\u5f37\u5236\u3059\u308b\u304b\u306e\u30c7\u30d5\u30a9\u5024\u3092\u6307\u5b9a\uff08\u30ea\u30af\u30a8\u30b9\u30c8\uff0f\u30ec\u30b9\u30dd\u30f3\u30b9\u6bce\u306e\u6307\u5b9a\u304c\u306a\u3044\u6642\u306b\u5229\u7528\u3055\u308c\u308b\uff09\n# \u203b Spring Boot 1.3\u307e\u3067\u306f\u30ea\u30af\u30a8\u30b9\u30c8\u3068\u30ec\u30b9\u30dd\u30f3\u30b9\u4e21\u65b9\u306b\u9069\u7528\u3055\u308c\u3066\u3044\u305f\nspring.http.encoding.force=false\n\n# \n# \u4ee5\u4e0b\u306fSpring Boot 1.4+\u3067\u5229\u7528\u53ef\u80fd\n#\n\n# \u30ea\u30af\u30a8\u30b9\u30c8\u3078\u30a8\u30f3\u30b3\u30fc\u30c7\u30a3\u30f3\u30b0\u306e\u9069\u7528\u3092\u5f37\u5236\u3059\u308b\u304b\u3092\u6307\u5b9a(\u7701\u7565\u6642\u306f\u5168\u4f53\u306e\u30c7\u30d5\u30a9\u5024\u3001\u5168\u4f53\u306e\u30c7\u30d5\u30a9\u5024\u306e\u6307\u5b9a\u304c\u306a\u3044\u5834\u5408\u306f(true=\u5f37\u5236)\nspring.http.encoding.force-request=false\n# \u30ec\u30b9\u30dd\u30f3\u30b9\u3078\u30a8\u30f3\u30b3\u30fc\u30c7\u30a3\u30f3\u30b0\u306e\u9069\u7528\u3092\u5f37\u5236\u3059\u308b\u304b\u3092\u6307\u5b9a(\u7701\u7565\u6642\u306f\u5168\u4f53\u306e\u30c7\u30d5\u30a9\u5024\u3001\u5168\u4f53\u306e\u30c7\u30d5\u30a9\u5024\u306e\u6307\u5b9a\u304c\u306a\u3044\u5834\u5408\u306f(false=\u5f37\u5236\u3057\u306a\u3044)\nspring.http.encoding.force-response=true\n\n\n\n\n\nSpring AOP\nSpring AOP\u3068AspectJ\u306e\u30a2\u30fc\u30c6\u30a3\u30d5\u30a1\u30af\u30c8\u306f\u3001Spring Boot\u304c\u63d0\u4f9b\u3057\u3066\u3044\u308borg.springframework.boot:spring-boot-starter-aop\u3092\u6307\u5b9a\u3059\u308c\u3070\u89e3\u6c7a\u3067\u304d\u307e\u3059\u3002\n\npom.xml\n<dependency>\n    <groupId>org.springframework.boot</groupId>\n    <artifactId>spring-boot-starter-aop</artifactId>\n</dependency>\n\n\n@EnableAspectJAutoProxy\u306fSpring Boot\u304c\u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u9069\u7528\u3057\u3066\u304f\u308c\u308b\u4ed5\u7d44\u307f\u306b\u306a\u3063\u3066\u3044\u307e\u3059\u3002\nSpring Boot\u306e\u81ea\u52d5\u30b3\u30f3\u30d5\u30a3\u30ae\u30e5\u30ec\u30fc\u30b7\u30e7\u30f3\u306b\u3088\u3063\u3066@EnableAspectJAutoProxy\u3092\u9069\u7528\u3057\u305f\u304f\u306a\u3044\u5834\u5408\u306f\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u8a2d\u5b9a\u3092\u8ffd\u52a0\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\nsrc/main/resources/application.properties\nspring.aop.auto=false\n\n\n\nProxy\u751f\u6210\u306bCGLIB\u306e\u5229\u7528\u3092\u5f37\u5236\nCGLIB\u306e\u4ed5\u7d44\u307f\u3092\u4f7f\u3063\u3066Proxy\u3092\u4f5c\u308b\u3053\u3068\u3092\u5f37\u5236\u3057\u305f\u3044\u5834\u5408\u306f\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u8a2d\u5b9a\u3092\u8ffd\u52a0\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\nsrc/main/resources/application.properties\nspring.aop.proxy-target-class=true\n\n\n\n\u307e\u3068\u3081\n\u4eca\u56de\u306f\u3001\u30ea\u30af\u30a8\u30b9\u30c8\u51e6\u7406\u5185\u306e\u4efb\u610f\u306e\u30dd\u30a4\u30f3\u30c8\u3067\u5171\u901a\u51e6\u7406\u3092\u5b9f\u884c\u3059\u308b\u65b9\u6cd5\u3092\u7d39\u4ecb\u3057\u307e\u3057\u305f\u3002\nFilter\u3001HandlerInterceptor\u3001AOP(\u7279\u306bAOP)\u306f\u5171\u901a\u51e6\u7406\u3092\u5b9f\u88c5\u3059\u308b\u306e\u306b\u5f37\u529b\u306a\u4ed5\u7d44\u307f\u3067\u3059\u304c\u3001\u4e71\u7528\u3059\u308b\u3068\u30e1\u30f3\u30c6\u30ca\u30f3\u30b9\u6027\u3092\u640d\u306a\u3046\u53ef\u80fd\u6027\u304c\u3042\u308b\u3053\u3068\u3092\u610f\u8b58\u3057\u3066\u304a\u3044\u305f\u65b9\u304c\u3088\u3044\u3067\u3057\u3087\u3046\u3002\u4f8b\u3048\u3070\u3001\u5165\u529b\u5024(\u30e1\u30bd\u30c3\u30c9\u5f15\u6570)\u3084\u51fa\u529b\u5024(\u30e1\u30bd\u30c3\u30c9\u306e\u8fd4\u308a\u5024)\u3092\u66f4\u65b0\u3057\u3066\u3057\u307e\u3046\u3088\u3046\u306a\u5171\u901a\u51e6\u7406\uff08\u305d\u306e\u5171\u901a\u51e6\u7406\u304c\u306a\u3044\u3068\u5f8c\u7d9a\u51e6\u7406\u306e\u52d5\u4f5c\u304c\u304b\u308f\u3063\u3066\u3057\u307e\u3046\u3088\u3046\u306a\u51e6\u7406\uff09\u306f\u539f\u5247\u3055\u3051\u308b\u3079\u304d\u3067\u3059\u3002\u3053\u306e\u624b\u306e\u51e6\u7406\u3092\u5171\u901a\u5316\u3057\u305f\u3044\u5834\u5408\u306f\u3001\u5171\u901a\u51e6\u7406\u3092\u884c\u3046\u30b3\u30f3\u30dd\u30fc\u30cd\u30f3\u30c8\u3092\u4f5c\u6210\u3057\u3001\u660e\u793a\u7684\u306b\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u30b3\u30fc\u30c9\u306e\u4e2d\u304b\u3089\u30e1\u30bd\u30c3\u30c9\u3092\u547c\u3073\u51fa\u3059\u30b9\u30bf\u30a4\u30eb\u306e\u65b9\u304c\u79c1\u306f\u3088\u3044\u3068\u601d\u3044\u307e\u3059\u3002\n\u3061\u306a\u307f\u306b\u3001Spring AOP\u306e\u8aac\u660e\u306f\u3001\u5168\u8c8c\u306e\u307b\u3093\u306e\u4e00\u90e8\u3067\u3059\u3002\u3053\u306e\u6295\u7a3f\u3067\u306f\u3001Spring AOP\u306e\u96f0\u56f2\u6c17\u3092\u63b4\u3093\u3067\u3082\u3089\u3048\u308c\u3070\u5e78\u3044\u3067\u3059\u3002Spring AOP\u306b\u3064\u3044\u3066\u8a73\u3057\u304f\u77e5\u308a\u305f\u3044\u65b9\u306f\u3001Spring Framework\u516c\u5f0f\u30ea\u30d5\u30a1\u30ec\u30f3\u30b9\u3092\u3054\u89a7\u304f\u3060\u3055\u3044\u3002\n\u307e\u305f\u3001\u300cServlet 3.0\u3067\u30b5\u30dd\u30fc\u30c8\u3055\u308c\u305f\u975e\u540c\u671f\u51e6\u7406\u5229\u7528\u6642\u306e\u5171\u901a\u51e6\u7406\u306e\u5b9f\u88c5\u300d\u306b\u3064\u3044\u3066\u306f\u3001\u5f8c\u65e5\u300cSpring MVC(+Spring Boot)\u4e0a\u3067\u306eServlet\u6a19\u6e96\u306e\u975e\u540c\u671f\u51e6\u7406\u3092\u7406\u89e3\u3059\u308b(\u4eee\u540d)\u300d\u306e\u4e2d\u3067\u7d39\u4ecb\u3067\u304d\u308c\u3070\u3068\u601d\u3063\u3066\u3044\u307e\u3059\u3002\n\n\u53c2\u8003\u30b5\u30a4\u30c8\n\nhttp://docs.spring.io/spring-boot/docs/current/reference/htmlsingle/\nhttp://docs.spring.io/spring/docs/current/spring-framework-reference/htmlsingle/\nhttp://qiita.com/kazuki43zoo/items/e12a72d4ac4de418ee37\nhttp://qiita.com/kazuki43zoo/items/ea79e206d7c2e990e478\nhttp://terasolunaorg.github.io/guideline/5.2.0.RELEASE/ja/\n\n\u4eca\u56de\u306f\u3001Spring MVC\u30d9\u30fc\u30b9\u306eWeb\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3(\u753b\u9762\u30a2\u30d7\u30ea or REST API)\u3067\u3001\u30ea\u30af\u30a8\u30b9\u30c8\u51e6\u7406\u5185\u306e\u4efb\u610f\u306e\u30dd\u30a4\u30f3\u30c8\u3067\u5171\u901a\u51e6\u7406\u3092\u5b9f\u884c\u3059\u308b\u65b9\u6cd5\u3092\u306b\u3064\u3044\u3066\u8aac\u660e\u3057\u307e\u3059\u3002\u306a\u304a\u3001Servlet 3.0\u3067\u30b5\u30dd\u30fc\u30c8\u3055\u308c\u305f\u975e\u540c\u671f\u51e6\u7406\u5229\u7528\u6642\u306e\u5171\u901a\u51e6\u7406\u306e\u5b9f\u88c5\u306f\u3001\u4eca\u56de\u306f\u5bfe\u8c61\u5916\u3068\u3057\u3066\u5225\u306e\u56de\u3067\u7d39\u4ecb\u3057\u305f\u3044\u3068\u601d\u3044\u307e\u3059\u3002\uff08\u4e5e\u3046\u3054\u671f\u5f85\uff01\uff01\uff09\n\n# \u52d5\u4f5c\u691c\u8a3c\u30d0\u30fc\u30b8\u30e7\u30f3\n\n* Spring Framework 4.3.3.RELEASE\n* Spring Boot 1.4.1.RELEASE\n\n# \u5171\u901a\u51e6\u7406\u306e\u5b9f\u88c5\u65b9\u6cd5\n\n\u5171\u901a\u51e6\u7406\u306f\u4ee5\u4e0b\u306e\u3044\u305a\u308c\u304b\u306e\u65b9\u6cd5\u3067\u5b9f\u88c5\u3057\u307e\u3059\u3002\n\n| \u5b9f\u88c5\u65b9\u6cd5 | \u8aac\u660e | \n| ------- | ---- |\n| `javax.servlet.Filter.ServletRequestListener` | \u30ea\u30af\u30a8\u30b9\u30c8\u958b\u59cb\u6642\u3068\u30ea\u30af\u30a8\u30b9\u30c8\u7d42\u4e86\u6642\u306e\u30bf\u30a4\u30df\u30f3\u30b0\u3067\u4efb\u610f\u306e\u51e6\u7406\u3092\u5b9f\u884c\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002 | \n| `javax.servlet.Filter` | Servlet\u3001JSP\u3001\u9759\u7684\u30b3\u30f3\u30c6\u30f3\u30c4\u306a\u3069\u306eWeb\u30ea\u30bd\u30fc\u30b9\u3078\u306e\u30a2\u30af\u30bb\u30b9\u306e\u524d\u5f8c\u306b\u3001\u5171\u901a\u51e6\u7406\u3092\u5b9f\u884c\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002 | \n| `HandlerInterceptor` | Spring MVC\u306eHandler\u306e\u547c\u3073\u51fa\u3057\u524d\u5f8c\u306b\u3001\u5171\u901a\u51e6\u7406\u3092\u5b9f\u884c\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002 |\n| `@ControllerAdvice` | Controller\u5c02\u7528\u306e\u7279\u6b8a\u306a\u30e1\u30bd\u30c3\u30c9(`@InitBainder`\u30e1\u30bd\u30c3\u30c9\u3001`@ModelAttribute`\u30e1\u30bd\u30c3\u30c9\u3001`@ExceptionHandler`\u30e1\u30bd\u30c3\u30c9)\u3092\u8907\u6570\u306eController\u3067\u5171\u6709\u3067\u304d\u307e\u3059\u3002 |\n| Spring AOP(AspectJ) | Spring\u306eDI\u30b3\u30f3\u30c6\u30ca\u3067\u7ba1\u7406\u3055\u308c\u3066\u3044\u308bBean\u306epublic\u30e1\u30bd\u30c3\u30c9\u306e\u547c\u3073\u51fa\u3057\u524d\u5f8c\u306b\u3001\u5171\u901a\u51e6\u7406\u3092\u5b9f\u884c\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002|\n\n![interceptorProcessing.png](https://qiita-image-store.s3.amazonaws.com/0/117313/cb9cfdc6-dc9f-496a-6002-31d139e21383.png)\n\n# `javax.servlet.Filter.ServletRequestListener`\n\nServlet\u6a19\u6e96\u306eAPI\u3067\u3042\u308b`javax.servlet.ServletRequestListener`\u30a4\u30f3\u30bf\u30d5\u30a7\u30fc\u30b9\u3092\u5b9f\u88c5\u3057\u305f\u30af\u30e9\u30b9\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\u4f5c\u6210\u3057\u305f\u30af\u30e9\u30b9\u3092\u30b5\u30fc\u30d6\u30ec\u30c3\u30c8\u30b3\u30f3\u30c6\u30ca\u306b\u767b\u9332\u3059\u308b\u3068\u3001\u30ea\u30af\u30a8\u30b9\u30c8\u958b\u59cb\u6642\u3068\u30ea\u30af\u30a8\u30b9\u30c8\u7d42\u4e86\u6642\u306e\u30bf\u30a4\u30df\u30f3\u30b0\u3067\u4efb\u610f\u306e\u51e6\u7406\u3092\u5b9f\u884c\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n```java\npackage com.example.component;\n\nimport javax.servlet.ServletRequestEvent;\nimport javax.servlet.ServletRequestListener;\n\npublic class CustomServletRequestListener implements ServletRequestListener {\n\n    @Override\n    public void requestInitialized(ServletRequestEvent sre) {\n        // \u30ea\u30af\u30a8\u30b9\u30c8\u958b\u59cb\u6642\u306e\u51e6\u7406\u3092\u884c\u3046\u3002\n        // (\u5b9f\u88c5\u306f\u7701\u7565)\n    }\n    @Override\n    public void requestDestroyed(ServletRequestEvent sre) {\n        // \u30ea\u30af\u30a8\u30b9\u30c8\u7d42\u4e86\u6642\u306e\u51e6\u7406\u3092\u884c\u3046\u3002\n        // (\u5b9f\u88c5\u306f\u7701\u7565)\n    }\n\n}\n```\n\n\u5b9f\u88c5\u3057\u305fServletRequestListener\u30af\u30e9\u30b9\u3092\u30b5\u30fc\u30d6\u30ec\u30c3\u30c8\u30b3\u30f3\u30c6\u30ca\u306b\u767b\u9332\u3057\u307e\u3059\u3002\n\n```xml:src/main/webapp/WEB-INF/web.xml\n<listener>\n    <listener-class>com.example.component.CustomServletRequestListener</listener-class>\n</listener>\n```\n\n# Bean\u306e\u30a4\u30f3\u30b8\u30a7\u30af\u30b7\u30e7\u30f3\n\nServletRequestListener\u5185\u306e\u51e6\u7406\u3067DI\u30b3\u30f3\u30c6\u30ca\u3067\u7ba1\u7406\u3057\u3066\u3044\u308bBean\u3092\u5229\u7528\u3057\u305f\u3044\u5834\u5408\u306f\u3001ServletRequestListener\u30af\u30e9\u30b9\u3092DI\u30b3\u30f3\u30c6\u30ca\u306b\u767b\u9332\u3057\u3001`org.springframework.web.context.ServletContextAware#setServletContext` \u30e1\u30bd\u30c3\u30c9\u306e\u4e2d\u3067`ServletContext#addListener`\u30e1\u30bd\u30c3\u30c9\u3092\u547c\u3073\u51fa\u3059\u3053\u3068\u3067\u5b9f\u73fe\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n```java\n@Component\npublic class CustomServletRequestListener implements ServletRequestListener , ServletContextAware {\n    @Autowired\n    MessageSource messageSource; // Bean\u3092\u30a4\u30f3\u30b8\u30a7\u30af\u30b7\u30e7\u30f3\u3059\u308b\n    // ...\n    @Override\n    public void setServletContext(ServletContext servletContext) {\n        servletContext.addListener(this);\n    }\n}\n```\n\n> **Warning: \u30d9\u30b9\u30c8\u30d7\u30e9\u30af\u30c6\u30a3\u30b9\u306b\u3064\u3044\u3066**\n> \u3053\u306e\u65b9\u6cd5\u304c\u30d9\u30b9\u30c8\u30d7\u30e9\u30af\u30c6\u30a3\u30b9\u306a\u306e\u304b\u306f**\u304b\u306a\u308a\u5fae\u5999\u3067\u3059** :sweat_smile: \n> \u5f8c\u307b\u3069\u7d39\u4ecb\u3057\u307e\u3059\u304c\u3001Spring Boot\u3092\u4f7f\u3046\u5834\u5408\u306f\u3001\u5358\u7d14\u306bDI\u30b3\u30f3\u30c6\u30ca\u306b\u767b\u9332\u3059\u308b\u3060\u3051\u3067\u81ea\u52d5\u3067\u30b5\u30fc\u30d6\u30ec\u30c3\u30c8\u30b3\u30f3\u30c6\u30ca\u306b\u767b\u9332\u3055\u308c\u307e\u3059\uff01\uff01\n\n# Spring\u63d0\u4f9b\u306eServletRequestListener\u30af\u30e9\u30b9\n\nSpring Web\u53ca\u3073Spring MVC\u63d0\u4f9b\u306eFilter\u30af\u30e9\u30b9\u306f\u4ee5\u4e0b\u306e\u3068\u304a\u308a\u3067\u3059\u3002\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u8981\u4ef6\u306b\u5fdc\u3058\u3066\u4f7f\u7528\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n| \u30af\u30e9\u30b9 | \u8aac\u660e | \n| ----- | ---- |\n| `RequestContextListener` | \u30ea\u30af\u30a8\u30b9\u30c8(`HttpServletRequest`\u3068`HttpServletResponse`)+\u30ea\u30af\u30a8\u30b9\u30c8\u306e\u30ed\u30b1\u30fc\u30eb\u60c5\u5831\u3092\u30b9\u30ec\u30c3\u30c9\u30ed\u30fc\u30ab\u30eb\u306b\u8a2d\u5b9a\u3059\u308b\u305f\u3081\u306eServletRequestListener\u30af\u30e9\u30b9\u3002 |\n\n\n# `javax.servlet.Filter`\n\nServlet\u6a19\u6e96\u306eAPI\u3067\u3042\u308b`javax.servlet.Filter`\u30a4\u30f3\u30bf\u30d5\u30a7\u30fc\u30b9\u3092\u5b9f\u88c5\u3057\u305f\u30af\u30e9\u30b9\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\u4f5c\u6210\u3057\u305f\u30af\u30e9\u30b9\u3092\u30b5\u30fc\u30d6\u30ec\u30c3\u30c8\u30b3\u30f3\u30c6\u30ca\u306b\u767b\u9332\u3059\u308b\u3068\u3001Servlet\u306e\u547c\u3073\u51fa\u3057\u524d\u5f8c\u306b\u4efb\u610f\u306e\u51e6\u7406\u3092\u5b9f\u884c\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n```java\npackage com.example.component;\n\nimport javax.servlet.*;\nimport java.io.IOException;\n\npublic class CustomFilter implements Filter {\n    @Override\n    public void init(FilterConfig filterConfig) throws ServletException {\n        // \u521d\u671f\u5316\u51e6\u7406\u3092\u884c\u3046\u3002\u3053\u306e\u30e1\u30bd\u30c3\u30c9\u306f\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u8d77\u52d5\u6642\u306b\u547c\u3073\u51fa\u3055\u308c\u308b\u3002\n        // \u30b5\u30fc\u30d6\u30ec\u30c3\u30c8\u30d5\u30a3\u30eb\u30bf\u306e\u521d\u671f\u5316\u30d1\u30e9\u30e1\u30fc\u30bf\u306f\u5f15\u6570\u306eFilterConfig\u304b\u3089\u53d6\u5f97\u3067\u304d\u308b\u3002\n        // (\u5b9f\u88c5\u306f\u7701\u7565)\n    }\n    @Override\n    public void doFilter(ServletRequest request, ServletResponse response, FilterChain chain) throws IOException, ServletException {\n        // \u3053\u3053\u306b\u524d\u51e6\u7406\u3092\u5b9f\u88c5\u3059\u308b\n        // (\u5b9f\u88c5\u306f\u7701\u7565)\n        // \u5f8c\u7d9a\u51e6\u7406(\u6b21\u306eFilter\u53c8\u306fServlet)\u3092\u547c\u3073\u51fa\u3057\u305f\u304f\u306a\u3044\u5834\u5408\u306f\u3001\u3053\u306e\u30bf\u30a4\u30df\u30f3\u30b0\u3067\u30e1\u30bd\u30c3\u30c9\u3092\u7d42\u4e86(return)\u3059\u308c\u3070\u3088\u3044\u3002\n\n        // \u5f8c\u7d9a\u51e6\u7406(\u6b21\u306eFilter\u53c8\u306fServlet)\u3092\u547c\u3073\u51fa\u3059\n        chain.doFilter(request, response);\n\n        // \u3053\u3053\u306b\u5f8c\u51e6\u7406\u3092\u5b9f\u88c5\u3059\u308b\n        // (\u5b9f\u88c5\u306f\u7701\u7565)\n   }\n    @Override\n    public void destroy() {\n        // \u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u7d42\u4e86\u6642\u306b\u884c\u3046\u51e6\u7406\u3092\u5b9f\u88c5\u3059\u308b\n        // (\u5b9f\u88c5\u306f\u7701\u7565)\n    }\n}\n```\n\n\u5b9f\u88c5\u3057\u305fFilter\u30af\u30e9\u30b9\u3092\u30b5\u30fc\u30d6\u30ec\u30c3\u30c8\u30b3\u30f3\u30c6\u30ca\u306b\u767b\u9332\u3057\u3001Filter\u3092\u9069\u7528\u3059\u308b\u30ea\u30af\u30a8\u30b9\u30c8\u3092`<url-pattern>`\u307e\u305f\u306f`<servle-name>`\u30bf\u30b0\u3092\u4f7f\u7528\u3057\u3066\u6307\u5b9a\u3057\u307e\u3059\u3002\n\n```xml:src/main/webapp/WEB-INF/web.xml\n<filter>\n    <filter-name>CustomFilter</filter-name>\n    <filter-class>com.example.component.CustomFilter</filter-class>\n</filter>\n<filter-mapping>\n    <filter-name>CustomFilter</filter-name>\n    <url-pattern>/*</url-pattern> <!-- \u30ea\u30af\u30a8\u30b9\u30c8\u30d1\u30b9\u304c\u6307\u5b9a\u3057\u305f\u30d1\u30bf\u30fc\u30f3\u306b\u4e00\u81f4\u3059\u308b\u30ea\u30af\u30a8\u30b9\u30c8\u306b\u5bfe\u3057\u3066\u306e\u307fFilter\u304c\u9069\u7528\u3055\u308c\u307e\u3059\u3002 -->\n    <!-- <servlet-name>app</servlet-name> --> <!-- \u6307\u5b9a\u3057\u305f\u30b5\u30fc\u30d6\u30ec\u30c3\u30c8\u306b\u30de\u30c3\u30d4\u30f3\u30b0\u3055\u308c\u305f\u30ea\u30af\u30a8\u30b9\u30c8\u306b\u5bfe\u3057\u3066\u306e\u307fFilter\u304c\u9069\u7528\u3055\u308c\u307e\u3059\u3002 -->\n</filter-mapping>\n```\n\n\u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u306f\u3001Filter\u3092\u9069\u7528\u3059\u308b\u30bf\u30a4\u30df\u30f3\u30b0\u306f\u30ea\u30af\u30a8\u30b9\u30c8\u3092\u53d7\u3051\u305f\u6642\u3060\u3051\u3067\u3059\u304c\u3001\u3053\u306e\u30bf\u30a4\u30df\u30f3\u30b0\u306f\u5909\u66f4\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\u6307\u5b9a\u53ef\u80fd\u306a\u30bf\u30a4\u30df\u30f3\u30b0\u306f\u4ee5\u4e0b\u306e5\u3064\u3067\u3001`<dispatcher>`\u30bf\u30b0\u3092\u4f7f\u7528\u3057\u3066\u6307\u5b9a\u3057\u307e\u3059\u3002\n\n```xml:src/main/webapp/WEB-INF/web.xml\n<filter-mapping>\n    <filter-name>CustomFilter</filter-name>\n    <url-pattern>/*</url-pattern>\n    <dispatcher>REQUEST</dispatcher> <!-- \u4e00\u81f4\u3059\u308b\u30d1\u30b9\u3084\u30b5\u30fc\u30d6\u30ec\u30c3\u30c8\u3078\u306e\u30ea\u30af\u30a8\u30b9\u30c8\u3092\u53d7\u3051\u305f\u6642 -->\n    <dispatcher>ASYNC</dispatcher> <!-- \u4e00\u81f4\u3059\u308b\u30d1\u30b9\u3084\u30b5\u30fc\u30d6\u30ec\u30c3\u30c8\u3078\u306e\u975e\u540c\u671f\u30ea\u30af\u30a8\u30b9\u30c8\u3092\u53d7\u3051\u305f\u6642 -->\n    <dispatcher>FORWARD</dispatcher> <!-- \u4e00\u81f4\u3059\u308b\u30d1\u30b9\u3084\u30b5\u30fc\u30d6\u30ec\u30c3\u30c8\u3078\u30d5\u30a9\u30ef\u30fc\u30c9\u3057\u305f\u6642 -->\n    <dispatcher>INCLUDE</dispatcher> <!-- \u4e00\u81f4\u3059\u308b\u30d1\u30b9\u3084\u30b5\u30fc\u30d6\u30ec\u30c3\u30c8\u3092\u30a4\u30f3\u30af\u30eb\u30fc\u30c9\u3057\u305f\u6642 -->\n    <dispatcher>ERROR</dispatcher> <!-- \u4e00\u81f4\u3059\u308b\u30d1\u30b9\u3084\u30b5\u30fc\u30d6\u30ec\u30c3\u30c8\u3078\u30a8\u30e9\u30fc\u9077\u79fb\u3057\u305f\u6642 -->\n</filter-mapping>\n```\n\n## Spring\u63d0\u4f9b\u306e\u30b5\u30dd\u30fc\u30c8\u30af\u30e9\u30b9\u3092\u5229\u7528\u3057\u305fFilter\u30af\u30e9\u30b9\u306e\u4f5c\u6210\n\nSpring\u306f\u3001Filter\u3092\u4f5c\u6210\u3059\u308b\u305f\u3081\u306e\u30b5\u30dd\u30fc\u30c8\u30af\u30e9\u30b9\u3092\u63d0\u4f9b\u3057\u3066\u3044\u307e\u3059\u3002\n\n| \u30af\u30e9\u30b9 | \u8aac\u660e |\n| ----- | ---- |\n| `GenericFilterBean` | Filter\u306e\u521d\u671f\u5316\u30d1\u30e9\u30e1\u30fc\u30bf\u3092Filter\u30af\u30e9\u30b9\u306e\u30d7\u30ed\u30d1\u30c6\u30a3\u306b\u8a2d\u5b9a\u3059\u308b\u6a5f\u80fd\u3092\u6301\u3064\u57fa\u5e95\u30af\u30e9\u30b9\u3002Spring\u304c\u63d0\u4f9b\u3059\u308bFilter\u30af\u30e9\u30b9\u306e\u591a\u304f\u306f\u3001\u3053\u306e\u30af\u30e9\u30b9\u306e\u5b50\u30af\u30e9\u30b9\u3068\u3057\u3066\u5b9f\u88c5\u3055\u308c\u3066\u3044\u307e\u3059\u3002 |\n| `OncePerRequestFilter` | \u540c\u4e00\u30ea\u30af\u30a8\u30b9\u30c8\u5185\u3067\uff11\u56de\u3060\u3051\u51e6\u7406\u3092\u5b9f\u884c\u3059\u308b\u3053\u3068\u3092\u62c5\u4fdd\u3059\u308b\u6a5f\u80fd\u3092\u6301\u3064\u57fa\u5e95\u30af\u30e9\u30b9\u3002 `GenericFilterBean`\u3092\u7d99\u627f\u3057\u3066\u304a\u308a\u3001Spring\u304c\u63d0\u4f9b\u3059\u308bFilter\u30af\u30e9\u30b9\u306e\u591a\u304f\u306f\u3001\u3053\u306e\u30af\u30e9\u30b9\u306e\u5b50\u30af\u30e9\u30b9\u3068\u3057\u3066\u5b9f\u88c5\u3055\u308c\u3066\u3044\u307e\u3059\u3002 |\n\n\n```java\npackage com.example.component;\n\nimport org.springframework.web.filter.OncePerRequestFilter;\n\nimport javax.servlet.FilterChain;\nimport javax.servlet.ServletException;\nimport javax.servlet.http.HttpServletRequest;\nimport javax.servlet.http.HttpServletResponse;\nimport java.io.IOException;\n\n\npublic class CustomFilter extends OncePerRequestFilter {\n\n    private int limit; // \u540d\u524d\u304c\u4e00\u81f4\u3059\u308b\u521d\u671f\u5316\u30d1\u30e9\u30e1\u30fc\u30bf\u306e\u5024\u304c\u30d0\u30a4\u30f3\u30c9\u3055\u308c\u308b\n\n    public int getLimit() {\n        return limit;\n    }\n\n    public void setLimit(int limit) {\n        this.limit = limit;\n    }\n\n    @Override\n    protected void initFilterBean() throws ServletException {\n        // \u5fc5\u8981\u306b\u5fdc\u3058\u3066\u521d\u671f\u5316\u51e6\u7406\u3092\u884c\u3046\u3002\u3053\u306e\u30e1\u30bd\u30c3\u30c9\u306f\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u8d77\u52d5\u6642\u306b\u547c\u3073\u51fa\u3055\u308c\u308b\u3002\n        // \u30b5\u30fc\u30d6\u30ec\u30c3\u30c8\u30d5\u30a3\u30eb\u30bf\u306e\u521d\u671f\u5316\u30d1\u30e9\u30e1\u30fc\u30bf\u306f\u3001\u3053\u306e\u30af\u30e9\u30b9\u306e\u30d7\u30ed\u30d1\u30c6\u30a3\u306b\u30d0\u30a4\u30f3\u30c9\u3057\u3066\u53d6\u5f97\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u308b\u3002\n        // \u306a\u304a\u3001getFilterConfig()\u3092\u547c\u3073\u51fa\u3057\u3066FilterConfig\u3092\u53d6\u5f97\u3059\u308b\u3053\u3068\u3082\u53ef\u80fd\u3002\n        // \u521d\u671f\u5316\u51e6\u7406\u304c\u4e0d\u8981\u306a\u5834\u5408\u306f\u30aa\u30fc\u30d0\u30fc\u30e9\u30a4\u30c9\u3082\u4e0d\u8981\u3002\n        // (\u5b9f\u88c5\u306f\u7701\u7565)\n    }\n\n    @Override\n    protected void doFilterInternal(HttpServletRequest request, HttpServletResponse response, FilterChain filterChain) throws ServletException, IOException {\n        // \u3053\u3053\u306b\u524d\u51e6\u7406\u3092\u5b9f\u88c5\u3059\u308b\n        // (\u5b9f\u88c5\u306f\u7701\u7565)\n        // \u5f8c\u7d9a\u51e6\u7406(\u6b21\u306eFilter\u53c8\u306fServlet)\u3092\u547c\u3073\u51fa\u3057\u305f\u304f\u306a\u3044\u5834\u5408\u306f\u3001\u3053\u306e\u30bf\u30a4\u30df\u30f3\u30b0\u3067\u30e1\u30bd\u30c3\u30c9\u3092\u7d42\u4e86(return)\u3059\u308c\u3070\u3088\u3044\u3002\n\n        // \u5f8c\u7d9a\u51e6\u7406(\u6b21\u306eFilter\u53c8\u306fServlet)\u3092\u547c\u3073\u51fa\u3059\n        chain.doFilter(request, response);\n\n        // \u3053\u3053\u306b\u5f8c\u51e6\u7406\u3092\u5b9f\u88c5\u3059\u308b\n        // (\u5b9f\u88c5\u306f\u7701\u7565)\n    }\n\n    @Override\n    public void destroy() {\n        // \u5fc5\u8981\u306b\u5fdc\u3058\u3066\u3001\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u7d42\u4e86\u6642\u306b\u884c\u3046\u51e6\u7406\u3092\u5b9f\u88c5\u3059\u308b\u3002\n        // \u7d42\u4e86\u51e6\u7406\u304c\u4e0d\u8981\u306a\u5834\u5408\u306f\u30aa\u30fc\u30d0\u30fc\u30e9\u30a4\u30c9\u3082\u4e0d\u8981\u3002\n        // (\u5b9f\u88c5\u306f\u7701\u7565)\n    }\n\n}\n```\n\n```xml:src/main/webapp/WEB-INF/web.xml\n<filter>\n    <filter-name>CustomFilter</filter-name>\n    <filter-class>com.example.component.CustomFilter</filter-class>\n    <init-param> <!-- Filter\u30af\u30e9\u30b9\u306e\u30d7\u30ed\u30d1\u30c6\u30a3\u306b\u30d0\u30a4\u30f3\u30c9\u3055\u308c\u308b -->\n        <param-name>limit</param-name>\n        <param-value>10</param-value>\n    </init-param>\n</filter>\n```\n\n## Bean\u306e\u30a4\u30f3\u30b8\u30a7\u30af\u30b7\u30e7\u30f3\n\nFilter\u5185\u306e\u51e6\u7406\u3067DI\u30b3\u30f3\u30c6\u30ca\u3067\u7ba1\u7406\u3057\u3066\u3044\u308bBean\u3092\u5229\u7528\u3057\u305f\u3044\u5834\u5408\u306f\u3001Filter\u306e\u5b9f\u88c5\u30af\u30e9\u30b9\u3092DI\u30b3\u30f3\u30c6\u30ca\u306b\u767b\u9332\u3057\u3001`org.springframework.web.filter.DelegatingFilterProxy`\u7d4c\u7531\u3067Filter\u306e\u51e6\u7406\u3092\u5b9f\u884c\u3057\u307e\u3059\u3002\n\n```java\npublic class CustomFilter implements Filter {\n    @Autowired\n    MessageSource messageSource; // Bean\u3092\u30a4\u30f3\u30b8\u30a7\u30af\u30b7\u30e7\u30f3\u3059\u308b\n    // ...\n}\n```\n```java\n@Configuration\npublic class AppConfig {\n    @Bean\n    public CustomFilter customFilter() { // Filter\u3092Bean\u767b\u9332\u3059\u308b\n        return new CustomFilter();\n    }\n}\n```\n```xml:src/main/webapp/WEB-INF/web.xml\n<filter>\n    <filter-name>customFilter</filter-name> <!-- Filter\u306eBean\u540d\u3092\u6307\u5b9a\u3059\u308b -->\n    <filter-class>org.springframework.web.filter.DelegatingFilterProxy</filter-class>\n</filter>\n```\n\n\u306a\u304a\u3001Filter\u306eBean\u306f\u3001`org.springframework.web.context.ContextLoaderListener`\u7d4c\u7531\u3067DI\u30b3\u30f3\u30c6\u30ca\u306b\u767b\u9332\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002(`DispatcherServlet`\u6bce\u306eDI\u30b3\u30f3\u30c6\u30ca\u306bFilter\u306eBean\u3092\u767b\u9332\u3057\u3066\u3082\u8a8d\u8b58\u3055\u308c\u307e\u305b\u3093)\n\n## Spring\u63d0\u4f9b\u306eFilter\u30af\u30e9\u30b9\n\nSpring Web\u53ca\u3073Spring MVC\u63d0\u4f9b\u306eFilter\u30af\u30e9\u30b9\u306f\u4ee5\u4e0b\u306e\u3068\u304a\u308a\u3067\u3059\u3002`CharacterEncodingFilter`\u306f\u5fc5\u305a\u8a2d\u5b9a\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u304c\u3001\u305d\u306e\u4ed6\u306eFilter\u306f\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u8981\u4ef6\u306b\u5fdc\u3058\u3066\u4f7f\u7528\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n| \u30af\u30e9\u30b9 | \u8aac\u660e | \n| ----- | ---- |\n| `CorsFilter` | CORS\u9023\u643a\u7528\u306eFilter\u30af\u30e9\u30b9\u3002 |\n| `HttpPutFormContentFilter` | HTML\u30d5\u30a9\u30fc\u30e0\u304b\u3089\u306e\u30ea\u30af\u30a8\u30b9\u30c8(application/x-www-form-urlencoded)\u3067PUT\u3068PATCH\u30e1\u30bd\u30c3\u30c9\u3092\u5229\u7528\u3067\u304d\u308b\u3088\u3046\u306b\u3059\u308b\u305f\u3081\u306eFilter\u30af\u30e9\u30b9\u3002 |\n| `HiddenHttpMethodFilter` | \u30ea\u30af\u30a8\u30b9\u30c8\u30d1\u30e9\u30e1\u30fc\u30bf(hidden\u30d1\u30e9\u30e1\u30fc\u30bf)\u3067\u6307\u5b9a\u3055\u308c\u305fHTTP\u30e1\u30bd\u30c3\u30c9\u306b\u5909\u63db\u3059\u308b(\u306a\u308a\u3059\u307e\u3059)\u305f\u3081\u306eFilter\u30af\u30e9\u30b9\u3002 |\n| `CharacterEncodingFilter` | \u30ea\u30af\u30a8\u30b9\u30c8\u3068\u30ec\u30b9\u30dd\u30f3\u30b9\u306e\u6587\u5b57\u30a8\u30f3\u30b3\u30fc\u30c7\u30a3\u30f3\u30b0\u3092\u6307\u5b9a\u3059\u308b\u305f\u3081\u306eFilter\u30af\u30e9\u30b9\u3002 \u203b Spring 4.3\u304b\u3089\u30a8\u30f3\u30b3\u30fc\u30c7\u30a3\u30f3\u30b0\u306e\u5f37\u5236\u30d5\u30e9\u30b0\u304c\u30ea\u30af\u30a8\u30b9\u30c8\u3068\u30ec\u30b9\u30dd\u30f3\u30b9\u6bce\u306b\u6307\u5b9a\u53ef\u80fd\u306b\u306a\u3063\u3066\u3044\u308b\u3002 |\n| `RequestContextFilter` | \u30ea\u30af\u30a8\u30b9\u30c8(`HttpServletRequest`\u3068`HttpServletResponse`)+\u30ea\u30af\u30a8\u30b9\u30c8\u306e\u30ed\u30b1\u30fc\u30eb\u60c5\u5831\u3092\u30b9\u30ec\u30c3\u30c9\u30ed\u30fc\u30ab\u30eb\u306b\u8a2d\u5b9a\u3059\u308b\u305f\u3081\u306eFilter\u30af\u30e9\u30b9\u3002(`RequestContextListener`\u306eFilter\u30af\u30e9\u30b9\u7248\u3067\u3059) |\n| `ResourceUrlEncodingFilter` | \u9759\u7684\u30ea\u30bd\u30fc\u30b9\u306b\u30a2\u30af\u30bb\u30b9\u3059\u308b\u305f\u3081\u306eURL\u3092`ResourceResolver`\u3068\u9023\u643a\u3057\u3066\u751f\u6210\u3059\u308bFilter\u30af\u30e9\u30b9\u3002 \u8a73\u3057\u304f\u306f\u3001\u300c[Spring MVC(+Spring Boot)\u4e0a\u3067\u306e\u9759\u7684\u30ea\u30bd\u30fc\u30b9\u3078\u306e\u30a2\u30af\u30bb\u30b9\u3092\u7406\u89e3\u3059\u308b](http://qiita.com/kazuki43zoo/items/e12a72d4ac4de418ee37)\u300d\u3092\u3054\u89a7\u304f\u3060\u3055\u3044\u3002|\n| `MultipartFilter` | \u30de\u30eb\u30c1\u30d1\u30fc\u30c8\u30ea\u30af\u30a8\u30b9\u30c8\u3092\u89e3\u6790\u3059\u308b\u305f\u3081\u306eFilter\u30af\u30e9\u30b9\u3002 |\n| `ShallowEtagHeaderFilter` | ETag\u306e\u5236\u5fa1\u3092\u884c\u3046Filter\u30af\u30e9\u30b9\u3002 |\n| `ServletContextRequestLoggingFilter` | \u30ea\u30af\u30a8\u30b9\u30c8\u30c7\u30fc\u30bf\u3092\u30b5\u30fc\u30d6\u30ec\u30c3\u30c8\u30b3\u30f3\u30c6\u30ca\u306e\u30ed\u30b0\u306b\u51fa\u529b\u3059\u308bFilter\u30af\u30e9\u30b9\u3002 |\n| `CommonsRequestLoggingFilter` | \u30ea\u30af\u30a8\u30b9\u30c8\u30c7\u30fc\u30bf\u3092Apache Commons Logging(JCL)\u306eAPI\u7d4c\u7531\u3067\u30ed\u30b0\u306b\u51fa\u529b\u3059\u308bFilter\u30af\u30e9\u30b9\u3002 |\n| `ForwardedHeaderFilter` | `HttpServletRequest`\u306e`getServerName()`\u3001`getServerPort()`\u3001`getScheme()`\u3001`isSecure()`\u3001`getContextPath()`\u3001`getRequestURI()`\u3001`getRequestURL()`\u306e\u5024\u3092\u30ea\u30af\u30a8\u30b9\u30c8\u30d8\u30c3\u30c0\uff08`Forwarded`\u3084`X-Forwarded-*`\uff09\u304b\u3089\u53d6\u5f97\u3059\u308b\u3088\u3046\u306b\u3059\u308b\u305f\u3081\u306eFilter\u30af\u30e9\u30b9\u3002 \u203b Spring 4.3\u304b\u3089\u8ffd\u52a0 |\n\n\n# `HandlerInterceptor`\n\nSpring MVC\u306eAPI\u3067\u3042\u308b`org.springframework.web.servlet.HandlerInterceptor`\u30a4\u30f3\u30bf\u30d5\u30a7\u30fc\u30b9\u3092\u5b9f\u88c5\u3057\u305f\u30af\u30e9\u30b9\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\u4f5c\u6210\u3057\u305f\u30af\u30e9\u30b9\u3092Spring MVC\u306e\u30d5\u30ec\u30fc\u30e0\u30ef\u30fc\u30af\u6a5f\u80fd\u306b\u9069\u7528\u3059\u308b\u3068\u3001Handler\u30e1\u30bd\u30c3\u30c9\u306e\u547c\u3073\u51fa\u3057\u524d\u5f8c\u306b\u4efb\u610f\u306e\u51e6\u7406\u3092\u5b9f\u884c\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n![handlerInterceptor.png](https://qiita-image-store.s3.amazonaws.com/0/117313/c72169a7-3039-05f2-40a5-c83fe995c25a.png)\n\n\n```java\npackage com.example.component;\n\nimport org.springframework.web.servlet.HandlerInterceptor;\nimport org.springframework.web.servlet.ModelAndView;\n\nimport javax.servlet.http.HttpServletRequest;\nimport javax.servlet.http.HttpServletResponse;\n\npublic class CustomHandlerInterceptor implements HandlerInterceptor {\n\n    @Override\n    public boolean preHandle(HttpServletRequest request, HttpServletResponse response, Object handler) throws Exception {\n        // Handler\u30e1\u30bd\u30c3\u30c9\u304c\u547c\u3073\u51fa\u3055\u308c\u308b\u524d\u306b\u884c\u3046\u51e6\u7406\u3092\u5b9f\u88c5\u3059\u308b\n        // (\u5b9f\u88c5\u306f\u7701\u7565)\n\n        // Handler\u30e1\u30bd\u30c3\u30c9\u3092\u547c\u3073\u51fa\u3059\u5834\u5408\u306ftrue\u3092\u8fd4\u5374\u3059\u308b\n        return true;\n    }\n\n    @Override\n    public void postHandle(HttpServletRequest request, HttpServletResponse response, Object handler, ModelAndView modelAndView) throws Exception {\n        // Handler\u30e1\u30bd\u30c3\u30c9\u304c\u6b63\u5e38\u7d42\u4e86\u3057\u305f\u5f8c\u306b\u884c\u3046\u51e6\u7406\u3092\u5b9f\u88c5\u3059\u308b(\u4f8b\u5916\u304c\u767a\u751f\u3057\u305f\u5834\u5408\u306f\u3001\u3053\u306e\u30e1\u30bd\u30c3\u30c9\u306f\u547c\u3073\u51fa\u3055\u308c\u306a\u3044)\n        // (\u5b9f\u88c5\u306f\u7701\u7565)\n    }\n\n    @Override\n    public void afterCompletion(HttpServletRequest request, HttpServletResponse response, Object handler, Exception ex) throws Exception {\n        // Handler\u30e1\u30bd\u30c3\u30c9\u306e\u547c\u3073\u51fa\u3057\u304c\u5b8c\u4e86\u3057\u305f\u5f8c\u306b\u884c\u3046\u51e6\u7406\u3092\u5b9f\u88c5\u3059\u308b(\u4f8b\u5916\u304c\u767a\u751f\u3057\u3066\u3082\u3001\u3053\u306e\u30e1\u30bd\u30c3\u30c9\u306f\u547c\u3073\u51fa\u3055\u308c\u308b)\n        // (\u5b9f\u88c5\u306f\u7701\u7565)\n    }\n\n}\n```\n\n> **Note: \u5197\u9577\u306a\u7a7a\u5b9f\u88c5\u306e\u6392\u9664**\n> \u5b9f\u969b\u306b`HandlerInterceptor`\u3092\u4f5c\u6210\u3059\u308b\u5834\u5408\u306f\u3001`org.springframework.web.servlet.handler.HandlerInterceptorAdapter`\u3092\u7d99\u627f\u3057\u3066\u5fc5\u8981\u306a\u30e1\u30bd\u30c3\u30c9\u3060\u3051\u5b9f\u88c5\u3059\u308b\u3088\u3046\u306b\u3057\u307e\u3057\u3087\u3046\u3002\n>\n> ```java\n> public class CustomHandlerInterceptor extends HandlerInterceptorAdapter {\n>     // \u5fc5\u8981\u306a\u30e1\u30bd\u30c3\u30c9\u3060\u3051\u30aa\u30fc\u30d0\u30fc\u30e9\u30fc\u30c9\u3057\u3066\u5b9f\u88c5\u3059\u308b\n>     // ...\n> }\n> ```\n\n\n\u4f5c\u6210\u3057\u305f`HandlerInterceptor`\u3092Spring MVC\u306e\u30d5\u30ec\u30fc\u30e0\u30ef\u30fc\u30af\u6a5f\u80fd\u306b\u9069\u7528\u3057\u307e\u3059\u3002\n\n```java\n@Configuration\n@EnableWebMvc // \u6ce8\u610f\uff1aSpring Boot\u306e\u5834\u5408\u306f\u3001@EnableWebMvc\u306f\u3064\u3051\u3061\u3083\u30c0\u30e1\uff01\uff01\npublic class WebMvcConfig extends WebMvcConfigurerAdapter {\n    @Override\n    public void addInterceptors(InterceptorRegistry registry) {\n        registry.addInterceptor(new CustomHandlerInterceptor())\n                .addPathPatterns(\"/**\") // \u9069\u7528\u5bfe\u8c61\u306e\u30d1\u30b9(\u30d1\u30bf\u30fc\u30f3)\u3092\u6307\u5b9a\u3059\u308b\n                .excludePathPatterns(\"/static/**\"); // \u9664\u5916\u3059\u308b\u30d1\u30b9(\u30d1\u30bf\u30fc\u30f3)\u3092\u6307\u5b9a\u3059\u308b\n    }\n}\n```\n\n\u9069\u7528\u5bfe\u8c61\u306e\u30d1\u30b9\u3084\u9664\u5916\u30d1\u30b9\u306b\u306f\u3001Ant\u5f62\u5f0f\u306e\u30d1\u30b9\u30d1\u30bf\u30fc\u30f3\u304c\u5229\u7528\u3067\u304d\u308b\u305f\u3081\u3001\u30b5\u30fc\u30d6\u30ec\u30c3\u30c8\u30d5\u30a3\u30eb\u30bf\u30fc\u306b\u6bd4\u3079\u3066\u67d4\u8edf\u306b\u51e6\u7406\u306e\u9069\u7528\u5bfe\u8c61\u3092\u6307\u5b9a\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n> **Warning: Spring Boot\u3067WebMvcConfigurerAdapter\u3092\u5229\u7528\u3059\u308b\u969b\u306e\u6ce8\u610f\u70b9**\n>\n> Spring Boot\u3067`WebMvcConfigurerAdapter`\u306e\u5b50\u30af\u30e9\u30b9\u3092\u4f5c\u6210\u3059\u308b\u5834\u5408\u306f\u3001`@EnableWebMvc`\u306f\u7d76\u5bfe\u306b\u3064\u3051\u306a\u3044\u3067\u304f\u3060\u3055\u3044\u3002`@EnableWebMvc`\u3092\u3064\u3051\u3066\u3057\u307e\u3046\u3068\u3001Spring Boot\u306eAutoConfigure\u306e\u30b3\u30f3\u30d5\u30a3\u30ae\u30e5\u30ec\u30fc\u30b7\u30e7\u30f3\u304c\u4e00\u90e8\u7121\u52b9\u306b\u306a\u3063\u3066\u3057\u307e\u3044\u307e\u3059\u3002\u3053\u308c\u306f[Spring Boot\u306e\u30ea\u30d5\u30a1\u30ec\u30f3\u30b9](http://docs.spring.io/spring-boot/docs/1.3.5.RELEASE/reference/htmlsingle/#boot-features-spring-mvc-auto-configuration)\u306b\u3082\u8a18\u8ff0\u3055\u308c\u3066\u3044\u307e\u3059\u3002\n\n\n## Spring\u63d0\u4f9b\u306e`HandlerInterceptor`\u306e\u5b9f\u88c5\u30af\u30e9\u30b9\n\nSpring MVC\u63d0\u4f9b\u306e`HandlerInterceptor`\u306e\u5b9f\u88c5\u30af\u30e9\u30b9\u306f\u4ee5\u4e0b\u306e\u3068\u304a\u308a\u3067\u3059\u3002\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u8981\u4ef6\u306b\u5fdc\u3058\u3066\u4f7f\u7528\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n| \u30af\u30e9\u30b9 | \u8aac\u660e | \n| ----- | ---- |\n| `LocaleChangeInterceptor` | Locale\u3092UI\u64cd\u4f5c(\u30ea\u30af\u30a8\u30b9\u30c8\u30d1\u30e9\u30e1\u30fc\u30bf)\u3067\u5909\u66f4\u3059\u308b\u6a5f\u80fd\u3092\u5b9f\u88c5\u3059\u308b\u969b\u306b\u5229\u7528\u3059\u308b\u30af\u30e9\u30b9\u3002 `LocaleResolver`\u3068\u9023\u643a\u3057\u3066\u4f7f\u7528\u3057\u307e\u3059\u3002|\n| `ThemeChangeInterceptor` | Theme\u3092UI\u64cd\u4f5c(\u30ea\u30af\u30a8\u30b9\u30c8\u30d1\u30e9\u30e1\u30fc\u30bf)\u3067\u5909\u66f4\u3059\u308b\u6a5f\u80fd\u3092\u5b9f\u88c5\u3059\u308b\u969b\u306b\u4f7f\u7528\u3059\u308b\u30af\u30e9\u30b9\u3002 `ThemeResolver`\u3068\u9023\u643a\u3057\u3066\u4f7f\u7528\u3057\u307e\u3059\u3002|\n| `WebContentInterceptor` | \u30ea\u30bd\u30fc\u30b9\u306e\u30d1\u30b9\u30d1\u30bf\u30fc\u30f3\u6bce\u306bHTTP\u306e\u30ad\u30e3\u30c3\u30b7\u30e5\u5236\u5fa1\u7528\u306e\u30ec\u30b9\u30dd\u30f3\u30b9\u30d8\u30c3\u30c0\u30fc\u3092\u4ed8\u4e0e\u3057\u305f\u3044\u5834\u5408\u306b\u4f7f\u7528\u3059\u308b\u30af\u30e9\u30b9\u3002\u9759\u7684\u30ea\u30bd\u30fc\u30b9\u306e\u30ad\u30e3\u30c3\u30b7\u30e5\u5236\u5fa1\u306b\u3064\u3044\u3066\u306f\u3001\u300c[Spring MVC(+Spring Boot)\u4e0a\u3067\u306e\u9759\u7684\u30ea\u30bd\u30fc\u30b9\u3078\u306e\u30a2\u30af\u30bb\u30b9\u3092\u7406\u89e3\u3059\u308b](http://qiita.com/kazuki43zoo/items/e12a72d4ac4de418ee37)\u300d\u3092\u3054\u89a7\u304f\u3060\u3055\u3044\u3002 |\n\n\n\n# `@ControllerAdvice`\n\n`@Controller`(`@RestController`)\u3092\u4ed8\u4e0e\u3057\u305f\u30af\u30e9\u30b9\u306b\u306f\u3001Handler\u30e1\u30bd\u30c3\u30c9(`@RequestMapping`\u3092\u4ed8\u4e0e\u3057\u305f\u30e1\u30bd\u30c3\u30c9)\u3068\u306f\u5225\u306b\u3001Controller\u5c02\u7528\u306e\u7279\u6b8a\u306a\u30e1\u30bd\u30c3\u30c9(`@InitBainder`\u30e1\u30bd\u30c3\u30c9\u3001`@ModelAttribute`\u30e1\u30bd\u30c3\u30c9\u3001`@ExceptionHandler`\u30e1\u30bd\u30c3\u30c9)\u3092\u5b9f\u88c5\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\u3053\u308c\u3089\u306e\u30e1\u30bd\u30c3\u30c9\u3092\u8907\u6570\u306eController\u30af\u30e9\u30b9\u3067\u5171\u6709\u3057\u305f\u3044\u5834\u5408\u306f\u3001`@ControllerAdvice`\u306e\u4ed5\u7d44\u307f\u3092\u4f7f\u7528\u3057\u307e\u3059\u3002\n\n| \u30e1\u30bd\u30c3\u30c9 | \u8aac\u660e |\n| ------ | ---- |\n| `@InitBinder`\u30e1\u30bd\u30c3\u30c9 | `WebDataBinder`\u30aa\u30d6\u30b8\u30a7\u30af\u30c8(\u30ea\u30af\u30a8\u30b9\u30c8\u30c7\u30fc\u30bf\u3092Java\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306b\u30d0\u30a4\u30f3\u30c9\u3059\u308b\u305f\u3081\u306e\u30aa\u30d6\u30b8\u30a7\u30af\u30c8)\u3092\u30ab\u30b9\u30bf\u30de\u30a4\u30ba\u3059\u308b\u305f\u3081\u306e\u30e1\u30bd\u30c3\u30c9\u3002\u578b\u5909\u63db\u3001\u30d5\u30a9\u30fc\u30de\u30c3\u30c6\u30a3\u30f3\u30b0\u3001\u30d0\u30ea\u30c7\u30fc\u30b7\u30e7\u30f3\u306a\u3069\u3092\u30ab\u30b9\u30bf\u30de\u30a4\u30ba\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002 |\n| `@ModelAttribute`\u30e1\u30bd\u30c3\u30c9 | `Model`\u306b\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u683c\u7d0d\u3059\u308b\u305f\u3081\u306e\u30e1\u30bd\u30c3\u30c9\u3002Handler\u30e1\u30bd\u30c3\u30c9\u5b9f\u884c\u524d\u306b\u547c\u3073\u51fa\u3055\u308c\u3001\u8fd4\u5374\u3057\u305f\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306f`Model`\u306b\u683c\u7d0d\u3055\u308c\u307e\u3059\u3002 |\n| `@ExceptionHandler`\u30e1\u30bd\u30c3\u30c9 | \u4f8b\u5916\u3092\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0\u3059\u308b\u305f\u3081\u306e\u30e1\u30bd\u30c3\u30c9\u3002 |\n\n\n![controllerAdvice.png](https://qiita-image-store.s3.amazonaws.com/0/117313/f3e8387e-119c-740c-b08f-757dacac484c.png)\n\n\n```java\npackage com.example.component;\n\nimport org.slf4j.Logger;\nimport org.slf4j.LoggerFactory;\nimport org.springframework.beans.propertyeditors.StringTrimmerEditor;\nimport org.springframework.http.HttpStatus;\nimport org.springframework.web.bind.WebDataBinder;\nimport org.springframework.web.bind.annotation.*;\n\nimport java.util.Optional;\nimport java.util.UUID;\n\n@ControllerAdvice // \u30af\u30e9\u30b9\u30ec\u30d9\u30eb\u306b@ControllerAdvice\u3092\u6307\u5b9a\u3059\u308b\npublic class CustomControllerAdvice {\n\n    private static final Logger logger = LoggerFactory.getLogger(CustomControllerAdvice.class);\n\n    @InitBinder\n    public void initBinder(WebDataBinder dataBinder) {\n        // WebDataBinder\u306e\u30e1\u30bd\u30c3\u30c9\u3092\u547c\u3073\u51fa\u3057\u3066\u30ab\u30b9\u30bf\u30de\u30a4\u30ba\u3059\u308b\n        dataBinder.registerCustomEditor(String.class, new StringTrimmerEditor(true));\n    }\n\n    @ModelAttribute(\"trackingId\")\n    public String addOneObject(@RequestHeader(\"X-Tracking-Id\") Optional<String> trackingId) {\n        // Model\u306b\u8ffd\u52a0\u3059\u308b\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u8fd4\u5374\u3059\u308b\n        return trackingId.orElse(UUID.randomUUID().toString());\n    }\n\n    @ExceptionHandler\n    @ResponseStatus(HttpStatus.INTERNAL_SERVER_ERROR)\n    public String handleSystemException(Exception e) {\n        // \u4f8b\u5916\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0\u3092\u884c\u3046\n        logger.error(\"System Error occurred.\", e);\n        return \"error/system\";\n    }\n\n}\n```\n\n`@ControllerAdvice`\u306e\u5c5e\u6027\u3092\u3059\u3079\u3066\u7701\u7565\u3057\u305f\u5834\u5408\u306f\u3001\u3059\u3079\u3066\u306eController\u30af\u30e9\u30b9\u306b\u9069\u7528\u3055\u308c\u307e\u3059\u3002\u9069\u7528\u5bfe\u8c61\u3092\u7d5e\u308a\u8fbc\u307f\u305f\u3044\u5834\u5408\u306f\u3001\u300c\u30d9\u30fc\u30b9\u30d1\u30c3\u30b1\u30fc\u30b8(`basePackages`\u3001`basePackageClasses`\u5c5e\u6027)\u300d\u300c\u30de\u30fc\u30ab\u30fc\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9(`assignableTypes`\u5c5e\u6027)\u300d\u300c\u30de\u30fc\u30ab\u30fc\u30a2\u30ce\u30c6\u30fc\u30b7\u30e7\u30f3(`annotations`\u5c5e\u6027)\u300d\u3092\u4f7f\u7528\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n> **Note: `@ModelAttribute`\u30e1\u30bd\u30c3\u30c9\u306e\u30b7\u30b0\u30cd\u30c1\u30e3**\n> `@ModelAttribute`\u30e1\u30bd\u30c3\u30c9\u306e\u8fd4\u308a\u5024\u3092`void`\u306b\u3057\u3001\u5f15\u6570\u3067\u53d7\u3051\u53d6\u3063\u305f`Model`\u306b\u76f4\u63a5\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u8ffd\u52a0\u3059\u308b\u3053\u3068\u3082\u3067\u304d\u307e\u3059\u3002\u3053\u308c\u306f\u3001\u3072\u3068\u3064\u306e\u30e1\u30bd\u30c3\u30c9\u3067\u8907\u6570\u306e\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092`Model`\u306b\u8ffd\u52a0\u3057\u305f\u3044\u5834\u5408\u306b\u4f7f\u3048\u307e\u3059\u3002\n>\n> ```java\n> @ModelAttribute\n> public void addSomeObjects(@RequestHeader(\"X-Tracking-Id\") Optional<String> trackingId, Model model) {\n>     // Model\u306b\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u8ffd\u52a0\u3059\u308b\n>     model.addAttribute(\"trackingId\", trackingId.orElse(UUID.randomUUID().toString()));\n>     // ...\n> }\n> ```\n\n\n# Spring AOP with AspectJ\n\nSpring\u306eDI\u30b3\u30f3\u30c6\u30ca\u3067\u7ba1\u7406\u3055\u308c\u3066\u3044\u308bBean\u306epublic\u30e1\u30bd\u30c3\u30c9\u306e\u547c\u3073\u51fa\u3057\u524d\u5f8c\u306b\u5171\u901a\u51e6\u7406\u3092\u5b9f\u884c\u3057\u305f\u3044\u5834\u5408\u306f\u3001Spring AOP\u306eAdvice\u3092\u5b9f\u88c5\u3057\u307e\u3059\u3002Spring AOP\u3067\u5b9f\u88c5\u3067\u304d\u308bAdvice\u306f\u4ee5\u4e0b\u306e5\u7a2e\u985e\u3067\u3059\u3002\n\n> **Note: Advice\u3068\u306f**\n> Join Point\u306b\u5bfe\u3057\u3066\u7279\u5b9a\u306e\u30bf\u30a4\u30df\u30f3\u30b0\u3067\u5b9f\u884c\u3059\u308b\u6a2a\u65ad\u7684\u306a\u95a2\u5fc3\u4e8b(\u5171\u901a\u51e6\u7406)\u306e\u3053\u3068\u3067\u3059\u3002 \n> **Note: Join Point\u3068\u306f**\n> \u6a2a\u65ad\u7684\u306a\u95a2\u5fc3\u4e8b(\u5171\u901a\u51e6\u7406)\u3092\u9069\u7528\u3059\u308b\u30dd\u30a4\u30f3\u30c8\u306e\u3053\u3068\u3067\u3059\u3002 Spring AOP\u306eJoin Point\u306f\u300c**\u30e1\u30bd\u30c3\u30c9\u306e\u5b9f\u884c\u6642**\u300d\u3067\u3059\u3002\n\n| Advice | \u8aac\u660e |\n| ------ | ---- |\n| Before | Join Point\u306e\u524d\u306b\u5b9f\u884c\u3059\u308bAdvice\u3002Join Point\u3078\u51e6\u7406\u304c\u6d41\u308c\u306a\u3044\u3088\u3046\u306b\u3057\u305f\u3044\u5834\u5408\u306f\u3001\u4f8b\u5916\u306e\u30b9\u30ed\u30fc\u3057\u307e\u3059\u3002|\n| AfterReturning | Join Point\u304c\u6b63\u5e38\u7d42\u4e86\u3057\u305f\u5f8c\u306b\u5b9f\u884c\u3059\u308bAdvice\u3002Join Point\u3067\u4f8b\u5916\u304c\u767a\u751f\u3057\u305f\u5834\u5408\u306f\u3001\u3053\u306eAdvice\u306f\u5b9f\u884c\u3055\u308c\u307e\u305b\u3093\u3002|\n| AfterThrowing | Join Point\u304b\u3089\u4f8b\u5916\u304c\u30b9\u30ed\u30fc\u3055\u308c\u305f\u5f8c\u306b\u5b9f\u884c\u3059\u308bAdvice\u3002Join Point\u304c\u6b63\u5e38\u7d42\u4e86\u3057\u305f\u5834\u5408\u306f\u3001\u3053\u306eAdvice\u306f\u5b9f\u884c\u3055\u308c\u307e\u305b\u3093\u3002|\n| After | Join Point\u306e\u5f8c\u306b\u5b9f\u884c\u3059\u308bAdvice\u3002Join Point\u306e\u6b63\u5e38\u7d42\u4e86\u3084\u4f8b\u5916\u306e\u30b9\u30ed\u30fc\u306b\u95a2\u4fc2\u306a\u304f\u5e38\u306b\u5b9f\u884c\u3055\u308c\u307e\u3059\u3002|\n| Around | Join Point\u306e\u524d\u5f8c\u3067\u5b9f\u884c\u3059\u308bAdvice\u3002\u5171\u901a\u51e6\u7406\u3092\u5b9f\u884c\u3059\u308b\u30bf\u30a4\u30df\u30f3\u30b0\u306a\u3069\u3092\u5b8c\u5168\u306b\u30b3\u30f3\u30c8\u30ed\u30fc\u30eb\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002|\n\n\u5404Advice\u304c\u5b9f\u884c\u3055\u308c\u308b\u30bf\u30a4\u30df\u30f3\u30b0\u3092\u56f3\u3067\u8868\u3059\u3068\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\n\n![aopAdvice.png](https://qiita-image-store.s3.amazonaws.com/0/117313/a3ba9fb2-7644-7846-9444-54b5c7777f17.png)\n\nAround Advice\u3092\u4f7f\u3046\u3068Before, AfterReturning, AfterThrowing, After\u3068\u540c\u3058\u3053\u3068\u3092\u5b9f\u73fe\u3067\u304d\u307e\u3059\u304c\u3001\u7528\u9014\u306b\u3042\u3063\u305fAdvice\u3092\u4f7f\u3046\u3088\u3046\u306b\u3057\u307e\u3057\u3087\u3046\u3002\n\n## Spring AOP\u3068\u306f\n\nSpring Framework\u306f\u3001AOP\u3092\u5b9f\u73fe\u3059\u308b\u30b5\u30d6\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3068\u3057\u3066Spring AOP\u3092\u63d0\u4f9b\u3057\u3066\u3044\u307e\u3059\u3002 Spring AOP\u3067\u306f\u3001DI\u30b3\u30f3\u30c6\u30ca\u306b\u7ba1\u7406\u3055\u308c\u3066\u3044\u308bBean\u3092Target\u3068\u3057\u3066Advice\u3092\u57cb\u3081\u8fbc\u3080\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002Spring AOP\u306f\u3001\u6700\u3082\u6709\u540d\u306aAOP\u30d5\u30ec\u30fc\u30e0\u30ef\u30fc\u30af\u3067\u3042\u308bAspectJ\u3092\u5229\u7528\u3057\u3066\u304a\u308a\u3001AspectJ\u304c\u63d0\u4f9b\u3059\u308b\u30a2\u30ce\u30c6\u30fc\u30b7\u30e7\u30f3\u3084PointCut\u306e\u5f0f\u8a00\u8a9e\u3092\u5229\u7528\u3057\u3066\u3044\u307e\u3059\u3002\n\n> **Note: PointCut\u3068\u306f**\n> Advice\u3092\u5b9f\u884c\u3059\u308bJoin Point\u3092\u9078\u629e\u3059\u308b\u8868\u73fe(\u5f0f)\u306e\u3053\u3068\u3067\u3059\u3002\n> **Note: Weaving\u3068\u306f**\n> \u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u30b3\u30fc\u30c9\u306e\u9069\u5207\u306a\u30dd\u30a4\u30f3\u30c8\u306bAspect\u3092\u5165\u308c\u8fbc\u3080\u51e6\u7406\u306e\u3053\u3068\u3067\u3059\u3002AspectJ\u3067\u306fWeaving\u306e\u30e1\u30ab\u30cb\u30ba\u30e0\u3068\u3057\u3066\u3001\u30b3\u30f3\u30d1\u30a4\u30eb\u6642\u3001\u30af\u30e9\u30b9\u30ed\u30fc\u30c9\u6642\u3001\u5b9f\u884c\u6642\u304c\u30b5\u30dd\u30fc\u30c8\u3055\u308c\u3066\u3044\u307e\u3059\u304c\u3001 Spring AOP\u3067\u306fProxy\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u4f5c\u308b\u3053\u3068\u3067\u5b9f\u884c\u6642\u306eWeaving\u306e\u307f\u30b5\u30dd\u30fc\u30c8\u3057\u3066\u3044\u307e\u3059\u3002\n\n![aopProxy.png](https://qiita-image-store.s3.amazonaws.com/0/117313/67d2cd41-64a5-2507-0337-a1551ae91c25.png)\n\n\n## Spring AOP\u306e\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\n\nSpring AOP\u3092\u4f7f\u7528\u3059\u308b\u5834\u5408\u306f\u3001spring-aop\u30e2\u30b8\u30e5\u30fc\u30eb\u3068aspectjweaver\u304c\u5fc5\u8981\u306b\u306a\u308a\u307e\u3059\u3002\n\n```xml:pom.xml\n<dependency>\n    <groupId>org.springframework</groupId>\n    <artifactId>spring-aop</artifactId>\n    <version>4.3.3.RELESAE</version> <!-- \u6295\u7a3f\u6642\u306e\u6700\u65b0\u30d0\u30fc\u30b8\u30e7\u30f3 -->\n</dependency>\n<dependency>\n    <groupId>org.aspectj</groupId>\n    <artifactId>aspectjweaver</artifactId>\n    <version>1.8.9</version> <!-- \u6295\u7a3f\u6642\u306e\u6700\u65b0\u30d0\u30fc\u30b8\u30e7\u30f3 -->\n</dependency>\n```\n\nSpring AOP\u3092\u4f7f\u7528\u3059\u308b\u305f\u3081\u306b\u5fc5\u8981\u3068\u306a\u308bBean\u3092\u5b9a\u7fa9\u3057\u307e\u3059\u3002Java Config\u306e\u5834\u5408\u306f\u3001\u30b3\u30f3\u30d5\u30a3\u30ae\u30e5\u30ec\u30fc\u30b7\u30e7\u30f3\u30af\u30e9\u30b9\u306b`@org.springframework.context.annotation.EnableAspectJAutoProxy`\u3092\u4ed8\u4e0e\u3059\u308b\u3060\u3051\u3067\u3059\u3002\n\n```java\n@Configuration\n@ComponentScan(\"com.example.component\")\n@EnableAspectJAutoProxy\npublic class AppConfig {\n    // ...\n}\n```\n\nSpring AOP\u306fProxy\u3092\u751f\u6210\u3057\u3066Aspect\u3092Weaving\u3057\u307e\u3059\u304c\u3001\u5bfe\u8c61\u3068\u306a\u308b\u30af\u30e9\u30b9\u306e\u72b6\u614b\u306b\u3088\u3063\u3066Proxy\u751f\u6210\u306b\u4f7f\u7528\u3055\u308c\u308b\u4ed5\u7d44\u307f\u304c\u7570\u306a\u308a\u307e\u3059\u3002\n\n* \u5bfe\u8c61\u304c\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9\u3092\u5b9f\u88c5\u3057\u3066\u3044\u308c\u3070JDK\u306eProxy\u306e\u4ed5\u7d44\u307f\n* \u5bfe\u8c61\u304c\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9\u3092\u5b9f\u88c5\u3057\u3066\u3044\u306a\u3051\u308c\u3070CGLIB\u306eProxy\u306e\u4ed5\u7d44\u307f\n\nCGLIB\u306e\u4ed5\u7d44\u307f\u3092\u4f7f\u3063\u3066Proxy\u3092\u4f5c\u308b\u3053\u3068\u3092\u5f37\u5236\u3057\u305f\u3044\u5834\u5408\u306f\u3001`proxyTargetClass`\u5c5e\u6027\u3092`true`\u306b\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n```java\n// ...\n@EnableAspectJAutoProxy(proxyTargetClass = true)\npublic class AppConfig {\n    // ...\n}\n```\n\n\n\n## \u5bfe\u8c61\u30af\u30e9\u30b9\u306e\u4f5c\u6210\n\n\u307e\u305a\u3001Advice\u3092\u57cb\u3081\u8fbc\u3080\u5bfe\u8c61\u3068\u306a\u308b\u30af\u30e9\u30b9\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\u3053\u3053\u3067\u306f\u3001\u6b63\u5e38\u7d42\u4e86\u3059\u308b\u30e1\u30bd\u30c3\u30c9\u3068\u4f8b\u5916\u304c\u767a\u751f\u3059\u308b\uff12\u3064\u306e\u30e1\u30bd\u30c3\u30c9\u3092\u5b9f\u88c5\u3057\u3066\u3044\u307e\u3059\u3002\n\n```java\npackage com.example.component;\n\nimport org.springframework.stereotype.Service;\n\n@Service\npublic class GreetingService {\n\n    public void goodMorning() {\n        System.out.println(\"Good Morning !!\");\n    }\n\n    public void failing() {\n        System.out.println(\"Failing !!\");\n        throw new UnsupportedOperationException();\n    }\n\n}\n```\n\n\u3064\u304e\u306b\u3001\u52d5\u4f5c\u78ba\u8a8d\u7528\u306bJUnit\u306e\u30c6\u30b9\u30c8\u30b1\u30fc\u30b9\u30af\u30e9\u30b9\u3068\u30c6\u30b9\u30c8\u30e1\u30bd\u30c3\u30c9\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\u3053\u3053\u3067\u306f\u3001Spring\u306eDI\u30b3\u30f3\u30c6\u30ca\u3068\u9023\u643a\u3059\u308b\u5fc5\u8981\u304c\u3042\u308b\u305f\u3081\u3001Spring Test\u304c\u63d0\u4f9b\u3057\u3066\u3044\u308bDI\u30b3\u30f3\u30c6\u30ca\u3068\u9023\u643a\u3059\u308b\u4ed5\u7d44\u307f\u3092\u5229\u7528\u3057\u307e\u3059\u3002\n\n```java\npackage com.example.component;\n\nimport org.junit.Test;\nimport org.junit.runner.RunWith;\nimport org.springframework.beans.factory.annotation.Autowired;\nimport org.springframework.test.context.ContextConfiguration;\nimport org.springframework.test.context.junit4.SpringRunner;\nimport springbook.component.GreetingService;\nimport springbook.config.AppConfig;\n\n@RunWith(SpringRunner.class)\n@ContextConfiguration(classes = AppConfig.class)\npublic class GreetingServiceTest {\n\n    @Autowired\n    GreetingService greetingService;\n\n    @Test\n    public void goodMorning() {\n        greetingService.goodMorning();\n    }\n\n    @Test(expected = UnsupportedOperationException.class)\n    public void failing() {\n        greetingService.failing();\n    }\n\n}\n```\n\n\u30c6\u30b9\u30c8\u30b1\u30fc\u30b9\u3092\u5b9f\u884c\u3059\u308b\u3068\u3001\u30b3\u30f3\u30bd\u30fc\u30eb\u306b\u4ee5\u4e0b\u306e\u5185\u5bb9\u304c\u8868\u793a\u3055\u308c\u307e\u3059\u3002\n\n\n```text:\u30b3\u30f3\u30bd\u30fc\u30eb\nGood Morning !!\nFailing !!\n```\n\n\u306a\u304a\u3001\u4e0a\u8a18\u306e\u30b3\u30fc\u30c9\u3092\u30b3\u30f3\u30d1\u30a4\u30eb\u3059\u308b\u305f\u3081\u306b\u306f\u3001\u4ee5\u4e0b\u306e\u30a2\u30fc\u30c6\u30a3\u30d5\u30a1\u30af\u30c8\u3092\u4f9d\u5b58\u30e9\u30a4\u30d6\u30e9\u30ea\u306b\u8ffd\u52a0\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\n\n```xml:pom.xml\n<dependency>\n    <groupId>junit</groupId>\n    <artifactId>junit</artifactId>\n    <version>4.12</version> <!-- \u6295\u7a3f\u6642\u306e\u6700\u65b0\u30d0\u30fc\u30b8\u30e7\u30f3 -->\n    <scope>test</scope>\n</dependency>\n<dependency>\n    <groupId>org.springframework</groupId>\n    <artifactId>spring-test</artifactId>\n    <version>4.3.3.RELEASE</version> <!-- \u6295\u7a3f\u6642\u306e\u6700\u65b0\u30d0\u30fc\u30b8\u30e7\u30f3 -->\n    <scope>test</scope>\n</dependency>\n```\n\n## Aspect\u30af\u30e9\u30b9\u306e\u4f5c\u6210\n\nAspect\u306f\u3001AOP\u306e\u5358\u4f4d\u3068\u306a\u308b\u6a2a\u65ad\u7684\u306a\u95a2\u5fc3\u4e8b\u3092\u793a\u3059\u30e2\u30b8\u30e5\u30fc\u30eb\u306e\u3053\u3068\u3067\u3059\u3002Spring AOP\u3067\u306f\u3001AspectJ\u306e`@org.aspectj.lang.annotation.Aspect`\u304c\u4ed8\u4e0e\u3055\u308c\u305f\u30af\u30e9\u30b9\u304cAspect\u3068\u3057\u3066\u8a8d\u8b58\u3055\u308c\u307e\u3059\u3002\n\n```java\npackage com.example.component;\n\nimport org.aspectj.lang.annotation.Aspect;\nimport org.springframework.stereotype.Component;\n\n@Component\n@Aspect\npublic class LoggingAspect {\n}\n```\n\n## Before Advice\u306e\u5b9f\u88c5\n\nBefore Advice\u306f\u3001`@org.aspectj.lang.annotation.Before`\u3092\u4ed8\u4e0e\u3057\u305f\u30e1\u30bd\u30c3\u30c9\u306b\u5b9f\u88c5\u3057\u307e\u3059\u3002\n\n```java\n@Before(\"execution(* *..*Service.*(..))\")\npublic void startLog(JoinPoint jp) {\n    System.out.println(\"@Before                   : \" + jp.getSignature());\n}\n```\n\n```text:\u30b3\u30f3\u30bd\u30fc\u30eb\n@Before                   : void springbook.component.GreetingService.goodMorning()\nGood Morning !!\nFailing !!\n```\n\n## AfterReturning Advice\u306e\u5b9f\u88c5\n\nAfterReturning Advice\u306f\u3001`@org.aspectj.lang.annotation.AfterReturning`\u3092\u4ed8\u4e0e\u3057\u305f\u30e1\u30bd\u30c3\u30c9\u306b\u5b9f\u88c5\u3057\u307e\u3059\u3002\n\n```java\n@AfterReturning(value = \"execution(* *..*Service.*(..))\", returning = \"ret\")\npublic void normalEndLog(JoinPoint jp, Object ret) {\n    System.out.println(\"@AfterReturning           : \" + jp.getSignature() + \" ret: \" + ret);\n}\n```\n\n```text:\u30b3\u30f3\u30bd\u30fc\u30eb\nGood Morning !!\n@AfterReturning           : void springbook.component.GreetingService.goodMorning() ret: null\nFailing !!\n```\n\n## AfterThrowing Advice\u306e\u5b9f\u88c5\n\nAfterThrowing Advice\u306f\u3001`@org.aspectj.lang.annotation.AfterThrowing`\u3092\u4ed8\u4e0e\u3057\u305f\u30e1\u30bd\u30c3\u30c9\u306b\u5b9f\u88c5\u3057\u307e\u3059\u3002\n\n```java\n@AfterThrowing(value = \"execution(* *..*Service.*(..))\", throwing = \"t\")\npublic void failureEndLog(JoinPoint jp, Throwable t) {\n    System.out.println(\"@AfterThrowing            : \" + jp.getSignature() + \" t: \" + t);\n}\n```\n\n```text:\u30b3\u30f3\u30bd\u30fc\u30eb\nFailing !!\n@AfterThrowing            : void springbook.component.GreetingService.failing() t: java.lang.UnsupportedOperationException\n```\n\n## After Advice\u306e\u5b9f\u88c5\n\nBefore Advice\u306f\u3001`@org.aspectj.lang.annotation.After`\u3092\u4ed8\u4e0e\u3057\u305f\u30e1\u30bd\u30c3\u30c9\u306b\u5b9f\u88c5\u3057\u307e\u3059\u3002\n\n```java\n@After(\"execution(* *..*Service.*(..))\")\npublic void completeLog(JoinPoint jp) {\n    System.out.println(\"@After                    : \" + jp.getSignature());\n}\n```\n\n```text:\u30b3\u30f3\u30bd\u30fc\u30eb\nGood Morning !!\n@After                    : void springbook.component.GreetingService.goodMorning()\nFailing !!\n@AfterThrowing            : void springbook.component.GreetingService.failing() t: java.lang.UnsupportedOperationException\n```\n\n## Around Advice\n\nAround Advice\u306f\u3001`@org.aspectj.lang.annotation.Around`\u3092\u4ed8\u4e0e\u3057\u305f\u30e1\u30bd\u30c3\u30c9\u306b\u5b9f\u88c5\u3057\u307e\u3059\u3002\n\n```java\n@Around(\"execution(* *..*Service.*(..))\")\npublic Object aroundLog(ProceedingJoinPoint jp) throws Throwable {\n    Object ret;\n    try {\n        System.out.println(\"Before by @Around         : \" + jp.getSignature());\n        ret = jp.proceed();\n        System.out.println(\"AfterReturning by @Around : \" + jp.getSignature() + \" ret: \" + ret);\n    }catch (Throwable t) {\n        System.out.println(\"AfterThrowing by @Around  : \" + jp.getSignature() + \" t: \" + t);\n        throw t;\n    } finally {\n        System.out.println(\"After by @Around          : \" + jp.getSignature());\n    }\n    return ret;\n}\n```\n\n```text:\u30b3\u30f3\u30bd\u30fc\u30eb(\u6b63\u5e38\u6642)\nBefore by @Around         : void springbook.component.GreetingService.goodMorning()\nGood Morning !!\nAfterReturning by @Around : void springbook.component.GreetingService.goodMorning() ret: null\nAfter by @Around          : void springbook.component.GreetingService.goodMorning()\n```\n\n```text:\u30b3\u30f3\u30bd\u30fc\u30eb(\u4f8b\u5916\u767a\u751f\u6642)\nBefore by @Around         : void springbook.component.GreetingService.failing()\nFailing !!\nAfterThrowing by @Around  : void springbook.component.GreetingService.failing() t: java.lang.UnsupportedOperationException\nAfter by @Around          : void springbook.component.GreetingService.failing()\n```\n\n## PointCut\u5f0f\n\nPointCut\u5f0f\u306f\u3001Join Point\u3092\u9078\u629e\u3059\u308b\u8868\u73fe\u306e\u3053\u3068\u3067\u3001\u4e0a\u8a18\u306e\u4f8b\u3060\u3068\u30a2\u30ce\u30c6\u30fc\u30b7\u30e7\u30f3\u306e`value`\u5c5e\u6027\u306b\u6307\u5b9a\u3057\u3066\u3044\u308b\u300c`\"execution(* *..*Service.*(..))\"`\u300d\u304cPointCut\u5f0f\u306b\u306a\u308a\u307e\u3059\u3002AspectJ\u3067\u306f\u69d8\u3005\u306a\u5f0f\u3092\u7528\u3044\u3066JoinPoint\u3092\u9078\u629e\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u3001Spring AOP\u3067\u3082AspectJ\u306ePointCut\u5f0f\u306e\u591a\u304f\u3092\u30b5\u30dd\u30fc\u30c8\u3057\u3066\u3044\u307e\u3059\u3002\nPointCut\u5f0f\u306b\u306f\u3001\u30de\u30c3\u30c1\u30f3\u30b0\u65b9\u6cd5\u6bce\u306b\u6307\u793a\u5b50(designator)\u304c\u7528\u610f\u3055\u308c\u3066\u304a\u308a\u3001\u305d\u308c\u305e\u308c\u66f8\u5f0f\u304c\u7570\u306a\u308a\u307e\u3059\u3002 \n\nSpring AOP\u3067\u30b5\u30dd\u30fc\u30c8\u3055\u308c\u3066\u3044\u308b\u6307\u793a\u5b50\u306f\u4ee5\u4e0b\u306e\u3068\u304a\u308a\u3067\u3059\u3002\n\n| \u6307\u793a\u5b50 | \u8aac\u660e |\n| ------ | --- |\n| `execution` | \u6307\u5b9a\u3057\u305f\u30e1\u30bd\u30c3\u30c9(\u30d1\u30bf\u30fc\u30f3)\u306b\u4e00\u81f4\u3059\u308b\u30e1\u30bd\u30c3\u30c9\u3092JoinPoint\u3068\u3057\u3066\u9078\u629e\u3059\u308b\u3002 |\n| `within` | \u6307\u5b9a\u3057\u305f\u30af\u30e9\u30b9(\u30d1\u30bf\u30fc\u30f3)\u306b\u4e00\u81f4\u3059\u308bBean\u304c\u4fdd\u6301\u3059\u308b\u30e1\u30bd\u30c3\u30c9\u3092JoinPoint\u3068\u3057\u3066\u9078\u629e\u3059\u308b\u3002 |\n| `this` | \u6307\u5b9a\u3057\u305f\u30bf\u30a4\u30d7(\u30af\u30e9\u30b9\u3001\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9)\u306b\u4e00\u81f4\u3059\u308bBean\u3078\u306eProxy\u304c\u4fdd\u6301\u3059\u308b\u30e1\u30bd\u30c3\u30c9\u3092JoinPoint\u3068\u3057\u3066\u9078\u629e\u3059\u308b\u3002 |\n| `target` | \u6307\u5b9a\u3057\u305f\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9(\u30af\u30e9\u30b9\u3001\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9)\u306b\u4e00\u81f4\u3059\u308bBean\u304c\u4fdd\u6301\u3059\u308b\u30e1\u30bd\u30c3\u30c9\u3092JoinPoint\u3068\u3057\u3066\u9078\u629e\u3059\u308b\u3002 |\n| `args` | \u6307\u5b9a\u3057\u305f\u30bf\u30a4\u30d7\u304c\u5f15\u6570\u306b\u5ba3\u8a00\u3055\u308c\u3066\u3044\u308b\u30e1\u30bd\u30c3\u30c9\u3092JoinPoint\u3068\u3057\u3066\u9078\u629e\u3059\u308b\u3002 |\n| `@within` | \u6307\u5b9a\u3057\u305f\u30a2\u30ce\u30c6\u30fc\u30b7\u30e7\u30f3\u304c\u4ed8\u4e0e\u3055\u308c\u305f\u30af\u30e9\u30b9\u304c\u4fdd\u6301\u3059\u308b\u30e1\u30bd\u30c3\u30c9\u3092JoinPoint\u3068\u3057\u3066\u9078\u629e\u3059\u308b\u3002 |\n| `@annotation` | \u6307\u5b9a\u3057\u305f\u30a2\u30ce\u30c6\u30fc\u30b7\u30e7\u30f3\u304c\u30e1\u30bd\u30c3\u30c9\u306b\u4ed8\u4e0e\u3055\u308c\u3066\u3044\u308b\u30e1\u30bd\u30c3\u30c9\u3092JoinPoint\u3068\u3057\u3066\u9078\u629e\u3059\u308b\u3002 |\n| `@args` | \u6307\u5b9a\u3057\u305f\u30a2\u30ce\u30c6\u30fc\u30b7\u30e7\u30f3\u3092\u4fdd\u6301\u3059\u308b\u30bf\u30a4\u30d7\u304c\u5f15\u6570\u306b\u5ba3\u8a00\u3055\u308c\u3066\u3044\u308b\u30e1\u30bd\u30c3\u30c9\u3092JoinPoint\u3068\u3057\u3066\u9078\u629e\u3059\u308b\u3002 |\n| `bean` | \u6307\u5b9a\u3057\u305fbean\u540d\u306b\u4e00\u81f4\u3059\u308bBean\u304c\u4fdd\u6301\u3059\u308b\u30e1\u30bd\u30c3\u30c9\u3092JoinPoint\u3068\u3057\u3066\u9078\u629e\u3059\u308b\u3002 Spring AOP\u306e\u307f\u3067\u4f7f\u7528\u3067\u304d\u308b\u6307\u793a\u5b50\u3002 |\n\n\u5404\u6307\u793a\u5b50\u306e\u66f8\u5f0f\u3084\u6307\u5b9a\u4f8b\u306f\u3001 [Spring Framework\u306e\u516c\u5f0f\u30ea\u30d5\u30a1\u30ec\u30f3\u30b9](http://docs.spring.io/spring/docs/current/spring-framework-reference/htmlsingle/#aop-pointcuts)\u3092\u53c2\u7167\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n\n# Spring Boot\u4e0a\u3067\u306e\u5171\u901a\u51e6\u7406\u306e\u5b9f\u88c5\n\n\u3053\u3053\u3067\u306f\u3001Spring Boot Starter Web\u3092\u30d9\u30fc\u30b9\u306b\u3001Spring Boot\u56fa\u6709\u306e\u4ed5\u7d44\u307f\u3084\u5b9f\u88c5\u65b9\u6cd5\u306b\u3064\u3044\u3066\u8aac\u660e\u3057\u307e\u3059\u3002\nSpring Boot\u306f\u3001Spring-Boot\u5411\u3051\u306e\u958b\u767a\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092\u751f\u6210\u3059\u308b\u305f\u3081\u306eWeb Service\u300c[SPRING INITIALIZR](https://start.spring.io/)\u300d\u3092\u63d0\u4f9b\u3057\u3066\u3044\u307e\u3059\u3002\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306e\u4f5c\u6210\u65b9\u6cd5\u306f\u3001[\u3053\u3061\u3089](http://qiita.com/kazuki43zoo/items/ea79e206d7c2e990e478#%E9%96%8B%E7%99%BA%E3%83%97%E3%83%AD%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E3%81%AE%E4%BD%9C%E6%88%90)\u3092\u3054\u89a7\u304f\u3060\u3055\u3044(\u306a\u304a\u3001Dependencies\u306f\u300cWeb\u300d\u306b\u3001\u30d0\u30fc\u30b8\u30e7\u30f3\u306f\u6700\u65b0\u30d0\u30fc\u30b8\u30e7\u30f3\u306b\u8aad\u307f\u66ff\u3048\u3066\u304f\u3060\u3055\u3044)\u3002\n\n## `javax.servlet.ServletRequestListener`\n\n### Spring\u30843rd\u30d1\u30fc\u30c6\u30a3\u88fd\u306e`ServletRequestListener`\u306e\u767b\u9332\n\nBean\u5b9a\u7fa9\u30d5\u30a1\u30a4\u30eb\u3092\u4f7f\u7528\u3057\u3066DI\u30b3\u30f3\u30c6\u30ca\u306b\u767b\u9332\u3057\u307e\u3059\u3002\n\n```java\n@Bean\npublic RequestContextListener requestContextListener(){\n    return new RequestContextListener();\n}\n```\n\n3rd\u30d1\u30fc\u30c6\u30a3\u88fd\u306e`ServletRequestListener`\u306b`@javax.servlet.annotation.WebListener`\u304c\u4ed8\u4e0e\u3055\u308c\u3066\u3044\u308b\u5834\u5408\u306f\u3001`@org.springframework.boot.web.servlet.ServletComponentScan`\u3092\u4f7f\u7528\u3059\u308b\u3053\u3068\u3082\u3067\u304d\u307e\u3059\u3002\n\n```java\n@SpringBootApplication\n@ServletComponentScan\npublic class WebDemoApplication {\n   // ....\n}\n```\n\n### \u81ea\u4f5c\u306e`ServletRequestListener`\u306e\u767b\u9332\n\n`@Component`\u3092\u4ed8\u4e0e\u3057\u305f`ServletRequestListener`\u30af\u30e9\u30b9\u3092\u4f5c\u6210\u3059\u308b\u306e\u304c\u4e00\u756a\u7c21\u5358\u3067\u3057\u3087\u3046\u3002\u9069\u7528\u9806\u5e8f\u3082`@org.springframework.core.annotation.Order`\u3067\u6307\u5b9a\u3067\u304d\u307e\u3059(\u3082\u3057\u304f\u306f\u3001`org.springframework.core.Ordered`\u30a4\u30f3\u30bf\u30d5\u30a7\u30fc\u30b9\u3092\u5b9f\u88c5\u3057\u3066\u6307\u5b9a\u3059\u308b)\u3002\n\n```java\n@Component\n@Order(Ordered.HIGHEST_PRECEDENCE) // \u5fc5\u8981\u306b\u5fdc\u3058\u3066\u512a\u5148\u5ea6\u3092\u6307\u5b9a\u3002\u512a\u5148\u5ea6\u304c\u9ad8\u3044\u65b9\u304c\u5148\u306b\u9069\u7528\u3055\u308c\u308b\u3002\npublic class CustomServletRequestListener implements ServletRequestListener {\n    // ...\n}\n```\n\n\u3082\u3061\u308d\u3093`@Bean`\u3084`@ServletComponentScan`\u3092\u4f7f\u7528\u3057\u3066DI\u30b3\u30f3\u30c6\u30ca\u306b\u767b\u9332\u3059\u308b\u3053\u3068\u3082\u3067\u304d\u307e\u3059\u3002\n\n\n## `javax.servlet.Filter`\n\n## Spring Boot\u63d0\u4f9b\u306eFilter\u30af\u30e9\u30b9\n\nSpring Boot\u63d0\u4f9b\u306eFilter\u30af\u30e9\u30b9\u306f\u4ee5\u4e0b\u306e\u3068\u304a\u308a\u3067\u3059\u3002\u306a\u304a\u3001\u9069\u7528\u9806\u5e8f\u3092\u5f37\u5236\u3059\u308b\u305f\u3081\u3060\u3051\u306b\u62e1\u5f35\u3057\u3066\u3044\u308b`OrderedXxxFilter`\u306e\u7d39\u4ecb\u306f\u5272\u611b\u3057\u307e\u3059\u3002\n\n| \u30af\u30e9\u30b9 | \u8aac\u660e | \n| ----- | ---- |\n| `ApplicationContextHeaderFilter` | \u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u30b3\u30f3\u30c6\u30ad\u30b9\u30c8\u306eID(`ApplicationContext#getId()`)\u3092\u30ec\u30b9\u30dd\u30f3\u30b9\u30d8\u30c3\u30c0(X-Application-Context)\u306b\u51fa\u529b\u3059\u308b\u305f\u3081\u306eFilter\u30af\u30e9\u30b9\u3002 \u203b Spring Boot 1.4\u304b\u3089\u8ffd\u52a0 |\n\n### \u81ea\u52d5\u767b\u9332\u3055\u308c\u308b`javax.servlet.Filter`\n\nSpring Boot\u306f\u3001\u81ea\u52d5\u30b3\u30f3\u30d5\u30a3\u30ae\u30e5\u30ec\u30fc\u30b7\u30e7\u30f3\u306b\u3088\u3063\u3066\u4ee5\u4e0b\u306e`Filter`\u304c\u767b\u9332\u3055\u308c\u307e\u3059\u3002\n\n| \u30af\u30e9\u30b9 | \u30de\u30c3\u30d4\u30f3\u30b0 | \n| ----- | ---- |\n| `CharacterEncodingFilter` | `/*` |\n| `HiddenHttpMethodFilter` | `/*` |\n| `HttpPutFormContentFilter` | `/*` |\n| `RequestContextFilter` | `/*` |\n\n\u767b\u9332\u3055\u308c\u305f`Filter`\u306f\u30b3\u30f3\u30bd\u30fc\u30eb\u30ed\u30b0\u3067\u78ba\u8a8d\u3067\u304d\u307e\u3059\u3002\n\n```text:\u30b3\u30f3\u30bd\u30fc\u30eb\n...\n2016-10-01 23:54:21.465  INFO 31029 --- [ost-startStop-1] o.s.b.w.servlet.FilterRegistrationBean   : Mapping filter: 'characterEncodingFilter' to: [/*]\n2016-10-01 23:54:21.465  INFO 31029 --- [ost-startStop-1] o.s.b.w.servlet.FilterRegistrationBean   : Mapping filter: 'hiddenHttpMethodFilter' to: [/*]\n2016-10-01 23:54:21.466  INFO 31029 --- [ost-startStop-1] o.s.b.w.servlet.FilterRegistrationBean   : Mapping filter: 'httpPutFormContentFilter' to: [/*]\n2016-10-01 23:54:21.466  INFO 31029 --- [ost-startStop-1] o.s.b.w.servlet.FilterRegistrationBean   : Mapping filter: 'requestContextFilter' to: [/*]\n...\n```\n\n`org.springframework.boot:spring-boot-starter-web`\u4ee5\u5916\u306estarter\u3084\u30e9\u30a4\u30d6\u30e9\u30ea\u3092\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306b\u8ffd\u52a0\u3057\u305f\u5834\u5408\u306f\u3001\u4e0a\u8a18\u4ee5\u5916\u306e`Filter`\u304c\u81ea\u52d5\u767b\u9332\u3055\u308c\u308b\u53ef\u80fd\u6027\u3082\u3042\u308a\u307e\u3059\u3002\n\n### `javax.servlet.Filter`\u306e\u767b\u9332\n\nSpring Boot\u306e\u81ea\u52d5\u30b3\u30f3\u30d5\u30a3\u30ae\u30e5\u30ec\u30fc\u30b7\u30e7\u30f3\u306b\u4ed5\u7d44\u307f\u3067\u767b\u9332\u3055\u308c\u306a\u3044`Filter`\u3084\u81ea\u4f5c\u306e`Filter`\u3092\u30b5\u30fc\u30d6\u30ec\u30c3\u30c8\u30b3\u30f3\u30c6\u30ca\u306b\u767b\u9332\u3059\u308b\u5834\u5408\u306f\u3001`Filter`\u30af\u30e9\u30b9\u3092DI\u30b3\u30f3\u30c6\u30ca\u306b\u767b\u9332\u3057\u307e\u3059\u3002\n\n### Spring\u30843rd\u30d1\u30fc\u30c6\u30a3\u88fd\u306e`Filter`\u306e\u767b\u9332\n\nBean\u5b9a\u7fa9\u30d5\u30a1\u30a4\u30eb\u3092\u4f7f\u7528\u3057\u3066DI\u30b3\u30f3\u30c6\u30ca\u306b\u767b\u9332\u3057\u307e\u3059\u3002\n\n```java\n@Bean\npublic CommonsRequestLoggingFilter commonsRequestLoggingFilter(){\n    return new CommonsRequestLoggingFilter();\n}\n```\n\n`Filter`\u306e\u9069\u7528\u9806\u5e8f\u306e\u6307\u5b9a\u3084\u7d30\u304b\u3044\u8a2d\u5b9a\u3092\u30ab\u30b9\u30bf\u30de\u30a4\u30ba\u3057\u305f\u3044\u5834\u5408\u306f\u3001`org.springframework.boot.context.embedded.FilterRegistrationBean`\u3092\u4f7f\u7528\u3057\u3066DI\u30b3\u30f3\u30c6\u30ca\u306b\u767b\u9332\u3057\u307e\u3059\u3002\n\n```java\n@Bean\npublic FilterRegistrationBean commonsRequestLoggingFilter(){\nFilterRegistrationBean registrationBean = new FilterRegistrationBean(new CommonsRequestLoggingFilter());\n    registrationBean.setOrder(Ordered.HIGHEST_PRECEDENCE); // \u512a\u5148\u5ea6\u3092\u6307\u5b9a\u3002\u512a\u5148\u5ea6\u304c\u9ad8\u3044\u65b9\u304c\u5148\u306b\u9069\u7528\u3055\u308c\u308b\u3002\n    return registrationBean;\n}\n```\n\n3rd\u30d1\u30fc\u30c6\u30a3\u88fd\u306e`Filter`\u306b`@javax.servlet.annotation.WebFilter`\u304c\u4ed8\u4e0e\u3055\u308c\u3066\u3044\u308b\u5834\u5408\u306f\u3001`@org.springframework.boot.web.servlet.ServletComponentScan`\u3092\u4f7f\u7528\u3059\u308b\u3053\u3068\u3082\u3067\u304d\u307e\u3059\u3002\n\n```java\n@SpringBootApplication\n@ServletComponentScan\npublic class WebDemoApplication {\n   // ....\n}\n```\n\n### \u81ea\u4f5c\u306e`Filter`\u306e\u767b\u9332\n\n`@Component`\u3092\u4ed8\u4e0e\u3057\u305f`Filter`\u30af\u30e9\u30b9\u3092\u4f5c\u6210\u3059\u308b\u306e\u304c\u4e00\u756a\u7c21\u5358\u3067\u3057\u3087\u3046\u3002\u9069\u7528\u9806\u5e8f\u3082`@org.springframework.core.annotation.Order`\u3067\u6307\u5b9a\u3067\u304d\u307e\u3059(\u3082\u3057\u304f\u306f\u3001`org.springframework.core.Ordered`\u30a4\u30f3\u30bf\u30d5\u30a7\u30fc\u30b9\u3092\u5b9f\u88c5\u3057\u3066\u6307\u5b9a\u3059\u308b)\u3002\n\n```java\n@Component\n@Order(Ordered.HIGHEST_PRECEDENCE) // \u5fc5\u8981\u306b\u5fdc\u3058\u3066\u512a\u5148\u5ea6\u3092\u6307\u5b9a\u3002\u512a\u5148\u5ea6\u304c\u9ad8\u3044\u65b9\u304c\u5148\u306b\u9069\u7528\u3055\u308c\u308b\u3002\npublic class CustomFilter implements Filter {\n    // ...\n}\n```\n\n\u3082\u3061\u308d\u3093`@Bean`(+`FilterRegistrationBean`)\u3084`@ServletComponentScan`\u3092\u4f7f\u7528\u3057\u3066DI\u30b3\u30f3\u30c6\u30ca\u306b\u767b\u9332\u3059\u308b\u3053\u3068\u3082\u3067\u304d\u307e\u3059\u3002\n\n### `CharacterEncodingFilter`\u306e\u30ab\u30b9\u30bf\u30de\u30a4\u30ba\n\nSpring Boot\u306e\u81ea\u52d5\u30b3\u30f3\u30d5\u30a3\u30ae\u30e5\u30ec\u30fc\u30b7\u30e7\u30f3\u3067\u306f\u3001`CharacterEncodingFilter`\u306e\u6587\u5b57\u30a8\u30f3\u30b3\u30fc\u30c7\u30a3\u30f3\u30b0\u306fUTF-8\u306b\u306a\u308a\u307e\u3059\u3002\u3053\u306e\u52d5\u4f5c\u3092\u5909\u66f4\u3057\u305f\u3044\u5834\u5408\u306f\u3001application.properties(or yml)\u306e\u6307\u5b9a\u3067\u5909\u66f4\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n```properties:src/main/resources/application.properties\n# CharacterEncodingFilter\u306e\u9069\u7528\u6709\u7121\u3092\u6307\u5b9a(\u30c7\u30d5\u30a9\u30eb\u30c8\u306f\u9069\u7528\u3059\u308b)\nspring.http.encoding.enabled=false\n# \u30a8\u30f3\u30b3\u30fc\u30c7\u30a3\u30f3\u30b0\u3092\u6307\u5b9a(\u30c7\u30d5\u30a9\u30eb\u30c8\u306fUTF-8)\nspring.http.encoding.charset=Windows-31J\n# \u30a8\u30f3\u30b3\u30fc\u30c7\u30a3\u30f3\u30b0\u306e\u9069\u7528\u3092\u5f37\u5236\u3059\u308b\u304b\u306e\u30c7\u30d5\u30a9\u5024\u3092\u6307\u5b9a\uff08\u30ea\u30af\u30a8\u30b9\u30c8\uff0f\u30ec\u30b9\u30dd\u30f3\u30b9\u6bce\u306e\u6307\u5b9a\u304c\u306a\u3044\u6642\u306b\u5229\u7528\u3055\u308c\u308b\uff09\n# \u203b Spring Boot 1.3\u307e\u3067\u306f\u30ea\u30af\u30a8\u30b9\u30c8\u3068\u30ec\u30b9\u30dd\u30f3\u30b9\u4e21\u65b9\u306b\u9069\u7528\u3055\u308c\u3066\u3044\u305f\nspring.http.encoding.force=false\n\n# \n# \u4ee5\u4e0b\u306fSpring Boot 1.4+\u3067\u5229\u7528\u53ef\u80fd\n#\n\n# \u30ea\u30af\u30a8\u30b9\u30c8\u3078\u30a8\u30f3\u30b3\u30fc\u30c7\u30a3\u30f3\u30b0\u306e\u9069\u7528\u3092\u5f37\u5236\u3059\u308b\u304b\u3092\u6307\u5b9a(\u7701\u7565\u6642\u306f\u5168\u4f53\u306e\u30c7\u30d5\u30a9\u5024\u3001\u5168\u4f53\u306e\u30c7\u30d5\u30a9\u5024\u306e\u6307\u5b9a\u304c\u306a\u3044\u5834\u5408\u306f(true=\u5f37\u5236)\nspring.http.encoding.force-request=false\n# \u30ec\u30b9\u30dd\u30f3\u30b9\u3078\u30a8\u30f3\u30b3\u30fc\u30c7\u30a3\u30f3\u30b0\u306e\u9069\u7528\u3092\u5f37\u5236\u3059\u308b\u304b\u3092\u6307\u5b9a(\u7701\u7565\u6642\u306f\u5168\u4f53\u306e\u30c7\u30d5\u30a9\u5024\u3001\u5168\u4f53\u306e\u30c7\u30d5\u30a9\u5024\u306e\u6307\u5b9a\u304c\u306a\u3044\u5834\u5408\u306f(false=\u5f37\u5236\u3057\u306a\u3044)\nspring.http.encoding.force-response=true\n\n\n```\n\n## Spring AOP\n\nSpring AOP\u3068AspectJ\u306e\u30a2\u30fc\u30c6\u30a3\u30d5\u30a1\u30af\u30c8\u306f\u3001Spring Boot\u304c\u63d0\u4f9b\u3057\u3066\u3044\u308b`org.springframework.boot:spring-boot-starter-aop`\u3092\u6307\u5b9a\u3059\u308c\u3070\u89e3\u6c7a\u3067\u304d\u307e\u3059\u3002\n\n```xml:pom.xml\n<dependency>\n    <groupId>org.springframework.boot</groupId>\n    <artifactId>spring-boot-starter-aop</artifactId>\n</dependency>\n```\n\n`@EnableAspectJAutoProxy`\u306fSpring Boot\u304c\u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u9069\u7528\u3057\u3066\u304f\u308c\u308b\u4ed5\u7d44\u307f\u306b\u306a\u3063\u3066\u3044\u307e\u3059\u3002\nSpring Boot\u306e\u81ea\u52d5\u30b3\u30f3\u30d5\u30a3\u30ae\u30e5\u30ec\u30fc\u30b7\u30e7\u30f3\u306b\u3088\u3063\u3066`@EnableAspectJAutoProxy`\u3092\u9069\u7528\u3057\u305f\u304f\u306a\u3044\u5834\u5408\u306f\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u8a2d\u5b9a\u3092\u8ffd\u52a0\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n```properties:src/main/resources/application.properties\nspring.aop.auto=false\n```\n\n### Proxy\u751f\u6210\u306bCGLIB\u306e\u5229\u7528\u3092\u5f37\u5236\n\nCGLIB\u306e\u4ed5\u7d44\u307f\u3092\u4f7f\u3063\u3066Proxy\u3092\u4f5c\u308b\u3053\u3068\u3092\u5f37\u5236\u3057\u305f\u3044\u5834\u5408\u306f\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u8a2d\u5b9a\u3092\u8ffd\u52a0\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n```properties:src/main/resources/application.properties\nspring.aop.proxy-target-class=true\n```\n\n# \u307e\u3068\u3081\n\n\u4eca\u56de\u306f\u3001\u30ea\u30af\u30a8\u30b9\u30c8\u51e6\u7406\u5185\u306e\u4efb\u610f\u306e\u30dd\u30a4\u30f3\u30c8\u3067\u5171\u901a\u51e6\u7406\u3092\u5b9f\u884c\u3059\u308b\u65b9\u6cd5\u3092\u7d39\u4ecb\u3057\u307e\u3057\u305f\u3002\n`Filter`\u3001`HandlerInterceptor`\u3001AOP(\u7279\u306bAOP)\u306f\u5171\u901a\u51e6\u7406\u3092\u5b9f\u88c5\u3059\u308b\u306e\u306b\u5f37\u529b\u306a\u4ed5\u7d44\u307f\u3067\u3059\u304c\u3001**\u4e71\u7528\u3059\u308b\u3068\u30e1\u30f3\u30c6\u30ca\u30f3\u30b9\u6027\u3092\u640d\u306a\u3046\u53ef\u80fd\u6027\u304c\u3042\u308b**\u3053\u3068\u3092\u610f\u8b58\u3057\u3066\u304a\u3044\u305f\u65b9\u304c\u3088\u3044\u3067\u3057\u3087\u3046\u3002\u4f8b\u3048\u3070\u3001\u5165\u529b\u5024(\u30e1\u30bd\u30c3\u30c9\u5f15\u6570)\u3084\u51fa\u529b\u5024(\u30e1\u30bd\u30c3\u30c9\u306e\u8fd4\u308a\u5024)\u3092\u66f4\u65b0\u3057\u3066\u3057\u307e\u3046\u3088\u3046\u306a\u5171\u901a\u51e6\u7406\uff08\u305d\u306e\u5171\u901a\u51e6\u7406\u304c\u306a\u3044\u3068\u5f8c\u7d9a\u51e6\u7406\u306e\u52d5\u4f5c\u304c\u304b\u308f\u3063\u3066\u3057\u307e\u3046\u3088\u3046\u306a\u51e6\u7406\uff09\u306f\u539f\u5247\u3055\u3051\u308b\u3079\u304d\u3067\u3059\u3002\u3053\u306e\u624b\u306e\u51e6\u7406\u3092\u5171\u901a\u5316\u3057\u305f\u3044\u5834\u5408\u306f\u3001\u5171\u901a\u51e6\u7406\u3092\u884c\u3046\u30b3\u30f3\u30dd\u30fc\u30cd\u30f3\u30c8\u3092\u4f5c\u6210\u3057\u3001\u660e\u793a\u7684\u306b\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u30b3\u30fc\u30c9\u306e\u4e2d\u304b\u3089\u30e1\u30bd\u30c3\u30c9\u3092\u547c\u3073\u51fa\u3059\u30b9\u30bf\u30a4\u30eb\u306e\u65b9\u304c\u79c1\u306f\u3088\u3044\u3068\u601d\u3044\u307e\u3059\u3002\n\n\u3061\u306a\u307f\u306b\u3001Spring AOP\u306e\u8aac\u660e\u306f\u3001\u5168\u8c8c\u306e\u307b\u3093\u306e\u4e00\u90e8\u3067\u3059\u3002\u3053\u306e\u6295\u7a3f\u3067\u306f\u3001Spring AOP\u306e\u96f0\u56f2\u6c17\u3092\u63b4\u3093\u3067\u3082\u3089\u3048\u308c\u3070\u5e78\u3044\u3067\u3059\u3002Spring AOP\u306b\u3064\u3044\u3066\u8a73\u3057\u304f\u77e5\u308a\u305f\u3044\u65b9\u306f\u3001[Spring Framework\u516c\u5f0f\u30ea\u30d5\u30a1\u30ec\u30f3\u30b9](http://docs.spring.io/spring/docs/current/spring-framework-reference/htmlsingle/#aop)\u3092\u3054\u89a7\u304f\u3060\u3055\u3044\u3002\n\u307e\u305f\u3001\u300cServlet 3.0\u3067\u30b5\u30dd\u30fc\u30c8\u3055\u308c\u305f\u975e\u540c\u671f\u51e6\u7406\u5229\u7528\u6642\u306e\u5171\u901a\u51e6\u7406\u306e\u5b9f\u88c5\u300d\u306b\u3064\u3044\u3066\u306f\u3001\u5f8c\u65e5\u300cSpring MVC(+Spring Boot)\u4e0a\u3067\u306eServlet\u6a19\u6e96\u306e\u975e\u540c\u671f\u51e6\u7406\u3092\u7406\u89e3\u3059\u308b(\u4eee\u540d)\u300d\u306e\u4e2d\u3067\u7d39\u4ecb\u3067\u304d\u308c\u3070\u3068\u601d\u3063\u3066\u3044\u307e\u3059\u3002\n\n\n# \u53c2\u8003\u30b5\u30a4\u30c8\n\n* http://docs.spring.io/spring-boot/docs/current/reference/htmlsingle/\n* http://docs.spring.io/spring/docs/current/spring-framework-reference/htmlsingle/\n* http://qiita.com/kazuki43zoo/items/e12a72d4ac4de418ee37\n* http://qiita.com/kazuki43zoo/items/ea79e206d7c2e990e478\n* http://terasolunaorg.github.io/guideline/5.2.0.RELEASE/ja/\n", "tags": ["spring-boot", "spring-mvc", "Java", "spring"]}