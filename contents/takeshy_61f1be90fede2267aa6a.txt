{"context": " More than 1 year has passed since last update.\n\n\u80cc\u666f\nSocket.IO\u3092\u4f7f\u3063\u305f\u30b9\u30de\u30db\u5411\u3051SPA(Single Page Application)\u306e\u30b5\u30a4\u30c8SmartFX\u3092\u904b\u7528\u3057\u3066\u3044\u307e\u3059\u3002\n\u6307\u5024\u3001\u9006\u6307\u5024\u7b49\u306e\u4e88\u7d04\u6ce8\u6587\u3092\u5b9f\u88c5\u3059\u308b\u306b\u3042\u305f\u3063\u3066\u3001DB\u307e\u308f\u308a\u306e\u51e6\u7406\u3092\u3044\u304b\u306b\u52b9\u7387\u3088\u304f\u51e6\u7406\u3059\u308b\u304b\u304c\u30dd\u30a4\u30f3\u30c8\u3068\u306a\u308a\u307e\u3057\u305f\u3002\n\u306a\u305c\u306a\u3089\u3001\u70ba\u66ff\u30ec\u30fc\u30c8\u306f1\u79d2\u9593\u306b\u8907\u6570\u56de\u66f4\u65b0\u3055\u308c\u308b\u3053\u3068\u304c\u3042\u308a\u3001\u307e\u305f\u901a\u8ca8\u30da\u30a2\u3082\u8907\u6570\u3042\u308a\u307e\u3059\u3002\n\u305d\u306e\u66f4\u65b0\u306e\u5ea6\u306b\u8a72\u5f53\u3059\u308b\u4e88\u7d04\u6ce8\u6587\u304c\u3042\u308b\u304b\u691c\u7d22\u3057\u3001\u8a72\u5f53\u30ec\u30b3\u30fc\u30c9\u304c\u3042\u308c\u3070\u6ce8\u6587\u3092\u7d04\u5b9a\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\n\u305d\u306e\u305f\u3081\u76f4\u306bSQL\u3092\u53e9\u304f\u5fc5\u8981\u304c\u3042\u308b\u306e\u3067\u3059\u304c\u3001Web\u30a2\u30d7\u30ea\u81ea\u4f53\u306fRails\u3067\u66f8\u304b\u308c\u3066\u3044\u308b\u306e\u3067\u3001\u305d\u306e\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3092\u6d3b\u7528\u3057\u3064\u3064DB\u306b\u5bfe\u3057\u3066\u76f4\u63a5\u30af\u30a8\u30ea\u3092\u767a\u884c\u3067\u304d\u308b\u3088\u3046\u306aDbwrapper\u3068\u3044\u3046Gem\u3092\u4f5c\u308a\u307e\u3057\u305f\u3002\n\u307e\u305f\u3001\u3044\u304f\u3064\u304b\u306e\u4fbf\u5229\u30e1\u30bd\u30c3\u30c9\u3082\u8ffd\u52a0\u3057\u3066\u3044\u307e\u3059\u3002\nsqlite3\u3001mysql2\u3001postgresql\u306b\u5bfe\u5fdc\u3002\n\ninstall\nGemfile\u306b\u4e0b\u8a18\u3092\u8ffd\u52a0\u3057\u307e\u3059\u3002\n\ngemfile\ngem 'dbwrapper'\n#sqlite3\u3092\u4f7f\u308f\u306a\u3044\u5834\u5408\u306f\u4e0b\u8a18\u3092\u30b3\u30e1\u30f3\u30c8\u30a2\u30a6\u30c8\ngem 'sqlite3'\n#postgresql\u3092\u4f7f\u308f\u306a\u3044\u5834\u5408\u306f\u4e0b\u8a18\u3092\u30b3\u30e1\u30f3\u30c8\u30a2\u30a6\u30c8\ngem 'pg'\ngem 'pg_typecast'\n#mysql2\u3092\u4f7f\u308f\u306a\u3044\u5834\u5408\u306f\u4e0b\u8a18\u3092\u30b3\u30e1\u30f3\u30c8\u30a2\u30a6\u30c8\ngem 'mysql2'\ngem 'mysql2-cs-bind'\n\n\n\n\u4f7f\u3044\u65b9\n#sqlite3\ndb=Dbwrapper::DB.new(database: \"test.sqlite3\",adapter: \"sqlite3\")\n#mysql2\ndb=Dbwrapper::DB.new(database: \"test\",adapter: \"mysql2\",username: \"root\",password: \"xxxx\",host: \"xxxx\")\n#postgresql\ndb=Dbwrapper::DB.new(database: \"test\",adapter: \"postgresql\",username: \"root\",password: \"xxxx\",host: \"xxxx\")\n#\u3082\u3057\u304f\u306f\u5358\u306bRails\u306edatabase.yml\u3092\u8aad\u307f\u8fbc\u307e\u305b\u308b\ndb=Dbwrapper::DB.new(YAML::load(File.open('database.yml'))[\"development\"])\n\n#db\u306e\u30c9\u30e9\u30a4\u30d0\u30fc\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306f\u4e0b\u8a18\u3067\u76f4\u63a5\u53c2\u7167\u53ef\u80fd\ndb.client\n\n#create table\u306fDB\u306b\u3088\u3063\u3066\u4f7f\u3048\u308b\u578b\u304c\u5168\u7136\u9055\u3046\u306e\u3067\u610f\u8b58\u304c\u5fc5\u8981 \u3053\u3053\u306fdatetime\u578b\u3092\u4f7f\u3063\u3066\u3044\u308b\u306e\u3067mysql2\u306e\u307f\n#create table\u306e\u5b9f\u884c \ndb.query(\"create table users (id integer,name text,created_at datetime)\")\n\n#insert\u306e\u5b9f\u884c\ndb.query('insert users (id,name,created_at) value(?,?,?)',1,\"smith\",\"2014-2014-06-26 00:00:00\")\n\n#DB\u7a2e\u985e\u3092\u610f\u8b58\u305b\u305a\u7c21\u5358\u306blast_id\u3092\u53d6\u308c\u308b\ndb.last_id #=> 1\n\n#select\u306fHash\u306eArray\u304c\u8fd4\u3063\u3066\u304f\u308b\ndb.query(\"select * from users\") #=> [{\"id\"=>1, \"name\"=>\"smith\", \"created_at\"=>2014-06-26 00:00:00 +0900}]\n\n#update\ndb.query(\"update users set name=? where id = ?\",\"hay\",1)\n\n#DB\u7a2e\u985e\u3092\u610f\u8b58\u305b\u305a\u7c21\u5358\u306baffected_rows\u304c\u53d6\u308c\u308b\ndb.affected_rows #=> 1\n\n#db\u306e\u8fd4\u5374\u5024\u3082\u76f4\u63a5\u53c2\u7167\u53ef\u80fd\ndb.result\n\n#\u4fbf\u5229\u30e1\u30bd\u30c3\u30c9 table\u540d\u3068hash\u306eArray\u3092\u6e21\u3059\u3053\u3068\u3067multiple insert\u304c\u53ef\u80fd\u3002\n#sqlite3\u306e\u5834\u5408\u306fmultiple insert\u975e\u5bfe\u5fdc\u306a\u306e\u3067\u5358\u306b\u30ec\u30b3\u30fc\u30c9\u6570\u56deinsert\u304c\u5b9f\u884c\u3055\u308c\u307e\u3059\u3002\ndb.xinsert(\"users\",[{id: 2,name: \"hello\",created_at: Time.now},{id: 3,name: \"good\",created_at: Time.now}])\n\n#\u4fbf\u5229\u30e1\u30bd\u30c3\u30c9 \u30c6\u30fc\u30d6\u30eb\u540d\u3068\u30d1\u30b9\u3092\u6307\u5b9a\u3059\u308b\u3053\u3068\u3067path\u306e\u914d\u4e0b\u306b\u30c6\u30fc\u30d6\u30eb\u540d + .csv\u306e\u540d\u524d\u3067\u30d0\u30c3\u30af\u30a2\u30c3\u30d7\u304c\u4f5c\u6210\u3055\u308c\u307e\u3059\u3002\ndb.backup_table(\"users\",\"/var/backup\")\n\n#truncate \u3082\u3057sqlite3\u3060\u3063\u305f\u5834\u5408\u306f\u5358\u306bdelete\u304c\u547c\u3070\u308c\u307e\u3059\u3002\ndb.truncate(\"users\")\n\n#\u4fbf\u5229\u30e1\u30bd\u30c3\u30c9 \u30c6\u30fc\u30d6\u30eb\u540d\u3068\u30d1\u30b9\u3092\u6307\u5b9a\u3059\u308b\u3053\u3068\u3067path\u306e\u914d\u4e0b\u306e\u30c6\u30fc\u30d6\u30eb\u540d + .csv\u306e\u30d5\u30a1\u30a4\u30eb\u306e\u30c7\u30fc\u30bf\u3092\u8aad\u307f\u8fbc\u307f\u3001\u30c6\u30fc\u30d6\u30eb\u3092\u30ea\u30b9\u30c8\u30a2\u3057\u307e\u3059\ndb.restore_table(\"users\",\"/var/backup\")\n\n#DB\u306eclose postgresql\u306e\u5834\u5408\u306ffinish\u304c\u547c\u3070\u308c\u308b\ndb.close\n\n\n\u307e\u3068\u3081\n\u30d0\u30c3\u30c1\u3084\u30c7\u30fc\u30e2\u30f3\u3067\u306f\u5927\u91cf\u306einsert\u3092\u884c\u3063\u305f\u308a\u3001\u8907\u6570\u306e\u30ec\u30b3\u30fc\u30c9\u3092\u540c\u6642\u306bupdate\u304b\u3051\u305f\u308a\u3001\u8907\u96d1\u306aSQL\u3092\u66f8\u304d\u305f\u3044\u3053\u3068\u304c\u3088\u304f\u3042\u308b\u306e\u3067\u3001\u305d\u306e\u969b\u306b\u4fbf\u5229\u306b\u4f7f\u3048\u307e\u3059\u3002\n\u30d0\u30c3\u30c1\u306e\u5b9f\u884c\u524d\u3068\u5b9f\u884c\u5f8c\u3067\u95a2\u9023\u3059\u308btable\u306ebackup\u3092\u5b9f\u884c\u3059\u308b\u3053\u3068\u3067\u554f\u984c\u304c\u3042\u3063\u305f\u5834\u5408\u306e\u691c\u8a3c\u306b\u3082\u4f7f\u3048\u307e\u3059\u3002\n\n# \u80cc\u666f\nSocket.IO\u3092\u4f7f\u3063\u305f\u30b9\u30de\u30db\u5411\u3051SPA(Single Page Application)\u306e\u30b5\u30a4\u30c8[SmartFX](http://smartfx.minkabu.jp)\u3092\u904b\u7528\u3057\u3066\u3044\u307e\u3059\u3002\n\u6307\u5024\u3001\u9006\u6307\u5024\u7b49\u306e\u4e88\u7d04\u6ce8\u6587\u3092\u5b9f\u88c5\u3059\u308b\u306b\u3042\u305f\u3063\u3066\u3001DB\u307e\u308f\u308a\u306e\u51e6\u7406\u3092\u3044\u304b\u306b\u52b9\u7387\u3088\u304f\u51e6\u7406\u3059\u308b\u304b\u304c\u30dd\u30a4\u30f3\u30c8\u3068\u306a\u308a\u307e\u3057\u305f\u3002\n\u306a\u305c\u306a\u3089\u3001\u70ba\u66ff\u30ec\u30fc\u30c8\u306f1\u79d2\u9593\u306b\u8907\u6570\u56de\u66f4\u65b0\u3055\u308c\u308b\u3053\u3068\u304c\u3042\u308a\u3001\u307e\u305f\u901a\u8ca8\u30da\u30a2\u3082\u8907\u6570\u3042\u308a\u307e\u3059\u3002\n\u305d\u306e\u66f4\u65b0\u306e\u5ea6\u306b\u8a72\u5f53\u3059\u308b\u4e88\u7d04\u6ce8\u6587\u304c\u3042\u308b\u304b\u691c\u7d22\u3057\u3001\u8a72\u5f53\u30ec\u30b3\u30fc\u30c9\u304c\u3042\u308c\u3070\u6ce8\u6587\u3092\u7d04\u5b9a\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\n\u305d\u306e\u305f\u3081\u76f4\u306bSQL\u3092\u53e9\u304f\u5fc5\u8981\u304c\u3042\u308b\u306e\u3067\u3059\u304c\u3001Web\u30a2\u30d7\u30ea\u81ea\u4f53\u306fRails\u3067\u66f8\u304b\u308c\u3066\u3044\u308b\u306e\u3067\u3001\u305d\u306e\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3092\u6d3b\u7528\u3057\u3064\u3064DB\u306b\u5bfe\u3057\u3066\u76f4\u63a5\u30af\u30a8\u30ea\u3092\u767a\u884c\u3067\u304d\u308b\u3088\u3046\u306a[Dbwrapper](https://github.com/takeshy/dbwrapper)\u3068\u3044\u3046Gem\u3092\u4f5c\u308a\u307e\u3057\u305f\u3002\n\u307e\u305f\u3001\u3044\u304f\u3064\u304b\u306e\u4fbf\u5229\u30e1\u30bd\u30c3\u30c9\u3082\u8ffd\u52a0\u3057\u3066\u3044\u307e\u3059\u3002\nsqlite3\u3001mysql2\u3001postgresql\u306b\u5bfe\u5fdc\u3002\n\n\n#install\n\nGemfile\u306b\u4e0b\u8a18\u3092\u8ffd\u52a0\u3057\u307e\u3059\u3002\n\n```ruby:gemfile\ngem 'dbwrapper'\n#sqlite3\u3092\u4f7f\u308f\u306a\u3044\u5834\u5408\u306f\u4e0b\u8a18\u3092\u30b3\u30e1\u30f3\u30c8\u30a2\u30a6\u30c8\ngem 'sqlite3'\n#postgresql\u3092\u4f7f\u308f\u306a\u3044\u5834\u5408\u306f\u4e0b\u8a18\u3092\u30b3\u30e1\u30f3\u30c8\u30a2\u30a6\u30c8\ngem 'pg'\ngem 'pg_typecast'\n#mysql2\u3092\u4f7f\u308f\u306a\u3044\u5834\u5408\u306f\u4e0b\u8a18\u3092\u30b3\u30e1\u30f3\u30c8\u30a2\u30a6\u30c8\ngem 'mysql2'\ngem 'mysql2-cs-bind'\n```\n\n#\u4f7f\u3044\u65b9\n```ruby\n#sqlite3\ndb=Dbwrapper::DB.new(database: \"test.sqlite3\",adapter: \"sqlite3\")\n#mysql2\ndb=Dbwrapper::DB.new(database: \"test\",adapter: \"mysql2\",username: \"root\",password: \"xxxx\",host: \"xxxx\")\n#postgresql\ndb=Dbwrapper::DB.new(database: \"test\",adapter: \"postgresql\",username: \"root\",password: \"xxxx\",host: \"xxxx\")\n#\u3082\u3057\u304f\u306f\u5358\u306bRails\u306edatabase.yml\u3092\u8aad\u307f\u8fbc\u307e\u305b\u308b\ndb=Dbwrapper::DB.new(YAML::load(File.open('database.yml'))[\"development\"])\n\n#db\u306e\u30c9\u30e9\u30a4\u30d0\u30fc\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306f\u4e0b\u8a18\u3067\u76f4\u63a5\u53c2\u7167\u53ef\u80fd\ndb.client\n\n#create table\u306fDB\u306b\u3088\u3063\u3066\u4f7f\u3048\u308b\u578b\u304c\u5168\u7136\u9055\u3046\u306e\u3067\u610f\u8b58\u304c\u5fc5\u8981 \u3053\u3053\u306fdatetime\u578b\u3092\u4f7f\u3063\u3066\u3044\u308b\u306e\u3067mysql2\u306e\u307f\n#create table\u306e\u5b9f\u884c \ndb.query(\"create table users (id integer,name text,created_at datetime)\")\n\n#insert\u306e\u5b9f\u884c\ndb.query('insert users (id,name,created_at) value(?,?,?)',1,\"smith\",\"2014-2014-06-26 00:00:00\")\n\n#DB\u7a2e\u985e\u3092\u610f\u8b58\u305b\u305a\u7c21\u5358\u306blast_id\u3092\u53d6\u308c\u308b\ndb.last_id #=> 1\n\n#select\u306fHash\u306eArray\u304c\u8fd4\u3063\u3066\u304f\u308b\ndb.query(\"select * from users\") #=> [{\"id\"=>1, \"name\"=>\"smith\", \"created_at\"=>2014-06-26 00:00:00 +0900}]\n\n#update\ndb.query(\"update users set name=? where id = ?\",\"hay\",1)\n\n#DB\u7a2e\u985e\u3092\u610f\u8b58\u305b\u305a\u7c21\u5358\u306baffected_rows\u304c\u53d6\u308c\u308b\ndb.affected_rows #=> 1\n\n#db\u306e\u8fd4\u5374\u5024\u3082\u76f4\u63a5\u53c2\u7167\u53ef\u80fd\ndb.result\n\n#\u4fbf\u5229\u30e1\u30bd\u30c3\u30c9 table\u540d\u3068hash\u306eArray\u3092\u6e21\u3059\u3053\u3068\u3067multiple insert\u304c\u53ef\u80fd\u3002\n#sqlite3\u306e\u5834\u5408\u306fmultiple insert\u975e\u5bfe\u5fdc\u306a\u306e\u3067\u5358\u306b\u30ec\u30b3\u30fc\u30c9\u6570\u56deinsert\u304c\u5b9f\u884c\u3055\u308c\u307e\u3059\u3002\ndb.xinsert(\"users\",[{id: 2,name: \"hello\",created_at: Time.now},{id: 3,name: \"good\",created_at: Time.now}])\n\n#\u4fbf\u5229\u30e1\u30bd\u30c3\u30c9 \u30c6\u30fc\u30d6\u30eb\u540d\u3068\u30d1\u30b9\u3092\u6307\u5b9a\u3059\u308b\u3053\u3068\u3067path\u306e\u914d\u4e0b\u306b\u30c6\u30fc\u30d6\u30eb\u540d + .csv\u306e\u540d\u524d\u3067\u30d0\u30c3\u30af\u30a2\u30c3\u30d7\u304c\u4f5c\u6210\u3055\u308c\u307e\u3059\u3002\ndb.backup_table(\"users\",\"/var/backup\")\n\n#truncate \u3082\u3057sqlite3\u3060\u3063\u305f\u5834\u5408\u306f\u5358\u306bdelete\u304c\u547c\u3070\u308c\u307e\u3059\u3002\ndb.truncate(\"users\")\n\n#\u4fbf\u5229\u30e1\u30bd\u30c3\u30c9 \u30c6\u30fc\u30d6\u30eb\u540d\u3068\u30d1\u30b9\u3092\u6307\u5b9a\u3059\u308b\u3053\u3068\u3067path\u306e\u914d\u4e0b\u306e\u30c6\u30fc\u30d6\u30eb\u540d + .csv\u306e\u30d5\u30a1\u30a4\u30eb\u306e\u30c7\u30fc\u30bf\u3092\u8aad\u307f\u8fbc\u307f\u3001\u30c6\u30fc\u30d6\u30eb\u3092\u30ea\u30b9\u30c8\u30a2\u3057\u307e\u3059\ndb.restore_table(\"users\",\"/var/backup\")\n\n#DB\u306eclose postgresql\u306e\u5834\u5408\u306ffinish\u304c\u547c\u3070\u308c\u308b\ndb.close\n```\n\n#\u307e\u3068\u3081\n\n\u30d0\u30c3\u30c1\u3084\u30c7\u30fc\u30e2\u30f3\u3067\u306f\u5927\u91cf\u306einsert\u3092\u884c\u3063\u305f\u308a\u3001\u8907\u6570\u306e\u30ec\u30b3\u30fc\u30c9\u3092\u540c\u6642\u306bupdate\u304b\u3051\u305f\u308a\u3001\u8907\u96d1\u306aSQL\u3092\u66f8\u304d\u305f\u3044\u3053\u3068\u304c\u3088\u304f\u3042\u308b\u306e\u3067\u3001\u305d\u306e\u969b\u306b\u4fbf\u5229\u306b\u4f7f\u3048\u307e\u3059\u3002\n\u30d0\u30c3\u30c1\u306e\u5b9f\u884c\u524d\u3068\u5b9f\u884c\u5f8c\u3067\u95a2\u9023\u3059\u308btable\u306ebackup\u3092\u5b9f\u884c\u3059\u308b\u3053\u3068\u3067\u554f\u984c\u304c\u3042\u3063\u305f\u5834\u5408\u306e\u691c\u8a3c\u306b\u3082\u4f7f\u3048\u307e\u3059\u3002\n\n", "tags": ["Ruby", "SQLite3", "MySQL", "PostgreSQL"]}