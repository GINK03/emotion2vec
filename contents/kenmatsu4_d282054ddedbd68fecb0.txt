{"tags": ["Python2.7", "\u6570\u5b66", "math", "\u6a5f\u68b0\u5b66\u7fd2", "MachineLearning"], "context": " More than 1 year has passed since last update.\n\n\u52fe\u914d\u964d\u4e0b\u6cd5\u306f\u4f55\u306b\u4f7f\u3046\uff1f\n\u52fe\u914d\u964d\u4e0b\u6cd5\u306f\u7d71\u8a08\u5b66\u3084\u6a5f\u68b0\u5b66\u7fd2\u3067\u591a\u304f\u4f7f\u308f\u308c\u3066\u3044\u307e\u3059\u3002\u7279\u306b\u6a5f\u68b0\u5b66\u7fd2\u3068\u3044\u3046\u306e\u306f\u57fa\u672c\u7684\u306b\u4f55\u304b\u3057\u3089\u306e\u95a2\u6570\u3092\u6700\u5c0f\u5316\uff08\u6700\u5927\u5316\uff09\u3059\u308b\u554f\u984c\u3092\u6570\u5024\u89e3\u6790\u7684\u306b\u89e3\u304f\u3053\u3068\u306b\u5e30\u7d50\u3059\u308b\u5834\u5408\u304c\u591a\u3044\u3067\u3059\u3002\uff08e.g. \u6700\u5c0f\u4e8c\u4e57\u6cd5 \u2192 \u8aa4\u5dee\u306e\u4e8c\u4e57\u548c\u3092\u6700\u5c0f\u5316\uff08\u53c2\u8003\uff09\u3001\u30cb\u30e5\u30fc\u30e9\u30eb\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306e\u30d1\u30e9\u30e1\u30fc\u30bf\u6c7a\u5b9a etc...\uff09\n\u306a\u306e\u3067\u3001\u57fa\u672c\u7684\u306b\u306f\u3072\u305f\u3059\u3089\u5fae\u5206\u3057\u30660\u3068\u306a\u308b\u3068\u3053\u308d\u3092\u63a2\u3059\u554f\u984c\u3067\u3059\u306d\u3001\u5fae\u5206\u3057\u30660\u3002\u3067\u3001\u305d\u306e\u5fae\u5206\u3057\u30660\u3068\u306a\u308b\u5024\u306f\u4f55\u304b\u3001\u3092\u30d7\u30ed\u30b0\u30e9\u30e0\u3067\u89e3\u304f\u5834\u5408\u306b\u91cd\u8981\u306b\u306a\u308b\u306e\u304c\u3053\u306e\u52fe\u914d\u964d\u4e0b\u6cd5\u3067\u3059\u3002\u5e7e\u3064\u304b\u52fe\u914d\u6cd5\u306b\u3082\u7a2e\u985e\u304c\u3042\u308a\u307e\u3059\u304c\u3053\u3053\u3067\u306f\u6700\u6025\u964d\u4e0b\u6cd5\u3001\u78ba\u7387\u7684\u52fe\u914d\u964d\u4e0b\u6cd5\u306e\uff12\u3064\u3092\u6271\u3044\u307e\u3059\u3002\u307e\u305a\u306f\u30a4\u30e1\u30fc\u30b8\u3092\u3064\u304b\u3080\u305f\u3081\u306b\uff11\u6b21\u5143\u306e\u30b0\u30e9\u30d5\u3067\u78ba\u8a8d\u3057\u3066\u3044\u304d\u305f\u3044\u3068\u601d\u3044\u307e\u3059\u3002\n\n1\u6b21\u5143\u306e\u5834\u5408\n1\u6b21\u5143\u306e\u5834\u5408\u306f\u3001\u78ba\u7387\u7684\u3068\u3044\u3046\u6982\u5ff5\u306f\u306a\u304f\u3001\u305f\u3060\u306e\u52fe\u914d\u964d\u4e0b\u6cd5\u306b\u306a\u308a\u307e\u3059\u3002\n\uff08\u3069\u3046\u3044\u3046\u3053\u3068\u304b\u3001\u306f\u306e\u3061\u307b\u3069\uff09\n1\u6b21\u5143\u306e\u4f8b\u306f\u3001\u6b63\u898f\u5206\u5e03\u3092\u30de\u30a4\u30ca\u30b9\u306b\u3057\u305f\u3082\u306e\u3092\u4f7f\u3063\u3066\u307f\u307e\u3059\u3002xinit=0x_{init} = 0\u3068xinit=6x_{init} = 6\u306e\u30b0\u30e9\u30d5\u3092\u4f8b\u3068\u3057\u3066\u4f5c\u3063\u3066\u3044\u307e\u3059\u3002\u5bfe\u8c61\u3068\u306a\u308b\u30b0\u30e9\u30d5\u306f\u6b63\u898f\u5206\u5e03\u306e\u5bc6\u5ea6\u95a2\u6570\u3092\u30de\u30a4\u30ca\u30b9\u3057\u3066\u4e0b\u5411\u304d\u306b\u3057\u305f\u3082\u306e\u3092\u4f7f\u3044\u307e\u3057\u305f\u3002\n\u521d\u671f\u5024 = 0 \u306e\u30b0\u30e9\u30d5\n\u30b0\u30e9\u30d5\u306e\u7aef\u304b\u3089\u59cb\u307e\u3063\u3066\u3001\u3061\u3083\u3093\u3068\u4e00\u756a\u5c0f\u3055\u3044\u3068\u3053\u308d\u3001\u6700\u5c0f\u5024\u3067\u53ce\u675f\u3057\u3066\u3044\u308b\u3053\u3068\u304c\u308f\u304b\u308a\u307e\u3059\u306d\u3002\u9752\u3044\u7dda\u306e\u30b0\u30e9\u30d5\u304c\u6b63\u898f\u5206\u5e03\u306e\u30de\u30a4\u30ca\u30b9\u7248\u3067\u3001\u7dd1\u306e\u7dda\u306e\u30b0\u30e9\u30d5\u304c\u305d\u306e\u5fae\u5206\u3057\u305f\u5024\u306e\u30b0\u30e9\u30d5\u3067\u3059\u3002\n\n\u521d\u671f\u5024 = 6 \u306e\u30b0\u30e9\u30d5\n\n\u5404\u70b9\u3067\u306e\u50be\u304d\u3092\u30d9\u30fc\u30b9\u306b\u6b21\u306exx\u306e\u5024\u3092\u6c7a\u3081\u3001\u307e\u305f\u305d\u306e\u4f4d\u7f6e\u3067\u306e\u50be\u304d\u3092\u8abf\u3079\u6b21\u306b\u964d\u4e0b\u3057\u3066\u884c\u304f\u3001\u3068\u3044\u3046\u4e8b\u3092\u7e70\u308a\u8fd4\u3057\u3066\u6700\u5c0f\u5024\uff08\u672c\u5f53\u306f\u6975\u5c0f\u5024\uff09\u306b\u305f\u3069\u308a\u7740\u304d\u307e\u3059\u3002\u4e0a\u306e\u4f8b\u3060\u3068\u3001\u6700\u5c0f\u5024\u306b\u8fd1\u305a\u304f\u306b\u3064\u308c\u3001\u50be\u304d\u3082\u306a\u3060\u3089\u304b\u306b\u306a\u3063\u3066\u3044\u304f\u306e\u3067\u30011\u56de\u306e\u30b9\u30c6\u30c3\u30d7\u3067\u9032\u3080\u91cf\u304c\u3060\u3093\u3060\u3093\u5c0f\u3055\u304f\u306a\u308a\u3001\u305d\u308c\u304c\u3042\u308b\u57fa\u6e96\u3088\u308a\u5c0f\u3055\u304f\u306a\u308b\u3068\u30b9\u30c8\u30c3\u30d7\u3059\u308b\u3001\u3068\u3044\u3046\u30ed\u30b8\u30c3\u30af\u3092\u7d44\u3093\u3067\u3044\u307e\u3059\u3002\n\u3053\u308c\u3089\uff12\u3064\u306e\u30b0\u30e9\u30d5\u3092\u66f8\u3044\u305f\u30b3\u30fc\u30c9\u306f\u3053\u3061\u3089\u3067\u3059\u3002\n\n2\u6b21\u5143\u306e\u5834\u5408(2\u6b21\u95a2\u6570)\n\u591a\u6b21\u5143\u306e\u5834\u5408\u306f\u6b21\u306e\u30b9\u30c6\u30c3\u30d7\u306b\u9032\u3080\u5411\u304d\u3082\u8003\u616e\u3057\u3066\u964d\u4e0b\u3057\u3066\u3044\u304d\u307e\u3059\u3002\u30bf\u30fc\u30b2\u30c3\u30c8\u3068\u306a\u308b\u95a2\u6570\u306b\u3088\u308a\u52d5\u304d\u306e\u7279\u5fb4\u304c\u5909\u308f\u308b\u306e\u3067\u3059\u304c\u3001\u6700\u521d\u306b2\u6b21\u95a2\u6570 Z=\u22123x2\u22125y2+6xyZ=-3x^2-5y^2+6xy \u3068\u3044\u3046\u95a2\u6570\u3092\u4f8b\u306b\u30b0\u30e9\u30d5\u3092\u66f8\u3044\u3066\u307f\u307e\u3057\u305f\u3002\u306a\u3093\u3060\u304b\u30b8\u30b0\u30b6\u30b0\u52d5\u304d\u306a\u304c\u3089\u9802\u70b9\u306b\u5411\u304b\u3063\u3066\u884c\u304f\u59ff\u3092\u307f\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n\u30b3\u30fc\u30c9\u306f\u3053\u3061\u3089\n\n2\u6b21\u5143\u306e\u5834\u5408\n\n2\u6b21\u5143\u306e\u5834\u5408(2\u6b21\u5143\u6b63\u898f\u5206\u5e03)\n2\u6b21\u5143\u6b63\u898f\u5206\u5e03\uff08\u306b\u30de\u30a4\u30ca\u30b9\u3092\u304b\u3051\u305f\u3082\u306e\uff09\u306b\u5bfe\u3057\u3066\u6700\u6025\u964d\u4e0b\u6cd5\u3092\u9069\u7528\u3059\u308b\u3068\u30b8\u30b0\u30b6\u30b0\u52d5\u304b\u305a\u3001\u7dba\u9e97\u306b\u6700\u5c0f\u5024\u306b\u964d\u4e0b\u3057\u3066\u3044\u304f\u3053\u3068\u304c\u308f\u304b\u308a\u307e\u3057\u305f\u3002\u3053\u306e\u3042\u305f\u308a\u30bf\u30fc\u30b2\u30c3\u30c8\u95a2\u6570\u306b\u3088\u308b\u53ce\u675f\u306e\u69d8\u5b50\u306e\u9055\u3044\u306b\u3064\u3044\u3066\u306f\u4eca\u5ea6\u8abf\u3079\u3066\u307f\u305f\u3044\u3068\u601d\u3044\u307e\u3059\u3002\n\n\u30b3\u30fc\u30c9\u306f\u3053\u3061\u3089\n\n\u6700\u6025\u964d\u4e0b\u6cd5\u306e\u4ed5\u7d44\u307f\n\u6700\u6025\u964d\u4e0b\u6cd5\u306e\u4ed5\u7d44\u307f\u306f\u3001\u307e\u305a\u6700\u521d\u306b\u30b9\u30bf\u30fc\u30c8\u5730\u70b9\u3092\u9078\u3073\u3001\u305d\u306e\u70b9\u3067\u306e\u4e00\u756a\u964d\u4e0b\u3059\u308b\u50be\u304d\u304c\u5927\u304d\u3044\u30d9\u30af\u30c8\u30eb\u3001\u3064\u307e\u308a\n\\nabla f = \\frac{d f({\\bf x})}{d {\\bf x}} = \\left[ \\begin{array}{r} \\frac{\\partial f}{\\partial x_1} \\\\ ... \\\\ \\frac{\\partial f}{\\partial x_2} \\end{array} \\right]\n\u2207f=df(x)dx=[\u2202f\u2202x1...\u2202f\u2202x2]{\\nabla f = \\frac{d f({\\bf x})}{d {\\bf x}} = \\left[ \\begin{array}{r} \\frac{\\partial f}{\\partial x_1} \\\\ ... \\\\ \\frac{\\partial f}{\\partial x_2} \\end{array} \\right]\n}\n\u3092\u5229\u7528\u3057\u3066\u6b21\u306e\u30b9\u30c6\u30c3\u30d7\u306b\u884c\u304f\u65b9\u6cd5\u3067\u3059\u3002\u4e0a\u8a18\u306e\u30b0\u30e9\u30d5\u3067\u306f\u3001\u3053\u306e\u52fe\u914d\u30d9\u30af\u30c8\u30eb\u306b\u5b66\u7fd2\u7387\u03b7\\eta\u3092\u304b\u3051\u305f\u3082\u306e\u3092\u76f4\u7dda\u3067\u8868\u3057\u3066\u3044\u307e\u3059\u3002\n\u306a\u306e\u3067\u3001\nx_{i+1} = x_i - \\eta \\nabla f\nxi+1=xi\u2212\u03b7\u2207f{x_{i+1} = x_i - \\eta \\nabla f\n}\n\u3068\u3044\u3046\u30b9\u30c6\u30c3\u30d7\u3092\u53ce\u675f\u3059\u308b\u307e\u3067\u7e70\u308a\u8fd4\u3059\u3001\u3068\u3044\u3046\u51e6\u7406\u3092\u884c\u3063\u3066\u3044\u307e\u3059\u3002\n\n\u78ba\u7387\u7684\u52fe\u914d\u964d\u4e0b\u6cd5\u3068\u306f\n\u3055\u3066\u3001\u6b21\u306b\u78ba\u7387\u7684\u52fe\u914d\u964d\u4e0b\u6cd5\u306b\u79fb\u308a\u305f\u3044\u3068\u601d\u3044\u307e\u3059\u3002\n\u307e\u305a\u3001\u5bfe\u8c61\u3068\u3059\u308b\u95a2\u6570\u3067\u3059\u304c\u3001\u4ee5\u524d\u56de\u5e30\u5206\u6790\u306e\u8aac\u660e\u3067\u4f7f\u3063\u305f\u56de\u5e30\u76f4\u7dda\u306e\u8aa4\u5dee\u95a2\u6570\u3092\u4f7f\u3063\u3066\u8aac\u660e\u3057\u305f\u3044\u3068\u601d\u3044\u307e\u3059\u3002\u3061\u3087\u3063\u3068\u305d\u306e\u89e3\u91c8\u3092\u5909\u3048\u3066\u3044\u308b\u90e8\u5206(\u6700\u5c24\u6cd5\u3092\u4f7f\u7528)\u3082\u3042\u308b\u306e\u3067\u6587\u672b\u306b\u88dc\u8db3\u3068\u3057\u3066\u8a18\u8f09\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n\u30c7\u30fc\u30bf\u306f\u3001\ny_n = \\alpha x_n + \\beta + \\epsilon_n\u3000\u3000\u3000(\\alpha=1, \\beta=0)\\\\\n\\epsilon_n \u223c N(0, 2)\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\nyn=\u03b1xn+\u03b2+\u03f5n\u3000\u3000\u3000(\u03b1=1,\u03b2=0)\u03f5n\u223cN(0,2)\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000{y_n = \\alpha x_n + \\beta + \\epsilon_n\u3000\u3000\u3000(\\alpha=1, \\beta=0)\\\\\n\\epsilon_n \u223c N(0, 2)\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\n}\n\u3068\u3044\u3046N=1000\u500b\u306e\u30c7\u30fc\u30bf\u30bb\u30c3\u30c8\u3092\u6e96\u5099\u3057\u3066\u3001\u305d\u306e\u56de\u5e30\u76f4\u7dda\u3092\u6c42\u3081\u308b\u4f8b\u3092\u4f7f\u7528\u3057\u307e\u3059\u3002\u6563\u5e03\u56f3\u306f\u4ee5\u4e0b\u306e\u901a\u308a\u3067\u3059\u3002\n\n\u8aa4\u5dee\u95a2\u6570\u3001\n\nE({\\bf w})=\\sum_{n=1}^{N} E_n({\\bf w}) = \\sum_{n=1}^{N} (y_n -\\alpha x_n - \\beta)^2 \\\\\n{\\bf w} = (\\alpha, \\beta)^{\\rm T}\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\nE(w)=N\u2211n=1En(w)=N\u2211n=1(yn\u2212\u03b1xn\u2212\u03b2)2w=(\u03b1,\u03b2)T\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000{\nE({\\bf w})=\\sum_{n=1}^{N} E_n({\\bf w}) = \\sum_{n=1}^{N} (y_n -\\alpha x_n - \\beta)^2 \\\\\n{\\bf w} = (\\alpha, \\beta)^{\\rm T}\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\n}\n\u306e\u6700\u5c0f\u5024\u3092\u6c42\u3081\u3066\u3044\u304d\u307e\u3059\u304c\u3001\u307e\u305a\u52fe\u914d\u3092\u8a08\u7b97\u3059\u308b\u305f\u3081\u3001\u305d\u308c\u305e\u308c\u03b1,\u03b2\\alpha, \\beta\u3067\u504f\u5fae\u5206\u3057\u305f\u52fe\u914d\u30d9\u30af\u30c8\u30eb\u3092\u5c0e\u51fa\u3057\u307e\u3059\u3002\n\n\\frac{\\partial E({\\bf w})}{\\partial \\alpha} = \\sum_{n=1}^{N} \\frac{\\partial E_n({\\bf w})}{\\partial \\alpha} = \n\\sum_{n=1}^N (2 x_n^2  \\alpha +  2 x_n \\beta - 2 x_n y_n )\\\\\n\n\\frac{\\partial E({\\bf w})}{\\partial \\beta} = \\sum_{n=1}^{N}\\frac{\\partial E_n({\\bf w})}{\\partial \\alpha} =\n\\sum_{n=1}^N (2\\beta + 2  x_n \\alpha - 2y_n)\u3000\u3000\u3000\n\u2202E(w)\u2202\u03b1=N\u2211n=1\u2202En(w)\u2202\u03b1=N\u2211n=1(2x2n\u03b1+2xn\u03b2\u22122xnyn)\u2202E(w)\u2202\u03b2=N\u2211n=1\u2202En(w)\u2202\u03b1=N\u2211n=1(2\u03b2+2xn\u03b1\u22122yn)\u3000\u3000\u3000{\n\\frac{\\partial E({\\bf w})}{\\partial \\alpha} = \\sum_{n=1}^{N} \\frac{\\partial E_n({\\bf w})}{\\partial \\alpha} = \n\\sum_{n=1}^N (2 x_n^2  \\alpha +  2 x_n \\beta - 2 x_n y_n )\\\\\n\n\\frac{\\partial E({\\bf w})}{\\partial \\beta} = \\sum_{n=1}^{N}\\frac{\\partial E_n({\\bf w})}{\\partial \\alpha} =\n\\sum_{n=1}^N (2\\beta + 2  x_n \\alpha - 2y_n)\u3000\u3000\u3000\n}\n\u306a\u306e\u3067\u3001\u52fe\u914d\u30d9\u30af\u30c8\u30eb\u306f\n\\nabla E({\\bf w}) = \\frac{d E({\\bf w}) }{d {\\bf w}} = \\left[ \\begin{array}{r} \\frac{\\partial E({\\bf w})}{\\partial \\alpha} \\\\ \\frac{\\partial E({\\bf w})}{\\partial \\beta} \\end{array} \\right] = \\sum_{n=1}^{N}\n\\nabla E_n({\\bf w}) = \\sum_{n=1}^{N} \\left[ \\begin{array}{r} \\frac{\\partial E_n({\\bf w})}{\\partial \\alpha} \\\\ \\frac{\\partial E_n({\\bf w})}{\\partial \\beta} \\end{array} \\right]=\n\\left[ \\begin{array}{r} \n2 x_n^2  \\alpha +  2 x_n \\beta - 2 x_n y_n \\\\ \n2\\beta + 2  x_n \\alpha - 2y_n \u3000\n\\end{array} \\right]\n\u2207E(w)=dE(w)dw=[\u2202E(w)\u2202\u03b1\u2202E(w)\u2202\u03b2]=N\u2211n=1\u2207En(w)=N\u2211n=1[\u2202En(w)\u2202\u03b1\u2202En(w)\u2202\u03b2]=[2x2n\u03b1+2xn\u03b2\u22122xnyn2\u03b2+2xn\u03b1\u22122yn\u3000]{\\nabla E({\\bf w}) = \\frac{d E({\\bf w}) }{d {\\bf w}} = \\left[ \\begin{array}{r} \\frac{\\partial E({\\bf w})}{\\partial \\alpha} \\\\ \\frac{\\partial E({\\bf w})}{\\partial \\beta} \\end{array} \\right] = \\sum_{n=1}^{N}\n\\nabla E_n({\\bf w}) = \\sum_{n=1}^{N} \\left[ \\begin{array}{r} \\frac{\\partial E_n({\\bf w})}{\\partial \\alpha} \\\\ \\frac{\\partial E_n({\\bf w})}{\\partial \\beta} \\end{array} \\right]=\n\\left[ \\begin{array}{r} \n2 x_n^2  \\alpha +  2 x_n \\beta - 2 x_n y_n \\\\ \n2\\beta + 2  x_n \\alpha - 2y_n \u3000\n\\end{array} \\right]\n}\n\u3068\u306a\u308a\u307e\u3059\u3002\n\u5358\u56de\u5e30\u76f4\u7dda\u3092\u6c42\u3081\u308b\u554f\u984c\u306a\u306e\u3067\u3001\u65b9\u7a0b\u5f0f\u3068\u3057\u3066\u89e3\u3044\u3066\u3082\u826f\u3044\u306e\u3067\u3059\u304c\u3001\u3053\u308c\u3092\u78ba\u7387\u7684\u52fe\u914d\u964d\u4e0b\u6cd5\u3092\u7528\u3044\u3066\u89e3\u304f\u3053\u3068\u3092\u884c\u3063\u3066\u3044\u304d\u307e\u3059\u3002\u3053\u3053\u3067N=1000\u500b\u306e\u5168\u3066\u306e\u30c7\u30fc\u30bf\u3092\u3059\u3079\u3066\u4f7f\u3046\u306e\u3067\u306f\u306a\u304f\u3001\u3053\u3053\u304b\u3089\u30e9\u30f3\u30c0\u30e0\u30b5\u30f3\u30d7\u30ea\u30f3\u30b0\u3057\u3066\u53d6\u308a\u51fa\u3057\u305f\u30c7\u30fc\u30bf\u306b\u5bfe\u3057\u3066\u52fe\u914d\u3092\u8a08\u7b97\u3057\u3001\u6b21\u306e\u30b9\u30c6\u30c3\u30d7\u3092\u6c7a\u3081\u308b\u306e\u304c\u3053\u306e\u624b\u6cd5\u306e\u30ad\u30e2\u3067\u3059\u3002\n\u307e\u305a\u3053\u306e\u30c7\u30fc\u30bf\u30bb\u30c3\u30c8\u304b\u308920\u500b\u30e9\u30f3\u30c0\u30e0\u306b\u53d6\u308a\u51fa\u3057\u3066\u30b0\u30e9\u30d5\u306b\u3057\u3066\u307f\u307e\u3059\u3002\u6a2a\u8ef8\u304c\u03b1\\alpha\u3001\u7e26\u8ef8\u304c\u03b2\\beta\u3001Z\u8ef8\u304c\u8aa4\u5deeE(\u03b1,\u03b2)E(\\alpha,\\beta)\u3067\u3059\u3002\n\n\u306a\u3093\u3068\u306a\u304f\u30b0\u30e9\u30d5\u306e\u6700\u5c0f\u5024\u304c\u03b1=1,\u03b2=0\\alpha=1, \\beta=0\u3092\u4e2d\u5fc3\u306b\u6563\u3089\u3070\u3063\u3066\u3044\u308b\u304b\u3068\u601d\u3044\u307e\u3059\u3002\u4eca\u56de\u306f1000\u500b\u306e\u30c7\u30fc\u30bf\u304b\u3089\u30e9\u30f3\u30c0\u30e0\u306b3\u3064\u306e\u30c7\u30fc\u30bf\u3092\u30d4\u30c3\u30af\u30a2\u30c3\u30d7\u3057\u3066\u305d\u308c\u3092\u5143\u306b\u3053\u306e\u30b0\u30e9\u30d5\u3092\u66f8\u3044\u3066\u3044\u307e\u3059\u3002\n\u521d\u671f\u5024\u3092\u03b1=\u22121.5,\u03b2=\u22121.5\\alpha=-1.5, \\beta=-1.5\u3001\u5b66\u7fd2\u7387\u3092\u30a4\u30c6\u30ec\u30fc\u30b7\u30e7\u30f3\u56de\u6570tt\u306e\u9006\u6570\u306b\u6bd4\u4f8b\u3055\u305b\u3001\u3055\u3089\u306b\u305d\u306e\u5730\u70b9\u3067\u306eE(\u03b1,\u03b2)E(\\alpha, \\beta)\u306e\u9006\u6570\u3082\u304b\u3051\u305f\u3082\u306e\u3092\u4f7f\u3063\u3066\u307f\u307e\u3057\u305f\u3002\u3053\u306e\u5b66\u7fd2\u7387\u3068\u521d\u671f\u5024\u306e\u6c7a\u3081\u65b9\u306b\u3064\u3044\u3066\u8a66\u884c\u932f\u8aa4\u3059\u308b\u3057\u304b\u306a\u3044\u3088\u3046\u306a\u306e\u3067\u3059\u304c\u3001\u4f55\u304b\u826f\u3044\u63a2\u3057\u65b9\u3092\u3054\u5b58\u77e5\u306e\u65b9\u304c\u3044\u308c\u3070\u6559\u3048\u3066\u3082\u3089\u3048\u308b\u3068\u5b09\u3057\u3044\u3067\u3059\u3002\u3061\u3087\u3063\u3068\u9593\u9055\u3048\u308b\u3068\u3042\u3063\u3068\u3044\u3046\u9593\u306b\u70b9\u304c\u67a0\u5916\u306b\u98db\u3093\u3067\u884c\u3063\u3066\u623b\u3063\u3066\u3053\u306a\u304f\u306a\u308a\u307e\u3059\uff08\u7b11\uff09\n\u52fe\u914d\u3092\u6c7a\u3081\u308b\u8aa4\u5dee\u95a2\u6570\u304c\u4e71\u6570\u306b\u4f9d\u5b58\u3057\u3066\u3044\u308b\u306e\u3067\u6bce\u56de\u5909\u5316\u3057\u3066\u3044\u308b\u3053\u3068\u304c\u898b\u3066\u53d6\u308c\u307e\u3059\u3002\u56de\u5e30\u76f4\u7dda\u3082\u6700\u521d\u306f\u76f8\u5f53\u66b4\u308c\u3066\u3044\u307e\u3059\u304c\u3001\u3060\u3093\u3060\u3093\u5927\u4eba\u3057\u304f\u306a\u3063\u3066\u53ce\u675f\u3057\u3066\u3044\u304f\u69d8\u304c\u308f\u304b\u308b\u3068\u601d\u3044\u307e\u3059\u3002\n\n\u6b63\u76f4\u3001\u4e0a\u8a18\u306e\u30a2\u30cb\u30e1\u30fc\u30b7\u30e7\u30f3\u306e\u4f8b\u306f\u53ce\u675f\u304c\u826f\u3044\u65b9\u306e\u3082\u306e\u3067\u3057\u3066\u3001\u4e0b\u8a18\u306b10000\u56de\u7e70\u308a\u8fd4\u3057\u305f\u969b\u306e\u03b1\\alpha\u3068\u03b2\\beta\u306e\u53ce\u675f\u5177\u5408\u3092\u30b0\u30e9\u30d5\u306b\u3057\u305f\u3082\u306e\u3092\u8f09\u305b\u3066\u3044\u307e\u3059\u304c\u3001\u03b1\\alpha\u306f\u771f\u306e\u50241\u306b\u8fd1\u3065\u3044\u3066\u3044\u308b\u306e\u3067\u3059\u304c\u3001\u03b2\\beta\u306f0.5\u306e\u3042\u305f\u308a\u3067\u53ce\u675f\u3057\u3066\u3057\u307e\u3044\u3001\u771f\u306e\u5024\u306e0\u306b\u3053\u308c\u4ee5\u4e0a\u8fd1\u3065\u304d\u305d\u3046\u306b\u3042\u308a\u307e\u305b\u3093\u3002\n\n\u3053\u308c\u306f\u305d\u3082\u305d\u3082\u306e\u4eca\u56de\u306e\u56de\u5e30\u76f4\u7dda\u306e\u8aa4\u5dee\u95a2\u6570\u306e\u7279\u6027\u306b\u3042\u308b\u3088\u3046\u3067\u3059\u304c\u3001\u4e0b\u8a18\u306e\u30b0\u30e9\u30d5\u3092\u898b\u3066\u3082\u3089\u3046\u3068\u308f\u304b\u308b\u3088\u3046\u306b\u3001\u03b1\\alpha\u306b\u3064\u3044\u3066\u306f\u03b1=1\\alpha=1\u306e\u3042\u305f\u308a\u3067\u5927\u4f53\u66f2\u7dda\u306e\u6700\u5c0f\u5024\u3042\u305f\u308a\u306b\u843d\u3061\u3066\u3044\u307e\u3059\u3002\u3057\u304b\u3057\u3001\u7e26\u306e\u30e9\u30a4\u30f3\u306b\u3064\u3044\u3066\u306f\u3068\u3066\u3082\u7de9\u3084\u304b\u306a\u5909\u5316\u3057\u304b\u306a\u3044\u305f\u3081\u3001\u306a\u304b\u306a\u304b\u7e26\u306e\u52d5\u304d\u304c\u51fa\u308b\u52fe\u914d\u304c\u51fa\u3066\u3053\u306a\u3044\u306e\u3067\u3059\u3002\u3053\u308c\u304c\u901a\u5e38\u306e\u6700\u6025\u964d\u4e0b\u6cd5\u7b49\u3067\u3042\u308c\u3070\u3053\u306e\u66f2\u9762\u81ea\u4f53\u306f\u5909\u5316\u3057\u306a\u3044\u306e\u3067\u3001\u8c37\u306b\u6cbf\u3063\u3066\u7de9\u3084\u304b\u306b\u6700\u5c0f\u5024\u3092\u76ee\u6307\u3059\u306e\u3067\u3059\u304c\u3001\u305d\u3082\u305d\u3082\u6bce\u56de\u3053\u306e\u66f2\u9762\u304c\u5909\u308f\u3063\u3066\u3057\u307e\u3046\u3053\u3068\u304c\u539f\u56e0\u3067\u03b2\\beta\u65b9\u5411\u306e\u52d5\u304d\u304c\u751f\u307e\u308c\u306a\u3044\u3088\u3046\u3067\u3059\u3002\n\n\u3055\u3066\u3001\u78ba\u7387\u7684\u52fe\u914d\u964d\u4e0b\u6cd5\u306b\u3064\u3044\u3066\u30a4\u30e1\u30fc\u30b8\u304c\u6e67\u304d\u307e\u3057\u305f\u3067\u3057\u3087\u3046\u304b\uff1f\u79c1\u306f\u3053\u306e\u30a2\u30cb\u30e1\u30fc\u30b7\u30e7\u30f3\u30b0\u30e9\u30d5\u3092\u63cf\u304f\u3053\u3068\u3067\u30a4\u30e1\u30fc\u30b8\u304c\u3064\u304b\u3081\u307e\u3057\u305f\u3002\n\u3053\u306e\u78ba\u7387\u7684\u52fe\u914d\u964d\u4e0b\u6cd5\u306e\u30a2\u30cb\u30e1\u30fc\u30b7\u30e7\u30f3\u3092\u63cf\u304fpython\u30b3\u30fc\u30c9\u306f\u3053\u3061\u3089\u306b\u3042\u308a\u307e\u3059\u306e\u3067\u3001\u3088\u3051\u308c\u3070\u8a66\u3057\u3066\u307f\u3066\u304f\u3060\u3055\u3044\u3002\n\n(\u88dc\u8db3)\u56de\u5e30\u76f4\u7dda\u306e\u30d1\u30e9\u30e1\u30fc\u30bf\u3092\u6700\u5c24\u6cd5\u3067\u6c42\u3081\u308b\ny_n = f(x_n, \\alpha, \\beta) + \\epsilon_n\u3000\u3000\u3000\u3000(n =1,2,...,N)\nyn=f(xn,\u03b1,\u03b2)+\u03f5n\u3000\u3000\u3000\u3000(n=1,2,...,N){y_n = f(x_n, \\alpha, \\beta) + \\epsilon_n\u3000\u3000\u3000\u3000(n =1,2,...,N)\n}\n\u3064\u307e\u308a\u3001\u8aa4\u5dee\u306f\n\\epsilon_n = y_n - f(x_n, \\alpha, \\beta) \u3000\u3000\u3000\u3000(n =1,2,...,N)  \\\\\n\\epsilon_n = y_n -\\alpha x_n - \\beta\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\n\u03f5n=yn\u2212f(xn,\u03b1,\u03b2)\u3000\u3000\u3000\u3000(n=1,2,...,N)\u03f5n=yn\u2212\u03b1xn\u2212\u03b2\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000{\\epsilon_n = y_n - f(x_n, \\alpha, \\beta) \u3000\u3000\u3000\u3000(n =1,2,...,N)  \\\\\n\\epsilon_n = y_n -\\alpha x_n - \\beta\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\n}\n\u3067\u8868\u3059\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\u3053\u306e\u8aa4\u5dee\u03f5i\\epsilon_i\u3092\u5e73\u5747=0, \u5206\u6563=\u03c32\\sigma^2\u306e\u6b63\u898f\u5206\u5e03\u306b\u5f93\u3046\u3068\u3059\u308b\u3068\u3001\u8aa4\u5dee\u95a2\u6570\u306e\u5c24\u5ea6\u306f\n\nL = \\prod_{n=1}^{N} \\frac{1}{\\sqrt{2\\pi\\sigma^2}} \\exp \\left( -\\frac{\\epsilon_n^2}{2\\sigma^2} \\right)\nL=N\u220fn=11\u221a2\u03c0\u03c32exp(\u2212\u03f52n2\u03c32){\nL = \\prod_{n=1}^{N} \\frac{1}{\\sqrt{2\\pi\\sigma^2}} \\exp \\left( -\\frac{\\epsilon_n^2}{2\\sigma^2} \\right)\n}\n\u3067\u3042\u308a\u3001\u5bfe\u6570\u3092\u3068\u308b\u3068\n\n\\log L = -\\frac{N}{2} \\log (2\\pi\\sigma^2) -\\frac{1}{2\\sigma^2} \\sum_{n=1}^{N} \\epsilon_n^2\nlogL=\u2212N2log(2\u03c0\u03c32)\u221212\u03c32N\u2211n=1\u03f52n{\n\\log L = -\\frac{N}{2} \\log (2\\pi\\sigma^2) -\\frac{1}{2\\sigma^2} \\sum_{n=1}^{N} \\epsilon_n^2\n}\n\u3068\u306a\u308a\u3001\u30d1\u30e9\u30e1\u30fc\u30bf\u30fc\u03b1,beta\\alpha, beta\u306b\u4f9d\u5b58\u3059\u308b\u9805\u306e\u307f\u3092\u53d6\u308a\u51fa\u3059\u3068\nl(\\alpha, \\beta) = \\sum_{n=1}^{N} \\epsilon_n^2 = \\sum_{n=1}^{N} (y_n -\\alpha x_n - \\beta)^2\nl(\u03b1,\u03b2)=N\u2211n=1\u03f52n=N\u2211n=1(yn\u2212\u03b1xn\u2212\u03b2)2{l(\\alpha, \\beta) = \\sum_{n=1}^{N} \\epsilon_n^2 = \\sum_{n=1}^{N} (y_n -\\alpha x_n - \\beta)^2\n}\n\u3092\u6700\u5c0f\u5316\u3059\u308c\u3070\u826f\u3044\u3053\u3068\u304c\u308f\u304b\u308a\u307e\u3059\u3002\n\u3053\u308c\u3092\u8aa4\u5dee\u95a2\u6570\u3068\u3057\u3066\n\nE({\\bf w})=\\sum_{n=1}^{N} E_n({\\bf w}) = \\sum_{n=1}^{N} (y_n -\\alpha x_n - \\beta)^2 \\\\\n{\\bf w} = (\\alpha, \\beta)^{\\rm T}\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\nE(w)=N\u2211n=1En(w)=N\u2211n=1(yn\u2212\u03b1xn\u2212\u03b2)2w=(\u03b1,\u03b2)T\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000{\nE({\\bf w})=\\sum_{n=1}^{N} E_n({\\bf w}) = \\sum_{n=1}^{N} (y_n -\\alpha x_n - \\beta)^2 \\\\\n{\\bf w} = (\\alpha, \\beta)^{\\rm T}\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\n}\n\u3068\u8868\u73fe\u3057\u307e\u3059\u3002\n#\u52fe\u914d\u964d\u4e0b\u6cd5\u306f\u4f55\u306b\u4f7f\u3046\uff1f#\n\u52fe\u914d\u964d\u4e0b\u6cd5\u306f\u7d71\u8a08\u5b66\u3084\u6a5f\u68b0\u5b66\u7fd2\u3067\u591a\u304f\u4f7f\u308f\u308c\u3066\u3044\u307e\u3059\u3002\u7279\u306b\u6a5f\u68b0\u5b66\u7fd2\u3068\u3044\u3046\u306e\u306f\u57fa\u672c\u7684\u306b\u4f55\u304b\u3057\u3089\u306e\u95a2\u6570\u3092\u6700\u5c0f\u5316\uff08\u6700\u5927\u5316\uff09\u3059\u308b\u554f\u984c\u3092\u6570\u5024\u89e3\u6790\u7684\u306b\u89e3\u304f\u3053\u3068\u306b\u5e30\u7d50\u3059\u308b\u5834\u5408\u304c\u591a\u3044\u3067\u3059\u3002\uff08e.g. \u6700\u5c0f\u4e8c\u4e57\u6cd5 \u2192 \u8aa4\u5dee\u306e\u4e8c\u4e57\u548c\u3092\u6700\u5c0f\u5316\uff08[\u53c2\u8003](http://qiita.com/kenmatsu4/items/8b4e908d7c93d046110d)\uff09\u3001\u30cb\u30e5\u30fc\u30e9\u30eb\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306e\u30d1\u30e9\u30e1\u30fc\u30bf\u6c7a\u5b9a etc...\uff09\n\n\u306a\u306e\u3067\u3001\u57fa\u672c\u7684\u306b\u306f\u3072\u305f\u3059\u3089\u5fae\u5206\u3057\u30660\u3068\u306a\u308b\u3068\u3053\u308d\u3092\u63a2\u3059\u554f\u984c\u3067\u3059\u306d\u3001\u5fae\u5206\u3057\u30660\u3002\u3067\u3001\u305d\u306e\u5fae\u5206\u3057\u30660\u3068\u306a\u308b\u5024\u306f\u4f55\u304b\u3001\u3092\u30d7\u30ed\u30b0\u30e9\u30e0\u3067\u89e3\u304f\u5834\u5408\u306b\u91cd\u8981\u306b\u306a\u308b\u306e\u304c\u3053\u306e\u52fe\u914d\u964d\u4e0b\u6cd5\u3067\u3059\u3002\u5e7e\u3064\u304b\u52fe\u914d\u6cd5\u306b\u3082\u7a2e\u985e\u304c\u3042\u308a\u307e\u3059\u304c\u3053\u3053\u3067\u306f\u6700\u6025\u964d\u4e0b\u6cd5\u3001\u78ba\u7387\u7684\u52fe\u914d\u964d\u4e0b\u6cd5\u306e\uff12\u3064\u3092\u6271\u3044\u307e\u3059\u3002\u307e\u305a\u306f\u30a4\u30e1\u30fc\u30b8\u3092\u3064\u304b\u3080\u305f\u3081\u306b\uff11\u6b21\u5143\u306e\u30b0\u30e9\u30d5\u3067\u78ba\u8a8d\u3057\u3066\u3044\u304d\u305f\u3044\u3068\u601d\u3044\u307e\u3059\u3002\n\n##1\u6b21\u5143\u306e\u5834\u5408##\n1\u6b21\u5143\u306e\u5834\u5408\u306f\u3001\u78ba\u7387\u7684\u3068\u3044\u3046\u6982\u5ff5\u306f\u306a\u304f\u3001\u305f\u3060\u306e\u52fe\u914d\u964d\u4e0b\u6cd5\u306b\u306a\u308a\u307e\u3059\u3002\n\uff08\u3069\u3046\u3044\u3046\u3053\u3068\u304b\u3001\u306f\u306e\u3061\u307b\u3069\uff09\n1\u6b21\u5143\u306e\u4f8b\u306f\u3001\u6b63\u898f\u5206\u5e03\u3092\u30de\u30a4\u30ca\u30b9\u306b\u3057\u305f\u3082\u306e\u3092\u4f7f\u3063\u3066\u307f\u307e\u3059\u3002$x_{init} = 0$\u3068$x_{init} = 6$\u306e\u30b0\u30e9\u30d5\u3092\u4f8b\u3068\u3057\u3066\u4f5c\u3063\u3066\u3044\u307e\u3059\u3002\u5bfe\u8c61\u3068\u306a\u308b\u30b0\u30e9\u30d5\u306f\u6b63\u898f\u5206\u5e03\u306e\u5bc6\u5ea6\u95a2\u6570\u3092\u30de\u30a4\u30ca\u30b9\u3057\u3066\u4e0b\u5411\u304d\u306b\u3057\u305f\u3082\u306e\u3092\u4f7f\u3044\u307e\u3057\u305f\u3002\n\n\n**\u521d\u671f\u5024 = 0 \u306e\u30b0\u30e9\u30d5**\n\u30b0\u30e9\u30d5\u306e\u7aef\u304b\u3089\u59cb\u307e\u3063\u3066\u3001\u3061\u3083\u3093\u3068\u4e00\u756a\u5c0f\u3055\u3044\u3068\u3053\u308d\u3001\u6700\u5c0f\u5024\u3067\u53ce\u675f\u3057\u3066\u3044\u308b\u3053\u3068\u304c\u308f\u304b\u308a\u307e\u3059\u306d\u3002\u9752\u3044\u7dda\u306e\u30b0\u30e9\u30d5\u304c\u6b63\u898f\u5206\u5e03\u306e\u30de\u30a4\u30ca\u30b9\u7248\u3067\u3001\u7dd1\u306e\u7dda\u306e\u30b0\u30e9\u30d5\u304c\u305d\u306e\u5fae\u5206\u3057\u305f\u5024\u306e\u30b0\u30e9\u30d5\u3067\u3059\u3002\n![normdist_decent_0.0_anim-compressor.gif](https://qiita-image-store.s3.amazonaws.com/0/50670/1c51dc9e-c469-e97e-851e-a9a3ddf451fc.gif)\n\n**\u521d\u671f\u5024 = 6 \u306e\u30b0\u30e9\u30d5**\n![normdist_decent_6.0_anim-compressor.gif](https://qiita-image-store.s3.amazonaws.com/0/50670/0c80d559-a353-012c-4dd0-27ed5b763775.gif)\n\n\u5404\u70b9\u3067\u306e\u50be\u304d\u3092\u30d9\u30fc\u30b9\u306b\u6b21\u306e$x$\u306e\u5024\u3092\u6c7a\u3081\u3001\u307e\u305f\u305d\u306e\u4f4d\u7f6e\u3067\u306e\u50be\u304d\u3092\u8abf\u3079\u6b21\u306b\u964d\u4e0b\u3057\u3066\u884c\u304f\u3001\u3068\u3044\u3046\u4e8b\u3092\u7e70\u308a\u8fd4\u3057\u3066\u6700\u5c0f\u5024\uff08\u672c\u5f53\u306f\u6975\u5c0f\u5024\uff09\u306b\u305f\u3069\u308a\u7740\u304d\u307e\u3059\u3002\u4e0a\u306e\u4f8b\u3060\u3068\u3001\u6700\u5c0f\u5024\u306b\u8fd1\u305a\u304f\u306b\u3064\u308c\u3001\u50be\u304d\u3082\u306a\u3060\u3089\u304b\u306b\u306a\u3063\u3066\u3044\u304f\u306e\u3067\u30011\u56de\u306e\u30b9\u30c6\u30c3\u30d7\u3067\u9032\u3080\u91cf\u304c\u3060\u3093\u3060\u3093\u5c0f\u3055\u304f\u306a\u308a\u3001\u305d\u308c\u304c\u3042\u308b\u57fa\u6e96\u3088\u308a\u5c0f\u3055\u304f\u306a\u308b\u3068\u30b9\u30c8\u30c3\u30d7\u3059\u308b\u3001\u3068\u3044\u3046\u30ed\u30b8\u30c3\u30af\u3092\u7d44\u3093\u3067\u3044\u307e\u3059\u3002\n\n\u3053\u308c\u3089\uff12\u3064\u306e\u30b0\u30e9\u30d5\u3092\u66f8\u3044\u305f\u30b3\u30fc\u30c9\u306f[\u3053\u3061\u3089](https://gist.github.com/matsuken92/f92f8e8e4a1f924e6d99#file-1-dim-steepest-descent-py)\u3067\u3059\u3002\n\n###2\u6b21\u5143\u306e\u5834\u5408(2\u6b21\u95a2\u6570)###\n\u591a\u6b21\u5143\u306e\u5834\u5408\u306f\u6b21\u306e\u30b9\u30c6\u30c3\u30d7\u306b\u9032\u3080\u5411\u304d\u3082\u8003\u616e\u3057\u3066\u964d\u4e0b\u3057\u3066\u3044\u304d\u307e\u3059\u3002\u30bf\u30fc\u30b2\u30c3\u30c8\u3068\u306a\u308b\u95a2\u6570\u306b\u3088\u308a\u52d5\u304d\u306e\u7279\u5fb4\u304c\u5909\u308f\u308b\u306e\u3067\u3059\u304c\u3001\u6700\u521d\u306b2\u6b21\u95a2\u6570 $Z=-3x^2-5y^2+6xy$ \u3068\u3044\u3046\u95a2\u6570\u3092\u4f8b\u306b\u30b0\u30e9\u30d5\u3092\u66f8\u3044\u3066\u307f\u307e\u3057\u305f\u3002\u306a\u3093\u3060\u304b\u30b8\u30b0\u30b6\u30b0\u52d5\u304d\u306a\u304c\u3089\u9802\u70b9\u306b\u5411\u304b\u3063\u3066\u884c\u304f\u59ff\u3092\u307f\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n![quadratic_decent_anim-compressor.gif](https://qiita-image-store.s3.amazonaws.com/0/50670/dd0f96bf-a434-a495-3fe7-59c900a1e90f.gif)\n\n\n\u30b3\u30fc\u30c9\u306f[\u3053\u3061\u3089](https://gist.github.com/matsuken92/f92f8e8e4a1f924e6d99#file-2-dim-steepest-descent_quadrant-py)\n\n##2\u6b21\u5143\u306e\u5834\u5408##\n\n###2\u6b21\u5143\u306e\u5834\u5408(2\u6b21\u5143\u6b63\u898f\u5206\u5e03)###\n2\u6b21\u5143\u6b63\u898f\u5206\u5e03\uff08\u306b\u30de\u30a4\u30ca\u30b9\u3092\u304b\u3051\u305f\u3082\u306e\uff09\u306b\u5bfe\u3057\u3066\u6700\u6025\u964d\u4e0b\u6cd5\u3092\u9069\u7528\u3059\u308b\u3068\u30b8\u30b0\u30b6\u30b0\u52d5\u304b\u305a\u3001\u7dba\u9e97\u306b\u6700\u5c0f\u5024\u306b\u964d\u4e0b\u3057\u3066\u3044\u304f\u3053\u3068\u304c\u308f\u304b\u308a\u307e\u3057\u305f\u3002\u3053\u306e\u3042\u305f\u308a\u30bf\u30fc\u30b2\u30c3\u30c8\u95a2\u6570\u306b\u3088\u308b\u53ce\u675f\u306e\u69d8\u5b50\u306e\u9055\u3044\u306b\u3064\u3044\u3066\u306f\u4eca\u5ea6\u8abf\u3079\u3066\u307f\u305f\u3044\u3068\u601d\u3044\u307e\u3059\u3002\n![bi-normdist_decent_anim-compressor.gif](https://qiita-image-store.s3.amazonaws.com/0/50670/b9b22d2b-edca-bbd3-6659-091e559ce2db.gif)\n\n\n\u30b3\u30fc\u30c9\u306f[\u3053\u3061\u3089](https://gist.github.com/matsuken92/f92f8e8e4a1f924e6d99#file-2-dim-steepest-descent_normdist-py)\n\n###\u6700\u6025\u964d\u4e0b\u6cd5\u306e\u4ed5\u7d44\u307f###\n\u6700\u6025\u964d\u4e0b\u6cd5\u306e\u4ed5\u7d44\u307f\u306f\u3001\u307e\u305a\u6700\u521d\u306b\u30b9\u30bf\u30fc\u30c8\u5730\u70b9\u3092\u9078\u3073\u3001\u305d\u306e\u70b9\u3067\u306e\u4e00\u756a\u964d\u4e0b\u3059\u308b\u50be\u304d\u304c\u5927\u304d\u3044\u30d9\u30af\u30c8\u30eb\u3001\u3064\u307e\u308a\n\n```math\n\\nabla f = \\frac{d f({\\bf x})}{d {\\bf x}} = \\left[ \\begin{array}{r} \\frac{\\partial f}{\\partial x_1} \\\\ ... \\\\ \\frac{\\partial f}{\\partial x_2} \\end{array} \\right]\n```\n\u3092\u5229\u7528\u3057\u3066\u6b21\u306e\u30b9\u30c6\u30c3\u30d7\u306b\u884c\u304f\u65b9\u6cd5\u3067\u3059\u3002\u4e0a\u8a18\u306e\u30b0\u30e9\u30d5\u3067\u306f\u3001\u3053\u306e\u52fe\u914d\u30d9\u30af\u30c8\u30eb\u306b\u5b66\u7fd2\u7387$\\eta$\u3092\u304b\u3051\u305f\u3082\u306e\u3092\u76f4\u7dda\u3067\u8868\u3057\u3066\u3044\u307e\u3059\u3002\n\u306a\u306e\u3067\u3001\n\n```math\nx_{i+1} = x_i - \\eta \\nabla f\n```\n\u3068\u3044\u3046\u30b9\u30c6\u30c3\u30d7\u3092\u53ce\u675f\u3059\u308b\u307e\u3067\u7e70\u308a\u8fd4\u3059\u3001\u3068\u3044\u3046\u51e6\u7406\u3092\u884c\u3063\u3066\u3044\u307e\u3059\u3002\n\n##\u78ba\u7387\u7684\u52fe\u914d\u964d\u4e0b\u6cd5\u3068\u306f##\n\u3055\u3066\u3001\u6b21\u306b\u78ba\u7387\u7684\u52fe\u914d\u964d\u4e0b\u6cd5\u306b\u79fb\u308a\u305f\u3044\u3068\u601d\u3044\u307e\u3059\u3002\n\u307e\u305a\u3001\u5bfe\u8c61\u3068\u3059\u308b\u95a2\u6570\u3067\u3059\u304c\u3001\u4ee5\u524d[\u56de\u5e30\u5206\u6790\u306e\u8aac\u660e](http://qiita.com/kenmatsu4/items/1e37da1d55292035d985)\u3067\u4f7f\u3063\u305f\u56de\u5e30\u76f4\u7dda\u306e\u8aa4\u5dee\u95a2\u6570\u3092\u4f7f\u3063\u3066\u8aac\u660e\u3057\u305f\u3044\u3068\u601d\u3044\u307e\u3059\u3002\u3061\u3087\u3063\u3068\u305d\u306e\u89e3\u91c8\u3092\u5909\u3048\u3066\u3044\u308b\u90e8\u5206(\u6700\u5c24\u6cd5\u3092\u4f7f\u7528)\u3082\u3042\u308b\u306e\u3067[\u6587\u672b](http://qiita.com/kenmatsu4/items/d282054ddedbd68fecb0#http://qiita.com/kenmatsu4/items/d282054ddedbd68fecb0#\u88dc\u8db3\u56de\u5e30\u76f4\u7dda\u306e\u30d1\u30e9\u30e1\u30fc\u30bf\u3092\u6700\u5c24\u6cd5\u3067\u6c42\u3081\u308b)\u306b\u88dc\u8db3\u3068\u3057\u3066\u8a18\u8f09\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n\n\u30c7\u30fc\u30bf\u306f\u3001\n\n```math\ny_n = \\alpha x_n + \\beta + \\epsilon_n\u3000\u3000\u3000(\\alpha=1, \\beta=0)\\\\\n\\epsilon_n \u223c N(0, 2)\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\n```\n\n\u3068\u3044\u3046N=1000\u500b\u306e\u30c7\u30fc\u30bf\u30bb\u30c3\u30c8\u3092\u6e96\u5099\u3057\u3066\u3001\u305d\u306e\u56de\u5e30\u76f4\u7dda\u3092\u6c42\u3081\u308b\u4f8b\u3092\u4f7f\u7528\u3057\u307e\u3059\u3002\u6563\u5e03\u56f3\u306f\u4ee5\u4e0b\u306e\u901a\u308a\u3067\u3059\u3002\n\n![scatter-compressor.png](https://qiita-image-store.s3.amazonaws.com/0/50670/adf9be8d-1732-91fb-e1df-76c400bfef61.png)\n\n\u8aa4\u5dee\u95a2\u6570\u3001\n\n```math\n\nE({\\bf w})=\\sum_{n=1}^{N} E_n({\\bf w}) = \\sum_{n=1}^{N} (y_n -\\alpha x_n - \\beta)^2 \\\\\n{\\bf w} = (\\alpha, \\beta)^{\\rm T}\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\n```\n\u306e\u6700\u5c0f\u5024\u3092\u6c42\u3081\u3066\u3044\u304d\u307e\u3059\u304c\u3001\u307e\u305a\u52fe\u914d\u3092\u8a08\u7b97\u3059\u308b\u305f\u3081\u3001\u305d\u308c\u305e\u308c$\\alpha, \\beta$\u3067\u504f\u5fae\u5206\u3057\u305f\u52fe\u914d\u30d9\u30af\u30c8\u30eb\u3092\u5c0e\u51fa\u3057\u307e\u3059\u3002\n\n```math\n\n\\frac{\\partial E({\\bf w})}{\\partial \\alpha} = \\sum_{n=1}^{N} \\frac{\\partial E_n({\\bf w})}{\\partial \\alpha} = \n\\sum_{n=1}^N (2 x_n^2  \\alpha +  2 x_n \\beta - 2 x_n y_n )\\\\\n\n\\frac{\\partial E({\\bf w})}{\\partial \\beta} = \\sum_{n=1}^{N}\\frac{\\partial E_n({\\bf w})}{\\partial \\alpha} =\n\\sum_{n=1}^N (2\\beta + 2  x_n \\alpha - 2y_n)\u3000\u3000\u3000\n```\n\u306a\u306e\u3067\u3001\u52fe\u914d\u30d9\u30af\u30c8\u30eb\u306f\n\n```math\n\\nabla E({\\bf w}) = \\frac{d E({\\bf w}) }{d {\\bf w}} = \\left[ \\begin{array}{r} \\frac{\\partial E({\\bf w})}{\\partial \\alpha} \\\\ \\frac{\\partial E({\\bf w})}{\\partial \\beta} \\end{array} \\right] = \\sum_{n=1}^{N}\n\\nabla E_n({\\bf w}) = \\sum_{n=1}^{N} \\left[ \\begin{array}{r} \\frac{\\partial E_n({\\bf w})}{\\partial \\alpha} \\\\ \\frac{\\partial E_n({\\bf w})}{\\partial \\beta} \\end{array} \\right]=\n\\left[ \\begin{array}{r} \n2 x_n^2  \\alpha +  2 x_n \\beta - 2 x_n y_n \\\\ \n2\\beta + 2  x_n \\alpha - 2y_n \u3000\n\\end{array} \\right]\n```\n\u3068\u306a\u308a\u307e\u3059\u3002\n\n\u5358\u56de\u5e30\u76f4\u7dda\u3092\u6c42\u3081\u308b\u554f\u984c\u306a\u306e\u3067\u3001\u65b9\u7a0b\u5f0f\u3068\u3057\u3066\u89e3\u3044\u3066\u3082\u826f\u3044\u306e\u3067\u3059\u304c\u3001\u3053\u308c\u3092\u78ba\u7387\u7684\u52fe\u914d\u964d\u4e0b\u6cd5\u3092\u7528\u3044\u3066\u89e3\u304f\u3053\u3068\u3092\u884c\u3063\u3066\u3044\u304d\u307e\u3059\u3002\u3053\u3053\u3067N=1000\u500b\u306e\u5168\u3066\u306e\u30c7\u30fc\u30bf\u3092\u3059\u3079\u3066\u4f7f\u3046\u306e\u3067\u306f\u306a\u304f\u3001\u3053\u3053\u304b\u3089\u30e9\u30f3\u30c0\u30e0\u30b5\u30f3\u30d7\u30ea\u30f3\u30b0\u3057\u3066\u53d6\u308a\u51fa\u3057\u305f\u30c7\u30fc\u30bf\u306b\u5bfe\u3057\u3066\u52fe\u914d\u3092\u8a08\u7b97\u3057\u3001\u6b21\u306e\u30b9\u30c6\u30c3\u30d7\u3092\u6c7a\u3081\u308b\u306e\u304c\u3053\u306e\u624b\u6cd5\u306e\u30ad\u30e2\u3067\u3059\u3002\n\n\n\u307e\u305a\u3053\u306e\u30c7\u30fc\u30bf\u30bb\u30c3\u30c8\u304b\u308920\u500b\u30e9\u30f3\u30c0\u30e0\u306b\u53d6\u308a\u51fa\u3057\u3066\u30b0\u30e9\u30d5\u306b\u3057\u3066\u307f\u307e\u3059\u3002\u6a2a\u8ef8\u304c$\\alpha$\u3001\u7e26\u8ef8\u304c$\\beta$\u3001Z\u8ef8\u304c\u8aa4\u5dee$E(\\alpha,\\beta)$\u3067\u3059\u3002\n\n![SGD_4-compressor.png](https://qiita-image-store.s3.amazonaws.com/0/50670/50b5884b-23a0-8d1e-9597-3b3f3b83fac4.png)\n\n\u306a\u3093\u3068\u306a\u304f\u30b0\u30e9\u30d5\u306e\u6700\u5c0f\u5024\u304c$\\alpha=1, \\beta=0$\u3092\u4e2d\u5fc3\u306b\u6563\u3089\u3070\u3063\u3066\u3044\u308b\u304b\u3068\u601d\u3044\u307e\u3059\u3002\u4eca\u56de\u306f1000\u500b\u306e\u30c7\u30fc\u30bf\u304b\u3089\u30e9\u30f3\u30c0\u30e0\u306b3\u3064\u306e\u30c7\u30fc\u30bf\u3092\u30d4\u30c3\u30af\u30a2\u30c3\u30d7\u3057\u3066\u305d\u308c\u3092\u5143\u306b\u3053\u306e\u30b0\u30e9\u30d5\u3092\u66f8\u3044\u3066\u3044\u307e\u3059\u3002\n\u521d\u671f\u5024\u3092$\\alpha=-1.5, \\beta=-1.5$\u3001\u5b66\u7fd2\u7387\u3092\u30a4\u30c6\u30ec\u30fc\u30b7\u30e7\u30f3\u56de\u6570$t$\u306e\u9006\u6570\u306b\u6bd4\u4f8b\u3055\u305b\u3001\u3055\u3089\u306b\u305d\u306e\u5730\u70b9\u3067\u306e$E(\\alpha, \\beta)$\u306e\u9006\u6570\u3082\u304b\u3051\u305f\u3082\u306e\u3092\u4f7f\u3063\u3066\u307f\u307e\u3057\u305f\u3002\u3053\u306e\u5b66\u7fd2\u7387\u3068\u521d\u671f\u5024\u306e\u6c7a\u3081\u65b9\u306b\u3064\u3044\u3066\u8a66\u884c\u932f\u8aa4\u3059\u308b\u3057\u304b\u306a\u3044\u3088\u3046\u306a\u306e\u3067\u3059\u304c\u3001\u4f55\u304b\u826f\u3044\u63a2\u3057\u65b9\u3092\u3054\u5b58\u77e5\u306e\u65b9\u304c\u3044\u308c\u3070\u6559\u3048\u3066\u3082\u3089\u3048\u308b\u3068\u5b09\u3057\u3044\u3067\u3059\u3002\u3061\u3087\u3063\u3068\u9593\u9055\u3048\u308b\u3068\u3042\u3063\u3068\u3044\u3046\u9593\u306b\u70b9\u304c\u67a0\u5916\u306b\u98db\u3093\u3067\u884c\u3063\u3066\u623b\u3063\u3066\u3053\u306a\u304f\u306a\u308a\u307e\u3059\uff08\u7b11\uff09\n\n\u52fe\u914d\u3092\u6c7a\u3081\u308b\u8aa4\u5dee\u95a2\u6570\u304c\u4e71\u6570\u306b\u4f9d\u5b58\u3057\u3066\u3044\u308b\u306e\u3067\u6bce\u56de\u5909\u5316\u3057\u3066\u3044\u308b\u3053\u3068\u304c\u898b\u3066\u53d6\u308c\u307e\u3059\u3002\u56de\u5e30\u76f4\u7dda\u3082\u6700\u521d\u306f\u76f8\u5f53\u66b4\u308c\u3066\u3044\u307e\u3059\u304c\u3001\u3060\u3093\u3060\u3093\u5927\u4eba\u3057\u304f\u306a\u3063\u3066\u53ce\u675f\u3057\u3066\u3044\u304f\u69d8\u304c\u308f\u304b\u308b\u3068\u601d\u3044\u307e\u3059\u3002\n<img src=\"https://qiita-image-store.s3.amazonaws.com/0/50670/00f7ea3a-93d9-1891-1082-22ab567cf1c5.gif\" width=\"512\" height=\"512\" ></img>\n\n\u6b63\u76f4\u3001\u4e0a\u8a18\u306e\u30a2\u30cb\u30e1\u30fc\u30b7\u30e7\u30f3\u306e\u4f8b\u306f\u53ce\u675f\u304c\u826f\u3044\u65b9\u306e\u3082\u306e\u3067\u3057\u3066\u3001\u4e0b\u8a18\u306b10000\u56de\u7e70\u308a\u8fd4\u3057\u305f\u969b\u306e$\\alpha$\u3068$\\beta$\u306e\u53ce\u675f\u5177\u5408\u3092\u30b0\u30e9\u30d5\u306b\u3057\u305f\u3082\u306e\u3092\u8f09\u305b\u3066\u3044\u307e\u3059\u304c\u3001$\\alpha$\u306f\u771f\u306e\u50241\u306b\u8fd1\u3065\u3044\u3066\u3044\u308b\u306e\u3067\u3059\u304c\u3001$\\beta$\u306f0.5\u306e\u3042\u305f\u308a\u3067\u53ce\u675f\u3057\u3066\u3057\u307e\u3044\u3001\u771f\u306e\u5024\u306e0\u306b\u3053\u308c\u4ee5\u4e0a\u8fd1\u3065\u304d\u305d\u3046\u306b\u3042\u308a\u307e\u305b\u3093\u3002\n\n![result_10000r-compressor.png](https://qiita-image-store.s3.amazonaws.com/0/50670/8bbcccd6-21d5-90e1-de4f-941fe68495cb.png)\n\n\u3053\u308c\u306f\u305d\u3082\u305d\u3082\u306e\u4eca\u56de\u306e\u56de\u5e30\u76f4\u7dda\u306e\u8aa4\u5dee\u95a2\u6570\u306e\u7279\u6027\u306b\u3042\u308b\u3088\u3046\u3067\u3059\u304c\u3001\u4e0b\u8a18\u306e\u30b0\u30e9\u30d5\u3092\u898b\u3066\u3082\u3089\u3046\u3068\u308f\u304b\u308b\u3088\u3046\u306b\u3001$\\alpha$\u306b\u3064\u3044\u3066\u306f$\\alpha=1$\u306e\u3042\u305f\u308a\u3067\u5927\u4f53\u66f2\u7dda\u306e\u6700\u5c0f\u5024\u3042\u305f\u308a\u306b\u843d\u3061\u3066\u3044\u307e\u3059\u3002\u3057\u304b\u3057\u3001\u7e26\u306e\u30e9\u30a4\u30f3\u306b\u3064\u3044\u3066\u306f\u3068\u3066\u3082\u7de9\u3084\u304b\u306a\u5909\u5316\u3057\u304b\u306a\u3044\u305f\u3081\u3001\u306a\u304b\u306a\u304b\u7e26\u306e\u52d5\u304d\u304c\u51fa\u308b\u52fe\u914d\u304c\u51fa\u3066\u3053\u306a\u3044\u306e\u3067\u3059\u3002\u3053\u308c\u304c\u901a\u5e38\u306e\u6700\u6025\u964d\u4e0b\u6cd5\u7b49\u3067\u3042\u308c\u3070\u3053\u306e\u66f2\u9762\u81ea\u4f53\u306f\u5909\u5316\u3057\u306a\u3044\u306e\u3067\u3001\u8c37\u306b\u6cbf\u3063\u3066\u7de9\u3084\u304b\u306b\u6700\u5c0f\u5024\u3092\u76ee\u6307\u3059\u306e\u3067\u3059\u304c\u3001\u305d\u3082\u305d\u3082\u6bce\u56de\u3053\u306e\u66f2\u9762\u304c\u5909\u308f\u3063\u3066\u3057\u307e\u3046\u3053\u3068\u304c\u539f\u56e0\u3067$\\beta$\u65b9\u5411\u306e\u52d5\u304d\u304c\u751f\u307e\u308c\u306a\u3044\u3088\u3046\u3067\u3059\u3002\n\n![graph2-compressor.png](https://qiita-image-store.s3.amazonaws.com/0/50670/649f7efe-b7f2-90ef-d86e-e43c1bc02e2d.png)\n\n\u3055\u3066\u3001\u78ba\u7387\u7684\u52fe\u914d\u964d\u4e0b\u6cd5\u306b\u3064\u3044\u3066\u30a4\u30e1\u30fc\u30b8\u304c\u6e67\u304d\u307e\u3057\u305f\u3067\u3057\u3087\u3046\u304b\uff1f\u79c1\u306f\u3053\u306e\u30a2\u30cb\u30e1\u30fc\u30b7\u30e7\u30f3\u30b0\u30e9\u30d5\u3092\u63cf\u304f\u3053\u3068\u3067\u30a4\u30e1\u30fc\u30b8\u304c\u3064\u304b\u3081\u307e\u3057\u305f\u3002\n\u3053\u306e\u78ba\u7387\u7684\u52fe\u914d\u964d\u4e0b\u6cd5\u306e\u30a2\u30cb\u30e1\u30fc\u30b7\u30e7\u30f3\u3092\u63cf\u304fpython\u30b3\u30fc\u30c9\u306f[\u3053\u3061\u3089](https://gist.github.com/matsuken92/f92f8e8e4a1f924e6d99#file-2-dim-stocastic-descent_quadrant-py)\u306b\u3042\u308a\u307e\u3059\u306e\u3067\u3001\u3088\u3051\u308c\u3070\u8a66\u3057\u3066\u307f\u3066\u304f\u3060\u3055\u3044\u3002\n\n###(\u88dc\u8db3)\u56de\u5e30\u76f4\u7dda\u306e\u30d1\u30e9\u30e1\u30fc\u30bf\u3092\u6700\u5c24\u6cd5\u3067\u6c42\u3081\u308b###\n\n```math\ny_n = f(x_n, \\alpha, \\beta) + \\epsilon_n\u3000\u3000\u3000\u3000(n =1,2,...,N)\n```\n\u3064\u307e\u308a\u3001\u8aa4\u5dee\u306f\n\n```math\n\\epsilon_n = y_n - f(x_n, \\alpha, \\beta) \u3000\u3000\u3000\u3000(n =1,2,...,N)  \\\\\n\\epsilon_n = y_n -\\alpha x_n - \\beta\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\n```\n\u3067\u8868\u3059\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\u3053\u306e\u8aa4\u5dee$\\epsilon_i$\u3092\u5e73\u5747=0, \u5206\u6563=$\\sigma^2$\u306e\u6b63\u898f\u5206\u5e03\u306b\u5f93\u3046\u3068\u3059\u308b\u3068\u3001\u8aa4\u5dee\u95a2\u6570\u306e\u5c24\u5ea6\u306f\n\n```math\n\nL = \\prod_{n=1}^{N} \\frac{1}{\\sqrt{2\\pi\\sigma^2}} \\exp \\left( -\\frac{\\epsilon_n^2}{2\\sigma^2} \\right)\n````\n\n\u3067\u3042\u308a\u3001\u5bfe\u6570\u3092\u3068\u308b\u3068\n\n```math\n\n\\log L = -\\frac{N}{2} \\log (2\\pi\\sigma^2) -\\frac{1}{2\\sigma^2} \\sum_{n=1}^{N} \\epsilon_n^2\n```\n\n\u3068\u306a\u308a\u3001\u30d1\u30e9\u30e1\u30fc\u30bf\u30fc$\\alpha, beta$\u306b\u4f9d\u5b58\u3059\u308b\u9805\u306e\u307f\u3092\u53d6\u308a\u51fa\u3059\u3068\n\n```math\nl(\\alpha, \\beta) = \\sum_{n=1}^{N} \\epsilon_n^2 = \\sum_{n=1}^{N} (y_n -\\alpha x_n - \\beta)^2\n```\n\u3092\u6700\u5c0f\u5316\u3059\u308c\u3070\u826f\u3044\u3053\u3068\u304c\u308f\u304b\u308a\u307e\u3059\u3002\n\u3053\u308c\u3092\u8aa4\u5dee\u95a2\u6570\u3068\u3057\u3066\n\n```math\n\nE({\\bf w})=\\sum_{n=1}^{N} E_n({\\bf w}) = \\sum_{n=1}^{N} (y_n -\\alpha x_n - \\beta)^2 \\\\\n{\\bf w} = (\\alpha, \\beta)^{\\rm T}\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\n```\n\u3068\u8868\u73fe\u3057\u307e\u3059\u3002\n\n<!--\n**\u4ee5\u4e0b\u3001\u5f53\u521d\u78ba\u7387\u7684\u52fe\u914d\u964d\u4e0b\u6cd5\u306e\u79c1\u306e\u89e3\u91c8\u306b\u8aa4\u308a\u304c\u3042\u308b\u3053\u3068\u304c\u3044\u305f\u3060\u3044\u305f\u30b3\u30e1\u30f3\u30c8\u3067\u5206\u304b\u308a\u307e\u3057\u305f\u306e\u3067\u8a02\u6b63\u3092\u3057\u3066\u304a\u308a\u307e\u3059\u3002\u540c\u3058\u52d8\u9055\n\n\u3066\u3001\u66f8\u304d\u76f4\u3057\u3092\u3057\u3066\u3044\u307e\u3059\u3002\u672c\u6765\u30e9\u30f3\u30c0\u30e0\u30d4\u30c3\u30af\u30a2\u30c3\u30d7\u3059\u308b\u306e\u306f\u30c7\u30fc\u30bf\u70b9\u306a\u306e\u3067\u3059\u304c\u3001\u4e0b\u8a18\u306e\u8aac\u660e\u3067\u306fm\u6b21\u5143\u306e\u52fe\u914d\u304b\u3089\uff11\u3064\u9078\u3076\u3001\u3068\u3044\u3046\u8aa4\u89e3\u304c\u3042\u308a\u307e\u3057\u305f\u3002\u3059\u307f\u307e\u305b\u3093\u30fb\u30fb\u30fb**\n\n\n<S>\n\u6700\u6025\u964d\u4e0b\u6cd5\u3067\u306f\u5404\u70b9\u3067\u4e00\u756a\u964d\u4e0b\u3059\u308b\u50be\u304d\u304c\u5927\u304d\u3044\u30d9\u30af\u30c8\u30eb\u3092\u504f\u5fae\u5206\u3059\u308b\u3053\u3068\u3067\u6c42\u3081\u3066\u6b21\u306e\u30b9\u30c6\u30c3\u30d7\u306b\u884c\u304f\u65b9\u6cd5\u3067\u3059\u304c\u3001\u3053\u3053\u3067\u6271\u3063\u3066\u3044\u305f2\u6b21\u5143\u7a0b\u5ea6\u306e\u95a2\u6570\u3067\u3042\u308c\u3070\u3055\u307b\u3069\u5927\u304d\u306a\u8a08\u7b97\u91cf\u306b\u306a\u3089\u306a\u3044\u306e\u3067\u3059\u304c\u3001\u6570\u767e\u3001\u6570\u5343\u3001\u3082\u3063\u3068\u591a\u3044\u6b21\u5143\u306e\u30a4\u30f3\u30d7\u30c3\u30c8\u304c\u3042\u3063\u305f\u5834\u5408\u3001\u76f8\u5f53\u306e\u8a08\u7b97\u91cf\u306b\u306a\u3063\u3066\u3057\u307e\u3044\u53ce\u675f\u3057\u306a\u304f\u306a\u3063\u3066\u3057\u307e\u3046\u30b1\u30fc\u30b9\u304c\u51fa\u3066\u304d\u3066\u3057\u307e\u3044\u307e\u3059\u3002\uff08\u79c1\u304c\u3088\u304f\u6271\u3063\u3066\u3044\u308b\u624b\u66f8\u304d\u6570\u5b57\u30c7\u30fc\u30bf\u306e\u5834\u5408\u3067\u3082\u3001784\u6b21\u5143\u306e\u30c7\u30fc\u30bf\u304c\u30a4\u30f3\u30d7\u30c3\u30c8\u306b\u306a\u308b\u306e\u3067\u30011\u30b9\u30c6\u30c3\u30d7\u306e\u8a08\u7b97\u3060\u3051\u30672\u6b21\u5143\u306e392\u500d\uff01\uff09</S>\n\n<S>\u306a\u306e\u3067\u3001</S>\n\n```math\n\\nabla f = \\frac{d f({\\bf x})}{d {\\bf x}} = \\left[ \\begin{array}{r} \\frac{\\partial f}{\\partial x_1} \\\\ ... \\\\ \\frac{\\partial f}{\\partial x_2} \\end{array} \\right]\n```\n\n<S>\u306e\u3088\u3046\u306b\u5168\u65b9\u5411\u306e\u52fe\u914d\u30d9\u30af\u30c8\u30eb\u3092\u4f7f\u3046\u306e\u3067\u306f\u306a\u304f\u3001\u3053\u306e\u4e2d\u304b\u3089\u30e9\u30f3\u30c0\u30e0\u306b\uff11\u3064\n\n```math\n\\nabla f = \\frac{\\partial f}{\\partial x_i}\n```\n\n<S>\u3092\u9078\u3093\u3067\uff08\u8907\u6570\u9078\u3076\u30b1\u30fc\u30b9\u3082\u3042\u308b\uff09\u305d\u306e\u65b9\u5411\u306e\u307f\u306b\u964d\u4e0b\u3059\u308b\u4e8b\u3092\u884c\u3044\u307e\u3059\u3002\u3053\u3046\u3059\u308b\u3068\u3001\u5168\u65b9\u5411\u306e\u504f\u5fae\u5206\u3092\u6c42\u3081\u306a\u304f\u3066\u6e08\u3080\u306e\u3067\u8a08\u7b97\u91cf\u304c\u304b\u306a\u308a\u6e1b\u308a\u307e\u3059\u3002\u30e9\u30f3\u30c0\u30e0\u306b\u9078\u3076\u3001\u3068\u3044\u3046\u306e\u304c\u201d\u78ba\u7387\u7684\u201d\u3068\u540d\u304c\u4ed8\u3044\u3066\u3044\u308b\u7531\u6765\u3067\u3059\u306d\u3002</S>\n\n###\u30b0\u30e9\u30d5\u306b\u66f8\u3044\u3066\u307f\u308b###\n<S>\"\u78ba\u7387\u7684\"\u3068\u3044\u3046\u3060\u3051\u3042\u3063\u3066\u3001\u6bce\u56de\u3001\u6700\u5c0f\u5024\u306b\u81f3\u308b\u30d1\u30b9\u304c\u9055\u3044\u307e\u3059\u3002\u4e0b\u306b\u30b0\u30e9\u30d5\u3092\uff12\u3064\u66f8\u3044\u3066\u307f\u305f\u306e\u3067\u898b\u3066\u307f\u307e\u3057\u3087\u3046\u3002</S>\n\n![quadratic_decent_stchastic_anim_1-compressor.gif](https://qiita-image-store.s3.amazonaws.com/0/50670/0e5ccd94-930c-c1b1-34dc-871518c86f72.gif)\n![quadratic_decent_stchastic_anim_2-compressor-2.gif](https://qiita-image-store.s3.amazonaws.com/0/50670/f3f16c2c-fc0e-4ec2-37d7-738425747349.gif)\n\n\n<S>\u30b3\u30fc\u30c9\u306f[\u3053\u3061\u3089](https://gist.github.com/matsuken92/f92f8e8e4a1f924e6d99#file-2-dim-stocastic-descent_quadrant-py)</S>\n\n<S>\u3069\u3061\u3089\u3082\u6b63\u76f4\u7cbe\u5ea6\u304c\u826f\u3044\u611f\u3058\u304c\u3057\u306a\u3044\u3067\u3059\u306d\uff08\u7b11\uff09\u305f\u3060\u3001\u4eca\u56de\u306f\u56f3\u793a\u3059\u308b\u305f\u30812\u6b21\u5143\u95a2\u6570\u3092\u6271\u3044\u307e\u3057\u305f\u306e\u3067\u3001\u3053\u306e\u8a08\u7b97\u91cf\u3060\u3063\u305f\u3089\u7d20\u76f4\u306b\u6700\u6025\u964d\u4e0b\u6cd5\u3092\u4f7f\u3063\u305f\u307b\u3046\u304c\u826f\u3044\u3068\u3044\u3046\u3053\u3068\u3067\u3059\u306d\u3002\u4e0a\u306b\u3042\u308b2\u6b21\u95a2\u6570\u306e\u6700\u6025\u964d\u4e0b\u6cd5\u306e\u5834\u5408\u3001n=35\u56den=\u3067\u53ce\u675f\u57fa\u6e96\u3092\u6e80\u305f\u3057\u7d42\u308f\u3063\u3066\u3044\u307e\u3059\u304c\u3001\u78ba\u7387\u7684\u52fe\u914d\u964d\u4e0b\u6cd5\u3092\u306e\u5834\u5408\u306fn=40\u56de\u30670.3\u4ee5\u4e0a\u306e\u8aa4\u5dee\u3092\u6b8b\u3057\u6253\u3061\u6b62\u3081\u3068\u306a\u3063\u3066\u3044\u307e\u3059\u3002\uff08Qiita\u306egif\u30a2\u30cb\u30e1\u306e\u5bb9\u91cf\u5236\u96501MB\u306b\u3088\u308a\u3001\u3053\u308c\u4ee5\u4e0a\u306e\u56de\u6570\u3092\u30a2\u30cb\u30e1\u30fc\u30b7\u30e7\u30f3\u3067\u8868\u793a\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f\u30fb\u30fb\u30fb\uff09</S>\n<S>\u305f\u3060\u3057\u3001\u8a08\u7b97\u56de\u6570\u3067\u8003\u3048\u308b\u3068\u3001</S>\n\n<S>\u30fb\u6700\u6025\u964d\u4e0b\u6cd5</S>\n<S>\u3000\u21d2 2(\u6b21\u5143) \u00d7 35(\u56de\u3067\u53ce\u675f)  = 70\u56de\u306e\u8a08\u7b97</S>\n\n<S>\u30fb\u78ba\u7387\u7684\u52fe\u914d\u964d\u4e0b\u6cd5\uff08\u30e9\u30f3\u30c0\u30e0\u306b1\u6b21\u5143\u9078\u629e\u3059\u308b\uff09</S>\n<S>\u3000\u21d2 1(\u6b21\u5143) \u00d7 40(\u56de\u3067\u53ce\u675f)  = 40\u56de\u306e\u8a08\u7b97</S>\n\n<S>\u306a\u306e\u3067\u3001\u8a08\u7b97\u56de\u6570\u304c\u5c11\u306a\u3044\u306e\u3067\u3059\u3002\u7279\u306b\u6b21\u5143\u6570\u304c\u591a\u3044\u5834\u5408\u306f\u5287\u7684\u306b\u56de\u6570\u304c\u5909\u308f\u3063\u3066\u304d\u307e\u3059\u3002\u6b21\u5143\u6570\u304c\u591a\u3044\u5834\u5408\u306f\u78ba\u7387\u7684\u52fe\u914d\u964d\u4e0b\u6cd5\u3092\u4f7f\u3063\u305f\u307b\u3046\u304c\u826f\u3044\u30b1\u30fc\u30b9\u304c\u3042\u308a\u305d\u3046\u3067\u3059\u306d\u3002</S>\n-->\n<!--\n```math\n\nf({\\bf x}; {\\bf \\mu}, \\Sigma) = \\frac{1}{(2\\pi)^{D/2}} \\frac{1}{|\\Sigma|^{1/2} }  \\exp{ \\left( ({\\bf x - \\mu})^{{\\rm T}}\\Sigma^{-1}(x)({\\bf x - \\mu}) \\right)}\n\n```\n\n```math\n\n\\frac{d f({\\bf x}; {\\bf \\mu}, \\Sigma)}{d{\\bf x}} = 2\\Sigma^{-1}{\\bf x}\n\\frac{1}{(2\\pi)^{D/2}} \\frac{1}{|\\Sigma|^{1/2} }  \\exp{ \\left( ({\\bf x - \\mu})^{{\\rm T}}\\Sigma^{-1}(x)({\\bf x - \\mu}) \\right)}\n\n```\n-->\n"}