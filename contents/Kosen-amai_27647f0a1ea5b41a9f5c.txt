{"context": "\n\n\u6982\u8981\nGUI\u306e\u5165\u529b\u753b\u9762\u3092\u8868\u793a\u3059\u308b\u30b5\u30f3\u30d7\u30eb\u3002\n\n\u30b3\u30fc\u30c9\nAdd-Type -AssemblyName PresentationFramework\n[xml]$xaml = @'\n<Window xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\" \n  xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\" Title=\"\u5165\u529b\u753b\u9762\">\n<StackPanel>\n  <TextBlock Text=\"\u65e5\u4ed8\u3092\u5165\u529b\u2193\" />\n  <StackPanel Orientation=\"Horizontal\">\n    <DatePicker Name=\"cal\" />\n    <TextBlock Text=\"{Binding ElementName=cal, Path=SelectedDate, StringFormat='\u9078\u629e\u3057\u305f\u65e5\u4ed8\uff1ayyyy/MM/dd', Mode=OneWay}\" Margin=\"20,0,0,0\" />\n  </StackPanel>\n  <TextBlock Text=\"\u30c6\u30ad\u30b9\u30c8\u3092\u5165\u529b\u2193\" Margin=\"0,10,0,0\" />\n  <TextBox Name=\"inTxt\" Text=\"\"/>\n  <CheckBox Name=\"chk\" Content=\"\u30c1\u30a7\u30c3\u30af\" IsChecked=\"True\" Margin=\"0,10,0,0\" />\n  <Button Name=\"okButton\" Content=\"OK\" IsDefault=\"True\" Margin=\"0,10,0,0\" />\n  <TextBlock Name=\"errTxt\" Text=\"\" Foreground=\"Red\" Margin=\"0,20,0,0\" />\n</StackPanel>\n</Window>\n'@\n$reader = (New-Object System.Xml.XmlNodeReader $xaml)\n$window = [Windows.Markup.XamlReader]::Load($reader)\n\n$calendar1 = $window.FindName(\"cal\")\n$inputText1 = $window.FindName(\"inTxt\")\n$checkbox1 = $window.FindName(\"chk\")\n$btn1 = $window.FindName(\"okButton\")\n$errorText1 = $window.FindName(\"errTxt\")\n\n# \u30ab\u30ec\u30f3\u30c0\u30fc\u306e\u521d\u671f\u8a2d\u5b9a\uff08\u904e\u53bb\u306e\u65e5\u4ed8\u3092\u9078\u629e\u4e0d\u53ef\u306b\u3059\u308b\uff09\n$calendar_loaded = $calendar1.add_Loaded\n$calendar_loaded.Invoke({\n  $calendar1.BlackoutDates.AddDatesInPast()\n})\n\n# \u5b9f\u884c\u30dc\u30bf\u30f3\u62bc\u4e0b\u6642\u306e\u51e6\u7406\n$btn_clicked = $btn1.add_Click\n$btn_clicked.Invoke({\n  # \u5165\u529b\u30c1\u30a7\u30c3\u30af\n  if ($calendar1.SelectedDate -eq $null)\n  {\n      $errorText1.Text = \"\u65e5\u4ed8\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044\u3002\"\n      return\n  }\n  if ($inputText1.Text -eq \"\")\n  {\n      $errorText1.Text = \"\u30c6\u30ad\u30b9\u30c8\u3092\u4f55\u304b\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044\u3002\"\n      return\n  }\n\n  # \u5165\u529b\u5024\u3092\u30b3\u30f3\u30bd\u30fc\u30eb\u306b\u8868\u793a\n  [string]$str1 = $calendar1.SelectedDate.ToString(\"yyyy/MM/dd\")\n  [string]$str2 = $inputText1.Text\n  [string]$str3 = $checkbox1.IsChecked.ToString()\n  Write-Host \"\u65e5\u4ed8\uff1a${str1}\u3001\u30c6\u30ad\u30b9\u30c8\uff1a${str2}\u3001\u30c1\u30a7\u30c3\u30af\uff1a${str3}\" -BackgroundColor Blue\n  # \u30a6\u30a3\u30f3\u30c9\u30a6\u3092\u9589\u3058\u308b\n  $window.Close()\n})\n\n# \u30a6\u30a3\u30f3\u30c9\u30a6\u8868\u793a\n$window.ShowDialog() > $null\n\n\n\u5b9f\u884c\u4f8b\n\n\u65e5\u4ed8\u3092\u9078\u629e\u3002\n\n\u65e5\u4ed8\u3068\u30c6\u30ad\u30b9\u30c8\u3092\u5165\u529b\u3057\u305f\u3089OK\u30dc\u30bf\u30f3\u3092\u62bc\u3059\u3002\n\n\u30c0\u30a4\u30a2\u30ed\u30b0\u304c\u9589\u3058\u3066\u30b3\u30f3\u30bd\u30fc\u30eb\u306b\u30e1\u30c3\u30bb\u30fc\u30b8\u304c\u51fa\u529b\u3055\u308c\u308b\u3002\n\n\n\u52d5\u4f5c\u78ba\u8a8d\u3057\u305f\u74b0\u5883\n\nPowerShell V4 (Windows 8.1)\nPowerShell V5 (Windows 10)\n\n# \u6982\u8981\nGUI\u306e\u5165\u529b\u753b\u9762\u3092\u8868\u793a\u3059\u308b\u30b5\u30f3\u30d7\u30eb\u3002\n\n# \u30b3\u30fc\u30c9\n\n```PowerShell\nAdd-Type -AssemblyName PresentationFramework\n[xml]$xaml = @'\n<Window xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\" \n  xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\" Title=\"\u5165\u529b\u753b\u9762\">\n<StackPanel>\n  <TextBlock Text=\"\u65e5\u4ed8\u3092\u5165\u529b\u2193\" />\n  <StackPanel Orientation=\"Horizontal\">\n    <DatePicker Name=\"cal\" />\n    <TextBlock Text=\"{Binding ElementName=cal, Path=SelectedDate, StringFormat='\u9078\u629e\u3057\u305f\u65e5\u4ed8\uff1ayyyy/MM/dd', Mode=OneWay}\" Margin=\"20,0,0,0\" />\n  </StackPanel>\n  <TextBlock Text=\"\u30c6\u30ad\u30b9\u30c8\u3092\u5165\u529b\u2193\" Margin=\"0,10,0,0\" />\n  <TextBox Name=\"inTxt\" Text=\"\"/>\n  <CheckBox Name=\"chk\" Content=\"\u30c1\u30a7\u30c3\u30af\" IsChecked=\"True\" Margin=\"0,10,0,0\" />\n  <Button Name=\"okButton\" Content=\"OK\" IsDefault=\"True\" Margin=\"0,10,0,0\" />\n  <TextBlock Name=\"errTxt\" Text=\"\" Foreground=\"Red\" Margin=\"0,20,0,0\" />\n</StackPanel>\n</Window>\n'@\n$reader = (New-Object System.Xml.XmlNodeReader $xaml)\n$window = [Windows.Markup.XamlReader]::Load($reader)\n\n$calendar1 = $window.FindName(\"cal\")\n$inputText1 = $window.FindName(\"inTxt\")\n$checkbox1 = $window.FindName(\"chk\")\n$btn1 = $window.FindName(\"okButton\")\n$errorText1 = $window.FindName(\"errTxt\")\n\n# \u30ab\u30ec\u30f3\u30c0\u30fc\u306e\u521d\u671f\u8a2d\u5b9a\uff08\u904e\u53bb\u306e\u65e5\u4ed8\u3092\u9078\u629e\u4e0d\u53ef\u306b\u3059\u308b\uff09\n$calendar_loaded = $calendar1.add_Loaded\n$calendar_loaded.Invoke({\n  $calendar1.BlackoutDates.AddDatesInPast()\n})\n\n# \u5b9f\u884c\u30dc\u30bf\u30f3\u62bc\u4e0b\u6642\u306e\u51e6\u7406\n$btn_clicked = $btn1.add_Click\n$btn_clicked.Invoke({\n  # \u5165\u529b\u30c1\u30a7\u30c3\u30af\n  if ($calendar1.SelectedDate -eq $null)\n  {\n      $errorText1.Text = \"\u65e5\u4ed8\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044\u3002\"\n      return\n  }\n  if ($inputText1.Text -eq \"\")\n  {\n      $errorText1.Text = \"\u30c6\u30ad\u30b9\u30c8\u3092\u4f55\u304b\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044\u3002\"\n      return\n  }\n  \n  # \u5165\u529b\u5024\u3092\u30b3\u30f3\u30bd\u30fc\u30eb\u306b\u8868\u793a\n  [string]$str1 = $calendar1.SelectedDate.ToString(\"yyyy/MM/dd\")\n  [string]$str2 = $inputText1.Text\n  [string]$str3 = $checkbox1.IsChecked.ToString()\n  Write-Host \"\u65e5\u4ed8\uff1a${str1}\u3001\u30c6\u30ad\u30b9\u30c8\uff1a${str2}\u3001\u30c1\u30a7\u30c3\u30af\uff1a${str3}\" -BackgroundColor Blue\n  # \u30a6\u30a3\u30f3\u30c9\u30a6\u3092\u9589\u3058\u308b\n  $window.Close()\n})\n\n# \u30a6\u30a3\u30f3\u30c9\u30a6\u8868\u793a\n$window.ShowDialog() > $null\n```\n\n\n# \u5b9f\u884c\u4f8b\n![ps05.png](https://qiita-image-store.s3.amazonaws.com/0/142879/13cbafce-0ead-fe96-0f33-7908e0c54059.png)\n\n\u65e5\u4ed8\u3092\u9078\u629e\u3002\n![ps06.png](https://qiita-image-store.s3.amazonaws.com/0/142879/5345a519-7a6a-7cfc-7e50-c60ba3e3b2d5.png)\n\n\u65e5\u4ed8\u3068\u30c6\u30ad\u30b9\u30c8\u3092\u5165\u529b\u3057\u305f\u3089OK\u30dc\u30bf\u30f3\u3092\u62bc\u3059\u3002\n![ps07.png](https://qiita-image-store.s3.amazonaws.com/0/142879/42a64bf8-8a87-4bbc-aa44-9ac31972567f.png)\n\n\u30c0\u30a4\u30a2\u30ed\u30b0\u304c\u9589\u3058\u3066\u30b3\u30f3\u30bd\u30fc\u30eb\u306b\u30e1\u30c3\u30bb\u30fc\u30b8\u304c\u51fa\u529b\u3055\u308c\u308b\u3002\n![ps08.png](https://qiita-image-store.s3.amazonaws.com/0/142879/6fc19132-4379-542e-b4c4-d564a2bfb936.png)\n\n\n\n\n# \u52d5\u4f5c\u78ba\u8a8d\u3057\u305f\u74b0\u5883\n* PowerShell V4 (Windows 8.1)\n* PowerShell V5 (Windows 10)\n", "tags": ["PowerShell", "WPF", "Xaml"]}