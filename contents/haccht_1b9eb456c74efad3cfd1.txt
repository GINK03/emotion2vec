{"context": "NetOps\u306e\u81ea\u52d5\u5316\u9818\u57df\u3067\u306f\u6a19\u6e96\u7684API\u306e\u4e0d\u8db3\u306e\u305f\u3081\u3001\u6ce3\u304f\u6ce3\u304fexpect\u3067\u5bfe\u8a71\u7684\u30d7\u30ed\u30b0\u30e9\u30e0\u3092\u5b9f\u73fe\u3057\u3066\u3044\u308b\u30b1\u30fc\u30b9\u3082\u591a\u3044\u3068\u601d\u3046\u3002\u79c1\u81ea\u8eab\u3042\u307e\u308aexpect\u3092\u4f7f\u3063\u305f\u3053\u3068\u306f\u306a\u3044\u304c\u3001expect\u30d7\u30ed\u30b0\u30e9\u30e0\u306b\u306finteract\u306a\u308b\u30b3\u30de\u30f3\u30c9\u304c\u3042\u308a\u30d7\u30ed\u30bb\u30b9\u5236\u5fa1\u3092\u30e6\u30fc\u30b6\u30fc\u306b\u623b\u3059\u3053\u3068\u304c\u3067\u304d\u308b\u4fbf\u5229\u6a5f\u80fd\u304c\u5b9f\u88c5\u3055\u308c\u3066\u3044\u308b1\u3053\u3068\u3092\u77e5\u3063\u305f\u3002\nspawn telnet $HOSTNAME\nexpect \"login:\"\nsend \"$USERNAME\\n\"\nexpect \"Password:\"\nsend \"$PASSWORD\\n\"\ninteract\n\n\u540c\u69d8\u306e\u6a5f\u80fd\u3092Ruby\u306e\u6a19\u6e96\u30e2\u30b8\u30e5\u30fc\u30eb\u3067\u3042\u308bnet/telnet\u306b\u3082\u5b9f\u88c5\u3057\u3066\u307f\u308b\u3002\n\u8981\u3059\u308b\u306b\u6a19\u6e96\u5165\u529b\u304b\u3089\u9001\u3089\u308c\u305f\u30ad\u30fc\u30b9\u30c8\u30ed\u30fc\u30af\u3092telnet\u30bb\u30c3\u30b7\u30e7\u30f3\u3078\u3001\u307e\u305ftelnet\u30bb\u30c3\u30b7\u30e7\u30f3\u304b\u3089\u306e\u5fdc\u7b54\u3092\u6a19\u6e96\u51fa\u529b\u306b\u8ee2\u9001\u3057\u3066\u3084\u308c\u3070\u826f\u3044\u308f\u3051\u3067\u3001\u8907\u6570\u30bd\u30b1\u30c3\u30c8\u304b\u3089\u306e\u53d7\u4fe1\u5f85\u3061\u53d7\u3051\u306b\u306fIO.select\u304c\u4f7f\u3048\u308b\u3002\nmodule Net\n  class Telnet\n\n    def interact!\n      $stdin.raw!\n\n      loop do\n        rs, _ = IO.select([$stdin, @sock])\n        rs.each do |fh|\n          case fh\n          when $stdin\n            bs = ''\n            begin\n              bs = fh.read_nonblock(1)\n              if bs == \"\\e\"\n                bs << fh.read_nonblock(3)\n                bs << fh.read_nonblock(2)\n              end\n            rescue IO::WaitReadable\n            end\n\n            @sock.syswrite(bs)\n          when @sock\n            bs = fh.readpartial(1024)\n            $stdout.syswrite(bs)\n          end\n        end\n      end\n    rescue EOFError\n      $stdout.puts \"\\r\\n\", \"Conneciton closed.\"\n      self.close\n    ensure\n      $stdin.cooked!\n    end\n\n  end\nend\n\n\n# \u5192\u982d\u306eexpect\u30d7\u30ed\u30b0\u30e9\u30e0\u3068\u540c\u69d8\nsession = Net::Telnet.new('Host' => $hostname)\nsession.login($username, $password)\nsession.interact!\n\n\n\n\n\n\u81ea\u52d5\u5316\u9818\u57df\u3067\u30e6\u30fc\u30b6\u306b\u5236\u5fa1\u3092\u623b\u3059\u306e\u306f\u8ca0\u3051\u3067\u306f\uff1f\u3068\u3044\u3046\u5f53\u7136\u306e\u610f\u898b\u306f\u3053\u306e\u969b\u7121\u8996\u3059\u308b\u00a0\u21a9\n\n\n\nNetOps\u306e\u81ea\u52d5\u5316\u9818\u57df\u3067\u306f\u6a19\u6e96\u7684API\u306e\u4e0d\u8db3\u306e\u305f\u3081\u3001\u6ce3\u304f\u6ce3\u304f`expect`\u3067\u5bfe\u8a71\u7684\u30d7\u30ed\u30b0\u30e9\u30e0\u3092\u5b9f\u73fe\u3057\u3066\u3044\u308b\u30b1\u30fc\u30b9\u3082\u591a\u3044\u3068\u601d\u3046\u3002\u79c1\u81ea\u8eab\u3042\u307e\u308a`expect`\u3092\u4f7f\u3063\u305f\u3053\u3068\u306f\u306a\u3044\u304c\u3001`expect`\u30d7\u30ed\u30b0\u30e9\u30e0\u306b\u306f`interact`\u306a\u308b\u30b3\u30de\u30f3\u30c9\u304c\u3042\u308a\u30d7\u30ed\u30bb\u30b9\u5236\u5fa1\u3092\u30e6\u30fc\u30b6\u30fc\u306b\u623b\u3059\u3053\u3068\u304c\u3067\u304d\u308b\u4fbf\u5229\u6a5f\u80fd\u304c\u5b9f\u88c5\u3055\u308c\u3066\u3044\u308b[^1]\u3053\u3068\u3092\u77e5\u3063\u305f\u3002\n\n[^1]: \u81ea\u52d5\u5316\u9818\u57df\u3067\u30e6\u30fc\u30b6\u306b\u5236\u5fa1\u3092\u623b\u3059\u306e\u306f\u8ca0\u3051\u3067\u306f\uff1f\u3068\u3044\u3046\u5f53\u7136\u306e\u610f\u898b\u306f\u3053\u306e\u969b\u7121\u8996\u3059\u308b\n\n\n```\nspawn telnet $HOSTNAME\nexpect \"login:\"\nsend \"$USERNAME\\n\"\nexpect \"Password:\"\nsend \"$PASSWORD\\n\"\ninteract\n```\n\n\u540c\u69d8\u306e\u6a5f\u80fd\u3092Ruby\u306e\u6a19\u6e96\u30e2\u30b8\u30e5\u30fc\u30eb\u3067\u3042\u308b`net/telnet`\u306b\u3082\u5b9f\u88c5\u3057\u3066\u307f\u308b\u3002\n\n\u8981\u3059\u308b\u306b\u6a19\u6e96\u5165\u529b\u304b\u3089\u9001\u3089\u308c\u305f\u30ad\u30fc\u30b9\u30c8\u30ed\u30fc\u30af\u3092telnet\u30bb\u30c3\u30b7\u30e7\u30f3\u3078\u3001\u307e\u305ftelnet\u30bb\u30c3\u30b7\u30e7\u30f3\u304b\u3089\u306e\u5fdc\u7b54\u3092\u6a19\u6e96\u51fa\u529b\u306b\u8ee2\u9001\u3057\u3066\u3084\u308c\u3070\u826f\u3044\u308f\u3051\u3067\u3001\u8907\u6570\u30bd\u30b1\u30c3\u30c8\u304b\u3089\u306e\u53d7\u4fe1\u5f85\u3061\u53d7\u3051\u306b\u306fIO.select\u304c\u4f7f\u3048\u308b\u3002\n\n```\nmodule Net\n  class Telnet\n\n    def interact!\n      $stdin.raw!\n\n      loop do\n        rs, _ = IO.select([$stdin, @sock])\n        rs.each do |fh|\n          case fh\n          when $stdin\n            bs = ''\n            begin\n              bs = fh.read_nonblock(1)\n              if bs == \"\\e\"\n                bs << fh.read_nonblock(3)\n                bs << fh.read_nonblock(2)\n              end\n            rescue IO::WaitReadable\n            end\n\n            @sock.syswrite(bs)\n          when @sock\n            bs = fh.readpartial(1024)\n            $stdout.syswrite(bs)\n          end\n        end\n      end\n    rescue EOFError\n      $stdout.puts \"\\r\\n\", \"Conneciton closed.\"\n      self.close\n    ensure\n      $stdin.cooked!\n    end\n\n  end\nend\n\n\n# \u5192\u982d\u306eexpect\u30d7\u30ed\u30b0\u30e9\u30e0\u3068\u540c\u69d8\nsession = Net::Telnet.new('Host' => $hostname)\nsession.login($username, $password)\nsession.interact!\n```\n\n", "tags": ["Ruby", "Network", "NetOpsCoding"]}