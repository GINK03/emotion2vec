{"context": " More than 1 year has passed since last update.EC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u304b\u3089Redshift\u3078\u63a5\u7d9a\u3059\u308b\u305f\u3081\u306b\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u30bf\u30a4\u30d7\u306b\u3088\u3063\u3066\u306fMTU\u3092\u5909\u66f4\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\n\u53c2\u8003\n* \u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u3067\u30af\u30a8\u30ea\u304c\u30cf\u30f3\u30b0\u3057\u305f\u3088\u3046\u306b\u306a\u308a\u3001\u30af\u30e9\u30b9\u30bf\u30fc\u306b\u5230\u9054\u3057\u306a\u3044 |  AmazonWebServices\n* Amazon Redshift\u3068EC2\u306e\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u30bf\u30a4\u30d7\u306b\u65bc\u3051\u308b\"MTU\"\u306e\u95a2\u4fc2\u306b\u3064\u3044\u3066 \uff5c Developers.IO\n\u30ea\u30f3\u30af\u5148\u306e\u30b3\u30de\u30f3\u30c9(ip, ifconfig)\u3067MTU\u3092\u5909\u66f4\u3067\u304d\u307e\u3059\u304c\u6c38\u7d9a\u5316\u3067\u304d\u306a\u3044\u305f\u3081\u3001\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30a4\u30b9\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u306b\u8a18\u8ff0\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3057\u305f\u3002\nroot> echo 'MTU=1500' >> /etc/sysconfig/network-scripts/ifcfg-eth0\n\n\u3057\u304b\u3057\u3001EC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306e\u5834\u5408\u3001\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30a4\u30b9\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u306b\u8a18\u8ff0\u3057\u3066\u3082\u6c38\u7d9a\u5316\u3067\u304d\u3066\u304a\u3089\u305a\u3001\u30b5\u30fc\u30d0\u3092\u518d\u8d77\u52d5\u3059\u308b\u3068MTU\u304c\u5143\u306b\u623b\u3063\u3066\u3057\u307e\u3044\u307e\u3057\u305f\u3002\n\u8abf\u3079\u305f\u3068\u3053\u308d\u3001AWS Developer Forums\u306b\u8a72\u5f53\u3059\u308b\u30b9\u30ec\u30c3\u30c9\u304c\u3042\u308a\u307e\u3057\u305f\u3002\n\nHere is what should be added to the /etc/dhcp/dhclient.conf (on Ubuntu Precise LTS):\n#added these two lines before the request line\ndefault interface-mtu 1500;\nsupercede interface-mtu 1500;\n\nAWS Developer Forums: How to set MTU permanently on Amazon ...\n\u3069\u3046\u3084\u3089dhclient\u304c\u539f\u56e0\u307f\u305f\u3044\u3067\u3059\u3002\n\u30d7\u30ed\u30bb\u30b9\u3092\u78ba\u8a8d\u3057\u3066\u307f\u307e\u3059\u3002\n$ ps -ef | grep [d]hclient\nroot       718     1  0 08:49 ?        00:00:00 /sbin/dhclient -1 -q -lf /var/lib/dhclient/dhclient-eth0.leases -pf /var/run/dhclient-eth0.pid eth0\n\n-lf \u30aa\u30d7\u30b7\u30e7\u30f3\u3067\u6307\u5b9a\u3055\u308c\u3066\u3044\u308b\u30ea\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb\u3092\u898b\u3066\u307f\u307e\u3059\u3002\n\n/var/lib/dhclient/dhclient-eth0.leases\nlease {\n  interface \"eth0\";\n  fixed-address 10.0.0.5;\n  option subnet-mask 255.255.255.0;\n  option dhcp-lease-time 3600;\n  option routers 10.0.0.1;\n  option dhcp-message-type 5;\n  option dhcp-server-identifier 10.0.0.1;\n  option domain-name-servers 10.0.0.2;\n  option interface-mtu 9001;\n  option broadcast-address 10.0.0.255;\n  option host-name \"ip-10-0-0-5\";\n  renew 3 2015/04/08 14:07:19;\n  rebind 3 2015/04/08 14:30:01;\n  expire 3 2015/04/08 14:37:31;\n}\n...\n\n\nMTU\u5024\u304c\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u307e\u3057\u305f\u3002\n\u3055\u3089\u306b\u3001ifup-eth\u30b9\u30af\u30ea\u30d7\u30c8\u3067\u5b9f\u969b\u306e\u52d5\u4f5c\u3092\u898b\u3066\u307f\u307e\u3059\u3002\n\n/etc/sysconfig/network-scripts/ifup-eth.\n## 99\u884c\u76ee\u3042\u305f\u308a\nif [ -n \"${MTU}\" ]; then\n   ip link set dev ${DEVICE} mtu ${MTU}\nfi\n\n...(\u7701\u7565)...\n\n## 162\u884c\u76ee\u3042\u305f\u308a\nif [ -n \"${DYNCONFIG}\" -a -x /sbin/dhclient ]; then\n    if [[ \"${PERSISTENT_DHCLIENT}\" =  [yY1]* ]]; then\n       ONESHOT=\"\";\n    else\n       ONESHOT=\"-1\";\n    fi;\n    generate_config_file_name\n    # copy any lease obtained by the initrd\n    for file in /dev/.dhclient-${DEVICE}.leases /dev/.initramfs/net.${DEVICE}.lease ; do\n        if [ -f \"${file}\" ]; then\n            mv -f $file /var/lib/dhclient/dhclient-${DEVICE}.leases\n            [ -x /sbin/restorecon ] && restorecon /var/lib/dhclient/dhclient-${DEVICE}.leases > /dev/null 2>&1\n        fi\n    done\n    DHCLIENTARGS=\"${DHCLIENTARGS} ${DHCP_HOSTNAME:+-H $DHCP_HOSTNAME} ${ONESHOT} -q ${DHCLIENTCONF} -lf /var/lib/dhclient/dhclient-${DEVICE}.leases -pf /var/run/dhclient-${DEVICE}.pid\"\n    echo\n    echo -n $\"Determining IP information for ${DEVICE}...\"\n    if [[ \"${PERSISTENT_DHCLIENT}\" !=  [yY1]* ]] && check_link_down ${DEVICE}; then\n        echo $\" failed; no link present.  Check cable?\"\n        exit 1\n    fi\n\n    ethtool_set\n\n    if /sbin/dhclient ${DHCLIENTARGS} ${DEVICE} ; then\n                echo $\" done.\"\n                dhcpipv4=\"good\"\n    else\n                echo $\" failed.\"\n                if [[ \"${IPV4_FAILURE_FATAL}\"  = [Yy1]* ]] ; then\n                        exit 1\n                fi\n                if [[ \"$IPV6INIT\" != [yY1]* && \"$DHCPV6C\" != [yY1]* ]] ; then\n                        exit 1\n                fi\n                net_log \"Unable to obtain IPv4 DHCP address ${DEVICE}.\" warning\n    fi\n...\n\n\n99\u884c\u76ee\u3042\u305f\u308a\u3067MTU\u304c\u66f4\u65b0\u3055\u308c\u3066\u307e\u3059\u304c\u3001162\u884c\u76ee\u3042\u305f\u308a\u3067dhclient\u304c\u52d5\u304f\u305f\u3081\u3001\u305d\u306e\u3068\u304d\u306bMTU\u304c\u4e0a\u66f8\u304d\u3055\u308c\u3066\u3044\u308b\u306e\u304c\u539f\u56e0\u304b\u306a\u3068\u601d\u3044\u307e\u3059\u3002\n\u3057\u305f\u304c\u3063\u3066\u3001dhclient.conf\u306b\u6b21\u306e\u3088\u3046\u306a\u8a18\u8ff0\u3092\u3057\u307e\u3059\u3002\n\n/etc/dhcp/dhclient.conf\ndefault interface-mtu 1500;\nsupersede interface-mtu 1500;\n\n\ndefault interface-mtu\u306fAWS\u306eDHCP\u30b5\u30fc\u30d0\u304b\u3089MTU\u304c\u8a2d\u5b9a\u3055\u308c\u308b\u306e\u3067\u8a18\u8ff0\u3057\u306a\u304f\u3066\u3082\u826f\u3044\u3068\u601d\u3044\u307e\u3059\u304c\u3001supersede interface-mtu\u306fDHCP\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u306e\u5024\u3092\u4f7f\u3046\u3088\u3046\u306b\u8a2d\u5b9a\u3059\u308b\u305f\u3081\u3001\u5fc5\u305a\u8a18\u8ff0\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\u4e0a\u8a18\u306e\u30ea\u30f3\u30af\u5148\u3067\u3001supersede\u304csupercede\u306b\u30b9\u30da\u30eb\u30df\u30b9\u3057\u3066\u3044\u3066\u305d\u308c\u3092\u30b3\u30d4\u30da\u3057\u305f\u306e\u3067\u3001\u8a2d\u5b9a\u304c\u53cd\u6620\u3055\u308c\u3066\u306a\u304f\u3066\u30cf\u30de\u3063\u3066\u307e\u3057\u305f(\u3061\u3083\u3093\u3068\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u8aad\u3081\u3070\u3059\u3050\u5206\u304b\u3063\u305f\u306e\u3067\u53cd\u7701)\u3002\n\u3059\u3050\u306b\u8a2d\u5b9a\u53cd\u6620\u3055\u305b\u308b\u306b\u306f\u3001service network restart\u3092\u5b9f\u884c\u3059\u308c\u3070\u826f\u3044\u3067\u3059\u3002\n\u8a2d\u5b9a\u53cd\u6620\u5f8c\u306e\u30ea\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb\u3092\u518d\u3073\u898b\u3066\u307f\u307e\u3059\u3002\n\n/var/lib/dhclient/dhclient-eth0.leases\nlease {\n  interface \"eth0\";\n  fixed-address 10.0.0.5;\n  option subnet-mask 255.255.255.0;\n  option routers 10.0.0.1;\n  option dhcp-lease-time 3600;\n  option dhcp-message-type 5;\n  option domain-name-servers 10.0.0.2;\n  option dhcp-server-identifier 10.0.0.1;\n  option interface-mtu 1500;\n  option broadcast-address 10.0.0.255;\n  option host-name \"ip-10-0-0-5\";\n  renew 5 2015/04/10 02:43:14;\n  rebind 5 2015/04/10 03:12:24;\n  expire 5 2015/04/10 03:19:54;\n}\n...\n\n\nMTU\u304c1500\u306b\u5909\u66f4\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u304c\u308f\u304b\u308a\u307e\u3059\u3002\n\nEC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u304b\u3089Redshift\u3078\u63a5\u7d9a\u3059\u308b\u305f\u3081\u306b\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u30bf\u30a4\u30d7\u306b\u3088\u3063\u3066\u306fMTU\u3092\u5909\u66f4\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\n\n\u53c2\u8003\n* [\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u3067\u30af\u30a8\u30ea\u304c\u30cf\u30f3\u30b0\u3057\u305f\u3088\u3046\u306b\u306a\u308a\u3001\u30af\u30e9\u30b9\u30bf\u30fc\u306b\u5230\u9054\u3057\u306a\u3044 |  AmazonWebServices](http://docs.aws.amazon.com/ja_jp/redshift/latest/mgmt/connecting-drop-issues.html)\n* [Amazon Redshift\u3068EC2\u306e\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u30bf\u30a4\u30d7\u306b\u65bc\u3051\u308b\"MTU\"\u306e\u95a2\u4fc2\u306b\u3064\u3044\u3066 \uff5c Developers.IO](http://dev.classmethod.jp/cloud/aws/connection-issue-abour-with-between-redshift-and-ec2/)\n\n\u30ea\u30f3\u30af\u5148\u306e\u30b3\u30de\u30f3\u30c9(ip, ifconfig)\u3067MTU\u3092\u5909\u66f4\u3067\u304d\u307e\u3059\u304c\u6c38\u7d9a\u5316\u3067\u304d\u306a\u3044\u305f\u3081\u3001\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30a4\u30b9\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u306b\u8a18\u8ff0\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3057\u305f\u3002\n\n```bash\nroot> echo 'MTU=1500' >> /etc/sysconfig/network-scripts/ifcfg-eth0\n```\n\n\u3057\u304b\u3057\u3001EC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306e\u5834\u5408\u3001\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30a4\u30b9\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u306b\u8a18\u8ff0\u3057\u3066\u3082\u6c38\u7d9a\u5316\u3067\u304d\u3066\u304a\u3089\u305a\u3001\u30b5\u30fc\u30d0\u3092\u518d\u8d77\u52d5\u3059\u308b\u3068MTU\u304c\u5143\u306b\u623b\u3063\u3066\u3057\u307e\u3044\u307e\u3057\u305f\u3002\n\n\u8abf\u3079\u305f\u3068\u3053\u308d\u3001AWS Developer Forums\u306b\u8a72\u5f53\u3059\u308b\u30b9\u30ec\u30c3\u30c9\u304c\u3042\u308a\u307e\u3057\u305f\u3002\n\n> Here is what should be added to the /etc/dhcp/dhclient.conf (on Ubuntu Precise LTS):\n>\n> \\#added these two lines before the request line\n> default interface-mtu 1500;\n> supercede interface-mtu 1500;\n\n[AWS Developer Forums: How to set MTU permanently on Amazon ...](https://forums.aws.amazon.com/thread.jspa?messageID=577032)\n\n\u3069\u3046\u3084\u3089dhclient\u304c\u539f\u56e0\u307f\u305f\u3044\u3067\u3059\u3002\n\n\u30d7\u30ed\u30bb\u30b9\u3092\u78ba\u8a8d\u3057\u3066\u307f\u307e\u3059\u3002\n\n```bash\n$ ps -ef | grep [d]hclient\nroot       718     1  0 08:49 ?        00:00:00 /sbin/dhclient -1 -q -lf /var/lib/dhclient/dhclient-eth0.leases -pf /var/run/dhclient-eth0.pid eth0\n```\n\n`-lf` \u30aa\u30d7\u30b7\u30e7\u30f3\u3067\u6307\u5b9a\u3055\u308c\u3066\u3044\u308b\u30ea\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb\u3092\u898b\u3066\u307f\u307e\u3059\u3002\n\n```/var/lib/dhclient/dhclient-eth0.leases\nlease {\n  interface \"eth0\";\n  fixed-address 10.0.0.5;\n  option subnet-mask 255.255.255.0;\n  option dhcp-lease-time 3600;\n  option routers 10.0.0.1;\n  option dhcp-message-type 5;\n  option dhcp-server-identifier 10.0.0.1;\n  option domain-name-servers 10.0.0.2;\n  option interface-mtu 9001;\n  option broadcast-address 10.0.0.255;\n  option host-name \"ip-10-0-0-5\";\n  renew 3 2015/04/08 14:07:19;\n  rebind 3 2015/04/08 14:30:01;\n  expire 3 2015/04/08 14:37:31;\n}\n...\n```\n\nMTU\u5024\u304c\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u307e\u3057\u305f\u3002\n\n\u3055\u3089\u306b\u3001`ifup-eth`\u30b9\u30af\u30ea\u30d7\u30c8\u3067\u5b9f\u969b\u306e\u52d5\u4f5c\u3092\u898b\u3066\u307f\u307e\u3059\u3002\n\n```/etc/sysconfig/network-scripts/ifup-eth.\n## 99\u884c\u76ee\u3042\u305f\u308a\nif [ -n \"${MTU}\" ]; then\n   ip link set dev ${DEVICE} mtu ${MTU}\nfi\n\n...(\u7701\u7565)...\n\n## 162\u884c\u76ee\u3042\u305f\u308a\nif [ -n \"${DYNCONFIG}\" -a -x /sbin/dhclient ]; then\n    if [[ \"${PERSISTENT_DHCLIENT}\" =  [yY1]* ]]; then\n       ONESHOT=\"\";\n    else\n       ONESHOT=\"-1\";\n    fi;\n    generate_config_file_name\n    # copy any lease obtained by the initrd\n    for file in /dev/.dhclient-${DEVICE}.leases /dev/.initramfs/net.${DEVICE}.lease ; do\n        if [ -f \"${file}\" ]; then\n            mv -f $file /var/lib/dhclient/dhclient-${DEVICE}.leases\n            [ -x /sbin/restorecon ] && restorecon /var/lib/dhclient/dhclient-${DEVICE}.leases > /dev/null 2>&1\n        fi\n    done\n    DHCLIENTARGS=\"${DHCLIENTARGS} ${DHCP_HOSTNAME:+-H $DHCP_HOSTNAME} ${ONESHOT} -q ${DHCLIENTCONF} -lf /var/lib/dhclient/dhclient-${DEVICE}.leases -pf /var/run/dhclient-${DEVICE}.pid\"\n    echo\n    echo -n $\"Determining IP information for ${DEVICE}...\"\n    if [[ \"${PERSISTENT_DHCLIENT}\" !=  [yY1]* ]] && check_link_down ${DEVICE}; then\n        echo $\" failed; no link present.  Check cable?\"\n        exit 1\n    fi\n\n    ethtool_set\n\n    if /sbin/dhclient ${DHCLIENTARGS} ${DEVICE} ; then\n                echo $\" done.\"\n                dhcpipv4=\"good\"\n    else\n                echo $\" failed.\"\n                if [[ \"${IPV4_FAILURE_FATAL}\"  = [Yy1]* ]] ; then\n                        exit 1\n                fi\n                if [[ \"$IPV6INIT\" != [yY1]* && \"$DHCPV6C\" != [yY1]* ]] ; then\n                        exit 1\n                fi\n                net_log \"Unable to obtain IPv4 DHCP address ${DEVICE}.\" warning\n    fi\n...\n```\n\n99\u884c\u76ee\u3042\u305f\u308a\u3067MTU\u304c\u66f4\u65b0\u3055\u308c\u3066\u307e\u3059\u304c\u3001162\u884c\u76ee\u3042\u305f\u308a\u3067dhclient\u304c\u52d5\u304f\u305f\u3081\u3001\u305d\u306e\u3068\u304d\u306bMTU\u304c\u4e0a\u66f8\u304d\u3055\u308c\u3066\u3044\u308b\u306e\u304c\u539f\u56e0\u304b\u306a\u3068\u601d\u3044\u307e\u3059\u3002\n\n\u3057\u305f\u304c\u3063\u3066\u3001`dhclient.conf`\u306b\u6b21\u306e\u3088\u3046\u306a\u8a18\u8ff0\u3092\u3057\u307e\u3059\u3002\n\n```/etc/dhcp/dhclient.conf\ndefault interface-mtu 1500;\nsupersede interface-mtu 1500;\n```\n\n`default interface-mtu`\u306fAWS\u306eDHCP\u30b5\u30fc\u30d0\u304b\u3089MTU\u304c\u8a2d\u5b9a\u3055\u308c\u308b\u306e\u3067\u8a18\u8ff0\u3057\u306a\u304f\u3066\u3082\u826f\u3044\u3068\u601d\u3044\u307e\u3059\u304c\u3001`supersede interface-mtu`\u306fDHCP\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u306e\u5024\u3092\u4f7f\u3046\u3088\u3046\u306b\u8a2d\u5b9a\u3059\u308b\u305f\u3081\u3001\u5fc5\u305a\u8a18\u8ff0\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n\u4e0a\u8a18\u306e\u30ea\u30f3\u30af\u5148\u3067\u3001`supersede`\u304c`supercede`\u306b\u30b9\u30da\u30eb\u30df\u30b9\u3057\u3066\u3044\u3066\u305d\u308c\u3092\u30b3\u30d4\u30da\u3057\u305f\u306e\u3067\u3001\u8a2d\u5b9a\u304c\u53cd\u6620\u3055\u308c\u3066\u306a\u304f\u3066\u30cf\u30de\u3063\u3066\u307e\u3057\u305f(\u3061\u3083\u3093\u3068\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u8aad\u3081\u3070\u3059\u3050\u5206\u304b\u3063\u305f\u306e\u3067\u53cd\u7701)\u3002\n\n\u3059\u3050\u306b\u8a2d\u5b9a\u53cd\u6620\u3055\u305b\u308b\u306b\u306f\u3001`service network restart`\u3092\u5b9f\u884c\u3059\u308c\u3070\u826f\u3044\u3067\u3059\u3002\n\n\u8a2d\u5b9a\u53cd\u6620\u5f8c\u306e\u30ea\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb\u3092\u518d\u3073\u898b\u3066\u307f\u307e\u3059\u3002\n\n```/var/lib/dhclient/dhclient-eth0.leases\nlease {\n  interface \"eth0\";\n  fixed-address 10.0.0.5;\n  option subnet-mask 255.255.255.0;\n  option routers 10.0.0.1;\n  option dhcp-lease-time 3600;\n  option dhcp-message-type 5;\n  option domain-name-servers 10.0.0.2;\n  option dhcp-server-identifier 10.0.0.1;\n  option interface-mtu 1500;\n  option broadcast-address 10.0.0.255;\n  option host-name \"ip-10-0-0-5\";\n  renew 5 2015/04/10 02:43:14;\n  rebind 5 2015/04/10 03:12:24;\n  expire 5 2015/04/10 03:19:54;\n}\n...\n```\n\nMTU\u304c1500\u306b\u5909\u66f4\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u304c\u308f\u304b\u308a\u307e\u3059\u3002\n\n", "tags": ["redshift", "EC2", "AWS"]}