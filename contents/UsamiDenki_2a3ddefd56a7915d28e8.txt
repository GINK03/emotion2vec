{"context": "\n\n\u521d\u3081\u306b\n\u6700\u8fd1Ruby\u3001Ruby on Rails\u3084Chef\u3092\u4ed5\u4e8b\u3067\u3082\u89e6\u308a\u3060\u3057\u3001Percona\u306e\u30af\u30e9\u30b9\u30bf\u30ea\u30f3\u30b0\u3092Chef\u3067\u884c\u3063\u305f\u306e\u3067\u30e1\u30e2\u3068\u3057\u3066\u624b\u9806\u3092\u6b8b\u3059\u305f\u3081\u306b\u6295\u7a3f\u3002\n\n\u5bfe\u8c61Percona\nPercona XtraDB Cluster 5.6x\n\n\u5bfe\u8c61OS\n\nCentOS 6.x\nCentOS 7.x\n\n\n\u4e8b\u524d\u6e96\u5099\n\nchef solo\u7528\u306e\u30b5\u30fc\u30d0\u3068\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u30b5\u30fc\u30d0\u3092\u7528\u610f\u3002\u4f8b\u3068\u3057\u3066\u4eca\u56de\u306f\u4e0b\u8a18\u3068\u3059\u308b\u3002\n\n\n\u30b5\u30fc\u30d0: 192.168.1.10\n\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u30b5\u30fc\u30d01: 192.168.1.31\n\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u30b5\u30fc\u30d02: 192.168.1.32\n\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u30b5\u30fc\u30d03: 192.168.1.33\n\n\n\u30b5\u30fc\u30d0\u304b\u3089\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u30b5\u30fc\u30d0\u3078knife solo cook\u51fa\u6765\u308b\u72b6\u614b\u307e\u3067\u74b0\u5883\u3092\u69cb\u7bc9\u3002\u4e0b\u8a18\u306e\u30b5\u30a4\u30c8\u304c\u53c2\u8003\u306b\u306a\u3063\u305f\n\n\n\u3055\u304f\u3089VPS\u306e\u521d\u671f\u8a2d\u5b9a\u3092Chef Solo\u3067\u3084\u3063\u3066\u307f\u305f\u301c\u30b5\u30fc\u30c9\u30d1\u30fc\u30c6\u30a3cookbook\u306e\u4f7f\u3044\u65b9\u301c\nchef solo\u306e\u7c21\u5358\u306a\u4f7f\u3044\u65b9\u3001\u8a2d\u5b9a\u65b9\u6cd5\u4e00\u89a7\n\n\n\n\n\u624b\u9806\n\u4f5c\u696d\u306f\u5168\u3066\u30b5\u30fc\u30d0\u4e0a(192.168.1.10)\u304b\u3089\u884c\u3046\n\n\u3000site-cookbooks\u3078\u4e0b\u8a18\u30ec\u30b7\u30d4(Percona_Cluster)\u3092\u8ffd\u52a0\n$ git clone https://github.com/UsamiDenki/Percona_Cluster.git\n\n\n\u3000\u5bfe\u8c61\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u30b5\u30fc\u30d0\u7528\u306e\u5171\u901arole\u3092\u7528\u610f\n\n\u5404\u30d1\u30e9\u30e1\u30fc\u30bf\u8a73\u7d30\u306fgit\u30af\u30ed\u30fc\u30f3\u5148\u306ePercona XtraDB Cluster 5.6x\u3092Chef\u3067\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\u305f\u3081\u306eCookbook\u3092\u53c2\u7167\n\n$ vi roles/percona_cluster.json\n\n{\n  \"chef_type\": \"role\",\n  \"json_class\": \"Chef::Role\",\n  \"default_attributes\": {\n    \"percona_cluster\": {\n       \"root_password\": \"mysql\",\n       \"wsrep_cluster_addresses\": [ \"192.168.1.31\", \"192.168.1.32\", \"192.168.1.33\" ],\n       \"wsrep_cluster_name\": \"my_cluster\",\n       \"wsrep_sst_auth\": \"sstuser:s3cret\"\n    }\n  },\n  \"run_list\": [\n    \"recipe[Percona_Cluster]\"\n  ]\n}\n\n\n\u3000\u5bfe\u8c61\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u30b5\u30fc\u30d0\u7528\u306enode\u3092\u7528\u610f\n\n\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u30b5\u30fc\u30d01\n\n$ vi nodes/192.168.1.31.json\n\n{\n    \"percona_cluster\": {\n        \"wsrep_node_address\": \"192.168.1.31\"\n    },\n    \"run_list\": [\n        \"role[percona_cluster]\"\n    ]\n}\n\n\n\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u30b5\u30fc\u30d02\n\n$ vi nodes/192.168.1.32.json\n\n{\n    \"percona_cluster\": {\n        \"wsrep_node_address\": \"192.168.1.32\"\n    },\n    \"run_list\": [\n        \"role[percona_cluster]\"\n    ]\n}\n\n\n\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u30b5\u30fc\u30d03\n\n$ vi nodes/192.168.1.33.json\n\n{\n    \"percona_cluster\": {\n        \"wsrep_node_address\": \"192.168.1.33\"\n    },\n    \"run_list\": [\n        \"role[percona_cluster]\"\n    ]\n}\n\n\n\u3000\u5168\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u30b5\u30fc\u30d0\u3078Chef-Solo\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n$ knife solo prepare root@192.168.1.31\n\n\u5404\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u30b5\u30fc\u30d0\u3078root\u30ed\u30b0\u30a4\u30f3\u3067\u304d\u308b\u524d\u63d0\n\n\u3000\u5168\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u30b5\u30fc\u30d0\u3078Chef\u304b\u3089Percona XtraDB Cluster 5.6x\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n$ knife solo cook root@192.168.1.31\n\n192.168.1.31\u304b\u3089.33\u307e\u3067\u9806\u306b\u5b9f\u65bd\u3059\u308b\n\n\u30af\u30e9\u30b9\u30bf\u3055\u308c\u3066\u3044\u308b\u304b\u30c6\u30b9\u30c8\u3057\u3066\u5b8c\u4e86\n\u78ba\u8a8d\u65b9\u6cd5\u306fCentOS6.7\u306bPercona XtraDB Cluster\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\u3092\u53c2\u7167\n\n\u6ce8\u610f\n$ yum update\n\n\u3059\u308b\u3068Percona\u304cconflicts\u3059\u308b\u306e\u3067/etc/yum.conf\u306bexclude\u3092\u8ffd\u52a0\u3059\u308b\u3068\u56de\u907f\u3067\u304d\u308b\u304c\u3001\u8a2d\u5b9a\u6b21\u7b2c\u3067Percona\u304cyum\u304b\u3089\u9664\u5916\u3055\u308c\u3066\u3057\u307e\u3046\u306e\u3067\u6ce8\u610f\u3002\n#\u521d\u3081\u306b\n\u6700\u8fd1Ruby\u3001Ruby on Rails\u3084Chef\u3092\u4ed5\u4e8b\u3067\u3082\u89e6\u308a\u3060\u3057\u3001Percona\u306e\u30af\u30e9\u30b9\u30bf\u30ea\u30f3\u30b0\u3092Chef\u3067\u884c\u3063\u305f\u306e\u3067\u30e1\u30e2\u3068\u3057\u3066\u624b\u9806\u3092\u6b8b\u3059\u305f\u3081\u306b\u6295\u7a3f\u3002\n\n#\u5bfe\u8c61Percona\nPercona XtraDB Cluster 5.6x\n\n#\u5bfe\u8c61OS\n* CentOS 6.x\n* CentOS 7.x\n\n#\u4e8b\u524d\u6e96\u5099\n* chef solo\u7528\u306e\u30b5\u30fc\u30d0\u3068\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u30b5\u30fc\u30d0\u3092\u7528\u610f\u3002\u4f8b\u3068\u3057\u3066\u4eca\u56de\u306f\u4e0b\u8a18\u3068\u3059\u308b\u3002\n - \u30b5\u30fc\u30d0: 192.168.1.10\n - \u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u30b5\u30fc\u30d01: 192.168.1.31\n - \u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u30b5\u30fc\u30d02: 192.168.1.32\n - \u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u30b5\u30fc\u30d03: 192.168.1.33\n* \u30b5\u30fc\u30d0\u304b\u3089\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u30b5\u30fc\u30d0\u3078knife solo cook\u51fa\u6765\u308b\u72b6\u614b\u307e\u3067\u74b0\u5883\u3092\u69cb\u7bc9\u3002\u4e0b\u8a18\u306e\u30b5\u30a4\u30c8\u304c\u53c2\u8003\u306b\u306a\u3063\u305f\n - [\u3055\u304f\u3089VPS\u306e\u521d\u671f\u8a2d\u5b9a\u3092Chef Solo\u3067\u3084\u3063\u3066\u307f\u305f\u301c\u30b5\u30fc\u30c9\u30d1\u30fc\u30c6\u30a3cookbook\u306e\u4f7f\u3044\u65b9\u301c](http://hivecolor.com/id/126)\n - [chef solo\u306e\u7c21\u5358\u306a\u4f7f\u3044\u65b9\u3001\u8a2d\u5b9a\u65b9\u6cd5\u4e00\u89a7](https://tsuchikazu.net/vps_chef_solo/)\n\n#\u624b\u9806\n*\u4f5c\u696d\u306f\u5168\u3066\u30b5\u30fc\u30d0\u4e0a(192.168.1.10)\u304b\u3089\u884c\u3046*\n\n###\u3000site-cookbooks\u3078\u4e0b\u8a18\u30ec\u30b7\u30d4(Percona_Cluster)\u3092\u8ffd\u52a0\n```\n$ git clone https://github.com/UsamiDenki/Percona_Cluster.git\n```\n\n###\u3000\u5bfe\u8c61\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u30b5\u30fc\u30d0\u7528\u306e\u5171\u901arole\u3092\u7528\u610f\n+ \u5404\u30d1\u30e9\u30e1\u30fc\u30bf\u8a73\u7d30\u306fgit\u30af\u30ed\u30fc\u30f3\u5148\u306e[Percona XtraDB Cluster 5.6x\u3092Chef\u3067\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\u305f\u3081\u306eCookbook](https://github.com/UsamiDenki/Percona_Cluster)\u3092\u53c2\u7167\n\n```\n$ vi roles/percona_cluster.json\n```\n```\n{\n  \"chef_type\": \"role\",\n  \"json_class\": \"Chef::Role\",\n  \"default_attributes\": {\n    \"percona_cluster\": {\n       \"root_password\": \"mysql\",\n       \"wsrep_cluster_addresses\": [ \"192.168.1.31\", \"192.168.1.32\", \"192.168.1.33\" ],\n       \"wsrep_cluster_name\": \"my_cluster\",\n       \"wsrep_sst_auth\": \"sstuser:s3cret\"\n    }\n  },\n  \"run_list\": [\n    \"recipe[Percona_Cluster]\"\n  ]\n}\n```\n\n###\u3000\u5bfe\u8c61\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u30b5\u30fc\u30d0\u7528\u306enode\u3092\u7528\u610f\n+ \u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u30b5\u30fc\u30d01\n\n```\n$ vi nodes/192.168.1.31.json\n```\n```\n{\n    \"percona_cluster\": {\n        \"wsrep_node_address\": \"192.168.1.31\"\n    },\n    \"run_list\": [\n        \"role[percona_cluster]\"\n    ]\n}\n```\n\n+ \u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u30b5\u30fc\u30d02\n\n```\n$ vi nodes/192.168.1.32.json\n```\n```\n{\n    \"percona_cluster\": {\n        \"wsrep_node_address\": \"192.168.1.32\"\n    },\n    \"run_list\": [\n        \"role[percona_cluster]\"\n    ]\n}\n```\n\n+ \u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u30b5\u30fc\u30d03\n\n```\n$ vi nodes/192.168.1.33.json\n```\n```\n{\n    \"percona_cluster\": {\n        \"wsrep_node_address\": \"192.168.1.33\"\n    },\n    \"run_list\": [\n        \"role[percona_cluster]\"\n    ]\n}\n```\n\n###\u3000\u5168\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u30b5\u30fc\u30d0\u3078Chef-Solo\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n```\n$ knife solo prepare root@192.168.1.31\n```\n*\u5404\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u30b5\u30fc\u30d0\u3078root\u30ed\u30b0\u30a4\u30f3\u3067\u304d\u308b\u524d\u63d0*\n\n###\u3000\u5168\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u30b5\u30fc\u30d0\u3078Chef\u304b\u3089Percona XtraDB Cluster 5.6x\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n```\n$ knife solo cook root@192.168.1.31\n```\n*192.168.1.31\u304b\u3089.33\u307e\u3067\u9806\u306b\u5b9f\u65bd\u3059\u308b*\n\n#\u30af\u30e9\u30b9\u30bf\u3055\u308c\u3066\u3044\u308b\u304b\u30c6\u30b9\u30c8\u3057\u3066\u5b8c\u4e86\n\u78ba\u8a8d\u65b9\u6cd5\u306f[CentOS6.7\u306bPercona XtraDB Cluster\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b](http://qiita.com/toshiro3/items/67da351a7ea1764c7997)\u3092\u53c2\u7167\n\n#\u6ce8\u610f\n```\n$ yum update\n```\n\u3059\u308b\u3068Percona\u304cconflicts\u3059\u308b\u306e\u3067/etc/yum.conf\u306bexclude\u3092\u8ffd\u52a0\u3059\u308b\u3068\u56de\u907f\u3067\u304d\u308b\u304c\u3001\u8a2d\u5b9a\u6b21\u7b2c\u3067Percona\u304cyum\u304b\u3089\u9664\u5916\u3055\u308c\u3066\u3057\u307e\u3046\u306e\u3067\u6ce8\u610f\u3002\n", "tags": ["chef", "chef-solo", "Ruby", "CentOS", "knife-solo"]}