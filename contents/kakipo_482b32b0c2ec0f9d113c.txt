{"context": " More than 1 year has passed since last update.\n\n\u6982\u8981\nrbenv \u3092\u4f7f\u3063\u3066 ruby \u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u4e2d\u306b\u3001\nwarning: implicit declaration of function 'EC_GF2m_simple_method'\n\n\u3084\u3001\nmake[2]: *** [ossl_pkey_ec.o] Error 1\n\n\u306e\u3088\u3046\u306a\u30a8\u30e9\u30fc\u30e1\u30c3\u30bb\u30fc\u30b8\u304c\u8868\u793a\u3055\u308c\u308b\u5834\u5408\u306e\u5bfe\u5fdc\u65b9\u6cd5\u3067\u3059\u3002\n\n\u539f\u56e0\nRuby \u306e OpenSSL \u62e1\u5f35\u306b\u95a2\u4fc2\u3059\u308b\u65e2\u77e5\u306e\u554f\u984c\u3067\u3059\u3002\n\n\u5bfe\u5fdc\u65b9\u6cd5\nrbenv \u306e wiki \u306b\u8a18\u8f09\u304c\u3042\u308b\u3088\u3046\u306b\u3001patch \u3092\u3042\u3066\u3066\u3084\u308a\u307e\u3057\u3087\u3046\u3002\ncurl -fsSL https://bugs.ruby-lang.org/projects/ruby-trunk/repository/revisions/41808/diff?format=diff | \\\n  rbenv install --patch 1.9.3-p392\n\n\n\u30d1\u30c3\u30c1\u9069\u7528\u4e2d\u306b\u30a8\u30e9\u30fc\u3068\u306a\u308b\u5834\u5408\n\u4ee5\u4e0b\u306e\u5185\u5bb9\u3092 patch.diff \u3068\u3057\u3066\u4fdd\u5b58\u3057\u3001\u9069\u7528\u3057\u307e\u3057\u3087\u3046\u3002\n\npatch.diff\nIndex: ext/openssl/ossl_pkey_ec.c\n===================================================================\n--- ext/openssl/ossl_pkey_ec.c  (revision 41807)\n+++ ext/openssl/ossl_pkey_ec.c  (revision 41808)\n@@ -762,8 +762,10 @@\n                 method = EC_GFp_mont_method();\n             } else if (id == s_GFp_nist) {\n                 method = EC_GFp_nist_method();\n+#if !defined(OPENSSL_NO_EC2M)\n             } else if (id == s_GF2m_simple) {\n                 method = EC_GF2m_simple_method();\n+#endif\n             }\n\n             if (method) {\n@@ -817,8 +819,10 @@\n\n             if (id == s_GFp) {\n                 new_curve = EC_GROUP_new_curve_GFp;\n+#if !defined(OPENSSL_NO_EC2M)\n             } else if (id == s_GF2m) {\n                 new_curve = EC_GROUP_new_curve_GF2m;\n+#endif\n             } else {\n                 ossl_raise(rb_eArgError, \"unknown symbol, must be :GFp or :GF2m\");\n             }\nIndex: test/openssl/test_pkey_ec.rb\n===================================================================\n--- test/openssl/test_pkey_ec.rb    (revision 41807)\n+++ test/openssl/test_pkey_ec.rb    (revision 41808)\n@@ -7,28 +7,28 @@\n     @data1 = 'foo'\n     @data2 = 'bar' * 1000 # data too long for DSA sig\n\n-    @group1 = OpenSSL::PKey::EC::Group.new('secp112r1')\n-    @group2 = OpenSSL::PKey::EC::Group.new('sect163k1')\n-    @group3 = OpenSSL::PKey::EC::Group.new('prime256v1')\n+    @groups = []\n+    @keys = []\n\n-    @key1 = OpenSSL::PKey::EC.new\n-    @key1.group = @group1\n-    @key1.generate_key\n+    OpenSSL::PKey::EC.builtin_curves.each do |curve, comment|\n+      group = OpenSSL::PKey::EC::Group.new(curve)\n\n-    @key2 = OpenSSL::PKey::EC.new(@group2.curve_name)\n-    @key2.generate_key\n+      key = OpenSSL::PKey::EC.new(group)\n+      key.generate_key\n\n-    @key3 = OpenSSL::PKey::EC.new(@group3)\n-    @key3.generate_key\n-\n-    @groups = [@group1, @group2, @group3]\n-    @keys = [@key1, @key2, @key3]\n+      @groups << group\n+      @keys << key\n+    end\n   end\n\n   def compare_keys(k1, k2)\n     assert_equal(k1.to_pem, k2.to_pem)\n   end\n\n+  def test_builtin_curves\n+    assert(!OpenSSL::PKey::EC.builtin_curves.empty?)\n+  end\n+\n   def test_curve_names\n     @groups.each_with_index do |group, idx|\n       key = @keys[idx]\n\n\n\u3067\u3001\ncat /vagrant/ruby-patch.diff | rbenv install --patch 1.9.3-p392\n\n\n\u53c2\u8003\n\nCan't install on Fedora \u00b7 Issue #443 \u00b7 sstephenson/ruby-build\nHome \u00b7 sstephenson/ruby-build Wiki\n\n\u6982\u8981\n===========================\nrbenv \u3092\u4f7f\u3063\u3066 ruby \u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u4e2d\u306b\u3001\n\n```\nwarning: implicit declaration of function 'EC_GF2m_simple_method'\n```\n\n\u3084\u3001\n\n```\nmake[2]: *** [ossl_pkey_ec.o] Error 1\n```\n\n\u306e\u3088\u3046\u306a\u30a8\u30e9\u30fc\u30e1\u30c3\u30bb\u30fc\u30b8\u304c\u8868\u793a\u3055\u308c\u308b\u5834\u5408\u306e\u5bfe\u5fdc\u65b9\u6cd5\u3067\u3059\u3002\n\n\u539f\u56e0\n===========================\n\nRuby \u306e OpenSSL \u62e1\u5f35\u306b\u95a2\u4fc2\u3059\u308b\u65e2\u77e5\u306e\u554f\u984c\u3067\u3059\u3002\n\n\u5bfe\u5fdc\u65b9\u6cd5\n===========================\nrbenv \u306e [wiki](https://github.com/sstephenson/ruby-build/wiki#make-error-for-200-p247-and-lower-on-fedorared-hat) \u306b\u8a18\u8f09\u304c\u3042\u308b\u3088\u3046\u306b\u3001patch \u3092\u3042\u3066\u3066\u3084\u308a\u307e\u3057\u3087\u3046\u3002\n\n```\ncurl -fsSL https://bugs.ruby-lang.org/projects/ruby-trunk/repository/revisions/41808/diff?format=diff | \\\n  rbenv install --patch 1.9.3-p392\n```\n\n\u30d1\u30c3\u30c1\u9069\u7528\u4e2d\u306b\u30a8\u30e9\u30fc\u3068\u306a\u308b\u5834\u5408\n===========================\n\n\u4ee5\u4e0b\u306e\u5185\u5bb9\u3092 patch.diff \u3068\u3057\u3066\u4fdd\u5b58\u3057\u3001\u9069\u7528\u3057\u307e\u3057\u3087\u3046\u3002\n\n```patch.diff\nIndex: ext/openssl/ossl_pkey_ec.c\n===================================================================\n--- ext/openssl/ossl_pkey_ec.c\t(revision 41807)\n+++ ext/openssl/ossl_pkey_ec.c\t(revision 41808)\n@@ -762,8 +762,10 @@\n                 method = EC_GFp_mont_method();\n             } else if (id == s_GFp_nist) {\n                 method = EC_GFp_nist_method();\n+#if !defined(OPENSSL_NO_EC2M)\n             } else if (id == s_GF2m_simple) {\n                 method = EC_GF2m_simple_method();\n+#endif\n             }\n\n             if (method) {\n@@ -817,8 +819,10 @@\n\n             if (id == s_GFp) {\n                 new_curve = EC_GROUP_new_curve_GFp;\n+#if !defined(OPENSSL_NO_EC2M)\n             } else if (id == s_GF2m) {\n                 new_curve = EC_GROUP_new_curve_GF2m;\n+#endif\n             } else {\n                 ossl_raise(rb_eArgError, \"unknown symbol, must be :GFp or :GF2m\");\n             }\nIndex: test/openssl/test_pkey_ec.rb\n===================================================================\n--- test/openssl/test_pkey_ec.rb\t(revision 41807)\n+++ test/openssl/test_pkey_ec.rb\t(revision 41808)\n@@ -7,28 +7,28 @@\n     @data1 = 'foo'\n     @data2 = 'bar' * 1000 # data too long for DSA sig\n\n-    @group1 = OpenSSL::PKey::EC::Group.new('secp112r1')\n-    @group2 = OpenSSL::PKey::EC::Group.new('sect163k1')\n-    @group3 = OpenSSL::PKey::EC::Group.new('prime256v1')\n+    @groups = []\n+    @keys = []\n\n-    @key1 = OpenSSL::PKey::EC.new\n-    @key1.group = @group1\n-    @key1.generate_key\n+    OpenSSL::PKey::EC.builtin_curves.each do |curve, comment|\n+      group = OpenSSL::PKey::EC::Group.new(curve)\n\n-    @key2 = OpenSSL::PKey::EC.new(@group2.curve_name)\n-    @key2.generate_key\n+      key = OpenSSL::PKey::EC.new(group)\n+      key.generate_key\n\n-    @key3 = OpenSSL::PKey::EC.new(@group3)\n-    @key3.generate_key\n-\n-    @groups = [@group1, @group2, @group3]\n-    @keys = [@key1, @key2, @key3]\n+      @groups << group\n+      @keys << key\n+    end\n   end\n\n   def compare_keys(k1, k2)\n     assert_equal(k1.to_pem, k2.to_pem)\n   end\n\n+  def test_builtin_curves\n+    assert(!OpenSSL::PKey::EC.builtin_curves.empty?)\n+  end\n+\n   def test_curve_names\n     @groups.each_with_index do |group, idx|\n       key = @keys[idx]\n```\n\n\u3067\u3001\n\n```bash\ncat /vagrant/ruby-patch.diff | rbenv install --patch 1.9.3-p392\n```\n\n\n\u53c2\u8003\n===========================\n\n- [Can't install on Fedora \u00b7 Issue #443 \u00b7 sstephenson/ruby-build](https://github.com/sstephenson/ruby-build/issues/443)\n- [Home \u00b7 sstephenson/ruby-build Wiki](https://github.com/sstephenson/ruby-build/wiki#make-error-for-200-p247-and-lower-on-fedorared-hat)", "tags": ["rbenv", "Ruby", "openssl"]}