{"tags": ["CloudatCost", "vps", "archLinux"], "context": " More than 1 year has passed since last update.\u3053\u306e\u8a18\u4e8b\u306fArch Linux Advent Calender 2015\u306e12\u65e5\u76ee\u3067\u3059\u3002\n\nArchLinux\u306e\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u304c\u7528\u610f\u3055\u308c\u3066\u3044\u306a\u3044CloudAtCost\u306bArchLinux\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\n\u81ea\u5206\u306fDebian7.1\u4e0a\u3067\u884c\u3044\u307e\u3057\u305f\u3002\n\n\n\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u65b9\u6cd5\n\n\u6628\u65e5\u306eCloudatCost - DHCP\u30b5\u30fc\u30d0\u7121\u3057\u3067ArchLinux\u3092iPXE\u30d6\u30fc\u30c8\u306b\u6311\u6226 - Qiita\u3092\u53c2\u8003\n\n\nipxe.lkrn\u3092/dev/sda1\u306b\u7f6e\u304f\nmkdir a\nmount /dev/sda1 a\n\ncp ~/ipxe.lkrn a\n# grub rescue\u6642\u7528\u306b/boot\u3082\u30b3\u30d4\u30fc\u3057\u3066\u304a\u304f\u3002\ncp -a /boot a\numount a\n\n\n\nGrub2\u304b\u3089ipxe.lkrn\u3092\u30d6\u30fc\u30c8\u3055\u305b\u308b\n\n/etc/grub.d/40_custom\n#!/bin/sh\nexec tail -n +3 $0\n\nmenuentry 'Arch Linux Netboot Environment' {\n  set root='(hd0,1)'\n  linux16 /ipxe.lkrn\n}\n\n\nupdate-grub\nreboot\n\n\nArchLinux boot\u5f8c\u306e\u8a2d\u5b9a\npasswd\nsystemctl start sshd\n\n\nfdisk\u3067\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30f3\u5909\u66f4\u3002/dev/sda1\u306f\u305d\u306e\u307e\u307e\u6b8b\u3059\u3002\n\n\nfdisk\nDevice     Boot   Start      End  Sectors  Size Id Type\n/dev/sda1  *       2048   487423   485376  237M 83 Linux\n/dev/sda2        487424  1511423  1024000  500M 82 Linux swap / Solaris\n/dev/sda3       1511424 20971519 19460096  9.3G 83 Linux\n\n\n\n\u53cd\u6620\npartprobe\n\n\nmkswap /dev/sda2\n\nmkfs.ext4 /dev/sda3\nmount /dev/sda3 /mnt\npacstrap /mnt base grub-bios openssh sudo\n\narch-chroot /mnt /bin/bash\n\n\u7565)\n\n\u307e\u3068\u3081\n\n\u30ab\u30b9\u30bf\u30de\u30a4\u30ba\u3057\u305fipxe.lkrn\u3092\u6301\u3063\u3066\u3044\u308c\u3070\u306f\u304b\u3069\u308a\u307e\u3059\u306d\u3002\n\n\u3053\u306e\u8a18\u4e8b\u306fArch Linux Advent Calender 2015\u306e12\u65e5\u76ee\u3067\u3059\u3002\n\n* ArchLinux\u306e\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u304c\u7528\u610f\u3055\u308c\u3066\u3044\u306a\u3044CloudAtCost\u306bArchLinux\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\n* \u81ea\u5206\u306fDebian7.1\u4e0a\u3067\u884c\u3044\u307e\u3057\u305f\u3002\n\n## \u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u65b9\u6cd5\n\n* \u6628\u65e5\u306e[CloudatCost - DHCP\u30b5\u30fc\u30d0\u7121\u3057\u3067ArchLinux\u3092iPXE\u30d6\u30fc\u30c8\u306b\u6311\u6226 - Qiita](http://qiita.com/tukiyo3/items/5d004f149ec7546cbfa0#%E5%8F%82%E8%80%83)\u3092\u53c2\u8003\n\n\n```bash:ipxe.lkrn\u3092/dev/sda1\u306b\u7f6e\u304f\nmkdir a\nmount /dev/sda1 a\n\ncp ~/ipxe.lkrn a\n# grub rescue\u6642\u7528\u306b/boot\u3082\u30b3\u30d4\u30fc\u3057\u3066\u304a\u304f\u3002\ncp -a /boot a\numount a\n```\n\n## Grub2\u304b\u3089ipxe.lkrn\u3092\u30d6\u30fc\u30c8\u3055\u305b\u308b\n\n```bash:/etc/grub.d/40_custom\n#!/bin/sh\nexec tail -n +3 $0\n\nmenuentry 'Arch Linux Netboot Environment' {\n  set root='(hd0,1)'\n  linux16 /ipxe.lkrn\n}\n```\n\n```bash:\nupdate-grub\nreboot\n```\n\n## ArchLinux boot\u5f8c\u306e\u8a2d\u5b9a\n\n```bash:\npasswd\nsystemctl start sshd\n```\n\n* fdisk\u3067\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30f3\u5909\u66f4\u3002/dev/sda1\u306f\u305d\u306e\u307e\u307e\u6b8b\u3059\u3002\n\n```bash:fdisk\nDevice     Boot   Start      End  Sectors  Size Id Type\n/dev/sda1  *       2048   487423   485376  237M 83 Linux\n/dev/sda2        487424  1511423  1024000  500M 82 Linux swap / Solaris\n/dev/sda3       1511424 20971519 19460096  9.3G 83 Linux\n```\n\n```bash:\u53cd\u6620\npartprobe\n```\n\n```bash:\nmkswap /dev/sda2\n\nmkfs.ext4 /dev/sda3\nmount /dev/sda3 /mnt\npacstrap /mnt base grub-bios openssh sudo\n```\n\n```bash:\narch-chroot /mnt /bin/bash\n```\n\n\u7565)\n\n## \u307e\u3068\u3081\n\n* \u30ab\u30b9\u30bf\u30de\u30a4\u30ba\u3057\u305fipxe.lkrn\u3092\u6301\u3063\u3066\u3044\u308c\u3070\u306f\u304b\u3069\u308a\u307e\u3059\u306d\u3002\n"}