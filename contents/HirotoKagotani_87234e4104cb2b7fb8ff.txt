{"tags": ["\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0", "C", "algorithm"], "context": " More than 1 year has passed since last update.\n\n\u52d5\u6a5f\n\u5927\u304d\u306a\u6570\u306e\u968e\u4e57\u3092\u76f4\u63a5\u8a08\u7b97\u6a5f\u4e0a\u3067\u6271\u304a\u3046\u3068\u3059\u308b\u3068\u3001\u4f8b\u3048\u307032bit\u306a\u308912\u306e\u968e\u4e57\u307e\u3067\u3057\u304b\u8868\u73fe\u3067\u304d\u306a\u3044\u306e\u3067\u3001\u3061\u3087\u3063\u3068\u3057\u305f\u6570\u5b57\u3067\u3044\u304d\u306a\u308a\u591a\u500d\u9577\u6f14\u7b97\u304c\u5fc5\u8981\u306b\u306a\u3063\u3066\u304d\u307e\u3059\u3002\n\u3057\u304b\u3057\u3001\u4f8b\u3048\u3070 12!=1\u00d72\u00d73\u00d74\u00d75\u00d76\u00d77\u00d78\u00d79\u00d710\u00d711\u00d71212!=1\u00d72\u00d73\u00d74\u00d75\u00d76\u00d77\u00d78\u00d79\u00d710\u00d711\u00d71212!=1\\times2\\times3\\times4\\times5\\times6\\times7\\times8\\times9\\times10\\times11\\times12 \u306f\u3001\u7d20\u56e0\u6570\u5206\u89e3\u3057\u3066 =210\u00d735\u00d752\u00d771\u00d7111=210\u00d735\u00d752\u00d771\u00d7111=2^{10}\\times3^5\\times5^2\\times7^1\\times11^1 \u3068\u3082\u8868\u73fe\u3067\u304d\u307e\u3059\u3002\n\n\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\n\u968e\u4e57\u3092\u7d20\u56e0\u6570\u5206\u89e3\u3057\u305f\u3068\u304d\u306b\u5404\u7d20\u6570\u304c\u4f55\u500b\u51fa\u73fe\u3059\u308b\u304b\u306f\u3001\u6b21\u306e\u3088\u3046\u306b\u5bb9\u6613\u306b\u6c42\u3081\u3089\u308c\u307e\u3059\u3002\n12!=1\u00d72\u00d73\u00d74\u00d75\u00d76\u00d77\u00d78\u00d79\u00d710\u00d711\u00d71212!=1\u00d72\u00d73\u00d74\u00d75\u00d76\u00d77\u00d78\u00d79\u00d710\u00d711\u00d71212!=1\\times2\\times3\\times4\\times5\\times6\\times7\\times8\\times9\\times10\\times11\\times12 \u306b\u306f 222 \u306e\u500d\u6570\u304c \u230a12/2\u230b=6\u230a12/2\u230b=6\\lfloor12/2\\rfloor=6 \u56de\u51fa\u73fe\u3057\u3001 22222^2 \u306e\u500d\u6570\u304c \u230a12/22\u230b=3\u230a12/22\u230b=3\\lfloor12/2^2\\rfloor=3 \u56de\u51fa\u73fe\u3057\u3001 23232^3 \u306e\u500d\u6570\u304c \u230a12/23\u230b=1\u230a12/23\u230b=1\\lfloor12/2^3\\rfloor=1 \u56de\u51fa\u73fe\u3057\u307e\u3059\u3002\u3053\u306e 6+3+16+3+16+3+1 \u304c\u3001 12!12!12! \u3092\u7d20\u56e0\u6570\u5206\u89e3\u3057\u305f\u3068\u304d\u306e 222 \u306e\u500b\u6570\u3068\u3044\u3046\u308f\u3051\u3067\u3059\u3002\n333 \u306b\u3064\u3044\u3066\u3082\u540c\u69d8\u3067\u3001\u230a12/3\u230b+\u230a12/32\u230b=5\u230a12/3\u230b+\u230a12/32\u230b=5\\lfloor12/3\\rfloor+\\lfloor12/3^2\\rfloor=5 \u3068\u306a\u308a\u307e\u3059\u3002\n\u8ffd\u8a18 2014/8/28\n\u3053\u308c\u3092\u4e00\u822c\u5316\u3057\u305f\u3082\u306e\u3092\u3001\u300c\u30eb\u30b8\u30e3\u30f3\u30c9\u30eb\u306e\u5b9a\u7406\u300d\u3068\u3044\u3046\u3053\u3068\u3082\u3042\u308b\u3088\u3046\u3067\u3059\u3002\nFactorial (Wikipedia)\n\nAdrien-Marie Legendre found that the multiplicity of the prime ppp occurring in the prime factorization of n!n!n! can be expressed exactly as\n\u221e\u2211i=1\u230anpi\u230b\\sum_{i=1}^{\\infty} \\left \\lfloor \\frac{n}{p^i} \\right \\rfloor\n\n\u8ffd\u8a18\u7d42\u308f\u308a\n\u3053\u308c\u3089\u304b\u3089\u6b21\u306e\u3088\u3046\u306a\u624b\u9806\u3067\u6c42\u3081\u3089\u308c\u305d\u3046\u3067\u3059\u3002 n!n! \u306e\u7d20\u56e0\u6570\u5206\u89e3\u3092\u6c42\u3081\u308b\u306b\u306f\u3001\u307e\u305a nn \u307e\u3067\u306e\u7d20\u6570\u306e\u30ea\u30b9\u30c8\u304c\u5fc5\u8981\u306b\u306a\u308a\u307e\u3059\u306e\u3067\u3001\u3053\u308c\u3092\u30a8\u30e9\u30c8\u30b9\u30c6\u30cd\u30b9\u306e\u3075\u308b\u3044\u3067\u4f5c\u3063\u3066\u304a\u304d\u307e\u3059\u3002\u305d\u3057\u3066\u3001\u305d\u308c\u3089\u306e\u7d20\u6570\u306e1\u4e57\u3067\u306e\u5546\u30012\u4e57\u3067\u306e\u5546\u3001\u2026\u2026\u3092\u9806\u306b\u6c42\u3081\u308c\u3070\u3001\u305d\u308c\u3089\u306e\u548c\u304c\u3001\u7d20\u6570\u306e\u5fc5\u8981\u500b\u6570\u3068\u306a\u308b\u308f\u3051\u3067\u3059\u3002\n\u3075\u308b\u3044\u306e\u305f\u3081\u306b nn \u8981\u7d20\u306e\u914d\u5217\u3092\u7528\u610f\u3057\u305f\u306e\u3067\u3001\u30e1\u30e2\u30ea\u5bb9\u91cf\u306b\u3088\u308b\u5236\u7d04\u304c\u767a\u751f\u3057\u3066\u3057\u307e\u3044\u307e\u3059\u304c\u3001\u9045\u5ef6\u8a55\u4fa1\u306e\u3067\u304d\u308b\u8a00\u8a9e\u3067\u3042\u308c\u3070\u7121\u99c4\u306b\u30e1\u30e2\u30ea\u3092\u6d88\u8cbb\u3057\u306a\u3044\u8a18\u8ff0\u304c\u3067\u304d\u308b\u306e\u3067\u3001\u6709\u5229\u3068\u601d\u308f\u308c\u307e\u3059\u3002\n\n\u30b3\u30fc\u30c9\n\nfactfact.c\n#include <stdio.h>\n\nvoid\nfactfact(int n) {\n  int prime[n+1];\n  int i, j;\n\n  for (i = 2; i <= n; i++) {\n    prime[i] = 1;\n  }\n  for (i = 2; i <= n; i++) {\n    if (prime[i]) {\n      for (j = i*2; j <= n; j += i) {\n        prime[j] = 0;\n      }\n    }\n  }\n  for (i = 2; i <= n; i++) {\n    if (prime[i]) {\n      prime[i] = 0;\n      for (j = i; j <= n; j *= i) {\n        prime[i] += n/j;\n      }\n      printf(\"%d^%d\\n\", i, prime[i]);\n    }\n  }\n  printf(\"\\n\");\n}\n\nint\nmain(void) {\n  factfact(12);\n  factfact(1000000);\n  return 0;\n}\n\n\n# \u52d5\u6a5f\n\n\u5927\u304d\u306a\u6570\u306e\u968e\u4e57\u3092\u76f4\u63a5\u8a08\u7b97\u6a5f\u4e0a\u3067\u6271\u304a\u3046\u3068\u3059\u308b\u3068\u3001\u4f8b\u3048\u307032bit\u306a\u308912\u306e\u968e\u4e57\u307e\u3067\u3057\u304b\u8868\u73fe\u3067\u304d\u306a\u3044\u306e\u3067\u3001\u3061\u3087\u3063\u3068\u3057\u305f\u6570\u5b57\u3067\u3044\u304d\u306a\u308a\u591a\u500d\u9577\u6f14\u7b97\u304c\u5fc5\u8981\u306b\u306a\u3063\u3066\u304d\u307e\u3059\u3002\n\n\u3057\u304b\u3057\u3001\u4f8b\u3048\u3070 $12!=1\\times2\\times3\\times4\\times5\\times6\\times7\\times8\\times9\\times10\\times11\\times12$ \u306f\u3001\u7d20\u56e0\u6570\u5206\u89e3\u3057\u3066 $=2^{10}\\times3^5\\times5^2\\times7^1\\times11^1$ \u3068\u3082\u8868\u73fe\u3067\u304d\u307e\u3059\u3002\n\n# \u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\n\n\u968e\u4e57\u3092\u7d20\u56e0\u6570\u5206\u89e3\u3057\u305f\u3068\u304d\u306b\u5404\u7d20\u6570\u304c\u4f55\u500b\u51fa\u73fe\u3059\u308b\u304b\u306f\u3001\u6b21\u306e\u3088\u3046\u306b\u5bb9\u6613\u306b\u6c42\u3081\u3089\u308c\u307e\u3059\u3002\n\n$12!=1\\times2\\times3\\times4\\times5\\times6\\times7\\times8\\times9\\times10\\times11\\times12$ \u306b\u306f $2$ \u306e\u500d\u6570\u304c $\\lfloor12/2\\rfloor=6$ \u56de\u51fa\u73fe\u3057\u3001 $2^2$ \u306e\u500d\u6570\u304c $\\lfloor12/2^2\\rfloor=3$ \u56de\u51fa\u73fe\u3057\u3001 $2^3$ \u306e\u500d\u6570\u304c $\\lfloor12/2^3\\rfloor=1$ \u56de\u51fa\u73fe\u3057\u307e\u3059\u3002\u3053\u306e $6+3+1$ \u304c\u3001 $12!$ \u3092\u7d20\u56e0\u6570\u5206\u89e3\u3057\u305f\u3068\u304d\u306e $2$ \u306e\u500b\u6570\u3068\u3044\u3046\u308f\u3051\u3067\u3059\u3002\n\n$3$ \u306b\u3064\u3044\u3066\u3082\u540c\u69d8\u3067\u3001$\\lfloor12/3\\rfloor+\\lfloor12/3^2\\rfloor=5$ \u3068\u306a\u308a\u307e\u3059\u3002\n\n\u8ffd\u8a18 2014/8/28\n\u3053\u308c\u3092\u4e00\u822c\u5316\u3057\u305f\u3082\u306e\u3092\u3001\u300c[\u30eb\u30b8\u30e3\u30f3\u30c9\u30eb\u306e\u5b9a\u7406](http://mathtrain.jp/legendre)\u300d\u3068\u3044\u3046\u3053\u3068\u3082\u3042\u308b\u3088\u3046\u3067\u3059\u3002\n\n[Factorial](http://en.wikipedia.org/wiki/Factorial) (Wikipedia)\n\n>Adrien-Marie Legendre found that the multiplicity of the prime $p$ occurring in the prime factorization of $n!$ can be expressed exactly as\n>    $$\\sum_{i=1}^{\\infty} \\left \\lfloor \\frac{n}{p^i} \\right \\rfloor$$\n\n\u8ffd\u8a18\u7d42\u308f\u308a\n\n\u3053\u308c\u3089\u304b\u3089\u6b21\u306e\u3088\u3046\u306a\u624b\u9806\u3067\u6c42\u3081\u3089\u308c\u305d\u3046\u3067\u3059\u3002 $n!$ \u306e\u7d20\u56e0\u6570\u5206\u89e3\u3092\u6c42\u3081\u308b\u306b\u306f\u3001\u307e\u305a $n$ \u307e\u3067\u306e\u7d20\u6570\u306e\u30ea\u30b9\u30c8\u304c\u5fc5\u8981\u306b\u306a\u308a\u307e\u3059\u306e\u3067\u3001\u3053\u308c\u3092\u30a8\u30e9\u30c8\u30b9\u30c6\u30cd\u30b9\u306e\u3075\u308b\u3044\u3067\u4f5c\u3063\u3066\u304a\u304d\u307e\u3059\u3002\u305d\u3057\u3066\u3001\u305d\u308c\u3089\u306e\u7d20\u6570\u306e1\u4e57\u3067\u306e\u5546\u30012\u4e57\u3067\u306e\u5546\u3001\u2026\u2026\u3092\u9806\u306b\u6c42\u3081\u308c\u3070\u3001\u305d\u308c\u3089\u306e\u548c\u304c\u3001\u7d20\u6570\u306e\u5fc5\u8981\u500b\u6570\u3068\u306a\u308b\u308f\u3051\u3067\u3059\u3002\n\n\u3075\u308b\u3044\u306e\u305f\u3081\u306b $n$ \u8981\u7d20\u306e\u914d\u5217\u3092\u7528\u610f\u3057\u305f\u306e\u3067\u3001\u30e1\u30e2\u30ea\u5bb9\u91cf\u306b\u3088\u308b\u5236\u7d04\u304c\u767a\u751f\u3057\u3066\u3057\u307e\u3044\u307e\u3059\u304c\u3001\u9045\u5ef6\u8a55\u4fa1\u306e\u3067\u304d\u308b\u8a00\u8a9e\u3067\u3042\u308c\u3070\u7121\u99c4\u306b\u30e1\u30e2\u30ea\u3092\u6d88\u8cbb\u3057\u306a\u3044\u8a18\u8ff0\u304c\u3067\u304d\u308b\u306e\u3067\u3001\u6709\u5229\u3068\u601d\u308f\u308c\u307e\u3059\u3002\n\n# \u30b3\u30fc\u30c9\n\n```c:factfact.c\n#include <stdio.h>\n\nvoid\nfactfact(int n) {\n  int prime[n+1];\n  int i, j;\n\n  for (i = 2; i <= n; i++) {\n    prime[i] = 1;\n  }\n  for (i = 2; i <= n; i++) {\n    if (prime[i]) {\n      for (j = i*2; j <= n; j += i) {\n        prime[j] = 0;\n      }\n    }\n  }\n  for (i = 2; i <= n; i++) {\n    if (prime[i]) {\n      prime[i] = 0;\n      for (j = i; j <= n; j *= i) {\n        prime[i] += n/j;\n      }\n      printf(\"%d^%d\\n\", i, prime[i]);\n    }\n  }\n  printf(\"\\n\");\n}\n\nint\nmain(void) {\n  factfact(12);\n  factfact(1000000);\n  return 0;\n}\n```\n"}