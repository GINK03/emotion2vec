{"context": "\n\n\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\nExcel\u306e\u9078\u629e\u3057\u305f\u7bc4\u56f2\u306e\u30bb\u30eb\u3092\u3001Markdown\u5f62\u5f0f\u3067\u30af\u30ea\u30c3\u30d7\u30dc\u30fc\u30c9\u306b\u30b3\u30d4\u30fc\u3059\u308b\u3002\n\u203b\u5229\u7528\u306b\u306fMicrosoft Forms 2.0 Object Library\u3078\u306e\u53c2\u7167\u8a2d\u5b9a\u304c\u5fc5\u8981\n\nhttp://www.relief.jp/itnote/archives/017881.php\nhttp://answers.microsoft.com/ja-jp/office/forum/office_2010-excel/excel2010%E3%81%AEvba%E3%81%AE%E5%8F%82%E7%85%A7/360f7066-27d3-4c91-b8b3-79131ab4ba28\nOption Explicit\n\nConst MARKDOWN_TYPE As String = \"Normal\"\n\n' Markdown\u306e\u8868\u5f62\u5f0f\u306b\u5909\u63db\nFunction convertMarkdownTableFormat(element As String)\n    convertMarkdownTableFormat = \"|\" & element\nEnd Function\n\n' \u5404Markdown\u306e\u7a2e\u985e\u306b\u57fa\u3044\u3066\u3001\u8868\u5f62\u5f0f\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u3092\u4f5c\u6210\nFunction makeMarkdownTableFormatFromType(markdownType As String, number As Long)\n    Dim count As Long\n    Dim buffer As String\n\n    buffer = \"\"\n    If markdownType <> \"\" Then\n        For count = 1 To number Step 1\n            buffer = buffer & markdownType\n        Next\n        buffer = buffer & \"|\" & vbCrLf\n    End If\n\n    makeMarkdownTableFormatFromType = buffer\nEnd Function\n\n' Clipboard\u306b\u5024\u3092\u8a2d\u5b9a\nSub setClipBoard(data As String)\n    Dim ClipBoard As New DataObject\n\n    With ClipBoard\n        .SetText data       ''\u5909\u6570\u306e\u30c7\u30fc\u30bf\u3092DataObject\u306b\u683c\u7d0d\u3059\u308b\n        .PutInClipboard     ''DataObject\u306e\u30c7\u30fc\u30bf\u3092\u30af\u30ea\u30c3\u30d7\u30dc\u30fc\u30c9\u306b\u683c\u7d0d\u3059\u308b\n    End With\n\nEnd Sub\n\nSub main()\n    Dim markdownType As Object\n    Set markdownType = CreateObject(\"Scripting.Dictionary\")\n    markdownType.Add \"Normal\", \"|:-:\"\n    markdownType.Add \"Redmine\", \"\"\n\n    Dim selectionRange As Range\n    Dim selectionCell As Range\n\n    Dim leftEdgeColumn As Long\n    Dim leftEdgeRow As Long\n    Dim rightEdgeColumn As Long\n    Dim rightEdgeRow As Long\n    Dim currentColumn As Long\n    Dim currentRow As Long\n\n    Dim element As String\n    Dim buffer As String\n    Dim markdownTableFormat As String\n\n    leftEdgeColumn = Selection.Column\n    leftEdgeRow = Selection.Row\n    rightEdgeColumn = Selection(Selection.count).Column\n    rightEdgeRow = Selection(Selection.count).Row\n\n    ' \u8868\u306e1\u884c\u76ee\u3092\u8aad\u307f\u3053\u3080\n    buffer = \"\"\n    For currentColumn = leftEdgeColumn To rightEdgeColumn Step 1\n        element = Cells(leftEdgeRow, currentColumn)\n        buffer = buffer & convertMarkdownTableFormat(element)\n    Next\n    buffer = buffer & \"|\" & vbCrLf\n\n    ' \u5404Markdown\u306e\u7a2e\u985e\u306b\u57fa\u3044\u3066\u3001\u8868\u5f62\u5f0f\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u3092\u4f5c\u6210\n    markdownTableFormat = markdownType.Item(MARKDOWN_TYPE)\n    buffer = buffer & makeMarkdownTableFormatFromType(markdownTableFormat, rightEdgeColumn - leftEdgeColumn + 1)\n\n    ' \u8868\u306e2\u884c\u76ee\u4ee5\u964d\u3092\u8aad\u307f\u8fbc\u3080\n    For currentRow = leftEdgeRow + 1 To rightEdgeRow Step 1\n        For currentColumn = leftEdgeColumn To rightEdgeColumn Step 1\n            element = Cells(currentRow, currentColumn)\n            buffer = buffer & convertMarkdownTableFormat(element)\n        Next\n        buffer = buffer & \"|\" & vbCrLf\n    Next\n\n    ' Clipboard\u306b\u5024\u3092\u30b3\u30d4\u30fc\n    Call setClipBoard(buffer)\n\nEnd Sub\n\n\u4e0b\u8a18\u30a2\u30c9\u30a4\u30f3\u306b\u3088\u308a\u6d17\u7df4\u3055\u308c\u305f\u6a5f\u80fd\u304c\u4ed8\u3044\u3066\u3044\u308b\u6a21\u69d8\u2193\nhttps://love-guava.com/excel-relaxtools/\n\n\u25a0 \u53c2\u8003\n\nhttp://qiita.com/taruhachi/items/5bd18d7de4c3fa40dd23\nhttp://qiita.com/QUENCH/items/d77d0983d4a6d9d7de8e\nhttp://officetanaka.net/excel/vba/tips/tips20.htm\n\n# \u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\n\nExcel\u306e\u9078\u629e\u3057\u305f\u7bc4\u56f2\u306e\u30bb\u30eb\u3092\u3001Markdown\u5f62\u5f0f\u3067\u30af\u30ea\u30c3\u30d7\u30dc\u30fc\u30c9\u306b\u30b3\u30d4\u30fc\u3059\u308b\u3002\n\n<Font color=\"red\">\u203b\u5229\u7528\u306b\u306fMicrosoft Forms 2.0 Object Library\u3078\u306e\u53c2\u7167\u8a2d\u5b9a\u304c\u5fc5\u8981\n</font>\n\nhttp://www.relief.jp/itnote/archives/017881.php\nhttp://answers.microsoft.com/ja-jp/office/forum/office_2010-excel/excel2010%E3%81%AEvba%E3%81%AE%E5%8F%82%E7%85%A7/360f7066-27d3-4c91-b8b3-79131ab4ba28\n\n```vbnet\nOption Explicit\n\nConst MARKDOWN_TYPE As String = \"Normal\"\n\n' Markdown\u306e\u8868\u5f62\u5f0f\u306b\u5909\u63db\nFunction convertMarkdownTableFormat(element As String)\n    convertMarkdownTableFormat = \"|\" & element\nEnd Function\n\n' \u5404Markdown\u306e\u7a2e\u985e\u306b\u57fa\u3044\u3066\u3001\u8868\u5f62\u5f0f\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u3092\u4f5c\u6210\nFunction makeMarkdownTableFormatFromType(markdownType As String, number As Long)\n    Dim count As Long\n    Dim buffer As String\n\n    buffer = \"\"\n    If markdownType <> \"\" Then\n        For count = 1 To number Step 1\n            buffer = buffer & markdownType\n        Next\n        buffer = buffer & \"|\" & vbCrLf\n    End If\n    \n    makeMarkdownTableFormatFromType = buffer\nEnd Function\n\n' Clipboard\u306b\u5024\u3092\u8a2d\u5b9a\nSub setClipBoard(data As String)\n    Dim ClipBoard As New DataObject\n    \n    With ClipBoard\n        .SetText data       ''\u5909\u6570\u306e\u30c7\u30fc\u30bf\u3092DataObject\u306b\u683c\u7d0d\u3059\u308b\n        .PutInClipboard     ''DataObject\u306e\u30c7\u30fc\u30bf\u3092\u30af\u30ea\u30c3\u30d7\u30dc\u30fc\u30c9\u306b\u683c\u7d0d\u3059\u308b\n    End With\n    \nEnd Sub\n\nSub main()\n    Dim markdownType As Object\n    Set markdownType = CreateObject(\"Scripting.Dictionary\")\n    markdownType.Add \"Normal\", \"|:-:\"\n    markdownType.Add \"Redmine\", \"\"\n\n    Dim selectionRange As Range\n    Dim selectionCell As Range\n    \n    Dim leftEdgeColumn As Long\n    Dim leftEdgeRow As Long\n    Dim rightEdgeColumn As Long\n    Dim rightEdgeRow As Long\n    Dim currentColumn As Long\n    Dim currentRow As Long\n    \n    Dim element As String\n    Dim buffer As String\n    Dim markdownTableFormat As String\n    \n    leftEdgeColumn = Selection.Column\n    leftEdgeRow = Selection.Row\n    rightEdgeColumn = Selection(Selection.count).Column\n    rightEdgeRow = Selection(Selection.count).Row\n    \n    ' \u8868\u306e1\u884c\u76ee\u3092\u8aad\u307f\u3053\u3080\n    buffer = \"\"\n    For currentColumn = leftEdgeColumn To rightEdgeColumn Step 1\n        element = Cells(leftEdgeRow, currentColumn)\n        buffer = buffer & convertMarkdownTableFormat(element)\n    Next\n    buffer = buffer & \"|\" & vbCrLf\n    \n    ' \u5404Markdown\u306e\u7a2e\u985e\u306b\u57fa\u3044\u3066\u3001\u8868\u5f62\u5f0f\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u3092\u4f5c\u6210\n    markdownTableFormat = markdownType.Item(MARKDOWN_TYPE)\n    buffer = buffer & makeMarkdownTableFormatFromType(markdownTableFormat, rightEdgeColumn - leftEdgeColumn + 1)\n    \n    ' \u8868\u306e2\u884c\u76ee\u4ee5\u964d\u3092\u8aad\u307f\u8fbc\u3080\n    For currentRow = leftEdgeRow + 1 To rightEdgeRow Step 1\n        For currentColumn = leftEdgeColumn To rightEdgeColumn Step 1\n            element = Cells(currentRow, currentColumn)\n            buffer = buffer & convertMarkdownTableFormat(element)\n        Next\n        buffer = buffer & \"|\" & vbCrLf\n    Next\n    \n    ' Clipboard\u306b\u5024\u3092\u30b3\u30d4\u30fc\n    Call setClipBoard(buffer)\n    \nEnd Sub\n```\n\n\n\u4e0b\u8a18\u30a2\u30c9\u30a4\u30f3\u306b\u3088\u308a\u6d17\u7df4\u3055\u308c\u305f\u6a5f\u80fd\u304c\u4ed8\u3044\u3066\u3044\u308b\u6a21\u69d8\u2193\n\nhttps://love-guava.com/excel-relaxtools/\n\n# \u25a0 \u53c2\u8003\n* http://qiita.com/taruhachi/items/5bd18d7de4c3fa40dd23\n* http://qiita.com/QUENCH/items/d77d0983d4a6d9d7de8e\n* http://officetanaka.net/excel/vba/tips/tips20.htm\n\n", "tags": ["VBA", "Markdwon"]}