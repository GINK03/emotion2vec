{"context": " More than 1 year has passed since last update.% tex \u30d8\u30c3\u30c0\n\\newcommand\\set[1]{\\{#1\\}}\n\\newcommand\\setc[2]{\\{\\;#1 \\mid #2\\;\\}}\n\\newcommand\\card[1]{\\operatorname{card}(#1)}\n\\newcommand\\ixran[2]{[#1, #2)}\n$${% tex \u30d8\u30c3\u30c0\n\\newcommand\\set[1]{\\{#1\\}}\n\\newcommand\\setc[2]{\\{\\;#1 \\mid #2\\;\\}}\n\\newcommand\\card[1]{\\operatorname{card}(#1)}\n\\newcommand\\ixran[2]{[#1, #2)}\n}$$\n\n\u554f\u984c\n$n, m$ \u3092\u6574\u6570\u3068\u3057\u3001$1 \\leq m \\leq n$ \u3068\u3059\u308b\u3002\n\u6574\u6570\u306e\u96c6\u54081 $\\ixran{0}{n} := \\set{0, \\ldots, n - 1}$ \u304b\u3089 $m$ \u500b\u3092\u91cd\u8907\u306a\u304f\u9078\u3073\u305f\u3044\u3002\u9806\u756a\u306f\u554f\u308f\u306a\u3044\u3002\n\n\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\n\n\u5b9f\u88c5\u4f8b\n// F#\nopen System\nopen System.Collections.Generic\n\nlet randomCombi =\n  let rng = Random()\n  fun n m ->\n    assert (0 <= m && m <= n)\n    let r = n - m\n    let mutable s = HashSet()\n    for j in 0..(m - 1) do\n      // [0, r + j] \u304b\u3089\u6574\u6570\u30921\u3064\u30e9\u30f3\u30c0\u30e0\u306b\u3068\u308b\n      let t = rng.Next(0, r + j + 1)\n      s.Add (if s.Contains(t) then r + j else t)\n    s\n\n\n\u5b9a\u5f0f\u5316\n$r := n - m$ \u3068\u304a\u304f\u3002\n$j$ ($\\in \\ixran{0}{m}$) \u306f\u6574\u6570\u3068\u3059\u308b\u3002\n\u5404 $j$ \u306b\u5bfe\u3057\u3066\u3001\u533a\u9593 $[0, r + j]$ \u304b\u3089\u6574\u6570 $t_j$ \u3092\u30e9\u30f3\u30c0\u30e0\u306b\u3068\u308b\u3002\u5404\u5143\u304c\u9078\u3070\u308c\u308b\u78ba\u7387\u306f\u305d\u308c\u305e\u308c $\\frac{1}{r + j + 1}$ \u3068\u3059\u308b\u3002\n\u307e\u305f\u3001\u5404 $j$ \u306b\u5bfe\u3057\u3066\u3001\n\\begin{align}\n      T_0\n        & := \\emptyset\n  \\\\  T_{j + 1}\n        & :=\n          \\begin{cases}\n                T_j \\cup \\set{r + j}\n                  & \\text{($t_j \\in T_j$)}\n            \\\\  T_j \\cup \\set{t_j}\n                  & \\text{($t_j \\not\\in T_j$)}\n          \\end{cases}\n\\end{align}\n$${\\begin{align}\n      T_0\n        & := \\emptyset\n  \\\\  T_{j + 1}\n        & :=\n          \\begin{cases}\n                T_j \\cup \\set{r + j}\n                  & \\text{($t_j \\in T_j$)}\n            \\\\  T_j \\cup \\set{t_j}\n                  & \\text{($t_j \\not\\in T_j$)}\n          \\end{cases}\n\\end{align}\n}$$\n\u3068\u304a\u304f\u3002\n\u96c6\u5408 $T_m$ \u304c\u6c42\u3081\u308b\u7d44\u307f\u5408\u308f\u305b\u3067\u3042\u308b\u3002\n\n\u6b63\u5f53\u6027\n\n$T_m \\subset [0, n)$\n$\\card{T_m} = m$\n\n\n$\\card{\\cdot}$ \u306f\u96c6\u5408\u306e\u8981\u7d20\u6570\u3092\u8868\u3059\u3002($|\\cdot|$ \u3068\u3082\u66f8\u304f\u3002)\n\n\n$\\forall k \\in [0, n) \\quad (P(k \\in T_m) = \\frac{m}{n})$\n\n\n\u3053\u3053\u3067\u3001$P(A)$ \u306f $A$ \u304c\u8d77\u3053\u308b\u78ba\u7387\u3092\u8868\u3059\u3002(\u30a2\u30d0\u30a6\u30c8)\n\n\n\n(1)\u3001(2) \u306f\u3001$T_m$ \u304c n \u500b\u304b\u3089 m \u500b\u3092\u91cd\u8907\u306a\u304f\u3068\u3063\u305f\u7d44\u307f\u5408\u308f\u305b\u3067\u3042\u308b\u3053\u3068\u3092\u3001(3) \u306f\u5404\u6574\u6570\u304c\u7b49\u78ba\u7387\u3067\u9078\u3070\u308c\u308b\u3053\u3068\u3092\u8868\u3057\u3066\u3044\u308b\u3002\n\n\u8a3c\u660e (1)\n\u660e\u3089\u304b\u3002\n\n\u8a3c\u660e (2)\n$T_j$ \u306e\u5b9a\u7fa9\u3088\u308a\u3001\u5404 $j$ \u306b\u5bfe\u3057\u3066 $\\card{T_j} = j$ \u3067\u3042\u308b\u3002\n\u7279\u306b $\\card{T_m} = m$\u3002(\u8a3c\u660e\u7d42)\n\n\u8a3c\u660e (3)\n\u4efb\u610f\u306e $k$ ($\\in \\ixran{0}{n}$) \u3092\u3068\u308b\u3002\n\u5404 $j$ ($\\in [0, m]$) \u306b\u5bfe\u3057\u3066\u3001$P_j := P(k \\not\\in T_j)$ \u3068\u304a\u304f\u3002\n$k$ \u304c\u7d44\u307f\u5408\u308f\u305b $T_m$ \u306e\u5143\u3067\u3042\u308b\u305f\u3081\u306b\u306f\u3001\u3044\u305a\u308c\u304b\u306e $t_j$ \u306b\u9078\u3070\u308c\u308b\u304b\u3001\u307e\u305f\u306f $k = r + j$ \u3068\u306a\u308b $j$ ($= k - r$) \u306b\u5bfe\u3057 $t_j \\in T_j$ \u3068\u306a\u308b\u304b\u3001\u306e\u5c11\u306a\u304f\u3068\u3082\u4e00\u65b9\u304c\u3044\u3048\u306a\u3051\u308c\u3070\u3044\u3051\u306a\u3044\u3002\n\n$k \\in \\ixran{0}{r + 1}$ \u306e\u5834\u5408\n\n\u3059\u3079\u3066\u306e $j$ ($\\geq 1$) \u306b\u5bfe\u3057\u3066 $k \\not= r + j$ \u3067\u3042\u308b\u3057\u3001$k - r = 0$ \u3060\u304b\u3089 $t_0 \\in T_0$ \u3082\u3042\u308a\u3048\u306a\u3044\u3002\u305d\u306e\u305f\u3081\u3001\u3053\u306e\u5834\u5408\u306f $k$ \u304c\u3044\u305a\u308c\u304b\u306e $t_j$ \u306b\u9078\u3070\u308c\u308b\u304b\u3069\u3046\u304b\u3060\u3051\u8003\u3048\u308c\u3070\u3088\u3044\u3002\n\u5404 $j$ \u306b\u5bfe\u3057\u3066\u3001\n\\begin{align}\n  P_{j + 1}\n      & = P(k \\not\\in T_j \\land k \\not= t_j)\n  \\\\  & = P_j \\times P(k \\not= t_j \\mid k \\not\\in T_j)\n  \\\\  & = P_j \\times P(k \\not= t_j)\n  \\\\  & = P_j \\times (1 - \\frac{1}{r + j + 1})\n\\end{align}\n$${\\begin{align}\n  P_{j + 1}\n      & = P(k \\not\\in T_j \\land k \\not= t_j)\n  \\\\  & = P_j \\times P(k \\not= t_j \\mid k \\not\\in T_j)\n  \\\\  & = P_j \\times P(k \\not= t_j)\n  \\\\  & = P_j \\times (1 - \\frac{1}{r + j + 1})\n\\end{align}\n}$$\n\u3068\u306a\u308b\u3002\u6f38\u5316\u5f0f\u3092\u89e3\u3044\u3066\u3001\n\\begin{align}\n  P_m\n      & = \\prod_{j = 0}^{m - 1} \\frac{r + j}{r + j + 1}\n  \\\\  & = \\frac{r}{r + (m - 1) + 1}\n  \\\\  & = \\frac{n - m}{n}\n\\end{align}\n$${\\begin{align}\n  P_m\n      & = \\prod_{j = 0}^{m - 1} \\frac{r + j}{r + j + 1}\n  \\\\  & = \\frac{r}{r + (m - 1) + 1}\n  \\\\  & = \\frac{n - m}{n}\n\\end{align}\n}$$\n\u3092\u5f97\u308b\u3002\u3057\u305f\u304c\u3063\u3066\nP(k \\in T_m) = 1 - P_m = \\frac{m}{n}\n$${P(k \\in T_m) = 1 - P_m = \\frac{m}{n}\n}$$\n\n$k \\in \\ixran{r + 1}{n}$ \u306e\u5834\u5408\n\n\u5148\u8ff0\u306e\u901a\u308a\u3001$j := k - r$ ($\\geq 1$) \u306b\u5bfe\u3057\u3066 $t_j \\in T_j$ \u3068\u306a\u308b\u3053\u3068\u3067\u3001\u7d44\u307f\u5408\u308f\u305b\u306b $r + j = k$ \u304c\u542b\u307e\u308c\u308b\u53ef\u80fd\u6027\u304c\u3042\u308b\u3053\u3068\u306b\u6ce8\u610f\u3059\u308b\u3002\n\u307e\u305f\u3001$t_j = k$ \u3068\u306a\u308a\u3046\u308b\u306e\u306f\u3001$k \\leq r + j$ \u3059\u306a\u308f\u3061 $j \\geq k - r$ \u306e\u3068\u304d\u3067\u3042\u308b\u3002 \n\\begin{align}\n  P_m\n      & = P(k \\not\\in T_m)\n  \\\\  & = P(    k \\not\\in \\setc{t_j}{j \\in \\ixran{k - r}{m}}\n          \\land t_{k - r} \\not\\in T_{k - r}\n          )\n  \\\\  & =      P(k \\not\\in \\setc{t_j}{j \\in \\ixran{k - r}{m}})\n        \\times P(t_{k - r} \\not\\in T_{k - r}\n                \\mid k \\not\\in \\setc{t_j}{j \\in \\ixran{k - r}{m}})\n  \\\\  & =      P(k \\not\\in \\setc{t_j}{j \\in \\ixran{k - r}{m}})\n        \\times P(t_{k - r} \\not\\in T_{k - r}\n                \\mid k \\not= t_{k - r})\n\\end{align}\n$${\\begin{align}\n  P_m\n      & = P(k \\not\\in T_m)\n  \\\\  & = P(    k \\not\\in \\setc{t_j}{j \\in \\ixran{k - r}{m}}\n          \\land t_{k - r} \\not\\in T_{k - r}\n          )\n  \\\\  & =      P(k \\not\\in \\setc{t_j}{j \\in \\ixran{k - r}{m}})\n        \\times P(t_{k - r} \\not\\in T_{k - r}\n                \\mid k \\not\\in \\setc{t_j}{j \\in \\ixran{k - r}{m}})\n  \\\\  & =      P(k \\not\\in \\setc{t_j}{j \\in \\ixran{k - r}{m}})\n        \\times P(t_{k - r} \\not\\in T_{k - r}\n                \\mid k \\not= t_{k - r})\n\\end{align}\n}$$\n\u7a4d\u306e\u5de6\u8fba\u306f\u3001$k \\in \\ixran{0}{r + 1}$ \u306e\u30b1\u30fc\u30b9\u3068\u540c\u69d8\u306b\u3001\n\\begin{align}\n  P(k \\not\\in \\setc{t_j}{j \\in \\ixran{k - r}{m}})\n      & = \\prod_{j = k - r}^{m - 1} \\frac{r + j}{r + j + 1}\n  \\\\  & = \\frac{r + (k - r)}{r + (m - 1) + 1}\n  \\\\  & = \\frac{k}{n}\n\\end{align}\n$${\\begin{align}\n  P(k \\not\\in \\setc{t_j}{j \\in \\ixran{k - r}{m}})\n      & = \\prod_{j = k - r}^{m - 1} \\frac{r + j}{r + j + 1}\n  \\\\  & = \\frac{r + (k - r)}{r + (m - 1) + 1}\n  \\\\  & = \\frac{k}{n}\n\\end{align}\n}$$\n\u3068\u6c42\u307e\u308b\u3002\n\u7a4d\u306e\u53f3\u8fba\u3092\u6c42\u3081\u3088\u3046\u3002$j := k - r$ \u3068\u304a\u304f\u3002\u3053\u306e\u6bb5\u968e\u3067\u3001\u7d44\u307f\u5408\u308f\u305b $T_j$ \u306f\u3059\u3067\u306b\u3067\u304d\u3066\u3044\u308b\u3068\u8003\u3048\u3066\u3088\u3044\u3002\n\u624b\u9806\u901a\u308a\u3001\u96c6\u5408 $[0, k]$ \u304b\u30891\u3064\u306e\u6574\u6570 $t_j$ \u3092\u9078\u3076\u3002\u3044\u307e $k \\not= t_j$ \u304c\u5206\u304b\u3063\u3066\u3044\u308b\u3068\u3059\u308b\u3068\u3001$k$ \u500b\u306e\u6574\u6570($[0, k] \\setminus \\set{k} = \\ixran{0}{k}$)\u304b\u30891\u3064\u3092\u9078\u3076\u3053\u3068\u306b\u306a\u308b\u3002\u3086\u3048\u306b\u3001$t_j$ \u3068\u3057\u3066 $T_j$ \u306e\u5143\u304c\u9078\u3070\u308c\u306a\u3044\u78ba\u7387\u306f\u3001\n\\begin{align}\n  P(t_j \\not\\in T_j\n    \\mid k \\not= t_j)\n      & = 1 - \\frac{\\card{T_j}}{\\card{\\ixran{0}{k}}}\n  \\\\  & = 1 - \\frac{j}{k}\n  \\\\  & = 1 - \\frac{k - r}{k}\n  \\\\  & = \\frac{r}{k}\n\\end{align}\n$${\\begin{align}\n  P(t_j \\not\\in T_j\n    \\mid k \\not= t_j)\n      & = 1 - \\frac{\\card{T_j}}{\\card{\\ixran{0}{k}}}\n  \\\\  & = 1 - \\frac{j}{k}\n  \\\\  & = 1 - \\frac{k - r}{k}\n  \\\\  & = \\frac{r}{k}\n\\end{align}\n}$$\n\u3067\u3042\u308b\u3002\u3057\u305f\u304c\u3063\u3066\u3001\n\\begin{align}\n  P(k \\in T_m)\n     & = 1 - P_m\n  \\\\ & = 1 - (\\frac{r}{k} \\times \\frac{k}{n})\n  \\\\ & = 1 - \\frac{r}{n}\n  \\\\ & = \\frac{m}{n}\n\\end{align}\n$${\\begin{align}\n  P(k \\in T_m)\n     & = 1 - P_m\n  \\\\ & = 1 - (\\frac{r}{k} \\times \\frac{k}{n})\n  \\\\ & = 1 - \\frac{r}{n}\n  \\\\ & = \\frac{m}{n}\n\\end{align}\n}$$\n(\u8a3c\u660e\u7d42)\n\n\u53c2\u8003\u6587\u732e\n\u6839\u672c\u7684\u306a\u30a2\u30a4\u30c7\u30a3\u30a2\u306f\u3059\u3079\u3066\u4ee5\u4e0b\u306b\u3042\u308b\u3082\u306e\u3002\n\n\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0: http://stackoverflow.com/questions/2394246/algorithm-to-select-a-single-random-combination-of-values/2394292#2394292\n\nJon Bentley \u306e\u300cProgramming Pearls\u300d\u306e\u30b3\u30e9\u30e0 \"A sample of Brilliance\" \u304b\u3089\u306e\u5f15\u7528\u3067\u3042\u308b\u3089\u3057\u3044\u3002\u672c\u7a3f\u306e\u7b46\u8005\u306f\u5f53\u66f8\u7c4d\u3092\u78ba\u8a8d\u3057\u3066\u3044\u306a\u3044\u3002\n\n\n\u8a3c\u660e: http://math.stackexchange.com/questions/178690/whats-the-proof-of-correctness-for-robert-floyds-algorithm-for-selecting-a-sin/178723#178723\n\n\n\n\n\n\n\u672c\u7a3f\u3067\u306f $[l, r]$ \u3084 $\\ixran{l}{r}$ \u306f\u6574\u6570\u306e\u533a\u9593\u3092\u8868\u3059\u305f\u3081\u306b\u7528\u3044\u308b\u3002\u00a0\u21a9\n\n\n\n```math\n% tex \u30d8\u30c3\u30c0\n\\newcommand\\set[1]{\\{#1\\}}\n\\newcommand\\setc[2]{\\{\\;#1 \\mid #2\\;\\}}\n\\newcommand\\card[1]{\\operatorname{card}(#1)}\n\\newcommand\\ixran[2]{[#1, #2)}\n```\n\n## \u554f\u984c\n$n, m$ \u3092\u6574\u6570\u3068\u3057\u3001$1 \\leq m \\leq n$ \u3068\u3059\u308b\u3002\n\u6574\u6570\u306e\u96c6\u5408[^0] $\\ixran{0}{n} := \\set{0, \\ldots, n - 1}$ \u304b\u3089 $m$ \u500b\u3092\u91cd\u8907\u306a\u304f\u9078\u3073\u305f\u3044\u3002\u9806\u756a\u306f\u554f\u308f\u306a\u3044\u3002\n\n[^0]: \u672c\u7a3f\u3067\u306f $[l, r]$ \u3084 $\\ixran{l}{r}$ \u306f\u6574\u6570\u306e\u533a\u9593\u3092\u8868\u3059\u305f\u3081\u306b\u7528\u3044\u308b\u3002\n\n## \u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\n### \u5b9f\u88c5\u4f8b\n```fsharp\n// F#\nopen System\nopen System.Collections.Generic\n\nlet randomCombi =\n  let rng = Random()\n  fun n m ->\n    assert (0 <= m && m <= n)\n    let r = n - m\n    let mutable s = HashSet()\n    for j in 0..(m - 1) do\n      // [0, r + j] \u304b\u3089\u6574\u6570\u30921\u3064\u30e9\u30f3\u30c0\u30e0\u306b\u3068\u308b\n      let t = rng.Next(0, r + j + 1)\n      s.Add (if s.Contains(t) then r + j else t)\n    s\n```\n\n### \u5b9a\u5f0f\u5316\n$r := n - m$ \u3068\u304a\u304f\u3002\n$j$ ($\\in \\ixran{0}{m}$) \u306f\u6574\u6570\u3068\u3059\u308b\u3002\n\u5404 $j$ \u306b\u5bfe\u3057\u3066\u3001\u533a\u9593 $[0, r + j]$ \u304b\u3089\u6574\u6570 $t_j$ \u3092\u30e9\u30f3\u30c0\u30e0\u306b\u3068\u308b\u3002\u5404\u5143\u304c\u9078\u3070\u308c\u308b\u78ba\u7387\u306f\u305d\u308c\u305e\u308c $\\frac{1}{r + j + 1}$ \u3068\u3059\u308b\u3002\n\u307e\u305f\u3001\u5404 $j$ \u306b\u5bfe\u3057\u3066\u3001\n\n```math\n\\begin{align}\n      T_0\n        & := \\emptyset\n  \\\\  T_{j + 1}\n        & :=\n          \\begin{cases}\n                T_j \\cup \\set{r + j}\n                  & \\text{($t_j \\in T_j$)}\n            \\\\  T_j \\cup \\set{t_j}\n                  & \\text{($t_j \\not\\in T_j$)}\n          \\end{cases}\n\\end{align}\n```\n\n\u3068\u304a\u304f\u3002\n\u96c6\u5408 $T_m$ \u304c\u6c42\u3081\u308b\u7d44\u307f\u5408\u308f\u305b\u3067\u3042\u308b\u3002\n\n## \u6b63\u5f53\u6027\n0. $T_m \\subset [0, n)$\n0. $\\card{T_m} = m$\n  * $\\card{\\cdot}$ \u306f\u96c6\u5408\u306e\u8981\u7d20\u6570\u3092\u8868\u3059\u3002($|\\cdot|$ \u3068\u3082\u66f8\u304f\u3002)\n0. $\\forall k \\in [0, n) \\quad (P(k \\in T_m) = \\frac{m}{n})$\n  * \u3053\u3053\u3067\u3001$P(A)$ \u306f $A$ \u304c\u8d77\u3053\u308b\u78ba\u7387\u3092\u8868\u3059\u3002(\u30a2\u30d0\u30a6\u30c8)\n\n(1)\u3001(2) \u306f\u3001$T_m$ \u304c n \u500b\u304b\u3089 m \u500b\u3092\u91cd\u8907\u306a\u304f\u3068\u3063\u305f\u7d44\u307f\u5408\u308f\u305b\u3067\u3042\u308b\u3053\u3068\u3092\u3001(3) \u306f\u5404\u6574\u6570\u304c\u7b49\u78ba\u7387\u3067\u9078\u3070\u308c\u308b\u3053\u3068\u3092\u8868\u3057\u3066\u3044\u308b\u3002\n\n### \u8a3c\u660e (1)\n\u660e\u3089\u304b\u3002\n\n### \u8a3c\u660e (2)\n$T_j$ \u306e\u5b9a\u7fa9\u3088\u308a\u3001\u5404 $j$ \u306b\u5bfe\u3057\u3066 $\\card{T_j} = j$ \u3067\u3042\u308b\u3002\n\u7279\u306b $\\card{T_m} = m$\u3002(\u8a3c\u660e\u7d42)\n\n### \u8a3c\u660e (3)\n\u4efb\u610f\u306e $k$ ($\\in \\ixran{0}{n}$) \u3092\u3068\u308b\u3002\n\u5404 $j$ ($\\in [0, m]$) \u306b\u5bfe\u3057\u3066\u3001$P_j := P(k \\not\\in T_j)$ \u3068\u304a\u304f\u3002\n\n$k$ \u304c\u7d44\u307f\u5408\u308f\u305b $T_m$ \u306e\u5143\u3067\u3042\u308b\u305f\u3081\u306b\u306f\u3001\u3044\u305a\u308c\u304b\u306e $t_j$ \u306b\u9078\u3070\u308c\u308b\u304b\u3001\u307e\u305f\u306f $k = r + j$ \u3068\u306a\u308b $j$ ($= k - r$) \u306b\u5bfe\u3057 $t_j \\in T_j$ \u3068\u306a\u308b\u304b\u3001\u306e\u5c11\u306a\u304f\u3068\u3082\u4e00\u65b9\u304c\u3044\u3048\u306a\u3051\u308c\u3070\u3044\u3051\u306a\u3044\u3002\n\n* $k \\in \\ixran{0}{r + 1}$ \u306e\u5834\u5408\n\n\u3059\u3079\u3066\u306e $j$ ($\\geq 1$) \u306b\u5bfe\u3057\u3066 $k \\not= r + j$ \u3067\u3042\u308b\u3057\u3001$k - r = 0$ \u3060\u304b\u3089 $t_0 \\in T_0$ \u3082\u3042\u308a\u3048\u306a\u3044\u3002\u305d\u306e\u305f\u3081\u3001\u3053\u306e\u5834\u5408\u306f $k$ \u304c\u3044\u305a\u308c\u304b\u306e $t_j$ \u306b\u9078\u3070\u308c\u308b\u304b\u3069\u3046\u304b\u3060\u3051\u8003\u3048\u308c\u3070\u3088\u3044\u3002\n\u5404 $j$ \u306b\u5bfe\u3057\u3066\u3001\n\n```math\n\\begin{align}\n  P_{j + 1}\n      & = P(k \\not\\in T_j \\land k \\not= t_j)\n  \\\\  & = P_j \\times P(k \\not= t_j \\mid k \\not\\in T_j)\n  \\\\  & = P_j \\times P(k \\not= t_j)\n  \\\\  & = P_j \\times (1 - \\frac{1}{r + j + 1})\n\\end{align}\n```\n\n\u3068\u306a\u308b\u3002\u6f38\u5316\u5f0f\u3092\u89e3\u3044\u3066\u3001\n\n```math\n\\begin{align}\n  P_m\n      & = \\prod_{j = 0}^{m - 1} \\frac{r + j}{r + j + 1}\n  \\\\  & = \\frac{r}{r + (m - 1) + 1}\n  \\\\  & = \\frac{n - m}{n}\n\\end{align}\n```\n\n\u3092\u5f97\u308b\u3002\u3057\u305f\u304c\u3063\u3066\n\n```math\nP(k \\in T_m) = 1 - P_m = \\frac{m}{n}\n```\n\n* $k \\in \\ixran{r + 1}{n}$ \u306e\u5834\u5408\n\n\u5148\u8ff0\u306e\u901a\u308a\u3001$j := k - r$ ($\\geq 1$) \u306b\u5bfe\u3057\u3066 $t_j \\in T_j$ \u3068\u306a\u308b\u3053\u3068\u3067\u3001\u7d44\u307f\u5408\u308f\u305b\u306b $r + j = k$ \u304c\u542b\u307e\u308c\u308b\u53ef\u80fd\u6027\u304c\u3042\u308b\u3053\u3068\u306b\u6ce8\u610f\u3059\u308b\u3002\n\u307e\u305f\u3001$t_j = k$ \u3068\u306a\u308a\u3046\u308b\u306e\u306f\u3001$k \\leq r + j$ \u3059\u306a\u308f\u3061 $j \\geq k - r$ \u306e\u3068\u304d\u3067\u3042\u308b\u3002 \n\n```math\n\\begin{align}\n  P_m\n      & = P(k \\not\\in T_m)\n  \\\\  & = P(    k \\not\\in \\setc{t_j}{j \\in \\ixran{k - r}{m}}\n          \\land t_{k - r} \\not\\in T_{k - r}\n          )\n  \\\\  & =      P(k \\not\\in \\setc{t_j}{j \\in \\ixran{k - r}{m}})\n        \\times P(t_{k - r} \\not\\in T_{k - r}\n                \\mid k \\not\\in \\setc{t_j}{j \\in \\ixran{k - r}{m}})\n  \\\\  & =      P(k \\not\\in \\setc{t_j}{j \\in \\ixran{k - r}{m}})\n        \\times P(t_{k - r} \\not\\in T_{k - r}\n                \\mid k \\not= t_{k - r})\n\\end{align}\n```\n\n\u7a4d\u306e\u5de6\u8fba\u306f\u3001$k \\in \\ixran{0}{r + 1}$ \u306e\u30b1\u30fc\u30b9\u3068\u540c\u69d8\u306b\u3001\n\n```math\n\\begin{align}\n  P(k \\not\\in \\setc{t_j}{j \\in \\ixran{k - r}{m}})\n      & = \\prod_{j = k - r}^{m - 1} \\frac{r + j}{r + j + 1}\n  \\\\  & = \\frac{r + (k - r)}{r + (m - 1) + 1}\n  \\\\  & = \\frac{k}{n}\n\\end{align}\n```\n\n\u3068\u6c42\u307e\u308b\u3002\n\n\u7a4d\u306e\u53f3\u8fba\u3092\u6c42\u3081\u3088\u3046\u3002$j := k - r$ \u3068\u304a\u304f\u3002\u3053\u306e\u6bb5\u968e\u3067\u3001\u7d44\u307f\u5408\u308f\u305b $T_j$ \u306f\u3059\u3067\u306b\u3067\u304d\u3066\u3044\u308b\u3068\u8003\u3048\u3066\u3088\u3044\u3002\n\u624b\u9806\u901a\u308a\u3001\u96c6\u5408 $[0, k]$ \u304b\u30891\u3064\u306e\u6574\u6570 $t_j$ \u3092\u9078\u3076\u3002\u3044\u307e $k \\not= t_j$ \u304c\u5206\u304b\u3063\u3066\u3044\u308b\u3068\u3059\u308b\u3068\u3001$k$ \u500b\u306e\u6574\u6570($[0, k] \\setminus \\set{k} = \\ixran{0}{k}$)\u304b\u30891\u3064\u3092\u9078\u3076\u3053\u3068\u306b\u306a\u308b\u3002\u3086\u3048\u306b\u3001$t_j$ \u3068\u3057\u3066 $T_j$ \u306e\u5143\u304c\u9078\u3070\u308c**\u306a\u3044**\u78ba\u7387\u306f\u3001\n\n```math\n\\begin{align}\n  P(t_j \\not\\in T_j\n    \\mid k \\not= t_j)\n      & = 1 - \\frac{\\card{T_j}}{\\card{\\ixran{0}{k}}}\n  \\\\  & = 1 - \\frac{j}{k}\n  \\\\  & = 1 - \\frac{k - r}{k}\n  \\\\  & = \\frac{r}{k}\n\\end{align}\n```\n\n\u3067\u3042\u308b\u3002\u3057\u305f\u304c\u3063\u3066\u3001\n\n```math\n\\begin{align}\n  P(k \\in T_m)\n     & = 1 - P_m\n  \\\\ & = 1 - (\\frac{r}{k} \\times \\frac{k}{n})\n  \\\\ & = 1 - \\frac{r}{n}\n  \\\\ & = \\frac{m}{n}\n\\end{align}\n```\n\n(\u8a3c\u660e\u7d42)\n\n## \u53c2\u8003\u6587\u732e\n\u6839\u672c\u7684\u306a\u30a2\u30a4\u30c7\u30a3\u30a2\u306f\u3059\u3079\u3066\u4ee5\u4e0b\u306b\u3042\u308b\u3082\u306e\u3002\n\n* \u30a2\u30eb\u30b4\u30ea\u30ba\u30e0: <http://stackoverflow.com/questions/2394246/algorithm-to-select-a-single-random-combination-of-values/2394292#2394292>\n  * Jon Bentley \u306e\u300cProgramming Pearls\u300d\u306e\u30b3\u30e9\u30e0 \"A sample of Brilliance\" \u304b\u3089\u306e\u5f15\u7528\u3067\u3042\u308b\u3089\u3057\u3044\u3002\u672c\u7a3f\u306e\u7b46\u8005\u306f\u5f53\u66f8\u7c4d\u3092\u78ba\u8a8d\u3057\u3066\u3044\u306a\u3044\u3002\n* \u8a3c\u660e: <http://math.stackexchange.com/questions/178690/whats-the-proof-of-correctness-for-robert-floyds-algorithm-for-selecting-a-sin/178723#178723>\n", "tags": ["\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0"]}