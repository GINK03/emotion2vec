{"context": " More than 1 year has passed since last update.Ansible\u306e\u30b3\u30fc\u30c9\u3092test-kitchen\u3068ServerSpec\u3001Docker\u3067\u30c6\u30b9\u30c8\u3057\u307e\u3059\u3002\u30b5\u30f3\u30d7\u30eb\u3068\u3057\u3066\u3001Ansible\u3067Apache\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u3001ServerSpec\u3067\u30c6\u30b9\u30c8\u3092\u884c\u3044\u307e\u3059\u3002\n\n\u4e8b\u524d\u6e96\u5099\ntest-kitchen\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\n$ sudo gem install test-kitchen -v 1.2.1\nFetching: test-kitchen-1.2.1.gem (100%)\nSuccessfully installed test-kitchen-1.2.1\nInstalling ri documentation for test-kitchen-1.2.1\n1 gem installed\n\n\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u7528\u306e\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092\u4f5c\u6210\u3002\n$ mkdir foobar && cd foobar\n\nGemfile\u3092\u4f5c\u6210\u3057\u3066\u5fc5\u8981\u306a\u30e9\u30a4\u30d6\u30e9\u30ea\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\n\nGemfile\nsource \"https://rubygems.org\"\n\ngem 'test-kitchen', '~> 1.2.1'\ngem 'kitchen-ansible', '~> 0.0.2'\ngem 'kitchen-docker', '~> 1.5.0'\n\ngroup :integration do\n  gem 'serverspec', '~> 2.3.1'\n  gem 'specinfra', '~> 2.4.4'\nend\n\n\n$ bundle install\nFetching gem metadata from https://rubygems.org/..........\nResolving dependencies...\nUsing diff-lcs (1.2.5)\nUsing kitchen-ansible (0.0.2)\nInstalling mixlib-shellout (1.6.0)\nUsing net-ssh (2.9.1)\nUsing net-scp (1.2.1)\nUsing safe_yaml (1.0.4)\nUsing thor (0.19.1)\nUsing test-kitchen (1.2.1)\nUsing kitchen-docker (1.5.0)\nUsing multi_json (1.10.1)\nUsing rspec-support (3.1.2)\nUsing rspec-core (3.1.7)\nUsing rspec-expectations (3.1.2)\nUsing rspec-mocks (3.1.3)\nUsing rspec (3.1.0)\nUsing rspec-its (1.1.0)\nUsing specinfra (2.4.4)\nUsing serverspec (2.3.1)\nUsing bundler (1.3.5)\nYour bundle is complete!\nUse `bundle show [gemname]` to see where a bundled gem is installed.\n\n\ntest-kitchen\u306e\u8a2d\u5b9a\n\u307e\u305a\u306ftest-kitchen\u306e\u521d\u671f\u5316\u3092\u884c\u3044\u307e\u3059\u3002-D\u30aa\u30d7\u30b7\u30e7\u30f3\u3067\u4f7f\u7528\u3059\u308b\u30c9\u30e9\u30a4\u30d0\u30fc\u3092\u3001-P\u30aa\u30d7\u30b7\u30e7\u30f3\u3067\u4f7f\u7528\u3059\u308b\u30d7\u30ed\u30d3\u30b8\u30e7\u30ca\u30fc\u3092\u6307\u5b9a\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\u4eca\u56de\u306f\u30c9\u30e9\u30a4\u30d0\u306bDocker\u3092\u3001\u30d7\u30ed\u30d3\u30b8\u30e7\u30ca\u30fc\u306b\u306fansible_playbook\u3092\u4f7f\u7528\u3057\u307e\u3059\u3002\n$ bundle exec kitchen init -D docker -P ansible_playbook\n      create  .kitchen.yml\n      create  test/integration/default\n      append  Gemfile\nYou must run `bundle install' to fetch any new gems.\n\nkitchen init \u3067\u4f5c\u6210\u3055\u308c\u305f.kitchen.yml\u306f\u4ee5\u4e0b\u306e\u901a\u308a\u3002\n\n.kitchen.yml\n---\ndriver:\n  name: docker\n\nprovisioner:\n  name: ansible_playbook\n\nplatforms:\n  - name: ubuntu-12.04\n  - name: centos-6.4\n\nsuites:\n  - name: default\n    run_list:\n    attributes:\n\n\n\u3053\u308c\u3092\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u5909\u66f4\u3057\u307e\u3059\u3002driver_config\u306esocket\u306fDocker\u306e\u63a5\u7d9a\u5148\u3067\u3059\u3002\n\n.kitchen.yml\n---\ndriver:\n  name: docker\n\nprovisioner:\n  name: ansible_playbook\n  hosts: foobar\n  roles_path: roles\n  require_ansible_repo: true\n\nplatforms:\n  - name: ubuntu-12.04\n    driver_config:\n      image: ubuntu:12.04\n      socket: tcp://localhost:4242\n\nsuites:\n  - name: default\n\n\n\nAnsible\u306e\u30b3\u30fc\u30c9\u3092\u4f5c\u6210\u3059\u308b\n\u4eca\u56de\u306fAnsible\u3067apache\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\u3053\u3068\u306b\u3057\u307e\u3059\u3002\n$ mkdir -p roles/foo/tasks\n\n\nroles/foo/tasks/main.yml\n- apt: pkg=apache2\n\n\nsite.yml\u30d5\u30a1\u30a4\u30eb\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n\nsite.yml\n- hosts: foobar\n  roles:\n    - foo\n\n\n\nServerSpec\u306e\u8a2d\u5b9a\u3092\u3059\u308b\nServerspec\u3067\u4f7f\u7528\u3059\u308b\u30d5\u30a1\u30a4\u30eb\u3092\u8ffd\u52a0\u3057\u307e\u3059\u3002\nspec\u3068\u3044\u3046\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u4ee5\u4e0b\u306b\u4f5c\u6210\u3055\u308c\u308b\u306e\u3067\u3001\u3053\u306e\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092serverspec\u306b\u30ea\u30cd\u30fc\u30e0\u3057\u307e\u3059\u3002\n$ cd test/integration/default\n$ serverspec-init\nSelect OS type:\n\n  1) UN*X\n  2) Windows\n\nSelect number: 1\n\nSelect a backend type:\n\n  1) SSH\n  2) Exec (local)\n\nSelect number: 2\n\n + spec/\n + spec/localhost/\n + spec/localhost/sample_spec.rb\n + spec/spec_helper.rb\n + Rakefile\n + .rspec\n$ mv spec serverspec\n\n\u521d\u671f\u72b6\u614b\u3067\u306fapache\u306e\u30c6\u30b9\u30c8\u304c\u66f8\u304b\u308c\u3066\u3044\u307e\u3059\u3002\nAnsible\u3067apache\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\u3088\u3046\u306b\u3057\u3066\u3044\u308b\u305f\u3081\u3001\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u3066\u3044\u308b\u304b\u3069\u3046\u304b\u306e\u30c6\u30b9\u30c8\u306f\u901a\u308b\u306f\u305a\u3067\u3059\u3002\n\ntest/integration/default/serverspec/localhost/sample_spec.rb\nrequire 'spec_helper'\n\ndescribe package('httpd'), :if => os[:family] == 'redhat' do\n  it { should be_installed }\nend\n\ndescribe package('apache2'), :if => os[:family] == 'ubuntu' do\n  it { should be_installed }\nend\n\ndescribe service('httpd'), :if => os[:family] == 'redhat' do\n  it { should be_enabled }\n  it { should be_running }\nend\n\ndescribe service('apache2'), :if => os[:family] == 'ubuntu' do\n  it { should be_enabled }\n  it { should be_running }\nend\n\ndescribe service('org.apache.httpd'), :if => os[:family] == 'darwin' do\n  it { should be_enabled }\n  it { should be_running }\nend\n\ndescribe port(80) do\n  it { should be_listening }\nend\n\n\n\n\u30c6\u30b9\u30c8\u306e\u5b9f\u884c\n\n\u30c6\u30b9\u30c8\u7528\u306e\u74b0\u5883\u3092\u4f5c\u6210\u3059\u308b\n\u307e\u305a\u3001\u30c7\u30b9\u30c8\u3067\u4f7f\u7528\u3059\u308b\u305f\u3081\u306eDocker\u30b3\u30f3\u30c6\u30ca\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\u306a\u305c\u304b\u3001\u5b9f\u884c\u6642\u306bDocker\u306eUsage\u304c\u51fa\u529b\u3055\u308c\u3066\u3044\u305f\u306e\u3067\u3053\u306e\u8a18\u4e8b\u3067\u306f\u305d\u306e\u7b87\u6240\u3092\u524a\u9664\u3057\u3066\u3044\u307e\u3059\u3002\n $ kitchen create\n-----> Starting Kitchen (v1.2.1)\n-----> Creating <default-ubuntu-1204>...\n       Sending build context to Docker daemon 2.048 kB\n       Sending build context to Docker daemon\n       Step 0 : FROM ubuntu:12.04\n        ---> 0b310e6bf058\n       Step 1 : RUN dpkg-divert --local --rename --add /sbin/initctl\n        ---> Using cache\n        ---> 76685424c7fa\n       Step 2 : RUN ln -sf /bin/true /sbin/initctl\n        ---> Using cache\n        ---> 83c6a5f1d537\n       Step 3 : ENV DEBIAN_FRONTEND noninteractive\n        ---> Using cache\n        ---> 5bfc7d3c21f2\n       Step 4 : RUN apt-get update\n        ---> Using cache\n        ---> 43896feefd33\n       Step 5 : RUN apt-get install -y sudo openssh-server curl lsb-release\n        ---> Using cache\n        ---> 208d8a4f2538\n       Step 6 : RUN useradd -d /home/kitchen -m -s /bin/bash kitchen\n        ---> Using cache\n        ---> 3bd9c4c07cbb\n       Step 7 : RUN echo kitchen:kitchen | chpasswd\n        ---> Using cache\n        ---> f2d079722c7f\n       Step 8 : RUN echo 'kitchen ALL=(ALL) NOPASSWD:ALL' >> /etc/sudoers\n        ---> Using cache\n        ---> 900ee3f2a87d\n       Successfully built 900ee3f2a87d\n       234361d227b0a7093ac561c48ff087e4d6b26db0a63bdcdcd4827756a01c7747\n       [{\n           \"Args\": [\n        \"-D\",\n        \"-o\",\n        \"UseDNS=no\",\n        \"-o\",\n        \"UsePAM=no\",\n        \"-o\",\n        \"UsePrivilegeSeparation=no\",\n        \"-o\",\n        \"PidFile=/tmp/sshd.pid\"\n           ],\n           \"Config\": {\n        \"AttachStderr\": false,\n        \"AttachStdin\": false,\n        \"AttachStdout\": false,\n        \"Cmd\": [\n            \"/usr/sbin/sshd\",\n            \"-D\",\n            \"-o\",\n            \"UseDNS=no\",\n            \"-o\",\n            \"UsePAM=no\",\n            \"-o\",\n            \"UsePrivilegeSeparation=no\",\n            \"-o\",\n            \"PidFile=/tmp/sshd.pid\"\n        ],\n        \"CpuShares\": 0,\n        \"Cpuset\": \"\",\n        \"Domainname\": \"\",\n        \"Entrypoint\": null,\n        \"Env\": [\n            \"PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\",\n            \"DEBIAN_FRONTEND=noninteractive\"\n        ],\n        \"ExposedPorts\": {\n            \"22/tcp\": {}\n        },\n        \"Hostname\": \"234361d227b0\",\n        \"Image\": \"900ee3f2a87d\",\n        \"Memory\": 0,\n        \"MemorySwap\": 0,\n        \"NetworkDisabled\": false,\n        \"OnBuild\": null,\n        \"OpenStdin\": false,\n        \"PortSpecs\": null,\n        \"SecurityOpt\": null,\n        \"StdinOnce\": false,\n        \"Tty\": false,\n        \"User\": \"\",\n        \"Volumes\": null,\n        \"WorkingDir\": \"\"\n           },\n           \"Created\": \"2014-11-18T05:59:28.90033457Z\",\n           \"Driver\": \"aufs\",\n           \"ExecDriver\": \"native-0.2\",\n           \"HostConfig\": {\n        \"Binds\": null,\n        \"CapAdd\": null,\n        \"CapDrop\": null,\n        \"ContainerIDFile\": \"\",\n        \"Devices\": [],\n        \"Dns\": null,\n        \"DnsSearch\": null,\n        \"ExtraHosts\": null,\n        \"Links\": null,\n        \"LxcConf\": [],\n        \"NetworkMode\": \"bridge\",\n        \"PortBindings\": {\n            \"22/tcp\": [\n                {\n                    \"HostIp\": \"\",\n                    \"HostPort\": \"\"\n                }\n            ]\n        },\n        \"Privileged\": false,\n        \"PublishAllPorts\": false,\n        \"RestartPolicy\": {\n            \"MaximumRetryCount\": 0,\n            \"Name\": \"\"\n        },\n        \"VolumesFrom\": null\n           },\n           \"HostnamePath\": \"/mnt/VirtualBox/docker/containers/234361d227b0a7093ac561c48ff087e4d6b26db0a63bdcdcd4827756a01c7747/hostname\",\n           \"HostsPath\": \"/mnt/VirtualBox/docker/containers/234361d227b0a7093ac561c48ff087e4d6b26db0a63bdcdcd4827756a01c7747/hosts\",\n           \"Id\": \"234361d227b0a7093ac561c48ff087e4d6b26db0a63bdcdcd4827756a01c7747\",\n           \"Image\": \"900ee3f2a87d35843bbb34009c2f972e99c99449e02639d7fec43e5c04a7d66e\",\n           \"MountLabel\": \"\",\n           \"Name\": \"/grave_euclid\",\n           \"NetworkSettings\": {\n        \"Bridge\": \"docker0\",\n        \"Gateway\": \"172.17.42.1\",\n        \"IPAddress\": \"172.17.0.44\",\n        \"IPPrefixLen\": 16,\n        \"MacAddress\": \"02:42:ac:11:00:2c\",\n        \"PortMapping\": null,\n        \"Ports\": {\n            \"22/tcp\": [\n                {\n                    \"HostIp\": \"0.0.0.0\",\n                    \"HostPort\": \"49169\"\n                }\n            ]\n        }\n           },\n           \"Path\": \"/usr/sbin/sshd\",\n           \"ProcessLabel\": \"\",\n           \"ResolvConfPath\": \"/mnt/VirtualBox/docker/containers/234361d227b0a7093ac561c48ff087e4d6b26db0a63bdcdcd4827756a01c7747/resolv.conf\",\n           \"State\": {\n        \"ExitCode\": 0,\n        \"FinishedAt\": \"0001-01-01T00:00:00Z\",\n        \"Paused\": false,\n        \"Pid\": 26746,\n        \"Restarting\": false,\n        \"Running\": true,\n        \"StartedAt\": \"2014-11-18T05:59:29.001133273Z\"\n           },\n           \"Volumes\": {},\n           \"VolumesRW\": {}\n       }\n       ]\n       Finished creating <default-ubuntu-1204> (0m0.41s).\n-----> Kitchen is finished. (0m0.45s)\n\n\u4f5c\u6210\u3057\u305f\u74b0\u5883\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\u6700\u5f8c\u306e\u30a2\u30af\u30b7\u30e7\u30f3\u304c\u300cCreated\u300d\u3068\u306a\u3063\u3066\u3044\u308b\u3053\u3068\u304c\u308f\u304b\u308a\u307e\u3059\u3002\n$ kitchen list\nInstance             Driver  Provisioner      Last Action\ndefault-ubuntu-1204  Docker  AnsiblePlaybook  Created\n\n\nAnsible\u306e\u30b3\u30fc\u30c9\u3092\u5b9f\u884c\u3059\u308b\n$ kitchen converge\n-----> Starting Kitchen (v1.2.1)\n-----> Converging <default-ubuntu-1204>...\n       Preparing files for transfer\n       Preparing playbook\n       Preparing modules\n       nothing to do for modules\n       Preparing roles\n       Preparing ansible.cfg file\n       Preparing group_vars\n       nothing to do for group_vars\n       Preparing host_vars\n       nothing to do for host_vars\n       Preparing hosts file\n       Finished Preparing files for transfer\n       Installing ansible, will try to determine platform os\nReading package lists... Done\nBuilding dependency tree\nReading state information... 1%\nReading state information... Done\n       The following extra packages will be installed:\n         libapt-inst1.4 libapt-pkg4.12\n       The following NEW packages will be installed:\n         apt-utils libapt-inst1.4\n       The following packages will be upgraded:\n         libapt-pkg4.12\n       1 upgraded, 2 newly installed, 0 to remove and 1 not upgraded.\n       Need to get 1229 kB of archives.\n       After this operation, 1407 kB of additional disk space will be used.\nGet:1 http://archive.ubuntu.com/ubuntu/ precise-updates/main libapt-pkg4.12 amd64 0.8.16~exp12ubuntu10.22 [936 kB]\n1% [1 libapt-pkg4.12 14.2 kB/936 kB 2%]\nGet:2 http://archive.ubuntu.com/ubuntu/ precise-updates/main libapt-inst1.4 amd64 0.8.16~exp12ubuntu10.22 [102 kB]\n78% [2 libapt-inst1.4 20.6 kB/102 kB 20%]\nGet:3 http://archive.ubuntu.com/ubuntu/ precise-updates/main apt-utils amd64 0.8.16~exp12ubuntu10.22 [191 kB]\n85% [3 apt-utils 9521 B/191 kB 5%]\nFetched 1229 kB in 5s (241 kB/s)\n       debconf: delaying package configuration, since apt-utils is not installed\n(Reading database ... 9171 files and directories currently installed.)\n       Preparing to replace libapt-pkg4.12 0.8.16~exp12ubuntu10.21 (using .../libapt-pkg4.12_0.8.16~exp12ubuntu10.22_amd64.deb) ...\n       Unpacking replacement libapt-pkg4.12 ...\n       Setting up libapt-pkg4.12 (0.8.16~exp12ubuntu10.22) ...\n       Processing triggers for libc-bin ...\n       ldconfig deferred processing now taking place\n       Selecting previously unselected package libapt-inst1.4.\n       (Reading database ...\n(Reading database ... 9171 files and directories currently installed.)\n       Unpacking libapt-inst1.4 (from .../libapt-inst1.4_0.8.16~exp12ubuntu10.22_amd64.deb) ...\n       Selecting previously unselected package apt-utils.\n       Unpacking apt-utils (from .../apt-utils_0.8.16~exp12ubuntu10.22_amd64.deb) ...\n       Setting up libapt-inst1.4 (0.8.16~exp12ubuntu10.22) ...\n       Setting up apt-utils (0.8.16~exp12ubuntu10.22) ...\n       Processing triggers for libc-bin ...\n       ldconfig deferred processing now taking place\nReading package lists... Done\nBuilding dependency tree\nReading state information... 0%\nReading state information... Done\n       The following extra packages will be installed:\n         gir1.2-glib-2.0 libdbus-glib-1-2 libgirepository-1.0-1 python-dbus\n         python-dbus-dev python-gi\n       Suggested packages:\n         python-dbus-doc python-dbus-dbg python-gi-cairo\n       The following NEW packages will be installed:\n         gir1.2-glib-2.0 libdbus-glib-1-2 libgirepository-1.0-1 python-dbus\n         python-dbus-dev python-gi software-properties-common\n       0 upgraded, 7 newly installed, 0 to remove and 1 not upgraded.\n       Need to get 669 kB of archives.\n       After this operation, 2578 kB of additional disk space will be used.\nGet:1 http://archive.ubuntu.com/ubuntu/ precise-updates/main libdbus-glib-1-2 amd64 0.98-1ubuntu1.1 [73.6 kB]\nGet:2 http://archive.ubuntu.com/ubuntu/ precise/main libgirepository-1.0-1 amd64 1.32.0-1 [101 kB]\nGet:3 http://archive.ubuntu.com/ubuntu/ precise/main gir1.2-glib-2.0 amd64 1.32.0-1 [157 kB]\n28% [3 gir1.2-glib-2.0 13.0 kB/157 kB 8%]\nGet:4 http://archive.ubuntu.com/ubuntu/ precise/main python-dbus-dev all 1.0.0-1ubuntu1 [5556 B]\n50% [4 python-dbus-dev 5556 B/5556 B 100%]\nGet:5 http://archive.ubuntu.com/ubuntu/ precise/main python-dbus amd64 1.0.0-1ubuntu1 [102 kB]\n52% [5 python-dbus 9189 B/102 kB 9%]\nGet:6 http://archive.ubuntu.com/ubuntu/ precise-updates/main python-gi amd64 3.2.2-1~precise [222 kB]\n67% [6 python-gi 7871 B/222 kB 4%]\nGet:7 http://archive.ubuntu.com/ubuntu/ precise-updates/main software-properties-common all 0.82.7.7 [8450 B]\n100% [7 software-properties-common 8450 B/8450 B 100%]\nFetched 669 kB in 4s (157 kB/s)\n       Selecting previously unselected package libdbus-glib-1-2.\n       (Reading database ...\n(Reading database ... 9252 files and directories currently installed.)\n       Unpacking libdbus-glib-1-2 (from .../libdbus-glib-1-2_0.98-1ubuntu1.1_amd64.deb) ...\n       Selecting previously unselected package libgirepository-1.0-1.\n       Unpacking libgirepository-1.0-1 (from .../libgirepository-1.0-1_1.32.0-1_amd64.deb) ...\n       Selecting previously unselected package gir1.2-glib-2.0.\n       Unpacking gir1.2-glib-2.0 (from .../gir1.2-glib-2.0_1.32.0-1_amd64.deb) ...\n       Selecting previously unselected package python-dbus-dev.\n       Unpacking python-dbus-dev (from .../python-dbus-dev_1.0.0-1ubuntu1_all.deb) ...\n       Selecting previously unselected package python-dbus.\n       Unpacking python-dbus (from .../python-dbus_1.0.0-1ubuntu1_amd64.deb) ...\n       Selecting previously unselected package python-gi.\n       Unpacking python-gi (from .../python-gi_3.2.2-1~precise_amd64.deb) ...\n       Selecting previously unselected package software-properties-common.\n       Unpacking software-properties-common (from .../software-properties-common_0.82.7.7_all.deb) ...\n       Setting up libdbus-glib-1-2 (0.98-1ubuntu1.1) ...\n       Setting up libgirepository-1.0-1 (1.32.0-1) ...\n       Setting up gir1.2-glib-2.0 (1.32.0-1) ...\n       Setting up python-dbus-dev (1.0.0-1ubuntu1) ...\n       Setting up python-dbus (1.0.0-1ubuntu1) ...\n       Remove stale byte-compiled files...\n       Setting up python-gi (3.2.2-1~precise) ...\n       Setting up software-properties-common (0.82.7.7) ...\n       Processing triggers for libc-bin ...\n       ldconfig deferred processing now taking place\nReading package lists... Done\nBuilding dependency tree\nReading state information... 0%\nReading state information... Done\n       The following extra packages will be installed:\n         iso-codes libcurl3-gnutls python-apt python-apt-common python-gnupginterface\n         python-pycurl ucf unattended-upgrades xz-lzma\n       Suggested packages:\n         isoquery python-apt-dbg python-gtk2 python-vte python-apt-doc\n         libcurl4-gnutls-dev python-pycurl-dbg bsd-mailx\n       The following NEW packages will be installed:\n         iso-codes libcurl3-gnutls python-apt python-apt-common python-gnupginterface\n         python-pycurl python-software-properties ucf unattended-upgrades xz-lzma\n       0 upgraded, 10 newly installed, 0 to remove and 1 not upgraded.\n       Need to get 4167 kB of archives.\n       After this operation, 16.1 MB of additional disk space will be used.\nGet:1 http://archive.ubuntu.com/ubuntu/ precise-updates/main libcurl3-gnutls amd64 7.22.0-3ubuntu4.11 [227 kB]\n0% [1 libcurl3-gnutls 14.2 kB/227 kB 6%]\nGet:2 http://archive.ubuntu.com/ubuntu/ precise/main ucf all 3.0025+nmu2ubuntu1 [54.4 kB]\n6% [2 ucf 16.4 kB/54.4 kB 30%]\nGet:3 http://archive.ubuntu.com/ubuntu/ precise/main iso-codes all 3.31-1 [3547 kB]\n8% [3 iso-codes 45.1 kB/3547 kB 1%]\nGet:4 http://archive.ubuntu.com/ubuntu/ precise-updates/main python-apt-common all 0.8.3ubuntu7.2 [22.2 kB]\n92% [4 python-apt-common 8840 B/22.2 kB 40%]\nGet:5 http://archive.ubuntu.com/ubuntu/ precise-updates/main python-apt amd64 0.8.3ubuntu7.2 [187 kB]\n93% [5 python-apt 12.4 kB/187 kB 7%]\nGet:6 http://archive.ubuntu.com/ubuntu/ precise/main python-gnupginterface all 0.3.2-9.1ubuntu3 [19.2 kB]\n97% [6 python-gnupginterface 18.9 kB/19.2 kB 98%]\nGet:7 http://archive.ubuntu.com/ubuntu/ precise/main xz-lzma all 5.1.1alpha+20110809-3 [12.4 kB]\n97% [7 xz-lzma 4000 B/12.4 kB 32%]\nGet:8 http://archive.ubuntu.com/ubuntu/ precise-updates/main unattended-upgrades all 0.76ubuntu1 [24.7 kB]\n98% [8 unattended-upgrades 12.7 kB/24.7 kB 52%]\nGet:9 http://archive.ubuntu.com/ubuntu/ precise/main python-pycurl amd64 7.19.0-4ubuntu3 [49.2 kB]\n98% [9 python-pycurl 5139 B/49.2 kB 10%]\nGet:10 http://archive.ubuntu.com/ubuntu/ precise-updates/main python-software-properties all 0.82.7.7 [23.5 kB]\n100% [10 python-software-properties 10.7 kB/23.5 kB 46%]\nFetched 4167 kB in 3s (1302 kB/s)\n       Preconfiguring packages ...\n       Selecting previously unselected package libcurl3-gnutls.\n(Reading database ... 30%...\n(Reading database ... 9428 files and directories currently installed.)\n       Unpacking libcurl3-gnutls (from .../libcurl3-gnutls_7.22.0-3ubuntu4.11_amd64.deb) ...\n       Selecting previously unselected package ucf.\n       Unpacking ucf (from .../ucf_3.0025+nmu2ubuntu1_all.deb) ...\n       Moving old data out of the way\nSelecting previously unselected package iso-codes.\nUnpacking iso-codes (from .../iso-codes_3.31-1_all.deb) ...\n       Selecting previously unselected package python-apt-common.\n       Unpacking python-apt-common (from .../python-apt-common_0.8.3ubuntu7.2_all.deb) ...\n       Selecting previously unselected package python-apt.\n       Unpacking python-apt (from .../python-apt_0.8.3ubuntu7.2_amd64.deb) ...\n       Selecting previously unselected package python-gnupginterface.\n       Unpacking python-gnupginterface (from .../python-gnupginterface_0.3.2-9.1ubuntu3_all.deb) ...\n       Selecting previously unselected package xz-lzma.\n       Unpacking xz-lzma (from .../xz-lzma_5.1.1alpha+20110809-3_all.deb) ...\n       Selecting previously unselected package unattended-upgrades.\n       Unpacking unattended-upgrades (from .../unattended-upgrades_0.76ubuntu1_all.deb) ...\n       Selecting previously unselected package python-pycurl.\n       Unpacking python-pycurl (from .../python-pycurl_7.19.0-4ubuntu3_amd64.deb) ...\n       Selecting previously unselected package python-software-properties.\n       Unpacking python-software-properties (from .../python-software-properties_0.82.7.7_all.deb) ...\n       Setting up libcurl3-gnutls (7.22.0-3ubuntu4.11) ...\n       Setting up ucf (3.0025+nmu2ubuntu1) ...\n       Setting up iso-codes (3.31-1) ...\n       Setting up python-apt-common (0.8.3ubuntu7.2) ...\n       Setting up python-apt (0.8.3ubuntu7.2) ...\n       Setting up python-gnupginterface (0.3.2-9.1ubuntu3) ...\n       Setting up xz-lzma (5.1.1alpha+20110809-3) ...\n       Setting up unattended-upgrades (0.76ubuntu1) ...\n       Setting up python-pycurl (7.19.0-4ubuntu3) ...\n       Setting up python-software-properties (0.82.7.7) ...\n       Processing triggers for libc-bin ...\n       ldconfig deferred processing now taking place\n       gpg: keyring `/tmp/tmp7ofJgJ/secring.gpg' created\n       gpg: keyring `/tmp/tmp7ofJgJ/pubring.gpg' created\n       gpg: requesting key 5504681D from hkp server keyserver.ubuntu.com\n       gpg: /tmp/tmp7ofJgJ/trustdb.gpg: trustdb created\n       gpg: key 5504681D: public key \"Launchpad PPA for Rodney Quillo\" imported\n       gpg: Total number processed: 1\n       gpg:               imported: 1  (RSA: 1)\n       OK\nHit http://archive.ubuntu.com precise Release.gpg\nGet:1 http://archive.ubuntu.com precise-updates Release.gpg [198 B]\n98% [1 Release.gpg 198 B/198 B 100%] [Waiting for headers]\nGet:2 http://archive.ubuntu.com precise-security Release.gpg [198 B]\n99% [Waiting for headers]\nHit http://archive.ubuntu.com precise-proposed Release.gpg\n99% [Waiting for headers]\nHit http://archive.ubuntu.com precise Release\nGet:3 http://archive.ubuntu.com precise-updates Release [194 kB]\n7% [3 Release 12.7 kB/194 kB 7%] [Waiting for headers]\nGet:4 http://ppa.launchpad.net precise Release.gpg [316 B]\nGet:5 http://ppa.launchpad.net precise Release [11.9 kB]\n20% [3 Release 28.6 kB/194 kB 15%] [5 Release 11.9 kB/11.9 kB 100%]\nGet:6 http://ppa.launchpad.net precise/main Sources [560 B]\nGet:7 http://ppa.launchpad.net precise/main amd64 Packages [549 B]\n50% [3 Release 90.9 kB/194 kB 47%] [Waiting for headers]\nGet:8 http://ppa.launchpad.net precise/main i386 Packages [549 B]\n50% [3 Release 90.9 kB/194 kB 47%]\nGet:9 http://archive.ubuntu.com precise-security Release [53.0 kB]\n88% [9 Release 20.8 kB/53.0 kB 39%]\nHit http://archive.ubuntu.com precise-proposed Release\n100% [Waiting for headers]\nHit http://archive.ubuntu.com precise/main Sources\n100% [9 Release gpgv 53.0 kB]\nHit http://archive.ubuntu.com precise/restricted Sources\nHit http://archive.ubuntu.com precise/universe Sources\nHit http://archive.ubuntu.com precise/main amd64 Packages\nHit http://archive.ubuntu.com precise/restricted amd64 Packages\n100% [9 Release gpgv 53.0 kB] [Waiting for headers]\nHit http://archive.ubuntu.com precise/universe amd64 Packages\nHit http://archive.ubuntu.com precise/main i386 Packages\nHit http://archive.ubuntu.com precise/restricted i386 Packages\n100% [Sources 1175 kB] [Waiting for headers]\nHit http://archive.ubuntu.com precise/universe i386 Packages\nGet:10 http://archive.ubuntu.com precise-updates/main Sources [588 kB]\nGet:11 http://archive.ubuntu.com precise-updates/restricted Sources [8241 B]\n100% [Packages 6180 kB] [11 Sources 8241 B/8241 B 100%]\nGet:12 http://archive.ubuntu.com precise-updates/universe Sources [136 kB]\nGet:13 http://archive.ubuntu.com precise-updates/main amd64 Packages [1091 kB]\n94% [Packages 6180 kB] [13 Packages 23.4 kB/1091 kB 2%]\nGet:14 http://archive.ubuntu.com precise-updates/restricted amd64 Packages [16.1 kB]\nGet:15 http://archive.ubuntu.com precise-updates/universe amd64 Packages [321 kB]\n99% [13 Packages 1091 kB] [15 Packages 81.5 kB/321 kB 25%]\nGet:16 http://archive.ubuntu.com precise-updates/main i386 Packages [1134 kB]\nGet:17 http://archive.ubuntu.com precise-updates/restricted i386 Packages [16.0 kB]\n100% [17 Packages 16.0 kB/16.0 kB 100%]\nGet:18 http://archive.ubuntu.com precise-updates/universe i386 Packages [330 kB]\n99% [16 Packages 1134 kB] [18 Packages 32.0 kB/330 kB 10%]\nGet:19 http://archive.ubuntu.com precise-security/main Sources [144 kB]\n100% [19 Sources 32.3 kB/144 kB 22%]                               4410 kB/s 0s\nGet:20 http://archive.ubuntu.com precise-security/restricted Sources [2258 B]\nGet:21 http://archive.ubuntu.com precise-security/universe Sources [37.9 kB]\nGet:22 http://archive.ubuntu.com precise-security/main amd64 Packages [565 kB]\n98% [18 Packages 330 kB] [22 Packages 35.1 kB/565 kB 6%]           4410 kB/s 0s\nGet:23 http://archive.ubuntu.com precise-security/restricted amd64 Packages [5282 B]\nGet:24 http://archive.ubuntu.com precise-security/universe amd64 Packages [129 kB]\nGet:25 http://archive.ubuntu.com precise-security/main i386 Packages [607 kB]\n98% [22 Packages 565 kB] [25 Packages 4096 B/607 kB 1%]            4410 kB/s 0s\nGet:26 http://archive.ubuntu.com precise-security/restricted i386 Packages [5273 B]\nGet:27 http://archive.ubuntu.com precise-security/universe i386 Packages [136 kB]\n100% [25 Packages 607 kB] [27 Packages 8192 B/136 kB 6%]           4410 kB/s 0s\nHit http://archive.ubuntu.com precise-proposed/main amd64 Packages\nHit http://archive.ubuntu.com precise-proposed/restricted amd64 Packages\nHit http://archive.ubuntu.com precise-proposed/main i386 Packages\nHit http://archive.ubuntu.com precise-proposed/restricted i386 Packages\n100% [25 Packages 607 kB]                                          4410 kB/s 0s\nFetched 5534 kB in 6s (817 kB/s)\nReading package lists... Done\n        package lists... Done\nBuilding dependency tree\nReading state information... 0%\nReading state information... Done\n       The following extra packages will be installed:\n         libgmp10 libyaml-0-2 python-crypto python-httplib2 python-jinja2\n         python-markupsafe python-paramiko python-pkg-resources python-setuptools\n         python-support python-yaml sshpass\n       Suggested packages:\n         python-crypto-dbg python-crypto-doc python-jinja2-doc python-distribute\n         python-distribute-doc\n       The following NEW packages will be installed:\n         ansible libgmp10 libyaml-0-2 python-crypto python-httplib2 python-jinja2\n         python-markupsafe python-paramiko python-pkg-resources python-setuptools\n         python-support python-yaml sshpass\n       0 upgraded, 13 newly installed, 0 to remove and 1 not upgraded.\n       Need to get 2974 kB of archives.\n       After this operation, 15.8 MB of additional disk space will be used.\nGet:1 http://ppa.launchpad.net/rquillo/ansible/ubuntu/ precise/main ansible all 1.7.1-precise-unstable-ppa [696 kB]\n0% [Waiting for headers] [1 ansible 14.2 kB/696 kB 2%]\nGet:2 http://archive.ubuntu.com/ubuntu/ precise/main libgmp10 amd64 2:5.0.2+dfsg-2ubuntu1 [238 kB]\n1% [2 libgmp10 14.2 kB/238 kB 6%] [1 ansible 14.2 kB/696 kB 2%]\nGet:3 http://archive.ubuntu.com/ubuntu/ precise-updates/main libyaml-0-2 amd64 0.1.4-2ubuntu0.12.04.3 [57.8 kB]\n15% [3 libyaml-0-2 8795 B/57.8 kB 15%] [1 ansible 188 kB/696 kB 27%]\nGet:4 http://archive.ubuntu.com/ubuntu/ precise/universe python-support all 1.0.14ubuntu2 [26.1 kB]\n18% [4 python-support 11.5 kB/26.1 kB 44%] [1 ansible 231 kB/696 kB 33%]\nGet:5 http://archive.ubuntu.com/ubuntu/ precise/main python-markupsafe amd64 0.15-1 [13.6 kB]\nGet:6 http://archive.ubuntu.com/ubuntu/ precise-updates/main python-jinja2 amd64 2.6-1ubuntu0.1 [158 kB]\nGet:7 http://archive.ubuntu.com/ubuntu/ precise/main python-yaml amd64 3.10-2 [122 kB]\n32% [7 python-yaml 28.3 kB/122 kB 23%] [1 ansible 424 kB/696 kB 61%]\nGet:8 http://archive.ubuntu.com/ubuntu/ precise-updates/main python-crypto amd64 2.4.1-1ubuntu0.1 [293 kB]\n38% [8 python-crypto 18.4 kB/293 kB 6%] [1 ansible 506 kB/696 kB 73%]\nGet:9 http://archive.ubuntu.com/ubuntu/ precise-updates/main python-paramiko all 1.7.7.1-2ubuntu1 [797 kB]\n54% [9 python-paramiko 8192 B/797 kB 1%]\nGet:10 http://archive.ubuntu.com/ubuntu/ precise-updates/main python-httplib2 all 0.7.2-1ubuntu2.1 [57.1 kB]\n81% [10 python-httplib2 12.7 kB/57.1 kB 22%]\nGet:11 http://archive.ubuntu.com/ubuntu/ precise/universe sshpass amd64 1.05-1 [10.5 kB]\n83% [11 sshpass 3053 B/10.5 kB 29%]\nGet:12 http://archive.ubuntu.com/ubuntu/ precise/main python-pkg-resources all 0.6.24-1ubuntu1 [63.1 kB]\n83% [12 python-pkg-resources 2369 B/63.1 kB 4%]\nGet:13 http://archive.ubuntu.com/ubuntu/ precise/main python-setuptools all 0.6.24-1ubuntu1 [441 kB]\n85% [13 python-setuptools 5567 B/441 kB 1%]\nFetched 2974 kB in 6s (481 kB/s)\n       Selecting previously unselected package libgmp10.\n       (Reading database ...\n(Reading database ... 10166 files and directories currently installed.)\n       Unpacking libgmp10 (from .../libgmp10_2%3a5.0.2+dfsg-2ubuntu1_amd64.deb) ...\n       Selecting previously unselected package libyaml-0-2.\n       Unpacking libyaml-0-2 (from .../libyaml-0-2_0.1.4-2ubuntu0.12.04.3_amd64.deb) ...\n       Selecting previously unselected package python-support.\n       Unpacking python-support (from .../python-support_1.0.14ubuntu2_all.deb) ...\n       Selecting previously unselected package python-markupsafe.\n       Unpacking python-markupsafe (from .../python-markupsafe_0.15-1_amd64.deb) ...\n       Selecting previously unselected package python-jinja2.\n       Unpacking python-jinja2 (from .../python-jinja2_2.6-1ubuntu0.1_amd64.deb) ...\n       Selecting previously unselected package python-yaml.\n       Unpacking python-yaml (from .../python-yaml_3.10-2_amd64.deb) ...\n       Selecting previously unselected package python-crypto.\n       Unpacking python-crypto (from .../python-crypto_2.4.1-1ubuntu0.1_amd64.deb) ...\n       Selecting previously unselected package python-paramiko.\n       Unpacking python-paramiko (from .../python-paramiko_1.7.7.1-2ubuntu1_all.deb) ...\n       Selecting previously unselected package python-httplib2.\n       Unpacking python-httplib2 (from .../python-httplib2_0.7.2-1ubuntu2.1_all.deb) ...\n       Selecting previously unselected package sshpass.\n       Unpacking sshpass (from .../sshpass_1.05-1_amd64.deb) ...\n       Selecting previously unselected package python-pkg-resources.\n       Unpacking python-pkg-resources (from .../python-pkg-resources_0.6.24-1ubuntu1_all.deb) ...\n       Selecting previously unselected package python-setuptools.\n       Unpacking python-setuptools (from .../python-setuptools_0.6.24-1ubuntu1_all.deb) ...\n       Selecting previously unselected package ansible.\n       Unpacking ansible (from .../ansible_1.7.1-precise-unstable-ppa_all.deb) ...\n       Setting up libgmp10 (2:5.0.2+dfsg-2ubuntu1) ...\n       Setting up libyaml-0-2 (0.1.4-2ubuntu0.12.04.3) ...\n       Setting up python-support (1.0.14ubuntu2) ...\n       Setting up python-markupsafe (0.15-1) ...\n       Setting up python-jinja2 (2.6-1ubuntu0.1) ...\n       Setting up python-yaml (3.10-2) ...\n       Setting up python-crypto (2.4.1-1ubuntu0.1) ...\n       Setting up python-paramiko (1.7.7.1-2ubuntu1) ...\n       Setting up python-httplib2 (0.7.2-1ubuntu2.1) ...\n       Setting up sshpass (1.05-1) ...\n       Setting up python-pkg-resources (0.6.24-1ubuntu1) ...\n       Setting up python-setuptools (0.6.24-1ubuntu1) ...\n       Setting up ansible (1.7.1-precise-unstable-ppa) ...\n       Processing triggers for libc-bin ...\n       ldconfig deferred processing now taking place\n       Processing triggers for python-support ...\n-----> Installing Chef Omnibus to install busser to run tests\n       downloading https://www.getchef.com/chef/install.sh\n         to file /tmp/install.sh\n\n       trying wget...\n       Downloading Chef  for ubuntu...\n       downloading https://www.getchef.com/chef/metadata?v=&prerelease=false&nightlies=false&p=ubuntu&pv=12.04&m=x86_64\n         to file /tmp/install.sh.649/metadata.txt\n       trying wget...\n       url      https://opscode-omnibus-packages.s3.amazonaws.com/ubuntu/12.04/x86_64/chef_11.16.4-1_amd64.deb\n       md5      2ffff5b4d80e4dcffc917f8eb2003a31\n       sha256   28b08975e7e33ac46c888616ec7fa232a0c624aeeda81e58a6047d2c6b62edfb\n       downloaded metadata file looks valid...\n       downloading https://opscode-omnibus-packages.s3.amazonaws.com/ubuntu/12.04/x86_64/chef_11.16.4-1_amd64.deb\n         to file /tmp/install.sh.649/chef_11.16.4-1_amd64.deb\n       trying wget...\n       Comparing checksum with sha256sum...\n       Installing Chef\n       installing with dpkg...\n       Selecting previously unselected package chef.\n(Reading database ... 25%...\n(Reading database ... 11500 files and directories currently installed.)\n       Unpacking chef (from .../chef_11.16.4-1_amd64.deb) ...\n       Setting up chef (11.16.4-1) ...\n       Thank you for installing Chef!\n       Transfering files to <default-ubuntu-1204>\n\n       PLAY [foobar] *****************************************************************\n\n       GATHERING FACTS ***************************************************************\n       ok: [localhost]\n\n       TASK: [foo | apt pkg=apache2] *************************************************\n       changed: [localhost]\n\n       PLAY RECAP ********************************************************************\n       localhost                  : ok=2    changed=1    unreachable=0    failed=0\n\n       Finished converging <default-ubuntu-1204> (2m20.92s).\n-----> Kitchen is finished. (2m20.96s)\n\n\n\u30c6\u30b9\u30c8\u3059\u308b\n$ kitchen verify\n-----> Starting Kitchen (v1.2.1)\n-----> Setting up <default-ubuntu-1204>...\nFetching: thor-0.19.0.gem (100%)\nFetching: busser-0.6.2.gem (100%)\n       Successfully installed thor-0.19.0\n       Successfully installed busser-0.6.2\n       2 gems installed\n-----> Setting up Busser\n       Creating BUSSER_ROOT in /tmp/busser\n       Creating busser binstub\n       Plugin serverspec installed (version 0.5.3)\n-----> Running postinstall for serverspec plugin\n       Finished setting up <default-ubuntu-1204> (0m46.47s).\n-----> Verifying <default-ubuntu-1204>...\n       Suite path directory /tmp/busser/suites does not exist, skipping.\n       Uploading /tmp/busser/suites/serverspec/spec_helper.rb (mode=0644)\n       Uploading /tmp/busser/suites/serverspec/localhost/sample_spec.rb (mode=0644)\n-----> Running serverspec test suite\n-----> Installing Serverspec..\nFetching: rspec-support-3.1.2.gem (100%)\nFetching: rspec-core-3.1.7.gem (100%)\nFetching: diff-lcs-1.2.5.gem (100%)\nFetching: rspec-expectations-3.1.2.gem (100%)\nFetching: rspec-mocks-3.1.3.gem (100%)\nFetching: rspec-3.1.0.gem (100%)\nFetching: rspec-its-1.1.0.gem (100%)\nFetching: multi_json-1.10.1.gem (100%)\nFetching: net-ssh-2.9.1.gem (100%)\nFetching: net-scp-1.2.1.gem (100%)\nFetching: specinfra-2.4.4.gem (100%)\nFetching: serverspec-2.3.1.gem (100%)\n-----> serverspec installed (version 2.3.1)\n       /opt/chef/embedded/bin/ruby -I/tmp/busser/suites/serverspec -I/tmp/busser/gems/gems/rspec-support-3.1.2/lib:/tmp/busser/gems/gems/rspec-core-3.1.7/lib /opt/chef/embedded/bin/rspec --pattern /tmp/busser/suites/serverspec/\\*\\*/\\*_spec.rb --color --format documentation --default-path /tmp/busser/suites/serverspec\n\n       Package \"apache2\"\n         should be installed\n\n       Service \"apache2\"\n         should be enabled\n         should be running (FAILED - 1)\n\n       Port \"80\"\n         should be listening (FAILED - 2)\n\n       Failures:\n\n         1) Service \"apache2\" should be running\n\n            Failure/Error: it { should be_running }\n              expected Service \"apache2\" to be running\n              /bin/sh -c service\\ apache2\\ status\\ \\&\\&\\ service\\ apache2\\ status\\ \\|\\ grep\\ \\'running\\'\n              Apache2 is NOT running.\n\n            # /tmp/busser/suites/serverspec/localhost/sample_spec.rb:18:in `block (2 levels) in <top (required)>'\n\n         2) Port \"80\" should be listening\n            Failure/Error: it { should be_listening }\n              expected Port \"80\" to be listening\n              /bin/sh -c netstat\\ -tunl\\ \\|\\ grep\\ --\\ :80\n              /bin/sh: 1: netstat: not found\n\n            # /tmp/busser/suites/serverspec/localhost/sample_spec.rb:27:in `block (2 levels) in <top (required)>'\n\n       Finished in 0.03473 seconds (files took 0.36989 seconds to load)\n       4 examples, 2 failures\n\n       Failed examples:\n\n       rspec /tmp/busser/suites/serverspec/localhost/sample_spec.rb:18 # Service \"apache2\" should be running\n       rspec /tmp/busser/suites/serverspec/localhost/sample_spec.rb:27 # Port \"80\" should be listening\n       /opt/chef/embedded/bin/ruby -I/tmp/busser/suites/serverspec -I/tmp/busser/gems/gems/rspec-support-3.1.2/lib:/tmp/busser/gems/gems/rspec-core-3.1.7/lib /opt/chef/embedded/bin/rspec --pattern /tmp/busser/suites/serverspec/\\*\\*/\\*_spec.rb --color --format documentation --default-path /tmp/busser/suites/serverspec failed\n       Ruby Script [/tmp/busser/gems/gems/busser-serverspec-0.5.3/lib/busser/runner_plugin/../serverspec/runner.rb /tmp/busser/suites/serverspec] exit code was 1\n>>>>>> Verify failed on instance <default-ubuntu-1204>.\n>>>>>> Please see .kitchen/logs/default-ubuntu-1204.log for more details\n>>>>>> ------Exception-------\n>>>>>> Class: Kitchen::ActionFailed\n>>>>>> Message: SSH exited (1) for command: [sh -c 'BUSSER_ROOT=\"/tmp/busser\" GEM_HOME=\"/tmp/busser/gems\" GEM_PATH=\"/tmp/busser/gems\" GEM_CACHE=\"/tmp/busser/gems/cache\" ; export BUSSER_ROOT GEM_HOME GEM_PATH GEM_CACHE; sudo -E /tmp/busser/bin/busser test']\n>>>>>> ----------------------\n\n4\u30c6\u30b9\u30c8\u4e2d2\u3064\u304c\u5931\u6557\u3057\u307e\u3057\u305f\u3002\n\n\u4fee\u6b63\u3057\u3066\u518d\u5ea6\u5b9f\u884c\u30fb\u30c6\u30b9\u30c8\n\u5931\u6557\u3057\u305f\u30c6\u30b9\u30c8\u304b\u3089\u3001\u4ee5\u4e0b\u306e\u4fee\u6b63\u3092\u52a0\u3048\u307e\u3059\u3002\u3002\n\n\u30b5\u30fc\u30d3\u30b9\u306e\u8a2d\u5b9a\u304c\u884c\u308f\u308c\u3066\u3044\u306a\u304b\u3063\u305f\u306e\u3067apache2\u306e\u30b5\u30fc\u30d3\u30b9\u3092\u8d77\u52d5\u3059\u308b\u3088\u3046\u306b\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n\u307e\u305f\u3001netstat\u304c\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u3066\u3044\u306a\u304b\u3063\u305f\u306e\u3067\u3001net-tools\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\n\n\nmain.yml\n- apt: pkg=apache2\n- service: name=apache2 state=started\n- apt: pkg=net-tools\n\n\n\u4fee\u6b63\u5f8c\u306fkitchen converge\u3067\u30c6\u30b9\u30c8\u3067\u304d\u307e\u3059\u3002\u4f5c\u6210\u6e08\u307f\u306e\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u3092\u4f7f\u7528\u3059\u308b\u305f\u3081\u3001\u5b9f\u884c\u304c\u65e9\u3044\u3067\u3059\u3002\n$ kitchen converge\n-----> Starting Kitchen (v1.2.1)\n-----> Converging <default-ubuntu-1204>...\n       Preparing files for transfer\n       Preparing playbook\n       Preparing modules\n       nothing to do for modules\n       Preparing roles\n       Preparing ansible.cfg file\n       Preparing group_vars\n       nothing to do for group_vars\n       Preparing host_vars\n       nothing to do for host_vars\n       Preparing hosts file\n       Finished Preparing files for transfer\n       Installing ansible, will try to determine platform os\n       Transfering files to <default-ubuntu-1204>\n\n       PLAY [foobar] *****************************************************************\n\n       GATHERING FACTS ***************************************************************\n       ok: [localhost]\n\n       TASK: [foo | apt pkg=apache2] *************************************************\n       ok: [localhost]\n\n       TASK: [foo | service name=apache2 state=started] ******************************\n       changed: [localhost]\n\n       TASK: [foo | apt pkg=net-tools] ***********************************************\n       changed: [localhost]\n\n       PLAY RECAP ********************************************************************\n       localhost                  : ok=4    changed=2    unreachable=0    failed=0\n\n       Finished converging <default-ubuntu-1204> (0m14.13s).\n-----> Kitchen is finished. (0m14.17s)\n\n\u5909\u66f4\u306b\u5bfe\u3057\u3066\u518d\u5ea6\u30c6\u30b9\u30c8\u3092\u5b9f\u884c\u3057\u307e\u3059\u3002\n$ kitchen verify\n-----> Starting Kitchen (v1.2.1)\n-----> Setting up <default-ubuntu-1204>...\n-----> Setting up Busser\n       Creating BUSSER_ROOT in /tmp/busser\n\n       Creating busser binstub\n       Plugin serverspec already installed\n       Finished setting up <default-ubuntu-1204> (0m6.15s).\n-----> Verifying <default-ubuntu-1204>...\n       Removing /tmp/busser/suites/serverspec\n       Uploading /tmp/busser/suites/serverspec/spec_helper.rb (mode=0644)\n       Uploading /tmp/busser/suites/serverspec/localhost/sample_spec.rb (mode=0644)\n-----> Running serverspec test suite\n       /opt/chef/embedded/bin/ruby -I/tmp/busser/suites/serverspec -I/tmp/busser/gems/gems/rspec-support-3.1.2/lib:/tmp/busser/gems/gems/rspec-core-3.1.7/lib /opt/chef/embedded/bin/rspec --pattern /tmp/busser/suites/serverspec/\\*\\*/\\*_spec.rb --color --format documentation --default-path /tmp/busser/suites/serverspec\n\n       Package \"apache2\"\n         should be installed\n\n       Service \"apache2\"\n         should be enabled\n         should be running\n\n       Port \"80\"\n         should be listening\n\n       Finished in 0.04397 seconds (files took 0.37108 seconds to load)\n       4 examples, 0 failures\n       Finished verifying <default-ubuntu-1204> (0m1.69s).\n-----> Kitchen is finished. (0m7.90s)\n\n\u7121\u4e8b\u3001\u30c6\u30b9\u30c8\u304c\u5168\u3066\u901a\u308a\u307e\u3057\u305f\u3002\n\n\u5f8c\u7247\u4ed8\u3051\n\u30a4\u30f3\u30bf\u30f3\u30b9\u306f\u6b8b\u3063\u305f\u307e\u307e\u306a\u306e\u3067\u3001\u524a\u9664\u3057\u307e\u3059\u3002\n$ kitchen destroy\n-----> Starting Kitchen (v1.2.1)\n-----> Destroying <default-ubuntu-1204>...\n       [{\n           \"Args\": [\n        \"-D\",\n        \"-o\",\n        \"UseDNS=no\",\n        \"-o\",\n        \"UsePAM=no\",\n        \"-o\",\n        \"UsePrivilegeSeparation=no\",\n        \"-o\",\n        \"PidFile=/tmp/sshd.pid\"\n           ],\n           \"Config\": {\n        \"AttachStderr\": false,\n        \"AttachStdin\": false,\n        \"AttachStdout\": false,\n        \"Cmd\": [\n            \"/usr/sbin/sshd\",\n            \"-D\",\n            \"-o\",\n            \"UseDNS=no\",\n            \"-o\",\n            \"UsePAM=no\",\n            \"-o\",\n            \"UsePrivilegeSeparation=no\",\n            \"-o\",\n            \"PidFile=/tmp/sshd.pid\"\n        ],\n        \"CpuShares\": 0,\n        \"Cpuset\": \"\",\n        \"Domainname\": \"\",\n        \"Entrypoint\": null,\n        \"Env\": [\n            \"PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\",\n            \"DEBIAN_FRONTEND=noninteractive\"\n        ],\n        \"ExposedPorts\": {\n            \"22/tcp\": {}\n        },\n        \"Hostname\": \"db1821df6a63\",\n        \"Image\": \"900ee3f2a87d\",\n        \"Memory\": 0,\n        \"MemorySwap\": 0,\n        \"NetworkDisabled\": false,\n        \"OnBuild\": null,\n        \"OpenStdin\": false,\n        \"PortSpecs\": null,\n        \"SecurityOpt\": null,\n        \"StdinOnce\": false,\n        \"Tty\": false,\n        \"User\": \"\",\n        \"Volumes\": null,\n        \"WorkingDir\": \"\"\n           },\n           \"Created\": \"2014-11-18T06:18:38.815094709Z\",\n           \"Driver\": \"aufs\",\n           \"ExecDriver\": \"native-0.2\",\n           \"HostConfig\": {\n        \"Binds\": null,\n        \"CapAdd\": null,\n        \"CapDrop\": null,\n        \"ContainerIDFile\": \"\",\n        \"Devices\": [],\n        \"Dns\": null,\n        \"DnsSearch\": null,\n        \"ExtraHosts\": null,\n        \"Links\": null,\n        \"LxcConf\": [],\n        \"NetworkMode\": \"bridge\",\n        \"PortBindings\": {\n            \"22/tcp\": [\n                {\n                    \"HostIp\": \"\",\n                    \"HostPort\": \"\"\n                }\n            ]\n        },\n        \"Privileged\": false,\n        \"PublishAllPorts\": false,\n        \"RestartPolicy\": {\n            \"MaximumRetryCount\": 0,\n            \"Name\": \"\"\n        },\n        \"VolumesFrom\": null\n           },\n           \"HostnamePath\": \"/mnt/VirtualBox/docker/containers/db1821df6a638dfa99a7c286eb8893f9be6a3a48c41d272ed78207baf17f3581/hostname\",\n           \"HostsPath\": \"/mnt/VirtualBox/docker/containers/db1821df6a638dfa99a7c286eb8893f9be6a3a48c41d272ed78207baf17f3581/hosts\",\n           \"Id\": \"db1821df6a638dfa99a7c286eb8893f9be6a3a48c41d272ed78207baf17f3581\",\n           \"Image\": \"900ee3f2a87d35843bbb34009c2f972e99c99449e02639d7fec43e5c04a7d66e\",\n           \"MountLabel\": \"\",\n           \"Name\": \"/stoic_elion\",\n           \"NetworkSettings\": {\n        \"Bridge\": \"docker0\",\n        \"Gateway\": \"172.17.42.1\",\n        \"IPAddress\": \"172.17.0.45\",\n        \"IPPrefixLen\": 16,\n        \"MacAddress\": \"02:42:ac:11:00:2d\",\n        \"PortMapping\": null,\n        \"Ports\": {\n            \"22/tcp\": [\n                {\n                    \"HostIp\": \"0.0.0.0\",\n                    \"HostPort\": \"49170\"\n                }\n            ]\n        }\n           },\n           \"Path\": \"/usr/sbin/sshd\",\n           \"ProcessLabel\": \"\",\n           \"ResolvConfPath\": \"/mnt/VirtualBox/docker/containers/db1821df6a638dfa99a7c286eb8893f9be6a3a48c41d272ed78207baf17f3581/resolv.conf\",\n           \"State\": {\n        \"ExitCode\": 0,\n        \"FinishedAt\": \"0001-01-01T00:00:00Z\",\n        \"Paused\": false,\n        \"Pid\": 4911,\n        \"Restarting\": false,\n        \"Running\": true,\n        \"StartedAt\": \"2014-11-18T06:18:38.933269334Z\"\n           },\n           \"Volumes\": {},\n           \"VolumesRW\": {}\n       }\n       ]\n       db1821df6a638dfa99a7c286eb8893f9be6a3a48c41d272ed78207baf17f3581\n       db1821df6a638dfa99a7c286eb8893f9be6a3a48c41d272ed78207baf17f3581\n       Finished destroying <default-ubuntu-1204> (0m0.75s).\n-----> Kitchen is finished. (0m0.80s)\n\n$ kitchen list\nInstance             Driver  Provisioner      Last Action\ndefault-ubuntu-1204  Docker  AnsiblePlaybook  <Not Created>\n\n\n\u53c2\u8003\n\ntest-kitchen\u306e\u3064\u304b\u3044\u304b\u305f - Qiita - http://qiita.com/sawanoboly/items/9f560bd63ad0712b17ba\n\n(\u30e1\u30e2)Chef+Docker+Test-kitchen+Serverspec - Qiita - http://qiita.com/nakashii_/items/ccaf80bc830a18063540\n\n\nAnsible\u306e\u30b3\u30fc\u30c9\u3092test-kitchen\u3068ServerSpec\u3001Docker\u3067\u30c6\u30b9\u30c8\u3057\u307e\u3059\u3002\u30b5\u30f3\u30d7\u30eb\u3068\u3057\u3066\u3001Ansible\u3067Apache\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u3001ServerSpec\u3067\u30c6\u30b9\u30c8\u3092\u884c\u3044\u307e\u3059\u3002\n\n# \u4e8b\u524d\u6e96\u5099\n\ntest-kitchen\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\n\n```shell-session\n$ sudo gem install test-kitchen -v 1.2.1\nFetching: test-kitchen-1.2.1.gem (100%)\nSuccessfully installed test-kitchen-1.2.1\nInstalling ri documentation for test-kitchen-1.2.1\n1 gem installed\n```\n\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u7528\u306e\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092\u4f5c\u6210\u3002\n\n```shell-session\n$ mkdir foobar && cd foobar\n```\n\nGemfile\u3092\u4f5c\u6210\u3057\u3066\u5fc5\u8981\u306a\u30e9\u30a4\u30d6\u30e9\u30ea\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\n\n```ruby:Gemfile\nsource \"https://rubygems.org\"\n\ngem 'test-kitchen', '~> 1.2.1'\ngem 'kitchen-ansible', '~> 0.0.2'\ngem 'kitchen-docker', '~> 1.5.0'\n\ngroup :integration do\n  gem 'serverspec', '~> 2.3.1'\n  gem 'specinfra', '~> 2.4.4'\nend\n```\n\n```shell-session\n$ bundle install\nFetching gem metadata from https://rubygems.org/..........\nResolving dependencies...\nUsing diff-lcs (1.2.5)\nUsing kitchen-ansible (0.0.2)\nInstalling mixlib-shellout (1.6.0)\nUsing net-ssh (2.9.1)\nUsing net-scp (1.2.1)\nUsing safe_yaml (1.0.4)\nUsing thor (0.19.1)\nUsing test-kitchen (1.2.1)\nUsing kitchen-docker (1.5.0)\nUsing multi_json (1.10.1)\nUsing rspec-support (3.1.2)\nUsing rspec-core (3.1.7)\nUsing rspec-expectations (3.1.2)\nUsing rspec-mocks (3.1.3)\nUsing rspec (3.1.0)\nUsing rspec-its (1.1.0)\nUsing specinfra (2.4.4)\nUsing serverspec (2.3.1)\nUsing bundler (1.3.5)\nYour bundle is complete!\nUse `bundle show [gemname]` to see where a bundled gem is installed.\n```\n\n# test-kitchen\u306e\u8a2d\u5b9a\n\n\u307e\u305a\u306ftest-kitchen\u306e\u521d\u671f\u5316\u3092\u884c\u3044\u307e\u3059\u3002-D\u30aa\u30d7\u30b7\u30e7\u30f3\u3067\u4f7f\u7528\u3059\u308b\u30c9\u30e9\u30a4\u30d0\u30fc\u3092\u3001-P\u30aa\u30d7\u30b7\u30e7\u30f3\u3067\u4f7f\u7528\u3059\u308b\u30d7\u30ed\u30d3\u30b8\u30e7\u30ca\u30fc\u3092\u6307\u5b9a\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\u4eca\u56de\u306f\u30c9\u30e9\u30a4\u30d0\u306bDocker\u3092\u3001\u30d7\u30ed\u30d3\u30b8\u30e7\u30ca\u30fc\u306b\u306fansible_playbook\u3092\u4f7f\u7528\u3057\u307e\u3059\u3002\n\n```shell-session\n$ bundle exec kitchen init -D docker -P ansible_playbook\n      create  .kitchen.yml\n      create  test/integration/default\n      append  Gemfile\nYou must run `bundle install' to fetch any new gems.\n```\n\nkitchen init \u3067\u4f5c\u6210\u3055\u308c\u305f.kitchen.yml\u306f\u4ee5\u4e0b\u306e\u901a\u308a\u3002\n\n```yaml:.kitchen.yml\n---\ndriver:\n  name: docker\n\nprovisioner:\n  name: ansible_playbook\n\nplatforms:\n  - name: ubuntu-12.04\n  - name: centos-6.4\n\nsuites:\n  - name: default\n    run_list:\n    attributes:\n```\n\n\u3053\u308c\u3092\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u5909\u66f4\u3057\u307e\u3059\u3002driver_config\u306esocket\u306fDocker\u306e\u63a5\u7d9a\u5148\u3067\u3059\u3002\n\n```yaml:.kitchen.yml\n---\ndriver:\n  name: docker\n\nprovisioner:\n  name: ansible_playbook\n  hosts: foobar\n  roles_path: roles\n  require_ansible_repo: true\n\nplatforms:\n  - name: ubuntu-12.04\n    driver_config:\n      image: ubuntu:12.04\n      socket: tcp://localhost:4242\n\nsuites:\n  - name: default\n```\n\n# Ansible\u306e\u30b3\u30fc\u30c9\u3092\u4f5c\u6210\u3059\u308b\n\n\u4eca\u56de\u306fAnsible\u3067apache\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\u3053\u3068\u306b\u3057\u307e\u3059\u3002\n\n```shell-session\n$ mkdir -p roles/foo/tasks\n```\n\n```yaml:roles/foo/tasks/main.yml\n- apt: pkg=apache2\n```\n\nsite.yml\u30d5\u30a1\u30a4\u30eb\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n\n```yaml:site.yml\n- hosts: foobar\n  roles:\n    - foo\n```\n\n# ServerSpec\u306e\u8a2d\u5b9a\u3092\u3059\u308b\n\nServerspec\u3067\u4f7f\u7528\u3059\u308b\u30d5\u30a1\u30a4\u30eb\u3092\u8ffd\u52a0\u3057\u307e\u3059\u3002\nspec\u3068\u3044\u3046\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u4ee5\u4e0b\u306b\u4f5c\u6210\u3055\u308c\u308b\u306e\u3067\u3001\u3053\u306e\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092serverspec\u306b\u30ea\u30cd\u30fc\u30e0\u3057\u307e\u3059\u3002\n\n```shell-session\n$ cd test/integration/default\n$ serverspec-init\nSelect OS type:\n\n  1) UN*X\n  2) Windows\n\nSelect number: 1\n\nSelect a backend type:\n\n  1) SSH\n  2) Exec (local)\n\nSelect number: 2\n\n + spec/\n + spec/localhost/\n + spec/localhost/sample_spec.rb\n + spec/spec_helper.rb\n + Rakefile\n + .rspec\n$ mv spec serverspec\n```\n\n\u521d\u671f\u72b6\u614b\u3067\u306fapache\u306e\u30c6\u30b9\u30c8\u304c\u66f8\u304b\u308c\u3066\u3044\u307e\u3059\u3002\nAnsible\u3067apache\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\u3088\u3046\u306b\u3057\u3066\u3044\u308b\u305f\u3081\u3001\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u3066\u3044\u308b\u304b\u3069\u3046\u304b\u306e\u30c6\u30b9\u30c8\u306f\u901a\u308b\u306f\u305a\u3067\u3059\u3002\n\n\n```ruby:test/integration/default/serverspec/localhost/sample_spec.rb\nrequire 'spec_helper'\n\ndescribe package('httpd'), :if => os[:family] == 'redhat' do\n  it { should be_installed }\nend\n\ndescribe package('apache2'), :if => os[:family] == 'ubuntu' do\n  it { should be_installed }\nend\n\ndescribe service('httpd'), :if => os[:family] == 'redhat' do\n  it { should be_enabled }\n  it { should be_running }\nend\n\ndescribe service('apache2'), :if => os[:family] == 'ubuntu' do\n  it { should be_enabled }\n  it { should be_running }\nend\n\ndescribe service('org.apache.httpd'), :if => os[:family] == 'darwin' do\n  it { should be_enabled }\n  it { should be_running }\nend\n\ndescribe port(80) do\n  it { should be_listening }\nend\n```\n\n# \u30c6\u30b9\u30c8\u306e\u5b9f\u884c\n\n## \u30c6\u30b9\u30c8\u7528\u306e\u74b0\u5883\u3092\u4f5c\u6210\u3059\u308b\n\n\u307e\u305a\u3001\u30c7\u30b9\u30c8\u3067\u4f7f\u7528\u3059\u308b\u305f\u3081\u306eDocker\u30b3\u30f3\u30c6\u30ca\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\u306a\u305c\u304b\u3001\u5b9f\u884c\u6642\u306bDocker\u306eUsage\u304c\u51fa\u529b\u3055\u308c\u3066\u3044\u305f\u306e\u3067\u3053\u306e\u8a18\u4e8b\u3067\u306f\u305d\u306e\u7b87\u6240\u3092\u524a\u9664\u3057\u3066\u3044\u307e\u3059\u3002\n\n```shell-session\n $ kitchen create\n-----> Starting Kitchen (v1.2.1)\n-----> Creating <default-ubuntu-1204>...\n       Sending build context to Docker daemon 2.048 kB\n       Sending build context to Docker daemon\n       Step 0 : FROM ubuntu:12.04\n        ---> 0b310e6bf058\n       Step 1 : RUN dpkg-divert --local --rename --add /sbin/initctl\n        ---> Using cache\n        ---> 76685424c7fa\n       Step 2 : RUN ln -sf /bin/true /sbin/initctl\n        ---> Using cache\n        ---> 83c6a5f1d537\n       Step 3 : ENV DEBIAN_FRONTEND noninteractive\n        ---> Using cache\n        ---> 5bfc7d3c21f2\n       Step 4 : RUN apt-get update\n        ---> Using cache\n        ---> 43896feefd33\n       Step 5 : RUN apt-get install -y sudo openssh-server curl lsb-release\n        ---> Using cache\n        ---> 208d8a4f2538\n       Step 6 : RUN useradd -d /home/kitchen -m -s /bin/bash kitchen\n        ---> Using cache\n        ---> 3bd9c4c07cbb\n       Step 7 : RUN echo kitchen:kitchen | chpasswd\n        ---> Using cache\n        ---> f2d079722c7f\n       Step 8 : RUN echo 'kitchen ALL=(ALL) NOPASSWD:ALL' >> /etc/sudoers\n        ---> Using cache\n        ---> 900ee3f2a87d\n       Successfully built 900ee3f2a87d\n       234361d227b0a7093ac561c48ff087e4d6b26db0a63bdcdcd4827756a01c7747\n       [{\n           \"Args\": [\n        \"-D\",\n        \"-o\",\n        \"UseDNS=no\",\n        \"-o\",\n        \"UsePAM=no\",\n        \"-o\",\n        \"UsePrivilegeSeparation=no\",\n        \"-o\",\n        \"PidFile=/tmp/sshd.pid\"\n           ],\n           \"Config\": {\n        \"AttachStderr\": false,\n        \"AttachStdin\": false,\n        \"AttachStdout\": false,\n        \"Cmd\": [\n            \"/usr/sbin/sshd\",\n            \"-D\",\n            \"-o\",\n            \"UseDNS=no\",\n            \"-o\",\n            \"UsePAM=no\",\n            \"-o\",\n            \"UsePrivilegeSeparation=no\",\n            \"-o\",\n            \"PidFile=/tmp/sshd.pid\"\n        ],\n        \"CpuShares\": 0,\n        \"Cpuset\": \"\",\n        \"Domainname\": \"\",\n        \"Entrypoint\": null,\n        \"Env\": [\n            \"PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\",\n            \"DEBIAN_FRONTEND=noninteractive\"\n        ],\n        \"ExposedPorts\": {\n            \"22/tcp\": {}\n        },\n        \"Hostname\": \"234361d227b0\",\n        \"Image\": \"900ee3f2a87d\",\n        \"Memory\": 0,\n        \"MemorySwap\": 0,\n        \"NetworkDisabled\": false,\n        \"OnBuild\": null,\n        \"OpenStdin\": false,\n        \"PortSpecs\": null,\n        \"SecurityOpt\": null,\n        \"StdinOnce\": false,\n        \"Tty\": false,\n        \"User\": \"\",\n        \"Volumes\": null,\n        \"WorkingDir\": \"\"\n           },\n           \"Created\": \"2014-11-18T05:59:28.90033457Z\",\n           \"Driver\": \"aufs\",\n           \"ExecDriver\": \"native-0.2\",\n           \"HostConfig\": {\n        \"Binds\": null,\n        \"CapAdd\": null,\n        \"CapDrop\": null,\n        \"ContainerIDFile\": \"\",\n        \"Devices\": [],\n        \"Dns\": null,\n        \"DnsSearch\": null,\n        \"ExtraHosts\": null,\n        \"Links\": null,\n        \"LxcConf\": [],\n        \"NetworkMode\": \"bridge\",\n        \"PortBindings\": {\n            \"22/tcp\": [\n                {\n                    \"HostIp\": \"\",\n                    \"HostPort\": \"\"\n                }\n            ]\n        },\n        \"Privileged\": false,\n        \"PublishAllPorts\": false,\n        \"RestartPolicy\": {\n            \"MaximumRetryCount\": 0,\n            \"Name\": \"\"\n        },\n        \"VolumesFrom\": null\n           },\n           \"HostnamePath\": \"/mnt/VirtualBox/docker/containers/234361d227b0a7093ac561c48ff087e4d6b26db0a63bdcdcd4827756a01c7747/hostname\",\n           \"HostsPath\": \"/mnt/VirtualBox/docker/containers/234361d227b0a7093ac561c48ff087e4d6b26db0a63bdcdcd4827756a01c7747/hosts\",\n           \"Id\": \"234361d227b0a7093ac561c48ff087e4d6b26db0a63bdcdcd4827756a01c7747\",\n           \"Image\": \"900ee3f2a87d35843bbb34009c2f972e99c99449e02639d7fec43e5c04a7d66e\",\n           \"MountLabel\": \"\",\n           \"Name\": \"/grave_euclid\",\n           \"NetworkSettings\": {\n        \"Bridge\": \"docker0\",\n        \"Gateway\": \"172.17.42.1\",\n        \"IPAddress\": \"172.17.0.44\",\n        \"IPPrefixLen\": 16,\n        \"MacAddress\": \"02:42:ac:11:00:2c\",\n        \"PortMapping\": null,\n        \"Ports\": {\n            \"22/tcp\": [\n                {\n                    \"HostIp\": \"0.0.0.0\",\n                    \"HostPort\": \"49169\"\n                }\n            ]\n        }\n           },\n           \"Path\": \"/usr/sbin/sshd\",\n           \"ProcessLabel\": \"\",\n           \"ResolvConfPath\": \"/mnt/VirtualBox/docker/containers/234361d227b0a7093ac561c48ff087e4d6b26db0a63bdcdcd4827756a01c7747/resolv.conf\",\n           \"State\": {\n        \"ExitCode\": 0,\n        \"FinishedAt\": \"0001-01-01T00:00:00Z\",\n        \"Paused\": false,\n        \"Pid\": 26746,\n        \"Restarting\": false,\n        \"Running\": true,\n        \"StartedAt\": \"2014-11-18T05:59:29.001133273Z\"\n           },\n           \"Volumes\": {},\n           \"VolumesRW\": {}\n       }\n       ]\n       Finished creating <default-ubuntu-1204> (0m0.41s).\n-----> Kitchen is finished. (0m0.45s)\n```\n\n\u4f5c\u6210\u3057\u305f\u74b0\u5883\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\u6700\u5f8c\u306e\u30a2\u30af\u30b7\u30e7\u30f3\u304c\u300cCreated\u300d\u3068\u306a\u3063\u3066\u3044\u308b\u3053\u3068\u304c\u308f\u304b\u308a\u307e\u3059\u3002\n\n```shell-session\n$ kitchen list\nInstance             Driver  Provisioner      Last Action\ndefault-ubuntu-1204  Docker  AnsiblePlaybook  Created\n```\n## Ansible\u306e\u30b3\u30fc\u30c9\u3092\u5b9f\u884c\u3059\u308b\n\n```shell-session\n$ kitchen converge\n-----> Starting Kitchen (v1.2.1)\n-----> Converging <default-ubuntu-1204>...\n       Preparing files for transfer\n       Preparing playbook\n       Preparing modules\n       nothing to do for modules\n       Preparing roles\n       Preparing ansible.cfg file\n       Preparing group_vars\n       nothing to do for group_vars\n       Preparing host_vars\n       nothing to do for host_vars\n       Preparing hosts file\n       Finished Preparing files for transfer\n       Installing ansible, will try to determine platform os\nReading package lists... Done\nBuilding dependency tree\nReading state information... 1%\nReading state information... Done\n       The following extra packages will be installed:\n         libapt-inst1.4 libapt-pkg4.12\n       The following NEW packages will be installed:\n         apt-utils libapt-inst1.4\n       The following packages will be upgraded:\n         libapt-pkg4.12\n       1 upgraded, 2 newly installed, 0 to remove and 1 not upgraded.\n       Need to get 1229 kB of archives.\n       After this operation, 1407 kB of additional disk space will be used.\nGet:1 http://archive.ubuntu.com/ubuntu/ precise-updates/main libapt-pkg4.12 amd64 0.8.16~exp12ubuntu10.22 [936 kB]\n1% [1 libapt-pkg4.12 14.2 kB/936 kB 2%]\nGet:2 http://archive.ubuntu.com/ubuntu/ precise-updates/main libapt-inst1.4 amd64 0.8.16~exp12ubuntu10.22 [102 kB]\n78% [2 libapt-inst1.4 20.6 kB/102 kB 20%]\nGet:3 http://archive.ubuntu.com/ubuntu/ precise-updates/main apt-utils amd64 0.8.16~exp12ubuntu10.22 [191 kB]\n85% [3 apt-utils 9521 B/191 kB 5%]\nFetched 1229 kB in 5s (241 kB/s)\n       debconf: delaying package configuration, since apt-utils is not installed\n(Reading database ... 9171 files and directories currently installed.)\n       Preparing to replace libapt-pkg4.12 0.8.16~exp12ubuntu10.21 (using .../libapt-pkg4.12_0.8.16~exp12ubuntu10.22_amd64.deb) ...\n       Unpacking replacement libapt-pkg4.12 ...\n       Setting up libapt-pkg4.12 (0.8.16~exp12ubuntu10.22) ...\n       Processing triggers for libc-bin ...\n       ldconfig deferred processing now taking place\n       Selecting previously unselected package libapt-inst1.4.\n       (Reading database ...\n(Reading database ... 9171 files and directories currently installed.)\n       Unpacking libapt-inst1.4 (from .../libapt-inst1.4_0.8.16~exp12ubuntu10.22_amd64.deb) ...\n       Selecting previously unselected package apt-utils.\n       Unpacking apt-utils (from .../apt-utils_0.8.16~exp12ubuntu10.22_amd64.deb) ...\n       Setting up libapt-inst1.4 (0.8.16~exp12ubuntu10.22) ...\n       Setting up apt-utils (0.8.16~exp12ubuntu10.22) ...\n       Processing triggers for libc-bin ...\n       ldconfig deferred processing now taking place\nReading package lists... Done\nBuilding dependency tree\nReading state information... 0%\nReading state information... Done\n       The following extra packages will be installed:\n         gir1.2-glib-2.0 libdbus-glib-1-2 libgirepository-1.0-1 python-dbus\n         python-dbus-dev python-gi\n       Suggested packages:\n         python-dbus-doc python-dbus-dbg python-gi-cairo\n       The following NEW packages will be installed:\n         gir1.2-glib-2.0 libdbus-glib-1-2 libgirepository-1.0-1 python-dbus\n         python-dbus-dev python-gi software-properties-common\n       0 upgraded, 7 newly installed, 0 to remove and 1 not upgraded.\n       Need to get 669 kB of archives.\n       After this operation, 2578 kB of additional disk space will be used.\nGet:1 http://archive.ubuntu.com/ubuntu/ precise-updates/main libdbus-glib-1-2 amd64 0.98-1ubuntu1.1 [73.6 kB]\nGet:2 http://archive.ubuntu.com/ubuntu/ precise/main libgirepository-1.0-1 amd64 1.32.0-1 [101 kB]\nGet:3 http://archive.ubuntu.com/ubuntu/ precise/main gir1.2-glib-2.0 amd64 1.32.0-1 [157 kB]\n28% [3 gir1.2-glib-2.0 13.0 kB/157 kB 8%]\nGet:4 http://archive.ubuntu.com/ubuntu/ precise/main python-dbus-dev all 1.0.0-1ubuntu1 [5556 B]\n50% [4 python-dbus-dev 5556 B/5556 B 100%]\nGet:5 http://archive.ubuntu.com/ubuntu/ precise/main python-dbus amd64 1.0.0-1ubuntu1 [102 kB]\n52% [5 python-dbus 9189 B/102 kB 9%]\nGet:6 http://archive.ubuntu.com/ubuntu/ precise-updates/main python-gi amd64 3.2.2-1~precise [222 kB]\n67% [6 python-gi 7871 B/222 kB 4%]\nGet:7 http://archive.ubuntu.com/ubuntu/ precise-updates/main software-properties-common all 0.82.7.7 [8450 B]\n100% [7 software-properties-common 8450 B/8450 B 100%]\nFetched 669 kB in 4s (157 kB/s)\n       Selecting previously unselected package libdbus-glib-1-2.\n       (Reading database ...\n(Reading database ... 9252 files and directories currently installed.)\n       Unpacking libdbus-glib-1-2 (from .../libdbus-glib-1-2_0.98-1ubuntu1.1_amd64.deb) ...\n       Selecting previously unselected package libgirepository-1.0-1.\n       Unpacking libgirepository-1.0-1 (from .../libgirepository-1.0-1_1.32.0-1_amd64.deb) ...\n       Selecting previously unselected package gir1.2-glib-2.0.\n       Unpacking gir1.2-glib-2.0 (from .../gir1.2-glib-2.0_1.32.0-1_amd64.deb) ...\n       Selecting previously unselected package python-dbus-dev.\n       Unpacking python-dbus-dev (from .../python-dbus-dev_1.0.0-1ubuntu1_all.deb) ...\n       Selecting previously unselected package python-dbus.\n       Unpacking python-dbus (from .../python-dbus_1.0.0-1ubuntu1_amd64.deb) ...\n       Selecting previously unselected package python-gi.\n       Unpacking python-gi (from .../python-gi_3.2.2-1~precise_amd64.deb) ...\n       Selecting previously unselected package software-properties-common.\n       Unpacking software-properties-common (from .../software-properties-common_0.82.7.7_all.deb) ...\n       Setting up libdbus-glib-1-2 (0.98-1ubuntu1.1) ...\n       Setting up libgirepository-1.0-1 (1.32.0-1) ...\n       Setting up gir1.2-glib-2.0 (1.32.0-1) ...\n       Setting up python-dbus-dev (1.0.0-1ubuntu1) ...\n       Setting up python-dbus (1.0.0-1ubuntu1) ...\n       Remove stale byte-compiled files...\n       Setting up python-gi (3.2.2-1~precise) ...\n       Setting up software-properties-common (0.82.7.7) ...\n       Processing triggers for libc-bin ...\n       ldconfig deferred processing now taking place\nReading package lists... Done\nBuilding dependency tree\nReading state information... 0%\nReading state information... Done\n       The following extra packages will be installed:\n         iso-codes libcurl3-gnutls python-apt python-apt-common python-gnupginterface\n         python-pycurl ucf unattended-upgrades xz-lzma\n       Suggested packages:\n         isoquery python-apt-dbg python-gtk2 python-vte python-apt-doc\n         libcurl4-gnutls-dev python-pycurl-dbg bsd-mailx\n       The following NEW packages will be installed:\n         iso-codes libcurl3-gnutls python-apt python-apt-common python-gnupginterface\n         python-pycurl python-software-properties ucf unattended-upgrades xz-lzma\n       0 upgraded, 10 newly installed, 0 to remove and 1 not upgraded.\n       Need to get 4167 kB of archives.\n       After this operation, 16.1 MB of additional disk space will be used.\nGet:1 http://archive.ubuntu.com/ubuntu/ precise-updates/main libcurl3-gnutls amd64 7.22.0-3ubuntu4.11 [227 kB]\n0% [1 libcurl3-gnutls 14.2 kB/227 kB 6%]\nGet:2 http://archive.ubuntu.com/ubuntu/ precise/main ucf all 3.0025+nmu2ubuntu1 [54.4 kB]\n6% [2 ucf 16.4 kB/54.4 kB 30%]\nGet:3 http://archive.ubuntu.com/ubuntu/ precise/main iso-codes all 3.31-1 [3547 kB]\n8% [3 iso-codes 45.1 kB/3547 kB 1%]\nGet:4 http://archive.ubuntu.com/ubuntu/ precise-updates/main python-apt-common all 0.8.3ubuntu7.2 [22.2 kB]\n92% [4 python-apt-common 8840 B/22.2 kB 40%]\nGet:5 http://archive.ubuntu.com/ubuntu/ precise-updates/main python-apt amd64 0.8.3ubuntu7.2 [187 kB]\n93% [5 python-apt 12.4 kB/187 kB 7%]\nGet:6 http://archive.ubuntu.com/ubuntu/ precise/main python-gnupginterface all 0.3.2-9.1ubuntu3 [19.2 kB]\n97% [6 python-gnupginterface 18.9 kB/19.2 kB 98%]\nGet:7 http://archive.ubuntu.com/ubuntu/ precise/main xz-lzma all 5.1.1alpha+20110809-3 [12.4 kB]\n97% [7 xz-lzma 4000 B/12.4 kB 32%]\nGet:8 http://archive.ubuntu.com/ubuntu/ precise-updates/main unattended-upgrades all 0.76ubuntu1 [24.7 kB]\n98% [8 unattended-upgrades 12.7 kB/24.7 kB 52%]\nGet:9 http://archive.ubuntu.com/ubuntu/ precise/main python-pycurl amd64 7.19.0-4ubuntu3 [49.2 kB]\n98% [9 python-pycurl 5139 B/49.2 kB 10%]\nGet:10 http://archive.ubuntu.com/ubuntu/ precise-updates/main python-software-properties all 0.82.7.7 [23.5 kB]\n100% [10 python-software-properties 10.7 kB/23.5 kB 46%]\nFetched 4167 kB in 3s (1302 kB/s)\n       Preconfiguring packages ...\n       Selecting previously unselected package libcurl3-gnutls.\n(Reading database ... 30%...\n(Reading database ... 9428 files and directories currently installed.)\n       Unpacking libcurl3-gnutls (from .../libcurl3-gnutls_7.22.0-3ubuntu4.11_amd64.deb) ...\n       Selecting previously unselected package ucf.\n       Unpacking ucf (from .../ucf_3.0025+nmu2ubuntu1_all.deb) ...\n       Moving old data out of the way\nSelecting previously unselected package iso-codes.\nUnpacking iso-codes (from .../iso-codes_3.31-1_all.deb) ...\n       Selecting previously unselected package python-apt-common.\n       Unpacking python-apt-common (from .../python-apt-common_0.8.3ubuntu7.2_all.deb) ...\n       Selecting previously unselected package python-apt.\n       Unpacking python-apt (from .../python-apt_0.8.3ubuntu7.2_amd64.deb) ...\n       Selecting previously unselected package python-gnupginterface.\n       Unpacking python-gnupginterface (from .../python-gnupginterface_0.3.2-9.1ubuntu3_all.deb) ...\n       Selecting previously unselected package xz-lzma.\n       Unpacking xz-lzma (from .../xz-lzma_5.1.1alpha+20110809-3_all.deb) ...\n       Selecting previously unselected package unattended-upgrades.\n       Unpacking unattended-upgrades (from .../unattended-upgrades_0.76ubuntu1_all.deb) ...\n       Selecting previously unselected package python-pycurl.\n       Unpacking python-pycurl (from .../python-pycurl_7.19.0-4ubuntu3_amd64.deb) ...\n       Selecting previously unselected package python-software-properties.\n       Unpacking python-software-properties (from .../python-software-properties_0.82.7.7_all.deb) ...\n       Setting up libcurl3-gnutls (7.22.0-3ubuntu4.11) ...\n       Setting up ucf (3.0025+nmu2ubuntu1) ...\n       Setting up iso-codes (3.31-1) ...\n       Setting up python-apt-common (0.8.3ubuntu7.2) ...\n       Setting up python-apt (0.8.3ubuntu7.2) ...\n       Setting up python-gnupginterface (0.3.2-9.1ubuntu3) ...\n       Setting up xz-lzma (5.1.1alpha+20110809-3) ...\n       Setting up unattended-upgrades (0.76ubuntu1) ...\n       Setting up python-pycurl (7.19.0-4ubuntu3) ...\n       Setting up python-software-properties (0.82.7.7) ...\n       Processing triggers for libc-bin ...\n       ldconfig deferred processing now taking place\n       gpg: keyring `/tmp/tmp7ofJgJ/secring.gpg' created\n       gpg: keyring `/tmp/tmp7ofJgJ/pubring.gpg' created\n       gpg: requesting key 5504681D from hkp server keyserver.ubuntu.com\n       gpg: /tmp/tmp7ofJgJ/trustdb.gpg: trustdb created\n       gpg: key 5504681D: public key \"Launchpad PPA for Rodney Quillo\" imported\n       gpg: Total number processed: 1\n       gpg:               imported: 1  (RSA: 1)\n       OK\nHit http://archive.ubuntu.com precise Release.gpg\nGet:1 http://archive.ubuntu.com precise-updates Release.gpg [198 B]\n98% [1 Release.gpg 198 B/198 B 100%] [Waiting for headers]\nGet:2 http://archive.ubuntu.com precise-security Release.gpg [198 B]\n99% [Waiting for headers]\nHit http://archive.ubuntu.com precise-proposed Release.gpg\n99% [Waiting for headers]\nHit http://archive.ubuntu.com precise Release\nGet:3 http://archive.ubuntu.com precise-updates Release [194 kB]\n7% [3 Release 12.7 kB/194 kB 7%] [Waiting for headers]\nGet:4 http://ppa.launchpad.net precise Release.gpg [316 B]\nGet:5 http://ppa.launchpad.net precise Release [11.9 kB]\n20% [3 Release 28.6 kB/194 kB 15%] [5 Release 11.9 kB/11.9 kB 100%]\nGet:6 http://ppa.launchpad.net precise/main Sources [560 B]\nGet:7 http://ppa.launchpad.net precise/main amd64 Packages [549 B]\n50% [3 Release 90.9 kB/194 kB 47%] [Waiting for headers]\nGet:8 http://ppa.launchpad.net precise/main i386 Packages [549 B]\n50% [3 Release 90.9 kB/194 kB 47%]\nGet:9 http://archive.ubuntu.com precise-security Release [53.0 kB]\n88% [9 Release 20.8 kB/53.0 kB 39%]\nHit http://archive.ubuntu.com precise-proposed Release\n100% [Waiting for headers]\nHit http://archive.ubuntu.com precise/main Sources\n100% [9 Release gpgv 53.0 kB]\nHit http://archive.ubuntu.com precise/restricted Sources\nHit http://archive.ubuntu.com precise/universe Sources\nHit http://archive.ubuntu.com precise/main amd64 Packages\nHit http://archive.ubuntu.com precise/restricted amd64 Packages\n100% [9 Release gpgv 53.0 kB] [Waiting for headers]\nHit http://archive.ubuntu.com precise/universe amd64 Packages\nHit http://archive.ubuntu.com precise/main i386 Packages\nHit http://archive.ubuntu.com precise/restricted i386 Packages\n100% [Sources 1175 kB] [Waiting for headers]\nHit http://archive.ubuntu.com precise/universe i386 Packages\nGet:10 http://archive.ubuntu.com precise-updates/main Sources [588 kB]\nGet:11 http://archive.ubuntu.com precise-updates/restricted Sources [8241 B]\n100% [Packages 6180 kB] [11 Sources 8241 B/8241 B 100%]\nGet:12 http://archive.ubuntu.com precise-updates/universe Sources [136 kB]\nGet:13 http://archive.ubuntu.com precise-updates/main amd64 Packages [1091 kB]\n94% [Packages 6180 kB] [13 Packages 23.4 kB/1091 kB 2%]\nGet:14 http://archive.ubuntu.com precise-updates/restricted amd64 Packages [16.1 kB]\nGet:15 http://archive.ubuntu.com precise-updates/universe amd64 Packages [321 kB]\n99% [13 Packages 1091 kB] [15 Packages 81.5 kB/321 kB 25%]\nGet:16 http://archive.ubuntu.com precise-updates/main i386 Packages [1134 kB]\nGet:17 http://archive.ubuntu.com precise-updates/restricted i386 Packages [16.0 kB]\n100% [17 Packages 16.0 kB/16.0 kB 100%]\nGet:18 http://archive.ubuntu.com precise-updates/universe i386 Packages [330 kB]\n99% [16 Packages 1134 kB] [18 Packages 32.0 kB/330 kB 10%]\nGet:19 http://archive.ubuntu.com precise-security/main Sources [144 kB]\n100% [19 Sources 32.3 kB/144 kB 22%]                               4410 kB/s 0s\nGet:20 http://archive.ubuntu.com precise-security/restricted Sources [2258 B]\nGet:21 http://archive.ubuntu.com precise-security/universe Sources [37.9 kB]\nGet:22 http://archive.ubuntu.com precise-security/main amd64 Packages [565 kB]\n98% [18 Packages 330 kB] [22 Packages 35.1 kB/565 kB 6%]           4410 kB/s 0s\nGet:23 http://archive.ubuntu.com precise-security/restricted amd64 Packages [5282 B]\nGet:24 http://archive.ubuntu.com precise-security/universe amd64 Packages [129 kB]\nGet:25 http://archive.ubuntu.com precise-security/main i386 Packages [607 kB]\n98% [22 Packages 565 kB] [25 Packages 4096 B/607 kB 1%]            4410 kB/s 0s\nGet:26 http://archive.ubuntu.com precise-security/restricted i386 Packages [5273 B]\nGet:27 http://archive.ubuntu.com precise-security/universe i386 Packages [136 kB]\n100% [25 Packages 607 kB] [27 Packages 8192 B/136 kB 6%]           4410 kB/s 0s\nHit http://archive.ubuntu.com precise-proposed/main amd64 Packages\nHit http://archive.ubuntu.com precise-proposed/restricted amd64 Packages\nHit http://archive.ubuntu.com precise-proposed/main i386 Packages\nHit http://archive.ubuntu.com precise-proposed/restricted i386 Packages\n100% [25 Packages 607 kB]                                          4410 kB/s 0s\nFetched 5534 kB in 6s (817 kB/s)\nReading package lists... Done\n        package lists... Done\nBuilding dependency tree\nReading state information... 0%\nReading state information... Done\n       The following extra packages will be installed:\n         libgmp10 libyaml-0-2 python-crypto python-httplib2 python-jinja2\n         python-markupsafe python-paramiko python-pkg-resources python-setuptools\n         python-support python-yaml sshpass\n       Suggested packages:\n         python-crypto-dbg python-crypto-doc python-jinja2-doc python-distribute\n         python-distribute-doc\n       The following NEW packages will be installed:\n         ansible libgmp10 libyaml-0-2 python-crypto python-httplib2 python-jinja2\n         python-markupsafe python-paramiko python-pkg-resources python-setuptools\n         python-support python-yaml sshpass\n       0 upgraded, 13 newly installed, 0 to remove and 1 not upgraded.\n       Need to get 2974 kB of archives.\n       After this operation, 15.8 MB of additional disk space will be used.\nGet:1 http://ppa.launchpad.net/rquillo/ansible/ubuntu/ precise/main ansible all 1.7.1-precise-unstable-ppa [696 kB]\n0% [Waiting for headers] [1 ansible 14.2 kB/696 kB 2%]\nGet:2 http://archive.ubuntu.com/ubuntu/ precise/main libgmp10 amd64 2:5.0.2+dfsg-2ubuntu1 [238 kB]\n1% [2 libgmp10 14.2 kB/238 kB 6%] [1 ansible 14.2 kB/696 kB 2%]\nGet:3 http://archive.ubuntu.com/ubuntu/ precise-updates/main libyaml-0-2 amd64 0.1.4-2ubuntu0.12.04.3 [57.8 kB]\n15% [3 libyaml-0-2 8795 B/57.8 kB 15%] [1 ansible 188 kB/696 kB 27%]\nGet:4 http://archive.ubuntu.com/ubuntu/ precise/universe python-support all 1.0.14ubuntu2 [26.1 kB]\n18% [4 python-support 11.5 kB/26.1 kB 44%] [1 ansible 231 kB/696 kB 33%]\nGet:5 http://archive.ubuntu.com/ubuntu/ precise/main python-markupsafe amd64 0.15-1 [13.6 kB]\nGet:6 http://archive.ubuntu.com/ubuntu/ precise-updates/main python-jinja2 amd64 2.6-1ubuntu0.1 [158 kB]\nGet:7 http://archive.ubuntu.com/ubuntu/ precise/main python-yaml amd64 3.10-2 [122 kB]\n32% [7 python-yaml 28.3 kB/122 kB 23%] [1 ansible 424 kB/696 kB 61%]\nGet:8 http://archive.ubuntu.com/ubuntu/ precise-updates/main python-crypto amd64 2.4.1-1ubuntu0.1 [293 kB]\n38% [8 python-crypto 18.4 kB/293 kB 6%] [1 ansible 506 kB/696 kB 73%]\nGet:9 http://archive.ubuntu.com/ubuntu/ precise-updates/main python-paramiko all 1.7.7.1-2ubuntu1 [797 kB]\n54% [9 python-paramiko 8192 B/797 kB 1%]\nGet:10 http://archive.ubuntu.com/ubuntu/ precise-updates/main python-httplib2 all 0.7.2-1ubuntu2.1 [57.1 kB]\n81% [10 python-httplib2 12.7 kB/57.1 kB 22%]\nGet:11 http://archive.ubuntu.com/ubuntu/ precise/universe sshpass amd64 1.05-1 [10.5 kB]\n83% [11 sshpass 3053 B/10.5 kB 29%]\nGet:12 http://archive.ubuntu.com/ubuntu/ precise/main python-pkg-resources all 0.6.24-1ubuntu1 [63.1 kB]\n83% [12 python-pkg-resources 2369 B/63.1 kB 4%]\nGet:13 http://archive.ubuntu.com/ubuntu/ precise/main python-setuptools all 0.6.24-1ubuntu1 [441 kB]\n85% [13 python-setuptools 5567 B/441 kB 1%]\nFetched 2974 kB in 6s (481 kB/s)\n       Selecting previously unselected package libgmp10.\n       (Reading database ...\n(Reading database ... 10166 files and directories currently installed.)\n       Unpacking libgmp10 (from .../libgmp10_2%3a5.0.2+dfsg-2ubuntu1_amd64.deb) ...\n       Selecting previously unselected package libyaml-0-2.\n       Unpacking libyaml-0-2 (from .../libyaml-0-2_0.1.4-2ubuntu0.12.04.3_amd64.deb) ...\n       Selecting previously unselected package python-support.\n       Unpacking python-support (from .../python-support_1.0.14ubuntu2_all.deb) ...\n       Selecting previously unselected package python-markupsafe.\n       Unpacking python-markupsafe (from .../python-markupsafe_0.15-1_amd64.deb) ...\n       Selecting previously unselected package python-jinja2.\n       Unpacking python-jinja2 (from .../python-jinja2_2.6-1ubuntu0.1_amd64.deb) ...\n       Selecting previously unselected package python-yaml.\n       Unpacking python-yaml (from .../python-yaml_3.10-2_amd64.deb) ...\n       Selecting previously unselected package python-crypto.\n       Unpacking python-crypto (from .../python-crypto_2.4.1-1ubuntu0.1_amd64.deb) ...\n       Selecting previously unselected package python-paramiko.\n       Unpacking python-paramiko (from .../python-paramiko_1.7.7.1-2ubuntu1_all.deb) ...\n       Selecting previously unselected package python-httplib2.\n       Unpacking python-httplib2 (from .../python-httplib2_0.7.2-1ubuntu2.1_all.deb) ...\n       Selecting previously unselected package sshpass.\n       Unpacking sshpass (from .../sshpass_1.05-1_amd64.deb) ...\n       Selecting previously unselected package python-pkg-resources.\n       Unpacking python-pkg-resources (from .../python-pkg-resources_0.6.24-1ubuntu1_all.deb) ...\n       Selecting previously unselected package python-setuptools.\n       Unpacking python-setuptools (from .../python-setuptools_0.6.24-1ubuntu1_all.deb) ...\n       Selecting previously unselected package ansible.\n       Unpacking ansible (from .../ansible_1.7.1-precise-unstable-ppa_all.deb) ...\n       Setting up libgmp10 (2:5.0.2+dfsg-2ubuntu1) ...\n       Setting up libyaml-0-2 (0.1.4-2ubuntu0.12.04.3) ...\n       Setting up python-support (1.0.14ubuntu2) ...\n       Setting up python-markupsafe (0.15-1) ...\n       Setting up python-jinja2 (2.6-1ubuntu0.1) ...\n       Setting up python-yaml (3.10-2) ...\n       Setting up python-crypto (2.4.1-1ubuntu0.1) ...\n       Setting up python-paramiko (1.7.7.1-2ubuntu1) ...\n       Setting up python-httplib2 (0.7.2-1ubuntu2.1) ...\n       Setting up sshpass (1.05-1) ...\n       Setting up python-pkg-resources (0.6.24-1ubuntu1) ...\n       Setting up python-setuptools (0.6.24-1ubuntu1) ...\n       Setting up ansible (1.7.1-precise-unstable-ppa) ...\n       Processing triggers for libc-bin ...\n       ldconfig deferred processing now taking place\n       Processing triggers for python-support ...\n-----> Installing Chef Omnibus to install busser to run tests\n       downloading https://www.getchef.com/chef/install.sh\n         to file /tmp/install.sh\n\n       trying wget...\n       Downloading Chef  for ubuntu...\n       downloading https://www.getchef.com/chef/metadata?v=&prerelease=false&nightlies=false&p=ubuntu&pv=12.04&m=x86_64\n         to file /tmp/install.sh.649/metadata.txt\n       trying wget...\n       url      https://opscode-omnibus-packages.s3.amazonaws.com/ubuntu/12.04/x86_64/chef_11.16.4-1_amd64.deb\n       md5      2ffff5b4d80e4dcffc917f8eb2003a31\n       sha256   28b08975e7e33ac46c888616ec7fa232a0c624aeeda81e58a6047d2c6b62edfb\n       downloaded metadata file looks valid...\n       downloading https://opscode-omnibus-packages.s3.amazonaws.com/ubuntu/12.04/x86_64/chef_11.16.4-1_amd64.deb\n         to file /tmp/install.sh.649/chef_11.16.4-1_amd64.deb\n       trying wget...\n       Comparing checksum with sha256sum...\n       Installing Chef\n       installing with dpkg...\n       Selecting previously unselected package chef.\n(Reading database ... 25%...\n(Reading database ... 11500 files and directories currently installed.)\n       Unpacking chef (from .../chef_11.16.4-1_amd64.deb) ...\n       Setting up chef (11.16.4-1) ...\n       Thank you for installing Chef!\n       Transfering files to <default-ubuntu-1204>\n\n       PLAY [foobar] *****************************************************************\n\n       GATHERING FACTS ***************************************************************\n       ok: [localhost]\n\n       TASK: [foo | apt pkg=apache2] *************************************************\n       changed: [localhost]\n\n       PLAY RECAP ********************************************************************\n       localhost                  : ok=2    changed=1    unreachable=0    failed=0\n\n       Finished converging <default-ubuntu-1204> (2m20.92s).\n-----> Kitchen is finished. (2m20.96s)\n```\n## \u30c6\u30b9\u30c8\u3059\u308b\n\n```shell-session\n$ kitchen verify\n-----> Starting Kitchen (v1.2.1)\n-----> Setting up <default-ubuntu-1204>...\nFetching: thor-0.19.0.gem (100%)\nFetching: busser-0.6.2.gem (100%)\n       Successfully installed thor-0.19.0\n       Successfully installed busser-0.6.2\n       2 gems installed\n-----> Setting up Busser\n       Creating BUSSER_ROOT in /tmp/busser\n       Creating busser binstub\n       Plugin serverspec installed (version 0.5.3)\n-----> Running postinstall for serverspec plugin\n       Finished setting up <default-ubuntu-1204> (0m46.47s).\n-----> Verifying <default-ubuntu-1204>...\n       Suite path directory /tmp/busser/suites does not exist, skipping.\n       Uploading /tmp/busser/suites/serverspec/spec_helper.rb (mode=0644)\n       Uploading /tmp/busser/suites/serverspec/localhost/sample_spec.rb (mode=0644)\n-----> Running serverspec test suite\n-----> Installing Serverspec..\nFetching: rspec-support-3.1.2.gem (100%)\nFetching: rspec-core-3.1.7.gem (100%)\nFetching: diff-lcs-1.2.5.gem (100%)\nFetching: rspec-expectations-3.1.2.gem (100%)\nFetching: rspec-mocks-3.1.3.gem (100%)\nFetching: rspec-3.1.0.gem (100%)\nFetching: rspec-its-1.1.0.gem (100%)\nFetching: multi_json-1.10.1.gem (100%)\nFetching: net-ssh-2.9.1.gem (100%)\nFetching: net-scp-1.2.1.gem (100%)\nFetching: specinfra-2.4.4.gem (100%)\nFetching: serverspec-2.3.1.gem (100%)\n-----> serverspec installed (version 2.3.1)\n       /opt/chef/embedded/bin/ruby -I/tmp/busser/suites/serverspec -I/tmp/busser/gems/gems/rspec-support-3.1.2/lib:/tmp/busser/gems/gems/rspec-core-3.1.7/lib /opt/chef/embedded/bin/rspec --pattern /tmp/busser/suites/serverspec/\\*\\*/\\*_spec.rb --color --format documentation --default-path /tmp/busser/suites/serverspec\n\n       Package \"apache2\"\n         should be installed\n\n       Service \"apache2\"\n         should be enabled\n         should be running (FAILED - 1)\n\n       Port \"80\"\n         should be listening (FAILED - 2)\n\n       Failures:\n\n         1) Service \"apache2\" should be running\n\n            Failure/Error: it { should be_running }\n              expected Service \"apache2\" to be running\n              /bin/sh -c service\\ apache2\\ status\\ \\&\\&\\ service\\ apache2\\ status\\ \\|\\ grep\\ \\'running\\'\n              Apache2 is NOT running.\n\n            # /tmp/busser/suites/serverspec/localhost/sample_spec.rb:18:in `block (2 levels) in <top (required)>'\n\n         2) Port \"80\" should be listening\n            Failure/Error: it { should be_listening }\n              expected Port \"80\" to be listening\n              /bin/sh -c netstat\\ -tunl\\ \\|\\ grep\\ --\\ :80\n              /bin/sh: 1: netstat: not found\n\n            # /tmp/busser/suites/serverspec/localhost/sample_spec.rb:27:in `block (2 levels) in <top (required)>'\n\n       Finished in 0.03473 seconds (files took 0.36989 seconds to load)\n       4 examples, 2 failures\n\n       Failed examples:\n\n       rspec /tmp/busser/suites/serverspec/localhost/sample_spec.rb:18 # Service \"apache2\" should be running\n       rspec /tmp/busser/suites/serverspec/localhost/sample_spec.rb:27 # Port \"80\" should be listening\n       /opt/chef/embedded/bin/ruby -I/tmp/busser/suites/serverspec -I/tmp/busser/gems/gems/rspec-support-3.1.2/lib:/tmp/busser/gems/gems/rspec-core-3.1.7/lib /opt/chef/embedded/bin/rspec --pattern /tmp/busser/suites/serverspec/\\*\\*/\\*_spec.rb --color --format documentation --default-path /tmp/busser/suites/serverspec failed\n       Ruby Script [/tmp/busser/gems/gems/busser-serverspec-0.5.3/lib/busser/runner_plugin/../serverspec/runner.rb /tmp/busser/suites/serverspec] exit code was 1\n>>>>>> Verify failed on instance <default-ubuntu-1204>.\n>>>>>> Please see .kitchen/logs/default-ubuntu-1204.log for more details\n>>>>>> ------Exception-------\n>>>>>> Class: Kitchen::ActionFailed\n>>>>>> Message: SSH exited (1) for command: [sh -c 'BUSSER_ROOT=\"/tmp/busser\" GEM_HOME=\"/tmp/busser/gems\" GEM_PATH=\"/tmp/busser/gems\" GEM_CACHE=\"/tmp/busser/gems/cache\" ; export BUSSER_ROOT GEM_HOME GEM_PATH GEM_CACHE; sudo -E /tmp/busser/bin/busser test']\n>>>>>> ----------------------\n```\n\n4\u30c6\u30b9\u30c8\u4e2d2\u3064\u304c\u5931\u6557\u3057\u307e\u3057\u305f\u3002\n\n# \u4fee\u6b63\u3057\u3066\u518d\u5ea6\u5b9f\u884c\u30fb\u30c6\u30b9\u30c8\n\n\u5931\u6557\u3057\u305f\u30c6\u30b9\u30c8\u304b\u3089\u3001\u4ee5\u4e0b\u306e\u4fee\u6b63\u3092\u52a0\u3048\u307e\u3059\u3002\u3002\n\n- \u30b5\u30fc\u30d3\u30b9\u306e\u8a2d\u5b9a\u304c\u884c\u308f\u308c\u3066\u3044\u306a\u304b\u3063\u305f\u306e\u3067apache2\u306e\u30b5\u30fc\u30d3\u30b9\u3092\u8d77\u52d5\u3059\u308b\u3088\u3046\u306b\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n- \u307e\u305f\u3001netstat\u304c\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u3066\u3044\u306a\u304b\u3063\u305f\u306e\u3067\u3001net-tools\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\n\n```yaml:main.yml\n- apt: pkg=apache2\n- service: name=apache2 state=started\n- apt: pkg=net-tools\n```\n\n\u4fee\u6b63\u5f8c\u306fkitchen converge\u3067\u30c6\u30b9\u30c8\u3067\u304d\u307e\u3059\u3002\u4f5c\u6210\u6e08\u307f\u306e\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u3092\u4f7f\u7528\u3059\u308b\u305f\u3081\u3001\u5b9f\u884c\u304c\u65e9\u3044\u3067\u3059\u3002\n\n```shell-session\n$ kitchen converge\n-----> Starting Kitchen (v1.2.1)\n-----> Converging <default-ubuntu-1204>...\n       Preparing files for transfer\n       Preparing playbook\n       Preparing modules\n       nothing to do for modules\n       Preparing roles\n       Preparing ansible.cfg file\n       Preparing group_vars\n       nothing to do for group_vars\n       Preparing host_vars\n       nothing to do for host_vars\n       Preparing hosts file\n       Finished Preparing files for transfer\n       Installing ansible, will try to determine platform os\n       Transfering files to <default-ubuntu-1204>\n\n       PLAY [foobar] *****************************************************************\n\n       GATHERING FACTS ***************************************************************\n       ok: [localhost]\n\n       TASK: [foo | apt pkg=apache2] *************************************************\n       ok: [localhost]\n\n       TASK: [foo | service name=apache2 state=started] ******************************\n       changed: [localhost]\n\n       TASK: [foo | apt pkg=net-tools] ***********************************************\n       changed: [localhost]\n\n       PLAY RECAP ********************************************************************\n       localhost                  : ok=4    changed=2    unreachable=0    failed=0\n\n       Finished converging <default-ubuntu-1204> (0m14.13s).\n-----> Kitchen is finished. (0m14.17s)\n```\n\n\u5909\u66f4\u306b\u5bfe\u3057\u3066\u518d\u5ea6\u30c6\u30b9\u30c8\u3092\u5b9f\u884c\u3057\u307e\u3059\u3002\n\n```shell-session\n$ kitchen verify\n-----> Starting Kitchen (v1.2.1)\n-----> Setting up <default-ubuntu-1204>...\n-----> Setting up Busser\n       Creating BUSSER_ROOT in /tmp/busser\n\n       Creating busser binstub\n       Plugin serverspec already installed\n       Finished setting up <default-ubuntu-1204> (0m6.15s).\n-----> Verifying <default-ubuntu-1204>...\n       Removing /tmp/busser/suites/serverspec\n       Uploading /tmp/busser/suites/serverspec/spec_helper.rb (mode=0644)\n       Uploading /tmp/busser/suites/serverspec/localhost/sample_spec.rb (mode=0644)\n-----> Running serverspec test suite\n       /opt/chef/embedded/bin/ruby -I/tmp/busser/suites/serverspec -I/tmp/busser/gems/gems/rspec-support-3.1.2/lib:/tmp/busser/gems/gems/rspec-core-3.1.7/lib /opt/chef/embedded/bin/rspec --pattern /tmp/busser/suites/serverspec/\\*\\*/\\*_spec.rb --color --format documentation --default-path /tmp/busser/suites/serverspec\n\n       Package \"apache2\"\n         should be installed\n\n       Service \"apache2\"\n         should be enabled\n         should be running\n\n       Port \"80\"\n         should be listening\n\n       Finished in 0.04397 seconds (files took 0.37108 seconds to load)\n       4 examples, 0 failures\n       Finished verifying <default-ubuntu-1204> (0m1.69s).\n-----> Kitchen is finished. (0m7.90s)\n```\n\n\u7121\u4e8b\u3001\u30c6\u30b9\u30c8\u304c\u5168\u3066\u901a\u308a\u307e\u3057\u305f\u3002\n\n# \u5f8c\u7247\u4ed8\u3051\n\n\u30a4\u30f3\u30bf\u30f3\u30b9\u306f\u6b8b\u3063\u305f\u307e\u307e\u306a\u306e\u3067\u3001\u524a\u9664\u3057\u307e\u3059\u3002\n\n```shell-session\n$ kitchen destroy\n-----> Starting Kitchen (v1.2.1)\n-----> Destroying <default-ubuntu-1204>...\n       [{\n           \"Args\": [\n        \"-D\",\n        \"-o\",\n        \"UseDNS=no\",\n        \"-o\",\n        \"UsePAM=no\",\n        \"-o\",\n        \"UsePrivilegeSeparation=no\",\n        \"-o\",\n        \"PidFile=/tmp/sshd.pid\"\n           ],\n           \"Config\": {\n        \"AttachStderr\": false,\n        \"AttachStdin\": false,\n        \"AttachStdout\": false,\n        \"Cmd\": [\n            \"/usr/sbin/sshd\",\n            \"-D\",\n            \"-o\",\n            \"UseDNS=no\",\n            \"-o\",\n            \"UsePAM=no\",\n            \"-o\",\n            \"UsePrivilegeSeparation=no\",\n            \"-o\",\n            \"PidFile=/tmp/sshd.pid\"\n        ],\n        \"CpuShares\": 0,\n        \"Cpuset\": \"\",\n        \"Domainname\": \"\",\n        \"Entrypoint\": null,\n        \"Env\": [\n            \"PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\",\n            \"DEBIAN_FRONTEND=noninteractive\"\n        ],\n        \"ExposedPorts\": {\n            \"22/tcp\": {}\n        },\n        \"Hostname\": \"db1821df6a63\",\n        \"Image\": \"900ee3f2a87d\",\n        \"Memory\": 0,\n        \"MemorySwap\": 0,\n        \"NetworkDisabled\": false,\n        \"OnBuild\": null,\n        \"OpenStdin\": false,\n        \"PortSpecs\": null,\n        \"SecurityOpt\": null,\n        \"StdinOnce\": false,\n        \"Tty\": false,\n        \"User\": \"\",\n        \"Volumes\": null,\n        \"WorkingDir\": \"\"\n           },\n           \"Created\": \"2014-11-18T06:18:38.815094709Z\",\n           \"Driver\": \"aufs\",\n           \"ExecDriver\": \"native-0.2\",\n           \"HostConfig\": {\n        \"Binds\": null,\n        \"CapAdd\": null,\n        \"CapDrop\": null,\n        \"ContainerIDFile\": \"\",\n        \"Devices\": [],\n        \"Dns\": null,\n        \"DnsSearch\": null,\n        \"ExtraHosts\": null,\n        \"Links\": null,\n        \"LxcConf\": [],\n        \"NetworkMode\": \"bridge\",\n        \"PortBindings\": {\n            \"22/tcp\": [\n                {\n                    \"HostIp\": \"\",\n                    \"HostPort\": \"\"\n                }\n            ]\n        },\n        \"Privileged\": false,\n        \"PublishAllPorts\": false,\n        \"RestartPolicy\": {\n            \"MaximumRetryCount\": 0,\n            \"Name\": \"\"\n        },\n        \"VolumesFrom\": null\n           },\n           \"HostnamePath\": \"/mnt/VirtualBox/docker/containers/db1821df6a638dfa99a7c286eb8893f9be6a3a48c41d272ed78207baf17f3581/hostname\",\n           \"HostsPath\": \"/mnt/VirtualBox/docker/containers/db1821df6a638dfa99a7c286eb8893f9be6a3a48c41d272ed78207baf17f3581/hosts\",\n           \"Id\": \"db1821df6a638dfa99a7c286eb8893f9be6a3a48c41d272ed78207baf17f3581\",\n           \"Image\": \"900ee3f2a87d35843bbb34009c2f972e99c99449e02639d7fec43e5c04a7d66e\",\n           \"MountLabel\": \"\",\n           \"Name\": \"/stoic_elion\",\n           \"NetworkSettings\": {\n        \"Bridge\": \"docker0\",\n        \"Gateway\": \"172.17.42.1\",\n        \"IPAddress\": \"172.17.0.45\",\n        \"IPPrefixLen\": 16,\n        \"MacAddress\": \"02:42:ac:11:00:2d\",\n        \"PortMapping\": null,\n        \"Ports\": {\n            \"22/tcp\": [\n                {\n                    \"HostIp\": \"0.0.0.0\",\n                    \"HostPort\": \"49170\"\n                }\n            ]\n        }\n           },\n           \"Path\": \"/usr/sbin/sshd\",\n           \"ProcessLabel\": \"\",\n           \"ResolvConfPath\": \"/mnt/VirtualBox/docker/containers/db1821df6a638dfa99a7c286eb8893f9be6a3a48c41d272ed78207baf17f3581/resolv.conf\",\n           \"State\": {\n        \"ExitCode\": 0,\n        \"FinishedAt\": \"0001-01-01T00:00:00Z\",\n        \"Paused\": false,\n        \"Pid\": 4911,\n        \"Restarting\": false,\n        \"Running\": true,\n        \"StartedAt\": \"2014-11-18T06:18:38.933269334Z\"\n           },\n           \"Volumes\": {},\n           \"VolumesRW\": {}\n       }\n       ]\n       db1821df6a638dfa99a7c286eb8893f9be6a3a48c41d272ed78207baf17f3581\n       db1821df6a638dfa99a7c286eb8893f9be6a3a48c41d272ed78207baf17f3581\n       Finished destroying <default-ubuntu-1204> (0m0.75s).\n-----> Kitchen is finished. (0m0.80s)\n```\n\n```shell-session\n$ kitchen list\nInstance             Driver  Provisioner      Last Action\ndefault-ubuntu-1204  Docker  AnsiblePlaybook  <Not Created>\n```\n\n\n# \u53c2\u8003\n\n- test-kitchen\u306e\u3064\u304b\u3044\u304b\u305f - Qiita - http://qiita.com/sawanoboly/items/9f560bd63ad0712b17ba\n- (\u30e1\u30e2)Chef+Docker+Test-kitchen+Serverspec - Qiita - http://qiita.com/nakashii_/items/ccaf80bc830a18063540\n", "tags": ["docker", "test-kitchen", "Ansible"]}