{"context": "\nEC2\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30b0\u30eb\u30fc\u30d7\u306e\u8a2d\u5b9a\u304b\u3089\u30a4\u30f3\u30d0\u30a6\u30f3\u30c9\u306e\u30bf\u30d6\u3092\u9078\u3073\u300c\u7de8\u96c6\u300d\u3092\u62bc\u3057\u3001HTTP\u304b\u3089\u306e\u30a2\u30af\u30bb\u30b9\u3092\u8a31\u53ef\u3002\nec2-user\u3067\u30ed\u30b0\u30a4\u30f3\n\n\u30b7\u30b9\u30c6\u30e0\u30ed\u30b1\u30fc\u30eb\u3092\u5909\u66f4\n$ sudo bash\n# vi /etc/sysconfig/i18n\n- LANG=en_US.UTF-8\n+ LANG=ja_JP.UTF-8\n\n\n\n\u30b7\u30b9\u30c6\u30e0\u30ed\u30b1\u30fc\u30eb\u306e\u6709\u52b9\u5316\n# . /etc/sysconfig/i18n\n\n\n\n\u30bf\u30a4\u30e0\u30be\u30fc\u30f3\u3092\u65e5\u672c\u306b\u5909\u66f4\n# cp /etc/localtime /etc/localtime.orig\n# ln -sf /usr/share/zoneinfo/Asia/Tokyo /etc/localtime\n# vi /etc/sysconfig/clock\n- ZONE=\"Asia/Tokyo\"\n- UTC=true\n+ ZONE=\"Asia/Tokyo\"\n+ UTC=false\n\n\n\n\u4e0d\u8981\u306ahttpd/php\u3092\u30a2\u30f3\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n# yum erase php php-cli php-common\n# yum erase httpd httpd-tools\n\n\n\nPHP7\u3068postgresql\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\uff08\u3064\u3044\u3067\u306bmlocate\u3082\uff09\n# yum -y install php70 php70-intl php70-mbstring php70-pgsql php70-pdo\n# yum -y install postgresql95 postgresql95-server postgresql95-devel\n# yum -y install mlocate\n\n\n\ncomposer\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\u3053\u3061\u3089\u306eURL\u306eCommand-line installation\u306e\u90e8\u5206\u3092\u5b9f\u884c\u3057\u3066\u304f\u3060\u3055\u3044\uff1a\nhttps://getcomposer.org/download/\n\u4ee5\u4e0b\u306f\u30b5\u30f3\u30d7\u30eb\u3067\u3059\uff1a\n# php -r \"copy('https://getcomposer.org/installer', 'composer-setup.php');\"\n# php -r \"if (hash_file('SHA384', 'composer-setup.php') ===     'aa96f26c2b67226a324c27919f1eb05f21c248b987e6195cad9690d5c1ff713d53020a02ac8c217dbf90a7eacc9d141d') { echo 'Installer verified'; } else { echo 'Installer     corrupt'; unlink('composer-setup.php'); } echo PHP_EOL;\"\n# php composer-setup.php\n# php -r \"unlink('composer-setup.php');\"\n\n\n\ncomposer.phar\u3092\u79fb\u52d5\u3055\u305b\u307e\u3059\n# mv composer.phar /usr/local/bin/composer\n\n\n\nec2-user\u306ePATH\u306b/usr/local/bin\u3092\u8ffd\u52a0\n# exit \n$ cd\n$ vi /home/ec2-user/.bash_profile\n- PATH=$PATH:$HOME/.local/bin:$HOME/bin\n+ PATH=$PATH:$HOME/.local/bin:$HOME/bin:/usr/local/bin\n\n\n\ncakephp3\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092\u66f8\u304d\u8fbc\u307f\u53ef\u80fd\u306b\n$ sudo bash\n# cd /var/www\n# chmod 777 html\n# exit\n\n\n\ncakephp3\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n$ source /home/ec2-user/.bash_profile\n$ cd /var/www/html\n$ composer self-update && composer create-project --prefer-dist cakephp/app ./\n\n\u9014\u4e2d\u3067Set Folder Permissions\u306b\u3064\u3044\u3066\u805e\u304b\u308c\u305f\u3089Yes\u3068\u56de\u7b54\uff1a\nSet Folder Permissions ? (Default to Y) [Y,n]? Y\n\n\n\n\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306e\u8a2d\u5b9a\u3092\u5909\u66f4\uff08default\uff09\n\u5909\u66f4\u7b87\u6240\u306fapp.php\u306e223\uff5e234\u884c\n$ vi /var/www/html/config/app.php\n-             'driver' => 'Cake\\Database\\Driver\\Mysql',\n+             'driver' => 'Cake\\Database\\Driver\\Postgres',\n-             'username' => 'my_app',\n+             'username' => 'postgres',\n-             'password' => 'secret',\n+             'password' => '',\n-             'database' => 'my_app',\n+             'database' => 'cakephp_dev',\n\n\n\n\u30bf\u30a4\u30e0\u30be\u30fc\u30f3\u3092\u5909\u66f4\n\n/var/www/html/config/bootstrap.php\n- date_default_timezone_set('UTC');\n+ date_default_timezone_set('Asia/Tokyo');\n\n\n\n\n\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306e\u8a2d\u5b9a\u3092\u5909\u66f4\uff08test\uff09\n\u624b\u980611\u3068\u540c\u3058\u3060\u304c\u3001\u5909\u66f4\u7b87\u6240\u306fapp.php\u306e268\uff5e274\u884c\u3002\n\u307e\u305f'database' => 'cakephp_test'\u3068\u3059\u308b\n\n\nURL\u306e\u30ea\u30e9\u30a4\u30c8\u3092\u53ef\u80fd\u306b\u3059\u308b\n\u5909\u66f4\u7b87\u6240\u306f/etc/httpd/conf/httpd.conf\u306e151\u884c\u76ee\n$ sudo bash\n# vi /etc/httpd/conf/httpd.conf\n\n- AllowOverride None\n+ AllowOverride All\n\n\n\n\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306e\u521d\u671f\u5316\n# su - postgres\n$ /usr/lib64/pgsql95/bin/initdb -D /var/lib/pgsql95/data/\n$ exit\n\n\n\npostgresql\u3068httpd\u306e\u8d77\u52d5\n# service httpd start\n# service postgresql95 start\n\n\n\n\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306e\u4f5c\u6210\n# /usr/bin/createdb -U postgres -p 5432 -h localhost cakephp_dev\n\n\n\n\u52d5\u4f5c\u78ba\u8a8d\n\u30d6\u30e9\u30a6\u30b6\u3092\u958b\u304d\u3001ec2\u306e\u30d1\u30d6\u30ea\u30c3\u30afIP\u3092\u6307\u5b9a\u3059\u308b\n\n\n1. EC2\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n2. \u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30b0\u30eb\u30fc\u30d7\u306e\u8a2d\u5b9a\u304b\u3089\u30a4\u30f3\u30d0\u30a6\u30f3\u30c9\u306e\u30bf\u30d6\u3092\u9078\u3073\u300c\u7de8\u96c6\u300d\u3092\u62bc\u3057\u3001HTTP\u304b\u3089\u306e\u30a2\u30af\u30bb\u30b9\u3092\u8a31\u53ef\u3002\n3. ec2-user\u3067\u30ed\u30b0\u30a4\u30f3\n4. \u30b7\u30b9\u30c6\u30e0\u30ed\u30b1\u30fc\u30eb\u3092\u5909\u66f4\n\n    ```\n    $ sudo bash\n    # vi /etc/sysconfig/i18n\n    - LANG=en_US.UTF-8\n    + LANG=ja_JP.UTF-8\n    ```\n\n5. \u30b7\u30b9\u30c6\u30e0\u30ed\u30b1\u30fc\u30eb\u306e\u6709\u52b9\u5316\n\n    ```\n    # . /etc/sysconfig/i18n\n    ```\n\n6. \u30bf\u30a4\u30e0\u30be\u30fc\u30f3\u3092\u65e5\u672c\u306b\u5909\u66f4\n\n    ```\n    # cp /etc/localtime /etc/localtime.orig\n    # ln -sf /usr/share/zoneinfo/Asia/Tokyo /etc/localtime\n    # vi /etc/sysconfig/clock\n    - ZONE=\"Asia/Tokyo\"\n    - UTC=true\n    + ZONE=\"Asia/Tokyo\"\n    + UTC=false\n    ```\n\n5. \u4e0d\u8981\u306ahttpd/php\u3092\u30a2\u30f3\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n    ```\n    # yum erase php php-cli php-common\n    # yum erase httpd httpd-tools\n    ```\n\n6. PHP7\u3068postgresql\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\uff08\u3064\u3044\u3067\u306bmlocate\u3082\uff09\n\n    ```\n    # yum -y install php70 php70-intl php70-mbstring php70-pgsql php70-pdo\n    # yum -y install postgresql95 postgresql95-server postgresql95-devel\n    # yum -y install mlocate\n    ```\n\n7. composer\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n    \u3053\u3061\u3089\u306eURL\u306eCommand-line installation\u306e\u90e8\u5206\u3092\u5b9f\u884c\u3057\u3066\u304f\u3060\u3055\u3044\uff1a\n    https://getcomposer.org/download/\n    \u4ee5\u4e0b\u306f\u30b5\u30f3\u30d7\u30eb\u3067\u3059\uff1a\n\n    ```\n    # php -r \"copy('https://getcomposer.org/installer', 'composer-setup.php');\"\n    # php -r \"if (hash_file('SHA384', 'composer-setup.php') ===     'aa96f26c2b67226a324c27919f1eb05f21c248b987e6195cad9690d5c1ff713d53020a02ac8c217dbf90a7eacc9d141d') { echo 'Installer verified'; } else { echo 'Installer     corrupt'; unlink('composer-setup.php'); } echo PHP_EOL;\"\n    # php composer-setup.php\n    # php -r \"unlink('composer-setup.php');\"\n    ```\n\n1. composer.phar\u3092\u79fb\u52d5\u3055\u305b\u307e\u3059\n\n    ```\n    # mv composer.phar /usr/local/bin/composer\n    ```\n\n8. ec2-user\u306ePATH\u306b/usr/local/bin\u3092\u8ffd\u52a0\n\n    ```\n    # exit \n    $ cd\n    $ vi /home/ec2-user/.bash_profile\n    - PATH=$PATH:$HOME/.local/bin:$HOME/bin\n    + PATH=$PATH:$HOME/.local/bin:$HOME/bin:/usr/local/bin\n    ```\n\n9. cakephp3\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092\u66f8\u304d\u8fbc\u307f\u53ef\u80fd\u306b\n\n    ```\n    $ sudo bash\n    # cd /var/www\n    # chmod 777 html\n    # exit\n    ```\n\n10. cakephp3\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n    ```\n    $ source /home/ec2-user/.bash_profile\n    $ cd /var/www/html\n    $ composer self-update && composer create-project --prefer-dist cakephp/app ./\n    ```\n\n    \u9014\u4e2d\u3067Set Folder Permissions\u306b\u3064\u3044\u3066\u805e\u304b\u308c\u305f\u3089Yes\u3068\u56de\u7b54\uff1a\n\n    ```\n    Set Folder Permissions ? (Default to Y) [Y,n]? Y\n    ```\n\n11. \u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306e\u8a2d\u5b9a\u3092\u5909\u66f4\uff08default\uff09\n\n    \u5909\u66f4\u7b87\u6240\u306fapp.php\u306e223\uff5e234\u884c\n\n    ```\n    $ vi /var/www/html/config/app.php\n    -             'driver' => 'Cake\\Database\\Driver\\Mysql',\n    +             'driver' => 'Cake\\Database\\Driver\\Postgres',\n    -             'username' => 'my_app',\n    +             'username' => 'postgres',\n    -             'password' => 'secret',\n    +             'password' => '',\n    -             'database' => 'my_app',\n    +             'database' => 'cakephp_dev',\n    ```\n\n12. \u30bf\u30a4\u30e0\u30be\u30fc\u30f3\u3092\u5909\u66f4\n\n    ```/var/www/html/config/bootstrap.php\n    - date_default_timezone_set('UTC');\n    + date_default_timezone_set('Asia/Tokyo');\n    ```\n\n12. \u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306e\u8a2d\u5b9a\u3092\u5909\u66f4\uff08test\uff09\n\n    \u624b\u980611\u3068\u540c\u3058\u3060\u304c\u3001\u5909\u66f4\u7b87\u6240\u306fapp.php\u306e268\uff5e274\u884c\u3002\n    \u307e\u305f'database' => 'cakephp_test'\u3068\u3059\u308b\n\n13. URL\u306e\u30ea\u30e9\u30a4\u30c8\u3092\u53ef\u80fd\u306b\u3059\u308b\n\n    \u5909\u66f4\u7b87\u6240\u306f/etc/httpd/conf/httpd.conf\u306e151\u884c\u76ee\n\n    ```\n    $ sudo bash\n    # vi /etc/httpd/conf/httpd.conf\n    \n    - AllowOverride None\n    + AllowOverride All\n    ```\n\n14. \u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306e\u521d\u671f\u5316\n\n    ```\n    # su - postgres\n    $ /usr/lib64/pgsql95/bin/initdb -D /var/lib/pgsql95/data/\n    $ exit\n    ```\n\n15. postgresql\u3068httpd\u306e\u8d77\u52d5\n\n    ```\n    # service httpd start\n    # service postgresql95 start\n    ```\n\n16. \u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306e\u4f5c\u6210\n\n    ```\n    # /usr/bin/createdb -U postgres -p 5432 -h localhost cakephp_dev\n    ```\n\n17. \u52d5\u4f5c\u78ba\u8a8d\n\n    \u30d6\u30e9\u30a6\u30b6\u3092\u958b\u304d\u3001ec2\u306e\u30d1\u30d6\u30ea\u30c3\u30afIP\u3092\u6307\u5b9a\u3059\u308b\n", "tags": ["EC2", "AWS", "cakephp3", "PostgreSQL"]}