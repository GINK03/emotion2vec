{"tags": ["cobol", "PostgreSQL", "Mac"], "context": "OSS\u30b3\u30f3\u30bd\u30fc\u30b7\u30a2\u30e0\u306e\u30aa\u30fc\u30d7\u30f3COBOL\u30bd\u30ea\u30e5\u30fc\u30b7\u30e7\u30f3\u90e8\u4f1a\u304c\u63d0\u4f9b\u3059\u308b Open COBOL ESQL \u3092Mac\u306b\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u3066\u3001PostgreSQL\u306b\u30a2\u30af\u30bb\u30b9\u3059\u308bCOBOL\u30d7\u30ed\u30b0\u30e9\u30e0\u3092\u30b3\u30f3\u30d1\u30a4\u30eb\u30fb\u52d5\u4f5c\u3055\u305b\u307e\u3059\u3002\n\n\u524d\u63d0\u6761\u4ef6\nOpen COBOL ESQL\u306e\u30b3\u30f3\u30d1\u30a4\u30eb\u306b\u5fc5\u8981\u306aPostgreSQL\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u3066\u304f\u3060\u3055\u3044\u3002\nopensource COBOL\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u3066\u3001COBOL\u30d7\u30ed\u30b0\u30e9\u30e0\u3092\u30b3\u30f3\u30d1\u30a4\u30eb\u3067\u304d\u308b\u3088\u3046\u306b\u3057\u3066\u304f\u3060\u3055\u3044\u3002opensource COBOL\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u306b\u3064\u3044\u3066\u306f\u3053\u3061\u3089\u306e\u8a18\u4e8b\u304c\u53c2\u8003\u306b\u306a\u308a\u307e\u3059\u3002\n\nOpen COBOL ESQL \u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\nOpen COBOL ESQL\u306e\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u30b5\u30a4\u30c8\u304b\u3089Open COBOL ESQL\u306e\u30bd\u30fc\u30b9\u30d1\u30c3\u30b1\u30fc\u30b8(2017\u5e742\u67089\u65e5\u6642\u70b9\u3067\u306focesql-1.1.0.tar.gz)\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3057\u307e\u3059\u3002\nOpen COBOL ESQL\u306e\u30bd\u30fc\u30b9\u30d1\u30c3\u30b1\u30fc\u30b8\u3092\u5c55\u958b\u3057\u3001#include <malloc.h>\u3092#include <stdlib.h>\u306b\u7f6e\u304d\u63db\u3048\u307e\u3059\u3002\u7f6e\u304d\u63db\u3048\u3092\u3057\u306a\u3044\u3068\u3001fatal error: 'malloc.h' file not found\u306e\u30a8\u30e9\u30fc\u3067\u30b3\u30f3\u30d1\u30a4\u30eb\u304c\u5931\u6557\u3057\u307e\u3059\u3002\n$ tar zxf ocesql-1.1.0.tar.gz\n$ cd ocesql-1.1.0\n\n$ sed s/\"\\#include \\<malloc.h\\>\"/\"\\#include \\<stdlib.h\\>\"/g dblib/ocdb.c > tmp\n$ mv tmp dblib/ocdb.c\n$ sed s/\"\\#include \\<malloc.h\\>\"/\"\\#include \\<stdlib.h\\>\"/g dblib/ocdbutil.c > tmp\n$ mv tmp dblib/ocdbutil.c\n$ sed s/\"\\#include \\<malloc.h\\>\"/\"\\#include \\<stdlib.h\\>\"/g dblib/ocesql.c > tmp\n$ mv tmp dblib/ocesql.c\n$ sed s/\"\\#include \\<malloc.h\\>\"/\"\\#include \\<stdlib.h\\>\"/g dblib/ocpgsql.c > tmp\n$ mv tmp dblib/ocpgsql.c\n$ sed s/\"\\#include \\<malloc.h\\>\"/\"\\#include \\<stdlib.h\\>\"/g ocesql/parser.c > tmp\n$ mv tmp ocesql/parser.c\n\nPostgreSQL\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306einclude\u3068lib\u3092CPPFLAGS\u3068LDFLAGS\u306b\u8a2d\u5b9a\u3057\u305f\u4e0a\u3067\u3001Open COBOL ESQL\u3092\u30b3\u30f3\u30d1\u30a4\u30eb\u3001\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\n$ export CPPFLAGS=\"-I/opt/pgsql/include\"\n$ export LDFLAGS=\"-L/opt/pgsql/lib\"\n$ ./configure\n$ make\n$ sudo make install\n\n\nPostgreSQL\u306b\u30a2\u30af\u30bb\u30b9\u3059\u308bCOBOL\u30d7\u30ed\u30b0\u30e9\u30e0\u306e\u4f5c\u6210\u3068\u5b9f\u884c\n\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb randomnum.cbl (\u62e1\u5f35\u5b50\u306fcbl) \u306b\u4ee5\u4e0b\u306e\u3068\u304a\u308a\u30b3\u30fc\u30c7\u30a3\u30f3\u30b0\u3057\u307e\u3059\u3002\u30b3\u30fc\u30c9\u306e\u5404\u884c\u306f8\u6841\u76ee\u4ee5\u964d\u304b\u3089\u59cb\u307e\u3063\u3066\u3044\u308b\u3053\u3068\u306b\u6ce8\u610f\u3057\u3066\u304f\u3060\u3055\u3044\u3002\u3053\u306eCOBOL\u30d7\u30ed\u30b0\u30e9\u30e0\u306f\u3001PostgreSQL\u306b\u30a2\u30af\u30bb\u30b9\u3057\u3066\u3001\u30e9\u30f3\u30c0\u30e0\u306a\u6574\u6570\u3092\u53d6\u5f97\u3057\u3001\u8868\u793a\u3057\u307e\u3059\u3002\n       IDENTIFICATION DIVISION.\n       PROGRAM-ID. RANDOMNUM.\n\n       DATA DIVISION.\n       WORKING-STORAGE SECTION.\n       01 RET       PIC 9(3).\n\n       EXEC SQL BEGIN DECLARE SECTION END-EXEC.\n       01 DBNAME    PIC X(32) VALUE \"postgres\".\n       01 USERNAME  PIC X(32) VALUE \"postgres\".\n       01 PASSWORD  PIC X(32) VALUE SPACE.\n       EXEC SQL END DECLARE SECTION END-EXEC.\n\n       EXEC SQL INCLUDE SQLCA END-EXEC.\n\n       PROCEDURE DIVISION.\n       MAIN.\n            EXEC SQL\n                CONNECT :USERNAME IDENTIFIED BY :PASSWORD\n                    USING :DBNAME\n            END-EXEC.\n\n            EXEC SQL\n                SELECT round(random()*100) INTO :RET\n            END-EXEC.\n\n            EXEC SQL\n                DISCONNECT ALL\n            END-EXEC.\n\n            DISPLAY RET.\n            STOP RUN.\n\nOpen COBOL ESQL \u3067\u30d7\u30ea\u30b3\u30f3\u30d1\u30a4\u30eb\u3057\u307e\u3059\u3002\n$ ocesql randomnum.cbl randomnum.cob\n\n\u6b21\u306b\u3001\u74b0\u5883\u5909\u6570COBCPY\u306b Open COBOL ESQL \u30bd\u30fc\u30b9\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u914d\u4e0b\u306ecopy\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306e\u30d1\u30b9\u3092\u6307\u5b9a\u3057\u305f\u4e0a\u3067\u3001\u30b3\u30f3\u30d1\u30a4\u30eb\u5bfe\u8c61\u306e\u30d5\u30a1\u30a4\u30eb\u306f\u3001\u30d7\u30ea\u30b3\u30f3\u30d1\u30a4\u30eb\u7d50\u679c\u306e randomnum.cob (\u62e1\u5f35\u5b50\u304ccob) \u3092\u30b3\u30f3\u30d1\u30a4\u30eb\u3057\u307e\u3059\u3002\u30b3\u30f3\u30d1\u30a4\u30eb\u6642\u306b\u306f\u3001PostgreSQL\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306elib\u3092-L\u306b\u6307\u5b9a\u3057\u3001\u307e\u305f-locesql\u3068-lpq\u3082\u6307\u5b9a\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n$ export COBCPY=/opt/ocesql-1.1.0/copy\n$ cobc -x -locesql -lpq -L/opt/pgsql/lib randomnum.cob\n\n\u6700\u5f8c\u306b\u3001PostgreSQL\u3092\u5225\u9014\u8d77\u52d5\u3057\u305f\u4e0a\u3067\u3001COBOL\u30d7\u30ed\u30b0\u30e9\u30e0\u3092\u5b9f\u884c\u3057\u307e\u3059\u3002\n## \u4e8b\u524d\u306bPostgreSQL\u3092\u8d77\u52d5\u3057\u3066\u304a\u304f\u3053\u3068\n\n$ ./randomnum\n060\n$ ./randomnum\n083\n\n[OSS\u30b3\u30f3\u30bd\u30fc\u30b7\u30a2\u30e0](https://www.osscons.jp/)\u306e[\u30aa\u30fc\u30d7\u30f3COBOL\u30bd\u30ea\u30e5\u30fc\u30b7\u30e7\u30f3\u90e8\u4f1a](https://www.osscons.jp/osscobol/)\u304c\u63d0\u4f9b\u3059\u308b Open COBOL ESQL \u3092Mac\u306b\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u3066\u3001PostgreSQL\u306b\u30a2\u30af\u30bb\u30b9\u3059\u308bCOBOL\u30d7\u30ed\u30b0\u30e9\u30e0\u3092\u30b3\u30f3\u30d1\u30a4\u30eb\u30fb\u52d5\u4f5c\u3055\u305b\u307e\u3059\u3002\n\n# \u524d\u63d0\u6761\u4ef6\n\nOpen COBOL ESQL\u306e\u30b3\u30f3\u30d1\u30a4\u30eb\u306b\u5fc5\u8981\u306aPostgreSQL\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n[opensource COBOL](https://www.osscons.jp/osscobol/download/?_restful_permalink=osscobol/download/)\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u3066\u3001COBOL\u30d7\u30ed\u30b0\u30e9\u30e0\u3092\u30b3\u30f3\u30d1\u30a4\u30eb\u3067\u304d\u308b\u3088\u3046\u306b\u3057\u3066\u304f\u3060\u3055\u3044\u3002opensource COBOL\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u306b\u3064\u3044\u3066\u306f[\u3053\u3061\u3089\u306e\u8a18\u4e8b](http://qiita.com/fujii_masao/items/ce57288ba8dd18859fbf)\u304c\u53c2\u8003\u306b\u306a\u308a\u307e\u3059\u3002\n\n# Open COBOL ESQL \u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\nOpen COBOL ESQL\u306e[\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u30b5\u30a4\u30c8](https://www.osscons.jp/osscobol/download/addtools/)\u304b\u3089Open COBOL ESQL\u306e\u30bd\u30fc\u30b9\u30d1\u30c3\u30b1\u30fc\u30b8(2017\u5e742\u67089\u65e5\u6642\u70b9\u3067\u306f[ocesql-1.1.0.tar.gz](http://www.osscons.jp/osscobol/files?action=cabinet_action_main_download&block_id=414&room_id=21&cabinet_id=11&file_id=313&upload_id=594))\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3057\u307e\u3059\u3002\n\nOpen COBOL ESQL\u306e\u30bd\u30fc\u30b9\u30d1\u30c3\u30b1\u30fc\u30b8\u3092\u5c55\u958b\u3057\u3001```#include <malloc.h>```\u3092```#include <stdlib.h>```\u306b\u7f6e\u304d\u63db\u3048\u307e\u3059\u3002\u7f6e\u304d\u63db\u3048\u3092\u3057\u306a\u3044\u3068\u3001```fatal error: 'malloc.h' file not found```\u306e\u30a8\u30e9\u30fc\u3067\u30b3\u30f3\u30d1\u30a4\u30eb\u304c\u5931\u6557\u3057\u307e\u3059\u3002\n\n```bash\n$ tar zxf ocesql-1.1.0.tar.gz\n$ cd ocesql-1.1.0\n\n$ sed s/\"\\#include \\<malloc.h\\>\"/\"\\#include \\<stdlib.h\\>\"/g dblib/ocdb.c > tmp\n$ mv tmp dblib/ocdb.c\n$ sed s/\"\\#include \\<malloc.h\\>\"/\"\\#include \\<stdlib.h\\>\"/g dblib/ocdbutil.c > tmp\n$ mv tmp dblib/ocdbutil.c\n$ sed s/\"\\#include \\<malloc.h\\>\"/\"\\#include \\<stdlib.h\\>\"/g dblib/ocesql.c > tmp\n$ mv tmp dblib/ocesql.c\n$ sed s/\"\\#include \\<malloc.h\\>\"/\"\\#include \\<stdlib.h\\>\"/g dblib/ocpgsql.c > tmp\n$ mv tmp dblib/ocpgsql.c\n$ sed s/\"\\#include \\<malloc.h\\>\"/\"\\#include \\<stdlib.h\\>\"/g ocesql/parser.c > tmp\n$ mv tmp ocesql/parser.c\n```\n\nPostgreSQL\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306einclude\u3068lib\u3092CPPFLAGS\u3068LDFLAGS\u306b\u8a2d\u5b9a\u3057\u305f\u4e0a\u3067\u3001Open COBOL ESQL\u3092\u30b3\u30f3\u30d1\u30a4\u30eb\u3001\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\n\n```bash\n$ export CPPFLAGS=\"-I/opt/pgsql/include\"\n$ export LDFLAGS=\"-L/opt/pgsql/lib\"\n$ ./configure\n$ make\n$ sudo make install\n```\n\n# PostgreSQL\u306b\u30a2\u30af\u30bb\u30b9\u3059\u308bCOBOL\u30d7\u30ed\u30b0\u30e9\u30e0\u306e\u4f5c\u6210\u3068\u5b9f\u884c\n\n\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb randomnum.cbl (\u62e1\u5f35\u5b50\u306fcbl) \u306b\u4ee5\u4e0b\u306e\u3068\u304a\u308a\u30b3\u30fc\u30c7\u30a3\u30f3\u30b0\u3057\u307e\u3059\u3002\u30b3\u30fc\u30c9\u306e\u5404\u884c\u306f8\u6841\u76ee\u4ee5\u964d\u304b\u3089\u59cb\u307e\u3063\u3066\u3044\u308b\u3053\u3068\u306b\u6ce8\u610f\u3057\u3066\u304f\u3060\u3055\u3044\u3002\u3053\u306eCOBOL\u30d7\u30ed\u30b0\u30e9\u30e0\u306f\u3001PostgreSQL\u306b\u30a2\u30af\u30bb\u30b9\u3057\u3066\u3001\u30e9\u30f3\u30c0\u30e0\u306a\u6574\u6570\u3092\u53d6\u5f97\u3057\u3001\u8868\u793a\u3057\u307e\u3059\u3002\n\n```cobol\n       IDENTIFICATION DIVISION.\n       PROGRAM-ID. RANDOMNUM.\n\n       DATA DIVISION.\n       WORKING-STORAGE SECTION.\n       01 RET       PIC 9(3).\n\n       EXEC SQL BEGIN DECLARE SECTION END-EXEC.\n       01 DBNAME    PIC X(32) VALUE \"postgres\".\n       01 USERNAME  PIC X(32) VALUE \"postgres\".\n       01 PASSWORD  PIC X(32) VALUE SPACE.\n       EXEC SQL END DECLARE SECTION END-EXEC.\n\n       EXEC SQL INCLUDE SQLCA END-EXEC.\n\n       PROCEDURE DIVISION.\n       MAIN.\n            EXEC SQL\n                CONNECT :USERNAME IDENTIFIED BY :PASSWORD\n                    USING :DBNAME\n            END-EXEC.\n\n            EXEC SQL\n                SELECT round(random()*100) INTO :RET\n            END-EXEC.\n\n            EXEC SQL\n                DISCONNECT ALL\n            END-EXEC.\n\n            DISPLAY RET.\n            STOP RUN.\n```\n\nOpen COBOL ESQL \u3067\u30d7\u30ea\u30b3\u30f3\u30d1\u30a4\u30eb\u3057\u307e\u3059\u3002\n\n```bash\n$ ocesql randomnum.cbl randomnum.cob\n```\n\n\u6b21\u306b\u3001\u74b0\u5883\u5909\u6570COBCPY\u306b Open COBOL ESQL \u30bd\u30fc\u30b9\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u914d\u4e0b\u306ecopy\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306e\u30d1\u30b9\u3092\u6307\u5b9a\u3057\u305f\u4e0a\u3067\u3001\u30b3\u30f3\u30d1\u30a4\u30eb\u5bfe\u8c61\u306e\u30d5\u30a1\u30a4\u30eb\u306f\u3001\u30d7\u30ea\u30b3\u30f3\u30d1\u30a4\u30eb\u7d50\u679c\u306e randomnum.cob (\u62e1\u5f35\u5b50\u304ccob) \u3092\u30b3\u30f3\u30d1\u30a4\u30eb\u3057\u307e\u3059\u3002\u30b3\u30f3\u30d1\u30a4\u30eb\u6642\u306b\u306f\u3001PostgreSQL\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306elib\u3092```-L```\u306b\u6307\u5b9a\u3057\u3001\u307e\u305f```-locesql```\u3068```-lpq```\u3082\u6307\u5b9a\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n```bash\n$ export COBCPY=/opt/ocesql-1.1.0/copy\n$ cobc -x -locesql -lpq -L/opt/pgsql/lib randomnum.cob\n```\n\n\u6700\u5f8c\u306b\u3001PostgreSQL\u3092\u5225\u9014\u8d77\u52d5\u3057\u305f\u4e0a\u3067\u3001COBOL\u30d7\u30ed\u30b0\u30e9\u30e0\u3092\u5b9f\u884c\u3057\u307e\u3059\u3002\n\n```bash\n## \u4e8b\u524d\u306bPostgreSQL\u3092\u8d77\u52d5\u3057\u3066\u304a\u304f\u3053\u3068\n\n$ ./randomnum\n060\n$ ./randomnum\n083\n```\n"}