{"tags": ["JScript"], "context": " More than 1 year has passed since last update.\n\n\u6e96\u5099\nSQL\u6587\u3092\u5b9f\u884c\u3057\u3066\u307f\u307e\u3059\u3002\n\u307e\u305a\u3001\u4ee5\u4e0b\u306e\u69d8\u306a\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3068\u30c6\u30fc\u30d6\u30eb\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u540d\uff1atestdb\n\u30c6\u30fc\u30d6\u30eb\u540d\uff1atesttable\n\n\n\n\u5217\u540d\n\u30c7\u30fc\u30bf\u578b\n\n\n\n\nnum\nint\n\n\nstr\nvarchar(50)\n\n\ndate\ndatetime\n\n\n\n\u307e\u305f\u3001\u5171\u901a\u95a2\u6570\u3092\u7528\u610f\u3057\u307e\u3059\u3002\nvar driver = \"{SQL Server}\";          // ODBC\u30c9\u30e9\u30a4\u30d0\nvar server = \"localhost\\\\SQLEXPRESS\"; // \u30b5\u30fc\u30d0\nvar database = \"testdb\";              // \u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\nvar user = \"sa\";                      // \u30e6\u30fc\u30b6\nvar pass = \"*****\";                   // \u30d1\u30b9\u30ef\u30fc\u30c9\n\n/**\n * \u300cConnection\u300d\u63a5\u7d9a\n */\nfunction openConnection() {\n    // \u300cConnection\u300d\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u751f\u6210\n    var con = new ActiveXObject(\"ADODB.Connection\");\n    // \u63a5\u7d9a\u6587\u5b57\u5217\u8a2d\u5b9a\n    con.ConnectionString = \"Provider=MSDASQL\" // \u30d7\u30ed\u30d0\u30a4\u30c0\n        + \";DRIVER=\" + driver                 // ODBC\u30c9\u30e9\u30a4\u30d0\n        + \";SERVER=\" + server                 // \u30b5\u30fc\u30d0\n        + \";DATABASE=\" + database             // \u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\n        + \";UID=\" + user                      // \u30e6\u30fc\u30b6\n        + \";PWD=\" + pass;                     // \u30d1\u30b9\u30ef\u30fc\u30c9\n    // \u63a5\u7d9a\n    con.Open();\n    return con;\n}\n\n/**\n * \u300cConnection\u300d\u5207\u65ad\n */\nfunction closeConnection(con) {\n    try {\n        // \u30b9\u30c6\u30fc\u30bf\u30b9\u30c1\u30a7\u30c3\u30af\n        if (con && con.State == 1) {\n            // \u5207\u65ad\n            con.Close();\n        }\n    } catch (e) {\n        // \u30a8\u30e9\u30fc\u306e\u5834\u5408\n        WScript.Echo(\"Error(\" + (e.number & 0xFFFF) + \"):\" + e.message);\n    }\n}\n\n/**\n * \u65e5\u4ed8\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\n */\nfunction df(date) {\n    var ret = null;\n    if (date && date instanceof Date) {\n        ret = date.getFullYear() + \"-\"\n            + (\"0\" + (date.getMonth() + 1)).slice(-2) + \"-\"\n            + (\"0\" + date.getDate()).slice(-2) + \" \"\n            + (\"0\" + date.getHours()).slice(-2) + \":\"\n            + (\"0\" + date.getMinutes()).slice(-2) + \":\"\n            + (\"0\" + date.getSeconds()).slice(-2);\n    }\n    return ret;\n}\n\n\nSELECT\n\u300cSELECT\u300d\u6587\u306e\u30b5\u30f3\u30d7\u30eb\u3067\u3059\u3002\nSQL\u30a4\u30f3\u30b8\u30a7\u30af\u30b7\u30e7\u30f3\u5bfe\u7b56\u7528\u306b\u3001\u300cADODB.Command\u300d\u3092\u5229\u7528\u3057\u3066\u30d1\u30e9\u30e1\u30fc\u30bf\u3092\u8a2d\u5b9a\u3057\u3066\u3044\u307e\u3059\u3002\n// \u300cConnection\u300d\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u7528\u5909\u6570\nvar con = null;\n// \u300cRecordset\u300d\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u7528\u5909\u6570\nvar rs = null;\ntry {\n    // \u63a5\u7d9a\n    con = openConnection();\n    // \u300cCommand\u300d\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u751f\u6210\n    var cmd = new ActiveXObject(\"ADODB.Command\");\n    // \u300cConnection\u300d\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u8a2d\u5b9a\n    cmd.ActiveConnection = con;\n    // \u30b3\u30de\u30f3\u30c9\u30bf\u30a4\u30d7\u3092\u30c6\u30ad\u30b9\u30c8(1)\u306b\u8a2d\u5b9a\n    cmd.CommandType = 1;\n    // \u300cPrepared\u300d\u3092\u771f\u306b\u8a2d\u5b9a\n    cmd.Prepared = true;\n    // \u767a\u884c\u3059\u308b\u30b3\u30de\u30f3\u30c9\u6587\u5b57\u5217(SQL\u6587)\u3092\u8a2d\u5b9a \n    cmd.CommandText = \"SELECT * FROM testtable WHERE num > ?\";\n    // \u30d1\u30e9\u30e1\u30fc\u30bf\u3092\u8a2d\u5b9a\n    cmd.Parameters(0).Value = 0;\n    // \u5b9f\u884c\n    rs = cmd.Execute();\n    // \u884c\u756a\u53f7\n    var row = 1;\n    // \u300cRecordset\u300d\u304c\u6700\u5f8c\u306b\u306a\u308b\u307e\u3067\u30eb\u30fc\u30d7\n    while (!rs.EOF) {\n        // \uff11\u884c\u6587\u5b57\u5217\n        var line = \"\" + row++;\n        // \u30d5\u30a3\u30fc\u30eb\u30c9\u6570\u5206\u30eb\u30fc\u30d7\n        for (var i = 0; i < rs.Fields.Count; i++) {\n            // \u30d5\u30a3\u30fc\u30eb\u30c9\u306e\u5024\u3001null\u5224\u5b9a\n            if (rs.Fields(i).Value != null) {\n                // \u30d5\u30a3\u30fc\u30eb\u30c9\u30bf\u30a4\u30d7\u5224\u5b9a\n                if (rs.Fields(i).Type == 135) {\n                    // \u300c\u65e5\u4ed8/\u6642\u523b\u30b9\u30bf\u30f3\u30d7\u300d\u578b\u3060\u3063\u305f\u306e\u3067\u3001\u65e5\u4ed8\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\n                    line += \" \" + df(new Date(rs.Fields(i).Value));\n                } else {\n                    // \u300c\u65e5\u4ed8/\u6642\u523b\u30b9\u30bf\u30f3\u30d7\u300d\u578b\u4ee5\u5916\u3060\u3063\u305f\u306e\u3067\u3001\u305d\u306e\u307e\u307e\n                    line += \" \" + rs.Fields(i).Value;\n                }\n            } else {\n                // null\u3060\u3063\u305f\u306e\u3067\u3001\u305d\u306e\u307e\u307e\n                line += \" \" + rs.Fields(i).Value;\n            }\n        }\n        // \uff11\u884c\u5206\u51fa\u529b\n        WScript.Echo(line);\n        // \u6b21\u306e\u884c\u3078\u79fb\u52d5\n        rs.MoveNext();\n    }\n} catch (e) {\n    // \u30a8\u30e9\u30fc\u306e\u5834\u5408\n    WScript.Echo(\"Error(\" + (e.number & 0xFFFF) + \"):\" + e.message);\n} finally {\n    try {\n        // \u30b9\u30c6\u30fc\u30bf\u30b9\u30c1\u30a7\u30c3\u30af\n        if (rs && rs.State == 1) {\n            // \u300cRecordset\u300d\u3092\u9589\u3058\u308b\n            rs.Close();\n        }\n    } catch (e) {\n        WScript.Echo(\"Error(\" + (e.number & 0xFFFF) + \"):\" + e.message);\n    }\n    // \u300cConnection\u300d\u5207\u65ad\n    closeConnection(con);\n}\n\n\nINSERT\n\u300cINSERT\u300d\u6587\u306e\u30b5\u30f3\u30d7\u30eb\u3067\u3059\u3002\n\u300cSELECT\u300d\u6587\u306e\u30b5\u30f3\u30d7\u30eb\u3068\u540c\u69d8\u306b\u3001\u300cSQL\u30a4\u30f3\u30b8\u30a7\u30af\u30b7\u30e7\u30f3\u5bfe\u7b56\u300d\u3092\u3057\u3066\u3044\u307e\u3059\u3002\n\u307e\u305f\u3001\u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3\u306b\u3088\u308b\u5236\u5fa1\u3082\u5165\u308c\u3066\u3044\u307e\u3059\u3002\n// \u300cConnection\u300d\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u7528\u5909\u6570\nvar con = null;\ntry {\n    // \u63a5\u7d9a\n    con = openConnection();\n    // \u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3\u958b\u59cb\n    con.BeginTrans();\n    // \u300cCommand\u300d\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u751f\u6210\n    var cmd = new ActiveXObject(\"ADODB.Command\");\n    // \u300cConnection\u300d\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u8a2d\u5b9a\n    cmd.ActiveConnection = con;\n    // \u30b3\u30de\u30f3\u30c9\u30bf\u30a4\u30d7\u3092\u30c6\u30ad\u30b9\u30c8(1)\u306b\u8a2d\u5b9a\n    cmd.CommandType = 1;\n    // \u300cPrepared\u300d\u3092\u771f\u306b\u8a2d\u5b9a\n    cmd.Prepared = true;\n    // \u767a\u884c\u3059\u308b\u30b3\u30de\u30f3\u30c9\u6587\u5b57\u5217(SQL\u6587)\u3092\u8a2d\u5b9a \n    cmd.CommandText = \"INSERT INTO testtable (num, str, date) VALUES (?, ?, GETDATE());\";\n    // \u30d1\u30e9\u30e1\u30fc\u30bf\u8a2d\u5b9a\n    cmd.Parameters(0).Value = 100;\n    cmd.Parameters(1).Value = \"string\";\n    // \u5b9f\u884c\n    cmd.Execute();\n    // \u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3\u3001\u30b3\u30df\u30c3\u30c8\n    con.CommitTrans();\n} catch (e) {\n    // \u30a8\u30e9\u30fc\u306e\u5834\u5408\n    WScript.Echo(\"Error(\" + (e.number & 0xFFFF) + \"):\" + e.message);\n    try {\n        // \u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3\u3001\u30ed\u30fc\u30eb\u30d0\u30c3\u30af\n        con.RollbackTrans();\n    } catch (e) {\n        // \u30a8\u30e9\u30fc\u306e\u5834\u5408\n        WScript.Echo(\"Error(\" + (e.number & 0xFFFF) + \"):\" + e.message);\n    }\n} finally {\n    // \u300cConnection\u300d\u5207\u65ad\n    closeConnection(con);\n}\n\n\nUPDATE\n\u300cUPDATE\u300d\u6587\u306e\u30b5\u30f3\u30d7\u30eb\u3067\u3059\u3002\n\u300cINSERT\u300d\u6587\u306e\u30b5\u30f3\u30d7\u30eb\u3068\u540c\u69d8\u306b\u3001\u300cSQL\u30a4\u30f3\u30b8\u30a7\u30af\u30b7\u30e7\u30f3\u5bfe\u7b56\u300d\u300c\u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3\u300d\u3092\u3057\u3066\u3044\u307e\u3059\u3002\n// \u300cConnection\u300d\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u7528\u5909\u6570\nvar con = null;\ntry {\n    // \u63a5\u7d9a\n    con = openConnection();\n    // \u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3\u958b\u59cb\n    con.BeginTrans();\n    // \u300cCommand\u300d\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u751f\u6210\n    var cmd = new ActiveXObject(\"ADODB.Command\");\n    // \u300cConnection\u300d\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u8a2d\u5b9a\n    cmd.ActiveConnection = con;\n    // \u30b3\u30de\u30f3\u30c9\u30bf\u30a4\u30d7\u3092\u30c6\u30ad\u30b9\u30c8(1)\u306b\u8a2d\u5b9a\n    cmd.CommandType = 1;\n    // \u300cPrepared\u300d\u3092\u771f\u306b\u8a2d\u5b9a\n    cmd.Prepared = true;\n    // \u767a\u884c\u3059\u308b\u30b3\u30de\u30f3\u30c9\u6587\u5b57\u5217(SQL\u6587)\u3092\u8a2d\u5b9a \n    cmd.CommandText = \"UPDATE testtable SET date = ? WHERE num = ?;\";\n    // \u30d1\u30e9\u30e1\u30fc\u30bf\u8a2d\u5b9a\n    cmd.Parameters(0).Value = df(new Date(new Date().getTime() - 3600000));\n    cmd.Parameters(1).Value = 100;\n    // \u5b9f\u884c\n    cmd.Execute();\n    // \u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3\u3001\u30b3\u30df\u30c3\u30c8\n    con.CommitTrans();\n} catch (e) {\n    // \u30a8\u30e9\u30fc\u306e\u5834\u5408\n    WScript.Echo(\"Error(\" + (e.number & 0xFFFF) + \"):\" + e.message);\n    try {\n        // \u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3\u3001\u30ed\u30fc\u30eb\u30d0\u30c3\u30af\n        con.RollbackTrans();\n    } catch (e) {\n        // \u30a8\u30e9\u30fc\u306e\u5834\u5408\n        WScript.Echo(\"Error(\" + (e.number & 0xFFFF) + \"):\" + e.message);\n    }\n} finally {\n    // \u300cConnection\u300d\u5207\u65ad\n    closeConnection(con);\n}\n\n\nDELETE\n\u300cDELETE\u300d\u6587\u306e\u30b5\u30f3\u30d7\u30eb\u3067\u3059\u3002\n\u300cINSERT\u300d\u6587\u306e\u30b5\u30f3\u30d7\u30eb\u3068\u540c\u69d8\u306b\u3001\u300cSQL\u30a4\u30f3\u30b8\u30a7\u30af\u30b7\u30e7\u30f3\u5bfe\u7b56\u300d\u300c\u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3\u300d\u3092\u3057\u3066\u3044\u307e\u3059\u3002\n// \u300cConnection\u300d\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u7528\u5909\u6570\nvar con = null;\ntry {\n    // \u63a5\u7d9a\n    con = openConnection();\n    // \u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3\u958b\u59cb\n    con.BeginTrans();\n    // \u300cCommand\u300d\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u751f\u6210\n    var cmd = new ActiveXObject(\"ADODB.Command\");\n    // \u300cConnection\u300d\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u8a2d\u5b9a\n    cmd.ActiveConnection = con;\n    // \u30b3\u30de\u30f3\u30c9\u30bf\u30a4\u30d7\u3092\u30c6\u30ad\u30b9\u30c8(1)\u306b\u8a2d\u5b9a\n    cmd.CommandType = 1;\n    // \u300cPrepared\u300d\u3092\u771f\u306b\u8a2d\u5b9a\n    cmd.Prepared = true;\n    // \u767a\u884c\u3059\u308b\u30b3\u30de\u30f3\u30c9\u6587\u5b57\u5217(SQL\u6587)\u3092\u8a2d\u5b9a \n    cmd.CommandText = \"DELETE FROM testtable WHERE num = ?;\";\n    // \u30d1\u30e9\u30e1\u30fc\u30bf\u8a2d\u5b9a\n    cmd.Parameters(0).Value = 100;\n    // \u5b9f\u884c\n    cmd.Execute();\n    // \u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3\u3001\u30b3\u30df\u30c3\u30c8\n    con.CommitTrans();\n} catch (e) {\n    // \u30a8\u30e9\u30fc\u306e\u5834\u5408\n    WScript.Echo(\"Error(\" + (e.number & 0xFFFF) + \"):\" + e.message);\n    try {\n        // \u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3\u3001\u30ed\u30fc\u30eb\u30d0\u30c3\u30af\n        con.RollbackTrans();\n    } catch (e) {\n        // \u30a8\u30e9\u30fc\u306e\u5834\u5408\n        WScript.Echo(\"Error(\" + (e.number & 0xFFFF) + \"):\" + e.message);\n    }\n} finally {\n    // \u300cConnection\u300d\u5207\u65ad\n    closeConnection(con);\n}\n\n## \u6e96\u5099\n\nSQL\u6587\u3092\u5b9f\u884c\u3057\u3066\u307f\u307e\u3059\u3002\n\u307e\u305a\u3001\u4ee5\u4e0b\u306e\u69d8\u306a\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3068\u30c6\u30fc\u30d6\u30eb\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\n\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u540d\uff1atestdb\n\u30c6\u30fc\u30d6\u30eb\u540d\uff1atesttable\n\n|\u5217\u540d|\u30c7\u30fc\u30bf\u578b|\n|:---|:---|\n|num|int|\n|str|varchar(50)|\n|date|datetime|\n\n\u307e\u305f\u3001\u5171\u901a\u95a2\u6570\u3092\u7528\u610f\u3057\u307e\u3059\u3002\n\n```js\nvar driver = \"{SQL Server}\";          // ODBC\u30c9\u30e9\u30a4\u30d0\nvar server = \"localhost\\\\SQLEXPRESS\"; // \u30b5\u30fc\u30d0\nvar database = \"testdb\";              // \u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\nvar user = \"sa\";                      // \u30e6\u30fc\u30b6\nvar pass = \"*****\";                   // \u30d1\u30b9\u30ef\u30fc\u30c9\n\n/**\n * \u300cConnection\u300d\u63a5\u7d9a\n */\nfunction openConnection() {\n    // \u300cConnection\u300d\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u751f\u6210\n    var con = new ActiveXObject(\"ADODB.Connection\");\n    // \u63a5\u7d9a\u6587\u5b57\u5217\u8a2d\u5b9a\n    con.ConnectionString = \"Provider=MSDASQL\" // \u30d7\u30ed\u30d0\u30a4\u30c0\n        + \";DRIVER=\" + driver                 // ODBC\u30c9\u30e9\u30a4\u30d0\n        + \";SERVER=\" + server                 // \u30b5\u30fc\u30d0\n        + \";DATABASE=\" + database             // \u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\n        + \";UID=\" + user                      // \u30e6\u30fc\u30b6\n        + \";PWD=\" + pass;                     // \u30d1\u30b9\u30ef\u30fc\u30c9\n    // \u63a5\u7d9a\n    con.Open();\n    return con;\n}\n\n/**\n * \u300cConnection\u300d\u5207\u65ad\n */\nfunction closeConnection(con) {\n    try {\n        // \u30b9\u30c6\u30fc\u30bf\u30b9\u30c1\u30a7\u30c3\u30af\n        if (con && con.State == 1) {\n            // \u5207\u65ad\n            con.Close();\n        }\n    } catch (e) {\n        // \u30a8\u30e9\u30fc\u306e\u5834\u5408\n        WScript.Echo(\"Error(\" + (e.number & 0xFFFF) + \"):\" + e.message);\n    }\n}\n\n/**\n * \u65e5\u4ed8\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\n */\nfunction df(date) {\n    var ret = null;\n    if (date && date instanceof Date) {\n        ret = date.getFullYear() + \"-\"\n            + (\"0\" + (date.getMonth() + 1)).slice(-2) + \"-\"\n            + (\"0\" + date.getDate()).slice(-2) + \" \"\n            + (\"0\" + date.getHours()).slice(-2) + \":\"\n            + (\"0\" + date.getMinutes()).slice(-2) + \":\"\n            + (\"0\" + date.getSeconds()).slice(-2);\n    }\n    return ret;\n}\n```\n\n## SELECT\n\n\u300cSELECT\u300d\u6587\u306e\u30b5\u30f3\u30d7\u30eb\u3067\u3059\u3002\nSQL\u30a4\u30f3\u30b8\u30a7\u30af\u30b7\u30e7\u30f3\u5bfe\u7b56\u7528\u306b\u3001\u300cADODB.Command\u300d\u3092\u5229\u7528\u3057\u3066\u30d1\u30e9\u30e1\u30fc\u30bf\u3092\u8a2d\u5b9a\u3057\u3066\u3044\u307e\u3059\u3002\n\n```js\n// \u300cConnection\u300d\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u7528\u5909\u6570\nvar con = null;\n// \u300cRecordset\u300d\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u7528\u5909\u6570\nvar rs = null;\ntry {\n    // \u63a5\u7d9a\n    con = openConnection();\n    // \u300cCommand\u300d\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u751f\u6210\n    var cmd = new ActiveXObject(\"ADODB.Command\");\n    // \u300cConnection\u300d\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u8a2d\u5b9a\n    cmd.ActiveConnection = con;\n    // \u30b3\u30de\u30f3\u30c9\u30bf\u30a4\u30d7\u3092\u30c6\u30ad\u30b9\u30c8(1)\u306b\u8a2d\u5b9a\n    cmd.CommandType = 1;\n    // \u300cPrepared\u300d\u3092\u771f\u306b\u8a2d\u5b9a\n    cmd.Prepared = true;\n    // \u767a\u884c\u3059\u308b\u30b3\u30de\u30f3\u30c9\u6587\u5b57\u5217(SQL\u6587)\u3092\u8a2d\u5b9a \n    cmd.CommandText = \"SELECT * FROM testtable WHERE num > ?\";\n    // \u30d1\u30e9\u30e1\u30fc\u30bf\u3092\u8a2d\u5b9a\n    cmd.Parameters(0).Value = 0;\n    // \u5b9f\u884c\n    rs = cmd.Execute();\n    // \u884c\u756a\u53f7\n    var row = 1;\n    // \u300cRecordset\u300d\u304c\u6700\u5f8c\u306b\u306a\u308b\u307e\u3067\u30eb\u30fc\u30d7\n    while (!rs.EOF) {\n        // \uff11\u884c\u6587\u5b57\u5217\n        var line = \"\" + row++;\n        // \u30d5\u30a3\u30fc\u30eb\u30c9\u6570\u5206\u30eb\u30fc\u30d7\n        for (var i = 0; i < rs.Fields.Count; i++) {\n            // \u30d5\u30a3\u30fc\u30eb\u30c9\u306e\u5024\u3001null\u5224\u5b9a\n            if (rs.Fields(i).Value != null) {\n                // \u30d5\u30a3\u30fc\u30eb\u30c9\u30bf\u30a4\u30d7\u5224\u5b9a\n                if (rs.Fields(i).Type == 135) {\n                    // \u300c\u65e5\u4ed8/\u6642\u523b\u30b9\u30bf\u30f3\u30d7\u300d\u578b\u3060\u3063\u305f\u306e\u3067\u3001\u65e5\u4ed8\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\n                    line += \" \" + df(new Date(rs.Fields(i).Value));\n                } else {\n                    // \u300c\u65e5\u4ed8/\u6642\u523b\u30b9\u30bf\u30f3\u30d7\u300d\u578b\u4ee5\u5916\u3060\u3063\u305f\u306e\u3067\u3001\u305d\u306e\u307e\u307e\n                    line += \" \" + rs.Fields(i).Value;\n                }\n            } else {\n                // null\u3060\u3063\u305f\u306e\u3067\u3001\u305d\u306e\u307e\u307e\n                line += \" \" + rs.Fields(i).Value;\n            }\n        }\n        // \uff11\u884c\u5206\u51fa\u529b\n        WScript.Echo(line);\n        // \u6b21\u306e\u884c\u3078\u79fb\u52d5\n        rs.MoveNext();\n    }\n} catch (e) {\n    // \u30a8\u30e9\u30fc\u306e\u5834\u5408\n    WScript.Echo(\"Error(\" + (e.number & 0xFFFF) + \"):\" + e.message);\n} finally {\n    try {\n        // \u30b9\u30c6\u30fc\u30bf\u30b9\u30c1\u30a7\u30c3\u30af\n        if (rs && rs.State == 1) {\n            // \u300cRecordset\u300d\u3092\u9589\u3058\u308b\n            rs.Close();\n        }\n    } catch (e) {\n        WScript.Echo(\"Error(\" + (e.number & 0xFFFF) + \"):\" + e.message);\n    }\n    // \u300cConnection\u300d\u5207\u65ad\n    closeConnection(con);\n}\n```\n\n## INSERT\n\n\u300cINSERT\u300d\u6587\u306e\u30b5\u30f3\u30d7\u30eb\u3067\u3059\u3002\n\u300cSELECT\u300d\u6587\u306e\u30b5\u30f3\u30d7\u30eb\u3068\u540c\u69d8\u306b\u3001\u300cSQL\u30a4\u30f3\u30b8\u30a7\u30af\u30b7\u30e7\u30f3\u5bfe\u7b56\u300d\u3092\u3057\u3066\u3044\u307e\u3059\u3002\n\u307e\u305f\u3001\u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3\u306b\u3088\u308b\u5236\u5fa1\u3082\u5165\u308c\u3066\u3044\u307e\u3059\u3002\n\n```js\n// \u300cConnection\u300d\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u7528\u5909\u6570\nvar con = null;\ntry {\n    // \u63a5\u7d9a\n    con = openConnection();\n    // \u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3\u958b\u59cb\n    con.BeginTrans();\n    // \u300cCommand\u300d\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u751f\u6210\n    var cmd = new ActiveXObject(\"ADODB.Command\");\n    // \u300cConnection\u300d\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u8a2d\u5b9a\n    cmd.ActiveConnection = con;\n    // \u30b3\u30de\u30f3\u30c9\u30bf\u30a4\u30d7\u3092\u30c6\u30ad\u30b9\u30c8(1)\u306b\u8a2d\u5b9a\n    cmd.CommandType = 1;\n    // \u300cPrepared\u300d\u3092\u771f\u306b\u8a2d\u5b9a\n    cmd.Prepared = true;\n    // \u767a\u884c\u3059\u308b\u30b3\u30de\u30f3\u30c9\u6587\u5b57\u5217(SQL\u6587)\u3092\u8a2d\u5b9a \n    cmd.CommandText = \"INSERT INTO testtable (num, str, date) VALUES (?, ?, GETDATE());\";\n    // \u30d1\u30e9\u30e1\u30fc\u30bf\u8a2d\u5b9a\n    cmd.Parameters(0).Value = 100;\n    cmd.Parameters(1).Value = \"string\";\n    // \u5b9f\u884c\n    cmd.Execute();\n    // \u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3\u3001\u30b3\u30df\u30c3\u30c8\n    con.CommitTrans();\n} catch (e) {\n    // \u30a8\u30e9\u30fc\u306e\u5834\u5408\n    WScript.Echo(\"Error(\" + (e.number & 0xFFFF) + \"):\" + e.message);\n    try {\n        // \u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3\u3001\u30ed\u30fc\u30eb\u30d0\u30c3\u30af\n        con.RollbackTrans();\n    } catch (e) {\n        // \u30a8\u30e9\u30fc\u306e\u5834\u5408\n        WScript.Echo(\"Error(\" + (e.number & 0xFFFF) + \"):\" + e.message);\n    }\n} finally {\n    // \u300cConnection\u300d\u5207\u65ad\n    closeConnection(con);\n}\n```\n\n## UPDATE\n\n\u300cUPDATE\u300d\u6587\u306e\u30b5\u30f3\u30d7\u30eb\u3067\u3059\u3002\n\u300cINSERT\u300d\u6587\u306e\u30b5\u30f3\u30d7\u30eb\u3068\u540c\u69d8\u306b\u3001\u300cSQL\u30a4\u30f3\u30b8\u30a7\u30af\u30b7\u30e7\u30f3\u5bfe\u7b56\u300d\u300c\u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3\u300d\u3092\u3057\u3066\u3044\u307e\u3059\u3002\n\n```js\n// \u300cConnection\u300d\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u7528\u5909\u6570\nvar con = null;\ntry {\n    // \u63a5\u7d9a\n    con = openConnection();\n    // \u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3\u958b\u59cb\n    con.BeginTrans();\n    // \u300cCommand\u300d\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u751f\u6210\n    var cmd = new ActiveXObject(\"ADODB.Command\");\n    // \u300cConnection\u300d\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u8a2d\u5b9a\n    cmd.ActiveConnection = con;\n    // \u30b3\u30de\u30f3\u30c9\u30bf\u30a4\u30d7\u3092\u30c6\u30ad\u30b9\u30c8(1)\u306b\u8a2d\u5b9a\n    cmd.CommandType = 1;\n    // \u300cPrepared\u300d\u3092\u771f\u306b\u8a2d\u5b9a\n    cmd.Prepared = true;\n    // \u767a\u884c\u3059\u308b\u30b3\u30de\u30f3\u30c9\u6587\u5b57\u5217(SQL\u6587)\u3092\u8a2d\u5b9a \n    cmd.CommandText = \"UPDATE testtable SET date = ? WHERE num = ?;\";\n    // \u30d1\u30e9\u30e1\u30fc\u30bf\u8a2d\u5b9a\n    cmd.Parameters(0).Value = df(new Date(new Date().getTime() - 3600000));\n    cmd.Parameters(1).Value = 100;\n    // \u5b9f\u884c\n    cmd.Execute();\n    // \u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3\u3001\u30b3\u30df\u30c3\u30c8\n    con.CommitTrans();\n} catch (e) {\n    // \u30a8\u30e9\u30fc\u306e\u5834\u5408\n    WScript.Echo(\"Error(\" + (e.number & 0xFFFF) + \"):\" + e.message);\n    try {\n        // \u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3\u3001\u30ed\u30fc\u30eb\u30d0\u30c3\u30af\n        con.RollbackTrans();\n    } catch (e) {\n        // \u30a8\u30e9\u30fc\u306e\u5834\u5408\n        WScript.Echo(\"Error(\" + (e.number & 0xFFFF) + \"):\" + e.message);\n    }\n} finally {\n    // \u300cConnection\u300d\u5207\u65ad\n    closeConnection(con);\n}\n```\n\n\n## DELETE\n\n\u300cDELETE\u300d\u6587\u306e\u30b5\u30f3\u30d7\u30eb\u3067\u3059\u3002\n\u300cINSERT\u300d\u6587\u306e\u30b5\u30f3\u30d7\u30eb\u3068\u540c\u69d8\u306b\u3001\u300cSQL\u30a4\u30f3\u30b8\u30a7\u30af\u30b7\u30e7\u30f3\u5bfe\u7b56\u300d\u300c\u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3\u300d\u3092\u3057\u3066\u3044\u307e\u3059\u3002\n\n```js\n// \u300cConnection\u300d\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u7528\u5909\u6570\nvar con = null;\ntry {\n    // \u63a5\u7d9a\n    con = openConnection();\n    // \u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3\u958b\u59cb\n    con.BeginTrans();\n    // \u300cCommand\u300d\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u751f\u6210\n    var cmd = new ActiveXObject(\"ADODB.Command\");\n    // \u300cConnection\u300d\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u8a2d\u5b9a\n    cmd.ActiveConnection = con;\n    // \u30b3\u30de\u30f3\u30c9\u30bf\u30a4\u30d7\u3092\u30c6\u30ad\u30b9\u30c8(1)\u306b\u8a2d\u5b9a\n    cmd.CommandType = 1;\n    // \u300cPrepared\u300d\u3092\u771f\u306b\u8a2d\u5b9a\n    cmd.Prepared = true;\n    // \u767a\u884c\u3059\u308b\u30b3\u30de\u30f3\u30c9\u6587\u5b57\u5217(SQL\u6587)\u3092\u8a2d\u5b9a \n    cmd.CommandText = \"DELETE FROM testtable WHERE num = ?;\";\n    // \u30d1\u30e9\u30e1\u30fc\u30bf\u8a2d\u5b9a\n    cmd.Parameters(0).Value = 100;\n    // \u5b9f\u884c\n    cmd.Execute();\n    // \u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3\u3001\u30b3\u30df\u30c3\u30c8\n    con.CommitTrans();\n} catch (e) {\n    // \u30a8\u30e9\u30fc\u306e\u5834\u5408\n    WScript.Echo(\"Error(\" + (e.number & 0xFFFF) + \"):\" + e.message);\n    try {\n        // \u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3\u3001\u30ed\u30fc\u30eb\u30d0\u30c3\u30af\n        con.RollbackTrans();\n    } catch (e) {\n        // \u30a8\u30e9\u30fc\u306e\u5834\u5408\n        WScript.Echo(\"Error(\" + (e.number & 0xFFFF) + \"):\" + e.message);\n    }\n} finally {\n    // \u300cConnection\u300d\u5207\u65ad\n    closeConnection(con);\n}\n```\n\n"}