{"tags": ["reactnative", "InAppPurchase", "iOS"], "context": " \u3053\u306e\u8a18\u4e8b\u306f\u6700\u7d42\u66f4\u65b0\u65e5\u304b\u30891\u5e74\u4ee5\u4e0a\u304c\u7d4c\u904e\u3057\u3066\u3044\u307e\u3059\u3002\u4eca\u65e5\u306fReact Native\u3067\u30a2\u30d7\u30ea\u5185\u8ab2\u91d1\u3092\u5b9f\u88c5\u3057\u3066\u307f\u307e\u3059\u3002iOS\u306e\u30e2\u30b8\u30e5\u30fc\u30ebreact-native-in-app-utils\u3092\u5229\u7528\u3057\u307e\u3059\u3002\n\n\u74b0\u5883\u8a2d\u5b9a\n1) \u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n $ npm install react-native-in-app-utils --save.\n\n2)\u30e9\u30a4\u30d6\u30e9\u30ea\u306e\u30ea\u30f3\u30af\n\u3044\u3064\u3082\u306e\u3088\u3046\u306b\u3053\u3053\u3092\u53c2\u7167\u3057\u306a\u304c\u3089\u3001Xcode\u3067\u30e9\u30a4\u30d6\u30e9\u30ea\u3092\u30ea\u30f3\u30af\u3055\u305b\u308b\u3002node_modules/react-native-in-app-utils/InAppUtils.xcodeproj/\u3092\u30c9\u30e9\u30c3\u30af\u30a2\u30f3\u30c9\u30c9\u30ed\u30c3\u30d7\u3067Xcode\u306e\u30e9\u30a4\u30d6\u30e9\u30ea\u306b\u8ffd\u52a0\u5f8c\u3001link binary\u3059\u308b\u3002\n\n\u3000\u4f7f\u3044\u65b9\niTunes connect\u3067\u8ab2\u91d1\u306e\u8a2d\u5b9a\u3092\u3057\u3066\u3044\u308b\u3053\u3068\u3092\u524d\u63d0\u3068\u3057\u307e\u3059\u3002\u8ab2\u91d1\u81ea\u4f53\u306f\u975e\u5e38\u306b\u30b7\u30f3\u30d7\u30eb\u3067\u3001InAppUtils.loadProducts\u3067products\u3092Apple\u304b\u3089\u53d6\u5f97\u3057\u3001\u305d\u306e\u30d7\u30ed\u30c0\u30af\u30c8\u3092\u8cb7\u3046\u5834\u5408\u306b\u3001InAppUtils.purchaseProduct\u3092\u884c\u3046\u3060\u3051\u3067\u3059\u3002\nlet InAppUtils = require('NativeModules').InAppUtils;\nlet productID = 'com.xxx.yyy.10_credit';\n\nlet profile = React.createClass({\n\n  getInitialState(){\n    return {\n      user: {}\n    }\n  },\n\n  componentDidMount(){\n    var products = [\n      productID,\n    ];\n    InAppUtils.loadProducts(products, (error, products) => {\n      //console.log(products);\n      //console.log(error);\n      if(!error){\n        this.setState({price: `(10 credit/${products[0].priceString})` });\n      }\n    });\n  },\n\n  onPressPurchase(){\n    InAppUtils.purchaseProduct(productID, (error, response) => {\n      if(error){\n\u3000\u3000\u3000\u3000\u3000//\u8ab2\u91d1\u5931\u6557\u6642\u306e\u51e6\u7406\n        AlertIOS.alert(\"Error\", \"Failed to purchase. Please contact info@wazalab.com\")\n        purchaseHistoryActions.trackError(error);\n      }else if(response && response.productIdentifier) {\n\u3000\u3000\u3000\u3000\u3000//\u8ab2\u91d1\u6210\u529f\u6642\u306e\u51e6\u7406\u3002\u3053\u3053\u3067\u306f\u3001History\u306b\u30ed\u30b0\u3092\u6b8b\u3057\u3001\u30e6\u30fc\u30b6\u306b10\u30af\u30ec\u30b8\u30c3\u30c8\u8ffd\u52a0\u304b\u3059\u308b\u51e6\u7406\u3002\n        purchaseHistoryActions.trackRecord(response.transactionIdentifier);\n        userActions.addCredit(10);\n      }\n    });\n  },\n\n  render(){\n    return (\n      <Button onPress=\"onPressPurchase\">Buy</Button>\n    )\n  }\n}\n\n\n\nSummary\n\u3053\u306e\u3088\u3046\u306b\u65e2\u5b58\u306e\u30e9\u30a4\u30d6\u30e9\u30ea\u3092\u3044\u3044\u611f\u3058\u306b\u62bd\u8c61\u5316\u3057\u3066\u3044\u3066\u3001\u305d\u306e\u30e9\u30a4\u30d6\u30e9\u30ea\u3092\u4f7f\u3046\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3082\u30c9\u30e9\u30c3\u30af\u30a2\u30f3\u30c9\u30c9\u30ed\u30c3\u30d7\u3068Link Binary\u3059\u308b\u3060\u3051\u3067\u975e\u5e38\u306b\u7c21\u5358\u3067\u3059\u3002\u79c1\u306f\u4ed6\u306e\u30cf\u30a4\u30d6\u30ea\u30c3\u30c9\u3092\u3042\u307e\u308a\u89e6\u3063\u305f\u3053\u3068\u304c\u3042\u308a\u307e\u305b\u3093\u304c\u3001Podcast\u3092\u805e\u304f\u3068\u3053\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u306e\u5bb9\u6613\u3055\u304cReacg Native\u306e\u4eba\u6c17\u306e\u3072\u3068\u3064\u306e\u7406\u7531\u3068\u306a\u3063\u3066\u3044\u308b\u3088\u3046\u3067\u3059\u3002\u73fe\u884c\u30b3\u30fc\u30c9\u3068\u306e\u5171\u5b58\u3082\u5bb9\u6613\u3068\u306a\u308b\u308f\u3051\u3067\u3059\u3002\n\u4eca\u65e5\u306fReact Native\u3067\u30a2\u30d7\u30ea\u5185\u8ab2\u91d1\u3092\u5b9f\u88c5\u3057\u3066\u307f\u307e\u3059\u3002iOS\u306e\u30e2\u30b8\u30e5\u30fc\u30eb[react-native-in-app-utils](https://github.com/chirag04/react-native-in-app-utils)\u3092\u5229\u7528\u3057\u307e\u3059\u3002\n\n\n## \u74b0\u5883\u8a2d\u5b9a\n\n1) \u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n```\n $ npm install react-native-in-app-utils --save.\n```\n\n2)\u30e9\u30a4\u30d6\u30e9\u30ea\u306e\u30ea\u30f3\u30af\n\n\u3044\u3064\u3082\u306e\u3088\u3046\u306b[\u3053\u3053](https://facebook.github.io/react-native/docs/linking-libraries-ios.html#content)\u3092\u53c2\u7167\u3057\u306a\u304c\u3089\u3001Xcode\u3067\u30e9\u30a4\u30d6\u30e9\u30ea\u3092\u30ea\u30f3\u30af\u3055\u305b\u308b\u3002`node_modules/react-native-in-app-utils/InAppUtils.xcodeproj/`\u3092\u30c9\u30e9\u30c3\u30af\u30a2\u30f3\u30c9\u30c9\u30ed\u30c3\u30d7\u3067Xcode\u306e\u30e9\u30a4\u30d6\u30e9\u30ea\u306b\u8ffd\u52a0\u5f8c\u3001link binary\u3059\u308b\u3002\n\n\n##\u3000\u4f7f\u3044\u65b9\n\niTunes connect\u3067\u8ab2\u91d1\u306e\u8a2d\u5b9a\u3092\u3057\u3066\u3044\u308b\u3053\u3068\u3092\u524d\u63d0\u3068\u3057\u307e\u3059\u3002\u8ab2\u91d1\u81ea\u4f53\u306f\u975e\u5e38\u306b\u30b7\u30f3\u30d7\u30eb\u3067\u3001`InAppUtils.loadProducts`\u3067products\u3092Apple\u304b\u3089\u53d6\u5f97\u3057\u3001\u305d\u306e\u30d7\u30ed\u30c0\u30af\u30c8\u3092\u8cb7\u3046\u5834\u5408\u306b\u3001`InAppUtils.purchaseProduct`\u3092\u884c\u3046\u3060\u3051\u3067\u3059\u3002\n\n```\nlet InAppUtils = require('NativeModules').InAppUtils;\nlet productID = 'com.xxx.yyy.10_credit';\n\nlet profile = React.createClass({\n\n  getInitialState(){\n    return {\n      user: {}\n    }\n  },\n\n  componentDidMount(){\n    var products = [\n      productID,\n    ];\n    InAppUtils.loadProducts(products, (error, products) => {\n      //console.log(products);\n      //console.log(error);\n      if(!error){\n        this.setState({price: `(10 credit/${products[0].priceString})` });\n      }\n    });\n  },\n\n  onPressPurchase(){\n    InAppUtils.purchaseProduct(productID, (error, response) => {\n      if(error){\n\u3000\u3000\u3000\u3000\u3000//\u8ab2\u91d1\u5931\u6557\u6642\u306e\u51e6\u7406\n        AlertIOS.alert(\"Error\", \"Failed to purchase. Please contact info@wazalab.com\")\n        purchaseHistoryActions.trackError(error);\n      }else if(response && response.productIdentifier) {\n\u3000\u3000\u3000\u3000\u3000//\u8ab2\u91d1\u6210\u529f\u6642\u306e\u51e6\u7406\u3002\u3053\u3053\u3067\u306f\u3001History\u306b\u30ed\u30b0\u3092\u6b8b\u3057\u3001\u30e6\u30fc\u30b6\u306b10\u30af\u30ec\u30b8\u30c3\u30c8\u8ffd\u52a0\u304b\u3059\u308b\u51e6\u7406\u3002\n        purchaseHistoryActions.trackRecord(response.transactionIdentifier);\n        userActions.addCredit(10);\n      }\n    });\n  },\n\n  render(){\n    return (\n      <Button onPress=\"onPressPurchase\">Buy</Button>\n    )\n  }\n}\n\n```\n\n## Summary\n\n\u3053\u306e\u3088\u3046\u306b\u65e2\u5b58\u306e\u30e9\u30a4\u30d6\u30e9\u30ea\u3092\u3044\u3044\u611f\u3058\u306b\u62bd\u8c61\u5316\u3057\u3066\u3044\u3066\u3001\u305d\u306e\u30e9\u30a4\u30d6\u30e9\u30ea\u3092\u4f7f\u3046\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3082\u30c9\u30e9\u30c3\u30af\u30a2\u30f3\u30c9\u30c9\u30ed\u30c3\u30d7\u3068Link Binary\u3059\u308b\u3060\u3051\u3067\u975e\u5e38\u306b\u7c21\u5358\u3067\u3059\u3002\u79c1\u306f\u4ed6\u306e\u30cf\u30a4\u30d6\u30ea\u30c3\u30c9\u3092\u3042\u307e\u308a\u89e6\u3063\u305f\u3053\u3068\u304c\u3042\u308a\u307e\u305b\u3093\u304c\u3001Podcast\u3092\u805e\u304f\u3068\u3053\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u306e\u5bb9\u6613\u3055\u304cReacg Native\u306e\u4eba\u6c17\u306e\u3072\u3068\u3064\u306e\u7406\u7531\u3068\u306a\u3063\u3066\u3044\u308b\u3088\u3046\u3067\u3059\u3002\u73fe\u884c\u30b3\u30fc\u30c9\u3068\u306e\u5171\u5b58\u3082\u5bb9\u6613\u3068\u306a\u308b\u308f\u3051\u3067\u3059\u3002\n\n\n"}