{"context": " More than 1 year has passed since last update.\n\n\u3010 \u30af\u30a8\u30ea\u306e\u51e6\u7406\u5185\u5bb9 \u3011\n\n\u300cgame_event\u00d7\u30e6\u30fc\u30b6\u300d\u3054\u3068\u306b\u3001\u6700\u5f8c\u306b\u30a4\u30d9\u30f3\u30c8\u306b\u53c2\u52a0\u3057\u305f\u6642\u523b\u304b\u3089\uff08\u73fe\u5728\u307e\u3067\u306e\uff09\u7d4c\u904e\u6642\u9593\uff08\u5206\uff09\u304c\u3001\u305d\u306e\u30e6\u30fc\u30b6\u306e\u305d\u306e\u30a4\u30d9\u30f3\u30c8\u306b\u5bfe\u3059\u308b\u518d\u30ed\u30b0\u30a4\u30f3\u9593\u9694\u6642\u9593\u306e\u300c\u5e73\u5747\u5024\uff08\u5206\uff09\u300d\uff0b\u300c\u6a19\u6e96\u504f\u5dee\uff08\u5206\uff09\u300d\u00d7\uff15 \u3092\u8d85\u3048\u305f\u5834\u5408\u306b\u3001\u300e\u30a4\u30d9\u30f3\u30c8 \u96e2\u8131\u30a2\u30e9\u30fc\u30c8\u300f\u30d5\u30e9\u30b0\u306b\uff11\u3092\u7acb\u3066\u308b \u51e6\u7406\u3092\u5168\u30a2\u30af\u30c6\u30a3\u30d6UU\u3001\u9032\u884c\u4e2d\u306e\u5168\u30b2\u30fc\u30e0\u30a4\u30d9\u30f3\u30c8\u306b\u3064\u3044\u3066\u3001\u4e00\u62ec\u51e6\u7406\u3059\u308b\u3002\n\n\n\u3010 \u60f3\u5b9a\u3059\u308b\u30b5\u30f3\u30d7\u30eb\u30fbDB\u30c6\u30fc\u30d6\u30eb \u3011\n\n\n\u30c6\u30fc\u30d6\u30eb\u7269\u7406\u540d\uff1agame_event_item_log\n\n\n\u30ab\u30e9\u30e0\u7269\u7406\u540d\n\n\ngame_event\uff1a\u30b2\u30fc\u30e0\u30a4\u30d9\u30f3\u30c8\uff08\u540d or ID\uff09\nuser_id \uff1a\u30b2\u30fc\u30e0\u30a4\u30d9\u30f3\u30c8\u53c2\u52a0\u30e6\u30fc\u30b6ID\ndatetime \uff1a\u305d\u306e\u300c\u30b2\u30fc\u30e0\u30a4\u30d9\u30f3\u30c8\u300d\u306b\u3001\u305d\u306e\u300c\u30e6\u30fc\u30b6ID\u300d\u306e\u30e6\u30fc\u30b6\u304c\u3001\u53c2\u52a0\u3057\u305f\u6642\u523b\uff08YYYY-MM-DD HH24:MI:SS\uff09\n\n\n\n\uff1c \u4e3b\u554f\u3044\u5408\u308f\u305b\u6587\u306e select \u53e5 \u3067 \u53c2\u7167\u3055\u308c\u3066\u5f97\u3089\u308c\u308b\u30ab\u30e9\u30e0 \uff1e\n\n\ngame_event\uff1a\u30b2\u30fc\u30e0\u30a4\u30d9\u30f3\u30c8\uff08\u540d or ID\uff09\nuser_id\uff1a\u30b2\u30fc\u30e0\u30a4\u30d9\u30f3\u30c8\u53c2\u52a0\u30e6\u30fc\u30b6ID\nAVG_event_interval_per_game_event_user\uff1a\u4e0a\u8a18\u30e6\u30fc\u30b6\u306e\uff08\u305d\u306e\u30b2\u30fc\u30e0\u30a4\u30d9\u30f3\u30c8\u306b\u518d\u30ed\u30b0\u30a4\u30f3\u3059\u308b\u307e\u3067\u306b\u304b\u304b\u3063\u305f\u500b\u3005\u306e\u6642\u9593\u9593\u9694\uff08\u5206\u5358\u4f4d\uff09\u306e\u5e73\u5747\u5024\nSDTDEV_event_interval_per_game_event_user: \u4e0a\u8a18\u30e6\u30fc\u30b6\u306e\uff08\u305d\u306e\u30b2\u30fc\u30e0\u30a4\u30d9\u30f3\u30c8\u306b\u518d\u30ed\u30b0\u30a4\u30f3\u3059\u308b\u307e\u3067\u306b\u304b\u304b\u3063\u305f\u500b\u3005\u306e\u6642\u9593\u9593\u9694\uff08\u5206\u5358\u4f4d\uff09\u306e\u3070\u3089\u3064\u304d\u5ea6\u5408\u3044\uff08\u6a19\u6e96\u504f\u5dee\uff09\nlast_event_timestamp1\uff1a\u5404\u30e6\u30fc\u30b6\u306e\uff08\u305d\u306e\u30b2\u30fc\u30e0\u30a4\u30d9\u30f3\u30c8\uff09\u6700\u5f8c\u30ed\u30b0\u30a4\u30f3\u6642\u523b\uff08YYYY-MM-DD HH24:MI:SS\uff09\npresent_timestamp\uff1a \u30af\u30a8\u30ea\u5b9f\u884c\u6642\u523b\uff08YYYY-MM-DD HH24:MI:SS\uff09\nminutes_since_last_event_time\uff1a\u305d\u306e\u30e6\u30fc\u30b6ID\uff08\u306e\u30e6\u30fc\u30b6\uff09\u304c\u305d\u306e\u30b2\u30fc\u30e0\u30a4\u30d9\u30f3\u30c8\u306b\u6700\u5f8c\u306b\u30ed\u30b0\u30a4\u30f3\u3057\u3066\u304b\u3089\u3001\u73fe\u5728\u6642\u523b\uff08\u30af\u30a8\u30ea\u5b9f\u884c\u6642\u523b\uff09\u307e\u3067\u306e\u7d4c\u904e\u6642\u9593\uff08\u5206\u5358\u4f4d\uff09\npast_interval_AVG_plus_3STDDEV_minutes\uff1a\u305d\u306e\u30e6\u30fc\u30b6\u306e\uff08\u305d\u306e\u30b2\u30fc\u30e0\u30a4\u30d9\u30f3\u30c8\u306b\u5bfe\u3059\u308b\uff09\u6700\u7d42\u30ed\u30b0\u30a4\u30f3\u6642\u523b\u304b\u3089\u3001\u3053\u306e\u5206\u6570\u3092\u8d85\u3048\u305f\u3089\u3001\u3053\u306e\u30b2\u30fc\u30e0\u30a4\u30d9\u30f3\u30c8\u304b\u3089\u96e2\u8131\u3057\u305f\u30ea\u30b9\u30af\u304c\u9ad8\u307e\u308b\u6642\u9593\u306e\u9577\u3055 \uff08 \u5b9a\u7fa9 \uff09 \u3053\u306e\u30e6\u30fc\u30b6\u306e\u3001\u3053\u306e\u30a4\u30d9\u30f3\u30c8\u306b\u5bfe\u3059\u308b\u904e\u53bb\u306e\u3059\u3079\u3066\u306e\u518d\u30ed\u30b0\u30a4\u30f3\u9593\u9694\u6642\u9593\uff08\u5206\uff09\u30c7\u30fc\u30bf\u306e\u300c\u5e73\u5747\u5024\uff08\u5206\uff09\u300d\uff0b\u300c\u6a19\u6e96\u504f\u5dee\uff08\u5206\uff09\u300d*3\uff09\n\n\nFLG_withdrawal_alert\uff1a\u305d\u306e\u30e6\u30fc\u30b6\u304c\u3001\u3053\u306e\u30b2\u30fc\u30e0\u30a4\u30d9\u30f3\u30c8\u304b\u3089\u300c\u96e2\u8131\u300d\u3057\u305f\u30ea\u30b9\u30af\u6709\u308a\uff08\u300c\uff11\u300d\uff09\uff0f\u7121\u3057\uff08\uff10\uff09\u306e\u8b66\u544a\u30d5\u30e9\u30b0\n\n\n\n\u4ee5\u4e0b\u306e\uff14\u3064\u306e\u5217\u306f\u3001\u4ee5\u4e0b\u3092\u307f\u308b\u305f\u3081\u306b\u3064\u304b\u3044\u307e\u3059\u3002\n\nTotal_user_num_in_this_game_event\nwithdrawal_alert_user_num\nwithdrawal_no_alert_user_num\nwithdrawal_flag_null_user_num\n\n\u73fe\u5728\u9032\u884c\u4e2d\u306e\u30b2\u30fc\u30e0\u30a4\u30d9\u30f3\u30c8\u6bce\u306b\u3001\uff08\u30a4\u30d9\u30f3\u30c8\uff09\u30a2\u30af\u30c6\u30a3\u30d6\uff35\uff35\u4eba\u6570 \u304c\u4f55\u4eba\u3044\u3066\u3001\u305d\u306e\u3046\u3061\u3044\u307e\u4f55\u4eba\u304c\u3001\uff08\u305d\u306e\u30a4\u30d9\u30f3\u30c8\u304b\u3089\uff09\u96e2\u8131\u306e\u30ea\u30b9\u30af\u304c\u9ad8\u307e\u3063\u3066\u3044\u308b\u306e\u304b\u3092\u3001\u4eba\u6570\u5358\u4f4d\u3067\u96c6\u8a08\u3059\u308b\u3068\u3053\u308d\u307e\u3067\u3001\u30af\u30a8\u30ea\u3092\u3064\u304f\u308a\u3053\u3093\u3067\u3044\u308b\u306e\u304b\uff1f\n\n\uff08\u30a4\u30d9\u30f3\u30c8\u5225\uff09\u300c\u30a2\u30af\u30c6\u30a3\u30d6\uff35\uff35\u4eba\u6570\u300d\u5217\n\uff08\u30a4\u30d9\u30f3\u30c8\u5225\uff09\u300c\u96e2\u8131\u30a2\u30e9\u30fc\u30c8\u6709\u308a\uff35\uff35\u4eba\u6570\u300d\u5217\n\uff08\u30a4\u30d9\u30f3\u30c8\u5225\uff09\u300c\u96e2\u8131\u30a2\u30e9\u30fc\u30c8\u306a\u3057\uff35\uff35\u4eba\u6570\u300d\u5217\n\n\uff08\u30a4\u30d9\u30f3\u30c8\u5225\uff09\u300c\u96e2\u8131\u30a2\u30e9\u30fc\u30c8\u7b97\u51fa\u4e0d\u80fd \uff35\uff35\u4eba\u6570\u300d\u5217\n\n\u203b\u7b97\u51fa\u4e0d\u80fd\uff1a\u300c\u96e2\u8131\u30a2\u30e9\u30fc\u30c8\u300d\u5b9a\u7fa9\u5f0f\u306e\u5206\u6bcd\uff08\u6d41\u5165\u9593\u9694\u306e\u6a19\u6e96\u504f\u5dee\uff09\u304c\u30bc\u30ed\u3067\u30bc\u30ed\u3067\u5272\u308c\u306a\u3044\u30a8\u30e9\u30fc\u306a\u3069\uff09\u3092\u8868\u793a\u3059\u308b\u5217\u3092\u8ffd\u52a0\u3067\u304d\u308b\u3002\n\n\n\n\n\uff1c \u30ec\u30b3\u30fc\u30c9\u8868\u793a\u9806 \uff1e\n\ngame_event, user_id\n\n\uff1c \uff33\uff31\uff2c \uff1e\n\n\n\u4e3b\u306b\u4f7f\u3063\u305fSQL\u6a5f\u80fd\u306f\u3001\u4ee5\u4e0b\u306e\uff13\u3064\u3067\u3059\u3002\n\n\n\nWith\u53e5\u3000\uff1a \u4e3b\u554f\u3044\u5408\u308f\u305b\u6587 \u306b\u305f\u3069\u308a\u3064\u304f\u307e\u3067\u306e\u4e2d\u9593\u4f5c\u696d\u30c6\u30fc\u30d6\u30eb\uff08View\u306e\u3088\u3046\u306a\u3082\u306e\uff09\u3092\u4f55\u56de\u304b\u3001\u3064\u3065\u3051\u3066\u751f\u6210\n\n\u76f8\u95a2\u30b5\u30d6\u30af\u30a8\u30ea\u3000\uff1a \u30ed\u30b0\u30a4\u30f3\u6642\u9593 \u524d\u5f8c\u3059\u308b\uff12\u30ec\u30b3\u30fc\u30c9\u306e\u30ed\u30b0\u30a4\u30f3\u6642\u523b\u3092\u5f15\u304d\u7b97\u3057\u3066\u7d4c\u904e\u6642\u9593\u3092\u7b97\u51fa\n\navg(), stddev(), max() \u95a2\u6570\u3068\u3001over(partition by column_name order by column_name \uff1a \u30b2\u30fc\u30e0\u30a4\u30d9\u30f3\u30c8\u3068\u30e6\u30fc\u30b6ID\u6bce\u306e\uff08\u518d\u30ed\u30b0\u30a4\u30f3\u6240\u8981\u6642\u9593\u306e\u77ed\u3055\uff09\u5e73\u5747\u5024\u30fb\u6a19\u6e96\u504f\u5dee\u3001\u3068 \u305d\u306e\u30e6\u30fc\u30b6\u304c\u305d\u306e\u30b2\u30fc\u30e0\u30a4\u30d9\u30f3\u30c8\u306b\u6700\u5f8c\u306e\u30ed\u30b0\u30a4\u30f3\u3057\u305f\u6642\u523b\uff08max(datetime))\u3092\u7b97\u51fa\uff09\n\n\nSQL\nWith temp AS (\nSELECT tbl_0.game_event,\n       tbl_0.user_id, \n       tbl_0.datetime,\n        (SELECT MAX(datetime)\n         FROM game_event_item_log tbl_1 tbl_1\n         where tbl_1.datetime < tbl_0.datetime) AS latest\nFROM game_event_item_log tbl_1 tbl_0\ngroup by tbl_0.game_event, tbl_0.user_id, tbl_0.datetime\norder by tbl_0.game_event, tbl_0.user_id, tbl_0.datetime desc\n), temp_2 AS (\nSELECT  game_event,\n        user_id,\n        datetime,\n        latest, \n        abs(datediff(minute,datetime, latest)) AS time_interval\nFROM temp\norder by game_event, user_id, datetime desc\n), temp_3 AS (\nSELECT game_event,\n       user_id,\n       datetime,\n       avg(time_interval) over(partition by game_event, user_id) AS AVG_event_interval_per_game_event_user,\n       round(stddev(time_interval) over(partition by game_event, user_id), 2) AS SDTDEV_event_interval_per_game_event_user,\n       max(datetime) over(partition by game_event, user_id) AS last_event_timestamp\nfrom temp_2\norder by game_event, user_id\n), temp_4 AS (\nSELECT game_event,\n       user_id,\n       AVG_event_interval_per_game_event_user,\n       SDTDEV_event_interval_per_game_event_user,\n       last_event_timestamp\nfrom temp_3\ngroup by game_event, user_id, AVG_event_interval_per_game_event_user, SDTDEV_event_interval_per_game_event_user,last_event_timestamp\norder by game_event, user_id\n), temp_5 AS (\nselect *,\n       getdate() AS present_timestamp,\n       abs(datediff(minute, last_event_timestamp, getdate())) AS minutes_since_last_event_time,\n       (AVG_event_interval_per_game_event_user +  SDTDEV_event_interval_per_game_event_user*3) AS past_interval_AVG_plus_5_STDDEV_minutes\n       from temp_4\norder by game_event, user_id\n), temp_6 AS (\nselect *,\n       case when minutes_since_last_event_time >= past_interval_AVG_plus_5_STDDEV_minutes  then 1\n            when minutes_since_last_event_time <  past_interval_AVG_plus_5_STDDEV_minutes  then 0\n       end AS  FLG_withdrawal_alert\nfrom temp_5\norder by game_event, user_id\n)\nselect *,\n       count(case when FLG_withdrawal_alert = 1 then 1 else null end) over(partition by game_event) AS  withdrawal_alert_user_num,\n       count(case when FLG_withdrawal_alert = 0 then 1 else null end) over(partition by game_event) AS  withdrawal_no_alert_user_num,\n       count(case when FLG_withdrawal_alert is NULL then 1 else null end)  over(partition by game_event) AS  withdrawal_flag_null_user_num,\n       count(*) OVER (PARTITION BY game_event) AS Total_user_num_in_this_game_event\nfrom temp_6\norder by game_event, FLG_withdrawal_alert\n;\n\n\n\n\n\u3010 \u300c\u96e2\u8131\u30a2\u30e9\u30fc\u30c8\u300d\u8aa4\u4fe1\u30ea\u30b9\u30af\u306b\u95a2\u308f\u308b\u7559\u610f\u70b9 \u3011\n\n\u30fb \u4eca\u56de\u306f\u3001\u300c\u3042\u308b\u30e6\u30fc\u30b6\u300d\u304c\u300c\u305d\u306e\u30a4\u30d9\u30f3\u30c8\u300d\u306b\u3001(a) \uff1c\u53c2\u52a0\u3059\u308b\uff1e ==> (b) \uff1c\u9000\u51fa\u3059\u308b\uff1e ==> (c) \uff1c\u518d\u3073\u53c2\u52a0\u3059\u308b\uff1e \u306e\u30a2\u30af\u30b7\u30e7\u30f3\u30d5\u30ed\u30fc\u306b\u7740\u76ee\u3057\u3066\u3001   \u904e\u53bb\u306b\uff08\u305d\u306e\u30e6\u30fc\u30b6\u304c\u3001\u305d\u306e\u30a4\u30d9\u30f3\u30c8\u306b\u53c2\u52a0\u3057\u305f\u30ed\u30b0\u30c7\u30fc\u30bf\u4e0a\u306e\uff09(a) \u30a4\u30d9\u30f3\u30c8\u30ed\u30b0\u30a4\u30f3 \uff5e (c) \u30a4\u30d9\u30f3\u30c8\u518d\u30ed\u30b0\u30a4\u30f3 \u307e\u3067\u306b\u304b\u304b\u3063\u305f\u6642\u9593\uff08\u5206\uff09\u306b\u6ce8\u76ee\u3057\u307e\u3057\u305f\u3002\n\u3042\u308b\u30e6\u30fc\u30b6\uff08\uff21\u3055\u3093\uff09\u304c\u3001\u3042\u308b\u30a4\u30d9\u30f3\u30c8\u306b \u7d2f\u8a08\uff11\uff15\u56de\u53c2\u52a0\u3057\u305f\u5834\u5408\u3001\uff21\u3055\u3093\u306e\uff08\u305d\u306e\u30a4\u30d9\u30f3\u30c8\u306b\u7d10\u3065\u3051\u3089\u308c\u305f\uff09\uff11\uff14\u56de\u5206\u306e \u30a4\u30d9\u30f3\u30c8\u30ed\u30b0\u30a4\u30f3 \uff5e \u30a4\u30d9\u30f3\u30c8\u518d\u30ed\u30b0\u30a4\u30f3 \u306e\u9593\u306e\u6240\u8981\u6642\u9593\uff08\u5206\uff09\u30c7\u30fc\u30bf\uff08\u30c7\u30fc\u30bf\u6570\uff1a14\u30ec\u30b3\u30fc\u30c9\uff09\u306e\u300c\u5e73\u5747\u5024\u300d\u3068\u3070\u3089\u3064\u304d\u5ea6\u5408\u3044\uff08\u300c\u6a19\u6e96\u504f\u5dee\u300d\uff09\u3092SQL\u5185\u3067\u7b97\u51fa\u3057\u307e\u3059\u3002\nA\u3055\u3093\u304c\u305d\u306e\u30a4\u30d9\u30f3\u30c8\u306b\u53c2\u52a0\u3059\u308b\u884c\u52d5\u983b\u5ea6\uff08\u524d\u56de\u30ed\u30b0\u30a4\u30f3\u304b\u3089\u518d\u30ed\u30b0\u30a4\u30f3\u307e\u3067\u306e\u6240\u8981\u6642\u9593\uff09\u304c\u3001\u300c\u6b63\u898f\u5206\u5e03\u300d\u306b\u5f93\u3046\u3068\u4eee\u5b9a\u3057\u305f\u5834\u5408\u3001\n  A\u3055\u3093\u304c\u300c\u6b21\u306b\u300d\u305d\u306e\u30a4\u30d9\u30f3\u30c8\u306b\u518d\u30ed\u30b0\u30a4\u30f3\u3059\u308b\u307e\u3067\u306e\u7d4c\u904e\u6642\u9593\u304c\u3001\u76f4\u8fd1\u6700\u5f8c\u306e\uff08\u30a4\u30d9\u30f3\u30c8\uff09\u30ed\u30b0\u30a4\u30f3\u6642\u523b\u304b\u3089\u3001\n\u3010 \u4e0a\u8a18\u306e\u300c\u5e73\u5747\u300d\uff08\u518d\u30ed\u30b0\u30a4\u30f3\u8fc4 \u7d4c\u904e\u6642\u9593\uff09\uff0b\u300c\u6a19\u6e96\u504f\u5dee\u300d\u00d7 \uff13 \u3011 \uff08\u5206\uff09\n\u3092\u8d85\u3048\u308b\u78ba\u7387\u306f\u3001\uff08\u6b63\u898f\u5206\u5e03\u306e\u78ba\u7387\u5bc6\u5ea6\u66f2\u7dda\u306e\u5b9a\u7fa9\u304b\u3089\uff09\u307b\u307c\u7686\u7121\u306b\u7b49\u3057\u3044\u3068\u307f\u306a\u3059\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\u3088\u3063\u3066\u3001A\u3055\u3093\u304c\u305d\u306e\u30b2\u30fc\u30e0\u30a4\u30d9\u30f3\u30c8\u306b\u300c\u6700\u5f8c\u306b\u30ed\u30b0\u30a4\u30f3\u3057\u305f\u6642\u523b\u300d\u304b\u3089\u3001\u300c\u73fe\u5728\u6642\u70b9\u300d\uff08\u30af\u30a8\u30ea\u5b9f\u884c\u6642\u523b\uff09\u307e\u3067\u306e\u7d4c\u904e\u6642\u9593\u304c\u3001\n  A\u3055\u3093\u306e\uff08\u305d\u306e\u30a4\u30d9\u30f3\u30c8\u306b\u3064\u3044\u3066\u306e\uff09\u904e\u53bb\u30ed\u30b0\u304b\u3089\u7b97\u51fa\u3055\u308c\u305f \u4e0a\u8a18\u306e\u6642\u9593\uff08\u5206\uff09\u306e\u9577\u3055\u3092\u8d85\u904e\u3057\u305f\u5834\u5408\u3001A\u3055\u3093\u306f\u305d\u306e\u30a4\u30d9\u30f3\u30c8\u304b\u3089\u300c\u96e2\u8131\u300d\u3057\u305f\u53ef\u80fd\u6027\u3092\u691c\u51fa\u3057\u3066\u3001\u8b66\u544a\u30a2\u30e9\u30fc\u30e0\u3092\u767a\u3057\u307e\u3059\u3002\n\u30fb \u3057\u304b\u3057\u3001A\u3055\u3093\u304c\u305d\u306e\u30b2\u30fc\u30e0\u30a4\u30d9\u30f3\u30c8\u306b\u300c\u6700\u5f8c\u306b\u30ed\u30b0\u30a4\u30f3\u3057\u305f\u6642\u523b\u300d\u304b\u3089\u3001\u300c\u73fe\u5728\u6642\u70b9\u300d\uff08\u30af\u30a8\u30ea\u5b9f\u884c\u6642\u523b\uff09\u307e\u3067\u3001\uff08\u305d\u306e\u30a4\u30d9\u30f3\u30c8\u304b\u3089\uff09\u4e00\u5ea6\u3082\u300c\u9000\u51fa\u300d\u305b\u305a\u306b\uff08\u3064\u307e\u308a\u3001(b)\u304c\u307e\u3060\u767a\u751f\u3057\u3066\u3044\u306a\u3044\uff09\u3001\u30a4\u30d9\u30f3\u30c8\u5185\u3067\u30d7\u30ec\u30fc\u3092\u7d9a\u3051\u3066\u3044\u308b\u53ef\u80fd\u6027\u306f\u3001\u5b8c\u5168\u306b\u306f\u5426\u5b9a\u3067\u304d\u307e\u305b\u3093\u3002\n\uff08\u53ef\u80fd\u6027\u3068\u3057\u3066\u3001A\u3055\u3093\u304c\u305d\u306e\u30b2\u30fc\u30e0\u30a4\u30d9\u30f3\u30c8\u306b\u53c2\u52a0\u30fb\u9000\u51fa\u3059\u308b\u6642\u9593\u9593\u9694\u304c\u3001\u3082\u3068\u3082\u3068\u300c\u6b63\u898f\u5206\u5e03\u300d\u306b\u5f93\u3063\u3066\u3044\u306a\u304b\u3063\u305f\u5834\u5408\u3084\u3001\u3082\u3068\u3082\u3068\u300c\u6b63\u898f\u5206\u5e03\u300d\u306b\u8fd1\u304b\u3063\u305f\u304c\u3001\u4f55\u3089\u304b\u306e\u52d5\u6a5f\u3084\u6c17\u5206\u3067\u6642\u9593\u9593\u9694\u306e\u7d71\u8a08\u5206\u5e03\uff08\u6bcd\u6570\u5206\u5e03\uff09\u304c\u5909\u7570\u3057\u305f\u3001\u306a\u3069\uff09\n\u30fb \u3053\u306e\u305f\u3081\u3001A\u3055\u3093\u304c\u3044\u307e\u3001\u7740\u76ee\u3057\u3066\u3044\u308b\u30b2\u30fc\u30e0\u30a4\u30d9\u30f3\u30c8\u3092\u30d7\u30ec\u30fc\u3057\u3066\u3044\u308b\u306e\u304b\u3001\u9000\u51fa\u3057\u305f\u306e\u304b\u3001\u3092\u9ad8\u3044\u78ba\u5ea6\u3067\u5224\u5b9a\u3067\u304d\u308b\u30c7\u30fc\u30bf\u30ab\u30e9\u30e0\n\uff08\u4f8b\uff1a\u305d\u306e\u30a4\u30d9\u30f3\u30c8\u306b\u53c2\u52a0\u3057\u3066\u3044\u308b\u9650\u308a\u3001\u30a4\u30d9\u30f3\u30c8\u306e\u4ed5\u69d8\u304b\u3089\u3057\u3066\u3001\u6570\u5341\u79d2\u4ee5\u5185\u306b\u3001\u6700\u4f4e\uff11\u56de\u306f\u3001\u300c\u653b\u6483\u300d\u3084\u300c\u9632\u5fa1\u300d\u3001\u300c\u9023\u643a\u76f8\u624b\u306e\u4ef2\u9593\u3078\u306e\u652f\u63f4\u300d\u306a\u3069\u306e\u30a2\u30af\u30b7\u30e7\u30f3\u304c\u767a\u751f\u3057\u305f\u308a\u3001\u300c\u30c0\u30e1\u30fc\u30b8\u300d\u3084\u300c\u597d\u611f\u5ea6\u300d\u30fb\u300c\u7d4c\u9a13\u5024\u300d\u304c\u4e0a\u4e0b\u3059\u308b\u30ed\u30b0\u30c7\u30fc\u30bf\u304c\u767a\u751f\u3059\u308b\uff09\n\u3092\u8abf\u3079\u3066\u3001(a) \u76f4\u8fd1\uff08\uff1d\u6700\u7d42\uff09\u30a4\u30d9\u30f3\u30c8\u30ed\u30b0\u30a4\u30f3\u6642\u523b \u306e\u3042\u3068\u3001\u73fe\u5728\u6642\u523b\uff08\u30af\u30a8\u30ea\u5b9f\u884c\u6642\u523b\uff09\u307e\u3067\u306e\u9593\u306b\u3001(b) \u30a4\u30d9\u30f3\u30c8\u304b\u3089\u306e\u9000\u51fa \u304c\u767a\u751f\u3057\u305f\u304b\u3069\u3046\u304b\u3092\u78ba\u8a8d\u3067\u304d\u308b\u3068\u3001\u3053\u308c\u307e\u3067\u6975\u7aef\u306b\u3088\u308a\u9577\u6642\u9593\u3001\u305d\u306e\u30a4\u30d9\u30f3\u30c8\u5185\u306b\u3068\u3069\u307e\u3063\u3066\u3044\u305f\u5834\u5408\u306b\u3001\u904e\u3063\u3066\u300c\u96e2\u8131\u30a2\u30e9\u30fc\u30c8\u300d\u3092\u51fa\u3057\u3066\u3057\u307e\u3046\u30ea\u30b9\u30af\u3092\u6e1b\u3089\u3059\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\uff08\u96e2\u8131\u30ea\u30b9\u30af\u304c\u751f\u3058\u3066\u3044\u308b\u306e\u306b\u3001\u300c\u96e2\u8131\u30a2\u30e9\u30fc\u30e0\u300d\u3092\u51fa\u3055\u306a\u3044\u300c\u30ea\u30b9\u30af\u300d\u3088\u308a\u3082\u3001\u96e2\u8131\u30ea\u30b9\u30af\u304c\u751f\u3058\u3066\u3044\u306a\u3044\u306e\u306b\u300c\u96e2\u8131\u30a2\u30e9\u30fc\u30c8\u300d\u3092\u51fa\u3057\u3066\u3057\u307e\u3046\u300c\u8aa4\u308a\u300d\u306e\u65b9\u304c\u3001\u4e00\u822c\u7684\u306b\u3001\u8a31\u5bb9\u5ea6\u5408\u3044\u306f\u9ad8\u3044\u3067\u3059\u304c\uff09\n\u30fb (b) \u30a4\u30d9\u30f3\u30c8\u304b\u3089\u306e\u9000\u51fa \u30ed\u30b0\u30c7\u30fc\u30bf\uff08\u30ab\u30e9\u30e0\uff09\u304cDB\u5185\u306b\u53d6\u5f97\u3055\u308c\u3066\u3044\u308c\u3070\u3001\u30af\u30a8\u30ea\u5b9f\u884c\u6642\u9593\uff08\u73fe\u5728\u6642\u523b\uff09\u3088\u308a\u524d\u306b\u3001\u3053\u306e\u9000\u51fa\u30ed\u30b0\u304c\u3042\u308a\u3001\u306a\u304a\u304b\u3064\u305d\u306e\u3042\u3068\u3001(a)\u30a4\u30d9\u30f3\u30c8\u518d\u8a2a\u30ed\u30b0\u304c\u306a\u3044\u30b2\u30fc\u30e0\u30e6\u30fc\u30b6\u3067\u3042\u308b\u3053\u3068\u3092\u3001\u4f8b\u3068\u3057\u3066\u4ee5\u4e0b\u306e\u30af\u30a8\u30ea\u306a\u3069\u3067\u78ba\u8a8d\u3067\u304d\u308b\u3068\u30d9\u30b9\u30c8\u3067\u3059\u3002\n\nuser_id_filter_query_example\n\n      select * from game_event_item_log TBL_1 \n      where exists \n      (select user_id from game_event_item_log TBL_2\n       where TBL_1.user_id = TBL_2.user_id \n             and max(TBL_2.event_logout_time) > max(TBL_2.event_login_time)\n             \u30fb\u30fb\u30fb\n      )\n      ;\n\n\n\u4ee5\u4e0b\u3067\u3082\u540c\u3058\u304b\u30fb\u30fb\u30fb\uff08\u7b11\uff09\n\nuser_id_filter_query_example\n\n      select user_id from game_event_item_log\n      group by user_id  \n      having max(event_logout_time) > max(event_login_time)\n      ;\n\n\n\n\n### __\u3010 \u30af\u30a8\u30ea\u306e\u51e6\u7406\u5185\u5bb9 \u3011__\n\n\u300cgame_event\u00d7\u30e6\u30fc\u30b6\u300d\u3054\u3068\u306b\u3001\u6700\u5f8c\u306b\u30a4\u30d9\u30f3\u30c8\u306b\u53c2\u52a0\u3057\u305f\u6642\u523b\u304b\u3089\uff08\u73fe\u5728\u307e\u3067\u306e\uff09\u7d4c\u904e\u6642\u9593\uff08\u5206\uff09\u304c\u3001\u305d\u306e\u30e6\u30fc\u30b6\u306e\u305d\u306e\u30a4\u30d9\u30f3\u30c8\u306b\u5bfe\u3059\u308b\u518d\u30ed\u30b0\u30a4\u30f3\u9593\u9694\u6642\u9593\u306e\u300c\u5e73\u5747\u5024\uff08\u5206\uff09\u300d\uff0b\u300c\u6a19\u6e96\u504f\u5dee\uff08\u5206\uff09\u300d\u00d7\uff15 \u3092\u8d85\u3048\u305f\u5834\u5408\u306b\u3001\u300e\u30a4\u30d9\u30f3\u30c8 \u96e2\u8131\u30a2\u30e9\u30fc\u30c8\u300f\u30d5\u30e9\u30b0\u306b\uff11\u3092\u7acb\u3066\u308b \u51e6\u7406\u3092\u5168\u30a2\u30af\u30c6\u30a3\u30d6UU\u3001\u9032\u884c\u4e2d\u306e\u5168\u30b2\u30fc\u30e0\u30a4\u30d9\u30f3\u30c8\u306b\u3064\u3044\u3066\u3001\u4e00\u62ec\u51e6\u7406\u3059\u308b\u3002\n\n___\n\n### __\u3010 \u60f3\u5b9a\u3059\u308b\u30b5\u30f3\u30d7\u30eb\u30fbDB\u30c6\u30fc\u30d6\u30eb \u3011__\n\n#### __\u30c6\u30fc\u30d6\u30eb\u7269\u7406\u540d\uff1agame_event_item_log__\n\n#### __\u30ab\u30e9\u30e0\u7269\u7406\u540d__ \n\n- game_event\uff1a\u30b2\u30fc\u30e0\u30a4\u30d9\u30f3\u30c8\uff08\u540d or ID\uff09\n- user_id \uff1a\u30b2\u30fc\u30e0\u30a4\u30d9\u30f3\u30c8\u53c2\u52a0\u30e6\u30fc\u30b6ID\n- datetime \uff1a\u305d\u306e\u300c\u30b2\u30fc\u30e0\u30a4\u30d9\u30f3\u30c8\u300d\u306b\u3001\u305d\u306e\u300c\u30e6\u30fc\u30b6ID\u300d\u306e\u30e6\u30fc\u30b6\u304c\u3001\u53c2\u52a0\u3057\u305f\u6642\u523b\uff08YYYY-MM-DD HH24:MI:SS\uff09\n\n___\n\n### __\uff1c \u4e3b\u554f\u3044\u5408\u308f\u305b\u6587\u306e select \u53e5 \u3067 \u53c2\u7167\u3055\u308c\u3066\u5f97\u3089\u308c\u308b\u30ab\u30e9\u30e0 \uff1e__\n\n- __game_event\uff1a\u30b2\u30fc\u30e0\u30a4\u30d9\u30f3\u30c8\uff08\u540d or ID\uff09__\n- __user_id\uff1a\u30b2\u30fc\u30e0\u30a4\u30d9\u30f3\u30c8\u53c2\u52a0\u30e6\u30fc\u30b6ID__\n- AVG_event_interval_per_game_event_user\uff1a\u4e0a\u8a18\u30e6\u30fc\u30b6\u306e\uff08\u305d\u306e\u30b2\u30fc\u30e0\u30a4\u30d9\u30f3\u30c8\u306b\u518d\u30ed\u30b0\u30a4\u30f3\u3059\u308b\u307e\u3067\u306b\u304b\u304b\u3063\u305f\u500b\u3005\u306e\u6642\u9593\u9593\u9694\uff08\u5206\u5358\u4f4d\uff09\u306e\u5e73\u5747\u5024\n- SDTDEV_event_interval_per_game_event_user: \u4e0a\u8a18\u30e6\u30fc\u30b6\u306e\uff08\u305d\u306e\u30b2\u30fc\u30e0\u30a4\u30d9\u30f3\u30c8\u306b\u518d\u30ed\u30b0\u30a4\u30f3\u3059\u308b\u307e\u3067\u306b\u304b\u304b\u3063\u305f\u500b\u3005\u306e\u6642\u9593\u9593\u9694\uff08\u5206\u5358\u4f4d\uff09\u306e\u3070\u3089\u3064\u304d\u5ea6\u5408\u3044\uff08\u6a19\u6e96\u504f\u5dee\uff09\n- last_event_timestamp1\uff1a\u5404\u30e6\u30fc\u30b6\u306e\uff08\u305d\u306e\u30b2\u30fc\u30e0\u30a4\u30d9\u30f3\u30c8\uff09\u6700\u5f8c\u30ed\u30b0\u30a4\u30f3\u6642\u523b\uff08YYYY-MM-DD HH24:MI:SS\uff09\n- present_timestamp\uff1a \u30af\u30a8\u30ea\u5b9f\u884c\u6642\u523b\uff08YYYY-MM-DD HH24:MI:SS\uff09\n- minutes_since_last_event_time\uff1a\u305d\u306e\u30e6\u30fc\u30b6ID\uff08\u306e\u30e6\u30fc\u30b6\uff09\u304c\u305d\u306e\u30b2\u30fc\u30e0\u30a4\u30d9\u30f3\u30c8\u306b\u6700\u5f8c\u306b\u30ed\u30b0\u30a4\u30f3\u3057\u3066\u304b\u3089\u3001\u73fe\u5728\u6642\u523b\uff08\u30af\u30a8\u30ea\u5b9f\u884c\u6642\u523b\uff09\u307e\u3067\u306e\u7d4c\u904e\u6642\u9593\uff08\u5206\u5358\u4f4d\uff09\n- past_interval_AVG_plus_3STDDEV_minutes\uff1a\u305d\u306e\u30e6\u30fc\u30b6\u306e\uff08\u305d\u306e\u30b2\u30fc\u30e0\u30a4\u30d9\u30f3\u30c8\u306b\u5bfe\u3059\u308b\uff09\u6700\u7d42\u30ed\u30b0\u30a4\u30f3\u6642\u523b\u304b\u3089\u3001\u3053\u306e\u5206\u6570\u3092\u8d85\u3048\u305f\u3089\u3001\u3053\u306e\u30b2\u30fc\u30e0\u30a4\u30d9\u30f3\u30c8\u304b\u3089\u96e2\u8131\u3057\u305f\u30ea\u30b9\u30af\u304c\u9ad8\u307e\u308b\u6642\u9593\u306e\u9577\u3055 __\uff08 \u5b9a\u7fa9 \uff09 \u3053\u306e\u30e6\u30fc\u30b6\u306e\u3001\u3053\u306e\u30a4\u30d9\u30f3\u30c8\u306b\u5bfe\u3059\u308b\u904e\u53bb\u306e\u3059\u3079\u3066\u306e\u518d\u30ed\u30b0\u30a4\u30f3\u9593\u9694\u6642\u9593\uff08\u5206\uff09\u30c7\u30fc\u30bf\u306e\u300c\u5e73\u5747\u5024\uff08\u5206\uff09\u300d\uff0b\u300c\u6a19\u6e96\u504f\u5dee\uff08\u5206\uff09\u300d*3\uff09__\n- __FLG_withdrawal_alert__\uff1a__\u305d\u306e\u30e6\u30fc\u30b6\u304c\u3001\u3053\u306e\u30b2\u30fc\u30e0\u30a4\u30d9\u30f3\u30c8\u304b\u3089\u300c\u96e2\u8131\u300d\u3057\u305f\u30ea\u30b9\u30af\u6709\u308a\uff08\u300c\uff11\u300d\uff09\uff0f\u7121\u3057\uff08\uff10\uff09\u306e\u8b66\u544a\u30d5\u30e9\u30b0__    \n\n___\n\n__\u4ee5\u4e0b\u306e\uff14\u3064\u306e\u5217\u306f\u3001\u4ee5\u4e0b\u3092\u307f\u308b\u305f\u3081\u306b\u3064\u304b\u3044\u307e\u3059\u3002__\n\n- __Total_user_num_in_this_game_event__\n- __withdrawal_alert_user_num__\n- __withdrawal_no_alert_user_num__\n- __withdrawal_flag_null_user_num__\n\n__\u73fe\u5728\u9032\u884c\u4e2d\u306e\u30b2\u30fc\u30e0\u30a4\u30d9\u30f3\u30c8\u6bce\u306b\u3001\uff08\u30a4\u30d9\u30f3\u30c8\uff09\u30a2\u30af\u30c6\u30a3\u30d6\uff35\uff35\u4eba\u6570 \u304c\u4f55\u4eba\u3044\u3066\u3001\u305d\u306e\u3046\u3061\u3044\u307e\u4f55\u4eba\u304c\u3001\uff08\u305d\u306e\u30a4\u30d9\u30f3\u30c8\u304b\u3089\uff09\u96e2\u8131\u306e\u30ea\u30b9\u30af\u304c\u9ad8\u307e\u3063\u3066\u3044\u308b\u306e\u304b\u3092\u3001\u4eba\u6570\u5358\u4f4d\u3067\u96c6\u8a08\u3059\u308b\u3068\u3053\u308d\u307e\u3067\u3001\u30af\u30a8\u30ea\u3092\u3064\u304f\u308a\u3053\u3093\u3067\u3044\u308b\u306e\u304b\uff1f__\n\n* __\uff08\u30a4\u30d9\u30f3\u30c8\u5225\uff09\u300c\u30a2\u30af\u30c6\u30a3\u30d6\uff35\uff35\u4eba\u6570\u300d\u5217__\n* __\uff08\u30a4\u30d9\u30f3\u30c8\u5225\uff09\u300c\u96e2\u8131\u30a2\u30e9\u30fc\u30c8\u6709\u308a\uff35\uff35\u4eba\u6570\u300d\u5217__\n* __\uff08\u30a4\u30d9\u30f3\u30c8\u5225\uff09\u300c\u96e2\u8131\u30a2\u30e9\u30fc\u30c8\u306a\u3057\uff35\uff35\u4eba\u6570\u300d\u5217__\n* __\uff08\u30a4\u30d9\u30f3\u30c8\u5225\uff09\u300c\u96e2\u8131\u30a2\u30e9\u30fc\u30c8\u7b97\u51fa\u4e0d\u80fd \uff35\uff35\u4eba\u6570\u300d\u5217__\n      * \u203b\u7b97\u51fa\u4e0d\u80fd\uff1a\u300c\u96e2\u8131\u30a2\u30e9\u30fc\u30c8\u300d\u5b9a\u7fa9\u5f0f\u306e\u5206\u6bcd\uff08\u6d41\u5165\u9593\u9694\u306e\u6a19\u6e96\u504f\u5dee\uff09\u304c\u30bc\u30ed\u3067\u30bc\u30ed\u3067\u5272\u308c\u306a\u3044\u30a8\u30e9\u30fc\u306a\u3069\uff09\u3092\u8868\u793a\u3059\u308b\u5217\u3092\u8ffd\u52a0\u3067\u304d\u308b\u3002\n\n\n### __\uff1c \u30ec\u30b3\u30fc\u30c9\u8868\u793a\u9806 \uff1e__\n\ngame_event, user_id\n\n\n\n### __\uff1c \uff33\uff31\uff2c \uff1e__\n\n#### __\u4e3b\u306b\u4f7f\u3063\u305fSQL\u6a5f\u80fd\u306f\u3001\u4ee5\u4e0b\u306e\uff13\u3064\u3067\u3059\u3002__\n\n* __With\u53e5__\u3000\uff1a \u4e3b\u554f\u3044\u5408\u308f\u305b\u6587 \u306b\u305f\u3069\u308a\u3064\u304f\u307e\u3067\u306e\u4e2d\u9593\u4f5c\u696d\u30c6\u30fc\u30d6\u30eb\uff08View\u306e\u3088\u3046\u306a\u3082\u306e\uff09\u3092\u4f55\u56de\u304b\u3001\u3064\u3065\u3051\u3066\u751f\u6210\n* __\u76f8\u95a2\u30b5\u30d6\u30af\u30a8\u30ea__\u3000\uff1a \u30ed\u30b0\u30a4\u30f3\u6642\u9593 \u524d\u5f8c\u3059\u308b\uff12\u30ec\u30b3\u30fc\u30c9\u306e\u30ed\u30b0\u30a4\u30f3\u6642\u523b\u3092\u5f15\u304d\u7b97\u3057\u3066\u7d4c\u904e\u6642\u9593\u3092\u7b97\u51fa\n* __avg(), stddev(), max() \u95a2\u6570\u3068\u3001over(partition by column_name order by column_name__ \uff1a \u30b2\u30fc\u30e0\u30a4\u30d9\u30f3\u30c8\u3068\u30e6\u30fc\u30b6ID\u6bce\u306e\uff08\u518d\u30ed\u30b0\u30a4\u30f3\u6240\u8981\u6642\u9593\u306e\u77ed\u3055\uff09\u5e73\u5747\u5024\u30fb\u6a19\u6e96\u504f\u5dee\u3001\u3068 \u305d\u306e\u30e6\u30fc\u30b6\u304c\u305d\u306e\u30b2\u30fc\u30e0\u30a4\u30d9\u30f3\u30c8\u306b\u6700\u5f8c\u306e\u30ed\u30b0\u30a4\u30f3\u3057\u305f\u6642\u523b\uff08max(datetime))\u3092\u7b97\u51fa\uff09\n\n\n\n```{SQL:SQL}\nWith temp AS (\nSELECT tbl_0.game_event,\n       tbl_0.user_id, \n       tbl_0.datetime,\n        (SELECT MAX(datetime)\n\t\t FROM game_event_item_log tbl_1 tbl_1\n\t\t where tbl_1.datetime < tbl_0.datetime) AS latest\nFROM game_event_item_log tbl_1 tbl_0\ngroup by tbl_0.game_event, tbl_0.user_id, tbl_0.datetime\norder by tbl_0.game_event, tbl_0.user_id, tbl_0.datetime desc\n), temp_2 AS (\nSELECT  game_event,\n        user_id,\n        datetime,\n\t\tlatest,\t\n\t\tabs(datediff(minute,datetime, latest)) AS time_interval\nFROM temp\norder by game_event, user_id, datetime desc\n), temp_3 AS (\nSELECT game_event,\n       user_id,\n\t   datetime,\n\t   avg(time_interval) over(partition by game_event, user_id) AS AVG_event_interval_per_game_event_user,\n\t   round(stddev(time_interval) over(partition by game_event, user_id), 2) AS SDTDEV_event_interval_per_game_event_user,\n\t   max(datetime) over(partition by game_event, user_id) AS last_event_timestamp\nfrom temp_2\norder by game_event, user_id\n), temp_4 AS (\nSELECT game_event,\n       user_id,\n\t   AVG_event_interval_per_game_event_user,\n\t   SDTDEV_event_interval_per_game_event_user,\n\t   last_event_timestamp\nfrom temp_3\ngroup by game_event, user_id, AVG_event_interval_per_game_event_user, SDTDEV_event_interval_per_game_event_user,last_event_timestamp\norder by game_event, user_id\n), temp_5 AS (\nselect *,\n       getdate() AS present_timestamp,\n\t   abs(datediff(minute, last_event_timestamp, getdate())) AS minutes_since_last_event_time,\n\t   (AVG_event_interval_per_game_event_user +  SDTDEV_event_interval_per_game_event_user*3) AS past_interval_AVG_plus_5_STDDEV_minutes\n\t   from temp_4\norder by game_event, user_id\n), temp_6 AS (\nselect *,\n\t   case when minutes_since_last_event_time >= past_interval_AVG_plus_5_STDDEV_minutes  then 1\n\t        when minutes_since_last_event_time <  past_interval_AVG_plus_5_STDDEV_minutes  then 0\n\t   end AS  FLG_withdrawal_alert\nfrom temp_5\norder by game_event, user_id\n)\nselect *,\n       count(case when FLG_withdrawal_alert = 1 then 1 else null end) over(partition by game_event) AS  withdrawal_alert_user_num,\n       count(case when FLG_withdrawal_alert = 0 then 1 else null end) over(partition by game_event) AS  withdrawal_no_alert_user_num,\n       count(case when FLG_withdrawal_alert is NULL then 1 else null end)  over(partition by game_event) AS  withdrawal_flag_null_user_num,\n       count(*) OVER (PARTITION BY game_event) AS Total_user_num_in_this_game_event\nfrom temp_6\norder by game_event, FLG_withdrawal_alert\n;\n```\n\n\n\n\n___\n\n# __\u3010 \u300c\u96e2\u8131\u30a2\u30e9\u30fc\u30c8\u300d\u8aa4\u4fe1\u30ea\u30b9\u30af\u306b\u95a2\u308f\u308b\u7559\u610f\u70b9 \u3011__\n\n\u30fb \u4eca\u56de\u306f\u3001\u300c\u3042\u308b\u30e6\u30fc\u30b6\u300d\u304c\u300c\u305d\u306e\u30a4\u30d9\u30f3\u30c8\u300d\u306b\u3001(a) \uff1c\u53c2\u52a0\u3059\u308b\uff1e ==> (b) \uff1c\u9000\u51fa\u3059\u308b\uff1e ==> (c) \uff1c\u518d\u3073\u53c2\u52a0\u3059\u308b\uff1e \u306e\u30a2\u30af\u30b7\u30e7\u30f3\u30d5\u30ed\u30fc\u306b\u7740\u76ee\u3057\u3066\u3001   \u904e\u53bb\u306b\uff08\u305d\u306e\u30e6\u30fc\u30b6\u304c\u3001\u305d\u306e\u30a4\u30d9\u30f3\u30c8\u306b\u53c2\u52a0\u3057\u305f\u30ed\u30b0\u30c7\u30fc\u30bf\u4e0a\u306e\uff09(a) \u30a4\u30d9\u30f3\u30c8\u30ed\u30b0\u30a4\u30f3 \uff5e (c) \u30a4\u30d9\u30f3\u30c8\u518d\u30ed\u30b0\u30a4\u30f3 \u307e\u3067\u306b\u304b\u304b\u3063\u305f\u6642\u9593\uff08\u5206\uff09\u306b\u6ce8\u76ee\u3057\u307e\u3057\u305f\u3002\n   \n   \u3042\u308b\u30e6\u30fc\u30b6\uff08\uff21\u3055\u3093\uff09\u304c\u3001\u3042\u308b\u30a4\u30d9\u30f3\u30c8\u306b \u7d2f\u8a08\uff11\uff15\u56de\u53c2\u52a0\u3057\u305f\u5834\u5408\u3001\uff21\u3055\u3093\u306e\uff08\u305d\u306e\u30a4\u30d9\u30f3\u30c8\u306b\u7d10\u3065\u3051\u3089\u308c\u305f\uff09\uff11\uff14\u56de\u5206\u306e \u30a4\u30d9\u30f3\u30c8\u30ed\u30b0\u30a4\u30f3 \uff5e \u30a4\u30d9\u30f3\u30c8\u518d\u30ed\u30b0\u30a4\u30f3 \u306e\u9593\u306e\u6240\u8981\u6642\u9593\uff08\u5206\uff09\u30c7\u30fc\u30bf\uff08\u30c7\u30fc\u30bf\u6570\uff1a14\u30ec\u30b3\u30fc\u30c9\uff09\u306e\u300c\u5e73\u5747\u5024\u300d\u3068\u3070\u3089\u3064\u304d\u5ea6\u5408\u3044\uff08\u300c\u6a19\u6e96\u504f\u5dee\u300d\uff09\u3092SQL\u5185\u3067\u7b97\u51fa\u3057\u307e\u3059\u3002\n  \n  A\u3055\u3093\u304c\u305d\u306e\u30a4\u30d9\u30f3\u30c8\u306b\u53c2\u52a0\u3059\u308b\u884c\u52d5\u983b\u5ea6\uff08\u524d\u56de\u30ed\u30b0\u30a4\u30f3\u304b\u3089\u518d\u30ed\u30b0\u30a4\u30f3\u307e\u3067\u306e\u6240\u8981\u6642\u9593\uff09\u304c\u3001\u300c\u6b63\u898f\u5206\u5e03\u300d\u306b\u5f93\u3046\u3068\u4eee\u5b9a\u3057\u305f\u5834\u5408\u3001\n  A\u3055\u3093\u304c\u300c\u6b21\u306b\u300d\u305d\u306e\u30a4\u30d9\u30f3\u30c8\u306b\u518d\u30ed\u30b0\u30a4\u30f3\u3059\u308b\u307e\u3067\u306e\u7d4c\u904e\u6642\u9593\u304c\u3001\u76f4\u8fd1\u6700\u5f8c\u306e\uff08\u30a4\u30d9\u30f3\u30c8\uff09\u30ed\u30b0\u30a4\u30f3\u6642\u523b\u304b\u3089\u3001\n  \n  \u3010 \u4e0a\u8a18\u306e\u300c\u5e73\u5747\u300d\uff08\u518d\u30ed\u30b0\u30a4\u30f3\u8fc4 \u7d4c\u904e\u6642\u9593\uff09\uff0b\u300c\u6a19\u6e96\u504f\u5dee\u300d\u00d7 \uff13 \u3011 \uff08\u5206\uff09\n  \n  \u3092\u8d85\u3048\u308b\u78ba\u7387\u306f\u3001\uff08\u6b63\u898f\u5206\u5e03\u306e\u78ba\u7387\u5bc6\u5ea6\u66f2\u7dda\u306e\u5b9a\u7fa9\u304b\u3089\uff09\u307b\u307c\u7686\u7121\u306b\u7b49\u3057\u3044\u3068\u307f\u306a\u3059\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n  \n  \u3088\u3063\u3066\u3001A\u3055\u3093\u304c\u305d\u306e\u30b2\u30fc\u30e0\u30a4\u30d9\u30f3\u30c8\u306b\u300c\u6700\u5f8c\u306b\u30ed\u30b0\u30a4\u30f3\u3057\u305f\u6642\u523b\u300d\u304b\u3089\u3001\u300c\u73fe\u5728\u6642\u70b9\u300d\uff08\u30af\u30a8\u30ea\u5b9f\u884c\u6642\u523b\uff09\u307e\u3067\u306e\u7d4c\u904e\u6642\u9593\u304c\u3001\n  A\u3055\u3093\u306e\uff08\u305d\u306e\u30a4\u30d9\u30f3\u30c8\u306b\u3064\u3044\u3066\u306e\uff09\u904e\u53bb\u30ed\u30b0\u304b\u3089\u7b97\u51fa\u3055\u308c\u305f \u4e0a\u8a18\u306e\u6642\u9593\uff08\u5206\uff09\u306e\u9577\u3055\u3092\u8d85\u904e\u3057\u305f\u5834\u5408\u3001A\u3055\u3093\u306f\u305d\u306e\u30a4\u30d9\u30f3\u30c8\u304b\u3089\u300c\u96e2\u8131\u300d\u3057\u305f\u53ef\u80fd\u6027\u3092\u691c\u51fa\u3057\u3066\u3001\u8b66\u544a\u30a2\u30e9\u30fc\u30e0\u3092\u767a\u3057\u307e\u3059\u3002\n\n\u30fb \u3057\u304b\u3057\u3001A\u3055\u3093\u304c\u305d\u306e\u30b2\u30fc\u30e0\u30a4\u30d9\u30f3\u30c8\u306b\u300c\u6700\u5f8c\u306b\u30ed\u30b0\u30a4\u30f3\u3057\u305f\u6642\u523b\u300d\u304b\u3089\u3001\u300c\u73fe\u5728\u6642\u70b9\u300d\uff08\u30af\u30a8\u30ea\u5b9f\u884c\u6642\u523b\uff09\u307e\u3067\u3001\uff08\u305d\u306e\u30a4\u30d9\u30f3\u30c8\u304b\u3089\uff09\u4e00\u5ea6\u3082\u300c\u9000\u51fa\u300d\u305b\u305a\u306b\uff08\u3064\u307e\u308a\u3001(b)\u304c\u307e\u3060\u767a\u751f\u3057\u3066\u3044\u306a\u3044\uff09\u3001\u30a4\u30d9\u30f3\u30c8\u5185\u3067\u30d7\u30ec\u30fc\u3092\u7d9a\u3051\u3066\u3044\u308b\u53ef\u80fd\u6027\u306f\u3001\u5b8c\u5168\u306b\u306f\u5426\u5b9a\u3067\u304d\u307e\u305b\u3093\u3002\n  \n  \uff08\u53ef\u80fd\u6027\u3068\u3057\u3066\u3001A\u3055\u3093\u304c\u305d\u306e\u30b2\u30fc\u30e0\u30a4\u30d9\u30f3\u30c8\u306b\u53c2\u52a0\u30fb\u9000\u51fa\u3059\u308b\u6642\u9593\u9593\u9694\u304c\u3001\u3082\u3068\u3082\u3068\u300c\u6b63\u898f\u5206\u5e03\u300d\u306b\u5f93\u3063\u3066\u3044\u306a\u304b\u3063\u305f\u5834\u5408\u3084\u3001\u3082\u3068\u3082\u3068\u300c\u6b63\u898f\u5206\u5e03\u300d\u306b\u8fd1\u304b\u3063\u305f\u304c\u3001\u4f55\u3089\u304b\u306e\u52d5\u6a5f\u3084\u6c17\u5206\u3067\u6642\u9593\u9593\u9694\u306e\u7d71\u8a08\u5206\u5e03\uff08\u6bcd\u6570\u5206\u5e03\uff09\u304c\u5909\u7570\u3057\u305f\u3001\u306a\u3069\uff09\n\n\u30fb \u3053\u306e\u305f\u3081\u3001A\u3055\u3093\u304c\u3044\u307e\u3001\u7740\u76ee\u3057\u3066\u3044\u308b\u30b2\u30fc\u30e0\u30a4\u30d9\u30f3\u30c8\u3092\u30d7\u30ec\u30fc\u3057\u3066\u3044\u308b\u306e\u304b\u3001\u9000\u51fa\u3057\u305f\u306e\u304b\u3001\u3092\u9ad8\u3044\u78ba\u5ea6\u3067\u5224\u5b9a\u3067\u304d\u308b\u30c7\u30fc\u30bf\u30ab\u30e9\u30e0\n\n  \uff08\u4f8b\uff1a\u305d\u306e\u30a4\u30d9\u30f3\u30c8\u306b\u53c2\u52a0\u3057\u3066\u3044\u308b\u9650\u308a\u3001\u30a4\u30d9\u30f3\u30c8\u306e\u4ed5\u69d8\u304b\u3089\u3057\u3066\u3001\u6570\u5341\u79d2\u4ee5\u5185\u306b\u3001\u6700\u4f4e\uff11\u56de\u306f\u3001\u300c\u653b\u6483\u300d\u3084\u300c\u9632\u5fa1\u300d\u3001\u300c\u9023\u643a\u76f8\u624b\u306e\u4ef2\u9593\u3078\u306e\u652f\u63f4\u300d\u306a\u3069\u306e\u30a2\u30af\u30b7\u30e7\u30f3\u304c\u767a\u751f\u3057\u305f\u308a\u3001\u300c\u30c0\u30e1\u30fc\u30b8\u300d\u3084\u300c\u597d\u611f\u5ea6\u300d\u30fb\u300c\u7d4c\u9a13\u5024\u300d\u304c\u4e0a\u4e0b\u3059\u308b\u30ed\u30b0\u30c7\u30fc\u30bf\u304c\u767a\u751f\u3059\u308b\uff09\n  \n   \u3092\u8abf\u3079\u3066\u3001(a) \u76f4\u8fd1\uff08\uff1d\u6700\u7d42\uff09\u30a4\u30d9\u30f3\u30c8\u30ed\u30b0\u30a4\u30f3\u6642\u523b \u306e\u3042\u3068\u3001\u73fe\u5728\u6642\u523b\uff08\u30af\u30a8\u30ea\u5b9f\u884c\u6642\u523b\uff09\u307e\u3067\u306e\u9593\u306b\u3001(b) \u30a4\u30d9\u30f3\u30c8\u304b\u3089\u306e\u9000\u51fa \u304c\u767a\u751f\u3057\u305f\u304b\u3069\u3046\u304b\u3092\u78ba\u8a8d\u3067\u304d\u308b\u3068\u3001\u3053\u308c\u307e\u3067\u6975\u7aef\u306b\u3088\u308a\u9577\u6642\u9593\u3001\u305d\u306e\u30a4\u30d9\u30f3\u30c8\u5185\u306b\u3068\u3069\u307e\u3063\u3066\u3044\u305f\u5834\u5408\u306b\u3001\u904e\u3063\u3066\u300c\u96e2\u8131\u30a2\u30e9\u30fc\u30c8\u300d\u3092\u51fa\u3057\u3066\u3057\u307e\u3046\u30ea\u30b9\u30af\u3092\u6e1b\u3089\u3059\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n   \n   \uff08\u96e2\u8131\u30ea\u30b9\u30af\u304c\u751f\u3058\u3066\u3044\u308b\u306e\u306b\u3001\u300c\u96e2\u8131\u30a2\u30e9\u30fc\u30e0\u300d\u3092\u51fa\u3055\u306a\u3044\u300c\u30ea\u30b9\u30af\u300d\u3088\u308a\u3082\u3001\u96e2\u8131\u30ea\u30b9\u30af\u304c\u751f\u3058\u3066\u3044\u306a\u3044\u306e\u306b\u300c\u96e2\u8131\u30a2\u30e9\u30fc\u30c8\u300d\u3092\u51fa\u3057\u3066\u3057\u307e\u3046\u300c\u8aa4\u308a\u300d\u306e\u65b9\u304c\u3001\u4e00\u822c\u7684\u306b\u3001\u8a31\u5bb9\u5ea6\u5408\u3044\u306f\u9ad8\u3044\u3067\u3059\u304c\uff09\n\n\u30fb (b) \u30a4\u30d9\u30f3\u30c8\u304b\u3089\u306e\u9000\u51fa \u30ed\u30b0\u30c7\u30fc\u30bf\uff08\u30ab\u30e9\u30e0\uff09\u304cDB\u5185\u306b\u53d6\u5f97\u3055\u308c\u3066\u3044\u308c\u3070\u3001\u30af\u30a8\u30ea\u5b9f\u884c\u6642\u9593\uff08\u73fe\u5728\u6642\u523b\uff09\u3088\u308a\u524d\u306b\u3001\u3053\u306e\u9000\u51fa\u30ed\u30b0\u304c\u3042\u308a\u3001\u306a\u304a\u304b\u3064\u305d\u306e\u3042\u3068\u3001(a)\u30a4\u30d9\u30f3\u30c8\u518d\u8a2a\u30ed\u30b0\u304c\u306a\u3044\u30b2\u30fc\u30e0\u30e6\u30fc\u30b6\u3067\u3042\u308b\u3053\u3068\u3092\u3001\u4f8b\u3068\u3057\u3066\u4ee5\u4e0b\u306e\u30af\u30a8\u30ea\u306a\u3069\u3067\u78ba\u8a8d\u3067\u304d\u308b\u3068\u30d9\u30b9\u30c8\u3067\u3059\u3002\n\n```{SQL:user_id_filter_query_example}\n\n      select * from game_event_item_log TBL_1 \n      where exists \n      (select user_id from game_event_item_log TBL_2\n       where TBL_1.user_id = TBL_2.user_id \n             and max(TBL_2.event_logout_time) > max(TBL_2.event_login_time)\n             \u30fb\u30fb\u30fb\n      )\n      ;\n```   \n\n\u4ee5\u4e0b\u3067\u3082\u540c\u3058\u304b\u30fb\u30fb\u30fb\uff08\u7b11\uff09\n\n```{SQL:user_id_filter_query_example}\n\n      select user_id from game_event_item_log\n      group by user_id  \n      having max(event_logout_time) > max(event_login_time)\n      ;\n```   \n___\n", "tags": ["SQL", "\u30de\u30fc\u30b1\u30c6\u30a3\u30f3\u30b0", "\u30c7\u30fc\u30bf\u5206\u6790", "\u30b9\u30de\u30db\u30b2\u30fc\u30e0", "\u30a2\u30af\u30bb\u30b9\u89e3\u6790"]}