{"tags": ["three.js", "WebGL"], "context": "Three.js\u306eMikuMikuDance\u30b5\u30f3\u30d7\u30eb\u3092\u3001\u30c7\u30a3\u30b9\u30b3\u98a8\u306a\u30e9\u30a4\u30c6\u30a3\u30f3\u30b0\u306b\u3057\u3066\u307f\u305f\u3060\u3051\u3002\n\u30c7\u30e2\uff1ahttps://mo49.github.io/qiita/20161016/\n\u30b3\u30fc\u30c9\uff1ahttps://github.com/mo49/qiita/blob/master/docs/20161016/index.html\n\n\n\u30e2\u30c7\u30eb\u306e\u30ed\u30fc\u30c9\u3068\u30c7\u30fc\u30bf\u306e\u7d10\u4ed8\u3051\ncreateMMD() {\n\n    const onProgress = ( xhr ) => {\n        if ( xhr.lengthComputable ) {\n            const percentComplete = xhr.loaded / xhr.total * 100;\n            console.log( Math.round(percentComplete, 2) + '% downloaded' );\n        }\n    };\n\n    const onError = ( xhr ) => {\n        console.log('error');\n    };\n\n    const modelFile = 'models/model/model.pmd'; // \u30e2\u30c7\u30eb\u30c7\u30fc\u30bf\uff08\u30ad\u30e3\u30e9\uff09\n    const stageFile = 'models/stage/stage.pmd'; // \u30e2\u30c7\u30eb\u30c7\u30fc\u30bf\uff08\u30b9\u30c6\u30fc\u30b8\uff09\n    const vmdFiles = [ 'vmds/dance.vmd' ];      // \u30e2\u30fc\u30b7\u30e7\u30f3\u30c7\u30fc\u30bf\uff08\u30ad\u30e3\u30e9\uff09\n    const cameraFiles = [ 'vmds/camera.vmd' ];  // \u30e2\u30fc\u30b7\u30e7\u30f3\u30c7\u30fc\u30bf\uff08\u30ab\u30e1\u30e9\uff09\n    const audioFile = 'audios/audio.mp3';\n\n    this.helper = new THREE.MMDHelper( this.renderer );\n\n    const loader = new THREE.MMDLoader();\n    loader.setDefaultTexturePath( './models/default/' );\n\n    loader.loadModel( modelFile, ( object ) => { // SkinnedMesh\u3092\u751f\u6210\n\n        this.mesh = object;\n\n        loader.loadModel( stageFile, ( stage ) => {\n\n            loader.loadVmds( vmdFiles, ( vmd ) => {\n\n                loader.loadVmds( cameraFiles, ( vmd2 ) => {\n\n                    loader.loadAudio( audioFile, ( audio, listener ) => {\n\n                        listener.position.z = 10;\n\n                        this.helper.add( this.mesh );\n                        loader.pourVmdIntoModel( this.mesh, vmd ); // \u30a2\u30cb\u30e1\u30fc\u30b7\u30e7\u30f3\u30c7\u30fc\u30bf\u3092\u6d41\u3057\u8fbc\u3080\n                        this.helper.setAnimation( this.mesh );\n\n                        this.helper.setCamera( this.camera );\n                        loader.pourVmdIntoCamera( this.camera, vmd2 );\n                        this.helper.setCameraAnimation( this.camera );\n\n                        this.helper.setAudio( audio, listener );\n\n                        this.helper.unifyAnimationDuration(); // \u5404\u7a2e\u30a2\u30cb\u30e1\u30fc\u30b7\u30e7\u30f3\u3001\u97f3\u697d\u30c7\u30fc\u30bf\u306e\u6642\u9593\u3092\u305d\u308d\u3048\u308b\n\n                        this.helper.setPhysics( this.mesh ); // \u7269\u7406\u6f14\u7b97\n\n                        this.scene.add( this.mesh );\n                        this.scene.add( stage );\n                        this.scene.add( audio );\n                        this.scene.add( listener );\n\n                    }, onProgress, onError );\n\n                }, onProgress, onError );\n\n            }, onProgress, onError );\n\n        }, onProgress, onError );\n\n    }, onProgress, onError );\n}\n\n\n\n\u30ec\u30f3\u30c0\u30ea\u30f3\u30b0\n// WebGLRenderer\u3067\u306f\u306a\u304fMMDHelper\nthis.helper.animate( this.clock.getDelta() );\nthis.helper.render( this.scene, this.camera );\n\n\n\n\u516c\u5f0f\u30b5\u30f3\u30d7\u30eb\n\n\nhttps://threejs.org/examples/?q=mmd\nhttps://takahirox.github.io/MMDLoader-app/\n\n\n\n\n\u53c2\u8003\nVPVP wiki\nThree.js\u3067MMD\u3092\u4f7f\u3063\u3066\u307f\u308b\n\n\n\nThree.js\u306eMikuMikuDance\u30b5\u30f3\u30d7\u30eb\u3092\u3001\u30c7\u30a3\u30b9\u30b3\u98a8\u306a\u30e9\u30a4\u30c6\u30a3\u30f3\u30b0\u306b\u3057\u3066\u307f\u305f\u3060\u3051\u3002\n\n\u30c7\u30e2\uff1ahttps://mo49.github.io/qiita/20161016/\n\n\u30b3\u30fc\u30c9\uff1ahttps://github.com/mo49/qiita/blob/master/docs/20161016/index.html\n\n![\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2016-10-16 23.32.34.png](https://qiita-image-store.s3.amazonaws.com/0/136286/7caad51c-0916-24bf-428e-e3d9c30b1629.png \"\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2016-10-16 23.32.34.png\")\n\n\n```javascript:\u30e2\u30c7\u30eb\u306e\u30ed\u30fc\u30c9\u3068\u30c7\u30fc\u30bf\u306e\u7d10\u4ed8\u3051\ncreateMMD() {\n\n\tconst onProgress = ( xhr ) => {\n\t\tif ( xhr.lengthComputable ) {\n\t\t\tconst percentComplete = xhr.loaded / xhr.total * 100;\n\t\t\tconsole.log( Math.round(percentComplete, 2) + '% downloaded' );\n\t\t}\n\t};\n\n\tconst onError = ( xhr ) => {\n\t\tconsole.log('error');\n\t};\n\n\tconst modelFile = 'models/model/model.pmd'; // \u30e2\u30c7\u30eb\u30c7\u30fc\u30bf\uff08\u30ad\u30e3\u30e9\uff09\n\tconst stageFile = 'models/stage/stage.pmd'; // \u30e2\u30c7\u30eb\u30c7\u30fc\u30bf\uff08\u30b9\u30c6\u30fc\u30b8\uff09\n\tconst vmdFiles = [ 'vmds/dance.vmd' ];      // \u30e2\u30fc\u30b7\u30e7\u30f3\u30c7\u30fc\u30bf\uff08\u30ad\u30e3\u30e9\uff09\n\tconst cameraFiles = [ 'vmds/camera.vmd' ];  // \u30e2\u30fc\u30b7\u30e7\u30f3\u30c7\u30fc\u30bf\uff08\u30ab\u30e1\u30e9\uff09\n\tconst audioFile = 'audios/audio.mp3';\n\n\tthis.helper = new THREE.MMDHelper( this.renderer );\n\n\tconst loader = new THREE.MMDLoader();\n\tloader.setDefaultTexturePath( './models/default/' );\n\n\tloader.loadModel( modelFile, ( object ) => { // SkinnedMesh\u3092\u751f\u6210\n\n\t\tthis.mesh = object;\n\n\t\tloader.loadModel( stageFile, ( stage ) => {\n\n\t\t\tloader.loadVmds( vmdFiles, ( vmd ) => {\n\n\t\t\t\tloader.loadVmds( cameraFiles, ( vmd2 ) => {\n\n\t\t\t\t\tloader.loadAudio( audioFile, ( audio, listener ) => {\n\n\t\t\t\t\t\tlistener.position.z = 10;\n\n\t\t\t\t\t\tthis.helper.add( this.mesh );\n\t\t\t\t\t\tloader.pourVmdIntoModel( this.mesh, vmd ); // \u30a2\u30cb\u30e1\u30fc\u30b7\u30e7\u30f3\u30c7\u30fc\u30bf\u3092\u6d41\u3057\u8fbc\u3080\n\t\t\t\t\t\tthis.helper.setAnimation( this.mesh );\n\n\t\t\t\t\t\tthis.helper.setCamera( this.camera );\n\t\t\t\t\t\tloader.pourVmdIntoCamera( this.camera, vmd2 );\n\t\t\t\t\t\tthis.helper.setCameraAnimation( this.camera );\n\n\t\t\t\t\t\tthis.helper.setAudio( audio, listener );\n\n\t\t\t\t\t\tthis.helper.unifyAnimationDuration(); // \u5404\u7a2e\u30a2\u30cb\u30e1\u30fc\u30b7\u30e7\u30f3\u3001\u97f3\u697d\u30c7\u30fc\u30bf\u306e\u6642\u9593\u3092\u305d\u308d\u3048\u308b\n\n\t\t\t\t\t\tthis.helper.setPhysics( this.mesh ); // \u7269\u7406\u6f14\u7b97\n\n\t\t\t\t\t\tthis.scene.add( this.mesh );\n\t\t\t\t\t\tthis.scene.add( stage );\n\t\t\t\t\t\tthis.scene.add( audio );\n\t\t\t\t\t\tthis.scene.add( listener );\n\n\t\t\t\t\t}, onProgress, onError );\n\n\t\t\t\t}, onProgress, onError );\n\n\t\t\t}, onProgress, onError );\n\n\t\t}, onProgress, onError );\n\n\t}, onProgress, onError );\n}\n```\n\n```javascript:\u30ec\u30f3\u30c0\u30ea\u30f3\u30b0\n// WebGLRenderer\u3067\u306f\u306a\u304fMMDHelper\nthis.helper.animate( this.clock.getDelta() );\nthis.helper.render( this.scene, this.camera );\n```\n\n\n- \u516c\u5f0f\u30b5\u30f3\u30d7\u30eb\n\t- https://threejs.org/examples/?q=mmd\n\t- https://takahirox.github.io/MMDLoader-app/\n\n\n\n> \u53c2\u8003\n[VPVP wiki](https://www6.atwiki.jp/vpvpwiki)\n[Three.js\u3067MMD\u3092\u4f7f\u3063\u3066\u307f\u308b](http://cly7796.net/wp/javascript/try-the-mmd-in-three-js/)\n"}