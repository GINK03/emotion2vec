{"context": " More than 1 year has passed since last update.\u30af\u30e9\u30b9\u540d\u304c\u308f\u304b\u3089\u306a\u304b\u3063\u305f\u306e\u3067\u5099\u5fd8\u9332\u3092\u6b8b\u3059\n\n\u53c2\u8003\n\nReal Time Reporting API - \u6982\u8981 - Google \u30a2\u30ca\u30ea\u30c6\u30a3\u30af\u30b9 \u2014 Google Developers\nGoogleAnalytics - Google Analytics Real Time Reporting API \u4e8b\u59cb\u3081 - Qiita\n\n\n\u30b3\u30fc\u30c9\u30b5\u30f3\u30d7\u30eb\nfunction realTime() {\n  var result = Analytics.Data.Realtime.get(\n    reportConf_.gaInfo.viewId, // view id\n    \"rt:activeUsers\", // \u6307\u6a19\n    {\n      'dimensions': 'rt:pagePath'\n    }\n  );\n  var sheetRealtime_   = SpreadsheetApp.getActive().getSheetByName(\"realtime\");\n  var outputStartCell = sheetRealtime_.getRange(\"A1\");\n  for( var i = 0; i < result.rows.length; i++ ){\n    outputStartCell.offset( i, 0, 1, 2 ).setValues( [ result.rows[i] ] );\n  }\n}\n\n\u30af\u30e9\u30b9\u540d\u304c\u308f\u304b\u3089\u306a\u304b\u3063\u305f\u306e\u3067\u5099\u5fd8\u9332\u3092\u6b8b\u3059\n\n## \u53c2\u8003\n * [Real Time Reporting API - \u6982\u8981 - Google \u30a2\u30ca\u30ea\u30c6\u30a3\u30af\u30b9 \u2014 Google Developers](https://developers.google.com/analytics/devguides/reporting/realtime/)\n * [GoogleAnalytics - Google Analytics Real Time Reporting API \u4e8b\u59cb\u3081 - Qiita](http://qiita.com/gfx/items/5d8478461d801f3a8baa)\n\n## \u30b3\u30fc\u30c9\u30b5\u30f3\u30d7\u30eb\n```js\nfunction realTime() {\n  var result = Analytics.Data.Realtime.get(\n    reportConf_.gaInfo.viewId, // view id\n    \"rt:activeUsers\", // \u6307\u6a19\n    {\n      'dimensions': 'rt:pagePath'\n    }\n  );\n  var sheetRealtime_   = SpreadsheetApp.getActive().getSheetByName(\"realtime\");\n  var outputStartCell = sheetRealtime_.getRange(\"A1\");\n  for( var i = 0; i < result.rows.length; i++ ){\n    outputStartCell.offset( i, 0, 1, 2 ).setValues( [ result.rows[i] ] );\n  }\n}\n```\n", "tags": ["GoogleAppsScript", "GoogleAnalytics"]}