{"tags": ["redhat", "AWS", "nginx"], "context": "\n\n\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n# yum install nginx\n\n# nginx -v\nnginx version: nginx/1.10.2\n\n\n\u30d0\u30fc\u30c1\u30e3\u30eb\u30db\u30b9\u30c8\u306e\u8a2d\u5b9a\n\u4eca\u5f8c\u306e\u898f\u7d04\u3068\u3057\u3066\u3001\n\n\u30d0\u30fc\u30c1\u30e3\u30eb\u30db\u30b9\u30c8\u306e\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u306f\u3001/etc/nginx/conf.d\u306b\u3001[\u30c9\u30e1\u30a4\u30f3\u306eFQDN].conf\u306e\u540d\u524d\u3067\u904b\u7528\u3059\u308b\u3002\n\u30d0\u30fc\u30c1\u30e3\u30eb\u30db\u30b9\u30c8\u306e\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u30eb\u30fc\u30c8\u306f\u3001/var/www/vhosts/[\u30c9\u30e1\u30a4\u30f3\u306eFQDN]\u3068\u3059\u308b\u3002\n\n\u4e0a\u8a18\u306e\u30eb\u30fc\u30eb\u306b\u5f93\u3063\u3066\u3001/etc/nginx/conf.d\u306e\u4e0b\u306b\u3001example.com.conf\u3068\u3044\u3046\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u308a\u307e\u3057\u305f\u3002\nserver {\n    listen       80 default;\n    server_name  ec2-xx-xxx-xxx-xx.xx-xxxx-2.compute.amazonaws.com;\n\n    charset utf-8;\n\n    location / {\n        root   /var/www/vhosts/example.com;\n        index  index.html index.htm;\n    }\n\n    error_page 404 /404.html;\n        location = /40x.html {\n    }\n\n    error_page 500 502 503 504 /50x.html;\n        location = /50x.html {\n    }\n\n    location ~ /\\.ht {\n        deny  all;\n    }\n}\n\n\u4eca\u5f8c\u3001\u3053\u306e\u30c9\u30e1\u30a4\u30f3\u3092nginx\u306e\u30c7\u30d5\u30a9\u30eb\u30c8\u30b5\u30fc\u30d3\u30b9\u306b\u3057\u307e\u3059\u306e\u3067\u3001default\u306e\u8a2d\u5b9a\u3092\u3057\u3066\u3044\u307e\u3059\u3002\n\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u306e\u30b7\u30f3\u30bf\u30c3\u30af\u30b9\u30c1\u30a7\u30c3\u30af\n# nginx -t\nnginx: [emerg] could not build server_names_hash, you should increase server_names_hash_bucket_size: 64\nnginx: configuration file /etc/nginx/nginx.conf test failed\n\n\u6765\u307e\u3057\u305f\u3053\u308c\u3002\u30d0\u30fc\u30c1\u30e3\u30eb\u30db\u30b9\u30c8\u306e\u3001server_name\u304c\u9577\u3044\u3068\u6012\u3089\u308c\u3066\u3044\u307e\u3059\u3002\u4eca\u56deAWS\u306e\u30d1\u30d7\u30ea\u30c3\u30af\u30c9\u30e1\u30a4\u30f3\u3092\u3068\u308a\u3042\u3048\u305a\u305d\u306e\u307e\u307e\u4f7f\u3063\u3066\u3044\u308b\u306e\u3067\u3001\u305f\u3057\u304b\u306b\u9577\u3044\u3067\u3059\u3002\n\u3067\u3001\u30a8\u30e9\u30fc\u30e1\u30c3\u30bb\u30fc\u30b8\u901a\u308a\u306b\u3001nginx.conf\u306e\u3001server_names_hash\u306b\u300164\u3092\u8a2d\u5b9a\u3057\u3066\u3042\u3052\u3066\u3082\u3084\u306f\u308a\u540c\u3058\u30a8\u30e9\u30fc\u304c\u51fa\u307e\u3059\u3002\n\u306a\u306e\u3067\u3001\u6700\u7d42\u7684\u306b\u4ee5\u4e0b\u306e\u3088\u3046\u306bhttp\u30c7\u30a3\u30ec\u30af\u30c6\u30a3\u30d6\u306e\u8a2d\u5b9a\u3092\u4fee\u6b63\u3057\u30af\u30ea\u30a2\u3057\u307e\u3057\u305f\u3002\nhttp {\n    server_names_hash_bucket_size 128;\n\n\u78ba\u8a8d\u3002\n# nginx -t\nnginx: the configuration file /etc/nginx/nginx.conf syntax is ok\nnginx: configuration file /etc/nginx/nginx.conf test is successful\n\n\u6210\u529f\uff01\n\n\u30c7\u30fc\u30e2\u30f3\u306e\u8d77\u52d5\u8a2d\u5b9a\u3068\u3001\u624b\u52d5\u3067\u306e\u8d77\u52d5\n# systemctl enable nginx.service\n# systemctl start nginx.service\n\n# \u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n```\n# yum install nginx\n\n# nginx -v\nnginx version: nginx/1.10.2\n```\n\n# \u30d0\u30fc\u30c1\u30e3\u30eb\u30db\u30b9\u30c8\u306e\u8a2d\u5b9a\n\u4eca\u5f8c\u306e\u898f\u7d04\u3068\u3057\u3066\u3001\n\n* \u30d0\u30fc\u30c1\u30e3\u30eb\u30db\u30b9\u30c8\u306e\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u306f\u3001/etc/nginx/conf.d\u306b\u3001[\u30c9\u30e1\u30a4\u30f3\u306eFQDN].conf\u306e\u540d\u524d\u3067\u904b\u7528\u3059\u308b\u3002\n* \u30d0\u30fc\u30c1\u30e3\u30eb\u30db\u30b9\u30c8\u306e\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u30eb\u30fc\u30c8\u306f\u3001/var/www/vhosts/[\u30c9\u30e1\u30a4\u30f3\u306eFQDN]\u3068\u3059\u308b\u3002\n\n\u4e0a\u8a18\u306e\u30eb\u30fc\u30eb\u306b\u5f93\u3063\u3066\u3001/etc/nginx/conf.d\u306e\u4e0b\u306b\u3001example.com.conf\u3068\u3044\u3046\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u308a\u307e\u3057\u305f\u3002\n\n```\nserver {\n    listen       80 default;\n    server_name  ec2-xx-xxx-xxx-xx.xx-xxxx-2.compute.amazonaws.com;\n\n    charset utf-8;\n\n    location / {\n        root   /var/www/vhosts/example.com;\n        index  index.html index.htm;\n    }\n\n    error_page 404 /404.html;\n        location = /40x.html {\n    }\n\n    error_page 500 502 503 504 /50x.html;\n        location = /50x.html {\n    }\n\n    location ~ /\\.ht {\n        deny  all;\n    }\n}\n```\n\u4eca\u5f8c\u3001\u3053\u306e\u30c9\u30e1\u30a4\u30f3\u3092nginx\u306e\u30c7\u30d5\u30a9\u30eb\u30c8\u30b5\u30fc\u30d3\u30b9\u306b\u3057\u307e\u3059\u306e\u3067\u3001default\u306e\u8a2d\u5b9a\u3092\u3057\u3066\u3044\u307e\u3059\u3002\n\n\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u306e\u30b7\u30f3\u30bf\u30c3\u30af\u30b9\u30c1\u30a7\u30c3\u30af\n\n```\n# nginx -t\nnginx: [emerg] could not build server_names_hash, you should increase server_names_hash_bucket_size: 64\nnginx: configuration file /etc/nginx/nginx.conf test failed\n```\n\n\u6765\u307e\u3057\u305f\u3053\u308c\u3002\u30d0\u30fc\u30c1\u30e3\u30eb\u30db\u30b9\u30c8\u306e\u3001server_name\u304c\u9577\u3044\u3068\u6012\u3089\u308c\u3066\u3044\u307e\u3059\u3002\u4eca\u56deAWS\u306e\u30d1\u30d7\u30ea\u30c3\u30af\u30c9\u30e1\u30a4\u30f3\u3092\u3068\u308a\u3042\u3048\u305a\u305d\u306e\u307e\u307e\u4f7f\u3063\u3066\u3044\u308b\u306e\u3067\u3001\u305f\u3057\u304b\u306b\u9577\u3044\u3067\u3059\u3002\n\n\u3067\u3001\u30a8\u30e9\u30fc\u30e1\u30c3\u30bb\u30fc\u30b8\u901a\u308a\u306b\u3001nginx.conf\u306e\u3001server_names_hash\u306b\u300164\u3092\u8a2d\u5b9a\u3057\u3066\u3042\u3052\u3066\u3082\u3084\u306f\u308a\u540c\u3058\u30a8\u30e9\u30fc\u304c\u51fa\u307e\u3059\u3002\n\n\u306a\u306e\u3067\u3001\u6700\u7d42\u7684\u306b\u4ee5\u4e0b\u306e\u3088\u3046\u306bhttp\u30c7\u30a3\u30ec\u30af\u30c6\u30a3\u30d6\u306e\u8a2d\u5b9a\u3092\u4fee\u6b63\u3057\u30af\u30ea\u30a2\u3057\u307e\u3057\u305f\u3002\n\n```\nhttp {\n    server_names_hash_bucket_size 128;\n```\n\n\u78ba\u8a8d\u3002\n\n```\n# nginx -t\nnginx: the configuration file /etc/nginx/nginx.conf syntax is ok\nnginx: configuration file /etc/nginx/nginx.conf test is successful\n```\n\u6210\u529f\uff01\n\n## \u30c7\u30fc\u30e2\u30f3\u306e\u8d77\u52d5\u8a2d\u5b9a\u3068\u3001\u624b\u52d5\u3067\u306e\u8d77\u52d5\n```\n# systemctl enable nginx.service\n# systemctl start nginx.service\n```\n"}