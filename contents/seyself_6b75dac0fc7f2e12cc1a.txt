{"context": " More than 1 year has passed since last update.\nNcFTP\u3067\u30ea\u30e2\u30fc\u30c8\u306e\u30d5\u30a1\u30a4\u30eb\u540d\u3092\u5909\u66f4\u3059\u308b\n#!/bin/bash\n\necho 'open -u ${USER} -p ${PASS} ${HOST}\ncd ${BASE_DIR}\nls\nrm -rf ${BACKUP_FILE}\nrename ${CURRENT_FILE_NAME} ${BACKUP_FILE}\nrename ${NEW_FILE_NAME} ${CURRENT_FILE_NAME}\nls\nquit'|ncftp\n\n\n\u30d5\u30a1\u30a4\u30eb\u3092\u5207\u308a\u66ff\u3048\u308b\u969b\u306b\u3001Jenkins\u304b\u3089\u53e9\u3053\u3046\u3068\u601d\u3063\u3066\u66f8\u3044\u305f\u3051\u3069\u3001\u7d50\u5c40\u5374\u4e0b\u3057\u3066\u3001\u4e0b\u306epython\u306b\u5909\u66f4\u3057\u305f\u3002\n\nPython\u3067\u30ea\u30e2\u30fc\u30c8\u306e\u30d5\u30a1\u30a4\u30eb\u540d\u3092\u5909\u66f4\u3059\u308b\n#!/usr/bin/env python\n# -*- coding: utf-8 -*-\n\nprint 'python >>>'\n\nimport sys, os, datetime, re\nfrom ftplib import FTP\n\nftp_host = '\u30db\u30b9\u30c8\u540d'\nftp_user = '\u30e6\u30fc\u30b6\u30fc\u540d'\nftp_pass = '\u30d1\u30b9\u30ef\u30fc\u30c9'\nftp_base_dir = '\u30ea\u30cd\u30fc\u30e0\u3059\u308b\u30d5\u30a1\u30a4\u30eb\u306e\u3042\u308b\u30c7\u30a3\u30ec\u30af\u30c8\u30ea'\nftp_from_dir = '\u65b0\u3057\u304f\u516c\u958b\u3059\u308b\u30d5\u30a1\u30a4\u30eb'\nftp_to_dir = '\u73fe\u5728\u516c\u958b\u4e2d\u306e\u30d5\u30a1\u30a4\u30eb'\nftp_backup_prefix = '_'\n\ndef main(arg_user='', arg_pass='', *args):\n\n    if arg_user == '' or arg_pass == '':\n        print '  Rename directory failed'\n        print '    Error: User or Password is not input.'\n        return\n\n    ftp_user = arg_user\n    ftp_pass = arg_pass\n\n    dt = str(datetime.datetime.utcnow())\n    dt = dt.replace(':', '-')\n    dt = dt.replace(' ', '_')\n    dt = re.sub(r'\\.\\d+', '', dt)\n\n    print '  Rename directory start >>> ' + dt\n\n    try:\n        ftp = FTP(ftp_host)\n        ftp.login(ftp_user,ftp_pass)\n        ftp.cwd(ftp_base_dir)\n        file_list = ftp.nlst()\n        if ftp_from_dir in file_list:\n            ftp.rename(ftp_to_dir, ftp_backup_prefix+dt)\n            ftp.rename(ftp_from_dir,ftp_to_dir)\n        else:\n            print '  Rename directory failed'\n            print '    Error: NotFound New Directory'\n        ftp.close()\n        print '  Rename directory finished'\n\n    except Exception as e:\n        print '  Rename directory failed'\n        print '    Error: ' + e.message\n\n\nif __name__ == '__main__':\n    sys.path.append(os.path.dirname(__file__))\n    sys_args = sys.argv\n    args = sys_args[1:] if len(sys_args) > 1 else []\n    main(*args)\n\n\n\n\u4e0a\u306epython\u3092\u5b9f\u884c\npython file_rename.py UserName Password\n\n\n\u30d0\u30c3\u30af\u30a2\u30c3\u30d7\u306f\u3001\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u306e\u6642\u306b\u3059\u308c\u3070\u3044\u3044\u304b\u3089\n\u53e4\u3044\u30d5\u30a1\u30a4\u30eb\u306f\u524a\u9664\u3067\u3044\u3044\u6c17\u304c\u3059\u308b\u3002\n\n```sh:NcFTP\u3067\u30ea\u30e2\u30fc\u30c8\u306e\u30d5\u30a1\u30a4\u30eb\u540d\u3092\u5909\u66f4\u3059\u308b\n#!/bin/bash\n\necho 'open -u ${USER} -p ${PASS} ${HOST}\ncd ${BASE_DIR}\nls\nrm -rf ${BACKUP_FILE}\nrename ${CURRENT_FILE_NAME} ${BACKUP_FILE}\nrename ${NEW_FILE_NAME} ${CURRENT_FILE_NAME}\nls\nquit'|ncftp\n```\n\n\u30d5\u30a1\u30a4\u30eb\u3092\u5207\u308a\u66ff\u3048\u308b\u969b\u306b\u3001Jenkins\u304b\u3089\u53e9\u3053\u3046\u3068\u601d\u3063\u3066\u66f8\u3044\u305f\u3051\u3069\u3001\u7d50\u5c40\u5374\u4e0b\u3057\u3066\u3001\u4e0b\u306epython\u306b\u5909\u66f4\u3057\u305f\u3002\n\n```py:Python\u3067\u30ea\u30e2\u30fc\u30c8\u306e\u30d5\u30a1\u30a4\u30eb\u540d\u3092\u5909\u66f4\u3059\u308b\n#!/usr/bin/env python\n# -*- coding: utf-8 -*-\n\nprint 'python >>>'\n\nimport sys, os, datetime, re\nfrom ftplib import FTP\n\nftp_host = '\u30db\u30b9\u30c8\u540d'\nftp_user = '\u30e6\u30fc\u30b6\u30fc\u540d'\nftp_pass = '\u30d1\u30b9\u30ef\u30fc\u30c9'\nftp_base_dir = '\u30ea\u30cd\u30fc\u30e0\u3059\u308b\u30d5\u30a1\u30a4\u30eb\u306e\u3042\u308b\u30c7\u30a3\u30ec\u30af\u30c8\u30ea'\nftp_from_dir = '\u65b0\u3057\u304f\u516c\u958b\u3059\u308b\u30d5\u30a1\u30a4\u30eb'\nftp_to_dir = '\u73fe\u5728\u516c\u958b\u4e2d\u306e\u30d5\u30a1\u30a4\u30eb'\nftp_backup_prefix = '_'\n\ndef main(arg_user='', arg_pass='', *args):\n\n\tif arg_user == '' or arg_pass == '':\n\t\tprint '  Rename directory failed'\n\t\tprint '    Error: User or Password is not input.'\n\t\treturn\n\n\tftp_user = arg_user\n\tftp_pass = arg_pass\n\t\n\tdt = str(datetime.datetime.utcnow())\n\tdt = dt.replace(':', '-')\n\tdt = dt.replace(' ', '_')\n\tdt = re.sub(r'\\.\\d+', '', dt)\n\n\tprint '  Rename directory start >>> ' + dt\n\n\ttry:\n\t\tftp = FTP(ftp_host)\n\t\tftp.login(ftp_user,ftp_pass)\n\t\tftp.cwd(ftp_base_dir)\n\t\tfile_list = ftp.nlst()\n\t\tif ftp_from_dir in file_list:\n\t\t\tftp.rename(ftp_to_dir, ftp_backup_prefix+dt)\n\t\t\tftp.rename(ftp_from_dir,ftp_to_dir)\n\t\telse:\n\t\t\tprint '  Rename directory failed'\n\t\t\tprint '    Error: NotFound New Directory'\n\t\tftp.close()\n\t\tprint '  Rename directory finished'\n\n\texcept Exception as e:\n\t\tprint '  Rename directory failed'\n\t\tprint '    Error: ' + e.message\n\n\nif __name__ == '__main__':\n\tsys.path.append(os.path.dirname(__file__))\n\tsys_args = sys.argv\n\targs = sys_args[1:] if len(sys_args) > 1 else []\n\tmain(*args)\n```\n\n```sh:\u4e0a\u306epython\u3092\u5b9f\u884c\npython file_rename.py UserName Password\n```\n\n\u30d0\u30c3\u30af\u30a2\u30c3\u30d7\u306f\u3001\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u306e\u6642\u306b\u3059\u308c\u3070\u3044\u3044\u304b\u3089\n\u53e4\u3044\u30d5\u30a1\u30a4\u30eb\u306f\u524a\u9664\u3067\u3044\u3044\u6c17\u304c\u3059\u308b\u3002\n\n", "tags": ["NcFTP", "Python", "sh"]}