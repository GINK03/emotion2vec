{"context": " More than 1 year has passed since last update.\u300c\u3059\u3079\u3066Excel\u3067\u3067\u304d\u308b\uff01 \u7d4c\u55b6\u529b\u30fb\u8a3a\u7642\u529b\u3092\u9ad8\u3081\u308bDPC\u30c7\u30fc\u30bf\u6d3b\u7528\u8853\u300d\u3092\u8aad\u3093\u3067\u30d0\u30d6\u30eb\u30c1\u30e3\u30fc\u30c8\u3092\u4f5c\u6210\u3059\u308b\u306e\u306b\u624b\u9593\u304c\u304b\u304b\u308b\u306e\u3067\u30de\u30af\u30ed\u3092\u4f5c\u6210\u3057\u305f\u3002\n\u65b9\u6cd5\u3068\u3057\u3066\u4e0b\u8a18\u306e\u30c7\u30fc\u30bf\u3092\u4f5c\u6210\u3057\u3066\u304b\u3089\u3001\u30d0\u30d6\u30eb\u30c1\u30e3\u30fc\u30c8\u306b\u3057\u305f\u3044\u30c7\u30fc\u30bf\u3092\u9078\u629e\u3057\u3066\u304b\u3089\u30de\u30af\u30ed\u3092\u5b9f\u884c\u3059\u308b\u3068\u30d0\u30d6\u30eb\u30c1\u30e3\u30fc\u30c8\u304c\u4f5c\u6210\u3055\u308c\u308b\u3068\u3044\u3046\u3082\u306e\u3002\n\n\nSub \u30d0\u30d6\u30eb\u30c1\u30e3\u30fc\u30c8\u4f5c\u6210()\n    Dim chartObj As ChartObject\n    Dim ns As Series\n    Dim r As String\n    Dim s As String\n    Dim sr As Range\n    Dim wkAdr As String\n    Dim nameAdr As String\n    Dim xAdr As String\n    Dim yAdr As String\n    Dim bAdr As String\n    Dim leng As Integer\n    Dim line As Integer\n    Dim cnt As Integer\n    Dim i As Integer\n\n    r = Selection.Address\n    s = ActiveSheet.Name\n    Set sr = Worksheets(s).Range(r)\n\n    wkAdr = sr.Cells(1, 1).Address\n    leng = InStr(2, wkAdr, \"$\")\n    line = Int(Mid(wkAdr, leng + 1))\n    nameAdr = \"=\" & s + \"!\" + Left(wkAdr, leng)\n    wkAdr = sr.Cells(1, 2).Address\n    leng = InStr(2, wkAdr, \"$\")\n    xAdr = \"=\" & s + \"!\" + Left(wkAdr, leng)\n    wkAdr = sr.Cells(1, 3).Address\n    leng = InStr(2, wkAdr, \"$\")\n    yAdr = \"=\" & s + \"!\" + Left(wkAdr, leng)\n    wkAdr = sr.Cells(1, 4).Address\n    leng = InStr(2, wkAdr, \"$\")\n    bAdr = \"=\" & s + \"!\" + Left(wkAdr, leng)\n\n    cnt = sr.Rows.Count\n\n    Set chartObj = ActiveSheet.ChartObjects.Add(100, 80, 500, 300)\n    chartObj.Chart.ChartType = xlBubble3DEffect\n    chartObj.Chart.Legend.Delete\n\n    For i = line To line + cnt - 1\n        Set ns = chartObj.Chart.SeriesCollection.NewSeries\n        ns.ChartType = xlBubble3DEffect\n        ns.Name = nameAdr & i\n        ns.XValues = xAdr & i\n        ns.Values = yAdr & i\n        ns.BubbleSizes = bAdr & i\n        ns.ApplyDataLabels\n        ns.DataLabels.ShowSeriesName = True\n        ns.DataLabels.ShowValue = False\n    Next\n\nEnd Sub\n\n\n\u300c\u3059\u3079\u3066Excel\u3067\u3067\u304d\u308b\uff01 \u7d4c\u55b6\u529b\u30fb\u8a3a\u7642\u529b\u3092\u9ad8\u3081\u308bDPC\u30c7\u30fc\u30bf\u6d3b\u7528\u8853\u300d\u3092\u8aad\u3093\u3067\u30d0\u30d6\u30eb\u30c1\u30e3\u30fc\u30c8\u3092\u4f5c\u6210\u3059\u308b\u306e\u306b\u624b\u9593\u304c\u304b\u304b\u308b\u306e\u3067\u30de\u30af\u30ed\u3092\u4f5c\u6210\u3057\u305f\u3002\n\u65b9\u6cd5\u3068\u3057\u3066\u4e0b\u8a18\u306e\u30c7\u30fc\u30bf\u3092\u4f5c\u6210\u3057\u3066\u304b\u3089\u3001\u30d0\u30d6\u30eb\u30c1\u30e3\u30fc\u30c8\u306b\u3057\u305f\u3044\u30c7\u30fc\u30bf\u3092\u9078\u629e\u3057\u3066\u304b\u3089\u30de\u30af\u30ed\u3092\u5b9f\u884c\u3059\u308b\u3068\u30d0\u30d6\u30eb\u30c1\u30e3\u30fc\u30c8\u304c\u4f5c\u6210\u3055\u308c\u308b\u3068\u3044\u3046\u3082\u306e\u3002\n\n![vba1.png](https://qiita-image-store.s3.amazonaws.com/0/63970/b22ac671-1c56-e37f-95e4-28b1c0ed2230.png)\n![vba2.jpeg](https://qiita-image-store.s3.amazonaws.com/0/63970/9c4d1f7b-8876-c0c0-bb27-7ece79017965.jpeg)\n\n```vba\nSub \u30d0\u30d6\u30eb\u30c1\u30e3\u30fc\u30c8\u4f5c\u6210()\n    Dim chartObj As ChartObject\n    Dim ns As Series\n    Dim r As String\n    Dim s As String\n    Dim sr As Range\n    Dim wkAdr As String\n    Dim nameAdr As String\n    Dim xAdr As String\n    Dim yAdr As String\n    Dim bAdr As String\n    Dim leng As Integer\n    Dim line As Integer\n    Dim cnt As Integer\n    Dim i As Integer\n    \n    r = Selection.Address\n    s = ActiveSheet.Name\n    Set sr = Worksheets(s).Range(r)\n    \n    wkAdr = sr.Cells(1, 1).Address\n    leng = InStr(2, wkAdr, \"$\")\n    line = Int(Mid(wkAdr, leng + 1))\n    nameAdr = \"=\" & s + \"!\" + Left(wkAdr, leng)\n    wkAdr = sr.Cells(1, 2).Address\n    leng = InStr(2, wkAdr, \"$\")\n    xAdr = \"=\" & s + \"!\" + Left(wkAdr, leng)\n    wkAdr = sr.Cells(1, 3).Address\n    leng = InStr(2, wkAdr, \"$\")\n    yAdr = \"=\" & s + \"!\" + Left(wkAdr, leng)\n    wkAdr = sr.Cells(1, 4).Address\n    leng = InStr(2, wkAdr, \"$\")\n    bAdr = \"=\" & s + \"!\" + Left(wkAdr, leng)\n    \n    cnt = sr.Rows.Count\n    \n    Set chartObj = ActiveSheet.ChartObjects.Add(100, 80, 500, 300)\n    chartObj.Chart.ChartType = xlBubble3DEffect\n    chartObj.Chart.Legend.Delete\n    \n    For i = line To line + cnt - 1\n        Set ns = chartObj.Chart.SeriesCollection.NewSeries\n        ns.ChartType = xlBubble3DEffect\n        ns.Name = nameAdr & i\n        ns.XValues = xAdr & i\n        ns.Values = yAdr & i\n        ns.BubbleSizes = bAdr & i\n        ns.ApplyDataLabels\n        ns.DataLabels.ShowSeriesName = True\n        ns.DataLabels.ShowValue = False\n    Next\n    \nEnd Sub\n\n```\n", "tags": ["ExcelVBA"]}