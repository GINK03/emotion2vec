{"tags": ["SSL", "Apache", "openssl", "AWS", "\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3"], "context": " More than 1 year has passed since last update.\u7a81\u7136\u3067\u3059\u304c\u3001SSL\u306e\u6697\u53f7\u306e\u8a2d\u5b9a\u3092\u8af8\u4e8b\u60c5\u306b\u3088\u308a\u5909\u66f4\u3059\u308b\u4e8b\u304c\u3042\u308b\u3068\u601d\u3044\u307e\u3059\u3002\n\n\u4f8b\u3048\u3070\u30012015/2 RFC7456\u3067\u3001RC4\u304c\u7981\u6b62\u3068\u306a\u3063\u305f\u7b49\n\n\u30b5\u30fc\u30d0\u30fc\u306eSSL\u306e\u6697\u53f7\u306e\u8a2d\u5b9a\u5909\u66f4\u3092\u884c\u3063\u305f\u5f8c\u3001\u5916\u90e8\u304b\u3089\u306e\u78ba\u8a8d\u65b9\u6cd5\u306b\u8ff7\u3063\u3066\u3044\u305f\u306e\u3092\u601d\u3044\u51fa\u3057\u305f\u306e\u3067\u3001\u5099\u5fd8\u9332\u304c\u3066\u3089\u3002\n\n\u5148\u306b\u8a2d\u5b9a\u65b9\u6cd5\u3082\u8a18\u8f09\u3057\u3066\u304a\u304f\u306e\u3067\u3001\u78ba\u8a8d\u65b9\u6cd5\u306e\u307f\u3067\u826f\u3044\u5834\u5408\u306f\u3001\u78ba\u8a8d\u65b9\u6cd5\u306e\u9805\u3078\n\n\n\u30b5\u30fc\u30d0\u30fc\u5074\u306e\u8a2d\u5b9a\n\u8a2d\u5b9a\u306b\u95a2\u3057\u3066\u306f\u3001\u4f8b\u3068\u3057\u3066\u3001RC4\u3092\u5916\u3057\u3066\u3044\u304f\u4e8b\u3092\u60f3\u5b9a\u3057\u3066\u8a18\u8f09\u3057\u3066\u3044\u307e\u3059\u3002\n\nELB\u3092\u5229\u7528\u3057\u3066\u3044\u308b\u5834\u5408\nAWS\u30b3\u30f3\u30bd\u30fc\u30eb\u304b\u3089\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u8fbf\u308a\u3001RC4\u3092\u5229\u7528\u3057\u306a\u3044\u30dd\u30ea\u30b7\u30fc\u3092\u9078\u629e\u3059\u308b\u304b\u3001\u30ab\u30b9\u30bf\u30e0\u30dd\u30ea\u30b7\u30fc\u304b\u3089RC4\u306e\u30c1\u30a7\u30c3\u30af\u3092\u5916\u3059\n\nEC2 -> Load Balancers -> \u5909\u66f4\u3057\u305f\u3044ELB -> Listeners\u30bf\u30d6 -> Cipher\u306e\u9805\u306b\u3042\u308bChange\nPolicy\u306e\u5909\u66f4\n\n\nPolicy\u306e\u5909\u66f4\n\nPredefined Security Policy\u306e\u5834\u5408\n\n\nELBSecurityPolicy-2015-2\u4ee5\u964d\uff08\u554f\u984c\u306a\u3051\u308c\u3070\u3001\u6700\u65b0\u306e\u65e5\u4ed8\u3067\u826f\u3044\uff09\n\n\nCustom Security Policy\u306e\u5834\u5408\n\n\nRC4\u3068\u3064\u3044\u3066\u3044\u308b\u3082\u306e\u306e\u30c1\u30a7\u30c3\u30af\u3092\u5916\u3057\u3066\u3044\u304f\uff08\u4e0d\u8981\u306a\u3082\u306e\u3082\u3042\u308c\u3070\u305d\u308c\u3089\u3082\uff09\n\n\n\n\napache\u3084nginx\u306e\u5834\u5408\n\nMozilla SSL Configuration Generator\u306b\u304a\u9858\u3044\u3057\u3066\u57fa\u672c\u306e\u8a2d\u5b9a\u3092\u4f5c\u308a\u3001\u5fc5\u8981\u306a\u90e8\u5206\u3092apache\u306b\u8a2d\u5b9a\u3057\u3001\u518d\u8d77\u52d5\u3059\u308b\u306e\u304c\u826f\u3055\u305d\u3046\u3067\u3059\u306d\u3002\n<VirtualHost *:443>\n    ...\n    SSLEngine on\n    SSLCertificateFile      /path/to/signed_certificate\n    SSLCertificateChainFile /path/to/intermediate_certificate\n    SSLCertificateKeyFile   /path/to/private/key\n    SSLCACertificateFile    /path/to/all_ca_certs\n\n    # modern configuration, tweak to your needs\n    SSLProtocol             all -SSLv2 -SSLv3 -TLSv1\n    SSLCipherSuite          ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-AES256-GCM-SHA384:DHE-RSA-AES128-GCM-SHA256:DHE-DSS-AES128-GCM-SHA256:kEDH+AESGCM:ECDHE-RSA-AES128-SHA256:ECDHE-ECDSA-AES128-SHA256:ECDHE-RSA-AES128-SHA:ECDHE-ECDSA-AES128-SHA:ECDHE-RSA-AES256-SHA384:ECDHE-ECDSA-AES256-SHA384:ECDHE-RSA-AES256-SHA:ECDHE-ECDSA-AES256-SHA:DHE-RSA-AES128-SHA256:DHE-RSA-AES128-SHA:DHE-DSS-AES128-SHA256:DHE-RSA-AES256-SHA256:DHE-DSS-AES256-SHA:DHE-RSA-AES256-SHA:!aNULL:!eNULL:!EXPORT:!DES:!RC4:!3DES:!MD5:!PSK\n    SSLHonorCipherOrder     on\n    SSLCompression          off\n\n    # OCSP Stapling, only in httpd 2.3.3 and later\n    SSLUseStapling          on\n    SSLStaplingResponderTimeout 5\n    SSLStaplingReturnResponderErrors off\n\n    # HSTS (mod_headers is required) (15768000 seconds = 6 months)\n    Header always add Strict-Transport-Security \"max-age=15768000\"\n    ...\n</VirtualHost>\nSSLStaplingCache        shmcb:/var/run/ocsp(128000)\n\n\nSSLCipherSuite\u306b\"!RC4\"\u3068\u3044\u3046\u8a2d\u5b9a\u304c\u5c45\u308b\u4e8b\u3092\u78ba\u8a8d\u3057\u307e\u3059\n\n\u5410\u304d\u51fa\u3055\u308c\u305f\u8a2d\u5b9a\u306e\u307e\u307e\u3067\u826f\u3055\u305d\u3046\u3067\u3059\u304c\u3001\u5909\u66f4\u3057\u305f\u3044\u5834\u5408\u306f\u9069\u5b9c\u5909\u66f4\u3057\u307e\u3059\u3002\n\n\u4f8b\u3048\u3070\u3001TLSv1\u306f\u5728\u3063\u3066\u3082\u826f\u3044\u304b\u306a\u3068\u3044\u3046\u5834\u5408\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u3059\u308b\u3068\u826f\u3044\u3068\u601d\u3044\u307e\u3059\n\nSSLProtocol             all -SSLv2 -SSLv3\n\n\n\u78ba\u8a8d\u65b9\u6cd5\n\u672c\u984c\u3067\u3059\uff01\n\n\u5916\u90e8\u304b\u3089\u306e\u30a2\u30af\u30bb\u30b9\u304c\u30a6\u30a7\u30eb\u30ab\u30e0\u306a\u5834\u5408\nSSL Server Test\u306b\u304a\u9858\u3044\u3059\u308b\n\n\u6ce8\u610f\u70b9\u3068\u3057\u3066\u306f\u3001\u4e00\u89a7\u306b\u8f09\u308a\u305f\u304f\u306a\u3044\u5834\u5408\u306f\u3001\u300cDo not show this results on the boards\u300d\u306e\u30c1\u30a7\u30c3\u30af\u3092\u5165\u308c\u3066\u304b\u3089\u3001\u304a\u9858\u3044\u3059\u308b\u4e8b\u3067\u3059\u304b\u306d\n\n\u3057\u3070\u3089\u304f(2,3\u5206\uff1f)\u5f85\u3064\u3068\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u30e9\u30f3\u30af\u4ed8\u3051\u3084\u3001\u5404\u7a2e\u30a2\u30c9\u30d0\u30a4\u30b9\u3082\u305f\u304f\u3055\u3093\u3082\u3089\u3048\u307e\u3059\n\n\n\n\u8af8\u4e8b\u60c5\u306b\u3088\u308a\u30b3\u30de\u30f3\u30c9\u3067\u78ba\u8a8d\u3057\u305f\u3044\u5834\u5408\nOpenSSL\u3092SSL/TLS\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u3068\u3057\u3066\u4f7f\u3063\u3066\u307f\u308b\n\u4e0a\u8a18\u30b5\u30a4\u30c8\u3092\u53c2\u8003\u306b\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u30b3\u30de\u30f3\u30c9\u306b\u306a\u308a\u307e\u3057\u305f\nopenssl s_client -connect example.com:443 -cipher ECDHE-RSA-AES128-GCM-SHA256 < /dev/null\n\n\n\u5165\u529b\u5f85\u3061\u30e2\u30fc\u30c9\u3067\u306a\u304f\u3066\u3082\u826f\u3044\u306e\u3067\u3001/dev/null\u3092\u6295\u3052\u3066\u3044\u307e\u3059\n\u6307\u5b9a\u3057\u305fcipher\u304c\u4f7f\u3048\u306a\u304b\u3063\u305f\u5834\u5408\u306f\u3001\u300cerror\u300d\u3084\u300cCipher is (NONE)\u300d\u7b49\u304c\u51fa\u3066\u3044\u308b\u3068\u601d\u3044\u307e\u3059\n\u30ed\u30fc\u30ab\u30eb\u306eopenssl\u306b\u4f9d\u5b58\u3059\u308b\u306e\u3067\u3001\u30ed\u30fc\u30ab\u30eb\u306eopenssl\u304c\u4f7f\u3048\u306a\u3044cipher\u306f\u8a66\u305b\u306a\u3044\u3067\u3059\n\n\u5f8c\u306f\u3001cipher\u3092\u5909\u66f4\u3057\u3066\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3057\u3066\u884c\u3051\u3070OK\u3067\u3059\u3002\n\u6307\u5b9a\u51fa\u6765\u308b\u3082\u306e\u306f\u3001\u4e0b\u8a18\u30b3\u30de\u30f3\u30c9\u3067\u51fa\u305b\u307e\u3059\u3002\nopenssl ciphers -v\n\n\n\u30b9\u30af\u30ea\u30d7\u30c8\u3067\u3084\u308b\n\u5bfe\u8c61\u304c2, 3\u500b\u306a\u3089\u3001\u624b\u52d5\u3067\u3082\u826f\u3044\u306e\u3067\u3059\u304c\u3001\u305d\u308c\u4ee5\u4e0a\u3060\u3068\u9762\u5012\u306a\u306e\u3067\u3001ruby\u30b9\u30af\u30ea\u30d7\u30c8\u306b\u304a\u4efb\u305b\u3057\u307e\u3059\u3002\n\ncheck.rb\n# RC4\u7cfb\u5217\u3060\u3051\u306b\u3057\u3066\u307f\u305f\nciphers = `openssl ciphers -v RC4`\n\n# \u8abf\u67fb\u5bfe\u8c61\u30b5\u30fc\u30d0\u30fc:\u30dd\u30fc\u30c8\nconnect_server = \"example.com:443\"\n\ncheck_results = []\nciphers.each_line{|protocol_suite|\n  encrypt_protocol = protocol_suite.split(/\\s/)[0]\n\n  cmd_result = `openssl s_client -connect #{connect_server} -cipher #{encrypt_protocol} < /dev/null`\n\n  cmd_result =~ /^New.*Cipher is (.*)$/    \n  check_results << \"client cipher is #{encrypt_protocol}, session cipher is #{$1}\"\n}\n\nputs \"------------\"\nputs check_results\n\n\n\n\u5b9f\u884c\u7d50\u679c\nclient cipher is ECDHE-RSA-RC4-SHA, session cipher is (NONE)\nclient cipher is ECDHE-ECDSA-RC4-SHA, session cipher is (NONE)\n\n\n\n\u5229\u7528\u51fa\u6765\u306a\u3044cipher\u306e\u5834\u5408\u306f\u3001NONE\u3068\u51fa\u308b\n\n\u4f8b\u5916\u51e6\u7406\u7b49\u306f\u4e00\u5207\u5b58\u5728\u3057\u306a\u3044\u3067\u3059\u3057\u3001\u5229\u7528\u74b0\u5883\u306b\u3088\u3063\u3066\u307e\u3061\u307e\u3061\u306b\u306a\u308b\u304b\u3082\u3057\u308c\u306a\u3044\u30b9\u30af\u30ea\u30d7\u30c8\u306a\u306e\u3067\u3001\u53c2\u8003\u7a0b\u5ea6\u306b\n\n\u307e\u3068\u3081\nQualys\u3055\u3093\u306eSSL Server Test\u306b\u304a\u4efb\u305b\u3059\u308b\u306e\u304c\u826f\u3044\u3067\u3059\u306d\u3002\n\u51fa\u6765\u306a\u3044\u5834\u5408\u306f\u3001openssl s_client\u3067\uff01\n\u305d\u308c\u306b\u3057\u3066\u3082AWS\u306f\u697d\u3067\u826f\u3044\u3067\u3059\u306d\u301c\u3002\n\u7a81\u7136\u3067\u3059\u304c\u3001SSL\u306e\u6697\u53f7\u306e\u8a2d\u5b9a\u3092\u8af8\u4e8b\u60c5\u306b\u3088\u308a\u5909\u66f4\u3059\u308b\u4e8b\u304c\u3042\u308b\u3068\u601d\u3044\u307e\u3059\u3002\n\n* \u4f8b\u3048\u3070\u30012015/2 [RFC7456](http://tools.ietf.org/html/rfc7465)\u3067\u3001RC4\u304c\u7981\u6b62\u3068\u306a\u3063\u305f\u7b49\n\n\u30b5\u30fc\u30d0\u30fc\u306eSSL\u306e\u6697\u53f7\u306e\u8a2d\u5b9a\u5909\u66f4\u3092\u884c\u3063\u305f\u5f8c\u3001\u5916\u90e8\u304b\u3089\u306e\u78ba\u8a8d\u65b9\u6cd5\u306b\u8ff7\u3063\u3066\u3044\u305f\u306e\u3092\u601d\u3044\u51fa\u3057\u305f\u306e\u3067\u3001\u5099\u5fd8\u9332\u304c\u3066\u3089\u3002\n\n* \u5148\u306b\u8a2d\u5b9a\u65b9\u6cd5\u3082\u8a18\u8f09\u3057\u3066\u304a\u304f\u306e\u3067\u3001\u78ba\u8a8d\u65b9\u6cd5\u306e\u307f\u3067\u826f\u3044\u5834\u5408\u306f\u3001\u78ba\u8a8d\u65b9\u6cd5\u306e\u9805\u3078\n\n# \u30b5\u30fc\u30d0\u30fc\u5074\u306e\u8a2d\u5b9a\n\n\u8a2d\u5b9a\u306b\u95a2\u3057\u3066\u306f\u3001\u4f8b\u3068\u3057\u3066\u3001RC4\u3092\u5916\u3057\u3066\u3044\u304f\u4e8b\u3092\u60f3\u5b9a\u3057\u3066\u8a18\u8f09\u3057\u3066\u3044\u307e\u3059\u3002\n\n## ELB\u3092\u5229\u7528\u3057\u3066\u3044\u308b\u5834\u5408\nAWS\u30b3\u30f3\u30bd\u30fc\u30eb\u304b\u3089\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u8fbf\u308a\u3001RC4\u3092\u5229\u7528\u3057\u306a\u3044\u30dd\u30ea\u30b7\u30fc\u3092\u9078\u629e\u3059\u308b\u304b\u3001\u30ab\u30b9\u30bf\u30e0\u30dd\u30ea\u30b7\u30fc\u304b\u3089RC4\u306e\u30c1\u30a7\u30c3\u30af\u3092\u5916\u3059\n\n1. EC2 -> Load Balancers -> \u5909\u66f4\u3057\u305f\u3044ELB -> Listeners\u30bf\u30d6 -> Cipher\u306e\u9805\u306b\u3042\u308bChange\n2. Policy\u306e\u5909\u66f4\n\n### Policy\u306e\u5909\u66f4\n* Predefined Security Policy\u306e\u5834\u5408\n * ELBSecurityPolicy-2015-2\u4ee5\u964d\uff08\u554f\u984c\u306a\u3051\u308c\u3070\u3001\u6700\u65b0\u306e\u65e5\u4ed8\u3067\u826f\u3044\uff09\n* Custom Security Policy\u306e\u5834\u5408\n * RC4\u3068\u3064\u3044\u3066\u3044\u308b\u3082\u306e\u306e\u30c1\u30a7\u30c3\u30af\u3092\u5916\u3057\u3066\u3044\u304f\uff08\u4e0d\u8981\u306a\u3082\u306e\u3082\u3042\u308c\u3070\u305d\u308c\u3089\u3082\uff09\n\n## apache\u3084nginx\u306e\u5834\u5408\n\n![\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2015-04-08 15.36.57.png](https://qiita-image-store.s3.amazonaws.com/0/23194/f1aa6eed-7c8d-40aa-885f-ccf1102eced0.png)\n[Mozilla SSL Configuration Generator](https://mozilla.github.io/server-side-tls/ssl-config-generator/)\u306b\u304a\u9858\u3044\u3057\u3066\u57fa\u672c\u306e\u8a2d\u5b9a\u3092\u4f5c\u308a\u3001\u5fc5\u8981\u306a\u90e8\u5206\u3092apache\u306b\u8a2d\u5b9a\u3057\u3001\u518d\u8d77\u52d5\u3059\u308b\u306e\u304c\u826f\u3055\u305d\u3046\u3067\u3059\u306d\u3002\n\n```apache\n<VirtualHost *:443>\n    ...\n    SSLEngine on\n    SSLCertificateFile      /path/to/signed_certificate\n    SSLCertificateChainFile /path/to/intermediate_certificate\n    SSLCertificateKeyFile   /path/to/private/key\n    SSLCACertificateFile    /path/to/all_ca_certs\n\n    # modern configuration, tweak to your needs\n    SSLProtocol             all -SSLv2 -SSLv3 -TLSv1\n    SSLCipherSuite          ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-AES256-GCM-SHA384:DHE-RSA-AES128-GCM-SHA256:DHE-DSS-AES128-GCM-SHA256:kEDH+AESGCM:ECDHE-RSA-AES128-SHA256:ECDHE-ECDSA-AES128-SHA256:ECDHE-RSA-AES128-SHA:ECDHE-ECDSA-AES128-SHA:ECDHE-RSA-AES256-SHA384:ECDHE-ECDSA-AES256-SHA384:ECDHE-RSA-AES256-SHA:ECDHE-ECDSA-AES256-SHA:DHE-RSA-AES128-SHA256:DHE-RSA-AES128-SHA:DHE-DSS-AES128-SHA256:DHE-RSA-AES256-SHA256:DHE-DSS-AES256-SHA:DHE-RSA-AES256-SHA:!aNULL:!eNULL:!EXPORT:!DES:!RC4:!3DES:!MD5:!PSK\n    SSLHonorCipherOrder     on\n    SSLCompression          off\n\n    # OCSP Stapling, only in httpd 2.3.3 and later\n    SSLUseStapling          on\n    SSLStaplingResponderTimeout 5\n    SSLStaplingReturnResponderErrors off\n\n    # HSTS (mod_headers is required) (15768000 seconds = 6 months)\n    Header always add Strict-Transport-Security \"max-age=15768000\"\n    ...\n</VirtualHost>\nSSLStaplingCache        shmcb:/var/run/ocsp(128000)\n```\n* SSLCipherSuite\u306b\"!RC4\"\u3068\u3044\u3046\u8a2d\u5b9a\u304c\u5c45\u308b\u4e8b\u3092\u78ba\u8a8d\u3057\u307e\u3059\n\n\u5410\u304d\u51fa\u3055\u308c\u305f\u8a2d\u5b9a\u306e\u307e\u307e\u3067\u826f\u3055\u305d\u3046\u3067\u3059\u304c\u3001\u5909\u66f4\u3057\u305f\u3044\u5834\u5408\u306f\u9069\u5b9c\u5909\u66f4\u3057\u307e\u3059\u3002\n\n* \u4f8b\u3048\u3070\u3001TLSv1\u306f\u5728\u3063\u3066\u3082\u826f\u3044\u304b\u306a\u3068\u3044\u3046\u5834\u5408\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u3059\u308b\u3068\u826f\u3044\u3068\u601d\u3044\u307e\u3059\n\n```apache\nSSLProtocol             all -SSLv2 -SSLv3\n```\n\n# \u78ba\u8a8d\u65b9\u6cd5\n\n\u672c\u984c\u3067\u3059\uff01\n\n## \u5916\u90e8\u304b\u3089\u306e\u30a2\u30af\u30bb\u30b9\u304c\u30a6\u30a7\u30eb\u30ab\u30e0\u306a\u5834\u5408\n\n[SSL Server Test](https://www.ssllabs.com/ssltest/index.html)\u306b\u304a\u9858\u3044\u3059\u308b\n\n* \u6ce8\u610f\u70b9\u3068\u3057\u3066\u306f\u3001\u4e00\u89a7\u306b\u8f09\u308a\u305f\u304f\u306a\u3044\u5834\u5408\u306f\u3001\u300cDo not show this results on the boards\u300d\u306e\u30c1\u30a7\u30c3\u30af\u3092\u5165\u308c\u3066\u304b\u3089\u3001\u304a\u9858\u3044\u3059\u308b\u4e8b\u3067\u3059\u304b\u306d\n![\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2015-04-08 14.52.47.png](https://qiita-image-store.s3.amazonaws.com/0/23194/652885e4-18af-7e70-431b-a0fe30fb63f5.png)\n\n\n* \u3057\u3070\u3089\u304f(2,3\u5206\uff1f)\u5f85\u3064\u3068\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u30e9\u30f3\u30af\u4ed8\u3051\u3084\u3001\u5404\u7a2e\u30a2\u30c9\u30d0\u30a4\u30b9\u3082\u305f\u304f\u3055\u3093\u3082\u3089\u3048\u307e\u3059\n\n![\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2015-04-08 14.53.26.png](https://qiita-image-store.s3.amazonaws.com/0/23194/a1abf6b9-46a8-e768-4886-6da842ac63e0.png)\n\n## \u8af8\u4e8b\u60c5\u306b\u3088\u308a\u30b3\u30de\u30f3\u30c9\u3067\u78ba\u8a8d\u3057\u305f\u3044\u5834\u5408\n\n[OpenSSL\u3092SSL/TLS\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u3068\u3057\u3066\u4f7f\u3063\u3066\u307f\u308b](https://siguniang.wordpress.com/2014/08/09/openssl-as-ssl-client/)\n\u4e0a\u8a18\u30b5\u30a4\u30c8\u3092\u53c2\u8003\u306b\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u30b3\u30de\u30f3\u30c9\u306b\u306a\u308a\u307e\u3057\u305f\n\n```bash\nopenssl s_client -connect example.com:443 -cipher ECDHE-RSA-AES128-GCM-SHA256 < /dev/null\n```\n* \u5165\u529b\u5f85\u3061\u30e2\u30fc\u30c9\u3067\u306a\u304f\u3066\u3082\u826f\u3044\u306e\u3067\u3001/dev/null\u3092\u6295\u3052\u3066\u3044\u307e\u3059\n* \u6307\u5b9a\u3057\u305fcipher\u304c\u4f7f\u3048\u306a\u304b\u3063\u305f\u5834\u5408\u306f\u3001\u300cerror\u300d\u3084\u300cCipher is (NONE)\u300d\u7b49\u304c\u51fa\u3066\u3044\u308b\u3068\u601d\u3044\u307e\u3059\n* \u30ed\u30fc\u30ab\u30eb\u306eopenssl\u306b\u4f9d\u5b58\u3059\u308b\u306e\u3067\u3001\u30ed\u30fc\u30ab\u30eb\u306eopenssl\u304c\u4f7f\u3048\u306a\u3044cipher\u306f\u8a66\u305b\u306a\u3044\u3067\u3059\n\n\u5f8c\u306f\u3001cipher\u3092\u5909\u66f4\u3057\u3066\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3057\u3066\u884c\u3051\u3070OK\u3067\u3059\u3002\n\u6307\u5b9a\u51fa\u6765\u308b\u3082\u306e\u306f\u3001\u4e0b\u8a18\u30b3\u30de\u30f3\u30c9\u3067\u51fa\u305b\u307e\u3059\u3002\n\n```bash\nopenssl ciphers -v\n```\n\n### \u30b9\u30af\u30ea\u30d7\u30c8\u3067\u3084\u308b\n\n\u5bfe\u8c61\u304c2, 3\u500b\u306a\u3089\u3001\u624b\u52d5\u3067\u3082\u826f\u3044\u306e\u3067\u3059\u304c\u3001\u305d\u308c\u4ee5\u4e0a\u3060\u3068\u9762\u5012\u306a\u306e\u3067\u3001ruby\u30b9\u30af\u30ea\u30d7\u30c8\u306b\u304a\u4efb\u305b\u3057\u307e\u3059\u3002\n\n```ruby:check.rb\n# RC4\u7cfb\u5217\u3060\u3051\u306b\u3057\u3066\u307f\u305f\nciphers = `openssl ciphers -v RC4`\n\n# \u8abf\u67fb\u5bfe\u8c61\u30b5\u30fc\u30d0\u30fc:\u30dd\u30fc\u30c8\nconnect_server = \"example.com:443\"\n\ncheck_results = []\nciphers.each_line{|protocol_suite|\n  encrypt_protocol = protocol_suite.split(/\\s/)[0]\n  \n  cmd_result = `openssl s_client -connect #{connect_server} -cipher #{encrypt_protocol} < /dev/null`\n                                           \n  cmd_result =~ /^New.*Cipher is (.*)$/    \n  check_results << \"client cipher is #{encrypt_protocol}, session cipher is #{$1}\"\n}\n\nputs \"------------\"\nputs check_results\n```\n\n```bash:\u5b9f\u884c\u7d50\u679c\nclient cipher is ECDHE-RSA-RC4-SHA, session cipher is (NONE)\nclient cipher is ECDHE-ECDSA-RC4-SHA, session cipher is (NONE)\n```\n* \u5229\u7528\u51fa\u6765\u306a\u3044cipher\u306e\u5834\u5408\u306f\u3001NONE\u3068\u51fa\u308b\n\n\u4f8b\u5916\u51e6\u7406\u7b49\u306f\u4e00\u5207\u5b58\u5728\u3057\u306a\u3044\u3067\u3059\u3057\u3001\u5229\u7528\u74b0\u5883\u306b\u3088\u3063\u3066\u307e\u3061\u307e\u3061\u306b\u306a\u308b\u304b\u3082\u3057\u308c\u306a\u3044\u30b9\u30af\u30ea\u30d7\u30c8\u306a\u306e\u3067\u3001\u53c2\u8003\u7a0b\u5ea6\u306b\n\n# \u307e\u3068\u3081\nQualys\u3055\u3093\u306e[SSL Server Test](https://www.ssllabs.com/ssltest/index.html)\u306b\u304a\u4efb\u305b\u3059\u308b\u306e\u304c\u826f\u3044\u3067\u3059\u306d\u3002\n\u51fa\u6765\u306a\u3044\u5834\u5408\u306f\u3001openssl s_client\u3067\uff01\n\n\u305d\u308c\u306b\u3057\u3066\u3082AWS\u306f\u697d\u3067\u826f\u3044\u3067\u3059\u306d\u301c\u3002\n"}