{"context": " More than 1 year has passed since last update.AWS CLI\u3067IAM ROLE\u3092\u30b3\u30d4\u30fc\u3059\u308b\u30b9\u30af\u30ea\u30d7\u30c8\n\n\n\nitem\nvalue\n\n\n\n\nSrcProfile\n\u30b3\u30d4\u30fc\u5143\u30d7\u30ed\u30d5\u30a1\u30a4\u30eb\u540d\n\n\nSrcRoleName\n\u30b3\u30d4\u30fc\u5143IAM ROLE\u540d\n\n\nDestProfile\n\u30b3\u30d4\u30fc\u5148\u30d7\u30ed\u30d5\u30a1\u30a4\u30eb\u540d\n\n\nDestRoleName\n\u30b3\u30d4\u30fc\u5148IAM ROLE\u540d\n\n\n\n#!/bin/bash\n\nSrcProfile=hoge\nSrcRoleName=hoge_role\nDestProfile=moge\nDestRoleName=mode_role\n\ngetrole=`aws --profile $SrcProfile iam get-role --role-name $SrcRoleName`\nassume=`echo $getrole|jq '.Role.AssumeRolePolicyDocument'`\n\naws --profile $DestProfile iam create-role --role-name $DestRoleName --assume-role-policy-document \"$assume\"\naws --profile $DestProfile iam create-instance-profile --instance-profile-name $DestRoleName\naws --profile $DestProfile iam add-role-to-instance-profile --instance-profile-name $DestRoleName --role-name $DestRoleName\n\npolicies=`aws --profile $SrcProfile iam list-role-policies --role-name $SrcRoleName|jq -r '.PolicyNames[]'`\n\nfor srcpolicy in ${policies[@]}\ndo\n  getpolicy=`aws --profile $SrcProfile iam get-role-policy --role-name $SrcRoleName --policy-name $srcpolicy|jq '.PolicyDocument'`\n\n  aws --profile $DestProfile iam put-role-policy --role-name $DestRoleName --policy-name $srcpolicy --policy-document \"$getpolicy\"\ndone\n\nAWS CLI\u3067IAM ROLE\u3092\u30b3\u30d4\u30fc\u3059\u308b\u30b9\u30af\u30ea\u30d7\u30c8\n\n|item|value|\n|-----|-----|\n|SrcProfile|\u30b3\u30d4\u30fc\u5143\u30d7\u30ed\u30d5\u30a1\u30a4\u30eb\u540d|\n|SrcRoleName|\u30b3\u30d4\u30fc\u5143IAM ROLE\u540d|\n|DestProfile|\u30b3\u30d4\u30fc\u5148\u30d7\u30ed\u30d5\u30a1\u30a4\u30eb\u540d|\n|DestRoleName|\u30b3\u30d4\u30fc\u5148IAM ROLE\u540d|\n\n```bash\n#!/bin/bash\n\nSrcProfile=hoge\nSrcRoleName=hoge_role\nDestProfile=moge\nDestRoleName=mode_role\n\ngetrole=`aws --profile $SrcProfile iam get-role --role-name $SrcRoleName`\nassume=`echo $getrole|jq '.Role.AssumeRolePolicyDocument'`\n\naws --profile $DestProfile iam create-role --role-name $DestRoleName --assume-role-policy-document \"$assume\"\naws --profile $DestProfile iam create-instance-profile --instance-profile-name $DestRoleName\naws --profile $DestProfile iam add-role-to-instance-profile --instance-profile-name $DestRoleName --role-name $DestRoleName\n\npolicies=`aws --profile $SrcProfile iam list-role-policies --role-name $SrcRoleName|jq -r '.PolicyNames[]'`\n\nfor srcpolicy in ${policies[@]}\ndo\n  getpolicy=`aws --profile $SrcProfile iam get-role-policy --role-name $SrcRoleName --policy-name $srcpolicy|jq '.PolicyDocument'`\n\n  aws --profile $DestProfile iam put-role-policy --role-name $DestRoleName --policy-name $srcpolicy --policy-document \"$getpolicy\"\ndone\n```\n", "tags": ["AWS", "aws-cli", "IAM"]}