{"context": " More than 1 year has passed since last update.\n\n\u6982\u8981\nVisio\u3067\u307a\u305f\u307a\u305f\u8a2d\u8a08\u66f8\u3092\u4f5c\u308a\u307e\u3057\u305f\u3002\n\u898b\u7a4d\u308a\u6839\u62e0\u3068\u3059\u308b\u305f\u3081\u306b\u3001\u8a2d\u8a08\u66f8\u5185\u306e\u56f3\u5f62\u3092\u6570\u3048\u305f\u304f\u306a\u308a\u307e\u3057\u305f\u30021\nVBA\u3067\u3067\u304d\u305d\u3046\u3060\u3063\u305f\u306e\u3067\u3001Excel\u3092\u4f7f\u3063\u3066\u3084\u3063\u3066\u307f\u307e\u3057\u305f\u3002\n\n\u30bd\u30fc\u30b9\n\n\u30e1\u30a4\u30f3\u30eb\u30fc\u30c1\u30f3\n\u672c\u4f53\u90e8\u5206\u3067\u3059\u3002\n\u30d5\u30a1\u30a4\u30eb\u3092\u9078\u629e\u3057\u3001Visio\u3092\u8d77\u52d5\u3057\u3001\u56f3\u5f62\u3092\u5217\u6319\u3057\u3066\u30ef\u30fc\u30af\u30b7\u30fc\u30c8\u306b\u8a18\u9332\u3057\u307e\u3059\u3002\n\u4f8b\u5916\u51e6\u7406\u3068\u304b\u30a8\u30e9\u30fc\u51e6\u7406\u3068\u304b\u629c\u3051\u3066\u307e\u3059\u304c\u3001\u3068\u308a\u3042\u3048\u305a\u3068\u3044\u3046\u3053\u3068\u3067\u3002  \n\nCountVisioShapes.bas\nOption Explicit\n\nPublic Sub CountVisioShapes()\n    Dim fn As Variant\n\n    Dim visioApp As visio.Application\n    Dim visioDoc As visio.Document\n    Dim visioPag As visio.Page\n    Dim visioShp As visio.Shape\n\n    Dim rs As New ResultSheet\n\n    fn = Application.GetOpenFilename(FileFilter:=\"Visio\u30d5\u30a1\u30a4\u30eb,*.vsdx\", MultiSelect:=False)\n\n    Set visioApp = CreateObject(\"Visio.Application\")\n\n    visioApp.Documents.OpenEx fn, visOpenRO + visOpenHidden\n\n    Set visioDoc = visioApp.Documents.Item(1)\n\n    For Each visioPag In visioDoc.Pages\n        For Each visioShp In visioPag.Shapes\n            rs.putPageName visioPag.Name\n            rs.putShapeName visioShp.Name\n            rs.putShapeText visioShp.Text\n            rs.putMasterShape visioShp.MasterShape.Text\n            rs.nextRow\n\n        Next\n    Next\n\n    visioDoc.Close\n    visioApp.Quit\n\n    Set visioDoc = Nothing\n    Set visioApp = Nothing\nEnd Sub\n\n\n\n\u30ef\u30fc\u30af\u30b7\u30fc\u30c8\u306e\u30e9\u30c3\u30d1\n\u30ef\u30fc\u30af\u30b7\u30fc\u30c8\u3078\u5024\u3092\u683c\u7d0d\u3059\u308b\u306e\u3092\u7c21\u5358\u306b\u3059\u308b\u305f\u3081\u306e\u30af\u30e9\u30b9\u3067\u3059\u3002\n\nResultSheet.cls\nOption Explicit\n\nPrivate currentRow As Long\nPrivate startCol As Long\nPrivate mySheet As Worksheet\n\nPrivate Sub Class_Initialize()\n    With Application.ActiveCell\n        currentRow = .Row\n        startCol = .Column\n    End With\n\n    Set mySheet = Application.ActiveSheet\n\n    putHeaderRow\nEnd Sub\n\nPrivate Sub putHeaderRow()\n    putCommon 0, \"\u30da\u30fc\u30b8\u540d\"\n    putCommon 1, \"\u30b7\u30a7\u30a4\u30d7\u540d\"\n    putCommon 2, \"\u30b7\u30a7\u30a4\u30d7\u30c6\u30ad\u30b9\u30c8\"\n    putCommon 3, \"\u30de\u30b9\u30bf\u30fc\u30b7\u30a7\u30a4\u30d7\u30c6\u30ad\u30b9\u30c8\"\n    nextRow\nEnd Sub\n\nPublic Sub nextRow()\n    currentRow = currentRow + 1\nEnd Sub\n\nPublic Sub putPageName(s As String)\n    putCommon 0, s\nEnd Sub\n\nPublic Sub putShapeName(s As String)\n    putCommon 1, s\nEnd Sub\n\nPublic Sub putShapeText(s As String)\n    putCommon 2, s\nEnd Sub\n\nPublic Sub putMasterShape(s As String)\n    putCommon 3, s\nEnd Sub\n\nPrivate Sub putCommon(sft As Integer, s As String)\n    mySheet.Cells(currentRow, startCol + sft).Value = s\nEnd Sub\n\n\n\n\u8d77\u52d5\u30dc\u30bf\u30f3\n\u30e1\u30a4\u30f3\u30eb\u30fc\u30c1\u30f3\u3092\u8d77\u52d5\u3059\u308b\u305f\u3081\u306e\u30dc\u30bf\u30f3\u3092\u4f5c\u308a\u307e\u3057\u305f\u3002\n\n\u30dc\u30bf\u30f3\u30af\u30ea\u30c3\u30af\u6642\u306b\u30e1\u30a4\u30f3\u30eb\u30fc\u30c1\u30f3\u3092\u547c\u3076\u3088\u3046\u306b\u3057\u307e\u3059\u3002\nOption Explicit\n\nPrivate Sub SelectVisioFileButton_Click()\n    Call CountVisioShapes.CountVisioShapes\nEnd Sub\n\n\n\u5b9f\u884c\u7d50\u679c\n\u4f5c\u6210\u3057\u305f\u30dc\u30bf\u30f3\u3092\u62bc\u3059\u3068\u30d5\u30a1\u30a4\u30eb\u9078\u629e\u30c0\u30a4\u30a2\u30ed\u30b0\u304c\u8868\u793a\u3055\u308c\u307e\u3059\u306e\u3067\u3001\u30d5\u30a1\u30a4\u30eb\u3092\u9078\u629e\u3059\u308b\u3068\u30a2\u30af\u30c6\u30a3\u30d6\u30bb\u30eb\u306b\u7d50\u679c\u304c\u51fa\u529b\u3055\u308c\u307e\u3059\u3002\n\n\n\u4fdd\u5b58\n\u4f5c\u6210\u3057\u305f\u30d5\u30a1\u30a4\u30eb\u306f\u300c\u30de\u30af\u30ed\u6709\u52b9\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u300d\u3068\u3057\u3066\u4fdd\u5b58\u3057\u3066\u304a\u304f\u3068\u4fbf\u5229\u3067\u3059\u3002\n\n\n\n\n\u307b\u3093\u3068\u306f\u3001\u5148\u306b\u4e00\u89a7\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u3063\u3066\u304b\u3089Visio\u306b\u63a5\u7d9a\u3059\u308b\u306e\u304c\u7f8e\u3057\u3044\u3084\u308a\u304b\u305f\u3002  \u00a0\u21a9\n\n\n\n# \u6982\u8981\n\nVisio\u3067\u307a\u305f\u307a\u305f\u8a2d\u8a08\u66f8\u3092\u4f5c\u308a\u307e\u3057\u305f\u3002\n\u898b\u7a4d\u308a\u6839\u62e0\u3068\u3059\u308b\u305f\u3081\u306b\u3001\u8a2d\u8a08\u66f8\u5185\u306e\u56f3\u5f62\u3092\u6570\u3048\u305f\u304f\u306a\u308a\u307e\u3057\u305f\u3002[^1]\n\n[^1]: \u307b\u3093\u3068\u306f\u3001\u5148\u306b\u4e00\u89a7\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u3063\u3066\u304b\u3089Visio\u306b\u63a5\u7d9a\u3059\u308b\u306e\u304c\u7f8e\u3057\u3044\u3084\u308a\u304b\u305f\u3002 :sweat_smile: \n\nVBA\u3067\u3067\u304d\u305d\u3046\u3060\u3063\u305f\u306e\u3067\u3001Excel\u3092\u4f7f\u3063\u3066\u3084\u3063\u3066\u307f\u307e\u3057\u305f\u3002\n\n# \u30bd\u30fc\u30b9\n\n## \u30e1\u30a4\u30f3\u30eb\u30fc\u30c1\u30f3\n\n\u672c\u4f53\u90e8\u5206\u3067\u3059\u3002\n\n\u30d5\u30a1\u30a4\u30eb\u3092\u9078\u629e\u3057\u3001Visio\u3092\u8d77\u52d5\u3057\u3001\u56f3\u5f62\u3092\u5217\u6319\u3057\u3066\u30ef\u30fc\u30af\u30b7\u30fc\u30c8\u306b\u8a18\u9332\u3057\u307e\u3059\u3002\n\n\u4f8b\u5916\u51e6\u7406\u3068\u304b\u30a8\u30e9\u30fc\u51e6\u7406\u3068\u304b\u629c\u3051\u3066\u307e\u3059\u304c\u3001\u3068\u308a\u3042\u3048\u305a\u3068\u3044\u3046\u3053\u3068\u3067\u3002 :smile: \n\n```vbnet:CountVisioShapes.bas\nOption Explicit\n\nPublic Sub CountVisioShapes()\n    Dim fn As Variant\n    \n    Dim visioApp As visio.Application\n    Dim visioDoc As visio.Document\n    Dim visioPag As visio.Page\n    Dim visioShp As visio.Shape\n    \n    Dim rs As New ResultSheet\n    \n    fn = Application.GetOpenFilename(FileFilter:=\"Visio\u30d5\u30a1\u30a4\u30eb,*.vsdx\", MultiSelect:=False)\n    \n    Set visioApp = CreateObject(\"Visio.Application\")\n\n    visioApp.Documents.OpenEx fn, visOpenRO + visOpenHidden\n    \n    Set visioDoc = visioApp.Documents.Item(1)\n\n    For Each visioPag In visioDoc.Pages\n        For Each visioShp In visioPag.Shapes\n            rs.putPageName visioPag.Name\n            rs.putShapeName visioShp.Name\n            rs.putShapeText visioShp.Text\n            rs.putMasterShape visioShp.MasterShape.Text\n            rs.nextRow\n        \n        Next\n    Next\n    \n    visioDoc.Close\n    visioApp.Quit\n    \n    Set visioDoc = Nothing\n    Set visioApp = Nothing\nEnd Sub\n```\n\n## \u30ef\u30fc\u30af\u30b7\u30fc\u30c8\u306e\u30e9\u30c3\u30d1\n\n\u30ef\u30fc\u30af\u30b7\u30fc\u30c8\u3078\u5024\u3092\u683c\u7d0d\u3059\u308b\u306e\u3092\u7c21\u5358\u306b\u3059\u308b\u305f\u3081\u306e\u30af\u30e9\u30b9\u3067\u3059\u3002\n\n```vbnet:ResultSheet.cls\nOption Explicit\n\nPrivate currentRow As Long\nPrivate startCol As Long\nPrivate mySheet As Worksheet\n\nPrivate Sub Class_Initialize()\n    With Application.ActiveCell\n        currentRow = .Row\n        startCol = .Column\n    End With\n    \n    Set mySheet = Application.ActiveSheet\n    \n    putHeaderRow\nEnd Sub\n\nPrivate Sub putHeaderRow()\n    putCommon 0, \"\u30da\u30fc\u30b8\u540d\"\n    putCommon 1, \"\u30b7\u30a7\u30a4\u30d7\u540d\"\n    putCommon 2, \"\u30b7\u30a7\u30a4\u30d7\u30c6\u30ad\u30b9\u30c8\"\n    putCommon 3, \"\u30de\u30b9\u30bf\u30fc\u30b7\u30a7\u30a4\u30d7\u30c6\u30ad\u30b9\u30c8\"\n    nextRow\nEnd Sub\n\nPublic Sub nextRow()\n    currentRow = currentRow + 1\nEnd Sub\n\nPublic Sub putPageName(s As String)\n    putCommon 0, s\nEnd Sub\n\nPublic Sub putShapeName(s As String)\n    putCommon 1, s\nEnd Sub\n\nPublic Sub putShapeText(s As String)\n    putCommon 2, s\nEnd Sub\n\nPublic Sub putMasterShape(s As String)\n    putCommon 3, s\nEnd Sub\n\nPrivate Sub putCommon(sft As Integer, s As String)\n    mySheet.Cells(currentRow, startCol + sft).Value = s\nEnd Sub\n```\n\n## \u8d77\u52d5\u30dc\u30bf\u30f3\n\n\u30e1\u30a4\u30f3\u30eb\u30fc\u30c1\u30f3\u3092\u8d77\u52d5\u3059\u308b\u305f\u3081\u306e\u30dc\u30bf\u30f3\u3092\u4f5c\u308a\u307e\u3057\u305f\u3002\n\n![excel-button.PNG](https://qiita-image-store.s3.amazonaws.com/0/59475/4976091d-eaf1-5dd0-6163-6cd97bab6a11.png)\n\n\u30dc\u30bf\u30f3\u30af\u30ea\u30c3\u30af\u6642\u306b\u30e1\u30a4\u30f3\u30eb\u30fc\u30c1\u30f3\u3092\u547c\u3076\u3088\u3046\u306b\u3057\u307e\u3059\u3002\n\n```vbnet:\nOption Explicit\n\nPrivate Sub SelectVisioFileButton_Click()\n    Call CountVisioShapes.CountVisioShapes\nEnd Sub\n```\n\n# \u5b9f\u884c\u7d50\u679c\n\n\u4f5c\u6210\u3057\u305f\u30dc\u30bf\u30f3\u3092\u62bc\u3059\u3068\u30d5\u30a1\u30a4\u30eb\u9078\u629e\u30c0\u30a4\u30a2\u30ed\u30b0\u304c\u8868\u793a\u3055\u308c\u307e\u3059\u306e\u3067\u3001\u30d5\u30a1\u30a4\u30eb\u3092\u9078\u629e\u3059\u308b\u3068\u30a2\u30af\u30c6\u30a3\u30d6\u30bb\u30eb\u306b\u7d50\u679c\u304c\u51fa\u529b\u3055\u308c\u307e\u3059\u3002\n\n![countvisioshapes.PNG](https://qiita-image-store.s3.amazonaws.com/0/59475/f940a746-068b-a930-1c33-d6d9e3045aad.png)\n\n# \u4fdd\u5b58\n\n\u4f5c\u6210\u3057\u305f\u30d5\u30a1\u30a4\u30eb\u306f\u300c\u30de\u30af\u30ed\u6709\u52b9\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u300d\u3068\u3057\u3066\u4fdd\u5b58\u3057\u3066\u304a\u304f\u3068\u4fbf\u5229\u3067\u3059\u3002\n", "tags": ["Visio", "VBA", "Excel", "ExcelVBA"]}