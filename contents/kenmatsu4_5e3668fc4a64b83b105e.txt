{"tags": ["\u7d71\u8a08\u5b66", "\u6a5f\u68b0\u5b66\u7fd2", "MachineLearning", "statistics", "\u7570\u5e38\u691c\u77e5\u3068\u5909\u5316\u691c\u77e5"], "context": "\u3010\u6a5f\u68b0\u5b66\u7fd2\u3011\u300c\u7570\u5e38\u691c\u77e5\u3068\u5909\u5316\u691c\u77e5 1\u7ae0\u300d\u30cd\u30a4\u30de\u30f3\u30d4\u30a2\u30bd\u30f3\u306e\u88dc\u984c\u306e\u5f0f\u306e\u884c\u9593\u3092\u57cb\u3081\u3066\u307f\u308b\n\u6a5f\u68b0\u5b66\u7fd2\u30d7\u30ed\u30d5\u30a7\u30c3\u30b7\u30e7\u30ca\u30eb\u30b7\u30ea\u30fc\u30ba\u300c\u7570\u5e38\u691c\u77e5\u3068\u5909\u5316\u691c\u77e5\u300d(http://ide-research.net/book/support.html#kodansha) \u7b2c1\u7ae0 \u300c\u5b9a\u74061.2 \u30cd\u30a4\u30de\u30f3\u30d4\u30a2\u30bd\u30f3\u306e\u88dc\u984c\u300d\u306e\u5f0f\u5c55\u958b\u306e\u9593\u3092\u57cb\u3081\u3066\u307f\u308b\u3001\u3068\u3044\u3046\u8a18\u4e8b\u3067\u3059\u3002\n\u81ea\u5206\u306a\u308a\u306e\u8003\u3048\u3082\u5165\u3063\u3066\u3044\u308b\u305f\u3081\u3001\u3082\u3057\u3054\u6307\u6458\u7b49\u3042\u308c\u3070\u30b3\u30e1\u30f3\u30c8\u3084\u3001Tweet\u306a\u3069\u3067\u3054\u9023\u7d61\u3044\u305f\u3060\u3051\u308b\u3068\u5b09\u3057\u3044\u3067\u3059\u3002\u307e\u305f\u3001\u3053\u306e\u8a18\u4e8b\u5185\u306b\u8aa4\u308a\u304c\u3042\u3063\u305f\u5834\u5408\u306f\u79c1@kenmatu4\u306e\u8cac\u4efb\u3067\u3059\u306e\u3067\u3001\u8457\u8005\u306e\u65b9\u306b\u554f\u3044\u5408\u308f\u305b\u3092\u884c\u308f\u306a\u3044\u3088\u3046\u5fa1\u9858\u3044\u81f4\u3057\u307e\u3059\u3002\n\n\u30cd\u30a4\u30de\u30f3\u30fb\u30d4\u30a2\u30bd\u30f3\u306e\u88dc\u984c\n\u89b3\u6e2c\u5024x\u2032x\u2032{\\bf x'}\u306b\u304a\u3051\u308b\u7570\u5e38\u5ea6 a(x\u2032)=lnp(x\u2032|y=1,D)p(x\u2032|y=0,D)a(x\u2032)=lnp(x\u2032|y=1,D)p(x\u2032|y=0,D)a({\\bf x'}) = \\ln{ p({\\bf x'}|y=1, \\mathcal{D}) \\over p({\\bf x'}|y=0, \\mathcal{D}) } \u3068\u3044\u3046\u5b9a\u7fa9\u306f\u3001\u4e00\u5b9a\u306e\u6b63\u5e38\u6a19\u672c\u306e\u4e0b\u3067\u7570\u5e38\u6a19\u672c\u7cbe\u5ea6\u3092\u6700\u5927\u306b\u3059\u308b\u3068\u3044\u3046\u610f\u5473\u3067\u6700\u9069\u3067\u3042\u308b\u3002\n\n\u6700\u9069\u306a\u7570\u5e38\u5ea6\u3001\u3068\u306f\u4e0b\u8a18\u306e\u3088\u3046\u306b\u6240\u4e0e\u306e\u89b3\u6e2c\u5024x\u2032x\u2032{\\bf x'}\u3068\u6b63\u5e38\u6a19\u672c\u7cbe\u5ea6\u03b1\u03b1\\alpha\u306e\u3082\u3068\u3067\u3001\u4e0b\u8a18\u306e\u7a4d\u5206\u3092\u6700\u5927\u5316\u3059\u308b\u3088\u3046\u306a\u95a2\u6570a(x)a(x)a({\\bf x})\u3067\u3042\u308b\u3068\u3057\u3001\u3001\u305d\u308c\u3092a\u2217a\u2217a^*\u3068\u7f6e\u304d\u307e\u3059\u3002\na^* = \\arg\\max_a \\int_{-\\infty}^{\\infty}  I[a({\\bf x}) \\ge \\tau_\\alpha]\\ p({\\bf x}|y=1, \\mathcal{D})\\ d{\\bf x}\u3000\u3000\u3000\u3000\u3000\u3000\u3000\\cdots (*)\na\u2217=argmaxa\u222b\u221e\u2212\u221eI[a(x)\u2265\u03c4\u03b1]\u00a0p(x|y=1,D)\u00a0dx\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u22ef(\u2217)a\u2217=argmaxa\u222b\u221e\u2212\u221eI[a(x)\u2265\u03c4\u03b1]\u00a0p(x|y=1,D)\u00a0dx\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u22ef(\u2217){a^* = \\arg\\max_a \\int_{-\\infty}^{\\infty}  I[a({\\bf x}) \\ge \\tau_\\alpha]\\ p({\\bf x}|y=1, \\mathcal{D})\\ d{\\bf x}\u3000\u3000\u3000\u3000\u3000\u3000\u3000\\cdots (*)\n}\n\u307e\u305f\u3001\u6b63\u5e38\u6a19\u672c\u7cbe\u5ea6\u03b1\u03b1\\alpha\u3068\u306f\u4e0b\u8a18\u306e\u30b0\u30e9\u30d5\u306e\u4e0a\u304b\u3089\uff12\u3064\u76ee\u306e\u6c34\u8272\u306e\u9762\u7a4d\u306e\u3053\u3068\u306a\u306e\u3067\u3001\u03b1\u03b1\\alpha\u3092\u78ba\u5b9a\u3055\u305b\u308b\u3068\u9762\u7a4d\u304c\u6c7a\u307e\u308a\u3001\u7570\u5e38\u5ea6 a(x)a(x)a({\\bf x})\u306e\u5b9a\u7fa9\u306e\u4ed5\u65b9\u306b\u3088\u3063\u3066\u305d\u306e\u9762\u7a4d\u306e\u53d6\u308a\u65b9\uff08\u7247\u5074\u3068\u304b\u3001\u4e21\u5074\u3068\u304b\u3001\u305d\u306e\u4ed6\u3044\u308d\u3044\u308d\u540c\u3058\u9762\u7a4d\u3067\u3082\u53d6\u308a\u65b9\u3092\u9078\u3079\u308b\u306e\u3067\uff09\u304c\u304d\u307e\u308a\u3001\u7d50\u679cx\u2032x\u2032{\\bf x'}\u304c\u6c7a\u307e\u308a\u307e\u3059\u3002\n\u3044\u307e\u3001\u8ef8\u304c\uff14\u3064\u3042\u308a\u3001\n\n\u89b3\u6e2c\u5024  :\u3000x,\u00a0x\u2032x,\u00a0x\u2032{\\bf x},\\ {\\bf x'}\n\u7570\u5e38\u5ea6  :\u3000a(x),\u00a0\u03c4,\u00a0\u03c4\u03b1a(x),\u00a0\u03c4,\u00a0\u03c4\u03b1a({\\bf x}),\\ \\tau,\\ \\tau_\\alpha\n\u78ba\u7387\u5bc6\u5ea6:\u3000p(x|y=0,D),p(x|y=1,D),p(x|y=0,D),p(x|y=1,D),p({\\bf x}|y=0, \\mathcal{D}), p({\\bf x}|y=1, \\mathcal{D}),\n\u78ba\u7387(\u7cbe\u5ea6):\u3000\u03b1\u03b1\\alpha\n\n\u3067\u3042\u308b\u3053\u3068\u306b\u6ce8\u610f\u3057\u3066\u3001\u5225\u306a\u6b21\u5143\u306e\u30c7\u30fc\u30bf\u3067\u8a08\u7b97\u3057\u3066\u3057\u307e\u308f\u306a\u3044\u3088\u3046\u306b\u610f\u8b58\u3059\u308b\u3053\u3068\u304c\u91cd\u8981\u304b\u306a\u3068\u601d\u3063\u3066\u3044\u307e\u3059\u3002\uff08\u300c\u78ba\u7387\u300d\u306e\u90e8\u5206\u306f\u78ba\u7387\u5bc6\u5ea6\u3001\u3068\u78ba\u7387\u3001\u304c\u3042\u308b\u3053\u3068\u306b\u6ce8\u610f\u3067\u3059\u3002\uff09\n\u4e0b\u8a18\u306e\u56f3\u306f\u3001\u6a2a\u8ef8\u306f\u5168\u3066\u89b3\u6e2c\u5024\u3001\u7e26\u8ef8\u306f\u4e0a\u304b\u3089\u3001\uff12\u3064\u76ee\u304c\u78ba\u7387(\u5bc6\u5ea6)\u3001\uff14\u3064\u76ee\u304c\u7570\u5e38\u5ea6\u306b\u306a\u308a\u307e\u3059\u3002\u03b1\u03b1\\alpha\u306f\uff12\u3064\u76ee\u306e\u30b0\u30e9\u30d5\u306e\u9762\u7a4d\u306e\u90e8\u5206\u306b\u306a\u308a\u307e\u3059\u306d\u3002\n\n(*)\u5f0f\u306emax(\u22c5)max(\u22c5)\\max(\\cdot)\u306e\u306a\u304b\u3092\u6700\u5927\u5316\u3059\u308b\u306e\u3067\u3001\u4e0b\u8a18\u306e\u554f\u984c\u3092\u89e3\u304f\u3053\u3068\u3067\u7b54\u3048\u304c\u5f97\u3089\u308c\u307e\u3059\u3002\u3053\u306e\u5236\u7d04\u6761\u4ef6\u306f\u6b63\u5e38\u6a19\u672c\u7cbe\u5ea6\u304c\u03b1\u03b1\\alpha\u3067\u3042\u308b\u3053\u3068\u3092\u6e80\u305f\u3059\u305f\u3081\u306e\u6761\u4ef6\u3067\u3059\u3002\n\\int_{-\\infty}^{\\infty}  I[a({\\bf x}) \\ge \\tau_\\alpha]\\ p({\\bf x}|y=1, \\mathcal{D})\\ d{\\bf x}\u3000\\rightarrow \\max \\\\\n{\\rm subject\\ to} \\int_{-\\infty}^{\\infty}  I[a({\\bf x}) \\ge \\tau_\\alpha]\\ p({\\bf x}|y=0, \\mathcal{D})\\ d{\\bf x} = 1 - \\alpha\n\u222b\u221e\u2212\u221eI[a(x)\u2265\u03c4\u03b1]\u00a0p(x|y=1,D)\u00a0dx\u3000\u2192maxsubject\u00a0to\u222b\u221e\u2212\u221eI[a(x)\u2265\u03c4\u03b1]\u00a0p(x|y=0,D)\u00a0dx=1\u2212\u03b1\u222b\u221e\u2212\u221eI[a(x)\u2265\u03c4\u03b1]\u00a0p(x|y=1,D)\u00a0dx\u3000\u2192maxsubject\u00a0to\u222b\u221e\u2212\u221eI[a(x)\u2265\u03c4\u03b1]\u00a0p(x|y=0,D)\u00a0dx=1\u2212\u03b1{\\int_{-\\infty}^{\\infty}  I[a({\\bf x}) \\ge \\tau_\\alpha]\\ p({\\bf x}|y=1, \\mathcal{D})\\ d{\\bf x}\u3000\\rightarrow \\max \\\\\n{\\rm subject\\ to} \\int_{-\\infty}^{\\infty}  I[a({\\bf x}) \\ge \\tau_\\alpha]\\ p({\\bf x}|y=0, \\mathcal{D})\\ d{\\bf x} = 1 - \\alpha\n}\n\u30e9\u30b0\u30e9\u30f3\u30b8\u30e5\u306e\u672a\u5b9a\u4e57\u6570\u65b9\u3092\u4f7f\u3063\u3066\u6761\u4ef6\u3064\u304d\u6700\u5927\u5316\u3092\u884c\u3044\u307e\u3059\u3002\u5bfe\u8c61\u306e\u95a2\u6570\u3092LLL\u3068\u7f6e\u304f\u3068\u3001\nL = \\int_{-\\infty}^{\\infty}  I[a({\\bf x}) \\ge \\tau_\\alpha]\\ p({\\bf x}|y=1, \\mathcal{D})\\ d{\\bf x} - \\lambda \\left( \\int_{-\\infty}^{\\infty}  I[a({\\bf x}) \\ge \\tau_\\alpha]\\ p({\\bf x}|y=0, \\mathcal{D})\\ d{\\bf x} - ( 1 - \\alpha)  \\right)\n\nL=\u222b\u221e\u2212\u221eI[a(x)\u2265\u03c4\u03b1]\u00a0p(x|y=1,D)\u00a0dx\u2212\u03bb(\u222b\u221e\u2212\u221eI[a(x)\u2265\u03c4\u03b1]\u00a0p(x|y=0,D)\u00a0dx\u2212(1\u2212\u03b1)){L = \\int_{-\\infty}^{\\infty}  I[a({\\bf x}) \\ge \\tau_\\alpha]\\ p({\\bf x}|y=1, \\mathcal{D})\\ d{\\bf x} - \\lambda \\left( \\int_{-\\infty}^{\\infty}  I[a({\\bf x}) \\ge \\tau_\\alpha]\\ p({\\bf x}|y=0, \\mathcal{D})\\ d{\\bf x} - ( 1 - \\alpha)  \\right)\n\n}\n\u7c21\u5358\u5316\u306e\u305f\u3081\u306b\n\\beta = I[a({\\bf x}) \\ge \\tau_\\alpha] \\\\\np_0 = p({\\bf x}|y=0, \\mathcal{D}) \\\\\np_1 = p({\\bf x}|y=1, \\mathcal{D}) \n\u03b2=I[a(x)\u2265\u03c4\u03b1]p0=p(x|y=0,D)p1=p(x|y=1,D){\\beta = I[a({\\bf x}) \\ge \\tau_\\alpha] \\\\\np_0 = p({\\bf x}|y=0, \\mathcal{D}) \\\\\np_1 = p({\\bf x}|y=1, \\mathcal{D}) \n}\n\u3068\u7f6e\u304f\u3068\u3001\n\nL = \\int_{-\\infty}^{\\infty}  \\beta\\ p_1 \\ d{\\bf x} - \\lambda \\left( \\int_{-\\infty}^{\\infty}  \\beta\\ p_0\\ d{\\bf x} - ( 1 - \\alpha)  \\right) \\\\\n= \\int_{-\\infty}^{\\infty} \\beta (p_1 - \\lambda p_0)\\ d{\\bf x}   + \\lambda( 1 - \\alpha) \u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\nL=\u222b\u221e\u2212\u221e\u03b2\u00a0p1\u00a0dx\u2212\u03bb(\u222b\u221e\u2212\u221e\u03b2\u00a0p0\u00a0dx\u2212(1\u2212\u03b1))=\u222b\u221e\u2212\u221e\u03b2(p1\u2212\u03bbp0)\u00a0dx+\u03bb(1\u2212\u03b1)\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000{\nL = \\int_{-\\infty}^{\\infty}  \\beta\\ p_1 \\ d{\\bf x} - \\lambda \\left( \\int_{-\\infty}^{\\infty}  \\beta\\ p_0\\ d{\\bf x} - ( 1 - \\alpha)  \\right) \\\\\n= \\int_{-\\infty}^{\\infty} \\beta (p_1 - \\lambda p_0)\\ d{\\bf x}   + \\lambda( 1 - \\alpha) \u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\n}\n\u4e00\u756a\u5f8c\u308d\u306e\u2212\u03bb(1\u2212\u03b1)- \\lambda( 1 - \\alpha) \u306fa(x)a({\\bf x})\u306e\u6700\u5927\u5316\u306b\u95a2\u3057\u3066\u5b9a\u6570\u9805\u306e\u305f\u3081\u7121\u8996\u3059\u308b\u3068\u3001p14\u306b\u3042\u308b\u5f0f\u3001\n\\Psi[a|\\lambda] = \\int_{-\\infty}^{\\infty}  I[a({\\bf x}) \\ge \\tau_\\alpha]\\ \\{ p({\\bf x}|y=1, \\mathcal{D}) - \\lambda p({\\bf x}|y=0, \\mathcal{D})\\}\\ d{\\bf x} \n\u03a8[a|\u03bb]=\u222b\u221e\u2212\u221eI[a(x)\u2265\u03c4\u03b1]\u00a0{p(x|y=1,D)\u2212\u03bbp(x|y=0,D)}\u00a0dx{\\Psi[a|\\lambda] = \\int_{-\\infty}^{\\infty}  I[a({\\bf x}) \\ge \\tau_\\alpha]\\ \\{ p({\\bf x}|y=1, \\mathcal{D}) - \\lambda p({\\bf x}|y=0, \\mathcal{D})\\}\\ d{\\bf x} \n}\n\u304c\u3001\u5f97\u3089\u308c\u307e\u3059\u3002\n\u3053\u306e\u95a2\u6570\u3092\u6700\u5927\u5316\u3068\u306f\u3001\u4e0b\u8a18\u306e\u30b0\u30e9\u30d5\u306e3\u3064\u76ee\u306e\u30b0\u30e9\u30d5\u306e\u7a4d\u5206\u3001\u3064\u307e\u308a\u9762\u7a4d\u306e\u6700\u5927\u5316\u306b\u306a\u308a\u307e\u3059\u3002\n\n\u3053\u308c\u306f\u3001\u95a2\u6570\u304c\u8ca0\u306e\u5024\u3092\u3068\u308b\u9818\u57df\u3092\u9664\u304f\u3088\u3046\u306b\u6307\u793a\u95a2\u6570 I[a(x)\u2265\u03c4\u03b1]I[a({\\bf x}) \\ge \\tau_\\alpha]\u3092\u3068\u308c\u3070\u3088\u3044\u306e\u3067\u3001a(x)a({\\bf x})\u304c\u3061\u3087\u3046\u3069\u3053\u306e\u95a2\u6570 p(x|y=1,D)\u2212\u03bb\u00a0p(x|y=0,D){ p({\\bf x}|y=1, \\mathcal{D}) - \\lambda\\ p({\\bf x}|y=0, \\mathcal{D}) }\u304c\u6b63\u306e\u5024\u3092\u3068\u308b\u9818\u57df\u3092\u793a\u3059\u3088\u3046\u306b\u306a\u308c\u3070\u3088\u3044\u3068\u8003\u3048\u3089\u308c\u307e\u3059\u3002 \n\u307e\u305f\u3001\u03bb\\lambda\u306f\u6b63\u5e38\u6a19\u672c\u7cbe\u5ea6\u03b1\\alpha\u3092\u30ad\u30fc\u30d7\u3059\u308b\u305f\u3081\u306e\u30af\u30c3\u30b7\u30e7\u30f3\u3068\u306a\u308b\u5f79\u76ee\u3092\u679c\u305f\u3057\u3001\uff13\u3064\u3081\u306e\u30b0\u30e9\u30d5\u306b\u3042\u308b\u3088\u3046\u306bp(x|y=1,D)\u2212\u03bb\u00a0p(x|y=0,D)=0{ p({\\bf x}|y=1, \\mathcal{D}) - \\lambda\\ p({\\bf x}|y=0, \\mathcal{D}) }=0\u3092\u6e80\u305f\u3059\u70b9\u3092\u8abf\u6574\u3059\u308b\u5f79\u5272\u3092\u679c\u305f\u3057\u3066\u3044\u307e\u3059\u3002\n\u305d\u306e\u4e0a\u3067\u3001\u3053\u306e\u66f2\u7dda\u304c\u6b63\u306e\u5024\u3092\u3068\u308b\u9818\u57df\u3092\u6307\u3057\u793a\u3059\u306b\u306f\n {p({\\bf x'}|y=1, \\mathcal{D}) \\over p({\\bf x'}|y=0, \\mathcal{D})} \\ge \\lambda \np(x\u2032|y=1,D)p(x\u2032|y=0,D)\u2265\u03bb{ {p({\\bf x'}|y=1, \\mathcal{D}) \\over p({\\bf x'}|y=0, \\mathcal{D})} \\ge \\lambda \n}\n\u3092\u6e80\u305f\u3057\u3066\u3044\u308c\u3070\u3088\u3044\u306e\u3067\u3001\u3082\u3046\u3072\u3068\u3064\u6307\u793a\u95a2\u6570\u304c\u3042\u3063\u305f\u3068\u3057\u3066\nI\\left[{p({\\bf x'}|y=1, \\mathcal{D}) \\over p({\\bf x'}|y=0, \\mathcal{D})} \\ge \\lambda \\right]\nI[p(x\u2032|y=1,D)p(x\u2032|y=0,D)\u2265\u03bb]{I\\left[{p({\\bf x'}|y=1, \\mathcal{D}) \\over p({\\bf x'}|y=0, \\mathcal{D})} \\ge \\lambda \\right]\n}\n\u304c\u3001\u3053\u306e\u6761\u4ef6\u3092\u6e80\u305f\u3057\u3066\u3044\u308b\u6307\u793a\u95a2\u6570\u306b\u306a\u308a\u307e\u3059\u3002\u3053\u3053\u3067\u5143\u306e\u6307\u793a\u95a2\u6570\nI[a({\\bf x}) \\ge \\tau_\\alpha]\nI[a(x)\u2265\u03c4\u03b1]{I[a({\\bf x}) \\ge \\tau_\\alpha]\n}\n\u3068\u898b\u6bd4\u3079\u308b\u3068\u3001\na({\\bf x'}) = {p({\\bf x'}|y=1, \\mathcal{D}) \\over p({\\bf x'}|y=0, \\mathcal{D})} \\\\\n\\lambda =  \\tau_\\alpha\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\na(x\u2032)=p(x\u2032|y=1,D)p(x\u2032|y=0,D)\u03bb=\u03c4\u03b1\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000{a({\\bf x'}) = {p({\\bf x'}|y=1, \\mathcal{D}) \\over p({\\bf x'}|y=0, \\mathcal{D})} \\\\\n\\lambda =  \\tau_\\alpha\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\n}\n\u3068\u3057\u3066\u3082\u3001\u3053\u306e\u6761\u4ef6\u3092\u6e80\u305f\u3057\u3066\u3044\u308b\u3068\u8a00\u3048\u307e\u3059\u3002\u3088\u3063\u3066\u3001\na({\\bf x}) = {p({\\bf x}|y=1, \\mathcal{D}) \\over p({\\bf x}|y=0, \\mathcal{D})}\na(x)=p(x|y=1,D)p(x|y=0,D){a({\\bf x}) = {p({\\bf x}|y=1, \\mathcal{D}) \\over p({\\bf x}|y=0, \\mathcal{D})}\n}\n\u3092\u7570\u5e38\u5ea6\u3068\u3057\u3066\u9069\u7528\u3057\u305f\u5834\u5408\u306b\u3001\u6700\u9069\u306a\u3082\u306e\u3067\u3042\u308b\u3068\u3044\u3046\u5fc5\u8981\u5341\u5206\u6761\u4ef6\u3092\u6e80\u305f\u3057\u3066\u3044\u308b\u3068\u8a00\u3048\u308b\u306e\u3067\u3059\u30021\n\u307e\u305f\u3001\u5358\u8abf\u5897\u52a0\u95a2\u6570\u3067\u3042\u308bln(\u22c5)\\ln(\\cdot)\u3092\u3053\u308c\u306b\u9069\u7528\u3057\u3066\u3082\u3001\u540c\u69d8\u306b\u6210\u308a\u7acb\u3061\u3001\u7570\u5e38\u5ea6\u3068\u3057\u3066\u306e\u5f79\u5272\u306f\u540c\u3058\u3088\u3046\u306b\u679c\u305f\u305b\u308b\u305f\u3081\u3001\u3053\u308c\u3092\u9069\u7528\u3059\u308b\u3068\u30cd\u30a4\u30de\u30f3\u30d4\u30a2\u30bd\u30f3\u6c7a\u5b9a\u5247\u306b\u4f7f\u308f\u308c\u308b\u7570\u5e38\u5ea6\na({\\bf x}) = \\ln { p({\\bf x}|y=1, \\mathcal{D}) \\over p({\\bf x}|y=0, \\mathcal{D})}\na(x)=lnp(x|y=1,D)p(x|y=0,D){a({\\bf x}) = \\ln { p({\\bf x}|y=1, \\mathcal{D}) \\over p({\\bf x}|y=0, \\mathcal{D})}\n}\n\u304c\u6700\u9069\u306a\u7570\u5e38\u5ea6\u306e\u6761\u4ef6\u3092\u6e80\u305f\u3057\u3066\u3044\u308b\u3053\u3068\u304c\u8a00\u3048\u308b\u3053\u3068\u304c\u308f\u304b\u308a\u307e\u3057\u305f\u3002\n\n\u53c2\u8003\u56f3\u66f8\n\u300c\u7570\u5e38\u691c\u77e5\u3068\u5909\u5316\u691c\u77e5\u300d\u3000\u4e95\u624b\u525b\u3001\u6749\u5c71\u5c06\u8457\u3000\uff08\u6a5f\u68b0\u5b66\u7fd2\u30d7\u30ed\u30d5\u30a7\u30c3\u30b7\u30e7\u30ca\u30eb\u30b7\u30ea\u30fc\u30ba\uff09\n\u3000\u3000http://ide-research.net/book/support.html\n\n\n\n\n\u305f\u3060\u3057\u3001\u4ed6\u306b\u3082\u3053\u306e\u6700\u9069\u3092\u6e80\u305f\u3057\u305f\u7570\u5e38\u5ea6\u306b\u4f7f\u3048\u308b\u9928\u6570\u306e\u5b58\u5728\u306f\u5426\u5b9a\u3057\u3066\u304a\u3089\u305a\u3001\u552f\u4e00\u306e\u3082\u306e\u3067\u3042\u308b\u3068\u306f\u8a00\u3063\u3066\u3044\u306a\u3044\u306e\u3067\u306f\u3001\u3068\u8003\u3048\u3066\u3044\u307e\u3059\u3002\u00a0\u21a9\n\n\n\n\u3010\u6a5f\u68b0\u5b66\u7fd2\u3011\u300c\u7570\u5e38\u691c\u77e5\u3068\u5909\u5316\u691c\u77e5 1\u7ae0\u300d\u30cd\u30a4\u30de\u30f3\u30d4\u30a2\u30bd\u30f3\u306e\u88dc\u984c\u306e\u5f0f\u306e\u884c\u9593\u3092\u57cb\u3081\u3066\u307f\u308b\n\u6a5f\u68b0\u5b66\u7fd2\u30d7\u30ed\u30d5\u30a7\u30c3\u30b7\u30e7\u30ca\u30eb\u30b7\u30ea\u30fc\u30ba\u300c\u7570\u5e38\u691c\u77e5\u3068\u5909\u5316\u691c\u77e5\u300d(http://ide-research.net/book/support.html#kodansha) \u7b2c1\u7ae0 \u300c\u5b9a\u74061.2 \u30cd\u30a4\u30de\u30f3\u30d4\u30a2\u30bd\u30f3\u306e\u88dc\u984c\u300d\u306e\u5f0f\u5c55\u958b\u306e\u9593\u3092\u57cb\u3081\u3066\u307f\u308b\u3001\u3068\u3044\u3046\u8a18\u4e8b\u3067\u3059\u3002\n\n\u81ea\u5206\u306a\u308a\u306e\u8003\u3048\u3082\u5165\u3063\u3066\u3044\u308b\u305f\u3081\u3001\u3082\u3057\u3054\u6307\u6458\u7b49\u3042\u308c\u3070\u30b3\u30e1\u30f3\u30c8\u3084\u3001Tweet\u306a\u3069\u3067\u3054\u9023\u7d61\u3044\u305f\u3060\u3051\u308b\u3068\u5b09\u3057\u3044\u3067\u3059\u3002\u307e\u305f\u3001\u3053\u306e\u8a18\u4e8b\u5185\u306b\u8aa4\u308a\u304c\u3042\u3063\u305f\u5834\u5408\u306f\u79c1@kenmatu4\u306e\u8cac\u4efb\u3067\u3059\u306e\u3067\u3001\u8457\u8005\u306e\u65b9\u306b\u554f\u3044\u5408\u308f\u305b\u3092\u884c\u308f\u306a\u3044\u3088\u3046\u5fa1\u9858\u3044\u81f4\u3057\u307e\u3059\u3002\n\n> **\u30cd\u30a4\u30de\u30f3\u30fb\u30d4\u30a2\u30bd\u30f3\u306e\u88dc\u984c**\n> \u89b3\u6e2c\u5024${\\bf x'}$\u306b\u304a\u3051\u308b\u7570\u5e38\u5ea6 $a({\\bf x'}) = \\ln{ p({\\bf x'}|y=1, \\mathcal{D}) \\over p({\\bf x'}|y=0, \\mathcal{D}) }$ \u3068\u3044\u3046\u5b9a\u7fa9\u306f\u3001\u4e00\u5b9a\u306e\u6b63\u5e38\u6a19\u672c\u306e\u4e0b\u3067\u7570\u5e38\u6a19\u672c\u7cbe\u5ea6\u3092\u6700\u5927\u306b\u3059\u308b\u3068\u3044\u3046\u610f\u5473\u3067\u6700\u9069\u3067\u3042\u308b\u3002\n\n\n\u6700\u9069\u306a\u7570\u5e38\u5ea6\u3001\u3068\u306f\u4e0b\u8a18\u306e\u3088\u3046\u306b\u6240\u4e0e\u306e\u89b3\u6e2c\u5024${\\bf x'}$\u3068\u6b63\u5e38\u6a19\u672c\u7cbe\u5ea6$\\alpha$\u306e\u3082\u3068\u3067\u3001\u4e0b\u8a18\u306e\u7a4d\u5206\u3092\u6700\u5927\u5316\u3059\u308b\u3088\u3046\u306a\u95a2\u6570$a({\\bf x})$\u3067\u3042\u308b\u3068\u3057\u3001\u3001\u305d\u308c\u3092$a^*$\u3068\u7f6e\u304d\u307e\u3059\u3002\n\n```math\na^* = \\arg\\max_a \\int_{-\\infty}^{\\infty}  I[a({\\bf x}) \\ge \\tau_\\alpha]\\ p({\\bf x}|y=1, \\mathcal{D})\\ d{\\bf x}\u3000\u3000\u3000\u3000\u3000\u3000\u3000\\cdots (*)\n```\n\n\u307e\u305f\u3001\u6b63\u5e38\u6a19\u672c\u7cbe\u5ea6$\\alpha$\u3068\u306f\u4e0b\u8a18\u306e\u30b0\u30e9\u30d5\u306e\u4e0a\u304b\u3089\uff12\u3064\u76ee\u306e\u6c34\u8272\u306e\u9762\u7a4d\u306e\u3053\u3068\u306a\u306e\u3067\u3001$\\alpha$\u3092\u78ba\u5b9a\u3055\u305b\u308b\u3068\u9762\u7a4d\u304c\u6c7a\u307e\u308a\u3001\u7570\u5e38\u5ea6 $a({\\bf x})$\u306e\u5b9a\u7fa9\u306e\u4ed5\u65b9\u306b\u3088\u3063\u3066\u305d\u306e\u9762\u7a4d\u306e\u53d6\u308a\u65b9\uff08\u7247\u5074\u3068\u304b\u3001\u4e21\u5074\u3068\u304b\u3001\u305d\u306e\u4ed6\u3044\u308d\u3044\u308d\u540c\u3058\u9762\u7a4d\u3067\u3082\u53d6\u308a\u65b9\u3092\u9078\u3079\u308b\u306e\u3067\uff09\u304c\u304d\u307e\u308a\u3001\u7d50\u679c${\\bf x'}$\u304c\u6c7a\u307e\u308a\u307e\u3059\u3002\n\n\u3044\u307e\u3001\u8ef8\u304c\uff14\u3064\u3042\u308a\u3001\n\n* \u89b3\u6e2c\u5024  :\u3000${\\bf x},\\ {\\bf x'}$\n* \u7570\u5e38\u5ea6  :\u3000$a({\\bf x}),\\ \\tau,\\ \\tau_\\alpha$\n* \u78ba\u7387\u5bc6\u5ea6:\u3000$p({\\bf x}|y=0, \\mathcal{D}), p({\\bf x}|y=1, \\mathcal{D}),$\n* \u78ba\u7387(\u7cbe\u5ea6):\u3000$\\alpha$\n\n\u3067\u3042\u308b\u3053\u3068\u306b\u6ce8\u610f\u3057\u3066\u3001\u5225\u306a\u6b21\u5143\u306e\u30c7\u30fc\u30bf\u3067\u8a08\u7b97\u3057\u3066\u3057\u307e\u308f\u306a\u3044\u3088\u3046\u306b\u610f\u8b58\u3059\u308b\u3053\u3068\u304c\u91cd\u8981\u304b\u306a\u3068\u601d\u3063\u3066\u3044\u307e\u3059\u3002\uff08\u300c\u78ba\u7387\u300d\u306e\u90e8\u5206\u306f\u78ba\u7387\u5bc6\u5ea6\u3001\u3068\u78ba\u7387\u3001\u304c\u3042\u308b\u3053\u3068\u306b\u6ce8\u610f\u3067\u3059\u3002\uff09\n\n\u4e0b\u8a18\u306e\u56f3\u306f\u3001\u6a2a\u8ef8\u306f\u5168\u3066\u89b3\u6e2c\u5024\u3001\u7e26\u8ef8\u306f\u4e0a\u304b\u3089\u3001\uff12\u3064\u76ee\u304c\u78ba\u7387(\u5bc6\u5ea6)\u3001\uff14\u3064\u76ee\u304c\u7570\u5e38\u5ea6\u306b\u306a\u308a\u307e\u3059\u3002$\\alpha$\u306f\uff12\u3064\u76ee\u306e\u30b0\u30e9\u30d5\u306e\u9762\u7a4d\u306e\u90e8\u5206\u306b\u306a\u308a\u307e\u3059\u306d\u3002\n\n![anomaly_detection_1.2.png](https://qiita-image-store.s3.amazonaws.com/0/50670/0d7bd9fc-b153-de2e-121d-c53912fa966a.png)\n\n\n(*)\u5f0f\u306e$\\max(\\cdot)$\u306e\u306a\u304b\u3092\u6700\u5927\u5316\u3059\u308b\u306e\u3067\u3001\u4e0b\u8a18\u306e\u554f\u984c\u3092\u89e3\u304f\u3053\u3068\u3067\u7b54\u3048\u304c\u5f97\u3089\u308c\u307e\u3059\u3002\u3053\u306e\u5236\u7d04\u6761\u4ef6\u306f\u6b63\u5e38\u6a19\u672c\u7cbe\u5ea6\u304c$\\alpha$\u3067\u3042\u308b\u3053\u3068\u3092\u6e80\u305f\u3059\u305f\u3081\u306e\u6761\u4ef6\u3067\u3059\u3002\n\n```math\n\\int_{-\\infty}^{\\infty}  I[a({\\bf x}) \\ge \\tau_\\alpha]\\ p({\\bf x}|y=1, \\mathcal{D})\\ d{\\bf x}\u3000\\rightarrow \\max \\\\\n{\\rm subject\\ to} \\int_{-\\infty}^{\\infty}  I[a({\\bf x}) \\ge \\tau_\\alpha]\\ p({\\bf x}|y=0, \\mathcal{D})\\ d{\\bf x} = 1 - \\alpha\n```\n\n\u30e9\u30b0\u30e9\u30f3\u30b8\u30e5\u306e\u672a\u5b9a\u4e57\u6570\u65b9\u3092\u4f7f\u3063\u3066\u6761\u4ef6\u3064\u304d\u6700\u5927\u5316\u3092\u884c\u3044\u307e\u3059\u3002\u5bfe\u8c61\u306e\u95a2\u6570\u3092$L$\u3068\u7f6e\u304f\u3068\u3001\n\n```math\nL = \\int_{-\\infty}^{\\infty}  I[a({\\bf x}) \\ge \\tau_\\alpha]\\ p({\\bf x}|y=1, \\mathcal{D})\\ d{\\bf x} - \\lambda \\left( \\int_{-\\infty}^{\\infty}  I[a({\\bf x}) \\ge \\tau_\\alpha]\\ p({\\bf x}|y=0, \\mathcal{D})\\ d{\\bf x} - ( 1 - \\alpha)  \\right)\n\n```\n\n\u7c21\u5358\u5316\u306e\u305f\u3081\u306b\n\n```math\n\\beta = I[a({\\bf x}) \\ge \\tau_\\alpha] \\\\\np_0 = p({\\bf x}|y=0, \\mathcal{D}) \\\\\np_1 = p({\\bf x}|y=1, \\mathcal{D}) \n```\n\n\u3068\u7f6e\u304f\u3068\u3001\n\n\n```math\n\nL = \\int_{-\\infty}^{\\infty}  \\beta\\ p_1 \\ d{\\bf x} - \\lambda \\left( \\int_{-\\infty}^{\\infty}  \\beta\\ p_0\\ d{\\bf x} - ( 1 - \\alpha)  \\right) \\\\\n= \\int_{-\\infty}^{\\infty} \\beta (p_1 - \\lambda p_0)\\ d{\\bf x}   + \\lambda( 1 - \\alpha) \u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\n```\n\n\u4e00\u756a\u5f8c\u308d\u306e$- \\lambda( 1 - \\alpha) $\u306f$a({\\bf x})$\u306e\u6700\u5927\u5316\u306b\u95a2\u3057\u3066\u5b9a\u6570\u9805\u306e\u305f\u3081\u7121\u8996\u3059\u308b\u3068\u3001p14\u306b\u3042\u308b\u5f0f\u3001\n\n```math\n\\Psi[a|\\lambda] = \\int_{-\\infty}^{\\infty}  I[a({\\bf x}) \\ge \\tau_\\alpha]\\ \\{ p({\\bf x}|y=1, \\mathcal{D}) - \\lambda p({\\bf x}|y=0, \\mathcal{D})\\}\\ d{\\bf x} \n```\n\n\u304c\u3001\u5f97\u3089\u308c\u307e\u3059\u3002\n\n\u3053\u306e\u95a2\u6570\u3092\u6700\u5927\u5316\u3068\u306f\u3001\u4e0b\u8a18\u306e\u30b0\u30e9\u30d5\u306e3\u3064\u76ee\u306e\u30b0\u30e9\u30d5\u306e\u7a4d\u5206\u3001\u3064\u307e\u308a\u9762\u7a4d\u306e\u6700\u5927\u5316\u306b\u306a\u308a\u307e\u3059\u3002\n\n![anomaly2-compressor.png](https://qiita-image-store.s3.amazonaws.com/0/50670/c03d780a-f454-4e71-1a18-681bd3695295.png)\n\n\u3053\u308c\u306f\u3001\u95a2\u6570\u304c\u8ca0\u306e\u5024\u3092\u3068\u308b\u9818\u57df\u3092\u9664\u304f\u3088\u3046\u306b\u6307\u793a\u95a2\u6570 $I[a({\\bf x}) \\ge \\tau_\\alpha]$\u3092\u3068\u308c\u3070\u3088\u3044\u306e\u3067\u3001$a({\\bf x})$\u304c\u3061\u3087\u3046\u3069\u3053\u306e\u95a2\u6570 $\\{ p({\\bf x}|y=1, \\mathcal{D}) - \\lambda\\ p({\\bf x}|y=0, \\mathcal{D}) \\}$\u304c\u6b63\u306e\u5024\u3092\u3068\u308b\u9818\u57df\u3092\u793a\u3059\u3088\u3046\u306b\u306a\u308c\u3070\u3088\u3044\u3068\u8003\u3048\u3089\u308c\u307e\u3059\u3002 \n\n\u307e\u305f\u3001$\\lambda$\u306f\u6b63\u5e38\u6a19\u672c\u7cbe\u5ea6$\\alpha$\u3092\u30ad\u30fc\u30d7\u3059\u308b\u305f\u3081\u306e\u30af\u30c3\u30b7\u30e7\u30f3\u3068\u306a\u308b\u5f79\u76ee\u3092\u679c\u305f\u3057\u3001\uff13\u3064\u3081\u306e\u30b0\u30e9\u30d5\u306b\u3042\u308b\u3088\u3046\u306b$\\{ p({\\bf x}|y=1, \\mathcal{D}) - \\lambda\\ p({\\bf x}|y=0, \\mathcal{D}) \\}=0$\u3092\u6e80\u305f\u3059\u70b9\u3092\u8abf\u6574\u3059\u308b\u5f79\u5272\u3092\u679c\u305f\u3057\u3066\u3044\u307e\u3059\u3002\n\n\u305d\u306e\u4e0a\u3067\u3001\u3053\u306e\u66f2\u7dda\u304c\u6b63\u306e\u5024\u3092\u3068\u308b\u9818\u57df\u3092\u6307\u3057\u793a\u3059\u306b\u306f\n\n```math\n {p({\\bf x'}|y=1, \\mathcal{D}) \\over p({\\bf x'}|y=0, \\mathcal{D})} \\ge \\lambda \n```\n\u3092\u6e80\u305f\u3057\u3066\u3044\u308c\u3070\u3088\u3044\u306e\u3067\u3001\u3082\u3046\u3072\u3068\u3064\u6307\u793a\u95a2\u6570\u304c\u3042\u3063\u305f\u3068\u3057\u3066\n\n```math\nI\\left[{p({\\bf x'}|y=1, \\mathcal{D}) \\over p({\\bf x'}|y=0, \\mathcal{D})} \\ge \\lambda \\right]\n```\n\n\u304c\u3001\u3053\u306e\u6761\u4ef6\u3092\u6e80\u305f\u3057\u3066\u3044\u308b\u6307\u793a\u95a2\u6570\u306b\u306a\u308a\u307e\u3059\u3002\u3053\u3053\u3067\u5143\u306e\u6307\u793a\u95a2\u6570\n\n```math\nI[a({\\bf x}) \\ge \\tau_\\alpha]\n```\n\u3068\u898b\u6bd4\u3079\u308b\u3068\u3001\n\n```math\na({\\bf x'}) = {p({\\bf x'}|y=1, \\mathcal{D}) \\over p({\\bf x'}|y=0, \\mathcal{D})} \\\\\n\\lambda =  \\tau_\\alpha\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\n```\n\n\u3068\u3057\u3066\u3082\u3001\u3053\u306e\u6761\u4ef6\u3092\u6e80\u305f\u3057\u3066\u3044\u308b\u3068\u8a00\u3048\u307e\u3059\u3002\u3088\u3063\u3066\u3001\n\n\n```math\na({\\bf x}) = {p({\\bf x}|y=1, \\mathcal{D}) \\over p({\\bf x}|y=0, \\mathcal{D})}\n```\n\n\u3092\u7570\u5e38\u5ea6\u3068\u3057\u3066\u9069\u7528\u3057\u305f\u5834\u5408\u306b\u3001\u6700\u9069\u306a\u3082\u306e\u3067\u3042\u308b\u3068\u3044\u3046\u5fc5\u8981\u5341\u5206\u6761\u4ef6\u3092\u6e80\u305f\u3057\u3066\u3044\u308b\u3068\u8a00\u3048\u308b\u306e\u3067\u3059\u3002[^1]\n[^1]: \u305f\u3060\u3057\u3001\u4ed6\u306b\u3082\u3053\u306e\u6700\u9069\u3092\u6e80\u305f\u3057\u305f\u7570\u5e38\u5ea6\u306b\u4f7f\u3048\u308b\u9928\u6570\u306e\u5b58\u5728\u306f\u5426\u5b9a\u3057\u3066\u304a\u3089\u305a\u3001\u552f\u4e00\u306e\u3082\u306e\u3067\u3042\u308b\u3068\u306f\u8a00\u3063\u3066\u3044\u306a\u3044\u306e\u3067\u306f\u3001\u3068\u8003\u3048\u3066\u3044\u307e\u3059\u3002\n\n\u307e\u305f\u3001\u5358\u8abf\u5897\u52a0\u95a2\u6570\u3067\u3042\u308b$\\ln(\\cdot)$\u3092\u3053\u308c\u306b\u9069\u7528\u3057\u3066\u3082\u3001\u540c\u69d8\u306b\u6210\u308a\u7acb\u3061\u3001\u7570\u5e38\u5ea6\u3068\u3057\u3066\u306e\u5f79\u5272\u306f\u540c\u3058\u3088\u3046\u306b\u679c\u305f\u305b\u308b\u305f\u3081\u3001\u3053\u308c\u3092\u9069\u7528\u3059\u308b\u3068\u30cd\u30a4\u30de\u30f3\u30d4\u30a2\u30bd\u30f3\u6c7a\u5b9a\u5247\u306b\u4f7f\u308f\u308c\u308b\u7570\u5e38\u5ea6\n\n```math\na({\\bf x}) = \\ln { p({\\bf x}|y=1, \\mathcal{D}) \\over p({\\bf x}|y=0, \\mathcal{D})}\n```\n\n\u304c\u6700\u9069\u306a\u7570\u5e38\u5ea6\u306e\u6761\u4ef6\u3092\u6e80\u305f\u3057\u3066\u3044\u308b\u3053\u3068\u304c\u8a00\u3048\u308b\u3053\u3068\u304c\u308f\u304b\u308a\u307e\u3057\u305f\u3002\n\n# \u53c2\u8003\u56f3\u66f8\n\u300c\u7570\u5e38\u691c\u77e5\u3068\u5909\u5316\u691c\u77e5\u300d\u3000\u4e95\u624b\u525b\u3001\u6749\u5c71\u5c06\u8457\u3000\uff08\u6a5f\u68b0\u5b66\u7fd2\u30d7\u30ed\u30d5\u30a7\u30c3\u30b7\u30e7\u30ca\u30eb\u30b7\u30ea\u30fc\u30ba\uff09\n\u3000\u3000http://ide-research.net/book/support.html\n"}