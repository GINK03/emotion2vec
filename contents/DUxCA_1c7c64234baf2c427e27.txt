{"context": "\n\nEmscripten File System API \u3067\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u30c4\u30ea\u30fc\u3092\u8868\u793a\u3059\u308b\n\u5927\u672c\u55b6 \u306b\u306f\u3054\u304f\u4e00\u90e8\u306eAPI\u3057\u304b\u8f09\u3063\u3066\u3044\u306a\u3044\u306e\u3067\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u3092\u8aad\u3080\u304b\u30b3\u30f3\u30bd\u30fc\u30eb\u3067 FS \u306b\u751f\u3048\u3066\u3044\u308b\u30e1\u30bd\u30c3\u30c9\u3092\u78ba\u8a8d\u3059\u308b\u5fc5\u8981\u304c\u3042\u308b\u3002\n\n\u30b3\u30fc\u30c9\nfunction ls(pathname){\n  var names = FS.readdir(pathname);\n  return names.map(function(name){\n    var stat = FS.lstat(pathname +\"/\"+ name);\n    return {name: name, stat: stat};\n  });\n}\n\nfunction getFileType({mode}){\n  return FS.isFile(mode) ? \"file\"\n       : FS.isDir(mode) ? \"dir\"\n       : FS.isBlkdev(mode) ? \"blcdev\"\n       : FS.isChrdev(mode) ? \"chardev\"\n       : FS.isLink(mode) ? \"symlink\"\n       : FS.isFIFO(mode) ? \"fifo\"\n       : FS.isSocket(mode) ? \"socket\"\n       : \"unkown\";\n}\n\nfunction tree(pathname){\n  var elms = ls(pathname).map(function(elm){\n    if(elm.name !== \".\" && elm.name !== \"..\" && getFileType(elm.stat) === \"dir\"){\n      var dir = tree(pathname +\"/\"+ elm.name);\n      return {name: elm.name, type: dir};\n    }\n    return {name: elm.name, type: getFileType(elm.stat)};\n  });\n  return elms.reduce(function(o, elm){\n    o[elm.name] = elm.type;\n    return o;\n  }, {});\n}\n\n\nFS.chdir(\"/home/web_user\");\nFS.mkdir('working');\nFS.mount(MEMFS, { root: '.' }, 'working');\nFS.chdir(\"working\");\n\nconsole.log(JSON.stringify(tree(\"/home\"), null, \"  \"));\n\n\n\u7d50\u679c\n{\n  \".\": \"dir\",\n  \"..\": \"dir\",\n  \"web_user\": {\n    \".\": \"dir\",\n    \"..\": \"dir\",\n    \"working\": {\n      \".\": \"dir\",\n      \"..\": \"dir\"\n    }\n  }\n}\n\n\n\u53c2\u8003\n\nhttps://kripken.github.io/emscripten-site/docs/api_reference/Filesystem-API.html\nhttp://qiita.com/DUxCA/items/10efc3b74ede2f91f3c7\nhttp://qiita.com/DUxCA/items/5b725cb6359003c53171\n\n# Emscripten File System API \u3067\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u30c4\u30ea\u30fc\u3092\u8868\u793a\u3059\u308b\n\n[\u5927\u672c\u55b6](https://kripken.github.io/emscripten-site/docs/api_reference/Filesystem-API.html) \u306b\u306f\u3054\u304f\u4e00\u90e8\u306eAPI\u3057\u304b\u8f09\u3063\u3066\u3044\u306a\u3044\u306e\u3067[\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u3092\u8aad\u3080](https://github.com/kripken/emscripten/blob/incoming/src/library_fs.js)\u304b\u30b3\u30f3\u30bd\u30fc\u30eb\u3067 `FS` \u306b\u751f\u3048\u3066\u3044\u308b\u30e1\u30bd\u30c3\u30c9\u3092\u78ba\u8a8d\u3059\u308b\u5fc5\u8981\u304c\u3042\u308b\u3002\n\n## \u30b3\u30fc\u30c9\n\n```js\nfunction ls(pathname){\n  var names = FS.readdir(pathname);\n  return names.map(function(name){\n    var stat = FS.lstat(pathname +\"/\"+ name);\n    return {name: name, stat: stat};\n  });\n}\n\nfunction getFileType({mode}){\n  return FS.isFile(mode) ? \"file\"\n       : FS.isDir(mode) ? \"dir\"\n       : FS.isBlkdev(mode) ? \"blcdev\"\n       : FS.isChrdev(mode) ? \"chardev\"\n       : FS.isLink(mode) ? \"symlink\"\n       : FS.isFIFO(mode) ? \"fifo\"\n       : FS.isSocket(mode) ? \"socket\"\n       : \"unkown\";\n}\n\nfunction tree(pathname){\n  var elms = ls(pathname).map(function(elm){\n    if(elm.name !== \".\" && elm.name !== \"..\" && getFileType(elm.stat) === \"dir\"){\n      var dir = tree(pathname +\"/\"+ elm.name);\n      return {name: elm.name, type: dir};\n    }\n    return {name: elm.name, type: getFileType(elm.stat)};\n  });\n  return elms.reduce(function(o, elm){\n    o[elm.name] = elm.type;\n    return o;\n  }, {});\n}\n\n\nFS.chdir(\"/home/web_user\");\nFS.mkdir('working');\nFS.mount(MEMFS, { root: '.' }, 'working');\nFS.chdir(\"working\");\n\nconsole.log(JSON.stringify(tree(\"/home\"), null, \"  \"));\n```\n\n## \u7d50\u679c\n\n```json\n{\n  \".\": \"dir\",\n  \"..\": \"dir\",\n  \"web_user\": {\n    \".\": \"dir\",\n    \"..\": \"dir\",\n    \"working\": {\n      \".\": \"dir\",\n      \"..\": \"dir\"\n    }\n  }\n}\n```\n## \u53c2\u8003\n* https://kripken.github.io/emscripten-site/docs/api_reference/Filesystem-API.html\n* http://qiita.com/DUxCA/items/10efc3b74ede2f91f3c7\n* http://qiita.com/DUxCA/items/5b725cb6359003c53171\n", "tags": ["Emscripten", "FileSystemAPI"]}