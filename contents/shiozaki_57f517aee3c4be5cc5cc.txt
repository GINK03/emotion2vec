{"tags": ["bigquery", "GoogleCloudPlatform", "SQL", "gcp", "google"], "context": "\u5148\u65e5\u306b\u516c\u958b\u3057\u305f\u3001\u6587\u5b57\u5217\u3092\u9006\u9806\u306b\u3059\u308b\u65b9\u6cd5\u3092\u5fdc\u7528\u3057\u3066\u3001\u914d\u5217\u3092\u9006\u9806\u306b\u3059\u308bUDF\u3092\u66f8\u3044\u3066\u307f\u307e\u3057\u305f\u3002\n\u57fa\u672c\u7684\u306a\u539f\u7406\u306f\u6587\u5b57\u5217\u3092\u9006\u9806\u306b\u3059\u308b\u65b9\u6cd5\u3068\u540c\u3058\u3067\u3059\u3002\n#standardSQL\nCREATE  TEMPORARY FUNCTION ARRAY_INT64_REVERSE(arr ARRAY<INT64>)\nRETURNS ARRAY<INT64> AS ((\n  SELECT ARRAY(SELECT arr[OFFSET(ARRAY_LENGTH(arr) - seq)] FROM UNNEST(T.seqs) AS seq\n  ) FROM (\n    SELECT arr, GENERATE_ARRAY(1, ARRAY_LENGTH(arr)) AS seqs\n  ) AS T\n));\n\nSELECT ARRAY_INT64_REVERSE([1, 2, 3, 4, 5])\n\nBigQuery\u306eUDF\u3067\u306f\u30b8\u30a7\u30cd\u30ea\u30c3\u30af\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u3092\u4f7f\u3048\u306a\u3044\u306e\u3067\u3001ARRAY\u306e\u8981\u7d20\u306e\u578b\u3092\u5177\u4f53\u7684\u306b\u66f8\u304f\u5fc5\u8981\u304c\u3042\u308a\u3001\u3084\u3084\u9762\u5012\u3067\u3059\u3002\n\u5148\u65e5\u306b\u516c\u958b\u3057\u305f\u3001\u6587\u5b57\u5217\u3092\u9006\u9806\u306b\u3059\u308b\u65b9\u6cd5\u3092\u5fdc\u7528\u3057\u3066\u3001\u914d\u5217\u3092\u9006\u9806\u306b\u3059\u308bUDF\u3092\u66f8\u3044\u3066\u307f\u307e\u3057\u305f\u3002\n\u57fa\u672c\u7684\u306a\u539f\u7406\u306f\u6587\u5b57\u5217\u3092\u9006\u9806\u306b\u3059\u308b\u65b9\u6cd5\u3068\u540c\u3058\u3067\u3059\u3002\n\n```sql\n#standardSQL\nCREATE  TEMPORARY FUNCTION ARRAY_INT64_REVERSE(arr ARRAY<INT64>)\nRETURNS ARRAY<INT64> AS ((\n  SELECT ARRAY(SELECT arr[OFFSET(ARRAY_LENGTH(arr) - seq)] FROM UNNEST(T.seqs) AS seq\n  ) FROM (\n    SELECT arr, GENERATE_ARRAY(1, ARRAY_LENGTH(arr)) AS seqs\n  ) AS T\n));\n\nSELECT ARRAY_INT64_REVERSE([1, 2, 3, 4, 5])\n```\n\nBigQuery\u306eUDF\u3067\u306f\u30b8\u30a7\u30cd\u30ea\u30c3\u30af\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u3092\u4f7f\u3048\u306a\u3044\u306e\u3067\u3001ARRAY\u306e\u8981\u7d20\u306e\u578b\u3092\u5177\u4f53\u7684\u306b\u66f8\u304f\u5fc5\u8981\u304c\u3042\u308a\u3001\u3084\u3084\u9762\u5012\u3067\u3059\u3002\n"}