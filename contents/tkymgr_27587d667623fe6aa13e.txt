{"context": " More than 1 year has passed since last update.\u30ab\u30c4\u30a2\u30b2\u306f\u3044\u304b\u3093\u3088\uff01\n\u5144\u5f1f\u30b2\u30f3\u30ab\u3057\u3066\u3044\u305f\u592a\u90ce\u3068\u6b21\u90ce\u304c\u4ef2\u76f4\u308a\u3057\u3066\u3001\u30b3\u30f3\u30d3\u30cb\u3078\u304a\u3084\u3064\u3092\u8cb7\u3044\u306b\u884c\u304f\u9014\u4e2d\u3001\n\u4e0d\u826f\u4e2d\u5b66\u751f\u30b0\u30eb\u30fc\u30d7\u306b\u51fa\u304f\u308f\u3057\u3066\u3001\u30ab\u30c4\u30a2\u30b2\u3055\u308c\u308b\u69d8\u5b50\u3092\u30b3\u30fc\u30c9\u5316\u3057\u307e\u3057\u305f\u3002\uff08\u8b0e\uff09\n\nbattle.php\n<?php\n/*\n * \u30b5\u30a4\u30b3\u30ed\n */\nfunction dice($param) {\n    $_value = 0;\n    if (preg_match('/^(\\d+)?[dD]\\d+([+]\\d+)?$/', $param, $_check) === 1) {\n        $_param = $_check[0];\n        $_result = preg_split('/[dD]/', $_param);\n        $_shakes = ($_result[0] == '') ? 1 : $_result[0];\n        $_param = $_result[1];\n        $_result = preg_split('/[+]/', $_param);\n        $_faces = $_result[0];\n        $_baseValue = (!isset($_result[1]) || $_result[1] == '') ? 0 : $_result[1];\n        for ($_index = 0; $_index < $_shakes; $_index++)\n            $_value += mt_rand(1, $_faces);\n        $_value += $_baseValue;\n    }\n    return $_value;\n}\n\n/*\n * \u30c0\u30e1\u30fc\u30b8\u8a08\u7b97\n */\nfunction calcDamages($weapon, $defPoint, &$message) {\n    $damages = (int)(dice($weapon[\"ATK\"]) - $defPoint);\n    if ($damages == 0) {\n        $message = \"\u653b\u6483\u304c\u5f3e\u304d\u8fd4\u3055\u308c\u305f\uff01\";\n    }\n    if ($damages < 0) {\n        $message = \"\u653b\u6483\u306f\u5c4a\u304b\u306a\u304b\u3063\u305f.\";\n        $damages = 0;\n    }\n    if ($damages > 0) {\n        $message = $damages.\"\u306e\u30c0\u30e1\u30fc\u30b8\u3092\u4e0e\u3048\u305f!\";\n    }\n    return $damages;\n}\n\n/*\n * \u653b\u6483\u51e6\u7406\n */\nfunction Attack($a, $b) {\n    $dmg = calcDamages($a->weapon, $b->defPoint, $msgs);\n    echo $a->name . \"\u304c\u8df3\u3073\u304b\u304b\u3063\u305f!<br>\\n\";\n    echo $b->name . \"\u306b\". $msgs . \"<br>\\n\";\n    $b->hitPoint -= $dmg;\n    if ($b->hitPoint < 0) {\n        $b->hitPoint = 0;\n    }\n}\n\n/*\n * \u30c1\u30fc\u30e0\u306e\u72b6\u614b\u3092\u8abf\u3079\u308b\n */\nfunction teamPoint($team) {\n    $value = 0;\n    foreach ($team->members as $member) {\n        $value += $member->hitPoint;\n    }\n    return $value;\n}\n\n/*\n * \u6b66\u5668\n */\n$weapon = array (\n    \"name\" => \"\u91d1\u5c5e\u30d0\u30c3\u30c8\",\n    \"ATK\" => \"3d6\",\n);\n\n$hand = array (\n    \"name\" => \"\u7d20\u624b\",\n    \"ATK\" => \"1d6\",\n);\n\n/*\n * \u592a\u90ce\u3068\u6b21\u90ce\n */\n\n$taro = new stdClass();\n$taro->name = \"\u592a\u90ce\";\n$taro->hitPoint = dice(\"3d6\");\n$taro->defPoint = dice(\"1d6\");\n$taro->weapon = $weapon;\n\n$jiro = new stdClass();\n$jiro->name = \"\u6b21\u90ce\";\n$jiro->hitPoint = dice(\"3d6\");\n$jiro->defPoint = dice(\"1d6\");\n$jiro->weapon = $weapon;\n\n/*\n * \u30c1\u30fc\u30e0\uff08\u30d1\u30fc\u30c6\u30a3\uff09\u306e\u7d50\u6210\n */\n$teamA = new stdClass();\n\n$teamA->members[] = $taro;\n$teamA->members[] = $jiro;\n\n$taro->team = $teamA;\n$jiro->team = $teamA;\n\n/*\n * \u4e0d\u826f\u305f\u3061\n */\n$hooliganA = new stdClass();\n$hooliganA->name = \"\u30ea\u30fc\u30bc\u30f3\u30c8\";\n$hooliganA->hitPoint = dice(\"4d6\");\n$hooliganA->defPoint = dice(\"1d6+4\");\n$hooliganA->weapon = $hand;\n\n$hooliganB = new stdClass();\n$hooliganB->name = \"\u89d2\u5208\u308a\";\n$hooliganB->hitPoint = dice(\"4d6\");\n$hooliganB->defPoint = dice(\"1d6+4\");\n$hooliganB->weapon = $hand;\n\n$hooliganC = new stdClass();\n$hooliganC->name = \"\u30b0\u30e9\u30b5\u30f3\";\n$hooliganC->hitPoint = dice(\"4d6\");\n$hooliganC->defPoint = dice(\"1d6+4\");\n$hooliganC->weapon = $hand;\n\n/*\n * \u30b4\u30ed\u30c4\u30ad\u306e\u7d50\u6210\n */\n$teamB->members[] = $hooliganA;\n$teamB->members[] = $hooliganB;\n$teamB->members[] = $hooliganC;\n\n$hooliganA->team = $teamB;\n$hooliganB->team = $teamB;\n$hooliganC->team = $teamB;\n\n?>\n\n<!DOCTYPE html>\n<html lang=\"ja\">\n<head>\n<meta charset=\"UTF-8\">\n<title>\u30e8\u30f3\u30d7\u30eb</title>\n</head>\n<body>\n<?php\necho $taro->name . \"HP:\" . $taro->hitPoint . \" / \" . $jiro->name . \"HP:\" . $jiro->hitPoint;\necho \"  |  \";\necho $hooliganA->name . \"HP:\" . $hooliganA->hitPoint . \" / \" . $hooliganB->name . \"HP:\" . $hooliganB->hitPoint . \" / \" . $hooliganC->name . \"HP:\" . $hooliganC->hitPoint;\necho \"<br>\\n<hr>\\n\";\n\nwhile (teamPoint($teamA) > 0 && teamPoint($teamB) > 0) {\n    // \u653b\u6483\u9806\u5e8f\u3092\u6c7a\u3081\u308b\n    $initiative = array();\n    foreach ($teamA->members as $member) {\n        if ($member->hitPoint > 0)\n            $initiative[] = $member;\n    }\n    foreach ($teamB->members as $member) {\n        if ($member->hitPoint > 0)\n            $initiative[] = $member;\n    }\n    // \u30e9\u30f3\u30c0\u30e0\u3067\uff57\n    shuffle($initiative);\n    // \u500b\u5225\u884c\u52d5\u30eb\u30fc\u30d7\n    foreach ($initiative as $offence) {\n        $diffence = null;\n        if ($offence->team === $teamA) {\n            if ($offence->hitPoint > 0 && teamPoint($teamB) > 0) {\n                shuffle($teamB->members);\n                foreach($teamB->members as $tmp) {\n                    if ($tmp->hitPoint <= 0) continue;\n                    $diffence = $tmp;\n                    break;\n                }\n            }\n        } else {\n            if ($offence->hitPoint > 0 && teamPoint($teamA) > 0) {\n                shuffle($teamA->members);\n                foreach($teamA->members as $tmp) {\n                    if ($tmp->hitPoint <= 0) continue;\n                    $diffence = $tmp;\n                    break;\n                }\n            }\n        }\n        if ($diffence != null)\n            Attack($offence, $diffence);\n    }\n    // 1\u30bf\u30fc\u30f3\u7d42\u4e86\n    echo \"<hr>\\n\";\n    echo $taro->name . \"HP:\" . $taro->hitPoint . \" / \" . $jiro->name . \"HP:\" . $jiro->hitPoint;\n    echo \"  |  \";\n    echo $hooliganA->name . \"HP:\" . $hooliganA->hitPoint . \" / \" . $hooliganB->name . \"HP:\" . $hooliganB->hitPoint . \" / \" . $hooliganC->name . \"HP:\" . $hooliganC->hitPoint;\n    echo \"<br>\\n<hr>\\n\";\n}\n?>\n</body>\n</html>\n\n\n**\u30ab\u30c4\u30a2\u30b2\u306f\u3044\u304b\u3093\u3088\uff01**\n\n\u5144\u5f1f\u30b2\u30f3\u30ab\u3057\u3066\u3044\u305f\u592a\u90ce\u3068\u6b21\u90ce\u304c\u4ef2\u76f4\u308a\u3057\u3066\u3001\u30b3\u30f3\u30d3\u30cb\u3078\u304a\u3084\u3064\u3092\u8cb7\u3044\u306b\u884c\u304f\u9014\u4e2d\u3001\n\u4e0d\u826f\u4e2d\u5b66\u751f\u30b0\u30eb\u30fc\u30d7\u306b\u51fa\u304f\u308f\u3057\u3066\u3001\u30ab\u30c4\u30a2\u30b2\u3055\u308c\u308b\u69d8\u5b50\u3092\u30b3\u30fc\u30c9\u5316\u3057\u307e\u3057\u305f\u3002\uff08\u8b0e\uff09\n\n```html+php:battle.php\n<?php\n/*\n * \u30b5\u30a4\u30b3\u30ed\n */\nfunction dice($param) {\n\t$_value = 0;\n\tif (preg_match('/^(\\d+)?[dD]\\d+([+]\\d+)?$/', $param, $_check) === 1) {\n\t\t$_param = $_check[0];\n\t\t$_result = preg_split('/[dD]/', $_param);\n\t\t$_shakes = ($_result[0] == '') ? 1 : $_result[0];\n\t\t$_param = $_result[1];\n\t\t$_result = preg_split('/[+]/', $_param);\n\t\t$_faces = $_result[0];\n\t\t$_baseValue = (!isset($_result[1]) || $_result[1] == '') ? 0 : $_result[1];\n\t\tfor ($_index = 0; $_index < $_shakes; $_index++)\n\t\t\t$_value += mt_rand(1, $_faces);\n\t\t$_value += $_baseValue;\n\t}\n\treturn $_value;\n}\n\n/*\n * \u30c0\u30e1\u30fc\u30b8\u8a08\u7b97\n */\nfunction calcDamages($weapon, $defPoint, &$message) {\n\t$damages = (int)(dice($weapon[\"ATK\"]) - $defPoint);\n\tif ($damages == 0) {\n\t\t$message = \"\u653b\u6483\u304c\u5f3e\u304d\u8fd4\u3055\u308c\u305f\uff01\";\n\t}\n\tif ($damages < 0) {\n\t\t$message = \"\u653b\u6483\u306f\u5c4a\u304b\u306a\u304b\u3063\u305f.\";\n\t\t$damages = 0;\n\t}\n\tif ($damages > 0) {\n\t\t$message = $damages.\"\u306e\u30c0\u30e1\u30fc\u30b8\u3092\u4e0e\u3048\u305f!\";\n\t}\n\treturn $damages;\n}\n\n/*\n * \u653b\u6483\u51e6\u7406\n */\nfunction Attack($a, $b) {\n\t$dmg = calcDamages($a->weapon, $b->defPoint, $msgs);\n\techo $a->name . \"\u304c\u8df3\u3073\u304b\u304b\u3063\u305f!<br>\\n\";\n\techo $b->name . \"\u306b\". $msgs . \"<br>\\n\";\n\t$b->hitPoint -= $dmg;\n\tif ($b->hitPoint < 0) {\n\t\t$b->hitPoint = 0;\n\t}\n}\n\n/*\n * \u30c1\u30fc\u30e0\u306e\u72b6\u614b\u3092\u8abf\u3079\u308b\n */\nfunction teamPoint($team) {\n\t$value = 0;\n\tforeach ($team->members as $member) {\n\t\t$value += $member->hitPoint;\n\t}\n\treturn $value;\n}\n\n/*\n * \u6b66\u5668\n */\n$weapon = array (\n\t\"name\" => \"\u91d1\u5c5e\u30d0\u30c3\u30c8\",\n\t\"ATK\" => \"3d6\",\n);\n\n$hand = array (\n\t\"name\" => \"\u7d20\u624b\",\n\t\"ATK\" => \"1d6\",\n);\n\n/*\n * \u592a\u90ce\u3068\u6b21\u90ce\n */\n\n$taro = new stdClass();\n$taro->name = \"\u592a\u90ce\";\n$taro->hitPoint = dice(\"3d6\");\n$taro->defPoint = dice(\"1d6\");\n$taro->weapon = $weapon;\n\n$jiro = new stdClass();\n$jiro->name = \"\u6b21\u90ce\";\n$jiro->hitPoint = dice(\"3d6\");\n$jiro->defPoint = dice(\"1d6\");\n$jiro->weapon = $weapon;\n\n/*\n * \u30c1\u30fc\u30e0\uff08\u30d1\u30fc\u30c6\u30a3\uff09\u306e\u7d50\u6210\n */\n$teamA = new stdClass();\n\n$teamA->members[] = $taro;\n$teamA->members[] = $jiro;\n\n$taro->team = $teamA;\n$jiro->team = $teamA;\n\n/*\n * \u4e0d\u826f\u305f\u3061\n */\n$hooliganA = new stdClass();\n$hooliganA->name = \"\u30ea\u30fc\u30bc\u30f3\u30c8\";\n$hooliganA->hitPoint = dice(\"4d6\");\n$hooliganA->defPoint = dice(\"1d6+4\");\n$hooliganA->weapon = $hand;\n\n$hooliganB = new stdClass();\n$hooliganB->name = \"\u89d2\u5208\u308a\";\n$hooliganB->hitPoint = dice(\"4d6\");\n$hooliganB->defPoint = dice(\"1d6+4\");\n$hooliganB->weapon = $hand;\n\n$hooliganC = new stdClass();\n$hooliganC->name = \"\u30b0\u30e9\u30b5\u30f3\";\n$hooliganC->hitPoint = dice(\"4d6\");\n$hooliganC->defPoint = dice(\"1d6+4\");\n$hooliganC->weapon = $hand;\n\n/*\n * \u30b4\u30ed\u30c4\u30ad\u306e\u7d50\u6210\n */\n$teamB->members[] = $hooliganA;\n$teamB->members[] = $hooliganB;\n$teamB->members[] = $hooliganC;\n\n$hooliganA->team = $teamB;\n$hooliganB->team = $teamB;\n$hooliganC->team = $teamB;\n\n?>\n\n<!DOCTYPE html>\n<html lang=\"ja\">\n<head>\n<meta charset=\"UTF-8\">\n<title>\u30e8\u30f3\u30d7\u30eb</title>\n</head>\n<body>\n<?php\necho $taro->name . \"HP:\" . $taro->hitPoint . \" / \" . $jiro->name . \"HP:\" . $jiro->hitPoint;\necho \"  |  \";\necho $hooliganA->name . \"HP:\" . $hooliganA->hitPoint . \" / \" . $hooliganB->name . \"HP:\" . $hooliganB->hitPoint . \" / \" . $hooliganC->name . \"HP:\" . $hooliganC->hitPoint;\necho \"<br>\\n<hr>\\n\";\n\nwhile (teamPoint($teamA) > 0 && teamPoint($teamB) > 0) {\n\t// \u653b\u6483\u9806\u5e8f\u3092\u6c7a\u3081\u308b\n\t$initiative = array();\n\tforeach ($teamA->members as $member) {\n\t\tif ($member->hitPoint > 0)\n\t\t\t$initiative[] = $member;\n\t}\n\tforeach ($teamB->members as $member) {\n\t\tif ($member->hitPoint > 0)\n\t\t\t$initiative[] = $member;\n\t}\n\t// \u30e9\u30f3\u30c0\u30e0\u3067\uff57\n\tshuffle($initiative);\n\t// \u500b\u5225\u884c\u52d5\u30eb\u30fc\u30d7\n\tforeach ($initiative as $offence) {\n\t\t$diffence = null;\n\t\tif ($offence->team === $teamA) {\n\t\t\tif ($offence->hitPoint > 0 && teamPoint($teamB) > 0) {\n\t\t\t\tshuffle($teamB->members);\n\t\t\t\tforeach($teamB->members as $tmp) {\n\t\t\t\t\tif ($tmp->hitPoint <= 0) continue;\n\t\t\t\t\t$diffence = $tmp;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tif ($offence->hitPoint > 0 && teamPoint($teamA) > 0) {\n\t\t\t\tshuffle($teamA->members);\n\t\t\t\tforeach($teamA->members as $tmp) {\n\t\t\t\t\tif ($tmp->hitPoint <= 0) continue;\n\t\t\t\t\t$diffence = $tmp;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif ($diffence != null)\n\t\t\tAttack($offence, $diffence);\n\t}\n\t// 1\u30bf\u30fc\u30f3\u7d42\u4e86\n\techo \"<hr>\\n\";\n\techo $taro->name . \"HP:\" . $taro->hitPoint . \" / \" . $jiro->name . \"HP:\" . $jiro->hitPoint;\n\techo \"  |  \";\n\techo $hooliganA->name . \"HP:\" . $hooliganA->hitPoint . \" / \" . $hooliganB->name . \"HP:\" . $hooliganB->hitPoint . \" / \" . $hooliganC->name . \"HP:\" . $hooliganC->hitPoint;\n\techo \"<br>\\n<hr>\\n\";\n}\n?>\n</body>\n</html>\n```\n", "tags": ["PHP", "battle", "game"]}