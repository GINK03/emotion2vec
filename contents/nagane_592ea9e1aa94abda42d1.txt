{"context": " More than 1 year has passed since last update.serf\u3092vagrant\u3067VM\u30922\u53f0\u7acb\u3061\u4e0a\u3052\u3066\u8a66\u3057\u305f\u6240\nprivate_network\u306b\u3088\u308a\u3092\u8907\u6570\u6307\u5b9a\u3057\u305f\u6642\u306b\u4f55\u6545\u304bjoin\u51fa\u6765\u305a\u30cf\u30de\u3063\u305f\n\nVM1...eth1 192.168.33.10\nVM2...eth1 192.168.33.11\n\n\n\u539f\u56e0\n\u4e21VM\u3068\u3082\u306b\u3001\u540c\u3058IP\u3067\u3042\u308beth0\u306b\u30d0\u30a4\u30f3\u30c9\u3057\u3066serf\u304c\u7acb\u3061\u4e0a\u304c\u3063\u3066\u3044\u305f\n[root@localhost vagrant]# ip -4 a\n1: lo: <LOOPBACK,UP,LOWER_UP> mtu 16436 qdisc noqueue state UNKNOWN\n    inet 127.0.0.1/8 scope host lo\n2: eth0: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc pfifo_fast state UP qlen 1000\n    inet 10.0.2.15/24 brd 10.0.2.255 scope global eth0\n3: eth1: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc pfifo_fast state UP qlen 1000\n    inet 192.168.33.11/24 brd 192.168.33.255 scope global eth1\n\n\u3053\u306eeth0\u306e\u30a2\u30c9\u30ec\u30b9\u306f\u8907\u6570\u53f0\u306enode\u304c\u5168\u3066\u540c\u305810.0.2.15\u306b\u306a\u3063\u3066\u3044\u308b\n\u305d\u3053\u3067\u7279\u306b\u4f55\u3082\u8003\u3048\u305a\u306bserf agent\u3092\u5b9f\u884c\u3059\u308b\u3068\u30fb\u30fb\u30fb\n==> Log data will now stream in as it occurs:\n\n    2014/07/03 10:06:44 [INFO] agent: Serf agent starting\n    2014/07/03 10:06:44 [INFO] serf: EventMemberJoin: localhost.localdomain 10.0.2.15\n    2014/07/03 10:06:45 [INFO] agent: Received event: member-join\n\n[root@localhost ~]# serf members\n    2014/07/03 10:06:49 [INFO] agent.ipc: Accepted client: 127.0.0.1:14419\nlocalhost.localdomain  10.0.2.15:7946  alive\n[root@localhost ~]#\n\n\njoin\u5931\u6557\n[root@vagrant-web01 vagrant]# ping 192.168.33.11\nPING 192.168.33.11 (192.168.33.11) 56(84) bytes of data.\n64 bytes from 192.168.33.11: icmp_seq=1 ttl=64 time=2.10 ms\n^C\n--- 192.168.33.11 ping statistics ---\n1 packets transmitted, 1 received, 0% packet loss, time 641ms\nrtt min/avg/max/mdev = 2.109/2.109/2.109/0.000 ms\n\n\n[root@vagrant-web01 vagrant]# serf join 192.168.33.11\n    2014/07/03 10:09:52 [INFO] agent.ipc: Accepted client: 127.0.0.1:36688\n    2014/07/03 10:09:52 [INFO] agent: joining: [192.168.33.11] replay: false\n    2014/07/03 10:09:52 [INFO] serf: EventMemberJoin: localhost.localdomain 10.0.2.15\n    2014/07/03 10:09:52 [INFO] agent: joined: 1 nodes\nSuccessfully joined cluster by contacting 1 nodes.\n[root@vagrant-web01 vagrant]#     2014/07/03 10:09:53 [WARN] memberlist: Got ping for unexpected node 'localhost.localdomain'\n    2014/07/03 10:09:53 [INFO] agent: Received event: member-join\n    2014/07/03 10:09:55 [WARN] memberlist: Got ping for unexpected node 'localhost.localdomain'\n    2014/07/03 10:09:57 [WARN] memberlist: Got ping for unexpected node 'localhost.localdomain'\n    2014/07/03 10:09:58 [WARN] memberlist: Got ping for unexpected node 'localhost.localdomain'\n    2014/07/03 10:09:59 [INFO] serf: EventMemberFailed: localhost.localdomain 10.0.2.15\n    2014/07/03 10:10:00 [INFO] agent: Received event: member-failed\n\n\u81ea\u52d5\u7684\u306beth0\u304c\u6307\u5b9a\u3055\u308c\n\u4ed6\u306eVM\u3082eth0\u304c10.0.2.15\u306b\u306a\u3063\u3066\u304a\u308a\n\u305d\u306eIP\u306bserf\u3055\u3093\u304c\u30d0\u30a4\u30f3\u30c9\u3057\u3066\u308b\u305f\u3081\u4e0a\u624b\u304fjoin\u51fa\u6765\u305a\u3002\n\u4e00\u5fdc\u901a\u4fe1\u306f\u51fa\u6765\u3066\u308b\u3063\u307d\u3044\u3093\u3060\u3051\u3069\u306a\neth0\u3068eth1\u3092\u53d6\u308a\u66ff\u3048\u3088\u3046\u3068\u3057\u305f\u308aeth0\u306b\u9055\u3046ip\u3092\u6301\u305f\u305b\u3088\u3046\u3068\u3057\u305f\u308a\neth1\u3067\u30eb\u30fc\u30c6\u30a3\u30f3\u30b0\u306e\u8a2d\u5b9a\u3057\u3088\u3046\u304b\u8003\u3048\u3066\u3044\u305f\u6240\u30fb\u30fb\u30fb\u30fb\n\n\u89e3\u6c7a\n\u516c\u5f0f\u30b5\u30a4\u30c8\u306b\u30aa\u30d7\u30b7\u30e7\u30f3\u4e00\u89a7\u304c\u3042\u3063\u305f\nserf help\u306a\u3093\u3066\u98fe\u308a\u3060\u3063\u305f\nserf agent -iface eth1 $\n\n\u4e21VM\u3068\u3082\u306b\u4e0a\u8a18\u30b3\u30de\u30f3\u30c9\u3067\u6307\u5b9a\u3057\u3066\u308b\u9055\u3046IP\u3092\u30d0\u30a4\u30f3\u30c9\u3057\u3066\u7acb\u3061\u4e0a\u304c\u308a\u3001\u7121\u4e8b\u306bjoin\n\nserf\u3092vagrant\u3067VM\u30922\u53f0\u7acb\u3061\u4e0a\u3052\u3066\u8a66\u3057\u305f\u6240\n`private_network`\u306b\u3088\u308a\u3092\u8907\u6570\u6307\u5b9a\u3057\u305f\u6642\u306b\u4f55\u6545\u304bjoin\u51fa\u6765\u305a\u30cf\u30de\u3063\u305f\n\n* VM1...eth1 192.168.33.10\n* VM2...eth1 192.168.33.11\n\n\n##\u539f\u56e0\n\n\u4e21VM\u3068\u3082\u306b\u3001\u540c\u3058IP\u3067\u3042\u308beth0\u306b\u30d0\u30a4\u30f3\u30c9\u3057\u3066serf\u304c\u7acb\u3061\u4e0a\u304c\u3063\u3066\u3044\u305f\n\n```\n[root@localhost vagrant]# ip -4 a\n1: lo: <LOOPBACK,UP,LOWER_UP> mtu 16436 qdisc noqueue state UNKNOWN\n    inet 127.0.0.1/8 scope host lo\n2: eth0: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc pfifo_fast state UP qlen 1000\n    inet 10.0.2.15/24 brd 10.0.2.255 scope global eth0\n3: eth1: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc pfifo_fast state UP qlen 1000\n    inet 192.168.33.11/24 brd 192.168.33.255 scope global eth1\n```\n\n\u3053\u306eeth0\u306e\u30a2\u30c9\u30ec\u30b9\u306f\u8907\u6570\u53f0\u306enode\u304c\u5168\u3066\u540c\u3058`10.0.2.15`\u306b\u306a\u3063\u3066\u3044\u308b\n\n\u305d\u3053\u3067\u7279\u306b\u4f55\u3082\u8003\u3048\u305a\u306b`serf agent`\u3092\u5b9f\u884c\u3059\u308b\u3068\u30fb\u30fb\u30fb\n\n```\n==> Log data will now stream in as it occurs:\n\n    2014/07/03 10:06:44 [INFO] agent: Serf agent starting\n    2014/07/03 10:06:44 [INFO] serf: EventMemberJoin: localhost.localdomain 10.0.2.15\n    2014/07/03 10:06:45 [INFO] agent: Received event: member-join\n\n[root@localhost ~]# serf members\n    2014/07/03 10:06:49 [INFO] agent.ipc: Accepted client: 127.0.0.1:14419\nlocalhost.localdomain  10.0.2.15:7946  alive\n[root@localhost ~]#\n```\n\n##join\u5931\u6557\n\n```\n[root@vagrant-web01 vagrant]# ping 192.168.33.11\nPING 192.168.33.11 (192.168.33.11) 56(84) bytes of data.\n64 bytes from 192.168.33.11: icmp_seq=1 ttl=64 time=2.10 ms\n^C\n--- 192.168.33.11 ping statistics ---\n1 packets transmitted, 1 received, 0% packet loss, time 641ms\nrtt min/avg/max/mdev = 2.109/2.109/2.109/0.000 ms\n\n\n[root@vagrant-web01 vagrant]# serf join 192.168.33.11\n    2014/07/03 10:09:52 [INFO] agent.ipc: Accepted client: 127.0.0.1:36688\n    2014/07/03 10:09:52 [INFO] agent: joining: [192.168.33.11] replay: false\n    2014/07/03 10:09:52 [INFO] serf: EventMemberJoin: localhost.localdomain 10.0.2.15\n    2014/07/03 10:09:52 [INFO] agent: joined: 1 nodes\nSuccessfully joined cluster by contacting 1 nodes.\n[root@vagrant-web01 vagrant]#     2014/07/03 10:09:53 [WARN] memberlist: Got ping for unexpected node 'localhost.localdomain'\n    2014/07/03 10:09:53 [INFO] agent: Received event: member-join\n    2014/07/03 10:09:55 [WARN] memberlist: Got ping for unexpected node 'localhost.localdomain'\n    2014/07/03 10:09:57 [WARN] memberlist: Got ping for unexpected node 'localhost.localdomain'\n    2014/07/03 10:09:58 [WARN] memberlist: Got ping for unexpected node 'localhost.localdomain'\n    2014/07/03 10:09:59 [INFO] serf: EventMemberFailed: localhost.localdomain 10.0.2.15\n    2014/07/03 10:10:00 [INFO] agent: Received event: member-failed\n```\n\n\u81ea\u52d5\u7684\u306beth0\u304c\u6307\u5b9a\u3055\u308c\n\u4ed6\u306eVM\u3082eth0\u304c10.0.2.15\u306b\u306a\u3063\u3066\u304a\u308a\n\u305d\u306eIP\u306bserf\u3055\u3093\u304c\u30d0\u30a4\u30f3\u30c9\u3057\u3066\u308b\u305f\u3081\u4e0a\u624b\u304fjoin\u51fa\u6765\u305a\u3002\n\u4e00\u5fdc\u901a\u4fe1\u306f\u51fa\u6765\u3066\u308b\u3063\u307d\u3044\u3093\u3060\u3051\u3069\u306a\n\neth0\u3068eth1\u3092\u53d6\u308a\u66ff\u3048\u3088\u3046\u3068\u3057\u305f\u308aeth0\u306b\u9055\u3046ip\u3092\u6301\u305f\u305b\u3088\u3046\u3068\u3057\u305f\u308a\neth1\u3067\u30eb\u30fc\u30c6\u30a3\u30f3\u30b0\u306e\u8a2d\u5b9a\u3057\u3088\u3046\u304b\u8003\u3048\u3066\u3044\u305f\u6240\u30fb\u30fb\u30fb\u30fb\n\n##\u89e3\u6c7a\n\n[\u516c\u5f0f\u30b5\u30a4\u30c8](http://www.serfdom.io/docs/agent/options.html)\u306b\u30aa\u30d7\u30b7\u30e7\u30f3\u4e00\u89a7\u304c\u3042\u3063\u305f\n`serf help`\u306a\u3093\u3066\u98fe\u308a\u3060\u3063\u305f\n\n```\nserf agent -iface eth1 $\n```\n\n\u4e21VM\u3068\u3082\u306b\u4e0a\u8a18\u30b3\u30de\u30f3\u30c9\u3067\u6307\u5b9a\u3057\u3066\u308b\u9055\u3046IP\u3092\u30d0\u30a4\u30f3\u30c9\u3057\u3066\u7acb\u3061\u4e0a\u304c\u308a\u3001\u7121\u4e8b\u306bjoin\n", "tags": ["vagrant", "serf"]}