{"context": " More than 1 year has passed since last update.\n\n\u76ee\u7684\nCakephp3\u3092\u52d5\u304b\u305d\u3046\u3068\u601d\u3063\u305f\u304cMacOS\u306bapache\u3092\u4e0a\u3052\u308b\u306e\u3082\u5104\u52ab\u306a\u306e\u3067\u3001virtualbox\u306e\u30a4\u30e1\u30fc\u30b8\u3092\u4f5c\u6210\u3059\u308b\u3053\u3068\u306b\u3059\u308b\u3002\n\u3064\u3044\u3067\u306bCentOS7\u3082\u4f7f\u3063\u3066\u307f\u305f\u3044\u306e\u3067\u3001OS\u306e\u30d9\u30fc\u30b9\u306fCentOS7\u306b\u3059\u308b\u3002\n\nPacker\u306e\u6e96\u5099\n\u6e96\u5099\u6e08\u307f\u3002\u304a\u305d\u3089\u304f\u4ee5\u524d\u306bhomebrew\u3067\u5165\u308c\u305f\u306f\u305a\u3002\n\nbuild.json\u306e\u6e96\u5099\nhttps://github.com/tsunokawa\n\u3053\u3053\u304b\u3089\u3042\u308a\u304c\u305f\u304f\u62dd\u501f\u30fb\u30fb\u30fb\u3068\u601d\u3063\u305f\u304c\u4f7f\u3063\u3066\u3044\u305fISO\u304cDVD\u7528\u3067\uff14GB\u3082\u3042\u3063\u305f\u306e\u3067\u3001minimal iso\u30a4\u30e1\u30fc\u30b8\u306b\u3057\u305f\u3002\nhttp://ftp.iij.ad.jp/pub/linux/centos/7.1.1503/isos/x86_64/md5sum.txt\n\u6700\u7d42\u7684\u306b\u306f\u3053\u3093\u306a\u611f\u3058\u306b\u306a\u3063\u305f\u3002\n\ntemplete.json\n\n\uff13\uff10\u79d2\u306ewait\u306f\u9577\u3059\u304e\u306a\u306e\u3067\uff11\uff10\u79d2\u306b\u3057\u305f\u3002\nCentOS7\u306e\u65b0\u3057\u3044\u30d0\u30fc\u30b8\u30e7\u30f3\u306b\u3057\u3066\u304a\u3044\u305f\u3002\n\n{\n  \"builders\":[{\n    \"type\": \"virtualbox-iso\",\n      \"guest_os_type\": \"RedHat_64\",\n      \"disk_size\": 40520,\n      \"iso_url\": \"http://ftp.iij.ad.jp/pub/linux/centos/7.1.1503/isos/x86_64/CentOS-7-x86_64-Minimal-1503-01.iso\",\n      \"iso_checksum\": \"d07ab3e615c66a8b2e9a50f4852e6a77\",\n      \"iso_checksum_type\": \"md5\",\n      \"ssh_username\": \"vagrant\",\n      \"ssh_password\": \"vagrant\",\n      \"ssh_port\": 22,\n      \"ssh_wait_timeout\": \"3000s\",\n      \"vm_name\": \"CentOS-7.0-1406\",\n      \"virtualbox_version_file\": \".vbox_version\",\n      \"http_directory\": \"./\",\n      \"boot_wait\": \"10s\",\n      \"boot_command\":[\n        \"<esc><wait>\",\n      \"linux ks=http://{{ .HTTPIP }}:{{ .HTTPPort }}/ks.cfg \",\n      \"<enter><wait>\"\n        ],\n      \"shutdown_command\": \"sudo /sbin/poweroff\"\n  }],\n    \"provisioners\":[{\n      \"type\": \"shell\",\n      \"scripts\": [\n        \"base.sh\"\n\n       ]\n    }],\n    \"post-processors\": [\n    {\n      \"type\": \"vagrant\",\n      \"output\": \"./entOS-7-x86_64-Minimal-1503-01.box\"\n    }\n  ]\n}\n\n\nbase.sh\nVBoxGuestAdditions\u3092HTTP\u3067\u53d6\u5f97\u3059\u308b\u3088\u3046\u306b\u3057\u305f\u3002\n#!/usr/bin/env bash\n/usr/sbin/setenforce 0\nsudo sed -i \"s/^.*requiretty/#Defaults requiretty/\" /etc/sudoers\nsudo sed -i \"s/#UseDNS yes/UseDNS no/\" /etc/ssh/sshd_config\n\ncat <<\"EOM\" | sudo tee /etc/yum.repos.d/epel.repo\n[epel]\nname=Extra Packages for Enterprise Linux 7 - $basearch\n#baseurl=http://download.fedoraproject.org/pub/epel/7/$basearch\nmirrorlist=https://mirrors.fedoraproject.org/metalink?repo=epel-7&arch=$basearch\nfailovermethod=priority\nenabled=0\ngpgcheck=0\ngpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-EPEL-7\nEOM\n\nsudo yum -y install gcc make automake autoconf libtool gcc-c++ kernel-headers-`uname -r` kernel-devel-`uname -r` zlib-devel openssl-devel readline-devel sqlite-devel perl wget nfs-utils bind-utils bzip2 git\nsudo yum -y --enablerepo=epel install dkms\n\n# Vagrant\u7528\u306e\u516c\u958b\u9375\u3092\u767b\u9332\nmkdir -pm 700 /home/vagrant/.ssh\nwget --no-check-certificate 'https://raw.githubusercontent.com/mitchellh/vagrant/master/keys/vagrant.pub' -O /home/vagrant/.ssh/authorized_keys\nchmod 0600 /home/vagrant/.ssh/authorized_keys\nchown -R vagrant /home/vagrant/.ssh\n\n# Installing the virtualbox guest additions\nVBOX_VERSION=$(cat /home/vagrant/.vbox_version)\ncd /tmp\ncurl -O http://download.virtualbox.org/virtualbox/$VBOX_VERSION/VBoxGuestAdditions_$VBOX_VERSION.iso\nsudo mount -o loop /tmp/VBoxGuestAdditions_$VBOX_VERSION.iso /mnt\nsudo sh /mnt/VBoxLinuxAdditions.run\nsudo umount /mnt\nsudo rm -rf /tmp/VBoxGuestAdditions_*.iso\n\nsudo /etc/rc.d/init.d/vboxadd setup\n[root@localhost packer]# cat base.sh\n#!/usr/bin/env bash\n/usr/sbin/setenforce 0\nsudo sed -i \"s/^.*requiretty/#Defaults requiretty/\" /etc/sudoers\nsudo sed -i \"s/#UseDNS yes/UseDNS no/\" /etc/ssh/sshd_config\n\ncat <<\"EOM\" | sudo tee /etc/yum.repos.d/epel.repo\n[epel]\nname=Extra Packages for Enterprise Linux 7 - $basearch\n#baseurl=http://download.fedoraproject.org/pub/epel/7/$basearch\nmirrorlist=https://mirrors.fedoraproject.org/metalink?repo=epel-7&arch=$basearch\nfailovermethod=priority\nenabled=0\ngpgcheck=0\ngpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-EPEL-7\nEOM\n\nsudo yum -y install gcc make automake autoconf libtool gcc-c++ kernel-headers-`uname -r` kernel-devel-`uname -r` zlib-devel openssl-devel readline-devel sqlite-devel perl wget nfs-utils bind-utils bzip2 git\nsudo yum -y --enablerepo=epel install dkms\n\n# Vagrant\u7528\u306e\u516c\u958b\u9375\u3092\u767b\u9332\nmkdir -pm 700 /home/vagrant/.ssh\nwget --no-check-certificate 'https://raw.githubusercontent.com/mitchellh/vagrant/master/keys/vagrant.pub' -O /home/vagrant/.ssh/authorized_keys\nchmod 0600 /home/vagrant/.ssh/authorized_keys\nchown -R vagrant /home/vagrant/.ssh\n\n# Installing the virtualbox guest additions\nVBOX_VERSION=$(cat /home/vagrant/.vbox_version)\ncd /tmp\ncurl -O http://download.virtualbox.org/virtualbox/$VBOX_VERSION/VBoxGuestAdditions_$VBOX_VERSION.iso\nsudo mount -o loop /tmp/VBoxGuestAdditions_$VBOX_VERSION.iso /mnt\nsudo sh /mnt/VBoxLinuxAdditions.run\nsudo umount /mnt\nsudo rm -rf /tmp/VBoxGuestAdditions_*.iso\n\nsudo /etc/rc.d/init.d/vboxadd setup\n\n\nks.cfg\n\u3042\u3063\u3055\u308a\u52d5\u3044\u305f\ninstall\ncdrom\nlang en_US.UTF-8\nnetwork --bootproto=dhcp\nrootpw --iscrypted $6$bxkBFred0jV4fII.$jKW.7MSXYKGiaNTk8nIrj567ERgCCEr8DO2Vfwgw3ncQQREqBTJVrwtkiUn4Y3dNfDkS4Bek39Rsqd/vOYLLK/\nfirewall --enabled --service=ssh\nauthconfig --enableshadow --passalgo=sha512\nselinux --disabled\ntimezone Asia/Tokyo\nbootloader --location=mbr\n\ntext\nskipx\nzerombr\n\nclearpart --all --initlabel\nautopart\n\nauth  --useshadow  --enablemd5\nfirstboot --disabled\nreboot\n\n%packages --nobase\n@core\n%end\n\n%post\n/usr/bin/yum -y install sudo\n/usr/bin/yum -y upgrade\n/usr/sbin/groupadd vagrant\n/usr/sbin/useradd vagrant -g vagrant -G wheel\necho \"vagrant\"|passwd --stdin vagrant\necho \"vagrant        ALL=(ALL)       NOPASSWD: ALL\" >> /etc/sudoers.d/vagrant\nchmod 0440 /etc/sudoers.d/vagrant\n%end\n\n\n\u30d5\u30a1\u30a4\u30eb\u69cb\u6210\n\u3053\u3093\u306a\u611f\u3058\u306b\u914d\u7f6e\u3057\u307e\u3059\n[root@localhost vagrant]# tree packer\npacker\n\u251c\u2500\u2500 base.sh\n\u251c\u2500\u2500 ks.cfg\n\u2514\u2500\u2500 template.json\n\n\n\u5b9f\u884c\n\u5b9f\u884c\u3057\u3066\u3057\u3070\u3089\u304f\u3059\u308b\u3068\u7d42\u308f\u308b\u306e\u3067\u4fe1\u3058\u3066\u5f85\u3064\u3002\n$ packer build templete.json\n\n\n\u78ba\u8a8d\n\u6b63\u5e38\u306b\u7d42\u4e86\u3059\u308b\u3068box\u30d5\u30a1\u30a4\u30eb\u304c\u3067\u304d\u3066\u3044\u308b\u3002\n[root@localhost vagrant]# tree packer\npacker\n\u251c\u2500\u2500 CentOS-7-x86_64-Minimal-1503-01.box\n\u251c\u2500\u2500 base.sh\n\u251c\u2500\u2500 ks.cfg\n\u251c\u2500\u2500 packer_cache\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 a22c97c388b0537730ed72ebe33fa27f20c4662b72241538a935a8b40292ec4b.iso\n\u2514\u2500\u2500 template.json\n\n\nVagrant\u5b9f\u884c\nBox\u30d5\u30a1\u30a4\u30eb\u304c\u3067\u304d\u305f\u306e\u3067\u3001Vagrant\u3067\u7acb\u3061\u4e0a\u3052\u3066\u307f\u308b\n\nVagrantfile\u6e96\u5099\n\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306e\u30c8\u30c3\u30d7\u306b\u914d\u7f6e\u3057\u305f\u3002\u5148\u307b\u3069\u6e96\u5099\u3057\u305fpacker\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306e\u4e0a\u3067\u3042\u308b\u3002\n\u3053\u3093\u306a\u611f\u3058\u3002\n[root@localhost vagrant]# tree -d\n.\n\u251c\u2500\u2500 ansible\n\u2514\u2500\u2500 packer\n\n\u6e96\u5099\u3057\u305fVagrantfile\n# -*- mode: ruby -*-\n# vi: set ft=ruby :\n\n# All Vagrant configuration is done below. The \"2\" in Vagrant.configure\n# configures the configuration version (we support older styles for\n# backwards compatibility). Please don't change it unless you know what\n# you're doing.\nVagrant.configure(2) do |config|\n  # The most common configuration options are documented and commented below.\n  # For a complete reference, please see the online documentation at\n  # https://docs.vagrantup.com.\n\n  # Every Vagrant development environment requires a box. You can search for\n  # boxes at https://atlas.hashicorp.com/search.\n\n  config.vm.box_url = \"file://./packer/CentOS-7-x86_64-Minimal-1503-01.box\"\n  config.vm.box = \"CentOS-7-x86_64-Minimal-1503-01\"\n  # Disable automatic box update checking. If you disable this, then\n  # boxes will only be checked for updates when the user runs\n  # `vagrant box outdated`. This is not recommended.\n  config.vm.box_check_update = true\n\n  # Create a forwarded port mapping which allows access to a specific port\n  # within the machine from a port on the host machine. In the example below,\n  # accessing \"localhost:8080\" will access port 80 on the guest machine.\n  # config.vm.network \"forwarded_port\", guest: 80, host: 8080\n\n  # Create a private network, which allows host-only access to the machine\n  # using a specific IP.\n  config.vm.network \"private_network\", ip: \"192.168.100.10\"\n\n  # Create a public network, which generally matched to bridged network.\n  # Bridged networks make the machine appear as another physical device on\n  # your network.\n  # config.vm.network \"public_network\"\n\n  # Share an additional folder to the guest VM. The first argument is\n  # the path on the host to the actual folder. The second argument is\n  # the path on the guest to mount the folder. And the optional third\n  # argument is a set of non-required options.\n  config.vm.synced_folder \"./\", \"/vagrant\" , mount_options: ['dmode=777','fmode=666']\n\n  # Provider-specific configuration so you can fine-tune various\n  # backing providers for Vagrant. These expose provider-specific options.\n  # Example for VirtualBox:\n  #\n  config.vm.provider \"virtualbox\" do |vb|\n  #   # Display the VirtualBox GUI when booting the machine\n     vb.gui = false\n  #\n  #   # Customize the amount of memory on the VM:\n     vb.memory = \"1024\"\n  end\n  #\n  # View the documentation for the provider you are using for more\n  # information on available options.\n\n  # Define a Vagrant Push strategy for pushing to Atlas. Other push strategies\n  # such as FTP and Heroku are also available. See the documentation at\n  # https://docs.vagrantup.com/v2/push/atlas.html for more information.\n  # config.push.define \"atlas\" do |push|\n  #   push.app = \"YOUR_ATLAS_USERNAME/YOUR_APPLICATION_NAME\"\n  # end\n\n  # Enable provisioning with a shell script. Additional provisioners such as\n  # Puppet, Chef, Ansible, Salt, and Docker are also available. Please see the\n  # documentation for more information about their specific syntax and use.\n  # config.vm.provision \"shell\", inline: <<-SHELL\n  #   sudo apt-get update\n  #   sudo apt-get install -y apache2\n  # SHELL\nend\n\n\n\u8d77\u52d5\nvagrant up\n\n\u3068\u3059\u308b\u3068\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u304c\u7acb\u3061\u4e0a\u304c\u308a\u307e\u3059\u3002\n\n\u30ed\u30b0\u30a4\u30f3\u51fa\u6765\u308b\u304b\u78ba\u8a8d\nvagrant ssh\n\n\u3068\u3059\u308b\u3068\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306b\u30ed\u30b0\u30a4\u30f3\u3067\u304d\u307e\u3059\u3002\n\n\u5bbf\u984c\nChef\u306f\u597d\u307f\u3058\u3083\u306a\u3044\u306e\u3067Ansible\u3067\u7d30\u304b\u3044\u8a2d\u5b9a\u3092\u884c\u3046\u3002\n# \u76ee\u7684\n\nCakephp3\u3092\u52d5\u304b\u305d\u3046\u3068\u601d\u3063\u305f\u304cMacOS\u306bapache\u3092\u4e0a\u3052\u308b\u306e\u3082\u5104\u52ab\u306a\u306e\u3067\u3001virtualbox\u306e\u30a4\u30e1\u30fc\u30b8\u3092\u4f5c\u6210\u3059\u308b\u3053\u3068\u306b\u3059\u308b\u3002\n\u3064\u3044\u3067\u306bCentOS7\u3082\u4f7f\u3063\u3066\u307f\u305f\u3044\u306e\u3067\u3001OS\u306e\u30d9\u30fc\u30b9\u306fCentOS7\u306b\u3059\u308b\u3002\n\n# Packer\u306e\u6e96\u5099\n\n\u6e96\u5099\u6e08\u307f\u3002\u304a\u305d\u3089\u304f\u4ee5\u524d\u306bhomebrew\u3067\u5165\u308c\u305f\u306f\u305a\u3002\n\n# build.json\u306e\u6e96\u5099\n\nhttps://github.com/tsunokawa\n\n\u3053\u3053\u304b\u3089\u3042\u308a\u304c\u305f\u304f\u62dd\u501f\u30fb\u30fb\u30fb\u3068\u601d\u3063\u305f\u304c\u4f7f\u3063\u3066\u3044\u305fISO\u304cDVD\u7528\u3067\uff14GB\u3082\u3042\u3063\u305f\u306e\u3067\u3001minimal iso\u30a4\u30e1\u30fc\u30b8\u306b\u3057\u305f\u3002\n\nhttp://ftp.iij.ad.jp/pub/linux/centos/7.1.1503/isos/x86_64/md5sum.txt\n\n\u6700\u7d42\u7684\u306b\u306f\u3053\u3093\u306a\u611f\u3058\u306b\u306a\u3063\u305f\u3002\n\n## templete.json\n\n* \uff13\uff10\u79d2\u306ewait\u306f\u9577\u3059\u304e\u306a\u306e\u3067\uff11\uff10\u79d2\u306b\u3057\u305f\u3002\n* CentOS7\u306e\u65b0\u3057\u3044\u30d0\u30fc\u30b8\u30e7\u30f3\u306b\u3057\u3066\u304a\u3044\u305f\u3002\n\n```json\n{\n  \"builders\":[{\n    \"type\": \"virtualbox-iso\",\n      \"guest_os_type\": \"RedHat_64\",\n      \"disk_size\": 40520,\n      \"iso_url\": \"http://ftp.iij.ad.jp/pub/linux/centos/7.1.1503/isos/x86_64/CentOS-7-x86_64-Minimal-1503-01.iso\",\n      \"iso_checksum\": \"d07ab3e615c66a8b2e9a50f4852e6a77\",\n      \"iso_checksum_type\": \"md5\",\n      \"ssh_username\": \"vagrant\",\n      \"ssh_password\": \"vagrant\",\n      \"ssh_port\": 22,\n      \"ssh_wait_timeout\": \"3000s\",\n      \"vm_name\": \"CentOS-7.0-1406\",\n      \"virtualbox_version_file\": \".vbox_version\",\n      \"http_directory\": \"./\",\n      \"boot_wait\": \"10s\",\n      \"boot_command\":[\n        \"<esc><wait>\",\n      \"linux ks=http://{{ .HTTPIP }}:{{ .HTTPPort }}/ks.cfg \",\n      \"<enter><wait>\"\n        ],\n      \"shutdown_command\": \"sudo /sbin/poweroff\"\n  }],\n    \"provisioners\":[{\n      \"type\": \"shell\",\n      \"scripts\": [\n        \"base.sh\"\n \n       ]\n    }],\n    \"post-processors\": [\n    {\n      \"type\": \"vagrant\",\n      \"output\": \"./entOS-7-x86_64-Minimal-1503-01.box\"\n    }\n  ]\n}\n```\n\n## base.sh\n\nVBoxGuestAdditions\u3092HTTP\u3067\u53d6\u5f97\u3059\u308b\u3088\u3046\u306b\u3057\u305f\u3002\n\n```bash\n#!/usr/bin/env bash\n/usr/sbin/setenforce 0\nsudo sed -i \"s/^.*requiretty/#Defaults requiretty/\" /etc/sudoers\nsudo sed -i \"s/#UseDNS yes/UseDNS no/\" /etc/ssh/sshd_config\n\ncat <<\"EOM\" | sudo tee /etc/yum.repos.d/epel.repo\n[epel]\nname=Extra Packages for Enterprise Linux 7 - $basearch\n#baseurl=http://download.fedoraproject.org/pub/epel/7/$basearch\nmirrorlist=https://mirrors.fedoraproject.org/metalink?repo=epel-7&arch=$basearch\nfailovermethod=priority\nenabled=0\ngpgcheck=0\ngpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-EPEL-7\nEOM\n\nsudo yum -y install gcc make automake autoconf libtool gcc-c++ kernel-headers-`uname -r` kernel-devel-`uname -r` zlib-devel openssl-devel readline-devel sqlite-devel perl wget nfs-utils bind-utils bzip2 git\nsudo yum -y --enablerepo=epel install dkms\n\n# Vagrant\u7528\u306e\u516c\u958b\u9375\u3092\u767b\u9332\nmkdir -pm 700 /home/vagrant/.ssh\nwget --no-check-certificate 'https://raw.githubusercontent.com/mitchellh/vagrant/master/keys/vagrant.pub' -O /home/vagrant/.ssh/authorized_keys\nchmod 0600 /home/vagrant/.ssh/authorized_keys\nchown -R vagrant /home/vagrant/.ssh\n\n# Installing the virtualbox guest additions\nVBOX_VERSION=$(cat /home/vagrant/.vbox_version)\ncd /tmp\ncurl -O http://download.virtualbox.org/virtualbox/$VBOX_VERSION/VBoxGuestAdditions_$VBOX_VERSION.iso\nsudo mount -o loop /tmp/VBoxGuestAdditions_$VBOX_VERSION.iso /mnt\nsudo sh /mnt/VBoxLinuxAdditions.run\nsudo umount /mnt\nsudo rm -rf /tmp/VBoxGuestAdditions_*.iso\n\nsudo /etc/rc.d/init.d/vboxadd setup\n[root@localhost packer]# cat base.sh\n#!/usr/bin/env bash\n/usr/sbin/setenforce 0\nsudo sed -i \"s/^.*requiretty/#Defaults requiretty/\" /etc/sudoers\nsudo sed -i \"s/#UseDNS yes/UseDNS no/\" /etc/ssh/sshd_config\n\ncat <<\"EOM\" | sudo tee /etc/yum.repos.d/epel.repo\n[epel]\nname=Extra Packages for Enterprise Linux 7 - $basearch\n#baseurl=http://download.fedoraproject.org/pub/epel/7/$basearch\nmirrorlist=https://mirrors.fedoraproject.org/metalink?repo=epel-7&arch=$basearch\nfailovermethod=priority\nenabled=0\ngpgcheck=0\ngpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-EPEL-7\nEOM\n\nsudo yum -y install gcc make automake autoconf libtool gcc-c++ kernel-headers-`uname -r` kernel-devel-`uname -r` zlib-devel openssl-devel readline-devel sqlite-devel perl wget nfs-utils bind-utils bzip2 git\nsudo yum -y --enablerepo=epel install dkms\n\n# Vagrant\u7528\u306e\u516c\u958b\u9375\u3092\u767b\u9332\nmkdir -pm 700 /home/vagrant/.ssh\nwget --no-check-certificate 'https://raw.githubusercontent.com/mitchellh/vagrant/master/keys/vagrant.pub' -O /home/vagrant/.ssh/authorized_keys\nchmod 0600 /home/vagrant/.ssh/authorized_keys\nchown -R vagrant /home/vagrant/.ssh\n\n# Installing the virtualbox guest additions\nVBOX_VERSION=$(cat /home/vagrant/.vbox_version)\ncd /tmp\ncurl -O http://download.virtualbox.org/virtualbox/$VBOX_VERSION/VBoxGuestAdditions_$VBOX_VERSION.iso\nsudo mount -o loop /tmp/VBoxGuestAdditions_$VBOX_VERSION.iso /mnt\nsudo sh /mnt/VBoxLinuxAdditions.run\nsudo umount /mnt\nsudo rm -rf /tmp/VBoxGuestAdditions_*.iso\n\nsudo /etc/rc.d/init.d/vboxadd setup\n```\n\n## ks.cfg\n\n\u3042\u3063\u3055\u308a\u52d5\u3044\u305f\n\n```\ninstall\ncdrom\nlang en_US.UTF-8\nnetwork --bootproto=dhcp\nrootpw --iscrypted $6$bxkBFred0jV4fII.$jKW.7MSXYKGiaNTk8nIrj567ERgCCEr8DO2Vfwgw3ncQQREqBTJVrwtkiUn4Y3dNfDkS4Bek39Rsqd/vOYLLK/\nfirewall --enabled --service=ssh\nauthconfig --enableshadow --passalgo=sha512\nselinux --disabled\ntimezone Asia/Tokyo\nbootloader --location=mbr\n\ntext\nskipx\nzerombr\n\nclearpart --all --initlabel\nautopart\n\nauth  --useshadow  --enablemd5\nfirstboot --disabled\nreboot\n\n%packages --nobase\n@core\n%end\n\n%post\n/usr/bin/yum -y install sudo\n/usr/bin/yum -y upgrade\n/usr/sbin/groupadd vagrant\n/usr/sbin/useradd vagrant -g vagrant -G wheel\necho \"vagrant\"|passwd --stdin vagrant\necho \"vagrant        ALL=(ALL)       NOPASSWD: ALL\" >> /etc/sudoers.d/vagrant\nchmod 0440 /etc/sudoers.d/vagrant\n%end\n```\n\n# \u30d5\u30a1\u30a4\u30eb\u69cb\u6210\n\n\u3053\u3093\u306a\u611f\u3058\u306b\u914d\u7f6e\u3057\u307e\u3059\n\n```\n[root@localhost vagrant]# tree packer\npacker\n\u251c\u2500\u2500 base.sh\n\u251c\u2500\u2500 ks.cfg\n\u2514\u2500\u2500 template.json\n```\n\n# \u5b9f\u884c\n\n\u5b9f\u884c\u3057\u3066\u3057\u3070\u3089\u304f\u3059\u308b\u3068\u7d42\u308f\u308b\u306e\u3067\u4fe1\u3058\u3066\u5f85\u3064\u3002\n\n```\n$ packer build templete.json\n```\n\n# \u78ba\u8a8d\n\n\u6b63\u5e38\u306b\u7d42\u4e86\u3059\u308b\u3068box\u30d5\u30a1\u30a4\u30eb\u304c\u3067\u304d\u3066\u3044\u308b\u3002\n\n```\n[root@localhost vagrant]# tree packer\npacker\n\u251c\u2500\u2500 CentOS-7-x86_64-Minimal-1503-01.box\n\u251c\u2500\u2500 base.sh\n\u251c\u2500\u2500 ks.cfg\n\u251c\u2500\u2500 packer_cache\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 a22c97c388b0537730ed72ebe33fa27f20c4662b72241538a935a8b40292ec4b.iso\n\u2514\u2500\u2500 template.json\n```\n# Vagrant\u5b9f\u884c\n\nBox\u30d5\u30a1\u30a4\u30eb\u304c\u3067\u304d\u305f\u306e\u3067\u3001Vagrant\u3067\u7acb\u3061\u4e0a\u3052\u3066\u307f\u308b\n\n## Vagrantfile\u6e96\u5099\n\n\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306e\u30c8\u30c3\u30d7\u306b\u914d\u7f6e\u3057\u305f\u3002\u5148\u307b\u3069\u6e96\u5099\u3057\u305fpacker\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306e\u4e0a\u3067\u3042\u308b\u3002\n\n\u3053\u3093\u306a\u611f\u3058\u3002\n\n```\n[root@localhost vagrant]# tree -d\n.\n\u251c\u2500\u2500 ansible\n\u2514\u2500\u2500 packer\n```\n\n\u6e96\u5099\u3057\u305fVagrantfile\n\n```rb\n# -*- mode: ruby -*-\n# vi: set ft=ruby :\n\n# All Vagrant configuration is done below. The \"2\" in Vagrant.configure\n# configures the configuration version (we support older styles for\n# backwards compatibility). Please don't change it unless you know what\n# you're doing.\nVagrant.configure(2) do |config|\n  # The most common configuration options are documented and commented below.\n  # For a complete reference, please see the online documentation at\n  # https://docs.vagrantup.com.\n\n  # Every Vagrant development environment requires a box. You can search for\n  # boxes at https://atlas.hashicorp.com/search.\n\n  config.vm.box_url = \"file://./packer/CentOS-7-x86_64-Minimal-1503-01.box\"\n  config.vm.box = \"CentOS-7-x86_64-Minimal-1503-01\"\n  # Disable automatic box update checking. If you disable this, then\n  # boxes will only be checked for updates when the user runs\n  # `vagrant box outdated`. This is not recommended.\n  config.vm.box_check_update = true\n\n  # Create a forwarded port mapping which allows access to a specific port\n  # within the machine from a port on the host machine. In the example below,\n  # accessing \"localhost:8080\" will access port 80 on the guest machine.\n  # config.vm.network \"forwarded_port\", guest: 80, host: 8080\n\n  # Create a private network, which allows host-only access to the machine\n  # using a specific IP.\n  config.vm.network \"private_network\", ip: \"192.168.100.10\"\n\n  # Create a public network, which generally matched to bridged network.\n  # Bridged networks make the machine appear as another physical device on\n  # your network.\n  # config.vm.network \"public_network\"\n\n  # Share an additional folder to the guest VM. The first argument is\n  # the path on the host to the actual folder. The second argument is\n  # the path on the guest to mount the folder. And the optional third\n  # argument is a set of non-required options.\n  config.vm.synced_folder \"./\", \"/vagrant\" , mount_options: ['dmode=777','fmode=666']\n\n  # Provider-specific configuration so you can fine-tune various\n  # backing providers for Vagrant. These expose provider-specific options.\n  # Example for VirtualBox:\n  #\n  config.vm.provider \"virtualbox\" do |vb|\n  #   # Display the VirtualBox GUI when booting the machine\n     vb.gui = false\n  #\n  #   # Customize the amount of memory on the VM:\n     vb.memory = \"1024\"\n  end\n  #\n  # View the documentation for the provider you are using for more\n  # information on available options.\n\n  # Define a Vagrant Push strategy for pushing to Atlas. Other push strategies\n  # such as FTP and Heroku are also available. See the documentation at\n  # https://docs.vagrantup.com/v2/push/atlas.html for more information.\n  # config.push.define \"atlas\" do |push|\n  #   push.app = \"YOUR_ATLAS_USERNAME/YOUR_APPLICATION_NAME\"\n  # end\n\n  # Enable provisioning with a shell script. Additional provisioners such as\n  # Puppet, Chef, Ansible, Salt, and Docker are also available. Please see the\n  # documentation for more information about their specific syntax and use.\n  # config.vm.provision \"shell\", inline: <<-SHELL\n  #   sudo apt-get update\n  #   sudo apt-get install -y apache2\n  # SHELL\nend\n```\n\n## \u8d77\u52d5\n\n```bash\nvagrant up\n```\n\n\u3068\u3059\u308b\u3068\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u304c\u7acb\u3061\u4e0a\u304c\u308a\u307e\u3059\u3002\n\n## \u30ed\u30b0\u30a4\u30f3\u51fa\u6765\u308b\u304b\u78ba\u8a8d\n\n```\nvagrant ssh\n```\n\n\u3068\u3059\u308b\u3068\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306b\u30ed\u30b0\u30a4\u30f3\u3067\u304d\u307e\u3059\u3002\n\n## \u5bbf\u984c\n\nChef\u306f\u597d\u307f\u3058\u3083\u306a\u3044\u306e\u3067Ansible\u3067\u7d30\u304b\u3044\u8a2d\u5b9a\u3092\u884c\u3046\u3002\n\n", "tags": ["packer", "VirtualBox", "centos7"]}