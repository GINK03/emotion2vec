{"tags": ["JavaScript", "tmlib.js"], "context": " More than 1 year has passed since last update.tmlib.js\u3067Slider (\u3053\u306e\u540d\u79f0\u3067\u5408\u3063\u3066\u308b\u304b\u77e5\u3089\u306a\u3044) \u3092\u5b9f\u88c5\u3057\u307e\u3057\u305f\u3002\n\u4eca\u56de\u306fShape\u3092\u4f7f\u7528\u3057\u3066\u3044\u307e\u3059\u3002\u753b\u50cf\u6307\u5b9a\u3059\u308c\u3070Sprite\u3082\u53ef\u3002\n\u305d\u3057\u3066\u5f15\u6570\u304c\u591a\u3044\u2026\njsdo.it\u306b\u30b5\u30f3\u30d7\u30eb\u7f6e\u304d\u307e\u3057\u305f\u3002\n/**\n * Slider\u30af\u30e9\u30b9\n */\nvar Slider = tm.createClass({\n    superClass: tm.app.Shape,\n\n    value: 0,           // Slider\u306e\u73fe\u5728\u5024\n    min: null,          // \u6700\u5c0f\u5024\n    max: null,          // \u6700\u5927\u5024\n    default: null,      // \u521d\u671f\u5024\n    dragging: false,    // \u30b9\u30e9\u30a4\u30c9\u4e2d\u30d5\u30e9\u30b0\n    disabled: false,    // disabled\n\n    init: function(x, y, width, height, margin, min, max, def, sliderImage, gripImage) {\n        this.superInit(width, height + (margin==null ? 100 : margin));\n        this.setPosition(x, y);\n\n        // \u5024\u306e\u521d\u671f\u5316\n        this.min = ((min == null) ? 1 : min) - 1;\n        this.max = ((max == null) ? 100 : max);\n        this.default = (def == null) ? this.min : def;\n        this.value = this.default;\n\n        // Slider\u8ffd\u52a0\n        if (sliderImage != null) {\n            var img = tm.graphics.TextureManager.get(sliderImage);\n            this.slider = tm.app.Sprite(img.width, img.height, sliderImage).setPosition(0, 0);\n        } else {\n            this.slider = tm.app.RectangleShape(width, height / 2, {\n                fillStyle: \"gray\",\n                strokeStyle: \"black\",\n                lineWidth: \"1\"\n            });\n        }\n        this.slider.setPosition(0, 0);\n        this.slider.addChildTo(this);\n\n        // \u30b0\u30ea\u30c3\u30d7\u521d\u671f\u4f4d\u7f6e\n        var pos = this.value * width / (this.max - this.min);\n        // \u521d\u671f\u4f4d\u7f6e\u306e\u305a\u308c\u9632\u6b62\n        if (this.value <= this.min) { pos = 0; }\n        if (this.value >= this.max) { pos = this.width; }\n\n        // \u30b0\u30ea\u30c3\u30d7\u8ffd\u52a0\n        if (gripImage != null) {\n            var img = tm.graphics.TextureManager.get(gripImage);\n            this.slideGrip = tm.app.Sprite(img.width, img.height, gripImage);\n        } else {\n            this.slideGrip = tm.app.CircleShape(this.height/2.5, this.height/2.5, {\n                fillStyle: \"white\",\n                strokeStyle: \"black\",\n                lineWidth: \"5\",\n            });\n        }\n        this.slideGrip.setPosition(pos - (this.width/2), 0);\n        this.slideGrip.addChildTo(this);\n\n        // \u30de\u30a6\u30b9\u30a4\u30d9\u30f3\u30c8\u3092\u6709\u52b9\u5316\n        this.interaction.enabled = true;\n        this.interaction.boundingType = \"rect\";\n    },\n\n    // \u30bf\u30c3\u30c1\u958b\u59cb\n    onpointingstart: function(e) {\n        if (this.disabled) {\n            this.dragging = false;\n            return;\n        }\n        // \u30b9\u30e9\u30a4\u30c9\u958b\u59cb\u306f\u30b0\u30ea\u30c3\u30d7\u4e0a\u3092\u30dd\u30a4\u30f3\u30c8\u3057\u3066\u3044\u308b\u3053\u3068\n        var gp = this.localToGlobal(this.pointing);\n        if (this.slideGrip.isHitPoint(e.app.pointing.x - gp.x, e.app.pointing.y - gp.y)) {\n            this.dragging = true;\n        }\n    },\n\n    // \u30b9\u30ef\u30a4\u30d7\n    onpointingmove: function(e) {\n        // \u30b0\u30ea\u30c3\u30d7\u304c\u30c9\u30e9\u30c3\u30b0\u72b6\u614b\u3067\u3042\u308c\u3070Slider\u4e0a\u306e\u30dd\u30a4\u30f3\u30bf\u5ea7\u6a19\u306b\u79fb\u52d5\u3059\u308b\n        var gp = this.localToGlobal(this.pointing);\n        if (this.dragging && this.isHitPoint(e.app.pointing.x, e.app.pointing.y)) {\n            this.slideGrip.setPosition(e.app.pointing.x - gp.x, this.slideGrip.y);\n            this.value = (this.slideGrip.x + (this.width / 2)) * ((this.max - this.min) / this.width);\n        }\n    },\n\n    // \u30bf\u30c3\u30c1\u7d42\u4e86\n    onpointingend: function() {\n        this.dragging = false;\n    },\n\n    // \u73fe\u5728\u5024\u3092Int\u3067\u53d7\u3051\u53d6\u308b\n    getIntValue: function() {\n        return parseInt(this.value);\n    },\n\n    // \u73fe\u5728\u5024\u3092Float(\u52a0\u5de5\u7121\u3057)\u3067\u53d7\u3051\u53d6\u308b\n    getFloatValue: function() {\n        return this.value;\n    },\n});\n\n\n\u4f7f\u7528\u4f8b\uff08Slider\u30af\u30e9\u30b9\u306e\u5b9a\u7fa9\u306f\u7701\u7565\uff09\n/*\n * constant\n */\nvar SCREEN_WIDTH    = 640;\nvar SCREEN_HEIGHT   = 920;\nvar SCREEN_CENTER_X = SCREEN_WIDTH / 2;\nvar SCREEN_CENTER_Y = SCREEN_HEIGHT / 2;\n\n/*\n * \u30e1\u30a4\u30f3\u51e6\u7406(\u30da\u30fc\u30b8\u8aad\u307f\u8fbc\u307f\u5f8c\u306b\u5b9f\u884c\u3055\u308c\u308b)\n */\ntm.main(function() {\n\n    // \u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u4f5c\u6210\n    var app = tm.app.CanvasApp(\"#world\");\n    app.resize(SCREEN_WIDTH, SCREEN_HEIGHT); // \u30ea\u30b5\u30a4\u30ba\n    app.fitWindow();    // \u81ea\u52d5\u30d5\u30a3\u30c3\u30c8\n    app.background = \"white\";\n\n    // \u30b7\u30fc\u30f3\u3092\u5207\u308a\u66ff\u3048\u308b\n    app.replaceScene(MainScene());\n\n    // \u5b9f\u884c\n    app.run();\n});\n\n\ntm.define(\"MainScene\", {\n    superClass: \"tm.app.Scene\",\n\n    init: function() {\n        // \u89aa\u306e\u521d\u671f\u5316\n        this.superInit();\n\n        // Slider\n        this.slider = Slider(320, 400, 400, 21, 100, 0, 200, 100);\n        this.slider.addChildTo(this);\n\n        // Slider\u306e\u73fe\u5728\u5024\u8868\u793a\u7528\u30e9\u30d9\u30eb\n        this.sliderValue = tm.app.Label(\"0\");\n        this.sliderValue.setPosition(70, 410).setFillStyle(\"black\").addChildTo(this);\n    },\n\n    update: function(app) {\n        this.sliderValue.text = this.slider.getIntValue();\n    },\n});\n\n\n\u5b9f\u884c\u7d50\u679c\n\n\u30b0\u30c3\u3068\u63b4\u3093\u3067\u30b9\u30c3\u3068\u52d5\u304b\u305b\u3070\u6570\u5024\u304c\u5909\u308f\u308a\u307e\u3059\u3002\n\u6a2a\u65b9\u5411\u306e\u8a8d\u8b58\u7bc4\u56f2\u306e\u30de\u30fc\u30b8\u30f3\u304c\u53d6\u308c\u3066\u306a\u3044\u306e\u3067\u6539\u5584\u306e\u4f59\u5730\u3042\u308a\u3002\ntmlib.js\u3067Slider (\u3053\u306e\u540d\u79f0\u3067\u5408\u3063\u3066\u308b\u304b\u77e5\u3089\u306a\u3044) \u3092\u5b9f\u88c5\u3057\u307e\u3057\u305f\u3002\n\u4eca\u56de\u306fShape\u3092\u4f7f\u7528\u3057\u3066\u3044\u307e\u3059\u3002\u753b\u50cf\u6307\u5b9a\u3059\u308c\u3070Sprite\u3082\u53ef\u3002\n\u305d\u3057\u3066\u5f15\u6570\u304c\u591a\u3044\u2026\n\n[jsdo.it\u306b\u30b5\u30f3\u30d7\u30eb\u7f6e\u304d\u307e\u3057\u305f\u3002](http://jsdo.it/cupk/uDZr)\n\n```js:\n/**\n * Slider\u30af\u30e9\u30b9\n */\nvar Slider = tm.createClass({\n\tsuperClass: tm.app.Shape,\n\t\n\tvalue: 0,           // Slider\u306e\u73fe\u5728\u5024\n\tmin: null,          // \u6700\u5c0f\u5024\n\tmax: null,          // \u6700\u5927\u5024\n\tdefault: null,      // \u521d\u671f\u5024\n\tdragging: false,    // \u30b9\u30e9\u30a4\u30c9\u4e2d\u30d5\u30e9\u30b0\n\tdisabled: false,    // disabled\n\t\n\tinit: function(x, y, width, height, margin, min, max, def, sliderImage, gripImage) {\n\t\tthis.superInit(width, height + (margin==null ? 100 : margin));\n\t\tthis.setPosition(x, y);\n\t\t\n\t\t// \u5024\u306e\u521d\u671f\u5316\n\t\tthis.min = ((min == null) ? 1 : min) - 1;\n\t\tthis.max = ((max == null) ? 100 : max);\n\t\tthis.default = (def == null) ? this.min : def;\n\t\tthis.value = this.default;\n\t\t\n\t\t// Slider\u8ffd\u52a0\n\t\tif (sliderImage != null) {\n\t\t\tvar img = tm.graphics.TextureManager.get(sliderImage);\n\t\t\tthis.slider = tm.app.Sprite(img.width, img.height, sliderImage).setPosition(0, 0);\n\t\t} else {\n\t\t\tthis.slider = tm.app.RectangleShape(width, height / 2, {\n\t\t\t\tfillStyle: \"gray\",\n\t\t\t\tstrokeStyle: \"black\",\n\t\t\t\tlineWidth: \"1\"\n\t\t\t});\n\t\t}\n\t\tthis.slider.setPosition(0, 0);\n\t\tthis.slider.addChildTo(this);\n\t\t\n\t\t// \u30b0\u30ea\u30c3\u30d7\u521d\u671f\u4f4d\u7f6e\n\t\tvar pos = this.value * width / (this.max - this.min);\n\t\t// \u521d\u671f\u4f4d\u7f6e\u306e\u305a\u308c\u9632\u6b62\n\t\tif (this.value <= this.min) { pos = 0; }\n\t\tif (this.value >= this.max) { pos = this.width; }\n\t\t\n\t\t// \u30b0\u30ea\u30c3\u30d7\u8ffd\u52a0\n\t\tif (gripImage != null) {\n\t\t\tvar img = tm.graphics.TextureManager.get(gripImage);\n\t\t\tthis.slideGrip = tm.app.Sprite(img.width, img.height, gripImage);\n\t\t} else {\n\t\t\tthis.slideGrip = tm.app.CircleShape(this.height/2.5, this.height/2.5, {\n\t\t\t\tfillStyle: \"white\",\n\t\t\t\tstrokeStyle: \"black\",\n\t\t\t\tlineWidth: \"5\",\n\t\t\t});\n\t\t}\n\t\tthis.slideGrip.setPosition(pos - (this.width/2), 0);\n\t\tthis.slideGrip.addChildTo(this);\n\t\t\n\t\t// \u30de\u30a6\u30b9\u30a4\u30d9\u30f3\u30c8\u3092\u6709\u52b9\u5316\n\t\tthis.interaction.enabled = true;\n\t\tthis.interaction.boundingType = \"rect\";\n\t},\n\t\n\t// \u30bf\u30c3\u30c1\u958b\u59cb\n\tonpointingstart: function(e) {\n\t\tif (this.disabled) {\n\t\t\tthis.dragging = false;\n\t\t\treturn;\n\t\t}\n\t\t// \u30b9\u30e9\u30a4\u30c9\u958b\u59cb\u306f\u30b0\u30ea\u30c3\u30d7\u4e0a\u3092\u30dd\u30a4\u30f3\u30c8\u3057\u3066\u3044\u308b\u3053\u3068\n\t\tvar gp = this.localToGlobal(this.pointing);\n\t\tif (this.slideGrip.isHitPoint(e.app.pointing.x - gp.x, e.app.pointing.y - gp.y)) {\n\t\t\tthis.dragging = true;\n\t\t}\n\t},\n\t\n\t// \u30b9\u30ef\u30a4\u30d7\n\tonpointingmove: function(e) {\n\t\t// \u30b0\u30ea\u30c3\u30d7\u304c\u30c9\u30e9\u30c3\u30b0\u72b6\u614b\u3067\u3042\u308c\u3070Slider\u4e0a\u306e\u30dd\u30a4\u30f3\u30bf\u5ea7\u6a19\u306b\u79fb\u52d5\u3059\u308b\n\t\tvar gp = this.localToGlobal(this.pointing);\n\t\tif (this.dragging && this.isHitPoint(e.app.pointing.x, e.app.pointing.y)) {\n\t\t\tthis.slideGrip.setPosition(e.app.pointing.x - gp.x, this.slideGrip.y);\n\t\t\tthis.value = (this.slideGrip.x + (this.width / 2)) * ((this.max - this.min) / this.width);\n\t\t}\n\t},\n\t\n\t// \u30bf\u30c3\u30c1\u7d42\u4e86\n\tonpointingend: function() {\n\t\tthis.dragging = false;\n\t},\n\t\n\t// \u73fe\u5728\u5024\u3092Int\u3067\u53d7\u3051\u53d6\u308b\n\tgetIntValue: function() {\n\t\treturn parseInt(this.value);\n\t},\n\t\n\t// \u73fe\u5728\u5024\u3092Float(\u52a0\u5de5\u7121\u3057)\u3067\u53d7\u3051\u53d6\u308b\n\tgetFloatValue: function() {\n\t\treturn this.value;\n\t},\n});\n```\n\n<br/>\n\u4f7f\u7528\u4f8b\uff08Slider\u30af\u30e9\u30b9\u306e\u5b9a\u7fa9\u306f\u7701\u7565\uff09\n\n```js:\n/*\n * constant\n */\nvar SCREEN_WIDTH    = 640;\nvar SCREEN_HEIGHT   = 920;\nvar SCREEN_CENTER_X = SCREEN_WIDTH / 2;\nvar SCREEN_CENTER_Y = SCREEN_HEIGHT / 2;\n\n/*\n * \u30e1\u30a4\u30f3\u51e6\u7406(\u30da\u30fc\u30b8\u8aad\u307f\u8fbc\u307f\u5f8c\u306b\u5b9f\u884c\u3055\u308c\u308b)\n */\ntm.main(function() {\n\t\n\t// \u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u4f5c\u6210\n\tvar app = tm.app.CanvasApp(\"#world\");\n\tapp.resize(SCREEN_WIDTH, SCREEN_HEIGHT); // \u30ea\u30b5\u30a4\u30ba\n\tapp.fitWindow();    // \u81ea\u52d5\u30d5\u30a3\u30c3\u30c8\n\tapp.background = \"white\";\n\t\n\t// \u30b7\u30fc\u30f3\u3092\u5207\u308a\u66ff\u3048\u308b\n\tapp.replaceScene(MainScene());\n\t\n\t// \u5b9f\u884c\n\tapp.run();\n});\n\n\ntm.define(\"MainScene\", {\n\tsuperClass: \"tm.app.Scene\",\n\t\n\tinit: function() {\n\t\t// \u89aa\u306e\u521d\u671f\u5316\n\t\tthis.superInit();\n\t\t\n\t\t// Slider\n\t\tthis.slider = Slider(320, 400, 400, 21, 100, 0, 200, 100);\n\t\tthis.slider.addChildTo(this);\n\t\t\n\t\t// Slider\u306e\u73fe\u5728\u5024\u8868\u793a\u7528\u30e9\u30d9\u30eb\n\t\tthis.sliderValue = tm.app.Label(\"0\");\n\t\tthis.sliderValue.setPosition(70, 410).setFillStyle(\"black\").addChildTo(this);\n\t},\n\t\n\tupdate: function(app) {\n\t\tthis.sliderValue.text = this.slider.getIntValue();\n\t},\n});\n```\n\n<br/>\n\u5b9f\u884c\u7d50\u679c\n![slider.png](https://qiita-image-store.s3.amazonaws.com/0/25969/57653f7b-3e7d-487d-1e57-0994e017b667.png)\n\u30b0\u30c3\u3068\u63b4\u3093\u3067\u30b9\u30c3\u3068\u52d5\u304b\u305b\u3070\u6570\u5024\u304c\u5909\u308f\u308a\u307e\u3059\u3002\n\u6a2a\u65b9\u5411\u306e\u8a8d\u8b58\u7bc4\u56f2\u306e\u30de\u30fc\u30b8\u30f3\u304c\u53d6\u308c\u3066\u306a\u3044\u306e\u3067\u6539\u5584\u306e\u4f59\u5730\u3042\u308a\u3002\n"}