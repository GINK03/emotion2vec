{"tags": ["Azure", "oracle"], "context": "Platinum 12c \u306e\u8a66\u9a13\u5bfe\u7b56\u306b Azure \u3067\u69cb\u7bc9\u3057\u3066\u307f\u307e\u3057\u305f\u3002\nCentOS \u304c\u6df7\u3058\u3063\u3066\u3044\u308b\u306e\u306f\u308f\u305f\u3057\u306e\u81ea\u52d5\u8a2d\u5b9a\u30b9\u30af\u30ea\u30d7\u30c8\u306e\u8a66\u9a13\u3082\u517c\u306d\u3066\u307e\u3059\u3002\nVirtualBox \u3067\u306f\u3046\u3061\u306e\u30de\u30b7\u30f3\u3067\u306f\u9650\u754c\u306a\u306e\u3067\u30af\u30e9\u30a6\u30c9\u3067\u304a\u6c17\u697d\u306b\u4f5c\u308c\u306a\u3044\u304b\u3068\u691c\u8a0e\u3057\u3066\u307f\u305f\u3068\u3053\u308d\u3001\nAzure \u304c\u65e9\u304f\u3066\u697d\u3067\u3057\u305f\u3002\u305f\u3060\u3001\u82e6\u52b4\u3092\u3059\u308b\u70b9\u306f\u304b\u306a\u308a\u3042\u308a\u307e\u3057\u305f\u306e\u3067\u307e\u3068\u3081\u3066\u304a\u304d\u307e\u3059\u3002\u7279\u306b NIC \u5468\u308a\u3002\n\n(\u8ffd\u8a18)\n\u300c\u73fe\u5728\u3001Azure \u3067\u306f Oracle Database \u306e Oracle Real Application Clusters (RAC) \u306f\u30b5\u30dd\u30fc\u30c8\u3055\u308c\u3066\u3044\u307e\u305b\u3093\u3002\u300d\n\u3068\u306e\u3053\u3068\u3002\u3002\u304c\u301c\u3093\u3002\u3002RAC \u69cb\u7bc9\u306e\u7df4\u7fd2\u306f\u307e\u305f\u5225\u306b\u3084\u308a\u307e\u3059(\u6d99)\nhttps://docs.microsoft.com/ja-jp/azure/virtual-machines/virtual-machines-windows-classic-oracle-considerations\n\n1. \u8a2d\u8a08\nORACLE MASTER Platinum Oracle Database 12c \u79fb\u884c\u8a66\u9a13 \u306e\u8a66\u9a13\u74b0\u5883\u3092\u3067\u304d\u308b\u3060\u3051\u518d\u73fe\u3057\u3088\u3046\u3068\u3057\u3066\u3044\u307e\u3059\u3002\n\n\n\n\u7528\u9014\n\u30db\u30b9\u30c8\u540d\nOS\n\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\u3082\u306e\n\n\n\n\n\u7ba1\u7406\u7528\nem1\nOracle Linux 6.8\nOracle Enterprise Manager Cloud Control 12c Release 4\n\n\nData Guard/\u30b7\u30f3\u30b0\u30eb\u69cb\u6210\u7528\nora1, ora2\nCentOS 6.8\nOracle Database 12c Enterprise Edition Release 12.1.0.2.0\n\n\nRAC\u7528\nrac1, rac2\nOracle Linux 6.8\nOracle Grid Infrastructure 12c Release 1 (12.1.0.2), Oracle Database 12c Enterprise Edition Release 12.1.0.2.0\n\n\n\n\n2. Azure CLI \u3092\u4f7f\u3046\nNIC 2\u679a\u523a\u3057\u306f\u69cb\u7bc9\u6642\u306b\u3057\u304b\u3067\u304d\u305a\u3001\u3057\u304b\u3082CLI\u3067\u3057\u304b\u3067\u304d\u306a\u3044\u307f\u305f\u3044\u3067\u3001\nAzure CLI \u3092\u5165\u308c\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3057\u305f\u3002\n$ brew install azure-cli\n\n@miwato \u3055\u3093\u306e\u8a18\u4e8b\u304c\u3068\u3066\u3082\u53c2\u8003\u306b\u306a\u308a\u307e\u3059\u3002\u3068\u3066\u3082\u4e01\u5be7\u306b\u66f8\u3044\u3066\u3042\u308a\u307e\u3059\u3002\u3042\u308a\u304c\u3068\u3046\u3054\u3056\u3044\u307e\u3059\u3002\nhttp://qiita.com/miwato/items/90afd7a33f3043c16201\n\u4eee\u60f3\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u3092\u4f5c\u3063\u3066\u3001\u305d\u306e\u4e0b\u306b\u30b5\u30d6\u30cd\u30c3\u30c8\u3092\u5fc5\u8981\u306aNIC\u306e\u6570\u4f5c\u308b\u3068\u3044\u3046\u306e\u304c\u5927\u304d\u306a\u30dd\u30a4\u30f3\u30c8\u3067\u3057\u305f\u3002\n\u4eee\u60f3\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u30922\u3064\u4ee5\u4e0a\u63a5\u7d9a\u3057\u305fVM\u306f\u4f5c\u308c\u306a\u3044\u3088\u3046\u3067\u3059\u3002\nStandard DS2 v2 (2 \u30b3\u30a2\u30017 GB \u30e1\u30e2\u30ea) \u30925\u53f0\u4f5c\u308a\u307e\u3057\u305f\u3002\n\n2.1. \u30a2\u30ab\u30a6\u30f3\u30c8 (login) \u3068 \u30b5\u30d6\u30b9\u30af\u30ea\u30d7\u30b7\u30e7\u30f3 (account)\n\u3053\u306e\u3078\u3093\u306f\u30d6\u30e9\u30a6\u30b6\u306eGUI\u3067\u6e96\u5099\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n$ azure login\n(\u30d6\u30e9\u30a6\u30b6\u3092\u8d77\u52d5\u3057\u3066\u5225\u9014\u30ed\u30b0\u30a4\u30f3)\n$ azure account list\ninfo:    Executing command account list\ndata:    Name  Id                                    Current  State  \ndata:    ----  ------------------------------------  -------  -------\ndata:    \u5f93\u91cf\u8ab2\u91d1  384dXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX  true     Enabled\n\n\n\n2.2. \u30ea\u30bd\u30fc\u30b9\u30b0\u30eb\u30fc\u30d7 (group)\n\u3053\u308c\u3082 GUI \u3067\u4f5c\u3063\u3066\u3057\u307e\u3044\u307e\u3057\u305f\u304c CLI \u3060\u3068\u3053\u3093\u306a\u611f\u3058\u306e\u3088\u3046\u3067\u3059\u3002\n\u3053\u3053\u3067\u306f \"oracle\" \u306b\u3057\u3066\u307f\u307e\u3057\u305f\u3002\n$ azure group create oracle --location japaneast\n\n\n2.3. \u30b9\u30c8\u30ec\u30fc\u30b8\u30a2\u30ab\u30a6\u30f3\u30c8 (storage account)\n\u4eee\u60f3\u30de\u30b7\u30f3\u306e\u30c7\u30a3\u30b9\u30af\u3092\u4fdd\u6301\u3059\u308b\u305f\u3081\u306b\u5fc5\u8981\u3068\u306e\u3053\u3068\u3002\u4e00\u610f\u6027\u3092\u8981\u3059\u308b\u3089\u3057\u3044\u3067\u3059\u3002\ncreate \u306e\u5f8c\u306b ID \u3092\u6307\u5b9a\u3057\u307e\u3059\u3002kind \u3084 sku-name \u306f\u3053\u3046\u3044\u3046\u3082\u306e\u307f\u305f\u3044\u3067\u3059\u3002\n$ azure storage account create sugitkXXXXXXXXXX --resource-group oracle \\\n--location japaneast --kind Storage --sku-name PLRS\n\n\n2.4. \u4eee\u60f3\u30cd\u30c3\u30c8\u30ef\u30fc\u30af (vnet)\n\u307e\u305a\u3053\u306e\u30b7\u30b9\u30c6\u30e0\u5168\u4f53\u3067\u4f7f\u3046\u4eee\u60f3\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u3092\u5b9a\u7fa9\u3057\u307e\u3059\u3002\n$ azure network vnet create -g oracle -l japaneast -n ora_vnet -d -a 10.0.0.0/16\n\n\u5fc5\u8981\u306aNIC\u5206\u3060\u3051\u30b5\u30d6\u30cd\u30c3\u30c8\u3092\u5207\u308a\u51fa\u3057\u30022\u3064\u4f5c\u308a\u307e\u3057\u305f\u3002\n$ azure network vnet subnet create -g oracle -e ora_vnet -n db_subnet -a 10.0.10.0/24\n$ azure network vnet subnet create -g oracle -e ora_vnet -n interconnect_subnet -a 10.0.20.0/24\n\n\u78ba\u8a8d\u3057\u3066\u307f\u307e\u3059\u3002\n$ azure network vnet list\ninfo:    Executing command network vnet list\n+ Looking up virtual networks                                                  \ndata:    Name      Location   Resource group  Provisioning state  Address prefixes  DNS servers  Subnets number\ndata:    --------  ---------  --------------  ------------------  ----------------  -----------  --------------\ndata:    ora_vnet  japaneast  oracle          Succeeded           10.0.0.0/16                    2             \ninfo:    network vnet list command OK\n\n$ azure network vnet subnet list -g oracle -e ora_vnet\ninfo:    Executing command network vnet subnet list\n+ Looking up the virtual network \"ora_vnet\"                                    \n+ Getting virtual network subnets                                              \ndata:    Name                 Provisioning state  Address prefix\ndata:    -------------------  ------------------  --------------\ndata:    db_subnet            Succeeded           10.0.10.0/24  \ndata:    interconnect_subnet  Succeeded           10.0.20.0/24  \ninfo:    network vnet subnet list command OK\n\n\n2.5. \u4eee\u60f3NIC\n5\u53f0\u5206\u4f5c\u308a\u307e\u3059\u3002\u30b3\u30de\u30f3\u30c9\u30e9\u30a4\u30f3\u306f\u697d\u3067\u3059\u306d\u3002\n\n\n\n\u4eee\u60f3NIC\u540d\n\u4eee\u60f3\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u540d\n\u30b5\u30d6\u30cd\u30c3\u30c8\u540d\n\n\n\n\nem1_db\nora_vnet\ndb_subnet\n\n\nora1_db\nora_vnet\ndb_subnet\n\n\nora2_db\nora_vnet\ndb_subnet\n\n\nrac1_db\nora_vnet\ndb_subnet\n\n\nrac1_priv\nora_vnet\ninterconnect_subnet\n\n\nrac2_db\nora_vnet\ndb_subnet\n\n\nrac2_priv\nora_vnet\ninterconnect_subnet\n\n\n\n$ azure network nic create -g oracle -l japaneast -n em1_db -m ora_vnet -k db_subnet\n$ azure network nic create -g oracle -l japaneast -n ora1_db -m ora_vnet -k db_subnet\n$ azure network nic create -g oracle -l japaneast -n ora2_db -m ora_vnet -k db_subnet\n$ azure network nic create -g oracle -l japaneast -n rac1_db -m ora_vnet -k db_subnet\n$ azure network nic create -g oracle -l japaneast -n rac1_priv -m ora_vnet -k interconnect_subnet\n$ azure network nic create -g oracle -l japaneast -n rac2_db -m ora_vnet -k db_subnet\n$ azure network nic create -g oracle -l japaneast -n rac2_priv -m ora_vnet -k interconnect_subnet\n\n\u78ba\u8a8d\u3057\u3066\u307f\u307e\u3059\u3002\n$ azure network nic list -g oracle \ninfo:    Executing command network nic list\n+ Getting the network interfaces                                               \ndata:    Name       Location   Resource group  Provisioning state  MAC Address  IP forwarding  Internal DNS name  Internal FQDN  Internal domain name suffix                        \ndata:    ---------  ---------  --------------  ------------------  -----------  -------------  -----------------  -------------  ---------------------------------------------------\ndata:    em1_db     japaneast  oracle          Succeeded                        false                                            xx2bihairalutdl2nbha4kpkja.lx.internal.cloudapp.net\ndata:    ora1_db    japaneast  oracle          Succeeded                        false                                            xx2bihairalutdl2nbha4kpkja.lx.internal.cloudapp.net\ndata:    ora2_db    japaneast  oracle          Succeeded                        false                                            xx2bihairalutdl2nbha4kpkja.lx.internal.cloudapp.net\ndata:    rac1_db    japaneast  oracle          Succeeded                        false                                            xx2bihairalutdl2nbha4kpkja.lx.internal.cloudapp.net\ndata:    rac1_priv  japaneast  oracle          Succeeded                        false                                            xx2bihairalutdl2nbha4kpkja.lx.internal.cloudapp.net\ndata:    rac2_db    japaneast  oracle          Succeeded                        false                                            xx2bihairalutdl2nbha4kpkja.lx.internal.cloudapp.net\ndata:    rac2_priv  japaneast  oracle          Succeeded                        false                                            xx2bihairalutdl2nbha4kpkja.lx.internal.cloudapp.net\ninfo:    network nic list command OK\n\n\n2.6. public IP\u30a2\u30c9\u30ec\u30b9\u4e88\u7d04\n\u5916\u304b\u3089\u30a2\u30af\u30bb\u30b9\u3059\u308b\u305f\u3081\u306eIP\u30a2\u30c9\u30ec\u30b9\u3092\u305d\u308c\u305e\u308c\u78ba\u4fdd\u3057\u307e\u3059\u3002\nRAC \u306f2\u53f0\u30677\u3064\u5fc5\u8981\u306a\u306e\u3067\u540d\u524d\u3092\u3064\u3051\u3066\u304a\u304d\u307e\u3059\u3002\nDynamic \u3067\u3082 Static \u3067\u3082\u4f5c\u308c\u307e\u3059\u3002\n$ azure network public-ip create -g oracle -l japaneast -n em1_public\n$ azure network public-ip create -g oracle -l japaneast -n ora1_public\n$ azure network public-ip create -g oracle -l japaneast -n ora2_public\n$ azure network public-ip create -g oracle -l japaneast -n rac1_public -a Static\n$ azure network public-ip create -g oracle -l japaneast -n rac2_public -a Static\n$ azure network public-ip create -g oracle -l japaneast -n rac1_vip -a Static\n$ azure network public-ip create -g oracle -l japaneast -n rac2_vip -a Static\n$ azure network public-ip create -g oracle -l japaneast -n rac_scan1 -a Static\n$ azure network public-ip create -g oracle -l japaneast -n rac_scan2 -a Static\n$ azure network public-ip create -g oracle -l japaneast -n rac_scan3 -a Static\n\n\u78ba\u8a8d\u306f list \u3067\u3059\u3002\n\n$ azure network public-ip list\n\n\n2.7. \u4eee\u60f3NIC \u3068 public IP\u30a2\u30c9\u30ec\u30b9\u306e\u95a2\u9023\u4ed8\u3051\n\u30b3\u30de\u30f3\u30c9\u3067\u95a2\u9023\u3065\u3051\u308b\u65b9\u6cd5\u304c\u308f\u304b\u3089\u305a\u3001GUI\u3067\u3002\n\u300c\u30d1\u30d6\u30ea\u30c3\u30afIP\u30a2\u30c9\u30ec\u30b9\u300d\u3092\u9078\u629e \u2192 \u300c\u95a2\u9023\u4ed8\u3051\u300d \u2192 \u300c\u30ea\u30bd\u30fc\u30b9\u306e\u7a2e\u985e\u300d\u3092\u300c\u30cd\u30c3\u30c8\u30ef\u30fc\u30af \u30a4\u30f3\u30bf\u30d5\u30a7\u30fc\u30b9\u300d\u306b\u3059\u308b \u2192 \u4eee\u60f3NIC\u3092\u9078\u629e\u3057\u3066\u300cOK\u300d\u3067\u3059\u3002\n\n\n\npublic IP\u30a2\u30c9\u30ec\u30b9\u540d\n\u4eee\u60f3NIC\u540d\n\n\n\n\nem1_public\nem1_db\n\n\nora1_public\nora1_db\n\n\nora2_public\nora2_db\n\n\nrac1_public\nrac1_db\n\n\nrac2_public\nrac2_db\n\n\n\n\n2.8. VM\u4f5c\u6210\n\u3088\u3046\u3084\u304f VM \u304c\u4f5c\u308c\u307e\u3059\u3002\n\u307e\u305a\u306f\u30a4\u30e1\u30fc\u30b8\u540d\u3092\u53d6\u3063\u3066\u304d\u307e\u3059\u3002GUI \u3067\u306f \"Compute\u3092\u691c\u7d22\" \u3068\u3044\u3046\u3082\u306e\u306b\u5f53\u305f\u308a\u307e\u3059\u3002\n\u516c\u958b\u5143(publisher) \u3092\u6307\u5b9a\u3057\u306a\u3044\u3068\u691c\u7d22\u3067\u304d\u306a\u3044\u306e\u3067\u3001GUI\u3067\u8abf\u3079\u3066\u304a\u304d\u307e\u3059\u3002\n$ azure vm image list -l japaneast -p (\u516c\u958b\u5143)\n\n\u691c\u7d22\u3057\u3066\u3001Urn\u3092\u628a\u63e1\u3057\u307e\u3059\u3002\n\n\n\nOS\nUrn\n\n\n\n\nOracle Linux 6.8\nOracle:Oracle-Linux:6.8:6.8.20161020\n\n\nCentOS 6.8\nOpenLogic:CentOS:6.8:6.8.20170105\n\n\n\n\u3088\u3046\u3084\u304fVM\u304c\u4f5c\u308c\u307e\u3059\u3002\nNIC\u304c1\u3064\u306e\u3068\u304d\u3002\n\n$ azure vm create \\\n--resource-group oracle \\ \n--location japaneast \\\n--storage-account-name sugitkXXXXXXXXXX \\\n--os-type linux \\\n--vm-size Standard_DS2_v2 \\\n--name em1 \\\n--nic-names em1_db \\\n--public-ip-name em1_public \\\n--image-urn Oracle:Oracle-Linux:6.8:6.8.20161020 \\\n--admin-username oracle \\\n--ssh-publickey-file ~/.ssh/id_rsa.pub \n\nNIC\u304c2\u3064\u306e\u3068\u304d\u3002--nic-names \u306b2\u3064\u6307\u5b9a\u3057\u307e\u3059\u3002\u3053\u308c\u304cGUI\u3060\u3068\u3067\u304d\u306a\u3044\u3068\u3044\u3046\u2026\n\n$ azure vm create \\\n--resource-group oracle \\\n--location japaneast \\\n--storage-account-name sugitkXXXXXXXXXX \\\n--os-type linux \\\n--vm-size Standard_DS2_v2 \\\n--name rac1 \\\n--nic-names rac1_db,rac1_priv \\\n--public-ip-name rac1_public \\\n--image-urn Oracle:Oracle-Linux:6.8:6.8.20161020 \\\n--admin-username oracle \\\n--ssh-publickey-file ~/.ssh/id_rsa.pub \n\n\n2.9. VM\u4f5c\u6210\u5f8c\nNIC\u30922\u679a\u523a\u3057\u305f\u3068\u304d\u3001IP\u30a2\u30c9\u30ec\u30b9\u306e\u5272\u308a\u5f53\u3066\u306f\u3055\u308c\u3066\u3044\u308b\u306e\u3067\u3059\u304cOS\u5074\u306b\u306f\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u307e\u305b\u3093\u3002\nifcfg-eth1 \u3092\u66f8\u3044\u3066\u8a2d\u5b9a\u3059\u308b\u5fc5\u8981\u304c\u3042\u308b\u307f\u305f\u3044\u3067\u3059\u3002\nDEVICE=eth1\nONBOOT=yes\nBOOTPROTO=static\nTYPE=Ethernet\nIPADDR=XXX.XXX.XXX.XXX\nNETMASK=255.255.255.0\n\n\u305d\u306e\u4ed6\u3053\u3093\u306a\u3068\u3053\u308d\u306b\u6ce8\u610f\u3059\u3079\u304d\u3060\u3068\u601d\u3044\u307e\u3059\u3002\n\n\u30b9\u30c8\u30ec\u30fc\u30b8\u30a2\u30ab\u30a6\u30f3\u30c8\u306f GUI \u304b\u3089\u898b\u308b\u3068\u4e0d\u8981\u305d\u3046\u306b\u898b\u3048\u3066\u3057\u307e\u3046\u306e\u3067\u9593\u9055\u3063\u3066\u6d88\u3055\u306a\u3044\u3088\u3046\u306b\u3059\u308b\n\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u3092\u8a2d\u5b9a\u3057\u3066 source IP address \u3092\u7d5e\u308b\n\u8ab2\u91d1\u306e\u3055\u308c\u3059\u304e\u306b\u306f\u6ce8\u610f (\u91cd\u8981\uff01)\n\n\n3. \u30bd\u30d5\u30c8\u30a6\u30a7\u30a2\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n(\u7565)\n\u30de\u30cb\u30e5\u30a2\u30eb \u8aad\u3093\u3067\u304f\u3060\u3055\u3044 :)\n\u4e8b\u524d\u6e96\u5099\u306b\u306f https://github.com/sugitk/ansible-oracle \u3092\u4f7f\u3046\u3068\u697d\u304c\u3067\u304d\u307e\u3059\u3088\u301c\n\n4. ~/.ssh/config\n\u7c21\u5358\u306b\u63a5\u7d9a\u3067\u304d\u308b\u3088\u3046\u306b ~/.ssh/config \u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n\u7df4\u7fd2\u7528\u306e\u305f\u3081\u306b DNS \u3092\u7acb\u3066\u305f\u308a\u767b\u9332\u3057\u305f\u308a\u3063\u3066\u9762\u5012\u3067\u3059\u3057\u306d\u3002\nHost em1\n  HostName xxx.xxx.xxx.xxx\n  user oracle\n  port 22\n\nHost ora1\n  HostName xxx.xxx.xxx.xxx\n  user oracle\n  port 22\n\nHost ora2\n  HostName xxx.xxx.xxx.xxx\n  user oracle\n  port 22\n\nHost rac1\n  HostName xxx.xxx.xxx.xxx\n  user oracle\n  port 22\n\nHost rac2\n  HostName xxx.xxx.xxx.xxx\n  user oracle\n  port 22\n\nPlatinum 12c \u306e\u8a66\u9a13\u5bfe\u7b56\u306b Azure \u3067\u69cb\u7bc9\u3057\u3066\u307f\u307e\u3057\u305f\u3002\nCentOS \u304c\u6df7\u3058\u3063\u3066\u3044\u308b\u306e\u306f\u308f\u305f\u3057\u306e\u81ea\u52d5\u8a2d\u5b9a\u30b9\u30af\u30ea\u30d7\u30c8\u306e\u8a66\u9a13\u3082\u517c\u306d\u3066\u307e\u3059\u3002\n\nVirtualBox \u3067\u306f\u3046\u3061\u306e\u30de\u30b7\u30f3\u3067\u306f\u9650\u754c\u306a\u306e\u3067\u30af\u30e9\u30a6\u30c9\u3067\u304a\u6c17\u697d\u306b\u4f5c\u308c\u306a\u3044\u304b\u3068\u691c\u8a0e\u3057\u3066\u307f\u305f\u3068\u3053\u308d\u3001\nAzure \u304c\u65e9\u304f\u3066\u697d\u3067\u3057\u305f\u3002\u305f\u3060\u3001\u82e6\u52b4\u3092\u3059\u308b\u70b9\u306f\u304b\u306a\u308a\u3042\u308a\u307e\u3057\u305f\u306e\u3067\u307e\u3068\u3081\u3066\u304a\u304d\u307e\u3059\u3002\u7279\u306b NIC \u5468\u308a\u3002\n\n# (\u8ffd\u8a18)\n\n\u300c\u73fe\u5728\u3001Azure \u3067\u306f Oracle Database \u306e Oracle Real Application Clusters (RAC) \u306f\u30b5\u30dd\u30fc\u30c8\u3055\u308c\u3066\u3044\u307e\u305b\u3093\u3002\u300d\n\u3068\u306e\u3053\u3068\u3002\u3002\u304c\u301c\u3093\u3002\u3002RAC \u69cb\u7bc9\u306e\u7df4\u7fd2\u306f\u307e\u305f\u5225\u306b\u3084\u308a\u307e\u3059(\u6d99)\nhttps://docs.microsoft.com/ja-jp/azure/virtual-machines/virtual-machines-windows-classic-oracle-considerations\n\n# 1. \u8a2d\u8a08\n\n[ORACLE MASTER Platinum Oracle Database 12c \u79fb\u884c\u8a66\u9a13](http://education.oracle.com/pls/web_prod-plq-dad/db_pages.getpage?page_id=5001&get_params=p_exam_id:12COCMU&p_org_id=70&lang=JA) \u306e\u8a66\u9a13\u74b0\u5883\u3092\u3067\u304d\u308b\u3060\u3051\u518d\u73fe\u3057\u3088\u3046\u3068\u3057\u3066\u3044\u307e\u3059\u3002\n\n|\u7528\u9014|\u30db\u30b9\u30c8\u540d|OS|\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\u3082\u306e|\n|---|---|---|---|---|\n|\u7ba1\u7406\u7528|em1|Oracle Linux 6.8|Oracle Enterprise Manager Cloud Control 12c Release 4|\n|Data Guard/\u30b7\u30f3\u30b0\u30eb\u69cb\u6210\u7528|ora1, ora2|CentOS 6.8|Oracle Database 12c Enterprise Edition Release 12.1.0.2.0|\n|RAC\u7528|rac1, rac2|Oracle Linux 6.8|Oracle Grid Infrastructure 12c Release 1 (12.1.0.2), Oracle Database 12c Enterprise Edition Release 12.1.0.2.0|\n\n\n# 2. Azure CLI \u3092\u4f7f\u3046\n\nNIC 2\u679a\u523a\u3057\u306f\u69cb\u7bc9\u6642\u306b\u3057\u304b\u3067\u304d\u305a\u3001\u3057\u304b\u3082CLI\u3067\u3057\u304b\u3067\u304d\u306a\u3044\u307f\u305f\u3044\u3067\u3001\nAzure CLI \u3092\u5165\u308c\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3057\u305f\u3002\n\n```\n$ brew install azure-cli\n```\n\n@miwato \u3055\u3093\u306e\u8a18\u4e8b\u304c\u3068\u3066\u3082\u53c2\u8003\u306b\u306a\u308a\u307e\u3059\u3002\u3068\u3066\u3082\u4e01\u5be7\u306b\u66f8\u3044\u3066\u3042\u308a\u307e\u3059\u3002\u3042\u308a\u304c\u3068\u3046\u3054\u3056\u3044\u307e\u3059\u3002\nhttp://qiita.com/miwato/items/90afd7a33f3043c16201\n\n\u4eee\u60f3\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u3092\u4f5c\u3063\u3066\u3001\u305d\u306e\u4e0b\u306b\u30b5\u30d6\u30cd\u30c3\u30c8\u3092\u5fc5\u8981\u306aNIC\u306e\u6570\u4f5c\u308b\u3068\u3044\u3046\u306e\u304c\u5927\u304d\u306a\u30dd\u30a4\u30f3\u30c8\u3067\u3057\u305f\u3002\n\u4eee\u60f3\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u30922\u3064\u4ee5\u4e0a\u63a5\u7d9a\u3057\u305fVM\u306f\u4f5c\u308c\u306a\u3044\u3088\u3046\u3067\u3059\u3002\n\nStandard DS2 v2 (2 \u30b3\u30a2\u30017 GB \u30e1\u30e2\u30ea) \u30925\u53f0\u4f5c\u308a\u307e\u3057\u305f\u3002\n\n## 2.1. \u30a2\u30ab\u30a6\u30f3\u30c8 (login) \u3068 \u30b5\u30d6\u30b9\u30af\u30ea\u30d7\u30b7\u30e7\u30f3 (account)\n\n\u3053\u306e\u3078\u3093\u306f\u30d6\u30e9\u30a6\u30b6\u306eGUI\u3067\u6e96\u5099\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n\n```\n$ azure login\n(\u30d6\u30e9\u30a6\u30b6\u3092\u8d77\u52d5\u3057\u3066\u5225\u9014\u30ed\u30b0\u30a4\u30f3)\n$ azure account list\ninfo:    Executing command account list\ndata:    Name  Id                                    Current  State  \ndata:    ----  ------------------------------------  -------  -------\ndata:    \u5f93\u91cf\u8ab2\u91d1  384dXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX  true     Enabled\n\n```\n\n## 2.2. \u30ea\u30bd\u30fc\u30b9\u30b0\u30eb\u30fc\u30d7 (group) \n\n\u3053\u308c\u3082 GUI \u3067\u4f5c\u3063\u3066\u3057\u307e\u3044\u307e\u3057\u305f\u304c CLI \u3060\u3068\u3053\u3093\u306a\u611f\u3058\u306e\u3088\u3046\u3067\u3059\u3002\n\u3053\u3053\u3067\u306f \"oracle\" \u306b\u3057\u3066\u307f\u307e\u3057\u305f\u3002\n\n```\n$ azure group create oracle --location japaneast\n```\n\n## 2.3. \u30b9\u30c8\u30ec\u30fc\u30b8\u30a2\u30ab\u30a6\u30f3\u30c8 (storage account)\n\n\u4eee\u60f3\u30de\u30b7\u30f3\u306e\u30c7\u30a3\u30b9\u30af\u3092\u4fdd\u6301\u3059\u308b\u305f\u3081\u306b\u5fc5\u8981\u3068\u306e\u3053\u3068\u3002\u4e00\u610f\u6027\u3092\u8981\u3059\u308b\u3089\u3057\u3044\u3067\u3059\u3002\ncreate \u306e\u5f8c\u306b ID \u3092\u6307\u5b9a\u3057\u307e\u3059\u3002kind \u3084 sku-name \u306f\u3053\u3046\u3044\u3046\u3082\u306e\u307f\u305f\u3044\u3067\u3059\u3002\n\n```\n$ azure storage account create sugitkXXXXXXXXXX --resource-group oracle \\\n--location japaneast --kind Storage --sku-name PLRS\n```\n\n## 2.4. \u4eee\u60f3\u30cd\u30c3\u30c8\u30ef\u30fc\u30af (vnet)\n\n\u307e\u305a\u3053\u306e\u30b7\u30b9\u30c6\u30e0\u5168\u4f53\u3067\u4f7f\u3046\u4eee\u60f3\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u3092\u5b9a\u7fa9\u3057\u307e\u3059\u3002\n\n```\n$ azure network vnet create -g oracle -l japaneast -n ora_vnet -d -a 10.0.0.0/16\n```\n\n\u5fc5\u8981\u306aNIC\u5206\u3060\u3051\u30b5\u30d6\u30cd\u30c3\u30c8\u3092\u5207\u308a\u51fa\u3057\u30022\u3064\u4f5c\u308a\u307e\u3057\u305f\u3002\n\n```\n$ azure network vnet subnet create -g oracle -e ora_vnet -n db_subnet -a 10.0.10.0/24\n$ azure network vnet subnet create -g oracle -e ora_vnet -n interconnect_subnet -a 10.0.20.0/24\n```\n\n\u78ba\u8a8d\u3057\u3066\u307f\u307e\u3059\u3002\n\n```\n$ azure network vnet list\ninfo:    Executing command network vnet list\n+ Looking up virtual networks                                                  \ndata:    Name      Location   Resource group  Provisioning state  Address prefixes  DNS servers  Subnets number\ndata:    --------  ---------  --------------  ------------------  ----------------  -----------  --------------\ndata:    ora_vnet  japaneast  oracle          Succeeded           10.0.0.0/16                    2             \ninfo:    network vnet list command OK\n\n$ azure network vnet subnet list -g oracle -e ora_vnet\ninfo:    Executing command network vnet subnet list\n+ Looking up the virtual network \"ora_vnet\"                                    \n+ Getting virtual network subnets                                              \ndata:    Name                 Provisioning state  Address prefix\ndata:    -------------------  ------------------  --------------\ndata:    db_subnet            Succeeded           10.0.10.0/24  \ndata:    interconnect_subnet  Succeeded           10.0.20.0/24  \ninfo:    network vnet subnet list command OK\n```\n\n## 2.5. \u4eee\u60f3NIC\n\n5\u53f0\u5206\u4f5c\u308a\u307e\u3059\u3002\u30b3\u30de\u30f3\u30c9\u30e9\u30a4\u30f3\u306f\u697d\u3067\u3059\u306d\u3002\n\n| \u4eee\u60f3NIC\u540d|\u4eee\u60f3\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u540d|\u30b5\u30d6\u30cd\u30c3\u30c8\u540d|\n|:---------|:------------|:---------|\n|em1_db|ora_vnet|db_subnet|\n|ora1_db|ora_vnet|db_subnet|\n|ora2_db|ora_vnet|db_subnet|\n|rac1_db|ora_vnet|db_subnet|\n|rac1_priv|ora_vnet|interconnect_subnet|\n|rac2_db|ora_vnet|db_subnet|\n|rac2_priv|ora_vnet|interconnect_subnet|\n\n```\n$ azure network nic create -g oracle -l japaneast -n em1_db -m ora_vnet -k db_subnet\n$ azure network nic create -g oracle -l japaneast -n ora1_db -m ora_vnet -k db_subnet\n$ azure network nic create -g oracle -l japaneast -n ora2_db -m ora_vnet -k db_subnet\n$ azure network nic create -g oracle -l japaneast -n rac1_db -m ora_vnet -k db_subnet\n$ azure network nic create -g oracle -l japaneast -n rac1_priv -m ora_vnet -k interconnect_subnet\n$ azure network nic create -g oracle -l japaneast -n rac2_db -m ora_vnet -k db_subnet\n$ azure network nic create -g oracle -l japaneast -n rac2_priv -m ora_vnet -k interconnect_subnet\n```\n\n\u78ba\u8a8d\u3057\u3066\u307f\u307e\u3059\u3002\n\n```\n$ azure network nic list -g oracle \ninfo:    Executing command network nic list\n+ Getting the network interfaces                                               \ndata:    Name       Location   Resource group  Provisioning state  MAC Address  IP forwarding  Internal DNS name  Internal FQDN  Internal domain name suffix                        \ndata:    ---------  ---------  --------------  ------------------  -----------  -------------  -----------------  -------------  ---------------------------------------------------\ndata:    em1_db     japaneast  oracle          Succeeded                        false                                            xx2bihairalutdl2nbha4kpkja.lx.internal.cloudapp.net\ndata:    ora1_db    japaneast  oracle          Succeeded                        false                                            xx2bihairalutdl2nbha4kpkja.lx.internal.cloudapp.net\ndata:    ora2_db    japaneast  oracle          Succeeded                        false                                            xx2bihairalutdl2nbha4kpkja.lx.internal.cloudapp.net\ndata:    rac1_db    japaneast  oracle          Succeeded                        false                                            xx2bihairalutdl2nbha4kpkja.lx.internal.cloudapp.net\ndata:    rac1_priv  japaneast  oracle          Succeeded                        false                                            xx2bihairalutdl2nbha4kpkja.lx.internal.cloudapp.net\ndata:    rac2_db    japaneast  oracle          Succeeded                        false                                            xx2bihairalutdl2nbha4kpkja.lx.internal.cloudapp.net\ndata:    rac2_priv  japaneast  oracle          Succeeded                        false                                            xx2bihairalutdl2nbha4kpkja.lx.internal.cloudapp.net\ninfo:    network nic list command OK\n```\n\n## 2.6. public IP\u30a2\u30c9\u30ec\u30b9\u4e88\u7d04\n\n\u5916\u304b\u3089\u30a2\u30af\u30bb\u30b9\u3059\u308b\u305f\u3081\u306eIP\u30a2\u30c9\u30ec\u30b9\u3092\u305d\u308c\u305e\u308c\u78ba\u4fdd\u3057\u307e\u3059\u3002\nRAC \u306f2\u53f0\u30677\u3064\u5fc5\u8981\u306a\u306e\u3067\u540d\u524d\u3092\u3064\u3051\u3066\u304a\u304d\u307e\u3059\u3002\n\nDynamic \u3067\u3082 Static \u3067\u3082\u4f5c\u308c\u307e\u3059\u3002\n\n```\n$ azure network public-ip create -g oracle -l japaneast -n em1_public\n$ azure network public-ip create -g oracle -l japaneast -n ora1_public\n$ azure network public-ip create -g oracle -l japaneast -n ora2_public\n$ azure network public-ip create -g oracle -l japaneast -n rac1_public -a Static\n$ azure network public-ip create -g oracle -l japaneast -n rac2_public -a Static\n$ azure network public-ip create -g oracle -l japaneast -n rac1_vip -a Static\n$ azure network public-ip create -g oracle -l japaneast -n rac2_vip -a Static\n$ azure network public-ip create -g oracle -l japaneast -n rac_scan1 -a Static\n$ azure network public-ip create -g oracle -l japaneast -n rac_scan2 -a Static\n$ azure network public-ip create -g oracle -l japaneast -n rac_scan3 -a Static\n```\n\n\u78ba\u8a8d\u306f list \u3067\u3059\u3002\n```\n$ azure network public-ip list\n```\n\n## 2.7. \u4eee\u60f3NIC \u3068 public IP\u30a2\u30c9\u30ec\u30b9\u306e\u95a2\u9023\u4ed8\u3051\n\n\u30b3\u30de\u30f3\u30c9\u3067\u95a2\u9023\u3065\u3051\u308b\u65b9\u6cd5\u304c\u308f\u304b\u3089\u305a\u3001GUI\u3067\u3002\n\u300c\u30d1\u30d6\u30ea\u30c3\u30afIP\u30a2\u30c9\u30ec\u30b9\u300d\u3092\u9078\u629e \u2192 \u300c\u95a2\u9023\u4ed8\u3051\u300d \u2192 \u300c\u30ea\u30bd\u30fc\u30b9\u306e\u7a2e\u985e\u300d\u3092\u300c\u30cd\u30c3\u30c8\u30ef\u30fc\u30af \u30a4\u30f3\u30bf\u30d5\u30a7\u30fc\u30b9\u300d\u306b\u3059\u308b \u2192 \u4eee\u60f3NIC\u3092\u9078\u629e\u3057\u3066\u300cOK\u300d\u3067\u3059\u3002\n\n|public IP\u30a2\u30c9\u30ec\u30b9\u540d|\u4eee\u60f3NIC\u540d|\n|:---------|:------------|\n|em1_public|em1_db|\n|ora1_public|ora1_db|\n|ora2_public|ora2_db|\n|rac1_public|rac1_db|\n|rac2_public|rac2_db|\n\n\n## 2.8. VM\u4f5c\u6210\n\n\u3088\u3046\u3084\u304f VM \u304c\u4f5c\u308c\u307e\u3059\u3002\n\n\u307e\u305a\u306f\u30a4\u30e1\u30fc\u30b8\u540d\u3092\u53d6\u3063\u3066\u304d\u307e\u3059\u3002GUI \u3067\u306f \"Compute\u3092\u691c\u7d22\" \u3068\u3044\u3046\u3082\u306e\u306b\u5f53\u305f\u308a\u307e\u3059\u3002\n\u516c\u958b\u5143(publisher) \u3092\u6307\u5b9a\u3057\u306a\u3044\u3068\u691c\u7d22\u3067\u304d\u306a\u3044\u306e\u3067\u3001GUI\u3067\u8abf\u3079\u3066\u304a\u304d\u307e\u3059\u3002\n\n```\n$ azure vm image list -l japaneast -p (\u516c\u958b\u5143)\n```\n\n\u691c\u7d22\u3057\u3066\u3001Urn\u3092\u628a\u63e1\u3057\u307e\u3059\u3002\n\n|OS|Urn|\n|---|---|\n|Oracle Linux 6.8|Oracle:Oracle-Linux:6.8:6.8.20161020|\n|CentOS 6.8|OpenLogic:CentOS:6.8:6.8.20170105|\n\n\u3088\u3046\u3084\u304fVM\u304c\u4f5c\u308c\u307e\u3059\u3002\n\nNIC\u304c1\u3064\u306e\u3068\u304d\u3002\n```\n$ azure vm create \\\n--resource-group oracle \\ \n--location japaneast \\\n--storage-account-name sugitkXXXXXXXXXX \\\n--os-type linux \\\n--vm-size Standard_DS2_v2 \\\n--name em1 \\\n--nic-names em1_db \\\n--public-ip-name em1_public \\\n--image-urn Oracle:Oracle-Linux:6.8:6.8.20161020 \\\n--admin-username oracle \\\n--ssh-publickey-file ~/.ssh/id_rsa.pub \n```\n\nNIC\u304c2\u3064\u306e\u3068\u304d\u3002--nic-names \u306b2\u3064\u6307\u5b9a\u3057\u307e\u3059\u3002\u3053\u308c\u304cGUI\u3060\u3068\u3067\u304d\u306a\u3044\u3068\u3044\u3046\u2026\n```\n$ azure vm create \\\n--resource-group oracle \\\n--location japaneast \\\n--storage-account-name sugitkXXXXXXXXXX \\\n--os-type linux \\\n--vm-size Standard_DS2_v2 \\\n--name rac1 \\\n--nic-names rac1_db,rac1_priv \\\n--public-ip-name rac1_public \\\n--image-urn Oracle:Oracle-Linux:6.8:6.8.20161020 \\\n--admin-username oracle \\\n--ssh-publickey-file ~/.ssh/id_rsa.pub \n```\n\n## 2.9. VM\u4f5c\u6210\u5f8c\n\nNIC\u30922\u679a\u523a\u3057\u305f\u3068\u304d\u3001IP\u30a2\u30c9\u30ec\u30b9\u306e\u5272\u308a\u5f53\u3066\u306f\u3055\u308c\u3066\u3044\u308b\u306e\u3067\u3059\u304cOS\u5074\u306b\u306f\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u307e\u305b\u3093\u3002\nifcfg-eth1 \u3092\u66f8\u3044\u3066\u8a2d\u5b9a\u3059\u308b\u5fc5\u8981\u304c\u3042\u308b\u307f\u305f\u3044\u3067\u3059\u3002\n\n```/etc/sysconfig/network-scripts/ifcfg-eth1\nDEVICE=eth1\nONBOOT=yes\nBOOTPROTO=static\nTYPE=Ethernet\nIPADDR=XXX.XXX.XXX.XXX\nNETMASK=255.255.255.0\n```\n\n\u305d\u306e\u4ed6\u3053\u3093\u306a\u3068\u3053\u308d\u306b\u6ce8\u610f\u3059\u3079\u304d\u3060\u3068\u601d\u3044\u307e\u3059\u3002\n\n* \u30b9\u30c8\u30ec\u30fc\u30b8\u30a2\u30ab\u30a6\u30f3\u30c8\u306f GUI \u304b\u3089\u898b\u308b\u3068\u4e0d\u8981\u305d\u3046\u306b\u898b\u3048\u3066\u3057\u307e\u3046\u306e\u3067\u9593\u9055\u3063\u3066\u6d88\u3055\u306a\u3044\u3088\u3046\u306b\u3059\u308b\n* \u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u3092\u8a2d\u5b9a\u3057\u3066 source IP address \u3092\u7d5e\u308b\n* \u8ab2\u91d1\u306e\u3055\u308c\u3059\u304e\u306b\u306f\u6ce8\u610f (\u91cd\u8981\uff01)\n\n# 3. \u30bd\u30d5\u30c8\u30a6\u30a7\u30a2\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n(\u7565)\n\n[\u30de\u30cb\u30e5\u30a2\u30eb](http://docs.oracle.com/database/121/index.htm) \u8aad\u3093\u3067\u304f\u3060\u3055\u3044 :)\n\u4e8b\u524d\u6e96\u5099\u306b\u306f https://github.com/sugitk/ansible-oracle \u3092\u4f7f\u3046\u3068\u697d\u304c\u3067\u304d\u307e\u3059\u3088\u301c\n\n# 4. ~/.ssh/config\n\n\u7c21\u5358\u306b\u63a5\u7d9a\u3067\u304d\u308b\u3088\u3046\u306b ~/.ssh/config \u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n\u7df4\u7fd2\u7528\u306e\u305f\u3081\u306b DNS \u3092\u7acb\u3066\u305f\u308a\u767b\u9332\u3057\u305f\u308a\u3063\u3066\u9762\u5012\u3067\u3059\u3057\u306d\u3002\n\n```\nHost em1\n  HostName xxx.xxx.xxx.xxx\n  user oracle\n  port 22\n\nHost ora1\n  HostName xxx.xxx.xxx.xxx\n  user oracle\n  port 22\n   \nHost ora2\n  HostName xxx.xxx.xxx.xxx\n  user oracle\n  port 22\n\nHost rac1\n  HostName xxx.xxx.xxx.xxx\n  user oracle\n  port 22\n\nHost rac2\n  HostName xxx.xxx.xxx.xxx\n  user oracle\n  port 22\n```\n\n\n"}