{"tags": ["Mautic2.x", "eZPublish4.x, 5.x"], "context": "\n\neZ Mautic \u30a8\u30af\u30b9\u30c6\u30f3\u30b7\u30e7\u30f3\n\u3053\u306e\u8a18\u4e8b\u306f Mautic Advent Calendar 2016 \u306e21\u65e5\u76ee\u306e\u62c5\u5f53\u306b\u306a\u308a\u307e\u3059\u30024\u65e5\u307b\u3069\u9045\u523b\u3057\u3066\u3057\u307e\u3044\u9762\u76ee\u3042\u308a\u307e\u305b\u3093\u3002\n\u672c\u6765\u306f Symfony \u306e Bundle \u3067\u8272\u3005\u6a5f\u80fd\u3092\u3064\u3051\u3066\u4f5c\u6210\u3057\u305f\u304b\u3063\u305f\u306e\u3067\u3059\u304c\u3001\u6642\u9593\u304c\u306a\u304b\u3063\u305f\u305f\u3081\u30ec\u30ac\u30b7\u30fc\u30b9\u30bf\u30c3\u30af\u30d9\u30fc\u30b9\u3067 Mautic \u306e\u30b9\u30cb\u30da\u30c3\u30c8\u3092\u51fa\u529b\u3059\u308b\u30a8\u30af\u30b9\u30c6\u30f3\u30b7\u30e7\u30f3\u3092\u4f5c\u6210\u3057\u307e\u3057\u305f\u3002\neZ Publish 5.x \u306e\u30ec\u30ac\u30b7\u30fc\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u307e\u305f\u306f eZ Publish 4.x \u7528\u306b\u306a\u308a\u307e\u3059\u3002\neZ Platform \u3078\u306e\u5bfe\u5fdc\u3001GitHub \u304a\u3088\u3073 Composer \u3067\u306e\u516c\u958b\u306b\u3064\u3044\u3066\u306f\u8ffd\u3063\u3066\u5bfe\u5fdc\u3057\u305f\u3044\u3068\u601d\u3044\u307e\u3059\u3002\n\n\u4f5c\u308a\u65b9\n\n\u30a8\u30af\u30b9\u30c6\u30f3\u30b7\u30e7\u30f3\u306e\u30d9\u30fc\u30b9\u306e\u4f5c\u6210\n\n\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u30fc\u306e\u4f5c\u6210\nmkdir ezpublish_legacy/extension/ezmautic\n\n\u30ec\u30ac\u30b7\u30fc\u30b9\u30bf\u30c3\u30af\u30d9\u30fc\u30b9\u306e\u30a8\u30af\u30b9\u30c6\u30f3\u30b7\u30e7\u30f3\u306f ezpublish_legacy \u914d\u4e0b\u306e extension \u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u30fc\u306b\u914d\u7f6e\u3057\u307e\u3059\u3002\n\n\u30a8\u30af\u30b9\u30c6\u30f3\u30b7\u30e7\u30f3\u60c5\u5831\u306e\u4f5c\u6210\n\u30a8\u30af\u30b9\u30c6\u30f3\u30b7\u30e7\u30f3\u60c5\u5831\u3068\u3057\u3066\u3001\u30a8\u30af\u30b9\u30c6\u30f3\u30b7\u30e7\u30f3\u306e\u30eb\u30fc\u30c8\u306b extension.xml \u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002 1\n\u3053\u306e\u60c5\u5831\u306f\u7ba1\u7406\u753b\u9762\u306e /ez/ezinfo/about \u3067\u51fa\u529b\u3055\u308c\u307e\u3059\u3002\ncat << \"_EOF_\" > ezpublish_legacy/extension/ezmautic/extension.xml\n<?xml version=\"1.0\" encoding=\"utf-8\" ?>\n<software>\n    <metadata>\n        <name>eZ Mautic</name>\n        <version>0.0.1</version>\n        <copyright>Copyright (C) 2016-2017 Bezeklik Tecnica</copyright>\n        <license>GNU General Public License v2.0</license>\n    </metadata>\n</software>\n_EOF_\n\n\n\u30aa\u30fc\u30c8\u30ed\u30fc\u30c9\u30d5\u30a1\u30a4\u30eb\u306e\u4f5c\u6210\nmkdir extension/ezmautic/autoloads\ncat << \"_EOF_\" > ezpublish_legacy/extension/ezmautic/autoloads/eztemplateautoload.php\n<?php\n$eZTemplateOperatorArray = array();\n$eZTemplateOperatorArray[] = array( 'script' => 'extension/ezmautic/autoloads/ezmautictemplatefunctions.php',\n                                    'class' => 'ezMauticTemplateFunctions',\n                                    'operator_names' => array_keys( ezMauticTemplateFunctions::$operators ) );\n_EOF_\n\n\n\u30af\u30e9\u30b9\u306e\u4f5c\u6210\ncat << \"_EOF_\" > ezpublish_legacy/extension/ezmautic/autoloads/ezmautictemplatefunctions.php\n<?php\nclass ezMauticTemplateFunctions\n{\n    static $operators = array(\n        'ezmautic_script' => array(),\n    );\n\n    function operatorList()\n    {\n        return array_keys( self::$operators );\n    }\n\n    function namedParameterPerOperator()\n    {\n        return true;\n    }\n\n    function namedParameterList()\n    {\n        return self::$operators;\n    }\n\n    function modify( $tpl, $operatorName, $operatorParameters, $rootNamespace, $currentNamespace, &$operatorValue, $namedParameters )\n    {\n        switch ( $operatorName )\n        {\n            case 'ezmautic_script':\n            {\n                $operatorValue = self::getMauticSnippet();\n            } break;\n        }\n    }\n    public static function getMauticSnippet()\n    {\n        return <<< EOS\n<script>\n    (function(w,d,t,u,n,a,m){w['MauticTrackingObject']=n;\n        w[n]=w[n]||function(){(w[n].q=w[n].q||[]).push(arguments)},a=d.createElement(t),\n        m=d.getElementsByTagName(t)[0];a.async=1;a.src=u;m.parentNode.insertBefore(a,m)\n    })(window,document,'script','{$base_url}/mtc.js','mt');\n    mt('send', 'pageview');\n</script>\nEOS;\n    }\n}\n_EOF_\n\n\n\u30a8\u30af\u30b9\u30c6\u30f3\u30b7\u30e7\u30f3\u306e\u6709\u52b9\u5316\n\u7ba1\u7406\u753b\u9762\u306e\u300c\u30b7\u30b9\u30c6\u30e0\u8a2d\u5b9a\u300d\u30bf\u30d6\u306e\u300c\u30a8\u30af\u30b9\u30c6\u30f3\u30b7\u30e7\u30f3\u300d\u3092\u958b\u304d\u3001 \u30ea\u30b9\u30c8\u304b\u3089 ezmautic \u306b\u30c1\u30a7\u30c3\u30af\u3092\u5165\u308c\u3001\u300c\u66f4\u65b0\u300d\u30dc\u30bf\u30f3\u3092\u62bc\u4e0b\u3057\u3066\u30a8\u30af\u30b9\u30c6\u30f3\u30b7\u30e7\u30f3\u3092\u6709\u52b9\u5316\u3001\u305d\u306e\u5f8c\u300c\u30a8\u30af\u30b9\u30c6\u30f3\u30b7\u30e7\u30f3\u7528\u306e\u30aa\u30fc\u30c8\u30fc\u30ed\u30fc\u30c9\u914d\u5217\u306e\u518d\u751f\u6210\u300d\u30dc\u30bf\u30f3\u3092\u62bc\u4e0b\u3057\u3066\u30aa\u30fc\u30c8\u30ed\u30fc\u30c9\u914d\u5217\u3092\u518d\u751f\u6210\u3057\u307e\u3059\u3002\n\n\n\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\n\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u306b\u4ee5\u4e0b\u306e\u30bf\u30b0\u3092\u633f\u5165\u3059\u308b\u3053\u3068\u3067\u30b9\u30cb\u30da\u30c3\u30c8\u304c\u51fa\u529b\u3055\u308c\u307e\u3059\u3002\n{ezmautic_script}\n\n\n\n\n\nhttps://doc.ez.no/eZ-Publish/Technical-manual/4.7/Installation/Extensions/Extension-load-ordering\u00a0\u21a9\n\n\n\n## eZ Mautic \u30a8\u30af\u30b9\u30c6\u30f3\u30b7\u30e7\u30f3\n\u3053\u306e\u8a18\u4e8b\u306f [Mautic Advent Calendar 2016](http://www.adventar.org/calendars/1402) \u306e21\u65e5\u76ee\u306e\u62c5\u5f53\u306b\u306a\u308a\u307e\u3059\u30024\u65e5\u307b\u3069\u9045\u523b\u3057\u3066\u3057\u307e\u3044\u9762\u76ee\u3042\u308a\u307e\u305b\u3093\u3002\n\n\u672c\u6765\u306f Symfony \u306e Bundle \u3067\u8272\u3005\u6a5f\u80fd\u3092\u3064\u3051\u3066\u4f5c\u6210\u3057\u305f\u304b\u3063\u305f\u306e\u3067\u3059\u304c\u3001\u6642\u9593\u304c\u306a\u304b\u3063\u305f\u305f\u3081\u30ec\u30ac\u30b7\u30fc\u30b9\u30bf\u30c3\u30af\u30d9\u30fc\u30b9\u3067 Mautic \u306e\u30b9\u30cb\u30da\u30c3\u30c8\u3092\u51fa\u529b\u3059\u308b\u30a8\u30af\u30b9\u30c6\u30f3\u30b7\u30e7\u30f3\u3092\u4f5c\u6210\u3057\u307e\u3057\u305f\u3002\neZ Publish 5.x \u306e\u30ec\u30ac\u30b7\u30fc\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u307e\u305f\u306f eZ Publish 4.x \u7528\u306b\u306a\u308a\u307e\u3059\u3002\n\neZ Platform \u3078\u306e\u5bfe\u5fdc\u3001GitHub \u304a\u3088\u3073 Composer \u3067\u306e\u516c\u958b\u306b\u3064\u3044\u3066\u306f\u8ffd\u3063\u3066\u5bfe\u5fdc\u3057\u305f\u3044\u3068\u601d\u3044\u307e\u3059\u3002\n\n## \u4f5c\u308a\u65b9\n### \u30a8\u30af\u30b9\u30c6\u30f3\u30b7\u30e7\u30f3\u306e\u30d9\u30fc\u30b9\u306e\u4f5c\u6210\n#### \u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u30fc\u306e\u4f5c\u6210\n```bash\nmkdir ezpublish_legacy/extension/ezmautic\n```\n\u30ec\u30ac\u30b7\u30fc\u30b9\u30bf\u30c3\u30af\u30d9\u30fc\u30b9\u306e\u30a8\u30af\u30b9\u30c6\u30f3\u30b7\u30e7\u30f3\u306f ezpublish_legacy \u914d\u4e0b\u306e extension \u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u30fc\u306b\u914d\u7f6e\u3057\u307e\u3059\u3002\n\n#### \u30a8\u30af\u30b9\u30c6\u30f3\u30b7\u30e7\u30f3\u60c5\u5831\u306e\u4f5c\u6210\n\u30a8\u30af\u30b9\u30c6\u30f3\u30b7\u30e7\u30f3\u60c5\u5831\u3068\u3057\u3066\u3001\u30a8\u30af\u30b9\u30c6\u30f3\u30b7\u30e7\u30f3\u306e\u30eb\u30fc\u30c8\u306b extension.xml \u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002 [^extension-load-ordering]\n\u3053\u306e\u60c5\u5831\u306f\u7ba1\u7406\u753b\u9762\u306e /ez/ezinfo/about \u3067\u51fa\u529b\u3055\u308c\u307e\u3059\u3002\n\n[^extension-load-ordering]: https://doc.ez.no/eZ-Publish/Technical-manual/4.7/Installation/Extensions/Extension-load-ordering\n\n```bash\ncat << \"_EOF_\" > ezpublish_legacy/extension/ezmautic/extension.xml\n<?xml version=\"1.0\" encoding=\"utf-8\" ?>\n<software>\n    <metadata>\n        <name>eZ Mautic</name>\n        <version>0.0.1</version>\n        <copyright>Copyright (C) 2016-2017 Bezeklik Tecnica</copyright>\n        <license>GNU General Public License v2.0</license>\n    </metadata>\n</software>\n_EOF_\n```\n### \u30aa\u30fc\u30c8\u30ed\u30fc\u30c9\u30d5\u30a1\u30a4\u30eb\u306e\u4f5c\u6210\n```bash\nmkdir extension/ezmautic/autoloads\ncat << \"_EOF_\" > ezpublish_legacy/extension/ezmautic/autoloads/eztemplateautoload.php\n<?php\n$eZTemplateOperatorArray = array();\n$eZTemplateOperatorArray[] = array( 'script' => 'extension/ezmautic/autoloads/ezmautictemplatefunctions.php',\n                                    'class' => 'ezMauticTemplateFunctions',\n                                    'operator_names' => array_keys( ezMauticTemplateFunctions::$operators ) );\n_EOF_\n```\n### \u30af\u30e9\u30b9\u306e\u4f5c\u6210\n```bash\ncat << \"_EOF_\" > ezpublish_legacy/extension/ezmautic/autoloads/ezmautictemplatefunctions.php\n<?php\nclass ezMauticTemplateFunctions\n{\n    static $operators = array(\n        'ezmautic_script' => array(),\n    );\n\n    function operatorList()\n    {\n        return array_keys( self::$operators );\n    }\n\n    function namedParameterPerOperator()\n    {\n        return true;\n    }\n\n    function namedParameterList()\n    {\n        return self::$operators;\n    }\n\n    function modify( $tpl, $operatorName, $operatorParameters, $rootNamespace, $currentNamespace, &$operatorValue, $namedParameters )\n    {\n        switch ( $operatorName )\n        {\n            case 'ezmautic_script':\n            {\n                $operatorValue = self::getMauticSnippet();\n            } break;\n        }\n    }\n    public static function getMauticSnippet()\n    {\n        return <<< EOS\n<script>\n    (function(w,d,t,u,n,a,m){w['MauticTrackingObject']=n;\n        w[n]=w[n]||function(){(w[n].q=w[n].q||[]).push(arguments)},a=d.createElement(t),\n        m=d.getElementsByTagName(t)[0];a.async=1;a.src=u;m.parentNode.insertBefore(a,m)\n    })(window,document,'script','{$base_url}/mtc.js','mt');\n    mt('send', 'pageview');\n</script>\nEOS;\n    }\n}\n_EOF_\n```\n## \u30a8\u30af\u30b9\u30c6\u30f3\u30b7\u30e7\u30f3\u306e\u6709\u52b9\u5316\n\u7ba1\u7406\u753b\u9762\u306e\u300c\u30b7\u30b9\u30c6\u30e0\u8a2d\u5b9a\u300d\u30bf\u30d6\u306e\u300c\u30a8\u30af\u30b9\u30c6\u30f3\u30b7\u30e7\u30f3\u300d\u3092\u958b\u304d\u3001 \u30ea\u30b9\u30c8\u304b\u3089 ezmautic \u306b\u30c1\u30a7\u30c3\u30af\u3092\u5165\u308c\u3001\u300c\u66f4\u65b0\u300d\u30dc\u30bf\u30f3\u3092\u62bc\u4e0b\u3057\u3066\u30a8\u30af\u30b9\u30c6\u30f3\u30b7\u30e7\u30f3\u3092\u6709\u52b9\u5316\u3001\u305d\u306e\u5f8c\u300c\u30a8\u30af\u30b9\u30c6\u30f3\u30b7\u30e7\u30f3\u7528\u306e\u30aa\u30fc\u30c8\u30fc\u30ed\u30fc\u30c9\u914d\u5217\u306e\u518d\u751f\u6210\u300d\u30dc\u30bf\u30f3\u3092\u62bc\u4e0b\u3057\u3066\u30aa\u30fc\u30c8\u30ed\u30fc\u30c9\u914d\u5217\u3092\u518d\u751f\u6210\u3057\u307e\u3059\u3002\n\n![extension.png](https://qiita-image-store.s3.amazonaws.com/0/15175/6673092a-6a86-be58-399c-cc8781707774.png)\n\n## \u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\n\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u306b\u4ee5\u4e0b\u306e\u30bf\u30b0\u3092\u633f\u5165\u3059\u308b\u3053\u3068\u3067\u30b9\u30cb\u30da\u30c3\u30c8\u304c\u51fa\u529b\u3055\u308c\u307e\u3059\u3002\n\n```smarty\n{ezmautic_script}\n```\n"}