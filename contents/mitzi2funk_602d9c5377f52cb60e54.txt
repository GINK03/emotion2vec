{"context": " More than 1 year has passed since last update.\n\n\u25a0\u306f\u3058\u3081\u306b\n\n\u25bd\u76ee\u7684\n\n\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u8a3c\u660e\u66f8\u3067\u30a2\u30af\u30bb\u30b9\u5236\u9650\uff01\n\u6982\u8981\n\u30fb\u30b5\u30fc\u30d0\u3084\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u8a8d\u8a3c\u306e\u8a3c\u660e\u66f8\u3092\u767a\u884c\u3059\u308b\u305f\u3081\u3001\u30d7\u30e9\u30a4\u30d9\u30fc\u30c8CA\u3092\u69cb\u7bc9\n\u30fb\u4f5c\u6210\u3057\u305f\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u8a3c\u660e\u66f8(\u30d7\u30e9\u30a4\u30d9\u30fc\u30c8CA\u306e\u7f72\u540d\u4ed8\u304d)\u3092\u5229\u7528\u3057\u3066web\u30b3\u30f3\u30c6\u30f3\u30c4\u3078\u306e\u30a2\u30af\u30bb\u30b9\u3092\u5236\u9650\n\u88dc\u8db3\n\u30fb\u672c\u9805\u3001\u5b9f\u969b\u306b\u79c1\u304c\u5b9f\u88c5\u3057\u305f\u969b\u306e\u624b\u9806\u3092\u8a18\u8f09\u3057\u305f\u3082\u306e\u306b\u306a\u308a\u307e\u3059\u3002\n\u30fb\u516c\u5f0fDocument \u3084 \u5404\u30b3\u30de\u30f3\u30c9\u306e\u30de\u30cb\u30e5\u30a2\u30eb\u7b49\u3092\u8aad\u307f\u8fbc\u307f\u3001\u305d\u3053\u304b\u3089\u624b\u9806\u3092\u8d77\u3053\u3057\u305f\u3002\u3068\u3046\u3044\u308f\u3051\u3067\u306f\u306a\u304f\u30a4\u30f3\u30bf\u30fc\u30cd\u30c3\u30c8\u4e0a\u306e\u60c5\u5831\u3092\u79c1\u306a\u308a\u306b\u6574\u7406\u3057\u305f\u3068\u3044\u3046\u7a0b\u5ea6\u306e\u5185\u5bb9\u306b\u306a\u308a\u307e\u3059\u305f\u3081\u3001\u540c\u3058\u74b0\u5883\u306e\u65b9\u306e\u53c2\u8003\u306b\u306a\u308c\u3070\u5e78\u3044\u3067\u3059\u3002\n\n\u25bd\u4eca\u56de\u306e\u5b9f\u88c5\u74b0\u5883\nCentOS 6.5\nopenssl 1.0.1e\nmod_ssl 2.2.15\napache  2.2.15\n\n\u25a0\u6e96\u5099\n\n\u25bd\u5fc5\u8981\u306a\u30d1\u30c3\u30b1\u30fc\u30b8\nhttpd\nopenssl\nmod_ssl\n\u30fb\u5c0e\u5165\u3057\u3066\u3044\u306a\u3051\u308c\u3070\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n# yum install mod_ssl openssl httpd\n\n\n\u25bdCSR\u60c5\u5831\u3092\u4e8b\u524d\u306b\u78ba\u8a8d\n\u4f8b: \u30d7\u30e9\u30a4\u30d9\u30fc\u30c8\u7528\u306e\u305f\u3081\u4f55\u3067\u3082\u3088\u3044\n\u25a0Country                                  JP\n\u25a0State or Province Name (full name) []:   Tokyo\n\u25a0Locality Name (eg, city) [Default City]: Minato-ku\n\u25a0Organization         company, inc.\n\u25a0Organizational Unit  Technical dept.\n\u25a0Common Name          secure.example.com\n\n\n\u25bd\u5404\u30d1\u30b9\u30d5\u30ec\u30fc\u30ba\u3092\u7528\u610f(\u6574\u7406\u306e\u305f\u3081)\n\u30d7\u30e9\u30a4\u30d9\u30fc\u30c8\u8a8d\u8a3c\u5c40:    passphrase_ca\n\u30b5\u30fc\u30d0\u8a3c\u660e\u66f8:          passphrase_server\n\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u8a3c\u660e\u66f8:    passphrase_client\nPCL12\u30d5\u30a1\u30a4\u30eb\u5c55\u958b\u7528:   passphrase_pcl12\n\n\n\u25a01. \u30d7\u30e9\u30a4\u30d9\u30fc\u30c8CA\u69cb\u7bc9\n\u25a0\u4f5c\u6210\u4e88\u5b9a\u306e\u3082\u306e\n1) /etc/pki/CA/private/cakey.pem : CA\u79d8\u5bc6\u9375\n2) /etc/pki/CA/cacert.pem :        CA\u516c\u958b\u9375 & CA\u8a3c\u660e\u66f8\n\n\u25bd\u30d7\u30e9\u30a4\u30d9\u30fc\u30c8CA\u3092\u69cb\u7bc9\u3059\u308b\u6e96\u50991\uff1aCA\u306e\u7de8\u96c6\n\u203b/etc/pki/tls/misc/CA \u2192 \u8a8d\u8a3c\u5c40\u4f5c\u6210\u304a\u3088\u3073\u5404\u8a3c\u660e\u66f8\u3078\u306e\u7f72\u540d\u306b\u5229\u7528\u3059\u308b\u30b9\u30af\u30ea\u30d7\u30c8\n# cp -p /etc/pki/tls/misc/CA /etc/pki/tls/misc/CA.org\n# vi /etc/pki/tls/misc/CA\n----------\n# \u6709\u52b9\u671f\u9650\u3092\u4f38\u3070\u3059\u3002\u4ee5\u4e0b\u306e\u5024\u30923650(10\u5e74)\u3078\nDAYS=\"-days 365\"    # 1 year\nCADAYS=\"-days 1095\" # 3 years\n\u2193\nDAYS=\"-days 3650\"    # 10 years\nCADAYS=\"-days 3650\" # 10 years\n\n\u203b\u5909\u66f4\u306bsed\u3092\u4f7f\u3063\u3066\u3082\u53ef\nsed -i \"s/365/3650/g\" /etc/pki/tls/openssl.cnf\u3000\u203b\u5f8c\u8ff0\nsed -i \"s/365/3650/g\" /etc/pki/tls/misc/CA\nsed -i \"s/1095/3650/g\" /etc/pki/tls/misc/CA\n\n\n\u25bd\u30d7\u30e9\u30a4\u30d9\u30fc\u30c8CA\u3092\u69cb\u7bc9\u3059\u308b\u6e96\u50992\uff1aopenssl.cnf\u306e\u7de8\u96c6\n\u203b\u3053\u306e\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u306fCA\u306e\u69cb\u7bc9\u4ee5\u5916\u306b\u3082\u3001OpenSSL\u5168\u822c\u306e\u52d5\u4f5c\u306b\u5229\u7528\u3055\u308c\u307e\u3059\u3002\n# cp -p /etc/pki/tls/openssl.cnf /etc/pki/tls/openssl.cnf.org\n# vi /etc/pki/tls/openssl.cnf\n--------------------\n[ CA_default ]\ndefault_days    = 3650                  # how long to certify for\u3000\u2190\u4e0a\u8a18\u3067\u5bfe\u5fdc\u3057\u305f\u5185\u5bb9\n\n[ req_distinguished_name ]\u3000# CSR\u306e\u30c7\u30d5\u30a9\u30eb\u30c8\u60c5\u5831\u3092\u8a2d\u5b9a\u3057\u3066\u304a\u304f(\u4e0a\u8ff0\u306eCSR\u60c5\u5831)\ncountryName_default             = JP\nstateOrProvinceName_default    = Tokyo\nlocalityName_default    = Minato-ku\n0.organizationName_default      = company, inc.\norganizationalUnitName_default = Technical dept.\n\n\u203bcommonName \u306f\u3001\u8a3c\u660e\u66f8\u6bce\u306b\u5909\u3048\u308b\u305f\u3081\u30c7\u30d5\u30a9\u30eb\u30c8\u5024\u3092\u8a2d\u5b9a\u3057\u3066\u3044\u307e\u305b\u3093\n\n\n\u25bd\u30d7\u30e9\u30a4\u30d9\u30fc\u30c8CA\u306e\u69cb\u7bc9\n\u25a0(1) \u8a8d\u8a3c\u5c40(CA)\u7528\u3068\u3057\u3066 openssl\u306e\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3092\u7528\u610f\n# cp -p /etc/pki/tls/openssl.cnf /etc/pki/tls/openssl-ca.cnf\n# vi /etc/pki/tls/openssl-ca.cnf\n-----\n[ usr_cert ]\nbasicConstraints=CA:TRUE  # \u30c7\u30d5\u30a9\u30eb\u30c8\u3067CA\u8a3c\u660e\u66f8\u3068\u3057\u3066\u4f7f\u7528\n\n[ v3_ca ]\nnsCertType = sslCA, emailCA  # \u30c7\u30d5\u30a9\u30eb\u30c8\u3067SSL\u8a8d\u8a3c\u5c40\u3001\u96fb\u5b50\u30e1\u30fc\u30eb\u8a8d\u8a3c\u5c40\u3068\u3059\u308b\n\n\u3000\n\u25a0(2)\u30d7\u30e9\u30a4\u30d9\u30fc\u30c8\u8a8d\u8a3c\u5c40\u306eCA\u8a3c\u660e\u66f8\u3092\u4f5c\u6210\n# cd /etc/pki/tls/\n# CADAYS=\"-days 3650\" SSLEAY_CONFIG=\"-config /etc/pki/tls/openssl-ca.cnf\" /etc/pki/tls/misc/CA -newca\n# \u203b\u4e00\u5fdc\u30b3\u30de\u30f3\u30c9\u306e\u30aa\u30d7\u30b7\u30e7\u30f3\u306b\u6709\u52b9\u671f\u96503650\u65e5\u3092\u6e21\u3057\u3066\u3044\u307e\u3059\u3002\n........+++\nwriting new private key to '/etc/pki/CA/private/./cakey.pem'\nEnter PEM pass phrase:                    # \u30d7\u30e9\u30a4\u30d9\u30fc\u30c8CA\u7528\u306e\u30d1\u30b9\u30d5\u30ec\u30fc\u30ba \nVerifying - Enter PEM pass phrase:        # \u518d\u5165\u529b\n-----\n# CSR\u60c5\u5831\u5165\u529b\u3002\u4e0a\u8a18\u3067\u8a2d\u5b9a\u3057\u305f\u30c7\u30d5\u30a9\u30eb\u30c8([]\u5185\u8868\u793a)\u3067\u826f\u3051\u308c\u3070\u3001\u305d\u306e\u307e\u307eRETURN\nCommon Name (eg, your name or your server's hostname) []: Mitzi Private CA  # CA\u306e\u540d\u524d(\u4efb\u610f)\n-----\nEnter pass phrase for /etc/pki/CA/private/./cakey.pem: # \u5148\u306b\u5165\u529b\u3057\u305f\u30d1\u30b9\u30d5\u30ec\u30fc\u30ba\uff08\u30d1\u30b9\u30ef\u30fc\u30c9\uff09\u3092\u518d\u5165\u529b\n\n#\u8a3c\u660e\u66f8\u306e\u6982\u8981\u304c\u8868\u793a\n\nCertificate is to be certified until Nov 26 14:23:47 2024 GMT (3650 days)\n\nWrite out database with 1 new entries\nData Base Updated\n\n\u3000\n\u30fb\u4f5c\u6210\u3055\u308c\u305f\u30d5\u30a1\u30a4\u30eb\u306e\u78ba\u8a8d\n# ls -1 /etc/pki/CA/*\n/etc/pki/CA/cacert.pem  # CA\u8a3c\u660e\u66f8(CA\u306ecakey.pem \u3067\u7f72\u540d\u3057\u305f\u516c\u958b\u9375)\n/etc/pki/CA/careq.pem   # CA\u306eCSR (CA\u306e\u81ea\u5df1\u7f72\u540d\u3059\u308b\u524d\u306e\u516c\u958b\u9375)\n/etc/pki/CA/index.txt   # CA\u7ba1\u7406\u30d5\u30a1\u30a4\u30eb\uff08\u8a3c\u660e\u66f8\u7ba1\u7406\u60c5\u5831\uff09\n/etc/pki/CA/index.txt.attr  # CA\u7ba1\u7406\u30d5\u30a1\u30a4\u30eb\uff08\u5c5e\u6027\uff09\n/etc/pki/CA/index.txt.old   # CA\u7ba1\u7406\u30d5\u30a1\u30a4\u30eb\uff08\u4e00\u3064\u524d\uff09\n/etc/pki/CA/serial\n\n/etc/pki/CA/certs:   # \u8a3c\u660e\u66f8\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\n\n/etc/pki/CA/client:\u3000# \u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u8a3c\u660e\u66f8\u7528\u306b\u4f5c\u6210\u3057\u305f\u30c7\u30a3\u30ec\u30af\u30c8\u30ea(\u5f8c\u8ff0)\ncerts\nprivate\n\n/etc/pki/CA/crl:\n\n/etc/pki/CA/newcerts:\n973B5D09FC491CC0.pem\n\n/etc/pki/CA/private:  # \u79d8\u5bc6\u9375\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\ncakey.pem             # CA\u79d8\u5bc6\u9375\n\n\n\u25a02.\u30b5\u30fc\u30d0\u30fc\u8a3c\u660e\u66f8\n\n\u25bd(1) \u30b5\u30fc\u30d0\u7528\u306bOpenSSL\u306e\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3092\u7528\u610f\n# cp -p /etc/pki/tls/openssl.cnf /etc/pki/tls/openssl-server.cnf\n# vi /etc/pki/tls/openssl-server.cnf\n-------\n[ usr_cert ]\n...\nbasicConstraints=CA:FALSE # \u30c7\u30d5\u30a9\u30eb\u30c8\u3067CA\u8a3c\u660e\u66f8\u3068\u3057\u3066\u4f7f\u7528\u3057\u307e\u305b\u3093\nnsCertType = server # \u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u30b5\u30fc\u30d0\u30fc\u7528\u8a3c\u660e\u66f8\u3092\u4f5c\u6210\u3057\u307e\u3059\n\n\u3000\n\n\u25bd(2) \u30b5\u30fc\u30d0\u7528\u306e\u8a3c\u660e\u66f8\u3092\u4f5c\u6210\n# cd /etc/pki/tls/\n# DAYS=\"-days 3650\" SSLEAY_CONFIG=\"-config /etc/pki/tls/openssl-server.cnf\" /etc/pki/tls/misc/CA -newreq\n..........+++\nwriting new private key to 'newkey.pem'\nEnter PEM pass phrase:return              # \u30b5\u30fc\u30d0\u30fc\u7528\u306e\u30d1\u30b9\u30d5\u30ec\u30fc\u30ba\uff08\u30d1\u30b9\u30ef\u30fc\u30c9\uff09\u3092\u5165\u529b\nVerifying - Enter PEM pass phrase:\n-----\n\n#CSR\u60c5\u5831\u5165\u529b\nCommon Name (eg, your name or your server's hostname) []: secure.example.com\n-----\nRequest is in newreq.pem, private key is in newkey.pem\n\n# ls -l\nnewkey.pem  # \u30b5\u30a4\u30c8\u7528\u79d8\u5bc6\u9375\nnewreq.pem  # \u30b5\u30a4\u30c8\u7528\u516c\u958b\u9375-\u7f72\u540d\u306a\u3057\uff08CSR\uff09\n\n\u3000\n\n\u25bd(3) \u8a8d\u8a3c\u5c40\u306e\u7f72\u540d\u3092\u5165\u308c\u305f\u30b5\u30fc\u30d0\u30fc\u8a3c\u660e\u66f8\u3092\u4f5c\u6210\n# cd /etc/pki/tls/\n# SSLEAY_CONFIG=\"-config /etc/pki/tls/openssl-server.cnf\" /etc/pki/tls/misc/CA -sign\n------\nEnter pass phrase for /etc/pki/CA/private/cakey.pem: # CA\u8a3c\u660e\u66f8\u3092\u4f5c\u6210\u3059\u308b\u969b\u306b\u8a2d\u5b9a\u3057\u305f\u30d1\u30b9\u30d5\u30ec\u30fc\u30ba\n\n#CSR \u3084 \u4f5c\u6210\u3059\u308b\u8a3c\u660e\u66f8\u306e\u5f62\u5f0f\u304c\u8868\u793a\n\nSign the certificate? [y/n]: y\n1 out of 1 certificate requests certified, commit? [y/n] y\n\n#\u8a3c\u660e\u66f8\u306e\u5185\u5bb9\u304c\u8868\u793a\n\nSigned certificate is in newcert.pem\n\n\u3000\n\u30fb\u78ba\u8a8d(\u4f5c\u6210\u3055\u308c\u305f\u8a3c\u660e\u66f8\u306e)\n# ls -l\nnewcert.pem # \u30b5\u30fc\u30d0\u30fc\u8a3c\u660e\u66f8\uff08\u30d7\u30e9\u30a4\u30d9\u30fc\u30c8\u8a8d\u8a3c\u5c40\u306e\u7f72\u540d\u5165\u308a\uff09\n\n\u3000\n\n\u25bd(4) \u4f5c\u6210\u3057\u305f\u30b5\u30fc\u30d0\u7528\u8a3c\u660e\u66f8\u3092\u79fb\u52d5\n# mv /etc/pki/tls/newcert.pem /etc/pki/CA/certs/secure.example.com.crt\n\n\u3000\n\n\u25bd(5) \u30b5\u30fc\u30d0\u7528\u79d8\u5bc6\u9375\u306b\u30d1\u30b9\u30d5\u30ec\u30fc\u30ba\u57cb\u3081\u8fbc\u307f\n\u203b\u4f5c\u6210\u3057\u305f\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u7528\u8a3c\u660e\u66f8\u3001\u79d8\u5bc6\u9375\u3092\u308f\u304b\u308a\u3084\u3059\u3044\u3088\u3046\u306b\u8a8d\u8a3c\u5c40(CA)\u7ba1\u7406\u4e0b\u306e\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3078\u79fb\u52d5\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n# openssl rsa -in /etc/pki/tls/newkey.pem -out /etc/pki/CA/private/secure.example.com.key\nEnter pass phrase for /etc/pki/tls/newkey.pem:\u3000# \u30b5\u30fc\u30d0\u30fc\u8a3c\u660e\u66f8\u3001\u79d8\u5bc6\u9375\u3092\u4f5c\u6210\u3057\u305f\u3068\u304d\u306e\u30d1\u30b9\u30d5\u30ec\u30fc\u30ba)\nwriting RSA key\n\n\n\u25a03. \u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u8a3c\u660e\u66f8\n\n\u25bd(1) \u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u7528\u306bOpenSSL\u306e\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3092\u7528\u610f\n# cp -p /etc/pki/tls/openssl.cnf /etc/pki/tls/openssl-client.cnf\n# vi /etc/pki/tls/openssl-client.cnf\n----------\n[ usr_cert ]\n...\nbasicConstraints=CA:FALSE # \u30c7\u30d5\u30a9\u30eb\u30c8\u3067CA\u8a3c\u660e\u66f8\u3068\u3057\u3066\u4f7f\u7528\u3057\u307e\u305b\u3093\nnsCertType = client, email, objsign # \u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u7528\u8a3c\u660e\u66f8\u3092\u4f5c\u6210\u3057\u307e\u3059\n...\n\n\u203bnsCertType \u306e \u8a2d\u5b9a\u5185\u5bb9\n  client : \u6587\u5b57\u901a\u308a\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u306e\u610f\u5473\n  email : \u6587\u5b57\u901a\u308a\u30e1\u30fc\u30eb\u306e\u610f\u5473\n  objsign : \u30bd\u30d5\u30c8\u30a6\u30a7\u30a2\u306a\u3069\u306e\u7f72\u540d\u306b\u7528\u3044\u308b\n\u3000\n\n\u25bd(2) \u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u7528\u306e\u8a3c\u660e\u66f8\u4f5c\u6210\n# cd /etc/pki/tls/\n# DAYS=\"-days 3650\" SSLEAY_CONFIG=\"-config /etc/pki/tls/openssl-client.cnf\" /etc/pki/tls/misc/CA -newreq\n-----\nwriting new private key to 'newkey.pem'\nEnter PEM pass phrase: #\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u7528\u306e\u30d1\u30b9\u30d5\u30ec\u30fc\u30ba (\u30d1\u30b9\u30ef\u30fc\u30c9)\n-----\n# CSR\u60c5\u5831\u3092\u5165\u529b\n\nCommon Name (eg, your name or your server's hostname) []:mitzi2funk   # \u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u540d(\u4efb\u610f)\n-----\nRequest is in newreq.pem, private key is in newkey.pem\n\n\u3000\n\u30fb\u78ba\u8a8d(\u4f5c\u6210\u7269\u306e)\n# ls -l\nnewkey.pem  # \u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u7528\u79d8\u5bc6\u9375\nnewreq.pem  # \u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u7528\u516c\u958b\u9375-\u7f72\u540d\u306a\u3057\uff08CSR\uff09\n\n\u3000\n\n\u25bd(3) \u8a8d\u8a3c\u5c40\u306e\u7f72\u540d\u3092\u5165\u308c\u305f\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u8a3c\u660e\u66f8\u3092\u4f5c\u6210\n# cd /etc/pki/tls/\n# SSLEAY_CONFIG=\"-config /etc/pki/tls/openssl-client.cnf\" /etc/pki/tls/misc/CA -sign\n------\nEnter pass phrase for /etc/pki/CA/private/cakey.pem: #CA\u8a3c\u660e\u66f8\u3092\u4f5c\u6210\u3059\u308b\u969b\u306b\u8a2d\u5b9a\u3057\u305f\u30d1\u30b9\u30d5\u30ec\u30fc\u30ba\n\n# CSR \u3084 \u4f5c\u6210\u3059\u308b\u8a3c\u660e\u66f8\u306e\u5f62\u5f0f\u304c\u8868\u793a\n\nSign the certificate? [y/n]: y\n1 out of 1 certificate requests certified, commit? [y/n] y\n\n# \u8a3c\u660e\u66f8\u306e\u5185\u5bb9\u304c\u8868\u793a\n\nSigned certificate is in newcert.pem\n\n\u3000\n\u30fb\u78ba\u8a8d(\u4f5c\u6210\u3055\u308c\u305f\u8a3c\u660e\u66f8\u306e)\n# ls -1\nnewcert.pem # \u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u8a3c\u660e\u66f8\uff08\u30d7\u30e9\u30a4\u30d9\u30fc\u30c8\u8a8d\u8a3c\u5c40\u306e\u7f72\u540d\u5165\u308a\uff09\n\n\u3000\n\n\u25bd(4) \u4f5c\u6210\u3057\u305f\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u7528\u8a3c\u660e\u66f8\u3001\u79d8\u5bc6\u9375\u3092PKCS#12\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u306b\u5909\u63db\n\u30fb\u8a3c\u660e\u66f8\u3068\u79d8\u5bc6\u9375\u3092\uff11\u3064\u306e\u30d5\u30a1\u30a4\u30eb\u306b\u307e\u3068\u3081\u305fPKCS#12\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u306e\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u6210\n# cd /etc/pki/tls/\n# openssl pkcs12 -export -in newcert.pem -inkey newkey.pem -out mitzi2funk.secure.example.com.pfx -name \"secure.example.com\"\n------\nEnter pass phrase for newkey.pem: # \u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u8a3c\u660e\u66f8\u4f5c\u6210\u6642\u306e\u30d1\u30b9\u30d5\u30ec\u30fc\u30ba\nEnter Export Password: # \u4f5c\u6210\u3057\u3066\u3044\u308bPCL12\u30d5\u30a1\u30a4\u30eb\u3092\u5c55\u958b\uff08\u8aad\u307f\u8fbc\u3080\uff09\u3059\u308b\u305f\u3081\u306e\u30d1\u30b9\u30d5\u30ec\u30fc\u30ba\nVerifying - Enter Export Password:\n------\n\u203b-name \"<friendlyname>\" \u306f \u4efb\u610f\u306e\u540d\u524d\u3067OK\u3002\u8b58\u5225\u51fa\u6765\u308b\u540d\u524d\u304c\u826f\u3044\u3002\n\n\u3000\n\n\u25bd(5) \u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u8a3c\u660e\u66f8\u3001\u79d8\u5bc6\u9375\u7b49\u3092\u6574\u7406\n\u203b\u4f5c\u6210\u3057\u305f\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u7528\u8a3c\u660e\u66f8\u3001\u79d8\u5bc6\u9375\u3092\u308f\u304b\u308a\u3084\u3059\u3044\u3088\u3046\u306b\u8a8d\u8a3c\u5c40(CA)\u7ba1\u7406\u4e0b\u306e\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3078\u79fb\u52d5\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n# mkdir -p /etc/pki/CA/client/certs/\n# mkdir -p /etc/pki/CA/client/private/\n\n# mv /etc/pki/tls/newcert.pem /etc/pki/CA/client/certs/mitzi2funk.secure.example.com.crt\n# mv /etc/pki/tls/newreq.pem /etc/pki/CA/client/private/mitzi2funk.secure.example.com.csr\n# mv /etc/pki/tls/newkey.pem /etc/pki/CA/client/private/mitzi2funk.secure.example.com.key\n# mv /etc/pki/tls/mitzi2funk.secure.example.com.pfx /etc/pki/CA/client/private/\n\n\u3000\n\n\u25a04. Apache \u306e \u8a2d\u5b9a\n\u30fb\u4f5c\u6210\u3057\u305f\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u8a3c\u660e\u66f8\u3001\u30b5\u30fc\u30d0\u8a3c\u660e\u66f8\u3092\u5229\u7528\u3057\u3066web\u30b5\u30fc\u30d0\u3078\u306e\u30a2\u30af\u30bb\u30b9\u5236\u9650\u3092\u8a2d\u3051\u308b\n\n\u25bd\u30c6\u30b9\u30c8\u7528\u30b3\u30f3\u30c6\u30f3\u30c4\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u4f5c\u6210\n# mkdir /var/www/html/mitzi\n# chown -R apache.apache cloudpack\n\n\u25bdssl.conf\u306e\u8a2d\u5b9a\n# cp -p /etc/httpd/conf.d/ssl.conf /etc/httpd/conf.d/ssl.conf.org\n# vi /etc/httpd/conf.d/ssl.conf\n--------------------\nDocumentRoot \"/var/www/html/mitzi\"\nServerName secure.example.com:443\n\nSSLCertificateFile /etc/pki/CA/certs/secure.example.com.crt\u3000\u30b5\u30fc\u30d0\u8a3c\u660e\u66f8\nSSLCertificateKeyFile /etc/pki/CA/private/secure.example.com.key\u3000\u30b5\u30fc\u30d0\u79d8\u5bc6\u9375(\u30ce\u30fc\u30d1\u30b9\u30d5\u30ec\u30fc\u30ba)\n\nSSLCACertificateFile /etc/pki/CA/cacert.pem\u3000CA\u8a3c\u660e\u66f8\n\nSSLVerifyClient require\u3000\u2190\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u8a3c\u660e\u66f8\u3092\u8981\u6c42\u3059\u308b\u304b\u306e\u8a2d\u5b9a\nSSLVerifyDepth  10\u3000\u2190\u8a3c\u660e\u66f8\u306e\u30c1\u30a7\u30fc\u30f3\u6570\n\n\u25bdapache\u518d\u8d77\u52d5\n# service httpd configtest\n# service httpd restart\n\n\n\u25a05. \u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u8a3c\u660e\u66f8(pkcs12)\u3092\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u306b\u30a4\u30f3\u30dd\u30fc\u30c8\u3059\u308b\n\n\u25bd(0) \u78ba\u8a8d\u7528\u7aef\u672b\n\u4eca\u56de\u3001\u4ee5\u4e0b\u3092\u5229\u7528\u3057\u3066\u52d5\u4f5c\u78ba\u8a8d\u3057\u3066\u304a\u308a\u307e\u3059\n\u30fbPC(Windows 7)\u306e\u30d6\u30e9\u30a6\u30b6(IE 11\u3001Chrome ver.39\u3001Firefox ver.34))\n\u30fbiPad mini (iOS 7.0.4)\n\n\u25bd(1) \u5404\u7aef\u672b\u306b\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u8a3c\u660e\u66f8(pkcs12)\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3059\u308b\n\u203b\u79c1\u306fDropbox\u3092\u5229\u7528\u3057\u3066\u5404\u7aef\u672b\u306b\u8a3c\u660e\u66f8\u3092\u914d\u5e03\u3057\u307e\u3057\u305f\u3002\n\n\u25bd(2) \u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u8a3c\u660e\u66f8\u3092\u8a2d\u5b9a\n\u25bdPC \u30d6\u30e9\u30a6\u30b6\u306e\u5834\u5408\n\u30fb\u5404\u7aef\u672b\u306bDL\u3057\u305f\u300c***.pfx\u300d\u3092\u30c0\u30d6\u30eb\u30af\u30ea\u30c3\u30af\u3059\u308b\u3068\u3001\u30a4\u30f3\u30dd\u30fc\u30c8\u30a6\u30a3\u30b6\u30fc\u30c9\u304c\u8d77\u52d5\u3059\u308b\u3002\n(IE\u3001Chrome\u3001Safari\u3001iPad mini\u306a\u3069)\n\u30001) \u30a4\u30f3\u30dd\u30fc\u30c8\u3059\u308b\u8a3c\u660e\u66f8\u3092\u9078\u629e\u3057\n\u30002) \u8a3c\u660e\u66f8(pkcs12)\u4f5c\u6210\u6642\u306b\u8a2d\u5b9a\u3057\u305f\u30d1\u30b9\u30ef\u30fc\u30c9\u3092\u5165\u529b\n\u30003) \u300c\u8a3c\u660e\u66f8\u306e\u7a2e\u985e\u306b\u57fa\u3065\u3044\u3066\u3001\u81ea\u52d5\u7684\u306b\u8a3c\u660e\u66f8\u30b9\u30c8\u30a2\u3092\u9078\u629e\u3059\u308b\u300d\u3092\u9078\u629e\n\u25bdiPad mini\u306e\u5834\u5408\n\u300c***.pfx\u300d\u3092\u30c0\u30d6\u30eb\u30af\u30ea\u30c3\u30af\u3059\u308b\u3068\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u4f5c\u696d\u304c\u59cb\u307e\u308b\u3002\n\u5f8c\u306f\u8a3c\u660e\u66f8(pkcs12)\u4f5c\u6210\u6642\u306b\u8a2d\u5b9a\u3057\u305f\u30d1\u30b9\u30ef\u30fc\u30c9\u3092\u5165\u529b\u3059\u308b\u3053\u3068\u3067\u30a4\u30f3\u30dd\u30fc\u30c8\u5b8c\u4e86\n\n\u25bd(3) \u30a4\u30f3\u30dd\u30fc\u30c8\u72b6\u6cc1\u306e\u78ba\u8a8d\n\na) chrome\u306e\u5834\u5408\n\u300cchrome://settings/\u300d -> [HTTPS/SSL]\u306e\u300c\u8a3c\u660e\u66f8\u306e\u7ba1\u7406\u300d\u30dc\u30bf\u30f3\u3092\u62bc\u4e0b\u3002\n  [\u500b\u4eba]\u30bf\u30d6\u53ca\u3073[\u4fe1\u983c\u3055\u308c\u305f\u30eb\u30fc\u30c8\u8a3c\u660e\u6a5f\u95a2]\u30bf\u30d6 \u306b\u8a72\u5f53\u8a3c\u660e\u66f8\u304c\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3002\n\nb) ipad mini\u306e\u5834\u5408\n[\u8a2d\u5b9a] \uff1e [\u4e00\u822c] \uff1e [\u30d7\u30ed\u30d5\u30a1\u30a4\u30eb] \u3088\u308a \u8a3c\u660e\u66f8\u304c\u767b\u9332\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3002\n\n\u25bd(4) \u63a5\u7d9a\u78ba\u8a8d\n\u30b5\u30fc\u30d0\u8a3c\u660e\u66f8\u304a\u3088\u3073 ssl.conf\u3067\u8a2d\u5b9a\u3057\u305f\u4ee5\u4e0b\u30c9\u30e1\u30a4\u30f3\u306b\u3001\n\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u8a3c\u660e\u66f8\u3092\u8a2d\u5b9a\u3057\u305f\u7aef\u672b\u304b\u3089\u306e\u307f\u30a2\u30af\u30bb\u30b9\u51fa\u6765\u308b\u3053\u3068\u3092\u78ba\u8a8d\nhttps://secure.example.com\n\u3000\n\u4ee5\u4e0a\u3067\u672c\u9805\u306e\u76ee\u7684\u9054\u6210\u306b\u306a\u308a\u307e\u3059\u3002\n\n\u304a\u307e\u3051\n\n\u25a06. ELB\u914d\u4e0b\u306eEC2\u3067 \u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u8a8d\u8a3c\u3059\u308b\u5834\u5408\n\n\u25bdELB\u3001EC2\u306e\u8a2d\u5b9a\n\u30fbELB\u3001EC2\u3068\u3082\u306bSecurityGroup\u306b\u3066443\u304b\u3089\u306eInbound\u901a\u4fe1\u3092\u8a31\u53ef\u3059\u308b\n\u30fb[Listeners]\u306b\u3066 IN\u3082OUT\u3082 TCP(443)\u3068\u3059\u308b\n\u30fbhealth check\u3092 [Ping Target] TCP:443 \u3068\u3059\u308b\n\u30fb\u8a72\u5f53\u30b5\u30fc\u30d0\u3092\u30a2\u30bf\u30c3\u30c1\n\n\u25bdELB\u7d4c\u7531\u3067EC2\u3078\u30a2\u30af\u30bb\u30b9\u51fa\u6765\u308b\u3053\u3068\u3092\u78ba\u8a8d\n\u203bDNS\u30ec\u30b3\u30fc\u30c9\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u8a2d\u5b9a\u3057\u3066\u3042\u308b\u3053\u3068\nsecure.example.com TTL IN CNAME <ELB\u306eDNS\u540d>\n\nhttps://secure.example.com\n\n7.\u25a0\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u8a3c\u660e\u66f8\u306e\u5931\u52b9\n\n\u25bd(0) \u306f\u3058\u3081\u306b\n\u30fb\u4e0a\u8a18\u3067\u4f5c\u6210\u3057\u305f\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u8a3c\u660e\u66f8\u3092\u5931\u52b9\u3055\u305b\u307e\u3059\u3002\n\u30fb\u4ee5\u4e0b\u30d5\u30a1\u30a4\u30eb\u304c\u7121\u3051\u308c\u3070\u624b\u52d5\u3067\u4f5c\u6210\u3057\u3066\u304a\u304f\n# echo '00' > /etc/pki/CA/crlnumber\n\n\n\u25bd(1) \u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u8a3c\u660e\u66f8\u306e\u5931\u52b9\n\u30fb\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u8a3c\u660e\u66f8\u306a\u306e\u3067\u3001\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u8a3c\u660e\u66f8\u7528\u306e\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3092\u6307\u5b9a\u3002\u30b5\u30fc\u30d0\u8a3c\u660e\u66f8\u306e\u5834\u5408\u306f\u305d\u308c\u306b\u5fdc\u3058\u3066\u5bfe\u5fdc\n# openssl ca -gencrl -revoke  /etc/pki/CA/client/certs/mitzi2funk.secure.example.com.crt -config /etc/pki/tls/openssl-client.cnf\n...\nEnter pass phrase for /etc/pki/CA/private/cakey.pem:  # CA\u8a3c\u660e\u66f8\u3092\u4f5c\u6210\u3059\u308b\u969b\u306b\u8a2d\u5b9a\u3057\u305f\u30d1\u30b9\u30d5\u30ec\u30fc\u30ba\uff08\u30d1\u30b9\u30ef\u30fc\u30c9\uff09\u3092\u5165\u529b\u3059\u308b\n...\nData Base Updated\n\n\n\u25bd(2) \u5931\u52b9\u8a3c\u660e\u66f8\u30ea\u30b9\u30c8(CRL)\u3092\u66f4\u65b0\n\u30fb\u5931\u52b9\u30ea\u30b9\u30c8\u60c5\u5831\u3092\u51fa\u529b\n# openssl ca -gencrl -out /etc/pki/CA/revoke.crl\n...\nEnter pass phrase for /etc/pki/CA/private/cakey.pem:  # CA\u8a3c\u660e\u66f8\u3092\u4f5c\u6210\u3059\u308b\u969b\u306b\u8a2d\u5b9a\u3057\u305f\u30d1\u30b9\u30d5\u30ec\u30fc\u30ba\uff08\u30d1\u30b9\u30ef\u30fc\u30c9\uff09\u3092\u5165\u529b\u3059\u308b\n\n\n\u25bd(3) apache \u306e SSL\u8a2d\u5b9a\u3092\u884c\u3046\n\u30fb\u5931\u52b9\u8a3c\u660e\u66f8\u30ea\u30b9\u30c8(CRL)\u3092\u6709\u52b9\u306b\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\n# vi /etc/httpd/conf.d/ssl.conf\n----------\nSSLCACertificateFile /etc/pki/CA/cacert.pem \n\nSSLCARevocationFile /etc/pki/CA/revoke.crl # \u5931\u52b9\u8a3c\u660e\u66f8\u30ea\u30b9\u30c8\u306e\u30d1\u30b9\u3092\u6307\u5b9a(CA\u8a3c\u660e\u66f8\u306e\u4e0b\u3042\u305f\u308a\u306b\u8ffd\u8a18)\n\n\u30fb\u53cd\u6620\u306e\u305f\u3081apache\u518d\u8d77\u52d5\n# service httpd configtest\n# service httpd restart\n\n\n\u25bd(4) \u540c\u8a3c\u660e\u66f8\u3092\u8a2d\u5b9a\u3057\u305f\u7aef\u672b\u3088\u308a\u3001\u8a72\u5f53\u30b5\u30a4\u30c8\u306b\u30a2\u30af\u30bb\u30b9\u3001\u63a5\u7d9a\u51fa\u6765\u306a\u3044\u3053\u3068\u3092\u78ba\u8a8d\n\u30fbFirefox\u306e\u5834\u5408\u4ee5\u4e0b\u30a8\u30e9\u30fc\u304c\u8868\u793a\u3055\u308c\u307e\u3057\u305f\u3002\n\u5b89\u5168\u306a\u63a5\u7d9a\u304c\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f\nSSL peer rejected your certificate as revoked.\n(\u30a8\u30e9\u30fc\u30b3\u30fc\u30c9: ssl_error_revoked_cert_alert\n\n\u3000\n\u3000\n\u4ee5\u4e0a\u306b\u306a\u308a\u307e\u3059\u3002\n# \u25a0\u306f\u3058\u3081\u306b\n## \u25bd\u76ee\u7684\n### \u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u8a3c\u660e\u66f8\u3067\u30a2\u30af\u30bb\u30b9\u5236\u9650\uff01\n\n\u6982\u8981\n\u30fb\u30b5\u30fc\u30d0\u3084\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u8a8d\u8a3c\u306e\u8a3c\u660e\u66f8\u3092\u767a\u884c\u3059\u308b\u305f\u3081\u3001\u30d7\u30e9\u30a4\u30d9\u30fc\u30c8CA\u3092\u69cb\u7bc9\n\u30fb\u4f5c\u6210\u3057\u305f\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u8a3c\u660e\u66f8(\u30d7\u30e9\u30a4\u30d9\u30fc\u30c8CA\u306e\u7f72\u540d\u4ed8\u304d)\u3092\u5229\u7528\u3057\u3066web\u30b3\u30f3\u30c6\u30f3\u30c4\u3078\u306e\u30a2\u30af\u30bb\u30b9\u3092\u5236\u9650\n\n\u88dc\u8db3\n\u30fb\u672c\u9805\u3001\u5b9f\u969b\u306b\u79c1\u304c\u5b9f\u88c5\u3057\u305f\u969b\u306e\u624b\u9806\u3092\u8a18\u8f09\u3057\u305f\u3082\u306e\u306b\u306a\u308a\u307e\u3059\u3002\n\u30fb\u516c\u5f0fDocument \u3084 \u5404\u30b3\u30de\u30f3\u30c9\u306e\u30de\u30cb\u30e5\u30a2\u30eb\u7b49\u3092\u8aad\u307f\u8fbc\u307f\u3001\u305d\u3053\u304b\u3089\u624b\u9806\u3092\u8d77\u3053\u3057\u305f\u3002\u3068\u3046\u3044\u308f\u3051\u3067\u306f\u306a\u304f\u30a4\u30f3\u30bf\u30fc\u30cd\u30c3\u30c8\u4e0a\u306e\u60c5\u5831\u3092\u79c1\u306a\u308a\u306b\u6574\u7406\u3057\u305f\u3068\u3044\u3046\u7a0b\u5ea6\u306e\u5185\u5bb9\u306b\u306a\u308a\u307e\u3059\u305f\u3081\u3001\u540c\u3058\u74b0\u5883\u306e\u65b9\u306e\u53c2\u8003\u306b\u306a\u308c\u3070\u5e78\u3044\u3067\u3059\u3002\n\n## \u25bd\u4eca\u56de\u306e\u5b9f\u88c5\u74b0\u5883\nCentOS `6.5`\nopenssl `1.0.1e`\nmod_ssl `2.2.15`\napache  `2.2.15`\n\n# \u25a0\u6e96\u5099\n## \u25bd\u5fc5\u8981\u306a\u30d1\u30c3\u30b1\u30fc\u30b8\nhttpd\nopenssl\nmod_ssl\n\n\u30fb\u5c0e\u5165\u3057\u3066\u3044\u306a\u3051\u308c\u3070\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n```bash\n# yum install mod_ssl openssl httpd\n```\n\n## \u25bdCSR\u60c5\u5831\u3092\u4e8b\u524d\u306b\u78ba\u8a8d\n\n```text\n\u4f8b: \u30d7\u30e9\u30a4\u30d9\u30fc\u30c8\u7528\u306e\u305f\u3081\u4f55\u3067\u3082\u3088\u3044\n\u25a0Country\t\t\t\t\t\t\t\t\tJP\n\u25a0State or Province Name (full name) []:\tTokyo\n\u25a0Locality Name (eg, city) [Default City]:\tMinato-ku\n\u25a0Organization\t\t\tcompany, inc.\n\u25a0Organizational Unit\tTechnical dept.\n\u25a0Common Name\t\t\tsecure.example.com\n```\n\n## \u25bd\u5404\u30d1\u30b9\u30d5\u30ec\u30fc\u30ba\u3092\u7528\u610f(\u6574\u7406\u306e\u305f\u3081)\n\n```text\n\u30d7\u30e9\u30a4\u30d9\u30fc\u30c8\u8a8d\u8a3c\u5c40:    passphrase_ca\n\u30b5\u30fc\u30d0\u8a3c\u660e\u66f8:          passphrase_server\n\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u8a3c\u660e\u66f8:    passphrase_client\nPCL12\u30d5\u30a1\u30a4\u30eb\u5c55\u958b\u7528:   passphrase_pcl12\n```\n\n# \u25a01. \u30d7\u30e9\u30a4\u30d9\u30fc\u30c8CA\u69cb\u7bc9\n\n\u25a0\u4f5c\u6210\u4e88\u5b9a\u306e\u3082\u306e\n1) /etc/pki/CA/private/cakey.pem : CA\u79d8\u5bc6\u9375\n2) /etc/pki/CA/cacert.pem :        CA\u516c\u958b\u9375 & CA\u8a3c\u660e\u66f8\n\n\n## \u25bd\u30d7\u30e9\u30a4\u30d9\u30fc\u30c8CA\u3092\u69cb\u7bc9\u3059\u308b\u6e96\u50991\uff1aCA\u306e\u7de8\u96c6\n\u203b```/etc/pki/tls/misc/CA``` \u2192 \u8a8d\u8a3c\u5c40\u4f5c\u6210\u304a\u3088\u3073\u5404\u8a3c\u660e\u66f8\u3078\u306e\u7f72\u540d\u306b\u5229\u7528\u3059\u308b\u30b9\u30af\u30ea\u30d7\u30c8\n\n```bash\n# cp -p /etc/pki/tls/misc/CA /etc/pki/tls/misc/CA.org\n# vi /etc/pki/tls/misc/CA\n----------\n# \u6709\u52b9\u671f\u9650\u3092\u4f38\u3070\u3059\u3002\u4ee5\u4e0b\u306e\u5024\u30923650(10\u5e74)\u3078\nDAYS=\"-days 365\"    # 1 year\nCADAYS=\"-days 1095\" # 3 years\n\u2193\nDAYS=\"-days 3650\"    # 10 years\nCADAYS=\"-days 3650\" # 10 years\n```\n\n\u203b\u5909\u66f4\u306bsed\u3092\u4f7f\u3063\u3066\u3082\u53ef\n\n```bash\nsed -i \"s/365/3650/g\" /etc/pki/tls/openssl.cnf\u3000\u203b\u5f8c\u8ff0\nsed -i \"s/365/3650/g\" /etc/pki/tls/misc/CA\nsed -i \"s/1095/3650/g\" /etc/pki/tls/misc/CA\n```\n\n## \u25bd\u30d7\u30e9\u30a4\u30d9\u30fc\u30c8CA\u3092\u69cb\u7bc9\u3059\u308b\u6e96\u50992\uff1aopenssl.cnf\u306e\u7de8\u96c6\n\n\u203b\u3053\u306e\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u306fCA\u306e\u69cb\u7bc9\u4ee5\u5916\u306b\u3082\u3001OpenSSL\u5168\u822c\u306e\u52d5\u4f5c\u306b\u5229\u7528\u3055\u308c\u307e\u3059\u3002\n\n```bash\n# cp -p /etc/pki/tls/openssl.cnf /etc/pki/tls/openssl.cnf.org\n# vi /etc/pki/tls/openssl.cnf\n--------------------\n[ CA_default ]\ndefault_days    = 3650                  # how long to certify for\u3000\u2190\u4e0a\u8a18\u3067\u5bfe\u5fdc\u3057\u305f\u5185\u5bb9\n\n[ req_distinguished_name ]\u3000# CSR\u306e\u30c7\u30d5\u30a9\u30eb\u30c8\u60c5\u5831\u3092\u8a2d\u5b9a\u3057\u3066\u304a\u304f(\u4e0a\u8ff0\u306eCSR\u60c5\u5831)\ncountryName_default             = JP\nstateOrProvinceName_default    = Tokyo\nlocalityName_default    = Minato-ku\n0.organizationName_default      = company, inc.\norganizationalUnitName_default = Technical dept.\n\n\u203bcommonName \u306f\u3001\u8a3c\u660e\u66f8\u6bce\u306b\u5909\u3048\u308b\u305f\u3081\u30c7\u30d5\u30a9\u30eb\u30c8\u5024\u3092\u8a2d\u5b9a\u3057\u3066\u3044\u307e\u305b\u3093\n```\n\n## \u25bd\u30d7\u30e9\u30a4\u30d9\u30fc\u30c8CA\u306e\u69cb\u7bc9\n\n\u25a0(1) \u8a8d\u8a3c\u5c40(CA)\u7528\u3068\u3057\u3066 openssl\u306e\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3092\u7528\u610f\n\n```bash\n# cp -p /etc/pki/tls/openssl.cnf /etc/pki/tls/openssl-ca.cnf\n# vi /etc/pki/tls/openssl-ca.cnf\n-----\n[ usr_cert ]\nbasicConstraints=CA:TRUE  # \u30c7\u30d5\u30a9\u30eb\u30c8\u3067CA\u8a3c\u660e\u66f8\u3068\u3057\u3066\u4f7f\u7528\n\n[ v3_ca ]\nnsCertType = sslCA, emailCA  # \u30c7\u30d5\u30a9\u30eb\u30c8\u3067SSL\u8a8d\u8a3c\u5c40\u3001\u96fb\u5b50\u30e1\u30fc\u30eb\u8a8d\u8a3c\u5c40\u3068\u3059\u308b\n```\n\u3000\n\u25a0(2)\u30d7\u30e9\u30a4\u30d9\u30fc\u30c8\u8a8d\u8a3c\u5c40\u306eCA\u8a3c\u660e\u66f8\u3092\u4f5c\u6210\n\n```bash\n# cd /etc/pki/tls/\n# CADAYS=\"-days 3650\" SSLEAY_CONFIG=\"-config /etc/pki/tls/openssl-ca.cnf\" /etc/pki/tls/misc/CA -newca\n# \u203b\u4e00\u5fdc\u30b3\u30de\u30f3\u30c9\u306e\u30aa\u30d7\u30b7\u30e7\u30f3\u306b\u6709\u52b9\u671f\u96503650\u65e5\u3092\u6e21\u3057\u3066\u3044\u307e\u3059\u3002\n........+++\nwriting new private key to '/etc/pki/CA/private/./cakey.pem'\nEnter PEM pass phrase:                    # \u30d7\u30e9\u30a4\u30d9\u30fc\u30c8CA\u7528\u306e\u30d1\u30b9\u30d5\u30ec\u30fc\u30ba \nVerifying - Enter PEM pass phrase:        # \u518d\u5165\u529b\n-----\n# CSR\u60c5\u5831\u5165\u529b\u3002\u4e0a\u8a18\u3067\u8a2d\u5b9a\u3057\u305f\u30c7\u30d5\u30a9\u30eb\u30c8([]\u5185\u8868\u793a)\u3067\u826f\u3051\u308c\u3070\u3001\u305d\u306e\u307e\u307eRETURN\nCommon Name (eg, your name or your server's hostname) []: Mitzi Private CA  # CA\u306e\u540d\u524d(\u4efb\u610f)\n-----\nEnter pass phrase for /etc/pki/CA/private/./cakey.pem: # \u5148\u306b\u5165\u529b\u3057\u305f\u30d1\u30b9\u30d5\u30ec\u30fc\u30ba\uff08\u30d1\u30b9\u30ef\u30fc\u30c9\uff09\u3092\u518d\u5165\u529b\n\n#\u8a3c\u660e\u66f8\u306e\u6982\u8981\u304c\u8868\u793a\n\nCertificate is to be certified until Nov 26 14:23:47 2024 GMT (3650 days)\n\nWrite out database with 1 new entries\nData Base Updated\n```\n\n\u3000\n\u30fb\u4f5c\u6210\u3055\u308c\u305f\u30d5\u30a1\u30a4\u30eb\u306e\u78ba\u8a8d\n\n```bash\n# ls -1 /etc/pki/CA/*\n/etc/pki/CA/cacert.pem  # CA\u8a3c\u660e\u66f8(CA\u306ecakey.pem \u3067\u7f72\u540d\u3057\u305f\u516c\u958b\u9375)\n/etc/pki/CA/careq.pem   # CA\u306eCSR (CA\u306e\u81ea\u5df1\u7f72\u540d\u3059\u308b\u524d\u306e\u516c\u958b\u9375)\n/etc/pki/CA/index.txt   # CA\u7ba1\u7406\u30d5\u30a1\u30a4\u30eb\uff08\u8a3c\u660e\u66f8\u7ba1\u7406\u60c5\u5831\uff09\n/etc/pki/CA/index.txt.attr  # CA\u7ba1\u7406\u30d5\u30a1\u30a4\u30eb\uff08\u5c5e\u6027\uff09\n/etc/pki/CA/index.txt.old   # CA\u7ba1\u7406\u30d5\u30a1\u30a4\u30eb\uff08\u4e00\u3064\u524d\uff09\n/etc/pki/CA/serial\n\n/etc/pki/CA/certs:   # \u8a3c\u660e\u66f8\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\n\n/etc/pki/CA/client:\u3000# \u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u8a3c\u660e\u66f8\u7528\u306b\u4f5c\u6210\u3057\u305f\u30c7\u30a3\u30ec\u30af\u30c8\u30ea(\u5f8c\u8ff0)\ncerts\nprivate\n\n/etc/pki/CA/crl:\n\n/etc/pki/CA/newcerts:\n973B5D09FC491CC0.pem\n\n/etc/pki/CA/private:  # \u79d8\u5bc6\u9375\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\ncakey.pem             # CA\u79d8\u5bc6\u9375\n```\n\n# \u25a02.\u30b5\u30fc\u30d0\u30fc\u8a3c\u660e\u66f8\n## \u25bd(1) \u30b5\u30fc\u30d0\u7528\u306bOpenSSL\u306e\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3092\u7528\u610f\n```bash\n# cp -p /etc/pki/tls/openssl.cnf /etc/pki/tls/openssl-server.cnf\n# vi /etc/pki/tls/openssl-server.cnf\n-------\n[ usr_cert ]\n...\nbasicConstraints=CA:FALSE # \u30c7\u30d5\u30a9\u30eb\u30c8\u3067CA\u8a3c\u660e\u66f8\u3068\u3057\u3066\u4f7f\u7528\u3057\u307e\u305b\u3093\nnsCertType = server # \u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u30b5\u30fc\u30d0\u30fc\u7528\u8a3c\u660e\u66f8\u3092\u4f5c\u6210\u3057\u307e\u3059\n```\n\u3000\n## \u25bd(2) \u30b5\u30fc\u30d0\u7528\u306e\u8a3c\u660e\u66f8\u3092\u4f5c\u6210\n```bash\n# cd /etc/pki/tls/\n# DAYS=\"-days 3650\" SSLEAY_CONFIG=\"-config /etc/pki/tls/openssl-server.cnf\" /etc/pki/tls/misc/CA -newreq\n..........+++\nwriting new private key to 'newkey.pem'\nEnter PEM pass phrase:return              # \u30b5\u30fc\u30d0\u30fc\u7528\u306e\u30d1\u30b9\u30d5\u30ec\u30fc\u30ba\uff08\u30d1\u30b9\u30ef\u30fc\u30c9\uff09\u3092\u5165\u529b\nVerifying - Enter PEM pass phrase:\n-----\n\n#CSR\u60c5\u5831\u5165\u529b\nCommon Name (eg, your name or your server's hostname) []: secure.example.com\n-----\nRequest is in newreq.pem, private key is in newkey.pem\n```\n\n```bash\n# ls -l\nnewkey.pem  # \u30b5\u30a4\u30c8\u7528\u79d8\u5bc6\u9375\nnewreq.pem  # \u30b5\u30a4\u30c8\u7528\u516c\u958b\u9375-\u7f72\u540d\u306a\u3057\uff08CSR\uff09\n```\n\u3000\n## \u25bd(3) \u8a8d\u8a3c\u5c40\u306e\u7f72\u540d\u3092\u5165\u308c\u305f\u30b5\u30fc\u30d0\u30fc\u8a3c\u660e\u66f8\u3092\u4f5c\u6210\n```bash \n# cd /etc/pki/tls/\n# SSLEAY_CONFIG=\"-config /etc/pki/tls/openssl-server.cnf\" /etc/pki/tls/misc/CA -sign\n------\nEnter pass phrase for /etc/pki/CA/private/cakey.pem: # CA\u8a3c\u660e\u66f8\u3092\u4f5c\u6210\u3059\u308b\u969b\u306b\u8a2d\u5b9a\u3057\u305f\u30d1\u30b9\u30d5\u30ec\u30fc\u30ba\n\n#CSR \u3084 \u4f5c\u6210\u3059\u308b\u8a3c\u660e\u66f8\u306e\u5f62\u5f0f\u304c\u8868\u793a\n\nSign the certificate? [y/n]: y\n1 out of 1 certificate requests certified, commit? [y/n] y\n\n#\u8a3c\u660e\u66f8\u306e\u5185\u5bb9\u304c\u8868\u793a\n\nSigned certificate is in newcert.pem\n```\n\u3000\n\u30fb\u78ba\u8a8d(\u4f5c\u6210\u3055\u308c\u305f\u8a3c\u660e\u66f8\u306e)\n\n```bash \n# ls -l\nnewcert.pem # \u30b5\u30fc\u30d0\u30fc\u8a3c\u660e\u66f8\uff08\u30d7\u30e9\u30a4\u30d9\u30fc\u30c8\u8a8d\u8a3c\u5c40\u306e\u7f72\u540d\u5165\u308a\uff09\n```\n\u3000\n## \u25bd(4) \u4f5c\u6210\u3057\u305f\u30b5\u30fc\u30d0\u7528\u8a3c\u660e\u66f8\u3092\u79fb\u52d5\n```bash \n# mv /etc/pki/tls/newcert.pem /etc/pki/CA/certs/secure.example.com.crt\n```\n\u3000\n## \u25bd(5) \u30b5\u30fc\u30d0\u7528\u79d8\u5bc6\u9375\u306b\u30d1\u30b9\u30d5\u30ec\u30fc\u30ba\u57cb\u3081\u8fbc\u307f\n\u203b\u4f5c\u6210\u3057\u305f\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u7528\u8a3c\u660e\u66f8\u3001\u79d8\u5bc6\u9375\u3092\u308f\u304b\u308a\u3084\u3059\u3044\u3088\u3046\u306b\u8a8d\u8a3c\u5c40(CA)\u7ba1\u7406\u4e0b\u306e\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3078\u79fb\u52d5\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n\n```bash \n# openssl rsa -in /etc/pki/tls/newkey.pem -out /etc/pki/CA/private/secure.example.com.key\nEnter pass phrase for /etc/pki/tls/newkey.pem:\u3000# \u30b5\u30fc\u30d0\u30fc\u8a3c\u660e\u66f8\u3001\u79d8\u5bc6\u9375\u3092\u4f5c\u6210\u3057\u305f\u3068\u304d\u306e\u30d1\u30b9\u30d5\u30ec\u30fc\u30ba)\nwriting RSA key\n```\n\n# \u25a03. \u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u8a3c\u660e\u66f8\n## \u25bd(1) \u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u7528\u306bOpenSSL\u306e\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3092\u7528\u610f\n```bash \n# cp -p /etc/pki/tls/openssl.cnf /etc/pki/tls/openssl-client.cnf\n# vi /etc/pki/tls/openssl-client.cnf\n----------\n[ usr_cert ]\n...\nbasicConstraints=CA:FALSE # \u30c7\u30d5\u30a9\u30eb\u30c8\u3067CA\u8a3c\u660e\u66f8\u3068\u3057\u3066\u4f7f\u7528\u3057\u307e\u305b\u3093\nnsCertType = client, email, objsign # \u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u7528\u8a3c\u660e\u66f8\u3092\u4f5c\u6210\u3057\u307e\u3059\n...\n```\n\u203bnsCertType \u306e \u8a2d\u5b9a\u5185\u5bb9\n  client : \u6587\u5b57\u901a\u308a\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u306e\u610f\u5473\n  email : \u6587\u5b57\u901a\u308a\u30e1\u30fc\u30eb\u306e\u610f\u5473\n  objsign : \u30bd\u30d5\u30c8\u30a6\u30a7\u30a2\u306a\u3069\u306e\u7f72\u540d\u306b\u7528\u3044\u308b\n\n\u3000\n## \u25bd(2) \u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u7528\u306e\u8a3c\u660e\u66f8\u4f5c\u6210\n```bash \n# cd /etc/pki/tls/\n# DAYS=\"-days 3650\" SSLEAY_CONFIG=\"-config /etc/pki/tls/openssl-client.cnf\" /etc/pki/tls/misc/CA -newreq\n-----\nwriting new private key to 'newkey.pem'\nEnter PEM pass phrase: #\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u7528\u306e\u30d1\u30b9\u30d5\u30ec\u30fc\u30ba (\u30d1\u30b9\u30ef\u30fc\u30c9)\n-----\n# CSR\u60c5\u5831\u3092\u5165\u529b\n\nCommon Name (eg, your name or your server's hostname) []:mitzi2funk   # \u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u540d(\u4efb\u610f)\n-----\nRequest is in newreq.pem, private key is in newkey.pem\n```\n\u3000\n\u30fb\u78ba\u8a8d(\u4f5c\u6210\u7269\u306e)\n\n```bash\n# ls -l\nnewkey.pem  # \u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u7528\u79d8\u5bc6\u9375\nnewreq.pem  # \u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u7528\u516c\u958b\u9375-\u7f72\u540d\u306a\u3057\uff08CSR\uff09\n```\n\u3000\n## \u25bd(3) \u8a8d\u8a3c\u5c40\u306e\u7f72\u540d\u3092\u5165\u308c\u305f\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u8a3c\u660e\u66f8\u3092\u4f5c\u6210\n```bash\n# cd /etc/pki/tls/\n# SSLEAY_CONFIG=\"-config /etc/pki/tls/openssl-client.cnf\" /etc/pki/tls/misc/CA -sign\n------\nEnter pass phrase for /etc/pki/CA/private/cakey.pem: #CA\u8a3c\u660e\u66f8\u3092\u4f5c\u6210\u3059\u308b\u969b\u306b\u8a2d\u5b9a\u3057\u305f\u30d1\u30b9\u30d5\u30ec\u30fc\u30ba\n\n# CSR \u3084 \u4f5c\u6210\u3059\u308b\u8a3c\u660e\u66f8\u306e\u5f62\u5f0f\u304c\u8868\u793a\n\nSign the certificate? [y/n]: y\n1 out of 1 certificate requests certified, commit? [y/n] y\n\n# \u8a3c\u660e\u66f8\u306e\u5185\u5bb9\u304c\u8868\u793a\n\nSigned certificate is in newcert.pem\n```\n\u3000\n\u30fb\u78ba\u8a8d(\u4f5c\u6210\u3055\u308c\u305f\u8a3c\u660e\u66f8\u306e)\n\n```bash\n# ls -1\nnewcert.pem # \u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u8a3c\u660e\u66f8\uff08\u30d7\u30e9\u30a4\u30d9\u30fc\u30c8\u8a8d\u8a3c\u5c40\u306e\u7f72\u540d\u5165\u308a\uff09\n```\n\u3000\n## \u25bd(4) \u4f5c\u6210\u3057\u305f\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u7528\u8a3c\u660e\u66f8\u3001\u79d8\u5bc6\u9375\u3092PKCS#12\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u306b\u5909\u63db\n\u30fb\u8a3c\u660e\u66f8\u3068\u79d8\u5bc6\u9375\u3092\uff11\u3064\u306e\u30d5\u30a1\u30a4\u30eb\u306b\u307e\u3068\u3081\u305fPKCS#12\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u306e\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u6210\n\n```bash\n# cd /etc/pki/tls/\n# openssl pkcs12 -export -in newcert.pem -inkey newkey.pem -out mitzi2funk.secure.example.com.pfx -name \"secure.example.com\"\n------\nEnter pass phrase for newkey.pem: # \u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u8a3c\u660e\u66f8\u4f5c\u6210\u6642\u306e\u30d1\u30b9\u30d5\u30ec\u30fc\u30ba\nEnter Export Password: # \u4f5c\u6210\u3057\u3066\u3044\u308bPCL12\u30d5\u30a1\u30a4\u30eb\u3092\u5c55\u958b\uff08\u8aad\u307f\u8fbc\u3080\uff09\u3059\u308b\u305f\u3081\u306e\u30d1\u30b9\u30d5\u30ec\u30fc\u30ba\nVerifying - Enter Export Password:\n------\n\u203b-name \"<friendlyname>\" \u306f \u4efb\u610f\u306e\u540d\u524d\u3067OK\u3002\u8b58\u5225\u51fa\u6765\u308b\u540d\u524d\u304c\u826f\u3044\u3002\n```\n\u3000\n## \u25bd(5) \u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u8a3c\u660e\u66f8\u3001\u79d8\u5bc6\u9375\u7b49\u3092\u6574\u7406\n\u203b\u4f5c\u6210\u3057\u305f\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u7528\u8a3c\u660e\u66f8\u3001\u79d8\u5bc6\u9375\u3092\u308f\u304b\u308a\u3084\u3059\u3044\u3088\u3046\u306b\u8a8d\u8a3c\u5c40(CA)\u7ba1\u7406\u4e0b\u306e\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3078\u79fb\u52d5\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n\n```bash\n# mkdir -p /etc/pki/CA/client/certs/\n# mkdir -p /etc/pki/CA/client/private/\n\n# mv /etc/pki/tls/newcert.pem /etc/pki/CA/client/certs/mitzi2funk.secure.example.com.crt\n# mv /etc/pki/tls/newreq.pem /etc/pki/CA/client/private/mitzi2funk.secure.example.com.csr\n# mv /etc/pki/tls/newkey.pem /etc/pki/CA/client/private/mitzi2funk.secure.example.com.key\n# mv /etc/pki/tls/mitzi2funk.secure.example.com.pfx /etc/pki/CA/client/private/\n```\n\u3000\n# \u25a04. Apache \u306e \u8a2d\u5b9a\n\u30fb\u4f5c\u6210\u3057\u305f\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u8a3c\u660e\u66f8\u3001\u30b5\u30fc\u30d0\u8a3c\u660e\u66f8\u3092\u5229\u7528\u3057\u3066web\u30b5\u30fc\u30d0\u3078\u306e\u30a2\u30af\u30bb\u30b9\u5236\u9650\u3092\u8a2d\u3051\u308b\n\n## \u25bd\u30c6\u30b9\u30c8\u7528\u30b3\u30f3\u30c6\u30f3\u30c4\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u4f5c\u6210\n\n```bash\n# mkdir /var/www/html/mitzi\n# chown -R apache.apache cloudpack\n```\n\n\u25bdssl.conf\u306e\u8a2d\u5b9a\n\n```bash\n# cp -p /etc/httpd/conf.d/ssl.conf /etc/httpd/conf.d/ssl.conf.org\n# vi /etc/httpd/conf.d/ssl.conf\n--------------------\nDocumentRoot \"/var/www/html/mitzi\"\nServerName secure.example.com:443\n\nSSLCertificateFile /etc/pki/CA/certs/secure.example.com.crt\u3000\u30b5\u30fc\u30d0\u8a3c\u660e\u66f8\nSSLCertificateKeyFile /etc/pki/CA/private/secure.example.com.key\u3000\u30b5\u30fc\u30d0\u79d8\u5bc6\u9375(\u30ce\u30fc\u30d1\u30b9\u30d5\u30ec\u30fc\u30ba)\n\nSSLCACertificateFile /etc/pki/CA/cacert.pem\u3000CA\u8a3c\u660e\u66f8\n\nSSLVerifyClient require\u3000\u2190\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u8a3c\u660e\u66f8\u3092\u8981\u6c42\u3059\u308b\u304b\u306e\u8a2d\u5b9a\nSSLVerifyDepth  10\u3000\u2190\u8a3c\u660e\u66f8\u306e\u30c1\u30a7\u30fc\u30f3\u6570\n```\n\n\u25bdapache\u518d\u8d77\u52d5\n\n```bash \n# service httpd configtest\n# service httpd restart\n```\n\n# \u25a05. \u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u8a3c\u660e\u66f8(pkcs12)\u3092\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u306b\u30a4\u30f3\u30dd\u30fc\u30c8\u3059\u308b\n\n## \u25bd(0) \u78ba\u8a8d\u7528\u7aef\u672b\n\u4eca\u56de\u3001\u4ee5\u4e0b\u3092\u5229\u7528\u3057\u3066\u52d5\u4f5c\u78ba\u8a8d\u3057\u3066\u304a\u308a\u307e\u3059\n\n\u30fbPC(Windows 7)\u306e\u30d6\u30e9\u30a6\u30b6(IE 11\u3001Chrome ver.39\u3001Firefox ver.34))\n\u30fbiPad mini (iOS 7.0.4)\n\n## \u25bd(1) \u5404\u7aef\u672b\u306b\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u8a3c\u660e\u66f8(pkcs12)\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3059\u308b\n\u203b\u79c1\u306fDropbox\u3092\u5229\u7528\u3057\u3066\u5404\u7aef\u672b\u306b\u8a3c\u660e\u66f8\u3092\u914d\u5e03\u3057\u307e\u3057\u305f\u3002\n\n## \u25bd(2) \u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u8a3c\u660e\u66f8\u3092\u8a2d\u5b9a\n\n\u25bdPC \u30d6\u30e9\u30a6\u30b6\u306e\u5834\u5408\n\u30fb\u5404\u7aef\u672b\u306bDL\u3057\u305f\u300c***.pfx\u300d\u3092\u30c0\u30d6\u30eb\u30af\u30ea\u30c3\u30af\u3059\u308b\u3068\u3001\u30a4\u30f3\u30dd\u30fc\u30c8\u30a6\u30a3\u30b6\u30fc\u30c9\u304c\u8d77\u52d5\u3059\u308b\u3002\n(IE\u3001Chrome\u3001Safari\u3001iPad mini\u306a\u3069)\n\n\u30001) \u30a4\u30f3\u30dd\u30fc\u30c8\u3059\u308b\u8a3c\u660e\u66f8\u3092\u9078\u629e\u3057\n\u30002) \u8a3c\u660e\u66f8(pkcs12)\u4f5c\u6210\u6642\u306b\u8a2d\u5b9a\u3057\u305f\u30d1\u30b9\u30ef\u30fc\u30c9\u3092\u5165\u529b\n\u30003) \u300c\u8a3c\u660e\u66f8\u306e\u7a2e\u985e\u306b\u57fa\u3065\u3044\u3066\u3001\u81ea\u52d5\u7684\u306b\u8a3c\u660e\u66f8\u30b9\u30c8\u30a2\u3092\u9078\u629e\u3059\u308b\u300d\u3092\u9078\u629e\n\n\u25bdiPad mini\u306e\u5834\u5408\n\u300c***.pfx\u300d\u3092\u30c0\u30d6\u30eb\u30af\u30ea\u30c3\u30af\u3059\u308b\u3068\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u4f5c\u696d\u304c\u59cb\u307e\u308b\u3002\n\u5f8c\u306f\u8a3c\u660e\u66f8(pkcs12)\u4f5c\u6210\u6642\u306b\u8a2d\u5b9a\u3057\u305f\u30d1\u30b9\u30ef\u30fc\u30c9\u3092\u5165\u529b\u3059\u308b\u3053\u3068\u3067\u30a4\u30f3\u30dd\u30fc\u30c8\u5b8c\u4e86\n\n## \u25bd(3) \u30a4\u30f3\u30dd\u30fc\u30c8\u72b6\u6cc1\u306e\u78ba\u8a8d\n### a) chrome\u306e\u5834\u5408\n\u300cchrome://settings/\u300d -> [HTTPS/SSL]\u306e\u300c\u8a3c\u660e\u66f8\u306e\u7ba1\u7406\u300d\u30dc\u30bf\u30f3\u3092\u62bc\u4e0b\u3002\n  [\u500b\u4eba]\u30bf\u30d6\u53ca\u3073[\u4fe1\u983c\u3055\u308c\u305f\u30eb\u30fc\u30c8\u8a3c\u660e\u6a5f\u95a2]\u30bf\u30d6 \u306b\u8a72\u5f53\u8a3c\u660e\u66f8\u304c\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3002\n\n### b) ipad mini\u306e\u5834\u5408\n[\u8a2d\u5b9a] \uff1e [\u4e00\u822c] \uff1e [\u30d7\u30ed\u30d5\u30a1\u30a4\u30eb] \u3088\u308a \u8a3c\u660e\u66f8\u304c\u767b\u9332\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3002\n\n## \u25bd(4) \u63a5\u7d9a\u78ba\u8a8d\n\u30b5\u30fc\u30d0\u8a3c\u660e\u66f8\u304a\u3088\u3073 ssl.conf\u3067\u8a2d\u5b9a\u3057\u305f\u4ee5\u4e0b\u30c9\u30e1\u30a4\u30f3\u306b\u3001\n\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u8a3c\u660e\u66f8\u3092\u8a2d\u5b9a\u3057\u305f\u7aef\u672b\u304b\u3089\u306e\u307f\u30a2\u30af\u30bb\u30b9\u51fa\u6765\u308b\u3053\u3068\u3092\u78ba\u8a8d\nhttps://secure.example.com\n\n\u3000\n\u4ee5\u4e0a\u3067\u672c\u9805\u306e\u76ee\u7684\u9054\u6210\u306b\u306a\u308a\u307e\u3059\u3002\n******\n\u304a\u307e\u3051\n# \u25a06. ELB\u914d\u4e0b\u306eEC2\u3067 \u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u8a8d\u8a3c\u3059\u308b\u5834\u5408\n\n## \u25bdELB\u3001EC2\u306e\u8a2d\u5b9a\n\u30fbELB\u3001EC2\u3068\u3082\u306bSecurityGroup\u306b\u3066443\u304b\u3089\u306eInbound\u901a\u4fe1\u3092\u8a31\u53ef\u3059\u308b\n\u30fb[Listeners]\u306b\u3066 IN\u3082OUT\u3082 TCP(443)\u3068\u3059\u308b\n\u30fbhealth check\u3092 [Ping Target] TCP:443 \u3068\u3059\u308b\n\u30fb\u8a72\u5f53\u30b5\u30fc\u30d0\u3092\u30a2\u30bf\u30c3\u30c1\n\n## \u25bdELB\u7d4c\u7531\u3067EC2\u3078\u30a2\u30af\u30bb\u30b9\u51fa\u6765\u308b\u3053\u3068\u3092\u78ba\u8a8d\n\u203bDNS\u30ec\u30b3\u30fc\u30c9\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u8a2d\u5b9a\u3057\u3066\u3042\u308b\u3053\u3068\n\n```\nsecure.example.com TTL IN CNAME <ELB\u306eDNS\u540d>\n```\n\nhttps://secure.example.com\n\n\n# 7.\u25a0\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u8a3c\u660e\u66f8\u306e\u5931\u52b9\n## \u25bd(0) \u306f\u3058\u3081\u306b\n\u30fb\u4e0a\u8a18\u3067\u4f5c\u6210\u3057\u305f\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u8a3c\u660e\u66f8\u3092\u5931\u52b9\u3055\u305b\u307e\u3059\u3002\n\n\u30fb\u4ee5\u4e0b\u30d5\u30a1\u30a4\u30eb\u304c\u7121\u3051\u308c\u3070\u624b\u52d5\u3067\u4f5c\u6210\u3057\u3066\u304a\u304f\n\n```bash \n# echo '00' > /etc/pki/CA/crlnumber\n```\n\n## \u25bd(1) \u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u8a3c\u660e\u66f8\u306e\u5931\u52b9\n\u30fb\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u8a3c\u660e\u66f8\u306a\u306e\u3067\u3001\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u8a3c\u660e\u66f8\u7528\u306e\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3092\u6307\u5b9a\u3002\u30b5\u30fc\u30d0\u8a3c\u660e\u66f8\u306e\u5834\u5408\u306f\u305d\u308c\u306b\u5fdc\u3058\u3066\u5bfe\u5fdc\n\n```bash \n# openssl ca -gencrl -revoke  /etc/pki/CA/client/certs/mitzi2funk.secure.example.com.crt -config /etc/pki/tls/openssl-client.cnf\n...\nEnter pass phrase for /etc/pki/CA/private/cakey.pem:  # CA\u8a3c\u660e\u66f8\u3092\u4f5c\u6210\u3059\u308b\u969b\u306b\u8a2d\u5b9a\u3057\u305f\u30d1\u30b9\u30d5\u30ec\u30fc\u30ba\uff08\u30d1\u30b9\u30ef\u30fc\u30c9\uff09\u3092\u5165\u529b\u3059\u308b\n...\nData Base Updated\n```\n\n## \u25bd(2) \u5931\u52b9\u8a3c\u660e\u66f8\u30ea\u30b9\u30c8(CRL)\u3092\u66f4\u65b0\n\n```bash \n\u30fb\u5931\u52b9\u30ea\u30b9\u30c8\u60c5\u5831\u3092\u51fa\u529b\n# openssl ca -gencrl -out /etc/pki/CA/revoke.crl\n...\nEnter pass phrase for /etc/pki/CA/private/cakey.pem:  # CA\u8a3c\u660e\u66f8\u3092\u4f5c\u6210\u3059\u308b\u969b\u306b\u8a2d\u5b9a\u3057\u305f\u30d1\u30b9\u30d5\u30ec\u30fc\u30ba\uff08\u30d1\u30b9\u30ef\u30fc\u30c9\uff09\u3092\u5165\u529b\u3059\u308b\n```\n\n## \u25bd(3) apache \u306e SSL\u8a2d\u5b9a\u3092\u884c\u3046\n\u30fb\u5931\u52b9\u8a3c\u660e\u66f8\u30ea\u30b9\u30c8(CRL)\u3092\u6709\u52b9\u306b\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\n\n```bash\n# vi /etc/httpd/conf.d/ssl.conf\n----------\nSSLCACertificateFile /etc/pki/CA/cacert.pem \n\nSSLCARevocationFile /etc/pki/CA/revoke.crl # \u5931\u52b9\u8a3c\u660e\u66f8\u30ea\u30b9\u30c8\u306e\u30d1\u30b9\u3092\u6307\u5b9a(CA\u8a3c\u660e\u66f8\u306e\u4e0b\u3042\u305f\u308a\u306b\u8ffd\u8a18)\n```\n\n\u30fb\u53cd\u6620\u306e\u305f\u3081apache\u518d\u8d77\u52d5\n\n```bash\n# service httpd configtest\n# service httpd restart\n```\n\n## \u25bd(4) \u540c\u8a3c\u660e\u66f8\u3092\u8a2d\u5b9a\u3057\u305f\u7aef\u672b\u3088\u308a\u3001\u8a72\u5f53\u30b5\u30a4\u30c8\u306b\u30a2\u30af\u30bb\u30b9\u3001\u63a5\u7d9a\u51fa\u6765\u306a\u3044\u3053\u3068\u3092\u78ba\u8a8d\n\n\u30fbFirefox\u306e\u5834\u5408\u4ee5\u4e0b\u30a8\u30e9\u30fc\u304c\u8868\u793a\u3055\u308c\u307e\u3057\u305f\u3002\n\n```text\n\u5b89\u5168\u306a\u63a5\u7d9a\u304c\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f\nSSL peer rejected your certificate as revoked.\n(\u30a8\u30e9\u30fc\u30b3\u30fc\u30c9: ssl_error_revoked_cert_alert\n```\n\u3000\n\u3000\n\u4ee5\u4e0a\u306b\u306a\u308a\u307e\u3059\u3002\n", "tags": ["openssl1.0.1e", "CentOS6.56.5", "mod_ssl2.2.15", "Apache2.2.15"]}