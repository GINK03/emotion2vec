{"context": "\u901a\u5e38\u306f.htaccess\u3067\u30ea\u30c0\u30a4\u30ec\u30af\u30c8\u3055\u305b\u308b\u306e\u304c\u826f\u3044\u306e\u3067\u3059\u304c\u3001\u4f55\u6545\u304b\u4e0a\u624b\u304f\u884c\u304b\u306a\u304f\u3066\u30d5\u30ec\u30fc\u30e0\u30ef\u30fc\u30af\u5074\u3067\u30ea\u30c0\u30a4\u30ec\u30af\u30c8\u3055\u305b\u307e\u3057\u305f\u3002\n\n\u30d7\u30ed\u30b0\u30e9\u30e0\nMiddleware\u3092\u65b0\u305f\u306b\u8ffd\u52a0\u3057\u307e\u3059\u3002\napp/Http/Middleware/HttpsProtocol.php\n<?php\nnamespace App\\Http\\Middleware;\n\nuse Closure;\n\nclass HttpsProtocol {\n\n    public function handle($request, Closure $next)\n    {\n        if (env('APP_ENV') === 'production') {\n            $request->server->set('HTTPS', 'on');\n            if ($request->header('x-forwarded-proto') <> 'https') {\n                return redirect()->secure($request->getRequestUri());\n            }\n        }\n\n        return $next($request);\n    }\n}\n\n\n\u4f5c\u3063\u305fMiddleware\u3092\u767b\u9332\u3057\u307e\u3059\u3002\napp/Http/Kernel.php\n    protected $middlewareGroups = [\n        'web' => [\n            \\App\\Http\\Middleware\\EncryptCookies::class,\n            \\Illuminate\\Cookie\\Middleware\\AddQueuedCookiesToResponse::class,\n            \\Illuminate\\Session\\Middleware\\StartSession::class,\n            \\Illuminate\\View\\Middleware\\ShareErrorsFromSession::class,\n            \\App\\Http\\Middleware\\VerifyCsrfToken::class,\n            \\App\\Http\\Middleware\\HttpsProtocol::class, // \u3053\u3053\u306b\u8ffd\u52a0\n        ],\n\n        'api' => [\n            'throttle:60,1',\n        ],\n    ];\n\n\u3053\u3093\u306a\u611f\u3058\u3067\u884c\u3051\u308b\u306f\u305a\u3067\u3059\u3002\n\u901a\u5e38\u306f.htaccess\u3067\u30ea\u30c0\u30a4\u30ec\u30af\u30c8\u3055\u305b\u308b\u306e\u304c\u826f\u3044\u306e\u3067\u3059\u304c\u3001\u4f55\u6545\u304b\u4e0a\u624b\u304f\u884c\u304b\u306a\u304f\u3066\u30d5\u30ec\u30fc\u30e0\u30ef\u30fc\u30af\u5074\u3067\u30ea\u30c0\u30a4\u30ec\u30af\u30c8\u3055\u305b\u307e\u3057\u305f\u3002\n\n# \u30d7\u30ed\u30b0\u30e9\u30e0\n\nMiddleware\u3092\u65b0\u305f\u306b\u8ffd\u52a0\u3057\u307e\u3059\u3002\n\napp/Http/Middleware/HttpsProtocol.php\n\n```php\n<?php\nnamespace App\\Http\\Middleware;\n\nuse Closure;\n\nclass HttpsProtocol {\n\n    public function handle($request, Closure $next)\n    {\n        if (env('APP_ENV') === 'production') {\n            $request->server->set('HTTPS', 'on');\n            if ($request->header('x-forwarded-proto') <> 'https') {\n                return redirect()->secure($request->getRequestUri());\n            }\n        }\n\n        return $next($request);\n    }\n}\n\n```\n\n\u4f5c\u3063\u305fMiddleware\u3092\u767b\u9332\u3057\u307e\u3059\u3002\n\napp/Http/Kernel.php\n\n```php\n    protected $middlewareGroups = [\n        'web' => [\n            \\App\\Http\\Middleware\\EncryptCookies::class,\n            \\Illuminate\\Cookie\\Middleware\\AddQueuedCookiesToResponse::class,\n            \\Illuminate\\Session\\Middleware\\StartSession::class,\n            \\Illuminate\\View\\Middleware\\ShareErrorsFromSession::class,\n            \\App\\Http\\Middleware\\VerifyCsrfToken::class,\n            \\App\\Http\\Middleware\\HttpsProtocol::class, // \u3053\u3053\u306b\u8ffd\u52a0\n        ],\n\n        'api' => [\n            'throttle:60,1',\n        ],\n    ];\n```\n\n\u3053\u3093\u306a\u611f\u3058\u3067\u884c\u3051\u308b\u306f\u305a\u3067\u3059\u3002\n", "tags": ["laravel", "Heroku", "SSL"]}