{"context": " More than 1 year has passed since last update.Http Client\u306eOkHttp\u306e\u7c21\u5358\u306a\u4f7f\u3044\u65b9\u3067\u3059\nhttp://square.github.io/okhttp/\nJava\u306e\u30e9\u30a4\u30d6\u30e9\u30ea\u306a\u306e\u3067Android\u3067\u306a\u304f\u3066\u3082\u4f7f\u3048\u307e\u3059\u3002\n\u4eca\u56de\u306fAndroid\u3067\u4f7f\u3046\u3053\u3068\u3092\u60f3\u5b9a\u3057\u3066\u307e\u3059\u3002\n\u30d0\u30fc\u30b8\u30e7\u30f3\u306f2.5.0\u3067\u3059\u3002\n\ngradle\ncompile 'com.squareup.okhttp:okhttp:2.5.0'\n\n\n\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u4f5c\u6210\nOkHttpClient client = new OkHttpClient();\n\n\nGET\n\nget request\u3092\u4f5c\u308b\nRequest request = new Request.Builder()\n           .url(url)\n           .build();\n\n\nGET \u30ea\u30af\u30a8\u30b9\u30c8(\u540c\u671f)\nResponse response = client.newCall(request).execute();\n\n\n\u540c\u671f\u5b9f\u884c\u306fexecute()\u3092\u4f7f\u3044\u307e\u3059\u3002Android\u30a2\u30d7\u30ea\u3060\u3068\u30e1\u30a4\u30f3\u30b9\u30ec\u30c3\u30c9\u4e0a\u3067\u5b9f\u884c\u3055\u308c\u308b\u306e\u3067\u901a\u4fe1\u4e2d\u306f\u30a2\u30d7\u30ea\u304c\u56fa\u307e\u308a\u307e\u3059\u3002\n\nGET \u30ea\u30af\u30a8\u30b9\u30c8(\u975e\u540c\u671f)\nclient.newCall(request).enqueue(new Callback() {\n            @Override\n            public void onFailure(Request request, IOException e) {\n            }\n\n            @Override\n            public void onResponse(Response response) throws IOException {\n            }\n        });\n\n\u975e\u540c\u671f\u5b9f\u884c\u306fenqueue(Callback)\u3092\u4f7f\u3063\u3066\u7d50\u679c\u3092Callback\u30e1\u30bd\u30c3\u30c9\u3067\u53d7\u3051\u53d6\u308b\u3002\n\nCallback\u306e\u4e2d\u3067UI\u3092\u64cd\u4f5c\u3059\u308b\u3068\u843d\u3061\u308b\nclient.newCall(request).enqueue(Callback() {\nfinal Handler mainHandler = new Handler(Looper.getMainLooper());\n            @Override\n            public void onFailure(final Request request, final IOException e) {\n                mainHandler.post(new Runnable() {\n                    @Override\n                    public void run() {\n                        //UI\u64cd\u4f5c\n                    }\n                });\n            }\n\n            @Override\n            public void onResponse(final Response response) throws IOException {\n                mainHandler.post(new Runnable() {\n                    @Override\n                    public void run() {\n                        //UI\u64cd\u4f5c\n                    }\n                });\n             }\n        });\n}\n\nnew Handler(Looper.getMainLooper())\u3092\u4f7f\u3063\u3066UI\u30b9\u30ec\u30c3\u30c9\u3067\u64cd\u4f5c\u3059\u308b\u3002\n\n\u30c7\u30fc\u30bf\u53d6\u5f97\nfinal String content = response.body().string();\n\n\nPOST\nString\u3084\u30d5\u30a1\u30a4\u30eb\u306a\u3069\u7c21\u5358\u306b\u3067\u304d\u308b\u3088\u3046\u3067\u3059\u3002\nOkHttp\u30ec\u30b7\u30d4\u306b\u8272\u3005\u3042\u308a\u307e\u3059\u3002\u4e0b\u8a18\u306f\u30d5\u30a1\u30a4\u30eb\u306ePOST\u3067\u3059\u3002\nMediaType MEDIA_TYPE_MARKDOWN\n      = MediaType.parse(\"text/x-markdown; charset=utf-8\");\nFile file = new File(\"README.md\");\n\nRequest request = new Request.Builder()\n    .url(\"url\")\n    .post(RequestBody.create(MEDIA_TYPE_MARKDOWN, file))\n    .build();\nResponse response = client.newCall(request).execute();\n\n\nHeader\u8a2d\u5b9a\nRequest request = new Request.Builder()\n        .url(\"https://api.github.com/repos/square/okhttp/issues\")\n        .header(\"User-Agent\", \"UA:hoge\")\n        .addHeader(\"Accept\", \"hoge\")\n        .build();\n\nHeader\u60c5\u5831\u306frequest\u306b\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n\nCookie\u3092\u4f7f\u3046\nCookieManager cookieManager = new CookieManager();\ncookieManager.setCookiePolicy(CookiePolicy.ACCEPT_ALL);\nclient.setCookieHandler(cookieManager);\n\n\u4e0a\u8a18\u306e\u8a2d\u5b9a\u3067Cookie\u304c\u4f7f\u3048\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u304c\u3001\u30a2\u30d7\u30ea\u3092\u518d\u8d77\u52d5\u3059\u308b\u3068Cookie\u304c\u6d88\u3048\u308b\u306e\u3067\u3001\u518d\u8d77\u52d5\u3057\u3066\u3082\u540c\u3058Cookie\u3092\u4f7f\u3046\u305f\u3081\u306bSharedPreferences\u306a\u3069\u3067Cookie\u3092\u4fdd\u5b58\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\u81ea\u5206\u3067cookieManager\u3092\u7d99\u627f\u3057\u3066put\u3068\u306a\u3069\u3067\u4fdd\u5b58\u3057\u3066\u3082\u3044\u3044\u306e\u3067\u3059\u304c\nfranmontiel\u3055\u3093\u306e\nPersistentCookieStore.java\nSerializableHttpCookie.java\n\n\u3092\u4f7f\u308f\u305b\u3066\u3082\u3089\u3046\u3068\u826f\u3055\u305d\u3046\u3067\u3059\u3002\nfranmontiel/PersistentCookieStore.java\nCookieManager cookieManager = new CookieManager(new PersistentCookieStore(Application.getContext()), CookiePolicy.ACCEPT_ALL);\nclient.setCookieHandler(cookieManager);\n\n\n\u53c2\u8003\nhttps://github.com/square/okhttp/wiki/Recipes\nhttp://qiita.com/ryugoo/items/478ba23cda0f57bd21e8\nhttp://qiita.com/oqrusk/items/1b3091de877c38eac0de\nhttps://gist.github.com/franmontiel/ed12a2295566b7076161\nHttp Client\u306eOkHttp\u306e\u7c21\u5358\u306a\u4f7f\u3044\u65b9\u3067\u3059\nhttp://square.github.io/okhttp/\nJava\u306e\u30e9\u30a4\u30d6\u30e9\u30ea\u306a\u306e\u3067Android\u3067\u306a\u304f\u3066\u3082\u4f7f\u3048\u307e\u3059\u3002\n\u4eca\u56de\u306fAndroid\u3067\u4f7f\u3046\u3053\u3068\u3092\u60f3\u5b9a\u3057\u3066\u307e\u3059\u3002\n\u30d0\u30fc\u30b8\u30e7\u30f3\u306f2.5.0\u3067\u3059\u3002\n\n##gradle\n\n```\ncompile 'com.squareup.okhttp:okhttp:2.5.0'\n```\n## \u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u4f5c\u6210\n```java\nOkHttpClient client = new OkHttpClient();\n```\n##GET\n###get request\u3092\u4f5c\u308b\n```java\nRequest request = new Request.Builder()\n           .url(url)\n           .build();\n```\n\n###GET \u30ea\u30af\u30a8\u30b9\u30c8(\u540c\u671f)\n```java\nResponse response = client.newCall(request).execute();\n\n```\n\u540c\u671f\u5b9f\u884c\u306f```execute()```\u3092\u4f7f\u3044\u307e\u3059\u3002Android\u30a2\u30d7\u30ea\u3060\u3068\u30e1\u30a4\u30f3\u30b9\u30ec\u30c3\u30c9\u4e0a\u3067\u5b9f\u884c\u3055\u308c\u308b\u306e\u3067\u901a\u4fe1\u4e2d\u306f\u30a2\u30d7\u30ea\u304c\u56fa\u307e\u308a\u307e\u3059\u3002\n\n###GET \u30ea\u30af\u30a8\u30b9\u30c8(\u975e\u540c\u671f)\n```java\nclient.newCall(request).enqueue(new Callback() {\n            @Override\n            public void onFailure(Request request, IOException e) {\n            }\n\n            @Override\n            public void onResponse(Response response) throws IOException {\n            }\n        });\n```\n\u975e\u540c\u671f\u5b9f\u884c\u306f```enqueue(Callback)```\u3092\u4f7f\u3063\u3066\u7d50\u679c\u3092Callback\u30e1\u30bd\u30c3\u30c9\u3067\u53d7\u3051\u53d6\u308b\u3002\n\n###Callback\u306e\u4e2d\u3067UI\u3092\u64cd\u4f5c\u3059\u308b\u3068\u843d\u3061\u308b\n```java\nclient.newCall(request).enqueue(Callback() {\nfinal Handler mainHandler = new Handler(Looper.getMainLooper());\n            @Override\n            public void onFailure(final Request request, final IOException e) {\n                mainHandler.post(new Runnable() {\n                    @Override\n                    public void run() {\n                        //UI\u64cd\u4f5c\n                    }\n                });\n            }\n\n            @Override\n            public void onResponse(final Response response) throws IOException {\n                mainHandler.post(new Runnable() {\n                    @Override\n                    public void run() {\n                        //UI\u64cd\u4f5c\n                    }\n                });\n             }\n        });\n}\n```\n\n```new Handler(Looper.getMainLooper())```\u3092\u4f7f\u3063\u3066UI\u30b9\u30ec\u30c3\u30c9\u3067\u64cd\u4f5c\u3059\u308b\u3002\n\n###\u30c7\u30fc\u30bf\u53d6\u5f97\n```java\nfinal String content = response.body().string();\n```\n##POST\nString\u3084\u30d5\u30a1\u30a4\u30eb\u306a\u3069\u7c21\u5358\u306b\u3067\u304d\u308b\u3088\u3046\u3067\u3059\u3002\n[OkHttp\u30ec\u30b7\u30d4](https://github.com/square/okhttp/wiki/Recipes)\u306b\u8272\u3005\u3042\u308a\u307e\u3059\u3002\u4e0b\u8a18\u306f\u30d5\u30a1\u30a4\u30eb\u306ePOST\u3067\u3059\u3002\n\n```java\nMediaType MEDIA_TYPE_MARKDOWN\n      = MediaType.parse(\"text/x-markdown; charset=utf-8\");\nFile file = new File(\"README.md\");\n\nRequest request = new Request.Builder()\n    .url(\"url\")\n    .post(RequestBody.create(MEDIA_TYPE_MARKDOWN, file))\n    .build();\nResponse response = client.newCall(request).execute();\n```\n\n##Header\u8a2d\u5b9a\n```java\nRequest request = new Request.Builder()\n        .url(\"https://api.github.com/repos/square/okhttp/issues\")\n        .header(\"User-Agent\", \"UA:hoge\")\n        .addHeader(\"Accept\", \"hoge\")\n        .build();\n```\nHeader\u60c5\u5831\u306frequest\u306b\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n\n##Cookie\u3092\u4f7f\u3046\n```java\nCookieManager cookieManager = new CookieManager();\ncookieManager.setCookiePolicy(CookiePolicy.ACCEPT_ALL);\nclient.setCookieHandler(cookieManager);\n```\n\n\u4e0a\u8a18\u306e\u8a2d\u5b9a\u3067Cookie\u304c\u4f7f\u3048\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u304c\u3001\u30a2\u30d7\u30ea\u3092\u518d\u8d77\u52d5\u3059\u308b\u3068Cookie\u304c\u6d88\u3048\u308b\u306e\u3067\u3001\u518d\u8d77\u52d5\u3057\u3066\u3082\u540c\u3058Cookie\u3092\u4f7f\u3046\u305f\u3081\u306bSharedPreferences\u306a\u3069\u3067Cookie\u3092\u4fdd\u5b58\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\u81ea\u5206\u3067cookieManager\u3092\u7d99\u627f\u3057\u3066put\u3068\u306a\u3069\u3067\u4fdd\u5b58\u3057\u3066\u3082\u3044\u3044\u306e\u3067\u3059\u304c\nfranmontiel\u3055\u3093\u306e\n\n```\nPersistentCookieStore.java\nSerializableHttpCookie.java\n```\n\u3092\u4f7f\u308f\u305b\u3066\u3082\u3089\u3046\u3068\u826f\u3055\u305d\u3046\u3067\u3059\u3002\n[franmontiel/PersistentCookieStore.java](https://gist.github.com/franmontiel/ed12a2295566b7076161\n)\n\n```java\nCookieManager cookieManager = new CookieManager(new PersistentCookieStore(Application.getContext()), CookiePolicy.ACCEPT_ALL);\nclient.setCookieHandler(cookieManager);\n```\n\n##\u53c2\u8003\nhttps://github.com/square/okhttp/wiki/Recipes\nhttp://qiita.com/ryugoo/items/478ba23cda0f57bd21e8\nhttp://qiita.com/oqrusk/items/1b3091de877c38eac0de\nhttps://gist.github.com/franmontiel/ed12a2295566b7076161\n", "tags": ["OkHttp", "Android"]}