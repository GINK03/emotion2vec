{"context": " More than 1 year has passed since last update.\u30b9\u30d7\u30ec\u30c3\u30c9\u30b7\u30fc\u30c8\u306eQUERY\u95a2\u6570\u3084Visualization API\u3067\u306fSQL\u30e9\u30a4\u30af\u306a\u30af\u30a8\u30ea\u8a00\u8a9e\u3092\u4f7f\u3063\u3066\u30c7\u30fc\u30bf\u306e\u96c6\u8a08\u3092\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\u4eca\u56de\u306f\u30af\u30a8\u30ea\u8a00\u8a9e\u3092\u4f7f\u3063\u3066\u30c7\u30fc\u30bf\u3092\u96c6\u8a08\u3057\u3001\u7d50\u679c\u3092\u5229\u7528\u3057\u3066\u30b0\u30e9\u30d5\u3092\u63cf\u304f\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u4f5c\u6210\u3057\u3066\u307f\u307e\u3059\u3002\n\n\u524d\u56de\u4f5c\u6210\u3057\u305fPivotTable.js\u3067\u306f\u96c6\u8a08\u95a2\u6570\u3092\u4e00\u3064\u3057\u304b\u4f7f\u3048\u306a\u3044\u305f\u3081\u3001\u3042\u308b\u5024\u306e\u6700\u5c0f\u5024\u3001\u6700\u5927\u5024\u3001\u5e73\u5747\u3092\u4e26\u3079\u308b\u3068\u3044\u3063\u305f\u3053\u3068\u306f\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f\u3002\u4eca\u56de\u306e\u65b9\u6cd5\u3067\u306f\u540c\u6642\u306b\u96c6\u8a08\u95a2\u6570\u3092\u8907\u6570\u4f7f\u3046\u4e8b\u3082\u53ef\u80fd\u306b\u306a\u3063\u3066\u3044\u307e\u3059\u3002\nGoogle \u30b9\u30d7\u30ec\u30c3\u30c9\u30b7\u30fc\u30c8\u306e\u30c7\u30fc\u30bf\u3092PivotTable.js\u3067\u8868\u793a\u3059\u308b - Qiita\n\nTL;DR\n\n\u30b9\u30d7\u30ec\u30c3\u30c9\u30b7\u30fc\u30c8\u306eQUERY\u95a2\u6570\u3001Visualization API\u3067\u306fSQL\u30e9\u30a4\u30af\u306a\u30af\u30a8\u30ea\u8a00\u8a9e\u3092\u4f7f\u3063\u3066\u30b9\u30d7\u30ec\u30c3\u30c9\u30b7\u30fc\u30c8\u304b\u3089\u306e\u30c7\u30fc\u30bf\u53d6\u5f97\u30fb\u96c6\u8a08\u304c\u3067\u304d\u308b\n\u30af\u30a8\u30ea\u8a00\u8a9e\u306eGROUP BY\u53e5\u3084PIVOT\u53e5\u306f\u30d4\u30dc\u30c3\u30c8\u30c6\u30fc\u30d6\u30eb\u3068\u5bfe\u5fdc\u3065\u3051\u308b\u3068\u899a\u3048\u3084\u3059\u3044\n\u30af\u30a8\u30ea\u3057\u305f\u7d50\u679c\u304b\u3089Google Charts\u3067\u30b0\u30e9\u30d5\u3092\u4f5c\u6210\u3059\u308b\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u4f5c\u3063\u3066\u307f\u305f\n\n\n\u30b9\u30d7\u30ec\u30c3\u30c9\u30b7\u30fc\u30c8\u3067\u306e\u30af\u30a8\u30ea\u5b9f\u884c\n\u30af\u30a8\u30ea\u8a00\u8a9e\u306f\u30b9\u30d7\u30ec\u30c3\u30c9\u30b7\u30fc\u30c8\u3001Visualization API\u304b\u3089\u4f7f\u7528\u53ef\u80fd\u3067\u3059\u3002\n\u307e\u305a\u306f\u624b\u8efd\u306a\u30b9\u30d7\u30ec\u30c3\u30c9\u30b7\u30fc\u30c8\u306eQUERY\u95a2\u6570\u3067\u30af\u30a8\u30ea\u3092\u5b9f\u884c\u3057\u3066\u52d5\u4f5c\u3092\u8abf\u3079\u3066\u307f\u307e\u3059\u3002\nQUERY - \u30c9\u30ad\u30e5\u30e1\u30f3\u30c8 \u30a8\u30c7\u30a3\u30bf \u30d8\u30eb\u30d7\n\n\u30c7\u30fc\u30bf\u306e\u7528\u610f\n\u524d\u56de\u306e\u4f8b\u3067\u4f7f\u7528\u3057\u305fCanadian Parliament 2012 dataset \u3092\u4f7f\u3063\u3066\u3044\u304d\u307e\u3059\u3002\n\u9069\u5f53\u306b\u7a7a\u306e\u30b7\u30fc\u30c8\u3092\u958b\u304d\u3001\u30bb\u30ebA1 \u306b\u4e0b\u8a18\u3092\u5165\u529b\u3057\u3066\u5b9f\u884c\u3059\u308b\u3068\u30c7\u30fc\u30bf\u304c\u8aad\u307f\u8fbc\u307e\u308c\u307e\u3059\u3002\n=IMPORTDATA(\"http://nicolas.kruchten.com/pivottable/examples/mps.csv\")\n\n\n\nQUERY\u95a2\u6570\n\u30af\u30a8\u30ea\u306e\u7d50\u679c\u3092\u8868\u793a\u3057\u305f\u3044\u30bb\u30eb\u3067\u6b21\u306e\u3088\u3046\u306bQUERY\u95a2\u6570\u3092\u5b9f\u884c\u3059\u308b\u3068\u7d50\u679c\u304c\u53d6\u5f97\u3067\u304d\u307e\u3059\u3002\n=QUERY(<\u30af\u30a8\u30ea\u306e\u5bfe\u8c61\u306e\u30c7\u30fc\u30bf\u7bc4\u56f2>, <\u30af\u30a8\u30ea>)\n\n\u30af\u30a8\u30ea\u8a00\u8a9e\u306fSQL\u30e9\u30a4\u30af\u306a\u8a00\u8a9e\u3068\u306a\u3063\u3066\u304a\u308a\u3001\u4ee5\u4e0b\u306e\u53e5\u3092\u4f7f\u7528\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\u53e5\u306f\u4ee5\u4e0b\u306e\u9806\u3067\u4f7f\u7528\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\n\nSELECT\nWHERE\nGROUP BY\nPIVOT\nORDER BY\nLIMIT\nOFFSET\nLABEL\nFORMAT\nOPTIONS\n\n\u4ee5\u4e0b\u3067\u3088\u304f\u4f7f\u3044\u305d\u3046\u306a\u53e5\u3092\u7d39\u4ecb\u3057\u3066\u3044\u304d\u307e\u3059\u3002\n\nSELECT\u53e5\nSELECT\u53e5\u306f\u51fa\u529b\u3059\u308b\u5217\u3092\u6307\u5b9a\u3059\u308b\u305f\u3081\u306b\u4f7f\u3044\u307e\u3059\u3002\n\u8aad\u307f\u8fbc\u3093\u3060\u30c7\u30fc\u30bf\u304b\u3089Party\u3068Age\u5217\u306e\u307f\u3092\u8868\u793a\u3055\u305b\u3066\u307f\u307e\u3059\u3002\n\u4ee5\u4e0b\u306e\u30af\u30a8\u30ea\u3092\u30bb\u30ebG1\u306b\u5165\u529b\u3057\u3066\u5b9f\u884c\u3059\u308b\u3068\u3001Party\u3001Age\u5217\u304c\u51fa\u529b\u3055\u308c\u307e\u3059\u3002\n\uff08\u5217\u306f\u30b9\u30d7\u30ec\u30c3\u30c9\u30b7\u30fc\u30c8\u306e\u5217\u306eID\u3067\u6307\u5b9a\u3057\u307e\u3059\u3002\uff09\n=QUERY(A:E, \"SELECT B, D\")\n\n\nSELECT * \uff08\u307e\u305f\u306fSELECT\u53e5\u3092\u7701\u7565\uff09\u3067\u5168\u3066\u306e\u5217\u3092\u51fa\u529b\u3057\u307e\u3059\u3002\n=QUERY(A:E, \"SELECT *\")\n\u307e\u305f\u306f\n=QUERY(A:E, \"\")\n\n\n\nWHERE\u53e5\nWHERE\u53e5\u306f\u51fa\u529b\u3059\u308b\u884c\u3092\u9078\u629e\u3059\u308b\u305f\u3081\u306b\u7528\u3044\u3089\u308c\u307e\u3059\u3002\n\u4f8b\u3048\u3070Party=NDP\u306e\u884c\u3092\u5f97\u308b\u305f\u3081\u306e\u30af\u30a8\u30ea\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\n=QUERY(A:E, \"SELECT * WHERE B = 'NDP'\")\n\u307e\u305f\u306f\n=QUERY(A:E, \"WHERE B = 'NDP'\")\n\n\n\u8907\u6570\u306e\u6761\u4ef6\u3092AND\u3084OR\u3067\u7d44\u307f\u5408\u308f\u305b\u3066\u4f7f\u3046\u4e8b\u3082\u3067\u304d\u307e\u3059\u3002\nParty=NDP\u304b\u3064Province=Quebec\u3067\u3042\u308b\u884c\u306f\u6b21\u306e\u3088\u3046\u306b\u3057\u3066\u5f97\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\uff08\u4ee5\u964d\u3001SELECT * \u3092\u7701\u7565\u3057\u306a\u3044\u3067\u66f8\u304d\u307e\u3059\u3002\uff09\n=QUERY(A:E, \"SELECT * WHERE B = 'NDP'\u3000AND C = 'Quebec'\")\n\n\n\u6587\u5b57\u5217\u306e\u6bd4\u8f03\u306bLIKE\u7b49\u306e\u6f14\u7b97\u5b50\u3092\u4f7f\u3046\u3053\u3068\u3082\u3067\u304d\u307e\u3059\u3002\u30b5\u30dd\u30fc\u30c8\u3055\u308c\u3066\u3044\u308b\u6f14\u7b97\u5b50\u306b\u3064\u3044\u3066\u306e\u8a73\u7d30\u306f\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u3092\u53c2\u7167\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\u540d\u524d\u304cAllen\u304b\u3089\u59cb\u307e\u308b\u4eba\u306e\u884c\u306f\u4ee5\u4e0b\u306e\u30af\u30a8\u30ea\u3067\u5f97\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n=QUERY(A:E, \"SELECT * WHERE A LIKE 'Allen%'\")\n\n\n\nGROUP BY\u53e5\nGROUP BY\u53e5\u306f\u6307\u5b9a\u3057\u305f\u5c5e\u6027\u306e\u5024\u3067\u30c7\u30fc\u30bf\u3092\u30b0\u30eb\u30fc\u30d7\u5316\u30fb\u96c6\u8a08\u3059\u308b\u305f\u3081\u306b\u7528\u3044\u3089\u308c\u307e\u3059\u3002\n\u4ee5\u4e0b\u306e\u30af\u30a8\u30ea\u3067\u3001\u5404\u653f\u515a\u306b\u5c5e\u3057\u3066\u3044\u308b\u4eba\u6570\u3092\u5f97\u308b\u4e8b\u304c\u3067\u304d\u307e\u3059\u3002\n=QUERY(A:E, \"SELECT B, COUNT(A) GROUP BY B\")\n\n\nParty\u304c\u7a7a\u306e\u4eba\u304c691\u4eba\u3044\u308b\u3053\u3068\u306b\u306a\u3063\u3066\u3044\u307e\u3059\u304c\u3001\u30c7\u30fc\u30bf\u3092\u78ba\u8a8d\u3059\u308b\u3068\u7d50\u679c\u306b\u30c7\u30fc\u30bf\u306e\u7121\u3044\u884c\u304c\u542b\u307e\u308c\u3066\u3044\u308b\u3053\u3068\u304c\u308f\u304b\u308a\u307e\u3059\u3002\n\u30c7\u30fc\u30bf\u306e\u7121\u3044\u884c\u3092\u53d6\u308a\u9664\u304f\u305f\u3081\u306bWHERE\u53e5\u3092\u4f7f\u3046\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n=QUERY(A:E, \"SELECT B, COUNT(A) WHERE A != '' GROUP BY B\")\n\n\n\u30c7\u30fc\u30bf\u7bc4\u56f2\u3067\u884c\u307e\u3067\u6307\u5b9a\u3057QUERY\u95a2\u6570\u306e\u5f15\u6570\u306e\u7bc4\u56f2\u304b\u3089\u30c7\u30fc\u30bf\u306e\u7121\u3044\u884c\u3092\u53d6\u308a\u9664\u304f\u3053\u3068\u306b\u3088\u3063\u3066\u3001\u30c7\u30fc\u30bf\u306e\u306a\u3044\u884c\u304c\u96c6\u8a08\u3055\u308c\u3066\u3057\u307e\u3046\u3053\u3068\u3092\u9632\u3050\u3053\u3068\u3082\u53ef\u80fd\u3067\u3059\u3002\n\u3053\u3061\u3089\u306e\u65b9\u6cd5\u3067\u306fWHERE\u53e5\u306f\u4e0d\u8981\u3067\u30af\u30a8\u30ea\u304c\u77ed\u304f\u306a\u308a\u307e\u3059\u3002\u4ee5\u964d\u3067\u306f\u30af\u30a8\u30ea\u3092\u77ed\u304f\u3059\u308b\u305f\u3081\u3001\u30c7\u30fc\u30bf\u306e\u7bc4\u56f2\u3092\u4fee\u6b63\u3057\u30c7\u30fc\u30bf\u304c\u7121\u3044\u884c\u3092\u96c6\u8a08\u304b\u3089\u9664\u5916\u3057\u307e\u3059\u3002\n=QUERY(A1:E309, \"SELECT B, COUNT(A) GROUP BY B\")\n\n\n\u30af\u30a8\u30ea\u3067\u5f97\u3089\u308c\u308b\u7d50\u679c\u3068\u540c\u69d8\u306e\u7d50\u679c\u3092\u30d4\u30dc\u30c3\u30c8\u30c6\u30fc\u30d6\u30eb\u3067\u3082\u5f97\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\u4eca\u56de\u306e\u30af\u30a8\u30ea\u306f\u30d4\u30dc\u30c3\u30c8\u30c6\u30fc\u30d6\u30eb\u3067\u884c\u306bParty\u3092\u6307\u5b9a\u3057\u3001COUNTA\u3067\u540d\u524d\u3092\u6570\u3048\u308b\u3053\u3068\u306b\u76f8\u5f53\u3057\u3066\u3044\u307e\u3059\u3002\n\n\u96c6\u8a08\u95a2\u6570\u306b\u306fCOUNT\u4ee5\u5916\u306b\u3082MIN, MAX, AVG\u306a\u3069\u304c\u30b5\u30dd\u30fc\u30c8\u3055\u308c\u3066\u3044\u307e\u3059\u3002\n\u4ee5\u4e0b\u306e\u30af\u30a8\u30ea\u3067\u5404\u653f\u515a\u306e\u5e73\u5747\u5e74\u9f62\u304c\u5f97\u3089\u308c\u307e\u3059\u3002\n=QUERY(A1:E309, \"SELECT B, AVG(D) GROUP BY B\")\n\n\n\u3053\u306e\u30af\u30a8\u30ea\u306f\u3001\u30d4\u30dc\u30c3\u30c8\u30c6\u30fc\u30d6\u30eb\u3067\u884c\u306bParty\u3092\u6307\u5b9a\u3057AVERAGE\u3067Age\u306e\u5e73\u5747\u3092\u8a08\u7b97\u3059\u308b\u3053\u3068\u306b\u76f8\u5f53\u3057\u307e\u3059\u3002\n\n\u5404\u653f\u515a\u306e\u5e73\u5747\u5e74\u9f62\u3092\u8a08\u7b97\u3059\u308b\u4e8b\u304c\u3067\u304d\u305f\u306e\u3067\u3053\u308c\u3092\u68d2\u30b0\u30e9\u30d5\u306b\u3057\u3066\u307f\u307e\u3059\u3002\n\uff08\u5e74\u9f62\u3092\u68d2\u30b0\u30e9\u30d5\u3067\u8868\u3059\u306e\u306b\u9055\u548c\u611f\u304c\u3042\u308a\u307e\u3059\u304c\u3001\u3053\u3053\u3067\u306f\u3042\u307e\u308a\u6c17\u306b\u3057\u306a\u3044\u3067\u3044\u305f\u3060\u3051\u308b\u3068\u3042\u308a\u304c\u305f\u3044\u3067\u3059\u3002\uff09\n\u30af\u30a8\u30ea\u95a2\u6570\u306b\u3088\u308a\u751f\u6210\u3055\u308c\u305f\u30c6\u30fc\u30d6\u30eb\u5185\u306e\u4efb\u610f\u306e\u30bb\u30eb\u3092\u9078\u629e\u3057\u305f\u72b6\u614b\u3067\u30e1\u30cb\u30e5\u30fc\u304b\u3089\u300c\u633f\u5165 > \u30b0\u30e9\u30d5\u300d\u3067\u30b0\u30e9\u30d5\u3092\u4f5c\u6210\u3059\u308b\u3068\u3001\u81ea\u52d5\u7684\u306b\u30c7\u30fc\u30bf\u306e\u7bc4\u56f2\u3092\u9078\u629e\u3057\u3066\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u30b0\u30e9\u30d5\u3092\u4f5c\u6210\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n\u540c\u69d8\u306b\u30d4\u30dc\u30c3\u30c8\u30c6\u30fc\u30d6\u30eb\u5185\u306e\u30bb\u30eb\u3092\u9078\u629e\u3057\u305f\u72b6\u614b\u3067\u30b0\u30e9\u30d5\u3092\u4f5c\u6210\u3059\u308b\u3068\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u30b0\u30e9\u30d5\u3092\u4f5c\u6210\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\uff08\u30b0\u30e9\u30d5\u3092\u5408\u308f\u305b\u308b\u305f\u3081\u5408\u8a08\u3092\u8868\u793a\u306e\u30c1\u30a7\u30c3\u30af\u3092\u5916\u3057\u3066\u3044\u307e\u3059\u3002\uff09\n\nGROUP BY\u53e5\u306b\u306f\u8907\u6570\u306e\u5c5e\u6027\u3092\u6307\u5b9a\u3059\u308b\u4e8b\u3082\u53ef\u80fd\u3067\u3059\u3002\u6b21\u306e\u30af\u30a8\u30ea\u3067\u5404\u653f\u515a\u306e\u7537\u5973\u306e\u5e73\u5747\u5e74\u9f62\u3092\u8a08\u7b97\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n=QUERY(A1:E309, \"SELECT B, E, AVG(D) GROUP BY B, E\")\n\n\nGROUP BY\u306b\u8907\u6570\u306e\u5217\u540d\u3092\u6307\u5b9a\u3059\u308b\u4e8b\u306f\u3001\u30d4\u30dc\u30c3\u30c8\u30c6\u30fc\u30d6\u30eb\u3067\u306f\u884c\u306b\u5c5e\u6027\u3092\u8907\u6570\u8ffd\u52a0\u3059\u308b\u3053\u3068\u306b\u76f8\u5f53\u3057\u307e\u3059\u3002\n\nGROUP BY\u53e5\u306b\u8907\u6570\u306e\u5c5e\u6027\u3092\u6307\u5b9a\u3057\u305f\u30af\u30a8\u30ea\u3092\u5b9f\u884c\u3057\u305f\u7d50\u679c\u304b\u3089\u4e0b\u56f3\u306e\u3088\u3046\u306a\u30b0\u30e9\u30d5\u3092\u63cf\u304d\u305f\u304f\u306a\u308b\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u3002\u3057\u304b\u3057\u3001\u73fe\u5728\u306e\u7d50\u679c\u306e\u8868\u306e\u5f62\u5f0f\u306f\u3053\u306e\u30b0\u30e9\u30d5\u3092\u4f5c\u6210\u3059\u308b\u305f\u3081\u306e\u5f62\u5f0f\u3068\u306a\u3063\u3066\u3044\u307e\u305b\u3093\u3002\n\n\u4e0a\u56f3\u306e\u3088\u3046\u306a\u30b0\u30e9\u30d5\u3092\u63cf\u304f\u305f\u3081\u306b\u306f\u4e0b\u306e\u3088\u3046\u306b\u898b\u51fa\u3057\u3001\u30e9\u30d9\u30eb\u304c1\u884c\u30011\u5217\u306e\u8868\u3092\u4f5c\u6210\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\u3053\u306e\u7d50\u679c\u3092\u5f97\u308b\u305f\u3081\u306b\u306f\u5f8c\u8ff0\u3059\u308bPIVOT\u53e5\u3092\u4f7f\u7528\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\n\nGROUP BY\u53e5\u3092\u4f7f\u7528\u3057\u3066\u3044\u308b\u5834\u5408\u3001SELECT\u53e5\u3067\u96c6\u8a08\u95a2\u6570\u3092\u8907\u6570\u4f7f\u7528\u3059\u308b\u4e8b\u304c\u3067\u304d\u307e\u3059\u3002\u4ee5\u4e0b\u306e\u30af\u30a8\u30ea\u3067\u5404\u653f\u515a\u306e\u515a\u54e1\u306e\u5e74\u9f62\u306e\u6700\u5c0f\u5024\u3001\u5e73\u5747\u3001\u6700\u5927\u5024\u3092\u5f97\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\u3053\u306e\u5834\u5408\u3001\u8868\u306e\u5f62\u5f0f\u304c\u898b\u51fa\u3057\u3001\u30e9\u30d9\u30eb\u304c1\u884c\u30011\u5217\u3068\u306a\u3063\u3066\u3044\u308b\u305f\u3081\u30b0\u30e9\u30d5\u3092\u4f5c\u6210\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n=QUERY(A1:E309, \"SELECT B, MIN(D), AVG(D), MAX(D) GROUP BY B\")\n\n\nSELECT\u53e5\u3067\u96c6\u8a08\u95a2\u6570\u3092\u8907\u6570\u4f7f\u7528\u3059\u308b\u3053\u3068\u306f\u3001\u30d4\u30dc\u30c3\u30c8\u30c6\u30fc\u30d6\u30eb\u3067\u306f\u5024\u3092\u8907\u6570\u6307\u5b9a\u3059\u308b\u3053\u3068\u306b\u76f8\u5f53\u3057\u307e\u3059\u3002\n\n\nPIVOT\u53e5\nPIVOT\u53e5\u306f\u6307\u5b9a\u3057\u305f\u5c5e\u6027\u306e\u5024\u3092\u4f7f\u3063\u3066\u65b0\u3057\u3044\u5217\u3092\u4f5c\u308b\u305f\u3081\u306b\u7528\u3044\u3089\u308c\u307e\u3059\u3002\nGROUP BY\u53e5\u306e\u4f8b\u3067\u30c7\u30fc\u30bf\u3092\u653f\u515a\u6bce\u306b\u30b0\u30eb\u30fc\u30d7\u5316\u3057\u5404\u653f\u515a\u306e\u5e73\u5747\u5e74\u9f62\u3092\u8a08\u7b97\u3057\u307e\u3057\u305f\u3002\n\u3053\u306e\u3068\u304d\u7d50\u679c\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u653f\u515a\u304c\u884c\u3001\u5e73\u5747\u5e74\u9f62\u304c\u5217\u306b\u306a\u308a\u307e\u3057\u305f\u3002\n\nGROUP BY\u53e5\u306e\u4ee3\u308f\u308a\u306bPIVOT\u53e5\u3092\u4f7f\u3046\u3068\u5404\u653f\u515a\u3092\u5217\u306b\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\nPIVOT\u53e5\u3082GROUP BY\u53e5\u3068\u540c\u69d8\u306b\u30c7\u30fc\u30bf\u306e\u96c6\u8a08\u3092\u884c\u3044\u307e\u3059\u3002\u30c7\u30fc\u30bf\u306e\u96c6\u8a08\u306b\u306fSELECT\u53e5\u3067\u6307\u5b9a\u3057\u305f\u96c6\u8a08\u95a2\u6570\u304c\u4f7f\u7528\u3055\u308c\u307e\u3059\u3002\n\u30b0\u30e9\u30d5\u3092\u307f\u308b\u3068GROUP BY\u53e5\u3067\u4f5c\u6210\u3057\u305f\u3082\u306e\u3068\u5f62\u306f\u540c\u3058\u3067\u3059\u304c\u30c7\u30fc\u30bf\u306e\u7cfb\u5217\u304c\u653f\u515a\u3067\u5206\u304b\u308c\u3066\u3044\u307e\u3059\u3002\n=QUERY(A1:E309, \"SELECT AVG(D) PIVOT B\")\n\n\nGROUP BY\u53e5\u306f\u30d4\u30dc\u30c3\u30c8\u30c6\u30fc\u30d6\u30eb\u306e\u884c\u306b\u5c5e\u6027\u3092\u6307\u5b9a\u3059\u308b\u4e8b\u306b\u5bfe\u5fdc\u3057\u3066\u3044\u307e\u3057\u305f\u3002\u540c\u69d8\u306bPIVOT\u53e5\u306f\u30d4\u30dc\u30c3\u30c8\u30c6\u30fc\u30d6\u30eb\u306e\u5217\u306b\u5c5e\u6027\u3092\u6307\u5b9a\u3059\u308b\u4e8b\u306b\u5bfe\u5fdc\u3057\u3066\u3044\u307e\u3059\u3002\n\nGROUP BY\u53e5\u306e\u8aac\u660e\u306e\u4e2d\u3067\u4ee5\u4e0b\u306e\u30af\u30a8\u30ea\u3067\u653f\u515a\u306e\u7537\u5973\u5225\u306e\u5e73\u5747\u5e74\u9f62\u3092\u5f97\u305f\u5834\u5408\u3001\u8868\u306e\u5f62\u5f0f\u304c\u898b\u51fa\u3057\u3001\u30e9\u30d9\u30eb\u304c1\u884c\u30011\u5217\u3068\u306a\u3089\u305a\u30b0\u30e9\u30d5\u304c\u63cf\u3051\u306a\u3044\u3053\u3068\u306b\u89e6\u308c\u307e\u3057\u305f\u3002\n=QUERY(A1:E309, \"SELECT B, E, AVG(D) GROUP BY B, E\")\n\n\u30b0\u30e9\u30d5\u3092\u63cf\u3051\u308b\u7d50\u679c\u3092\u5f97\u308b\u306b\u306fPIVOT\u53e5\u3092\u7528\u3044\u3066\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u3057\u307e\u3059\u3002\n=QUERY(A1:E309, \"SELECT B, AVG(D) GROUP BY B PIVOT E\")\n\n\n\u307e\u305f\u306f\u3001B\u3068E\u3092\u5165\u308c\u66ff\u3048\u3066\u6b21\u306e\u3088\u3046\u306b\u3059\u308b\u3068\u884c\u3068\u5217\u304c\u5165\u308c\u66ff\u308f\u308a\u307e\u3059\u3002\n=QUERY(A1:E309, \"SELECT E, AVG(D) GROUP BY E PIVOT B\")\n\n\n\u3053\u308c\u3089\u306eGROUP BY\u3068PIVOT\u3092\u7d44\u307f\u5408\u308f\u305b\u305f\u30af\u30a8\u30ea\u306f\u30d4\u30dc\u30c3\u30c8\u30c6\u30fc\u30d6\u30eb\u3067\u306f\u884c\u3068\u5217\u306b\u5c5e\u6027\u3092\u6307\u5b9a\u3059\u308b\u4e8b\u306b\u76f8\u5f53\u3057\u307e\u3059\u3002\n\nGROUP BY\u306b\u8907\u6570\u306e\u5c5e\u6027\u3092\u6307\u5b9a\u3067\u304d\u305f\u3088\u3046\u306b\u3001PIVOT\u306b\u3082\u8907\u6570\u306e\u5c5e\u6027\u3092\u6307\u5b9a\u3059\u308b\u3053\u3068\u304c\u53ef\u80fd\u3067\u3059\u3002\n\u65b0\u3057\u3044\u5217\u540d\u306f\u5c5e\u6027\u306e\u5024\u3092\u30ab\u30f3\u30de\u533a\u5207\u308a\u3067\u7d50\u5408\u3057\u305f\u3082\u306e\u3068\u306a\u308a\u307e\u3059\u3002\n=QUERY(A1:E309, \"SELECT AVG(D) PIVOT B, E\")\n\n\n\u30d4\u30dc\u30c3\u30c8\u30c6\u30fc\u30d6\u30eb\u3067\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\n\n\nORDER BY\u53e5\nORDER BY\u53e5\u306f\u884c\u3092\u30bd\u30fc\u30c8\u3059\u308b\u305f\u3081\u306b\u7528\u3044\u3089\u308c\u307e\u3059\u3002\n\uff08\u30af\u30a8\u30ea\u3067\u5217\u306f\u30bd\u30fc\u30c8\u3067\u304d\u307e\u305b\u3093\u3002\u30d4\u30dc\u30c3\u30c8\u30c6\u30fc\u30d6\u30eb\u3067\u306f\u3067\u304d\u307e\u3059\u3002\uff09\n=QUERY(A1:E309, \"SELECT B, AVG(D) GROUP BY B ORDER BY AVG(D)\")\n\n\n\nLABEL\u53e5\nLABEL\u53e5\u3092\u306f\u5c5e\u6027\u306b\u30e9\u30d9\u30eb\u3092\u3064\u3051\u308b\u305f\u3081\u306b\u7528\u3044\u3089\u308c\u307e\u3059\u3002\n=QUERY(A1:E309, \"SELECT B, AVG(D) GROUP BY B PIVOT E LABEL B '\u653f\u515a'\")\n\n\n\nGoogle Visualization API\u3092\u4f7f\u3063\u305f\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\nGoogle Visualization API\u3092\u4f7f\u7528\u3059\u308b\u3068\u30a6\u30a7\u30d6\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u304b\u3089\u30b9\u30d7\u30ec\u30c3\u30c9\u30b7\u30fc\u30c8\u306b\u5bfe\u3057\u3066\u30af\u30a8\u30ea\u3092\u5b9f\u884c\u3059\u308b\u4e8b\u304c\u3067\u304d\u307e\u3059\u3002\n\u6b21\u306e\u3088\u3046\u306b\u30b9\u30d7\u30ec\u30c3\u30c9\u30b7\u30fc\u30c8\u306eURL\u3092\u6e21\u3057\u3066Query\u30af\u30e9\u30b9\u3092\u521d\u671f\u5316\u3057\u3001\u30af\u30a8\u30ea\u3092\u30bb\u30c3\u30c8\u3057\u3066\u304b\u3089send\u30e1\u30bd\u30c3\u30c9\u3092\u5b9f\u884c\u3059\u308b\u3068\u30cf\u30f3\u30c9\u30e9\u306b\u7d50\u679c\u304c\u6e21\u3055\u308c\u307e\u3059\u3002\nvar query = new google.visualization.Query(URL);\nquery.setQuery(QUERY);\nquery.send(handleQueryResponse);\n\n\u8a73\u7d30\u306f\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u3092\u53c2\u7167\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n\u30a6\u30a7\u30d6\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u4f5c\u6210\nGoogle Visualization API\u3092\u4f7f\u3063\u3066\u30b9\u30d7\u30ec\u30c3\u30c9\u30b7\u30fc\u30c8\u304b\u3089\u30af\u30a8\u30ea\u3067\u30c7\u30fc\u30bf\u3092\u53d6\u5f97\u30fb\u96c6\u8a08\u3057\u3001\u7d50\u679c\u304b\u3089Google Charts\u3067\u30b0\u30e9\u30d5\u3092\u4f5c\u6210\u3059\u308b\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u4f5c\u3063\u3066\u307f\u307e\u3057\u305f\u3002\n\u4ee5\u4e0b\u306e\u624b\u9806\u3067\u4f5c\u6210\u3059\u308b\u4e8b\u304c\u3067\u304d\u307e\u3059\u3002\n\n\u30b9\u30af\u30ea\u30d7\u30c8\u30a8\u30c7\u30a3\u30bf(https://script.google.com) \u3092\u958b\u304d\u300c\u7a7a\u306e\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u300d\u3092\u9078\u629e\n\n\u30b3\u30fc\u30c9.gs \u306e\u4e2d\u8eab\u3092\u5168\u3066\u524a\u9664\u3057\u3001\u4ee5\u4e0b\u306e\u30b3\u30fc\u30c9\u3092\u8cbc\u4ed8\u3051\u3066\u4fdd\u5b58\n\uff08\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u540d\u306f\u5206\u304b\u308a\u3084\u3059\u3044\u540d\u524d\u3092\u9069\u5f53\u306b\u4ed8\u3051\u3066\u304a\u304d\u307e\u3059\u3002\uff09\n\n\u30b3\u30fc\u30c9.gs\nfunction doGet(e) {                                                            \n    return HtmlService.createHtmlOutputFromFile('index')                       \n        .setTitle('QueryExample')                                              \n        .setSandboxMode(HtmlService.SandboxMode.IFRAME);                       \n}                                                                              \n\nfunction getSpreadSheetFiles(folder, path) {                                   \n    if (folder == null && path == null) {                                      \n        return getSpreadSheetFiles(DriveApp.getRootFolder(), \"\");              \n    }                                                                          \n\n    var files = [];                                                            \n    path = path + \"/\" + folder.getName();                                      \n\n    var fileIt = folder.getFilesByType(MimeType.GOOGLE_SHEETS);                \n    while(fileIt.hasNext()) {                                                  \n        var f = fileIt.next();                                                 \n        files.push({id: f.getId(), path: path + \"/\" + f.getName()});           \n    }                                                                          \n\n    var folderIt = folder.getFolders();                                        \n    while(folderIt.hasNext()) {                                                \n        fs = getSpreadSheetFiles(folderIt.next(), path);                       \n        for (var i = 0; i < fs.length; i++) {                                  \n            files.push(fs[i]);                                                 \n        }                                                                      \n    }                                                                          \n    return files;                                                              \n}                                                                              \n\nfunction getSheets(fileId) {                                                   \n    var sheets = [];                                                           \n    var spreadsheet = SpreadsheetApp.openById(fileId);                         \n    var sheetsTmp = spreadsheet.getSheets();                                   \n    for (var i = 0; i < sheetsTmp.length; i++) {                               \n        var sheet = sheetsTmp[i];                                              \n        sheets.push(sheet.getSheetName());                                     \n    }                                                                          \n    return sheets;                                                             \n}                                                                              \n\nfunction getUrl(fileId) {                                                      \n    return SpreadsheetApp.openById(fileId).getUrl();                           \n} \n\n\n\n\u30e1\u30cb\u30e5\u30fc\u304b\u3089\u300c\u5b9f\u884c > doGet\u300d\u3092\u9078\u629e\u3002Drive, SpreadSheet\u306e\u6a29\u9650\u304c\u6c42\u3081\u3089\u308c\u308b\u306e\u3067\u627f\u8a8d\u3059\u308b\n\uff08html\u30d5\u30a1\u30a4\u30eb\u304c\u7121\u3044\u3068\u3044\u3046\u8b66\u544a\u304c\u3067\u307e\u3059\u304c\u3001\u3053\u3053\u3067\u306f\u7121\u8996\u3057\u307e\u3059\uff09\n\u30e1\u30cb\u30e5\u30fc\u304b\u3089\u300c\u30d5\u30a1\u30a4\u30eb > \u65b0\u898f\u4f5c\u6210 > HTML\u30d5\u30a1\u30a4\u30eb\u300d\u3092\u9078\u629e\u3057\u3001\u30d5\u30a1\u30a4\u30eb\u540d\u3092index \u3068\u3057\u3066HTML\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\nindex.html \u306e\u4e2d\u8eab\u3092\u4e00\u65e6\u5168\u3066\u524a\u9664\u3057\u4ee5\u4e0b\u3092\u8cbc\u4ed8\u3051\u3066\u4fdd\u5b58\u3057\u307e\u3059\u3002\n\nindex.html\n<!-- StyleSheet -->\n<link rel=\"stylesheet\" href=\"https://ssl.gstatic.com/docs/script/css/add-ons.css\">\n<link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/pivottable/1.4.0/pivot.min.css\">\n\n<style>\n    form {\n        margin: 8px;\n    }\n    select {\n        height: 38px;\n    }\n    select#file-select {\n        width: 300px;\n    }\n    select#sheet-select {\n        width: 100px;\n    }\n    input#query {\n        width: 500px;\n    }\n    td, th {\n        padding: 5px 10px;\n    }\n    .slide_toggle h3 {\n        cursor: pointer;\n        border-bottom: 1px solid black ;\n    }\n    .slide_toggle h3:before {\n        content: '';\n        position: relative;\n        float: left;\n        border-top: 10px solid black;\n        border-left: 5px solid transparent;\n        border-right: 5px solid transparent;\n        width: 0;\n        height: 0;\n        top: 5px;\n        right: 5px;\n    }\n    .slide_toggle h3.open::before {\n        content: '';\n        position: relative;\n        float: left;\n        border-left: 10px solid black;\n        border-top: 5px solid transparent;\n        border-bottom: 5px solid transparent;;\n        width: 0;\n        height: 0;\n        top: 5px;\n        right: 5px;\n    }\n</style>\n\n<!-- Body -->\n<form>\n  <div class=\"inline form-group\">\n      <label for=\"file-select\">File</label>\n      <select id=\"file-select\" disabled onchange=\"$('#query').val(''); updateSheets()\">\n          <option disabled selected>Loading...</option>\n      </select>\n  </div>\n  <div class=\"inline form-group\">\n      <label for=\"sheet-select\">Sheet</label>\n      <select id=\"sheet-select\" disabled onchange=\"$('#query').val(''); updateData()\">\n          <option disabled selected>Loading...</option>\n      </select>\n  </div>\n</form>\n\n<form onsubmit=\"updateData(); return false;\">\n    <div class=\"inline form-group\">\n        <label for=\"query\">Query</label> \n        <input id=\"query\" type=\"text\" disabled >\n    </div>\n    <div class=\"inline form-group\">\n        <input id=\"query-submit\" type=\"submit\" disabled >\n    </div>\n</form>\n<div class=\"query-examples\">\nQuery Examples\n  <ul>\n    <li>SELECT * LIMIT 10</li>\n    <li>SELECT B, AVG(D) GROUP BY B PIVOT E</li>\n  </ul>\n</div>\n\n<div class=\"slide_toggle\">\n    <h3>Columns</h3>\n    <table id=\"columns\"></table>\n</div>\n\n<div class=\"slide_toggle\">\n    <h3>Table</h3>\n    <div class=\"block\" id=\"table\"></div>    \n</div>\n\n<div class=\"slide_toggle\">\n    <h3>Chart</h3>\n    <div class=\"inline form-group\">\n        <label for=\"chart-type-select\">Chart Type</label>\n        <select id=\"chart-type-select\" onchange=\"updateChart()\">\n            <option selected>ColumnChart</option>\n            <option>ColumnChart(stacked)</option>\n            <option>ColumnChart(percent)</option>\n            <option>BarChart</option>\n            <option>Histogram</option>\n            <option>LineChart</option>\n            <option>AreaChart</option>\n            <option>AreaChart(stacked)</option>\n            <option>ScatterChart</option>\n            <option>BubbleChart</option>\n            <option>PieChart</option>\n            <option>CandlestickChart</option>\n            <option>Sankey</option>\n            <option>TreeMap</option>\n            <option>Gauge</option>\n            <option>Calendar</option>\n        </select>\n    </div>\n\n    <div id=\"chart\" style=\"width: 600px; height:400px\" ></div>\n    <div id=\"png\"></div>\n\n    <!-- Script -->\n    <script src=\"//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js\"></script>\n    <script src=\"//ajax.googleapis.com/ajax/libs/jqueryui/1.9.1/jquery-ui.min.js\"></script>\n    <script src=\"https://cdnjs.cloudflare.com/ajax/libs/pivottable/1.4.0/pivot.min.js\"></script>\n    <script src=\"https://cdnjs.cloudflare.com/ajax/libs/pivottable/1.4.0/gchart_renderers.min.js\"></script>\n    <script>\n        var data;\n\n        google.load('visualization', '1.1', {packages:['corechart', 'charteditor', 'treemap', 'sankey', 'calendar']});\n        $(function() {\n            google.script.run\n            .withSuccessHandler(function(files) {\n                var fileSelect = $('#file-select');\n                fileSelect.children().remove();\n                fileSelect.append(\n                    '<option disabled selected>Choose File</option>'\n                    );\n                for (var i = 0; i < files.length; i++) {\n                    fileSelect.append(\n                        '<option value=\"' + files[i].id + '\">' + files[i].path + '</option>');\n                }\n                fileSelect.prop('disabled', false);\n            })\n            .getSpreadSheetFiles(null, null);\n\n            $('.slide_toggle h3').on('click', function() {\n                $(this).toggleClass('open').next().slideToggle();\n            });\n        });\n\n        function updateSheets() {\n            var fileId = $('#file-select').val();\n            var sheetSelect = $('#sheet-select');\n            sheetSelect.prop('disabled', true);\n            sheetSelect.children().remove();\n            sheetSelect.append('<option disabled selected>Loading...</option>');\n            $('#query').prop('disabled', true);\n            $('#query-submit').prop('disabled', true);\n\n            google.script.run\n                .withSuccessHandler(function(sheets) {\n                    var sheetSelect = $('#sheet-select');\n                    sheetSelect.children().remove();\n                    sheetSelect.append(\n                        '<option disabled selected>Choose Sheet</option>'\n                        );\n                    for (var i = 0; i < sheets.length; i++) {\n                        sheetSelect.append('<option>' + sheets[i] + '</option>');\n                    }\n                    sheetSelect.prop('disabled', false);\n                })\n            .getSheets(fileId);\n        }\n\n        function updateData() {                                                        \n            var fileId = $('#file-select').val();                                      \n            var sheetName = $('#sheet-select').val();\n            var query = $('#query').val();\n\n            $('#query').prop('disabled', true);\n            $('#query-submit').prop('disabled', true);\n\n            if (fileId == null || sheetName == null) {\n                return\n            }\n            google.script.run                                                          \n                .withSuccessHandler(function(spreadsheet_url) {\n\n                    var url = spreadsheet_url + \"?sheet=\" + sheetName;\n                    var vq = new google.visualization.Query(url);\n                    if(query) {\n                        vq.setQuery(query);\n                    }\n                    vq.send(handleQueryResponse);\n                    $('#query').prop('disabled', false);\n                    $('#query-submit').prop('disabled', false);\n                })\n            .getUrl(fileId);\n        }\n\n        function updateColumnTable() {\n            if(!$('#query').val()) {\n                var columnsTable = $('#columns');\n                columnsTable.children().remove();\n                columnsTable\n                    .append($('<thead><tr>')\n                            .append('<th>Id</th>')\n                            .append('<th>Label</th>')\n                            .append('<th>Type</th>')\n                           );\n                var tbody = columnsTable.append('<tbody>');\n                for (var ci = 0; ci < data.getNumberOfColumns(); ci++) {\n                    tbody\n                        .append($('<tr>')\n                                .append('<td>' + data.getColumnId(ci) + '</td>')\n                                .append('<td>' + data.getColumnLabel(ci) + '</td>')\n                                .append('<td>' + data.getColumnType(ci) + '</td>')\n                               );\n                }\n            }\n        }\n\n        function updateTable() {   \n            var table =  new google.visualization.Table(document.getElementById('table'));\n            table.draw(data);\n        }\n\n        function updateChart() {\n            var chart;\n            var options;\n            switch($('#chart-type-select').val()){\n                case 'ColumnChart' :\n                    chart =  new google.visualization.ColumnChart(document.getElementById('chart'));\n                    break;\n                case 'ColumnChart(stacked)' :\n                    chart =  new google.visualization.ColumnChart(document.getElementById('chart'));\n                    options = {isStacked: true};\n                    break;\n                case 'ColumnChart(percent)' :\n                    chart =  new google.visualization.ColumnChart(document.getElementById('chart'));\n                    options = {isStacked: 'percent'};\n                    break;\n                case 'BarChart' :\n                    chart =  new google.visualization.BarChart(document.getElementById('chart'));\n                    break;\n                case 'Histogram' :\n                    chart =  new google.visualization.Histogram(document.getElementById('chart'));\n                    break;\n                case 'LineChart' :\n                    chart =  new google.visualization.LineChart(document.getElementById('chart'));\n                    break;\n                case 'AreaChart' :\n                    chart =  new google.visualization.AreaChart(document.getElementById('chart'));\n                    break;\n                case 'AreaChart(stacked)' :\n                    chart =  new google.visualization.AreaChart(document.getElementById('chart'));\n                    options = {isStacked: true};\n                    break;\n                case 'ScatterChart' :\n                    chart =  new google.visualization.ScatterChart(document.getElementById('chart'));\n                    break;\n                case 'BubbleChart' :\n                    chart =  new google.visualization.BubbleChart(document.getElementById('chart'));\n                    break;\n                case 'PieChart' :\n                    chart =  new google.visualization.PieChart(document.getElementById('chart'));\n                    break;\n                case 'CandlestickChart' :\n                    chart =  new google.visualization.CandlestickChart(document.getElementById('chart'));\n                    break;\n                case 'Sankey' :\n                    chart =  new google.visualization.Sankey(document.getElementById('chart'));\n                    break;\n                case 'TreeMap' :\n                    chart =  new google.visualization.TreeMap(document.getElementById('chart'));\n                    break;\n                case 'Gauge' :\n                    chart =  new google.visualization.Gauge(document.getElementById('chart'));\n                    break;\n                case 'Calendar' :\n                    chart =  new google.visualization.Calendar(document.getElementById('chart'));\n                    break;\n            }\n            chart.draw(data, options);\n\n            $('#png').html('');\n            if(chart.getImageURI()) {\n                $('#png').html('<a target=\"_blank\" href=\"' + chart.getImageURI() + '\">Download chart image</a>');\n            }\n        }\n\n        function handleQueryResponse(response) {\n            if (response.isError()) {\n                alert('Error in query: ' + response.getMessage() + ' ' + response.getDetailedMessage());\n                return;\n            }\n            data = response.getDataTable();\n\n            updateColumnTable();\n            updateTable();\n            updateChart();\n        }\n</script>\n\n\n\n\u30e1\u30cb\u30e5\u30fc\u304b\u3089\u300c\u516c\u958b > \u30a6\u30a7\u30d6\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3068\u3057\u3066\u5c0e\u5165\u300d\u3092\u9078\u629e\n\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u30d0\u30fc\u30b8\u30e7\u30f3\u306b\u300c\u65b0\u898f\u4f5c\u6210\u300d\u3068\u5165\u529b\u3057\u3001\u300c\u65b0\u3057\u3044\u30d0\u30fc\u30b8\u30e7\u30f3\u3092\u4fdd\u5b58\u300d\u3092\u30af\u30ea\u30c3\u30af\n\u300c\u5c0e\u5165\u300d\u3092\u30af\u30ea\u30c3\u30af\n\u300c\u73fe\u5728\u306e\u30a6\u30a7\u30d6 \u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e URL\u300d\u306b\u8868\u793a\u3055\u308c\u3066\u3044\u308bURL\u3092\u30d6\u30e9\u30a6\u30b6\u3067\u958b\u304f\n\u6210\u529f\u3057\u3066\u3044\u308c\u3070\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u753b\u9762\u304c\u8868\u793a\u3055\u308c\u307e\u3059\u3002\n\n\n\n\u4f7f\u3044\u65b9\u306e\u4f8b\n\u307e\u305a\u4f7f\u7528\u3059\u308b\u30d5\u30a1\u30a4\u30eb\u3068\u30b7\u30fc\u30c8\u3092\u9078\u629e\u3057\u307e\u3059\u3002\u3053\u3053\u3067\u306f\u30b9\u30d7\u30ec\u30c3\u30c9\u30b7\u30fc\u30c8\u3067\u4f8b\u3068\u3057\u3066\u7528\u3044\u305fCanadian Parliament 2012 dataset\u3092\u5f15\u304d\u7d9a\u304d\u4f7f\u7528\u3057\u307e\u3059\u3002\n\n\u3057\u3070\u3089\u304f\u3059\u308b\u3068\u30b7\u30fc\u30c8\u5185\u306e\u30c7\u30fc\u30bf\u304c\u8aad\u307f\u8fbc\u307e\u308c\u307e\u3059\u3002\nColumns\u306b\u30c7\u30fc\u30bf\u306e\u5404\u5217\u306e\u60c5\u5831\u3001Table\u306b\u30c7\u30fc\u30bf\u304c\u8868\u793a\u3055\u308c\u307e\u3059\u3002\n\n\u30c7\u30fc\u30bf\u306e\u5f62\u5f0f\u304c\u30b0\u30e9\u30d5\u3068\u5408\u3063\u3066\u3044\u308c\u3070\u3053\u306e\u6642\u70b9\u3067Chart\u306b\u30b0\u30e9\u30d5\u304c\u8868\u793a\u3055\u308c\u307e\u3059\u304c\u3001\u4eca\u56de\u306e\u4f8b\u3067\u306f\u8868\u793a\u3067\u304d\u3066\u3044\u307e\u305b\u3093\u3002\n\n\u30b9\u30d7\u30ec\u30c3\u30c9\u30b7\u30fc\u30c8\u306e\u4f8b\u3067\u5229\u7528\u3057\u305f\u4ee5\u4e0b\u306e\u30af\u30a8\u30ea\u3092\u4f7f\u3063\u3066\u5404\u653f\u515a\u306e\u7537\u5973\u5225\u306e\u5e73\u5747\u5e74\u9f62\u3092\u53d6\u5f97\u3057\u307e\u3059\u3002\n\u6b21\u306e\u30af\u30a8\u30ea\u3092\u30c6\u30ad\u30b9\u30c8\u30dc\u30c3\u30af\u30b9\u306b\u5165\u529b\u3057\u300c\u9001\u4fe1\u300d\u30dc\u30bf\u30f3\u3092\u62bc\u3057\u307e\u3059\u3002\u30af\u30a8\u30ea\u306e\u5217\u540d\u306fColumns\u3067\u8abf\u3079\u308b\u4e8b\u304c\u3067\u304d\u307e\u3059\u3002\nSELECT B, AVG(D) GROUP BY B PIVOT E\n\n\u30af\u30a8\u30ea\u3092\u5b9f\u884c\u3057\u3066\u3057\u3070\u3089\u304f\u3059\u308b\u3068\u30c7\u30fc\u30bf\u304c\u66f4\u65b0\u3055\u308c\u307e\u3059\u3002\u30af\u30a8\u30ea\u306e\u7d50\u679c\u304c\u68d2\u30b0\u30e9\u30d5\u3092\u4f5c\u6210\u3067\u304d\u308b\u5f62\u5f0f\u3068\u306a\u3063\u3066\u3044\u308b\u305f\u3081Chart\u306b\u30b0\u30e9\u30d5\u304c\u8868\u793a\u3055\u308c\u3066\u3044\u307e\u3059\u3002\u30b0\u30e9\u30d5\u306e\u7a2e\u985e\u306b\u3088\u3063\u3066\u306f\u300cDownload chart image\u300d\u3092\u30af\u30ea\u30c3\u30af\u3059\u308b\u3053\u3068\u306b\u3088\u3063\u3066\u30a4\u30e1\u30fc\u30b8\u3068\u3057\u3066\u30b0\u30e9\u30d5\u3092\u53d6\u5f97\u3059\u308b\u4e8b\u304c\u3067\u304d\u307e\u3059\u3002\n\nChart Type\u3092\u5909\u66f4\u3059\u308b\u3068\u8868\u793a\u3055\u308c\u308b\u30b0\u30e9\u30d5\u304c\u5909\u308f\u308a\u307e\u3059\u3002\n\n\u30b0\u30e9\u30d5\u306b\u3088\u3063\u3066\u4f7f\u7528\u3067\u304d\u308b\u30c7\u30fc\u30bf\u306e\u5f62\u5f0f\u304c\u7570\u306a\u308a\u307e\u3059\u3002\u5404\u30b0\u30e9\u30d5\u306e\u30c7\u30fc\u30bf\u306e\u5f62\u5f0f\u306b\u3064\u3044\u3066\u306fGoogle Charts\u306e\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u3092\u53c2\u7167\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n\u53c2\u8003\u8cc7\u6599\n\nGoogle Spreadsheet & Google Visualization API\n\nGoogle Visualization API Reference - Google Charts \u2014 Google Developers\nGoogle spreadsheets function list - Docs editors Help\nGoogle Spreadsheet\u3068Query Language - $shibayu36->blog;\n\n\nGoogle Charts\n\nGoogle Charts \u2014 Google Developers\n\n\nCSS\n\njQuery\u3067\u7c21\u5358\u30a2\u30b3\u30fc\u30c7\u30a3\u30aa\u30f3\u306e\u30b5\u30f3\u30d7\u30eb\u3092\u4f5c\u3063\u3066\u307f\u305f\nCSS\u3067\u56f3\u5f62\u3092\u63cf\u304f\u4ed5\u7d44\u307f - Qiita\n\n\u30b9\u30d7\u30ec\u30c3\u30c9\u30b7\u30fc\u30c8\u306eQUERY\u95a2\u6570\u3084Visualization API\u3067\u306fSQL\u30e9\u30a4\u30af\u306a\u30af\u30a8\u30ea\u8a00\u8a9e\u3092\u4f7f\u3063\u3066\u30c7\u30fc\u30bf\u306e\u96c6\u8a08\u3092\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\u4eca\u56de\u306f\u30af\u30a8\u30ea\u8a00\u8a9e\u3092\u4f7f\u3063\u3066\u30c7\u30fc\u30bf\u3092\u96c6\u8a08\u3057\u3001\u7d50\u679c\u3092\u5229\u7528\u3057\u3066\u30b0\u30e9\u30d5\u3092\u63cf\u304f\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u4f5c\u6210\u3057\u3066\u307f\u307e\u3059\u3002\n\n![\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2015-05-17 20.46.57.png](https://qiita-image-store.s3.amazonaws.com/0/15114/97212e41-b5b8-5b3b-90d4-1457d94fa5aa.png)\n\n\u524d\u56de\u4f5c\u6210\u3057\u305fPivotTable.js\u3067\u306f\u96c6\u8a08\u95a2\u6570\u3092\u4e00\u3064\u3057\u304b\u4f7f\u3048\u306a\u3044\u305f\u3081\u3001\u3042\u308b\u5024\u306e\u6700\u5c0f\u5024\u3001\u6700\u5927\u5024\u3001\u5e73\u5747\u3092\u4e26\u3079\u308b\u3068\u3044\u3063\u305f\u3053\u3068\u306f\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f\u3002\u4eca\u56de\u306e\u65b9\u6cd5\u3067\u306f\u540c\u6642\u306b\u96c6\u8a08\u95a2\u6570\u3092\u8907\u6570\u4f7f\u3046\u4e8b\u3082\u53ef\u80fd\u306b\u306a\u3063\u3066\u3044\u307e\u3059\u3002\n\n[Google \u30b9\u30d7\u30ec\u30c3\u30c9\u30b7\u30fc\u30c8\u306e\u30c7\u30fc\u30bf\u3092PivotTable.js\u3067\u8868\u793a\u3059\u308b - Qiita](http://qiita.com/atsaki/items/60dbdfe5ab5133a5f875)\n\n# TL;DR\n\n* \u30b9\u30d7\u30ec\u30c3\u30c9\u30b7\u30fc\u30c8\u306eQUERY\u95a2\u6570\u3001Visualization API\u3067\u306fSQL\u30e9\u30a4\u30af\u306a\u30af\u30a8\u30ea\u8a00\u8a9e\u3092\u4f7f\u3063\u3066\u30b9\u30d7\u30ec\u30c3\u30c9\u30b7\u30fc\u30c8\u304b\u3089\u306e\u30c7\u30fc\u30bf\u53d6\u5f97\u30fb\u96c6\u8a08\u304c\u3067\u304d\u308b\n* \u30af\u30a8\u30ea\u8a00\u8a9e\u306eGROUP BY\u53e5\u3084PIVOT\u53e5\u306f\u30d4\u30dc\u30c3\u30c8\u30c6\u30fc\u30d6\u30eb\u3068\u5bfe\u5fdc\u3065\u3051\u308b\u3068\u899a\u3048\u3084\u3059\u3044\n* \u30af\u30a8\u30ea\u3057\u305f\u7d50\u679c\u304b\u3089Google Charts\u3067\u30b0\u30e9\u30d5\u3092\u4f5c\u6210\u3059\u308b\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u4f5c\u3063\u3066\u307f\u305f\n\n# \u30b9\u30d7\u30ec\u30c3\u30c9\u30b7\u30fc\u30c8\u3067\u306e\u30af\u30a8\u30ea\u5b9f\u884c\n\n\u30af\u30a8\u30ea\u8a00\u8a9e\u306f\u30b9\u30d7\u30ec\u30c3\u30c9\u30b7\u30fc\u30c8\u3001Visualization API\u304b\u3089\u4f7f\u7528\u53ef\u80fd\u3067\u3059\u3002\n\u307e\u305a\u306f\u624b\u8efd\u306a\u30b9\u30d7\u30ec\u30c3\u30c9\u30b7\u30fc\u30c8\u306eQUERY\u95a2\u6570\u3067\u30af\u30a8\u30ea\u3092\u5b9f\u884c\u3057\u3066\u52d5\u4f5c\u3092\u8abf\u3079\u3066\u307f\u307e\u3059\u3002\n\n[QUERY - \u30c9\u30ad\u30e5\u30e1\u30f3\u30c8 \u30a8\u30c7\u30a3\u30bf \u30d8\u30eb\u30d7](https://support.google.com/docs/answer/3093343)\n\n## \u30c7\u30fc\u30bf\u306e\u7528\u610f\n\n\u524d\u56de\u306e\u4f8b\u3067\u4f7f\u7528\u3057\u305f[Canadian Parliament 2012 dataset](http://nicolas.kruchten.com/pivottable/examples/mps.csv) \u3092\u4f7f\u3063\u3066\u3044\u304d\u307e\u3059\u3002\n\n\u9069\u5f53\u306b\u7a7a\u306e\u30b7\u30fc\u30c8\u3092\u958b\u304d\u3001\u30bb\u30eb```A1``` \u306b\u4e0b\u8a18\u3092\u5165\u529b\u3057\u3066\u5b9f\u884c\u3059\u308b\u3068\u30c7\u30fc\u30bf\u304c\u8aad\u307f\u8fbc\u307e\u308c\u307e\u3059\u3002\n\n```text\n=IMPORTDATA(\"http://nicolas.kruchten.com/pivottable/examples/mps.csv\")\n```\n![IMPORTDATA_01.png](https://qiita-image-store.s3.amazonaws.com/0/15114/9186e0ba-ce8b-55f9-b9ed-29c367770069.png)\n\n## QUERY\u95a2\u6570\n\n\u30af\u30a8\u30ea\u306e\u7d50\u679c\u3092\u8868\u793a\u3057\u305f\u3044\u30bb\u30eb\u3067\u6b21\u306e\u3088\u3046\u306bQUERY\u95a2\u6570\u3092\u5b9f\u884c\u3059\u308b\u3068\u7d50\u679c\u304c\u53d6\u5f97\u3067\u304d\u307e\u3059\u3002\n\n```text\n=QUERY(<\u30af\u30a8\u30ea\u306e\u5bfe\u8c61\u306e\u30c7\u30fc\u30bf\u7bc4\u56f2>, <\u30af\u30a8\u30ea>)\n```\n\n\u30af\u30a8\u30ea\u8a00\u8a9e\u306fSQL\u30e9\u30a4\u30af\u306a\u8a00\u8a9e\u3068\u306a\u3063\u3066\u304a\u308a\u3001\u4ee5\u4e0b\u306e\u53e5\u3092\u4f7f\u7528\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\u53e5\u306f\u4ee5\u4e0b\u306e\u9806\u3067\u4f7f\u7528\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\n\n* SELECT\n* WHERE\n* GROUP BY\n* PIVOT\n* ORDER BY\n* LIMIT\n* OFFSET\n* LABEL\n* FORMAT\n* OPTIONS\n\n\u4ee5\u4e0b\u3067\u3088\u304f\u4f7f\u3044\u305d\u3046\u306a\u53e5\u3092\u7d39\u4ecb\u3057\u3066\u3044\u304d\u307e\u3059\u3002\n\n## SELECT\u53e5\n\nSELECT\u53e5\u306f\u51fa\u529b\u3059\u308b\u5217\u3092\u6307\u5b9a\u3059\u308b\u305f\u3081\u306b\u4f7f\u3044\u307e\u3059\u3002\n\n\u8aad\u307f\u8fbc\u3093\u3060\u30c7\u30fc\u30bf\u304b\u3089Party\u3068Age\u5217\u306e\u307f\u3092\u8868\u793a\u3055\u305b\u3066\u307f\u307e\u3059\u3002\n\u4ee5\u4e0b\u306e\u30af\u30a8\u30ea\u3092\u30bb\u30ebG1\u306b\u5165\u529b\u3057\u3066\u5b9f\u884c\u3059\u308b\u3068\u3001Party\u3001Age\u5217\u304c\u51fa\u529b\u3055\u308c\u307e\u3059\u3002\n\uff08\u5217\u306f\u30b9\u30d7\u30ec\u30c3\u30c9\u30b7\u30fc\u30c8\u306e\u5217\u306eID\u3067\u6307\u5b9a\u3057\u307e\u3059\u3002\uff09\n\n```text\n=QUERY(A:E, \"SELECT B, D\")\n```\n\n![SELECT_01.png](https://qiita-image-store.s3.amazonaws.com/0/15114/ebe62bf5-7f4e-4f0c-c146-c1b0c2e6a95c.png)\n\n\n```SELECT *``` \uff08\u307e\u305f\u306fSELECT\u53e5\u3092\u7701\u7565\uff09\u3067\u5168\u3066\u306e\u5217\u3092\u51fa\u529b\u3057\u307e\u3059\u3002\n\n```text\n=QUERY(A:E, \"SELECT *\")\n\u307e\u305f\u306f\n=QUERY(A:E, \"\")\n```\n\n![SELECT_02.png](https://qiita-image-store.s3.amazonaws.com/0/15114/a503877e-d37a-292f-e2a7-6edb373d36a8.png)\n\n## WHERE\u53e5\n\nWHERE\u53e5\u306f\u51fa\u529b\u3059\u308b\u884c\u3092\u9078\u629e\u3059\u308b\u305f\u3081\u306b\u7528\u3044\u3089\u308c\u307e\u3059\u3002\n\n\u4f8b\u3048\u3070Party=NDP\u306e\u884c\u3092\u5f97\u308b\u305f\u3081\u306e\u30af\u30a8\u30ea\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\n\n```text\n=QUERY(A:E, \"SELECT * WHERE B = 'NDP'\")\n\u307e\u305f\u306f\n=QUERY(A:E, \"WHERE B = 'NDP'\")\n```\n\n![WHERE_01.png](https://qiita-image-store.s3.amazonaws.com/0/15114/8b45ae32-3a27-29dc-6e90-bd443eeb2910.png)\n\n\u8907\u6570\u306e\u6761\u4ef6\u3092AND\u3084OR\u3067\u7d44\u307f\u5408\u308f\u305b\u3066\u4f7f\u3046\u4e8b\u3082\u3067\u304d\u307e\u3059\u3002\nParty=NDP\u304b\u3064Province=Quebec\u3067\u3042\u308b\u884c\u306f\u6b21\u306e\u3088\u3046\u306b\u3057\u3066\u5f97\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\uff08\u4ee5\u964d\u3001```SELECT *``` \u3092\u7701\u7565\u3057\u306a\u3044\u3067\u66f8\u304d\u307e\u3059\u3002\uff09\n\n```text\n=QUERY(A:E, \"SELECT * WHERE B = 'NDP'\u3000AND C = 'Quebec'\")\n```\n\n![WHERE_02.png](https://qiita-image-store.s3.amazonaws.com/0/15114/a68e3844-0867-d21a-369c-9c63ec87a7a2.png)\n\n\u6587\u5b57\u5217\u306e\u6bd4\u8f03\u306bLIKE\u7b49\u306e\u6f14\u7b97\u5b50\u3092\u4f7f\u3046\u3053\u3068\u3082\u3067\u304d\u307e\u3059\u3002\u30b5\u30dd\u30fc\u30c8\u3055\u308c\u3066\u3044\u308b\u6f14\u7b97\u5b50\u306b\u3064\u3044\u3066\u306e\u8a73\u7d30\u306f[\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8](https://developers.google.com/chart/interactive/docs/querylanguage#Where)\u3092\u53c2\u7167\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n\u540d\u524d\u304cAllen\u304b\u3089\u59cb\u307e\u308b\u4eba\u306e\u884c\u306f\u4ee5\u4e0b\u306e\u30af\u30a8\u30ea\u3067\u5f97\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n```text\n=QUERY(A:E, \"SELECT * WHERE A LIKE 'Allen%'\")\n```\n\n![WHERE_03.png](https://qiita-image-store.s3.amazonaws.com/0/15114/705d23e1-024d-e162-35a9-585ae7780b16.png)\n\n## GROUP BY\u53e5\n\nGROUP BY\u53e5\u306f\u6307\u5b9a\u3057\u305f\u5c5e\u6027\u306e\u5024\u3067\u30c7\u30fc\u30bf\u3092\u30b0\u30eb\u30fc\u30d7\u5316\u30fb\u96c6\u8a08\u3059\u308b\u305f\u3081\u306b\u7528\u3044\u3089\u308c\u307e\u3059\u3002\n\n\u4ee5\u4e0b\u306e\u30af\u30a8\u30ea\u3067\u3001\u5404\u653f\u515a\u306b\u5c5e\u3057\u3066\u3044\u308b\u4eba\u6570\u3092\u5f97\u308b\u4e8b\u304c\u3067\u304d\u307e\u3059\u3002\n\n```text\n=QUERY(A:E, \"SELECT B, COUNT(A) GROUP BY B\")\n```\n\n![GROUP_BY_01.png](https://qiita-image-store.s3.amazonaws.com/0/15114/98bce996-df03-d9c7-ef9a-74e7dbba0138.png)\n\nParty\u304c\u7a7a\u306e\u4eba\u304c691\u4eba\u3044\u308b\u3053\u3068\u306b\u306a\u3063\u3066\u3044\u307e\u3059\u304c\u3001\u30c7\u30fc\u30bf\u3092\u78ba\u8a8d\u3059\u308b\u3068\u7d50\u679c\u306b\u30c7\u30fc\u30bf\u306e\u7121\u3044\u884c\u304c\u542b\u307e\u308c\u3066\u3044\u308b\u3053\u3068\u304c\u308f\u304b\u308a\u307e\u3059\u3002\n\n\u30c7\u30fc\u30bf\u306e\u7121\u3044\u884c\u3092\u53d6\u308a\u9664\u304f\u305f\u3081\u306bWHERE\u53e5\u3092\u4f7f\u3046\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n```text\n=QUERY(A:E, \"SELECT B, COUNT(A) WHERE A != '' GROUP BY B\")\n```\n\n![GROUP_BY_02.png](https://qiita-image-store.s3.amazonaws.com/0/15114/58d5a0fd-ff17-44e0-3009-1f37ca9f949b.png)\n\n\u30c7\u30fc\u30bf\u7bc4\u56f2\u3067\u884c\u307e\u3067\u6307\u5b9a\u3057QUERY\u95a2\u6570\u306e\u5f15\u6570\u306e\u7bc4\u56f2\u304b\u3089\u30c7\u30fc\u30bf\u306e\u7121\u3044\u884c\u3092\u53d6\u308a\u9664\u304f\u3053\u3068\u306b\u3088\u3063\u3066\u3001\u30c7\u30fc\u30bf\u306e\u306a\u3044\u884c\u304c\u96c6\u8a08\u3055\u308c\u3066\u3057\u307e\u3046\u3053\u3068\u3092\u9632\u3050\u3053\u3068\u3082\u53ef\u80fd\u3067\u3059\u3002\n\u3053\u3061\u3089\u306e\u65b9\u6cd5\u3067\u306fWHERE\u53e5\u306f\u4e0d\u8981\u3067\u30af\u30a8\u30ea\u304c\u77ed\u304f\u306a\u308a\u307e\u3059\u3002\u4ee5\u964d\u3067\u306f\u30af\u30a8\u30ea\u3092\u77ed\u304f\u3059\u308b\u305f\u3081\u3001\u30c7\u30fc\u30bf\u306e\u7bc4\u56f2\u3092\u4fee\u6b63\u3057\u30c7\u30fc\u30bf\u304c\u7121\u3044\u884c\u3092\u96c6\u8a08\u304b\u3089\u9664\u5916\u3057\u307e\u3059\u3002\n\n```text\n=QUERY(A1:E309, \"SELECT B, COUNT(A) GROUP BY B\")\n```\n\n![GROUP_BY_03.png](https://qiita-image-store.s3.amazonaws.com/0/15114/ee80a76b-ea51-f507-b6ef-41110d00251c.png)\n\n\u30af\u30a8\u30ea\u3067\u5f97\u3089\u308c\u308b\u7d50\u679c\u3068\u540c\u69d8\u306e\u7d50\u679c\u3092\u30d4\u30dc\u30c3\u30c8\u30c6\u30fc\u30d6\u30eb\u3067\u3082\u5f97\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\u4eca\u56de\u306e\u30af\u30a8\u30ea\u306f\u30d4\u30dc\u30c3\u30c8\u30c6\u30fc\u30d6\u30eb\u3067\u884c\u306bParty\u3092\u6307\u5b9a\u3057\u3001COUNTA\u3067\u540d\u524d\u3092\u6570\u3048\u308b\u3053\u3068\u306b\u76f8\u5f53\u3057\u3066\u3044\u307e\u3059\u3002\n\n![GROUP_BY_04.png](https://qiita-image-store.s3.amazonaws.com/0/15114/9fc7a940-fd58-d0ce-5cd1-4d0ea3137fd0.png)\n\n\u96c6\u8a08\u95a2\u6570\u306b\u306fCOUNT\u4ee5\u5916\u306b\u3082MIN, MAX, AVG\u306a\u3069\u304c\u30b5\u30dd\u30fc\u30c8\u3055\u308c\u3066\u3044\u307e\u3059\u3002\n\n\u4ee5\u4e0b\u306e\u30af\u30a8\u30ea\u3067\u5404\u653f\u515a\u306e\u5e73\u5747\u5e74\u9f62\u304c\u5f97\u3089\u308c\u307e\u3059\u3002\n\n```text\n=QUERY(A1:E309, \"SELECT B, AVG(D) GROUP BY B\")\n```\n\n![GROUP_BY_05.png](https://qiita-image-store.s3.amazonaws.com/0/15114/8fd500fa-944a-4371-3451-ba15f446d377.png)\n\n\u3053\u306e\u30af\u30a8\u30ea\u306f\u3001\u30d4\u30dc\u30c3\u30c8\u30c6\u30fc\u30d6\u30eb\u3067\u884c\u306bParty\u3092\u6307\u5b9a\u3057AVERAGE\u3067Age\u306e\u5e73\u5747\u3092\u8a08\u7b97\u3059\u308b\u3053\u3068\u306b\u76f8\u5f53\u3057\u307e\u3059\u3002\n\n![GROUP_BY_06.png](https://qiita-image-store.s3.amazonaws.com/0/15114/4cf22bf0-ce2d-e515-d65e-d1fe8ef8c086.png)\n\n\u5404\u653f\u515a\u306e\u5e73\u5747\u5e74\u9f62\u3092\u8a08\u7b97\u3059\u308b\u4e8b\u304c\u3067\u304d\u305f\u306e\u3067\u3053\u308c\u3092\u68d2\u30b0\u30e9\u30d5\u306b\u3057\u3066\u307f\u307e\u3059\u3002\n\uff08\u5e74\u9f62\u3092\u68d2\u30b0\u30e9\u30d5\u3067\u8868\u3059\u306e\u306b\u9055\u548c\u611f\u304c\u3042\u308a\u307e\u3059\u304c\u3001\u3053\u3053\u3067\u306f\u3042\u307e\u308a\u6c17\u306b\u3057\u306a\u3044\u3067\u3044\u305f\u3060\u3051\u308b\u3068\u3042\u308a\u304c\u305f\u3044\u3067\u3059\u3002\uff09\n\n\u30af\u30a8\u30ea\u95a2\u6570\u306b\u3088\u308a\u751f\u6210\u3055\u308c\u305f\u30c6\u30fc\u30d6\u30eb\u5185\u306e\u4efb\u610f\u306e\u30bb\u30eb\u3092\u9078\u629e\u3057\u305f\u72b6\u614b\u3067\u30e1\u30cb\u30e5\u30fc\u304b\u3089\u300c\u633f\u5165 > \u30b0\u30e9\u30d5\u300d\u3067\u30b0\u30e9\u30d5\u3092\u4f5c\u6210\u3059\u308b\u3068\u3001\u81ea\u52d5\u7684\u306b\u30c7\u30fc\u30bf\u306e\u7bc4\u56f2\u3092\u9078\u629e\u3057\u3066\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u30b0\u30e9\u30d5\u3092\u4f5c\u6210\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n![GROUP_BY_07.png](https://qiita-image-store.s3.amazonaws.com/0/15114/d572528d-d132-5d7c-3869-a26a763921bf.png)\n\n\u540c\u69d8\u306b\u30d4\u30dc\u30c3\u30c8\u30c6\u30fc\u30d6\u30eb\u5185\u306e\u30bb\u30eb\u3092\u9078\u629e\u3057\u305f\u72b6\u614b\u3067\u30b0\u30e9\u30d5\u3092\u4f5c\u6210\u3059\u308b\u3068\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u30b0\u30e9\u30d5\u3092\u4f5c\u6210\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\uff08\u30b0\u30e9\u30d5\u3092\u5408\u308f\u305b\u308b\u305f\u3081\u5408\u8a08\u3092\u8868\u793a\u306e\u30c1\u30a7\u30c3\u30af\u3092\u5916\u3057\u3066\u3044\u307e\u3059\u3002\uff09\n\n![GROUP_BY_08.png](https://qiita-image-store.s3.amazonaws.com/0/15114/6d5f34d3-18be-f7f2-d8af-9a8aae46e1b2.png)\n\nGROUP BY\u53e5\u306b\u306f\u8907\u6570\u306e\u5c5e\u6027\u3092\u6307\u5b9a\u3059\u308b\u4e8b\u3082\u53ef\u80fd\u3067\u3059\u3002\u6b21\u306e\u30af\u30a8\u30ea\u3067\u5404\u653f\u515a\u306e\u7537\u5973\u306e\u5e73\u5747\u5e74\u9f62\u3092\u8a08\u7b97\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n```text\n=QUERY(A1:E309, \"SELECT B, E, AVG(D) GROUP BY B, E\")\n```\n\n![GROUP_BY_09.png](https://qiita-image-store.s3.amazonaws.com/0/15114/a0f813b2-4f69-0fdc-b9dc-e32ff9f3a57d.png)\n\nGROUP BY\u306b\u8907\u6570\u306e\u5217\u540d\u3092\u6307\u5b9a\u3059\u308b\u4e8b\u306f\u3001\u30d4\u30dc\u30c3\u30c8\u30c6\u30fc\u30d6\u30eb\u3067\u306f\u884c\u306b\u5c5e\u6027\u3092\u8907\u6570\u8ffd\u52a0\u3059\u308b\u3053\u3068\u306b\u76f8\u5f53\u3057\u307e\u3059\u3002\n\n![GROUP_BY_10.png](https://qiita-image-store.s3.amazonaws.com/0/15114/6c941d23-fe6e-06bc-a498-d8eec100cc71.png)\n\nGROUP BY\u53e5\u306b\u8907\u6570\u306e\u5c5e\u6027\u3092\u6307\u5b9a\u3057\u305f\u30af\u30a8\u30ea\u3092\u5b9f\u884c\u3057\u305f\u7d50\u679c\u304b\u3089\u4e0b\u56f3\u306e\u3088\u3046\u306a\u30b0\u30e9\u30d5\u3092\u63cf\u304d\u305f\u304f\u306a\u308b\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u3002\u3057\u304b\u3057\u3001\u73fe\u5728\u306e\u7d50\u679c\u306e\u8868\u306e\u5f62\u5f0f\u306f\u3053\u306e\u30b0\u30e9\u30d5\u3092\u4f5c\u6210\u3059\u308b\u305f\u3081\u306e\u5f62\u5f0f\u3068\u306a\u3063\u3066\u3044\u307e\u305b\u3093\u3002\n\n![GROUP_BY_11.png](https://qiita-image-store.s3.amazonaws.com/0/15114/72e0d234-53c0-2521-351a-30f45d3ab5b3.png)\n\n\u4e0a\u56f3\u306e\u3088\u3046\u306a\u30b0\u30e9\u30d5\u3092\u63cf\u304f\u305f\u3081\u306b\u306f\u4e0b\u306e\u3088\u3046\u306b\u898b\u51fa\u3057\u3001\u30e9\u30d9\u30eb\u304c1\u884c\u30011\u5217\u306e\u8868\u3092\u4f5c\u6210\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\u3053\u306e\u7d50\u679c\u3092\u5f97\u308b\u305f\u3081\u306b\u306f\u5f8c\u8ff0\u3059\u308bPIVOT\u53e5\u3092\u4f7f\u7528\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\n\n![GROUP_BY_12.png](https://qiita-image-store.s3.amazonaws.com/0/15114/fabd5483-c2bb-ad9f-3b5b-ad43acd3522b.png)\n\nGROUP BY\u53e5\u3092\u4f7f\u7528\u3057\u3066\u3044\u308b\u5834\u5408\u3001SELECT\u53e5\u3067\u96c6\u8a08\u95a2\u6570\u3092\u8907\u6570\u4f7f\u7528\u3059\u308b\u4e8b\u304c\u3067\u304d\u307e\u3059\u3002\u4ee5\u4e0b\u306e\u30af\u30a8\u30ea\u3067\u5404\u653f\u515a\u306e\u515a\u54e1\u306e\u5e74\u9f62\u306e\u6700\u5c0f\u5024\u3001\u5e73\u5747\u3001\u6700\u5927\u5024\u3092\u5f97\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\u3053\u306e\u5834\u5408\u3001\u8868\u306e\u5f62\u5f0f\u304c\u898b\u51fa\u3057\u3001\u30e9\u30d9\u30eb\u304c1\u884c\u30011\u5217\u3068\u306a\u3063\u3066\u3044\u308b\u305f\u3081\u30b0\u30e9\u30d5\u3092\u4f5c\u6210\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n```text\n=QUERY(A1:E309, \"SELECT B, MIN(D), AVG(D), MAX(D) GROUP BY B\")\n```\n\n![GROUP_BY_13.png](https://qiita-image-store.s3.amazonaws.com/0/15114/4ed930dd-c6bd-5620-d927-83544ce8c41c.png)\n\nSELECT\u53e5\u3067\u96c6\u8a08\u95a2\u6570\u3092\u8907\u6570\u4f7f\u7528\u3059\u308b\u3053\u3068\u306f\u3001\u30d4\u30dc\u30c3\u30c8\u30c6\u30fc\u30d6\u30eb\u3067\u306f\u5024\u3092\u8907\u6570\u6307\u5b9a\u3059\u308b\u3053\u3068\u306b\u76f8\u5f53\u3057\u307e\u3059\u3002\n\n![GROUP_BY_14.png](https://qiita-image-store.s3.amazonaws.com/0/15114/7ad6c058-4393-a3ff-3930-a2c84494016f.png)\n\n## PIVOT\u53e5\n\nPIVOT\u53e5\u306f\u6307\u5b9a\u3057\u305f\u5c5e\u6027\u306e\u5024\u3092\u4f7f\u3063\u3066\u65b0\u3057\u3044\u5217\u3092\u4f5c\u308b\u305f\u3081\u306b\u7528\u3044\u3089\u308c\u307e\u3059\u3002\n\nGROUP BY\u53e5\u306e\u4f8b\u3067\u30c7\u30fc\u30bf\u3092\u653f\u515a\u6bce\u306b\u30b0\u30eb\u30fc\u30d7\u5316\u3057\u5404\u653f\u515a\u306e\u5e73\u5747\u5e74\u9f62\u3092\u8a08\u7b97\u3057\u307e\u3057\u305f\u3002\n\u3053\u306e\u3068\u304d\u7d50\u679c\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u653f\u515a\u304c\u884c\u3001\u5e73\u5747\u5e74\u9f62\u304c\u5217\u306b\u306a\u308a\u307e\u3057\u305f\u3002\n\n![GROUP_BY_05.png](https://qiita-image-store.s3.amazonaws.com/0/15114/8fd500fa-944a-4371-3451-ba15f446d377.png)\n\nGROUP BY\u53e5\u306e\u4ee3\u308f\u308a\u306bPIVOT\u53e5\u3092\u4f7f\u3046\u3068\u5404\u653f\u515a\u3092\u5217\u306b\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\nPIVOT\u53e5\u3082GROUP BY\u53e5\u3068\u540c\u69d8\u306b\u30c7\u30fc\u30bf\u306e\u96c6\u8a08\u3092\u884c\u3044\u307e\u3059\u3002\u30c7\u30fc\u30bf\u306e\u96c6\u8a08\u306b\u306fSELECT\u53e5\u3067\u6307\u5b9a\u3057\u305f\u96c6\u8a08\u95a2\u6570\u304c\u4f7f\u7528\u3055\u308c\u307e\u3059\u3002\n\u30b0\u30e9\u30d5\u3092\u307f\u308b\u3068GROUP BY\u53e5\u3067\u4f5c\u6210\u3057\u305f\u3082\u306e\u3068\u5f62\u306f\u540c\u3058\u3067\u3059\u304c\u30c7\u30fc\u30bf\u306e\u7cfb\u5217\u304c\u653f\u515a\u3067\u5206\u304b\u308c\u3066\u3044\u307e\u3059\u3002\n\n```text\n=QUERY(A1:E309, \"SELECT AVG(D) PIVOT B\")\n```\n\n![PIVOT_01.png](https://qiita-image-store.s3.amazonaws.com/0/15114/e95b2ebd-dc76-8d26-7bc2-3df1bce74f7c.png)\n\nGROUP BY\u53e5\u306f\u30d4\u30dc\u30c3\u30c8\u30c6\u30fc\u30d6\u30eb\u306e\u884c\u306b\u5c5e\u6027\u3092\u6307\u5b9a\u3059\u308b\u4e8b\u306b\u5bfe\u5fdc\u3057\u3066\u3044\u307e\u3057\u305f\u3002\u540c\u69d8\u306bPIVOT\u53e5\u306f\u30d4\u30dc\u30c3\u30c8\u30c6\u30fc\u30d6\u30eb\u306e\u5217\u306b\u5c5e\u6027\u3092\u6307\u5b9a\u3059\u308b\u4e8b\u306b\u5bfe\u5fdc\u3057\u3066\u3044\u307e\u3059\u3002\n\n![PIVOT_02.png](https://qiita-image-store.s3.amazonaws.com/0/15114/a0cc7597-4d5a-0335-0c47-d64e29011617.png)\n\nGROUP BY\u53e5\u306e\u8aac\u660e\u306e\u4e2d\u3067\u4ee5\u4e0b\u306e\u30af\u30a8\u30ea\u3067\u653f\u515a\u306e\u7537\u5973\u5225\u306e\u5e73\u5747\u5e74\u9f62\u3092\u5f97\u305f\u5834\u5408\u3001\u8868\u306e\u5f62\u5f0f\u304c\u898b\u51fa\u3057\u3001\u30e9\u30d9\u30eb\u304c1\u884c\u30011\u5217\u3068\u306a\u3089\u305a\u30b0\u30e9\u30d5\u304c\u63cf\u3051\u306a\u3044\u3053\u3068\u306b\u89e6\u308c\u307e\u3057\u305f\u3002\n\n```text\n=QUERY(A1:E309, \"SELECT B, E, AVG(D) GROUP BY B, E\")\n```\n\n\u30b0\u30e9\u30d5\u3092\u63cf\u3051\u308b\u7d50\u679c\u3092\u5f97\u308b\u306b\u306fPIVOT\u53e5\u3092\u7528\u3044\u3066\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u3057\u307e\u3059\u3002\n\n```text\n=QUERY(A1:E309, \"SELECT B, AVG(D) GROUP BY B PIVOT E\")\n```\n\n![PIVOT_03.png](https://qiita-image-store.s3.amazonaws.com/0/15114/b3f4ad18-48b1-c58f-0c66-1d05e34eb781.png)\n\n\u307e\u305f\u306f\u3001B\u3068E\u3092\u5165\u308c\u66ff\u3048\u3066\u6b21\u306e\u3088\u3046\u306b\u3059\u308b\u3068\u884c\u3068\u5217\u304c\u5165\u308c\u66ff\u308f\u308a\u307e\u3059\u3002\n\n```text\n=QUERY(A1:E309, \"SELECT E, AVG(D) GROUP BY E PIVOT B\")\n```\n\n![PIVOT_04.png](https://qiita-image-store.s3.amazonaws.com/0/15114/474daaf7-2b25-7ea3-fd31-272a2b6ccbb5.png)\n\n\u3053\u308c\u3089\u306eGROUP BY\u3068PIVOT\u3092\u7d44\u307f\u5408\u308f\u305b\u305f\u30af\u30a8\u30ea\u306f\u30d4\u30dc\u30c3\u30c8\u30c6\u30fc\u30d6\u30eb\u3067\u306f\u884c\u3068\u5217\u306b\u5c5e\u6027\u3092\u6307\u5b9a\u3059\u308b\u4e8b\u306b\u76f8\u5f53\u3057\u307e\u3059\u3002\n\n![PIVOT_05.png](https://qiita-image-store.s3.amazonaws.com/0/15114/0b5ed736-c39a-b690-dec4-ffb58014d914.png)\n\nGROUP BY\u306b\u8907\u6570\u306e\u5c5e\u6027\u3092\u6307\u5b9a\u3067\u304d\u305f\u3088\u3046\u306b\u3001PIVOT\u306b\u3082\u8907\u6570\u306e\u5c5e\u6027\u3092\u6307\u5b9a\u3059\u308b\u3053\u3068\u304c\u53ef\u80fd\u3067\u3059\u3002\n\u65b0\u3057\u3044\u5217\u540d\u306f\u5c5e\u6027\u306e\u5024\u3092\u30ab\u30f3\u30de\u533a\u5207\u308a\u3067\u7d50\u5408\u3057\u305f\u3082\u306e\u3068\u306a\u308a\u307e\u3059\u3002\n\n```text\n=QUERY(A1:E309, \"SELECT AVG(D) PIVOT B, E\")\n```\n\n![PIVOT_06.png](https://qiita-image-store.s3.amazonaws.com/0/15114/00d172b2-b348-1f9b-69d1-e534ff820c95.png)\n\n\u30d4\u30dc\u30c3\u30c8\u30c6\u30fc\u30d6\u30eb\u3067\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\n\n![PIVOT_07.png](https://qiita-image-store.s3.amazonaws.com/0/15114/49a28269-8837-cdff-ad87-4cf4b65c2dba.png)\n\n## ORDER BY\u53e5\n\nORDER BY\u53e5\u306f\u884c\u3092\u30bd\u30fc\u30c8\u3059\u308b\u305f\u3081\u306b\u7528\u3044\u3089\u308c\u307e\u3059\u3002\n\uff08\u30af\u30a8\u30ea\u3067\u5217\u306f\u30bd\u30fc\u30c8\u3067\u304d\u307e\u305b\u3093\u3002\u30d4\u30dc\u30c3\u30c8\u30c6\u30fc\u30d6\u30eb\u3067\u306f\u3067\u304d\u307e\u3059\u3002\uff09\n\n```text\n=QUERY(A1:E309, \"SELECT B, AVG(D) GROUP BY B ORDER BY AVG(D)\")\n```\n\n![ORDER_BY_01.png](https://qiita-image-store.s3.amazonaws.com/0/15114/a9f82401-e4ec-7de4-ea14-39c19feb28b3.png)\n\n## LABEL\u53e5\n\nLABEL\u53e5\u3092\u306f\u5c5e\u6027\u306b\u30e9\u30d9\u30eb\u3092\u3064\u3051\u308b\u305f\u3081\u306b\u7528\u3044\u3089\u308c\u307e\u3059\u3002\n\n```text\n=QUERY(A1:E309, \"SELECT B, AVG(D) GROUP BY B PIVOT E LABEL B '\u653f\u515a'\")\n```\n\n![LABEL_01.png](https://qiita-image-store.s3.amazonaws.com/0/15114/46040d34-92b1-d6c1-dd50-91e16e4fc078.png)\n\n# Google Visualization API\u3092\u4f7f\u3063\u305f\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\n\nGoogle Visualization API\u3092\u4f7f\u7528\u3059\u308b\u3068\u30a6\u30a7\u30d6\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u304b\u3089\u30b9\u30d7\u30ec\u30c3\u30c9\u30b7\u30fc\u30c8\u306b\u5bfe\u3057\u3066\u30af\u30a8\u30ea\u3092\u5b9f\u884c\u3059\u308b\u4e8b\u304c\u3067\u304d\u307e\u3059\u3002\n\u6b21\u306e\u3088\u3046\u306b\u30b9\u30d7\u30ec\u30c3\u30c9\u30b7\u30fc\u30c8\u306eURL\u3092\u6e21\u3057\u3066Query\u30af\u30e9\u30b9\u3092\u521d\u671f\u5316\u3057\u3001\u30af\u30a8\u30ea\u3092\u30bb\u30c3\u30c8\u3057\u3066\u304b\u3089send\u30e1\u30bd\u30c3\u30c9\u3092\u5b9f\u884c\u3059\u308b\u3068\u30cf\u30f3\u30c9\u30e9\u306b\u7d50\u679c\u304c\u6e21\u3055\u308c\u307e\u3059\u3002\n\n```js\nvar query = new google.visualization.Query(URL);\nquery.setQuery(QUERY);\nquery.send(handleQueryResponse);\n```\n\n\u8a73\u7d30\u306f[\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8](https://developers.google.com/chart/interactive/docs/spreadsheets#Google_Spreadsheets_as_a_Data_Source)\u3092\u53c2\u7167\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n## \u30a6\u30a7\u30d6\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u4f5c\u6210\n\nGoogle Visualization API\u3092\u4f7f\u3063\u3066\u30b9\u30d7\u30ec\u30c3\u30c9\u30b7\u30fc\u30c8\u304b\u3089\u30af\u30a8\u30ea\u3067\u30c7\u30fc\u30bf\u3092\u53d6\u5f97\u30fb\u96c6\u8a08\u3057\u3001\u7d50\u679c\u304b\u3089Google Charts\u3067\u30b0\u30e9\u30d5\u3092\u4f5c\u6210\u3059\u308b\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u4f5c\u3063\u3066\u307f\u307e\u3057\u305f\u3002\n\n\u4ee5\u4e0b\u306e\u624b\u9806\u3067\u4f5c\u6210\u3059\u308b\u4e8b\u304c\u3067\u304d\u307e\u3059\u3002\n\n1. \u30b9\u30af\u30ea\u30d7\u30c8\u30a8\u30c7\u30a3\u30bf(https://script.google.com) \u3092\u958b\u304d\u300c\u7a7a\u306e\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u300d\u3092\u9078\u629e\n2. ```\u30b3\u30fc\u30c9.gs``` \u306e\u4e2d\u8eab\u3092\u5168\u3066\u524a\u9664\u3057\u3001\u4ee5\u4e0b\u306e\u30b3\u30fc\u30c9\u3092\u8cbc\u4ed8\u3051\u3066\u4fdd\u5b58\n   \uff08\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u540d\u306f\u5206\u304b\u308a\u3084\u3059\u3044\u540d\u524d\u3092\u9069\u5f53\u306b\u4ed8\u3051\u3066\u304a\u304d\u307e\u3059\u3002\uff09\n\n    ```js:\u30b3\u30fc\u30c9.gs\n    function doGet(e) {                                                            \n        return HtmlService.createHtmlOutputFromFile('index')                       \n            .setTitle('QueryExample')                                              \n            .setSandboxMode(HtmlService.SandboxMode.IFRAME);                       \n    }                                                                              \n                                                                                   \n    function getSpreadSheetFiles(folder, path) {                                   \n        if (folder == null && path == null) {                                      \n            return getSpreadSheetFiles(DriveApp.getRootFolder(), \"\");              \n        }                                                                          \n                                                                                   \n        var files = [];                                                            \n        path = path + \"/\" + folder.getName();                                      \n                                                                                   \n        var fileIt = folder.getFilesByType(MimeType.GOOGLE_SHEETS);                \n        while(fileIt.hasNext()) {                                                  \n            var f = fileIt.next();                                                 \n            files.push({id: f.getId(), path: path + \"/\" + f.getName()});           \n        }                                                                          \n                                                                                   \n        var folderIt = folder.getFolders();                                        \n        while(folderIt.hasNext()) {                                                \n            fs = getSpreadSheetFiles(folderIt.next(), path);                       \n            for (var i = 0; i < fs.length; i++) {                                  \n                files.push(fs[i]);                                                 \n            }                                                                      \n        }                                                                          \n        return files;                                                              \n    }                                                                              \n                                                                                   \n    function getSheets(fileId) {                                                   \n        var sheets = [];                                                           \n        var spreadsheet = SpreadsheetApp.openById(fileId);                         \n        var sheetsTmp = spreadsheet.getSheets();                                   \n        for (var i = 0; i < sheetsTmp.length; i++) {                               \n            var sheet = sheetsTmp[i];                                              \n            sheets.push(sheet.getSheetName());                                     \n        }                                                                          \n        return sheets;                                                             \n    }                                                                              \n                                                                                   \n    function getUrl(fileId) {                                                      \n        return SpreadsheetApp.openById(fileId).getUrl();                           \n    } \n    ```\n\n3. \u30e1\u30cb\u30e5\u30fc\u304b\u3089\u300c\u5b9f\u884c > doGet\u300d\u3092\u9078\u629e\u3002Drive, SpreadSheet\u306e\u6a29\u9650\u304c\u6c42\u3081\u3089\u308c\u308b\u306e\u3067\u627f\u8a8d\u3059\u308b\n  \uff08html\u30d5\u30a1\u30a4\u30eb\u304c\u7121\u3044\u3068\u3044\u3046\u8b66\u544a\u304c\u3067\u307e\u3059\u304c\u3001\u3053\u3053\u3067\u306f\u7121\u8996\u3057\u307e\u3059\uff09\n\n4. \u30e1\u30cb\u30e5\u30fc\u304b\u3089\u300c\u30d5\u30a1\u30a4\u30eb > \u65b0\u898f\u4f5c\u6210 > HTML\u30d5\u30a1\u30a4\u30eb\u300d\u3092\u9078\u629e\u3057\u3001\u30d5\u30a1\u30a4\u30eb\u540d\u3092```index``` \u3068\u3057\u3066HTML\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\n5. ```index.html``` \u306e\u4e2d\u8eab\u3092\u4e00\u65e6\u5168\u3066\u524a\u9664\u3057\u4ee5\u4e0b\u3092\u8cbc\u4ed8\u3051\u3066\u4fdd\u5b58\u3057\u307e\u3059\u3002\n\n    ```html:index.html\n    <!-- StyleSheet -->\n    <link rel=\"stylesheet\" href=\"https://ssl.gstatic.com/docs/script/css/add-ons.css\">\n    <link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/pivottable/1.4.0/pivot.min.css\">\n    \n    <style>\n        form {\n            margin: 8px;\n        }\n        select {\n            height: 38px;\n        }\n        select#file-select {\n            width: 300px;\n        }\n        select#sheet-select {\n            width: 100px;\n        }\n        input#query {\n            width: 500px;\n        }\n        td, th {\n            padding: 5px 10px;\n        }\n        .slide_toggle h3 {\n            cursor: pointer;\n            border-bottom: 1px solid black ;\n        }\n        .slide_toggle h3:before {\n            content: '';\n            position: relative;\n            float: left;\n            border-top: 10px solid black;\n            border-left: 5px solid transparent;\n            border-right: 5px solid transparent;\n            width: 0;\n            height: 0;\n            top: 5px;\n            right: 5px;\n        }\n        .slide_toggle h3.open::before {\n            content: '';\n            position: relative;\n            float: left;\n            border-left: 10px solid black;\n            border-top: 5px solid transparent;\n            border-bottom: 5px solid transparent;;\n            width: 0;\n            height: 0;\n            top: 5px;\n            right: 5px;\n        }\n    </style>\n    \n    <!-- Body -->\n    <form>\n      <div class=\"inline form-group\">\n          <label for=\"file-select\">File</label>\n          <select id=\"file-select\" disabled onchange=\"$('#query').val(''); updateSheets()\">\n              <option disabled selected>Loading...</option>\n          </select>\n      </div>\n      <div class=\"inline form-group\">\n          <label for=\"sheet-select\">Sheet</label>\n          <select id=\"sheet-select\" disabled onchange=\"$('#query').val(''); updateData()\">\n              <option disabled selected>Loading...</option>\n          </select>\n      </div>\n    </form>\n    \n    <form onsubmit=\"updateData(); return false;\">\n        <div class=\"inline form-group\">\n            <label for=\"query\">Query</label> \n            <input id=\"query\" type=\"text\" disabled >\n        </div>\n        <div class=\"inline form-group\">\n            <input id=\"query-submit\" type=\"submit\" disabled >\n        </div>\n    </form>\n    <div class=\"query-examples\">\n    Query Examples\n      <ul>\n        <li>SELECT * LIMIT 10</li>\n        <li>SELECT B, AVG(D) GROUP BY B PIVOT E</li>\n      </ul>\n    </div>\n    \n    <div class=\"slide_toggle\">\n        <h3>Columns</h3>\n        <table id=\"columns\"></table>\n    </div>\n    \n    <div class=\"slide_toggle\">\n        <h3>Table</h3>\n        <div class=\"block\" id=\"table\"></div>    \n    </div>\n    \n    <div class=\"slide_toggle\">\n        <h3>Chart</h3>\n        <div class=\"inline form-group\">\n            <label for=\"chart-type-select\">Chart Type</label>\n            <select id=\"chart-type-select\" onchange=\"updateChart()\">\n                <option selected>ColumnChart</option>\n                <option>ColumnChart(stacked)</option>\n                <option>ColumnChart(percent)</option>\n                <option>BarChart</option>\n                <option>Histogram</option>\n                <option>LineChart</option>\n                <option>AreaChart</option>\n                <option>AreaChart(stacked)</option>\n                <option>ScatterChart</option>\n                <option>BubbleChart</option>\n                <option>PieChart</option>\n                <option>CandlestickChart</option>\n                <option>Sankey</option>\n                <option>TreeMap</option>\n                <option>Gauge</option>\n                <option>Calendar</option>\n            </select>\n        </div>\n    \n        <div id=\"chart\" style=\"width: 600px; height:400px\" ></div>\n        <div id=\"png\"></div>\n    \n        <!-- Script -->\n        <script src=\"//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js\"></script>\n        <script src=\"//ajax.googleapis.com/ajax/libs/jqueryui/1.9.1/jquery-ui.min.js\"></script>\n        <script src=\"https://cdnjs.cloudflare.com/ajax/libs/pivottable/1.4.0/pivot.min.js\"></script>\n        <script src=\"https://cdnjs.cloudflare.com/ajax/libs/pivottable/1.4.0/gchart_renderers.min.js\"></script>\n        <script>\n            var data;\n            \n            google.load('visualization', '1.1', {packages:['corechart', 'charteditor', 'treemap', 'sankey', 'calendar']});\n            $(function() {\n                google.script.run\n                .withSuccessHandler(function(files) {\n                    var fileSelect = $('#file-select');\n                    fileSelect.children().remove();\n                    fileSelect.append(\n                        '<option disabled selected>Choose File</option>'\n                        );\n                    for (var i = 0; i < files.length; i++) {\n                        fileSelect.append(\n                            '<option value=\"' + files[i].id + '\">' + files[i].path + '</option>');\n                    }\n                    fileSelect.prop('disabled', false);\n                })\n                .getSpreadSheetFiles(null, null);\n            \n                $('.slide_toggle h3').on('click', function() {\n                    $(this).toggleClass('open').next().slideToggle();\n                });\n            });\n            \n            function updateSheets() {\n                var fileId = $('#file-select').val();\n                var sheetSelect = $('#sheet-select');\n                sheetSelect.prop('disabled', true);\n                sheetSelect.children().remove();\n                sheetSelect.append('<option disabled selected>Loading...</option>');\n                $('#query').prop('disabled', true);\n                $('#query-submit').prop('disabled', true);\n            \n                google.script.run\n                    .withSuccessHandler(function(sheets) {\n                        var sheetSelect = $('#sheet-select');\n                        sheetSelect.children().remove();\n                        sheetSelect.append(\n                            '<option disabled selected>Choose Sheet</option>'\n                            );\n                        for (var i = 0; i < sheets.length; i++) {\n                            sheetSelect.append('<option>' + sheets[i] + '</option>');\n                        }\n                        sheetSelect.prop('disabled', false);\n                    })\n                .getSheets(fileId);\n            }\n            \n            function updateData() {                                                        \n                var fileId = $('#file-select').val();                                      \n                var sheetName = $('#sheet-select').val();\n                var query = $('#query').val();\n            \n                $('#query').prop('disabled', true);\n                $('#query-submit').prop('disabled', true);\n            \n                if (fileId == null || sheetName == null) {\n                    return\n                }\n                google.script.run                                                          \n                    .withSuccessHandler(function(spreadsheet_url) {\n            \n                        var url = spreadsheet_url + \"?sheet=\" + sheetName;\n                        var vq = new google.visualization.Query(url);\n                        if(query) {\n                            vq.setQuery(query);\n                        }\n                        vq.send(handleQueryResponse);\n                        $('#query').prop('disabled', false);\n                        $('#query-submit').prop('disabled', false);\n                    })\n                .getUrl(fileId);\n            }\n            \n            function updateColumnTable() {\n                if(!$('#query').val()) {\n                    var columnsTable = $('#columns');\n                    columnsTable.children().remove();\n                    columnsTable\n                        .append($('<thead><tr>')\n                                .append('<th>Id</th>')\n                                .append('<th>Label</th>')\n                                .append('<th>Type</th>')\n                               );\n                    var tbody = columnsTable.append('<tbody>');\n                    for (var ci = 0; ci < data.getNumberOfColumns(); ci++) {\n                        tbody\n                            .append($('<tr>')\n                                    .append('<td>' + data.getColumnId(ci) + '</td>')\n                                    .append('<td>' + data.getColumnLabel(ci) + '</td>')\n                                    .append('<td>' + data.getColumnType(ci) + '</td>')\n                                   );\n                    }\n                }\n            }\n            \n            function updateTable() {   \n                var table =  new google.visualization.Table(document.getElementById('table'));\n                table.draw(data);\n            }\n            \n            function updateChart() {\n                var chart;\n                var options;\n                switch($('#chart-type-select').val()){\n                    case 'ColumnChart' :\n                        chart =  new google.visualization.ColumnChart(document.getElementById('chart'));\n                        break;\n                    case 'ColumnChart(stacked)' :\n                        chart =  new google.visualization.ColumnChart(document.getElementById('chart'));\n                        options = {isStacked: true};\n                        break;\n                    case 'ColumnChart(percent)' :\n                        chart =  new google.visualization.ColumnChart(document.getElementById('chart'));\n                        options = {isStacked: 'percent'};\n                        break;\n                    case 'BarChart' :\n                        chart =  new google.visualization.BarChart(document.getElementById('chart'));\n                        break;\n                    case 'Histogram' :\n                        chart =  new google.visualization.Histogram(document.getElementById('chart'));\n                        break;\n                    case 'LineChart' :\n                        chart =  new google.visualization.LineChart(document.getElementById('chart'));\n                        break;\n                    case 'AreaChart' :\n                        chart =  new google.visualization.AreaChart(document.getElementById('chart'));\n                        break;\n                    case 'AreaChart(stacked)' :\n                        chart =  new google.visualization.AreaChart(document.getElementById('chart'));\n                        options = {isStacked: true};\n                        break;\n                    case 'ScatterChart' :\n                        chart =  new google.visualization.ScatterChart(document.getElementById('chart'));\n                        break;\n                    case 'BubbleChart' :\n                        chart =  new google.visualization.BubbleChart(document.getElementById('chart'));\n                        break;\n                    case 'PieChart' :\n                        chart =  new google.visualization.PieChart(document.getElementById('chart'));\n                        break;\n                    case 'CandlestickChart' :\n                        chart =  new google.visualization.CandlestickChart(document.getElementById('chart'));\n                        break;\n                    case 'Sankey' :\n                        chart =  new google.visualization.Sankey(document.getElementById('chart'));\n                        break;\n                    case 'TreeMap' :\n                        chart =  new google.visualization.TreeMap(document.getElementById('chart'));\n                        break;\n                    case 'Gauge' :\n                        chart =  new google.visualization.Gauge(document.getElementById('chart'));\n                        break;\n                    case 'Calendar' :\n                        chart =  new google.visualization.Calendar(document.getElementById('chart'));\n                        break;\n                }\n                chart.draw(data, options);\n            \n                $('#png').html('');\n                if(chart.getImageURI()) {\n                    $('#png').html('<a target=\"_blank\" href=\"' + chart.getImageURI() + '\">Download chart image</a>');\n                }\n            }\n            \n            function handleQueryResponse(response) {\n                if (response.isError()) {\n                    alert('Error in query: ' + response.getMessage() + ' ' + response.getDetailedMessage());\n                    return;\n                }\n                data = response.getDataTable();\n            \n                updateColumnTable();\n                updateTable();\n                updateChart();\n            }\n    </script>\n    ```\n\n6. \u30e1\u30cb\u30e5\u30fc\u304b\u3089\u300c\u516c\u958b > \u30a6\u30a7\u30d6\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3068\u3057\u3066\u5c0e\u5165\u300d\u3092\u9078\u629e\n7. \u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u30d0\u30fc\u30b8\u30e7\u30f3\u306b\u300c\u65b0\u898f\u4f5c\u6210\u300d\u3068\u5165\u529b\u3057\u3001\u300c\u65b0\u3057\u3044\u30d0\u30fc\u30b8\u30e7\u30f3\u3092\u4fdd\u5b58\u300d\u3092\u30af\u30ea\u30c3\u30af\n8. \u300c\u5c0e\u5165\u300d\u3092\u30af\u30ea\u30c3\u30af\n9. \u300c\u73fe\u5728\u306e\u30a6\u30a7\u30d6 \u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e URL\u300d\u306b\u8868\u793a\u3055\u308c\u3066\u3044\u308bURL\u3092\u30d6\u30e9\u30a6\u30b6\u3067\u958b\u304f\n   \u6210\u529f\u3057\u3066\u3044\u308c\u3070\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u753b\u9762\u304c\u8868\u793a\u3055\u308c\u307e\u3059\u3002\n\n![App_01.png](https://qiita-image-store.s3.amazonaws.com/0/15114/999e55a5-1975-baeb-7f3d-24c9a68e63ff.png)\n\n## \u4f7f\u3044\u65b9\u306e\u4f8b\n\n\u307e\u305a\u4f7f\u7528\u3059\u308b\u30d5\u30a1\u30a4\u30eb\u3068\u30b7\u30fc\u30c8\u3092\u9078\u629e\u3057\u307e\u3059\u3002\u3053\u3053\u3067\u306f\u30b9\u30d7\u30ec\u30c3\u30c9\u30b7\u30fc\u30c8\u3067\u4f8b\u3068\u3057\u3066\u7528\u3044\u305f[Canadian Parliament 2012 dataset](http://nicolas.kruchten.com/pivottable/examples/mps.csv)\u3092\u5f15\u304d\u7d9a\u304d\u4f7f\u7528\u3057\u307e\u3059\u3002\n\n![Usage_01.png](https://qiita-image-store.s3.amazonaws.com/0/15114/13d75433-89c3-d4e9-e6e3-7a282d2037d4.png)\n\n\u3057\u3070\u3089\u304f\u3059\u308b\u3068\u30b7\u30fc\u30c8\u5185\u306e\u30c7\u30fc\u30bf\u304c\u8aad\u307f\u8fbc\u307e\u308c\u307e\u3059\u3002\nColumns\u306b\u30c7\u30fc\u30bf\u306e\u5404\u5217\u306e\u60c5\u5831\u3001Table\u306b\u30c7\u30fc\u30bf\u304c\u8868\u793a\u3055\u308c\u307e\u3059\u3002\n\n![Usage_02.png](https://qiita-image-store.s3.amazonaws.com/0/15114/580560a2-53f0-38d0-828e-d01281a8635d.png)\n\n\u30c7\u30fc\u30bf\u306e\u5f62\u5f0f\u304c\u30b0\u30e9\u30d5\u3068\u5408\u3063\u3066\u3044\u308c\u3070\u3053\u306e\u6642\u70b9\u3067Chart\u306b\u30b0\u30e9\u30d5\u304c\u8868\u793a\u3055\u308c\u307e\u3059\u304c\u3001\u4eca\u56de\u306e\u4f8b\u3067\u306f\u8868\u793a\u3067\u304d\u3066\u3044\u307e\u305b\u3093\u3002\n\n![Usage_03.png](https://qiita-image-store.s3.amazonaws.com/0/15114/b4ea79fc-a650-0af6-51f5-5faaf448beab.png)\n\n\u30b9\u30d7\u30ec\u30c3\u30c9\u30b7\u30fc\u30c8\u306e\u4f8b\u3067\u5229\u7528\u3057\u305f\u4ee5\u4e0b\u306e\u30af\u30a8\u30ea\u3092\u4f7f\u3063\u3066\u5404\u653f\u515a\u306e\u7537\u5973\u5225\u306e\u5e73\u5747\u5e74\u9f62\u3092\u53d6\u5f97\u3057\u307e\u3059\u3002\n\u6b21\u306e\u30af\u30a8\u30ea\u3092\u30c6\u30ad\u30b9\u30c8\u30dc\u30c3\u30af\u30b9\u306b\u5165\u529b\u3057\u300c\u9001\u4fe1\u300d\u30dc\u30bf\u30f3\u3092\u62bc\u3057\u307e\u3059\u3002\u30af\u30a8\u30ea\u306e\u5217\u540d\u306fColumns\u3067\u8abf\u3079\u308b\u4e8b\u304c\u3067\u304d\u307e\u3059\u3002\n\n```text\nSELECT B, AVG(D) GROUP BY B PIVOT E\n```\n\n\u30af\u30a8\u30ea\u3092\u5b9f\u884c\u3057\u3066\u3057\u3070\u3089\u304f\u3059\u308b\u3068\u30c7\u30fc\u30bf\u304c\u66f4\u65b0\u3055\u308c\u307e\u3059\u3002\u30af\u30a8\u30ea\u306e\u7d50\u679c\u304c\u68d2\u30b0\u30e9\u30d5\u3092\u4f5c\u6210\u3067\u304d\u308b\u5f62\u5f0f\u3068\u306a\u3063\u3066\u3044\u308b\u305f\u3081Chart\u306b\u30b0\u30e9\u30d5\u304c\u8868\u793a\u3055\u308c\u3066\u3044\u307e\u3059\u3002\u30b0\u30e9\u30d5\u306e\u7a2e\u985e\u306b\u3088\u3063\u3066\u306f\u300cDownload chart image\u300d\u3092\u30af\u30ea\u30c3\u30af\u3059\u308b\u3053\u3068\u306b\u3088\u3063\u3066\u30a4\u30e1\u30fc\u30b8\u3068\u3057\u3066\u30b0\u30e9\u30d5\u3092\u53d6\u5f97\u3059\u308b\u4e8b\u304c\u3067\u304d\u307e\u3059\u3002\n\n![Usage_04.png](https://qiita-image-store.s3.amazonaws.com/0/15114/9f7f822d-ce91-48da-38ab-d6bd5547b69b.png)\n\nChart Type\u3092\u5909\u66f4\u3059\u308b\u3068\u8868\u793a\u3055\u308c\u308b\u30b0\u30e9\u30d5\u304c\u5909\u308f\u308a\u307e\u3059\u3002\n\n![Usage_05.png](https://qiita-image-store.s3.amazonaws.com/0/15114/f8188bb1-debb-f22d-ff92-1bae5f3c65cf.png)\n\n\u30b0\u30e9\u30d5\u306b\u3088\u3063\u3066\u4f7f\u7528\u3067\u304d\u308b\u30c7\u30fc\u30bf\u306e\u5f62\u5f0f\u304c\u7570\u306a\u308a\u307e\u3059\u3002\u5404\u30b0\u30e9\u30d5\u306e\u30c7\u30fc\u30bf\u306e\u5f62\u5f0f\u306b\u3064\u3044\u3066\u306f[Google Charts\u306e\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8](https://developers.google.com/chart/)\u3092\u53c2\u7167\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n# \u53c2\u8003\u8cc7\u6599\n\n#### Google Spreadsheet & Google Visualization API\n\n* [Google Visualization API Reference - Google Charts \u2014 Google Developers](https://developers.google.com/chart/interactive/docs/reference)\n* [Google spreadsheets function list - Docs editors Help](https://support.google.com/docs/table/25273?hl=en)\n* [Google Spreadsheet\u3068Query Language - $shibayu36->blog;](http://blog.shibayu36.org/entry/2014/09/13/121533)\n\n#### Google Charts\n\n* [Google Charts \u2014 Google Developers](https://developers.google.com/chart/)\n\n#### CSS\n\n* [jQuery\u3067\u7c21\u5358\u30a2\u30b3\u30fc\u30c7\u30a3\u30aa\u30f3\u306e\u30b5\u30f3\u30d7\u30eb\u3092\u4f5c\u3063\u3066\u307f\u305f](http://news.ko-zu.com/accordion/)\n* [CSS\u3067\u56f3\u5f62\u3092\u63cf\u304f\u4ed5\u7d44\u307f - Qiita](http://qiita.com/marrontan619/items/46cc48abfde4592b0a99)\n", "tags": ["GoogleAppsScript", "GoogleSpreadSheet", "GoogleChartAPI"]}