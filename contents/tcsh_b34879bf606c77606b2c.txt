{"context": "\n\n\u524d\u63d0\u6761\u4ef6\n\nLambda\u3078\u306e\u6a29\u9650\nLambda\u306b\u5bfe\u3057\u3066\u30d5\u30eb\u6a29\u9650\u304c\u3042\u308b\u3053\u3068\u3002\n\nAWS CLI\n\u4ee5\u4e0b\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u3067\u52d5\u4f5c\u78ba\u8a8d\u6e08\n\nAWS CLI 1.9.0\n\n\n\u30b3\u30de\u30f3\u30c9\naws --version\n\n\n\n\u7d50\u679c(\u4f8b)\n      aws-cli/1.9.0 Python/2.7.5 Darwin/13.4.0 botocore/1.3.0\n\n\n\n0. \u6e96\u5099\n\n\u5909\u6570\u306e\u78ba\u8a8d\n\u30d7\u30ed\u30d5\u30a1\u30a4\u30eb\u304c\u60f3\u5b9a\u306e\u3082\u306e\u306b\u306a\u3063\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\n\n\u5909\u6570\u306e\u78ba\u8a8d\naws configure list\n\n\n\n\u7d50\u679c(\u4f8b)\n            Name                    Value             Type    Location\n            ----                    -----             ----    --------\n         profile       administrator-prjz-mbp13        env    AWS_DEFAULT_PROFILE\n      access_key     ****************XXXX shared-credentials-file\n      secret_key     ****************XXXX shared-credentials-file\n          region                ap-northeast-1        env    AWS_DEFAULT_REGION\n\n\n\u30d7\u30ed\u30d5\u30a1\u30a4\u30eb\u304c\u60f3\u5b9a\u306e\u3082\u306e\u306b\u306a\u3063\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\n\n1. \u4e8b\u524d\u4f5c\u696d\n\n1.1. Lambda\u95a2\u6570\u540d\u306e\u6c7a\u5b9a\n\n\u30b3\u30de\u30f3\u30c9\naws lambda list-functions \\\n        --query 'Functions[].FunctionName'\n\n\n\n\u7d50\u679c(\u4f8b)\n      [\n        \"HelloWorld\"\n      ]\n\n\n\n\u5909\u6570\u306e\u8a2d\u5b9a\nLAMBDA_FUNC_NAME='HelloWorld'\n\n\n\n1.2. Lambda\u95a2\u6570\n\n\u5909\u6570\u306e\u8a2d\u5b9a\nFILE_LAMBDA_FUNC=\"${LAMBDA_FUNC_NAME}.js\"\n\n\n\n\u5909\u6570\u306e\u78ba\u8a8d\ncat << ETX\n\n        FILE_LAMBDA_FUNC: ${FILE_LAMBDA_FUNC}\n\nETX\n\n\n\n\u30b3\u30de\u30f3\u30c9\ncat << EOF > ${FILE_LAMBDA_FUNC}\nconsole.log('Loading function');\n\nexports.handler = function(event, context) {\n        console.log('value1 =', event.key2);\n        console.log('value2 =', event.key3);\n        console.log('value3 =', event.key1);\n        context.succeed(event.key2);  // Echo back the first key value\n        // context.fail('Something went wrong');\n};\nEOF\n\ncat ${FILE_LAMBDA_FUNC}\n\n\n\n\u30b3\u30de\u30f3\u30c9\nzip ${LAMBDA_FUNC_NAME}-new.zip ${FILE_LAMBDA_FUNC}\n\n\n\n\u7d50\u679c\n      adding: HelloWorld.js (deflated 43%)\n\n\n\n2. Lambda\u95a2\u6570\u306e\u66f4\u65b0\n\n2.1. Lambda\u95a2\u6570\u306e\u66f4\u65b0\n\n\u5909\u6570\u306e\u8a2d\u5b9a\nFILE_LAMBDA_ZIP=\"${LAMBDA_FUNC_NAME}-new.zip\"\n\n\n\n\u5909\u6570\u306e\u78ba\u8a8d\ncat << ETX\n\n        LAMBDA_FUNC_NAME:  ${LAMBDA_FUNC_NAME}\n        FILE_LAMBDA_ZIP:   ${FILE_LAMBDA_ZIP}\n\nETX\n\n\n\n\u30b3\u30de\u30f3\u30c9\naws lambda update-function-code \\\n        --function-name ${LAMBDA_FUNC_NAME} \\\n        --zip-file fileb://${FILE_LAMBDA_ZIP} \\\n        --publish\n\n\n\n\u7d50\u679c(\u4f8b)\n\n      {\n        \"CodeSha256\": \"xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx=\",\n        \"FunctionName\": \"HelloWorld\",\n        \"CodeSize\": 349,\n        \"MemorySize\": 128,\n        \"FunctionArn\": \"arn:aws:lambda:ap-northeast-1:XXXXXXXXXXXX:function:HelloWorld:2\",\n        \"Version\": \"2\",\n        \"Role\": \"arn:aws:iam::XXXXXXXXXXXX:role/lambdaBasicExecution\",\n        \"Timeout\": 2,\n        \"LastModified\": \"2015-10-26T01:23:45.678+0000\",\n        \"Handler\": \"HelloWorld.handler\",\n        \"Runtime\": \"nodejs\",\n        \"Description\": \"Hello World with AWS Lambda function.\"\n      }\n\n\n\n2.2. Lambda\u95a2\u6570\u306e\u78ba\u8a8d\n\n\u30b3\u30de\u30f3\u30c9\naws lambda get-function \\\n        --function-name ${LAMBDA_FUNC_NAME}\n\n\n\n\u7d50\u679c(\u4f8b)\n\n      {\n        \"Code\": {\n          \"RepositoryType\": \"S3\",\n          \"Location\": \"https://awslambda-ap-ne-1-tasks.s3-ap-northeast-1.amazonaws.com/snapshots/XXXXXXXXXXXX/HelloWorld-38950242-86bb-4cbb-bab7-27dfdec7f362?x-amz-security-token=AQoDYXdzEDwa8AMILEth%2BKa19K9tePesujMLPz9zX2%2Fglxg9xU%2BPwvLP8ZMoogywweINkAhFta2lr88GEKJwk8x077DnoOmYeXmD2XE2bXbYPgNAFJU2JYgpnxckoXt2qrNAQKUpCtWqeCwHm34d%2FRhoVDXIbhHpn4iMkg%2BCFfU5%2BtjYsZQzp6CfcDUd3fZXYgSBjCJdpTIc222P6zcusHt%2FPc9ob016zlAkIuEi5ZZhXwZFouF7wwURvSo0QbZ1e1M2DwqNfL1bpC3oEPGrKM43XtwEvVSpMu%2FwdDQHBi1f8B7xJbmjNXA7zg%2BLybhUHioDdLPlS2NDgSXUO4QP3BMmTDeLN5Z6rx0ddjl1JJpLczIl6Plzln0NMQ14dkkIKriteFL09Ei0DJQ7Y%2BiXPNMStM66vsN%2F9yAHGNxCrFKEH0t9lgV2Od6%2Fny3MmNQiNSaaqCHsnKpLbabLSy82dsQwhW35XPCJPShwbgXPB9RPXjx%2FqBCnyGztXE7s6vsBy3AmJbctcDcgte2cpvcoEkg4H%2BrDTaBRvDYlqxEj71C3WLLI62z6OLS5fxkYmYfDZzhDQ5oLg5eyvXxlwugkvh%2Fo7pKuo%2B48liADEZDyLKHqFPH0j924OYRJrtr2b1iw4nrwyMAE7VnQBLAFfPWnWeiD3lfDKARvUpFeINW2trEF&AWSAccessKeyId=ASIAJDZ6MUQCOK4OEDVQ&Expires=1445835375&Signature=uzNTBfSjf1kwixwHBT5LsRtQowo%3D\"\n        },\n        \"Configuration\": {\n          \"Version\": \"$LATEST\",\n          \"CodeSha256\": \"+EAYs8jMYFRBdnsMdFUt2bv//KHE2tkovql6ls+gXoM=\",\n          \"FunctionName\": \"HelloWorld\",\n          \"MemorySize\": 128,\n          \"CodeSize\": 349,\n          \"FunctionArn\": \"arn:aws:lambda:ap-northeast-1:XXXXXXXXXXXX:function:HelloWorld\",\n          \"Handler\": \"HelloWorld.handler\",\n          \"Role\": \"arn:aws:iam::XXXXXXXXXXXX:role/lambdaBasicExecution\",\n          \"Timeout\": 3,\n          \"LastModified\": \"2015-10-26T04:41:36.261+0000\",\n          \"Runtime\": \"nodejs\",\n          \"Description\": \"\\ |LAMBDA_FUNC_DESC|\\ \"\n        }\n      }\n\n\n\n2.3. \u30d0\u30fc\u30b8\u30e7\u30f3\u756a\u53f7\u306e\u53d6\u5f97\n\n\u5909\u6570\u306e\u8a2d\u5b9a\nLAMBDA_FUNC_VER=$( \\\n        hash=$( \\\n          aws lambda list-versions-by-function \\\n            --function-name ${LAMBDA_FUNC_NAME} \\\n            --query 'Versions[?Version == `$LATEST`].CodeSha256' \\\n            --output text \\\n        ) \\\n        && aws lambda list-versions-by-function \\\n          --function-name ${LAMBDA_FUNC_NAME} \\\n          --query \"Versions[?CodeSha256 == \\`${hash}\\` && Version != \\`\\$LATEST\\`].Version[]\" \\\n          --output text \\\n      ) \\\n        && echo ${LAMBDA_FUNC_VER}\n\n\n\n\u7d50\u679c(\u4f8b)\n2\n\n\n\n3. Lambda\u95a2\u6570\u306e\u52d5\u4f5c\u78ba\u8a8d\n\n3.1. \u30b5\u30f3\u30d7\u30eb\u30c7\u30fc\u30bf\u306e\u4f5c\u6210\n\n\u5909\u6570\u306e\u8a2d\u5b9a\nFILE_DATA_LAMBDA=\"${LAMBDA_FUNC_NAME}-data.json\" \\\n        && echo ${FILE_DATA_LAMBDA}\n\n\n\n\u30b5\u30f3\u30d7\u30eb\u30c7\u30fc\u30bf\ncat << EOF > ${FILE_DATA_LAMBDA}\n{\n          \"key1\": \"val1\",\n          \"key2\": \"val2\",\n          \"key3\": \"val3\"\n}\nEOF\n\ncat ${FILE_DATA_LAMBDA}\n\n\n\n\u30b3\u30de\u30f3\u30c9\njsonlint -q ${FILE_DATA_LAMBDA}\n\n\n\n\u5909\u6570\u306e\u8a2d\u5b9a\nFILE_OUTPUT_LAMBDA=\"${LAMBDA_FUNC_NAME}-out.txt\" \\\n        && echo ${FILE_OUTPUT_LAMBDA}\n\n\n\n\u5909\u6570\u306e\u78ba\u8a8d\ncat << ETX\n\n        LAMBDA_FUNC_NAME:   ${LAMBDA_FUNC_NAME}\n        FILE_DATA_LAMBDA:   ${FILE_DATA_LAMBDA}\n        FILE_OUTPUT_LAMBDA: ${FILE_OUTPUT_LAMBDA}\n\nETX\n\n\n\n\u30b3\u30de\u30f3\u30c9\nFILE_LOG_LAMBDA=\"${LAMBDA_FUNC_NAME}-$(date +%Y%m%d%H%M%S).log\" \\\n        && echo ${FILE_LOG_LAMBDA}\n\n\n\n\u30b3\u30de\u30f3\u30c9\naws lambda invoke \\\n        --function-name ${LAMBDA_FUNC_NAME} \\\n        --log-type Tail \\\n        --payload file://${FILE_DATA_LAMBDA} \\\n        ${FILE_OUTPUT_LAMBDA} \\\n        > ${FILE_LOG_LAMBDA}\n\n\n\n\u30b3\u30de\u30f3\u30c9\ncat ${FILE_LOG_LAMBDA} \\\n  | jp.py 'StatusCode'\n\n\n\n\u7d50\u679c(\u4f8b)\n      200\n\n\n\n\u30b3\u30de\u30f3\u30c9\ncat ${FILE_OUTPUT_LAMBDA}\n\n\n\n\u7d50\u679c\n      val2\n\n\n\n\u30b3\u30de\u30f3\u30c9\ncat ${FILE_LOG_LAMBDA} \\\n        | jp.py 'LogResult' \\\n        | sed 's/\"//' \\\n        | base64 --decode\n\n\n\n\u7d50\u679c\n      START RequestId: 1dc6ae3a-7b9d-11e5-a29a-b93d2ad7eab9 Version: $LATEST\n      2015-10-26T04:50:45.532Z    1dc6ae3a-7b9d-11e5-a29a-b93d2ad7eab9    value1 = val2\n      2015-10-26T04:50:45.532Z    1dc6ae3a-7b9d-11e5-a29a-b93d2ad7eab9    value2 = val3\n      2015-10-26T04:50:45.532Z    1dc6ae3a-7b9d-11e5-a29a-b93d2ad7eab9    value3 = val1\n      END RequestId: 1dc6ae3a-7b9d-11e5-a29a-b93d2ad7eab9\n      REPORT RequestId: 1dc6ae3a-7b9d-11e5-a29a-b93d2ad7eab9      Duration: 6.34 ms       Billed Duration: 100 ms         Memory Size: 128 MB     Max Memory Used: 27 MB\n\n\n\n4. \u30a8\u30a4\u30ea\u30a2\u30b9\u306e\u66f4\u65b0\n\n4.1. \u30a8\u30a4\u30ea\u30a2\u30b9\u306e\u78ba\u8a8d\n\n\u5909\u6570\u306e\u8a2d\u5b9a\nLAMBDA_ALIAS_NAME='product'\n\n\n\n\u30b3\u30de\u30f3\u30c9\naws lambda get-alias \\\n        --function-name ${LAMBDA_FUNC_NAME} \\\n        --name ${LAMBDA_ALIAS_NAME}\n\n\n\n\u7d50\u679c(\u4f8b)\n      {\n        \"AliasArn\": \"arn:aws:lambda:ap-northeast-1:XXXXXXXXXXXX:function:HelloWorld:product\",\n        \"FunctionVersion\": \"1\",\n        \"Name\": \"product\",\n        \"Description\": \"Released version on product env.\"\n      }\n\n\n\n4.2. \u30a8\u30a4\u30ea\u30a2\u30b9\u306e\u66f4\u65b0\n\n\u30b3\u30de\u30f3\u30c9\naws lambda update-alias \\\n        --function-name ${LAMBDA_FUNC_NAME} \\\n        --function-version ${LAMBDA_FUNC_VER} \\\n        --name ${LAMBDA_ALIAS_NAME}\n\n\n\n\u7d50\u679c(\u4f8b)\n      {\n        \"AliasArn\": \"arn:aws:lambda:ap-northeast-1:XXXXXXXXXXXX:function:HelloWorld:product\",\n        \"FunctionVersion\": \"2\",\n        \"Name\": \"product\",\n        \"Description\": \"Released version on product env.\"\n      }\n\n\n\n4.3. \u30a8\u30a4\u30ea\u30a2\u30b9\u306e\u78ba\u8a8d\n\n\u30b3\u30de\u30f3\u30c9\naws lambda get-alias \\\n        --function-name ${LAMBDA_FUNC_NAME} \\\n        --name ${LAMBDA_ALIAS_NAME}\n\n\n\n\u7d50\u679c(\u4f8b)\n      {\n        \"AliasArn\": \"arn:aws:lambda:ap-northeast-1:XXXXXXXXXXXX:function:HelloWorld:product\",\n        \"FunctionVersion\": \"2\",\n        \"Name\": \"product\",\n        \"Description\": \"Released version on product env.\"\n      }\n\n\n\n\u5b8c\u4e86\n\u524d\u63d0\u6761\u4ef6\n========\n\n\nLambda\u3078\u306e\u6a29\u9650\n--------------\n\nLambda\u306b\u5bfe\u3057\u3066\u30d5\u30eb\u6a29\u9650\u304c\u3042\u308b\u3053\u3068\u3002\n\n\nAWS CLI\n-------\n\n\u4ee5\u4e0b\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u3067\u52d5\u4f5c\u78ba\u8a8d\u6e08\n\n* AWS CLI 1.9.0\n\n```bash:\u30b3\u30de\u30f3\u30c9:\naws --version\n```\n\n```text:\u7d50\u679c(\u4f8b):\n      aws-cli/1.9.0 Python/2.7.5 Darwin/13.4.0 botocore/1.3.0\n```\n\n\n0. \u6e96\u5099\n=======\n\n\n\u5909\u6570\u306e\u78ba\u8a8d\n----------\n\n\u30d7\u30ed\u30d5\u30a1\u30a4\u30eb\u304c\u60f3\u5b9a\u306e\u3082\u306e\u306b\u306a\u3063\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\n\n```bash:\u5909\u6570\u306e\u78ba\u8a8d:\naws configure list\n```\n\n```text:\u7d50\u679c(\u4f8b):\n            Name                    Value             Type    Location\n            ----                    -----             ----    --------\n         profile       administrator-prjz-mbp13        env    AWS_DEFAULT_PROFILE\n      access_key     ****************XXXX shared-credentials-file\n      secret_key     ****************XXXX shared-credentials-file\n          region                ap-northeast-1        env    AWS_DEFAULT_REGION\n```\n\n\u30d7\u30ed\u30d5\u30a1\u30a4\u30eb\u304c\u60f3\u5b9a\u306e\u3082\u306e\u306b\u306a\u3063\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\n\n\n1. \u4e8b\u524d\u4f5c\u696d\n===========\n\n\n1.1. Lambda\u95a2\u6570\u540d\u306e\u6c7a\u5b9a\n-----------------------\n\n```bash:\u30b3\u30de\u30f3\u30c9:\naws lambda list-functions \\\n        --query 'Functions[].FunctionName'\n```\n\n```json:\u7d50\u679c(\u4f8b):\n      [\n        \"HelloWorld\"\n      ]\n```\n\n```bash:\u5909\u6570\u306e\u8a2d\u5b9a:\nLAMBDA_FUNC_NAME='HelloWorld'\n```\n\n\n1.2. Lambda\u95a2\u6570\n---------------\n\n```bash:\u5909\u6570\u306e\u8a2d\u5b9a:\nFILE_LAMBDA_FUNC=\"${LAMBDA_FUNC_NAME}.js\"\n```\n\n```bash:\u5909\u6570\u306e\u78ba\u8a8d:\ncat << ETX\n\n        FILE_LAMBDA_FUNC: ${FILE_LAMBDA_FUNC}\n\nETX\n```\n\n```bash:\u30b3\u30de\u30f3\u30c9:\ncat << EOF > ${FILE_LAMBDA_FUNC}\nconsole.log('Loading function');\n\nexports.handler = function(event, context) {\n        console.log('value1 =', event.key2);\n        console.log('value2 =', event.key3);\n        console.log('value3 =', event.key1);\n        context.succeed(event.key2);  // Echo back the first key value\n        // context.fail('Something went wrong');\n};\nEOF\n\ncat ${FILE_LAMBDA_FUNC}\n```\n\n```bash:\u30b3\u30de\u30f3\u30c9:\nzip ${LAMBDA_FUNC_NAME}-new.zip ${FILE_LAMBDA_FUNC}\n```\n\n```text:\u7d50\u679c:\n      adding: HelloWorld.js (deflated 43%)\n```\n\n\n2. Lambda\u95a2\u6570\u306e\u66f4\u65b0\n===================\n\n\n2.1. Lambda\u95a2\u6570\u306e\u66f4\u65b0\n---------------------\n\n```bash:\u5909\u6570\u306e\u8a2d\u5b9a:\nFILE_LAMBDA_ZIP=\"${LAMBDA_FUNC_NAME}-new.zip\"\n```\n\n```bash:\u5909\u6570\u306e\u78ba\u8a8d:\ncat << ETX\n\n        LAMBDA_FUNC_NAME:  ${LAMBDA_FUNC_NAME}\n        FILE_LAMBDA_ZIP:   ${FILE_LAMBDA_ZIP}\n\nETX\n```\n\n```bash:\u30b3\u30de\u30f3\u30c9:\naws lambda update-function-code \\\n        --function-name ${LAMBDA_FUNC_NAME} \\\n        --zip-file fileb://${FILE_LAMBDA_ZIP} \\\n        --publish\n```\n\n```json:\u7d50\u679c(\u4f8b):\n\n      {\n        \"CodeSha256\": \"xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx=\",\n        \"FunctionName\": \"HelloWorld\",\n        \"CodeSize\": 349,\n        \"MemorySize\": 128,\n        \"FunctionArn\": \"arn:aws:lambda:ap-northeast-1:XXXXXXXXXXXX:function:HelloWorld:2\",\n        \"Version\": \"2\",\n        \"Role\": \"arn:aws:iam::XXXXXXXXXXXX:role/lambdaBasicExecution\",\n        \"Timeout\": 2,\n        \"LastModified\": \"2015-10-26T01:23:45.678+0000\",\n        \"Handler\": \"HelloWorld.handler\",\n        \"Runtime\": \"nodejs\",\n        \"Description\": \"Hello World with AWS Lambda function.\"\n      }\n```\n\n\n2.2. Lambda\u95a2\u6570\u306e\u78ba\u8a8d\n---------------------\n\n```bash:\u30b3\u30de\u30f3\u30c9:\naws lambda get-function \\\n        --function-name ${LAMBDA_FUNC_NAME}\n```\n\n```json:\u7d50\u679c(\u4f8b):\n\n      {\n        \"Code\": {\n          \"RepositoryType\": \"S3\",\n          \"Location\": \"https://awslambda-ap-ne-1-tasks.s3-ap-northeast-1.amazonaws.com/snapshots/XXXXXXXXXXXX/HelloWorld-38950242-86bb-4cbb-bab7-27dfdec7f362?x-amz-security-token=AQoDYXdzEDwa8AMILEth%2BKa19K9tePesujMLPz9zX2%2Fglxg9xU%2BPwvLP8ZMoogywweINkAhFta2lr88GEKJwk8x077DnoOmYeXmD2XE2bXbYPgNAFJU2JYgpnxckoXt2qrNAQKUpCtWqeCwHm34d%2FRhoVDXIbhHpn4iMkg%2BCFfU5%2BtjYsZQzp6CfcDUd3fZXYgSBjCJdpTIc222P6zcusHt%2FPc9ob016zlAkIuEi5ZZhXwZFouF7wwURvSo0QbZ1e1M2DwqNfL1bpC3oEPGrKM43XtwEvVSpMu%2FwdDQHBi1f8B7xJbmjNXA7zg%2BLybhUHioDdLPlS2NDgSXUO4QP3BMmTDeLN5Z6rx0ddjl1JJpLczIl6Plzln0NMQ14dkkIKriteFL09Ei0DJQ7Y%2BiXPNMStM66vsN%2F9yAHGNxCrFKEH0t9lgV2Od6%2Fny3MmNQiNSaaqCHsnKpLbabLSy82dsQwhW35XPCJPShwbgXPB9RPXjx%2FqBCnyGztXE7s6vsBy3AmJbctcDcgte2cpvcoEkg4H%2BrDTaBRvDYlqxEj71C3WLLI62z6OLS5fxkYmYfDZzhDQ5oLg5eyvXxlwugkvh%2Fo7pKuo%2B48liADEZDyLKHqFPH0j924OYRJrtr2b1iw4nrwyMAE7VnQBLAFfPWnWeiD3lfDKARvUpFeINW2trEF&AWSAccessKeyId=ASIAJDZ6MUQCOK4OEDVQ&Expires=1445835375&Signature=uzNTBfSjf1kwixwHBT5LsRtQowo%3D\"\n        },\n        \"Configuration\": {\n          \"Version\": \"$LATEST\",\n          \"CodeSha256\": \"+EAYs8jMYFRBdnsMdFUt2bv//KHE2tkovql6ls+gXoM=\",\n          \"FunctionName\": \"HelloWorld\",\n          \"MemorySize\": 128,\n          \"CodeSize\": 349,\n          \"FunctionArn\": \"arn:aws:lambda:ap-northeast-1:XXXXXXXXXXXX:function:HelloWorld\",\n          \"Handler\": \"HelloWorld.handler\",\n          \"Role\": \"arn:aws:iam::XXXXXXXXXXXX:role/lambdaBasicExecution\",\n          \"Timeout\": 3,\n          \"LastModified\": \"2015-10-26T04:41:36.261+0000\",\n          \"Runtime\": \"nodejs\",\n          \"Description\": \"\\ |LAMBDA_FUNC_DESC|\\ \"\n        }\n      }\n```\n\n\n2.3. \u30d0\u30fc\u30b8\u30e7\u30f3\u756a\u53f7\u306e\u53d6\u5f97\n-------------------------\n\n```bash:\u5909\u6570\u306e\u8a2d\u5b9a:\nLAMBDA_FUNC_VER=$( \\\n        hash=$( \\\n          aws lambda list-versions-by-function \\\n            --function-name ${LAMBDA_FUNC_NAME} \\\n            --query 'Versions[?Version == `$LATEST`].CodeSha256' \\\n            --output text \\\n        ) \\\n        && aws lambda list-versions-by-function \\\n          --function-name ${LAMBDA_FUNC_NAME} \\\n          --query \"Versions[?CodeSha256 == \\`${hash}\\` && Version != \\`\\$LATEST\\`].Version[]\" \\\n          --output text \\\n      ) \\\n        && echo ${LAMBDA_FUNC_VER}\n```\n\n```text:\u7d50\u679c(\u4f8b)\n2\n```\n\n3. Lambda\u95a2\u6570\u306e\u52d5\u4f5c\u78ba\u8a8d\n=======================\n\n\n3.1. \u30b5\u30f3\u30d7\u30eb\u30c7\u30fc\u30bf\u306e\u4f5c\u6210\n-------------------------\n\n```bash:\u5909\u6570\u306e\u8a2d\u5b9a:\nFILE_DATA_LAMBDA=\"${LAMBDA_FUNC_NAME}-data.json\" \\\n        && echo ${FILE_DATA_LAMBDA}\n```\n\n```bash:\u30b5\u30f3\u30d7\u30eb\u30c7\u30fc\u30bf:\ncat << EOF > ${FILE_DATA_LAMBDA}\n{\n          \"key1\": \"val1\",\n          \"key2\": \"val2\",\n          \"key3\": \"val3\"\n}\nEOF\n\ncat ${FILE_DATA_LAMBDA}\n```\n\n```bash:\u30b3\u30de\u30f3\u30c9:\njsonlint -q ${FILE_DATA_LAMBDA}\n```\n\n```bash:\u5909\u6570\u306e\u8a2d\u5b9a:\nFILE_OUTPUT_LAMBDA=\"${LAMBDA_FUNC_NAME}-out.txt\" \\\n        && echo ${FILE_OUTPUT_LAMBDA}\n```\n\n```bash:\u5909\u6570\u306e\u78ba\u8a8d:\ncat << ETX\n\n        LAMBDA_FUNC_NAME:   ${LAMBDA_FUNC_NAME}\n        FILE_DATA_LAMBDA:   ${FILE_DATA_LAMBDA}\n        FILE_OUTPUT_LAMBDA: ${FILE_OUTPUT_LAMBDA}\n\nETX\n```\n\n```bash:\u30b3\u30de\u30f3\u30c9:\nFILE_LOG_LAMBDA=\"${LAMBDA_FUNC_NAME}-$(date +%Y%m%d%H%M%S).log\" \\\n        && echo ${FILE_LOG_LAMBDA}\n```\n\n```bash:\u30b3\u30de\u30f3\u30c9:\naws lambda invoke \\\n        --function-name ${LAMBDA_FUNC_NAME} \\\n        --log-type Tail \\\n        --payload file://${FILE_DATA_LAMBDA} \\\n        ${FILE_OUTPUT_LAMBDA} \\\n        > ${FILE_LOG_LAMBDA}\n```\n\n```bash:\u30b3\u30de\u30f3\u30c9:\ncat ${FILE_LOG_LAMBDA} \\\n  | jp.py 'StatusCode'\n```\n\n```text:\u7d50\u679c(\u4f8b):\n      200\n```\n\n```bash:\u30b3\u30de\u30f3\u30c9:\ncat ${FILE_OUTPUT_LAMBDA}\n```\n\n```text:\u7d50\u679c:\n      val2\n```\n\n```bash:\u30b3\u30de\u30f3\u30c9:\ncat ${FILE_LOG_LAMBDA} \\\n        | jp.py 'LogResult' \\\n        | sed 's/\"//' \\\n        | base64 --decode\n```\n\n```text:\u7d50\u679c:\n      START RequestId: 1dc6ae3a-7b9d-11e5-a29a-b93d2ad7eab9 Version: $LATEST\n      2015-10-26T04:50:45.532Z    1dc6ae3a-7b9d-11e5-a29a-b93d2ad7eab9    value1 = val2\n      2015-10-26T04:50:45.532Z    1dc6ae3a-7b9d-11e5-a29a-b93d2ad7eab9    value2 = val3\n      2015-10-26T04:50:45.532Z    1dc6ae3a-7b9d-11e5-a29a-b93d2ad7eab9    value3 = val1\n      END RequestId: 1dc6ae3a-7b9d-11e5-a29a-b93d2ad7eab9\n      REPORT RequestId: 1dc6ae3a-7b9d-11e5-a29a-b93d2ad7eab9      Duration: 6.34 ms       Billed Duration: 100 ms         Memory Size: 128 MB     Max Memory Used: 27 MB\n```\n\n\n4. \u30a8\u30a4\u30ea\u30a2\u30b9\u306e\u66f4\u65b0\n===================\n\n\n4.1. \u30a8\u30a4\u30ea\u30a2\u30b9\u306e\u78ba\u8a8d\n---------------------\n\n```bash:\u5909\u6570\u306e\u8a2d\u5b9a:\nLAMBDA_ALIAS_NAME='product'\n```\n\n```bash:\u30b3\u30de\u30f3\u30c9:\naws lambda get-alias \\\n        --function-name ${LAMBDA_FUNC_NAME} \\\n        --name ${LAMBDA_ALIAS_NAME}\n```\n\n```json:\u7d50\u679c(\u4f8b):\n      {\n        \"AliasArn\": \"arn:aws:lambda:ap-northeast-1:XXXXXXXXXXXX:function:HelloWorld:product\",\n        \"FunctionVersion\": \"1\",\n        \"Name\": \"product\",\n        \"Description\": \"Released version on product env.\"\n      }\n```\n\n\n4.2. \u30a8\u30a4\u30ea\u30a2\u30b9\u306e\u66f4\u65b0\n---------------------\n\n```bash:\u30b3\u30de\u30f3\u30c9:\naws lambda update-alias \\\n        --function-name ${LAMBDA_FUNC_NAME} \\\n        --function-version ${LAMBDA_FUNC_VER} \\\n        --name ${LAMBDA_ALIAS_NAME}\n```\n\n```json:\u7d50\u679c(\u4f8b):\n      {\n        \"AliasArn\": \"arn:aws:lambda:ap-northeast-1:XXXXXXXXXXXX:function:HelloWorld:product\",\n        \"FunctionVersion\": \"2\",\n        \"Name\": \"product\",\n        \"Description\": \"Released version on product env.\"\n      }\n```\n\n\n4.3. \u30a8\u30a4\u30ea\u30a2\u30b9\u306e\u78ba\u8a8d\n---------------------\n\n```bash:\u30b3\u30de\u30f3\u30c9:\naws lambda get-alias \\\n        --function-name ${LAMBDA_FUNC_NAME} \\\n        --name ${LAMBDA_ALIAS_NAME}\n```\n\n```json:\u7d50\u679c(\u4f8b):\n      {\n        \"AliasArn\": \"arn:aws:lambda:ap-northeast-1:XXXXXXXXXXXX:function:HelloWorld:product\",\n        \"FunctionVersion\": \"2\",\n        \"Name\": \"product\",\n        \"Description\": \"Released version on product env.\"\n      }\n```\n\n\n\u5b8c\u4e86\n====\n", "tags": ["aws-cli", "lambda", "AWS"]}