{"context": "\u5c0f\u30cd\u30bf\u3067\u3059\u3002\n\u30d0\u30fc\u30b8\u30e7\u30f3\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u611f\u3058\u3002\n\npom.xml\n<dependencies>\n    <dependency>\n        <groupId>org.mongodb</groupId>\n        <artifactId>mongo-java-driver</artifactId>\n        <version>3.2.1</version>\n    </dependency>\n</dependencies> \n\n\n\n\u304a\u3053\u3068\u308f\u308a\n\u4ee5\u4e0b\u5168\u3066\u306e\u4f8b\u306b\u3064\u3044\u3066\u3001MongoDB\u63a5\u7d9a\u5148\u306f\u3053\u306e\u3088\u3046\u306b\u5b9a\u7fa9\u6e08\u307f\u3067\u3042\u308b\u3082\u306e\u3068\u3057\u307e\u3059\u3002\n//\u521d\u53f7\u6a5f(primary)\nString ip_pri = \"hogehoge\";\n\n//\u5f10\u53f7\u6a5f(secondary)\nString ip_sec = \"fugafuga\";\n\n//\u5171\u901a\nint port = 27017;\nServerAddress pri = new ServerAddress(ip_pri, port);\nServerAddress sec = new ServerAddress(ip_sec, port);\nList<ServerAddress> addressList = new ArrayList<>(Arrays.asList(pri, sec));\n\n\n\u6982\u8981\nMongoDB\u306e\u30ec\u30d7\u30ea\u30ab\u30bb\u30c3\u30c8\u3092\u69cb\u7bc9\u3057\u3066\u3044\u308b\u5834\u5408\u3001\u30c7\u30fc\u30bf\u306e\u8aad\u307f\u51fa\u3057\u5143\u306b\u3064\u3044\u3066\u898f\u5b9a\u3059\u308b\u306e\u304cread preference\u3067\u3059\u3002\n(\u8a73\u3057\u304f\u306f\u2192 http://qiita.com/y13i/items/78c9f45acd07a9478d2d#read-preference )\n\u3053\u308c\u3092Java\u306eMongoDBDriver\u3092\u4f7f\u7528\u3057\u3066\u5b9f\u88c5\u3059\u308b\u969b\u3069\u3046\u3059\u308b\u304b\u3068\u3044\u3046\u3068\u3001\u63a5\u7d9a\u5148\u306eMongoDB\u306e\u30b3\u30ec\u30af\u30b7\u30e7\u30f3\u3092\u6307\u5b9a\u3059\u308b\u3068\u304d\u306b\u4e00\u7dd2\u306b\u304f\u3063\u3064\u3051\u307e\u3059\u3002\n\u9806\u756a\u7684\u306b\u306f\n\nMongoCliant\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u4f5c\u6210\n\u63a5\u7d9a\u5148\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u6307\u5b9a\n\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306e\u4e2d\u306e\u63a5\u7d9a\u5148\u30b3\u30ec\u30af\u30b7\u30e7\u30f3(\u30c6\u30fc\u30d6\u30eb)\u6307\u5b9a\u2190\u3053\u3053\n\n\u306b\u306a\u308a\u307e\u3059\u3002\nMongoCollection\u30af\u30e9\u30b9\u306bwithReadPreference()API\u304c\u3042\u308b\u306e\u3067\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u8a18\u8ff0\u3059\u308c\u3070OK\u3002\n\nString dbname = \"dbname\";\nString collname = \"collname\";\n\nMongoClient cliant = new MongoClient(addressList);\nMongoDatabase database = cliant.getDatabase(dbname);\n\nMongoCollection<Document> coll = db.getCollection(collname).withReadPreference(ReadPreference.secondary());\n\n\n\u3061\u306a\u307f\u306b\nMongoDatabase\u30af\u30e9\u30b9\u306b\u3082\u5168\u304f\u540c\u3058API\u304c\u3042\u308b\u306e\u3067\u3001\u305d\u3061\u3089\u3092\u4f7f\u3063\u3066\u3082\u3088\u3044\u3067\u3059\u3002\u3069\u3061\u3089\u3082\u540c\u3058\u3088\u3046\u306b\u52d5\u4f5c\u3057\u307e\u3059\u3002\u9055\u3044\u306f\u3088\u304f\u8abf\u3079\u3066\u307e\u305b\u3093\u3002\u3059\u307f\u307e\u305b\u3093\u30fb\u30fb\u30fb\nMongoClient cliant = new MongoClient(addressList);\nMongoDatabase database = cliant.getDatabase(dbname).withReadPreference(ReadPreference.secondary());\n\nMongoCollection<Document> coll = db.getCollection(collname);\n\n\n(12/1\u8ffd\u8a18)\u7b2c3\u306e\u9078\u629e\u80a2\u306b\u3064\u3044\u3066\n\u306a\u3093\u304b\u30d3\u30fc\u30eb\u307f\u305f\u3044\u3060\u306a\n\u4e0a\u8a18\u306e\u4ed6\u306b\u3001\u3082\u3046\u4e00\u3064read preference\u8a2d\u5b9a\u304c\u3067\u304d\u308b\u65b9\u6cd5\u304c\u3042\u308a\u307e\u3057\u305f\u3002\nMongoCliant\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u3092\u4f5c\u6210\u3059\u308b\u6642\u306b\u3001MongoCliantOptions\u306eAPI\u304b\u3089read preference\u3092\u547c\u3073\u51fa\u3059\u3053\u3068\u3082\u3067\u304d\u307e\u3059\u3002\nMongoCliantOptions option = MongoClientOptions.builder().readPreference(ReadPreference.secondary()).build();\nMongoClient cliant = new MongoClient(addressList, option);\n\nMongoDatabase database = cliant.getDatabase(dbname);\nMongoCollection<Document> coll = db.getCollection(collname);\n\n\u3057\u304b\u3057\u9577\u3044\u30fb\u30fb\u30fb\nMongoClient cliant = new MongoClient(addressList);\ncliant.setReadPreference(ReadPreference.secondary());\n\n\u516c\u5f0f\u306b\u306f\u4e0a\u8a18\u306e\u66f8\u304d\u65b9\u304c\u8f09\u3063\u3066\u3044\u307e\u3059\u304c\u3001\u3053\u308c\u3060\u3068var3.3\u4ee5\u964d\u3067\u306f\u975e\u63a8\u5968\u306b\u306a\u3063\u3066\u3044\u308b\u3060\u3051\u3067\u306a\u304f\u3001\u4ee5\u524d\u3067\u3042\u3063\u3066\u3082(\u5c11\u306a\u304f\u3068\u3082\u81ea\u5206\u306e\u74b0\u5883\u3067\u306f)ReadPreference\u304c\u6a5f\u80fd\u3057\u306a\u304b\u3063\u305f\u306e\u3067\u3001\u304a\u6c17\u3092\u3064\u3051\u304f\u3060\u3055\u3044\u30fb\u30fb\u30fb\n\n\u516c\u5f0f\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\nhttp://mongodb.github.io/mongo-java-driver/3.0/driver/reference/crud/#immutability-of-mongodatabase-and-mongocollection\nhttp://api.mongodb.com/java/current/com/mongodb/MongoClient.html\n\u5c0f\u30cd\u30bf\u3067\u3059\u3002\n\n\u30d0\u30fc\u30b8\u30e7\u30f3\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u611f\u3058\u3002\n\n``` pom.xml\n<dependencies>\n    <dependency>\n        <groupId>org.mongodb</groupId>\n        <artifactId>mongo-java-driver</artifactId>\n        <version>3.2.1</version>\n    </dependency>\n</dependencies> \n```\n\n# \u304a\u3053\u3068\u308f\u308a\n\u4ee5\u4e0b\u5168\u3066\u306e\u4f8b\u306b\u3064\u3044\u3066\u3001MongoDB\u63a5\u7d9a\u5148\u306f\u3053\u306e\u3088\u3046\u306b\u5b9a\u7fa9\u6e08\u307f\u3067\u3042\u308b\u3082\u306e\u3068\u3057\u307e\u3059\u3002\n\n```java\n//\u521d\u53f7\u6a5f(primary)\nString ip_pri = \"hogehoge\";\n\n//\u5f10\u53f7\u6a5f(secondary)\nString ip_sec = \"fugafuga\";\n\n//\u5171\u901a\nint port = 27017;\nServerAddress pri = new ServerAddress(ip_pri, port);\nServerAddress sec = new ServerAddress(ip_sec, port);\nList<ServerAddress> addressList = new ArrayList<>(Arrays.asList(pri, sec));\n```\n\n# \u6982\u8981\nMongoDB\u306e\u30ec\u30d7\u30ea\u30ab\u30bb\u30c3\u30c8\u3092\u69cb\u7bc9\u3057\u3066\u3044\u308b\u5834\u5408\u3001\u30c7\u30fc\u30bf\u306e\u8aad\u307f\u51fa\u3057\u5143\u306b\u3064\u3044\u3066\u898f\u5b9a\u3059\u308b\u306e\u304cread preference\u3067\u3059\u3002\n(\u8a73\u3057\u304f\u306f\u2192 http://qiita.com/y13i/items/78c9f45acd07a9478d2d#read-preference )\n\u3053\u308c\u3092Java\u306eMongoDBDriver\u3092\u4f7f\u7528\u3057\u3066\u5b9f\u88c5\u3059\u308b\u969b\u3069\u3046\u3059\u308b\u304b\u3068\u3044\u3046\u3068\u3001\u63a5\u7d9a\u5148\u306eMongoDB\u306e\u30b3\u30ec\u30af\u30b7\u30e7\u30f3\u3092\u6307\u5b9a\u3059\u308b\u3068\u304d\u306b\u4e00\u7dd2\u306b\u304f\u3063\u3064\u3051\u307e\u3059\u3002\n\n\u9806\u756a\u7684\u306b\u306f\n\n- MongoCliant\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u4f5c\u6210\n- \u63a5\u7d9a\u5148\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u6307\u5b9a\n- \u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306e\u4e2d\u306e\u63a5\u7d9a\u5148\u30b3\u30ec\u30af\u30b7\u30e7\u30f3(\u30c6\u30fc\u30d6\u30eb)\u6307\u5b9a\u2190\u3053\u3053\n\n\u306b\u306a\u308a\u307e\u3059\u3002\nMongoCollection\u30af\u30e9\u30b9\u306b``withReadPreference()``API\u304c\u3042\u308b\u306e\u3067\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u8a18\u8ff0\u3059\u308c\u3070OK\u3002\n\n\n```java\n\nString dbname = \"dbname\";\nString collname = \"collname\";\n\nMongoClient cliant = new MongoClient(addressList);\nMongoDatabase database = cliant.getDatabase(dbname);\n\nMongoCollection<Document> coll = db.getCollection(collname).withReadPreference(ReadPreference.secondary());\n```\n\n# \u3061\u306a\u307f\u306b\nMongoDatabase\u30af\u30e9\u30b9\u306b\u3082\u5168\u304f\u540c\u3058API\u304c\u3042\u308b\u306e\u3067\u3001\u305d\u3061\u3089\u3092\u4f7f\u3063\u3066\u3082\u3088\u3044\u3067\u3059\u3002\u3069\u3061\u3089\u3082\u540c\u3058\u3088\u3046\u306b\u52d5\u4f5c\u3057\u307e\u3059\u3002\u9055\u3044\u306f\u3088\u304f\u8abf\u3079\u3066\u307e\u305b\u3093\u3002\u3059\u307f\u307e\u305b\u3093\u30fb\u30fb\u30fb\n\n```java\nMongoClient cliant = new MongoClient(addressList);\nMongoDatabase database = cliant.getDatabase(dbname).withReadPreference(ReadPreference.secondary());\n\nMongoCollection<Document> coll = db.getCollection(collname);\n```\n\n# (12/1\u8ffd\u8a18)\u7b2c3\u306e\u9078\u629e\u80a2\u306b\u3064\u3044\u3066\n\n~~\u306a\u3093\u304b\u30d3\u30fc\u30eb\u307f\u305f\u3044\u3060\u306a~~\n\n\u4e0a\u8a18\u306e\u4ed6\u306b\u3001\u3082\u3046\u4e00\u3064read preference\u8a2d\u5b9a\u304c\u3067\u304d\u308b\u65b9\u6cd5\u304c\u3042\u308a\u307e\u3057\u305f\u3002\nMongoCliant\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u3092\u4f5c\u6210\u3059\u308b\u6642\u306b\u3001MongoCliantOptions\u306eAPI\u304b\u3089read preference\u3092\u547c\u3073\u51fa\u3059\u3053\u3068\u3082\u3067\u304d\u307e\u3059\u3002\n\n```java\nMongoCliantOptions option = MongoClientOptions.builder().readPreference(ReadPreference.secondary()).build();\nMongoClient cliant = new MongoClient(addressList, option);\n\nMongoDatabase database = cliant.getDatabase(dbname);\nMongoCollection<Document> coll = db.getCollection(collname);\n```\n\n\u3057\u304b\u3057\u9577\u3044\u30fb\u30fb\u30fb\n\n\n```java\nMongoClient cliant = new MongoClient(addressList);\ncliant.setReadPreference(ReadPreference.secondary());\n```\n\n\u516c\u5f0f\u306b\u306f\u4e0a\u8a18\u306e\u66f8\u304d\u65b9\u304c\u8f09\u3063\u3066\u3044\u307e\u3059\u304c\u3001\u3053\u308c\u3060\u3068**var3.3\u4ee5\u964d\u3067\u306f\u975e\u63a8\u5968\u306b\u306a\u3063\u3066\u3044\u308b**\u3060\u3051\u3067\u306a\u304f\u3001\u4ee5\u524d\u3067\u3042\u3063\u3066\u3082**(\u5c11\u306a\u304f\u3068\u3082\u81ea\u5206\u306e\u74b0\u5883\u3067\u306f)ReadPreference\u304c\u6a5f\u80fd\u3057\u306a\u304b\u3063\u305f**\u306e\u3067\u3001\u304a\u6c17\u3092\u3064\u3051\u304f\u3060\u3055\u3044\u30fb\u30fb\u30fb\n\n# \u516c\u5f0f\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\nhttp://mongodb.github.io/mongo-java-driver/3.0/driver/reference/crud/#immutability-of-mongodatabase-and-mongocollection\n\nhttp://api.mongodb.com/java/current/com/mongodb/MongoClient.html\n", "tags": ["Java", "Maven", "MongoDB"]}