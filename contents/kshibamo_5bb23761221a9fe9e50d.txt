{"context": " More than 1 year has passed since last update.\u300cYahoo! \u77e5\u6075\u888b\u300d\u306e\u4ee5\u4e0b\u306e\u8cea\u554f\u3092\u89e3\u3044\u3066\u307f\u307e\u3057\u305f\u3002\nhttp://detail.chiebukuro.yahoo.co.jp/qa/question_detail/q11126934051\n\nq11126934051.bat\n@echo off\n\nset SELF=%~n0\n\nsetlocal\n  set SOURCE=E:\n  set TARGET=.\\BACKUP\n\n  echo WScript.Echo MsgBox^(\"Do you want to make backup copy of this file?\" ^& vbCrLf ^& vbCrLf ^& WScript.Arguments^(0^), vbYesNo^) > .\\%SELF%.vbs\n\n  for %%i in (A B C) do (\n    call :choice \"%SOURCE%\\%%i\" && (\n      call :backup \"%SOURCE%\\%%i\" \"%TARGET%\\%%i\" && (\n        echo [  OK  ] %SOURCE%\\%%i to %TARGET%\\%%i\\\n      ) || (\n        echo [  NG  ] %SOURCE%\\%%i to %TARGET%\\%%i\\\n      )\n    ) || (\n        echo [ SKIP ] %SOURCE%\\%%i to %TARGET%\\%%i\\\n    )\n  )\n\n  del .\\%SELF%.vbs > NUL\nendlocal\ngoto :EOF\n\n:choice\nsetlocal\n  for /f \"tokens=*\" %%i in ('cscript //nologo %SELF%.vbs \"%~1\"') do (set i=%%i)\n\n  :: vbYes: 6, vbNo: 7\n  if %i% equ 7 (exit /b 1)\n\n  exit /b 0\nendlocal\ngoto :EOF\n\n:backup\nsetlocal enabledelayedexpansion\n  set SOURCE=%~1\n  set TARGET=%~2\n\n  if \"%SOURCE%\" == \"\" (\n    echo %SELF%: insufficient argument: #1 >&2\n    exit /b 1\n  )\n  if \"%TARGET%\" == \"\" (\n    echo %SELF%: insufficient argument: #2 >&2\n    exit /b 1\n  )\n\n  if not exist \"%SOURCE%\" (\n    echo %SELF%: file not found: %SOURCE% >&2\n    exit /b 1\n  )\n\n  if not exist \"%TARGET%\\\" (\n    md \"%TARGET%\"\n    if !ERRORLEVEL! neq 0 (\n      echo %SELF%: failed to create directory: %TARGET% >&2\n      exit /b 1\n    )\n  )\n\n  copy \"%SOURCE%\" \"%TARGET%\" > NUL\n  if %ERRORLEVEL% neq 0 (\n    echo %SELF%: failed to copy file: %SOURCE% >&2\n    exit /b 1\n  )\n\n  exit /b 0\nendlocal\ngoto :EOF\n\n\n\u5b9f\u884c\u3059\u308b\u3068\nE:\\>tree /f E:\\\n\u30d5\u30a9\u30eb\u30c0 \u30d1\u30b9\u306e\u4e00\u89a7:  \u30dc\u30ea\u30e5\u30fc\u30e0 XXXXXXXX\n\u30dc\u30ea\u30e5\u30fc\u30e0 \u30b7\u30ea\u30a2\u30eb\u756a\u53f7\u306f XXXX-XXXX \u3067\u3059\nE:\\\n    A\n    B\n\n\nC:\\temp>q11126934051.bat\n[  OK  ] E:\\A to .\\BACKUP\\A\\\n[ SKIP ] E:\\B to .\\BACKUP\\B\\\nq11126934051: file not found: E:\\C\n[  NG  ] E:\\C to .\\BACKUP\\C\\\n\n\nC:\\temp>tree /f .\\BACKUP\n\u30d5\u30a9\u30eb\u30c0 \u30d1\u30b9\u306e\u4e00\u89a7:  \u30dc\u30ea\u30e5\u30fc\u30e0 \u30ed\u30fc\u30ab\u30eb \u30c7\u30a3\u30b9\u30af\n\u30dc\u30ea\u30e5\u30fc\u30e0 \u30b7\u30ea\u30a2\u30eb\u756a\u53f7\u306f XXXX-XXXX \u3067\u3059\nC:\\temp\\BACKUP\n\u2514\u2500A\n        A\n\n\u306a\u304a\u3001\u30d5\u30a1\u30a4\u30eb\u3092\u30b3\u30d4\u30fc\u3059\u308b\u524d\u306b\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u30c0\u30a4\u30a2\u30ed\u30b0\u304c\u8868\u793a\u3055\u308c\u307e\u3059\u3002\n\n\u300cYahoo! \u77e5\u6075\u888b\u300d\u306e\u4ee5\u4e0b\u306e\u8cea\u554f\u3092\u89e3\u3044\u3066\u307f\u307e\u3057\u305f\u3002\n\nhttp://detail.chiebukuro.yahoo.co.jp/qa/question_detail/q11126934051\n\n```bat:q11126934051.bat\n@echo off\n\nset SELF=%~n0\n\nsetlocal\n  set SOURCE=E:\n  set TARGET=.\\BACKUP\n  \n  echo WScript.Echo MsgBox^(\"Do you want to make backup copy of this file?\" ^& vbCrLf ^& vbCrLf ^& WScript.Arguments^(0^), vbYesNo^) > .\\%SELF%.vbs\n  \n  for %%i in (A B C) do (\n    call :choice \"%SOURCE%\\%%i\" && (\n      call :backup \"%SOURCE%\\%%i\" \"%TARGET%\\%%i\" && (\n        echo [  OK  ] %SOURCE%\\%%i to %TARGET%\\%%i\\\n      ) || (\n        echo [  NG  ] %SOURCE%\\%%i to %TARGET%\\%%i\\\n      )\n    ) || (\n        echo [ SKIP ] %SOURCE%\\%%i to %TARGET%\\%%i\\\n    )\n  )\n  \n  del .\\%SELF%.vbs > NUL\nendlocal\ngoto :EOF\n\n:choice\nsetlocal\n  for /f \"tokens=*\" %%i in ('cscript //nologo %SELF%.vbs \"%~1\"') do (set i=%%i)\n  \n  :: vbYes: 6, vbNo: 7\n  if %i% equ 7 (exit /b 1)\n  \n  exit /b 0\nendlocal\ngoto :EOF\n\n:backup\nsetlocal enabledelayedexpansion\n  set SOURCE=%~1\n  set TARGET=%~2\n  \n  if \"%SOURCE%\" == \"\" (\n    echo %SELF%: insufficient argument: #1 >&2\n    exit /b 1\n  )\n  if \"%TARGET%\" == \"\" (\n    echo %SELF%: insufficient argument: #2 >&2\n    exit /b 1\n  )\n  \n  if not exist \"%SOURCE%\" (\n    echo %SELF%: file not found: %SOURCE% >&2\n    exit /b 1\n  )\n  \n  if not exist \"%TARGET%\\\" (\n    md \"%TARGET%\"\n    if !ERRORLEVEL! neq 0 (\n      echo %SELF%: failed to create directory: %TARGET% >&2\n      exit /b 1\n    )\n  )\n  \n  copy \"%SOURCE%\" \"%TARGET%\" > NUL\n  if %ERRORLEVEL% neq 0 (\n    echo %SELF%: failed to copy file: %SOURCE% >&2\n    exit /b 1\n  )\n  \n  exit /b 0\nendlocal\ngoto :EOF\n```\n\n\u5b9f\u884c\u3059\u308b\u3068\n\n```\nE:\\>tree /f E:\\\n\u30d5\u30a9\u30eb\u30c0 \u30d1\u30b9\u306e\u4e00\u89a7:  \u30dc\u30ea\u30e5\u30fc\u30e0 XXXXXXXX\n\u30dc\u30ea\u30e5\u30fc\u30e0 \u30b7\u30ea\u30a2\u30eb\u756a\u53f7\u306f XXXX-XXXX \u3067\u3059\nE:\\\n    A\n    B\n\n\nC:\\temp>q11126934051.bat\n[  OK  ] E:\\A to .\\BACKUP\\A\\\n[ SKIP ] E:\\B to .\\BACKUP\\B\\\nq11126934051: file not found: E:\\C\n[  NG  ] E:\\C to .\\BACKUP\\C\\\n\n\nC:\\temp>tree /f .\\BACKUP\n\u30d5\u30a9\u30eb\u30c0 \u30d1\u30b9\u306e\u4e00\u89a7:  \u30dc\u30ea\u30e5\u30fc\u30e0 \u30ed\u30fc\u30ab\u30eb \u30c7\u30a3\u30b9\u30af\n\u30dc\u30ea\u30e5\u30fc\u30e0 \u30b7\u30ea\u30a2\u30eb\u756a\u53f7\u306f XXXX-XXXX \u3067\u3059\nC:\\temp\\BACKUP\n\u2514\u2500A\n        A\n```\n\n\u306a\u304a\u3001\u30d5\u30a1\u30a4\u30eb\u3092\u30b3\u30d4\u30fc\u3059\u308b\u524d\u306b\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u30c0\u30a4\u30a2\u30ed\u30b0\u304c\u8868\u793a\u3055\u308c\u307e\u3059\u3002\n\n![q11126934051.png](https://qiita-image-store.s3.amazonaws.com/0/29814/0b796424-4861-5975-6406-3f78d422a1a3.png)\n", "tags": ["\u30b3\u30de\u30f3\u30c9\u30d7\u30ed\u30f3\u30d7\u30c8", "\u30d0\u30c3\u30c1\u30d5\u30a1\u30a4\u30eb"]}