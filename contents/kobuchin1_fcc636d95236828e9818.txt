{"context": " More than 1 year has passed since last update.\nSQS = require('aws-sdk').SQS\n\n# \u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u3092\u751f\u6210\nclient = new SQS\n  accessKeyId: '\u30a2\u30af\u30bb\u30b9\u30ad\u30fcID\u3092\u8a18\u8ff0...'  # ElasticMQ\u306e\u5834\u5408\u306f\u4e0d\u4f7f\u7528\n  secretAccessKey: '\u30b7\u30fc\u30af\u30ec\u30c3\u30c8\u30a2\u30af\u30bb\u30b9\u30ad\u30fc\u3092\u8a18\u8ff0...'  # ElasticMQ\u306e\u5834\u5408\u306f\u4e0d\u4f7f\u7528\n  apiVersion: '2012-11-05'\n  region: '\u30ea\u30fc\u30b8\u30e7\u30f3\u3092\u8a18\u8ff0...'  # ElasticMQ\u306e\u5834\u5408\u306f\u4e0d\u4f7f\u7528\n\n# \u30ad\u30e5\u30fc\u540d\nqueueName = '\u30ad\u30e5\u30fc\u540d\u3092\u8a18\u8ff0...'\n\n# \u30ed\u30fc\u30ab\u30eb\u958b\u767a\u74b0\u5883\u7528(ElasticMQ)\nqueueUrl = \"http://localhost:9324/queue/#{queueName}\"\n# \u672c\u756a\u74b0\u5883\u7528(AWS SQS)\n# queueUrl = \"https://sqs.\u30ea\u30fc\u30b8\u30e7\u30f3.amazonaws.com/xxxxxxxxxx/#{queueName}\"\n\n# ElasticMQ\u7528\u306b\u30b3\u30ec\u3092\u8a2d\u5b9a\u3059\u308b\u5fc5\u8981\u304c\u3042\u308b\nclient.setEndpoint 'http://localhost:9324'\n\n# \u30ad\u30e5\u30fc\u3092\u4f5c\u6210\nclient.createQueue {QueueName: queueName}, (err) ->\n\n  if err\n    console.log \"### \u30a8\u30e9\u30fc\", err\n    return\n\n  # \u9001\u4fe1\u7528\u30d1\u30e9\u30e1\u30fc\u30bf\n  sendParams =\n    QueueUrl: queueUrl\n    MessageBody: 'This is a test'\n    DelaySeconds: 0\n\n  # \u30e1\u30c3\u30bb\u30fc\u30b8\u9001\u4fe1\n  client.sendMessage sendParams, (err) ->\n    if err\n      console.log \"### \u30a8\u30e9\u30fc\", err\n      return\n\n    # \u53d7\u4fe1\u7528\u30aa\u30d7\u30b7\u30e7\u30f3\n    recvOptions =\n      QueueUrl: queueUrl\n      MaxNumberOfMessages: 10\n      VisibilityTimeout: 60\n      WaitTimeSeconds: 20\n\n    # \u30e1\u30c3\u30bb\u30fc\u30b8\u53d7\u4fe1\n    client.receiveMessage recvOptions, (err, data) ->\n      if err\n        console.log \"### \u30a8\u30e9\u30fc\", err\n        return\n\n      # \u30e1\u30c3\u30bb\u30fc\u30b8\u304c\u3042\u308c\u3070\n      if data?.Messages?.length > 0\n\n        # \u30e1\u30c3\u30bb\u30fc\u30b8\u4ef6\u6570\u5206\u51e6\u7406\n        for message, i in data.Messages\n          console.log \"### \u30e1\u30c3\u30bb\u30fc\u30b8[#{i}]\", message.Body\n\n          # \u524a\u9664\u7528\u30d1\u30e9\u30e1\u30fc\u30bf\n          delOptions =\n            QueueUrl: queueUrl\n            ReceiptHandle: message.ReceiptHandle\n\n          # \u30e1\u30c3\u30bb\u30fc\u30b8\u524a\u9664\uff08ElasticMQ\u306f\u5fc5\u8981\u306a\u3044\uff1f\uff1f\uff09\n          client.deleteMessage delOptions, (err, data) ->\n            if err\n               console.log \"### \u30a8\u30e9\u30fc\", err\n               return\n\n\n\n\n\n\n```coffeescript\n\nSQS = require('aws-sdk').SQS\n\n# \u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u3092\u751f\u6210\nclient = new SQS\n  accessKeyId: '\u30a2\u30af\u30bb\u30b9\u30ad\u30fcID\u3092\u8a18\u8ff0...'  # ElasticMQ\u306e\u5834\u5408\u306f\u4e0d\u4f7f\u7528\n  secretAccessKey: '\u30b7\u30fc\u30af\u30ec\u30c3\u30c8\u30a2\u30af\u30bb\u30b9\u30ad\u30fc\u3092\u8a18\u8ff0...'  # ElasticMQ\u306e\u5834\u5408\u306f\u4e0d\u4f7f\u7528\n  apiVersion: '2012-11-05'\n  region: '\u30ea\u30fc\u30b8\u30e7\u30f3\u3092\u8a18\u8ff0...'  # ElasticMQ\u306e\u5834\u5408\u306f\u4e0d\u4f7f\u7528\n\n# \u30ad\u30e5\u30fc\u540d\nqueueName = '\u30ad\u30e5\u30fc\u540d\u3092\u8a18\u8ff0...'\n\n# \u30ed\u30fc\u30ab\u30eb\u958b\u767a\u74b0\u5883\u7528(ElasticMQ)\nqueueUrl = \"http://localhost:9324/queue/#{queueName}\"\n# \u672c\u756a\u74b0\u5883\u7528(AWS SQS)\n# queueUrl = \"https://sqs.\u30ea\u30fc\u30b8\u30e7\u30f3.amazonaws.com/xxxxxxxxxx/#{queueName}\"\n\n# ElasticMQ\u7528\u306b\u30b3\u30ec\u3092\u8a2d\u5b9a\u3059\u308b\u5fc5\u8981\u304c\u3042\u308b\nclient.setEndpoint 'http://localhost:9324'\n\n# \u30ad\u30e5\u30fc\u3092\u4f5c\u6210\nclient.createQueue {QueueName: queueName}, (err) ->\n\n  if err\n    console.log \"### \u30a8\u30e9\u30fc\", err\n    return\n\n  # \u9001\u4fe1\u7528\u30d1\u30e9\u30e1\u30fc\u30bf\n  sendParams =\n    QueueUrl: queueUrl\n    MessageBody: 'This is a test'\n    DelaySeconds: 0\n\n  # \u30e1\u30c3\u30bb\u30fc\u30b8\u9001\u4fe1\n  client.sendMessage sendParams, (err) ->\n    if err\n      console.log \"### \u30a8\u30e9\u30fc\", err\n      return\n\n    # \u53d7\u4fe1\u7528\u30aa\u30d7\u30b7\u30e7\u30f3\n    recvOptions =\n      QueueUrl: queueUrl\n      MaxNumberOfMessages: 10\n      VisibilityTimeout: 60\n      WaitTimeSeconds: 20\n\n    # \u30e1\u30c3\u30bb\u30fc\u30b8\u53d7\u4fe1\n    client.receiveMessage recvOptions, (err, data) ->\n      if err\n        console.log \"### \u30a8\u30e9\u30fc\", err\n        return\n\n      # \u30e1\u30c3\u30bb\u30fc\u30b8\u304c\u3042\u308c\u3070\n      if data?.Messages?.length > 0\n\n        # \u30e1\u30c3\u30bb\u30fc\u30b8\u4ef6\u6570\u5206\u51e6\u7406\n        for message, i in data.Messages\n          console.log \"### \u30e1\u30c3\u30bb\u30fc\u30b8[#{i}]\", message.Body\n\n          # \u524a\u9664\u7528\u30d1\u30e9\u30e1\u30fc\u30bf\n          delOptions =\n            QueueUrl: queueUrl\n            ReceiptHandle: message.ReceiptHandle\n\n          # \u30e1\u30c3\u30bb\u30fc\u30b8\u524a\u9664\uff08ElasticMQ\u306f\u5fc5\u8981\u306a\u3044\uff1f\uff1f\uff09\n          client.deleteMessage delOptions, (err, data) ->\n            if err\n               console.log \"### \u30a8\u30e9\u30fc\", err\n               return\n\n\n```\n", "tags": ["Node.js", "ElasticMQ", "sqs"]}