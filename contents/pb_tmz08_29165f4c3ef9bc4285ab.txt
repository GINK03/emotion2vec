{"context": " More than 1 year has passed since last update.2015-09-03 \u7de8\u96c6\n\u3053\u306e\u8a18\u4e8b\u306f ffmpeg Advent Calendar 2014 - Qiita \u306e\u521d\u65e5\u3067\u3059\u3002\n\u521d\u6295\u7a3f\u3002\u3088\u308d\u3057\u304f\u304a\u9858\u3044\u3057\u307e\u3059\u3002\n-- \u4ee5\u4e0b\u672c\u6587\nffmpeg\u304clibx265 \u30a8\u30f3\u30b3\u30fc\u30c9\u306b\u5bfe\u5fdc\u3057\u3066\u3044\u305f\u306e\u3067\u66f4\u65b0\n\nx265 \u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\nx265 wiki\n\nhg \u30d0\u30fc\u30b8\u30e7\u30f3\u78ba\u8a8d\n$ hg --version\nMercurial Distributed SCM (version 1.4)\n\nCopyright (C) 2005-2009 Matt Mackall <mpm@selenic.com> and others\nThis is free software; see the source for copying conditions. There is NO\nwarranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\n\n\nhg \u306a\u3051\u308c\u3070\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n# yum install mercurial-1.4-3.el6.x86_64\n\n\nlibx265 \u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\n$ hg clone https://bitbucket.org/multicoreware/x265\n\n\ncmake \u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u78ba\u8a8d\n$ cmake -version\ncmake version 2.8.8\n\nx265\u306e\u30b3\u30f3\u30d1\u30a4\u30eb\u6642\u306b\u8b66\u544a\u3055\u308c\u305f\u5834\u5408\u306f\u66f4\u65b0\u3059\u308b\n\nlibx265 \u30d3\u30eb\u30c9\uff0f\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n$ cd x265/build\n$ cmake .\n$ make\n# make install\n\n2015-09-03 \u73fe\u5728\n$ cd x265/build/linux\n$ ./make-Makefiles.bash\n\nBIN_INSTALL_DIR      -> /usr/local/bin\nCMAKE_INSTALL_PREFIX -> /usr\nLIB_INSTALL_DIR      -> /usr/local/lib\n\n$ make\n# make install\n[ 63%] Built target common\n[ 87%] Built target encoder\n[ 87%] Built target x265-shared\n[100%] Built target cli\n[100%] Built target x265-static\nInstall the project...\n-- Install configuration: \"Release\"\n-- Installing: /usr/local/lib/libx265.a\n-- Installing: /usr/include/x265.h\n-- Installing: /usr/include/x265_config.h\n-- Installing: /usr/local/lib/libx265.so.74\n-- Installing: /usr/local/lib/libx265.so\n-- Installing: /usr/local/lib/pkgconfig/x265.pc\n-- Installing: /usr/local/bin/x265\n-- Removed runtime path from \"/usr/local/bin/x265\"\n\n\n\nffmpeg \u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\ndownload\n$ git clone git://source.ffmpeg.org/ffmpeg.git ffmpeg\nor\n$ cd ffmpeg\n$ git pull\n\n\u30d7\u30ed\u30ad\u30b7\u7d4c\u7531\u3059\u308b\u5834\u5408\u306f\n$ git config --global https.proxy https://[host]:[port]/\n$ git clone https://github.com/FFmpeg/FFmpeg ffmpeg\n\n\nffmpeg configure\n\u4e0b\u8a18\u306f\u3001\u6700\u4f4e\u9650\u306e\u8a2d\u5b9a\u3067\u3059\u3002\n$ cd ffmpeg\n$ ./configure \\\n--prefix=/usr/local \\\n--enable-gpl \\\n--enable-version3 \\\n--enable-nonfree \\\n--enable-static \\\n--disable-shared \\\n--enable-libx265 \\\n--extra-cflags=\"-I/usr/local/include -I/usr/include\" \\\n--extra-ldflags=\"-L/usr/local/lib\" \\\n--enable-memalign-hack\n\n\n[Error] x265 NOT FOUND\nx265.h \u304c\u30a8\u30e9\u30fc\u3057\u3066\u308b\u3063\u307d\u3044\u3002\n# vi /usr/local/include/x265.h\n\n\n117\u884c\u76ee\u3042\u305f\u308a\n\n/* Stores inter (motion estimation) analysis data for a single frame */\n- struct x265_inter_data\n+ typedef struct x265_inter_data\n{\n    uint32_t zOrder;\n    int      ref[2];\n    int      costZero[2];\n    int16_t  mvx[2];\n    int1y[2];\n    uint32_t depth;\n    int      poc;\n    uint32_t cuAddr;\n- };\n+ } x265_inter_data;\n\n/* Stores intra (motion estimation) analysis data for a single frame */\n- struct x265_intra_data\n+ typedef struct x265_intra_data\n{\n    uint8_t*  depth;\n    uinmodes;\n    char*     partSizes;\n    int*      poc;\n    uint32_t* cuAddr;\n- };\n+ } x265_intra_data;\n\n/* Stores all analysis data for a single frame */\n- struct x265_analysis_data\n+ typedef struct x265_analysis_data\n{\n    x265_inter_data* interData;\n    x265_intra_data* intraData;\n    uint32_t         numCUsInFrame;\n    uint32_t         numPartitions;\n- };\n+ } x265_analysis_data;\n\n\n[Error] AVFoundation/AVFoundation.h file not found\ngcc-objc \u304c\u306a\u3044\u3089\u3057\u3044\n2015-09-03 \u73fe\u5728\n\u9593\u9055\u3063\u3066\u3044\u305d\u3046\u306a\u306e\u3067\u8abf\u67fb\u4e2d\u3002\n# yum install gcc-objc\n\n\n[Error] x265.pc not found\n$ export PKG_CONFIG_PATH=/usr/local/lib/pkgconfig\n\n2015-09-03 \u73fe\u5728\n\u30a8\u30e9\u30fc\u30e1\u30c3\u30bb\u30fc\u30b8\u304c\u5909\u66f4\u3055\u308c\u3066\u3044\u308b\nx265 not found\n\n./configure\u304c\u901a\u3063\u305f\u3089\n$ make\n$ ./ffmpeg -version\nffmpeg version N-68129-g928322c Copyright (c) 2000-2014 the FFmpeg developers\nbuilt on Dec  1 2014 16:38:07 with gcc 4.4.7 (GCC) 20120313 (Red Hat 4.4.7-4)\nconfiguration: --prefix=/usr/local --enable-gpl --enable-version3 --enable-nonfree --enable-static --disable-shared --enable-libx265 --extra-cflags=-I/usr/local/include --extra-ldflags=-L/usr/local/lib --enable-memalign-hack\nlibavutil      54. 15.100 / 54. 15.100\nlibavcodec     56. 13.100 / 56. 13.100\nlibavformat    56. 15.101 / 56. 15.101\nlibavdevice    56.  3.100 / 56.  3.100\nlibavfilter     5.  2.103 /  5.  2.103\nlibswscale      3.  1.101 /  3.  1.101\nlibswresample   1.  1.100 /  1.  1.100\nlibpostproc    53.  3.100 / 53.  3.100\n\n\n\n\u30e9\u30a4\u30d6\u30e9\u30ea\u304c\u6b63\u3057\u304f\u30ea\u30f3\u30af\u3055\u308c\u3066\u3044\u308b\u304b\u3069\u3046\u304b\u306e\u78ba\u8a8d\n$ ldd ./ffmpeg\n[root@studiowebserv ffmpeg]# ldd ./ffmpeg\n        linux-vdso.so.1 =>  (0x00007fff5a5ff000)\n        libx265.so.38 => /usr/local/lib/libx265.so.38 (0x00007f4a29734000)\n        libm.so.6 => /lib64/libm.so.6 (0x00000033a8e00000)\n        libz.so.1 => /lib64/libz.so.1 (0x00000033a9a00000)\n        librt.so.1 => /lib64/librt.so.1 (0x00000033a9e00000)\n        libpthread.so.0 => /lib64/libpthread.so.0 (0x00000033a9200000)\n        libc.so.6 => /lib64/libc.so.6 (0x00000033a8a00000)\n        libstdc++.so.6 => /usr/lib64/libstdc++.so.6 (0x00000033af200000)\n        libgcc_s.so.1 => /lib64/libgcc_s.so.1 (0x00000033ae200000)\n        /lib64/ld-linux-x86-64.so.2 (0x00000033a8600000)\n\n\n[Error] libx265.so.38 not found\n\u78ba\u8a8d\u4e8b\u9805\n$ cat /etc/ld.so.conf\ninclude ld.so.conf.d/*.conf\n/usr/local/lib\n\n# ldconfig -v\n\n\n\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n# make install\n\n$ ffmpeg -codecs | grep libx265\n\n DEV.L. hevc                 H.265 / HEVC (High Efficiency Video Coding) (encoders: libx265 )\n\n\u4ee5\u4e0a\u3002\nFFmpeg\u3084\u5404\u7a2e\u30e9\u30a4\u30d6\u30e9\u30ea\u306f\u3001\u3069\u3093\u3069\u3093\u30a2\u30c3\u30d7\u30c7\u30fc\u30c8\u3055\u308c\u307e\u3059\u306e\u3067\u3001\n\u4e0a\u8a18\u65b9\u6cd5\u3067\u30b3\u30f3\u30d1\u30a4\u30eb\u3067\u304d\u306a\u304f\u306a\u308b\u3053\u3068\u304c\u3042\u308a\u307e\u3059\u3002\n\u3054\u4e86\u627f\u304f\u3060\u3055\u3044\u3002\n2015-09-03 \u7de8\u96c6\n\n\u3053\u306e\u8a18\u4e8b\u306f ffmpeg Advent Calendar 2014 - Qiita \u306e\u521d\u65e5\u3067\u3059\u3002\n\u521d\u6295\u7a3f\u3002\u3088\u308d\u3057\u304f\u304a\u9858\u3044\u3057\u307e\u3059\u3002\n\n\n-- \u4ee5\u4e0b\u672c\u6587\n\n\nffmpeg\u304clibx265 \u30a8\u30f3\u30b3\u30fc\u30c9\u306b\u5bfe\u5fdc\u3057\u3066\u3044\u305f\u306e\u3067\u66f4\u65b0\n\n\n# x265 \u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n[x265 wiki](https://bitbucket.org/multicoreware/x265/wiki/Home)\n\n## hg \u30d0\u30fc\u30b8\u30e7\u30f3\u78ba\u8a8d\n```\n$ hg --version\nMercurial Distributed SCM (version 1.4)\n\nCopyright (C) 2005-2009 Matt Mackall <mpm@selenic.com> and others\nThis is free software; see the source for copying conditions. There is NO\nwarranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\n```\n\n## hg \u306a\u3051\u308c\u3070\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n```\n# yum install mercurial-1.4-3.el6.x86_64\n```\n\n## libx265 \u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\n```\n$ hg clone https://bitbucket.org/multicoreware/x265\n```\n\n## cmake \u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u78ba\u8a8d\n```\n$ cmake -version\ncmake version 2.8.8\n```\nx265\u306e\u30b3\u30f3\u30d1\u30a4\u30eb\u6642\u306b\u8b66\u544a\u3055\u308c\u305f\u5834\u5408\u306f\u66f4\u65b0\u3059\u308b\n\n## libx265 \u30d3\u30eb\u30c9\uff0f\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n```\n$ cd x265/build\n$ cmake .\n$ make\n# make install\n```\n\n2015-09-03 \u73fe\u5728\n\n```\n$ cd x265/build/linux\n$ ./make-Makefiles.bash\n\nBIN_INSTALL_DIR      -> /usr/local/bin\nCMAKE_INSTALL_PREFIX -> /usr\nLIB_INSTALL_DIR      -> /usr/local/lib\n\n$ make\n# make install\n[ 63%] Built target common\n[ 87%] Built target encoder\n[ 87%] Built target x265-shared\n[100%] Built target cli\n[100%] Built target x265-static\nInstall the project...\n-- Install configuration: \"Release\"\n-- Installing: /usr/local/lib/libx265.a\n-- Installing: /usr/include/x265.h\n-- Installing: /usr/include/x265_config.h\n-- Installing: /usr/local/lib/libx265.so.74\n-- Installing: /usr/local/lib/libx265.so\n-- Installing: /usr/local/lib/pkgconfig/x265.pc\n-- Installing: /usr/local/bin/x265\n-- Removed runtime path from \"/usr/local/bin/x265\"\n\n```\n\n\n\n## ffmpeg \u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n[download](https://www.ffmpeg.org/download.html)\n\n```\n$ git clone git://source.ffmpeg.org/ffmpeg.git ffmpeg\nor\n$ cd ffmpeg\n$ git pull\n```\n\n\u30d7\u30ed\u30ad\u30b7\u7d4c\u7531\u3059\u308b\u5834\u5408\u306f\n\n```\n$ git config --global https.proxy https://[host]:[port]/\n$ git clone https://github.com/FFmpeg/FFmpeg ffmpeg\n```\n\n## ffmpeg configure\n\u4e0b\u8a18\u306f\u3001\u6700\u4f4e\u9650\u306e\u8a2d\u5b9a\u3067\u3059\u3002\n\n```\n$ cd ffmpeg\n$ ./configure \\\n--prefix=/usr/local \\\n--enable-gpl \\\n--enable-version3 \\\n--enable-nonfree \\\n--enable-static \\\n--disable-shared \\\n--enable-libx265 \\\n--extra-cflags=\"-I/usr/local/include -I/usr/include\" \\\n--extra-ldflags=\"-L/usr/local/lib\" \\\n--enable-memalign-hack\n```\n\n### [Error] x265 NOT FOUND\n``x265.h`` \u304c\u30a8\u30e9\u30fc\u3057\u3066\u308b\u3063\u307d\u3044\u3002\n\n```\n# vi /usr/local/include/x265.h\n```\n\n * 117\u884c\u76ee\u3042\u305f\u308a\n\n```diff\n/* Stores inter (motion estimation) analysis data for a single frame */\n- struct x265_inter_data\n+ typedef struct x265_inter_data\n{\n    uint32_t zOrder;\n    int      ref[2];\n    int      costZero[2];\n    int16_t  mvx[2];\n    int1y[2];\n    uint32_t depth;\n    int      poc;\n    uint32_t cuAddr;\n- };\n+ } x265_inter_data;\n\n/* Stores intra (motion estimation) analysis data for a single frame */\n- struct x265_intra_data\n+ typedef struct x265_intra_data\n{\n    uint8_t*  depth;\n    uinmodes;\n    char*     partSizes;\n    int*      poc;\n    uint32_t* cuAddr;\n- };\n+ } x265_intra_data;\n\n/* Stores all analysis data for a single frame */\n- struct x265_analysis_data\n+ typedef struct x265_analysis_data\n{\n    x265_inter_data* interData;\n    x265_intra_data* intraData;\n    uint32_t         numCUsInFrame;\n    uint32_t         numPartitions;\n- };\n+ } x265_analysis_data;\n```\n\n### [Error] AVFoundation/AVFoundation.h file not found\n~~``gcc-objc`` \u304c\u306a\u3044\u3089\u3057\u3044~~\n\n2015-09-03 \u73fe\u5728\n\u9593\u9055\u3063\u3066\u3044\u305d\u3046\u306a\u306e\u3067\u8abf\u67fb\u4e2d\u3002\n\n```\n# yum install gcc-objc\n```\n\n### [Error] x265.pc not found\n```\n$ export PKG_CONFIG_PATH=/usr/local/lib/pkgconfig\n```\n 2015-09-03 \u73fe\u5728\n\u30a8\u30e9\u30fc\u30e1\u30c3\u30bb\u30fc\u30b8\u304c\u5909\u66f4\u3055\u308c\u3066\u3044\u308b\nx265 not found\n\n\n## ./configure\u304c\u901a\u3063\u305f\u3089\n```\n$ make\n$ ./ffmpeg -version\nffmpeg version N-68129-g928322c Copyright (c) 2000-2014 the FFmpeg developers\nbuilt on Dec  1 2014 16:38:07 with gcc 4.4.7 (GCC) 20120313 (Red Hat 4.4.7-4)\nconfiguration: --prefix=/usr/local --enable-gpl --enable-version3 --enable-nonfree --enable-static --disable-shared --enable-libx265 --extra-cflags=-I/usr/local/include --extra-ldflags=-L/usr/local/lib --enable-memalign-hack\nlibavutil      54. 15.100 / 54. 15.100\nlibavcodec     56. 13.100 / 56. 13.100\nlibavformat    56. 15.101 / 56. 15.101\nlibavdevice    56.  3.100 / 56.  3.100\nlibavfilter     5.  2.103 /  5.  2.103\nlibswscale      3.  1.101 /  3.  1.101\nlibswresample   1.  1.100 /  1.  1.100\nlibpostproc    53.  3.100 / 53.  3.100\n\n```\n\n## \u30e9\u30a4\u30d6\u30e9\u30ea\u304c\u6b63\u3057\u304f\u30ea\u30f3\u30af\u3055\u308c\u3066\u3044\u308b\u304b\u3069\u3046\u304b\u306e\u78ba\u8a8d\n```\n$ ldd ./ffmpeg\n[root@studiowebserv ffmpeg]# ldd ./ffmpeg\n        linux-vdso.so.1 =>  (0x00007fff5a5ff000)\n        libx265.so.38 => /usr/local/lib/libx265.so.38 (0x00007f4a29734000)\n        libm.so.6 => /lib64/libm.so.6 (0x00000033a8e00000)\n        libz.so.1 => /lib64/libz.so.1 (0x00000033a9a00000)\n        librt.so.1 => /lib64/librt.so.1 (0x00000033a9e00000)\n        libpthread.so.0 => /lib64/libpthread.so.0 (0x00000033a9200000)\n        libc.so.6 => /lib64/libc.so.6 (0x00000033a8a00000)\n        libstdc++.so.6 => /usr/lib64/libstdc++.so.6 (0x00000033af200000)\n        libgcc_s.so.1 => /lib64/libgcc_s.so.1 (0x00000033ae200000)\n        /lib64/ld-linux-x86-64.so.2 (0x00000033a8600000)\n```\n\n### [Error] libx265.so.38 not found\n\u78ba\u8a8d\u4e8b\u9805\n\n```\n$ cat /etc/ld.so.conf\ninclude ld.so.conf.d/*.conf\n/usr/local/lib\n\n# ldconfig -v\n```\n\n## \u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n```\n# make install\n\n$ ffmpeg -codecs | grep libx265\n\n DEV.L. hevc                 H.265 / HEVC (High Efficiency Video Coding) (encoders: libx265 )\n```\n\n\u4ee5\u4e0a\u3002\nFFmpeg\u3084\u5404\u7a2e\u30e9\u30a4\u30d6\u30e9\u30ea\u306f\u3001\u3069\u3093\u3069\u3093\u30a2\u30c3\u30d7\u30c7\u30fc\u30c8\u3055\u308c\u307e\u3059\u306e\u3067\u3001\n\u4e0a\u8a18\u65b9\u6cd5\u3067\u30b3\u30f3\u30d1\u30a4\u30eb\u3067\u304d\u306a\u304f\u306a\u308b\u3053\u3068\u304c\u3042\u308a\u307e\u3059\u3002\n\u3054\u4e86\u627f\u304f\u3060\u3055\u3044\u3002\n", "tags": ["ffmpeg2.4", "x265", "CentOS6.x", "Linux"]}