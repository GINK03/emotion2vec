{"context": " More than 1 year has passed since last update.(MacOSX10.9, Vagrant1.7.2)\n\n\u76ee\u7684\nWeb+DB Press Vol.86 \u306e Docker \u7279\u96c64\u306e\u8a18\u4e8b\u3067\n\ncap -version\u3068\u5b9f\u884c\u3057\u3066\u304f\u305f\u3099\u3055\u3044\u3002\u3059\u308b\u3068 Capistrano \u306e Docker \u30a4\u30e1\u30fc\u30b7\u3099\u306e\u30bf\u3099\u30a6\u30f3\u30ed\u30fc\u30c8\u3099\u304b\u3099\u59cb\u307e\u308a\u3001\u30bf\u3099\u30a6\u30f3\u30ed\u30fc\u30c8\u3099\u304b\u3099\u7d42\u308f\u308b\u3068\u30cf\u3099\u30fc\u30b7\u3099\u30e7\u30f3\u3092\u8868\u793a\u3059\u308b\u305f\u3081\u305f\u3099\u3051\u306b Capistrano \u30b3\u30f3\u30c6\u30ca\u304b\u3099\u8d77\u52d5\u3057\u307e\u3059\u3002\n\n\u3053\u308c\u304c\u3069\u3046\u3084\u3063\u3066\u3044\u308b\u306e\u304b\u3088\u304f\u308f\u304b\u3089\u306a\u304b\u3063\u305f\u306e\u3067\u3001\u30b7\u30f3\u30d7\u30eb\u306a\u69cb\u6210\u3067 python \u3067\u8a66\u3057\u3066\u307f\u305f\u3002\n\uff08\u3061\u306a\u307f\u306b CoreOS \u306b Python \u306f\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u3066\u3044\u306a\u3044\uff09\n\n\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u69cb\u6210\n\u30b3\u30fc\u30c9\u306f\u3068\u308a\u3042\u3048\u305a github \u306b\u7f6e\u3044\u3066\u304a\u304d\u307e\u3059 \uff08\u305d\u306e\u3046\u3061\u6d88\u3059\u304b\u3082\uff09\nexample-vagrant-coreos-python\n\u251c\u2500\u2500 Dockerfile\n\u251c\u2500\u2500 coreos\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 Vagrantfile\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 config.rb\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 user-data\n\u2514\u2500\u2500 script\n    \u2514\u2500\u2500 run\n\n\nDockerfile\nFROM python:2.7\nENV PYTHONUNBUFFERED 1\n\n\nVagrant \u3067 CoreOS \u74b0\u5883\u3092\u4f5c\u308b\n\nhttps://coreos.com/docs/running-coreos/platforms/vagrant/\n\n\u4e0a\u8a18\u30ea\u30f3\u30af\u3092\u53c2\u8003\u306b coreos/ \u306b\u4e0b\u8a18\u4e09\u3064\u306e\u30d5\u30a1\u30a4\u30eb\u3092\u7528\u610f\u3059\u308b\n\ncoreos/Vagrantfile\nconfig.vm.synced_folder \u306e\u307f\u4fee\u6b63\u3059\u308b\n      config.vm.synced_folder \"../\", \"/home/core/#{File.basename(File.dirname(Dir.pwd))}\", id: \"core\", :nfs => true, :mount_options => ['nolock,vers=3,udp']\n      $shared_folders.each_with_index do |(host_folder, guest_folder), index|\n\n\ncoreos/config.rb\n\u3053\u3053\u306f\u305d\u306e\u307e\u307e\u304b\u3001\u304a\u597d\u307f\u3067 $update_channel='stable' \u306b\u306b\u3059\u308b\u3068\u304b\u3002\n\ncoreos/user-data\n#cloud-config\n\ncoreos:\nwrite_files:\n  - path: /opt/bin/python\n    permissions: 0755\n    owner: core:core\n    content: |\n      #!/bin/bash\n\n      /home/core/example-vagrant-coreos-python/script/run python $@\n\n\n\u8d77\u52d5\u30b9\u30af\u30ea\u30d7\u30c8\n\nscript/run\n#!/bin/bash\n\nset -e\n\ndocker build -t=python27 example-vagrant-coreos-python/\n\ndocker run \\\n       --rm \\\n       -it \\\n       --name python.`date +%s` \\\n       python27 \\\n       $@\n\n\u672c\u6765\u306f\u3001\u30d3\u30eb\u30c9\u3057\u305f\u3082\u306e\u3092 Docker Hub \u306a\u3069\u306b\u7f6e\u3044\u3066 --net=host hogeghoe \u3068\u304b\u3059\u308b\u306e\u3060\u308d\u3046\u3051\u3069\u3001\u3068\u308a\u3042\u3048\u305a\u304a\u8a66\u3057\u306a\u306e\u3067\u3053\u308c\u3067\u3002\n\n\u5b9f\u884c\n$ cd coreos\n$ vagrand up\n$ vagrand ssh\nCoreOS stable (633.1.0)\n\ncore@core-01 ~ $ python -V\nSending build context to Docker daemon 79.87 kB\nSending build context to Docker daemon\nStep 0 : FROM python:2.7\nPulling repository python\n9fa21a3e9f2f: Download complete\n39bb80489af7: Download complete\ndf2a0347c9d0: Download complete\n7a3871ba15f8: Download complete\na2703ed272d7: Download complete\nc9e3effdd23a: Download complete\n24b3549417de: Download complete\n3009dde7a8a5: Download complete\n9da97b9166df: Download complete\na80d186674da: Download complete\nfe7091222d5c: Download complete\n29d755a35726: Download complete\n1452a2aa19dd: Download complete\nStatus: Downloaded newer image for python:2.7\n ---> 9fa21a3e9f2f\nStep 1 : ENV PYTHONUNBUFFERED 1\n ---> Running in 4a7d8fa7390b\n ---> 4786559fdc11\nRemoving intermediate container 4a7d8fa7390b\nSuccessfully built 4786559fdc11\nPython 2.7.10\n\npython \u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u304c\u8868\u793a\u3055\u308c\u3066\u3044\u308b\u3002\n\n\u53c2\u8003\n\nhttp://gihyo.jp/magazine/wdpress/archive/2015/vol86\nhttps://coreos.com/docs/\n\n\n(MacOSX10.9, Vagrant1.7.2)\n\n## \u76ee\u7684\n\n[Web+DB Press Vol.86](http://gihyo.jp/magazine/wdpress/archive/2015/vol86) \u306e Docker \u7279\u96c64\u306e\u8a18\u4e8b\u3067\n\n> cap -version\u3068\u5b9f\u884c\u3057\u3066\u304f\u305f\u3099\u3055\u3044\u3002\u3059\u308b\u3068 Capistrano \u306e Docker \u30a4\u30e1\u30fc\u30b7\u3099\u306e\u30bf\u3099\u30a6\u30f3\u30ed\u30fc\u30c8\u3099\u304b\u3099\u59cb\u307e\u308a\u3001\u30bf\u3099\u30a6\u30f3\u30ed\u30fc\u30c8\u3099\u304b\u3099\u7d42\u308f\u308b\u3068\u30cf\u3099\u30fc\u30b7\u3099\u30e7\u30f3\u3092\u8868\u793a\u3059\u308b\u305f\u3081\u305f\u3099\u3051\u306b Capistrano \u30b3\u30f3\u30c6\u30ca\u304b\u3099\u8d77\u52d5\u3057\u307e\u3059\u3002\n\n\u3053\u308c\u304c\u3069\u3046\u3084\u3063\u3066\u3044\u308b\u306e\u304b\u3088\u304f\u308f\u304b\u3089\u306a\u304b\u3063\u305f\u306e\u3067\u3001\u30b7\u30f3\u30d7\u30eb\u306a\u69cb\u6210\u3067 python \u3067\u8a66\u3057\u3066\u307f\u305f\u3002\n\uff08\u3061\u306a\u307f\u306b CoreOS \u306b Python \u306f\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u3066\u3044\u306a\u3044\uff09\n\n\n## \u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u69cb\u6210\n\n\u30b3\u30fc\u30c9\u306f\u3068\u308a\u3042\u3048\u305a [github \u306b\u7f6e\u3044\u3066\u304a\u304d\u307e\u3059](https://github.com/CortYuming/example-vagrant-coreos-python) \uff08\u305d\u306e\u3046\u3061\u6d88\u3059\u304b\u3082\uff09\n\n```\nexample-vagrant-coreos-python\n\u251c\u2500\u2500 Dockerfile\n\u251c\u2500\u2500 coreos\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 Vagrantfile\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 config.rb\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 user-data\n\u2514\u2500\u2500 script\n    \u2514\u2500\u2500 run\n```\n\n\n## Dockerfile\n\n```\nFROM python:2.7\nENV PYTHONUNBUFFERED 1\n```\n\n## Vagrant \u3067 CoreOS \u74b0\u5883\u3092\u4f5c\u308b\n\n- https://coreos.com/docs/running-coreos/platforms/vagrant/\n\n\u4e0a\u8a18\u30ea\u30f3\u30af\u3092\u53c2\u8003\u306b `coreos/` \u306b\u4e0b\u8a18\u4e09\u3064\u306e\u30d5\u30a1\u30a4\u30eb\u3092\u7528\u610f\u3059\u308b\n\n### coreos/Vagrantfile\n\n`config.vm.synced_folder` \u306e\u307f\u4fee\u6b63\u3059\u308b\n\n```\n      config.vm.synced_folder \"../\", \"/home/core/#{File.basename(File.dirname(Dir.pwd))}\", id: \"core\", :nfs => true, :mount_options => ['nolock,vers=3,udp']\n      $shared_folders.each_with_index do |(host_folder, guest_folder), index|\n```\n\n### coreos/config.rb\n\n\u3053\u3053\u306f\u305d\u306e\u307e\u307e\u304b\u3001\u304a\u597d\u307f\u3067 `$update_channel='stable'` \u306b\u306b\u3059\u308b\u3068\u304b\u3002\n\n\n### coreos/user-data\n\n```\n#cloud-config\n\ncoreos:\nwrite_files:\n  - path: /opt/bin/python\n    permissions: 0755\n    owner: core:core\n    content: |\n      #!/bin/bash\n\n      /home/core/example-vagrant-coreos-python/script/run python $@\n```\n\n## \u8d77\u52d5\u30b9\u30af\u30ea\u30d7\u30c8\n\n### script/run\n\n```\n#!/bin/bash\n\nset -e\n\ndocker build -t=python27 example-vagrant-coreos-python/\n\ndocker run \\\n       --rm \\\n       -it \\\n       --name python.`date +%s` \\\n       python27 \\\n       $@\n```\n\n\u672c\u6765\u306f\u3001\u30d3\u30eb\u30c9\u3057\u305f\u3082\u306e\u3092 Docker Hub \u306a\u3069\u306b\u7f6e\u3044\u3066 `--net=host hogeghoe` \u3068\u304b\u3059\u308b\u306e\u3060\u308d\u3046\u3051\u3069\u3001\u3068\u308a\u3042\u3048\u305a\u304a\u8a66\u3057\u306a\u306e\u3067\u3053\u308c\u3067\u3002\n\n## \u5b9f\u884c\n\n```\n$ cd coreos\n$ vagrand up\n$ vagrand ssh\nCoreOS stable (633.1.0)\n```\n\n```\ncore@core-01 ~ $ python -V\nSending build context to Docker daemon 79.87 kB\nSending build context to Docker daemon\nStep 0 : FROM python:2.7\nPulling repository python\n9fa21a3e9f2f: Download complete\n39bb80489af7: Download complete\ndf2a0347c9d0: Download complete\n7a3871ba15f8: Download complete\na2703ed272d7: Download complete\nc9e3effdd23a: Download complete\n24b3549417de: Download complete\n3009dde7a8a5: Download complete\n9da97b9166df: Download complete\na80d186674da: Download complete\nfe7091222d5c: Download complete\n29d755a35726: Download complete\n1452a2aa19dd: Download complete\nStatus: Downloaded newer image for python:2.7\n ---> 9fa21a3e9f2f\nStep 1 : ENV PYTHONUNBUFFERED 1\n ---> Running in 4a7d8fa7390b\n ---> 4786559fdc11\nRemoving intermediate container 4a7d8fa7390b\nSuccessfully built 4786559fdc11\nPython 2.7.10\n```\n\npython \u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u304c\u8868\u793a\u3055\u308c\u3066\u3044\u308b\u3002\n\n\n## \u53c2\u8003\n\n- http://gihyo.jp/magazine/wdpress/archive/2015/vol86\n- https://coreos.com/docs/\n", "tags": ["docker", "vagrant", "CoreOS"]}