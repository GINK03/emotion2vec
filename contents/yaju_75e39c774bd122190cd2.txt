{"context": "\n\n\u306f\u3058\u3081\u306b\n\u65e2\u5b58\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3(\u30ec\u30ac\u30b7\u30fcASP)\u3067\u30ed\u30b0\u51fa\u529b\u3057\u305f\u969b\u306b\u51e6\u7406\u6642\u9593\u306e\u9805\u76ee\u304c\u3042\u308b\u306e\u3067\u3059\u304c\u3001\u77ed\u3044\u51e6\u7406\u3067\u306f\u6307\u6570\u8868\u793a\u306b\u306a\u3063\u3066\u3057\u307e\u3044\u307e\u3059\u3002\u30ed\u30b0\u89e3\u6790\u3067\u6307\u6570\u5bfe\u5fdc\u3055\u308c\u3066\u306a\u3044\u5834\u5408\u3001\u4f8b\u3048\u30703.12E-02\u306f0.0312\u306a\u3093\u3067\u3059\u304c\u30013.12\u79d2\u3068\u3057\u3066\u6271\u308f\u308c\u3066\u3057\u307e\u3046\u3002\n\u6539\u4fee\u4f5c\u696d\u3068\u3057\u3066\u3001\u6307\u6570\u8868\u793a\u306b\u306a\u3089\u306a\u3044\u3088\u3046\u306b\u30ed\u30b0\u51fa\u529b\u3057\u3066\u6b32\u3057\u3044\u3068\u306e\u3053\u3068\u3067\u3057\u305f\u3002\n\u30cd\u30c3\u30c8\u3067\u691c\u7d22\u3057\u305f\u3068\u3053\u308d\u3001Val\u95a2\u6570\u3092\u4f7f\u3048\u3070\u51fa\u6765\u308b\u3068\u3044\u3046\u3053\u3068\u3067\u5b89\u6613\u306b\u8003\u3048\u3066\u3044\u305f\u306e\u3067\u3059\u304c\u3001\u3044\u3056Val\u95a2\u6570\u3092\u4f7f\u3063\u3066\u307f\u308b\u3068\u30a8\u30e9\u30fc\u3068\u306a\u308a\u307e\u3057\u305f\u3002\n\u5b9f\u306fVB6\u3084VBA\u306a\u3089Val\u95a2\u6570\u304c\u3042\u3063\u305f\u306e\u3067\u3059\u304c\u3001VBScript\u306b\u306fVal\u95a2\u6570\u304c\u7121\u304b\u3063\u305f\u306e\u3067\u3059\u3002\n\nVBScript\u306e\u4e0d\u8db3\u6a5f\u80fd\nVisual Basic for Applications (VBA) \u3068 VBScript (VBS) \u306f\u3001\u3069\u3061\u3089\u3082\u57fa\u672c\u7684\u306b Visual Basic \u306e\u6587\u6cd5\u3092\u8e0f\u8972\u3057\u3066\u304a\u308a\u3001Visual Basic \u306e\u30b9\u30c6\u30fc\u30c8\u30e1\u30f3\u30c8\u3084\u95a2\u6570\u304c\u4f7f\u7528\u53ef\u80fd\u3067\u3059\u3002\nVBScript\u306b\u306fCvar\u3001CVDate\u3001Str\u3001Val\u3001StrConv \u306a\u3069\u306e\u30c7\u30fc\u30bf\u5909\u63db\u304c\u7121\u3044\n\u4ee3\u8868\u7684\u306a\u3082\u306e\u306f\u4ee5\u4e0b\u306e\u901a\u308a\u3067\u3059 (\u5b8c\u5168\u306a\u30ea\u30b9\u30c8\u306b\u3064\u3044\u3066\u306f\u300cVisual Basic for Applications Features Not In VBScript\u3092\u53c2\u7167)\u3002\n\nCollection \u30aa\u30d6\u30b8\u30a7\u30af\u30c8\nOn Error Goto \u306a\u3069\u306e\u30a8\u30e9\u30fc\u5236\u5fa1\nCvar\u3001CVDate\u3001Str\u3001Val\u3001StrConv \u306a\u3069\u306e\u30c7\u30fc\u30bf\u5909\u63db\nDebug.Print \u306a\u3069\u306e\u30c7\u30d0\u30c3\u30b0\u7528\u30b9\u30c6\u30fc\u30c8\u30e1\u30f3\u30c8\nDeclare \u306b\u3088\u308b DLL \u306e\u95a2\u6570\u5b9a\u7fa9\nOpen\u3001Print\u3001Input\u3001Write\u3001Get\u3001Put \u306a\u3069\u306e\u30d5\u30a1\u30a4\u30eb\u64cd\u4f5c\nLike \u6f14\u7b97\u5b50\n\u30a4\u30d9\u30f3\u30c8\u51e6\u7406\n\n\u53c2\u7167:Visual Basic for Applications \u3092 VBScript \u306b\u7f6e\u304d\u63db\u3048\u308b\u65b9\u6cd5 - Outlook \u7814\u7a76\u6240\n\nVal\u95a2\u6570\u3082\u3069\u304d\u306e\u4ed5\u69d8\n\u7121\u3044\u3082\u306e\u306f\u4f5c\u6210\u3057\u307e\u3059\u3002\u305f\u3060\u5168\u304f\u540c\u3058\u306b\u3059\u308b\u306e\u306f\u96e3\u3057\u3044\u3067\u3059\u3057\u3001\u7c21\u6613\u7684\u904e\u304e\u3066\u3082\u6c4e\u7528\u6027\u304c\u7121\u3044\u305f\u3081\u3001\u305d\u308c\u306a\u308a\u306b\u771f\u4f3c\u307e\u3059\u3002\n\n\u4f7f\u7528\u4f8b\n\n\n\n\u8aac\u660e\n\u8a18\u8ff0\u4f8b\n\u51fa\u529b\n\n\n\n\n\u6307\u5b9a\u5024\u3092Double\u578b\u306b\u5909\u63db\nVal(\"1.23\")\n1.23\n\n\n\n\n\u52d5\u4f5c\u691c\u8a3c\n\u4e0b\u8a18\u8868\u306eVBS\u51fa\u529b\u306e\u9805\u76ee\u304c\u4eca\u56de\u306eVal\u95a2\u6570\u3082\u3069\u304d\u306e\u5024\u3068\u306a\u308a\u307e\u3059\u3002\nVBA\u95a2\u6570\u306eVal\u95a2\u6570\u3068\u9055\u3044\u3001\u6570\u5024\u306e\u524d\u306e\u82f1\u5b57\u30fb\u8a18\u53f7\u3084\",\"\u304c\u3042\u3063\u3066\u3082\u5909\u63db\u51fa\u6765\u308b\u3088\u3046\u306b\u3057\u307e\u3057\u305f\u3002\n\n\n\n\u8aac\u660e\n\u8a18\u8ff0\u4f8b\nVBA\u51fa\u529b\nVBS\u51fa\u529b\n\n\n\n\n\u6307\u6570\u8868\u8a18\u306e\u6570\u5024(E-)\nVal(\"123E-2\")\n1.23\n1.23\n\n\n\u6307\u6570\u8868\u8a18\u306e\u6570\u5024(E+)\nVal(\"123E+2\")\n12300\n12300\n\n\n\u6307\u6570\u8868\u8a18\u306e\u6570\u5024(E\u306e\u307f)\nVal(\"123E2\")\n12300\n12300\n\n\n\u6307\u6570\u8868\u8a18\u306e\u6570\u5024(E-0)\nVal(\"123E-02\")\n1.23\n1.23\n\n\n\u6307\u6570\u8868\u8a18\u306e\u6570\u5024(E+0)\nVal(\"123E+02\")\n12300\n12300\n\n\n\u6307\u6570\u8868\u8a18\u306e\u6570\u5024(E0\u306e\u307f)\nVal(\"123E02\")\n12300\n12300\n\n\n\u6570\u5024\u306e\u524d\u306b\u6587\u5b57\u5217\nVal(\"abc1.23\")\n0\n1.23\n\n\n\u6570\u5024\u306e\u9593\u306b\u6587\u5b57\u5217\nVal(\"1.2abc3\")\n1.2\n1.23\n\n\n\u6570\u5024\u306e\u5f8c\u306b\u6587\u5b57\u5217\nVal(\"1.23abc\")\n1.23\n1.23\n\n\n\u5148\u982d\u304c\u70b9\u306e\u6587\u5b57\u5217\nVal(\".123\")\n0.123\n0.123\n\n\n\u672b\u5c3e\u304c\u70b9\u306e\u6587\u5b57\u5217\nVal(\"123.\")\n123\n123\n\n\n\u5148\u982d\u304c\u8907\u6570\u70b9\u306e\u6587\u5b57\u5217\nVal(\"...123\")\n0\n0.123\n\n\n\u672b\u5c3e\u304c\u8907\u6570\u70b9\u306e\u6587\u5b57\u5217\nVal(\"1.23...\")\n1.23\n1.23\n\n\n\u6570\u5024\u4ee5\u5916\u306e\u6587\u5b57\u5217\u306e\u307f\nVal(\"abc\")\n0\n0\n\n\n\u5168\u89d2\u6570\u5024\u306e\u6587\u5b57\u5217\u306e\u307f\nVal(\"\uff11\uff12\uff0e\uff13\uff14\")\n0\n0\n\n\n\u300c,\u300d\u533a\u5207\u308a\u306e\u6570\u5024\nVal(\"1,234,567\")\n1\n1234567\n\n\n8\u9032\u6570\u306e\u6570\u5024\nVal(\"&O123\")\n83\n83\n\n\n16\u9032\u6570\u306e\u6570\u5024(\u6574\u6570\u578b)\nVal(\"&H123\")\n291\n291\n\n\n16\u9032\u6570\u306e\u6570\u5024(\u8ca0\u6570)\nVal(\"&HFFE0\")\n-32\n-32\n\n\n16\u9032\u6570\u306e\u6570\u5024(\u9577\u6574\u6570\u578b)\nVal(\"&H123abc\")\n1194684\n1194684\n\n\n\u30b9\u30da\u30fc\u30b9\u3092\u542b\u3093\u3060\u6587\u5b57\u5217\nVal(\"      123.45 \u5186\")\n123.45\n123.45\n\n\n\n\u203b\u5024\u304c\u5927\u304d\u3044\u6307\u6570\u6709\u308a\u5834\u5408\u3001\u6307\u6570\u304c\u4ed8\u3044\u305f\u307e\u307e\u306b\u306a\u308a\u307e\u3059\u3002\n\n\n\n\u8aac\u660e\n\u8a18\u8ff0\u4f8b\nVBA\u51fa\u529b\nVBS\u51fa\u529b\n\n\n\n\nDouble\u578b\u306e\u6700\u5c0f\u5024\u8fd1\u304f(-1.79769313486231E+308)\nVal(\"-1.79769313486231E+308\")\n-1.79769313486231E+308\n-1.79769313486231E+308\n\n\nDouble\u578b\u306e\u6700\u5927\u5024\u8fd1\u304f( 1.79769313486231E+308)\nVal(\"1.79769313486231E+308\")\n1.79769313486231E+308\n1.79769313486231E+308\n\n\n\n\n\u30bd\u30fc\u30b9\u30ea\u30b9\u30c8\nFunction Val(value)\n    Dim colMatches, match, submatch, sign, reg, exp, i, j, st\n\n    Val = 0\n\n    'COM\u306e\u6b63\u898f\u8868\u73fe\u3092\u4f7f\u7528\u3059\u308b\u3068\u578b\u304c\u81ea\u52d5\u5909\u63db\u3055\u308c\u308b\n    Set reg = CreateObject(\"VBScript.RegExp\")\n    reg.Pattern = \"([-0-9.]+)(E[+-]?[0-9]+)|([-0-9.]+)|(&H[0-9A-F]+)|(&O[0-9]+)\"\n    reg.IgnoreCase = True\n    reg.Global = True\n    Set colMatches = reg.Execute(value)\n\n    For Each match In colMatches\n        For i = 0 To match.SubMatches.Count - 1\n            submatch = UCase(match.SubMatches(i))\n\n            If Instr(submatch, \"E\") = 1 Then\n                '\u9023\u7d9aE\u3092\u6392\u9664\n                submatch = Replace(submatch, \"E\", \"\")\n                sign = Mid(submatch, 1,1)\n                st = 1\n                If sign = \"-\" OR sign = \"+\" Then st = 2\n                If sign = \"\" Then submatch = submatch + \"0\"\n                exp = Mid(submatch, st)\n                If exp <> \"\" Then\n                    '\u6307\u6570\u3042\u308a\n                    exp = 10 ^ CInt(exp)\n                    If sign = \"-\" Then\n                        Val = Val / exp\n                    Else\n                        Val = Val * exp\n                    End If\n                End If\n            Else\n                '\u6307\u6570\u306a\u3057\n                Val = Val & submatch\n            End If\n\n            '\u5c0f\u65700.\u4ee5\u5916\u306e\u5148\u982d0\u3092\u6d88\u53bb\u3059\u308b\n            If Instr(Val, \"0\") = 1 And Instr(Val, \"0.\") <> 1 then\n                Val = Mid(Val, 2)\n            End If\n        Next\n    Next\n\n    '16\u9032\u6570\u30688\u9032\u6570\u5bfe\u5fdc\n    If Instr(value, \"&\") > 0 then\n        Val = CInt(Val)\n    End If\n\n    '\u672b\u5c3e\".\"\u3092\u9664\u53bb\n    For i = Len(Val) To 0 Step -1\n        If Right(Val, 1) = \".\" Then\n            Val = Left(Val, i-1)\n        Else\n            Exit For\n        End If \n    Next\n\n    '\u5148\u982d\".\"\u306f0\u3092\u982d\u306b\u8ffd\u52a0\n    If Instr(Val, \".\") = 1 then\n        Val = \"0.\" & Replace(Val, \".\", \"\") \n    End If \n\n    '\u5909\u63db\u5bfe\u8c61\u5916\u306f0\u3068\u3059\u308b\n    If Val = \"\" OR IsNumeric(Val) = False Then Val = 0\n\n    Set reg = Nothing\nEnd Function\n\n\n\u30e9\u30a4\u30bb\u30f3\u30b9\u3063\u307d\u3044\u3053\u3068\n\u30b3\u30fc\u30c9\u6539\u5909\u3084\u914d\u5e03\u306f\u81ea\u7531\u3067\u3059\u3002\n\u3053\u306e\u30c4\u30fc\u30eb\u306b\u3088\u308b\u7fa9\u52d9\uff0f\u8cac\u4efb\u3092\u4f55\u3089\u8ca0\u3044\u307e\u305b\u3093\u3002\n\n\u6700\u5f8c\u306b\n\u6700\u521d\u306b\u6570\u5024\u578b\u306e\u6307\u6570\u3067\u306fCOM\u306e\u6b63\u898f\u8868\u73fe\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u4f7f\u7528\u3057\u305f\u3060\u3051\u3067\u578b\u304c\u81ea\u52d5\u5909\u63db\u3055\u308c\u305f\u306e\u3067\u3042\u3063\u3055\u308a\u51fa\u6765\u308b\u3068\u601d\u308f\u308c\u305f\u306e\u3067\u3059\u304c\u30012\u91cd\u5f15\u7528\u7b26\u3092\u4ed8\u3051\u3066\u6587\u5b57\u578b\u306b\u3057\u305f\u3089\u81ea\u52d5\u5909\u63db\u304c\u6b63\u5e38\u306a\u5024\u3092\u8fd4\u3055\u306a\u304f\u306a\u308a\u3001\u7d50\u5c40\u304c\u3063\u3061\u308a\u7d44\u3080\u3053\u3068\u306b\u306a\u3063\u3066\u3057\u307e\u3044\u307e\u3057\u305f\u3002\n\n\u53c2\u7167\n\nisnumeric\u95a2\u6570\u306b\u3064\u3044\u3066 - VB\u521d\u5fc3\u8005\u53cb\u306e\u4f1a\n\u6307\u5b9a\u3057\u305f\u6587\u5b57\u5217\u306b\u542b\u307e\u308c\u308b\u5024\u3092\u53d6\u5f97\u3059\u308b (Val) - C#\u3068VB.NET\u306e\u5165\u9580\u30b5\u30a4\u30c8\nVB6\u30fbVBA\u95a2\u6570\u30e1\u30e2\uff1aVal\u95a2\u6570 - \u30d5\u30a3\u30ed\u306e\u6751note\nDenis St-Pierre's Val( ) function\n\n# \u306f\u3058\u3081\u306b\n\u65e2\u5b58\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3(\u30ec\u30ac\u30b7\u30fcASP)\u3067\u30ed\u30b0\u51fa\u529b\u3057\u305f\u969b\u306b\u51e6\u7406\u6642\u9593\u306e\u9805\u76ee\u304c\u3042\u308b\u306e\u3067\u3059\u304c\u3001\u77ed\u3044\u51e6\u7406\u3067\u306f\u6307\u6570\u8868\u793a\u306b\u306a\u3063\u3066\u3057\u307e\u3044\u307e\u3059\u3002\u30ed\u30b0\u89e3\u6790\u3067\u6307\u6570\u5bfe\u5fdc\u3055\u308c\u3066\u306a\u3044\u5834\u5408\u3001\u4f8b\u3048\u30703.12E-02\u306f0.0312\u306a\u3093\u3067\u3059\u304c\u30013.12\u79d2\u3068\u3057\u3066\u6271\u308f\u308c\u3066\u3057\u307e\u3046\u3002\n\u6539\u4fee\u4f5c\u696d\u3068\u3057\u3066\u3001\u6307\u6570\u8868\u793a\u306b\u306a\u3089\u306a\u3044\u3088\u3046\u306b\u30ed\u30b0\u51fa\u529b\u3057\u3066\u6b32\u3057\u3044\u3068\u306e\u3053\u3068\u3067\u3057\u305f\u3002\n\n\u30cd\u30c3\u30c8\u3067\u691c\u7d22\u3057\u305f\u3068\u3053\u308d\u3001Val\u95a2\u6570\u3092\u4f7f\u3048\u3070\u51fa\u6765\u308b\u3068\u3044\u3046\u3053\u3068\u3067\u5b89\u6613\u306b\u8003\u3048\u3066\u3044\u305f\u306e\u3067\u3059\u304c\u3001\u3044\u3056Val\u95a2\u6570\u3092\u4f7f\u3063\u3066\u307f\u308b\u3068\u30a8\u30e9\u30fc\u3068\u306a\u308a\u307e\u3057\u305f\u3002\n\u5b9f\u306fVB6\u3084VBA\u306a\u3089Val\u95a2\u6570\u304c\u3042\u3063\u305f\u306e\u3067\u3059\u304c\u3001VBScript\u306b\u306fVal\u95a2\u6570\u304c\u7121\u304b\u3063\u305f\u306e\u3067\u3059\u3002\n\n# VBScript\u306e\u4e0d\u8db3\u6a5f\u80fd\nVisual Basic for Applications (VBA) \u3068 VBScript (VBS) \u306f\u3001\u3069\u3061\u3089\u3082\u57fa\u672c\u7684\u306b Visual Basic \u306e\u6587\u6cd5\u3092\u8e0f\u8972\u3057\u3066\u304a\u308a\u3001Visual Basic \u306e\u30b9\u30c6\u30fc\u30c8\u30e1\u30f3\u30c8\u3084\u95a2\u6570\u304c\u4f7f\u7528\u53ef\u80fd\u3067\u3059\u3002\nVBScript\u306b\u306fCvar\u3001CVDate\u3001Str\u3001Val\u3001StrConv \u306a\u3069\u306e\u30c7\u30fc\u30bf\u5909\u63db\u304c\u7121\u3044\n\u4ee3\u8868\u7684\u306a\u3082\u306e\u306f\u4ee5\u4e0b\u306e\u901a\u308a\u3067\u3059 (\u5b8c\u5168\u306a\u30ea\u30b9\u30c8\u306b\u3064\u3044\u3066\u306f\u300c[Visual Basic for Applications Features Not In VBScript](https://msdn.microsoft.com/en-us/library/30593abb%28v=vs.84%29.aspx?tduid=%286aa1b326fa8d4f62b21e5407acf93183%29%28256380%29%282459594%29%28TnL5HPStwNw-3FPZxo1ioGlaQ8YLCTJVaw%29%28%29&f=255&MSPPError=-2147217396)\u3092\u53c2\u7167)\u3002\n\n  * Collection \u30aa\u30d6\u30b8\u30a7\u30af\u30c8\n  * On Error Goto \u306a\u3069\u306e\u30a8\u30e9\u30fc\u5236\u5fa1\n  * Cvar\u3001CVDate\u3001Str\u3001Val\u3001StrConv \u306a\u3069\u306e\u30c7\u30fc\u30bf\u5909\u63db\n  * Debug.Print \u306a\u3069\u306e\u30c7\u30d0\u30c3\u30b0\u7528\u30b9\u30c6\u30fc\u30c8\u30e1\u30f3\u30c8\n  * Declare \u306b\u3088\u308b DLL \u306e\u95a2\u6570\u5b9a\u7fa9\n  * Open\u3001Print\u3001Input\u3001Write\u3001Get\u3001Put \u306a\u3069\u306e\u30d5\u30a1\u30a4\u30eb\u64cd\u4f5c\n  * Like \u6f14\u7b97\u5b50\n  * \u30a4\u30d9\u30f3\u30c8\u51e6\u7406\n\n\u53c2\u7167:[Visual Basic for Applications \u3092 VBScript \u306b\u7f6e\u304d\u63db\u3048\u308b\u65b9\u6cd5 - Outlook \u7814\u7a76\u6240](https://outlooklab.wordpress.com/2014/03/08/visual-basic-for-applications-%E3%82%92-vbscript-%E3%81%AB%E7%BD%AE%E3%81%8D%E6%8F%9B%E3%81%88%E3%82%8B%E6%96%B9%E6%B3%95/)\n\n# Val\u95a2\u6570\u3082\u3069\u304d\u306e\u4ed5\u69d8\n\u7121\u3044\u3082\u306e\u306f\u4f5c\u6210\u3057\u307e\u3059\u3002\u305f\u3060\u5168\u304f\u540c\u3058\u306b\u3059\u308b\u306e\u306f\u96e3\u3057\u3044\u3067\u3059\u3057\u3001\u7c21\u6613\u7684\u904e\u304e\u3066\u3082\u6c4e\u7528\u6027\u304c\u7121\u3044\u305f\u3081\u3001\u305d\u308c\u306a\u308a\u306b\u771f\u4f3c\u307e\u3059\u3002\n\n## \u4f7f\u7528\u4f8b\n|\u8aac\u660e|\u8a18\u8ff0\u4f8b|\u51fa\u529b|\n|:--|:--|:--|\n|\u6307\u5b9a\u5024\u3092Double\u578b\u306b\u5909\u63db|Val(\"1.23\")|1.23|\n\n## \u52d5\u4f5c\u691c\u8a3c\n\u4e0b\u8a18\u8868\u306eVBS\u51fa\u529b\u306e\u9805\u76ee\u304c\u4eca\u56de\u306eVal\u95a2\u6570\u3082\u3069\u304d\u306e\u5024\u3068\u306a\u308a\u307e\u3059\u3002\nVBA\u95a2\u6570\u306eVal\u95a2\u6570\u3068\u9055\u3044\u3001\u6570\u5024\u306e\u524d\u306e\u82f1\u5b57\u30fb\u8a18\u53f7\u3084\",\"\u304c\u3042\u3063\u3066\u3082\u5909\u63db\u51fa\u6765\u308b\u3088\u3046\u306b\u3057\u307e\u3057\u305f\u3002\n\n|\u8aac\u660e|\u8a18\u8ff0\u4f8b|VBA\u51fa\u529b|VBS\u51fa\u529b|\n|:--|:--|:--|:--|\n|\u6307\u6570\u8868\u8a18\u306e\u6570\u5024(E-)|Val(\"123E-2\")|1.23|1.23|\n|\u6307\u6570\u8868\u8a18\u306e\u6570\u5024(E+)|Val(\"123E+2\")|12300|12300|\n|\u6307\u6570\u8868\u8a18\u306e\u6570\u5024(E\u306e\u307f)|Val(\"123E2\")|12300|12300|\n|\u6307\u6570\u8868\u8a18\u306e\u6570\u5024(E-0)|Val(\"123E-02\")|1.23|1.23|\n|\u6307\u6570\u8868\u8a18\u306e\u6570\u5024(E+0)|Val(\"123E+02\")|12300|12300|\n|\u6307\u6570\u8868\u8a18\u306e\u6570\u5024(E0\u306e\u307f)|Val(\"123E02\")|12300|12300|\n|**\u6570\u5024\u306e\u524d\u306b\u6587\u5b57\u5217**|**Val(\"abc1.23\")**|**0**|**1.23**|\n|**\u6570\u5024\u306e\u9593\u306b\u6587\u5b57\u5217**|**Val(\"1.2abc3\")**|**1.2**|**1.23**|\n|\u6570\u5024\u306e\u5f8c\u306b\u6587\u5b57\u5217|Val(\"1.23abc\")|1.23|1.23|\n|\u5148\u982d\u304c\u70b9\u306e\u6587\u5b57\u5217|Val(\".123\")|0.123|0.123|\n|\u672b\u5c3e\u304c\u70b9\u306e\u6587\u5b57\u5217|Val(\"123.\")|123|123|\n|**\u5148\u982d\u304c\u8907\u6570\u70b9\u306e\u6587\u5b57\u5217**|**Val(\"...123\")**|**0**|**0.123**|\n|\u672b\u5c3e\u304c\u8907\u6570\u70b9\u306e\u6587\u5b57\u5217|Val(\"1.23...\")|1.23|1.23|\n|\u6570\u5024\u4ee5\u5916\u306e\u6587\u5b57\u5217\u306e\u307f|Val(\"abc\")|0|0|\n|\u5168\u89d2\u6570\u5024\u306e\u6587\u5b57\u5217\u306e\u307f|Val(\"\uff11\uff12\uff0e\uff13\uff14\")|0|0|\n|**\u300c,\u300d\u533a\u5207\u308a\u306e\u6570\u5024**|**Val(\"1,234,567\")**|**1**|**1234567**|\n|8\u9032\u6570\u306e\u6570\u5024|Val(\"&O123\")|83|83|\n|16\u9032\u6570\u306e\u6570\u5024(\u6574\u6570\u578b)|Val(\"&H123\")|291|291|\n|16\u9032\u6570\u306e\u6570\u5024(\u8ca0\u6570)|Val(\"&HFFE0\")|-32|-32|\n|16\u9032\u6570\u306e\u6570\u5024(\u9577\u6574\u6570\u578b)|Val(\"&H123abc\")|1194684|1194684|\n|\u30b9\u30da\u30fc\u30b9\u3092\u542b\u3093\u3060\u6587\u5b57\u5217|Val(\"      123.45 \u5186\")|123.45|123.45|\n\n\u203b\u5024\u304c\u5927\u304d\u3044\u6307\u6570\u6709\u308a\u5834\u5408\u3001\u6307\u6570\u304c\u4ed8\u3044\u305f\u307e\u307e\u306b\u306a\u308a\u307e\u3059\u3002\n\n|\u8aac\u660e|\u8a18\u8ff0\u4f8b|VBA\u51fa\u529b|VBS\u51fa\u529b|\n|:--|:--|:--|:--|\n|Double\u578b\u306e\u6700\u5c0f\u5024\u8fd1\u304f(-1.79769313486231E+308)|Val(\"-1.79769313486231E+308\")|-1.79769313486231E+308|-1.79769313486231E+308|\n|Double\u578b\u306e\u6700\u5927\u5024\u8fd1\u304f( 1.79769313486231E+308)|Val(\"1.79769313486231E+308\")|1.79769313486231E+308|1.79769313486231E+308|\n\n# \u30bd\u30fc\u30b9\u30ea\u30b9\u30c8\n\n```vbnet\nFunction Val(value)\n    Dim colMatches, match, submatch, sign, reg, exp, i, j, st\n\n    Val = 0\n\n    'COM\u306e\u6b63\u898f\u8868\u73fe\u3092\u4f7f\u7528\u3059\u308b\u3068\u578b\u304c\u81ea\u52d5\u5909\u63db\u3055\u308c\u308b\n    Set reg = CreateObject(\"VBScript.RegExp\")\n    reg.Pattern = \"([-0-9.]+)(E[+-]?[0-9]+)|([-0-9.]+)|(&H[0-9A-F]+)|(&O[0-9]+)\"\n    reg.IgnoreCase = True\n    reg.Global = True\n    Set colMatches = reg.Execute(value)\n\n    For Each match In colMatches\n        For i = 0 To match.SubMatches.Count - 1\n            submatch = UCase(match.SubMatches(i))\n\n            If Instr(submatch, \"E\") = 1 Then\n                '\u9023\u7d9aE\u3092\u6392\u9664\n                submatch = Replace(submatch, \"E\", \"\")\n                sign = Mid(submatch, 1,1)\n                st = 1\n                If sign = \"-\" OR sign = \"+\" Then st = 2\n                If sign = \"\" Then submatch = submatch + \"0\"\n                exp = Mid(submatch, st)\n                If exp <> \"\" Then\n                    '\u6307\u6570\u3042\u308a\n                    exp = 10 ^ CInt(exp)\n                    If sign = \"-\" Then\n                        Val = Val / exp\n                    Else\n                        Val = Val * exp\n                    End If\n                End If\n            Else\n                '\u6307\u6570\u306a\u3057\n                Val = Val & submatch\n            End If\n\n            '\u5c0f\u65700.\u4ee5\u5916\u306e\u5148\u982d0\u3092\u6d88\u53bb\u3059\u308b\n            If Instr(Val, \"0\") = 1 And Instr(Val, \"0.\") <> 1 then\n                Val = Mid(Val, 2)\n            End If\n        Next\n    Next\n\n    '16\u9032\u6570\u30688\u9032\u6570\u5bfe\u5fdc\n    If Instr(value, \"&\") > 0 then\n        Val = CInt(Val)\n    End If\n\n    '\u672b\u5c3e\".\"\u3092\u9664\u53bb\n    For i = Len(Val) To 0 Step -1\n        If Right(Val, 1) = \".\" Then\n            Val = Left(Val, i-1)\n        Else\n            Exit For\n        End If \n    Next\n\n    '\u5148\u982d\".\"\u306f0\u3092\u982d\u306b\u8ffd\u52a0\n    If Instr(Val, \".\") = 1 then\n        Val = \"0.\" & Replace(Val, \".\", \"\") \n    End If \n\n    '\u5909\u63db\u5bfe\u8c61\u5916\u306f0\u3068\u3059\u308b\n    If Val = \"\" OR IsNumeric(Val) = False Then Val = 0\n\n    Set reg = Nothing\nEnd Function\n```\n\n# \u30e9\u30a4\u30bb\u30f3\u30b9\u3063\u307d\u3044\u3053\u3068\n\u30b3\u30fc\u30c9\u6539\u5909\u3084\u914d\u5e03\u306f\u81ea\u7531\u3067\u3059\u3002\n\u3053\u306e\u30c4\u30fc\u30eb\u306b\u3088\u308b\u7fa9\u52d9\uff0f\u8cac\u4efb\u3092\u4f55\u3089\u8ca0\u3044\u307e\u305b\u3093\u3002\n\n# \u6700\u5f8c\u306b\n\u6700\u521d\u306b\u6570\u5024\u578b\u306e\u6307\u6570\u3067\u306fCOM\u306e\u6b63\u898f\u8868\u73fe\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u4f7f\u7528\u3057\u305f\u3060\u3051\u3067\u578b\u304c\u81ea\u52d5\u5909\u63db\u3055\u308c\u305f\u306e\u3067\u3042\u3063\u3055\u308a\u51fa\u6765\u308b\u3068\u601d\u308f\u308c\u305f\u306e\u3067\u3059\u304c\u30012\u91cd\u5f15\u7528\u7b26\u3092\u4ed8\u3051\u3066\u6587\u5b57\u578b\u306b\u3057\u305f\u3089\u81ea\u52d5\u5909\u63db\u304c\u6b63\u5e38\u306a\u5024\u3092\u8fd4\u3055\u306a\u304f\u306a\u308a\u3001\u7d50\u5c40\u304c\u3063\u3061\u308a\u7d44\u3080\u3053\u3068\u306b\u306a\u3063\u3066\u3057\u307e\u3044\u307e\u3057\u305f\u3002\n\n\n# \u53c2\u7167\n* [isnumeric\u95a2\u6570\u306b\u3064\u3044\u3066 - VB\u521d\u5fc3\u8005\u53cb\u306e\u4f1a](http://www.gizcollabo.jp/vbtomo/log/archive/vbqanda_9_6.html)\n* [\u6307\u5b9a\u3057\u305f\u6587\u5b57\u5217\u306b\u542b\u307e\u308c\u308b\u5024\u3092\u53d6\u5f97\u3059\u308b (Val) - C#\u3068VB.NET\u306e\u5165\u9580\u30b5\u30a4\u30c8](http://jeanne.wankuma.com/tips/vb.net/validation/val.html)\n* [VB6\u30fbVBA\u95a2\u6570\u30e1\u30e2\uff1aVal\u95a2\u6570 - \u30d5\u30a3\u30ed\u306e\u6751note](http://note.phyllo.net/?eid=1106110)\n* [Denis St-Pierre's Val( ) function](http://www.robvanderwoude.com/vbstech_data_string.php)\n", "tags": ["WSH", "VBScript", "asp"]}