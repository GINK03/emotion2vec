{"context": "CentOS6.7\u306bOpenCV3\u3068\u304b\u3092\u5165\u308c\u3088\u3046\u3068\u3057\u305f\u3089\u8af8\u3005\u9762\u5012\u3060\u3063\u305f\u306e\u3067\u74b0\u5883\u69cb\u7bc9\u306e\u518d\u73fe\u6027\u3092\u9ad8\u3081\u308b\u3079\u304f\u624b\u9806\u3092\u8a18\u3059\u3002\u3061\u306a\u307f\u306b\u3001\u79c1\u306fPython\u3092\u66f8\u3044\u305f\u3053\u3068\u306f\u306a\u3044\u3002\u306a\u306e\u3067Python\u306e\u74b0\u5883\u69cb\u7bc9\u306b\u3064\u3044\u3066\u306f\u3082\u3063\u3068\u30a4\u30b1\u3066\u308b\u65b9\u6cd5\u304c\u3042\u3063\u305f\u308a\u3059\u308b\u306e\u304b\u3082\u3057\u308c\u306a\u3044\u3002\n\u3068\u308a\u3042\u3048\u305aminimal\u306aCentOS6.7\u306b\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u8a2d\u5b9a\u3060\u3051\u884c\u3063\u305f\u74b0\u5883\u304b\u3089\u30b9\u30bf\u30fc\u30c8\u3002\n\n\u74b0\u5883\n\nWindows10\u306eHpyer-V\u4e0a\u306b\u5efa\u3066\u305fCentOS 6.7 \uff08minimal\u3067\u5165\u308c\u305f\u3070\u304b\u308a\uff09\n\n\n\u4f55\u306f\u3068\u3082\u3042\u308c\n# yum -y upgrade\n\n\u305d\u306e\u5f8c\u3001\u30e6\u30fc\u30b6\u3092\u8ffd\u52a0\u3057\u3066sudo\u3067\u304d\u308b\u3088\u3046\u306b\u8a2d\u5b9a\u3057\u307e\u3059\u3002\u4eca\u5f8c\u306f\u305d\u306e\u30e6\u30fc\u30b6\u3067\u30ed\u30b0\u30a4\u30f3\u3057\u3066\u64cd\u4f5c\u3057\u307e\u3059\u3002\n\npyenv\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\nPyenv\u306b\u3088\u308bPython3.x\u74b0\u5883\u69cb\u7bc9(CentOS, Ubuntu)\n\n\u5fc5\u8981\u306a\u30d1\u30c3\u30b1\u30fc\u30b8\u3092yum\u3067\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n$ sudo yum install -y git gcc bzip2 bzip2-devel openssl openssl-devel readline readline-devel sqlite-devel\n\n\nPyenv\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n$ cd /usr/local/src\n$ sudo git clone --depth 1 git://github.com/yyuu/pyenv.git ./pyenv\n$ echo 'export PYENV_ROOT=\"/usr/local/src/pyenv\"' | sudo tee -a /etc/profile.d/pyenv.sh\n$ echo 'export PATH=\"${PYENV_ROOT}/shims:${PYENV_ROOT}/bin:${PATH}\"' | sudo tee -a /etc/profile.d/pyenv.sh\n$ source /etc/profile.d/pyenv.sh\n$ pyenv --version\npyenv 20160509\n\nsudo\u3067\u3082PATH\u304c\u901a\u308b\u3088\u3046\u306b\u8a2d\u5b9a\u5909\u66f4\u3057\u307e\u3059\u3002\n$ sudo visudo\n\n-#Defaults    secure_path = /sbin:/bin:/usr/sbin:/usr/bin\n+Defaults    env_keep += \"PATH\"\n+Defaults    env_keep += \"PYENV_ROOT\"\n\n\n\u6700\u65b0\u7248\u306ePython\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\nrbenv\u3068\u540c\u3058\u611f\u3058\u3067\u6700\u65b0\u7248\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\n\u203b rbenv\u3067Ruby\u306e\u6700\u65b0\u5b89\u5b9a\u7248\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\u30ef\u30f3\u30e9\u30a4\u30ca\u30fc\n\u306a\u304a\u3001--enable-shared\u30aa\u30d7\u30b7\u30e7\u30f3\u3092\u3064\u3051\u3066\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u306a\u3044\u3068\u3001OpenCV3\u3092\u30d3\u30eb\u30c9\u3059\u308b\u969b\u306b\u30a8\u30e9\u30fc\u304c\u51fa\u308b\u53ef\u80fd\u6027\u304c\u3042\u308b\u306e\u3067\u6ce8\u610f\u3002\n$ sudo env PYTHON_CONFIGURE_OPTS=\"--enable-shared\" pyenv install  $(pyenv install --list | grep -v - | tail -1)\n$ sudo pyenv global $(pyenv install --list | grep -v - | tail -1)\n$ python --version\nPython 3.5.1\n\n\nffmpeg\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\u3053\u308c\u304c\u4e0a\u624b\u304f\u884c\u304b\u306a\u3044\u3068\u3001OpenCV3\u306ebuild\u3067\u30b3\u30b1\u307e\u304f\u308b\u306e\u3067\u9811\u5f35\u3063\u3066\u5165\u308c\u308b\u3002build\u306b\u6642\u9593\u304c\u304b\u304b\u308b\u306e\u3067\u6ce8\u610f\u3002make\u306e-jN\u30aa\u30d7\u30b7\u30e7\u30f3\u3067\u4e26\u5217\u5316\u3055\u305b\u308b\u3068\u591a\u5c11\u65e9\u304f\u306a\u308b\u306e\u3067\u7a4d\u6975\u7684\u306b\u4f7f\u3046\u3068\u3044\u3044\u3067\u3059\u3002\n\u30aa\u30d7\u30b7\u30e7\u30f3\u306f\u500b\u4eba\u7684\u306b\u5fc5\u8981\u305d\u3046\u306a\u3082\u306e\u3092\u30d4\u30c3\u30af\u30a2\u30c3\u30d7\u3057\u3066\u3044\u307e\u3059\u3002\u4ed6\u306b\u3082\u3042\u308b\u306e\u3067\u3059\u304c\u3001\u5168\u90e8\u5165\u308c\u308b\u3068\u30ad\u30ea\u304c\u306a\u3044\u306e\u3067\u3002\u5fc5\u8981\u306b\u5fdc\u3058\u3066\u3069\u3046\u305e\u3002\nc.f. ffmpeg\u3092\u30b9\u30bf\u30c6\u30a3\u30c3\u30af\u30d3\u30eb\u30c9\u3059\u308b\uff08CentOS6\uff09\n\nyum\u3067\u5165\u308b\u30e9\u30a4\u30d6\u30e9\u30ea\u3092\u5165\u308c\u308b\n\u3072\u3068\u307e\u305a\u3001yum\u306bepel\u30ea\u30dd\u30b8\u30c8\u30ea\u3092\u8ffd\u52a0\u3057\u3066\u3001\u5fc5\u8981\u306a\u30e9\u30a4\u30d6\u30e9\u30ea\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\u3002\n$ sudo yum install -y autoconf automake gcc-c++ libtool wget nasm libtheora-devel\n$ sudo yum -y install http://dl.fedoraproject.org/pub/epel/6/x86_64/epel-release-6-8.noarch.rpm\n$ sudo yum install -y yasm openal-devel\n\n\nX264\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n$ cd /usr/local/src\n$ sudo git clone --depth 1 git://git.videolan.org/x264\n$ cd x264\n$ sudo ./configure --enable-shared\n$ sudo make\n$ sudo make install\n\n\nfdk-aac\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n$ cd /usr/local/src\n$ sudo git clone --depth 1 git://github.com/mstorsjo/fdk-aac.git\n$ cd fdk-aac\n$ sudo autoreconf -fiv\n$ sudo ./configure\n$ sudo make\n$ sudo make install\n$ export LD_LIBRARY_PATH=/usr/local/lib\n$ export LD_RUN_PATH=$LD_LIBRARY_PATH\n\n\nlame\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n$ cd /usr/local/src\n$ sudo wget http://downloads.sourceforge.net/project/lame/lame/3.99/lame-3.99.5.tar.gz\n$ sudo tar zxvf lame-3.99.5.tar.gz\n$ sudo mv lame-3.99.5 lame\n$ sudo chown -R root:root lame #\u6240\u6709\u8005\u304c\u304a\u304b\u3057\u3051\u308c\u3070\n$ cd lame\n$ sudo ./configure --enable-nasm\n$ sudo make\n$ sudo make install\n\n\nxvid\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n$ cd /usr/local/src\n$ sudo wget http://downloads.xvid.org/downloads/xvidcore-1.3.2.tar.gz\n$ sudo tar xzvf xvidcore-1.3.2.tar.gz\n$ sudo chown -R root:root xvidcore\n$ cd xvidcore/build/generic/\n$ sudo ./configure\n$ sudo make\n$ sudo make install\n\n\nffmpeg\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\u3053\u3053\u307e\u3067\u5165\u308c\u3066\u3044\u305f\u3089\u3001\u591a\u5206\u3053\u3051\u306a\u3044\u306f\u305a\u2026\u3002\u7d50\u69cb\u6642\u9593\u304b\u304b\u308b\u306e\u3067\u6b6f\u78e8\u304d\u3067\u3082\u3057\u306a\u304c\u3089\u5f85\u3064\u3053\u3068\u3002\n$ cd /usr/local/src\n$ sudo git clone --depth 1 git://source.ffmpeg.org/ffmpeg.git\n$ cd ffmpeg\n$ sudo ./configure --arch=x86_64 --enable-gpl --enable-libmp3lame --enable-libtheora --enable-libx264 --enable-libxvid --enable-nonfree --enable-openal --disable-static --enable-shared --enable-version3 --enable-zlib --enable-pthreads\n$ sudo make -j8  #CPU\u306e\u30b3\u30a2\u6570\u306b\u5fdc\u3058\u3066\n$ sudo make install\n\n\u4e0b\u8a18\u306e\u30d1\u30b9\u3092\u8ffd\u52a0\u3057\u3066\u304a\u304f\u3002\n$ echo 'export LD_LIBRARY_PATH=/usr/local/lib' | sudo tee -a /etc/profile.d/ffmpeg.sh\n$ echo 'export PKG_CONFIG_PATH=/usr/local/lib/pkgconfig' | sudo tee -a /etc/profile.d/ffmpeg.sh\n$ source /etc/profile.d/ffmpeg.sh\n$ sudo sh -c \"echo /usr/local/lib >> /etc/ld.so.conf.d/ffmpeg.conf\"\n$ sudo ldconfig\n\n\u30e9\u30a4\u30d6\u30e9\u30ea\u306bnotfound\u304c\u51fa\u306a\u3044\u304b\u78ba\u8a8d\u3057\u3066\u304a\u304f\u3002\n$ sudo ldd `which ffmpeg`\n        linux-vdso.so.1 =>  (0x00007ffe656f1000)\n        libavdevice.so.57 => /usr/local/lib/libavdevice.so.57 (0x00007feb59d5e000)\n        libavfilter.so.6 => /usr/local/lib/libavfilter.so.6 (0x00007feb5994c000)\n        libavformat.so.57 => /usr/local/lib/libavformat.so.57 (0x00007feb59548000)\n        libavcodec.so.57 => /usr/local/lib/libavcodec.so.57 (0x00007feb57e08000)\n        libpostproc.so.54 => /usr/local/lib/libpostproc.so.54 (0x00007feb57bc0000)\n        libswresample.so.2 => /usr/local/lib/libswresample.so.2 (0x00007feb579a4000)\n        libswscale.so.4 => /usr/local/lib/libswscale.so.4 (0x00007feb57712000)\n        libavutil.so.55 => /usr/local/lib/libavutil.so.55 (0x00007feb5749d000)\n        libm.so.6 => /lib64/libm.so.6 (0x00007feb57218000)\n        libpthread.so.0 => /lib64/libpthread.so.0 (0x00007feb56ffb000)\n        libc.so.6 => /lib64/libc.so.6 (0x00007feb56c67000)\n        libopenal.so.1 => /usr/lib64/libopenal.so.1 (0x00007feb56a0e000)\n        libbz2.so.1 => /lib64/libbz2.so.1 (0x00007feb567fd000)\n        libz.so.1 => /lib64/libz.so.1 (0x00007feb565e7000)\n        libx264.so.148 => /usr/local/lib/libx264.so.148 (0x00007feb5622c000)\n        libtheoraenc.so.1 => /usr/lib64/libtheoraenc.so.1 (0x00007feb55fff000)\n        libtheoradec.so.1 => /usr/lib64/libtheoradec.so.1 (0x00007feb55df0000)\n        libmp3lame.so.0 => /usr/local/lib/libmp3lame.so.0 (0x00007feb55b67000)\n        librt.so.1 => /lib64/librt.so.1 (0x00007feb5595f000)\n        /lib64/ld-linux-x86-64.so.2 (0x00007feb5a1af000)\n        libdl.so.2 => /lib64/libdl.so.2 (0x00007feb5575a000)\n        libogg.so.0 => /usr/lib64/libogg.so.0 (0x00007feb55554000)\n\n\n$ ffmpeg -version\nffmpeg version git-2016-05-14-d680ab1 Copyright (c) 2000-2016 the FFmpeg developers\nbuilt with gcc 4.4.7 (GCC) 20120313 (Red Hat 4.4.7-16)\nconfiguration: --arch=x86_64 --enable-gpl --enable-libmp3lame --enable-libtheora --enable-libx264 --enable-libxvid --enable-nonfree --enable-openal --enable-pic --enable-shared --enable-version3 --enable-zlib --extra-ldexeflags=-pie --enable-pthreads\nlibavutil      55. 24.100 / 55. 24.100\nlibavcodec     57. 41.102 / 57. 41.102\nlibavformat    57. 36.100 / 57. 36.100\nlibavdevice    57.  0.101 / 57.  0.101\nlibavfilter     6. 45.100 /  6. 45.100\nlibswscale      4.  1.100 /  4.  1.100\nlibswresample   2.  0.101 /  2.  0.101\nlibpostproc    54.  0.100 / 54.  0.100\n\nDecode\u3068Encode\u306e\u5bfe\u5fdc\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u4e00\u89a7\u306f\u4e0b\u8a18\u30b3\u30de\u30f3\u30c9\u3067\u898b\u308b\u3002\u3082\u3057\u304a\u671b\u307f\u306e\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u304c\u306a\u3051\u308c\u3070\u3001\u30e9\u30a4\u30d6\u30e9\u30ea\u3068\u30aa\u30d7\u30b7\u30e7\u30f3\u30d5\u30e9\u30b0\u3092\u78ba\u8a8d\u3057\u3066\u3001\u30b3\u30f3\u30d1\u30a4\u30eb\u3057\u76f4\u3057\u3066\u4e0b\u3055\u3044\u2026\u3002\n$ ffmpeg -formats\n\n\nOpenCV3\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\u3084\u3063\u3068\u3053\u3053\u307e\u3067\u6765\u307e\u3057\u305f\u3002\u3057\u304b\u3057\u3001\u3053\u3053\u3067OpenCV3\u306e\u30d3\u30eb\u30c9\u30a8\u30e9\u30fc\u306b\u5fc3\u304c\u6298\u3089\u308c\u308b\u4eba\u304c\u591a\u6570\u5b58\u5728\u3059\u308b\u3088\u3046\u3067\u3059\u3002\u30b4\u30fc\u30eb\u306f\u76ee\u524d\u3001\u9811\u5f35\u308a\u307e\u3059\u3002\n\nyum\u3067\u5fc5\u8981\u306a\u30e9\u30a4\u30d6\u30e9\u30ea\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\nyum\u3067opencv2\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u3066\u30a2\u30f3\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\u3053\u3068\u306b\u3088\u3063\u3066opencv3\u3067\u3082\u5fc5\u8981\u305d\u3046\u306a\u4f9d\u5b58\u30e9\u30a4\u30d6\u30e9\u30ea\u304c\u30b5\u30af\u30c3\u3068\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3067\u304d\u307e\u3059\u3002\u305d\u306e\u4ed6\u3001\u5fc5\u8981\u306a\u3082\u306e\u3082\u3059\u3079\u3066yum\u3067\u5165\u308c\u3066\u3057\u307e\u3044\u307e\u3059\u3002\n$ sudo sh -c \"yum install -y opencv && yum remove -y opencv\"\n$ sudo yum install -y cmake libjpeg-devel libtiff-devel libpng-devel jasper-devel \n\n\npip\u3067numpy\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\n$ sudo pip install --upgrade pip\n$ sudo pip install numpy\n\n\nOpenCV3\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\nOpenCV3.1.0\u3068\u5fc5\u8981\u306amodule\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3057\u307e\u3059\u3002git\u304b\u3089clone\u3057\u3066\u3082\u3044\u3044\u304b\u3082\u3057\u308c\u306a\u3044\u3093\u3067\u3059\u304c\u3001\u6642\u9593\u304c\u304b\u304b\u308a\u305d\u3046\u306a\u3093\u3067\u666e\u901a\u306bzip\u3092\u843d\u3068\u3057\u3066\u89e3\u51cd\u3057\u307e\u3057\u305f\u3002\n\n$ cd /usr/local/src\n$ sudo wget https://github.com/Itseez/opencv/archive/3.1.0.zip\n$ sudo wget https://github.com/Itseez/opencv_contrib/archive/3.1.0.zip\n$ sudo unzip 3.1.0.zip\\*\n$ cd opencv-3.1.0\n$ sudo mkdir build\n$ cd build\n\ncmake\u306e\u30aa\u30d7\u30b7\u30e7\u30f3\u306f\u74b0\u5883\u306b\u5408\u308f\u305b\u3066\u9069\u6642\u4fee\u6574\u3057\u3066\u304f\u3060\u3055\u3044\u3002PYTHON2\u3068\u304b\u306e\u30aa\u30d7\u30b7\u30e7\u30f3\u306f\u4eca\u56de\u306f\u3042\u3093\u307e\u308a\u8a66\u3057\u3066\u3044\u306a\u3044\u3067\u3059\u3002\n$ sudo cmake -D CMAKE_BUILD_TYPE=RELEASE \\\n-D CMAKE_INSTALL_PREFIX=/usr/local \\\n-D BUILD_opencv_python3=ON \\\n-D INSTALL_PYTHON_EXAMPLES=ON \\\n-D PYTHON_EXECUTABLE=$(which python) \\\n-D PYTHON3_EXECUTABLE=$(which python) \\\n-D PYTHON3_LIBRARY=/usr/local/src/pyenv/versions/3.5.1/lib/libpython3.5m.so \\\n-D PYTHON3_INCLUDE_DIR=/usr/local/src/pyenv/versions/3.5.1/include/python3.5m \\\n-D PYTHON3_PACKAGES_PATH=/usr/local/src/pyenv/versions/3.5.1/lib/python3.5/site-packages \\\n-D OPENCV_EXTRA_MODULES_PATH=/usr/local/src/opencv_contrib-3.1.0/modules ..\n\n\u305d\u3057\u3066make\uff01\n$ sudo make -j8 #\u30b3\u30a2\u6570\u306b\u5fdc\u3058\u3066\n\n\u3059\u308b\u3068\u3001\u304b\u306a\u308a\u306e\u9ad8\u78ba\u7387\u3067\u3053\u3044\u3064\u304c\u51fa\u3066\u304d\u307e\u3059\u3002\n/usr/bin/ld: /usr/local/include/../lib/libswscale.a(swscale.o): relocation R_X86_64_PC32 against symbol `ff_M24A' can not be used when making a shared object; recompile with -fPIC\n/usr/bin/ld: final link failed: Bad value\n\n\u3053\u3046\u306a\u3063\u305f\u5834\u5408\u306f\u3001root\u306b\u306a\u3063\u3066cmake\u3057\u306a\u304a\u3059\u3068\u901a\u308b\u3053\u3068\u304c\u591a\u3044\u3067\u3059\u3002\n$ su # or sudo su\n# cd /usr/local/src/opencv-3.1.0/build\n# cmake ..\n# make -j8\n# make install\n\n\u6700\u5f8c\u306b\u78ba\u8a8d\u3067\u3059\u3002\n$ python\nPython 3.5.1 (default, May 14 2016, 16:55:55) \n[GCC 4.4.7 20120313 (Red Hat 4.4.7-16)] on linux\nType \"help\", \"copyright\", \"credits\" or \"license\" for more information.\n>>> import cv2\n>>> cv2.__version__\n'3.1.0'\n>>> \n\n\u4ee5\u4e0a\u3067\u3059\uff01\nCentOS6.7\u306bOpenCV3\u3068\u304b\u3092\u5165\u308c\u3088\u3046\u3068\u3057\u305f\u3089\u8af8\u3005\u9762\u5012\u3060\u3063\u305f\u306e\u3067\u74b0\u5883\u69cb\u7bc9\u306e\u518d\u73fe\u6027\u3092\u9ad8\u3081\u308b\u3079\u304f\u624b\u9806\u3092\u8a18\u3059\u3002\u3061\u306a\u307f\u306b\u3001\u79c1\u306fPython\u3092\u66f8\u3044\u305f\u3053\u3068\u306f\u306a\u3044\u3002\u306a\u306e\u3067Python\u306e\u74b0\u5883\u69cb\u7bc9\u306b\u3064\u3044\u3066\u306f\u3082\u3063\u3068\u30a4\u30b1\u3066\u308b\u65b9\u6cd5\u304c\u3042\u3063\u305f\u308a\u3059\u308b\u306e\u304b\u3082\u3057\u308c\u306a\u3044\u3002\n\n\u3068\u308a\u3042\u3048\u305aminimal\u306aCentOS6.7\u306b\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u8a2d\u5b9a\u3060\u3051\u884c\u3063\u305f\u74b0\u5883\u304b\u3089\u30b9\u30bf\u30fc\u30c8\u3002\n\n# \u74b0\u5883\n* Windows10\u306eHpyer-V\u4e0a\u306b\u5efa\u3066\u305fCentOS 6.7 \uff08minimal\u3067\u5165\u308c\u305f\u3070\u304b\u308a\uff09\n\n# \u4f55\u306f\u3068\u3082\u3042\u308c\n\n```\n# yum -y upgrade\n```\n\n\u305d\u306e\u5f8c\u3001\u30e6\u30fc\u30b6\u3092\u8ffd\u52a0\u3057\u3066sudo\u3067\u304d\u308b\u3088\u3046\u306b\u8a2d\u5b9a\u3057\u307e\u3059\u3002\u4eca\u5f8c\u306f\u305d\u306e\u30e6\u30fc\u30b6\u3067\u30ed\u30b0\u30a4\u30f3\u3057\u3066\u64cd\u4f5c\u3057\u307e\u3059\u3002\n\n# pyenv\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n[Pyenv\u306b\u3088\u308bPython3.x\u74b0\u5883\u69cb\u7bc9(CentOS, Ubuntu)](http://qiita.com/akito1986/items/be5dcd1a502aaf22010b)\n\n## \u5fc5\u8981\u306a\u30d1\u30c3\u30b1\u30fc\u30b8\u3092yum\u3067\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n```\n$ sudo yum install -y git gcc bzip2 bzip2-devel openssl openssl-devel readline readline-devel sqlite-devel\n```\n\n## Pyenv\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n```\n$ cd /usr/local/src\n$ sudo git clone --depth 1 git://github.com/yyuu/pyenv.git ./pyenv\n$ echo 'export PYENV_ROOT=\"/usr/local/src/pyenv\"' | sudo tee -a /etc/profile.d/pyenv.sh\n$ echo 'export PATH=\"${PYENV_ROOT}/shims:${PYENV_ROOT}/bin:${PATH}\"' | sudo tee -a /etc/profile.d/pyenv.sh\n$ source /etc/profile.d/pyenv.sh\n$ pyenv --version\npyenv 20160509\n```\n\nsudo\u3067\u3082PATH\u304c\u901a\u308b\u3088\u3046\u306b\u8a2d\u5b9a\u5909\u66f4\u3057\u307e\u3059\u3002\n\n```\n$ sudo visudo\n```\n\n```diff\n-#Defaults    secure_path = /sbin:/bin:/usr/sbin:/usr/bin\n+Defaults    env_keep += \"PATH\"\n+Defaults    env_keep += \"PYENV_ROOT\"\n```\n\n## \u6700\u65b0\u7248\u306ePython\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\n\nrbenv\u3068\u540c\u3058\u611f\u3058\u3067\u6700\u65b0\u7248\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\n\u203b [rbenv\u3067Ruby\u306e\u6700\u65b0\u5b89\u5b9a\u7248\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\u30ef\u30f3\u30e9\u30a4\u30ca\u30fc](http://mawatari.jp/archives/install-latest-stable-version-of-ruby-using-rbenv)\n\n\u306a\u304a\u3001--enable-shared\u30aa\u30d7\u30b7\u30e7\u30f3\u3092\u3064\u3051\u3066\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u306a\u3044\u3068\u3001OpenCV3\u3092\u30d3\u30eb\u30c9\u3059\u308b\u969b\u306b\u30a8\u30e9\u30fc\u304c\u51fa\u308b\u53ef\u80fd\u6027\u304c\u3042\u308b\u306e\u3067\u6ce8\u610f\u3002\n\n```\n$ sudo env PYTHON_CONFIGURE_OPTS=\"--enable-shared\" pyenv install  $(pyenv install --list | grep -v - | tail -1)\n$ sudo pyenv global $(pyenv install --list | grep -v - | tail -1)\n$ python --version\nPython 3.5.1\n```\n\n# ffmpeg\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n\u3053\u308c\u304c\u4e0a\u624b\u304f\u884c\u304b\u306a\u3044\u3068\u3001OpenCV3\u306ebuild\u3067\u30b3\u30b1\u307e\u304f\u308b\u306e\u3067\u9811\u5f35\u3063\u3066\u5165\u308c\u308b\u3002build\u306b\u6642\u9593\u304c\u304b\u304b\u308b\u306e\u3067\u6ce8\u610f\u3002make\u306e-jN\u30aa\u30d7\u30b7\u30e7\u30f3\u3067\u4e26\u5217\u5316\u3055\u305b\u308b\u3068\u591a\u5c11\u65e9\u304f\u306a\u308b\u306e\u3067\u7a4d\u6975\u7684\u306b\u4f7f\u3046\u3068\u3044\u3044\u3067\u3059\u3002\n\u30aa\u30d7\u30b7\u30e7\u30f3\u306f\u500b\u4eba\u7684\u306b\u5fc5\u8981\u305d\u3046\u306a\u3082\u306e\u3092\u30d4\u30c3\u30af\u30a2\u30c3\u30d7\u3057\u3066\u3044\u307e\u3059\u3002\u4ed6\u306b\u3082\u3042\u308b\u306e\u3067\u3059\u304c\u3001\u5168\u90e8\u5165\u308c\u308b\u3068\u30ad\u30ea\u304c\u306a\u3044\u306e\u3067\u3002\u5fc5\u8981\u306b\u5fdc\u3058\u3066\u3069\u3046\u305e\u3002\nc.f. [ffmpeg\u3092\u30b9\u30bf\u30c6\u30a3\u30c3\u30af\u30d3\u30eb\u30c9\u3059\u308b\uff08CentOS6\uff09](http://qiita.com/takakiku/items/4f129a8859d99f6be2db)\n\n\n## yum\u3067\u5165\u308b\u30e9\u30a4\u30d6\u30e9\u30ea\u3092\u5165\u308c\u308b\n\u3072\u3068\u307e\u305a\u3001yum\u306bepel\u30ea\u30dd\u30b8\u30c8\u30ea\u3092\u8ffd\u52a0\u3057\u3066\u3001\u5fc5\u8981\u306a\u30e9\u30a4\u30d6\u30e9\u30ea\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\u3002\n\n```\n$ sudo yum install -y autoconf automake gcc-c++ libtool wget nasm libtheora-devel\n$ sudo yum -y install http://dl.fedoraproject.org/pub/epel/6/x86_64/epel-release-6-8.noarch.rpm\n$ sudo yum install -y yasm openal-devel\n```\n\n## X264\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n```\n$ cd /usr/local/src\n$ sudo git clone --depth 1 git://git.videolan.org/x264\n$ cd x264\n$ sudo ./configure --enable-shared\n$ sudo make\n$ sudo make install\n```\n\n## fdk-aac\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n```\n$ cd /usr/local/src\n$ sudo git clone --depth 1 git://github.com/mstorsjo/fdk-aac.git\n$ cd fdk-aac\n$ sudo autoreconf -fiv\n$ sudo ./configure\n$ sudo make\n$ sudo make install\n$ export LD_LIBRARY_PATH=/usr/local/lib\n$ export LD_RUN_PATH=$LD_LIBRARY_PATH\n```\n\n## lame\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n```\n$ cd /usr/local/src\n$ sudo wget http://downloads.sourceforge.net/project/lame/lame/3.99/lame-3.99.5.tar.gz\n$ sudo tar zxvf lame-3.99.5.tar.gz\n$ sudo mv lame-3.99.5 lame\n$ sudo chown -R root:root lame #\u6240\u6709\u8005\u304c\u304a\u304b\u3057\u3051\u308c\u3070\n$ cd lame\n$ sudo ./configure --enable-nasm\n$ sudo make\n$ sudo make install\n```\n\n## xvid\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n```\n$ cd /usr/local/src\n$ sudo wget http://downloads.xvid.org/downloads/xvidcore-1.3.2.tar.gz\n$ sudo tar xzvf xvidcore-1.3.2.tar.gz\n$ sudo chown -R root:root xvidcore\n$ cd xvidcore/build/generic/\n$ sudo ./configure\n$ sudo make\n$ sudo make install\n```\n\n## ffmpeg\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n\u3053\u3053\u307e\u3067\u5165\u308c\u3066\u3044\u305f\u3089\u3001\u591a\u5206\u3053\u3051\u306a\u3044\u306f\u305a\u2026\u3002\u7d50\u69cb\u6642\u9593\u304b\u304b\u308b\u306e\u3067\u6b6f\u78e8\u304d\u3067\u3082\u3057\u306a\u304c\u3089\u5f85\u3064\u3053\u3068\u3002\n\n\n```\n$ cd /usr/local/src\n$ sudo git clone --depth 1 git://source.ffmpeg.org/ffmpeg.git\n$ cd ffmpeg\n$ sudo ./configure --arch=x86_64 --enable-gpl --enable-libmp3lame --enable-libtheora --enable-libx264 --enable-libxvid --enable-nonfree --enable-openal --disable-static --enable-shared --enable-version3 --enable-zlib --enable-pthreads\n$ sudo make -j8  #CPU\u306e\u30b3\u30a2\u6570\u306b\u5fdc\u3058\u3066\n$ sudo make install\n```\n\n\u4e0b\u8a18\u306e\u30d1\u30b9\u3092\u8ffd\u52a0\u3057\u3066\u304a\u304f\u3002\n\n```\n$ echo 'export LD_LIBRARY_PATH=/usr/local/lib' | sudo tee -a /etc/profile.d/ffmpeg.sh\n$ echo 'export PKG_CONFIG_PATH=/usr/local/lib/pkgconfig' | sudo tee -a /etc/profile.d/ffmpeg.sh\n$ source /etc/profile.d/ffmpeg.sh\n$ sudo sh -c \"echo /usr/local/lib >> /etc/ld.so.conf.d/ffmpeg.conf\"\n$ sudo ldconfig\n```\n\n\u30e9\u30a4\u30d6\u30e9\u30ea\u306bnotfound\u304c\u51fa\u306a\u3044\u304b\u78ba\u8a8d\u3057\u3066\u304a\u304f\u3002\n\n```shell-session\n$ sudo ldd `which ffmpeg`\n        linux-vdso.so.1 =>  (0x00007ffe656f1000)\n        libavdevice.so.57 => /usr/local/lib/libavdevice.so.57 (0x00007feb59d5e000)\n        libavfilter.so.6 => /usr/local/lib/libavfilter.so.6 (0x00007feb5994c000)\n        libavformat.so.57 => /usr/local/lib/libavformat.so.57 (0x00007feb59548000)\n        libavcodec.so.57 => /usr/local/lib/libavcodec.so.57 (0x00007feb57e08000)\n        libpostproc.so.54 => /usr/local/lib/libpostproc.so.54 (0x00007feb57bc0000)\n        libswresample.so.2 => /usr/local/lib/libswresample.so.2 (0x00007feb579a4000)\n        libswscale.so.4 => /usr/local/lib/libswscale.so.4 (0x00007feb57712000)\n        libavutil.so.55 => /usr/local/lib/libavutil.so.55 (0x00007feb5749d000)\n        libm.so.6 => /lib64/libm.so.6 (0x00007feb57218000)\n        libpthread.so.0 => /lib64/libpthread.so.0 (0x00007feb56ffb000)\n        libc.so.6 => /lib64/libc.so.6 (0x00007feb56c67000)\n        libopenal.so.1 => /usr/lib64/libopenal.so.1 (0x00007feb56a0e000)\n        libbz2.so.1 => /lib64/libbz2.so.1 (0x00007feb567fd000)\n        libz.so.1 => /lib64/libz.so.1 (0x00007feb565e7000)\n        libx264.so.148 => /usr/local/lib/libx264.so.148 (0x00007feb5622c000)\n        libtheoraenc.so.1 => /usr/lib64/libtheoraenc.so.1 (0x00007feb55fff000)\n        libtheoradec.so.1 => /usr/lib64/libtheoradec.so.1 (0x00007feb55df0000)\n        libmp3lame.so.0 => /usr/local/lib/libmp3lame.so.0 (0x00007feb55b67000)\n        librt.so.1 => /lib64/librt.so.1 (0x00007feb5595f000)\n        /lib64/ld-linux-x86-64.so.2 (0x00007feb5a1af000)\n        libdl.so.2 => /lib64/libdl.so.2 (0x00007feb5575a000)\n        libogg.so.0 => /usr/lib64/libogg.so.0 (0x00007feb55554000)\n\n```\n\n```\n$ ffmpeg -version\nffmpeg version git-2016-05-14-d680ab1 Copyright (c) 2000-2016 the FFmpeg developers\nbuilt with gcc 4.4.7 (GCC) 20120313 (Red Hat 4.4.7-16)\nconfiguration: --arch=x86_64 --enable-gpl --enable-libmp3lame --enable-libtheora --enable-libx264 --enable-libxvid --enable-nonfree --enable-openal --enable-pic --enable-shared --enable-version3 --enable-zlib --extra-ldexeflags=-pie --enable-pthreads\nlibavutil      55. 24.100 / 55. 24.100\nlibavcodec     57. 41.102 / 57. 41.102\nlibavformat    57. 36.100 / 57. 36.100\nlibavdevice    57.  0.101 / 57.  0.101\nlibavfilter     6. 45.100 /  6. 45.100\nlibswscale      4.  1.100 /  4.  1.100\nlibswresample   2.  0.101 /  2.  0.101\nlibpostproc    54.  0.100 / 54.  0.100\n```\n\nDecode\u3068Encode\u306e\u5bfe\u5fdc\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u4e00\u89a7\u306f\u4e0b\u8a18\u30b3\u30de\u30f3\u30c9\u3067\u898b\u308b\u3002\u3082\u3057\u304a\u671b\u307f\u306e\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u304c\u306a\u3051\u308c\u3070\u3001\u30e9\u30a4\u30d6\u30e9\u30ea\u3068\u30aa\u30d7\u30b7\u30e7\u30f3\u30d5\u30e9\u30b0\u3092\u78ba\u8a8d\u3057\u3066\u3001\u30b3\u30f3\u30d1\u30a4\u30eb\u3057\u76f4\u3057\u3066\u4e0b\u3055\u3044\u2026\u3002\n\n```\n$ ffmpeg -formats\n```\n\n\n# OpenCV3\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n\u3084\u3063\u3068\u3053\u3053\u307e\u3067\u6765\u307e\u3057\u305f\u3002\u3057\u304b\u3057\u3001\u3053\u3053\u3067OpenCV3\u306e\u30d3\u30eb\u30c9\u30a8\u30e9\u30fc\u306b\u5fc3\u304c\u6298\u3089\u308c\u308b\u4eba\u304c\u591a\u6570\u5b58\u5728\u3059\u308b\u3088\u3046\u3067\u3059\u3002\u30b4\u30fc\u30eb\u306f\u76ee\u524d\u3001\u9811\u5f35\u308a\u307e\u3059\u3002\n\n## yum\u3067\u5fc5\u8981\u306a\u30e9\u30a4\u30d6\u30e9\u30ea\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\n\nyum\u3067opencv2\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u3066\u30a2\u30f3\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\u3053\u3068\u306b\u3088\u3063\u3066opencv3\u3067\u3082\u5fc5\u8981\u305d\u3046\u306a\u4f9d\u5b58\u30e9\u30a4\u30d6\u30e9\u30ea\u304c\u30b5\u30af\u30c3\u3068\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3067\u304d\u307e\u3059\u3002\u305d\u306e\u4ed6\u3001\u5fc5\u8981\u306a\u3082\u306e\u3082\u3059\u3079\u3066yum\u3067\u5165\u308c\u3066\u3057\u307e\u3044\u307e\u3059\u3002\n\n```\n$ sudo sh -c \"yum install -y opencv && yum remove -y opencv\"\n$ sudo yum install -y cmake libjpeg-devel libtiff-devel libpng-devel jasper-devel \n```\n\n## pip\u3067numpy\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\n\n```\n$ sudo pip install --upgrade pip\n$ sudo pip install numpy\n```\n\n## OpenCV3\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\nOpenCV3.1.0\u3068\u5fc5\u8981\u306amodule\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3057\u307e\u3059\u3002git\u304b\u3089clone\u3057\u3066\u3082\u3044\u3044\u304b\u3082\u3057\u308c\u306a\u3044\u3093\u3067\u3059\u304c\u3001\u6642\u9593\u304c\u304b\u304b\u308a\u305d\u3046\u306a\u3093\u3067\u666e\u901a\u306bzip\u3092\u843d\u3068\u3057\u3066\u89e3\u51cd\u3057\u307e\u3057\u305f\u3002\n```\n$ cd /usr/local/src\n$ sudo wget https://github.com/Itseez/opencv/archive/3.1.0.zip\n$ sudo wget https://github.com/Itseez/opencv_contrib/archive/3.1.0.zip\n$ sudo unzip 3.1.0.zip\\*\n$ cd opencv-3.1.0\n$ sudo mkdir build\n$ cd build\n```\n\ncmake\u306e\u30aa\u30d7\u30b7\u30e7\u30f3\u306f\u74b0\u5883\u306b\u5408\u308f\u305b\u3066\u9069\u6642\u4fee\u6574\u3057\u3066\u304f\u3060\u3055\u3044\u3002PYTHON2\u3068\u304b\u306e\u30aa\u30d7\u30b7\u30e7\u30f3\u306f\u4eca\u56de\u306f\u3042\u3093\u307e\u308a\u8a66\u3057\u3066\u3044\u306a\u3044\u3067\u3059\u3002\n\n```\n$ sudo cmake -D CMAKE_BUILD_TYPE=RELEASE \\\n-D CMAKE_INSTALL_PREFIX=/usr/local \\\n-D BUILD_opencv_python3=ON \\\n-D INSTALL_PYTHON_EXAMPLES=ON \\\n-D PYTHON_EXECUTABLE=$(which python) \\\n-D PYTHON3_EXECUTABLE=$(which python) \\\n-D PYTHON3_LIBRARY=/usr/local/src/pyenv/versions/3.5.1/lib/libpython3.5m.so \\\n-D PYTHON3_INCLUDE_DIR=/usr/local/src/pyenv/versions/3.5.1/include/python3.5m \\\n-D PYTHON3_PACKAGES_PATH=/usr/local/src/pyenv/versions/3.5.1/lib/python3.5/site-packages \\\n-D OPENCV_EXTRA_MODULES_PATH=/usr/local/src/opencv_contrib-3.1.0/modules ..\n```\n\n\u305d\u3057\u3066make\uff01\n\n```\n$ sudo make -j8 #\u30b3\u30a2\u6570\u306b\u5fdc\u3058\u3066\n```\n\n\u3059\u308b\u3068\u3001\u304b\u306a\u308a\u306e\u9ad8\u78ba\u7387\u3067\u3053\u3044\u3064\u304c\u51fa\u3066\u304d\u307e\u3059\u3002\n\n```shell-session\n/usr/bin/ld: /usr/local/include/../lib/libswscale.a(swscale.o): relocation R_X86_64_PC32 against symbol `ff_M24A' can not be used when making a shared object; recompile with -fPIC\n/usr/bin/ld: final link failed: Bad value\n```\n\n\u3053\u3046\u306a\u3063\u305f\u5834\u5408\u306f\u3001root\u306b\u306a\u3063\u3066cmake\u3057\u306a\u304a\u3059\u3068\u901a\u308b\u3053\u3068\u304c\u591a\u3044\u3067\u3059\u3002\n\n```\n$ su # or sudo su\n# cd /usr/local/src/opencv-3.1.0/build\n# cmake ..\n# make -j8\n# make install\n```\n\n\u6700\u5f8c\u306b\u78ba\u8a8d\u3067\u3059\u3002\n\n```shell-session\n$ python\nPython 3.5.1 (default, May 14 2016, 16:55:55) \n[GCC 4.4.7 20120313 (Red Hat 4.4.7-16)] on linux\nType \"help\", \"copyright\", \"credits\" or \"license\" for more information.\n>>> import cv2\n>>> cv2.__version__\n'3.1.0'\n>>> \n```\n\n\u4ee5\u4e0a\u3067\u3059\uff01\n", "tags": ["CentOS6.x", "python3", "OpenCV3", "ffmpeg"]}