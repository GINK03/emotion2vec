{"context": " More than 1 year has passed since last update.\u4eca\u66f4\u306a\u304c\u3089\u3001\u3053\u306e\u8a18\u4e8b\u306e\u901a\u308a\u306b\u3001Robolectric \u306b\u5bfe\u5fdc\u3057\u305f\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092\u4f5c\u308b\u624b\u9806\u3092\u307e\u3068\u3081\u3066\u304a\u304d\u307e\u3059\u3002\n\nRobolectric \u306e\u5f79\u5272\nAndroid \u306f\u3001\u6a19\u6e96\u306e\u30d5\u30ec\u30fc\u30e0\u30ef\u30fc\u30af\u306b\u30c6\u30b9\u30c8\u30d5\u30ec\u30fc\u30e0\u30ef\u30fc\u30af\u3082\u542b\u3093\u3067\u3044\u307e\u3059\u3002\nJUnit3 \u3092\u30d9\u30fc\u30b9\u3068\u3057\u3066\u3001\u30e2\u30b8\u30e5\u30fc\u30eb\u306e\u30c6\u30b9\u30c8\u3084\u753b\u9762\u306e\u30c6\u30b9\u30c8\u306e\u70ba\u306e\u30d5\u30ec\u30fc\u30e0\u30ef\u30fc\u30af\u304c\u63d0\u4f9b\u3055\u308c\u3066\u3044\u307e\u3059\u3002\n\u4e00\u65b9\u3001\u5b9f\u884c\u74b0\u5883\u306e\u5236\u7d04\u304b\u3089\u3001Android \u30a8\u30df\u30e5\u30ec\u30fc\u30bf\u3084\u7aef\u672b\u4e0a\u3067\u306e\u5b9f\u884c\u304c\u8981\u6c42\u3055\u308c\u307e\u3059\u3002\u30c6\u30b9\u30c8\u306e\u5b9f\u884c\u306e\u305f\u3081\u306b\u30a8\u30df\u30e5\u30ec\u30fc\u30bf\u3092\u7acb\u3061\u4e0a\u3052\u305f\u308a\u3001\u30c6\u30b9\u30c8\u306e apk \u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u305f\u308a\u3059\u308b\u5fc5\u8981\u304c\u6709\u308b\u305f\u3081\u3001\u30c6\u30b9\u30c8\u305d\u306e\u3082\u306e\u306e\u5b9f\u884c\u306b\u624b\u9593\u3068\u6642\u9593\u304c\u304b\u304b\u3063\u3066\u3057\u307e\u3044\u307e\u3059\u3002\nRobolectric \u3067\u306f\u3001Android \u306e\u30d5\u30ec\u30fc\u30e0\u30ef\u30fc\u30af\u306b\u3042\u308b\u5404\u7a2e\u306e API \u3092 JVM \u4e0a\u3067\u30a8\u30df\u30e5\u30ec\u30fc\u30c8\u3059\u308b\u3053\u3068\u306b\u3088\u308a\u3001\u30c6\u30b9\u30c8\u306e\u5b9f\u884c\u6642\u9593\u3092\u77ed\u304f\u30b9\u30d4\u30fc\u30c7\u30a3\u306b\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n\u624b\u9806\u306e\u6982\u8981\n\nbuild.gradle \u306e\u8a2d\u5b9a\u3067\u30c6\u30b9\u30c8\u306e\u6e96\u5099\u3092\u3059\u308b\nTestRunner \u3092\u62e1\u5f35\u3057\u3066\u3001AndroidManifest \u3092\u898b\u3048\u308b\u3088\u3046\u306b\u3059\u308b\n\u30c6\u30b9\u30c8\u3092\u66f8\u304f\n\n\nbuild.gradle \u306e\u6e96\u5099\n\u30d3\u30eb\u30c9\u30b9\u30af\u30ea\u30d7\u30c8\u306b\u8a18\u8ff0\u3059\u308b\u5185\u5bb9\u306f\u4ee5\u4e0b\u306e\u901a\u308a\u3067\u3059\u3002\n\nandroid-test \u30d7\u30e9\u30b0\u30a4\u30f3\u306e\u5c0e\u5165\nrobolectric \u30d7\u30e9\u30b0\u30a4\u30f3\u306e\u5c0e\u5165\nJUnit4, Robolectric, Android-FEST \u3078\u306e\u4f9d\u5b58\u306e\u5ba3\u8a00\n\u30c6\u30b9\u30c8\u7528\u306e\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306e\u5909\u66f4\n\n\u73fe\u5728\u3001Robolectric \u306f KitKat \u306b\u5bfe\u5fdc\u3057\u3066\u3044\u306a\u3044\u305f\u3081\u3001TargetSDK \u3068 CompileWith \u306e API Level \u3092 18 \u306b\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n\u3053\u306e\u8a2d\u5b9a\u306f@Config\u30a2\u30ce\u30c6\u30fc\u30b7\u30e7\u30f3\u3092\u7528\u3044\u3066\u30c6\u30b9\u30c8\u30b3\u30fc\u30c9\u4e2d\u3067\u8a2d\u5b9a\u3067\u304d\u307e\u3059\u3002\n2015/03/10 \u8ffd\u8a18\uff1a\u4ee5\u4e0b\u306e\u30b9\u30af\u30ea\u30d7\u30c8\u306f\u3059\u3067\u306b\u53e4\u304f\u3001\u52d5\u4f5c\u3059\u308b\u4fdd\u8a3c\u304c\u3042\u308a\u307e\u305b\u3093\u3002\u73fe\u6642\u70b9\u3067\u6700\u65b0\u306e\u8a18\u8ff0\u306f\u3053\u306e\u4e0b\u306b\u3042\u308a\u307e\u3059\u3002\nbuildscript {\n    // \u30d3\u30eb\u30c9\u30b9\u30af\u30ea\u30d7\u30c8\u306e\u4f9d\u5b58\n    repositories {\n        mavenCentral()\n        maven { url 'https://oss.sonatype.org/content/repositories/snapshots/' }\n    }\n    dependencies {\n        classpath 'com.android.tools.build:gradle:0.8.+'\n        classpath 'com.squareup.gradle:gradle-android-test-plugin:0.9.1-SNAPSHOT'\n    }\n}\n\nrepositories {\n    mavenCentral()\n    maven { url 'https://oss.sonatype.org/content/repositories/snapshots/' }\n}\n\napply plugin: 'android'\napply plugin: 'android-test'\n\nandroid {\n    compileSdkVersion 18\n    buildToolsVersion \"19.0.1\"\n\n    defaultConfig {\n        minSdkVersion 7\n        targetSdkVersion 18\n        versionCode 1\n        versionName \"1.0\"\n    }\n\n    sourceSets {\n        instrumentTest.setRoot('src/test')  // \u30c6\u30b9\u30c8\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092 test \u306b\u5909\u66f4\u3059\u308b\n    }\n}\n\ndependencies {\n    compile 'com.android.support:gridlayout-v7:19.0.1'\n    compile 'com.android.support:support-v4:19.0.1'\n    compile 'com.android.support:appcompat-v7:19.0.1'\n    testCompile 'junit:junit:4.11' // JUnit 4\n    testCompile 'org.robolectric:robolectric:2.3-SNAPSHOT'  // Robolectric \u672c\u4f53\n    testCompile 'com.squareup:fest-android:1.0.+' // FEST(Fixtures for Easy Software Testing) \u3092 Android \u3067\u5229\u7528\u3059\u308b\u305f\u3081\u306e\u30e9\u30a4\u30d6\u30e9\u30ea\n    instrumentTestCompile 'junit:junit:4.11'\n    instrumentTestCompile 'org.robolectric:robolectric:2.3-SNAPSHOT'\n    instrumentTestCompile 'com.squareup:fest-android:1.0.+'\n}\n\n2015/03/10 \u8ffd\u8a18\uff1a\u3053\u3061\u3089\u304c\u6700\u65b0\nbuildscript {\n    // \u30d3\u30eb\u30c9\u30b9\u30af\u30ea\u30d7\u30c8\u306e\u4f9d\u5b58\n    repositories {\n        jcenter()\n    }\n    dependencies {\n        classpath 'com.android.tools.build:gradle:1.1.0'\n        classpath 'org.robolectric:robolectric-gradle-plugin:1.0.1'\n    }\n}\n\nrepositories {\n    jcenter()\n}\n\napply plugin: 'com.android.application'\napply plugin: 'org.robolectric' // \u5c11\u3057\u524d\u307e\u3067 robolectric \u3067\u3057\u305f\u304c\u3001\u6b63\u5f0f\u30ea\u30ea\u30fc\u30b9\u4ee5\u5f8c org.robolectric \u3068\u306a\u308a\u307e\u3059\n\nandroid {\n    compileSdkVersion 21\n    buildToolsVersion \"21.1.2\"\n\n    defaultConfig {\n        minSdkVersion 7\n        targetSdkVersion 21\n        versionCode 1\n        versionName \"1.0\"\n    }\n    // robolectric \u306e\u30c6\u30b9\u30c8\u306f androidTest \u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u653e\u308a\u8fbc\u3080\u306e\u3067 sourceSet \u306b\u3064\u3044\u3066\u7279\u306b\u8a18\u8ff0\u306a\u3057\n}\n\ndependencies {\n    compile 'com.android.support:gridlayout-v7:19.0.1'\n    compile 'com.android.support:support-v4:19.0.1'\n    compile 'com.android.support:appcompat-v7:19.0.1'\n    // \u4ee5\u4e0b\u3001\u69d8\u3005\u306a transitive dependencies \u3092 exclude \u3057\u307e\u3059\n    androidTestCompile('junit:junit:4.11') { // JUnit4\n        exclude module: 'hamcrest-core'\n    }\n    androidTestCompile('org.robolectric:robolectric:2.4') { // Robolectric \u672c\u4f53\n        exclude module: 'classworlds'\n        exclude module: 'commons-logging'\n        exclude module: 'httpclient'\n        exclude module: 'maven-artifact'\n        exclude module: 'maven-artifact-manager'\n        exclude module: 'maven-error-diagnostics'\n        exclude module: 'maven-model'\n        exclude module: 'maven-plugin-registry'\n        exclude module: 'maven-profile'\n        exclude module: 'maven-project'\n        exclude module: 'maven-settings'\n        exclude module: 'nekohtml'\n        exclude module: 'plexus-container-default'\n        exclude module: 'plexus-interpolation'\n        exclude module: 'plexus-utils'\n        exclude module: 'wagon-file'\n        exclude module: 'wagon-http-lightweight'\n        exclude module: 'wagon-http-shared'\n        exclude module: 'wagon-provider-api'\n        exclude group: 'com.android.support', module: 'support-v4'\n    }\n    androidTestCompile 'org.mockito:mockito-all:1.9.5'\n    androidTestCompile 'com.squareup:fest-android:1.0.+' // FEST(Fixtures for Easy Software Testing) \u3092 Android \u3067\u5229\u7528\u3059\u308b\u305f\u3081\u306e\u30e9\u30a4\u30d6\u30e9\u30ea\n}\n\n\nTestRunner \u306e\u6e96\u5099\n\nsrc/test/java\u306b\u30c6\u30b9\u30c8\u3092\u914d\u7f6e\u3059\u308b\u95a2\u4fc2\u3067\u3001Robolectric \u304c AndroidManifest \u3092\u898b\u3064\u3051\u3089\u308c\u306a\u304f\u306a\u308b\u305f\u3081\u3001TestRunner \u3092\u62e1\u5f35\u3057\u3066\u5834\u6240\u3092\u6307\u5b9a\u3057\u307e\u3059\u3002\n2015/03/10 \u8ffd\u8a18\uff1a\u4ee5\u4e0b\u306e TestRunner \u306f\u5fc5\u8981\u7121\u304f\u306a\u308a\u307e\u3057\u305f\u3002org.robolectric.RobolectricTestRunner \u3092\u4f7f\u7528\u3057\u307e\u3059\u3002AndroidManifest \u306b\u3064\u3044\u3066\u306f\u3001@Config\u30a2\u30ce\u30c6\u30fc\u30b7\u30e7\u30f3\u3092\u7528\u3044\u307e\u3059\u3002\nimport org.junit.runners.model.InitializationError;\nimport org.robolectric.AndroidManifest;\nimport org.robolectric.RobolectricTestRunner;\nimport org.robolectric.annotation.Config;\nimport org.robolectric.res.Fs;\n\npublic class RobolectricGradleTestRunner extends RobolectricTestRunner {\n    public RobolectricGradleTestRunner(Class<?> testClass) throws InitializationError {\n        super(testClass);\n    }\n\n    @Override\n    protected AndroidManifest getAppManifest(Config config) {\n        String manifestProperty = System.getProperty(\"android.manifest\");\n        if (config.manifest().equals(Config.DEFAULT) && manifestProperty != null) {\n            String resProperty = System.getProperty(\"android.resources\");\n            String assetsProperty = System.getProperty(\"android.assets\");\n            return new AndroidManifest(Fs.fileFromPath(manifestProperty), Fs.fileFromPath(resProperty),\n                    Fs.fileFromPath(assetsProperty));\n        }\n        AndroidManifest appManifest = super.getAppManifest(config);\n        return appManifest;\n    }\n\n}\n\n\u4ee5\u4e0a\u3067\u3001\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306e\u6e96\u5099\u306f\u5b8c\u4e86\u3067\u3059\u3002\n\n\u30c6\u30b9\u30c8\u306e\u8a18\u8ff0\nAndroid \u30d5\u30ec\u30fc\u30e0\u30ef\u30fc\u30af\u304c\u63d0\u4f9b\u3059\u308b\u30c6\u30b9\u30c8\u30b9\u30fc\u30c8\u3068\u9055\u3044\u3001JUnit4 \u304c\u4f7f\u3048\u308b\u306e\u3067\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u30c6\u30b9\u30c8\u304c\u8a18\u8ff0\u3067\u304d\u307e\u3059\u3002\nimport org.junit.Test;\nimport org.junit.runner.RunWith;\nimport org.robolectric.RobolectricTestRunner;\nimport org.robolectric.annotation.Config;\n\nimport static org.junit.Assert.assertTrue;\n\n@RunWith(RobolectricTestRunner.class) // TestRunner \u306e\u6307\u5b9a\n@Config(manifest = \"src/main/AndroidManifest.xml\", emulateSdk = 18) // sdk \u306e api level \u3092\u6307\u5b9a\u3059\u308b\npublic class MyModuleTest {\n    @Test // \u30c6\u30b9\u30c8\u30b1\u30fc\u30b9\u306e\u8868\u660e\n    public void shouldPass() throws Exception {\n        assertTrue(true);\n    }\n}\n\n\u30c6\u30b9\u30c8\u306e\u5b9f\u884c\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u3057\u307e\u3059\u3002\n$ ./gradlew test\n\u3053\u308c\u3067\u3001\u30a8\u30df\u30e5\u30ec\u30fc\u30bf\u7121\u3057\u306b\u30c6\u30b9\u30c8\u304c\u5b9f\u884c\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3057\u305f\u3002\n\u4eca\u66f4\u306a\u304c\u3089\u3001[\u3053\u306e\u8a18\u4e8b](http://www.peterfriese.de/android-testing-with-robolectric/)\u306e\u901a\u308a\u306b\u3001Robolectric \u306b\u5bfe\u5fdc\u3057\u305f\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092\u4f5c\u308b\u624b\u9806\u3092\u307e\u3068\u3081\u3066\u304a\u304d\u307e\u3059\u3002\n\n## Robolectric \u306e\u5f79\u5272\n\nAndroid \u306f\u3001\u6a19\u6e96\u306e\u30d5\u30ec\u30fc\u30e0\u30ef\u30fc\u30af\u306b\u30c6\u30b9\u30c8\u30d5\u30ec\u30fc\u30e0\u30ef\u30fc\u30af\u3082\u542b\u3093\u3067\u3044\u307e\u3059\u3002\nJUnit3 \u3092\u30d9\u30fc\u30b9\u3068\u3057\u3066\u3001\u30e2\u30b8\u30e5\u30fc\u30eb\u306e\u30c6\u30b9\u30c8\u3084\u753b\u9762\u306e\u30c6\u30b9\u30c8\u306e\u70ba\u306e\u30d5\u30ec\u30fc\u30e0\u30ef\u30fc\u30af\u304c\u63d0\u4f9b\u3055\u308c\u3066\u3044\u307e\u3059\u3002\n\n\u4e00\u65b9\u3001\u5b9f\u884c\u74b0\u5883\u306e\u5236\u7d04\u304b\u3089\u3001Android \u30a8\u30df\u30e5\u30ec\u30fc\u30bf\u3084\u7aef\u672b\u4e0a\u3067\u306e\u5b9f\u884c\u304c\u8981\u6c42\u3055\u308c\u307e\u3059\u3002\u30c6\u30b9\u30c8\u306e\u5b9f\u884c\u306e\u305f\u3081\u306b\u30a8\u30df\u30e5\u30ec\u30fc\u30bf\u3092\u7acb\u3061\u4e0a\u3052\u305f\u308a\u3001\u30c6\u30b9\u30c8\u306e apk \u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u305f\u308a\u3059\u308b\u5fc5\u8981\u304c\u6709\u308b\u305f\u3081\u3001\u30c6\u30b9\u30c8\u305d\u306e\u3082\u306e\u306e\u5b9f\u884c\u306b\u624b\u9593\u3068\u6642\u9593\u304c\u304b\u304b\u3063\u3066\u3057\u307e\u3044\u307e\u3059\u3002\n\nRobolectric \u3067\u306f\u3001Android \u306e\u30d5\u30ec\u30fc\u30e0\u30ef\u30fc\u30af\u306b\u3042\u308b\u5404\u7a2e\u306e API \u3092 JVM \u4e0a\u3067\u30a8\u30df\u30e5\u30ec\u30fc\u30c8\u3059\u308b\u3053\u3068\u306b\u3088\u308a\u3001\u30c6\u30b9\u30c8\u306e\u5b9f\u884c\u6642\u9593\u3092\u77ed\u304f\u30b9\u30d4\u30fc\u30c7\u30a3\u306b\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n## \u624b\u9806\u306e\u6982\u8981\n\n1. build.gradle \u306e\u8a2d\u5b9a\u3067\u30c6\u30b9\u30c8\u306e\u6e96\u5099\u3092\u3059\u308b\n2. ~~TestRunner \u3092\u62e1\u5f35\u3057\u3066\u3001AndroidManifest \u3092\u898b\u3048\u308b\u3088\u3046\u306b\u3059\u308b~~\n3. \u30c6\u30b9\u30c8\u3092\u66f8\u304f\n\n## build.gradle \u306e\u6e96\u5099\n\n\u30d3\u30eb\u30c9\u30b9\u30af\u30ea\u30d7\u30c8\u306b\u8a18\u8ff0\u3059\u308b\u5185\u5bb9\u306f\u4ee5\u4e0b\u306e\u901a\u308a\u3067\u3059\u3002\n\n1. ~~android-test \u30d7\u30e9\u30b0\u30a4\u30f3\u306e\u5c0e\u5165~~\n2. robolectric \u30d7\u30e9\u30b0\u30a4\u30f3\u306e\u5c0e\u5165\n2. JUnit4, Robolectric, Android-FEST \u3078\u306e\u4f9d\u5b58\u306e\u5ba3\u8a00\n3. ~~\u30c6\u30b9\u30c8\u7528\u306e\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306e\u5909\u66f4~~\n\n~~\u73fe\u5728\u3001Robolectric \u306f KitKat \u306b\u5bfe\u5fdc\u3057\u3066\u3044\u306a\u3044\u305f\u3081\u3001TargetSDK \u3068 CompileWith \u306e API Level \u3092 18 \u306b\u3057\u3066\u304a\u304d\u307e\u3059\u3002~~\n\u3053\u306e\u8a2d\u5b9a\u306f`@Config`\u30a2\u30ce\u30c6\u30fc\u30b7\u30e7\u30f3\u3092\u7528\u3044\u3066\u30c6\u30b9\u30c8\u30b3\u30fc\u30c9\u4e2d\u3067\u8a2d\u5b9a\u3067\u304d\u307e\u3059\u3002\n\n**2015/03/10 \u8ffd\u8a18\uff1a\u4ee5\u4e0b\u306e\u30b9\u30af\u30ea\u30d7\u30c8\u306f\u3059\u3067\u306b\u53e4\u304f\u3001\u52d5\u4f5c\u3059\u308b\u4fdd\u8a3c\u304c\u3042\u308a\u307e\u305b\u3093\u3002\u73fe\u6642\u70b9\u3067\u6700\u65b0\u306e\u8a18\u8ff0\u306f\u3053\u306e\u4e0b\u306b\u3042\u308a\u307e\u3059\u3002**\n\n```groovy\nbuildscript {\n    // \u30d3\u30eb\u30c9\u30b9\u30af\u30ea\u30d7\u30c8\u306e\u4f9d\u5b58\n    repositories {\n        mavenCentral()\n        maven { url 'https://oss.sonatype.org/content/repositories/snapshots/' }\n    }\n    dependencies {\n        classpath 'com.android.tools.build:gradle:0.8.+'\n        classpath 'com.squareup.gradle:gradle-android-test-plugin:0.9.1-SNAPSHOT'\n    }\n}\n\nrepositories {\n    mavenCentral()\n    maven { url 'https://oss.sonatype.org/content/repositories/snapshots/' }\n}\n\napply plugin: 'android'\napply plugin: 'android-test'\n\nandroid {\n    compileSdkVersion 18\n    buildToolsVersion \"19.0.1\"\n\n    defaultConfig {\n        minSdkVersion 7\n        targetSdkVersion 18\n        versionCode 1\n        versionName \"1.0\"\n    }\n\n    sourceSets {\n        instrumentTest.setRoot('src/test')  // \u30c6\u30b9\u30c8\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092 test \u306b\u5909\u66f4\u3059\u308b\n    }\n}\n\ndependencies {\n    compile 'com.android.support:gridlayout-v7:19.0.1'\n    compile 'com.android.support:support-v4:19.0.1'\n    compile 'com.android.support:appcompat-v7:19.0.1'\n    testCompile 'junit:junit:4.11' // JUnit 4\n    testCompile 'org.robolectric:robolectric:2.3-SNAPSHOT'  // Robolectric \u672c\u4f53\n    testCompile 'com.squareup:fest-android:1.0.+' // FEST(Fixtures for Easy Software Testing) \u3092 Android \u3067\u5229\u7528\u3059\u308b\u305f\u3081\u306e\u30e9\u30a4\u30d6\u30e9\u30ea\n    instrumentTestCompile 'junit:junit:4.11'\n    instrumentTestCompile 'org.robolectric:robolectric:2.3-SNAPSHOT'\n    instrumentTestCompile 'com.squareup:fest-android:1.0.+'\n}\n```\n\n**2015/03/10 \u8ffd\u8a18\uff1a\u3053\u3061\u3089\u304c\u6700\u65b0**\n\n```groovy\nbuildscript {\n    // \u30d3\u30eb\u30c9\u30b9\u30af\u30ea\u30d7\u30c8\u306e\u4f9d\u5b58\n    repositories {\n        jcenter()\n    }\n    dependencies {\n        classpath 'com.android.tools.build:gradle:1.1.0'\n        classpath 'org.robolectric:robolectric-gradle-plugin:1.0.1'\n    }\n}\n\nrepositories {\n    jcenter()\n}\n\napply plugin: 'com.android.application'\napply plugin: 'org.robolectric' // \u5c11\u3057\u524d\u307e\u3067 robolectric \u3067\u3057\u305f\u304c\u3001\u6b63\u5f0f\u30ea\u30ea\u30fc\u30b9\u4ee5\u5f8c org.robolectric \u3068\u306a\u308a\u307e\u3059\n\nandroid {\n    compileSdkVersion 21\n    buildToolsVersion \"21.1.2\"\n\n    defaultConfig {\n        minSdkVersion 7\n        targetSdkVersion 21\n        versionCode 1\n        versionName \"1.0\"\n    }\n    // robolectric \u306e\u30c6\u30b9\u30c8\u306f androidTest \u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u653e\u308a\u8fbc\u3080\u306e\u3067 sourceSet \u306b\u3064\u3044\u3066\u7279\u306b\u8a18\u8ff0\u306a\u3057\n}\n\ndependencies {\n    compile 'com.android.support:gridlayout-v7:19.0.1'\n    compile 'com.android.support:support-v4:19.0.1'\n    compile 'com.android.support:appcompat-v7:19.0.1'\n    // \u4ee5\u4e0b\u3001\u69d8\u3005\u306a transitive dependencies \u3092 exclude \u3057\u307e\u3059\n    androidTestCompile('junit:junit:4.11') { // JUnit4\n        exclude module: 'hamcrest-core'\n    }\n    androidTestCompile('org.robolectric:robolectric:2.4') { // Robolectric \u672c\u4f53\n        exclude module: 'classworlds'\n        exclude module: 'commons-logging'\n        exclude module: 'httpclient'\n        exclude module: 'maven-artifact'\n        exclude module: 'maven-artifact-manager'\n        exclude module: 'maven-error-diagnostics'\n        exclude module: 'maven-model'\n        exclude module: 'maven-plugin-registry'\n        exclude module: 'maven-profile'\n        exclude module: 'maven-project'\n        exclude module: 'maven-settings'\n        exclude module: 'nekohtml'\n        exclude module: 'plexus-container-default'\n        exclude module: 'plexus-interpolation'\n        exclude module: 'plexus-utils'\n        exclude module: 'wagon-file'\n        exclude module: 'wagon-http-lightweight'\n        exclude module: 'wagon-http-shared'\n        exclude module: 'wagon-provider-api'\n        exclude group: 'com.android.support', module: 'support-v4'\n    }\n    androidTestCompile 'org.mockito:mockito-all:1.9.5'\n    androidTestCompile 'com.squareup:fest-android:1.0.+' // FEST(Fixtures for Easy Software Testing) \u3092 Android \u3067\u5229\u7528\u3059\u308b\u305f\u3081\u306e\u30e9\u30a4\u30d6\u30e9\u30ea\n}\n```\n\n## ~~TestRunner \u306e\u6e96\u5099~~\n\n~~`src/test/java`\u306b\u30c6\u30b9\u30c8\u3092\u914d\u7f6e\u3059\u308b\u95a2\u4fc2\u3067\u3001Robolectric \u304c AndroidManifest \u3092\u898b\u3064\u3051\u3089\u308c\u306a\u304f\u306a\u308b\u305f\u3081\u3001TestRunner \u3092\u62e1\u5f35\u3057\u3066\u5834\u6240\u3092\u6307\u5b9a\u3057\u307e\u3059\u3002~~\n\n**2015/03/10 \u8ffd\u8a18\uff1a\u4ee5\u4e0b\u306e TestRunner \u306f\u5fc5\u8981\u7121\u304f\u306a\u308a\u307e\u3057\u305f\u3002org.robolectric.RobolectricTestRunner \u3092\u4f7f\u7528\u3057\u307e\u3059\u3002AndroidManifest \u306b\u3064\u3044\u3066\u306f\u3001`@Config`\u30a2\u30ce\u30c6\u30fc\u30b7\u30e7\u30f3\u3092\u7528\u3044\u307e\u3059\u3002**\n\n```java\nimport org.junit.runners.model.InitializationError;\nimport org.robolectric.AndroidManifest;\nimport org.robolectric.RobolectricTestRunner;\nimport org.robolectric.annotation.Config;\nimport org.robolectric.res.Fs;\n\npublic class RobolectricGradleTestRunner extends RobolectricTestRunner {\n    public RobolectricGradleTestRunner(Class<?> testClass) throws InitializationError {\n        super(testClass);\n    }\n\n    @Override\n    protected AndroidManifest getAppManifest(Config config) {\n        String manifestProperty = System.getProperty(\"android.manifest\");\n        if (config.manifest().equals(Config.DEFAULT) && manifestProperty != null) {\n            String resProperty = System.getProperty(\"android.resources\");\n            String assetsProperty = System.getProperty(\"android.assets\");\n            return new AndroidManifest(Fs.fileFromPath(manifestProperty), Fs.fileFromPath(resProperty),\n                    Fs.fileFromPath(assetsProperty));\n        }\n        AndroidManifest appManifest = super.getAppManifest(config);\n        return appManifest;\n    }\n\n}\n```\n\n\u4ee5\u4e0a\u3067\u3001\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306e\u6e96\u5099\u306f\u5b8c\u4e86\u3067\u3059\u3002\n\n## \u30c6\u30b9\u30c8\u306e\u8a18\u8ff0\n\nAndroid \u30d5\u30ec\u30fc\u30e0\u30ef\u30fc\u30af\u304c\u63d0\u4f9b\u3059\u308b\u30c6\u30b9\u30c8\u30b9\u30fc\u30c8\u3068\u9055\u3044\u3001JUnit4 \u304c\u4f7f\u3048\u308b\u306e\u3067\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u30c6\u30b9\u30c8\u304c\u8a18\u8ff0\u3067\u304d\u307e\u3059\u3002\n\n```java\nimport org.junit.Test;\nimport org.junit.runner.RunWith;\nimport org.robolectric.RobolectricTestRunner;\nimport org.robolectric.annotation.Config;\n\nimport static org.junit.Assert.assertTrue;\n\n@RunWith(RobolectricTestRunner.class) // TestRunner \u306e\u6307\u5b9a\n@Config(manifest = \"src/main/AndroidManifest.xml\", emulateSdk = 18) // sdk \u306e api level \u3092\u6307\u5b9a\u3059\u308b\npublic class MyModuleTest {\n    @Test // \u30c6\u30b9\u30c8\u30b1\u30fc\u30b9\u306e\u8868\u660e\n    public void shouldPass() throws Exception {\n        assertTrue(true);\n    }\n}\n```\n\n\u30c6\u30b9\u30c8\u306e\u5b9f\u884c\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u3057\u307e\u3059\u3002\n\n`$ ./gradlew test`\n\n\u3053\u308c\u3067\u3001\u30a8\u30df\u30e5\u30ec\u30fc\u30bf\u7121\u3057\u306b\u30c6\u30b9\u30c8\u304c\u5b9f\u884c\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3057\u305f\u3002\n", "tags": ["Android", "Java", "gradle", "Groovy", "\u30c6\u30b9\u30c8"]}