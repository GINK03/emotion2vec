{"context": " More than 1 year has passed since last update.\u5916\u304b\u3089API\u3092GET\u3057\u305f\u308a\u3001\u3042\u308b\u3044\u306fPOST\u3057\u305f\u308a\u3057\u3066\u6319\u52d5\u3092\u898b\u305f\u3044\u5834\u5408\u306b\u4f7f\u7528\u3059\u308bSkeleton\u3067\u3059\u3002\u57fa\u672c\u7684\u306b\u306fPOST\u306e\u305f\u3081\u306e\u95a2\u6570\u3068\u3001file_get_contents\u3092\u30e9\u30c3\u30d7\u3057\u305f\u5f62\u306e\u95a2\u6570\u3092\u8ffd\u52a0\u3057\u3066\u3042\u3052\u3066\u3044\u308b\u3060\u3051\u3067\u3059\u3002\n\nphpunit_api_skeleton.php\n<?php\nclass API_Test_Skeleton extends PHPUnit_Framework_TestCase\n{\n    private $test_domain = \"api-test.localhost\";\n    private $test_url = \"/path/to/test_api_root/\";\n\n    /*\n     * Post Helper\n     * Thanks \n     *      http://www.programming-magic.com/20080226023511/\n     * and  http://abbadabba.coolk2.com/212/\n     */\n\n    private function do_post_request($url,$value)\n    {\n        $headers = array('Content-Type: application/x-www-form-urlencoded','Content-Length:'.strlen(http_build_query($value)));\n\n        $options = array('http' => array(\n             'method' => 'POST'\n             ,'content' => http_build_query($value)\n             ,'header'  => implode(\"\\r\\n\",$headers)\n         ));\n         return file_get_contents($url,false,stream_context_create($options));\n    }\n\n    private function to_api_by_post($test_target,$value)\n    {\n        return $this->do_post_request(\"http://\" . $this->test_domain . $this->test_url . $test_target,$value);\n    }\n\n    private function to_api_by_get($test_target)\n    {\n        return file_get_contents(\"http://\" . $this->test_domain . $this->test_url . $test_target);\n    }\n\n    private function str($str)\n    {\n        return '\"' . $str . '\"';\n    }\n\n    public function test_unittest()\n    {\n        $res = $this->to_api_by_get('test');\n        $this->assertEquals($res,$this->str(\"It works\"));\n    }\n\n\n    public function test_post_test()\n    {\n\n        $res = $this->to_api_by_post('test',array(\"test\" => 'success'));\n        $json = json_decode($res);\n        $this->assertEquals($json->test,'success');\n    }\n\n}\n\n\n\u5916\u304b\u3089API\u3092GET\u3057\u305f\u308a\u3001\u3042\u308b\u3044\u306fPOST\u3057\u305f\u308a\u3057\u3066\u6319\u52d5\u3092\u898b\u305f\u3044\u5834\u5408\u306b\u4f7f\u7528\u3059\u308bSkeleton\u3067\u3059\u3002\u57fa\u672c\u7684\u306b\u306fPOST\u306e\u305f\u3081\u306e\u95a2\u6570\u3068\u3001file_get_contents\u3092\u30e9\u30c3\u30d7\u3057\u305f\u5f62\u306e\u95a2\u6570\u3092\u8ffd\u52a0\u3057\u3066\u3042\u3052\u3066\u3044\u308b\u3060\u3051\u3067\u3059\u3002\n\n```php:phpunit_api_skeleton.php\n<?php\nclass API_Test_Skeleton extends PHPUnit_Framework_TestCase\n{\n    private $test_domain = \"api-test.localhost\";\n    private $test_url = \"/path/to/test_api_root/\";\n\n    /*\n     * Post Helper\n     * Thanks \n     *      http://www.programming-magic.com/20080226023511/\n     * and  http://abbadabba.coolk2.com/212/\n     */\n\n    private function do_post_request($url,$value)\n    {\n        $headers = array('Content-Type: application/x-www-form-urlencoded','Content-Length:'.strlen(http_build_query($value)));\n        \n        $options = array('http' => array(\n             'method' => 'POST'\n             ,'content' => http_build_query($value)\n             ,'header'  => implode(\"\\r\\n\",$headers)\n         ));\n         return file_get_contents($url,false,stream_context_create($options));\n    }\n\n    private function to_api_by_post($test_target,$value)\n    {\n        return $this->do_post_request(\"http://\" . $this->test_domain . $this->test_url . $test_target,$value);\n    }\n\n    private function to_api_by_get($test_target)\n    {\n        return file_get_contents(\"http://\" . $this->test_domain . $this->test_url . $test_target);\n    }\n\n    private function str($str)\n    {\n        return '\"' . $str . '\"';\n    }\n\n    public function test_unittest()\n    {\n        $res = $this->to_api_by_get('test');\n        $this->assertEquals($res,$this->str(\"It works\"));\n    }\n\n\n    public function test_post_test()\n    {\n\n        $res = $this->to_api_by_post('test',array(\"test\" => 'success'));\n        $json = json_decode($res);\n        $this->assertEquals($json->test,'success');\n    }\n\n}\n```", "tags": ["PHP", "PHPUnit"]}