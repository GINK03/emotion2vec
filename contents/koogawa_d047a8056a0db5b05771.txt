{"context": " More than 1 year has passed since last update.\u3053\u306e\u8a18\u4e8b\u306f iOS Second Stage Advent Calendar 2013 \u7528\u306b\u30b9\u30c8\u30c3\u30af\u3057\u3066\u304a\u3044\u305f\u3082\u306e\u3067\u3059\u3002\u3059\u3079\u3066\u67a0\u304c\u57cb\u307e\u3063\u305f\u3088\u3046\u306a\u306e\u3067\u3001\u901a\u5e38\u8a18\u4e8b\u3068\u3057\u3066\u6295\u7a3f\u3057\u307e\u3059\u3002\n\niOS 7 \u3067\u8ffd\u52a0\u3055\u308c\u305f MKDirections \u304c\u9762\u767d\u305d\u3046\u3060\u3063\u305f\u306e\u3067\u3001\u8a66\u3057\u306b\u516d\u672c\u6728\u304b\u3089\u6e0b\u8c37\u3078\u306e\u30eb\u30fc\u30c8\u3092\u691c\u7d22\u3057\u3066\u307f\u307e\u3057\u305f\u3002\n\u307e\u305a\u306f\u3001\u51fa\u767a\u70b9\u3068\u5230\u7740\u70b9\u3092 CLLocationCoordinate2D \u3067\u4f5c\u6210\u3057\u307e\u3059\u3002\n// \u516d\u672c\u6728\nCLLocationCoordinate2D fromCoordinate = CLLocationCoordinate2DMake(35.665213, 139.730011);\n\n// \u6e0b\u8c37\nCLLocationCoordinate2D toCoordinate = CLLocationCoordinate2DMake(35.658987, 139.702776);\n\n\u3053\u3053\u3067\u4f5c\u6210\u3057\u305f CLLocationCoordinate2D \u3092\u30bb\u30c3\u30c8\u3057\u305f MKPlacemark \u3092\u751f\u6210\u3057\u307e\u3059\u3002\n// CLLocationCoordinate2D \u304b\u3089 MKPlacemark \u3092\u751f\u6210\nMKPlacemark *fromPlacemark = [[MKPlacemark alloc] initWithCoordinate:fromCoordinate\n                                                   addressDictionary:nil];\nMKPlacemark *toPlacemark   = [[MKPlacemark alloc] initWithCoordinate:toCoordinate\n                                                   addressDictionary:nil];\n\nMKPlacemark \u304b\u3089 MKMapItem \u3092\u751f\u6210\u3057\u307e\u3059\u3002\n// MKPlacemark \u304b\u3089 MKMapItem \u3092\u751f\u6210\nMKMapItem *fromItem = [[MKMapItem alloc] initWithPlacemark:fromPlacemark];\nMKMapItem *toItem   = [[MKMapItem alloc] initWithPlacemark:toPlacemark];\n\nMKMapItem \u3092\u30bb\u30c3\u30c8\u3057\u3066 MKDirectionsRequest \u3092\u751f\u6210\u3057\u307e\u3059\u3002\nrequestsAlternateRoutes \u306b YES \u3092\u8a2d\u5b9a\u3059\u308b\u3068\u3001\u8907\u6570\u306e\u30eb\u30fc\u30c8\u3092\u691c\u7d22\u3067\u304d\u308b\u3088\u3046\u3067\u3059\u3002\n// MKMapItem \u3092\u30bb\u30c3\u30c8\u3057\u3066 MKDirectionsRequest \u3092\u751f\u6210\nMKDirectionsRequest *request = [[MKDirectionsRequest alloc] init];\nrequest.source = fromItem;\nrequest.destination = toItem;\nrequest.requestsAlternateRoutes = YES;\n\nMKDirectionsRequest \u304b\u3089 MKDirections \u3092\u751f\u6210\u3057\u307e\u3059\u3002\n// MKDirectionsRequest \u304b\u3089 MKDirections \u3092\u751f\u6210\nMKDirections *directions = [[MKDirections alloc] initWithRequest:request];\n\n\u3053\u3053\u3067\u3088\u3046\u3084\u304f\u7d4c\u8def\u691c\u7d22\u3092\u5b9f\u884c\u3067\u304d\u307e\u3059\u3002\n// \u7d4c\u8def\u691c\u7d22\u3092\u5b9f\u884c\n[directions calculateDirectionsWithCompletionHandler:^(MKDirectionsResponse *response, NSError *error)\n {\n     if (error) return;\n\n     if ([response.routes count] > 0)\n     {\n         MKRoute *route = [response.routes objectAtIndex:0];\n         NSLog(@\"distance: %.2f meter\", route.distance);\n\n         // \u5730\u56f3\u4e0a\u306b\u30eb\u30fc\u30c8\u3092\u63cf\u753b\n         [self.mapView addOverlay:route.polyline];\n     }\n }];\n\n\u30eb\u30fc\u30c8\u60c5\u5831\u306f MKRoute \u30af\u30e9\u30b9\u3067\u8fd4\u3063\u3066\u304f\u308b\u3088\u3046\u3067\u3059\u3002\u3053\u306e\u30af\u30e9\u30b9\u306b\u306f\u7d4c\u8def\u60c5\u5831\u306e\u4ed6\u3001\u79fb\u52d5\u306b\u304b\u304b\u308b\u4e88\u6e2c\u6642\u9593\u3084\u8ddd\u96e2\u306a\u3069\u3082\u542b\u307e\u308c\u308b\u3088\u3046\u3067\u3059\u3002\n\u6700\u5f8c\u306b\u3001\u5730\u56f3\u4e0a\u306b\u8868\u793a\u3055\u308c\u308b\u30eb\u30fc\u30c8\u306e\u8272\u3084\u7dda\u306e\u592a\u3055\u306a\u3069\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n// \u5730\u56f3\u4e0a\u306b\u63cf\u753b\u3059\u308b\u30eb\u30fc\u30c8\u306e\u8272\u306a\u3069\u3092\u6307\u5b9a\uff08\u3053\u308c\u3092\u5b9f\u88c5\u3057\u306a\u3044\u3068\u4f55\u3082\u8868\u793a\u3055\u308c\u306a\u3044\uff09\n- (MKOverlayRenderer *)mapView:(MKMapView *)mapView\n            rendererForOverlay:(id<MKOverlay>)overlay\n{\n    if ([overlay isKindOfClass:[MKPolyline class]])\n    {\n        MKPolyline *route = overlay;\n        MKPolylineRenderer *routeRenderer = [[MKPolylineRenderer alloc] initWithPolyline:route];\n        routeRenderer.lineWidth = 5.0;\n        routeRenderer.strokeColor = [UIColor redColor];\n        return routeRenderer;\n    }\n    else {\n        return nil;\n    }\n}\n\n\n\u5b9f\u884c\u7d50\u679c\n\n\u25bc\u3053\u3061\u3089\u306f\u8907\u6570\u306e\u30eb\u30fc\u30c8\u3092\u691c\u7d22\u3057\u3066\u307f\u305f\u7d50\u679c\n\n\u4eca\u56de\u306f\u7279\u306b\u6307\u5b9a\u3057\u3066\u3044\u307e\u305b\u3093\u304c\u3001\u7d4c\u8def\u691c\u7d22\u6761\u4ef6\u306b\u300c\u5f92\u6b69\u300d\u3084\u300c\u81ea\u52d5\u8eca\u300d\u306a\u3069\u306e\u6307\u5b9a\u3082\u3067\u304d\u308b\u3088\u3046\u3067\u3059\u3002\n\n\u30b5\u30f3\u30d7\u30eb\u30bd\u30fc\u30b9\n[https://github.com/koogawa/MKDirectionsSample]\n\n\u3053\u306e\u8a18\u4e8b\u306f [iOS Second Stage Advent Calendar 2013](http://qiita.com/advent-calendar/2013/ios-2) \u7528\u306b\u30b9\u30c8\u30c3\u30af\u3057\u3066\u304a\u3044\u305f\u3082\u306e\u3067\u3059\u3002\u3059\u3079\u3066\u67a0\u304c\u57cb\u307e\u3063\u305f\u3088\u3046\u306a\u306e\u3067\u3001\u901a\u5e38\u8a18\u4e8b\u3068\u3057\u3066\u6295\u7a3f\u3057\u307e\u3059\u3002\n\n---\n\niOS 7 \u3067\u8ffd\u52a0\u3055\u308c\u305f MKDirections \u304c\u9762\u767d\u305d\u3046\u3060\u3063\u305f\u306e\u3067\u3001\u8a66\u3057\u306b\u516d\u672c\u6728\u304b\u3089\u6e0b\u8c37\u3078\u306e\u30eb\u30fc\u30c8\u3092\u691c\u7d22\u3057\u3066\u307f\u307e\u3057\u305f\u3002\n\n\u307e\u305a\u306f\u3001\u51fa\u767a\u70b9\u3068\u5230\u7740\u70b9\u3092 `CLLocationCoordinate2D` \u3067\u4f5c\u6210\u3057\u307e\u3059\u3002\n\n```objc\n// \u516d\u672c\u6728\nCLLocationCoordinate2D fromCoordinate = CLLocationCoordinate2DMake(35.665213, 139.730011);\n\n// \u6e0b\u8c37\nCLLocationCoordinate2D toCoordinate = CLLocationCoordinate2DMake(35.658987, 139.702776);\n```\n\n\u3053\u3053\u3067\u4f5c\u6210\u3057\u305f `CLLocationCoordinate2D` \u3092\u30bb\u30c3\u30c8\u3057\u305f `MKPlacemark` \u3092\u751f\u6210\u3057\u307e\u3059\u3002\n\n```objc\n// CLLocationCoordinate2D \u304b\u3089 MKPlacemark \u3092\u751f\u6210\nMKPlacemark *fromPlacemark = [[MKPlacemark alloc] initWithCoordinate:fromCoordinate\n                                                   addressDictionary:nil];\nMKPlacemark *toPlacemark   = [[MKPlacemark alloc] initWithCoordinate:toCoordinate\n                                                   addressDictionary:nil];\n```\n\n`MKPlacemark` \u304b\u3089 `MKMapItem` \u3092\u751f\u6210\u3057\u307e\u3059\u3002\n\n```objc\n// MKPlacemark \u304b\u3089 MKMapItem \u3092\u751f\u6210\nMKMapItem *fromItem = [[MKMapItem alloc] initWithPlacemark:fromPlacemark];\nMKMapItem *toItem   = [[MKMapItem alloc] initWithPlacemark:toPlacemark];\n```\n\n`MKMapItem` \u3092\u30bb\u30c3\u30c8\u3057\u3066 `MKDirectionsRequest` \u3092\u751f\u6210\u3057\u307e\u3059\u3002\n\n`requestsAlternateRoutes` \u306b `YES` \u3092\u8a2d\u5b9a\u3059\u308b\u3068\u3001\u8907\u6570\u306e\u30eb\u30fc\u30c8\u3092\u691c\u7d22\u3067\u304d\u308b\u3088\u3046\u3067\u3059\u3002\n\n```objc\n// MKMapItem \u3092\u30bb\u30c3\u30c8\u3057\u3066 MKDirectionsRequest \u3092\u751f\u6210\nMKDirectionsRequest *request = [[MKDirectionsRequest alloc] init];\nrequest.source = fromItem;\nrequest.destination = toItem;\nrequest.requestsAlternateRoutes = YES;\n```\n\n`MKDirectionsRequest` \u304b\u3089 `MKDirections` \u3092\u751f\u6210\u3057\u307e\u3059\u3002\n\n```objc\n// MKDirectionsRequest \u304b\u3089 MKDirections \u3092\u751f\u6210\nMKDirections *directions = [[MKDirections alloc] initWithRequest:request];\n```\n\n\u3053\u3053\u3067\u3088\u3046\u3084\u304f\u7d4c\u8def\u691c\u7d22\u3092\u5b9f\u884c\u3067\u304d\u307e\u3059\u3002\n\n```objc\n// \u7d4c\u8def\u691c\u7d22\u3092\u5b9f\u884c\n[directions calculateDirectionsWithCompletionHandler:^(MKDirectionsResponse *response, NSError *error)\n {\n     if (error) return;\n\n     if ([response.routes count] > 0)\n     {\n         MKRoute *route = [response.routes objectAtIndex:0];\n         NSLog(@\"distance: %.2f meter\", route.distance);\n\n         // \u5730\u56f3\u4e0a\u306b\u30eb\u30fc\u30c8\u3092\u63cf\u753b\n         [self.mapView addOverlay:route.polyline];\n     }\n }];\n```\n\n\u30eb\u30fc\u30c8\u60c5\u5831\u306f `MKRoute` \u30af\u30e9\u30b9\u3067\u8fd4\u3063\u3066\u304f\u308b\u3088\u3046\u3067\u3059\u3002\u3053\u306e\u30af\u30e9\u30b9\u306b\u306f\u7d4c\u8def\u60c5\u5831\u306e\u4ed6\u3001\u79fb\u52d5\u306b\u304b\u304b\u308b\u4e88\u6e2c\u6642\u9593\u3084\u8ddd\u96e2\u306a\u3069\u3082\u542b\u307e\u308c\u308b\u3088\u3046\u3067\u3059\u3002\n\n\u6700\u5f8c\u306b\u3001\u5730\u56f3\u4e0a\u306b\u8868\u793a\u3055\u308c\u308b\u30eb\u30fc\u30c8\u306e\u8272\u3084\u7dda\u306e\u592a\u3055\u306a\u3069\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n\n```objc\n// \u5730\u56f3\u4e0a\u306b\u63cf\u753b\u3059\u308b\u30eb\u30fc\u30c8\u306e\u8272\u306a\u3069\u3092\u6307\u5b9a\uff08\u3053\u308c\u3092\u5b9f\u88c5\u3057\u306a\u3044\u3068\u4f55\u3082\u8868\u793a\u3055\u308c\u306a\u3044\uff09\n- (MKOverlayRenderer *)mapView:(MKMapView *)mapView\n            rendererForOverlay:(id<MKOverlay>)overlay\n{\n    if ([overlay isKindOfClass:[MKPolyline class]])\n    {\n        MKPolyline *route = overlay;\n        MKPolylineRenderer *routeRenderer = [[MKPolylineRenderer alloc] initWithPolyline:route];\n        routeRenderer.lineWidth = 5.0;\n        routeRenderer.strokeColor = [UIColor redColor];\n        return routeRenderer;\n    }\n    else {\n        return nil;\n    }\n}\n```\n\n### \u5b9f\u884c\u7d50\u679c\n![](https://qiita-image-store.s3.amazonaws.com/0/8292/099339f3-05c6-79a9-d9d5-d889f4831c67.png \"iOS\u30b7\u30df\u30e5\u30ec\u30fc\u30bf\u306e\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2013.12.02 13.05.41.png\")\n\n\u25bc\u3053\u3061\u3089\u306f\u8907\u6570\u306e\u30eb\u30fc\u30c8\u3092\u691c\u7d22\u3057\u3066\u307f\u305f\u7d50\u679c\n\n![](https://qiita-image-store.s3.amazonaws.com/0/8292/c4a9bb1e-051c-c658-a881-51e534108ed5.png \"iOS\u30b7\u30df\u30e5\u30ec\u30fc\u30bf\u306e\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2013.12.02 13.35.53.png\")\n\n\n\u4eca\u56de\u306f\u7279\u306b\u6307\u5b9a\u3057\u3066\u3044\u307e\u305b\u3093\u304c\u3001\u7d4c\u8def\u691c\u7d22\u6761\u4ef6\u306b\u300c\u5f92\u6b69\u300d\u3084\u300c\u81ea\u52d5\u8eca\u300d\u306a\u3069\u306e\u6307\u5b9a\u3082\u3067\u304d\u308b\u3088\u3046\u3067\u3059\u3002\n\n### \u30b5\u30f3\u30d7\u30eb\u30bd\u30fc\u30b9\n\n[https://github.com/koogawa/MKDirectionsSample]\n", "tags": ["iOS", "ios7", "\u5730\u56f3", "map"]}