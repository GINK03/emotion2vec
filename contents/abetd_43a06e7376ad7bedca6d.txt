{"context": "AWS(t2.micro)\u306bRedmine3\u4ee5\u964d\u3092\u69cb\u7bc9\u3059\u308b\u969b\u306b\u3001Ruby\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u3001\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u6642\u306e\u30e1\u30e2\u30ea\u4e0d\u8db3\u3068\u5d4c\u3063\u305f\u306e\u3067\u30e1\u30e2\u3002\n\n\u524d\u63d0\n\nStable \u306e\u6700\u65b0\u3092\u4f7f\u3046(2016.7.24\u6642\u70b9\u306e\u6700\u65b0\uff1aRedmine3.3)\nAmazon Linux\u3067\u30b7\u30f3\u30d7\u30eb\u306b\u69cb\u7bc9\u3059\u308b\n\u69cb\u7bc9\u6e08\u307f\u306eAMI\u306f\u4f7f\u7528\u3057\u306a\u3044\n\u540c\u3058\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306a\u3044\u306b\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3082\u69cb\u7bc9\u3059\u308b\n\n\n\n\nApplication\nVersion\n\n\n\n\nRedmine\n3.3\n\n\nMySQL\n5.6\n\n\nApache\n2.4\n\n\nRuby\n2.3\n\n\n\n\nEC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306e\u4f5c\u6210\n\u500b\u4eba\u5229\u7528\u306a\u306e\u3067\u3001\u7121\u6599\u67a0\u3067\u4f5c\u6210\u3059\u308b\u3002\n\nAMI : Amazon Linux AMI 2016.03.3 (HVM), SSD Volume Type - ami-374db956\n\u30bf\u30a4\u30d7 : t2.micro\n\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30b0\u30eb\u30fc\u30d7 : HTTP,HTTPS,SSH\n\n\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u304c\u4f5c\u6210\u3067\u304d\u305f\u3089\u3001SSH\u3067\u30ed\u30b0\u30a4\u30f3\u3057\u3001yum update \u3092\u5b9f\u884c\u3059\u308b\u3002\n\u4e00\u6642\u7684\u306aSWAP\u9818\u57df\u3092\u4f5c\u6210\u3059\u308b(\u3053\u3053\u3067\u306f1G\u3001\u30c7\u30d5\u30a9\u30eb\u30c8\u306eSwap\u9818\u57df\u306f0KB)\u3002\npassenger-install-apache2-module\u3067\u30e1\u30e2\u30ea\u4e0d\u8db3\u306b\u306a\u308b\ndd if=/dev/zero of=/tmp/swap.img bs=1M count=1024\nchmod 600 /tmp/swap.img\nmkswap /tmp/swap.img\nswapon /tmp/swap.img\nfree\n\n\nDB\u3068HTTP\u30b5\u30fc\u30d0\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\u958b\u767a\u30c4\u30fc\u30eb\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\nyum groupinstall \"Development Tools\"\n\nApache \u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\nyum install httpd24\n\nMySQL\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\nyum\u3067\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u53ef\u80fd\u306a\u6700\u65b0\u306f5.6\nyum list available | grep mysql\nyum install mysql56-server mysql56-devel\n\nMySQL\u3092\u8d77\u52d5\u3057\u3066\u3001root\u30d1\u30b9\u30ef\u30fc\u30c9\u3092\u5909\u66f4\nservice mysqld start\nchkconfig mysqld on\n\n# mysql -uroot\n> update mysql.user set password=password('new-password') where user = 'root';\n> flush privileges;\n> exit;\n# mysql -u root -p\n\n\nDB\u306e\u6e96\u5099\n\u4ee5\u4e0b\u306e\u5185\u5bb9\u3067Redmine\u7528\u306e\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3068\u30e6\u30fc\u30b6\u3092\u4f5c\u6210\u3059\u308b\n- DB : redmine_db\n- USER : redmineuser\n- PASS : password\nCREATE DATABASE redmine_db default charset=\"utf8\";\nGRANT ALL PRIVILEGES ON redmine_db.* TO redmineuser@localhost IDENTIFIED BY 'password';\n\n\nRuby\u30922.3\u306b\u3059\u308b\nRuby2.3\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u3066\u3001\u30c7\u30d5\u30a9\u30eb\u30c8\u306e2.0\u306f\u6d88\u3059\u3002\nruby -v\nyum install ruby23 ruby23-devel\nyum erase ruby20\nruby -v\n\nruby\u3068gem\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u3092\u78ba\u8a8d\n# ruby -v\nruby 2.3.0p0 (2015-12-25 revision 53290) [x86_64-linux-gnu]\n# gem -v\n2.5.1\n\nbundler\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\u3002\ngem install bundler --no-rdoc --no-ri\n\n\nRedmine\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\u30d3\u30eb\u30c9\u306b\u5fc5\u8981\u306a\u30d1\u30c3\u30b1\u30fc\u30b8\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3002(\u4e00\u90e8\u306f\u3059\u3067\u306b\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u6e08\uff09\nyum install zlib-devel libcurl-devel openssl-devel httpd24-devel apr-devel apr-util-devel mysql56-devel\nyum install ImageMagick ImageMagick-devel ipa-gothic-fonts\n\nRedmine\u306e\u30d1\u30c3\u30b1\u30fc\u30b8\u3092\u5c55\u958b\ncd /usr/local/src\ncurl -O https://www.redmine.org/releases/redmine-3.3.0.tar.gz\ntar xzf redmine-3.3.0.tar.gz\nmv redmine-3.3.0 /var/lib/redmine\n\n\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u63a5\u7d9a\u306e\u8a2d\u5b9a\ncd /var/lib/redmine\nvi config/database.yml\n\n\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3068\u30e6\u30fc\u30b6\u540d\u3001\u30d1\u30b9\u30ef\u30fc\u30c9\u306f\u5148\u7a0b\u306e\u3092\u8a2d\u5b9a\n\ndatabase.yml\nproduction:\n  adapter: mysql2\n  database: redminedb\n  host: localhost\n  username: redmineuser\n  password: 'redminepass'\n  encoding: utf8\n\n\n\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u8a2d\u5b9a\nvi config/configuration.yml\n\nrmagick_font_path \u306fyum\u3067\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u305f\u30d5\u30a9\u30f3\u30c8\u3092\u8a2d\u5b9a\n\nconfiguration.yml\u2028production\n  email_delivery:\n    delivery_method: :smtp\n    smtp_settings:\n      address: \"localhost\"\n      port: 25\n      domain: 'example.com'\n\n  rmagick_font_path: /usr/share/fonts/ipa-gothic/ipag.ttf\n\n\n\u5fc5\u8981\u306agem\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\nbundle install --without development test postgresql sqlite --path vendor/bundle\n\n\u30b7\u30fc\u30af\u30ec\u30c3\u30c8\u30c8\u30fc\u30af\u30f3\u3092\u751f\u6210\nbundle exec rake generate_secret_token\n\n\u4ee5\u4e0b\u306e\u8b66\u544a\u304c\u3067\u308b\u304c\u3001\u7121\u8996\nexpanded.rb:465: warning: key \"inodot\" is duplicated and overwritten on line 466\n\nDB\u30b9\u30ad\u30fc\u30de\u306e\u4f5c\u6210\nRAILS_ENV=production bundle exec rake db:migrate\n\n/var/lib/redmine\u306e\u30aa\u30fc\u30ca\u30fc\u3092apache\u306b\u5909\u66f4\nsh\u2028chown -R apache:apache /var/lib/redmine\n\nPassenger\u30e2\u30b8\u30e5\u30fc\u30eb\u3092\u30d3\u30eb\u30c9\ngem install passenger --no-ri --no-rdoc\npassenger-install-apache2-module\n\n\u30b3\u30f3\u30d1\u30a4\u30eb\u304c\u7d42\u308f\u3063\u305f\u3089\u3001Apache\u306e\u30e2\u30b8\u30e5\u30fc\u30eb\u8a2d\u5b9a\u3092\u884c\u3046\u3002\nvi /etc/httpd/conf.modules.d/01-passenger.conf\n\n\u30b3\u30f3\u30d1\u30a4\u30eb\u306e\u7d42\u76e4\u306b\u51fa\u529b\u3055\u308c\u305f\u5185\u5bb9\u3092\u8a2d\u5b9a\u3059\u308b\u3002\nLoadModule passenger_module /usr/local/share/ruby/gems/2.3/gems/passenger-5.0.29/buildout/apache2/mod_passenger.so\n<IfModule mod_passenger.c>\n  PassengerRoot /usr/local/share/ruby/gems/2.3/gems/passenger-5.0.29\n  PassengerDefaultRuby /usr/bin/ruby2.3\n</IfModule>\n\nApache\u306e\u8a2d\u5b9a\nvi /etc/httpd/conf.d/redmine.conf\n\n\nredmine.conf\nRailsBaseURI /redmine\n<Directory /var/lib/redmine/public>\n  AllowOverride none\n  Require all granted\n</Directory>\n\n\ncd /var/www/html\nln -s /var/lib/redmine/public redmine\n\nApache\u306e\u8d77\u52d5\nservice httpd start\nchkconfig httpd on\n\n\n\u53c2\u8003\n\nAmazon EC2\u4e0a\u306bRedmine\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u3066\u307f\u305f\nRedmine 3.2\u3092CentOS 7.1\u306b\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\u624b\u9806\nEC2 (Amazon Linux) \u3067 Redmine 3.3\n\nRedmineInstall : \u5bfe\u5fdc\u3057\u3066\u3044\u308b\u30d0\u30fc\u30b8\u30e7\u30f3\u306e\u78ba\u8a8d\nAWS Amazon Linux \u30b9\u30ef\u30c3\u30d7\u30d5\u30a1\u30a4\u30eb\u4f5c\u6210\u306b\u3088\u308aSwap\u9818\u57df\u306e\u30b5\u30a4\u30ba\u3092\u5897\u3084\u3059\n\n\nAWS(t2.micro)\u306bRedmine3\u4ee5\u964d\u3092\u69cb\u7bc9\u3059\u308b\u969b\u306b\u3001Ruby\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u3001\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u6642\u306e\u30e1\u30e2\u30ea\u4e0d\u8db3\u3068\u5d4c\u3063\u305f\u306e\u3067\u30e1\u30e2\u3002\n\n## \u524d\u63d0\n- Stable \u306e\u6700\u65b0\u3092\u4f7f\u3046(2016.7.24\u6642\u70b9\u306e\u6700\u65b0\uff1aRedmine3.3)\n- Amazon Linux\u3067\u30b7\u30f3\u30d7\u30eb\u306b\u69cb\u7bc9\u3059\u308b\n- \u69cb\u7bc9\u6e08\u307f\u306eAMI\u306f\u4f7f\u7528\u3057\u306a\u3044\n- \u540c\u3058\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306a\u3044\u306b\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3082\u69cb\u7bc9\u3059\u308b\n\n|Application|Version|\n|:----------|------:|\n|Redmine|3.3|\n|MySQL|5.6|\n|Apache|2.4|\n|Ruby|2.3|\n\n\n## EC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306e\u4f5c\u6210\n\n\u500b\u4eba\u5229\u7528\u306a\u306e\u3067\u3001\u7121\u6599\u67a0\u3067\u4f5c\u6210\u3059\u308b\u3002\n\n- AMI : Amazon Linux AMI 2016.03.3 (HVM), SSD Volume Type - ami-374db956\n- \u30bf\u30a4\u30d7 : t2.micro\n- \u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30b0\u30eb\u30fc\u30d7 : HTTP,HTTPS,SSH\n\n\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u304c\u4f5c\u6210\u3067\u304d\u305f\u3089\u3001SSH\u3067\u30ed\u30b0\u30a4\u30f3\u3057\u3001yum update \u3092\u5b9f\u884c\u3059\u308b\u3002\n\n\u4e00\u6642\u7684\u306aSWAP\u9818\u57df\u3092\u4f5c\u6210\u3059\u308b(\u3053\u3053\u3067\u306f1G\u3001\u30c7\u30d5\u30a9\u30eb\u30c8\u306eSwap\u9818\u57df\u306f0KB)\u3002\npassenger-install-apache2-module\u3067\u30e1\u30e2\u30ea\u4e0d\u8db3\u306b\u306a\u308b\n\n```sh\ndd if=/dev/zero of=/tmp/swap.img bs=1M count=1024\nchmod 600 /tmp/swap.img\nmkswap /tmp/swap.img\nswapon /tmp/swap.img\nfree\n```\n\n\n## DB\u3068HTTP\u30b5\u30fc\u30d0\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n\u958b\u767a\u30c4\u30fc\u30eb\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n```sh\nyum groupinstall \"Development Tools\"\n```\n\nApache \u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n```sh\nyum install httpd24\n```\n\nMySQL\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\nyum\u3067\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u53ef\u80fd\u306a\u6700\u65b0\u306f5.6\n\n```sh\nyum list available | grep mysql\nyum install mysql56-server mysql56-devel\n```\n\nMySQL\u3092\u8d77\u52d5\u3057\u3066\u3001root\u30d1\u30b9\u30ef\u30fc\u30c9\u3092\u5909\u66f4\n\n```\nservice mysqld start\nchkconfig mysqld on\n```\n\n```\n# mysql -uroot\n> update mysql.user set password=password('new-password') where user = 'root';\n> flush privileges;\n> exit;\n# mysql -u root -p\n```\n\n## DB\u306e\u6e96\u5099\n\n\u4ee5\u4e0b\u306e\u5185\u5bb9\u3067Redmine\u7528\u306e\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3068\u30e6\u30fc\u30b6\u3092\u4f5c\u6210\u3059\u308b\n- DB : redmine_db\n- USER : redmineuser\n- PASS : password\n\n```\nCREATE DATABASE redmine_db default charset=\"utf8\";\nGRANT ALL PRIVILEGES ON redmine_db.* TO redmineuser@localhost IDENTIFIED BY 'password';\n```\n\n\n## Ruby\u30922.3\u306b\u3059\u308b\nRuby2.3\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u3066\u3001\u30c7\u30d5\u30a9\u30eb\u30c8\u306e2.0\u306f\u6d88\u3059\u3002\n\n```sh\nruby -v\nyum install ruby23 ruby23-devel\nyum erase ruby20\nruby -v\n```\n\nruby\u3068gem\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u3092\u78ba\u8a8d\n\n```\n# ruby -v\nruby 2.3.0p0 (2015-12-25 revision 53290) [x86_64-linux-gnu]\n# gem -v\n2.5.1\n```\n\nbundler\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\u3002\n\n```sh\ngem install bundler --no-rdoc --no-ri\n```\n\n## Redmine\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n\u30d3\u30eb\u30c9\u306b\u5fc5\u8981\u306a\u30d1\u30c3\u30b1\u30fc\u30b8\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3002(\u4e00\u90e8\u306f\u3059\u3067\u306b\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u6e08\uff09\n\n```sh\nyum install zlib-devel libcurl-devel openssl-devel httpd24-devel apr-devel apr-util-devel mysql56-devel\nyum install ImageMagick ImageMagick-devel ipa-gothic-fonts\n```\n\nRedmine\u306e\u30d1\u30c3\u30b1\u30fc\u30b8\u3092\u5c55\u958b\n\n```sh\ncd /usr/local/src\ncurl -O https://www.redmine.org/releases/redmine-3.3.0.tar.gz\ntar xzf redmine-3.3.0.tar.gz\nmv redmine-3.3.0 /var/lib/redmine\n```\n\n\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u63a5\u7d9a\u306e\u8a2d\u5b9a\n\n```sh\ncd /var/lib/redmine\nvi config/database.yml\n```\n\n\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3068\u30e6\u30fc\u30b6\u540d\u3001\u30d1\u30b9\u30ef\u30fc\u30c9\u306f\u5148\u7a0b\u306e\u3092\u8a2d\u5b9a\n\n```yml:database.yml\nproduction:\n  adapter: mysql2\n  database: redminedb\n  host: localhost\n  username: redmineuser\n  password: 'redminepass'\n  encoding: utf8\n```\n\n\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u8a2d\u5b9a\n\n```sh\nvi config/configuration.yml\n```\n\nrmagick_font_path \u306fyum\u3067\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u305f\u30d5\u30a9\u30f3\u30c8\u3092\u8a2d\u5b9a\n\n```yml:configuration.yml\u2028production:\n  email_delivery:\n    delivery_method: :smtp\n    smtp_settings:\n      address: \"localhost\"\n      port: 25\n      domain: 'example.com'\n \n  rmagick_font_path: /usr/share/fonts/ipa-gothic/ipag.ttf\n```\n\n\u5fc5\u8981\u306agem\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n```sh\nbundle install --without development test postgresql sqlite --path vendor/bundle\n```\n\n\u30b7\u30fc\u30af\u30ec\u30c3\u30c8\u30c8\u30fc\u30af\u30f3\u3092\u751f\u6210\n\n```sh\nbundle exec rake generate_secret_token\n```\n\n\u4ee5\u4e0b\u306e\u8b66\u544a\u304c\u3067\u308b\u304c\u3001\u7121\u8996\n\n```\nexpanded.rb:465: warning: key \"inodot\" is duplicated and overwritten on line 466\n```\n\nDB\u30b9\u30ad\u30fc\u30de\u306e\u4f5c\u6210\n\n```sh\nRAILS_ENV=production bundle exec rake db:migrate\n```\n\n/var/lib/redmine\u306e\u30aa\u30fc\u30ca\u30fc\u3092apache\u306b\u5909\u66f4\n\n```sh\u2028chown -R apache:apache /var/lib/redmine\n```\n\nPassenger\u30e2\u30b8\u30e5\u30fc\u30eb\u3092\u30d3\u30eb\u30c9\n\n```sh\ngem install passenger --no-ri --no-rdoc\npassenger-install-apache2-module\n```\n\n\u30b3\u30f3\u30d1\u30a4\u30eb\u304c\u7d42\u308f\u3063\u305f\u3089\u3001Apache\u306e\u30e2\u30b8\u30e5\u30fc\u30eb\u8a2d\u5b9a\u3092\u884c\u3046\u3002\n\n```\nvi /etc/httpd/conf.modules.d/01-passenger.conf\n```\n\n\u30b3\u30f3\u30d1\u30a4\u30eb\u306e\u7d42\u76e4\u306b\u51fa\u529b\u3055\u308c\u305f\u5185\u5bb9\u3092\u8a2d\u5b9a\u3059\u308b\u3002\n\n```\nLoadModule passenger_module /usr/local/share/ruby/gems/2.3/gems/passenger-5.0.29/buildout/apache2/mod_passenger.so\n<IfModule mod_passenger.c>\n  PassengerRoot /usr/local/share/ruby/gems/2.3/gems/passenger-5.0.29\n  PassengerDefaultRuby /usr/bin/ruby2.3\n</IfModule>\n```\n\nApache\u306e\u8a2d\u5b9a\n\n```\nvi /etc/httpd/conf.d/redmine.conf\n```\n\n```xml:redmine.conf\nRailsBaseURI /redmine\n<Directory /var/lib/redmine/public>\n  AllowOverride none\n  Require all granted\n</Directory>\n```\n\n```sh\ncd /var/www/html\nln -s /var/lib/redmine/public redmine\n```\n\nApache\u306e\u8d77\u52d5\n\n```sh\nservice httpd start\nchkconfig httpd on\n```\n\n\n## \u53c2\u8003\n- [Amazon EC2\u4e0a\u306bRedmine\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u3066\u307f\u305f](http://dev.classmethod.jp/cloud/aws/install-redmine-to-amazon-ec2/)\n- [Redmine 3.2\u3092CentOS 7.1\u306b\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\u624b\u9806](http://blog.redmine.jp/articles/3_2/install/centos/)\n- [EC2 (Amazon Linux) \u3067 Redmine 3.3](http://qiita.com/nakanishi-m/items/73ecefb5706381bf3c32)\n- [RedmineInstall](https://www.redmine.org/projects/redmine/wiki/redmineinstall) : \u5bfe\u5fdc\u3057\u3066\u3044\u308b\u30d0\u30fc\u30b8\u30e7\u30f3\u306e\u78ba\u8a8d\n- [AWS Amazon Linux \u30b9\u30ef\u30c3\u30d7\u30d5\u30a1\u30a4\u30eb\u4f5c\u6210\u306b\u3088\u308aSwap\u9818\u57df\u306e\u30b5\u30a4\u30ba\u3092\u5897\u3084\u3059](http://qiita.com/na0AaooQ/items/278a11ed905995bd16af)\n\n\n", "tags": ["Redmine", "AWS"]}