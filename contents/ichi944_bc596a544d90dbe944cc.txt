{"context": " More than 1 year has passed since last update.Laravel5\u3068Mockery\u306e\u899a\u66f8\n\u3053\u3046\u3044\u3046\u30b3\u30f3\u30c8\u30ed\u30fc\u30e9\u30fc\u304c\u3042\u3063\u3066\n\nCustomerController.php\n<?php namespace App\\Http\\Controllers;\n\nuse App\\Http\\Requests;\nuse App\\Http\\Controllers\\Controller;\n\nuse App\\Customer;\n\nuse Illuminate\\Http\\Request;\n\nclass CustomerController extends Controller {\n\n    protected $customer;\n\n    public function __construct(Customer $customer)\n    {\n        $this->customer = $customer;\n    }\n\n    /**\n     * Display a listing of the resource.\n     *\n     * @return Response\n     */\n    public function getIndex()\n    {\n        $customers = $this->customer->all()->sortByDesc('id');\n        return view('customer.index')->with(compact('customers'));\n    }\n}\n\n\n\u3053\u3046\u3044\u3046\u30c6\u30b9\u30c8\u304c\u3042\u308b\u3068\u3057\u3066\n\u305d\u308c\u305e\u308c\u306e\u8aac\u660e\u3092\u66f8\u304d\u3068\u3081\n\ncustomerTest.php\n<?php\n\nuse App\\Customer;\n\nclass CustomerTest extends TestCase {\n\n    protected $customerMock;\n\n    public function setUp()\n    {\n        parent::setUp();\n        $this->customerMock = Mockery::mock('App\\Customer');\n    }\n    public function tearDown()\n    {\n        parent::tearDown();\n        Mockery::close();\n    }\n    public function testIndex()\n    {\n        $this->customerMock\n            ->shouldReceive('all')\n            ->once()\n            ->andReturn($this->customerMock);\n        $this->app->instance('App\\Customer', $this->customerMock);\n        $this->call('GET', '/customers/');\n    }\n}\n\n\n\n\u30e2\u30c3\u30af\u306e\u7528\u610f\nsetUp\u30e1\u30bd\u30c3\u30c9\u3067\u30e2\u30c3\u30af\u306e\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u3092\u4f5c\u6210\u3059\u308b\n\u6ce8\u610f\u70b9\u3068\u3057\u3066\u306f\u30e2\u30c3\u30af\u306b\u6e21\u3059\u30e2\u30c7\u30eb\u540d\u306f\u5b8c\u5168\u306a\u540d\u524d\u7a7a\u9593\u4ed8\u304d\u306b\u3059\u308b\n    protected $customerMock;\n\n    public function setUp()\n    {\n        parent::setUp();\n        $this->customerMock = Mockery::mock('App\\Customer');\n    }\n\n\n\u30e2\u30c3\u30af\u306e\u30af\u30ed\u30fc\u30ba\n\u3053\u308c\u306f\u5fc5\u9808\n    public function tearDown()\n    {\n        parent::tearDown();\n        Mockery::close();\n    }\n\n\n\u30e2\u30c7\u30eb\u306e\"all\"\u30e1\u30bd\u30c3\u30c9\u304c\u547c\u3070\u308c\u308b\u3053\u3068\u3092\u30c6\u30b9\u30c8\n    public function testIndex()\n    {\n        $this->customerMock\n            ->shouldReceive('all')\n            ->once()\n            ->andReturn($this->customerMock);\n        $this->app->instance('App\\Customer', $this->customerMock);\n        $this->call('GET', '/customers/');\n    }\n\n\nshouldReceive\u3068once\n\u3053\u308c\u304c\u30c6\u30b9\u30c8\u306e\u672c\u4f53(?)\u3067Controller\u3067all()\u304c\u547c\u3070\u308c\u306a\u3044\u3068\u30c6\u30b9\u30c8\u304c\u843d\u3061\u308b\n\u6ce8\u610f\u70b9\u3068\u3057\u3066\u306f\u4e0a\u3067\u66f8\u3044\u305f\nMockery::close()\n\u3092\u547c\u3093\u3067\u304a\u304b\u306a\u3044\u3068\u30c6\u30b9\u30c8\u81ea\u4f53\u304c\u5b9f\u884c\u3055\u308c\u306a\u3044\u3002(\u306f\u307e\u3063\u305f)\n            ->shouldReceive('all')\n            ->once()\n\n\nandReturn\n\u3053\u306e\u4f8b\u3067\u8a00\u3046\u3068all\u304c\u547c\u3070\u308c\u305f\u6642\u306b\u8fd4\u3059\u5024(\u305d\u306e\u307e\u3093\u307e\u3060\u3051\u3069)\n\u3053\u306e\u30b3\u30f3\u30c8\u30ed\u30fc\u30e9\u30fc\u3067\u306fall()\u306e\u5f8c\u306bsortByDesc()\u3092\u547c\u3093\u3067\u3044\u308b\u306e\u3067\u81ea\u8eab\u3092\u8fd4\u3055\u306a\u3044\u3068\u3044\u3051\u306a\u3044\u306e\u3067\n\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u3059\u308b\n            ->andReturn($this->customerMock);\n\n\n\u30e2\u30c3\u30af\u306e\u6ce8\u5165\n\u3053\u308c\u306fLaravel\u306e\u6a5f\u80fd\u3067\u81ea\u52d5\u7684\u306b\u30e2\u30c7\u30eb\u304c\u6ce8\u5165\u3055\u308c\u308b\u524d\u306b\u5dee\u3057\u66ff\u3048\u3066\u3044\u308b(\u3093\u3060\u3068\u601d\u3046)\n\u3053\u3053\u3067\u3082\u30af\u30e9\u30b9\u540d\u306f\u5b8c\u5168\u306a\u540d\u524d\u7a7a\u9593\u4ed8\u304d\u306b\u3059\u308b\n$this->app->instance('App\\Customer', $this->customerMock);\n\nLaravel5\u3068Mockery\u306e\u899a\u66f8\n\n\u3053\u3046\u3044\u3046\u30b3\u30f3\u30c8\u30ed\u30fc\u30e9\u30fc\u304c\u3042\u3063\u3066\n\n```CustomerController.php\n<?php namespace App\\Http\\Controllers;\n\nuse App\\Http\\Requests;\nuse App\\Http\\Controllers\\Controller;\n\nuse App\\Customer;\n\nuse Illuminate\\Http\\Request;\n\nclass CustomerController extends Controller {\n\n\tprotected $customer;\n\n\tpublic function __construct(Customer $customer)\n\t{\n\t\t$this->customer = $customer;\n\t}\n\n\t/**\n\t * Display a listing of the resource.\n\t *\n\t * @return Response\n\t */\n\tpublic function getIndex()\n\t{\n\t\t$customers = $this->customer->all()->sortByDesc('id');\n\t\treturn view('customer.index')->with(compact('customers'));\n\t}\n}\n```\n\n\u3053\u3046\u3044\u3046\u30c6\u30b9\u30c8\u304c\u3042\u308b\u3068\u3057\u3066\n\u305d\u308c\u305e\u308c\u306e\u8aac\u660e\u3092\u66f8\u304d\u3068\u3081\n\n```customerTest.php\n<?php\n\nuse App\\Customer;\n\nclass CustomerTest extends TestCase {\n\n\tprotected $customerMock;\n\n\tpublic function setUp()\n\t{\n\t\tparent::setUp();\n\t\t$this->customerMock = Mockery::mock('App\\Customer');\n\t}\n\tpublic function tearDown()\n\t{\n\t\tparent::tearDown();\n\t\tMockery::close();\n\t}\n\tpublic function testIndex()\n\t{\n\t\t$this->customerMock\n\t\t\t->shouldReceive('all')\n\t\t\t->once()\n\t\t\t->andReturn($this->customerMock);\n\t\t$this->app->instance('App\\Customer', $this->customerMock);\n\t\t$this->call('GET', '/customers/');\n\t}\n}\n```\n\n## \u30e2\u30c3\u30af\u306e\u7528\u610f\n\nsetUp\u30e1\u30bd\u30c3\u30c9\u3067\u30e2\u30c3\u30af\u306e\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u3092\u4f5c\u6210\u3059\u308b\n\u6ce8\u610f\u70b9\u3068\u3057\u3066\u306f\u30e2\u30c3\u30af\u306b\u6e21\u3059\u30e2\u30c7\u30eb\u540d\u306f\u5b8c\u5168\u306a\u540d\u524d\u7a7a\u9593\u4ed8\u304d\u306b\u3059\u308b\n\n```php\n    protected $customerMock;\n\n    public function setUp()\n    {\n        parent::setUp();\n        $this->customerMock = Mockery::mock('App\\Customer');\n    }\n```\n\n## \u30e2\u30c3\u30af\u306e\u30af\u30ed\u30fc\u30ba\n\n\u3053\u308c\u306f\u5fc5\u9808\n\n```php\n\tpublic function tearDown()\n\t{\n\t\tparent::tearDown();\n\t\tMockery::close();\n\t}\n```\n\n## \u30e2\u30c7\u30eb\u306e\"all\"\u30e1\u30bd\u30c3\u30c9\u304c\u547c\u3070\u308c\u308b\u3053\u3068\u3092\u30c6\u30b9\u30c8\n\n```\n\tpublic function testIndex()\n\t{\n\t\t$this->customerMock\n\t\t\t->shouldReceive('all')\n\t\t\t->once()\n\t\t\t->andReturn($this->customerMock);\n\t\t$this->app->instance('App\\Customer', $this->customerMock);\n\t\t$this->call('GET', '/customers/');\n\t}\n```\n\n### shouldReceive\u3068once\n\n\u3053\u308c\u304c\u30c6\u30b9\u30c8\u306e\u672c\u4f53(?)\u3067Controller\u3067all()\u304c\u547c\u3070\u308c\u306a\u3044\u3068\u30c6\u30b9\u30c8\u304c\u843d\u3061\u308b\n\u6ce8\u610f\u70b9\u3068\u3057\u3066\u306f\u4e0a\u3067\u66f8\u3044\u305f\nMockery::close()\n\u3092\u547c\u3093\u3067\u304a\u304b\u306a\u3044\u3068\u30c6\u30b9\u30c8\u81ea\u4f53\u304c\u5b9f\u884c\u3055\u308c\u306a\u3044\u3002(\u306f\u307e\u3063\u305f)\n\n```php\n            ->shouldReceive('all')\n            ->once()\n```\n\n### andReturn\n\n\u3053\u306e\u4f8b\u3067\u8a00\u3046\u3068all\u304c\u547c\u3070\u308c\u305f\u6642\u306b\u8fd4\u3059\u5024(\u305d\u306e\u307e\u3093\u307e\u3060\u3051\u3069)\n\u3053\u306e\u30b3\u30f3\u30c8\u30ed\u30fc\u30e9\u30fc\u3067\u306fall()\u306e\u5f8c\u306bsortByDesc()\u3092\u547c\u3093\u3067\u3044\u308b\u306e\u3067\u81ea\u8eab\u3092\u8fd4\u3055\u306a\u3044\u3068\u3044\u3051\u306a\u3044\u306e\u3067\n\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u3059\u308b\n\n```php\n\t\t\t->andReturn($this->customerMock);\n```\n\n### \u30e2\u30c3\u30af\u306e\u6ce8\u5165\n\n\u3053\u308c\u306fLaravel\u306e\u6a5f\u80fd\u3067\u81ea\u52d5\u7684\u306b\u30e2\u30c7\u30eb\u304c\u6ce8\u5165\u3055\u308c\u308b\u524d\u306b\u5dee\u3057\u66ff\u3048\u3066\u3044\u308b(\u3093\u3060\u3068\u601d\u3046)\n\u3053\u3053\u3067\u3082\u30af\u30e9\u30b9\u540d\u306f\u5b8c\u5168\u306a\u540d\u524d\u7a7a\u9593\u4ed8\u304d\u306b\u3059\u308b\n\n```php\n$this->app->instance('App\\Customer', $this->customerMock);\n```\n", "tags": ["mockery", "laravel", "test"]}