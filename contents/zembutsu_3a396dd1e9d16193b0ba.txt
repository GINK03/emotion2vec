{"tags": ["docker", "dockerfile"], "context": " More than 1 year has passed since last update.\n\n\u30af\u30e9\u30a6\u30c9\u3092\u6e21\u308a\u6b69\u3051\uff01\u3000\u3055\u304f\u3089\u00d7\u30cb\u30d5\u30c6\u30a3\u3000\u5408\u540c\u30cf\u30f3\u30ba\u30aa\u30f3\u52c9\u5f37\u4f1a\uff01\uff01\n2014\u5e747\u670819\u65e5(\u571f)\u958b\u50ac\u306e\u3001Docker\u30cf\u30f3\u30ba\u30aa\u30f3\u7528\u306e\u8cc7\u6599\u3067\u3059\u3002\n\n\u30cf\u30f3\u30ba\u30aa\u30f3\u306e\u6d41\u308c\n\n\n\u76ee\u7684\n\n \u5b9f\u969b\u306b docker \u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3092\u3057\u3001\u30b3\u30f3\u30c6\u30ca\u306e\u4f5c\u6210\u30fb\u7ba1\u7406\u3084\u3001\u30af\u30e9\u30a6\u30c9\u9593\u306e\u79fb\u884c\u304c\u51fa\u6765\u308b\u3088\u3046\u306b\u3002\n\n\n\n\u5185\u5bb9\n\n \u30cb\u30d5\u30c6\u30a3 \u2026 Ubuntu 12.04 \u306b Docker \u3092\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\n \u3055\u304f\u3089 \u2026 CentOS 6.5 \u306b Docker \u3092\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\n \u30b3\u30f3\u30c6\u30ca\u3092\u4f5c\u6210\u3057\u3001\u76f8\u4e92\u306b\u79fb\u52d5\n\u9759\u7684\u30b3\u30f3\u30c6\u30f3\u30c4\u7de8 ( Apache + HTML \u30d5\u30a1\u30a4\u30eb )\n\u52d5\u7684\u30b3\u30f3\u30c6\u30f3\u30c4\u7de8 ( Apache + PHP + PukiWiki )\n\n\n\n\n1. Docker \u306e\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7(Ubuntu/\u30cb\u30d5\u30c6\u30a3\u30af\u30e9\u30a6\u30c9\u7de8)\n\n1.1. \u30cb\u30d5\u30c6\u30a3\u30af\u30e9\u30a6\u30c9\u306b\u30ed\u30b0\u30a4\u30f3\n\u5bfe\u8c61\u30b5\u30fc\u30d0\u306b SSH \u3067\u30ed\u30b0\u30a4\u30f3\u3057\u307e\u3059\u3002Linux kernel \u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u304c\u53e4\u3044\u70ba\u3001\u30d0\u30fc\u30b8\u30e7\u30f3\u30a2\u30c3\u30d7\u3092\u3057\u307e\u3059\u3002\nhost@ubuntu# apt-get update\nhost@ubuntu# apt-get install -y linux-image-generic-lts-raring linux-headers-generic-lts-raring\n(\u7565)\nSetting up linux-headers-generic-lts-raring (3.8.0.44.44) ...\nSetting up linux-image-generic-lts-raring (3.8.0.44.44) ...\nhost@ubuntu# reboot\n\n\n1.2. \u30d0\u30fc\u30b8\u30e7\u30f3\u78ba\u8a8d\nreboot \u5f8c\u3001\u518d\u3073\u5bfe\u8c61\u30b5\u30fc\u30d0\u306b\u30ed\u30b0\u30a4\u30f3\u3057\u307e\u3059\u3002\nhost@ubuntu# uname -a\nLinux ubuntu 3.8.0-44-generic #66~precise1-Ubuntu SMP Tue Jul 15 04:01:04 UTC 2014 x86_64 x86_64 x86_64 GNU/Linux\n\n\u30d0\u30fc\u30b8\u30e7\u30f3\u304c\u300c3.8\u300d\u306b\u306a\u3063\u3066\u3044\u308b\u4e8b\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\n\n1.3. Docker \u306e\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\n\u9375\u3092\u53d6\u308a\u8fbc\u307f\u307e\u3059\u3002\nhost@ubuntu# apt-key adv --keyserver hkp://keyserver.ubuntu.com:80 --recv-keys 36A1D7869245C8950F966E92D8576A8BA88D21E9\n\nDocker \u30ea\u30dd\u30b8\u30c8\u30ea\u3092\u6709\u52b9\u5316\u3057\u307e\u3059\u3002\nhost@ubuntu# sh -c \"echo deb https://get.docker.io/ubuntu docker main > /etc/apt/sources.list.d/docker.list\"\n\n\u5185\u5bb9\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\nhost@ubuntu# cat /etc/apt/sources.list.d/docker.list\ndeb https://get.docker.io/ubuntu docker main\n\n\u66f4\u65b0\u3068\u3001lxc-docker \u30d1\u30c3\u30b1\u30fc\u30b8\u3092\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\u3057\u307e\u3059\u3002\nhost@ubuntu# apt-get update\nhost@ubuntu# apt-get install lxc-docker\n\n\u203b\u9014\u4e2d\u306e\u9805\u76ee\u306f Y \u3092\u6307\u5b9a\u3057\u307e\u3059\u3002\ndocker \u306e\u72b6\u614b\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\nhost@ubuntu# service docker status\ndocker start/running, process 4695\n\nhost@ubuntu# docker --version\nDocker version 1.1.1, build bd609d2\n\n\n1.4. \u540d\u524d\u89e3\u6c7a\u306e\u8a2d\u5b9a\n\u3053\u306e\u307e\u307e\u3067\u306f Docker \u304c\u540d\u524d\u89e3\u6c7a\u3067\u304d\u305a\u3001\u30a4\u30e1\u30fc\u30b8\u306e\u53d6\u5f97\u304c\u3067\u304d\u307e\u305b\u3093\u3002\u4ee5\u4e0b\u306e\u9805\u76ee\u3092\u8ffd\u8a18\u3057\u307e\u3059\u3002\nhost@ubuntu# echo 'nameserver 127.0.0.1' >> /etc/resolv.conf\n\n\u8a2d\u5b9a\u3092 Docker \u306b\u53cd\u6620\u3059\u308b\u305f\u3081\u3001Docker \u306e\u518d\u8d77\u52d5\u3092\u884c\u3044\u307e\u3059\u3002\nhost@nifty # service docker restart\ndocker stop/waiting\ndocker start/running, process 5091\n\n\u53c2\u8003\nhttp://docs.docker.com/installation/ubuntulinux/#ubuntu-precise-1204-lts-64-bit\nhttps://github.com/dotcloud/docker/issues/1470\n\n1.5. vmware-tools \u306e\u66f4\u65b0\n\u30cb\u30d5\u30c6\u30a3\u30af\u30e9\u30a6\u30c9\u4e0a\u3067\u306f\u3001vmware-tools \u306e\u66f4\u65b0\u3092\u884c\u308f\u306a\u3044\u3068\u3001\u30b3\u30f3\u30c8\u30ed\u30fc\u30eb\u30d1\u30cd\u30eb\u4e0a\u3067\u306f\u30a8\u30e9\u30fc\u306b\u306a\u308a\u307e\u3059\u3002\u6b21\u306e\u3088\u3046\u306b\u66f4\u65b0\u3092\u884c\u3044\u307e\u3059\u3002\nhost@ubuntu# /usr/bin/vmware-config-tools.pl --default\n\n\n2. \u30b3\u30f3\u30c6\u30ca\u306e\u8d77\u52d5\n\n2.1. hello world \u3092\u8868\u793a\u3059\u308b\u30b3\u30f3\u30c6\u30ca\n\u30b3\u30f3\u30c6\u30ca\u3092\u8d77\u52d5\u3059\u308b\u306b\u306f docker run \u30b3\u30de\u30f3\u30c9\u3092\u4f7f\u3044\u307e\u3059\u3002ubuntu \u306e\u30d9\u30fc\u30b9\u30a4\u30e1\u30fc\u30b8\u3092\u4f7f\u3044\u3001/bin/echo \u3092\u5b9f\u884c\u3057\u3001\u753b\u9762\u306b\u6587\u5b57\u3092\u8868\u793a\u3057\u307e\u3059\u3002\nhost@ubuntu# docker run ubuntu /bin/echo 'hello world'\nUnable to find image 'ubuntu' locally\nPulling repository ubuntu\ne54ca5efa2e9: Download complete\n511136ea3c5a: Download complete\nd7ac5e4f1812: Download complete\n2f4b4d6a4a06: Download complete\n83ff768040a0: Download complete\n6c37f792ddac: Download complete\nhello world\n\n\u521d\u56de\u306f\u30a4\u30e1\u30fc\u30b8\u306e\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u306b\u6642\u9593\u304c\u304b\u304b\u308a\u307e\u3059\u3002\u6b21\u56de\u4ee5\u964d\u306f\u3001\u30ed\u30fc\u30ab\u30eb\u306b\u30a4\u30e1\u30fc\u30b8\u304c\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u6e08\u307f\u306a\u306e\u3067\u3001\u3059\u3050\u306b\u7acb\u3061\u4e0a\u304c\u308b\u3053\u3068\u304c\u308f\u304b\u308a\u307e\u3059\u3002\nhost@ubuntu# docker run ubuntu /bin/echo 'hello world'\nhello world\n\n\n\u304a\u307e\u3051\uff1a\u6642\u9593\u304c\u3042\u308c\u3070\u3084\u3063\u3066\u307f\u3088\u3046\nhost@ubuntu# docker run -it --rm supertest2014/nyan\n\nctrl+c \u3067\u4e2d\u65ad\u3067\u304d\u307e\u3059\u3002\n\n2.2. CentOS \u30a4\u30e1\u30fc\u30b8\u306e\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3068\u8d77\u52d5\nUbuntu \u4e0a\u3067\u3082 CentOS \u306e\u30b3\u30f3\u30c6\u30ca\u3092\u7a3c\u50cd\u3055\u305b\u308b\u3053\u3068\u304c\u51fa\u6765\u307e\u3059\u3002\u4eca\u5ea6\u306f CentOS \u306e\u30d9\u30fc\u30b9\u30a4\u30e1\u30fc\u30b8\u3092\u3064\u304b\u3063\u3066\u6587\u5b57\u3092\u8868\u793a\u3055\u305b\u3066\u307f\u307e\u3057\u3087\u3046\u3002\nhost@ubuntu# docker run centos /bin/echo 'hello centos'\nUnable to find image 'centos' locally\nPulling repository centos\n1a7dc42f78ba: Pulling image (latest) from centos, endpoint: https://cdn-registry-1.docker.1a7dc42f78ba: Download complete\n511136ea3c5a: Download complete\n34e94e67e63a: Download complete\nhello centos\n\n\u307e\u305f\u3001\u5404\u30a4\u30e1\u30fc\u30b8\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u3092\u78ba\u8a8d\u3059\u308b\u4e8b\u3082\u3067\u304d\u307e\u3059\u3002\nhost@ubuntu# docker run ubuntu cat /etc/issue\nhost@ubuntu# docker run centos cat /etc/issue\n\n\n2.3. \u30b3\u30f3\u30c6\u30ca\u306e\u53d6\u5f97 (pull)\ndocker pull \u3092\u4f7f\u3046\u3068\u3001\u6307\u5b9a\u3057\u305f/\u95a2\u9023\u3059\u308b\u30b3\u30f3\u30c6\u30ca\u306e\u30a4\u30e1\u30fc\u30b8\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3067\u304d\u307e\u3059\u3002\u6b21\u306e\u30b3\u30de\u30f3\u30c9\u306f\u3001CentOS \u306e\u6700\u65b0\u7248 ( CentOS 7 ) \u306e\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3067\u3059\u3002\nhost@ubuntu# docker pull centos:latest\nPulling repository centos\n1a7dc42f78ba: Pulling image (latest) from centos, endpoint: https://cdn-registry-1.docker.1a7dc42f78ba: Download complete\n511136ea3c5a: Download complete\n34e94e67e63a: Download complete\n\n\n2.4. \u30b3\u30f3\u30c6\u30ca\u306b\u30ed\u30b0\u30a4\u30f3\u3059\u308b\n\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3057\u305f\u30b3\u30f3\u30c6\u30ca\u3092\u4f7f\u3044\u3001\u30b3\u30f3\u30c6\u30ca\u306e\u4e2d\u306b\u5165\u308b\u306b\u306fdocker run\u306b -t \u3068 -i \u306e\u30aa\u30d7\u30b7\u30e7\u30f3\u3092\u4ed8\u3051\u307e\u3059\u3002\nhost@ubuntu# docker run -t -i ubuntu:14.04 /bin/bash\nUnable to find image 'ubuntu:14.04' locally\nPulling repository ubuntu\ne54ca5efa2e9: Download complete\n511136ea3c5a: Download complete\nd7ac5e4f1812: Download complete\n2f4b4d6a4a06: Download complete\n83ff768040a0: Download complete\n6c37f792ddac: Download complete\nroot@2ad166fc3787:/#\n\n\u3053\u308c\u3067\u30b3\u30f3\u30c6\u30ca\u306e\u4e2d\u3067\u64cd\u4f5c\u304c\u3067\u304d\u307e\u3059\u3002\u30d7\u30ed\u30f3\u30d7\u30c8\u306b\u8868\u793a\u3055\u308c\u3066\u3044\u308b 2ad166fc3787 \u306f\u30b3\u30f3\u30c6\u30ca ID \u3068\u547c\u3070\u308c\u308b\u3082\u306e\u3067\u3001\u30b3\u30f3\u30c6\u30ca\uff11\u3064\uff11\u3064\u306b\u5bfe\u3057\u3066\u5272\u308a\u5f53\u3066\u3089\u308c\u307e\u3059\u3002\n\u3053\u3053\u3067\u6307\u5b9a\u3057\u305f -t \u306f\u4eee\u60f3 tty \u3092\u65b0\u3057\u3044\u30b3\u30f3\u30c6\u30ca\u306b\u5272\u308a\u5f53\u3066\u3001-i \u306f\u30b3\u30f3\u30c6\u30ca\u306e\u6a19\u6e96\u5165\u529b(STDNIN)\u3092\u53cc\u65b9\u5411(interactive)\u306b\u53d6\u5f97\u3057\u307e\u3059\u3002\u305d\u3057\u3066\u3001\u30b7\u30a7\u30eb /bin/bash \u306b\u51e6\u7406\u3092\u6e21\u3057\u307e\u3057\u305f\u3002\n\n2.5. \u30b3\u30f3\u30c6\u30ca\u306e\u4e2d\u3067\u57fa\u672c\u7684\u306a\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\nroot@2ad166fc3787:/# pwd\n/\nroot@2ad166fc3787:/# ls\nbin   dev  home  lib64  mnt  proc  run   srv  tmp  var\nboot  etc  lib   media  opt  root  sbin  sys  usr\nroot@2ad166fc3787:/# ps ax\n  PID TTY      STAT   TIME COMMAND\n    1 ?        Ss     0:00 /bin/bash\n   13 ?        R+     0:00 ps ax\n\n\u30b3\u30f3\u30c6\u30ca\u304b\u3089\u306f exit \u3067\u629c\u3051\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n2.6. \u30b3\u30f3\u30c6\u30ca\u306e\u4e00\u89a7\u3092\u8868\u793a\ndocker ps \u3067\u30b3\u30f3\u30c6\u30ca\u306e\u4e00\u89a7\u3092\u8868\u793a\u3057\u307e\u3059\u3002\nroot@container# docker ps\n\n\u73fe\u5728\u7a3c\u50cd\u4e2d\u306e\u30b3\u30f3\u30c6\u30ca\u304c\u8868\u793a\u3055\u308c\u307e\u3059\u3002CONTAINER ID\u306b\u8868\u793a\u3055\u308c\u308b 12 \u6841\u306e\u6587\u5b57\u5217\u304c\u3001\u30b3\u30f3\u30c6\u30ca ID \u3068\u547c\u3070\u308c\u308b\u3082\u306e\u3067\u3001\u30b3\u30f3\u30c6\u30ca\u306e\u8d77\u52d5\u3084\u505c\u6b62\u306e\u969b\u306b\u5fc5\u305a\u5fc5\u8981\u3068\u306a\u308a\u307e\u3059\u3002\nroot@container# dockr ps -a\n\n\u3053\u3061\u3089\u306f\u3001\u505c\u6b62\u3057\u305f\u3082\u306e\u3001\u53e4\u3044\u3082\u306e\u3082\u542b\u3081\u3066\u5168\u3066\u304c\u8868\u793a\u3055\u308c\u307e\u3059\u3002\u65b0\u3057\u3044\u3082\u306e\u304c\u4e0a\u306b\u8868\u793a\u3055\u308c\u307e\u3059\u306e\u3067\u3001head \u3068\u7d44\u307f\u3042\u308f\u305b\u308b\u3068\u697d\u3067\u3059\u3002\n\n\u5b9f\u884c\u4f8b\nroot@ubuntu:~# docker ps -a\nCONTAINER ID        IMAGE               COMMAND                CREATED             STATUS                      PORTS               NAMES\n31a2629738e9        ubuntu:14.04        /bin/bash              3 minutes ago       Exited (0) 2 seconds ago                        cranky_hypatia\n2ad166fc3787        ubuntu:14.04        /bin/bash              7 minutes ago       Exited (0) 4 minutes ago                        hopeful_archimedes\n\n\n\u306a\u304a\u3001\u30b3\u30f3\u30c6\u30ca\u306b\u30ed\u30b0\u30a4\u30f3\u4e2d\u3001\u4e00\u6642\u7684\u306b\u629c\u3051\u308b\u306b\u306f\u3001\nroot@ubuntu:~# docker run -t -i ubuntu:14.04 /bin/bash\nroot@351e58d51464:/#\n\uff08ctrl +p , q \u3067\u4e00\u6642\u7684\u306b\u96e2\u8131\uff09\n\n\u5fa9\u5e30\u306fdocker attach\u306e\u5f8c\u3001\u30a8\u30f3\u30bf\u30fc\u30fb\u30ad\u30fc\u3092 2\u56de \u62bc\u3057\u307e\u3059(\u30b3\u30f3\u30c6\u30ca\u306e\u6a19\u6e96\u5165\u51fa\u529b\u306b\u63a5\u7d9a\u3057\u307e\u3059\u304c\u3001\u63a5\u7d9a\u76f4\u5f8c\u306f\u30db\u30b9\u30c8\u5074\u3068\u76f8\u4e92\u306b\u3084\u308a\u3068\u308a\u304c\u306a\u3044\u305f\u3081\u3067\u3059\u3002\u3053\u3061\u3089\u304b\u3089\u30a8\u30f3\u30bf\u30fc\u7b49\u3001\u4f55\u3089\u304b\u306e\u60c5\u5831\u3092\u9001\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059)\u3002\nroot@ubuntu:~# docker attach 351e58d51464\n(\u2605\u3082\u3046\u4e00\u5ea6\u30a8\u30f3\u30bf\u30fc\nroot@351e58d51464:/#\n\n\u3053\u308c\u3067\u30b3\u30f3\u30c6\u30ca\u306e\u4e2d\u306b\u623b\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n2.7. commit \u3057\u3066\u30a4\u30e1\u30fc\u30b8\u306e\u5185\u5bb9\u3092\u78ba\u5b9a\u3059\u308b\n\u901a\u5e38\u306f\u3001\u30b3\u30f3\u30c6\u30ca\u306e\u4e2d\u3067\u30d5\u30a1\u30a4\u30eb\u3092\u66f8\u304d\u8fbc\u3093\u3060\u308a\u66f4\u65b0\u3092\u52a0\u3048\u3066\u3082\u3001 commit \u3057\u306a\u3044\u3068\u5185\u5bb9\u304c\u53cd\u6620\u3055\u308c\u307e\u305b\u3093\u3002\u305f\u3068\u3048\u3070\nroot@351e58d51464:/# echo test > /test\nroot@351e58d51464:/# cat /test\ntest\n\nroot@351e58d51464:/# exit\nexit\n\n\u3053\u306e\u3088\u3046\u306b\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u6210\u3057\u3066\u3082\u3001\u518d\u5ea6\u30b3\u30f3\u30c6\u30ca\u3092\u8d77\u52d5\u3057\u3088\u3046\u3068\u3057\u3066\u3082\u3001/test \u3068\u3044\u3046\u30d5\u30a1\u30a4\u30eb\u306f\u5b58\u5728\u3057\u306a\u304b\u3063\u305f\u3053\u3068\u306b\u306a\u308a\u307e\u3059\u3002\n\u5909\u66f4\u5185\u5bb9\u3092\u5185\u5bb9\u3092\u78ba\u5b9a\u3059\u308b\u30b3\u30de\u30f3\u30c9\u304c docker commit \u3067\u3059\u3002\n\u4ee5\u4e0b\u306f\u30b3\u30f3\u30c6\u30ca ID 351e58d51464 \u306bubuntu-test\u3068\u3044\u3046\u30bf\u30b0\u3092\u4ed8\u3051\u3066\u4fdd\u5b58\u3059\u308b\u4f8b\u3067\u3059\u3002\nroot@ubuntu:~# docker commit 351e58d51464 ubuntu-test\nb4e346166aeaf579fb3214a3814dcc3a250f4f58cf83c88d4b66a8cf030902ab\n\n\u3053\u3053\u3067\u8868\u793a\u3055\u308c\u305f\u6587\u5b57\u5217\u306f\u3001\u30b3\u30f3\u30c6\u30ca\u306e\u30a4\u30e1\u30fc\u30b8 ID \u3067\u3059\u3002docker images \u3067\u3082\u78ba\u8a8d\u3067\u304d\u307e\u3059\u3002\nroot@ubuntu:~# docker  images\nREPOSITORY             TAG                 IMAGE ID            CREATED             VIRTUAL SIZE\nubuntu-test            latest              b4e346166aea        10 seconds ago      276.5 MB\n\n\u3053\u3053\u3067\u4f5c\u6210\u3057\u305f ubuntu-test \u3092\u4f7f\u3063\u3066\u30b3\u30f3\u30c6\u30ca\u3092\u8d77\u52d5\u3059\u308b\u3068\u3001\u5185\u5bb9\u304c\u53cd\u6620\u3055\u308c\u3066\u3044\u307e\u3059\u3002\nroot@ubuntu:~# docker run -i -t ubuntu-test /bin/bash\nroot@e8f8cc1be69d:/# cat /test\ntest\n\n\n3. Apache \u304c\u52d5\u4f5c\u3059\u308b\u30b3\u30f3\u30c6\u30ca\u3092\u4f5c\u6210\n\n3.1. CentOS 6.5 \u306e\u30a4\u30e1\u30fc\u30b8\u3092\u4f7f\u3046\nCentOS \u3092\u8d77\u52d5\u3059\u308b\u969b\u3001docker run -i -t centos /bin/bash \u3068\u4f55\u3082\u8003\u3048\u305a\u306b\u5b9f\u884c\u3059\u308b\u3068\u3001CentOS 7 \u304c\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\u3055\u308c\u307e\u3059\u3002\nbash-4.2# cat /etc/centos-release\nCentOS Linux release 7.0.1406 (Core)\n\n\u4eca\u56de\u306f centos 6.5 \u3092\u4f7f\u3044\u305f\u3044\u306e\u3067\u3001\u307e\u305a\u306f CentOS \u306e\u30a4\u30e1\u30fc\u30b8\u3092\u53d6\u5f97\u3057\u3066\u307f\u307e\u3057\u3087\u3046\u3002docker pull centos\u3092\u5b9f\u884c\u3057\u307e\u3059\u3002\nhost@ubuntu# docker pull centos\nPulling repository centos\ncd934e0010d5: Download complete\n1a7dc42f78ba: Download complete\n511136ea3c5a: Download complete\n34e94e67e63a: Download complete\nhost@ubuntu# docker images centos\nREPOSITORY          TAG                 IMAGE ID            CREATED             VIRTUAL SIZE\ncentos              centos7             1a7dc42f78ba        8 days ago          236.4 MB\ncentos              latest              1a7dc42f78ba        8 days ago          236.4 MB\ncentos              centos6             cd934e0010d5        9 days ago          206.9 MB\n\n\u3053\u306e\u3088\u3046\u306b docker images centos \u3068\u5165\u529b\u3059\u308b\u3068\u3001centos7 \u3068 centos6 \u3068\u30bf\u30b0\u304c\u4ed8\u3044\u3066\u3044\u308b\u3053\u3068\u304c\u5206\u304b\u308a\u307e\u3059\uff08\u53c2\u8003\uff1ahttp://wiki.centos.org/Cloud/Docker\uff09\n\u3053\u306e\u3053\u3068\u304b\u3089\u3001centos \u306e\u30d9\u30fc\u30b9\u30a4\u30e1\u30fc\u30b8\u4f7f\u7528\u6642\u3001centos6 \u306e\u30bf\u30b0\u3092\u6307\u5b9a\u3059\u308b\u3053\u3068\u3067\u3001CentOS 6 \u306e\u30b3\u30f3\u30c6\u30ca\u304c\u8d77\u52d5\u3067\u304d\u307e\u3059\u3002\nhost@ubuntu# docker run -t -i centos:centos6 /bin/bash\ncontainer@bash-4.1# cat /etc/centos-release\nCentOS release 6.5 (Final)\n\n\n3.2. Apache \u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\u305d\u308c\u3067\u306f\u3001Apache \u3092\u8d77\u52d5\u3057\u3001\u30d6\u30e9\u30a6\u30b6\u306b Nifty \u3068\u8868\u793a\u3055\u305b\u3066\u307f\u307e\u3057\u3087\u3046\u3002\n\u5f15\u304d\u7d9a\u304d\u30b3\u30f3\u30c6\u30ca\u306e\u4e2d\u3067\u4f5c\u696d\u3057\u307e\u3059\u3002\ncontainer@bash-4.1# yum -y install httpd\n\nApache \u8d77\u52d5\u30c6\u30b9\u30c8\ncontainer@bash-4.1# service httpd start\nStarting httpd: httpd: Could not reliably determine the server's fully qualified domain name, using 172.17.0.15 for ServerName\n                                                           [  OK  ]\n\n\u3053\u308c\u3067\u3001\u30b3\u30f3\u30c6\u30ca\u306e\u4e2d\u3067 Apache \u304c\u8d77\u52d5\u3057\u307e\u3057\u305f\u3002\n\u6b21\u306b\u3001\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u30eb\u30fc\u30c8\u306b\u30d5\u30a1\u30a4\u30eb\u3092\u7f6e\u304d\u307e\u3059\u3002\ncontainer@bash-4.1# echo 'Nifty' > /var/www/html/index.html\ncontainer@bash-4.1# cat /var/www/html/index.html\nNifty\n\n\u3067\u3059\u304c\u3001\u3053\u306e\u307e\u307e\u3067\u306f\u30d6\u30e9\u30a6\u30b6\u304b\u3089\u52d5\u4f5c\u78ba\u8a8d\u3067\u304d\u307e\u305b\u3093\u3002\n\u30b3\u30f3\u30c6\u30ca\u5185\u306e Apache \u30dd\u30fc\u30c880 \u3092\u3001\u30db\u30b9\u30c8\u4e0a\u3068\u5bfe\u5fdc\u3055\u305b\u308b\u306b\u306f\u3001-p \u3067\u30dd\u30fc\u30c8\u306e\u8a2d\u5b9a\u3092\u884c\u3044\u307e\u3059\u3002\n\u4e00\u65e6\u30b3\u30f3\u30c6\u30ca\u304b\u3089\u629c\u3051\u307e\u3059\u3002\ncontainer@bash-4.1# exit\nexit\n\ndocker ps -a \u3067\u6700\u5f8c\u306b\u8d77\u52d5\u3057\u305f\u30b3\u30f3\u30c6\u30ca ID \u3092\u898b\u3064\u3051\u307e\u3059\u3002\nhost@ubuntu# docker ps -a\nCONTAINER ID        IMAGE               COMMAND                CREATED             STATUS                           PORTS                NAMES\n011d4e7c710a        centos:centos6      /bin/bash              3 minutes ago       Exited (0) 28 seconds ago                             grave_elion\n\n\u3053\u308c\u3092 commit\u3057\u3066\u30a4\u30e1\u30fc\u30b8\u3092\u4fdd\u7ba1\u3057\u307e\u3059\u3002\nhost@ubuntu# docker commit 011d4e7c710a nifty\nfc1302aef7d77dd1d1523c51570b7a16ee832e75f2f1981dcfac77844bc9a874\n\ndocker run \u306b -p 80:80\u30aa\u30d7\u30b7\u30e7\u30f3\u3092\u4ed8\u3051\u3066\u3001\u30db\u30b9\u30c8\u5074\u3068\u30b3\u30f3\u30c6\u30ca\u5074\u306e Port 80 \u3092\u3064\u306a\u304e\u307e\u3059\u3002\nhost@ubuntu# docker run -i -t -p 80:80 nifty /bin/bash\ndbc0637214199f35324ef9963ba5f77d70e0543a740325775e4768d1dc9a219c\n\n\u30b3\u30f3\u30c6\u30ca\u306e\u4e2d\u3067\u518d\u3073 Apache \u3092\u8d77\u52d5\u3057\u307e\u3059\u3002\ncontainer@bash-4.1# service httpd start\nStarting httpd: httpd: Could not reliably determine the server's fully qualified domain name, using 172.17.0.23 for ServerName\n                                                           [  OK  ]\n\n\u30d6\u30e9\u30a6\u30b6\u304b\u3089 http://\u30cb\u30d5\u30c6\u30a3\u30af\u30e9\u30a6\u30c9\u306eIP\u30a2\u30c9\u30ec\u30b9/ \u306b\u30a2\u30af\u30bb\u30b9\u3059\u308b\u3068\u3001\u753b\u9762\u306b Nifty \u304c\u8868\u793a\u3055\u308c\u307e\u3059\u3002\u30db\u30b9\u30c8\u5074\u306e\u30dd\u30fc\u30c8 80 \u3068\u3001\u30b3\u30f3\u30c6\u30ca\u306e\u4e2d\u306e\u30dd\u30fc\u30c8 80 \u304c\u5bfe\u5fdc\u3057\u305f\u304b\u3089\u3067\u3059\u3002\n\u3053\u306e\u3088\u3046\u306b\u3001\u901a\u5e38\u3001\u30b3\u30f3\u30c6\u30ca\u306e\u4e2d\u306e\u30dd\u30fc\u30c8\u3068\u30db\u30b9\u30c8\u5074\u306e\u30dd\u30fc\u30c8\u3092\u5bfe\u5fdc\u3055\u305b\u308b\u306b\u306f\u3001\u624b\u52d5\u3067\u660e\u793a\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\n\n4. Docker \u30b3\u30f3\u30c6\u30ca\u306e\u30a4\u30e1\u30fc\u30b8\u3092\u51fa\u529b (export)\n\u3055\u3066\u3001\u305d\u308c\u3067\u306f\u30b3\u30f3\u30c6\u30ca\u3092\u4ed6\u306e\u30af\u30e9\u30a6\u30c9\uff08\u3053\u3053\u3067\u306f\u3055\u304f\u3089\u306e\u30af\u30e9\u30a6\u30c9\uff09\u306b\u79fb\u52d5\u3059\u308b\u305f\u3081\u306e\u6e96\u5099\u3092\u9032\u3081\u307e\u3059\u3002\u30b3\u30f3\u30c6\u30ca\u3092\u79fb\u52d5\u3055\u305b\u308b\u306b\u306f\u3001\u3044\u304f\u3064\u304b\u306e\u65b9\u6cd5\u304c\u3042\u308a\u307e\u3059\u304c\u3001\u3053\u3053\u3067\u306f\u30a4\u30e1\u30fc\u30b8\u3092\u30d5\u30a1\u30a4\u30eb\u3068\u3057\u3066\u51fa\u529b\u3057\u3001\u305d\u308c\u3092\u79fb\u52d5\u3059\u308b\u65b9\u6cd5\u3092\u4f7f\u3044\u307e\u3059\u3002\n\n4.1. \u30b3\u30f3\u30c6\u30ca ID \u306e\u78ba\u8a8d\ndocker ps -a \u3067\u5bfe\u8c61\u306e\u30b3\u30f3\u30c6\u30caID \u3092\u78ba\u8a8d\u3057\u307e\u3059\nhost@ubuntu# docker ps -a\n    CONTAINER ID        IMAGE               COMMAND                CREATED             STATUS                           PORTS                NAMES\n    011d4e7c710a        centos:centos6      /bin/bash              3 minutes ago       Exited (0) 28 seconds ago                             grave_elion\n\n\n4.2. docker export \u306e\u5b9f\u884c\ndocker export\u30b3\u30de\u30f3\u30c9\u306f\u3001\u30a4\u30e1\u30fc\u30b8\u5185\u5bb9\u3092\u6a19\u6e96\u51fa\u529b\u306b\u51fa\u529b\u3059\u308b\u3082\u306e\u3067\u3059\u3002\u30ea\u30c0\u30a4\u30ec\u30af\u30c8\u3057\u3066\u3001\u30d5\u30a1\u30a4\u30eb\u306b\u66f8\u304d\u51fa\u3057\u307e\u3059\u3002\nhost@ubuntu# docker export 011d4e7c710a > nifty.tar\n\n\u3053\u308c\u3067\u3001\u30a4\u30e1\u30fc\u30b8ID 011d4e7c710a \u306e\u5185\u5bb9\u304cnifty.tar\u306b\u51fa\u529b\u3055\u308c\u307e\u3057\u305f\u3002\n\n4.3. export \u3057\u305f\u30a4\u30e1\u30fc\u30b8\u3092\u3055\u304f\u3089\u306e\u30af\u30e9\u30a6\u30c9\u3078\u79fb\u52d5\nscp \u30b3\u30de\u30f3\u30c9\u3092\u4f7f\u3044\u3001\u3055\u304f\u3089\u306e\u30af\u30e9\u30a6\u30c9\u306e\u30db\u30b9\u30c8\u4e0a\u306b\u8ee2\u9001\u3057\u307e\u3059\u3002\nhost@ubuntu$ scp ./nifty.tar root@<\u3055\u304f\u3089\u306eIP\u30a2\u30c9\u30ec\u30b9>:/tmp/\n\n\u3042\u3068\u306f\u3001\u3055\u304f\u3089\u5074\u3067\u8ee2\u9001\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\u5bfe\u8c61\u30b5\u30fc\u30d0\u306b SSH \u30ed\u30b0\u30a4\u30f3\u3057\u3001/tmp \u4ee5\u4e0b\u306b\u30d5\u30a1\u30a4\u30eb\u304c\u3042\u308b\u304b\u3069\u3046\u304b\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\n[root@sakura2 /]# ll /tmp/\n\u5408\u8a08 372656\n-rw-r--r-- 1 root root 381596672  7\u6708 18 15:00 2014 nifty.tar\n\n\n5. \u3055\u304f\u3089\u306e\u30af\u30e9\u30a6\u30c9\u3067 Docker \u306e\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7 ( CentOS 6.5 )\n\u6b21\u306f\u3001CentOS 6.5 \u4e0a\u3067 Docker \u3092\u4f7f\u3048\u308b\u3088\u3046\u306b\u3057\u307e\u3059\u3002\n\n5.1. docker-io \u30d1\u30c3\u30b1\u30fc\u30b8\u306e\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\nyum \u3092\u4f7f\u3063\u3066\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\u3057\u307e\u3059\u3002\nhost@centos# yum install docker-io\n\n\u203b\u3055\u304f\u3089\u306e\u30af\u30e9\u30a6\u30c9\u3067\u306f\u3001\u521d\u671f\u72b6\u614b\u304b\u3089 EPEL \u30d1\u30c3\u30b1\u30fc\u30b8\u304c\u6709\u52b9\u3067\u3059\u3002\u3082\u3057\u3001\u6709\u52b9\u3067\u306f\u306a\u3044\u74b0\u5883\u3067\u306f\u3001\u4e88\u3081\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\u304c\u5fc5\u8981\u3067\u3059\u3002\n\n5.2. Docker \u306e\u8d77\u52d5\nhost@centos# service docker start\nStarting cgconfig service:                                 [  OK  ]\nStarting docker:                                           [  OK  ] \n\n\u3053\u308c\u3067\u8d77\u52d5\u5b8c\u4e86\u3067\u3059\u3002\u30d0\u30fc\u30b8\u30e7\u30f3\u756a\u53f7\u3092\u78ba\u8a8d\u3057\u307e\u3057\u3087\u3046\u3002\nhost@centos# docker  --version\nDocker version 1.0.0, build 63fe64c/1.0.0\n\n\u305d\u3057\u3066\u3001Docker \u304c\u3001\u30d6\u30fc\u30c8\u6642\u306b\u81ea\u52d5\u8d77\u52d5\u304c\u6709\u52b9\u5316\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\nhost@centos# chkconfig --list docker\ndocker          0:off   1:off   2:on    3:on    4:on    5:on    6:off\n\n\n6. \u5916\u90e8\u306e Docker \u30a4\u30e1\u30fc\u30b8\u3092\u53d6\u308a\u8fbc\u3093\u3067\u3001\u30b3\u30f3\u30c6\u30ca\u3092\u8d77\u52d5\n\u30cb\u30d5\u30c6\u30a3\u30af\u30e9\u30a6\u30c9\u3067\u4f5c\u6210\u3057\u305f\u30b3\u30f3\u30c6\u30ca\u306e\u30a4\u30e1\u30fc\u30b8\u3092\u3001\u3055\u304f\u3089\u4e0a\u306e Docker \u3067\u52d5\u304b\u3057\u307e\u3059\u3002\n\n6.1. \u30a4\u30e1\u30fc\u30b8\u306e\u53d6\u308a\u8fbc\u307f (import)\n\u53d6\u308a\u8fbc\u3080\u305f\u3081\u306b\u306f docker import \u3092\u4f7f\u3044\u307e\u3059\u3002\nscp \u3067\u8ee2\u9001\u3057\u3066\u3066\u3042\u308b\u30a4\u30e1\u30fc\u30b8\u30d5\u30a1\u30a4\u30eb\u306f /tmp/nifty.tar \u3067\u3059\u3002\u3053\u308c\u3092\u53d6\u308a\u8fbc\u3080\u306b\u306f\u3001\u6b21\u306e\u3088\u3046\u306b\u3057\u307e\u3059\u3002\u3053\u3053\u3067\u306f docker impoart \u306e\u3042\u3068\u3067\u3001\u30a4\u30e1\u30fc\u30b8\u306e\u30bf\u30b0\u540d\u79f0\u3092 nifty \u3068\u6307\u5b9a\u3057\u307e\u3059\u3002\nhost@centos# cat /tmp/nifty.tar | docker import - nifty\n8f8b42ee46a3d9d4add809b78ba6221b04c6dae3a750c2afe68f7e46685a642e\n\n\u53d6\u308a\u8fbc\u307e\u308c\u308b\u3068\u3001\u65b0\u305f\u306b\u30a4\u30e1\u30fc\u30b8 ID \u304c\u4ed8\u4e0e\u3055\u308c\u307e\u3059\u3002docker images \u30b3\u30de\u30f3\u30c9\u3067\u3082\u78ba\u8a8d\u304c\u51fa\u6765\u307e\u3059\u3002\nhost@centos# docker images\nREPOSITORY          TAG                 IMAGE ID            CREATED             VIRTUAL SIZE\nnifty               latest              8f8b42ee46a3        14 seconds ago      369.6 MB\n\n\n6.2. \u53d6\u308a\u8fbc\u3093\u3060\u30a4\u30e1\u30fc\u30b8\u3092\u4f7f\u3063\u3066\u8d77\u52d5\n\u4e00\u5ea6\u30a4\u30e1\u30fc\u30b8\u3068\u3057\u3066\u8a8d\u8b58\u3055\u308c\u3066\u3057\u307e\u3048\u3070\u3001\u5148\u307b\u3069\u306e\u30b3\u30f3\u30c6\u30ca\u8d77\u52d5\u3068\u624b\u9806\u306f\u5909\u308f\u308a\u307e\u305b\u3093\u3002\u8d77\u52d5\u6642\u306b nifty \u3068\u3044\u3046\u30bf\u30b0\u3092\u6307\u5b9a\u3057\u307e\u3059\u3002\nhost@centos# docker run -t -i -d -p 80:80 nifty /bin/bash\n\n\u4eca\u5ea6\u306f -d \u30aa\u30d7\u30b7\u30e7\u30f3\u3092\u4ed8\u3051\u3066\u30c7\u30fc\u30e2\u30f3\u30e2\u30fc\u30c9\u3067\u8d77\u52d5\u3057\u307e\u3057\u305f\u3002\n\u3053\u306e\u307e\u307e\u3067\u306f apache \u304c\u8d77\u52d5\u3057\u3066\u3044\u306a\u3044\u305f\u3081 docker attach \u30b3\u30de\u30f3\u30c9\u3067\u3001\u30b3\u30f3\u30c6\u30ca\u306b\u63a5\u7d9a\u3057\u307e\u3059\u3002\n\u307e\u305a docker ps \u30b3\u30de\u30f3\u30c9\u3067\u3001\u30b3\u30f3\u30c6\u30ca ID \u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\nhost@centos# docker ps\nCONTAINER ID        IMAGE                   COMMAND             CREATED             STATUS              PORTS                NAMES\n3a7fd68ca680        zembutsu/nifty:latest   /bin/bash           5 seconds ago       Up 4 seconds        0.0.0.0:80->80/tcp   loving_kirch\n\n\u305d\u3057\u3066\u3001\u30b3\u30de\u30f3\u30c9 docker attach \u3068\u5165\u529b\u3057\u305f\u3042\u3068\u306f\u3001\u30a8\u30f3\u30bf\u30fc\u30ad\u30fc\u30922\u56de\u62bc\u3057\u307e\u3059\u3002\nhost@centos# docker attach 3a7fd68ca680\n\nbash-4.1#\n\n\u3053\u308c\u3067\u30b3\u30f3\u30c6\u30ca\u306e\u4e2d\u306b\u5165\u308a\u307e\u3057\u305f\u3002\u3042\u3068\u306f service httpd start \u3068\u5b9f\u884c\u3057\u3001Apache \u3092\u8d77\u52d5\u3057\u307e\u3059\u3002\ncontainer@centos# service httpd start\nStarting httpd: httpd: Could not reliably determine the server's fully qualified domain name, using 172.17.0.2 for ServerName\n                                                   [  OK  ]\n\n\u3053\u308c\u3067\u3001\u30d6\u30e9\u30a6\u30b6\u304b\u3089\u3055\u304f\u3089\u306e IP \u30a2\u30c9\u30ec\u30b9\u306b\u30a2\u30af\u30bb\u30b9\u3059\u308b\u3068\u3001\u753b\u9762\u306b\u300c Nifty \u300d\u3068\u8868\u793a\u3055\u308c\u307e\u3059\u3002\n\u306a\u304a\u3001\u30b3\u30f3\u30c6\u30ca\u5185\u306e /var/www/html/index.html \u306e\u4e2d\u8eab\u3092 sakura \u7b49\u306b\u66f8\u304d\u63db\u3048\u308b\u3068\u3001\u5909\u66f4\u5185\u5bb9\u304c\u53cd\u6620\u3055\u308c\u308b\u4e8b\u304c\u78ba\u8a8d\u3067\u304d\u307e\u3059\u3002\n\u3053\u306e\u5909\u66f4\u5185\u5bb9\u3092\u30a4\u30e1\u30fc\u30b8\u3068\u3057\u3066\u4fdd\u5b58\u3059\u308b\u5834\u5408\u306f\u3001docker commit\u3092\u5fd8\u308c\u305a\u306b\u884c\u3044\u307e\u3059\u3002\n\u306a\u304a\u3001\u30c7\u30fc\u30e2\u30f3\u5316\u3055\u308c\u305f\u30b3\u30f3\u30c6\u30ca\u306e\u505c\u6b62\u306f\u3001docker stop \u30b3\u30f3\u30c6\u30caID \u3067\u3059\u3002\n\n7. Dockerfile \u3067 Apache \u304c\u52d5\u304f\u30b3\u30f3\u30c6\u30ca\u3092\u4f5c\u6210\n\u3053\u308c\u307e\u3067\u624b\u52d5\u3067\u30b3\u30f3\u30c6\u30ca\u3092\u4f5c\u6210\u3057\u3066\u304d\u307e\u3057\u305f\u3002\u3082\u3057\u3001\u30b3\u30f3\u30c6\u30ca\u3092\u8907\u6570\u4f5c\u6210\u3057\u305f\u3044\u5834\u5408\u306f\u3001\u5927\u5909\u3067\u3059\u3002\u305d\u3053\u3067\u3001Dockerfile \u3068\u3044\u3046\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3092\u4f7f\u3044\u3001\u30a4\u30e1\u30fc\u30b8\u3092\u4f5c\u6210\u3059\u308b\u65b9\u6cd5\u3092\u8a66\u3057\u307e\u3057\u3087\u3046\u3002\n\u3072\u304d\u3064\u3065\u304d\u3001\u3055\u304f\u3089\u306e\u30af\u30e9\u30a6\u30c9\u4e0a\u3067\u4f5c\u696d\u3092\u884c\u3044\u307e\u3059\u3002\n\n7.1. \u4f5c\u696d\u7528\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306e\u4f5c\u6210\nhost@centos# mkdir /root/docker\nhost@centos# cd /root/docker\n\n\n7.2. Dockerfile \u3092\u4f5c\u6210\nhost@centos# touch Dockerfile\nhost@centos# vi Dockerfile\n\n\u3053\u3053\u3067\u306f vi \u3068\u3057\u307e\u3057\u305f\u304c\u3001\u597d\u304d\u306a\u30a8\u30c7\u30a3\u30bf\u3092\u3064\u304b\u3063\u3066\u7de8\u96c6\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\nDockerfile\nFROM centos:centos6\nMAINTAINER 0.1. NAME, NAME@example.jp\nRUN echo 'ZONE=\"Asia/Tokyo\"' > /etc/sysconfig/clock\n\nRUN rpm --import http://dl.fedoraproject.org/pub/epel/RPM-GPG-KEY-EPEL-6\nRUN yum -y install httpd\nRUN echo 'sakura' > /var/www/html/index.html\n\nEXPOSE 80\n\nENTRYPOINT [\"/usr/sbin/httpd\"]\nCMD [\"-D\", \"FOREGROUND\"]\n\n\n\u203b\u5185\u5bb9\u306f\u3001\u3053\u308c\u307e\u3067\u624b\u4f5c\u696d\u3067\u884c\u3063\u3066\u304d\u305f\u4e8b\u3092\u3001\u6c4e\u7528\u5316\u3057\u305f\u3082\u306e\u3067\u3059\u3002\n\n7.3. docker build \u3067\u30a4\u30e1\u30fc\u30b8\u3092\u4f5c\u6210\ndocker build \u3092\u4f7f\u3044\u3001Dockerfile \u304b\u3089\u30a4\u30e1\u30fc\u30b8\u3092\u69cb\u7bc9\u3057\u307e\u3059\u3002\u4f5c\u6210\u6642\u3001-t sakura\u3068\u3057\u3066\u30bf\u30b0\u3092\u3064\u3051\u3001Dockerfile \u306e\u5834\u6240\u306f . (\u30ab\u30ec\u30f3\u30c8\u30c7\u30a3\u30ec\u30af\u30c8\u30ea) \u3092\u6307\u5b9a\u3057\u307e\u3059\u3002\nhost@centos# docker build -t sakura .\nSending build context to Docker daemon  2.56 kB\nSending build context to Docker daemon\nStep 0 : FROM centos:centos6\n ---> cd934e0010d5\n(\u7565)\nRemoving intermediate container c3cb9248cd23\n\nSuccessfully built fb4e8342e368\n\n\n7.4. Dockerfile \u3067\u4f5c\u6210\u3057\u305f\u30a4\u30e1\u30fc\u30b8\u4f7f\u3044\u30b3\u30f3\u30c6\u30ca\u8d77\u52d5\n\u4e00\u5ea6\u30a4\u30e1\u30fc\u30b8\u3092\u4f5c\u6210\u3057\u3066\u3057\u307e\u3048\u3070\u3001\u901a\u5e38\u306e\u30b3\u30f3\u30c6\u30ca\u8d77\u52d5\u3068\u5909\u308f\u308a\u307e\u305b\u3093\u3002\u30bf\u30b0\u306b sakura \u3068\u6307\u5b9a\u3057\u307e\u3059\u3002\nhost@centos# docker run -p 80:80 -d sakura\nccd43daa046d012461c25a5ec0aa465ad6d308815923049d7f53f458cb3780f2\n\nhost@centos# docker ps\nCONTAINER ID        IMAGE                     COMMAND                CREATED             STATUS              PORTS                NAMES\nccd43daa046d        sakura:latest             /usr/sbin/httpd -D F   3 seconds ago       Up 2 seconds        0.0.0.0:80->80/tcp   silly_brown\n\n\u30d6\u30e9\u30a6\u30b6\u304b\u3089 http://\u3055\u304f\u3089\u306e IP \u30a2\u30c9\u30ec\u30b9/ \u306b\u30a2\u30af\u30bb\u30b9\u3059\u308b\u3068\n\u753b\u9762\u306b sakura \u3068\u8868\u793a\u3055\u308c\u307e\u3059\u3002\n\n8. PukiWiki \u306e\u30b3\u30f3\u30c6\u30ca\u3092\u4f5c\u6210\u3059\u308b\n\u6b21\u306b\u3001\u52d5\u7684\u306a\u30b3\u30f3\u30c6\u30f3\u30c4\u304c\u52d5\u4f5c\u3059\u308b\u30b3\u30f3\u30c6\u30ca\u3092\u3064\u304f\u308a\u3001\u5225\u306e\u30af\u30e9\u30a6\u30c9\u306b\u79fb\u3057\u3066\u307f\u307e\u3057\u3087\u3046\u3002\u3053\u3053\u3067\u306f PHP \u306e\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3 PukiWiki \u3092\u7528\u3044\u307e\u3059\u3002\n\u5f15\u304d\u7d9a\u304d\u3001\u3055\u304f\u3089\u306e\u30af\u30e9\u30a6\u30c9\u4e0a\u3067\u4f5c\u696d\u3092\u884c\u3044\u307e\u3059\u3002\n\n8.1. \u30b3\u30f3\u30c6\u30ca\u3092\u4f5c\u6210\nhost@centos# docker run -i -t -p 80:80 centos:centos6 /bin/bash\nbash-4.1#\n\n\u65b0\u3057\u304f -p 80:80 \u306e\u30aa\u30d7\u30b7\u30e7\u30f3\u3092\u4f7f\u7528\u3057\u307e\u3059\u3002\u3053\u308c\u306f\u3001\u30db\u30b9\u30c8\u5074\u306e\u30dd\u30fc\u30c8 80 \u3068\u3001\u30b3\u30f3\u30c6\u30ca\u5185\u306e\u30dd\u30fc\u30c8 80 \u3092\u30ea\u30f3\u30af\u3059\u308b\u305f\u3081\u306e\u30aa\u30d7\u30b7\u30e7\u30f3\u6307\u5b9a\u3067\u3059\u3002\u3053\u306e\u6307\u5b9a\u304c\u7121\u3044\u3068\u3001\u30b3\u30f3\u30c6\u30ca\u306b\u5bfe\u3057\u3066\u5916\u90e8\u306e\u30b5\u30fc\u30d3\u30b9\u304b\u3089\u63a5\u7d9a\u3059\u308b\u3053\u3068\u306f\u51fa\u6765\u307e\u305b\u3093\u3002\n\u30bf\u30a4\u30e0\u30be\u30fc\u30f3\u3092\u88dc\u6b63\u3057\u307e\u3059\u3002\ncontainer@lxc# echo 'ZONE=\"Asia/Tokyo\"' > /etc/sysconfig/clock\n\n\uff08\u5225\u89e3\uff1acp /usr/share/zoneinfo/Japan /etc/localtime \uff09\n\n8.2. \u30d1\u30c3\u30b1\u30fc\u30b8\u306e\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\nApache \u307b\u304b\u3001\u5fc5\u8981\u306b\u306a\u308b\u30d1\u30c3\u30b1\u30fc\u30b8\u3092\u5165\u308c\u307e\u3059\u3002\ncontainer@lxc# yum -y install httpd php wget unzip\n\n\n8.3. PukiWiki \u306e\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\n/var/www/html/wiki \u306b PukiWiki \u3092\u7f6e\u304d\u307e\u3059\u3002\ncontainer@lxc# wget -O pukiwiki-1_5_0_rc1_utf8.zip 'http://sourceforge.jp/frs/redir.php?m=iij&f=%2Fpukiwiki%2F61572%2Fpukiwiki-1_5_0_rc1_utf8.zip'\ncontainer@lxc# unzip ./pukiwiki-1_5_0_rc1_utf8.zip\ncontainer@lxc# mv pukiwiki-1_5_0_utf8/ /var/www/html/wiki\ncontainer@lxc# cd /var/www/html/wiki\ncontainer@lxc# chown -R apache.apache /var/www/html/wiki\n\nPukiWiki \u306e\u30d1\u30b9\u30ef\u30fc\u30c9\u3092\u5909\u66f4\u3057\u307e\u3059\u3002\n\u203b\u4ee5\u4e0b 'pass9999' \u306e\u7b87\u6240\u3092\u4efb\u610f\u306e\u6587\u5b57\u5217\u306b\u7f6e\u304d\u63db\u3048\u3066\u304f\u3060\u3055\u3044\u3002\ncontainer@lxc# sed -i -e \"s#$adminpass = '{x-php-md5}\\!';#$adminpass = '{x-php-md5}' . md5('pass9999');#\" pukiwiki.ini.php\n\n\uff08\u30d1\u30b9\u30ef\u30fc\u30c9\u306e\u8a2d\u5b9a\u3092\u884c\u3063\u3066\u3044\u307e\u3059\u3002\u76f4\u63a5 pukiwiki.ini.php \u3092\u66f8\u304d\u63db\u3048\u3066\u3082\u69cb\u3044\u307e\u305b\u3093\uff09\n\u30b3\u30f3\u30c6\u30f3\u30c4\u7528\u306e\u30d5\u30a1\u30a4\u30eb\u3092\u7f6e\u304d\u307e\u3059\u3002\ncontainer@lxc# echo 'sakura' > /var/www/html/index.html\n\nApache \u3092\u8d77\u52d5\u3057\u307e\u3059\u3002\ncontainer@lxc# service httpd start\n\n\u30d6\u30e9\u30a6\u30b6\u304b\u3089 http://<host>/ \u306b\u30a2\u30af\u30bb\u30b9\u3059\u308b\u3068sakura \u304c\u898b\u3048\u307e\u3059\u3002\n\u30d6\u30e9\u30a6\u30b6\u304b\u3089 http://<host>/wiki/ \u306b\u30a2\u30af\u30bb\u30b9\u3059\u308b\u3068 PukiWiki \u304c\u8868\u793a\u3055\u308c\u307e\u3059\u3002\n\u4f55\u304b\u7de8\u96c6\u3057\u3066\u3001\u8a2d\u5b9a\u304c\u53cd\u6620\u3055\u308c\u308b\u4e8b\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\n\n8.4. \u30b3\u30f3\u30c6\u30ca\u306e\u5909\u66f4\u5185\u5bb9\u3092\u53cd\u6620(commit)\u3059\u308b\n\u4fdd\u5b58\u3059\u308b\u305f\u3081\u306b\u306f\u3001\u30b3\u30f3\u30c6\u30ca ID \u3092\u6307\u5b9a\u3057\u3066\u3001docker commit \u3057\u307e\u3059\u3002\nhost@centos# docker ps -a | head\nCONTAINER ID        IMAGE                     COMMAND                CREATED             STATUS                         PORTS               NAMES\nc47b41e0cd99        wiki:latest     /bin/bash              17 minutes ago      Exited (0) 5 seconds ago                           determined_elion\n\n\nhost@centos# docker commit c47b41e0cd99 wiki:sakura\n3df585a2bde00c2183eb8be8621b40e9a2d003091feed556a428ffc4b5d7a492\n\n\u306a\u304a\u3001\u3053\u3053\u3067\u306f\u30bf\u30b0\u306b wiki:sakura \u3068\u540d\u4ed8\u3051\u307e\u3057\u305f\u3002\n\u3053\u306e\u72b6\u614b\u3067\u518d\u5ea6\u30b3\u30f3\u30c6\u30ca\u306b\u63a5\u7d9a\u3059\u308b\u5834\u5408\u306f\u3001\u6b21\u306e\u3088\u3046\u306b\u3057\u307e\u3059\u3002\nhost@centos# docker run -p 80:80 -t -i wiki:sakura /bin/bash\nbash-4.1# service httpd start\nStarting httpd: httpd: Could not reliably determine the server's fully qualified domain name, using 172.17.0.24 for ServerName\n                                                           [  OK  ]\n\n\u306a\u304a\u3001\u30b3\u30f3\u30c6\u30ca\u306e\u66f4\u65b0\u8a18\u9332\u306f docker history \u30b3\u30de\u30f3\u30c9\u3067\u8abf\u3079\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\nhost@centos# docker history wiki:sakura\nIMAGE               CREATED             CREATED BY          SIZE\n3df585a2bde0        2 minutes ago       /bin/bash           15.75 MB\n8f8b42ee46a3        2 hours ago                             369.6 MB\n\n\n9. Pukiwiki \u306e\u30b3\u30f3\u30c6\u30ca\u3092\u3001\u3055\u304f\u3089\u2192\u30cb\u30d5\u30c6\u30a3\u306b\u79fb\u52d5\n\u52d5\u7684\u306a\u30b3\u30f3\u30c6\u30f3\u30c4\u306e\u5834\u5408\u3067\u3082\u3001\u5148\u307b\u3069\u306e Apache \u30b3\u30f3\u30c6\u30ca\u3092\u79fb\u52d5\u3057\u305f\u6642\u3068\u624b\u9806\u306f\u540c\u3058\u3067\u3059\u3002\n\n9.1. \u3055\u304f\u3089\u5074\u3067\u30b3\u30f3\u30c6\u30ca\u306e export\nhost@centos# docker ps -a\n\n\u30b3\u30f3\u30c6\u30caID \u3092\u8abf\u3079\u3001export \u3057\u307e\u3059\u3002\nhost@centos# docker export \u30b3\u30f3\u30c6\u30caID > sakura-wiki.tar\n\n\u51fa\u529b\u3057\u305f\u30d5\u30a1\u30a4\u30eb\u3092 scp \u3067\u30cb\u30d5\u30c6\u30a3\u3078\u8ee2\u9001\u3057\u307e\u3059\u3002\nhost@centos# scp ./sakura-wiki.tar root@<nifty\u306eIP\u30a2\u30c9\u30ec\u30b9>:/tmp/\nEnter passphrase for key '/root/.ssh/id_rsa':\nsakura-wiki.tar                                         100%  368MB  10.2MB/s   00:36\n\n\n9.2. \u30cb\u30d5\u30c6\u30a3\u5074\u3067\u30b3\u30f3\u30c6\u30ca\u306e\u53d6\u308a\u8fbc\u307f(import)\n\u30cb\u30d5\u30c6\u30a3\u5074\u306e\u30b5\u30fc\u30d0\u306b\u30ed\u30b0\u30a4\u30f3\u3057\u307e\u3059\u3002\u305d\u306e\u5f8c\u3001docker import\u3067\u30a4\u30e1\u30fc\u30b8\u3092\u53d6\u308a\u8fbc\u307f\u307e\u3059\u3002\u30bf\u30b0\u540d\u306f wiki:sakura \u3068\u3057\u307e\u3059\u3002\nroot@ubuntu:~# cat /tmp/sakura-wiki.tar | docker import - wiki:sakura\n411ab7beb10766680e32103f837ccad739b5aba71f366f94f9a71de0496f26ff\n\n\n9.3. \u53d6\u308a\u8fbc\u3093\u3060\u30b3\u30f3\u30c6\u30ca\u306e\u8d77\u52d5\n\u30b3\u30f3\u30c6\u30ca\u3092\u8d77\u52d5\u3057\u307e\u3059\u3002\u30bf\u30b0 wiki:sakura \u3092\u6307\u5b9a\u3057\u307e\u3059\u3002\nhost@ubuntu# docker run -p 80:80 -t -i wiki:sakura /bin/bash\n\n\u30b3\u30f3\u30c6\u30ca\u306e\u4e2d\u3067 Apache \u3092\u8d77\u52d5\u3057\u307e\u3059\ncontainer@bash-4.1# service httpd start\nStarting httpd: httpd: Could not reliably determine the server's fully qualified domain name, using 172.17.0.2 for ServerName\n                                                           [  OK  ]\n\n\u6700\u5f8c\u306b\u3001\u30d6\u30e9\u30a6\u30b6\u304b\u3089\u306e\u8868\u793a\u78ba\u8a8d\u3092\u884c\u3044\u307e\u3059\u3002http://IP\u30a2\u30c9\u30ec\u30b9/wiki/ \u306b\u30a2\u30af\u30bb\u30b9\u3059\u308b\u3068\u3001\u3055\u304f\u3089\u3068\u540c\u69d8\u306e\u5185\u5bb9\u304c\u8868\u793a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\u307e\u305f\u3001\u7de8\u96c6\u3082\u51fa\u6765\u308b\u4e8b\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\n\n10. Dockerfile \u3067 PukiWiki \u306e\u30b3\u30f3\u30c6\u30ca\u3092\u69cb\u7bc9\n\u5148\u307b\u3069\u306e Apahce \u7528\u306e\u30b3\u30f3\u30c6\u30ca\u3068\u540c\u69d8\u306b\u3001PukiWiki \u306e\u30b3\u30f3\u30c6\u30ca\u3082 Dockerfile \u3067\u5b9a\u7fa9\u3059\u308b\u3053\u3068\u304c\u51fa\u6765\u307e\u3059\u3002\n\n10.1. Dockerfile \u4f5c\u6210\n\u4f5c\u696d\u7528\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092\u4f5c\u308a\u307e\u3059\u3002\nhost@ubuntu# mkdir /root/wiki\nhost@ubuntu# cd /root/wiki/\nhost@ubuntu# touch Dockefile\nhost@ubuntu# vi Dockerfile\n\n\u30d5\u30a1\u30a4\u30eb\u306e\u4e2d\u8eab\u306f\u3001\u6b21\u306e\u3088\u3046\u306b\u3057\u307e\u3059\u3002\n\nDockefile\nFROM centos:centos6\nMAINTAINER 0.1. USER, USER@example.jp\nRUN echo 'ZONE=\"Asia/Tokyo\"' > /etc/sysconfig/clock\n\nRUN rpm --import http://dl.fedoraproject.org/pub/epel/RPM-GPG-KEY-EPEL-6\nRUN yum -y install httpd php wget unzip\nRUN echo 'nifty' > /var/www/html/index.html\n\nRUN wget -O pukiwiki-1_5_0_rc1_utf8.zip 'http://sourceforge.jp/frs/redir.php?m=iij&f=%2Fpukiwiki%2F61572%2Fpukiwiki-1_5_0_rc1_utf8.zip'\nRUN unzip ./pukiwiki-1_5_0_rc1_utf8.zip\nRUN mv pukiwiki-1_5_0_utf8 /var/www/html/wiki\nRUN chown -R apache.apache /var/www/html/wiki\nRUN sed -i -e \"s#$adminpass = '{x-php-md5}\\!';#$adminpass = '{x-php-md5}' . md5('9999pass');#\" /var/www/html/wiki/pukiwiki.ini.php\n\n\nEXPOSE 80\n\nENTRYPOINT [\"/usr/sbin/httpd\"]\nCMD [\"-D\", \"FOREGROUND\"]\n\n\n\n10.2. Dockerfile \u3092\u5143\u306b\u30a4\u30e1\u30fc\u30b8\u3092\u30d3\u30eb\u30c9\n\u30bf\u30b0\u306f wiki:nifty \u3068\u3057\u3066\u4f5c\u6210\u3057\u307e\u3059\u3002\nhost@ubuntu# docker build -t wiki:nifty .\n\uff08\u7565\uff09\n ---> 30d4bc6dc4bc\nRemoving intermediate container a20a49adea9f\nStep 13 : ENTRYPOINT [\"/usr/sbin/httpd\"]\n ---> Running in dd94718d8e19\n ---> c90d521b6701\nRemoving intermediate container dd94718d8e19\nStep 14 : CMD [\"-D\", \"FOREGROUND\"]\n ---> Running in bdd19d56f8fc\n ---> 213902c19c59\nRemoving intermediate container bdd19d56f8fc\nSuccessfully built 213902c19c59\n\n\u4f5c\u6210\u3055\u308c\u305f\u30a4\u30e1\u30fc\u30b8ID\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\nhost@ubuntu# docker images\nREPOSITORY          TAG                 IMAGE ID            CREATED              VIRTUAL SIZE\nwiki                nifty               213902c19c59        32 seconds ago       312.2 MB\n\n\u3053\u306e\u3088\u3046\u306b wiki:nifty\u3068\u3044\u3046\u30a4\u30e1\u30fc\u30b8\u304c\u65b0\u305f\u306b\u4f5c\u6210\u3055\u308c\u307e\u3057\u305f\u3002\n\n10.3. \u30b3\u30f3\u30c6\u30ca\u306b\u63a5\u7d9a\n\u4f5c\u6210\u3057\u305f wiki:nifty \u30bf\u30b0\u3092\u4f7f\u3063\u3066\u3001\u30b3\u30f3\u30c6\u30ca\u306e\u8d77\u52d5\u3068\u3001PukiWiki \u3078\u306e\u30a2\u30af\u30bb\u30b9\u3092\u8a66\u307f\u307e\u3059\u3002\nhost@ubuntu# docker run -t -i -d -p 80:80 wiki:nifty\nf20598638936dea634567a083d39a258c00a3017ad9ce1f09aaab4efd6b08f7b\n\nhost@ubuntu# docker ps\nCONTAINER ID        IMAGE               COMMAND                CREATED             STATUS              PORTS                NAMES\nf20598638936        wiki:nifty          /usr/sbin/httpd -D F   3 seconds ago       Up 2 seconds        0.0.0.0:80->80/tcp   happy_kirch\n\n\u3053\u306e\u3088\u3046\u306b\u78ba\u8a8d\u304c\u3067\u304d\u305f\u3042\u3068\u306f\u3001\u30d6\u30e9\u30a6\u30b6\u304b\u3089 Wiki \u3078\u306e\u30a2\u30af\u30bb\u30b9\u304c\u53ef\u80fd\u306a\u3053\u3068\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\n\u4ee5\u4e0a\u3067\u30cf\u30f3\u30ba\u30aa\u30f3\u306e\u5185\u5bb9\u306f\u7d42\u4e86\u3067\u3059\u3002\u304a\u75b2\u308c\u69d8\u3067\u3057\u305f\u3002\n\n11. \uff08\u4e0a\u7d1a\u7de8\uff09WordPress \u306e\u30b3\u30f3\u30c6\u30ca\u3092\u4f5c\u6210\n\u203b\u6642\u9593\u306e\u3042\u308b\u30c1\u30fc\u30e0\u5411\u3051\u306e\u81ea\u4e3b\u8ab2\u984c\u3067\u3059\u3002\n\u3053\u308c\u307e\u3067\u306e\u304a\u5fa9\u7fd2\u3044\u3068\u3057\u3066\u3001WordPress \u304c\u52d5\u4f5c\u3059\u308b\u30b3\u30f3\u30c6\u30ca\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\u4ee5\u4e0b\u306f\u624b\u9806\u306e\u6982\u8981\u3060\u3051\u793a\u3057\u307e\u3059\u306e\u3067\u3001\u306a\u305c\u3053\u306e\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3059\u308b\u306e\u304b\u3001\u8003\u3048\u306a\u304c\u3089\u9032\u3093\u3067\u4e0b\u3055\u3044\u3002\n\n11.1. \u6982\u8981\nWordPress \u306e\u52d5\u4f5c\u306b\u306f\u3001Apache\u3001PHP\u3001MySQL \u306e\u74b0\u5883\u3092\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\u3057\u307e\u3059\u3002\u3055\u3089\u306b\u3001\u30d6\u30e9\u30a6\u30b6\u4e0a\u304b\u3089 WordPress \u306e\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\u3092\u884c\u3044\u307e\u3059\u3002\n\n11.2. WordPress \u30b3\u30f3\u30c6\u30ca\u306e\u4f5c\u6210\u624b\u9806\nWordPress \u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb - WordPress Codex \u65e5\u672c\u8a9e\u7248\nhttp://wpdocs.sourceforge.jp/WordPress_%E3%81%AE%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB\n\u4f5c\u696d\u5185\u5bb9\u306f\u3001\u3053\u3061\u3089\u306e\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u306b\u6e96\u3058\u307e\u3059\u3002\n\n\u30b3\u30f3\u30c6\u30ca\u5074\u306e\u6e96\u5099\n\u30db\u30b9\u30c8\u5074\u3067\u30b3\u30f3\u30c6\u30ca\u3092\u8d77\u52d5\u3002\nroot@ubuntu:~# docker run -i -t centos:centos6 /bin/bash\n\n\u30b3\u30f3\u30c6\u30ca\u5185\u3067\u6642\u523b\u8a2d\u5b9a\u3002\nroot@ubuntu:~# echo 'ZONE=\"Asia/Tokyo\"' > /etc/sysconfig/clock\n\n\nWordPress \u306e\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3068\u5c55\u958b\nroot@ubuntu:~# yum -y install httpd php php-mysql mysql-server tar wget\nroot@ubuntu:~# cd /var/www/html\nroot@ubuntu:~# wget http://ja.wordpress.org/wordpress-3.9.1-ja.tar.gz\nroot@ubuntu:~# tar xvfz ./wordpress-3.9.1-ja.tar.gz\n\n\nMySQL \u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u8a2d\u5b9a\u3068\u30e6\u30fc\u30b6\u306e\u4f5c\u6210\nroot@ubuntu:~# service mysqld start\n\nroot@ubuntu:~# mysql -u root\nmysql> CREATE DATABASE wordpress;\nmysql> GRANT ALL PRIVILEGES ON wordpress.* TO \"wordpress\"@\"localhost\" IDENTIFIED BY \"password999\";\nmysql> FLUSH PRIVILEGES;\nmysql> EXIT\n\n\ncommit \u3057\u3066\u5909\u66f4\u5185\u5bb9\u3092\u78ba\u5b9a\n\u30b3\u30f3\u30c6\u30ca\u3092\u629c\u3051\u3066 wordpress \u3068\u3044\u3046\u540d\u524d\u3067 docker commit \u3059\u308b\u3002\nroot@ubuntu:~# docker ps -a | head -2\nCONTAINER ID        IMAGE               COMMAND                CREATED             STATUS                      PORTS               NAMES\naeaa50c49e31        centos:centos6      /bin/bash              11 minutes ago      Exited (0) 49 seconds ago                       thirsty_mcclintock\n\n\nroot@ubuntu:~# docker commit aeaa50c49e31 wordpress\n301e6ae61c2d0fb5104327a741a573c39015f71a78cb76bfb0f5c181cbf2e1cd\n\n\n\u30b3\u30f3\u30c6\u30ca\u306e\u8d77\u52d5\nroot@ubuntu:~# docker run -t -i -d -p 80:80 wordpress\n2c9887a60d1eb9833ba237930430c680bdb4230ecb8221a3b2d406f8251cbe13\nroot@ubuntu:~# docker ps\nCONTAINER ID        IMAGE               COMMAND             CREATED             STATUS              PORTS                NAMES\n2c9887a60d1e        wordpress:latest    /bin/bash           9 seconds ago       Up 9 seconds        0.0.0.0:80->80/tcp   tender_elion\n\n\n\u30c7\u30fc\u30e2\u30f3\u306e\u8d77\u52d5\nroot@ubuntu:~# docker attach 2c9887a60d1e\n\ncontainer@bash-4.1# service httpd start\nStarting httpd: httpd: Could not reliably determine the server's fully qualified domain name, using 172.17.0.27 for ServerName\n                                                           [  OK  ]\ncontainer@bash-4.1# service mysqld start\nStarting mysqld:                                           [  OK  ]\n\ncontainer@bash-4.1# chown -R apache.apache /var/www/html/wordpress/\n\n\n\u30d6\u30e9\u30a6\u30b6\u304b\u3089\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\nhttp://<HOST>/wordpress/wp-admin/install.php\n \u306b\u63a5\u7d9a\u3057\u307e\u3059\u3002\n\n'\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u6210\u3059\u308b'\n'\u3055\u3041\u59cb\u3081\u307e\u3057\u3087\u3046'\n\u8a73\u7d30\n\n\n \u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u540d\uff1awordpress\n \u30e6\u30fc\u30b6\u540d\uff1awordpress\n \u30d1\u30b9\u30ef\u30fc\u30c9\uff1apassword999\n \u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306e\u30db\u30b9\u30c8\u540d\uff1alocalhost\n \u30c6\u30fc\u30d6\u30eb\u63a5\u982d\u8f9e\uff1awp_\n \u3010\u9001\u4fe1\u3011\n*\u3010\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u5b9f\u884c\u3011\n\n\n\u3088\u3046\u3053\u305d\n\n\n \u30b5\u30a4\u30c8\u540d\uff1adocker\n \u30e6\u30fc\u30b6\u540d\uff1adocker\n \u30d1\u30b9\u30ef\u30fc\u30c9\uff1adocker999\n \u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\uff1a\u4efb\u610f\n \u3010WordPress\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3011\n\n\n\u6210\u529f\u3057\u307e\u3057\u305f\uff01\n\n\n \u3010\u30ed\u30b0\u30a4\u30f3\u3011\n\n\n\nWordPress \u4e0a\u3067\u66f8\u304d\u8fbc\u307f\u3092\u884c\u3044\u3001\u66f8\u304d\u8fbc\u307f\u5185\u5bb9\u304c\u53cd\u6620\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u30d6\u30e9\u30a6\u30b6\u304b\u3089\u78ba\u8a8d\u3002\n\n\u30b3\u30f3\u30c6\u30ca\u30a4\u30e1\u30fc\u30b8\u306e\u30b3\u30df\u30c3\u30c8\ncontainer@bash-4.1# exit\nexit\nroot@ubuntu:~# docker ps -a | head -2\nCONTAINER ID        IMAGE               COMMAND                CREATED             STATUS                       PORTS               NAMES\n31dd5ff9b3f4        wordpress:latest    /bin/bash              7 minutes ago       Exited (0) 10 seconds ago                        elegant_kowalevski\n\n\nroot@ubuntu:~# docker commit 31dd5ff9b3f4 wordpress:nifty\n0a60f13ca024c8f0156bf8a23dff43bd2a2879ba7538ba7f9c85845312b821d4\nroot@ubuntu:~# docker images\nREPOSITORY          TAG                 IMAGE ID            CREATED             VIRTUAL SIZE\nwordpress           nifty               0a60f13ca024        11 seconds ago      444.7 MB\nwordpress           latest              301e6ae61c2d        21 minutes ago      408.2 MB\n\n\uff12\u3064\u51fa\u6765\u3066\u3044\u308b\u3002\n\n11.3. \u3055\u3089\u306b\u6642\u9593\u306e\u3042\u308b\u30b0\u30eb\u30fc\u30d7\u306f \u2026\n\n\u30b3\u30f3\u30c6\u30ca\u3092\u5225\u306e\u30af\u30e9\u30a6\u30c9\u306b\u79fb\u52d5\u3055\u305b\u307e\u3057\u3087\u3046\n\n\u30cb\u30d5\u30c6\u30a3 -> \u3055\u304f\u3089\u3001\u79fb\u884c\u4f8b\n\u203b\u4e88\u3081\u3001\u30cb\u30d5\u30c6\u30a3\u5074 WordPress \u306e\u30d6\u30e9\u30a6\u30b6\u304b\u3089\u884c\u3046\u57fa\u672c\u8a2d\u5b9a\u3067\u3001\u30b3\u30f3\u30c6\u30f3\u30c4\u306e IP \u30a2\u30c9\u30ec\u30b9\u3092\u300c\u3055\u304f\u3089\u5074\u300d\u306b\u5909\u66f4\u3057\u3066\u304a\u304f\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\n\n\u30cb\u30d5\u30c6\u30a3\u5074\nroot@ubuntu:~# docker commit b3cc6f68a0ff wordpress:nifty\n9094fd71be4b5ce2734076860621b2b51552a4c5ce0341911465084d09d59a6f\n\nroot@ubuntu:~# docker ps -a\nCONTAINER ID        IMAGE               COMMAND                CREATED             STATUS                          PORTS               NAMES\nb3cc6f68a0ff        0a60f13ca024        /bin/bash              5 minutes ago       Exited (0) About a minute ago                       jovial_archimedes\n\nroot@ubuntu:~# docker export b3cc6f68a0ff > nifty-wp.tar\n\nroot@ubuntu:~# scp ./nifty-wp.tar  root@153.120.83.96:/tmp/\nEnter passphrase for key '/root/.ssh/id_rsa':\nnifty-wp.tar                                            100%  393MB  17.1MB/s   00:23\n\n\n\n\u3055\u304f\u3089\u5074\n[root@sakura2 ~]# cat /tmp/nifty-wp.tar | docker import - wordpress:sakura\na266f141bfa43423678a090daf341ce96a1a06fd8ac9f269e5e62bf44a4d115a\n\n\n[root@sakura2 ~]# docker run -t -i -d -p 80:80 wordpress:sakura /bin/bash\nf8061f2fe88aa8e377b0b7a42bead0a651870a3942494e853e2daffe260147a2\n\n[root@sakura2 ~]# docker attach f8061f2fe88aa8e377b0b7a42bead0a651870a3942494e853e2daffe260147a2\n\nbash-4.1# service mysqld start\nStarting mysqld:                                           [  OK  ]\nbash-4.1# service  httpd start\nStarting httpd: httpd: Could not reliably determine the server's fully qualified domain name, using 172.17.0.28 for ServerName\n                                                           [  OK  ]\n\n\n\n\n\u305d\u308c\u305e\u308c\u3001\u3069\u306e\u3088\u3046\u306a\u4f5c\u696d\u3092\u884c\u3063\u3066\u3044\u305f\u306e\u3067\u3057\u3087\u3046\u304b\uff1f\n\u3053\u306e\u5185\u5bb9\u3092 Dockerfile \u3067\u5b9a\u7fa9\u3059\u308b\u306b\u306f\u3069\u3046\u3057\u305f\u3089\u3044\u3044\u3067\u3057\u3087\u3046\u304b\uff1f\n\n## \u30af\u30e9\u30a6\u30c9\u3092\u6e21\u308a\u6b69\u3051\uff01\u3000\u3055\u304f\u3089\u00d7\u30cb\u30d5\u30c6\u30a3\u3000\u5408\u540c\u30cf\u30f3\u30ba\u30aa\u30f3\u52c9\u5f37\u4f1a\uff01\uff01\n2014\u5e747\u670819\u65e5(\u571f)\u958b\u50ac\u306e\u3001[Docker\u30cf\u30f3\u30ba\u30aa\u30f3](http://www.zusaar.com/event/14467015)\u7528\u306e\u8cc7\u6599\u3067\u3059\u3002\n### \u30cf\u30f3\u30ba\u30aa\u30f3\u306e\u6d41\u308c\n\n* \u76ee\u7684\n *  \u5b9f\u969b\u306b docker \u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3092\u3057\u3001\u30b3\u30f3\u30c6\u30ca\u306e\u4f5c\u6210\u30fb\u7ba1\u7406\u3084\u3001\u30af\u30e9\u30a6\u30c9\u9593\u306e\u79fb\u884c\u304c\u51fa\u6765\u308b\u3088\u3046\u306b\u3002\n\n* \u5185\u5bb9\n *  \u30cb\u30d5\u30c6\u30a3 \u2026 Ubuntu 12.04 \u306b Docker \u3092\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\n *  \u3055\u304f\u3089 \u2026 CentOS 6.5 \u306b Docker \u3092\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\n *  \u30b3\u30f3\u30c6\u30ca\u3092\u4f5c\u6210\u3057\u3001\u76f8\u4e92\u306b\u79fb\u52d5\n  1. \u9759\u7684\u30b3\u30f3\u30c6\u30f3\u30c4\u7de8 ( Apache + HTML \u30d5\u30a1\u30a4\u30eb )\n  2. \u52d5\u7684\u30b3\u30f3\u30c6\u30f3\u30c4\u7de8 ( Apache + PHP + PukiWiki )\n\n## 1. Docker \u306e\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7(Ubuntu/\u30cb\u30d5\u30c6\u30a3\u30af\u30e9\u30a6\u30c9\u7de8)\n### 1.1. \u30cb\u30d5\u30c6\u30a3\u30af\u30e9\u30a6\u30c9\u306b\u30ed\u30b0\u30a4\u30f3\n\u5bfe\u8c61\u30b5\u30fc\u30d0\u306b SSH \u3067\u30ed\u30b0\u30a4\u30f3\u3057\u307e\u3059\u3002Linux kernel \u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u304c\u53e4\u3044\u70ba\u3001\u30d0\u30fc\u30b8\u30e7\u30f3\u30a2\u30c3\u30d7\u3092\u3057\u307e\u3059\u3002\n\n```shell-session\nhost@ubuntu# apt-get update\nhost@ubuntu# apt-get install -y linux-image-generic-lts-raring linux-headers-generic-lts-raring\n(\u7565)\nSetting up linux-headers-generic-lts-raring (3.8.0.44.44) ...\nSetting up linux-image-generic-lts-raring (3.8.0.44.44) ...\nhost@ubuntu# reboot\n```\n\n### 1.2. \u30d0\u30fc\u30b8\u30e7\u30f3\u78ba\u8a8d\nreboot \u5f8c\u3001\u518d\u3073\u5bfe\u8c61\u30b5\u30fc\u30d0\u306b\u30ed\u30b0\u30a4\u30f3\u3057\u307e\u3059\u3002\n\n```shell-session\nhost@ubuntu# uname -a\nLinux ubuntu 3.8.0-44-generic #66~precise1-Ubuntu SMP Tue Jul 15 04:01:04 UTC 2014 x86_64 x86_64 x86_64 GNU/Linux\n```\n\u30d0\u30fc\u30b8\u30e7\u30f3\u304c\u300c3.8\u300d\u306b\u306a\u3063\u3066\u3044\u308b\u4e8b\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\n\n### 1.3. Docker \u306e\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\n\n\u9375\u3092\u53d6\u308a\u8fbc\u307f\u307e\u3059\u3002\n\n```shell-session\nhost@ubuntu# apt-key adv --keyserver hkp://keyserver.ubuntu.com:80 --recv-keys 36A1D7869245C8950F966E92D8576A8BA88D21E9\n```\n\nDocker \u30ea\u30dd\u30b8\u30c8\u30ea\u3092\u6709\u52b9\u5316\u3057\u307e\u3059\u3002\n\n```shell-session\nhost@ubuntu# sh -c \"echo deb https://get.docker.io/ubuntu docker main > /etc/apt/sources.list.d/docker.list\"\n```\n\n\u5185\u5bb9\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\n\n```shell-session\nhost@ubuntu# cat /etc/apt/sources.list.d/docker.list\ndeb https://get.docker.io/ubuntu docker main\n```\n\n\u66f4\u65b0\u3068\u3001lxc-docker \u30d1\u30c3\u30b1\u30fc\u30b8\u3092\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\u3057\u307e\u3059\u3002\n\n```shell-session\nhost@ubuntu# apt-get update\nhost@ubuntu# apt-get install lxc-docker\n```\n\u203b\u9014\u4e2d\u306e\u9805\u76ee\u306f `Y` \u3092\u6307\u5b9a\u3057\u307e\u3059\u3002\n\ndocker \u306e\u72b6\u614b\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\n\n```shell-session\nhost@ubuntu# service docker status\ndocker start/running, process 4695\n\nhost@ubuntu# docker --version\nDocker version 1.1.1, build bd609d2\n```\n\n### 1.4. \u540d\u524d\u89e3\u6c7a\u306e\u8a2d\u5b9a\n\n\u3053\u306e\u307e\u307e\u3067\u306f Docker \u304c\u540d\u524d\u89e3\u6c7a\u3067\u304d\u305a\u3001\u30a4\u30e1\u30fc\u30b8\u306e\u53d6\u5f97\u304c\u3067\u304d\u307e\u305b\u3093\u3002\u4ee5\u4e0b\u306e\u9805\u76ee\u3092\u8ffd\u8a18\u3057\u307e\u3059\u3002\n\n```shell-session\nhost@ubuntu# echo 'nameserver 127.0.0.1' >> /etc/resolv.conf\n```\n\n\u8a2d\u5b9a\u3092 Docker \u306b\u53cd\u6620\u3059\u308b\u305f\u3081\u3001Docker \u306e\u518d\u8d77\u52d5\u3092\u884c\u3044\u307e\u3059\u3002\n\n```shell-session\nhost@nifty # service docker restart\ndocker stop/waiting\ndocker start/running, process 5091\n```\n\n\u53c2\u8003\nhttp://docs.docker.com/installation/ubuntulinux/#ubuntu-precise-1204-lts-64-bit\nhttps://github.com/dotcloud/docker/issues/1470\n\n### 1.5. vmware-tools \u306e\u66f4\u65b0\n\n\u30cb\u30d5\u30c6\u30a3\u30af\u30e9\u30a6\u30c9\u4e0a\u3067\u306f\u3001vmware-tools \u306e\u66f4\u65b0\u3092\u884c\u308f\u306a\u3044\u3068\u3001\u30b3\u30f3\u30c8\u30ed\u30fc\u30eb\u30d1\u30cd\u30eb\u4e0a\u3067\u306f\u30a8\u30e9\u30fc\u306b\u306a\u308a\u307e\u3059\u3002\u6b21\u306e\u3088\u3046\u306b\u66f4\u65b0\u3092\u884c\u3044\u307e\u3059\u3002\n\n```shell-session\nhost@ubuntu# /usr/bin/vmware-config-tools.pl --default\n```\n\n## 2. \u30b3\u30f3\u30c6\u30ca\u306e\u8d77\u52d5\n\n### 2.1. `hello world` \u3092\u8868\u793a\u3059\u308b\u30b3\u30f3\u30c6\u30ca\n\u30b3\u30f3\u30c6\u30ca\u3092\u8d77\u52d5\u3059\u308b\u306b\u306f `docker run` \u30b3\u30de\u30f3\u30c9\u3092\u4f7f\u3044\u307e\u3059\u3002`ubuntu` \u306e\u30d9\u30fc\u30b9\u30a4\u30e1\u30fc\u30b8\u3092\u4f7f\u3044\u3001`/bin/echo` \u3092\u5b9f\u884c\u3057\u3001\u753b\u9762\u306b\u6587\u5b57\u3092\u8868\u793a\u3057\u307e\u3059\u3002\n\n```shell-session\nhost@ubuntu# docker run ubuntu /bin/echo 'hello world'\nUnable to find image 'ubuntu' locally\nPulling repository ubuntu\ne54ca5efa2e9: Download complete\n511136ea3c5a: Download complete\nd7ac5e4f1812: Download complete\n2f4b4d6a4a06: Download complete\n83ff768040a0: Download complete\n6c37f792ddac: Download complete\nhello world\n```\n\n\u521d\u56de\u306f\u30a4\u30e1\u30fc\u30b8\u306e\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u306b\u6642\u9593\u304c\u304b\u304b\u308a\u307e\u3059\u3002\u6b21\u56de\u4ee5\u964d\u306f\u3001\u30ed\u30fc\u30ab\u30eb\u306b\u30a4\u30e1\u30fc\u30b8\u304c\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u6e08\u307f\u306a\u306e\u3067\u3001\u3059\u3050\u306b\u7acb\u3061\u4e0a\u304c\u308b\u3053\u3068\u304c\u308f\u304b\u308a\u307e\u3059\u3002\n\n```shell-session\nhost@ubuntu# docker run ubuntu /bin/echo 'hello world'\nhello world\n```\n\n#### \u304a\u307e\u3051\uff1a\u6642\u9593\u304c\u3042\u308c\u3070\u3084\u3063\u3066\u307f\u3088\u3046\n\n```shell-session\nhost@ubuntu# docker run -it --rm supertest2014/nyan\n```\n\n`ctrl+c` \u3067\u4e2d\u65ad\u3067\u304d\u307e\u3059\u3002\n\n### 2.2. CentOS \u30a4\u30e1\u30fc\u30b8\u306e\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3068\u8d77\u52d5\n\nUbuntu \u4e0a\u3067\u3082 CentOS \u306e\u30b3\u30f3\u30c6\u30ca\u3092\u7a3c\u50cd\u3055\u305b\u308b\u3053\u3068\u304c\u51fa\u6765\u307e\u3059\u3002\u4eca\u5ea6\u306f CentOS \u306e\u30d9\u30fc\u30b9\u30a4\u30e1\u30fc\u30b8\u3092\u3064\u304b\u3063\u3066\u6587\u5b57\u3092\u8868\u793a\u3055\u305b\u3066\u307f\u307e\u3057\u3087\u3046\u3002\n\n```shell-session\nhost@ubuntu# docker run centos /bin/echo 'hello centos'\nUnable to find image 'centos' locally\nPulling repository centos\n1a7dc42f78ba: Pulling image (latest) from centos, endpoint: https://cdn-registry-1.docker.1a7dc42f78ba: Download complete\n511136ea3c5a: Download complete\n34e94e67e63a: Download complete\nhello centos\n```\n\n\u307e\u305f\u3001\u5404\u30a4\u30e1\u30fc\u30b8\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u3092\u78ba\u8a8d\u3059\u308b\u4e8b\u3082\u3067\u304d\u307e\u3059\u3002\n\n```shell-session\nhost@ubuntu# docker run ubuntu cat /etc/issue\nhost@ubuntu# docker run centos cat /etc/issue\n```\n\n### 2.3. \u30b3\u30f3\u30c6\u30ca\u306e\u53d6\u5f97 (pull)\n\n`docker pull` \u3092\u4f7f\u3046\u3068\u3001\u6307\u5b9a\u3057\u305f/\u95a2\u9023\u3059\u308b\u30b3\u30f3\u30c6\u30ca\u306e\u30a4\u30e1\u30fc\u30b8\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3067\u304d\u307e\u3059\u3002\u6b21\u306e\u30b3\u30de\u30f3\u30c9\u306f\u3001CentOS \u306e\u6700\u65b0\u7248 ( CentOS 7 ) \u306e\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3067\u3059\u3002\n\n```shell-session\nhost@ubuntu# docker pull centos:latest\nPulling repository centos\n1a7dc42f78ba: Pulling image (latest) from centos, endpoint: https://cdn-registry-1.docker.1a7dc42f78ba: Download complete\n511136ea3c5a: Download complete\n34e94e67e63a: Download complete\n```\n\n### 2.4. \u30b3\u30f3\u30c6\u30ca\u306b\u30ed\u30b0\u30a4\u30f3\u3059\u308b\n\n\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3057\u305f\u30b3\u30f3\u30c6\u30ca\u3092\u4f7f\u3044\u3001\u30b3\u30f3\u30c6\u30ca\u306e\u4e2d\u306b\u5165\u308b\u306b\u306f`docker run`\u306b `-t` \u3068 `-i` \u306e\u30aa\u30d7\u30b7\u30e7\u30f3\u3092\u4ed8\u3051\u307e\u3059\u3002\n\n```shell-session\nhost@ubuntu# docker run -t -i ubuntu:14.04 /bin/bash\nUnable to find image 'ubuntu:14.04' locally\nPulling repository ubuntu\ne54ca5efa2e9: Download complete\n511136ea3c5a: Download complete\nd7ac5e4f1812: Download complete\n2f4b4d6a4a06: Download complete\n83ff768040a0: Download complete\n6c37f792ddac: Download complete\nroot@2ad166fc3787:/#\n```\n\u3053\u308c\u3067\u30b3\u30f3\u30c6\u30ca\u306e\u4e2d\u3067\u64cd\u4f5c\u304c\u3067\u304d\u307e\u3059\u3002\u30d7\u30ed\u30f3\u30d7\u30c8\u306b\u8868\u793a\u3055\u308c\u3066\u3044\u308b `2ad166fc3787` \u306f\u30b3\u30f3\u30c6\u30ca ID \u3068\u547c\u3070\u308c\u308b\u3082\u306e\u3067\u3001\u30b3\u30f3\u30c6\u30ca\uff11\u3064\uff11\u3064\u306b\u5bfe\u3057\u3066\u5272\u308a\u5f53\u3066\u3089\u308c\u307e\u3059\u3002\n\n\u3053\u3053\u3067\u6307\u5b9a\u3057\u305f `-t` \u306f\u4eee\u60f3 tty \u3092\u65b0\u3057\u3044\u30b3\u30f3\u30c6\u30ca\u306b\u5272\u308a\u5f53\u3066\u3001`-i` \u306f\u30b3\u30f3\u30c6\u30ca\u306e\u6a19\u6e96\u5165\u529b(STDNIN)\u3092\u53cc\u65b9\u5411(interactive)\u306b\u53d6\u5f97\u3057\u307e\u3059\u3002\u305d\u3057\u3066\u3001\u30b7\u30a7\u30eb `/bin/bash` \u306b\u51e6\u7406\u3092\u6e21\u3057\u307e\u3057\u305f\u3002\n\n### 2.5. \u30b3\u30f3\u30c6\u30ca\u306e\u4e2d\u3067\u57fa\u672c\u7684\u306a\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\n\n```shell-session\nroot@2ad166fc3787:/# pwd\n/\nroot@2ad166fc3787:/# ls\nbin   dev  home  lib64  mnt  proc  run   srv  tmp  var\nboot  etc  lib   media  opt  root  sbin  sys  usr\nroot@2ad166fc3787:/# ps ax\n  PID TTY      STAT   TIME COMMAND\n    1 ?        Ss     0:00 /bin/bash\n   13 ?        R+     0:00 ps ax\n```\n\n\u30b3\u30f3\u30c6\u30ca\u304b\u3089\u306f `exit` \u3067\u629c\u3051\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n### 2.6. \u30b3\u30f3\u30c6\u30ca\u306e\u4e00\u89a7\u3092\u8868\u793a\n\n`docker ps` \u3067\u30b3\u30f3\u30c6\u30ca\u306e\u4e00\u89a7\u3092\u8868\u793a\u3057\u307e\u3059\u3002\n\n```shell-session\nroot@container# docker ps\n```\n\n\u73fe\u5728\u7a3c\u50cd\u4e2d\u306e\u30b3\u30f3\u30c6\u30ca\u304c\u8868\u793a\u3055\u308c\u307e\u3059\u3002`CONTAINER ID`\u306b\u8868\u793a\u3055\u308c\u308b 12 \u6841\u306e\u6587\u5b57\u5217\u304c\u3001\u30b3\u30f3\u30c6\u30ca ID \u3068\u547c\u3070\u308c\u308b\u3082\u306e\u3067\u3001\u30b3\u30f3\u30c6\u30ca\u306e\u8d77\u52d5\u3084\u505c\u6b62\u306e\u969b\u306b\u5fc5\u305a\u5fc5\u8981\u3068\u306a\u308a\u307e\u3059\u3002\n\n```shell-session\nroot@container# dockr ps -a\n```\n\n\u3053\u3061\u3089\u306f\u3001\u505c\u6b62\u3057\u305f\u3082\u306e\u3001\u53e4\u3044\u3082\u306e\u3082\u542b\u3081\u3066\u5168\u3066\u304c\u8868\u793a\u3055\u308c\u307e\u3059\u3002\u65b0\u3057\u3044\u3082\u306e\u304c\u4e0a\u306b\u8868\u793a\u3055\u308c\u307e\u3059\u306e\u3067\u3001`head` \u3068\u7d44\u307f\u3042\u308f\u305b\u308b\u3068\u697d\u3067\u3059\u3002\n\n```shell-session:\u5b9f\u884c\u4f8b\nroot@ubuntu:~# docker ps -a\nCONTAINER ID        IMAGE               COMMAND                CREATED             STATUS                      PORTS               NAMES\n31a2629738e9        ubuntu:14.04        /bin/bash              3 minutes ago       Exited (0) 2 seconds ago                        cranky_hypatia\n2ad166fc3787        ubuntu:14.04        /bin/bash              7 minutes ago       Exited (0) 4 minutes ago                        hopeful_archimedes\n```\n\n\u306a\u304a\u3001\u30b3\u30f3\u30c6\u30ca\u306b\u30ed\u30b0\u30a4\u30f3\u4e2d\u3001\u4e00\u6642\u7684\u306b\u629c\u3051\u308b\u306b\u306f\u3001\n\n```shell-session\nroot@ubuntu:~# docker run -t -i ubuntu:14.04 /bin/bash\nroot@351e58d51464:/#\n\uff08ctrl +p , q \u3067\u4e00\u6642\u7684\u306b\u96e2\u8131\uff09\n```\n\n\u5fa9\u5e30\u306f`docker attach`\u306e\u5f8c\u3001\u30a8\u30f3\u30bf\u30fc\u30fb\u30ad\u30fc\u3092 `2\u56de` \u62bc\u3057\u307e\u3059(\u30b3\u30f3\u30c6\u30ca\u306e\u6a19\u6e96\u5165\u51fa\u529b\u306b\u63a5\u7d9a\u3057\u307e\u3059\u304c\u3001\u63a5\u7d9a\u76f4\u5f8c\u306f\u30db\u30b9\u30c8\u5074\u3068\u76f8\u4e92\u306b\u3084\u308a\u3068\u308a\u304c\u306a\u3044\u305f\u3081\u3067\u3059\u3002\u3053\u3061\u3089\u304b\u3089\u30a8\u30f3\u30bf\u30fc\u7b49\u3001\u4f55\u3089\u304b\u306e\u60c5\u5831\u3092\u9001\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059)\u3002\n\n```shell-session\nroot@ubuntu:~# docker attach 351e58d51464\n(\u2605\u3082\u3046\u4e00\u5ea6\u30a8\u30f3\u30bf\u30fc\nroot@351e58d51464:/#\n```\n\n\u3053\u308c\u3067\u30b3\u30f3\u30c6\u30ca\u306e\u4e2d\u306b\u623b\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n\n### 2.7. commit \u3057\u3066\u30a4\u30e1\u30fc\u30b8\u306e\u5185\u5bb9\u3092\u78ba\u5b9a\u3059\u308b\n\n\u901a\u5e38\u306f\u3001\u30b3\u30f3\u30c6\u30ca\u306e\u4e2d\u3067\u30d5\u30a1\u30a4\u30eb\u3092\u66f8\u304d\u8fbc\u3093\u3060\u308a\u66f4\u65b0\u3092\u52a0\u3048\u3066\u3082\u3001 `commit` \u3057\u306a\u3044\u3068\u5185\u5bb9\u304c\u53cd\u6620\u3055\u308c\u307e\u305b\u3093\u3002\u305f\u3068\u3048\u3070\n\n```shell-session\nroot@351e58d51464:/# echo test > /test\nroot@351e58d51464:/# cat /test\ntest\n\nroot@351e58d51464:/# exit\nexit\n```\n\n\u3053\u306e\u3088\u3046\u306b\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u6210\u3057\u3066\u3082\u3001\u518d\u5ea6\u30b3\u30f3\u30c6\u30ca\u3092\u8d77\u52d5\u3057\u3088\u3046\u3068\u3057\u3066\u3082\u3001`/test` \u3068\u3044\u3046\u30d5\u30a1\u30a4\u30eb\u306f\u5b58\u5728\u3057\u306a\u304b\u3063\u305f\u3053\u3068\u306b\u306a\u308a\u307e\u3059\u3002\n\n\u5909\u66f4\u5185\u5bb9\u3092\u5185\u5bb9\u3092\u78ba\u5b9a\u3059\u308b\u30b3\u30de\u30f3\u30c9\u304c `docker commit` \u3067\u3059\u3002\n\n\u4ee5\u4e0b\u306f\u30b3\u30f3\u30c6\u30ca ID 351e58d51464 \u306b`ubuntu-test`\u3068\u3044\u3046\u30bf\u30b0\u3092\u4ed8\u3051\u3066\u4fdd\u5b58\u3059\u308b\u4f8b\u3067\u3059\u3002\n\n```shell-session\nroot@ubuntu:~# docker commit 351e58d51464 ubuntu-test\nb4e346166aeaf579fb3214a3814dcc3a250f4f58cf83c88d4b66a8cf030902ab\n```\n\n\u3053\u3053\u3067\u8868\u793a\u3055\u308c\u305f\u6587\u5b57\u5217\u306f\u3001\u30b3\u30f3\u30c6\u30ca\u306e\u30a4\u30e1\u30fc\u30b8 ID \u3067\u3059\u3002`docker images` \u3067\u3082\u78ba\u8a8d\u3067\u304d\u307e\u3059\u3002\n\n```shell-session\nroot@ubuntu:~# docker  images\nREPOSITORY             TAG                 IMAGE ID            CREATED             VIRTUAL SIZE\nubuntu-test            latest              b4e346166aea        10 seconds ago      276.5 MB\n```\n\n\u3053\u3053\u3067\u4f5c\u6210\u3057\u305f `ubuntu-test` \u3092\u4f7f\u3063\u3066\u30b3\u30f3\u30c6\u30ca\u3092\u8d77\u52d5\u3059\u308b\u3068\u3001\u5185\u5bb9\u304c\u53cd\u6620\u3055\u308c\u3066\u3044\u307e\u3059\u3002\n\n```shell-session\nroot@ubuntu:~# docker run -i -t ubuntu-test /bin/bash\nroot@e8f8cc1be69d:/# cat /test\ntest\n```\n\n## 3. Apache \u304c\u52d5\u4f5c\u3059\u308b\u30b3\u30f3\u30c6\u30ca\u3092\u4f5c\u6210\n\n### 3.1. CentOS 6.5 \u306e\u30a4\u30e1\u30fc\u30b8\u3092\u4f7f\u3046\n\nCentOS \u3092\u8d77\u52d5\u3059\u308b\u969b\u3001`docker run -i -t centos /bin/bash` \u3068\u4f55\u3082\u8003\u3048\u305a\u306b\u5b9f\u884c\u3059\u308b\u3068\u3001CentOS 7 \u304c\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\u3055\u308c\u307e\u3059\u3002\n\n```shell-session\nbash-4.2# cat /etc/centos-release\nCentOS Linux release 7.0.1406 (Core)\n```\n\n\u4eca\u56de\u306f centos 6.5 \u3092\u4f7f\u3044\u305f\u3044\u306e\u3067\u3001\u307e\u305a\u306f CentOS \u306e\u30a4\u30e1\u30fc\u30b8\u3092\u53d6\u5f97\u3057\u3066\u307f\u307e\u3057\u3087\u3046\u3002`docker pull centos`\u3092\u5b9f\u884c\u3057\u307e\u3059\u3002\n\n```shell-session\nhost@ubuntu# docker pull centos\nPulling repository centos\ncd934e0010d5: Download complete\n1a7dc42f78ba: Download complete\n511136ea3c5a: Download complete\n34e94e67e63a: Download complete\nhost@ubuntu# docker images centos\nREPOSITORY          TAG                 IMAGE ID            CREATED             VIRTUAL SIZE\ncentos              centos7             1a7dc42f78ba        8 days ago          236.4 MB\ncentos              latest              1a7dc42f78ba        8 days ago          236.4 MB\ncentos              centos6             cd934e0010d5        9 days ago          206.9 MB\n```\n\u3053\u306e\u3088\u3046\u306b `docker images centos` \u3068\u5165\u529b\u3059\u308b\u3068\u3001`centos7` \u3068 `centos6` \u3068\u30bf\u30b0\u304c\u4ed8\u3044\u3066\u3044\u308b\u3053\u3068\u304c\u5206\u304b\u308a\u307e\u3059\uff08\u53c2\u8003\uff1ahttp://wiki.centos.org/Cloud/Docker\uff09\n\n\u3053\u306e\u3053\u3068\u304b\u3089\u3001centos \u306e\u30d9\u30fc\u30b9\u30a4\u30e1\u30fc\u30b8\u4f7f\u7528\u6642\u3001`centos6` \u306e\u30bf\u30b0\u3092\u6307\u5b9a\u3059\u308b\u3053\u3068\u3067\u3001CentOS 6 \u306e\u30b3\u30f3\u30c6\u30ca\u304c\u8d77\u52d5\u3067\u304d\u307e\u3059\u3002\n\n```shell-session\nhost@ubuntu# docker run -t -i centos:centos6 /bin/bash\ncontainer@bash-4.1# cat /etc/centos-release\nCentOS release 6.5 (Final)\n```\n\n### 3.2. Apache \u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n\u305d\u308c\u3067\u306f\u3001Apache \u3092\u8d77\u52d5\u3057\u3001\u30d6\u30e9\u30a6\u30b6\u306b `Nifty` \u3068\u8868\u793a\u3055\u305b\u3066\u307f\u307e\u3057\u3087\u3046\u3002\n\n\u5f15\u304d\u7d9a\u304d\u30b3\u30f3\u30c6\u30ca\u306e\u4e2d\u3067\u4f5c\u696d\u3057\u307e\u3059\u3002\n\n```shell-session\ncontainer@bash-4.1# yum -y install httpd\n\nApache \u8d77\u52d5\u30c6\u30b9\u30c8\ncontainer@bash-4.1# service httpd start\nStarting httpd: httpd: Could not reliably determine the server's fully qualified domain name, using 172.17.0.15 for ServerName\n                                                           [  OK  ]\n```\n\n\u3053\u308c\u3067\u3001\u30b3\u30f3\u30c6\u30ca\u306e\u4e2d\u3067 Apache \u304c\u8d77\u52d5\u3057\u307e\u3057\u305f\u3002\n\n\u6b21\u306b\u3001\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u30eb\u30fc\u30c8\u306b\u30d5\u30a1\u30a4\u30eb\u3092\u7f6e\u304d\u307e\u3059\u3002\n\n```shell-session\ncontainer@bash-4.1# echo 'Nifty' > /var/www/html/index.html\ncontainer@bash-4.1# cat /var/www/html/index.html\nNifty\n```\n\n\u3067\u3059\u304c\u3001\u3053\u306e\u307e\u307e\u3067\u306f\u30d6\u30e9\u30a6\u30b6\u304b\u3089\u52d5\u4f5c\u78ba\u8a8d\u3067\u304d\u307e\u305b\u3093\u3002\n\n\u30b3\u30f3\u30c6\u30ca\u5185\u306e Apache \u30dd\u30fc\u30c880 \u3092\u3001\u30db\u30b9\u30c8\u4e0a\u3068\u5bfe\u5fdc\u3055\u305b\u308b\u306b\u306f\u3001`-p` \u3067\u30dd\u30fc\u30c8\u306e\u8a2d\u5b9a\u3092\u884c\u3044\u307e\u3059\u3002\n\n\u4e00\u65e6\u30b3\u30f3\u30c6\u30ca\u304b\u3089\u629c\u3051\u307e\u3059\u3002\n\n```shell-session\ncontainer@bash-4.1# exit\nexit\n```\n\n`docker ps -a` \u3067\u6700\u5f8c\u306b\u8d77\u52d5\u3057\u305f\u30b3\u30f3\u30c6\u30ca ID \u3092\u898b\u3064\u3051\u307e\u3059\u3002\n\n```shell-session\nhost@ubuntu# docker ps -a\nCONTAINER ID        IMAGE               COMMAND                CREATED             STATUS                           PORTS                NAMES\n011d4e7c710a        centos:centos6      /bin/bash              3 minutes ago       Exited (0) 28 seconds ago                             grave_elion\n```\n\n\u3053\u308c\u3092 `commit`\u3057\u3066\u30a4\u30e1\u30fc\u30b8\u3092\u4fdd\u7ba1\u3057\u307e\u3059\u3002\n\n```shell-session\nhost@ubuntu# docker commit 011d4e7c710a nifty\nfc1302aef7d77dd1d1523c51570b7a16ee832e75f2f1981dcfac77844bc9a874\n```\n\n`docker run` \u306b `-p 80:80`\u30aa\u30d7\u30b7\u30e7\u30f3\u3092\u4ed8\u3051\u3066\u3001\u30db\u30b9\u30c8\u5074\u3068\u30b3\u30f3\u30c6\u30ca\u5074\u306e Port 80 \u3092\u3064\u306a\u304e\u307e\u3059\u3002\n\n```shell-session\nhost@ubuntu# docker run -i -t -p 80:80 nifty /bin/bash\ndbc0637214199f35324ef9963ba5f77d70e0543a740325775e4768d1dc9a219c\n```\n\n\u30b3\u30f3\u30c6\u30ca\u306e\u4e2d\u3067\u518d\u3073 Apache \u3092\u8d77\u52d5\u3057\u307e\u3059\u3002\n\n```shell-session\ncontainer@bash-4.1# service httpd start\nStarting httpd: httpd: Could not reliably determine the server's fully qualified domain name, using 172.17.0.23 for ServerName\n                                                           [  OK  ]\n```\n\n\u30d6\u30e9\u30a6\u30b6\u304b\u3089 `http://\u30cb\u30d5\u30c6\u30a3\u30af\u30e9\u30a6\u30c9\u306eIP\u30a2\u30c9\u30ec\u30b9/ ` \u306b\u30a2\u30af\u30bb\u30b9\u3059\u308b\u3068\u3001\u753b\u9762\u306b `Nifty` \u304c\u8868\u793a\u3055\u308c\u307e\u3059\u3002\u30db\u30b9\u30c8\u5074\u306e\u30dd\u30fc\u30c8 80 \u3068\u3001\u30b3\u30f3\u30c6\u30ca\u306e\u4e2d\u306e\u30dd\u30fc\u30c8 80 \u304c\u5bfe\u5fdc\u3057\u305f\u304b\u3089\u3067\u3059\u3002\n\n\u3053\u306e\u3088\u3046\u306b\u3001\u901a\u5e38\u3001\u30b3\u30f3\u30c6\u30ca\u306e\u4e2d\u306e\u30dd\u30fc\u30c8\u3068\u30db\u30b9\u30c8\u5074\u306e\u30dd\u30fc\u30c8\u3092\u5bfe\u5fdc\u3055\u305b\u308b\u306b\u306f\u3001\u624b\u52d5\u3067\u660e\u793a\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\n\n## 4. Docker \u30b3\u30f3\u30c6\u30ca\u306e\u30a4\u30e1\u30fc\u30b8\u3092\u51fa\u529b (export)\n\n\u3055\u3066\u3001\u305d\u308c\u3067\u306f\u30b3\u30f3\u30c6\u30ca\u3092\u4ed6\u306e\u30af\u30e9\u30a6\u30c9\uff08\u3053\u3053\u3067\u306f\u3055\u304f\u3089\u306e\u30af\u30e9\u30a6\u30c9\uff09\u306b\u79fb\u52d5\u3059\u308b\u305f\u3081\u306e\u6e96\u5099\u3092\u9032\u3081\u307e\u3059\u3002\u30b3\u30f3\u30c6\u30ca\u3092\u79fb\u52d5\u3055\u305b\u308b\u306b\u306f\u3001\u3044\u304f\u3064\u304b\u306e\u65b9\u6cd5\u304c\u3042\u308a\u307e\u3059\u304c\u3001\u3053\u3053\u3067\u306f\u30a4\u30e1\u30fc\u30b8\u3092\u30d5\u30a1\u30a4\u30eb\u3068\u3057\u3066\u51fa\u529b\u3057\u3001\u305d\u308c\u3092\u79fb\u52d5\u3059\u308b\u65b9\u6cd5\u3092\u4f7f\u3044\u307e\u3059\u3002\n\n### 4.1. \u30b3\u30f3\u30c6\u30ca ID \u306e\u78ba\u8a8d\n\n`docker ps -a` \u3067\u5bfe\u8c61\u306e\u30b3\u30f3\u30c6\u30caID \u3092\u78ba\u8a8d\u3057\u307e\u3059\n\n```shell-session\nhost@ubuntu# docker ps -a\n\tCONTAINER ID        IMAGE               COMMAND                CREATED             STATUS                           PORTS                NAMES\n\t011d4e7c710a        centos:centos6      /bin/bash              3 minutes ago       Exited (0) 28 seconds ago                             grave_elion\n```\n\n### 4.2. `docker export` \u306e\u5b9f\u884c\n\n`docker export`\u30b3\u30de\u30f3\u30c9\u306f\u3001\u30a4\u30e1\u30fc\u30b8\u5185\u5bb9\u3092\u6a19\u6e96\u51fa\u529b\u306b\u51fa\u529b\u3059\u308b\u3082\u306e\u3067\u3059\u3002\u30ea\u30c0\u30a4\u30ec\u30af\u30c8\u3057\u3066\u3001\u30d5\u30a1\u30a4\u30eb\u306b\u66f8\u304d\u51fa\u3057\u307e\u3059\u3002\n\n```shell-session\nhost@ubuntu# docker export 011d4e7c710a > nifty.tar\n```\n\n\u3053\u308c\u3067\u3001\u30a4\u30e1\u30fc\u30b8ID `011d4e7c710a` \u306e\u5185\u5bb9\u304c`nifty.tar`\u306b\u51fa\u529b\u3055\u308c\u307e\u3057\u305f\u3002\n\n### 4.3. export \u3057\u305f\u30a4\u30e1\u30fc\u30b8\u3092\u3055\u304f\u3089\u306e\u30af\u30e9\u30a6\u30c9\u3078\u79fb\u52d5\n\n`scp` \u30b3\u30de\u30f3\u30c9\u3092\u4f7f\u3044\u3001\u3055\u304f\u3089\u306e\u30af\u30e9\u30a6\u30c9\u306e\u30db\u30b9\u30c8\u4e0a\u306b\u8ee2\u9001\u3057\u307e\u3059\u3002\n\n```shell-session\nhost@ubuntu$ scp ./nifty.tar root@<\u3055\u304f\u3089\u306eIP\u30a2\u30c9\u30ec\u30b9>:/tmp/\n```\n\n\u3042\u3068\u306f\u3001\u3055\u304f\u3089\u5074\u3067\u8ee2\u9001\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\u5bfe\u8c61\u30b5\u30fc\u30d0\u306b SSH \u30ed\u30b0\u30a4\u30f3\u3057\u3001`/tmp` \u4ee5\u4e0b\u306b\u30d5\u30a1\u30a4\u30eb\u304c\u3042\u308b\u304b\u3069\u3046\u304b\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\n\n```shell-session\n[root@sakura2 /]# ll /tmp/\n\u5408\u8a08 372656\n-rw-r--r-- 1 root root 381596672  7\u6708 18 15:00 2014 nifty.tar\n```\n\n## 5. \u3055\u304f\u3089\u306e\u30af\u30e9\u30a6\u30c9\u3067 Docker \u306e\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7 ( CentOS 6.5 )\n\n\u6b21\u306f\u3001CentOS 6.5 \u4e0a\u3067 Docker \u3092\u4f7f\u3048\u308b\u3088\u3046\u306b\u3057\u307e\u3059\u3002\n\n### 5.1. docker-io \u30d1\u30c3\u30b1\u30fc\u30b8\u306e\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\n\n`yum` \u3092\u4f7f\u3063\u3066\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\u3057\u307e\u3059\u3002\n\n```shell-session\nhost@centos# yum install docker-io\n```\n\u203b\u3055\u304f\u3089\u306e\u30af\u30e9\u30a6\u30c9\u3067\u306f\u3001\u521d\u671f\u72b6\u614b\u304b\u3089 EPEL \u30d1\u30c3\u30b1\u30fc\u30b8\u304c\u6709\u52b9\u3067\u3059\u3002\u3082\u3057\u3001\u6709\u52b9\u3067\u306f\u306a\u3044\u74b0\u5883\u3067\u306f\u3001\u4e88\u3081\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\u304c\u5fc5\u8981\u3067\u3059\u3002\n\n### 5.2. Docker \u306e\u8d77\u52d5\n\n```shell-session\nhost@centos# service docker start\nStarting cgconfig service:                                 [  OK  ]\nStarting docker:                                           [  OK  ]\t\n```\n\n\u3053\u308c\u3067\u8d77\u52d5\u5b8c\u4e86\u3067\u3059\u3002\u30d0\u30fc\u30b8\u30e7\u30f3\u756a\u53f7\u3092\u78ba\u8a8d\u3057\u307e\u3057\u3087\u3046\u3002\n\n```shell-session\nhost@centos# docker  --version\nDocker version 1.0.0, build 63fe64c/1.0.0\n```\n\n\u305d\u3057\u3066\u3001Docker \u304c\u3001\u30d6\u30fc\u30c8\u6642\u306b\u81ea\u52d5\u8d77\u52d5\u304c\u6709\u52b9\u5316\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\n\n```shell-session\nhost@centos# chkconfig --list docker\ndocker          0:off   1:off   2:on    3:on    4:on    5:on    6:off\n```\n\n## 6. \u5916\u90e8\u306e Docker \u30a4\u30e1\u30fc\u30b8\u3092\u53d6\u308a\u8fbc\u3093\u3067\u3001\u30b3\u30f3\u30c6\u30ca\u3092\u8d77\u52d5\n\n\u30cb\u30d5\u30c6\u30a3\u30af\u30e9\u30a6\u30c9\u3067\u4f5c\u6210\u3057\u305f\u30b3\u30f3\u30c6\u30ca\u306e\u30a4\u30e1\u30fc\u30b8\u3092\u3001\u3055\u304f\u3089\u4e0a\u306e Docker \u3067\u52d5\u304b\u3057\u307e\u3059\u3002\n\n### 6.1. \u30a4\u30e1\u30fc\u30b8\u306e\u53d6\u308a\u8fbc\u307f (import)\n\n\u53d6\u308a\u8fbc\u3080\u305f\u3081\u306b\u306f `docker import` \u3092\u4f7f\u3044\u307e\u3059\u3002\n`scp` \u3067\u8ee2\u9001\u3057\u3066\u3066\u3042\u308b\u30a4\u30e1\u30fc\u30b8\u30d5\u30a1\u30a4\u30eb\u306f `/tmp/nifty.tar` \u3067\u3059\u3002\u3053\u308c\u3092\u53d6\u308a\u8fbc\u3080\u306b\u306f\u3001\u6b21\u306e\u3088\u3046\u306b\u3057\u307e\u3059\u3002\u3053\u3053\u3067\u306f `docker impoart` \u306e\u3042\u3068\u3067\u3001\u30a4\u30e1\u30fc\u30b8\u306e\u30bf\u30b0\u540d\u79f0\u3092 `nifty` \u3068\u6307\u5b9a\u3057\u307e\u3059\u3002\n\n```shell-session\nhost@centos# cat /tmp/nifty.tar | docker import - nifty\n8f8b42ee46a3d9d4add809b78ba6221b04c6dae3a750c2afe68f7e46685a642e\n```\n\n\u53d6\u308a\u8fbc\u307e\u308c\u308b\u3068\u3001\u65b0\u305f\u306b\u30a4\u30e1\u30fc\u30b8 ID \u304c\u4ed8\u4e0e\u3055\u308c\u307e\u3059\u3002`docker images` \u30b3\u30de\u30f3\u30c9\u3067\u3082\u78ba\u8a8d\u304c\u51fa\u6765\u307e\u3059\u3002\n\n```shell-session\nhost@centos# docker images\nREPOSITORY          TAG                 IMAGE ID            CREATED             VIRTUAL SIZE\nnifty               latest              8f8b42ee46a3        14 seconds ago      369.6 MB\n```\n\n### 6.2. \u53d6\u308a\u8fbc\u3093\u3060\u30a4\u30e1\u30fc\u30b8\u3092\u4f7f\u3063\u3066\u8d77\u52d5\n\n\u4e00\u5ea6\u30a4\u30e1\u30fc\u30b8\u3068\u3057\u3066\u8a8d\u8b58\u3055\u308c\u3066\u3057\u307e\u3048\u3070\u3001\u5148\u307b\u3069\u306e\u30b3\u30f3\u30c6\u30ca\u8d77\u52d5\u3068\u624b\u9806\u306f\u5909\u308f\u308a\u307e\u305b\u3093\u3002\u8d77\u52d5\u6642\u306b `nifty` \u3068\u3044\u3046\u30bf\u30b0\u3092\u6307\u5b9a\u3057\u307e\u3059\u3002\n\n```shell-session\nhost@centos# docker run -t -i -d -p 80:80 nifty /bin/bash\n```\n\n\u4eca\u5ea6\u306f `-d` \u30aa\u30d7\u30b7\u30e7\u30f3\u3092\u4ed8\u3051\u3066\u30c7\u30fc\u30e2\u30f3\u30e2\u30fc\u30c9\u3067\u8d77\u52d5\u3057\u307e\u3057\u305f\u3002\n\u3053\u306e\u307e\u307e\u3067\u306f apache \u304c\u8d77\u52d5\u3057\u3066\u3044\u306a\u3044\u305f\u3081 `docker attach` \u30b3\u30de\u30f3\u30c9\u3067\u3001\u30b3\u30f3\u30c6\u30ca\u306b\u63a5\u7d9a\u3057\u307e\u3059\u3002\n\n\u307e\u305a `docker ps` \u30b3\u30de\u30f3\u30c9\u3067\u3001\u30b3\u30f3\u30c6\u30ca ID \u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\n\n```shell-session\nhost@centos# docker ps\nCONTAINER ID        IMAGE                   COMMAND             CREATED             STATUS              PORTS                NAMES\n3a7fd68ca680        zembutsu/nifty:latest   /bin/bash           5 seconds ago       Up 4 seconds        0.0.0.0:80->80/tcp   loving_kirch\n```\n\n\u305d\u3057\u3066\u3001\u30b3\u30de\u30f3\u30c9 `docker attach` \u3068\u5165\u529b\u3057\u305f\u3042\u3068\u306f\u3001\u30a8\u30f3\u30bf\u30fc\u30ad\u30fc\u30922\u56de\u62bc\u3057\u307e\u3059\u3002\n\n```shell-session\nhost@centos# docker attach 3a7fd68ca680\n\nbash-4.1#\n```\n\n\u3053\u308c\u3067\u30b3\u30f3\u30c6\u30ca\u306e\u4e2d\u306b\u5165\u308a\u307e\u3057\u305f\u3002\u3042\u3068\u306f `service httpd start` \u3068\u5b9f\u884c\u3057\u3001Apache \u3092\u8d77\u52d5\u3057\u307e\u3059\u3002\n\n```shell-session\ncontainer@centos# service httpd start\nStarting httpd: httpd: Could not reliably determine the server's fully qualified domain name, using 172.17.0.2 for ServerName\n                                                   [  OK  ]\n```\n\n\u3053\u308c\u3067\u3001\u30d6\u30e9\u30a6\u30b6\u304b\u3089\u3055\u304f\u3089\u306e IP \u30a2\u30c9\u30ec\u30b9\u306b\u30a2\u30af\u30bb\u30b9\u3059\u308b\u3068\u3001\u753b\u9762\u306b\u300c Nifty \u300d\u3068\u8868\u793a\u3055\u308c\u307e\u3059\u3002\n\n\u306a\u304a\u3001\u30b3\u30f3\u30c6\u30ca\u5185\u306e `/var/www/html/index.html` \u306e\u4e2d\u8eab\u3092 ` sakura` \u7b49\u306b\u66f8\u304d\u63db\u3048\u308b\u3068\u3001\u5909\u66f4\u5185\u5bb9\u304c\u53cd\u6620\u3055\u308c\u308b\u4e8b\u304c\u78ba\u8a8d\u3067\u304d\u307e\u3059\u3002\n\n\u3053\u306e\u5909\u66f4\u5185\u5bb9\u3092\u30a4\u30e1\u30fc\u30b8\u3068\u3057\u3066\u4fdd\u5b58\u3059\u308b\u5834\u5408\u306f\u3001`docker commit`\u3092\u5fd8\u308c\u305a\u306b\u884c\u3044\u307e\u3059\u3002\n\n\u306a\u304a\u3001\u30c7\u30fc\u30e2\u30f3\u5316\u3055\u308c\u305f\u30b3\u30f3\u30c6\u30ca\u306e\u505c\u6b62\u306f\u3001`docker stop \u30b3\u30f3\u30c6\u30caID` \u3067\u3059\u3002\n\n## 7. Dockerfile \u3067 Apache \u304c\u52d5\u304f\u30b3\u30f3\u30c6\u30ca\u3092\u4f5c\u6210\n \n\u3053\u308c\u307e\u3067\u624b\u52d5\u3067\u30b3\u30f3\u30c6\u30ca\u3092\u4f5c\u6210\u3057\u3066\u304d\u307e\u3057\u305f\u3002\u3082\u3057\u3001\u30b3\u30f3\u30c6\u30ca\u3092\u8907\u6570\u4f5c\u6210\u3057\u305f\u3044\u5834\u5408\u306f\u3001\u5927\u5909\u3067\u3059\u3002\u305d\u3053\u3067\u3001`Dockerfile` \u3068\u3044\u3046\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3092\u4f7f\u3044\u3001\u30a4\u30e1\u30fc\u30b8\u3092\u4f5c\u6210\u3059\u308b\u65b9\u6cd5\u3092\u8a66\u3057\u307e\u3057\u3087\u3046\u3002\n\n\u3072\u304d\u3064\u3065\u304d\u3001\u3055\u304f\u3089\u306e\u30af\u30e9\u30a6\u30c9\u4e0a\u3067\u4f5c\u696d\u3092\u884c\u3044\u307e\u3059\u3002\n\n### 7.1. \u4f5c\u696d\u7528\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306e\u4f5c\u6210\n\n```shell-session\nhost@centos# mkdir /root/docker\nhost@centos# cd /root/docker\n```\n\n### 7.2. Dockerfile \u3092\u4f5c\u6210\n\n```shell-session\nhost@centos# touch Dockerfile\nhost@centos# vi Dockerfile\n```\n\n\u3053\u3053\u3067\u306f `vi` \u3068\u3057\u307e\u3057\u305f\u304c\u3001\u597d\u304d\u306a\u30a8\u30c7\u30a3\u30bf\u3092\u3064\u304b\u3063\u3066\u7de8\u96c6\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n```text:Dockerfile\nFROM centos:centos6\nMAINTAINER 0.1. NAME, NAME@example.jp\nRUN echo 'ZONE=\"Asia/Tokyo\"' > /etc/sysconfig/clock\n\nRUN rpm --import http://dl.fedoraproject.org/pub/epel/RPM-GPG-KEY-EPEL-6\nRUN yum -y install httpd\nRUN echo 'sakura' > /var/www/html/index.html\n\nEXPOSE 80\n\nENTRYPOINT [\"/usr/sbin/httpd\"]\nCMD [\"-D\", \"FOREGROUND\"]\n```\n\n\u203b\u5185\u5bb9\u306f\u3001\u3053\u308c\u307e\u3067\u624b\u4f5c\u696d\u3067\u884c\u3063\u3066\u304d\u305f\u4e8b\u3092\u3001\u6c4e\u7528\u5316\u3057\u305f\u3082\u306e\u3067\u3059\u3002\n\n### 7.3. `docker build` \u3067\u30a4\u30e1\u30fc\u30b8\u3092\u4f5c\u6210\n\n`docker build` \u3092\u4f7f\u3044\u3001`Dockerfile` \u304b\u3089\u30a4\u30e1\u30fc\u30b8\u3092\u69cb\u7bc9\u3057\u307e\u3059\u3002\u4f5c\u6210\u6642\u3001`-t sakura`\u3068\u3057\u3066\u30bf\u30b0\u3092\u3064\u3051\u3001Dockerfile \u306e\u5834\u6240\u306f `.` (\u30ab\u30ec\u30f3\u30c8\u30c7\u30a3\u30ec\u30af\u30c8\u30ea) \u3092\u6307\u5b9a\u3057\u307e\u3059\u3002\n\n```shell-session\nhost@centos# docker build -t sakura .\nSending build context to Docker daemon  2.56 kB\nSending build context to Docker daemon\nStep 0 : FROM centos:centos6\n ---> cd934e0010d5\n(\u7565)\nRemoving intermediate container c3cb9248cd23\n\nSuccessfully built fb4e8342e368\n```\n\n### 7.4. Dockerfile \u3067\u4f5c\u6210\u3057\u305f\u30a4\u30e1\u30fc\u30b8\u4f7f\u3044\u30b3\u30f3\u30c6\u30ca\u8d77\u52d5\n\n\u4e00\u5ea6\u30a4\u30e1\u30fc\u30b8\u3092\u4f5c\u6210\u3057\u3066\u3057\u307e\u3048\u3070\u3001\u901a\u5e38\u306e\u30b3\u30f3\u30c6\u30ca\u8d77\u52d5\u3068\u5909\u308f\u308a\u307e\u305b\u3093\u3002\u30bf\u30b0\u306b `sakura` \u3068\u6307\u5b9a\u3057\u307e\u3059\u3002\n\n```shell-session\nhost@centos# docker run -p 80:80 -d sakura\nccd43daa046d012461c25a5ec0aa465ad6d308815923049d7f53f458cb3780f2\n\nhost@centos# docker ps\nCONTAINER ID        IMAGE                     COMMAND                CREATED             STATUS              PORTS                NAMES\nccd43daa046d        sakura:latest             /usr/sbin/httpd -D F   3 seconds ago       Up 2 seconds        0.0.0.0:80->80/tcp   silly_brown\n```\n\n\u30d6\u30e9\u30a6\u30b6\u304b\u3089 `http://\u3055\u304f\u3089\u306e IP \u30a2\u30c9\u30ec\u30b9/` \u306b\u30a2\u30af\u30bb\u30b9\u3059\u308b\u3068\n\u753b\u9762\u306b `sakura` \u3068\u8868\u793a\u3055\u308c\u307e\u3059\u3002\n\n## 8. PukiWiki \u306e\u30b3\u30f3\u30c6\u30ca\u3092\u4f5c\u6210\u3059\u308b\n\n\u6b21\u306b\u3001\u52d5\u7684\u306a\u30b3\u30f3\u30c6\u30f3\u30c4\u304c\u52d5\u4f5c\u3059\u308b\u30b3\u30f3\u30c6\u30ca\u3092\u3064\u304f\u308a\u3001\u5225\u306e\u30af\u30e9\u30a6\u30c9\u306b\u79fb\u3057\u3066\u307f\u307e\u3057\u3087\u3046\u3002\u3053\u3053\u3067\u306f PHP \u306e\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3 `PukiWiki` \u3092\u7528\u3044\u307e\u3059\u3002\n\n\u5f15\u304d\u7d9a\u304d\u3001\u3055\u304f\u3089\u306e\u30af\u30e9\u30a6\u30c9\u4e0a\u3067\u4f5c\u696d\u3092\u884c\u3044\u307e\u3059\u3002\n\n### 8.1. \u30b3\u30f3\u30c6\u30ca\u3092\u4f5c\u6210\n\n```shell-session\nhost@centos# docker run -i -t -p 80:80 centos:centos6 /bin/bash\nbash-4.1#\n```\n\u65b0\u3057\u304f `-p 80:80` \u306e\u30aa\u30d7\u30b7\u30e7\u30f3\u3092\u4f7f\u7528\u3057\u307e\u3059\u3002\u3053\u308c\u306f\u3001\u30db\u30b9\u30c8\u5074\u306e\u30dd\u30fc\u30c8 80 \u3068\u3001\u30b3\u30f3\u30c6\u30ca\u5185\u306e\u30dd\u30fc\u30c8 80 \u3092\u30ea\u30f3\u30af\u3059\u308b\u305f\u3081\u306e\u30aa\u30d7\u30b7\u30e7\u30f3\u6307\u5b9a\u3067\u3059\u3002\u3053\u306e\u6307\u5b9a\u304c\u7121\u3044\u3068\u3001\u30b3\u30f3\u30c6\u30ca\u306b\u5bfe\u3057\u3066\u5916\u90e8\u306e\u30b5\u30fc\u30d3\u30b9\u304b\u3089\u63a5\u7d9a\u3059\u308b\u3053\u3068\u306f\u51fa\u6765\u307e\u305b\u3093\u3002\n\n\u30bf\u30a4\u30e0\u30be\u30fc\u30f3\u3092\u88dc\u6b63\u3057\u307e\u3059\u3002\n\n```shell-session\ncontainer@lxc# echo 'ZONE=\"Asia/Tokyo\"' > /etc/sysconfig/clock\n```\n\uff08\u5225\u89e3\uff1acp /usr/share/zoneinfo/Japan /etc/localtime \uff09\n\n### 8.2. \u30d1\u30c3\u30b1\u30fc\u30b8\u306e\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\n\nApache \u307b\u304b\u3001\u5fc5\u8981\u306b\u306a\u308b\u30d1\u30c3\u30b1\u30fc\u30b8\u3092\u5165\u308c\u307e\u3059\u3002\n\n```shell-session\ncontainer@lxc# yum -y install httpd php wget unzip\n```\n\n### 8.3. PukiWiki \u306e\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\n\n`/var/www/html/wiki` \u306b PukiWiki \u3092\u7f6e\u304d\u307e\u3059\u3002\n\n\n```shell-session\ncontainer@lxc# wget -O pukiwiki-1_5_0_rc1_utf8.zip 'http://sourceforge.jp/frs/redir.php?m=iij&f=%2Fpukiwiki%2F61572%2Fpukiwiki-1_5_0_rc1_utf8.zip'\ncontainer@lxc# unzip ./pukiwiki-1_5_0_rc1_utf8.zip\ncontainer@lxc# mv pukiwiki-1_5_0_utf8/ /var/www/html/wiki\ncontainer@lxc# cd /var/www/html/wiki\ncontainer@lxc# chown -R apache.apache /var/www/html/wiki\n```\n\nPukiWiki \u306e\u30d1\u30b9\u30ef\u30fc\u30c9\u3092\u5909\u66f4\u3057\u307e\u3059\u3002\n\u203b\u4ee5\u4e0b 'pass9999' \u306e\u7b87\u6240\u3092\u4efb\u610f\u306e\u6587\u5b57\u5217\u306b\u7f6e\u304d\u63db\u3048\u3066\u304f\u3060\u3055\u3044\u3002\n\n```shell-session\ncontainer@lxc# sed -i -e \"s#$adminpass = '{x-php-md5}\\!';#$adminpass = '{x-php-md5}' . md5('pass9999');#\" pukiwiki.ini.php\n```\n\uff08\u30d1\u30b9\u30ef\u30fc\u30c9\u306e\u8a2d\u5b9a\u3092\u884c\u3063\u3066\u3044\u307e\u3059\u3002\u76f4\u63a5 pukiwiki.ini.php \u3092\u66f8\u304d\u63db\u3048\u3066\u3082\u69cb\u3044\u307e\u305b\u3093\uff09\n\n\u30b3\u30f3\u30c6\u30f3\u30c4\u7528\u306e\u30d5\u30a1\u30a4\u30eb\u3092\u7f6e\u304d\u307e\u3059\u3002\n\n```shell-session\ncontainer@lxc# echo 'sakura' > /var/www/html/index.html\n```\n\nApache \u3092\u8d77\u52d5\u3057\u307e\u3059\u3002\n\n```shell-session\ncontainer@lxc# service httpd start\n```\n\n\u30d6\u30e9\u30a6\u30b6\u304b\u3089 `http://<host>/` \u306b\u30a2\u30af\u30bb\u30b9\u3059\u308b\u3068`sakura` \u304c\u898b\u3048\u307e\u3059\u3002\n\n\u30d6\u30e9\u30a6\u30b6\u304b\u3089 `http://<host>/wiki/` \u306b\u30a2\u30af\u30bb\u30b9\u3059\u308b\u3068 PukiWiki \u304c\u8868\u793a\u3055\u308c\u307e\u3059\u3002\n\n\u4f55\u304b\u7de8\u96c6\u3057\u3066\u3001\u8a2d\u5b9a\u304c\u53cd\u6620\u3055\u308c\u308b\u4e8b\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\n\n### 8.4. \u30b3\u30f3\u30c6\u30ca\u306e\u5909\u66f4\u5185\u5bb9\u3092\u53cd\u6620(commit)\u3059\u308b\n\n\u4fdd\u5b58\u3059\u308b\u305f\u3081\u306b\u306f\u3001\u30b3\u30f3\u30c6\u30ca ID \u3092\u6307\u5b9a\u3057\u3066\u3001`docker commit` \u3057\u307e\u3059\u3002\n\n```shell-session\nhost@centos# docker ps -a | head\nCONTAINER ID        IMAGE                     COMMAND                CREATED             STATUS                         PORTS               NAMES\nc47b41e0cd99        wiki:latest     /bin/bash              17 minutes ago      Exited (0) 5 seconds ago                           determined_elion\n\n\nhost@centos# docker commit c47b41e0cd99 wiki:sakura\n3df585a2bde00c2183eb8be8621b40e9a2d003091feed556a428ffc4b5d7a492\n```\n\n\u306a\u304a\u3001\u3053\u3053\u3067\u306f\u30bf\u30b0\u306b `wiki:sakura` \u3068\u540d\u4ed8\u3051\u307e\u3057\u305f\u3002\n\n\u3053\u306e\u72b6\u614b\u3067\u518d\u5ea6\u30b3\u30f3\u30c6\u30ca\u306b\u63a5\u7d9a\u3059\u308b\u5834\u5408\u306f\u3001\u6b21\u306e\u3088\u3046\u306b\u3057\u307e\u3059\u3002\n\n```shell-session\nhost@centos# docker run -p 80:80 -t -i wiki:sakura /bin/bash\nbash-4.1# service httpd start\nStarting httpd: httpd: Could not reliably determine the server's fully qualified domain name, using 172.17.0.24 for ServerName\n                                                           [  OK  ]\n```\n\n\u306a\u304a\u3001\u30b3\u30f3\u30c6\u30ca\u306e\u66f4\u65b0\u8a18\u9332\u306f `docker history` \u30b3\u30de\u30f3\u30c9\u3067\u8abf\u3079\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n```shell-session\nhost@centos# docker history wiki:sakura\nIMAGE               CREATED             CREATED BY          SIZE\n3df585a2bde0        2 minutes ago       /bin/bash           15.75 MB\n8f8b42ee46a3        2 hours ago                             369.6 MB\n```\n\n## 9. Pukiwiki \u306e\u30b3\u30f3\u30c6\u30ca\u3092\u3001\u3055\u304f\u3089\u2192\u30cb\u30d5\u30c6\u30a3\u306b\u79fb\u52d5\n\n\u52d5\u7684\u306a\u30b3\u30f3\u30c6\u30f3\u30c4\u306e\u5834\u5408\u3067\u3082\u3001\u5148\u307b\u3069\u306e Apache \u30b3\u30f3\u30c6\u30ca\u3092\u79fb\u52d5\u3057\u305f\u6642\u3068\u624b\u9806\u306f\u540c\u3058\u3067\u3059\u3002\n\n### 9.1. \u3055\u304f\u3089\u5074\u3067\u30b3\u30f3\u30c6\u30ca\u306e export\n\n```shell-session\nhost@centos# docker ps -a\n```\n\n\u30b3\u30f3\u30c6\u30caID \u3092\u8abf\u3079\u3001export \u3057\u307e\u3059\u3002\n\n```shell-session\nhost@centos# docker export \u30b3\u30f3\u30c6\u30caID > sakura-wiki.tar\n```\n\n\u51fa\u529b\u3057\u305f\u30d5\u30a1\u30a4\u30eb\u3092 `scp` \u3067\u30cb\u30d5\u30c6\u30a3\u3078\u8ee2\u9001\u3057\u307e\u3059\u3002\n\n```shell-session\nhost@centos# scp ./sakura-wiki.tar root@<nifty\u306eIP\u30a2\u30c9\u30ec\u30b9>:/tmp/\nEnter passphrase for key '/root/.ssh/id_rsa':\nsakura-wiki.tar                                         100%  368MB  10.2MB/s   00:36\n```\n\n### 9.2. \u30cb\u30d5\u30c6\u30a3\u5074\u3067\u30b3\u30f3\u30c6\u30ca\u306e\u53d6\u308a\u8fbc\u307f(import)\n\n\u30cb\u30d5\u30c6\u30a3\u5074\u306e\u30b5\u30fc\u30d0\u306b\u30ed\u30b0\u30a4\u30f3\u3057\u307e\u3059\u3002\u305d\u306e\u5f8c\u3001`docker import`\u3067\u30a4\u30e1\u30fc\u30b8\u3092\u53d6\u308a\u8fbc\u307f\u307e\u3059\u3002\u30bf\u30b0\u540d\u306f `wiki:sakura` \u3068\u3057\u307e\u3059\u3002\n\n```shell-session\nroot@ubuntu:~# cat /tmp/sakura-wiki.tar | docker import - wiki:sakura\n411ab7beb10766680e32103f837ccad739b5aba71f366f94f9a71de0496f26ff\n```\n\n### 9.3. \u53d6\u308a\u8fbc\u3093\u3060\u30b3\u30f3\u30c6\u30ca\u306e\u8d77\u52d5\n\n\u30b3\u30f3\u30c6\u30ca\u3092\u8d77\u52d5\u3057\u307e\u3059\u3002\u30bf\u30b0 `wiki:sakura` \u3092\u6307\u5b9a\u3057\u307e\u3059\u3002\n\n```shell-session\nhost@ubuntu# docker run -p 80:80 -t -i wiki:sakura /bin/bash\n```\n\n\u30b3\u30f3\u30c6\u30ca\u306e\u4e2d\u3067 Apache \u3092\u8d77\u52d5\u3057\u307e\u3059\n\n```shell-session\ncontainer@bash-4.1# service httpd start\nStarting httpd: httpd: Could not reliably determine the server's fully qualified domain name, using 172.17.0.2 for ServerName\n                                                           [  OK  ]\n```\n\n\u6700\u5f8c\u306b\u3001\u30d6\u30e9\u30a6\u30b6\u304b\u3089\u306e\u8868\u793a\u78ba\u8a8d\u3092\u884c\u3044\u307e\u3059\u3002`http://IP\u30a2\u30c9\u30ec\u30b9/wiki/` \u306b\u30a2\u30af\u30bb\u30b9\u3059\u308b\u3068\u3001\u3055\u304f\u3089\u3068\u540c\u69d8\u306e\u5185\u5bb9\u304c\u8868\u793a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\u307e\u305f\u3001\u7de8\u96c6\u3082\u51fa\u6765\u308b\u4e8b\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\n\n## 10. Dockerfile \u3067 PukiWiki \u306e\u30b3\u30f3\u30c6\u30ca\u3092\u69cb\u7bc9\n\n\u5148\u307b\u3069\u306e Apahce \u7528\u306e\u30b3\u30f3\u30c6\u30ca\u3068\u540c\u69d8\u306b\u3001PukiWiki \u306e\u30b3\u30f3\u30c6\u30ca\u3082 `Dockerfile` \u3067\u5b9a\u7fa9\u3059\u308b\u3053\u3068\u304c\u51fa\u6765\u307e\u3059\u3002\n\n### 10.1. Dockerfile \u4f5c\u6210\n\n\u4f5c\u696d\u7528\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092\u4f5c\u308a\u307e\u3059\u3002\n\n```shell-session\nhost@ubuntu# mkdir /root/wiki\nhost@ubuntu# cd /root/wiki/\nhost@ubuntu# touch Dockefile\nhost@ubuntu# vi Dockerfile\n```\n\n\u30d5\u30a1\u30a4\u30eb\u306e\u4e2d\u8eab\u306f\u3001\u6b21\u306e\u3088\u3046\u306b\u3057\u307e\u3059\u3002\n\n```test:Dockefile\nFROM centos:centos6\nMAINTAINER 0.1. USER, USER@example.jp\nRUN echo 'ZONE=\"Asia/Tokyo\"' > /etc/sysconfig/clock\n\nRUN rpm --import http://dl.fedoraproject.org/pub/epel/RPM-GPG-KEY-EPEL-6\nRUN yum -y install httpd php wget unzip\nRUN echo 'nifty' > /var/www/html/index.html\n\nRUN wget -O pukiwiki-1_5_0_rc1_utf8.zip 'http://sourceforge.jp/frs/redir.php?m=iij&f=%2Fpukiwiki%2F61572%2Fpukiwiki-1_5_0_rc1_utf8.zip'\nRUN unzip ./pukiwiki-1_5_0_rc1_utf8.zip\nRUN mv pukiwiki-1_5_0_utf8 /var/www/html/wiki\nRUN chown -R apache.apache /var/www/html/wiki\nRUN sed -i -e \"s#$adminpass = '{x-php-md5}\\!';#$adminpass = '{x-php-md5}' . md5('9999pass');#\" /var/www/html/wiki/pukiwiki.ini.php\n\n\nEXPOSE 80\n\nENTRYPOINT [\"/usr/sbin/httpd\"]\nCMD [\"-D\", \"FOREGROUND\"]\n```\n\n### 10.2. Dockerfile \u3092\u5143\u306b\u30a4\u30e1\u30fc\u30b8\u3092\u30d3\u30eb\u30c9\n\n\u30bf\u30b0\u306f `wiki:nifty` \u3068\u3057\u3066\u4f5c\u6210\u3057\u307e\u3059\u3002\n\n```shell-session\nhost@ubuntu# docker build -t wiki:nifty .\n\uff08\u7565\uff09\n ---> 30d4bc6dc4bc\nRemoving intermediate container a20a49adea9f\nStep 13 : ENTRYPOINT [\"/usr/sbin/httpd\"]\n ---> Running in dd94718d8e19\n ---> c90d521b6701\nRemoving intermediate container dd94718d8e19\nStep 14 : CMD [\"-D\", \"FOREGROUND\"]\n ---> Running in bdd19d56f8fc\n ---> 213902c19c59\nRemoving intermediate container bdd19d56f8fc\nSuccessfully built 213902c19c59\n```\n\n\u4f5c\u6210\u3055\u308c\u305f\u30a4\u30e1\u30fc\u30b8ID\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\n\n```shell-session\nhost@ubuntu# docker images\nREPOSITORY          TAG                 IMAGE ID            CREATED              VIRTUAL SIZE\nwiki                nifty               213902c19c59        32 seconds ago       312.2 MB\n```\n\n\u3053\u306e\u3088\u3046\u306b `wiki:nifty`\u3068\u3044\u3046\u30a4\u30e1\u30fc\u30b8\u304c\u65b0\u305f\u306b\u4f5c\u6210\u3055\u308c\u307e\u3057\u305f\u3002\n\n### 10.3. \u30b3\u30f3\u30c6\u30ca\u306b\u63a5\u7d9a\n\n\u4f5c\u6210\u3057\u305f `wiki:nifty` \u30bf\u30b0\u3092\u4f7f\u3063\u3066\u3001\u30b3\u30f3\u30c6\u30ca\u306e\u8d77\u52d5\u3068\u3001PukiWiki \u3078\u306e\u30a2\u30af\u30bb\u30b9\u3092\u8a66\u307f\u307e\u3059\u3002\n\n```shell-session\nhost@ubuntu# docker run -t -i -d -p 80:80 wiki:nifty\nf20598638936dea634567a083d39a258c00a3017ad9ce1f09aaab4efd6b08f7b\n```\n\n```shell-session\nhost@ubuntu# docker ps\nCONTAINER ID        IMAGE               COMMAND                CREATED             STATUS              PORTS                NAMES\nf20598638936        wiki:nifty          /usr/sbin/httpd -D F   3 seconds ago       Up 2 seconds        0.0.0.0:80->80/tcp   happy_kirch\n```\n\n\u3053\u306e\u3088\u3046\u306b\u78ba\u8a8d\u304c\u3067\u304d\u305f\u3042\u3068\u306f\u3001\u30d6\u30e9\u30a6\u30b6\u304b\u3089 Wiki \u3078\u306e\u30a2\u30af\u30bb\u30b9\u304c\u53ef\u80fd\u306a\u3053\u3068\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\n\n\u4ee5\u4e0a\u3067\u30cf\u30f3\u30ba\u30aa\u30f3\u306e\u5185\u5bb9\u306f\u7d42\u4e86\u3067\u3059\u3002\u304a\u75b2\u308c\u69d8\u3067\u3057\u305f\u3002\n\n## 11. \uff08\u4e0a\u7d1a\u7de8\uff09WordPress \u306e\u30b3\u30f3\u30c6\u30ca\u3092\u4f5c\u6210\n\n\u203b\u6642\u9593\u306e\u3042\u308b\u30c1\u30fc\u30e0\u5411\u3051\u306e\u81ea\u4e3b\u8ab2\u984c\u3067\u3059\u3002\n\n\u3053\u308c\u307e\u3067\u306e\u304a\u5fa9\u7fd2\u3044\u3068\u3057\u3066\u3001WordPress \u304c\u52d5\u4f5c\u3059\u308b\u30b3\u30f3\u30c6\u30ca\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\u4ee5\u4e0b\u306f\u624b\u9806\u306e\u6982\u8981\u3060\u3051\u793a\u3057\u307e\u3059\u306e\u3067\u3001\u306a\u305c\u3053\u306e\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3059\u308b\u306e\u304b\u3001\u8003\u3048\u306a\u304c\u3089\u9032\u3093\u3067\u4e0b\u3055\u3044\u3002\n\n### 11.1. \u6982\u8981 \n\nWordPress \u306e\u52d5\u4f5c\u306b\u306f\u3001Apache\u3001PHP\u3001MySQL \u306e\u74b0\u5883\u3092\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\u3057\u307e\u3059\u3002\u3055\u3089\u306b\u3001\u30d6\u30e9\u30a6\u30b6\u4e0a\u304b\u3089 WordPress \u306e\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\u3092\u884c\u3044\u307e\u3059\u3002\n\n### 11.2. WordPress \u30b3\u30f3\u30c6\u30ca\u306e\u4f5c\u6210\u624b\u9806\n\nWordPress \u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb - WordPress Codex \u65e5\u672c\u8a9e\u7248\nhttp://wpdocs.sourceforge.jp/WordPress_%E3%81%AE%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB\n\n\u4f5c\u696d\u5185\u5bb9\u306f\u3001\u3053\u3061\u3089\u306e\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u306b\u6e96\u3058\u307e\u3059\u3002\n\n#### \u30b3\u30f3\u30c6\u30ca\u5074\u306e\u6e96\u5099\n\u30db\u30b9\u30c8\u5074\u3067\u30b3\u30f3\u30c6\u30ca\u3092\u8d77\u52d5\u3002\n\n```shell-session\nroot@ubuntu:~# docker run -i -t centos:centos6 /bin/bash\n```\n\n\u30b3\u30f3\u30c6\u30ca\u5185\u3067\u6642\u523b\u8a2d\u5b9a\u3002\n\n```shell-session\nroot@ubuntu:~# echo 'ZONE=\"Asia/Tokyo\"' > /etc/sysconfig/clock\n```\n\n#### WordPress \u306e\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3068\u5c55\u958b\n\n```shell-session\nroot@ubuntu:~# yum -y install httpd php php-mysql mysql-server tar wget\nroot@ubuntu:~# cd /var/www/html\nroot@ubuntu:~# wget http://ja.wordpress.org/wordpress-3.9.1-ja.tar.gz\nroot@ubuntu:~# tar xvfz ./wordpress-3.9.1-ja.tar.gz\n```\n\n#### MySQL \u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u8a2d\u5b9a\u3068\u30e6\u30fc\u30b6\u306e\u4f5c\u6210\n\n```shell-session\nroot@ubuntu:~# service mysqld start\n\nroot@ubuntu:~# mysql -u root\nmysql> CREATE DATABASE wordpress;\nmysql> GRANT ALL PRIVILEGES ON wordpress.* TO \"wordpress\"@\"localhost\" IDENTIFIED BY \"password999\";\nmysql> FLUSH PRIVILEGES;\nmysql> EXIT\n```\n\n#### commit \u3057\u3066\u5909\u66f4\u5185\u5bb9\u3092\u78ba\u5b9a\n\n\u30b3\u30f3\u30c6\u30ca\u3092\u629c\u3051\u3066 `wordpress` \u3068\u3044\u3046\u540d\u524d\u3067 `docker commit` \u3059\u308b\u3002\n\n```shell-session\nroot@ubuntu:~# docker ps -a | head -2\nCONTAINER ID        IMAGE               COMMAND                CREATED             STATUS                      PORTS               NAMES\naeaa50c49e31        centos:centos6      /bin/bash              11 minutes ago      Exited (0) 49 seconds ago                       thirsty_mcclintock\n\n\nroot@ubuntu:~# docker commit aeaa50c49e31 wordpress\n301e6ae61c2d0fb5104327a741a573c39015f71a78cb76bfb0f5c181cbf2e1cd\n```\n\n#### \u30b3\u30f3\u30c6\u30ca\u306e\u8d77\u52d5\n\n```shell-session\nroot@ubuntu:~# docker run -t -i -d -p 80:80 wordpress\n2c9887a60d1eb9833ba237930430c680bdb4230ecb8221a3b2d406f8251cbe13\nroot@ubuntu:~# docker ps\nCONTAINER ID        IMAGE               COMMAND             CREATED             STATUS              PORTS                NAMES\n2c9887a60d1e        wordpress:latest    /bin/bash           9 seconds ago       Up 9 seconds        0.0.0.0:80->80/tcp   tender_elion\n```\n\n#### \u30c7\u30fc\u30e2\u30f3\u306e\u8d77\u52d5\n\n```shell-session\nroot@ubuntu:~# docker attach 2c9887a60d1e\n\ncontainer@bash-4.1# service httpd start\nStarting httpd: httpd: Could not reliably determine the server's fully qualified domain name, using 172.17.0.27 for ServerName\n                                                           [  OK  ]\ncontainer@bash-4.1# service mysqld start\nStarting mysqld:                                           [  OK  ]\n\ncontainer@bash-4.1# chown -R apache.apache /var/www/html/wordpress/\n```\n\n#### \u30d6\u30e9\u30a6\u30b6\u304b\u3089\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\n\n`http://<HOST>/wordpress/wp-admin/install.php\n` \u306b\u63a5\u7d9a\u3057\u307e\u3059\u3002\n\n* '\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u6210\u3059\u308b'\n* '\u3055\u3041\u59cb\u3081\u307e\u3057\u3087\u3046'\n* \u8a73\u7d30\n *\t\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u540d\uff1awordpress\n *\t\u30e6\u30fc\u30b6\u540d\uff1awordpress\n *\t\u30d1\u30b9\u30ef\u30fc\u30c9\uff1apassword999\n *\t\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306e\u30db\u30b9\u30c8\u540d\uff1alocalhost\n *\t\u30c6\u30fc\u30d6\u30eb\u63a5\u982d\u8f9e\uff1awp_\n *\t\u3010\u9001\u4fe1\u3011\n*\u3010\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u5b9f\u884c\u3011\n* \u3088\u3046\u3053\u305d\n *\t\u30b5\u30a4\u30c8\u540d\uff1adocker\n *\t\u30e6\u30fc\u30b6\u540d\uff1adocker\n *\t\u30d1\u30b9\u30ef\u30fc\u30c9\uff1adocker999\n *\t\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\uff1a\u4efb\u610f\n *\t\u3010WordPress\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3011\n* \u6210\u529f\u3057\u307e\u3057\u305f\uff01\n *\t\u3010\u30ed\u30b0\u30a4\u30f3\u3011\n\nWordPress \u4e0a\u3067\u66f8\u304d\u8fbc\u307f\u3092\u884c\u3044\u3001\u66f8\u304d\u8fbc\u307f\u5185\u5bb9\u304c\u53cd\u6620\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u30d6\u30e9\u30a6\u30b6\u304b\u3089\u78ba\u8a8d\u3002\n\n#### \u30b3\u30f3\u30c6\u30ca\u30a4\u30e1\u30fc\u30b8\u306e\u30b3\u30df\u30c3\u30c8\n\n\n```shell-session\ncontainer@bash-4.1# exit\nexit\nroot@ubuntu:~# docker ps -a | head -2\nCONTAINER ID        IMAGE               COMMAND                CREATED             STATUS                       PORTS               NAMES\n31dd5ff9b3f4        wordpress:latest    /bin/bash              7 minutes ago       Exited (0) 10 seconds ago                        elegant_kowalevski\n\n\nroot@ubuntu:~# docker commit 31dd5ff9b3f4 wordpress:nifty\n0a60f13ca024c8f0156bf8a23dff43bd2a2879ba7538ba7f9c85845312b821d4\nroot@ubuntu:~# docker images\nREPOSITORY          TAG                 IMAGE ID            CREATED             VIRTUAL SIZE\nwordpress           nifty               0a60f13ca024        11 seconds ago      444.7 MB\nwordpress           latest              301e6ae61c2d        21 minutes ago      408.2 MB\n```\n\n\uff12\u3064\u51fa\u6765\u3066\u3044\u308b\u3002\n\n#### 11.3. \u3055\u3089\u306b\u6642\u9593\u306e\u3042\u308b\u30b0\u30eb\u30fc\u30d7\u306f \u2026 \n\n* \u30b3\u30f3\u30c6\u30ca\u3092\u5225\u306e\u30af\u30e9\u30a6\u30c9\u306b\u79fb\u52d5\u3055\u305b\u307e\u3057\u3087\u3046\n\n\u30cb\u30d5\u30c6\u30a3 -> \u3055\u304f\u3089\u3001\u79fb\u884c\u4f8b\n\n\u203b\u4e88\u3081\u3001\u30cb\u30d5\u30c6\u30a3\u5074 WordPress \u306e\u30d6\u30e9\u30a6\u30b6\u304b\u3089\u884c\u3046\u57fa\u672c\u8a2d\u5b9a\u3067\u3001\u30b3\u30f3\u30c6\u30f3\u30c4\u306e IP \u30a2\u30c9\u30ec\u30b9\u3092\u300c\u3055\u304f\u3089\u5074\u300d\u306b\u5909\u66f4\u3057\u3066\u304a\u304f\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\n\n```shell-session:\u30cb\u30d5\u30c6\u30a3\u5074\nroot@ubuntu:~# docker commit b3cc6f68a0ff wordpress:nifty\n9094fd71be4b5ce2734076860621b2b51552a4c5ce0341911465084d09d59a6f\n\nroot@ubuntu:~# docker ps -a\nCONTAINER ID        IMAGE               COMMAND                CREATED             STATUS                          PORTS               NAMES\nb3cc6f68a0ff        0a60f13ca024        /bin/bash              5 minutes ago       Exited (0) About a minute ago                       jovial_archimedes\n\nroot@ubuntu:~# docker export b3cc6f68a0ff > nifty-wp.tar\n\nroot@ubuntu:~# scp ./nifty-wp.tar  root@153.120.83.96:/tmp/\nEnter passphrase for key '/root/.ssh/id_rsa':\nnifty-wp.tar                                            100%  393MB  17.1MB/s   00:23\n```\n\n```shell-session:\u3055\u304f\u3089\u5074\n[root@sakura2 ~]# cat /tmp/nifty-wp.tar | docker import - wordpress:sakura\na266f141bfa43423678a090daf341ce96a1a06fd8ac9f269e5e62bf44a4d115a\n\n\n[root@sakura2 ~]# docker run -t -i -d -p 80:80 wordpress:sakura /bin/bash\nf8061f2fe88aa8e377b0b7a42bead0a651870a3942494e853e2daffe260147a2\n\n[root@sakura2 ~]# docker attach f8061f2fe88aa8e377b0b7a42bead0a651870a3942494e853e2daffe260147a2\n\nbash-4.1# service mysqld start\nStarting mysqld:                                           [  OK  ]\nbash-4.1# service  httpd start\nStarting httpd: httpd: Could not reliably determine the server's fully qualified domain name, using 172.17.0.28 for ServerName\n                                                           [  OK  ]\n\n```\n\n* \u305d\u308c\u305e\u308c\u3001\u3069\u306e\u3088\u3046\u306a\u4f5c\u696d\u3092\u884c\u3063\u3066\u3044\u305f\u306e\u3067\u3057\u3087\u3046\u304b\uff1f\n\n* \u3053\u306e\u5185\u5bb9\u3092 Dockerfile \u3067\u5b9a\u7fa9\u3059\u308b\u306b\u306f\u3069\u3046\u3057\u305f\u3089\u3044\u3044\u3067\u3057\u3087\u3046\u304b\uff1f\n\n"}