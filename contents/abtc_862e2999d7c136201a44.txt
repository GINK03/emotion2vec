{"context": "\u30b9\u30e2\u30fc\u30eb\u30a4\u30e1\u30fc\u30b8\u306eRaspbian\u304c\u6b32\u3057\u304f\u3001debootstrap\u3067\u69cb\u7bc9\u3057\u3066\u307f\u307e\u3057\u305f\u3002\nMinibian\u3068\u3044\u3046\u30c7\u30a3\u30b9\u30c8\u30ea\u3082\u3042\u3063\u305f\u3093\u3067\u3059\u304c\u3001\u30c7\u30a3\u30b9\u30af\u30b5\u30a4\u30ba\u5909\u66f4\u3084\u30d1\u30c3\u30b1\u30fc\u30b8\u5c0e\u5165\u304c\u4e0a\u624b\u304f\u3067\u304d\u306a\u304b\u3063\u305f\u306e\u3067\u3001\ndebootstrap\u3067\u884c\u3046\u3053\u3068\u306b\u3057\u3066\u3044\u307e\u3059\u3002\n\u591a\u5206\u3001Ubuntu\u3001debian\u3067\u69cb\u7bc9\u3067\u304d\u308b\u3068\u601d\u3044\u307e\u3059\uff08\u79c1\u306f\u3001Docker\u4e0a\u306eubuntu\u3067\u884c\u3063\u3066\u304a\u308a\u307e\u3059)\u3002\n\n\u53c2\u8003\n\nhttp://elinux.org/Raspbian\nhttp://www.kaibader.de/homemade-minimal-raspberry-pi-raspbian-image/\n\n\n\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\nDocker for Windows\u4e0a\u3067Ubuntu\u30b3\u30f3\u30c6\u30ca\u3092\u4f5c\u6210\u3057\u3066\u69cb\u7bc9\n\u6700\u7d42\u7684\u306aSD\u30ab\u30fc\u30c9\u30a4\u30e1\u30fc\u30b8\u306fCentOS\u4e0a\u3067\u4f5c\u696d\n\n\n\u524d\u63d0\u30d1\u30c3\u30b1\u30fc\u30b8\u306e\u5c0e\u5165\nsudo apt-get install -y qemu-user-static binfmt-support debootstrap git\n\n\n\n\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb(jessie)\nsudo mkdir /raspi-root\ncd /raspi-root\nsudo debootstrap --include=ca-certificates,apt,wget --foreign --arch=armhf jessie . http://archive.raspbian.org/raspbian\nsudo cp $(which qemu-arm-static) ./usr/bin/\nsudo chroot . debootstrap/debootstrap --second-stage --verbose\n\n\n\nchroot\u6e96\u5099\nsudo mount -t sysfs sysfs sys/ \nsudo mount -t proc  proc  proc/\nsudo mount -o bind /dev  dev/\nsudo mount -o bind /dev/pts dev/pts\n\n\n\n\u30db\u30b9\u30c8\u540d\u3001hosts\u8a2d\u5b9a\nsudo echo raspberry >./etc/hostname\nsudo echo 127.0.0.1\\traspberry >>./etc/host\n\n\n\n\u30d5\u30a1\u30a4\u30eb\u7de8\u96c6\n\n/raspi-root/etc/apt/sources.list\ndeb http://ftp.jaist.ac.jp/raspbian jessie main firmware non-free\ndeb http://mirrordirector.raspbian.org/raspbian jessie main firmware non-free\ndeb http://archive.raspberrypi.org/debian jessie main\n\n\n\n/raspi-root/etc/fstab\nauto lo\niface lo inet loopback\n\nauto eth0\niface eth0 inet dhcp\n\n\n\n/raspi-root/etc/fstab\nproc           /proc    proc  defaults         0 0\n/dev/mmcblk0p1 /boot    vfat  defaults,noatime 0 0\n/dev/mmcblk0p2 /        ext4  defaults,noatime 0 0\ntmpfs          /tmp     tmpfs defaults         0 0\ntmpfs          /var/tmp tmpfs defaults         0 0\n\n\n\n\u30d1\u30c3\u30b1\u30fc\u30b8\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n\u30ea\u30dd\u30b8\u30c8\u30ea\u8a8d\u8a3c\u306e\u9375\u60c5\u5831\u8ffd\u52a0\nsudo chroot . wget http://archive.raspbian.org/raspbian.public.key -O - | chroot . apt-key add -\nsudo chroot . wget http://archive.raspberrypi.org/debian/raspberrypi.gpg.key -O - | chroot . apt-key add -\n\n\n\n\u6700\u4f4e\u9650\u306e\u30d1\u30c3\u30b1\u30fc\u30b8\u5c0e\u5165\nsudo chroot . apt-get update\nsudo chroot . apt-get -y upgrade\nsudo chroot . apt-get install -y \\\nsudo \\\nopenssh-server \\\nusbmount \\\npatch \\\nless \\\nconsole-common \\\nconsole-data \\\nconsole-setup \\\ntzdata \\\nmost \\\nlocales \\\nkeyboard-configuration \\\nraspi-config rpi-update\n\n\n\npi\u30e6\u30fc\u30b6\u306e\u4f5c\u6210\nsudo chroot . useradd -m -s /bin/bash pi\nsudo chroot . usermod -a -G sudo,staff,kmem,plugdev,audio pi\nsudo chroot . passwd pi\n\n\n\nboot\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30f3\u30d5\u30a1\u30a4\u30eb\u4f5c\u6210\n\nfirmware\u5c0e\u5165\ngit clone https://github.com/raspberrypi/firmware.git ~/firmware\n\n\n\nboot\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u4f5c\u6210\nsudo mkdir /raspi-boot\nsudo mount --bind /raspi-boot /raspi-root/boot\nsudo cp -R ~/firmware/boot/* /raspi-root/boot/\nsudo mkdir /raspi-root/lib/modules/\nsudo cp -R ~/firmware/modules/* /raspi-root/lib/modules/\n\n\n\n\u30c7\u30a3\u30b9\u30af\u30a4\u30e1\u30fc\u30b8\u4f5c\u6210\n\n\u6700\u7d42\u5de5\u7a0b\nsudo chroot . apt-get clean\nsudo chroot . apt-get autoclean\nsudo chroot . apt-get autoremove -y\nsudo chroot . raspi-update\nsudo umount ./dev/pts\nsudo umount ./dev\nsudo umount ./proc\nsudo umount ./sys\nsudo umount ./boot\n\n\n\nSD\u30a4\u30e1\u30fc\u30b8\u4f5c\u6210\ndd if=/dev/zero bs=1M count=3839 > ~/root.img\nsudo losetup -f ~/root.img\nsudo losetup -a\nsudo parted -s /dev/loop0 mklabel msdos\nsudo parted -s /dev/loop0 unit cyl mkpart primary fat16 -- 0 16\nsudo parted -s /dev/loop0 set 1 boot on\nsudo parted -s /dev/loop0 unit cyl mkpart primary ext2 -- 16 -2\nsudo losetup -d /dev/loop0\nsudo losetup -f -P ~/root.img\nsudo mkfs.vfat -n System /dev/loop0p1\nsudo mkfs.ext4 -L Storage /dev/loop0p4\nsudo mount /dev/loop0p1 -o rw /mnt\nsudo cp -R /raspi-boot/* /mnt/\nsudo umount /mnt\nsudo mount /dev/loop0p2 -o rw /mnt\nsudo cp -R /raspi-root/* /mnt/\nsudo umount /mnt\nsudo losetup -d /dev/loop0\n\n\n~/root.img\u3092dd\u307e\u305f\u306f\u3001Win32DiskImager\u3067micro sd\u30ab\u30fc\u30c9\u306b\u66f8\u304d\u8fbc\u3081\u3070\u5b8c\u4e86\u3067\u3059\u3002\n\u30b9\u30e2\u30fc\u30eb\u30a4\u30e1\u30fc\u30b8\u306eRaspbian\u304c\u6b32\u3057\u304f\u3001debootstrap\u3067\u69cb\u7bc9\u3057\u3066\u307f\u307e\u3057\u305f\u3002\nMinibian\u3068\u3044\u3046\u30c7\u30a3\u30b9\u30c8\u30ea\u3082\u3042\u3063\u305f\u3093\u3067\u3059\u304c\u3001\u30c7\u30a3\u30b9\u30af\u30b5\u30a4\u30ba\u5909\u66f4\u3084\u30d1\u30c3\u30b1\u30fc\u30b8\u5c0e\u5165\u304c\u4e0a\u624b\u304f\u3067\u304d\u306a\u304b\u3063\u305f\u306e\u3067\u3001\ndebootstrap\u3067\u884c\u3046\u3053\u3068\u306b\u3057\u3066\u3044\u307e\u3059\u3002\n\n\u591a\u5206\u3001Ubuntu\u3001debian\u3067\u69cb\u7bc9\u3067\u304d\u308b\u3068\u601d\u3044\u307e\u3059\uff08\u79c1\u306f\u3001Docker\u4e0a\u306eubuntu\u3067\u884c\u3063\u3066\u304a\u308a\u307e\u3059)\u3002\n\n## \u53c2\u8003\n\n- http://elinux.org/Raspbian\n- http://www.kaibader.de/homemade-minimal-raspberry-pi-raspbian-image/\n\n## \u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n- Docker for Windows\u4e0a\u3067Ubuntu\u30b3\u30f3\u30c6\u30ca\u3092\u4f5c\u6210\u3057\u3066\u69cb\u7bc9\n- \u6700\u7d42\u7684\u306aSD\u30ab\u30fc\u30c9\u30a4\u30e1\u30fc\u30b8\u306fCentOS\u4e0a\u3067\u4f5c\u696d\n\n```shell-session:\u524d\u63d0\u30d1\u30c3\u30b1\u30fc\u30b8\u306e\u5c0e\u5165\nsudo apt-get install -y qemu-user-static binfmt-support debootstrap git\n```\n\n```shell-session:\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb(jessie)\nsudo mkdir /raspi-root\ncd /raspi-root\nsudo debootstrap --include=ca-certificates,apt,wget --foreign --arch=armhf jessie . http://archive.raspbian.org/raspbian\nsudo cp $(which qemu-arm-static) ./usr/bin/\nsudo chroot . debootstrap/debootstrap --second-stage --verbose\n```\n\n```shell-session:chroot\u6e96\u5099\nsudo mount -t sysfs sysfs sys/ \nsudo mount -t proc  proc  proc/\nsudo mount -o bind /dev  dev/\nsudo mount -o bind /dev/pts dev/pts\n```\n\n```shell-session:\u30db\u30b9\u30c8\u540d\u3001hosts\u8a2d\u5b9a\nsudo echo raspberry >./etc/hostname\nsudo echo 127.0.0.1\\traspberry >>./etc/host\n```\n\n## \u30d5\u30a1\u30a4\u30eb\u7de8\u96c6\n```:/raspi-root/etc/apt/sources.list\ndeb http://ftp.jaist.ac.jp/raspbian jessie main firmware non-free\ndeb http://mirrordirector.raspbian.org/raspbian jessie main firmware non-free\ndeb http://archive.raspberrypi.org/debian jessie main\n```\n```:/raspi-root/etc/fstab\nauto lo\niface lo inet loopback\n\nauto eth0\niface eth0 inet dhcp\n```\n\n```:/raspi-root/etc/fstab\nproc           /proc    proc  defaults         0 0\n/dev/mmcblk0p1 /boot    vfat  defaults,noatime 0 0\n/dev/mmcblk0p2 /        ext4  defaults,noatime 0 0\ntmpfs          /tmp     tmpfs defaults         0 0\ntmpfs          /var/tmp tmpfs defaults         0 0\n```\n\n## \u30d1\u30c3\u30b1\u30fc\u30b8\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n```shell-session:\u30ea\u30dd\u30b8\u30c8\u30ea\u8a8d\u8a3c\u306e\u9375\u60c5\u5831\u8ffd\u52a0\nsudo chroot . wget http://archive.raspbian.org/raspbian.public.key -O - | chroot . apt-key add -\nsudo chroot . wget http://archive.raspberrypi.org/debian/raspberrypi.gpg.key -O - | chroot . apt-key add -\n```\n```shell-session:\u6700\u4f4e\u9650\u306e\u30d1\u30c3\u30b1\u30fc\u30b8\u5c0e\u5165\nsudo chroot . apt-get update\nsudo chroot . apt-get -y upgrade\nsudo chroot . apt-get install -y \\\nsudo \\\nopenssh-server \\\nusbmount \\\npatch \\\nless \\\nconsole-common \\\nconsole-data \\\nconsole-setup \\\ntzdata \\\nmost \\\nlocales \\\nkeyboard-configuration \\\nraspi-config rpi-update\n```\n```shell-session:pi\u30e6\u30fc\u30b6\u306e\u4f5c\u6210\nsudo chroot . useradd -m -s /bin/bash pi\nsudo chroot . usermod -a -G sudo,staff,kmem,plugdev,audio pi\nsudo chroot . passwd pi\n```\n\n## boot\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30f3\u30d5\u30a1\u30a4\u30eb\u4f5c\u6210\n```shell-session:firmware\u5c0e\u5165\ngit clone https://github.com/raspberrypi/firmware.git ~/firmware\n```\n```shell-session:boot\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u4f5c\u6210\nsudo mkdir /raspi-boot\nsudo mount --bind /raspi-boot /raspi-root/boot\nsudo cp -R ~/firmware/boot/* /raspi-root/boot/\nsudo mkdir /raspi-root/lib/modules/\nsudo cp -R ~/firmware/modules/* /raspi-root/lib/modules/\n```\n\n## \u30c7\u30a3\u30b9\u30af\u30a4\u30e1\u30fc\u30b8\u4f5c\u6210\n```shell-session:\u6700\u7d42\u5de5\u7a0b\nsudo chroot . apt-get clean\nsudo chroot . apt-get autoclean\nsudo chroot . apt-get autoremove -y\nsudo chroot . raspi-update\nsudo umount ./dev/pts\nsudo umount ./dev\nsudo umount ./proc\nsudo umount ./sys\nsudo umount ./boot\n```\n```shell-session:SD\u30a4\u30e1\u30fc\u30b8\u4f5c\u6210\ndd if=/dev/zero bs=1M count=3839 > ~/root.img\nsudo losetup -f ~/root.img\nsudo losetup -a\nsudo parted -s /dev/loop0 mklabel msdos\nsudo parted -s /dev/loop0 unit cyl mkpart primary fat16 -- 0 16\nsudo parted -s /dev/loop0 set 1 boot on\nsudo parted -s /dev/loop0 unit cyl mkpart primary ext2 -- 16 -2\nsudo losetup -d /dev/loop0\nsudo losetup -f -P ~/root.img\nsudo mkfs.vfat -n System /dev/loop0p1\nsudo mkfs.ext4 -L Storage /dev/loop0p4\nsudo mount /dev/loop0p1 -o rw /mnt\nsudo cp -R /raspi-boot/* /mnt/\nsudo umount /mnt\nsudo mount /dev/loop0p2 -o rw /mnt\nsudo cp -R /raspi-root/* /mnt/\nsudo umount /mnt\nsudo losetup -d /dev/loop0\n```\n\n~/root.img\u3092dd\u307e\u305f\u306f\u3001Win32DiskImager\u3067micro sd\u30ab\u30fc\u30c9\u306b\u66f8\u304d\u8fbc\u3081\u3070\u5b8c\u4e86\u3067\u3059\u3002\n\n\n\n\n\n\n\n\n", "tags": ["raspbian", "\u6700\u5c0f\u69cb\u6210", "\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb", "RaspberryPi"]}