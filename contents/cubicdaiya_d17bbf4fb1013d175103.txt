{"context": " More than 1 year has passed since last update.\n\nnginx\u306e\u30d3\u30eb\u30c9\u30a8\u30e9\u30fc\n\u3044\u3064\u304b\u3089\u3060\u3063\u305f\u304b\u5fd8\u308c\u305f\u3051\u3069Mac\u3067nginx-build\u3092\u4f7f\u3063\u3066OpenSSL\u3092\u9759\u7684\u30ea\u30f3\u30af\u3057\u305fnginx\u306e\u30d3\u30eb\u30c9\u304c\u901a\u3089\u306a\u304f\u306a\u3063\u3066\u3044\u305f\u3002\n$ nginx-build -d work -openssl\nnginx-build: 0.2.0\nCompiler: gc go1.4.1\n2015/01/18 06:27:21 [warn]configure option is empty.\n2015/01/18 06:27:21 Download nginx-1.7.9.....\n2015/01/18 06:27:21 Download openssl-1.0.1k.....\n2015/01/18 06:27:23 Extract nginx-1.7.9.tar.gz.....\n2015/01/18 06:27:39 Extract openssl-1.0.1k.tar.gz.....\n2015/01/18 06:27:40 Generate configure script for nginx-1.7.9.....\n2015/01/18 06:27:40 Configure nginx-1.7.9.....\n2015/01/18 06:27:46 Build nginx-1.7.9.....\nexit status 2\n2015/01/18 06:30:12 Failed to build nginx-1.7.9\n$\n\n\u76f4\u63a5\u30d3\u30eb\u30c9\u3059\u308b\u3088\u3046\u306b\u3057\u3066\u3082\u3084\u3063\u3071\u308a\u30a8\u30e9\u30fc\u306b\u306a\u308b\u3002\n$ cd nginx-1.7.9\n$ ./configure \u00a5\n --with-http_ssl_module \u00a5\n --with-openssl=../openssl-1.0.1k\n$ make\n               \u30fb\n               \u30fb\n               \u30fb\n  \"_sk_value\", referenced from:\n      _ngx_ssl_session_cache in ngx_event_openssl.o\n      _ngx_ssl_check_host in ngx_event_openssl.o\n      _ngx_ssl_stapling in ngx_event_openssl_stapling.o\nld: symbol(s) not found for architecture x86_64\nclang: error: linker command failed with exit code 1 (use -v to see invocation)\nmake[1]: *** [objs/nginx] Error 1\nmake: *** [build] Error 2\n$\n\nOpenSSL\u306e\u30ea\u30f3\u30af\u306b\u5931\u6557\u3057\u3066\u3044\u308b\u3088\u3046\u3060\u3002make\u306e\u51fa\u529b\u3092\u773a\u3081\u3066\u308b\u3068OpenSSL\u306econfigure\u6642\u306b\u3053\u3093\u306a\u8b66\u544a\u304c\u51fa\u3066\u3044\u308b\u3002\nOperating system: i686-apple-darwinDarwin Kernel Version 14.0.0: Fri Sep 19 00:26:44 PDT 2014; root:xnu-2782.1.97~2/RELEASE_X86_64\nWARNING! If you wish to build 64-bit library, then you have to\n         invoke './Configure darwin64-x86_64-cc' *manually*.\n         You have about 5 seconds to press Ctrl-C to abort.\n\nOS\u304c32bit\u3063\u3066\u5224\u5b9a\u3055\u308c\u3066\u308b\u3051\u3069\u300164bit\u74b0\u5883\u5411\u3051\u306b./Configure darwin64-x86_64-cc\u3092\u5b9f\u884c\u3057\u308d\u3001\u3068\u3042\u308b\u3002\u3046\u301c\u3093\u3001\u4f7f\u3063\u3066\u308bMacBook Pro\u306f64bit\u74b0\u5883\u306e\u306f\u305a\u306a\u3093\u3060\u3051\u3069\u306a\u3041\u3002\n\u3057\u304b\u3057\u3001uname\u5b9f\u884c\u3057\u3066\u307f\u308b\u3068\u3001\u30d7\u30ed\u30bb\u30c3\u30b5\u30a2\u30fc\u30ad\u30c6\u30af\u30c1\u30e3\u306f32bit\u306e\u3082\u306e\u3060\u3063\u305f\u3002\u539f\u56e0\u306f\u3053\u308c\u3063\u307d\u3044\u3002(Core i7\u306a\u3093\u3060\u3051\u3069\u3001\u4f55\u3067i386\u306b\u306a\u308b\u3093\u3060\u308d\uff1f)\n$ uname -p # print the machine processor architecture name.\ni386\n$ uname -m # print the machine hardware name.\nx86_64\n$\n\n\nnginx\u306b\u30c6\u30ad\u30c8\u30fc\u306a\u30d1\u30c3\u30c1\u3092\u3042\u3066\u3066\u307f\u308b\ndiff -r e9effef98874 auto/lib/openssl/make\n--- a/auto/lib/openssl/make     Fri Dec 26 16:22:59 2014 +0300\n+++ b/auto/lib/openssl/make     Fri Jan 09 19:24:06 2015 +0900\n@@ -56,7 +56,7 @@\n $OPENSSL/.openssl/include/openssl/ssl.h:       $NGX_MAKEFILE\n         cd $OPENSSL \\\\\n                 && if [ -f Makefile ]; then \\$(MAKE) clean; fi \\\\\n                 -       && ./config --prefix=$ngx_prefix no-shared\n$OPENSSL_OPT \\\\\n                 +       && ./Configure darwin64-x86_64-cc\n--prefix=$ngx_prefix no-shared $OPENSSL_OPT \\\\\n                         && \\$(MAKE) \\\\\n                                 && \\$(MAKE) install LIBDIR=lib\n\n\u4e00\u5fdc\u3053\u308c\u3092\u3042\u3066\u308b\u3068OpenSSL\u306e\u30ea\u30f3\u30af\u306b\u6210\u529f\u3059\u308b\u3002\u3057\u304b\u3057\u3001\u305d\u306e\u305f\u3081\u306bnginx\u306e\u30d3\u30eb\u30c9\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u5909\u66f4\u3059\u308b\u306e\u306f\u307e\u3068\u3082\u306a\u3084\u308a\u65b9\u3067\u306f\u306a\u3044\u306e\u3067\u3001nginx\u306econfigure\u30aa\u30d7\u30b7\u30e7\u30f3\u7b49\u3067\u5916\u90e8\u304b\u3089\u60c5\u5831\u4e0e\u3048\u308b\u3088\u3046\u306b\u3057\u3066\u5bfe\u51e6\u3057\u305f\u3044\u3002\n\nnginx\u306eML\u3067\u805e\u3044\u3066\u307f\u305f\n\u3069\u3046\u3059\u308c\u3070\u3044\u3044\u304bnginx\u306eML\u3067\u805e\u3044\u3066\u307f\u305f\u3002\n\nA build of nginx with static-linked OpenSSL fails on Mac\nRe: A build of nginx with static-linked OpenSSL fails on Mac\n\n\u4ee5\u4e0b\u3001nginx\u306e\u958b\u767a\u8005\u304b\u3089\u306e\u8fd4\u4fe1\u3002\nDefining KERNEL_BITS=64 in the environment will convince recent \nenough OpenSSL to build 64-bit library instead.\n\nKERNEL_BIT=64\u3092\u30d3\u30eb\u30c9\u6642\u306b\u4ed8\u52a0\u3057\u3066\u3084\u308c\u3070\u3044\u3044\u3001\u3068\u306e\u3053\u3068\u3002\u5b9f\u969b\u3053\u308c\u3067\u30d3\u30eb\u30c9\u304c\u901a\u308b\u3088\u3046\u306b\u306a\u3063\u305f\u3002\n\nnginx-build\u5074\u306e\u5bfe\u5fdc\nnginx-build\u306e\u65b9\u306fGOOS\u3068GOARCH\u3067\u74b0\u5883\u5224\u5225\u3057\u3001\u5fc5\u8981\u306b\u5fdc\u3058\u3066KERNEL_BIT=64\u3092\u4ed8\u52a0\u3059\u308b\u3053\u3068\u3067\u5bfe\u5fdc\u3057\u305f\u3002\nFixed a build failure when OpenSSL is static-linked on Mac.\n\n\u3053\u308c\u3067Mac\u3067\u3082OpenSSL\u3092\u9759\u7684\u30ea\u30f3\u30af\u3057\u3066nginx\u3092\u30d3\u30eb\u30c9\u3067\u304d\u308b\u304b\u30c6\u30b9\u30c8\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u3063\u305f\u3002\u3081\u3067\u305f\u3057\u3081\u3067\u305f\u3057\u3002\n## nginx\u306e\u30d3\u30eb\u30c9\u30a8\u30e9\u30fc\n\n\u3044\u3064\u304b\u3089\u3060\u3063\u305f\u304b\u5fd8\u308c\u305f\u3051\u3069Mac\u3067[nginx-build](https://github.com/cubicdaiya/nginx-build)\u3092\u4f7f\u3063\u3066OpenSSL\u3092\u9759\u7684\u30ea\u30f3\u30af\u3057\u305fnginx\u306e\u30d3\u30eb\u30c9\u304c\u901a\u3089\u306a\u304f\u306a\u3063\u3066\u3044\u305f\u3002\n\n```console\n$ nginx-build -d work -openssl\nnginx-build: 0.2.0\nCompiler: gc go1.4.1\n2015/01/18 06:27:21 [warn]configure option is empty.\n2015/01/18 06:27:21 Download nginx-1.7.9.....\n2015/01/18 06:27:21 Download openssl-1.0.1k.....\n2015/01/18 06:27:23 Extract nginx-1.7.9.tar.gz.....\n2015/01/18 06:27:39 Extract openssl-1.0.1k.tar.gz.....\n2015/01/18 06:27:40 Generate configure script for nginx-1.7.9.....\n2015/01/18 06:27:40 Configure nginx-1.7.9.....\n2015/01/18 06:27:46 Build nginx-1.7.9.....\nexit status 2\n2015/01/18 06:30:12 Failed to build nginx-1.7.9\n$\n```\n\n\u76f4\u63a5\u30d3\u30eb\u30c9\u3059\u308b\u3088\u3046\u306b\u3057\u3066\u3082\u3084\u3063\u3071\u308a\u30a8\u30e9\u30fc\u306b\u306a\u308b\u3002\n\n```console\n$ cd nginx-1.7.9\n$ ./configure \u00a5\n --with-http_ssl_module \u00a5\n --with-openssl=../openssl-1.0.1k\n$ make\n               \u30fb\n               \u30fb\n               \u30fb\n  \"_sk_value\", referenced from:\n      _ngx_ssl_session_cache in ngx_event_openssl.o\n      _ngx_ssl_check_host in ngx_event_openssl.o\n      _ngx_ssl_stapling in ngx_event_openssl_stapling.o\nld: symbol(s) not found for architecture x86_64\nclang: error: linker command failed with exit code 1 (use -v to see invocation)\nmake[1]: *** [objs/nginx] Error 1\nmake: *** [build] Error 2\n$\n```\n\nOpenSSL\u306e\u30ea\u30f3\u30af\u306b\u5931\u6557\u3057\u3066\u3044\u308b\u3088\u3046\u3060\u3002make\u306e\u51fa\u529b\u3092\u773a\u3081\u3066\u308b\u3068OpenSSL\u306econfigure\u6642\u306b\u3053\u3093\u306a\u8b66\u544a\u304c\u51fa\u3066\u3044\u308b\u3002\n\n```console\nOperating system: i686-apple-darwinDarwin Kernel Version 14.0.0: Fri Sep 19 00:26:44 PDT 2014; root:xnu-2782.1.97~2/RELEASE_X86_64\nWARNING! If you wish to build 64-bit library, then you have to\n         invoke './Configure darwin64-x86_64-cc' *manually*.\n         You have about 5 seconds to press Ctrl-C to abort.\n```\n\nOS\u304c32bit\u3063\u3066\u5224\u5b9a\u3055\u308c\u3066\u308b\u3051\u3069\u300164bit\u74b0\u5883\u5411\u3051\u306b`./Configure darwin64-x86_64-cc`\u3092\u5b9f\u884c\u3057\u308d\u3001\u3068\u3042\u308b\u3002\u3046\u301c\u3093\u3001\u4f7f\u3063\u3066\u308bMacBook Pro\u306f64bit\u74b0\u5883\u306e\u306f\u305a\u306a\u3093\u3060\u3051\u3069\u306a\u3041\u3002\n\n\u3057\u304b\u3057\u3001`uname`\u5b9f\u884c\u3057\u3066\u307f\u308b\u3068\u3001\u30d7\u30ed\u30bb\u30c3\u30b5\u30a2\u30fc\u30ad\u30c6\u30af\u30c1\u30e3\u306f32bit\u306e\u3082\u306e\u3060\u3063\u305f\u3002\u539f\u56e0\u306f\u3053\u308c\u3063\u307d\u3044\u3002(Core i7\u306a\u3093\u3060\u3051\u3069\u3001\u4f55\u3067i386\u306b\u306a\u308b\u3093\u3060\u308d\uff1f)\n\n```console\n$ uname -p # print the machine processor architecture name.\ni386\n$ uname -m # print the machine hardware name.\nx86_64\n$\n```\n\n## nginx\u306b\u30c6\u30ad\u30c8\u30fc\u306a\u30d1\u30c3\u30c1\u3092\u3042\u3066\u3066\u307f\u308b\n\n```diff\ndiff -r e9effef98874 auto/lib/openssl/make\n--- a/auto/lib/openssl/make     Fri Dec 26 16:22:59 2014 +0300\n+++ b/auto/lib/openssl/make     Fri Jan 09 19:24:06 2015 +0900\n@@ -56,7 +56,7 @@\n $OPENSSL/.openssl/include/openssl/ssl.h:       $NGX_MAKEFILE\n         cd $OPENSSL \\\\\n                 && if [ -f Makefile ]; then \\$(MAKE) clean; fi \\\\\n                 -       && ./config --prefix=$ngx_prefix no-shared\n$OPENSSL_OPT \\\\\n                 +       && ./Configure darwin64-x86_64-cc\n--prefix=$ngx_prefix no-shared $OPENSSL_OPT \\\\\n                         && \\$(MAKE) \\\\\n                                 && \\$(MAKE) install LIBDIR=lib\n```\n\n\u4e00\u5fdc\u3053\u308c\u3092\u3042\u3066\u308b\u3068OpenSSL\u306e\u30ea\u30f3\u30af\u306b\u6210\u529f\u3059\u308b\u3002\u3057\u304b\u3057\u3001\u305d\u306e\u305f\u3081\u306bnginx\u306e\u30d3\u30eb\u30c9\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u5909\u66f4\u3059\u308b\u306e\u306f\u307e\u3068\u3082\u306a\u3084\u308a\u65b9\u3067\u306f\u306a\u3044\u306e\u3067\u3001nginx\u306e`configure`\u30aa\u30d7\u30b7\u30e7\u30f3\u7b49\u3067\u5916\u90e8\u304b\u3089\u60c5\u5831\u4e0e\u3048\u308b\u3088\u3046\u306b\u3057\u3066\u5bfe\u51e6\u3057\u305f\u3044\u3002\n\n## nginx\u306eML\u3067\u805e\u3044\u3066\u307f\u305f\n\n\u3069\u3046\u3059\u308c\u3070\u3044\u3044\u304bnginx\u306eML\u3067\u805e\u3044\u3066\u307f\u305f\u3002\n\n * [A build of nginx with static-linked OpenSSL fails on Mac](http://mailman.nginx.org/pipermail/nginx/2015-January/046331.html)\n * [Re: A build of nginx with static-linked OpenSSL fails on Mac](http://mailman.nginx.org/pipermail/nginx/2015-January/046356.html\n)\n\n\u4ee5\u4e0b\u3001nginx\u306e\u958b\u767a\u8005\u304b\u3089\u306e\u8fd4\u4fe1\u3002\n\n```\nDefining KERNEL_BITS=64 in the environment will convince recent \nenough OpenSSL to build 64-bit library instead.\n```\n\n`KERNEL_BIT=64`\u3092\u30d3\u30eb\u30c9\u6642\u306b\u4ed8\u52a0\u3057\u3066\u3084\u308c\u3070\u3044\u3044\u3001\u3068\u306e\u3053\u3068\u3002\u5b9f\u969b\u3053\u308c\u3067\u30d3\u30eb\u30c9\u304c\u901a\u308b\u3088\u3046\u306b\u306a\u3063\u305f\u3002\n\n## nginx-build\u5074\u306e\u5bfe\u5fdc\n\n[nginx-build](https://github.com/cubicdaiya/nginx-build)\u306e\u65b9\u306f`GOOS`\u3068`GOARCH`\u3067\u74b0\u5883\u5224\u5225\u3057\u3001\u5fc5\u8981\u306b\u5fdc\u3058\u3066`KERNEL_BIT=64`\u3092\u4ed8\u52a0\u3059\u308b\u3053\u3068\u3067\u5bfe\u5fdc\u3057\u305f\u3002\n\n\n[Fixed a build failure when OpenSSL is static-linked on Mac.\n](https://github.com/cubicdaiya/nginx-build/commit/632a1c61c5bab1a77640a49b4cd9f501e310aea1)\n\n\u3053\u308c\u3067Mac\u3067\u3082OpenSSL\u3092\u9759\u7684\u30ea\u30f3\u30af\u3057\u3066nginx\u3092\u30d3\u30eb\u30c9\u3067\u304d\u308b\u304b\u30c6\u30b9\u30c8\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u3063\u305f\u3002\u3081\u3067\u305f\u3057\u3081\u3067\u305f\u3057\u3002\n", "tags": ["openssl", "MacOSX", "nginx", "nginx-build"]}