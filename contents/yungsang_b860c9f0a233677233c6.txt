{"context": " More than 1 year has passed since last update.Panamax \u306e\u30d5\u30ed\u30f3\u30c8\u30a8\u30f3\u30c9\u306e\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u8aad\u3093\u3067\u3044\u305f\u3089\u3001\u5b9f\u306f\u305d\u3093\u306a\u306b\u8907\u96d1\u306a\u3053\u3068\u3092\u3057\u3066\u3044\u306a\u3044\u3088\u3046\u306a\u306e\u3067\u3001\u7406\u89e3\u3057\u3084\u3059\u3044\u3088\u3046\u306b\u6574\u7406\u3057\u3066 cloud-config \u3092\u4f7f\u3046\u3088\u3046\u306b\u66f8\u304d\u76f4\u3057\u3066\u307f\u307e\u3057\u305f\u3002\nVagrant \u3067\u4e00\u62ec\u3057\u3066\u7ba1\u7406\u3067\u304d\u307e\u3059\u3057\u3001\u898b\u901a\u3057\u3082\u826f\u304f\u306a\u3063\u3066\u3044\u308d\u3044\u308d\u5f04\u308c\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3057\u305f\u3002\n\u4eca\u306f\u307e\u3060\u5bfe\u5fdc\u3057\u3066\u306a\u3044\u3088\u3046\u3067\u3059\u304c\u3001\u30af\u30e9\u30b9\u30bf\u3092\u69cb\u7bc9\u3059\u308b\u969b\u3082\u7c21\u5358\u306b\u306a\u308b\u3088\u3046\u306a\u6c17\u304c\u3057\u307e\u3059\u3002\nPanamax without Installer\nhttps://gist.github.com/YungSang/0440f754c01a07d0f1ce\n\u203b) Panamax v0.1.2 \u306b\u57fa\u3044\u3066\u3044\u307e\u3059\u3002\n\nVagrantfile\n# -*- mode: ruby -*-\n# vi: set ft=ruby :\n\n# Vagrantfile API/syntax version. Don't touch unless you know what you're doing!\nVAGRANTFILE_API_VERSION = \"2\"\n\nVagrant.configure(VAGRANTFILE_API_VERSION) do |config|\n  config.vm.box = \"yungsang/coreos\"\n\n  config.vm.define \"panamax\" do |panamax|\n    panamax.vm.hostname = \"panamax\"\n\n    panamax.vm.network :forwarded_port, guest: 3000, host: 8888\n    panamax.vm.network :forwarded_port, guest: 3001, host: 8889\n\n    panamax.vm.provision :docker do |d|\n      d.pull_images \"centurylink/panamax-ui:latest\"\n      d.pull_images \"centurylink/panamax-api:latest\"\n      d.pull_images \"google/cadvisor:0.1.0\"\n    end\n\n    panamax.vm.provision :file, source: \"./panamax.yml\", destination: \"/tmp/vagrantfile-user-data\"\n\n    panamax.vm.provision :shell do |sh|\n      sh.privileged = true\n      sh.inline = <<-EOT\n        export PANAMAX_ID=$(/usr/bin/uuidgen)\n        sed -e \"s/%PANAMAX_ID%/${PANAMAX_ID}/g\" -i /tmp/vagrantfile-user-data\n\n        mv /tmp/vagrantfile-user-data /var/lib/coreos-vagrant/\n      EOT\n    end\n  end\nend\n\n\n\npanamax.yml\n#cloud-config\n\ncoreos:\n  units:\n    - name: etcd.service\n      command: start\n\n    - name: fleet.service\n      command: start\n\n    - name: panamax-metrics.service\n      command: start\n      runtime: no\n      content: |\n        [Unit]\n        Description=Panamax Metrics\n\n        [Service]\n        ExecStartPre=-/usr/bin/docker rm -f PMX_CADVISOR\n        ExecStart=/usr/bin/docker run --volume=/var/run:/var/run:rw --volume=/sys/fs/cgroup/:/sys/fs/cgroup:ro --volume=/var/lib/docker/:/var/lib/docker:ro --publish=:8080 --name=PMX_CADVISOR google/cadvisor:0.1.0\n        ExecStop=/usr/bin/docker stop PMX_CADVISOR\n        Restart=always\n\n        [Install]\n        WantedBy=multi-user.target    \n\n    - name: panamax-api.service\n      command: start\n      runtime: no\n      content: |\n        [Unit]\n        Description=Panamax API\n        After=docker.service\n        Requires=docker.service\n\n        [Service]\n        ExecStartPre=-/usr/bin/docker rm -f PMX_API\n        ExecStart=/usr/bin/docker run --name PMX_API -v /var/panamax-data:/usr/src/app/db/mnt -m=1g -c=10 -v /var/run/docker.sock:/run/docker.sock:rw -e PANAMAX_ID=%PANAMAX_ID% -e JOURNAL_ENDPOINT=http://172.17.42.1:19531 -e FLEETCTL_ENDPOINT=http://172.17.42.1:4001 -t -p 3001:3000 centurylink/panamax-api\n        ExecStop=/usr/bin/docker stop PMX_API\n        Restart=always\n\n        [Install]\n        WantedBy=multi-user.target      \n\n    - name: panamax-ui.service\n      command: start\n      runtime: no\n      content: |\n        [Unit]\n        Description=Panamax UI\n        After=panamax-api.service panamax-metrics.service\n        Requires=panamax-api.service panamax-metrics.service\n\n        [Service]\n        ExecStartPre=-/usr/bin/docker rm -f PMX_UI\n        ExecStart=/usr/bin/docker run --name PMX_UI -m=1g -c=10 -v /var/run/docker.sock:/run/docker.sock:rw --link PMX_API:PMX_API --link PMX_CADVISOR:CADVISOR -p 3000:3000 centurylink/panamax-ui\n        ExecStop=/usr/bin/docker stop PMX_UI\n        Restart=always\n\n        [Install]\n        WantedBy=multi-user.target\n\n\n\nfor VirtualBox\n$ vagrant up\n$ open http://localhost:8888\n\n\nfor Parallels Desktop 9\n$ vagrant up --provider parallels\n$ open http://$(vagrant ssh-config | sed -n \"s/[ ]*HostName[ ]*//gp\"):3000\n\n\nfor Parallels Desktop 10\n$ vagrant up --provider parallels\n$ open http://localhost:8888\n\n\u203b) PD 10 \u304b\u3089\u306f VirtualBox \u3068\u540c\u69d8\u306b Vagrant \u306e Port Forwarding \u306b\u5bfe\u5fdc\u3059\u308b\u3002\nPanamax \u306e\u30d5\u30ed\u30f3\u30c8\u30a8\u30f3\u30c9\u306e\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u8aad\u3093\u3067\u3044\u305f\u3089\u3001\u5b9f\u306f\u305d\u3093\u306a\u306b\u8907\u96d1\u306a\u3053\u3068\u3092\u3057\u3066\u3044\u306a\u3044\u3088\u3046\u306a\u306e\u3067\u3001\u7406\u89e3\u3057\u3084\u3059\u3044\u3088\u3046\u306b\u6574\u7406\u3057\u3066 cloud-config \u3092\u4f7f\u3046\u3088\u3046\u306b\u66f8\u304d\u76f4\u3057\u3066\u307f\u307e\u3057\u305f\u3002\nVagrant \u3067\u4e00\u62ec\u3057\u3066\u7ba1\u7406\u3067\u304d\u307e\u3059\u3057\u3001\u898b\u901a\u3057\u3082\u826f\u304f\u306a\u3063\u3066\u3044\u308d\u3044\u308d\u5f04\u308c\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3057\u305f\u3002\n\u4eca\u306f\u307e\u3060\u5bfe\u5fdc\u3057\u3066\u306a\u3044\u3088\u3046\u3067\u3059\u304c\u3001\u30af\u30e9\u30b9\u30bf\u3092\u69cb\u7bc9\u3059\u308b\u969b\u3082\u7c21\u5358\u306b\u306a\u308b\u3088\u3046\u306a\u6c17\u304c\u3057\u307e\u3059\u3002\n\nPanamax without Installer\nhttps://gist.github.com/YungSang/0440f754c01a07d0f1ce\n\u203b) Panamax v0.1.2 \u306b\u57fa\u3044\u3066\u3044\u307e\u3059\u3002\n\n```ruby:Vagrantfile\n# -*- mode: ruby -*-\n# vi: set ft=ruby :\n \n# Vagrantfile API/syntax version. Don't touch unless you know what you're doing!\nVAGRANTFILE_API_VERSION = \"2\"\n \nVagrant.configure(VAGRANTFILE_API_VERSION) do |config|\n  config.vm.box = \"yungsang/coreos\"\n \n  config.vm.define \"panamax\" do |panamax|\n    panamax.vm.hostname = \"panamax\"\n \n    panamax.vm.network :forwarded_port, guest: 3000, host: 8888\n    panamax.vm.network :forwarded_port, guest: 3001, host: 8889\n \n    panamax.vm.provision :docker do |d|\n      d.pull_images \"centurylink/panamax-ui:latest\"\n      d.pull_images \"centurylink/panamax-api:latest\"\n      d.pull_images \"google/cadvisor:0.1.0\"\n    end\n \n    panamax.vm.provision :file, source: \"./panamax.yml\", destination: \"/tmp/vagrantfile-user-data\"\n \n    panamax.vm.provision :shell do |sh|\n      sh.privileged = true\n      sh.inline = <<-EOT\n        export PANAMAX_ID=$(/usr/bin/uuidgen)\n        sed -e \"s/%PANAMAX_ID%/${PANAMAX_ID}/g\" -i /tmp/vagrantfile-user-data\n \n        mv /tmp/vagrantfile-user-data /var/lib/coreos-vagrant/\n      EOT\n    end\n  end\nend\n```\n\n```yaml:panamax.yml\n#cloud-config\n \ncoreos:\n  units:\n    - name: etcd.service\n      command: start\n \n    - name: fleet.service\n      command: start\n \n    - name: panamax-metrics.service\n      command: start\n      runtime: no\n      content: |\n        [Unit]\n        Description=Panamax Metrics\n \n        [Service]\n        ExecStartPre=-/usr/bin/docker rm -f PMX_CADVISOR\n        ExecStart=/usr/bin/docker run --volume=/var/run:/var/run:rw --volume=/sys/fs/cgroup/:/sys/fs/cgroup:ro --volume=/var/lib/docker/:/var/lib/docker:ro --publish=:8080 --name=PMX_CADVISOR google/cadvisor:0.1.0\n        ExecStop=/usr/bin/docker stop PMX_CADVISOR\n        Restart=always\n \n        [Install]\n        WantedBy=multi-user.target    \n \n    - name: panamax-api.service\n      command: start\n      runtime: no\n      content: |\n        [Unit]\n        Description=Panamax API\n        After=docker.service\n        Requires=docker.service\n \n        [Service]\n        ExecStartPre=-/usr/bin/docker rm -f PMX_API\n        ExecStart=/usr/bin/docker run --name PMX_API -v /var/panamax-data:/usr/src/app/db/mnt -m=1g -c=10 -v /var/run/docker.sock:/run/docker.sock:rw -e PANAMAX_ID=%PANAMAX_ID% -e JOURNAL_ENDPOINT=http://172.17.42.1:19531 -e FLEETCTL_ENDPOINT=http://172.17.42.1:4001 -t -p 3001:3000 centurylink/panamax-api\n        ExecStop=/usr/bin/docker stop PMX_API\n        Restart=always\n \n        [Install]\n        WantedBy=multi-user.target      \n \n    - name: panamax-ui.service\n      command: start\n      runtime: no\n      content: |\n        [Unit]\n        Description=Panamax UI\n        After=panamax-api.service panamax-metrics.service\n        Requires=panamax-api.service panamax-metrics.service\n \n        [Service]\n        ExecStartPre=-/usr/bin/docker rm -f PMX_UI\n        ExecStart=/usr/bin/docker run --name PMX_UI -m=1g -c=10 -v /var/run/docker.sock:/run/docker.sock:rw --link PMX_API:PMX_API --link PMX_CADVISOR:CADVISOR -p 3000:3000 centurylink/panamax-ui\n        ExecStop=/usr/bin/docker stop PMX_UI\n        Restart=always\n \n        [Install]\n        WantedBy=multi-user.target\n```\n\n## for VirtualBox\n```\n$ vagrant up\n$ open http://localhost:8888\n```\n\n## for Parallels Desktop 9\n```\n$ vagrant up --provider parallels\n$ open http://$(vagrant ssh-config | sed -n \"s/[ ]*HostName[ ]*//gp\"):3000\n```\n\n## for Parallels Desktop 10\n```\n$ vagrant up --provider parallels\n$ open http://localhost:8888\n```\n\n\u203b) PD 10 \u304b\u3089\u306f VirtualBox \u3068\u540c\u69d8\u306b Vagrant \u306e Port Forwarding \u306b\u5bfe\u5fdc\u3059\u308b\u3002\n", "tags": ["CoreOS", "vagrant", "Panamax"]}