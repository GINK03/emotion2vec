{"context": " More than 1 year has passed since last update.\n\n\u306f\u3058\u3081\u306b\n\u4eca\u56de\u306e\u5185\u5bb9\u306f\u3001heroku\u4e0a\u3067Go\u3092\u5b9f\u884c\u3059\u308b\u969b\u306b\u30a2\u30c9\u30aa\u30f3\u306eRedis\u3092\u4f7f\u3046\u65b9\u6cd5\u306e\u8aac\u660e\u306b\u306a\u308a\u307e\u3059\u3002\n\u3061\u306a\u307f\u306bheroku\u4e0a\u3067Go\u3092\u52d5\u304b\u3059\u8aac\u660e\u306f\u3001\u3053\u3061\u3089\u306a\u3069\u304c\u53c2\u8003\u306b\u306a\u308b\u304b\u3068\u601d\u3044\u307e\u3059\u3002\n\nheroku\u306e\u74b0\u5883\u5909\u6570\nREDISTOGO_URL\u3067\u3059\u3002\n\u3053\u306e\u74b0\u5883\u5909\u6570\u304b\u3089\u53d6\u5f97\u3067\u304d\u308b\u5024\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u5185\u5bb9\u306b\u306a\u308a\u307e\u3059\u3002\nredis://redistogo:<password>@xxxxxx.redistogo.com:11068/\n\n\u624b\u9806\n\u4eca\u56deRedis\u306e\u30a2\u30af\u30bb\u30b9\u306b\u4ee5\u4e0b\u306e\u30e9\u30a4\u30d6\u30e9\u30ea\u3092\u4f7f\u3044\u307e\u3059\u3002\nhttp://godoc.org/gopkg.in/redis.v2\n\u74b0\u5883\u5909\u6570\u304b\u3089\u53d6\u5f97\u3057\u305f\u5185\u5bb9\u3092redis.Options\u306b\u8a70\u3081\u66ff\u3048\u308b\u5fc5\u8981\u304c\u3042\u308b\u305f\u3081\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\n\nredis.go\npackage example\n\nimport (\n    \"fmt\"\n    \"net/url\"\n    \"os\"\n\n    \"gopkg.in/redis.v2\"\n)\n\nfunc redisExample() {\n    addr, password := getHerokuRedisAddr()\n    client := redis.NewTCPClient(&redis.Options{\n        Addr: addr,\n        Password: password,\n    })\n    defer client.Close()\n\n    // redis\u3078\u30a2\u30af\u30bb\u30b9\uff08\u9069\u5f53\u306a\u30b3\u30fc\u30c9\uff09\n    fmt.Println(client.Get(\"hoge\").Result())\n}\n\n// local\u5b9f\u884c\u7528\u306b\u74b0\u5883\u5909\u6570\u304c\u306a\u3044\u3068\u304d\u306f`localhost:6379`\u3092\u8fd4\u3057\u307e\u3059\nfunc getHerokuRedisAddr() (addr string, password string) {\n    addr = \"localhost:6379\"\n    password = \"\"\n\n    redisURL := os.Getenv(\"REDISTOGO_URL\")\n    if redisURL == \"\" {\n        return\n    }\n\n    redisInfo, err := url.Parse(redisURL)\n    if err != nil {\n        return\n    }\n\n    addr = redisInfo.Host\n    if redisInfo.User != nil {\n        password, _ = redisInfo.User.Password()\n    }\n    return\n}\n\n\n\u4e00\u5fdc\u3001\u30ed\u30fc\u30ab\u30eb\u74b0\u5883\u3067\u3082\u52d5\u304f\u3088\u3046\u306b\u3057\u3066\u3044\u307e\u3059\u3002\n# \u306f\u3058\u3081\u306b\n\n\u4eca\u56de\u306e\u5185\u5bb9\u306f\u3001heroku\u4e0a\u3067Go\u3092\u5b9f\u884c\u3059\u308b\u969b\u306b\u30a2\u30c9\u30aa\u30f3\u306eRedis\u3092\u4f7f\u3046\u65b9\u6cd5\u306e\u8aac\u660e\u306b\u306a\u308a\u307e\u3059\u3002\n\n\u3061\u306a\u307f\u306bheroku\u4e0a\u3067Go\u3092\u52d5\u304b\u3059\u8aac\u660e\u306f\u3001[\u3053\u3061\u3089](http://deeeet.com/writing/2014/04/23/martini/)\u306a\u3069\u304c\u53c2\u8003\u306b\u306a\u308b\u304b\u3068\u601d\u3044\u307e\u3059\u3002\n\n# heroku\u306e\u74b0\u5883\u5909\u6570\n\n`REDISTOGO_URL`\u3067\u3059\u3002\n\n\u3053\u306e\u74b0\u5883\u5909\u6570\u304b\u3089\u53d6\u5f97\u3067\u304d\u308b\u5024\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u5185\u5bb9\u306b\u306a\u308a\u307e\u3059\u3002\n\n`redis://redistogo:<password>@xxxxxx.redistogo.com:11068/`\n\n# \u624b\u9806\n\n\u4eca\u56deRedis\u306e\u30a2\u30af\u30bb\u30b9\u306b\u4ee5\u4e0b\u306e\u30e9\u30a4\u30d6\u30e9\u30ea\u3092\u4f7f\u3044\u307e\u3059\u3002\n\nhttp://godoc.org/gopkg.in/redis.v2\n\n\u74b0\u5883\u5909\u6570\u304b\u3089\u53d6\u5f97\u3057\u305f\u5185\u5bb9\u3092`redis.Options`\u306b\u8a70\u3081\u66ff\u3048\u308b\u5fc5\u8981\u304c\u3042\u308b\u305f\u3081\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\n\n```go:redis.go\npackage example\n\nimport (\n\t\"fmt\"\n\t\"net/url\"\n\t\"os\"\n\n\t\"gopkg.in/redis.v2\"\n)\n\nfunc redisExample() {\n\taddr, password := getHerokuRedisAddr()\n\tclient := redis.NewTCPClient(&redis.Options{\n\t\tAddr: addr,\n\t\tPassword: password,\n\t})\n\tdefer client.Close()\n\n\t// redis\u3078\u30a2\u30af\u30bb\u30b9\uff08\u9069\u5f53\u306a\u30b3\u30fc\u30c9\uff09\n\tfmt.Println(client.Get(\"hoge\").Result())\n}\n\n// local\u5b9f\u884c\u7528\u306b\u74b0\u5883\u5909\u6570\u304c\u306a\u3044\u3068\u304d\u306f`localhost:6379`\u3092\u8fd4\u3057\u307e\u3059\nfunc getHerokuRedisAddr() (addr string, password string) {\n\taddr = \"localhost:6379\"\n\tpassword = \"\"\n\n\tredisURL := os.Getenv(\"REDISTOGO_URL\")\n\tif redisURL == \"\" {\n\t\treturn\n\t}\n\n\tredisInfo, err := url.Parse(redisURL)\n\tif err != nil {\n\t\treturn\n\t}\n\t\n\taddr = redisInfo.Host\n\tif redisInfo.User != nil {\n\t\tpassword, _ = redisInfo.User.Password()\n\t}\n\treturn\n}\n```\n\n\u4e00\u5fdc\u3001\u30ed\u30fc\u30ab\u30eb\u74b0\u5883\u3067\u3082\u52d5\u304f\u3088\u3046\u306b\u3057\u3066\u3044\u307e\u3059\u3002\n\n", "tags": ["Heroku", "Go", "Redis"]}