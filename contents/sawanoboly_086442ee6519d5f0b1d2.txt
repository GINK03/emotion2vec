{"tags": ["infrastructure", "Ruby", "chef"], "context": " More than 1 year has passed since last update.\n\n\u3053\u306e\u8a18\u4e8b\u306f\u6700\u7d42\u66f4\u65b0\u304b\u30891\u5e74\u4ee5\u4e0a\u7d4c\u904e\u3057\u3066\u3044\u307e\u3059\u3002 \u6c17\u3092\u3064\u3051\u3066\u306d\u3002\n\nLibrarian-chef \u3092\u4f7f\u3044\u3001bundler\u306e\u3088\u3046\u306b\u5fc5\u8981\u306acookbook\u3092\u7ba1\u7406\u3059\u308b\u3002\n\nChef\u306e\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\n\u6bce\u5ea6\u3064\u304b\u3046\u3082\u306e\u306a\u306e\u3067\u3001git clone\u4e00\u767a\u3067chef-client\u7cfb\u3092\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\u51fa\u6765\u308b\u3088\u3046\u306b\u3057\u305f\u3002\nUbuntu: https://github.com/higanworks/chef-with-ruby_precise-x86_64\nCentOS: https://github.com/higanworks/chef-with-ruby_CentOS-x86_64\n\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\u306fREADME\u306b\u3042\u308b\u3088\u3046\u306b\u30b3\u30de\u30f3\u30c92\u3064\u3002\n$ apt-get install git\n$ git clone https://github.com/higanworks/chef-with-ruby_`lsb_release -cs`-`uname -i`.git /opt/ruby-chef\n\n\u4ee5\u964d\u306f\u3068\u308a\u3042\u3048\u305aUbuntu\u3067\u4e0a\u8a18\u3092\u4f7f\u3063\u305f\u5834\u5408\u306echef-solo\u767a\u52d5\u307e\u3067\u3092\u7d39\u4ecb\u3002\n\nCheffile\u4f5c\u696d\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3078\n\u30ea\u30dd\u30b8\u30c8\u30ea\u3092\u30af\u30ed\u30fc\u30f3\u3057\u305f\u3089 /opt/ruby-chef \u3067\u4f5c\u696d\u3059\u308b\u3002\ncd /opt/ruby-chef\n\u30b5\u30f3\u30d7\u30eb\u3067\u306fcookbooks\u3082\u3053\u306e\u4e0b\u306b\u7f6e\u304b\u308c\u308b\u3088\u3046\u306b\u3057\u3066\u3044\u308b\u3002\nlibrarian-chef\u306f\u5fc5\u8981\u306aCookbook\u306e\u540d\u524d\u3068\u6240\u5728\u3001\u4f9d\u5b58\u3092Cheffile\u306b\u66f8\u304d\u3001install\u30b5\u30d6\u30b3\u30de\u30f3\u30c9\u3067Cookbooks\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092\u5f62\u6210\u3059\u308b\u3002\n\u96c6\u3081\u305f\u7d50\u679c\u3092Cheffile.lock\u306b\u66f8\u304f\u3001lock\u3092\u5143\u306b\u4f5c\u308bdeployment\u30e2\u30fc\u30c9\u3053\u305d\u7121\u3055\u305d\u3046\u3060\u304c\u3068\u3066\u3082bundler\u306e\u3088\u3046\u3060\u3002\nCheffile.sample \u3092\u305d\u306e\u307e\u307e\u4f7f\u3046\u5834\u5408\u306fCheffile\u3068\u3057\u3066\u30b3\u30d4\u30fc\u3002\ncp Cheffile.sample Cheffile\n\u7a7a\u306eCheffile\u3092\u4f5c\u308b\u5834\u5408\u306f\n./bin/librarian-chef init\n\nCheffile\u304b\u3089cookbooks\u306e\u6e96\u5099\nchef\u30d5\u30a1\u30a4\u30eb\u306bcookbook\u306e\u540d\u524d\u3068\u6240\u5728\u3092\u66f8\u304f\u3001\u3068\u308a\u3042\u3048\u305asolo\u306a\u306e\u3067\u3053\u306e\u30b5\u30fc\u30d0\u306b\u5fc5\u8981\u306a\u3082\u306e\u3060\u3051\u8a18\u8ff0\u3002\nnginx\u3068redis\u3068monit\u3092\u5c0e\u5165\u3057\u305f\u3044\u3001\u3064\u3044\u3067\u306bruby(rvm)\u3002\n\nCheffile(sample)\n#!/usr/bin/env ruby\n#^syntax detection\n\nsite 'http://community.opscode.com/api/v1'\n\ncookbook 'apt'\n\n# external\ncookbook 'rvm',\n  :git => 'https://github.com/fnichol/chef-rvm'\n\n# my cookbooks\ncookbook 'nginx_ppa',\n  :git => 'https://github.com/higanworks-cookbooks/nginx_ppa.git'\n\ncookbook 'monit_binaries',\n  :git => 'https://github.com/higanworks-cookbooks/monit_binaries.git'\n\ncookbook 'redis_src',\n  :git => 'https://github.com/higanworks-cookbooks/redis_src.git'\n\n\n\nCookbook\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n./bin/librarian-chef install \u3068\u53e9\u304d\u3001./cookbooks\u306e\u4e0b\u306bCookbook\u3092\u96c6\u3081\u3066\u304f\u308b\u3002\n# ./bin/librarian-chef install\n# ./bin/librarian-chef show\napt (1.4.8)\nmonit_binaries (0.0.3)\nnginx_ppa (0.0.1)\nredis_src (0.0.1)\nrvm (0.9.1)\n\n\u3082\u3061\u308d\u3093\u3053\u308c\u3092knife cookbook upload\u3059\u308b\u3088\u3046\u306a\u904b\u7528\u3082\u3042\u308a\u3002\n\n\u30ec\u30b7\u30d4\u306e\u9069\u7528\n\n\u5358\u4e00\u306e\u30ec\u30b7\u30d4\u9069\u7528\nsolo\u7528\u306e\u30b5\u30f3\u30d7\u30eb\u30b3\u30f3\u30d5\u30a3\u30b0\u304c\u3064\u3044\u3066\u3044\u308b\u306e\u3067\u53e9\u304f\u3002\n\u9069\u7528\u3057\u305f\u3044\u30ec\u30b7\u30d4\u306f-o\u3067\u6307\u5b9a\u3067\u304d\u308b\u3002\n# ./bin/chef-solo -c solo.rb -o nginx_ppa::default\n-- snip --\n[2012-09-19T20:29:28-07:00] INFO: Processing package[nginx] action install (nginx_ppa::default line 34)\n-- snip --\n\n# nginx -v\nnginx version: nginx/1.2.3\n\n\nJson\u306e\u69cb\u6210\u30d5\u30a1\u30a4\u30eb\u3092\u7528\u3044\u305f\u8907\u6570\u306e\u30ec\u30b7\u30d4\u9069\u7528\n-o\u306e\u76f4\u63a5\u6307\u5b9a\u3067\u306f\u306a\u304f\u3001chef-solo\u306b-j\u3067json\u306b\u3088\u308b\u69cb\u6210\u30d5\u30a1\u30a4\u30eb\u3092\u6e21\u3059\u3002\n\u8272\u3005\u5165\u308c\u3066\u3001rvm\u3067ruby1.9.3\u3092\u4f7f\u3048\u308b\u3088\u3046\u306b\u3057\u3066\u304a\u3044\u3066\u306d\u3068\u3044\u3046\u30b3\u30fc\u30b9\u3002\n\nsample.json\n{\n   \"rvm\" : {\n      \"default_ruby\" : \"system\",\n      \"rubies\" : [\n         \"ruby-1.9.3-p194\"\n      ]\n   },\n   \"run_list\" : [\n      \"recipe[apt]\",\n      \"recipe[nginx_ppa]\",\n      \"recipe[monit_binaries]\",\n      \"recipe[redis_src]\",\n      \"recipe[rvm::system]\"\n   ]\n}\n\n\nRole\u3082\u66f8\u3051\u308b\u3002\n# ./bin/chef-solo -c solo.rb -j ./sample.json\n[2012-09-19T20:28:35-07:00] INFO: *** Chef 10.14.2 ***\n[2012-09-19T20:28:35-07:00] INFO: Setting the run_list to [\"recipe[apt]\", \"recipe[nginx_ppa]\", \"recipe[monit_binaries]\", \"recipe[redis_src]\", \"recipe[rvm::system]\"] from JSON\n[2012-09-19T20:28:35-07:00] INFO: Run List is [recipe[apt], recipe[nginx_ppa], recipe[monit_binaries], recipe[redis_src], recipe[rvm::system]]\n\n-- snip --\n\n# redis-server -v\nRedis server version 2.4.16 (04a08723:1)\n\n# monit -V\nThis is Monit version 5.5\nCopyright (C) 2001-2012 Tildeslash Ltd. All Rights Reserved.\n\n# nginx -v\nnginx version: nginx/1.2.3\n\n\u3042\u3068\u306f\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3092\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u306b\u30ec\u30b7\u30d4\u3092\u66f8\u3044\u3066\u3001\u69cb\u6210\u3092\u30d0\u30fc\u30b8\u30e7\u30f3\u7ba1\u7406\u3057\u3066\u3044\u304f\u3002\n<!-- too_old -->\n> **\u3053\u306e\u8a18\u4e8b\u306f\u6700\u7d42\u66f4\u65b0\u304b\u30891\u5e74\u4ee5\u4e0a\u7d4c\u904e\u3057\u3066\u3044\u307e\u3059\u3002** \u6c17\u3092\u3064\u3051\u3066\u306d\u3002\n\n[Librarian-chef](https://github.com/applicationsonline/librarian) \u3092\u4f7f\u3044\u3001bundler\u306e\u3088\u3046\u306b\u5fc5\u8981\u306acookbook\u3092\u7ba1\u7406\u3059\u308b\u3002\n\n\n\nChef\u306e\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\n----\n\u6bce\u5ea6\u3064\u304b\u3046\u3082\u306e\u306a\u306e\u3067\u3001`git clone`\u4e00\u767a\u3067chef-client\u7cfb\u3092\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\u51fa\u6765\u308b\u3088\u3046\u306b\u3057\u305f\u3002\n\nUbuntu: https://github.com/higanworks/chef-with-ruby_precise-x86_64\nCentOS: https://github.com/higanworks/chef-with-ruby_CentOS-x86_64\n\n\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\u306fREADME\u306b\u3042\u308b\u3088\u3046\u306b\u30b3\u30de\u30f3\u30c92\u3064\u3002\n\n```\n$ apt-get install git\n$ git clone https://github.com/higanworks/chef-with-ruby_`lsb_release -cs`-`uname -i`.git /opt/ruby-chef\n```\n\n\u4ee5\u964d\u306f\u3068\u308a\u3042\u3048\u305aUbuntu\u3067\u4e0a\u8a18\u3092\u4f7f\u3063\u305f\u5834\u5408\u306e`chef-solo`\u767a\u52d5\u307e\u3067\u3092\u7d39\u4ecb\u3002\n\n\nCheffile\u4f5c\u696d\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3078\n----\n\u30ea\u30dd\u30b8\u30c8\u30ea\u3092\u30af\u30ed\u30fc\u30f3\u3057\u305f\u3089 /opt/ruby-chef \u3067\u4f5c\u696d\u3059\u308b\u3002\n\n`cd /opt/ruby-chef`\n\n\u30b5\u30f3\u30d7\u30eb\u3067\u306fcookbooks\u3082\u3053\u306e\u4e0b\u306b\u7f6e\u304b\u308c\u308b\u3088\u3046\u306b\u3057\u3066\u3044\u308b\u3002\n\n`librarian-chef`\u306f\u5fc5\u8981\u306aCookbook\u306e\u540d\u524d\u3068\u6240\u5728\u3001\u4f9d\u5b58\u3092**Cheffile**\u306b\u66f8\u304d\u3001`install`\u30b5\u30d6\u30b3\u30de\u30f3\u30c9\u3067Cookbooks\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092\u5f62\u6210\u3059\u308b\u3002\n\u96c6\u3081\u305f\u7d50\u679c\u3092`Cheffile.lock`\u306b\u66f8\u304f\u3001lock\u3092\u5143\u306b\u4f5c\u308b`deployment`\u30e2\u30fc\u30c9\u3053\u305d\u7121\u3055\u305d\u3046\u3060\u304c\u3068\u3066\u3082bundler\u306e\u3088\u3046\u3060\u3002\n\n\nCheffile.sample \u3092\u305d\u306e\u307e\u307e\u4f7f\u3046\u5834\u5408\u306fCheffile\u3068\u3057\u3066\u30b3\u30d4\u30fc\u3002\n`cp Cheffile.sample Cheffile`\n\n\u7a7a\u306eCheffile\u3092\u4f5c\u308b\u5834\u5408\u306f\n`./bin/librarian-chef init`\n\n\nCheffile\u304b\u3089cookbooks\u306e\u6e96\u5099\n----\n\nchef\u30d5\u30a1\u30a4\u30eb\u306bcookbook\u306e\u540d\u524d\u3068\u6240\u5728\u3092\u66f8\u304f\u3001\u3068\u308a\u3042\u3048\u305asolo\u306a\u306e\u3067\u3053\u306e\u30b5\u30fc\u30d0\u306b\u5fc5\u8981\u306a\u3082\u306e\u3060\u3051\u8a18\u8ff0\u3002\n\n`nginx`\u3068`redis`\u3068`monit`\u3092\u5c0e\u5165\u3057\u305f\u3044\u3001\u3064\u3044\u3067\u306bruby(rvm)\u3002\n\n```ruby:Cheffile(sample)\n#!/usr/bin/env ruby\n#^syntax detection\n\nsite 'http://community.opscode.com/api/v1'\n\ncookbook 'apt'\n\n# external\ncookbook 'rvm',\n  :git => 'https://github.com/fnichol/chef-rvm'\n\n# my cookbooks\ncookbook 'nginx_ppa',\n  :git => 'https://github.com/higanworks-cookbooks/nginx_ppa.git'\n\ncookbook 'monit_binaries',\n  :git => 'https://github.com/higanworks-cookbooks/monit_binaries.git'\n\ncookbook 'redis_src',\n  :git => 'https://github.com/higanworks-cookbooks/redis_src.git'\n```\n\n### Cookbook\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n`./bin/librarian-chef install` \u3068\u53e9\u304d\u3001`./cookbooks`\u306e\u4e0b\u306bCookbook\u3092\u96c6\u3081\u3066\u304f\u308b\u3002\n\n```\u5b9f\u884c\u7d50\u679c\n# ./bin/librarian-chef install\n# ./bin/librarian-chef show\napt (1.4.8)\nmonit_binaries (0.0.3)\nnginx_ppa (0.0.1)\nredis_src (0.0.1)\nrvm (0.9.1)\n```\n\n\u3082\u3061\u308d\u3093\u3053\u308c\u3092`knife cookbook upload`\u3059\u308b\u3088\u3046\u306a\u904b\u7528\u3082\u3042\u308a\u3002\n\n\n\u30ec\u30b7\u30d4\u306e\u9069\u7528\n----\n\n### \u5358\u4e00\u306e\u30ec\u30b7\u30d4\u9069\u7528\nsolo\u7528\u306e\u30b5\u30f3\u30d7\u30eb\u30b3\u30f3\u30d5\u30a3\u30b0\u304c\u3064\u3044\u3066\u3044\u308b\u306e\u3067\u53e9\u304f\u3002\n\u9069\u7528\u3057\u305f\u3044\u30ec\u30b7\u30d4\u306f`-o`\u3067\u6307\u5b9a\u3067\u304d\u308b\u3002\n\n```\u5b9f\u884c\u7d50\u679c\n# ./bin/chef-solo -c solo.rb -o nginx_ppa::default\n-- snip --\n[2012-09-19T20:29:28-07:00] INFO: Processing package[nginx] action install (nginx_ppa::default line 34)\n-- snip --\n\n# nginx -v\nnginx version: nginx/1.2.3\n```\n\n### Json\u306e\u69cb\u6210\u30d5\u30a1\u30a4\u30eb\u3092\u7528\u3044\u305f\u8907\u6570\u306e\u30ec\u30b7\u30d4\u9069\u7528\n`-o`\u306e\u76f4\u63a5\u6307\u5b9a\u3067\u306f\u306a\u304f\u3001`chef-solo`\u306b`-j`\u3067json\u306b\u3088\u308b\u69cb\u6210\u30d5\u30a1\u30a4\u30eb\u3092\u6e21\u3059\u3002\n\u8272\u3005\u5165\u308c\u3066\u3001rvm\u3067ruby1.9.3\u3092\u4f7f\u3048\u308b\u3088\u3046\u306b\u3057\u3066\u304a\u3044\u3066\u306d\u3068\u3044\u3046\u30b3\u30fc\u30b9\u3002\n\n\n\n```json:sample.json\n{\n   \"rvm\" : {\n      \"default_ruby\" : \"system\",\n      \"rubies\" : [\n         \"ruby-1.9.3-p194\"\n      ]\n   },\n   \"run_list\" : [\n      \"recipe[apt]\",\n      \"recipe[nginx_ppa]\",\n      \"recipe[monit_binaries]\",\n      \"recipe[redis_src]\",\n      \"recipe[rvm::system]\"\n   ]\n}\n```\n\nRole\u3082\u66f8\u3051\u308b\u3002\n\n```\u5b9f\u884c\u7d50\u679c\n# ./bin/chef-solo -c solo.rb -j ./sample.json\n[2012-09-19T20:28:35-07:00] INFO: *** Chef 10.14.2 ***\n[2012-09-19T20:28:35-07:00] INFO: Setting the run_list to [\"recipe[apt]\", \"recipe[nginx_ppa]\", \"recipe[monit_binaries]\", \"recipe[redis_src]\", \"recipe[rvm::system]\"] from JSON\n[2012-09-19T20:28:35-07:00] INFO: Run List is [recipe[apt], recipe[nginx_ppa], recipe[monit_binaries], recipe[redis_src], recipe[rvm::system]]\n\n-- snip --\n\n# redis-server -v\nRedis server version 2.4.16 (04a08723:1)\n\n# monit -V\nThis is Monit version 5.5\nCopyright (C) 2001-2012 Tildeslash Ltd. All Rights Reserved.\n\n# nginx -v\nnginx version: nginx/1.2.3\n```\n\n\u3042\u3068\u306f\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3092\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u306b\u30ec\u30b7\u30d4\u3092\u66f8\u3044\u3066\u3001\u69cb\u6210\u3092\u30d0\u30fc\u30b8\u30e7\u30f3\u7ba1\u7406\u3057\u3066\u3044\u304f\u3002\n"}