{"context": "\u6a19\u6e96\u30e9\u30a4\u30d6\u30e9\u30ea\u306e\u65b9\u306b\u3082\u624b\u3092\u52a0\u3048\u308b\u6539\u9020\u3092\u3057\u307e\u3059\nwindows\u74b0\u5883\u4ee5\u5916\u307e\u305f\u306f\u4e26\u5217\u51e6\u7406\u3092\u3057\u306a\u3044\u5834\u5408\u306f\u3001\u6539\u9020\u306f\u5fc5\u8981\u3042\u308a\u307e\u305b\u3093\n\n\u306f\u3058\u3081\u306b\n\nluigi\u3068\u306f\n\u30b8\u30e7\u30d6\u30b9\u30b1\u30b8\u30e5\u30fc\u30e9\u30fc\u306e\u4e00\u7a2e\u3067\u3059\u3002\n\u8907\u6570\u306e\u30b8\u30e7\u30d6\u306e\u9593\u306b\u4f9d\u5b58\u95a2\u4fc2\u304c\u3042\u308b\u5834\u5408\u3001\u305d\u308c\u3089\u3092\u6b63\u3057\u3044\u9806\u5e8f\u3067\u5b9f\u884c\u3057\u3066\u304f\u308c\u307e\u3059\u3002\n\u307e\u305f\u3001\u30b8\u30e7\u30d6\u306e\u9593\u306b\u4f9d\u5b58\u95a2\u4fc2\u304c\u306a\u3044\u5834\u5408\u306f\u4e26\u5217\u306b\u5b9f\u884c\u3057\u3066\u304f\u308c\u307e\u3059\u3002\n\u8a73\u3057\u304f\u306f\u516c\u5f0f\u30da\u30fc\u30b8\u3092\u898b\u3066\u304f\u3060\u3055\u3044\u3002\nspotify/luigi\n\nwindows\u74b0\u5883\u3067\u306e\u554f\u984c\nwindows\u74b0\u5883\u3067\u306e\u307f\u4e26\u5217\u5316\u304c\u3067\u304d\u307e\u305b\u3093\u3002\n\u305d\u306e\u539f\u56e0\u306f\u3001luigi\u3067\u306f\u30b8\u30e7\u30d6\u3092\u30d7\u30ed\u30bb\u30b9\u9593\u3067pickle\u3092\u4f7f\u3063\u3066\u30b7\u30ea\u30a2\u30e9\u30a4\u30ba\u3057\u3066\u3044\u307e\u3059\u304c\u3001windows\u74b0\u5883\u306epickle\u306e\u5b9f\u88c5\u3067\u306f\u30b7\u30ea\u30a2\u30e9\u30a4\u30ba\u3067\u304d\u306a\u3044\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u304c\u3042\u308b\u305b\u3044\u3067\u3059\u3002(\u591a\u5206)\n\n\u89e3\u6c7a\u7b56\n\n\u7121\u7406\u3084\u308a\u6539\u9020\u3059\u308b\u65b9\u6cd5(\u30d0\u30fc\u30b8\u30e7\u30f32.2.0\u4ee5\u4e0a)\n\u30e9\u30a4\u30d6\u30e9\u30ea\u3092\u66f8\u304d\u63db\u3048\u307e\u3059\u3002\n\u66f8\u304d\u63db\u3048\u5bfe\u8c61\u306fluigi/worker.py\u3068\u6a19\u6e96\u30e9\u30a4\u30d6\u30e9\u30ea\u306emultiprocessing/reduction.py\u306e\u4e8c\u3064\u3067\u3059\u3002\n\nLib/site-packages/luigi/worker.py\n# import\u3092\u8ffd\u52a0\nfrom functools import partial\n\n# TaskProcess.__init__\u5185\u90e8\nclass TaskProcess(multiprocessing.Process):\n    ...\n    def __init__(self, task, worker_id, result_queue, tracking_url_callback,\n                 status_message_callback, use_multiprocessing=False, worker_timeout=0):\n        ...\n        # self.tracking_url_callback = tracking_url_callback\n        self.tracking_url_callback = partial(tracking_url_callback, task)\n        # self.status_message_callback = status_message_callback\n        self.status_message_callback = partial(status_message_callback, task)\n        ...\n    ...\n\nclass worker(Config):\n    ...\n    # Worker._create_task_process\u306e\u5185\u90e8\u306e\u95a2\u6570\u3092\u79fb\u52d5\n    def _update_tracking_url(self, task, tracking_url):\n            self._scheduler.add_task(\n                task_id=task.task_id,\n                worker=self._id,\n                status=RUNNING,\n                tracking_url=tracking_url,\n            )\n\n    # Worker._create_task_process\u306e\u5185\u90e8\u306e\u95a2\u6570\u3092\u79fb\u52d5\n    def _update_status_message(self, task, message):\n        self._scheduler.set_task_status_message(task.task_id, message)\n\n    def _create_task_process(self, task):\n        # def update_tracking_url(tracking_url):\n        #     self._scheduler.add_task(\n        #         task_id=task.task_id,\n        #         worker=self._id,\n        #         status=RUNNING,\n        #         tracking_url=tracking_url,\n        #     )\n\n        # def update_status_message(message):\n        #     self._scheduler.set_task_status_message(task.task_id, message)\n\n        return TaskProcess(\n            task, self._id, self._task_result_queue, self._update_tracking_url, self._update_status_message,\n            use_multiprocessing=bool(self.worker_processes > 1),\n            worker_timeout=self._config.timeout\n        )\n    ...\n\n\n\nLib/multiprocessing/reduction.py\n# \u5192\u982d\u306e\u30a4\u30f3\u30dd\u30fc\u30c8\u306e\u90e8\u5206\n# import pickle\nimport dill as pickle\n\n\ndill\u306fpip\u3067\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3067\u304d\u307e\u3059\u3002\n\n\u5225\u306e\u89e3\u6c7a\u7b56\n\u53e4\u3044\u30d0\u30fc\u30b8\u30e7\u30f3\u3092\u4f7f\u3044\u307e\u3059\u3002\u3053\u306e\u5834\u5408\u306f\u3001\u3042\u307e\u308a\u6539\u9020\u306f\u5fc5\u8981\u3042\u308a\u307e\u305b\u3093\u3002\n\u3053\u3061\u3089\u306f\u6a19\u6e96\u30e9\u30a4\u30d6\u30e9\u30ea\u306b\u306f\u624b\u3092\u52a0\u3048\u307e\u305b\u3093\u3002\nwindows\u3067luigi\u3092\u4e26\u5217\u51e6\u7406\u3055\u305b\u305f\u3089\u30a8\u30e9\u30fc\u306b\u306a\u3063\u305f\u3051\u3069\u3001\u305d\u306e\u89e3\u6c7a\u6cd5\nPickle crashing when trying to pickle \"update_tracking_url\" in luigi.worker?\n\n\u6700\u5f8c\u306b\n\u79c1\u304c\u5b9f\u969b\u306b\u4f7f\u3063\u3066\u3044\u308b\u9650\u308a\u3067\u306f\u554f\u984c\u306f\u8d77\u304d\u3066\u3044\u307e\u305b\u3093\u304c\u3001\n\u6539\u9020\u306f\u81ea\u5df1\u8cac\u4efb\u3067\u304a\u9858\u3044\u3057\u307e\u3059\u3002\n**\u6a19\u6e96\u30e9\u30a4\u30d6\u30e9\u30ea\u306e\u65b9\u306b\u3082\u624b\u3092\u52a0\u3048\u308b\u6539\u9020\u3092\u3057\u307e\u3059**\n**windows\u74b0\u5883\u4ee5\u5916\u307e\u305f\u306f\u4e26\u5217\u51e6\u7406\u3092\u3057\u306a\u3044\u5834\u5408\u306f\u3001\u6539\u9020\u306f\u5fc5\u8981\u3042\u308a\u307e\u305b\u3093**\n\n# \u306f\u3058\u3081\u306b\n\n## luigi\u3068\u306f\n\u30b8\u30e7\u30d6\u30b9\u30b1\u30b8\u30e5\u30fc\u30e9\u30fc\u306e\u4e00\u7a2e\u3067\u3059\u3002\n\u8907\u6570\u306e\u30b8\u30e7\u30d6\u306e\u9593\u306b\u4f9d\u5b58\u95a2\u4fc2\u304c\u3042\u308b\u5834\u5408\u3001\u305d\u308c\u3089\u3092\u6b63\u3057\u3044\u9806\u5e8f\u3067\u5b9f\u884c\u3057\u3066\u304f\u308c\u307e\u3059\u3002\n\u307e\u305f\u3001\u30b8\u30e7\u30d6\u306e\u9593\u306b\u4f9d\u5b58\u95a2\u4fc2\u304c\u306a\u3044\u5834\u5408\u306f\u4e26\u5217\u306b\u5b9f\u884c\u3057\u3066\u304f\u308c\u307e\u3059\u3002\n\n\u8a73\u3057\u304f\u306f\u516c\u5f0f\u30da\u30fc\u30b8\u3092\u898b\u3066\u304f\u3060\u3055\u3044\u3002\n[spotify/luigi](https://github.com/spotify/luigi)\n\n## windows\u74b0\u5883\u3067\u306e\u554f\u984c\nwindows\u74b0\u5883\u3067\u306e\u307f\u4e26\u5217\u5316\u304c\u3067\u304d\u307e\u305b\u3093\u3002\n\n\u305d\u306e\u539f\u56e0\u306f\u3001luigi\u3067\u306f\u30b8\u30e7\u30d6\u3092\u30d7\u30ed\u30bb\u30b9\u9593\u3067pickle\u3092\u4f7f\u3063\u3066\u30b7\u30ea\u30a2\u30e9\u30a4\u30ba\u3057\u3066\u3044\u307e\u3059\u304c\u3001windows\u74b0\u5883\u306epickle\u306e\u5b9f\u88c5\u3067\u306f\u30b7\u30ea\u30a2\u30e9\u30a4\u30ba\u3067\u304d\u306a\u3044\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u304c\u3042\u308b\u305b\u3044\u3067\u3059\u3002(\u591a\u5206)\n\n# \u89e3\u6c7a\u7b56\n\n## \u7121\u7406\u3084\u308a\u6539\u9020\u3059\u308b\u65b9\u6cd5(\u30d0\u30fc\u30b8\u30e7\u30f32.2.0\u4ee5\u4e0a)\n\u30e9\u30a4\u30d6\u30e9\u30ea\u3092\u66f8\u304d\u63db\u3048\u307e\u3059\u3002\n\u66f8\u304d\u63db\u3048\u5bfe\u8c61\u306fluigi/worker.py\u3068\u6a19\u6e96\u30e9\u30a4\u30d6\u30e9\u30ea\u306emultiprocessing/reduction.py\u306e\u4e8c\u3064\u3067\u3059\u3002\n\n```py3:Lib/site-packages/luigi/worker.py\n# import\u3092\u8ffd\u52a0\nfrom functools import partial\n\n# TaskProcess.__init__\u5185\u90e8\nclass TaskProcess(multiprocessing.Process):\n    ...\n    def __init__(self, task, worker_id, result_queue, tracking_url_callback,\n                 status_message_callback, use_multiprocessing=False, worker_timeout=0):\n        ...\n        # self.tracking_url_callback = tracking_url_callback\n        self.tracking_url_callback = partial(tracking_url_callback, task)\n        # self.status_message_callback = status_message_callback\n        self.status_message_callback = partial(status_message_callback, task)\n        ...\n    ...\n\nclass worker(Config):\n    ...\n    # Worker._create_task_process\u306e\u5185\u90e8\u306e\u95a2\u6570\u3092\u79fb\u52d5\n    def _update_tracking_url(self, task, tracking_url):\n            self._scheduler.add_task(\n                task_id=task.task_id,\n                worker=self._id,\n                status=RUNNING,\n                tracking_url=tracking_url,\n            )\n        \n    # Worker._create_task_process\u306e\u5185\u90e8\u306e\u95a2\u6570\u3092\u79fb\u52d5\n    def _update_status_message(self, task, message):\n        self._scheduler.set_task_status_message(task.task_id, message)\n\n    def _create_task_process(self, task):\n        # def update_tracking_url(tracking_url):\n        #     self._scheduler.add_task(\n        #         task_id=task.task_id,\n        #         worker=self._id,\n        #         status=RUNNING,\n        #         tracking_url=tracking_url,\n        #     )\n\n        # def update_status_message(message):\n        #     self._scheduler.set_task_status_message(task.task_id, message)\n\n        return TaskProcess(\n            task, self._id, self._task_result_queue, self._update_tracking_url, self._update_status_message,\n            use_multiprocessing=bool(self.worker_processes > 1),\n            worker_timeout=self._config.timeout\n        )\n    ...\n```\n\n```py3:Lib/multiprocessing/reduction.py\n# \u5192\u982d\u306e\u30a4\u30f3\u30dd\u30fc\u30c8\u306e\u90e8\u5206\n# import pickle\nimport dill as pickle\n```\n\ndill\u306fpip\u3067\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3067\u304d\u307e\u3059\u3002\n\n## \u5225\u306e\u89e3\u6c7a\u7b56\n\u53e4\u3044\u30d0\u30fc\u30b8\u30e7\u30f3\u3092\u4f7f\u3044\u307e\u3059\u3002\u3053\u306e\u5834\u5408\u306f\u3001\u3042\u307e\u308a\u6539\u9020\u306f\u5fc5\u8981\u3042\u308a\u307e\u305b\u3093\u3002\n\n\u3053\u3061\u3089\u306f\u6a19\u6e96\u30e9\u30a4\u30d6\u30e9\u30ea\u306b\u306f\u624b\u3092\u52a0\u3048\u307e\u305b\u3093\u3002\n[windows\u3067luigi\u3092\u4e26\u5217\u51e6\u7406\u3055\u305b\u305f\u3089\u30a8\u30e9\u30fc\u306b\u306a\u3063\u305f\u3051\u3069\u3001\u305d\u306e\u89e3\u6c7a\u6cd5](http://qiita.com/soyiharu/items/050b278af2102a8618c1)\n[Pickle crashing when trying to pickle \"update_tracking_url\" in luigi.worker?](https://github.com/spotify/luigi/issues/1423)\n\n# \u6700\u5f8c\u306b\n\u79c1\u304c\u5b9f\u969b\u306b\u4f7f\u3063\u3066\u3044\u308b\u9650\u308a\u3067\u306f\u554f\u984c\u306f\u8d77\u304d\u3066\u3044\u307e\u305b\u3093\u304c\u3001\n\u6539\u9020\u306f\u81ea\u5df1\u8cac\u4efb\u3067\u304a\u9858\u3044\u3057\u307e\u3059\u3002\n\n", "tags": ["Python", "Luigi", "Windows"]}