{"context": "\n\nForensics 300\uff08\u76d7\u307e\u308c\u305f\u30c7\u30fc\u30bf\u306f\u3069\u308c\uff1f\uff09\n\n\u306f\u3058\u3081\u306b\n\u3053\u306e\u554f\u984c\u306f\u305f\u3057\u304b\u6b63\u89e3\u8005\u304c\uff11\u540d\u3057\u304b\u3044\u306a\u304b\u3063\u305f\u3068\u601d\u3046\u306e\u3067\u3059\u304c\u3001\u5fa9\u7fd2\u3092\u304b\u306d\u3066\u6f14\u7fd2\u5f8c\u306e\u89e3\u8aac\u3092\u601d\u3044\u3060\u3057\u306a\u304c\u3089\u89e3\u304d\u306a\u304a\u3057\u3066\u307f\u307e\u3057\u305f\u3002\n\u554f\u984c\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u3082\u306e\u3067\u3057\u305f\u3002\n\n\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u304b\u3089\u30c7\u30fc\u30bf\u304c\u7a83\u53d6\u3055\u308c\u3001\u5b9f\u884c\u72af\u306e\u6240\u6301\u3057\u3066\u3044\u305f\u30c7\u30a3\u30b9\u30af\u30a4\u30e1\u30fc\u30b8\u304c\u62bc\u53ce\u3055\u308c\u305f\u3002\u88ab\u5bb3\u306b\u906d\u3063\u305f\u30b5\u30fc\u30d0\u30fc\u3067\u53d6\u5f97\u3057\u3066\u3044\u305f\u30d1\u30b1\u30c3\u30c8\u30d5\u30a1\u30a4\u30eb\u3092\u3082\u3068\u306b\u3001\u7a83\u53d6\u3055\u308c\u305f\u30d5\u30a1\u30a4\u30eb\u3092\u7279\u5b9a\u3057\u3066 FLAG \u3092\u5165\u624b\u305b\u3088\u3002\n\u6dfb\u4ed8\u30d5\u30a1\u30a4\u30eb\uff1afor3.zip\n\n\u8981\u306f\u300cfor3.zip \u306e\u4e2d\u304b\u3089 FLAG \u3092\u63a2\u305b\u300d\u3068\u3044\u3046\u306e\u304c\u8ab2\u984c\u306e\u3088\u3046\u3067\u3059\u3002\n\n\u30d5\u30a1\u30a4\u30eb\u5185\u5bb9\u306e\u78ba\u8a8d\n\u307e\u305a unzip \u30b3\u30de\u30f3\u30c9\u3067 for3.zip \u3092\u89e3\u51cd\u3057\u305f\u3068\u3053\u308d\u3001\u4e8c\u3064\u306e\u30d5\u30a1\u30a4\u30eb\u304c\u51fa\u3066\u304d\u307e\u3057\u305f\u3002\n\nunzip\nctf4b@ctf4b-vm:~/2016-10-22/for3$ unzip for3.zip\nArchive:  for3.zip\n  inflating: for3.bin\n  inflating: for3.pcap\n\nctf4b@ctf4b-vm:~/2016-10-22/for3$ ls -l\n\u5408\u8a08 65612\n-rw-r--r-- 1 ctf4b ctf4b 67108864 10\u6708 21 14:50 for3.bin\n-rw-r--r-- 1 ctf4b ctf4b      494 10\u6708 21 14:50 for3.pcap\n-rw-r--r-- 1 ctf4b ctf4b    71533 10\u6708 22 17:07 for3.zip\n\n\n\u3069\u3046\u3084\u3089\u300c\u62bc\u53ce\u3055\u308c\u305f\u30c7\u30a3\u30b9\u30af\u30a4\u30e1\u30fc\u30b8\u300d\u304c for3.bin \u3067\u3001\u300c\u88ab\u5bb3\u306b\u906d\u3063\u305f\u30b5\u30fc\u30d0\u30fc\u3067\u53d6\u5f97\u3057\u3066\u3044\u305f\u30d1\u30b1\u30c3\u30c8\u30d5\u30a1\u30a4\u30eb\u300d\u304c for3.pcap \u306e\u3088\u3046\u3067\u3059\u3002\n\u5ff5\u306e\u305f\u3081 for3.bin \u304c\u30c7\u30a3\u30b9\u30af\u30a4\u30e1\u30fc\u30b8\u304b\u3069\u3046\u304b\u3082\u78ba\u8a8d\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n\nfile\nctf4b@ctf4b-vm:~/2016-10-22/for3$ file for3.bin\nfor3.bin: DOS/MBR boot sector; partition 1 : ID=0x83, start-CHS (0x0,32,33), end-CHS (0x8,40,32), startsector 2048, 129024 sectors, extended partition table (last)\n\n\nfor3.bin \u306e\u4e2d\u8eab\u3092\u8868\u793a\u3057\u3066\u307f\u308b\u3068\u3001 SQLite 3 \u5f62\u5f0f\u306e\u30c7\u30fc\u30bf\u30d5\u30a1\u30a4\u30eb\u304c\u5168\u90e8\u3067 10 \u30d5\u30a1\u30a4\u30eb\u3042\u308a\u307e\u3057\u305f\u3002\n\nbinwalk\nctf4b@ctf4b-vm:~/2016-10-22/for3$ binwalk for3.bin\n\nDECIMAL       HEXADECIMAL     DESCRIPTION\n--------------------------------------------------------------------------------\n1048576       0x100000        Linux EXT filesystem, rev 1.0, ext2 filesystem data, UUID=1e560c56-9ced-44e1-a5b0-e1ef43864386\n9437184       0x900000        Linux EXT filesystem, rev 1.0, ext2 filesystem data (mounted or unclean), UUID=1e560c56-9ced-44e1-a5b0-e1ef43864386\n9962496       0x980400        SQLite 3.x database,\n9970688       0x982400        SQLite 3.x database,\n9978880       0x984400        SQLite 3.x database,\n9987072       0x986400        SQLite 3.x database,\n9995264       0x988400        SQLite 3.x database,\n10003456      0x98A400        SQLite 3.x database,\n10011648      0x98C400        SQLite 3.x database,\n10019840      0x98E400        SQLite 3.x database,\n10028032      0x990400        SQLite 3.x database,\n10036224      0x992400        SQLite 3.x database,\n26214400      0x1900000       Linux EXT filesystem, rev 1.0, ext2 filesystem data (mounted or unclean), UUID=1e560c56-9ced-44e1-a5b0-e1ef43864386\n42991616      0x2900000       Linux EXT filesystem, rev 1.0, ext2 filesystem data (mounted or unclean), UUID=1e560c56-9ced-44e1-a5b0-e1ef43864386\n59768832      0x3900000       Linux EXT filesystem, rev 1.0, ext2 filesystem data (mounted or unclean), UUID=1e560c56-9ced-44e1-a5b0-e1ef43864386\n\n\n\n\u30c7\u30fc\u30bf\u30d5\u30a1\u30a4\u30eb\u306e\u62bd\u51fa\n\u7d9a\u3044\u3066\u3001\u30c7\u30a3\u30b9\u30af\u30a4\u30e1\u30fc\u30b8\u306b\u542b\u307e\u308c\u308b\u30d5\u30a1\u30a4\u30eb\u3092\u62bd\u51fa\u3057\u3066\u307f\u307e\u3059\u3002\u305d\u306e\u969b\u3001\u5148\u307b\u3069\u306e file \u30b3\u30de\u30f3\u30c9\u306e\u5b9f\u884c\u7d50\u679c\u3092\u3082\u3068\u306b\u3001 fls \u30b3\u30de\u30f3\u30c9\u306e -o \u30aa\u30d7\u30b7\u30e7\u30f3\u306b\u30d5\u30a1\u30a4\u30eb\u30b7\u30b9\u30c6\u30e0\u306e\u958b\u59cb\u4f4d\u7f6e\uff08startsector 2048\uff09\u3092\u6307\u5b9a\u3057\u307e\u3057\u305f\u3002\n\nfls\nctf4b@ctf4b-vm:~/2016-10-22/for3$ fls -o 2048 -r for3.bin\nd/d 11: lost+found\nd/d 2017:       ...\n+ r/r 2018:     database_1.db\n+ r/r 2019:     database_5.db\n+ r/r 2020:     database_3.db\n+ r/r 2021:     database_8.db\n+ r/r 2022:     database_10.db\n+ r/r 2023:     database_9.db\n+ r/r 2024:     database_4.db\n+ r/r 2025:     database_7.db\n+ r/r 2026:     database_2.db\n+ r/r 2027:     database_6.db\nd/d 16129:      $OrphanFiles\n\n\n\u5b9f\u884c\u7d50\u679c\u304b\u3089 lost+found \u30c7\u30a3\u30ec\u30af\u30c8\u30ea\uff08fsck \u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3057\u305f\u969b\u3001\u7834\u640d\u3057\u305f\u30d5\u30a1\u30a4\u30eb\u306e\u65ad\u7247\u304c\u683c\u7d0d\u3055\u308c\u308b\u5834\u6240\uff09\u306e\u4e2d\u306b\u8907\u6570\u306e\u30c7\u30fc\u30bf\u30d5\u30a1\u30a4\u30eb\u304c\u3042\u308a\u3001\u305d\u308c\u3089\u306e\u30d5\u30a1\u30a4\u30eb\u540d\u3068 i-node \u756a\u53f7\u304c\u308f\u304b\u308a\u307e\u3057\u305f\u3002\n\u5148\u307b\u3069\u306e\u30d5\u30a1\u30a4\u30eb\u30b7\u30b9\u30c6\u30e0\u306e\u958b\u59cb\u4f4d\u7f6e\u3068 i-node \u756a\u53f7\u3092\u6307\u5b9a\u3057\u3001\u30c7\u30fc\u30bf\u30d5\u30a1\u30a4\u30eb\u3092\u62bd\u51fa\u3057\u307e\u3059\u3002\n\nicat\nctf4b@ctf4b-vm:~/2016-10-22/for3$ icat -o 2048 -r for3.bin 2018 > database_1.db\nctf4b@ctf4b-vm:~/2016-10-22/for3$ icat -o 2048 -r for3.bin 2019 > database_5.db\nctf4b@ctf4b-vm:~/2016-10-22/for3$ icat -o 2048 -r for3.bin 2020 > database_3.db\n... \u7701\u7565 ...\nctf4b@ctf4b-vm:~/2016-10-22/for3$ icat -o 2048 -r for3.bin 2025 > database_7.db\nctf4b@ctf4b-vm:~/2016-10-22/for3$ icat -o 2048 -r for3.bin 2026 > database_2.db\nctf4b@ctf4b-vm:~/2016-10-22/for3$ icat -o 2048 -r for3.bin 2027 > database_6.db\n\n\n\u5ff5\u306e\u305f\u3081 database_*.db \u304c\u30c7\u30fc\u30bf\u30d5\u30a1\u30a4\u30eb\u304b\u3069\u3046\u304b\u3092\u78ba\u8a8d\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n\nfile\nctf4b@ctf4b-vm:~/2016-10-22/for3$ file database_*.db\ndatabase_1.db:  SQLite 3.x database\n... \u7701\u7565 ...\ndatabase_6.db:  SQLite 3.x database\n\n\n\n\u30c7\u30fc\u30bf\u30d5\u30a1\u30a4\u30eb\u306e\u8abf\u67fb\n\u62bd\u51fa\u3057\u305f\u30c7\u30fc\u30bf\u30d5\u30a1\u30a4\u30eb\u3092\u4f7f\u7528\u3057\u3066\u30b9\u30ad\u30fc\u30de\u3092\u8868\u793a\u3057\u3001\u3069\u306e\u3088\u3046\u306a\u8868\u540d\u3084\u5217\u540d\u304c\u3042\u308b\u304b\u78ba\u8a8d\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n\nsqlite3\nctf4b@ctf4b-vm:~/2016-10-22/for3$ for f in ./database_*.db; do sqlite3 $f '.schema'; done\nCREATE TABLE flag(id integer primary key, flag varchar(50));\n... \u7701\u7565 ...\nCREATE TABLE flag(id integer primary key, flag varchar(50));\n\n\n\u3069\u306e\u30c7\u30fc\u30bf\u30d5\u30a1\u30a4\u30eb\u3082 flag \u8868\u3057\u304b\u683c\u7d0d\u3057\u3066\u304a\u3089\u305a\u3001 flag \u8868\u306b\u306f flag \u5217\u3057\u304b\u4f5c\u6210\u3055\u308c\u3066\u3044\u306a\u3044\u3088\u3046\u3067\u3059\u3002\nflag \u8868\u306e flag \u5217\u306b\u306f\u540c\u4e00\u306e\u5024\u304c\u8907\u6570\u683c\u7d0d\u3055\u308c\u3066\u3044\u308b\u305f\u3081\u3001\u91cd\u8907\u3092\u9664\u5916\u3057\u306a\u304c\u3089 Base64 \u5f62\u5f0f\u3067\u7b26\u53f7\u5316\u3055\u308c\u305f\u6587\u5b57\u5217\u3092\u30c7\u30b3\u30fc\u30c9\u3057\u3066\u3044\u304d\u307e\u3059\u3002\n\nbase64\nctf4b@ctf4b-vm:~/2016-10-22/for3$ for f in ./database_*.db; do sqlite3 $f 'select flag from flag;'; done | sort | uniq | base64 -d\nctf4b{DUMMY}\nctf4b{dummy}\nctf4b{dummydummydummy}\nctf4b{dummydummy}\nctf4b{flag_janai_YO}\nctf4b{kore_ha_dummy}\nctf4b{kore_ha_flag_janai}\nctf4b{m4c71m3l1n3}ctf4b{}\n\n\n\u6700\u7d42\u884c\u306e\u307f\u82e5\u5e72\u8868\u793a\u304c\u304a\u304b\u3057\u304f\u306a\u3063\u3066\u3044\u307e\u3059\u304c\u3001\u3053\u306e\u300cctf4b{m4c71m3l1n3}\u300d\u306e\u90e8\u5206\u304c FLAG \u306b\u76f8\u5f53\u3057\u307e\u3059\u3002\n\n\u304a\u308f\u308a\u306b\n\u4eca\u56de\u3001\u30d1\u30b1\u30c3\u30c8\u30d5\u30a1\u30a4\u30eb\uff08for3.pcap\uff09\u306f\u4f7f\u7528\u3057\u307e\u305b\u3093\u3067\u3057\u305f\u304c\u3001\u89e3\u8aac\u3057\u3066\u3044\u305f\u3060\u3044\u305f\u65b9\u306b\u3088\u308c\u3070\u3001\u672c\u6765\u306f Wireshark \u306a\u3069\u3067 Pcap \u5f62\u5f0f\u306e\u30d5\u30a1\u30a4\u30eb\u3092\u8868\u793a\u3057\u3001\u30c7\u30fc\u30bf\u3092\u7a83\u53d6\u3057\u305f\u3068\u601d\u308f\u308c\u308b\u6642\u9593\u5e2f\u3092\u7d5e\u308a\u3053\u3093\u3067 mactime \u30b3\u30de\u30f3\u30c9\u3067\u751f\u6210\u3057\u305f\u30bf\u30a4\u30e0\u30e9\u30a4\u30f3\u3068\u6bd4\u8f03\u3057\u3066\u3044\u304f\u5fc5\u8981\u304c\u3042\u308b\u306e\u3060\u305d\u3046\u3067\u3059\u3002\nFLAG \u306b\u542b\u307e\u308c\u308b\u300cm4c71m3l1n3\u300d\u3068\u3044\u3046\u6587\u5b57\u5217\u306f\u300cmactimeline\u300d\u3092 Leet \u3067\u8868\u8a18\u3057\u305f\u3082\u306e\u3067\u3059\u304c\u3001\u554f\u984c\u3092\u4f5c\u6210\u3057\u305f\u65b9\u306e\u305d\u3046\u3057\u305f\u610f\u56f3\u304c\u8fbc\u3081\u3089\u308c\u3066\u3044\u308b\u3088\u3046\u306b\u611f\u3058\u307e\u3057\u305f\u3002\n# Forensics 300\uff08\u76d7\u307e\u308c\u305f\u30c7\u30fc\u30bf\u306f\u3069\u308c\uff1f\uff09\n\n## \u306f\u3058\u3081\u306b\n\u3053\u306e\u554f\u984c\u306f\u305f\u3057\u304b\u6b63\u89e3\u8005\u304c\uff11\u540d\u3057\u304b\u3044\u306a\u304b\u3063\u305f\u3068\u601d\u3046\u306e\u3067\u3059\u304c\u3001\u5fa9\u7fd2\u3092\u304b\u306d\u3066\u6f14\u7fd2\u5f8c\u306e\u89e3\u8aac\u3092\u601d\u3044\u3060\u3057\u306a\u304c\u3089\u89e3\u304d\u306a\u304a\u3057\u3066\u307f\u307e\u3057\u305f\u3002\n\n\u554f\u984c\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u3082\u306e\u3067\u3057\u305f\u3002\n\n> \u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u304b\u3089\u30c7\u30fc\u30bf\u304c\u7a83\u53d6\u3055\u308c\u3001\u5b9f\u884c\u72af\u306e\u6240\u6301\u3057\u3066\u3044\u305f\u30c7\u30a3\u30b9\u30af\u30a4\u30e1\u30fc\u30b8\u304c\u62bc\u53ce\u3055\u308c\u305f\u3002\u88ab\u5bb3\u306b\u906d\u3063\u305f\u30b5\u30fc\u30d0\u30fc\u3067\u53d6\u5f97\u3057\u3066\u3044\u305f\u30d1\u30b1\u30c3\u30c8\u30d5\u30a1\u30a4\u30eb\u3092\u3082\u3068\u306b\u3001\u7a83\u53d6\u3055\u308c\u305f\u30d5\u30a1\u30a4\u30eb\u3092\u7279\u5b9a\u3057\u3066 FLAG \u3092\u5165\u624b\u305b\u3088\u3002\n> \n> \u6dfb\u4ed8\u30d5\u30a1\u30a4\u30eb\uff1afor3.zip\n\n\u8981\u306f\u300c<font color=\"#f00\">for3.zip \u306e\u4e2d\u304b\u3089 FLAG \u3092\u63a2\u305b</font>\u300d\u3068\u3044\u3046\u306e\u304c\u8ab2\u984c\u306e\u3088\u3046\u3067\u3059\u3002\n\n## \u30d5\u30a1\u30a4\u30eb\u5185\u5bb9\u306e\u78ba\u8a8d\n\u307e\u305a `unzip` \u30b3\u30de\u30f3\u30c9\u3067 for3.zip \u3092\u89e3\u51cd\u3057\u305f\u3068\u3053\u308d\u3001\u4e8c\u3064\u306e\u30d5\u30a1\u30a4\u30eb\u304c\u51fa\u3066\u304d\u307e\u3057\u305f\u3002\n\n```bash:unzip\nctf4b@ctf4b-vm:~/2016-10-22/for3$ unzip for3.zip\nArchive:  for3.zip\n  inflating: for3.bin\n  inflating: for3.pcap\n\nctf4b@ctf4b-vm:~/2016-10-22/for3$ ls -l\n\u5408\u8a08 65612\n-rw-r--r-- 1 ctf4b ctf4b 67108864 10\u6708 21 14:50 for3.bin\n-rw-r--r-- 1 ctf4b ctf4b      494 10\u6708 21 14:50 for3.pcap\n-rw-r--r-- 1 ctf4b ctf4b    71533 10\u6708 22 17:07 for3.zip\n```\n\n\u3069\u3046\u3084\u3089\u300c\u62bc\u53ce\u3055\u308c\u305f\u30c7\u30a3\u30b9\u30af\u30a4\u30e1\u30fc\u30b8\u300d\u304c for3.bin \u3067\u3001\u300c\u88ab\u5bb3\u306b\u906d\u3063\u305f\u30b5\u30fc\u30d0\u30fc\u3067\u53d6\u5f97\u3057\u3066\u3044\u305f\u30d1\u30b1\u30c3\u30c8\u30d5\u30a1\u30a4\u30eb\u300d\u304c for3.pcap \u306e\u3088\u3046\u3067\u3059\u3002\n\n\u5ff5\u306e\u305f\u3081 for3.bin \u304c\u30c7\u30a3\u30b9\u30af\u30a4\u30e1\u30fc\u30b8\u304b\u3069\u3046\u304b\u3082\u78ba\u8a8d\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n\n```bash:file\nctf4b@ctf4b-vm:~/2016-10-22/for3$ file for3.bin\nfor3.bin: DOS/MBR boot sector; partition 1 : ID=0x83, start-CHS (0x0,32,33), end-CHS (0x8,40,32), startsector 2048, 129024 sectors, extended partition table (last)\n```\n\nfor3.bin \u306e\u4e2d\u8eab\u3092\u8868\u793a\u3057\u3066\u307f\u308b\u3068\u3001 SQLite 3 \u5f62\u5f0f\u306e\u30c7\u30fc\u30bf\u30d5\u30a1\u30a4\u30eb\u304c\u5168\u90e8\u3067 10 \u30d5\u30a1\u30a4\u30eb\u3042\u308a\u307e\u3057\u305f\u3002\n\n```bash:binwalk\nctf4b@ctf4b-vm:~/2016-10-22/for3$ binwalk for3.bin\n\nDECIMAL       HEXADECIMAL     DESCRIPTION\n--------------------------------------------------------------------------------\n1048576       0x100000        Linux EXT filesystem, rev 1.0, ext2 filesystem data, UUID=1e560c56-9ced-44e1-a5b0-e1ef43864386\n9437184       0x900000        Linux EXT filesystem, rev 1.0, ext2 filesystem data (mounted or unclean), UUID=1e560c56-9ced-44e1-a5b0-e1ef43864386\n9962496       0x980400        SQLite 3.x database,\n9970688       0x982400        SQLite 3.x database,\n9978880       0x984400        SQLite 3.x database,\n9987072       0x986400        SQLite 3.x database,\n9995264       0x988400        SQLite 3.x database,\n10003456      0x98A400        SQLite 3.x database,\n10011648      0x98C400        SQLite 3.x database,\n10019840      0x98E400        SQLite 3.x database,\n10028032      0x990400        SQLite 3.x database,\n10036224      0x992400        SQLite 3.x database,\n26214400      0x1900000       Linux EXT filesystem, rev 1.0, ext2 filesystem data (mounted or unclean), UUID=1e560c56-9ced-44e1-a5b0-e1ef43864386\n42991616      0x2900000       Linux EXT filesystem, rev 1.0, ext2 filesystem data (mounted or unclean), UUID=1e560c56-9ced-44e1-a5b0-e1ef43864386\n59768832      0x3900000       Linux EXT filesystem, rev 1.0, ext2 filesystem data (mounted or unclean), UUID=1e560c56-9ced-44e1-a5b0-e1ef43864386\n```\n\n## \u30c7\u30fc\u30bf\u30d5\u30a1\u30a4\u30eb\u306e\u62bd\u51fa\n\u7d9a\u3044\u3066\u3001\u30c7\u30a3\u30b9\u30af\u30a4\u30e1\u30fc\u30b8\u306b\u542b\u307e\u308c\u308b\u30d5\u30a1\u30a4\u30eb\u3092\u62bd\u51fa\u3057\u3066\u307f\u307e\u3059\u3002\u305d\u306e\u969b\u3001\u5148\u307b\u3069\u306e `file` \u30b3\u30de\u30f3\u30c9\u306e\u5b9f\u884c\u7d50\u679c\u3092\u3082\u3068\u306b\u3001 `fls` \u30b3\u30de\u30f3\u30c9\u306e `-o` \u30aa\u30d7\u30b7\u30e7\u30f3\u306b\u30d5\u30a1\u30a4\u30eb\u30b7\u30b9\u30c6\u30e0\u306e\u958b\u59cb\u4f4d\u7f6e\uff08startsector <font color=\"#f00\">2048</font>\uff09\u3092\u6307\u5b9a\u3057\u307e\u3057\u305f\u3002\n\n```bash:fls\nctf4b@ctf4b-vm:~/2016-10-22/for3$ fls -o 2048 -r for3.bin\nd/d 11: lost+found\nd/d 2017:       ...\n+ r/r 2018:     database_1.db\n+ r/r 2019:     database_5.db\n+ r/r 2020:     database_3.db\n+ r/r 2021:     database_8.db\n+ r/r 2022:     database_10.db\n+ r/r 2023:     database_9.db\n+ r/r 2024:     database_4.db\n+ r/r 2025:     database_7.db\n+ r/r 2026:     database_2.db\n+ r/r 2027:     database_6.db\nd/d 16129:      $OrphanFiles\n```\n\n\u5b9f\u884c\u7d50\u679c\u304b\u3089 lost+found \u30c7\u30a3\u30ec\u30af\u30c8\u30ea\uff08`fsck` \u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3057\u305f\u969b\u3001\u7834\u640d\u3057\u305f\u30d5\u30a1\u30a4\u30eb\u306e\u65ad\u7247\u304c\u683c\u7d0d\u3055\u308c\u308b\u5834\u6240\uff09\u306e\u4e2d\u306b\u8907\u6570\u306e\u30c7\u30fc\u30bf\u30d5\u30a1\u30a4\u30eb\u304c\u3042\u308a\u3001\u305d\u308c\u3089\u306e\u30d5\u30a1\u30a4\u30eb\u540d\u3068 i-node \u756a\u53f7\u304c\u308f\u304b\u308a\u307e\u3057\u305f\u3002\n\n\u5148\u307b\u3069\u306e\u30d5\u30a1\u30a4\u30eb\u30b7\u30b9\u30c6\u30e0\u306e\u958b\u59cb\u4f4d\u7f6e\u3068 i-node \u756a\u53f7\u3092\u6307\u5b9a\u3057\u3001\u30c7\u30fc\u30bf\u30d5\u30a1\u30a4\u30eb\u3092\u62bd\u51fa\u3057\u307e\u3059\u3002\n\n```bash:icat\nctf4b@ctf4b-vm:~/2016-10-22/for3$ icat -o 2048 -r for3.bin 2018 > database_1.db\nctf4b@ctf4b-vm:~/2016-10-22/for3$ icat -o 2048 -r for3.bin 2019 > database_5.db\nctf4b@ctf4b-vm:~/2016-10-22/for3$ icat -o 2048 -r for3.bin 2020 > database_3.db\n... \u7701\u7565 ...\nctf4b@ctf4b-vm:~/2016-10-22/for3$ icat -o 2048 -r for3.bin 2025 > database_7.db\nctf4b@ctf4b-vm:~/2016-10-22/for3$ icat -o 2048 -r for3.bin 2026 > database_2.db\nctf4b@ctf4b-vm:~/2016-10-22/for3$ icat -o 2048 -r for3.bin 2027 > database_6.db\n```\n\n\u5ff5\u306e\u305f\u3081 database_*.db \u304c\u30c7\u30fc\u30bf\u30d5\u30a1\u30a4\u30eb\u304b\u3069\u3046\u304b\u3092\u78ba\u8a8d\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n\n```bash:file\nctf4b@ctf4b-vm:~/2016-10-22/for3$ file database_*.db\ndatabase_1.db:  SQLite 3.x database\n... \u7701\u7565 ...\ndatabase_6.db:  SQLite 3.x database\n```\n\n## \u30c7\u30fc\u30bf\u30d5\u30a1\u30a4\u30eb\u306e\u8abf\u67fb\n\u62bd\u51fa\u3057\u305f\u30c7\u30fc\u30bf\u30d5\u30a1\u30a4\u30eb\u3092\u4f7f\u7528\u3057\u3066\u30b9\u30ad\u30fc\u30de\u3092\u8868\u793a\u3057\u3001\u3069\u306e\u3088\u3046\u306a\u8868\u540d\u3084\u5217\u540d\u304c\u3042\u308b\u304b\u78ba\u8a8d\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n\n```bash:sqlite3\nctf4b@ctf4b-vm:~/2016-10-22/for3$ for f in ./database_*.db; do sqlite3 $f '.schema'; done\nCREATE TABLE flag(id integer primary key, flag varchar(50));\n... \u7701\u7565 ...\nCREATE TABLE flag(id integer primary key, flag varchar(50));\n```\n\n\u3069\u306e\u30c7\u30fc\u30bf\u30d5\u30a1\u30a4\u30eb\u3082 flag \u8868\u3057\u304b\u683c\u7d0d\u3057\u3066\u304a\u3089\u305a\u3001 flag \u8868\u306b\u306f flag \u5217\u3057\u304b\u4f5c\u6210\u3055\u308c\u3066\u3044\u306a\u3044\u3088\u3046\u3067\u3059\u3002\n\nflag \u8868\u306e flag \u5217\u306b\u306f\u540c\u4e00\u306e\u5024\u304c\u8907\u6570\u683c\u7d0d\u3055\u308c\u3066\u3044\u308b\u305f\u3081\u3001\u91cd\u8907\u3092\u9664\u5916\u3057\u306a\u304c\u3089 Base64 \u5f62\u5f0f\u3067\u7b26\u53f7\u5316\u3055\u308c\u305f\u6587\u5b57\u5217\u3092\u30c7\u30b3\u30fc\u30c9\u3057\u3066\u3044\u304d\u307e\u3059\u3002\n\n```bash:base64\nctf4b@ctf4b-vm:~/2016-10-22/for3$ for f in ./database_*.db; do sqlite3 $f 'select flag from flag;'; done | sort | uniq | base64 -d\nctf4b{DUMMY}\nctf4b{dummy}\nctf4b{dummydummydummy}\nctf4b{dummydummy}\nctf4b{flag_janai_YO}\nctf4b{kore_ha_dummy}\nctf4b{kore_ha_flag_janai}\nctf4b{m4c71m3l1n3}ctf4b{}\n```\n\n\u6700\u7d42\u884c\u306e\u307f\u82e5\u5e72\u8868\u793a\u304c\u304a\u304b\u3057\u304f\u306a\u3063\u3066\u3044\u307e\u3059\u304c\u3001\u3053\u306e\u300c<font color=\"#f00\">ctf4b{m4c71m3l1n3}</font>\u300d\u306e\u90e8\u5206\u304c FLAG \u306b\u76f8\u5f53\u3057\u307e\u3059\u3002\n\n## \u304a\u308f\u308a\u306b\n\u4eca\u56de\u3001\u30d1\u30b1\u30c3\u30c8\u30d5\u30a1\u30a4\u30eb\uff08for3.pcap\uff09\u306f\u4f7f\u7528\u3057\u307e\u305b\u3093\u3067\u3057\u305f\u304c\u3001\u89e3\u8aac\u3057\u3066\u3044\u305f\u3060\u3044\u305f\u65b9\u306b\u3088\u308c\u3070\u3001\u672c\u6765\u306f Wireshark \u306a\u3069\u3067 Pcap \u5f62\u5f0f\u306e\u30d5\u30a1\u30a4\u30eb\u3092\u8868\u793a\u3057\u3001\u30c7\u30fc\u30bf\u3092\u7a83\u53d6\u3057\u305f\u3068\u601d\u308f\u308c\u308b\u6642\u9593\u5e2f\u3092\u7d5e\u308a\u3053\u3093\u3067 `mactime` \u30b3\u30de\u30f3\u30c9\u3067\u751f\u6210\u3057\u305f\u30bf\u30a4\u30e0\u30e9\u30a4\u30f3\u3068\u6bd4\u8f03\u3057\u3066\u3044\u304f\u5fc5\u8981\u304c\u3042\u308b\u306e\u3060\u305d\u3046\u3067\u3059\u3002\n\nFLAG \u306b\u542b\u307e\u308c\u308b\u300cm4c71m3l1n3\u300d\u3068\u3044\u3046\u6587\u5b57\u5217\u306f\u300cmactimeline\u300d\u3092 Leet \u3067\u8868\u8a18\u3057\u305f\u3082\u306e\u3067\u3059\u304c\u3001\u554f\u984c\u3092\u4f5c\u6210\u3057\u305f\u65b9\u306e\u305d\u3046\u3057\u305f\u610f\u56f3\u304c\u8fbc\u3081\u3089\u308c\u3066\u3044\u308b\u3088\u3046\u306b\u611f\u3058\u307e\u3057\u305f\u3002\n", "tags": ["\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3"]}