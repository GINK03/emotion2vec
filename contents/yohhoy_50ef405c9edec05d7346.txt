{"tags": ["ffmpeg3.0", "C"], "context": "FFmpeg/libavformat\u3067\u30aa\u30f3\u30e1\u30e2\u30ea\u30fb\u30c7\u30fc\u30bf\u66f8\u304d\u51fa\u3057\u3092\u884c\u3044\u305f\u3044\u5834\u5408\u3001\u51fa\u529b\u5c02\u7528\u306e\u30e1\u30e2\u30ea\u30b9\u30c8\u30ea\u30fc\u30e0(memory stream) API\u3092\u5229\u7528\u3059\u308b\u3002\n\navio_open_dyn_buf\navio_close_dyn_buf\n\nAVFormatContext* fmtctx;\n// avformat_alloc_output_context2\u7b49\u3067\u30b3\u30f3\u30c6\u30ad\u30b9\u30c8\u521d\u671f\u5316\n// avformat_new_stream\u3067\u30b3\u30f3\u30c6\u30ad\u30b9\u30c8\u306b\u30b9\u30c8\u30ea\u30fc\u30e0\u8ffd\u52a0\n\nAVPacket packet;\n// avcodec_encode_video2\u307e\u305f\u306f_audio2\u3067packet\u751f\u6210\n\navio_open_dyn_buf(&fmtctx->pb);\nav_write_frame(fmtctx, &packet);\nuint8_t *data = NULL;\nint size = avio_close_dyn_buf(fmtctx->pb, &data);\n// \u30c7\u30fc\u30bf\u3092data, size\u3068\u3057\u3066\u53d6\u5f97\nav_free(data);\n\nFFmpeg/libavformat\u3067\u30aa\u30f3\u30e1\u30e2\u30ea\u30fb\u30c7\u30fc\u30bf\u66f8\u304d\u51fa\u3057\u3092\u884c\u3044\u305f\u3044\u5834\u5408\u3001\u51fa\u529b\u5c02\u7528\u306e\u30e1\u30e2\u30ea\u30b9\u30c8\u30ea\u30fc\u30e0(memory stream) API\u3092\u5229\u7528\u3059\u308b\u3002\n\n- [`avio_open_dyn_buf`](https://ffmpeg.org/doxygen/3.0/avio_8h.html#adb5259ad07633518173eaa47fe6575e2)\n- [`avio_close_dyn_buf`](https://ffmpeg.org/doxygen/3.0/avio_8h.html#a8faed62ce72e7411cbea2356494af8ce)\n\n\n```c\nAVFormatContext* fmtctx;\n// avformat_alloc_output_context2\u7b49\u3067\u30b3\u30f3\u30c6\u30ad\u30b9\u30c8\u521d\u671f\u5316\n// avformat_new_stream\u3067\u30b3\u30f3\u30c6\u30ad\u30b9\u30c8\u306b\u30b9\u30c8\u30ea\u30fc\u30e0\u8ffd\u52a0\n\nAVPacket packet;\n// avcodec_encode_video2\u307e\u305f\u306f_audio2\u3067packet\u751f\u6210\n\navio_open_dyn_buf(&fmtctx->pb);\nav_write_frame(fmtctx, &packet);\nuint8_t *data = NULL;\nint size = avio_close_dyn_buf(fmtctx->pb, &data);\n// \u30c7\u30fc\u30bf\u3092data, size\u3068\u3057\u3066\u53d6\u5f97\nav_free(data);\n```\n"}