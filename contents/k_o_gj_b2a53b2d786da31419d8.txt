{"context": " More than 1 year has passed since last update.\n\n\u76ee\u7684\n\u3068\u308a\u3042\u3048\u305a\u5927\u91cf\u306e\u30c7\u30fc\u30bf\u3092\u7a81\u3063\u8fbc\u3080\u3001\u30c7\u30fc\u30bf\u306e\u8cea\u306f\u554f\u308f\u306a\u3044\nMariaDB,MySQL,PostgreSQL\u95a2\u4fc2\u306a\u304f\u4f7f\u3048\u308b\u3088\n\u74b0\u5883\nOS:Ubuntu14.04\nDB:MariaDB 10.0.11\nthinkpad T440p\n\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u30c6\u30fc\u30d6\u30eb\u306b\u9069\u5f53\u306a\u30c7\u30fc\u30bf\u3092\u5927\u91cf\u306b\u5165\u308c\u3066\u307f\u308b\n\ncreate.sql\nSET CHARSET utf8;\nUSE my_test;\nCREATE TABLE test_table2(\n col1  INT   NOT NULL   DEFAULT 0,\n col2  INT   NOT NULL   DEFAULT 0,\n col3  INT   NOT NULL   DEFAULT 0,\n create_time DATETIME   NOT NULL,\n update_time DATETIME   NOT NULL,\n delete_time DATETIME   DEFAULT NULL,\nPRIMARY KEY (col1,col2,col3)\n)ENGINE=InnoDB DEFAULT CHARSET=utf8;\n\n\n\n\u30af\u30a8\u30ea\u3092\u751f\u6210\u3059\u308b\n\u30b8\u30a7\u30cd\u30ec\u30fc\u30bf\u30c4\u30fc\u30eb\u306e\u3088\u3046\u306a\u4f55\u304b\u306f\u4f7f\u7528\u305b\u305a\u306b\u7c21\u5358\u306b\u30b7\u30a7\u30eb\u30b9\u30af\u30ea\u30d7\u30c8\u3067\u30af\u30a8\u30ea\u3092\u4f5c\u308b\n\ngen_random_rows.sh\n#!/bin/sh\n\necho \"INSERT IGNORE INTO test_table2 (col1,col2,col3,create_time,update_time) VALUES\" > insert.sql\nfor i in `seq 1 1000`\ndo\n    echo \"(FLOOR(RAND()*3000000),FLOOR(RAND()*1000000)%15,FLOOR(RAND()*1000000)%3,NOW(),NOW()),\" >> insert.sql\n    echo \"(FLOOR(RAND()*3000000),FLOOR(RAND()*1000000)%15,FLOOR(RAND()*1000000)%3,NOW(),NOW()),\" >> insert.sql\n    echo \"(FLOOR(RAND()*3000000),FLOOR(RAND()*1000000)%15,FLOOR(RAND()*1000000)%3,NOW(),NOW()),\" >> insert.sql\n    echo \"(FLOOR(RAND()*3000000),FLOOR(RAND()*1000000)%15,FLOOR(RAND()*1000000)%3,NOW(),NOW()),\" >> insert.sql\n    echo \"(FLOOR(RAND()*3000000),FLOOR(RAND()*1000000)%15,FLOOR(RAND()*1000000)%3,NOW(),NOW()),\" >> insert.sql\ndone\necho \"(FLOOR(RAND()*3000000),FLOOR(RAND()*1000000)%15,FLOOR(RAND()*1000000)%3,NOW(),NOW());\" >> insert.sql\n\n\nFLOOR\u3068RAND\u3092\u4f7f\u3063\u3066col1\u306f300\u4e07\u4ee5\u4e0b\u3001col2\u306f15\u4ee5\u4e0b\u3001col3\u306f3\u4ee5\u4e0b\u306e\u6574\u6570\u3092\u5165\u308c\u308b\u3088\u3046\u306abulk insert\u30af\u30a8\u30ea\u3092\u4f5c\u6210\n\u3053\u308c\u30675000\u884c\u3092\u633f\u5165\u3059\u308b\u30af\u30a8\u30ea\u304c\u4f5c\u6210\u5b8c\u4e86\nIGNORE\u3092\u4f7f\u7528\u3057\u3066\u3044\u308b\u306e\u3067\u3001\u30d7\u30e9\u30a4\u30de\u30ea\u30ad\u30fc\u306e\u30c7\u30fc\u30bf\u304c\u88ab\u3063\u305f\u5834\u5408\u306f\u7121\u8996\u3055\u308c\u308b\n\u3053\u308c\u3092\u7e70\u308a\u8fd4\u3057\u3066\u9069\u5f53\u306a\u56de\u6570\u633f\u5165\u3059\u308b\n\ninsert_random_rows.sh\n#!/bin/sh\n\nset -e\n\nmariadb='/PATH/mariadb/bin/mysql'\n\nfor i in `seq 1 2000`\ndo\n    $mariadb -u* -p*** -Dmy_test < insert.sql\ndone\n\n\n\nInsert\n$ time bash insert_random_rows.sh\nreal    3m40.434s\nuser    0m15.065s\nsys 0m3.685s\nMariaDB [my_test]> select table_schema, table_name, table_rows from information_schema.tables where table_schema='my_test' AND table_name='test_table2';\n+--------------+-------------+------------+\n| table_schema | table_name  | table_rows |\n+--------------+-------------+------------+\n| my_test      | test_table2 |    9273104 |\n+--------------+-------------+------------+\n1 row in set (0.00 sec)\n4\u5206\u304b\u304b\u3089\u305a\u306b1000\u4e07\u884c\u8fd1\u304f\u306e\u30c7\u30fc\u30bf\u3092\u633f\u5165\u3067\u304d\u305f\n\n\u305d\u306e\u4ed6\n\u6642\u523b\u306e\u3068\u3053\u308d\u3082\u30e9\u30f3\u30c0\u30e0\u3063\u307d\u304f\u3057\u305f\u3044\u306a\u3089NOW()\u306e\u3068\u3053\u308d\u3092INTERVAL\u95a2\u6570\u3092\u4f7f\u3063\u3066\nNOW() - INTERVAL FLOOR(RAND()*10000) HOUR\n\u3068\u304b\u66f8\u304f\u3068\u9069\u5f53\u3063\u307d\u3044\u6642\u523b\u306b\u306a\u308b\n#\u76ee\u7684\n\u3068\u308a\u3042\u3048\u305a\u5927\u91cf\u306e\u30c7\u30fc\u30bf\u3092\u7a81\u3063\u8fbc\u3080\u3001\u30c7\u30fc\u30bf\u306e\u8cea\u306f\u554f\u308f\u306a\u3044\nMariaDB,MySQL,PostgreSQL\u95a2\u4fc2\u306a\u304f\u4f7f\u3048\u308b\u3088\n\n\u74b0\u5883\nOS:Ubuntu14.04\nDB:MariaDB 10.0.11\nthinkpad T440p\n\n\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u30c6\u30fc\u30d6\u30eb\u306b\u9069\u5f53\u306a\u30c7\u30fc\u30bf\u3092\u5927\u91cf\u306b\u5165\u308c\u3066\u307f\u308b\n\n```create.sql\nSET CHARSET utf8;\nUSE my_test;\nCREATE TABLE test_table2(\n col1  INT   NOT NULL\tDEFAULT 0,\n col2  INT   NOT NULL\tDEFAULT 0,\n col3  INT   NOT NULL\tDEFAULT 0,\n create_time DATETIME\tNOT NULL,\n update_time DATETIME\tNOT NULL,\n delete_time DATETIME\tDEFAULT NULL,\nPRIMARY KEY (col1,col2,col3)\n)ENGINE=InnoDB DEFAULT CHARSET=utf8;\n```\n\n#\u30af\u30a8\u30ea\u3092\u751f\u6210\u3059\u308b\n\u30b8\u30a7\u30cd\u30ec\u30fc\u30bf\u30c4\u30fc\u30eb\u306e\u3088\u3046\u306a\u4f55\u304b\u306f\u4f7f\u7528\u305b\u305a\u306b\u7c21\u5358\u306b\u30b7\u30a7\u30eb\u30b9\u30af\u30ea\u30d7\u30c8\u3067\u30af\u30a8\u30ea\u3092\u4f5c\u308b\n\n```gen_random_rows.sh\n#!/bin/sh\n\necho \"INSERT IGNORE INTO test_table2 (col1,col2,col3,create_time,update_time) VALUES\" > insert.sql\nfor i in `seq 1 1000`\ndo\n    echo \"(FLOOR(RAND()*3000000),FLOOR(RAND()*1000000)%15,FLOOR(RAND()*1000000)%3,NOW(),NOW()),\" >> insert.sql\n    echo \"(FLOOR(RAND()*3000000),FLOOR(RAND()*1000000)%15,FLOOR(RAND()*1000000)%3,NOW(),NOW()),\" >> insert.sql\n    echo \"(FLOOR(RAND()*3000000),FLOOR(RAND()*1000000)%15,FLOOR(RAND()*1000000)%3,NOW(),NOW()),\" >> insert.sql\n    echo \"(FLOOR(RAND()*3000000),FLOOR(RAND()*1000000)%15,FLOOR(RAND()*1000000)%3,NOW(),NOW()),\" >> insert.sql\n    echo \"(FLOOR(RAND()*3000000),FLOOR(RAND()*1000000)%15,FLOOR(RAND()*1000000)%3,NOW(),NOW()),\" >> insert.sql\ndone\necho \"(FLOOR(RAND()*3000000),FLOOR(RAND()*1000000)%15,FLOOR(RAND()*1000000)%3,NOW(),NOW());\" >> insert.sql\n```\nFLOOR\u3068RAND\u3092\u4f7f\u3063\u3066col1\u306f300\u4e07\u4ee5\u4e0b\u3001col2\u306f15\u4ee5\u4e0b\u3001col3\u306f3\u4ee5\u4e0b\u306e\u6574\u6570\u3092\u5165\u308c\u308b\u3088\u3046\u306abulk insert\u30af\u30a8\u30ea\u3092\u4f5c\u6210\n\u3053\u308c\u30675000\u884c\u3092\u633f\u5165\u3059\u308b\u30af\u30a8\u30ea\u304c\u4f5c\u6210\u5b8c\u4e86\nIGNORE\u3092\u4f7f\u7528\u3057\u3066\u3044\u308b\u306e\u3067\u3001\u30d7\u30e9\u30a4\u30de\u30ea\u30ad\u30fc\u306e\u30c7\u30fc\u30bf\u304c\u88ab\u3063\u305f\u5834\u5408\u306f\u7121\u8996\u3055\u308c\u308b\n\n\u3053\u308c\u3092\u7e70\u308a\u8fd4\u3057\u3066\u9069\u5f53\u306a\u56de\u6570\u633f\u5165\u3059\u308b\n\n```insert_random_rows.sh\n#!/bin/sh\n\nset -e\n\nmariadb='/PATH/mariadb/bin/mysql'\n\nfor i in `seq 1 2000`\ndo\n    $mariadb -u* -p*** -Dmy_test < insert.sql\ndone\n```\n\n\n#Insert\n$ time bash insert_random_rows.sh\n\nreal\t3m40.434s\nuser\t0m15.065s\nsys\t0m3.685s\n\n\nMariaDB [my_test]> select table_schema, table_name, table_rows from information_schema.tables where table_schema='my_test' AND table_name='test_table2';\n+--------------+-------------+------------+\n| table_schema | table_name  | table_rows |\n+--------------+-------------+------------+\n| my_test      | test_table2 |    9273104 |\n+--------------+-------------+------------+\n1 row in set (0.00 sec)\n\n\n4\u5206\u304b\u304b\u3089\u305a\u306b1000\u4e07\u884c\u8fd1\u304f\u306e\u30c7\u30fc\u30bf\u3092\u633f\u5165\u3067\u304d\u305f\n\n\n#\u305d\u306e\u4ed6\n\u6642\u523b\u306e\u3068\u3053\u308d\u3082\u30e9\u30f3\u30c0\u30e0\u3063\u307d\u304f\u3057\u305f\u3044\u306a\u3089NOW()\u306e\u3068\u3053\u308d\u3092INTERVAL\u95a2\u6570\u3092\u4f7f\u3063\u3066\nNOW() - INTERVAL FLOOR(RAND()*10000) HOUR\n\u3068\u304b\u66f8\u304f\u3068\u9069\u5f53\u3063\u307d\u3044\u6642\u523b\u306b\u306a\u308b\n", "tags": ["Database", "MySQL", "mariadb", "PostgreSQL", "SQL"]}