{"tags": ["gmail", "Python"], "context": " More than 1 year has passed since last update.\u500b\u4eba\u7684\u306a\u30e1\u30e2\u7a0b\u5ea6\u3067\u3059\u3002\n\n#!/usr/bin/python\n\nimport smtplib\nfrom email.mime.text import MIMEText\nfrom email.header import Header\nfrom email.utils import formatdate\n\nclass Gmail:\n    \"\"\"\n    Gmail with smtp client\n    \"\"\"\n    def __init__(self, login_addr, passwd, encoding='utf-8'):\n        self._encoding = encoding\n        self._login_addr = login_addr\n        self._passwd = passwd\n\n    def send(self, to_addr, from_addr, subject, body):\n        \"\"\"\n        Send a mail via gmail\n        \"\"\"\n        msg = self._format_email(to_addr, from_addr, subject, body)\n        with smtplib.SMTP('smtp.gmail.com', 587) as smtp:\n            stmp.ehlo()\n            stmp.starttls()\n            stmp.ehlo()\n            stmp.login(self._login_addr, self._passwd)\n            stmp.sendmail(from_addr, to_addr, msg.as_string())\n\n    def _format_email(self, to_addr, from_addr, subject, body):\n        msg = MIMEText(body, 'html', self._encoding)\n        msg['Subject'] = Header(subject, self._encoding)\n        msg['From'] = from_addr\n        msg['To'] = to_addr\n        msg['Date'] = formatdate()\n\n        return msg\n\n    def bulk_send(self, emails):\n        \"\"\"\n        Send multiple mails at one time via gmail\n        \"\"\"\n        with smtplib.SMTP('smtp.gmail.com', 587) as smtp:\n            smtp.ehlo()\n            smtp.starttls()\n            smtp.ehlo()\n            smtp.login(self._login_addr, self._passwd)\n            for email in emails:\n                msg = self._format_email(email['to_addr'], email['from_addr'],\n                                         email['subject'], email['body'])\n                smtp.sendmail(email['from_addr'], email['to_addr'],\n                              msg.as_string())\n\n\nif __name__ == \"__main__\":\n    gmail = Gmail('hoge@gmail.com', 'foo')\n    gmail.send('foo@gmail.com', 'bar@gmail.com', 'test', 'test')\n    addr = 'baz@gmail.com'\n    mails = [{'to_addr': addr, 'from_addr': addr, 'subject': 'test', 'body': 'test'}] * 10\n    gmail.bulk_send(mails)\n\n\n\n\n\n\n\u500b\u4eba\u7684\u306a\u30e1\u30e2\u7a0b\u5ea6\u3067\u3059\u3002\n\n```python\n\n#!/usr/bin/python\n\nimport smtplib\nfrom email.mime.text import MIMEText\nfrom email.header import Header\nfrom email.utils import formatdate\n\nclass Gmail:\n    \"\"\"\n    Gmail with smtp client\n    \"\"\"\n    def __init__(self, login_addr, passwd, encoding='utf-8'):\n        self._encoding = encoding\n        self._login_addr = login_addr\n        self._passwd = passwd\n\n    def send(self, to_addr, from_addr, subject, body):\n        \"\"\"\n        Send a mail via gmail\n        \"\"\"\n        msg = self._format_email(to_addr, from_addr, subject, body)\n        with smtplib.SMTP('smtp.gmail.com', 587) as smtp:\n            stmp.ehlo()\n            stmp.starttls()\n            stmp.ehlo()\n            stmp.login(self._login_addr, self._passwd)\n            stmp.sendmail(from_addr, to_addr, msg.as_string())\n\n    def _format_email(self, to_addr, from_addr, subject, body):\n        msg = MIMEText(body, 'html', self._encoding)\n        msg['Subject'] = Header(subject, self._encoding)\n        msg['From'] = from_addr\n        msg['To'] = to_addr\n        msg['Date'] = formatdate()\n\n        return msg\n\n    def bulk_send(self, emails):\n        \"\"\"\n        Send multiple mails at one time via gmail\n        \"\"\"\n        with smtplib.SMTP('smtp.gmail.com', 587) as smtp:\n            smtp.ehlo()\n            smtp.starttls()\n            smtp.ehlo()\n            smtp.login(self._login_addr, self._passwd)\n            for email in emails:\n                msg = self._format_email(email['to_addr'], email['from_addr'],\n                                         email['subject'], email['body'])\n                smtp.sendmail(email['from_addr'], email['to_addr'],\n                              msg.as_string())\n\n\nif __name__ == \"__main__\":\n    gmail = Gmail('hoge@gmail.com', 'foo')\n    gmail.send('foo@gmail.com', 'bar@gmail.com', 'test', 'test')\n    addr = 'baz@gmail.com'\n    mails = [{'to_addr': addr, 'from_addr': addr, 'subject': 'test', 'body': 'test'}] * 10\n    gmail.bulk_send(mails)\n\n\n\n\n```\n"}