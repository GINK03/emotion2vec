{"context": "Linux\u306eLVM\u3067btrfs\u306eRAID1\u3092\u4f5c\u6210\u3057\u3066\u3044\u305f\u3068\u304d\u306bLVM\u306e\u30dc\u30ea\u30e5\u30fc\u30e0\u3092\u62e1\u5f35\u3057\u3066btrfs\u81ea\u4f53\u3092\u62e1\u5f35\u3059\u308b\u5b9f\u9a13\u3092\u3057\u305f\u3002\n\u307e\u305a\u306fbtrfs\u3067RAID1\u3092\u4f5c\u6210\u3059\u308b\u3002\n/mnt# lvcreate -L 1G -n v0 vg4t  Using default stripesize 64.00 KiB.\n  Logical volume \"v0\" created.\n/mnt# lvcreate -L 1G -n v1 vg4t\n  Logical volume \"v1\" created.\n/mnt# mkfs.btrfs /dev/vg4t/v0\nbtrfs-progs v4.7\nSee http://btrfs.wiki.kernel.org for more information.\n\nLabel:              (null)\nUUID:               51c63065-a84e-4aa5-85b6-9597e5f9a943\nNode size:          16384\nSector size:        4096\nFilesystem size:    1.00GiB\nBlock group profiles:\n  Data:             single            8.00MiB\n  Metadata:         DUP              51.19MiB\n  System:           DUP               8.00MiB\nSSD detected:       no\nIncompat features:  extref, skinny-metadata\nNumber of devices:  1\nDevices:\n   ID        SIZE  PATH\n    1     1.00GiB  /dev/vg4t/v0\n\n/mnt# mount /dev/vg4t/v0 testfs\n/mnt# btrfs fi df testfs\nData, single: total=8.00MiB, used=0.00B\nSystem, DUP: total=8.00MiB, used=16.00KiB\nMetadata, DUP: total=51.19MiB, used=112.00KiB\nGlobalReserve, single: total=16.00MiB, used=0.00B\n/mnt# btrfs device add /dev/vg4t/v1 testfs\n/mnt# btrfs fi df testfs\nData, single: total=8.00MiB, used=0.00B\nSystem, DUP: total=8.00MiB, used=16.00KiB\nMetadata, DUP: total=51.19MiB, used=112.00KiB\nGlobalReserve, single: total=16.00MiB, used=0.00B\n/mnt# btrfs balance start -dconvert=raid1 -mconvert=raid1 testfs\nDone, had to relocate 3 out of 3 chunks\n/mnt# btrfs fi df testfs\nData, RAID1: total=208.00MiB, used=128.00KiB\nData, single: total=208.00MiB, used=0.00B\nSystem, RAID1: total=32.00MiB, used=16.00KiB\nMetadata, RAID1: total=208.00MiB, used=112.00KiB\nGlobalReserve, single: total=16.00MiB, used=0.00B\n\nmkfs.btrfs\u3067\u4e00\u767a\u3067\u4f5c\u6210\u3092\u3059\u308b\u65b9\u6cd5\u3082\u3042\u308b\u304c\u4eca\u56de\u306f\u5f8c\u304b\u3089\u30c7\u30d0\u30a4\u30b9\u3092\u8ffd\u52a0\u3059\u308b\u624b\u9806\u3067\u3084\u3063\u3066\u307f\u305f\u3002\n\u6b21\u306bLVM\u306e\u30dc\u30ea\u30e5\u30fc\u30e0\u3092\u62e1\u5f35\u3059\u308b\u3002\n/mnt# lvextend -L+1G /dev/vg4t/v0\n  Size of logical volume vg4t/v0 changed from 1.00 GiB (256 extents) to 2.00 GiB (512 extents).\n  Logical volume vg4t/v0 successfully resized.\n/mnt# lvextend -L+1G /dev/vg4t/v1\n  Size of logical volume vg4t/v1 changed from 1.00 GiB (256 extents) to 2.00 GiB (512 extents).\n  Logical volume vg4t/v1 successfully resized.\n/mnt# df /mnt/testfs\n\u30d5\u30a1\u30a4\u30eb\u30b7\u30b9        1K-\u30d6\u30ed\u30c3\u30af  \u4f7f\u7528 \u4f7f\u7528\u53ef \u4f7f\u7528% \u30de\u30a6\u30f3\u30c8\u4f4d\u7f6e\n/dev/mapper/vg4t-v0     1048576 16640 695168    3% /mnt/testfs\n\n\u3053\u306e\u6bb5\u968e\u3067\u306f\u5f53\u7136\u62e1\u5f35\u306f\u3055\u308c\u306a\u3044\u3002\n/mnt# btrfs filesystem  resize max testfs\nResize 'testfs' of 'max'\n/mnt# df /mnt/testfs\n\u30d5\u30a1\u30a4\u30eb\u30b7\u30b9        1K-\u30d6\u30ed\u30c3\u30af  \u4f7f\u7528 \u4f7f\u7528\u53ef \u4f7f\u7528% \u30de\u30a6\u30f3\u30c8\u4f4d\u7f6e\n/dev/mapper/vg4t-v0     1572864 16640 695168    3% /mnt/testfs\n\n\u6b8b\u5ff5\u306a\u304c\u3089\u3053\u308c\u3067\u306f\u62e1\u5f35\u3055\u308c\u3066\u3044\u306a\u3044\u3002\n/mnt# btrfs filesystem show testfs\nLabel: none  uuid: 51c63065-a84e-4aa5-85b6-9597e5f9a943\n    Total devices 2 FS bytes used 256.00KiB\n    devid    1 size 2.00GiB used 448.00MiB path /dev/mapper/vg4t-v0\n    devid    2 size 1.00GiB used 656.00MiB path /dev/mapper/vg4t-v1\n\ndevid 2\u304c\u62e1\u5f35\u3055\u308c\u3066\u306a\u3044\u3002\n\u6b21\u306e\u3088\u3046\u306b\u660e\u793a\u7684\u306bdevid\u3092\u6307\u5b9a\u3057\u3066\u62e1\u5f35\u3059\u308b\u3002\n/mnt# btrfs filesystem  resize 2:max testfs\nResize 'testfs' of '2:max'\n/mnt# df /mnt/testfs\n\u30d5\u30a1\u30a4\u30eb\u30b7\u30b9        1K-\u30d6\u30ed\u30c3\u30af  \u4f7f\u7528  \u4f7f\u7528\u53ef \u4f7f\u7528% \u30de\u30a6\u30f3\u30c8\u4f4d\u7f6e\n/dev/mapper/vg4t-v0     2097152 16640 1743744    1% /mnt/testfs\n/mnt# btrfs filesystem show testfs\nLabel: none  uuid: 51c63065-a84e-4aa5-85b6-9597e5f9a943\n    Total devices 2 FS bytes used 256.00KiB\n    devid    1 size 2.00GiB used 448.00MiB path /dev/mapper/vg4t-v0\n    devid    2 size 2.00GiB used 656.00MiB path /dev/mapper/vg4t-v1\n\n\u5bb9\u91cf\u304c\u5897\u3048\u305f\u3002\nLinux\u306eLVM\u3067btrfs\u306eRAID1\u3092\u4f5c\u6210\u3057\u3066\u3044\u305f\u3068\u304d\u306bLVM\u306e\u30dc\u30ea\u30e5\u30fc\u30e0\u3092\u62e1\u5f35\u3057\u3066btrfs\u81ea\u4f53\u3092\u62e1\u5f35\u3059\u308b\u5b9f\u9a13\u3092\u3057\u305f\u3002\n\n\u307e\u305a\u306fbtrfs\u3067RAID1\u3092\u4f5c\u6210\u3059\u308b\u3002\n\n```\n/mnt# lvcreate -L 1G -n v0 vg4t  Using default stripesize 64.00 KiB.\n  Logical volume \"v0\" created.\n/mnt# lvcreate -L 1G -n v1 vg4t\n  Logical volume \"v1\" created.\n/mnt# mkfs.btrfs /dev/vg4t/v0\nbtrfs-progs v4.7\nSee http://btrfs.wiki.kernel.org for more information.\n\nLabel:              (null)\nUUID:               51c63065-a84e-4aa5-85b6-9597e5f9a943\nNode size:          16384\nSector size:        4096\nFilesystem size:    1.00GiB\nBlock group profiles:\n  Data:             single            8.00MiB\n  Metadata:         DUP              51.19MiB\n  System:           DUP               8.00MiB\nSSD detected:       no\nIncompat features:  extref, skinny-metadata\nNumber of devices:  1\nDevices:\n   ID        SIZE  PATH\n    1     1.00GiB  /dev/vg4t/v0\n\n/mnt# mount /dev/vg4t/v0 testfs\n/mnt# btrfs fi df testfs\nData, single: total=8.00MiB, used=0.00B\nSystem, DUP: total=8.00MiB, used=16.00KiB\nMetadata, DUP: total=51.19MiB, used=112.00KiB\nGlobalReserve, single: total=16.00MiB, used=0.00B\n/mnt# btrfs device add /dev/vg4t/v1 testfs\n/mnt# btrfs fi df testfs\nData, single: total=8.00MiB, used=0.00B\nSystem, DUP: total=8.00MiB, used=16.00KiB\nMetadata, DUP: total=51.19MiB, used=112.00KiB\nGlobalReserve, single: total=16.00MiB, used=0.00B\n/mnt# btrfs balance start -dconvert=raid1 -mconvert=raid1 testfs\nDone, had to relocate 3 out of 3 chunks\n/mnt# btrfs fi df testfs\nData, RAID1: total=208.00MiB, used=128.00KiB\nData, single: total=208.00MiB, used=0.00B\nSystem, RAID1: total=32.00MiB, used=16.00KiB\nMetadata, RAID1: total=208.00MiB, used=112.00KiB\nGlobalReserve, single: total=16.00MiB, used=0.00B\n```\nmkfs.btrfs\u3067\u4e00\u767a\u3067\u4f5c\u6210\u3092\u3059\u308b\u65b9\u6cd5\u3082\u3042\u308b\u304c\u4eca\u56de\u306f\u5f8c\u304b\u3089\u30c7\u30d0\u30a4\u30b9\u3092\u8ffd\u52a0\u3059\u308b\u624b\u9806\u3067\u3084\u3063\u3066\u307f\u305f\u3002\n\n\u6b21\u306bLVM\u306e\u30dc\u30ea\u30e5\u30fc\u30e0\u3092\u62e1\u5f35\u3059\u308b\u3002\n\n```\n/mnt# lvextend -L+1G /dev/vg4t/v0\n  Size of logical volume vg4t/v0 changed from 1.00 GiB (256 extents) to 2.00 GiB (512 extents).\n  Logical volume vg4t/v0 successfully resized.\n/mnt# lvextend -L+1G /dev/vg4t/v1\n  Size of logical volume vg4t/v1 changed from 1.00 GiB (256 extents) to 2.00 GiB (512 extents).\n  Logical volume vg4t/v1 successfully resized.\n/mnt# df /mnt/testfs\n\u30d5\u30a1\u30a4\u30eb\u30b7\u30b9        1K-\u30d6\u30ed\u30c3\u30af  \u4f7f\u7528 \u4f7f\u7528\u53ef \u4f7f\u7528% \u30de\u30a6\u30f3\u30c8\u4f4d\u7f6e\n/dev/mapper/vg4t-v0     1048576 16640 695168    3% /mnt/testfs\n```\n\u3053\u306e\u6bb5\u968e\u3067\u306f\u5f53\u7136\u62e1\u5f35\u306f\u3055\u308c\u306a\u3044\u3002\n\n```\n/mnt# btrfs filesystem  resize max testfs\nResize 'testfs' of 'max'\n/mnt# df /mnt/testfs\n\u30d5\u30a1\u30a4\u30eb\u30b7\u30b9        1K-\u30d6\u30ed\u30c3\u30af  \u4f7f\u7528 \u4f7f\u7528\u53ef \u4f7f\u7528% \u30de\u30a6\u30f3\u30c8\u4f4d\u7f6e\n/dev/mapper/vg4t-v0     1572864 16640 695168    3% /mnt/testfs\n```\n\u6b8b\u5ff5\u306a\u304c\u3089\u3053\u308c\u3067\u306f\u62e1\u5f35\u3055\u308c\u3066\u3044\u306a\u3044\u3002\n\n```\n/mnt# btrfs filesystem show testfs\nLabel: none  uuid: 51c63065-a84e-4aa5-85b6-9597e5f9a943\n\tTotal devices 2 FS bytes used 256.00KiB\n\tdevid    1 size 2.00GiB used 448.00MiB path /dev/mapper/vg4t-v0\n\tdevid    2 size 1.00GiB used 656.00MiB path /dev/mapper/vg4t-v1\n```\ndevid 2\u304c\u62e1\u5f35\u3055\u308c\u3066\u306a\u3044\u3002\n\n\u6b21\u306e\u3088\u3046\u306b\u660e\u793a\u7684\u306bdevid\u3092\u6307\u5b9a\u3057\u3066\u62e1\u5f35\u3059\u308b\u3002\n\n```\n/mnt# btrfs filesystem  resize 2:max testfs\nResize 'testfs' of '2:max'\n/mnt# df /mnt/testfs\n\u30d5\u30a1\u30a4\u30eb\u30b7\u30b9        1K-\u30d6\u30ed\u30c3\u30af  \u4f7f\u7528  \u4f7f\u7528\u53ef \u4f7f\u7528% \u30de\u30a6\u30f3\u30c8\u4f4d\u7f6e\n/dev/mapper/vg4t-v0     2097152 16640 1743744    1% /mnt/testfs\n/mnt# btrfs filesystem show testfs\nLabel: none  uuid: 51c63065-a84e-4aa5-85b6-9597e5f9a943\n\tTotal devices 2 FS bytes used 256.00KiB\n\tdevid    1 size 2.00GiB used 448.00MiB path /dev/mapper/vg4t-v0\n\tdevid    2 size 2.00GiB used 656.00MiB path /dev/mapper/vg4t-v1\n```\n\u5bb9\u91cf\u304c\u5897\u3048\u305f\u3002\n", "tags": ["Linux", "btrfs", "lvm"]}