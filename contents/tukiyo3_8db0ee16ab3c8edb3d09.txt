{"context": "\n\ndumpel.exe \u3092\u4f7f\u3046\u5834\u5408\n\nWindows 2000 \u30ea\u30bd\u30fc\u30b9 \u30ad\u30c3\u30c8\u306e\u30c4\u30fc\u30eb\u306e\u7ba1\u7406\u30bf\u30b9\u30af\n\n\n\u51fa\u529b\ndumpel.exe -f system.csv -l system -c -d 1 -format dts\n\n\n\n\u30ea\u30c0\u30a4\u30ec\u30af\u30c8\u3059\u308b\u5834\u5408\ndumpel.exe -l system -c -d 1 -format dts > system.csv\n\n\n\n-f a.csv : \u51fa\u529b\u30d5\u30a1\u30a4\u30eb\u540d\n-l : \u30ed\u30b0\u7a2e\u5225\n-c : \u30ab\u30f3\u30de\u533a\u5207\u308a\n-d : \u4f55\u65e5\u524d\u304b\u3089\u306e\u30ed\u30b0\u3092\u53d6\u5f97\u3059\u308b\u304b\n\n\nwindows7\u306e\u5834\u5408\u30011\u3092\u6307\u5b9a\u3057\u3066\u3082\u5c11\u3057\u9577\u3044\u671f\u9593\u62bd\u51fa\u3055\u308c\u308b\n\n\n-format dts : \u65e5\u4ed8 \u6642\u9593 \u5185\u5bb9 \u3067\u51fa\u529b\n\n\n\nwmic\u3092\u4f7f\u3046\u5834\u5408\n\nwindows XP\u4ee5\u964d\u5bfe\u5fdc\n\n\n\u53c2\u8003\n\nWMIC Best practices: Windows Management Instrumentation (WMI); Scripting\nTech TIPS\uff1awmic\u30b3\u30de\u30f3\u30c9\u3067\u30a4\u30d9\u30f3\u30c8\u30fb\u30ed\u30b0\u3092\u8868\u793a\u3059\u308b - \uff20IT\nTech TIPS\uff1aWindows\u306e\u30d0\u30c3\u30c1\u30d5\u30a1\u30a4\u30eb\u4e2d\u3067\u65e5\u4ed8\u3092\u30d5\u30a1\u30a4\u30eb\u540d\u306b\u4f7f\u7528\u3059\u308b (1/2) - \uff20IT\n\u30b3\u30de\u30f3\u30c9\u306e\u9014\u4e2d\u3067\u6539\u884c\u3059\u308b - Windows Tips: [\u30b3\u30de\u30f3\u30c9\u30d7\u30ed\u30f3\u30d7\u30c8]\n\u524d\u65e5\u306e\u30a4\u30d9\u30f3\u30c8\u30ed\u30b0\u3092WMI\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3067\u53d6\u5f97\u3059\u308b - G\u30d6\u30ed\u30b0\n\n\n\u30d0\u30c3\u30c1\u30d5\u30a1\u30a4\u30eb\n\nget_event_log.bat\n@echo off\n\nrem QUERY= \u306e\u5f8c\u308d\u306b\u7a7a\u767d\u4e00\u3064\u5165\u308a\u307e\u3059\u3002\nset QUERY= \nset QUERY=%QUERY% LogFile='System'\nset QUERY=%QUERY% and Type!='Information'\n\nrem \u4e0d\u8981\u306a\u30bd\u30fc\u30b9\u3092\u9664\u5916\nset QUERY=%QUERY% and SourceName!='EventLog'\nset QUERY=%QUERY% and SourceName!='Microsoft-Windows-GroupPolicy'\nset QUERY=%QUERY% and SourceName!='Microsoft-Windows-Kernel-General'\nset QUERY=%QUERY% and SourceName!='Microsoft-Windows-TerminalServices-RemoteConnectionManager'\nset QUERY=%QUERY% and SourceName!='Microsoft-Windows-Time-Service'\nset QUERY=%QUERY% and SourceName!='Schannel'\nset QUERY=%QUERY% and SourceName!='Service Control Manager'\nset QUERY=%QUERY% and SourceName!='TermDD'\n\nrem \u672c\u65e5\u4ee5\u964d\u306e\u30ed\u30b0\u3092\u53d6\u5f97\nrem 2015/07/01\u309220150701\u3067\u53d6\u5f97\nset TODAY=%date:~0,4%%date:~5,2%%date:~8,2%\nset QUERY=%QUERY% and TimeGenerated ^>= '%TODAY%000000.0+540'\n\nrem \u5b9f\u884c\nwmic ntevent where^\n \"(%QUERY%)\"^\n GET Message,TimeGenerated,SourceName /FORMAT:htable > %TEMP%\\eventlog.html\n\n\neventlog.html\u3092\u78ba\u8a8d\u3002\n\n\u30e1\u30fc\u30eb\u9001\u4fe1\n\n[VB Script] CDO.Message \u3067\u30e1\u30fc\u30eb\u3092\u9001\u4fe1\u3059\u308b\u3068\u300c\"SendUsing\"\u306e\u69cb\u6210\u5024\u306f\u7121\u52b9\u3067\u3059\u3002\u300d\u30a8\u30e9\u30fc\u306b\u3088\u308a\u30e1\u30fc\u30eb\u304c\u9001\u4fe1\u3067\u304d\u306a\u3044\n\u30b7\u30b9\u30c6\u30e0\u7528\u306e\u30d5\u30a9\u30eb\u30c0\u3092\u53d6\u5f97\u3059\u308b - GetSpecialFolder [Scripting.FileSystemObject] - VBScript Tips [VBA/Access/Excel\u5bfe\u5fdc]\n\n\nsend_eventlog.vbs\nFunction getHostname()\n  Dim objNetWork\n  Dim PCname\n  Set objNetWork = WScript.CreateObject(\"WScript.Network\")\n  PCname= objNetWork.ComputerName\n  getHostname = PCname\nEnd Function\n\n' TEMP\u30d5\u30a9\u30eb\u30c0\u306e\u53d6\u5f97\nDim objFileSys\nSet objFileSys = CreateObject(\"Scripting.FileSystemObject\")\nSet objTempFile = objFileSys.GetSpecialFolder(2)\n\nSet oMsg = CreateObject(\"CDO.Message\")\noMsg.From = \"eventlog@\" & getHostname\noMsg.To = \"to@localhost\" '\u9001\u4fe1\u5148\noMsg.Subject = \"eventlog: \" & getHostname\noMsg.TextBody = Now & vbCrLf & \"\u30a4\u30d9\u30f3\u30c8\u30ed\u30b0\"\nstrAddAttachment = objTempFile & \"\\eventlog.html\"\noMsg.AddAttachment strAddAttachment '\u6dfb\u4ed8\u30d5\u30a1\u30a4\u30eb\n\n' SMTP\u30b5\u30fc\u30d0\u306e\u8a2d\u5b9a\noMsg.Configuration.Fields.Item _\n (\"http://schemas.microsoft.com/cdo/configuration/sendusing\") = 2\noMsg.Configuration.Fields.Item _\n (\"http://schemas.microsoft.com/cdo/configuration/smtpserver\") = \"127.0.0.1\"\noMsg.Configuration.Fields.Item _\n (\"http://schemas.microsoft.com/cdo/configuration/smtpserverport\") = 25\noMsg.Configuration.Fields.Update\n\noMsg.Send\n\n\n\n\n\u30bf\u30b9\u30af\u767b\u9332\u3059\u308b\u5834\u5408\u306e\u6ce8\u610f\n\n\u30b9\u30b1\u30b8\u30e5\u30fc\u30eb \u30bf\u30b9\u30af\u306f\u7a7a\u306e\u30d1\u30b9\u30ef\u30fc\u30c9\u3067\u306f\u5b9f\u884c\u3055\u308c\u306a\u3044 \n\u30b9\u30bf\u30fc\u30c8\u30a2\u30c3\u30d7\u306b\u767b\u9332\u3059\u308b\u304b\u3001\u30ed\u30fc\u30ab\u30eb\u30dd\u30ea\u30b7\u30fc\u306e\u5909\u66f4\u3067\u5bfe\u5fdc\u53ef\u80fd\u3067\u306f\u3042\u308b\u3002\n\n\n\n\u305d\u306e\u4ed6\n\n\u5e74\u6708\u65e5\nset YEAR=%date:~0,4%\nset MONTH=%date:~5,2%\nset DAY=%date:~8,2%\n\n\n\n\u8db3\u3057\u7b97\nset /A NEWYEAR=%YEAR% + 1\n\n\n# dumpel.exe \u3092\u4f7f\u3046\u5834\u5408\n\n* [Windows 2000 \u30ea\u30bd\u30fc\u30b9 \u30ad\u30c3\u30c8\u306e\u30c4\u30fc\u30eb\u306e\u7ba1\u7406\u30bf\u30b9\u30af](https://support.microsoft.com/ja-jp/kb/927229)\n\n```bash:\u51fa\u529b\ndumpel.exe -f system.csv -l system -c -d 1 -format dts\n```\n\n```bash:\u30ea\u30c0\u30a4\u30ec\u30af\u30c8\u3059\u308b\u5834\u5408\ndumpel.exe -l system -c -d 1 -format dts > system.csv\n```\n\n* -f a.csv : \u51fa\u529b\u30d5\u30a1\u30a4\u30eb\u540d\n* -l : \u30ed\u30b0\u7a2e\u5225\n* -c : \u30ab\u30f3\u30de\u533a\u5207\u308a\n* -d : \u4f55\u65e5\u524d\u304b\u3089\u306e\u30ed\u30b0\u3092\u53d6\u5f97\u3059\u308b\u304b\n    * windows7\u306e\u5834\u5408\u30011\u3092\u6307\u5b9a\u3057\u3066\u3082\u5c11\u3057\u9577\u3044\u671f\u9593\u62bd\u51fa\u3055\u308c\u308b\n* -format dts : \u65e5\u4ed8 \u6642\u9593 \u5185\u5bb9 \u3067\u51fa\u529b\n\n----\n\n# wmic\u3092\u4f7f\u3046\u5834\u5408\n\n* windows XP\u4ee5\u964d\u5bfe\u5fdc\n\n## \u53c2\u8003\n\n* [WMIC Best practices: Windows Management Instrumentation (WMI); Scripting](https://technet.microsoft.com/en-us/library/cc758713%28v=ws.10%29.aspx)\n* [Tech TIPS\uff1awmic\u30b3\u30de\u30f3\u30c9\u3067\u30a4\u30d9\u30f3\u30c8\u30fb\u30ed\u30b0\u3092\u8868\u793a\u3059\u308b - \uff20IT](http://www.atmarkit.co.jp/ait/articles/0804/25/news171.html)\n* [Tech TIPS\uff1aWindows\u306e\u30d0\u30c3\u30c1\u30d5\u30a1\u30a4\u30eb\u4e2d\u3067\u65e5\u4ed8\u3092\u30d5\u30a1\u30a4\u30eb\u540d\u306b\u4f7f\u7528\u3059\u308b (1/2) - \uff20IT](http://www.atmarkit.co.jp/ait/articles/0405/01/news002.html)\n* [\u30b3\u30de\u30f3\u30c9\u306e\u9014\u4e2d\u3067\u6539\u884c\u3059\u308b - Windows Tips: [\u30b3\u30de\u30f3\u30c9\u30d7\u30ed\u30f3\u30d7\u30c8]](http://www.k-tanaka.net/windows/cmd/post_14.html)\n* [\u524d\u65e5\u306e\u30a4\u30d9\u30f3\u30c8\u30ed\u30b0\u3092WMI\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3067\u53d6\u5f97\u3059\u308b - G\u30d6\u30ed\u30b0](http://d.hatena.ne.jp/bhunji2000/20091222/1261505346)\n\n## \u30d0\u30c3\u30c1\u30d5\u30a1\u30a4\u30eb\n\n```bat:get_event_log.bat\n@echo off\n\nrem QUERY= \u306e\u5f8c\u308d\u306b\u7a7a\u767d\u4e00\u3064\u5165\u308a\u307e\u3059\u3002\nset QUERY= \nset QUERY=%QUERY% LogFile='System'\nset QUERY=%QUERY% and Type!='Information'\n\nrem \u4e0d\u8981\u306a\u30bd\u30fc\u30b9\u3092\u9664\u5916\nset QUERY=%QUERY% and SourceName!='EventLog'\nset QUERY=%QUERY% and SourceName!='Microsoft-Windows-GroupPolicy'\nset QUERY=%QUERY% and SourceName!='Microsoft-Windows-Kernel-General'\nset QUERY=%QUERY% and SourceName!='Microsoft-Windows-TerminalServices-RemoteConnectionManager'\nset QUERY=%QUERY% and SourceName!='Microsoft-Windows-Time-Service'\nset QUERY=%QUERY% and SourceName!='Schannel'\nset QUERY=%QUERY% and SourceName!='Service Control Manager'\nset QUERY=%QUERY% and SourceName!='TermDD'\n\nrem \u672c\u65e5\u4ee5\u964d\u306e\u30ed\u30b0\u3092\u53d6\u5f97\nrem 2015/07/01\u309220150701\u3067\u53d6\u5f97\nset TODAY=%date:~0,4%%date:~5,2%%date:~8,2%\nset QUERY=%QUERY% and TimeGenerated ^>= '%TODAY%000000.0+540'\n\nrem \u5b9f\u884c\nwmic ntevent where^\n \"(%QUERY%)\"^\n GET Message,TimeGenerated,SourceName /FORMAT:htable > %TEMP%\\eventlog.html\n```\n\neventlog.html\u3092\u78ba\u8a8d\u3002\n\n## \u30e1\u30fc\u30eb\u9001\u4fe1\n\n* [[VB Script] CDO.Message \u3067\u30e1\u30fc\u30eb\u3092\u9001\u4fe1\u3059\u308b\u3068\u300c\"SendUsing\"\u306e\u69cb\u6210\u5024\u306f\u7121\u52b9\u3067\u3059\u3002\u300d\u30a8\u30e9\u30fc\u306b\u3088\u308a\u30e1\u30fc\u30eb\u304c\u9001\u4fe1\u3067\u304d\u306a\u3044](http://www.ipentec.com/document/document.aspx?page=vb-script-send-mail-cdo-message)\n* [\u30b7\u30b9\u30c6\u30e0\u7528\u306e\u30d5\u30a9\u30eb\u30c0\u3092\u53d6\u5f97\u3059\u308b - GetSpecialFolder [Scripting.FileSystemObject] - VBScript Tips [VBA/Access/Excel\u5bfe\u5fdc]](http://www.happy2-island.com/vbs/cafe02/capter00222.shtml)\n\n```vbnet:send_eventlog.vbs\nFunction getHostname()\n  Dim objNetWork\n  Dim PCname\n  Set objNetWork = WScript.CreateObject(\"WScript.Network\")\n  PCname= objNetWork.ComputerName\n  getHostname = PCname\nEnd Function\n\n' TEMP\u30d5\u30a9\u30eb\u30c0\u306e\u53d6\u5f97\nDim objFileSys\nSet objFileSys = CreateObject(\"Scripting.FileSystemObject\")\nSet objTempFile = objFileSys.GetSpecialFolder(2)\n\nSet oMsg = CreateObject(\"CDO.Message\")\noMsg.From = \"eventlog@\" & getHostname\noMsg.To = \"to@localhost\" '\u9001\u4fe1\u5148\noMsg.Subject = \"eventlog: \" & getHostname\noMsg.TextBody = Now & vbCrLf & \"\u30a4\u30d9\u30f3\u30c8\u30ed\u30b0\"\nstrAddAttachment = objTempFile & \"\\eventlog.html\"\noMsg.AddAttachment strAddAttachment '\u6dfb\u4ed8\u30d5\u30a1\u30a4\u30eb\n\n' SMTP\u30b5\u30fc\u30d0\u306e\u8a2d\u5b9a\noMsg.Configuration.Fields.Item _\n (\"http://schemas.microsoft.com/cdo/configuration/sendusing\") = 2\noMsg.Configuration.Fields.Item _\n (\"http://schemas.microsoft.com/cdo/configuration/smtpserver\") = \"127.0.0.1\"\noMsg.Configuration.Fields.Item _\n (\"http://schemas.microsoft.com/cdo/configuration/smtpserverport\") = 25\noMsg.Configuration.Fields.Update\n\noMsg.Send\n```\n\n----\n\n# \u30bf\u30b9\u30af\u767b\u9332\u3059\u308b\u5834\u5408\u306e\u6ce8\u610f\n\n* [\u30b9\u30b1\u30b8\u30e5\u30fc\u30eb \u30bf\u30b9\u30af\u306f\u7a7a\u306e\u30d1\u30b9\u30ef\u30fc\u30c9\u3067\u306f\u5b9f\u884c\u3055\u308c\u306a\u3044 ](https://support.microsoft.com/ja-jp/kb/310715)\n* \u30b9\u30bf\u30fc\u30c8\u30a2\u30c3\u30d7\u306b\u767b\u9332\u3059\u308b\u304b\u3001\u30ed\u30fc\u30ab\u30eb\u30dd\u30ea\u30b7\u30fc\u306e\u5909\u66f4\u3067\u5bfe\u5fdc\u53ef\u80fd\u3067\u306f\u3042\u308b\u3002\n\n----\n\n# \u305d\u306e\u4ed6\n\n```rb:\u5e74\u6708\u65e5\nset YEAR=%date:~0,4%\nset MONTH=%date:~5,2%\nset DAY=%date:~8,2%\n```\n\n```bash:\u8db3\u3057\u7b97\nset /A NEWYEAR=%YEAR% + 1\n```\n", "tags": ["Windows", "\u30d0\u30c3\u30c1\u30d5\u30a1\u30a4\u30eb", "VBScript"]}