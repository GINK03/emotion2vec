{"tags": ["lot", "\u30e9\u30b8\u30aa", "jsFiddle", "WebRTC", "websocket"], "context": "\n\n\u6982\u8981\n\u53d7\u4fe1\u30d7\u30ed\u30b0\u30e9\u30e0\u306f\u3001jsfiddle\u306b\u7f6e\u3044\u305f\u3002\nwebrtc\u304c\u3001jsdo\u3067\u52d5\u304b\u306a\u3044\u305f\u3081\u3002\n\u30aa\u30fc\u30c7\u30a3\u30aa\u30ab\u30fc\u30c9\u306e\u30de\u30a4\u30af\u5165\u529b\u3092websocket\u306b\u6295\u3052\u308b\u3002\n\n\u5199\u771f\n\n\n\u30b5\u30f3\u30d7\u30eb\u30b3\u30fc\u30c9\nvar ws = new WebSocket(\"ws://ohijs0.paas.jp-e1.cloudn-service.com/pub\");\nws.binaryType = \"arraybuffer\";\nws.onopen = function(e) {\n};\nws.onerror = function(e) {\n    alert(\"err\");\n    alert(e.msg); \n};\nvar ac = new AudioContext();\nvar sampleRate = ac.sampleRate;\nvar node = ac.createScriptProcessor(4096, 2, 2);\nnavigator.getMedia = (navigator.getUserMedia || navigator.webkitGetUserMedia || navigator.mozGetUserMedia || navigator.msGetUserMedia);\nfunction onStream(stream) {\n    var source = ac.createMediaStreamSource(stream);\n    node.onaudioprocess = function(e) {\n        ws.send(new Float32Array(e.inputBuffer.getChannelData(0)));\n    }\n    source.connect(node);\n    node.connect(ac.destination);\n}\nfunction onStreamFailed(err) {\n    alert('\u30a8\u30e9\u30fc: ' + err);\n}\nif (navigator.getMedia) \n{\n    var prop = {\n        video: false,\n        audio: true,\n        toString: function() {\n            return 'audio';\n        }\n    };\n    navigator.getMedia(prop, onStream, onStreamFailed);\n} \nelse \n{\n    alert('\u30a8\u30e9\u30fc: getUserMedia\u304c\u30b5\u30dd\u30fc\u30c8\u3055\u308c\u3066\u3044\u307e\u305b\u3093');\n}\n\n#\u6982\u8981\n\u53d7\u4fe1\u30d7\u30ed\u30b0\u30e9\u30e0\u306f\u3001jsfiddle\u306b\u7f6e\u3044\u305f\u3002\nwebrtc\u304c\u3001jsdo\u3067\u52d5\u304b\u306a\u3044\u305f\u3081\u3002\n\u30aa\u30fc\u30c7\u30a3\u30aa\u30ab\u30fc\u30c9\u306e\u30de\u30a4\u30af\u5165\u529b\u3092websocket\u306b\u6295\u3052\u308b\u3002\n#\u5199\u771f\n![](http://jsrun.it/assets/I/t/S/S/ItSSt)\n#\u30b5\u30f3\u30d7\u30eb\u30b3\u30fc\u30c9\n```\nvar ws = new WebSocket(\"ws://ohijs0.paas.jp-e1.cloudn-service.com/pub\");\nws.binaryType = \"arraybuffer\";\nws.onopen = function(e) {\n};\nws.onerror = function(e) {\n    alert(\"err\");\n    alert(e.msg); \n};\nvar ac = new AudioContext();\nvar sampleRate = ac.sampleRate;\nvar node = ac.createScriptProcessor(4096, 2, 2);\nnavigator.getMedia = (navigator.getUserMedia || navigator.webkitGetUserMedia || navigator.mozGetUserMedia || navigator.msGetUserMedia);\nfunction onStream(stream) {\n    var source = ac.createMediaStreamSource(stream);\n    node.onaudioprocess = function(e) {\n        ws.send(new Float32Array(e.inputBuffer.getChannelData(0)));\n    }\n    source.connect(node);\n    node.connect(ac.destination);\n}\nfunction onStreamFailed(err) {\n    alert('\u30a8\u30e9\u30fc: ' + err);\n}\nif (navigator.getMedia) \n{\n    var prop = {\n        video: false,\n        audio: true,\n        toString: function() {\n            return 'audio';\n        }\n    };\n    navigator.getMedia(prop, onStream, onStreamFailed);\n} \nelse \n{\n    alert('\u30a8\u30e9\u30fc: getUserMedia\u304c\u30b5\u30dd\u30fc\u30c8\u3055\u308c\u3066\u3044\u307e\u305b\u3093');\n}\n```\n\n"}