{"context": " More than 1 year has passed since last update.\u672c\u8a18\u4e8b\u306fDocker Advent Calendar 2014\u306e27\u65e5\u76ee\u306e\u8a18\u4e8b\u3067\u3059\u3002\uff08\u5618\u3067\u3059\u300227\u65e5\u76ee\u306a\u3093\u3066\u3042\u308a\u307e\u305b\u3093\u3002\uff09\n\n\u306f\u3058\u3081\u306b\n\u3053\u3053\u307e\u3067\u81ea\u5206\u304c\u6295\u7a3f\u3057\u305f\u8a18\u4e8b\u3092\u4f7f\u3063\u3066\u3001\u4e0b\u8a18\u304c\u4f5c\u308c\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3057\u305f\u3002\n\nprivate docker registry\nGitLab\nJenkins\n\n\u3053\u308c\u3089\u3092\u5229\u7528\u3057\u3066\u3001private Docker Hub \u3092\u4f5c\u3063\u3066\u307f\u307e\u3059\u3002\n\n\u4eca\u56de\u4f5c\u6210\u3059\u308b private Docker Hub \u306e\u4ed5\u7d44\u307f\n\n\u30ed\u30fc\u30ab\u30eb\u3067\u4f5c\u6210\u3057\u305fDockerfile\u3092GitLab\u306bpush\nGitLab\u304b\u3089WebHook\u3067Jenkins\u306b\u901a\u77e5\nJenkins\u306b\u3066Dockerfile\u3092\u30d3\u30eb\u30c9\n\n\nJenkins\u306fdocker\u30b3\u30f3\u30c6\u30ca\u3067\u8d77\u52d5\u3057\u3066\u3044\u308b\nJenkins\u30b3\u30f3\u30c6\u30ca\u5185\u3067Dockerfile\u3092\u30d3\u30eb\u30c9\u3057\u3066\u3044\u308b\u308f\u3051\u3067\u306f\u306a\u3044\n\u30db\u30b9\u30c8\u306edockerAPI\uff08docker-py\u7d4c\u7531\uff09\u3092\u5229\u7528\u3057\u3066\u3044\u308b\n\n\ndocker build\n\n\n\u6210\u529f\u3057\u305f\u5834\u5408\u3001private registry\u306bpush\n\u5931\u6557\u3057\u305f\u5834\u5408\u3001Gmail\u306b\u901a\u77e5\u3092\u884c\u3046\n\n\n\n\n\u74b0\u5883\n\nOS: Ubuntu14.04\ndocker version: 1.4.1\n/etc/default/docker\u306b\u3053\u3061\u3089\u306e\u8a2d\u5b9a\u3092\u884c\u3046\n\u4e0a\u8a18\u30db\u30b9\u30c8\u30922\u53f0\u7528\u610f\n\n\u4e0b\u8a18\u306e\u3088\u3046\u306a\u69cb\u6210\u3092\u76ee\u6307\u3057\u307e\u3059\u3002(\u5168\u3066docker\u30b3\u30f3\u30c6\u30ca\u3067\u3059\u3002)\n\n\u30db\u30b9\u30c8A\n\n\nprivate dockcer registry\nprivate dockcer registry(Web UI)\n\n\n\u30db\u30b9\u30c8B\n\n\nGitLab\nJenkins\n\n\n\n\u30ed\u30fc\u30ab\u30ebGit\u30ea\u30dd\u30b8\u30c8\u30ea\u306f\u4e0b\u8a18\u306e\u3088\u3046\u306a\u69cb\u6210\u306b\u3059\u308b\u3053\u3068\n\nubuntu1404_test\n\n\nDockerfile\n\n\nhoge\n\n\nDockerfile\n\n\nfuga\n\n\nDockerfile\n\n\n\n\n\u8a2d\u5b9a\uff08\u30db\u30b9\u30c8A\uff09\n\nprivate dockcer registry\n\u4e0b\u8a18\u3092\u53c2\u8003\u306bregistry\u30b3\u30f3\u30c6\u30ca\u3092\u7528\u610f\u3057\u307e\u3059\u3002\n\nprivate docker registry \u3092\u4f7f\u3063\u3066\u307f\u308b\n\u7d9a\uff1aprivate docker registry \u3092\u4f7f\u3063\u3066\u307f\u308b(WebUI)\n\n$ sudo docker ps\nIMAGE                                        PORTS\nkonradkleine/docker-registry-frontend:latest 443/tcp, 0.0.0.0:8080->80/tcp\nregistry:latest                              0.0.0.0:5000->5000/tcp\n\n\u203bCONTAINER ID\u306a\u3069\u306f\u7701\u7565\n\n\u8a2d\u5b9a\uff08\u30db\u30b9\u30c8B\uff09\n\nGitLab \u521d\u671f\u8a2d\u5b9a\n\u4e0b\u8a18\u3092\u53c2\u8003\u306bGitLab\u30b3\u30f3\u30c6\u30ca\u3092\u7528\u610f\u3057\u307e\u3059\u3002\n\nGitLab in docker \u3067LDAP\u8a8d\u8a3c\u3092\u5229\u7528\u3059\u308b\n\n$ sudo docker ps\nIMAGE                   PORTS                                                   NAMES\nsameersbn/gitlab:latest 443/tcp, 0.0.0.0:10022->22/tcp, 0.0.0.0:10080->80/tcp   hungry_ardinghelli\nsameersbn/mysql:latest  3306/tcp                                                gitlab-mysql\nsameersbn/redis:latest  6379/tcp                                                gitlab-redis\n\n\u203bCONTAINER ID\u306a\u3069\u306f\u7701\u7565\nGitLab\u306b\u30ed\u30b0\u30a4\u30f3\u5f8c\u3001\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092\u4f5c\u6210\u3057\u3001\u30ed\u30fc\u30ab\u30eb\u3068\u9023\u643a\u3057\u307e\u3059\u3002\n\u306a\u304a\u3001ubuntu1404_test\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306e\u4e2d\u306b\u306f\u7c21\u5358\u306aDockerfile\u304c\u5165\u3063\u3066\u3044\u307e\u3059\u3002\n\u203b\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u540d\u3092\u30a4\u30e1\u30fc\u30b8\u30bf\u30b0\u306b\u4f7f\u7528\u3059\u308b\u306e\u3067\u3001\u91cd\u8907\u306a\u3069\u3057\u306a\u3044\u3088\u3046\u306b\u6ce8\u610f\u3057\u3066\u4e0b\u3055\u3044\u3002\n\n\n\nJenkins \u521d\u671f\u8a2d\u5b9a\n\u4e0b\u8a18\u3092\u53c2\u8003\u306b\u3057\u3064\u3064\u3001\u5fc5\u8981\u306a\u30e2\u30b8\u30e5\u30fc\u30eb\u3092\u8ffd\u52a0\u3057\u305fJenkins\u30b3\u30f3\u30c6\u30ca\u3092\u7528\u610f\u3057\u307e\u3059\u3002\n\ndoragon/Dockerfile/debian/8.0/jenkins/\n\n$ sudo git clone https://github.com/doragon/Dockerfile.git\n$ sudo mv Dockerfile/debian/8.0/jenkins/ ./\n$ sudo rm -rf Dockerfile\n$ cd jenkins/\n$ mkdir jenkins_home\n$ chmod 777 jenkins_home\n\n$ sudo docker build -t koide/jenkins .\n\n$ sudo docker run -p 28080:8080 -d \\\n -v [PATH]/jenkins/jenkins_home:/var/jenkins_home \\\n -v [PATH]/jenkins/workspace:/var/workspace \\\n koide/jenkins\n\n$ sudo docker ps\nIMAGE                PORTS\nkoide/jenkins:latest 50000/tcp, 0.0.0.0:28080->8080/tcp\n\n\u3053\u3053\u3067\u3001GitLab\u3068\u9023\u643a\u3092\u884c\u3046\u305f\u3081\u3001jenkins\u30e6\u30fc\u30b6\u30fc\u306e\u500b\u5225\u8a2d\u5b9a\u3092\u884c\u3044\u307e\u3059\u3002\n\u203b\u672c\u6765\u306a\u3089Dockerfile\u3067\u5b8c\u7d50\u3059\u3079\u304d\u306a\u306e\u3067\u3059\u304c\u3001root\u30e6\u30fc\u30b6\u30fc\u4ee5\u5916\u3067\u306e\u6a29\u9650\u8a2d\u5b9a\u304c\u3046\u307e\u304f\u3044\u304b\u306a\u3044\u305f\u3081\u30b3\u30f3\u30c6\u30ca\u5185\u3067\u4f5c\u696d\u3092\u884c\u3044\u307e\u3059\u3002\n$ sudo docker exec -it 3fbc958b8006 bash\njenkins@3fbc958b8006:/$\njenkins@3fbc958b8006:/$ cd\njenkins@3fbc958b8006:~$ pwd\n/var/jenkins_home\n\njenkins@3fbc958b8006:~$ mkdir .ssh\njenkins@3fbc958b8006:~$ cd .ssh\njenkins@3fbc958b8006:~/.ssh$ ssh-keygen -t rsa -f id_rsa -C \"jenkins@test.com\" -N \"\"\njenkins@3fbc958b8006:~/.ssh$ chmod 744 $HOME/.ssh\njenkins@3fbc958b8006:~/.ssh$ chmod 700 $HOME/.ssh/id_rsa\njenkins@3fbc958b8006:~/.ssh$ vim config\n\n\n$HOME/.ssh/config\nHost [GITLAB_ON_DOCKER_HOST]\n User git\n Hostname [GITLAB_ON_DOCKER_HOST]\n Port [DOCKER_HOST_PORT_MAPPED_GITLAB_PORT_22]\n IdentityFile ~/.ssh/id_rsa\n\n\n\u203b[GITLAB_ON_DOCKER_HOST]\u3001[DOCKER_HOST_PORT_MAPPED_GITLAB_PORT_22]\u306f\u9069\u5b9c\u4fee\u6b63\u3057\u3066\u4e0b\u3055\u3044\u3002\n\u203b[DOCKER_HOST_PORT_MAPPED_GITLAB_PORT_22]\u306f\u3053\u3053\u3067\u306f10022\u3067\u3059\u3002\uff08\u4e0a\u8ff0\u306eGitLab\u30b3\u30f3\u30c6\u30ca\u4f5c\u6210\u6642\u3092\u53c2\u7167\uff09\n\u5f8c\u307b\u3069\u3001GitLab\u306b\u767b\u9332\u3059\u308b\u305f\u3081\u3001id_rsa.pub\u3092\u63a7\u3048\u3066\u304a\u304d\u307e\u3059\u3002\njenkins@3fbc958b8006:~/.ssh$ cat id_rsa.pub\n\njenkins@3fbc958b8006:~/.ssh$ git config --global user.email \"jenkins@test.com\"\njenkins@3fbc958b8006:~/.ssh$ git config --global user.name \"jenkins\"\n\n\u3053\u3053\u307e\u3067\u3067\u3001Jenkins\u30b3\u30f3\u30c6\u30ca\u5185\u3067\u306e\u4f5c\u696d\u306f\u7d42\u308f\u308a\u3067\u3059\u3002\n\u6b21\u306bJenkins\u306eWebUI\u306b\u3066\u3001\u5fc5\u8981\u306a\u30d7\u30e9\u30b0\u30a4\u30f3\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\nJenkins\u306e\u7ba1\u7406 \u21d2 \u30d7\u30e9\u30b0\u30a4\u30f3\u306e\u7ba1\u7406 \u21d2 \u5229\u7528\u53ef\u80fd\n\u304b\u3089\u300cGitlab Hook Plugin\u300d\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\n\n\nGitLab \u3078 Jenkins \u30e6\u30fc\u30b6\u30fc\u3092\u8ffd\u52a0\nGitLab\u306bAdmin\u6a29\u9650\u3092\u6301\u3064\u30e6\u30fc\u30b6\u30fc\u3067\u30ed\u30b0\u30a4\u30f3\u3057\u307e\u3059\u3002\nAdmin area \u21d2 New user\n\u304b\u3089jenkins\u30e6\u30fc\u30b6\u30fc\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\n\u203b\u30d1\u30b9\u30ef\u30fc\u30c9\u306f\u30e6\u30fc\u30b6\u30fc\u4f5c\u6210\u5f8c\u306b\u3001\u7de8\u96c6\u3067\u304d\u307e\u3059\u3002\n\u6b21\u306b\u3001Admin\u6a29\u9650\u3092\u6301\u3064\u30e6\u30fc\u30b6\u30fc\u3092\u30ed\u30b0\u30a2\u30a6\u30c8\u3057\u3066\u3001\u4f5c\u6210\u3057\u305fjenkins\u30e6\u30fc\u30b6\u30fc\u3067\u30ed\u30b0\u30a4\u30f3\u3057\u307e\u3059\u3002\nProfile settings \u21d2 SSH Keys \u21d2 Add SSH Key\n\u3092\u9078\u629e\u3057\u3001\u5148\u307b\u3069jenkins\u30b3\u30f3\u30c6\u30ca\u5185\u3067\u751f\u6210\u3057\u305fid_rsa.pub\u3092\u8a2d\u5b9a\u3057\u3066\u4e0b\u3055\u3044\u3002\n\n\u518d\u5ea6\u3001\u30ed\u30b0\u30a2\u30a6\u30c8\u3092\u3057\u3001Dockerfile_CI\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092\u4f5c\u6210\u3057\u305f\u30e6\u30fc\u30b6\u30fc\u3067\u30ed\u30b0\u30a4\u30f3\u3057\u307e\u3059\u3002\nProject\u306eSettings \u21d2 Members \u21d2 New project member\n\u3092\u9078\u629e\u3057\u3001jenkins\u30e6\u30fc\u30b6\u30fc\u3092\u8ffd\u52a0\u3057\u307e\u3059\u3002\n\n\u7d9a\u3044\u3066\u3001jenkins\u3078\u306eweb hook\u8a2d\u5b9a\u3092\u884c\u3044\u307e\u3059\u3002\nProject\u306eSettings \u21d2 Web Hooks\nhttp://[JENKINS_ON_DOCKER_HOST]:[DOCKER_HOST_PORT_MAPPED_JENKINS_PORT_8080]/job/Dockerfile_CI/build?delay=0sec\n\n\u203b[JENKINS_ON_DOCKER_HOST]:[DOCKER_HOST_PORT_MAPPED_JENKINS_PORT_8080]\u306f\u9069\u5b9c\u4fee\u6b63\u3057\u3066\u4e0b\u3055\u3044\u3002\n\u203b[DOCKER_HOST_PORT_MAPPED_JENKINS_PORT_8080]\u306f\u3053\u3053\u3067\u306f28080\u3067\u3059\u3002\uff08\u4e0a\u8ff0\u306eJenkins\u30b3\u30f3\u30c6\u30ca\u4f5c\u6210\u6642\u3092\u53c2\u7167\uff09\n\n\nJenkins \u306b\u3066\u30b8\u30e7\u30d6\u306e\u4f5c\u6210\n\u65b0\u898f\u30b8\u30e7\u30d6\u4f5c\u6210 \u21d2 \u30d5\u30ea\u30fc\u30b9\u30bf\u30a4\u30eb\u30fb\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306e\u30d3\u30eb\u30c9\n\u3092\u9078\u629e\u3057\u307e\u3059\u3002\uff08\u30b8\u30e7\u30d6\u540d\u306f\u4f55\u3067\u3082\u69cb\u3044\u307e\u305b\u3093\u3002\uff09\n\n\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u7ba1\u7406 \u21d2 Git \u21d2 Repositories \u21d2 Credentials \u21d2 Add\n\u3092\u9078\u629e\u3057\u3001\u30e6\u30fc\u30b6\u30fc\u540djenkins\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\nRepository URL\u306b\u306fGitLab\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306eSSH\u3092\u5165\u529b\u3057\u3066\u4e0b\u3055\u3044\u3002\n\u306a\u304a\u3001\u3053\u3053\u3067\u306f[DOCKER_HOST]\u3092\u66f8\u3044\u3066\u3044\u308b\u305f\u3081\u3001\u30a8\u30e9\u30fc\u3092\u51fa\u529b\u3057\u3066\u3044\u307e\u3059\u304c\u3001\u6b63\u3057\u3044GitLab\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306eSSH\u3092\u5165\u529b\u3059\u308b\u3053\u3068\u3067\u3001\u3053\u306e\u30a8\u30e9\u30fc\u306f\u51fa\u529b\u3055\u308c\u306a\u304f\u306a\u308a\u307e\u3059\u3002\n\n\u6700\u5f8c\u306b\n\u30d3\u30eb\u30c9\u30fb\u30c8\u30ea\u30ac \u21d2 SCM\u3092\u30dd\u30fc\u30ea\u30f3\u30b0 \u306b\u30c1\u30a7\u30c3\u30af\n\u30d3\u30eb\u30c9 \u21d2 \u30b7\u30a7\u30eb\u306e\u5b9f\u884c\n\n\njenkins_shell\nBASEURL='tcp://[DOCKER_HOST_B]:4243'\nVERSION='1.12'\n\nPATH=`pwd`\nREGISTRY='[DOCKER_HOST_A]:5000'\n\nfor f in *; do\n  if test $f = \"README.md\" ; then\n    continue\n  fi\n\n  WORKPATH=$PATH/$f\n  echo $WORKPATH\n  TAG='jenkins/'$f\n  echo $TAG\n  /usr/bin/python /var/workspace/dockerclient.py $WORKPATH $TAG $REGISTRY $BASEURL $VERSION\ndone\n\n\n\n\u901a\u77e5\u306e\u8a2d\u5b9a\n\u3053\u306e\u307e\u307e\u3067\u306f\u30d3\u30eb\u30c9\u5931\u6557\u6642\u306b\u4f55\u3082\u901a\u77e5\u3055\u308c\u307e\u305b\u3093\u3002\n\u4eca\u56de\u306fGmail\u3092\u5229\u7528\u3057\u305f\u901a\u77e5\u306e\u8a2d\u5b9a\u3092\u884c\u3044\u307e\u3059\u3002\nJenkins\u306e\u7ba1\u7406 \u21d2 \u30b7\u30b9\u30c6\u30e0\u306e\u8a2d\u5b9a \u21d2 Jenkins\u306e\u4f4d\u7f6e \u21d2 \u30b7\u30b9\u30c6\u30e0\u7ba1\u7406\u8005\u306e\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\n\n\u30b7\u30b9\u30c6\u30e0\u7ba1\u7406\u8005\u306e\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\uff1a xxx@gmail.com\n\n\nJenkins\u306e\u7ba1\u7406 \u21d2 \u30b7\u30b9\u30c6\u30e0\u306e\u8a2d\u5b9a \u21d2 E-mail \u901a\u77e5\n\nSMTP\u30b5\u30fc\u30d0\u30fc\uff1a smtp.gmail.com\nSMTP\u8a8d\u8a3c\u306b\u30c1\u30a7\u30c3\u30af\n\u30e6\u30fc\u30b6\u30fc\u540d\uff1a xxx@gmail.com\n\n\u30d1\u30b9\u30ef\u30fc\u30c9\uff1a xxxxxx\nSSL\u306b\u30c1\u30a7\u30c3\u30af\nSMTP\u30dd\u30fc\u30c8\uff1a 465\n\u6587\u5b57\u30bb\u30c3\u30c8\uff1a UTF-8\n\n\u4e0a\u8a18\u3092\u8a2d\u5b9a\u3057\u3001\u4fdd\u5b58\u3057\u307e\u3059\u3002\u7d9a\u3044\u3066\u3001\n\u30b8\u30e7\u30d6\u3092\u9078\u629e \u21d2 \u8a2d\u5b9a \u21d2 \u30d3\u30eb\u30c9\u5f8c\u306e\u51e6\u7406 \u21d2 E-mail\u901a\u77e5\n\n\u5b9b\u5148\uff1a hoge@gmail.com,fuga@gmail.com\n\n\n\u3053\u308c\u3067\u8a2d\u5b9a\u306f\u5168\u3066\u7d42\u4e86\u3067\u3059\u3002\n\nCI\u306e\u6d41\u308c\uff08\u4f8b\uff09\n\n\u30ed\u30fc\u30ab\u30eb\u3067Dockerfile\u3092\u4fee\u6b63\u3059\u308b\nGitLab\u3078push\u3059\u308b\nJenkins\u3067\u30d3\u30eb\u30c9\u7d50\u679c\u306e\u78ba\u8a8d\nprivate docker registry\u306bpush\u3055\u308c\u3066\u3044\u308b\u304b\u78ba\u8a8d\n\n\n\n\nbuild\u5931\u6557\u6642\u306f\u6b21\u306e\u3088\u3046\u306b\u306a\u308b\u3002\n\n\n\n\u88dc\u8db3\nWeb Hook\u306e\u90e8\u5206\u306fJenkins\u306e\u30d3\u30eb\u30c9\u5b9f\u884c\u3092\u305d\u306e\u307e\u307e\u53e9\u3044\u3066\u3044\u307e\u3059\u304c\u3001\u4e0b\u8a18\u306e\u3088\u3046\u306a\u8a2d\u5b9a\u65b9\u6cd5\u3082\u3042\u308a\u307e\u3059\u3002\nhttp://[JENKINS_ON_DOCKER_HOST]:[DOCKER_HOST_PORT_MAPPED_JENKINS_PORT_8080]/gitlab/build_now\n\n\u5143\u3005\u3053\u3061\u3089\u3092\u4f7f\u7528\u3059\u308b\u3064\u3082\u308a\u3067\u3057\u305f\u304c\u3001\u30dd\u30fc\u30c8\u306e\u6307\u5b9a\u304c\u7570\u306a\u308b\u305f\u3081\u304b\u3001\u3046\u307e\u304fWebHook\u304c\u901a\u3089\u306a\u3044\u306e\u3067\u3001\u4eca\u56de\u306f\u907f\u3051\u307e\u3057\u305f\u3002\n\n\u4eca\u5f8c\u306e\u8ab2\u984c\n\u4eca\u56de\u306e\u5b9f\u88c5\u3067\u306f\u3001conf\u30d5\u30a1\u30a4\u30eb\u306a\u3069\u3092\u8003\u616e\u3057\u3066\u3044\u307e\u305b\u3093\u3002\n\u305d\u306e\u305f\u3081\u3001Dockerfile\u3068\u540c\u968e\u5c64\u306b\u5225\u306e\u30d5\u30a1\u30a4\u30eb\u304c\u3042\u3063\u305f\u5834\u5408\u3001\u304a\u305d\u3089\u304f\u30a8\u30e9\u30fc\u306b\u306a\u308a\u307e\u3059\u3002\uff08\u672a\u78ba\u8a8d\uff09\n\u89e3\u6c7a\u7b56\u306fdockerclient.py\u5185\u3078\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u8fbc\u307f\u306ebuild\u3092\u8a18\u8ff0\u3059\u308b\u3053\u3068\u3068\u3001Jenkins\u30b7\u30a7\u30eb\u306e\u8a2d\u5b9a\u3092\u8ffd\u8a18\u3059\u308b\u3053\u3068\u3067\u3059\u304c\u3001\u305d\u3061\u3089\u306f\u307e\u3060\u672a\u5b9f\u88c5\u3067\u3059\u3002\n\n\u304a\u308f\u308a\u306b\n\u5c11\u3057\u9577\u304f\u306a\u3063\u3066\u3057\u307e\u3044\u307e\u3057\u305f\u304c\u3001\u6700\u5f8c\u307e\u3067\u304a\u8aad\u307f\u9802\u304d\u3001\u3042\u308a\u304c\u3068\u3046\u3054\u3056\u3044\u307e\u3057\u305f\u3002\n\u672c\u8a18\u4e8b\u306f[Docker Advent Calendar 2014](http://qiita.com/advent-calendar/2014/docker)\u306e27\u65e5\u76ee\u306e\u8a18\u4e8b\u3067\u3059\u3002\uff08\u5618\u3067\u3059\u300227\u65e5\u76ee\u306a\u3093\u3066\u3042\u308a\u307e\u305b\u3093\u3002\uff09\n\n# \u306f\u3058\u3081\u306b\n\u3053\u3053\u307e\u3067\u81ea\u5206\u304c\u6295\u7a3f\u3057\u305f\u8a18\u4e8b\u3092\u4f7f\u3063\u3066\u3001\u4e0b\u8a18\u304c\u4f5c\u308c\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3057\u305f\u3002\n\n* [private docker registry](http://qiita.com/DG0426/items/b8006c3168e245628005)\n* [GitLab](http://qiita.com/DG0426/items/b63520e0e63a6c1efe70)\n* [Jenkins](http://qiita.com/DG0426/items/dc502b4fb795fde73de2)\n\n\u3053\u308c\u3089\u3092\u5229\u7528\u3057\u3066\u3001private Docker Hub \u3092\u4f5c\u3063\u3066\u307f\u307e\u3059\u3002\n\n# \u4eca\u56de\u4f5c\u6210\u3059\u308b private Docker Hub \u306e\u4ed5\u7d44\u307f\n* \u30ed\u30fc\u30ab\u30eb\u3067\u4f5c\u6210\u3057\u305fDockerfile\u3092GitLab\u306bpush\n* GitLab\u304b\u3089WebHook\u3067Jenkins\u306b\u901a\u77e5\n* Jenkins\u306b\u3066Dockerfile\u3092\u30d3\u30eb\u30c9\n * Jenkins\u306fdocker\u30b3\u30f3\u30c6\u30ca\u3067\u8d77\u52d5\u3057\u3066\u3044\u308b\n * Jenkins\u30b3\u30f3\u30c6\u30ca\u5185\u3067Dockerfile\u3092\u30d3\u30eb\u30c9\u3057\u3066\u3044\u308b\u308f\u3051\u3067\u306f\u306a\u3044\n * \u30db\u30b9\u30c8\u306edockerAPI\uff08docker-py\u7d4c\u7531\uff09\u3092\u5229\u7528\u3057\u3066\u3044\u308b\n* docker build\n * \u6210\u529f\u3057\u305f\u5834\u5408\u3001private registry\u306bpush\n * \u5931\u6557\u3057\u305f\u5834\u5408\u3001Gmail\u306b\u901a\u77e5\u3092\u884c\u3046\n\n# \u74b0\u5883\n* OS: Ubuntu14.04\n* docker version: 1.4.1\n* /etc/default/docker\u306b[\u3053\u3061\u3089](http://qiita.com/DG0426/items/14d006cf6ffcb290c9fb)\u306e\u8a2d\u5b9a\u3092\u884c\u3046\n* \u4e0a\u8a18\u30db\u30b9\u30c8\u30922\u53f0\u7528\u610f\n\n\u4e0b\u8a18\u306e\u3088\u3046\u306a\u69cb\u6210\u3092\u76ee\u6307\u3057\u307e\u3059\u3002(\u5168\u3066docker\u30b3\u30f3\u30c6\u30ca\u3067\u3059\u3002)\n\n* \u30db\u30b9\u30c8A\n * private dockcer registry\n * private dockcer registry(Web UI)\n* \u30db\u30b9\u30c8B\n * GitLab\n * Jenkins\n\n\u30ed\u30fc\u30ab\u30ebGit\u30ea\u30dd\u30b8\u30c8\u30ea\u306f\u4e0b\u8a18\u306e\u3088\u3046\u306a\u69cb\u6210\u306b\u3059\u308b\u3053\u3068\n\n* ubuntu1404_test\n * Dockerfile\n* hoge\n * Dockerfile\n* fuga\n * Dockerfile\n\n# \u8a2d\u5b9a\uff08\u30db\u30b9\u30c8A\uff09\n## private dockcer registry\n\u4e0b\u8a18\u3092\u53c2\u8003\u306bregistry\u30b3\u30f3\u30c6\u30ca\u3092\u7528\u610f\u3057\u307e\u3059\u3002\n\n* [private docker registry \u3092\u4f7f\u3063\u3066\u307f\u308b](http://qiita.com/DG0426/items/b8006c3168e245628005)\n* [\u7d9a\uff1aprivate docker registry \u3092\u4f7f\u3063\u3066\u307f\u308b(WebUI)](http://qiita.com/DG0426/items/1f250791a0d5d74306f3)\n\n```bash\n$ sudo docker ps\nIMAGE                                        PORTS\nkonradkleine/docker-registry-frontend:latest 443/tcp, 0.0.0.0:8080->80/tcp\nregistry:latest                              0.0.0.0:5000->5000/tcp\n```\n\u203bCONTAINER ID\u306a\u3069\u306f\u7701\u7565\n\n# \u8a2d\u5b9a\uff08\u30db\u30b9\u30c8B\uff09\n## GitLab \u521d\u671f\u8a2d\u5b9a\n\u4e0b\u8a18\u3092\u53c2\u8003\u306bGitLab\u30b3\u30f3\u30c6\u30ca\u3092\u7528\u610f\u3057\u307e\u3059\u3002\n\n* [GitLab in docker \u3067LDAP\u8a8d\u8a3c\u3092\u5229\u7528\u3059\u308b](http://qiita.com/DG0426/items/b63520e0e63a6c1efe70)\n\n```bash\n$ sudo docker ps\nIMAGE                   PORTS                                                   NAMES\nsameersbn/gitlab:latest 443/tcp, 0.0.0.0:10022->22/tcp, 0.0.0.0:10080->80/tcp   hungry_ardinghelli\nsameersbn/mysql:latest  3306/tcp                                                gitlab-mysql\nsameersbn/redis:latest  6379/tcp                                                gitlab-redis\n```\n\u203bCONTAINER ID\u306a\u3069\u306f\u7701\u7565\n\nGitLab\u306b\u30ed\u30b0\u30a4\u30f3\u5f8c\u3001\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092\u4f5c\u6210\u3057\u3001\u30ed\u30fc\u30ab\u30eb\u3068\u9023\u643a\u3057\u307e\u3059\u3002\n\u306a\u304a\u3001ubuntu1404_test\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306e\u4e2d\u306b\u306f\u7c21\u5358\u306aDockerfile\u304c\u5165\u3063\u3066\u3044\u307e\u3059\u3002\n\u203b\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u540d\u3092\u30a4\u30e1\u30fc\u30b8\u30bf\u30b0\u306b\u4f7f\u7528\u3059\u308b\u306e\u3067\u3001\u91cd\u8907\u306a\u3069\u3057\u306a\u3044\u3088\u3046\u306b\u6ce8\u610f\u3057\u3066\u4e0b\u3055\u3044\u3002\n\n![gitlab001.png](https://qiita-image-store.s3.amazonaws.com/0/58725/aa03e5dc-465f-87cc-c427-86c13071f2f7.png)\n\n![gitlab002.png](https://qiita-image-store.s3.amazonaws.com/0/58725/c04f96ba-9a34-1191-f08f-b6b1713df257.png)\n\n## Jenkins \u521d\u671f\u8a2d\u5b9a\n\u4e0b\u8a18\u3092\u53c2\u8003\u306b\u3057\u3064\u3064\u3001\u5fc5\u8981\u306a\u30e2\u30b8\u30e5\u30fc\u30eb\u3092\u8ffd\u52a0\u3057\u305fJenkins\u30b3\u30f3\u30c6\u30ca\u3092\u7528\u610f\u3057\u307e\u3059\u3002\n\n* [doragon/Dockerfile/debian/8.0/jenkins/](https://github.com/doragon/Dockerfile/tree/master/debian/8.0/jenkins)\n\n```bash\n$ sudo git clone https://github.com/doragon/Dockerfile.git\n$ sudo mv Dockerfile/debian/8.0/jenkins/ ./\n$ sudo rm -rf Dockerfile\n$ cd jenkins/\n$ mkdir jenkins_home\n$ chmod 777 jenkins_home\n```\n\n```bash\n$ sudo docker build -t koide/jenkins .\n\n$ sudo docker run -p 28080:8080 -d \\\n -v [PATH]/jenkins/jenkins_home:/var/jenkins_home \\\n -v [PATH]/jenkins/workspace:/var/workspace \\\n koide/jenkins\n\n$ sudo docker ps\nIMAGE                PORTS\nkoide/jenkins:latest 50000/tcp, 0.0.0.0:28080->8080/tcp\n```\n\n\u3053\u3053\u3067\u3001GitLab\u3068\u9023\u643a\u3092\u884c\u3046\u305f\u3081\u3001jenkins\u30e6\u30fc\u30b6\u30fc\u306e\u500b\u5225\u8a2d\u5b9a\u3092\u884c\u3044\u307e\u3059\u3002\n\u203b\u672c\u6765\u306a\u3089Dockerfile\u3067\u5b8c\u7d50\u3059\u3079\u304d\u306a\u306e\u3067\u3059\u304c\u3001root\u30e6\u30fc\u30b6\u30fc\u4ee5\u5916\u3067\u306e\u6a29\u9650\u8a2d\u5b9a\u304c\u3046\u307e\u304f\u3044\u304b\u306a\u3044\u305f\u3081\u30b3\u30f3\u30c6\u30ca\u5185\u3067\u4f5c\u696d\u3092\u884c\u3044\u307e\u3059\u3002\n\n```bash\n$ sudo docker exec -it 3fbc958b8006 bash\njenkins@3fbc958b8006:/$\njenkins@3fbc958b8006:/$ cd\njenkins@3fbc958b8006:~$ pwd\n/var/jenkins_home\n\njenkins@3fbc958b8006:~$ mkdir .ssh\njenkins@3fbc958b8006:~$ cd .ssh\njenkins@3fbc958b8006:~/.ssh$ ssh-keygen -t rsa -f id_rsa -C \"jenkins@test.com\" -N \"\"\njenkins@3fbc958b8006:~/.ssh$ chmod 744 $HOME/.ssh\njenkins@3fbc958b8006:~/.ssh$ chmod 700 $HOME/.ssh/id_rsa\njenkins@3fbc958b8006:~/.ssh$ vim config\n```\n\n```conf:$HOME/.ssh/config\nHost [GITLAB_ON_DOCKER_HOST]\n User git\n Hostname [GITLAB_ON_DOCKER_HOST]\n Port [DOCKER_HOST_PORT_MAPPED_GITLAB_PORT_22]\n IdentityFile ~/.ssh/id_rsa\n```\n\u203b[GITLAB_ON_DOCKER_HOST]\u3001[DOCKER_HOST_PORT_MAPPED_GITLAB_PORT_22]\u306f\u9069\u5b9c\u4fee\u6b63\u3057\u3066\u4e0b\u3055\u3044\u3002\n\u203b[DOCKER_HOST_PORT_MAPPED_GITLAB_PORT_22]\u306f\u3053\u3053\u3067\u306f10022\u3067\u3059\u3002\uff08\u4e0a\u8ff0\u306eGitLab\u30b3\u30f3\u30c6\u30ca\u4f5c\u6210\u6642\u3092\u53c2\u7167\uff09\n\n\u5f8c\u307b\u3069\u3001GitLab\u306b\u767b\u9332\u3059\u308b\u305f\u3081\u3001id_rsa.pub\u3092\u63a7\u3048\u3066\u304a\u304d\u307e\u3059\u3002\n\n```bash\njenkins@3fbc958b8006:~/.ssh$ cat id_rsa.pub\n```\n\n```bash\njenkins@3fbc958b8006:~/.ssh$ git config --global user.email \"jenkins@test.com\"\njenkins@3fbc958b8006:~/.ssh$ git config --global user.name \"jenkins\"\n```\n\n\u3053\u3053\u307e\u3067\u3067\u3001Jenkins\u30b3\u30f3\u30c6\u30ca\u5185\u3067\u306e\u4f5c\u696d\u306f\u7d42\u308f\u308a\u3067\u3059\u3002\n\u6b21\u306bJenkins\u306eWebUI\u306b\u3066\u3001\u5fc5\u8981\u306a\u30d7\u30e9\u30b0\u30a4\u30f3\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\nJenkins\u306e\u7ba1\u7406 \u21d2 \u30d7\u30e9\u30b0\u30a4\u30f3\u306e\u7ba1\u7406 \u21d2 \u5229\u7528\u53ef\u80fd\n\u304b\u3089\u300cGitlab Hook Plugin\u300d\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\n\n![jenkins001.png](https://qiita-image-store.s3.amazonaws.com/0/58725/ebf500b7-5271-c691-7642-5c80198215c5.png)\n\n## GitLab \u3078 Jenkins \u30e6\u30fc\u30b6\u30fc\u3092\u8ffd\u52a0\nGitLab\u306bAdmin\u6a29\u9650\u3092\u6301\u3064\u30e6\u30fc\u30b6\u30fc\u3067\u30ed\u30b0\u30a4\u30f3\u3057\u307e\u3059\u3002\nAdmin area \u21d2 New user\n\u304b\u3089jenkins\u30e6\u30fc\u30b6\u30fc\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\n![gitlab003.png](https://qiita-image-store.s3.amazonaws.com/0/58725/d727a720-0de5-be10-5d18-9a9467f1527e.png)\n\n\u203b\u30d1\u30b9\u30ef\u30fc\u30c9\u306f\u30e6\u30fc\u30b6\u30fc\u4f5c\u6210\u5f8c\u306b\u3001\u7de8\u96c6\u3067\u304d\u307e\u3059\u3002\n\n\u6b21\u306b\u3001Admin\u6a29\u9650\u3092\u6301\u3064\u30e6\u30fc\u30b6\u30fc\u3092\u30ed\u30b0\u30a2\u30a6\u30c8\u3057\u3066\u3001\u4f5c\u6210\u3057\u305fjenkins\u30e6\u30fc\u30b6\u30fc\u3067\u30ed\u30b0\u30a4\u30f3\u3057\u307e\u3059\u3002\nProfile settings \u21d2 SSH Keys \u21d2 Add SSH Key\n\u3092\u9078\u629e\u3057\u3001\u5148\u307b\u3069jenkins\u30b3\u30f3\u30c6\u30ca\u5185\u3067\u751f\u6210\u3057\u305fid_rsa.pub\u3092\u8a2d\u5b9a\u3057\u3066\u4e0b\u3055\u3044\u3002\n\n![gitlab004.png](https://qiita-image-store.s3.amazonaws.com/0/58725/547aaa2b-1ece-7663-7500-32fe0b0f04a7.png)\n\n\u518d\u5ea6\u3001\u30ed\u30b0\u30a2\u30a6\u30c8\u3092\u3057\u3001Dockerfile_CI\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092\u4f5c\u6210\u3057\u305f\u30e6\u30fc\u30b6\u30fc\u3067\u30ed\u30b0\u30a4\u30f3\u3057\u307e\u3059\u3002\nProject\u306eSettings \u21d2 Members \u21d2 New project member\n\u3092\u9078\u629e\u3057\u3001jenkins\u30e6\u30fc\u30b6\u30fc\u3092\u8ffd\u52a0\u3057\u307e\u3059\u3002\n\n![gitlab005.png](https://qiita-image-store.s3.amazonaws.com/0/58725/0b02877b-5e33-ffad-db0d-e1bf23687318.png)\n\n\u7d9a\u3044\u3066\u3001jenkins\u3078\u306eweb hook\u8a2d\u5b9a\u3092\u884c\u3044\u307e\u3059\u3002\nProject\u306eSettings \u21d2 Web Hooks\n\n```URL\nhttp://[JENKINS_ON_DOCKER_HOST]:[DOCKER_HOST_PORT_MAPPED_JENKINS_PORT_8080]/job/Dockerfile_CI/build?delay=0sec\n```\n\n\u203b[JENKINS_ON_DOCKER_HOST]:[DOCKER_HOST_PORT_MAPPED_JENKINS_PORT_8080]\u306f\u9069\u5b9c\u4fee\u6b63\u3057\u3066\u4e0b\u3055\u3044\u3002\n\u203b[DOCKER_HOST_PORT_MAPPED_JENKINS_PORT_8080]\u306f\u3053\u3053\u3067\u306f28080\u3067\u3059\u3002\uff08\u4e0a\u8ff0\u306eJenkins\u30b3\u30f3\u30c6\u30ca\u4f5c\u6210\u6642\u3092\u53c2\u7167\uff09\n\n![gitlab007.png](https://qiita-image-store.s3.amazonaws.com/0/58725/8dd93763-178d-47c1-e443-6dafa87cfc38.png)\n\n## Jenkins \u306b\u3066\u30b8\u30e7\u30d6\u306e\u4f5c\u6210\n\u65b0\u898f\u30b8\u30e7\u30d6\u4f5c\u6210 \u21d2 \u30d5\u30ea\u30fc\u30b9\u30bf\u30a4\u30eb\u30fb\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306e\u30d3\u30eb\u30c9\n\u3092\u9078\u629e\u3057\u307e\u3059\u3002\uff08\u30b8\u30e7\u30d6\u540d\u306f\u4f55\u3067\u3082\u69cb\u3044\u307e\u305b\u3093\u3002\uff09\n\n![jenkins002.png](https://qiita-image-store.s3.amazonaws.com/0/58725/edf11d82-a4bb-c351-d3af-d67e58b3f358.png)\n\n\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u7ba1\u7406 \u21d2 Git \u21d2 Repositories \u21d2 Credentials \u21d2 Add\n\u3092\u9078\u629e\u3057\u3001\u30e6\u30fc\u30b6\u30fc\u540djenkins\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\n![jenkins003.png](https://qiita-image-store.s3.amazonaws.com/0/58725/ec722672-a755-e7c8-d21a-d90327892cab.png)\n\nRepository URL\u306b\u306fGitLab\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306eSSH\u3092\u5165\u529b\u3057\u3066\u4e0b\u3055\u3044\u3002\n\u306a\u304a\u3001\u3053\u3053\u3067\u306f[DOCKER_HOST]\u3092\u66f8\u3044\u3066\u3044\u308b\u305f\u3081\u3001\u30a8\u30e9\u30fc\u3092\u51fa\u529b\u3057\u3066\u3044\u307e\u3059\u304c\u3001\u6b63\u3057\u3044GitLab\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306eSSH\u3092\u5165\u529b\u3059\u308b\u3053\u3068\u3067\u3001\u3053\u306e\u30a8\u30e9\u30fc\u306f\u51fa\u529b\u3055\u308c\u306a\u304f\u306a\u308a\u307e\u3059\u3002\n\n![jenkins004.png](https://qiita-image-store.s3.amazonaws.com/0/58725/85fff63e-f6d9-02e5-0339-907b39450f09.png)\n\n\u6700\u5f8c\u306b\n\u30d3\u30eb\u30c9\u30fb\u30c8\u30ea\u30ac \u21d2 SCM\u3092\u30dd\u30fc\u30ea\u30f3\u30b0 \u306b\u30c1\u30a7\u30c3\u30af\n\u30d3\u30eb\u30c9 \u21d2 \u30b7\u30a7\u30eb\u306e\u5b9f\u884c\n\n![jenkins005.png](https://qiita-image-store.s3.amazonaws.com/0/58725/4da31f7b-5237-552a-45e5-ee2f3b315727.png)\n\n\n```bash:jenkins_shell\nBASEURL='tcp://[DOCKER_HOST_B]:4243'\nVERSION='1.12'\n\nPATH=`pwd`\nREGISTRY='[DOCKER_HOST_A]:5000'\n\nfor f in *; do\n  if test $f = \"README.md\" ; then\n    continue\n  fi\n\n  WORKPATH=$PATH/$f\n  echo $WORKPATH\n  TAG='jenkins/'$f\n  echo $TAG\n  /usr/bin/python /var/workspace/dockerclient.py $WORKPATH $TAG $REGISTRY $BASEURL $VERSION\ndone\n```\n\n## \u901a\u77e5\u306e\u8a2d\u5b9a\n\n\u3053\u306e\u307e\u307e\u3067\u306f\u30d3\u30eb\u30c9\u5931\u6557\u6642\u306b\u4f55\u3082\u901a\u77e5\u3055\u308c\u307e\u305b\u3093\u3002\n\u4eca\u56de\u306fGmail\u3092\u5229\u7528\u3057\u305f\u901a\u77e5\u306e\u8a2d\u5b9a\u3092\u884c\u3044\u307e\u3059\u3002\n\nJenkins\u306e\u7ba1\u7406 \u21d2 \u30b7\u30b9\u30c6\u30e0\u306e\u8a2d\u5b9a \u21d2 Jenkins\u306e\u4f4d\u7f6e \u21d2 \u30b7\u30b9\u30c6\u30e0\u7ba1\u7406\u8005\u306e\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\n\n* \u30b7\u30b9\u30c6\u30e0\u7ba1\u7406\u8005\u306e\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\uff1a xxx@gmail.com\n\nJenkins\u306e\u7ba1\u7406 \u21d2 \u30b7\u30b9\u30c6\u30e0\u306e\u8a2d\u5b9a \u21d2 E-mail \u901a\u77e5\n\n* SMTP\u30b5\u30fc\u30d0\u30fc\uff1a smtp.gmail.com\n* SMTP\u8a8d\u8a3c\u306b\u30c1\u30a7\u30c3\u30af\n* \u30e6\u30fc\u30b6\u30fc\u540d\uff1a xxx@gmail.com\n* \u30d1\u30b9\u30ef\u30fc\u30c9\uff1a xxxxxx\n* SSL\u306b\u30c1\u30a7\u30c3\u30af\n* SMTP\u30dd\u30fc\u30c8\uff1a 465\n* \u6587\u5b57\u30bb\u30c3\u30c8\uff1a UTF-8\n\n\u4e0a\u8a18\u3092\u8a2d\u5b9a\u3057\u3001\u4fdd\u5b58\u3057\u307e\u3059\u3002\u7d9a\u3044\u3066\u3001\n\n\u30b8\u30e7\u30d6\u3092\u9078\u629e \u21d2 \u8a2d\u5b9a \u21d2 \u30d3\u30eb\u30c9\u5f8c\u306e\u51e6\u7406 \u21d2 E-mail\u901a\u77e5\n\n* \u5b9b\u5148\uff1a hoge@gmail.com,fuga@gmail.com\n\n\u3053\u308c\u3067\u8a2d\u5b9a\u306f\u5168\u3066\u7d42\u4e86\u3067\u3059\u3002\n\n# CI\u306e\u6d41\u308c\uff08\u4f8b\uff09\n\n* \u30ed\u30fc\u30ab\u30eb\u3067Dockerfile\u3092\u4fee\u6b63\u3059\u308b\n* GitLab\u3078push\u3059\u308b\n* Jenkins\u3067\u30d3\u30eb\u30c9\u7d50\u679c\u306e\u78ba\u8a8d\n* private docker registry\u306bpush\u3055\u308c\u3066\u3044\u308b\u304b\u78ba\u8a8d\n\n![gitlab008.png](https://qiita-image-store.s3.amazonaws.com/0/58725/e58a0db1-1fc0-7a0f-f32f-f839cd5b4cc5.png)\n\n![jenkins006.png](https://qiita-image-store.s3.amazonaws.com/0/58725/960ab361-9f10-9d5c-1649-b6512c5b7cd7.png)\n\n![registry001.png](https://qiita-image-store.s3.amazonaws.com/0/58725/36603592-ef5f-ae16-3c48-bbc20c3abf33.png)\n\nbuild\u5931\u6557\u6642\u306f\u6b21\u306e\u3088\u3046\u306b\u306a\u308b\u3002\n\n![jenkins007.png](https://qiita-image-store.s3.amazonaws.com/0/58725/00684148-1dec-ccff-bdaf-0bd555632a0a.png)\n\n![gmail0001.png](https://qiita-image-store.s3.amazonaws.com/0/58725/9792f070-aba5-a251-f497-041f033b45ad.png)\n\n\n# \u88dc\u8db3\nWeb Hook\u306e\u90e8\u5206\u306fJenkins\u306e\u30d3\u30eb\u30c9\u5b9f\u884c\u3092\u305d\u306e\u307e\u307e\u53e9\u3044\u3066\u3044\u307e\u3059\u304c\u3001\u4e0b\u8a18\u306e\u3088\u3046\u306a\u8a2d\u5b9a\u65b9\u6cd5\u3082\u3042\u308a\u307e\u3059\u3002\n\n```bash\nhttp://[JENKINS_ON_DOCKER_HOST]:[DOCKER_HOST_PORT_MAPPED_JENKINS_PORT_8080]/gitlab/build_now\n```\n\n\u5143\u3005\u3053\u3061\u3089\u3092\u4f7f\u7528\u3059\u308b\u3064\u3082\u308a\u3067\u3057\u305f\u304c\u3001\u30dd\u30fc\u30c8\u306e\u6307\u5b9a\u304c\u7570\u306a\u308b\u305f\u3081\u304b\u3001\u3046\u307e\u304fWebHook\u304c\u901a\u3089\u306a\u3044\u306e\u3067\u3001\u4eca\u56de\u306f\u907f\u3051\u307e\u3057\u305f\u3002\n\n# \u4eca\u5f8c\u306e\u8ab2\u984c\n\u4eca\u56de\u306e\u5b9f\u88c5\u3067\u306f\u3001conf\u30d5\u30a1\u30a4\u30eb\u306a\u3069\u3092\u8003\u616e\u3057\u3066\u3044\u307e\u305b\u3093\u3002\n\u305d\u306e\u305f\u3081\u3001Dockerfile\u3068\u540c\u968e\u5c64\u306b\u5225\u306e\u30d5\u30a1\u30a4\u30eb\u304c\u3042\u3063\u305f\u5834\u5408\u3001\u304a\u305d\u3089\u304f\u30a8\u30e9\u30fc\u306b\u306a\u308a\u307e\u3059\u3002\uff08\u672a\u78ba\u8a8d\uff09\n\n\u89e3\u6c7a\u7b56\u306fdockerclient.py\u5185\u3078\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u8fbc\u307f\u306ebuild\u3092\u8a18\u8ff0\u3059\u308b\u3053\u3068\u3068\u3001Jenkins\u30b7\u30a7\u30eb\u306e\u8a2d\u5b9a\u3092\u8ffd\u8a18\u3059\u308b\u3053\u3068\u3067\u3059\u304c\u3001\u305d\u3061\u3089\u306f\u307e\u3060\u672a\u5b9f\u88c5\u3067\u3059\u3002\n\n# \u304a\u308f\u308a\u306b\n\u5c11\u3057\u9577\u304f\u306a\u3063\u3066\u3057\u307e\u3044\u307e\u3057\u305f\u304c\u3001\u6700\u5f8c\u307e\u3067\u304a\u8aad\u307f\u9802\u304d\u3001\u3042\u308a\u304c\u3068\u3046\u3054\u3056\u3044\u307e\u3057\u305f\u3002\n", "tags": ["Ubuntu14.04", "docker1.4.1", "Jenkins", "GitLab"]}