{"tags": ["python2.7"], "context": "\u4ed5\u4e8b\u306e\u5408\u9593\u306b\u3001\u52c9\u5f37\u304c\u3066\u3089\u306b\u3001Python\u3067Gmial\u304b\u3089\u30e1\u30fc\u30eb\u9001\u4fe1\u3002\nhttp://d.hatena.ne.jp/kenpy/20101123/1290499799\n\u53c2\u8003\u306b\u3057\u305f\u306e\u306f\u3053\u3061\u3089\u3002\u3068\u3044\u3046\u304b\u307b\u307c\u5199\u7d4c\u3067\u3059\u3002\n#!/Usr/bin/env python                                                                                  \n# -*- coding: utf-8 -*-  \n\nimport os.path\nimport datetime\nimport smtplib\n\nfrom email import Encoders\nfrom email.MIMEBase import MIMEBase\nfrom email.MIMEMultipart import MIMEMultipart\nfrom email.MIMEText import MIMEText\n\ndef create_message(from_addr, to_addr, subject, body, mine, attach_file):\n    \"\"\"\n    Mail\u306e\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u69cb\u7bc9\u3059\u308b\n    \"\"\"\n    msg = MIMEMultipart()\n    msg[\"Subject\"] = subject\n    msg[\"From\"] = from_addr\n    msg[\"To\"] = to_addr\n\n\n    body = MIMEText(body)\n    msg.attach(body)\n\n    #\u6dfb\u4ed8\u30d5\u30a1\u30a4\u30eb\u306eMIME\u30bf\u30a4\u30d7\u3092\u6307\u5b9a\u3059\u308b\n    attachment = MIMEBase(mine['type'],mine['subtype'])\n\n    file = open(attach_file['path'])\n    attachment.set_payload(file.read())\n    file.close()\n    Encoders.encode_base64(attachment)\n    msg.attach(attachment)\n    attachment.add_header(\"Content-Dispositon\",\"attachment\",filename=attach_file['name'])\n\n    return msg\n\ndef sendGmail(from_addr, to_addr, msg):\n    \"\"\"\n    mail\u3092\u9001\u4fe1\u3059\u308b\n    \"\"\"\n    smtp = smtplib.SMTP_SSL(host, port)\n    smtp.ehlo()\n    smtp.login(username, password)\n    smtp.sendmail(from_addr, to_addr, msg.as_string())\n    smtp.quit()\n\n\nif __name__ == '__main__':\n\n    #gmail\u7528\u306b\u8ffd\u52a0\n    host, port = 'smtp.gmail.com', XXX\n    username, password = 'hogehoge@gmail.com', 'hogehoge'\n\n#\u5b9f\u969b\u306b\u4f7f\u7528\u3055\u308c\u3066\u3044\u308b\u30a2\u30c9\u30ec\u30b9\u3060\u3068\u56f0\u308b\u306e\u3067\u3001\u30b3\u30e1\u30f3\u30c8\u30a2\u30a6\u30c8\u3057\u3066\u307e\u3059\u3002\n\n    from_addr = #\"hogehoge@gmail.com\u201d\n    to_addr = #\"hogehoge@gmail.com\"\n    subject = \"\u30d5\u30a1\u30a4\u30eb\u6dfb\u4ed8\"\n    body = \"test body\"\n    mine={'type':'text','subtype':'comma-separated-values'}\n\n    attach_file={'name':'test.csv','path':'/tmp/test.csv'}\n    msg = create_message(from_addr, to_addr, subject, body, mine, attach_file)\n    sendGmail(from_addr, to_addr, msg)\n\n\n\u4ed5\u4e8b\u306e\u5408\u9593\u306b\u3001\u52c9\u5f37\u304c\u3066\u3089\u306b\u3001Python\u3067Gmial\u304b\u3089\u30e1\u30fc\u30eb\u9001\u4fe1\u3002\n\nhttp://d.hatena.ne.jp/kenpy/20101123/1290499799\n\u53c2\u8003\u306b\u3057\u305f\u306e\u306f\u3053\u3061\u3089\u3002\u3068\u3044\u3046\u304b\u307b\u307c\u5199\u7d4c\u3067\u3059\u3002\n\n```Python\n#!/Usr/bin/env python                                                                                  \n# -*- coding: utf-8 -*-  \n\nimport os.path\nimport datetime\nimport smtplib\n\nfrom email import Encoders\nfrom email.MIMEBase import MIMEBase\nfrom email.MIMEMultipart import MIMEMultipart\nfrom email.MIMEText import MIMEText\n\ndef create_message(from_addr, to_addr, subject, body, mine, attach_file):\n\t\"\"\"\n\tMail\u306e\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u69cb\u7bc9\u3059\u308b\n\t\"\"\"\n\tmsg = MIMEMultipart()\n\tmsg[\"Subject\"] = subject\n\tmsg[\"From\"] = from_addr\n\tmsg[\"To\"] = to_addr\n\n\t\n\tbody = MIMEText(body)\n\tmsg.attach(body)\n\t\n\t#\u6dfb\u4ed8\u30d5\u30a1\u30a4\u30eb\u306eMIME\u30bf\u30a4\u30d7\u3092\u6307\u5b9a\u3059\u308b\n\tattachment = MIMEBase(mine['type'],mine['subtype'])\n\t\n\tfile = open(attach_file['path'])\n\tattachment.set_payload(file.read())\n\tfile.close()\n\tEncoders.encode_base64(attachment)\n\tmsg.attach(attachment)\n\tattachment.add_header(\"Content-Dispositon\",\"attachment\",filename=attach_file['name'])\n\t\n\treturn msg\n\t\ndef sendGmail(from_addr, to_addr, msg):\n\t\"\"\"\n\tmail\u3092\u9001\u4fe1\u3059\u308b\n\t\"\"\"\n\tsmtp = smtplib.SMTP_SSL(host, port)\n\tsmtp.ehlo()\n\tsmtp.login(username, password)\n\tsmtp.sendmail(from_addr, to_addr, msg.as_string())\n\tsmtp.quit()\n\t\n\t\nif __name__ == '__main__':\n\t\n\t#gmail\u7528\u306b\u8ffd\u52a0\n\thost, port = 'smtp.gmail.com', XXX\n\tusername, password = 'hogehoge@gmail.com', 'hogehoge'\n\t\n#\u5b9f\u969b\u306b\u4f7f\u7528\u3055\u308c\u3066\u3044\u308b\u30a2\u30c9\u30ec\u30b9\u3060\u3068\u56f0\u308b\u306e\u3067\u3001\u30b3\u30e1\u30f3\u30c8\u30a2\u30a6\u30c8\u3057\u3066\u307e\u3059\u3002\n\t\n\tfrom_addr = #\"hogehoge@gmail.com\u201d\n\tto_addr = #\"hogehoge@gmail.com\"\n\tsubject = \"\u30d5\u30a1\u30a4\u30eb\u6dfb\u4ed8\"\n\tbody = \"test body\"\n\tmine={'type':'text','subtype':'comma-separated-values'}\n\t\n\tattach_file={'name':'test.csv','path':'/tmp/test.csv'}\n\tmsg = create_message(from_addr, to_addr, subject, body, mine, attach_file)\n\tsendGmail(from_addr, to_addr, msg)\n```\n"}