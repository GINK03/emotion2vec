{"context": " More than 1 year has passed since last update.\n\n\u306f\u3058\u3081\u306b\n\u30b5\u30fc\u30d0\u30fc\u3092\u7acb\u3066\u308b\u307e\u3067\u3082\u306a\u304f\u3061\u3087\u3063\u3068\u3057\u305f\u901a\u77e5\u3092\u5b9f\u88c5\u3057\u305f\u3044\u3068\u601d\u3063\u305f\u6642\u306b\u4f5c\u3063\u305f\u3084\u3064\u3067\u3059.\n\u30c7\u30fc\u30bf\u306e\u53d7\u3051\u53d6\u308a\u304c\u306a\u304f\u3001\u9001\u4fe1\u306e\u307f\u3067\u3042\u308c\u3070\u3068\u308a\u3042\u3048\u305a\u4ee5\u4e0b\u306e\u5b9f\u88c5\u3067 OK .\n\u30c7\u30fc\u30bf\u3092\u8caf\u3081\u305f\u3044\u5834\u5408\u3082\u3044\u308d\u3044\u308d\u3084\u308a\u65b9\u306f\u3042\u308b\u307f\u305f\u3044\u306a\u306e\u3067\u63a2\u305b\u3070\u3067\u3066\u304d\u307e\u3059 .\n\nSlack \u3068 Hipchat\n\u30c8\u30fc\u30af\u30f3\u3092\u767a\u884c\u3059\u308b.\n\nSlack Web API | Slack\nHipChat - API - Authentication\n\n\nGoogle Spread Sheet ( Google \u30b9\u30d7\u30ec\u30c3\u30c9\u30b7\u30fc\u30c8 )\n\n\u30b7\u30fc\u30c8\n\n\n\u30b9\u30af\u30ea\u30d7\u30c8\n\nstaff_manager.gs\n// \u5217\u3092\u5165\u308c\u66ff\u3048\u308b\u3053\u3068\u3067\u62c5\u5f53\u3092\u5909\u66f4\u3059\u308b.\nfunction staff_manager() {\n  var spreadSheet = SpreadsheetApp.openByUrl('{Google \u30b9\u30d7\u30ec\u30c3\u30c9\u30b7\u30fc\u30c8\u306e URL}');\n\n  var sheet = spreadSheet.getSheets()[0];\n\n  sheet.insertRowAfter(sheet.getMaxRows());\n\n  var firstRow = sheet.getRange(2, 1, 1, 8);\n\n  var values = firstRow.getValues();\n\n  sheet.getRange(sheet.getMaxRows(), 1, 1, 8).setValues(values);\n\n  sheet.deleteRow(2);\n\n}\n\n\n\n\nnotification.gs\n// \u901a\u77e5\u306e\u30e1\u30a4\u30f3\u30e1\u30bd\u30c3\u30c9\nfunction notification() {\n\n  var spreadSheet = SpreadsheetApp.openByUrl('{Google \u30b9\u30d7\u30ec\u30c3\u30c9\u30b7\u30fc\u30c8\u306e URL}');\n\n  var sheet = spreadSheet.getSheets()[0];\n\n  var now = new Date();\n\n  var w = [8, 2, 3, 4, 5, 6, 7]; // \u65e5, \u6708, \u706b, \u6c34, \u6728, \u91d1, \u571f \uff08\u30b7\u30fc\u30c8\u306e\u30bb\u30eb\u306e\u4f4d\u7f6e\u306b\u3072\u3082\u3065\u3051\u308b\uff09\n\n  var day = w[now.getDay()];\n\n  var staff = sheet.getRange(2, day).getValue();\n\n  var text = '\u3053\u3053\u306b\u30e1\u30c3\u30bb\u30fc\u30b8'\n\n  slack(staff + ' ' + text);\n  // hipchat(staff + ' ' + text);\n}\n\n// Hipchat \u306b\u901a\u77e5\uff08v1 \u306e API \u306f\u53e4\u3044\u306e\u3067\u6ce8\u610f\uff09\nfunction hipchat(message) {\n\n  var url = 'https://api.hipchat.com/v1/rooms/message';\n\n  var payload =\n      {\n        'room_id'        : '{\u30eb\u30fc\u30e0ID}',\n        'from'           : '\u65e5\u76f4',\n        'auth_token'     : '{Hipchat \u306e\u30c8\u30fc\u30af\u30f3}',\n        'color'          : 'purple',\n        'notify'         : 1,\n        'message'        : message,\n        'message_format' : 'text'\n      };\n  var params =\n      {\n        'method'      : 'post',\n        'contentType' : 'application/x-www-form-urlencoded',\n        'payload'     : payload\n      };\n\n  var response = UrlFetchApp.fetch(url, params);\n\n}\n\n// Slack \u306b\u901a\u77e5\nfunction slack(message) {\n\n  // chat.postMessage | Slack \n  // https://api.slack.com/methods/chat.postMessage\n\n  var url = 'https://slack.com/api/chat.postMessage';\n\n  var token = '{Slack \u306e\u30c8\u30fc\u30af\u30f3}';\n  var channel = 'hoge';\n  var text = message;\n  var username = '\u65e5\u76f4';\n  var parse = 'full';\n  var icon_emoji = ':scroll:';\n  var method = 'post';\n\n  var payload = \n      {\n        'token'      : token,\n        'channel'    : channel,\n        'text'       : text,\n        'username'   : username,\n        'parse'      : parse,\n        'icon_emoji' : icon_emoji\n      };\n  var params =\n      {\n        'method' : method,\n        'payload' : payload\n      };\n\n  var response = UrlFetchApp.fetch(url, params);\n}\n\n\n\n\n\u30bf\u30a4\u30de\u30fc\n\n\n\n\u304a\u308f\u308a\u306b\nGoogle \u30b9\u30d7\u30ec\u30c3\u30c9\u30b7\u30fc\u30c8\u304c\u3042\u308c\u3070\u5927\u62b5\u306e\u3053\u3068\u304c\u3067\u304d\u307e\u3059.\n\u30b5\u30fc\u30d0\u30fc\u3044\u3089\u305a\u3067\u697d\u3061\u3093\u3067\u3059\u306d.\nGoogle Apps Script \u3092 WebHook \u306e \u30ec\u30b7\u30fc\u30d0\u3068\u3057\u3066\u52d5\u4f5c\u3055\u305b\u308b\uff08\u305f\u3060\u3057GET\u306b\u9650\u308b\uff09 | Dozens Members' Blog\n\u64ec\u4f3c Hubot \u307f\u305f\u3044\u306a\u306e\u304c\u4f5c\u308c\u305d\u3046\u306a\u6c17\u304c\u3057\u305f\u306e\u3067\u3001\u3053\u3046\u3044\u3046\u3053\u3068\u3082\u6311\u6226\u3057\u305f\u3044\u307f\u305f\u3044\u306a\u3041.\n# \u306f\u3058\u3081\u306b\n\n\u30b5\u30fc\u30d0\u30fc\u3092\u7acb\u3066\u308b\u307e\u3067\u3082\u306a\u304f\u3061\u3087\u3063\u3068\u3057\u305f\u901a\u77e5\u3092\u5b9f\u88c5\u3057\u305f\u3044\u3068\u601d\u3063\u305f\u6642\u306b\u4f5c\u3063\u305f\u3084\u3064\u3067\u3059.\n\u30c7\u30fc\u30bf\u306e\u53d7\u3051\u53d6\u308a\u304c\u306a\u304f\u3001\u9001\u4fe1\u306e\u307f\u3067\u3042\u308c\u3070\u3068\u308a\u3042\u3048\u305a\u4ee5\u4e0b\u306e\u5b9f\u88c5\u3067 OK .\n\u30c7\u30fc\u30bf\u3092\u8caf\u3081\u305f\u3044\u5834\u5408\u3082\u3044\u308d\u3044\u308d\u3084\u308a\u65b9\u306f\u3042\u308b\u307f\u305f\u3044\u306a\u306e\u3067\u63a2\u305b\u3070\u3067\u3066\u304d\u307e\u3059 .\n\n# Slack \u3068 Hipchat\n\n\u30c8\u30fc\u30af\u30f3\u3092\u767a\u884c\u3059\u308b.\n\n- [Slack Web API | Slack](https://api.slack.com/web)\n- [HipChat - API - Authentication](https://www.hipchat.com/docs/api/auth)\n\n# Google Spread Sheet ( Google \u30b9\u30d7\u30ec\u30c3\u30c9\u30b7\u30fc\u30c8 )\n\n## \u30b7\u30fc\u30c8\n\n![f7b634d3ade8efbedd71c6cab1bbc39bp.png](https://qiita-image-store.s3.amazonaws.com/0/30241/0a9227fa-7dc8-9719-fa9d-81c51ae55647.png)\n\n## \u30b9\u30af\u30ea\u30d7\u30c8\n\n```js:staff_manager.gs\n// \u5217\u3092\u5165\u308c\u66ff\u3048\u308b\u3053\u3068\u3067\u62c5\u5f53\u3092\u5909\u66f4\u3059\u308b.\nfunction staff_manager() {\n  var spreadSheet = SpreadsheetApp.openByUrl('{Google \u30b9\u30d7\u30ec\u30c3\u30c9\u30b7\u30fc\u30c8\u306e URL}');\n  \n  var sheet = spreadSheet.getSheets()[0];\n  \n  sheet.insertRowAfter(sheet.getMaxRows());\n  \n  var firstRow = sheet.getRange(2, 1, 1, 8);\n  \n  var values = firstRow.getValues();\n  \n  sheet.getRange(sheet.getMaxRows(), 1, 1, 8).setValues(values);\n  \n  sheet.deleteRow(2);\n  \n}\n\n```\n\n```js:notification.gs\n// \u901a\u77e5\u306e\u30e1\u30a4\u30f3\u30e1\u30bd\u30c3\u30c9\nfunction notification() {\n  \n  var spreadSheet = SpreadsheetApp.openByUrl('{Google \u30b9\u30d7\u30ec\u30c3\u30c9\u30b7\u30fc\u30c8\u306e URL}');\n  \n  var sheet = spreadSheet.getSheets()[0];\n  \n  var now = new Date();\n\n  var w = [8, 2, 3, 4, 5, 6, 7]; // \u65e5, \u6708, \u706b, \u6c34, \u6728, \u91d1, \u571f \uff08\u30b7\u30fc\u30c8\u306e\u30bb\u30eb\u306e\u4f4d\u7f6e\u306b\u3072\u3082\u3065\u3051\u308b\uff09\n  \n  var day = w[now.getDay()];\n  \n  var staff = sheet.getRange(2, day).getValue();\n  \n  var text = '\u3053\u3053\u306b\u30e1\u30c3\u30bb\u30fc\u30b8'\n  \n  slack(staff + ' ' + text);\n  // hipchat(staff + ' ' + text);\n}\n\n// Hipchat \u306b\u901a\u77e5\uff08v1 \u306e API \u306f\u53e4\u3044\u306e\u3067\u6ce8\u610f\uff09\nfunction hipchat(message) {\n \n  var url = 'https://api.hipchat.com/v1/rooms/message';\n  \n  var payload =\n      {\n        'room_id'        : '{\u30eb\u30fc\u30e0ID}',\n        'from'           : '\u65e5\u76f4',\n        'auth_token'     : '{Hipchat \u306e\u30c8\u30fc\u30af\u30f3}',\n        'color'          : 'purple',\n        'notify'         : 1,\n        'message'        : message,\n        'message_format' : 'text'\n      };\n  var params =\n      {\n        'method'      : 'post',\n        'contentType' : 'application/x-www-form-urlencoded',\n        'payload'     : payload\n      };\n  \n  var response = UrlFetchApp.fetch(url, params);\n  \n}\n\n// Slack \u306b\u901a\u77e5\nfunction slack(message) {\n \n  // chat.postMessage | Slack \n  // https://api.slack.com/methods/chat.postMessage\n  \n  var url = 'https://slack.com/api/chat.postMessage';\n  \n  var token = '{Slack \u306e\u30c8\u30fc\u30af\u30f3}';\n  var channel = 'hoge';\n  var text = message;\n  var username = '\u65e5\u76f4';\n  var parse = 'full';\n  var icon_emoji = ':scroll:';\n  var method = 'post';\n  \n  var payload = \n      {\n        'token'      : token,\n        'channel'    : channel,\n        'text'       : text,\n        'username'   : username,\n        'parse'      : parse,\n        'icon_emoji' : icon_emoji\n      };\n  var params =\n      {\n        'method' : method,\n        'payload' : payload\n      };\n  \n  var response = UrlFetchApp.fetch(url, params);\n}\n\n```\n\n## \u30bf\u30a4\u30de\u30fc\n\n![2656cc0e979dfd3470f407a2e005fa87.png](https://qiita-image-store.s3.amazonaws.com/0/30241/bb3b628c-71ad-cf63-28d5-6a9959cda46b.png)\n![a74d5940d56d67b06c1b02b4cc6509f9.png](https://qiita-image-store.s3.amazonaws.com/0/30241/25e45dfd-1f0e-35ff-b0eb-d7c3f73aa1e1.png)\n\n# \u304a\u308f\u308a\u306b\n\nGoogle \u30b9\u30d7\u30ec\u30c3\u30c9\u30b7\u30fc\u30c8\u304c\u3042\u308c\u3070\u5927\u62b5\u306e\u3053\u3068\u304c\u3067\u304d\u307e\u3059.\n\u30b5\u30fc\u30d0\u30fc\u3044\u3089\u305a\u3067\u697d\u3061\u3093\u3067\u3059\u306d.\n\n[Google Apps Script \u3092 WebHook \u306e \u30ec\u30b7\u30fc\u30d0\u3068\u3057\u3066\u52d5\u4f5c\u3055\u305b\u308b\uff08\u305f\u3060\u3057GET\u306b\u9650\u308b\uff09 | Dozens Members' Blog](https://dozensmembers.wordpress.com/2014/04/28/google-apps-script-as-a-webhooks-receiver/)\n\n\u64ec\u4f3c Hubot \u307f\u305f\u3044\u306a\u306e\u304c\u4f5c\u308c\u305d\u3046\u306a\u6c17\u304c\u3057\u305f\u306e\u3067\u3001\u3053\u3046\u3044\u3046\u3053\u3068\u3082\u6311\u6226\u3057\u305f\u3044\u307f\u305f\u3044\u306a\u3041.\n", "tags": ["Slack", "GoogleSpreadSheet"]}