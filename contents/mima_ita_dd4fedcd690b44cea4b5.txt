{"context": " More than 1 year has passed since last update.\u3053\u306e\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u3067\u306fWinMerge\u3092\u7528\u3044\u3066SQLite\u306e\u6bd4\u8f03\u3092\u884c\u3046\u65b9\u6cd5\u306b\u3064\u3044\u3066\u89e3\u8aac\u3059\u308b\u3002\n\n\u5c0e\u5165\u65b9\u6cd5\n\uff11\uff0eSQLite\u7528\u306eODBC\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\u3002\nhttp://www.ch-werner.de/sqliteodbc/\n\u4e0b\u8a18\u306e\u3044\u305a\u308c\u304b\u3001\u307e\u305f\u306f\u4e21\u65b9\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\u3053\u3068\u3002\nsqliteodbc.exe\nsqliteodbc_w64.exe \n\uff12\uff0e\u6b21\u306e\u3088\u3046\u306a\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u6210\u3059\u308b\n\nSqliteToText.sct\n<scriptlet>\n\n<implements type=\"Automation\" id=\"dispatcher\">\n    <property name=\"PluginEvent\">\n              <get/>\n        </property>\n    <property name=\"PluginDescription\">\n              <get/>\n        </property>\n    <property name=\"PluginFileFilters\">\n              <get/>\n        </property>\n    <property name=\"PluginIsAutomatic\">\n              <get/>\n        </property>\n        <method name=\"UnpackFile\"/>\n        <method name=\"PackFile\"/>\n</implements>\n\n<script language=\"VBS\">\nOption Explicit\n\nFunction get_PluginEvent()\n         get_PluginEvent = \"FILE_PACK_UNPACK\"\nEnd Function\n\nFunction get_PluginDescription()\n         get_PluginDescription = \"SqliteToText\"\nEnd Function\n\nFunction get_PluginFileFilters()\n         get_PluginFileFilters = \"\\.sqlite(\\..*)?$;\\.sqlite3(\\..*)?$;\\.db(\\..*)?$\"\nEnd Function\n\nFunction get_PluginIsAutomatic()\n         get_PluginIsAutomatic = True\nEnd Function\n\nFunction UnpackFile(fileSrc, fileDst, pbChanged, pSubcode)\n    Dim cnn\n    Dim Filename\n    Dim rs\n    Dim i\n    Dim tableNameDict\n    Dim name\n    Dim fso\n    Dim fo\n\n    Set fso = CreateObject(\"Scripting.FileSystemObject\")\n    Set fo = fso.CreateTextFile(fileDst, True)\n\n    Set cnn = CreateObject(\"ADODB.Connection\")\n    cnn.CursorLocation = 3 '\n    FileName = \"test.sqlite\"\n    cnn.Open \"DRIVER=SQLite3 ODBC Driver;Database=\" & fileSrc & \";\"\n\n    Set rs = cnn.Execute(\"SELECT * FROM sqlite_master;\")\n    i = 0\n\n    rs.MoveFirst\n    Do While Not rs.EOF\n        name = rs.Fields(\"Name\").Value\n        fo.WriteLine \"[\" & name & \"]\"\n        fo.WriteLine rs.Fields(\"sql\").Value\n        If rs.Fields(\"Type\").Value = \"table\" Then\n            call showTable(fo, cnn , name)\n        End if\n        rs.MoveNext\n        i = i + 1\n    Loop \n\n    rs.Close\n    Set rs = Nothing\n\n\n    cnn.Close\n    Set cnn = Nothing\n\n    fo.Close\n    Set fo = Nothing\n    Set fso = Nothing\n\n    pbChanged = True\n    pSubcode = 0\n    UnpackFile = True\n\nEnd Function\n\nFunction PackFile(fileSrc, fileDst, pbChanged, pSubcode)\n    PackFile = False\nEnd Function\n\nPrivate Sub showTable(byref fo, byref cnn, byval tableName)\n    Dim rsTable\n    Dim i\n    Dim fieldCount\n    Dim data\n    Set rsTable = cnn.Execute(\"SELECT * FROM \" & tableName & \" ORDER BY 1\")\n    fieldCount = rsTable.Fields.count\n    rsTable.MoveFirst\n    Do While Not rsTable.EOF\n        For i = 0 To fieldCount - 1\n            if i = 0 Then\n                data = rsTable(i).Value\n            Else\n                data = data & vbTab & rsTable(i).Value\n            End If\n        Next\n        rsTable.MoveNext\n        fo.WriteLine data\n    Loop\n    rsTable.Close\n    Set rsTable = Nothing\nEnd Sub\n\n</script>\n</scriptlet>\n\n\n\n\uff13\uff0eWinMerge\u306e\u5c55\u958b\u30d7\u30e9\u30b0\u30a4\u30f3\u3092\u81ea\u52d5\u306b\u3059\u308b\u304b\u3001SqliteToText.sct\u3092\u660e\u793a\u3057\u3066\u6bd4\u8f03\n\u3092\u5b9f\u884c\u3059\u308b\u3002\n\n\u3053\u306e\u3088\u3046\u306b\u3001\u30c6\u30fc\u30d6\u30eb\u3001\u30c8\u30ea\u30ac\u30fc\u3001\u30d3\u30e5\u30fc\u3001\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u306e\u60c5\u5831\u3001\u3068\u30c6\u30fc\u30d6\u30eb\u306e\u4e2d\u8eab\u3092\u6bd4\u8f03\u3059\u308b\u3002\n\n\u89e3\u8aac\n\nSQLite\u306e\u30e1\u30bf\u60c5\u5831\n\nsqlite_master\nSQLite\u306fsqlite_master\u306btable,index,view,trriger\u306e\u60c5\u5831\u3092\u683c\u7d0d\u3057\u3066\u3044\u308b\u3002\n\u3053\u306e\u30c6\u30fc\u30d6\u30eb\u3092\u53d6\u5f97\u3059\u308b\u3053\u3068\u3067\u4e0b\u8a18\u306e\u60c5\u5831\u304c\u53d6\u5f97\u3067\u304d\u308b\u3002\n\n\n\n\u540d\u524d\n\u8aac\u660e\n\n\n\n\ntype\n\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306e\u60c5\u5831\u3092\u793a\u3059\u3002'table', 'index', 'view','trigger'\u306e\u3044\u305a\u308c\u304b\n\n\nname\n\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u540d\n\n\nrootpage\n\u30c6\u30fc\u30d6\u30eb\u3068\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u306e\u305f\u3081\u306eroot b-tree\u30da\u30fc\u30b8\u306e\u30da\u30fc\u30b8\u756a\u53f7\n\n\nsql\nSQL\n\n\n\n\u306a\u304a\u3001\u3053\u306e\u30c6\u30fc\u30d6\u30eb\u306b\u306f\u4e00\u6642\u30c6\u30fc\u30d6\u30eb\u306e\u60c5\u5831\u306f\u683c\u7d0d\u3055\u308c\u306a\u3044\u3002\n\u4e00\u6642\u30c6\u30fc\u30d6\u30eb\u306e\u60c5\u5831\u3092\u53d6\u5f97\u3059\u308b\u306b\u306f\u4e0b\u8a18\u306e\u30c6\u30fc\u30d6\u30eb\u304b\u3089\u30c7\u30fc\u30bf\u3092\u53d6\u5f97\u3059\u308b\u3002\n\u30fbsqlite_temp_master\n\n\u30c6\u30fc\u30d6\u30eb\u306e\u5217\u60c5\u5831\n\u3053\u3053\u3067\u306f\u53d6\u5f97\u3057\u3066\u306a\u3044\u304c\u3001\u30c6\u30fc\u30d6\u30eb\u306e\u5217\u60c5\u5831\u306f\u4e0b\u8a18\u306eSQL\u3067\u53d6\u5f97\u3067\u304d\u308b\u3002\nPRAGMA table_info('\u30c6\u30fc\u30d6\u30eb\u540d');\n\n\n\u30b7\u30fc\u30b1\u30f3\u30b9\u60c5\u5831\nAUTOINCREMENT\u3092PRIMARY\u30ad\u30fc\u3067\u4f5c\u6210\u3057\u305f\u6642\u306bsqlite_sequence\u304c\u4f5c\u6210\u3055\u308c\u308b\u3002\nAUTOINCREMENT\u306fsqlite_sequence\u3092\u5143\u306b\u4f5c\u6210\u3055\u308c\u308b\u3002\n\n\u30b3\u30de\u30f3\u30c9\u30e9\u30a4\u30f3\u3092\u5229\u7528\u3057\u305f\u30c0\u30f3\u30d7\u65b9\u6cd5\n\u6700\u65b0\u306e\u30b3\u30de\u30f3\u30c9\u30e9\u30a4\u30f3\u30c4\u30fc\u30eb\u304c\u3042\u308b\u306a\u3089\u3001\u4ee5\u4e0b\u306e\u65b9\u6cd5\u3067\u4f3c\u305f\u60c5\u5831\u304c\u53d6\u5f97\u3067\u304d\u308b\u3002\nsqlite3 test.sqlite .dump\n\n\n\u53c2\u8003\nThe SQLite Database File Format \nhttp://www.sqlite.org/fileformat.html\n\u3053\u306e\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u3067\u306fWinMerge\u3092\u7528\u3044\u3066SQLite\u306e\u6bd4\u8f03\u3092\u884c\u3046\u65b9\u6cd5\u306b\u3064\u3044\u3066\u89e3\u8aac\u3059\u308b\u3002\n\n#\u5c0e\u5165\u65b9\u6cd5\n\uff11\uff0eSQLite\u7528\u306eODBC\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\u3002\nhttp://www.ch-werner.de/sqliteodbc/\n\n\u4e0b\u8a18\u306e\u3044\u305a\u308c\u304b\u3001\u307e\u305f\u306f\u4e21\u65b9\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\u3053\u3068\u3002\n\nsqliteodbc.exe\nsqliteodbc_w64.exe \n\n\uff12\uff0e\u6b21\u306e\u3088\u3046\u306a\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u6210\u3059\u308b\n\n```vbnet:SqliteToText.sct\n<scriptlet>\n\n<implements type=\"Automation\" id=\"dispatcher\">\n\t<property name=\"PluginEvent\">\n\t          <get/>\n        </property>\n\t<property name=\"PluginDescription\">\n\t          <get/>\n        </property>\n\t<property name=\"PluginFileFilters\">\n\t          <get/>\n        </property>\n\t<property name=\"PluginIsAutomatic\">\n\t          <get/>\n        </property>\n      \t<method name=\"UnpackFile\"/>\n      \t<method name=\"PackFile\"/>\n</implements>\n\n<script language=\"VBS\">\nOption Explicit\n\nFunction get_PluginEvent()\n         get_PluginEvent = \"FILE_PACK_UNPACK\"\nEnd Function\n\nFunction get_PluginDescription()\n         get_PluginDescription = \"SqliteToText\"\nEnd Function\n\nFunction get_PluginFileFilters()\n         get_PluginFileFilters = \"\\.sqlite(\\..*)?$;\\.sqlite3(\\..*)?$;\\.db(\\..*)?$\"\nEnd Function\n\nFunction get_PluginIsAutomatic()\n         get_PluginIsAutomatic = True\nEnd Function\n\nFunction UnpackFile(fileSrc, fileDst, pbChanged, pSubcode)\n\tDim cnn\n\tDim Filename\n\tDim rs\n\tDim i\n\tDim tableNameDict\n\tDim name\n\tDim fso\n\tDim fo\n\n\tSet fso = CreateObject(\"Scripting.FileSystemObject\")\n\tSet fo = fso.CreateTextFile(fileDst, True)\n\n\tSet cnn = CreateObject(\"ADODB.Connection\")\n\tcnn.CursorLocation = 3 '\n\tFileName = \"test.sqlite\"\n\tcnn.Open \"DRIVER=SQLite3 ODBC Driver;Database=\" & fileSrc & \";\"\n\t\t\n\tSet rs = cnn.Execute(\"SELECT * FROM sqlite_master;\")\n\ti = 0\n\n\trs.MoveFirst\n\tDo While Not rs.EOF\n\t\tname = rs.Fields(\"Name\").Value\n\t\tfo.WriteLine \"[\" & name & \"]\"\n\t\tfo.WriteLine rs.Fields(\"sql\").Value\n\t\tIf rs.Fields(\"Type\").Value = \"table\" Then\n\t\t\tcall showTable(fo, cnn , name)\n\t\tEnd if\n\t\trs.MoveNext\n\t\ti = i + 1\n\tLoop \n\n\trs.Close\n\tSet rs = Nothing\n\n\n\tcnn.Close\n\tSet cnn = Nothing\n\t\n\tfo.Close\n\tSet fo = Nothing\n\tSet fso = Nothing\n\t\n\tpbChanged = True\n\tpSubcode = 0\n\tUnpackFile = True\n\nEnd Function\n\nFunction PackFile(fileSrc, fileDst, pbChanged, pSubcode)\n\tPackFile = False\nEnd Function\n\nPrivate Sub showTable(byref fo, byref cnn, byval tableName)\n\tDim rsTable\n\tDim i\n\tDim fieldCount\n\tDim data\n\tSet rsTable = cnn.Execute(\"SELECT * FROM \" & tableName & \" ORDER BY 1\")\n\tfieldCount = rsTable.Fields.count\n\trsTable.MoveFirst\n\tDo While Not rsTable.EOF\n\t\tFor i = 0 To fieldCount - 1\n\t\t\tif i = 0 Then\n\t\t\t\tdata = rsTable(i).Value\n\t\t\tElse\n\t\t\t\tdata = data & vbTab & rsTable(i).Value\n\t\t\tEnd If\n\t\tNext\n\t\trsTable.MoveNext\n\t\tfo.WriteLine data\n\tLoop\n\trsTable.Close\n\tSet rsTable = Nothing\nEnd Sub\n\n</script>\n</scriptlet>\n\n```\n\n\uff13\uff0eWinMerge\u306e\u5c55\u958b\u30d7\u30e9\u30b0\u30a4\u30f3\u3092\u81ea\u52d5\u306b\u3059\u308b\u304b\u3001SqliteToText.sct\u3092\u660e\u793a\u3057\u3066\u6bd4\u8f03\n\u3092\u5b9f\u884c\u3059\u308b\u3002\n![\u7121\u984c.png](https://qiita-image-store.s3.amazonaws.com/0/47856/8a540841-3442-3620-f8f6-19356f0faa10.png)\n\n\u3053\u306e\u3088\u3046\u306b\u3001\u30c6\u30fc\u30d6\u30eb\u3001\u30c8\u30ea\u30ac\u30fc\u3001\u30d3\u30e5\u30fc\u3001\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u306e\u60c5\u5831\u3001\u3068\u30c6\u30fc\u30d6\u30eb\u306e\u4e2d\u8eab\u3092\u6bd4\u8f03\u3059\u308b\u3002\n\n#\u89e3\u8aac\n##SQLite\u306e\u30e1\u30bf\u60c5\u5831\n###sqlite_master\nSQLite\u306fsqlite_master\u306btable,index,view,trriger\u306e\u60c5\u5831\u3092\u683c\u7d0d\u3057\u3066\u3044\u308b\u3002\n\u3053\u306e\u30c6\u30fc\u30d6\u30eb\u3092\u53d6\u5f97\u3059\u308b\u3053\u3068\u3067\u4e0b\u8a18\u306e\u60c5\u5831\u304c\u53d6\u5f97\u3067\u304d\u308b\u3002\n\n|\u540d\u524d|\u8aac\u660e|\n|:---|:---|\n|type|\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306e\u60c5\u5831\u3092\u793a\u3059\u3002'table', 'index', 'view','trigger'\u306e\u3044\u305a\u308c\u304b|\n|name|\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u540d|\n|rootpage|\u30c6\u30fc\u30d6\u30eb\u3068\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u306e\u305f\u3081\u306eroot b-tree\u30da\u30fc\u30b8\u306e\u30da\u30fc\u30b8\u756a\u53f7|\n|sql|SQL|\n\n\u306a\u304a\u3001\u3053\u306e\u30c6\u30fc\u30d6\u30eb\u306b\u306f\u4e00\u6642\u30c6\u30fc\u30d6\u30eb\u306e\u60c5\u5831\u306f\u683c\u7d0d\u3055\u308c\u306a\u3044\u3002\n\u4e00\u6642\u30c6\u30fc\u30d6\u30eb\u306e\u60c5\u5831\u3092\u53d6\u5f97\u3059\u308b\u306b\u306f\u4e0b\u8a18\u306e\u30c6\u30fc\u30d6\u30eb\u304b\u3089\u30c7\u30fc\u30bf\u3092\u53d6\u5f97\u3059\u308b\u3002\n\n\u30fbsqlite_temp_master\n\n\n### \u30c6\u30fc\u30d6\u30eb\u306e\u5217\u60c5\u5831\n\u3053\u3053\u3067\u306f\u53d6\u5f97\u3057\u3066\u306a\u3044\u304c\u3001\u30c6\u30fc\u30d6\u30eb\u306e\u5217\u60c5\u5831\u306f\u4e0b\u8a18\u306eSQL\u3067\u53d6\u5f97\u3067\u304d\u308b\u3002\n\n```\nPRAGMA table_info('\u30c6\u30fc\u30d6\u30eb\u540d');\n```\n\n### \u30b7\u30fc\u30b1\u30f3\u30b9\u60c5\u5831\nAUTOINCREMENT\u3092PRIMARY\u30ad\u30fc\u3067\u4f5c\u6210\u3057\u305f\u6642\u306bsqlite_sequence\u304c\u4f5c\u6210\u3055\u308c\u308b\u3002\nAUTOINCREMENT\u306fsqlite_sequence\u3092\u5143\u306b\u4f5c\u6210\u3055\u308c\u308b\u3002\n\n###\u30b3\u30de\u30f3\u30c9\u30e9\u30a4\u30f3\u3092\u5229\u7528\u3057\u305f\u30c0\u30f3\u30d7\u65b9\u6cd5\n\u6700\u65b0\u306e\u30b3\u30de\u30f3\u30c9\u30e9\u30a4\u30f3\u30c4\u30fc\u30eb\u304c\u3042\u308b\u306a\u3089\u3001\u4ee5\u4e0b\u306e\u65b9\u6cd5\u3067\u4f3c\u305f\u60c5\u5831\u304c\u53d6\u5f97\u3067\u304d\u308b\u3002\n\n```\nsqlite3 test.sqlite .dump\n```\n\n#\u53c2\u8003\n __The SQLite Database File Format__ \nhttp://www.sqlite.org/fileformat.html\n", "tags": ["SQLite3", "VBScript", "WinMerge"]}