{"tags": ["Java", "diff", "JSON"], "context": " \u3053\u306e\u8a18\u4e8b\u306f\u6700\u7d42\u66f4\u65b0\u65e5\u304b\u30891\u5e74\u4ee5\u4e0a\u304c\u7d4c\u904e\u3057\u3066\u3044\u307e\u3059\u3002JSON\u540c\u58eb\u306e\u6bd4\u8f03\u3092\u3059\u308b\u306e\u306b\u4fbf\u5229\u306a\u3082\u306e\u304c\u7121\u3044\u304b\u3068\u8abf\u3079\u305f\u3089 json-patch \u306a\u308b\u7269\u304c\u898b\u3064\u304b\u3063\u305f\u306e\u3067\u3001\u3069\u3093\u306a\u3082\u306e\u304b\u3068\u8a66\u3057\u3066\u307f\u307e\u3057\u305f\u3002\n\n\u30e9\u30a4\u30d6\u30e9\u30ea\nhttps://github.com/fge/json-patch\n\u3084\u3063\u3066\u3044\u308b\u3053\u3068\u306f RFC6902 \u306b\u898f\u5b9a\u3057\u3066\u3042\u308b\u5185\u5bb9\u306e\u3088\u3046\u3067\u3001\n\u672c\u6765\u306f Diff \u3068\u3044\u3046\u3088\u308a JSON\u306b\u5bfe\u3057\u3066\u30d1\u30c3\u30c1\u3092\u5f53\u3066\u308b\u3088\u3046\u306a\u4e8b\u3092\u3059\u308b\u306e\u304c\u76ee\u7684\u3063\u307d\u3044\u3002\n\u305d\u306e\u6a5f\u80fd\u306e\uff11\u3064\u306b Diff \u304c\u3042\u308b\u3068\u3044\u3063\u305f\u6240\u304b\u306a\u3002\u3002\u3002\uff08\u3053\u306e\u8fba\u306f\u72ec\u308a\u8a00\u306a\u306e\u3067\u771f\u306b\u53d7\u3051\u306a\u3044\u3067\uff09\nRFC6902\nhttp://www.hcn.zaq.ne.jp/___/WEB/RFC6902-ja.html\n\n\u30c6\u30b9\u30c8\u30b3\u30fc\u30c9\n\nJsonPatchCheck.java\n\npublic class JsonPatchCheck {\n\n    private static final ObjectMapper mapper = new ObjectMapper();\n    static {\n        mapper.enable(SerializationFeature.INDENT_OUTPUT);\n    }\n\n    @Test(dataProvider = \"data\")\n    public void test(String name, String description, JsonNode json1, JsonNode json2) throws Throwable {\n        JsonNode diff = JsonDiff.asJson(json1, json2);\n        print(name, description, json1, json2, diff);\n    }\n\n    @DataProvider(name = \"data\")\n    public Object[][] data() throws Throwable {\n        return new Object[][] {\n                {\n                    \"Same\",\n                    \"\u540c\u3058\u5185\u5bb9JSON\u306e\u6bd4\u8f03\",\n                    mapper.readTree(\"{\\\"a\\\":\\\"0\\\" }\"),\n                    mapper.readTree(\"{\\\"a\\\":\\\"0\\\" }\")\n                },\n\n                {\n                    \"Add\",\n                    \"json1 \u306b\u5bfe\u3057\u3001 json2 \u306b /a/c \u304c\u3042\u308b\",\n                    mapper.readTree(\"{\\\"a\\\": [{\\\"b\\\":\\\"1\\\"}]}\"),\n                    mapper.readTree(\"{\\\"a\\\": [{\\\"b\\\":\\\"1\\\"},{\\\"c\\\":\\\"2\\\"}]}\")\n                },\n\n                {\n                    \"Remove\",\n                    \"json1 \u306b\u5bfe\u3057\u3001 json2 \u306b /a/c \u304c\u306a\u3044\",\n                    mapper.readTree(\"{\\\"a\\\": [{\\\"b\\\":\\\"1\\\"},{\\\"c\\\":\\\"2\\\"}]}\"),\n                    mapper.readTree(\"{\\\"a\\\": [{\\\"b\\\":\\\"1\\\"}]}\")\n                },\n\n                {\n                    \"Replace\",\n                    \"json1 \u3068 json2 \u3068\u3067 /b \u306e\u5024\u304c\u7570\u306a\u308b\",\n                    mapper.readTree(\"{\\\"a\\\":\\\"0\\\",\\\"b\\\":\\\"1\\\"}\"),\n                    mapper.readTree(\"{\\\"a\\\":\\\"0\\\",\\\"b\\\":\\\"2\\\"}\")\n                },\n\n                {\n                    \"Move\",\n                    \"json1 \u306e /b \u306e\u5024\u304c\u3001json2 \u306e /c \u306b\u3042\u308b\uff08/b \u304b\u3089 /c \u306b\u79fb\u52d5\u3057\u3066\u3044\u308b\uff09\",\n                    mapper.readTree(\"{\\\"a\\\":\\\"0\\\",\\\"b\\\":\\\"1\\\"}\"),\n                    mapper.readTree(\"{\\\"a\\\":\\\"0\\\",\\\"c\\\":\\\"1\\\"}\")\n                },\n\n                {\n                    \"Copy\",\n                    \"json1 \u306e /b \u306e\u5024\u304c\u3001json2 \u306e /c \u306b\u8907\u88fd\u3055\u308c\u3066\u3044\u308b\",\n                    mapper.readTree(\"{\\\"a\\\":\\\"0\\\",\\\"b\\\":\\\"1\\\"}\"),\n                    mapper.readTree(\"{\\\"a\\\":\\\"0\\\",\\\"b\\\":\\\"1\\\",\\\"c\\\":\\\"1\\\"}\")\n                }\n        };\n    }\n\n    public static void print(String name, String description, JsonNode json1, JsonNode json2, JsonNode diff) throws Throwable {\n        System.out.println(\"\u25a0\u25a0\u25a0\u25a0\u25a0\" + name + \"\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\");\n        System.out.println(\"\\n\" + description + \"\\n\");\n\n        System.out.println(\"-------JSON1-------\");\n        System.out.println(mapper.writerWithDefaultPrettyPrinter().writeValueAsString(json1));\n\n        System.out.println(\"-------JSON2-------\");\n        System.out.println(mapper.writerWithDefaultPrettyPrinter().writeValueAsString(json2));\n\n        System.out.println(\"-------Diff-------\");\n        System.out.println(mapper.writerWithDefaultPrettyPrinter().writeValueAsString(diff));\n\n        System.out.println(\"\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\");\n    }\n\n}\n\n\n\n\n\u51fa\u529b\n\n\u5b9f\u884c\u7d50\u679c\n\n\u25a0\u25a0\u25a0\u25a0\u25a0Same\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\n\n\u540c\u3058\u5185\u5bb9JSON\u306e\u6bd4\u8f03\n\n-------JSON1-------\n{\n  \"a\" : \"0\"\n}\n-------JSON2-------\n{\n  \"a\" : \"0\"\n}\n-------Diff-------\n[ ]\n\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\n\u25a0\u25a0\u25a0\u25a0\u25a0Add\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\n\njson1 \u306b\u5bfe\u3057\u3001 json2 \u306b /a/c \u304c\u3042\u308b\n\n-------JSON1-------\n{\n  \"a\" : [ {\n    \"b\" : \"1\"\n  } ]\n}\n-------JSON2-------\n{\n  \"a\" : [ {\n    \"b\" : \"1\"\n  }, {\n    \"c\" : \"2\"\n  } ]\n}\n-------Diff-------\n[ {\n  \"op\" : \"add\",\n  \"path\" : \"/a/-\",\n  \"value\" : {\n    \"c\" : \"2\"\n  }\n} ]\n\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\n\u25a0\u25a0\u25a0\u25a0\u25a0Remove\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\n\njson1 \u306b\u5bfe\u3057\u3001 json2 \u306b /a/c \u304c\u306a\u3044\n\n-------JSON1-------\n{\n  \"a\" : [ {\n    \"b\" : \"1\"\n  }, {\n    \"c\" : \"2\"\n  } ]\n}\n-------JSON2-------\n{\n  \"a\" : [ {\n    \"b\" : \"1\"\n  } ]\n}\n-------Diff-------\n[ {\n  \"op\" : \"remove\",\n  \"path\" : \"/a/1\"\n} ]\n\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\n\u25a0\u25a0\u25a0\u25a0\u25a0Replace\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\n\njson1 \u3068 json2 \u3068\u3067 /b \u306e\u5024\u304c\u7570\u306a\u308b\n\n-------JSON1-------\n{\n  \"a\" : \"0\",\n  \"b\" : \"1\"\n}\n-------JSON2-------\n{\n  \"a\" : \"0\",\n  \"b\" : \"2\"\n}\n-------Diff-------\n[ {\n  \"op\" : \"replace\",\n  \"path\" : \"/b\",\n  \"value\" : \"2\"\n} ]\n\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\n\u25a0\u25a0\u25a0\u25a0\u25a0Move\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\n\njson1 \u306e /b \u306e\u5024\u304c\u3001json2 \u306e /c \u306b\u3042\u308b\uff08/b \u304b\u3089 /c \u306b\u79fb\u52d5\u3057\u3066\u3044\u308b\uff09\n\n-------JSON1-------\n{\n  \"a\" : \"0\",\n  \"b\" : \"1\"\n}\n-------JSON2-------\n{\n  \"a\" : \"0\",\n  \"c\" : \"1\"\n}\n-------Diff-------\n[ {\n  \"op\" : \"move\",\n  \"path\" : \"/c\",\n  \"from\" : \"/b\"\n} ]\n\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\n\u25a0\u25a0\u25a0\u25a0\u25a0Copy\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\n\njson1 \u306e /b \u306e\u5024\u304c\u3001json2 \u306e /c \u306b\u8907\u88fd\u3055\u308c\u3066\u3044\u308b\n\n-------JSON1-------\n{\n  \"a\" : \"0\",\n  \"b\" : \"1\"\n}\n-------JSON2-------\n{\n  \"a\" : \"0\",\n  \"b\" : \"1\",\n  \"c\" : \"1\"\n}\n-------Diff-------\n[ {\n  \"op\" : \"copy\",\n  \"path\" : \"/c\",\n  \"from\" : \"/b\"\n} ]\n\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\n\n\n\n\n\u5f8c\u66f8\n\u51fa\u529b\u3055\u308c\u305f Diff \u3092\u3069\u3046\u89e3\u6790\u3057\u3066\u3001\u3069\u3046\u6271\u3046\u304b\u306f\u76ee\u7684\u306b\u5408\u308f\u305b\u3066\u500b\u3005\u306b\u8003\u3048\u308b\u5fc5\u8981\u304c\u3042\u308a\u305d\u3046\u3067\u3059\u304c\u3001\nDiff \u3092\u53d6\u308b\u5206\u306b\u306f\u554f\u984c\u306a\u3055\u305d\u3046\u3067\u3059\u3002\nJSON\u540c\u58eb\u306e\u6bd4\u8f03\u3092\u3059\u308b\u306e\u306b\u4fbf\u5229\u306a\u3082\u306e\u304c\u7121\u3044\u304b\u3068\u8abf\u3079\u305f\u3089 *json-patch* \u306a\u308b\u7269\u304c\u898b\u3064\u304b\u3063\u305f\u306e\u3067\u3001\u3069\u3093\u306a\u3082\u306e\u304b\u3068\u8a66\u3057\u3066\u307f\u307e\u3057\u305f\u3002\n\n\n## \u30e9\u30a4\u30d6\u30e9\u30ea\n\nhttps://github.com/fge/json-patch\n\n\u3084\u3063\u3066\u3044\u308b\u3053\u3068\u306f RFC6902 \u306b\u898f\u5b9a\u3057\u3066\u3042\u308b\u5185\u5bb9\u306e\u3088\u3046\u3067\u3001\n\u672c\u6765\u306f Diff \u3068\u3044\u3046\u3088\u308a JSON\u306b\u5bfe\u3057\u3066\u30d1\u30c3\u30c1\u3092\u5f53\u3066\u308b\u3088\u3046\u306a\u4e8b\u3092\u3059\u308b\u306e\u304c\u76ee\u7684\u3063\u307d\u3044\u3002\n\u305d\u306e\u6a5f\u80fd\u306e\uff11\u3064\u306b Diff \u304c\u3042\u308b\u3068\u3044\u3063\u305f\u6240\u304b\u306a\u3002\u3002\u3002\uff08\u3053\u306e\u8fba\u306f\u72ec\u308a\u8a00\u306a\u306e\u3067\u771f\u306b\u53d7\u3051\u306a\u3044\u3067\uff09\n\n*RFC6902*\nhttp://www.hcn.zaq.ne.jp/___/WEB/RFC6902-ja.html\n\n\n### \u30c6\u30b9\u30c8\u30b3\u30fc\u30c9\n\n```java:JsonPatchCheck.java\n\npublic class JsonPatchCheck {\n\n    private static final ObjectMapper mapper = new ObjectMapper();\n    static {\n        mapper.enable(SerializationFeature.INDENT_OUTPUT);\n    }\n\n    @Test(dataProvider = \"data\")\n    public void test(String name, String description, JsonNode json1, JsonNode json2) throws Throwable {\n        JsonNode diff = JsonDiff.asJson(json1, json2);\n        print(name, description, json1, json2, diff);\n    }\n\n    @DataProvider(name = \"data\")\n    public Object[][] data() throws Throwable {\n        return new Object[][] {\n                {\n                    \"Same\",\n                    \"\u540c\u3058\u5185\u5bb9JSON\u306e\u6bd4\u8f03\",\n                    mapper.readTree(\"{\\\"a\\\":\\\"0\\\" }\"),\n                    mapper.readTree(\"{\\\"a\\\":\\\"0\\\" }\")\n                },\n\n                {\n                    \"Add\",\n                    \"json1 \u306b\u5bfe\u3057\u3001 json2 \u306b /a/c \u304c\u3042\u308b\",\n                    mapper.readTree(\"{\\\"a\\\": [{\\\"b\\\":\\\"1\\\"}]}\"),\n                    mapper.readTree(\"{\\\"a\\\": [{\\\"b\\\":\\\"1\\\"},{\\\"c\\\":\\\"2\\\"}]}\")\n                },\n\n                {\n                    \"Remove\",\n                    \"json1 \u306b\u5bfe\u3057\u3001 json2 \u306b /a/c \u304c\u306a\u3044\",\n                    mapper.readTree(\"{\\\"a\\\": [{\\\"b\\\":\\\"1\\\"},{\\\"c\\\":\\\"2\\\"}]}\"),\n                    mapper.readTree(\"{\\\"a\\\": [{\\\"b\\\":\\\"1\\\"}]}\")\n                },\n\n                {\n                    \"Replace\",\n                    \"json1 \u3068 json2 \u3068\u3067 /b \u306e\u5024\u304c\u7570\u306a\u308b\",\n                    mapper.readTree(\"{\\\"a\\\":\\\"0\\\",\\\"b\\\":\\\"1\\\"}\"),\n                    mapper.readTree(\"{\\\"a\\\":\\\"0\\\",\\\"b\\\":\\\"2\\\"}\")\n                },\n\n                {\n                    \"Move\",\n                    \"json1 \u306e /b \u306e\u5024\u304c\u3001json2 \u306e /c \u306b\u3042\u308b\uff08/b \u304b\u3089 /c \u306b\u79fb\u52d5\u3057\u3066\u3044\u308b\uff09\",\n                    mapper.readTree(\"{\\\"a\\\":\\\"0\\\",\\\"b\\\":\\\"1\\\"}\"),\n                    mapper.readTree(\"{\\\"a\\\":\\\"0\\\",\\\"c\\\":\\\"1\\\"}\")\n                },\n\n                {\n                    \"Copy\",\n                    \"json1 \u306e /b \u306e\u5024\u304c\u3001json2 \u306e /c \u306b\u8907\u88fd\u3055\u308c\u3066\u3044\u308b\",\n                    mapper.readTree(\"{\\\"a\\\":\\\"0\\\",\\\"b\\\":\\\"1\\\"}\"),\n                    mapper.readTree(\"{\\\"a\\\":\\\"0\\\",\\\"b\\\":\\\"1\\\",\\\"c\\\":\\\"1\\\"}\")\n                }\n        };\n    }\n\n    public static void print(String name, String description, JsonNode json1, JsonNode json2, JsonNode diff) throws Throwable {\n        System.out.println(\"\u25a0\u25a0\u25a0\u25a0\u25a0\" + name + \"\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\");\n        System.out.println(\"\\n\" + description + \"\\n\");\n\n        System.out.println(\"-------JSON1-------\");\n        System.out.println(mapper.writerWithDefaultPrettyPrinter().writeValueAsString(json1));\n\n        System.out.println(\"-------JSON2-------\");\n        System.out.println(mapper.writerWithDefaultPrettyPrinter().writeValueAsString(json2));\n\n        System.out.println(\"-------Diff-------\");\n        System.out.println(mapper.writerWithDefaultPrettyPrinter().writeValueAsString(diff));\n\n        System.out.println(\"\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\");\n    }\n\n}\n\n```\n\n### \u51fa\u529b\n\n```text:\u5b9f\u884c\u7d50\u679c\n\n\u25a0\u25a0\u25a0\u25a0\u25a0Same\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\n\n\u540c\u3058\u5185\u5bb9JSON\u306e\u6bd4\u8f03\n\n-------JSON1-------\n{\n  \"a\" : \"0\"\n}\n-------JSON2-------\n{\n  \"a\" : \"0\"\n}\n-------Diff-------\n[ ]\n\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\n\u25a0\u25a0\u25a0\u25a0\u25a0Add\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\n\njson1 \u306b\u5bfe\u3057\u3001 json2 \u306b /a/c \u304c\u3042\u308b\n\n-------JSON1-------\n{\n  \"a\" : [ {\n    \"b\" : \"1\"\n  } ]\n}\n-------JSON2-------\n{\n  \"a\" : [ {\n    \"b\" : \"1\"\n  }, {\n    \"c\" : \"2\"\n  } ]\n}\n-------Diff-------\n[ {\n  \"op\" : \"add\",\n  \"path\" : \"/a/-\",\n  \"value\" : {\n    \"c\" : \"2\"\n  }\n} ]\n\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\n\u25a0\u25a0\u25a0\u25a0\u25a0Remove\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\n\njson1 \u306b\u5bfe\u3057\u3001 json2 \u306b /a/c \u304c\u306a\u3044\n\n-------JSON1-------\n{\n  \"a\" : [ {\n    \"b\" : \"1\"\n  }, {\n    \"c\" : \"2\"\n  } ]\n}\n-------JSON2-------\n{\n  \"a\" : [ {\n    \"b\" : \"1\"\n  } ]\n}\n-------Diff-------\n[ {\n  \"op\" : \"remove\",\n  \"path\" : \"/a/1\"\n} ]\n\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\n\u25a0\u25a0\u25a0\u25a0\u25a0Replace\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\n\njson1 \u3068 json2 \u3068\u3067 /b \u306e\u5024\u304c\u7570\u306a\u308b\n\n-------JSON1-------\n{\n  \"a\" : \"0\",\n  \"b\" : \"1\"\n}\n-------JSON2-------\n{\n  \"a\" : \"0\",\n  \"b\" : \"2\"\n}\n-------Diff-------\n[ {\n  \"op\" : \"replace\",\n  \"path\" : \"/b\",\n  \"value\" : \"2\"\n} ]\n\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\n\u25a0\u25a0\u25a0\u25a0\u25a0Move\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\n\njson1 \u306e /b \u306e\u5024\u304c\u3001json2 \u306e /c \u306b\u3042\u308b\uff08/b \u304b\u3089 /c \u306b\u79fb\u52d5\u3057\u3066\u3044\u308b\uff09\n\n-------JSON1-------\n{\n  \"a\" : \"0\",\n  \"b\" : \"1\"\n}\n-------JSON2-------\n{\n  \"a\" : \"0\",\n  \"c\" : \"1\"\n}\n-------Diff-------\n[ {\n  \"op\" : \"move\",\n  \"path\" : \"/c\",\n  \"from\" : \"/b\"\n} ]\n\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\n\u25a0\u25a0\u25a0\u25a0\u25a0Copy\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\n\njson1 \u306e /b \u306e\u5024\u304c\u3001json2 \u306e /c \u306b\u8907\u88fd\u3055\u308c\u3066\u3044\u308b\n\n-------JSON1-------\n{\n  \"a\" : \"0\",\n  \"b\" : \"1\"\n}\n-------JSON2-------\n{\n  \"a\" : \"0\",\n  \"b\" : \"1\",\n  \"c\" : \"1\"\n}\n-------Diff-------\n[ {\n  \"op\" : \"copy\",\n  \"path\" : \"/c\",\n  \"from\" : \"/b\"\n} ]\n\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\n\n```\n\n## \u5f8c\u66f8\n\n\u51fa\u529b\u3055\u308c\u305f Diff \u3092\u3069\u3046\u89e3\u6790\u3057\u3066\u3001\u3069\u3046\u6271\u3046\u304b\u306f\u76ee\u7684\u306b\u5408\u308f\u305b\u3066\u500b\u3005\u306b\u8003\u3048\u308b\u5fc5\u8981\u304c\u3042\u308a\u305d\u3046\u3067\u3059\u304c\u3001\nDiff \u3092\u53d6\u308b\u5206\u306b\u306f\u554f\u984c\u306a\u3055\u305d\u3046\u3067\u3059\u3002\n"}