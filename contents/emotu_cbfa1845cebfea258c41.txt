{"tags": ["SQL", "SQLServer", "\u30a4\u30f3\u30c7\u30c3\u30af\u30b9", "\u52d5\u7684\u7ba1\u7406\u30d3\u30e5\u30fc"], "context": "\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u3092\u5f35\u3063\u305f\u306e\u306f\u826f\u3044\u3051\u3069\u3001\u672c\u5f53\u306b\u3061\u3083\u3093\u3068\u610f\u56f3\u3057\u305f\u4f7f\u308f\u308c\u65b9\u3092\u3057\u3066\u3044\u308b\u306e\u304b\u77e5\u308a\u305f\u3044\u3068\u304d\u3042\u308a\u307e\u3059\u3088\u306d\u3002\n\u4e0b\u8a18\u306eSQL\u3067\u3001\u7279\u5b9a\u306e\u30c6\u30fc\u30d6\u30eb\u306e\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u5229\u7528\u72b6\u6cc1\u3092\u53d6\u5f97\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\u30fbseek\u3067\u4f7f\u308f\u308c\u308b\u3064\u3082\u308a\u3067\u4f5c\u3063\u305f\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u3067scan\u304c\u591a\u7528\u3055\u308c\u3066\u3044\u306a\u3044\u304b\uff1f\n\u30fbscan\u3067\u4f7f\u308f\u308c\u308b\u3064\u3082\u308a\u3067\u4f5c\u3063\u305f\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u3067seek\u304c\u591a\u7528\u3055\u308c\u3066\u3044\u306a\u3044\u304b\uff1f\uff08\u3053\u3063\u3061\u306f\u7a00\u3067\u3059\u306d\uff09\n\u306a\u3069\u78ba\u8a8d\u3067\u304d\u307e\u3059\u3002\n\u203b\u5b9f\u884c\u306b\u306fVIEW SERVER STATE \u6a29\u9650\u304c\u5fc5\u8981\u3067\u3059\u3002\nSELECT\n    o.name AS table_name\n  , i.name AS index_name\n  , s.user_seeks    -- Index Seek \u6570\n  , s.user_scans    -- Index Scan \u6570\n  , s.user_updates  -- UPDATE \u6570\n  , s.user_lookups  -- lookup \u6570\n  , last_user_seek\n  , last_user_scan\n  , last_user_lookup\n  , last_user_update\nFROM\nsys.objects o\n INNER JOIN sys.indexes i\n   ON o.object_id = i.object_id\n INNER JOIN sys.dm_db_index_usage_stats s \n   ON i.index_id = s.index_id\nWHERE o.type = 'U'\n AND database_id = DB_ID()\n AND s.object_id = OBJECT_ID('\u30c6\u30fc\u30d6\u30eb\u540d')\n AND o.name = '\u30c6\u30fc\u30d6\u30eb\u540d'\nORDER BY\n s.user_seeks+s.user_scans desc --seek+scan\u56de\u6570\u964d\u9806\n--s.user_seeks desc -- seek\u56de\u6570\u964d\u9806\n--s.user_scans desc -- scan\u56de\u6570\u964d\u9806\n\n\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u3092\u5f35\u3063\u305f\u306e\u306f\u826f\u3044\u3051\u3069\u3001\u672c\u5f53\u306b\u3061\u3083\u3093\u3068\u610f\u56f3\u3057\u305f\u4f7f\u308f\u308c\u65b9\u3092\u3057\u3066\u3044\u308b\u306e\u304b\u77e5\u308a\u305f\u3044\u3068\u304d\u3042\u308a\u307e\u3059\u3088\u306d\u3002\n\n\u4e0b\u8a18\u306eSQL\u3067\u3001\u7279\u5b9a\u306e\u30c6\u30fc\u30d6\u30eb\u306e\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u5229\u7528\u72b6\u6cc1\u3092\u53d6\u5f97\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\u30fbseek\u3067\u4f7f\u308f\u308c\u308b\u3064\u3082\u308a\u3067\u4f5c\u3063\u305f\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u3067scan\u304c\u591a\u7528\u3055\u308c\u3066\u3044\u306a\u3044\u304b\uff1f\n\u30fbscan\u3067\u4f7f\u308f\u308c\u308b\u3064\u3082\u308a\u3067\u4f5c\u3063\u305f\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u3067seek\u304c\u591a\u7528\u3055\u308c\u3066\u3044\u306a\u3044\u304b\uff1f\uff08\u3053\u3063\u3061\u306f\u7a00\u3067\u3059\u306d\uff09\n\u306a\u3069\u78ba\u8a8d\u3067\u304d\u307e\u3059\u3002\n\n\u203b\u5b9f\u884c\u306b\u306fVIEW SERVER STATE \u6a29\u9650\u304c\u5fc5\u8981\u3067\u3059\u3002\n\n```\nSELECT\n    o.name AS table_name\n  , i.name AS index_name\n  , s.user_seeks    -- Index Seek \u6570\n  , s.user_scans    -- Index Scan \u6570\n  , s.user_updates  -- UPDATE \u6570\n  , s.user_lookups  -- lookup \u6570\n  , last_user_seek\n  , last_user_scan\n  , last_user_lookup\n  , last_user_update\nFROM\nsys.objects o\n INNER JOIN sys.indexes i\n   ON o.object_id = i.object_id\n INNER JOIN sys.dm_db_index_usage_stats s \n   ON i.index_id = s.index_id\nWHERE o.type = 'U'\n AND database_id = DB_ID()\n AND s.object_id = OBJECT_ID('\u30c6\u30fc\u30d6\u30eb\u540d')\n AND o.name = '\u30c6\u30fc\u30d6\u30eb\u540d'\nORDER BY\n s.user_seeks+s.user_scans desc --seek+scan\u56de\u6570\u964d\u9806\n--s.user_seeks desc -- seek\u56de\u6570\u964d\u9806\n--s.user_scans desc -- scan\u56de\u6570\u964d\u9806\n```\n"}