{"context": " More than 1 year has passed since last update.GunosyDM\u7814\u7a76\u4f1a #90\u306e\u767a\u8868\u8cc7\u6599\u3067\u3059\n\n\u7d39\u4ecb\u3059\u308b\u8ad6\u6587\n[1404.5772]Sequential Click Prediction for Sponsored Search with Recurrent Neural Networks\nMSRA\u3067\u306e\u30a4\u30f3\u30bf\u30fc\u30f3\u3067\u306e\u6210\u679c\u306e\u3088\u3046\u3067\uff0c\u6700\u521d\u306e3\u4eba\u304c\u30a4\u30f3\u30bf\u30fc\u30f3\u751f\u304b\u306a\uff0e\n\nIntroduction\n\u691c\u7d22\u9023\u52d5\u578b\u5e83\u544a\u306e\u30af\u30ea\u30c3\u30af\u306e\u3055\u308c\u3084\u3059\u3055\u3092\u6a5f\u68b0\u5b66\u7fd2\u3092\u4f7f\u3063\u3066\u4e88\u6e2c\u3059\u308b\uff0e\n\u305d\u306e\u7d20\u6027\u3068\u3057\u3066\u4f7f\u308f\u308c\u308b\u4ee3\u8868\u7684\u306a\u3082\u306e\u306f\u4ee5\u4e0b\u306e2\u3064\n\n\u904e\u53bb\u306eCTR(query\u5225, \u30e6\u30fc\u30b6\u5225\u306a\u3069\u306a\u3069)\n\u30af\u30a8\u30ea\u3068\u5e83\u544a\u306e\u610f\u5473\u7684\u306a\u8fd1\u3055\n\n\u3053\u306e\u7814\u7a76\u3067\u306f\u3082\u3063\u3068\u3044\u308d\u3093\u306a\u30c7\u30fc\u30bf\u3092\u7d44\u307f\u5408\u308f\u305b\u3066\u4e88\u6e2c\u3092\u3059\u308b\n\u4f8b\u3048\u3070\u3042\u308b\u30e6\u30fc\u30b6\u304c\u5e83\u544a\u3092\u30af\u30ea\u30c3\u30af\u3057\u305f\u3051\u3069\u3059\u3050\u9589\u3058\u305f\u5834\u5408\u306b\u306f\uff0c\u6b21\u306b\u305d\u306e\u5e83\u544a\u3092\u307f\u305f\u3068\u304d\u30af\u30ea\u30c3\u30af\u3059\u308b\u78ba\u7387\u306f\u4f4e\u304f\u306a\u308b\u3060\u308d\u3046\u3001\u307f\u305f\u3044\u306a\u3053\u3068\u3092\u4e88\u6e2c\u3092\u3057\u305f\u3044\n\u3053\u306e\u7814\u7a76\u3067\u306fRecurrent Neural Network(RNN)\u3092\u7528\u3044\u3066\u30af\u30ea\u30c3\u30af\u78ba\u7387\u3092\u4e88\u6e2c\u3059\u308b\n\u30c7\u30fc\u30bf\u306f\u6642\u7cfb\u5217\u30c7\u30fc\u30bf\u306a\u306e\u3067\u6642\u7cfb\u5217\u89e3\u6790\u3092\u7528\u3044\u308b\u306e\u304c\u9069\u5f53\n\u4e00\u822c\u306b\u6642\u7cfb\u5217\u89e3\u6790\u306f\u30c8\u30ec\u30f3\u30c9\u3060\u3063\u305f\u308a\u5468\u671f\u30d1\u30bf\u30fc\u30f3\u306e\u30e2\u30c7\u30ea\u30f3\u30b0\u304c\u4e3b\u3060\u304c\uff0c\n\u5e83\u544a\u30c7\u30fc\u30bf\u306f\u8907\u96d1\u3067\u52d5\u7684\u306a\u306e\u3067\u9069\u3055\u306a\u3044\uff0e\nRNN\u306f\u8fd1\u5e74\u69d8\u3005\u306a\u7cfb\u5217\u30c7\u30fc\u30bf\u306b\u5bfe\u3059\u308b\u30bf\u30b9\u30af\u3067\u512a\u79c0\u306a\u6210\u679c\u3092\u4e0a\u3052\u3066\u3044\u308b\uff0e\nRNN\u3092\u7528\u3044\u305f\u30e2\u30c7\u30eb\u306b\u3088\u3063\u3066\u5f93\u6765\u306eLR\u3084NN\u306b\u3088\u308b\u624b\u6cd5\u306b\u5bfe\u3057\u3066\u9ad8\u3044\u6539\u5584\u3092\u793a\u3057\u305f\n\u91cd\u8981\u306a\u306e\u306f\u4e88\u6e2c\u30bf\u30b9\u30af\u306bsequential dependency\u3092\u53d6\u308a\u5165\u308c\u308b\u3053\u3068\uff0e\n\nData Analysis on Sequential Dependency\n\u6700\u521d\u306b\u30af\u30ea\u30c3\u30af\u3057\u305f\u6642\u306e\u30e9\u30f3\u30c7\u30a3\u30f3\u30b0\u30da\u30fc\u30b8(LP)\u306e\u6ede\u5728\u6642\u9593\u3068\u6b21\u306eimp\u306e\u6642\u306e\u30af\u30ea\u30c3\u30af\u7387\n\nquick back\u304b\u3089\u7d4c\u904e\u3057\u305f\u6642\u9593\u3068CTR\nquick back: \u30e6\u30fc\u30b6\u304cLP\u304b\u308920\u79d2\u4ee5\u5185\u306b\u623b\u3063\u305f\u3053\u3068\n\n\u30e6\u30fc\u30b6\u306f\u6642\u9593\u304c\u305f\u3064\u3068unsatisfied\u306a\u4f53\u9a13\u3092\u5fd8\u308c\u308b\n\u6700\u521d\u306b\u691c\u7d22\u3057\u305f\u3068\u304d\u3068\u6b21\u306b\u691c\u7d22\u3057\u305f\u6642\u306eCTR\n\n\nThe Proposed Framework\n\nModel\n\u7279\u306b\u5909\u308f\u3063\u305f\u3068\u3053\u308d\u306a\u3044RNN\n\nh(t) =  f(i(t)U^T + h(t-1)R^T) \\\\\ny(t) = \\sigma(h(t)V^T)\u3000\n\nf(z) = tanh(z) =\\frac{1-e^{-2z}}{1+e^{-2z}} \\\\\n\\sigma(z) = sigmoid(z) = \\frac{1}{1+e^{-z}}\n\n\nFeature Construction\n\u305f\u304f\u3055\u3093\u3064\u304b\u3063\u3066\u308b\uff0e\u7d30\u304b\u304f\u5177\u4f53\u7684\u306b\u306f\u8ff0\u3079\u3089\u308c\u3066\u3044\u306a\u3044\uff0e3\u3064\u306e\u30b0\u30eb\u30fc\u30d7\u306b\u5206\u3051\u3066\u3044\u308b\uff0e\n1) Ad features consist of information about ad ID, ad display position, ad text relevance with text\n2) User features include user Ud and query related semantic information\n3) sequential features include time interval since the last impression, dwell time on the landing page of the last click event, and whether the current impression is the head of sequence\n\u540c\u3058\u30bb\u30c3\u30b7\u30e7\u30f3\u3067\u8868\u793a\u3055\u308c\u305f\u5e83\u544a\u306f\u8868\u793a\u9806\u306b\u3088\u3063\u3066sequence\u306b\u3059\u308b\n\nLearning\nLoss function\naveraged cross entropy\nL = \\frac{1}{M} \\sum_{i=1}^M (-y_i log(p_i) - (1-y_i)log(1-p_i))\n\n$ M $: \u8a13\u7df4\u30c7\u30fc\u30bf\u6570\n$ y_i $: \u30af\u30ea\u30c3\u30af\u3057\u305f\u304b\u306e\u30e9\u30d9\u30eb$ {0, 1}$\u3067\u8868\u73fe\u3055\u308c\u308b\n$ p_i $: \u4e88\u6e2c\u3057\u305f\u30af\u30ea\u30c3\u30af\u78ba\u7387\n\u5b66\u7fd2\u306b\u306fBPTT\u306b\u7528\u3044\u308b\n\nExperiments\n\nData Setting\n\u5546\u7528\u691c\u7d22\u30a8\u30f3\u30b8\u30f3\u306e\u30ed\u30b0, 2013/11/9 - 2013/11/22\u304b\u3089\u30e9\u30f3\u30c0\u30e0\u306b\u30b5\u30f3\u30d7\u30ea\u30f3\u30b0\n\u7b2c1\u9031\u306e\u30c7\u30fc\u30bf\u3092\u8a13\u7df4\u30c7\u30fc\u30bf, \u7b2c2\u9031\u306e\u30c7\u30fc\u30bf\u3092\u30c6\u30b9\u30c8\u30c7\u30fc\u30bf\n\n\nEvaluation Metrics\n\nArea Under ROC Curve(AUC)\nRelative Information Gain(RIG)\n\n\nCompared Methods\n\nLogistic Regression(LR)\nNeural Network(NN)\n\n\nExperiment result\noverall perfomance\ngrid search\n\nthe coefficient of L2 penalty: 1e-6\nthe number of training epochs: 3\nthe hidden layer size: 13\nthe number of unfolding steps for RNN: 3\n\n\nPerformance on Specific Ad Positions\n\n\nmainline\u304c\u4e00\u756a\u53ce\u76ca\u3092\u751f\u3080\u306e\u3067RNN\u304c\u3053\u3061\u3089\u3067\u9ad8\u3044\u306e\u306f\u826f\u3044\nsidebar\u306f\u30af\u30ea\u30c3\u30af\u6570\u304c\u5c11\u306a\u3044\u306e\u3067rare\u30b1\u30fc\u30b9\u306b\u904e\u5270\u53cd\u5fdc\u3059\u308b\u305f\u3081LR\u306f\u4f4e\u304f\u306a\u308b\n\nEffect of Recurrent State for Inference\nRNN\u3068\u3057\u3066\u5b66\u7fd2\u3057\u305f\u3042\u3068\u306b\u901a\u5e38\u306eNN\u3068\u3057\u3066\u63a8\u5b9a\u3059\u308b\n\u3064\u307e\u308a\u524d\u306e\u7cfb\u5217\u30c7\u30fc\u30bf\u306e\u96a0\u308c\u5c64\u306e\u5024\u3092\u4f7f\u308f\u306a\u3044\u72b6\u614b\u306b\u3059\u308b\nAUC: 88.25%\nRIG: 18.95%\nTable2\u3068\u6bd4\u8f03\u3057\u3066\u6027\u80fd\u304c\u52a3\u5316\u3057\u3066\u3044\u308b\uff0e\nrecurrent structure\u304c\u63a8\u5b9a\u306b\u5bfe\u3057\u3066\u6709\u52b9\u306b\u50cd\u3044\u3066\u3044\u308b\u3068\u3044\u3048\u308b\uff0e\nPerformance with Long vs. Short History\n\u3057\u304d\u3044\u5024T\u4ee5\u4e0a\u306esequence\u3092\u3082\u3064\u30c7\u30fc\u30bf\u3092\u96c6\u3081, T\u3067\u96a0\u308c\u5c64\u306b\u30c7\u30fc\u30bf\u3092\u305f\u3081\u3066\u6b8b\u308a\u3067test\u3092\u884c\u3046\uff0e\nT\u306e\u9577\u3055\u306b\u5bfe\u3057\u3066RNN\u304crobust\u3067\u3042\u308b\u304b\u3092\u78ba\u8a8d\u3059\u308b\n\nT\u304c\u5927\u304d\u3044\u307b\u3069performance\u304c\u3088\u3044\uff0e\u7cfb\u5217\u30c7\u30fc\u30bf\u306e\u7279\u5fb4\u3092\u3088\u304f\u84c4\u7a4d\u3067\u304d\u3066\u3044\u308b\u3068\u3044\u3048\u308b\nEffect of RNN Unfolding Step\nUnfolding Step: BPTT\u306b\u304a\u3051\u308b\u5b66\u7fd2\u306e\u30b9\u30c6\u30c3\u30d7\u6570\n(BPTT\u3088\u304f\u308f\u304b\u3063\u3066\u306a\u3044\u306e\u3067\u4eca\u5ea6\u3061\u3083\u3093\u3068\u8abf\u3079\u308b)\nAUC, RIG\u306e\u30d9\u30b9\u30c8\u306f3\uff0c\u305d\u308c\u3088\u308a\u5927\u304d\u306a\u5024\u306b\u3059\u308b\u3068\u6570\u5024\u306f\u843d\u3061\u3066\u3044\u304f(3\u307e\u3067\u306f\u4e0a\u6607\u3059\u308b)\n3\u3088\u308a\u5927\u304d\u3044\u5024\u306b\u3057\u305f\u3068\u304d\u306f\u9006\u4f1d\u642c\u306e\u30a8\u30e9\u30fc\u304c\u6d88\u3048\u308b\n\u3053\u308c\u304b\u3089\u3053\u306e\u30e2\u30c7\u30eb\u306f\u7cfb\u5217\u30c7\u30fc\u30bf\u3092\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u6271\u3063\u3066\u3044\u308b\u3068\u63a8\u6e2c\u3067\u304d\u308b\n\nshort-span dependency: \u5c11\u306a\u3044\u5358\u4f4d\u3067\u660e\u793a\u7684\u306b\u5b66\u7fd2\u3057\u3066\u3044\u308b\nlong-span dependency: \u6697\u9ed9\u7684\u306b\u9577\u3044\u30c7\u30fc\u30bf\u3092reccurent\u306a\u69cb\u9020\u306b\u8caf\u3081\u3053\u3093\u3067\u7cbe\u5ea6\u3092\u9ad8\u3081\u3066\u3044\u308b\n\n\nFuture Work\n\n\u4eca\u56de\u306f\u30e6\u30fc\u30b6\u30ec\u30d9\u30eb\u306esequential data\u3092\u6271\u3063\u305f\u3051\u3069(user, ad)\u3068\u304b(user, query)\u306a\u3069\u3088\u308a\u591a\u69d8\u306a\u5f62\u3067\u5b66\u7fd2\u3055\u305b\u305f\u3044\n\u4eca\u56de\u5b66\u3093\u3060recurrent\u306a\u90e8\u5206\u306e\u7279\u5fb4\u3092\u6d3b\u304b\u3057\u3066\uff0c\u3088\u308a\u6700\u9069\u5316\u3057\u305f\u5f62\u3067\u6271\u3044\u305f\u3044\nDeep Recurrent Neural Network(DRNN)[Hermans+2013]\u3092\u8a66\u3057\u3066\u307f\u305f\u3044\n\n\n\u611f\u60f3\n\n\u30b7\u30f3\u30d7\u30eb\u306aRNN\u3067\u3053\u3053\u307e\u3067\u6539\u5584\u3059\u308b\u306e\u3059\u3054\u3044(\u307b\u3093\u3068\u304b\u3088\u3063\u3066\u6c17\u6301\u3061\u306b\u3082\u306a\u308b)\nfeature\u5168\u7136\u96a0\u3057\u3066\u308b\u3051\u3069\u3053\u3046\u3044\u3046\u306e\u3067\u3082\u8ad6\u6587\u3068\u3057\u3066\u6210\u7acb\u3059\u308b\u3082\u306e\u306a\u306e\u304b\u306a\n\n\n\u7d20\u6027\u304csequential\u306a\u3068\u3053\u308d\u306b\u4f9d\u5b58\u3057\u3059\u304e\u3066\u3044\u305f\u306e\u3067\u306f\u307f\u305f\u3044\u306a\u61f8\u5ff5\u3082\u3042\u308a\u305d\u3046\u306a\n\n\n\u3053\u3046\u3044\u3046\u30bf\u30b9\u30af\u3044\u308d\u3044\u308d\u3042\u308b\u3068\u601d\u3046\u306e\u3067\u3044\u308d\u3044\u308d\u8a66\u3057\u3066\u307f\u305f\u3044\u3068\u3053\u308d\nRNN\u306e\u7279\u6027\u306b\u3064\u3044\u3066\u306e\u5206\u6790\u304c\u6df1\u304f\u3066\u53c2\u8003\u306b\u306a\u3063\u305f\uff0e\n\n[GunosyDM\u7814\u7a76\u4f1a #90](http://gunosy-dm.connpass.com/event/16941/)\u306e\u767a\u8868\u8cc7\u6599\u3067\u3059\n\n\n## \u7d39\u4ecb\u3059\u308b\u8ad6\u6587\n\n[[1404.5772]Sequential Click Prediction for Sponsored Search with Recurrent Neural Networks](http://arxiv.org/abs/1404.5772)\n\nMSRA\u3067\u306e\u30a4\u30f3\u30bf\u30fc\u30f3\u3067\u306e\u6210\u679c\u306e\u3088\u3046\u3067\uff0c\u6700\u521d\u306e3\u4eba\u304c\u30a4\u30f3\u30bf\u30fc\u30f3\u751f\u304b\u306a\uff0e\n\n\n## Introduction\n\n\u691c\u7d22\u9023\u52d5\u578b\u5e83\u544a\u306e\u30af\u30ea\u30c3\u30af\u306e\u3055\u308c\u3084\u3059\u3055\u3092\u6a5f\u68b0\u5b66\u7fd2\u3092\u4f7f\u3063\u3066\u4e88\u6e2c\u3059\u308b\uff0e\n\u305d\u306e\u7d20\u6027\u3068\u3057\u3066\u4f7f\u308f\u308c\u308b\u4ee3\u8868\u7684\u306a\u3082\u306e\u306f\u4ee5\u4e0b\u306e2\u3064\n\n1. \u904e\u53bb\u306eCTR(query\u5225, \u30e6\u30fc\u30b6\u5225\u306a\u3069\u306a\u3069)\n2. \u30af\u30a8\u30ea\u3068\u5e83\u544a\u306e\u610f\u5473\u7684\u306a\u8fd1\u3055\n\n**\u3053\u306e\u7814\u7a76\u3067\u306f\u3082\u3063\u3068\u3044\u308d\u3093\u306a\u30c7\u30fc\u30bf\u3092\u7d44\u307f\u5408\u308f\u305b\u3066\u4e88\u6e2c\u3092\u3059\u308b**\n\n\u4f8b\u3048\u3070\u3042\u308b\u30e6\u30fc\u30b6\u304c\u5e83\u544a\u3092\u30af\u30ea\u30c3\u30af\u3057\u305f\u3051\u3069\u3059\u3050\u9589\u3058\u305f\u5834\u5408\u306b\u306f\uff0c\u6b21\u306b\u305d\u306e\u5e83\u544a\u3092\u307f\u305f\u3068\u304d\u30af\u30ea\u30c3\u30af\u3059\u308b\u78ba\u7387\u306f\u4f4e\u304f\u306a\u308b\u3060\u308d\u3046\u3001\u307f\u305f\u3044\u306a\u3053\u3068\u3092\u4e88\u6e2c\u3092\u3057\u305f\u3044\n\n**\u3053\u306e\u7814\u7a76\u3067\u306fRecurrent Neural Network(RNN)\u3092\u7528\u3044\u3066\u30af\u30ea\u30c3\u30af\u78ba\u7387\u3092\u4e88\u6e2c\u3059\u308b**\n\n\u30c7\u30fc\u30bf\u306f\u6642\u7cfb\u5217\u30c7\u30fc\u30bf\u306a\u306e\u3067\u6642\u7cfb\u5217\u89e3\u6790\u3092\u7528\u3044\u308b\u306e\u304c\u9069\u5f53\n\u4e00\u822c\u306b\u6642\u7cfb\u5217\u89e3\u6790\u306f\u30c8\u30ec\u30f3\u30c9\u3060\u3063\u305f\u308a\u5468\u671f\u30d1\u30bf\u30fc\u30f3\u306e\u30e2\u30c7\u30ea\u30f3\u30b0\u304c\u4e3b\u3060\u304c\uff0c\n\u5e83\u544a\u30c7\u30fc\u30bf\u306f\u8907\u96d1\u3067\u52d5\u7684\u306a\u306e\u3067\u9069\u3055\u306a\u3044\uff0e\n\nRNN\u306f\u8fd1\u5e74\u69d8\u3005\u306a\u7cfb\u5217\u30c7\u30fc\u30bf\u306b\u5bfe\u3059\u308b\u30bf\u30b9\u30af\u3067\u512a\u79c0\u306a\u6210\u679c\u3092\u4e0a\u3052\u3066\u3044\u308b\uff0e\n\n**RNN\u3092\u7528\u3044\u305f\u30e2\u30c7\u30eb\u306b\u3088\u3063\u3066\u5f93\u6765\u306eLR\u3084NN\u306b\u3088\u308b\u624b\u6cd5\u306b\u5bfe\u3057\u3066\u9ad8\u3044\u6539\u5584\u3092\u793a\u3057\u305f**\n\n\u91cd\u8981\u306a\u306e\u306f\u4e88\u6e2c\u30bf\u30b9\u30af\u306bsequential dependency\u3092\u53d6\u308a\u5165\u308c\u308b\u3053\u3068\uff0e\n\n## Data Analysis on Sequential Dependency\n\n**\u6700\u521d\u306b\u30af\u30ea\u30c3\u30af\u3057\u305f\u6642\u306e\u30e9\u30f3\u30c7\u30a3\u30f3\u30b0\u30da\u30fc\u30b8(LP)\u306e\u6ede\u5728\u6642\u9593\u3068\u6b21\u306eimp\u306e\u6642\u306e\u30af\u30ea\u30c3\u30af\u7387**\n\n![\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2015-07-08 14.56.51.png](https://qiita-image-store.s3.amazonaws.com/0/2238/2a8b3816-ca19-3f06-9a00-9096377ebe36.png)\n\n\n**quick back\u304b\u3089\u7d4c\u904e\u3057\u305f\u6642\u9593\u3068CTR**\n\nquick back: \u30e6\u30fc\u30b6\u304cLP\u304b\u308920\u79d2\u4ee5\u5185\u306b\u623b\u3063\u305f\u3053\u3068\n\n\n![\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2015-07-08 15.10.22.png](https://qiita-image-store.s3.amazonaws.com/0/2238/f1e8d483-642e-f98d-8fe7-415e35948182.png)\n\n\u30e6\u30fc\u30b6\u306f\u6642\u9593\u304c\u305f\u3064\u3068unsatisfied\u306a\u4f53\u9a13\u3092\u5fd8\u308c\u308b\n\n**\u6700\u521d\u306b\u691c\u7d22\u3057\u305f\u3068\u304d\u3068\u6b21\u306b\u691c\u7d22\u3057\u305f\u6642\u306eCTR**\n\n![\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2015-07-08 15.14.07.png](https://qiita-image-store.s3.amazonaws.com/0/2238/13823222-cdbc-74cb-704f-6e160f75b35d.png)\n\n\n## The Proposed Framework\n\n### Model\n\n\u7279\u306b\u5909\u308f\u3063\u305f\u3068\u3053\u308d\u306a\u3044RNN\n\n![\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2015-07-08 15.29.37.png](https://qiita-image-store.s3.amazonaws.com/0/2238/687b5ff6-8021-06e1-38a7-3aa5b8b51537.png)\n\n\n```math\nh(t) =  f(i(t)U^T + h(t-1)R^T) \\\\\ny(t) = \\sigma(h(t)V^T)\u3000\n```\n\n```math\nf(z) = tanh(z) =\\frac{1-e^{-2z}}{1+e^{-2z}} \\\\\n\\sigma(z) = sigmoid(z) = \\frac{1}{1+e^{-z}}\n```\n\n### Feature Construction\n\n\u305f\u304f\u3055\u3093\u3064\u304b\u3063\u3066\u308b\uff0e\u7d30\u304b\u304f\u5177\u4f53\u7684\u306b\u306f\u8ff0\u3079\u3089\u308c\u3066\u3044\u306a\u3044\uff0e3\u3064\u306e\u30b0\u30eb\u30fc\u30d7\u306b\u5206\u3051\u3066\u3044\u308b\uff0e\n\n1) Ad features consist of information about ad ID, ad display position, ad text relevance with text\n2) User features include user Ud and query related semantic information\n3) sequential features include time interval since the last impression, dwell time on the landing page of the last click event, and whether the current impression is the head of sequence\n\n\u540c\u3058\u30bb\u30c3\u30b7\u30e7\u30f3\u3067\u8868\u793a\u3055\u308c\u305f\u5e83\u544a\u306f\u8868\u793a\u9806\u306b\u3088\u3063\u3066sequence\u306b\u3059\u308b\n\n### Learning\n\n**Loss function**\n\naveraged cross entropy\n\n```math\nL = \\frac{1}{M} \\sum_{i=1}^M (-y_i log(p_i) - (1-y_i)log(1-p_i))\n```\n\n$ M $: \u8a13\u7df4\u30c7\u30fc\u30bf\u6570\n$ y_i $: \u30af\u30ea\u30c3\u30af\u3057\u305f\u304b\u306e\u30e9\u30d9\u30eb$ \\{0, 1\\}$\u3067\u8868\u73fe\u3055\u308c\u308b\n$ p_i $: \u4e88\u6e2c\u3057\u305f\u30af\u30ea\u30c3\u30af\u78ba\u7387\n\n\u5b66\u7fd2\u306b\u306fBPTT\u306b\u7528\u3044\u308b\n\n## Experiments\n\n### Data Setting\n\n\u5546\u7528\u691c\u7d22\u30a8\u30f3\u30b8\u30f3\u306e\u30ed\u30b0, 2013/11/9 - 2013/11/22\u304b\u3089\u30e9\u30f3\u30c0\u30e0\u306b\u30b5\u30f3\u30d7\u30ea\u30f3\u30b0\n\n\u7b2c1\u9031\u306e\u30c7\u30fc\u30bf\u3092\u8a13\u7df4\u30c7\u30fc\u30bf, \u7b2c2\u9031\u306e\u30c7\u30fc\u30bf\u3092\u30c6\u30b9\u30c8\u30c7\u30fc\u30bf\n\n![\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2015-07-08 17.33.13.png](https://qiita-image-store.s3.amazonaws.com/0/2238/a2a469e9-acdb-b390-e8b7-753a6954c33d.png)\n\n### Evaluation Metrics\n\n- Area Under ROC Curve(AUC)\n- Relative Information Gain(RIG)\n\n### Compared Methods\n\n- Logistic Regression(LR)\n- Neural Network(NN)\n\n### Experiment result\n\n**overall perfomance**\n\ngrid search\n\n- the coefficient of L2 penalty: 1e-6\n- the number of training epochs: 3\n- the hidden layer size: 13\n- the number of unfolding steps for RNN: 3\n\n![\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2015-07-08 18.13.42.png](https://qiita-image-store.s3.amazonaws.com/0/2238/759a6c74-2eca-265d-55ec-33b411338077.png)\n\n\n**Performance on Specific Ad Positions**\n\n![\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2015-07-08 18.16.15.png](https://qiita-image-store.s3.amazonaws.com/0/2238/de30e225-f4a8-c3b9-f778-7dc0991b0d3b.png)\n\n\n- mainline\u304c\u4e00\u756a\u53ce\u76ca\u3092\u751f\u3080\u306e\u3067RNN\u304c\u3053\u3061\u3089\u3067\u9ad8\u3044\u306e\u306f\u826f\u3044\n- sidebar\u306f\u30af\u30ea\u30c3\u30af\u6570\u304c\u5c11\u306a\u3044\u306e\u3067rare\u30b1\u30fc\u30b9\u306b\u904e\u5270\u53cd\u5fdc\u3059\u308b\u305f\u3081LR\u306f\u4f4e\u304f\u306a\u308b\n\n**Effect of Recurrent State for Inference**\n\nRNN\u3068\u3057\u3066\u5b66\u7fd2\u3057\u305f\u3042\u3068\u306b\u901a\u5e38\u306eNN\u3068\u3057\u3066\u63a8\u5b9a\u3059\u308b\n\u3064\u307e\u308a\u524d\u306e\u7cfb\u5217\u30c7\u30fc\u30bf\u306e\u96a0\u308c\u5c64\u306e\u5024\u3092\u4f7f\u308f\u306a\u3044\u72b6\u614b\u306b\u3059\u308b\n\nAUC: 88.25%\nRIG: 18.95%\n\nTable2\u3068\u6bd4\u8f03\u3057\u3066\u6027\u80fd\u304c\u52a3\u5316\u3057\u3066\u3044\u308b\uff0e\nrecurrent structure\u304c\u63a8\u5b9a\u306b\u5bfe\u3057\u3066\u6709\u52b9\u306b\u50cd\u3044\u3066\u3044\u308b\u3068\u3044\u3048\u308b\uff0e\n\n**Performance with Long vs. Short History**\n\n\u3057\u304d\u3044\u5024T\u4ee5\u4e0a\u306esequence\u3092\u3082\u3064\u30c7\u30fc\u30bf\u3092\u96c6\u3081, T\u3067\u96a0\u308c\u5c64\u306b\u30c7\u30fc\u30bf\u3092\u305f\u3081\u3066\u6b8b\u308a\u3067test\u3092\u884c\u3046\uff0e\nT\u306e\u9577\u3055\u306b\u5bfe\u3057\u3066RNN\u304crobust\u3067\u3042\u308b\u304b\u3092\u78ba\u8a8d\u3059\u308b\n\n![\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2015-07-08 18.33.15.png](https://qiita-image-store.s3.amazonaws.com/0/2238/5b08175b-97ec-cb2c-c92c-833c291e9f85.png)\n\n\nT\u304c\u5927\u304d\u3044\u307b\u3069performance\u304c\u3088\u3044\uff0e\u7cfb\u5217\u30c7\u30fc\u30bf\u306e\u7279\u5fb4\u3092\u3088\u304f\u84c4\u7a4d\u3067\u304d\u3066\u3044\u308b\u3068\u3044\u3048\u308b\n\n**Effect of RNN Unfolding Step**\n\nUnfolding Step: BPTT\u306b\u304a\u3051\u308b\u5b66\u7fd2\u306e\u30b9\u30c6\u30c3\u30d7\u6570\n\n(BPTT\u3088\u304f\u308f\u304b\u3063\u3066\u306a\u3044\u306e\u3067\u4eca\u5ea6\u3061\u3083\u3093\u3068\u8abf\u3079\u308b)\n\nAUC, RIG\u306e\u30d9\u30b9\u30c8\u306f3\uff0c\u305d\u308c\u3088\u308a\u5927\u304d\u306a\u5024\u306b\u3059\u308b\u3068\u6570\u5024\u306f\u843d\u3061\u3066\u3044\u304f(3\u307e\u3067\u306f\u4e0a\u6607\u3059\u308b)\n3\u3088\u308a\u5927\u304d\u3044\u5024\u306b\u3057\u305f\u3068\u304d\u306f\u9006\u4f1d\u642c\u306e\u30a8\u30e9\u30fc\u304c\u6d88\u3048\u308b\n\n\u3053\u308c\u304b\u3089\u3053\u306e\u30e2\u30c7\u30eb\u306f\u7cfb\u5217\u30c7\u30fc\u30bf\u3092\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u6271\u3063\u3066\u3044\u308b\u3068\u63a8\u6e2c\u3067\u304d\u308b\n\n- short-span dependency: \u5c11\u306a\u3044\u5358\u4f4d\u3067\u660e\u793a\u7684\u306b\u5b66\u7fd2\u3057\u3066\u3044\u308b\n- long-span dependency: \u6697\u9ed9\u7684\u306b\u9577\u3044\u30c7\u30fc\u30bf\u3092reccurent\u306a\u69cb\u9020\u306b\u8caf\u3081\u3053\u3093\u3067\u7cbe\u5ea6\u3092\u9ad8\u3081\u3066\u3044\u308b\n\n## Future Work\n\n1. \u4eca\u56de\u306f\u30e6\u30fc\u30b6\u30ec\u30d9\u30eb\u306esequential data\u3092\u6271\u3063\u305f\u3051\u3069(user, ad)\u3068\u304b(user, query)\u306a\u3069\u3088\u308a\u591a\u69d8\u306a\u5f62\u3067\u5b66\u7fd2\u3055\u305b\u305f\u3044\n2. \u4eca\u56de\u5b66\u3093\u3060recurrent\u306a\u90e8\u5206\u306e\u7279\u5fb4\u3092\u6d3b\u304b\u3057\u3066\uff0c\u3088\u308a\u6700\u9069\u5316\u3057\u305f\u5f62\u3067\u6271\u3044\u305f\u3044\n3. Deep Recurrent Neural Network(DRNN)[Hermans+2013]\u3092\u8a66\u3057\u3066\u307f\u305f\u3044\n\n## \u611f\u60f3\n\n- \u30b7\u30f3\u30d7\u30eb\u306aRNN\u3067\u3053\u3053\u307e\u3067\u6539\u5584\u3059\u308b\u306e\u3059\u3054\u3044(\u307b\u3093\u3068\u304b\u3088\u3063\u3066\u6c17\u6301\u3061\u306b\u3082\u306a\u308b)\n- feature\u5168\u7136\u96a0\u3057\u3066\u308b\u3051\u3069\u3053\u3046\u3044\u3046\u306e\u3067\u3082\u8ad6\u6587\u3068\u3057\u3066\u6210\u7acb\u3059\u308b\u3082\u306e\u306a\u306e\u304b\u306a\n    - \u7d20\u6027\u304csequential\u306a\u3068\u3053\u308d\u306b\u4f9d\u5b58\u3057\u3059\u304e\u3066\u3044\u305f\u306e\u3067\u306f\u307f\u305f\u3044\u306a\u61f8\u5ff5\u3082\u3042\u308a\u305d\u3046\u306a\n- \u3053\u3046\u3044\u3046\u30bf\u30b9\u30af\u3044\u308d\u3044\u308d\u3042\u308b\u3068\u601d\u3046\u306e\u3067\u3044\u308d\u3044\u308d\u8a66\u3057\u3066\u307f\u305f\u3044\u3068\u3053\u308d\n- RNN\u306e\u7279\u6027\u306b\u3064\u3044\u3066\u306e\u5206\u6790\u304c\u6df1\u304f\u3066\u53c2\u8003\u306b\u306a\u3063\u305f\uff0e\n", "tags": ["\u8ad6\u6587", "DeepLearning", "\u6a5f\u68b0\u5b66\u7fd2", "\u30a2\u30c9\u30c6\u30af"]}