{"context": " More than 1 year has passed since last update.Activity Recognition \u306b\u7d9a\u3044\u3066\u4f7f\u3063\u3066\u307f\u307e\u3057\u305f\u3002\n\nFused Location Provider \u3068\u306f\uff1f\nGPS \u3068 WiFi \u3068\u30bb\u30f3\u30b5\u30fc(\u52a0\u901f\u5ea6\u306a\u3069) \u3092\u7d44\u307f\u5408\u308f\u305b\u3066\u3001\u305d\u306e\u72b6\u6cc1\u306b\u5fdc\u3058\u305f\u6700\u9069\u306a\u65b9\u6cd5\u3067\u4f4d\u7f6e\u3092\u53d6\u5f97\u51fa\u6765\u307e\u3059\u3002\u4eca\u307e\u3067\u3088\u308a\u3082\u4f4e\u6d88\u8cbb\u96fb\u529b\u3067\u3001\u7cbe\u5ea6\u306e\u3088\u3044\u4f4d\u7f6e\u60c5\u5831\u3092\u3002\n\u5b9f\u969b\u3069\u3093\u306a\u611f\u3058\u304b\u306f\u3001Google I/O 2013 \u306e\u30bb\u30c3\u30b7\u30e7\u30f3\u52d5\u753b\u306b\u3042\u308b Fused Location Provider \u306e\u30c7\u30e2 \u3092\u898b\u3066\u304f\u3060\u3055\u3044\u3002\n\u6b21\u304b\u3089\u4f7f\u3044\u65b9\u3067\u3059\u3002\n\n1. SDK \u306e Google Play Services \u3092\u66f4\u65b0\u3059\u308b\n\nActivity Recognition \u3068\u540c\u3058\u304f Google Play services \u3068\u3057\u3066\u63d0\u4f9b\u3055\u308c\u3066\u3044\u308b\u306e\u3067\u3001SDK Manager \u3067\u30e9\u30a4\u30d6\u30e9\u30ea\u3092\u66f4\u65b0\u3057\u307e\u3059\u3002\n\n2. Eclipse \u3067\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092\u4f5c\u308b\nAndroid Studio \u306f\u4f7f\u3063\u3066\u307e\u305b\u3093(\u307e\u3060\u3088\u304f\u308f\u304b\u3089\u306a\u3044\u306e\u3067)\nEclipse \u3067\u3001\u3044\u3064\u3082\u3069\u304a\u308a\u306b Android \u306e\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092\u4f5c\u308a\u307e\u3059\u3002\nFragment \u3082\u4f7f\u3044\u307e\u305b\u3093\u3088\u3001\u53e4\u304d\u3088\u304d\u3001BlankActivity \u306a\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3067\u3059\u3002\n\u540d\u524d\u306f\u3053\u3053\u3067\u306f FusedLocationProviderSample \u3068\u3057\u307e\u3059\u3002\n\n3. \u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306b google-play-services_lib \u3092\u8ffd\u52a0\u3059\u308b\nGoogle Play services \u3092\u4f7f\u3046\u305f\u3081\u306b\u3001SDK \u306e\u30d5\u30a9\u30eb\u30c0\u306b\u3042\u308b google-play-services_lib \u304c\u5fc5\u8981\u3067\u3059\u3002\nEcplise \u306e Import \u3067 {your sdk location}/extras/google/google_play_services/libproject/google-play-services_lib \u3092\u9078\u629e\u3057\u307e\u3059\u3002\u81ea\u5206\u306e Workspace \u306b Copy \u3057\u3066\u304a\u3044\u305f\u65b9\u304c\u7121\u96e3\u3067\u3057\u3087\u3046\u3002\n\u30b3\u30d4\u30fc\u3057\u305f\u3089\u3001FusedLocationProviderSample \u3067\u3001 google-play-services_lib \u3092\u30e9\u30a4\u30d6\u30e9\u30ea\u53c2\u7167\u3057\u307e\u3059\u3002\n\n\u6b21\u304b\u3089 FusedLocationProviderSample \u306e\u5b9f\u88c5\u3067\u3059\u3002\n\n4. AndroidManifest.xml \u306e\u7de8\u96c6\nFused Location Provider \u3092\u4f7f\u3046\u306e\u306b\u306f\u4eca\u307e\u3067\u901a\u308a\u3001ACCESS_FINE_LOCATION \u3068 ACCESS_COARSE_LOCATION \u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\nLocationClient \u306f\u3001\u6307\u5b9a\u3057\u305f PERMISSION \u306b\u5fdc\u3058\u3066\u3088\u3057\u306a\u306b\u52d5\u3044\u3066\u304f\u308c\u308b\u305d\u3046\u3067\u3059\u3002\n\nAndroidManifest.xml\n<?xml version=\"1.0\" encoding=\"utf-8\"?>\n<manifest xmlns:android=\"http://schemas.android.com/apk/res/android\"\n    package=\"com.example.fusedlocationprovidersample\"\n    android:versionCode=\"1\"\n    android:versionName=\"1.0\" >\n\n    <uses-sdk\n        android:minSdkVersion=\"8\"\n        android:targetSdkVersion=\"17\" />\n    <uses-permission android:name=\"android.permission.ACCESS_FINE_LOCATION\"/>\n    <uses-permission android:name=\"android.permission.ACCESS_COARSE_LOCATION\"/>\n\n    <application\n        android:allowBackup=\"true\"\n        android:icon=\"@drawable/ic_launcher\"\n        android:label=\"@string/app_name\"\n        android:theme=\"@style/AppTheme\" >\n        <activity\n            android:name=\"com.example.fusedlocationprovidersample.MainActivity\"\n            android:screenOrientation=\"portrait\"\n            android:label=\"@string/app_name\" >\n            <intent-filter>\n                <action android:name=\"android.intent.action.MAIN\" />\n\n                <category android:name=\"android.intent.category.LAUNCHER\" />\n            </intent-filter>\n        </activity>\n    </application>\n\n</manifest>\n\n\n\n5. Fused Location Provider \u3092\u4f7f\u3046\nActivityRecognition \u306f IntentService \u3092\u4f7f\u3046\u5fc5\u8981\u304c\u3042\u3063\u305f\u305f\u3081\u306b\u5c11\u3005\u9577\u3044\u30b3\u30fc\u30c9\u306b\u306a\u308a\u307e\u3057\u305f\u304c\u3001\u3053\u3061\u3089\u306f\u4eca\u307e\u3067\u306e LocationProvider \u304c(\u3082)\u4f7f\u3048\u308b\u306e\u3067\u3001\u753b\u9762\u4e00\u3064\u3060\u3051\u306e\u30b7\u30f3\u30d7\u30eb\u306a\u30b3\u30fc\u30c9\u3067\u3059\u3002\nFusedLocationProvider \u3092\u4f7f\u3046\u306b\u306f\u3001LocationClient \u30af\u30e9\u30b9\u3092\u4f7f\u3044\u307e\u3059\u3002\n\u5927\u96d1\u628a\u306a\u6d41\u308c\u306f:\n\n\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u3092\u751f\u6210\u3059\u308b\nconnect \u3092\u547c\u3076 -> ConnectionCallbacks.onConnected \u304c\u30b3\u30fc\u30eb\u30d0\u30c3\u30af\u3055\u308c\u308b\n\nLocationRequest \u3092\u6307\u5b9a\u3057\u3066\u3001requestLocationUpdates \u3092\u547c\u3076\u3002 -> LocationListener.onLocationChanged \u304c\u547c\u3070\u308c\u308b\n\n\u3067\u3059\u3002connect \u3092\u547c\u3093\u3067 onConnected \u3092\u5f85\u3064\u306e\u3068\u3001\u4f4d\u7f6e\u53d6\u5f97\u6761\u4ef6\u304c LocationRequest \u30af\u30e9\u30b9\u306b\u306a\u3063\u305f\u4ee5\u5916\u306f LocationManager \u3068\u540c\u3058\u3067\u3059\u3002\n\u3067\u306f\u3001\u5168\u30b3\u30fc\u30c9\u3067\u3059\u3002\n\nMainActivity.java\npackage com.example.fusedlocationprovidersample;\n\nimport com.google.android.gms.common.ConnectionResult;\nimport com.google.android.gms.common.GooglePlayServicesClient.ConnectionCallbacks;\nimport com.google.android.gms.common.GooglePlayServicesClient.OnConnectionFailedListener;\nimport com.google.android.gms.location.LocationClient;\nimport com.google.android.gms.location.LocationListener;\nimport com.google.android.gms.location.LocationRequest;\nimport android.location.Location;\nimport android.os.Bundle;\nimport android.text.format.DateFormat;\nimport android.view.View;\nimport android.view.View.OnClickListener;\nimport android.widget.Button;\nimport android.widget.TextView;\nimport android.app.Activity;\n\npublic class MainActivity extends Activity {\n\n    // FusedLocationProvider \u7528\u306e Client\n    private LocationClient _locationClient;\n    private TextView _textResult;\n\n    // \u4ee5\u524d\u3068\u306f package \u304c\u9055\u3046 LocationListener\n    private final LocationListener _locationListener = new LocationListener() {\n\n        @Override\n        public void onLocationChanged(final Location location) {\n            MainActivity.this.runOnUiThread(new Runnable() {\n                @Override\n                public void run() {\n                    String text = _textResult.getText().toString();\n                    text = DateFormat.format(\"hh:mm:ss.sss\", location.getTime()) + \" - \" \n                            + location.getLatitude() + \"/\" +\n                            + location.getLongitude() + \"/\" +\n                            + location.getAccuracy() + \n                            \"\\n\" + text;\n\n                    _textResult.setText(text);\n                }\n            });\n        }\n    };\n\n    @Override\n    protected void onCreate(Bundle savedInstanceState) {\n        super.onCreate(savedInstanceState);\n        setContentView(R.layout.activity_main);\n\n        _textResult = (TextView)findViewById(R.id.text_result);\n\n        final Button buttonLocate = (Button)findViewById(R.id.button_locate);\n        buttonLocate.setOnClickListener(new OnClickListener() {\n            private boolean _isStarted = false;\n\n            @Override\n            public void onClick(View v) {\n                if (!_isStarted) {\n                    startLocate();\n                    buttonLocate.setText(\"Stop\");\n                } else {\n                    stopLocate();\n                    buttonLocate.setText(\"Start\");\n                }\n\n                _isStarted = !_isStarted;\n            }\n        });\n    }\n\n    @Override\n    protected void onDestroy() {\n        stopLocate();\n        super.onDestroy();\n    }\n\n    private void startLocate() {\n        _locationClient = new LocationClient(this, new ConnectionCallbacks() {\n\n            @Override\n            public void onConnected(Bundle bundle) {\n                // 2. \u4f4d\u7f6e\u306e\u53d6\u5f97\u958b\u59cb\uff01\n                LocationRequest request = LocationRequest.create()\n                .setPriority(LocationRequest.PRIORITY_HIGH_ACCURACY)\n                .setInterval(5000); // 5\u79d2\u304a\u304d\n                _locationClient.requestLocationUpdates(request, _locationListener);\n            }\n\n            @Override\n            public void onDisconnected() {\n                _locationClient = null;\n            }\n\n        }, new OnConnectionFailedListener() {\n            @Override\n            public void onConnectionFailed(ConnectionResult result) {\n            }\n        });\n\n        // 1. \u4f4d\u7f6e\u53d6\u5f97\u30b5\u30fc\u30d3\u30b9\u306b\u63a5\u7d9a\uff01\n        _locationClient.connect();\n    }\n\n    private void stopLocate() {\n        if (_locationClient == null || !_locationClient.isConnected()) {\n            return;\n        }\n\n        _locationClient.removeLocationUpdates(_locationListener);\n        _locationClient.disconnect();\n        // ConnectionCallbacks.onDisconnected \u304c\u547c\u3070\u308c\u308b\u307e\u3067\u5f85\u3063\u305f\u65b9\u304c\u3044\u3044\u6c17\u304c\u3059\u308b\n    }\n}\n\n\n\n6. \u52d5\u304f\u306e\u304b\uff01\uff1f\nHTC J(not\u8776) \u3067\u52d5\u304b\u3057\u3066\u307f\u307e\u3057\u305f\u3002\n\n\u5ba4\u5185\u3067\u306e\u7d50\u679c\u3067\u3059\u304c\u3001\u6700\u521d 27m \u306e\u7cbe\u5ea6\u3060\u3063\u305f\u306e\u304c\u3001\u653e\u3063\u3066\u304a\u304f\u3068\u3069\u3093\u3069\u3093\u7cbe\u5ea6\u304c\u4e0a\u304c\u3063\u3066\u884c\u304d\u307e\u3057\u305f\u3002\u304c\u3001\u5730\u56f3\u306b\u91cd\u306d\u3066\u307f\u306a\u3044\u3068\u5b9f\u969b\u5408\u3063\u3066\u308b\u306e\u304b\u3088\u304f\u308f\u304b\u308a\u307e\u305b\u3093\u306d\u3002\n\u305d\u306e\u3046\u3061\u3001\u5730\u56f3\u306b\u8f09\u305b\u3066\u691c\u8a3c\u3057\u3066\u307f\u305f\u3044\u3067\u3059\u3002\n\nPermission \u3068 Priority \u3068\u7cbe\u5ea6\u306e\u8a71\nPermission \u3068 Priority \u306e\u7d44\u307f\u5408\u308f\u305b\u3067\u3001\u4f4d\u7f6e\u306e\u7cbe\u5ea6\u304c\u3069\u3046\u5909\u308f\u308b\u304b\u3001\u5c11\u3057\u8abf\u3079\u307e\u3057\u305f\u3002\n\nFINE_LOCATION+COARSE_LOCATION with PRIORITY_HIGH_ACCURACY\nGPS \u3068 WiFi \u3068 \u30bb\u30f3\u30b5\u30fc\u30d5\u30eb\u6d3b\u7528\u3002GPS \u304c\u6355\u6349\u3067\u304d\u306a\u304f\u3066\u3082\u6570\u5341\uff4d\u306e\u4f4d\u7f6e\u7cbe\u5ea6\u304c\u6982\u306d\u51fa\u308b\u3088\u3046\u3067\u3059\u3002\n\nCOARSE_LOCATION with PRIORITY_HIGH_ACCURACY\n\u4f7f\u3048\u306a\u3044\u3002FINE_LOCATION \u304c\u5fc5\u8981\u3063\u3066\u30a8\u30e9\u30fc\u306b\u306a\u308a\u307e\u3057\u305f\u3002\n\nClient must have ACCESS_FINE_LOCATION permission to request PRIORITY_HIGH_ACCURACY locations.\n\n\nCOARSE_LOCATION with  PRIORITY_BALANCED_POWER_ACCURACY\n\u4f4d\u7f6e\u306e\u7cbe\u5ea6\u304c\u6570km\u7a0b\u5ea6\u306b\u306a\u308a\u307e\u3057\u305f\u3002WiFi\u6e2c\u4f4d(\u5f93\u6765\u306e NETWORK_PROVIDER)\u3088\u308a\u3082\u60aa\u3044\u3067\u3059\u3002\u3046\u30fc\u3093\u3053\u308c\u306f\u671f\u5f85\u306f\u305a\u308c\u3060\u306a\u3042\u3002\n\u7d50\u5c40\u3001\u4f8b\u3048\u3070\u5c4b\u5185\u6e2c\u4f4d\u3067\u3057\u304b\u4f7f\u308f\u306a\u3044\u304b\u3089GPS\u8981\u3089\u306d\u3063\u3066 FINE_LOCATION \u3092\u5916\u3059\u3068\u3001\u304b\u3048\u3063\u3066\u7cbe\u5ea6\u304c\u843d\u3061\u308b\u3068\u3044\u3046\u4e8b\u306b\u306a\u308a\u307e\u3059\u3002(GPS\u4f7f\u3044\u307e\u305b\u3093PERMISSION\u304c\u6b32\u3057\u3044\u306a\u3002\u3002\u3002)\n\n\u304a\u307e\u3051\n\nGoogle Maps Android API v2 Release Notes - Google Maps Android API v2 \u2014 Google Developers\n\n\u306b\u3088\u308b\u3068\u3001Google Maps Android API v2 \u306e [setMyLocationEnabled(true)](https://developers.google.com/maps/documentation/android/reference/com/google/android/gms/maps/GoogleMap#setMyLocationEnabled(boolean) \u3067\u3082 FusedLocationProvider \u304c\u4f7f\u308f\u308c\u308b\u3088\u3046\u306b\u306a\u3063\u305f\u3068\u306e\u3053\u3068\u3067\u3059\u3002\n\n\u307e\u3068\u3081\n\u516c\u5f0f\u306e\u30b3\u30f3\u30d7\u30ea\u30fc\u30c8\u306a Getting Started \u306f\n\nRetrieving the Current Location | Android Developers\n\n\u306b\u3042\u308a\u307e\u3059\u306e\u3067\u3001\u3053\u3061\u3089\u3092\u8aad\u307e\u308c\u305f\u65b9\u304c\u78ba\u5b9f\u3067\u3059\u3002\n\u3053\u3053\u3067\u4f5c\u3063\u305f\u30b5\u30f3\u30d7\u30eb\u306f\u3001\n\namay077/fusedlocationprovidersample \u00b7 GitHub\n\n\u306b\u7f6e\u3044\u3066\u304a\u304d\u307e\u3059\u3002\n\n[Activity Recognition](http://amay077.github.io/blog/2013/05/18/getting-started-activity-recognition/) \u306b\u7d9a\u3044\u3066\u4f7f\u3063\u3066\u307f\u307e\u3057\u305f\u3002\n\n## Fused Location Provider \u3068\u306f\uff1f\n\nGPS \u3068 WiFi \u3068\u30bb\u30f3\u30b5\u30fc(\u52a0\u901f\u5ea6\u306a\u3069) \u3092\u7d44\u307f\u5408\u308f\u305b\u3066\u3001\u305d\u306e\u72b6\u6cc1\u306b\u5fdc\u3058\u305f\u6700\u9069\u306a\u65b9\u6cd5\u3067\u4f4d\u7f6e\u3092\u53d6\u5f97\u51fa\u6765\u307e\u3059\u3002\u4eca\u307e\u3067\u3088\u308a\u3082\u4f4e\u6d88\u8cbb\u96fb\u529b\u3067\u3001\u7cbe\u5ea6\u306e\u3088\u3044\u4f4d\u7f6e\u60c5\u5831\u3092\u3002\n\n\u5b9f\u969b\u3069\u3093\u306a\u611f\u3058\u304b\u306f\u3001Google I/O 2013 \u306e\u30bb\u30c3\u30b7\u30e7\u30f3\u52d5\u753b\u306b\u3042\u308b [Fused Location Provider \u306e\u30c7\u30e2](http://www.youtube.com/watch?feature=player_detailpage&v=URcVZybzMUI#t=733s) \u3092\u898b\u3066\u304f\u3060\u3055\u3044\u3002\n\n\u6b21\u304b\u3089\u4f7f\u3044\u65b9\u3067\u3059\u3002\n\n## 1. SDK \u306e Google Play Services \u3092\u66f4\u65b0\u3059\u308b\n\n![image1](https://dl.dropboxusercontent.com/u/264530/qiita/getting_started_activity_recognition1.png)\n\nActivity Recognition \u3068\u540c\u3058\u304f Google Play services \u3068\u3057\u3066\u63d0\u4f9b\u3055\u308c\u3066\u3044\u308b\u306e\u3067\u3001SDK Manager \u3067\u30e9\u30a4\u30d6\u30e9\u30ea\u3092\u66f4\u65b0\u3057\u307e\u3059\u3002\n\n## 2. Eclipse \u3067\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092\u4f5c\u308b\n\nAndroid Studio \u306f\u4f7f\u3063\u3066\u307e\u305b\u3093(\u307e\u3060\u3088\u304f\u308f\u304b\u3089\u306a\u3044\u306e\u3067)\nEclipse \u3067\u3001\u3044\u3064\u3082\u3069\u304a\u308a\u306b Android \u306e\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092\u4f5c\u308a\u307e\u3059\u3002\nFragment \u3082\u4f7f\u3044\u307e\u305b\u3093\u3088\u3001\u53e4\u304d\u3088\u304d\u3001BlankActivity \u306a\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3067\u3059\u3002\n\u540d\u524d\u306f\u3053\u3053\u3067\u306f FusedLocationProviderSample \u3068\u3057\u307e\u3059\u3002\n\n## 3. \u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306b google-play-services_lib \u3092\u8ffd\u52a0\u3059\u308b\n\nGoogle Play services \u3092\u4f7f\u3046\u305f\u3081\u306b\u3001SDK \u306e\u30d5\u30a9\u30eb\u30c0\u306b\u3042\u308b google-play-services_lib \u304c\u5fc5\u8981\u3067\u3059\u3002\n\nEcplise \u306e Import \u3067 ``{your sdk location}/extras/google/google_play_services/libproject/google-play-services_lib`` \u3092\u9078\u629e\u3057\u307e\u3059\u3002\u81ea\u5206\u306e Workspace \u306b Copy \u3057\u3066\u304a\u3044\u305f\u65b9\u304c\u7121\u96e3\u3067\u3057\u3087\u3046\u3002\n\n\u30b3\u30d4\u30fc\u3057\u305f\u3089\u3001FusedLocationProviderSample \u3067\u3001 google-play-services_lib \u3092\u30e9\u30a4\u30d6\u30e9\u30ea\u53c2\u7167\u3057\u307e\u3059\u3002\n\n![image2](https://dl.dropboxusercontent.com/u/264530/qiita/getting_started_activity_recognition2.png)\n\n\u6b21\u304b\u3089 FusedLocationProviderSample \u306e\u5b9f\u88c5\u3067\u3059\u3002\n\n## 4. AndroidManifest.xml \u306e\u7de8\u96c6\n\nFused Location Provider \u3092\u4f7f\u3046\u306e\u306b\u306f\u4eca\u307e\u3067\u901a\u308a\u3001``ACCESS_FINE_LOCATION`` \u3068 ``ACCESS_COARSE_LOCATION`` \u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n\nLocationClient \u306f\u3001\u6307\u5b9a\u3057\u305f PERMISSION \u306b\u5fdc\u3058\u3066\u3088\u3057\u306a\u306b\u52d5\u3044\u3066\u304f\u308c\u308b\u305d\u3046\u3067\u3059\u3002\n\n```xml:AndroidManifest.xml\n<?xml version=\"1.0\" encoding=\"utf-8\"?>\n<manifest xmlns:android=\"http://schemas.android.com/apk/res/android\"\n    package=\"com.example.fusedlocationprovidersample\"\n    android:versionCode=\"1\"\n    android:versionName=\"1.0\" >\n\n    <uses-sdk\n        android:minSdkVersion=\"8\"\n        android:targetSdkVersion=\"17\" />\n    <uses-permission android:name=\"android.permission.ACCESS_FINE_LOCATION\"/>\n    <uses-permission android:name=\"android.permission.ACCESS_COARSE_LOCATION\"/>\n\n    <application\n        android:allowBackup=\"true\"\n        android:icon=\"@drawable/ic_launcher\"\n        android:label=\"@string/app_name\"\n        android:theme=\"@style/AppTheme\" >\n        <activity\n            android:name=\"com.example.fusedlocationprovidersample.MainActivity\"\n            android:screenOrientation=\"portrait\"\n            android:label=\"@string/app_name\" >\n            <intent-filter>\n                <action android:name=\"android.intent.action.MAIN\" />\n\n                <category android:name=\"android.intent.category.LAUNCHER\" />\n            </intent-filter>\n        </activity>\n    </application>\n\n</manifest>\n```\n\n## 5. Fused Location Provider \u3092\u4f7f\u3046\n\nActivityRecognition \u306f IntentService \u3092\u4f7f\u3046\u5fc5\u8981\u304c\u3042\u3063\u305f\u305f\u3081\u306b\u5c11\u3005\u9577\u3044\u30b3\u30fc\u30c9\u306b\u306a\u308a\u307e\u3057\u305f\u304c\u3001\u3053\u3061\u3089\u306f\u4eca\u307e\u3067\u306e ``LocationProvider`` \u304c(\u3082)\u4f7f\u3048\u308b\u306e\u3067\u3001\u753b\u9762\u4e00\u3064\u3060\u3051\u306e\u30b7\u30f3\u30d7\u30eb\u306a\u30b3\u30fc\u30c9\u3067\u3059\u3002\n\nFusedLocationProvider \u3092\u4f7f\u3046\u306b\u306f\u3001[LocationClient](http://developer.android.com/reference/com/google/android/gms/location/LocationClient.html) \u30af\u30e9\u30b9\u3092\u4f7f\u3044\u307e\u3059\u3002\n\n\u5927\u96d1\u628a\u306a\u6d41\u308c\u306f:\n\n1. \u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u3092\u751f\u6210\u3059\u308b\nconnect \u3092\u547c\u3076 -> ConnectionCallbacks.onConnected \u304c\u30b3\u30fc\u30eb\u30d0\u30c3\u30af\u3055\u308c\u308b\n2. [LocationRequest](http://developer.android.com/reference/com/google/android/gms/location/LocationRequest.html) \u3092\u6307\u5b9a\u3057\u3066\u3001requestLocationUpdates \u3092\u547c\u3076\u3002 -> LocationListener.onLocationChanged \u304c\u547c\u3070\u308c\u308b\n\n\u3067\u3059\u3002connect \u3092\u547c\u3093\u3067 onConnected \u3092\u5f85\u3064\u306e\u3068\u3001\u4f4d\u7f6e\u53d6\u5f97\u6761\u4ef6\u304c ``LocationRequest`` \u30af\u30e9\u30b9\u306b\u306a\u3063\u305f\u4ee5\u5916\u306f ``LocationManager`` \u3068\u540c\u3058\u3067\u3059\u3002\n\n\u3067\u306f\u3001\u5168\u30b3\u30fc\u30c9\u3067\u3059\u3002\n\n```java:MainActivity.java\npackage com.example.fusedlocationprovidersample;\n\nimport com.google.android.gms.common.ConnectionResult;\nimport com.google.android.gms.common.GooglePlayServicesClient.ConnectionCallbacks;\nimport com.google.android.gms.common.GooglePlayServicesClient.OnConnectionFailedListener;\nimport com.google.android.gms.location.LocationClient;\nimport com.google.android.gms.location.LocationListener;\nimport com.google.android.gms.location.LocationRequest;\nimport android.location.Location;\nimport android.os.Bundle;\nimport android.text.format.DateFormat;\nimport android.view.View;\nimport android.view.View.OnClickListener;\nimport android.widget.Button;\nimport android.widget.TextView;\nimport android.app.Activity;\n\npublic class MainActivity extends Activity {\n\t\n\t// FusedLocationProvider \u7528\u306e Client\n\tprivate LocationClient _locationClient;\n\tprivate TextView _textResult;\n\t\n\t// \u4ee5\u524d\u3068\u306f package \u304c\u9055\u3046 LocationListener\n    private final LocationListener _locationListener = new LocationListener() {\n\t\t\n\t\t@Override\n\t\tpublic void onLocationChanged(final Location location) {\n\t\t\tMainActivity.this.runOnUiThread(new Runnable() {\n\t\t\t\t@Override\n\t\t\t\tpublic void run() {\n\t\t\t\t\tString text = _textResult.getText().toString();\n\t\t            text = DateFormat.format(\"hh:mm:ss.sss\", location.getTime()) + \" - \" \n\t\t                    + location.getLatitude() + \"/\" +\n\t\t                    + location.getLongitude() + \"/\" +\n\t\t                    + location.getAccuracy() + \n\t\t                    \"\\n\" + text;\n\n\t\t            _textResult.setText(text);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t};\n\t\n\t@Override\n\tprotected void onCreate(Bundle savedInstanceState) {\n\t\tsuper.onCreate(savedInstanceState);\n\t\tsetContentView(R.layout.activity_main);\n\t\t\n\t\t_textResult = (TextView)findViewById(R.id.text_result);\n\t\t\n\t\tfinal Button buttonLocate = (Button)findViewById(R.id.button_locate);\n\t\tbuttonLocate.setOnClickListener(new OnClickListener() {\n\t\t\tprivate boolean _isStarted = false;\n\t\t\t\n\t\t\t@Override\n\t\t\tpublic void onClick(View v) {\n\t\t\t\tif (!_isStarted) {\n\t\t\t\t\tstartLocate();\n\t\t\t\t\tbuttonLocate.setText(\"Stop\");\n\t\t\t\t} else {\n\t\t\t\t\tstopLocate();\n\t\t\t\t\tbuttonLocate.setText(\"Start\");\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t_isStarted = !_isStarted;\n\t\t\t}\n\t\t});\n\t}\n\t\n\t@Override\n\tprotected void onDestroy() {\n\t\tstopLocate();\n\t\tsuper.onDestroy();\n\t}\n\t\n\tprivate void startLocate() {\n\t\t_locationClient = new LocationClient(this, new ConnectionCallbacks() {\n\n\t\t\t@Override\n            public void onConnected(Bundle bundle) {\n\t\t\t\t// 2. \u4f4d\u7f6e\u306e\u53d6\u5f97\u958b\u59cb\uff01\n\t\t\t\tLocationRequest request = LocationRequest.create()\n\t\t\t\t.setPriority(LocationRequest.PRIORITY_HIGH_ACCURACY)\n\t\t\t\t.setInterval(5000); // 5\u79d2\u304a\u304d\n            \t_locationClient.requestLocationUpdates(request, _locationListener);\n            }\n\n            @Override\n            public void onDisconnected() {\n            \t_locationClient = null;\n            }\n\n        }, new OnConnectionFailedListener() {\n            @Override\n            public void onConnectionFailed(ConnectionResult result) {\n            }\n        });\n\t\t\n\t\t// 1. \u4f4d\u7f6e\u53d6\u5f97\u30b5\u30fc\u30d3\u30b9\u306b\u63a5\u7d9a\uff01\n\t\t_locationClient.connect();\n\t}\n\n\tprivate void stopLocate() {\n\t\tif (_locationClient == null || !_locationClient.isConnected()) {\n\t\t\treturn;\n\t\t}\n\t\t\n\t\t_locationClient.removeLocationUpdates(_locationListener);\n\t\t_locationClient.disconnect();\n\t\t// ConnectionCallbacks.onDisconnected \u304c\u547c\u3070\u308c\u308b\u307e\u3067\u5f85\u3063\u305f\u65b9\u304c\u3044\u3044\u6c17\u304c\u3059\u308b\n\t}\n}\n```\n\n## 6. \u52d5\u304f\u306e\u304b\uff01\uff1f\n\nHTC J(not\u8776) \u3067\u52d5\u304b\u3057\u3066\u307f\u307e\u3057\u305f\u3002\n\n![image3](https://dl.dropboxusercontent.com/u/264530/qiita/getting_started_fused_location_provider1.png)\n\n\u5ba4\u5185\u3067\u306e\u7d50\u679c\u3067\u3059\u304c\u3001\u6700\u521d 27m \u306e\u7cbe\u5ea6\u3060\u3063\u305f\u306e\u304c\u3001\u653e\u3063\u3066\u304a\u304f\u3068\u3069\u3093\u3069\u3093\u7cbe\u5ea6\u304c\u4e0a\u304c\u3063\u3066\u884c\u304d\u307e\u3057\u305f\u3002\u304c\u3001\u5730\u56f3\u306b\u91cd\u306d\u3066\u307f\u306a\u3044\u3068\u5b9f\u969b\u5408\u3063\u3066\u308b\u306e\u304b\u3088\u304f\u308f\u304b\u308a\u307e\u305b\u3093\u306d\u3002\n\n\u305d\u306e\u3046\u3061\u3001\u5730\u56f3\u306b\u8f09\u305b\u3066\u691c\u8a3c\u3057\u3066\u307f\u305f\u3044\u3067\u3059\u3002\n\n## Permission \u3068 Priority \u3068\u7cbe\u5ea6\u306e\u8a71\n\nPermission \u3068 Priority \u306e\u7d44\u307f\u5408\u308f\u305b\u3067\u3001\u4f4d\u7f6e\u306e\u7cbe\u5ea6\u304c\u3069\u3046\u5909\u308f\u308b\u304b\u3001\u5c11\u3057\u8abf\u3079\u307e\u3057\u305f\u3002\n\n### FINE_LOCATION+COARSE_LOCATION with PRIORITY_HIGH_ACCURACY\n\nGPS \u3068 WiFi \u3068 \u30bb\u30f3\u30b5\u30fc\u30d5\u30eb\u6d3b\u7528\u3002GPS \u304c\u6355\u6349\u3067\u304d\u306a\u304f\u3066\u3082\u6570\u5341\uff4d\u306e\u4f4d\u7f6e\u7cbe\u5ea6\u304c\u6982\u306d\u51fa\u308b\u3088\u3046\u3067\u3059\u3002\n\n### COARSE_LOCATION with PRIORITY_HIGH_ACCURACY\n\n\u4f7f\u3048\u306a\u3044\u3002FINE_LOCATION \u304c\u5fc5\u8981\u3063\u3066\u30a8\u30e9\u30fc\u306b\u306a\u308a\u307e\u3057\u305f\u3002\n\n> Client must have ACCESS_FINE_LOCATION permission to request PRIORITY_HIGH_ACCURACY locations.\n\n### COARSE_LOCATION with  PRIORITY_BALANCED_POWER_ACCURACY \n\n\u4f4d\u7f6e\u306e\u7cbe\u5ea6\u304c\u6570km\u7a0b\u5ea6\u306b\u306a\u308a\u307e\u3057\u305f\u3002WiFi\u6e2c\u4f4d(\u5f93\u6765\u306e NETWORK_PROVIDER)\u3088\u308a\u3082\u60aa\u3044\u3067\u3059\u3002\u3046\u30fc\u3093\u3053\u308c\u306f\u671f\u5f85\u306f\u305a\u308c\u3060\u306a\u3042\u3002\n\n\u7d50\u5c40\u3001\u4f8b\u3048\u3070\u5c4b\u5185\u6e2c\u4f4d\u3067\u3057\u304b\u4f7f\u308f\u306a\u3044\u304b\u3089GPS\u8981\u3089\u306d\u3063\u3066 FINE_LOCATION \u3092\u5916\u3059\u3068\u3001\u304b\u3048\u3063\u3066\u7cbe\u5ea6\u304c\u843d\u3061\u308b\u3068\u3044\u3046\u4e8b\u306b\u306a\u308a\u307e\u3059\u3002(GPS\u4f7f\u3044\u307e\u305b\u3093PERMISSION\u304c\u6b32\u3057\u3044\u306a\u3002\u3002\u3002)\n\n## \u304a\u307e\u3051\n\n* [Google Maps Android API v2 Release Notes - Google Maps Android API v2 \u2014 Google Developers](https://developers.google.com/maps/documentation/android/releases#may_2013)\n\n\u306b\u3088\u308b\u3068\u3001Google Maps Android API v2 \u306e [setMyLocationEnabled(true)](https://developers.google.com/maps/documentation/android/reference/com/google/android/gms/maps/GoogleMap#setMyLocationEnabled(boolean) \u3067\u3082 FusedLocationProvider \u304c\u4f7f\u308f\u308c\u308b\u3088\u3046\u306b\u306a\u3063\u305f\u3068\u306e\u3053\u3068\u3067\u3059\u3002\n\n\n## \u307e\u3068\u3081\n\n\u516c\u5f0f\u306e\u30b3\u30f3\u30d7\u30ea\u30fc\u30c8\u306a Getting Started \u306f\n\n* [Retrieving the Current Location | Android Developers](http://developer.android.com/training/location/retrieve-current.html)\n\n\u306b\u3042\u308a\u307e\u3059\u306e\u3067\u3001\u3053\u3061\u3089\u3092\u8aad\u307e\u308c\u305f\u65b9\u304c\u78ba\u5b9f\u3067\u3059\u3002\n\n\u3053\u3053\u3067\u4f5c\u3063\u305f\u30b5\u30f3\u30d7\u30eb\u306f\u3001\n\n* [amay077/fusedlocationprovidersample \u00b7 GitHub](https://github.com/amay077/fusedlocationprovidersample)\n\n\u306b\u7f6e\u3044\u3066\u304a\u304d\u307e\u3059\u3002", "tags": ["GoogleMapsAPI", "Android"]}