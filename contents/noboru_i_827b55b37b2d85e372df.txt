{"context": " More than 1 year has passed since last update.\n\n\u767a\u884c\u3057\u305f\u3044\u30ea\u30af\u30a8\u30b9\u30c8\n\nPOST body\u304c\u30d0\u30a4\u30ca\u30ea\u30c7\u30fc\u30bf\u3067\u59cb\u307e\u308b\uff08!= multipart/form-data\uff09\nContent-Type\u306fapplication/octet-stream\n\n\nPOST /storage/files/XXX/upload HTTP/1.1\nHost: hoge.example.com\nContent-Type: application/octet-stream\nContent-Length: 1601207\nFileName: test.jpg\n\n(\u3053\u3053\u306b\u30d0\u30a4\u30ca\u30ea\u30c7\u30fc\u30bf)\n\n\u3053\u3061\u3089\u306b\u8a18\u8f09\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u53c2\u8003\u306b\u3057\u307e\u3057\u305f\u3002\n\n\u5b9f\u88c5\n+ (void)uploadFile:(NSData *)fileData fileName:(NSString *)fileName callback:(RequestCallback)callback {\n    NSString *folderId = @\"XXX\";\n    NSString *url = [NSString stringWithFormat:@\"%@/storage/files/%@/upload\", @\"https://hoge.example.com\", folderId];\n\n    NSMutableURLRequest *request = [[NSMutableURLRequest alloc] initWithURL:[NSURL URLWithString:url]];\n    request.HTTPMethod = @\"POST\";\n    [request setValue:@\"application/octet-stream\" forHTTPHeaderField:@\"Content-Type\"];\n    [request setValue:fileName forHTTPHeaderField:@\"FileName\"];\n    [request setHTTPBody:fileData];\n    AFHTTPRequestOperation *operation = [[AFHTTPRequestOperation alloc] initWithRequest:request];\n    [operation setCompletionBlockWithSuccess:^(AFHTTPRequestOperation *operation, id responseObject) {\n        NSLog(@\"responseObject = %@\", responseObject);\n        callback();\n    } failure:^(AFHTTPRequestOperation *operation, NSError *error) {\n        callback();\n    }];\n    [operation start];\n}\n\n\nCallback\u5468\u308a\u306f\u3001\u3066\u304d\u3068\u30fc\u3067\u3059\u3002\n\n\u3061\u306a\u307f\u306bAndroid\u3067\u306f\nRetrofit\u3092\u4f7f\u3048\u3070\u3001\u7c21\u5358\u3067\u3059\u3002\n@Headers(\"Content-Type: application/octet-stream\")\n@POST(\"/storage/files/{folderId}/upload\")\nvoid uploadFile(@Header(\"FileName\") String fileName, @Path(\"folderId\") String folderId, @Body TypedFile file, MyCallback<UploadedFileInfo> callback);\n\n@Body\u30a2\u30ce\u30c6\u30fc\u30b7\u30e7\u30f3\u3092\u3001TypedFile\u306b\u3064\u3051\u305f\u3089\u3001\u3059\u3093\u306a\u308a\u30d0\u30a4\u30ca\u30ea\u3092\u76f4\u63a5\u9001\u308c\u307e\u3057\u305f\u3002\n\n## \u767a\u884c\u3057\u305f\u3044\u30ea\u30af\u30a8\u30b9\u30c8\n\n- POST body\u304c\u30d0\u30a4\u30ca\u30ea\u30c7\u30fc\u30bf\u3067\u59cb\u307e\u308b\uff08!= multipart/form-data\uff09\n- Content-Type\u306f`application/octet-stream`\n\n```HTTP\u30ea\u30af\u30a8\u30b9\u30c8\uff08\u4e00\u90e8\u629c\u7c8b\uff09\nPOST /storage/files/XXX/upload HTTP/1.1\nHost: hoge.example.com\nContent-Type: application/octet-stream\nContent-Length: 1601207\nFileName: test.jpg\n\n(\u3053\u3053\u306b\u30d0\u30a4\u30ca\u30ea\u30c7\u30fc\u30bf)\n```\n\n[\u3053\u3061\u3089](https://muzammilazmi.wordpress.com/2013/04/20/afnetworking-how-to-post-data-nsdata-on-server/)\u306b\u8a18\u8f09\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u53c2\u8003\u306b\u3057\u307e\u3057\u305f\u3002\n\n```objective-c:\u5b9f\u88c5\n+ (void)uploadFile:(NSData *)fileData fileName:(NSString *)fileName callback:(RequestCallback)callback {\n    NSString *folderId = @\"XXX\";\n    NSString *url = [NSString stringWithFormat:@\"%@/storage/files/%@/upload\", @\"https://hoge.example.com\", folderId];\n\n    NSMutableURLRequest *request = [[NSMutableURLRequest alloc] initWithURL:[NSURL URLWithString:url]];\n    request.HTTPMethod = @\"POST\";\n    [request setValue:@\"application/octet-stream\" forHTTPHeaderField:@\"Content-Type\"];\n    [request setValue:fileName forHTTPHeaderField:@\"FileName\"];\n    [request setHTTPBody:fileData];\n    AFHTTPRequestOperation *operation = [[AFHTTPRequestOperation alloc] initWithRequest:request];\n    [operation setCompletionBlockWithSuccess:^(AFHTTPRequestOperation *operation, id responseObject) {\n        NSLog(@\"responseObject = %@\", responseObject);\n        callback();\n    } failure:^(AFHTTPRequestOperation *operation, NSError *error) {\n        callback();\n    }];\n    [operation start];\n}\n```\n\nCallback\u5468\u308a\u306f\u3001\u3066\u304d\u3068\u30fc\u3067\u3059\u3002\n\n\n## \u3061\u306a\u307f\u306bAndroid\u3067\u306f\n\nRetrofit\u3092\u4f7f\u3048\u3070\u3001\u7c21\u5358\u3067\u3059\u3002\n\n```java:\n@Headers(\"Content-Type: application/octet-stream\")\n@POST(\"/storage/files/{folderId}/upload\")\nvoid uploadFile(@Header(\"FileName\") String fileName, @Path(\"folderId\") String folderId, @Body TypedFile file, MyCallback<UploadedFileInfo> callback);\n```\n`@Body`\u30a2\u30ce\u30c6\u30fc\u30b7\u30e7\u30f3\u3092\u3001`TypedFile`\u306b\u3064\u3051\u305f\u3089\u3001\u3059\u3093\u306a\u308a\u30d0\u30a4\u30ca\u30ea\u3092\u76f4\u63a5\u9001\u308c\u307e\u3057\u305f\u3002\n", "tags": ["afnetworking", "iOS"]}