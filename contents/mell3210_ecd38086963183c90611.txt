{"context": " More than 1 year has passed since last update.\u81ea\u5b85\u5074\u306eActiveDirectory\u3068AWS\u5074\u306eWeb\u30b5\u30fc\u30d0\u3092\u9023\u52d5\u3055\u305b\u3066\u307f\u308b\u3002\nAD\u3068web\u306e\u9023\u52d5\u3068\u305d\u306e\u969b\u306b\u8a2d\u5b9a\u3057\u305f\u5185\u5bb9\u306b\u3064\u3044\u3066\u8a18\u8f09\u3002\n\n\u74b0\u5883\n\u81ea\u5b85\u5074\nAD\u30b5\u30fc\u30d0\u306eIP\uff1a192.168.1.9\nAWS\u5074\nWeb\u30b5\u30fc\u30d0\u306eIP\uff1a10.0.1.7\n\nAD\u306e\u8a2d\u5b9a\n\u4e0b\u56f3\u306e\u69d8\u306b\u3001\u30e6\u30fc\u30b6\u3092\u4f5c\u3063\u3066\u304a\u304f\u3002\n\n\nWeb\u30b5\u30fc\u30d0\u306e\u8a2d\u5b9a\n\nSecurity Group\n\u4e0b\u56f3\u306e\u901a\u308a\u3001SSH\u3068HTTP\u3092\u8a2d\u5b9a\u3059\u308b\u3002\nICMP\u306f\u758e\u901a\u78ba\u8a8d\u306eping\u3092\u901a\u3059\u70ba\u306e\u8a2d\u5b9a\u306a\u306e\u3067\u3001\u6d88\u3057\u3066\u3082\u826f\u3044\u3002\n\n\nhttpd\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u524d\u306b\u3001\u4e00\u6642\u7684\u306bVPN\u5074\u3067nat\u3092\u8a2d\u5b9a\u3057\u3001Web\u30b5\u30fc\u30d0\u304c\u5916\u90e8\u306b\u51fa\u308c\u308b\u3088\u3046\u306b\u3059\u308b\u3002\n$ configure\n# set nat source rule 1 source address 10.0.1.0/24\n# set nat source rule 1 translation address masquerade\n# set nat source rule 1 outbound-interface eth0\n# commit\n# save\n\nsudo yum -y install httpd\n\n\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u304c\u7d42\u308f\u3063\u305f\u3089NAT\u306f\u89e3\u9664\u3059\u308b\u3002\n$ configure\n# delete nat\n# commit\n# save\n\n\nAD\u3068\u306e\u9023\u52d5\u8a2d\u5b9a\u3084\u52d5\u4f5c\u78ba\u8a8d\u30da\u30fc\u30b8\u306e\u4f5c\u6210\n\n/etc/httpd/conf/httpd.conf\n<Directory \"/var/www/html\">\n    AllowOverride All\n</Directory>\n\n\n\n/var/www/html/index.html\ntest fo private web\n\n\n\n/var/www/html/.htaccess\nAuthType Basic\nAuthName \"ActiveDirectory Auth\"\nAuthBasicProvider ldap\nAuthLDAPURL \"ldap://192.168.1.9/DC=sample,DC=local?sAMAccountName?sub?(objectClass=*)\"\nAuthLDAPBindDN \"sample\\administrator\"\nAuthLDAPBindPassword \"XXXXXXXX\"\nAuthzLDAPAuthoritative Off\nrequire valid-user\n\n\n\n\u52d5\u4f5c\u78ba\u8a8d\n\n\u30b5\u30fc\u30d0\u306b\u30a2\u30af\u30bb\u30b9\u3059\u308b\u3068\u30d9\u30fc\u30b7\u30c3\u30af\u8a8d\u8a3c\u306e\u30c0\u30a4\u30a2\u30ed\u30b0\u304c\u51fa\u308b\u3002\n\n\n\u9069\u5f53\u306aID\u3092\u5165\u308c\u308b\u3068\u3002\u3002\u3002\n\n\n\n\u5f3e\u304b\u308c\u305f\u3002\n\n\u7136\u308b\u3079\u304dID\u3092\u5165\u308c\u308b\u3068\n\n\n\n\u30da\u30fc\u30b8\u304c\u8868\u793a\u3055\u308c\u305f\u3002\n\u81ea\u5b85\u5074\u306eActiveDirectory\u3068AWS\u5074\u306eWeb\u30b5\u30fc\u30d0\u3092\u9023\u52d5\u3055\u305b\u3066\u307f\u308b\u3002\nAD\u3068web\u306e\u9023\u52d5\u3068\u305d\u306e\u969b\u306b\u8a2d\u5b9a\u3057\u305f\u5185\u5bb9\u306b\u3064\u3044\u3066\u8a18\u8f09\u3002\n\n#\u74b0\u5883\n\n\u81ea\u5b85\u5074\nAD\u30b5\u30fc\u30d0\u306eIP\uff1a192.168.1.9\n\nAWS\u5074\nWeb\u30b5\u30fc\u30d0\u306eIP\uff1a10.0.1.7\n\n#AD\u306e\u8a2d\u5b9a\n\u4e0b\u56f3\u306e\u69d8\u306b\u3001\u30e6\u30fc\u30b6\u3092\u4f5c\u3063\u3066\u304a\u304f\u3002\n![\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2015-04-30 22.52.41.png](https://qiita-image-store.s3.amazonaws.com/0/64421/51c6b856-0aec-473e-4677-6b5f232f1d18.png \"\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2015-04-30 22.52.41.png\")\n\n\n#Web\u30b5\u30fc\u30d0\u306e\u8a2d\u5b9a\n\n##Security Group\n\u4e0b\u56f3\u306e\u901a\u308a\u3001SSH\u3068HTTP\u3092\u8a2d\u5b9a\u3059\u308b\u3002\nICMP\u306f\u758e\u901a\u78ba\u8a8d\u306eping\u3092\u901a\u3059\u70ba\u306e\u8a2d\u5b9a\u306a\u306e\u3067\u3001\u6d88\u3057\u3066\u3082\u826f\u3044\u3002\n![\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2015-05-04 3.54.17.png](https://qiita-image-store.s3.amazonaws.com/0/64421/12c3765b-5153-4a63-ff8c-8904fb2ca795.png \"\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2015-05-04 3.54.17.png\")\n\n##httpd\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u524d\u306b\u3001\u4e00\u6642\u7684\u306bVPN\u5074\u3067nat\u3092\u8a2d\u5b9a\u3057\u3001Web\u30b5\u30fc\u30d0\u304c\u5916\u90e8\u306b\u51fa\u308c\u308b\u3088\u3046\u306b\u3059\u308b\u3002\n\n```@VPN\u30b5\u30fc\u30d0\n$ configure\n# set nat source rule 1 source address 10.0.1.0/24\n# set nat source rule 1 translation address masquerade\n# set nat source rule 1 outbound-interface eth0\n# commit\n# save\n```\n\n```@Web\u30b5\u30fc\u30d0\nsudo yum -y install httpd\n```\n\n\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u304c\u7d42\u308f\u3063\u305f\u3089NAT\u306f\u89e3\u9664\u3059\u308b\u3002\n\n```@VPN\u30b5\u30fc\u30d0\n$ configure\n# delete nat\n# commit\n# save\n```\n\n##AD\u3068\u306e\u9023\u52d5\u8a2d\u5b9a\u3084\u52d5\u4f5c\u78ba\u8a8d\u30da\u30fc\u30b8\u306e\u4f5c\u6210\n\n```/etc/httpd/conf/httpd.conf\n<Directory \"/var/www/html\">\n    AllowOverride All\n</Directory>\n```\n\n```/var/www/html/index.html\ntest fo private web\n```\n\n```/var/www/html/.htaccess\nAuthType Basic\nAuthName \"ActiveDirectory Auth\"\nAuthBasicProvider ldap\nAuthLDAPURL \"ldap://192.168.1.9/DC=sample,DC=local?sAMAccountName?sub?(objectClass=*)\"\nAuthLDAPBindDN \"sample\\administrator\"\nAuthLDAPBindPassword \"XXXXXXXX\"\nAuthzLDAPAuthoritative Off\nrequire valid-user\n```\n\n\n##\u52d5\u4f5c\u78ba\u8a8d\n\n###\u30b5\u30fc\u30d0\u306b\u30a2\u30af\u30bb\u30b9\u3059\u308b\u3068\u30d9\u30fc\u30b7\u30c3\u30af\u8a8d\u8a3c\u306e\u30c0\u30a4\u30a2\u30ed\u30b0\u304c\u51fa\u308b\u3002\n![\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2015-04-30 22.46.39.png](https://qiita-image-store.s3.amazonaws.com/0/64421/e253343a-ca8b-4efb-b66c-efa812e55104.png \"\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2015-04-30 22.46.39.png\")\n\n###\u9069\u5f53\u306aID\u3092\u5165\u308c\u308b\u3068\u3002\u3002\u3002\n![\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2015-04-30 22.47.05.png](https://qiita-image-store.s3.amazonaws.com/0/64421/abde42b2-529f-c5dd-57bd-c8cd1b5b8d4f.png \"\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2015-04-30 22.47.05.png\")\n![\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2015-04-30 22.48.11.png](https://qiita-image-store.s3.amazonaws.com/0/64421/0c35b64c-57dc-01a7-ce7d-65b98a1aa6d5.png \"\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2015-04-30 22.48.11.png\")\n###\u5f3e\u304b\u308c\u305f\u3002\n\n\n###\u7136\u308b\u3079\u304dID\u3092\u5165\u308c\u308b\u3068\n![\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2015-04-30 22.47.28.png](https://qiita-image-store.s3.amazonaws.com/0/64421/59c8242d-8815-900f-f2cd-854040beab71.png \"\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2015-04-30 22.47.28.png\")\n![\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2015-04-30 22.47.38.png](https://qiita-image-store.s3.amazonaws.com/0/64421/7369ffec-1841-83f2-631d-fbd9fe1e580d.png \"\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2015-04-30 22.47.38.png\")\n###\u30da\u30fc\u30b8\u304c\u8868\u793a\u3055\u308c\u305f\u3002\n\n", "tags": ["VyOS", "vyatta", "AWS", "VPN"]}