{"context": " More than 1 year has passed since last update.\n\n\u753b\u50cf\n\n\n\u30b3\u30fc\u30c9\nC = Text.GetCharacter(34)\nR = Text.GetCharacter(13) + Text.GetCharacter(10)\ncode = \"\"\nGraphicsWindow.BackgroundColor = \"skyblue\"\nbutton1 = Controls.AddButton(\"caption\", 350, 400)\nControls.SetButtonCaption(button1, \"clr\")\nbutton0 = Controls.AddButton(\"caption\", 300, 400)\nControls.SetButtonCaption(button0, \"ilasm\")\ntextbox = Controls.AddTextBox(10, 400)\nControls.SetTextBoxText(textbox, \"main.il\")\nmtextbox = Controls.AddMultiLineTextBox(0, 0)\nControls.HideControl(mtextbox)\nControls.SetSize(mtextbox, 580, 380) \nControls.SetTextBoxText(mtextbox, code)\nControls.Move(mtextbox, 10, 10)\nControls.ShowControl(mtextbox)\nControls.ButtonClicked = output\nSub output\n  button = Controls.LastClickedButton\n  If (button = button1) Then\n    Controls.SetTextBoxText(mtextbox, \"\")\n  ElseIf (button = button0) Then\n    file = \"c:\\il\\\" + Controls.GetTextBoxText(textbox)\n    text = Controls.GetTextBoxText(mtextbox)\n    File.WriteContents(file, text)\n    csc = \"C:\\WINDOWS\\Microsoft.NET\\Framework\\v4.0.30319\\ilasm.exe\"\n    code = \"\"\n    code = code + \"Function setup(a)\" + R \n    code = code + \"Set obj = CreateObject(\" + C + \"WScript.Shell\" + C + \")\" + R\n    code = code + \"  obj.run \" + C + \"cmd /K CD c:\\il & \" + csc + \" \" + file + \" & main.exe\" + C + R\n    code = code + \"setup = \"  + C + C + R\n    code = code + \"End Function\" + R\n    a = Class1.VBSrun(code)\n  endif\nEndSub\n\n\n\u30b5\u30f3\u30d7\u30eb\u30b3\u30fc\u30c9\n.assembly \nextern mscorlib \n{ \n}\n.assembly \nmain \n{ \n}\n.method static void main() cil managed \n{\n    .entrypoint\n    .maxstack 2\n    ldstr \"1 + 2 =\"\n    call void [mscorlib] System.Console::WriteLine(string)\n    ldc.i4 1\n    ldc.i4 2\n    add\n    call void [mscorlib]System.Console::WriteLine(int32)\n    ldstr \"1 - 2 =\"\n    call void [mscorlib] System.Console::WriteLine(string)\n    ldc.i4 1\n    ldc.i4 2\n    sub\n    call void [mscorlib]System.Console::WriteLine(int32)\n    ldstr \"5 * 3 =\"\n    call void [mscorlib] System.Console::WriteLine(string)\n    ldc.i4 5\n    ldc.i4 3\n    mul\n    call void [mscorlib]System.Console::WriteLine(int32)\n    ldstr \"10 / 2 =\"\n    call void [mscorlib] System.Console::WriteLine(string)\n    ldc.i4 10\n    ldc.i4 2\n    div\n    call void [mscorlib]System.Console::WriteLine(int32)\n    ldstr \"10 % 3 =\"\n    call void [mscorlib] System.Console::WriteLine(string)\n    ldc.i4 10\n    ldc.i4 3\n    rem\n    call void [mscorlib]System.Console::WriteLine(int32)\n    ret\n}\n\n#\u753b\u50cf\n![ilasm.PNG](https://qiita-image-store.s3.amazonaws.com/0/18104/727b2579-4b43-061c-9645-e5d4b2e19e68.png)\n#\u30b3\u30fc\u30c9\n```\nC = Text.GetCharacter(34)\nR = Text.GetCharacter(13) + Text.GetCharacter(10)\ncode = \"\"\nGraphicsWindow.BackgroundColor = \"skyblue\"\nbutton1 = Controls.AddButton(\"caption\", 350, 400)\nControls.SetButtonCaption(button1, \"clr\")\nbutton0 = Controls.AddButton(\"caption\", 300, 400)\nControls.SetButtonCaption(button0, \"ilasm\")\ntextbox = Controls.AddTextBox(10, 400)\nControls.SetTextBoxText(textbox, \"main.il\")\nmtextbox = Controls.AddMultiLineTextBox(0, 0)\nControls.HideControl(mtextbox)\nControls.SetSize(mtextbox, 580, 380) \nControls.SetTextBoxText(mtextbox, code)\nControls.Move(mtextbox, 10, 10)\nControls.ShowControl(mtextbox)\nControls.ButtonClicked = output\nSub output\n  button = Controls.LastClickedButton\n  If (button = button1) Then\n    Controls.SetTextBoxText(mtextbox, \"\")\n  ElseIf (button = button0) Then\n    file = \"c:\\il\\\" + Controls.GetTextBoxText(textbox)\n    text = Controls.GetTextBoxText(mtextbox)\n    File.WriteContents(file, text)\n    csc = \"C:\\WINDOWS\\Microsoft.NET\\Framework\\v4.0.30319\\ilasm.exe\"\n    code = \"\"\n    code = code + \"Function setup(a)\" + R \n    code = code + \"Set obj = CreateObject(\" + C + \"WScript.Shell\" + C + \")\" + R\n    code = code + \"  obj.run \" + C + \"cmd /K CD c:\\il & \" + csc + \" \" + file + \" & main.exe\" + C + R\n    code = code + \"setup = \"  + C + C + R\n    code = code + \"End Function\" + R\n    a = Class1.VBSrun(code)\n  endif\nEndSub\n```\n##\u30b5\u30f3\u30d7\u30eb\u30b3\u30fc\u30c9\n```\n.assembly \nextern mscorlib \n{ \n}\n.assembly \nmain \n{ \n}\n.method static void main() cil managed \n{\n    .entrypoint\n    .maxstack 2\n    ldstr \"1 + 2 =\"\n    call void [mscorlib] System.Console::WriteLine(string)\n    ldc.i4 1\n    ldc.i4 2\n    add\n    call void [mscorlib]System.Console::WriteLine(int32)\n    ldstr \"1 - 2 =\"\n    call void [mscorlib] System.Console::WriteLine(string)\n    ldc.i4 1\n    ldc.i4 2\n    sub\n    call void [mscorlib]System.Console::WriteLine(int32)\n    ldstr \"5 * 3 =\"\n    call void [mscorlib] System.Console::WriteLine(string)\n    ldc.i4 5\n    ldc.i4 3\n    mul\n    call void [mscorlib]System.Console::WriteLine(int32)\n    ldstr \"10 / 2 =\"\n    call void [mscorlib] System.Console::WriteLine(string)\n    ldc.i4 10\n    ldc.i4 2\n    div\n    call void [mscorlib]System.Console::WriteLine(int32)\n    ldstr \"10 % 3 =\"\n    call void [mscorlib] System.Console::WriteLine(string)\n    ldc.i4 10\n    ldc.i4 3\n    rem\n    call void [mscorlib]System.Console::WriteLine(int32)\n    ret\n}\n```\n\n", "tags": ["smallbasic", ".NETFramework", "\u30a2\u30bb\u30f3\u30d6\u30e9"]}