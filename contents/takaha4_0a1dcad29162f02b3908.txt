{"tags": ["Watson", "Bluemix", "node-red", "solr"], "context": "\n\n\u306f\u3058\u3081\u306b\n\u3068\u3042\u308b\u30cf\u30c3\u30ab\u30bd\u30f3\u306b\u53c2\u52a0\u3057\u305f\u6298\u3001\u4f7f\u3046\u6a5f\u4f1a\u304c\u3042\u308a\u307e\u3057\u305f\u306e\u3067\u3001\u305d\u306e\u6642\u3057\u305f\u3053\u3068\u306e\u5099\u5fd8\u9332\u3068\u306a\u308a\u307e\u3059\u3002\n\u6700\u5f8c\u307e\u3067\u3084\u308b\u3068\u3001\u5b66\u7fd2\u6e08(?)\u306e\u691c\u7d22API\u3092Web\u304b\u3089\u53e9\u3051\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\n(\u79c1\u306e\u3088\u3046\u306a)Bluemix\u3082\u6a5f\u68b0\u5b66\u7fd2\u3082\u89e6\u3063\u305f\u3053\u3068\u304c\u306a\u3044\u3001\u3067\u3082\u306a\u3093\u3068\u306a\u304f\u8a66\u3057\u3066\u307f\u305f\u3044\u2026\u3068\u3044\u3046\u65b9\u3067\u3082\u306a\u308b\u3079\u304f\u82e6\u3057\u307e\u306a\u3044\u3088\u3046\u306b\u3001\u30d5\u30a1\u30a4\u30eb\u3084\u30b3\u30de\u30f3\u30c9\u306e\u60c5\u5831\u3092\u8272\u3005\u3068\u88dc\u5b8c\u3057\u307e\u3057\u305f\u3002\n\u9593\u9055\u3044\u30fb\u52d8\u9055\u3044\u7b49\u3042\u308a\u307e\u3057\u305f\u3089\u3054\u6307\u6458\u9802\u3051\u308c\u3070\u5e78\u3044\u3067\u3059\u3002\n\n\u53c2\u8003\u8cc7\u6599\n\u672c\u8a18\u4e8b\u306f\u3001\u4ee5\u4e0b\u3092\u59cb\u3081\u3068\u3059\u308b\u5404\u7a2e\u8cc7\u6599\u3092\u898b\u306a\u304c\u3089\u4f5c\u696d\u3057\u305f\u7d50\u679c\u306e\u307e\u3068\u3081\u306b\u306a\u308a\u307e\u3059\u3002\n\u5148\u306b\u8a18\u4e8b\u3092\u66f8\u304b\u308c\u3066\u3044\u305f\u65b9\u3005\u306e\u304a\u9670\u3067\u3001\u30cf\u30c3\u30ab\u30bd\u30f3\u5f53\u65e5\u306f\u306a\u3093\u3068\u304b\u5b8c\u6210\u306b\u3053\u304e\u3064\u3051\u307e\u3057\u305f\u3002\n\u3042\u308a\u304c\u3068\u3046\u3054\u3056\u3044\u307e\u3057\u305f(\u611f\u8b1d)\u3002\n\n\n\u6982\u8981\n\n\nWatson API \u30c8\u30ec\u30fc\u30cb\u30f3\u30b0 20160716 rev02\n\np54\u304f\u3089\u3044\u304b\u3089Retrieve and Rank\u306e\u8a71\u3067\u3059\u304c\u3001\u6642\u9593\u304c\u3042\u308c\u3070\u6700\u521d\u304b\u3089\u8aad\u3093\u3060\u65b9\u304c\u3088\u3044\u3068\u601d\u3044\u307e\u3059\n\n\n\n\n\nRetrieve and Rank\n\n\nTutorial\n\n\u82f1\u8a9e\u3067\u3059\u304c\u3001\u8a73\u7d30\u306a\u624b\u9806&\u5404\u7a2e\u30b5\u30f3\u30d7\u30eb\u30d5\u30a1\u30a4\u30eb\u304c\u3042\u308a\u307e\u3059\n\n\nBluemix\u306eRetrieve&Rank\u306b\u3088\u308b\u8cea\u554f\u5fdc\u7b54\u30b7\u30b9\u30c6\u30e0\u3092\u8a66\u3057\u3066\u307f\u305f\nRetrieve and Rank \u30b5\u30fc\u30d3\u30b9\u306e\u4f7f\u7528\u65b9\u6cd5\n\nAPI\u30ea\u30d5\u30a1\u30ec\u30f3\u30b9(Retrieve and Rank)\n\n\u307e\u305a\u3053\u3061\u3089\u3092\u8aad\u3093\u3067\u3001\u898b\u3064\u304b\u3089\u306a\u304b\u3063\u305f\u3089\u2193\u3092\u63a2\u3059\u306e\u304c\u3088\u3044\u3068\u601d\u3044\u307e\u3059\n\n\n\u30ea\u30d5\u30a1\u30ec\u30f3\u30b9(Apache Solr)\n\n\n\nNode-RED\n\n\u30b3\u30fc\u30c9\u3092\u307b\u3068\u3093\u3069\u66f8\u304b\u305a\u306bNode-RED\u3067Web\u30a2\u30d7\u30ea\u3092\u4f5c\u308d\u3046\nBluemix Node-RED\u3092\u4f7f\u3063\u3066Watson API\u3092\u547c\u3073\u51fa\u3059\n\n\n\n\n\u624b\u9806\n\n\u524d\u63d0\n\n\u7b46\u8005\u306fMacbook\u306b\u3066\u4f5c\u696d\u3092\u5b9f\u65bd\n\u30d6\u30e9\u30a6\u30b6\u306fChrome\u3001HTML\u304b\u3089\u306e\u30c6\u30b9\u30c8\u306bBrackets\u3001\u305d\u306e\u4ed6\u30c6\u30ad\u30b9\u30c8\u30a8\u30c7\u30a3\u30bf\u3068\u3057\u3066CotEditor\u3092\u4f7f\u7528\nWindows\u3067\u3082curl\u30b3\u30de\u30f3\u30c9\u3092\u4f7f\u3048\u308b\u3088\u3046\u306b\u3059\u308c\u3070\u591a\u5206OK\n\n\n\u30a2\u30ab\u30a6\u30f3\u30c8\u3001\u30b5\u30fc\u30d3\u30b9\u4f5c\u6210\n\nIBM Watson Developer Cloud\u306b\u3066\u3001\u7121\u6599\u8a55\u4fa1\u7248(30\u65e5\u9593)\u306e\u30a2\u30ab\u30a6\u30f3\u30c8\u3092\u4f5c\u6210\n\n\u30b5\u30fc\u30d3\u30b9\u304b\u3089\u3001\u30b5\u30fc\u30d3\u30b9\u306e\u4f5c\u6210 > Retrieve and Rank > \u4f5c\u6210\n\n\u6599\u91d1\u306e\u8a71\u304c\u66f8\u3044\u3066\u3042\u3063\u3066\u3073\u3073\u308b\u304c\u300130\u65e5\u9593\u306f\u5927\u4e08\u592b(\u306e\u306f\u305a)\n\n\n\n\u30b5\u30fc\u30d3\u30b9\u304b\u3089\u3001Retrieve and Rank > \u30b5\u30fc\u30d3\u30b9\u8cc7\u683c\u60c5\u5831 > \u8cc7\u683c\u60c5\u5831\u306e\u8868\u793a\u3067\u8868\u793a\u3055\u308c\u308b\u60c5\u5831\u3092\u30b3\u30d4\u30fc\n\n\u4ee5\u964d\u3001curl\u30b3\u30de\u30f3\u30c9\u306e-u\u30aa\u30d7\u30b7\u30e7\u30f3\u306b\u3001**username**:**password**\u306e\u5f62\u3067\u8a2d\u5b9a\u3059\u308b\n\n\n\n{\n  \"url\": \"https://gateway.watsonplatform.net/retrieve-and-rank/api\",\n  \"password\": \"**password**\",\n  \"username\": \"**username**\"\n}\n\n\n\u30af\u30e9\u30b9\u30bf\u4f5c\u6210\n\n\u30bf\u30fc\u30df\u30ca\u30eb(\u306a\u3044\u3057\u30b3\u30de\u30f3\u30c9\u30d7\u30ed\u30f3\u30d7\u30c8)\u3092\u8d77\u52d5\u3002curl\u3092\u5b9f\u884c\u3057\u3066\u3044\u304f\n\n\u30af\u30e9\u30b9\u30bf\u3092\u4f5c\u6210\n\n\n**cluster_id**\u3092\u30b3\u30d4\u30fc\n\n\n\ncurl -k -X POST -u \"**username:**password**\" \"https://gateway.watsonplatform.net/retrieve-and-rank/api/v1/solr_clusters\" -d \"\"\n\n{\n  \"solr_cluster_id\": \"**cluster_id**\",\n  \"cluster_name\": \"\",\n  \"cluster_size\": \"\",\n  \"solr_cluster_status\": \"NOT_AVAILABLE\"\n}\n\n\n\u4ee5\u4e0b\u3067\u30af\u30e9\u30b9\u30bf\u306e\u30b9\u30c6\u30fc\u30bf\u30b9\u304c\u78ba\u8a8d\u3067\u304d\u308b\u3002\u30b9\u30c6\u30fc\u30bf\u30b9\u306bREADY\u304c\u8fd4\u308b\u307e\u3067\u5f85\u3064\n\ncurl -u \"**username**:**password**\" \"https://gateway.watsonplatform.net/retrieve-and-rank/api/v1/solr_clusters\"\n\n{\"clusters\": [{\n  \"solr_cluster_id\": \"**cluster_id**\",\n  \"cluster_name\": \"\",\n  \"cluster_size\": \"\",\n  \"solr_cluster_status\": \"READY\"\n}]}\n\n\n\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u7528\u610f\u30fb\u30a4\u30f3\u30dd\u30fc\u30c8\n\n\n\u30af\u30e9\u30b9\u30bf\u3092\u4f5c\u3063\u3066\u3044\u308b\u9593\u306b\u3001\u30b3\u30ec\u30af\u30b7\u30e7\u30f3\u7528\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3092\u7528\u610f\n\n\n\u3053\u3061\u3089\u306e\u65b9\u304c\u65e5\u672c\u8a9e\u7528\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3092\u516c\u958b\u3057\u3066\u3044\u305f\u306e\u3067\u3001\u3042\u308a\u304c\u305f\u304f\u304a\u501f\u308a\u3059\u308b(Attachment > Solr_Japanese_20160108.zip)\n\n\n\n\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3092\u89e3\u51cd\u5f8c\u3001schema.xml\u30d5\u30a1\u30a4\u30eb\u3092\u78ba\u8a8d\n\n\u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u3042\u308c\u3070\u3001\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u4f5c\u6210\u6642\u306bid\u3001title\u3001body\u3092\u5b9a\u7fa9\u3059\u308b\u3053\u3068\u306b\u306a\u308b\u3002\u30cf\u30c3\u30ab\u30bd\u30f3\u3067\u306f\u3001\u30d5\u30a3\u30fc\u30eb\u30c9\u306e\u540d\u524d\u3092\u5909\u3048\u305f\u308a\u3001\u4ed6\u306b\u4fdd\u6301\u3057\u305f\u3044\u60c5\u5831\u304c\u3042\u3063\u305f\u305f\u3081\u30d5\u30a3\u30fc\u30eb\u30c9\u306e\u8ffd\u52a0\u3092\u304a\u3053\u306a\u3063\u305f\n\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3092\u5909\u66f4\u5f8c\u3001\u518d\u5727\u7e2e\u3059\u308b\u6642\u306f\u3001\u89e3\u51cd\u5148\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092\u5727\u7e2e\u3057\u306a\u3044(=\u89e3\u51cd\u5148\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u76f4\u4e0b\u306e\u5185\u5bb9\u3092\u9078\u629e\u3057\u3066\u5727\u7e2e\u3059\u308b)\u3053\u3068\u3002\u30a4\u30f3\u30dd\u30fc\u30c8\u6642\u306b\u30a8\u30e9\u30fc\u3068\u306a\u308b\n\n\n\n\nschema.xml(\u629c\u7c8b)\n   <field name=\"id\" type=\"string\" indexed=\"true\" stored=\"true\" required=\"true\" multiValued=\"false\" /> \n   <field name=\"title\" type=\"watson_text_ja\" indexed=\"true\" stored=\"true\" required=\"false\" multiValued=\"true\" />\n   <field name=\"body\" type=\"watson_text_ja\" indexed=\"true\" stored=\"true\" required=\"false\" multiValued=\"true\" />\n\n   <!-- make a copy field using normal OOB solr text_en -->\n   <field name=\"text\" type=\"text_ja\" indexed=\"true\" stored=\"false\" required=\"false\" multiValued=\"true\" />\n   <!-- make a copy field using watson_text_ja -->\n   <field name=\"watson_text\" type=\"watson_text_ja\" indexed=\"true\" stored=\"false\" required=\"false\" multiValued=\"true\" />\n\n   <copyField source=\"title\" dest=\"text\"/>\n   <copyField source=\"body\" dest=\"text\"/>\n\n   <copyField source=\"title\" dest=\"watson_text\"/>\n   <copyField source=\"body\" dest=\"watson_text\"/>\n\n\n\nschema.xml(\u30d5\u30a3\u30fc\u30eb\u30c9\u8ffd\u52a0)\n   <!-- Watson\u306b\u3088\u308b\u89e3\u6790\u304c\u4e0d\u8981\u3067\u3042\u308c\u3070\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u5b9a\u7fa9\u3059\u308c\u3070\u3088\u3044\u6a21\u69d8 -->\n   <field name=\"custom_field\" type=\"string\" indexed=\"true\" stored=\"true\" required=\"false\" multiValued=\"false\" />\n\n\n\n\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3092\u30a4\u30f3\u30dd\u30fc\u30c8\n\n\n\n**cluster_id**\u306b\u5148\u307b\u3069\u53d6\u5f97\u3057\u305f\u30af\u30e9\u30b9\u30bfID\u3001**config_name**\u306b\u4efb\u610f\u306e\u540d\u524d(\u82f1\u6570\u5b57)\u3001**config_path**\u306b\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb(zip)\u3078\u306e\u30d1\u30b9\u3092\u8a2d\u5b9a\n\n\n\ncurl -k -X POST -H \"Content-Type: application/zip\" -u \"**username**:**password**\" \"https://gateway.watsonplatform.net/retrieve-and-rank/api/v1/solr_clusters/**cluster_id**/config/**config_name**\" --data-binary @**config_path**\n\n{\n  \"message\": \"WRRCSR026: Successfully uploaded named config [**config_name**] for Solr cluster [**cluster_id**].\",\n  \"statusCode\": 200\n}\n\n\n\u30b3\u30ec\u30af\u30b7\u30e7\u30f3\u4f5c\u6210\n\n\u4ee5\u4e0b\u3092\u5b9f\u884c\u3057\u30b3\u30ec\u30af\u30b7\u30e7\u30f3\u3092\u4f5c\u6210\n\n\n\n**collection_name**\u306b\u4efb\u610f\u306e\u540d\u524d(\u82f1\u6570\u5b57)\u3001**config_name**\u306b\u5148\u307b\u3069\u30a4\u30f3\u30dd\u30fc\u30c8\u3057\u305f\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u306e\u540d\u524d\u3092\u8a2d\u5b9a\n\nsuccess\u306a\u3069\u3068\u66f8\u304b\u308c\u305fXML\u304c\u8fd4\u3063\u3066\u304f\u308c\u3070OK\n\n\n\ncurl -k -X POST -u \"**username**:**password**\" \"https://gateway.watsonplatform.net/retrieve-and-rank/api/v1/solr_clusters/**cluster_id**/solr/admin/collections\" -d \"action=CREATE&name=**collection_name**&collection.configName=**config_name**\"\n\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n  <response>\n    <lst name=\"responseHeader\">\n      <int name=\"status\">0</int>\n      <int name=\"QTime\">11214</int>\n    </lst>\n    <lst name=\"success\">\n      <lst name=\"****\">\n        <lst name=\"responseHeader\">\n          <int name=\"status\">0</int>\n          <int name=\"QTime\">2468</int>\n        </lst>\n        <str name=\"core\">****</str>\n      </lst>\n      <lst name=\"****\">\n        <lst name=\"responseHeader\">\n          <int name=\"status\">0</int>\n          <int name=\"QTime\">2915</int>\n        </lst>\n      <str name=\"core\">****</str>\n    </lst>\n  </lst>\n</response>\n\n\n\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u6e96\u5099\n\n\u6295\u5165\u3059\u308b\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u60c5\u5831\u3092\u7528\u610f\n\n\n\u30cf\u30c3\u30ab\u30bd\u30f3\u3067\u306f\u3001\u30c1\u30fc\u30e0\u306e\u65b9\u306b\u7c21\u6613\u30af\u30ed\u30fc\u30e9(\u3068\u3042\u308b\u30b5\u30a4\u30c8\u306eHTML\u304b\u3089\u6295\u5165\u30c7\u30fc\u30bf\u3092\u62bd\u51fa)\u3092\u4f5c\u3063\u3066\u3082\u3089\u3044\u6551\u308f\u308c\u305f\u30028000\u4ef6\u307b\u3069\u306e\u30ec\u30b3\u30fc\u30c9\u3092\u767b\u9332\u3057\u305f\n\u672a\u78ba\u8a8d\u3060\u304cDocument Conversion\u3092\u4f7f\u3063\u3066\u3082\u3088\u3055\u305d\u3046\n\n\n\n\n\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u4f5c\u6210\n\n\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3067\u5b9a\u7fa9\u3057\u305f\u30d5\u30a3\u30fc\u30eb\u30c9\u306b\u5408\u308f\u305b\u3066\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306aJSON\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u6210\n\n\n\n\u3053\u3053\u3092\u898b\u308b\u3068\u8a18\u6cd5\u306f\u8272\u3005\u3042\u308b\u3089\u3057\u3044(\u3053\u308c\u306fJSON\u3068\u3057\u3066\u554f\u984c\u306a\u3044\u3093\u3067\u3057\u3087\u3046\u304b\u2026?)\n\u6587\u5b57\u30b3\u30fc\u30c9\u306fUTF-8\u3001\u6539\u884c\u306fLF\u306e\u307f\n\u30cf\u30c3\u30ab\u30bd\u30f3\u3067\u306f\u3001\u3053\u3053\u3067commit\u304c\u5fc5\u8981\u306a\u3053\u3068\u306b\u6c17\u3065\u3051\u305a\u6570\u6642\u9593\u3092\u30d5\u30a4\u306b\u3057\u305f(\u53cd\u7701)\n\n\n\n\ndocuments.json\n{\n  \"add\": {\n    \"doc\": {\n      \"id\": \"1\",\n      \"title\": \"\uff0a\uff0a\uff0a\uff0a\",\n      \"body\": \"\uff0a\uff0a\uff0a\uff0a\",\n      \"custom_field\": \"\uff0a\uff0a\uff0a\uff0a\"\n    }\n  },\n  \"add\": {\n    \"doc\": {\n      \"id\": \"2\",\n      \"title\": \"\uff0a\uff0a\uff0a\uff0a\",\n      \"body\": \"\uff0a\uff0a\uff0a\uff0a\",\n      \"custom_field\": \"\uff0a\uff0a\uff0a\uff0a\"\n    }\n  },\n\n\u30fb\u30fb\u30fb\u4e2d\u7565\u30fb\u30fb\u30fb\n\n  \"commit\": { }\n}\n\n\n\n\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u6295\u5165\n\n\u4ee5\u4e0b\u5b9f\u884c\u3067\u30b3\u30ec\u30af\u30b7\u30e7\u30f3\u306b\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u3092\u6295\u5165\n\n\n\n**cluster_id**\u3001**config_name**\u306f\u9069\u5b9c\u7f6e\u63db\u3001**document_path**\u306b\u5148\u307b\u3069\u4f5c\u6210\u3057\u305fjson\u30d5\u30a1\u30a4\u30eb\u3078\u306e\u30d1\u30b9\u3092\u8a2d\u5b9a\n\n\n\ncurl -k -X POST -H \"Content-Type: application/json\" -u \"**username**:**password**\" \"https://gateway.watsonplatform.net/retrieve-and-rank/api/v1/solr_clusters/**cluster_id**/solr/**collection_name**/update\" --data-binary @**document_path**\n\n{\n  \"responseHeader\": {\n    \"status\": 0,\n    \"QTime\": 495\n  }\n}\n\n\n\u691c\u7d22(\u30e9\u30f3\u30ab\u30fc\u7121\u3057)\n\n\u30d6\u30e9\u30a6\u30b6\u306e\u30a2\u30c9\u30ec\u30b9\u30d0\u30fc\u306b\u4ee5\u4e0b\u3092\u5165\u529b\n\n\n\n**xxxx**\u306e\u7b87\u6240\u306f\u4eca\u307e\u3067\u306b\u5023\u3063\u3066\u9069\u5b9c\u5909\u66f4\u3002\u691c\u7d22\u6587\u306f\u4efb\u610f\u306b\u8a2d\u5b9a\n\u691c\u7d22\u6587\u306b\u5fdc\u3058\u3066\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u304c\u8fd4\u3063\u3066\u304f\u308c\u3070OK\nid\u691c\u7d22\u304c\u3057\u305f\u3044\u5834\u5408\u306f\u3001q=id:1\u306a\u3069\u3068\u3059\u308b\n\n\n\nhttps://**username**:**password**@gateway.watsonplatform.net/retrieve-and-rank/api/v1/solr_clusters/**cluster_id**/solr/**collection_name**/select?q=\u691c\u7d22\u6587&wt=json&fl=id,title,body,custom_field\n\n{\n  \"responseHeader\": {\n    \"status\": 0,\n    \"QTime\": 1,\n    \"params\":{\n      \"q\": \"\u691c\u7d22\u6587\",\n      \"fl\": \"id,title,body,custom_field\",\n      \"wt\":\"json\"\n    }\n  },\n  \"response\": {\n    \"numFound\": 58,\n    \"start\": 0,\n    \"docs\": [\n      {\n        \"id\": \"1\",\n        \"title\": [\"\uff0a\uff0a\uff0a\uff0a\"],\n        \"body\": [\"\uff0a\uff0a\uff0a\uff0a\"],\n        \"custom_field\": \"\uff0a\uff0a\uff0a\uff0a\"\n      },\n\n\u30fb\u30fb\u30fb\u4e2d\u7565\u30fb\u30fb\u30fb\n\n    ]\n  }\n}\n\n\n\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u4f5c\u6210\n\n\nRetrieve and Rank\u3092Web\u304b\u3089\u547c\u3073\u51fa\u3059\u306b\u306f\u3001Node-RED\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u7d4c\u7531\u3059\u308b\u5fc5\u8981\u304c\u3042\u308b\n\n\u30cf\u30c3\u30ab\u30bd\u30f3\u3067\u306f\u3053\u308c\u306b\u6c17\u3065\u3051\u305a1\u6642\u9593\u307b\u3069\u30d5\u30a4\u306b\u3057\u305f(\u53cd\u7701)\n\n\n\n\u30a2\u30d7\u30ea\u304b\u3089\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u4f5c\u6210 > Node-RED Starter > \u4f5c\u6210\n\n\u5165\u529b\u9805\u76ee\u306f\u4efb\u610f\u3001\u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u3088\u3044\u304c\u3001\u30db\u30b9\u30c8\u540d\u306b\u3064\u3044\u3066\u306fAPI\u306eURL\u306b\u7528\u3044\u3089\u308c\u308b\n\n\n\n\u30a2\u30d7\u30ea\u304b\u3089\u30a2\u30d7\u30ea\u540d > \u30e9\u30f3\u30bf\u30a4\u30e0 > \u74b0\u5883\u5909\u6570 > \u30e6\u30fc\u30b6\u30fc\u5b9a\u7fa9 > \u8ffd\u52a0 > \u4fdd\u5b58\u3067\u30e6\u30fc\u30b6\u30fc\u540d\u3001\u30d1\u30b9\u30ef\u30fc\u30c9\u3092\u8a2d\u5b9a\n\n\n\u30a2\u30d7\u30ea\u306b\u3066\u518d\u59cb\u52d5(\u5186\u5f27\u578b\u306e\u77e2\u5370\u306e\u30dc\u30bf\u30f3)\u3092\u62bc\u3057\u3066\u304a\u304f\n\n\n\n\n\n\n\u540d\u524d\n\u5024\n\n\n\n\nNODE_RED_USERNAME\n\u4efb\u610f\n\n\nNODE_RED_PASSWORD\n\u4efb\u610f\n\n\n\n\n\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u7de8\u96c6\n\n\u30a2\u30d7\u30ea\u3067\u30a2\u30d7\u30ea\u540d > \u7d4c\u8def\u306b\u8868\u793a\u3055\u308c\u3066\u3044\u308bURL\u306b\u30a2\u30af\u30bb\u30b9\u3059\u308b\u3068\u3001Node-RED\u306e\u30c8\u30c3\u30d7\u753b\u9762\u304c\u8868\u793a\u3055\u308c\u308b\nGo to your Node-RED flow editor\u3092\u30af\u30ea\u30c3\u30af\u3059\u308b\u3068\u8a8d\u8a3c\u753b\u9762\u304c\u51fa\u308b\u306e\u3067\u3001\u5148\u307b\u3069\u8a2d\u5b9a\u3057\u305f\u30e6\u30fc\u30b6\u30fc\u540d\u3001\u30d1\u30b9\u30ef\u30fc\u30c9\u3092\u5165\u529b\n\u8868\u793a\u3055\u308c\u305f\u30a8\u30c7\u30a3\u30bf\u753b\u9762\u306b\u3066\u3001\u4ee5\u4e0b\u8981\u9818\u3067\u30ce\u30fc\u30c9\u3092\u4f5c\u6210\u3001\u63a5\u7d9a\n\n\n\nhttp(input)\n\n\u753b\u9762\u5de6\u3088\u308ainput > http\u3002\u30a8\u30c7\u30a3\u30bf\u4e2d\u592e\u306b\u30c9\u30ed\u30c3\u30d7\nURL\u306b\u6307\u5b9a\u3057\u305f\u5024\u304c\u3001API\u306eURL\u306e\u30d1\u30b9\u306b\u4f7f\u7528\u3055\u308c\u308b\n\n\n\n\n\u540d\u524d\n\u5024\n\n\n\n\nMethod\nPOST\n\n\nURL\n/**path**\n\n\n\nName\n\u4efb\u610f\n\n\n\n\nfunction(\u30ea\u30af\u30a8\u30b9\u30c8\u751f\u6210)\n\n\u753b\u9762\u5de6\u3088\u308afunction > function\nWeb\u3088\u308a\u547c\u3073\u51fa\u3059\u969b\u306b\u691c\u7d22\u6587\u3092\u8a2d\u5b9a\u3059\u308b\u30d1\u30e9\u30e1\u30fc\u30bf\u30fc\u3092msg.payload\u306eq\u3067\u6307\u5b9a\u3059\u308b\n\u8272\u3005\u3068\u30a8\u30b9\u30b1\u30fc\u30d7\u3057\u3066\u3044\u308b\u306e\u306f\u3053\u3061\u3089\u3092\u53c2\u8003\u306b\u3002substring\u306f\u306a\u3093\u3068\u306a\u304f\u5b9f\u65bd\n\n\nFunction\nvar query;\ntry {\n    query = msg.payload.q.substring(0, 1000);\n} catch(e) {\n    query = \"\";\n}\nquery = query.replace(\n    /[\\\\\\+\\-\\&\\|\\!\\(\\)\\{\\}\\[\\]\\^\\\"\\~\\*\\?\\:\\/\\r\\n\\t\\u0020\\u3000]|AND|OR|NOT/g, \n    function(c) { return \"\\\\\" + c; });\nmsg.headers = {\n    \"content-type\": \"application/x-www-form-urlencoded\"\n};\nmsg.payload = {\n    \"wt\": \"json\",\n    \"fl\": \"id,title,body,custom_field\",\n    \"q\": query\n};\nreturn msg;\n\n\n\nhttp request\n\n\u753b\u9762\u5de6\u3088\u308afunction > http request\n\n\n\n\n\n\u540d\u524d\n\u5024\n\n\n\n\nMethod\nPOST\n\n\nURL\nhttps://gateway.watsonplatform.net/retrieve-and-rank/api/v1/solr_clusters/**cluster_id**/solr/**collection_name**/select\n\n\nEnable secure (SSL/TLS) connection\n\u30c1\u30a7\u30c3\u30af\u7121\n\n\nUse basic authentication\n\u30c1\u30a7\u30c3\u30af\u6709\n\n\nUsername\n**username**\n\n\nPassword\n**password**\n\n\nReturn\na UTF-8 string\n\n\nName\n\u4efb\u610f\n\n\n\n\nfunction(\u30d8\u30c3\u30c0\u8a2d\u5b9a)\n\n\u753b\u9762\u5de6\u3088\u308afunction > function\nCORS\u5bfe\u5fdc\u306e\u305f\u3081\n\n\nFunction\nmsg.headers = {\n  \"Access-Control-Allow-Origin\": \"*\"\n}\nreturn msg;\n\n\n\njson\u3001http(output)\n\n\u753b\u9762\u5de6\u3088\u308afunction > json\u3001output > http response\n\n\n\n\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u53cd\u6620\n\n\u753b\u9762\u53f3\u4e0a\u306eDeploy\u3092\u62bc\u3059\u3068\u53cd\u6620\n\n\n\u30a8\u30e9\u30fc\u304c\u3042\u308b\u3068\u3001\u753b\u9762\u53f3\u306edebug\u30bf\u30d6\u306b\u8868\u793a\u3055\u308c\u308b\n\n\n\n\nWeb\u304b\u3089API\u547c\u3073\u51fa\u3057\n\njQuery\u7b49\u3092\u4f7f\u3063\u3066API\u547c\u3073\u51fa\u3057\u3001\u7d50\u679c\u53d6\u5f97\n\n\ntest.html\n<!DOCTYPE html>\n<html>\n  <head>\n    <meta charset=\"utf-8\">\n    <title>Retrieve and Rank</title>\n    <script type=\"text/javascript\" src=\"https://code.jquery.com/jquery-3.1.1.min.js\"></script>\n  </head>\n  <body>\n    <input id=\"query\" type=\"text\">\n    <input id=\"test\" type=\"button\" value=\"Test\">\n    <div id=\"result\"></div>\n  </body>\n  <script type=\"text/javascript\">        \n    $(\"#test\").click(function(){\n      $(\"#result\").empty();\n\n      $.ajax({\n        type: \"POST\",\n        url: \"http://**\u30db\u30b9\u30c8\u540d**.mybluemix.net/**path**\",\n        dataType: \"json\",\n        data: {\n            q: $(\"#query\").val()\n        }\n      }).done(function(data){\n        var doc = \"\";\n        var docs = data.response.docs;\n        if (docs.length > 0) {\n            doc = JSON.stringify(docs[0]);\n        } else {\n            doc = \"\u7d50\u679c\u304c\u898b\u3064\u304b\u308a\u307e\u305b\u3093\u3067\u3057\u305f\u3002\";\n        }\n        $(\"#result\").text(doc);\n      }).fail(function(error){\n          console.log(error);\n      });\n    });\n  </script>\n</html>\n\n\n\n\u5b66\u7fd2\n\n\u30cf\u30c3\u30ab\u30bd\u30f3\u3067\u306f\u6642\u9593\u304c\u8db3\u3089\u305a\u6ce3\u304f\u6ce3\u304f\u8ae6\u3081\u305f\u3001\u30e9\u30f3\u30ab\u30fc\u3092\u7528\u3044\u305f\u691c\u7d22\u306b\u3064\u3044\u3066\u6311\u6226\u3057\u305f\n\n\nGrandtruth\u306e\u4f5c\u6210\n\n\u8cea\u554f\u306b\u5bfe\u3057\u3066\u3069\u306e\u89e3\u7b54\u304c\u9069\u5207\u3067\u3042\u3063\u305f\u304b\u89e3\u7b54\u3057\u3066Grandtruth\u3092\u751f\u6210\u3059\u308b\u30c4\u30fc\u30eb\u3092\u4f5c\u308a\u3001\u30e9\u30f3\u30ab\u30fc\u3092\u4f5c\u6210\n\n\n\n\u8cea\u554f\u6587\u5165\u529b&\u89e3\u7b54\u5019\u88dc\u8868\u793a\u2192\u9069\u5207\u3068\u601d\u308f\u308c\u308b\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u306e\u30dc\u30bf\u30f3\u3092\u62bc\u3059\u2192\u8cea\u554f\u6587\u5165\u529b\u2026\u2192Groundtruth\u53d6\u5f97\u3067CSV\u30d5\u30a1\u30a4\u30eb\u4f5c\u6210\n\n\n\n\ntest2.html\n<!DOCTYPE html>\n<html>\n  <head>\n    <meta charset=\"utf-8\">\n    <title>Groundtruth</title>\n    <script type=\"text/javascript\" src=\"https://code.jquery.com/jquery-3.1.1.min.js\"></script>\n    <style type=\"text/css\">\n      body {\n        font-size: small;\n      }\n      #query {\n        width: 95%;\n      }\n      #header {\n        position: fixed;\n        top: 0;\n        left: 0;\n        right: 0;\n        padding: 0.2em;\n        background-color: gray;\n      }\n      .doc {\n        border: 1px solid gray;\n        border-radius: 0.2em;\n        margin: 0.2em;\n        padding: 0.2em;\n      }\n      #result {\n        margin-top: 4em;\n      }\n    </style>\n  </head>\n  <body>\n    <div id=\"header\">\n      <input id=\"query\" type=\"text\" placeholder=\"\u8cea\u554f\u6587\"><br>\n      <input id=\"send\" type=\"button\" value=\"\u5019\u88dc\u8868\u793a\">\n      <input id=\"getgt\" type=\"button\" value=\"Groundtruth\u53d6\u5f97\">\n      <a id=\"downloadlink\" target=\"_blank\" href=\"#\"></a>\n    </div>\n    <div id=\"result\"></div>\n  </body>\n  <script type=\"text/javascript\">\n    var MAX_USEFUL=4;\n    var groundtruth={};\n\n    $(\"#send\").click(function(){\n      var $result=$(\"#result\");\n      $result.empty();\n\n      var $query=$(\"#query\");      \n      $.ajax({\n        type: \"POST\",\n        url: \"http://**\u30db\u30b9\u30c8\u540d**.mybluemix.net/**path**\",\n        dataType: \"json\",\n        data: {\n          q: $query.val()\n        }\n      }).done(function(data){\n        var docs = data.response.docs;\n        if (docs.length > 0) {\n          docs.forEach(function(doc){\n            var $doc=$(\"<div>\").addClass(\"doc\").data({ \n              \"query\": data.responseHeader.params.q,\n              \"doc\": doc \n            });\n\n            $doc.append($(\"<input>\").attr({\n              \"id\": \"useful\",\n              \"type\": \"button\",\n              \"value\": doc.id,\n            }).click(function(){ clickUseful($doc); }));\n\n            $doc.append($(\"<span>\").addClass(\"counter\"));\n            $doc.append($(\"<div>\").text(doc.body));            \n\n            $result.append($doc);\n          });\n        } else {\n          $result.text(\"\u7d50\u679c\u304c\u898b\u3064\u304b\u308a\u307e\u305b\u3093\u3067\u3057\u305f\u3002\");\n        }\n      }).fail(function(error){\n          console.log(error);\n      });      \n    });\n\n    $(\"#getgt\").click(function(){\n      var rows=[];\n      $.each(groundtruth,function(query, idList){\n        var row=[];\n        row.push(query);\n        $.each(idList,function(id, count){\n          row.push(id);\n          row.push(count);\n        });\n        rows.push(row.map(function(value){ return escapeCSV(String(value)) }).join(\",\"));\n      });\n      rows.push(\"\");\n\n      var blob = new Blob([rows.join(\"\\n\")], { \"type\": \"text/plain\" });\n      var $downloadlink=$(\"#downloadlink\");\n      $downloadlink.attr(\"href\", window.URL.createObjectURL(blob));\n      $downloadlink.attr(\"download\", \"gt_\" + createTimeString() + \".csv\");\n      $downloadlink[0].click();\n    });\n\n    function clickUseful($doc) {\n      var query=$doc.data(\"query\");\n      var id=$doc.data(\"doc\").id;\n      if (groundtruth[query] === undefined) {\n        groundtruth[query]={};\n      }\n\n      var count=(groundtruth[query][id] === undefined ? 0 : groundtruth[query][id]);\n      count=Math.min(count + 1, MAX_USEFUL);\n      groundtruth[query][id]=count;\n\n      $doc.find(\".counter\").text(count);\n      if (count >= MAX_USEFUL) {\n        $doc.find(\"#useful\").prop(\"disabled\", true);        \n      }      \n    }\n\n    function escapeCSV(value) {\n      return \"\\\"\" + value.replace(/\\\"/, \"\\\"\\\"\") + \"\\\"\";\n    }\n    function createTimeString() {\n      function padZero(num) {\n          var result;\n          if (num < 10) {\n              result = \"0\" + num;\n          } else {\n              result = \"\" + num;\n          }\n          return result;\n      }\n      var now = new Date();\n      var res = \"\" + now.getFullYear() + padZero(now.getMonth() + 1) + \n          padZero(now.getDate()) + padZero(now.getHours()) + \n          padZero(now.getMinutes()) + padZero(now.getSeconds());\n      return res;\n    }\n  </script>\n</html>\n\n\n\n\n\n\u8cea\u554f\u6587,\u89e3\u7b541\u306eID,\u89e3\u7b541\u306e\u5f79\u306b\u7acb\u3063\u305f\u5ea6(1\u301c4),\u89e3\u7b542\u306eID,\u89e3\u7b542\u306e\u5f79\u306b\u7acb\u3063\u305f\u5ea6(1\u301c4)...\n\n\u8cea\u554f\u6587\u306b\u5bfe\u3057\u89e3\u7b54\u5019\u88dc\u3068\u3057\u3066\u8fd4\u5374\u3055\u308c\u306a\u3044ID\u3092\u6307\u5b9a\u3059\u308b\u3068\u3001\u6b21\u306etrain.py\u3067\u30a8\u30e9\u30fc\u3068\u306a\u308b\n\u6700\u4f4e49\u884c(=\u30e6\u30cb\u30fc\u30af\u306a\u8cea\u554f\u658749\u500b)\u4ee5\u4e0a\u304c\u5fc5\u8981\u3089\u3057\u3044\u3002\u8db3\u308a\u306a\u3044\u3068\u3084\u306f\u308a\u30a8\u30e9\u30fc\u306b\u306a\u308b\n\u305d\u306e\u4ed6\u3001\u5fc5\u8981\u306a\u8981\u4ef6\u304c\u8272\u3005\u3068\u3042\u308b\u6a21\u69d8(\u3053\u3061\u3089\u306ep25\u3068\u304b\u3001\u3053\u3053\u3068\u304b)\nUTF-8\u3001LF\u3067\u51fa\u529b\u306e\u3053\u3068\n\n\n\n\ngt.csv(\u30a4\u30e1\u30fc\u30b8)\n\"\u3053\u3093\u306b\u3061\u306f\",\"7203\",\"3\",\"7654\",\"2\"\n\n\n\n\n\u30e9\u30f3\u30ab\u30fc\u306e\u4f5c\u6210\n\ncsv\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u3063\u305f\u3089\u3001\u3053\u3061\u3089\u304b\u3089train.py\u3092\u53d6\u5f97\u3057\u3001\u4ee5\u4e0b\u5b9f\u884c\n\n\n\n**ranker_name**\u306f\u4efb\u610f\u3067\u3088\u3044\nWindows\u74b0\u5883\u306e\u4eba\u306f\u3001Python\u3092\u4f7f\u3048\u308b\u3088\u3046\u306b\u3059\u308b\u5fc5\u8981\u304c\u3042\u308b\n\n\n\npython ./train.py -u \"**username**:**password**\" -i ./gt.csv -c \"**cluster_id**\" -x \"**collection_name**\" -n \"**ranker_name**\"\n\nInput file is ./gt.csv\nSolr cluster is **cluster_id**\nSolr collection is **collection_name**\nRanker name is **ranker_name**\nRows per query 10\nGenerating training data...\nGenerating training data complete.\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n100  242k    0   316  100  241k    113  88936  0:00:02  0:00:02 --:--:-- 88935\n\n\n\u30b9\u30c6\u30fc\u30bf\u30b9\u304cTraining\u306e\u9593\u306f\u4f7f\u7528\u4e0d\u53ef\u30025\u5206\u7a0b\u5ea6\u304b\u304b\u308b\u306e\u3067\u66ab\u3057\u5f85\u3064\n\n\n\n**ranker_id**\u3092\u30e1\u30e2\n\n\n\n{\n  \"ranker_id\": \"**ranker_id**\",\n  \"name\": \"**ranker_name**\",\n  \"created\": \"2016-11-18T19:14:20.146Z\",\n  \"url\": \"https://gateway.watsonplatform.net/retrieve-and-rank/api/v1/rankers/**ranker_id**\",\n  \"status\": \"Training\",\n  \"status_description\": \"The ranker instance is in its training phase, not yet ready to accept rank requests\"\n}\n\n\n\u30e9\u30f3\u30ab\u30fc\u306e\u72b6\u614b\u78ba\u8a8d\u306f\u4ee5\u4e0b\u3002Available\u3068\u306a\u308c\u3070OK\n\ncurl -u \"**username**:**password**\" \"https://gateway.watsonplatform.net/retrieve-and-rank/api/v1/rankers/**ranker_id**\"\n\n{\n  \"ranker_id\": \"**ranker_id**\",\n  \"name\": \"**ranker_name**\",\n  \"created\":\"2016-11-18T19:14:20.146Z\",\n  \"url\": \"https://gateway.watsonplatform.net/retrieve-and-rank/api/v1/rankers/**ranker_id**\",\n  \"status\": \"Available\",\n  \"status_description\": \"The ranker instance is now available and is ready to take ranker requests.\"\n}\n\n\n\u691c\u7d22(\u30e9\u30f3\u30ab\u30fc\u6709\u308a)\n\nfcselect\u3067\u5b9f\u65bd\n\n\nAPI\u30ea\u30d5\u30a1\u30ec\u30f3\u30b9\u306b\u8a18\u8f09\u304c\u306a\u3044\u304c\u3001fl\u306branker.confidence\u3092\u8ffd\u52a0\u3059\u308b\u3068\u3001\u30e9\u30f3\u30af\u4ed8\u3051\u306e\u4fe1\u983c\u5ea6\u304c\u51fa\u529b\u3055\u308c\u308b(\u3053\u3053\u306eWorking with ranker confidence scores\u53c2\u7167)\n\n\n\nhttps://**username**:**password**@gateway.watsonplatform.net/retrieve-and-rank/api/v1/solr_clusters/**cluster_id**/solr/**collection_name**/fcselect?ranker_id=**ranker_id**&q=\u691c\u7d22\u6587&wt=json&fl=id,title,body,custom_field,ranker.confidence\n\n{\n  \"responseHeader\": {\n    \"status\": 0,\n    \"QTime\": 75\n  },\n  \"response\": {\n    \"numFound\": 11,\n    \"start\": 0,\n    \"maxScore\": 10.0,\n    \"docs\": [\n      {\n        \"id\": \"7722\",\n        \"title\": [\"\uff0a\uff0a\uff0a\uff0a\"],\n        \"body\": [\"\uff0a\uff0a\uff0a\uff0a\"],\n        \"custom_field\": \"\uff0a\uff0a\uff0a\uff0a\",\n        \"ranker.confidence\": 0.48287850973637736\n      },\n      {\n        \"id\": \"7203\",\n        \"title\": [\"\uff0a\uff0a\uff0a\uff0a\"],\n        \"body\": [\"\uff0a\uff0a\uff0a\uff0a\"],\n        \"custom_field\": \"\uff0a\uff0a\uff0a\uff0a\",\n        \"ranker.confidence\": 0.3192066081818791\n      },\n\n\u30fb\u30fb\u30fb\u4e2d\u7565\u30fb\u30fb\u30fb\n\n    ]\n  }\n}\n\n\n\u7d50\u679c\u306e\u6bd4\u8f03\n\n\u5de6\u304cselect(=\u5b66\u7fd2\u7121?)\u3001\u53f3\u304cfcselect(=\u5b66\u7fd2\u6709?)\n\"7810\"\u306fselect\u3067\u30e9\u30f3\u30af\u306e\u4e00\u756a\u4e0b\u3060\u3063\u305f\u304c\u3001fcselect\u3067\u306f\u691c\u7d22\u306b\u5f15\u3063\u304b\u304b\u3089\u306a\u304f\u306a\u3063\u305f\u2026\n\n\"1908\"\u306a\u3069\u3001\u76f4\u63a5\u6307\u5b9a\u3057\u3066\u3044\u306a\u3044ID\u3082\u30e9\u30f3\u30af\u304c\u4e0a\u6607\n\n\"\u3069\u3046\u3082\u3088\u308d\u3057\u304f\u304a\u9858\u3044\u3057\u307e\u3059\"\u3067\"4\"\u3092\u6307\u5b9a\u3057\u3066\u3044\u308b\u306e\u3067\u3001\u305d\u306e\u5f71\u97ff\u304b?\n\n\n\n\"7963\"\u306f\u3001Grandtruth\u5168\u4f53\u3092\u901a\u3058\u3066\u4e00\u5ea6\u3082\u30dc\u30bf\u30f3\u3092\u62bc\u3057\u3066\u306a\u3044\u304c\u9806\u4f4d\u304c\u4e0a\u6607\u3057\u3066\u3044\u308b\n\n\u5468\u308a\u304c\u4e0b\u304c\u3063\u3066\u3044\u308b?\n\u305d\u306e\u4ed6\u8272\u3005\u306a\u8cea\u554f\u6587\u306b\u30dc\u30bf\u30f3\u3092\u62bc\u3057\u3066\u3044\u308b\u306e\u3067\u3001\u305d\u308c\u3089\u306e\u5f71\u97ff\u3082\u3042\u308b\u306e\u304b\u3082\n\n\n\n\nGrandtruth(\u629c\u7c8b)\n\"\u3069\u3046\u3082\",\"1525\",\"2\",\"4669\",\"4\",\"6137\",\"3\",\"7481\",\"3\",\"8252\",\"4\"\n\"\u3069\u3046\u3082\u30fc\",\"1908\",\"2\",\"7481\",\"2\",\"7810\",\"2\",\"8252\",\"3\"\n\"\u3069\u3046\u3082\u3042\u308a\u304c\u3068\u3046\u3054\u3056\u3044\u307e\u3057\u305f\",\"2475\",\"4\",\"5984\",\"4\",\"6220\",\"4\",\"6490\",\"4\"\n\"\u3069\u3046\u3082\u3088\u308d\u3057\u304f\u304a\u9858\u3044\u3057\u307e\u3059\",\"252\",\"4\",\"1439\",\"4\",\"1750\",\"2\",\"1821\",\"2\",\"1908\",\"4\",\"3731\",\"4\"\n\"\u3069\u3046\u3082\u3053\u3093\u306b\u3061\u306f\",\"3627\",\"3\",\"7203\",\"2\",\"7654\",\"2\",\"7660\",\"4\",\"7722\",\"2\"\n\n\n\n\n\u5f8c\u7247\u4ed8\u3051\n\n\u3053\u3061\u3089\u3092\u898b\u308b\u3068\u3001\u8a66\u7528\u671f\u9593\u7d42\u4e86\u5f8c\u306b\u81ea\u52d5\u3067\u5168\u524a\u9664\u3055\u308c\u308b\u96f0\u56f2\u6c17\u3060\u304c\u3001\u306a\u3093\u3068\u306a\u304f\u624b\u3067\u6d88\u3057\u3066\u304a\u304f\n\u30e9\u30f3\u30ab\u30fc\u524a\u9664\n\ncurl -X DELETE -u \"**username**:**password**\" \"https://gateway.watsonplatform.net/retrieve-and-rank/api/v1/rankers/**ranker_id**\"\n\n{}\n\n\n\u30b3\u30ec\u30af\u30b7\u30e7\u30f3\u524a\u9664\n\ncurl -X POST -u \"**username**:**password**\" \"https://gateway.watsonplatform.net/retrieve-and-rank/api/v1/solr_clusters/**cluster_id**/solr/admin/collections\" -d \"action=DELETE&name=**collection_name**\"\n\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<response>\n  <lst name=\"responseHeader\">\n    <int name=\"status\">0</int>\n    <int name=\"QTime\">907</int>\n  </lst>\n  <lst name=\"success\">\n    <lst name=\"****\">\n      <lst name=\"responseHeader\">\n        <int name=\"status\">0</int>\n        <int name=\"QTime\">95</int>\n      </lst>\n    </lst>\n    <lst name=\"****\">\n      <lst name=\"responseHeader\">\n        <int name=\"status\">0</int>\n        <int name=\"QTime\">119</int>\n      </lst>\n    </lst>\n  </lst>\n</response>\n\n\n\u30b3\u30f3\u30d5\u30a3\u30b0\u524a\u9664\n\ncurl -X DELETE -u \"**username**:**password**\" \"https://gateway.watsonplatform.net/retrieve-and-rank/api/v1/solr_clusters/**cluster_id**/config/**config_name**\"\n\n{\n  \"message\": \"WRRCSR025: Successfully deleted named config [**config_name**] for Solr cluster [**cluster_id**].\",\n  \"statusCode\": 200\n}\n\n\n\u30af\u30e9\u30b9\u30bf\u524a\u9664\n\ncurl -X DELETE -u \"**username**:**password**\" \"https://gateway.watsonplatform.net/retrieve-and-rank/api/v1/solr_clusters/**cluster_id**\"\n\n{\n  \"message\": \"WRRCSR023: Successfully deleted Solr cluster [**cluster_id**].\",\n  \"statusCode\": 200\n}\n\n\n\n\u30a2\u30d7\u30ea\u3001\u30b5\u30fc\u30d3\u30b9\u304b\u3089\u3001\u4f5c\u6210\u3057\u305f\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3001\u30b5\u30fc\u30d3\u30b9\u3092\u524a\u9664\n\n#\u306f\u3058\u3081\u306b\n\n\u3068\u3042\u308b\u30cf\u30c3\u30ab\u30bd\u30f3\u306b\u53c2\u52a0\u3057\u305f\u6298\u3001\u4f7f\u3046\u6a5f\u4f1a\u304c\u3042\u308a\u307e\u3057\u305f\u306e\u3067\u3001\u305d\u306e\u6642\u3057\u305f\u3053\u3068\u306e\u5099\u5fd8\u9332\u3068\u306a\u308a\u307e\u3059\u3002\n\u6700\u5f8c\u307e\u3067\u3084\u308b\u3068\u3001\u5b66\u7fd2\u6e08(?)\u306e\u691c\u7d22API\u3092Web\u304b\u3089\u53e9\u3051\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\n\n(\u79c1\u306e\u3088\u3046\u306a)Bluemix\u3082\u6a5f\u68b0\u5b66\u7fd2\u3082\u89e6\u3063\u305f\u3053\u3068\u304c\u306a\u3044\u3001\u3067\u3082\u306a\u3093\u3068\u306a\u304f\u8a66\u3057\u3066\u307f\u305f\u3044\u2026\u3068\u3044\u3046\u65b9\u3067\u3082\u306a\u308b\u3079\u304f\u82e6\u3057\u307e\u306a\u3044\u3088\u3046\u306b\u3001\u30d5\u30a1\u30a4\u30eb\u3084\u30b3\u30de\u30f3\u30c9\u306e\u60c5\u5831\u3092\u8272\u3005\u3068\u88dc\u5b8c\u3057\u307e\u3057\u305f\u3002\n\u9593\u9055\u3044\u30fb\u52d8\u9055\u3044\u7b49\u3042\u308a\u307e\u3057\u305f\u3089\u3054\u6307\u6458\u9802\u3051\u308c\u3070\u5e78\u3044\u3067\u3059\u3002\n\n#\u53c2\u8003\u8cc7\u6599\n\n\u672c\u8a18\u4e8b\u306f\u3001\u4ee5\u4e0b\u3092\u59cb\u3081\u3068\u3059\u308b\u5404\u7a2e\u8cc7\u6599\u3092\u898b\u306a\u304c\u3089\u4f5c\u696d\u3057\u305f\u7d50\u679c\u306e\u307e\u3068\u3081\u306b\u306a\u308a\u307e\u3059\u3002\n\u5148\u306b\u8a18\u4e8b\u3092\u66f8\u304b\u308c\u3066\u3044\u305f\u65b9\u3005\u306e\u304a\u9670\u3067\u3001\u30cf\u30c3\u30ab\u30bd\u30f3\u5f53\u65e5\u306f\u306a\u3093\u3068\u304b\u5b8c\u6210\u306b\u3053\u304e\u3064\u3051\u307e\u3057\u305f\u3002\n\u3042\u308a\u304c\u3068\u3046\u3054\u3056\u3044\u307e\u3057\u305f(\u611f\u8b1d)\u3002\n\n- \u6982\u8981\n\n    - [Watson API \u30c8\u30ec\u30fc\u30cb\u30f3\u30b0 20160716 rev02](http://www.slideshare.net/komine/watson-api-20160716-rev02)\n        - p54\u304f\u3089\u3044\u304b\u3089Retrieve and Rank\u306e\u8a71\u3067\u3059\u304c\u3001\u6642\u9593\u304c\u3042\u308c\u3070\u6700\u521d\u304b\u3089\u8aad\u3093\u3060\u65b9\u304c\u3088\u3044\u3068\u601d\u3044\u307e\u3059\n\n- Retrieve and Rank\n\n    - [Tutorial](https://www.ibm.com/watson/developercloud/doc/retrieve-rank/tutorial.shtml)\n\n        - \u82f1\u8a9e\u3067\u3059\u304c\u3001\u8a73\u7d30\u306a\u624b\u9806&\u5404\u7a2e\u30b5\u30f3\u30d7\u30eb\u30d5\u30a1\u30a4\u30eb\u304c\u3042\u308a\u307e\u3059\n\n    - [Bluemix\u306eRetrieve&Rank\u306b\u3088\u308b\u8cea\u554f\u5fdc\u7b54\u30b7\u30b9\u30c6\u30e0\u3092\u8a66\u3057\u3066\u307f\u305f](http://qiita.com/VegaSato/items/6d2d03d6a8b42adcf87e)\n\n    - [Retrieve and Rank \u30b5\u30fc\u30d3\u30b9\u306e\u4f7f\u7528\u65b9\u6cd5](https://www.ibm.com/developerworks/community/wikis/home?lang=en#!/wiki/%E3%81%93%E3%81%BF%E3%81%AD%E3%81%AE%E6%8A%80%E8%A1%93%E3%83%A1%E3%83%A2/page/Retrieve%20and%20Rank%20%E3%82%B5%E3%83%BC%E3%83%93%E3%82%B9%E3%81%AE%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95)\n\n    - [API\u30ea\u30d5\u30a1\u30ec\u30f3\u30b9(Retrieve and Rank)](http://www.ibm.com/watson/developercloud/retrieve-and-rank/api/v1/)\n\n        - \u307e\u305a\u3053\u3061\u3089\u3092\u8aad\u3093\u3067\u3001\u898b\u3064\u304b\u3089\u306a\u304b\u3063\u305f\u3089\u2193\u3092\u63a2\u3059\u306e\u304c\u3088\u3044\u3068\u601d\u3044\u307e\u3059\n\n    - [\u30ea\u30d5\u30a1\u30ec\u30f3\u30b9(Apache Solr)](https://cwiki.apache.org/confluence/display/solr/Apache+Solr+Reference+Guide)\n\n- Node-RED\n    \n    - [\u30b3\u30fc\u30c9\u3092\u307b\u3068\u3093\u3069\u66f8\u304b\u305a\u306bNode-RED\u3067Web\u30a2\u30d7\u30ea\u3092\u4f5c\u308d\u3046](http://ascii.jp/elem/000/001/139/1139255/)\n\n    - [Bluemix Node-RED\u3092\u4f7f\u3063\u3066Watson API\u3092\u547c\u3073\u51fa\u3059](http://qiita.com/VegaSato/items/7ce47e6a9c06c290b212)\n\n\n#\u624b\u9806\n\n##\u524d\u63d0\n\n- \u7b46\u8005\u306fMacbook\u306b\u3066\u4f5c\u696d\u3092\u5b9f\u65bd\n\n- \u30d6\u30e9\u30a6\u30b6\u306fChrome\u3001HTML\u304b\u3089\u306e\u30c6\u30b9\u30c8\u306b[Brackets](http://brackets.io/)\u3001\u305d\u306e\u4ed6\u30c6\u30ad\u30b9\u30c8\u30a8\u30c7\u30a3\u30bf\u3068\u3057\u3066[CotEditor](https://coteditor.com/)\u3092\u4f7f\u7528\n\n- Windows\u3067\u3082[curl\u30b3\u30de\u30f3\u30c9\u3092\u4f7f\u3048\u308b\u3088\u3046\u306b\u3059\u308c\u3070](https://www.google.co.jp/webhp?sourceid=chrome-instant&ion=1&espv=2&ie=UTF-8#q=windows%20curl)\u591a\u5206OK\n\n##\u30a2\u30ab\u30a6\u30f3\u30c8\u3001\u30b5\u30fc\u30d3\u30b9\u4f5c\u6210\n\n- [IBM Watson Developer Cloud](https://www.ibm.com/marketplace/cloud/cognitive-application-development/jp/ja-jp)\u306b\u3066\u3001**\u7121\u6599\u8a55\u4fa1\u7248(30\u65e5\u9593)**\u306e\u30a2\u30ab\u30a6\u30f3\u30c8\u3092\u4f5c\u6210\n\n- [\u30b5\u30fc\u30d3\u30b9](https://console.ng.bluemix.net/dashboard/services)\u304b\u3089\u3001**\u30b5\u30fc\u30d3\u30b9\u306e\u4f5c\u6210 > Retrieve and Rank > \u4f5c\u6210**\n    - \u6599\u91d1\u306e\u8a71\u304c\u66f8\u3044\u3066\u3042\u3063\u3066\u3073\u3073\u308b\u304c\u300130\u65e5\u9593\u306f\u5927\u4e08\u592b(\u306e\u306f\u305a)\n\n- [\u30b5\u30fc\u30d3\u30b9](https://console.ng.bluemix.net/dashboard/services)\u304b\u3089\u3001**Retrieve and Rank > \u30b5\u30fc\u30d3\u30b9\u8cc7\u683c\u60c5\u5831 > \u8cc7\u683c\u60c5\u5831\u306e\u8868\u793a**\u3067\u8868\u793a\u3055\u308c\u308b\u60c5\u5831\u3092\u30b3\u30d4\u30fc\n    - \u4ee5\u964d\u3001curl\u30b3\u30de\u30f3\u30c9\u306e-u\u30aa\u30d7\u30b7\u30e7\u30f3\u306b\u3001```**username**:**password**```\u306e\u5f62\u3067\u8a2d\u5b9a\u3059\u308b\n\n```json\n{\n  \"url\": \"https://gateway.watsonplatform.net/retrieve-and-rank/api\",\n  \"password\": \"**password**\",\n  \"username\": \"**username**\"\n}\n```\n\n##\u30af\u30e9\u30b9\u30bf\u4f5c\u6210\n\n- \u30bf\u30fc\u30df\u30ca\u30eb(\u306a\u3044\u3057\u30b3\u30de\u30f3\u30c9\u30d7\u30ed\u30f3\u30d7\u30c8)\u3092\u8d77\u52d5\u3002curl\u3092\u5b9f\u884c\u3057\u3066\u3044\u304f\n\n- \u30af\u30e9\u30b9\u30bf\u3092\u4f5c\u6210\n    - ```**cluster_id**```\u3092\u30b3\u30d4\u30fc\n\n```shell-session\ncurl -k -X POST -u \"**username:**password**\" \"https://gateway.watsonplatform.net/retrieve-and-rank/api/v1/solr_clusters\" -d \"\"\n```\n\n```json\n{\n  \"solr_cluster_id\": \"**cluster_id**\",\n  \"cluster_name\": \"\",\n  \"cluster_size\": \"\",\n  \"solr_cluster_status\": \"NOT_AVAILABLE\"\n}\n```\n\n- \u4ee5\u4e0b\u3067\u30af\u30e9\u30b9\u30bf\u306e\u30b9\u30c6\u30fc\u30bf\u30b9\u304c\u78ba\u8a8d\u3067\u304d\u308b\u3002\u30b9\u30c6\u30fc\u30bf\u30b9\u306b```READY```\u304c\u8fd4\u308b\u307e\u3067\u5f85\u3064\n\n```shell-session\ncurl -u \"**username**:**password**\" \"https://gateway.watsonplatform.net/retrieve-and-rank/api/v1/solr_clusters\"\n```\n\n```json\n{\"clusters\": [{\n  \"solr_cluster_id\": \"**cluster_id**\",\n  \"cluster_name\": \"\",\n  \"cluster_size\": \"\",\n  \"solr_cluster_status\": \"READY\"\n}]}\n```\n\n##\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u7528\u610f\u30fb\u30a4\u30f3\u30dd\u30fc\u30c8\n\n- \u30af\u30e9\u30b9\u30bf\u3092\u4f5c\u3063\u3066\u3044\u308b\u9593\u306b\u3001\u30b3\u30ec\u30af\u30b7\u30e7\u30f3\u7528\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3092\u7528\u610f\n    - [\u3053\u3061\u3089](https://www.ibm.com/developerworks/community/wikis/home?lang=en#!/wiki/%E3%81%93%E3%81%BF%E3%81%AD%E3%81%AE%E6%8A%80%E8%A1%93%E3%83%A1%E3%83%A2/page/Retrieve%20and%20Rank%20%E3%82%B5%E3%83%BC%E3%83%93%E3%82%B9%E3%81%AE%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95)\u306e\u65b9\u304c\u65e5\u672c\u8a9e\u7528\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3092\u516c\u958b\u3057\u3066\u3044\u305f\u306e\u3067\u3001\u3042\u308a\u304c\u305f\u304f\u304a\u501f\u308a\u3059\u308b(**Attachment > Solr_Japanese_20160108.zip**)\n\n- \u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3092\u89e3\u51cd\u5f8c\u3001schema.xml\u30d5\u30a1\u30a4\u30eb\u3092\u78ba\u8a8d\n    - \u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u3042\u308c\u3070\u3001\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u4f5c\u6210\u6642\u306b```id```\u3001```title```\u3001```body```\u3092\u5b9a\u7fa9\u3059\u308b\u3053\u3068\u306b\u306a\u308b\u3002\u30cf\u30c3\u30ab\u30bd\u30f3\u3067\u306f\u3001\u30d5\u30a3\u30fc\u30eb\u30c9\u306e\u540d\u524d\u3092\u5909\u3048\u305f\u308a\u3001\u4ed6\u306b\u4fdd\u6301\u3057\u305f\u3044\u60c5\u5831\u304c\u3042\u3063\u305f\u305f\u3081\u30d5\u30a3\u30fc\u30eb\u30c9\u306e\u8ffd\u52a0\u3092\u304a\u3053\u306a\u3063\u305f\n    - \u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3092\u5909\u66f4\u5f8c\u3001\u518d\u5727\u7e2e\u3059\u308b\u6642\u306f\u3001\u89e3\u51cd\u5148\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092\u5727\u7e2e\u3057\u306a\u3044(=\u89e3\u51cd\u5148\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u76f4\u4e0b\u306e\u5185\u5bb9\u3092\u9078\u629e\u3057\u3066\u5727\u7e2e\u3059\u308b)\u3053\u3068\u3002\u30a4\u30f3\u30dd\u30fc\u30c8\u6642\u306b\u30a8\u30e9\u30fc\u3068\u306a\u308b\n\n```xml:schema.xml(\u629c\u7c8b)\n   <field name=\"id\" type=\"string\" indexed=\"true\" stored=\"true\" required=\"true\" multiValued=\"false\" /> \n   <field name=\"title\" type=\"watson_text_ja\" indexed=\"true\" stored=\"true\" required=\"false\" multiValued=\"true\" />\n   <field name=\"body\" type=\"watson_text_ja\" indexed=\"true\" stored=\"true\" required=\"false\" multiValued=\"true\" />\n\n   <!-- make a copy field using normal OOB solr text_en -->\n   <field name=\"text\" type=\"text_ja\" indexed=\"true\" stored=\"false\" required=\"false\" multiValued=\"true\" />\n   <!-- make a copy field using watson_text_ja -->\n   <field name=\"watson_text\" type=\"watson_text_ja\" indexed=\"true\" stored=\"false\" required=\"false\" multiValued=\"true\" />\n   \n   <copyField source=\"title\" dest=\"text\"/>\n   <copyField source=\"body\" dest=\"text\"/>\n   \n   <copyField source=\"title\" dest=\"watson_text\"/>\n   <copyField source=\"body\" dest=\"watson_text\"/>\n```\n\n```xml:schema.xml(\u30d5\u30a3\u30fc\u30eb\u30c9\u8ffd\u52a0)\n   <!-- Watson\u306b\u3088\u308b\u89e3\u6790\u304c\u4e0d\u8981\u3067\u3042\u308c\u3070\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u5b9a\u7fa9\u3059\u308c\u3070\u3088\u3044\u6a21\u69d8 -->\n   <field name=\"custom_field\" type=\"string\" indexed=\"true\" stored=\"true\" required=\"false\" multiValued=\"false\" />\n```\n\n- \u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3092\u30a4\u30f3\u30dd\u30fc\u30c8\n    - ```**cluster_id**```\u306b\u5148\u307b\u3069\u53d6\u5f97\u3057\u305f\u30af\u30e9\u30b9\u30bfID\u3001```**config_name**```\u306b\u4efb\u610f\u306e\u540d\u524d(\u82f1\u6570\u5b57)\u3001```**config_path**```\u306b\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb(zip)\u3078\u306e\u30d1\u30b9\u3092\u8a2d\u5b9a\n\n```shell-session\ncurl -k -X POST -H \"Content-Type: application/zip\" -u \"**username**:**password**\" \"https://gateway.watsonplatform.net/retrieve-and-rank/api/v1/solr_clusters/**cluster_id**/config/**config_name**\" --data-binary @**config_path**\n```\n\n```json\n{\n  \"message\": \"WRRCSR026: Successfully uploaded named config [**config_name**] for Solr cluster [**cluster_id**].\",\n  \"statusCode\": 200\n}\n```\n\n##\u30b3\u30ec\u30af\u30b7\u30e7\u30f3\u4f5c\u6210\n\n- \u4ee5\u4e0b\u3092\u5b9f\u884c\u3057\u30b3\u30ec\u30af\u30b7\u30e7\u30f3\u3092\u4f5c\u6210\n    - ```**collection_name**```\u306b\u4efb\u610f\u306e\u540d\u524d(\u82f1\u6570\u5b57)\u3001```**config_name**```\u306b\u5148\u307b\u3069\u30a4\u30f3\u30dd\u30fc\u30c8\u3057\u305f\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u306e\u540d\u524d\u3092\u8a2d\u5b9a\n    - ```success```\u306a\u3069\u3068\u66f8\u304b\u308c\u305fXML\u304c\u8fd4\u3063\u3066\u304f\u308c\u3070OK\n\n```shell-session\ncurl -k -X POST -u \"**username**:**password**\" \"https://gateway.watsonplatform.net/retrieve-and-rank/api/v1/solr_clusters/**cluster_id**/solr/admin/collections\" -d \"action=CREATE&name=**collection_name**&collection.configName=**config_name**\"\n```\n\n```xml\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n  <response>\n    <lst name=\"responseHeader\">\n      <int name=\"status\">0</int>\n      <int name=\"QTime\">11214</int>\n    </lst>\n    <lst name=\"success\">\n      <lst name=\"****\">\n        <lst name=\"responseHeader\">\n          <int name=\"status\">0</int>\n          <int name=\"QTime\">2468</int>\n        </lst>\n        <str name=\"core\">****</str>\n      </lst>\n      <lst name=\"****\">\n        <lst name=\"responseHeader\">\n          <int name=\"status\">0</int>\n          <int name=\"QTime\">2915</int>\n        </lst>\n      <str name=\"core\">****</str>\n    </lst>\n  </lst>\n</response>\n```\n\n##\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u6e96\u5099\n- \u6295\u5165\u3059\u308b\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u60c5\u5831\u3092\u7528\u610f\n    - \u30cf\u30c3\u30ab\u30bd\u30f3\u3067\u306f\u3001\u30c1\u30fc\u30e0\u306e\u65b9\u306b\u7c21\u6613\u30af\u30ed\u30fc\u30e9(\u3068\u3042\u308b\u30b5\u30a4\u30c8\u306eHTML\u304b\u3089\u6295\u5165\u30c7\u30fc\u30bf\u3092\u62bd\u51fa)\u3092\u4f5c\u3063\u3066\u3082\u3089\u3044\u6551\u308f\u308c\u305f\u30028000\u4ef6\u307b\u3069\u306e\u30ec\u30b3\u30fc\u30c9\u3092\u767b\u9332\u3057\u305f\n    - \u672a\u78ba\u8a8d\u3060\u304c[Document Conversion](http://www.ibm.com/smarterplanet/jp/ja/ibmwatson/developercloud/document-conversion.html)\u3092\u4f7f\u3063\u3066\u3082\u3088\u3055\u305d\u3046\n\n##\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u4f5c\u6210\n\n- \u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3067\u5b9a\u7fa9\u3057\u305f\u30d5\u30a3\u30fc\u30eb\u30c9\u306b\u5408\u308f\u305b\u3066\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306aJSON\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u6210\n    - [\u3053\u3053](https://cwiki.apache.org/confluence/display/solr/Uploading+Data+with+Index+Handlers#UploadingDatawithIndexHandlers-JSONFormattedIndexUpdates)\u3092\u898b\u308b\u3068\u8a18\u6cd5\u306f\u8272\u3005\u3042\u308b\u3089\u3057\u3044(\u3053\u308c\u306fJSON\u3068\u3057\u3066\u554f\u984c\u306a\u3044\u3093\u3067\u3057\u3087\u3046\u304b\u2026?)\n    - \u6587\u5b57\u30b3\u30fc\u30c9\u306fUTF-8\u3001\u6539\u884c\u306fLF\u306e\u307f\n    - \u30cf\u30c3\u30ab\u30bd\u30f3\u3067\u306f\u3001\u3053\u3053\u3067```commit```\u304c\u5fc5\u8981\u306a\u3053\u3068\u306b\u6c17\u3065\u3051\u305a\u6570\u6642\u9593\u3092\u30d5\u30a4\u306b\u3057\u305f(\u53cd\u7701)\n\n```json:documents.json\n{\n  \"add\": {\n    \"doc\": {\n      \"id\": \"1\",\n      \"title\": \"\uff0a\uff0a\uff0a\uff0a\",\n      \"body\": \"\uff0a\uff0a\uff0a\uff0a\",\n      \"custom_field\": \"\uff0a\uff0a\uff0a\uff0a\"\n    }\n  },\n  \"add\": {\n    \"doc\": {\n      \"id\": \"2\",\n      \"title\": \"\uff0a\uff0a\uff0a\uff0a\",\n      \"body\": \"\uff0a\uff0a\uff0a\uff0a\",\n      \"custom_field\": \"\uff0a\uff0a\uff0a\uff0a\"\n    }\n  },\n\n\u30fb\u30fb\u30fb\u4e2d\u7565\u30fb\u30fb\u30fb\n\n  \"commit\": { }\n}\n```\n\n##\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u6295\u5165\n\n- \u4ee5\u4e0b\u5b9f\u884c\u3067\u30b3\u30ec\u30af\u30b7\u30e7\u30f3\u306b\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u3092\u6295\u5165\n    - ```**cluster_id**```\u3001```**config_name**```\u306f\u9069\u5b9c\u7f6e\u63db\u3001```**document_path**```\u306b\u5148\u307b\u3069\u4f5c\u6210\u3057\u305fjson\u30d5\u30a1\u30a4\u30eb\u3078\u306e\u30d1\u30b9\u3092\u8a2d\u5b9a\n\n```shell-session\ncurl -k -X POST -H \"Content-Type: application/json\" -u \"**username**:**password**\" \"https://gateway.watsonplatform.net/retrieve-and-rank/api/v1/solr_clusters/**cluster_id**/solr/**collection_name**/update\" --data-binary @**document_path**\n```\n\n```json\n{\n  \"responseHeader\": {\n    \"status\": 0,\n    \"QTime\": 495\n  }\n}\n```\n\n##\u691c\u7d22(\u30e9\u30f3\u30ab\u30fc\u7121\u3057)\n- \u30d6\u30e9\u30a6\u30b6\u306e\u30a2\u30c9\u30ec\u30b9\u30d0\u30fc\u306b\u4ee5\u4e0b\u3092\u5165\u529b\n    - ```**xxxx**```\u306e\u7b87\u6240\u306f\u4eca\u307e\u3067\u306b\u5023\u3063\u3066\u9069\u5b9c\u5909\u66f4\u3002\u691c\u7d22\u6587\u306f\u4efb\u610f\u306b\u8a2d\u5b9a\n    - \u691c\u7d22\u6587\u306b\u5fdc\u3058\u3066\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u304c\u8fd4\u3063\u3066\u304f\u308c\u3070OK\n    - id\u691c\u7d22\u304c\u3057\u305f\u3044\u5834\u5408\u306f\u3001q=id:1\u306a\u3069\u3068\u3059\u308b\n\n```\nhttps://**username**:**password**@gateway.watsonplatform.net/retrieve-and-rank/api/v1/solr_clusters/**cluster_id**/solr/**collection_name**/select?q=\u691c\u7d22\u6587&wt=json&fl=id,title,body,custom_field\n```\n\n```json\n{\n  \"responseHeader\": {\n    \"status\": 0,\n    \"QTime\": 1,\n    \"params\":{\n      \"q\": \"\u691c\u7d22\u6587\",\n      \"fl\": \"id,title,body,custom_field\",\n      \"wt\":\"json\"\n    }\n  },\n  \"response\": {\n    \"numFound\": 58,\n    \"start\": 0,\n    \"docs\": [\n      {\n        \"id\": \"1\",\n        \"title\": [\"\uff0a\uff0a\uff0a\uff0a\"],\n        \"body\": [\"\uff0a\uff0a\uff0a\uff0a\"],\n        \"custom_field\": \"\uff0a\uff0a\uff0a\uff0a\"\n      },\n\n\u30fb\u30fb\u30fb\u4e2d\u7565\u30fb\u30fb\u30fb\n\n    ]\n  }\n}\n```\n\n##\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u4f5c\u6210\n\n- Retrieve and Rank\u3092Web\u304b\u3089\u547c\u3073\u51fa\u3059\u306b\u306f\u3001Node-RED\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u7d4c\u7531\u3059\u308b\u5fc5\u8981\u304c\u3042\u308b\n    - \u30cf\u30c3\u30ab\u30bd\u30f3\u3067\u306f\u3053\u308c\u306b\u6c17\u3065\u3051\u305a1\u6642\u9593\u307b\u3069\u30d5\u30a4\u306b\u3057\u305f(\u53cd\u7701)\n\n- [\u30a2\u30d7\u30ea](https://console.ng.bluemix.net/dashboard/applications)\u304b\u3089**\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u4f5c\u6210 > Node-RED Starter > \u4f5c\u6210**\n    - \u5165\u529b\u9805\u76ee\u306f\u4efb\u610f\u3001\u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u3088\u3044\u304c\u3001\u30db\u30b9\u30c8\u540d\u306b\u3064\u3044\u3066\u306fAPI\u306eURL\u306b\u7528\u3044\u3089\u308c\u308b\n\n- [\u30a2\u30d7\u30ea](https://console.ng.bluemix.net/dashboard/applications)\u304b\u3089**\u30a2\u30d7\u30ea\u540d > \u30e9\u30f3\u30bf\u30a4\u30e0 > \u74b0\u5883\u5909\u6570 > \u30e6\u30fc\u30b6\u30fc\u5b9a\u7fa9 > \u8ffd\u52a0 > \u4fdd\u5b58**\u3067\u30e6\u30fc\u30b6\u30fc\u540d\u3001\u30d1\u30b9\u30ef\u30fc\u30c9\u3092\u8a2d\u5b9a\n    - [\u30a2\u30d7\u30ea](https://console.ng.bluemix.net/dashboard/applications)\u306b\u3066**\u518d\u59cb\u52d5**(\u5186\u5f27\u578b\u306e\u77e2\u5370\u306e\u30dc\u30bf\u30f3)\u3092\u62bc\u3057\u3066\u304a\u304f\n\n\u540d\u524d|\u5024\n---|---\nNODE_RED_USERNAME|\u4efb\u610f\nNODE_RED_PASSWORD|\u4efb\u610f\n\n##\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u7de8\u96c6\n\n- [\u30a2\u30d7\u30ea](https://console.ng.bluemix.net/dashboard/applications)\u3067**\u30a2\u30d7\u30ea\u540d > \u7d4c\u8def**\u306b\u8868\u793a\u3055\u308c\u3066\u3044\u308bURL\u306b\u30a2\u30af\u30bb\u30b9\u3059\u308b\u3068\u3001Node-RED\u306e\u30c8\u30c3\u30d7\u753b\u9762\u304c\u8868\u793a\u3055\u308c\u308b\n\n- **Go to your Node-RED flow editor**\u3092\u30af\u30ea\u30c3\u30af\u3059\u308b\u3068\u8a8d\u8a3c\u753b\u9762\u304c\u51fa\u308b\u306e\u3067\u3001\u5148\u307b\u3069\u8a2d\u5b9a\u3057\u305f\u30e6\u30fc\u30b6\u30fc\u540d\u3001\u30d1\u30b9\u30ef\u30fc\u30c9\u3092\u5165\u529b\n\n- \u8868\u793a\u3055\u308c\u305f\u30a8\u30c7\u30a3\u30bf\u753b\u9762\u306b\u3066\u3001\u4ee5\u4e0b\u8981\u9818\u3067\u30ce\u30fc\u30c9\u3092\u4f5c\u6210\u3001\u63a5\u7d9a\n\n<img width=\"533\" alt=\"\u63a5\u7d9a\u30a4\u30e1\u30fc\u30b8\" src=\"https://qiita-image-store.s3.amazonaws.com/0/106259/d95d3010-8c13-268a-042c-2ca84531a99d.png\">\n\n###http(input)\n\n- \u753b\u9762\u5de6\u3088\u308a**input > http**\u3002\u30a8\u30c7\u30a3\u30bf\u4e2d\u592e\u306b\u30c9\u30ed\u30c3\u30d7\n\n- URL\u306b\u6307\u5b9a\u3057\u305f\u5024\u304c\u3001API\u306eURL\u306e\u30d1\u30b9\u306b\u4f7f\u7528\u3055\u308c\u308b\n\n\u540d\u524d|\u5024\n---|---\nMethod|POST\nURL|/```**path**```\nName|\u4efb\u610f\n\n###function(\u30ea\u30af\u30a8\u30b9\u30c8\u751f\u6210)\n\n- \u753b\u9762\u5de6\u3088\u308a**function > function**\n\n- Web\u3088\u308a\u547c\u3073\u51fa\u3059\u969b\u306b\u691c\u7d22\u6587\u3092\u8a2d\u5b9a\u3059\u308b\u30d1\u30e9\u30e1\u30fc\u30bf\u30fc\u3092```msg.payload```\u306e```q```\u3067\u6307\u5b9a\u3059\u308b\n\n- \u8272\u3005\u3068\u30a8\u30b9\u30b1\u30fc\u30d7\u3057\u3066\u3044\u308b\u306e\u306f[\u3053\u3061\u3089](http://d.hatena.ne.jp/miau/20140705/1404564644)\u3092\u53c2\u8003\u306b\u3002substring\u306f\u306a\u3093\u3068\u306a\u304f\u5b9f\u65bd\n\n```javascript:Function\nvar query;\ntry {\n    query = msg.payload.q.substring(0, 1000);\n} catch(e) {\n    query = \"\";\n}\nquery = query.replace(\n    /[\\\\\\+\\-\\&\\|\\!\\(\\)\\{\\}\\[\\]\\^\\\"\\~\\*\\?\\:\\/\\r\\n\\t\\u0020\\u3000]|AND|OR|NOT/g, \n    function(c) { return \"\\\\\" + c; });\nmsg.headers = {\n    \"content-type\": \"application/x-www-form-urlencoded\"\n};\nmsg.payload = {\n    \"wt\": \"json\",\n    \"fl\": \"id,title,body,custom_field\",\n    \"q\": query\n};\nreturn msg;\n```\n\n###http request\n\n- \u753b\u9762\u5de6\u3088\u308a**function > http request**\n\n\u540d\u524d|\u5024\n---|---\nMethod|POST\nURL|```https://gateway.watsonplatform.net/retrieve-and-rank/api/v1/solr_clusters/**cluster_id**/solr/**collection_name**/select```\nEnable secure (SSL/TLS) connection| \u30c1\u30a7\u30c3\u30af\u7121\nUse basic authentication|\u30c1\u30a7\u30c3\u30af\u6709\nUsername|```**username**```\nPassword|```**password**```\nReturn|a UTF-8 string\nName|\u4efb\u610f\n\n###function(\u30d8\u30c3\u30c0\u8a2d\u5b9a)\n\n- \u753b\u9762\u5de6\u3088\u308a**function > function**\n\n- CORS\u5bfe\u5fdc\u306e\u305f\u3081\n\n```javascript:Function\nmsg.headers = {\n  \"Access-Control-Allow-Origin\": \"*\"\n}\nreturn msg;\n```\n\n###json\u3001http(output)\n\n- \u753b\u9762\u5de6\u3088\u308a**function > json**\u3001**output > http response**\n\n##\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u53cd\u6620\n\n- \u753b\u9762\u53f3\u4e0a\u306e**Deploy**\u3092\u62bc\u3059\u3068\u53cd\u6620\n    - \u30a8\u30e9\u30fc\u304c\u3042\u308b\u3068\u3001\u753b\u9762\u53f3\u306e**debug**\u30bf\u30d6\u306b\u8868\u793a\u3055\u308c\u308b\n\n##Web\u304b\u3089API\u547c\u3073\u51fa\u3057\n\n- jQuery\u7b49\u3092\u4f7f\u3063\u3066API\u547c\u3073\u51fa\u3057\u3001\u7d50\u679c\u53d6\u5f97\n\n```html:test.html\n<!DOCTYPE html>\n<html>\n  <head>\n    <meta charset=\"utf-8\">\n    <title>Retrieve and Rank</title>\n    <script type=\"text/javascript\" src=\"https://code.jquery.com/jquery-3.1.1.min.js\"></script>\n  </head>\n  <body>\n    <input id=\"query\" type=\"text\">\n    <input id=\"test\" type=\"button\" value=\"Test\">\n    <div id=\"result\"></div>\n  </body>\n  <script type=\"text/javascript\">        \n    $(\"#test\").click(function(){\n      $(\"#result\").empty();\n\n      $.ajax({\n        type: \"POST\",\n        url: \"http://**\u30db\u30b9\u30c8\u540d**.mybluemix.net/**path**\",\n        dataType: \"json\",\n        data: {\n            q: $(\"#query\").val()\n        }\n      }).done(function(data){\n        var doc = \"\";\n        var docs = data.response.docs;\n        if (docs.length > 0) {\n            doc = JSON.stringify(docs[0]);\n        } else {\n            doc = \"\u7d50\u679c\u304c\u898b\u3064\u304b\u308a\u307e\u305b\u3093\u3067\u3057\u305f\u3002\";\n        }\n        $(\"#result\").text(doc);\n      }).fail(function(error){\n          console.log(error);\n      });\n    });\n  </script>\n</html>\n```\n\n##\u5b66\u7fd2\n\n- \u30cf\u30c3\u30ab\u30bd\u30f3\u3067\u306f\u6642\u9593\u304c\u8db3\u3089\u305a\u6ce3\u304f\u6ce3\u304f\u8ae6\u3081\u305f\u3001\u30e9\u30f3\u30ab\u30fc\u3092\u7528\u3044\u305f\u691c\u7d22\u306b\u3064\u3044\u3066\u6311\u6226\u3057\u305f\n\n###Grandtruth\u306e\u4f5c\u6210\n\n- \u8cea\u554f\u306b\u5bfe\u3057\u3066\u3069\u306e\u89e3\u7b54\u304c\u9069\u5207\u3067\u3042\u3063\u305f\u304b\u89e3\u7b54\u3057\u3066Grandtruth\u3092\u751f\u6210\u3059\u308b\u30c4\u30fc\u30eb\u3092\u4f5c\u308a\u3001\u30e9\u30f3\u30ab\u30fc\u3092\u4f5c\u6210\n    - **\u8cea\u554f\u6587\u5165\u529b&\u89e3\u7b54\u5019\u88dc\u8868\u793a\u2192\u9069\u5207\u3068\u601d\u308f\u308c\u308b\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u306e\u30dc\u30bf\u30f3\u3092\u62bc\u3059\u2192\u8cea\u554f\u6587\u5165\u529b\u2026\u2192Groundtruth\u53d6\u5f97**\u3067CSV\u30d5\u30a1\u30a4\u30eb\u4f5c\u6210\n\n```html:test2.html\n<!DOCTYPE html>\n<html>\n  <head>\n    <meta charset=\"utf-8\">\n    <title>Groundtruth</title>\n    <script type=\"text/javascript\" src=\"https://code.jquery.com/jquery-3.1.1.min.js\"></script>\n    <style type=\"text/css\">\n      body {\n        font-size: small;\n      }\n      #query {\n        width: 95%;\n      }\n      #header {\n        position: fixed;\n        top: 0;\n        left: 0;\n        right: 0;\n        padding: 0.2em;\n        background-color: gray;\n      }\n      .doc {\n        border: 1px solid gray;\n        border-radius: 0.2em;\n        margin: 0.2em;\n        padding: 0.2em;\n      }\n      #result {\n        margin-top: 4em;\n      }\n    </style>\n  </head>\n  <body>\n    <div id=\"header\">\n      <input id=\"query\" type=\"text\" placeholder=\"\u8cea\u554f\u6587\"><br>\n      <input id=\"send\" type=\"button\" value=\"\u5019\u88dc\u8868\u793a\">\n      <input id=\"getgt\" type=\"button\" value=\"Groundtruth\u53d6\u5f97\">\n      <a id=\"downloadlink\" target=\"_blank\" href=\"#\"></a>\n    </div>\n    <div id=\"result\"></div>\n  </body>\n  <script type=\"text/javascript\">\n    var MAX_USEFUL=4;\n    var groundtruth={};\n    \n    $(\"#send\").click(function(){\n      var $result=$(\"#result\");\n      $result.empty();\n      \n      var $query=$(\"#query\");      \n      $.ajax({\n        type: \"POST\",\n        url: \"http://**\u30db\u30b9\u30c8\u540d**.mybluemix.net/**path**\",\n        dataType: \"json\",\n        data: {\n          q: $query.val()\n        }\n      }).done(function(data){\n        var docs = data.response.docs;\n        if (docs.length > 0) {\n          docs.forEach(function(doc){\n            var $doc=$(\"<div>\").addClass(\"doc\").data({ \n              \"query\": data.responseHeader.params.q,\n              \"doc\": doc \n            });\n            \n            $doc.append($(\"<input>\").attr({\n              \"id\": \"useful\",\n              \"type\": \"button\",\n              \"value\": doc.id,\n            }).click(function(){ clickUseful($doc); }));\n            \n            $doc.append($(\"<span>\").addClass(\"counter\"));\n            $doc.append($(\"<div>\").text(doc.body));            \n            \n            $result.append($doc);\n          });\n        } else {\n          $result.text(\"\u7d50\u679c\u304c\u898b\u3064\u304b\u308a\u307e\u305b\u3093\u3067\u3057\u305f\u3002\");\n        }\n      }).fail(function(error){\n          console.log(error);\n      });      \n    });\n    \n    $(\"#getgt\").click(function(){\n      var rows=[];\n      $.each(groundtruth,function(query, idList){\n        var row=[];\n        row.push(query);\n        $.each(idList,function(id, count){\n          row.push(id);\n          row.push(count);\n        });\n        rows.push(row.map(function(value){ return escapeCSV(String(value)) }).join(\",\"));\n      });\n      rows.push(\"\");\n\n      var blob = new Blob([rows.join(\"\\n\")], { \"type\": \"text/plain\" });\n      var $downloadlink=$(\"#downloadlink\");\n      $downloadlink.attr(\"href\", window.URL.createObjectURL(blob));\n      $downloadlink.attr(\"download\", \"gt_\" + createTimeString() + \".csv\");\n      $downloadlink[0].click();\n    });\n    \n    function clickUseful($doc) {\n      var query=$doc.data(\"query\");\n      var id=$doc.data(\"doc\").id;\n      if (groundtruth[query] === undefined) {\n        groundtruth[query]={};\n      }\n      \n      var count=(groundtruth[query][id] === undefined ? 0 : groundtruth[query][id]);\n      count=Math.min(count + 1, MAX_USEFUL);\n      groundtruth[query][id]=count;\n\n      $doc.find(\".counter\").text(count);\n      if (count >= MAX_USEFUL) {\n        $doc.find(\"#useful\").prop(\"disabled\", true);        \n      }      \n    }\n    \n    function escapeCSV(value) {\n      return \"\\\"\" + value.replace(/\\\"/, \"\\\"\\\"\") + \"\\\"\";\n    }\n    function createTimeString() {\n      function padZero(num) {\n          var result;\n          if (num < 10) {\n              result = \"0\" + num;\n          } else {\n              result = \"\" + num;\n          }\n          return result;\n      }\n      var now = new Date();\n      var res = \"\" + now.getFullYear() + padZero(now.getMonth() + 1) + \n          padZero(now.getDate()) + padZero(now.getHours()) + \n          padZero(now.getMinutes()) + padZero(now.getSeconds());\n      return res;\n    }\n  </script>\n</html>\n```\n\n<img width=\"588\" alt=\"\u30c4\u30fc\u30eb\" src=\"https://qiita-image-store.s3.amazonaws.com/0/106259/8630c050-e6c2-e6da-4fe8-78748418a720.png\">\n\n- \u8cea\u554f\u6587,\u89e3\u7b541\u306eID,\u89e3\u7b541\u306e\u5f79\u306b\u7acb\u3063\u305f\u5ea6(1\u301c4),\u89e3\u7b542\u306eID,\u89e3\u7b542\u306e\u5f79\u306b\u7acb\u3063\u305f\u5ea6(1\u301c4)...\n    - \u8cea\u554f\u6587\u306b\u5bfe\u3057\u89e3\u7b54\u5019\u88dc\u3068\u3057\u3066\u8fd4\u5374\u3055\u308c\u306a\u3044ID\u3092\u6307\u5b9a\u3059\u308b\u3068\u3001\u6b21\u306etrain.py\u3067\u30a8\u30e9\u30fc\u3068\u306a\u308b\n\n    - \u6700\u4f4e49\u884c(=\u30e6\u30cb\u30fc\u30af\u306a\u8cea\u554f\u658749\u500b)\u4ee5\u4e0a\u304c\u5fc5\u8981\u3089\u3057\u3044\u3002\u8db3\u308a\u306a\u3044\u3068\u3084\u306f\u308a\u30a8\u30e9\u30fc\u306b\u306a\u308b\n\n    - \u305d\u306e\u4ed6\u3001\u5fc5\u8981\u306a\u8981\u4ef6\u304c\u8272\u3005\u3068\u3042\u308b\u6a21\u69d8([\u3053\u3061\u3089](http://www.slideshare.net/kotasuizu5/watson-61078069)\u306ep25\u3068\u304b\u3001[\u3053\u3053](https://www.ibm.com/watson/developercloud/doc/retrieve-rank/training_data.shtml#data_stds)\u3068\u304b)\n\n    - UTF-8\u3001LF\u3067\u51fa\u529b\u306e\u3053\u3068\n\n```javascript:gt.csv(\u30a4\u30e1\u30fc\u30b8)\n\"\u3053\u3093\u306b\u3061\u306f\",\"7203\",\"3\",\"7654\",\"2\"\n\n```\n\n###\u30e9\u30f3\u30ab\u30fc\u306e\u4f5c\u6210\n\n- csv\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u3063\u305f\u3089\u3001[\u3053\u3061\u3089](http://www.ibm.com/watson/developercloud/doc/retrieve-rank/tutorial.shtml#create-train)\u304b\u3089**train.py**\u3092\u53d6\u5f97\u3057\u3001\u4ee5\u4e0b\u5b9f\u884c\n    - ```**ranker_name**```\u306f\u4efb\u610f\u3067\u3088\u3044\n    - Windows\u74b0\u5883\u306e\u4eba\u306f\u3001Python\u3092\u4f7f\u3048\u308b\u3088\u3046\u306b\u3059\u308b\u5fc5\u8981\u304c\u3042\u308b\n\n```shell-session\npython ./train.py -u \"**username**:**password**\" -i ./gt.csv -c \"**cluster_id**\" -x \"**collection_name**\" -n \"**ranker_name**\"\n```\n\n```text\nInput file is ./gt.csv\nSolr cluster is **cluster_id**\nSolr collection is **collection_name**\nRanker name is **ranker_name**\nRows per query 10\nGenerating training data...\nGenerating training data complete.\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n100  242k    0   316  100  241k    113  88936  0:00:02  0:00:02 --:--:-- 88935\n```\n\n- \u30b9\u30c6\u30fc\u30bf\u30b9\u304c```Training```\u306e\u9593\u306f\u4f7f\u7528\u4e0d\u53ef\u30025\u5206\u7a0b\u5ea6\u304b\u304b\u308b\u306e\u3067\u66ab\u3057\u5f85\u3064\n    - ```**ranker_id**```\u3092\u30e1\u30e2\n\n```json\n{\n  \"ranker_id\": \"**ranker_id**\",\n  \"name\": \"**ranker_name**\",\n  \"created\": \"2016-11-18T19:14:20.146Z\",\n  \"url\": \"https://gateway.watsonplatform.net/retrieve-and-rank/api/v1/rankers/**ranker_id**\",\n  \"status\": \"Training\",\n  \"status_description\": \"The ranker instance is in its training phase, not yet ready to accept rank requests\"\n}\n```\n\n- \u30e9\u30f3\u30ab\u30fc\u306e\u72b6\u614b\u78ba\u8a8d\u306f\u4ee5\u4e0b\u3002```Available```\u3068\u306a\u308c\u3070OK\n\n```shell-session\ncurl -u \"**username**:**password**\" \"https://gateway.watsonplatform.net/retrieve-and-rank/api/v1/rankers/**ranker_id**\"\n```\n\n```json\n{\n  \"ranker_id\": \"**ranker_id**\",\n  \"name\": \"**ranker_name**\",\n  \"created\":\"2016-11-18T19:14:20.146Z\",\n  \"url\": \"https://gateway.watsonplatform.net/retrieve-and-rank/api/v1/rankers/**ranker_id**\",\n  \"status\": \"Available\",\n  \"status_description\": \"The ranker instance is now available and is ready to take ranker requests.\"\n}\n```\n\n###\u691c\u7d22(\u30e9\u30f3\u30ab\u30fc\u6709\u308a)\n\n- fcselect\u3067\u5b9f\u65bd\n    - API\u30ea\u30d5\u30a1\u30ec\u30f3\u30b9\u306b\u8a18\u8f09\u304c\u306a\u3044\u304c\u3001fl\u306b```ranker.confidence```\u3092\u8ffd\u52a0\u3059\u308b\u3068\u3001\u30e9\u30f3\u30af\u4ed8\u3051\u306e\u4fe1\u983c\u5ea6\u304c\u51fa\u529b\u3055\u308c\u308b([\u3053\u3053](http://www.ibm.com/watson/developercloud/doc/retrieve-rank/training_data.shtml#top)\u306e**Working with ranker confidence scores**\u53c2\u7167)\n\n```\nhttps://**username**:**password**@gateway.watsonplatform.net/retrieve-and-rank/api/v1/solr_clusters/**cluster_id**/solr/**collection_name**/fcselect?ranker_id=**ranker_id**&q=\u691c\u7d22\u6587&wt=json&fl=id,title,body,custom_field,ranker.confidence\n```\n\n```json\n{\n  \"responseHeader\": {\n    \"status\": 0,\n    \"QTime\": 75\n  },\n  \"response\": {\n    \"numFound\": 11,\n    \"start\": 0,\n    \"maxScore\": 10.0,\n    \"docs\": [\n      {\n        \"id\": \"7722\",\n        \"title\": [\"\uff0a\uff0a\uff0a\uff0a\"],\n        \"body\": [\"\uff0a\uff0a\uff0a\uff0a\"],\n        \"custom_field\": \"\uff0a\uff0a\uff0a\uff0a\",\n        \"ranker.confidence\": 0.48287850973637736\n      },\n      {\n        \"id\": \"7203\",\n        \"title\": [\"\uff0a\uff0a\uff0a\uff0a\"],\n        \"body\": [\"\uff0a\uff0a\uff0a\uff0a\"],\n        \"custom_field\": \"\uff0a\uff0a\uff0a\uff0a\",\n        \"ranker.confidence\": 0.3192066081818791\n      },\n\n\u30fb\u30fb\u30fb\u4e2d\u7565\u30fb\u30fb\u30fb\n\n    ]\n  }\n}\n```\n\n###\u7d50\u679c\u306e\u6bd4\u8f03\n\n- \u5de6\u304cselect(=\u5b66\u7fd2\u7121?)\u3001\u53f3\u304cfcselect(=\u5b66\u7fd2\u6709?)\n\n- \"7810\"\u306fselect\u3067\u30e9\u30f3\u30af\u306e\u4e00\u756a\u4e0b\u3060\u3063\u305f\u304c\u3001fcselect\u3067\u306f\u691c\u7d22\u306b\u5f15\u3063\u304b\u304b\u3089\u306a\u304f\u306a\u3063\u305f\u2026\n\n- \"1908\"\u306a\u3069\u3001\u76f4\u63a5\u6307\u5b9a\u3057\u3066\u3044\u306a\u3044ID\u3082\u30e9\u30f3\u30af\u304c\u4e0a\u6607\n    - \"\u3069\u3046\u3082\u3088\u308d\u3057\u304f\u304a\u9858\u3044\u3057\u307e\u3059\"\u3067\"4\"\u3092\u6307\u5b9a\u3057\u3066\u3044\u308b\u306e\u3067\u3001\u305d\u306e\u5f71\u97ff\u304b?\n\n- \"7963\"\u306f\u3001Grandtruth\u5168\u4f53\u3092\u901a\u3058\u3066\u4e00\u5ea6\u3082\u30dc\u30bf\u30f3\u3092\u62bc\u3057\u3066\u306a\u3044\u304c\u9806\u4f4d\u304c\u4e0a\u6607\u3057\u3066\u3044\u308b\n    - \u5468\u308a\u304c\u4e0b\u304c\u3063\u3066\u3044\u308b?\n    - \u305d\u306e\u4ed6\u8272\u3005\u306a\u8cea\u554f\u6587\u306b\u30dc\u30bf\u30f3\u3092\u62bc\u3057\u3066\u3044\u308b\u306e\u3067\u3001\u305d\u308c\u3089\u306e\u5f71\u97ff\u3082\u3042\u308b\u306e\u304b\u3082\n\n```javascript:Grandtruth(\u629c\u7c8b)\n\"\u3069\u3046\u3082\",\"1525\",\"2\",\"4669\",\"4\",\"6137\",\"3\",\"7481\",\"3\",\"8252\",\"4\"\n\"\u3069\u3046\u3082\u30fc\",\"1908\",\"2\",\"7481\",\"2\",\"7810\",\"2\",\"8252\",\"3\"\n\"\u3069\u3046\u3082\u3042\u308a\u304c\u3068\u3046\u3054\u3056\u3044\u307e\u3057\u305f\",\"2475\",\"4\",\"5984\",\"4\",\"6220\",\"4\",\"6490\",\"4\"\n\"\u3069\u3046\u3082\u3088\u308d\u3057\u304f\u304a\u9858\u3044\u3057\u307e\u3059\",\"252\",\"4\",\"1439\",\"4\",\"1750\",\"2\",\"1821\",\"2\",\"1908\",\"4\",\"3731\",\"4\"\n\"\u3069\u3046\u3082\u3053\u3093\u306b\u3061\u306f\",\"3627\",\"3\",\"7203\",\"2\",\"7654\",\"2\",\"7660\",\"4\",\"7722\",\"2\"\n```\n\n<img width=\"944\" alt=\"\u6bd4\u8f03\" src=\"https://qiita-image-store.s3.amazonaws.com/0/106259/70fc5084-4425-0eb3-2249-6fe6566c4ad5.png\">\n\n##\u5f8c\u7247\u4ed8\u3051\n\n- [\u3053\u3061\u3089](http://www.ibm.com/developerworks/jp/bluemix/credit.html)\u3092\u898b\u308b\u3068\u3001\u8a66\u7528\u671f\u9593\u7d42\u4e86\u5f8c\u306b\u81ea\u52d5\u3067\u5168\u524a\u9664\u3055\u308c\u308b\u96f0\u56f2\u6c17\u3060\u304c\u3001\u306a\u3093\u3068\u306a\u304f\u624b\u3067\u6d88\u3057\u3066\u304a\u304f\n\n- \u30e9\u30f3\u30ab\u30fc\u524a\u9664\n\n```shell-session\ncurl -X DELETE -u \"**username**:**password**\" \"https://gateway.watsonplatform.net/retrieve-and-rank/api/v1/rankers/**ranker_id**\"\n```\n\n```json\n{}\n```\n\n- \u30b3\u30ec\u30af\u30b7\u30e7\u30f3\u524a\u9664\n\n```shell-session\ncurl -X POST -u \"**username**:**password**\" \"https://gateway.watsonplatform.net/retrieve-and-rank/api/v1/solr_clusters/**cluster_id**/solr/admin/collections\" -d \"action=DELETE&name=**collection_name**\"\n```\n\n```xml\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<response>\n  <lst name=\"responseHeader\">\n    <int name=\"status\">0</int>\n    <int name=\"QTime\">907</int>\n  </lst>\n  <lst name=\"success\">\n    <lst name=\"****\">\n      <lst name=\"responseHeader\">\n        <int name=\"status\">0</int>\n        <int name=\"QTime\">95</int>\n      </lst>\n    </lst>\n    <lst name=\"****\">\n      <lst name=\"responseHeader\">\n        <int name=\"status\">0</int>\n        <int name=\"QTime\">119</int>\n      </lst>\n    </lst>\n  </lst>\n</response>\n```\n\n- \u30b3\u30f3\u30d5\u30a3\u30b0\u524a\u9664\n\n```shell-session\ncurl -X DELETE -u \"**username**:**password**\" \"https://gateway.watsonplatform.net/retrieve-and-rank/api/v1/solr_clusters/**cluster_id**/config/**config_name**\"\n```\n\n```json\n{\n  \"message\": \"WRRCSR025: Successfully deleted named config [**config_name**] for Solr cluster [**cluster_id**].\",\n  \"statusCode\": 200\n}\n```\n\n- \u30af\u30e9\u30b9\u30bf\u524a\u9664\n\n```shell-session\ncurl -X DELETE -u \"**username**:**password**\" \"https://gateway.watsonplatform.net/retrieve-and-rank/api/v1/solr_clusters/**cluster_id**\"\n```\n\n```json\n{\n  \"message\": \"WRRCSR023: Successfully deleted Solr cluster [**cluster_id**].\",\n  \"statusCode\": 200\n}\n```\n\n- [\u30a2\u30d7\u30ea](https://console.ng.bluemix.net/dashboard/applications)\u3001[\u30b5\u30fc\u30d3\u30b9](https://console.ng.bluemix.net/dashboard/services)\u304b\u3089\u3001\u4f5c\u6210\u3057\u305f\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3001\u30b5\u30fc\u30d3\u30b9\u3092\u524a\u9664\n"}