{"context": " More than 1 year has passed since last update.\n\n1.\u306f\u3058\u3081\u306b\n\u524d\u56de\u306fL2TP/IPSec\u306aVPN\u3092\u4f5c\u6210\u3057\u307e\u3057\u305f\u3002\n\u4eca\u56de\u306fIKEv2(IPSec EAP MSCHAPv2)\u306aVPN\u3092\u69cb\u7bc9\u3057\u307e\u3059\u3002\n\u4ee5\u4e0b\u306e\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u304b\u3089\u63a5\u7d9a\u3067\u304d\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3057\u3066\u3044\u307e\u3059\u3002\n\nWindows 10: IKEv2\u63a5\u7d9a\nAndroid 6.0.1: strongSwan VPN Client\n\n\nVPN\u30b5\u30fc\u30d0\u30fc\u306eOS\u306f\u4ee5\u4e0b\u306e\u901a\u308a\u3067\u3059\u3002\n\nUbuntuServer 15.04\nSELinux \u306f\u7121\u52b9\u5316\n\n\n2.\u624b\u9806\n\n2.1.\u5fc5\u8981\u306a\u30a2\u30d7\u30ea\u306e\u5c0e\u5165\n$ sudo apt-get install strongswan-plugin-eap-mschapv2\n\n\n2.2.\u5404\u7a2e\u8a2d\u5b9a\n\n\u8a8d\u8a3c\u7528\u30d5\u30a1\u30a4\u30eb\u4f5c\u6210\n\u30b5\u30fc\u30d0\u30fc\u5074\u7528\u306b\u79d8\u5bc6\u9375\u3084\u8a3c\u660e\u66f8\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002strongSwan\u306b\u306f\u8a3c\u660e\u66f8\u306e\u4f5c\u6210\u5411\u3051\u306bipsec pki\u304c\u3042\u308a\u307e\u3059\u3002\u4f5c\u6210\u3057\u305f\u30d5\u30a1\u30a4\u30eb\u306f\u4ee5\u4e0b\u306e\u5834\u6240\u306b\u9069\u5207\u306b\u914d\u7f6e\u3057\u307e\u3059\u3002\n\n/etc/ipsec.d/cacerts/: \u8a8d\u8a3c\u5c40\u8a3c\u660e\u66f8\n/etc/ipsec.d/certs/: \u30b5\u30fc\u30d0\u30fc\u8a3c\u660e\u66f8\n/etc/ipsec.d/private/: \u8a8d\u8a3c\u5c40\u30fb\u30b5\u30fc\u30d0\u30fc\u306e\u79d8\u5bc6\u9375\n\nWindows\u7528\u306e\u3072\u306d\u308a\u3092\u5165\u308c\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\n\u4ee5\u4e0b\u306e\u64cd\u4f5c\u3092root\u6a29\u9650\u3067\u884c\u3044\u3001Windows\u5bfe\u5fdc\u306e\u8a3c\u660e\u66f8\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\u8a3c\u660e\u66f8\u306f\u30b5\u30fc\u30d0\u30fc\u306e\u9069\u5207\u306a\u5834\u6240\u3078\u914d\u7f6e\u3057\u307e\u3059\u3002\n\nsetupCert.sh\n#!/bin/bash\n\n#\u5404\u7a2e key,crt,\u30b5\u30fc\u30d0\u30fc\u30c9\u30e1\u30a4\u30f3\u3092\u57cb\u3081\u3066\u5b9f\u884c\u3057\u307e\u3059\u3002\n#\u30d5\u30a1\u30a4\u30eb\u540d\nreadonly CA_KEY=#\u8a8d\u8a3c\u5c40\u79d8\u5bc6\u9375.key\nreadonly CA_CRT=#\u8a8d\u8a3c\u5c40\u8a3c\u660e\u66f8.crt\nreadonly VPN_KEY=#\u30b5\u30fc\u30d0\u30fc\u79d8\u5bc6\u9375.key\nreadonly VPN_CRT=#\u30b5\u30fc\u30d0\u30fc\u8a3c\u660e\u66f8.crt\n#\u4f5c\u696d\u5834\u3001VPN\u30b5\u30fc\u30d0\u30fc\u30c9\u30e1\u30a4\u30f3\nreadonly SRV_DOMAIN=#\u30b5\u30fc\u30d0\u30fc\u30c9\u30e1\u30a4\u30f3\nreadonly OUTPATH=./keyCrts\n\n#\u521d\u671f\u5316\nrm /etc/ipsec.d/cacerts/*\nrm /etc/ipsec.d/certs/*\nrm /etc/ipsec.d/private/*\nmkdir ./keyCrts\n\n#\u30eb\u30fc\u30c8\u8a3c\u660e\u66f8\u4f5c\u6210\ncakey=${OUTPATH}/${CA_KEY}\ncacrt=${OUTPATH}/${CA_CRT}\nipsec pki --gen > $cakey\nipsec pki --self --in $cakey --ca --dn \"C=JP, O=strongSwan, CN=strongSwanVPN CA\" > $cacrt\n\ncp $cakey /etc/ipsec.d/private/\ncp $cacrt /etc/ipsec.d/cacerts/\nchmod 600 /etc/ipsec.d/private/$CA_KEY\nchmod 600 /etc/ipsec.d/cacerts/$CA_CRT\nchown root:root /etc/ipsec.d/private/$CA_KEY\nchown root:root /etc/ipsec.d/cacerts/$CA_CRT\n\n#\u30b5\u30fc\u30d0\u30fc\u8a3c\u660e\u66f8\u4f5c\u6210\n# \u7f72\u540d\u306b\u3072\u306d\u308a\u304c\u3042\u308b\u305f\u3081\u6ce8\u610f\u3002\n# \u53c2\u8003\u8cc7\u6599:\n# 1). https://wiki.strongswan.org/projects/strongswan/wiki/Win7CertReq\nsrvkey=${OUTPATH}/${VPN_KEY}\nsrvcrt=${OUTPATH}/${VPN_CRT}\nipsec pki --gen > $srvkey\nipsec pki --pub --in $srvkey | \\\n    ipsec pki \\\n    --issue --cacert $cacrt --cakey $cakey --san $SRV_DOMAIN \\\n    --flag serverAuth --dn \"C=JP, O=strongSwan, CN=${SRV_DOMAIN}\" > $srvcrt\n\ncp $srvkey /etc/ipsec.d/private/\ncp $srvcrt /etc/ipsec.d/certs/\nchmod 600 /etc/ipsec.d/private/$VPN_KEY\nchmod 600 /etc/ipsec.d/certs/$VPN_CRT\nchown root:root /etc/ipsec.d/private/$VPN_KEY\nchown root:root /etc/ipsec.d/certs/$VPN_CRT\n\n\n\n\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u7de8\u96c6\n\n/etc/ipsec.conf\n# IPSec IKEv2\nconn EAP-MSCHAPv2\n   leftsubnet=0.0.0.0/0\n   auto=add\n   # \u7701\u7565\u53ef(default: pubkey)\u3002\u8a8d\u8a3c\u65b9\u5f0f\u3002\u30b5\u30fc\u30d0\u30fc\u5074\u306f\u516c\u958b\u9375\u8a8d\u8a3c\u3002\n   leftauth=pubkey\n   # \u5fc5\u9808\u3002\u8a3c\u660e\u66f8\u3002\n   leftcert=#\u30b5\u30fc\u30d0\u30fc\u8a3c\u660e\u66f8.crt\n   # \u5fc5\u9808\u3002\u8a8d\u8a3c\u65b9\u5f0f\u3002\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u306fEAP-MSCHAPv2\u8a8d\u8a3c\u3002\n   rightauth=eap-mschapv2\n   # \u5fc5\u9808\u3002VPN\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u3078\u632f\u308bIP\u30a2\u30c9\u30ec\u30b9\u306e\u7bc4\u56f2\u3002IKEv2\u8a8d\u8a3c\u3092\u4f7f\u7528\u3059\u308b\u969b\u306b\u306f\u5fc5\u8981\u3002\n   # \u30b5\u30fc\u30d0\u30fc\u306e\u6240\u5c5e\u30cd\u30c3\u30c8\u3068\u306f\u7570\u306a\u308b\u30a2\u30c9\u30ec\u30b9\u306b\u3059\u308b\u3002\n   rightsourceip=192.168.x.0/24\n   # \u5fc5\u9808\u3002Windows\u5bfe\u5fdc\u306b\u5fc5\u8981\u3002Android\u3067\u306f\u4e0d\u8981\n   eap_identity=%any\n\n\n\n\u8a8d\u8a3c\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u7de8\u96c6\n\n/etc/ipsec.secrets\n# \u30b5\u30fc\u30d0\u30fc\u79d8\u5bc6\u9375\u3001\u30e6\u30fc\u30b6\u30fc\u540d\u3001\u30d1\u30b9\u30ef\u30fc\u30c9\u90e8\u5206\u3092\n# \u57cb\u3081\u305f\u3082\u306e\u3092ipsec.secrets\u3078\u8ffd\u8a18\u3059\u308b\u3002\n\n%any : RSA KeyAAA #\u30b5\u30fc\u30d0\u30fc\u79d8\u5bc6\u9375.key\nUserNameBBB : EAP \"PasswordCCC\" #\u30e6\u30fc\u30b6\u30fc\u540d & \u30d1\u30b9\u30ef\u30fc\u30c9\n\n\n\nsysctl \u306e\u7de8\u96c6\n\n/etc/sysctl.conf\n#\u30b5\u30fc\u30d0\u30fc\u304cVPN\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u3068\u5185\u90e8\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u3092\u7e4b\u3050\u30eb\u30fc\u30bf\u30fc\n#\u3068\u3057\u3066\u6a5f\u80fd\u3067\u304d\u308b\u3088\u3046\u4ee5\u4e0b\u306e\u8a2d\u5b9a\u3092sysctl.conf\u3078\u8ffd\u8a18\u3059\u308b\u3002\nnet.ipv4.ip_forward=1\n\n\n\n\u305d\u306e\u4ed6\u306e\u4f5c\u696d\n\n\n\u4f5c\u6210\u3057\u305f\u30eb\u30fc\u30c8\u8a3c\u660e\u66f8\u3092\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u3078\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n\n\u30eb\u30fc\u30bf\u30fc\u3092\u8a2d\u5b9a\u5909\u66f4\nVPN\u30b5\u30fc\u30d0\u30fc\u306e\u6240\u5c5e\u30cd\u30c3\u30c8\u306e\u30eb\u30fc\u30bf\u30fc\u306b\u306fVPN\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u3078\u632f\u3089\u308c\u308bVirtualIP\u306e\u7d4c\u8def\u8a2d\u5b9a\u3092\u884c\u3046\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\n192.168.x.0/24 \u2192 192.168.x.x\n\n\n2.3.\u30cf\u30de\u308a\u3069\u3053\u308d\n\n\nMTU: \u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u306eMTU\u3092\u30ec\u30b8\u30b9\u30c8\u30ea\u3067\u5909\u66f4\u3059\u308b\u5fc5\u8981\u304c\u751f\u3058\u308b\u3053\u3068\u304c\u3042\u308a\u307e\u3059\u3002\nAndroid (strongSwan VPN Client): \u30aa\u30d7\u30b7\u30e7\u30f3\u304b\u3089\u5909\u66f4\u53ef\u80fd\u3002\nWindows: Tech TIPS\uff1a\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306eMTU\u30b5\u30a4\u30ba\u3092\u5909\u66f4\u3059\u308b\n\n\n\n3.\u611f\u60f3\nstrongSwan\u3068IKEv2\u306e\u611f\u60f3\u306f\u4ee5\u4e0b\u306e\u901a\u308a\u3002\n\n\n\u826f\u304b\u3063\u305f\u70b9\n\n\u5358\u4f53\u3067VPN\u3092\u69cb\u7bc9\u3067\u304d\u308b\u305f\u3081\u306b\u30b7\u30f3\u30d7\u30eb\u3067\u8a2d\u5b9a\u3057\u3084\u3059\u3044\u3002(strongSwan IKEv2)\n\u4ed6\u306e\u30bd\u30d5\u30c8\u3068\u6bd4\u8f03\u3057\u3066apt-get\u304b\u3089\u5165\u308c\u3089\u308c\u308b\u305f\u3081\u3001\u66f4\u65b0\u304c\u697d\u3002(strongSwan)\nL2TP/IPSec\u3088\u308a\u65e9\u3044\u3089\u3057\u3044\u3002(\u901f\u5ea6\u6e2c\u5b9a\u3057\u3066\u307f\u307e\u3057\u305f\u304c\u5fae\u5999...(IKEv2)\n\n\n\n\u60aa\u304b\u3063\u305f\u70b9\n\nMTU\u8abf\u6574\u3092\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u5074\u3067\u884c\u308f\u306a\u3051\u308c\u3070\u306a\u3089\u306a\u3044\u3002(IKEv2)\n\u8272\u3005\u62d8\u3089\u306a\u3051\u308c\u3070SoftEther VPN\u306f\u697d\u3067\u3088\u304b\u3063\u305f...(strongSwan)\n\n\n\n\n\u53c2\u8003\u8cc7\u6599\n\n\u300cWindows 7 and newer\u300d\nhttps://wiki.strongswan.org/projects/strongswan/wiki/Windows7\n\n\u300cSetting-up a Simple CA Using the strongSwan PKI Tool\u300d\nhttps://wiki.strongswan.org/projects/1/wiki/SimpleCA\n\n\u300cRequirements for certificates used with Windows 7\u300d\nhttps://wiki.strongswan.org/projects/strongswan/wiki/Win7CertReq\n\n\n# 1.\u306f\u3058\u3081\u306b\n[\u524d\u56de](http://qiita.com/namoshika/items/30c348b56474d422ef64)\u306fL2TP/IPSec\u306aVPN\u3092\u4f5c\u6210\u3057\u307e\u3057\u305f\u3002\n\u4eca\u56de\u306fIKEv2(IPSec EAP MSCHAPv2)\u306aVPN\u3092\u69cb\u7bc9\u3057\u307e\u3059\u3002\n\n\u4ee5\u4e0b\u306e\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u304b\u3089\u63a5\u7d9a\u3067\u304d\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3057\u3066\u3044\u307e\u3059\u3002\n\n* Windows 10: IKEv2\u63a5\u7d9a\n* Android 6.0.1: [strongSwan VPN Client](https://play.google.com/store/apps/details?id=org.strongswan.android&hl=ja)\n\nVPN\u30b5\u30fc\u30d0\u30fc\u306eOS\u306f\u4ee5\u4e0b\u306e\u901a\u308a\u3067\u3059\u3002\n\n* UbuntuServer 15.04\n* SELinux \u306f\u7121\u52b9\u5316\n\n# 2.\u624b\u9806\n## 2.1.\u5fc5\u8981\u306a\u30a2\u30d7\u30ea\u306e\u5c0e\u5165\n```bash\n$ sudo apt-get install strongswan-plugin-eap-mschapv2\n```\n\n## 2.2.\u5404\u7a2e\u8a2d\u5b9a\n### \u8a8d\u8a3c\u7528\u30d5\u30a1\u30a4\u30eb\u4f5c\u6210\n\u30b5\u30fc\u30d0\u30fc\u5074\u7528\u306b\u79d8\u5bc6\u9375\u3084\u8a3c\u660e\u66f8\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002strongSwan\u306b\u306f\u8a3c\u660e\u66f8\u306e\u4f5c\u6210\u5411\u3051\u306bipsec pki\u304c\u3042\u308a\u307e\u3059\u3002\u4f5c\u6210\u3057\u305f\u30d5\u30a1\u30a4\u30eb\u306f\u4ee5\u4e0b\u306e\u5834\u6240\u306b\u9069\u5207\u306b\u914d\u7f6e\u3057\u307e\u3059\u3002\n\n* /etc/ipsec.d/cacerts/: \u8a8d\u8a3c\u5c40\u8a3c\u660e\u66f8\n* /etc/ipsec.d/certs/: \u30b5\u30fc\u30d0\u30fc\u8a3c\u660e\u66f8\n* /etc/ipsec.d/private/: \u8a8d\u8a3c\u5c40\u30fb\u30b5\u30fc\u30d0\u30fc\u306e\u79d8\u5bc6\u9375\n\nWindows\u7528\u306e\u3072\u306d\u308a\u3092\u5165\u308c\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\n\u4ee5\u4e0b\u306e\u64cd\u4f5c\u3092root\u6a29\u9650\u3067\u884c\u3044\u3001Windows\u5bfe\u5fdc\u306e\u8a3c\u660e\u66f8\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\u8a3c\u660e\u66f8\u306f\u30b5\u30fc\u30d0\u30fc\u306e\u9069\u5207\u306a\u5834\u6240\u3078\u914d\u7f6e\u3057\u307e\u3059\u3002\n\n```bash:setupCert.sh\n#!/bin/bash\n\n#\u5404\u7a2e key,crt,\u30b5\u30fc\u30d0\u30fc\u30c9\u30e1\u30a4\u30f3\u3092\u57cb\u3081\u3066\u5b9f\u884c\u3057\u307e\u3059\u3002\n#\u30d5\u30a1\u30a4\u30eb\u540d\nreadonly CA_KEY=#\u8a8d\u8a3c\u5c40\u79d8\u5bc6\u9375.key\nreadonly CA_CRT=#\u8a8d\u8a3c\u5c40\u8a3c\u660e\u66f8.crt\nreadonly VPN_KEY=#\u30b5\u30fc\u30d0\u30fc\u79d8\u5bc6\u9375.key\nreadonly VPN_CRT=#\u30b5\u30fc\u30d0\u30fc\u8a3c\u660e\u66f8.crt\n#\u4f5c\u696d\u5834\u3001VPN\u30b5\u30fc\u30d0\u30fc\u30c9\u30e1\u30a4\u30f3\nreadonly SRV_DOMAIN=#\u30b5\u30fc\u30d0\u30fc\u30c9\u30e1\u30a4\u30f3\nreadonly OUTPATH=./keyCrts\n\n#\u521d\u671f\u5316\nrm /etc/ipsec.d/cacerts/*\nrm /etc/ipsec.d/certs/*\nrm /etc/ipsec.d/private/*\nmkdir ./keyCrts\n\n#\u30eb\u30fc\u30c8\u8a3c\u660e\u66f8\u4f5c\u6210\ncakey=${OUTPATH}/${CA_KEY}\ncacrt=${OUTPATH}/${CA_CRT}\nipsec pki --gen > $cakey\nipsec pki --self --in $cakey --ca --dn \"C=JP, O=strongSwan, CN=strongSwanVPN CA\" > $cacrt\n\ncp $cakey /etc/ipsec.d/private/\ncp $cacrt /etc/ipsec.d/cacerts/\nchmod 600 /etc/ipsec.d/private/$CA_KEY\nchmod 600 /etc/ipsec.d/cacerts/$CA_CRT\nchown root:root /etc/ipsec.d/private/$CA_KEY\nchown root:root /etc/ipsec.d/cacerts/$CA_CRT\n\n#\u30b5\u30fc\u30d0\u30fc\u8a3c\u660e\u66f8\u4f5c\u6210\n# \u7f72\u540d\u306b\u3072\u306d\u308a\u304c\u3042\u308b\u305f\u3081\u6ce8\u610f\u3002\n# \u53c2\u8003\u8cc7\u6599:\n# 1). https://wiki.strongswan.org/projects/strongswan/wiki/Win7CertReq\nsrvkey=${OUTPATH}/${VPN_KEY}\nsrvcrt=${OUTPATH}/${VPN_CRT}\nipsec pki --gen > $srvkey\nipsec pki --pub --in $srvkey | \\\n\tipsec pki \\\n\t--issue --cacert $cacrt --cakey $cakey --san $SRV_DOMAIN \\\n\t--flag serverAuth --dn \"C=JP, O=strongSwan, CN=${SRV_DOMAIN}\" > $srvcrt\n\ncp $srvkey /etc/ipsec.d/private/\ncp $srvcrt /etc/ipsec.d/certs/\nchmod 600 /etc/ipsec.d/private/$VPN_KEY\nchmod 600 /etc/ipsec.d/certs/$VPN_CRT\nchown root:root /etc/ipsec.d/private/$VPN_KEY\nchown root:root /etc/ipsec.d/certs/$VPN_CRT\n```\n\n### \u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u7de8\u96c6\n```bash:/etc/ipsec.conf\n# IPSec IKEv2\nconn EAP-MSCHAPv2\n   leftsubnet=0.0.0.0/0\n   auto=add\n   # \u7701\u7565\u53ef(default: pubkey)\u3002\u8a8d\u8a3c\u65b9\u5f0f\u3002\u30b5\u30fc\u30d0\u30fc\u5074\u306f\u516c\u958b\u9375\u8a8d\u8a3c\u3002\n   leftauth=pubkey\n   # \u5fc5\u9808\u3002\u8a3c\u660e\u66f8\u3002\n   leftcert=#\u30b5\u30fc\u30d0\u30fc\u8a3c\u660e\u66f8.crt\n   # \u5fc5\u9808\u3002\u8a8d\u8a3c\u65b9\u5f0f\u3002\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u306fEAP-MSCHAPv2\u8a8d\u8a3c\u3002\n   rightauth=eap-mschapv2\n   # \u5fc5\u9808\u3002VPN\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u3078\u632f\u308bIP\u30a2\u30c9\u30ec\u30b9\u306e\u7bc4\u56f2\u3002IKEv2\u8a8d\u8a3c\u3092\u4f7f\u7528\u3059\u308b\u969b\u306b\u306f\u5fc5\u8981\u3002\n   # \u30b5\u30fc\u30d0\u30fc\u306e\u6240\u5c5e\u30cd\u30c3\u30c8\u3068\u306f\u7570\u306a\u308b\u30a2\u30c9\u30ec\u30b9\u306b\u3059\u308b\u3002\n   rightsourceip=192.168.x.0/24\n   # \u5fc5\u9808\u3002Windows\u5bfe\u5fdc\u306b\u5fc5\u8981\u3002Android\u3067\u306f\u4e0d\u8981\n   eap_identity=%any\n```\n\n### \u8a8d\u8a3c\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u7de8\u96c6\n```bash:/etc/ipsec.secrets\n# \u30b5\u30fc\u30d0\u30fc\u79d8\u5bc6\u9375\u3001\u30e6\u30fc\u30b6\u30fc\u540d\u3001\u30d1\u30b9\u30ef\u30fc\u30c9\u90e8\u5206\u3092\n# \u57cb\u3081\u305f\u3082\u306e\u3092ipsec.secrets\u3078\u8ffd\u8a18\u3059\u308b\u3002\n\n%any : RSA KeyAAA #\u30b5\u30fc\u30d0\u30fc\u79d8\u5bc6\u9375.key\nUserNameBBB : EAP \"PasswordCCC\" #\u30e6\u30fc\u30b6\u30fc\u540d & \u30d1\u30b9\u30ef\u30fc\u30c9\n```\n\n### sysctl \u306e\u7de8\u96c6\n```bash:/etc/sysctl.conf\n#\u30b5\u30fc\u30d0\u30fc\u304cVPN\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u3068\u5185\u90e8\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u3092\u7e4b\u3050\u30eb\u30fc\u30bf\u30fc\n#\u3068\u3057\u3066\u6a5f\u80fd\u3067\u304d\u308b\u3088\u3046\u4ee5\u4e0b\u306e\u8a2d\u5b9a\u3092sysctl.conf\u3078\u8ffd\u8a18\u3059\u308b\u3002\nnet.ipv4.ip_forward=1\n```\n\n### \u305d\u306e\u4ed6\u306e\u4f5c\u696d\n\n* **\u4f5c\u6210\u3057\u305f\u30eb\u30fc\u30c8\u8a3c\u660e\u66f8\u3092\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u3078\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb**  \n* **\u30eb\u30fc\u30bf\u30fc\u3092\u8a2d\u5b9a\u5909\u66f4**  \n  VPN\u30b5\u30fc\u30d0\u30fc\u306e\u6240\u5c5e\u30cd\u30c3\u30c8\u306e\u30eb\u30fc\u30bf\u30fc\u306b\u306fVPN\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u3078\u632f\u3089\u308c\u308bVirtualIP\u306e\u7d4c\u8def\u8a2d\u5b9a\u3092\u884c\u3046\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002  \n  192.168.x.0/24 \u2192 192.168.x.x\n\n## 2.3.\u30cf\u30de\u308a\u3069\u3053\u308d\n* **MTU: \u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u306eMTU\u3092\u30ec\u30b8\u30b9\u30c8\u30ea\u3067\u5909\u66f4\u3059\u308b\u5fc5\u8981\u304c\u751f\u3058\u308b\u3053\u3068\u304c\u3042\u308a\u307e\u3059\u3002**  \n  Android ([strongSwan VPN Client](https://play.google.com/store/apps/details?id=org.strongswan.android&hl=ja)\\): \u30aa\u30d7\u30b7\u30e7\u30f3\u304b\u3089\u5909\u66f4\u53ef\u80fd\u3002  \n  Windows: [Tech TIPS\uff1a\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306eMTU\u30b5\u30a4\u30ba\u3092\u5909\u66f4\u3059\u308b](http://www.atmarkit.co.jp/ait/articles/0610/07/news019.html)\n\n# 3.\u611f\u60f3\nstrongSwan\u3068IKEv2\u306e\u611f\u60f3\u306f\u4ee5\u4e0b\u306e\u901a\u308a\u3002\n\n* **\u826f\u304b\u3063\u305f\u70b9**\n    * \u5358\u4f53\u3067VPN\u3092\u69cb\u7bc9\u3067\u304d\u308b\u305f\u3081\u306b\u30b7\u30f3\u30d7\u30eb\u3067\u8a2d\u5b9a\u3057\u3084\u3059\u3044\u3002(strongSwan IKEv2)\n    * \u4ed6\u306e\u30bd\u30d5\u30c8\u3068\u6bd4\u8f03\u3057\u3066apt-get\u304b\u3089\u5165\u308c\u3089\u308c\u308b\u305f\u3081\u3001\u66f4\u65b0\u304c\u697d\u3002(strongSwan)\n    * L2TP/IPSec\u3088\u308a[\u65e9\u3044\u3089\u3057\u3044](https://www.bestvpn.com/blog/4147/pptp-vs-l2tp-vs-openvpn-vs-sstp-vs-ikev2/)\u3002(\u901f\u5ea6\u6e2c\u5b9a\u3057\u3066\u307f\u307e\u3057\u305f\u304c\u5fae\u5999...(IKEv2)\n* **\u60aa\u304b\u3063\u305f\u70b9**\n    * MTU\u8abf\u6574\u3092\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u5074\u3067\u884c\u308f\u306a\u3051\u308c\u3070\u306a\u3089\u306a\u3044\u3002(IKEv2)\n    * \u8272\u3005\u62d8\u3089\u306a\u3051\u308c\u3070SoftEther VPN\u306f\u697d\u3067\u3088\u304b\u3063\u305f...(strongSwan)\n\n# \u53c2\u8003\u8cc7\u6599\n* \u300cWindows 7 and newer\u300d  \n  https://wiki.strongswan.org/projects/strongswan/wiki/Windows7  \n* \u300cSetting-up a Simple CA Using the strongSwan PKI Tool\u300d  \n  https://wiki.strongswan.org/projects/1/wiki/SimpleCA\n* \u300cRequirements for certificates used with Windows 7\u300d  \n  https://wiki.strongswan.org/projects/strongswan/wiki/Win7CertReq\n", "tags": ["Ubuntu", "VPN", "ipsec"]}