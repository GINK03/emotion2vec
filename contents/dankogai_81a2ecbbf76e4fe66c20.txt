{"context": "\u52c7\u8005\u304c\u3044\u306a\u3044\u306a\u3089\u3001\u81ea\u5206\u304c\u52c7\u8005\u306b\u306a\u308c\u3070\u3044\u3044\u306e\u306b\u3002\n\u524d\u56de\u8a18\u4e8b\n\n\u52c7\u8005\u306f\u305c\u3072\u4e0a\u8a18\u306b macOS \u3068 illumos \u3082\u52a0\u3048\u305f\u30af\u30a2\u30c3\u30c9\u30d6\u30fc\u30c8\u30c7\u30a3\u30b9\u30af\u3092\u3053\u3055\u3048\u3066\u307f\u3066\u304f\u3060\u3055\u3044\u3002\n\n\u3068\u3044\u3046\u308f\u3051\u3067\u3084\u308a\u307e\u3057\u305f\u3002 illumos \u306f\u5f8c\u8ff0\u306e\u7406\u7531\u3067\u306a\u3044\u3051\u3069\u30af\u30ef\u30c3\u30c9\u3069\u3053\u308d\u304b\u30aa\u30af\u30bf\u30d6\u30fc\u30c8\u3067\u3059\u3002\u305d\u308c\u3082\u30d9\u30a2\u30e1\u30bf\u30eb\u3067\u3002\n\nMacBook Air (13-inch, Late 2010)\u30026\u5e74\u4ee5\u4e0a\u524d\u306e\u30ce\u30fc\u30c8\u30d6\u30c3\u30af\u306e\u672a\u6765\u3001\u304b\u3064\u3066\u79c1\u306e\u30e1\u30a4\u30f3\u30ce\u30fc\u30c8\u3067\u3001\u305d\u306e\u5f8c\u9577\u5973\u306e\u30e1\u30a4\u30f3\u30ce\u30fc\u30c8\u3002\u3060\u304b\u3089\u88cf\u84cb\u306f\u3053\u3093\u306a\u3002\n\n\u305d\u306e\u9577\u5973\u306e\u30e1\u30a4\u30f3\u30ce\u30fc\u30c8\u3082\u3001\u79c1\u3068\u540c\u3058 MacBook Pro (Retina, 13-inch, Mid 2014) \u306b\u5909\u308f\u3063\u3066\u4ee5\u6765\u3001\u3057\u3070\u3089\u304f\u304a\u8535\u5165\u308a\u3057\u3066\u3044\u305f\u306e\u3092\u5f15\u3063\u5f35\u308a\u51fa\u3057\u3066\u6765\u307e\u3057\u305f\u3002\nUSB3\u306f\u304a\u308d\u304b\u3001Thunderbolt\u3082\u306a\u3044\u3001CPU\u30d1\u30ef\u30fc\u306f\u4eca\u65e5\u65e5\u306eiPhone\u306b\u8ca0\u3051\u3066\u3057\u307e\u3046\u30ed\u30fc\u30c8\u30eb\u3067\u3059\u304c\u3001 Sierra \u3082 Windows 10 \u3082\u52d5\u304d\u307e\u3059\u3002\u3082\u3061\u308d\u3093 Ubuntu \u3060\u3063\u3066 FreeBSD \u3060\u3063\u3066\u3002\n\u3068\u3044\u3046\u308f\u3051\u3067\u3053\u306e\u5b50\u306f\n\n\u3075\u3064\u3046\u306e HFS+ \u4e0a\u306e macOS Sierra\n\u3075\u3064\u3046\u306e macOS Recovery1\n\n\u3075\u3064\u3046\u306e Boot Camp \u306a Windows 102\n\nZFS\u4e0a\u306e macOS Sierra\nZFS\u4e0a\u306e Ubuntu 16.04\nZFS\u4e0a\u306e Ubuntu 16.10\nZFS\u4e0a\u306e FreeBSD 11.0-RELEASE\nZFS\u4e0a\u306e FreeBSD 12-CURRENT\n\n\u3068\u3044\u30468\u7a2e\u985e\u306e\u30d6\u30fc\u30c8\u3092\u73fe\u5728\u30b5\u30dd\u30fc\u30c8\u3057\u3066\u3044\u307e\u3059\u3002\n\u5b9f\u306f1\u304b\u30893\u307e\u3067\u306f\u3001\u3075\u3064\u3046\u306bBoot Camp\u5316\u3057\u305fMac\u3068\u5909\u308f\u3089\u305a\u3001OS X\u6539\u3081macOS\u3082Windows\u3082\u305d\u306e\u307e\u307e\u30a2\u30c3\u30d7\u30b0\u30ec\u30fc\u30c9\u3057\u7d9a\u3051\u3066\u73fe\u5728\u306b\u81f3\u3063\u3066\u3044\u307e\u3059\u3002\u3064\u307e\u308a\u3001\u5143\u3005\u3042\u3063\u305f\u3082\u306e\u306f\u4f55\u3082\u5931\u308f\u308c\u3066\u3044\u306a\u3044\u306e\u3067\u3059\u3002\u3055\u3059\u304c\u306b\u9577\u5973\u304b\u3089\u623b\u3063\u3066\u6765\u305f\u3068\u304d\u306b\u30a2\u30ab\u30a6\u30f3\u30c8\u3068\u30e6\u30fc\u30b6\u30fc\u306f\u4f5c\u308a\u76f4\u3057\u3066\u3044\u307e\u3059\u304c\u3002\n\n\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30f3\u69cb\u6210\n\u3057\u304b\u3057\u3053\u306e\u5b50\u306b\u306f\u3001\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30f3\u306fEFI\u3092\u542b\u3081\u3066\u30826\u3064\u3057\u304b\u3042\u308a\u307e\u305b\u3093\u3002\n\nmacOS: diskutil list\n\n/dev/disk0 (internal, physical):\n   #:                       TYPE NAME                    SIZE       IDENTIFIER\n   0:      GUID_partition_scheme                        *251.0 GB   disk0\n   1:                        EFI EFI                     209.7 MB   disk0s1\n   2:                  Apple_HFS root@dan-mba32          64.0 GB    disk0s2\n   3:                 Apple_Boot Recovery HD             650.0 MB   disk0s3\n   4:       Microsoft Basic Data BOOTCAMP                64.0 GB    disk0s4\n   5: 516E7CBA-6ECF-11D6-8FF8-00022D09712B               121.3 GB   disk0s5\n   6:                 Apple_Boot boot                    650.0 MB   disk0s6\n\n/dev/disk1 (external, virtual):\n   #:                       TYPE NAME                    SIZE       IDENTIFIER\n   0:                            Sierra                 +549.8 GB   disk1\n\n\nWindows: diskpart\n\nDISKPART> list partition\n\n  Partition ###  Type              Size     Offset\n  -------------  ----------------  -------  -------\n  Partition 1    Primary            200 MB    512 B\n  Partition 2    Primary             59 GB   200 MB\n  Partition 3    Primary            619 MB    59 GB\n  Partition 4    Primary             59 GB    60 GB\n\n\nLinux: fdisk -l\n\nDevice         Start       End   Sectors   Size Type\n/dev/sda1         40    409639    409600   200M EFI System\n/dev/sda2     409640 125409639 125000000  59.6G Apple HFS/HFS+\n/dev/sda3  125409640 126679175   1269536 619.9M Apple boot\n/dev/sda4  126679176 251679175 125000000  59.6G Microsoft basic data\n/dev/sda5  251679176 488657351 236978176   113G FreeBSD ZFS\n/dev/sda6  488657352 489926887   1269536 619.9M Apple boot\n\n\nFreeBSD: gpart show\n\n=>       34  490234685  diskid/DISK-906A52MPK0YK  GPT  (234G)\n         34          6                            - free -  (3.0K)\n         40     409600                         1  efi  (200M)\n     409640  125000000                         2  apple-hfs  (60G)\n  125409640    1269536                         3  apple-boot  (620M)\n  126679176  125000000                         4  ms-basic-data  (60G)\n  251679176  236978176                         5  freebsd-zfs  (113G)\n  488657352    1269536                         6  apple-boot  (620M)\n  489926888     307831                            - free -  (150M)\n\n\u305d\u3057\u30668\u3064\u3042\u308b\u30d6\u30fc\u30c8\u74b0\u5883(boot environment)\u306e\u3046\u30615\u3064\u306f\u3001ZFS\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30f3\u306e\u4e2d\u306b\u5b58\u5728\u3057\u307e\u3059\u3002\n\nzfs list\n\nNAME                    USED  AVAIL  REFER  MOUNTPOINT\nrpool                  30.4G  78.1G    88K  none\nrpool/ROOT             30.3G  78.1G    88K  none\nrpool/ROOT/Sierra      11.3G  78.1G  10.6G  /\nrpool/ROOT/freebsd11r  3.39G  78.1G  3.31G  /\nrpool/ROOT/freebsd12c  9.43G  78.1G  8.76G  /\nrpool/ROOT/xenial      2.76G  78.1G  2.41G  /\nrpool/ROOT/yakkety     3.42G  78.1G  3.69G  /\nrpool/Users             352K  78.1G    88K  /Users\nrpool/Users/Shared       88K  78.1G    88K  /Users/Shared\nrpool/Users/dankogai     88K  78.1G    88K  /Users/dankogai\nrpool/home             36.0M  78.1G   332K  /home\nrpool/home/dankogai    32.2M  78.1G  24.6M  /home/dankogai\nrpool/home/root         876K  78.1G   608K  /root\nrpool/tmp                88K  78.1G    88K  /tmp\nrpool/usr               464K  78.1G    88K  /usr\nrpool/usr/local          88K  78.1G    88K  /usr/local\nrpool/usr/obj            96K  78.1G    96K  /usr/obj\nrpool/usr/ports          96K  78.1G    96K  /usr/ports\nrpool/usr/src            96K  78.1G    96K  /usr/src\nrpool/var                88K  78.1G    88K  /var\n\n\nzfs get -t filesystem canmount\n\nNAME                   PROPERTY  VALUE     SOURCE\nrpool                  canmount  off       local\nrpool/ROOT             canmount  off       local\nrpool/ROOT/Sierra      canmount  noauto    local\nrpool/ROOT/freebsd11r  canmount  noauto    local\nrpool/ROOT/freebsd12c  canmount  noauto    local\nrpool/ROOT/xenial      canmount  noauto    local\nrpool/ROOT/yakkety     canmount  noauto    local\nrpool/Users            canmount  off       local\nrpool/Users/Shared     canmount  off       local\nrpool/Users/dankogai   canmount  off       local\nrpool/home             canmount  on        default\nrpool/home/dankogai    canmount  on        default\nrpool/home/root        canmount  on        default\nrpool/tmp              canmount  off       local\nrpool/usr              canmount  off       local\nrpool/usr/local        canmount  off       local\nrpool/usr/obj          canmount  off       local\nrpool/usr/ports        canmount  off       local\nrpool/usr/src          canmount  off       local\nrpool/var              canmount  off       local\n\n\u5b9f\u306e\u3068\u3053\u308d\u3001UEFI\u3068ZFS root\u3092\u30b5\u30dd\u30fc\u30c8\u3057\u305fOS\u3067\u3042\u308c\u3070\u3001rpool\u306b\u3044\u304f\u3089\u3067\u3082\u8db3\u3057\u3066\u884c\u3051\u307e\u3059\u3002\u4eca\u56deillumos\u3092\u898b\u9001\u3063\u305f\u306e\u306f\u3001\u6b8b\u5ff5\u306a\u304c\u3089\u73fe\u72b6\u3067\u306fUEFI\u304c\u30b5\u30dd\u30fc\u30c8\u3055\u308c\u3066\u3044\u306a\u3044\u304b\u3089\u3002\nhttps://wiki.illumos.org/display/illumos/Architecture\n\nCurrently not ported as Illumos kernel does not support UEFI. The UEFI boot will read efi boot program from EFI System partition (fat file system), and efi boot program will load the loader.\n\nBIOS\u65b9\u5f0f\u3060\u3068\u3001\u4f7f\u3048\u308b\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30f3\u306fBoot Camp\u307e\u3067\u3067\u98df\u3044\u6f70\u3055\u308c\u3061\u3083\u3063\u3066\u308b\u308f\u3051\u3067\u3059\u3002\n\n\u30ec\u30b7\u30d4\n\u3056\u3063\u304f\u308a\u3053\u3093\u306a\u611f\u3058\u3067\u3002\n\nHFS+\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30f3\u306e\u7e2e\u5c0f\n\u3075\u3064\u3046\u306b Disk Utility \u3067\u3067\u304d\u307e\u3059\u3002\u30dc\u30ea\u30e5\u30fc\u30e0\u306e\u30e9\u30a4\u30d6\u7e2e\u5c0f\u306f\u3001HFS+\u3084NTFS\u306b\u3042\u3063\u3066ZFS\u306b\u306a\u3044\u6570\u5c11\u306a\u3044\u6a5f\u80fd\u3067\u3059\u306d\u3002APFS\u306f\u3069\u3046\u306a\u3093\u3060\u308d\u3046\u2026\n\nWindows\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30f3\u306e\u5f15\u8d8a\u3057\ndd\u3068gparted3\u3092\u99c6\u4f7f\u3057\u3066\u3082\u51fa\u6765\u308b\u306e\u3067\u3059\u304c\u3001\u79c1\u306f\u305f\u307e\u305f\u307e\u6614\u8cb7\u3063\u305fWinclone\u3092\u4f7f\u3044\u307e\u3057\u305f\u3002\u3053\u308c\u3060\u3068 Bootcamp Partition \u3092\u5727\u7e2e\u3057\u3066\u4fdd\u7ba1\u3057\u3066\u304f\u308c\u308b\u306e\u3067\u305a\u3044\u3076\u3093\u3068\u697d\u3067\u3059\u3002\u4f59\u8ac7\u3067\u3059\u304c\u3001Windows 10\u304b\u3089\u3084\u3063\u3068\u30e9\u30a4\u30bb\u30f3\u30b9\u306e\u7d10\u4ed8\u3051\u304c\u30cf\u30fc\u30c9\u30a6\u30a7\u30a2\u5358\u4f4d\u304b\u3089\u30e6\u30fc\u30b6\u30fc\u5358\u4f4d\u306b\u306a\u3063\u305f\u3088\u3046\u306a\u306e\u3067\u3001(DSP\u7248\u3068\u304b\u3067\u306a\u3051\u308c\u3070)\u3053\u306e\u65b9\u6cd5\u3067\u5225\u7a2e\u306eMac\u306b\u3082Boot Camp\u3092\u5f15\u3063\u8d8a\u305b\u308b\u304b\u3082\u3057\u308c\u307e\u305b\u30934\u3002\n\nZFS\u30d7\u30fc\u30eb\u304a\u3088\u3073macOS on ZFS root\u7528\u306e\u30d6\u30fc\u30c8\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30f3\u306e\u6e96\u5099\n\u57fa\u672c\u7684\u306bo3x\u306eWiki\u30da\u30fc\u30b8ZFS on Boot\u306e\u901a\u308a\u3067\u3059\u3002ZFS on Boot\u3068\u306f\u3044\u3063\u3066\u3082\u3001\u53b3\u5bc6\u306b\u306fZFS on Root\u307e\u3067\u3067\u3001\u30ab\u30fc\u30cd\u30eb\u306fHFS+\u306a\u30d6\u30fc\u30c8\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30f3\u304b\u3089\u8aad\u307f\u307e\u3059\u3002\u79c1\u306e\u5834\u5408\u3001macOS Recovery\u3068\u5168\u304f\u540c\u3058\u30b5\u30a4\u30ba\u306e\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30f3\u3092\u4f5c\u308a\u307e\u3057\u305f\u3002\u305d\u3057\u3066\u6b8b\u3063\u305f\u90e8\u5206\u3092\u3059\u3079\u3066ZFS\u7528\u306b\u3002\n\nmacOS on ZFS root\u74b0\u5883\u69cb\u7bc9\n\n\u3053\u308c\u307e\u305f\u307b\u307cZFS on Boot\u306e\u901a\u308a\u306a\u306e\u3067\u3059\u304c\u3001\u76f8\u9055\u70b9\u3082\u3044\u304f\u3064\u304b\u3002\n\n\nrpool\u4f5c\u6210\u6642\u306b\u3001-O casesensitivity=insensitive\u306f\u3064\u3051\u306a\u3044\u3002\u4ed6\u306eOS\u3068\u306e\u5171\u5b58\u3067\u554f\u984c\u306b\u306a\u308b\u306e\u3067\u3002\u4e00\u65b9-O normalization=formD\u306fmacOS\u306e\u305f\u3081\u306b\u5fc5\u9808\u3002\u30d5\u30a1\u30a4\u30eb\u30cd\u30fc\u30e0\u7684\u306b\u306fHFSX\u3068\u307b\u307c\u540c\u7b49\u3002\nZFS\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u306f\u3001o3x 1.6.1\u304c\u3042\u308c\u3070\u30d3\u30eb\u30c9\u4e0d\u8981\n\nmount_zfs\u30b3\u30de\u30f3\u30c9\u3092/Library/Filesystems/zfs.fs/Contents/Resources\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u5185\u306b\u7528\u610f\u3057\u3066\u304a\u304b\u306a\u3044\u3068root\u30de\u30a6\u30f3\u30c8\u306b\u5931\u6557\u3059\u308b\u3002\u74b0\u5883\u69cb\u7bc9\u6642\u306b/Volumes/Sierra\u306bmacOS on ZFS root\u304c\u30de\u30a6\u30f3\u30c8\u3057\u3066\u3042\u308b\u3068\u3057\u3066\n\n$ cd /Volumes/Sierra/Library/Filesystems/zfs.fs\n$ sudo cp -a /usr/local/bin/mount_zfs ./Contents/Resources\n$ sudo ln -s ./Contents/Resources/mount_zfs .\n\n\u3068\u3057\u3066\u4fee\u6b63\u3002\n\n\u6b8b\u308a\u306eOS\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\u3042\u3068\u306f\u3061\u3087\u308d\u3044\u3082\u306e\u3067\u3059\u3002OS\u306f\u300c\u30a4\u30f3\u30b9\u30fc\u30c8\u30eb\u300d\u305b\u305a\u3001\u3059\u3067\u306b\u51fa\u6765\u4e0a\u304c\u3063\u3066\u3044\u308b\u74b0\u5883(\u4eee\u60f3\u30de\u30b7\u30f3\u3067\u3082USB\u30e1\u30e2\u30ea\u30fc\u3067\u3082OK)\u3092zfs send\u3057\u3066rpool/ROOT\u4ee5\u4e0b\u306breceive\u3059\u308c\u3070\u3044\u3044\u306e\u3067\u3059\u304b\u3089\u3002\n\u3084\u3084\u96e3\u3057\u3044\u306e\u306f\u30d6\u30fc\u30c8\u30ed\u30fc\u30c0\u30fc\u306e\u69cb\u7bc9\u306a\u306e\u3067\u3059\u304c\u3001UEFI\u3068rEFInd\u304a\u304b\u3052\u3067\u5c11\u3057\u697d\u3067\u3059\u3002\u57fa\u672c\u7684\u306bEFI\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30f3\u306e\u4e2d\u306b\u30d6\u30fc\u30c8\u30ed\u30fc\u30c0\u30fc\u653e\u308a\u8fbc\u3080\u3060\u3051\u3067OK\u306a\u306e\u3067\u3002\n\nFreeBSD\n# mkdir /boot/efi\n# mount -t msdosfs /dev/ada0p1 /boot/efi\n# mkdir -p /boot/efi/EFI/freebsd\n# cp -a /boot/boot1.efi /boot/efi/EFI/freebsd\n\n\u3066\u306a\u611f\u3058\u3067\u3044\u3051\u307e\u3059\u3002\u306a\u304a\u3001\u30d0\u30fc\u30b8\u30e7\u30f3\u9055\u3044\u306eFreeBSD\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\u969b\u306b\u306f\n# pkg install beadm\n# beadm create freebsd12c\n# beadm activate freebsd12c\n\n\u306a\u3069\u3068\u3057\u3066Boot Environment\u3092clone\u3057\u3066\u304b\u3089\u518d\u8d77\u52d5\u3057\u3066\u304b\u3089\u30a2\u30c3\u30d7\u30b0\u30ec\u30fc\u30c9\u3059\u308b\u3068\u697d\u3067\u3059\u3002\n\nUbuntu (and other Linuxen)\nUbuntu 16.04 Root on ZFS\u306eTroubleshooting\u306e\u65b9\u6cd5\u306b\u306e\u3063\u3068\u3063\u3066chroot\u3057\u305f\u5f8c\u306b\u3001grub\u3092\u518d\u69cb\u7bc9\u3059\u308c\u3070OK\u3002\u305d\u306e\u969b\u306b\n# bootid=xenial\n# grub-install --target=x86_64-efi --efi-directory=/boot/efi --bootloader-id=$bootid --recheck --no-floppy\n\n\u306a\u3069\u3068\u3057\u3066\u3001distro\u3054\u3068\u306bgrubx64.efi\u304c\u5225\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u30fc\u306b\u5165\u308b\u3088\u3046\u306b\u3057\u3066\u304a\u304f\u3068\u3001rEFInd\u3067\u5bb9\u6613\u306b\u5207\u308a\u66ff\u3048\u3089\u308c\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\nFreeBSD\u3068\u9055\u3044\u3001ZFS on Linux \u306e grub \u306f Boot Environment \u3092\u30b5\u30dd\u30fc\u30c8\u3057\u3066\u304a\u3089\u305a\u3001root dataset\u306fgrub.cfg\u306b\u6c7a\u3081\u6253\u3061\u306b\u306a\u308b\u306e\u3067\u3059\u304c\u3001rEFInd\u306e\u304a\u304b\u3052\u3067\u304b\u3048\u3063\u3066\u30e9\u30af\u304b\u3082\u3002\nFreeBSD\u540c\u69d8\u3001root dataset\u3092clone\u3057\u3066\u304b\u3089dist-upgrade\u3059\u308b\u3068\u697d\u3061\u3093\u3067\u3059\u3002\n\nCAVEAT\n\nmacOS\u3068FreeBSD\u306e\u30d6\u30fc\u30c8\u30ed\u30fc\u30c0\u30fc\u306f\u30d7\u30fc\u30eb\u306ebootfs\u30d7\u30ed\u30d1\u30c6\u30a3\u3092\u898b\u3066\u3069\u306e\u30c7\u30fc\u30bf\u30bb\u30c3\u30c8\u3092/\u306b\u30de\u30a6\u30f3\u30c8\u3059\u308b\u304b\u3092\u6c7a\u3081\u3066\u3044\u308b\u306e\u3067\u3001\u3053\u308c\u306e\u5909\u66f4\u3092\u5fd8\u308c\u3066OS\u3092\u5207\u308a\u66ff\u3048\u308b\u3068\u6ce3\u304d\u3092\u898b\u307e\u3059\u3002\u5909\u66f4\u524d\u306b\n\n# zpool set bootfs=rpool/ROOT/$nextboot rpool\n\n\u3057\u3066\u304a\u304f\u3053\u3068\u3002\n\n\u4ed6OS\u304b\u3089Linux\u306b\u5207\u308a\u66ff\u3048\u308b\u3068\u3001busybox\u306b\u843d\u3061\u307e\u3059\u3002\u3053\u308c\u306fZFS on Linux\u3067\u306f\u30d6\u30fc\u30c8\u3054\u3068\u306b\u30eb\u30fc\u30c8\u30d7\u30fc\u30eb\u3092import\u3057\u3001\u30b7\u30e3\u30c3\u30c8\u30c0\u30a6\u30f3\u3054\u3068\u306bexport\u3057\u3066\u3044\u308b\u305f\u3081\u3001\u300c\u307e\u3060export\u3055\u308c\u3066\u3044\u306a\u3044\u30d7\u30fc\u30eb\u306fimport\u3057\u307e\u305b\u3093\u3063\u300d\u3063\u3066\u306e\u304c\u7406\u7531\u306a\u306e\u3067\u3001zpool import -f -N -R / rpool\u3068\u546a\u6587\u3092\u5531\u3048\u3066\u304b\u3089ctrl-D\u3059\u308c\u3070\u304ak\u3002\n\n\nOS\u3054\u3068\u306e\u6240\u611f\n\nmacOS\nZFS\u4e0a\u3067\u3082\u7121\u554f\u984c\u3002o3x\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u30a2\u30c3\u30d7\u4ee5\u5916\u306a\u3089\u3001\u3075\u3064\u3046\u306b\u30bd\u30d5\u30c8\u30a6\u30a7\u30a2\u30a2\u30c3\u30d7\u30c7\u30fc\u30c8\u3082\u304b\u3051\u3089\u308c\u307e\u3059\u3057\u3001o3x\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u30a2\u30c3\u30d7\u306e\u5834\u5408\u306b\u3082\u3001HFS+\u5074\u3092\u30a2\u30c3\u30d7\u30c7\u30fc\u30c8\u3057\u3066\u304b\u3089/Library/Filesystems\u3068/usr/local\u3092rsync\u3057\u3066\u304b\u3089boot\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30f3\u3092\u518d\u69cb\u7bc9\u3059\u308c\u3070\u3044\u3051\u308b\u306f\u305a\u3002\n\nWindows\nUEFI\u6642\u4ee3\u524d\u306eWindows 7\u6642\u4ee3\u306eBoot Camp\u3060\u3051\u3042\u3063\u3066\u3001BIOS\u30e2\u30fc\u30c9\u3067\u30d6\u30fc\u30c8\u3057\u3066\u3044\u308b\u306e\u3067\u3059\u304c\u3001\u305d\u306e\u70b9\u3092\u9664\u3051\u3070\u3075\u3064\u3046\u306b\u4f7f\u3048\u307e\u3059\u3002Windows 10\u306e\u300c\u30e1\u30a4\u30b8\u30e3\u30fc\u30a2\u30c3\u30d7\u30c7\u30fc\u30c8\u300d(\u4f8b\u3048\u3070Anniversary Edition\u3068\u304b)\u306e\u969b\u306b\u30c8\u30e9\u30c3\u30af\u30d1\u30c3\u30c9\u3092\u898b\u5931\u3046\u306e\u3067\u3059\u304c\u3001\u3053\u306e\u5834\u5408\u306fDevice Manager\u3067\u518d\u8a2d\u5b9a\u3057\u3066\u3084\u308c\u3070\u5143\u3069\u304a\u308a\u306b\u306a\u308a\u307e\u3059\u3002\ncf. http://www.msitgeek.com/fixing-windows-8-trackpad-driver-in-bootcamp/\n\nUbuntu\n\u3055\u3059\u304c\u306b\u67af\u308c\u305f\u30de\u30b7\u30f3\u3060\u3051\u3042\u3063\u3066\u3001wifi\u542b\u3081\u554f\u984c\u306a\u3057\u3002\u552f\u4e00\u306e\u554f\u984c\u306f\u30b5\u30b9\u30da\u30f3\u30c9\u6642\u306b\u30c7\u30a3\u30b9\u30d7\u30ec\u30a4\u304c\u623b\u3089\u306a\u3044\u3053\u3068\u3067\u3059\u304c\u3001\u3053\u308c\u3082/etc/pm/config.d/defaults\u306b\nADD_PARAMETERS=\"--quirk-reset-brightness\"\nDROP_PARAMETERS=\"--quirks-none\"\n\n\u3092\u8ffd\u8a18\u3059\u308b\u3060\u3051\u3067OK\u3002\u3053\u3061\u3089\u3092\u30e1\u30a4\u30f3\u306b\u4f7f\u3044\u305f\u3044\u4eba\u3082\u7d50\u69cb\u3044\u308b\u306e\u3067\u306f\u3002\u3067\u3082\u30ad\u30fc\u30dc\u30fc\u30c9\u53e9\u3044\u3066\u308b\u6642\u306b\u30c8\u30e9\u30c3\u30af\u30d1\u30c3\u30c9\u304d\u3061\u3093\u3068\u7121\u8996\u3057\u3066\u304f\u308c\u306a\u3044\u2026\n\nFreeBSD\n\u5185\u81d3wifi\u306f\u30c0\u30e1\u3067\u3059\u304c\u3001\u3042\u3068\u306f\u307e\u3042\u307e\u3042\u52d5\u304d\u307e\u3059\u3002\u4e00\u5fdcwsp\u30c9\u30e9\u30a4\u30d0\u30fc\u306e\u304a\u304b\u3052\u3067\u30de\u30eb\u30c1\u30bf\u30c3\u30c1\u3082\u3044\u3051\u308b\u306f\u3044\u3051\u308b\u306e\u3067\u3059\u304c\u3001Ubuntu\u307b\u3069\u81ea\u7136\u3067\u306f\u306a\u3044\u3067\u3059\u3002USB Ethernet\u306fAX88178A/AX88179\u3092\u4f7f\u3063\u3066\u308b\u3082\u306e\u3067\u3042\u308c\u3070axge\u30c9\u30e9\u30a4\u30d0\u30fc\u3067\u52d5\u304d\u307e\u3059\u3002\u79c1\u306e\u5834\u5408LUA4-U3-AGT\u3092\u4f7f\u3063\u3066\u307e\u3059\u3002/etc/rc.conf\u306b\nifconfig_ue0=\"DHCP\"\n\n\u3068\u3057\u3066\u304b\u3089\u518d\u8d77\u52d5\u3059\u308b\u306a\u308aservice netif restart\u3059\u308b\u306a\u308a\u3059\u308c\u3070OK\u3002\nmacOS\u3067\u3082Windows 10\u3067\u3082\u4f7f\u3048\u307e\u3059\u3057\u3001\u7d14\u6b63\u306eThunderbolt Ethernet Adapter\u3068\u9055\u3063\u3066Mac\u4ee5\u5916\u3067\u3082\u629c\u304d\u5dee\u3057OK\u3067\u3057\u304b\u3082\u5b89\u4fa1(\u3044\u305a\u308c\u30822000\u5186\u5f31)\u306a\u306e\u3067\u3001\u4e00\u3064\u7528\u610f\u3057\u3066\u304a\u304f\u3068\u3044\u3056\u3068\u3044\u3046\u6642\u300c\u3053\u3093\u306a\u3053\u3068\u3082\u3042\u308d\u3046\u304b\u3068\u300d\u3067\u304d\u307e\u3059\u3002\n\n\u3055\u3044\u3054\u306b\n\u4eee\u60f3\u30de\u30b7\u30f3\u304c\u6563\u6b69\u3060\u3068\u3059\u308b\u3068\u30d9\u30a2\u30e1\u30bf\u30eb\u306f\u767b\u5c71\u3068\u3044\u3046\u611f\u3058\u3067\u3059\u304c\u3001\u3053\u308c\u304f\u3089\u3044\u306a\u3089\u9ad8\u5c3e\u5c71\u3050\u3089\u3044\u304b\u306a\u3002\u5927\u6614\u306eOS\u3054\u3068\u306b\u5b9f\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30f3\u3092\u5207\u308b\u30de\u30eb\u30c1\u30d6\u30fc\u30c8\u3068\u6bd4\u3079\u305f\u3089\u3001ZFS\u306e\u30de\u30eb\u30c1\u30d6\u30fc\u30c8\u306f\u307b\u3093\u3068\u30e9\u30af\u3002\n\u4eee\u60f3\u30de\u30b7\u30f3\u3068\u30b3\u30f3\u30c6\u30ca\u306b\u6163\u308c\u304d\u3063\u305f\u307f\u306a\u3055\u3093\u3082\u3001\u305f\u307e\u306b\u306f\u30d9\u30a2\u30e1\u30bf\u30eb\u3068\u622f\u308c\u307e\u3057\u3087\u3046\u3002\nDan the Unofficial ZFS Advocate\n\n\n\n\n\u3075\u3064\u3046\u306bcmd-R\u3067\u4e0a\u304c\u308a\u307e\u3059\u00a0\u21a9\n\n\n\u53b3\u5bc6\u306b\u306fApple\u306e\u30b5\u30dd\u30fc\u30c8\u5207\u308c\u3002BIOS\u30a8\u30df\u30e5\u30ec\u30fc\u30b7\u30e7\u30f3\u306eBoot Camp\u306fWindows 10\u3092\u30b5\u30dd\u30fc\u30c8\u3057\u3066\u3044\u306a\u3044\u3053\u3068\u306b\u306a\u3063\u3066\u3044\u308b\u3002\u304c\u3075\u3064\u3046\u306bWindows 7\u3092\u30a2\u30c3\u30d7\u30b0\u30ec\u30fc\u30c9\u3059\u308c\u3070\u307b\u307c\u7121\u554f\u984c\u3002\u00a0\u21a9\n\n\nUbuntu\u306e\u30e9\u30a4\u30d6DVD/USB\u30b9\u30c6\u30a3\u30c3\u30af\u306b\u6a19\u6e96\u3067\u5165\u3063\u3066\u307e\u3059\u3002\u00a0\u21a9\n\n\ncf. http://pc.watch.impress.co.jp/docs/topic/review/1008323.html\u00a0\u21a9\n\n\n\n\u52c7\u8005\u304c\u3044\u306a\u3044\u306a\u3089\u3001\u81ea\u5206\u304c\u52c7\u8005\u306b\u306a\u308c\u3070\u3044\u3044\u306e\u306b\u3002\n\n[\u524d\u56de\u8a18\u4e8b]\n> \u52c7\u8005\u306f\u305c\u3072\u4e0a\u8a18\u306b macOS \u3068 illumos \u3082\u52a0\u3048\u305f\u30af\u30a2\u30c3\u30c9\u30d6\u30fc\u30c8\u30c7\u30a3\u30b9\u30af\u3092\u3053\u3055\u3048\u3066\u307f\u3066\u304f\u3060\u3055\u3044\u3002\n\n[\u524d\u56de\u8a18\u4e8b]: http://qiita.com/dankogai/items/fee382b14277de1f66a9\n\n\u3068\u3044\u3046\u308f\u3051\u3067\u3084\u308a\u307e\u3057\u305f\u3002 illumos \u306f\u5f8c\u8ff0\u306e\u7406\u7531\u3067\u306a\u3044\u3051\u3069\u30af\u30ef\u30c3\u30c9\u3069\u3053\u308d\u304b\u30aa\u30af\u30bf\u30d6\u30fc\u30c8\u3067\u3059\u3002\u305d\u308c\u3082\u30d9\u30a2\u30e1\u30bf\u30eb\u3067\u3002\n\n![refind.jpg](https://qiita-image-store.s3.amazonaws.com/0/19227/4807b430-5b4b-b074-f67c-669e296be19d.jpeg)\n\n[MacBook Air (13-inch, Late 2010)]\u30026\u5e74\u4ee5\u4e0a\u524d\u306e[\u30ce\u30fc\u30c8\u30d6\u30c3\u30af\u306e\u672a\u6765]\u3001\u304b\u3064\u3066\u79c1\u306e\u30e1\u30a4\u30f3\u30ce\u30fc\u30c8\u3067\u3001\u305d\u306e\u5f8c\u9577\u5973\u306e\u30e1\u30a4\u30f3\u30ce\u30fc\u30c8\u3002\u3060\u304b\u3089\u88cf\u84cb\u306f\u3053\u3093\u306a\u3002\n\n[MacBook Air (13-inch, Late 2010)]: https://support.apple.com/kb/SP618\n\n[\u30ce\u30fc\u30c8\u30d6\u30c3\u30af\u306e\u672a\u6765]: http://blog.livedoor.jp/dankogai/archives/51743116.html\n\n![macbookair3,2.jpg](https://qiita-image-store.s3.amazonaws.com/0/19227/b69b028d-64d9-c42b-56c2-0ce35df42f7c.jpeg)\n\n\u305d\u306e\u9577\u5973\u306e\u30e1\u30a4\u30f3\u30ce\u30fc\u30c8\u3082\u3001\u79c1\u3068\u540c\u3058 MacBook Pro (Retina, 13-inch, Mid 2014) \u306b\u5909\u308f\u3063\u3066\u4ee5\u6765\u3001\u3057\u3070\u3089\u304f\u304a\u8535\u5165\u308a\u3057\u3066\u3044\u305f\u306e\u3092\u5f15\u3063\u5f35\u308a\u51fa\u3057\u3066\u6765\u307e\u3057\u305f\u3002\n\nUSB3\u306f\u304a\u308d\u304b\u3001Thunderbolt\u3082\u306a\u3044\u3001CPU\u30d1\u30ef\u30fc\u306f\u4eca\u65e5\u65e5\u306eiPhone\u306b\u8ca0\u3051\u3066\u3057\u307e\u3046\u30ed\u30fc\u30c8\u30eb\u3067\u3059\u304c\u3001 Sierra \u3082 Windows 10 \u3082\u52d5\u304d\u307e\u3059\u3002\u3082\u3061\u308d\u3093 Ubuntu \u3060\u3063\u3066 FreeBSD \u3060\u3063\u3066\u3002\n\n\u3068\u3044\u3046\u308f\u3051\u3067\u3053\u306e\u5b50\u306f\n\n1. \u3075\u3064\u3046\u306e HFS+ \u4e0a\u306e macOS Sierra\n2. \u3075\u3064\u3046\u306e macOS Recovery[^1]\n3. \u3075\u3064\u3046\u306e Boot Camp \u306a Windows 10[^2]\n4. ZFS\u4e0a\u306e macOS Sierra\n5. ZFS\u4e0a\u306e Ubuntu 16.04\n6. ZFS\u4e0a\u306e Ubuntu 16.10\n7. ZFS\u4e0a\u306e FreeBSD 11.0-RELEASE\n8. ZFS\u4e0a\u306e FreeBSD 12-CURRENT\n\n\u3068\u3044\u30468\u7a2e\u985e\u306e\u30d6\u30fc\u30c8\u3092\u73fe\u5728\u30b5\u30dd\u30fc\u30c8\u3057\u3066\u3044\u307e\u3059\u3002\n\n[^1]: \u3075\u3064\u3046\u306bcmd-R\u3067\u4e0a\u304c\u308a\u307e\u3059\n[^2]: \u53b3\u5bc6\u306b\u306fApple\u306e\u30b5\u30dd\u30fc\u30c8\u5207\u308c\u3002BIOS\u30a8\u30df\u30e5\u30ec\u30fc\u30b7\u30e7\u30f3\u306eBoot Camp\u306fWindows 10\u3092\u30b5\u30dd\u30fc\u30c8\u3057\u3066\u3044\u306a\u3044\u3053\u3068\u306b\u306a\u3063\u3066\u3044\u308b\u3002\u304c\u3075\u3064\u3046\u306bWindows 7\u3092\u30a2\u30c3\u30d7\u30b0\u30ec\u30fc\u30c9\u3059\u308c\u3070\u307b\u307c\u7121\u554f\u984c\u3002\n\n\u5b9f\u306f1\u304b\u30893\u307e\u3067\u306f\u3001\u3075\u3064\u3046\u306bBoot Camp\u5316\u3057\u305fMac\u3068\u5909\u308f\u3089\u305a\u3001OS X\u6539\u3081macOS\u3082Windows\u3082\u305d\u306e\u307e\u307e\u30a2\u30c3\u30d7\u30b0\u30ec\u30fc\u30c9\u3057\u7d9a\u3051\u3066\u73fe\u5728\u306b\u81f3\u3063\u3066\u3044\u307e\u3059\u3002\u3064\u307e\u308a\u3001\u5143\u3005\u3042\u3063\u305f\u3082\u306e\u306f\u4f55\u3082\u5931\u308f\u308c\u3066\u3044\u306a\u3044\u306e\u3067\u3059\u3002\u3055\u3059\u304c\u306b\u9577\u5973\u304b\u3089\u623b\u3063\u3066\u6765\u305f\u3068\u304d\u306b\u30a2\u30ab\u30a6\u30f3\u30c8\u3068\u30e6\u30fc\u30b6\u30fc\u306f\u4f5c\u308a\u76f4\u3057\u3066\u3044\u307e\u3059\u304c\u3002\n\n## \u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30f3\u69cb\u6210\n\n\u3057\u304b\u3057\u3053\u306e\u5b50\u306b\u306f\u3001\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30f3\u306fEFI\u3092\u542b\u3081\u3066\u30826\u3064\u3057\u304b\u3042\u308a\u307e\u305b\u3093\u3002\n\n### macOS: `diskutil list`\n````\n/dev/disk0 (internal, physical):\n   #:                       TYPE NAME                    SIZE       IDENTIFIER\n   0:      GUID_partition_scheme                        *251.0 GB   disk0\n   1:                        EFI EFI                     209.7 MB   disk0s1\n   2:                  Apple_HFS root@dan-mba32          64.0 GB    disk0s2\n   3:                 Apple_Boot Recovery HD             650.0 MB   disk0s3\n   4:       Microsoft Basic Data BOOTCAMP                64.0 GB    disk0s4\n   5: 516E7CBA-6ECF-11D6-8FF8-00022D09712B               121.3 GB   disk0s5\n   6:                 Apple_Boot boot                    650.0 MB   disk0s6\n\n/dev/disk1 (external, virtual):\n   #:                       TYPE NAME                    SIZE       IDENTIFIER\n   0:                            Sierra                 +549.8 GB   disk1\n````\n### Windows: `diskpart`\n````\nDISKPART> list partition\n\n  Partition ###  Type              Size     Offset\n  -------------  ----------------  -------  -------\n  Partition 1    Primary            200 MB    512 B\n  Partition 2    Primary             59 GB   200 MB\n  Partition 3    Primary            619 MB    59 GB\n  Partition 4    Primary             59 GB    60 GB\n````\n### Linux: `fdisk -l`\n````\nDevice         Start       End   Sectors   Size Type\n/dev/sda1         40    409639    409600   200M EFI System\n/dev/sda2     409640 125409639 125000000  59.6G Apple HFS/HFS+\n/dev/sda3  125409640 126679175   1269536 619.9M Apple boot\n/dev/sda4  126679176 251679175 125000000  59.6G Microsoft basic data\n/dev/sda5  251679176 488657351 236978176   113G FreeBSD ZFS\n/dev/sda6  488657352 489926887   1269536 619.9M Apple boot\n````\n### FreeBSD: `gpart show`\n````\n=>       34  490234685  diskid/DISK-906A52MPK0YK  GPT  (234G)\n         34          6                            - free -  (3.0K)\n         40     409600                         1  efi  (200M)\n     409640  125000000                         2  apple-hfs  (60G)\n  125409640    1269536                         3  apple-boot  (620M)\n  126679176  125000000                         4  ms-basic-data  (60G)\n  251679176  236978176                         5  freebsd-zfs  (113G)\n  488657352    1269536                         6  apple-boot  (620M)\n  489926888     307831                            - free -  (150M)\n````\n\n\u305d\u3057\u30668\u3064\u3042\u308b\u30d6\u30fc\u30c8\u74b0\u5883(boot environment)\u306e\u3046\u30615\u3064\u306f\u3001ZFS\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30f3\u306e\u4e2d\u306b\u5b58\u5728\u3057\u307e\u3059\u3002\n\n### `zfs list`\n````\nNAME                    USED  AVAIL  REFER  MOUNTPOINT\nrpool                  30.4G  78.1G    88K  none\nrpool/ROOT             30.3G  78.1G    88K  none\nrpool/ROOT/Sierra      11.3G  78.1G  10.6G  /\nrpool/ROOT/freebsd11r  3.39G  78.1G  3.31G  /\nrpool/ROOT/freebsd12c  9.43G  78.1G  8.76G  /\nrpool/ROOT/xenial      2.76G  78.1G  2.41G  /\nrpool/ROOT/yakkety     3.42G  78.1G  3.69G  /\nrpool/Users             352K  78.1G    88K  /Users\nrpool/Users/Shared       88K  78.1G    88K  /Users/Shared\nrpool/Users/dankogai     88K  78.1G    88K  /Users/dankogai\nrpool/home             36.0M  78.1G   332K  /home\nrpool/home/dankogai    32.2M  78.1G  24.6M  /home/dankogai\nrpool/home/root         876K  78.1G   608K  /root\nrpool/tmp                88K  78.1G    88K  /tmp\nrpool/usr               464K  78.1G    88K  /usr\nrpool/usr/local          88K  78.1G    88K  /usr/local\nrpool/usr/obj            96K  78.1G    96K  /usr/obj\nrpool/usr/ports          96K  78.1G    96K  /usr/ports\nrpool/usr/src            96K  78.1G    96K  /usr/src\nrpool/var                88K  78.1G    88K  /var\n````\n\n### `zfs get -t filesystem canmount`\n````\nNAME                   PROPERTY  VALUE     SOURCE\nrpool                  canmount  off       local\nrpool/ROOT             canmount  off       local\nrpool/ROOT/Sierra      canmount  noauto    local\nrpool/ROOT/freebsd11r  canmount  noauto    local\nrpool/ROOT/freebsd12c  canmount  noauto    local\nrpool/ROOT/xenial      canmount  noauto    local\nrpool/ROOT/yakkety     canmount  noauto    local\nrpool/Users            canmount  off       local\nrpool/Users/Shared     canmount  off       local\nrpool/Users/dankogai   canmount  off       local\nrpool/home             canmount  on        default\nrpool/home/dankogai    canmount  on        default\nrpool/home/root        canmount  on        default\nrpool/tmp              canmount  off       local\nrpool/usr              canmount  off       local\nrpool/usr/local        canmount  off       local\nrpool/usr/obj          canmount  off       local\nrpool/usr/ports        canmount  off       local\nrpool/usr/src          canmount  off       local\nrpool/var              canmount  off       local\n````\n\n\u5b9f\u306e\u3068\u3053\u308d\u3001UEFI\u3068ZFS root\u3092\u30b5\u30dd\u30fc\u30c8\u3057\u305fOS\u3067\u3042\u308c\u3070\u3001`rpool`\u306b\u3044\u304f\u3089\u3067\u3082\u8db3\u3057\u3066\u884c\u3051\u307e\u3059\u3002\u4eca\u56deillumos\u3092\u898b\u9001\u3063\u305f\u306e\u306f\u3001\u6b8b\u5ff5\u306a\u304c\u3089\u73fe\u72b6\u3067\u306fUEFI\u304c\u30b5\u30dd\u30fc\u30c8\u3055\u308c\u3066\u3044\u306a\u3044\u304b\u3089\u3002\n\nhttps://wiki.illumos.org/display/illumos/Architecture\n> Currently not ported as Illumos kernel does not support UEFI. The UEFI boot will read efi boot program from EFI System partition (fat file system), and efi boot program will load the loader.\n\nBIOS\u65b9\u5f0f\u3060\u3068\u3001\u4f7f\u3048\u308b\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30f3\u306fBoot Camp\u307e\u3067\u3067\u98df\u3044\u6f70\u3055\u308c\u3061\u3083\u3063\u3066\u308b\u308f\u3051\u3067\u3059\u3002\n\n## \u30ec\u30b7\u30d4\n\n\u3056\u3063\u304f\u308a\u3053\u3093\u306a\u611f\u3058\u3067\u3002\n\n### HFS+\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30f3\u306e\u7e2e\u5c0f\n\n\u3075\u3064\u3046\u306b Disk Utility \u3067\u3067\u304d\u307e\u3059\u3002\u30dc\u30ea\u30e5\u30fc\u30e0\u306e\u30e9\u30a4\u30d6\u7e2e\u5c0f\u306f\u3001HFS+\u3084NTFS\u306b\u3042\u3063\u3066ZFS\u306b\u306a\u3044\u6570\u5c11\u306a\u3044\u6a5f\u80fd\u3067\u3059\u306d\u3002APFS\u306f\u3069\u3046\u306a\u3093\u3060\u308d\u3046\u2026\n\n### Windows\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30f3\u306e\u5f15\u8d8a\u3057\n\n`dd`\u3068`gparted`[^3]\u3092\u99c6\u4f7f\u3057\u3066\u3082\u51fa\u6765\u308b\u306e\u3067\u3059\u304c\u3001\u79c1\u306f\u305f\u307e\u305f\u307e\u6614\u8cb7\u3063\u305f[Winclone]\u3092\u4f7f\u3044\u307e\u3057\u305f\u3002\u3053\u308c\u3060\u3068 Bootcamp Partition \u3092\u5727\u7e2e\u3057\u3066\u4fdd\u7ba1\u3057\u3066\u304f\u308c\u308b\u306e\u3067\u305a\u3044\u3076\u3093\u3068\u697d\u3067\u3059\u3002\u4f59\u8ac7\u3067\u3059\u304c\u3001Windows 10\u304b\u3089\u3084\u3063\u3068\u30e9\u30a4\u30bb\u30f3\u30b9\u306e\u7d10\u4ed8\u3051\u304c\u30cf\u30fc\u30c9\u30a6\u30a7\u30a2\u5358\u4f4d\u304b\u3089\u30e6\u30fc\u30b6\u30fc\u5358\u4f4d\u306b\u306a\u3063\u305f\u3088\u3046\u306a\u306e\u3067\u3001(DSP\u7248\u3068\u304b\u3067\u306a\u3051\u308c\u3070)\u3053\u306e\u65b9\u6cd5\u3067\u5225\u7a2e\u306eMac\u306b\u3082Boot Camp\u3092\u5f15\u3063\u8d8a\u305b\u308b\u304b\u3082\u3057\u308c\u307e\u305b\u3093[^4]\u3002\n\n[^4]: cf. http://pc.watch.impress.co.jp/docs/topic/review/1008323.html\n\n[Winclone]: https://twocanoes.com/products/mac/winclone\n[^3]: Ubuntu\u306e\u30e9\u30a4\u30d6DVD/USB\u30b9\u30c6\u30a3\u30c3\u30af\u306b\u6a19\u6e96\u3067\u5165\u3063\u3066\u307e\u3059\u3002\n\n### ZFS\u30d7\u30fc\u30eb\u304a\u3088\u3073macOS on ZFS root\u7528\u306e\u30d6\u30fc\u30c8\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30f3\u306e\u6e96\u5099\n\n\u57fa\u672c\u7684\u306b[o3x]\u306eWiki\u30da\u30fc\u30b8[ZFS on Boot]\u306e\u901a\u308a\u3067\u3059\u3002ZFS on Boot\u3068\u306f\u3044\u3063\u3066\u3082\u3001\u53b3\u5bc6\u306b\u306fZFS on Root\u307e\u3067\u3067\u3001\u30ab\u30fc\u30cd\u30eb\u306fHFS+\u306a\u30d6\u30fc\u30c8\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30f3\u304b\u3089\u8aad\u307f\u307e\u3059\u3002\u79c1\u306e\u5834\u5408\u3001macOS Recovery\u3068\u5168\u304f\u540c\u3058\u30b5\u30a4\u30ba\u306e\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30f3\u3092\u4f5c\u308a\u307e\u3057\u305f\u3002\u305d\u3057\u3066\u6b8b\u3063\u305f\u90e8\u5206\u3092\u3059\u3079\u3066ZFS\u7528\u306b\u3002\n\n[o3x]: https://openzfsonosx.org/\n[ZFS on Boot]: https://openzfsonosx.org/wiki/ZFS_on_Boot\n\n* macOS on ZFS root\u74b0\u5883\u69cb\u7bc9\n\n\u3053\u308c\u307e\u305f\u307b\u307c[ZFS on Boot]\u306e\u901a\u308a\u306a\u306e\u3067\u3059\u304c\u3001\u76f8\u9055\u70b9\u3082\u3044\u304f\u3064\u304b\u3002\n\n* `rpool`\u4f5c\u6210\u6642\u306b\u3001`-O casesensitivity=insensitive`\u306f\u3064\u3051\u306a\u3044\u3002\u4ed6\u306eOS\u3068\u306e\u5171\u5b58\u3067\u554f\u984c\u306b\u306a\u308b\u306e\u3067\u3002\u4e00\u65b9`-O normalization=formD`\u306fmacOS\u306e\u305f\u3081\u306b\u5fc5\u9808\u3002\u30d5\u30a1\u30a4\u30eb\u30cd\u30fc\u30e0\u7684\u306b\u306fHFSX\u3068\u307b\u307c\u540c\u7b49\u3002\n* ZFS\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u306f\u3001o3x 1.6.1\u304c\u3042\u308c\u3070\u30d3\u30eb\u30c9\u4e0d\u8981\n* `mount_zfs`\u30b3\u30de\u30f3\u30c9\u3092`/Library/Filesystems/zfs.fs/Contents/Resources`\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u5185\u306b\u7528\u610f\u3057\u3066\u304a\u304b\u306a\u3044\u3068root\u30de\u30a6\u30f3\u30c8\u306b\u5931\u6557\u3059\u308b\u3002\u74b0\u5883\u69cb\u7bc9\u6642\u306b`/Volumes/Sierra`\u306bmacOS on ZFS root\u304c\u30de\u30a6\u30f3\u30c8\u3057\u3066\u3042\u308b\u3068\u3057\u3066\n\n````\n$ cd /Volumes/Sierra/Library/Filesystems/zfs.fs\n$ sudo cp -a /usr/local/bin/mount_zfs ./Contents/Resources\n$ sudo ln -s ./Contents/Resources/mount_zfs .\n````\n\n\u3068\u3057\u3066\u4fee\u6b63\u3002\n\n### \u6b8b\u308a\u306eOS\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n\u3042\u3068\u306f\u3061\u3087\u308d\u3044\u3082\u306e\u3067\u3059\u3002OS\u306f\u300c\u30a4\u30f3\u30b9\u30fc\u30c8\u30eb\u300d\u305b\u305a\u3001\u3059\u3067\u306b\u51fa\u6765\u4e0a\u304c\u3063\u3066\u3044\u308b\u74b0\u5883(\u4eee\u60f3\u30de\u30b7\u30f3\u3067\u3082USB\u30e1\u30e2\u30ea\u30fc\u3067\u3082OK)\u3092`zfs send`\u3057\u3066`rpool/ROOT`\u4ee5\u4e0b\u306breceive\u3059\u308c\u3070\u3044\u3044\u306e\u3067\u3059\u304b\u3089\u3002\n\n\u3084\u3084\u96e3\u3057\u3044\u306e\u306f\u30d6\u30fc\u30c8\u30ed\u30fc\u30c0\u30fc\u306e\u69cb\u7bc9\u306a\u306e\u3067\u3059\u304c\u3001UEFI\u3068[rEFInd]\u304a\u304b\u3052\u3067\u5c11\u3057\u697d\u3067\u3059\u3002\u57fa\u672c\u7684\u306bEFI\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30f3\u306e\u4e2d\u306b\u30d6\u30fc\u30c8\u30ed\u30fc\u30c0\u30fc\u653e\u308a\u8fbc\u3080\u3060\u3051\u3067OK\u306a\u306e\u3067\u3002\n\n[rEFInd]: http://rodsbooks.com/refind/ \n\n#### FreeBSD\n\n````\n# mkdir /boot/efi\n# mount -t msdosfs /dev/ada0p1 /boot/efi\n# mkdir -p /boot/efi/EFI/freebsd\n# cp -a /boot/boot1.efi /boot/efi/EFI/freebsd\n````\n\n\u3066\u306a\u611f\u3058\u3067\u3044\u3051\u307e\u3059\u3002\u306a\u304a\u3001\u30d0\u30fc\u30b8\u30e7\u30f3\u9055\u3044\u306eFreeBSD\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\u969b\u306b\u306f\n\n````\n# pkg install beadm\n# beadm create freebsd12c\n# beadm activate freebsd12c\n````\n\n\u306a\u3069\u3068\u3057\u3066Boot Environment\u3092clone\u3057\u3066\u304b\u3089\u518d\u8d77\u52d5\u3057\u3066\u304b\u3089\u30a2\u30c3\u30d7\u30b0\u30ec\u30fc\u30c9\u3059\u308b\u3068\u697d\u3067\u3059\u3002\n\n#### Ubuntu (and other Linuxen)\n\n[Ubuntu 16.04 Root on ZFS]\u306eTroubleshooting\u306e\u65b9\u6cd5\u306b\u306e\u3063\u3068\u3063\u3066`chroot`\u3057\u305f\u5f8c\u306b\u3001grub\u3092\u518d\u69cb\u7bc9\u3059\u308c\u3070OK\u3002\u305d\u306e\u969b\u306b\n\n````\n# bootid=xenial\n# grub-install --target=x86_64-efi --efi-directory=/boot/efi --bootloader-id=$bootid --recheck --no-floppy\n````\n\n\u306a\u3069\u3068\u3057\u3066\u3001distro\u3054\u3068\u306b`grubx64.efi`\u304c\u5225\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u30fc\u306b\u5165\u308b\u3088\u3046\u306b\u3057\u3066\u304a\u304f\u3068\u3001rEFInd\u3067\u5bb9\u6613\u306b\u5207\u308a\u66ff\u3048\u3089\u308c\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\n\n[Ubuntu 16.04 Root on ZFS]: https://github.com/zfsonlinux/zfs/wiki/Ubuntu-16.04-Root-on-ZFS\n\nFreeBSD\u3068\u9055\u3044\u3001ZFS on Linux \u306e grub \u306f Boot Environment \u3092\u30b5\u30dd\u30fc\u30c8\u3057\u3066\u304a\u3089\u305a\u3001root dataset\u306f`grub.cfg`\u306b\u6c7a\u3081\u6253\u3061\u306b\u306a\u308b\u306e\u3067\u3059\u304c\u3001rEFInd\u306e\u304a\u304b\u3052\u3067\u304b\u3048\u3063\u3066\u30e9\u30af\u304b\u3082\u3002\n\nFreeBSD\u540c\u69d8\u3001root dataset\u3092clone\u3057\u3066\u304b\u3089`dist-upgrade`\u3059\u308b\u3068\u697d\u3061\u3093\u3067\u3059\u3002\n\n## CAVEAT\n\n* macOS\u3068FreeBSD\u306e\u30d6\u30fc\u30c8\u30ed\u30fc\u30c0\u30fc\u306f\u30d7\u30fc\u30eb\u306e`bootfs`\u30d7\u30ed\u30d1\u30c6\u30a3\u3092\u898b\u3066\u3069\u306e\u30c7\u30fc\u30bf\u30bb\u30c3\u30c8\u3092`/`\u306b\u30de\u30a6\u30f3\u30c8\u3059\u308b\u304b\u3092\u6c7a\u3081\u3066\u3044\u308b\u306e\u3067\u3001\u3053\u308c\u306e\u5909\u66f4\u3092\u5fd8\u308c\u3066OS\u3092\u5207\u308a\u66ff\u3048\u308b\u3068\u6ce3\u304d\u3092\u898b\u307e\u3059\u3002\u5909\u66f4\u524d\u306b\n\n````\n# zpool set bootfs=rpool/ROOT/$nextboot rpool\n````\n\n\u3057\u3066\u304a\u304f\u3053\u3068\u3002\n\n* \u4ed6OS\u304b\u3089Linux\u306b\u5207\u308a\u66ff\u3048\u308b\u3068\u3001busybox\u306b\u843d\u3061\u307e\u3059\u3002\u3053\u308c\u306fZFS on Linux\u3067\u306f\u30d6\u30fc\u30c8\u3054\u3068\u306b\u30eb\u30fc\u30c8\u30d7\u30fc\u30eb\u3092`import`\u3057\u3001\u30b7\u30e3\u30c3\u30c8\u30c0\u30a6\u30f3\u3054\u3068\u306b`export`\u3057\u3066\u3044\u308b\u305f\u3081\u3001\u300c\u307e\u3060`export`\u3055\u308c\u3066\u3044\u306a\u3044\u30d7\u30fc\u30eb\u306f`import`\u3057\u307e\u305b\u3093\u3063\u300d\u3063\u3066\u306e\u304c\u7406\u7531\u306a\u306e\u3067\u3001`zpool import -f -N -R / rpool`\u3068\u546a\u6587\u3092\u5531\u3048\u3066\u304b\u3089ctrl-D\u3059\u308c\u3070\u304ak\u3002\n\n## OS\u3054\u3068\u306e\u6240\u611f\n\n### macOS\n\nZFS\u4e0a\u3067\u3082\u7121\u554f\u984c\u3002o3x\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u30a2\u30c3\u30d7\u4ee5\u5916\u306a\u3089\u3001\u3075\u3064\u3046\u306b\u30bd\u30d5\u30c8\u30a6\u30a7\u30a2\u30a2\u30c3\u30d7\u30c7\u30fc\u30c8\u3082\u304b\u3051\u3089\u308c\u307e\u3059\u3057\u3001o3x\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u30a2\u30c3\u30d7\u306e\u5834\u5408\u306b\u3082\u3001HFS+\u5074\u3092\u30a2\u30c3\u30d7\u30c7\u30fc\u30c8\u3057\u3066\u304b\u3089`/Library/Filesystems`\u3068`/usr/local`\u3092`rsync`\u3057\u3066\u304b\u3089`boot`\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30f3\u3092\u518d\u69cb\u7bc9\u3059\u308c\u3070\u3044\u3051\u308b\u306f\u305a\u3002\n\n### Windows\n\nUEFI\u6642\u4ee3\u524d\u306eWindows 7\u6642\u4ee3\u306eBoot Camp\u3060\u3051\u3042\u3063\u3066\u3001BIOS\u30e2\u30fc\u30c9\u3067\u30d6\u30fc\u30c8\u3057\u3066\u3044\u308b\u306e\u3067\u3059\u304c\u3001\u305d\u306e\u70b9\u3092\u9664\u3051\u3070\u3075\u3064\u3046\u306b\u4f7f\u3048\u307e\u3059\u3002Windows 10\u306e\u300c\u30e1\u30a4\u30b8\u30e3\u30fc\u30a2\u30c3\u30d7\u30c7\u30fc\u30c8\u300d(\u4f8b\u3048\u3070Anniversary Edition\u3068\u304b)\u306e\u969b\u306b\u30c8\u30e9\u30c3\u30af\u30d1\u30c3\u30c9\u3092\u898b\u5931\u3046\u306e\u3067\u3059\u304c\u3001\u3053\u306e\u5834\u5408\u306fDevice Manager\u3067\u518d\u8a2d\u5b9a\u3057\u3066\u3084\u308c\u3070\u5143\u3069\u304a\u308a\u306b\u306a\u308a\u307e\u3059\u3002\n\ncf. http://www.msitgeek.com/fixing-windows-8-trackpad-driver-in-bootcamp/\n\n### Ubuntu\n\n\u3055\u3059\u304c\u306b\u67af\u308c\u305f\u30de\u30b7\u30f3\u3060\u3051\u3042\u3063\u3066\u3001wifi\u542b\u3081\u554f\u984c\u306a\u3057\u3002\u552f\u4e00\u306e\u554f\u984c\u306f\u30b5\u30b9\u30da\u30f3\u30c9\u6642\u306b\u30c7\u30a3\u30b9\u30d7\u30ec\u30a4\u304c\u623b\u3089\u306a\u3044\u3053\u3068\u3067\u3059\u304c\u3001\u3053\u308c\u3082`/etc/pm/config.d/defaults`\u306b\n\n````\nADD_PARAMETERS=\"--quirk-reset-brightness\"\nDROP_PARAMETERS=\"--quirks-none\"\n````\n\n\u3092\u8ffd\u8a18\u3059\u308b\u3060\u3051\u3067OK\u3002\u3053\u3061\u3089\u3092\u30e1\u30a4\u30f3\u306b\u4f7f\u3044\u305f\u3044\u4eba\u3082\u7d50\u69cb\u3044\u308b\u306e\u3067\u306f\u3002\u3067\u3082\u30ad\u30fc\u30dc\u30fc\u30c9\u53e9\u3044\u3066\u308b\u6642\u306b\u30c8\u30e9\u30c3\u30af\u30d1\u30c3\u30c9\u304d\u3061\u3093\u3068\u7121\u8996\u3057\u3066\u304f\u308c\u306a\u3044\u2026\n\n### FreeBSD\n\n\u5185\u81d3wifi\u306f\u30c0\u30e1\u3067\u3059\u304c\u3001\u3042\u3068\u306f\u307e\u3042\u307e\u3042\u52d5\u304d\u307e\u3059\u3002\u4e00\u5fdc`wsp`\u30c9\u30e9\u30a4\u30d0\u30fc\u306e\u304a\u304b\u3052\u3067\u30de\u30eb\u30c1\u30bf\u30c3\u30c1\u3082\u3044\u3051\u308b\u306f\u3044\u3051\u308b\u306e\u3067\u3059\u304c\u3001Ubuntu\u307b\u3069\u81ea\u7136\u3067\u306f\u306a\u3044\u3067\u3059\u3002USB Ethernet\u306fAX88178A/AX88179\u3092\u4f7f\u3063\u3066\u308b\u3082\u306e\u3067\u3042\u308c\u3070[axge]\u30c9\u30e9\u30a4\u30d0\u30fc\u3067\u52d5\u304d\u307e\u3059\u3002\u79c1\u306e\u5834\u5408[LUA4-U3-AGT]\u3092\u4f7f\u3063\u3066\u307e\u3059\u3002`/etc/rc.conf`\u306b\n\n[LUA4-U3-AGT]: http://amzn.to/2lS7lET\n[axge]: https://www.freebsd.org/cgi/man.cgi?query=axge&sektion=4\n\n````\nifconfig_ue0=\"DHCP\"\n````\n\n\u3068\u3057\u3066\u304b\u3089\u518d\u8d77\u52d5\u3059\u308b\u306a\u308a`service netif restart`\u3059\u308b\u306a\u308a\u3059\u308c\u3070OK\u3002\n\nmacOS\u3067\u3082Windows 10\u3067\u3082\u4f7f\u3048\u307e\u3059\u3057\u3001\u7d14\u6b63\u306eThunderbolt Ethernet Adapter\u3068\u9055\u3063\u3066Mac\u4ee5\u5916\u3067\u3082\u629c\u304d\u5dee\u3057OK\u3067\u3057\u304b\u3082\u5b89\u4fa1(\u3044\u305a\u308c\u30822000\u5186\u5f31)\u306a\u306e\u3067\u3001\u4e00\u3064\u7528\u610f\u3057\u3066\u304a\u304f\u3068\u3044\u3056\u3068\u3044\u3046\u6642\u300c\u3053\u3093\u306a\u3053\u3068\u3082\u3042\u308d\u3046\u304b\u3068\u300d\u3067\u304d\u307e\u3059\u3002\n\n## \u3055\u3044\u3054\u306b\n\n\u4eee\u60f3\u30de\u30b7\u30f3\u304c\u6563\u6b69\u3060\u3068\u3059\u308b\u3068\u30d9\u30a2\u30e1\u30bf\u30eb\u306f\u767b\u5c71\u3068\u3044\u3046\u611f\u3058\u3067\u3059\u304c\u3001\u3053\u308c\u304f\u3089\u3044\u306a\u3089\u9ad8\u5c3e\u5c71\u3050\u3089\u3044\u304b\u306a\u3002\u5927\u6614\u306eOS\u3054\u3068\u306b\u5b9f\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30f3\u3092\u5207\u308b\u30de\u30eb\u30c1\u30d6\u30fc\u30c8\u3068\u6bd4\u3079\u305f\u3089\u3001ZFS\u306e\u30de\u30eb\u30c1\u30d6\u30fc\u30c8\u306f\u307b\u3093\u3068\u30e9\u30af\u3002\n\n\u4eee\u60f3\u30de\u30b7\u30f3\u3068\u30b3\u30f3\u30c6\u30ca\u306b\u6163\u308c\u304d\u3063\u305f\u307f\u306a\u3055\u3093\u3082\u3001\u305f\u307e\u306b\u306f\u30d9\u30a2\u30e1\u30bf\u30eb\u3068\u622f\u308c\u307e\u3057\u3087\u3046\u3002\n\nDan the Unofficial ZFS Advocate\n", "tags": ["ZFS", "FreeBSD", "macos", "Linux", "macbookair"]}