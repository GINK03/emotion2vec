{"context": " More than 1 year has passed since last update.\u4ee5\u524d\u306f ELB \u3067\u8ca0\u8377\u5206\u6563\u3057\u3066\u305f\u3093\u3060\u3051\u3069\u3001\u305d\u308d\u305d\u308d\u9650\u754c\u3092\u611f\u3058\u3066\u304d\u305f\u308a\u3001\u4e16\u754c\u5c55\u958b\u306a\u3069\u3092\u8003\u3048\u3066 CloudFront \u3092 CDN \u3068\u3057\u3066\u5c0e\u5165\u3057\u305f\u3044\u3088\u3046\u306a\u30b1\u30fc\u30b9\u306f\u7d50\u69cb\u3042\u308b\u3088\u3046\u306b\u601d\u3044\u307e\u3059\u3002\n\n\u4ee5\u524d\u306e\u69cb\u6210\uff1a\u30af\u30e9\u30a4\u30a2\u30f3\u30c8 <---- https ----> ELB <---- http ----> EC2\n\u6539\u5584\u5f8c\u306e\u69cb\u6210\uff1a\u30af\u30e9\u30a4\u30a2\u30f3\u30c8 <---- https ----> CloudFront <---- https ----> ELB <---- http ----> EC2\n\n\u4f8b\u3048\u3070\u5143\u3005 ELB \u306b\u300cwww.domain.com\u300d\u3068\u3044\u3046\u30c9\u30e1\u30a4\u30f3\u3068\u305d\u306e SSL \u8a3c\u660e\u66f8\u304c\u914d\u7f6e\u3055\u308c\u3066\u3044\u305f\u5834\u5408\u3001\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u304b\u3089\u306e\u30a8\u30f3\u30c9\u30dd\u30a4\u30f3\u30c8\u306f\u5909\u66f4\u51fa\u6765\u306a\u3044\u306e\u3067\u300cwww.domain.com\u300d\u306e\u5411\u3051\u5148\u3092 CloudFront \u306b\u5909\u66f4\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\n\u305f\u3060\u3053\u306e\u3068\u304d\n\nCloudFront \u306e\u30aa\u30ea\u30b8\u30f3\u30b5\u30fc\u30d0\u30fc\u3068\u3057\u3066 ELB \u3092\u8a2d\u5b9a\u3059\u308b\nCloudFront \u306b ELB \u3068\u540c\u3058 SSL \u8a3c\u660e\u66f8\u3092\u914d\u7f6e\u3059\u308b\n\u300cwww.domain.com\u300d\u306e\u5411\u3051\u5148\u3092 CloudFront \u306b\u5909\u66f4\u3059\u308b\n\n\u3068\u3044\u3046\u3088\u3046\u306a\u5358\u7d14\u306a\u30b9\u30c6\u30c3\u30d7\u3067\u306f\u3046\u307e\u304f\u3044\u304d\u307e\u305b\u3093\u3002\nCloudfront SSL + ELB SSL, both custom SSL, returns gateway 502\n\nWhen reviewing your CloudFront distribution it looks like your Origin is listed as the ELB's FQDN.  \u301c\uff08\u4e2d\u7565\uff09\u301c Since CloudFront makes an SSL connection to your Origin using the \"Origin's\" domain name, this willf ail since the certificate you have is domain.ca not the ELBs FQDN.\n\n\u3053\u3061\u3089\u306b\u3042\u308b\u3088\u3046\u306b\u3001CloudFront \u304b\u3089 ELB \u306b\u63a5\u7d9a\u3059\u308b\u969b\u3001ELB \u306e FQDN \u3067\u30a2\u30af\u30bb\u30b9\u3059\u308b\u305f\u3081\u3001\u305d\u308c\u7528\u306e SSL \u8a3c\u660e\u66f8\u3067\u306a\u3044\u3068\u901a\u4fe1\u3067\u304d\u307e\u305b\u3093\u3002\n\u4f8b\u3048\u3070\u6771\u4eac\u30ea\u30fc\u30b8\u30e7\u30f3\u3067 ELB \u3092\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\u3057\u305f\u5834\u5408\u306f\u300cxxxx.ap-northeast-1.elb.amazonaws.com\u300d\u306e\u3088\u3046\u306b\u306a\u308b\u306e\u3067\u3001\u5143\u3005 ELB \u306b\u914d\u7f6e\u3055\u308c\u3066\u3044\u308b\u300cwww.domain.com\u300d\u7528\u306e SSL \u8a3c\u660e\u66f8\u3067\u306f\u30a2\u30af\u30bb\u30b9\u51fa\u6765\u306a\u3044\u3068\u3044\u3046\u3053\u3068\u3067\u3059\u3002\n\u3067\u306f\u3069\u3046\u3059\u308c\u3070\u826f\u3044\u304b\uff1f\u3068\u3044\u3046\u3053\u3068\u3067\u3059\u304c\u3001\u540c\u30d5\u30a9\u30fc\u30e9\u30e0\u306b\u89e3\u6c7a\u7b56\u3082\u66f8\u3044\u3066\u3042\u308a\u307e\u3059\u3002\n\nSetup either a wildcard cert (*.domain.ca) or a certificate specifically for your origin (origin.domain.ca)\nModify your distribution to use the CNAME of the Origin (origin.domain.ca). Create a CNAME in Route53 for origin.domain.ca and point that to your ELBs FQDN.\n\n\u30ef\u30a4\u30eb\u30c9\u30ab\u30fc\u30c9\u8a3c\u660e\u66f8\u304b ELB \u7528\u306e\u65b0\u305f\u306a\u8a3c\u660e\u66f8\u3092\u30b2\u30c3\u30c8\u3057\u3066\u305d\u308c\u3092\u5229\u7528\u3057\u307e\u3057\u3087\u3046\u3001ELB \u306b\u306f Route53 \u8a2d\u5b9a\u3057\u307e\u3057\u3087\u3046\u3001\u3068\u3044\u3046\u3053\u3068\u304c\u66f8\u3044\u3066\u3042\u308a\u307e\u3059\u3002\n\u4eca\u56de\u306e\u30b1\u30fc\u30b9\u306b\u7167\u3089\u3057\u5408\u308f\u305b\u3066\u8003\u3048\u3066\u307f\u308b\u3068\u3001\u4e0b\u8a18\u306e\u3088\u3046\u306a\u65bd\u7b56\u3067\u5bfe\u5fdc\u3067\u304d\u308b\u3068\u3044\u3046\u3053\u3068\u3067\u3059\u3002\uff08\u30ef\u30a4\u30eb\u30c9\u30ab\u30fc\u30c9\u8a3c\u660e\u66f8\u306e\u30d1\u30bf\u30fc\u30f3\uff09\n\n\u30ef\u30a4\u30eb\u30c9\u30ab\u30fc\u30c9\u8a3c\u660e\u66f8\u3092\u30b2\u30c3\u30c8\u3059\u308b\nCloudFront\uff0fELB \u306b\u305d\u306e\u8a3c\u660e\u66f8\u3092\u9069\u7528\u3059\u308b \nELB \u306b Route53 \u8a2d\u5b9a\u3059\u308b\uff08\u4f8b\u3048\u3070\u300celb.domain.com\u300d\uff09\nCloudFront \u306e\u30aa\u30ea\u30b8\u30f3\u30b5\u30fc\u30d0\u30fc\u8a2d\u5b9a\u3092\u300celb.domain.com\u300d\u306b\u3059\u308b\nCloudFront \u306e\u30a8\u30f3\u30c9\u30dd\u30a4\u30f3\u30c8\u3092\u300cwww.domain.com\u300d\u306b\u3059\u308b\n\n\u3053\u308c\u3067\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u304b\u3089\u306e\u30a8\u30f3\u30c9\u30dd\u30a4\u30f3\u30c8\u306f\u5909\u66f4\u305b\u305a\u3001\u30d5\u30ed\u30f3\u30c8\u30a8\u30f3\u30c9\u306b CloudFront \u304c\u914d\u7f6e\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\n\u3081\u3067\u305f\u3057\u3081\u3067\u305f\u3057\u3002\n\u4ee5\u524d\u306f ELB \u3067\u8ca0\u8377\u5206\u6563\u3057\u3066\u305f\u3093\u3060\u3051\u3069\u3001\u305d\u308d\u305d\u308d\u9650\u754c\u3092\u611f\u3058\u3066\u304d\u305f\u308a\u3001\u4e16\u754c\u5c55\u958b\u306a\u3069\u3092\u8003\u3048\u3066 CloudFront \u3092 CDN \u3068\u3057\u3066\u5c0e\u5165\u3057\u305f\u3044\u3088\u3046\u306a\u30b1\u30fc\u30b9\u306f\u7d50\u69cb\u3042\u308b\u3088\u3046\u306b\u601d\u3044\u307e\u3059\u3002\n\n- \u4ee5\u524d\u306e\u69cb\u6210\uff1a\u30af\u30e9\u30a4\u30a2\u30f3\u30c8 <---- https ----> ELB <---- http ----> EC2\n- \u6539\u5584\u5f8c\u306e\u69cb\u6210\uff1a\u30af\u30e9\u30a4\u30a2\u30f3\u30c8 <---- https ----> CloudFront <---- https ----> ELB <---- http ----> EC2\n\n\u4f8b\u3048\u3070\u5143\u3005 ELB \u306b\u300cwww.domain.com\u300d\u3068\u3044\u3046\u30c9\u30e1\u30a4\u30f3\u3068\u305d\u306e SSL \u8a3c\u660e\u66f8\u304c\u914d\u7f6e\u3055\u308c\u3066\u3044\u305f\u5834\u5408\u3001\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u304b\u3089\u306e\u30a8\u30f3\u30c9\u30dd\u30a4\u30f3\u30c8\u306f\u5909\u66f4\u51fa\u6765\u306a\u3044\u306e\u3067\u300cwww.domain.com\u300d\u306e\u5411\u3051\u5148\u3092 CloudFront \u306b\u5909\u66f4\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\n\u305f\u3060\u3053\u306e\u3068\u304d\n\n- CloudFront \u306e\u30aa\u30ea\u30b8\u30f3\u30b5\u30fc\u30d0\u30fc\u3068\u3057\u3066 ELB \u3092\u8a2d\u5b9a\u3059\u308b\n- CloudFront \u306b ELB \u3068\u540c\u3058 SSL \u8a3c\u660e\u66f8\u3092\u914d\u7f6e\u3059\u308b\n- \u300cwww.domain.com\u300d\u306e\u5411\u3051\u5148\u3092 CloudFront \u306b\u5909\u66f4\u3059\u308b\n\n\u3068\u3044\u3046\u3088\u3046\u306a\u5358\u7d14\u306a\u30b9\u30c6\u30c3\u30d7\u3067\u306f\u3046\u307e\u304f\u3044\u304d\u307e\u305b\u3093\u3002\n\n[Cloudfront SSL + ELB SSL, both custom SSL, returns gateway 502](https://forums.aws.amazon.com/thread.jspa?threadID=154691)\n\n>When reviewing your CloudFront distribution it looks like your Origin is listed as the ELB's FQDN.  \u301c\uff08\u4e2d\u7565\uff09\u301c Since CloudFront makes an SSL connection to your Origin using the \"Origin's\" domain name, this willf ail since the certificate you have is domain.ca not the ELBs FQDN.\n\n\n\u3053\u3061\u3089\u306b\u3042\u308b\u3088\u3046\u306b\u3001CloudFront \u304b\u3089 ELB \u306b\u63a5\u7d9a\u3059\u308b\u969b\u3001ELB \u306e FQDN \u3067\u30a2\u30af\u30bb\u30b9\u3059\u308b\u305f\u3081\u3001\u305d\u308c\u7528\u306e SSL \u8a3c\u660e\u66f8\u3067\u306a\u3044\u3068\u901a\u4fe1\u3067\u304d\u307e\u305b\u3093\u3002\n\u4f8b\u3048\u3070\u6771\u4eac\u30ea\u30fc\u30b8\u30e7\u30f3\u3067 ELB \u3092\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\u3057\u305f\u5834\u5408\u306f\u300cxxxx.ap-northeast-1.elb.amazonaws.com\u300d\u306e\u3088\u3046\u306b\u306a\u308b\u306e\u3067\u3001\u5143\u3005 ELB \u306b\u914d\u7f6e\u3055\u308c\u3066\u3044\u308b\u300cwww.domain.com\u300d\u7528\u306e SSL \u8a3c\u660e\u66f8\u3067\u306f\u30a2\u30af\u30bb\u30b9\u51fa\u6765\u306a\u3044\u3068\u3044\u3046\u3053\u3068\u3067\u3059\u3002\n\n\u3067\u306f\u3069\u3046\u3059\u308c\u3070\u826f\u3044\u304b\uff1f\u3068\u3044\u3046\u3053\u3068\u3067\u3059\u304c\u3001\u540c\u30d5\u30a9\u30fc\u30e9\u30e0\u306b\u89e3\u6c7a\u7b56\u3082\u66f8\u3044\u3066\u3042\u308a\u307e\u3059\u3002\n\n>Setup either a wildcard cert (*.domain.ca) or a certificate specifically for your origin (origin.domain.ca)\nModify your distribution to use the CNAME of the Origin (origin.domain.ca). Create a CNAME in Route53 for origin.domain.ca and point that to your ELBs FQDN.\n\n\u30ef\u30a4\u30eb\u30c9\u30ab\u30fc\u30c9\u8a3c\u660e\u66f8\u304b ELB \u7528\u306e\u65b0\u305f\u306a\u8a3c\u660e\u66f8\u3092\u30b2\u30c3\u30c8\u3057\u3066\u305d\u308c\u3092\u5229\u7528\u3057\u307e\u3057\u3087\u3046\u3001ELB \u306b\u306f Route53 \u8a2d\u5b9a\u3057\u307e\u3057\u3087\u3046\u3001\u3068\u3044\u3046\u3053\u3068\u304c\u66f8\u3044\u3066\u3042\u308a\u307e\u3059\u3002\n\u4eca\u56de\u306e\u30b1\u30fc\u30b9\u306b\u7167\u3089\u3057\u5408\u308f\u305b\u3066\u8003\u3048\u3066\u307f\u308b\u3068\u3001\u4e0b\u8a18\u306e\u3088\u3046\u306a\u65bd\u7b56\u3067\u5bfe\u5fdc\u3067\u304d\u308b\u3068\u3044\u3046\u3053\u3068\u3067\u3059\u3002\uff08\u30ef\u30a4\u30eb\u30c9\u30ab\u30fc\u30c9\u8a3c\u660e\u66f8\u306e\u30d1\u30bf\u30fc\u30f3\uff09\n\n- \u30ef\u30a4\u30eb\u30c9\u30ab\u30fc\u30c9\u8a3c\u660e\u66f8\u3092\u30b2\u30c3\u30c8\u3059\u308b\n- CloudFront\uff0fELB \u306b\u305d\u306e\u8a3c\u660e\u66f8\u3092\u9069\u7528\u3059\u308b \n- ELB \u306b Route53 \u8a2d\u5b9a\u3059\u308b\uff08\u4f8b\u3048\u3070\u300celb.domain.com\u300d\uff09\n- CloudFront \u306e\u30aa\u30ea\u30b8\u30f3\u30b5\u30fc\u30d0\u30fc\u8a2d\u5b9a\u3092\u300celb.domain.com\u300d\u306b\u3059\u308b\n- CloudFront \u306e\u30a8\u30f3\u30c9\u30dd\u30a4\u30f3\u30c8\u3092\u300cwww.domain.com\u300d\u306b\u3059\u308b\n\n\u3053\u308c\u3067\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u304b\u3089\u306e\u30a8\u30f3\u30c9\u30dd\u30a4\u30f3\u30c8\u306f\u5909\u66f4\u305b\u305a\u3001\u30d5\u30ed\u30f3\u30c8\u30a8\u30f3\u30c9\u306b CloudFront \u304c\u914d\u7f6e\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\n\u3081\u3067\u305f\u3057\u3081\u3067\u305f\u3057\u3002\n", "tags": ["AWS", "elb", "CloudFront", "HTTPS", "SSL"]}