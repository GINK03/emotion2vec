{"context": " More than 1 year has passed since last update.\n\n\u306f\u3058\u3081\u306b\n\u9ce5\u53d6\u770c\u30aa\u30fc\u30d7\u30f3\u30c7\u30fc\u30bf\u30ab\u30bf\u30ed\u30b0\u3067\u306f\u4ea4\u901a\u4e8b\u6545\u60c5\u5831\u304c\u30aa\u30fc\u30d7\u30f3\u30c7\u30fc\u30bf\u3067\u516c\u958b\u3055\u308c\u3066\u3044\u307e\u3059\u3002\n\u4eca\u56de\u306f\u3053\u306e\u30aa\u30fc\u30d7\u30f3\u30c7\u30fc\u30bf\u3092\u4f7f\u3063\u3066\u81ea\u8ee2\u8eca\u4e8b\u6545\u306e\u767a\u751f\u5834\u6240\u30de\u30c3\u30d7\u3092\u4f5c\u3063\u3066\u307f\u305f\u3044\u3068\u601d\u3044\u307e\u3059(\u0e51\u02c3\u0335\u1d17\u02c2\u0335)\u0648 \n2015\u5e746\u67081\u65e5\u306e\u9053\u8def\u4ea4\u901a\u6cd5\u6539\u6b63\u306b\u4f34\u3044\u81ea\u8ee2\u8eca\u306e\u53d6\u308a\u7de0\u307e\u308a\u3082\u53b3\u3057\u304f\u306a\u3063\u305f\u306e\u3067\u3001\u3069\u3093\u306a\u5834\u6240\u3067\u81ea\u8ee2\u8eca\u4e8b\u6545\u304c\u8d77\u3053\u3063\u3066\u3044\u308b\u306e\u304b\u6c17\u306b\u306a\u308b\u3068\u3053\u308d\u3067\u3059\u3002\n\u307e\u305a\u306f\u5148\u306b\u3001\u5b8c\u6210\u3057\u305f\u30de\u30c3\u30d7\u306e\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8\u3092\u304a\u898b\u305b\u3057\u307e\u3059\u3002\n\n\u3053\u3093\u306a\u611f\u3058\u3067\u3059\u3002\n\u5e73\u621026\u5e74\u5ea6\u306b\u767a\u751f\u3057\u305f\u81ea\u8ee2\u8eca\u306b\u95a2\u3059\u308b\u4e8b\u6545\u306e\u5834\u6240\u3092\u3001\n\n\u6b7b\u4ea1\u4e8b\u6545\n\u8efd\u50b7\u4e8b\u6545\n\u91cd\u50b7\u4e8b\u6545\n\n\u306b\u8272\u5206\u3051\u3057\u3066\u3042\u308a\u307e\u3059\u3002\n\u3053\u306e\u5730\u56f3\u306fGist\u3067\u516c\u958b https://gist.github.com/mh61503891/a2572598fa40f5bd0c08 \u3057\u3066\u3044\u307e\u3059\u3002\u5730\u56f3\u306f\u3082\u3061\u308d\u3093\u62e1\u5927\u7e2e\u5c0f\u3057\u305f\u308a\u52d5\u304b\u305b\u307e\u3059(`\uff65\u03c9\uff65\u00b4)\n\u30d4\u30f3\u3092\u30af\u30ea\u30c3\u30af\u3059\u308b\u3068\u8a73\u7d30\u60c5\u5831\u3082\u307f\u3089\u308c\u307e\u3059\u3002\n\n\u3055\u3066\u4eca\u56de\u306f\u3001\u3053\u306e\u4f5c\u308a\u65b9\u3092\u7c21\u5358\u306b\u8aac\u660e\u3057\u305f\u3044\u3068\u601d\u3044\u307e\u3059\u3002\u4e3b\u306a\u8aad\u8005\u306f\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u3092\u59cb\u3081\u305f\u3066\u65b9\u3092\u60f3\u5b9a\u3057\u3064\u3064\u3001\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306e\u524d\u6bb5\u968e\u306eUnix\u7cfb\u306e\u30b3\u30de\u30f3\u30c9\u306e\u4f7f\u3044\u65b9\u3092\u3082\u308d\u3082\u308d\u30e1\u30e2\u3057\u3066\u3044\u307e\u3059\u3002\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u3055\u308c\u306a\u3044\u65b9\u3067\u3082\u96f0\u56f2\u6c17\u306f\u4f1d\u308f\u308b\u304b\u3068\u601d\u3044\u307e\u3059\u3002\n\n\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\n\n\u74b0\u5883\n\nOS: Mac OS X\n\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u8a00\u8a9e: Ruby\n\n\u30c6\u30ad\u30b9\u30c8\u30a8\u30c7\u30a3\u30bf: Atom\n\n\n\u3068\u3044\u3046\u611f\u3058\u3067\u3059\u3002\n\n\u4f5c\u696d\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306e\u4f5c\u6210\u3068\u79fb\u52d5\n$ mkdir bicycle-accident && cd $_\n\nmkdir\u30b3\u30de\u30f3\u30c9\u3067\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092\u4f5c\u6210\u3057\u3066cd $_\u30b3\u30de\u30f3\u30c9\u3067$_\u3092\u6307\u5b9a\u3059\u308b\u3068mkdir\u3057\u305f\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u79fb\u52d5\u3067\u304d\u307e\u3059\u3002&&\u306f\u524d\uff08\u5de6\uff09\u306e\u30b3\u30de\u30f3\u30c9\u304c\u6210\u529f\u3057\u305f\u5834\u5408\u306b\u6b21\uff08\u53f3\uff09\u306e\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3059\u308b\u3068\u3044\u3046\u610f\u5473\u3067\u3059\u3002\n\n\u73fe\u5728\u306e\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306e\u78ba\u8a8d\n$ pwd\n/Users/masayuki/bicycle-accident\n\n\n\u30c7\u30fc\u30bf\u306e\u53d6\u5f97\n\u4ea4\u901a\u4e8b\u6545\u60c5\u5831\u3067\u306f\u3001\n\n\u4ea4\u901a\u4e8b\u6545-(\u5e73\u621024\u5e74).csv\n\u4ea4\u901a\u4e8b\u6545-(\u5e73\u621025\u5e74).csv\n\u4ea4\u901a\u4e8b\u6545-(\u5e73\u621026\u5e74).csv\n\n\u304c\u516c\u958b\u3055\u308c\u3066\u3044\u308b\u3088\u3046\u306a\u306e\u3067\u3001\u3068\u308a\u3042\u3048\u305a\u3053\u308c\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3057\u307e\u3059\u3002\n$ wget 'http://db.pref.tottori.jp/opendataResearch.nsf/e92cd7f95a94c9c249257c92000236b8/5c2a1f59ec27a81a49257d630016cf34/$FILE/%E4%BA%A4%E9%80%9A%E4%BA%8B%E6%95%85-(%E5%B9%B3%E6%88%9024%E5%B9%B4).csv' -O crash24.csv\n$ wget 'http://db.pref.tottori.jp/opendataResearch.nsf/e92cd7f95a94c9c249257c92000236b8/5c2a1f59ec27a81a49257d630016cf34/$FILE/%E4%BA%A4%E9%80%9A%E4%BA%8B%E6%95%85-(%E5%B9%B3%E6%88%9025%E5%B9%B4).csv' -O crash25.csv \n$ wget 'http://db.pref.tottori.jp/opendataResearch.nsf/e92cd7f95a94c9c249257c92000236b8/5c2a1f59ec27a81a49257d630016cf34/$FILE/%E4%BA%A4%E9%80%9A%E4%BA%8B%E6%95%85-(%E5%B9%B3%E6%88%9026%E5%B9%B4).csv' -O crash26.csv\n\n\n\u30e1\u30e2\n\n\n\nwget: \u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3059\u308b\u30b3\u30de\u30f3\u30c9\n\n-O: \u4fdd\u5b58\u5148\u306e\u30d5\u30a1\u30a4\u30eb\u540d\u3092\u6307\u5b9a\u3059\u308b\u30aa\u30d7\u30b7\u30e7\u30f3\n\n\n\n\n\u30d5\u30a1\u30a4\u30eb\u4e00\u89a7\n$ ls\ncrash24.csv crash25.csv crash26.csv\n\n\n\u6587\u5b57\u30b3\u30fc\u30c9\u306e\u78ba\u8a8d\nnkf\u30b3\u30de\u30f3\u30c9\u306b--guess\u30aa\u30d7\u30b7\u30e7\u30f3\u3092\u4ed8\u3051\u308b\u3068\u6587\u5b57\u30b3\u30fc\u30c9\u3092\u5224\u5b9a\u3057\u3066\u304f\u308c\u307e\u3059\u3002\u3053\u306e\u7d50\u679c\u306b\u3088\u308b\u3068\u6587\u5b57\u30b3\u30fc\u30c9\u306fShift_JIS\u3067\u6539\u884c\u30b3\u30fc\u30c9\u306fCRLF\u306e\u3088\u3046\u3067\u3059\u3002\n$ nkf --guess crash24.csv \nShift_JIS (CRLF)\n$ nkf --guess crash25.csv \nShift_JIS (CRLF)\n$ nkf --guess crash26.csv \nShift_JIS (CRLF)\n\nls\u30b3\u30de\u30f3\u30c9\u306e\u6a19\u6e96\u51fa\u529b\u3092\u30d1\u30a4\u30d7\uff08|\uff09\u3067xargs\u30b3\u30de\u30f3\u30c9\u306b\u6e21\u305b\u30701\u884c\u306e\u30b3\u30de\u30f3\u30c9\u3067\u5168\u3066\u306e\u30d5\u30a1\u30a4\u30eb\u306e\u6587\u5b57\u30b3\u30fc\u30c9\u3092\u78ba\u8a8d\u3067\u304d\u307e\u3059\u3002\n$ ls | xargs nkf --guess\ncrash24.csv: Shift_JIS (CRLF)\ncrash25.csv: Shift_JIS (CRLF)\ncrash26.csv: Shift_JIS (CRLF)\n\n\u30d5\u30a1\u30a4\u30eb\u3092\u7d5e\u308a\u8fbc\u307f\u305f\u3044\u5834\u5408\u306fls\u30b3\u30de\u30f3\u30c9\u3088\u308a\u3082find\u30b3\u30de\u30f3\u30c9\u3092\u4f7f\u3063\u305f\u65b9\u304c\u4fbf\u5229\u3067\u3059\u3002\n$ find . -name \"crash*.csv\" | xargs nkf --guess\n./crash24.csv: Shift_JIS (CRLF)\n./crash25.csv: Shift_JIS (CRLF)\n./crash26.csv: Shift_JIS (CRLF)\n\n\n\u30c7\u30fc\u30bf\u306e\u4e2d\u8eab\u306e\u78ba\u8a8d\nMac OS X\u3067\u3042\u308c\u3070\u3001\u30c7\u30d5\u30a9\u30eb\u30c8\u306e\u8a2d\u5b9a\u3060\u3068nkf\u30b3\u30de\u30f3\u30c9\u306e\u51fa\u529b\u306fUTF-8\u3078\u5909\u63db\u3055\u308c\u3066\u3067\u3066\u304d\u307e\u3059\u3002\u3053\u308c\u306e\u5148\u982d\u306e\u6570\u884c\u3092\u8868\u793a\u3057\u3066\u307f\u307e\u3059\u3002\u30d1\u30a4\u30d7\uff08|\uff09\u3092\u4f7f\u3063\u3066head\u30b3\u30de\u30f3\u30c9\u306b\u6e21\u305b\u3070OK\u3067\u3059\u3002\n$ nkf crash26.csv | head\n\u540d\u79f0,\u767a\u751f\u5834\u6240,\u767a\u751f\u5e74\u6708\u65e5,\u5f53\u4e8b\u8005\u7a2e\u5225,\u4e8b\u6545\u5185\u5bb9,\u6240\u8f44\u8b66\u5bdf\u7f72,\u4e8b\u6545\u985e\u578b,\u5730\u70b9\u7d4c\u5ea6,\u5730\u70b9\u7def\u5ea6\n\u5168\u4e8b\u6545,\u6771\u4f2f\u90e1\u7434\u6d66\u753a\u5927\u5b57\u51fa\u4e0a,2013/10/30,\u8efd\u8ca8\u7269\u00d7\u76f8\u624b\u306a\u3057,\u91cd\u50b7\u4e8b\u6545,\u516b\u6a4b\u7f72,\u8eca\u4e21\u5358\u72ec,133.63196416700,35.50113361110\n\u5168\u4e8b\u6545,\u9ce5\u53d6\u5e02\u4e09\u5c71\u53e3,2013/11/03,\u666e\u901a\u4e57\u7528\u00d7\u7269\u4ef6\u7b49,\u91cd\u50b7\u4e8b\u6545,\u9ce5\u53d6\u7f72,\u8eca\u4e21\u5358\u72ec,134.15423333300,35.48269722220\n\u5168\u4e8b\u6545,\u7c73\u5b50\u5e02\u897f\u798f\u539f\u4e00\u4e01\u76ee,2013/11/21,\u666e\u901a\u4e57\u7528\u00d7\u666e\u901a\u4e57\u7528,\u8efd\u50b7\u4e8b\u6545,\u7c73\u5b50\u7f72,\u8eca\u4e21\u76f8\u4e92,133.34055833300,35.43853611110\n\u5168\u4e8b\u6545,\u9ce5\u53d6\u5e02\u5b89\u9577,2013/11/23,\u666e\u901a\u4e57\u7528\u00d7\u81ea\u8ee2\u8eca,\u91cd\u50b7\u4e8b\u6545,\u9ce5\u53d6\u7f72,\u8eca\u4e21\u76f8\u4e92,134.20791666700,35.51267777780\n\u5168\u4e8b\u6545,\u9ce5\u53d6\u5e02\u5409\u65b9\u6e29\u6cc9\uff14\u4e01\u76ee,2013/11/25,\u666e\u901a\u4e57\u7528\u00d7\u8efd\u4e57\u7528\u00d7\u666e\u901a\u4e57\u7528,\u8efd\u50b7\u4e8b\u6545,\u9ce5\u53d6\u7f72,\u8eca\u4e21\u76f8\u4e92,134.23786388900,35.48967222220\n\u5168\u4e8b\u6545,\u897f\u4f2f\u90e1\u5357\u90e8\u753a\u963f\u8cc0,2013/11/26,\u666e\u901a\u4e57\u7528\u00d7\u666e\u901a\u4e57\u7528,\u8efd\u50b7\u4e8b\u6545,\u7c73\u5b50\u7f72,\u8eca\u4e21\u76f8\u4e92,133.33130555600,35.36158611110\n\u5168\u4e8b\u6545,\u7c73\u5b50\u5e02\u4e0a\u798f\u539f,2013/12/06,\u666e\u901a\u4e57\u7528\u00d7\u81ea\u8ee2\u8eca,\u8efd\u50b7\u4e8b\u6545,\u7c73\u5b50\u7f72,\u8eca\u4e21\u76f8\u4e92,133.35246388900,35.44394166670\n\u5168\u4e8b\u6545,\u7c73\u5b50\u5e02\u5b97\u50cf,2013/12/09,\u666e\u901a\u8ca8\u7269\u00d7\u8efd\u4e57\u7528,\u8efd\u50b7\u4e8b\u6545,\u7c73\u5b50\u7f72,\u8eca\u4e21\u76f8\u4e92,133.35307222200,35.41546388890\n\u5168\u4e8b\u6545,\u7c73\u5b50\u5e02\u65e5\u30ce\u51fa\u753a\u4e8c\u4e01\u76ee,2013/12/12,\u8efd\u8ca8\u7269\u00d7\u81ea\u8ee2\u8eca,\u8efd\u50b7\u4e8b\u6545,\u7c73\u5b50\u7f72,\u8eca\u4e21\u76f8\u4e92,133.33639027800,35.43667555560\n\n\u3069\u3046\u3084\u30891\u884c\u76ee\u306f\u5217\u306e\u610f\u5473\u3092\u8868\u3059\u884c\u306b\u306a\u3063\u3066\u3044\u308b\u3088\u3046\u3067\u3059\u3002\u3053\u306e\u884c\u306f\u3042\u3063\u305f\u65b9\u304c\u4fbf\u5229\u306a\u306e\u3067\u6bd4\u8f03\u7684\u826f\u3044\u30c7\u30fc\u30bf\u69cb\u9020\u3067\u52a9\u304b\u308a\u307e\u3059|\uff65\u03c9\uff65\u00b4)\ncolumn\u30b3\u30de\u30f3\u30c9\u3092\u4f7f\u3063\u3066\u3082\u3046\u5c11\u3057\u898b\u3084\u3059\u304f\u3057\u3066\u307e\u3057\u3087\u3046\u3002\n-t\u30aa\u30d7\u30b7\u30e7\u30f3\u306f\u5217\u6570\u3092\u81ea\u52d5\u5224\u5b9a\u3057\u3066\u304f\u308c\u307e\u3059\u3002-s\u30aa\u30d7\u30b7\u30e7\u30f3\u306f\u533a\u5207\u308a\u6587\u5b57\u3092\u6307\u5b9a\u3057\u307e\u3059\u3002\u3053\u306e\u30c7\u30fc\u30bf\u306f\u30ab\u30f3\u30de\u533a\u5207\u308a\u306a\u306e\u3067,\u3092\u6307\u5b9a\u3057\u3066\u3044\u307e\u3059\u3002\u30d1\u30a4\u30d7\uff08|\uff09\u3067nkf\u30b3\u30de\u30f3\u30c9\u3068head\u30b3\u30de\u30f3\u30c9\u306e\u9593\u306b\u631f\u3093\u3067\u3084\u308c\u3070\u3001\u305d\u308c\u305e\u308c\u306e\u30b3\u30de\u30f3\u30c9\u304c\u30d5\u30a3\u30eb\u30bf\u30fc\u306e\u3088\u3046\u306b\u30c7\u30fc\u30bf\u3092\u6574\u5f62\u3057\u3066\u53d7\u3051\u6e21\u3057\u3066\u304f\u308c\u307e\u3059\u3002UNIX\u54f2\u5b66\u3068\u3044\u3046\u3084\u3064\u3067\u3059\u3002\n$ nkf crash26.csv | column -t -s , | head\n\u540d\u79f0        \u767a\u751f\u5834\u6240                  \u767a\u751f\u5e74\u6708\u65e5  \u5f53\u4e8b\u8005\u7a2e\u5225                                  \u4e8b\u6545\u5185\u5bb9  \u6240\u8f44\u8b66\u5bdf\u7f72  \u4e8b\u6545\u985e\u578b  \u5730\u70b9\u7d4c\u5ea6         \u5730\u70b9\u7def\u5ea6\n\u5168\u4e8b\u6545      \u6771\u4f2f\u90e1\u7434\u6d66\u753a\u5927\u5b57\u51fa\u4e0a      2013/10/30  \u8efd\u8ca8\u7269\u00d7\u76f8\u624b\u306a\u3057                             \u91cd\u50b7\u4e8b\u6545  \u516b\u6a4b\u7f72      \u8eca\u4e21\u5358\u72ec  133.63196416700  35.50113361110\n\u5168\u4e8b\u6545      \u9ce5\u53d6\u5e02\u4e09\u5c71\u53e3              2013/11/03  \u666e\u901a\u4e57\u7528\u00d7\u7269\u4ef6\u7b49                             \u91cd\u50b7\u4e8b\u6545  \u9ce5\u53d6\u7f72      \u8eca\u4e21\u5358\u72ec  134.15423333300  35.48269722220\n\u5168\u4e8b\u6545      \u7c73\u5b50\u5e02\u897f\u798f\u539f\u4e00\u4e01\u76ee        2013/11/21  \u666e\u901a\u4e57\u7528\u00d7\u666e\u901a\u4e57\u7528                           \u8efd\u50b7\u4e8b\u6545  \u7c73\u5b50\u7f72      \u8eca\u4e21\u76f8\u4e92  133.34055833300  35.43853611110\n\u5168\u4e8b\u6545      \u9ce5\u53d6\u5e02\u5b89\u9577                2013/11/23  \u666e\u901a\u4e57\u7528\u00d7\u81ea\u8ee2\u8eca                             \u91cd\u50b7\u4e8b\u6545  \u9ce5\u53d6\u7f72      \u8eca\u4e21\u76f8\u4e92  134.20791666700  35.51267777780\n\u5168\u4e8b\u6545      \u9ce5\u53d6\u5e02\u5409\u65b9\u6e29\u6cc9\uff14\u4e01\u76ee      2013/11/25  \u666e\u901a\u4e57\u7528\u00d7\u8efd\u4e57\u7528\u00d7\u666e\u901a\u4e57\u7528                    \u8efd\u50b7\u4e8b\u6545  \u9ce5\u53d6\u7f72      \u8eca\u4e21\u76f8\u4e92  134.23786388900  35.48967222220\n\u5168\u4e8b\u6545      \u897f\u4f2f\u90e1\u5357\u90e8\u753a\u963f\u8cc0          2013/11/26  \u666e\u901a\u4e57\u7528\u00d7\u666e\u901a\u4e57\u7528                           \u8efd\u50b7\u4e8b\u6545  \u7c73\u5b50\u7f72      \u8eca\u4e21\u76f8\u4e92  133.33130555600  35.36158611110\n\u5168\u4e8b\u6545      \u7c73\u5b50\u5e02\u4e0a\u798f\u539f              2013/12/06  \u666e\u901a\u4e57\u7528\u00d7\u81ea\u8ee2\u8eca                             \u8efd\u50b7\u4e8b\u6545  \u7c73\u5b50\u7f72      \u8eca\u4e21\u76f8\u4e92  133.35246388900  35.44394166670\n\u5168\u4e8b\u6545      \u7c73\u5b50\u5e02\u5b97\u50cf                2013/12/09  \u666e\u901a\u8ca8\u7269\u00d7\u8efd\u4e57\u7528                             \u8efd\u50b7\u4e8b\u6545  \u7c73\u5b50\u7f72      \u8eca\u4e21\u76f8\u4e92  133.35307222200  35.41546388890\n\u5168\u4e8b\u6545      \u7c73\u5b50\u5e02\u65e5\u30ce\u51fa\u753a\u4e8c\u4e01\u76ee      2013/12/12  \u8efd\u8ca8\u7269\u00d7\u81ea\u8ee2\u8eca                               \u8efd\u50b7\u4e8b\u6545  \u7c73\u5b50\u7f72      \u8eca\u4e21\u76f8\u4e92  133.33639027800  35.43667555560\n\n\u307f\u3084\u3059\u304f\u306a\u308a\u307e\u3057\u305f|\uff65\u03c9\uff65\u00b4)\n\n\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\n\u30c7\u30fc\u30bf\u306e\u78ba\u8a8d\u304c\u3067\u304d\u305f\u3068\u3053\u308d\u3067\u3001\u3044\u3088\u3044\u3088GeoJSON\u3078\u5909\u63db\u3059\u308b\u30d7\u30ed\u30b0\u30e9\u30e0\u3092\u4f5c\u308a\u307e\u3057\u3087\u3046\u3002\n\n\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u306e\u30d5\u30a1\u30a4\u30eb\u306e\u4f5c\u6210\n\u7a7a\u306e\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u6210\u3059\u308b\u306b\u306ftouch\u3092\u4f7f\u3044\u307e\u3059\u3002\u307e\u3042\u4ed6\u306e\u65b9\u6cd5\u3067\u3082\u826f\u3044\u306e\u3067\u3059\u304c\u79c1\u306f\u3053\u308c\u3092\u3088\u304f\u4f7f\u3063\u3066\u3044\u307e\u3059\u3002\n$ touch crash_csv_to_crash_geojson.rb\n\n\u3055\u3089\u306b\u5b9f\u884c\u6a29\u9650\u3092\u3064\u3051\u307e\u3057\u3087\u3046\u3002\n$ chmod +x crash_csv_to_crash_geojson.rb\n\n\u3053\u3046\u3059\u308b\u3068\u4ee5\u4e0b\u306e\u3088\u3046\u5b9f\u884c\u3059\u308c\u3070\u3001\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u3092\u305d\u306e\u307e\u307e\u30b3\u30de\u30f3\u30c9\u306e\u3088\u3046\u306b\u5b9f\u884c\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n$ ./crash_csv_to_crash_geojson.rb\n\n\n\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\n\u3044\u304d\u306a\u308a\u3067\u3059\u304c\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u306f\u3053\u3093\u306a\u611f\u3058\u3067\u3059\u3002\u8aac\u660e\u306f\u96e3\u3057\u3044\u306e\u3067\u8272\u3005\u8abf\u3079\u305f\u308a\u3057\u3066\u8aad\u3093\u3067\u307f\u3066\u304f\u3060\u3057\u3042\u2026\u3002\n\ncrash_csv_to_crash_geojson.rb\n#!/usr/bin/env ruby\nrequire 'csv'\nrequire 'json'\n\nmarker_colors = {\n  '\u6b7b\u4ea1\u4e8b\u6545' => '#FD7400',\n  '\u8efd\u50b7\u4e8b\u6545' => '#BEDB39',\n  '\u91cd\u50b7\u4e8b\u6545' => '#004358'\n}\n\nmap = {}\nmap['type'] = 'FeatureCollection'\nmap['features'] = []\nCSV.new(STDIN, headers:true).read.each_with_index do |row, index|\n  next if row['\u5f53\u4e8b\u8005\u7a2e\u5225'] !~ /\u81ea\u8ee2\u8eca/\n  feature = {\n    id: index,\n    type: 'Feature',\n    geometry: {\n      type: 'Point',\n      coordinates: [row['\u5730\u70b9\u7d4c\u5ea6'].to_f, row['\u5730\u70b9\u7def\u5ea6'].to_f]\n    },\n    properties: row.to_h.merge({\n      'marker-color': marker_colors[row['\u4e8b\u6545\u5185\u5bb9']]\n    })\n  }\n  map['features'] << feature\nend\n\nputs JSON.pretty_generate(map)\n\n\n\u5b9f\u884c\u3059\u308b\u306b\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u3057\u307e\u3059\u3002\n$ nkf -S -w -Lu crash26.csv.csv | ./crash_csv_to_crash_geojson.rb > tottori-opendata-bicycle-accident-2014.geojson\n\ntottori-opendata-bicycle-accident-2014.geojson\u3068\u3044\u3046\u30d5\u30a1\u30a4\u30eb\u304c\u51fa\u529b\u3055\u308c\u308b\u306f\u305a\u3067\u3059\u3002\n\n\u4e8b\u6545\u7a2e\u5225\u306b\u3088\u308b\u8272\u5206\u3051\u306b\u3064\u3044\u3066\nMapbox\u306b\u3088\u308b\u3068marker-color\u3067\u8272\u306e\u30b3\u30fc\u30c9\u3092\u6307\u5b9a\u3059\u308b\u3068\u30d4\u30f3\u306e\u8272\u3092\u5909\u66f4\u3067\u304d\u308b\u305d\u3046\u3067\u3059\u3002\n\u8272\u5206\u3051\u3059\u308b\u306b\u3042\u305f\u308a\u3001\u4e8b\u6545\u7a2e\u5225\u306e\u7a2e\u985e\u3092\u30ea\u30b9\u30c8\u30a2\u30c3\u30d7\u3057\u3066\u78ba\u8a8d\u3057\u307e\u3059\u3002\n$ nkf -w -Lu crash26.csv | column -t -s , | sed 1d | awk '{print $5}' | sort | uniq -c\n  32 \u6b7b\u4ea1\u4e8b\u6545\n 623 \u8efd\u50b7\u4e8b\u6545\n 176 \u91cd\u50b7\u4e8b\u6545\n\n\u81ea\u8ee2\u8eca\u3060\u3051\u3092\u629c\u304d\u51fa\u3059\u306a\u3089\u3053\u3046\u3002\n$ nkf -w -Lu crash26.csv | column -t -s , | sed 1d | grep '\u81ea\u8ee2\u8eca' | awk '{print $5}' | sort | uniq -c\n   6 \u6b7b\u4ea1\u4e8b\u6545\n 122 \u8efd\u50b7\u4e8b\u6545\n  65 \u91cd\u50b7\u4e8b\u6545\n\n\u8ffd\u8a18: \u3063\u3066\u306a\u3093\u304b\u6570\u304c\u3042\u308f\u306d\u3047\u3047\u3002\uff08\u203b\u30b3\u30e1\u30f3\u30c8\u6b04\u53c2\u7167\uff09\n|\u3067\u7e4b\u304c\u308c\u305f\u5404\u30b3\u30de\u30f3\u30c9\u306e\u610f\u5473\u306f\u4ee5\u4e0b\u306e\u3068\u304a\u308a\u3067\u3059\u3002\n\n\nnkf -S -w -Lu crash26.csv: \u6587\u5b57\u30b3\u30fc\u30c9\u3092Shift_JIS\u304b\u3089UTF8\u3001\u6539\u884c\u30b3\u30fc\u30c9\u3092UNIX\u5f62\u5f0f\u306b\u3057\u3066\u51fa\u529b\n\ncolumn -t -s ,: \u30ab\u30f3\u30de\u533a\u5207\u308a\u3092\u8868\u5f62\u5f0f\u306b\u5909\u63db\u3057\u3066\u51fa\u529b\n\nsed 1d: 1\u884c\u76ee\u3092\u524a\u9664\u3057\u3066\u51fa\u529b\n\ngrep '\u81ea\u8ee2\u8eca': \u81ea\u8ee2\u8eca\u304c\u542b\u307e\u308c\u308b\u884c\u3092\u62bd\u51fa\u3057\u3066\u51fa\u529b\n\nawk '{print $5}': 5\u5217\u76ee\u3092\u62bd\u51fa\u3057\u3066\u51fa\u529b\n\nsort: \u30bd\u30fc\u30c8\u3057\u3066\u51fa\u529b\n\nuniq -c: \u91cd\u8907\u3092\u6392\u9664\u3057\u3064\u3064\u305d\u308c\u305e\u308c\u306e\u91cd\u8907\u6570\u3092\u51fa\u529b\n\nMac OS X\u306e\u30bf\u30fc\u30df\u30ca\u30eb\u3084Linux\u3092\u4f7f\u3046\u4eba\u306f\u3001\u7c21\u5358\u306a\u30c7\u30fc\u30bf\u3067\u3042\u308c\u3070\u3001\u3053\u3046\u3044\u3046\u30b3\u30de\u30f3\u30c9\u3092\u7d44\u307f\u5408\u308f\u305b\u3066\u51e6\u7406\u3057\u3066\u3057\u307e\u3046\u5834\u5408\u304c\u591a\u3044\u3067\u3059\u3002\n\u3068\u3044\u3046\u3053\u3068\u3067\u30013\u7a2e\u985e\u306e\u4e8b\u6545\u304c\u3042\u308b\u3088\u3046\u306a\u306e\u3067\u30013\u8272\u306b\u8272\u5206\u3051\u3057\u307e\u3057\u305f\u3002\u8272\u306e\u9078\u5b9a\u306fAdobe Color CC\u3068\u3044\u3046\u30b5\u30a4\u30c8\u304b\u3089Vitamin C\u3068\u3044\u3046\u30c6\u30fc\u30de\u3092\u4f7f\u3046\u3053\u3068\u306b\u3057\u307e\u3057\u305f\u3002\n\u4ee5\u4e0b\u306e3\u8272\u3092\u30d4\u30c3\u30af\u30a2\u30c3\u30d7\u3002\n\n#FD7400\n#BEDB39\n#004358\n\n\u3068\u3044\u3046\u611f\u3058\u3067\u30b3\u30fc\u30c7\u30a3\u30f3\u30b0\u3057\u3066\u3042\u308a\u307e\u3059\u3002\n\nGist\u3078\u306e\u516c\u958b\nGitHub\u306eGist\u3068\u3044\u3046\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u306e\u65ad\u7247\u3092\u5171\u6709\u3059\u308b\u30b5\u30fc\u30d3\u30b9\u3067\u306f\u3001GeoJSON\u3068\u3044\u3046\u5730\u7406\u7a7a\u9593\u60c5\u5831\u3092\u8868\u73fe\u3059\u308b\u30c7\u30fc\u30bf\u5f62\u5f0f\u306e\u30c7\u30fc\u30bf\u3092\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3059\u308c\u3070Mapbox\u3068\u3044\u3046\u30b5\u30fc\u30d3\u30b9\u3068\u9023\u643a\u3057\u3066\u81ea\u52d5\u7684\u306b\u5730\u56f3\u8868\u793a\u3057\u3066\u304f\u308c\u307e\u3059\u3002\u3082\u3061\u308d\u3093Gist\u306a\u306e\u3067\u30c7\u30fc\u30bf\u306e\u5909\u66f4\u5c65\u6b74\u3082\u8ffd\u8de1\u3067\u304d\u3066\u306a\u304b\u306a\u304b\u4fbf\u5229\u3067\u3059\u3002\n\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3057\u305f\u5730\u56f3\u306f https://gist.github.com/mh61503891/a2572598fa40f5bd0c08 \u3067\u516c\u958b\u3057\u3066\u3044\u307e\u3059\u3002\u30b0\u30ea\u30b0\u30ea\u52d5\u304b\u3057\u3066\u307f\u3066\u304f\u3060\u3055\u3044\u3002\n\n\n\u304a\u308f\u308a\u306b\n\u81ea\u8ee2\u8eca\u4e8b\u6545\u306e\u767a\u751f\u5834\u6240\u3092\u898b\u308b\u3068\u3084\u3063\u3071\u308a\u4ea4\u5dee\u70b9\u304c\u591a\u3044\u611f\u3058\u3067\u3059\u306d\u3002\u5de6\u53f3\u306e\u78ba\u8a8d\u3057\u307e\u3057\u3087\u3046\u2026(\u00b4\uff65\u03c9\uff65`)\n\u3044\u308d\u3044\u308d\u30b3\u30e1\u30f3\u30c8\u3082\u52df\u96c6\u3057\u3066\u3044\u307e\u3059\u3002\u4e0b\u90e8\u306e\u30b3\u30e1\u30f3\u30c8\u6b04\u306b\u4f55\u304b\u66f8\u3044\u3066\u3082\u3089\u3048\u308b\u3068\u4f55\u304b\u8fd4\u4fe1\u3057\u307e\u3059\u3002\u5143\u6c17\u304c\u3042\u308c\u3070\u3001\u3067\u3059\u304c\u2026(\u00b4\uff65\u03c9\uff65`)\n# \u306f\u3058\u3081\u306b\n\n[\u9ce5\u53d6\u770c\u30aa\u30fc\u30d7\u30f3\u30c7\u30fc\u30bf\u30ab\u30bf\u30ed\u30b0](http://db.pref.tottori.jp/opendataResearch.nsf)\u3067\u306f[\u4ea4\u901a\u4e8b\u6545\u60c5\u5831](http://db.pref.tottori.jp/opendataResearch.nsf)\u304c\u30aa\u30fc\u30d7\u30f3\u30c7\u30fc\u30bf\u3067\u516c\u958b\u3055\u308c\u3066\u3044\u307e\u3059\u3002\n\n\u4eca\u56de\u306f\u3053\u306e\u30aa\u30fc\u30d7\u30f3\u30c7\u30fc\u30bf\u3092\u4f7f\u3063\u3066\u81ea\u8ee2\u8eca\u4e8b\u6545\u306e\u767a\u751f\u5834\u6240\u30de\u30c3\u30d7\u3092\u4f5c\u3063\u3066\u307f\u305f\u3044\u3068\u601d\u3044\u307e\u3059(\u0e51\u02c3\u0335\u1d17\u02c2\u0335)\u0648 \n\n2015\u5e746\u67081\u65e5\u306e\u9053\u8def\u4ea4\u901a\u6cd5\u6539\u6b63\u306b\u4f34\u3044\u81ea\u8ee2\u8eca\u306e\u53d6\u308a\u7de0\u307e\u308a\u3082\u53b3\u3057\u304f\u306a\u3063\u305f\u306e\u3067\u3001\u3069\u3093\u306a\u5834\u6240\u3067\u81ea\u8ee2\u8eca\u4e8b\u6545\u304c\u8d77\u3053\u3063\u3066\u3044\u308b\u306e\u304b\u6c17\u306b\u306a\u308b\u3068\u3053\u308d\u3067\u3059\u3002\n\n\u307e\u305a\u306f\u5148\u306b\u3001\u5b8c\u6210\u3057\u305f\u30de\u30c3\u30d7\u306e\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8\u3092\u304a\u898b\u305b\u3057\u307e\u3059\u3002\n\n![image](https://qiita-image-store.s3.amazonaws.com/0/32894/15bc6656-a2ee-2ece-b3a1-c2dabdb81f29.png)\n\n\u3053\u3093\u306a\u611f\u3058\u3067\u3059\u3002\n\n\u5e73\u621026\u5e74\u5ea6\u306b\u767a\u751f\u3057\u305f\u81ea\u8ee2\u8eca\u306b\u95a2\u3059\u308b\u4e8b\u6545\u306e\u5834\u6240\u3092\u3001\n\n- \u6b7b\u4ea1\u4e8b\u6545\n- \u8efd\u50b7\u4e8b\u6545\n- \u91cd\u50b7\u4e8b\u6545\n\n\u306b\u8272\u5206\u3051\u3057\u3066\u3042\u308a\u307e\u3059\u3002\n\n\u3053\u306e\u5730\u56f3\u306fGist\u3067\u516c\u958b https://gist.github.com/mh61503891/a2572598fa40f5bd0c08 \u3057\u3066\u3044\u307e\u3059\u3002\u5730\u56f3\u306f\u3082\u3061\u308d\u3093\u62e1\u5927\u7e2e\u5c0f\u3057\u305f\u308a\u52d5\u304b\u305b\u307e\u3059(`\uff65\u03c9\uff65\u00b4)\n\n\u30d4\u30f3\u3092\u30af\u30ea\u30c3\u30af\u3059\u308b\u3068\u8a73\u7d30\u60c5\u5831\u3082\u307f\u3089\u308c\u307e\u3059\u3002\n\n<img src=\"https://qiita-image-store.s3.amazonaws.com/0/32894/63ff4f42-322a-b7b2-a86e-3e3877131088.png\" width=\"320\">\n\n\u3055\u3066\u4eca\u56de\u306f\u3001\u3053\u306e\u4f5c\u308a\u65b9\u3092\u7c21\u5358\u306b\u8aac\u660e\u3057\u305f\u3044\u3068\u601d\u3044\u307e\u3059\u3002\u4e3b\u306a\u8aad\u8005\u306f\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u3092\u59cb\u3081\u305f\u3066\u65b9\u3092\u60f3\u5b9a\u3057\u3064\u3064\u3001\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306e\u524d\u6bb5\u968e\u306eUnix\u7cfb\u306e\u30b3\u30de\u30f3\u30c9\u306e\u4f7f\u3044\u65b9\u3092\u3082\u308d\u3082\u308d\u30e1\u30e2\u3057\u3066\u3044\u307e\u3059\u3002\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u3055\u308c\u306a\u3044\u65b9\u3067\u3082\u96f0\u56f2\u6c17\u306f\u4f1d\u308f\u308b\u304b\u3068\u601d\u3044\u307e\u3059\u3002\n\n# \u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\n\n## \u74b0\u5883\n\n- OS: Mac OS X\n- \u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u8a00\u8a9e: [Ruby](https://www.ruby-lang.org/ja/)\n- \u30c6\u30ad\u30b9\u30c8\u30a8\u30c7\u30a3\u30bf: [Atom](https://atom.io/)\n\n\u3068\u3044\u3046\u611f\u3058\u3067\u3059\u3002\n\n## \u4f5c\u696d\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306e\u4f5c\u6210\u3068\u79fb\u52d5\n\n```bash\n$ mkdir bicycle-accident && cd $_\n```\n\n`mkdir`\u30b3\u30de\u30f3\u30c9\u3067\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092\u4f5c\u6210\u3057\u3066`cd $_`\u30b3\u30de\u30f3\u30c9\u3067`$_`\u3092\u6307\u5b9a\u3059\u308b\u3068`mkdir`\u3057\u305f\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u79fb\u52d5\u3067\u304d\u307e\u3059\u3002`&&`\u306f\u524d\uff08\u5de6\uff09\u306e\u30b3\u30de\u30f3\u30c9\u304c\u6210\u529f\u3057\u305f\u5834\u5408\u306b\u6b21\uff08\u53f3\uff09\u306e\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3059\u308b\u3068\u3044\u3046\u610f\u5473\u3067\u3059\u3002\n\n## \u73fe\u5728\u306e\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306e\u78ba\u8a8d\n\n```bash\n$ pwd\n/Users/masayuki/bicycle-accident\n```\n\n## \u30c7\u30fc\u30bf\u306e\u53d6\u5f97\n\n[\u4ea4\u901a\u4e8b\u6545\u60c5\u5831](http://db.pref.tottori.jp/opendataResearch.nsf)\u3067\u306f\u3001\n\n- \u4ea4\u901a\u4e8b\u6545-(\u5e73\u621024\u5e74).csv\n- \u4ea4\u901a\u4e8b\u6545-(\u5e73\u621025\u5e74).csv\n- \u4ea4\u901a\u4e8b\u6545-(\u5e73\u621026\u5e74).csv\n\n\u304c\u516c\u958b\u3055\u308c\u3066\u3044\u308b\u3088\u3046\u306a\u306e\u3067\u3001\u3068\u308a\u3042\u3048\u305a\u3053\u308c\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3057\u307e\u3059\u3002\n\n```bash\n$ wget 'http://db.pref.tottori.jp/opendataResearch.nsf/e92cd7f95a94c9c249257c92000236b8/5c2a1f59ec27a81a49257d630016cf34/$FILE/%E4%BA%A4%E9%80%9A%E4%BA%8B%E6%95%85-(%E5%B9%B3%E6%88%9024%E5%B9%B4).csv' -O crash24.csv\n$ wget 'http://db.pref.tottori.jp/opendataResearch.nsf/e92cd7f95a94c9c249257c92000236b8/5c2a1f59ec27a81a49257d630016cf34/$FILE/%E4%BA%A4%E9%80%9A%E4%BA%8B%E6%95%85-(%E5%B9%B3%E6%88%9025%E5%B9%B4).csv' -O crash25.csv \n$ wget 'http://db.pref.tottori.jp/opendataResearch.nsf/e92cd7f95a94c9c249257c92000236b8/5c2a1f59ec27a81a49257d630016cf34/$FILE/%E4%BA%A4%E9%80%9A%E4%BA%8B%E6%95%85-(%E5%B9%B3%E6%88%9026%E5%B9%B4).csv' -O crash26.csv\n```\n\n- \u30e1\u30e2\n    - `wget`: \u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3059\u308b\u30b3\u30de\u30f3\u30c9\n    - `-O`: \u4fdd\u5b58\u5148\u306e\u30d5\u30a1\u30a4\u30eb\u540d\u3092\u6307\u5b9a\u3059\u308b\u30aa\u30d7\u30b7\u30e7\u30f3\n\n## \u30d5\u30a1\u30a4\u30eb\u4e00\u89a7\n\n```bash\n$ ls\ncrash24.csv crash25.csv crash26.csv\n```\n\n## \u6587\u5b57\u30b3\u30fc\u30c9\u306e\u78ba\u8a8d\n\n`nkf`\u30b3\u30de\u30f3\u30c9\u306b`--guess`\u30aa\u30d7\u30b7\u30e7\u30f3\u3092\u4ed8\u3051\u308b\u3068\u6587\u5b57\u30b3\u30fc\u30c9\u3092\u5224\u5b9a\u3057\u3066\u304f\u308c\u307e\u3059\u3002\u3053\u306e\u7d50\u679c\u306b\u3088\u308b\u3068\u6587\u5b57\u30b3\u30fc\u30c9\u306f`Shift_JIS`\u3067\u6539\u884c\u30b3\u30fc\u30c9\u306f`CRLF`\u306e\u3088\u3046\u3067\u3059\u3002\n\n```bash\n$ nkf --guess crash24.csv \nShift_JIS (CRLF)\n$ nkf --guess crash25.csv \nShift_JIS (CRLF)\n$ nkf --guess crash26.csv \nShift_JIS (CRLF)\n```\n\n`ls`\u30b3\u30de\u30f3\u30c9\u306e\u6a19\u6e96\u51fa\u529b\u3092\u30d1\u30a4\u30d7\uff08`|`\uff09\u3067`xargs`\u30b3\u30de\u30f3\u30c9\u306b\u6e21\u305b\u30701\u884c\u306e\u30b3\u30de\u30f3\u30c9\u3067\u5168\u3066\u306e\u30d5\u30a1\u30a4\u30eb\u306e\u6587\u5b57\u30b3\u30fc\u30c9\u3092\u78ba\u8a8d\u3067\u304d\u307e\u3059\u3002\n\n```bash\n$ ls | xargs nkf --guess\ncrash24.csv: Shift_JIS (CRLF)\ncrash25.csv: Shift_JIS (CRLF)\ncrash26.csv: Shift_JIS (CRLF)\n```\n\n\u30d5\u30a1\u30a4\u30eb\u3092\u7d5e\u308a\u8fbc\u307f\u305f\u3044\u5834\u5408\u306f`ls`\u30b3\u30de\u30f3\u30c9\u3088\u308a\u3082`find`\u30b3\u30de\u30f3\u30c9\u3092\u4f7f\u3063\u305f\u65b9\u304c\u4fbf\u5229\u3067\u3059\u3002\n\n```bash\n$ find . -name \"crash*.csv\" | xargs nkf --guess\n./crash24.csv: Shift_JIS (CRLF)\n./crash25.csv: Shift_JIS (CRLF)\n./crash26.csv: Shift_JIS (CRLF)\n```\n\n## \u30c7\u30fc\u30bf\u306e\u4e2d\u8eab\u306e\u78ba\u8a8d\n\nMac OS X\u3067\u3042\u308c\u3070\u3001\u30c7\u30d5\u30a9\u30eb\u30c8\u306e\u8a2d\u5b9a\u3060\u3068`nkf`\u30b3\u30de\u30f3\u30c9\u306e\u51fa\u529b\u306fUTF-8\u3078\u5909\u63db\u3055\u308c\u3066\u3067\u3066\u304d\u307e\u3059\u3002\u3053\u308c\u306e\u5148\u982d\u306e\u6570\u884c\u3092\u8868\u793a\u3057\u3066\u307f\u307e\u3059\u3002\u30d1\u30a4\u30d7\uff08`|`\uff09\u3092\u4f7f\u3063\u3066`head`\u30b3\u30de\u30f3\u30c9\u306b\u6e21\u305b\u3070OK\u3067\u3059\u3002\n\n```bash\n$ nkf crash26.csv | head\n\u540d\u79f0,\u767a\u751f\u5834\u6240,\u767a\u751f\u5e74\u6708\u65e5,\u5f53\u4e8b\u8005\u7a2e\u5225,\u4e8b\u6545\u5185\u5bb9,\u6240\u8f44\u8b66\u5bdf\u7f72,\u4e8b\u6545\u985e\u578b,\u5730\u70b9\u7d4c\u5ea6,\u5730\u70b9\u7def\u5ea6\n\u5168\u4e8b\u6545,\u6771\u4f2f\u90e1\u7434\u6d66\u753a\u5927\u5b57\u51fa\u4e0a,2013/10/30,\u8efd\u8ca8\u7269\u00d7\u76f8\u624b\u306a\u3057,\u91cd\u50b7\u4e8b\u6545,\u516b\u6a4b\u7f72,\u8eca\u4e21\u5358\u72ec,133.63196416700,35.50113361110\n\u5168\u4e8b\u6545,\u9ce5\u53d6\u5e02\u4e09\u5c71\u53e3,2013/11/03,\u666e\u901a\u4e57\u7528\u00d7\u7269\u4ef6\u7b49,\u91cd\u50b7\u4e8b\u6545,\u9ce5\u53d6\u7f72,\u8eca\u4e21\u5358\u72ec,134.15423333300,35.48269722220\n\u5168\u4e8b\u6545,\u7c73\u5b50\u5e02\u897f\u798f\u539f\u4e00\u4e01\u76ee,2013/11/21,\u666e\u901a\u4e57\u7528\u00d7\u666e\u901a\u4e57\u7528,\u8efd\u50b7\u4e8b\u6545,\u7c73\u5b50\u7f72,\u8eca\u4e21\u76f8\u4e92,133.34055833300,35.43853611110\n\u5168\u4e8b\u6545,\u9ce5\u53d6\u5e02\u5b89\u9577,2013/11/23,\u666e\u901a\u4e57\u7528\u00d7\u81ea\u8ee2\u8eca,\u91cd\u50b7\u4e8b\u6545,\u9ce5\u53d6\u7f72,\u8eca\u4e21\u76f8\u4e92,134.20791666700,35.51267777780\n\u5168\u4e8b\u6545,\u9ce5\u53d6\u5e02\u5409\u65b9\u6e29\u6cc9\uff14\u4e01\u76ee,2013/11/25,\u666e\u901a\u4e57\u7528\u00d7\u8efd\u4e57\u7528\u00d7\u666e\u901a\u4e57\u7528,\u8efd\u50b7\u4e8b\u6545,\u9ce5\u53d6\u7f72,\u8eca\u4e21\u76f8\u4e92,134.23786388900,35.48967222220\n\u5168\u4e8b\u6545,\u897f\u4f2f\u90e1\u5357\u90e8\u753a\u963f\u8cc0,2013/11/26,\u666e\u901a\u4e57\u7528\u00d7\u666e\u901a\u4e57\u7528,\u8efd\u50b7\u4e8b\u6545,\u7c73\u5b50\u7f72,\u8eca\u4e21\u76f8\u4e92,133.33130555600,35.36158611110\n\u5168\u4e8b\u6545,\u7c73\u5b50\u5e02\u4e0a\u798f\u539f,2013/12/06,\u666e\u901a\u4e57\u7528\u00d7\u81ea\u8ee2\u8eca,\u8efd\u50b7\u4e8b\u6545,\u7c73\u5b50\u7f72,\u8eca\u4e21\u76f8\u4e92,133.35246388900,35.44394166670\n\u5168\u4e8b\u6545,\u7c73\u5b50\u5e02\u5b97\u50cf,2013/12/09,\u666e\u901a\u8ca8\u7269\u00d7\u8efd\u4e57\u7528,\u8efd\u50b7\u4e8b\u6545,\u7c73\u5b50\u7f72,\u8eca\u4e21\u76f8\u4e92,133.35307222200,35.41546388890\n\u5168\u4e8b\u6545,\u7c73\u5b50\u5e02\u65e5\u30ce\u51fa\u753a\u4e8c\u4e01\u76ee,2013/12/12,\u8efd\u8ca8\u7269\u00d7\u81ea\u8ee2\u8eca,\u8efd\u50b7\u4e8b\u6545,\u7c73\u5b50\u7f72,\u8eca\u4e21\u76f8\u4e92,133.33639027800,35.43667555560\n```\n\n\u3069\u3046\u3084\u30891\u884c\u76ee\u306f\u5217\u306e\u610f\u5473\u3092\u8868\u3059\u884c\u306b\u306a\u3063\u3066\u3044\u308b\u3088\u3046\u3067\u3059\u3002\u3053\u306e\u884c\u306f\u3042\u3063\u305f\u65b9\u304c\u4fbf\u5229\u306a\u306e\u3067\u6bd4\u8f03\u7684\u826f\u3044\u30c7\u30fc\u30bf\u69cb\u9020\u3067\u52a9\u304b\u308a\u307e\u3059|\uff65\u03c9\uff65\u00b4)\n\n`column`\u30b3\u30de\u30f3\u30c9\u3092\u4f7f\u3063\u3066\u3082\u3046\u5c11\u3057\u898b\u3084\u3059\u304f\u3057\u3066\u307e\u3057\u3087\u3046\u3002\n`-t`\u30aa\u30d7\u30b7\u30e7\u30f3\u306f\u5217\u6570\u3092\u81ea\u52d5\u5224\u5b9a\u3057\u3066\u304f\u308c\u307e\u3059\u3002`-s`\u30aa\u30d7\u30b7\u30e7\u30f3\u306f\u533a\u5207\u308a\u6587\u5b57\u3092\u6307\u5b9a\u3057\u307e\u3059\u3002\u3053\u306e\u30c7\u30fc\u30bf\u306f\u30ab\u30f3\u30de\u533a\u5207\u308a\u306a\u306e\u3067`,`\u3092\u6307\u5b9a\u3057\u3066\u3044\u307e\u3059\u3002\u30d1\u30a4\u30d7\uff08`|`\uff09\u3067`nkf`\u30b3\u30de\u30f3\u30c9\u3068`head`\u30b3\u30de\u30f3\u30c9\u306e\u9593\u306b\u631f\u3093\u3067\u3084\u308c\u3070\u3001\u305d\u308c\u305e\u308c\u306e\u30b3\u30de\u30f3\u30c9\u304c\u30d5\u30a3\u30eb\u30bf\u30fc\u306e\u3088\u3046\u306b\u30c7\u30fc\u30bf\u3092\u6574\u5f62\u3057\u3066\u53d7\u3051\u6e21\u3057\u3066\u304f\u308c\u307e\u3059\u3002UNIX\u54f2\u5b66\u3068\u3044\u3046\u3084\u3064\u3067\u3059\u3002\n\n```bash\n$ nkf crash26.csv | column -t -s , | head\n\u540d\u79f0        \u767a\u751f\u5834\u6240                  \u767a\u751f\u5e74\u6708\u65e5  \u5f53\u4e8b\u8005\u7a2e\u5225                                  \u4e8b\u6545\u5185\u5bb9  \u6240\u8f44\u8b66\u5bdf\u7f72  \u4e8b\u6545\u985e\u578b  \u5730\u70b9\u7d4c\u5ea6         \u5730\u70b9\u7def\u5ea6\n\u5168\u4e8b\u6545      \u6771\u4f2f\u90e1\u7434\u6d66\u753a\u5927\u5b57\u51fa\u4e0a      2013/10/30  \u8efd\u8ca8\u7269\u00d7\u76f8\u624b\u306a\u3057                             \u91cd\u50b7\u4e8b\u6545  \u516b\u6a4b\u7f72      \u8eca\u4e21\u5358\u72ec  133.63196416700  35.50113361110\n\u5168\u4e8b\u6545      \u9ce5\u53d6\u5e02\u4e09\u5c71\u53e3              2013/11/03  \u666e\u901a\u4e57\u7528\u00d7\u7269\u4ef6\u7b49                             \u91cd\u50b7\u4e8b\u6545  \u9ce5\u53d6\u7f72      \u8eca\u4e21\u5358\u72ec  134.15423333300  35.48269722220\n\u5168\u4e8b\u6545      \u7c73\u5b50\u5e02\u897f\u798f\u539f\u4e00\u4e01\u76ee        2013/11/21  \u666e\u901a\u4e57\u7528\u00d7\u666e\u901a\u4e57\u7528                           \u8efd\u50b7\u4e8b\u6545  \u7c73\u5b50\u7f72      \u8eca\u4e21\u76f8\u4e92  133.34055833300  35.43853611110\n\u5168\u4e8b\u6545      \u9ce5\u53d6\u5e02\u5b89\u9577                2013/11/23  \u666e\u901a\u4e57\u7528\u00d7\u81ea\u8ee2\u8eca                             \u91cd\u50b7\u4e8b\u6545  \u9ce5\u53d6\u7f72      \u8eca\u4e21\u76f8\u4e92  134.20791666700  35.51267777780\n\u5168\u4e8b\u6545      \u9ce5\u53d6\u5e02\u5409\u65b9\u6e29\u6cc9\uff14\u4e01\u76ee      2013/11/25  \u666e\u901a\u4e57\u7528\u00d7\u8efd\u4e57\u7528\u00d7\u666e\u901a\u4e57\u7528                    \u8efd\u50b7\u4e8b\u6545  \u9ce5\u53d6\u7f72      \u8eca\u4e21\u76f8\u4e92  134.23786388900  35.48967222220\n\u5168\u4e8b\u6545      \u897f\u4f2f\u90e1\u5357\u90e8\u753a\u963f\u8cc0          2013/11/26  \u666e\u901a\u4e57\u7528\u00d7\u666e\u901a\u4e57\u7528                           \u8efd\u50b7\u4e8b\u6545  \u7c73\u5b50\u7f72      \u8eca\u4e21\u76f8\u4e92  133.33130555600  35.36158611110\n\u5168\u4e8b\u6545      \u7c73\u5b50\u5e02\u4e0a\u798f\u539f              2013/12/06  \u666e\u901a\u4e57\u7528\u00d7\u81ea\u8ee2\u8eca                             \u8efd\u50b7\u4e8b\u6545  \u7c73\u5b50\u7f72      \u8eca\u4e21\u76f8\u4e92  133.35246388900  35.44394166670\n\u5168\u4e8b\u6545      \u7c73\u5b50\u5e02\u5b97\u50cf                2013/12/09  \u666e\u901a\u8ca8\u7269\u00d7\u8efd\u4e57\u7528                             \u8efd\u50b7\u4e8b\u6545  \u7c73\u5b50\u7f72      \u8eca\u4e21\u76f8\u4e92  133.35307222200  35.41546388890\n\u5168\u4e8b\u6545      \u7c73\u5b50\u5e02\u65e5\u30ce\u51fa\u753a\u4e8c\u4e01\u76ee      2013/12/12  \u8efd\u8ca8\u7269\u00d7\u81ea\u8ee2\u8eca                               \u8efd\u50b7\u4e8b\u6545  \u7c73\u5b50\u7f72      \u8eca\u4e21\u76f8\u4e92  133.33639027800  35.43667555560\n```\n\n\u307f\u3084\u3059\u304f\u306a\u308a\u307e\u3057\u305f|\uff65\u03c9\uff65\u00b4)\n\n## \u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\n\n\u30c7\u30fc\u30bf\u306e\u78ba\u8a8d\u304c\u3067\u304d\u305f\u3068\u3053\u308d\u3067\u3001\u3044\u3088\u3044\u3088GeoJSON\u3078\u5909\u63db\u3059\u308b\u30d7\u30ed\u30b0\u30e9\u30e0\u3092\u4f5c\u308a\u307e\u3057\u3087\u3046\u3002\n\n## \u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u306e\u30d5\u30a1\u30a4\u30eb\u306e\u4f5c\u6210\n\n\u7a7a\u306e\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u6210\u3059\u308b\u306b\u306f`touch`\u3092\u4f7f\u3044\u307e\u3059\u3002\u307e\u3042\u4ed6\u306e\u65b9\u6cd5\u3067\u3082\u826f\u3044\u306e\u3067\u3059\u304c\u79c1\u306f\u3053\u308c\u3092\u3088\u304f\u4f7f\u3063\u3066\u3044\u307e\u3059\u3002\n\n```bash\n$ touch crash_csv_to_crash_geojson.rb\n```\n\n\u3055\u3089\u306b\u5b9f\u884c\u6a29\u9650\u3092\u3064\u3051\u307e\u3057\u3087\u3046\u3002\n\n```\n$ chmod +x crash_csv_to_crash_geojson.rb\n```\n\n\u3053\u3046\u3059\u308b\u3068\u4ee5\u4e0b\u306e\u3088\u3046\u5b9f\u884c\u3059\u308c\u3070\u3001\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u3092\u305d\u306e\u307e\u307e\u30b3\u30de\u30f3\u30c9\u306e\u3088\u3046\u306b\u5b9f\u884c\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n```\n$ ./crash_csv_to_crash_geojson.rb\n```\n\n## \u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\n\n\u3044\u304d\u306a\u308a\u3067\u3059\u304c\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u306f\u3053\u3093\u306a\u611f\u3058\u3067\u3059\u3002\u8aac\u660e\u306f\u96e3\u3057\u3044\u306e\u3067\u8272\u3005\u8abf\u3079\u305f\u308a\u3057\u3066\u8aad\u3093\u3067\u307f\u3066\u304f\u3060\u3057\u3042\u2026\u3002\n\n```crash_csv_to_crash_geojson.rb\n#!/usr/bin/env ruby\nrequire 'csv'\nrequire 'json'\n\nmarker_colors = {\n  '\u6b7b\u4ea1\u4e8b\u6545' => '#FD7400',\n  '\u8efd\u50b7\u4e8b\u6545' => '#BEDB39',\n  '\u91cd\u50b7\u4e8b\u6545' => '#004358'\n}\n\nmap = {}\nmap['type'] = 'FeatureCollection'\nmap['features'] = []\nCSV.new(STDIN, headers:true).read.each_with_index do |row, index|\n  next if row['\u5f53\u4e8b\u8005\u7a2e\u5225'] !~ /\u81ea\u8ee2\u8eca/\n  feature = {\n    id: index,\n    type: 'Feature',\n    geometry: {\n      type: 'Point',\n      coordinates: [row['\u5730\u70b9\u7d4c\u5ea6'].to_f, row['\u5730\u70b9\u7def\u5ea6'].to_f]\n    },\n    properties: row.to_h.merge({\n      'marker-color': marker_colors[row['\u4e8b\u6545\u5185\u5bb9']]\n    })\n  }\n  map['features'] << feature\nend\n\nputs JSON.pretty_generate(map)\n```\n\n\u5b9f\u884c\u3059\u308b\u306b\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u3057\u307e\u3059\u3002\n\n```bash\n$ nkf -S -w -Lu crash26.csv.csv | ./crash_csv_to_crash_geojson.rb > tottori-opendata-bicycle-accident-2014.geojson\n```\n\n`tottori-opendata-bicycle-accident-2014.geojson`\u3068\u3044\u3046\u30d5\u30a1\u30a4\u30eb\u304c\u51fa\u529b\u3055\u308c\u308b\u306f\u305a\u3067\u3059\u3002\n\n## \u4e8b\u6545\u7a2e\u5225\u306b\u3088\u308b\u8272\u5206\u3051\u306b\u3064\u3044\u3066\n\nMapbox\u306b\u3088\u308b\u3068`marker-color`\u3067\u8272\u306e\u30b3\u30fc\u30c9\u3092\u6307\u5b9a\u3059\u308b\u3068\u30d4\u30f3\u306e\u8272\u3092\u5909\u66f4\u3067\u304d\u308b\u305d\u3046\u3067\u3059\u3002\n\n\u8272\u5206\u3051\u3059\u308b\u306b\u3042\u305f\u308a\u3001\u4e8b\u6545\u7a2e\u5225\u306e\u7a2e\u985e\u3092\u30ea\u30b9\u30c8\u30a2\u30c3\u30d7\u3057\u3066\u78ba\u8a8d\u3057\u307e\u3059\u3002\n\n```bash\n$ nkf -w -Lu crash26.csv | column -t -s , | sed 1d | awk '{print $5}' | sort | uniq -c\n  32 \u6b7b\u4ea1\u4e8b\u6545\n 623 \u8efd\u50b7\u4e8b\u6545\n 176 \u91cd\u50b7\u4e8b\u6545\n```\n\n\u81ea\u8ee2\u8eca\u3060\u3051\u3092\u629c\u304d\u51fa\u3059\u306a\u3089\u3053\u3046\u3002\n\n```bash\n$ nkf -w -Lu crash26.csv | column -t -s , | sed 1d | grep '\u81ea\u8ee2\u8eca' | awk '{print $5}' | sort | uniq -c\n   6 \u6b7b\u4ea1\u4e8b\u6545\n 122 \u8efd\u50b7\u4e8b\u6545\n  65 \u91cd\u50b7\u4e8b\u6545\n```\n\n\u8ffd\u8a18: \u3063\u3066\u306a\u3093\u304b\u6570\u304c\u3042\u308f\u306d\u3047\u3047\u3002\uff08\u203b\u30b3\u30e1\u30f3\u30c8\u6b04\u53c2\u7167\uff09\n\n`|`\u3067\u7e4b\u304c\u308c\u305f\u5404\u30b3\u30de\u30f3\u30c9\u306e\u610f\u5473\u306f\u4ee5\u4e0b\u306e\u3068\u304a\u308a\u3067\u3059\u3002\n\n- `nkf -S -w -Lu crash26.csv`: \u6587\u5b57\u30b3\u30fc\u30c9\u3092Shift_JIS\u304b\u3089UTF8\u3001\u6539\u884c\u30b3\u30fc\u30c9\u3092UNIX\u5f62\u5f0f\u306b\u3057\u3066\u51fa\u529b\n- `column -t -s ,`: \u30ab\u30f3\u30de\u533a\u5207\u308a\u3092\u8868\u5f62\u5f0f\u306b\u5909\u63db\u3057\u3066\u51fa\u529b\n- `sed 1d`: 1\u884c\u76ee\u3092\u524a\u9664\u3057\u3066\u51fa\u529b\n- `grep '\u81ea\u8ee2\u8eca'`: \u81ea\u8ee2\u8eca\u304c\u542b\u307e\u308c\u308b\u884c\u3092\u62bd\u51fa\u3057\u3066\u51fa\u529b\n- `awk '{print $5}'`: 5\u5217\u76ee\u3092\u62bd\u51fa\u3057\u3066\u51fa\u529b\n- `sort`: \u30bd\u30fc\u30c8\u3057\u3066\u51fa\u529b\n- `uniq -c`: \u91cd\u8907\u3092\u6392\u9664\u3057\u3064\u3064\u305d\u308c\u305e\u308c\u306e\u91cd\u8907\u6570\u3092\u51fa\u529b\n\nMac OS X\u306e\u30bf\u30fc\u30df\u30ca\u30eb\u3084Linux\u3092\u4f7f\u3046\u4eba\u306f\u3001\u7c21\u5358\u306a\u30c7\u30fc\u30bf\u3067\u3042\u308c\u3070\u3001\u3053\u3046\u3044\u3046\u30b3\u30de\u30f3\u30c9\u3092\u7d44\u307f\u5408\u308f\u305b\u3066\u51e6\u7406\u3057\u3066\u3057\u307e\u3046\u5834\u5408\u304c\u591a\u3044\u3067\u3059\u3002\n\n\u3068\u3044\u3046\u3053\u3068\u3067\u30013\u7a2e\u985e\u306e\u4e8b\u6545\u304c\u3042\u308b\u3088\u3046\u306a\u306e\u3067\u30013\u8272\u306b\u8272\u5206\u3051\u3057\u307e\u3057\u305f\u3002\u8272\u306e\u9078\u5b9a\u306f[Adobe Color CC](https://color.adobe.com)\u3068\u3044\u3046\u30b5\u30a4\u30c8\u304b\u3089[Vitamin C](https://color.adobe.com/Vitamin-C-color-theme-492199/)\u3068\u3044\u3046\u30c6\u30fc\u30de\u3092\u4f7f\u3046\u3053\u3068\u306b\u3057\u307e\u3057\u305f\u3002\n\n\u4ee5\u4e0b\u306e3\u8272\u3092\u30d4\u30c3\u30af\u30a2\u30c3\u30d7\u3002\n\n- `#FD7400`\n- `#BEDB39`\n- `#004358`\n\n\u3068\u3044\u3046\u611f\u3058\u3067\u30b3\u30fc\u30c7\u30a3\u30f3\u30b0\u3057\u3066\u3042\u308a\u307e\u3059\u3002\n\n## Gist\u3078\u306e\u516c\u958b\n\nGitHub\u306eGist\u3068\u3044\u3046\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u306e\u65ad\u7247\u3092\u5171\u6709\u3059\u308b\u30b5\u30fc\u30d3\u30b9\u3067\u306f\u3001GeoJSON\u3068\u3044\u3046\u5730\u7406\u7a7a\u9593\u60c5\u5831\u3092\u8868\u73fe\u3059\u308b\u30c7\u30fc\u30bf\u5f62\u5f0f\u306e\u30c7\u30fc\u30bf\u3092\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3059\u308c\u3070[Mapbox](https://www.mapbox.com/)\u3068\u3044\u3046\u30b5\u30fc\u30d3\u30b9\u3068\u9023\u643a\u3057\u3066\u81ea\u52d5\u7684\u306b\u5730\u56f3\u8868\u793a\u3057\u3066\u304f\u308c\u307e\u3059\u3002\u3082\u3061\u308d\u3093Gist\u306a\u306e\u3067\u30c7\u30fc\u30bf\u306e\u5909\u66f4\u5c65\u6b74\u3082\u8ffd\u8de1\u3067\u304d\u3066\u306a\u304b\u306a\u304b\u4fbf\u5229\u3067\u3059\u3002\n\n\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3057\u305f\u5730\u56f3\u306f https://gist.github.com/mh61503891/a2572598fa40f5bd0c08 \u3067\u516c\u958b\u3057\u3066\u3044\u307e\u3059\u3002\u30b0\u30ea\u30b0\u30ea\u52d5\u304b\u3057\u3066\u307f\u3066\u304f\u3060\u3055\u3044\u3002\n\n![image](https://qiita-image-store.s3.amazonaws.com/0/32894/15bc6656-a2ee-2ece-b3a1-c2dabdb81f29.png)\n\n## \u304a\u308f\u308a\u306b\n\n\u81ea\u8ee2\u8eca\u4e8b\u6545\u306e\u767a\u751f\u5834\u6240\u3092\u898b\u308b\u3068\u3084\u3063\u3071\u308a\u4ea4\u5dee\u70b9\u304c\u591a\u3044\u611f\u3058\u3067\u3059\u306d\u3002\u5de6\u53f3\u306e\u78ba\u8a8d\u3057\u307e\u3057\u3087\u3046\u2026(\u00b4\uff65\u03c9\uff65`)\n\n\u3044\u308d\u3044\u308d\u30b3\u30e1\u30f3\u30c8\u3082\u52df\u96c6\u3057\u3066\u3044\u307e\u3059\u3002\u4e0b\u90e8\u306e\u30b3\u30e1\u30f3\u30c8\u6b04\u306b\u4f55\u304b\u66f8\u3044\u3066\u3082\u3089\u3048\u308b\u3068\u4f55\u304b\u8fd4\u4fe1\u3057\u307e\u3059\u3002\u5143\u6c17\u304c\u3042\u308c\u3070\u3001\u3067\u3059\u304c\u2026(\u00b4\uff65\u03c9\uff65`)\n", "tags": ["opendata", "JSON", "Ruby", "JavaScript", "GitHub"]}