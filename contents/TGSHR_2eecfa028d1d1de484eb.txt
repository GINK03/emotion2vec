{"context": "\n\n\u4eca\u56de\u306e\u5185\u5bb9\n\u524d\u56de\u306e\u8a18\u4e8b\u3067\uff0c\u30da\u30c3\u30c8\u306e\u30ad\u30e3\u30f3\u30c7\u30a3\u30fc\u914d\u7f6e\u3092\u6700\u9069\u5316\u3059\u308b\u305f\u3081\u306b\u554f\u984c\u3092\u6570\u5f0f\u3068\u3057\u3066\u66f8\u304d\u4e0b\u3059\uff08\u5b9a\u5f0f\u5316\u3059\u308b\uff09\u3068\u3053\u308d\u307e\u3067\u884c\u3044\u307e\u3057\u305f\uff0e\n\u4eca\u56de\u306f\uff0c\u5b9f\u969b\u306b\u30b3\u30fc\u30c9\u3092\u66f8\u3044\u3066\u554f\u984c\u3092\u89e3\u304f\u3068\u3053\u308d\u307e\u3067\u884c\u3044\u307e\u3059\uff0e\n\u4f7f\u7528\u8a00\u8a9e\u306fPython2.x\u7cfb\u3067\uff0c\u4e3b\u306b\u4f7f\u7528\u3059\u308b\u5916\u90e8\u30e2\u30b8\u30e5\u30fc\u30eb\u306fPuLP\u3067\u3059\uff0e\nPython\u3084PuLP\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u65b9\u6cd5\u306a\u3069\u306f\u4ee5\u4e0b\u306e\u30da\u30fc\u30b8\u3092\u53c2\u8003\u306b\u3057\u3066\u4e0b\u3055\u3044\uff08\u65e5\u672c\u8a9e\u304c\u3044\u3044\u5834\u5408\u306f\u691c\u7d22\u3059\u308b\u3068\u3059\u3050\u51fa\u3066\u304d\u307e\u3059\uff09\uff0e\n* https://www.python.org/\n* https://github.com/coin-or/pulp\n\nPuLP\u3068\u306f\nGitHub\u306e\u30da\u30fc\u30b8\u306b\u3082\u3042\u308a\u307e\u3059\u304c\uff0cPython\u3067\u66f8\u304b\u308c\u305f\u7dda\u5f62\u8a08\u753b\u30e2\u30c7\u30e9\u3067\u3059\uff08\u3068\u3044\u3044\u3064\u3064\u6574\u6570\u5909\u6570\u3082\u6271\u3048\u308b\u305f\u3081\u3001\u6574\u6570\u8a08\u753b\u3001\u6df7\u5408\u6574\u6570\u8a08\u753b\u3082\u3044\u3051\u307e\u3059\uff09\uff0e\n\u3064\u307e\u308a\uff0c\u524d\u56de\u306e\u8a18\u4e8b\u3067\u66f8\u3044\u305f\u3088\u3046\u306a\u5b9a\u5f0f\u5316\u3092\uff0c\u5b9f\u969b\u306b\u30bd\u30eb\u30d0\u30fc\uff08\u6700\u9069\u5316\u554f\u984c\u3092\u89e3\u3044\u3066\u304f\u308c\u308b\u30d7\u30ed\u30b0\u30e9\u30e0\uff0c\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\uff09\u306b\u89e3\u304b\u305b\u308b\u305f\u3081\u306b\u5206\u304b\u308b\u5f62\u3067\u8a18\u8ff0\u3057\u3066\u3084\u308b\uff08\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\uff09\u305f\u3081\u306e\u3082\u306e\u3067\u3059\uff0e\n\u3068\u3044\u3046\u3053\u3068\u306f\uff0c\u30bd\u30eb\u30d0\u30fc\u306f\u5225\u9014\u7528\u610f\u3057\u306a\u3051\u308c\u3070\u306a\u3089\u306a\u3044\u306f\u305a\u3067\u3059\u304c\uff0c\u5b9f\u306fPuLP\u306f\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u305f\u6642\u70b9\u3067\u4f7f\u3048\u308b\u30bd\u30eb\u30d0\u30fc\u304c\u7528\u610f\u3055\u308c\u3066\u3044\u308b\u305f\u3081\uff0c\u4eca\u56de\u306e\u3088\u3046\u306a\u5c0f\u898f\u6a21\u306a\u554f\u984c\u3092\u89e3\u304f\u306e\u306b\u306f\u305d\u306e\u30c7\u30d5\u30a9\u30eb\u30c8\u306e\u30bd\u30eb\u30d0\u30fc\u3067\u554f\u984c\u3042\u308a\u307e\u305b\u3093\uff0e\n\u3082\u3061\u308d\u3093\uff0c\u81ea\u524d\u3067\u7528\u610f\u3057\u305f\u30bd\u30eb\u30d0\u30fc\u3092\u6307\u5b9a\u3057\u3066\u89e3\u304f\u3053\u3068\u3082\u3067\u304d\u307e\u3059\uff08\u30bd\u30eb\u30d0\u30fc\u306e\u6307\u5b9a\u65b9\u6cd5\u306a\u3069\u306f\u30de\u30cb\u30e5\u30a2\u30eb\u3092\u53c2\u7167\u3057\u3066\u4e0b\u3055\u3044\uff09\uff0e\u5b66\u8853\u6a5f\u95a2\u306b\u6240\u5c5e\u3055\u308c\u3066\u3044\u308b\u65b9\u306f\u5546\u7528\u6700\u901f\u306eGurobi\u3068\u3044\u3046\u30bd\u30eb\u30d0\u30fc\u304c\u7121\u6599\u3067\u4f7f\u3048\u308b\u3057\u5727\u5012\u7684\u306b\u901f\u3044\u3068\u601d\u308f\u308c\u307e\u3059\uff0e\u30e2\u30c7\u30ea\u30f3\u30b0\u3082gurobipy\u3068\u3044\u3046\u5c02\u7528\u306e\u30e2\u30b8\u30e5\u30fc\u30eb\u304c\u7528\u610f\u3055\u308c\u3066\u304a\u308a\uff0c\u30e2\u30c7\u30ea\u30f3\u30b0\u81ea\u4f53\u3082PuLP\u3092\u7d4c\u7531\u3057\u3066Gurobi\u3092\u547c\u3073\u51fa\u3059\u3088\u308a\u9ad8\u901f\u3067\u3059\uff0e\n\n\u524d\u56de\u306e\u5b9a\u5f0f\u5316\u304a\u3055\u3089\u3044\n\u524d\u56de\u306e\u5b9a\u5f0f\u5316\u306f\u4ee5\u4e0b\u306e\u69d8\u306a\u3082\u306e\u3067\u3057\u305f\uff0e\nmaximizesubject\u00a0to\u2211i\u2208I\u2211j\u2208J\u2211p\u2208Pvpxijpxijp\u2264aijp\u2211k\u2208I\u2211l\u2208J\u2211p\u2208Pcijklpxklp\u22641bp\u2264\u2211i\u2208I\u2211j\u2208Jxijp\u2264np\u2211i\u2208I\u2211j\u2208J\u2211p\u2208Psxijp\u2264msxijp\u2208{0,1}\u2200i\u2208I,j\u2208J,p\u2208P\u2200i\u2208I,j\u2208J\u2200p\u2208P\u2200s\u2208S\u2200i\u2208I,j\u2208J,p\u2208Pmaximize\u2211i\u2208I\u2211j\u2208J\u2211p\u2208Pvpxijpsubject\u00a0toxijp\u2264aijp\u2200i\u2208I,j\u2208J,p\u2208P\u2211k\u2208I\u2211l\u2208J\u2211p\u2208Pcklpijxklp\u22641\u2200i\u2208I,j\u2208Jbp\u2264\u2211i\u2208I\u2211j\u2208Jxijp\u2264np\u2200p\u2208P\u2211i\u2208I\u2211j\u2208J\u2211p\u2208Psxijp\u2264ms\u2200s\u2208Sxijp\u2208{0,1}\u2200i\u2208I,j\u2208J,p\u2208P{\\begin{align}\n\\mathbb{maximize} & & \\sum_{i \\in I} \\sum_{j \\in J} \\sum_{p \\in P} v_{p} x_{ijp} & \\\\\n\\mathbb{subject \\ to} & & x_{ijp} \\leq a_{ijp} & & \\forall i \\in I, j \\in J, p \\in P \\\\\n& & \\sum_{k \\in I} \\sum_{l \\in J} \\sum_{p \\in P} c_{klp}^{ij} x_{klp} \\leq 1 & & \\forall i \\in I, j \\in J \\\\\n& & b_{p} \\leq \\sum_{i \\in I} \\sum_{j \\in J} x_{ijp} \\leq n_{p} & & \\forall p \\in P \\\\\n& & \\sum_{i \\in I} \\sum_{j \\in J} \\sum_{p \\in P_{s}} x_{ijp} \\leq m_{s} & & \\forall s \\in S \\\\\n& &  x_{ijp} \\in \\{ 0, 1 \\} & & \\forall i \\in I, j \\in J, p \\in P \\\\\n\\end{align}\n}\n\n\u30d7\u30ed\u30b0\u30e9\u30e0\n\u3067\u306f\uff0c\u5b9f\u969b\u306b\u30b3\u30fc\u30c9\u3092\u66f8\u3044\u3066\u89e3\u3044\u3066\u3044\u304d\u305f\u3044\u3068\u601d\u3044\u307e\u3059\uff0e\n\u305b\u3063\u304b\u304f\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u6307\u5411\u8a00\u8a9e\u3092\u4f7f\u3063\u3066\u3044\u307e\u3059\u304c\uff0c\u6d41\u308c\u304c\u308f\u304b\u308a\u3084\u3059\u3044\u3068\u601d\u3046\u306e\u3067\u4eca\u56de\u306f\u30af\u30e9\u30b9\u5316\u3057\u305f\u308a\u3057\u306a\u3044\u3067\u66f8\u3044\u3066\u3044\u307e\u3059\uff0e\u5b9f\u969b\u306b\u306f\uff0c\u30ad\u30e3\u30f3\u30c7\u30a3\u30fc\u30dc\u30c3\u30af\u30b9\u306a\u3069\u306f\u30af\u30e9\u30b9\u5316\u3057\u305f\u65b9\u304c\u304b\u306a\u308a\u6271\u3044\u3084\u3059\u3044\u3068\u601d\u3044\u307e\u3059\uff0e\n\n\u30e2\u30b8\u30e5\u30fc\u30eb\u6e96\u5099\n\u307e\u305a\uff0c\u30e2\u30b8\u30e5\u30fc\u30eb\u306a\u3069\u3092\u8aad\u307f\u8fbc\u3093\u3067\u304a\u304d\u307e\u3059\uff0e\nfuture\u306f\uff08\u4e3b\u306b\u79c1\u304c\uff09\u306e\u3061\u306e\u3061Python3\u7cfb\u306b\u79fb\u884c\u3059\u308b\u3068\u304d\u306e\u305f\u3081\u306b\u5099\u3048\u3066\u3044\u308b\u3082\u306e\u3067\u3059\uff08\u3064\u307e\u308a\u306a\u304f\u3066\u3082\u3088\u3044\u3067\u3059\uff09\uff0e\nrepoze.lru\u306b\u3064\u3044\u3066\u306f\uff0c\u5f8c\u3067\u51fa\u3066\u304f\u308b\u95a2\u6570\u306e\u9ad8\u901f\u5316\u306e\u305f\u3081\u306b\u4f7f\u3063\u3066\u3044\u307e\u3059\uff08\u306a\u304f\u3066\u3082\u52d5\u304d\u307e\u3059\u304c\uff0c\u3042\u308b\u3068\u901f\u3044\u306e\u3067\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u3066\u304a\u304f\u3053\u3068\u3092\u304a\u3059\u3059\u3081\u3057\u307e\u3059\uff09\uff0e\n# -*- coding: utf-8 -*-\nfrom __future__ import unicode_literals, print_function\nfrom repoze.lru import lru_cache\nfrom pulp import *\n\n\n\u30c7\u30fc\u30bf\u306e\u6e96\u5099\n\u30ad\u30e3\u30f3\u30c7\u30a3\u30fc\u3084\u30ad\u30e3\u30f3\u30c7\u30a3\u30fc\u30dc\u30c3\u30af\u30b9\u306a\u3069\u306e\u30c7\u30fc\u30bf\u3092\u7528\u610f\u3057\u307e\u3059\uff0e\n\n\u30ad\u30e3\u30f3\u30c7\u30a3\u30fc\u30dc\u30c3\u30af\u30b9\n# \u30ef\u30f3\u30c0\u306e\u30ad\u30e3\u30f3\u30c7\u30a3\u30fc\u30dc\u30c3\u30af\u30b9\u30020\u304c\u30ad\u30e3\u30f3\u30c7\u30a3\u30fc\u3092\u7f6e\u3051\u308b\u5834\u6240\u30011\u304c\u7f6e\u3051\u306a\u3044\u5834\u6240\ncandy_box = [[1, 0, 0, 1, 1, 1, 0, 1],\n             [0, 0, 0, 0, 0, 0, 0, 0],\n             [0, 1, 0, 0, 0, 0, 0, 1],\n             [0, 1, 0, 0, 0, 0, 0, 0],\n             [0, 0, 0, 0, 0, 0, 1, 0],\n             [1, 0, 0, 0, 0, 0, 1, 0],\n             [0, 0, 0, 0, 0, 0, 0, 0],\n             [1, 0, 1, 1, 1, 0, 0, 1]]\n\ncandy_box\u306f\u305d\u306e\u307e\u307e\uff0c\u4eca\u56de\u89e3\u304d\u305f\u3044\u30da\u30c3\u30c8\u306e\u30ad\u30e3\u30f3\u30c7\u30a3\u30fc\u30dc\u30c3\u30af\u30b9\u306e\u30c7\u30fc\u30bf\u3067\u3059\uff0e\n\u4ed6\u306e\u30da\u30c3\u30c8\u306e\u5834\u5408\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u306e\u3067\uff0c\u89e3\u304d\u305f\u3044\u30da\u30c3\u30c8\u306e\u3082\u306e\u306b\u5165\u308c\u66ff\u3048\u308c\u3070\u89e3\u3051\u307e\u3059\uff0e\n trim = [[1, 0, 0, 0, 0, 1, 1, 1],\n        [0, 0, 0, 0, 0, 0, 1, 0],\n        [0, 0, 0, 0, 0, 0, 0, 0],\n        [0, 0, 0, 0, 0, 0, 0, 1],\n        [0, 0, 0, 0, 0, 1, 0, 0],\n        [1, 0, 0, 0, 1, 1, 1, 0],\n        [1, 1, 0, 0, 0, 1, 0, 0],\n        [1, 0, 0, 1, 0, 0, 0, 0]]\nsally = [[1, 1, 0, 1, 1, 0, 1, 1],\n         [0, 0, 0, 0, 0, 0, 0, 0],\n         [0, 1, 0, 0, 0, 0, 1, 0],\n         [0, 0, 0, 0, 0, 0, 0, 0],\n         [0, 0, 0, 0, 0, 0, 0, 0],\n         [0, 0, 1, 0, 0, 1, 0, 0],\n         [0, 0, 0, 1, 1, 0, 0, 0],\n         [1, 1, 0, 0, 0, 0, 1, 1]]\nmarron = [[0, 0, 0, 1, 1, 0, 0, 1],\n          [0, 1, 0, 0, 0, 0, 1, 1],\n          [0, 1, 0, 0, 0, 0, 0, 0],\n          [0, 0, 0, 0, 0, 0, 0, 1],\n          [1, 0, 0, 0, 0, 0, 0, 0],\n          [0, 0, 0, 0, 0, 0, 1, 0],\n          [1, 1, 0, 0, 0, 0, 1, 0],\n          [1, 0, 0, 1, 1, 0, 0, 0]]\nmelon = [[1, 1, 0, 1, 0, 0, 0, 0],\n         [0, 1, 0, 0, 0, 1, 1, 0],\n         [0, 0, 0, 0, 0, 0, 0, 0],\n         [1, 0, 0, 0, 0, 0, 0, 1],\n         [1, 0, 0, 0, 0, 0, 0, 1],\n         [0, 0, 0, 0, 0, 0, 0, 0],\n         [0, 1, 1, 0, 0, 0, 1, 0],\n         [0, 0, 0, 0, 1, 0, 1, 1]]\nrappy = [[0, 1, 0, 0, 0, 0, 1, 0],\n         [0, 1, 0, 0, 0, 0, 1, 0],\n         [0, 0, 0, 0, 0, 0, 0, 0],\n         [0, 1, 0, 0, 0, 0, 1, 0],\n         [1, 0, 1, 0, 0, 1, 0, 1],\n         [0, 1, 0, 0, 0, 0, 1, 0],\n         [0, 0, 0, 1, 1, 0, 0, 0],\n         [0, 0, 0, 1, 1, 0, 0, 0]]\nviola = [[0, 1, 1, 0, 1, 0, 0, 0],\n         [0, 1, 0, 0, 0, 0, 1, 0],\n         [0, 1, 0, 0, 0, 0, 0, 1],\n         [0, 0, 0, 0, 0, 0, 0, 1],\n         [1, 0, 0, 0, 0, 0, 0, 0],\n         [1, 0, 0, 0, 0, 0, 1, 0],\n         [0, 1, 0, 0, 0, 0, 1, 0],\n         [0, 0, 0, 1, 0, 1, 1, 0]]\n\n\n\n\u30ad\u30e3\u30f3\u30c7\u30a3\u30fc\n# \u30ad\u30e3\u30f3\u30c7\u30a3\u30fc\u306e\u4e00\u89a7\u3002\u8f9e\u66f8\u306e\u8f9e\u66f8\u5f62\u5f0f\u3002\u540d\u524d\u3001height\u3001width\u3001profit\u306f\u5fc5\u9808\u3001min_set\u3001max_set\u306f\u4efb\u610f \ncandies = {\"blast_parfait\": {\"height\": 2, \"width\": 2, \"profit\": 100, \"min_set\": 0},\n           \"megaton_parfait\": {\"height\": 2, \"width\": 2, \"profit\": 100, \"min_set\": 0},\n           \"hissatsu_parfait\": {\"height\": 2, \"width\": 2, \"profit\": 100, \"min_set\": 0},\n           \"pittari_parfait\": {\"height\": 2, \"width\": 2, \"profit\": 100, \"min_set\": 0},\n           \"gamushara_parfait\": {\"height\": 2, \"width\": 2, \"profit\": 100, \"min_set\": 0},\n           \"harikiri_parfait\": {\"height\": 2, \"width\": 2, \"profit\": 100, \"min_set\": 0},\n           \"girigiri_roll\": {\"height\": 2, \"width\": 2, \"profit\": 50, \"min_set\": 0},\n           \"funbari_roll\": {\"height\": 2, \"width\": 2, \"profit\": 50, \"min_set\": 0},\n           \"ouen_roll\": {\"height\": 2, \"width\": 2, \"profit\": 50, \"min_set\": 0},\n           \"muteki_roll\": {\"height\": 2, \"width\": 2, \"profit\": 50, \"min_set\": 0},\n           \"shikkari_roll\": {\"height\": 2, \"width\": 2, \"profit\": 50, \"min_set\": 0},\n           \"henkan_roll\": {\"height\": 2, \"width\": 2, \"profit\": 50, \"min_set\": 0},\n           \"migawari_roll\": {\"height\": 2, \"width\": 2, \"profit\": 50, \"min_set\": 0},\n           \"tsuyogari_roll\": {\"height\": 2, \"width\": 2, \"profit\": 50, \"min_set\": 0},\n           \"stamina_cookie\": {\"height\": 2, \"width\": 2, \"profit\": 30, \"min_set\": 0},\n           \"spirita_cookie\": {\"height\": 2, \"width\": 2, \"profit\": 30, \"min_set\": 0},\n           \"power_cookie\": {\"height\": 2, \"width\": 2, \"profit\": 30, \"min_set\": 0},\n           \"shoot_cookie\": {\"height\": 2, \"width\": 2, \"profit\": 30, \"min_set\": 0},\n           \"technique_cookie\": {\"height\": 2, \"width\": 2, \"profit\": 30, \"min_set\": 0},\n           \"arm_cookie\": {\"height\": 2, \"width\": 2, \"profit\": 30, \"min_set\": 0},\n           \"1stage_pancake\": {\"height\": 2, \"width\": 2, \"profit\": 20, \"min_set\": 0},\n           \"2stage_pancake\": {\"height\": 2, \"width\": 2, \"profit\": 25, \"min_set\": 0},\n           \"3stage_pancake\": {\"height\": 2, \"width\": 2, \"profit\": 30, \"min_set\": 0},\n           \"honoono_ramune\": {\"height\": 1, \"width\": 1, \"profit\": 1,  \"min_set\": 0},\n           \"koorino_ramune\": {\"height\": 1, \"width\": 1, \"profit\": 1,  \"min_set\": 0},\n           \"kaminarino_ramune\": {\"height\": 1, \"width\": 1, \"profit\": 1, \"min_set\": 0},\n           \"kazeno_ramune\": {\"height\": 1, \"width\": 1, \"profit\": 1, \"min_set\": 0},\n           \"hikarino_ramune\": {\"height\": 1, \"width\": 1, \"profit\": 1, \"min_set\": 0},\n           \"yamino_ramune\": {\"height\": 1, \"width\": 1, \"profit\": 1, \"min_set\": 0},\n           \"richna_crepe\": {\"height\": 2, \"width\": 2, \"profit\": 20, \"min_set\": 0},\n           \"otonano_crepe\": {\"height\": 2, \"width\": 2, \"profit\": 20, \"min_set\": 0},\n           \"lucky_crepe\": {\"height\": 2, \"width\": 2, \"profit\": 20, \"min_set\": 0},\n           \"spirita_candy\": {\"height\": 1, \"width\": 4, \"profit\": 15, \"min_set\": 0},\n           \"brow_resist_candy\": {\"height\": 1, \"width\": 4, \"profit\": 15, \"min_set\": 0},\n           \"shot_resist_candy\": {\"height\": 1, \"width\": 4, \"profit\": 15, \"min_set\": 0},\n           \"mind_resist_candy\": {\"height\": 1, \"width\": 4, \"profit\": 15, \"min_set\": 0},\n           \"ability_candy\": {\"height\": 1, \"width\": 4, \"profit\": 15, \"min_set\": 0},\n           \"body_sand\": {\"height\": 1, \"width\": 2, \"profit\": 10, \"min_set\": 0},\n           \"react_sand\": {\"height\": 1, \"width\": 2, \"profit\": 10, \"min_set\": 0},\n           \"mind_sand\": {\"height\": 1, \"width\": 2, \"profit\": 10, \"min_set\": 0},\n           \"stamina_gmi\": {\"height\": 1, \"width\": 1, \"profit\": 1, \"min_set\": 0, \"max_set\": 20}\n           }\n# \u30ad\u30e3\u30f3\u30c7\u30a3\u30fc\u306e\u30bf\u30a4\u30d7\u3054\u3068\u306e\u914d\u7f6e\u6570\u4e0a\u9650\nmax_set_by_types = {'parfait': 2, 'roll': 2, 'cookie': 3, 'pancake': 2,\n                    'ramune': 1, 'crepe': 1, 'candy': 4, 'sand': 5, 'gmi': 20}\n\n\u89e3\u304f\u4e0a\u3067\u81ea\u5206\u304c\u8003\u616e\u3057\u305f\u3044\u30ad\u30e3\u30f3\u30c7\u30a3\u30fc\u306e\u4e00\u89a7\u3092\u66f8\u3044\u3066\u304a\u304d\u307e\u3059\uff0e\u5fc5\u8981\u306b\u5fdc\u3058\u3066\u5c11\u306a\u304f\u3059\u308b\u3068\u826f\u3044\u3067\u3057\u3087\u3046\uff0e\n\u305d\u308c\u305e\u308c\u306e\u30ad\u30e3\u30f3\u30c7\u30a3\u30fc\u306e\u540d\u524d\u306f\u306a\u3093\u3067\u3082\u826f\u3044\u306e\u3067\u3059\u304c\uff0c\u7a2e\u985e\u540d\u300c\uff3fgmi\u300d\u3084\u300c\uff3framune\u300d\u306a\u3069\u306e\u53f3\u306e\u300c\uff3f\u300d\u4ee5\u964d\u306e\u90e8\u5206\u306f\uff0cmax_set_by_types\u306b\u66f8\u3044\u3066\u3042\u308b\u30ad\u30e3\u30f3\u30c7\u30a3\u30fc\u306e\u7a2e\u985e\uff089\u7a2e\u985e\uff09\u306e\u4f55\u308c\u304b\u6b63\u3057\u3044\u7a2e\u985e\u3092\u4ed8\u3051\u3066\u304a\u3044\u3066\u4e0b\u3055\u3044\uff0e\n\n\u697d\u3092\u3059\u308b\u305f\u3081\u306e\u6e96\u5099\n\u5f8c\u3067\u697d\u3092\u3059\u308b\u305f\u3081\u306b\uff0c\u4e0a\u8a18\u30c7\u30fc\u30bf\u304b\u3089\u52a0\u5de5\u3057\u3066\u3067\u304d\u308b\u30c7\u30fc\u30bf\u3084\uff0c\u95a2\u6570\u3092\u5b9a\u7fa9\u3057\u3066\u304a\u304d\u307e\u3059\uff0e\n# \u30ad\u30e3\u30f3\u30c7\u30a3\u30fc\u30dc\u30c3\u30af\u30b9\u3067\u914d\u7f6e\u53ef\u80fd\uff080\uff09\u306a\u5ea7\u6a19\u306e\u30ea\u30b9\u30c8\nsettable_pos = [(i, j) for i in xrange(len(candy_box)) for j in xrange(len(candy_box[i])) if candy_box[i][j] < .5]\n\n@lru_cache(64 * 64)\ndef is_settable(i=0, j=0, height=1, width=1):\n    \"\"\"i\u884c\u76ee\u3001j\u5217\u76ee\u306e\u30de\u30b9\u3092\u5de6\u4e0a\u306e\u70b9\u3068\u3057\u3066\u3001\u6307\u5b9a\u306e\u5927\u304d\u3055\u306e\u30ad\u30e3\u30f3\u30c7\u30a3\u30fc\u3092\u30bb\u30c3\u30c8\u3067\u304d\u308b\u304b\u3069\u3046\u304b\u3092\u8fd4\u3059\n    :param i: \u30ad\u30e3\u30f3\u30c7\u30a3\u30fc\u3092\u30bb\u30c3\u30c8\u3059\u308b\u6700\u3082\u5de6\u4e0a\u306e\u30de\u30b9\u306e\u884c\u756a\u53f7\n    :param j: \u30ad\u30e3\u30f3\u30c7\u30a3\u30fc\u3092\u30bb\u30c3\u30c8\u3059\u308b\u6700\u3082\u5de6\u4e0a\u306e\u30de\u30b9\u306e\u5217\u756a\u53f7\n    :param height: \u30bb\u30c3\u30c8\u3057\u305f\u3044\u30ad\u30e3\u30f3\u30c7\u30a3\u30fc\u306e\u7e26\u306e\u9577\u3055\n    :param width: \u30bb\u30c3\u30c8\u3057\u305f\u3044\u30ad\u30e3\u30f3\u30c7\u30a3\u30fc\u306e\u6a2a\u306e\u9577\u3055\n    :return: \u30bb\u30c3\u30c8\u53ef\u80fd\uff08True\uff09\u304b\u30bb\u30c3\u30c8\u4e0d\u53ef\u80fd\uff08False\uff09\u304b\n    \"\"\"\n    global candy_box\n    try:\n        return 0 == sum(candy_box[i + k][j + l] for k in xrange(height) for l in xrange(width))\n    except Exception:\n        return False\n\n\nsettable_pos\u306f\uff0c\u30ad\u30e3\u30f3\u30c7\u30a3\u30fc\u30dc\u30c3\u30af\u30b9\u306b\u304a\u3044\u3066\u30ad\u30e3\u30f3\u30c7\u30a3\u30fc\u3092\u914d\u7f6e\u53ef\u80fd\u306a\u5ea7\u6a19(i,j)(i,j)(i, j)\u306e\u30ea\u30b9\u30c8\u3067\u3059\uff0e\n\n\n\u4f8b\u3048\u3070\u30ef\u30f3\u30c0\u306e\u5834\u5408\uff0c[(0, 1), (0, 2), (0, 6), ...]\u3068\u306a\u3063\u3066\u3044\u307e\u3059\uff0e \n\n\nis_settable\u306f\uff0c\u30ad\u30e3\u30f3\u30c7\u30a3\u30fc\u30dc\u30c3\u30af\u30b9\u306e\u5ea7\u6a19(i,j)(i,j)(i, j)\u3092\u5de6\u4e0a\u306e\u70b9\u3068\u3057\u3066\uff0c\u7e26\u306e\u9577\u3055height\uff0c\u6a2a\u306e\u9577\u3055width\u306e\u5927\u304d\u3055\u306e\u30ad\u30e3\u30f3\u30c7\u30a3\u30fc\u3092\u914d\u7f6e\u53ef\u80fd\u304b\u3069\u3046\u304b\u3092\u5224\u5b9a\u3059\u308b\u95a2\u6570\u3067\u3059\uff0e\n\n\n\u914d\u7f6e\u53ef\u80fd\u306a\u3089True\uff0c\u305d\u3046\u3067\u306a\u3051\u308c\u3070False\u3092\u8fd4\u3057\u307e\u3059\uff0e\n\n\n\n\n\u30e2\u30c7\u30eb\u306e\u4f5c\u6210\n\u3067\u306f\u3044\u3088\u3044\u3088\u6570\u5f0f\u3092\u8868\u73fe\u3057\u3066\u3044\u304d\u307e\u3059\uff0e\u307e\u305a\u306f\uff0c\u30e2\u30c7\u30eb\u81ea\u4f53\u3092\u8868\u3059LpProblem\u30af\u30e9\u30b9\u306e\u30aa\u30d6\u30b8\u30a7\u30af\u30c8model\u3092\u751f\u6210\u3057\u3066\u304a\u304d\u307e\u3059\uff0e\n# \u6700\u9069\u5316\u554f\u984c\u306e\u30e2\u30c7\u30eb\u4f5c\u6210\u3002\u4fa1\u5024\u306e\u5408\u8a08\u306e\u6700\u5927\u5316\u304c\u76ee\u7684\nmodel = LpProblem('SetCandyProblem', LpMaximize)\n\n\n'SetCandyProblem'\u3068\u3044\u3046\u306e\u306f\u30e2\u30c7\u30eb\u306e\u540d\u524d\u3067\uff0c\u4efb\u610f\u306e\u6587\u5b57\u5217\u3067\u3059\uff0e\nLpMaximize\u3068\u3044\u3046\u306e\u306f\uff0c\u4eca\u56de\u306e\u76ee\u7684\u95a2\u6570\u304c\u6700\u5927\u5316\u3067\u3042\u308b\u3053\u3068\u3092\u793a\u3057\u3066\u3044\u307e\u3059\uff0e\u6700\u5c0f\u5316\u306a\u3089LpMinimize\u3067\u3059\uff0e\n\u3053\u308c\u4ee5\u964d\uff0c\u3053\u306emodel\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306b\u5bfe\u3057\u3066\u5236\u7d04\u3092\u8ffd\u52a0\u3057\u305f\u308a\u76ee\u7684\u95a2\u6570\u3092\u8ffd\u52a0\u3057\u3066\u3044\u304d\u307e\u3059\uff0e\n\n\n\u5909\u6570\u306e\u4f5c\u6210\n\u5909\u6570\u3092\u8868\u3059\u30af\u30e9\u30b9LpVariable\u306e\u30aa\u30d6\u30b8\u30a7\u30af\u30c8x[i, j, p]\u3092\u751f\u6210\u3057\u3066\u304a\u304d\u307e\u3059\uff0e\n# \u5909\u6570x\u306e\u4f5c\u6210\nx = {}\nfor i, j in settable_pos:\n    for name, candy in candies.iteritems():\n        if is_settable(i, j, candy['height'], candy['width']):\n            # 0-1\u5909\u6570\u3068\u3057\u3066\u5b9a\u7fa9\n            x[i, j, name] = LpVariable('x_({},{},{})'.format(i, j, name), cat=LpBinary)\n        else:\n            # \u305d\u3082\u305d\u3082\u914d\u7f6e\u4e0d\u53ef\u80fd\u306a\u5834\u5408\u306f\u5909\u6570\u3068\u3057\u3066\u5b9a\u7fa9\u3057\u306a\u3044\uff08\uff1d\u89e3\u304d\u3084\u3059\u304f\u306a\u308b\uff09\n            # \u3055\u3089\u306b\u3001\u3053\u3046\u3057\u3066\u304a\u304f\u30681\u756a\u76ee\u306e\u5236\u7d04\u3092\u66f8\u304b\u306a\u304f\u3066\u3088\u304f\u306a\u308b\n            x[i, j, name] = 0\n\n\u3053\u3053\u3067\uff0cLpVariable()\u306b\u6e21\u3057\u3066\u3044\u308b\u5f15\u6570\u306e\u5185\u524d\u8005\u306f\u305d\u306e\u5909\u6570\u306e\u540d\u524d\uff0c\u5f8c\u8005\u306f\u7a2e\u985e\u3092\u8868\u3057\u3066\u304a\u308a\uff0cLpBinary\u3068\u306f\u305d\u306e\u540d\u306e\u901a\u308a0-1\u5909\u6570\u3092\u610f\u5473\u3057\u307e\u3059\uff0e\n\u540d\u524d\u306f\u6307\u5b9a\u3057\u306a\u3044\u5834\u5408\u306f\u9069\u5f53\u306a\u540d\u524d\u304c\u4ed8\u3051\u3089\u308c\u308b\u305f\u3081\uff0c\u7701\u7565\u53ef\u80fd\u3067\u3059\uff0e\n\u30c7\u30d5\u30a9\u30eb\u30c8\u306e\u7a2e\u985e\u306f\u9023\u7d9a\u5909\u6570\uff08LpContinuous\uff09\u306e\u305f\u3081\uff0c\u9023\u7d9a\u5909\u6570\u306e\u5834\u5408\u306f\u7701\u7565\u53ef\u80fd\u3067\u3059\uff0e\n\u305d\u306e\u4ed6\uff0c\u9023\u7d9a\u5909\u6570\u3084\u6574\u6570\u5909\u6570\uff08LpInteger\uff09\u306e\u5834\u5408\u306b\u306f\uff0c\u305d\u306e\u5909\u6570\u306e\u4e0a\u9650\uff08upBound\uff0c\u30c7\u30d5\u30a9\u30eb\u30c8\u306fNone\u3067\u7121\u9650\u5927\uff09\uff0c\u4e0b\u9650\uff08lowBound\uff0c\u30c7\u30d5\u30a9\u30eb\u30c8\u306fNone\u3067\u8ca0\u306e\u7121\u9650\u5927\uff09\u3092\u6307\u5b9a\u3059\u308b\u3053\u3068\u3082\u3067\u304d\u307e\u3059\uff0e\n\n2\u756a\u76ee\u306e\u5236\u7d04\n\u30ad\u30e3\u30f3\u30c7\u30a3\u30fc\u30dc\u30c3\u30af\u30b9\u306e\u3042\u308b\u5ea7\u6a19(i,j)(i,j)(i,j)\u306b\u7f6e\u3051\u308b\u30ad\u30e3\u30f3\u30c7\u30a3\u30fc\u306f1\u3064\u306e\u307f\u3067\u3042\u308b\u5236\u7d04\u3092\u8ffd\u52a0\u3057\u307e\u3059\uff0e\nlin_expressions = {(i, j): LpAffineExpression() for i, j in settable_pos}\nfor i, j in settable_pos:\n    for name, candy in candies.iteritems():\n        if not is_settable(i, j, candy['height'], candy['width']):\n            continue\n        for k in xrange(candy['height']):\n            for l in xrange(candy['width']):\n                lin_expressions[i + k, j + l] += x[i, j, name]\nfor pos, lhs in lin_expressions.iteritems():\n    model += lhs <= 1, 'OnlySetConstraint:{}'.format(pos)\n\n\u3053\u3053\u3067\u306f\uff0c\u5236\u7d04\u306f(i,j)(i,j)(i,j)\u306e\u7dcf\u3066\u306e\u7d44\u5408\u305b\u306b\u5bfe\u3057\u3066\u5b58\u5728\u3059\u308b\u305f\u3081\uff0c\u307e\u305a\u5404\u7d44\u5408\u305b\u306b\u5bfe\u3057\u3066\u7dda\u5f62\u5f0f\u3092\u8868\u3059\uff08\u7dda\u5f62\u8868\u73fe\uff09LpAffineExpression\u30af\u30e9\u30b9\u306e\u30aa\u30d6\u30b8\u30a7\u30af\u30c8lin_expressions[i, j]\u3092\u751f\u6210\u3057\u3066\u3044\u307e\u3059\uff0e\u3053\u308c\u306f\uff0c2\u756a\u76ee\u306e\u5236\u7d04\u306e\u5de6\u8fba\u3092\u8868\u3059\u305f\u3081\u306e\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3067\u3059\uff0e\n\u305d\u306e\u5f8c\uff0c\u5168\u3066\u306e\u5909\u6570\u306b\u5bfe\u3057\u3066\u7740\u76ee\u3057\uff0c\u305d\u306e\u5909\u6570\u304c1\uff08\u3064\u307e\u308a\u30ad\u30e3\u30f3\u30c7\u30a3\u30fc\u3092\u914d\u7f6e\u3059\u308b\uff09\u306b\u306a\u3063\u305f\u5834\u5408\u306b\u5c02\u6709\u3059\u308b\u5ea7\u6a19(i+k,j+l)(i+k,j+l)(i+k, j+l)\u306e\u7dda\u5f62\u8868\u73fe\u306b\u305d\u306e\u5909\u6570\u3092\u8ffd\u52a0\u6307\u5b9a\u307e\u3059\uff0e\n\u6700\u5f8c\u306b\uff0c\u5404\u5236\u7d04\u306e\u5de6\u8fba\u306e\u4f5c\u6210\u304c\u7d42\u308f\u3063\u305f\u6bb5\u968e\u3067\uff0c\u305d\u308c\u304c1\u4ee5\u4e0b\u3067\u3042\u308b\uff08lhs <= 1\uff09\u3068\u3044\u3046\u5236\u7d04\u3092\u30e2\u30c7\u30eb\u306b\u8ffd\u52a0\u3057\u3066\u3044\u307e\u3059\uff0e\u300c'OnlySetConstraint:{}'.format(pos)\u300d\u3068\u3044\u3046\u306e\u306f\uff0c\u305d\u306e\u5236\u7d04\u306e\u540d\u524d\u3092\u8868\u3057\u3066\u3044\u307e\u3059\u304c\uff0c\u306a\u304f\u3066\u3082\u9069\u5f53\u306a\u540d\u524d\u304c\u4ed8\u3051\u3089\u308c\u307e\u3059\uff0e\n\n3\u756a\u76ee\u306e\u5236\u7d04\uff08\u5de6\u5074\uff09\n\u30ad\u30e3\u30f3\u30c7\u30a3\u30fc\u30dc\u30c3\u30af\u30b9\u5168\u4f53\u3067\u30ad\u30e3\u30f3\u30c7\u30a3\u30fcppp\u306e\u914d\u7f6e\u500b\u6570\u306f\u6700\u4f4e\u500b\u6570\u4ee5\u4e0a\u3067\u3042\u308b\u3068\u3044\u3046\u5236\u7d04\u3092\u8ffd\u52a0\u3057\u307e\u3059\uff0e\nfor name, candy in candies.iteritems():\n    if candy.get('min_set', 0) <= 0:\n        continue\n    model += lpSum(x[i, j, name] for i, j in settable_pos) >= candy['min_set'], 'MinSetConstraint:{}'.format(name)\n\n\u3053\u308c\u306f\u308f\u304b\u308a\u3084\u3059\u3044\u3067\u3059\u306d\uff0e\n\u30ad\u30e3\u30f3\u30c7\u30a3\u30fc\u3054\u3068\u306bfor\u6587\u3092\u56de\u3057\uff0c\u5bfe\u8c61\u30ad\u30e3\u30f3\u30c7\u30a3\u30fc\u306b\u95a2\u3059\u308b\u5909\u6570\u5168\u3066\u3092\u8db3\u3057\u305f\u3082\u306e\uff08\u3064\u307e\u308a\u30ad\u30e3\u30f3\u30c7\u30a3\u30fc\u3092\u914d\u7f6e\u3059\u308b\u500b\u6570\uff09\u304c\u4e0b\u9650\uff08candy['min_set']\uff09\u4ee5\u4e0a\u3067\u3042\u308b\u3053\u3068\u3092\u8868\u3057\u3066\u3044\u307e\u3059\uff0e\n\n3\u756a\u76ee\u306e\u5236\u7d04\uff08\u53f3\u5074\uff09\n\u540c\u69d8\u306b\uff0c\u30ad\u30e3\u30f3\u30c7\u30a3\u30fc\u30dc\u30c3\u30af\u30b9\u5168\u4f53\u3067\u30ad\u30e3\u30f3\u30c7\u30a3\u30fcppp\u306e\u914d\u7f6e\u500b\u6570\u306f\u4e0a\u9650\u4ee5\u4e0b\u3067\u3042\u308b\u3068\u3044\u3046\u5236\u7d04\u3092\u8ffd\u52a0\u3057\u307e\u3059\uff0e\nfor name, candy in candies.iteritems():\n    if candy.get('max_set') is None:\n        if name.endswith('_parfait'):\n            # \u30d1\u30d5\u30a7\u3060\u3051\u306f\u4e0a\u96501\u3067\u6c7a\u307e\u3063\u3066\u3044\u308b\n            model += lpSum(x[i, j, name] for i, j in settable_pos) <= 1, 'MaxSetConstraint:{}'.format(name)\n        continue\n    model += lpSum(x[i, j, name] for i, j in settable_pos) <= candy['max_set'], 'MaxSetConstraint:{}'.format(name)\n\n\u57fa\u672c\u7684\u306b\u306f\u4e0b\u9650\u306e\u5834\u5408\u3068\u540c\u69d8\u3067\u3059\u304c\uff0c\u7a2e\u985e\u304c\u30d1\u30d5\u30a7\u306e\u5834\u5408\u3060\u3051\u306f\u4e0a\u9650\u304c1\u3064\u306b\u3064\u304d1\u500b\u3068\u4ed5\u69d8\u4e0a\u6c7a\u307e\u3063\u3066\u3044\u307e\u3059\uff0e\n\n4\u756a\u76ee\u306e\u5236\u7d04\n\u30ad\u30e3\u30f3\u30c7\u30a3\u30fc\u30dc\u30c3\u30af\u30b9\u5168\u4f53\u3067\u30ad\u30e3\u30f3\u30c7\u30a3\u30fc\u306e\u7a2e\u985e\u3054\u3068\u306e\u914d\u7f6e\u500b\u6570\u304c\u4e0a\u9650\u3092\u8d85\u3048\u306a\u3044\u3053\u3068\u3092\u8868\u3059\u5236\u7d04\u3092\u8ffd\u52a0\u3057\u307e\u3059\uff0e\nlin_expressions = {type_name: LpAffineExpression() for type_name in max_set_by_types.keys()}\nfor i, j in settable_pos:\n    for name, candy in candies.iteritems():\n        try:\n            lin_expressions[name[name.rfind('_')+1:]] += x[i, j, name]\n        except Exception:\n            print('Invalid Candy Name! Unknown candy type.: {}'.format(name))\nfor name, lhs in lin_expressions.iteritems():\n    model += lhs <= max_set_by_types[name], 'MaxSetByTypeConstraints:{}'.format(name)\n\n2\u756a\u76ee\u306e\u5236\u7d04\u3069\u540c\u69d8\u306b\uff0c\u4eca\u5ea6\u306f\u7a2e\u985e\u3054\u3068\u306b\u7dda\u5f62\u8868\u73fe\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u4f5c\u6210\u3057\u3066\u304a\u304d\u307e\u3059\uff0e\n\u305d\u306e\u5f8c\uff0c\u5909\u6570\u3054\u3068\u306b\u7740\u76ee\u3057\uff0c\u305d\u306e\u5909\u6570\u306e\u30ad\u30e3\u30f3\u30c7\u30a3\u30fc\u306e\u7a2e\u985e\u306b\u5408\u308f\u305b\u305f\u7dda\u5f62\u8868\u73fe\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306b\u305d\u306e\u5909\u6570\u3092\u8ffd\u52a0\u3057\u3066\u3044\u307e\u3059\uff0e\n\u305d\u3057\u3066\u6700\u5f8c\u306b\u30e2\u30c7\u30eb\u306b\u5236\u7d04\u3068\u3057\u3066\u8ffd\u52a0\u3057\u3066\u3044\u307e\u3059\uff0e\n\n\u76ee\u7684\u95a2\u6570\n\u76ee\u7684\u95a2\u6570\u3092\u8ffd\u52a0\u3057\u307e\u3059\uff0e\n# \u76ee\u7684\u95a2\u6570\nmodel += lpSum(candy['profit'] * x[i, j, name] for i, j in settable_pos for name, candy in candies.iteritems())\n\n\u76ee\u7684\u95a2\u6570\u306f\uff0c\u5404\u30ad\u30e3\u30f3\u30c7\u30a3\u30fc\u306e\u4fa1\u5024candy['profit']\u3068\u305d\u308c\u3092\u7f6e\u3044\u305f\u5834\u54081\uff0c\u305d\u308c\u4ee5\u5916\u306e\u3068\u304d0\u3068\u306a\u308b\u5909\u6570x\u306e\u7a4d\u306e\u7dcf\u548c\u3067\u3059\uff0e\n\u305d\u3057\u3066\u4ee5\u4e0a\u3067\u30e2\u30c7\u30eb\u306e\u8a18\u8ff0\u304c\u7d42\u308f\u308a\u307e\u3057\u305f\uff0e\u5f8c\u306f\u89e3\u3044\u3066\u7d50\u679c\u3092\u53d6\u3063\u3066\u304f\u308b\u3060\u3051\u3067\u3059\uff0e\n\n\u6c42\u89e3\u3068\u7d50\u679c\u306e\u53d6\u5f97\n# \u6c42\u89e3\u3068\u305d\u306e\u30b9\u30c6\u30fc\u30bf\u30b9\uff08\u6700\u9069\u89e3\u304c\u3067\u305f\u306e\u304b\u3069\u3046\u304b\uff09\u3092\u53d6\u5f97\nstatus = model.solve()\nprint('Status: {}'.format(LpStatus[status]))\nprint('CalculationTime: {:.3f}s'.format(model.solutionTime))\n\n# \u6700\u9069\u89e3\u304c\u51fa\u3066\u3044\u306a\u3051\u308c\u3070\u7d42\u4e86\nif status != LpStatusOptimal:\n    exit(0)\n\n# \u6700\u9069\u89e3\u304c\u51fa\u3066\u3044\u308c\u3070\u7d50\u679c\u3092\u51fa\u529b\u3057\u3066\u3044\u304f\n# \u76ee\u7684\u95a2\u6570\u5024\u51fa\u529b\nprint('Optimal value: {}'.format(model.objective.value()))\n\n# \u30ad\u30e3\u30f3\u30c7\u30a3\u30fc\u3068ID\u306e\u5bfe\u5fdc\u51fa\u529b\nsorted_candy_names = sorted(candies.keys(), key=lambda name: name[name.rfind('_'):]+name[:name.rfind('_')])\nprint('xxx: Block (can not set)\\nooo: Free space\\n---: \"Top-left\" candy\\'s space')\nprint('\\n'.join('{:0>3}: {}'.format(i, name) for i, name in enumerate(sorted_candy_names)))\n\n# \u30ad\u30e3\u30f3\u30c7\u30a3\u30fc\u30dc\u30c3\u30af\u30b9\u306e\u914d\u7f6e\u51fa\u529b\nsolution_box = [['xxx' if e > 0.5 else 'ooo' for e in l] for l in candy_box]\nfor i, j in settable_pos:\n    for ID, name in enumerate(sorted_candy_names):\n        if value(x[i, j, name]) < 0.5:\n            continue\n        for k in xrange(candies[name]['height']):\n            for l in xrange(candies[name]['width']):\n                solution_box[i + k][j + l] = '---'\n        solution_box[i][j] = '{:0>3}'.format(ID)\nprint('\\n-------------- Solution --------------')\nprint('\\n'.join(', '.join(l) for l in solution_box))\nprint('--------------    End   --------------')\n\n\u4ee5\u4e0a\u306e\u30d7\u30ed\u30b0\u30e9\u30e0\u3092\u5b9f\u884c\u3059\u308b\u3068\uff0c\u79c1\u306e\u74b0\u5883\u3067\u306f\u4ee5\u4e0b\u306e\u69d8\u306a\u7d50\u679c\u3092\u5f97\u307e\u3057\u305f\uff0e\nStatus: Optimal\nCalculationTime: 0.069s\nOptimal value: 452.0\nxxx: Block (can not set)\nooo: Free space\n---: \"Top-left\" candy's space\n000: ability_candy\n001: brow_resist_candy\n002: mind_resist_candy\n003: shot_resist_candy\n004: spirita_candy\n005: arm_cookie\n006: power_cookie\n007: shoot_cookie\n008: spirita_cookie\n009: stamina_cookie\n010: technique_cookie\n011: lucky_crepe\n012: otonano_crepe\n013: richna_crepe\n014: stamina_gmi\n015: 1stage_pancake\n016: 2stage_pancake\n017: 3stage_pancake\n018: blast_parfait\n019: gamushara_parfait\n020: harikiri_parfait\n021: hissatsu_parfait\n022: megaton_parfait\n023: pittari_parfait\n024: hikarino_ramune\n025: honoono_ramune\n026: kaminarino_ramune\n027: kazeno_ramune\n028: koorino_ramune\n029: yamino_ramune\n030: funbari_roll\n031: girigiri_roll\n032: henkan_roll\n033: migawari_roll\n034: muteki_roll\n035: ouen_roll\n036: shikkari_roll\n037: tsuyogari_roll\n038: body_sand\n039: mind_sand\n040: react_sand\n\n-------------- Solution --------------\nxxx, 005, ---, xxx, xxx, xxx, 029, xxx\n014, ---, ---, 030, ---, 020, ---, 014\n014, xxx, 014, ---, ---, ---, ---, xxx\n014, xxx, 009, ---, 017, ---, 038, ---\n038, ---, ---, ---, ---, ---, xxx, 014\nxxx, 032, ---, 017, ---, 014, xxx, 014\n014, ---, ---, ---, ---, 021, ---, 014\nxxx, 014, xxx, xxx, xxx, ---, ---, xxx\n--------------    End   --------------\n\n\u6700\u9069\u89e3\u304c0.069\u79d2\u3067\u6c42\u307e\u308a\uff0c\u76ee\u7684\u95a2\u6570\u5024\u306f452\u3067\u3042\u3063\u305f\u3068\u3044\u3046\u3053\u3068\u304c\u8aad\u307f\u53d6\u308c\u307e\u3059\uff0e\n\u6ce8\u610f\uff09\u3042\u304f\u307e\u3067\u30b5\u30f3\u30d7\u30eb\u7684\u306a\u30c7\u30fc\u30bf\u3067\u89e3\u3044\u305f\u7d50\u679c\u306e\u305f\u3081\uff0c\u5b9f\u969b\u306b\u4f7f\u3046\u969b\u306b\u306f\u81ea\u5206\u3067\u30ad\u30e3\u30f3\u30c7\u30a3\u30fc\u306e\u4fa1\u5024\u3084\u6700\u4f4e\u914d\u7f6e\u500b\u6570\u306a\u3069\u3092\u8abf\u6574\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\uff0e\n\n\u4f59\u529b\u306e\u3042\u308b\u4eba\u5411\u3051\n\u540c\u3058\u76ee\u7684\u95a2\u6570\u5024\u3067\u4ed6\u306e\u89e3\u304c\u3042\u308b\u306e\u3067\u306f\u306a\u3044\u304b\uff1f\u3068\u92ed\u3044\u65b9\u306f\u601d\u3063\u305f\u304b\u3082\u3057\u308c\u307e\u305b\u3093\uff0e\u305d\u306e\u901a\u308a\u3067\u3059\uff0e\n\u4f59\u529b\u306e\u3042\u308b\u4eba\u306f\uff0c\u4ee5\u4e0b\u306e\u69d8\u306a\u5185\u5bb9\u306b\u6311\u6226\u3057\u3066\u307f\u3066\u306f\u3044\u304b\u304c\u3067\u3057\u3087\u3046\u304b\uff0e\n\n\u540c\u3058\u76ee\u7684\u95a2\u6570\u5024\u3068\u306a\u308b\u3088\u3046\u306a\u89e3\u3092\u5168\u3066\u51fa\u3059\u3088\u3046\u306b\u3059\u308b\n\u540c\u3058\u76ee\u7684\u95a2\u6570\u5024\u3067\u3042\u308c\u3070\uff0c\u3067\u304d\u308b\u3060\u3051\u591a\u304f\u306e\u7a2e\u985e\u306e\u30ad\u30e3\u30f3\u30c7\u30a3\u30fc\u3092\u914d\u7f6e\u3059\u308b\n\n\n\u304a\u308f\u308a\u306b\n\u3055\u3066\uff0c\u4eca\u56de\u306f\u524d\u56de\u306e\u8a18\u4e8b\u3067\u793a\u3057\u305f\u5b9a\u5f0f\u5316\u3092\u3082\u3068\u306b\uff0c\u5b9f\u969b\u306b\u30b3\u30fc\u30c9\u3092\u66f8\u3044\u3066\u554f\u984c\u3092\u89e3\u304f\u3068\u3053\u308d\u307e\u3067\u884c\u3044\u307e\u3057\u305f\uff0e\u75b2\u308c\u3066\u304b\u306a\u308a\u7aef\u6298\u3063\u3066\u3057\u307e\u3063\u305f\u305f\u3081\uff0c\u308f\u304b\u308a\u306b\u304f\u3044\u7b87\u6240\u3082\u3042\u308b\u304b\u3068\u601d\u3044\u307e\u3059\uff0e\n\u30b3\u30e1\u30f3\u30c8\u306a\u3069\u3067\u30ea\u30af\u30a8\u30b9\u30c8\u9802\u3051\u308c\u3070\uff0c\u6642\u9593\u306e\u3042\u308b\u3068\u304d\u306b\u305d\u306e\u7b87\u6240\u306b\u3064\u3044\u3066\u6398\u308a\u4e0b\u3052\u3066\u8ffd\u8a18\u3057\u3088\u3046\u3068\u601d\u3044\u307e\u3059\u306e\u3067\uff0c\u8cea\u554f\u306a\u3069\u3042\u308a\u307e\u3057\u305f\u3089\u30b3\u30e1\u30f3\u30c8\u3092\u3088\u308d\u3057\u304f\u304a\u9858\u3044\u3044\u305f\u3057\u307e\u3059\uff0e\n\u307e\u305f\uff0c\u4eca\u56de\u306f\u8aac\u660e\u3057\u3084\u3059\u304f\u3059\u308b\u305f\u3081\u306b\u30af\u30e9\u30b9\u5316\u306a\u3069\u306f\u884c\u3063\u3066\u3044\u307e\u305b\u3093\u304c\uff0c\u305d\u3082\u305d\u3082\u6700\u521d\u306b\u66f8\u3044\u305f\u3082\u306e\u306f\u30ad\u30e3\u30f3\u30c7\u30a3\u30fc\u30dc\u30c3\u30af\u30b9\u306a\u3069\u306f\u30af\u30e9\u30b9\u5316\u3057\u3066\u3044\u308b\u305f\u3081\uff0c\u8981\u671b\u304c\u3042\u308c\u3070\u305d\u3061\u3089\u3082\u516c\u958b\u3057\u3088\u3046\u3068\u601d\u3044\u307e\u3059\uff0e\n\u304a\u6c17\u3065\u304d\u306e\u70b9\u306a\u3069\u3054\u3056\u3044\u307e\u3057\u305f\u3089\u30b3\u30e1\u30f3\u30c8\u7b49\u3067\u3054\u6307\u6458\u3092\u304a\u9858\u3044\u3044\u305f\u3057\u307e\u3059\uff0e\n# \u4eca\u56de\u306e\u5185\u5bb9\n[\u524d\u56de\u306e\u8a18\u4e8b](http://qiita.com/lovely_TGSHR/items/4bf71fff44b4061f9209 \"PSO2\u3067\u30da\u30c3\u30c8\u306e\u30ad\u30e3\u30f3\u30c7\u30a3\u30fc\u914d\u7f6e\u3092\u6700\u9069\u5316\u3059\u308b\uff08\u5b9a\u5f0f\u5316\u7de8\uff09\")\u3067\uff0c\u30da\u30c3\u30c8\u306e\u30ad\u30e3\u30f3\u30c7\u30a3\u30fc\u914d\u7f6e\u3092\u6700\u9069\u5316\u3059\u308b\u305f\u3081\u306b\u554f\u984c\u3092\u6570\u5f0f\u3068\u3057\u3066\u66f8\u304d\u4e0b\u3059\uff08\u5b9a\u5f0f\u5316\u3059\u308b\uff09\u3068\u3053\u308d\u307e\u3067\u884c\u3044\u307e\u3057\u305f\uff0e\n\u4eca\u56de\u306f\uff0c\u5b9f\u969b\u306b\u30b3\u30fc\u30c9\u3092\u66f8\u3044\u3066\u554f\u984c\u3092\u89e3\u304f\u3068\u3053\u308d\u307e\u3067\u884c\u3044\u307e\u3059\uff0e\n\u4f7f\u7528\u8a00\u8a9e\u306fPython2.x\u7cfb\u3067\uff0c\u4e3b\u306b\u4f7f\u7528\u3059\u308b\u5916\u90e8\u30e2\u30b8\u30e5\u30fc\u30eb\u306fPuLP\u3067\u3059\uff0e\nPython\u3084PuLP\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u65b9\u6cd5\u306a\u3069\u306f\u4ee5\u4e0b\u306e\u30da\u30fc\u30b8\u3092\u53c2\u8003\u306b\u3057\u3066\u4e0b\u3055\u3044\uff08\u65e5\u672c\u8a9e\u304c\u3044\u3044\u5834\u5408\u306f\u691c\u7d22\u3059\u308b\u3068\u3059\u3050\u51fa\u3066\u304d\u307e\u3059\uff09\uff0e\n* https://www.python.org/\n* https://github.com/coin-or/pulp\n\n## PuLP\u3068\u306f\nGitHub\u306e\u30da\u30fc\u30b8\u306b\u3082\u3042\u308a\u307e\u3059\u304c\uff0cPython\u3067\u66f8\u304b\u308c\u305f\u7dda\u5f62\u8a08\u753b\u30e2\u30c7\u30e9\u3067\u3059\uff08\u3068\u3044\u3044\u3064\u3064\u6574\u6570\u5909\u6570\u3082\u6271\u3048\u308b\u305f\u3081\u3001\u6574\u6570\u8a08\u753b\u3001\u6df7\u5408\u6574\u6570\u8a08\u753b\u3082\u3044\u3051\u307e\u3059\uff09\uff0e\n\u3064\u307e\u308a\uff0c\u524d\u56de\u306e\u8a18\u4e8b\u3067\u66f8\u3044\u305f\u3088\u3046\u306a\u5b9a\u5f0f\u5316\u3092\uff0c\u5b9f\u969b\u306b\u30bd\u30eb\u30d0\u30fc\uff08\u6700\u9069\u5316\u554f\u984c\u3092\u89e3\u3044\u3066\u304f\u308c\u308b\u30d7\u30ed\u30b0\u30e9\u30e0\uff0c\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\uff09\u306b\u89e3\u304b\u305b\u308b\u305f\u3081\u306b\u5206\u304b\u308b\u5f62\u3067\u8a18\u8ff0\u3057\u3066\u3084\u308b\uff08\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\uff09\u305f\u3081\u306e\u3082\u306e\u3067\u3059\uff0e\n\u3068\u3044\u3046\u3053\u3068\u306f\uff0c\u30bd\u30eb\u30d0\u30fc\u306f\u5225\u9014\u7528\u610f\u3057\u306a\u3051\u308c\u3070\u306a\u3089\u306a\u3044\u306f\u305a\u3067\u3059\u304c\uff0c\u5b9f\u306fPuLP\u306f\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u305f\u6642\u70b9\u3067\u4f7f\u3048\u308b\u30bd\u30eb\u30d0\u30fc\u304c\u7528\u610f\u3055\u308c\u3066\u3044\u308b\u305f\u3081\uff0c\u4eca\u56de\u306e\u3088\u3046\u306a\u5c0f\u898f\u6a21\u306a\u554f\u984c\u3092\u89e3\u304f\u306e\u306b\u306f\u305d\u306e\u30c7\u30d5\u30a9\u30eb\u30c8\u306e\u30bd\u30eb\u30d0\u30fc\u3067\u554f\u984c\u3042\u308a\u307e\u305b\u3093\uff0e\n\u3082\u3061\u308d\u3093\uff0c\u81ea\u524d\u3067\u7528\u610f\u3057\u305f\u30bd\u30eb\u30d0\u30fc\u3092\u6307\u5b9a\u3057\u3066\u89e3\u304f\u3053\u3068\u3082\u3067\u304d\u307e\u3059\uff08\u30bd\u30eb\u30d0\u30fc\u306e\u6307\u5b9a\u65b9\u6cd5\u306a\u3069\u306f\u30de\u30cb\u30e5\u30a2\u30eb\u3092\u53c2\u7167\u3057\u3066\u4e0b\u3055\u3044\uff09\uff0e\u5b66\u8853\u6a5f\u95a2\u306b\u6240\u5c5e\u3055\u308c\u3066\u3044\u308b\u65b9\u306f\u5546\u7528\u6700\u901f\u306eGurobi\u3068\u3044\u3046\u30bd\u30eb\u30d0\u30fc\u304c\u7121\u6599\u3067\u4f7f\u3048\u308b\u3057\u5727\u5012\u7684\u306b\u901f\u3044\u3068\u601d\u308f\u308c\u307e\u3059\uff0e\u30e2\u30c7\u30ea\u30f3\u30b0\u3082gurobipy\u3068\u3044\u3046\u5c02\u7528\u306e\u30e2\u30b8\u30e5\u30fc\u30eb\u304c\u7528\u610f\u3055\u308c\u3066\u304a\u308a\uff0c\u30e2\u30c7\u30ea\u30f3\u30b0\u81ea\u4f53\u3082PuLP\u3092\u7d4c\u7531\u3057\u3066Gurobi\u3092\u547c\u3073\u51fa\u3059\u3088\u308a\u9ad8\u901f\u3067\u3059\uff0e\n\n# \u524d\u56de\u306e\u5b9a\u5f0f\u5316\u304a\u3055\u3089\u3044\n\u524d\u56de\u306e\u5b9a\u5f0f\u5316\u306f\u4ee5\u4e0b\u306e\u69d8\u306a\u3082\u306e\u3067\u3057\u305f\uff0e\n\n```math\n\\begin{align}\n\\mathbb{maximize} & & \\sum_{i \\in I} \\sum_{j \\in J} \\sum_{p \\in P} v_{p} x_{ijp} & \\\\\n\\mathbb{subject \\ to} & & x_{ijp} \\leq a_{ijp} & & \\forall i \\in I, j \\in J, p \\in P \\\\\n& & \\sum_{k \\in I} \\sum_{l \\in J} \\sum_{p \\in P} c_{klp}^{ij} x_{klp} \\leq 1 & & \\forall i \\in I, j \\in J \\\\\n& & b_{p} \\leq \\sum_{i \\in I} \\sum_{j \\in J} x_{ijp} \\leq n_{p} & & \\forall p \\in P \\\\\n& & \\sum_{i \\in I} \\sum_{j \\in J} \\sum_{p \\in P_{s}} x_{ijp} \\leq m_{s} & & \\forall s \\in S \\\\\n& &  x_{ijp} \\in \\{ 0, 1 \\} & & \\forall i \\in I, j \\in J, p \\in P \\\\\n\\end{align}\n```\n\n# \u30d7\u30ed\u30b0\u30e9\u30e0\n\u3067\u306f\uff0c\u5b9f\u969b\u306b\u30b3\u30fc\u30c9\u3092\u66f8\u3044\u3066\u89e3\u3044\u3066\u3044\u304d\u305f\u3044\u3068\u601d\u3044\u307e\u3059\uff0e\n\u305b\u3063\u304b\u304f\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u6307\u5411\u8a00\u8a9e\u3092\u4f7f\u3063\u3066\u3044\u307e\u3059\u304c\uff0c\u6d41\u308c\u304c\u308f\u304b\u308a\u3084\u3059\u3044\u3068\u601d\u3046\u306e\u3067\u4eca\u56de\u306f\u30af\u30e9\u30b9\u5316\u3057\u305f\u308a\u3057\u306a\u3044\u3067\u66f8\u3044\u3066\u3044\u307e\u3059\uff0e\u5b9f\u969b\u306b\u306f\uff0c\u30ad\u30e3\u30f3\u30c7\u30a3\u30fc\u30dc\u30c3\u30af\u30b9\u306a\u3069\u306f\u30af\u30e9\u30b9\u5316\u3057\u305f\u65b9\u304c\u304b\u306a\u308a\u6271\u3044\u3084\u3059\u3044\u3068\u601d\u3044\u307e\u3059\uff0e\n\n## \u30e2\u30b8\u30e5\u30fc\u30eb\u6e96\u5099\n\u307e\u305a\uff0c\u30e2\u30b8\u30e5\u30fc\u30eb\u306a\u3069\u3092\u8aad\u307f\u8fbc\u3093\u3067\u304a\u304d\u307e\u3059\uff0e\nfuture\u306f\uff08\u4e3b\u306b\u79c1\u304c\uff09\u306e\u3061\u306e\u3061Python3\u7cfb\u306b\u79fb\u884c\u3059\u308b\u3068\u304d\u306e\u305f\u3081\u306b\u5099\u3048\u3066\u3044\u308b\u3082\u306e\u3067\u3059\uff08\u3064\u307e\u308a\u306a\u304f\u3066\u3082\u3088\u3044\u3067\u3059\uff09\uff0e\nrepoze.lru\u306b\u3064\u3044\u3066\u306f\uff0c\u5f8c\u3067\u51fa\u3066\u304f\u308b\u95a2\u6570\u306e\u9ad8\u901f\u5316\u306e\u305f\u3081\u306b\u4f7f\u3063\u3066\u3044\u307e\u3059\uff08\u306a\u304f\u3066\u3082\u52d5\u304d\u307e\u3059\u304c\uff0c\u3042\u308b\u3068\u901f\u3044\u306e\u3067\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u3066\u304a\u304f\u3053\u3068\u3092\u304a\u3059\u3059\u3081\u3057\u307e\u3059\uff09\uff0e\n\n```py:\n# -*- coding: utf-8 -*-\nfrom __future__ import unicode_literals, print_function\nfrom repoze.lru import lru_cache\nfrom pulp import *\n```\n\n## \u30c7\u30fc\u30bf\u306e\u6e96\u5099\n\u30ad\u30e3\u30f3\u30c7\u30a3\u30fc\u3084\u30ad\u30e3\u30f3\u30c7\u30a3\u30fc\u30dc\u30c3\u30af\u30b9\u306a\u3069\u306e\u30c7\u30fc\u30bf\u3092\u7528\u610f\u3057\u307e\u3059\uff0e\n### \u30ad\u30e3\u30f3\u30c7\u30a3\u30fc\u30dc\u30c3\u30af\u30b9\n```py:\n# \u30ef\u30f3\u30c0\u306e\u30ad\u30e3\u30f3\u30c7\u30a3\u30fc\u30dc\u30c3\u30af\u30b9\u30020\u304c\u30ad\u30e3\u30f3\u30c7\u30a3\u30fc\u3092\u7f6e\u3051\u308b\u5834\u6240\u30011\u304c\u7f6e\u3051\u306a\u3044\u5834\u6240\ncandy_box = [[1, 0, 0, 1, 1, 1, 0, 1],\n             [0, 0, 0, 0, 0, 0, 0, 0],\n             [0, 1, 0, 0, 0, 0, 0, 1],\n             [0, 1, 0, 0, 0, 0, 0, 0],\n             [0, 0, 0, 0, 0, 0, 1, 0],\n             [1, 0, 0, 0, 0, 0, 1, 0],\n             [0, 0, 0, 0, 0, 0, 0, 0],\n             [1, 0, 1, 1, 1, 0, 0, 1]]\n```\ncandy_box\u306f\u305d\u306e\u307e\u307e\uff0c\u4eca\u56de\u89e3\u304d\u305f\u3044\u30da\u30c3\u30c8\u306e\u30ad\u30e3\u30f3\u30c7\u30a3\u30fc\u30dc\u30c3\u30af\u30b9\u306e\u30c7\u30fc\u30bf\u3067\u3059\uff0e\n\u4ed6\u306e\u30da\u30c3\u30c8\u306e\u5834\u5408\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u306e\u3067\uff0c\u89e3\u304d\u305f\u3044\u30da\u30c3\u30c8\u306e\u3082\u306e\u306b\u5165\u308c\u66ff\u3048\u308c\u3070\u89e3\u3051\u307e\u3059\uff0e\n\n ```py:\n trim = [[1, 0, 0, 0, 0, 1, 1, 1],\n        [0, 0, 0, 0, 0, 0, 1, 0],\n        [0, 0, 0, 0, 0, 0, 0, 0],\n        [0, 0, 0, 0, 0, 0, 0, 1],\n        [0, 0, 0, 0, 0, 1, 0, 0],\n        [1, 0, 0, 0, 1, 1, 1, 0],\n        [1, 1, 0, 0, 0, 1, 0, 0],\n        [1, 0, 0, 1, 0, 0, 0, 0]]\nsally = [[1, 1, 0, 1, 1, 0, 1, 1],\n         [0, 0, 0, 0, 0, 0, 0, 0],\n         [0, 1, 0, 0, 0, 0, 1, 0],\n         [0, 0, 0, 0, 0, 0, 0, 0],\n         [0, 0, 0, 0, 0, 0, 0, 0],\n         [0, 0, 1, 0, 0, 1, 0, 0],\n         [0, 0, 0, 1, 1, 0, 0, 0],\n         [1, 1, 0, 0, 0, 0, 1, 1]]\nmarron = [[0, 0, 0, 1, 1, 0, 0, 1],\n          [0, 1, 0, 0, 0, 0, 1, 1],\n          [0, 1, 0, 0, 0, 0, 0, 0],\n          [0, 0, 0, 0, 0, 0, 0, 1],\n          [1, 0, 0, 0, 0, 0, 0, 0],\n          [0, 0, 0, 0, 0, 0, 1, 0],\n          [1, 1, 0, 0, 0, 0, 1, 0],\n          [1, 0, 0, 1, 1, 0, 0, 0]]\nmelon = [[1, 1, 0, 1, 0, 0, 0, 0],\n         [0, 1, 0, 0, 0, 1, 1, 0],\n         [0, 0, 0, 0, 0, 0, 0, 0],\n         [1, 0, 0, 0, 0, 0, 0, 1],\n         [1, 0, 0, 0, 0, 0, 0, 1],\n         [0, 0, 0, 0, 0, 0, 0, 0],\n         [0, 1, 1, 0, 0, 0, 1, 0],\n         [0, 0, 0, 0, 1, 0, 1, 1]]\nrappy = [[0, 1, 0, 0, 0, 0, 1, 0],\n         [0, 1, 0, 0, 0, 0, 1, 0],\n         [0, 0, 0, 0, 0, 0, 0, 0],\n         [0, 1, 0, 0, 0, 0, 1, 0],\n         [1, 0, 1, 0, 0, 1, 0, 1],\n         [0, 1, 0, 0, 0, 0, 1, 0],\n         [0, 0, 0, 1, 1, 0, 0, 0],\n         [0, 0, 0, 1, 1, 0, 0, 0]]\nviola = [[0, 1, 1, 0, 1, 0, 0, 0],\n         [0, 1, 0, 0, 0, 0, 1, 0],\n         [0, 1, 0, 0, 0, 0, 0, 1],\n         [0, 0, 0, 0, 0, 0, 0, 1],\n         [1, 0, 0, 0, 0, 0, 0, 0],\n         [1, 0, 0, 0, 0, 0, 1, 0],\n         [0, 1, 0, 0, 0, 0, 1, 0],\n         [0, 0, 0, 1, 0, 1, 1, 0]]\n\n ```\n \n### \u30ad\u30e3\u30f3\u30c7\u30a3\u30fc\n\n```py:\n# \u30ad\u30e3\u30f3\u30c7\u30a3\u30fc\u306e\u4e00\u89a7\u3002\u8f9e\u66f8\u306e\u8f9e\u66f8\u5f62\u5f0f\u3002\u540d\u524d\u3001height\u3001width\u3001profit\u306f\u5fc5\u9808\u3001min_set\u3001max_set\u306f\u4efb\u610f \ncandies = {\"blast_parfait\": {\"height\": 2, \"width\": 2, \"profit\": 100, \"min_set\": 0},\n           \"megaton_parfait\": {\"height\": 2, \"width\": 2, \"profit\": 100, \"min_set\": 0},\n           \"hissatsu_parfait\": {\"height\": 2, \"width\": 2, \"profit\": 100, \"min_set\": 0},\n           \"pittari_parfait\": {\"height\": 2, \"width\": 2, \"profit\": 100, \"min_set\": 0},\n           \"gamushara_parfait\": {\"height\": 2, \"width\": 2, \"profit\": 100, \"min_set\": 0},\n           \"harikiri_parfait\": {\"height\": 2, \"width\": 2, \"profit\": 100, \"min_set\": 0},\n           \"girigiri_roll\": {\"height\": 2, \"width\": 2, \"profit\": 50, \"min_set\": 0},\n           \"funbari_roll\": {\"height\": 2, \"width\": 2, \"profit\": 50, \"min_set\": 0},\n           \"ouen_roll\": {\"height\": 2, \"width\": 2, \"profit\": 50, \"min_set\": 0},\n           \"muteki_roll\": {\"height\": 2, \"width\": 2, \"profit\": 50, \"min_set\": 0},\n           \"shikkari_roll\": {\"height\": 2, \"width\": 2, \"profit\": 50, \"min_set\": 0},\n           \"henkan_roll\": {\"height\": 2, \"width\": 2, \"profit\": 50, \"min_set\": 0},\n           \"migawari_roll\": {\"height\": 2, \"width\": 2, \"profit\": 50, \"min_set\": 0},\n           \"tsuyogari_roll\": {\"height\": 2, \"width\": 2, \"profit\": 50, \"min_set\": 0},\n           \"stamina_cookie\": {\"height\": 2, \"width\": 2, \"profit\": 30, \"min_set\": 0},\n           \"spirita_cookie\": {\"height\": 2, \"width\": 2, \"profit\": 30, \"min_set\": 0},\n           \"power_cookie\": {\"height\": 2, \"width\": 2, \"profit\": 30, \"min_set\": 0},\n           \"shoot_cookie\": {\"height\": 2, \"width\": 2, \"profit\": 30, \"min_set\": 0},\n           \"technique_cookie\": {\"height\": 2, \"width\": 2, \"profit\": 30, \"min_set\": 0},\n           \"arm_cookie\": {\"height\": 2, \"width\": 2, \"profit\": 30, \"min_set\": 0},\n           \"1stage_pancake\": {\"height\": 2, \"width\": 2, \"profit\": 20, \"min_set\": 0},\n           \"2stage_pancake\": {\"height\": 2, \"width\": 2, \"profit\": 25, \"min_set\": 0},\n           \"3stage_pancake\": {\"height\": 2, \"width\": 2, \"profit\": 30, \"min_set\": 0},\n           \"honoono_ramune\": {\"height\": 1, \"width\": 1, \"profit\": 1,  \"min_set\": 0},\n           \"koorino_ramune\": {\"height\": 1, \"width\": 1, \"profit\": 1,  \"min_set\": 0},\n           \"kaminarino_ramune\": {\"height\": 1, \"width\": 1, \"profit\": 1, \"min_set\": 0},\n           \"kazeno_ramune\": {\"height\": 1, \"width\": 1, \"profit\": 1, \"min_set\": 0},\n           \"hikarino_ramune\": {\"height\": 1, \"width\": 1, \"profit\": 1, \"min_set\": 0},\n           \"yamino_ramune\": {\"height\": 1, \"width\": 1, \"profit\": 1, \"min_set\": 0},\n           \"richna_crepe\": {\"height\": 2, \"width\": 2, \"profit\": 20, \"min_set\": 0},\n           \"otonano_crepe\": {\"height\": 2, \"width\": 2, \"profit\": 20, \"min_set\": 0},\n           \"lucky_crepe\": {\"height\": 2, \"width\": 2, \"profit\": 20, \"min_set\": 0},\n           \"spirita_candy\": {\"height\": 1, \"width\": 4, \"profit\": 15, \"min_set\": 0},\n           \"brow_resist_candy\": {\"height\": 1, \"width\": 4, \"profit\": 15, \"min_set\": 0},\n           \"shot_resist_candy\": {\"height\": 1, \"width\": 4, \"profit\": 15, \"min_set\": 0},\n           \"mind_resist_candy\": {\"height\": 1, \"width\": 4, \"profit\": 15, \"min_set\": 0},\n           \"ability_candy\": {\"height\": 1, \"width\": 4, \"profit\": 15, \"min_set\": 0},\n           \"body_sand\": {\"height\": 1, \"width\": 2, \"profit\": 10, \"min_set\": 0},\n           \"react_sand\": {\"height\": 1, \"width\": 2, \"profit\": 10, \"min_set\": 0},\n           \"mind_sand\": {\"height\": 1, \"width\": 2, \"profit\": 10, \"min_set\": 0},\n           \"stamina_gmi\": {\"height\": 1, \"width\": 1, \"profit\": 1, \"min_set\": 0, \"max_set\": 20}\n           }\n# \u30ad\u30e3\u30f3\u30c7\u30a3\u30fc\u306e\u30bf\u30a4\u30d7\u3054\u3068\u306e\u914d\u7f6e\u6570\u4e0a\u9650\nmax_set_by_types = {'parfait': 2, 'roll': 2, 'cookie': 3, 'pancake': 2,\n                    'ramune': 1, 'crepe': 1, 'candy': 4, 'sand': 5, 'gmi': 20}\n```\n\u89e3\u304f\u4e0a\u3067\u81ea\u5206\u304c\u8003\u616e\u3057\u305f\u3044\u30ad\u30e3\u30f3\u30c7\u30a3\u30fc\u306e\u4e00\u89a7\u3092\u66f8\u3044\u3066\u304a\u304d\u307e\u3059\uff0e\u5fc5\u8981\u306b\u5fdc\u3058\u3066\u5c11\u306a\u304f\u3059\u308b\u3068\u826f\u3044\u3067\u3057\u3087\u3046\uff0e\n\u305d\u308c\u305e\u308c\u306e\u30ad\u30e3\u30f3\u30c7\u30a3\u30fc\u306e\u540d\u524d\u306f\u306a\u3093\u3067\u3082\u826f\u3044\u306e\u3067\u3059\u304c\uff0c\u7a2e\u985e\u540d\u300c\uff3fgmi\u300d\u3084\u300c\uff3framune\u300d\u306a\u3069\u306e\u53f3\u306e\u300c\uff3f\u300d\u4ee5\u964d\u306e\u90e8\u5206\u306f\uff0cmax_set_by_types\u306b\u66f8\u3044\u3066\u3042\u308b\u30ad\u30e3\u30f3\u30c7\u30a3\u30fc\u306e\u7a2e\u985e\uff089\u7a2e\u985e\uff09\u306e\u4f55\u308c\u304b\u6b63\u3057\u3044\u7a2e\u985e\u3092\u4ed8\u3051\u3066\u304a\u3044\u3066\u4e0b\u3055\u3044\uff0e\n\n## \u697d\u3092\u3059\u308b\u305f\u3081\u306e\u6e96\u5099\n\u5f8c\u3067\u697d\u3092\u3059\u308b\u305f\u3081\u306b\uff0c\u4e0a\u8a18\u30c7\u30fc\u30bf\u304b\u3089\u52a0\u5de5\u3057\u3066\u3067\u304d\u308b\u30c7\u30fc\u30bf\u3084\uff0c\u95a2\u6570\u3092\u5b9a\u7fa9\u3057\u3066\u304a\u304d\u307e\u3059\uff0e\n\n```py:\n# \u30ad\u30e3\u30f3\u30c7\u30a3\u30fc\u30dc\u30c3\u30af\u30b9\u3067\u914d\u7f6e\u53ef\u80fd\uff080\uff09\u306a\u5ea7\u6a19\u306e\u30ea\u30b9\u30c8\nsettable_pos = [(i, j) for i in xrange(len(candy_box)) for j in xrange(len(candy_box[i])) if candy_box[i][j] < .5]\n\n@lru_cache(64 * 64)\ndef is_settable(i=0, j=0, height=1, width=1):\n    \"\"\"i\u884c\u76ee\u3001j\u5217\u76ee\u306e\u30de\u30b9\u3092\u5de6\u4e0a\u306e\u70b9\u3068\u3057\u3066\u3001\u6307\u5b9a\u306e\u5927\u304d\u3055\u306e\u30ad\u30e3\u30f3\u30c7\u30a3\u30fc\u3092\u30bb\u30c3\u30c8\u3067\u304d\u308b\u304b\u3069\u3046\u304b\u3092\u8fd4\u3059\n    :param i: \u30ad\u30e3\u30f3\u30c7\u30a3\u30fc\u3092\u30bb\u30c3\u30c8\u3059\u308b\u6700\u3082\u5de6\u4e0a\u306e\u30de\u30b9\u306e\u884c\u756a\u53f7\n    :param j: \u30ad\u30e3\u30f3\u30c7\u30a3\u30fc\u3092\u30bb\u30c3\u30c8\u3059\u308b\u6700\u3082\u5de6\u4e0a\u306e\u30de\u30b9\u306e\u5217\u756a\u53f7\n    :param height: \u30bb\u30c3\u30c8\u3057\u305f\u3044\u30ad\u30e3\u30f3\u30c7\u30a3\u30fc\u306e\u7e26\u306e\u9577\u3055\n    :param width: \u30bb\u30c3\u30c8\u3057\u305f\u3044\u30ad\u30e3\u30f3\u30c7\u30a3\u30fc\u306e\u6a2a\u306e\u9577\u3055\n    :return: \u30bb\u30c3\u30c8\u53ef\u80fd\uff08True\uff09\u304b\u30bb\u30c3\u30c8\u4e0d\u53ef\u80fd\uff08False\uff09\u304b\n    \"\"\"\n    global candy_box\n    try:\n        return 0 == sum(candy_box[i + k][j + l] for k in xrange(height) for l in xrange(width))\n    except Exception:\n        return False\n```\n* settable_pos\u306f\uff0c\u30ad\u30e3\u30f3\u30c7\u30a3\u30fc\u30dc\u30c3\u30af\u30b9\u306b\u304a\u3044\u3066\u30ad\u30e3\u30f3\u30c7\u30a3\u30fc\u3092\u914d\u7f6e\u53ef\u80fd\u306a\u5ea7\u6a19$(i, j)$\u306e\u30ea\u30b9\u30c8\u3067\u3059\uff0e\n * \u4f8b\u3048\u3070\u30ef\u30f3\u30c0\u306e\u5834\u5408\uff0c[(0, 1), (0, 2), (0, 6), ...]\u3068\u306a\u3063\u3066\u3044\u307e\u3059\uff0e \n* is_settable\u306f\uff0c\u30ad\u30e3\u30f3\u30c7\u30a3\u30fc\u30dc\u30c3\u30af\u30b9\u306e\u5ea7\u6a19$(i, j)$\u3092\u5de6\u4e0a\u306e\u70b9\u3068\u3057\u3066\uff0c\u7e26\u306e\u9577\u3055height\uff0c\u6a2a\u306e\u9577\u3055width\u306e\u5927\u304d\u3055\u306e\u30ad\u30e3\u30f3\u30c7\u30a3\u30fc\u3092\u914d\u7f6e\u53ef\u80fd\u304b\u3069\u3046\u304b\u3092\u5224\u5b9a\u3059\u308b\u95a2\u6570\u3067\u3059\uff0e\n * \u914d\u7f6e\u53ef\u80fd\u306a\u3089True\uff0c\u305d\u3046\u3067\u306a\u3051\u308c\u3070False\u3092\u8fd4\u3057\u307e\u3059\uff0e\n\n## \u30e2\u30c7\u30eb\u306e\u4f5c\u6210\n\u3067\u306f\u3044\u3088\u3044\u3088\u6570\u5f0f\u3092\u8868\u73fe\u3057\u3066\u3044\u304d\u307e\u3059\uff0e\u307e\u305a\u306f\uff0c\u30e2\u30c7\u30eb\u81ea\u4f53\u3092\u8868\u3059LpProblem\u30af\u30e9\u30b9\u306e\u30aa\u30d6\u30b8\u30a7\u30af\u30c8model\u3092\u751f\u6210\u3057\u3066\u304a\u304d\u307e\u3059\uff0e\n\n```py:\n# \u6700\u9069\u5316\u554f\u984c\u306e\u30e2\u30c7\u30eb\u4f5c\u6210\u3002\u4fa1\u5024\u306e\u5408\u8a08\u306e\u6700\u5927\u5316\u304c\u76ee\u7684\nmodel = LpProblem('SetCandyProblem', LpMaximize)\n```\n* 'SetCandyProblem'\u3068\u3044\u3046\u306e\u306f\u30e2\u30c7\u30eb\u306e\u540d\u524d\u3067\uff0c\u4efb\u610f\u306e\u6587\u5b57\u5217\u3067\u3059\uff0e\n* LpMaximize\u3068\u3044\u3046\u306e\u306f\uff0c\u4eca\u56de\u306e\u76ee\u7684\u95a2\u6570\u304c\u6700\u5927\u5316\u3067\u3042\u308b\u3053\u3068\u3092\u793a\u3057\u3066\u3044\u307e\u3059\uff0e\u6700\u5c0f\u5316\u306a\u3089LpMinimize\u3067\u3059\uff0e\n\u3053\u308c\u4ee5\u964d\uff0c\u3053\u306emodel\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306b\u5bfe\u3057\u3066\u5236\u7d04\u3092\u8ffd\u52a0\u3057\u305f\u308a\u76ee\u7684\u95a2\u6570\u3092\u8ffd\u52a0\u3057\u3066\u3044\u304d\u307e\u3059\uff0e\n\n### \u5909\u6570\u306e\u4f5c\u6210\n\u5909\u6570\u3092\u8868\u3059\u30af\u30e9\u30b9LpVariable\u306e\u30aa\u30d6\u30b8\u30a7\u30af\u30c8x[i, j, p]\u3092\u751f\u6210\u3057\u3066\u304a\u304d\u307e\u3059\uff0e\n\n```py:\n# \u5909\u6570x\u306e\u4f5c\u6210\nx = {}\nfor i, j in settable_pos:\n    for name, candy in candies.iteritems():\n        if is_settable(i, j, candy['height'], candy['width']):\n            # 0-1\u5909\u6570\u3068\u3057\u3066\u5b9a\u7fa9\n            x[i, j, name] = LpVariable('x_({},{},{})'.format(i, j, name), cat=LpBinary)\n        else:\n            # \u305d\u3082\u305d\u3082\u914d\u7f6e\u4e0d\u53ef\u80fd\u306a\u5834\u5408\u306f\u5909\u6570\u3068\u3057\u3066\u5b9a\u7fa9\u3057\u306a\u3044\uff08\uff1d\u89e3\u304d\u3084\u3059\u304f\u306a\u308b\uff09\n            # \u3055\u3089\u306b\u3001\u3053\u3046\u3057\u3066\u304a\u304f\u30681\u756a\u76ee\u306e\u5236\u7d04\u3092\u66f8\u304b\u306a\u304f\u3066\u3088\u304f\u306a\u308b\n            x[i, j, name] = 0\n```\n\u3053\u3053\u3067\uff0cLpVariable()\u306b\u6e21\u3057\u3066\u3044\u308b\u5f15\u6570\u306e\u5185\u524d\u8005\u306f\u305d\u306e\u5909\u6570\u306e\u540d\u524d\uff0c\u5f8c\u8005\u306f\u7a2e\u985e\u3092\u8868\u3057\u3066\u304a\u308a\uff0cLpBinary\u3068\u306f\u305d\u306e\u540d\u306e\u901a\u308a0-1\u5909\u6570\u3092\u610f\u5473\u3057\u307e\u3059\uff0e\n\u540d\u524d\u306f\u6307\u5b9a\u3057\u306a\u3044\u5834\u5408\u306f\u9069\u5f53\u306a\u540d\u524d\u304c\u4ed8\u3051\u3089\u308c\u308b\u305f\u3081\uff0c\u7701\u7565\u53ef\u80fd\u3067\u3059\uff0e\n\u30c7\u30d5\u30a9\u30eb\u30c8\u306e\u7a2e\u985e\u306f\u9023\u7d9a\u5909\u6570\uff08LpContinuous\uff09\u306e\u305f\u3081\uff0c\u9023\u7d9a\u5909\u6570\u306e\u5834\u5408\u306f\u7701\u7565\u53ef\u80fd\u3067\u3059\uff0e\n\u305d\u306e\u4ed6\uff0c\u9023\u7d9a\u5909\u6570\u3084\u6574\u6570\u5909\u6570\uff08LpInteger\uff09\u306e\u5834\u5408\u306b\u306f\uff0c\u305d\u306e\u5909\u6570\u306e\u4e0a\u9650\uff08upBound\uff0c\u30c7\u30d5\u30a9\u30eb\u30c8\u306fNone\u3067\u7121\u9650\u5927\uff09\uff0c\u4e0b\u9650\uff08lowBound\uff0c\u30c7\u30d5\u30a9\u30eb\u30c8\u306fNone\u3067\u8ca0\u306e\u7121\u9650\u5927\uff09\u3092\u6307\u5b9a\u3059\u308b\u3053\u3068\u3082\u3067\u304d\u307e\u3059\uff0e\n\n### 2\u756a\u76ee\u306e\u5236\u7d04\n\u30ad\u30e3\u30f3\u30c7\u30a3\u30fc\u30dc\u30c3\u30af\u30b9\u306e\u3042\u308b\u5ea7\u6a19$(i,j)$\u306b\u7f6e\u3051\u308b\u30ad\u30e3\u30f3\u30c7\u30a3\u30fc\u306f1\u3064\u306e\u307f\u3067\u3042\u308b\u5236\u7d04\u3092\u8ffd\u52a0\u3057\u307e\u3059\uff0e\n\n```py:\nlin_expressions = {(i, j): LpAffineExpression() for i, j in settable_pos}\nfor i, j in settable_pos:\n    for name, candy in candies.iteritems():\n        if not is_settable(i, j, candy['height'], candy['width']):\n            continue\n        for k in xrange(candy['height']):\n            for l in xrange(candy['width']):\n                lin_expressions[i + k, j + l] += x[i, j, name]\nfor pos, lhs in lin_expressions.iteritems():\n    model += lhs <= 1, 'OnlySetConstraint:{}'.format(pos)\n```\n\u3053\u3053\u3067\u306f\uff0c\u5236\u7d04\u306f$(i,j)$\u306e\u7dcf\u3066\u306e\u7d44\u5408\u305b\u306b\u5bfe\u3057\u3066\u5b58\u5728\u3059\u308b\u305f\u3081\uff0c\u307e\u305a\u5404\u7d44\u5408\u305b\u306b\u5bfe\u3057\u3066\u7dda\u5f62\u5f0f\u3092\u8868\u3059\uff08\u7dda\u5f62\u8868\u73fe\uff09LpAffineExpression\u30af\u30e9\u30b9\u306e\u30aa\u30d6\u30b8\u30a7\u30af\u30c8lin_expressions[i, j]\u3092\u751f\u6210\u3057\u3066\u3044\u307e\u3059\uff0e\u3053\u308c\u306f\uff0c2\u756a\u76ee\u306e\u5236\u7d04\u306e\u5de6\u8fba\u3092\u8868\u3059\u305f\u3081\u306e\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3067\u3059\uff0e\n\u305d\u306e\u5f8c\uff0c\u5168\u3066\u306e\u5909\u6570\u306b\u5bfe\u3057\u3066\u7740\u76ee\u3057\uff0c\u305d\u306e\u5909\u6570\u304c1\uff08\u3064\u307e\u308a\u30ad\u30e3\u30f3\u30c7\u30a3\u30fc\u3092\u914d\u7f6e\u3059\u308b\uff09\u306b\u306a\u3063\u305f\u5834\u5408\u306b\u5c02\u6709\u3059\u308b\u5ea7\u6a19$(i+k, j+l)$\u306e\u7dda\u5f62\u8868\u73fe\u306b\u305d\u306e\u5909\u6570\u3092\u8ffd\u52a0\u6307\u5b9a\u307e\u3059\uff0e\n\u6700\u5f8c\u306b\uff0c\u5404\u5236\u7d04\u306e\u5de6\u8fba\u306e\u4f5c\u6210\u304c\u7d42\u308f\u3063\u305f\u6bb5\u968e\u3067\uff0c\u305d\u308c\u304c1\u4ee5\u4e0b\u3067\u3042\u308b\uff08lhs <= 1\uff09\u3068\u3044\u3046\u5236\u7d04\u3092\u30e2\u30c7\u30eb\u306b\u8ffd\u52a0\u3057\u3066\u3044\u307e\u3059\uff0e\u300c'OnlySetConstraint:{}'.format(pos)\u300d\u3068\u3044\u3046\u306e\u306f\uff0c\u305d\u306e\u5236\u7d04\u306e\u540d\u524d\u3092\u8868\u3057\u3066\u3044\u307e\u3059\u304c\uff0c\u306a\u304f\u3066\u3082\u9069\u5f53\u306a\u540d\u524d\u304c\u4ed8\u3051\u3089\u308c\u307e\u3059\uff0e\n\n### 3\u756a\u76ee\u306e\u5236\u7d04\uff08\u5de6\u5074\uff09\n\u30ad\u30e3\u30f3\u30c7\u30a3\u30fc\u30dc\u30c3\u30af\u30b9\u5168\u4f53\u3067\u30ad\u30e3\u30f3\u30c7\u30a3\u30fc$p$\u306e\u914d\u7f6e\u500b\u6570\u306f\u6700\u4f4e\u500b\u6570\u4ee5\u4e0a\u3067\u3042\u308b\u3068\u3044\u3046\u5236\u7d04\u3092\u8ffd\u52a0\u3057\u307e\u3059\uff0e\n\n```py:\nfor name, candy in candies.iteritems():\n    if candy.get('min_set', 0) <= 0:\n        continue\n    model += lpSum(x[i, j, name] for i, j in settable_pos) >= candy['min_set'], 'MinSetConstraint:{}'.format(name)\n```\n\u3053\u308c\u306f\u308f\u304b\u308a\u3084\u3059\u3044\u3067\u3059\u306d\uff0e\n\u30ad\u30e3\u30f3\u30c7\u30a3\u30fc\u3054\u3068\u306bfor\u6587\u3092\u56de\u3057\uff0c\u5bfe\u8c61\u30ad\u30e3\u30f3\u30c7\u30a3\u30fc\u306b\u95a2\u3059\u308b\u5909\u6570\u5168\u3066\u3092\u8db3\u3057\u305f\u3082\u306e\uff08\u3064\u307e\u308a\u30ad\u30e3\u30f3\u30c7\u30a3\u30fc\u3092\u914d\u7f6e\u3059\u308b\u500b\u6570\uff09\u304c\u4e0b\u9650\uff08candy['min_set']\uff09\u4ee5\u4e0a\u3067\u3042\u308b\u3053\u3068\u3092\u8868\u3057\u3066\u3044\u307e\u3059\uff0e\n\n### 3\u756a\u76ee\u306e\u5236\u7d04\uff08\u53f3\u5074\uff09\n\u540c\u69d8\u306b\uff0c\u30ad\u30e3\u30f3\u30c7\u30a3\u30fc\u30dc\u30c3\u30af\u30b9\u5168\u4f53\u3067\u30ad\u30e3\u30f3\u30c7\u30a3\u30fc$p$\u306e\u914d\u7f6e\u500b\u6570\u306f\u4e0a\u9650\u4ee5\u4e0b\u3067\u3042\u308b\u3068\u3044\u3046\u5236\u7d04\u3092\u8ffd\u52a0\u3057\u307e\u3059\uff0e\n\n```py:\nfor name, candy in candies.iteritems():\n    if candy.get('max_set') is None:\n        if name.endswith('_parfait'):\n            # \u30d1\u30d5\u30a7\u3060\u3051\u306f\u4e0a\u96501\u3067\u6c7a\u307e\u3063\u3066\u3044\u308b\n            model += lpSum(x[i, j, name] for i, j in settable_pos) <= 1, 'MaxSetConstraint:{}'.format(name)\n        continue\n    model += lpSum(x[i, j, name] for i, j in settable_pos) <= candy['max_set'], 'MaxSetConstraint:{}'.format(name)\n```\n\u57fa\u672c\u7684\u306b\u306f\u4e0b\u9650\u306e\u5834\u5408\u3068\u540c\u69d8\u3067\u3059\u304c\uff0c\u7a2e\u985e\u304c\u30d1\u30d5\u30a7\u306e\u5834\u5408\u3060\u3051\u306f\u4e0a\u9650\u304c1\u3064\u306b\u3064\u304d1\u500b\u3068\u4ed5\u69d8\u4e0a\u6c7a\u307e\u3063\u3066\u3044\u307e\u3059\uff0e\n\n### 4\u756a\u76ee\u306e\u5236\u7d04\n\u30ad\u30e3\u30f3\u30c7\u30a3\u30fc\u30dc\u30c3\u30af\u30b9\u5168\u4f53\u3067\u30ad\u30e3\u30f3\u30c7\u30a3\u30fc\u306e\u7a2e\u985e\u3054\u3068\u306e\u914d\u7f6e\u500b\u6570\u304c\u4e0a\u9650\u3092\u8d85\u3048\u306a\u3044\u3053\u3068\u3092\u8868\u3059\u5236\u7d04\u3092\u8ffd\u52a0\u3057\u307e\u3059\uff0e\n\n```py:\nlin_expressions = {type_name: LpAffineExpression() for type_name in max_set_by_types.keys()}\nfor i, j in settable_pos:\n    for name, candy in candies.iteritems():\n        try:\n            lin_expressions[name[name.rfind('_')+1:]] += x[i, j, name]\n        except Exception:\n            print('Invalid Candy Name! Unknown candy type.: {}'.format(name))\nfor name, lhs in lin_expressions.iteritems():\n    model += lhs <= max_set_by_types[name], 'MaxSetByTypeConstraints:{}'.format(name)\n```\n2\u756a\u76ee\u306e\u5236\u7d04\u3069\u540c\u69d8\u306b\uff0c\u4eca\u5ea6\u306f\u7a2e\u985e\u3054\u3068\u306b\u7dda\u5f62\u8868\u73fe\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u4f5c\u6210\u3057\u3066\u304a\u304d\u307e\u3059\uff0e\n\u305d\u306e\u5f8c\uff0c\u5909\u6570\u3054\u3068\u306b\u7740\u76ee\u3057\uff0c\u305d\u306e\u5909\u6570\u306e\u30ad\u30e3\u30f3\u30c7\u30a3\u30fc\u306e\u7a2e\u985e\u306b\u5408\u308f\u305b\u305f\u7dda\u5f62\u8868\u73fe\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306b\u305d\u306e\u5909\u6570\u3092\u8ffd\u52a0\u3057\u3066\u3044\u307e\u3059\uff0e\n\u305d\u3057\u3066\u6700\u5f8c\u306b\u30e2\u30c7\u30eb\u306b\u5236\u7d04\u3068\u3057\u3066\u8ffd\u52a0\u3057\u3066\u3044\u307e\u3059\uff0e\n\n### \u76ee\u7684\u95a2\u6570\n\u76ee\u7684\u95a2\u6570\u3092\u8ffd\u52a0\u3057\u307e\u3059\uff0e\n\n```py:\n# \u76ee\u7684\u95a2\u6570\nmodel += lpSum(candy['profit'] * x[i, j, name] for i, j in settable_pos for name, candy in candies.iteritems())\n```\n\u76ee\u7684\u95a2\u6570\u306f\uff0c\u5404\u30ad\u30e3\u30f3\u30c7\u30a3\u30fc\u306e\u4fa1\u5024candy['profit']\u3068\u305d\u308c\u3092\u7f6e\u3044\u305f\u5834\u54081\uff0c\u305d\u308c\u4ee5\u5916\u306e\u3068\u304d0\u3068\u306a\u308b\u5909\u6570x\u306e\u7a4d\u306e\u7dcf\u548c\u3067\u3059\uff0e\n\u305d\u3057\u3066\u4ee5\u4e0a\u3067\u30e2\u30c7\u30eb\u306e\u8a18\u8ff0\u304c\u7d42\u308f\u308a\u307e\u3057\u305f\uff0e\u5f8c\u306f\u89e3\u3044\u3066\u7d50\u679c\u3092\u53d6\u3063\u3066\u304f\u308b\u3060\u3051\u3067\u3059\uff0e\n\n## \u6c42\u89e3\u3068\u7d50\u679c\u306e\u53d6\u5f97\n```py:\n# \u6c42\u89e3\u3068\u305d\u306e\u30b9\u30c6\u30fc\u30bf\u30b9\uff08\u6700\u9069\u89e3\u304c\u3067\u305f\u306e\u304b\u3069\u3046\u304b\uff09\u3092\u53d6\u5f97\nstatus = model.solve()\nprint('Status: {}'.format(LpStatus[status]))\nprint('CalculationTime: {:.3f}s'.format(model.solutionTime))\n\n# \u6700\u9069\u89e3\u304c\u51fa\u3066\u3044\u306a\u3051\u308c\u3070\u7d42\u4e86\nif status != LpStatusOptimal:\n    exit(0)\n\n# \u6700\u9069\u89e3\u304c\u51fa\u3066\u3044\u308c\u3070\u7d50\u679c\u3092\u51fa\u529b\u3057\u3066\u3044\u304f\n# \u76ee\u7684\u95a2\u6570\u5024\u51fa\u529b\nprint('Optimal value: {}'.format(model.objective.value()))\n\n# \u30ad\u30e3\u30f3\u30c7\u30a3\u30fc\u3068ID\u306e\u5bfe\u5fdc\u51fa\u529b\nsorted_candy_names = sorted(candies.keys(), key=lambda name: name[name.rfind('_'):]+name[:name.rfind('_')])\nprint('xxx: Block (can not set)\\nooo: Free space\\n---: \"Top-left\" candy\\'s space')\nprint('\\n'.join('{:0>3}: {}'.format(i, name) for i, name in enumerate(sorted_candy_names)))\n\n# \u30ad\u30e3\u30f3\u30c7\u30a3\u30fc\u30dc\u30c3\u30af\u30b9\u306e\u914d\u7f6e\u51fa\u529b\nsolution_box = [['xxx' if e > 0.5 else 'ooo' for e in l] for l in candy_box]\nfor i, j in settable_pos:\n    for ID, name in enumerate(sorted_candy_names):\n        if value(x[i, j, name]) < 0.5:\n            continue\n        for k in xrange(candies[name]['height']):\n            for l in xrange(candies[name]['width']):\n                solution_box[i + k][j + l] = '---'\n        solution_box[i][j] = '{:0>3}'.format(ID)\nprint('\\n-------------- Solution --------------')\nprint('\\n'.join(', '.join(l) for l in solution_box))\nprint('--------------    End   --------------')\n```\n\u4ee5\u4e0a\u306e\u30d7\u30ed\u30b0\u30e9\u30e0\u3092\u5b9f\u884c\u3059\u308b\u3068\uff0c\u79c1\u306e\u74b0\u5883\u3067\u306f\u4ee5\u4e0b\u306e\u69d8\u306a\u7d50\u679c\u3092\u5f97\u307e\u3057\u305f\uff0e\n\n```text:\nStatus: Optimal\nCalculationTime: 0.069s\nOptimal value: 452.0\nxxx: Block (can not set)\nooo: Free space\n---: \"Top-left\" candy's space\n000: ability_candy\n001: brow_resist_candy\n002: mind_resist_candy\n003: shot_resist_candy\n004: spirita_candy\n005: arm_cookie\n006: power_cookie\n007: shoot_cookie\n008: spirita_cookie\n009: stamina_cookie\n010: technique_cookie\n011: lucky_crepe\n012: otonano_crepe\n013: richna_crepe\n014: stamina_gmi\n015: 1stage_pancake\n016: 2stage_pancake\n017: 3stage_pancake\n018: blast_parfait\n019: gamushara_parfait\n020: harikiri_parfait\n021: hissatsu_parfait\n022: megaton_parfait\n023: pittari_parfait\n024: hikarino_ramune\n025: honoono_ramune\n026: kaminarino_ramune\n027: kazeno_ramune\n028: koorino_ramune\n029: yamino_ramune\n030: funbari_roll\n031: girigiri_roll\n032: henkan_roll\n033: migawari_roll\n034: muteki_roll\n035: ouen_roll\n036: shikkari_roll\n037: tsuyogari_roll\n038: body_sand\n039: mind_sand\n040: react_sand\n\n-------------- Solution --------------\nxxx, 005, ---, xxx, xxx, xxx, 029, xxx\n014, ---, ---, 030, ---, 020, ---, 014\n014, xxx, 014, ---, ---, ---, ---, xxx\n014, xxx, 009, ---, 017, ---, 038, ---\n038, ---, ---, ---, ---, ---, xxx, 014\nxxx, 032, ---, 017, ---, 014, xxx, 014\n014, ---, ---, ---, ---, 021, ---, 014\nxxx, 014, xxx, xxx, xxx, ---, ---, xxx\n--------------    End   --------------\n```\n\u6700\u9069\u89e3\u304c0.069\u79d2\u3067\u6c42\u307e\u308a\uff0c\u76ee\u7684\u95a2\u6570\u5024\u306f452\u3067\u3042\u3063\u305f\u3068\u3044\u3046\u3053\u3068\u304c\u8aad\u307f\u53d6\u308c\u307e\u3059\uff0e\n\n*<Font color=\"red\">\u6ce8\u610f\uff09\u3042\u304f\u307e\u3067\u30b5\u30f3\u30d7\u30eb\u7684\u306a\u30c7\u30fc\u30bf\u3067\u89e3\u3044\u305f\u7d50\u679c\u306e\u305f\u3081\uff0c\u5b9f\u969b\u306b\u4f7f\u3046\u969b\u306b\u306f\u81ea\u5206\u3067\u30ad\u30e3\u30f3\u30c7\u30a3\u30fc\u306e\u4fa1\u5024\u3084\u6700\u4f4e\u914d\u7f6e\u500b\u6570\u306a\u3069\u3092\u8abf\u6574\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\uff0e</font>*\n\n# \u4f59\u529b\u306e\u3042\u308b\u4eba\u5411\u3051\n\u540c\u3058\u76ee\u7684\u95a2\u6570\u5024\u3067\u4ed6\u306e\u89e3\u304c\u3042\u308b\u306e\u3067\u306f\u306a\u3044\u304b\uff1f\u3068\u92ed\u3044\u65b9\u306f\u601d\u3063\u305f\u304b\u3082\u3057\u308c\u307e\u305b\u3093\uff0e\u305d\u306e\u901a\u308a\u3067\u3059\uff0e\n\u4f59\u529b\u306e\u3042\u308b\u4eba\u306f\uff0c\u4ee5\u4e0b\u306e\u69d8\u306a\u5185\u5bb9\u306b\u6311\u6226\u3057\u3066\u307f\u3066\u306f\u3044\u304b\u304c\u3067\u3057\u3087\u3046\u304b\uff0e\n\n* \u540c\u3058\u76ee\u7684\u95a2\u6570\u5024\u3068\u306a\u308b\u3088\u3046\u306a\u89e3\u3092\u5168\u3066\u51fa\u3059\u3088\u3046\u306b\u3059\u308b\n* \u540c\u3058\u76ee\u7684\u95a2\u6570\u5024\u3067\u3042\u308c\u3070\uff0c\u3067\u304d\u308b\u3060\u3051\u591a\u304f\u306e\u7a2e\u985e\u306e\u30ad\u30e3\u30f3\u30c7\u30a3\u30fc\u3092\u914d\u7f6e\u3059\u308b\n\n# \u304a\u308f\u308a\u306b\n\u3055\u3066\uff0c\u4eca\u56de\u306f[\u524d\u56de\u306e\u8a18\u4e8b](http://qiita.com/lovely_TGSHR/items/4bf71fff44b4061f9209 \"PSO2\u3067\u30da\u30c3\u30c8\u306e\u30ad\u30e3\u30f3\u30c7\u30a3\u30fc\u914d\u7f6e\u3092\u6700\u9069\u5316\u3059\u308b\uff08\u5b9a\u5f0f\u5316\u7de8\uff09\")\u3067\u793a\u3057\u305f\u5b9a\u5f0f\u5316\u3092\u3082\u3068\u306b\uff0c\u5b9f\u969b\u306b\u30b3\u30fc\u30c9\u3092\u66f8\u3044\u3066\u554f\u984c\u3092\u89e3\u304f\u3068\u3053\u308d\u307e\u3067\u884c\u3044\u307e\u3057\u305f\uff0e\u75b2\u308c\u3066\u304b\u306a\u308a\u7aef\u6298\u3063\u3066\u3057\u307e\u3063\u305f\u305f\u3081\uff0c\u308f\u304b\u308a\u306b\u304f\u3044\u7b87\u6240\u3082\u3042\u308b\u304b\u3068\u601d\u3044\u307e\u3059\uff0e\n\u30b3\u30e1\u30f3\u30c8\u306a\u3069\u3067\u30ea\u30af\u30a8\u30b9\u30c8\u9802\u3051\u308c\u3070\uff0c\u6642\u9593\u306e\u3042\u308b\u3068\u304d\u306b\u305d\u306e\u7b87\u6240\u306b\u3064\u3044\u3066\u6398\u308a\u4e0b\u3052\u3066\u8ffd\u8a18\u3057\u3088\u3046\u3068\u601d\u3044\u307e\u3059\u306e\u3067\uff0c\u8cea\u554f\u306a\u3069\u3042\u308a\u307e\u3057\u305f\u3089\u30b3\u30e1\u30f3\u30c8\u3092\u3088\u308d\u3057\u304f\u304a\u9858\u3044\u3044\u305f\u3057\u307e\u3059\uff0e\n\u307e\u305f\uff0c\u4eca\u56de\u306f\u8aac\u660e\u3057\u3084\u3059\u304f\u3059\u308b\u305f\u3081\u306b\u30af\u30e9\u30b9\u5316\u306a\u3069\u306f\u884c\u3063\u3066\u3044\u307e\u305b\u3093\u304c\uff0c\u305d\u3082\u305d\u3082\u6700\u521d\u306b\u66f8\u3044\u305f\u3082\u306e\u306f\u30ad\u30e3\u30f3\u30c7\u30a3\u30fc\u30dc\u30c3\u30af\u30b9\u306a\u3069\u306f\u30af\u30e9\u30b9\u5316\u3057\u3066\u3044\u308b\u305f\u3081\uff0c\u8981\u671b\u304c\u3042\u308c\u3070\u305d\u3061\u3089\u3082\u516c\u958b\u3057\u3088\u3046\u3068\u601d\u3044\u307e\u3059\uff0e\n\u304a\u6c17\u3065\u304d\u306e\u70b9\u306a\u3069\u3054\u3056\u3044\u307e\u3057\u305f\u3089\u30b3\u30e1\u30f3\u30c8\u7b49\u3067\u3054\u6307\u6458\u3092\u304a\u9858\u3044\u3044\u305f\u3057\u307e\u3059\uff0e\n", "tags": ["Python", "pulp", "PSO2", "\u6700\u9069\u5316"]}