{"context": " More than 1 year has passed since last update.Docker\u30b3\u30f3\u30c6\u30ca\u306bbind\u3092\u5c0e\u5165\u3057\u3066MX\u30ec\u30b3\u30fc\u30c9\u3067\u30e1\u30fc\u30eb\u914d\u4fe1\u3067\u304d\u308b\u3088\u3046\u306b\u3057\u307e\u3057\u305f\u3002\nDocker\u30b3\u30f3\u30c6\u30ca\u3067Postfix+Dovecot\u3092\u5c0e\u5165\u3059\u308b\uff082\u53f0\u69cb\u6210\uff09\u306e\u7d9a\u304d\u3067\u3059\u3002\nDocker\u30b3\u30f3\u30c6\u30ca\u306b\u8d77\u52d5+\u56fa\u5b9aIP\u3092\u5272\u308a\u5f53\u3066\u307e\u3059\u3002\ndocker start bind\npipework br0 bind 172.17.0.100/16@172.17.42.1\ndocker attach bind\n\nbind\u3092\u5c0e\u5165\u3057\u307e\u3059\u3002\nyum -y install bind\nbind\u30d5\u30a1\u30a4\u30eb\u3092\u8ffd\u52a0\u3001\u4fee\u6b63\u3057\u307e\u3059\u3002\nvi /etc/named.conf\n\noptions {\n        listen-on port 53 { any; };\n        #listen-on-v6 port 53 { none; };\n        directory       \"/var/named\";\n        dump-file       \"/var/named/data/cache_dump.db\";\n        statistics-file \"/var/named/data/named_stats.txt\";\n        memstatistics-file \"/var/named/data/named_mem_stats.txt\";\n        allow-query     { 172.17.0.0/16; };\n        recursion yes;\n\n        dnssec-enable yes;\n        dnssec-validation yes;\n        dnssec-lookaside auto;\n\n        /* Path to ISC DLV key */\n        bindkeys-file \"/etc/named.iscdlv.key\";\n\n        managed-keys-directory \"/var/named/dynamic\";\n};\n\nlogging {\n        channel default_debug {\n                file \"data/named.run\";\n                severity dynamic;\n        };\n};\n\n#view \"internal\" {\n#        match-clients {\n#                localhost;\n#                172.17.0.0/16;\n#        };\n\nzone \".\" IN {\n        type hint;\n        file \"named.ca\";\n};\n        zone \"bind.local\"  {\n                type master;\n                file \"bind.local.lan\";\n                allow-update { none; };\n        };\n        zone \"smtp1.co.jp\"  {\n                type master;\n                file \"smtp1.co.jp.lan\";\n                allow-update { none; };\n\n        };\n        zone \"smtp2.co.jp\"  {\n                type master;\n                file \"smtp2.co.jp.lan\";\n                allow-update { none; };\n\n        };\n        zone \"0.17.172.in-addr.arpa\" {\n                type master;\n                file \"0.17.172.in-addr.arpa.db\";\n                allow-update { none; };\n        };\n#include \"/etc/named.rfc1912.zones\";\n#include \"/etc/named.root.key\";\n\n\nvi /var/named/bind.local.lan\n$TTL 86400\n@   IN  SOA     bind.local. root.bind.local. (\n        2014080201  ;Serial\n        3600        ;Refresh\n        1800        ;Retry\n        604800      ;Expire\n        86400       ;Minimum TTL\n)\n\n IN     NS      bind.local.\n IN     A       172.17.0.100\n IN     MX      10      test01.smtp1.co.jp.\n IN     MX      10      test02.smtp2.co.jp.\ntest01  IN      A       172.17.0.101\ntest02  IN      A       172.17.0.102\ntest03  IN      A       172.17.0.100\n\nvi /var/named/0.17.172.in-addr.arpa.db\n$TTL 86400\n@   IN  SOA     bind.local. root.bind.local. (\n        2014080201  ;Serial\n        3600        ;Refresh\n        1800        ;Retry\n        604800      ;Expire\n        86400       ;Minimum TTL\n)\n\n IN  NS      bind.local.\n IN  PTR     bind.local.\n\nvi /var/named/smtp1.co.jp.lan\n$TTL 86400\n@   IN  SOA     smtp1.co.jp. root.smtp1.co.jp. (\n        2014080201  ;Serial\n        3600        ;Refresh\n        1800        ;Retry\n        604800      ;Expire\n        86400       ;Minimum TTL\n)\n\n IN     NS      smtp1.co.jp.\n IN     A       172.17.0.101\n IN     MX      10      test01.smtp1.co.jp.\ntest01  IN      A       172.17.0.101\n\nvi /var/named/smtp2.co.jp.lan\n$TTL 86400\n@   IN  SOA     smtp2.co.jp. root.smtp2.co.jp. (\n        2014080201  ;Serial\n        3600        ;Refresh\n        1800        ;Retry\n        604800      ;Expire\n        86400       ;Minimum TTL\n)\n\n IN     NS      smtp2.co.jp.\n IN     A       172.17.0.102\n IN     MX      10      test02.smtp2.co.jp.\ntest02  IN      A       172.17.0.102\n\nbind\u3092\u8d77\u52d5\u3057\u307e\u3059\u3002\nservice named start\n  chkconfig named on\n2\u53f0\u306e\u30e1\u30fc\u30eb\u30b5\u30fc\u30d0\u306emain.cf\u306erelayhost\u3092\u30b3\u30e1\u30f3\u30c8\u30a2\u30a6\u30c8\u3057\u307e\u3059\u3002\nsmtp1\n#relayhost = 172.17.0.102\n\nsmtp2\n#relayhost = 172.17.0.101\n\n2\u53f0\u306e\u30e1\u30fc\u30eb\u30b5\u30fc\u30d0\u306e/etc/resolv.conf\u306b\u4ee5\u4e0b\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\nnameserver 172.17.0.100\n\npostfix\u3092\u518d\u8d77\u52d5\u3057\u307e\u3059\u3002\n\u30e1\u30fc\u30eb\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u3067\u76f8\u4e92\u758e\u901a\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\nDocker\u30b3\u30f3\u30c6\u30ca\u306bbind\u3092\u5c0e\u5165\u3057\u3066MX\u30ec\u30b3\u30fc\u30c9\u3067\u30e1\u30fc\u30eb\u914d\u4fe1\u3067\u304d\u308b\u3088\u3046\u306b\u3057\u307e\u3057\u305f\u3002\n\nDocker\u30b3\u30f3\u30c6\u30ca\u3067Postfix+Dovecot\u3092\u5c0e\u5165\u3059\u308b\uff082\u53f0\u69cb\u6210\uff09\u306e\u7d9a\u304d\u3067\u3059\u3002\n\nDocker\u30b3\u30f3\u30c6\u30ca\u306b\u8d77\u52d5+\u56fa\u5b9aIP\u3092\u5272\u308a\u5f53\u3066\u307e\u3059\u3002\n\n```bash\ndocker start bind\npipework br0 bind 172.17.0.100/16@172.17.42.1\ndocker attach bind\n```\n\nbind\u3092\u5c0e\u5165\u3057\u307e\u3059\u3002\n\n yum -y install bind\n\nbind\u30d5\u30a1\u30a4\u30eb\u3092\u8ffd\u52a0\u3001\u4fee\u6b63\u3057\u307e\u3059\u3002\n\nvi /etc/named.conf\n\n```bash\n\noptions {\n        listen-on port 53 { any; };\n        #listen-on-v6 port 53 { none; };\n        directory       \"/var/named\";\n        dump-file       \"/var/named/data/cache_dump.db\";\n        statistics-file \"/var/named/data/named_stats.txt\";\n        memstatistics-file \"/var/named/data/named_mem_stats.txt\";\n        allow-query     { 172.17.0.0/16; };\n        recursion yes;\n\n        dnssec-enable yes;\n        dnssec-validation yes;\n        dnssec-lookaside auto;\n\n        /* Path to ISC DLV key */\n        bindkeys-file \"/etc/named.iscdlv.key\";\n\n        managed-keys-directory \"/var/named/dynamic\";\n};\n\nlogging {\n        channel default_debug {\n                file \"data/named.run\";\n                severity dynamic;\n        };\n};\n\n#view \"internal\" {\n#        match-clients {\n#                localhost;\n#                172.17.0.0/16;\n#        };\n\nzone \".\" IN {\n        type hint;\n        file \"named.ca\";\n};\n        zone \"bind.local\"  {\n                type master;\n                file \"bind.local.lan\";\n                allow-update { none; };\n        };\n        zone \"smtp1.co.jp\"  {\n                type master;\n                file \"smtp1.co.jp.lan\";\n                allow-update { none; };\n\n        };\n        zone \"smtp2.co.jp\"  {\n                type master;\n                file \"smtp2.co.jp.lan\";\n                allow-update { none; };\n\n        };\n        zone \"0.17.172.in-addr.arpa\" {\n                type master;\n                file \"0.17.172.in-addr.arpa.db\";\n                allow-update { none; };\n        };\n#include \"/etc/named.rfc1912.zones\";\n#include \"/etc/named.root.key\";\n\n```\nvi /var/named/bind.local.lan\n\n```bash\n$TTL 86400\n@   IN  SOA     bind.local. root.bind.local. (\n        2014080201  ;Serial\n        3600        ;Refresh\n        1800        ;Retry\n        604800      ;Expire\n        86400       ;Minimum TTL\n)\n\n IN     NS      bind.local.\n IN     A       172.17.0.100\n IN     MX      10      test01.smtp1.co.jp.\n IN     MX      10      test02.smtp2.co.jp.\ntest01  IN      A       172.17.0.101\ntest02  IN      A       172.17.0.102\ntest03  IN      A       172.17.0.100\n```\n\nvi /var/named/0.17.172.in-addr.arpa.db\n\n```bash\n$TTL 86400\n@   IN  SOA     bind.local. root.bind.local. (\n        2014080201  ;Serial\n        3600        ;Refresh\n        1800        ;Retry\n        604800      ;Expire\n        86400       ;Minimum TTL\n)\n\n IN  NS      bind.local.\n IN  PTR     bind.local.\n```\n\nvi /var/named/smtp1.co.jp.lan\n\n```bash\n$TTL 86400\n@   IN  SOA     smtp1.co.jp. root.smtp1.co.jp. (\n        2014080201  ;Serial\n        3600        ;Refresh\n        1800        ;Retry\n        604800      ;Expire\n        86400       ;Minimum TTL\n)\n\n IN     NS      smtp1.co.jp.\n IN     A       172.17.0.101\n IN     MX      10      test01.smtp1.co.jp.\ntest01  IN      A       172.17.0.101\n```\nvi /var/named/smtp2.co.jp.lan\n\n```bash\n$TTL 86400\n@   IN  SOA     smtp2.co.jp. root.smtp2.co.jp. (\n        2014080201  ;Serial\n        3600        ;Refresh\n        1800        ;Retry\n        604800      ;Expire\n        86400       ;Minimum TTL\n)\n\n IN     NS      smtp2.co.jp.\n IN     A       172.17.0.102\n IN     MX      10      test02.smtp2.co.jp.\ntest02  IN      A       172.17.0.102\n```\n\nbind\u3092\u8d77\u52d5\u3057\u307e\u3059\u3002\n\n  service named start\n  chkconfig named on\n\n2\u53f0\u306e\u30e1\u30fc\u30eb\u30b5\u30fc\u30d0\u306emain.cf\u306erelayhost\u3092\u30b3\u30e1\u30f3\u30c8\u30a2\u30a6\u30c8\u3057\u307e\u3059\u3002\n\nsmtp1\n\n```bash\n#relayhost = 172.17.0.102\n```\n\nsmtp2\n\n```bash\n#relayhost = 172.17.0.101\n```\n\n2\u53f0\u306e\u30e1\u30fc\u30eb\u30b5\u30fc\u30d0\u306e/etc/resolv.conf\u306b\u4ee5\u4e0b\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n\n```bash\nnameserver 172.17.0.100\n```\n\npostfix\u3092\u518d\u8d77\u52d5\u3057\u307e\u3059\u3002\n\n\u30e1\u30fc\u30eb\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u3067\u76f8\u4e92\u758e\u901a\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\n", "tags": ["docker", "postfix", "bind"]}