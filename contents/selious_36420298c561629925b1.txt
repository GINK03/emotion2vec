{"context": " More than 1 year has passed since last update.\n\n\u6982\u8981\n[DIR_NAME]\u4ee5\u4e0b\u30d5\u30a1\u30a4\u30eb\u5168\u3066\u3092\u5bfe\u8c61\u306b\u3001\n[TARGET_ENCODING_LIST]\u306b\u5b9a\u7fa9\u3055\u308c\u3066\u3044\u308b\u6587\u5b57\u30b3\u30fc\u30c9\u306e\u30c6\u30ad\u30b9\u30c8\u30d5\u30a1\u30a4\u30eb\u304b\u30c1\u30a7\u30c3\u30af\u3057\u3066\u3001\n\u30c6\u30ad\u30b9\u30c8\u30d5\u30a1\u30a4\u30eb\u306a\u3089\u3001[SEARCH_WORD]\u304c\u3042\u308b\u304b\u691c\u7d22\u3057\u3066\u3001\n\u7d50\u679c\u3092\u3001[OUTPUT_NAME]\u306e\u30d5\u30a1\u30a4\u30eb\u540d\u306b\u51fa\u529b\u3057\u307e\u3059\u3002\n\n\u74b0\u5883\nWindows8\uff0bPython2.6\u7cfb\n\n\u30b3\u30fc\u30c9\n\nfind_directory.py\n#!/usr/bin/python\n# -*- coding: utf-8 -*-\n# vim: fileencoding=utf-8\n\nimport os , sys , codecs\n\nDIR_NAME = 'C:\\\\html\\\\HOGE\\\\'\nOUTPUT_NAME = 'result_find_file_list.csv'\n\nSEARCH_WORD = '<font'\n\nTARGET_ENCODINGS = [\n    'utf-8',\n    'shift-jis',\n    'euc-jp',\n    'iso2022-jp'\n]\n\nFLAG_STDOUT = True\n#FLAG_STDOUT = False\n\nimport os, sys\n\nwrite = sys.stdout.write\n\ndef guess_charset(data):\n    file = lambda d, encoding: d.decode(encoding) and encoding\n    for enc in TARGET_ENCODINGS:\n        try:\n            file(data, enc)\n            return enc\n        except:\n            pass\n    return 'binary'\n\nout = codecs.open(OUTPUT_NAME, 'w', 'shift-jis')\nout.write('path,line_number,search,target_line\\n')\n\nfor dirpath, dirs, files in os.walk(DIR_NAME):\n    for fn in files:\n        path = os.path.join(dirpath, fn)\n        fobj = file(path, 'rU')\n        data = fobj.read()\n        fobj.close()\n        try:\n            enc = guess_charset(data)\n        except:\n            continue\n        if enc == 'binary':\n            continue\n        count = 0\n        try:\n            for l in codecs.open(path, 'r', enc):\n                count = count + 1\n                if SEARCH_WORD in l:\n                    output = ''\n                    try:\n                        output = '\"' + path + '\",\"' + str(count) + '\",\"' + SEARCH_WORD + '\",\"' + l.replace('\"',\"'\").replace('\\r','').replace('\\n','') + '\"\\r\\n'\n                    except:\n                        continue\n                    if FLAG_STDOUT == True:\n                        write(output)\n                    out.write(output)\n        except:\n            continue\n\n\n\n\u88dc\u8db3\n\u4f8b\u306b\u3088\u3063\u3066\u3001\u4f8b\u5916\u51e6\u7406\u306f\u3001\u9069\u5f53\u3067\u3059\u3002\n\u3044\u308d\u3044\u308d\u30ea\u30d5\u30a1\u30af\u30bf\u30ea\u30f3\u30b0\u306e\u4f59\u5730\u3042\u308a\u3067\u3059\u304c\u3001\n\u660e\u65e5\u5b9f\u6226\u6295\u5165\u3057\u305f\u3044\u306e\u3067\u3001\u4e00\u65e6\u3001\u3053\u306e\u307e\u307e\u6295\u7a3f\n# \u6982\u8981\n\n[DIR_NAME]\u4ee5\u4e0b\u30d5\u30a1\u30a4\u30eb\u5168\u3066\u3092\u5bfe\u8c61\u306b\u3001\n[TARGET_ENCODING_LIST]\u306b\u5b9a\u7fa9\u3055\u308c\u3066\u3044\u308b\u6587\u5b57\u30b3\u30fc\u30c9\u306e\u30c6\u30ad\u30b9\u30c8\u30d5\u30a1\u30a4\u30eb\u304b\u30c1\u30a7\u30c3\u30af\u3057\u3066\u3001\n\u30c6\u30ad\u30b9\u30c8\u30d5\u30a1\u30a4\u30eb\u306a\u3089\u3001[SEARCH_WORD]\u304c\u3042\u308b\u304b\u691c\u7d22\u3057\u3066\u3001\n\u7d50\u679c\u3092\u3001[OUTPUT_NAME]\u306e\u30d5\u30a1\u30a4\u30eb\u540d\u306b\u51fa\u529b\u3057\u307e\u3059\u3002\n\n\n# \u74b0\u5883\nWindows8\uff0bPython2.6\u7cfb\n\n\n# \u30b3\u30fc\u30c9\n\n```python:find_directory.py\n#!/usr/bin/python\n# -*- coding: utf-8 -*-\n# vim: fileencoding=utf-8\n\nimport os , sys , codecs\n\nDIR_NAME = 'C:\\\\html\\\\HOGE\\\\'\nOUTPUT_NAME = 'result_find_file_list.csv'\n\nSEARCH_WORD = '<font'\n\nTARGET_ENCODINGS = [\n\t'utf-8',\n\t'shift-jis',\n\t'euc-jp',\n\t'iso2022-jp'\n]\n\nFLAG_STDOUT = True\n#FLAG_STDOUT = False\n\nimport os, sys\n\nwrite = sys.stdout.write\n\ndef guess_charset(data):\n\tfile = lambda d, encoding: d.decode(encoding) and encoding\n\tfor enc in TARGET_ENCODINGS:\n\t\ttry:\n\t\t\tfile(data, enc)\n\t\t\treturn enc\n\t\texcept:\n\t\t\tpass\n\treturn 'binary'\n\nout = codecs.open(OUTPUT_NAME, 'w', 'shift-jis')\nout.write('path,line_number,search,target_line\\n')\n\nfor dirpath, dirs, files in os.walk(DIR_NAME):\n\tfor fn in files:\n\t\tpath = os.path.join(dirpath, fn)\n\t\tfobj = file(path, 'rU')\n\t\tdata = fobj.read()\n\t\tfobj.close()\n\t\ttry:\n\t\t\tenc = guess_charset(data)\n\t\texcept:\n\t\t\tcontinue\n\t\tif enc == 'binary':\n\t\t\tcontinue\n\t\tcount = 0\n\t\ttry:\n\t\t\tfor l in codecs.open(path, 'r', enc):\n\t\t\t\tcount = count + 1\n\t\t\t\tif SEARCH_WORD in l:\n\t\t\t\t\toutput = ''\n\t\t\t\t\ttry:\n\t\t\t\t\t\toutput = '\"' + path + '\",\"' + str(count) + '\",\"' + SEARCH_WORD + '\",\"' + l.replace('\"',\"'\").replace('\\r','').replace('\\n','') + '\"\\r\\n'\n\t\t\t\t\texcept:\n\t\t\t\t\t\tcontinue\n\t\t\t\t\tif FLAG_STDOUT == True:\n\t\t\t\t\t\twrite(output)\n\t\t\t\t\tout.write(output)\n\t\texcept:\n\t\t\tcontinue\n```\n\n# \u88dc\u8db3\n\n\u4f8b\u306b\u3088\u3063\u3066\u3001\u4f8b\u5916\u51e6\u7406\u306f\u3001\u9069\u5f53\u3067\u3059\u3002\n\u3044\u308d\u3044\u308d\u30ea\u30d5\u30a1\u30af\u30bf\u30ea\u30f3\u30b0\u306e\u4f59\u5730\u3042\u308a\u3067\u3059\u304c\u3001\n\u660e\u65e5\u5b9f\u6226\u6295\u5165\u3057\u305f\u3044\u306e\u3067\u3001\u4e00\u65e6\u3001\u3053\u306e\u307e\u307e\u6295\u7a3f\n", "tags": ["Python", "encoding", "\u6587\u5b57\u30b3\u30fc\u30c9", "\u6587\u5b57\u5217\u51e6\u7406", "grep"]}