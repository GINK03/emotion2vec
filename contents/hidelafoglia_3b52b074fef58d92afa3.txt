{"context": "\nbuild.py\n\n\n\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u30eb\u30fc\u30c8\n$ ls mkdocs.yml\nmkdocs.yml\n\n$ ipython\n\n\nconfig \u3092\u30ed\u30fc\u30c9\u3059\u308b\nIn [1]: from mkdocs.config import load_config\nIn [2]: conf = load_config()\nIn [4]: type(conf)\nOut[4]: instance\nOut[5]:\n['__cmp__',\n '__contains__',\n '__delitem__',\n '__doc__',\n '__getitem__',\n '__hash__',\n '__init__',\n '__len__',\n '__module__',\n '__repr__',\n '__setitem__',\n '_post_validate',\n '_pre_validate',\n '_schema',\n '_schema_keys',\n '_validate',\n 'clear',\n 'copy',\n 'data',\n 'fromkeys',\n 'get',\n 'has_key',\n 'items',\n 'iteritems',\n 'iterkeys',\n 'itervalues',\n 'keys',\n 'load_dict',\n 'load_file',\n 'pop',\n 'popitem',\n 'set_defaults',\n 'setdefault',\n 'update',\n 'user_configs',\n 'validate',\n 'values']\n\nIn [8]: type(conf['pages'])\nOut[8]: list\n\nIn [9]: conf['use_directory_urls']\nOut[9]: True\n\n\n\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u4e00\u89a7\u3092\u4f5c\u6210\u3059\u308b\nIn [10]: from mkdocs import nav\n\nIn [11]: site_navigation = nav.SiteNavigation(conf['pages'], conf['use_directory_urls'])\n\nIn [12]: type(site_navigation)\nOut[12]: mkdocs.nav.SiteNavigation\n\n\nJinja2\u306e\u30ed\u30fc\u30c0\u30fc\nIn [14]: import jinja2\nIn [15]: loader = jinja2.FileSystemLoader(conf['theme_dir'] + [conf['mkdocs_templates'], ])\n\nIn [16]: type(loader)\nOut[16]: jinja2.loaders.FileSystemLoader\n\n\nJinja2\u306e\u74b0\u5883\nIn [17]: env = jinja2.Environment(loader=loader)\n\nIn [18]: type(env)\nOut[18]: jinja2.environment.Environment\n\n\n\u30ca\u30d3\u30b2\u30fc\u30b7\u30e7\u30f3\u304b\u3089Markdown\u30da\u30fc\u30b8\u306e\u53d6\u5f97\nIn [20]: site_navigation.walk_pages()\nOut[20]: <generator object walk_pages at 0x105c32eb0>\n\nIn [21]: _.next()\nOut[21]: <mkdocs.nav.Page at 0x105abb710>\n\nIn [22]: page = _\n\n\nMarkdown\u306e\u30d1\u30b9\nIn [24]: import os\nIn [25]: input_path = os.path.join(conf['docs_dir'], page.input_path)\nIn [27]: input_path\nOut[27]: u'/Users/hide/Dropbox/\\u30a2\\u30d5\\u309a\\u30ea/scriptogram/index.md'\n\n\nMarkdown\u3092\u8aad\u307f\u8fbc\u3080\nIn [29]: import io\n\nIn [30]: input_content = io.open(input_path, 'r', encoding='utf-8').read()\n\n\nMarkdown\u3092HTML\u5316\n\n\u62e1\u5f35\u306a\u3069\u8a2d\u5b9a\nIn [31]: from mkdocs import utils\nIn [32]: from mkdocs.relative_path_ext import RelativePathExtension\nIn [33]: extensions = [RelativePathExtension(site_navigation, conf['strict'])] + conf['markdown_extensions']\n\nIn [34]: extensions\nOut[34]:\n[<mkdocs.relative_path_ext.RelativePathExtension at 0x105c3fdd0>,\n u'meta',\n u'toc',\n u'tables',\n u'fenced_code']\n\n\nMarkdwon -> HTML\nIn [35]: md = utils.convert_markdown(markdown_source=input_content, extensions=extensions,  extension_configs=conf['mdx_configs'])\n\n\nIn [37]: len(md)\nOut[37]: 3\n\nIn [38]: [type(i) for i in md]\nOut[38]: [unicode, mkdocs.toc.TableOfContents, dict]\n\n\nHTML, TOC, \u30e1\u30bf\u30c7\u30fc\u30bf\u306b\u5206\u89e3\nIn [41]: html_content, table_of_contents, meta = md\n\n\n\u30b3\u30f3\u30c6\u30ad\u30b9\u30c8\n\n\u30b0\u30ed\u30fc\u30d0\u30eb\u30b3\u30f3\u30c6\u30ad\u30b9\u30c8\nIn [43]: from mkdocs.commands.build import get_global_context\nIn [44]: context = get_global_context(site_navigation, conf)\nIn [46]: type(context)\nOut[46]: dict\n\n\n\u30da\u30fc\u30b8\u30b3\u30f3\u30c6\u30ad\u30b9\u30c8\nIn [47]: from mkdocs.commands.build import get_page_context\nIn [49]: page_context = get_page_context(page, html_content, table_of_contents, meta, conf)\nIn [50]: type(page_context)\nOut[50]: dict\n\n\nIn [51]: context.update(page_context)\n\n\n\u30ec\u30f3\u30c0\u30ea\u30f3\u30b0\n\n\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u3092\u4f7f\u3063\u3066HTML\u30da\u30fc\u30b8\u5316\nIn [53]: template = env.get_template('base.html')\nIn [54]: output_content = template.render(context)\n\n\n\u30d5\u30a1\u30a4\u30eb\u51fa\u529b\nIn [57]: output_path = os.path.join(conf['site_dir'], page.output_path)\n\nIn [58]: output_path\nOut[58]: u'/Users/hide/Dropbox/\\u30a2\\u30d5\\u309a\\u30ea/build/index.html'\n\nIn [59]: utils.write_file(output_content.encode('utf-8'), output_path)\n\n\n- [build.py](https://github.com/mkdocs/mkdocs/blob/master/mkdocs/commands/build.py)\n\n## \u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u30eb\u30fc\u30c8\n\n~~~bash\n$ ls mkdocs.yml\nmkdocs.yml\n\n$ ipython\n~~~\n\n## config \u3092\u30ed\u30fc\u30c9\u3059\u308b\n\n~~~python\nIn [1]: from mkdocs.config import load_config\nIn [2]: conf = load_config()\nIn [4]: type(conf)\nOut[4]: instance\nOut[5]:\n['__cmp__',\n '__contains__',\n '__delitem__',\n '__doc__',\n '__getitem__',\n '__hash__',\n '__init__',\n '__len__',\n '__module__',\n '__repr__',\n '__setitem__',\n '_post_validate',\n '_pre_validate',\n '_schema',\n '_schema_keys',\n '_validate',\n 'clear',\n 'copy',\n 'data',\n 'fromkeys',\n 'get',\n 'has_key',\n 'items',\n 'iteritems',\n 'iterkeys',\n 'itervalues',\n 'keys',\n 'load_dict',\n 'load_file',\n 'pop',\n 'popitem',\n 'set_defaults',\n 'setdefault',\n 'update',\n 'user_configs',\n 'validate',\n 'values']\n~~~\n\n~~~python\nIn [8]: type(conf['pages'])\nOut[8]: list\n\nIn [9]: conf['use_directory_urls']\nOut[9]: True\n~~~\n\n## \u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u4e00\u89a7\u3092\u4f5c\u6210\u3059\u308b\n\n~~~py\nIn [10]: from mkdocs import nav\n\nIn [11]: site_navigation = nav.SiteNavigation(conf['pages'], conf['use_directory_urls'])\n\nIn [12]: type(site_navigation)\nOut[12]: mkdocs.nav.SiteNavigation\n~~~\n\n## Jinja2\u306e\u30ed\u30fc\u30c0\u30fc\n\n~~~py\nIn [14]: import jinja2\nIn [15]: loader = jinja2.FileSystemLoader(conf['theme_dir'] + [conf['mkdocs_templates'], ])\n\nIn [16]: type(loader)\nOut[16]: jinja2.loaders.FileSystemLoader\n~~~\n\n### Jinja2\u306e\u74b0\u5883\n\n~~~py\nIn [17]: env = jinja2.Environment(loader=loader)\n\nIn [18]: type(env)\nOut[18]: jinja2.environment.Environment\n~~~\n\n\n## \u30ca\u30d3\u30b2\u30fc\u30b7\u30e7\u30f3\u304b\u3089Markdown\u30da\u30fc\u30b8\u306e\u53d6\u5f97\n\n~~~py\nIn [20]: site_navigation.walk_pages()\nOut[20]: <generator object walk_pages at 0x105c32eb0>\n\nIn [21]: _.next()\nOut[21]: <mkdocs.nav.Page at 0x105abb710>\n\nIn [22]: page = _\n~~~\n\n### Markdown\u306e\u30d1\u30b9\n\n~~~py\nIn [24]: import os\nIn [25]: input_path = os.path.join(conf['docs_dir'], page.input_path)\nIn [27]: input_path\nOut[27]: u'/Users/hide/Dropbox/\\u30a2\\u30d5\\u309a\\u30ea/scriptogram/index.md'\n~~~\n\n## Markdown\u3092\u8aad\u307f\u8fbc\u3080\n\n~~~py\nIn [29]: import io\n\nIn [30]: input_content = io.open(input_path, 'r', encoding='utf-8').read()\n~~~\n\n## Markdown\u3092HTML\u5316\n\n### \u62e1\u5f35\u306a\u3069\u8a2d\u5b9a\n\n~~~py\nIn [31]: from mkdocs import utils\nIn [32]: from mkdocs.relative_path_ext import RelativePathExtension\nIn [33]: extensions = [RelativePathExtension(site_navigation, conf['strict'])] + conf['markdown_extensions']\n\nIn [34]: extensions\nOut[34]:\n[<mkdocs.relative_path_ext.RelativePathExtension at 0x105c3fdd0>,\n u'meta',\n u'toc',\n u'tables',\n u'fenced_code']\n~~~\n\n### Markdwon -> HTML\n\n~~~py\nIn [35]: md = utils.convert_markdown(markdown_source=input_content, extensions=extensions,  extension_configs=conf['mdx_configs'])\n\n\nIn [37]: len(md)\nOut[37]: 3\n\nIn [38]: [type(i) for i in md]\nOut[38]: [unicode, mkdocs.toc.TableOfContents, dict]\n~~~\n\n### HTML, TOC, \u30e1\u30bf\u30c7\u30fc\u30bf\u306b\u5206\u89e3\n\n~~~py\nIn [41]: html_content, table_of_contents, meta = md\n~~~\n\n## \u30b3\u30f3\u30c6\u30ad\u30b9\u30c8\n\n### \u30b0\u30ed\u30fc\u30d0\u30eb\u30b3\u30f3\u30c6\u30ad\u30b9\u30c8\n\n~~~py\nIn [43]: from mkdocs.commands.build import get_global_context\nIn [44]: context = get_global_context(site_navigation, conf)\nIn [46]: type(context)\nOut[46]: dict\n~~~\n\n\n### \u30da\u30fc\u30b8\u30b3\u30f3\u30c6\u30ad\u30b9\u30c8\n\n~~~py\nIn [47]: from mkdocs.commands.build import get_page_context\nIn [49]: page_context = get_page_context(page, html_content, table_of_contents, meta, conf)\nIn [50]: type(page_context)\nOut[50]: dict\n\n\nIn [51]: context.update(page_context)\n~~~\n\n## \u30ec\u30f3\u30c0\u30ea\u30f3\u30b0\n\n### \u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u3092\u4f7f\u3063\u3066HTML\u30da\u30fc\u30b8\u5316\n\n~~~py\nIn [53]: template = env.get_template('base.html')\nIn [54]: output_content = template.render(context)\n~~~\n\n### \u30d5\u30a1\u30a4\u30eb\u51fa\u529b\n\n~~~py\nIn [57]: output_path = os.path.join(conf['site_dir'], page.output_path)\n\nIn [58]: output_path\nOut[58]: u'/Users/hide/Dropbox/\\u30a2\\u30d5\\u309a\\u30ea/build/index.html'\n\nIn [59]: utils.write_file(output_content.encode('utf-8'), output_path)\n~~~\n", "tags": ["Python", "Markdown", "MkDocs"]}