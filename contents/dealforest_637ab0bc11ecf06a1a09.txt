{"context": " More than 1 year has passed since last update.\u300cAWS\u306eAPI\u3092\u30ab\u30b8\u30e5\u30a2\u30eb\u306b\u300d\u306e 24 \u30d8\u309a\u30fc\u30b7\u3099\u76ee\u306b\"Unix\u7684\u306a\u5c0f\u9053\u5177\u3092\u4f5c\u308b\"\u3068\u3042\u308b\u306e\u3067\u3059\u304c\u3001\u3053\u308c\u304c\u3068\u3066\u3082\u4fbf\u5229\u305d\u3046\u3067\u3057\u305f\u3002\n\u4f55\u3092\u3059\u308b\u306e\u304b\u3068\u3044\u3046\u3068 EC2 \u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306e\u4e00\u89a7\u3092\u53d6\u5f97\u3057\u3001\u9078\u629e\u3057\u305f\u30db\u30b9\u30c8\u306b SSH \u3057\u307e\u3059\u3002\n\u3068\u3044\u3046\u308f\u3051\u3067\u3055\u3063\u305d\u304f Zsh \u306b\u8a2d\u5b9a\u3057\u3066\u307f\u307e\u3057\u305f\u3002\n\n\u4e8b\u524d\u6e96\u5099\n\u300cIAM Management Console\u300d\u306b\u767b\u9332\u3057\u3066 API \u306e\u30a2\u30af\u30bb\u30b9\u30ad\u30fc\u3092\u767a\u884c\u3057\u3001~/.aws/config \u306b\u4fdd\u5b58\u3057\u3066\u304a\u304f\u3002\n\u3053\u306e\u6642\u306b role \u3092\u3042\u305f\u3048\u3066\u3044\u306a\u304f\u3066 API \u306b\u30a2\u30af\u30bb\u30b9\u3067\u304d\u3066\u3044\u306a\u304b\u3063\u305f\u306e\u3067\u8981\u6ce8\u610f\u3002\n\nPeco \u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\nHomebrew \u3092\u4f7f\u3063\u3066\u3044\u308b\u5834\u5408\n$ brew tap peco/peco\n$ brew install peco\n\nGo \u306e\u74b0\u5883\u304c\u3042\u308b\u5834\u5408\n$ go get github.com/peco/peco/cmd/peco\n\n\nec2list \u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n$ gem install ec2list\n\n(\u203b) ec2list \u306f memoize \u3057\u3066\u3044\u308b\u306e\u3067\u6bce\u56de\u30ea\u30af\u30a8\u30b9\u30c8\u304c\u767a\u751f\u3059\u308b\u308f\u3051\u3067\u306f\u3042\u308a\u307e\u305b\u3093\u3002\n$ ec2list\n\n\u3053\u308c\u3067\u4e00\u89a7\u304c\u8868\u793a\u3055\u308c\u3066\u3044\u308c\u3070\u6210\u529f\u3067\u3059\u3002\ndefault \u4ee5\u5916\u306e profile \u3092\u4f7f\u7528\u3059\u308b\u5834\u5408\u306f\u4ee5\u5f8c\u3001 s/ec2list/ec2list --profile [profile\u540d]/ \u3067\u7f6e\u63db\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\u30a8\u30e9\u30fc\u304c\u3067\u308b\u5834\u5408\u306f Policy \u306e\u8a2d\u5b9a\u304c\u304a\u304b\u3057\u3044\u304b\u3001~/.aws/config \u306e\u8a2d\u5b9a\u304c\u304a\u304b\u3057\u3044\u304b\u3060\u3068\u601d\u3044\u307e\u3059\u3002\n\nZsh \u306e\u8a2d\u5b9a\n$ ec2list | peco | cut -f 3 | xargs -o -n 1 ssh\n\n\u3053\u306e\u30b3\u30de\u30f3\u30c9\u3067\u9078\u629e\u3057\u305f\u30db\u30b9\u30c8\u306b SSH \u304c\u3067\u304d\u308c\u3070\u6210\u529f\u3067\u3059\u3002\n\u6bce\u56de\u3053\u308c\u3092\u5b9f\u884c\u3059\u308b\u306e\u3082\u3081\u3093\u3069\u304f\u3055\u3044\u306e\u3067 alias \u304b\u3001\u3082\u3057\u304f\u306f keybind \u3092\u8a2d\u5b9a\u3057\u3066\u304a\u3051\u3070\u5e78\u305b\u306b\u306a\u308c\u308b\u304b\u3068\u601d\u3044\u307e\u3059\u3002\n\nalias\n\n~/.zshrc\nalias peco-ec2ssh=\"ec2list | peco | cut -f 3 | xargs -o -n 1 ssh\"\n\n\n\nkeybind\n\n~.zshrc\nfunction peco-ec2ssh() {\n  echo \"Fetching ec2 host...\"\n  local selected_host=$(ec2list | peco | cut -f 3)\n  if [ -n \"${selected_host}\" ]; then\n    BUFFER=\"ssh ${selected_host}\"\n    zle accept-line\n  fi\n  zle clear-screen\n}\nzle -N peco-ec2ssh\n\nbindkey '^q' peco-ec2ssh\n\n\n\u3053\u3046\u3059\u308b\u3053\u3068\u306b\u3088\u3063\u3066 ^q \u3092\u62bc\u305b\u3070 SSH \u3067\u304d\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3057\u305f\u3002\n\u4fbf\u5229\u3067\u3059\u306d\u3002\nPeco \u3068 ec2list \u306e\u7d44\u307f\u5408\u308f\u305b\u3067\u3084\u308a\u307e\u3057\u305f\u304c\u3001ec2ssh \u3068 grep -E '^Host[[:space:]]+[^*]' ~/.ssh/config | peco | awk \"{print \\$2}\" | xargs -o -n 1 ssh \u306e\u7d44\u307f\u5408\u308f\u305b\u3067\u3082\u3044\u3044\u3068\u601d\u3044\u307e\u3059\u3002\n\u3067\u306f\u3067\u306f\u3002\n\u300c[AWS\u306eAPI\u3092\u30ab\u30b8\u30e5\u30a2\u30eb\u306b](https://speakerdeck.com/naoya/awsfalseapiwokaziyuaruni)\u300d\u306e 24 \u30d8\u309a\u30fc\u30b7\u3099\u76ee\u306b\"Unix\u7684\u306a\u5c0f\u9053\u5177\u3092\u4f5c\u308b\"\u3068\u3042\u308b\u306e\u3067\u3059\u304c\u3001\u3053\u308c\u304c\u3068\u3066\u3082\u4fbf\u5229\u305d\u3046\u3067\u3057\u305f\u3002\n\u4f55\u3092\u3059\u308b\u306e\u304b\u3068\u3044\u3046\u3068 EC2 \u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306e\u4e00\u89a7\u3092\u53d6\u5f97\u3057\u3001\u9078\u629e\u3057\u305f\u30db\u30b9\u30c8\u306b SSH \u3057\u307e\u3059\u3002\n\u3068\u3044\u3046\u308f\u3051\u3067\u3055\u3063\u305d\u304f Zsh \u306b\u8a2d\u5b9a\u3057\u3066\u307f\u307e\u3057\u305f\u3002\n\n## \u4e8b\u524d\u6e96\u5099\n\u300c[IAM Management Console](https://console.aws.amazon.com/iam)\u300d\u306b\u767b\u9332\u3057\u3066 API \u306e\u30a2\u30af\u30bb\u30b9\u30ad\u30fc\u3092\u767a\u884c\u3057\u3001`~/.aws/config` \u306b\u4fdd\u5b58\u3057\u3066\u304a\u304f\u3002\n\u3053\u306e\u6642\u306b role \u3092\u3042\u305f\u3048\u3066\u3044\u306a\u304f\u3066 API \u306b\u30a2\u30af\u30bb\u30b9\u3067\u304d\u3066\u3044\u306a\u304b\u3063\u305f\u306e\u3067\u8981\u6ce8\u610f\u3002\n\n## Peco \u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\nHomebrew \u3092\u4f7f\u3063\u3066\u3044\u308b\u5834\u5408\n\n```\n$ brew tap peco/peco\n$ brew install peco\n```\n\nGo \u306e\u74b0\u5883\u304c\u3042\u308b\u5834\u5408\n\n```\n$ go get github.com/peco/peco/cmd/peco\n```\n\n## ec2list \u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n```\n$ gem install ec2list\n```\n\n(\u203b) ec2list \u306f memoize \u3057\u3066\u3044\u308b\u306e\u3067\u6bce\u56de\u30ea\u30af\u30a8\u30b9\u30c8\u304c\u767a\u751f\u3059\u308b\u308f\u3051\u3067\u306f\u3042\u308a\u307e\u305b\u3093\u3002\n\n\n```\n$ ec2list\n```\n\n\u3053\u308c\u3067\u4e00\u89a7\u304c\u8868\u793a\u3055\u308c\u3066\u3044\u308c\u3070\u6210\u529f\u3067\u3059\u3002\ndefault \u4ee5\u5916\u306e profile \u3092\u4f7f\u7528\u3059\u308b\u5834\u5408\u306f\u4ee5\u5f8c\u3001 s/ec2list/ec2list --profile [profile\u540d]/ \u3067\u7f6e\u63db\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\u30a8\u30e9\u30fc\u304c\u3067\u308b\u5834\u5408\u306f Policy \u306e\u8a2d\u5b9a\u304c\u304a\u304b\u3057\u3044\u304b\u3001`~/.aws/config` \u306e\u8a2d\u5b9a\u304c\u304a\u304b\u3057\u3044\u304b\u3060\u3068\u601d\u3044\u307e\u3059\u3002\n\n\n## Zsh \u306e\u8a2d\u5b9a\n\n```\n$ ec2list | peco | cut -f 3 | xargs -o -n 1 ssh\n```\n\u3053\u306e\u30b3\u30de\u30f3\u30c9\u3067\u9078\u629e\u3057\u305f\u30db\u30b9\u30c8\u306b SSH \u304c\u3067\u304d\u308c\u3070\u6210\u529f\u3067\u3059\u3002\n\u6bce\u56de\u3053\u308c\u3092\u5b9f\u884c\u3059\u308b\u306e\u3082\u3081\u3093\u3069\u304f\u3055\u3044\u306e\u3067 alias \u304b\u3001\u3082\u3057\u304f\u306f keybind \u3092\u8a2d\u5b9a\u3057\u3066\u304a\u3051\u3070\u5e78\u305b\u306b\u306a\u308c\u308b\u304b\u3068\u601d\u3044\u307e\u3059\u3002\n\n\n### alias\n\n\n```~/.zshrc\nalias peco-ec2ssh=\"ec2list | peco | cut -f 3 | xargs -o -n 1 ssh\"\n```\n\n### keybind\n\n\n```~.zshrc\nfunction peco-ec2ssh() {\n  echo \"Fetching ec2 host...\"\n  local selected_host=$(ec2list | peco | cut -f 3)\n  if [ -n \"${selected_host}\" ]; then\n    BUFFER=\"ssh ${selected_host}\"\n    zle accept-line\n  fi\n  zle clear-screen\n}\nzle -N peco-ec2ssh\n\nbindkey '^q' peco-ec2ssh\n```\n\n\u3053\u3046\u3059\u308b\u3053\u3068\u306b\u3088\u3063\u3066 `^q` \u3092\u62bc\u305b\u3070 SSH \u3067\u304d\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3057\u305f\u3002\n\u4fbf\u5229\u3067\u3059\u306d\u3002\n\nPeco \u3068 ec2list \u306e\u7d44\u307f\u5408\u308f\u305b\u3067\u3084\u308a\u307e\u3057\u305f\u304c\u3001[ec2ssh](https://github.com/mirakui/ec2ssh) \u3068 `grep -E '^Host[[:space:]]+[^*]' ~/.ssh/config | peco | awk \"{print \\$2}\" | xargs -o -n 1 ssh` \u306e\u7d44\u307f\u5408\u308f\u305b\u3067\u3082\u3044\u3044\u3068\u601d\u3044\u307e\u3059\u3002\n\n\u3067\u306f\u3067\u306f\u3002\n\n", "tags": ["AWS", "Peco", "Zsh"]}