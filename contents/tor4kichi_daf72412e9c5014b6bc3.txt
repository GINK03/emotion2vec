{"context": " More than 1 year has passed since last update.\n\n\u554f\u984c\nPage.TopAppBar\u306b\u8a2d\u5b9a\u3057\u305fCommandBar\u3067DataContext\u3092\u4f7f\u7528\u3059\u308b\u969b\u3001CommandBar\u306eDataContext\u304c\u610f\u56f3\u3057\u306a\u3044DataContext\u306b\u66f8\u304d\u63db\u308f\u308b\u554f\u984c\u306b\u906d\u9047\u3002\n\n\u72b6\u6cc1\n\uff11\uff0eMyCommandBar.xaml.cs\u306e\u30b3\u30f3\u30b9\u30c8\u30e9\u30af\u30bf\u5185\u3067ViewModelLocator.SetAutoWireViewModel(this, true)\u3092\u547c\u3073\u51fa\u3057\u3066\u3044\u305f\uff08\uff1dDataContext\u306b\u81ea\u52d5\u3067ViewModel\u3092\u8aad\u307f\u8fbc\u3080\uff09\n\uff12\uff0eCommandBar\u306eDataContext\u304c\u89aaPage\u306b\u8a2d\u5b9a\u3055\u308c\u305fDataContext\u3067\u4e0a\u66f8\u304d\u3055\u308c\u3066\u3044\u305f\n\u2192 CommandBar\u5074\u306eDataContext\u304c\u610f\u56f3\u3057\u305fViewModel\u306b\u306a\u3089\u306a\u3044\u72b6\u6cc1\u3002\n\n\u5bfe\u7b56\nDataContext\u304c\u5e38\u306b\u610f\u56f3\u3057\u305fViewModel\u306b\u306a\u308b\u3088\u3046\u3001CommandBar\u7528\u306e\u30d3\u30d8\u30a4\u30d3\u30a2\u3092\u4f5c\u6210\u3057\u3066DataContext\u306e\u30e2\u30cb\u30bf\u30ea\u30f3\u30b0\u3001\u5f37\u5236\u518d\u8a2d\u5b9a\u3059\u308b\u3002\n\nForcedDataContextCommandbarBehavior.cs\n\npublic class ForcedDataContextCommandbarBehavior : Behavior<CommandBar>\n{\n    object PreservedDataContext;\n\n    protected override void OnAttached()\n    {\n        base.OnAttached();\n\n        PreservedDataContext = this.AssociatedObject.DataContext;\n\n        this.AssociatedObject.DataContextChanged += OnDataContextChanged;\n    }\n\n    protected override void OnDetaching()\n    {\n        base.OnDetaching();\n\n        this.AssociatedObject.DataContextChanged -= OnDataContextChanged;\n    }\n\n\n    private void OnDataContextChanged(Windows.UI.Xaml.FrameworkElement sender, Windows.UI.Xaml.DataContextChangedEventArgs args)\n    {\n        if(args.NewValue != null)\n        {\n            if(PreservedDataContext != this.AssociatedObject.DataContext)\n            {\n                this.AssociatedObject.DataContext = PreservedDataContext;\n                args.Handled = true;\n            }\n        }\n    }\n}\n\n\n\n\nMyPage.xaml\n<Page.TopAppBar>\n    <v:MyCommandBar>\n        <Interactivity:Interaction.Behaviors>\n            <behavior:ForcedDataContextCommandbarBehavior />\n        </Interactivity:Interaction.Behaviors>\n    </v:MyCommandBar>\n</Page.TopAppBar>\n\n\n\u88dc\u8db3\uff1aMyCommandBar\u5074\u306f\u30b3\u30f3\u30b9\u30c8\u30e9\u30af\u30bf\u5185\u306eInitializeComponent\u306e\u5f8c\u306b\u3001DataContext\u306e\u8a2d\u5b9a\u3057\u3066\u3044\u308b\u3053\u3068\u3092\u524d\u63d0\u306b\u3057\u3066\u3044\u307e\u3059\u3002\n\n\u539f\u56e0\n\u5143\u3005\u3001Page.~AppBar\u4ee5\u4e0b\u306e\u8981\u7d20\u306eDataContext\u306bPage\u306eDataContext\u304c\u4f1d\u64ad\u3057\u306a\u3044\u4e0d\u5177\u5408\uff1f \u304c\u3042\u3063\u305f\u3088\u3046\u3067\u3001\u305d\u306e\u5bfe\u7b56\u3068\u3057\u3066Page.~AppBar\u4ee5\u4e0b\u306e\u8981\u7d20\u306eDataContext\u3092Page.Datacontext\u3067\u4e0a\u66f8\u304d\u3092\u884c\u3063\u3066\u3044\u305f\u6a21\u69d8\u3002\nPage\u3068CommandBar\u306f\u5730\u7d9a\u304d\u306e\u95a2\u4fc2\u306a\u306e\u3067\u3001\u4ed6\u3068\u540c\u69d8\u306b\"\u884c\u5100\u3088\u304f\"DataContext\u4f1d\u64ad\u304c\u884c\u308f\u308c\u308b\u5b9f\u88c5\u304c\u671b\u307e\u3057\u3044\u3068\u601d\u3044\u307e\u3059\u3002\n\n\u53c2\u8003\nHow to set AppBar DataContext - stackoverflow.com\n## \u554f\u984c\nPage.TopAppBar\u306b\u8a2d\u5b9a\u3057\u305fCommandBar\u3067DataContext\u3092\u4f7f\u7528\u3059\u308b\u969b\u3001CommandBar\u306eDataContext\u304c\u610f\u56f3\u3057\u306a\u3044DataContext\u306b\u66f8\u304d\u63db\u308f\u308b\u554f\u984c\u306b\u906d\u9047\u3002\n\n\n## \u72b6\u6cc1\n\uff11\uff0eMyCommandBar.xaml.cs\u306e\u30b3\u30f3\u30b9\u30c8\u30e9\u30af\u30bf\u5185\u3067ViewModelLocator.SetAutoWireViewModel(this, true)\u3092\u547c\u3073\u51fa\u3057\u3066\u3044\u305f\uff08\uff1dDataContext\u306b\u81ea\u52d5\u3067ViewModel\u3092\u8aad\u307f\u8fbc\u3080\uff09\n\uff12\uff0eCommandBar\u306eDataContext\u304c\u89aaPage\u306b\u8a2d\u5b9a\u3055\u308c\u305fDataContext\u3067\u4e0a\u66f8\u304d\u3055\u308c\u3066\u3044\u305f\n\n\u2192 CommandBar\u5074\u306eDataContext\u304c\u610f\u56f3\u3057\u305fViewModel\u306b\u306a\u3089\u306a\u3044\u72b6\u6cc1\u3002\n\n\n\n## \u5bfe\u7b56\nDataContext\u304c\u5e38\u306b\u610f\u56f3\u3057\u305fViewModel\u306b\u306a\u308b\u3088\u3046\u3001CommandBar\u7528\u306e\u30d3\u30d8\u30a4\u30d3\u30a2\u3092\u4f5c\u6210\u3057\u3066DataContext\u306e\u30e2\u30cb\u30bf\u30ea\u30f3\u30b0\u3001\u5f37\u5236\u518d\u8a2d\u5b9a\u3059\u308b\u3002\n\n\n\n```csharp:ForcedDataContextCommandbarBehavior.cs\n\npublic class ForcedDataContextCommandbarBehavior : Behavior<CommandBar>\n{\n\tobject PreservedDataContext;\n\n\tprotected override void OnAttached()\n\t{\n\t\tbase.OnAttached();\n\n\t\tPreservedDataContext = this.AssociatedObject.DataContext;\n\n\t\tthis.AssociatedObject.DataContextChanged += OnDataContextChanged;\n\t}\n\n\tprotected override void OnDetaching()\n\t{\n\t\tbase.OnDetaching();\n\n\t\tthis.AssociatedObject.DataContextChanged -= OnDataContextChanged;\n\t}\n\n\n\tprivate void OnDataContextChanged(Windows.UI.Xaml.FrameworkElement sender, Windows.UI.Xaml.DataContextChangedEventArgs args)\n\t{\n\t\tif(args.NewValue != null)\n\t\t{\n\t\t\tif(PreservedDataContext != this.AssociatedObject.DataContext)\n\t\t\t{\n\t\t\t\tthis.AssociatedObject.DataContext = PreservedDataContext;\n\t\t\t\targs.Handled = true;\n            }\n\t\t}\n\t}\n}\n\n```\n\n```xml:MyPage.xaml\n<Page.TopAppBar>\n    <v:MyCommandBar>\n        <Interactivity:Interaction.Behaviors>\n            <behavior:ForcedDataContextCommandbarBehavior />\n        </Interactivity:Interaction.Behaviors>\n    </v:MyCommandBar>\n</Page.TopAppBar>\n```\n\n\u88dc\u8db3\uff1aMyCommandBar\u5074\u306f\u30b3\u30f3\u30b9\u30c8\u30e9\u30af\u30bf\u5185\u306eInitializeComponent\u306e\u5f8c\u306b\u3001DataContext\u306e\u8a2d\u5b9a\u3057\u3066\u3044\u308b\u3053\u3068\u3092\u524d\u63d0\u306b\u3057\u3066\u3044\u307e\u3059\u3002\n\n\n## \u539f\u56e0\n\u5143\u3005\u3001Page.~AppBar\u4ee5\u4e0b\u306e\u8981\u7d20\u306eDataContext\u306bPage\u306eDataContext\u304c\u4f1d\u64ad\u3057\u306a\u3044\u4e0d\u5177\u5408\uff1f \u304c\u3042\u3063\u305f\u3088\u3046\u3067\u3001\u305d\u306e\u5bfe\u7b56\u3068\u3057\u3066Page.~AppBar\u4ee5\u4e0b\u306e\u8981\u7d20\u306eDataContext\u3092Page.Datacontext\u3067\u4e0a\u66f8\u304d\u3092\u884c\u3063\u3066\u3044\u305f\u6a21\u69d8\u3002\n\nPage\u3068CommandBar\u306f\u5730\u7d9a\u304d\u306e\u95a2\u4fc2\u306a\u306e\u3067\u3001\u4ed6\u3068\u540c\u69d8\u306b\"\u884c\u5100\u3088\u304f\"DataContext\u4f1d\u64ad\u304c\u884c\u308f\u308c\u308b\u5b9f\u88c5\u304c\u671b\u307e\u3057\u3044\u3068\u601d\u3044\u307e\u3059\u3002\n\n\n\n#### \u53c2\u8003\n[How to set AppBar DataContext - stackoverflow.com](http://stackoverflow.com/questions/25753649/how-to-set-appbar-datacontext)\n\n", "tags": ["WinRT", "Xaml", "Windows\u30b9\u30c8\u30a2\u30a2\u30d7\u30ea"]}