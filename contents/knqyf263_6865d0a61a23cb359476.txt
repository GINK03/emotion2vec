{"context": " More than 1 year has passed since last update.vagrant-kvm\u3092\u4f7f\u3063\u3066VM\u3092\u7acb\u3061\u4e0a\u3052\u308b\u3067\u66f8\u3044\u305f\u3088\u3046\u306b\u3001vagrant-kvm\u3092\u4f7f\u3063\u3066VM\u3092\u7acb\u3061\u4e0a\u3052\u305f\u306e\u3067\u3059\u304c\u3001\u30c7\u30d5\u30a9\u30eb\u30c8\u3060\u3068vagrant\u3068\u3044\u3046NAT\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306b\u5c5e\u3059\u308b\u3053\u3068\u306b\u306a\u308a\u307e\u3059\u3002\nNAT\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u3067\u306f\u306a\u304f\u3001VirtualBox\u3067\u8a00\u3046\u3068\u3053\u308d\u306e\u30db\u30b9\u30c8\u30aa\u30f3\u30ea\u30fc\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306b\u5c5e\u3055\u305b\u305f\u3044\u3001\u3068\u3044\u3046\u5834\u5408\u306e\u3084\u308a\u65b9\u3092\u66f8\u3053\u3046\u3068\u601d\u3044\u307e\u3059\u3002\n\n\u74b0\u5883\n\n\u30db\u30b9\u30c8OS\n\n\nUbuntu 14.04\n\n\n\u30b2\u30b9\u30c8OS\n\n\nubuntu 14.04\n\n\nKVM\n\n\nvirsh 1.2.2\n\n\nVagrant 1.6.5 \nvagrant-kvm 0.1.9\n\n\n\u624b\u9806\n\nKVM\u306e\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u69cb\u6210\u306b\u3064\u3044\u3066\n\u307e\u305a\u3001KVM\u3067VM\u3092\u7acb\u3061\u4e0a\u3052\u305f\u5834\u5408\u3001\u3069\u3046\u306a\u308b\u304b\u3067\u3059\u304c\u3001\u7279\u306b\u4f55\u3082\u305b\u305a\u7acb\u3061\u4e0a\u3052\u305f\u5834\u5408\u306fdefault\u3068\u3044\u3046NAT\u306e\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306b\u5c5e\u3057\u307e\u3059\u3002\n\u4eca\u56de\u306fvagrant\u3092\u4f7f\u3063\u3066\u8d77\u52d5\u3057\u305f\u306e\u3067vagrant\u3068\u3044\u3046\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306b\u5c5e\u3057\u3066\u3044\u307e\u3059\u3002\nvirsh\u3092\u7528\u3044\u3066\u78ba\u304b\u3081\u308b\u3053\u3068\u304c\u51fa\u6765\u307e\u3059\u3002\n$ virsh net-list\n Name                 State      Autostart     Persistent\n----------------------------------------------------------\n vagrant              active     yes           yes\n\n\u3053\u306e\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306e\u8a73\u7d30\u3067\u3059\u304c\u3001net-dumpxml\u3092\u4f7f\u3046\u3068\u78ba\u304b\u3081\u3089\u308c\u307e\u3059\u3002\n$ virsh net-dumpxml vagrant\n<network connections='1'>\n  <name>vagrant</name>\n  <uuid>5450c7ae-3535-42d5-8d02-cb4cdb901c01</uuid>\n  <forward mode='nat'>\n    <nat>\n      <port start='1024' end='65535'/>\n    </nat>\n  </forward>\n  <bridge name='virbr0' stp='on' delay='0'/>\n  <mac address='52:54:00:df:98:c3'/>\n  <domain name='vagrant.local'/>\n  <ip address='192.168.123.1' netmask='255.255.255.0'>\n    <dhcp>\n      <range start='192.168.123.100' end='192.168.123.200'/>\n      <host mac='52:54:00:04:70:15' name='nic-1412957878' ip='192.168.123.7'/>\n    </dhcp>\n  </ip>\n</network>\n\ndhcp\u3067IP\u30a2\u30c9\u30ec\u30b9\u3092\u914d\u3063\u3066\u3044\u308b\u306e\u3067\u7acb\u3061\u4e0a\u3052\u305fVM\u306e\u6570\u3060\u3051\u304c\u8ffd\u52a0\u3055\u308c\u307e\u3059\u3002\n\u5b9f\u4f53\u306f/etc/libvirt/qemu/networks/vagrant.xml\u3067\u3059\u3002\n\u540c\u3058\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306bnetwork-name.xml\u304c\u5b58\u5728\u3057\u307e\u3059\u3002\n\u4e2d\u8eab\u304c\u307b\u307c\u7a7a\u306a\u306e\u3067\u3001\u3053\u308c\u3092\u4f7f\u3063\u3066\u30db\u30b9\u30c8\u30aa\u30f3\u30ea\u30fc\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u3092\u4f5c\u308d\u3046\u3068\u601d\u3044\u307e\u3059\u3002\n$ cd /etc/libvirt/qemu/networks\n$ sudo cp network-name.xml host_only.xml\n$ sudo vim host_only.xml\n<network>\n  <name>host_only</name>\n  <uuid>934780ae-3534-4ec4-8338-fe6a8379cbc5</uuid>\n  <bridge name='host_only0' stp='on' delay='0'/>\n  <mac address='52:54:00:25:f1:c6'/>\n</network>\n# \u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u3092\u5b9a\u7fa9\u3057\u307e\u3059\n$ virsh net-define host_only\nNetwork host_only defined from host_only.xml\n# \u81ea\u52d5\u3067\u8d77\u52d5\u3059\u308b\u3088\u3046\u306b\u8a2d\u5b9a\u3057\u307e\u3059\n$ virsh net-autostart host_only\nerror: failed to mark network host_only as autostarted\nerror: Requested operation is not valid: cannot set autostart for transient network\n\nautostart\u3092\u5b9f\u884c\u3057\u3088\u3046\u3068\u3057\u305f\u3089\u6012\u3089\u308c\u307e\u3057\u305f\u3002\n\u3088\u304f\u5206\u304b\u3089\u306a\u304b\u3063\u305f\u306e\u3067\u3059\u304c\u3001\nhttps://www.mynakedgirlfriend.de/libvirt-cannot-set-autostart-for-transient-network/\n\u3092\u898b\u308b\u306b\u3001\u4e00\u5ea6virsh edit\u3057\u3066\u304b\u3089\u306a\u3089\u51fa\u6765\u308b\u307f\u305f\u3044\u3067\u3059\u3002\n$ virsh\n#net-edit\u3067MAC\u30a2\u30c9\u30ec\u30b9\u306e\u90e8\u5206\u3092\u6d88\u3059\u3002\nvirsh # net-edit host_only\n<network>\n  <name>host_only</name>\n  <uuid>934780ae-3534-4ec4-8338-fe6a8379cbc5</uuid>\n  <bridge name='host_only0' stp='on' delay='0'/>\n</network>\n\nNetwork host_only XML configuration edited.\n\nvirsh # net-autostart host_only\nNetwork host_only marked as autostarted\n\n\u3042\u3068\u306f\u3053\u308c\u3092VM\u306battach\u3059\u308c\u3070\u5b8c\u4e86\u3067\u3059\u3002\n\u30db\u30b9\u30c8\u5074\u306bIP\u30a2\u30c9\u30ec\u30b9\u3092\u81ea\u52d5\u3067\u5272\u308a\u5f53\u3066\u3066\u304f\u308c\u305f\u308a\u306f\u3057\u306a\u3044\u306e\u3067\u3001\u624b\u52d5\u3067\u5272\u308a\u632f\u3063\u3066\u4e0b\u3055\u3044\u3002\n\u305d\u306e\u3042\u305f\u308a\u306f\u8abf\u3079\u308c\u3070\u51fa\u308b\u3068\u601d\u3046\u306e\u3067\u7701\u7565\u3057\u307e\u3059\u3002\u6687\u3060\u3063\u305f\u3089\u3044\u3064\u304b\u66f8\u304d\u307e\u3059\u3002\n\n\u304a\u307e\u3051\uff1a\u56fa\u5b9aIP\u30a2\u30c9\u30ec\u30b9\u306eNAT\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\nDHCP\u3058\u3083\u306a\u304f\u3066\u56fa\u5b9aIP\u30a2\u30c9\u30ec\u30b9\u306eNAT\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u3082\u6b32\u3057\u304f\u306a\u3063\u305f\u306e\u3067\u8ffd\u8a18\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n\u4e0a\u8a18\u306ehost_only.xml\u3068\u540c\u69d8\u306b\u3001xml\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\nvagrant.xml\u3092\u30b3\u30d4\u30fc\u3057\u3066\u4f5c\u308b\u3068\u624b\u3063\u53d6\u308a\u65e9\u3044\u3068\u601d\u3044\u307e\u3059\u3002\n\nhost_only.xml\n<network>\n  <name>hostonly0</name>\n  <forward mode='nat'/>\n  <bridge name='hostonly0' stp='on' delay='0'/>\n  <domain name='hostonly0.local'/>\n  <ip address='192.168.124.1' netmask='255.255.255.0'>\n  </ip>\n</network>\n\n\nuuid\u3084mac address\u306f\u6d88\u3057\u307e\u3059\u3002\nname\u3084bridge name\u3092\u5909\u3048\u3066\u3001ip address\u306e\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u3092\u4ed6\u3068\u88ab\u3089\u306a\u3044\u3088\u3046\u306b\u5909\u66f4\u3057\u305f\u3042\u3068\u3001dhcp\u306e\u90e8\u5206\u3092\u6d88\u3059\u3060\u3051\u3067\u3059\u3002\n\u3053\u308c\u3067\u4e0a\u8a18\u540c\u69d8\u306b\u3059\u308c\u3070\u56fa\u5b9aIP\u30a2\u30c9\u30ec\u30b9\u306eNAT\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u304c\u51fa\u6765\u307e\u3059\u3002\n\n[vagrant-kvm\u3092\u4f7f\u3063\u3066VM\u3092\u7acb\u3061\u4e0a\u3052\u308b](http://qiita.com/knqyf263/items/15917ec34cd9708e644c)\u3067\u66f8\u3044\u305f\u3088\u3046\u306b\u3001`vagrant-kvm`\u3092\u4f7f\u3063\u3066VM\u3092\u7acb\u3061\u4e0a\u3052\u305f\u306e\u3067\u3059\u304c\u3001\u30c7\u30d5\u30a9\u30eb\u30c8\u3060\u3068`vagrant`\u3068\u3044\u3046NAT\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306b\u5c5e\u3059\u308b\u3053\u3068\u306b\u306a\u308a\u307e\u3059\u3002\nNAT\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u3067\u306f\u306a\u304f\u3001VirtualBox\u3067\u8a00\u3046\u3068\u3053\u308d\u306e\u30db\u30b9\u30c8\u30aa\u30f3\u30ea\u30fc\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306b\u5c5e\u3055\u305b\u305f\u3044\u3001\u3068\u3044\u3046\u5834\u5408\u306e\u3084\u308a\u65b9\u3092\u66f8\u3053\u3046\u3068\u601d\u3044\u307e\u3059\u3002\n\n#\u74b0\u5883\n- \u30db\u30b9\u30c8OS\n - Ubuntu 14.04\n- \u30b2\u30b9\u30c8OS\n - ubuntu 14.04\n- KVM\n - virsh 1.2.2\n- Vagrant 1.6.5 \n- vagrant-kvm 0.1.9\n\n#\u624b\u9806\n##KVM\u306e\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u69cb\u6210\u306b\u3064\u3044\u3066\n\u307e\u305a\u3001KVM\u3067VM\u3092\u7acb\u3061\u4e0a\u3052\u305f\u5834\u5408\u3001\u3069\u3046\u306a\u308b\u304b\u3067\u3059\u304c\u3001\u7279\u306b\u4f55\u3082\u305b\u305a\u7acb\u3061\u4e0a\u3052\u305f\u5834\u5408\u306f`default`\u3068\u3044\u3046NAT\u306e\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306b\u5c5e\u3057\u307e\u3059\u3002\n\u4eca\u56de\u306fvagrant\u3092\u4f7f\u3063\u3066\u8d77\u52d5\u3057\u305f\u306e\u3067`vagrant`\u3068\u3044\u3046\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306b\u5c5e\u3057\u3066\u3044\u307e\u3059\u3002\n`virsh`\u3092\u7528\u3044\u3066\u78ba\u304b\u3081\u308b\u3053\u3068\u304c\u51fa\u6765\u307e\u3059\u3002\n\n```console\n$ virsh net-list\n Name                 State      Autostart     Persistent\n----------------------------------------------------------\n vagrant              active     yes           yes\n```\n\n\u3053\u306e\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306e\u8a73\u7d30\u3067\u3059\u304c\u3001`net-dumpxml`\u3092\u4f7f\u3046\u3068\u78ba\u304b\u3081\u3089\u308c\u307e\u3059\u3002\n\n```\n$ virsh net-dumpxml vagrant\n<network connections='1'>\n  <name>vagrant</name>\n  <uuid>5450c7ae-3535-42d5-8d02-cb4cdb901c01</uuid>\n  <forward mode='nat'>\n    <nat>\n      <port start='1024' end='65535'/>\n    </nat>\n  </forward>\n  <bridge name='virbr0' stp='on' delay='0'/>\n  <mac address='52:54:00:df:98:c3'/>\n  <domain name='vagrant.local'/>\n  <ip address='192.168.123.1' netmask='255.255.255.0'>\n    <dhcp>\n      <range start='192.168.123.100' end='192.168.123.200'/>\n      <host mac='52:54:00:04:70:15' name='nic-1412957878' ip='192.168.123.7'/>\n    </dhcp>\n  </ip>\n</network>\n```\n\ndhcp\u3067IP\u30a2\u30c9\u30ec\u30b9\u3092\u914d\u3063\u3066\u3044\u308b\u306e\u3067\u7acb\u3061\u4e0a\u3052\u305fVM\u306e\u6570\u3060\u3051<host/>\u304c\u8ffd\u52a0\u3055\u308c\u307e\u3059\u3002\n\u5b9f\u4f53\u306f`/etc/libvirt/qemu/networks/vagrant.xml`\u3067\u3059\u3002\n\u540c\u3058\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b`network-name.xml`\u304c\u5b58\u5728\u3057\u307e\u3059\u3002\n\u4e2d\u8eab\u304c\u307b\u307c\u7a7a\u306a\u306e\u3067\u3001\u3053\u308c\u3092\u4f7f\u3063\u3066\u30db\u30b9\u30c8\u30aa\u30f3\u30ea\u30fc\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u3092\u4f5c\u308d\u3046\u3068\u601d\u3044\u307e\u3059\u3002\n\n```shell-session\n$ cd /etc/libvirt/qemu/networks\n$ sudo cp network-name.xml host_only.xml\n$ sudo vim host_only.xml\n<network>\n  <name>host_only</name>\n  <uuid>934780ae-3534-4ec4-8338-fe6a8379cbc5</uuid>\n  <bridge name='host_only0' stp='on' delay='0'/>\n  <mac address='52:54:00:25:f1:c6'/>\n</network>\n# \u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u3092\u5b9a\u7fa9\u3057\u307e\u3059\n$ virsh net-define host_only\nNetwork host_only defined from host_only.xml\n# \u81ea\u52d5\u3067\u8d77\u52d5\u3059\u308b\u3088\u3046\u306b\u8a2d\u5b9a\u3057\u307e\u3059\n$ virsh net-autostart host_only\nerror: failed to mark network host_only as autostarted\nerror: Requested operation is not valid: cannot set autostart for transient network\n```\n\nautostart\u3092\u5b9f\u884c\u3057\u3088\u3046\u3068\u3057\u305f\u3089\u6012\u3089\u308c\u307e\u3057\u305f\u3002\n\u3088\u304f\u5206\u304b\u3089\u306a\u304b\u3063\u305f\u306e\u3067\u3059\u304c\u3001\nhttps://www.mynakedgirlfriend.de/libvirt-cannot-set-autostart-for-transient-network/\n\u3092\u898b\u308b\u306b\u3001\u4e00\u5ea6`virsh edit`\u3057\u3066\u304b\u3089\u306a\u3089\u51fa\u6765\u308b\u307f\u305f\u3044\u3067\u3059\u3002\n\n```console\n$ virsh\n#net-edit\u3067MAC\u30a2\u30c9\u30ec\u30b9\u306e\u90e8\u5206\u3092\u6d88\u3059\u3002\nvirsh # net-edit host_only\n<network>\n  <name>host_only</name>\n  <uuid>934780ae-3534-4ec4-8338-fe6a8379cbc5</uuid>\n  <bridge name='host_only0' stp='on' delay='0'/>\n</network>\n\nNetwork host_only XML configuration edited.\n\nvirsh # net-autostart host_only\nNetwork host_only marked as autostarted\n```\n\n\u3042\u3068\u306f\u3053\u308c\u3092VM\u306battach\u3059\u308c\u3070\u5b8c\u4e86\u3067\u3059\u3002\n\u30db\u30b9\u30c8\u5074\u306bIP\u30a2\u30c9\u30ec\u30b9\u3092\u81ea\u52d5\u3067\u5272\u308a\u5f53\u3066\u3066\u304f\u308c\u305f\u308a\u306f\u3057\u306a\u3044\u306e\u3067\u3001\u624b\u52d5\u3067\u5272\u308a\u632f\u3063\u3066\u4e0b\u3055\u3044\u3002\n\u305d\u306e\u3042\u305f\u308a\u306f\u8abf\u3079\u308c\u3070\u51fa\u308b\u3068\u601d\u3046\u306e\u3067\u7701\u7565\u3057\u307e\u3059\u3002\u6687\u3060\u3063\u305f\u3089\u3044\u3064\u304b\u66f8\u304d\u307e\u3059\u3002\n\n##\u304a\u307e\u3051\uff1a\u56fa\u5b9aIP\u30a2\u30c9\u30ec\u30b9\u306eNAT\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\nDHCP\u3058\u3083\u306a\u304f\u3066\u56fa\u5b9aIP\u30a2\u30c9\u30ec\u30b9\u306eNAT\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u3082\u6b32\u3057\u304f\u306a\u3063\u305f\u306e\u3067\u8ffd\u8a18\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n\u4e0a\u8a18\u306ehost_only.xml\u3068\u540c\u69d8\u306b\u3001xml\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n`vagrant.xml`\u3092\u30b3\u30d4\u30fc\u3057\u3066\u4f5c\u308b\u3068\u624b\u3063\u53d6\u308a\u65e9\u3044\u3068\u601d\u3044\u307e\u3059\u3002\n\n\n```xml:host_only.xml\n<network>\n  <name>hostonly0</name>\n  <forward mode='nat'/>\n  <bridge name='hostonly0' stp='on' delay='0'/>\n  <domain name='hostonly0.local'/>\n  <ip address='192.168.124.1' netmask='255.255.255.0'>\n  </ip>\n</network>\n```\n\nuuid\u3084mac address\u306f\u6d88\u3057\u307e\u3059\u3002\nname\u3084bridge name\u3092\u5909\u3048\u3066\u3001ip address\u306e\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u3092\u4ed6\u3068\u88ab\u3089\u306a\u3044\u3088\u3046\u306b\u5909\u66f4\u3057\u305f\u3042\u3068\u3001dhcp\u306e\u90e8\u5206\u3092\u6d88\u3059\u3060\u3051\u3067\u3059\u3002\n\u3053\u308c\u3067\u4e0a\u8a18\u540c\u69d8\u306b\u3059\u308c\u3070\u56fa\u5b9aIP\u30a2\u30c9\u30ec\u30b9\u306eNAT\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u304c\u51fa\u6765\u307e\u3059\u3002\n\n", "tags": ["Ubuntu", "Linux", "KVM", "Network", "vagrant"]}