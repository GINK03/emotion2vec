{"context": "\n\n\u524d\u63d0\u8a18\u4e8b\nPython\u3067\u66f8\u3044\u305f\u79fb\u52d5\u5e73\u5747\u306e\u8a08\u7b97\u6642\u9593\u3092\u6bd4\u8f03\u3057\u3066\u307f\u305f\n\u79fb\u52d5\u5e73\u5747\u8a08\u7b97\u3055\u305b\u308b\u306e\u306b\u3001Python\u3067for\u6587\u4f7f\u3046\u306e\u306f\u8ad6\u5916\u3067\u3001pandas\u3001scipy\u306e\u95a2\u6570\u4f7f\u3063\u305f\u65b9\u304c\u3088\u3044\u3068\u3044\u3046\u7d50\u679c\u3002\u305f\u3060\u3001\u4e0a\u8a18\u306e\u8a18\u4e8b\u3067\u306fSMA\u3001LWMA\u3068\u3044\u3046FIR\u30d5\u30a3\u30eb\u30bf\u578b\u306e\u79fb\u52d5\u5e73\u5747\u3060\u3063\u305f\u306e\u3067\u3001\u4eca\u56de\u306fEMA\u3001SMMA\u3068\u3044\u3063\u305fIIR\u30d5\u30a3\u30eb\u30bf\u578b\u306e\u79fb\u52d5\u5e73\u5747\u306b\u3064\u3044\u3066\u8abf\u3079\u3066\u307f\u307e\u3057\u305f\u3002\n\nEMA\nEMA\u3068\u306f\u3001Exponential Moving Average\u306e\u7565\u3067\u3001\u6b21\u306e\u3088\u3046\u306a\u5f0f\u3067\u8868\u3057\u307e\u3059\u3002\n$$y(n)=\\alpha x(n)+(1-\\alpha)y(n-1)$$\n\u3053\u3053\u3067\u3001$\\alpha$\u306f0\uff5e1\u306e\u5b9f\u6570\u30d1\u30e9\u30e1\u30fc\u30bf\u3067\u3059\u3002\u3053\u306e\u5f0f\u3067\u306f\u671f\u9593\u3092\u8868\u3059\u30d1\u30e9\u30e1\u30fc\u30bf\u306f\u5165\u3063\u3066\u3044\u306a\u3044\u306e\u3067\u3059\u304c\u3001SMA\u3001LWMA\u3067\u306f\u671f\u9593\u3092\u8868\u3059\u30d1\u30e9\u30e1\u30fc\u30bf\u3092\u4f7f\u3046\u306e\u3067\u3001\u305d\u308c\u306b\u5408\u308f\u305b\u3066EMA\u3067\u3082\u671f\u9593\u30d1\u30e9\u30e1\u30fc\u30bf\u3092\u4f7f\u3046\u3053\u3068\u304c\u591a\u3044\u3067\u3059\u3002\u671f\u9593\u3092$p$\u3068\u3059\u308b\u3068\u3001$\\alpha=2/(p+1)$\u3068\u3057\u305f\u306e\u304cEMA\u3067\u3001$\\alpha=1/p$\u3068\u3057\u305f\u306e\u304cSMMA\u3067\u3059\u3002\u500b\u4eba\u7684\u306b\u306fEMA\u3082SMMA\u3082\u540c\u3058\u5f0f\u306a\u306e\u3067\u533a\u5225\u3059\u308b\u5fc5\u8981\u306f\u306a\u3044\u3068\u601d\u3046\u306e\u3067\u3059\u304c\u3001MetaTrader\u3067\u533a\u5225\u3057\u3066\u4f7f\u308f\u308c\u3066\u3044\u308b\u306e\u3067\u4e00\u5fdc\u8a00\u53ca\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n\npandas\u3067\u5b9f\u88c5\n\u307e\u305a\u306fpandas\u3067\u5b9f\u88c5\u3057\u3066\u307f\u307e\u3059\u3002\u51e6\u7406\u3059\u308b\u30c7\u30fc\u30bf\u306f\u524d\u56de\u306e\u8a18\u4e8b\u3068\u540c\u3058\u3067\u3059\u3002\uff13\uff17\u4e07\u500b\u307b\u3069\u306e\uff14\u672c\u5024\u6642\u7cfb\u5217\u3067\u3059\u3002pandas\u306f\u6642\u7cfb\u5217\u30c7\u30fc\u30bf\u5411\u3051\u306a\u306e\u3067\u3001EMA\u3082ewm()\u3068mean()\u95a2\u6570\u3067\u7c21\u5358\u306b\u66f8\u304f\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\nimport numpy as np\nimport pandas as pd\ndataM1 = pd.read_csv('DAT_ASCII_EURUSD_M1_2015.csv', sep=';',\n                     names=('Time','Open','High','Low','Close', ''),\n                     index_col='Time', parse_dates=True)\n\ndef EMA(s, ma_period):\n    return s.ewm(span=ma_period).mean()\n\n%timeit MA = EMA(dataM1['Close'], 10)\n\n\u4eca\u56de\u3082\u5b9f\u884c\u6642\u9593\u3092\u6bd4\u8f03\u3059\u308b\u306e\u3067\u3001\u8a08\u6e2c\u7d50\u679c\u3092\u793a\u3057\u307e\u3059\u3002\n10 loops, best of 3: 32.2 ms per loop\n\nSMA\u306e\u5834\u5408\u300116\u30df\u30ea\u79d2\u304f\u3089\u3044\u3060\u3063\u305f\u306e\u3067\u3001\uff12\u500d\u307b\u3069\u9045\u304f\u306a\u3063\u3066\u3044\u307e\u3059\u3002\n\nscipy\u3067\u5b9f\u88c5\u3059\u308b\u524d\u306b\u3061\u3087\u3063\u3068\u5909\u63db\nscipy\u306elfilter()\u3092\u4f7f\u3046\u5834\u5408\u3001\u305f\u3060$\\alpha$\u3092\u5165\u308c\u308b\u3060\u3051\u3067\u306f\u30c0\u30e1\u3067\u3001IIR\u30d5\u30a3\u30eb\u30bf\u306e\u5f62\u5f0f\u306b\u5909\u3048\u3066\u3001\u305d\u306e\u4fc2\u6570\u3092\u5165\u308c\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\u3068\u3044\u3046\u3053\u3068\u3067\u3001\u3061\u3087\u3063\u3068\u5909\u63db\u3057\u307e\u3059\u3002\uff08\u8a73\u3057\u3044\u7406\u8ad6\u306f\u7701\u7565\u3057\u307e\u3059\u3002\u30c7\u30a3\u30b8\u30bf\u30eb\u4fe1\u53f7\u51e6\u7406\u306e\u57fa\u672c\u3067\u3059\u3002\uff09\nEMA\u306e\u5f0f\u306e\u4e21\u8fba\u3092$z$\u5909\u63db\u3057\u307e\u3059\u3002\n$$Y(z)=\\alpha X(z)+(1-\\alpha)z^{-1}Y(z)$$\n$Y(z)$\u3092\u5de6\u8fba\u306b\u307e\u3068\u3081\u308b\u3068\n$$\\{1-(1-\\alpha)z^{-1}\\}Y(z)=\\alpha X(z)$$\n\u3068\u306a\u308a\u3001$Y(z)/X(z)$\u3092$H(z)$\u3068\u3059\u308b\u3068\u3001\n$$H(z)=\\frac{\\alpha}{1-(1-\\alpha)z^{-1}}$$\n\u3068\u66f8\u3051\u307e\u3059\u3002\u3053\u308c\u304cIIR\u30d5\u30a3\u30eb\u30bf\u306e\u30b7\u30b9\u30c6\u30e0\u95a2\u6570\u3068\u306a\u308a\u307e\u3059\u3002lfilter()\u306e\u5f15\u6570\u306b\u6e21\u3059\u306e\u306f\u3001\u3053\u306e\u30b7\u30b9\u30c6\u30e0\u95a2\u6570\u306e\u5206\u5b50\u591a\u9805\u5f0f\u306e\u4fc2\u6570\u3001\u5206\u6bcd\u591a\u9805\u5f0f\u306e\u4fc2\u6570\u3067\u3059\u3002\nEMA\u306e\u5834\u5408\u3001\u30b7\u30b9\u30c6\u30e0\u95a2\u6570\u306e\u5206\u5b50\u306f\u5b9a\u6570\u3001\u5206\u6bcd\u306f\uff11\u6b21\u591a\u9805\u5f0f\u306a\u306e\u3067\u3001\u30b7\u30b9\u30c6\u30e0\u95a2\u6570\u306e\u4e00\u822c\u5f0f\u306f\u6b21\u306e\u3088\u3046\u306b\u66f8\u3051\u307e\u3059\u3002\n$$H(z)=\\frac{b_0}{a_0+a_1z^{-1}}$$\n\u4fc2\u6570\u3092\u6bd4\u8f03\u3059\u308b\u3068\u3001$b$\u3001$a$\u306e\u4fc2\u6570\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u306a\u308b\u3053\u3068\u304c\u308f\u304b\u308a\u307e\u3059\u3002\n$$b_0=\\alpha, \\ a_0=1, \\ a_1=\\alpha-1$$\n\nscipy\u3067\u5b9f\u88c5\n\u3068\u3044\u3046\u3053\u3068\u3067\u3001EMA\u3092scipy\u306elflter()\u3092\u4f7f\u3063\u3066\u5b9f\u88c5\u3059\u308b\u3068\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u66f8\u3051\u307e\u3059\u3002\u4e0a\u306e$b$\u3001$a$\u3092\u30ea\u30b9\u30c8\u306e\u5f62\u3067\u5f15\u6570\u306b\u5165\u308c\u307e\u3059\u3002\nfrom scipy.signal import lfilter\ndef EMAnew(s, ma_period):\n    alpha = 2/(ma_period+1)\n    y = lfilter([alpha], [1,alpha-1], s)\n    return pd.Series(y, index=s.index)\n\n%timeit MA = EMAnew(dataM1['Close'], 10)\n\n\u7d50\u679c\u306f\n100 loops, best of 3: 3.08 ms per loop\n\n\u3068\u306a\u308a\u3001SMA\u306e\u5834\u5408\u3068\u307b\u307c\u540c\u3058\u901f\u3055\u3068\u306a\u308a\u307e\u3057\u305f\u3002\u3084\u306f\u308a\u3001lfilter()\u901f\u3044\u3002\n\nlfilter()\u306e\u521d\u671f\u6761\u4ef6\u306e\u8abf\u6574\n\u4eca\u56de\u3082lfilter()\u304c\u901f\u3044\u3068\u3044\u3046\u7d50\u679c\u306b\u306a\u3063\u305f\u306e\u3067\u3059\u304c\u3001\u82e5\u5e72\u51e6\u7406\u7d50\u679c\u306b\u554f\u984c\u304c\u3042\u308a\u307e\u3059\u3002\nEMA\u3060\u3068\u3001\u6700\u521d\u306e\u51fa\u529b$y(0)$\u3092\u8a08\u7b97\u3059\u308b\u3055\u3044\u306b\u3001\u30c7\u30fc\u30bf\u306e\u5b58\u5728\u3057\u306a\u3044$y(-1)$\u3092\u4f7f\u3046\u306e\u3067\u3059\u304c\u3001pandas\u306e\u5834\u5408\u3001\u6642\u7cfb\u5217\u30c7\u30fc\u30bf\u5411\u304d\u3068\u3044\u3046\u3053\u3068\u3067\u3001$y(0)=x(0)$\u3068\u3057\u3066\u3001$y(-1)$\u3092\u4f7f\u308f\u306a\u3044\u3088\u3046\u306b\u51e6\u7406\u3055\u308c\u3066\u3044\u307e\u3059\u3002\npd.DataFrame({'Close':dataM1['Close'],'EMA':MA}).head(10)\n\n\n\n\n\n\nClose\nEMA\n\n\nTime\n\n\n\n\n\n\n2015-01-01 13:00:00\n1.20962\n1.209620\n\n\n2015-01-01 13:01:00\n1.20962\n1.209620\n\n\n2015-01-01 13:02:00\n1.20961\n1.209616\n\n\n2015-01-01 13:04:00\n1.20983\n1.209686\n\n\n2015-01-01 13:05:00\n1.20988\n1.209742\n\n\n2015-01-01 13:06:00\n1.20982\n1.209762\n\n\n2015-01-01 13:07:00\n1.20987\n1.209788\n\n\n2015-01-01 13:08:00\n1.21008\n1.209855\n\n\n2015-01-01 13:09:00\n1.20996\n1.209878\n\n\n2015-01-01 13:10:00\n1.20977\n1.209855\n\n\n\n\n\u3053\u306e\u5834\u5408\u3001EMA\u306e\u7d50\u679c\u3082\u5165\u529b\u306e\u6642\u7cfb\u5217\u3068\u305d\u3046\u5916\u308c\u3066\u306f\u3044\u306a\u3044\u306e\u3067\u3059\u304c\u3001lfilter()\u306e\u5834\u5408\u3001$y(-1)=0$\u3068\u3057\u3066\u8a08\u7b97\u3057\u3066\u3057\u307e\u3046\u306e\u3067\u3001\u6700\u521d\u306e\u65b9\u306eEMA\u306e\u5024\u304c\u5165\u529b\u304b\u3089\u304b\u306a\u308a\u305a\u308c\u3066\u3057\u307e\u3046\u3053\u3068\u306b\u306a\u308a\u307e\u3059\u3002\n\n\n\n\n\nClose\nEMA\n\n\nTime\n\n\n\n\n\n\n2015-01-01 13:00:00\n1.20962\n0.219931\n\n\n2015-01-01 13:01:00\n1.20962\n0.399874\n\n\n2015-01-01 13:02:00\n1.20961\n0.547099\n\n\n2015-01-01 13:04:00\n1.20983\n0.667596\n\n\n2015-01-01 13:05:00\n1.20988\n0.766193\n\n\n2015-01-01 13:06:00\n1.20982\n0.846852\n\n\n2015-01-01 13:07:00\n1.20987\n0.912855\n\n\n2015-01-01 13:08:00\n1.21008\n0.966896\n\n\n2015-01-01 13:09:00\n1.20996\n1.011090\n\n\n2015-01-01 13:10:00\n1.20977\n1.047213\n\n\n\n\n\u3053\u306e\u554f\u984c\u306flfilter()\u306e\u30aa\u30d7\u30b7\u30e7\u30ca\u30eb\u5f15\u6570\u3067\u89e3\u6c7a\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u308b\u3088\u3046\u3067\u3059\u3002\u6b21\u306e\u3088\u3046\u306b\u66f8\u304f\u3053\u3068\u3067\u3001pandas\u3068\u307b\u307c\u540c\u3058\u7d50\u679c\u304c\u5f97\u3089\u308c\u307e\u3057\u305f\u3002\ndef EMAnew(s, ma_period):\n    alpha = 2/(ma_period+1)\n    y,zf = lfilter([alpha], [1,alpha-1], s, zi=[s[0]*(1-alpha)])\n    return pd.Series(y, index=s.index)\n\n\u3053\u3053\u3067\u3001zi\u306f\u72b6\u614b\u5909\u6570\u306e\u521d\u671f\u5024\u3068\u3044\u3046\u3053\u3068\u306a\u306e\u3067\u3001\u5358\u306a\u308b\u5165\u529b\u3001\u51fa\u529b\u306e\u521d\u671f\u5024\u306e\u3053\u3068\u3067\u306f\u306a\u3044\u306e\u3067\u3059\u304c\u3001\u3053\u3053\u3067\u306f\u3001$y(0)=\\alpha x(0)+zi=x(0)$\u306b\u306a\u308b\u3088\u3046\u306azi\u3092\u5165\u308c\u3066\u304a\u304f\u3068\u3001\u305d\u308c\u3089\u3057\u3044\u7d50\u679c\u306b\u306a\u308b\u3088\u3046\u3067\u3059\u3002\n#\u524d\u63d0\u8a18\u4e8b\n[Python\u3067\u66f8\u3044\u305f\u79fb\u52d5\u5e73\u5747\u306e\u8a08\u7b97\u6642\u9593\u3092\u6bd4\u8f03\u3057\u3066\u307f\u305f](http://qiita.com/toyolab/items/215a943c5cb0c677fa5a)\n\n\u79fb\u52d5\u5e73\u5747\u8a08\u7b97\u3055\u305b\u308b\u306e\u306b\u3001Python\u3067for\u6587\u4f7f\u3046\u306e\u306f\u8ad6\u5916\u3067\u3001pandas\u3001scipy\u306e\u95a2\u6570\u4f7f\u3063\u305f\u65b9\u304c\u3088\u3044\u3068\u3044\u3046\u7d50\u679c\u3002\u305f\u3060\u3001\u4e0a\u8a18\u306e\u8a18\u4e8b\u3067\u306fSMA\u3001LWMA\u3068\u3044\u3046FIR\u30d5\u30a3\u30eb\u30bf\u578b\u306e\u79fb\u52d5\u5e73\u5747\u3060\u3063\u305f\u306e\u3067\u3001\u4eca\u56de\u306fEMA\u3001SMMA\u3068\u3044\u3063\u305fIIR\u30d5\u30a3\u30eb\u30bf\u578b\u306e\u79fb\u52d5\u5e73\u5747\u306b\u3064\u3044\u3066\u8abf\u3079\u3066\u307f\u307e\u3057\u305f\u3002\n\n#EMA\nEMA\u3068\u306f\u3001Exponential Moving Average\u306e\u7565\u3067\u3001\u6b21\u306e\u3088\u3046\u306a\u5f0f\u3067\u8868\u3057\u307e\u3059\u3002\n\n$$y(n)=\\alpha x(n)+(1-\\alpha)y(n-1)$$\n\n\u3053\u3053\u3067\u3001$\\alpha$\u306f0\uff5e1\u306e\u5b9f\u6570\u30d1\u30e9\u30e1\u30fc\u30bf\u3067\u3059\u3002\u3053\u306e\u5f0f\u3067\u306f\u671f\u9593\u3092\u8868\u3059\u30d1\u30e9\u30e1\u30fc\u30bf\u306f\u5165\u3063\u3066\u3044\u306a\u3044\u306e\u3067\u3059\u304c\u3001SMA\u3001LWMA\u3067\u306f\u671f\u9593\u3092\u8868\u3059\u30d1\u30e9\u30e1\u30fc\u30bf\u3092\u4f7f\u3046\u306e\u3067\u3001\u305d\u308c\u306b\u5408\u308f\u305b\u3066EMA\u3067\u3082\u671f\u9593\u30d1\u30e9\u30e1\u30fc\u30bf\u3092\u4f7f\u3046\u3053\u3068\u304c\u591a\u3044\u3067\u3059\u3002\u671f\u9593\u3092$p$\u3068\u3059\u308b\u3068\u3001$\\alpha=2/(p+1)$\u3068\u3057\u305f\u306e\u304cEMA\u3067\u3001$\\alpha=1/p$\u3068\u3057\u305f\u306e\u304cSMMA\u3067\u3059\u3002\u500b\u4eba\u7684\u306b\u306fEMA\u3082SMMA\u3082\u540c\u3058\u5f0f\u306a\u306e\u3067\u533a\u5225\u3059\u308b\u5fc5\u8981\u306f\u306a\u3044\u3068\u601d\u3046\u306e\u3067\u3059\u304c\u3001MetaTrader\u3067\u533a\u5225\u3057\u3066\u4f7f\u308f\u308c\u3066\u3044\u308b\u306e\u3067\u4e00\u5fdc\u8a00\u53ca\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n\n\n#pandas\u3067\u5b9f\u88c5\n\n\u307e\u305a\u306fpandas\u3067\u5b9f\u88c5\u3057\u3066\u307f\u307e\u3059\u3002\u51e6\u7406\u3059\u308b\u30c7\u30fc\u30bf\u306f\u524d\u56de\u306e\u8a18\u4e8b\u3068\u540c\u3058\u3067\u3059\u3002\uff13\uff17\u4e07\u500b\u307b\u3069\u306e\uff14\u672c\u5024\u6642\u7cfb\u5217\u3067\u3059\u3002pandas\u306f\u6642\u7cfb\u5217\u30c7\u30fc\u30bf\u5411\u3051\u306a\u306e\u3067\u3001EMA\u3082`ewm()`\u3068`mean()`\u95a2\u6570\u3067\u7c21\u5358\u306b\u66f8\u304f\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n````py\nimport numpy as np\nimport pandas as pd\ndataM1 = pd.read_csv('DAT_ASCII_EURUSD_M1_2015.csv', sep=';',\n                     names=('Time','Open','High','Low','Close', ''),\n                     index_col='Time', parse_dates=True)\n\ndef EMA(s, ma_period):\n    return s.ewm(span=ma_period).mean()\n\n%timeit MA = EMA(dataM1['Close'], 10)\n````\n\u4eca\u56de\u3082\u5b9f\u884c\u6642\u9593\u3092\u6bd4\u8f03\u3059\u308b\u306e\u3067\u3001\u8a08\u6e2c\u7d50\u679c\u3092\u793a\u3057\u307e\u3059\u3002\n\n    10 loops, best of 3: 32.2 ms per loop\n\nSMA\u306e\u5834\u5408\u300116\u30df\u30ea\u79d2\u304f\u3089\u3044\u3060\u3063\u305f\u306e\u3067\u3001\uff12\u500d\u307b\u3069\u9045\u304f\u306a\u3063\u3066\u3044\u307e\u3059\u3002\n\n#scipy\u3067\u5b9f\u88c5\u3059\u308b\u524d\u306b\u3061\u3087\u3063\u3068\u5909\u63db\n\nscipy\u306e`lfilter()`\u3092\u4f7f\u3046\u5834\u5408\u3001\u305f\u3060$\\alpha$\u3092\u5165\u308c\u308b\u3060\u3051\u3067\u306f\u30c0\u30e1\u3067\u3001IIR\u30d5\u30a3\u30eb\u30bf\u306e\u5f62\u5f0f\u306b\u5909\u3048\u3066\u3001\u305d\u306e\u4fc2\u6570\u3092\u5165\u308c\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\u3068\u3044\u3046\u3053\u3068\u3067\u3001\u3061\u3087\u3063\u3068\u5909\u63db\u3057\u307e\u3059\u3002\uff08\u8a73\u3057\u3044\u7406\u8ad6\u306f\u7701\u7565\u3057\u307e\u3059\u3002\u30c7\u30a3\u30b8\u30bf\u30eb\u4fe1\u53f7\u51e6\u7406\u306e\u57fa\u672c\u3067\u3059\u3002\uff09\n\nEMA\u306e\u5f0f\u306e\u4e21\u8fba\u3092$z$\u5909\u63db\u3057\u307e\u3059\u3002\n\n$$Y(z)=\\alpha X(z)+(1-\\alpha)z^{-1}Y(z)$$\n\n$Y(z)$\u3092\u5de6\u8fba\u306b\u307e\u3068\u3081\u308b\u3068\n\n$$\\\\{1-(1-\\alpha)z^{-1}\\\\}Y(z)=\\alpha X(z)$$\n\n\u3068\u306a\u308a\u3001$Y(z)/X(z)$\u3092$H(z)$\u3068\u3059\u308b\u3068\u3001\n\n$$H(z)=\\frac{\\alpha}{1-(1-\\alpha)z^{-1}}$$\n\n\u3068\u66f8\u3051\u307e\u3059\u3002\u3053\u308c\u304cIIR\u30d5\u30a3\u30eb\u30bf\u306e\u30b7\u30b9\u30c6\u30e0\u95a2\u6570\u3068\u306a\u308a\u307e\u3059\u3002`lfilter()`\u306e\u5f15\u6570\u306b\u6e21\u3059\u306e\u306f\u3001\u3053\u306e\u30b7\u30b9\u30c6\u30e0\u95a2\u6570\u306e\u5206\u5b50\u591a\u9805\u5f0f\u306e\u4fc2\u6570\u3001\u5206\u6bcd\u591a\u9805\u5f0f\u306e\u4fc2\u6570\u3067\u3059\u3002\n\nEMA\u306e\u5834\u5408\u3001\u30b7\u30b9\u30c6\u30e0\u95a2\u6570\u306e\u5206\u5b50\u306f\u5b9a\u6570\u3001\u5206\u6bcd\u306f\uff11\u6b21\u591a\u9805\u5f0f\u306a\u306e\u3067\u3001\u30b7\u30b9\u30c6\u30e0\u95a2\u6570\u306e\u4e00\u822c\u5f0f\u306f\u6b21\u306e\u3088\u3046\u306b\u66f8\u3051\u307e\u3059\u3002\n\n$$H(z)=\\frac{b_0}{a_0+a_1z^{-1}}$$\n\n\u4fc2\u6570\u3092\u6bd4\u8f03\u3059\u308b\u3068\u3001$b$\u3001$a$\u306e\u4fc2\u6570\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u306a\u308b\u3053\u3068\u304c\u308f\u304b\u308a\u307e\u3059\u3002\n\n$$b_0=\\alpha, \\ a_0=1, \\ a_1=\\alpha-1$$\n\n#scipy\u3067\u5b9f\u88c5\n\n\u3068\u3044\u3046\u3053\u3068\u3067\u3001EMA\u3092scipy\u306e`lflter()`\u3092\u4f7f\u3063\u3066\u5b9f\u88c5\u3059\u308b\u3068\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u66f8\u3051\u307e\u3059\u3002\u4e0a\u306e$b$\u3001$a$\u3092\u30ea\u30b9\u30c8\u306e\u5f62\u3067\u5f15\u6570\u306b\u5165\u308c\u307e\u3059\u3002\n\n````py\nfrom scipy.signal import lfilter\ndef EMAnew(s, ma_period):\n    alpha = 2/(ma_period+1)\n    y = lfilter([alpha], [1,alpha-1], s)\n    return pd.Series(y, index=s.index)\n\n%timeit MA = EMAnew(dataM1['Close'], 10)\n````\n\n\u7d50\u679c\u306f\n\n    100 loops, best of 3: 3.08 ms per loop\n\n\u3068\u306a\u308a\u3001SMA\u306e\u5834\u5408\u3068\u307b\u307c\u540c\u3058\u901f\u3055\u3068\u306a\u308a\u307e\u3057\u305f\u3002\u3084\u306f\u308a\u3001`lfilter()`\u901f\u3044\u3002\n\n#lfilter()\u306e\u521d\u671f\u6761\u4ef6\u306e\u8abf\u6574\n\n\u4eca\u56de\u3082`lfilter()`\u304c\u901f\u3044\u3068\u3044\u3046\u7d50\u679c\u306b\u306a\u3063\u305f\u306e\u3067\u3059\u304c\u3001\u82e5\u5e72\u51e6\u7406\u7d50\u679c\u306b\u554f\u984c\u304c\u3042\u308a\u307e\u3059\u3002\n\nEMA\u3060\u3068\u3001\u6700\u521d\u306e\u51fa\u529b$y(0)$\u3092\u8a08\u7b97\u3059\u308b\u3055\u3044\u306b\u3001\u30c7\u30fc\u30bf\u306e\u5b58\u5728\u3057\u306a\u3044$y(-1)$\u3092\u4f7f\u3046\u306e\u3067\u3059\u304c\u3001pandas\u306e\u5834\u5408\u3001\u6642\u7cfb\u5217\u30c7\u30fc\u30bf\u5411\u304d\u3068\u3044\u3046\u3053\u3068\u3067\u3001$y(0)=x(0)$\u3068\u3057\u3066\u3001$y(-1)$\u3092\u4f7f\u308f\u306a\u3044\u3088\u3046\u306b\u51e6\u7406\u3055\u308c\u3066\u3044\u307e\u3059\u3002\n\n```python\npd.DataFrame({'Close':dataM1['Close'],'EMA':MA}).head(10)\n```\n\n\n\n\n<div>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Close</th>\n      <th>EMA</th>\n    </tr>\n    <tr>\n      <th>Time</th>\n      <th></th>\n      <th></th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>2015-01-01 13:00:00</th>\n      <td>1.20962</td>\n      <td>1.209620</td>\n    </tr>\n    <tr>\n      <th>2015-01-01 13:01:00</th>\n      <td>1.20962</td>\n      <td>1.209620</td>\n    </tr>\n    <tr>\n      <th>2015-01-01 13:02:00</th>\n      <td>1.20961</td>\n      <td>1.209616</td>\n    </tr>\n    <tr>\n      <th>2015-01-01 13:04:00</th>\n      <td>1.20983</td>\n      <td>1.209686</td>\n    </tr>\n    <tr>\n      <th>2015-01-01 13:05:00</th>\n      <td>1.20988</td>\n      <td>1.209742</td>\n    </tr>\n    <tr>\n      <th>2015-01-01 13:06:00</th>\n      <td>1.20982</td>\n      <td>1.209762</td>\n    </tr>\n    <tr>\n      <th>2015-01-01 13:07:00</th>\n      <td>1.20987</td>\n      <td>1.209788</td>\n    </tr>\n    <tr>\n      <th>2015-01-01 13:08:00</th>\n      <td>1.21008</td>\n      <td>1.209855</td>\n    </tr>\n    <tr>\n      <th>2015-01-01 13:09:00</th>\n      <td>1.20996</td>\n      <td>1.209878</td>\n    </tr>\n    <tr>\n      <th>2015-01-01 13:10:00</th>\n      <td>1.20977</td>\n      <td>1.209855</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n\n\u3053\u306e\u5834\u5408\u3001EMA\u306e\u7d50\u679c\u3082\u5165\u529b\u306e\u6642\u7cfb\u5217\u3068\u305d\u3046\u5916\u308c\u3066\u306f\u3044\u306a\u3044\u306e\u3067\u3059\u304c\u3001`lfilter()`\u306e\u5834\u5408\u3001$y(-1)=0$\u3068\u3057\u3066\u8a08\u7b97\u3057\u3066\u3057\u307e\u3046\u306e\u3067\u3001\u6700\u521d\u306e\u65b9\u306eEMA\u306e\u5024\u304c\u5165\u529b\u304b\u3089\u304b\u306a\u308a\u305a\u308c\u3066\u3057\u307e\u3046\u3053\u3068\u306b\u306a\u308a\u307e\u3059\u3002\n\n<div>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Close</th>\n      <th>EMA</th>\n    </tr>\n    <tr>\n      <th>Time</th>\n      <th></th>\n      <th></th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>2015-01-01 13:00:00</th>\n      <td>1.20962</td>\n      <td>0.219931</td>\n    </tr>\n    <tr>\n      <th>2015-01-01 13:01:00</th>\n      <td>1.20962</td>\n      <td>0.399874</td>\n    </tr>\n    <tr>\n      <th>2015-01-01 13:02:00</th>\n      <td>1.20961</td>\n      <td>0.547099</td>\n    </tr>\n    <tr>\n      <th>2015-01-01 13:04:00</th>\n      <td>1.20983</td>\n      <td>0.667596</td>\n    </tr>\n    <tr>\n      <th>2015-01-01 13:05:00</th>\n      <td>1.20988</td>\n      <td>0.766193</td>\n    </tr>\n    <tr>\n      <th>2015-01-01 13:06:00</th>\n      <td>1.20982</td>\n      <td>0.846852</td>\n    </tr>\n    <tr>\n      <th>2015-01-01 13:07:00</th>\n      <td>1.20987</td>\n      <td>0.912855</td>\n    </tr>\n    <tr>\n      <th>2015-01-01 13:08:00</th>\n      <td>1.21008</td>\n      <td>0.966896</td>\n    </tr>\n    <tr>\n      <th>2015-01-01 13:09:00</th>\n      <td>1.20996</td>\n      <td>1.011090</td>\n    </tr>\n    <tr>\n      <th>2015-01-01 13:10:00</th>\n      <td>1.20977</td>\n      <td>1.047213</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n\n\u3053\u306e\u554f\u984c\u306f`lfilter()`\u306e\u30aa\u30d7\u30b7\u30e7\u30ca\u30eb\u5f15\u6570\u3067\u89e3\u6c7a\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u308b\u3088\u3046\u3067\u3059\u3002\u6b21\u306e\u3088\u3046\u306b\u66f8\u304f\u3053\u3068\u3067\u3001pandas\u3068\u307b\u307c\u540c\u3058\u7d50\u679c\u304c\u5f97\u3089\u308c\u307e\u3057\u305f\u3002\n\n````py\ndef EMAnew(s, ma_period):\n    alpha = 2/(ma_period+1)\n    y,zf = lfilter([alpha], [1,alpha-1], s, zi=[s[0]*(1-alpha)])\n    return pd.Series(y, index=s.index)\n````\n\u3053\u3053\u3067\u3001`zi`\u306f\u72b6\u614b\u5909\u6570\u306e\u521d\u671f\u5024\u3068\u3044\u3046\u3053\u3068\u306a\u306e\u3067\u3001\u5358\u306a\u308b\u5165\u529b\u3001\u51fa\u529b\u306e\u521d\u671f\u5024\u306e\u3053\u3068\u3067\u306f\u306a\u3044\u306e\u3067\u3059\u304c\u3001\u3053\u3053\u3067\u306f\u3001$y(0)=\\alpha x(0)+zi=x(0)$\u306b\u306a\u308b\u3088\u3046\u306a`zi`\u3092\u5165\u308c\u3066\u304a\u304f\u3068\u3001\u305d\u308c\u3089\u3057\u3044\u7d50\u679c\u306b\u306a\u308b\u3088\u3046\u3067\u3059\u3002\n", "tags": ["Python", "MT4", "\u79fb\u52d5\u5e73\u5747", "\u4fe1\u53f7\u51e6\u7406"]}