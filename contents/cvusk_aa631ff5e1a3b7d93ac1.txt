{"context": "\n\nTensorFlowOnSpark\u3092Docker run\u3057\u3066\u307f\u305f\nTensorFlowOnSpark\u306e\u30b9\u30bf\u30f3\u30c9\u30a2\u30ed\u30fc\u30f3\u7248\u3092Docker\u30a4\u30e1\u30fc\u30b8\u306b\u3057\u3066\u307f\u307e\u3057\u305f\u3002\nTensorFlowOnSpark\u306fTensorFlow\u3092Spark\u4e0a\u3067\u7a3c\u50cd\u3055\u305b\u3089\u308c\u308b\u3088\u3046\u306b\u3057\u305f\u3082\u306e\u3067\u3001Yahoo\u304c\u5148\u9031\u304f\u3089\u3044\u306b\u767a\u8868\u3057\u3066\u3044\u307e\u3057\u305f\uff082017/02/13\uff09\u3002\nhttps://github.com/yahoo/TensorFlowOnSpark/wiki\n\u51fa\u305f\u5f53\u65e5\u306b\u30b9\u30bf\u30f3\u30c9\u30a2\u30ed\u30fc\u30f3\u7248\u306e\u69cb\u7bc9\u3092\u8a66\u3057\u3066\u307f\u307e\u3057\u305f\u3002\nhttp://qiita.com/cvusk/items/39a1861715e21b1dc191\n\u3064\u3044\u3067\u306bDockerfile\u306b\u3057\u307e\u3057\u305f\u306e\u304c\u4eca\u56de\u3067\u3059\u3002\n\u7df4\u7fd2\u304c\u3066\u3089\u3002\n\nTensorFlowOnSpark on Docker\n\u30db\u30b9\u30c8OS\u306b\u306fCentOS7.3\u3092\u4f7f\u3063\u3066\u3044\u307e\u3059\u3002\nDocker\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3001\u8d77\u52d5\u4ee5\u5916\u306f\u4ee5\u4e0b\u306e\u3068\u304a\u308a\u3067\u3059\u3002\nsudo yum -y install docker\nsudo systemctl start docker\nsudo systemctl enable docker\n\n\nDockerfile\u3092\u4f5c\u308b\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092\u7528\u610f\u3057\u307e\u3059\u3002\n\nsudo su -\nmkdir -p /opt/tfos\ncd /opt/tfos\n\n\n\u4eca\u56de\u306fUbuntu\u30a4\u30e1\u30fc\u30b8\u3092\u4f7f\u3044\u307e\u3059\u3002\nhttps://hub.docker.com/_/ubuntu/\n\u4e8b\u524d\u306bpull\u3057\u3066\u304a\u304d\u307e\u3059\u3002\ndocker pull ubuntu\n\n\n\nDockerfile\u3092\u4f5c\u308b\n/opt/tfos/\u914d\u4e0b\u306bDockerfile\u3092\u4f5c\u6210\u3057\u3001\u4ee5\u4e0b\u3092\u8a18\u5165\u3057\u3066\u4fdd\u5b58\u3057\u307e\u3059\u3002\n\uff082017/02/23\u3000\u4fee\u6b63\u3057\u307e\u3057\u305f\u3002\uff09\nFROM ubuntu\nMAINTAINER cvusk\n\n# insert hostname on environmental variable\nENV HOSTNAME tensorflow.spark\n\n# install prerequisites\nRUN apt-get -y update\nRUN apt-get -y upgrade\nRUN apt-get -y install apt-utils\nRUN apt-get -y install software-properties-common python-software-properties\nRUN add-apt-repository ppa:openjdk-r/ppa\nRUN apt-get -y update\nRUN apt-get -y install wget curl zip unzip vim openjdk-7-jre openjdk-7-jdk git python-pip python-dev python-virtualenv\nENV JAVA_HOME=/usr/lib/jvm/java-7-openjdk-amd64\n\n# git clone tensorflowonspark.git\nWORKDIR /opt/\nRUN git clone --recurse-submodules https://github.com/yahoo/TensorFlowOnSpark.git\n\nWORKDIR /opt/TensorFlowOnSpark/\nRUN git submodule init\nRUN git submodule update --force\nRUN git submodule foreach --recursive git clean -dfx\n\n# environmental variable for tensorflowonspark home\nENV TFoS_HOME=/opt/TensorFlowOnSpark\n\nWORKDIR /opt/TensorFlowOnSpark/src/\nRUN zip -r /opt/TensorFlowOnSpark/tfspark.zip /opt/TensorFlowOnSpark/src/*\nWORKDIR /opt/TensorFlowOnSpark/\n\n# setup spark\nRUN sh /opt/TensorFlowOnSpark/scripts/local-setup-spark.sh\nENV SPARK_HOME=/opt/TensorFlowOnSpark/spark-1.6.0-bin-hadoop2.6\nENV PATH=/opt/TensorFlowOnSpark/src:${PATH}\nENV PATH=${SPARK_HOME}/bin:${PATH}\nENV PYTHONPATH=/opt/TensorFlowOnSpark/src\n\n\n# install tensorflow, jupyter and py4j\nRUN pip install pip --upgrade\nRUN python -m pip install tensorflow\nRUN pip install jupyter jupyter[notebook]\nRUN pip install py4j\n\n\n# download mnist data\nRUN mkdir /opt/TensorFlowOnSpark/mnist\nWORKDIR /opt/TensorFlowOnSpark/mnist/\nRUN curl -O \"http://yann.lecun.com/exdb/mnist/train-images-idx3-ubyte.gz\"\nRUN curl -O \"http://yann.lecun.com/exdb/mnist/train-labels-idx1-ubyte.gz\"\nRUN curl -O \"http://yann.lecun.com/exdb/mnist/t10k-images-idx3-ubyte.gz\"\nRUN curl -O \"http://yann.lecun.com/exdb/mnist/t10k-labels-idx1-ubyte.gz\"\n\n\n# create shellscript for starting spark standalone cluster\nRUN echo '${SPARK_HOME}/sbin/start-master.sh' >> ${TFoS_HOME}/spark_cluster.sh\nRUN echo 'MASTER=spark://${HOSTNAME}:7077' >> ${TFoS_HOME}/spark_cluster.sh\nRUN echo 'SPARK_WORKER_INSTANCES=2' >> ${TFoS_HOME}/spark_cluster.sh\nRUN echo 'CORES_PER_WORKER=1' >> ${TFoS_HOME}/spark_cluster.sh\nRUN echo 'TOTAL_CORES=$((${CORES_PER_WORKER}*${SPARK_WORKER_INSTANCES}))' >> ${TFoS_HOME}/spark_cluster.sh\nRUN echo '${SPARK_HOME}/sbin/start-slave.sh -c $CORES_PER_WORKER -m 3G ${MASTER}' >> ${TFoS_HOME}/spark_cluster.sh\nRUN echo '${SPARK_HOME}/sbin/start-slave.sh -c $CORES_PER_WORKER -m 3G ${MASTER}' >> ${TFoS_HOME}/spark_cluster.sh\n\n\nENV MASTER=spark://${HOSTNAME}:7077\nENV SPARK_WORKER_INSTANCES=2\nENV CORES_PER_WORKER=1\nENV TOTAL_CORES=2\n\n\n# create shellscript for pyspark on jupyter and mnist data\nWORKDIR /opt/TensorFlowOnSpark/\n\nRUN echo \"PYSPARK_DRIVER_PYTHON=\\\"jupyter\\\" PYSPARK_DRIVER_PYTHON_OPTS=\\\"notebook --no-browser --ip=* --NotebookApp.token=''\\\" pyspark  --master ${MASTER} --conf spark.cores.max=${TOTAL_CORES} --conf spark.task.cpus=${CORES_PER_WORKER} --py-files ${TFoS_HOME}/tfspark.zip,${TFoS_HOME}/examples/mnist/spark/mnist_dist.py --conf spark.executorEnv.JAVA_HOME=\\\"$JAVA_HOME\\\"\" > ${TFoS_HOME}/pyspark_notebook.sh\n\nRUN echo \"${SPARK_HOME}/bin/spark-submit --master ${MASTER} ${TFoS_HOME}/examples/mnist/mnist_data_setup.py --output examples/mnist/csv --format csv\" > ${TFoS_HOME}/mnist_data_setup.sh\n\n\n\n\u3084\u3063\u3066\u3044\u308b\u3053\u3068\u3068\u3057\u3066\u3001TensorFlowOnSpark\u30b9\u30bf\u30f3\u30c9\u30a2\u30ed\u30fc\u30f3\u7248\u306e\u69cb\u7bc9\u624b\u9806\u3092Docker\u7528\u306b\u66f8\u304d\u63db\u3048\u3066\u3044\u307e\u3059\u3002\nhttps://github.com/yahoo/TensorFlowOnSpark/wiki/GetStarted_standalone\nspark master\u3001slave\u306e\u8d77\u52d5\u3092\u30b7\u30a7\u30eb\u30b9\u30af\u30ea\u30d7\u30c8\u306b\u3057\u3066\u304a\u304d\u305f\u304b\u3063\u305f\u306e\u3067\u3001\u305d\u306e\u5909\u6570\u306e\u305f\u3081\u306b\u74b0\u5883\u5909\u6570\u306bHOSTNAME=tensorflow.spark\u3092\u5b9a\u7fa9\u3057\u3066\u3044\u307e\u3059\u3002\n\u3082\u3046\u3061\u3087\u3044\u304b\u3063\u3053\u3044\u3044\u65b9\u6cd5\u3067\u30db\u30b9\u30c8\u540d\u3092\u4f7f\u3044\u305f\u3044\u306e\u3067\u3059\u304c\u30fb\u30fb\u30fb\u3002\n\u3053\u308c\u3092\u30d3\u30eb\u30c9\u3057\u307e\u3059\u3002\ncd /opt/tfos\ndocker build -t tfos/tfos .\n\n\n\u3053\u3093\u306a\u611f\u3058\u306b\u3067\u304d\u3042\u304c\u308a\u307e\u3059\u3002\ndocker images\n\n\n\n\n\u52d5\u304b\u3057\u3066\u307f\u307e\u3059\nDocker\u30a4\u30e1\u30fc\u30b8\u304c\u3067\u304d\u3042\u304c\u3063\u305f\u3089\u4ee5\u4e0b\u3067run\u3057\u307e\u3059\u3002\ndocker run -it -p 8889:8888 -h tensorflow.spark 5db5add35c10 /bin/bash\n\n\n\u30dd\u30fc\u30c8\u756a\u53f7\u306f8889:8888\uff08\u30db\u30b9\u30c8OS\u306e\u30dd\u30fc\u30c8\uff1a\u30b3\u30f3\u30c6\u30ca\u306e\u30dd\u30fc\u30c8\uff09\u3067\u516c\u958b\u3057\u307e\u3059\u3002\u3053\u308c\u306fpyspark\uff08Jupyter Notebook\uff09\u7528\u3067\u3059\u3002\n\u30db\u30b9\u30c8\u540d\u306btensorflow.spark\u3092\u6307\u5b9a\u3057\u307e\u3059\u304c\u3001\u3053\u308c\u306fDockerfile\u306b\u66f8\u3044\u305f\u3082\u306e\u3092\u4f7f\u3063\u3066\u3044\u307e\u3059\u3002\n\n\u306f\u3044\u3001\u8d77\u52d5\u3057\u307e\u3057\u305f\u3002\n/opt/TensorFlowOnSpark\u914d\u4e0b\u306espark_cluster.sh\u3092\u5b9f\u884c\u3059\u308b\u3068\u3001\u3053\u306eDocker\u30b3\u30f3\u30c6\u30ca\u304cspark master\u517cslave\u306b\u306a\u308a\u307e\u3059\u3002\n\u306a\u304a\u3001slave\u306f\uff12\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u8d77\u52d5\u3057\u3066\u3044\u307e\u3059\u3002\ncd /opt/TensorFlowOnSpark\nsh ./spark_cluster.sh\n\n\n\n/opt/TensorFlowOnSpark/\u914d\u4e0b\u306bMNIST\u306e\u30c7\u30fc\u30bf\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\u7528\u30b7\u30a7\u30eb\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u7528\u610f\u3057\u3066\u3044\u307e\u3059\u3002\n\u3053\u308c\u3092\u5b9f\u884c\u3057\u3066\u3001MNIST\u306e\u30c8\u30ec\u30fc\u30cb\u30f3\u30b0\u3068\u30c6\u30b9\u30c8\u30c7\u30fc\u30bf\u3092\u751f\u6210\u3057\u307e\u3059\u3002\ncd /opt/TensorFlowOnSpark/\nsh ./mnist_data_setup.sh\n\n\n/opt/TensorFlowOnSpark/\u914d\u4e0b\u306bpyspark\u306e\u8d77\u52d5\u7528\u30b7\u30a7\u30eb\u30b9\u30af\u30ea\u30d7\u30c8\u3068\u3057\u3066pyspark_notebook.sh\u3092\u914d\u7f6e\u3057\u3066\u3044\u307e\u3059\u3002\n\u3053\u308c\u3092\u5b9f\u884c\u3059\u308b\u3068\u3001pyspark\u304cJupyter Notebook\u3067\u8d77\u52d5\u3057\u307e\u3059\u3002\ncd /opt/TensorFlowOnSpark/\nsh ./pyspark_notebook.sh\n\n\n\n\u8d77\u52d5\u3067\u304d\u307e\u3057\u305f\u3002\n\u30d6\u30e9\u30a6\u30b6\u3067\u3000http://<\u30db\u30b9\u30c8OS\u306eIP\u30a2\u30c9\u30ec\u30b9>:8889\u3000\u306b\u30a2\u30af\u30bb\u30b9\u3057\u307e\u3059\u3002\n\n\u3053\u306e\u3088\u3046\u306b\u3001Jupyter Notebook\u306b\u30a2\u30af\u30bb\u30b9\u3067\u304d\u307e\u3059\u3002\n\n\u6700\u5f8c\u306b\u30fb\u30fb\u30fb\u3067\u304d\u306a\u304b\u3063\u305f\u3053\u3068\uff08\u8ab0\u304b\u6559\u3048\u3066\u304f\u3060\u3055\u3044m(_ _)m\uff09\u3000\u2192\u3000\u89e3\u6c7a\u3057\u307e\u3057\u305f\u3002\n\u3053\u3053\u3067MNIST\u306e\u30c7\u30e2\u7528\u306b\u7528\u610f\u3055\u308c\u3066\u3044\u308b\u3000TFOS_spark_demo.ipynb\u3000\u3092\u5b9f\u884c\u3057\u305f\u3044\u306e\u3067\u3059\u304c\u3001com.yahoo.ml.tf\u3000\u304c\u30a4\u30f3\u30dd\u30fc\u30c8\u3067\u304d\u306a\u304f\u3066\u30a8\u30e9\u30fc\u306b\u306a\u308a\u307e\u3059\u3002\n(T_T)\n\u30b0\u30b0\u3063\u3066\u3082\u60c5\u5831\u304c\u51fa\u3066\u304d\u307e\u305b\u3093\u3057\u3001\u3069\u306a\u305f\u304b\u89e3\u6c7a\u7b56\u3092\u3054\u5b58\u3058\u306a\u3044\u3067\u3057\u3087\u3046\u304b\u30fb\u30fb\u30fb\uff1f\n\u306a\u3093\u304b\u534a\u716e\u3048\u306a\u7d42\u308f\u308a\u65b9\u3067\u3059\u304c\u3001\u3072\u3068\u307e\u305aTensorFlowOnSparkOnDocker\u3092\u69cb\u7bc9\u3067\u304d\u307e\u3057\u305f\uff08\uff1f\uff09\u3002\n\u89e3\u6c7a\u3057\u307e\u3057\u305f\u3002\nPYTHONPATH\u306e\u6307\u5b9a\u304c\u8db3\u308a\u306a\u304b\u3063\u305f\u3088\u3046\u3067\u3059\u3002\nDockerfile\u306b ENV PYTHONPATH=/opt/TensorFlowOnSpark/src \u8ffd\u52a0\u3057\u307e\u3057\u305f\u3002\n\u3053\u308c\u3067MNIST\u306e\u30c7\u30e2\uff20Jupyter Notebook\u3082\u6210\u529f\u3057\u307e\u3059\u3002\n\n# TensorFlowOnSpark\u3092Docker run\u3057\u3066\u307f\u305f\n\nTensorFlowOnSpark\u306e\u30b9\u30bf\u30f3\u30c9\u30a2\u30ed\u30fc\u30f3\u7248\u3092Docker\u30a4\u30e1\u30fc\u30b8\u306b\u3057\u3066\u307f\u307e\u3057\u305f\u3002\n\nTensorFlowOnSpark\u306fTensorFlow\u3092Spark\u4e0a\u3067\u7a3c\u50cd\u3055\u305b\u3089\u308c\u308b\u3088\u3046\u306b\u3057\u305f\u3082\u306e\u3067\u3001Yahoo\u304c\u5148\u9031\u304f\u3089\u3044\u306b\u767a\u8868\u3057\u3066\u3044\u307e\u3057\u305f\uff082017/02/13\uff09\u3002\nhttps://github.com/yahoo/TensorFlowOnSpark/wiki\n\n\u51fa\u305f\u5f53\u65e5\u306b\u30b9\u30bf\u30f3\u30c9\u30a2\u30ed\u30fc\u30f3\u7248\u306e\u69cb\u7bc9\u3092\u8a66\u3057\u3066\u307f\u307e\u3057\u305f\u3002\nhttp://qiita.com/cvusk/items/39a1861715e21b1dc191\n\u3064\u3044\u3067\u306bDockerfile\u306b\u3057\u307e\u3057\u305f\u306e\u304c\u4eca\u56de\u3067\u3059\u3002\n\u7df4\u7fd2\u304c\u3066\u3089\u3002\n\n\n## TensorFlowOnSpark on Docker\n\u30db\u30b9\u30c8OS\u306b\u306fCentOS7.3\u3092\u4f7f\u3063\u3066\u3044\u307e\u3059\u3002\nDocker\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3001\u8d77\u52d5\u4ee5\u5916\u306f\u4ee5\u4e0b\u306e\u3068\u304a\u308a\u3067\u3059\u3002\n\n\n```\nsudo yum -y install docker\nsudo systemctl start docker\nsudo systemctl enable docker\n\n```\n\nDockerfile\u3092\u4f5c\u308b\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092\u7528\u610f\u3057\u307e\u3059\u3002\n\n\n```\n\nsudo su -\nmkdir -p /opt/tfos\ncd /opt/tfos\n\n```\n\n\n\u4eca\u56de\u306fUbuntu\u30a4\u30e1\u30fc\u30b8\u3092\u4f7f\u3044\u307e\u3059\u3002\nhttps://hub.docker.com/_/ubuntu/\n\u4e8b\u524d\u306bpull\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n\n```\ndocker pull ubuntu\n\n```\n\n## Dockerfile\u3092\u4f5c\u308b\n/opt/tfos/\u914d\u4e0b\u306bDockerfile\u3092\u4f5c\u6210\u3057\u3001\u4ee5\u4e0b\u3092\u8a18\u5165\u3057\u3066\u4fdd\u5b58\u3057\u307e\u3059\u3002\n\uff082017/02/23\u3000\u4fee\u6b63\u3057\u307e\u3057\u305f\u3002\uff09\n\n\n```\nFROM ubuntu\nMAINTAINER cvusk\n\n# insert hostname on environmental variable\nENV HOSTNAME tensorflow.spark\n\n# install prerequisites\nRUN apt-get -y update\nRUN apt-get -y upgrade\nRUN apt-get -y install apt-utils\nRUN apt-get -y install software-properties-common python-software-properties\nRUN add-apt-repository ppa:openjdk-r/ppa\nRUN apt-get -y update\nRUN apt-get -y install wget curl zip unzip vim openjdk-7-jre openjdk-7-jdk git python-pip python-dev python-virtualenv\nENV JAVA_HOME=/usr/lib/jvm/java-7-openjdk-amd64\n\n# git clone tensorflowonspark.git\nWORKDIR /opt/\nRUN git clone --recurse-submodules https://github.com/yahoo/TensorFlowOnSpark.git\n\nWORKDIR /opt/TensorFlowOnSpark/\nRUN git submodule init\nRUN git submodule update --force\nRUN git submodule foreach --recursive git clean -dfx\n\n# environmental variable for tensorflowonspark home\nENV TFoS_HOME=/opt/TensorFlowOnSpark\n\nWORKDIR /opt/TensorFlowOnSpark/src/\nRUN zip -r /opt/TensorFlowOnSpark/tfspark.zip /opt/TensorFlowOnSpark/src/*\nWORKDIR /opt/TensorFlowOnSpark/\n\n# setup spark\nRUN sh /opt/TensorFlowOnSpark/scripts/local-setup-spark.sh\nENV SPARK_HOME=/opt/TensorFlowOnSpark/spark-1.6.0-bin-hadoop2.6\nENV PATH=/opt/TensorFlowOnSpark/src:${PATH}\nENV PATH=${SPARK_HOME}/bin:${PATH}\nENV PYTHONPATH=/opt/TensorFlowOnSpark/src\n\n\n# install tensorflow, jupyter and py4j\nRUN pip install pip --upgrade\nRUN python -m pip install tensorflow\nRUN pip install jupyter jupyter[notebook]\nRUN pip install py4j\n\n\n# download mnist data\nRUN mkdir /opt/TensorFlowOnSpark/mnist\nWORKDIR /opt/TensorFlowOnSpark/mnist/\nRUN curl -O \"http://yann.lecun.com/exdb/mnist/train-images-idx3-ubyte.gz\"\nRUN curl -O \"http://yann.lecun.com/exdb/mnist/train-labels-idx1-ubyte.gz\"\nRUN curl -O \"http://yann.lecun.com/exdb/mnist/t10k-images-idx3-ubyte.gz\"\nRUN curl -O \"http://yann.lecun.com/exdb/mnist/t10k-labels-idx1-ubyte.gz\"\n\n\n# create shellscript for starting spark standalone cluster\nRUN echo '${SPARK_HOME}/sbin/start-master.sh' >> ${TFoS_HOME}/spark_cluster.sh\nRUN echo 'MASTER=spark://${HOSTNAME}:7077' >> ${TFoS_HOME}/spark_cluster.sh\nRUN echo 'SPARK_WORKER_INSTANCES=2' >> ${TFoS_HOME}/spark_cluster.sh\nRUN echo 'CORES_PER_WORKER=1' >> ${TFoS_HOME}/spark_cluster.sh\nRUN echo 'TOTAL_CORES=$((${CORES_PER_WORKER}*${SPARK_WORKER_INSTANCES}))' >> ${TFoS_HOME}/spark_cluster.sh\nRUN echo '${SPARK_HOME}/sbin/start-slave.sh -c $CORES_PER_WORKER -m 3G ${MASTER}' >> ${TFoS_HOME}/spark_cluster.sh\nRUN echo '${SPARK_HOME}/sbin/start-slave.sh -c $CORES_PER_WORKER -m 3G ${MASTER}' >> ${TFoS_HOME}/spark_cluster.sh\n\n\nENV MASTER=spark://${HOSTNAME}:7077\nENV SPARK_WORKER_INSTANCES=2\nENV CORES_PER_WORKER=1\nENV TOTAL_CORES=2\n\n\n# create shellscript for pyspark on jupyter and mnist data\nWORKDIR /opt/TensorFlowOnSpark/\n\nRUN echo \"PYSPARK_DRIVER_PYTHON=\\\"jupyter\\\" PYSPARK_DRIVER_PYTHON_OPTS=\\\"notebook --no-browser --ip=* --NotebookApp.token=''\\\" pyspark  --master ${MASTER} --conf spark.cores.max=${TOTAL_CORES} --conf spark.task.cpus=${CORES_PER_WORKER} --py-files ${TFoS_HOME}/tfspark.zip,${TFoS_HOME}/examples/mnist/spark/mnist_dist.py --conf spark.executorEnv.JAVA_HOME=\\\"$JAVA_HOME\\\"\" > ${TFoS_HOME}/pyspark_notebook.sh\n\nRUN echo \"${SPARK_HOME}/bin/spark-submit --master ${MASTER} ${TFoS_HOME}/examples/mnist/mnist_data_setup.py --output examples/mnist/csv --format csv\" > ${TFoS_HOME}/mnist_data_setup.sh\n\n\n```\n\n\n\u3084\u3063\u3066\u3044\u308b\u3053\u3068\u3068\u3057\u3066\u3001TensorFlowOnSpark\u30b9\u30bf\u30f3\u30c9\u30a2\u30ed\u30fc\u30f3\u7248\u306e\u69cb\u7bc9\u624b\u9806\u3092Docker\u7528\u306b\u66f8\u304d\u63db\u3048\u3066\u3044\u307e\u3059\u3002\nhttps://github.com/yahoo/TensorFlowOnSpark/wiki/GetStarted_standalone\n\nspark master\u3001slave\u306e\u8d77\u52d5\u3092\u30b7\u30a7\u30eb\u30b9\u30af\u30ea\u30d7\u30c8\u306b\u3057\u3066\u304a\u304d\u305f\u304b\u3063\u305f\u306e\u3067\u3001\u305d\u306e\u5909\u6570\u306e\u305f\u3081\u306b\u74b0\u5883\u5909\u6570\u306bHOSTNAME=tensorflow.spark\u3092\u5b9a\u7fa9\u3057\u3066\u3044\u307e\u3059\u3002\n\u3082\u3046\u3061\u3087\u3044\u304b\u3063\u3053\u3044\u3044\u65b9\u6cd5\u3067\u30db\u30b9\u30c8\u540d\u3092\u4f7f\u3044\u305f\u3044\u306e\u3067\u3059\u304c\u30fb\u30fb\u30fb\u3002\n\n\n\u3053\u308c\u3092\u30d3\u30eb\u30c9\u3057\u307e\u3059\u3002\n\n```\ncd /opt/tfos\ndocker build -t tfos/tfos .\n\n```\n\n\u3053\u3093\u306a\u611f\u3058\u306b\u3067\u304d\u3042\u304c\u308a\u307e\u3059\u3002\n\n```\ndocker images\n\n```\n\n![2017-02-22.PNG](https://qiita-image-store.s3.amazonaws.com/0/55384/c7de4532-52af-3e01-7d81-3a96180a0b28.png)\n\n\n\n## \u52d5\u304b\u3057\u3066\u307f\u307e\u3059\nDocker\u30a4\u30e1\u30fc\u30b8\u304c\u3067\u304d\u3042\u304c\u3063\u305f\u3089\u4ee5\u4e0b\u3067run\u3057\u307e\u3059\u3002\n\n```\ndocker run -it -p 8889:8888 -h tensorflow.spark 5db5add35c10 /bin/bash\n\n```\n\n\u30dd\u30fc\u30c8\u756a\u53f7\u306f8889:8888\uff08\u30db\u30b9\u30c8OS\u306e\u30dd\u30fc\u30c8\uff1a\u30b3\u30f3\u30c6\u30ca\u306e\u30dd\u30fc\u30c8\uff09\u3067\u516c\u958b\u3057\u307e\u3059\u3002\u3053\u308c\u306fpyspark\uff08Jupyter Notebook\uff09\u7528\u3067\u3059\u3002\n\u30db\u30b9\u30c8\u540d\u306btensorflow.spark\u3092\u6307\u5b9a\u3057\u307e\u3059\u304c\u3001\u3053\u308c\u306fDockerfile\u306b\u66f8\u3044\u305f\u3082\u306e\u3092\u4f7f\u3063\u3066\u3044\u307e\u3059\u3002\n\n\n![2017-02-22_3.PNG](https://qiita-image-store.s3.amazonaws.com/0/55384/75c73d42-0202-4853-8c07-b6333c14f823.png)\n\n\n\n\u306f\u3044\u3001\u8d77\u52d5\u3057\u307e\u3057\u305f\u3002\n\n/opt/TensorFlowOnSpark\u914d\u4e0b\u306espark_cluster.sh\u3092\u5b9f\u884c\u3059\u308b\u3068\u3001\u3053\u306eDocker\u30b3\u30f3\u30c6\u30ca\u304cspark master\u517cslave\u306b\u306a\u308a\u307e\u3059\u3002\n\u306a\u304a\u3001slave\u306f\uff12\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u8d77\u52d5\u3057\u3066\u3044\u307e\u3059\u3002\n\n\n```\ncd /opt/TensorFlowOnSpark\nsh ./spark_cluster.sh\n\n```\n\n![2017-02-22_4.PNG](https://qiita-image-store.s3.amazonaws.com/0/55384/43f5abf2-91e4-9fe4-7ec6-411d2cf30f73.png)\n\n\n/opt/TensorFlowOnSpark/\u914d\u4e0b\u306bMNIST\u306e\u30c7\u30fc\u30bf\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\u7528\u30b7\u30a7\u30eb\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u7528\u610f\u3057\u3066\u3044\u307e\u3059\u3002\n\u3053\u308c\u3092\u5b9f\u884c\u3057\u3066\u3001MNIST\u306e\u30c8\u30ec\u30fc\u30cb\u30f3\u30b0\u3068\u30c6\u30b9\u30c8\u30c7\u30fc\u30bf\u3092\u751f\u6210\u3057\u307e\u3059\u3002\n\n```\ncd /opt/TensorFlowOnSpark/\nsh ./mnist_data_setup.sh\n\n```\n\n\n/opt/TensorFlowOnSpark/\u914d\u4e0b\u306bpyspark\u306e\u8d77\u52d5\u7528\u30b7\u30a7\u30eb\u30b9\u30af\u30ea\u30d7\u30c8\u3068\u3057\u3066pyspark_notebook.sh\u3092\u914d\u7f6e\u3057\u3066\u3044\u307e\u3059\u3002\n\n\u3053\u308c\u3092\u5b9f\u884c\u3059\u308b\u3068\u3001pyspark\u304cJupyter Notebook\u3067\u8d77\u52d5\u3057\u307e\u3059\u3002\n\n\n```\ncd /opt/TensorFlowOnSpark/\nsh ./pyspark_notebook.sh\n\n```\n\n![2017-02-22_5.PNG](https://qiita-image-store.s3.amazonaws.com/0/55384/40427d08-cf65-2e0b-a870-bb4eeadac8d9.png)\n\n\n\n\u8d77\u52d5\u3067\u304d\u307e\u3057\u305f\u3002\n\u30d6\u30e9\u30a6\u30b6\u3067\u3000http://<\u30db\u30b9\u30c8OS\u306eIP\u30a2\u30c9\u30ec\u30b9>:8889\u3000\u306b\u30a2\u30af\u30bb\u30b9\u3057\u307e\u3059\u3002\n\n\n![2017-02-22_6.PNG](https://qiita-image-store.s3.amazonaws.com/0/55384/01d78640-3871-3f25-9f21-4ac9dfbe64ca.png)\n\n\n\n\u3053\u306e\u3088\u3046\u306b\u3001Jupyter Notebook\u306b\u30a2\u30af\u30bb\u30b9\u3067\u304d\u307e\u3059\u3002\n\n## \u6700\u5f8c\u306b\u30fb\u30fb\u30fb\u3067\u304d\u306a\u304b\u3063\u305f\u3053\u3068\uff08\u8ab0\u304b\u6559\u3048\u3066\u304f\u3060\u3055\u3044m(_ _)m\uff09\u3000\u2192\u3000\u89e3\u6c7a\u3057\u307e\u3057\u305f\u3002\n\n~~\u3053\u3053\u3067MNIST\u306e\u30c7\u30e2\u7528\u306b\u7528\u610f\u3055\u308c\u3066\u3044\u308b\u3000TFOS_spark_demo.ipynb\u3000\u3092\u5b9f\u884c\u3057\u305f\u3044\u306e\u3067\u3059\u304c\u3001com.yahoo.ml.tf\u3000\u304c\u30a4\u30f3\u30dd\u30fc\u30c8\u3067\u304d\u306a\u304f\u3066\u30a8\u30e9\u30fc\u306b\u306a\u308a\u307e\u3059\u3002~~\n~~(T_T)~~\n\n\n~~\u30b0\u30b0\u3063\u3066\u3082\u60c5\u5831\u304c\u51fa\u3066\u304d\u307e\u305b\u3093\u3057\u3001\u3069\u306a\u305f\u304b\u89e3\u6c7a\u7b56\u3092\u3054\u5b58\u3058\u306a\u3044\u3067\u3057\u3087\u3046\u304b\u30fb\u30fb\u30fb\uff1f\n\u306a\u3093\u304b\u534a\u716e\u3048\u306a\u7d42\u308f\u308a\u65b9\u3067\u3059\u304c\u3001\u3072\u3068\u307e\u305aTensorFlowOnSparkOnDocker\u3092\u69cb\u7bc9\u3067\u304d\u307e\u3057\u305f\uff08\uff1f\uff09\u3002~~\n\n\n\u89e3\u6c7a\u3057\u307e\u3057\u305f\u3002\nPYTHONPATH\u306e\u6307\u5b9a\u304c\u8db3\u308a\u306a\u304b\u3063\u305f\u3088\u3046\u3067\u3059\u3002\nDockerfile\u306b ENV PYTHONPATH=/opt/TensorFlowOnSpark/src \u8ffd\u52a0\u3057\u307e\u3057\u305f\u3002\n\n\u3053\u308c\u3067MNIST\u306e\u30c7\u30e2\uff20Jupyter Notebook\u3082\u6210\u529f\u3057\u307e\u3059\u3002\n\n![2017-02-22_8.PNG](https://qiita-image-store.s3.amazonaws.com/0/55384/e2e95fe9-b6d9-c166-a653-2153f0c687df.png)\n", "tags": ["TensorFlow", "Spark", "docker", "Ubuntu", "Jupyter"]}