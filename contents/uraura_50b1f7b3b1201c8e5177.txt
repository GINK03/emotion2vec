{"tags": ["CoreOS", "nfs", "Mac", "OSX", "xhyve"], "context": " More than 1 year has passed since last update.coreos-xhyve\u3092\u4f7f\u3044\u307e\u3059\n\u524d\u56de\u306f\u30c7\u30a3\u30b9\u30af\u30a4\u30e1\u30fc\u30b8\u3092\u30d5\u30a1\u30a4\u30eb\u3068\u3057\u3066\u4f5c\u6210\u3057\u3066\u3044\u305f\u306e\u3067\u3059\u304c\uff0c\n\n\u4f7f\u3044\u305f\u3044\u5bb9\u91cf\u306e\u5206\u3060\u3051\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u3063\u3066\u304a\u304b\u306a\u3051\u308c\u3070\u306a\u3089\u306a\u3044\n\u30d5\u30a1\u30a4\u30eb\u304c\u30c7\u30ab\u3044\u306e\u3067\u53d6\u308a\u56de\u3057\u304c\u60aa\u3044\n\u8907\u6570\u306e\u30c7\u30a3\u30b9\u30af\u4ed8\u3051\u3088\u3046\u3068\u601d\u3063\u305f\u3089\u8d77\u52d5\u30b7\u30a7\u30eb\u3092\u7de8\u96c6\u3057\u306a\u3051\u308c\u3070\u306a\u3089\u306a\u3044\n\n\u3068\u304b\uff0c\u3044\u308d\u3044\u308d\u4e0d\u90fd\u5408\u3060\u3063\u305f\u306e\u3067NFS\u3067\u30de\u30a6\u30f3\u30c8\u3057\u3066\u3084\u308b\u3053\u3068\u306b\u3057\u307e\u3059\uff0e\n\nMac(\u30db\u30b9\u30c8)\u5074\nNFS\u30b5\u30fc\u30d0\u3092\u8d77\u52d5\u3057\u3066\u304a\u3044\u3066\u3084\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\uff0e\n\n/etc/exports \u3092\u4f5c\u6210\n\n/etc/exports\n/Volumes/docker -maproot=root -network 192.168.64.0 -mask 255.255.255.0\n\n\n\u3042\u308f\u305b\u3066\u30de\u30a6\u30f3\u30c8\u30dd\u30a4\u30f3\u30c8\u3092\u4f5c\u6210\nmkdir /Volumes/docker\n\nsudo chown root:wheel /Volumes/docker\n\nowner/group\u3092\u9593\u9055\u3048\u308b\u3068\u30b3\u30f3\u30c6\u30ca\u304c\u8d77\u52d5\u3057\u306a\u304b\u3063\u305f\uff0e\n\nnfsd \u3092\u8d77\u52d5\n/etc/exports\u3092\u4f5c\u6210\u3057\u305f\u6642\u70b9\u3067\u52dd\u624b\u306bnfsd\u304c\u8d77\u52d5\u3059\u308b\u3088\u3046\u3067\u3059\uff0e\n\u306a\u306e\u3067\uff0c\u8a2d\u5b9a\u306e\u78ba\u8a8d\u3060\u3051\uff0e\nuraura@rosemary$ nfsd status\nnfsd service is enabled\nnfsd is running (pid 9994, 8 threads)\n\nuraura@rosemary$  showmount -a -e\nAll mounts on localhost:\nExports list on localhost:\n/Volumes/docker                     192.168.64.0\n\n\u8a2d\u5b9a\u304c\u304a\u304b\u3057\u3044\u3068\u304d\u306f/etc/exports\u3092\u898b\u76f4\u3059\u304b\uff0cnfsd\u3092\u518d\u8d77\u52d5\u306a\u3069\n\n\u8a2d\u5b9a\u3092\u30ea\u30ed\u30fc\u30c9\nsudo nfsd update\n\n\n\nnfsd\u3092\u518d\u8d77\u52d5\nsudo nfsd restart\n\n\n\nCoreOS\u306ecloud-init\u3092\u4f5c\u6210\nhttps://gist.github.com/mystelynx/5a1f973bc75af52a8d15\n\u524d\u56de\u3068\u306e\u5dee\u5206\u306f\u4e0b\u8a18\n        [Mount]\n-        What=/dev/vda\n+        What=192.168.64.1:/Volumes/docker\n         Where=/var/lib/docker\n-        Type=ext4\n+        Type=nfs\n+        Options=nolock\n\n\nVM\u8d77\u52d5\nsudo ./coreos-xhyve-run -f custom.conf\n\n\n\u78ba\u8a8d\n\nCoreOS\u4e0a\u3067\u78ba\u8a8d\ncore@localhost ~ $ df -h\nFilesystem                    Size  Used Avail Use% Mounted on\ndevtmpfs                      892M     0  892M   0% /dev\ntmpfs                        1003M     0 1003M   0% /dev/shm\ntmpfs                        1003M   17M  987M   2% /run\ntmpfs                        1003M     0 1003M   0% /sys/fs/cgroup\ntmpfs                        1003M  6.8M  997M   1% /\n/dev/loop0                    195M  195M     0 100% /usr\ntmpfs                        1003M     0 1003M   0% /tmp\ntmpfs                        1003M     0 1003M   0% /media\n192.168.64.1:/Volumes/docker  465G  224G  242G  49% /var/lib/docker\n\ncore@localhost ~ $ mount\nsysfs on /sys type sysfs (rw,nosuid,nodev,noexec,relatime,seclabel)\nproc on /proc type proc (rw,nosuid,nodev,noexec,relatime)\ndevtmpfs on /dev type devtmpfs (rw,nosuid,seclabel,size=912768k,nr_inodes=228192,mode=755)\nsecurityfs on /sys/kernel/security type securityfs (rw,nosuid,nodev,noexec,relatime)\ntmpfs on /dev/shm type tmpfs (rw,nosuid,nodev,seclabel)\ndevpts on /dev/pts type devpts (rw,nosuid,noexec,relatime,seclabel,gid=5,mode=620,ptmxmode=000)\ntmpfs on /run type tmpfs (rw,nosuid,nodev,seclabel,mode=755)\ntmpfs on /sys/fs/cgroup type tmpfs (ro,nosuid,nodev,noexec,seclabel,mode=755)\ncgroup on /sys/fs/cgroup/systemd type cgroup (rw,nosuid,nodev,noexec,relatime,xattr,release_agent=/usr/lib/systemd/systemd-cgroups-agent,name=systemd)\npstore on /sys/fs/pstore type pstore (rw,nosuid,nodev,noexec,relatime,seclabel)\ncgroup on /sys/fs/cgroup/devices type cgroup (rw,nosuid,nodev,noexec,relatime,devices)\ncgroup on /sys/fs/cgroup/cpu,cpuacct type cgroup (rw,nosuid,nodev,noexec,relatime,cpu,cpuacct)\ncgroup on /sys/fs/cgroup/net_cls,net_prio type cgroup (rw,nosuid,nodev,noexec,relatime,net_cls,net_prio)\ncgroup on /sys/fs/cgroup/perf_event type cgroup (rw,nosuid,nodev,noexec,relatime,perf_event)\ncgroup on /sys/fs/cgroup/blkio type cgroup (rw,nosuid,nodev,noexec,relatime,blkio)\ncgroup on /sys/fs/cgroup/memory type cgroup (rw,nosuid,nodev,noexec,relatime,memory)\ncgroup on /sys/fs/cgroup/cpuset type cgroup (rw,nosuid,nodev,noexec,relatime,cpuset)\ncgroup on /sys/fs/cgroup/freezer type cgroup (rw,nosuid,nodev,noexec,relatime,freezer)\ntmpfs on / type tmpfs (rw,relatime,seclabel)\n/usr.squashfs (deleted) on /usr type squashfs (ro,relatime)\nselinuxfs on /sys/fs/selinux type selinuxfs (rw,relatime)\ntmpfs on /tmp type tmpfs (rw,seclabel)\nmqueue on /dev/mqueue type mqueue (rw,relatime,seclabel)\ndebugfs on /sys/kernel/debug type debugfs (rw,relatime,seclabel)\nhugetlbfs on /dev/hugepages type hugetlbfs (rw,relatime,seclabel)\ntmpfs on /media type tmpfs (rw,nosuid,nodev,noexec,relatime,seclabel)\n192.168.64.1:/Volumes/docker on /var/lib/docker type nfs (rw,relatime,vers=3,rsize=65536,wsize=65536,namlen=255,hard,nolock,proto=tcp,timeo=600,retrans=2,sec=sys,mountaddr=192.168.64.1,mountvers=3,mountport=820,mountproto=udp,local_lock=all,addr=192.168.64.1)\n\n\nMac\u5074\u3067\u78ba\u8a8d\nuraura@rosemary$ showmount -a -e\nAll mounts on localhost:\n192.168.64.39:/Volumes/docker\nExports list on localhost:\n/Volumes/docker                     192.168.64.0\n\ncoreos-xhyve\u3092\u4f7f\u3044\u307e\u3059\n\n[\u524d\u56de](http://qiita.com/uraura/items/ea1fc61cad4efd7fb9c1)\u306f\u30c7\u30a3\u30b9\u30af\u30a4\u30e1\u30fc\u30b8\u3092\u30d5\u30a1\u30a4\u30eb\u3068\u3057\u3066\u4f5c\u6210\u3057\u3066\u3044\u305f\u306e\u3067\u3059\u304c\uff0c\n\n- \u4f7f\u3044\u305f\u3044\u5bb9\u91cf\u306e\u5206\u3060\u3051\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u3063\u3066\u304a\u304b\u306a\u3051\u308c\u3070\u306a\u3089\u306a\u3044\n- \u30d5\u30a1\u30a4\u30eb\u304c\u30c7\u30ab\u3044\u306e\u3067\u53d6\u308a\u56de\u3057\u304c\u60aa\u3044\n- \u8907\u6570\u306e\u30c7\u30a3\u30b9\u30af\u4ed8\u3051\u3088\u3046\u3068\u601d\u3063\u305f\u3089\u8d77\u52d5\u30b7\u30a7\u30eb\u3092\u7de8\u96c6\u3057\u306a\u3051\u308c\u3070\u306a\u3089\u306a\u3044\n\n\u3068\u304b\uff0c\u3044\u308d\u3044\u308d\u4e0d\u90fd\u5408\u3060\u3063\u305f\u306e\u3067NFS\u3067\u30de\u30a6\u30f3\u30c8\u3057\u3066\u3084\u308b\u3053\u3068\u306b\u3057\u307e\u3059\uff0e\n\n# Mac(\u30db\u30b9\u30c8)\u5074\nNFS\u30b5\u30fc\u30d0\u3092\u8d77\u52d5\u3057\u3066\u304a\u3044\u3066\u3084\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\uff0e\n\n## /etc/exports \u3092\u4f5c\u6210\n```:/etc/exports\n/Volumes/docker -maproot=root -network 192.168.64.0 -mask 255.255.255.0\n```\n\u3042\u308f\u305b\u3066\u30de\u30a6\u30f3\u30c8\u30dd\u30a4\u30f3\u30c8\u3092\u4f5c\u6210\n\n```bash\nmkdir /Volumes/docker\n\nsudo chown root:wheel /Volumes/docker\n```\n\nowner/group\u3092\u9593\u9055\u3048\u308b\u3068\u30b3\u30f3\u30c6\u30ca\u304c\u8d77\u52d5\u3057\u306a\u304b\u3063\u305f\uff0e\n\n## nfsd \u3092\u8d77\u52d5\n`/etc/exports`\u3092\u4f5c\u6210\u3057\u305f\u6642\u70b9\u3067\u52dd\u624b\u306b`nfsd`\u304c\u8d77\u52d5\u3059\u308b\u3088\u3046\u3067\u3059\uff0e\n\u306a\u306e\u3067\uff0c\u8a2d\u5b9a\u306e\u78ba\u8a8d\u3060\u3051\uff0e\n\n```shell-session\nuraura@rosemary$ nfsd status\nnfsd service is enabled\nnfsd is running (pid 9994, 8 threads)\n\nuraura@rosemary$  showmount -a -e\nAll mounts on localhost:\nExports list on localhost:\n/Volumes/docker                     192.168.64.0\n```\n\n\u8a2d\u5b9a\u304c\u304a\u304b\u3057\u3044\u3068\u304d\u306f`/etc/exports`\u3092\u898b\u76f4\u3059\u304b\uff0c`nfsd`\u3092\u518d\u8d77\u52d5\u306a\u3069\n\n```bash:\u8a2d\u5b9a\u3092\u30ea\u30ed\u30fc\u30c9\nsudo nfsd update\n```\n\n```bash:nfsd\u3092\u518d\u8d77\u52d5\nsudo nfsd restart\n```\n\n# CoreOS\u306ecloud-init\u3092\u4f5c\u6210\n\nhttps://gist.github.com/mystelynx/5a1f973bc75af52a8d15\n\n\u524d\u56de\u3068\u306e\u5dee\u5206\u306f\u4e0b\u8a18\n\n```diff\n        [Mount]\n-        What=/dev/vda\n+        What=192.168.64.1:/Volumes/docker\n         Where=/var/lib/docker\n-        Type=ext4\n+        Type=nfs\n+        Options=nolock\n```\n\n# VM\u8d77\u52d5\n```bash\nsudo ./coreos-xhyve-run -f custom.conf\n```\n\n# \u78ba\u8a8d\n## CoreOS\u4e0a\u3067\u78ba\u8a8d\n```shell-session\ncore@localhost ~ $ df -h\nFilesystem                    Size  Used Avail Use% Mounted on\ndevtmpfs                      892M     0  892M   0% /dev\ntmpfs                        1003M     0 1003M   0% /dev/shm\ntmpfs                        1003M   17M  987M   2% /run\ntmpfs                        1003M     0 1003M   0% /sys/fs/cgroup\ntmpfs                        1003M  6.8M  997M   1% /\n/dev/loop0                    195M  195M     0 100% /usr\ntmpfs                        1003M     0 1003M   0% /tmp\ntmpfs                        1003M     0 1003M   0% /media\n192.168.64.1:/Volumes/docker  465G  224G  242G  49% /var/lib/docker\n\ncore@localhost ~ $ mount\nsysfs on /sys type sysfs (rw,nosuid,nodev,noexec,relatime,seclabel)\nproc on /proc type proc (rw,nosuid,nodev,noexec,relatime)\ndevtmpfs on /dev type devtmpfs (rw,nosuid,seclabel,size=912768k,nr_inodes=228192,mode=755)\nsecurityfs on /sys/kernel/security type securityfs (rw,nosuid,nodev,noexec,relatime)\ntmpfs on /dev/shm type tmpfs (rw,nosuid,nodev,seclabel)\ndevpts on /dev/pts type devpts (rw,nosuid,noexec,relatime,seclabel,gid=5,mode=620,ptmxmode=000)\ntmpfs on /run type tmpfs (rw,nosuid,nodev,seclabel,mode=755)\ntmpfs on /sys/fs/cgroup type tmpfs (ro,nosuid,nodev,noexec,seclabel,mode=755)\ncgroup on /sys/fs/cgroup/systemd type cgroup (rw,nosuid,nodev,noexec,relatime,xattr,release_agent=/usr/lib/systemd/systemd-cgroups-agent,name=systemd)\npstore on /sys/fs/pstore type pstore (rw,nosuid,nodev,noexec,relatime,seclabel)\ncgroup on /sys/fs/cgroup/devices type cgroup (rw,nosuid,nodev,noexec,relatime,devices)\ncgroup on /sys/fs/cgroup/cpu,cpuacct type cgroup (rw,nosuid,nodev,noexec,relatime,cpu,cpuacct)\ncgroup on /sys/fs/cgroup/net_cls,net_prio type cgroup (rw,nosuid,nodev,noexec,relatime,net_cls,net_prio)\ncgroup on /sys/fs/cgroup/perf_event type cgroup (rw,nosuid,nodev,noexec,relatime,perf_event)\ncgroup on /sys/fs/cgroup/blkio type cgroup (rw,nosuid,nodev,noexec,relatime,blkio)\ncgroup on /sys/fs/cgroup/memory type cgroup (rw,nosuid,nodev,noexec,relatime,memory)\ncgroup on /sys/fs/cgroup/cpuset type cgroup (rw,nosuid,nodev,noexec,relatime,cpuset)\ncgroup on /sys/fs/cgroup/freezer type cgroup (rw,nosuid,nodev,noexec,relatime,freezer)\ntmpfs on / type tmpfs (rw,relatime,seclabel)\n/usr.squashfs (deleted) on /usr type squashfs (ro,relatime)\nselinuxfs on /sys/fs/selinux type selinuxfs (rw,relatime)\ntmpfs on /tmp type tmpfs (rw,seclabel)\nmqueue on /dev/mqueue type mqueue (rw,relatime,seclabel)\ndebugfs on /sys/kernel/debug type debugfs (rw,relatime,seclabel)\nhugetlbfs on /dev/hugepages type hugetlbfs (rw,relatime,seclabel)\ntmpfs on /media type tmpfs (rw,nosuid,nodev,noexec,relatime,seclabel)\n192.168.64.1:/Volumes/docker on /var/lib/docker type nfs (rw,relatime,vers=3,rsize=65536,wsize=65536,namlen=255,hard,nolock,proto=tcp,timeo=600,retrans=2,sec=sys,mountaddr=192.168.64.1,mountvers=3,mountport=820,mountproto=udp,local_lock=all,addr=192.168.64.1)\n```\n\n## Mac\u5074\u3067\u78ba\u8a8d\n```shell-session\nuraura@rosemary$ showmount -a -e\nAll mounts on localhost:\n192.168.64.39:/Volumes/docker\nExports list on localhost:\n/Volumes/docker                     192.168.64.0\n```\n\n"}