{"context": "\n\n\u306f\u3058\u3081\u306b\nAWS \u3068\u8a00\u3048\u3070 Lambda\u3001Lambda \u3068\u8a00\u3048\u3070 \u30b5\u30fc\u30d0\u30ec\u30b9 \u3067\u3059\u304c\u3001\u30b5\u30fc\u30d0\u30ec\u30b9\u3067\u30b5\u30fc\u30d3\u30b9\u5168\u4f53\u3092\u4f5c\u308b\u306e\u306f\u3057\u3093\u3069\u3044\u306a\u3068\u601d\u3063\u3066\u3044\u308b\u6628\u4eca\u3001\u7686\u69d8\u3044\u304b\u304c\u304a\u904e\u3054\u3057\u3067\u3059\u304b\u3002\n\u305d\u3093\u306a\u6298\u300110/04\u4ed8\u3051 AWS \u30d6\u30ed\u30b0\u3067\u4ee5\u4e0b\u306e\u8a18\u4e8b\u304c\u30dd\u30b9\u30c8\u3055\u308c\u307e\u3057\u305f\u3002\n\u300cAWS Lambda \u3068 Amazon API Gateway \u3067 Express \u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u5b9f\u884c\u300d\nhttps://aws.amazon.com/jp/blogs/news/running-express-applications-on-aws-lambda-and-amazon-api-gateway/\nLambda \u3067 Express \u304c\u52d5\u304f\u3060\u3068!? \u306a\u3093\u3066\u65e5\u3060\uff01\n\n\u624b\u9806\n\n\n\u30ed\u30fc\u30ab\u30eb\u74b0\u5883\nLambda \u306e Node \u306f 4.3.2 \u306a\u306e\u3067\u3001\u30ed\u30fc\u30ab\u30eb\u958b\u767a\u74b0\u5883\u3082\u3001\u5ff5\u306e\u305f\u3081\u3001\u5408\u308f\u305b\u3066\u304a\u304f\n$ nodebrew use v4.3.2\n$ node -v\nv4.3.2\n\n\n\n\u30b5\u30f3\u30d7\u30eb\u30b3\u30fc\u30c9\u53d6\u5f97\nGitHub \u304b\u3089\u30b5\u30f3\u30d7\u30eb\u30b3\u30fc\u30c9\u3092\u53d6\u5f97\u3059\u308b\n$ git clone https://github.com/awslabs/aws-serverless-express.git\n$ cp -r ./aws-serverless-express/example ~/projects/yourProject\n$ cd ~/projects/yourProject\n\n\n\n\u30b3\u30f3\u30d5\u30a3\u30b0\u30ec\u30fc\u30b7\u30e7\u30f3\n\u4ee5\u4e0b\u3067\u3001\u30b3\u30f3\u30d5\u30a3\u30b0\u30ec\u30fc\u30b7\u30e7\u30f3\u3092\u884c\u3046\n$ npm run config <\u30a2\u30ab\u30a6\u30f3\u30c8ID> <\u30d0\u30b1\u30c3\u30c8\u540d> ap-northeast-1\n\n\n\n\n\u30d1\u30e9\u30e1\u30fc\u30bf\n\u610f\u5473\n\n\n\n\n\u30a2\u30ab\u30a6\u30f3\u30c8ID\nAWS \u30b3\u30f3\u30bd\u30fc\u30eb\u306e \u30a2\u30ab\u30a6\u30f3\u30c8\u60c5\u5831\u3067\u8868\u793a\u3055\u308c\u3066\u3044\u308b ID\n\n\n\u30d0\u30b1\u30c3\u30c8\u540d\nS3 \u306e\u30d0\u30b1\u30c3\u30c8\u540d\u3002\u5168\u4e16\u754c\u3067\u552f\u4e00\u306e\u540d\u524d\u3067\u3042\u308b\u5fc5\u8981\u304c\u3042\u308b\u3002\u6307\u5b9a\u3057\u305f\u30d0\u30b1\u30c3\u30c8\u304c\u5b58\u5728\u3057\u3066\u3044\u306a\u3044\u306a\u3089\u3001\u81ea\u52d5\u3067\u4f5c\u6210\u3057\u3066\u304f\u308c\u308b\u3002Lambda \u306b\u30b3\u30fc\u30c9\u4e00\u5f0f\u3092\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3059\u308b\u305f\u3081\u306b\u4f7f\u7528\u3055\u308c\u308b\u3060\u3051\u3002\n\n\n\n\n\n\n\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\n\u305f\u3063\u305f\u3001\u3053\u308c\u3060\u3051\u3002\n$ npm run setup\n\n\n\n\u52d5\u4f5c\u78ba\u8a8d\nCloudFormation \u304c CREATE_COMPLETE \u306b\u306a\u308c\u3070\u3001\u6210\u529f\u3002\nOutputs \u30bf\u30d6\u306b\u3001\u4f5c\u6210\u3055\u308c\u305f\u753b\u9762\u3078\u306e\u30ea\u30f3\u30af\u304c\u3001\u8868\u793a\u3055\u308c\u3066\u3044\u308b\u3002\n\n\nApiUrl\n\u30b5\u30f3\u30d7\u30eb users \u306e RESTful API \u304c\u8868\u793a\u3055\u308c\u3066\u3044\u308b\u3002\n\u52d5\u304f\u3001\u52d5\u304f\u3088\uff01\n\n\nAPIGateway\n\n\nLambda\n\u3053\u306e\u3088\u3046\u306a Lambda \u95a2\u6570\u304c\u751f\u6210\u3055\u308c\u308b\u3002\u3053\u308c\u81ea\u4f53\u306f\u3001\u305f\u3063\u305f4\u884c\u3002\u3053\u306e Lambda \u95a2\u6570\u3092\u3044\u3058\u308b\u3053\u3068\u306f\u306a\u3044\u3002\n\n\n\n\n\n\n\u30ab\u30b9\u30bf\u30de\u30a4\u30ba\n\n\u30ab\u30b9\u30bf\u30de\u30a4\u30ba\napp.js \u3092\u30ab\u30b9\u30bf\u30de\u30a4\u30ba\u3057\u3066\u3044\u3051\u3070\u3088\u3044\u3002\n\u3053\u3053\u306f\u3001\u4eca\u307e\u3067\u901a\u308a\u306e\u3001\u666e\u901a\u306e Node + Express \u3060\u3002\n\n\u53cd\u6620\n\u6b21\u306e\u30b3\u30de\u30f3\u30c9\u3067\u3001AWS\u306b\u53cd\u6620\u3067\u304d\u308b\u3002\u3053\u308c\u3060\u3051\u3060\u3002\u306a\u3093\u3066\u65e5\u3060\uff01\n$ npm run package-upload-update-function\n\n\n\n\n\u30ed\u30fc\u30ab\u30eb \u30c6\u30b9\u30c8\n70\u884c\u76ee\u4ed8\u8fd1\u3092\u4fee\u6b63\u3057\u3066\u3001\u30ed\u30fc\u30ab\u30eb\u306e node \u3067\u8d77\u52d5\u3057\u3066\u30c6\u30b9\u30c8\u3067\u304d\u308b\u3088\u3046\u306b\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n\n\n\u30b3\u30fc\u30c9\u4fee\u6b63\n// The aws-serverless-express library creates a server and listens on a Unix\n// Domain Socket for you, so you can remove the usual call to app.listen.\n//app.listen(3000)\nprocess.env.PORT && app.listen(process.env.PORT)\n\n\n\n\u8d77\u52d5\n$ export PORT=3000\n$ node app.js\n\n\n\n\n\u304a\u308f\u308a\u306b\n\n\u30b3\u30de\u30f3\u30c9\u3092 3,4 \u500b\u5b9f\u884c\u3059\u308b\u3060\u3051\u3067\u3001\u3053\u3053\u307e\u3067\u3067\u304d\u308b\u3068\u306f\u9a5a\u304d\u3067\u3059\u3002\naws-serverless-express \u306e\u767b\u5834\u3067\u3001\u3044\u304d\u306a\u308a\u3001\u30b5\u30fc\u30d0\u30ec\u30b9\u3067\u30b5\u30fc\u30d3\u30b9\u3092\u5b9f\u73fe\u3067\u304d\u308b\u6c17\u304c\u3057\u3066\u304d\u305f\u3002\n\u3042\u3068\u306f\u3001MongoDB \u306e\u30de\u30cd\u30fc\u30b8\u30c9\u30b5\u30fc\u30d3\u30b9\u304c\u3042\u308c\u3070\u306a\u3041\u3002\n\n\nTODO\n\u3071\u3063\u3068\u601d\u3044\u3064\u304f\u3060\u3051\u3067\u3082\u3001\u307e\u3060\u5148\u306f\u9577\u3044\u3002\u308f\u304b\u308a\u6b21\u7b2c\u3001\u8ffd\u8a18\u3057\u3066\u3044\u304d\u307e\u3059\u3002\n\n\nLambda \u3067\u306e params, context \u306e\u6271\u3044\n\n\u30ed\u30fc\u30ab\u30eb\u3067\u306e\u5b9f\u884c\u65b9\u6cd5\u3001\u30c7\u30d0\u30c3\u30b0\u65b9\u6cd5\u306a\u3069\n\n# \u306f\u3058\u3081\u306b\nAWS \u3068\u8a00\u3048\u3070 Lambda\u3001Lambda \u3068\u8a00\u3048\u3070 \u30b5\u30fc\u30d0\u30ec\u30b9 \u3067\u3059\u304c\u3001\u30b5\u30fc\u30d0\u30ec\u30b9\u3067\u30b5\u30fc\u30d3\u30b9\u5168\u4f53\u3092\u4f5c\u308b\u306e\u306f\u3057\u3093\u3069\u3044\u306a\u3068\u601d\u3063\u3066\u3044\u308b\u6628\u4eca\u3001\u7686\u69d8\u3044\u304b\u304c\u304a\u904e\u3054\u3057\u3067\u3059\u304b\u3002\n\n\u305d\u3093\u306a\u6298\u300110/04\u4ed8\u3051 AWS \u30d6\u30ed\u30b0\u3067\u4ee5\u4e0b\u306e\u8a18\u4e8b\u304c\u30dd\u30b9\u30c8\u3055\u308c\u307e\u3057\u305f\u3002\n\n\u300cAWS Lambda \u3068 Amazon API Gateway \u3067 Express \u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u5b9f\u884c\u300d\nhttps://aws.amazon.com/jp/blogs/news/running-express-applications-on-aws-lambda-and-amazon-api-gateway/\n\nLambda \u3067 Express \u304c\u52d5\u304f\u3060\u3068!? \u306a\u3093\u3066\u65e5\u3060\uff01\n\n\n# \u624b\u9806\n\n\n 1. \u30ed\u30fc\u30ab\u30eb\u74b0\u5883\n  Lambda \u306e Node \u306f 4.3.2 \u306a\u306e\u3067\u3001\u30ed\u30fc\u30ab\u30eb\u958b\u767a\u74b0\u5883\u3082\u3001\u5ff5\u306e\u305f\u3081\u3001\u5408\u308f\u305b\u3066\u304a\u304f\n\n    ```\n$ nodebrew use v4.3.2\n$ node -v\nv4.3.2\n```\n\n 1. \u30b5\u30f3\u30d7\u30eb\u30b3\u30fc\u30c9\u53d6\u5f97\n  GitHub \u304b\u3089\u30b5\u30f3\u30d7\u30eb\u30b3\u30fc\u30c9\u3092\u53d6\u5f97\u3059\u308b\n\n    ```\n$ git clone https://github.com/awslabs/aws-serverless-express.git\n$ cp -r ./aws-serverless-express/example ~/projects/yourProject\n$ cd ~/projects/yourProject\n```\n\n 1. \u30b3\u30f3\u30d5\u30a3\u30b0\u30ec\u30fc\u30b7\u30e7\u30f3\n  \u4ee5\u4e0b\u3067\u3001\u30b3\u30f3\u30d5\u30a3\u30b0\u30ec\u30fc\u30b7\u30e7\u30f3\u3092\u884c\u3046\n\n    ```\n$ npm run config <\u30a2\u30ab\u30a6\u30f3\u30c8ID> <\u30d0\u30b1\u30c3\u30c8\u540d> ap-northeast-1\n```\n\n    |\u30d1\u30e9\u30e1\u30fc\u30bf|\u610f\u5473|\n |----|----|\n |\u30a2\u30ab\u30a6\u30f3\u30c8ID |AWS \u30b3\u30f3\u30bd\u30fc\u30eb\u306e \u30a2\u30ab\u30a6\u30f3\u30c8\u60c5\u5831\u3067\u8868\u793a\u3055\u308c\u3066\u3044\u308b ID|\n |\u30d0\u30b1\u30c3\u30c8\u540d |S3 \u306e\u30d0\u30b1\u30c3\u30c8\u540d\u3002\u5168\u4e16\u754c\u3067\u552f\u4e00\u306e\u540d\u524d\u3067\u3042\u308b\u5fc5\u8981\u304c\u3042\u308b\u3002<br>\u6307\u5b9a\u3057\u305f\u30d0\u30b1\u30c3\u30c8\u304c\u5b58\u5728\u3057\u3066\u3044\u306a\u3044\u306a\u3089\u3001\u81ea\u52d5\u3067\u4f5c\u6210\u3057\u3066\u304f\u308c\u308b\u3002<br>Lambda \u306b\u30b3\u30fc\u30c9\u4e00\u5f0f\u3092\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3059\u308b\u305f\u3081\u306b\u4f7f\u7528\u3055\u308c\u308b\u3060\u3051\u3002|\n  ![\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8_2016-10-09_16_36_33.png](https://qiita-image-store.s3.amazonaws.com/0/69410/6548c8ca-1341-5baa-832c-b31637f05dd6.png)\n\n 1. \u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\n  \u305f\u3063\u305f\u3001\u3053\u308c\u3060\u3051\u3002\n\n    ```\n$ npm run setup\n```\n\n 1. \u52d5\u4f5c\u78ba\u8a8d\nCloudFormation \u304c CREATE_COMPLETE \u306b\u306a\u308c\u3070\u3001\u6210\u529f\u3002\nOutputs \u30bf\u30d6\u306b\u3001\u4f5c\u6210\u3055\u308c\u305f\u753b\u9762\u3078\u306e\u30ea\u30f3\u30af\u304c\u3001\u8868\u793a\u3055\u308c\u3066\u3044\u308b\u3002\n![\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8_2016-10-09_16_35_08.png](https://qiita-image-store.s3.amazonaws.com/0/69410/e5f65a1a-57d9-e21a-4f12-557464d89002.png)\n   - ApiUrl  \n  \u30b5\u30f3\u30d7\u30eb users \u306e RESTful API \u304c\u8868\u793a\u3055\u308c\u3066\u3044\u308b\u3002  \n\u52d5\u304f\u3001\u52d5\u304f\u3088\uff01\n![\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8_2016-10-09_16_21_48.png](https://qiita-image-store.s3.amazonaws.com/0/69410/eb395bf9-5c29-9ce9-f1c3-322434d2a224.png)\n   - APIGateway\n![\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8_2016-10-09_16_35_33.png](https://qiita-image-store.s3.amazonaws.com/0/69410/ef49fa0b-d8bf-d032-fdbe-73464b9ab1dd.png)\n   - Lambda  \n\u3053\u306e\u3088\u3046\u306a Lambda \u95a2\u6570\u304c\u751f\u6210\u3055\u308c\u308b\u3002\u3053\u308c\u81ea\u4f53\u306f\u3001\u305f\u3063\u305f4\u884c\u3002\u3053\u306e Lambda \u95a2\u6570\u3092\u3044\u3058\u308b\u3053\u3068\u306f\u306a\u3044\u3002\n![\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8_2016-10-09_16_35_49.png](https://qiita-image-store.s3.amazonaws.com/0/69410/3d6d4a15-b0ee-e97d-c810-e2be8e5655c9.png)\n\n# \u30ab\u30b9\u30bf\u30de\u30a4\u30ba\n\n 1. \u30ab\u30b9\u30bf\u30de\u30a4\u30ba\n  app.js \u3092\u30ab\u30b9\u30bf\u30de\u30a4\u30ba\u3057\u3066\u3044\u3051\u3070\u3088\u3044\u3002\n  \u3053\u3053\u306f\u3001\u4eca\u307e\u3067\u901a\u308a\u306e\u3001\u666e\u901a\u306e Node + Express \u3060\u3002\n\n 2. \u53cd\u6620\n  \u6b21\u306e\u30b3\u30de\u30f3\u30c9\u3067\u3001AWS\u306b\u53cd\u6620\u3067\u304d\u308b\u3002\u3053\u308c\u3060\u3051\u3060\u3002\u306a\u3093\u3066\u65e5\u3060\uff01\n\n    ```\n$ npm run package-upload-update-function\n```\n\n# \u30ed\u30fc\u30ab\u30eb \u30c6\u30b9\u30c8\n70\u884c\u76ee\u4ed8\u8fd1\u3092\u4fee\u6b63\u3057\u3066\u3001\u30ed\u30fc\u30ab\u30eb\u306e node \u3067\u8d77\u52d5\u3057\u3066\u30c6\u30b9\u30c8\u3067\u304d\u308b\u3088\u3046\u306b\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n\n 1. \u30b3\u30fc\u30c9\u4fee\u6b63\n\n    ```\n// The aws-serverless-express library creates a server and listens on a Unix\n// Domain Socket for you, so you can remove the usual call to app.listen.\n//app.listen(3000)\nprocess.env.PORT && app.listen(process.env.PORT)\n```\n 1. \u8d77\u52d5\n\n    ```\n$ export PORT=3000\n$ node app.js\n```\n\n# \u304a\u308f\u308a\u306b\n - \u30b3\u30de\u30f3\u30c9\u3092 3,4 \u500b\u5b9f\u884c\u3059\u308b\u3060\u3051\u3067\u3001\u3053\u3053\u307e\u3067\u3067\u304d\u308b\u3068\u306f\u9a5a\u304d\u3067\u3059\u3002\n - aws-serverless-express \u306e\u767b\u5834\u3067\u3001\u3044\u304d\u306a\u308a\u3001\u30b5\u30fc\u30d0\u30ec\u30b9\u3067\u30b5\u30fc\u30d3\u30b9\u3092\u5b9f\u73fe\u3067\u304d\u308b\u6c17\u304c\u3057\u3066\u304d\u305f\u3002\n - \u3042\u3068\u306f\u3001MongoDB \u306e\u30de\u30cd\u30fc\u30b8\u30c9\u30b5\u30fc\u30d3\u30b9\u304c\u3042\u308c\u3070\u306a\u3041\u3002\n\n# TODO\n\u3071\u3063\u3068\u601d\u3044\u3064\u304f\u3060\u3051\u3067\u3082\u3001\u307e\u3060\u5148\u306f\u9577\u3044\u3002\u308f\u304b\u308a\u6b21\u7b2c\u3001\u8ffd\u8a18\u3057\u3066\u3044\u304d\u307e\u3059\u3002\n\n - [ ] Lambda \u3067\u306e params, context \u306e\u6271\u3044\n - [x] \u30ed\u30fc\u30ab\u30eb\u3067\u306e\u5b9f\u884c\u65b9\u6cd5\u3001\u30c7\u30d0\u30c3\u30b0\u65b9\u6cd5\u306a\u3069\n", "tags": ["aws-serverless-express", "lambda", "Node.js", "APIGateway", "Express"]}