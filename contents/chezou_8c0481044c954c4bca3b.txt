{"context": " More than 1 year has passed since last update.\u4f8b\u3048\u3070\u3001Redis\u306eSorted set\u306a\u3069\u3001\u5225\u306e\u30e2\u30c7\u30eb\u304b\u3089\u53d6\u3063\u3066\u304d\u305f\u9806\u5e8f\u306b\u610f\u5473\u306e\u3042\u308bID\u5217\u304c\u3042\u3063\u305f\u3068\u3059\u308b\u3002\nids = [5, 2, 10]\n\n\u3067\u3001\u3053\u306eID\u306e\u9806\u306b\u53d6\u5f97\u3057\u305f\u3044\u5834\u5408\u3001mysql\u3092\u4f7f\u3063\u3066\u3044\u308b\u306a\u3089\u3053\u3046\u66f8\u3051\u308b\nSELECT id FROM model\n WHERE id IN (5, 2, 10)\n ORDER BY FIELD(id, 5, 2, 10)\n\n\u305f\u3060\u3001\u3053\u308c\u3092ActiveRecord\u3067\u3084\u308d\u3046\u3068\u3059\u308b\u6642\u3001\u81ea\u5206\u3067sanitize\u3059\u308b\u5fc5\u8981\u304c\u3042\u308b\u3002\nsanitized_query = ActiveRecord::Base.send(:sanitize_sql_array, [\"field(id ,?)\",ids])\nModel.where(id: ids).order(sanitized_query)\n\n[2015/11/15\u8ffd\u8a18]\nRails\u306ev4.2.5\u4ee5\u964d\u3067\u306f v4.2.5\u306b\u306f\u307e\u3060\u5165\u3063\u3066\u3044\u307e\u305b\u3093\u3067\u3057\u305f\u304c\u3001master\u306b\u306f\u53cd\u6620\u3055\u308c\u3066\u3044\u308b\u3088\u3046\u3067\u3059\u3002\nModel.where(id: ids).order(['field(id, ?)', ids])\n\n\u3068\u66f8\u3051\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3057\u305f\u3002\n@jnchito \u3055\u3093\u306b\u6559\u3048\u3066\u3044\u305f\u3060\u304d\u307e\u3057\u305f\u3002\u3042\u308a\u304c\u3068\u3046\u3054\u3056\u3044\u307e\u3059\u3002\n\n\u4f8b\u3048\u3070\u3001Redis\u306eSorted set\u306a\u3069\u3001\u5225\u306e\u30e2\u30c7\u30eb\u304b\u3089\u53d6\u3063\u3066\u304d\u305f\u9806\u5e8f\u306b\u610f\u5473\u306e\u3042\u308bID\u5217\u304c\u3042\u3063\u305f\u3068\u3059\u308b\u3002\n\n```rb\nids = [5, 2, 10]\n```\n\n\u3067\u3001\u3053\u306eID\u306e\u9806\u306b\u53d6\u5f97\u3057\u305f\u3044\u5834\u5408\u3001mysql\u3092\u4f7f\u3063\u3066\u3044\u308b\u306a\u3089\u3053\u3046\u66f8\u3051\u308b\n\n```sql\nSELECT id FROM model\n WHERE id IN (5, 2, 10)\n ORDER BY FIELD(id, 5, 2, 10)\n```\n\n\u305f\u3060\u3001\u3053\u308c\u3092ActiveRecord\u3067\u3084\u308d\u3046\u3068\u3059\u308b\u6642\u3001\u81ea\u5206\u3067sanitize\u3059\u308b\u5fc5\u8981\u304c\u3042\u308b\u3002\n\n```rb\nsanitized_query = ActiveRecord::Base.send(:sanitize_sql_array, [\"field(id ,?)\",ids])\nModel.where(id: ids).order(sanitized_query)\n```\n\n**[2015/11/15\u8ffd\u8a18]**\nRails\u306e<del>v4.2.5\u4ee5\u964d\u3067\u306f</del> v4.2.5\u306b\u306f\u307e\u3060\u5165\u3063\u3066\u3044\u307e\u305b\u3093\u3067\u3057\u305f\u304c\u3001master\u306b\u306f\u53cd\u6620\u3055\u308c\u3066\u3044\u308b\u3088\u3046\u3067\u3059\u3002\n\n```rb\nModel.where(id: ids).order(['field(id, ?)', ids])\n```\n\n\u3068\u66f8\u3051\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3057\u305f\u3002\n\n@jnchito \u3055\u3093\u306b\u6559\u3048\u3066\u3044\u305f\u3060\u304d\u307e\u3057\u305f\u3002\u3042\u308a\u304c\u3068\u3046\u3054\u3056\u3044\u307e\u3059\u3002\n", "tags": ["Rails3.2.11", "ActiveRecord", "MySQL5.5"]}