{"context": "\u672c\u756a\u30b7\u30b9\u30c6\u30e0\u3067\u306f\u3001\u30ed\u30b0\u30c7\u30fc\u30bf\u306e\u30d0\u30c3\u30af\u30a2\u30c3\u30d7\uff0f\u30ea\u30b9\u30c8\u30a2\u3001\u30b9\u30c8\u30ec\u30fc\u30b8\u78ba\u4fdd\u306f\u5fc5\u9808\u4e8b\u9805\u3067\u3059\u3002\nElastic Stack\u3092\u5b9f\u7528\u3059\u308b\u306b\u3042\u305f\u3063\u3066\u3084\u308a\u65b9\u3092\u52c9\u5f37\u3057\u307e\u3057\u305f\u3002\n\n\u74b0\u5883\n\nOS: Win 7 Pro 64bit\nElasticsearch: 5.0.0 rc-1\nKibana: 5.0.0 rc-1\n\n\u64cd\u4f5c\u306f\u5168\u3066Kibana\u30b3\u30f3\u30bd\u30fc\u30eb\u3067\u5b9f\u65bd\u3057\u307e\u3057\u305f\u3002\n\n\nElastic Stack\u3067\u306f\n\u30d0\u30c3\u30af\u30a2\u30c3\u30d7\u30c7\u30fc\u30bf\u3092\u4fdd\u5b58\u3059\u308b\u305f\u3081\u306e\u300c\u30ea\u30dd\u30b8\u30c8\u30ea\u300d\u3092\u4f5c\u6210\u3057\u3001\n\u305d\u3053\u306b\u300c\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u300d\u3092\u64ae\u308b\u3053\u3068\u3067\u30c7\u30fc\u30bf\u3092\u30d0\u30c3\u30af\u30a2\u30c3\u30d7\u3067\u304d\u308b\u305d\u3046\u3067\u3059\u3002\n\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u306f\u300c\u30ea\u30b9\u30c8\u30a2\u300d\u3067\u304d\u308b\u305d\u3046\u3067\u3059\u3002\n\u3068\u3044\u3046\u3053\u3068\u306f\u3001\u30b9\u30c8\u30ec\u30fc\u30b8\u306e\u7a7a\u304d\u3092\u78ba\u4fdd\u3059\u308b\u306b\u306f\u3001\u201d\u53e4\u3044\u30c7\u30fc\u30bf\u306b\u7d5e\u3063\u3066\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u3092\u64ae\u308a\u3001\u5f53\u8a72\u30c7\u30fc\u30bf\u3092\u524a\u9664\u201d\u3067\u304d\u308c\u3070\u826f\u3055\u305d\u3046\u3067\u3059\u3002\n\u3055\u3063\u305d\u304f\u3084\u3063\u3066\u3044\u304d\u307e\u3057\u3087\u3046\u3002\n\n\u30ea\u30dd\u30b8\u30c8\u30ea\u306e\u4f5c\u6210\n\n\u30ea\u30dd\u30b8\u30c8\u30ea\u306e\u5834\u6240\u3092\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u306b\u8a18\u8f09\n\u30ea\u30dd\u30b8\u30c8\u30ea\u3092\u914d\u7f6e\u3059\u308b\u30eb\u30fc\u30c8\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n\nelasticsearch.yml\n\u30fb\u30fb\u30fb\uff08\u6700\u7d42\u884c\uff09\npath.repo: [\"C:\\\\dev\\\\elastic-rc1\\\\elasticsearch-5.0.0-rc1\\\\repositories\"]\n\n\n\n\u30ea\u30dd\u30b8\u30c8\u30ea\u4f5c\u6210\n\n\u30ea\u30af\u30a8\u30b9\u30c8\n\nPUT /_snapshot/myrepo\n{\n  \"type\": \"fs\",\n  \"settings\": {\n    \"location\": \"myrepo\"\n  }\n}\n\n\n\u7d50\u679c\n\n{\n  \"acknowledged\": true\n}\n\n\u6b21\u306e\u3088\u3046\u306a\u30d5\u30a9\u30eb\u30c0\u304c\u3067\u304d\u307e\u3057\u305f\u3002\nC:\\dev\\elastic-rc1\\elasticsearch-5.0.0-rc1\\repositories\\myrepo\n\n\n\u30ea\u30dd\u30b8\u30c8\u30ea\u306e\u78ba\u8a8d\n\n\u30ea\u30af\u30a8\u30b9\u30c8\n\nGET /_snapshot\n\n\n\u7d50\u679c\n\n{\n  \"myrepo\": {\n    \"type\": \"fs\",\n    \"settings\": {\n      \"location\": \"myrepo\"\n    }\n  }\n}\n\n\n\u3057\u304b\u3057\u3001Kibana\u30b3\u30f3\u30bd\u30fc\u30eb\u306f/_snapshot\u3068\u304b\u306eURI\u3092\u30b5\u30b8\u30a7\u30b9\u30c8\u3057\u3066\u304f\u308c\u308b\u304b\u3089\u3001\u4fbf\u5229\u306d\u3002\n\u3055\u3089\u306b\u3001\u3053\u3053\u3067DELETE /_snapshot/myrepo\u3092\u305f\u305f\u304f\u3068\u3001\u30ea\u30dd\u30b8\u30c8\u30ea\u304c\u3061\u3083\u3093\u3068\u6d88\u3048\u308b\u3002\u3055\u3059\u304cRESTful\u3002\n\n\n\u30ea\u30dd\u30b8\u30c8\u30ea\u306e\u30d9\u30ea\u30d5\u30a1\u30a4\n\u3068\u3044\u3046\u306e\u304c\u3067\u304d\u308b\u3089\u3057\u3044\u306e\u3067\u5b9f\u884c\u3057\u3066\u307f\u305f\u3002\n\n\u30ea\u30af\u30a8\u30b9\u30c8\n\nPOST /_snapshot/myrepo/_verify\n\n\n\u7d50\u679c\n\n{\n  \"nodes\": {\n    \"plCY4gHHRFeM-zmDY4qBtw\": {\n      \"name\": \"plCY4gH\"\n    }\n  }\n}\n\n\u306a\u308b\u307b\u3069\u308f\u304b\u3089\u3093\u3002\n\n\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u306e\u53d6\u5f97\n\n\u304a\u3082\u3080\u308d\u306b\uff08\u5168\u4f53\uff09\n\n\u30ea\u30af\u30a8\u30b9\u30c8\n\nPUT /_snapshot/myrepo/snapshot_1?wait_for_completion=true\n\n\n\u7d50\u679c\uff08\u6642\u9593\u304b\u304b\u308a\u307e\u3059\uff09\n\n{\n  \"snapshot\": {\n    \"snapshot\": \"snapshot_1\",\n    \"uuid\": \"xAXb0VBlSieLkVpFsgpr2Q\",\n    \"version_id\": 5000051,\n    \"version\": \"5.0.0-rc1\",\n    \"indices\": [\n      \"logstash-2016.10.18\",\n      \"logstash-2016.10.26\",\n      \"logstash-2016.10.31\",\n      \".kibana\"\n    ],\n    \"state\": \"SUCCESS\",\n    \"start_time\": \"2016-11-01T07:36:10.370Z\",\n    \"start_time_in_millis\": 1477985770370,\n    \"end_time\": \"2016-11-01T07:36:19.250Z\",\n    \"end_time_in_millis\": 1477985779250,\n    \"duration_in_millis\": 8880,\n    \"failures\": [],\n    \"shards\": {\n      \"total\": 16,\n      \"failed\": 0,\n      \"successful\": 16\n    }\n  }\n}\n\n8880\u30df\u30ea\u79d2\u304b\u304b\u3063\u3066\u308b\u307f\u305f\u3044\u3067\u3059\u3002\n\u30d5\u30a9\u30eb\u30c0\u306fsnapshot_1\u304c\u3067\u304d\u3066\u3044\u308b\u3068\u601d\u3044\u304d\u3084\u3001\u308f\u3051\u308f\u304b\u3089\u3093\u3053\u3068\u306a\u3063\u3066\u307e\u3057\u305f\u3002\n\n\\repositories\\myrepo\\\nindices \uff08\u2190\u30d5\u30a9\u30eb\u30c0\uff09\nindex.latest\nindex-0\nmeta-xAXb0VBlSieLkVpFsgpr2Q.dat\nsnap-xAXb0VBlSieLkVpFsgpr2Q.dat\n\n\n\n\u53e4\u3044\u30c7\u30fc\u30bf\u3060\u3051\n\u4e0a\u8a18\u7d50\u679c\u3067\u3001indices\u304clogstash-2016.10.18\u3001logstash-2016.10.26\u3001logstash-2016.10.31\u3068\u65e5\u3054\u3068\u306b\u5206\u304b\u308c\u3066\u3044\u307e\u3059\u3002\n\u3053\u308c\u3067\u65e5\u5358\u4f4d\u306e\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u304c\u64ae\u308c\u305d\u3046\u3067\u3059\u3002\n\n\u30ea\u30af\u30a8\u30b9\u30c8\n\nPUT /_snapshot/myrepo/snapshot_2\n{\n  \"indices\": \"logstash-2016.10.31\",\n  \"ignore_unavailable\": true,\n  \"include_global_state\": false\n}\n\n\n\u7d50\u679c\n\n{\n  \"accepted\": true\n}\n\n\u3084\u3051\u306b\u3042\u3063\u3055\u308a\u7d42\u308f\u308a\u307e\u3057\u305f\u304c\u30fb\u30fb\u30fb\n\n\u30ea\u30af\u30a8\u30b9\u30c8\n\nGET /_snapshot/myrepo/snapshot_2\n\n\n\u7d50\u679c\n\n{\n  \"snapshots\": [\n    {\n      \"snapshot\": \"snapshot_2\",\n      \"uuid\": \"CULBcckJSzG1zqW-FC_JbA\",\n      \"version_id\": 5000051,\n      \"version\": \"5.0.0-rc1\",\n      \"indices\": [\n        \"logstash-2016.10.31\"\n      ],\n      \"state\": \"SUCCESS\",\n      \"start_time\": \"2016-11-01T07:45:52.381Z\",\n      \"start_time_in_millis\": 1477986352381,\n      \"end_time\": \"2016-11-01T07:45:52.958Z\",\n      \"end_time_in_millis\": 1477986352958,\n      \"duration_in_millis\": 577,\n      \"failures\": [],\n      \"shards\": {\n        \"total\": 5,\n        \"failed\": 0,\n        \"successful\": 5\n      }\n    }\n  ]\n}\n\n\n\u53e4\u3044\u30c7\u30fc\u30bf\u3092\u524a\u9664\n10/26\u306e\u30c7\u30fc\u30bf\u3092\u524a\u9664\u3057\u307e\u3057\u3087\u3046\u3002\n\n\u524a\u9664\u524d\u306e\u30c7\u30fc\u30bf\u30b5\u30a4\u30ba\u306f\u3053\u3061\u3089\u3002\n\n\n\u30ea\u30af\u30a8\u30b9\u30c8\n\nDELETE /logstash-2016.10.26\n\n\n\u7d50\u679c\n\n{\n  \"acknowledged\": true\n}\n\n10/26\u306e\u30c7\u30fc\u30bf\u304c\u524a\u9664\u3055\u308c\u307e\u3057\u305f\u3002\u3053\u308c\u3067\u30b9\u30c8\u30ec\u30fc\u30b8\u304c\u7a7a\u304d\u307e\u3057\u305f\u3002\n\n\n\n\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u306e\u30ea\u30b9\u30c8\u30a2\n\u30ea\u30b9\u30c8\u30a2\u3067\u304d\u308b\u304b\u78ba\u8a8d\u3057\u307e\u3057\u3087\u3046\u3002\n\u5168\u4f53\u306e\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u304b\u3089\u3001\u7279\u5b9a\u306e\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u3060\u3051\u5fa9\u5143\u3057\u307e\u3059\u3002\n\n\u30ea\u30af\u30a8\u30b9\u30c8\n\nPOST /_snapshot/myrepo/snapshot_1/_restore\n{\n  \"indices\": \"logstash-2016.10.26\"\n}\n\n\n\u7d50\u679c\n\n{\n  \"accepted\": true\n}\n\n10/26\u306e\u30c7\u30fc\u30bf\u304c\u5e30\u3063\u3066\u304d\u307e\u3057\u305f\uff01\n\n\u30b9\u30c8\u30ec\u30fc\u30b8\u3082\u6d88\u8cbb\u3057\u3066\u3044\u307e\u3059\u3002\n\n\u3061\u306a\u307f\u306b\u3001\u5b58\u5728\u3059\u308b\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u3092\u5fa9\u5143\u3057\u3088\u3046\u3068\u3059\u308b\u3068\u3001\u6b21\u306e\u3088\u3046\u306a\u30a8\u30e9\u30fc\u306b\u306a\u308a\u307e\u3059\u3002\n{\n  \"error\": {\n    \"root_cause\": [\n      {\n        \"type\": \"snapshot_restore_exception\",\n        \"reason\": \"[myrepo:snapshot_1/xAXb0VBlSieLkVpFsgpr2Q] cannot restore index [.kibana] because it's open\"\n      }\n    ],\n    \"type\": \"snapshot_restore_exception\",\n    \"reason\": \"[myrepo:snapshot_1/xAXb0VBlSieLkVpFsgpr2Q] cannot restore index [.kibana] because it's open\"\n  },\n  \"status\": 500\n}\n\n\n\u307e\u3068\u3081\n1\u304b\u6708\u4ee5\u4e0a\u524d\u306a\u3069\u306e\u53e4\u3044\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u306f\u3001\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u3092\u64ae\u3063\u3066\u304b\u3089\u524a\u9664\u3059\u308b\u3053\u3068\u3067\u3001\u30b9\u30c8\u30ec\u30fc\u30b8\u3092\u78ba\u4fdd\u3067\u304d\u307e\u3059\u306d\u3002\n\u30ea\u30b9\u30c8\u30a2\u3082\u53ef\u80fd\u3067\u3059\u3002\n\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u306e\u30d5\u30a1\u30a4\u30eb\u3092\u3001\u30d5\u30a1\u30a4\u30eb\u30b7\u30b9\u30c6\u30e0\u3068\u3057\u3066\u79fb\u52d5\u3059\u308b\u308f\u3051\u3067\u306f\u306a\u3055\u305d\u3046\u306a\u306e\u3067\u3001NAS\u7b49\u306b\u30ea\u30dd\u30b8\u30c8\u30ea\u3092\u4f5c\u308b\u306e\u304c\u30d9\u30b9\u30c8\u306a\u3093\u3067\u3057\u3087\u3046\u304b\u306d\uff1f\n\u3061\u306a\u307f\u306bElasticsearch\u30d0\u30fc\u30b8\u30e7\u30f3\u30a2\u30c3\u30d7\u306e\u305f\u3081\u306e\u30d0\u30c3\u30af\u30a2\u30c3\u30d7\u30fb\u30ea\u30b9\u30c8\u30a2\u306b\u3064\u3044\u3066\u306f\u3001\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u306e\u4e92\u63db\u6027\u306b\u5236\u9650\u304c\u3042\u308b\u306e\u3067\u3001\u78ba\u8a8d\u3057\u305f\u307b\u3046\u304c\u3088\u3044\u3067\u3057\u3087\u3046\u3002\n\n\u304a\u307e\u3051\uff1apath.repo\n\u30de\u30cb\u30e5\u30a2\u30eb\u307f\u308b\u3068\u3001\npath.repo: [\"/mount/backups\", \"/mount/longterm_backups\"]\n\n\u307f\u305f\u3044\u306b\u30d1\u30b9\u306e\u7701\u7565\u304c\u3067\u304d\u308b\u3063\u307d\u3044\u3002\n\u30ea\u30d7\u30ec\u30fc\u30b9\u7684\u306b\u4f7f\u3048\u308b\u304b\uff1f\u3084\u3063\u3066\u307f\u305f\u3002\n\n\u305d\u306e\uff11\n\nelasticsearch.yml\npath.repo: [\"repositories\", \"C:\\\\dev\\\\elastic-rc1\\\\elasticsearch-5.0.0-rc1\\\\repositories\"]\n\n\n\uff0b\nPUT /_snapshot/myrepo1\n{\n  \"type\": \"fs\",\n  \"settings\": {\n    \"location\": \"repositories/myrepo1\n  }\n}\n\n=\nC:\\dev\\elastic-rc1\\elasticsearch-5.0.0-rc1\\repositories\\repositories\\myrepo1\n\noh...\n\n\u305d\u306e\uff12\n\nelasticsearch.yml\npath.repo: [\"C:\\\\repositories\", \"C:\\\\dev\\\\elastic-rc1\\\\elasticsearch-5.0.0-rc1\\\\repositories\"]\n\n\nOR\n\nelasticsearch.yml\npath.repo: [\"/repositories\", \"C:\\\\dev\\\\elastic-rc1\\\\elasticsearch-5.0.0-rc1\\\\repositories\"]\n\n\n=\nElasticsearch\u3092\u8d77\u52d5\u3057\u305f\u30bf\u30a4\u30df\u30f3\u30b0\u3067\u3001\u6b21\u306e\u30d5\u30a9\u30eb\u30c0\u304c\u3067\u304d\u305f\u3002\nC:\\repositories\n\n\u305d\u306e\uff11\u306f\u306a\u3093\u3068\u306a\u304f\u7406\u89e3\u3067\u304d\u308b\u3051\u3069\u3001\u305d\u306e\uff12\u306f\u30de\u30cb\u30e5\u30a2\u30eb\u901a\u308a\u306b\u306a\u3063\u3066\u306a\u3055\u305d\u3046\u3067\u6c17\u6301\u3061\u60aa\u3044\u3002Windows\u3060\u3051\u304b\uff1f\n\u3068\u308a\u3042\u3048\u305a\u3001path.repo\u306f\u30ea\u30dd\u30b8\u30c8\u30ea\u306b\u3057\u305f\u3044\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3060\u3051\u6307\u5b9a\u3059\u308b\u306e\u304c\u3088\u3055\u305d\u3046\u3002\n\n\u53c2\u8003\nSnapshot And Restore | Elasticsearch Reference [5.0] | Elastic\n\n\n\u672c\u756a\u30b7\u30b9\u30c6\u30e0\u3067\u306f\u3001\u30ed\u30b0\u30c7\u30fc\u30bf\u306e\u30d0\u30c3\u30af\u30a2\u30c3\u30d7\uff0f\u30ea\u30b9\u30c8\u30a2\u3001\u30b9\u30c8\u30ec\u30fc\u30b8\u78ba\u4fdd\u306f\u5fc5\u9808\u4e8b\u9805\u3067\u3059\u3002\nElastic Stack\u3092\u5b9f\u7528\u3059\u308b\u306b\u3042\u305f\u3063\u3066\u3084\u308a\u65b9\u3092\u52c9\u5f37\u3057\u307e\u3057\u305f\u3002\n\n## \u74b0\u5883\n\n- OS: Win 7 Pro 64bit\n- Elasticsearch: 5.0.0 rc-1\n- Kibana: 5.0.0 rc-1\n\n\u64cd\u4f5c\u306f\u5168\u3066Kibana\u30b3\u30f3\u30bd\u30fc\u30eb\u3067\u5b9f\u65bd\u3057\u307e\u3057\u305f\u3002\n![28.png](https://qiita-image-store.s3.amazonaws.com/0/68978/e5685b8b-c366-b919-a82d-dc1f59215180.png)\n\n\n## Elastic Stack\u3067\u306f\n\n\u30d0\u30c3\u30af\u30a2\u30c3\u30d7\u30c7\u30fc\u30bf\u3092\u4fdd\u5b58\u3059\u308b\u305f\u3081\u306e\u300c\u30ea\u30dd\u30b8\u30c8\u30ea\u300d\u3092\u4f5c\u6210\u3057\u3001\n\u305d\u3053\u306b\u300c\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u300d\u3092\u64ae\u308b\u3053\u3068\u3067\u30c7\u30fc\u30bf\u3092\u30d0\u30c3\u30af\u30a2\u30c3\u30d7\u3067\u304d\u308b\u305d\u3046\u3067\u3059\u3002\n\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u306f\u300c\u30ea\u30b9\u30c8\u30a2\u300d\u3067\u304d\u308b\u305d\u3046\u3067\u3059\u3002\n\n\u3068\u3044\u3046\u3053\u3068\u306f\u3001\u30b9\u30c8\u30ec\u30fc\u30b8\u306e\u7a7a\u304d\u3092\u78ba\u4fdd\u3059\u308b\u306b\u306f\u3001\u201d\u53e4\u3044\u30c7\u30fc\u30bf\u306b\u7d5e\u3063\u3066\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u3092\u64ae\u308a\u3001\u5f53\u8a72\u30c7\u30fc\u30bf\u3092\u524a\u9664\u201d\u3067\u304d\u308c\u3070\u826f\u3055\u305d\u3046\u3067\u3059\u3002\n\n\u3055\u3063\u305d\u304f\u3084\u3063\u3066\u3044\u304d\u307e\u3057\u3087\u3046\u3002\n\n\n## \u30ea\u30dd\u30b8\u30c8\u30ea\u306e\u4f5c\u6210\n\n### \u30ea\u30dd\u30b8\u30c8\u30ea\u306e\u5834\u6240\u3092\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u306b\u8a18\u8f09\n\n\u30ea\u30dd\u30b8\u30c8\u30ea\u3092\u914d\u7f6e\u3059\u308b\u30eb\u30fc\u30c8\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n\n```js:elasticsearch.yml\n\u30fb\u30fb\u30fb\uff08\u6700\u7d42\u884c\uff09\npath.repo: [\"C:\\\\dev\\\\elastic-rc1\\\\elasticsearch-5.0.0-rc1\\\\repositories\"]\n```\n\n### \u30ea\u30dd\u30b8\u30c8\u30ea\u4f5c\u6210\n\n- \u30ea\u30af\u30a8\u30b9\u30c8\n\n```js\nPUT /_snapshot/myrepo\n{\n  \"type\": \"fs\",\n  \"settings\": {\n    \"location\": \"myrepo\"\n  }\n}\n```\n\n- \u7d50\u679c\n\n```js\n{\n  \"acknowledged\": true\n}\n```\n\n\u6b21\u306e\u3088\u3046\u306a\u30d5\u30a9\u30eb\u30c0\u304c\u3067\u304d\u307e\u3057\u305f\u3002\n\n```js\nC:\\dev\\elastic-rc1\\elasticsearch-5.0.0-rc1\\repositories\\myrepo\n```\n\n### \u30ea\u30dd\u30b8\u30c8\u30ea\u306e\u78ba\u8a8d\n\n- \u30ea\u30af\u30a8\u30b9\u30c8\n\n```js\nGET /_snapshot\n```\n\n- \u7d50\u679c\n\n```js\n{\n  \"myrepo\": {\n    \"type\": \"fs\",\n    \"settings\": {\n      \"location\": \"myrepo\"\n    }\n  }\n}\n```\n\n> \u3057\u304b\u3057\u3001Kibana\u30b3\u30f3\u30bd\u30fc\u30eb\u306f`/_snapshot`\u3068\u304b\u306eURI\u3092\u30b5\u30b8\u30a7\u30b9\u30c8\u3057\u3066\u304f\u308c\u308b\u304b\u3089\u3001\u4fbf\u5229\u306d\u3002\n\n> \u3055\u3089\u306b\u3001\u3053\u3053\u3067`DELETE /_snapshot/myrepo`\u3092\u305f\u305f\u304f\u3068\u3001\u30ea\u30dd\u30b8\u30c8\u30ea\u304c\u3061\u3083\u3093\u3068\u6d88\u3048\u308b\u3002\u3055\u3059\u304cRESTful\u3002\n\n### \u30ea\u30dd\u30b8\u30c8\u30ea\u306e\u30d9\u30ea\u30d5\u30a1\u30a4\n\n\u3068\u3044\u3046\u306e\u304c\u3067\u304d\u308b\u3089\u3057\u3044\u306e\u3067\u5b9f\u884c\u3057\u3066\u307f\u305f\u3002\n\n- \u30ea\u30af\u30a8\u30b9\u30c8\n\n```js\nPOST /_snapshot/myrepo/_verify\n```\n\n- \u7d50\u679c\n\n```js\n{\n  \"nodes\": {\n    \"plCY4gHHRFeM-zmDY4qBtw\": {\n      \"name\": \"plCY4gH\"\n    }\n  }\n}\n```\n\n\u306a\u308b\u307b\u3069\u308f\u304b\u3089\u3093\u3002\n\n## \u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u306e\u53d6\u5f97\n\n### \u304a\u3082\u3080\u308d\u306b\uff08\u5168\u4f53\uff09\n\n- \u30ea\u30af\u30a8\u30b9\u30c8\n\n```js\nPUT /_snapshot/myrepo/snapshot_1?wait_for_completion=true\n```\n\n- \u7d50\u679c\uff08\u6642\u9593\u304b\u304b\u308a\u307e\u3059\uff09\n\n```js\n{\n  \"snapshot\": {\n    \"snapshot\": \"snapshot_1\",\n    \"uuid\": \"xAXb0VBlSieLkVpFsgpr2Q\",\n    \"version_id\": 5000051,\n    \"version\": \"5.0.0-rc1\",\n    \"indices\": [\n      \"logstash-2016.10.18\",\n      \"logstash-2016.10.26\",\n      \"logstash-2016.10.31\",\n      \".kibana\"\n    ],\n    \"state\": \"SUCCESS\",\n    \"start_time\": \"2016-11-01T07:36:10.370Z\",\n    \"start_time_in_millis\": 1477985770370,\n    \"end_time\": \"2016-11-01T07:36:19.250Z\",\n    \"end_time_in_millis\": 1477985779250,\n    \"duration_in_millis\": 8880,\n    \"failures\": [],\n    \"shards\": {\n      \"total\": 16,\n      \"failed\": 0,\n      \"successful\": 16\n    }\n  }\n}\n```\n8880\u30df\u30ea\u79d2\u304b\u304b\u3063\u3066\u308b\u307f\u305f\u3044\u3067\u3059\u3002\n\n\u30d5\u30a9\u30eb\u30c0\u306f`snapshot_1`\u304c\u3067\u304d\u3066\u3044\u308b\u3068\u601d\u3044\u304d\u3084\u3001\u308f\u3051\u308f\u304b\u3089\u3093\u3053\u3068\u306a\u3063\u3066\u307e\u3057\u305f\u3002\n\n```js:\\repositories\\myrepo\\\nindices \uff08\u2190\u30d5\u30a9\u30eb\u30c0\uff09\nindex.latest\nindex-0\nmeta-xAXb0VBlSieLkVpFsgpr2Q.dat\nsnap-xAXb0VBlSieLkVpFsgpr2Q.dat\n```\n\n### \u53e4\u3044\u30c7\u30fc\u30bf\u3060\u3051\n\n\u4e0a\u8a18\u7d50\u679c\u3067\u3001indices\u304c`logstash-2016.10.18`\u3001`logstash-2016.10.26`\u3001`logstash-2016.10.31`\u3068\u65e5\u3054\u3068\u306b\u5206\u304b\u308c\u3066\u3044\u307e\u3059\u3002\n\u3053\u308c\u3067\u65e5\u5358\u4f4d\u306e\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u304c\u64ae\u308c\u305d\u3046\u3067\u3059\u3002\n\n- \u30ea\u30af\u30a8\u30b9\u30c8\n\n```js\nPUT /_snapshot/myrepo/snapshot_2\n{\n  \"indices\": \"logstash-2016.10.31\",\n  \"ignore_unavailable\": true,\n  \"include_global_state\": false\n}\n```\n\n- \u7d50\u679c\n\n```js\n{\n  \"accepted\": true\n}\n```\n\n\u3084\u3051\u306b\u3042\u3063\u3055\u308a\u7d42\u308f\u308a\u307e\u3057\u305f\u304c\u30fb\u30fb\u30fb\n\n- \u30ea\u30af\u30a8\u30b9\u30c8\n\n```js\nGET /_snapshot/myrepo/snapshot_2\n```\n\n- \u7d50\u679c\n\n```js\n{\n  \"snapshots\": [\n    {\n      \"snapshot\": \"snapshot_2\",\n      \"uuid\": \"CULBcckJSzG1zqW-FC_JbA\",\n      \"version_id\": 5000051,\n      \"version\": \"5.0.0-rc1\",\n      \"indices\": [\n        \"logstash-2016.10.31\"\n      ],\n      \"state\": \"SUCCESS\",\n      \"start_time\": \"2016-11-01T07:45:52.381Z\",\n      \"start_time_in_millis\": 1477986352381,\n      \"end_time\": \"2016-11-01T07:45:52.958Z\",\n      \"end_time_in_millis\": 1477986352958,\n      \"duration_in_millis\": 577,\n      \"failures\": [],\n      \"shards\": {\n        \"total\": 5,\n        \"failed\": 0,\n        \"successful\": 5\n      }\n    }\n  ]\n}\n```\n\n## \u53e4\u3044\u30c7\u30fc\u30bf\u3092\u524a\u9664\n\n10/26\u306e\u30c7\u30fc\u30bf\u3092\u524a\u9664\u3057\u307e\u3057\u3087\u3046\u3002\n![23.png](https://qiita-image-store.s3.amazonaws.com/0/68978/b9a7a15d-af07-199f-f41f-fd7d68cd66a4.png)\n\n\u524a\u9664\u524d\u306e\u30c7\u30fc\u30bf\u30b5\u30a4\u30ba\u306f\u3053\u3061\u3089\u3002\n![27.png](https://qiita-image-store.s3.amazonaws.com/0/68978/bba16f33-ad44-8efa-f0cd-ff0450502445.png)\n\n- \u30ea\u30af\u30a8\u30b9\u30c8\n\n```js\nDELETE /logstash-2016.10.26\n```\n\n- \u7d50\u679c\n\n```js\n{\n  \"acknowledged\": true\n}\n```\n\n10/26\u306e\u30c7\u30fc\u30bf\u304c\u524a\u9664\u3055\u308c\u307e\u3057\u305f\u3002\u3053\u308c\u3067\u30b9\u30c8\u30ec\u30fc\u30b8\u304c\u7a7a\u304d\u307e\u3057\u305f\u3002\n![24.png](https://qiita-image-store.s3.amazonaws.com/0/68978/4931ee14-f229-0515-fe3f-aad58dd7b80f.png)\n![25.png](https://qiita-image-store.s3.amazonaws.com/0/68978/84772e97-e4ab-3170-de5c-9edc225793a9.png)\n\n\n## \u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u306e\u30ea\u30b9\u30c8\u30a2\n\n\u30ea\u30b9\u30c8\u30a2\u3067\u304d\u308b\u304b\u78ba\u8a8d\u3057\u307e\u3057\u3087\u3046\u3002\n\u5168\u4f53\u306e\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u304b\u3089\u3001\u7279\u5b9a\u306e\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u3060\u3051\u5fa9\u5143\u3057\u307e\u3059\u3002\n\n- \u30ea\u30af\u30a8\u30b9\u30c8\n\n```js\nPOST /_snapshot/myrepo/snapshot_1/_restore\n{\n  \"indices\": \"logstash-2016.10.26\"\n}\n```\n\n- \u7d50\u679c\n\n```js\n{\n  \"accepted\": true\n}\n```\n\n10/26\u306e\u30c7\u30fc\u30bf\u304c\u5e30\u3063\u3066\u304d\u307e\u3057\u305f\uff01\n![26.png](https://qiita-image-store.s3.amazonaws.com/0/68978/1f8f7721-366d-f6a4-c871-4e565eec93f3.png)\n\n\u30b9\u30c8\u30ec\u30fc\u30b8\u3082\u6d88\u8cbb\u3057\u3066\u3044\u307e\u3059\u3002\n![27.png](https://qiita-image-store.s3.amazonaws.com/0/68978/30097d0a-3796-5d43-a10b-c4d5920dcbde.png)\n\n\n\u3061\u306a\u307f\u306b\u3001\u5b58\u5728\u3059\u308b\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u3092\u5fa9\u5143\u3057\u3088\u3046\u3068\u3059\u308b\u3068\u3001\u6b21\u306e\u3088\u3046\u306a\u30a8\u30e9\u30fc\u306b\u306a\u308a\u307e\u3059\u3002\n\n```js\n{\n  \"error\": {\n    \"root_cause\": [\n      {\n        \"type\": \"snapshot_restore_exception\",\n        \"reason\": \"[myrepo:snapshot_1/xAXb0VBlSieLkVpFsgpr2Q] cannot restore index [.kibana] because it's open\"\n      }\n    ],\n    \"type\": \"snapshot_restore_exception\",\n    \"reason\": \"[myrepo:snapshot_1/xAXb0VBlSieLkVpFsgpr2Q] cannot restore index [.kibana] because it's open\"\n  },\n  \"status\": 500\n}\n```\n\n## \u307e\u3068\u3081\n\n1\u304b\u6708\u4ee5\u4e0a\u524d\u306a\u3069\u306e\u53e4\u3044\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u306f\u3001\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u3092\u64ae\u3063\u3066\u304b\u3089\u524a\u9664\u3059\u308b\u3053\u3068\u3067\u3001\u30b9\u30c8\u30ec\u30fc\u30b8\u3092\u78ba\u4fdd\u3067\u304d\u307e\u3059\u306d\u3002\n\u30ea\u30b9\u30c8\u30a2\u3082\u53ef\u80fd\u3067\u3059\u3002\n\n\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u306e\u30d5\u30a1\u30a4\u30eb\u3092\u3001\u30d5\u30a1\u30a4\u30eb\u30b7\u30b9\u30c6\u30e0\u3068\u3057\u3066\u79fb\u52d5\u3059\u308b\u308f\u3051\u3067\u306f\u306a\u3055\u305d\u3046\u306a\u306e\u3067\u3001NAS\u7b49\u306b\u30ea\u30dd\u30b8\u30c8\u30ea\u3092\u4f5c\u308b\u306e\u304c\u30d9\u30b9\u30c8\u306a\u3093\u3067\u3057\u3087\u3046\u304b\u306d\uff1f\n\n\u3061\u306a\u307f\u306bElasticsearch\u30d0\u30fc\u30b8\u30e7\u30f3\u30a2\u30c3\u30d7\u306e\u305f\u3081\u306e\u30d0\u30c3\u30af\u30a2\u30c3\u30d7\u30fb\u30ea\u30b9\u30c8\u30a2\u306b\u3064\u3044\u3066\u306f\u3001[\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u306e\u4e92\u63db\u6027\u306b\u5236\u9650](https://www.elastic.co/guide/en/elasticsearch/reference/current/modules-snapshots.html#modules-snapshots)\u304c\u3042\u308b\u306e\u3067\u3001\u78ba\u8a8d\u3057\u305f\u307b\u3046\u304c\u3088\u3044\u3067\u3057\u3087\u3046\u3002\n\n\n## \u304a\u307e\u3051\uff1apath.repo\n\n\u30de\u30cb\u30e5\u30a2\u30eb\u307f\u308b\u3068\u3001\n\n```js\npath.repo: [\"/mount/backups\", \"/mount/longterm_backups\"]\n```\n\u307f\u305f\u3044\u306b\u30d1\u30b9\u306e\u7701\u7565\u304c\u3067\u304d\u308b\u3063\u307d\u3044\u3002\n\u30ea\u30d7\u30ec\u30fc\u30b9\u7684\u306b\u4f7f\u3048\u308b\u304b\uff1f\u3084\u3063\u3066\u307f\u305f\u3002\n\n### \u305d\u306e\uff11\n\n```js:elasticsearch.yml\npath.repo: [\"repositories\", \"C:\\\\dev\\\\elastic-rc1\\\\elasticsearch-5.0.0-rc1\\\\repositories\"]\n```\n\n\uff0b\n\n```js\nPUT /_snapshot/myrepo1\n{\n  \"type\": \"fs\",\n  \"settings\": {\n    \"location\": \"repositories/myrepo1\n  }\n}\n```\n\n=\n\n```js\nC:\\dev\\elastic-rc1\\elasticsearch-5.0.0-rc1\\repositories\\repositories\\myrepo1\n```\n\noh...\n\n### \u305d\u306e\uff12\n\n```js:elasticsearch.yml\npath.repo: [\"C:\\\\repositories\", \"C:\\\\dev\\\\elastic-rc1\\\\elasticsearch-5.0.0-rc1\\\\repositories\"]\n```\n\nOR\n\n```js:elasticsearch.yml\npath.repo: [\"/repositories\", \"C:\\\\dev\\\\elastic-rc1\\\\elasticsearch-5.0.0-rc1\\\\repositories\"]\n```\n\n=\nElasticsearch\u3092\u8d77\u52d5\u3057\u305f\u30bf\u30a4\u30df\u30f3\u30b0\u3067\u3001\u6b21\u306e\u30d5\u30a9\u30eb\u30c0\u304c\u3067\u304d\u305f\u3002\n\n```js\nC:\\repositories\n```\n\n\u305d\u306e\uff11\u306f\u306a\u3093\u3068\u306a\u304f\u7406\u89e3\u3067\u304d\u308b\u3051\u3069\u3001\u305d\u306e\uff12\u306f\u30de\u30cb\u30e5\u30a2\u30eb\u901a\u308a\u306b\u306a\u3063\u3066\u306a\u3055\u305d\u3046\u3067\u6c17\u6301\u3061\u60aa\u3044\u3002Windows\u3060\u3051\u304b\uff1f\n\u3068\u308a\u3042\u3048\u305a\u3001`path.repo`\u306f\u30ea\u30dd\u30b8\u30c8\u30ea\u306b\u3057\u305f\u3044\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3060\u3051\u6307\u5b9a\u3059\u308b\u306e\u304c\u3088\u3055\u305d\u3046\u3002\n\n## \u53c2\u8003\n\n[Snapshot And Restore | Elasticsearch Reference [5.0] | Elastic](https://www.elastic.co/guide/en/elasticsearch/reference/current/modules-snapshots.html)\n\n\n", "tags": ["Elasticsearch", "kibana"]}