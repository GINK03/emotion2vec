{"context": " More than 1 year has passed since last update.\u25bc\u3055\u304f\u3089\u306eVPS\u306bSSH\u3067\u63a5\u7d9a\u3057\u307e\u3059\u3002\n$ ssh root@[IP\u30a2\u30c9\u30ec\u30b9]\n\u25bc\u30b7\u30b9\u30c6\u30e0\u3092\u6700\u65b0\u306e\u72b6\u614b\u306b\u3002\n\nyum update\n\u25bc\u65e5\u672c\u8a9e\u5316\n\nvim /etc/sysconfig/i18n\nLANG=\"ja_JP.UTF-8\"\n\u25bc\u4f5c\u696d\u7528\u30e6\u30fc\u30b6\u4f5c\u6210\n\nuseradd [\u4f5c\u696d\u7528\u30e6\u30fc\u30b6\u30fc\u540d]\n\u4f5c\u696d\u7528\u30e6\u30fc\u30b6\u306e\u30d1\u30b9\u30ef\u30fc\u30c9\u3092\u8a2d\u5b9a\n\npasswd [\u4f5c\u696d\u7528\u30e6\u30fc\u30b6\u30fc\u540d]\nwheel\u30b0\u30eb\u30fc\u30d7\u306b\u8ffd\u52a0\n\nusermod -G wheel [\u4f5c\u696d\u7528\u30e6\u30fc\u30b6\u30fc\u540d]\nwheel\u30b0\u30eb\u30fc\u30d7\u306e\u30e6\u30fc\u30b6\u30fc\u304csudo\u30b3\u30de\u30f3\u30c9\u3092\u4f7f\u3048\u308b\u3088\u3046\u306b\u8a2d\u5b9a\n\nvisudo\n\n%wheel ALL=(ALL) ALL\u3068\u3044\u3046\u6587\u3092\u63a2\u3057\u3001\u30b3\u30e1\u30f3\u30c8\u30a2\u30a6\u30c8\u3092\u89e3\u9664\n%wheel ALL=(ALL) ALL\nscp \n\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u5074\uff08\u81ea\u5206\u306e\u30d1\u30bd\u30b3\u30f3\uff09\u306b\u623b\u308a\u3001\u4f5c\u6210\u3057\u305f\u30e6\u30fc\u30b6\u30fc\u3067\u30ed\u30b0\u30a4\u30f3\u3067\u304d\u308b\u304b\u78ba\u8a8d\n$ ssh [\u30e6\u30fc\u30b6\u30fc\u540d]@[IP\u30a2\u30c9\u30ec\u30b9]\n\u25bc\u9375\u8a8d\u8a3c\u3092\u8a2d\u5b9a\n\u2606\u3055\u304f\u3089VPS\u306e\u30db\u30fc\u30e0\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u9375\u306e\u4fdd\u7ba1\u5834\u6240\n$ pwd\n/home/[\u30e6\u30fc\u30b6\u30fc\u540d]\n$ mkdir ~/.ssh\n$ chmod 700 ~/.ssh\n\u2605\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u5074\uff08\u81ea\u5206\u306e\u30d1\u30bd\u30b3\u30f3\uff09\u3067\u306e\u4f5c\u696d\n\u9375\u306e\u30da\u30a2\u3092\u751f\u6210\uff08\u79d8\u5bc6\u9375\u3001\u516c\u958b\u9375\uff09\n\nssh-keygen -t rsa -v\n\u8cea\u554f\u306b\u306f\u3059\u3079\u3066\u30a8\u30f3\u30bf\u30fc\u30ad\u30fc\u3067OK\n\n\u516c\u958b\u9375\u306e\u30d1\u30fc\u30df\u30c3\u30b7\u30e7\u30f3\u3092\u5909\u66f4\n\nchmod 600 ~/.ssh/id_rsa.pub\n\nscp\u30b3\u30de\u30f3\u30c9\u3067\u516c\u958b\u9375\u3092authorized_keys\u3068\u3044\u3046\u30d5\u30a1\u30a4\u30eb\u540d\u3067\u3055\u304f\u3089\u306eVPS\u5074\u306b\u8ee2\u9001\n\nscp ~/.ssh/id_rsa.pub [\u30e6\u30fc\u30b6\u30fc\u540d]@[\u30a2\u30c9\u30ec\u30b9]:~/.ssh/authorized_keys\n\n\u2606\u3055\u304f\u3089VPS\n\u516c\u958b\u9375\u304c\u304d\u3061\u3093\u3068\u8ee2\u9001\u3067\u304d\u3066\u3044\u308b\u304b\u78ba\u8a8d\n$ ls -la .ssh\n\u2605\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u5074\n\u516c\u958b\u9375\u3067\u30ed\u30b0\u30a4\u30f3\u3067\u304d\u308b\u304b\u3092\u78ba\u8a8d\n\nssh -i ~/.ssh/id_rsa [\u30e6\u30fc\u30b6\u30fc\u540d]@[IP\u30a2\u30c9\u30ec\u30b9]\n\u30d1\u30b9\u30ef\u30fc\u30c9\u3092\u805e\u304b\u308c\u305a\u306b\u30ed\u30b0\u30a4\u30f3\u3067\u304d\u308c\u3070\u6210\u529f\uff01\n\n\u25bcSSH\u306e\u8a2d\u5b9a\n\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3092\u30d0\u30c3\u30af\u30a2\u30c3\u30d7\n\ncp /etc/ssh/{sshd_config,sshd_config.bk}\n\u7de8\u96c6\n\nvim /etc/ssh/sshd_config\n\n\u30dd\u30fc\u30c8\u756a\u53f7\u3092\u30c7\u30d5\u30a9\u30eb\u30c8\u304b\u3089\u5909\u66f4[\u8a2d\u5b9a\u7bc4\u56f2\uff1a22 - 65535]\nPort 10022\n\n\u30d1\u30b9\u30ef\u30fc\u30c9\u30ed\u30b0\u30a4\u30f3\u306e\u7981\u6b62\nPasswordAuthentication no\n\nroot\u30ed\u30b0\u30a4\u30f3\u306e\u7981\u6b62\nPermitRootLogin no\n\u8a2d\u5b9a\u3092\u53cd\u6620\n\nservice sshd restart\n\u2605\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u5074\n\u30ed\u30b0\u30a4\u30f3\u3067\u304d\u308b\u304b\u3092\u78ba\u8a8d\n\nssh -p [\u30dd\u30fc\u30c8\u756a\u53f7] [\u30e6\u30fc\u30b6\u30fc\u540d]@[IP\u30a2\u30c9\u30ec\u30b9]\n\n\u25bc\u30d5\u30a1\u30a4\u30a2\u30fc\u30a6\u30a9\u30fc\u30eb\u3092\u8a2d\u5b9a\niptables\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u6210\n\nvim /etc/sysconfig/iptables\n*filter\n:INPUT ACCEPT [0:0]\n:FORWARD ACCEPT [0:0]\n:OUTPUT ACCEPT [0:0]\n:RH-Firewall-1-INPUT - [0:0]\n-A INPUT -j RH-Firewall-1-INPUT\n-A FORWARD -j RH-Firewall-1-INPUT\n-A RH-Firewall-1-INPUT -i lo -j ACCEPT\n-A RH-Firewall-1-INPUT -p icmp --icmp-type any -j ACCEPT\n-A RH-Firewall-1-INPUT -p 50 -j ACCEPT\n-A RH-Firewall-1-INPUT -p 51 -j ACCEPT\n-A RH-Firewall-1-INPUT -p udp --dport 5353 -d 224.0.0.251 -j ACCEPT\n-A RH-Firewall-1-INPUT -p udp -m udp --dport 631 -j ACCEPT\n-A RH-Firewall-1-INPUT -p tcp -m tcp --dport 631 -j ACCEPT\n-A RH-Firewall-1-INPUT -m state --state ESTABLISHED,RELATED -j ACCEPT\n\nSSH, HTTP, FTP1, FTP2, MySQL\n-A RH-Firewall-1-INPUT -m state --state NEW -m tcp -p tcp --dport 10022 -j ACCEPT\n-A RH-Firewall-1-INPUT -m state --state NEW -m tcp -p tcp --dport 80 -j ACCEPT\n-A RH-Firewall-1-INPUT -m state --state NEW -m tcp -p tcp --dport 20 -j ACCEPT\n-A RH-Firewall-1-INPUT -m state --state NEW -m tcp -p tcp --dport 21 -j ACCEPT\n-A RH-Firewall-1-INPUT -m state --state NEW -m tcp -p tcp --dport 3306 -j ACCEPT\n-A RH-Firewall-1-INPUT -j REJECT --reject-with icmp-host-prohibited\nCOMMIT\n\u8a2d\u5b9a\u3092\u53cd\u6620\u3059\u308b\n\uff03 service iptables start\n\u8a2d\u5b9a\u3092\u78ba\u8a8d\u3059\u308b\n\niptables -L\n\u81ea\u52d5\u8d77\u52d5\u306e\u8a2d\u5b9a\u3092\u78ba\u8a8d\n$ chkconfig iptables --list\niptables        0:off   1:off   2:on    3:on    4:on    5:on    6:off\n\u201d3:off\u201d\u3068\u3044\u3046\u8868\u793a\u3060\u3063\u305f\u5834\u5408\u3001\u81ea\u52d5\u3067\u8d77\u52d5\u3059\u308b\u3088\u3046\u306b\u8a2d\u5b9a\n\nchkconfig iptables on\n\n\u25bc\u3055\u304f\u3089\u306eVPS\u306bSSH\u3067\u63a5\u7d9a\u3057\u307e\u3059\u3002\n$ ssh root@[IP\u30a2\u30c9\u30ec\u30b9]\n\n\u25bc\u30b7\u30b9\u30c6\u30e0\u3092\u6700\u65b0\u306e\u72b6\u614b\u306b\u3002\n# yum update\n\n\u25bc\u65e5\u672c\u8a9e\u5316\n# vim /etc/sysconfig/i18n\nLANG=\"ja_JP.UTF-8\"\n\n\u25bc\u4f5c\u696d\u7528\u30e6\u30fc\u30b6\u4f5c\u6210\n# useradd [\u4f5c\u696d\u7528\u30e6\u30fc\u30b6\u30fc\u540d]\n\u4f5c\u696d\u7528\u30e6\u30fc\u30b6\u306e\u30d1\u30b9\u30ef\u30fc\u30c9\u3092\u8a2d\u5b9a\n# passwd [\u4f5c\u696d\u7528\u30e6\u30fc\u30b6\u30fc\u540d]\nwheel\u30b0\u30eb\u30fc\u30d7\u306b\u8ffd\u52a0\n# usermod -G wheel [\u4f5c\u696d\u7528\u30e6\u30fc\u30b6\u30fc\u540d]\nwheel\u30b0\u30eb\u30fc\u30d7\u306e\u30e6\u30fc\u30b6\u30fc\u304csudo\u30b3\u30de\u30f3\u30c9\u3092\u4f7f\u3048\u308b\u3088\u3046\u306b\u8a2d\u5b9a\n# visudo\n#%wheel ALL=(ALL) ALL\u3068\u3044\u3046\u6587\u3092\u63a2\u3057\u3001\u30b3\u30e1\u30f3\u30c8\u30a2\u30a6\u30c8\u3092\u89e3\u9664\n%wheel ALL=(ALL) ALL\nscp \n\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u5074\uff08\u81ea\u5206\u306e\u30d1\u30bd\u30b3\u30f3\uff09\u306b\u623b\u308a\u3001\u4f5c\u6210\u3057\u305f\u30e6\u30fc\u30b6\u30fc\u3067\u30ed\u30b0\u30a4\u30f3\u3067\u304d\u308b\u304b\u78ba\u8a8d\n$ ssh [\u30e6\u30fc\u30b6\u30fc\u540d]@[IP\u30a2\u30c9\u30ec\u30b9]\n\n\u25bc\u9375\u8a8d\u8a3c\u3092\u8a2d\u5b9a\n\u2606\u3055\u304f\u3089VPS\u306e\u30db\u30fc\u30e0\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u9375\u306e\u4fdd\u7ba1\u5834\u6240\n$ pwd\n/home/[\u30e6\u30fc\u30b6\u30fc\u540d]\n$ mkdir ~/.ssh\n$ chmod 700 ~/.ssh\n\n\u2605\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u5074\uff08\u81ea\u5206\u306e\u30d1\u30bd\u30b3\u30f3\uff09\u3067\u306e\u4f5c\u696d\n\u9375\u306e\u30da\u30a2\u3092\u751f\u6210\uff08\u79d8\u5bc6\u9375\u3001\u516c\u958b\u9375\uff09\n> ssh-keygen -t rsa -v\n\u8cea\u554f\u306b\u306f\u3059\u3079\u3066\u30a8\u30f3\u30bf\u30fc\u30ad\u30fc\u3067OK\n\n\u516c\u958b\u9375\u306e\u30d1\u30fc\u30df\u30c3\u30b7\u30e7\u30f3\u3092\u5909\u66f4\n> chmod 600 ~/.ssh/id_rsa.pub\n\nscp\u30b3\u30de\u30f3\u30c9\u3067\u516c\u958b\u9375\u3092authorized_keys\u3068\u3044\u3046\u30d5\u30a1\u30a4\u30eb\u540d\u3067\u3055\u304f\u3089\u306eVPS\u5074\u306b\u8ee2\u9001\n> scp ~/.ssh/id_rsa.pub [\u30e6\u30fc\u30b6\u30fc\u540d]@[\u30a2\u30c9\u30ec\u30b9]:~/.ssh/authorized_keys\n\n\u2606\u3055\u304f\u3089VPS\n\u516c\u958b\u9375\u304c\u304d\u3061\u3093\u3068\u8ee2\u9001\u3067\u304d\u3066\u3044\u308b\u304b\u78ba\u8a8d\n$ ls -la .ssh\n\n\u2605\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u5074\n\u516c\u958b\u9375\u3067\u30ed\u30b0\u30a4\u30f3\u3067\u304d\u308b\u304b\u3092\u78ba\u8a8d\n> ssh -i ~/.ssh/id_rsa [\u30e6\u30fc\u30b6\u30fc\u540d]@[IP\u30a2\u30c9\u30ec\u30b9]\n\u30d1\u30b9\u30ef\u30fc\u30c9\u3092\u805e\u304b\u308c\u305a\u306b\u30ed\u30b0\u30a4\u30f3\u3067\u304d\u308c\u3070\u6210\u529f\uff01\n\n\u25bcSSH\u306e\u8a2d\u5b9a\n\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3092\u30d0\u30c3\u30af\u30a2\u30c3\u30d7\n# cp /etc/ssh/{sshd_config,sshd_config.bk}\n\n\u7de8\u96c6\n#vim /etc/ssh/sshd_config\n# \u30dd\u30fc\u30c8\u756a\u53f7\u3092\u30c7\u30d5\u30a9\u30eb\u30c8\u304b\u3089\u5909\u66f4[\u8a2d\u5b9a\u7bc4\u56f2\uff1a22 - 65535]\nPort 10022\n# \u30d1\u30b9\u30ef\u30fc\u30c9\u30ed\u30b0\u30a4\u30f3\u306e\u7981\u6b62\nPasswordAuthentication no\n# root\u30ed\u30b0\u30a4\u30f3\u306e\u7981\u6b62\nPermitRootLogin no\n\n\u8a2d\u5b9a\u3092\u53cd\u6620\n# service sshd restart\n\n\u2605\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u5074\n\u30ed\u30b0\u30a4\u30f3\u3067\u304d\u308b\u304b\u3092\u78ba\u8a8d\n> ssh -p [\u30dd\u30fc\u30c8\u756a\u53f7] [\u30e6\u30fc\u30b6\u30fc\u540d]@[IP\u30a2\u30c9\u30ec\u30b9]\n\n\u25bc\u30d5\u30a1\u30a4\u30a2\u30fc\u30a6\u30a9\u30fc\u30eb\u3092\u8a2d\u5b9a\niptables\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u6210\n# vim /etc/sysconfig/iptables\n*filter\n:INPUT ACCEPT [0:0]\n:FORWARD ACCEPT [0:0]\n:OUTPUT ACCEPT [0:0]\n:RH-Firewall-1-INPUT - [0:0]\n-A INPUT -j RH-Firewall-1-INPUT\n-A FORWARD -j RH-Firewall-1-INPUT\n-A RH-Firewall-1-INPUT -i lo -j ACCEPT\n-A RH-Firewall-1-INPUT -p icmp --icmp-type any -j ACCEPT\n-A RH-Firewall-1-INPUT -p 50 -j ACCEPT\n-A RH-Firewall-1-INPUT -p 51 -j ACCEPT\n-A RH-Firewall-1-INPUT -p udp --dport 5353 -d 224.0.0.251 -j ACCEPT\n-A RH-Firewall-1-INPUT -p udp -m udp --dport 631 -j ACCEPT\n-A RH-Firewall-1-INPUT -p tcp -m tcp --dport 631 -j ACCEPT\n-A RH-Firewall-1-INPUT -m state --state ESTABLISHED,RELATED -j ACCEPT\n# SSH, HTTP, FTP1, FTP2, MySQL\n-A RH-Firewall-1-INPUT -m state --state NEW -m tcp -p tcp --dport 10022 -j ACCEPT\n-A RH-Firewall-1-INPUT -m state --state NEW -m tcp -p tcp --dport 80 -j ACCEPT\n-A RH-Firewall-1-INPUT -m state --state NEW -m tcp -p tcp --dport 20 -j ACCEPT\n-A RH-Firewall-1-INPUT -m state --state NEW -m tcp -p tcp --dport 21 -j ACCEPT\n-A RH-Firewall-1-INPUT -m state --state NEW -m tcp -p tcp --dport 3306 -j ACCEPT\n-A RH-Firewall-1-INPUT -j REJECT --reject-with icmp-host-prohibited\nCOMMIT\n\n\u8a2d\u5b9a\u3092\u53cd\u6620\u3059\u308b\n\uff03 service iptables start\n\n\u8a2d\u5b9a\u3092\u78ba\u8a8d\u3059\u308b\n# iptables -L\n\n\u81ea\u52d5\u8d77\u52d5\u306e\u8a2d\u5b9a\u3092\u78ba\u8a8d\n$ chkconfig iptables --list\niptables        0:off   1:off   2:on    3:on    4:on    5:on    6:off\n\n\u201d3:off\u201d\u3068\u3044\u3046\u8868\u793a\u3060\u3063\u305f\u5834\u5408\u3001\u81ea\u52d5\u3067\u8d77\u52d5\u3059\u308b\u3088\u3046\u306b\u8a2d\u5b9a\n# chkconfig iptables on\n", "tags": ["\u3055\u304f\u3089\u306eVPS"]}