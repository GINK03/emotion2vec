{"context": "\n\n\u524d\u63d0\u6761\u4ef6\n\nCentOS7 on Vagrant (IP:192.168.33.10)\ndocker-compose  version:1.13.1:\ndocker version: 1.10.2\n\n\n\u307e\u305a\u306fnginx\u5358\u72ec\u3067\n\n./nginx/Dockerfile\n#\u516c\u5f0f\u30a4\u30e1\u30fc\u30b8\u3067\u3082\u826f\u3044\u304c\u5909\u66f4\u3092\u8003\u616e\u3057\u3066Dockerfile\u306b\u3066\u5b9f\u65bd\nFROM nginx:1.11\n\n\n\n./nginx/conf.d/nginx.conf\n# Configuration for the server\nserver {\n    listen       8080;\n    server_name  localhost;\n    root   /usr/share/nginx/html;\n\n    location / {\n        index  index.html index.htm;\n    }\n\n    error_page   500 502 503 504  /50x.html;\n    location = /50x.html {\n        root   /usr/share/nginx/html;\n    }\n\n    location ~ /\\.ht {\n        deny  all;\n    }\n}\n\n\n\ndocker-compose.yml\nversion: '2'\nservices:\n  nginx:\n    build: nginx/\n    hostname: ng01\n    ports:\n      - 8080:8080\n    volumes:\n      - ./nginx/conf.d:/etc/nginx/conf.d\n      - ./nginx/log:/var/log/nginx\n    container_name: nginx01\n\n\n\u3053\u308c\u3067\u3068\u308a\u3042\u3048\u305a\u8d77\u52d5\u3059\u308b\u3068\n\ndocker-compose up -d\n\nhttp://192.168.33.10:8080/\n\u306b\u3066nginx\u306ehome\u3078\u30a2\u30af\u30bb\u30b9\u53ef\u80fd\n\nnginx with tomcat\n\nDockerfile\n\n./tomcat/Dockerfile\nFROM tomcat:8.5\n\n\n\ntomcat(app) \u306f8090\u30dd\u30fc\u30c8\u3067\u9023\u643a\u3059\u308b\u3002\n\u4eca\u306eversion\u3067\u306flinks\u306e\u5b9a\u7fa9\u306f\u4e0d\u8981. nginx01 container \u304b\u3089ping app/app01\u304c\u53ef\u80fd\n\ndocker-compose.yml\nversion: '2'\nservices:\n  nginx:\n    build: nginx/\n    hostname: ng01\n    ports:\n      - 8080:8080\n    volumes:\n      - ./nginx/conf.d:/etc/nginx/conf.d\n      - ./nginx/log:/var/log/nginx\n    container_name: nginx01\n  app:\n    build: tomcat/\n    hostname: appserver\n    ports:\n      - 8090:8090\n    volumes:\n      - ./tomcat/conf:/usr/local/tomcat/conf\n      - ./tomcat/log:/usr/local/tomcat/log\n    container_name: app01\n\n\n\nnginx\u306econf\u306b\u4fee\u6b63\u3092\u52a0\u3048\u308b\u3002\n\n./nginx/conf.d/nginx.conf\n# Configuration for the server\n    ....\n    location / {\n        #\u4ee5\u4e0b\u306e\uff11\u884c\u8ffd\u52a0(container_name\u306eapp01\u3067\u3082OK)\n        proxy_pass http://app:8090;\n        index  index.html index.htm;\n    }\n    ....\n}\n\n\n\ntomcat \u306eserver.xml \u306e\u30dd\u30fc\u30c8\u30828080->8090\u306b\u4fee\u6b63\n\n./tomcat/conf/server.xml\n....\n<Connector port=\"8090\" protocol=\"HTTP/1.1\"\n         connectionTimeout=\"20000\"\n         redirectPort=\"8443\" />\n\n\nhttp://192.168.33.10:8080/\n\u306b\u30a2\u30af\u30bb\u30b9\u3057\u3066\u307f\u308b\u3068\u4eca\u5ea6\u306ftomcat home\u304c\u898b\u3048\u308b\u306f\u305a\u3002\n##\u524d\u63d0\u6761\u4ef6\n\n  - CentOS7 on Vagrant (IP:192.168.33.10)\n  - docker-compose  version:1.13.1:\n  - docker version: 1.10.2\n\n##\u307e\u305a\u306fnginx\u5358\u72ec\u3067\n\n```:./nginx/Dockerfile\n#\u516c\u5f0f\u30a4\u30e1\u30fc\u30b8\u3067\u3082\u826f\u3044\u304c\u5909\u66f4\u3092\u8003\u616e\u3057\u3066Dockerfile\u306b\u3066\u5b9f\u65bd\nFROM nginx:1.11\n```\n\n```nginx:./nginx/conf.d/nginx.conf\n# Configuration for the server\nserver {\n    listen       8080;\n    server_name  localhost;\n    root   /usr/share/nginx/html;\n\n    location / {\n        index  index.html index.htm;\n    }\n\n    error_page   500 502 503 504  /50x.html;\n    location = /50x.html {\n        root   /usr/share/nginx/html;\n    }\n\n    location ~ /\\.ht {\n        deny  all;\n    }\n}\n```\n\n```yaml:docker-compose.yml\nversion: '2'\nservices:\n  nginx:\n    build: nginx/\n    hostname: ng01\n    ports:\n      - 8080:8080\n    volumes:\n      - ./nginx/conf.d:/etc/nginx/conf.d\n      - ./nginx/log:/var/log/nginx\n    container_name: nginx01\n```\n\n\u3053\u308c\u3067\u3068\u308a\u3042\u3048\u305a\u8d77\u52d5\u3059\u308b\u3068\n```\ndocker-compose up -d\n```\nhttp://192.168.33.10:8080/\n\u306b\u3066nginx\u306ehome\u3078\u30a2\u30af\u30bb\u30b9\u53ef\u80fd\n\n## nginx with tomcat\n\n###Dockerfile\n```:./tomcat/Dockerfile\nFROM tomcat:8.5\n```\n\n### tomcat(app) \u306f8090\u30dd\u30fc\u30c8\u3067\u9023\u643a\u3059\u308b\u3002\n*\u4eca\u306eversion\u3067\u306flinks\u306e\u5b9a\u7fa9\u306f\u4e0d\u8981. nginx01 container \u304b\u3089ping app/app01\u304c\u53ef\u80fd*\n\n```yaml:docker-compose.yml\nversion: '2'\nservices:\n  nginx:\n    build: nginx/\n    hostname: ng01\n    ports:\n      - 8080:8080\n    volumes:\n      - ./nginx/conf.d:/etc/nginx/conf.d\n      - ./nginx/log:/var/log/nginx\n    container_name: nginx01\n  app:\n    build: tomcat/\n    hostname: appserver\n    ports:\n      - 8090:8090\n    volumes:\n      - ./tomcat/conf:/usr/local/tomcat/conf\n      - ./tomcat/log:/usr/local/tomcat/log\n    container_name: app01\n```\n\n###nginx\u306econf\u306b\u4fee\u6b63\u3092\u52a0\u3048\u308b\u3002\n\n```nginx:./nginx/conf.d/nginx.conf\n# Configuration for the server\n    ....\n    location / {\n        #\u4ee5\u4e0b\u306e\uff11\u884c\u8ffd\u52a0(container_name\u306eapp01\u3067\u3082OK)\n        proxy_pass http://app:8090;\n        index  index.html index.htm;\n    }\n    ....\n}\n```\n\n### tomcat \u306eserver.xml \u306e\u30dd\u30fc\u30c8\u30828080->8090\u306b\u4fee\u6b63\n\n```xml:./tomcat/conf/server.xml\n....\n<Connector port=\"8090\" protocol=\"HTTP/1.1\"\n         connectionTimeout=\"20000\"\n         redirectPort=\"8443\" />\n```\n\nhttp://192.168.33.10:8080/\n\u306b\u30a2\u30af\u30bb\u30b9\u3057\u3066\u307f\u308b\u3068\u4eca\u5ea6\u306ftomcat home\u304c\u898b\u3048\u308b\u306f\u305a\u3002\n", "tags": ["docker-compose", "nginx", "Tomcat"]}