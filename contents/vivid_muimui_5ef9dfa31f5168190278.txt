{"tags": ["Ruby", "Rails", "rake"], "context": " More than 1 year has passed since last update.\n\n\u304a\u307e\u3058\u306a\u3044\ntask test: :environment do\n  # task\nend\n\nrails\u3067DB\u30a2\u30af\u30bb\u30b9\u3057\u305f\u308a\u3059\u308brake\u30bf\u30b9\u30af\u3092\u5b9a\u7fa9\u3059\u308b\u3068\u304d\u306b\u2191\u306e\u69d8\u306a\u611f\u3058\u3067:environment\u3092\u6307\u5b9a\u3059\u308b\u5fc5\u8981\u304c\u3042\u308b\u304c\u3001\n\u305d\u306e:environment\u304c\u4f55\u3092\u3057\u3066\u3044\u308b\u306e\u304b\u4e0d\u601d\u8b70\u3060\u3063\u305f\u306e\u3067\u8abf\u3079\u305f\n\n\u30b3\u30fc\u30c9\u3092\u8ffd\u3063\u3066\u307f\u305f(\u8981\u6240\u3060\u3051)\n# https://github.com/rails/rails/blob/master/railties/lib/rails/application.rb#L432-L441\ndef run_tasks_blocks(app) #:nodoc:\n  railties.each { |r| r.run_tasks_blocks(app) }\n  super\n  require \"rails/tasks\"\n  task :environment do\n    ActiveSupport.on_load(:before_initialize) { config.eager_load = false }\n\n    require_environment!\n  end\nend\n\nrails\u306e\u30b3\u30fc\u30c9\u5185\u306b\u5b9a\u7fa9\u3055\u308c\u3066\u3044\u308b\u3001\n:environment\u3068\u3044\u3046\u540d\u306erake\u30bf\u30b9\u30af\u304c\u547c\u3070\u308c\u308b\n# https://github.com/rails/rails/blob/master/railties/lib/rails/application.rb#L317-L320\ndef require_environment! #:nodoc:\n  environment = paths[\"config/environment\"].existent.first\n  require environment if environment\nend\n\nRails.root\u306b\u3042\u308bconfig/environment\u304crequire\u3055\u308c\u308b\n# config/environment.rb\n\n# Load the Rails application.\nrequire File.expand_path('../application', __FILE__)\n\n# Initialize the Rails application.\nRails.application.initialize!\n\nRails.application.initialize!\u304c\u547c\u3070\u308c\u308b\n\n\u307e\u3068\u3081\n\u4e09\u884c\u3067\u66f8\u304f\u3068\n:enviroment\u3068\u3044\u3046rake\u30bf\u30b9\u30af\u3092\u5b9f\u884c\u3057\u3066\nconfig/environment.rb\u3092require\u3057\u3066\nRails.application.initialize!\u3057\u3066\u305f\n\u306a\u306e\u3067\u3001DB\u3084\u30e2\u30c7\u30eb\u306b\u30a2\u30af\u30bb\u30b9\u3059\u308b\u3068\u304d\u4ee5\u5916\u306b\u3082\u4f7f\u3048\u308b\n# \u304a\u307e\u3058\u306a\u3044\n\n```rb\ntask test: :environment do\n  # task\nend\n```\n\nrails\u3067DB\u30a2\u30af\u30bb\u30b9\u3057\u305f\u308a\u3059\u308brake\u30bf\u30b9\u30af\u3092\u5b9a\u7fa9\u3059\u308b\u3068\u304d\u306b\u2191\u306e\u69d8\u306a\u611f\u3058\u3067`:environment`\u3092\u6307\u5b9a\u3059\u308b\u5fc5\u8981\u304c\u3042\u308b\u304c\u3001\n\u305d\u306e`:environment`\u304c\u4f55\u3092\u3057\u3066\u3044\u308b\u306e\u304b\u4e0d\u601d\u8b70\u3060\u3063\u305f\u306e\u3067\u8abf\u3079\u305f\n\n\n# \u30b3\u30fc\u30c9\u3092\u8ffd\u3063\u3066\u307f\u305f(\u8981\u6240\u3060\u3051)\n\n```rb\n# https://github.com/rails/rails/blob/master/railties/lib/rails/application.rb#L432-L441\ndef run_tasks_blocks(app) #:nodoc:\n  railties.each { |r| r.run_tasks_blocks(app) }\n  super\n  require \"rails/tasks\"\n  task :environment do\n    ActiveSupport.on_load(:before_initialize) { config.eager_load = false }\n\n    require_environment!\n  end\nend\n```\n\nrails\u306e\u30b3\u30fc\u30c9\u5185\u306b\u5b9a\u7fa9\u3055\u308c\u3066\u3044\u308b\u3001\n`:environment`\u3068\u3044\u3046\u540d\u306erake\u30bf\u30b9\u30af\u304c\u547c\u3070\u308c\u308b\n\n```rb\n# https://github.com/rails/rails/blob/master/railties/lib/rails/application.rb#L317-L320\ndef require_environment! #:nodoc:\n  environment = paths[\"config/environment\"].existent.first\n  require environment if environment\nend\n```\n\n`Rails.root`\u306b\u3042\u308b`config/environment`\u304c`require`\u3055\u308c\u308b\n\n```rb\n# config/environment.rb\n\n# Load the Rails application.\nrequire File.expand_path('../application', __FILE__)\n\n# Initialize the Rails application.\nRails.application.initialize!\n```\n\n`Rails.application.initialize!`\u304c\u547c\u3070\u308c\u308b\n\n\n# \u307e\u3068\u3081\n\n\u4e09\u884c\u3067\u66f8\u304f\u3068\n\n`:enviroment`\u3068\u3044\u3046rake\u30bf\u30b9\u30af\u3092\u5b9f\u884c\u3057\u3066\n`config/environment.rb`\u3092`require`\u3057\u3066\n`Rails.application.initialize!`\u3057\u3066\u305f\n\n\u306a\u306e\u3067\u3001DB\u3084\u30e2\u30c7\u30eb\u306b\u30a2\u30af\u30bb\u30b9\u3059\u308b\u3068\u304d\u4ee5\u5916\u306b\u3082\u4f7f\u3048\u308b\n"}