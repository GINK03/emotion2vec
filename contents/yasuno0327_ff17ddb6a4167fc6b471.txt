{"context": "devise\u306f\u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u306femail\u30ab\u30e9\u30e0\u3068password\u30ab\u30e9\u30e0\u3057\u304b\u6301\u3063\u3066\u3044\u306a\u3044\u305f\u3081username\u304c\u5165\u3063\u3066\u3044\u308b\u30a2\u30ab\u30a6\u30f3\u30c8\u60c5\u5831\u3092\u767b\u9332\u3067\u304d\u306a\u3044\u3002\ndevise\u3092\u4f7f\u3046\u969b\u306busername\u3092\u767b\u9332\u3067\u304d\u308b\u3088\u3046\u306b\u3057\u306a\u304f\u3066\u306f\u3044\u3051\u306a\u304f\u306a\u3063\u305f\u305f\u3081\u3001\u3084\u308a\u65b9\u3092\u30e1\u30e2\u3057\u3066\u3044\u304f\u3002\n\u307e\u305adevise\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\nGemfile\n\ngem 'devise', '4.1.1'\n\nterminal\nbundle install\n\nrails g devise install\nRunning via Spring preloader in process 30712\n      create  config/initializers/devise.rb\n      create  config/locales/devise.en.yml\n===============================================================================\n\nSome setup you must do manually if you haven't yet:\n\n  1. Ensure you have defined default url options in your environments files. Here\n     is an example of default_url_options appropriate for a development environment\n     in config/environments/development.rb:\n\n       config.action_mailer.default_url_options = { host: 'localhost', port: 3000 }\n\n     In production, :host should be set to the actual host of your application.\n\n  2. Ensure you have defined root_url to *something* in your config/routes.rb.\n     For example:\n\n       root to: \"home#index\"\n\n  3. Ensure you have flash messages in app/views/layouts/application.html.erb.\n     For example:\n\n       <p class=\"notice\"><%= notice %></p>\n       <p class=\"alert\"><%= alert %></p>\n\n  4. If you are deploying on Heroku with Rails 3.2 only, you may want to set:\n\n       config.assets.initialize_on_precompile = false\n\n     On config/application.rb forcing your application to not access the DB\n     or load models when precompiling your assets.\n\n  5. You can copy Devise views (for customization) to your app by running:\n\n       rails g devise:views\n\n===============================================================================\n\n\n\u30de\u30a4\u30b0\u30ec\u30fc\u30b7\u30e7\u30f3\u30d5\u30a1\u30a4\u30eb\u3092\u8ffd\u52a0\u3057\u3001username\u30ab\u30e9\u30e0\u3092\u8ffd\u52a0\u3057\u3066\u3044\u304d\u307e\u3059\u3002\nrails g migration add_username_to_users username:string\n\nrake db:migrate\n\n\u6b21\u306bstrong parameter\u306e\u8ffd\u52a0\n\napplication_controller.rb\nclass ApplicationController < ActionController::Base\n  protect_from_forgery with: :exception\n  before_action :configure_permitted_parameters, if: :devise_controller?\n\n  protected\n\n \u3000\u3000def configure_permitted_parameters\n    added_attrs = [ :username, :email, :password, :password_confirmation\u3000]\n    devise_parameter_sanitizer.permit :sign_up, keys: added_attrs\n    devise_parameter_sanitizer.permit :account_update, keys: added_attrs\n    devise_parameter_sanitizer.permit :sign_in, keys: added_attrs\n  end\nend\n\n\n\u53c2\u8003\nhttps://github.com/plataformatec/devise/wiki/How-To:-Allow-users-to-sign-in-using-their-username-or-email-address\n\u6b21\u306bview\u3092\u30ab\u30b9\u30bf\u30de\u30a4\u30ba\u3067\u304d\u308b\u3088\u3046\u306b\u3057\u3066\u3044\u304f\u3002\nrails g devise:views\n\n\ndevise.rb\n...\nconfig.scoped_views = true\n...\n\n\nview\u306busername\u6b04\u3092\u8ffd\u52a0\u3057\u3066\u3044\u304f\u3002\n\nviews/registrations/new.html.erb\n<h2>Sign up</h2>\n\n<%= form_for(resource, as: resource_name, url: registration_path(resource_name)) do |f| %>\n  <%= devise_error_messages! %>\n  <div class=\"field\">\n    <%= f.label :username %><br />\n    <%= f.text_field :username, autofocus: true %>\n  </div>\n\n  <div class=\"field\">\n    <%= f.label :email %><br />\n    <%= f.email_field :email, autofocus: true %>\n  </div>\n\n  <div class=\"field\">\n    <%= f.label :password %>\n    <% if @minimum_password_length %>\n    <em>(<%= @minimum_password_length %> characters minimum)</em>\n    <% end %><br />\n    <%= f.password_field :password, autocomplete: \"off\" %>\n  </div>\n\n  <div class=\"field\">\n    <%= f.label :password_confirmation %><br />\n    <%= f.password_field :password_confirmation, autocomplete: \"off\" %>\n  </div>\n\n  <div class=\"actions\">\n    <%= f.submit \"Sign up\" %>\n  </div>\n<% end %>\n\n<%= render \"devise/shared/links\" %>\n\n\n\u3053\u308c\u3067\u8868\u793a\u3057\u3066\u307f\u308b\u3068\n\n\u3046\u307e\u304f\u8868\u793a\u3067\u304d\u3066\u308b\u307f\u305f\u3044\u3067\u3059\u306d\u3002\n\u767b\u9332\u306f\u3069\u3046\u3060\u308d\u3046...\nsignup\u3057\u3066username\u3092\u8868\u793a\u3057\u3066\u307f\u308b\u3068\n\ntop_pages/show.html.erb\n<%= @user.username %>\n\n\n\n\u3046\u307e\u304f\u767b\u9332\u3067\u304d\u3066\u308b\u307f\u305f\u3044\u3067\u3059\u306d\uff01\n\u4ee5\u4e0a\n\ndevise\u306f\u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u306femail\u30ab\u30e9\u30e0\u3068password\u30ab\u30e9\u30e0\u3057\u304b\u6301\u3063\u3066\u3044\u306a\u3044\u305f\u3081username\u304c\u5165\u3063\u3066\u3044\u308b\u30a2\u30ab\u30a6\u30f3\u30c8\u60c5\u5831\u3092\u767b\u9332\u3067\u304d\u306a\u3044\u3002\n\ndevise\u3092\u4f7f\u3046\u969b\u306busername\u3092\u767b\u9332\u3067\u304d\u308b\u3088\u3046\u306b\u3057\u306a\u304f\u3066\u306f\u3044\u3051\u306a\u304f\u306a\u3063\u305f\u305f\u3081\u3001\u3084\u308a\u65b9\u3092\u30e1\u30e2\u3057\u3066\u3044\u304f\u3002\n\n\u307e\u305adevise\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\nGemfile\n```\ngem 'devise', '4.1.1'\n```\n\nterminal\n\n```\nbundle install\n```\n\n```\nrails g devise install\nRunning via Spring preloader in process 30712\n      create  config/initializers/devise.rb\n      create  config/locales/devise.en.yml\n===============================================================================\n\nSome setup you must do manually if you haven't yet:\n\n  1. Ensure you have defined default url options in your environments files. Here\n     is an example of default_url_options appropriate for a development environment\n     in config/environments/development.rb:\n\n       config.action_mailer.default_url_options = { host: 'localhost', port: 3000 }\n\n     In production, :host should be set to the actual host of your application.\n\n  2. Ensure you have defined root_url to *something* in your config/routes.rb.\n     For example:\n\n       root to: \"home#index\"\n\n  3. Ensure you have flash messages in app/views/layouts/application.html.erb.\n     For example:\n\n       <p class=\"notice\"><%= notice %></p>\n       <p class=\"alert\"><%= alert %></p>\n\n  4. If you are deploying on Heroku with Rails 3.2 only, you may want to set:\n\n       config.assets.initialize_on_precompile = false\n\n     On config/application.rb forcing your application to not access the DB\n     or load models when precompiling your assets.\n\n  5. You can copy Devise views (for customization) to your app by running:\n\n       rails g devise:views\n\n===============================================================================\n\n```\n\n\u30de\u30a4\u30b0\u30ec\u30fc\u30b7\u30e7\u30f3\u30d5\u30a1\u30a4\u30eb\u3092\u8ffd\u52a0\u3057\u3001username\u30ab\u30e9\u30e0\u3092\u8ffd\u52a0\u3057\u3066\u3044\u304d\u307e\u3059\u3002\n\n```\nrails g migration add_username_to_users username:string\n\nrake db:migrate\n```\n\n\u6b21\u306bstrong parameter\u306e\u8ffd\u52a0\n\n```application_controller.rb\nclass ApplicationController < ActionController::Base\n  protect_from_forgery with: :exception\n  before_action :configure_permitted_parameters, if: :devise_controller?\n\n  protected\n\n \u3000\u3000def configure_permitted_parameters\n    added_attrs = [ :username, :email, :password, :password_confirmation\u3000]\n    devise_parameter_sanitizer.permit :sign_up, keys: added_attrs\n    devise_parameter_sanitizer.permit :account_update, keys: added_attrs\n    devise_parameter_sanitizer.permit :sign_in, keys: added_attrs\n  end\nend\n```\n\n\u53c2\u8003\nhttps://github.com/plataformatec/devise/wiki/How-To:-Allow-users-to-sign-in-using-their-username-or-email-address\n\n\u6b21\u306bview\u3092\u30ab\u30b9\u30bf\u30de\u30a4\u30ba\u3067\u304d\u308b\u3088\u3046\u306b\u3057\u3066\u3044\u304f\u3002\n\n```\nrails g devise:views\n```\n\n```devise.rb\n...\nconfig.scoped_views = true\n...\n```\n\nview\u306busername\u6b04\u3092\u8ffd\u52a0\u3057\u3066\u3044\u304f\u3002\n\n```views/registrations/new.html.erb\n<h2>Sign up</h2>\n\n<%= form_for(resource, as: resource_name, url: registration_path(resource_name)) do |f| %>\n  <%= devise_error_messages! %>\n  <div class=\"field\">\n    <%= f.label :username %><br />\n    <%= f.text_field :username, autofocus: true %>\n  </div>\n\n  <div class=\"field\">\n    <%= f.label :email %><br />\n    <%= f.email_field :email, autofocus: true %>\n  </div>\n\n  <div class=\"field\">\n    <%= f.label :password %>\n    <% if @minimum_password_length %>\n    <em>(<%= @minimum_password_length %> characters minimum)</em>\n    <% end %><br />\n    <%= f.password_field :password, autocomplete: \"off\" %>\n  </div>\n\n  <div class=\"field\">\n    <%= f.label :password_confirmation %><br />\n    <%= f.password_field :password_confirmation, autocomplete: \"off\" %>\n  </div>\n\n  <div class=\"actions\">\n    <%= f.submit \"Sign up\" %>\n  </div>\n<% end %>\n\n<%= render \"devise/shared/links\" %>\n```\n\n\u3053\u308c\u3067\u8868\u793a\u3057\u3066\u307f\u308b\u3068\n\n<img width=\"500\" alt=\"\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2016-09-30 11.14.37.png\" src=\"https://qiita-image-store.s3.amazonaws.com/0/136253/b76a16be-3bbd-9b46-9c24-1e4dd23fb8f5.png\">\n\u3046\u307e\u304f\u8868\u793a\u3067\u304d\u3066\u308b\u307f\u305f\u3044\u3067\u3059\u306d\u3002\n\n\n\u767b\u9332\u306f\u3069\u3046\u3060\u308d\u3046...\nsignup\u3057\u3066username\u3092\u8868\u793a\u3057\u3066\u307f\u308b\u3068\n\n```top_pages/show.html.erb\n<%= @user.username %>\n```\n\n\n<img width=\"500\" alt=\"\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2016-09-30 11.25.31.png\" src=\"https://qiita-image-store.s3.amazonaws.com/0/136253/eb9a2119-b7c9-0803-b5b2-5dfc7eab4014.png\">\n\n\u3046\u307e\u304f\u767b\u9332\u3067\u304d\u3066\u308b\u307f\u305f\u3044\u3067\u3059\u306d\uff01\n\n\u4ee5\u4e0a\n", "tags": ["RubyOnRails", "devise"]}