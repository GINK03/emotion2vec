{"tags": ["capistrano2.15.5", "Ruby"], "context": " More than 1 year has passed since last update.capistrano 2.15.5\u4f7f\u3063\u3066\u975erails\u30a2\u30d7\u30ea\u3092\u30b5\u30fc\u30d0\u4e0a\u306b\u914d\u7f6e\u3057\u3066\u307f\u305f\u3002\ncapistrano3\u3067\u3084\u3063\u3066\u307f\u305f\u8a18\u4e8b\u306f\u3053\u3061\u3089 capistrano3.0\u3067\u975erails\u3092\u914d\u7f6e\u3057\u3066\u307f\u308b - Qiita [\u30ad\u30fc\u30bf]\n\n\u8a66\u3057\u3066\u307f\u305f\u624b\u9806\n$ bundle init\n$ echo \"gem 'capistrano', '~> 2.0'\" >> Gemfile\n$ echo \"gem 'capistrano_colors'\" >> Gemfile\n$ echo \"gem 'railsless-deploy'\" >> Gemfile\n$ bundle install --path vendor/bundle\n\n$ bundle exec capify .\n[add] writing './Capfile'\n[add] making directory './config'\n[add] writing './config/deploy.rb'\n[done] capified!\n\n$ tree -L 2\n.\n\u251c\u2500\u2500 Capfile\n\u251c\u2500\u2500 Gemfile\n\u251c\u2500\u2500 Gemfile.lock\n\u251c\u2500\u2500 config\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 deploy.rb\n\u2514\u2500\u2500 vendor\n    \u2514\u2500\u2500 bundle\n\n\nconfig/deploy.rb\u3092\u8a2d\u5b9a\n\nset :application, \"MyTips\"\nset :repository,  \"https://github.com/mechamogera/MyTips\"\nset :scm, :git\nset :keep_releases, 5\n\nset :deploy_to, '/var/www/my_app'                                                                                     \n\ndefault_run_options[:pty] = true\nset :use_sudo, false\n\n# No shared files\nset :shared_children, %w()\n# for No such file or directory Error\nset :normalize_asset_timestamps, false\n\nrole :web, \"[EC2\u306eDNS\u540d]\"\nset :user, 'ec2-user'\nset :group, 'ec2-user'\n\nbefore \"deploy:setup\" do\n  run \"sudo mkdir -p #{deploy_to}\"\n  run \"sudo chown -R #{user}:#{group} #{deploy_to}\"\nend\n\n# \u5ff5\u306e\u305f\u3081after\u3067\u3082\nafter \"deploy:setup\" do\n  run \"sudo chown -R #{user}:#{group} #{deploy_to}\"\nend\n\n\nEC2(AmazonLinux)\u3092\u4f5c\u6210 \ncapistrano\u5b9f\u884c\n\n$ bundle exec cap deploy:setup\n$ bundle exec cap deploy\n$ bundle exec cap deploy:cleanup\n\n\nEC2\u78ba\u8a8d\n\n$ tree /var/www/my_app/ -L 2\n/var/www/my_app/\n\u251c\u2500\u2500 current -> /var/www/my_app/releases/20131205070710\n\u251c\u2500\u2500 releases\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 20131205070710\n\u2514\u2500\u2500 shared\n\ncapistrano 2.15.5\u4f7f\u3063\u3066\u975erails\u30a2\u30d7\u30ea\u3092\u30b5\u30fc\u30d0\u4e0a\u306b\u914d\u7f6e\u3057\u3066\u307f\u305f\u3002\ncapistrano3\u3067\u3084\u3063\u3066\u307f\u305f\u8a18\u4e8b\u306f\u3053\u3061\u3089 [capistrano3.0\u3067\u975erails\u3092\u914d\u7f6e\u3057\u3066\u307f\u308b - Qiita [\u30ad\u30fc\u30bf]](http://qiita.com/mechamogera/items/46cadbd300e2a7667353)\n\n## \u8a66\u3057\u3066\u307f\u305f\u624b\u9806\n\n```bash\n$ bundle init\n$ echo \"gem 'capistrano', '~> 2.0'\" >> Gemfile\n$ echo \"gem 'capistrano_colors'\" >> Gemfile\n$ echo \"gem 'railsless-deploy'\" >> Gemfile\n$ bundle install --path vendor/bundle\n\n$ bundle exec capify .\n[add] writing './Capfile'\n[add] making directory './config'\n[add] writing './config/deploy.rb'\n[done] capified!\n\n$ tree -L 2\n.\n\u251c\u2500\u2500 Capfile\n\u251c\u2500\u2500 Gemfile\n\u251c\u2500\u2500 Gemfile.lock\n\u251c\u2500\u2500 config\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 deploy.rb\n\u2514\u2500\u2500 vendor\n    \u2514\u2500\u2500 bundle\n```\n\n* config/deploy.rb\u3092\u8a2d\u5b9a\n\n```rb\nset :application, \"MyTips\"\nset :repository,  \"https://github.com/mechamogera/MyTips\"\nset :scm, :git\nset :keep_releases, 5\n\nset :deploy_to, '/var/www/my_app'                                                                                     \n\ndefault_run_options[:pty] = true\nset :use_sudo, false\n\n# No shared files\nset :shared_children, %w()\n# for No such file or directory Error\nset :normalize_asset_timestamps, false\n\nrole :web, \"[EC2\u306eDNS\u540d]\"\nset :user, 'ec2-user'\nset :group, 'ec2-user'\n\nbefore \"deploy:setup\" do\n  run \"sudo mkdir -p #{deploy_to}\"\n  run \"sudo chown -R #{user}:#{group} #{deploy_to}\"\nend\n\n# \u5ff5\u306e\u305f\u3081after\u3067\u3082\nafter \"deploy:setup\" do\n  run \"sudo chown -R #{user}:#{group} #{deploy_to}\"\nend\n```\n\n* EC2(AmazonLinux)\u3092\u4f5c\u6210 \n* capistrano\u5b9f\u884c\n\n```bash\n$ bundle exec cap deploy:setup\n$ bundle exec cap deploy\n$ bundle exec cap deploy:cleanup\n```\n\n* EC2\u78ba\u8a8d\n\n```bash\n$ tree /var/www/my_app/ -L 2\n/var/www/my_app/\n\u251c\u2500\u2500 current -> /var/www/my_app/releases/20131205070710\n\u251c\u2500\u2500 releases\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 20131205070710\n\u2514\u2500\u2500 shared\n```"}