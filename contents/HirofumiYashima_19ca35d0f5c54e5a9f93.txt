{"context": " More than 1 year has passed since last update.\n\nR\u3067\u6a5f\u68b0\u5b66\u7fd2(PRML)\uff1aSVM  vs \u30e9\u30f3\u30c0\u30e0\u30d5\u30a9\u30ec\u30b9\u30c8\u30e2\u30c7\u30eb\n\n\uff08\u682a\u4fa1\u30b7\u30ca\u30ea\u30aa\u2461\uff09\u65e5\u7d4c\u5e73\u5747\u5024\u52d5\u304d\u5e45 \u904e\u53bb\u65e5\u9023\u52d5\u6027\u691c\u8a3c\n\n\u3010 \u691c\u8a3c\u4e8b\u9805 \u3011\n\n\u65e5\u7d4c\u5e73\u5747\u682a\u4fa1\u306e\u5404\u65e5\u306e\uff08\u53d6\u5f15\u6642\u9593\u5185\uff09\u306e\u5024\u52d5\u304d\u5e45\uff08\u30dc\u30e9\u30c6\u30a3\u30ea\u30c6\u30a3\uff1a ((\u5f53\u65e5\u7d42\u5024-\u5f53\u65e5\u59cb\u5024)/\u5f53\u65e5\u59cb\u5024)100) )\u306f\u3001X\u65e5\u524d\u306e\u5024\u52d5\u304d\u30dc\u30e9\u30c6\u30a3\u30ea\u30c6\u30a3 ( ((X\u65e5\u524d\u306e\u7d42\u5024-X\u65e5\u524d\u306e\u59cb\u5024)/X\u65e5\u524d\u306e\u59cb\u5024)100) ) \u3068\u3001\u3069\u306e\u3088\u3046\u306a\u95a2\u9023\u6027\u304c\u3042\u308b\u304b\u3002\u203bX = 1 \uff5e 7\n\n\u3010 \u4e8b\u524d\u4eee\u8aac \u3011\n\n\u5f53\u65e5\u306e\u5024\u52d5\u304d\u30dc\u30e9\u30c6\u30a3\u30ea\u30c6\u30a3( ((\u5f53\u65e5\u7d42\u5024-\u5f53\u65e5\u59cb\u5024)/\u5f53\u65e5\u59cb\u5024)100) )\u306f\u3001X\u306e\u5024\u304c\u3088\u308a\u5c0f\u3055\u3044 X\u65e5\u524d\u306e\u5024\u52d5\u304d\u30dc\u30e9\u30c6\u30a3\u30ea\u30c6\u30a3 ( ((X\u65e5\u524d\u306e\u7d42\u5024-X\u65e5\u524d\u306e\u59cb\u5024)/X\u65e5\u524d\u306e\u59cb\u5024)100) ) \u304b\u3089\u3001\u5f37\u3044\u5f71\u97ff\u3092\u53d7\u3051\u3066\u3044\u308b\n\n\u3010 \u80cc\u666f\u306b\u3042\u308b\u77e5\u898b \u3011\n\n\n\uff08 GARCH\u30e2\u30c7\u30eb \uff09\n\u3042\u308b\u65e5\u306e\u682a\u4fa1\u30dc\u30e9\u30c6\u30a3\u30ea\u30c6\u30a3\u306f\u3001\u8fd1\u3044\u904e\u53bb\u65e5\u306e\u30dc\u30e9\u30c6\u30a3\u30ea\u30c6\u30a3\u306b\u5f15\u3063\u5f35\u3089\u308c\u308b\u300d\uff08\u4e0a\u3052\uff08\u4e0b\u3052\uff09\u76f8\u5834\u304c\u7d9a\u3044\u3066\u3044\u308b\u671f\u9593\u4e2d\u306f\u3001\u7fcc\u65e5\u3082\u4e0a\u3052\uff08\u4e0b\u3052\uff09\u76f8\u5834 \uff09\u3068\u3044\u3046\u4eee\u8aac\u306b\u7acb\u811a\u3057\u3066\u3044\u308b\u3002\n\n\n\u30c7\u30fc\u30bf\u4f5c\u6210\u5de5\u7a0b\n\n\n\u30a6\u30a7\u30d6\u30b5\u30a4\u30c8\u300c\u65e5\u7d4c\u5e73\u5747\u30d7\u30ed\u30d5\u30a3\u30eb \u65e5\u7d4c\u306e\u6307\u6570\u60c5\u5831\u30b5\u30a4\u30c8\u300d\u3067\u516c\u958b\u3055\u308c\u3066\u3044\u308b\u65e5\u7d4c\u5e73\u5747\u682a\u4fa1\u306e\u65e5\u6b21\u30c7\u30fc\u30bf\u30d5\u30a1\u30a4\u30eb\u3092R\u306b\u53d6\u308a\u8fbc\u3080\n\nR\naddress <- \"http://indexes.nikkei.co.jp/nkave/historical/nikkei_stock_average_daily_jp.csv\"\nnikkei225 <- read.csv(file=url(address), header=TRUE, sep=\",\")\n\n\n\n\u30c7\u30fc\u30bf\u306e\u5192\u982d\u3092\u78ba\u8a8d\n\nR\nhead(nikkei225)\n\n\n  \u30c7\u30fc\u30bf\u65e5\u4ed8     \u7d42\u5024     \u59cb\u5024     \u9ad8\u5024     \u5b89\u5024\n1 2011/01/04 10398.10 10352.19 10409.17 10321.28\n2 2011/01/05 10380.77 10387.95 10413.45 10358.01\n3 2011/01/06 10529.76 10477.52 10530.11 10477.52\n4 2011/01/07 10541.04 10506.72 10550.71 10503.02\n5 2011/01/11 10510.68 10484.62 10538.39 10476.29\n6 2011/01/12 10512.80 10562.28 10576.51 10502.96\n\n\n\u30c7\u30fc\u30bf\u306e\u672b\u5c3e\u3092\u78ba\u8a8d\n\nR\ntail(nikkei225,3)\n\n\n836                                                                                                                             2014/05/29 14681.72 14585.64 14714.95\n837                                                                                                                             2014/05/30 14632.38 14707.66 14741.10\n838 \u672c\u8cc7\u6599\u306f\u65e5\u7d4c\u306e\u8457\u4f5c\u7269\u3067\u3042\u308a\u3001\u672c\u8cc7\u6599\u306e\u5168\u90e8\u53c8\u306f\u4e00\u90e8\u3092\u3001\u3044\u304b\u306a\u308b\u5f62\u5f0f\u306b\u3088\u3063\u3066\u3082\u65e5\u7d4c\u306b\u7121\u65ad\u3067\u8907\u5199\u3001\u8907\u88fd\u3001\u8ee2\u8f09\u307e\u305f\u306f\u6d41\u5e03\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u305b\u3093\u3002       NA       NA       NA\n        \u5b89\u5024\n836 14574.02\n837 14591.62\n838       NA\n\n\n\u672b\u5c3e\u306b\u6587\u7ae0\uff08\u6ce8\u8a18\uff09\u304c\u8a18\u8ff0\u3055\u308c\u3066\u3044\u308b\u305f\u3081\u3001\u30c7\u30fc\u30bf\u30aa\u30d6\u30b8\u30a7\u30af\u30c8 nikkei225 \u304b\u3089\u3001 838\u884c\u76ee\u3092\u524a\u9664\n\nR\nnikkei225 <- nikkei225[-838, ]\n\ntail(nikkei225,10)\n\n\n\n\u4e0b\u8a18\u306e\u3068\u304a\u308a\u3001\u6587\u5b57\u5217\u304c\u524a\u9664\u3055\u308c\u305f\u3002\n    \u30c7\u30fc\u30bf\u65e5\u4ed8     \u7d42\u5024     \u59cb\u5024     \u9ad8\u5024     \u5b89\u5024\n828 2014/05/19 14006.44 14130.09 14150.50 13991.80\n829 2014/05/20 14075.25 14088.45 14144.04 14038.06\n830 2014/05/21 14042.17 13969.71 14054.24 13964.43\n831 2014/05/22 14337.79 14188.28 14369.02 14147.55\n832 2014/05/23 14462.17 14411.10 14528.04 14404.80\n833 2014/05/26 14602.52 14592.60 14602.52 14531.32\n834 2014/05/27 14636.52 14589.79 14744.16 14588.68\n835 2014/05/28 14670.95 14646.93 14717.29 14608.54\n836 2014/05/29 14681.72 14585.64 14714.95 14574.02\n837 2014/05/30 14632.38 14707.66 14741.10 14591.62\n\n\n\u4e0a\u8a18\u306e\u30c7\u30fc\u30bf\u3092\u3082\u3068\u306b\u3001\u6771\u8a3c\u55b6\u696d\u65e5\u6bce\u306e\u53d6\u5f15\u6642\u9593\u5185 \u5024\u52d5\u304d\u5e45\u3092\u7b97\u51fa \u21d2 \u5f53\u65e5\u30011\u55b6\u696d\u65e5\u524d\uff5e7\u55b6\u696d\u65e5\u524d\u306e\u5024\u52d5\u304d\u5e45\u306e\u5217\u3092\u8ffd\u52a0\n\nR\ncolnames(nikkei225) <- c(\"date\",\"close\", \"open\", \"high\", \"low\")\n\n# head(nikkei225); class(nikkei225)\n\nattach(nikkei225)\n\n#\u3000\u5404\u65e5\u306e\u5024\u5e45 (\u5f53\u65e5\u7d42\u5024-\u5f53\u65e5\u59cb\u5024) / \u5f53\u65e5\u59cb\u5024\nvolatility <- close-open\n\n#  \u5f53\u65e5\u306e\u5024\u5e45 (\u5f53\u65e5\u7d42\u5024-\u5f53\u65e5\u59cb\u5024) / \u5f53\u65e5\u59cb\u5024\nchange.0 <- volatility\n# class(change.0)  numeric\u578b\n# length(change.0) 837\u884c\n# head(change.0) 45.91  -7.18  52.24  34.32  26.06 -49.48\n# length(change.0) 837\u884c\n\n#  \u524d\u65e5\u306e\u5024\u5e45 (\u524d\u65e5\u7d42\u5024-\u524d\u65e5\u59cb\u5024) / \u524d\u65e5\u59cb\u5024\nchange.1= c(0,volatility)\n# head(change.1)  0.00 45.91 -7.18 52.24 34.32 26.06\n# length(change.1) 838\u884c\n\n#  2\u65e5\u524d\u306e\u5024\u5e45 (2\u65e5\u524d\u7d42\u5024-2\u65e5\u524d\u59cb\u5024) / 2\u65e5\u524d\u59cb\u5024\nchange.2= c(rep(0,2),volatility)\n# head(change.2) 0.00  0.00 45.91 -7.18 52.24 34.32\n# length(change.2) 839\u884c\n\n#  3\u65e5\u524d\u306e\u5024\u5e45 (3\u65e5\u524d\u7d42\u5024-3\u65e5\u524d\u59cb\u5024) / 3\u65e5\u524d\u59cb\u5024\nchange.3= c(rep(0,3),volatility)\n# head(change.3) 0.00  0.00  0.00 45.91 -7.18 52.24\n# length(change.2) 839\u884c\n\n#  4\u65e5\u524d\u306e\u5024\u5e45 (4\u65e5\u524d\u7d42\u5024-4\u65e5\u524d\u59cb\u5024) / 4\u65e5\u524d\u59cb\u5024\nchange.4= c(rep(0,4),volatility)\n\n#  5\u65e5\u524d\u306e\u5024\u5e45 (5\u65e5\u524d\u7d42\u5024-5\u65e5\u524d\u59cb\u5024) / 5\u65e5\u524d\u59cb\u5024\nchange.5= c(rep(0,5),volatility)\n\n#  6\u65e5\u524d\u306e\u5024\u5e45 (6\u65e5\u524d\u7d42\u5024-6\u65e5\u524d\u59cb\u5024) / 6\u65e5\u524d\u59cb\u5024\nchange.6= c(rep(0,6),volatility)\n\n#  7\u65e5\u524d\u306e\u5024\u5e45 (7\u65e5\u524d\u7d42\u5024-7\u65e5\u524d\u59cb\u5024) / 7\u65e5\u524d\u59cb\u5024\nchange.7= c(rep(0,7),volatility)\n# head(change.7, 10) 0.00  0.00  0.00  0.00  0.00  0.00  0.00 45.91 -7.18 52.24\n# length(change.7)  844\u884c\n\n#### \u5192\u982d\u306e837\u884c\u3060\u3051\u5229\u7528\n\n# length(change.0) 837\u884c\nchange.1 <- change.1[1:837]  # length(change.1) 837\nchange.2 <- change.2[1:837]  # length(change.2) 837\nchange.3 <- change.3[1:837]  # length(change.3) 837\nchange.4 <- change.4[1:837]  # length(change.4) 837\nchange.5 <- change.5[1:837]  # length(change.5) 837\nchange.6 <- change.6[1:837]  # length(change.6) 837\nchange.7 <- change.7[1:837]  # length(change.7) 837\n\nnikkei.225 <- data.frame(date=date, vol.today=change.0, vol.1day.ago=change.1, vol.2day.ago=change.2, vol.3day.ago=change.3, vol.4day.ago=change.4, vol.5day.ago=change.5, vol.6day.ago=change.6, vol.7day.ago=change.7)\n\nhead(nikkei.225)\n\n\n\n\n        date vol.today vol.1day.ago vol.2day.ago vol.3day.ago vol.4day.ago vol.5day.ago vol.6day.ago vol.7day.ago\n1 2011/01/04     45.91         0.00         0.00         0.00         0.00         0.00            0            0\n2 2011/01/05     -7.18        45.91         0.00         0.00         0.00         0.00            0            0\n3 2011/01/06     52.24        -7.18        45.91         0.00         0.00         0.00            0            0\n4 2011/01/07     34.32        52.24        -7.18        45.91         0.00         0.00            0            0\n5 2011/01/11     26.06        34.32        52.24        -7.18        45.91         0.00            0            0\n6 2011/01/12    -49.48        26.06        34.32        52.24        -7.18        45.91            0            0\n\n\n\nR\ntail(nikkei.225)\n\n\n          date vol.today vol.1day.ago vol.2day.ago vol.3day.ago vol.4day.ago vol.5day.ago vol.6day.ago vol.7day.ago\n832 2014/05/23     51.07       149.51        72.46       -13.20      -123.65         8.83        17.70        20.16\n833 2014/05/26      9.92        51.07       149.51        72.46       -13.20      -123.65         8.83        17.70\n834 2014/05/27     46.73         9.92        51.07       149.51        72.46       -13.20      -123.65         8.83\n835 2014/05/28     24.02        46.73         9.92        51.07       149.51        72.46       -13.20      -123.65\n836 2014/05/29     96.08        24.02        46.73         9.92        51.07       149.51        72.46       -13.20\n837 2014/05/30    -75.28        96.08        24.02        46.73         9.92        51.07       149.51        72.46\n\n\n\u904e\u53bb\u65e5\u30dc\u30e9\u30c6\u30a3\u30ea\u30c6\u30a3\u30c7\u30fc\u30bf\u306e\u306a\u3044\uff080\uff09\u304c\u57cb\u3081\u8fbc\u307e\u308c\u305f\u5192\u982d7\u884c\u3092\u524a\u9664\n\nR\nnikkei.225 <- nikkei.225[-1:-7,]\n\nhead(nikkei.225)\n\n\n         date vol.today vol.1day.ago vol.2day.ago vol.3day.ago vol.4day.ago vol.5day.ago vol.6day.ago vol.7day.ago\n8  2011/01/14     -3.73        -3.70       -49.48        26.06        34.32        52.24        -7.18        45.91\n9  2011/01/17    -59.23        -3.73        -3.70       -49.48        26.06        34.32        52.24        -7.18\n10 2011/01/18     57.94       -59.23        -3.73        -3.70       -49.48        26.06        34.32        52.24\n11 2011/01/19    -10.78        57.94       -59.23        -3.73        -3.70       -49.48        26.06        34.32\n12 2011/01/20    -55.01       -10.78        57.94       -59.23        -3.73        -3.70       -49.48        26.06\n13 2011/01/21   -184.52       -55.01       -10.78        57.94       -59.23        -3.73        -3.70       -49.48\n\n\nR\ntail(nikkei.225)\n\n\n          date vol.today vol.1day.ago vol.2day.ago vol.3day.ago vol.4day.ago vol.5day.ago vol.6day.ago vol.7day.ago\n832 2014/05/23     51.07       149.51        72.46       -13.20      -123.65         8.83        17.70        20.16\n833 2014/05/26      9.92        51.07       149.51        72.46       -13.20      -123.65         8.83        17.70\n834 2014/05/27     46.73         9.92        51.07       149.51        72.46       -13.20      -123.65         8.83\n835 2014/05/28     24.02        46.73         9.92        51.07       149.51        72.46       -13.20      -123.65\n836 2014/05/29     96.08        24.02        46.73         9.92        51.07       149.51        72.46       -13.20\n837 2014/05/30    -75.28        96.08        24.02        46.73         9.92        51.07       149.51        72.46\n\n\n\u3010\u6570\u5024\u3011\u7d42\u5024\u3068\u5404X\u65e5\u524d\u6bd4\u4e0a\u6607\u7387(%)\u3068\u306e\u76f8\u95a2\u4fc2\u6570\n\nR\ncor(nikkei.225[,-1]) # 1\u5217\u76ee\u306e\u5e74\u6708\u65e5\u5217\u3092\u9664\u3044\u3066\u76f8\u95a2\u4fc2\u6570\u884c\u5217\u3092\u6f14\u7b97\n\n\n                vol.today vol.1day.ago vol.2day.ago vol.3day.ago vol.4day.ago vol.5day.ago vol.6day.ago vol.7day.ago\nvol.today     1.000000000  -0.06867998  -0.02420786  -0.11593313  -0.04689344   0.10205580  -0.04837342  0.007228203\nvol.1day.ago -0.068679977   1.00000000  -0.06814720  -0.02406817  -0.11568889  -0.04683790   0.10239227 -0.047562322\nvol.2day.ago -0.024207860  -0.06814720   1.00000000  -0.06846877  -0.02458239  -0.11600097  -0.04724201  0.101168506\nvol.3day.ago -0.115933130  -0.02406817  -0.06846877   1.00000000  -0.06849066  -0.02448528  -0.11613188 -0.047482275\nvol.4day.ago -0.046893443  -0.11568889  -0.02458239  -0.06849066   1.00000000  -0.06837783  -0.02470496 -0.116670123\nvol.5day.ago  0.102055804  -0.04683790  -0.11600097  -0.02448528  -0.06837783   1.00000000  -0.06844889 -0.024659982\nvol.6day.ago -0.048373416   0.10239227  -0.04724201  -0.11613188  -0.02470496  -0.06844889   1.00000000 -0.069157801\nvol.7day.ago  0.007228203  -0.04756232   0.10116851  -0.04748227  -0.11667012  -0.02465998  -0.06915780  1.000000000\n\n\n\u3010\u6563\u5e03\u56f3\u3011\u7d42\u5024\u3068\u5404X\u65e5\u524d\u6bd4\u4e0a\u6607\u7387(%)\u3068\u306e\u76f8\u95a2\u4fc2\u6570\n\nR\npairs(nikkei.225[,-1])\n\n\n\n\n\u7dda\u5f62\u91cd\u56de\u5e30\u5206\u6790\uff08\u95a2\u6570 lm()\uff09\n\nR\nvolatility.lm <- lm(vol.today~vol.1day.ago+vol.2day.ago+vol.3day.ago+vol.4day.ago*vol.5day.ago+vol.6day.ago+vol.7day.ago, data=nikkei.225[,-1])\n\nprint(summary(volatility.lm))\n\n\n\n\u5404\u8aac\u660e\u5909\u6570\u306ep\u5024\uff085%\u6709\u610f\u6c34\u6e96\uff09\u306f\u3001vol.3day.ago, vol.5day.ago\u304c\u6709\u610f\n\u81ea\u7531\u5ea6\u8abf\u6574\u6e08\u307f\u6c7a\u5b9a\u4fc2\u6570\u306f\u30010.00026\u3068\u304d\u308f\u3081\u3066\u4f4e\u3044 \nF\u691c\u5b9a\u306ep\u5024\u306f1%\u6c34\u6e96\u306e\u3082\u3068\u3067\u3082\u6709\u610f\n\n\n\u203b \u7cfb\u5217\u76f8\u95a2\u30fb\u591a\u91cd\u5171\u7dda\u6027\u306e\u691c\u5b9a\u306f\u5272\u611b  \uff08\u8aac\u660e\u5909\u6570\u3069\u3046\u3057\u3001\u8aac\u660e\u5909\u6570\u3068\u8aa4\u5dee\u9805\u306e\u9593\u306e\u76f8\u95a2\u6709\u7121\u306e\u691c\u5b9a\uff09\nCall:\nlm(formula = vol.today ~ vol.1day.ago + vol.2day.ago + vol.3day.ago + \n    vol.4day.ago * vol.5day.ago + vol.6day.ago + vol.7day.ago, \n    data = nikkei.225[, -1])\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-1192.49   -51.79     3.99    54.45   444.45 \n\nCoefficients:\n                            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)               -2.3232471  4.2759436  -0.543 0.587050    \nvol.1day.ago              -0.0687484  0.0352519  -1.950 0.051492 .  \nvol.2day.ago              -0.0324408  0.0349781  -0.927 0.353961    \nvol.3day.ago              -0.1294462  0.0348665  -3.713 0.000219 ***\nvol.4day.ago              -0.0614408  0.0350690  -1.752 0.080147 .  \nvol.5day.ago               0.0850836  0.0348919   2.438 0.014960 *  \nvol.6day.ago              -0.0548783  0.0349958  -1.568 0.117234    \nvol.7day.ago              -0.0082790  0.0349434  -0.237 0.812773    \nvol.4day.ago:vol.5day.ago  0.0001106  0.0001717   0.644 0.519701    \n---\nSignif. codes:  0 \u2018***\u2019 0.001 \u2018**\u2019 0.01 \u2018*\u2019 0.05 \u2018.\u2019 0.1 \u2018 \u2019 1\n\nResidual standard error: 122.9 on 821 degrees of freedom\nMultiple R-squared:  0.03507,   Adjusted R-squared:  0.02567 \nF-statistic:  3.73 on 8 and 821 DF,  p-value: 0.0002679\n\n\n\n\u6559\u5e2b\u30c7\u30fc\u30bf\u30fb\u30c6\u30b9\u30c8\u30c7\u30fc\u30bf\u306e\u4f5c\u6210\n\n\n\u5e74\u6708\u65e5\u5217\u306e\u524a\u9664 \uff08\u5225\u540d\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u4f5c\u6210\uff09\n\nR\nvolatilities <- nikkei.225[,-1] \n\nhead(volatilities)\n\n\n   vol.today vol.1day.ago vol.2day.ago vol.3day.ago vol.4day.ago vol.5day.ago vol.6day.ago vol.7day.ago\n8      -3.73        -3.70       -49.48        26.06        34.32        52.24        -7.18        45.91\n9     -59.23        -3.73        -3.70       -49.48        26.06        34.32        52.24        -7.18\n10     57.94       -59.23        -3.73        -3.70       -49.48        26.06        34.32        52.24\n11    -10.78        57.94       -59.23        -3.73        -3.70       -49.48        26.06        34.32\n12    -55.01       -10.78        57.94       -59.23        -3.73        -3.70       -49.48        26.06\n13   -184.52       -55.01       -10.78        57.94       -59.23        -3.73        -3.70       -49.48\n\n\n\u30c7\u30fc\u30bf\u671f\u9593\u306e\u3046\u3061\u300175%\u3092\u6559\u5e2b\u7528\u30c7\u30fc\u30bf\u306b\u3001\u6b8b\u308a25%\u3092\u30c6\u30b9\u30c8\u7528\u30c7\u30fc\u30bf\u306b\u5272\u308a\u632f\u308a\n\nR\nd.train <- volatilities[1:nrow(volatilities)*0.75, ]\nd.test <- volatilities[-1:-nrow(volatilities)*0.75, ]\n\n\n\n\u30c7\u30fc\u30bf\u65e5\u6570\uff08\u6559\u5e2b\u30c7\u30fc\u30bf\u30fb\u30c6\u30b9\u30c8\u30c7\u30fc\u30bf\uff09\n\nR\nprint(paste(\"\u6559\u5e2b\u7528\u30c7\u30fc\u30bf\u306e\u65e5\u6570\uff1a \", nrow(d.train), \"\u65e5\u5206\", sep=\"\"));\nprint(paste(\"\u30c6\u30b9\u30c8\u7528\u30c7\u30fc\u30bf\u306e\u65e5\u6570\uff1a \", nrow(d.test), \"\u65e5\u5206\", sep=\"\"))\n\n\n[1] \"\u6559\u5e2b\u7528\u30c7\u30fc\u30bf\u306e\u65e5\u6570\uff1a 829\u65e5\u5206\"\n[1] \"\u30c6\u30b9\u30c8\u7528\u30c7\u30fc\u30bf\u306e\u65e5\u6570\uff1a 208\u65e5\u5206\"\n\n\n\n\u3010 \u56de\u5e30\u554f\u984c \u3011 SVM vs randomForest \u4e88\u6e2c\u7cbe\u5ea6\u6bd4\u8f03\n\n\n\uff11\uff0e\u30b5\u30dd\u30fc\u30c8\u30d9\u30af\u30bf\u30fc\u30de\u30b7\u30f3\n\n\n\u30d1\u30c3\u30b1\u30fc\u30b8\u300ckernlab\u300d\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3068\u30e1\u30e2\u30ea\u8aad\u8fbc\u307f\n\nR\ninstall.packages(\"kernlab\")\n\n\nInstalling package into \u2018C:/Users/owner/Documents/R/win-library/3.0\u2019\n(as \u2018lib\u2019 is unspecified)\ntrying URL 'http://cran.rstudio.com/bin/windows/contrib/3.0/kernlab_0.9-19.zip'\nContent type 'application/zip' length 2029405 bytes (1.9 Mb)\nopened URL\ndownloaded 1.9 Mb\n\npackage \u2018kernlab\u2019 successfully unpacked and MD5 sums checked\n\nThe downloaded binary packages are in\n    C:\\Users\\owner\\AppData\\Local\\Temp\\RtmpmCII8Q\\downloaded_packages\n\n\nR\nlibrary(kernlab)\n\n\nWarning message:\n \u30d1\u30c3\u30b1\u30fc\u30b8 \u2018kernlab\u2019 \u306f\u30d0\u30fc\u30b8\u30e7\u30f3 3.0.2 \u306e R \u306e\u4e0b\u3067\u9020\u3089\u308c\u307e\u3057\u305f  \n\n\n\u6559\u5e2b\u7528\u30c7\u30fc\u30bf\u306b\u3088\u308b\u30e2\u30c7\u30eb\u751f\u6210\n\n\u5358\u56de\u5e30\u4ee5\u5916\u306b\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306aformula\u306e\u4e0e\u3048\u65b9\u3067\u3001\u591a\u91cd\u56de\u5e30\u3092\u3057\u3066\u3082\u3088\u3044\u306e\u304b\u306f\u3001\u8981\u691c\u8a3c\uff08\u52d5\u4f5c\u306f\u3057\u3066\u3001\u8fd4\u308a\u5024\u306f\u8fd4\u3055\u308c\u305f\uff09\n\nR\nvolatilities.svm <- ksvm(vol.today ~ vol.1day.ago + vol.2day.ago + vol.3day.ago + vol.4day.ago * vol.5day.ago + vol.6day.ago + vol.7day.ago, data=volatilities, epsilon=0.01, kpar=list(sigma=16))\n\nprint(volatilities.svm)\n\n\nSupport Vector Machine object of class \"ksvm\" \n\nSV type: eps-svr  (regression) \n parameter : epsilon = 0.01  cost C = 1 \n\nGaussian Radial Basis kernel function. \n Hyperparameter : sigma =  16 \n\nNumber of Support Vectors : 817 \n\nObjective Function Value : -273.8392 \nTraining error : 0.3319 \n\n\n\u30c6\u30b9\u30c8\u7528\u30c7\u30fc\u30bf\u306b\u3088\u308b\u4e88\u6e2c\n\nR\nvolatilities.prediction <- predict(volatilities.svm, d.test[,-1])  #\u30c6\u30b9\u30c8\u7528\u30c7\u30fc\u30bf\u306e\u3046\u3061\u3001\u5f53\u65e5\u5024\u5e45\u5217\uff081\u5217\u76ee\uff09\u3092\u524a\u9664\u3057\u3066\u4e0e\u3048\u308b\n\nprint(head(volatilities.prediction))\n\n\n           [,1]\n[1,]   10.37949\n[2,] -123.22547\n[3,] -123.22547\n[4,] -123.22547\n[5,]  125.83255\n[6,]  -64.02182\n\n\n\u4e88\u6e2c\u7d50\u679c\u306e\u6b63\u7b54\u7387\u691c\u8a3c\n\nR\nplot(1:nrow(d.test), volatilities.prediction, type=\"l\", col=\"red\")\npar(new=T)\nplot(1:nrow(d.test), d.test[,1], type=\"l\", col=\"blue\") #d.test[,1]\uff081\u5217\u76ee\uff09\u306b\u6b63\u89e3\u5024\uff08\u5b9f\u969b\u306e\u5f53\u65e5\u5024\u52d5\u304d\u5e45\uff09\u304c\u683c\u7d0d\u3002\npar(new=F)\nlegend(\"topleft\", c(\"\u5f53\u65e5 \u5024\u52d5\u304d\u5e45\uff08\u6b63\u89e3\uff09\uff1a\u9752\", \"\u5f53\u65e5 \u5024\u52d5\u304d\u5e45\uff08\u4e88\u6e2c\u5024\uff09\uff1a\u8d64\"))\n\ncor.value <- round(cor(d.test[,1], volatilities.prediction),2)\nprint(paste(\"\u6b63\u7b54\u3068\u4e88\u6e2c\u7d50\u679c\u306e\u76f8\u95a2\u4fc2\u6570\uff1a\", cor.value))\n\n\n\n\n\u4e88\u6e2c\u7cbe\u5ea6\u306f94%\u3068\u6975\u3081\u3066\u9ad8\u3044\n\n[1] \"\u6b63\u7b54\u3068\u4e88\u6e2c\u7d50\u679c\u306e\u76f8\u95a2\u4fc2\u6570\uff1a 0.94\"\n\n\n\n\uff12\uff0e\u30e9\u30f3\u30c0\u30e0\u30d5\u30a9\u30ec\u30b9\u30c8\u30e2\u30c7\u30eb\n\n\n\u6559\u5e2b\u7528\u30c7\u30fc\u30bf\u306b\u3088\u308b\u30e2\u30c7\u30eb\u751f\u6210\n\nR\ninstall.packages(\"randomForest\")\nlibrary(randomForest)\n\nvolatilities.rf <- randomForest(vol.today ~ vol.1day.ago + vol.2day.ago + vol.3day.ago + vol.4day.ago * vol.5day.ago + vol.6day.ago + vol.7day.ago, data=volatilities, na.action=\"na.omit\")\n\nprint(volatilities.rf)\n\n\nCall:\n randomForest(formula = vol.today ~ vol.1day.ago + vol.2day.ago +      vol.3day.ago + vol.4day.ago * vol.5day.ago + vol.6day.ago +      vol.7day.ago, data = volatilities, na.action = \"na.omit\") \n               Type of random forest: regression\n                     Number of trees: 500\nNo. of variables tried at each split: 2\n\n          Mean of squared residuals: 16155.97\n                    % Var explained: -4.31\n\n\n\nR\nsummary(volatilities.rf)\n\n\n               Length Class  Mode     \ncall              4    -none- call     \ntype              1    -none- character\npredicted       830    -none- numeric  \nmse             500    -none- numeric  \nrsq             500    -none- numeric  \noob.times       830    -none- numeric  \nimportance        7    -none- numeric  \nimportanceSD      0    -none- NULL     \nlocalImportance   0    -none- NULL     \nproximity         0    -none- NULL     \nntree             1    -none- numeric  \nmtry              1    -none- numeric  \nforest           11    -none- list     \ncoefs             0    -none- NULL     \ny               830    -none- numeric  \ntest              0    -none- NULL     \ninbag             0    -none- NULL     \nterms             3    terms  call     \n\n\n\u6728\u306e\u6570\u3068\u8aa4\u308a\u7387\u306e\u95a2\u4fc2\u3092\u30c1\u30a7\u30c3\u30af\n\nR\nplot(volatilities.rf)\n\n\n\n\n\n\u5909\u6570\u306e\u91cd\u8981\u5ea6\u30e9\u30f3\u30ad\u30f3\u30b0\u3092\u51fa\u529b\n\nR\nprint(volatilities.rf$importance)\n\n\n             IncNodePurity\nvol.1day.ago       1914448\nvol.2day.ago       1643255\nvol.3day.ago       1637977\nvol.4day.ago       1893461\nvol.5day.ago       1487329\nvol.6day.ago       1627349\nvol.7day.ago       1223966\n\n\n\u30c6\u30b9\u30c8\u7528\u30c7\u30fc\u30bf\u3092\u5f53\u3066\u306f\u3081\u3066\u3001\u30c6\u30b9\u30c8\u30c7\u30fc\u30bf\u671f\u9593\u306e\u5f53\u65e5\u30dc\u30e9\u30c6\u30a3\u30ea\u30c6\u30a3\u3092\u4e88\u6e2c\n\nR\nvolatilities.rfp <- predict(volatilities.rf, d.test[,-1]) \n\nprint(round(volatilities.rfp, 1))\n\n\n   630    631    632    633    634    635    636    637    638    639    640    641    642    643    644    645    646    647 \n  38.1  -95.5 -107.9 -143.2  138.9  -38.2  198.1  159.9 -106.5  107.7 -285.5  -85.5  -30.2   13.8  108.4   47.9  -75.8   75.5 \n   648    649    650    651    652    653    654    655    656    657    658    659    660    661    662    663    664    665 \n  55.2 -141.4   -2.4   61.0   66.3  -40.4    1.2   10.1   44.4  -94.1   79.2  131.0   94.5  -64.3 -119.3   20.2   85.2  -64.1 \n   666    667    668    669    670    671    672    673    674    675    676    677    678    679    680    681    682    683 \n   6.0   49.9  -79.8   52.2   52.9  -29.0   80.5  -60.2  131.0   -6.5  -54.5  -22.0 -237.1   15.7  -20.3  -88.6   92.1  120.0 \n   684    685    686    687    688    689    690    691    692    693    694    695    696    697    698    699    700    701 \n  78.7   13.1  -44.2   26.8   -7.2  -24.0   39.0   27.3 -176.9   83.2 -147.1  123.4   33.2   42.7  -55.9  -99.1  -48.5  108.4 \n   702    703    704    705    706    707    708    709    710    711    712    713    714    715    716    717    718    719 \n -74.6   48.9  -21.7  145.3   47.2  111.2   78.3 -101.6   32.3 -165.5  109.1  -95.2   58.8    9.2   21.6   55.7  -12.1   -4.8 \n   720    721    722    723    724    725    726    727    728    729    730    731    732    733    734    735    736    737 \n -10.8  -60.5  -76.9   84.4   73.9   -5.6    5.1  -22.0   47.5 -134.1   10.7  197.4   89.6   38.2  -49.4   75.9   60.4  -61.1 \n   738    739    740    741    742    743    744    745    746    747    748    749    750    751    752    753    754    755 \n  11.1 -132.7   -0.7  134.0  -42.5   75.1 -129.2  104.5  -12.0   45.1  -43.5   60.4   31.7  -99.1  -48.0  -17.0  -33.3  119.7 \n   756    757    758    759    760    761    762    763    764    765    766    767    768    769    770    771    772    773 \n -66.7 -103.8  -89.5 -169.9    7.7  -52.7   98.8   69.8   -7.9 -127.0  -98.6   51.1  203.0   51.5 -123.9  145.9  -31.4   52.2 \n   774    775    776    777    778    779    780    781    782    783    784    785    786    787    788    789    790    791 \n  37.0  -58.7  -50.0  -10.8   88.4   -4.8   90.1   -8.9  -54.7   36.1 -126.7   -8.3 -103.7   32.7  -27.2   -6.2 -171.0  104.8 \n   792    793    794    795    796    797    798    799    800    801    802    803    804    805    806    807    808    809 \n  23.5   -4.7  174.4   86.7  -22.3  -37.4   11.2   46.3    2.3  -38.0  -53.0  -73.4  -91.0  -48.5   22.8  -52.8  172.2   44.8 \n   810    811    812    813    814    815    816    817    818    819    820    821    822    823    824    825    826    827 \n  19.1  -11.5 -156.9   40.2  -83.0   46.6   -5.1  -59.0  100.2  -11.7 -146.9   16.5   83.3   14.8   34.7   -9.3    2.3   11.2 \n   828    829    830    831    832    833    834    835    836    837 \n -65.5  -10.2   30.6   83.7   28.1   -8.0   22.2   13.2   54.2  -39.5 \n\n\n\u4e88\u6e2c\u7d50\u679c\u306e\u6b63\u7b54\u7387\u691c\u8a3c\nprint(paste(\"\u6b63\u7b54\u3068\u4e88\u6e2c\u7d50\u679c\u306e\u76f8\u95a2\u4fc2\u6570\uff1a\", round(cor(d.test[,1], volatilities.rfp),2)))\n\n\n\n\u6b63\u89e3\u3068\u4e88\u6e2c\u5024\u306e\u76f8\u95a2\u4fc2\u6570\u306f0.97\u3068\u3001\u5168\u4f53\u3067\u307f\u3066\u304d\u308f\u3081\u3066\u9ad8\u3044\n\n[1] \"\u6b63\u7b54\u3068\u4e88\u6e2c\u7d50\u679c\u306e\u76f8\u95a2\u4fc2\u6570\uff1a 0.97\"\n\n\n\nR\nplot(1:nrow(d.test), volatilities.rfp, type=\"l\", col=\"red\")\npar(new=T)\nplot(1:nrow(d.test), d.test[,1], type=\"l\", col=\"blue\")\npar(new=F)\nlegend(\"topleft\", c(\"\u5f53\u65e5 \u5024\u52d5\u304d\u5e45\uff08\u6b63\u89e3\uff09\uff1a\u9752\", \"\u5f53\u65e5 \u5024\u52d5\u304d\u5e45\uff08\u4e88\u6e2c\u5024\uff09\uff1a\u8d64\"))\n\n\n\n\n\n\u3010 \u5206\u985e\u554f\u984c \u3011 SVM vs randomForest \u4e88\u6e2c\u7cbe\u5ea6\u6bd4\u8f03\n\n\n\uff11\uff0e\u30b5\u30dd\u30fc\u30c8\u30d9\u30af\u30bf\u30fc\u30de\u30b7\u30f3\n\n\n\u30c7\u30fc\u30bf\u306e\u6574\u5f62\n\nR\nhead(volatilities)\n\n\n  vol.today vol.1day.ago vol.2day.ago vol.3day.ago vol.4day.ago vol.5day.ago vol.6day.ago vol.7day.ago\n8      -3.73        -3.70       -49.48        26.06        34.32        52.24        -7.18        45.91\n9     -59.23        -3.73        -3.70       -49.48        26.06        34.32        52.24        -7.18\n10     57.94       -59.23        -3.73        -3.70       -49.48        26.06        34.32        52.24\n11    -10.78        57.94       -59.23        -3.73        -3.70       -49.48        26.06        34.32\n12    -55.01       -10.78        57.94       -59.23        -3.73        -3.70       -49.48        26.06\n13   -184.52       -55.01       -10.78        57.94       -59.23        -3.73        -3.70       -49.48\n\n\n\u30ab\u30c6\u30b4\u30ea\u30e9\u30d9\u30eb\u4ed8\u3051\uff08\u5024\u52d5\u304d \u5927\u30fb\u5c0f \uff12\u5206\u985e\u30e9\u30d9\u30eb\u4ed8\u4e0e\uff09\n\ncut()\u95a2\u6570\u306e\u6319\u52d5\u78ba\u8a8d\n\nR\ndetach(volatilities)\n\nprint(cut(volatilities$vol.today, breaks=c(-Inf, median(volatilities$vol.today), Inf), right=FALSE, include.lowest=TRUE, labels=c(\"low\", \"high\")))\n\n\n  [1] low  low  high low  low  low  high high low  high low  high low  high high high low  low  low  high high high high low  high\n [26] high low  low  low  high high high low  high low  low  high low  low  low  low  low  high high high high low  low  low  low \n [51] high high low  low  low  low  low  low  high low  low  high high low  low  low  high low  high low  low  high high high high\n [76] low  high low  low  low  low  high high low  low  low  high low  high high high high high low  low  low  high high high low \n[101] high high low  low  low  low  high high high high low  low  high low  low  low  high high high low  high low  high high high\n[126] low  low  low  high low  high low  low  low  high low  low  low  low  low  high low  high low  high low  high low  low  low \n[151] high low  high high high low  high high low  low  low  high low  low  low  high low  high high low  high low  low  high high\n\n\n                                                       (\u4e2d\u7565)\n\n[751] low  low  low  low  high high low  low  low  high high high low  high high high high low  low  low  high low  high low  low \n[776] high low  low  low  high low  low  low  high high low  high high low  low  high high high low  low  low  low  low  high low \n[801] high high high low  low  high low  high low  low  high high low  high high low  high high high high low  low  high high high\n[826] high high high high low \nLevels: low high\n\n\nR\nvolatilities$vol.today <- cut(volatilities$vol.today, breaks=c(-Inf, median(volatilities$vol.today), Inf), right=FALSE, include.lowest=TRUE, labels=c(\"low\", \"high\"))\nvolatilities$vol.1day.ago <- cut(volatilities$vol.1day.ago, breaks=c(-Inf, median(volatilities$vol.1day.ago), Inf), right=FALSE, include.lowest=TRUE, labels=c(\"low\", \"high\"))\nvolatilities$vol.2day.ago <- cut(volatilities$vol.2day.ago, breaks=c(-Inf, median(volatilities$vol.2day.ago), Inf), right=FALSE, include.lowest=TRUE, labels=c(\"low\", \"high\"))\nvolatilities$vol.3day.ago <- cut(volatilities$vol.3day.ago, breaks=c(-Inf, median(volatilities$vol.3day.ago), Inf), right=FALSE, include.lowest=TRUE, labels=c(\"low\", \"high\"))\nvolatilities$vol.4day.ago <- cut(volatilities$vol.4day.ago, breaks=c(-Inf, median(volatilities$vol.4day.ago), Inf), right=FALSE, include.lowest=TRUE, labels=c(\"low\", \"high\"))\nvolatilities$vol.5day.ago <- cut(volatilities$vol.5day.ago, breaks=c(-Inf, median(volatilities$vol.5day.ago), Inf), right=FALSE, include.lowest=TRUE, labels=c(\"low\", \"high\"))\nvolatilities$vol.6day.ago <- cut(volatilities$vol.6day.ago, breaks=c(-Inf, median(volatilities$vol.6day.ago), Inf), right=FALSE, include.lowest=TRUE, labels=c(\"low\", \"high\"))\nvolatilities$vol.7day.ago <- cut(volatilities$vol.7day.ago, breaks=c(-Inf, median(volatilities$vol.7day.ago), Inf), right=FALSE, include.lowest=TRUE, labels=c(\"low\", \"high\"))\n\n\n\nR\nlength <- length(volatilities$vol.today)\n\nvolatilities$vol.today <- volatilities$vol.today[1:length]\nvolatilities$vol.1day.ago <- volatilities$vol.1day.ago[1:length]\nvolatilities$vol.2day.ago <- volatilities$vol.2day.ago[1:length]\nvolatilities$vol.3day.ago <- volatilities$vol.3day.ago[1:length]\nvolatilities$vol.4day.ago <- volatilities$vol.4day.ago[1:length]\nvolatilities$vol.5day.ago <- volatilities$vol.5day.ago[1:length]\nvolatilities$vol.6day.ago <- volatilities$vol.6day.ago[1:length]\nvolatilities$vol.7day.ago <- volatilities$vol.7day.ago[1:length]\n\nvolatilities.category <- data.frame(vol.0=volatilities$vol.today, vol.1=volatilities$vol.1day.ago, vol.2=volatilities$vol.2day.ago, vol.3=volatilities$vol.3day.ago, vol.4=volatilities$vol.4day.ago, vol.5=volatilities$vol.5day.ago, vol.6=volatilities$vol.6day.ago, vol.7=volatilities$vol.7day.ago)    \n\nprint(head(volatilities.category))\n\n\n vol.0 vol.1 vol.2 vol.3 vol.4 vol.5 vol.6 vol.7\n1   low   low   low  high  high  high   low  high\n2   low   low   low   low  high  high  high   low\n3  high   low   low   low   low  high  high  high\n4   low  high   low   low   low   low  high  high\n5   low   low  high   low   low   low   low  high\n6   low   low   low  high   low   low   low   low\n\n\nR\nprint(tail(volatilities.category))\n\n\n   vol.0 vol.1 vol.2 vol.3 vol.4 vol.5 vol.6 vol.7\n825  high  high  high   low   low  high  high  high\n826  high  high  high  high   low   low  high  high\n827  high  high  high  high  high   low   low  high\n828  high  high  high  high  high  high   low   low\n829  high  high  high  high  high  high  high   low\n830   low  high  high  high  high  high  high  high\n\n\n\u6559\u5e2b\u30c7\u30fc\u30bf\u30fb\u30c6\u30b9\u30c8\u30c7\u30fc\u30bf\u306e\u4f5c\u6210\n\n\u30c7\u30fc\u30bf\u671f\u9593\u306e\u3046\u3061\u300175%\u3092\u6559\u5e2b\u7528\u30c7\u30fc\u30bf\u306b\u3001\u6b8b\u308a25%\u3092\u30c6\u30b9\u30c8\u7528\u30c7\u30fc\u30bf\u306b\u5272\u308a\u632f\u308a\n\nR\nd.train <- volatilities.category[1:nrow(volatilities.category)*0.75, ]\nd.test <- volatilities.category[-1:-nrow(volatilities.category)*0.75, ]\n\n\n\n\u6559\u5e2b\u7528\u30c7\u30fc\u30bf\u306b\u3088\u308b\u30e2\u30c7\u30eb\u751f\u6210\n\nR\nvolatilities.svm <- ksvm(vol.0~., data=d.train, cross=3)\n\n\nUsing automatic sigma estimation (sigest) for RBF or laplace kernel \n\n\nR\nprint(volatilities.svm)\n\n\nSupport Vector Machine object of class \"ksvm\" \n\nSV type: C-svc  (classification) \n parameter : cost C = 1 \n\nGaussian Radial Basis kernel function. \n Hyperparameter : sigma =  0.333333333333333 \n\nNumber of Support Vectors : 765 \n\nObjective Function Value : -700.8955 \nTraining error : 0.379976 \nCross validation error : 0.47043 \n\n\n\u30c6\u30b9\u30c8\u7528\u30c7\u30fc\u30bf\u306b\u3088\u308b\u4e88\u6e2c\n\nR\nvolatilities.prediction <- predict(volatilities.svm, d.test[,-1])  #\u30c6\u30b9\u30c8\u7528\u30c7\u30fc\u30bf\u306e\u3046\u3061\u3001\u5f53\u65e5\u5024\u5e45\u5217\uff08\uff11\u5217\u76ee\uff09\u3092\u524a\u9664\u3057\u3066\u4e0e\u3048\u308b\n\nprint(head(volatilities.prediction))\n\n\n[1] high high low  low  high high\nLevels: low high\n\n\n\u4e88\u6e2c\u6b63\u7b54\u5177\u5408\u306e\u78ba\u8a8d\n\nR\nprecision <- table(d.test[,1], volatilities.prediction)\n\nprint(precision)\n\n\n      volatilities.prediction\n       low high\n  low   60   40\n  high  50   58\n\n\n\u4e88\u6e2c\u6b63\u7b54\u7387\u306e\u7b97\u51fa\n\nR\nprecision.rate <- (1-sum(diag(precision))/sum(precision))*100\n\nprint(paste(\"\u4e88\u6e2c\u6b63\u7b54\u7387: \", round(precision.rate,2), \"%\", sep=\"\"))\n\n\n\n\u6b63\u7b54\u5224\u5225\u7387\u306f\u300143\uff05\u3068\u3001\u671f\u5f85\u3057\u305f6\u5272\u306b\u306f\u5c4a\u304b\u306a\u304b\u3063\u305f\n\n[1] \"\u4e88\u6e2c\u6b63\u7b54\u7387: 43.27%\"\n\n\n\n\uff12\uff0e\u30e9\u30f3\u30c0\u30e0\u30d5\u30a9\u30ec\u30b9\u30c8\u30e2\u30c7\u30eb\uff08\u5206\u985e\u554f\u984c\uff09\n\n\n\u6559\u5e2b\u7528\u30c7\u30fc\u30bf\u306b\u3088\u308b\u30e2\u30c7\u30eb\u751f\u6210\n\nR\nvolatilities.rf <- randomForest(vol.0~., data=d.train, na.action=\"na.omit\")\n\nprint(volatilities.rf)\n\n\nCall:\n randomForest(formula = vol.0 ~ ., data = d.train, na.action = \"na.omit\") \n               Type of random forest: classification\n                     Number of trees: 500\nNo. of variables tried at each split: 2\n\n        OOB estimate of  error rate: 43.67%\nConfusion matrix:\n     low high class.error\nlow  242  179   0.4251781\nhigh 183  225   0.4485294\n\n\n\u7d50\u679c\u3092\u8868\u793a\n\nR\nsummary(volatilities.rf)\n\n\n                Length Class  Mode     \ncall               4   -none- call     \ntype               1   -none- character\npredicted        829   factor numeric  \nerr.rate        1500   -none- numeric  \nconfusion          6   -none- numeric  \nvotes           1658   matrix numeric  \noob.times        829   -none- numeric  \nclasses            2   -none- character\nimportance         7   -none- numeric  \nimportanceSD       0   -none- NULL     \nlocalImportance    0   -none- NULL     \nproximity          0   -none- NULL     \nntree              1   -none- numeric  \nmtry               1   -none- numeric  \nforest            14   -none- list     \ny                829   factor numeric  \ntest               0   -none- NULL     \ninbag              0   -none- NULL     \nterms              3   terms  call     \n\n\n\u6728\u306e\u6570\u3068\u8aa4\u308a\u7387\u306e\u95a2\u4fc2\u3092\u30c1\u30a7\u30c3\u30af\n\nR\nplot(volatilities.rf)\n\n\n\n\n\n[\u6570\u5024]\u5909\u6570\u306e\u91cd\u8981\u5ea6\u30e9\u30f3\u30ad\u30f3\u30b0\u6f14\u7b97\u7d50\u679c\u3092\u51fa\u529b\n\nR\nprint(volatilities.rf$importance)\n\n\n\n\u56de\u5e30\u554f\u984c\u306e\u7d50\u679c\u3068\u540c\u69d8\u306e\u30e9\u30f3\u30af\u9806\u3068\u306a\u3063\u305f\u3002\n\n2\u65e5\u524d > 7\u65e5\u524d > 1\u65e5\u524d > 5\u65e5\u524d > 3\u65e5\u524d > 4\u65e5\u524d > 6\u65e5\u524d \u306e\u53d6\u5f15\u6642\u9593\u5185 \u5024\u4ed8\u5909\u52d5\u5e45\u306e\u5024\u304c\u3001\u5f53\u65e5\u306e\u5024\u4ed8\u5909\u52d5\u5e45\u306b\u5f37\u3044\u5f71\u97ff\u3092\u4e0e\u3048\u3066\u3044\u308b\u3068\u5224\u5b9a\u3055\u308c\u305f\n     MeanDecreaseGini\nvol.1         6.895772\nvol.2         7.167366\nvol.3         6.624163\nvol.4         6.129990\nvol.5         6.876739\nvol.6         6.126697\nvol.7         7.161890\n\n\n[\u30b0\u30e9\u30d5]\u5909\u6570\u306e\u91cd\u8981\u5ea6\u30e9\u30f3\u30ad\u30f3\u30b0\u6f14\u7b97\u7d50\u679c\u3092\u51fa\u529b\n\nR\nvarImpPlot(volatilities.rf)\n\n\n\n\n\u30c6\u30b9\u30c8\u7528\u30c7\u30fc\u30bf\u3092\u5f53\u3066\u306f\u3081\u3066\u3001\u30c6\u30b9\u30c8\u30c7\u30fc\u30bf\u671f\u9593\u306e\u5f53\u65e5\u30dc\u30e9\u30c6\u30a3\u30ea\u30c6\u30a3\u3092\u4e88\u6e2c\n\nR\nvolatilities.rfp <- predict(volatilities.rf, d.test[,-1])  #\u30c6\u30b9\u30c8\u7528\u30c7\u30fc\u30bf\u306e\u3046\u3061\u3001\u5f53\u65e5\u5024\u5e45\u5217\uff08\uff11\u5217\u76ee\uff09\u3092\u524a\u9664\u3057\u3066\u4e0e\u3048\u308b\n\nprint(volatilities.rfp)\n\n\n 623  624  625  626  627  628  629  630  631  632  633  634  635  636  637  638  639  640  641  642  643  644  645  646  647  648 \nhigh high  low  low high high  low high  low high  low high high  low high high  low  low high  low  low  low high  low  low  low \n 649  650  651  652  653  654  655  656  657  658  659  660  661  662  663  664  665  666  667  668  669  670  671  672  673  674 \n low  low  low  low  low  low  low  low high high  low  low  low  low high high high  low high high  low  low high high high  low \n 675  676  677  678  679  680  681  682  683  684  685  686  687  688  689  690  691  692  693  694  695  696  697  698  699  700 \n low high  low  low  low high high  low  low high high high  low high high high high  low  low high high  low high high high high \n 701  702  703  704  705  706  707  708  709  710  711  712  713  714  715  716  717  718  719  720  721  722  723  724  725  726 \nhigh  low  low high  low  low  low high high high  low  low  low  low  low  low high high high  low high high  low  low high high \n 727  728  729  730  731  732  733  734  735  736  737  738  739  740  741  742  743  744  745  746  747  748  749  750  751  752 \n low  low high  low  low  low high high high  low  low high high high high high high high  low  low high high high  low  low high \n 753  754  755  756  757  758  759  760  761  762  763  764  765  766  767  768  769  770  771  772  773  774  775  776  777  778 \n low high high high  low  low high high high high  low  low high  low high  low  low  low high high  low high high  low high  low \n 779  780  781  782  783  784  785  786  787  788  789  790  791  792  793  794  795  796  797  798  799  800  801  802  803  804 \n low high high high  low high high high  low high  low high  low high  low high  low high high high high high  low high  low high \n 805  806  807  808  809  810  811  812  813  814  815  816  817  818  819  820  821  822  823  824  825  826  827  828  829  830 \n low  low high high high high  low high high high  low  low high  low  low  low  low  low  low high high high  low  low  low  low \nLevels: low high\n\n\n\u4e88\u6e2c\u6b63\u7b54\u5177\u5408\u306e\u78ba\u8a8d\n\nR\nprecision.rfp <- table(d.test[,1], volatilities.rfp)\n\nprint(precision.rfp)\n\n\n      volatilities.rfp\n       low high\n  low   55   45\n  high  46   62\n\n\n\u4e88\u6e2c\u6b63\u7b54\u7387\u306e\u7b97\u51fa\n\nR\nprecision.rate.rfp <- (1-sum(diag(precision.rfp))/sum(precision.rfp))*100\n\nprint(paste(\"\u4e88\u6e2c\u6b63\u7b54\u7387: \", round(precision.rate.rfp,2), \"%\", sep=\"\"))\n\n\n\n\u6b63\u7b54\u5224\u5225\u7387\u306f\u3001\u56de\u5e30\u554f\u984c\u306e\u5834\u5408\u3068\u540c\u305843\uff05\u3067\u3042\u3063\u305f\u3002\u671f\u5f85\u3057\u305f6\u5272\u306b\u306f\u5c4a\u304b\u306a\u304b\u3063\u305f\n\n[1] \"\u4e88\u6e2c\u6b63\u7b54\u7387: 43.75%\n\n# R\u3067\u6a5f\u68b0\u5b66\u7fd2(PRML)\uff1aSVM  vs \u30e9\u30f3\u30c0\u30e0\u30d5\u30a9\u30ec\u30b9\u30c8\u30e2\u30c7\u30eb \n#\uff08\u682a\u4fa1\u30b7\u30ca\u30ea\u30aa\u2461\uff09\u65e5\u7d4c\u5e73\u5747\u5024\u52d5\u304d\u5e45 \u904e\u53bb\u65e5\u9023\u52d5\u6027\u691c\u8a3c\n\n* __\u3010 \u691c\u8a3c\u4e8b\u9805 \u3011__\n\n\u65e5\u7d4c\u5e73\u5747\u682a\u4fa1\u306e\u5404\u65e5\u306e\uff08\u53d6\u5f15\u6642\u9593\u5185\uff09\u306e\u5024\u52d5\u304d\u5e45\uff08\u30dc\u30e9\u30c6\u30a3\u30ea\u30c6\u30a3\uff1a ((\u5f53\u65e5\u7d42\u5024-\u5f53\u65e5\u59cb\u5024)/\u5f53\u65e5\u59cb\u5024)*100) )\u306f\u3001X\u65e5\u524d\u306e\u5024\u52d5\u304d\u30dc\u30e9\u30c6\u30a3\u30ea\u30c6\u30a3 ( ((X\u65e5\u524d\u306e\u7d42\u5024-X\u65e5\u524d\u306e\u59cb\u5024)/X\u65e5\u524d\u306e\u59cb\u5024)*100) ) \u3068\u3001\u3069\u306e\u3088\u3046\u306a\u95a2\u9023\u6027\u304c\u3042\u308b\u304b\u3002\u203bX = 1 \uff5e 7\n\n* __\u3010 \u4e8b\u524d\u4eee\u8aac \u3011__\n\n\u5f53\u65e5\u306e\u5024\u52d5\u304d\u30dc\u30e9\u30c6\u30a3\u30ea\u30c6\u30a3( ((\u5f53\u65e5\u7d42\u5024-\u5f53\u65e5\u59cb\u5024)/\u5f53\u65e5\u59cb\u5024)*100) )\u306f\u3001X\u306e\u5024\u304c\u3088\u308a\u5c0f\u3055\u3044 X\u65e5\u524d\u306e\u5024\u52d5\u304d\u30dc\u30e9\u30c6\u30a3\u30ea\u30c6\u30a3 ( ((X\u65e5\u524d\u306e\u7d42\u5024-X\u65e5\u524d\u306e\u59cb\u5024)/X\u65e5\u524d\u306e\u59cb\u5024)*100) ) \u304b\u3089\u3001\u5f37\u3044\u5f71\u97ff\u3092\u53d7\u3051\u3066\u3044\u308b\n\n* __\u3010 \u80cc\u666f\u306b\u3042\u308b\u77e5\u898b \u3011__\n\n####\uff08 GARCH\u30e2\u30c7\u30eb \uff09\n\u3042\u308b\u65e5\u306e\u682a\u4fa1\u30dc\u30e9\u30c6\u30a3\u30ea\u30c6\u30a3\u306f\u3001\u8fd1\u3044\u904e\u53bb\u65e5\u306e\u30dc\u30e9\u30c6\u30a3\u30ea\u30c6\u30a3\u306b\u5f15\u3063\u5f35\u3089\u308c\u308b\u300d\uff08\u4e0a\u3052\uff08\u4e0b\u3052\uff09\u76f8\u5834\u304c\u7d9a\u3044\u3066\u3044\u308b\u671f\u9593\u4e2d\u306f\u3001\u7fcc\u65e5\u3082\u4e0a\u3052\uff08\u4e0b\u3052\uff09\u76f8\u5834 \uff09\u3068\u3044\u3046\u4eee\u8aac\u306b\u7acb\u811a\u3057\u3066\u3044\u308b\u3002\n\n___\n\n###__\u30c7\u30fc\u30bf\u4f5c\u6210\u5de5\u7a0b__\n\n####\u30a6\u30a7\u30d6\u30b5\u30a4\u30c8\u300c\u65e5\u7d4c\u5e73\u5747\u30d7\u30ed\u30d5\u30a3\u30eb \u65e5\u7d4c\u306e\u6307\u6570\u60c5\u5831\u30b5\u30a4\u30c8\u300d\u3067\u516c\u958b\u3055\u308c\u3066\u3044\u308b\u65e5\u7d4c\u5e73\u5747\u682a\u4fa1\u306e\u65e5\u6b21\u30c7\u30fc\u30bf\u30d5\u30a1\u30a4\u30eb\u3092R\u306b\u53d6\u308a\u8fbc\u3080\n\n```{R:R}\naddress <- \"http://indexes.nikkei.co.jp/nkave/historical/nikkei_stock_average_daily_jp.csv\"\nnikkei225 <- read.csv(file=url(address), header=TRUE, sep=\",\")\n```\n\n####\u30c7\u30fc\u30bf\u306e\u5192\u982d\u3092\u78ba\u8a8d\n```{R:R}  \nhead(nikkei225)\n```\n\n``` \n  \u30c7\u30fc\u30bf\u65e5\u4ed8     \u7d42\u5024     \u59cb\u5024     \u9ad8\u5024     \u5b89\u5024\n1 2011/01/04 10398.10 10352.19 10409.17 10321.28\n2 2011/01/05 10380.77 10387.95 10413.45 10358.01\n3 2011/01/06 10529.76 10477.52 10530.11 10477.52\n4 2011/01/07 10541.04 10506.72 10550.71 10503.02\n5 2011/01/11 10510.68 10484.62 10538.39 10476.29\n6 2011/01/12 10512.80 10562.28 10576.51 10502.96\n```\n####\u30c7\u30fc\u30bf\u306e\u672b\u5c3e\u3092\u78ba\u8a8d\n\n```{R:R}\ntail(nikkei225,3)\n```\n\n```\n836                                                                                                                             2014/05/29 14681.72 14585.64 14714.95\n837                                                                                                                             2014/05/30 14632.38 14707.66 14741.10\n838 \u672c\u8cc7\u6599\u306f\u65e5\u7d4c\u306e\u8457\u4f5c\u7269\u3067\u3042\u308a\u3001\u672c\u8cc7\u6599\u306e\u5168\u90e8\u53c8\u306f\u4e00\u90e8\u3092\u3001\u3044\u304b\u306a\u308b\u5f62\u5f0f\u306b\u3088\u3063\u3066\u3082\u65e5\u7d4c\u306b\u7121\u65ad\u3067\u8907\u5199\u3001\u8907\u88fd\u3001\u8ee2\u8f09\u307e\u305f\u306f\u6d41\u5e03\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u305b\u3093\u3002       NA       NA       NA\n        \u5b89\u5024\n836 14574.02\n837 14591.62\n838       NA\n```\n\n#### \u672b\u5c3e\u306b\u6587\u7ae0\uff08\u6ce8\u8a18\uff09\u304c\u8a18\u8ff0\u3055\u308c\u3066\u3044\u308b\u305f\u3081\u3001\u30c7\u30fc\u30bf\u30aa\u30d6\u30b8\u30a7\u30af\u30c8 nikkei225 \u304b\u3089\u3001 838\u884c\u76ee\u3092\u524a\u9664\n\n```{R:R}\nnikkei225 <- nikkei225[-838, ]\n\ntail(nikkei225,10)\n```\n\n\n#### \u4e0b\u8a18\u306e\u3068\u304a\u308a\u3001\u6587\u5b57\u5217\u304c\u524a\u9664\u3055\u308c\u305f\u3002\n```\n    \u30c7\u30fc\u30bf\u65e5\u4ed8     \u7d42\u5024     \u59cb\u5024     \u9ad8\u5024     \u5b89\u5024\n828 2014/05/19 14006.44 14130.09 14150.50 13991.80\n829 2014/05/20 14075.25 14088.45 14144.04 14038.06\n830 2014/05/21 14042.17 13969.71 14054.24 13964.43\n831 2014/05/22 14337.79 14188.28 14369.02 14147.55\n832 2014/05/23 14462.17 14411.10 14528.04 14404.80\n833 2014/05/26 14602.52 14592.60 14602.52 14531.32\n834 2014/05/27 14636.52 14589.79 14744.16 14588.68\n835 2014/05/28 14670.95 14646.93 14717.29 14608.54\n836 2014/05/29 14681.72 14585.64 14714.95 14574.02\n837 2014/05/30 14632.38 14707.66 14741.10 14591.62\n```\n\n#### \u4e0a\u8a18\u306e\u30c7\u30fc\u30bf\u3092\u3082\u3068\u306b\u3001\u6771\u8a3c\u55b6\u696d\u65e5\u6bce\u306e\u53d6\u5f15\u6642\u9593\u5185 \u5024\u52d5\u304d\u5e45\u3092\u7b97\u51fa \u21d2 \u5f53\u65e5\u30011\u55b6\u696d\u65e5\u524d\uff5e7\u55b6\u696d\u65e5\u524d\u306e\u5024\u52d5\u304d\u5e45\u306e\u5217\u3092\u8ffd\u52a0\n\n```{R:R}\ncolnames(nikkei225) <- c(\"date\",\"close\", \"open\", \"high\", \"low\")\n\n# head(nikkei225); class(nikkei225)\n\nattach(nikkei225)\n\n#\u3000\u5404\u65e5\u306e\u5024\u5e45 (\u5f53\u65e5\u7d42\u5024-\u5f53\u65e5\u59cb\u5024) / \u5f53\u65e5\u59cb\u5024\nvolatility <- close-open\n\n#  \u5f53\u65e5\u306e\u5024\u5e45 (\u5f53\u65e5\u7d42\u5024-\u5f53\u65e5\u59cb\u5024) / \u5f53\u65e5\u59cb\u5024\nchange.0 <- volatility\n# class(change.0)  numeric\u578b\n# length(change.0) 837\u884c\n# head(change.0) 45.91  -7.18  52.24  34.32  26.06 -49.48\n# length(change.0) 837\u884c\n\n#  \u524d\u65e5\u306e\u5024\u5e45 (\u524d\u65e5\u7d42\u5024-\u524d\u65e5\u59cb\u5024) / \u524d\u65e5\u59cb\u5024\nchange.1= c(0,volatility)\n# head(change.1)  0.00 45.91 -7.18 52.24 34.32 26.06\n# length(change.1) 838\u884c\n\n#  2\u65e5\u524d\u306e\u5024\u5e45 (2\u65e5\u524d\u7d42\u5024-2\u65e5\u524d\u59cb\u5024) / 2\u65e5\u524d\u59cb\u5024\nchange.2= c(rep(0,2),volatility)\n# head(change.2) 0.00  0.00 45.91 -7.18 52.24 34.32\n# length(change.2) 839\u884c\n\n#  3\u65e5\u524d\u306e\u5024\u5e45 (3\u65e5\u524d\u7d42\u5024-3\u65e5\u524d\u59cb\u5024) / 3\u65e5\u524d\u59cb\u5024\nchange.3= c(rep(0,3),volatility)\n# head(change.3) 0.00  0.00  0.00 45.91 -7.18 52.24\n# length(change.2) 839\u884c\n\n#  4\u65e5\u524d\u306e\u5024\u5e45 (4\u65e5\u524d\u7d42\u5024-4\u65e5\u524d\u59cb\u5024) / 4\u65e5\u524d\u59cb\u5024\nchange.4= c(rep(0,4),volatility)\n\n#  5\u65e5\u524d\u306e\u5024\u5e45 (5\u65e5\u524d\u7d42\u5024-5\u65e5\u524d\u59cb\u5024) / 5\u65e5\u524d\u59cb\u5024\nchange.5= c(rep(0,5),volatility)\n\n#  6\u65e5\u524d\u306e\u5024\u5e45 (6\u65e5\u524d\u7d42\u5024-6\u65e5\u524d\u59cb\u5024) / 6\u65e5\u524d\u59cb\u5024\nchange.6= c(rep(0,6),volatility)\n\n#  7\u65e5\u524d\u306e\u5024\u5e45 (7\u65e5\u524d\u7d42\u5024-7\u65e5\u524d\u59cb\u5024) / 7\u65e5\u524d\u59cb\u5024\nchange.7= c(rep(0,7),volatility)\n# head(change.7, 10) 0.00  0.00  0.00  0.00  0.00  0.00  0.00 45.91 -7.18 52.24\n# length(change.7)  844\u884c\n\n#### \u5192\u982d\u306e837\u884c\u3060\u3051\u5229\u7528\n\n# length(change.0) 837\u884c\nchange.1 <- change.1[1:837]  # length(change.1) 837\nchange.2 <- change.2[1:837]  # length(change.2) 837\nchange.3 <- change.3[1:837]  # length(change.3) 837\nchange.4 <- change.4[1:837]  # length(change.4) 837\nchange.5 <- change.5[1:837]  # length(change.5) 837\nchange.6 <- change.6[1:837]  # length(change.6) 837\nchange.7 <- change.7[1:837]  # length(change.7) 837\n\nnikkei.225 <- data.frame(date=date, vol.today=change.0, vol.1day.ago=change.1, vol.2day.ago=change.2, vol.3day.ago=change.3, vol.4day.ago=change.4, vol.5day.ago=change.5, vol.6day.ago=change.6, vol.7day.ago=change.7)\n\nhead(nikkei.225)\n\n```\n\n```\n\n        date vol.today vol.1day.ago vol.2day.ago vol.3day.ago vol.4day.ago vol.5day.ago vol.6day.ago vol.7day.ago\n1 2011/01/04     45.91         0.00         0.00         0.00         0.00         0.00            0            0\n2 2011/01/05     -7.18        45.91         0.00         0.00         0.00         0.00            0            0\n3 2011/01/06     52.24        -7.18        45.91         0.00         0.00         0.00            0            0\n4 2011/01/07     34.32        52.24        -7.18        45.91         0.00         0.00            0            0\n5 2011/01/11     26.06        34.32        52.24        -7.18        45.91         0.00            0            0\n6 2011/01/12    -49.48        26.06        34.32        52.24        -7.18        45.91            0            0\n\n```\n\n\n```{R:R}\ntail(nikkei.225)\n```\n\n```\n          date vol.today vol.1day.ago vol.2day.ago vol.3day.ago vol.4day.ago vol.5day.ago vol.6day.ago vol.7day.ago\n832 2014/05/23     51.07       149.51        72.46       -13.20      -123.65         8.83        17.70        20.16\n833 2014/05/26      9.92        51.07       149.51        72.46       -13.20      -123.65         8.83        17.70\n834 2014/05/27     46.73         9.92        51.07       149.51        72.46       -13.20      -123.65         8.83\n835 2014/05/28     24.02        46.73         9.92        51.07       149.51        72.46       -13.20      -123.65\n836 2014/05/29     96.08        24.02        46.73         9.92        51.07       149.51        72.46       -13.20\n837 2014/05/30    -75.28        96.08        24.02        46.73         9.92        51.07       149.51        72.46\n```\n\n#### \u904e\u53bb\u65e5\u30dc\u30e9\u30c6\u30a3\u30ea\u30c6\u30a3\u30c7\u30fc\u30bf\u306e\u306a\u3044\uff080\uff09\u304c\u57cb\u3081\u8fbc\u307e\u308c\u305f\u5192\u982d7\u884c\u3092\u524a\u9664\n\n```{R:R}\nnikkei.225 <- nikkei.225[-1:-7,]\n\nhead(nikkei.225)\n```\n\n```\n         date vol.today vol.1day.ago vol.2day.ago vol.3day.ago vol.4day.ago vol.5day.ago vol.6day.ago vol.7day.ago\n8  2011/01/14     -3.73        -3.70       -49.48        26.06        34.32        52.24        -7.18        45.91\n9  2011/01/17    -59.23        -3.73        -3.70       -49.48        26.06        34.32        52.24        -7.18\n10 2011/01/18     57.94       -59.23        -3.73        -3.70       -49.48        26.06        34.32        52.24\n11 2011/01/19    -10.78        57.94       -59.23        -3.73        -3.70       -49.48        26.06        34.32\n12 2011/01/20    -55.01       -10.78        57.94       -59.23        -3.73        -3.70       -49.48        26.06\n13 2011/01/21   -184.52       -55.01       -10.78        57.94       -59.23        -3.73        -3.70       -49.48\n```\n\n\n```{R:R}\ntail(nikkei.225)\n```\n\n```\n          date vol.today vol.1day.ago vol.2day.ago vol.3day.ago vol.4day.ago vol.5day.ago vol.6day.ago vol.7day.ago\n832 2014/05/23     51.07       149.51        72.46       -13.20      -123.65         8.83        17.70        20.16\n833 2014/05/26      9.92        51.07       149.51        72.46       -13.20      -123.65         8.83        17.70\n834 2014/05/27     46.73         9.92        51.07       149.51        72.46       -13.20      -123.65         8.83\n835 2014/05/28     24.02        46.73         9.92        51.07       149.51        72.46       -13.20      -123.65\n836 2014/05/29     96.08        24.02        46.73         9.92        51.07       149.51        72.46       -13.20\n837 2014/05/30    -75.28        96.08        24.02        46.73         9.92        51.07       149.51        72.46\n```\n\n####\u3010\u6570\u5024\u3011\u7d42\u5024\u3068\u5404X\u65e5\u524d\u6bd4\u4e0a\u6607\u7387(%)\u3068\u306e\u76f8\u95a2\u4fc2\u6570\n\n```{R:R}\ncor(nikkei.225[,-1]) # 1\u5217\u76ee\u306e\u5e74\u6708\u65e5\u5217\u3092\u9664\u3044\u3066\u76f8\u95a2\u4fc2\u6570\u884c\u5217\u3092\u6f14\u7b97\n```\n\n```\n                vol.today vol.1day.ago vol.2day.ago vol.3day.ago vol.4day.ago vol.5day.ago vol.6day.ago vol.7day.ago\nvol.today     1.000000000  -0.06867998  -0.02420786  -0.11593313  -0.04689344   0.10205580  -0.04837342  0.007228203\nvol.1day.ago -0.068679977   1.00000000  -0.06814720  -0.02406817  -0.11568889  -0.04683790   0.10239227 -0.047562322\nvol.2day.ago -0.024207860  -0.06814720   1.00000000  -0.06846877  -0.02458239  -0.11600097  -0.04724201  0.101168506\nvol.3day.ago -0.115933130  -0.02406817  -0.06846877   1.00000000  -0.06849066  -0.02448528  -0.11613188 -0.047482275\nvol.4day.ago -0.046893443  -0.11568889  -0.02458239  -0.06849066   1.00000000  -0.06837783  -0.02470496 -0.116670123\nvol.5day.ago  0.102055804  -0.04683790  -0.11600097  -0.02448528  -0.06837783   1.00000000  -0.06844889 -0.024659982\nvol.6day.ago -0.048373416   0.10239227  -0.04724201  -0.11613188  -0.02470496  -0.06844889   1.00000000 -0.069157801\nvol.7day.ago  0.007228203  -0.04756232   0.10116851  -0.04748227  -0.11667012  -0.02465998  -0.06915780  1.000000000\n```\n\n####\u3010\u6563\u5e03\u56f3\u3011\u7d42\u5024\u3068\u5404X\u65e5\u524d\u6bd4\u4e0a\u6607\u7387(%)\u3068\u306e\u76f8\u95a2\u4fc2\u6570\n\n```{R:R}\npairs(nikkei.225[,-1])\n```\n\n ![graph.1.png](https://qiita-image-store.s3.amazonaws.com/0/43487/ab81b51c-d1ce-cd94-b95a-b22ddd2cfda6.png)\n\n#### \u7dda\u5f62\u91cd\u56de\u5e30\u5206\u6790\uff08\u95a2\u6570 lm()\uff09\n\n```{R:R}  \nvolatility.lm <- lm(vol.today~vol.1day.ago+vol.2day.ago+vol.3day.ago+vol.4day.ago*vol.5day.ago+vol.6day.ago+vol.7day.ago, data=nikkei.225[,-1])\n\nprint(summary(volatility.lm))\n```\n\n\n- \u5404\u8aac\u660e\u5909\u6570\u306ep\u5024\uff085%\u6709\u610f\u6c34\u6e96\uff09\u306f\u3001vol.3day.ago, vol.5day.ago\u304c\u6709\u610f\n- \u81ea\u7531\u5ea6\u8abf\u6574\u6e08\u307f\u6c7a\u5b9a\u4fc2\u6570\u306f\u30010.00026\u3068\u304d\u308f\u3081\u3066\u4f4e\u3044 \n- F\u691c\u5b9a\u306ep\u5024\u306f1%\u6c34\u6e96\u306e\u3082\u3068\u3067\u3082\u6709\u610f\n\n#### \u203b \u7cfb\u5217\u76f8\u95a2\u30fb\u591a\u91cd\u5171\u7dda\u6027\u306e\u691c\u5b9a\u306f\u5272\u611b  \uff08\u8aac\u660e\u5909\u6570\u3069\u3046\u3057\u3001\u8aac\u660e\u5909\u6570\u3068\u8aa4\u5dee\u9805\u306e\u9593\u306e\u76f8\u95a2\u6709\u7121\u306e\u691c\u5b9a\uff09\n\n```\nCall:\nlm(formula = vol.today ~ vol.1day.ago + vol.2day.ago + vol.3day.ago + \n    vol.4day.ago * vol.5day.ago + vol.6day.ago + vol.7day.ago, \n    data = nikkei.225[, -1])\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-1192.49   -51.79     3.99    54.45   444.45 \n\nCoefficients:\n                            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)               -2.3232471  4.2759436  -0.543 0.587050    \nvol.1day.ago              -0.0687484  0.0352519  -1.950 0.051492 .  \nvol.2day.ago              -0.0324408  0.0349781  -0.927 0.353961    \nvol.3day.ago              -0.1294462  0.0348665  -3.713 0.000219 ***\nvol.4day.ago              -0.0614408  0.0350690  -1.752 0.080147 .  \nvol.5day.ago               0.0850836  0.0348919   2.438 0.014960 *  \nvol.6day.ago              -0.0548783  0.0349958  -1.568 0.117234    \nvol.7day.ago              -0.0082790  0.0349434  -0.237 0.812773    \nvol.4day.ago:vol.5day.ago  0.0001106  0.0001717   0.644 0.519701    \n---\nSignif. codes:  0 \u2018***\u2019 0.001 \u2018**\u2019 0.01 \u2018*\u2019 0.05 \u2018.\u2019 0.1 \u2018 \u2019 1\n\nResidual standard error: 122.9 on 821 degrees of freedom\nMultiple R-squared:  0.03507,\tAdjusted R-squared:  0.02567 \nF-statistic:  3.73 on 8 and 821 DF,  p-value: 0.0002679\n```\n\n___\n\n###__\u6559\u5e2b\u30c7\u30fc\u30bf\u30fb\u30c6\u30b9\u30c8\u30c7\u30fc\u30bf\u306e\u4f5c\u6210__\n\n#### \u5e74\u6708\u65e5\u5217\u306e\u524a\u9664 \uff08\u5225\u540d\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u4f5c\u6210\uff09\n```{R:R}  \nvolatilities <- nikkei.225[,-1] \n\nhead(volatilities)\n```\n\n\n```\n   vol.today vol.1day.ago vol.2day.ago vol.3day.ago vol.4day.ago vol.5day.ago vol.6day.ago vol.7day.ago\n8      -3.73        -3.70       -49.48        26.06        34.32        52.24        -7.18        45.91\n9     -59.23        -3.73        -3.70       -49.48        26.06        34.32        52.24        -7.18\n10     57.94       -59.23        -3.73        -3.70       -49.48        26.06        34.32        52.24\n11    -10.78        57.94       -59.23        -3.73        -3.70       -49.48        26.06        34.32\n12    -55.01       -10.78        57.94       -59.23        -3.73        -3.70       -49.48        26.06\n13   -184.52       -55.01       -10.78        57.94       -59.23        -3.73        -3.70       -49.48\n```\n\n### \u30c7\u30fc\u30bf\u671f\u9593\u306e\u3046\u3061\u300175%\u3092\u6559\u5e2b\u7528\u30c7\u30fc\u30bf\u306b\u3001\u6b8b\u308a25%\u3092\u30c6\u30b9\u30c8\u7528\u30c7\u30fc\u30bf\u306b\u5272\u308a\u632f\u308a\n\n```{R:R}\nd.train <- volatilities[1:nrow(volatilities)*0.75, ]\nd.test <- volatilities[-1:-nrow(volatilities)*0.75, ]\n```\n\n#### \u30c7\u30fc\u30bf\u65e5\u6570\uff08\u6559\u5e2b\u30c7\u30fc\u30bf\u30fb\u30c6\u30b9\u30c8\u30c7\u30fc\u30bf\uff09\n\n```{R:R}\nprint(paste(\"\u6559\u5e2b\u7528\u30c7\u30fc\u30bf\u306e\u65e5\u6570\uff1a \", nrow(d.train), \"\u65e5\u5206\", sep=\"\"));\nprint(paste(\"\u30c6\u30b9\u30c8\u7528\u30c7\u30fc\u30bf\u306e\u65e5\u6570\uff1a \", nrow(d.test), \"\u65e5\u5206\", sep=\"\"))\n```\n\n```\n[1] \"\u6559\u5e2b\u7528\u30c7\u30fc\u30bf\u306e\u65e5\u6570\uff1a 829\u65e5\u5206\"\n[1] \"\u30c6\u30b9\u30c8\u7528\u30c7\u30fc\u30bf\u306e\u65e5\u6570\uff1a 208\u65e5\u5206\"\n```\n\n___\n\n##__\u3010 \u56de\u5e30\u554f\u984c \u3011 SVM vs randomForest \u4e88\u6e2c\u7cbe\u5ea6\u6bd4\u8f03__\n\n###__\uff11\uff0e\u30b5\u30dd\u30fc\u30c8\u30d9\u30af\u30bf\u30fc\u30de\u30b7\u30f3__\n\n####\u30d1\u30c3\u30b1\u30fc\u30b8\u300ckernlab\u300d\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3068\u30e1\u30e2\u30ea\u8aad\u8fbc\u307f\n\n```{R:R}\ninstall.packages(\"kernlab\")\n```\n\n```\nInstalling package into \u2018C:/Users/owner/Documents/R/win-library/3.0\u2019\n(as \u2018lib\u2019 is unspecified)\ntrying URL 'http://cran.rstudio.com/bin/windows/contrib/3.0/kernlab_0.9-19.zip'\nContent type 'application/zip' length 2029405 bytes (1.9 Mb)\nopened URL\ndownloaded 1.9 Mb\n\npackage \u2018kernlab\u2019 successfully unpacked and MD5 sums checked\n\nThe downloaded binary packages are in\n\tC:\\Users\\owner\\AppData\\Local\\Temp\\RtmpmCII8Q\\downloaded_packages\n```\n\n```{R:R}\nlibrary(kernlab)\n```\n\n```\nWarning message:\n \u30d1\u30c3\u30b1\u30fc\u30b8 \u2018kernlab\u2019 \u306f\u30d0\u30fc\u30b8\u30e7\u30f3 3.0.2 \u306e R \u306e\u4e0b\u3067\u9020\u3089\u308c\u307e\u3057\u305f  \n```\n\n#### \u6559\u5e2b\u7528\u30c7\u30fc\u30bf\u306b\u3088\u308b\u30e2\u30c7\u30eb\u751f\u6210\n##### \u5358\u56de\u5e30\u4ee5\u5916\u306b\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306aformula\u306e\u4e0e\u3048\u65b9\u3067\u3001\u591a\u91cd\u56de\u5e30\u3092\u3057\u3066\u3082\u3088\u3044\u306e\u304b\u306f\u3001\u8981\u691c\u8a3c\uff08\u52d5\u4f5c\u306f\u3057\u3066\u3001\u8fd4\u308a\u5024\u306f\u8fd4\u3055\u308c\u305f\uff09\n\n```{R:R}  \nvolatilities.svm <- ksvm(vol.today ~ vol.1day.ago + vol.2day.ago + vol.3day.ago + vol.4day.ago * vol.5day.ago + vol.6day.ago + vol.7day.ago, data=volatilities, epsilon=0.01, kpar=list(sigma=16))\n\nprint(volatilities.svm)\n```\n\n```\nSupport Vector Machine object of class \"ksvm\" \n\nSV type: eps-svr  (regression) \n parameter : epsilon = 0.01  cost C = 1 \n\nGaussian Radial Basis kernel function. \n Hyperparameter : sigma =  16 \n\nNumber of Support Vectors : 817 \n\nObjective Function Value : -273.8392 \nTraining error : 0.3319 \n```\n\n####\u30c6\u30b9\u30c8\u7528\u30c7\u30fc\u30bf\u306b\u3088\u308b\u4e88\u6e2c\n\n```{R:R}  \nvolatilities.prediction <- predict(volatilities.svm, d.test[,-1])  #\u30c6\u30b9\u30c8\u7528\u30c7\u30fc\u30bf\u306e\u3046\u3061\u3001\u5f53\u65e5\u5024\u5e45\u5217\uff081\u5217\u76ee\uff09\u3092\u524a\u9664\u3057\u3066\u4e0e\u3048\u308b\n\nprint(head(volatilities.prediction))\n```\n\n```\n           [,1]\n[1,]   10.37949\n[2,] -123.22547\n[3,] -123.22547\n[4,] -123.22547\n[5,]  125.83255\n[6,]  -64.02182\n```\n\n\n####\u4e88\u6e2c\u7d50\u679c\u306e\u6b63\u7b54\u7387\u691c\u8a3c\n\n```{R:R}\nplot(1:nrow(d.test), volatilities.prediction, type=\"l\", col=\"red\")\npar(new=T)\nplot(1:nrow(d.test), d.test[,1], type=\"l\", col=\"blue\") #d.test[,1]\uff081\u5217\u76ee\uff09\u306b\u6b63\u89e3\u5024\uff08\u5b9f\u969b\u306e\u5f53\u65e5\u5024\u52d5\u304d\u5e45\uff09\u304c\u683c\u7d0d\u3002\npar(new=F)\nlegend(\"topleft\", c(\"\u5f53\u65e5 \u5024\u52d5\u304d\u5e45\uff08\u6b63\u89e3\uff09\uff1a\u9752\", \"\u5f53\u65e5 \u5024\u52d5\u304d\u5e45\uff08\u4e88\u6e2c\u5024\uff09\uff1a\u8d64\"))\n\ncor.value <- round(cor(d.test[,1], volatilities.prediction),2)\nprint(paste(\"\u6b63\u7b54\u3068\u4e88\u6e2c\u7d50\u679c\u306e\u76f8\u95a2\u4fc2\u6570\uff1a\", cor.value))\n```\n\n![graph.2.png](https://qiita-image-store.s3.amazonaws.com/0/43487/e23a7f1e-4f14-3f23-aca4-3a6efe523dc5.png)\n\n\n* __\u4e88\u6e2c\u7cbe\u5ea6\u306f94%\u3068\u6975\u3081\u3066\u9ad8\u3044__\n\n```\n[1] \"\u6b63\u7b54\u3068\u4e88\u6e2c\u7d50\u679c\u306e\u76f8\u95a2\u4fc2\u6570\uff1a 0.94\"\n```\n\n___\n\n###__\uff12\uff0e\u30e9\u30f3\u30c0\u30e0\u30d5\u30a9\u30ec\u30b9\u30c8\u30e2\u30c7\u30eb__\n\n###\u6559\u5e2b\u7528\u30c7\u30fc\u30bf\u306b\u3088\u308b\u30e2\u30c7\u30eb\u751f\u6210\n\n```{R:R}\ninstall.packages(\"randomForest\")\nlibrary(randomForest)\n\nvolatilities.rf <- randomForest(vol.today ~ vol.1day.ago + vol.2day.ago + vol.3day.ago + vol.4day.ago * vol.5day.ago + vol.6day.ago + vol.7day.ago, data=volatilities, na.action=\"na.omit\")\n\nprint(volatilities.rf)\n```\n\n```\nCall:\n randomForest(formula = vol.today ~ vol.1day.ago + vol.2day.ago +      vol.3day.ago + vol.4day.ago * vol.5day.ago + vol.6day.ago +      vol.7day.ago, data = volatilities, na.action = \"na.omit\") \n               Type of random forest: regression\n                     Number of trees: 500\nNo. of variables tried at each split: 2\n\n          Mean of squared residuals: 16155.97\n                    % Var explained: -4.31\n\n```\n\n```{R:R}  \nsummary(volatilities.rf)\n```\n\n``` \n               Length Class  Mode     \ncall              4    -none- call     \ntype              1    -none- character\npredicted       830    -none- numeric  \nmse             500    -none- numeric  \nrsq             500    -none- numeric  \noob.times       830    -none- numeric  \nimportance        7    -none- numeric  \nimportanceSD      0    -none- NULL     \nlocalImportance   0    -none- NULL     \nproximity         0    -none- NULL     \nntree             1    -none- numeric  \nmtry              1    -none- numeric  \nforest           11    -none- list     \ncoefs             0    -none- NULL     \ny               830    -none- numeric  \ntest              0    -none- NULL     \ninbag             0    -none- NULL     \nterms             3    terms  call     \n```\n\n#### \u6728\u306e\u6570\u3068\u8aa4\u308a\u7387\u306e\u95a2\u4fc2\u3092\u30c1\u30a7\u30c3\u30af\n```{R:R}\nplot(volatilities.rf)\n  \n```\n\n![graph.3.png](https://qiita-image-store.s3.amazonaws.com/0/43487/d01c3b5f-384f-c864-d8ee-823c3d5859dd.png)\n\n \n\n#### \u5909\u6570\u306e\u91cd\u8981\u5ea6\u30e9\u30f3\u30ad\u30f3\u30b0\u3092\u51fa\u529b\n\n```{R:R}\nprint(volatilities.rf$importance)\n```\n\n```\n             IncNodePurity\nvol.1day.ago       1914448\nvol.2day.ago       1643255\nvol.3day.ago       1637977\nvol.4day.ago       1893461\nvol.5day.ago       1487329\nvol.6day.ago       1627349\nvol.7day.ago       1223966\n```\n\n#### \u30c6\u30b9\u30c8\u7528\u30c7\u30fc\u30bf\u3092\u5f53\u3066\u306f\u3081\u3066\u3001\u30c6\u30b9\u30c8\u30c7\u30fc\u30bf\u671f\u9593\u306e\u5f53\u65e5\u30dc\u30e9\u30c6\u30a3\u30ea\u30c6\u30a3\u3092\u4e88\u6e2c\n\n```{R:R}\nvolatilities.rfp <- predict(volatilities.rf, d.test[,-1]) \n\nprint(round(volatilities.rfp, 1))\n```\n\n```\n   630    631    632    633    634    635    636    637    638    639    640    641    642    643    644    645    646    647 \n  38.1  -95.5 -107.9 -143.2  138.9  -38.2  198.1  159.9 -106.5  107.7 -285.5  -85.5  -30.2   13.8  108.4   47.9  -75.8   75.5 \n   648    649    650    651    652    653    654    655    656    657    658    659    660    661    662    663    664    665 \n  55.2 -141.4   -2.4   61.0   66.3  -40.4    1.2   10.1   44.4  -94.1   79.2  131.0   94.5  -64.3 -119.3   20.2   85.2  -64.1 \n   666    667    668    669    670    671    672    673    674    675    676    677    678    679    680    681    682    683 \n   6.0   49.9  -79.8   52.2   52.9  -29.0   80.5  -60.2  131.0   -6.5  -54.5  -22.0 -237.1   15.7  -20.3  -88.6   92.1  120.0 \n   684    685    686    687    688    689    690    691    692    693    694    695    696    697    698    699    700    701 \n  78.7   13.1  -44.2   26.8   -7.2  -24.0   39.0   27.3 -176.9   83.2 -147.1  123.4   33.2   42.7  -55.9  -99.1  -48.5  108.4 \n   702    703    704    705    706    707    708    709    710    711    712    713    714    715    716    717    718    719 \n -74.6   48.9  -21.7  145.3   47.2  111.2   78.3 -101.6   32.3 -165.5  109.1  -95.2   58.8    9.2   21.6   55.7  -12.1   -4.8 \n   720    721    722    723    724    725    726    727    728    729    730    731    732    733    734    735    736    737 \n -10.8  -60.5  -76.9   84.4   73.9   -5.6    5.1  -22.0   47.5 -134.1   10.7  197.4   89.6   38.2  -49.4   75.9   60.4  -61.1 \n   738    739    740    741    742    743    744    745    746    747    748    749    750    751    752    753    754    755 \n  11.1 -132.7   -0.7  134.0  -42.5   75.1 -129.2  104.5  -12.0   45.1  -43.5   60.4   31.7  -99.1  -48.0  -17.0  -33.3  119.7 \n   756    757    758    759    760    761    762    763    764    765    766    767    768    769    770    771    772    773 \n -66.7 -103.8  -89.5 -169.9    7.7  -52.7   98.8   69.8   -7.9 -127.0  -98.6   51.1  203.0   51.5 -123.9  145.9  -31.4   52.2 \n   774    775    776    777    778    779    780    781    782    783    784    785    786    787    788    789    790    791 \n  37.0  -58.7  -50.0  -10.8   88.4   -4.8   90.1   -8.9  -54.7   36.1 -126.7   -8.3 -103.7   32.7  -27.2   -6.2 -171.0  104.8 \n   792    793    794    795    796    797    798    799    800    801    802    803    804    805    806    807    808    809 \n  23.5   -4.7  174.4   86.7  -22.3  -37.4   11.2   46.3    2.3  -38.0  -53.0  -73.4  -91.0  -48.5   22.8  -52.8  172.2   44.8 \n   810    811    812    813    814    815    816    817    818    819    820    821    822    823    824    825    826    827 \n  19.1  -11.5 -156.9   40.2  -83.0   46.6   -5.1  -59.0  100.2  -11.7 -146.9   16.5   83.3   14.8   34.7   -9.3    2.3   11.2 \n   828    829    830    831    832    833    834    835    836    837 \n -65.5  -10.2   30.6   83.7   28.1   -8.0   22.2   13.2   54.2  -39.5 \n```\n\n#### \u4e88\u6e2c\u7d50\u679c\u306e\u6b63\u7b54\u7387\u691c\u8a3c\n\n```\nprint(paste(\"\u6b63\u7b54\u3068\u4e88\u6e2c\u7d50\u679c\u306e\u76f8\u95a2\u4fc2\u6570\uff1a\", round(cor(d.test[,1], volatilities.rfp),2)))\n\n```\n\n* __\u6b63\u89e3\u3068\u4e88\u6e2c\u5024\u306e\u76f8\u95a2\u4fc2\u6570\u306f0.97\u3068\u3001\u5168\u4f53\u3067\u307f\u3066\u304d\u308f\u3081\u3066\u9ad8\u3044__\n\n```\n[1] \"\u6b63\u7b54\u3068\u4e88\u6e2c\u7d50\u679c\u306e\u76f8\u95a2\u4fc2\u6570\uff1a 0.97\"\n\n```\n\n```{R:R}\nplot(1:nrow(d.test), volatilities.rfp, type=\"l\", col=\"red\")\npar(new=T)\nplot(1:nrow(d.test), d.test[,1], type=\"l\", col=\"blue\")\npar(new=F)\nlegend(\"topleft\", c(\"\u5f53\u65e5 \u5024\u52d5\u304d\u5e45\uff08\u6b63\u89e3\uff09\uff1a\u9752\", \"\u5f53\u65e5 \u5024\u52d5\u304d\u5e45\uff08\u4e88\u6e2c\u5024\uff09\uff1a\u8d64\"))\n```\n\n![graph.4.png](https://qiita-image-store.s3.amazonaws.com/0/43487/4b06c7a8-cac9-6b68-8821-f38404270c3b.png)\n\n___\n\n##__\u3010 \u5206\u985e\u554f\u984c \u3011 SVM vs randomForest \u4e88\u6e2c\u7cbe\u5ea6\u6bd4\u8f03__\n\n###__\uff11\uff0e\u30b5\u30dd\u30fc\u30c8\u30d9\u30af\u30bf\u30fc\u30de\u30b7\u30f3__\n\n#### \u30c7\u30fc\u30bf\u306e\u6574\u5f62\n\n```{R:R}  \nhead(volatilities)\n```\n\n``` \n  vol.today vol.1day.ago vol.2day.ago vol.3day.ago vol.4day.ago vol.5day.ago vol.6day.ago vol.7day.ago\n8      -3.73        -3.70       -49.48        26.06        34.32        52.24        -7.18        45.91\n9     -59.23        -3.73        -3.70       -49.48        26.06        34.32        52.24        -7.18\n10     57.94       -59.23        -3.73        -3.70       -49.48        26.06        34.32        52.24\n11    -10.78        57.94       -59.23        -3.73        -3.70       -49.48        26.06        34.32\n12    -55.01       -10.78        57.94       -59.23        -3.73        -3.70       -49.48        26.06\n13   -184.52       -55.01       -10.78        57.94       -59.23        -3.73        -3.70       -49.48\n```\n\n#### \u30ab\u30c6\u30b4\u30ea\u30e9\u30d9\u30eb\u4ed8\u3051\uff08\u5024\u52d5\u304d \u5927\u30fb\u5c0f \uff12\u5206\u985e\u30e9\u30d9\u30eb\u4ed8\u4e0e\uff09\n\n#### cut()\u95a2\u6570\u306e\u6319\u52d5\u78ba\u8a8d\n\n```{R:R}\ndetach(volatilities)\n\nprint(cut(volatilities$vol.today, breaks=c(-Inf, median(volatilities$vol.today), Inf), right=FALSE, include.lowest=TRUE, labels=c(\"low\", \"high\")))\n```\n\n```\n  [1] low  low  high low  low  low  high high low  high low  high low  high high high low  low  low  high high high high low  high\n [26] high low  low  low  high high high low  high low  low  high low  low  low  low  low  high high high high low  low  low  low \n [51] high high low  low  low  low  low  low  high low  low  high high low  low  low  high low  high low  low  high high high high\n [76] low  high low  low  low  low  high high low  low  low  high low  high high high high high low  low  low  high high high low \n[101] high high low  low  low  low  high high high high low  low  high low  low  low  high high high low  high low  high high high\n[126] low  low  low  high low  high low  low  low  high low  low  low  low  low  high low  high low  high low  high low  low  low \n[151] high low  high high high low  high high low  low  low  high low  low  low  high low  high high low  high low  low  high high\n\n\n                                                       (\u4e2d\u7565)\n\n[751] low  low  low  low  high high low  low  low  high high high low  high high high high low  low  low  high low  high low  low \n[776] high low  low  low  high low  low  low  high high low  high high low  low  high high high low  low  low  low  low  high low \n[801] high high high low  low  high low  high low  low  high high low  high high low  high high high high low  low  high high high\n[826] high high high high low \nLevels: low high\n```\n\n\n```{R:R}\nvolatilities$vol.today <- cut(volatilities$vol.today, breaks=c(-Inf, median(volatilities$vol.today), Inf), right=FALSE, include.lowest=TRUE, labels=c(\"low\", \"high\"))\nvolatilities$vol.1day.ago <- cut(volatilities$vol.1day.ago, breaks=c(-Inf, median(volatilities$vol.1day.ago), Inf), right=FALSE, include.lowest=TRUE, labels=c(\"low\", \"high\"))\nvolatilities$vol.2day.ago <- cut(volatilities$vol.2day.ago, breaks=c(-Inf, median(volatilities$vol.2day.ago), Inf), right=FALSE, include.lowest=TRUE, labels=c(\"low\", \"high\"))\nvolatilities$vol.3day.ago <- cut(volatilities$vol.3day.ago, breaks=c(-Inf, median(volatilities$vol.3day.ago), Inf), right=FALSE, include.lowest=TRUE, labels=c(\"low\", \"high\"))\nvolatilities$vol.4day.ago <- cut(volatilities$vol.4day.ago, breaks=c(-Inf, median(volatilities$vol.4day.ago), Inf), right=FALSE, include.lowest=TRUE, labels=c(\"low\", \"high\"))\nvolatilities$vol.5day.ago <- cut(volatilities$vol.5day.ago, breaks=c(-Inf, median(volatilities$vol.5day.ago), Inf), right=FALSE, include.lowest=TRUE, labels=c(\"low\", \"high\"))\nvolatilities$vol.6day.ago <- cut(volatilities$vol.6day.ago, breaks=c(-Inf, median(volatilities$vol.6day.ago), Inf), right=FALSE, include.lowest=TRUE, labels=c(\"low\", \"high\"))\nvolatilities$vol.7day.ago <- cut(volatilities$vol.7day.ago, breaks=c(-Inf, median(volatilities$vol.7day.ago), Inf), right=FALSE, include.lowest=TRUE, labels=c(\"low\", \"high\"))\n```\n\n\n```{R:R}\nlength <- length(volatilities$vol.today)\n\nvolatilities$vol.today <- volatilities$vol.today[1:length]\nvolatilities$vol.1day.ago <- volatilities$vol.1day.ago[1:length]\nvolatilities$vol.2day.ago <- volatilities$vol.2day.ago[1:length]\nvolatilities$vol.3day.ago <- volatilities$vol.3day.ago[1:length]\nvolatilities$vol.4day.ago <- volatilities$vol.4day.ago[1:length]\nvolatilities$vol.5day.ago <- volatilities$vol.5day.ago[1:length]\nvolatilities$vol.6day.ago <- volatilities$vol.6day.ago[1:length]\nvolatilities$vol.7day.ago <- volatilities$vol.7day.ago[1:length]\n\nvolatilities.category <- data.frame(vol.0=volatilities$vol.today, vol.1=volatilities$vol.1day.ago, vol.2=volatilities$vol.2day.ago, vol.3=volatilities$vol.3day.ago, vol.4=volatilities$vol.4day.ago, vol.5=volatilities$vol.5day.ago, vol.6=volatilities$vol.6day.ago, vol.7=volatilities$vol.7day.ago)    \n\nprint(head(volatilities.category))\n```\n\n```\n vol.0 vol.1 vol.2 vol.3 vol.4 vol.5 vol.6 vol.7\n1   low   low   low  high  high  high   low  high\n2   low   low   low   low  high  high  high   low\n3  high   low   low   low   low  high  high  high\n4   low  high   low   low   low   low  high  high\n5   low   low  high   low   low   low   low  high\n6   low   low   low  high   low   low   low   low\n```\n\n```{R:R}\nprint(tail(volatilities.category))\n```\n\n```  \n   vol.0 vol.1 vol.2 vol.3 vol.4 vol.5 vol.6 vol.7\n825  high  high  high   low   low  high  high  high\n826  high  high  high  high   low   low  high  high\n827  high  high  high  high  high   low   low  high\n828  high  high  high  high  high  high   low   low\n829  high  high  high  high  high  high  high   low\n830   low  high  high  high  high  high  high  high\n```\n\n#### \u6559\u5e2b\u30c7\u30fc\u30bf\u30fb\u30c6\u30b9\u30c8\u30c7\u30fc\u30bf\u306e\u4f5c\u6210\n#### \u30c7\u30fc\u30bf\u671f\u9593\u306e\u3046\u3061\u300175%\u3092\u6559\u5e2b\u7528\u30c7\u30fc\u30bf\u306b\u3001\u6b8b\u308a25%\u3092\u30c6\u30b9\u30c8\u7528\u30c7\u30fc\u30bf\u306b\u5272\u308a\u632f\u308a\n\n```{R:R}\nd.train <- volatilities.category[1:nrow(volatilities.category)*0.75, ]\nd.test <- volatilities.category[-1:-nrow(volatilities.category)*0.75, ]\n```\n\n#### \u6559\u5e2b\u7528\u30c7\u30fc\u30bf\u306b\u3088\u308b\u30e2\u30c7\u30eb\u751f\u6210\n```{R:R}\nvolatilities.svm <- ksvm(vol.0~., data=d.train, cross=3)\n```\n\n```\nUsing automatic sigma estimation (sigest) for RBF or laplace kernel \n```\n\n```{R:R}\nprint(volatilities.svm)\n```\n\n```\nSupport Vector Machine object of class \"ksvm\" \n\nSV type: C-svc  (classification) \n parameter : cost C = 1 \n\nGaussian Radial Basis kernel function. \n Hyperparameter : sigma =  0.333333333333333 \n\nNumber of Support Vectors : 765 \n\nObjective Function Value : -700.8955 \nTraining error : 0.379976 \nCross validation error : 0.47043 \n```\n\n#### \u30c6\u30b9\u30c8\u7528\u30c7\u30fc\u30bf\u306b\u3088\u308b\u4e88\u6e2c\n\n```{R:R}  \nvolatilities.prediction <- predict(volatilities.svm, d.test[,-1])  #\u30c6\u30b9\u30c8\u7528\u30c7\u30fc\u30bf\u306e\u3046\u3061\u3001\u5f53\u65e5\u5024\u5e45\u5217\uff08\uff11\u5217\u76ee\uff09\u3092\u524a\u9664\u3057\u3066\u4e0e\u3048\u308b\n\nprint(head(volatilities.prediction))\n```\n\n```\n[1] high high low  low  high high\nLevels: low high\n```\n\n#### \u4e88\u6e2c\u6b63\u7b54\u5177\u5408\u306e\u78ba\u8a8d\n\n```{R:R}  \nprecision <- table(d.test[,1], volatilities.prediction)\n\nprint(precision)\n```\n\n```\n      volatilities.prediction\n       low high\n  low   60   40\n  high  50   58\n```\n\n\n#### \u4e88\u6e2c\u6b63\u7b54\u7387\u306e\u7b97\u51fa\n\n```{R:R}\nprecision.rate <- (1-sum(diag(precision))/sum(precision))*100\n\nprint(paste(\"\u4e88\u6e2c\u6b63\u7b54\u7387: \", round(precision.rate,2), \"%\", sep=\"\"))\n``` \n\n* __\u6b63\u7b54\u5224\u5225\u7387\u306f\u300143\uff05\u3068\u3001\u671f\u5f85\u3057\u305f6\u5272\u306b\u306f\u5c4a\u304b\u306a\u304b\u3063\u305f__\n\n```\n[1] \"\u4e88\u6e2c\u6b63\u7b54\u7387: 43.27%\"\n```\n\n___\n\n###__\uff12\uff0e\u30e9\u30f3\u30c0\u30e0\u30d5\u30a9\u30ec\u30b9\u30c8\u30e2\u30c7\u30eb\uff08\u5206\u985e\u554f\u984c\uff09__\n\n#### \u6559\u5e2b\u7528\u30c7\u30fc\u30bf\u306b\u3088\u308b\u30e2\u30c7\u30eb\u751f\u6210\n```{R:R}\nvolatilities.rf <- randomForest(vol.0~., data=d.train, na.action=\"na.omit\")\n\nprint(volatilities.rf)\n```\n\n```\nCall:\n randomForest(formula = vol.0 ~ ., data = d.train, na.action = \"na.omit\") \n               Type of random forest: classification\n                     Number of trees: 500\nNo. of variables tried at each split: 2\n\n        OOB estimate of  error rate: 43.67%\nConfusion matrix:\n     low high class.error\nlow  242  179   0.4251781\nhigh 183  225   0.4485294\n```\n\n#### \u7d50\u679c\u3092\u8868\u793a\n\n```{R:R}\nsummary(volatilities.rf)\n```\n\n```\n                Length Class  Mode     \ncall               4   -none- call     \ntype               1   -none- character\npredicted        829   factor numeric  \nerr.rate        1500   -none- numeric  \nconfusion          6   -none- numeric  \nvotes           1658   matrix numeric  \noob.times        829   -none- numeric  \nclasses            2   -none- character\nimportance         7   -none- numeric  \nimportanceSD       0   -none- NULL     \nlocalImportance    0   -none- NULL     \nproximity          0   -none- NULL     \nntree              1   -none- numeric  \nmtry               1   -none- numeric  \nforest            14   -none- list     \ny                829   factor numeric  \ntest               0   -none- NULL     \ninbag              0   -none- NULL     \nterms              3   terms  call     \n```\n\n\n#### \u6728\u306e\u6570\u3068\u8aa4\u308a\u7387\u306e\u95a2\u4fc2\u3092\u30c1\u30a7\u30c3\u30af\n\n```{R:R}\nplot(volatilities.rf)\n  \n```\n\n![graph.5.png](https://qiita-image-store.s3.amazonaws.com/0/43487/743ea461-9ab6-3bb7-2956-c34310c3988b.png)\n\n\n\n#### [\u6570\u5024]\u5909\u6570\u306e\u91cd\u8981\u5ea6\u30e9\u30f3\u30ad\u30f3\u30b0\u6f14\u7b97\u7d50\u679c\u3092\u51fa\u529b\n\n```{R:R}\nprint(volatilities.rf$importance)\n```\n\n#### \u56de\u5e30\u554f\u984c\u306e\u7d50\u679c\u3068\u540c\u69d8\u306e\u30e9\u30f3\u30af\u9806\u3068\u306a\u3063\u305f\u3002\n### 2\u65e5\u524d > 7\u65e5\u524d > 1\u65e5\u524d > 5\u65e5\u524d > 3\u65e5\u524d > 4\u65e5\u524d > 6\u65e5\u524d \u306e\u53d6\u5f15\u6642\u9593\u5185 \u5024\u4ed8\u5909\u52d5\u5e45\u306e\u5024\u304c\u3001\u5f53\u65e5\u306e\u5024\u4ed8\u5909\u52d5\u5e45\u306b\u5f37\u3044\u5f71\u97ff\u3092\u4e0e\u3048\u3066\u3044\u308b\u3068\u5224\u5b9a\u3055\u308c\u305f\n\n```\n     MeanDecreaseGini\nvol.1         6.895772\nvol.2         7.167366\nvol.3         6.624163\nvol.4         6.129990\nvol.5         6.876739\nvol.6         6.126697\nvol.7         7.161890\n```\n\n#### [\u30b0\u30e9\u30d5]\u5909\u6570\u306e\u91cd\u8981\u5ea6\u30e9\u30f3\u30ad\u30f3\u30b0\u6f14\u7b97\u7d50\u679c\u3092\u51fa\u529b\n\n```{R:R}\nvarImpPlot(volatilities.rf)\n```\n\n![graph.6.png](https://qiita-image-store.s3.amazonaws.com/0/43487/3daa3575-8e36-c14a-8ad5-32bec70fbd55.png)\n\n\n#### \u30c6\u30b9\u30c8\u7528\u30c7\u30fc\u30bf\u3092\u5f53\u3066\u306f\u3081\u3066\u3001\u30c6\u30b9\u30c8\u30c7\u30fc\u30bf\u671f\u9593\u306e\u5f53\u65e5\u30dc\u30e9\u30c6\u30a3\u30ea\u30c6\u30a3\u3092\u4e88\u6e2c\n\n```{R:R}\nvolatilities.rfp <- predict(volatilities.rf, d.test[,-1])  #\u30c6\u30b9\u30c8\u7528\u30c7\u30fc\u30bf\u306e\u3046\u3061\u3001\u5f53\u65e5\u5024\u5e45\u5217\uff08\uff11\u5217\u76ee\uff09\u3092\u524a\u9664\u3057\u3066\u4e0e\u3048\u308b\n\nprint(volatilities.rfp)\n```\n\n``` \n 623  624  625  626  627  628  629  630  631  632  633  634  635  636  637  638  639  640  641  642  643  644  645  646  647  648 \nhigh high  low  low high high  low high  low high  low high high  low high high  low  low high  low  low  low high  low  low  low \n 649  650  651  652  653  654  655  656  657  658  659  660  661  662  663  664  665  666  667  668  669  670  671  672  673  674 \n low  low  low  low  low  low  low  low high high  low  low  low  low high high high  low high high  low  low high high high  low \n 675  676  677  678  679  680  681  682  683  684  685  686  687  688  689  690  691  692  693  694  695  696  697  698  699  700 \n low high  low  low  low high high  low  low high high high  low high high high high  low  low high high  low high high high high \n 701  702  703  704  705  706  707  708  709  710  711  712  713  714  715  716  717  718  719  720  721  722  723  724  725  726 \nhigh  low  low high  low  low  low high high high  low  low  low  low  low  low high high high  low high high  low  low high high \n 727  728  729  730  731  732  733  734  735  736  737  738  739  740  741  742  743  744  745  746  747  748  749  750  751  752 \n low  low high  low  low  low high high high  low  low high high high high high high high  low  low high high high  low  low high \n 753  754  755  756  757  758  759  760  761  762  763  764  765  766  767  768  769  770  771  772  773  774  775  776  777  778 \n low high high high  low  low high high high high  low  low high  low high  low  low  low high high  low high high  low high  low \n 779  780  781  782  783  784  785  786  787  788  789  790  791  792  793  794  795  796  797  798  799  800  801  802  803  804 \n low high high high  low high high high  low high  low high  low high  low high  low high high high high high  low high  low high \n 805  806  807  808  809  810  811  812  813  814  815  816  817  818  819  820  821  822  823  824  825  826  827  828  829  830 \n low  low high high high high  low high high high  low  low high  low  low  low  low  low  low high high high  low  low  low  low \nLevels: low high\n```\n\n#### \u4e88\u6e2c\u6b63\u7b54\u5177\u5408\u306e\u78ba\u8a8d\n\n```{R:R}\nprecision.rfp <- table(d.test[,1], volatilities.rfp)\n\nprint(precision.rfp)\n```\n\n``` \n      volatilities.rfp\n       low high\n  low   55   45\n  high  46   62\n```\n\n#### \u4e88\u6e2c\u6b63\u7b54\u7387\u306e\u7b97\u51fa\n\n```{R:R}\nprecision.rate.rfp <- (1-sum(diag(precision.rfp))/sum(precision.rfp))*100\n\nprint(paste(\"\u4e88\u6e2c\u6b63\u7b54\u7387: \", round(precision.rate.rfp,2), \"%\", sep=\"\"))\n```\n\n* __\u6b63\u7b54\u5224\u5225\u7387\u306f\u3001\u56de\u5e30\u554f\u984c\u306e\u5834\u5408\u3068\u540c\u305843\uff05\u3067\u3042\u3063\u305f\u3002\u671f\u5f85\u3057\u305f6\u5272\u306b\u306f\u5c4a\u304b\u306a\u304b\u3063\u305f__\n\n``` \n[1] \"\u4e88\u6e2c\u6b63\u7b54\u7387: 43.75%\n```\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n", "tags": ["\u7cbe\u5ea6\u6bd4\u8f03", "\u6a5f\u68b0\u5b66\u7fd2", "MachineLearning", "Finance", "\u30c7\u30fc\u30bf\u5206\u6790"]}