{"tags": ["\u7d71\u8a08\u691c\u5b9a", "\u7d71\u8a08\u5b66", "R"], "context": "\u30001\u5909\u6570\u306et\u691c\u5b9a\u306f\u3088\u304f\u77e5\u3089\u308c\u3066\u3044\u308b\u304c\u30012\u5909\u6570\u4ee5\u4e0a\u306e\u5834\u5408\u306f\u3069\u3046\u3059\u308c\u3070\u3088\u3044\u306e\u3060\u308d\u3046\u30022\u5909\u6570\u306e\u5834\u5408\u306fF\u691c\u5b9a\u3092\u3059\u308b\u3053\u3068\u3082\u53ef\u80fd\u3067\u3042\u308b\u30023\u5909\u6570\u4ee5\u4e0a\u5834\u5408\u306f\u3001\u305d\u308c\u305e\u308c\u306et\u691c\u5b9a\u3059\u308b\u3053\u3068\u306f\u3088\u304f\u3055\u308c\u3066\u3044\u308b\u3068\u601d\u3046\u304c\u3001\u500b\u4eba\u7684\u306a\u8003\u3048\u3067\u3001\u540c\u6642\u306b\u691c\u5b9a\u3057\u306a\u3051\u308c\u3070\u306a\u3089\u306a\u3044\u3002\n\n\u7dda\u5f62\u30e2\u30c7\u30eb\nyt=\u03b21x1,t+\u03b22x2,t+\u03b5t,\u03b5t\u223cN(0,\u03c32)y_t={\\beta_1}{x_{1,t}}+{\\beta_2}{x_{2,t}}+\\varepsilon_t,\\varepsilon_t\\sim{N(0,\\sigma^2)}\n\n\u56de\u5e30\u4fc2\u6570\u306e\u63a8\u5b9a\u91cf\n{\\begin{bmatrix} \\hat{\\beta_1} \\\\ \\hat{\\beta_2} \\end{bmatrix}}\n=\n{\\begin{bmatrix} \\sum{(x_{1,t})^2} & \\sum{{x_{1,t}}{x_{2,t}}} \\\\ \\sum{{x_{1,t}}{x_{2,t}}} & \\sum{(x_{2,t})^2} \\end{bmatrix}}^{-1}\n{\\begin{bmatrix} \\sum{{x_{1,t}}{y_t}} \\\\ \\sum{{x_{2,t}}{y_t}} \\end{bmatrix}}\n[^\u03b21^\u03b22]=[\u2211(x1,t)2\u2211x1,tx2,t\u2211x1,tx2,t\u2211(x2,t)2]\u22121[\u2211x1,tyt\u2211x2,tyt]{{\\begin{bmatrix} \\hat{\\beta_1} \\\\ \\hat{\\beta_2} \\end{bmatrix}}\n=\n{\\begin{bmatrix} \\sum{(x_{1,t})^2} & \\sum{{x_{1,t}}{x_{2,t}}} \\\\ \\sum{{x_{1,t}}{x_{2,t}}} & \\sum{(x_{2,t})^2} \\end{bmatrix}}^{-1}\n{\\begin{bmatrix} \\sum{{x_{1,t}}{y_t}} \\\\ \\sum{{x_{2,t}}{y_t}} \\end{bmatrix}}\n}\n\n\u63a8\u5b9a\u91cf\u3068\u771f\u306e\u5024\u306e\u5dee\n{\\begin{bmatrix} \\hat{\\beta_1} \\\\ \\hat{\\beta_2} \\end{bmatrix}}\n-{\\begin{bmatrix} \\beta_1 \\\\ \\beta_2 \\end{bmatrix}}\n=\n{\\begin{bmatrix} \\sum{(x_{1,t})^2} & \\sum{{x_{1,t}}{x_{2,t}}} \\\\ \\sum{{x_{1,t}}{x_{2,t}}} & \\sum{(x_{2,t})^2} \\end{bmatrix}}^{-1}\n{\\begin{bmatrix} \\sum{{x_{1,t}}{\\varepsilon_t}} \\\\ \\sum{{x_{2,t}}{\\varepsilon_t}} \\end{bmatrix}}\n[^\u03b21^\u03b22]\u2212[\u03b21\u03b22]=[\u2211(x1,t)2\u2211x1,tx2,t\u2211x1,tx2,t\u2211(x2,t)2]\u22121[\u2211x1,t\u03b5t\u2211x2,t\u03b5t]{{\\begin{bmatrix} \\hat{\\beta_1} \\\\ \\hat{\\beta_2} \\end{bmatrix}}\n-{\\begin{bmatrix} \\beta_1 \\\\ \\beta_2 \\end{bmatrix}}\n=\n{\\begin{bmatrix} \\sum{(x_{1,t})^2} & \\sum{{x_{1,t}}{x_{2,t}}} \\\\ \\sum{{x_{1,t}}{x_{2,t}}} & \\sum{(x_{2,t})^2} \\end{bmatrix}}^{-1}\n{\\begin{bmatrix} \\sum{{x_{1,t}}{\\varepsilon_t}} \\\\ \\sum{{x_{2,t}}{\\varepsilon_t}} \\end{bmatrix}}\n}\n\n\u671f\u5f85\u5024\u3068\u5206\u6563\n\\begin{align}\nE{\\begin{bmatrix} \\hat{\\beta_1}-\\beta_1 \\\\ \\hat{\\beta_2}-\\beta_2 \\end{bmatrix}}\n&=\n{\\begin{bmatrix} \\sum{(x_{1,t})^2} & \\sum{{x_{1,t}}{x_{2,t}}} \\\\ \\sum{{x_{1,t}}{x_{2,t}}} & \\sum{(x_{2,t})^2} \\end{bmatrix}}^{-1}\nE{\\begin{bmatrix} \\sum{{x_{1,t}}{\\varepsilon_t}} \\\\ \\sum{{x_{2,t}}{\\varepsilon_t}} \\end{bmatrix}} \\\\\n&=\n{\\begin{bmatrix} 0 \\\\ 0 \\end{bmatrix}}\n\\end{align}\nE[^\u03b21\u2212\u03b21^\u03b22\u2212\u03b22]=[\u2211(x1,t)2\u2211x1,tx2,t\u2211x1,tx2,t\u2211(x2,t)2]\u22121E[\u2211x1,t\u03b5t\u2211x2,t\u03b5t]=[00]{\\begin{align}\nE{\\begin{bmatrix} \\hat{\\beta_1}-\\beta_1 \\\\ \\hat{\\beta_2}-\\beta_2 \\end{bmatrix}}\n&=\n{\\begin{bmatrix} \\sum{(x_{1,t})^2} & \\sum{{x_{1,t}}{x_{2,t}}} \\\\ \\sum{{x_{1,t}}{x_{2,t}}} & \\sum{(x_{2,t})^2} \\end{bmatrix}}^{-1}\nE{\\begin{bmatrix} \\sum{{x_{1,t}}{\\varepsilon_t}} \\\\ \\sum{{x_{2,t}}{\\varepsilon_t}} \\end{bmatrix}} \\\\\n&=\n{\\begin{bmatrix} 0 \\\\ 0 \\end{bmatrix}}\n\\end{align}\n}\n\\begin{align}\nvar{\\begin{bmatrix} \\hat{\\beta_1}-\\beta_1 \\\\ \\hat{\\beta_2}-\\beta_2 \\end{bmatrix}}\n&=\n{\\begin{bmatrix} \\sum{(x_{1,t})^2} & \\sum{{x_{1,t}}{x_{2,t}}} \\\\ \\sum{{x_{1,t}}{x_{2,t}}} & \\sum{(x_{2,t})^2} \\end{bmatrix}}^{-1}\nvar{\\begin{bmatrix} \\sum{{x_{1,t}}{\\varepsilon_t}} \\\\ \\sum{{x_{2,t}}{\\varepsilon_t}} \\end{bmatrix}} \\\\\n&=\n{\\sigma}^2\n{\\begin{bmatrix} \\sum{(x_{1,t})^2} & \\sum{{x_{1,t}}{x_{2,t}}} \\\\ \\sum{{x_{1,t}}{x_{2,t}}} & \\sum{(x_{2,t})^2} \\end{bmatrix}}^{-1}\n\\end{align}\nvar[^\u03b21\u2212\u03b21^\u03b22\u2212\u03b22]=[\u2211(x1,t)2\u2211x1,tx2,t\u2211x1,tx2,t\u2211(x2,t)2]\u22121var[\u2211x1,t\u03b5t\u2211x2,t\u03b5t]=\u03c32[\u2211(x1,t)2\u2211x1,tx2,t\u2211x1,tx2,t\u2211(x2,t)2]\u22121{\\begin{align}\nvar{\\begin{bmatrix} \\hat{\\beta_1}-\\beta_1 \\\\ \\hat{\\beta_2}-\\beta_2 \\end{bmatrix}}\n&=\n{\\begin{bmatrix} \\sum{(x_{1,t})^2} & \\sum{{x_{1,t}}{x_{2,t}}} \\\\ \\sum{{x_{1,t}}{x_{2,t}}} & \\sum{(x_{2,t})^2} \\end{bmatrix}}^{-1}\nvar{\\begin{bmatrix} \\sum{{x_{1,t}}{\\varepsilon_t}} \\\\ \\sum{{x_{2,t}}{\\varepsilon_t}} \\end{bmatrix}} \\\\\n&=\n{\\sigma}^2\n{\\begin{bmatrix} \\sum{(x_{1,t})^2} & \\sum{{x_{1,t}}{x_{2,t}}} \\\\ \\sum{{x_{1,t}}{x_{2,t}}} & \\sum{(x_{2,t})^2} \\end{bmatrix}}^{-1}\n\\end{align}\n}\n\n\u5206\u6563\u65e2\u77e5\u306e\u5834\u5408\u306a\u3089\u3001z\u691c\u5b9a\n{\\sigma}^{-1}\n{\\begin{bmatrix} \\sum{(x_{1,t})^2} & \\sum{{x_{1,t}}{x_{2,t}}} \\\\ \\sum{{x_{1,t}}{x_{2,t}}} & \\sum{(x_{2,t})^2} \\end{bmatrix}}^{\\frac{1}{2}}\n\\Bigl(\n{\\begin{bmatrix} \\hat{\\beta_1}-\\beta_1 \\\\ \\hat{\\beta_2}-\\beta_2 \\end{bmatrix}}\n\\Bigl)\n\\sim\n{N\\Bigl(0 , I \\Bigl)}\n\u03c3\u22121[\u2211(x1,t)2\u2211x1,tx2,t\u2211x1,tx2,t\u2211(x2,t)2]12([^\u03b21\u2212\u03b21^\u03b22\u2212\u03b22])\u223cN(0,I){{\\sigma}^{-1}\n{\\begin{bmatrix} \\sum{(x_{1,t})^2} & \\sum{{x_{1,t}}{x_{2,t}}} \\\\ \\sum{{x_{1,t}}{x_{2,t}}} & \\sum{(x_{2,t})^2} \\end{bmatrix}}^{\\frac{1}{2}}\n\\Bigl(\n{\\begin{bmatrix} \\hat{\\beta_1}-\\beta_1 \\\\ \\hat{\\beta_2}-\\beta_2 \\end{bmatrix}}\n\\Bigl)\n\\sim\n{N\\Bigl(0 , I \\Bigl)}\n}\n\n\u5206\u6563\u672a\u77e5\u306e\u5834\u5408\u306a\u3089\u3001t\u691c\u5b9a\n{\\hat{\\sigma}}^{-1}\n{\\begin{bmatrix} \\sum{(x_{1,t})^2} & \\sum{{x_{1,t}}{x_{2,t}}} \\\\ \\sum{{x_{1,t}}{x_{2,t}}} & \\sum{(x_{2,t})^2} \\end{bmatrix}}^{\\frac{1}{2}}\n\\Bigl(\n{\\begin{bmatrix} \\hat{\\beta_1}-\\beta_1 \\\\ \\hat{\\beta_2}-\\beta_2 \\end{bmatrix}}\n\\Bigl)\n\\sim\n{t_{n-2}}\n\u02c6\u03c3\u22121[\u2211(x1,t)2\u2211x1,tx2,t\u2211x1,tx2,t\u2211(x2,t)2]12([^\u03b21\u2212\u03b21^\u03b22\u2212\u03b22])\u223ctn\u22122{{\\hat{\\sigma}}^{-1}\n{\\begin{bmatrix} \\sum{(x_{1,t})^2} & \\sum{{x_{1,t}}{x_{2,t}}} \\\\ \\sum{{x_{1,t}}{x_{2,t}}} & \\sum{(x_{2,t})^2} \\end{bmatrix}}^{\\frac{1}{2}}\n\\Bigl(\n{\\begin{bmatrix} \\hat{\\beta_1}-\\beta_1 \\\\ \\hat{\\beta_2}-\\beta_2 \\end{bmatrix}}\n\\Bigl)\n\\sim\n{t_{n-2}}\n}\n\n\u30b7\u30df\u30e5\u30ec\u30fc\u30b7\u30e7\u30f3\n\u30e2\u30f3\u30c6\u30ab\u30eb\u30ed\u5b9f\u9a13\n\u5b9f\u884c\u56de\u6570\uff1a10000\u56de\n\n\u30b5\u30f3\u30d7\u30eb\u30b5\u30a4\u30ba\u3000n=30\n\n\n\nt\n^\u03b21\\hat{\\beta_1}\n^\u03b22\\hat{\\beta_2}\n\n\n\n\n\u5e73\u5747\n-0.0090\n-0.0004\n\n\n\n\n\n\nt\u5171\u5206\u6563\n^\u03b21\\hat{\\beta_1}\n^\u03b22\\hat{\\beta_2}\n\n\n\n\n^\u03b21\\hat{\\beta_1}\n1.2086\n-0.0293\n\n\n^\u03b22\\hat{\\beta_2}\n-0.0293\n1.0825\n\n\n\n\n\n\nz\n^\u03b21\\hat{\\beta_1}\n^\u03b22\\hat{\\beta_2}\n\n\n\n\n\u5e73\u5747\n-0.0077\n0.0019\n\n\n\n\n\n\nz\u5171\u5206\u6563\n^\u03b21\\hat{\\beta_1}\n^\u03b22\\hat{\\beta_2}\n\n\n\n\n^\u03b21\\hat{\\beta_1}\n1.0773\n-0.0284\n\n\n^\u03b22\\hat{\\beta_2}\n-0.0284\n0.9622\n\n\n\n\n\n\n\u6709\u610f\u6c34\u6e96\nt\u5024\n^\u03b21\\hat{\\beta_1}\u68c4\u5374\u7387\n^\u03b22\\hat{\\beta_2}\u68c4\u5374\u7387\nz\u5024\n^\u03b21\\hat{\\beta_1}\u68c4\u5374\u7387\n^\u03b22\\hat{\\beta_2}\u68c4\u5374\u7387\n\n\n\n\n0.90\n0.1268\n0.9025\n0.8985\n0.1257\n0.9005\n0.8965\n\n\n0.80\n0.2558\n0.8070\n0.7991\n0.2533\n0.8018\n0.7980\n\n\n0.70\n0.3893\n0.7077\n0.6972\n0.3853\n0.7029\n0.6922\n\n\n0.60\n0.5304\n0.6136\n0.5990\n0.5244\n0.6066\n0.5932\n\n\n0.50\n0.6834\n0.5193\n0.5015\n0.6745\n0.5128\n0.4934\n\n\n0.40\n0.8546\n0.4210\n0.4020\n0.8416\n0.4154\n0.3932\n\n\n0.30\n1.0560\n0.3265\n0.3035\n1.0364\n0.3159\n0.2942\n\n\n0.20\n1.3125\n0.2299\n0.2070\n1.2816\n0.2197\n0.1971\n\n\n0.10\n1.7011\n0.1241\n0.1033\n1.6449\n0.1148\n0.0948\n\n\n0.05\n2.0484\n0.0657\n0.0504\n1.9600\n0.0600\n0.0450\n\n\n0.02\n2.4671\n0.0260\n0.0192\n2.3263\n0.0252\n0.0156\n\n\n0.01\n2.7632\n0.0127\n0.0078\n2.5758\n0.0125\n0.0081\n\n\n\n\n\u30b5\u30f3\u30d7\u30eb\u30b5\u30a4\u30ba\u3000n=300\n\n\n\nt\n^\u03b21\\hat{\\beta_1}\n^\u03b22\\hat{\\beta_2}\n\n\n\n\n\u5e73\u5747\n-0.0023\n-0.0075\n\n\n\n\n\n\nt\u5171\u5206\u6563\n^\u03b21\\hat{\\beta_1}\n^\u03b22\\hat{\\beta_2}\n\n\n\n\n^\u03b21\\hat{\\beta_1}\n1.0196\n-0.0184\n\n\n^\u03b22\\hat{\\beta_2}\n-0.0184\n1.0059\n\n\n\n\n\n\nz\n^\u03b21\\hat{\\beta_1}\n^\u03b22\\hat{\\beta_2}\n\n\n\n\n\u5e73\u5747\n-0.0027\n-0.0077\n\n\n\n\n\n\nz\u5171\u5206\u6563\n^\u03b21\\hat{\\beta_1}\n^\u03b22\\hat{\\beta_2}\n\n\n\n\n^\u03b21\\hat{\\beta_1}\n1.0070\n-0.0176\n\n\n^\u03b22\\hat{\\beta_2}\n-0.0176\n0.9937\n\n\n\n\n\n\n\u6709\u610f\u6c34\u6e96\nt\u5024\n^\u03b21\\hat{\\beta_1}\u68c4\u5374\u7387\n^\u03b22\\hat{\\beta_2}\u68c4\u5374\u7387\nz\u5024\n^\u03b21\\hat{\\beta_1}\u68c4\u5374\u7387\n^\u03b22\\hat{\\beta_2}\u68c4\u5374\u7387\n\n\n\n\n0.90\n0.1258\n0.9007\n0.9014\n0.1257\n0.9004\n0.9004\n\n\n0.80\n0.2536\n0.8039\n0.8013\n0.2533\n0.8045\n0.8009\n\n\n0.70\n0.3857\n0.7016\n0.6957\n0.3853\n0.7009\n0.6943\n\n\n0.60\n0.5250\n0.5962\n0.5950\n0.5244\n0.5963\n0.5957\n\n\n0.50\n0.6753\n0.4999\n0.4970\n0.6745\n0.4997\n0.4961\n\n\n0.40\n0.8428\n0.4019\n0.3947\n0.8416\n0.4005\n0.3942\n\n\n0.30\n1.0382\n0.3006\n0.2960\n1.0364\n0.3000\n0.2967\n\n\n0.20\n1.2844\n0.2020\n0.2026\n1.2816\n0.2005\n0.2008\n\n\n0.10\n1.6500\n0.1011\n0.1025\n1.6449\n0.0991\n0.1011\n\n\n0.05\n1.9680\n0.0532\n0.0484\n1.9600\n0.0514\n0.0488\n\n\n0.02\n2.3389\n0.0206\n0.0198\n2.3263\n0.0207\n0.0192\n\n\n0.01\n2.5924\n0.0107\n0.0103\n2.5758\n0.0104\n0.0102\n\n\n\n\n\u7d50\u8ad6\n\u25cb\u30002\u5909\u6570\u306et\u691c\u5b9a\u3092\u540c\u6642\u306b\u3057\u3066\u3082\u3001\u30b7\u30df\u30e5\u30ec\u30fc\u30b7\u30e7\u30f3\u4e0a\u306e\u7d50\u679c\u30671\u5909\u6570\u306et\u691c\u5b9a\u3068\u6027\u8cea\u304c\u5909\u308f\u3089\u306a\u3044\u3002\n\u25cb\u3000\u5358\u4f4d\u6839\u3092\u6301\u3064\u904e\u7a0b\u306f\u5225\u306e\u691c\u5b9a\u6cd5\u306b\u3054\u53c2\u8003\u304f\u3060\u3055\u3044\u3002\n\n\u30b3\u30fc\u30c9\nt <- 300 # \u30c7\u30fc\u30bf\u306e\u6570\nn <- 10000 # \u5b9f\u884c\u56de\u6570\nb1 <- 0.4\nb2 <- 0.2\nb <- as.matrix(c(0.4,0.2))\nX1 <- matrix(rexp(t*n,0.01),t,n)\nX2 <- matrix(runif(t*n,0,100),t,n)\nerror <- matrix(rnorm(t*n,0,1),t,n)\nY <- b1*X1+b2*X2+error\nBvalue <- matrix(0,n,4)\nfor (i in 1:n) {\n  y <- Y[,i]-mean(Y[,i])\n  x <- cbind( X1[,i]-mean(X1[,i]), X2[,i]-mean(X2[,i]) )\n  bhat <- solve(t(x) %*% x) %*% t(x) %*% y\n  shat <- (t(y-x%*%bhat)%*%(y-x%*%bhat)/(t-2))^0.5\n  xsq <- t(x)%*%x\n  xroot <- eigen(xsq)$vectors %*% (diag(eigen(xsq)$values))^0.5\n  Bvalue[i,1:2] <- shat^(-1)*c( xroot %*% (bhat-b) )\n  Bvalue[i,3:4] <- c( xroot %*% (bhat-b) )\n}\nAverage <- apply(Bvalue,2,mean)\ntCovar <- cbind( c( var(Bvalue[,1]),cov(Bvalue[,1],Bvalue[,2]) ),\n                 c( cov(Bvalue[,1],Bvalue[,2]),var(Bvalue[,2])) )\nzCovar <- cbind( c( var(Bvalue[,3]),cov(Bvalue[,3],Bvalue[,4]) ),\n                 c( cov(Bvalue[,3],Bvalue[,4]),var(Bvalue[,4])) )\nAlpha <- matrix(0,12,7)\ncolnames(Alpha) <- c(\"\u6709\u610f\u6c34\u6e96\",\"t\",\"b1\u306et\u68c4\u5374\u7387\",\"b2\u306et\u68c4\u5374\u7387\",\n                  \"z\",\"b1\u306ez\u68c4\u5374\u7387\",\"b2\u306ez\u68c4\u5374\u7387\")\nAlpha[,1] <- c(0.9,0.8,0.7,0.6,0.5,0.4,0.3,\n               0.2,0.1,0.05,0.02,0.01)\nAlpha[,2] <- qt(1-Alpha[,1]/2,t-2)\nAlpha[,5] <- qnorm(1-Alpha[,1]/2)\nfor(j in 1:12){\n  Alpha[j,3] <- length(which(abs(Bvalue[,1])>Alpha[j,2]))/n\n  Alpha[j,4] <- length(which(abs(Bvalue[,2])>Alpha[j,2]))/n\n  Alpha[j,6] <- length(which(abs(Bvalue[,3])>Alpha[j,5]))/n\n  Alpha[j,7] <- length(which(abs(Bvalue[,4])>Alpha[j,5]))/n\n}\nAlpha\n\n\u30001\u5909\u6570\u306et\u691c\u5b9a\u306f\u3088\u304f\u77e5\u3089\u308c\u3066\u3044\u308b\u304c\u30012\u5909\u6570\u4ee5\u4e0a\u306e\u5834\u5408\u306f\u3069\u3046\u3059\u308c\u3070\u3088\u3044\u306e\u3060\u308d\u3046\u30022\u5909\u6570\u306e\u5834\u5408\u306fF\u691c\u5b9a\u3092\u3059\u308b\u3053\u3068\u3082\u53ef\u80fd\u3067\u3042\u308b\u30023\u5909\u6570\u4ee5\u4e0a\u5834\u5408\u306f\u3001\u305d\u308c\u305e\u308c\u306et\u691c\u5b9a\u3059\u308b\u3053\u3068\u306f\u3088\u304f\u3055\u308c\u3066\u3044\u308b\u3068\u601d\u3046\u304c\u3001\u500b\u4eba\u7684\u306a\u8003\u3048\u3067\u3001\u540c\u6642\u306b\u691c\u5b9a\u3057\u306a\u3051\u308c\u3070\u306a\u3089\u306a\u3044\u3002\n\n#\u7dda\u5f62\u30e2\u30c7\u30eb\n$$y_t\\={\\beta_1}{x_{1,t}}+{\\beta_2}{x_{2,t}}+\\varepsilon_t,\\varepsilon_t\\sim{N(0,\\sigma^2)}$$\n\n####\u56de\u5e30\u4fc2\u6570\u306e\u63a8\u5b9a\u91cf\n```math\n{\\begin{bmatrix} \\hat{\\beta_1} \\\\ \\hat{\\beta_2} \\end{bmatrix}}\n=\n{\\begin{bmatrix} \\sum{(x_{1,t})^2} & \\sum{{x_{1,t}}{x_{2,t}}} \\\\ \\sum{{x_{1,t}}{x_{2,t}}} & \\sum{(x_{2,t})^2} \\end{bmatrix}}^{-1}\n{\\begin{bmatrix} \\sum{{x_{1,t}}{y_t}} \\\\ \\sum{{x_{2,t}}{y_t}} \\end{bmatrix}}\n```\n####\u63a8\u5b9a\u91cf\u3068\u771f\u306e\u5024\u306e\u5dee\n\n```math\n{\\begin{bmatrix} \\hat{\\beta_1} \\\\ \\hat{\\beta_2} \\end{bmatrix}}\n-{\\begin{bmatrix} \\beta_1 \\\\ \\beta_2 \\end{bmatrix}}\n=\n{\\begin{bmatrix} \\sum{(x_{1,t})^2} & \\sum{{x_{1,t}}{x_{2,t}}} \\\\ \\sum{{x_{1,t}}{x_{2,t}}} & \\sum{(x_{2,t})^2} \\end{bmatrix}}^{-1}\n{\\begin{bmatrix} \\sum{{x_{1,t}}{\\varepsilon_t}} \\\\ \\sum{{x_{2,t}}{\\varepsilon_t}} \\end{bmatrix}}\n```\n\n####\u671f\u5f85\u5024\u3068\u5206\u6563\n```math\n\\begin{align}\nE{\\begin{bmatrix} \\hat{\\beta_1}-\\beta_1 \\\\ \\hat{\\beta_2}-\\beta_2 \\end{bmatrix}}\n&=\n{\\begin{bmatrix} \\sum{(x_{1,t})^2} & \\sum{{x_{1,t}}{x_{2,t}}} \\\\ \\sum{{x_{1,t}}{x_{2,t}}} & \\sum{(x_{2,t})^2} \\end{bmatrix}}^{-1}\nE{\\begin{bmatrix} \\sum{{x_{1,t}}{\\varepsilon_t}} \\\\ \\sum{{x_{2,t}}{\\varepsilon_t}} \\end{bmatrix}} \\\\\n&=\n{\\begin{bmatrix} 0 \\\\ 0 \\end{bmatrix}}\n\\end{align}\n```\n```math\n\\begin{align}\nvar{\\begin{bmatrix} \\hat{\\beta_1}-\\beta_1 \\\\ \\hat{\\beta_2}-\\beta_2 \\end{bmatrix}}\n&=\n{\\begin{bmatrix} \\sum{(x_{1,t})^2} & \\sum{{x_{1,t}}{x_{2,t}}} \\\\ \\sum{{x_{1,t}}{x_{2,t}}} & \\sum{(x_{2,t})^2} \\end{bmatrix}}^{-1}\nvar{\\begin{bmatrix} \\sum{{x_{1,t}}{\\varepsilon_t}} \\\\ \\sum{{x_{2,t}}{\\varepsilon_t}} \\end{bmatrix}} \\\\\n&=\n{\\sigma}^2\n{\\begin{bmatrix} \\sum{(x_{1,t})^2} & \\sum{{x_{1,t}}{x_{2,t}}} \\\\ \\sum{{x_{1,t}}{x_{2,t}}} & \\sum{(x_{2,t})^2} \\end{bmatrix}}^{-1}\n\\end{align}\n```\n####\u5206\u6563\u65e2\u77e5\u306e\u5834\u5408\u306a\u3089\u3001z\u691c\u5b9a\n```math\n{\\sigma}^{-1}\n{\\begin{bmatrix} \\sum{(x_{1,t})^2} & \\sum{{x_{1,t}}{x_{2,t}}} \\\\ \\sum{{x_{1,t}}{x_{2,t}}} & \\sum{(x_{2,t})^2} \\end{bmatrix}}^{\\frac{1}{2}}\n\\Bigl(\n{\\begin{bmatrix} \\hat{\\beta_1}-\\beta_1 \\\\ \\hat{\\beta_2}-\\beta_2 \\end{bmatrix}}\n\\Bigl)\n\\sim\n{N\\Bigl(0 , I \\Bigl)}\n```\n\n####\u5206\u6563\u672a\u77e5\u306e\u5834\u5408\u306a\u3089\u3001t\u691c\u5b9a\n```math\n{\\hat{\\sigma}}^{-1}\n{\\begin{bmatrix} \\sum{(x_{1,t})^2} & \\sum{{x_{1,t}}{x_{2,t}}} \\\\ \\sum{{x_{1,t}}{x_{2,t}}} & \\sum{(x_{2,t})^2} \\end{bmatrix}}^{\\frac{1}{2}}\n\\Bigl(\n{\\begin{bmatrix} \\hat{\\beta_1}-\\beta_1 \\\\ \\hat{\\beta_2}-\\beta_2 \\end{bmatrix}}\n\\Bigl)\n\\sim\n{t_{n-2}}\n```\n\n#\u30b7\u30df\u30e5\u30ec\u30fc\u30b7\u30e7\u30f3\n\u30e2\u30f3\u30c6\u30ab\u30eb\u30ed\u5b9f\u9a13\n\u5b9f\u884c\u56de\u6570\uff1a10000\u56de\n### \u30b5\u30f3\u30d7\u30eb\u30b5\u30a4\u30ba\u3000n=30\n|t|$\\hat{\\beta_1}$|$\\hat{\\beta_2}$|\n|:--:|:--:|:--:|\n|\u5e73\u5747|-0.0090|-0.0004|\n\n|t\u5171\u5206\u6563|$\\hat{\\beta_1}$|$\\hat{\\beta_2}$|\n|:--:|:--:|:--:|\n|$\\hat{\\beta_1}$|1.2086|-0.0293|\n|$\\hat{\\beta_2}$|-0.0293|1.0825|\n\n|z|$\\hat{\\beta_1}$|$\\hat{\\beta_2}$|\n|:--:|:--:|:--:|\n|\u5e73\u5747|-0.0077|0.0019|\n\n|z\u5171\u5206\u6563|$\\hat{\\beta_1}$|$\\hat{\\beta_2}$|\n|:--:|:--:|:--:|\n|$\\hat{\\beta_1}$|1.0773|-0.0284|\n|$\\hat{\\beta_2}$|-0.0284|0.9622|\n\n|\u6709\u610f\u6c34\u6e96|t\u5024|$\\hat{\\beta_1}$\u68c4\u5374\u7387|$\\hat{\\beta_2}$\u68c4\u5374\u7387|z\u5024|$\\hat{\\beta_1}$\u68c4\u5374\u7387|$\\hat{\\beta_2}$\u68c4\u5374\u7387|\n|:--:|:--:|:--:|:--:|:--:|:--:|:--:|\n|0.90|0.1268|0.9025|0.8985|0.1257|0.9005|0.8965|\n|0.80|0.2558|0.8070|0.7991|0.2533|0.8018|0.7980|\n|0.70|0.3893|0.7077|0.6972|0.3853|0.7029|0.6922|\n|0.60|0.5304|0.6136|0.5990|0.5244|0.6066|0.5932|\n|0.50|0.6834|0.5193|0.5015|0.6745|0.5128|0.4934|\n|0.40|0.8546|0.4210|0.4020|0.8416|0.4154|0.3932|\n|0.30|1.0560|0.3265|0.3035|1.0364|0.3159|0.2942|\n|0.20|1.3125|0.2299|0.2070|1.2816|0.2197|0.1971|\n|0.10|1.7011|0.1241|0.1033|1.6449|0.1148|0.0948|\n|0.05|2.0484|0.0657|0.0504|1.9600|0.0600|0.0450|\n|0.02|2.4671|0.0260|0.0192|2.3263|0.0252|0.0156|\n|0.01|2.7632|0.0127|0.0078|2.5758|0.0125|0.0081|\n\n### \u30b5\u30f3\u30d7\u30eb\u30b5\u30a4\u30ba\u3000n=300\n|t|$\\hat{\\beta_1}$|$\\hat{\\beta_2}$|\n|:--:|:--:|:--:|\n|\u5e73\u5747|-0.0023|-0.0075|\n\n|t\u5171\u5206\u6563|$\\hat{\\beta_1}$|$\\hat{\\beta_2}$|\n|:--:|:--:|:--:|\n|$\\hat{\\beta_1}$|1.0196|-0.0184|\n|$\\hat{\\beta_2}$|-0.0184|1.0059|\n\n|z|$\\hat{\\beta_1}$|$\\hat{\\beta_2}$|\n|:--:|:--:|:--:|\n|\u5e73\u5747|-0.0027|-0.0077|\n\n|z\u5171\u5206\u6563|$\\hat{\\beta_1}$|$\\hat{\\beta_2}$|\n|:--:|:--:|:--:|\n|$\\hat{\\beta_1}$|1.0070|-0.0176|\n|$\\hat{\\beta_2}$|-0.0176|0.9937|\n\n|\u6709\u610f\u6c34\u6e96|t\u5024|$\\hat{\\beta_1}$\u68c4\u5374\u7387|$\\hat{\\beta_2}$\u68c4\u5374\u7387|z\u5024|$\\hat{\\beta_1}$\u68c4\u5374\u7387|$\\hat{\\beta_2}$\u68c4\u5374\u7387|\n|:--:|:--:|:--:|:--:|:--:|:--:|:--:|\n|0.90|0.1258|0.9007|0.9014|0.1257|0.9004|0.9004|\n|0.80|0.2536|0.8039|0.8013|0.2533|0.8045|0.8009|\n|0.70|0.3857|0.7016|0.6957|0.3853|0.7009|0.6943|\n|0.60|0.5250|0.5962|0.5950|0.5244|0.5963|0.5957|\n|0.50|0.6753|0.4999|0.4970|0.6745|0.4997|0.4961|\n|0.40|0.8428|0.4019|0.3947|0.8416|0.4005|0.3942|\n|0.30|1.0382|0.3006|0.2960|1.0364|0.3000|0.2967|\n|0.20|1.2844|0.2020|0.2026|1.2816|0.2005|0.2008|\n|0.10|1.6500|0.1011|0.1025|1.6449|0.0991|0.1011|\n|0.05|1.9680|0.0532|0.0484|1.9600|0.0514|0.0488|\n|0.02|2.3389|0.0206|0.0198|2.3263|0.0207|0.0192|\n|0.01|2.5924|0.0107|0.0103|2.5758|0.0104|0.0102|\n\n#\u7d50\u8ad6\n\u25cb\u30002\u5909\u6570\u306et\u691c\u5b9a\u3092\u540c\u6642\u306b\u3057\u3066\u3082\u3001\u30b7\u30df\u30e5\u30ec\u30fc\u30b7\u30e7\u30f3\u4e0a\u306e\u7d50\u679c\u30671\u5909\u6570\u306et\u691c\u5b9a\u3068\u6027\u8cea\u304c\u5909\u308f\u3089\u306a\u3044\u3002\n\u25cb\u3000\u5358\u4f4d\u6839\u3092\u6301\u3064\u904e\u7a0b\u306f\u5225\u306e\u691c\u5b9a\u6cd5\u306b\u3054\u53c2\u8003\u304f\u3060\u3055\u3044\u3002\n\n##\u30b3\u30fc\u30c9\n```r\nt <- 300 # \u30c7\u30fc\u30bf\u306e\u6570\nn <- 10000 # \u5b9f\u884c\u56de\u6570\nb1 <- 0.4\nb2 <- 0.2\nb <- as.matrix(c(0.4,0.2))\nX1 <- matrix(rexp(t*n,0.01),t,n)\nX2 <- matrix(runif(t*n,0,100),t,n)\nerror <- matrix(rnorm(t*n,0,1),t,n)\nY <- b1*X1+b2*X2+error\nBvalue <- matrix(0,n,4)\nfor (i in 1:n) {\n  y <- Y[,i]-mean(Y[,i])\n  x <- cbind( X1[,i]-mean(X1[,i]), X2[,i]-mean(X2[,i]) )\n  bhat <- solve(t(x) %*% x) %*% t(x) %*% y\n  shat <- (t(y-x%*%bhat)%*%(y-x%*%bhat)/(t-2))^0.5\n  xsq <- t(x)%*%x\n  xroot <- eigen(xsq)$vectors %*% (diag(eigen(xsq)$values))^0.5\n  Bvalue[i,1:2] <- shat^(-1)*c( xroot %*% (bhat-b) )\n  Bvalue[i,3:4] <- c( xroot %*% (bhat-b) )\n}\nAverage <- apply(Bvalue,2,mean)\ntCovar <- cbind( c( var(Bvalue[,1]),cov(Bvalue[,1],Bvalue[,2]) ),\n                 c( cov(Bvalue[,1],Bvalue[,2]),var(Bvalue[,2])) )\nzCovar <- cbind( c( var(Bvalue[,3]),cov(Bvalue[,3],Bvalue[,4]) ),\n                 c( cov(Bvalue[,3],Bvalue[,4]),var(Bvalue[,4])) )\nAlpha <- matrix(0,12,7)\ncolnames(Alpha) <- c(\"\u6709\u610f\u6c34\u6e96\",\"t\",\"b1\u306et\u68c4\u5374\u7387\",\"b2\u306et\u68c4\u5374\u7387\",\n                  \"z\",\"b1\u306ez\u68c4\u5374\u7387\",\"b2\u306ez\u68c4\u5374\u7387\")\nAlpha[,1] <- c(0.9,0.8,0.7,0.6,0.5,0.4,0.3,\n               0.2,0.1,0.05,0.02,0.01)\nAlpha[,2] <- qt(1-Alpha[,1]/2,t-2)\nAlpha[,5] <- qnorm(1-Alpha[,1]/2)\nfor(j in 1:12){\n  Alpha[j,3] <- length(which(abs(Bvalue[,1])>Alpha[j,2]))/n\n  Alpha[j,4] <- length(which(abs(Bvalue[,2])>Alpha[j,2]))/n\n  Alpha[j,6] <- length(which(abs(Bvalue[,3])>Alpha[j,5]))/n\n  Alpha[j,7] <- length(which(abs(Bvalue[,4])>Alpha[j,5]))/n\n}\nAlpha\n```\n"}