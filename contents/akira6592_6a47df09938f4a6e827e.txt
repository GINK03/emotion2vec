{"context": "\n\n1. \u4e8b\u524d\u8abf\u67fb\nCisco IOS\u6a5f\u5668\u306e\u8a2d\u5b9a\u3092\u7ba1\u7406\u3059\u308b ios_config \u30e2\u30b8\u30e5\u30fc\u30eb\u306b\u306f parent \n\u3068\u3044\u3046\u30aa\u30d7\u30b7\u30e7\u30f3\u304c\u3042\u308a\u307e\u3059\u3002\u516c\u5f0f\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u3067\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u8aac\u660e\u3055\u308c\u3066\u3044\u307e\u3059\u3002\n\nThe ordered set of parents that uniquely identify the section the commands should be checked against. If the parents argument is omitted, the commands are checked against the set of top level or global commands.\n\n\u968e\u5c64\u3092\u6307\u5b9a\u3059\u308b\u3088\u3046\u3067\u3059\u306d\u3002\u306a\u306e\u3067\u4f8b\u3048\u3070\ninterface GigabitEthernet1/0/1\n description hogehoge\n\n\u306e\u3088\u3046\u306a\u30b3\u30f3\u30d5\u30a3\u30b0\u3092\u6295\u5165\u3057\u305f\u3044\u5834\u5408\u306f\u3001\nparents\u30aa\u30d7\u30b7\u30e7\u30f3\u306binterface GigabitEthernet1/0/1\u3092\nlines\u30aa\u30d7\u30b7\u30e7\u30f3\u306bdescription hogehoge\u3092\u6307\u5b9a\u3057\u3066\u3042\u3052\u308c\u3070\u3088\u3055\u305d\u3046\u3067\u3059\u3002\n\u3068\u3053\u308d\u304c\u3010Ansible\u3011Ansible\u3067Cisco\u6a5f\u5668\u3092\u5236\u5fa1\u3057\u3066\u307f\u308b(\u30b5\u30f3\u30d7\u30eb\u30b3\u30fc\u30c92 port\u8a2d\u5b9a\u7de8)\n\u3067\u8a66\u3055\u308c\u3066\u3044\u308b\u65b9\u3082\u3044\u3089\u3063\u3057\u3083\u3044\u307e\u3059\u304c\u3001lines\u30aa\u30d7\u30b7\u30e7\u30f3\u306b\u4e21\u65b9\u3057\u3066\u3042\u3052\u3066\u3082\n\u6b63\u5e38\u306b\u51e6\u7406\u306f\u5b8c\u4e86\u3059\u308b\u3088\u3046\u3067\u3059\u3002\n\u26052016/07/07\u8ffd\u8a18\u2605\n\u9055\u3044\u306b\u3064\u3044\u3066\u5225\u9014\u300cAnsible\u306eios_config\u30e2\u30b8\u30e5\u30fc\u30eb\u3067interface\u30b3\u30de\u30f3\u30c9\u306fparents\u306b\u6307\u5b9a\u3059\u308b\u306e\u304c\u826f\u3055\u305d\u3046\uff08\u691c\u8a3c\u4ed8\u304d\uff09\u300d\u306b\u3066\u691c\u8a3c\u3057\u307e\u3057\u305f\u3002\n\n2. \u691c\u8a0e\n\u3067\u306f\u4f55\u306e\u305f\u3081\u306b parents \u30aa\u30d7\u30b7\u30e7\u30f3\u304c\u3042\u308b\u306e\u3067\u3057\u3087\u3046\u304b\u3002\n\u30e2\u30b8\u30e5\u30fc\u30eb\u306e\u30b3\u30fc\u30c9\u306e\u307b\u3046\u306f\u8ffd\u3048\u3066\u3044\u306a\u3044\u306e\u3067\u6b63\u76f4\u307e\u3060\u5206\u304b\u3063\u3066\u3044\u307e\u305b\u3093\u3002\n\u305f\u3060\u3001parents\u3001lines\u306e2\u3064\u306e\u30aa\u30d7\u30b7\u30e7\u30f3\u306b\u6295\u5165\u3059\u308b\u30b3\u30de\u30f3\u30c9\u304c\u5206\u304b\u308c\u3066\u3044\u308b\u306e\u3067\u3042\u308c\u3070\u3001\nwith_items\u306a\u3069\u306ewith_*\u3067parents\u306e\u30eb\u30fc\u30d7\u3092\u56de\u3057\u3066\u3044\u308b\u306a\u304b\u3067\u3001\n\u90fd\u5ea6lines\u3067\u6307\u5b9a\u3057\u305f\u30b3\u30f3\u30d5\u30a3\u30b0\u3092\u6d41\u3059\u3001\u3068\u3044\u3046\u3053\u3068\u304c\u3067\u304d\u305d\u3046\u3067\u3059\u3002\n\n3. \u8907\u6570\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9\u306edescription\u5909\u66f4\u3092parents\u3092\u4f7f\u3063\u3066\u5909\u66f4\u3059\u308b\n\u666e\u901a\u306b interface range \u30b3\u30de\u30f3\u30c9\u3092\u4f7f\u304a\u3046\u3088\u3068\u3044\u3046\u8a71\u3067\u3059\u304c\u3001\n\u3053\u3053\u306fansible\u306e\u6319\u52d5\u3092\u78ba\u8a8d\u306b\u3059\u308b\u305f\u3081\u3001\u3068\u5272\u308a\u5207\u308a\u307e\u3059\u3002\n\n3.1. Playbook\u306e\u4f5c\u6210\n\u4ee5\u4e0b\u306ePlaybook\u3067\u8a66\u3057\u3066\u307f\u307e\u3059\u3002\n- hosts: cisco   # \u30a4\u30d9\u30f3\u30c8\u30d5\u30a1\u30a4\u30eb\u3067 192.168.1.1\u3092\u5b9a\u7fa9\u6e08\u307f\n  gather_facts: no\n  connection: local\n\n  tasks:\n    - name: set description\n      ios_config:\n        parents:\n         - \"interface GigabitEthernet1/0/{{ item }}\"  # item\u306bwith_sequence\u306e\u6570\u5b57\u304c\u5165\u308b\n        lines:\n         - \"description No.{{ item }}\" \n        provider: \"{{ cli }}\"\n      register: result\n      with_sequence: start=1 end=3   # \u30b7\u30fc\u30b1\u30f3\u30b9\u3092\u5b9a\u7fa9 1,2,3\n  vars:\n    cli:   # \u63a5\u7d9a\u60c5\u5831\u3092\u8f9e\u66f8\u3067\u5b9a\u7fa9\uff08username\u3068\u305d\u308c\u4ee5\u964d\u306f\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea\u30d5\u30a1\u30a4\u30eb\u304b\u3089\u53d6\u5f97\u5b9a\u7fa9\uff09\n      host:     \"{{ inventory_hostname }}\"    # \u30db\u30b9\u30c8\u5bfe\u8c61\u30db\u30b9\u30c8\n      username: \"{{ ansible_user }}\"          # \u30ed\u30b0\u30a4\u30f3\u30e6\u30fc\u30b6\u30fc\n      password: \"{{ ansible_password }}\"      # \u30ed\u30b0\u30a4\u30f3\u30d1\u30b9\u30ef\u30fc\u30c9\n      authorize: true                         # \u7279\u6a29\u30e2\u30fc\u30c9\u306b\u79fb\u884c\n      auth_pass: \"{{ cisco_enable_secret }}\"  # \u7279\u6a29\u30d1\u30b9\u30ef\u30fc\u30c9\n\n\u624b\u52d5\u3060\u3068\u4ee5\u4e0b\u306e\u30b3\u30de\u30f3\u30c9\u3092\u6295\u5165\u3059\u308b\u306e\u3092\u30a4\u30e1\u30fc\u30b8\u3057\u3066\u3044\u307e\u3059\u3002\ninterface GigabitEthernet1/0/1\n description no.1\n\ninterface GigabitEthernet1/0/2\n description no.2\n\ninterface GigabitEthernet1/0/3\n description no.3\n\n\n\n3.2. Playbook\u306e\u5b9f\u884c\n\u5b9f\u884c\u3057\u307e\u3059\u3002\nuser@ubuntu-vm:/etc/ansible$ ansible-playbook cat_int.yml\n\nPLAY [cisco] *******************************************************************\n\nTASK [set syslog] **************************************************************\nchanged: [192.168.1.1] => (item=1)\nchanged: [192.168.1.1] => (item=2)\nchanged: [192.168.1.1] => (item=3)\n\nPLAY RECAP *********************************************************************\n192.168.1.1                : ok=1    changed=1    unreachable=0    failed=0\n\n\n\n3.3 \u4e8b\u5f8c\u78ba\u8a8d\n\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9\u306edescription\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\nfoo#show interfaces status\n\nPort      Name               Status       Vlan       Duplex  Speed Type\nGi1/0/1   no.1               connected    1          a-full a-1000 10/100/1000BaseTX\nGi1/0/2   no.2               notconnect   1            auto   auto 10/100/1000BaseTX\nGi1/0/3   no.3               notconnect   1            auto   auto 10/100/1000BaseTX\nGi1/0/4                      notconnect   1            auto   auto 10/100/1000BaseTX\n\n\uff08\u7565\uff09\n\n\u7121\u4e8b\u5909\u66f4\u3055\u308c\u307e\u3057\u305f\u3002\n\n4. \u4ed6\u306b\u3082\u4f7f\u3044\u9053\u304c\u3042\u308b\u306f\u305a\uff1f\n\u4eca\u590f\u601d\u3044\u3064\u3044\u305f\u306e\u306f with_* \u306b\u3088\u308b\u7e70\u308a\u8fd4\u3057\u3060\u3051\u306a\u306e\u3067\u3059\u304c\u3001\n\u672c\u5f53\u306f\u307b\u304b\u306b\u3082\u4f7f\u3044\u9053\u304c\u3042\u308b\u6c17\u306f\u3057\u3066\u3044\u307e\u3059\u3002\n\u5206\u304b\u308a\u307e\u3057\u305f\u3089\u307e\u305f\u66f8\u304d\u305f\u3044\u3068\u601d\u3044\u307e\u3059\u3002\n# 1. \u4e8b\u524d\u8abf\u67fb\nCisco IOS\u6a5f\u5668\u306e\u8a2d\u5b9a\u3092\u7ba1\u7406\u3059\u308b ios_config \u30e2\u30b8\u30e5\u30fc\u30eb\u306b\u306f parent \n\u3068\u3044\u3046\u30aa\u30d7\u30b7\u30e7\u30f3\u304c\u3042\u308a\u307e\u3059\u3002[\u516c\u5f0f\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8](https://docs.ansible.com/ansible/ios_config_module.html#options)\u3067\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u8aac\u660e\u3055\u308c\u3066\u3044\u307e\u3059\u3002\n>\nThe ordered set of parents that uniquely identify the section the commands should be checked against. If the parents argument is omitted, the commands are checked against the set of top level or global commands.\n\n\u968e\u5c64\u3092\u6307\u5b9a\u3059\u308b\u3088\u3046\u3067\u3059\u306d\u3002\u306a\u306e\u3067\u4f8b\u3048\u3070\n\n```\ninterface GigabitEthernet1/0/1\n description hogehoge\n```\n\u306e\u3088\u3046\u306a\u30b3\u30f3\u30d5\u30a3\u30b0\u3092\u6295\u5165\u3057\u305f\u3044\u5834\u5408\u306f\u3001\nparents\u30aa\u30d7\u30b7\u30e7\u30f3\u306b`interface GigabitEthernet1/0/1`\u3092\nlines\u30aa\u30d7\u30b7\u30e7\u30f3\u306b`description hogehoge`\u3092\u6307\u5b9a\u3057\u3066\u3042\u3052\u308c\u3070\u3088\u3055\u305d\u3046\u3067\u3059\u3002\n\n\u3068\u3053\u308d\u304c[\u3010Ansible\u3011Ansible\u3067Cisco\u6a5f\u5668\u3092\u5236\u5fa1\u3057\u3066\u307f\u308b(\u30b5\u30f3\u30d7\u30eb\u30b3\u30fc\u30c92 port\u8a2d\u5b9a\u7de8)](http://qiita.com/onifinger/items/d40a68156c0a254a6e70)\n\u3067\u8a66\u3055\u308c\u3066\u3044\u308b\u65b9\u3082\u3044\u3089\u3063\u3057\u3083\u3044\u307e\u3059\u304c\u3001lines\u30aa\u30d7\u30b7\u30e7\u30f3\u306b\u4e21\u65b9\u3057\u3066\u3042\u3052\u3066\u3082\n\u6b63\u5e38\u306b\u51e6\u7406\u306f\u5b8c\u4e86\u3059\u308b\u3088\u3046\u3067\u3059\u3002\n\u26052016/07/07\u8ffd\u8a18\u2605\n\u9055\u3044\u306b\u3064\u3044\u3066\u5225\u9014\u300c[Ansible\u306eios_config\u30e2\u30b8\u30e5\u30fc\u30eb\u3067interface\u30b3\u30de\u30f3\u30c9\u306fparents\u306b\u6307\u5b9a\u3059\u308b\u306e\u304c\u826f\u3055\u305d\u3046\uff08\u691c\u8a3c\u4ed8\u304d\uff09](http://qiita.com/akira6592/items/5d993fcfae6e536bb65d)\u300d\u306b\u3066\u691c\u8a3c\u3057\u307e\u3057\u305f\u3002\n\n\n# 2. \u691c\u8a0e\n\n\u3067\u306f\u4f55\u306e\u305f\u3081\u306b parents \u30aa\u30d7\u30b7\u30e7\u30f3\u304c\u3042\u308b\u306e\u3067\u3057\u3087\u3046\u304b\u3002\n\u30e2\u30b8\u30e5\u30fc\u30eb\u306e\u30b3\u30fc\u30c9\u306e\u307b\u3046\u306f\u8ffd\u3048\u3066\u3044\u306a\u3044\u306e\u3067\u6b63\u76f4\u307e\u3060\u5206\u304b\u3063\u3066\u3044\u307e\u305b\u3093\u3002\n\n\u305f\u3060\u3001parents\u3001lines\u306e2\u3064\u306e\u30aa\u30d7\u30b7\u30e7\u30f3\u306b\u6295\u5165\u3059\u308b\u30b3\u30de\u30f3\u30c9\u304c\u5206\u304b\u308c\u3066\u3044\u308b\u306e\u3067\u3042\u308c\u3070\u3001\nwith_items\u306a\u3069\u306ewith_*\u3067parents\u306e\u30eb\u30fc\u30d7\u3092\u56de\u3057\u3066\u3044\u308b\u306a\u304b\u3067\u3001\n\u90fd\u5ea6lines\u3067\u6307\u5b9a\u3057\u305f\u30b3\u30f3\u30d5\u30a3\u30b0\u3092\u6d41\u3059\u3001\u3068\u3044\u3046\u3053\u3068\u304c\u3067\u304d\u305d\u3046\u3067\u3059\u3002\n\n# 3. \u8907\u6570\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9\u306edescription\u5909\u66f4\u3092parents\u3092\u4f7f\u3063\u3066\u5909\u66f4\u3059\u308b\n\n\u666e\u901a\u306b interface range \u30b3\u30de\u30f3\u30c9\u3092\u4f7f\u304a\u3046\u3088\u3068\u3044\u3046\u8a71\u3067\u3059\u304c\u3001\n\u3053\u3053\u306fansible\u306e\u6319\u52d5\u3092\u78ba\u8a8d\u306b\u3059\u308b\u305f\u3081\u3001\u3068\u5272\u308a\u5207\u308a\u307e\u3059\u3002\n\n## 3.1. Playbook\u306e\u4f5c\u6210\n\u4ee5\u4e0b\u306ePlaybook\u3067\u8a66\u3057\u3066\u307f\u307e\u3059\u3002\n\n```yaml\n- hosts: cisco   # \u30a4\u30d9\u30f3\u30c8\u30d5\u30a1\u30a4\u30eb\u3067 192.168.1.1\u3092\u5b9a\u7fa9\u6e08\u307f\n  gather_facts: no\n  connection: local\n\n  tasks:\n    - name: set description\n      ios_config:\n        parents:\n         - \"interface GigabitEthernet1/0/{{ item }}\"  # item\u306bwith_sequence\u306e\u6570\u5b57\u304c\u5165\u308b\n        lines:\n         - \"description No.{{ item }}\" \n        provider: \"{{ cli }}\"\n      register: result\n      with_sequence: start=1 end=3   # \u30b7\u30fc\u30b1\u30f3\u30b9\u3092\u5b9a\u7fa9 1,2,3\n  vars:\n    cli:   # \u63a5\u7d9a\u60c5\u5831\u3092\u8f9e\u66f8\u3067\u5b9a\u7fa9\uff08username\u3068\u305d\u308c\u4ee5\u964d\u306f\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea\u30d5\u30a1\u30a4\u30eb\u304b\u3089\u53d6\u5f97\u5b9a\u7fa9\uff09\n      host:     \"{{ inventory_hostname }}\"    # \u30db\u30b9\u30c8\u5bfe\u8c61\u30db\u30b9\u30c8\n      username: \"{{ ansible_user }}\"          # \u30ed\u30b0\u30a4\u30f3\u30e6\u30fc\u30b6\u30fc\n      password: \"{{ ansible_password }}\"      # \u30ed\u30b0\u30a4\u30f3\u30d1\u30b9\u30ef\u30fc\u30c9\n      authorize: true                         # \u7279\u6a29\u30e2\u30fc\u30c9\u306b\u79fb\u884c\n      auth_pass: \"{{ cisco_enable_secret }}\"  # \u7279\u6a29\u30d1\u30b9\u30ef\u30fc\u30c9\n```\n\n\u624b\u52d5\u3060\u3068\u4ee5\u4e0b\u306e\u30b3\u30de\u30f3\u30c9\u3092\u6295\u5165\u3059\u308b\u306e\u3092\u30a4\u30e1\u30fc\u30b8\u3057\u3066\u3044\u307e\u3059\u3002\n\n```\ninterface GigabitEthernet1/0/1\n description no.1\n\ninterface GigabitEthernet1/0/2\n description no.2\n\ninterface GigabitEthernet1/0/3\n description no.3\n\n```\n\n## 3.2. Playbook\u306e\u5b9f\u884c\n\u5b9f\u884c\u3057\u307e\u3059\u3002\n\n```\nuser@ubuntu-vm:/etc/ansible$ ansible-playbook cat_int.yml\n\nPLAY [cisco] *******************************************************************\n\nTASK [set syslog] **************************************************************\nchanged: [192.168.1.1] => (item=1)\nchanged: [192.168.1.1] => (item=2)\nchanged: [192.168.1.1] => (item=3)\n\nPLAY RECAP *********************************************************************\n192.168.1.1                : ok=1    changed=1    unreachable=0    failed=0\n\n```\n## 3.3 \u4e8b\u5f8c\u78ba\u8a8d \n\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9\u306edescription\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\n\n```\nfoo#show interfaces status\n\nPort      Name               Status       Vlan       Duplex  Speed Type\nGi1/0/1   no.1               connected    1          a-full a-1000 10/100/1000BaseTX\nGi1/0/2   no.2               notconnect   1            auto   auto 10/100/1000BaseTX\nGi1/0/3   no.3               notconnect   1            auto   auto 10/100/1000BaseTX\nGi1/0/4                      notconnect   1            auto   auto 10/100/1000BaseTX\n\n\uff08\u7565\uff09\n```\n\u7121\u4e8b\u5909\u66f4\u3055\u308c\u307e\u3057\u305f\u3002\n\n# 4. \u4ed6\u306b\u3082\u4f7f\u3044\u9053\u304c\u3042\u308b\u306f\u305a\uff1f\n\u4eca\u590f\u601d\u3044\u3064\u3044\u305f\u306e\u306f with_* \u306b\u3088\u308b\u7e70\u308a\u8fd4\u3057\u3060\u3051\u306a\u306e\u3067\u3059\u304c\u3001\n\u672c\u5f53\u306f\u307b\u304b\u306b\u3082\u4f7f\u3044\u9053\u304c\u3042\u308b\u6c17\u306f\u3057\u3066\u3044\u307e\u3059\u3002\n\u5206\u304b\u308a\u307e\u3057\u305f\u3089\u307e\u305f\u66f8\u304d\u305f\u3044\u3068\u601d\u3044\u307e\u3059\u3002\n", "tags": ["Ansible", "Cisco", "Network"]}