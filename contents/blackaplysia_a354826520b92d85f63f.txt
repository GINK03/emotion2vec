{"context": " More than 1 year has passed since last update.IBM Bluemix\u306fCloudFoundry\u3092\u30d9\u30fc\u30b9\u3068\u3057\u305fPaaS\u3067\u3059\u3002\nCloudFoundry\u3067\u306e\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u958b\u767a\u306f\u3001ruby\u3001javascript (node.js)\u3001java\u306a\u3069\u306e\u8a00\u8a9e\u3092\u4f7f\u3063\u3066\u3001API\u3092\u901a\u3058\u3066PaaS\u304c\u63d0\u4f9b\u3057\u3066\u304f\u308c\u308b\u500b\u3005\u306e\u30b5\u30fc\u30d3\u30b9\u3092\u5229\u7528\u3057\u307e\u3059\u3002\u3053\u306e\u3088\u3046\u306aAPI\u3092\u5229\u7528\u3059\u308b\u969b\u306b\u8cc7\u683c\u60c5\u5831(\u63a5\u7d9a\u5148URL\u3001\u30dd\u30fc\u30c8\u3001\u30e6\u30fc\u30b6ID\u3001\u30d1\u30b9\u30ef\u30fc\u30c9\u306a\u3069)\u304c\u5fc5\u8981\u3068\u306a\u308a\u307e\u3059\u304c\u3001\u3053\u308c\u3089\u306e\u60c5\u5831\u306f\u3059\u3079\u3066\u30d7\u30e9\u30c3\u30c8\u30d5\u30a9\u30fc\u30e0\u304b\u3089\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306bVCAP_SERVICES\u3068\u3044\u3046\u74b0\u5883\u5909\u6570\u3067\u4e0e\u3048\u3089\u308c\u307e\u3059\u3002(\u53c2\u8003: CloudFoundry Documentation: Binding Credentials.)\n\nVCAP_SERVICES\u3068\u306f\nBluemix\u306e\u5834\u5408\u306b\u3082\u3001\u30b5\u30fc\u30d3\u30b9\u3092\u5229\u7528\u3059\u308b\u5834\u5408\u306b\u306f\u3053\u306eVCAP_SERVICES\u3092\u4f7f\u3063\u305f\u8cc7\u683c\u60c5\u5831\u3092\u4f7f\u3046\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\n\u305f\u3068\u3048\u3070\u3001Bluemix\u4e0a\u3067redis\u3092\u4f7f\u3046\u5834\u5408\u3092\u8003\u3048\u307e\u3057\u3087\u3046\u3002\nBluemix\u3067redis\u30b5\u30fc\u30d3\u30b9\u3092\u4f5c\u6210\u3059\u308b\u3068\u3001\u30c0\u30c3\u30b7\u30e5\u30dc\u30fc\u30c9\u306b\u30a2\u30a4\u30b3\u30f3\u304c\u73fe\u308c\u307e\u3059\u3002\n\n\u3053\u306e\u30a2\u30a4\u30b3\u30f3\u306e\u5de6\u4e0b\u306b\u3042\u308b\u300c\u8cc7\u683c\u60c5\u5831\u306e\u8868\u793a\u300d\u3092\u30af\u30ea\u30c3\u30af\u3059\u308b\u3068\u3001VCAP_SERVICES\u306b\u57cb\u3081\u8fbc\u307e\u308c\u308b\u8cc7\u683c\u60c5\u5831(json\u5f62\u5f0f)\u304c\u8868\u793a\u3055\u308c\u307e\u3059\u3002\n\nBluemix\u3067\u63d0\u4f9b\u3055\u308c\u308b\u8cc7\u683c\u60c5\u5831\u306e\u4f8b\n{\n  \"redis-2.6\": [\n    {\n      \"name\": \"my-redis\",\n      \"label\": \"redis-2.6\",\n      \"plan\": \"100\",\n      \"credentials\": {\n        \"hostname\": \"xx.xx.xx.xx\",\n        \"host\": \"xx.xx.xx.xx\",\n        \"port\": xxxx,\n        \"password\": \"xxxx-xxxx-xxxx-xxxx-xxxx\",\n        \"name\": \"xxxx-xxxx-xxxx-xxxx-xxxx\"\n      }\n    }\n  ]\n}\n\n\n\u3053\u306e\u60c5\u5831\u3092\u4f7f\u7528\u3057\u3066\u3001\u305f\u3068\u3048\u3070redis\u306b\u30c7\u30fc\u30bf\u3092\u683c\u7d0d\u3059\u308b\u5834\u5408\u306f\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u30b3\u30fc\u30c9\u3092\u66f8\u304f\u3053\u3068\u306b\u306a\u308a\u307e\u3059\u3002\u306a\u304a\u3001\u3053\u3053\u3067\u306f\u3001VCAP_SERVICES\u304c\u306a\u3044\u3068\u3044\u3046\u3053\u3068\u306f\u30ed\u30fc\u30ab\u30eb\u3067\u306e\u30c7\u30d0\u30c3\u30b0\u5b9f\u884c\u3092\u610f\u5473\u3057\u3066\u304a\u308a\u3001\u305d\u306e\u5834\u5408\u306f\u30ed\u30fc\u30ab\u30eb\u306b\u7acb\u3066\u305fredis\u3092\u4f7f\u3046\u3088\u3046\u306b\u3057\u3066\u3044\u307e\u3059\u3002\n\nBluemix\u3067\u306eredis\u3078\u306e\u66f8\u304d\u8fbc\u307f\nrequire 'redis'\n\nredis_service_label = 'redis-2.6'\n\nif process.env.VCAP_SERVICES?\n  services = JSON.parse process.env.VCAP_SERVICES\n  redis_creds = services?[redis_service_label]?[0]?.credentials\n  redis_host = redis_creds?.host ? 'localhost'\n  redis_port = redis_creds?.port ? '6379'\n  redis_pass = redis_creds?.password ? null\n\nclient = redis.createClient redis_port, redis_host\nif redis_pass?\n  client.auth redis_pass\n\nclient.set key, val\n\n\n'redis-2.6'\u306fBluemix\u4e0a\u3067\u9078\u629e\u3057\u305f\u30b5\u30fc\u30d3\u30b9\u306e\u7a2e\u985e\u3067\u3059\u306e\u3067\u3001\u540c\u3058\u30b5\u30fc\u30d3\u30b9\u3092\u8907\u6570\u4f7f\u7528\u3057\u305f\u5834\u5408\u306a\u3069\u306f\u3001\u914d\u5217\u306e\u4e2d\u304b\u3089\u9069\u5f53\u306a\u3082\u306e\u3092\u898b\u3064\u3051\u306a\u3051\u308c\u3070\u306a\u3089\u306a\u3044\u306a\u3069\u3001json\u306e\u69cb\u9020\u3092\u7406\u89e3\u3057\u305f\u3046\u3048\u3067\u8a18\u8ff0\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u3001\u7d50\u69cb\u9762\u5012\u3067\u3059\u3002\n\ncfenv\u306e\u5c0e\u5165\n\u3082\u3046\u5c11\u3057\u624b\u8efd\u306bVCAP_SERVICES\u3092\u4f7f\u3048\u308b\u3088\u3046\u306b\u3057\u305fnpm\u30e2\u30b8\u30e5\u30fc\u30eb\u304ccfenv\u3067\u3059\u3002\nBluemix\u3067cfenv\u3092\u5229\u7528\u3059\u308b\u306b\u306f\u3001package.json\u306edependencies\u306b\u30e2\u30b8\u30e5\u30fc\u30eb\u540d\"cfenv\"\u3092\u8ffd\u52a0\u3057\u307e\u3059\u3002\n\npackage.json\n{\n  ...\n  \"dependencies\": {\n    \"cfenv\": \"*\",\n    ...\n  }\n  ...\n}\n\n\n\ncfenv\u306e\u4f7f\u3044\u65b9\n\u305d\u308c\u3067\u306f\u3001\u4e0a\u8a18\u306e\u4f8b\u3092cfenv\u3067\u66f8\u304d\u63db\u3048\u3066\u307f\u307e\u3059\u3002\n\nBluemix\u3067\u306eredis\u3078\u306e\u66f8\u304d\u8fbc\u307f(cfenv\u7248)\nrequire 'redis'\nrequire 'cfenv'\n\nredis_creds = cfenv.getAppEnv().getServiceCreds 'my-redis'\nredis_host = redis_creds?.host ? 'localhost'\nredis_port = redis_creds?.port ? '6379'\nredis_pass = redis_creds?.password ? null\n\n# \u4ee5\u4e0b\u306f\u540c\u3058\nclient = redis.createClient redis_port, redis_host\nif redis_pass?\n  client.auth redis_pass\n\nclient.set key, val\n\n\ngetServiceCreds\u3067\u306f\u3001\u30b5\u30fc\u30d3\u30b9\u540d\u3092\u4f7f\u3048\u307e\u3059\u3002\u30b5\u30fc\u30d3\u30b9\u306e\u7a2e\u985e\u306f\u5168\u822c\u7684\u306b\u9577\u304f\u3001\u307e\u305f\u547d\u540d\u65b9\u6cd5\u306b\u4e00\u8cab\u6027\u304c\u7121\u3044\u305f\u3081\u3001\u30b5\u30fc\u30d3\u30b9\u540d\u3092\u4f7f\u3046\u3053\u3068\u304c\u3067\u304d\u308b\u3068\u898b\u901a\u3057\u304c\u826f\u304f\u306a\u308a\u307e\u3059\u3002\u540c\u3058\u7a2e\u985e\u306e\u30b5\u30fc\u30d3\u30b9\u3092\u8907\u6570\u5229\u7528\u3059\u308b\u3068\u304d\u306a\u3069\u3001json\u306e\u69cb\u9020\u306b\u305d\u3063\u3066\u8981\u7d20\u3092\u5217\u6319\u3059\u308b\u5fc5\u8981\u304c\u306a\u304f\u30b5\u30fc\u30d3\u30b9\u540d\u3067\u7c21\u5358\u306b\u30a2\u30af\u30bb\u30b9\u3067\u304d\u308b\u3053\u3068\u306f\u975e\u5e38\u306b\u91cd\u8981\u3067\u3059\u3002\u307e\u305f\u3001\u5168\u822c\u7684\u306bjson\u306e\u69cb\u9020\u3092\u6bd4\u8f03\u7684\u610f\u8b58\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u305b\u3093\u3002\n\n\u307e\u3068\u3081\n\nBluemix\u306fCloudFoundry\u3067\u3059\u306e\u3067\u3001\u30b5\u30fc\u30d3\u30b9\u306e\u8cc7\u683c\u60c5\u5831\u306fVCAP_SERVICES\u74b0\u5883\u5909\u6570\u306b\u683c\u7d0d\u3055\u308c\u3066\u3044\u307e\u3059\u3002\n\u8cc7\u683c\u60c5\u5831\u306fjson\u3067\u3059\u306e\u3067\u81ea\u529b\u3067\u89e3\u6790\u3059\u308b\u3053\u3068\u3082\u3067\u304d\u307e\u3059\u304c\u3001cfenv\u30e2\u30b8\u30e5\u30fc\u30eb\u3092\u4f7f\u3048\u3070\u3001\u69cb\u9020\u3092\u610f\u8b58\u3059\u308b\u5fc5\u8981\u304c\u306a\u304f\u3001\u30b3\u30fc\u30c9\u304c\u30b7\u30f3\u30d7\u30eb\u306b\u306a\u308a\u307e\u3059\u3002\n\nIBM [Bluemix](https://console.ng.bluemix.net/)\u306f[CloudFoundry](http://cloudfoundry.org/index.html)\u3092\u30d9\u30fc\u30b9\u3068\u3057\u305fPaaS\u3067\u3059\u3002\n\nCloudFoundry\u3067\u306e\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u958b\u767a\u306f\u3001ruby\u3001javascript (node.js)\u3001java\u306a\u3069\u306e\u8a00\u8a9e\u3092\u4f7f\u3063\u3066\u3001API\u3092\u901a\u3058\u3066PaaS\u304c\u63d0\u4f9b\u3057\u3066\u304f\u308c\u308b\u500b\u3005\u306e\u30b5\u30fc\u30d3\u30b9\u3092\u5229\u7528\u3057\u307e\u3059\u3002\u3053\u306e\u3088\u3046\u306aAPI\u3092\u5229\u7528\u3059\u308b\u969b\u306b\u8cc7\u683c\u60c5\u5831(\u63a5\u7d9a\u5148URL\u3001\u30dd\u30fc\u30c8\u3001\u30e6\u30fc\u30b6ID\u3001\u30d1\u30b9\u30ef\u30fc\u30c9\u306a\u3069)\u304c\u5fc5\u8981\u3068\u306a\u308a\u307e\u3059\u304c\u3001\u3053\u308c\u3089\u306e\u60c5\u5831\u306f\u3059\u3079\u3066\u30d7\u30e9\u30c3\u30c8\u30d5\u30a9\u30fc\u30e0\u304b\u3089\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306b`VCAP_SERVICES`\u3068\u3044\u3046\u74b0\u5883\u5909\u6570\u3067\u4e0e\u3048\u3089\u308c\u307e\u3059\u3002(\u53c2\u8003: [CloudFoundry Documentation: Binding Credentials.](http://docs.cloudfoundry.org/services/binding-credentials.html))\n\n#VCAP_SERVICES\u3068\u306f\n\nBluemix\u306e\u5834\u5408\u306b\u3082\u3001\u30b5\u30fc\u30d3\u30b9\u3092\u5229\u7528\u3059\u308b\u5834\u5408\u306b\u306f\u3053\u306eVCAP_SERVICES\u3092\u4f7f\u3063\u305f\u8cc7\u683c\u60c5\u5831\u3092\u4f7f\u3046\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\n\n\u305f\u3068\u3048\u3070\u3001Bluemix\u4e0a\u3067redis\u3092\u4f7f\u3046\u5834\u5408\u3092\u8003\u3048\u307e\u3057\u3087\u3046\u3002\n\nBluemix\u3067redis\u30b5\u30fc\u30d3\u30b9\u3092\u4f5c\u6210\u3059\u308b\u3068\u3001\u30c0\u30c3\u30b7\u30e5\u30dc\u30fc\u30c9\u306b\u30a2\u30a4\u30b3\u30f3\u304c\u73fe\u308c\u307e\u3059\u3002\n\n![bm-redis-icon.png](https://qiita-image-store.s3.amazonaws.com/0/21963/bd00a21c-1d0c-a8d8-3003-3ea29d172767.png)\n\n\u3053\u306e\u30a2\u30a4\u30b3\u30f3\u306e\u5de6\u4e0b\u306b\u3042\u308b\u300c\u8cc7\u683c\u60c5\u5831\u306e\u8868\u793a\u300d\u3092\u30af\u30ea\u30c3\u30af\u3059\u308b\u3068\u3001VCAP_SERVICES\u306b\u57cb\u3081\u8fbc\u307e\u308c\u308b\u8cc7\u683c\u60c5\u5831(json\u5f62\u5f0f)\u304c\u8868\u793a\u3055\u308c\u307e\u3059\u3002\n\n```json:Bluemix\u3067\u63d0\u4f9b\u3055\u308c\u308b\u8cc7\u683c\u60c5\u5831\u306e\u4f8b\n{\n  \"redis-2.6\": [\n    {\n      \"name\": \"my-redis\",\n      \"label\": \"redis-2.6\",\n      \"plan\": \"100\",\n      \"credentials\": {\n        \"hostname\": \"xx.xx.xx.xx\",\n        \"host\": \"xx.xx.xx.xx\",\n        \"port\": xxxx,\n        \"password\": \"xxxx-xxxx-xxxx-xxxx-xxxx\",\n        \"name\": \"xxxx-xxxx-xxxx-xxxx-xxxx\"\n      }\n    }\n  ]\n}\n```\n\n\u3053\u306e\u60c5\u5831\u3092\u4f7f\u7528\u3057\u3066\u3001\u305f\u3068\u3048\u3070redis\u306b\u30c7\u30fc\u30bf\u3092\u683c\u7d0d\u3059\u308b\u5834\u5408\u306f\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u30b3\u30fc\u30c9\u3092\u66f8\u304f\u3053\u3068\u306b\u306a\u308a\u307e\u3059\u3002\u306a\u304a\u3001\u3053\u3053\u3067\u306f\u3001VCAP_SERVICES\u304c\u306a\u3044\u3068\u3044\u3046\u3053\u3068\u306f\u30ed\u30fc\u30ab\u30eb\u3067\u306e\u30c7\u30d0\u30c3\u30b0\u5b9f\u884c\u3092\u610f\u5473\u3057\u3066\u304a\u308a\u3001\u305d\u306e\u5834\u5408\u306f\u30ed\u30fc\u30ab\u30eb\u306b\u7acb\u3066\u305fredis\u3092\u4f7f\u3046\u3088\u3046\u306b\u3057\u3066\u3044\u307e\u3059\u3002\n\n```coffeescript:Bluemix\u3067\u306eredis\u3078\u306e\u66f8\u304d\u8fbc\u307f\nrequire 'redis'\n\nredis_service_label = 'redis-2.6'\n\nif process.env.VCAP_SERVICES?\n  services = JSON.parse process.env.VCAP_SERVICES\n  redis_creds = services?[redis_service_label]?[0]?.credentials\n  redis_host = redis_creds?.host ? 'localhost'\n  redis_port = redis_creds?.port ? '6379'\n  redis_pass = redis_creds?.password ? null\n\nclient = redis.createClient redis_port, redis_host\nif redis_pass?\n  client.auth redis_pass\n\nclient.set key, val\n```\n\n'redis-2.6'\u306fBluemix\u4e0a\u3067\u9078\u629e\u3057\u305f\u30b5\u30fc\u30d3\u30b9\u306e\u7a2e\u985e\u3067\u3059\u306e\u3067\u3001\u540c\u3058\u30b5\u30fc\u30d3\u30b9\u3092\u8907\u6570\u4f7f\u7528\u3057\u305f\u5834\u5408\u306a\u3069\u306f\u3001\u914d\u5217\u306e\u4e2d\u304b\u3089\u9069\u5f53\u306a\u3082\u306e\u3092\u898b\u3064\u3051\u306a\u3051\u308c\u3070\u306a\u3089\u306a\u3044\u306a\u3069\u3001json\u306e\u69cb\u9020\u3092\u7406\u89e3\u3057\u305f\u3046\u3048\u3067\u8a18\u8ff0\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u3001\u7d50\u69cb\u9762\u5012\u3067\u3059\u3002\n\n#cfenv\u306e\u5c0e\u5165\n\n\u3082\u3046\u5c11\u3057\u624b\u8efd\u306bVCAP_SERVICES\u3092\u4f7f\u3048\u308b\u3088\u3046\u306b\u3057\u305fnpm\u30e2\u30b8\u30e5\u30fc\u30eb\u304c[cfenv](https://www.npmjs.com/package/cfenv)\u3067\u3059\u3002\n\nBluemix\u3067cfenv\u3092\u5229\u7528\u3059\u308b\u306b\u306f\u3001package.json\u306e*dependencies*\u306b\u30e2\u30b8\u30e5\u30fc\u30eb\u540d`\"cfenv\"`\u3092\u8ffd\u52a0\u3057\u307e\u3059\u3002\n\n```json:package.json\n{\n  ...\n  \"dependencies\": {\n    \"cfenv\": \"*\",\n    ...\n  }\n  ...\n}\n```\n\n#cfenv\u306e\u4f7f\u3044\u65b9\n\n\u305d\u308c\u3067\u306f\u3001\u4e0a\u8a18\u306e\u4f8b\u3092cfenv\u3067\u66f8\u304d\u63db\u3048\u3066\u307f\u307e\u3059\u3002\n\n```coffeescript:Bluemix\u3067\u306eredis\u3078\u306e\u66f8\u304d\u8fbc\u307f(cfenv\u7248)\nrequire 'redis'\nrequire 'cfenv'\n\nredis_creds = cfenv.getAppEnv().getServiceCreds 'my-redis'\nredis_host = redis_creds?.host ? 'localhost'\nredis_port = redis_creds?.port ? '6379'\nredis_pass = redis_creds?.password ? null\n\n# \u4ee5\u4e0b\u306f\u540c\u3058\nclient = redis.createClient redis_port, redis_host\nif redis_pass?\n  client.auth redis_pass\n\nclient.set key, val\n```\n\n`getServiceCreds`\u3067\u306f\u3001\u30b5\u30fc\u30d3\u30b9\u540d\u3092\u4f7f\u3048\u307e\u3059\u3002\u30b5\u30fc\u30d3\u30b9\u306e\u7a2e\u985e\u306f\u5168\u822c\u7684\u306b\u9577\u304f\u3001\u307e\u305f\u547d\u540d\u65b9\u6cd5\u306b\u4e00\u8cab\u6027\u304c\u7121\u3044\u305f\u3081\u3001\u30b5\u30fc\u30d3\u30b9\u540d\u3092\u4f7f\u3046\u3053\u3068\u304c\u3067\u304d\u308b\u3068\u898b\u901a\u3057\u304c\u826f\u304f\u306a\u308a\u307e\u3059\u3002\u540c\u3058\u7a2e\u985e\u306e\u30b5\u30fc\u30d3\u30b9\u3092\u8907\u6570\u5229\u7528\u3059\u308b\u3068\u304d\u306a\u3069\u3001json\u306e\u69cb\u9020\u306b\u305d\u3063\u3066\u8981\u7d20\u3092\u5217\u6319\u3059\u308b\u5fc5\u8981\u304c\u306a\u304f\u30b5\u30fc\u30d3\u30b9\u540d\u3067\u7c21\u5358\u306b\u30a2\u30af\u30bb\u30b9\u3067\u304d\u308b\u3053\u3068\u306f\u975e\u5e38\u306b\u91cd\u8981\u3067\u3059\u3002\u307e\u305f\u3001\u5168\u822c\u7684\u306bjson\u306e\u69cb\u9020\u3092\u6bd4\u8f03\u7684\u610f\u8b58\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u305b\u3093\u3002\n\n#\u307e\u3068\u3081\n\n* Bluemix\u306fCloudFoundry\u3067\u3059\u306e\u3067\u3001\u30b5\u30fc\u30d3\u30b9\u306e\u8cc7\u683c\u60c5\u5831\u306f`VCAP_SERVICES`\u74b0\u5883\u5909\u6570\u306b\u683c\u7d0d\u3055\u308c\u3066\u3044\u307e\u3059\u3002\n* \u8cc7\u683c\u60c5\u5831\u306fjson\u3067\u3059\u306e\u3067\u81ea\u529b\u3067\u89e3\u6790\u3059\u308b\u3053\u3068\u3082\u3067\u304d\u307e\u3059\u304c\u3001cfenv\u30e2\u30b8\u30e5\u30fc\u30eb\u3092\u4f7f\u3048\u3070\u3001\u69cb\u9020\u3092\u610f\u8b58\u3059\u308b\u5fc5\u8981\u304c\u306a\u304f\u3001\u30b3\u30fc\u30c9\u304c\u30b7\u30f3\u30d7\u30eb\u306b\u306a\u308a\u307e\u3059\u3002\n", "tags": ["Bluemix", "Node.js", "cloudfoundry"]}