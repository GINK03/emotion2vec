{"tags": ["Mac", "jXA", "JavaScript"], "context": "\n\n\u307e\u3068\u3081\nSafari: Apple\u8b39\u88fd\u3060\u3051\u3069\u6a5f\u80fd\u5c11\u306a\u3044\nChrome: \u306a\u305c\u304b\u7570\u5e38\u306b\u5145\u5b9f\nFirefox: \u307b\u307c\u4f55\u3082\u3067\u304d\u306a\u3044\n\n\u8868\n\u6c17\u304c\u5411\u3044\u305f\u3068\u304d\u306b\u3061\u3087\u3063\u3068\u305a\u3064\u66f4\u65b0\u4e2d\n\n\n\n\nSafari\nChrome\nFirefox\n\n\n\n\n\u53c2\u7167\nApplication( \"Safari\" )\nApplication( \"Chrome\" )\nApplication( \"Firefox\" )\n\n\n\u30a6\u30a3\u30f3\u30c9\u30a6(\u5168\u3066)\napp.windows()\napp.windows()\napp.windows()\n\n\n\u30a6\u30a3\u30f3\u30c9\u30a6(\u6700\u524d\u9762)\napp.windows[0]\napp.windows[0]\napp.windows[0]\n\n\n\u30a6\u30a3\u30f3\u30c9\u30a6\u4f5c\u6210\napp .Document().make()\napp .Window().make()\n-\n\n\n\u30bf\u30d6(\u5168\u3066)\nwin.tabs()\nwin.tabs()\n-\n\n\n\u30bf\u30d6(\u8868\u793a\u4e2d)\nwin .currentTab()\nwin .activeTab()\n-\n\n\n\u30bf\u30d6\u5207\u308a\u66ff\u3048\nwin .currentTab = tab\n\nwin .activeTabIndex = index\n\n-\n\n\nURL\u79fb\u52d5\ntab.url = \"http://qiita.com\"\ntab.url = \"http://qiita.com\"\n-\n\n\nJS\u5b9f\u884c\napp .doJavaScript(\"alert('hi.'),{in: tab})\napp .execute(tab, {javascript:\"alert('hi.')\"})\n-\n\n\n\u30da\u30fc\u30b8\u66f4\u65b0\ntab.url = tab.url()\ntab.reload()\n-\n\n\n\u8aad\u8fbc\u4e2d\u6b62\n-\ntab.stop()\n-\n\n\n\u623b\u308b & \u9032\u3080\n(\u3084\u308d\u3046\u3068\u601d\u3048\u3070doJavaScript\u3067)\ntab.goBack();tab.goForward();\n-\n\n\n\u30d6\u30c3\u30af\u30de\u30fc\u30af\n-\n\u53c2\u7167\u53ef(\u9577\u3044\u306e\u3067\u7701\u7565)\n-\n\n\n\u5c65\u6b74\n-\n-\n-\n\n\n\nChrome\u306e\u65b0\u898f\u30a6\u30a3\u30f3\u30c9\u30a6\u4f5c\u6210\u306f\u623b\u308a\u5024\u3067\u305d\u306e\u307e\u307eWindow\u3092\u5f97\u3089\u308c\u308b\u3002\nSafari\u306fDocument\u304c\u8fd4\u3063\u3066\u304f\u308b\u304b\u3089URL\u79fb\u52d5\u3057\u305f\u3044\u3068\u304d\u3068\u304b\u56f0\u308b\u3002\n(app.Window().make()\u3067\u304d\u308c\u3070\u3044\u3044\u306e\u306b\u30fb\u30fb\u30fb)\nWindow\u3092\u5f97\u308b\u5834\u5408\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u3059\u308b\u3068\u3044\u3044\u306e\u304b\u3082\u3057\u308c\u306a\u3044\u30fb\u30fb\u30fb\nvar Safari = Application(\"Safari\");\nvar doc = Safari.Document().make();\nvar win = Safari.windows[doc.name()];\n\n//URL\u79fb\u52d5\nwin.currentTab.url = \"http://qiita.com\"\n\n\n\u4f7f\u3063\u3066\u307f\u308b\n\u4ee5\u4e0b\u306e\u8a18\u4e8b\u3068\u540c\u3058\u3053\u3068\u3092\u3059\u308b\u30b3\u30fc\u30c9\u3092\u66f8\u3044\u3066\u307f\u307e\u3057\u305f\u3002\n\nSafari\u3067\u81ea\u52d5\u3067\u30bf\u30d6\u5207\u308a\u66ff\u3048\u30fb\u66f4\u65b0\u3092\u3059\u308b - Qiita\n\nJXA\u3092\u77e5\u3089\u306a\u3044\u65b9\u306f\u3053\u3061\u3089\u3002\n\n\u77e5\u3089\u306a\u3044\u3046\u3061\u306bMac\u304c\u30b7\u30b9\u30c6\u30e0\u6a19\u6e96\u3067JavaScript\u3067\u64cd\u4f5c\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u3063\u3066\u305f (JXA) - Qiita\n\n\n\u3084\u308b\u3053\u3068\n\u4e0b\u6e96\u5099\n\n\u5f85\u3061\u79d2\u6570\u3092\u6307\u5b9a (DELAY)\n\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u53c2\u7167\u3092\u53d6\u5f97\n\u6700\u524d\u9762\u306e\u30a6\u30a3\u30f3\u30c9\u30a6\u3092\u53d6\u5f97\n\n\n\u30eb\u30fc\u30d7\n\n\u30bf\u30d6\u3092\u5207\u308a\u66ff\u3048\u3066DELAY\u79d2\u3060\u3051\u5f85\u3064\n\u30da\u30fc\u30b8\u3092\u66f4\u65b0\u3057\u3066DELAY\u79d2\u3060\u3051\u5f85\u3064\n\n\n\u8a66\u3059\u306b\u306f30\u79d2\u306f\u9577\u3044\u306e\u30673\u79d2\u306b\u3057\u307e\u3057\u305f\u3002\n\nSafari\n\nautoreload_safari.js\nconst DELAY = 3;\n\nvar Safari = Application(\"Safari\");\nvar window = Safari.windows[0]; //\u6700\u524d\u9762\u306e\u30a6\u30a3\u30f3\u30c9\u30a6\u3092\u53d6\u5f97\n\nwhile(window.exists()) { //\u7121\u9650\u30eb\u30fc\u30d7 (\u30a6\u30a3\u30f3\u30c9\u30a6\u304c\u958b\u3044\u3066\u306a\u3051\u308c\u3070\u5b9f\u884c\u3057\u306a\u3044)\n  window.tabs().forEach(function(tab){\n\n    // \u30bf\u30d6\u5207\u308a\u66ff\u3048\n    window.currentTab = tab;\n    delay(DELAY);\n\n    // \u66f4\u65b0\n    tab.url = tab.url();\n    delay(DELAY);\n  });\n};\n\n\n\u30a6\u30a3\u30f3\u30c9\u30a6\u304b\u3089\u5168\u30bf\u30d6\u3092\u53d6\u5f97\u3067\u304d\u307e\u3059\u3002\n\u30bf\u30d6\u306e\u5207\u308a\u66ff\u3048\u306f\u73fe\u5728\u306e\u30bf\u30d6(currentTab)\u306b\u4efb\u610f\u306e\u30bf\u30d6\u3092\u30bb\u30c3\u30c8\u3059\u308b\u3053\u3068\u3067\u884c\u3044\u307e\u3059\u3002\nSafari\u306b\u306f\u8868\u793a\u4e2d\u306e\u30da\u30fc\u30b8\u3092\u66f4\u65b0\u3059\u308b\u95a2\u6570\u304c\u3042\u308a\u307e\u305b\u3093\u3002\n\u30da\u30fc\u30b8\u306e\u66f4\u65b0\u306f\u8868\u793a\u4e2d\u306eurl\u3092\u30bf\u30d6\u306eurl\u30d7\u30ed\u30d1\u30c6\u30a3\u306b\u518d\u30bb\u30c3\u30c8\u3059\u308b\u3053\u3068\u3067\u53ef\u80fd\u3067\u3059\u3002\n\u307e\u305f\u306fdoJavaScript\u306b\u3088\u3063\u3066\u30da\u30fc\u30b8\u5185\u3067JavaScript\u3092\u5b9f\u884c\u3057\u3066\u66f4\u65b0\u3057\u307e\u3059\u3002\n\nJavaScript\u3067\u66f4\u65b0(doJavaScript\u95a2\u6570)\nSafari.doJavaScript(\"location.reload()\", {in:tab});\n\n\ndoJavaScript\u306f\u30da\u30fc\u30b8\u5185\u3067\u306e\u5b9f\u884c\u7d50\u679c\u3092\u623b\u308a\u5024\u3068\u3057\u3066\u8fd4\u3057\u307e\u3059\u3002\n\u30da\u30fc\u30b8\u304b\u3089\u7c21\u5358\u306b\u60c5\u5831\u3092\u5f97\u305f\u3044\u5834\u5408\u306b\u4fbf\u5229\u304b\u3082\u3067\u3059\u3002\n\u540c\u3058JavaScript\u3067\u66f8\u3051\u307e\u3059\u3057\u3002\n\u30e1\u30e2:\n\u30d6\u30c3\u30af\u30de\u30fc\u30af\u306b\u30a2\u30af\u30bb\u30b9\u3059\u308b\u3053\u3068\u304c\u51fa\u6765\u307e\u305b\u3093\u3002\n\u30d6\u30c3\u30af\u30de\u30fc\u30af\u3092\u6574\u7406\u3059\u308b\u30b9\u30af\u30ea\u30d7\u30c8\u66f8\u304d\u305f\u304b\u3063\u305f\u306e\u306b\u7121\u7406\u3067\u3057\u305f\u30fb\u30fb\u30fb\u3002\n\u30ea\u30fc\u30c7\u30a3\u30f3\u30b0\u30ea\u30b9\u30c8\u306b\u8ffd\u52a0\u3059\u308b\u6a5f\u80fd\u306f\u3042\u308b\u306e\u3067\u3059\u304c\u3001\u305d\u306e\u4e00\u89a7\u3092\u53d6\u5f97\u3059\u308b\u6a5f\u80fd\u3082\u7121\u3044\u3067\u3059\u3002\n\u30d3\u30d3\u308a\u307e\u3057\u305f\u3002\n\nChrome\n\nautoreload_chrome.js\nconst DELAY = 3;\n\nvar Chrome = Application(\"Google Chrome\");\nvar window = Chrome.windows[0]; //\u6700\u524d\u9762\u306e\u30a6\u30a3\u30f3\u30c9\u30a6\u3092\u53d6\u5f97\n\nwhile(window.exists()){ //\u7121\u9650\u30eb\u30fc\u30d7 (\u30a6\u30a3\u30f3\u30c9\u30a6\u304c\u958b\u3044\u3066\u306a\u3051\u308c\u3070\u5b9f\u884c\u3057\u306a\u3044)\n  window.tabs().forEach(function(tab, i){\n\n    // \u30bf\u30d6\u5207\u308a\u66ff\u3048\n    window.activeTabIndex = i + 1;\n    delay(DELAY);\n\n    // \u66f4\u65b0\n    tab.reload();\n    delay(DELAY);\n  });\n};\n\n\n\u30a6\u30a3\u30f3\u30c9\u30a6\u304b\u3089\u5168\u30bf\u30d6\u3092\u53d6\u5f97\u3067\u304d\u307e\u3059\u3002\n\u30bf\u30d6\u306e\u5207\u308a\u66ff\u3048\u306f\u30a6\u30a3\u30f3\u30c9\u30a6\u306eactiveTabIndex\u306b\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u3092\u30bb\u30c3\u30c8\u3059\u308b\u3053\u3068\u3067\u884c\u3044\u307e\u3059\u3002\n\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u306f1\u304b\u3089\u59cb\u307e\u308b\u3053\u3068\u306b\u6ce8\u610f\u3002\n\u30bf\u30d6\u304b\u3089\u306f\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u3092\u53d6\u5f97\u3067\u304d\u307e\u305b\u3093\u3002\n\u305d\u306e\u305f\u3081forEach\u306e\u30ab\u30a6\u30f3\u30bf\u3092\u5229\u7528\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\n\u30a2\u30af\u30c6\u30a3\u30d6\u306a\u30bf\u30d6\u3092\u53d6\u5f97\u3059\u308b\u95a2\u6570\u306f.activeTab()\u3067\u3059\u3002\n\u3053\u308c\u306f\u8aad\u307f\u53d6\u308a\u5c02\u7528\u306a\u306e\u3067Safari\u306e\u3088\u3046\u306b\u4ed6\u306e\u30bf\u30d6\u3092\u30bb\u30c3\u30c8\u3059\u308b\u3053\u3068\u306f\u3067\u304d\u307e\u305b\u3093\u3002\nChrome\u306b\u306f\u8868\u793a\u4e2d\u306e\u30da\u30fc\u30b8\u3092\u66f4\u65b0\u3059\u308b\u6a5f\u80fd(.reload())\u304c\u3042\u308a\u307e\u3059\u3002\n\u66f4\u65b0\u30ad\u30e3\u30f3\u30bb\u30eb\u3084\u300c\u9032\u3080\u300d\u300c\u623b\u308b\u300d\u306e\u6a5f\u80fd\u3082\u3042\u308a\u307e\u3059\u3002\n\u3082\u3061\u308d\u3093\u30da\u30fc\u30b8\u5185\u3067JavaScript\u3092\u5b9f\u884c\u3059\u308b\u3053\u3068\u3082\u53ef\u80fd\u3067\u3059\u3002\n\nJavaScript\u3067\u66f4\u65b0(execute\u95a2\u6570)\nChrome.execute(tab, {javascript:\"location.reload()\"});\n\n\nSafari\u3068\u540c\u3058\u3088\u3046\u306bexecute\u3082\u30da\u30fc\u30b8\u5185\u3067\u306e\u5b9f\u884c\u7d50\u679c\u304c\u623b\u308a\u5024\u306b\u306a\u308a\u307e\u3059\u3002\n\u30e1\u30e2:\n\u4eca\u56de\u306e\u30d6\u30e9\u30a6\u30b6\u306e\u4e2d\u3067\u3001\u30b9\u30af\u30ea\u30d7\u30c8\u5411\u3051\u306b\u7528\u610f\u3055\u308c\u305f\u6a5f\u80fd\u306fChrome\u304c\u30c0\u30f3\u30c8\u30c4\u3067\u5145\u5b9f\u3057\u3066\u307e\u3057\u305f\uff01\n\u30d6\u30c3\u30af\u30de\u30fc\u30af\u306b\u30a2\u30af\u30bb\u30b9\u3059\u308b\u3053\u3068\u3082\u3067\u304d\u307e\u3059\u3002\n\u30d6\u30c3\u30af\u30de\u30fc\u30af\u3092\u6574\u7406\u3059\u308b\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u66f8\u304f\u3053\u3068\u3082\u53ef\u80fd\u3067\u3057\u3087\u3046\u3002\n\u3084\u3063\u3066\u307e\u305b\u3093\u304c\u3002\n\nFirefox\n\nautoreload_firefox.js\nconst DELAY = 3;\n\nvar Firefox = Application(\"Firefox\");\nvar window = Firefox.windows[0]; //\u6700\u524d\u9762\u306e\u30a6\u30a3\u30f3\u30c9\u30a6\u3092\u53d6\u5f97\n\nSystemEvents = Application(\"System Events\");\n\nwhile(window.exists()){ //\u7121\u9650\u30eb\u30fc\u30d7 (\u30a6\u30a3\u30f3\u30c9\u30a6\u304c\u958b\u3044\u3066\u306a\u3051\u308c\u3070\u5b9f\u884c\u3057\u306a\u3044)\n\n  // \u30bf\u30d6\u5207\u308a\u66ff\u3048\n  Firefox.activate();\n  delay(0.3); //\u30a2\u30af\u30c6\u30a3\u30d6\u306b\u306a\u308b\u307e\u3067\u5c11\u3057\u5f85\u3064\n  SystemEvents.keystroke(\"]\", {using:[\"command down\", \"shift down\"]});\n  delay(DELAY);\n\n  // \u66f4\u65b0\n  Firefox.activate();\n  delay(0.3); //\u30a2\u30af\u30c6\u30a3\u30d6\u306b\u306a\u308b\u307e\u3067\u5c11\u3057\u5f85\u3064\n  SystemEvents.keystroke(\"r\", {using:\"command down\"});\n  delay(DELAY);\n};\n\n\n\u30a6\u30a3\u30f3\u30c9\u30a6\u304b\u3089\u30bf\u30d6\u3092\u53d6\u5f97\u3067\u304d\u307e\u305b\u3093\u3002\n\u3063\u3066\u3053\u3068\u306fApplication.documents()\u3067\u30da\u30fc\u30b8\u306e\u5185\u5bb9\u3092\u898b\u308c\u308b\u306e\u304b\u306a\uff1f\n>> Firefox = Application(\"Firefox\")\n=> Application(\"Firefox\")\n>> Firefox.windows.length\n=> 10\n>> Firefox.documents()\n=> []\n>> \n\n\uff01\uff1f\n\u7a7a\u306e\u914d\u5217\u304c\u8fd4\u3063\u3066\u304d\u307e\u3057\u305f\u3002\n\u3069\u3046\u3084\u3089\u7528\u8a9e\u8aac\u660e\u306f\u30c6\u30f3\u30d7\u30ec\u305d\u306e\u307e\u307e\u4f7f\u3063\u3066\u3044\u3066\u3001\u6a5f\u80fd\u306f\u4f55\u3082\u306a\u3055\u305d\u3046\u3067\u3059\u3002\u591a\u5206\u3002\n\u30a6\u30a3\u30f3\u30c9\u30a6\u3092\u53d6\u5f97\u3059\u308b\u4ee5\u5916\u3001\u307b\u307c\u4f55\u3082\u51fa\u6765\u306a\u3055\u305d\u3046\u3067\u3059\u3002\n\u3053\u3046\u3044\u3046\u5834\u5408\u306fSystem Events\u304b\u3089\u30ad\u30fc\u30dc\u30fc\u30c9\u3092\u62bc\u3057\u305f\u308a\u3057\u3066\u64cd\u4f5c\u3059\u308b\u3057\u304b\u3042\u308a\u307e\u305b\u3093\u3002\n\u30ad\u30fc\u30dc\u30fc\u30c9\u3084\u30de\u30a6\u30b9\u64cd\u4f5c\u3092\u3059\u308b\u65b9\u6cd5\u306f\u3053\u3061\u3089\u306b\u66f8\u304d\u307e\u3057\u305f\u3002\n\nMac\u306e\u30ad\u30fc\u30dc\u30fc\u30c9\u5165\u529b\u3001\u30de\u30a6\u30b9\u30af\u30ea\u30c3\u30af\u3092JavaScript\u3067 (JXA) - Qiita\n\nApplication(\"Firefox\")\u306e\u90e8\u5206\u3092\u5909\u3048\u308b\u3060\u3051\u3067Safari\u3067\u3082Chrome\u3067\u3082\u52d5\u304d\u307e\u3059\u3002\n\u3044\u3061\u3044\u3061.activate()\u3059\u308b\u5fc5\u8981\u304c\u3042\u308b\u306e\u3067\u4ed6\u306e\u4f5c\u696d\u4e2d\u306b\u52d5\u4f5c\u3055\u305b\u308b\u306e\u306f\u7121\u7406\u3067\u3059\u3002\n\u30e1\u30e2:\n\u30da\u30fc\u30b8\u306e\u5185\u5bb9\u3059\u3089\u53d6\u5f97\u3067\u304d\u306a\u3044\u3093\u3058\u3083\u30fb\u30fb\u30fb\uff1f\n\u30b9\u30af\u30ea\u30d7\u30c8\u3067\u64cd\u4f5c\u3059\u308b\u306a\u3089\u5225\u306e\u30d6\u30e9\u30a6\u30b6\u3092\u4f7f\u3044\u307e\u3057\u3087\u3046\u3002\n\u8ffd\u8a18:\nwindow\u306b\u3082document\u30d7\u30ed\u30d1\u30c6\u30a3\u304c\u3042\u308b\u3053\u3068\u306b\u6c17\u4ed8\u304d\u307e\u3057\u305f\u304c\u3001null\u3067\u3057\u305f\u3002\nvarFirefox = Application(\"Firefox\");\n\nFirefox.windows[0].document();\n//=> undefined\n\nFirefox.windows[0].properties();\n//=> {\"document\":null, \"closeable\":true, \"zoomed\":true, \"class\":\"window\", \"index\":1, \"visible\":true, \"name\":\"Yahoo! JAPAN\", \"modal\":false, \"miniaturizable\":true, \"titled\":true, \"id\":6188, \"miniaturized\":false, \"floating\":false, \"resizable\":true, \"bounds\":{\"x\":0, \"y\":23, \"width\":1280, \"height\":709}, \"zoomable\":true}\n\n\u30a6\u30a3\u30f3\u30c9\u30a6\u304b\u3089\u30da\u30fc\u30b8\u306e\u30bf\u30a4\u30c8\u30eb\u3060\u3051\u53d6\u5f97\u3067\u304d\u308b\u3088\u3046\u3067\u3059\u3002\n\u4e0a\u306e\u4f8b\u3060\u3068Yahoo\u3092\u958b\u3044\u3066\u3044\u308b\u3053\u3068\u304cname\u30d7\u30ed\u30d1\u30c6\u30a3\u3067\u5206\u304b\u308a\u307e\u3059\u3002\n\u30da\u30fc\u30b8\u5185\u5bb9\u3092\u53d6\u5f97\u3059\u308b\u65b9\u6cd5\u304c\u5b58\u5728\u3059\u308b\u306a\u3089\u3001\u77e5\u3063\u3066\u308b\u65b9\u6559\u3048\u3066\u304f\u3060\u3055\u3044\u3002\n\n\u86c7\u8db3\n\u305c\u3093\u305c\u3093\u95a2\u4fc2\u306a\u3044\u3051\u3069\u3001Terminal\u3067\u30b7\u30a7\u30eb\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u5b9f\u884c\u3059\u308bdoScript\u3082Safari\u306edoJavaScript\u3068\u540c\u3058\u69cb\u6587\n\u305f\u3060\u3057\u623b\u308a\u5024\u306f\u30bf\u30d6\u306e\u53c2\u7167\u3067\u3059\u3002\u30bf\u30d6\u3092\u6307\u5b9a\u3057\u306a\u3044\u5834\u5408\u306f\u65b0\u3057\u3044\u30a6\u30a3\u30f3\u30c9\u30a6\u3092\u958b\u304f\u306e\u3067\u3002\n\nTerminal\nvar Terminal = Application(\"Terminal\");\nvar tab = Terminal.windows[0].selectedTab(); // Safari\u306fcurrentTab\u3002\u540d\u524d\u7d71\u4e00\u3057\u3066\u304f\u308c\n\nTerminal.doScript(\"echo 'hi.'\", {in:tab});\nvar newTab = Terminal.doScript(\"echo 'hi new window.'\");\n\n\n\u30b3\u30de\u30f3\u30c9\u5b9f\u884c\u306e\u623b\u308a\u5024\u3092\u5f97\u305f\u3044\u5834\u5408\u306fdoShellScript\u3092\u4f7f\u3044\u307e\u3059\n\u3053\u308c\u306fTerminal\u3058\u3083\u306a\u304f\u3066\u3082\u4f7f\u3048\u307e\u3059\n\ndoShellScript\nvar app = Application.currentApplication();\napp.includeStandardAdditions = true;\n\nvar date = app.doShellScript(\"date\");\n\n\n# \u307e\u3068\u3081\n\nSafari: Apple\u8b39\u88fd\u3060\u3051\u3069\u6a5f\u80fd\u5c11\u306a\u3044\nChrome: \u306a\u305c\u304b\u7570\u5e38\u306b\u5145\u5b9f\nFirefox: \u307b\u307c\u4f55\u3082\u3067\u304d\u306a\u3044\n\n----\n\n\u8868\n\n\u6c17\u304c\u5411\u3044\u305f\u3068\u304d\u306b\u3061\u3087\u3063\u3068\u305a\u3064\u66f4\u65b0\u4e2d\n\n||Safari|Chrome|Firefox|\n|:--|:--|:--|:--|\n|\u53c2\u7167|Application( **\"Safari\"** )|Application( **\"Chrome\"** )|Application( **\"Firefox\"** )|\n|\u30a6\u30a3\u30f3\u30c9\u30a6<br>(\u5168\u3066)|app.windows()|app.windows()|app.windows()|\n|\u30a6\u30a3\u30f3\u30c9\u30a6<br>(\u6700\u524d\u9762)|app.windows[0]|app.windows[0]|app.windows[0]|\n|\u30a6\u30a3\u30f3\u30c9\u30a6<br>\u4f5c\u6210|app **.Document**().make()|app **.Window**().make()|-|\n|\u30bf\u30d6<br>(\u5168\u3066)|win.tabs()|win.tabs()|-|\n|\u30bf\u30d6<br>(\u8868\u793a\u4e2d)|win **.currentTab**()|win **.activeTab**()|-|\n|\u30bf\u30d6<br>\u5207\u308a\u66ff\u3048|win **.currentTab = tab**|win **.activeTabIndex = index**|-|\n|URL\u79fb\u52d5|tab.url = \"http://qiita.com\"|tab.url = \"http://qiita.com\"|-|\n|JS\u5b9f\u884c|app **.doJavaScript**(\"alert('hi.'),{in: tab})|app **.execute**(tab, {javascript:\"alert('hi.')\"})|-|\n|\u30da\u30fc\u30b8\u66f4\u65b0|tab.url = tab.url()|tab.reload()|-|\n|\u8aad\u8fbc\u4e2d\u6b62|-|tab.stop()|-|\n|\u623b\u308b & \u9032\u3080|(\u3084\u308d\u3046\u3068\u601d\u3048\u3070doJavaScript\u3067)|tab.goBack();<br>tab.goForward();|-|\n|\u30d6\u30c3\u30af\u30de\u30fc\u30af|-|\u53c2\u7167\u53ef(\u9577\u3044\u306e\u3067\u7701\u7565)|-|\n|\u5c65\u6b74|-|-|-|\n\nChrome\u306e\u65b0\u898f\u30a6\u30a3\u30f3\u30c9\u30a6\u4f5c\u6210\u306f\u623b\u308a\u5024\u3067\u305d\u306e\u307e\u307eWindow\u3092\u5f97\u3089\u308c\u308b\u3002\nSafari\u306fDocument\u304c\u8fd4\u3063\u3066\u304f\u308b\u304b\u3089URL\u79fb\u52d5\u3057\u305f\u3044\u3068\u304d\u3068\u304b\u56f0\u308b\u3002\n(`app.Window().make()`\u3067\u304d\u308c\u3070\u3044\u3044\u306e\u306b\u30fb\u30fb\u30fb)\n\nWindow\u3092\u5f97\u308b\u5834\u5408\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u3059\u308b\u3068\u3044\u3044\u306e\u304b\u3082\u3057\u308c\u306a\u3044\u30fb\u30fb\u30fb\n\n```js\nvar Safari = Application(\"Safari\");\nvar doc = Safari.Document().make();\nvar win = Safari.windows[doc.name()];\n\n//URL\u79fb\u52d5\nwin.currentTab.url = \"http://qiita.com\"\n```\n\n# \u4f7f\u3063\u3066\u307f\u308b\n\n\u4ee5\u4e0b\u306e\u8a18\u4e8b\u3068\u540c\u3058\u3053\u3068\u3092\u3059\u308b\u30b3\u30fc\u30c9\u3092\b\u66f8\u3044\u3066\u307f\u307e\u3057\u305f\u3002\n\n- [Safari\u3067\u81ea\u52d5\u3067\u30bf\u30d6\u5207\u308a\u66ff\u3048\u30fb\u66f4\u65b0\u3092\u3059\u308b - Qiita](http://qiita.com/okuramasafumi/items/90320141b3439133ccd5)\n\nJXA\u3092\u77e5\u3089\u306a\u3044\u65b9\u306f\u3053\u3061\u3089\u3002\n\n- [\u77e5\u3089\u306a\u3044\u3046\u3061\u306bMac\u304c\u30b7\u30b9\u30c6\u30e0\u6a19\u6e96\u3067JavaScript\u3067\u64cd\u4f5c\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u3063\u3066\u305f (JXA) - Qiita](http://qiita.com/zakuroishikuro/items/1b02378bf9e940602d87)\n\n## \u3084\u308b\u3053\u3068\n\n\u4e0b\u6e96\u5099\n\n- \u5f85\u3061\u79d2\u6570\u3092\u6307\u5b9a (DELAY)\n- \u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u53c2\u7167\u3092\u53d6\u5f97\n- \u6700\u524d\u9762\u306e\u30a6\u30a3\u30f3\u30c9\u30a6\u3092\u53d6\u5f97\n\n-------------------------\n\u30eb\u30fc\u30d7\n\n- \u30bf\u30d6\u3092\u5207\u308a\u66ff\u3048\u3066DELAY\u79d2\u3060\u3051\u5f85\u3064\n- \u30da\u30fc\u30b8\u3092\u66f4\u65b0\u3057\u3066DELAY\u79d2\u3060\u3051\u5f85\u3064\n\n------------------------\n\n\u8a66\u3059\u306b\u306f30\u79d2\u306f\u9577\u3044\u306e\u30673\u79d2\u306b\u3057\u307e\u3057\u305f\u3002\n\n# Safari\n\n```js:autoreload_safari.js\nconst DELAY = 3;\n\nvar Safari = Application(\"Safari\");\nvar window = Safari.windows[0]; //\u6700\u524d\u9762\u306e\u30a6\u30a3\u30f3\u30c9\u30a6\u3092\u53d6\u5f97\n\nwhile(window.exists()) { //\u7121\u9650\u30eb\u30fc\u30d7 (\u30a6\u30a3\u30f3\u30c9\u30a6\u304c\u958b\u3044\u3066\u306a\u3051\u308c\u3070\u5b9f\u884c\u3057\u306a\u3044)\n  window.tabs().forEach(function(tab){\n\n    // \u30bf\u30d6\u5207\u308a\u66ff\u3048\n    window.currentTab = tab;\n    delay(DELAY);\n\n    // \u66f4\u65b0\n    tab.url = tab.url();\n    delay(DELAY);\n  });\n};\n```\n\n\u30a6\u30a3\u30f3\u30c9\u30a6\u304b\u3089\u5168\u30bf\u30d6\u3092\u53d6\u5f97\u3067\u304d\u307e\u3059\u3002\n\u30bf\u30d6\u306e\u5207\u308a\u66ff\u3048\u306f\u73fe\u5728\u306e\u30bf\u30d6(`currentTab`)\u306b\u4efb\u610f\u306e\u30bf\u30d6\u3092\u30bb\u30c3\u30c8\u3059\u308b\u3053\u3068\u3067\u884c\u3044\u307e\u3059\u3002\n\nSafari\u306b\u306f\u8868\u793a\u4e2d\u306e\u30da\u30fc\u30b8\u3092\u66f4\u65b0\u3059\u308b\u95a2\u6570\u304c\u3042\u308a\u307e\u305b\u3093\u3002\n\u30da\u30fc\u30b8\u306e\u66f4\u65b0\u306f\u8868\u793a\u4e2d\u306eurl\u3092\u30bf\u30d6\u306e`url`\u30d7\u30ed\u30d1\u30c6\u30a3\u306b\u518d\u30bb\u30c3\u30c8\u3059\u308b\u3053\u3068\u3067\u53ef\u80fd\u3067\u3059\u3002\n\n\u307e\u305f\u306f`doJavaScript`\u306b\u3088\u3063\u3066\u30da\u30fc\u30b8\u5185\u3067JavaScript\u3092\u5b9f\u884c\u3057\u3066\u66f4\u65b0\u3057\u307e\u3059\u3002\n\n```js:JavaScript\u3067\u66f4\u65b0(doJavaScript\u95a2\u6570)\nSafari.doJavaScript(\"location.reload()\", {in:tab});\n```\n`doJavaScript`\u306f\u30da\u30fc\u30b8\u5185\u3067\u306e\u5b9f\u884c\u7d50\u679c\u3092\u623b\u308a\u5024\u3068\u3057\u3066\u8fd4\u3057\u307e\u3059\u3002\n\u30da\u30fc\u30b8\u304b\u3089\u7c21\u5358\u306b\u60c5\u5831\u3092\u5f97\u305f\u3044\u5834\u5408\u306b\u4fbf\u5229\u304b\u3082\u3067\u3059\u3002\n\u540c\u3058JavaScript\u3067\u66f8\u3051\u307e\u3059\u3057\u3002\n\n\u30e1\u30e2:\n\n\u30d6\u30c3\u30af\u30de\u30fc\u30af\u306b\u30a2\u30af\u30bb\u30b9\u3059\u308b\u3053\u3068\u304c\u51fa\u6765\u307e\u305b\u3093\u3002\n\u30d6\u30c3\u30af\u30de\u30fc\u30af\u3092\u6574\u7406\u3059\u308b\u30b9\u30af\u30ea\u30d7\u30c8\u66f8\u304d\u305f\u304b\u3063\u305f\u306e\u306b\u7121\u7406\u3067\u3057\u305f\u30fb\u30fb\u30fb\u3002\n\n\u30ea\u30fc\u30c7\u30a3\u30f3\u30b0\u30ea\u30b9\u30c8\u306b\u8ffd\u52a0\u3059\u308b\u6a5f\u80fd\u306f\u3042\u308b\u306e\u3067\u3059\u304c\u3001\u305d\u306e\u4e00\u89a7\u3092\u53d6\u5f97\u3059\u308b\u6a5f\u80fd\u3082\u7121\u3044\u3067\u3059\u3002\n\u30d3\u30d3\u308a\u307e\u3057\u305f\u3002\n\n# Chrome\n\n```js:autoreload_chrome.js\nconst DELAY = 3;\n\nvar Chrome = Application(\"Google Chrome\");\nvar window = Chrome.windows[0]; //\u6700\u524d\u9762\u306e\u30a6\u30a3\u30f3\u30c9\u30a6\u3092\u53d6\u5f97\n\nwhile(window.exists()){ //\u7121\u9650\u30eb\u30fc\u30d7 (\u30a6\u30a3\u30f3\u30c9\u30a6\u304c\u958b\u3044\u3066\u306a\u3051\u308c\u3070\u5b9f\u884c\u3057\u306a\u3044)\n  window.tabs().forEach(function(tab, i){\n\n    // \u30bf\u30d6\u5207\u308a\u66ff\u3048\n    window.activeTabIndex = i + 1;\n    delay(DELAY);\n  \n    // \u66f4\u65b0\n    tab.reload();\n    delay(DELAY);\n  });\n};\n```\n\n\u30a6\u30a3\u30f3\u30c9\u30a6\u304b\u3089\u5168\u30bf\u30d6\u3092\u53d6\u5f97\u3067\u304d\u307e\u3059\u3002\n\u30bf\u30d6\u306e\u5207\u308a\u66ff\u3048\u306f\u30a6\u30a3\u30f3\u30c9\u30a6\u306e`activeTabIndex`\u306b\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u3092\u30bb\u30c3\u30c8\u3059\u308b\u3053\u3068\u3067\u884c\u3044\u307e\u3059\u3002\n\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u306f1\u304b\u3089\u59cb\u307e\u308b\u3053\u3068\u306b\u6ce8\u610f\u3002\n\n\u30bf\u30d6\u304b\u3089\u306f\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u3092\u53d6\u5f97\u3067\u304d\u307e\u305b\u3093\u3002\n\u305d\u306e\u305f\u3081forEach\u306e\u30ab\u30a6\u30f3\u30bf\u3092\u5229\u7528\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\n\n\u30a2\u30af\u30c6\u30a3\u30d6\u306a\u30bf\u30d6\u3092\u53d6\u5f97\u3059\u308b\u95a2\u6570\u306f`.activeTab()`\u3067\u3059\u3002\n\u3053\u308c\u306f\u8aad\u307f\u53d6\u308a\u5c02\u7528\u306a\u306e\u3067Safari\u306e\u3088\u3046\u306b\u4ed6\u306e\u30bf\u30d6\u3092\u30bb\u30c3\u30c8\u3059\u308b\u3053\u3068\u306f\u3067\u304d\u307e\u305b\u3093\u3002\n\nChrome\u306b\u306f\u8868\u793a\u4e2d\u306e\u30da\u30fc\u30b8\u3092\u66f4\u65b0\u3059\u308b\u6a5f\u80fd(`.reload()`)\u304c\u3042\u308a\u307e\u3059\u3002\n\u66f4\u65b0\u30ad\u30e3\u30f3\u30bb\u30eb\u3084\u300c\u9032\u3080\u300d\u300c\u623b\u308b\u300d\u306e\u6a5f\u80fd\u3082\u3042\u308a\u307e\u3059\u3002\n\n\u3082\u3061\u308d\u3093\u30da\u30fc\u30b8\u5185\u3067JavaScript\u3092\u5b9f\u884c\u3059\u308b\u3053\u3068\u3082\u53ef\u80fd\u3067\u3059\u3002\n\n```js:JavaScript\u3067\u66f4\u65b0(execute\u95a2\u6570)\nChrome.execute(tab, {javascript:\"location.reload()\"});\n```\nSafari\u3068\u540c\u3058\u3088\u3046\u306b`execute`\u3082\u30da\u30fc\u30b8\u5185\u3067\u306e\u5b9f\u884c\u7d50\u679c\u304c\u623b\u308a\u5024\u306b\u306a\u308a\u307e\u3059\u3002\n\n\u30e1\u30e2:\n\n\u4eca\u56de\u306e\u30d6\u30e9\u30a6\u30b6\u306e\u4e2d\u3067\u3001\u30b9\u30af\u30ea\u30d7\u30c8\u5411\u3051\u306b\u7528\u610f\u3055\u308c\u305f\u6a5f\u80fd\u306fChrome\u304c\u30c0\u30f3\u30c8\u30c4\u3067\u5145\u5b9f\u3057\u3066\u307e\u3057\u305f\uff01\n\n\u30d6\u30c3\u30af\u30de\u30fc\u30af\u306b\u30a2\u30af\u30bb\u30b9\u3059\u308b\u3053\u3068\u3082\u3067\u304d\u307e\u3059\u3002\n\u30d6\u30c3\u30af\u30de\u30fc\u30af\u3092\u6574\u7406\u3059\u308b\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u66f8\u304f\u3053\u3068\u3082\u53ef\u80fd\u3067\u3057\u3087\u3046\u3002\n\u3084\u3063\u3066\u307e\u305b\u3093\u304c\u3002\n\n# Firefox\n\n```js:autoreload_firefox.js\nconst DELAY = 3;\n\nvar Firefox = Application(\"Firefox\");\nvar window = Firefox.windows[0]; //\u6700\u524d\u9762\u306e\u30a6\u30a3\u30f3\u30c9\u30a6\u3092\u53d6\u5f97\n\nSystemEvents = Application(\"System Events\");\n\nwhile(window.exists()){ //\u7121\u9650\u30eb\u30fc\u30d7 (\u30a6\u30a3\u30f3\u30c9\u30a6\u304c\u958b\u3044\u3066\u306a\u3051\u308c\u3070\u5b9f\u884c\u3057\u306a\u3044)\n\n  // \u30bf\u30d6\u5207\u308a\u66ff\u3048\n  Firefox.activate();\n  delay(0.3); //\u30a2\u30af\u30c6\u30a3\u30d6\u306b\u306a\u308b\u307e\u3067\u5c11\u3057\u5f85\u3064\n  SystemEvents.keystroke(\"]\", {using:[\"command down\", \"shift down\"]});\n  delay(DELAY);\n  \n  // \u66f4\u65b0\n  Firefox.activate();\n  delay(0.3); //\u30a2\u30af\u30c6\u30a3\u30d6\u306b\u306a\u308b\u307e\u3067\u5c11\u3057\u5f85\u3064\n  SystemEvents.keystroke(\"r\", {using:\"command down\"});\n  delay(DELAY);\n};\n```\n\n\u30a6\u30a3\u30f3\u30c9\u30a6\u304b\u3089\u30bf\u30d6\u3092\u53d6\u5f97\u3067\u304d\u307e\u305b\u3093\u3002\n\u3063\u3066\u3053\u3068\u306f`Application.documents()`\u3067\u30da\u30fc\u30b8\u306e\u5185\u5bb9\u3092\u898b\u308c\u308b\u306e\u304b\u306a\uff1f\n\n```text\n>> Firefox = Application(\"Firefox\")\n=> Application(\"Firefox\")\n>> Firefox.windows.length\n=> 10\n>> Firefox.documents()\n=> []\n>> \n```\n\n\uff01\uff1f\n\u7a7a\u306e\u914d\u5217\u304c\u8fd4\u3063\u3066\u304d\u307e\u3057\u305f\u3002\n\u3069\u3046\u3084\u3089\u7528\u8a9e\u8aac\u660e\u306f\u30c6\u30f3\u30d7\u30ec\u305d\u306e\u307e\u307e\u4f7f\u3063\u3066\u3044\u3066\u3001\u6a5f\u80fd\u306f\u4f55\u3082\u306a\u3055\u305d\u3046\u3067\u3059\u3002\u591a\u5206\u3002\n\u30a6\u30a3\u30f3\u30c9\u30a6\u3092\u53d6\u5f97\u3059\u308b\u4ee5\u5916\u3001\u307b\u307c\u4f55\u3082\u51fa\u6765\u306a\u3055\u305d\u3046\u3067\u3059\u3002\n\n\u3053\u3046\u3044\u3046\u5834\u5408\u306f`System Events`\u304b\u3089\u30ad\u30fc\u30dc\u30fc\u30c9\u3092\u62bc\u3057\u305f\u308a\u3057\u3066\u64cd\u4f5c\u3059\u308b\u3057\u304b\u3042\u308a\u307e\u305b\u3093\u3002\n\u30ad\u30fc\u30dc\u30fc\u30c9\u3084\u30de\u30a6\u30b9\u64cd\u4f5c\u3092\u3059\u308b\u65b9\u6cd5\u306f\u3053\u3061\u3089\u306b\u66f8\u304d\u307e\u3057\u305f\u3002\n\n- [Mac\u306e\u30ad\u30fc\u30dc\u30fc\u30c9\u5165\u529b\u3001\u30de\u30a6\u30b9\u30af\u30ea\u30c3\u30af\u3092JavaScript\u3067 (JXA) - Qiita](http://qiita.com/zakuroishikuro/items/afab0e33ad2030ba2f92)\n\n`Application(\"Firefox\")`\u306e\u90e8\u5206\u3092\u5909\u3048\u308b\u3060\u3051\u3067Safari\u3067\u3082Chrome\u3067\u3082\u52d5\u304d\u307e\u3059\u3002\n\u3044\u3061\u3044\u3061`.activate()`\u3059\u308b\u5fc5\u8981\u304c\u3042\u308b\u306e\u3067\u4ed6\u306e\u4f5c\u696d\u4e2d\u306b\u52d5\u4f5c\u3055\u305b\u308b\u306e\u306f\u7121\u7406\u3067\u3059\u3002\n\n\u30e1\u30e2:\n\n\u30da\u30fc\u30b8\u306e\u5185\u5bb9\u3059\u3089\u53d6\u5f97\u3067\u304d\u306a\u3044\u3093\u3058\u3083\u30fb\u30fb\u30fb\uff1f\n\u30b9\u30af\u30ea\u30d7\u30c8\u3067\u64cd\u4f5c\u3059\u308b\u306a\u3089\u5225\u306e\u30d6\u30e9\u30a6\u30b6\u3092\u4f7f\u3044\u307e\u3057\u3087\u3046\u3002\n\n**\u8ffd\u8a18:**\nwindow\u306b\u3082document\u30d7\u30ed\u30d1\u30c6\u30a3\u304c\u3042\u308b\u3053\u3068\u306b\u6c17\u4ed8\u304d\u307e\u3057\u305f\u304c\u3001null\u3067\u3057\u305f\u3002\n\n```js\nvarFirefox = Application(\"Firefox\");\n\nFirefox.windows[0].document();\n//=> undefined\n\nFirefox.windows[0].properties();\n//=> {\"document\":null, \"closeable\":true, \"zoomed\":true, \"class\":\"window\", \"index\":1, \"visible\":true, \"name\":\"Yahoo! JAPAN\", \"modal\":false, \"miniaturizable\":true, \"titled\":true, \"id\":6188, \"miniaturized\":false, \"floating\":false, \"resizable\":true, \"bounds\":{\"x\":0, \"y\":23, \"width\":1280, \"height\":709}, \"zoomable\":true}\n```\n\n\u30a6\u30a3\u30f3\u30c9\u30a6\u304b\u3089\u30da\u30fc\u30b8\u306e\u30bf\u30a4\u30c8\u30eb\u3060\u3051\u53d6\u5f97\u3067\u304d\u308b\u3088\u3046\u3067\u3059\u3002\n\u4e0a\u306e\u4f8b\u3060\u3068Yahoo\u3092\u958b\u3044\u3066\u3044\u308b\u3053\u3068\u304c`name`\u30d7\u30ed\u30d1\u30c6\u30a3\u3067\u5206\u304b\u308a\u307e\u3059\u3002\n\u30da\u30fc\u30b8\u5185\u5bb9\u3092\u53d6\u5f97\u3059\u308b\u65b9\u6cd5\u304c\u5b58\u5728\u3059\u308b\u306a\u3089\u3001\u77e5\u3063\u3066\u308b\u65b9\u6559\u3048\u3066\u304f\u3060\u3055\u3044\u3002\n\n# \u86c7\u8db3\n\n\u305c\u3093\u305c\u3093\u95a2\u4fc2\u306a\u3044\u3051\u3069\u3001Terminal\u3067\u30b7\u30a7\u30eb\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u5b9f\u884c\u3059\u308b`doScript`\u3082Safari\u306e`doJavaScript`\u3068\u540c\u3058\u69cb\u6587\n\u305f\u3060\u3057\u623b\u308a\u5024\u306f\u30bf\u30d6\u306e\u53c2\u7167\u3067\u3059\u3002\u30bf\u30d6\u3092\u6307\u5b9a\u3057\u306a\u3044\u5834\u5408\u306f\u65b0\u3057\u3044\u30a6\u30a3\u30f3\u30c9\u30a6\u3092\u958b\u304f\u306e\u3067\u3002\n\n```js:Terminal\nvar Terminal = Application(\"Terminal\");\nvar tab = Terminal.windows[0].selectedTab(); // Safari\u306fcurrentTab\u3002\u540d\u524d\u7d71\u4e00\u3057\u3066\u304f\u308c\n\nTerminal.doScript(\"echo 'hi.'\", {in:tab});\nvar newTab = Terminal.doScript(\"echo 'hi new window.'\");\n```\n\n\u30b3\u30de\u30f3\u30c9\u5b9f\u884c\u306e\u623b\u308a\u5024\u3092\u5f97\u305f\u3044\u5834\u5408\u306f`doShellScript`\u3092\u4f7f\u3044\u307e\u3059\n\u3053\u308c\u306fTerminal\u3058\u3083\u306a\u304f\u3066\u3082\u4f7f\u3048\u307e\u3059\n\n```js:doShellScript\nvar app = Application.currentApplication();\napp.includeStandardAdditions = true;\n\nvar date = app.doShellScript(\"date\");\n```\n"}