{"context": "\u5143\u306f scikit-learn\u3067\u7dda\u5f62\u30e2\u30c7\u30eb\u3068\u30ab\u30fc\u30cd\u30eb\u30e2\u30c7\u30eb\u306e\u56de\u5e30\u5206\u6790\u3092\u3084\u3063\u3066\u307f\u305f - \u30a4\u30e9\u30b9\u30c8\u3067\u5b66\u3076\u6a5f\u4f1a\u5b66\u7fd2\u306b\u66f8\u3044\u3066\u3044\u307e\u3057\u305f\u304c\u3001\u3084\u3084\u3053\u3057\u3044\u306e\u3067\u5225\u8a18\u4e8b\u306b\u3057\u307e\u3057\u305f\u3002\n\u30c7\u30fc\u30bf\u30bb\u30c3\u30c8\u306fsklearn.datasets.load_diabetes \u3092\u4f7f\u3044\u307e\u3059\u3002\n\u7cd6\u5c3f\u75c5\u60a3\u8005442\u540d\u306e\u30c7\u30fc\u30bf\u304c\u5165\u3063\u3066\u304a\u308a\u3001\u57fa\u790e\u9805\u76ee\uff08age, sex, body mass index, average blood pressure\uff09\u30686\u3064\u306e\u8840\u6db2\u691c\u67fb\u9805\u76ee\u3092\u5165\u529b\u3068\u3057\u30011\u5e74\u5f8c\u306e\u9032\u884c\u72b6\u6cc1\u3092\u4e88\u6e2c\u30bf\u30fc\u30b2\u30c3\u30c8\u306b\u3057\u307e\u3059\u3002\n\n\u30c7\u30fc\u30bf\u3092\u898b\u308b\n\u307e\u305a\u3084\u308b\u3079\u304d\u306f\u30c7\u30fc\u30bf\u306e\u6027\u8cea\u3092\u8abf\u3079\u308b\u3053\u3068\u3067\u3059\u3002\nimport pandas as pd\nimport numpy as np\nfrom sklearn import datasets\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n\n%matplotlib inline\n\ndiabetes = datasets.load_diabetes()\n\ntrain_data = diabetes.data[:-20]\ntest_data  = diabetes.data[-20:]\ntrain_target = diabetes.target[:-20]\ntest_target = diabetes.target[-20:]\n\ndf = pd.DataFrame(diabetes.data, columns=(\"age\", \"sex\", \"bmi\", \"map\", \"tc\", \"ldl\", \"hdl\", \"tch\", \"ltg\", \"glu\"))\ndf['target'] = diabetes.target\n\n\u5165\u529b\u30c7\u30fc\u30bf\u306f\u6b63\u898f\u5316\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u304c\u308f\u304b\u308a\u307e\u3059\u3002\n\nseaborn\u3067\u3044\u304f\u3064\u304b\u306e\u30c7\u30fc\u30bf\u3092\u30d7\u30ed\u30c3\u30c8\u3057\u3066\u307f\u307e\u3059\u3002\nimport seaborn as sns\n\nsns.jointplot(x=\"age\", y=\"target\", data=df)\nsns.jointplot(x=\"sex\", y=\"target\", data=df)\nsns.jointplot(x=\"ltg\", y=\"target\", data=df)\n\n\n\n\nltg\u306b\u306f\u3042\u308b\u7a0b\u5ea6\u306e\u76f8\u95a2\u304c\u898b\u3089\u308c\u307e\u3059\u304c\u3001age\u3084sex\u306b\u306f\u3042\u307e\u308a\u76f8\u95a2\u304c\u898b\u3048\u307e\u305b\u3093\u3002\n\n\u7dda\u5f62\u30e2\u30c7\u30eb\u3067\u306e\u56de\u5e30\nfrom sklearn import linear_model\nfrom sklearn.kernel_ridge import KernelRidge\nfrom sklearn.gaussian_process import GaussianProcess\n\nregr = linear_model.LinearRegression()\nregr.fit(train_data, train_target)\n\nprint(regr.score(test_data, test_target))\n\n\u30b9\u30b3\u30a2\u306f 0.58 \u3067\u3057\u305f\u3002\n\n\u30ab\u30fc\u30cd\u30eb\u30e2\u30c7\u30eb\u3067\u306e\u56de\u5e30\n\u6563\u5e03\u56f3\u3092\u898b\u308b\u3068\u3001\u30ab\u30fc\u30cd\u30eb\u30e2\u30c7\u30eb\u3067\u306f\u30d5\u30a3\u30c3\u30c6\u30a3\u30f3\u30b0\u3057\u3065\u3089\u305d\u3046\u3067\u3059\u304c\u3001\u4e00\u5fdc\u3084\u3063\u3066\u307f\u307e\u3059\u3002\nk_ridge = KernelRidge(alpha=1.0, kernel='rbf')\nk_ridge.fit(train_data, train_target)\n\nprint(k_ridge.score(test_data, test_target))\n\n\u30b9\u30b3\u30a2\u306f 0.20 \u3067\u3057\u305f\u3002\n\u5143\u306f [scikit-learn\u3067\u7dda\u5f62\u30e2\u30c7\u30eb\u3068\u30ab\u30fc\u30cd\u30eb\u30e2\u30c7\u30eb\u306e\u56de\u5e30\u5206\u6790\u3092\u3084\u3063\u3066\u307f\u305f - \u30a4\u30e9\u30b9\u30c8\u3067\u5b66\u3076\u6a5f\u4f1a\u5b66\u7fd2](http://qiita.com/kotaroito/items/4eb29d42d7f8c534332f)\u306b\u66f8\u3044\u3066\u3044\u307e\u3057\u305f\u304c\u3001\u3084\u3084\u3053\u3057\u3044\u306e\u3067\u5225\u8a18\u4e8b\u306b\u3057\u307e\u3057\u305f\u3002\n\n\u30c7\u30fc\u30bf\u30bb\u30c3\u30c8\u306f[sklearn.datasets.load_diabetes](http://scikit-learn.org/dev/modules/generated/sklearn.datasets.load_diabetes.html) \u3092\u4f7f\u3044\u307e\u3059\u3002\n\n\u7cd6\u5c3f\u75c5\u60a3\u8005442\u540d\u306e\u30c7\u30fc\u30bf\u304c\u5165\u3063\u3066\u304a\u308a\u3001\u57fa\u790e\u9805\u76ee\uff08age, sex, body mass index, average blood pressure\uff09\u30686\u3064\u306e\u8840\u6db2\u691c\u67fb\u9805\u76ee\u3092\u5165\u529b\u3068\u3057\u30011\u5e74\u5f8c\u306e\u9032\u884c\u72b6\u6cc1\u3092\u4e88\u6e2c\u30bf\u30fc\u30b2\u30c3\u30c8\u306b\u3057\u307e\u3059\u3002\n\n\n#### \u30c7\u30fc\u30bf\u3092\u898b\u308b\n\n\u307e\u305a\u3084\u308b\u3079\u304d\u306f\u30c7\u30fc\u30bf\u306e\u6027\u8cea\u3092\u8abf\u3079\u308b\u3053\u3068\u3067\u3059\u3002\n\n\n```py3\nimport pandas as pd\nimport numpy as np\nfrom sklearn import datasets\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n\n%matplotlib inline\n\ndiabetes = datasets.load_diabetes()\n\ntrain_data = diabetes.data[:-20]\ntest_data  = diabetes.data[-20:]\ntrain_target = diabetes.target[:-20]\ntest_target = diabetes.target[-20:]\n\ndf = pd.DataFrame(diabetes.data, columns=(\"age\", \"sex\", \"bmi\", \"map\", \"tc\", \"ldl\", \"hdl\", \"tch\", \"ltg\", \"glu\"))\ndf['target'] = diabetes.target\n```\n\n\u5165\u529b\u30c7\u30fc\u30bf\u306f\u6b63\u898f\u5316\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u304c\u308f\u304b\u308a\u307e\u3059\u3002\n\n![\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2016-09-03 11.51.10.png](https://qiita-image-store.s3.amazonaws.com/0/20304/5c7c1ff5-0a15-0d00-93a0-4135cdb433e4.png)\n\n\nseaborn\u3067\u3044\u304f\u3064\u304b\u306e\u30c7\u30fc\u30bf\u3092\u30d7\u30ed\u30c3\u30c8\u3057\u3066\u307f\u307e\u3059\u3002\n\n\n```py3\nimport seaborn as sns\n\nsns.jointplot(x=\"age\", y=\"target\", data=df)\nsns.jointplot(x=\"sex\", y=\"target\", data=df)\nsns.jointplot(x=\"ltg\", y=\"target\", data=df)\n```\n\n![diabetes_age.png](https://qiita-image-store.s3.amazonaws.com/0/20304/dc86b840-f213-eb11-227b-b36acd1ffbf3.png)\n\n![diabetes_sex.png](https://qiita-image-store.s3.amazonaws.com/0/20304/ce9fa0f2-51b6-a3f5-bfa2-d8efeb0d834b.png)\n\n![diabetes_ltg.png](https://qiita-image-store.s3.amazonaws.com/0/20304/3b1399ba-c42e-3f68-ab32-69017998c768.png)\n\n\nltg\u306b\u306f\u3042\u308b\u7a0b\u5ea6\u306e\u76f8\u95a2\u304c\u898b\u3089\u308c\u307e\u3059\u304c\u3001age\u3084sex\u306b\u306f\u3042\u307e\u308a\u76f8\u95a2\u304c\u898b\u3048\u307e\u305b\u3093\u3002\n\n#### \u7dda\u5f62\u30e2\u30c7\u30eb\u3067\u306e\u56de\u5e30\n\n```py3\nfrom sklearn import linear_model\nfrom sklearn.kernel_ridge import KernelRidge\nfrom sklearn.gaussian_process import GaussianProcess\n\nregr = linear_model.LinearRegression()\nregr.fit(train_data, train_target)\n\nprint(regr.score(test_data, test_target))\n```\n\n\u30b9\u30b3\u30a2\u306f 0.58 \u3067\u3057\u305f\u3002\n\n\n#### \u30ab\u30fc\u30cd\u30eb\u30e2\u30c7\u30eb\u3067\u306e\u56de\u5e30\n\n\u6563\u5e03\u56f3\u3092\u898b\u308b\u3068\u3001\u30ab\u30fc\u30cd\u30eb\u30e2\u30c7\u30eb\u3067\u306f\u30d5\u30a3\u30c3\u30c6\u30a3\u30f3\u30b0\u3057\u3065\u3089\u305d\u3046\u3067\u3059\u304c\u3001\u4e00\u5fdc\u3084\u3063\u3066\u307f\u307e\u3059\u3002\n\n```py3\nk_ridge = KernelRidge(alpha=1.0, kernel='rbf')\nk_ridge.fit(train_data, train_target)\n\nprint(k_ridge.score(test_data, test_target))\n```\n\n\u30b9\u30b3\u30a2\u306f 0.20 \u3067\u3057\u305f\u3002\n\n\n", "tags": ["MachineLearning", "scikit-learn"]}