{"tags": ["Ansible", "CentOS6"], "context": " More than 1 year has passed since last update.\n\n\u306f\u3058\u3081\u306b\nAnsible\u3067\u8907\u6570\u306e\u30b5\u30fc\u30d0\u3092\u64cd\u4f5c\u3059\u308b\u65b9\u6cd5\u3092\u8a18\u8ff0\u3057\u307e\u3059\u3002\n\n\u74b0\u5883\n\nCentOS 6.5\nAnsible 1.7\n\n\nAnsible\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\nepel\u30ea\u30dd\u30b8\u30c8\u30ea\u306e\u8ffd\u52a0\n\n$ curl -O http://ftp.riken.jp/Linux/fedora/epel/6/x86_64/epel-release-6-8.noarch.rpm\n$ sudo yum localinstall epel-release-6-8.noarch.rpm\nLoaded plugins: fastestmirror\nLoading mirror speeds from cached hostfile\n * base: www.ftp.ne.jp\n * epel: ftp.tsukuba.wide.ad.jp\n * extras: www.ftp.ne.jp\n * updates: ftp.tsukuba.wide.ad.jp\nrepo id                 repo name                                                       status\nbase                    CentOS-6 - Base                                                  6,367\nepel                    Extra Packages for Enterprise Linux 6 - x86_64                  11,105\nextras                  CentOS-6 - Extras                                                   15\nupdates                 CentOS-6 - Updates                                               1,597\nrepolist: 19,084\n\n$ rpm --import http://ftp.riken.jp/Linux/fedora/epel/RPM-GPG-KEY-EPEL-6\n\n\nAnsible\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n$ sudo yum install ansible\n$ ansible --version\nansible 1.7\n\n\nAnsible\u3067\u306e\u64cd\u4f5c\n\n\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\n\n~/ansible_hosts\n[localhost]\n127.0.0.1\n\n[servers]\nweb001\nweb002\ndb001\n\n[web]\nweb001\nweb002\n\n[db]\ndb001\n\n\n\n\u5168\u30b5\u30fc\u30d0\u3067hostname\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3057\u307e\u3059\u3002\n\n$ ansible -i ansible_hosts all -a \"hostname\"\nweb001 | success | rc=0 >>\nweb001\n\nweb002 | success | rc=0 >>\nweb002\n\ndb001 | success | rc=0 >>\ndb001\n\n127.0.0.1 | success | rc=0 >>\nclient\n\n\u203b \u5404\u30b5\u30fc\u30d0\u3078\u306essh\u3067\u306e\u30ed\u30b0\u30a4\u30f3\u306b\u30d1\u30b9\u30ef\u30fc\u30c9\u304c\u5fc5\u8981\u306a\u5834\u5408\u306f\u3001 --ask-pass \u30aa\u30d7\u30b7\u30e7\u30f3\u3092\u6307\u5b9a\u3057\u307e\u3059\u3002\n$ ansible -i ansible_hosts all -a \"hostname\" --ask-pass\n\n\nweb\u30b5\u30fc\u30d0\u306e\u307f\u3067hostname\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3057\u307e\u3059\u3002\n\n$ ansible -i ansible_hosts web -a \"hostname\"\nweb001 | success | rc=0 >>\nweb001\n\nweb002 | success | rc=0 >>\nweb002\n\n|(\u30d1\u30a4\u30d7) \u306a\u3069\u3092\u4f7f\u7528\u3057\u305f\u3044\u5834\u5408\u306f\u3001 shell \u30e2\u30b8\u30e5\u30fc\u30eb\u3092\u5229\u7528\u3057\u307e\u3059\u3002\n\u30e2\u30b8\u30e5\u30fc\u30eb\u3092\u6307\u5b9a\u3057\u306a\u3044\u5834\u5408\u306f\u3001 command \u30e2\u30b8\u30e5\u30fc\u30eb\u304c\u5229\u7528\u3055\u308c\u307e\u3059\u3002\n$ ansible -i ansible_hosts web -m shell -a \"hostname | tr '[:lower:]' '[:upper:]'\"\nweb001 | success | rc=0 >>\nWEB001\n\nweb002 | success | rc=0 >>\nWEB002\n\n\nroot\u6a29\u9650\u3067\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3057\u305f\u3044\u5834\u5408\u306f\u3001--sudo\u30aa\u30d7\u30b7\u30e7\u30f3\u3092\u6307\u5b9a\u3057\u307e\u3059\u3002\n\n$ ansible -i ansible_hosts web -a \"whoami\" --sudo\nweb001 | success | rc=0 >>\nroot\n\nweb002 | success | rc=0 >>\nroot\n\n\u203b sudo\u30b3\u30de\u30f3\u30c9\u3067\u30d1\u30b9\u30ef\u30fc\u30c9\u304c\u5fc5\u8981\u306a\u5834\u5408\u306f\u3001--ask-sudo-pass\u30aa\u30d7\u30b7\u30e7\u30f3\u3092\u6307\u5b9a\u3057\u307e\u3059\u3002\n$ ansible -i ansible_hosts web -a \"whoami\" --sudo --ask-sudo-pass\n\n\n\u30ea\u30e2\u30fc\u30c8\u30b5\u30fc\u30d0\u3067\u5225\u30a2\u30ab\u30a6\u30f3\u30c8\u3067\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3057\u305f\u3044\u5834\u5408\u306f\u3001--sudo-user\u30aa\u30d7\u30b7\u30e7\u30f3\u3092\u6307\u5b9a\u3057\u307e\u3059\u3002\n\n$ ansible -i ansible_hosts web -a \"whoami\" --sudo --sudo-user admin\nweb001 | success | rc=0 >>\nadmin\n\nweb002 | success | rc=0 >>\nadmin\n\n\n\u53c2\u8003\n\nAnsible is Simple IT Automation\nAnsible Documentation\nInventory\nIntroduction To Ad-Hoc Commands\nansible/ansible\n\n\n## \u306f\u3058\u3081\u306b\n\nAnsible\u3067\u8907\u6570\u306e\u30b5\u30fc\u30d0\u3092\u64cd\u4f5c\u3059\u308b\u65b9\u6cd5\u3092\u8a18\u8ff0\u3057\u307e\u3059\u3002\n\n## \u74b0\u5883\n\n* CentOS 6.5\n* Ansible 1.7\n\n## Ansible\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n* epel\u30ea\u30dd\u30b8\u30c8\u30ea\u306e\u8ffd\u52a0\n\n```shell\n$ curl -O http://ftp.riken.jp/Linux/fedora/epel/6/x86_64/epel-release-6-8.noarch.rpm\n$ sudo yum localinstall epel-release-6-8.noarch.rpm\nLoaded plugins: fastestmirror\nLoading mirror speeds from cached hostfile\n * base: www.ftp.ne.jp\n * epel: ftp.tsukuba.wide.ad.jp\n * extras: www.ftp.ne.jp\n * updates: ftp.tsukuba.wide.ad.jp\nrepo id                 repo name                                                       status\nbase                    CentOS-6 - Base                                                  6,367\nepel                    Extra Packages for Enterprise Linux 6 - x86_64                  11,105\nextras                  CentOS-6 - Extras                                                   15\nupdates                 CentOS-6 - Updates                                               1,597\nrepolist: 19,084\n\n$ rpm --import http://ftp.riken.jp/Linux/fedora/epel/RPM-GPG-KEY-EPEL-6\n```\n\n* Ansible\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n```shell\n$ sudo yum install ansible\n$ ansible --version\nansible 1.7\n```\n\n## Ansible\u3067\u306e\u64cd\u4f5c\n\n* \u30a4\u30f3\u30d9\u30f3\u30c8\u30ea\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\n```ini:~/ansible_hosts\n[localhost]\n127.0.0.1\n\n[servers]\nweb001\nweb002\ndb001\n\n[web]\nweb001\nweb002\n\n[db]\ndb001\n```\n\n* \u5168\u30b5\u30fc\u30d0\u3067hostname\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3057\u307e\u3059\u3002\n\n```shell\n$ ansible -i ansible_hosts all -a \"hostname\"\nweb001 | success | rc=0 >>\nweb001\n\nweb002 | success | rc=0 >>\nweb002\n\ndb001 | success | rc=0 >>\ndb001\n\n127.0.0.1 | success | rc=0 >>\nclient\n```\n\n\u203b \u5404\u30b5\u30fc\u30d0\u3078\u306essh\u3067\u306e\u30ed\u30b0\u30a4\u30f3\u306b\u30d1\u30b9\u30ef\u30fc\u30c9\u304c\u5fc5\u8981\u306a\u5834\u5408\u306f\u3001 ``--ask-pass`` \u30aa\u30d7\u30b7\u30e7\u30f3\u3092\u6307\u5b9a\u3057\u307e\u3059\u3002\n\n```shell\n$ ansible -i ansible_hosts all -a \"hostname\" --ask-pass\n```\n\n* web\u30b5\u30fc\u30d0\u306e\u307f\u3067hostname\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3057\u307e\u3059\u3002\n\n```shell\n$ ansible -i ansible_hosts web -a \"hostname\"\nweb001 | success | rc=0 >>\nweb001\n\nweb002 | success | rc=0 >>\nweb002\n```\n\n__|(\u30d1\u30a4\u30d7)__ \u306a\u3069\u3092\u4f7f\u7528\u3057\u305f\u3044\u5834\u5408\u306f\u3001 __shell__ \u30e2\u30b8\u30e5\u30fc\u30eb\u3092\u5229\u7528\u3057\u307e\u3059\u3002\n\u30e2\u30b8\u30e5\u30fc\u30eb\u3092\u6307\u5b9a\u3057\u306a\u3044\u5834\u5408\u306f\u3001 __command__ \u30e2\u30b8\u30e5\u30fc\u30eb\u304c\u5229\u7528\u3055\u308c\u307e\u3059\u3002\n\n```shell\n$ ansible -i ansible_hosts web -m shell -a \"hostname | tr '[:lower:]' '[:upper:]'\"\nweb001 | success | rc=0 >>\nWEB001\n\nweb002 | success | rc=0 >>\nWEB002\n```\n\n* root\u6a29\u9650\u3067\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3057\u305f\u3044\u5834\u5408\u306f\u3001``--sudo``\u30aa\u30d7\u30b7\u30e7\u30f3\u3092\u6307\u5b9a\u3057\u307e\u3059\u3002\n\n```shell\n$ ansible -i ansible_hosts web -a \"whoami\" --sudo\nweb001 | success | rc=0 >>\nroot\n\nweb002 | success | rc=0 >>\nroot\n```\n\n\u203b sudo\u30b3\u30de\u30f3\u30c9\u3067\u30d1\u30b9\u30ef\u30fc\u30c9\u304c\u5fc5\u8981\u306a\u5834\u5408\u306f\u3001``--ask-sudo-pass``\u30aa\u30d7\u30b7\u30e7\u30f3\u3092\u6307\u5b9a\u3057\u307e\u3059\u3002\n\n```shell\n$ ansible -i ansible_hosts web -a \"whoami\" --sudo --ask-sudo-pass\n```\n\n* \u30ea\u30e2\u30fc\u30c8\u30b5\u30fc\u30d0\u3067\u5225\u30a2\u30ab\u30a6\u30f3\u30c8\u3067\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3057\u305f\u3044\u5834\u5408\u306f\u3001``--sudo-user``\u30aa\u30d7\u30b7\u30e7\u30f3\u3092\u6307\u5b9a\u3057\u307e\u3059\u3002\n\n```shell\n$ ansible -i ansible_hosts web -a \"whoami\" --sudo --sudo-user admin\nweb001 | success | rc=0 >>\nadmin\n\nweb002 | success | rc=0 >>\nadmin\n```\n\n## \u53c2\u8003\n* [Ansible is Simple IT Automation](http://www.ansible.com/home)\n* [Ansible Documentation](http://docs.ansible.com/)\n* [Inventory](http://docs.ansible.com/intro_inventory.html)\n* [Introduction To Ad-Hoc Commands](http://docs.ansible.com/intro_adhoc.html)\n* [ansible/ansible](https://github.com/ansible/ansible)\n"}