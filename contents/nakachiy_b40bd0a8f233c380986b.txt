{"tags": ["bioinformatics", "R", "Bioconductor"], "context": "\n\nGO enrichment analysis\nR/Bioconductor\u306e GOstats package\u3092\u3082\u3061\u3044\u3066Gene Ontology (GO) enrichment analysis\u3092\u304a\u3053\u306a\u3046\u3002\n-1*log10(p-value)\u306e\u68d2\u30b0\u30e9\u30d5\u3084\u3001\u5404\u30a2\u30ce\u30c6\u30fc\u30b7\u30e7\u30f3\u306b\u8a72\u5f53\u3057\u305f\u907a\u4f1d\u5b50\u306e\u30ea\u30b9\u30c8\u3082\u4e00\u7dd2\u306b\u53d6\u5f97\u3059\u308b\u3002\n\n\u6e96\u5099\n\u4ee5\u4e0b\u306e2\u7a2e\u985e\u306e\u907a\u4f1d\u5b50\u30ea\u30b9\u30c8\u3092Entrez Gene\u306eID\u756a\u53f7\uff08=NCBI Gene, LocusLink\uff09\u3067\u7528\u610f\u3059\u308b\u3002\n\nEntrezGeneID_interest.txt : \u81ea\u5206\u306e\u6ce8\u76ee\u3059\u308b\u907a\u4f1d\u5b50\u30bb\u30c3\u30c8\nEntrezGeneID_background.txt : \u305d\u306e\u907a\u4f1d\u5b50\u30bb\u30c3\u30c8\u3092\u307f\u3064\u3051\u3066\u304d\u305f\u3068\u304d\u306e\u304a\u304a\u3082\u3068\u306e\u907a\u4f1d\u5b50\u5168\u4f53\u306e\u30ea\u30b9\u30c8\n\nGene Symbol\u306a\u3069\u304b\u3089BioMart\u306a\u3069\u3067Entrez Gene ID\u306b\u5909\u63db\u3059\u308b\u3068\u697d\u304b\u3082\u3002\n\nEntrez Gene\u306e\u30ea\u30b9\u30c8\u8aad\u307f\u8fbc\u307f\nBGFILE <- \"EntrezGeneID_background.txt\"\nINFILE <- \"EntrezGeneID_interest.txt\"\n\ngeneIds <- as.character(read.table(INFILE,header=FALSE)[,1])\nunivIds <- as.character(read.table(BGFILE,header=FALSE)[,1])\n\n\n\u95be\u5024\u306a\u3069\u306e\u8a2d\u5b9a\nANNOTATION <- \"org.Mm.eg.db\"\nONTOLOGY <- \"BP\"\nPVALUE<-0.01\nTOP <- 30\nOUTNAME <- \"myinterest\"\n\nANNOTATION\u306f\u30de\u30a6\u30b9\u306a\u3089\"org.Mm.eg.db\"\u3060\u3057\u30d2\u30c8\u306a\u3089\"org.Hs.eg.db\"\nONTOLOGY\u306f\"BP\",\"MF\",\"CC\"\n\uff08\u305d\u308c\u305e\u308cbiological process, molecular function, cellular component\uff09\n\n\u30e9\u30a4\u30d6\u30e9\u30ea\u306e\u8aad\u307f\u8fbc\u307f\nlibrary(\"GOstats\")\nlibrary(\"GO.db\")\nlibrary(\"annotate\")\nlibrary(\"org.Mm.eg.db\")\n\n\n\u95a2\u6570\u3092\u4f5c\u6210\nGOHYPERG <- function(geneIds,univIds,ANNOTATION,ONTOLOGY,PVALUE,TOP,OUTNAME) {\n    param <- new(\n\u3000     \"GOHyperGParams\",\n\u3000     geneIds=geneIds,\n\u3000     universeGeneIds=univIds,\n\u3000     annotation= ANNOTATION,\n\u3000     ontology=ONTOLOGY\n\u3000 )\n\u3000 GOHypG <- hyperGTest(param)\n\u3000 DETECTGO <- sigCategories(\n\u3000     GOHypG,\n\u3000     pvalue <- PVALUE\n\u3000 )\n\u3000 if (length(DETECTGO)==0) {\n\u3000     RESULT_GOHYP <- data.frame(\n\u3000         GOid=\"\",\n\u3000         pvalue=\"\",\n\u3000         oddratio=\"\",\n\u3000         expected=\"\",\n\u3000         obserbed=\"\",\n\u3000         background=\"\",\n\u3000         numberMappedGenes=paste(geneMappedCount(GOHypG),length(geneIds),sep=\"/\"),\n\u3000         numberMappedBkgGenes=paste(universeMappedCount(GOHypG),length(univIds),sep=\"/\"),\n\u3000         GOterm=\"-\",\n\u3000         observedGenes=\"-\"\n\u3000     )\n\u3000 } else {\n\u3000     RESULT_GOHYP <- data.frame(\n\u3000         GOid=DETECTGO,\n\u3000         pvalue=pvalues(GOHypG)[DETECTGO],\n\u3000         oddratio=oddsRatios(GOHypG)[DETECTGO],\n\u3000         expected=expectedCounts(GOHypG)[DETECTGO],\n\u3000         obserbed=geneCounts(GOHypG)[DETECTGO],\n\u3000         background=universeCounts(GOHypG)[DETECTGO],\n\u3000         numberMappedGenes=paste(geneMappedCount(GOHypG),length(geneIds),sep=\"/\"),\n\u3000         numberMappedBkgGenes=paste(universeMappedCount(GOHypG),length(univIds),sep=\"/\"),\n\u3000         GOterm=sapply(\n\u3000             DETECTGO,\n\u3000             function(goIDs){\n\u3000                 sapply(\n\u3000                     goIDs,\n\u3000                     function(goID){Term(get(goID,GOTERM))}\n\u3000                 )\n\u3000             }\n\u3000         ),\n\u3000         observedGenes=sapply(\n\u3000             DETECTGO,\n\u3000             function(X){\n\u3000                 paste(\n\u3000                     sapply(\n\u3000                         geneIdsByCategory(GOHypG,catids = NULL)[[X]],\n\u3000                         function(XXX){paste(get(XXX,org.Mm.egSYMBOL),\"(\",XXX,\")\",sep=\"\")}\n\u3000                     ),\n\u3000                     collapse=\",\"\n\u3000                 )\n\u3000             }\n\u3000         )\n\u3000     )\n\u3000     \n    \u3000 BARHEIGHT <- -1 * log(RESULT_GOHYP[1:TOP,2],10)[TOP:1]\n\u3000     BARNAME <- RESULT_GOHYP$GOterm[TOP:1]\n\u3000 \u3000 SAVEPDFNAME <- paste(\"RESULT_GOHYP_\",ONTOLOGY,\"_\",OUTNAME,\".pdf\",sep=\"\")\n\u3000 \u3000 pdf(SAVEPDFNAME)\n\u3000 \u3000 par(oma=c(2,2,2,2),mar=c(6,16,1,1))\n\u3000 \u3000 barplot(\n\u3000         BARHEIGHT,\n\u3000         width=1,\n\u3000         space=NULL,\n\u3000         horiz=TRUE,\n\u3000         las=1,\n\u3000         main=paste(strsplit(SAVEFILENAME,\".txt\")[[1]][1]),\n\u3000         cex.main=.7,\n\u3000         sub=paste(\"(TOP\",TOP,\" GOs)\",sep=\"\"),\n\u3000         cex.sub=.7,\n\u3000         names.arg=BARNAME,\n\u3000         cex.names=.6,\n\u3000         xlab=\"-1 * log10(p-value)\",\n\u3000         cex.axis = 1\n\u3000     )\n\u3000     dev.off()\n\u3000 }\n\u3000         \n\u3000 SAVEFILENAME <- paste(\"RESULT_GOHYP_\",ONTOLOGY,\"_\",OUTNAME,\".txt\",sep=\"\")\n\u3000 write.table(RESULT_GOHYP,SAVEFILENAME,sep=\"\\t\",eol=\"\\n\",quote=FALSE,row.names=FALSE)\n\u3000 \n\u3000 return(OUTNAME)\n\u3000 \n} ## end of func. GOHYPERG\n\n\n\u5b9f\u884c\nGOHYPERG(geneIds,univIds,ANNOTATION,ONTOLOGY,PVALUE,TOP,OUTNAME)\n\n\"BP\",\"MF\",\"CC\"\u5168\u90e8\u3084\u308a\u305f\u3044\u306a\u3089\nfor (ONTOLOGY in c(\"BP\",\"MF\",\"CC\")) {\n    GOHYPERG(geneIds,univIds,ANNOTATION,ONTOLOGY,PVALUE,TOP,OUTNAME)\n}\n\n\nKEGG\u3067enrichment analysis\nGO\u306e\u304b\u308f\u308a\u306bKEGG\u3067\u3082\u3084\u308c\u308b\u3002\"BP\",\"MF\",\"CC\"\u306e\u304b\u308f\u308a\u306b\"over\",\"under\"\u306b\u306a\u308b\n\n\u30e9\u30a4\u30d6\u30e9\u30ea\u8aad\u307f\u8fbc\u307f\nlibrary(\"KEGG.db\")\n\n\n\u95a2\u6570\u3092\u4f5c\u6210\nKEGGHYPERG <- function(geneIds,univIds,ANNOTATION,OVERUNDER,PVALUE,TOP,OUTNAME) {\n    keggparam <- new(\n        \"KEGGHyperGParams\",\n        geneIds=geneIds,\n        universeGeneIds=univIds,\n        annotation= ANNOTATION,\n        pvalueCutoff=PVALUE,\n        testDirection=OVERUNDER\n    )\n    KEGGHypG <- hyperGTest(keggparam)\n    DETECTKEGG <- sigCategories(KEGGHypG,pvalue<-PVALUE)\n    if (length(DETECTKEGG)==0) {\n        RESULT_KEGGHYP <- data.frame(\n            KEGGid=\"\",\n            pvalue=\"\",\n            oddratio=\"\",\n            expected=\"\",\n            obserbed=\"\",\n            background=\"\",\n            numberMappedGenes=paste(geneMappedCount(KEGGHypG),length(geneIds),sep=\"/\"),\n            numberMappedBkgGenes=paste(universeMappedCount(KEGGHypG),length(univIds),sep=\"/\"),\n            KEGGterm=\"-\",\n            observedGenes=\"-\"\n        )\n    } else {\n        RESULT_KEGGHYP <- data.frame(\n            KEGGid=DETECTKEGG,\n            pvalue=pvalues(KEGGHypG)[DETECTKEGG],\n            oddratio=oddsRatios(KEGGHypG)[DETECTKEGG],\n            expected=expectedCounts(KEGGHypG)[DETECTKEGG],\n            obserbed=geneCounts(KEGGHypG)[DETECTKEGG],\n            background=universeCounts(KEGGHypG)[DETECTKEGG],\n            numberMappedGenes=paste(geneMappedCount(KEGGHypG),length(geneIds),sep=\"/\"),\n            numberMappedBkgGenes=paste(universeMappedCount(KEGGHypG),length(univIds),sep=\"/\"),\n            KEGGterm=sapply(DETECTKEGG,function(keggIDs){sapply(keggIDs,function(keggID){get(keggID,KEGGPATHID2NAME)})}),\n            observedGenes=sapply(\n                DETECTKEGG,\n                function(X){paste(sapply(\n                    geneIdsByCategory(KEGGHypG, catids = NULL)[[X]],\n                    function(XXX){paste(get(XXX,org.Mm.egSYMBOL),\"(\",XXX,\")\",sep=\"\")}),collapse=\",\")}\n            )\n        )\n        SAVEFILENAME <- paste(\"RESULT_KEGGHYP_\",OVERUNDER,OUTNAME,\".txt\",sep=\"\")\n        write.table(RESULT_KEGGHYP,SAVEFILENAME,sep=\"\\t\",eol=\"\\n\",quote=FALSE,row.names=FALSE)\n        BARHEIGHT <- -1 * log(RESULT_KEGGHYP[1:TOP,2],10)[TOP:1]\n        BARNAME <- RESULT_KEGGHYP$KEGGterm[TOP:1]\n        SAVEPDFNAME <- paste(\"RESULT_KEGGHYP_\",OVERUNDER,OUTNAME,\".pdf\",sep=\"\")\n        pdf(SAVEPDFNAME)\n        par(oma=c(2,2,2,2),mar=c(6,16,1,1))\n        barplot(\n            BARHEIGHT,\n            width=1,\n            space=NULL,\n            horiz=TRUE,\n            las=1,\n            main=paste(strsplit(SAVEFILENAME,\".txt\")[[1]][1]),\n            cex.main=.7,\n            sub=paste(\"(TOP\",TOP,\" KEGGs)\",sep=\"\"),\n            cex.sub=.7,\n            names.arg=BARNAME,\n            cex.names=.6,\n            xlab=\"-1 * log10(p-value)\",\n            cex.axis = 1\n        )\n        dev.off()\n    }\n    return(OUTNAME)\n} ## end of func. KEGGHYPERG\n\n\n\u5b9f\u884c\nfor (OVERUNDER in c(\"over\",\"under\")) {\n    KEGGHYPERG(geneIds,univIds,ANNOTATION,OVERUNDER,PVALUE,TOP,OUTNAME)\n}\n\n\n#GO enrichment analysis\n\nR/Bioconductor\u306e *GOstats* package\u3092\u3082\u3061\u3044\u3066Gene Ontology (GO) enrichment analysis\u3092\u304a\u3053\u306a\u3046\u3002\n-1*log10(p-value)\u306e\u68d2\u30b0\u30e9\u30d5\u3084\u3001\u5404\u30a2\u30ce\u30c6\u30fc\u30b7\u30e7\u30f3\u306b\u8a72\u5f53\u3057\u305f\u907a\u4f1d\u5b50\u306e\u30ea\u30b9\u30c8\u3082\u4e00\u7dd2\u306b\u53d6\u5f97\u3059\u308b\u3002\n\n##\u6e96\u5099\n\n\u4ee5\u4e0b\u306e2\u7a2e\u985e\u306e\u907a\u4f1d\u5b50\u30ea\u30b9\u30c8\u3092Entrez Gene\u306eID\u756a\u53f7\uff08=NCBI Gene, LocusLink\uff09\u3067\u7528\u610f\u3059\u308b\u3002\n\n* EntrezGeneID_interest.txt : \u81ea\u5206\u306e\u6ce8\u76ee\u3059\u308b\u907a\u4f1d\u5b50\u30bb\u30c3\u30c8\n* EntrezGeneID_background.txt : \u305d\u306e\u907a\u4f1d\u5b50\u30bb\u30c3\u30c8\u3092\u307f\u3064\u3051\u3066\u304d\u305f\u3068\u304d\u306e\u304a\u304a\u3082\u3068\u306e\u907a\u4f1d\u5b50\u5168\u4f53\u306e\u30ea\u30b9\u30c8\n\nGene Symbol\u306a\u3069\u304b\u3089BioMart\u306a\u3069\u3067Entrez Gene ID\u306b\u5909\u63db\u3059\u308b\u3068\u697d\u304b\u3082\u3002\n\n\n\n##Entrez Gene\u306e\u30ea\u30b9\u30c8\u8aad\u307f\u8fbc\u307f\n\n```\nBGFILE <- \"EntrezGeneID_background.txt\"\nINFILE <- \"EntrezGeneID_interest.txt\"\n\ngeneIds <- as.character(read.table(INFILE,header=FALSE)[,1])\nunivIds <- as.character(read.table(BGFILE,header=FALSE)[,1])\n```\n\n##\u95be\u5024\u306a\u3069\u306e\u8a2d\u5b9a\n\n```\nANNOTATION <- \"org.Mm.eg.db\"\nONTOLOGY <- \"BP\"\nPVALUE<-0.01\nTOP <- 30\nOUTNAME <- \"myinterest\"\n```\n\nANNOTATION\u306f\u30de\u30a6\u30b9\u306a\u3089`\"org.Mm.eg.db\"`\u3060\u3057\u30d2\u30c8\u306a\u3089`\"org.Hs.eg.db\"`\nONTOLOGY\u306f`\"BP\"`,`\"MF\"`,`\"CC\"`\n\uff08\u305d\u308c\u305e\u308cbiological process, molecular function, cellular component\uff09\n\n##\u30e9\u30a4\u30d6\u30e9\u30ea\u306e\u8aad\u307f\u8fbc\u307f\n\n```\nlibrary(\"GOstats\")\nlibrary(\"GO.db\")\nlibrary(\"annotate\")\nlibrary(\"org.Mm.eg.db\")\n```\n\n##\u95a2\u6570\u3092\u4f5c\u6210\n\n```GOHYPERG()\nGOHYPERG <- function(geneIds,univIds,ANNOTATION,ONTOLOGY,PVALUE,TOP,OUTNAME) {\n\tparam <- new(\n\u3000\t\t\"GOHyperGParams\",\n\u3000\t\tgeneIds=geneIds,\n\u3000\t\tuniverseGeneIds=univIds,\n\u3000\t\tannotation= ANNOTATION,\n\u3000\t\tontology=ONTOLOGY\n\u3000\t)\n\u3000\tGOHypG <- hyperGTest(param)\n\u3000\tDETECTGO <- sigCategories(\n\u3000\t\tGOHypG,\n\u3000\t\tpvalue <- PVALUE\n\u3000\t)\n\u3000\tif (length(DETECTGO)==0) {\n\u3000\t\tRESULT_GOHYP <- data.frame(\n\u3000\t\t\tGOid=\"\",\n\u3000\t\t\tpvalue=\"\",\n\u3000\t\t\toddratio=\"\",\n\u3000\t\t\texpected=\"\",\n\u3000\t\t\tobserbed=\"\",\n\u3000\t\t\tbackground=\"\",\n\u3000\t\t\tnumberMappedGenes=paste(geneMappedCount(GOHypG),length(geneIds),sep=\"/\"),\n\u3000\t\t\tnumberMappedBkgGenes=paste(universeMappedCount(GOHypG),length(univIds),sep=\"/\"),\n\u3000\t\t\tGOterm=\"-\",\n\u3000\t\t\tobservedGenes=\"-\"\n\u3000\t\t)\n\u3000\t} else {\n\u3000\t\tRESULT_GOHYP <- data.frame(\n\u3000\t\t\tGOid=DETECTGO,\n\u3000\t\t\tpvalue=pvalues(GOHypG)[DETECTGO],\n\u3000\t\t\toddratio=oddsRatios(GOHypG)[DETECTGO],\n\u3000\t\t\texpected=expectedCounts(GOHypG)[DETECTGO],\n\u3000\t\t\tobserbed=geneCounts(GOHypG)[DETECTGO],\n\u3000\t\t\tbackground=universeCounts(GOHypG)[DETECTGO],\n\u3000\t\t\tnumberMappedGenes=paste(geneMappedCount(GOHypG),length(geneIds),sep=\"/\"),\n\u3000\t\t\tnumberMappedBkgGenes=paste(universeMappedCount(GOHypG),length(univIds),sep=\"/\"),\n\u3000\t\t\tGOterm=sapply(\n\u3000\t\t\t\tDETECTGO,\n\u3000\t\t\t\tfunction(goIDs){\n\u3000\t\t\t\t\tsapply(\n\u3000\t\t\t\t\t\tgoIDs,\n\u3000\t\t\t\t\t\tfunction(goID){Term(get(goID,GOTERM))}\n\u3000\t\t\t\t\t)\n\u3000\t\t\t\t}\n\u3000\t\t\t),\n\u3000\t\t\tobservedGenes=sapply(\n\u3000\t\t\t\tDETECTGO,\n\u3000\t\t\t\tfunction(X){\n\u3000\t\t\t\t\tpaste(\n\u3000\t\t\t\t\t\tsapply(\n\u3000\t\t\t\t\t\t\tgeneIdsByCategory(GOHypG,catids = NULL)[[X]],\n\u3000\t\t\t\t\t\t\tfunction(XXX){paste(get(XXX,org.Mm.egSYMBOL),\"(\",XXX,\")\",sep=\"\")}\n\u3000\t\t\t\t\t\t),\n\u3000\t\t\t\t\t\tcollapse=\",\"\n\u3000\t\t\t\t\t)\n\u3000\t\t\t\t}\n\u3000\t\t\t)\n\u3000\t\t)\n\u3000\t\t\n\t\u3000\tBARHEIGHT <- -1 * log(RESULT_GOHYP[1:TOP,2],10)[TOP:1]\n\u3000\t\tBARNAME <- RESULT_GOHYP$GOterm[TOP:1]\n\u3000\t\u3000\tSAVEPDFNAME <- paste(\"RESULT_GOHYP_\",ONTOLOGY,\"_\",OUTNAME,\".pdf\",sep=\"\")\n\u3000\t\u3000\tpdf(SAVEPDFNAME)\n\u3000\t\u3000\tpar(oma=c(2,2,2,2),mar=c(6,16,1,1))\n\u3000\t\u3000\tbarplot(\n\u3000\t\t\tBARHEIGHT,\n\u3000\t\t\twidth=1,\n\u3000\t\t\tspace=NULL,\n\u3000\t\t\thoriz=TRUE,\n\u3000\t\t\tlas=1,\n\u3000\t\t\tmain=paste(strsplit(SAVEFILENAME,\".txt\")[[1]][1]),\n\u3000\t\t\tcex.main=.7,\n\u3000\t\t\tsub=paste(\"(TOP\",TOP,\" GOs)\",sep=\"\"),\n\u3000\t\t\tcex.sub=.7,\n\u3000\t\t\tnames.arg=BARNAME,\n\u3000\t\t\tcex.names=.6,\n\u3000\t\t\txlab=\"-1 * log10(p-value)\",\n\u3000\t\t\tcex.axis = 1\n\u3000\t\t)\n\u3000\t\tdev.off()\n\u3000\t}\n\u3000\t\t\t\n\u3000\tSAVEFILENAME <- paste(\"RESULT_GOHYP_\",ONTOLOGY,\"_\",OUTNAME,\".txt\",sep=\"\")\n\u3000\twrite.table(RESULT_GOHYP,SAVEFILENAME,sep=\"\\t\",eol=\"\\n\",quote=FALSE,row.names=FALSE)\n\u3000\t\n\u3000\treturn(OUTNAME)\n\u3000\t\n} ## end of func. GOHYPERG\n```\n\n##\u5b9f\u884c\n\n```\nGOHYPERG(geneIds,univIds,ANNOTATION,ONTOLOGY,PVALUE,TOP,OUTNAME)\n```\n\n`\"BP\"`,`\"MF\"`,`\"CC\"`\u5168\u90e8\u3084\u308a\u305f\u3044\u306a\u3089\n\n```\nfor (ONTOLOGY in c(\"BP\",\"MF\",\"CC\")) {\n\tGOHYPERG(geneIds,univIds,ANNOTATION,ONTOLOGY,PVALUE,TOP,OUTNAME)\n}\n```\n\n#KEGG\u3067enrichment analysis\n\nGO\u306e\u304b\u308f\u308a\u306bKEGG\u3067\u3082\u3084\u308c\u308b\u3002`\"BP\"`,`\"MF\"`,`\"CC\"`\u306e\u304b\u308f\u308a\u306b`\"over\"`,`\"under\"`\u306b\u306a\u308b\n\n##\u30e9\u30a4\u30d6\u30e9\u30ea\u8aad\u307f\u8fbc\u307f\n\n```\nlibrary(\"KEGG.db\")\n```\n\n##\u95a2\u6570\u3092\u4f5c\u6210\n\n```KEGGHYPERG()\nKEGGHYPERG <- function(geneIds,univIds,ANNOTATION,OVERUNDER,PVALUE,TOP,OUTNAME) {\n\tkeggparam <- new(\n\t\t\"KEGGHyperGParams\",\n\t\tgeneIds=geneIds,\n\t\tuniverseGeneIds=univIds,\n\t\tannotation= ANNOTATION,\n\t\tpvalueCutoff=PVALUE,\n\t\ttestDirection=OVERUNDER\n\t)\n\tKEGGHypG <- hyperGTest(keggparam)\n\tDETECTKEGG <- sigCategories(KEGGHypG,pvalue<-PVALUE)\n\tif (length(DETECTKEGG)==0) {\n\t\tRESULT_KEGGHYP <- data.frame(\n\t\t\tKEGGid=\"\",\n\t\t\tpvalue=\"\",\n\t\t\toddratio=\"\",\n\t\t\texpected=\"\",\n\t\t\tobserbed=\"\",\n\t\t\tbackground=\"\",\n\t\t\tnumberMappedGenes=paste(geneMappedCount(KEGGHypG),length(geneIds),sep=\"/\"),\n\t\t\tnumberMappedBkgGenes=paste(universeMappedCount(KEGGHypG),length(univIds),sep=\"/\"),\n\t\t\tKEGGterm=\"-\",\n\t\t\tobservedGenes=\"-\"\n\t\t)\n\t} else {\n\t\tRESULT_KEGGHYP <- data.frame(\n\t\t\tKEGGid=DETECTKEGG,\n\t\t\tpvalue=pvalues(KEGGHypG)[DETECTKEGG],\n\t\t\toddratio=oddsRatios(KEGGHypG)[DETECTKEGG],\n\t\t\texpected=expectedCounts(KEGGHypG)[DETECTKEGG],\n\t\t\tobserbed=geneCounts(KEGGHypG)[DETECTKEGG],\n\t\t\tbackground=universeCounts(KEGGHypG)[DETECTKEGG],\n\t\t\tnumberMappedGenes=paste(geneMappedCount(KEGGHypG),length(geneIds),sep=\"/\"),\n\t\t\tnumberMappedBkgGenes=paste(universeMappedCount(KEGGHypG),length(univIds),sep=\"/\"),\n\t\t\tKEGGterm=sapply(DETECTKEGG,function(keggIDs){sapply(keggIDs,function(keggID){get(keggID,KEGGPATHID2NAME)})}),\n\t\t\tobservedGenes=sapply(\n\t\t\t\tDETECTKEGG,\n\t\t\t\tfunction(X){paste(sapply(\n\t\t\t\t\tgeneIdsByCategory(KEGGHypG, catids = NULL)[[X]],\n\t\t\t\t\tfunction(XXX){paste(get(XXX,org.Mm.egSYMBOL),\"(\",XXX,\")\",sep=\"\")}),collapse=\",\")}\n\t\t\t)\n\t\t)\n\t\tSAVEFILENAME <- paste(\"RESULT_KEGGHYP_\",OVERUNDER,OUTNAME,\".txt\",sep=\"\")\n\t\twrite.table(RESULT_KEGGHYP,SAVEFILENAME,sep=\"\\t\",eol=\"\\n\",quote=FALSE,row.names=FALSE)\n\t\tBARHEIGHT <- -1 * log(RESULT_KEGGHYP[1:TOP,2],10)[TOP:1]\n\t\tBARNAME <- RESULT_KEGGHYP$KEGGterm[TOP:1]\n\t\tSAVEPDFNAME <- paste(\"RESULT_KEGGHYP_\",OVERUNDER,OUTNAME,\".pdf\",sep=\"\")\n\t\tpdf(SAVEPDFNAME)\n\t\tpar(oma=c(2,2,2,2),mar=c(6,16,1,1))\n\t\tbarplot(\n\t\t\tBARHEIGHT,\n\t   \t\twidth=1,\n\t   \t\tspace=NULL,\n\t   \t\thoriz=TRUE,\n\t   \t\tlas=1,\n\t   \t\tmain=paste(strsplit(SAVEFILENAME,\".txt\")[[1]][1]),\n\t   \t\tcex.main=.7,\n\t   \t\tsub=paste(\"(TOP\",TOP,\" KEGGs)\",sep=\"\"),\n\t   \t\tcex.sub=.7,\n    \t\tnames.arg=BARNAME,\n    \t\tcex.names=.6,\n    \t\txlab=\"-1 * log10(p-value)\",\n    \t\tcex.axis = 1\n    \t)\n    \tdev.off()\n\t}\n\treturn(OUTNAME)\n} ## end of func. KEGGHYPERG\n```\n\n##\u5b9f\u884c\n\n```\nfor (OVERUNDER in c(\"over\",\"under\")) {\n\tKEGGHYPERG(geneIds,univIds,ANNOTATION,OVERUNDER,PVALUE,TOP,OUTNAME)\n}\n```\n\n"}