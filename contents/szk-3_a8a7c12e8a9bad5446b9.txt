{"tags": ["AppleScript", "HTML"], "context": " More than 1 year has passed since last update.\n\ndo shell script\u3068\u9055\u3063\u3066\u6587\u5b57\u6570\u5236\u9650\u304c\u306a\u3044\u306e\u3067\u4f7f\u3044\u3084\u3059\u3044\n\u6587\u5b57\u5316\u3051\u3059\u308b\u5834\u5408\u306fdataUsingEncoding:\u30e1\u30bd\u30c3\u30c9\u306e\u5f15\u6570\u3092\u5909\u66f4\n\n\nconvertHTMLToPlainText.scpt\nuse scripting additions\nuse framework \"AppKit\"\n\ntell application \"Safari\"\n    my convertHTMLToPlainText(source of current tab of window 1)\nend tell\n\non convertHTMLToPlainText(HTML)\n    --require framework: Foundation\n    set attributedString to my attributedStringOfHTMLText(HTML)\n    return attributedString's |string| as text\nend convertHTMLToPlainText\n\non attributedStringOfHTMLText(HTML as text)\n    --require framework: AppKit, Foundation\n    set HTMLString to current application's NSString's stringWithString:HTML\n    set HTMLData to HTMLString's dataUsingEncoding:(current application's NSUnicodeStringEncoding)\n    return current application's NSAttributedString's alloc()'s initWithHTML:HTMLData documentAttributes:(missing value)\nend attributedStringOfHTMLText\n\n\n\n\u66f4\u65b0\u5c65\u6b74\n\n2016-01-27: Cocoa\u306eAppKit\u30d5\u30ec\u30fc\u30e0\u30ef\u30fc\u30af\u306b\u3042\u308bNSAttributedString\u30af\u30e9\u30b9\u3092\u4f7f\u3063\u3066\u4f5c\u6210\n2016-02-01: attributedStringOfHTMLText\u30cf\u30f3\u30c9\u30e9\u4f5c\u6210\n\n\n\n* `do shell script`\u3068\u9055\u3063\u3066\u6587\u5b57\u6570\u5236\u9650\u304c\u306a\u3044\u306e\u3067\u4f7f\u3044\u3084\u3059\u3044\n* \u6587\u5b57\u5316\u3051\u3059\u308b\u5834\u5408\u306f`dataUsingEncoding:`\u30e1\u30bd\u30c3\u30c9\u306e\u5f15\u6570\u3092\u5909\u66f4\n\n\n```AppleScript:convertHTMLToPlainText.scpt\nuse scripting additions\nuse framework \"AppKit\"\n\ntell application \"Safari\"\n\tmy convertHTMLToPlainText(source of current tab of window 1)\nend tell\n\non convertHTMLToPlainText(HTML)\n\t--require framework: Foundation\n\tset attributedString to my attributedStringOfHTMLText(HTML)\n\treturn attributedString's |string| as text\nend convertHTMLToPlainText\n\non attributedStringOfHTMLText(HTML as text)\n\t--require framework: AppKit, Foundation\n\tset HTMLString to current application's NSString's stringWithString:HTML\n\tset HTMLData to HTMLString's dataUsingEncoding:(current application's NSUnicodeStringEncoding)\n\treturn current application's NSAttributedString's alloc()'s initWithHTML:HTMLData documentAttributes:(missing value)\nend attributedStringOfHTMLText\n```\n\n\n## \u66f4\u65b0\u5c65\u6b74\n\n* 2016-01-27: Cocoa\u306eAppKit\u30d5\u30ec\u30fc\u30e0\u30ef\u30fc\u30af\u306b\u3042\u308bNSAttributedString\u30af\u30e9\u30b9\u3092\u4f7f\u3063\u3066\u4f5c\u6210\n* 2016-02-01: `attributedStringOfHTMLText`\u30cf\u30f3\u30c9\u30e9\u4f5c\u6210\n\n\n\n"}