{"context": "\u306f\u307e\u3063\u305f\u306e\u3067\u30e1\u30e2\u3002\n\nDockerfile\nFROM golang:latest\n\nRUN apt-get update && apt-get install -y cron\n\n# timezone\nRUN cp /usr/share/zoneinfo/Asia/Tokyo /etc/localtime\n\n#workspase\nRUN mkdir -p /go/src/app\nWORKDIR /go/src/app\n\n# this will ideally be built by the ONBUILD below ;)\nCMD [\"go-wrapper\", \"run\"]\n\nONBUILD COPY . /go/src/app\nONBUILD RUN go-wrapper download\nONBUILD RUN go-wrapper install\n\n#localfile\u306eenv\u304b\u3089\u74b0\u5883\u5909\u6570\u3092\u53d6\u5f97\nRUN env > /env\n\n#cron setting\n#\u5206 \u6642 \u65e5 \u6708 \u66dc\u65e5 <\u5b9f\u884c\u30b3\u30de\u30f3\u30c9>\nCMD echo '*/1 * * * * cd /go/src/app; env - `cat /env` go run /go/src/app/batch.go >> /var/log/cron.log 2>&1' | crontab - && cron -f\n\ncron\u306e\u6642\u9593\u306e\u8a2d\u5b9a\u306f\u3053\u3061\u3089\u3092\u53c2\u8003\u306b\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n\u306f\u307e\u3063\u305f\u70b9\n\n1\u3064\u76ee\ncron\u306e\u51e6\u7406\u306e\u969b\u306f\u74b0\u5883\u5909\u6570\u304c\u30ea\u30bb\u30c3\u30c8\u3055\u308c\u308b\u307f\u305f\u3044\u306a\u306e\u3067\u3001env\u30b3\u30de\u30f3\u30c9\u3092\u4f7f\u3063\u3066\u74b0\u5883\u5909\u6570\u3092\u8a2d\u5b9a\u3057\u3066\u3042\u3052\u308b\u5fc5\u8981\u304c\u3042\u3063\u305f\u3002\n\n2\u3064\u76ee\nenv - `cat /env`\n\n\u306e\u30b7\u30f3\u30b0\u30eb\u30b3\u30fc\u30c6\u30fc\u30b7\u30e7\u30f3\u3092\u30c0\u30d6\u30eb\u30b3\u30fc\u30c6\u30fc\u30b7\u30e7\u30f3\u3067\u5b9f\u884c\u3057\u3066\u3044\u308b\u3068\u3046\u307e\u304f\u52d5\u4f5c\u3057\u306a\u304b\u3063\u305f\u3002\n\n\u30c7\u30d0\u30c3\u30b0\n\u301c\u301c\u3000>> /var/log/cron.log 2>&1\u3000\u301c\u301c\n\n\u3067\u6a19\u6e96log\u3068\u30a8\u30e9\u30fclog\u3092\u8a18\u61b6\u3057\u3066\u3044\u308b\u3002\n\n\u53c2\u8003\nhttp://qiita.com/ABCanG1015/items/d568982899c52615488c\n\u306f\u307e\u3063\u305f\u306e\u3067\u30e1\u30e2\u3002\n\n##Dockerfile\n\n```\nFROM golang:latest\n\nRUN apt-get update && apt-get install -y cron\n\n# timezone\nRUN cp /usr/share/zoneinfo/Asia/Tokyo /etc/localtime\n\n#workspase\nRUN mkdir -p /go/src/app\nWORKDIR /go/src/app\n\n# this will ideally be built by the ONBUILD below ;)\nCMD [\"go-wrapper\", \"run\"]\n\nONBUILD COPY . /go/src/app\nONBUILD RUN go-wrapper download\nONBUILD RUN go-wrapper install\n\n#localfile\u306eenv\u304b\u3089\u74b0\u5883\u5909\u6570\u3092\u53d6\u5f97\nRUN env > /env\n\n#cron setting\n#\u5206 \u6642 \u65e5 \u6708 \u66dc\u65e5 <\u5b9f\u884c\u30b3\u30de\u30f3\u30c9>\nCMD echo '*/1 * * * * cd /go/src/app; env - `cat /env` go run /go/src/app/batch.go >> /var/log/cron.log 2>&1' | crontab - && cron -f\n```\n\ncron\u306e\u6642\u9593\u306e\u8a2d\u5b9a\u306f[\u3053\u3061\u3089](http://qiita.com/hikouki/items/e744b3a4d356d2af12cf)\u3092\u53c2\u8003\u306b\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n##\u306f\u307e\u3063\u305f\u70b9\n###1\u3064\u76ee\ncron\u306e\u51e6\u7406\u306e\u969b\u306f\u74b0\u5883\u5909\u6570\u304c\u30ea\u30bb\u30c3\u30c8\u3055\u308c\u308b\u307f\u305f\u3044\u306a\u306e\u3067\u3001env\u30b3\u30de\u30f3\u30c9\u3092\u4f7f\u3063\u3066\u74b0\u5883\u5909\u6570\u3092\u8a2d\u5b9a\u3057\u3066\u3042\u3052\u308b\u5fc5\u8981\u304c\u3042\u3063\u305f\u3002\n###2\u3064\u76ee\n\n```\nenv - `cat /env`\n```\n\n\u306e\u30b7\u30f3\u30b0\u30eb\u30b3\u30fc\u30c6\u30fc\u30b7\u30e7\u30f3\u3092\u30c0\u30d6\u30eb\u30b3\u30fc\u30c6\u30fc\u30b7\u30e7\u30f3\u3067\u5b9f\u884c\u3057\u3066\u3044\u308b\u3068\u3046\u307e\u304f\u52d5\u4f5c\u3057\u306a\u304b\u3063\u305f\u3002\n\n##\u30c7\u30d0\u30c3\u30b0\n\n```\n\u301c\u301c\u3000>> /var/log/cron.log 2>&1\u3000\u301c\u301c\n```\n\n\u3067\u6a19\u6e96log\u3068\u30a8\u30e9\u30fclog\u3092\u8a18\u61b6\u3057\u3066\u3044\u308b\u3002\n\n\n##\u53c2\u8003\nhttp://qiita.com/ABCanG1015/items/d568982899c52615488c\n", "tags": ["docker", "golang", "cron"]}