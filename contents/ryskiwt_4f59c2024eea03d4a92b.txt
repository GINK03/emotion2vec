{"tags": ["GoogleAppsScript", "JavaScript", "launchd"], "context": "\n\n\u306f\u3058\u3081\u306b\n\n\u52d5\u6a5f\u3065\u3051\n\u3044\u3061\u3044\u3061\u51fa\u52e4\u30fb\u9000\u52e4\u6642\u523b\u3092\u8a18\u9332\u3059\u308b\u306e\u304c\u9762\u5012\u306a\u306e\u3067\u3001Shell\u30b9\u30af\u30ea\u30d7\u30c8\u3068GAS\u3092\u4f7f\u7528\u3057\u3066\u81ea\u52d5\u5316\u3057\u3066\u3057\u307e\u3044\u307e\u3059\u3002\n\n\u65b9\u6cd5\n\nGAS\u4e0a\u306bWeb API\u3092\u7528\u610f\u3057\u3001HTTP\u30ea\u30af\u30a8\u30b9\u30c8\u3092\u98db\u3070\u3059\u3068\u6642\u523b\u304c\u8a18\u9332\u3055\u308c\u308b\u53e3\u3092\u4f5c\u308a\u307e\u3059\u3002\nMac\u5074\u3067shell\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u5b9a\u671f\u5b9f\u884c\u3057\u3066\u3001\u8077\u5834\u306eWi-Fi\u306b\u63a5\u7d9a\u3057\u3066\u3044\u308c\u3070\u3001\u4e0a\u8a18API\u3092\u53e9\u304d\u306b\u884c\u304d\u307e\u3059\u3002\n\u4e00\u65e5\u306e\u7d42\u308f\u308a\u306b\u8a18\u9332\u3092\u96c6\u8a08\u3057\u3001\u51fa\u52e4\u6642\u523b\u3001\u9000\u52e4\u6642\u523b\u3001\u6ede\u5728\u6642\u9593\u3092\u8a08\u7b97\u3057\u307e\u3059\u3002\n\nMac\u3067\u306e\u5b9a\u671f\u5b9f\u884c\u306f\u3001Linux\u306b\u3088\u304f\u3042\u308bcron\u3067\u306f\u306a\u304flaunchd\u3092\u4f7f\u7528\u3059\u308b\u3088\u3046\u3067\u3059\u3002\n\n\u5b9f\u884c\u74b0\u5883\n\nMacOS Sierra 10.12.2\n\n\nGAS\u30b9\u30af\u30ea\u30d7\u30c8\n\n\u3061\u3087\u3063\u3068\u3057\u305f\u6e96\u5099\n\u30b9\u30af\u30ea\u30d7\u30c8\u306e\u30d7\u30ed\u30d1\u30c6\u30a3\u306b\u4e0b\u8a18\u306e\u30d7\u30ed\u30d1\u30c6\u30a3\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n\n\nFILENAME : \u52e4\u6020\u8a18\u9332\u3092\u3064\u3051\u308bGoogle\u30b9\u30d7\u30ec\u30c3\u30c9\u30b7\u30fc\u30c8\u306e\u540d\u524d\u3002\u4e8b\u524d\u306bGoogle\u30c9\u30e9\u30a4\u30d6\u306b\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u6210\u3057\u3066\u304a\u304f\u3002\n\nSHEET_1st : \u96c6\u8a08\u524d\u306e\u751f\u30c7\u30fc\u30bf\u3092\u8a18\u9332\u3057\u3066\u304a\u304f\u30b7\u30fc\u30c8\u540d\u3002\u300c\u30b7\u30fc\u30c81\u300d\u3067OK\n\nSHEET_2nd : \u96c6\u8a08\u5f8c\u306e\u30c7\u30fc\u30bf\u3092\u8a18\u9332\u3057\u3066\u304a\u304f\u30b7\u30fc\u30c8\u540d\u3002\u300c\u30b7\u30fc\u30c82\u300d\u3067OK\n\nMoment.js\u3092\u4f7f\u3048\u308b\u3088\u3046\u306b\u8a2d\u5b9a\u3057\u307e\u3059\u3002\u5916\u90e8\u30e9\u30a4\u30d6\u30e9\u30ea\u3068\u3057\u3066\u5c0e\u5165\u3057\u3066\u3082\u3088\u3057\u3001\u30bd\u30fc\u30b9\u4e38\u30b3\u30d4\u3067\u7a81\u3063\u8fbc\u3093\u3067\u3082\u3088\u3057\u3002\n\u53c2\u8003\uff1a\u65e5\u4ed8\uff06\u6642\u523b\u306e\u4fbf\u5229\u30e9\u30a4\u30d6\u30e9\u30ea\u300cMoment.js\u300d\u3092Google Apps Script\u3067\u4f7f\u3046\u65b9\u6cd5\n\u305d\u306e\u4ed6\n\n\nsummarize\u95a2\u6570\u306b\u6642\u9593\u30d9\u30fc\u30b9\u30c8\u30ea\u30ac\u30fc\u3092\u8a2d\u5b9a\u3002\nWeb\u30a2\u30d7\u30ea\u3068\u3057\u3066\u516c\u958b\u3057\u3066\u304a\u304f\u3002\uff08\u4e0b\u306e\u5b9a\u671f\u5b9f\u884c\u30b7\u30a7\u30eb\u306bURL\u3092\u8a18\u8f09\u3059\u308b\uff09\n\n\n\u8aac\u660e\u306a\u3069\n\n\ndoGet\u95a2\u6570 : GET\u30ea\u30af\u30a8\u30b9\u30c8\u3092\u53d7\u3051\u305f\u6642\u306e\u51e6\u7406\u3002\u53d7\u3051\u305f\u6642\u523b\u3092\u30b9\u30d7\u30ec\u30c3\u30c9\u30b7\u30fc\u30c8\u306bappend\u3057\u3066\u3044\u308b\u3060\u3051\u3067\u3059\u3002\n\nsummarize\u95a2\u6570 : \u6642\u9593\u30d9\u30fc\u30b9\u30c8\u30ea\u30ac\u30fc\u3067\u6bce\u65e51:00-2:00\u306b\u5b9f\u884c\u3057\u3066\u3042\u3052\u308b\u3068\u3001\u524d\u65e5\u306e\u6700\u521d\u301c\u6700\u5f8c\u306e\u6642\u523b\u62bd\u51fa\u3001\u51fa\u52e4\u6642\u523b\u30fb\u9000\u52e4\u6642\u523b\u30fb\u6ede\u5728\u6642\u523b\u306e\u8a08\u7b97\u3001\u8a08\u7b97\u30c7\u30fc\u30bf\u306eappend\u3092\u5b9f\u884c\u3057\u307e\u3059\u3002\n\n\nmain.js\n// -----------------------------------------------------------------------------\n// GET\u306e\u30cf\u30f3\u30c9\u30e9\n// -----------------------------------------------------------------------------\nfunction doGet() {\n  try {\n    var sp = PropertiesService.getScriptProperties();\n    var FILENAME  = sp.getProperty(\"FILENAME\");\n    var SHEET_1st = sp.getProperty(\"SHEET_1st\");\n\n    var date = new Date();\n    var ss = getSpreadsheetByName(FILENAME);\n    var sheet = ss.getSheetByName(SHEET_1st);\n    sheet.appendRow([date]);\n    return createContent({status: 'OK'});\n\n  } catch(err) {\n    return createContent({status: 'NG'});\n  }\n}\n\n\n// -----------------------------------------------------------------------------\n// \u30b9\u30d7\u30ec\u30c3\u30c9\u30b7\u30fc\u30c8\u53d6\u5f97\u30e1\u30bd\u30c3\u30c9\n// -----------------------------------------------------------------------------\nfunction getSpreadsheetByName(filename) {\n  var fileIter = DriveApp.getFilesByName(filename);\n  if (fileIter.hasNext()) {\n    var file = fileIter.next();\n    return SpreadsheetApp.open(file);\n  } else {\n    throw FileError(\"File Not Found.\")\n  }\n}\n\n// -----------------------------------------------------------------------------\n// \u8fd4\u5374\u30c7\u30fc\u30bf\u306e\u751f\u6210\n// -----------------------------------------------------------------------------\nfunction createContent(res) {\n  return ContentService.createTextOutput(JSON.stringify(res))\n                       .setMimeType(ContentService.MimeType.JSON);\n}\n\n// -----------------------------------------------------------------------------\n// \u6628\u65e5\u306e\u30c7\u30fc\u30bf\u3092\u30b5\u30de\u30e9\u30a4\u30ba\uff081:00-2:00\u306b\u5b9f\u884c\uff09\n// -----------------------------------------------------------------------------\nfunction summarize() {\n  var sp = PropertiesService.getScriptProperties();\n  var FILENAME = sp.getProperty(\"FILENAME\");\n  var SHEET_1st = sp.getProperty(\"SHEET_1st\");\n  var SHEET_2nd = sp.getProperty(\"SHEET_2nd\");\n\n  var ss = getSpreadsheetByName(FILENAME);\n  var sheet1st = ss.getSheetByName(SHEET_1st);\n  var rows = sheet1st.getDataRange().getValues();\n\n  var FORMAT = \"YYYY/MM/DD\";\n  var yesterday = moment().subtract(\"days\", 1).startOf('day');\n  rows = rows.filter(function(row) {\n    return moment(row[0]).format(FORMAT) == yesterday.format(FORMAT);\n  });\n\n  if (rows.length == 0) return;\n\n  var entrDay = moment(rows[0][0]);\n  var exitDay = moment(rows[rows.length-1][0]);\n\n  var diff = exitDay.diff(entrDay, \"hours\", true);\n\n  var sheet2nd = ss.getSheetByName(SHEET_2nd);\n  sheet2nd.appendRow([yesterday.toDate(), entrDay.toDate(), exitDay.toDate(), diff, diff-1])\n\n  sheet1st.deleteRows(1, rows.length);\n}\n\n\n\u5b9a\u671f\u5b9f\u884c\u30b7\u30a7\u30eb\n--------------------\u30fc\nairport\u30b3\u30de\u30f3\u30c9\u3067\u53d6\u5f97\u3057\u305fWi-Fi\u63a5\u7d9a\u60c5\u5831\u3092grep\u3084\u3089sed\u3084\u3089\u3092\u4f7f\u7528\u3057\u3066\u6574\u5f62\u3057\u3001\u63a5\u7d9a\u5148\u306eSSID\u540d\u3092\u62bd\u51fa\u3057\u307e\u3059\u3002\u305d\u306e\u5f8c\u3001\u8077\u5834\u306eSSID\u306b\u4e00\u81f4\u3057\u305f\u5834\u5408\u306f\u524d\u8ff0\u306eGAS\u306e\u53e3\u3092curl\u3067\u53e9\u304d\u307e\u3059\u3002\n\nattrec.sh\n#!/bin/bash\n\nSSID=your_office_ssid\nGASURL=https://script.google.com/macros/s/your_script_id/exec\n\nAIRPORT=/System/Library/PrivateFrameworks/Apple80211.framework/Versions/Current/Resources/airport\nCURRENT_SSID=`$AIRPORT -I | egrep \"^\\s+SSID:\" | sed -e 's/ *SSID: //g'`\n\nif [ $SSID = $CURRENT_SSID ]; then\n  curl $GASURL\nfi\n\n\n\nlaunchd\n\nLabel: \u767b\u9332\u3059\u308b\u540d\u524d\u3002\u4efb\u610f\u3002\nProgramArguments: \u5b9f\u884c\u30b3\u30de\u30f3\u30c9\u7b49\u3002$HOME/.attrec/attrec.sh\u306b\u30b7\u30a7\u30eb\u304c\u7f6e\u3044\u3066\u3042\u308b\u60f3\u5b9a\nStartInterval: \u5b9f\u884c\u9593\u9694\u300210\u5206\u304a\u304d\uff08600[sec]\uff09\u306e\u8a2d\u5b9a\u3002\n\n\u30ab\u30b9\u30bf\u30de\u30a4\u30ba\u306f\u3001\u4e0b\u8a18\u3042\u305f\u308a\u3092\u53c2\u8003\u306b\u3002\n\u53c2\u8003\uff1aMac\uff08OS X\uff09\u3067\u306fcron\u3058\u3083\u306a\u304f\u3066launchd\u3067\u3084\u308b - Furudate\u306e\u30d6\u30ed\u30b0\n\u53c2\u8003\uff1aMac OS X\u3067launchd\u3067cron\u306e\u3088\u3046\u306b\u5b9a\u671f\u5b9f\u884c\u3059\u308b\u30e1\u30e2 - launchd.plist\u306e\u4f5c\u6210\u3068\u304b - tweeeety\u306e\u3076\u308d\u3050\u7684\u3081\u3082\n\nattrec.plist\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<!DOCTYPE plist PUBLIC \"-//Apple//DTD PLIST 1.0//EN\" \"http://www.apple.com/DTDs/PropertyList-1.0.dtd\">\n<plist version=\"1.0\">\n<dict>\n\n  <key>Label</key>\n  <string>jp.ryskiwt.attrec</string>\n\n  <key>ProgramArguments</key>\n  <array>\n    <string>/bin/bash</string>\n    <string>-c</string>\n    <string>$HOME/.attrec/attrec.sh</string>\n  </array>\n\n  <key>StartInterval</key>\n  <integer>600</integer>\n\n</dict>\n</plist>\n\n\n\n\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\u30b7\u30a7\u30eb\u306e\u914d\u7f6e\u3068launchd\u3078\u306e\u767b\u9332\u3002\nmkdir -p $HOME/.attrec\nvi $HOME/.attrec/attrec.sh\nvi $HOME/Library/LaunchAgents/attrec.plist\nLaunchctl load $HOME/Library/LaunchAgents/attrec.plist\n\n\n\u30a2\u30f3\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\nlaunchd\u304b\u3089\u306e\u767b\u9332\u89e3\u9664\u3068\u30b7\u30a7\u30eb\u306e\u524a\u9664\u3002\nlaunchctl unload $HOME/Library/LaunchAgents/attrec.plist\nrm -rf $HOME/.attrec\n\n\u306f\u3058\u3081\u306b\n--------------------\n\n### \u52d5\u6a5f\u3065\u3051\n\n\u3044\u3061\u3044\u3061\u51fa\u52e4\u30fb\u9000\u52e4\u6642\u523b\u3092\u8a18\u9332\u3059\u308b\u306e\u304c\u9762\u5012\u306a\u306e\u3067\u3001Shell\u30b9\u30af\u30ea\u30d7\u30c8\u3068GAS\u3092\u4f7f\u7528\u3057\u3066\u81ea\u52d5\u5316\u3057\u3066\u3057\u307e\u3044\u307e\u3059\u3002\n\n### \u65b9\u6cd5\n\n- GAS\u4e0a\u306bWeb API\u3092\u7528\u610f\u3057\u3001HTTP\u30ea\u30af\u30a8\u30b9\u30c8\u3092\u98db\u3070\u3059\u3068\u6642\u523b\u304c\u8a18\u9332\u3055\u308c\u308b\u53e3\u3092\u4f5c\u308a\u307e\u3059\u3002\n- Mac\u5074\u3067shell\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u5b9a\u671f\u5b9f\u884c\u3057\u3066\u3001\u8077\u5834\u306eWi-Fi\u306b\u63a5\u7d9a\u3057\u3066\u3044\u308c\u3070\u3001\u4e0a\u8a18API\u3092\u53e9\u304d\u306b\u884c\u304d\u307e\u3059\u3002\n- \u4e00\u65e5\u306e\u7d42\u308f\u308a\u306b\u8a18\u9332\u3092\u96c6\u8a08\u3057\u3001\u51fa\u52e4\u6642\u523b\u3001\u9000\u52e4\u6642\u523b\u3001\u6ede\u5728\u6642\u9593\u3092\u8a08\u7b97\u3057\u307e\u3059\u3002\n\nMac\u3067\u306e\u5b9a\u671f\u5b9f\u884c\u306f\u3001Linux\u306b\u3088\u304f\u3042\u308bcron\u3067\u306f\u306a\u304flaunchd\u3092\u4f7f\u7528\u3059\u308b\u3088\u3046\u3067\u3059\u3002\n\n### \u5b9f\u884c\u74b0\u5883\n- MacOS Sierra 10.12.2\n\nGAS\u30b9\u30af\u30ea\u30d7\u30c8\n--------------------\n\n### \u3061\u3087\u3063\u3068\u3057\u305f\u6e96\u5099\n\u30b9\u30af\u30ea\u30d7\u30c8\u306e\u30d7\u30ed\u30d1\u30c6\u30a3\u306b\u4e0b\u8a18\u306e\u30d7\u30ed\u30d1\u30c6\u30a3\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n\n- `FILENAME` : \u52e4\u6020\u8a18\u9332\u3092\u3064\u3051\u308bGoogle\u30b9\u30d7\u30ec\u30c3\u30c9\u30b7\u30fc\u30c8\u306e\u540d\u524d\u3002\u4e8b\u524d\u306bGoogle\u30c9\u30e9\u30a4\u30d6\u306b\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u6210\u3057\u3066\u304a\u304f\u3002\n- `SHEET_1st` : \u96c6\u8a08\u524d\u306e\u751f\u30c7\u30fc\u30bf\u3092\u8a18\u9332\u3057\u3066\u304a\u304f\u30b7\u30fc\u30c8\u540d\u3002\u300c\u30b7\u30fc\u30c81\u300d\u3067OK\n- `SHEET_2nd` : \u96c6\u8a08\u5f8c\u306e\u30c7\u30fc\u30bf\u3092\u8a18\u9332\u3057\u3066\u304a\u304f\u30b7\u30fc\u30c8\u540d\u3002\u300c\u30b7\u30fc\u30c82\u300d\u3067OK\n\nMoment.js\u3092\u4f7f\u3048\u308b\u3088\u3046\u306b\u8a2d\u5b9a\u3057\u307e\u3059\u3002\u5916\u90e8\u30e9\u30a4\u30d6\u30e9\u30ea\u3068\u3057\u3066\u5c0e\u5165\u3057\u3066\u3082\u3088\u3057\u3001\u30bd\u30fc\u30b9\u4e38\u30b3\u30d4\u3067\u7a81\u3063\u8fbc\u3093\u3067\u3082\u3088\u3057\u3002\n\n\u53c2\u8003\uff1a[\u65e5\u4ed8\uff06\u6642\u523b\u306e\u4fbf\u5229\u30e9\u30a4\u30d6\u30e9\u30ea\u300cMoment.js\u300d\u3092Google Apps Script\u3067\u4f7f\u3046\u65b9\u6cd5](http://tonari-it.com/gas-moment-js-moment/)\n\n\u305d\u306e\u4ed6\n\n- `summarize`\u95a2\u6570\u306b\u6642\u9593\u30d9\u30fc\u30b9\u30c8\u30ea\u30ac\u30fc\u3092\u8a2d\u5b9a\u3002\n- Web\u30a2\u30d7\u30ea\u3068\u3057\u3066\u516c\u958b\u3057\u3066\u304a\u304f\u3002\uff08\u4e0b\u306e\u5b9a\u671f\u5b9f\u884c\u30b7\u30a7\u30eb\u306bURL\u3092\u8a18\u8f09\u3059\u308b\uff09\n\n### \u8aac\u660e\u306a\u3069\n\n- `doGet`\u95a2\u6570 : `GET`\u30ea\u30af\u30a8\u30b9\u30c8\u3092\u53d7\u3051\u305f\u6642\u306e\u51e6\u7406\u3002\u53d7\u3051\u305f\u6642\u523b\u3092\u30b9\u30d7\u30ec\u30c3\u30c9\u30b7\u30fc\u30c8\u306b`append`\u3057\u3066\u3044\u308b\u3060\u3051\u3067\u3059\u3002\n- `summarize`\u95a2\u6570 : \u6642\u9593\u30d9\u30fc\u30b9\u30c8\u30ea\u30ac\u30fc\u3067\u6bce\u65e51:00-2:00\u306b\u5b9f\u884c\u3057\u3066\u3042\u3052\u308b\u3068\u3001\u524d\u65e5\u306e\u6700\u521d\u301c\u6700\u5f8c\u306e\u6642\u523b\u62bd\u51fa\u3001\u51fa\u52e4\u6642\u523b\u30fb\u9000\u52e4\u6642\u523b\u30fb\u6ede\u5728\u6642\u523b\u306e\u8a08\u7b97\u3001\u8a08\u7b97\u30c7\u30fc\u30bf\u306eappend\u3092\u5b9f\u884c\u3057\u307e\u3059\u3002\n\n```js:main.js\n// -----------------------------------------------------------------------------\n// GET\u306e\u30cf\u30f3\u30c9\u30e9\n// -----------------------------------------------------------------------------\nfunction doGet() {\n  try {\n    var sp = PropertiesService.getScriptProperties();\n    var FILENAME  = sp.getProperty(\"FILENAME\");\n    var SHEET_1st = sp.getProperty(\"SHEET_1st\");\n\n    var date = new Date();\n    var ss = getSpreadsheetByName(FILENAME);\n    var sheet = ss.getSheetByName(SHEET_1st);\n    sheet.appendRow([date]);\n    return createContent({status: 'OK'});\n\n  } catch(err) {\n    return createContent({status: 'NG'});\n  }\n}\n\n\n// -----------------------------------------------------------------------------\n// \u30b9\u30d7\u30ec\u30c3\u30c9\u30b7\u30fc\u30c8\u53d6\u5f97\u30e1\u30bd\u30c3\u30c9\n// -----------------------------------------------------------------------------\nfunction getSpreadsheetByName(filename) {\n  var fileIter = DriveApp.getFilesByName(filename);\n  if (fileIter.hasNext()) {\n    var file = fileIter.next();\n    return SpreadsheetApp.open(file);\n  } else {\n    throw FileError(\"File Not Found.\")\n  }\n}\n\n// -----------------------------------------------------------------------------\n// \u8fd4\u5374\u30c7\u30fc\u30bf\u306e\u751f\u6210\n// -----------------------------------------------------------------------------\nfunction createContent(res) {\n  return ContentService.createTextOutput(JSON.stringify(res))\n                       .setMimeType(ContentService.MimeType.JSON);\n}\n\n// -----------------------------------------------------------------------------\n// \u6628\u65e5\u306e\u30c7\u30fc\u30bf\u3092\u30b5\u30de\u30e9\u30a4\u30ba\uff081:00-2:00\u306b\u5b9f\u884c\uff09\n// -----------------------------------------------------------------------------\nfunction summarize() {\n  var sp = PropertiesService.getScriptProperties();\n  var FILENAME = sp.getProperty(\"FILENAME\");\n  var SHEET_1st = sp.getProperty(\"SHEET_1st\");\n  var SHEET_2nd = sp.getProperty(\"SHEET_2nd\");\n\n  var ss = getSpreadsheetByName(FILENAME);\n  var sheet1st = ss.getSheetByName(SHEET_1st);\n  var rows = sheet1st.getDataRange().getValues();\n\n  var FORMAT = \"YYYY/MM/DD\";\n  var yesterday = moment().subtract(\"days\", 1).startOf('day');\n  rows = rows.filter(function(row) {\n    return moment(row[0]).format(FORMAT) == yesterday.format(FORMAT);\n  });\n\n  if (rows.length == 0) return;\n\n  var entrDay = moment(rows[0][0]);\n  var exitDay = moment(rows[rows.length-1][0]);\n\n  var diff = exitDay.diff(entrDay, \"hours\", true);\n\n  var sheet2nd = ss.getSheetByName(SHEET_2nd);\n  sheet2nd.appendRow([yesterday.toDate(), entrDay.toDate(), exitDay.toDate(), diff, diff-1])\n\n  sheet1st.deleteRows(1, rows.length);\n}\n```\n\n\u5b9a\u671f\u5b9f\u884c\u30b7\u30a7\u30eb\n--------------------\u30fc\n\n`airport`\u30b3\u30de\u30f3\u30c9\u3067\u53d6\u5f97\u3057\u305fWi-Fi\u63a5\u7d9a\u60c5\u5831\u3092`grep`\u3084\u3089`sed`\u3084\u3089\u3092\u4f7f\u7528\u3057\u3066\u6574\u5f62\u3057\u3001\u63a5\u7d9a\u5148\u306eSSID\u540d\u3092\u62bd\u51fa\u3057\u307e\u3059\u3002\u305d\u306e\u5f8c\u3001\u8077\u5834\u306eSSID\u306b\u4e00\u81f4\u3057\u305f\u5834\u5408\u306f\u524d\u8ff0\u306eGAS\u306e\u53e3\u3092curl\u3067\u53e9\u304d\u307e\u3059\u3002\n\n```sh:attrec.sh\n#!/bin/bash\n\nSSID=your_office_ssid\nGASURL=https://script.google.com/macros/s/your_script_id/exec\n\nAIRPORT=/System/Library/PrivateFrameworks/Apple80211.framework/Versions/Current/Resources/airport\nCURRENT_SSID=`$AIRPORT -I | egrep \"^\\s+SSID:\" | sed -e 's/ *SSID: //g'`\n\nif [ $SSID = $CURRENT_SSID ]; then\n  curl $GASURL\nfi\n```\n\nlaunchd\n--------------------\n\n- Label: \u767b\u9332\u3059\u308b\u540d\u524d\u3002\u4efb\u610f\u3002\n- ProgramArguments: \u5b9f\u884c\u30b3\u30de\u30f3\u30c9\u7b49\u3002`$HOME/.attrec/attrec.sh`\u306b\u30b7\u30a7\u30eb\u304c\u7f6e\u3044\u3066\u3042\u308b\u60f3\u5b9a\n- StartInterval: \u5b9f\u884c\u9593\u9694\u300210\u5206\u304a\u304d\uff08600[sec]\uff09\u306e\u8a2d\u5b9a\u3002\n\n\u30ab\u30b9\u30bf\u30de\u30a4\u30ba\u306f\u3001\u4e0b\u8a18\u3042\u305f\u308a\u3092\u53c2\u8003\u306b\u3002\n\n\u53c2\u8003\uff1a[Mac\uff08OS X\uff09\u3067\u306fcron\u3058\u3083\u306a\u304f\u3066launchd\u3067\u3084\u308b - Furudate\u306e\u30d6\u30ed\u30b0](http://furudate.hatenablog.com/entry/2014/11/09/155017)\n\u53c2\u8003\uff1a[Mac OS X\u3067launchd\u3067cron\u306e\u3088\u3046\u306b\u5b9a\u671f\u5b9f\u884c\u3059\u308b\u30e1\u30e2 - launchd.plist\u306e\u4f5c\u6210\u3068\u304b - tweeeety\u306e\u3076\u308d\u3050\u7684\u3081\u3082](http://tweeeety.hateblo.jp/entry/2015/01/06/215425)\n\n```xml:attrec.plist\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<!DOCTYPE plist PUBLIC \"-//Apple//DTD PLIST 1.0//EN\" \"http://www.apple.com/DTDs/PropertyList-1.0.dtd\">\n<plist version=\"1.0\">\n<dict>\n\n  <key>Label</key>\n  <string>jp.ryskiwt.attrec</string>\n\n  <key>ProgramArguments</key>\n  <array>\n    <string>/bin/bash</string>\n    <string>-c</string>\n    <string>$HOME/.attrec/attrec.sh</string>\n  </array>\n\n  <key>StartInterval</key>\n  <integer>600</integer>\n\n</dict>\n</plist>\n```\n\n\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n--------------------\n\n\u30b7\u30a7\u30eb\u306e\u914d\u7f6e\u3068launchd\u3078\u306e\u767b\u9332\u3002\n\n```sh-session\nmkdir -p $HOME/.attrec\nvi $HOME/.attrec/attrec.sh\nvi $HOME/Library/LaunchAgents/attrec.plist\nLaunchctl load $HOME/Library/LaunchAgents/attrec.plist\n```\n\n\u30a2\u30f3\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n--------------------\n\nlaunchd\u304b\u3089\u306e\u767b\u9332\u89e3\u9664\u3068\u30b7\u30a7\u30eb\u306e\u524a\u9664\u3002\n\n```sh-session\nlaunchctl unload $HOME/Library/LaunchAgents/attrec.plist\nrm -rf $HOME/.attrec\n```\n"}