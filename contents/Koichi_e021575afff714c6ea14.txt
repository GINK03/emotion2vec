{"context": "\u53c2\u8003: https://underyx.me/2015/05/18/raising-the-maximum-number-of-file-descriptors\nulimit -n \u306e\u5024\u306f\u3001\u30aa\u30fc\u30d7\u30f3\u3067\u304d\u308b\u30d5\u30a1\u30a4\u30eb\u6570\u306e\u4e0a\u9650\u3092\u8868\u3057\u307e\u3059\u3002\u30aa\u30fc\u30d7\u30f3\u3057\u3066\u3044\u308b\u30d5\u30a1\u30a4\u30eb\u6570\u304c\u3053\u306e\u4e0a\u9650\u306b\u9054\u3059\u308b\u3068\u3001\u305d\u308c\u4ee5\u4e0a\u306f\u30bd\u30b1\u30c3\u30c8\u3082\u958b\u3051\u306a\u304f\u306a\u308b\u306e\u3067\u3001\u901a\u4fe1\u3082\u3067\u304d\u306a\u304f\u306a\u308a\u307e\u3059\u3002\n\u4eca\u56de\u3001supervisord\u3067\u30c7\u30fc\u30e2\u30f3\u5316\u3057\u3066\u3044\u308b process-x \u30d7\u30ed\u30bb\u30b9(\u4eee\u540d)\u306e ulimit -n \u5024\u3092\u5897\u3084\u3057\u305f\u6642\u306e\u624b\u9806\u3092\u8a18\u3057\u307e\u3059\u3002\n\n\u74b0\u5883\u30c1\u30a7\u30c3\u30af\n$ cat /etc/issue\nUbuntu 14.04.2 LTS \\n \\l\n\n$ cat /etc/lsb-release \nDISTRIB_ID=Ubuntu\nDISTRIB_RELEASE=14.04\nDISTRIB_CODENAME=trusty\nDISTRIB_DESCRIPTION=\"Ubuntu 14.04.2 LTS\"\n\n\n\u30c7\u30d5\u30a9\u30eb\u30c8\u5024\n$ ulimit -n\n1024\n$ ulimit -Sn\n1024\n$ ulimit -Hn\n4096\n\n\n\u8a2d\u5b9a\n\n/etc/security/limits.conf \u306b\u8ffd\u52a0\n\n/etc/security/limits.conf\n*    soft nofile 65536\n*    hard nofile 65536\nroot soft nofile 65536\nroot hard nofile 65536\n\n\n\n/etc/pam.d/common-session \u306b\u8ffd\u52a0\n\n/etc/pam.d/common-session\n# Set up user limits from /etc/security/limits.conf.\nsession    required     pam_limits.so\n\n\n\n/etc/pam.d/common-nonsession \u306b\u8ffd\u52a0\n\n/etc/pam.d/common-nonsession\n# Set up user limits from /etc/security/limits.conf.\nsession    required     pam_limits.so\n\n\n\n\u958b\u767a\u74b0\u5883\u306eUbuntu 14.04.3\u3067\u306f\u3001\u4e0a\u306e\u8ffd\u52a0\u90e8\u5206\u306f\u30b3\u30e1\u30f3\u30c8\u884c\u3068\u3057\u3066\u5b58\u5728\u3057\u3066\u3044\u307e\u3057\u305f\u3002\n\u3053\u3053\u307e\u3067\u3067\u3001\u5404\u30e6\u30fc\u30b6\u30fc\u304c\u30ed\u30b0\u30a4\u30f3\u3057\u306a\u304a\u3059\u3068\u3001\u8a2d\u5b9a\u304c\u66f4\u65b0\u3055\u308c\u3066\u3044\u307e\u3059\u3002\n\n$ ulimit -n\n65536\n\n\n/etc/supervisor/supervisord.conf \u306b\u8ffd\u52a0\n\n/etc/supervisor/supervisord.conf\n[supervisord]\nminfds=65536\n\n\nsupervisord \u518d\u8d77\u52d5\n$ sudo service supervisor restart\n\n\ndaemon\u306f\u8d77\u52d5\u30b9\u30af\u30ea\u30d7\u30c8\u4e2d\u3067\u3001 ulimit -n \u306e\u547c\u3073\u51fa\u3057\u304c\u5fc5\u8981\u3002\u4eca\u56de\u306fsuperversord\u306e\u8a2d\u5b9a\u306b\u3088\u308a\u540c\u7b49\u306e\u5185\u5bb9\u3068\u306a\u3063\u3066\u3044\u307e\u3059\u3002\n\n\u5b9f\u884c\u4e2d\u306e\u30d7\u30ed\u30bb\u30b9\u306b\u5909\u66f4\u304c\u9069\u7528\u3055\u308c\u3066\u3044\u308b\u304b\u3069\u3046\u304b\u306e\u78ba\u8a8d\n\nPID\u3092\u53d6\u5f97\ncat /proc/{PID}/limits\n\n\n\n$ ps -ef | grep process-x | grep -v grep\nwww-data 15322 22208  0 07:44 ?        00:03:03 /**/process-x\n\n$ cat /proc/15322/limits\nLimit                     Soft Limit           Hard Limit           Units     \nMax cpu time              unlimited            unlimited            seconds   \nMax file size             unlimited            unlimited            bytes     \nMax data size             unlimited            unlimited            bytes     \nMax stack size            8388608              unlimited            bytes     \nMax core file size        0                    unlimited            bytes     \nMax resident set          unlimited            unlimited            bytes     \nMax processes             31534                31534                processes \nMax open files            65536                65536                files     \nMax locked memory         65536                65536                bytes     \nMax address space         unlimited            unlimited            bytes     \nMax file locks            unlimited            unlimited            locks     \nMax pending signals       31534                31534                signals   \nMax msgqueue size         819200               819200               bytes     \nMax nice priority         0                    0                    \nMax realtime priority     0                    0                    \nMax realtime timeout      unlimited            unlimited            us \n\n\u53c2\u8003: https://underyx.me/2015/05/18/raising-the-maximum-number-of-file-descriptors\n\nulimit -n \u306e\u5024\u306f\u3001\u30aa\u30fc\u30d7\u30f3\u3067\u304d\u308b\u30d5\u30a1\u30a4\u30eb\u6570\u306e\u4e0a\u9650\u3092\u8868\u3057\u307e\u3059\u3002\u30aa\u30fc\u30d7\u30f3\u3057\u3066\u3044\u308b\u30d5\u30a1\u30a4\u30eb\u6570\u304c\u3053\u306e\u4e0a\u9650\u306b\u9054\u3059\u308b\u3068\u3001\u305d\u308c\u4ee5\u4e0a\u306f\u30bd\u30b1\u30c3\u30c8\u3082\u958b\u3051\u306a\u304f\u306a\u308b\u306e\u3067\u3001\u901a\u4fe1\u3082\u3067\u304d\u306a\u304f\u306a\u308a\u307e\u3059\u3002\n\u4eca\u56de\u3001supervisord\u3067\u30c7\u30fc\u30e2\u30f3\u5316\u3057\u3066\u3044\u308b process-x \u30d7\u30ed\u30bb\u30b9(\u4eee\u540d)\u306e ulimit -n \u5024\u3092\u5897\u3084\u3057\u305f\u6642\u306e\u624b\u9806\u3092\u8a18\u3057\u307e\u3059\u3002\n\n#### \u74b0\u5883\u30c1\u30a7\u30c3\u30af\n\n```shell-session\n$ cat /etc/issue\nUbuntu 14.04.2 LTS \\n \\l\n\n$ cat /etc/lsb-release \nDISTRIB_ID=Ubuntu\nDISTRIB_RELEASE=14.04\nDISTRIB_CODENAME=trusty\nDISTRIB_DESCRIPTION=\"Ubuntu 14.04.2 LTS\"\n```\n\n#### \u30c7\u30d5\u30a9\u30eb\u30c8\u5024\n\n```shell-session\n$ ulimit -n\n1024\n$ ulimit -Sn\n1024\n$ ulimit -Hn\n4096\n```\n\n#### \u8a2d\u5b9a\n\n##### /etc/security/limits.conf \u306b\u8ffd\u52a0\n\n```text:/etc/security/limits.conf\n*    soft nofile 65536\n*    hard nofile 65536\nroot soft nofile 65536\nroot hard nofile 65536\n```\n\n##### /etc/pam.d/common-session \u306b\u8ffd\u52a0\n\n```text:/etc/pam.d/common-session\n# Set up user limits from /etc/security/limits.conf.\nsession    required     pam_limits.so\n```\n\n##### /etc/pam.d/common-nonsession \u306b\u8ffd\u52a0\n\n```text:/etc/pam.d/common-nonsession\n# Set up user limits from /etc/security/limits.conf.\nsession    required     pam_limits.so\n```\n* \u958b\u767a\u74b0\u5883\u306e`Ubuntu 14.04.3`\u3067\u306f\u3001\u4e0a\u306e\u8ffd\u52a0\u90e8\u5206\u306f\u30b3\u30e1\u30f3\u30c8\u884c\u3068\u3057\u3066\u5b58\u5728\u3057\u3066\u3044\u307e\u3057\u305f\u3002\n* \u3053\u3053\u307e\u3067\u3067\u3001\u5404\u30e6\u30fc\u30b6\u30fc\u304c\u30ed\u30b0\u30a4\u30f3\u3057\u306a\u304a\u3059\u3068\u3001\u8a2d\u5b9a\u304c\u66f4\u65b0\u3055\u308c\u3066\u3044\u307e\u3059\u3002\n\n```shell-session\n$ ulimit -n\n65536\n```\n\n##### /etc/supervisor/supervisord.conf \u306b\u8ffd\u52a0\n\n```text:/etc/supervisor/supervisord.conf\n[supervisord]\nminfds=65536\n```\n\nsupervisord \u518d\u8d77\u52d5\n\n```shell-session\n$ sudo service supervisor restart\n```\n\n* daemon\u306f\u8d77\u52d5\u30b9\u30af\u30ea\u30d7\u30c8\u4e2d\u3067\u3001 `ulimit -n` \u306e\u547c\u3073\u51fa\u3057\u304c\u5fc5\u8981\u3002\u4eca\u56de\u306f`superversord`\u306e\u8a2d\u5b9a\u306b\u3088\u308a\u540c\u7b49\u306e\u5185\u5bb9\u3068\u306a\u3063\u3066\u3044\u307e\u3059\u3002\n\n* \u5b9f\u884c\u4e2d\u306e\u30d7\u30ed\u30bb\u30b9\u306b\u5909\u66f4\u304c\u9069\u7528\u3055\u308c\u3066\u3044\u308b\u304b\u3069\u3046\u304b\u306e\u78ba\u8a8d\n    * PID\u3092\u53d6\u5f97\n    * cat /proc/{PID}/limits\n\n```shell-session\n$ ps -ef | grep process-x | grep -v grep\nwww-data 15322 22208  0 07:44 ?        00:03:03 /**/process-x\n```\n\n```shell-session\n$ cat /proc/15322/limits\nLimit                     Soft Limit           Hard Limit           Units     \nMax cpu time              unlimited            unlimited            seconds   \nMax file size             unlimited            unlimited            bytes     \nMax data size             unlimited            unlimited            bytes     \nMax stack size            8388608              unlimited            bytes     \nMax core file size        0                    unlimited            bytes     \nMax resident set          unlimited            unlimited            bytes     \nMax processes             31534                31534                processes \nMax open files            65536                65536                files     \nMax locked memory         65536                65536                bytes     \nMax address space         unlimited            unlimited            bytes     \nMax file locks            unlimited            unlimited            locks     \nMax pending signals       31534                31534                signals   \nMax msgqueue size         819200               819200               bytes     \nMax nice priority         0                    0                    \nMax realtime priority     0                    0                    \nMax realtime timeout      unlimited            unlimited            us \n```\n", "tags": ["\u30a4\u30f3\u30d5\u30e9", "Linux"]}