{"tags": ["Ruby", "Selenium"], "context": " More than 1 year has passed since last update.JavaScript\u30d0\u30ea\u30d0\u30ea\u306a\u30da\u30fc\u30b8\u306fNokogiri\u306a\u3069\u306e\u30b9\u30af\u30ec\u30a4\u30d4\u30f3\u30b0\u30c4\u30fc\u30eb\u3067\u6271\u3046\u306e\u304c\u96e3\u3057\u3044\u3067\u3059\u304c\u3001Selenium\u3067\u30d6\u30e9\u30a6\u30b6\u81ea\u52d5\u64cd\u4f5c\u3059\u308b\u3068\u5927\u4f53\u306e\u3082\u306e\u306f\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u308b\u306e\u3067\u3001\u4f7f\u3044\u65b9\u3092\u307e\u3068\u3081\u3066\u304a\u304d\u307e\u3059\u3002\nJava\u304b\u3089\u4f7f\u3046\u306e\u3068\u6bd4\u3079\u3066\u3001Ruby\u30d0\u30a4\u30f3\u30c7\u30a3\u30f3\u30b0\u3060\u3068\u305a\u3044\u3076\u3093\u30b7\u30f3\u30d7\u30eb\u3067\u826f\u304b\u3063\u305f\u3067\u3059\u3002\n\n\u30ea\u30d5\u30a1\u30ec\u30f3\u30b9\nhttp://selenium.googlecode.com/svn/trunk/docs/api/rb/frames.html\n\u30102015-11-12 \u8ffd\u8a18\u3011\u4e0a\u8a18\u306e\u30ea\u30f3\u30af\u306f\u66f4\u65b0\u505c\u6b62\u3057\u3066\u3044\u308b\u3088\u3046\u306a\u306e\u3067\u3053\u3061\u3089\u3092\u898b\u305f\u307b\u3046\u304c\u826f\u3055\u305d\u3046\u3067\u3059\nhttp://www.rubydoc.info/gems/selenium-webdriver/\n\n\u4f7f\u3044\u65b9\ngem\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\u3002\ngem install selenium-webdriver\n\nselenium\u306a\u3093\u3061\u3083\u3089\u3068\u3044\u3046gem\u304c\u305f\u304f\u3055\u3093\u3042\u308b\u3051\u3069\u3053\u308c\u3060\u3051\u3067\u3088\u3044\u3002\n\u30b3\u30fc\u30c9\u5185\u3067 require 'selenium-webdriver' \u3059\u308c\u3070\u4f7f\u3048\u308b\u3088\u3046\u306b\u306a\u308b\u3002\n\n\u8d77\u52d5\u3068\u7d42\u4e86\ndriver = Selenium::WebDriver.for :firefox # \u30d6\u30e9\u30a6\u30b6\u8d77\u52d5\n\ndriver.quit # \u30d6\u30e9\u30a6\u30b6\u7d42\u4e86\n\n:firefox \u306e\u3068\u3053\u308d\u306f :ie\u3068\u304b:chrome\u3068\u304b:opera\u3068\u304b\u597d\u304d\u306a\u306e\u3092\n\n\u30da\u30fc\u30b8\u3001\u30d5\u30ec\u30fc\u30e0\u79fb\u52d5\ndriver.navigate.to 'http://example.com' # URL\u3092\u958b\u304f\ndriver.switch_to.frame(1)               # 1\u3064\u3081\u306e\u5b50\u30d5\u30ec\u30fc\u30e0\u306b\u79fb\u52d5\ndriver.switch_to.frame(\"frameid\")       # \u30d5\u30ec\u30fc\u30e0\u306ename\u3092\u6307\u5b9a\u3057\u3066\u79fb\u52d5\n\n\n\u8981\u7d20\u3092\u6307\u5b9a\nelement = driver.find_element(:name, 'calendar')        # name\u3067\u6307\u5b9a\nelement = driver.find_element(:id, 'calendar')          # id\u3067\u6307\u5b9a\nelement = driver.find_element(:class, 'right_box')      # class\u3067\u6307\u5b9a\nelement = element.find_element(:tag_name, 'table')      # \u8981\u7d20\u540d\u3067\u6307\u5b9a\nelement = element.find_element(:xpath, 'tr[2]/td[3]/a') # XPath\u3067\u6307\u5b9a\nelement = driver.find_element(:class, 'body').find_element(:name, 'form').find_elements(:xpath, './/input')[2] # \u30e1\u30bd\u30c3\u30c9\u30c1\u30a7\u30fc\u30f3\n\nDriver\u3068Element\u304c\u3069\u3061\u3089\u3082find_element\u30fbfind_elements\u30e1\u30bd\u30c3\u30c9\u3092\u6301\u3063\u3066\u3044\u308b\u3002\n\n\u5165\u529b\n# \u30c6\u30ad\u30b9\u30c8\u30d5\u30a3\u30fc\u30eb\u30c9\u3078\u5165\u529b\u30fb\u524a\u9664\nelement = driver.find_element(:name, 'userId')\nelement.send_keys('username')\nelement.clear\n\n# \u30c9\u30ed\u30c3\u30d7\u30c0\u30a6\u30f3\u30ea\u30b9\u30c8\u9078\u629e\nselect = Selenium::WebDriver::Support::Select.new(driver.find_element(:id, 'dropdown'))\nselect.select_by(:value, 'item1')       # value\u306e\u5024\u3067\u9078\u629e\nselect.select_by(:text, '\u3069\u3061\u3089\u3067\u3082\u306a\u3044') # \u8868\u793a\u30c6\u30ad\u30b9\u30c8\u3067\u9078\u629e\nselect.select_by(:index, 2)             # \u30a4\u30f3\u30c7\u30c3\u30af\u30b9\uff080\u59cb\u307e\u308a\uff09\u3067\u9078\u629e\n\n# \u30e9\u30b8\u30aa\u30dc\u30bf\u30f3\u9078\u629e\ndriver.find_elements(:name, 'selectOne')[2].click\n\n# \u30ea\u30f3\u30af\u3084\u30dc\u30bf\u30f3\u3092\u62bc\u3059\ndriver.find_element(:xpath, '//table[2]/tr[3]/td[1]/a').click\n\n\n\n\u60c5\u5831\u53d6\u5f97\n# \u8981\u7d20\u306e\u5185\u5bb9\u30c6\u30ad\u30b9\u30c8\nputs element.text\n\n# Firefox\u3067\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u306e\u30ea\u30f3\u30af\u3092\u8e0f\u3093\u3060\u3068\u304d\u4fdd\u5b58\u78ba\u8a8d\u30c0\u30a4\u30a2\u30ed\u30b0\u3092\u51fa\u3055\u305a\u306b\u6307\u5b9a\u306e\u30d5\u30a9\u30eb\u30c0\u306b\u4fdd\u5b58\nprofile = Selenium::WebDriver::Firefox::Profile.new\nprofile['browser.download.folderList'] = 2\nprofile['browser.download.useDownloadDir'] = true\nprofile['browser.download.dir'] = 'path/to/downloadFolder'\nprofile['browser.helperApps.neverAsk.saveToDisk'] = 'text/csv'\ndriver = Selenium::WebDriver.for :firefox, :profile => profile\n\n# \u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8\u3092\u64ae\u308b\n# !!private API\u306b\u3064\u304d\u52d5\u4f5c\u4fdd\u8a3c\u306a\u3057!!\ndriver.save_screenshot('path/to/filename.png')\n\n\n\u304a\u308f\u308a\u306b\n\u3053\u3053\u306b\u3082\u3046\u5c11\u3057\u8a73\u3057\u304f\u66f8\u3044\u3066\u3042\u308a\u307e\u3059\uff08\u82f1\u8a9e\uff09\nhttp://code.google.com/p/selenium/wiki/RubyBindings\n\nJavaScript\u30d0\u30ea\u30d0\u30ea\u306a\u30da\u30fc\u30b8\u306fNokogiri\u306a\u3069\u306e\u30b9\u30af\u30ec\u30a4\u30d4\u30f3\u30b0\u30c4\u30fc\u30eb\u3067\u6271\u3046\u306e\u304c\u96e3\u3057\u3044\u3067\u3059\u304c\u3001Selenium\u3067\u30d6\u30e9\u30a6\u30b6\u81ea\u52d5\u64cd\u4f5c\u3059\u308b\u3068\u5927\u4f53\u306e\u3082\u306e\u306f\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u308b\u306e\u3067\u3001\u4f7f\u3044\u65b9\u3092\u307e\u3068\u3081\u3066\u304a\u304d\u307e\u3059\u3002\nJava\u304b\u3089\u4f7f\u3046\u306e\u3068\u6bd4\u3079\u3066\u3001Ruby\u30d0\u30a4\u30f3\u30c7\u30a3\u30f3\u30b0\u3060\u3068\u305a\u3044\u3076\u3093\u30b7\u30f3\u30d7\u30eb\u3067\u826f\u304b\u3063\u305f\u3067\u3059\u3002\n\n## \u30ea\u30d5\u30a1\u30ec\u30f3\u30b9\n\nhttp://selenium.googlecode.com/svn/trunk/docs/api/rb/frames.html\n\n\u30102015-11-12 \u8ffd\u8a18\u3011\u4e0a\u8a18\u306e\u30ea\u30f3\u30af\u306f\u66f4\u65b0\u505c\u6b62\u3057\u3066\u3044\u308b\u3088\u3046\u306a\u306e\u3067\u3053\u3061\u3089\u3092\u898b\u305f\u307b\u3046\u304c\u826f\u3055\u305d\u3046\u3067\u3059\nhttp://www.rubydoc.info/gems/selenium-webdriver/\n\n## \u4f7f\u3044\u65b9\n\ngem\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\u3002\n\n```bash\ngem install selenium-webdriver\n```\n\nselenium\u306a\u3093\u3061\u3083\u3089\u3068\u3044\u3046gem\u304c\u305f\u304f\u3055\u3093\u3042\u308b\u3051\u3069\u3053\u308c\u3060\u3051\u3067\u3088\u3044\u3002\n\n\u30b3\u30fc\u30c9\u5185\u3067 `require 'selenium-webdriver'` \u3059\u308c\u3070\u4f7f\u3048\u308b\u3088\u3046\u306b\u306a\u308b\u3002\n\n\n## \u8d77\u52d5\u3068\u7d42\u4e86\n\n```ruby\ndriver = Selenium::WebDriver.for :firefox # \u30d6\u30e9\u30a6\u30b6\u8d77\u52d5\n\ndriver.quit # \u30d6\u30e9\u30a6\u30b6\u7d42\u4e86\n```\n\n:firefox \u306e\u3068\u3053\u308d\u306f :ie\u3068\u304b:chrome\u3068\u304b:opera\u3068\u304b\u597d\u304d\u306a\u306e\u3092\n\n\n## \u30da\u30fc\u30b8\u3001\u30d5\u30ec\u30fc\u30e0\u79fb\u52d5\n\n```ruby\ndriver.navigate.to 'http://example.com' # URL\u3092\u958b\u304f\ndriver.switch_to.frame(1)               # 1\u3064\u3081\u306e\u5b50\u30d5\u30ec\u30fc\u30e0\u306b\u79fb\u52d5\ndriver.switch_to.frame(\"frameid\")       # \u30d5\u30ec\u30fc\u30e0\u306ename\u3092\u6307\u5b9a\u3057\u3066\u79fb\u52d5\n```\n\n## \u8981\u7d20\u3092\u6307\u5b9a\n\n```ruby\nelement = driver.find_element(:name, 'calendar')        # name\u3067\u6307\u5b9a\nelement = driver.find_element(:id, 'calendar')          # id\u3067\u6307\u5b9a\nelement = driver.find_element(:class, 'right_box')      # class\u3067\u6307\u5b9a\nelement = element.find_element(:tag_name, 'table')      # \u8981\u7d20\u540d\u3067\u6307\u5b9a\nelement = element.find_element(:xpath, 'tr[2]/td[3]/a') # XPath\u3067\u6307\u5b9a\nelement = driver.find_element(:class, 'body').find_element(:name, 'form').find_elements(:xpath, './/input')[2] # \u30e1\u30bd\u30c3\u30c9\u30c1\u30a7\u30fc\u30f3\n```\n\nDriver\u3068Element\u304c\u3069\u3061\u3089\u3082find_element\u30fbfind_elements\u30e1\u30bd\u30c3\u30c9\u3092\u6301\u3063\u3066\u3044\u308b\u3002\n\n\n## \u5165\u529b\n\n```ruby\n# \u30c6\u30ad\u30b9\u30c8\u30d5\u30a3\u30fc\u30eb\u30c9\u3078\u5165\u529b\u30fb\u524a\u9664\nelement = driver.find_element(:name, 'userId')\nelement.send_keys('username')\nelement.clear\n\n# \u30c9\u30ed\u30c3\u30d7\u30c0\u30a6\u30f3\u30ea\u30b9\u30c8\u9078\u629e\nselect = Selenium::WebDriver::Support::Select.new(driver.find_element(:id, 'dropdown'))\nselect.select_by(:value, 'item1')       # value\u306e\u5024\u3067\u9078\u629e\nselect.select_by(:text, '\u3069\u3061\u3089\u3067\u3082\u306a\u3044') # \u8868\u793a\u30c6\u30ad\u30b9\u30c8\u3067\u9078\u629e\nselect.select_by(:index, 2)             # \u30a4\u30f3\u30c7\u30c3\u30af\u30b9\uff080\u59cb\u307e\u308a\uff09\u3067\u9078\u629e\n\n# \u30e9\u30b8\u30aa\u30dc\u30bf\u30f3\u9078\u629e\ndriver.find_elements(:name, 'selectOne')[2].click\n\n# \u30ea\u30f3\u30af\u3084\u30dc\u30bf\u30f3\u3092\u62bc\u3059\ndriver.find_element(:xpath, '//table[2]/tr[3]/td[1]/a').click\n\n```\n\n\n## \u60c5\u5831\u53d6\u5f97\n\n```ruby\n# \u8981\u7d20\u306e\u5185\u5bb9\u30c6\u30ad\u30b9\u30c8\nputs element.text\n\n# Firefox\u3067\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u306e\u30ea\u30f3\u30af\u3092\u8e0f\u3093\u3060\u3068\u304d\u4fdd\u5b58\u78ba\u8a8d\u30c0\u30a4\u30a2\u30ed\u30b0\u3092\u51fa\u3055\u305a\u306b\u6307\u5b9a\u306e\u30d5\u30a9\u30eb\u30c0\u306b\u4fdd\u5b58\nprofile = Selenium::WebDriver::Firefox::Profile.new\nprofile['browser.download.folderList'] = 2\nprofile['browser.download.useDownloadDir'] = true\nprofile['browser.download.dir'] = 'path/to/downloadFolder'\nprofile['browser.helperApps.neverAsk.saveToDisk'] = 'text/csv'\ndriver = Selenium::WebDriver.for :firefox, :profile => profile\n\n# \u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8\u3092\u64ae\u308b\n# !!private API\u306b\u3064\u304d\u52d5\u4f5c\u4fdd\u8a3c\u306a\u3057!!\ndriver.save_screenshot('path/to/filename.png')\n```\n\n\n\n## \u304a\u308f\u308a\u306b\n\n\u3053\u3053\u306b\u3082\u3046\u5c11\u3057\u8a73\u3057\u304f\u66f8\u3044\u3066\u3042\u308a\u307e\u3059\uff08\u82f1\u8a9e\uff09\nhttp://code.google.com/p/selenium/wiki/RubyBindings\n"}