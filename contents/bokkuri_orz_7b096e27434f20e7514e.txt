{"context": " More than 1 year has passed since last update.\u8907\u6570\u306e\u30a2\u30bb\u30c3\u30c8\u30d0\u30f3\u30c9\u30eb\u3092\u6271\u3046\u969b\u3001\u5171\u901a\u306e\u30de\u30c6\u30ea\u30a2\u30eb\u3001\u30e1\u30c3\u30b7\u30e5\u7b49\u304c\u7121\u99c4\u306b\u8907\u88fd\u3055\u308c\u3066\u30e1\u30e2\u30ea\u3092\u6d6a\u8cbb\u3059\u308b\u554f\u984c\u3092\u56de\u907f\u3059\u308b\u65b9\u6cd5\u306b\u3064\u3044\u3066\u3002\n\n\u30d3\u30eb\u30c9\nprivate void BuildAssetBundle(BuildTarget platform, Object[] commons, Object[] objects)\n{\n        //DeterministicAssetBundle\u304c\u5fc5\u8981\u3002\n        //\u5f8c\u3067\u4e00\u90e8\u306e\u30a2\u30bb\u30c3\u30c8\u30d0\u30f3\u30c9\u30eb\u3092\u518d\u30d3\u30eb\u30c9\u3059\u308b\u969b\u3001\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306e\u8b58\u5225\u306b\u5229\u7528\u3055\u308c\u308b\u3002\n        //ID\u3092\u4ed8\u3051\u306a\u3044\u5834\u5408\u3001\u5171\u6709\u30a2\u30bb\u30c3\u30c8\u30d0\u30f3\u30c9\u30eb\u3060\u3051\u5f8c\u3067\u518d\u30d3\u30eb\u30c9\u3057\u305f\u6642\u3001\u30ea\u30bd\u30fc\u30b9\u306e\u95a2\u9023\u4ed8\u3051\u304c\u51fa\u6765\u306a\u304f\u306a\u308b\u3089\u3057\u3044\u3002\n        BuildAssetBundleOptions option =\n                BuildAssetBundleOptions.CollectDependencies |\n                BuildAssetBundleOptions.CompleteAssets |\n                BuildAssetBundleOptions.DeterministicAssetBundle;\n\n        BuildPipeline.PushAssetDependencies();\n\n        // \u5171\u6709\u30a2\u30bb\u30c3\u30c8\u30d0\u30f3\u30c9\u30eb\u3092\u30d3\u30eb\u30c9\n        BuildPipeline.BuildAssetBundle(null, commons, \"common.unity3d\", option, platform);\n\n        for(int i = 0; i < objects.Length; ++i)\n        {\n                // \u500b\u5225\u306e\u30a2\u30bb\u30c3\u30c8\u30d0\u30f3\u30c9\u30eb\u3082Push, Pop \u3067\u56f2\u3080\n                BuildPipeline.PushAssetDependencies();\n\n                // \u500b\u5225\u306e\u30a2\u30bb\u30c3\u30c8\u30d0\u30f3\u30c9\u30eb\u3092\u30d3\u30eb\u30c9\n                BuildPipeline.BuildAssetBundle(objects[i], new Object[]{objects[i]}, objects[i].name + \".unity3d\", option, platform);\n\n                BuildPipeline.PopAssetDependencies();\n        }\n\n        BuildPipeline.PopAssetDependencies();\n}\n\n\n\u30ed\u30fc\u30c9\nIEnumerator LoadAssetBundle(string fileName, bool isCommon, DownloadCallback callback)\n{\n    // \u5171\u6709\u30a2\u30bb\u30c3\u30c8\u30d0\u30f3\u30c9\u30eb\u306e\u8aad\u307f\u8fbc\u307f.\n    WWW loader = WWW.LoadFromCacheOrDownload(\"common.unity3d\", 0);\n    while(!loader.isDone) yield return new WaitForSeconds(0.1f);\n\n    // LoadAll()\u3067\u4e00\u65e6\u5168\u3066\u30ed\u30fc\u30c9\u3059\u308b\u3053\u3068\u3067\u3001\u30ea\u30bd\u30fc\u30b9\u304c\u30e1\u30e2\u30ea\u4e0a\u306b\u4e57\u308b\u3002\n    // \u591a\u5206\u30b7\u30a7\u30fc\u30c0\u30fc\u306e\u30b3\u30f3\u30d1\u30a4\u30eb\u3082\u884c\u308f\u308c\u308b\u3002\n    // \u4f9d\u5b58\u3059\u308b\u30a2\u30bb\u30c3\u30c8\u30d0\u30f3\u30c9\u30eb\u304b\u3089\u30ed\u30fc\u30c9\u3092\u884c\u3046\u307e\u3067\u306fUnload()\u3057\u306a\u3044\u3002\n    AssetBundle commonAB = loader.assetBundle;\n    Object[] commonObj = commonAB.LoadAll();\n\n    // \u4f9d\u5b58\u3057\u3066\u3044\u308b\u30a2\u30bb\u30c3\u30c8\u30d0\u30f3\u30c9\u30ebA\n    loader = WWW.LoadFromCacheOrDownload(\"AssetBundleA.unity3d\", 0);\n    while(!loader.isDone) yield return new WaitForSeconds(0.1f);\n\n    // \u5fc5\u8981\u306a\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u30ed\u30fc\u30c9\u3057\u3066\u3001\u30a2\u30bb\u30c3\u30c8\u30d0\u30f3\u30c9\u30eb\u306f\u5373\u89e3\u653e.\n    AssetBundle ab = loader.assetBundle;\n    Object objA = ab.Load(\"objectA\", typeof(GameObject));\n    ab.Unload(false);\n\n    // \u4f9d\u5b58\u3057\u3066\u3044\u308b\u30a2\u30bb\u30c3\u30c8\u30d0\u30f3\u30c9\u30ebB\n    loader = WWW.LoadFromCacheOrDownload(\"AssetBundleB.unity3d\", 0);\n    while(!loader.isDone) yield return new WaitForSeconds(0.1f);\n\n    ab = loader.assetBundle;\n    Object objB = ab.Load(\"objectB\", typeof(GameObject));\n    ab.Unload(false);\n}\n\n\n\u53c2\u8003\u30b5\u30a4\u30c8\n\u53c2\u8003\u30b5\u30a4\u30c8\nUnity\u516c\u5f0f\uff1a\u30a2\u30bb\u30c3\u30c8\u4f9d\u5b58\u95a2\u4fc2\u306e\u7ba1\u7406 / Managing asset dependencies\nhttp://docs.unity3d.com/ja/current/Manual/managingassetdependencies.html\nkeijiro\u3055\u3093\uff1a\u30a2\u30bb\u30c3\u30c8\u30d0\u30f3\u30c9\u30eb\u3068\u30b7\u30a7\u30fc\u30c0\u30fc\nhttps://github.com/keijiro/unity-shader-bundle\n\u8907\u6570\u306e\u30a2\u30bb\u30c3\u30c8\u30d0\u30f3\u30c9\u30eb\u3092\u6271\u3046\u969b\u3001\u5171\u901a\u306e\u30de\u30c6\u30ea\u30a2\u30eb\u3001\u30e1\u30c3\u30b7\u30e5\u7b49\u304c\u7121\u99c4\u306b\u8907\u88fd\u3055\u308c\u3066\u30e1\u30e2\u30ea\u3092\u6d6a\u8cbb\u3059\u308b\u554f\u984c\u3092\u56de\u907f\u3059\u308b\u65b9\u6cd5\u306b\u3064\u3044\u3066\u3002\n\n\n# \u30d3\u30eb\u30c9\n\n```csharp\nprivate void BuildAssetBundle(BuildTarget platform, Object[] commons, Object[] objects)\n{\n        //DeterministicAssetBundle\u304c\u5fc5\u8981\u3002\n        //\u5f8c\u3067\u4e00\u90e8\u306e\u30a2\u30bb\u30c3\u30c8\u30d0\u30f3\u30c9\u30eb\u3092\u518d\u30d3\u30eb\u30c9\u3059\u308b\u969b\u3001\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306e\u8b58\u5225\u306b\u5229\u7528\u3055\u308c\u308b\u3002\n        //ID\u3092\u4ed8\u3051\u306a\u3044\u5834\u5408\u3001\u5171\u6709\u30a2\u30bb\u30c3\u30c8\u30d0\u30f3\u30c9\u30eb\u3060\u3051\u5f8c\u3067\u518d\u30d3\u30eb\u30c9\u3057\u305f\u6642\u3001\u30ea\u30bd\u30fc\u30b9\u306e\u95a2\u9023\u4ed8\u3051\u304c\u51fa\u6765\u306a\u304f\u306a\u308b\u3089\u3057\u3044\u3002\n        BuildAssetBundleOptions option =\n                BuildAssetBundleOptions.CollectDependencies |\n                BuildAssetBundleOptions.CompleteAssets |\n                BuildAssetBundleOptions.DeterministicAssetBundle;\n\n        BuildPipeline.PushAssetDependencies();\n\n        // \u5171\u6709\u30a2\u30bb\u30c3\u30c8\u30d0\u30f3\u30c9\u30eb\u3092\u30d3\u30eb\u30c9\n        BuildPipeline.BuildAssetBundle(null, commons, \"common.unity3d\", option, platform);\n\n        for(int i = 0; i < objects.Length; ++i)\n        {\n                // \u500b\u5225\u306e\u30a2\u30bb\u30c3\u30c8\u30d0\u30f3\u30c9\u30eb\u3082Push, Pop \u3067\u56f2\u3080\n                BuildPipeline.PushAssetDependencies();\n                \n                // \u500b\u5225\u306e\u30a2\u30bb\u30c3\u30c8\u30d0\u30f3\u30c9\u30eb\u3092\u30d3\u30eb\u30c9\n                BuildPipeline.BuildAssetBundle(objects[i], new Object[]{objects[i]}, objects[i].name + \".unity3d\", option, platform);\n                \n                BuildPipeline.PopAssetDependencies();\n        }\n\n        BuildPipeline.PopAssetDependencies();\n}\n```\n\n# \u30ed\u30fc\u30c9\n\n```csharp\nIEnumerator LoadAssetBundle(string fileName, bool isCommon, DownloadCallback callback)\n{\n    // \u5171\u6709\u30a2\u30bb\u30c3\u30c8\u30d0\u30f3\u30c9\u30eb\u306e\u8aad\u307f\u8fbc\u307f.\n    WWW loader = WWW.LoadFromCacheOrDownload(\"common.unity3d\", 0);\n    while(!loader.isDone) yield return new WaitForSeconds(0.1f);\n\n    // LoadAll()\u3067\u4e00\u65e6\u5168\u3066\u30ed\u30fc\u30c9\u3059\u308b\u3053\u3068\u3067\u3001\u30ea\u30bd\u30fc\u30b9\u304c\u30e1\u30e2\u30ea\u4e0a\u306b\u4e57\u308b\u3002\n    // \u591a\u5206\u30b7\u30a7\u30fc\u30c0\u30fc\u306e\u30b3\u30f3\u30d1\u30a4\u30eb\u3082\u884c\u308f\u308c\u308b\u3002\n    // \u4f9d\u5b58\u3059\u308b\u30a2\u30bb\u30c3\u30c8\u30d0\u30f3\u30c9\u30eb\u304b\u3089\u30ed\u30fc\u30c9\u3092\u884c\u3046\u307e\u3067\u306fUnload()\u3057\u306a\u3044\u3002\n    AssetBundle commonAB = loader.assetBundle;\n    Object[] commonObj = commonAB.LoadAll();\n\n    // \u4f9d\u5b58\u3057\u3066\u3044\u308b\u30a2\u30bb\u30c3\u30c8\u30d0\u30f3\u30c9\u30ebA\n    loader = WWW.LoadFromCacheOrDownload(\"AssetBundleA.unity3d\", 0);\n    while(!loader.isDone) yield return new WaitForSeconds(0.1f);\n\n    // \u5fc5\u8981\u306a\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u30ed\u30fc\u30c9\u3057\u3066\u3001\u30a2\u30bb\u30c3\u30c8\u30d0\u30f3\u30c9\u30eb\u306f\u5373\u89e3\u653e.\n    AssetBundle ab = loader.assetBundle;\n    Object objA = ab.Load(\"objectA\", typeof(GameObject));\n    ab.Unload(false);\n    \n    // \u4f9d\u5b58\u3057\u3066\u3044\u308b\u30a2\u30bb\u30c3\u30c8\u30d0\u30f3\u30c9\u30ebB\n    loader = WWW.LoadFromCacheOrDownload(\"AssetBundleB.unity3d\", 0);\n    while(!loader.isDone) yield return new WaitForSeconds(0.1f);\n\n    ab = loader.assetBundle;\n    Object objB = ab.Load(\"objectB\", typeof(GameObject));\n    ab.Unload(false);\n}\n```\n\n# \u53c2\u8003\u30b5\u30a4\u30c8\n\n\u53c2\u8003\u30b5\u30a4\u30c8\n\nUnity\u516c\u5f0f\uff1a\u30a2\u30bb\u30c3\u30c8\u4f9d\u5b58\u95a2\u4fc2\u306e\u7ba1\u7406 / Managing asset dependencies\nhttp://docs.unity3d.com/ja/current/Manual/managingassetdependencies.html\n\nkeijiro\u3055\u3093\uff1a\u30a2\u30bb\u30c3\u30c8\u30d0\u30f3\u30c9\u30eb\u3068\u30b7\u30a7\u30fc\u30c0\u30fc\nhttps://github.com/keijiro/unity-shader-bundle\n", "tags": ["Unity", "Unity3D"]}