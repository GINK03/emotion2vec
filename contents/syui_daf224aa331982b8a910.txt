{"context": " More than 1 year has passed since last update.\n\n\u4f5c\u696d\u5834\u6240\u3078\u306e\u79fb\u52d5\n\nTerminal\n\ncd /usr/local/bin\n\n\n\n\n\u8d77\u52d5\u6642\u9593\u3092\u53d6\u5f97\u3059\u308b\u30b9\u30af\u30ea\u30d7\u30c8\u306e\u4f5c\u6210\n\npc-running-time\n\n#!/bin/sh\nuptime | sed -e 's/.* up *\\(.*\\)/\\1/' -e 's/\\(.*\\),.* user.*/\\1/' | awk -F, '{print $1 $2}' | tr -s ' '\n\n\n\n\n\u30ed\u30fc\u30c9\u30a2\u30d9\u30ec\u30fc\u30b8\u3092\u53d6\u5f97\u3059\u308b\u30b9\u30af\u30ea\u30d7\u30c8\u306e\u4f5c\u6210\n\nloadaverage\n\n#!/bin/sh\nuptime | awk -F\\  '{print $(NF - 2),$(NF - 1),$NF}'\n\n\n\n\n\u30e1\u30e2\u30ea\u4f7f\u7528\u7387\u3092\u53d6\u5f97\u3059\u308b\u30b9\u30af\u30ea\u30d7\u30c8\u306e\u4f5c\u6210\n\nused-mem\n\n#!/bin/sh\n\n## debug mode\n#DEBUG=\"yes\"\nif [ \"$DEBUG\" = \"yes\" ]; then\n    set -x\nfi\n\n## vm_stat \u30b3\u30de\u30f3\u30c9\u306e\u30c1\u30a7\u30c3\u30af\nif ! type vm_stat > /dev/null 2>&1; then\n    exit 1\nfi\n\n#\n# \u30e1\u30e2\u30ea\u4f7f\u7528\u7387(%)\u3092\u6c42\u3081\u308b\n#   \u7cbe\u5ea6\u306f\u5c0f\u6570\u70b9\u7b2c1\u4f4d\u307e\u3067\u3068\u3059\u308b\n#\ncalculate_used_mem() {\n    # vm_stat\n    #  page size of 4096 bytes\n    VM_STAT=$(vm_stat)\n    PAGES_FREE=$(echo \"$VM_STAT\" | awk '/Pages free/ {print $3}' | tr -d '.')\n    PAGES_ACTIVE=$(echo \"$VM_STAT\" | awk '/Pages active/ {print $3}' | tr -d '.')\n    PAGES_INACTIVE=$(echo \"$VM_STAT\" | awk '/Pages inactive/ {print $3}' | tr -d '.')\n    PAGES_SPECULATIVE=$(echo \"$VM_STAT\" | awk '/Pages speculative/ {print $3}' | tr -d '.')\n    PAGES_WIRED=$(echo \"$VM_STAT\" | awk '/Pages wired down/ {print $4}' | tr -d '.')\n\n    # \u7a7a\u304d\u30e1\u30e2\u30ea\n    FREE_MEM=$(($PAGES_FREE + $PAGES_SPECULATIVE))\n\n    # \u4f7f\u7528\u4e2d\u30e1\u30e2\u30ea\n    USED_MEM=$(($PAGES_ACTIVE + $PAGES_INACTIVE + $PAGES_WIRED))\n\n    # \u5408\u8a08\n    TOTAL_MEM=$(($FREE_MEM + $USED_MEM))\n\n\n    # \u4f7f\u7528\u4e2d\u30e1\u30e2\u30ea(%)\n    #  \u5c0f\u6570\u70b9\u7b2c1\u4f4d\u307e\u3067\u6c42\u3081\u3066\u5f8c\u304b\u3089\u5c0f\u6570\u70b9\u6587\u5b57(\u30c9\u30c3\u30c8)\u3092\u633f\u5165\n    USED_MEM_PERCENT=$(echo \"$(($USED_MEM * 1000 / $TOTAL_MEM))\" | sed -e 's/\\(.*\\)\\([0-9]\\)/\\1.\\2/' -e 's/^\\./0./')\n    echo \"${USED_MEM_PERCENT}\"\n\n    # RET\n    return 0\n}\n\n# Debug\ndebug() {\n    if [ \"$DEBUG\" = \"yes\" ]; then\n        echo \"PAGES_FREE: $PAGES_FREE pages\"\n        echo \"PAGES_FREE: $(($PAGES_FREE * 4096 / 1024 / 1024 )) MB\"\n        echo \"PAGES_ACTIVE: $PAGES_ACTIVE pages\"\n        echo \"PAGES_ACTIVE: $(($PAGES_ACTIVE * 4096 / 1024 / 1024)) MB\"\n        echo \"PAGES_INACTIVE: $PAGES_INACTIVE pages\"\n        echo \"PAGES_INACTIVE: $(($PAGES_INACTIVE * 4096 / 1024 / 1024)) MB\"\n        echo \"PAGES_SPECULATIVE: $PAGES_SPECULATIVE pages\"\n        echo \"PAGES_SPECULATIVE: $(($PAGES_SPECULATIVE * 4096 / 1024 / 1024 )) MB\"\n        echo \"PAGES_WIRED: $PAGES_WIRED pages\"\n        echo \"PAGES_WIRED: $(($PAGES_WIRED * 4096 / 1024 / 1024)) MB\"\n        echo \"FREE_MEM: $FREE_MEM pages\"\n        echo \"FREE_MEM: $(($FREE_MEM * 4096 / 1024 / 1024)) MB\"\n        echo \"USED_MEM: $USED_MEM pages\"\n        echo \"USED_MEM: $(($USED_MEM * 4096 / 1024 / 1024)) MB\"\n        echo \"TOTAL_MEM: $TOTAL_MEM pages\"\n        echo \"TOTAL_MEM: $(($TOTAL_MEM * 4096 / 1024 / 1024)) MB\"\n        echo \"---------------\"\n        # \u642d\u8f09\u30e1\u30e2\u30ea(\u7406\u8ad6\u5024): 8GB\u306e\u5834\u5408\n        echo \"TOTAL_MEM: $((8 * 1024)) MB (Theoretical value)\"\n        echo \"---------------\"\n        echo \"USED_MEM: $(($USED_MEM * 1000 / $TOTAL_MEM)) %\"\n    fi\n}\n\nRET=0\n## \u30e1\u30a4\u30f3\u51e6\u7406 -----\ncalculate_used_mem\nRET=$?\n\n## \u30c7\u30d0\u30c3\u30b0 -----\n#DEBUG=yes debug\n\n## exit\nexit $RET\n\n\n\n\n\u4f5c\u6210\u3057\u305f\u30b9\u30af\u30ea\u30d7\u30c8\u306b\u5b9f\u884c\u6a29\u9650\u3092\u6e21\u3059\n\nTerminal\n\nchmod u+x used-mem pc-running-time loadaverage\n\n\n\n\n\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u306e\u7de8\u96c6\n\n~/.tmux.conf\n\n# \u30b9\u30c6\u30fc\u30bf\u30b9\u30e9\u30a4\u30f3 - Right\nset -g status-right '#[bg=yellow,bold] #(echo $LANG) #[bg=blue] up #(pc-running-time) #[bg=green] (#(loadaverage)) Mem #(used-mem)%% #[bg=red,bold] %y/%m/%d(%a)%H:%M:%S '\n\n# Right\u306e\u8868\u793a\u9818\u57df\u6700\u5927\u9577\nset -g status-right-length 90\n\n# \u6587\u5b57\u8272\u3068\u80cc\u666f\u8272\nset -g status-fg white\nset -g status-bg black\n\n\n\n\n\u53c2\u8003URL\nhttp://d.hatena.ne.jp/yonchu/20120414/1334422075\n\n\n###\u4f5c\u696d\u5834\u6240\u3078\u306e\u79fb\u52d5\n\n```ruby:Terminal\n\ncd /usr/local/bin\n\n```\n\n###\u8d77\u52d5\u6642\u9593\u3092\u53d6\u5f97\u3059\u308b\u30b9\u30af\u30ea\u30d7\u30c8\u306e\u4f5c\u6210\n\n```ruby:pc-running-time\n\n#!/bin/sh\nuptime | sed -e 's/.* up *\\(.*\\)/\\1/' -e 's/\\(.*\\),.* user.*/\\1/' | awk -F, '{print $1 $2}' | tr -s ' '\n\n```\n\n###\u30ed\u30fc\u30c9\u30a2\u30d9\u30ec\u30fc\u30b8\u3092\u53d6\u5f97\u3059\u308b\u30b9\u30af\u30ea\u30d7\u30c8\u306e\u4f5c\u6210\n\n```ruby:loadaverage\n\n#!/bin/sh\nuptime | awk -F\\  '{print $(NF - 2),$(NF - 1),$NF}'\n\n```\n\n###\u30e1\u30e2\u30ea\u4f7f\u7528\u7387\u3092\u53d6\u5f97\u3059\u308b\u30b9\u30af\u30ea\u30d7\u30c8\u306e\u4f5c\u6210\n\n```ruby:used-mem\n\n#!/bin/sh\n\n## debug mode\n#DEBUG=\"yes\"\nif [ \"$DEBUG\" = \"yes\" ]; then\n    set -x\nfi\n\n## vm_stat \u30b3\u30de\u30f3\u30c9\u306e\u30c1\u30a7\u30c3\u30af\nif ! type vm_stat > /dev/null 2>&1; then\n    exit 1\nfi\n\n#\n# \u30e1\u30e2\u30ea\u4f7f\u7528\u7387(%)\u3092\u6c42\u3081\u308b\n#   \u7cbe\u5ea6\u306f\u5c0f\u6570\u70b9\u7b2c1\u4f4d\u307e\u3067\u3068\u3059\u308b\n#\ncalculate_used_mem() {\n    # vm_stat\n    #  page size of 4096 bytes\n    VM_STAT=$(vm_stat)\n    PAGES_FREE=$(echo \"$VM_STAT\" | awk '/Pages free/ {print $3}' | tr -d '.')\n    PAGES_ACTIVE=$(echo \"$VM_STAT\" | awk '/Pages active/ {print $3}' | tr -d '.')\n    PAGES_INACTIVE=$(echo \"$VM_STAT\" | awk '/Pages inactive/ {print $3}' | tr -d '.')\n    PAGES_SPECULATIVE=$(echo \"$VM_STAT\" | awk '/Pages speculative/ {print $3}' | tr -d '.')\n    PAGES_WIRED=$(echo \"$VM_STAT\" | awk '/Pages wired down/ {print $4}' | tr -d '.')\n\n    # \u7a7a\u304d\u30e1\u30e2\u30ea\n    FREE_MEM=$(($PAGES_FREE + $PAGES_SPECULATIVE))\n\n    # \u4f7f\u7528\u4e2d\u30e1\u30e2\u30ea\n    USED_MEM=$(($PAGES_ACTIVE + $PAGES_INACTIVE + $PAGES_WIRED))\n\n    # \u5408\u8a08\n    TOTAL_MEM=$(($FREE_MEM + $USED_MEM))\n\n\n    # \u4f7f\u7528\u4e2d\u30e1\u30e2\u30ea(%)\n    #  \u5c0f\u6570\u70b9\u7b2c1\u4f4d\u307e\u3067\u6c42\u3081\u3066\u5f8c\u304b\u3089\u5c0f\u6570\u70b9\u6587\u5b57(\u30c9\u30c3\u30c8)\u3092\u633f\u5165\n    USED_MEM_PERCENT=$(echo \"$(($USED_MEM * 1000 / $TOTAL_MEM))\" | sed -e 's/\\(.*\\)\\([0-9]\\)/\\1.\\2/' -e 's/^\\./0./')\n    echo \"${USED_MEM_PERCENT}\"\n\n    # RET\n    return 0\n}\n\n# Debug\ndebug() {\n    if [ \"$DEBUG\" = \"yes\" ]; then\n        echo \"PAGES_FREE: $PAGES_FREE pages\"\n        echo \"PAGES_FREE: $(($PAGES_FREE * 4096 / 1024 / 1024 )) MB\"\n        echo \"PAGES_ACTIVE: $PAGES_ACTIVE pages\"\n        echo \"PAGES_ACTIVE: $(($PAGES_ACTIVE * 4096 / 1024 / 1024)) MB\"\n        echo \"PAGES_INACTIVE: $PAGES_INACTIVE pages\"\n        echo \"PAGES_INACTIVE: $(($PAGES_INACTIVE * 4096 / 1024 / 1024)) MB\"\n        echo \"PAGES_SPECULATIVE: $PAGES_SPECULATIVE pages\"\n        echo \"PAGES_SPECULATIVE: $(($PAGES_SPECULATIVE * 4096 / 1024 / 1024 )) MB\"\n        echo \"PAGES_WIRED: $PAGES_WIRED pages\"\n        echo \"PAGES_WIRED: $(($PAGES_WIRED * 4096 / 1024 / 1024)) MB\"\n        echo \"FREE_MEM: $FREE_MEM pages\"\n        echo \"FREE_MEM: $(($FREE_MEM * 4096 / 1024 / 1024)) MB\"\n        echo \"USED_MEM: $USED_MEM pages\"\n        echo \"USED_MEM: $(($USED_MEM * 4096 / 1024 / 1024)) MB\"\n        echo \"TOTAL_MEM: $TOTAL_MEM pages\"\n        echo \"TOTAL_MEM: $(($TOTAL_MEM * 4096 / 1024 / 1024)) MB\"\n        echo \"---------------\"\n        # \u642d\u8f09\u30e1\u30e2\u30ea(\u7406\u8ad6\u5024): 8GB\u306e\u5834\u5408\n        echo \"TOTAL_MEM: $((8 * 1024)) MB (Theoretical value)\"\n        echo \"---------------\"\n        echo \"USED_MEM: $(($USED_MEM * 1000 / $TOTAL_MEM)) %\"\n    fi\n}\n\nRET=0\n## \u30e1\u30a4\u30f3\u51e6\u7406 -----\ncalculate_used_mem\nRET=$?\n\n## \u30c7\u30d0\u30c3\u30b0 -----\n#DEBUG=yes debug\n\n## exit\nexit $RET\n\n```\n\n\n###\u4f5c\u6210\u3057\u305f\u30b9\u30af\u30ea\u30d7\u30c8\u306b\u5b9f\u884c\u6a29\u9650\u3092\u6e21\u3059\n\n```ruby:Terminal\n\nchmod u+x used-mem pc-running-time loadaverage\n\n```\n\n\n\n###\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u306e\u7de8\u96c6\n\n```ruby:~/.tmux.conf\n\n# \u30b9\u30c6\u30fc\u30bf\u30b9\u30e9\u30a4\u30f3 - Right\nset -g status-right '#[bg=yellow,bold] #(echo $LANG) #[bg=blue] up #(pc-running-time) #[bg=green] (#(loadaverage)) Mem #(used-mem)%% #[bg=red,bold] %y/%m/%d(%a)%H:%M:%S '\n\n# Right\u306e\u8868\u793a\u9818\u57df\u6700\u5927\u9577\nset -g status-right-length 90\n\n# \u6587\u5b57\u8272\u3068\u80cc\u666f\u8272\nset -g status-fg white\nset -g status-bg black\n\n```\n\n\n###\u53c2\u8003URL\nhttp://d.hatena.ne.jp/yonchu/20120414/1334422075\n\n\n\n\n", "tags": ["tmux", "Zsh", "Mac"]}