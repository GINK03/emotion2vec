{"context": "\n\n\u3053\u308c\u306a\u306b\nPython \u3092\u4f7f\u3063\u3066\u3001\u7121\u6599\u3067 PDF \u3092\u7de8\u96c6\u3059\u308b\u65b9\u6cd5 \u3092\u7d39\u4ecb\u3057\u307e\u3059\u3002\n\u30b5\u30f3\u30d7\u30eb\u3068\u3057\u3066\u3001\u5404\u30da\u30fc\u30b8\u306b\u30da\u30fc\u30b8\u756a\u53f7\u3092\u8ffd\u52a0\u3057\u3066\u307f\u307e\u3059\u3002\n\n\n\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\u4e0b\u8a18\u3092\u4f7f\u7528\u3057\u307e\u3059\u3002\n\n\nReportLab: Python\u7528\u3001PDF\u751f\u6210\u30e9\u30a4\u30d6\u30e9\u30ea\u3002\u6709\u6599\u7248\u3068\u7121\u6599\u7248\u304c\u3042\u308b\u3002\n\nPyPDF2: Page\u5358\u4f4d\u306ePDF\u7de8\u96c6\u30e9\u30a4\u30d6\u30e9\u30ea\u3002\n\nPdfFormFiller: PDF\u306b\u30c6\u30ad\u30b9\u30c8\u3092\u633f\u5165\u3059\u308b\u30e9\u30a4\u30d6\u30e9\u30ea\u3002\n\n\n\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\nconda install -y reportlab\npip install PyPDF2 pdfformfiller\n\n\nAnaconda \u3092\u4f7f\u3063\u3066\u3044\u306a\u3044\u5834\u5408\u306f\u3001conda \u306e\u4ee3\u308f\u308a\u306b pip \u3092\u4f7f\u3063\u3066\u304f\u3060\u3055\u3044\u3002\n\n\u30da\u30fc\u30b8\u756a\u53f7\u3092\u8ffd\u52a0\u3059\u308b\u30b5\u30f3\u30d7\u30eb\n\u65e5\u672c\u8a9e\u30d5\u30a9\u30f3\u30c8\u3068\u3057\u3066\u3001IPAexGothic \u30d5\u30a9\u30f3\u30c8\u3092\u4f7f\u3063\u3066\u3044\u307e\u3059\u304c\u3001\u5225\u306e\u30d5\u30a9\u30f3\u30c8\u3067\u3082\u69cb\u3044\u307e\u305b\u3093\u3002\n(Ubuntu \u3067\u306f\u3001apt-get install fonts-ipaexfont \u3067\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3067\u304d\u307e\u3059)\n\u6ce8\u610f\u70b9\u3068\u3057\u3066\u3001\u7528\u7d19\u30b5\u30a4\u30ba\u3092\u8868\u3059 PyPDF2.pdf.PageObject.mediaBox \u306e\u8981\u7d20\u3067\u3042\u308b FloatObject \u304c Decimal\u3092\u8fd4\u3059\u305f\u3081\u3001\u5b9f\u6570\u3068\u306e\u52a0\u6e1b\u6f14\u7b97\u3067\u30a8\u30e9\u30fc\u306b\u306a\u308a\u307e\u3059\u3002\u3053\u3053\u3067\u306f\u3001\u7121\u7406\u3084\u308a\u3001FloatObject \u304c\u5b9f\u6570\u3068\u52a0\u6e1b\u6f14\u7b97\u3067\u304d\u308b\u3088\u3046\u306b\u7f6e\u304d\u63db\u3048\u3066\u3044\u307e\u3059\u3002\naddPage(\u5165\u529b\u30d5\u30a1\u30a4\u30eb, \u51fa\u529b\u30d5\u30a1\u30a4\u30eb) \u3068\u3059\u308b\u3068\u3001\u5143\u306ePDF\u306b\u3001\u30da\u30fc\u30b8\u756a\u53f7\u3092\u8ffd\u52a0\u3057\u305fPDF\u3092\u4f5c\u6210\u3067\u304d\u307e\u3059\u3002\n\npython\nimport PyPDF2\nclass FloatObject(PyPDF2.generic.FloatObject):\n    def __add__(self, other):\n        return self.as_numeric() + other\n    def __radd__(self, other):\n        return self.as_numeric() + other\n    def __sub__(self, other):\n        return self.as_numeric() - other\n    def __rsub__(self, other):\n        return -self.as_numeric() + other\nPyPDF2.generic.FloatObject = FloatObject\n\nfrom reportlab.lib.styles import ParagraphStyle\nfrom reportlab.lib.enums import TA_CENTER\nfrom reportlab.pdfbase import pdfmetrics\nfrom reportlab.pdfbase.ttfonts import TTFont\nfrom pdfformfiller import PdfFormFiller\n\ndef addPage(infile, outfile):\n    # Linux\u3067\u306f\u3001'/usr/share/fonts/opentype/ipaexfont-gothic/ipaexg.ttf'\u306a\u3069\n    pdfmetrics.registerFont(TTFont('IPAexGothic', 'c:/Windows/Fonts/ipaexg.ttf'))\n    sty = ParagraphStyle('sty', alignment=TA_CENTER, fontName='IPAexGothic', fontSize=9)\n    ff = PdfFormFiller(infile)\n    for i in range(ff.pdf.getNumPages()):\n        p = ff.pdf.getPage(i)\n        ff.add_text('\u30da\u30fc\u30b8 %d'%(i+1), i, (0,p.mediaBox[3]-30), p.mediaBox.getUpperRight(), sty)\n    ff.write(outfile)\n\n\n\nWindows, Ubuntu, Alpine-Linux \u3067\u7a3c\u50cd\u78ba\u8a8d\u3057\u3066\u3044\u307e\u3059\u3002\n\n\u4ee5\u4e0a\n# \u3053\u308c\u306a\u306b\n**Python** \u3092\u4f7f\u3063\u3066\u3001**\u7121\u6599\u3067 PDF \u3092\u7de8\u96c6\u3059\u308b\u65b9\u6cd5** \u3092\u7d39\u4ecb\u3057\u307e\u3059\u3002\n\u30b5\u30f3\u30d7\u30eb\u3068\u3057\u3066\u3001\u5404\u30da\u30fc\u30b8\u306b\u30da\u30fc\u30b8\u756a\u53f7\u3092\u8ffd\u52a0\u3057\u3066\u307f\u307e\u3059\u3002\n\n![image](https://qiita-image-store.s3.amazonaws.com/0/13955/15a7359a-2eb4-d8eb-1df5-101ef461a52c.png)\n\n# \u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\u4e0b\u8a18\u3092\u4f7f\u7528\u3057\u307e\u3059\u3002\n\n- [ReportLab](http://www.reportlab.com/): Python\u7528\u3001PDF\u751f\u6210\u30e9\u30a4\u30d6\u30e9\u30ea\u3002\u6709\u6599\u7248\u3068\u7121\u6599\u7248\u304c\u3042\u308b\u3002\n- [PyPDF2](http://pythonhosted.org/PyPDF2/): Page\u5358\u4f4d\u306ePDF\u7de8\u96c6\u30e9\u30a4\u30d6\u30e9\u30ea\u3002\n- [PdfFormFiller](https://pdfformfiller.readthedocs.io/en/latest/): PDF\u306b\u30c6\u30ad\u30b9\u30c8\u3092\u633f\u5165\u3059\u308b\u30e9\u30a4\u30d6\u30e9\u30ea\u3002\n\n```bash:\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\nconda install -y reportlab\npip install PyPDF2 pdfformfiller\n```\n\n[Anaconda](https://www.continuum.io/downloads) \u3092\u4f7f\u3063\u3066\u3044\u306a\u3044\u5834\u5408\u306f\u3001conda \u306e\u4ee3\u308f\u308a\u306b pip \u3092\u4f7f\u3063\u3066\u304f\u3060\u3055\u3044\u3002\n\n# \u30da\u30fc\u30b8\u756a\u53f7\u3092\u8ffd\u52a0\u3059\u308b\u30b5\u30f3\u30d7\u30eb\n\u65e5\u672c\u8a9e\u30d5\u30a9\u30f3\u30c8\u3068\u3057\u3066\u3001[IPAexGothic \u30d5\u30a9\u30f3\u30c8](http://ipafont.ipa.go.jp/)\u3092\u4f7f\u3063\u3066\u3044\u307e\u3059\u304c\u3001\u5225\u306e\u30d5\u30a9\u30f3\u30c8\u3067\u3082\u69cb\u3044\u307e\u305b\u3093\u3002\n(Ubuntu \u3067\u306f\u3001apt-get install fonts-ipaexfont \u3067\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3067\u304d\u307e\u3059)\n\n\u6ce8\u610f\u70b9\u3068\u3057\u3066\u3001\u7528\u7d19\u30b5\u30a4\u30ba\u3092\u8868\u3059 PyPDF2.pdf.PageObject.mediaBox \u306e\u8981\u7d20\u3067\u3042\u308b FloatObject \u304c Decimal\u3092\u8fd4\u3059\u305f\u3081\u3001\u5b9f\u6570\u3068\u306e\u52a0\u6e1b\u6f14\u7b97\u3067\u30a8\u30e9\u30fc\u306b\u306a\u308a\u307e\u3059\u3002\u3053\u3053\u3067\u306f\u3001\u7121\u7406\u3084\u308a\u3001FloatObject \u304c\u5b9f\u6570\u3068\u52a0\u6e1b\u6f14\u7b97\u3067\u304d\u308b\u3088\u3046\u306b\u7f6e\u304d\u63db\u3048\u3066\u3044\u307e\u3059\u3002\n\naddPage(\u5165\u529b\u30d5\u30a1\u30a4\u30eb, \u51fa\u529b\u30d5\u30a1\u30a4\u30eb) \u3068\u3059\u308b\u3068\u3001\u5143\u306ePDF\u306b\u3001\u30da\u30fc\u30b8\u756a\u53f7\u3092\u8ffd\u52a0\u3057\u305fPDF\u3092\u4f5c\u6210\u3067\u304d\u307e\u3059\u3002\n\n```py3:python\nimport PyPDF2\nclass FloatObject(PyPDF2.generic.FloatObject):\n    def __add__(self, other):\n        return self.as_numeric() + other\n    def __radd__(self, other):\n        return self.as_numeric() + other\n    def __sub__(self, other):\n        return self.as_numeric() - other\n    def __rsub__(self, other):\n        return -self.as_numeric() + other\nPyPDF2.generic.FloatObject = FloatObject\n\nfrom reportlab.lib.styles import ParagraphStyle\nfrom reportlab.lib.enums import TA_CENTER\nfrom reportlab.pdfbase import pdfmetrics\nfrom reportlab.pdfbase.ttfonts import TTFont\nfrom pdfformfiller import PdfFormFiller\n\ndef addPage(infile, outfile):\n    # Linux\u3067\u306f\u3001'/usr/share/fonts/opentype/ipaexfont-gothic/ipaexg.ttf'\u306a\u3069\n    pdfmetrics.registerFont(TTFont('IPAexGothic', 'c:/Windows/Fonts/ipaexg.ttf'))\n    sty = ParagraphStyle('sty', alignment=TA_CENTER, fontName='IPAexGothic', fontSize=9)\n    ff = PdfFormFiller(infile)\n    for i in range(ff.pdf.getNumPages()):\n        p = ff.pdf.getPage(i)\n        ff.add_text('\u30da\u30fc\u30b8 %d'%(i+1), i, (0,p.mediaBox[3]-30), p.mediaBox.getUpperRight(), sty)\n    ff.write(outfile)\n```\n\n- Windows, Ubuntu, Alpine-Linux \u3067\u7a3c\u50cd\u78ba\u8a8d\u3057\u3066\u3044\u307e\u3059\u3002\n\n\u4ee5\u4e0a\n", "tags": ["PDF", "Python", "PyPDF2", "reportlab", "pdfformfiller"]}