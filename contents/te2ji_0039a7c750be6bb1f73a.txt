{"context": "\u30b5\u30fc\u30d3\u30b9\u306e\u30ea\u30b9\u30bf\u30fc\u30c8\u7528\u306e\u30b7\u30a7\u30eb\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u7528\u610f\u3057\u305f\u306e\u3067\u305d\u306e\u30e1\u30e2\n#!/bin/sh\n\nif [ $$ != `pgrep -fo $0`  ]; then\necho `basename $0` is already running.\nexit 1\nfi\n\nrestart(){\nwhile read i\ndo\n   echo $i | grep \" 499 \" | grep -v \"\u9664\u5916\u6761\u4ef6\"\n if [ $? = \"0\" ];then\n   sudo -S /etc/rc.d/init.d/php-fpm restart\n fi\ndone\n}\n\ntail -n 0 --follow=name --retry /var/log/nginx/access.log | restart\n\n\u539f\u56e0\u4e0d\u660e\u306e http status code 499 \u3067\u30b5\u30fc\u30d3\u30b9\u63d0\u4f9b\u304c\u505c\u6b62\u3057\u3066\u3057\u307e\u3046\u73fe\u8c61\u304c\u767a\u751f\u4e2d\u3002php-fpm \u306e\u30ea\u30b9\u30bf\u30fc\u30c8\u3067\u3001\u3068\u308a\u3042\u3048\u305a\u5fa9\u65e7\u3059\u308b\u306e\u3067\u3001\u66ab\u5b9a\u5bfe\u5fdc\u306e\u305f\u3081\u4f5c\u6210\u3002\u305f\u307e\u306b\u4f7f\u3044\u305f\u304f\u306a\u308b\u6642\u304c\u3042\u308b\u306f\u305a\u306a\u306e\u3067\u30e1\u30e2\u3092\u6b8b\u3059\u3002\n\u30b7\u30a7\u30eb\u30b9\u30af\u30ea\u30d7\u30c8\u306f\u82e6\u624b\u3060\u308f\u3002\u3002\u3002\n\u524d\u534a\u304c\u91cd\u8907\u8d77\u52d5\u6291\u6b62\u306e\u305f\u3081\u306e\u30b9\u30af\u30ea\u30d7\u30c8\u3002\u5f8c\u534a\u304c\u30ea\u30b9\u30bf\u30fc\u30c8\u7528\u3002\ntail -f \u3092\u53d7\u3051\u3001499 \u306b\u5408\u81f4\u3057\u3001\u9664\u5916\u6761\u4ef6\u3092\u542b\u307e\u306a\u3044\u3082\u306e\u304c\u6765\u305f\u6642\u3001php-fpm \u306e\u30ea\u30b9\u30bf\u30fc\u30c8\u3092\u5b9f\u884c\u3002\n\u30b5\u30fc\u30d3\u30b9\u306e\u30ea\u30b9\u30bf\u30fc\u30c8\u7528\u306e\u30b7\u30a7\u30eb\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u7528\u610f\u3057\u305f\u306e\u3067\u305d\u306e\u30e1\u30e2\n\n```bash\n#!/bin/sh\n\nif [ $$ != `pgrep -fo $0`  ]; then\necho `basename $0` is already running.\nexit 1\nfi\n\nrestart(){\nwhile read i\ndo\n   echo $i | grep \" 499 \" | grep -v \"\u9664\u5916\u6761\u4ef6\"\n if [ $? = \"0\" ];then\n   sudo -S /etc/rc.d/init.d/php-fpm restart\n fi\ndone\n}\n\ntail -n 0 --follow=name --retry /var/log/nginx/access.log | restart\n```\n\u539f\u56e0\u4e0d\u660e\u306e http status code 499 \u3067\u30b5\u30fc\u30d3\u30b9\u63d0\u4f9b\u304c\u505c\u6b62\u3057\u3066\u3057\u307e\u3046\u73fe\u8c61\u304c\u767a\u751f\u4e2d\u3002php-fpm \u306e\u30ea\u30b9\u30bf\u30fc\u30c8\u3067\u3001\u3068\u308a\u3042\u3048\u305a\u5fa9\u65e7\u3059\u308b\u306e\u3067\u3001\u66ab\u5b9a\u5bfe\u5fdc\u306e\u305f\u3081\u4f5c\u6210\u3002\u305f\u307e\u306b\u4f7f\u3044\u305f\u304f\u306a\u308b\u6642\u304c\u3042\u308b\u306f\u305a\u306a\u306e\u3067\u30e1\u30e2\u3092\u6b8b\u3059\u3002\n\n\u30b7\u30a7\u30eb\u30b9\u30af\u30ea\u30d7\u30c8\u306f\u82e6\u624b\u3060\u308f\u3002\u3002\u3002\n\u524d\u534a\u304c\u91cd\u8907\u8d77\u52d5\u6291\u6b62\u306e\u305f\u3081\u306e\u30b9\u30af\u30ea\u30d7\u30c8\u3002\u5f8c\u534a\u304c\u30ea\u30b9\u30bf\u30fc\u30c8\u7528\u3002\ntail -f \u3092\u53d7\u3051\u3001499 \u306b\u5408\u81f4\u3057\u3001\u9664\u5916\u6761\u4ef6\u3092\u542b\u307e\u306a\u3044\u3082\u306e\u304c\u6765\u305f\u6642\u3001php-fpm \u306e\u30ea\u30b9\u30bf\u30fc\u30c8\u3092\u5b9f\u884c\u3002\n", "tags": ["\u30b7\u30a7\u30eb\u30b9\u30af\u30ea\u30d7\u30c8", "\u30b5\u30fc\u30d3\u30b9\u518d\u8d77\u52d5", "\u30ed\u30b0\u76e3\u8996"]}