{"context": "\u3053\u306e\u524d\u306e\u6295\u7a3f\u300e\u30b5\u30c3\u30ab\u30fc\u8a66\u5408\u306e\u7d50\u679c\u300e\u52dd\u30fb\u5206\u30fb\u8ca0\u300f\u3067\u3001\u305d\u308c\u305e\u308c\u306e\u51fa\u308b\u78ba\u7387\u304c1/3\u306b\u306a\u308b\uff1f\u300f\u3067\nhttp://qiita.com/xuyun19840618/items/087f55ba5c4bb2b90b9d\n\u5168\u3066\u306e\u8981\u7d20\u304c\u540c\u3058\u3067\u3042\u308b\u4e21\u30c1\u30fc\u30e0\u306e\u5bfe\u6226\u3067\u3001\u5f15\u5206\u306e\u7d50\u679c\u304c\u51fa\u308b\u78ba\u7387\u304c 1/31/3 \u3067\u306f\u306a\u3044\u3068\u5206\u304b\u308a\u307e\u3057\u305f\u3002\n\u8981\u7d20\u304c\u9055\u3046\u4e21\u30c1\u30fc\u30e0\u306e\u5bfe\u6226\u3067\u3001\u52dd\u5206\u6557\u304c\u51fa\u308b\u78ba\u7387\u306e\u7406\u8ad6\u5024\u3082\u8a08\u7b97\u3067\u304d\u307e\u3059\u3002\u3055\u3089\u306b\u3001\u5b9f\u969b\u306e\u5404\u30ea\u30fc\u30b0\u306e\u30c7\u30fc\u30bf\u3092\u4f7f\u3044\u3001\u691c\u8a3c\u3057\u3066\u307f\u307e\u3059\u3002\n\n\u3044\u304f\u3064\u304b\u306e\u56fd\u306e1\u6b21\u30ea\u30fc\u30b0\u904e\u53bb10\u5e74\u306e\u30c7\u30fc\u30bf\n\u30b7\u30fc\u30ba\u30f32015:\u30e8\u30fc\u30ed\u30c3\u30d1\u5404\u56fd\u306e\u30ea\u30fc\u30b0\u306f2015~2016\u3068\u3001\u30a2\u30b8\u30a2\u5404\u56fd\u306f2015\u3068\u306a\u308a\u307e\u3059\u3002\n\u52dd\u7387\u3001\u5206\u7387\u3001\u6557\u7387\uff1a\u30db\u30fc\u30e0\u30c1\u30fc\u30e0\u306e\u52dd\u7387\u3001\u5206\u7387\u3001\u6557\u7387\u3068\u306a\u308a\u307e\u3059\u3002\n\u653b\u6483\u529b\uff1a\u3053\u3053\u3067\u516c\u958b\u3057\u307e\u305b\u3093\u3002\nEngland,Italy,Spain,France\uff1a\u30c1\u30fc\u30e0\u6570\u300020\u3001\u3000\u7bc0\u6570\u300038\nGermany,Japan\uff1a\u30c1\u30fc\u30e0\u6570\u300018\u3001\u3000\u7bc0\u6570\u300034\nChina(\u904e\u53bb8\u5e74)\uff1a\u30c1\u30fc\u30e0\u6570\u300016\u3001\u3000\u7bc0\u6570\u300030\n\n\n\n10\u5e74\u9593\u5e73\u5747\n\u52dd\u7387\n\u5206\u7387\n\u6557\u7387\n\u653b\u6483\u529bhome\n\u653b\u6483\u529baway\n\n\n\n\nEngland\n0.4600\n0.2582\n0.2818\n1.5389\n1.1382\n\n\nItaly\n0.4640\n0.2716\n0.2645\n1.4974\n1.1041\n\n\nSpain\n0.4839\n0.2340\n0.2821\n1.5965\n1.1341\n\n\nGermany\n0.4523\n0.2464\n0.3013\n1.6149\n1.2610\n\n\nFrance\n0.4490\n0.2874\n0.2637\n1.3886\n1.0195\n\n\nJapan\n0.4310\n0.2372\n0.3317\n1.4932\n1.2606\n\n\nChina\n0.4552\n0.3010\n0.2437\n1.4763\n1.0673\n\n\n\n> England\n       \u52dd\u7387   \u5206\u7387   \u6557\u7387 \u3000\u3000\u653b\u6483\u529bhome \u653b\u6483\u529baway\n2015 0.4132 0.2816 0.3053     1.4918     1.2078\n2014 0.4526 0.2447 0.3026     1.4738     1.0928\n2013 0.4711 0.2053 0.3237     1.5730     1.1948\n2012 0.4368 0.2842 0.2789     1.5578     1.2398\n2011 0.4500 0.2447 0.3053     1.5893     1.2150\n2010 0.4711 0.2921 0.2368     1.6240     1.1740\n2009 0.5079 0.2526 0.2395     1.6975     1.0735\n2008 0.4553 0.2553 0.2895     1.4003     1.0790\n2007 0.4632 0.2632 0.2737     1.5288     1.1073\n2006 0.4789 0.2579 0.2632     1.4525     0.9975\n\n> Italy\n       \u52dd\u7387   \u5206\u7387   \u6557\u7387     \u653b\u6483\u529bhome \u653b\u6483\u529baway\n2015 0.4605 0.2500 0.2895     1.4718     1.1055\n2014 0.4000 0.3158 0.2842     1.5003     1.1948\n2013 0.4763 0.2368 0.2868     1.5365     1.1868\n2012 0.4658 0.2526 0.2816     1.4948     1.1443\n2011 0.4553 0.2921 0.2526     1.4968     1.0605\n2010 0.4711 0.2553 0.2737     1.4310     1.0815\n2009 0.4895 0.2684 0.2421     1.5420     1.0683\n2008 0.5053 0.2500 0.2447     1.5205     1.0785\n2007 0.4605 0.2947 0.2447     1.4910     1.0608\n2006 0.4553 0.3000 0.2447     1.4898     1.0598\n\n> Spain\n       \u52dd\u7387   \u5206\u7387   \u6557\u7387     \u653b\u6483\u529bhome \u653b\u6483\u529baway\n2015 0.4816 0.2421 0.2763     1.6190     1.1263\n2014 0.4500 0.2395 0.3105     1.5365     1.1183\n2013 0.4711 0.2263 0.3026     1.6318     1.1180\n2012 0.4974 0.2211 0.2816     1.6878     1.1853\n2011 0.4947 0.2474 0.2579     1.6783     1.0835\n2010 0.5184 0.2079 0.2737     1.6373     1.1053\n2009 0.5105 0.2500 0.2395     1.6003     1.1133\n2008 0.4842 0.2184 0.2974     1.6600     1.2378\n2007 0.4789 0.2289 0.2921     1.5503     1.1378\n2006 0.4526 0.2579 0.2895     1.3640     1.1155\n\n> Germany\n       \u52dd\u7387   \u5206\u7387   \u6557\u7387     \u653b\u6483\u529bhome \u653b\u6483\u529baway\n2015 0.4412 0.2320 0.3268     1.5644     1.2642\n2014 0.4739 0.2680 0.2582     1.5886     1.1664\n2013 0.4739 0.2092 0.3170     1.7492     1.4119\n2012 0.4248 0.2549 0.3203     1.5917     1.3431\n2011 0.4542 0.2582 0.2876     1.6606     1.2006\n2010 0.4608 0.2059 0.3333     1.6469     1.2739\n2009 0.4085 0.2810 0.3105     1.5136     1.3164\n2008 0.4804 0.2418 0.2778     1.6992     1.2222\n2007 0.4673 0.2549 0.2778     1.6703     1.1406\n2006 0.4379 0.2582 0.3039     1.4644     1.2706\n\n> France\n       \u52dd\u7387   \u5206\u7387   \u6557\u7387     \u653b\u6483\u529bhome \u653b\u6483\u529baway\n2015 0.4211 0.2842 0.2947     1.4370     1.0890\n2014 0.4763 0.2316 0.2921     1.4110     1.0813\n2013 0.4395 0.2842 0.2763     1.4100     1.0480\n2012 0.4474 0.2842 0.2684     1.4683     1.0763\n2011 0.4711 0.2842 0.2447     1.4748     1.0418\n2010 0.4132 0.3421 0.2447     1.3425     0.9988\n2009 0.4711 0.2553 0.2737     1.3893     1.0210\n2008 0.4342 0.2947 0.2711     1.2870     0.9703\n2007 0.4395 0.3053 0.2553     1.3480     0.9363\n2006 0.4763 0.3079 0.2158     1.3180     0.9318\n\n> Japan\n       \u52dd\u7387   \u5206\u7387   \u6557\u7387     \u653b\u6483\u529bhome \u653b\u6483\u529baway\n2015 0.3856 0.2451 0.3693     1.4111     1.2675\n2014 0.4085 0.2516 0.3399     1.3497     1.1803\n2013 0.4641 0.2222 0.3137     1.5656     1.3072\n2012 0.4052 0.2484 0.3464     1.5025     1.2914\n2011 0.4346 0.2451 0.3203     1.5489     1.2911\n2010 0.4281 0.2614 0.3105     1.4247     1.2322\n2009 0.4314 0.2614 0.3072     1.4281     1.1569\n2008 0.4477 0.2288 0.3235     1.4153     1.1439\n2007 0.4346 0.2092 0.3562     1.5486     1.2839\n2006 0.4706 0.1993 0.3301     1.7378     1.4511\n\n> China\n       \u52dd\u7387   \u5206\u7387   \u6557\u7387     \u653b\u6483\u529bhome \u653b\u6483\u529baway\n2015 0.4292 0.2875 0.2833     1.5831     1.2175\n2014 0.4042 0.2792 0.3167     1.5041     1.2453\n2013 0.4708 0.2792 0.2500     1.5491     1.0828\n2012 0.4750 0.3042 0.2208     1.5625     1.0625\n2011 0.4750 0.2958 0.2292     1.4044     0.9466\n2010 0.4250 0.3292 0.2458     1.3453     1.0750\n2009 0.5042 0.3250 0.1708     1.3953     0.8372\n2008 0.4583 0.3083 0.2333     1.4666     1.0713\n\n\n\u52dd\u5206\u6557\u7387\u306e\u7406\u8ad6\u5024\u3092\u8a08\u7b97\u3059\u308b\nW,D,L\uff1a\u52dd\u3001\u5206\u3001\u6557\u306e\u7406\u8ad6\u5024\n\u52dd\u7387\u3001\u5206\u7387\u3001\u6557\u7387\uff1a\u5b9f\u969b\u30c7\u30fc\u30bf\u3067\u3001\u52dd\u5206\u6557\u306e\u5272\u5408\n           W      D      L     \u52dd\u7387   \u5206\u7387   \u6557\u7387     \u653b\u6483\u529bhome \u653b\u6483\u529baway\nEngland 0.4658 0.2540 0.2802 0.4600 0.2582 0.2818     1.5389     1.1382\nItaly   0.4631 0.2584 0.2786 0.4640 0.2716 0.2645     1.4974     1.1041\nSpain   0.4813 0.2493 0.2694 0.4839 0.2340 0.2821     1.5965     1.1341\nGermany 0.4569 0.2454 0.2977 0.4523 0.2464 0.3013     1.6149     1.2610\nFrance  0.4542 0.2707 0.2751 0.4490 0.2874 0.2637     1.3886     1.0195\nJapan   0.4264 0.2541 0.3195 0.4310 0.2372 0.3317     1.4932     1.2606\nChina   0.4662 0.2611 0.2726 0.4552 0.3010 0.2437     1.4763     1.0673\n\n\nTotal\n7\u304b\u56fd\u306e\u30ea\u30fc\u30b0\u904e\u53bb10\u5e74\u9593\u3067Total 23240\u8a66\u5408\u3092\u898b\u3066\u307f\u307e\u3057\u3087\u3046\u3002\n\u52a0\u91cd\u5e73\u5747\u3092\u53d6\u308a\u307e\u3059\u3002\n   W          D          L        \u52dd\u7387       \u5206\u7387        \u6557\u7387    \u653b\u6483\u529bhome \u653b\u6483\u529baway \n0.4597     0.2559     0.2844     0.4575     0.2604     0.2821     1.5158     1.1390 \n\n\n\u7d50\u8ad6\n\u30b5\u30c3\u30ab\u30fc\u8a66\u5408\u306e\u52dd\u5206\u6557\u7387\u306e\u4e88\u60f3\u304c\u51fa\u6765\u307e\u3059\u3002\n\n\u30b3\u30fc\u30c9\n\nsoccer.R\nsetwd(\"C:/R\")\nData <- read.table( \"soccer_data.csv\", header = FALSE, sep=\",\" )\nrownames(Data) <- c(2015:2006)\ncolnames(Data) <- rep( c(\"\u52dd\u7387\",\"\u5206\u7387\",\"\u6557\u7387\",\"\u653b\u6483\u529bhome\",\"\u653b\u6483\u529baway\"), length.out = 35 )\n\nEngland <- Data[,1:5]\nEngland.mean <- round( apply(England, 2, mean), 4 )\n\nItaly <- Data[,6:10]\nItaly.mean <- round( apply(Italy, 2, mean), 4 )\n\nGermany <- Data[,11:15]\nGermany.mean <- round( apply(Germany, 2, mean), 4 )\n\nSpain <- Data[,16:20]\nSpain.mean <- round( apply(Spain, 2, mean), 4 )\n\nFrance <- Data[,21:25]\nFrance.mean <- round( apply(France, 2, mean), 4 )\n\nJapan <- Data[,26:30]\nJapan.mean <- round( apply(Japan, 2, mean), 4 )\n\nChina <- Data[1:8,31:35]\nChina.mean <- round( apply(China, 2, mean), 4 )\n\nData.mean <- rbind(England.mean, Italy.mean, Spain.mean, Germany.mean, France.mean, Japan.mean, China.mean)\n\nt <- 90  \nprob <- Data.mean[,4:5]/t\n\n# ========================================================\nk <- 10\nprob_matrix <- matrix(0,k,4)\ncolnames(prob_matrix) <- c(\"goals\",\"W\",\"D\",\"L\")\nprob_matrix[,1] <- c(1:10)-1\n\nFun <- function(x){\n  fun <- function(y){\n    c(dbinom(y[1],t,x[1]),dbinom(y[1],t,x[2]))\n  }\n  kv <- apply(prob_matrix,1,fun)\n  for (i in 2:(k-1)){\n    prob_matrix[i,\"D\"] <- kv[1,i]*kv[2,i]\n    prob_matrix[i,\"W\"] <- kv[1,i]*sum(kv[2,(1:(i-1))])\n    prob_matrix[i,\"L\"] <- kv[1,i]*sum(kv[2,((i+1):k)])\n  }\n  prob_matrix[1,\"D\"] <- kv[1,1]*kv[2,1]\n  prob_matrix[1,\"L\"] <- kv[1,1]*sum(kv[2,2:k])\n  prob_matrix[k,\"D\"] <- kv[1,k]*kv[2,k]\n  prob_matrix[k,\"W\"] <- kv[1,k]*sum(kv[2,1:(k-1)])\n  apply(prob_matrix[,c(\"W\",\"D\",\"L\")],2,sum)\n}\u3000# \u95a2\u6570\u3092\u5b9a\u7fa9\u3059\u308b\n# ====================================================\n\npred <- t(round(apply(prob,1,Fun),4))\n\ncbind(pred,Data.mean)\n# ====================================================\nData.total <- round(\n              ( (England.mean + Italy.mean + Spain.mean + France.mean) * 20 * 38 * 10 *0.5 \n              + (Germany.mean + Japan.mean) * 18 * 34 * 10 *0.5 + China.mean * 16 * 30 * 8 *0.5 ) / \n              (20 * 38 * 10 * 0.5 * 4 + 18 * 34 * 10 * 0.5 * 2 + 16 * 30 * 8 * 0.5)\n              , 4 )  # \u52a0\u91cd\u5e73\u5747\nprob.total <- Data.total[4:5] / t\npred.total <- round( Fun(prob.total),4 )\n\nc(pred.total, Data.total)\n\n\n\u3053\u306e\u524d\u306e\u6295\u7a3f\u300e\u30b5\u30c3\u30ab\u30fc\u8a66\u5408\u306e\u7d50\u679c\u300e\u52dd\u30fb\u5206\u30fb\u8ca0\u300f\u3067\u3001\u305d\u308c\u305e\u308c\u306e\u51fa\u308b\u78ba\u7387\u304c1/3\u306b\u306a\u308b\uff1f\u300f\u3067\nhttp://qiita.com/xuyun19840618/items/087f55ba5c4bb2b90b9d\n\u5168\u3066\u306e\u8981\u7d20\u304c\u540c\u3058\u3067\u3042\u308b\u4e21\u30c1\u30fc\u30e0\u306e\u5bfe\u6226\u3067\u3001\u5f15\u5206\u306e\u7d50\u679c\u304c\u51fa\u308b\u78ba\u7387\u304c $1/3$ \u3067\u306f\u306a\u3044\u3068\u5206\u304b\u308a\u307e\u3057\u305f\u3002\n\u8981\u7d20\u304c\u9055\u3046\u4e21\u30c1\u30fc\u30e0\u306e\u5bfe\u6226\u3067\u3001\u52dd\u5206\u6557\u304c\u51fa\u308b\u78ba\u7387\u306e\u7406\u8ad6\u5024\u3082\u8a08\u7b97\u3067\u304d\u307e\u3059\u3002\u3055\u3089\u306b\u3001\u5b9f\u969b\u306e\u5404\u30ea\u30fc\u30b0\u306e\u30c7\u30fc\u30bf\u3092\u4f7f\u3044\u3001\u691c\u8a3c\u3057\u3066\u307f\u307e\u3059\u3002\n\n## \u3044\u304f\u3064\u304b\u306e\u56fd\u306e1\u6b21\u30ea\u30fc\u30b0\u904e\u53bb10\u5e74\u306e\u30c7\u30fc\u30bf\n\u30b7\u30fc\u30ba\u30f32015:\u30e8\u30fc\u30ed\u30c3\u30d1\u5404\u56fd\u306e\u30ea\u30fc\u30b0\u306f2015~2016\u3068\u3001\u30a2\u30b8\u30a2\u5404\u56fd\u306f2015\u3068\u306a\u308a\u307e\u3059\u3002\n\u52dd\u7387\u3001\u5206\u7387\u3001\u6557\u7387\uff1a\u30db\u30fc\u30e0\u30c1\u30fc\u30e0\u306e\u52dd\u7387\u3001\u5206\u7387\u3001\u6557\u7387\u3068\u306a\u308a\u307e\u3059\u3002\n\u653b\u6483\u529b\uff1a\u3053\u3053\u3067\u516c\u958b\u3057\u307e\u305b\u3093\u3002\n\nEngland,Italy,Spain,France\uff1a\u30c1\u30fc\u30e0\u6570\u300020\u3001\u3000\u7bc0\u6570\u300038\nGermany,Japan\uff1a\u30c1\u30fc\u30e0\u6570\u300018\u3001\u3000\u7bc0\u6570\u300034\nChina(\u904e\u53bb8\u5e74)\uff1a\u30c1\u30fc\u30e0\u6570\u300016\u3001\u3000\u7bc0\u6570\u300030\n\n|10\u5e74\u9593\u5e73\u5747|\u52dd\u7387|\u5206\u7387|\u6557\u7387|\u653b\u6483\u529bhome|\u653b\u6483\u529baway|\n|:-:|:--:|:-:|:-:|:-:|:-:|\n|England|0.4600|0.2582|0.2818|1.5389|1.1382|\n|Italy|0.4640|0.2716|0.2645|1.4974|1.1041|\n|Spain|0.4839|0.2340|0.2821|1.5965|1.1341|\n|Germany|0.4523|0.2464|0.3013|1.6149|1.2610|\n|France|0.4490|0.2874|0.2637|1.3886|1.0195|\n|Japan|0.4310|0.2372|0.3317|1.4932|1.2606|\n|China|0.4552|0.3010|0.2437|1.4763|1.0673|\n\n\n```\n> England\n       \u52dd\u7387   \u5206\u7387   \u6557\u7387 \u3000\u3000\u653b\u6483\u529bhome \u653b\u6483\u529baway\n2015 0.4132 0.2816 0.3053     1.4918     1.2078\n2014 0.4526 0.2447 0.3026     1.4738     1.0928\n2013 0.4711 0.2053 0.3237     1.5730     1.1948\n2012 0.4368 0.2842 0.2789     1.5578     1.2398\n2011 0.4500 0.2447 0.3053     1.5893     1.2150\n2010 0.4711 0.2921 0.2368     1.6240     1.1740\n2009 0.5079 0.2526 0.2395     1.6975     1.0735\n2008 0.4553 0.2553 0.2895     1.4003     1.0790\n2007 0.4632 0.2632 0.2737     1.5288     1.1073\n2006 0.4789 0.2579 0.2632     1.4525     0.9975\n\n> Italy\n       \u52dd\u7387   \u5206\u7387   \u6557\u7387     \u653b\u6483\u529bhome \u653b\u6483\u529baway\n2015 0.4605 0.2500 0.2895     1.4718     1.1055\n2014 0.4000 0.3158 0.2842     1.5003     1.1948\n2013 0.4763 0.2368 0.2868     1.5365     1.1868\n2012 0.4658 0.2526 0.2816     1.4948     1.1443\n2011 0.4553 0.2921 0.2526     1.4968     1.0605\n2010 0.4711 0.2553 0.2737     1.4310     1.0815\n2009 0.4895 0.2684 0.2421     1.5420     1.0683\n2008 0.5053 0.2500 0.2447     1.5205     1.0785\n2007 0.4605 0.2947 0.2447     1.4910     1.0608\n2006 0.4553 0.3000 0.2447     1.4898     1.0598\n\n> Spain\n       \u52dd\u7387   \u5206\u7387   \u6557\u7387     \u653b\u6483\u529bhome \u653b\u6483\u529baway\n2015 0.4816 0.2421 0.2763     1.6190     1.1263\n2014 0.4500 0.2395 0.3105     1.5365     1.1183\n2013 0.4711 0.2263 0.3026     1.6318     1.1180\n2012 0.4974 0.2211 0.2816     1.6878     1.1853\n2011 0.4947 0.2474 0.2579     1.6783     1.0835\n2010 0.5184 0.2079 0.2737     1.6373     1.1053\n2009 0.5105 0.2500 0.2395     1.6003     1.1133\n2008 0.4842 0.2184 0.2974     1.6600     1.2378\n2007 0.4789 0.2289 0.2921     1.5503     1.1378\n2006 0.4526 0.2579 0.2895     1.3640     1.1155\n\n> Germany\n       \u52dd\u7387   \u5206\u7387   \u6557\u7387     \u653b\u6483\u529bhome \u653b\u6483\u529baway\n2015 0.4412 0.2320 0.3268     1.5644     1.2642\n2014 0.4739 0.2680 0.2582     1.5886     1.1664\n2013 0.4739 0.2092 0.3170     1.7492     1.4119\n2012 0.4248 0.2549 0.3203     1.5917     1.3431\n2011 0.4542 0.2582 0.2876     1.6606     1.2006\n2010 0.4608 0.2059 0.3333     1.6469     1.2739\n2009 0.4085 0.2810 0.3105     1.5136     1.3164\n2008 0.4804 0.2418 0.2778     1.6992     1.2222\n2007 0.4673 0.2549 0.2778     1.6703     1.1406\n2006 0.4379 0.2582 0.3039     1.4644     1.2706\n\n> France\n       \u52dd\u7387   \u5206\u7387   \u6557\u7387     \u653b\u6483\u529bhome \u653b\u6483\u529baway\n2015 0.4211 0.2842 0.2947     1.4370     1.0890\n2014 0.4763 0.2316 0.2921     1.4110     1.0813\n2013 0.4395 0.2842 0.2763     1.4100     1.0480\n2012 0.4474 0.2842 0.2684     1.4683     1.0763\n2011 0.4711 0.2842 0.2447     1.4748     1.0418\n2010 0.4132 0.3421 0.2447     1.3425     0.9988\n2009 0.4711 0.2553 0.2737     1.3893     1.0210\n2008 0.4342 0.2947 0.2711     1.2870     0.9703\n2007 0.4395 0.3053 0.2553     1.3480     0.9363\n2006 0.4763 0.3079 0.2158     1.3180     0.9318\n\n> Japan\n       \u52dd\u7387   \u5206\u7387   \u6557\u7387     \u653b\u6483\u529bhome \u653b\u6483\u529baway\n2015 0.3856 0.2451 0.3693     1.4111     1.2675\n2014 0.4085 0.2516 0.3399     1.3497     1.1803\n2013 0.4641 0.2222 0.3137     1.5656     1.3072\n2012 0.4052 0.2484 0.3464     1.5025     1.2914\n2011 0.4346 0.2451 0.3203     1.5489     1.2911\n2010 0.4281 0.2614 0.3105     1.4247     1.2322\n2009 0.4314 0.2614 0.3072     1.4281     1.1569\n2008 0.4477 0.2288 0.3235     1.4153     1.1439\n2007 0.4346 0.2092 0.3562     1.5486     1.2839\n2006 0.4706 0.1993 0.3301     1.7378     1.4511\n\n> China\n       \u52dd\u7387   \u5206\u7387   \u6557\u7387     \u653b\u6483\u529bhome \u653b\u6483\u529baway\n2015 0.4292 0.2875 0.2833     1.5831     1.2175\n2014 0.4042 0.2792 0.3167     1.5041     1.2453\n2013 0.4708 0.2792 0.2500     1.5491     1.0828\n2012 0.4750 0.3042 0.2208     1.5625     1.0625\n2011 0.4750 0.2958 0.2292     1.4044     0.9466\n2010 0.4250 0.3292 0.2458     1.3453     1.0750\n2009 0.5042 0.3250 0.1708     1.3953     0.8372\n2008 0.4583 0.3083 0.2333     1.4666     1.0713\n```\n\n##\u52dd\u5206\u6557\u7387\u306e\u7406\u8ad6\u5024\u3092\u8a08\u7b97\u3059\u308b\nW,D,L\uff1a\u52dd\u3001\u5206\u3001\u6557\u306e\u7406\u8ad6\u5024\n\u52dd\u7387\u3001\u5206\u7387\u3001\u6557\u7387\uff1a\u5b9f\u969b\u30c7\u30fc\u30bf\u3067\u3001\u52dd\u5206\u6557\u306e\u5272\u5408\n\n```\n           W      D      L     \u52dd\u7387   \u5206\u7387   \u6557\u7387     \u653b\u6483\u529bhome \u653b\u6483\u529baway\nEngland 0.4658 0.2540 0.2802 0.4600 0.2582 0.2818     1.5389     1.1382\nItaly   0.4631 0.2584 0.2786 0.4640 0.2716 0.2645     1.4974     1.1041\nSpain   0.4813 0.2493 0.2694 0.4839 0.2340 0.2821     1.5965     1.1341\nGermany 0.4569 0.2454 0.2977 0.4523 0.2464 0.3013     1.6149     1.2610\nFrance  0.4542 0.2707 0.2751 0.4490 0.2874 0.2637     1.3886     1.0195\nJapan   0.4264 0.2541 0.3195 0.4310 0.2372 0.3317     1.4932     1.2606\nChina   0.4662 0.2611 0.2726 0.4552 0.3010 0.2437     1.4763     1.0673\n```\n\n##Total\n7\u304b\u56fd\u306e\u30ea\u30fc\u30b0\u904e\u53bb10\u5e74\u9593\u3067Total 23240\u8a66\u5408\u3092\u898b\u3066\u307f\u307e\u3057\u3087\u3046\u3002\n\u52a0\u91cd\u5e73\u5747\u3092\u53d6\u308a\u307e\u3059\u3002\n\n```\n   W          D          L        \u52dd\u7387       \u5206\u7387        \u6557\u7387    \u653b\u6483\u529bhome \u653b\u6483\u529baway \n0.4597     0.2559     0.2844     0.4575     0.2604     0.2821     1.5158     1.1390 \n```\n\n##\u7d50\u8ad6\n\u30b5\u30c3\u30ab\u30fc\u8a66\u5408\u306e\u52dd\u5206\u6557\u7387\u306e\u4e88\u60f3\u304c\u51fa\u6765\u307e\u3059\u3002\n\n##\u30b3\u30fc\u30c9\n\n```soccer.R\nsetwd(\"C:/R\")\nData <- read.table( \"soccer_data.csv\", header = FALSE, sep=\",\" )\nrownames(Data) <- c(2015:2006)\ncolnames(Data) <- rep( c(\"\u52dd\u7387\",\"\u5206\u7387\",\"\u6557\u7387\",\"\u653b\u6483\u529bhome\",\"\u653b\u6483\u529baway\"), length.out = 35 )\n\nEngland <- Data[,1:5]\nEngland.mean <- round( apply(England, 2, mean), 4 )\n\nItaly <- Data[,6:10]\nItaly.mean <- round( apply(Italy, 2, mean), 4 )\n\nGermany <- Data[,11:15]\nGermany.mean <- round( apply(Germany, 2, mean), 4 )\n\nSpain <- Data[,16:20]\nSpain.mean <- round( apply(Spain, 2, mean), 4 )\n\nFrance <- Data[,21:25]\nFrance.mean <- round( apply(France, 2, mean), 4 )\n\nJapan <- Data[,26:30]\nJapan.mean <- round( apply(Japan, 2, mean), 4 )\n\nChina <- Data[1:8,31:35]\nChina.mean <- round( apply(China, 2, mean), 4 )\n\nData.mean <- rbind(England.mean, Italy.mean, Spain.mean, Germany.mean, France.mean, Japan.mean, China.mean)\n\nt <- 90  \nprob <- Data.mean[,4:5]/t\n\n# ========================================================\nk <- 10\nprob_matrix <- matrix(0,k,4)\ncolnames(prob_matrix) <- c(\"goals\",\"W\",\"D\",\"L\")\nprob_matrix[,1] <- c(1:10)-1\n\nFun <- function(x){\n  fun <- function(y){\n    c(dbinom(y[1],t,x[1]),dbinom(y[1],t,x[2]))\n  }\n  kv <- apply(prob_matrix,1,fun)\n  for (i in 2:(k-1)){\n    prob_matrix[i,\"D\"] <- kv[1,i]*kv[2,i]\n    prob_matrix[i,\"W\"] <- kv[1,i]*sum(kv[2,(1:(i-1))])\n    prob_matrix[i,\"L\"] <- kv[1,i]*sum(kv[2,((i+1):k)])\n  }\n  prob_matrix[1,\"D\"] <- kv[1,1]*kv[2,1]\n  prob_matrix[1,\"L\"] <- kv[1,1]*sum(kv[2,2:k])\n  prob_matrix[k,\"D\"] <- kv[1,k]*kv[2,k]\n  prob_matrix[k,\"W\"] <- kv[1,k]*sum(kv[2,1:(k-1)])\n  apply(prob_matrix[,c(\"W\",\"D\",\"L\")],2,sum)\n}\u3000# \u95a2\u6570\u3092\u5b9a\u7fa9\u3059\u308b\n# ====================================================\n\npred <- t(round(apply(prob,1,Fun),4))\n\ncbind(pred,Data.mean)\n# ====================================================\nData.total <- round(\n              ( (England.mean + Italy.mean + Spain.mean + France.mean) * 20 * 38 * 10 *0.5 \n              + (Germany.mean + Japan.mean) * 18 * 34 * 10 *0.5 + China.mean * 16 * 30 * 8 *0.5 ) / \n              (20 * 38 * 10 * 0.5 * 4 + 18 * 34 * 10 * 0.5 * 2 + 16 * 30 * 8 * 0.5)\n              , 4 )  # \u52a0\u91cd\u5e73\u5747\nprob.total <- Data.total[4:5] / t\npred.total <- round( Fun(prob.total),4 )\n\nc(pred.total, Data.total)\n```\n", "tags": ["R", "\u7d71\u8a08\u5b66"]}