{"context": "VM\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u4f5c\u6210\u304b\u3089\u3001\u30d5\u30a1\u30a4\u30a2\u30a6\u30a9\u30fc\u30eb\u3001\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u30b0\u30eb\u30fc\u30d7\u3001\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306e\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u30b0\u30eb\u30fc\u30d7\u306e\u53c2\u52a0\u307e\u3067\u306e\u30e1\u30e2\u3067\u3059\u3002\nGCP\u306eHTTP Load Balancer\u306f\u3001\u30ea\u30fc\u30b8\u30e7\u30f3\u3092\u307e\u305f\u3044\u3060\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u3092\u767b\u9332\u3067\u304d\u3001LB\u304b\u3089\u306e\u5207\u308a\u96e2\u3057\u3001\u5207\u308a\u623b\u3057\u3082\u9ad8\u901f\u304c\u58f2\u308a\u3067\u3059\u3002\n\u30b9\u30bf\u30fc\u30c8\u30a2\u30c3\u30d7\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u307e\u305a\u4f5c\u6210\u3057\u307e\u3059\u3002\nApache\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3001Apache\u8d77\u52d5\u3001\u30c0\u30df\u30fcHTML\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u6210\u3059\u308b\u3082\u306e\u306b\u306a\u308a\u307e\u3059\u3002\n$ more lb_startup.sh\nyum -y install httpd && service httpd restart && echo \"`/bin/hostname`\" > /var/w\nww/html/index.html\n\n\nHTTP firewall\u30eb\u30fc\u30eb\u4f5c\u6210\n\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u5185\u306bHTTP\u3092\u8a31\u53ef\u3059\u308b\u30d5\u30a1\u30a4\u30a2\u30a6\u30a9\u30fc\u30eb\u30eb\u30fc\u30eb\ngcloud compute firewall-rules create www-firewall --target-tags $TAG --allow tcp:80 --network my-network\n\n\nVM\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u4f5c\u6210\ngcloud compute instances create www-1 --zone asia-east1-b --image centos-7 --tags $TAG --metadata-from-file startup-script=$HOME/lb_startup.sh --network my-network\n\ngcloud compute instances create www-2 --zone asia-east1-c --image centos-7 --tags $TAG --metadata-from-file startup-script=$HOME/lb_startup.sh --network my-network\n\n\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u30b0\u30eb\u30fc\u30d7\u4f5c\u6210\n\ngcloud preview instance-groups --zone asia-east1-b create resources-asia-b\n\ngcloud preview instance-groups --zone asia-east1-c create resources-asia-c\n\n\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u30b0\u30eb\u30fc\u30d7\u306b\u767b\u9332\n\ngcloud preview instance-groups --zone asia-east1-b instances --group resources-asia-b add www-1\n\ngcloud preview instance-groups --zone asia-east1-c instances --group resources-asia-c add www-2\n\n\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u30b0\u30eb\u30fc\u30d7\u306b\u30b5\u30fc\u30d3\u30b9(\u3053\u306e\u5834\u5408HTTP\uff09\u3092\u767b\u9332\n\ngcloud preview instance-groups --zone asia-east1-b add-service  resources-asia-b --network my-network --port 80 --service http\n\ngcloud preview instance-groups --zone asia-east1-c add-service  resources-asia-c --network my-network --port 80 --service http\n\nheath check\u4f5c\u6210\n\ngcloud compute http-health-checks create basic-check\n\n\u203b\u30d8\u30eb\u30b9\u30c1\u30a7\u30c3\u30af\u5468\u308a\u306f\u9806\u6b21\u30a2\u30c3\u30d7\u30c7\u30fc\u30c8\u4e88\u5b9a\nHTTP heath check\n\ngcloud compute backend-services create web-service --http-health-checks basic-check\n\ngcloud compute backend-services add-backend web-service --group resources-asia-b --zone asia-east1-b\n\ngcloud compute backend-services add-backend web-service --group resources-asia-c --zone asia-east1-c\n\ngcloud compute url-maps create web-map --default-service web-service\n\ngcloud compute target-http-proxies create web-proxy --url-map web-map\n\ngcloud compute forwarding-rules create http-rule --global --target-http-proxy web-proxy --port-range 80\n\nVM\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u4f5c\u6210\u304b\u3089\u3001\u30d5\u30a1\u30a4\u30a2\u30a6\u30a9\u30fc\u30eb\u3001\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u30b0\u30eb\u30fc\u30d7\u3001\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306e\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u30b0\u30eb\u30fc\u30d7\u306e\u53c2\u52a0\u307e\u3067\u306e\u30e1\u30e2\u3067\u3059\u3002\nGCP\u306eHTTP Load Balancer\u306f\u3001\u30ea\u30fc\u30b8\u30e7\u30f3\u3092\u307e\u305f\u3044\u3060\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u3092\u767b\u9332\u3067\u304d\u3001LB\u304b\u3089\u306e\u5207\u308a\u96e2\u3057\u3001\u5207\u308a\u623b\u3057\u3082\u9ad8\u901f\u304c\u58f2\u308a\u3067\u3059\u3002\n\n\u30b9\u30bf\u30fc\u30c8\u30a2\u30c3\u30d7\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u307e\u305a\u4f5c\u6210\u3057\u307e\u3059\u3002\nApache\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3001Apache\u8d77\u52d5\u3001\u30c0\u30df\u30fcHTML\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u6210\u3059\u308b\u3082\u306e\u306b\u306a\u308a\u307e\u3059\u3002\n\n```\n$ more lb_startup.sh\nyum -y install httpd && service httpd restart && echo \"`/bin/hostname`\" > /var/w\nww/html/index.html\n\n```\nHTTP firewall\u30eb\u30fc\u30eb\u4f5c\u6210\n\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u5185\u306bHTTP\u3092\u8a31\u53ef\u3059\u308b\u30d5\u30a1\u30a4\u30a2\u30a6\u30a9\u30fc\u30eb\u30eb\u30fc\u30eb\n\n```\ngcloud compute firewall-rules create www-firewall --target-tags $TAG --allow tcp:80 --network my-network\n\n```\n\nVM\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u4f5c\u6210\n\n```\ngcloud compute instances create www-1 --zone asia-east1-b --image centos-7 --tags $TAG --metadata-from-file startup-script=$HOME/lb_startup.sh --network my-network\n```\n\n```\ngcloud compute instances create www-2 --zone asia-east1-c --image centos-7 --tags $TAG --metadata-from-file startup-script=$HOME/lb_startup.sh --network my-network\n```\n\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u30b0\u30eb\u30fc\u30d7\u4f5c\u6210\n```\ngcloud preview instance-groups --zone asia-east1-b create resources-asia-b\n```\n\n```\ngcloud preview instance-groups --zone asia-east1-c create resources-asia-c\n```\n\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u30b0\u30eb\u30fc\u30d7\u306b\u767b\u9332\n```\ngcloud preview instance-groups --zone asia-east1-b instances --group resources-asia-b add www-1\n```\n\n```\ngcloud preview instance-groups --zone asia-east1-c instances --group resources-asia-c add www-2\n```\n\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u30b0\u30eb\u30fc\u30d7\u306b\u30b5\u30fc\u30d3\u30b9(\u3053\u306e\u5834\u5408HTTP\uff09\u3092\u767b\u9332\n```\ngcloud preview instance-groups --zone asia-east1-b add-service  resources-asia-b --network my-network --port 80 --service http\n```\n\n```\ngcloud preview instance-groups --zone asia-east1-c add-service  resources-asia-c --network my-network --port 80 --service http\n```\nheath check\u4f5c\u6210\n```\ngcloud compute http-health-checks create basic-check\n```\n\u203b\u30d8\u30eb\u30b9\u30c1\u30a7\u30c3\u30af\u5468\u308a\u306f\u9806\u6b21\u30a2\u30c3\u30d7\u30c7\u30fc\u30c8\u4e88\u5b9a\nHTTP heath check\n```\ngcloud compute backend-services create web-service --http-health-checks basic-check\n```\n\n```\ngcloud compute backend-services add-backend web-service --group resources-asia-b --zone asia-east1-b\n```\n\n```\ngcloud compute backend-services add-backend web-service --group resources-asia-c --zone asia-east1-c\n```\n\n```\ngcloud compute url-maps create web-map --default-service web-service\n```\n\n```\ngcloud compute target-http-proxies create web-proxy --url-map web-map\n```\n\n```\ngcloud compute forwarding-rules create http-rule --global --target-http-proxy web-proxy --port-range 80\n```\n", "tags": ["GoogleCloudPlatform"]}