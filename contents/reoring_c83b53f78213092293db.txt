{"context": " More than 1 year has passed since last update.\u3042\u308b\u30db\u30b9\u30c8\u304c\u8d77\u52d5\u3059\u308b\u307e\u3067\u5f85\u3064\u3068\u304b\u3001\u305d\u3046\u3044\u3046\u7528\u9014\u306b\u3064\u304b\u3063\u305f\u308a\u3057\u307e\u3059\u3002\nimport sys\nimport socket\nimport time\nimport argparse\n\nparser = argparse.ArgumentParser(description='Check tcp connectivity')\nparser.add_argument('--host', dest='host', type=str, help='target host')\nparser.add_argument('--port', dest='port', type=int, help='target port')\nparser.add_argument('--interval', dest='interval', type=int, default='3', help='interval to check')\nparser.add_argument('--retries', dest='retries', type=int, default='3', help='number of retries')\nargs = parser.parse_args()\n\ndef check_tcp_connectivity(host, port, interval=0, retries=1):\n    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)\n\n    for x in range(retries):\n        try:\n            s.connect((host, port))\n            s.close()\n            return True\n        except socket.error as e:\n            time.sleep(interval)\n\n    s.close()\n    return False\n\nif check_tcp_connectivity(args.host, args.port, args.interval, args.retries):\n    sys.exit(0)\nelse:\n    sys.exit(1)\n\n\n\n\u4f7f\u3046\npython check.py --host 192.168.0.1 --port 22\n\n\u53c2\u7167\nargparse\nsocket\ntime\nsys\n\n\u3042\u308b\u30db\u30b9\u30c8\u304c\u8d77\u52d5\u3059\u308b\u307e\u3067\u5f85\u3064\u3068\u304b\u3001\u305d\u3046\u3044\u3046\u7528\u9014\u306b\u3064\u304b\u3063\u305f\u308a\u3057\u307e\u3059\u3002\n\n```python\nimport sys\nimport socket\nimport time\nimport argparse\n\nparser = argparse.ArgumentParser(description='Check tcp connectivity')\nparser.add_argument('--host', dest='host', type=str, help='target host')\nparser.add_argument('--port', dest='port', type=int, help='target port')\nparser.add_argument('--interval', dest='interval', type=int, default='3', help='interval to check')\nparser.add_argument('--retries', dest='retries', type=int, default='3', help='number of retries')\nargs = parser.parse_args()\n\ndef check_tcp_connectivity(host, port, interval=0, retries=1):\n    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)\n\n    for x in range(retries):\n        try:\n            s.connect((host, port))\n            s.close()\n            return True\n        except socket.error as e:\n            time.sleep(interval)\n\n    s.close()\n    return False\n\nif check_tcp_connectivity(args.host, args.port, args.interval, args.retries):\n    sys.exit(0)\nelse:\n    sys.exit(1)\n\n```\n\n## \u4f7f\u3046\n\n`python check.py --host 192.168.0.1 --port 22`\n\n\n## \u53c2\u7167\n\n[argparse](http://docs.python.jp/2/library/argparse.html)\n[socket](http://docs.python.jp/2/library/socket.html)\n[time](http://docs.python.jp/2/library/time.html)\n[sys](http://docs.python.jp/2/library/sys.html)\n", "tags": ["Python", "Network", "TCP"]}