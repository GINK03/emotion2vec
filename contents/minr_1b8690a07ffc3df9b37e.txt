{"context": " More than 1 year has passed since last update.Yu-Tang\u3055\u3093\u306e\u300cDOS \u30b3\u30de\u30f3\u30c9\u306e\u5b9f\u884c\u7d50\u679c\u3092\u53d6\u5f97\u3059\u308b\u65b9\u6cd5\u300d\u3092\u53c2\u8003\u306b\u3001VBA\u304b\u3089PowerShell\u3092\u5b9f\u884c\u3059\u308b\u95a2\u6570\u3092\u4f5c\u6210\u3057\u3066\u307f\u307e\u3057\u305f\u3002\n\n\u95a2\u6570\u5b9a\u7fa9\n\nVBA(\u6a19\u6e96\u30e2\u30b8\u30e5\u30fc\u30eb)\nOption Explicit\n\nConst TEMPORARYFOLDER = 2\nPrivate objShell As Object\nPrivate objFso As Object\nPrivate objFdr As Object\n\n' \u95a2\u6570\u540d\uff1aInitializeObjects\n' \u76ee\u3000\u7684\uff1a\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306e\u521d\u671f\u5316\uff08\u521d\u56de\u306e\u307f\uff09\nPublic Sub InitializeObjects()\n    If objShell Is Nothing Then Set objShell = CreateObject(\"WScript.Shell\")\n    If objFso Is Nothing Then Set objFso = CreateObject(\"Scripting.FileSystemObject\")\n    If objFdr Is Nothing Then Set objFdr = objFso.GetSpecialFolder(TEMPORARYFOLDER)\nEnd Sub\n\n' \u95a2\u6570\u540d\uff1aReleaseObjects\n' \u76ee\u3000\u7684\uff1a\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306e\u89e3\u653e\uff08\u30d6\u30c3\u30af\u7d42\u4e86\u524d\u7b49\u306b\u5b9f\u884c\u3057\u3066\u4e0b\u3055\u3044\uff09\nPublic Sub ReleaseObjects()\n    Set objShell = Nothing\n    Set objFso = Nothing\n    Set objFdr = Nothing\nEnd Sub\n\n' \u95a2\u6570\u540d\uff1aBuildTempPath\n' \u76ee\u3000\u7684\uff1a\u4e00\u6642\u30d5\u30a1\u30a4\u30eb\u30d1\u30b9\u306e\u751f\u6210\nPrivate Function BuildTempPath() As String\n    Do\n        BuildTempPath = objFso.BuildPath(objFdr.path, objFso.GetTempName)\n    Loop While objFso.FileExists(BuildTempPath)\nEnd Function\n\n' \u95a2\u6570\u540d\uff1aReadAll\n' \u76ee\u3000\u7684\uff1a\u30d5\u30a1\u30a4\u30eb\u306e\u5185\u5bb9\u3092\u3059\u3079\u3066\u8aad\u307f\u8fbc\u307f\nPrivate Function ReadAll(ByVal valPath As String) As String\n    Dim objTs As Object\n    If objFso.FileExists(valPath) Then\n        Set objTs = objFso.OpenTextFile(valPath)\n        If Not objTs.AtEndOfStream Then\n            ReadAll = objTs.ReadAll\n        End If\n        objTs.Close\n    End If\n    Set objTs = Nothing\nEnd Function\n\n\n' \u95a2\u6570\u540d\uff1aExecPosh\n' \u76ee\u3000\u7684\uff1aPowerShell \u30b3\u30de\u30f3\u30c9\u306e\u5b9f\u884c\u7d50\u679c\u306e\u53d6\u5f97\uff08\u30b3\u30de\u30f3\u30c9\u6307\u5b9a\u30bf\u30a4\u30d7\uff09\n' \u623b\u308a\u5024\uff1aPowerShell \u30b3\u30de\u30f3\u30c9\u306e\u5b9f\u884c\u7d50\u679c\n' \u5f15\u3000\u6570\uff1avalCommand        -> \u5fc5\u9808/\u5165\u529b\u7528\u3067\u3059\u3002\u5b9f\u884c\u30b3\u30de\u30f3\u30c9\u3092\u6587\u5b57\u5217\u578b\u3067\u6307\u5b9a\u3057\u307e\u3059\u3002\n' \u3000\u3000\u3000\u3000valTraceConsole   -> \u4efb\u610f/\u5165\u529b\u7528\u3067\u3059\u3002\u5b9f\u884c\u30b3\u30de\u30f3\u30c9\u53ca\u3073\u5b9f\u884c\u7d50\u679c\u3092\u30a4\u30df\u30c7\u30a3\u30a8\u30a4\u30c8\u30a6\u30a3\u30f3\u30c9\u30a6\u306b\u51fa\u529b\u3057\u307e\u3059\u3002\n' \u3000\u3000\u3000\u3000valSuspendIfError -> \u4efb\u610f/\u5165\u529b\u7528\u3067\u3059\u3002\u30a8\u30e9\u30fc\u767a\u751f\u6642\u306b\u4e00\u6642\u505c\u6b62\u3057\u307e\u3059\u3002\n' \u6ce8\u3000\u610f\uff1avalSuspendIfError\u3092True\u306b\u3059\u308b\u3068\u3001\u6a19\u6e96\u30a8\u30e9\u30fc\u51fa\u529b\u3001\u6a19\u6e96\u51fa\u529b\u306e\u9806\u306b\u7d50\u679c\u304c\u51fa\u529b\u3055\u308c\u307e\u3059\u3002\n' \u53c2\u3000\u8003\uff1ahttp://www.f3.dion.ne.jp/~element/msaccess/AcTipsGetDosResult.html\nPublic Function ExecPosh(ByVal valCommand As String, _\n                         Optional ByVal valTraceConsole As Boolean = False, _\n                         Optional ByVal valSuspendIfError As Boolean = False) _\n                         As String\n    '\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306e\u521d\u671f\u5316\uff08\u521d\u56de\u306e\u307f\uff09\n    InitializeObjects\n\n    Dim valStdOutPath, valStdOutText As String\n    Dim valStdErrPath, valStdErrText As String\n    Dim valCurrent As String\n    Dim valRunCommand As String\n    valCurrent = ThisWorkbook.path\n\n    If valTraceConsole Then Debug.Print \"PS \" & valCurrent & \" > \" & valCommand\n\n    ' \u4e00\u6642\u30d5\u30a1\u30a4\u30eb\u30d1\u30b9\u3092\u751f\u6210\n    valStdOutPath = BuildTempPath()\n    If valSuspendIfError Then\n      valStdErrPath = BuildTempPath()\n    End If\n\n    ' \u30b3\u30de\u30f3\u30c9\u5b9f\u884c\n    valRunCommand = _\n      \"%ComSpec% /c\" & _\n      \" cd \" & valCurrent & _\n      \" & powershell -command \"\"\" & valCommand & \"\"\"\" & _\n      \" 1> \" & valStdOutPath & _\n      IIf(valSuspendIfError, \" 2> \" & valStdErrPath, \" 2>&1\")\n\n    objShell.Run valRunCommand, 0, True\n\n    ' \u5b9f\u884c\u7d50\u679c\u306e\u53d6\u5f97\n    valStdOutText = ReadAll(valStdOutPath)\n    If valSuspendIfError Then\n      valStdErrText = ReadAll(valStdErrPath)\n    End If\n\n    If valTraceConsole Then Debug.Print valStdOutText\n\n    If valSuspendIfError Then\n        If valTraceConsole Then Debug.Print valStdErrText\n        Debug.Assert valStdErrText = \"\"\n    End If\n\n    ' \u4e00\u6642\u30d5\u30a1\u30a4\u30eb\u306e\u524a\u9664\n    Kill valStdOutPath\n    If valSuspendIfError Then\n      Kill valStdErrPath\n    End If\n\n    ExecPosh = IIf(valSuspendIfError, valStdErrText, \"\") & valStdOutText\nEnd Function\n\n' \u95a2\u6570\u540d\uff1aCallPosh\n' \u76ee\u3000\u7684\uff1aPowerShell \u30b3\u30de\u30f3\u30c9\u306e\u5b9f\u884c\u7d50\u679c\u306e\u53d6\u5f97\uff08\u30b9\u30af\u30ea\u30d7\u30c8\u30d1\u30b9\u6307\u5b9a\u30bf\u30a4\u30d7\uff09\n' \u623b\u308a\u5024\uff1aPowerShell \u30b3\u30de\u30f3\u30c9\u306e\u5b9f\u884c\u7d50\u679c\n' \u5f15\u3000\u6570\uff1avalPath           -> \u5fc5\u9808/\u5165\u529b\u7528\u3067\u3059\u3002PowerShell\u30b9\u30af\u30ea\u30d7\u30c8\u306e\u30d1\u30b9\u3092\u6587\u5b57\u5217\u578b\u3067\u6307\u5b9a\u3057\u307e\u3059\u3002\n'         valArgs           -> \u5fc5\u9808/\u5165\u529b\u7528\u3067\u3059\u3002PowerShell\u30b9\u30af\u30ea\u30d7\u30c8\u306e\u5f15\u6570\u3078\u6e21\u3059\u5024\u3092\u6587\u5b57\u5217\u578b\u3067\u6307\u5b9a\u3057\u307e\u3059\u3002\n'                              \u8907\u6570\u6307\u5b9a\u3059\u308b\u5834\u5408\u306f\u3001\u30b9\u30da\u30fc\u30b9\u533a\u5207\u308a\u3067\u6307\u5b9a\u3057\u3066\u4e0b\u3055\u3044\u3002\uff08\u4f8b \"arg1 arg2\"\uff09\n' \u5f15\u3000\u6570\uff1avalCommand        -> \u5fc5\u9808/\u5165\u529b\u7528\u3067\u3059\u3002\u5b9f\u884c\u30b3\u30de\u30f3\u30c9\u3092\u6587\u5b57\u5217\u578b\u3067\u6307\u5b9a\u3057\u307e\u3059\u3002\n' \u3000\u3000\u3000\u3000valTraceConsole   -> \u4efb\u610f/\u5165\u529b\u7528\u3067\u3059\u3002\u5b9f\u884c\u30b3\u30de\u30f3\u30c9\u53ca\u3073\u5b9f\u884c\u7d50\u679c\u3092\u30a4\u30df\u30c7\u30a3\u30a8\u30a4\u30c8\u30a6\u30a3\u30f3\u30c9\u30a6\u306b\u51fa\u529b\u3057\u307e\u3059\u3002\n' \u3000\u3000\u3000\u3000valSuspendIfError -> \u4efb\u610f/\u5165\u529b\u7528\u3067\u3059\u3002\u30a8\u30e9\u30fc\u767a\u751f\u6642\u306b\u4e00\u6642\u505c\u6b62\u3057\u307e\u3059\u3002\n' \u6ce8\u3000\u610f\uff1avalSuspendIfError\u3092True\u306b\u3059\u308b\u3068\u3001\u6a19\u6e96\u30a8\u30e9\u30fc\u51fa\u529b\u3001\u6a19\u6e96\u51fa\u529b\u306e\u9806\u306b\u7d50\u679c\u304c\u51fa\u529b\u3055\u308c\u307e\u3059\u3002\nPublic Function CallPosh(ByVal valPath As String, _\n                         ByVal valArgs As String, _\n                         Optional ByVal valTraceConsole As Boolean = False, _\n                         Optional ByVal valSuspendIfError As Boolean = False) _\n                         As String\n\n    Dim valCommand As String\n    valCommand = \"$script = Get-Content '\" & valPath & \"';Invoke-Expression('&{' + $script + '} \" & valArgs & \"')\"\n\n    CallPosh = ExecPosh(valCommand, valTraceConsole, valSuspendIfError)\nEnd Function\n\n\n\n\u4f7f\u3044\u65b9\uff08\u4f8b\uff09\nEXCEL\u306e\u30bb\u30eb\u304b\u3001VBA\u306e\u30a4\u30df\u30c7\u30a3\u30a8\u30a4\u30c8\u30a6\u30a3\u30f3\u30c9\u30a6\u3067\u4ee5\u4e0b\u3092\u5b9f\u884c\u3059\u308b\n\nExecPosh\uff08\u30b3\u30de\u30f3\u30c9\u6307\u5b9a\u30bf\u30a4\u30d7\uff09\nExecPosh(\"$PSVersionTable.PSVersion | Select Major,Minor | ConvertTo-Csv -NTI\")\n\n\n\u7d50\u679c\n\"Major\",\"Minor\"\n\"5\",\"0\"\n\n\n\nCallPosh\uff08\u30b9\u30af\u30ea\u30d7\u30c8\u30d1\u30b9\u6307\u5b9a\u30bf\u30a4\u30d7\uff09\nCallPosh(\"sample.ps1\",\"minr \u65e5\u672c\")\n\n\nsample.ps1\nparam($name,$region);\necho ('\u79c1\u306e\u540d\u524d\u306f' + $name + '\u3067\u3059');\necho ($region + '\u306b\u4f4f\u3093\u3067\u3044\u307e\u3059');\n\n\n\n\u7d50\u679c\n\u79c1\u306e\u540d\u524d\u306fminr\u3067\u3059\n\u65e5\u672c\u306b\u4f4f\u3093\u3067\u3044\u307e\u3059\n\n\n\n\u307e\u3068\u3081\n\u4e45\u3005\u306bVBA\u3092\u3084\u3063\u3066\u307f\u307e\u3057\u305f\u304c\u3001\u3084\u3063\u3071\u308a\u5b9f\u88c5\u304c\u9762\u5012\u81ed\u304b\u3063\u305f\u3067\u3059\u3002\nYu-Tang\u3055\u3093\u306e[\u300cDOS \u30b3\u30de\u30f3\u30c9\u306e\u5b9f\u884c\u7d50\u679c\u3092\u53d6\u5f97\u3059\u308b\u65b9\u6cd5\u300d](http://www.f3.dion.ne.jp/~element/msaccess/AcTipsGetDosResult.html)\u3092\u53c2\u8003\u306b\u3001VBA\u304b\u3089PowerShell\u3092\u5b9f\u884c\u3059\u308b\u95a2\u6570\u3092\u4f5c\u6210\u3057\u3066\u307f\u307e\u3057\u305f\u3002\n\n## \u95a2\u6570\u5b9a\u7fa9\n\n```vbnet:VBA(\u6a19\u6e96\u30e2\u30b8\u30e5\u30fc\u30eb)\nOption Explicit\n\nConst TEMPORARYFOLDER = 2\nPrivate objShell As Object\nPrivate objFso As Object\nPrivate objFdr As Object\n\n' \u95a2\u6570\u540d\uff1aInitializeObjects\n' \u76ee\u3000\u7684\uff1a\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306e\u521d\u671f\u5316\uff08\u521d\u56de\u306e\u307f\uff09\nPublic Sub InitializeObjects()\n    If objShell Is Nothing Then Set objShell = CreateObject(\"WScript.Shell\")\n    If objFso Is Nothing Then Set objFso = CreateObject(\"Scripting.FileSystemObject\")\n    If objFdr Is Nothing Then Set objFdr = objFso.GetSpecialFolder(TEMPORARYFOLDER)\nEnd Sub\n\n' \u95a2\u6570\u540d\uff1aReleaseObjects\n' \u76ee\u3000\u7684\uff1a\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306e\u89e3\u653e\uff08\u30d6\u30c3\u30af\u7d42\u4e86\u524d\u7b49\u306b\u5b9f\u884c\u3057\u3066\u4e0b\u3055\u3044\uff09\nPublic Sub ReleaseObjects()\n    Set objShell = Nothing\n    Set objFso = Nothing\n    Set objFdr = Nothing\nEnd Sub\n\n' \u95a2\u6570\u540d\uff1aBuildTempPath\n' \u76ee\u3000\u7684\uff1a\u4e00\u6642\u30d5\u30a1\u30a4\u30eb\u30d1\u30b9\u306e\u751f\u6210\nPrivate Function BuildTempPath() As String\n    Do\n        BuildTempPath = objFso.BuildPath(objFdr.path, objFso.GetTempName)\n    Loop While objFso.FileExists(BuildTempPath)\nEnd Function\n\n' \u95a2\u6570\u540d\uff1aReadAll\n' \u76ee\u3000\u7684\uff1a\u30d5\u30a1\u30a4\u30eb\u306e\u5185\u5bb9\u3092\u3059\u3079\u3066\u8aad\u307f\u8fbc\u307f\nPrivate Function ReadAll(ByVal valPath As String) As String\n    Dim objTs As Object\n    If objFso.FileExists(valPath) Then\n        Set objTs = objFso.OpenTextFile(valPath)\n        If Not objTs.AtEndOfStream Then\n            ReadAll = objTs.ReadAll\n        End If\n        objTs.Close\n    End If\n    Set objTs = Nothing\nEnd Function\n\n\n' \u95a2\u6570\u540d\uff1aExecPosh\n' \u76ee\u3000\u7684\uff1aPowerShell \u30b3\u30de\u30f3\u30c9\u306e\u5b9f\u884c\u7d50\u679c\u306e\u53d6\u5f97\uff08\u30b3\u30de\u30f3\u30c9\u6307\u5b9a\u30bf\u30a4\u30d7\uff09\n' \u623b\u308a\u5024\uff1aPowerShell \u30b3\u30de\u30f3\u30c9\u306e\u5b9f\u884c\u7d50\u679c\n' \u5f15\u3000\u6570\uff1avalCommand        -> \u5fc5\u9808/\u5165\u529b\u7528\u3067\u3059\u3002\u5b9f\u884c\u30b3\u30de\u30f3\u30c9\u3092\u6587\u5b57\u5217\u578b\u3067\u6307\u5b9a\u3057\u307e\u3059\u3002\n' \u3000\u3000\u3000\u3000valTraceConsole   -> \u4efb\u610f/\u5165\u529b\u7528\u3067\u3059\u3002\u5b9f\u884c\u30b3\u30de\u30f3\u30c9\u53ca\u3073\u5b9f\u884c\u7d50\u679c\u3092\u30a4\u30df\u30c7\u30a3\u30a8\u30a4\u30c8\u30a6\u30a3\u30f3\u30c9\u30a6\u306b\u51fa\u529b\u3057\u307e\u3059\u3002\n' \u3000\u3000\u3000\u3000valSuspendIfError -> \u4efb\u610f/\u5165\u529b\u7528\u3067\u3059\u3002\u30a8\u30e9\u30fc\u767a\u751f\u6642\u306b\u4e00\u6642\u505c\u6b62\u3057\u307e\u3059\u3002\n' \u6ce8\u3000\u610f\uff1avalSuspendIfError\u3092True\u306b\u3059\u308b\u3068\u3001\u6a19\u6e96\u30a8\u30e9\u30fc\u51fa\u529b\u3001\u6a19\u6e96\u51fa\u529b\u306e\u9806\u306b\u7d50\u679c\u304c\u51fa\u529b\u3055\u308c\u307e\u3059\u3002\n' \u53c2\u3000\u8003\uff1ahttp://www.f3.dion.ne.jp/~element/msaccess/AcTipsGetDosResult.html\nPublic Function ExecPosh(ByVal valCommand As String, _\n                         Optional ByVal valTraceConsole As Boolean = False, _\n                         Optional ByVal valSuspendIfError As Boolean = False) _\n                         As String\n    '\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306e\u521d\u671f\u5316\uff08\u521d\u56de\u306e\u307f\uff09\n    InitializeObjects\n    \n    Dim valStdOutPath, valStdOutText As String\n    Dim valStdErrPath, valStdErrText As String\n    Dim valCurrent As String\n    Dim valRunCommand As String\n    valCurrent = ThisWorkbook.path\n    \n    If valTraceConsole Then Debug.Print \"PS \" & valCurrent & \" > \" & valCommand\n    \n    ' \u4e00\u6642\u30d5\u30a1\u30a4\u30eb\u30d1\u30b9\u3092\u751f\u6210\n    valStdOutPath = BuildTempPath()\n    If valSuspendIfError Then\n      valStdErrPath = BuildTempPath()\n    End If\n    \n    ' \u30b3\u30de\u30f3\u30c9\u5b9f\u884c\n    valRunCommand = _\n      \"%ComSpec% /c\" & _\n      \" cd \" & valCurrent & _\n      \" & powershell -command \"\"\" & valCommand & \"\"\"\" & _\n      \" 1> \" & valStdOutPath & _\n      IIf(valSuspendIfError, \" 2> \" & valStdErrPath, \" 2>&1\")\n\n    objShell.Run valRunCommand, 0, True\n    \n    ' \u5b9f\u884c\u7d50\u679c\u306e\u53d6\u5f97\n    valStdOutText = ReadAll(valStdOutPath)\n    If valSuspendIfError Then\n      valStdErrText = ReadAll(valStdErrPath)\n    End If\n    \n    If valTraceConsole Then Debug.Print valStdOutText\n    \n    If valSuspendIfError Then\n        If valTraceConsole Then Debug.Print valStdErrText\n        Debug.Assert valStdErrText = \"\"\n    End If\n    \n    ' \u4e00\u6642\u30d5\u30a1\u30a4\u30eb\u306e\u524a\u9664\n    Kill valStdOutPath\n    If valSuspendIfError Then\n      Kill valStdErrPath\n    End If\n    \n    ExecPosh = IIf(valSuspendIfError, valStdErrText, \"\") & valStdOutText\nEnd Function\n\n' \u95a2\u6570\u540d\uff1aCallPosh\n' \u76ee\u3000\u7684\uff1aPowerShell \u30b3\u30de\u30f3\u30c9\u306e\u5b9f\u884c\u7d50\u679c\u306e\u53d6\u5f97\uff08\u30b9\u30af\u30ea\u30d7\u30c8\u30d1\u30b9\u6307\u5b9a\u30bf\u30a4\u30d7\uff09\n' \u623b\u308a\u5024\uff1aPowerShell \u30b3\u30de\u30f3\u30c9\u306e\u5b9f\u884c\u7d50\u679c\n' \u5f15\u3000\u6570\uff1avalPath           -> \u5fc5\u9808/\u5165\u529b\u7528\u3067\u3059\u3002PowerShell\u30b9\u30af\u30ea\u30d7\u30c8\u306e\u30d1\u30b9\u3092\u6587\u5b57\u5217\u578b\u3067\u6307\u5b9a\u3057\u307e\u3059\u3002\n'         valArgs           -> \u5fc5\u9808/\u5165\u529b\u7528\u3067\u3059\u3002PowerShell\u30b9\u30af\u30ea\u30d7\u30c8\u306e\u5f15\u6570\u3078\u6e21\u3059\u5024\u3092\u6587\u5b57\u5217\u578b\u3067\u6307\u5b9a\u3057\u307e\u3059\u3002\n'                              \u8907\u6570\u6307\u5b9a\u3059\u308b\u5834\u5408\u306f\u3001\u30b9\u30da\u30fc\u30b9\u533a\u5207\u308a\u3067\u6307\u5b9a\u3057\u3066\u4e0b\u3055\u3044\u3002\uff08\u4f8b \"arg1 arg2\"\uff09\n' \u5f15\u3000\u6570\uff1avalCommand        -> \u5fc5\u9808/\u5165\u529b\u7528\u3067\u3059\u3002\u5b9f\u884c\u30b3\u30de\u30f3\u30c9\u3092\u6587\u5b57\u5217\u578b\u3067\u6307\u5b9a\u3057\u307e\u3059\u3002\n' \u3000\u3000\u3000\u3000valTraceConsole   -> \u4efb\u610f/\u5165\u529b\u7528\u3067\u3059\u3002\u5b9f\u884c\u30b3\u30de\u30f3\u30c9\u53ca\u3073\u5b9f\u884c\u7d50\u679c\u3092\u30a4\u30df\u30c7\u30a3\u30a8\u30a4\u30c8\u30a6\u30a3\u30f3\u30c9\u30a6\u306b\u51fa\u529b\u3057\u307e\u3059\u3002\n' \u3000\u3000\u3000\u3000valSuspendIfError -> \u4efb\u610f/\u5165\u529b\u7528\u3067\u3059\u3002\u30a8\u30e9\u30fc\u767a\u751f\u6642\u306b\u4e00\u6642\u505c\u6b62\u3057\u307e\u3059\u3002\n' \u6ce8\u3000\u610f\uff1avalSuspendIfError\u3092True\u306b\u3059\u308b\u3068\u3001\u6a19\u6e96\u30a8\u30e9\u30fc\u51fa\u529b\u3001\u6a19\u6e96\u51fa\u529b\u306e\u9806\u306b\u7d50\u679c\u304c\u51fa\u529b\u3055\u308c\u307e\u3059\u3002\nPublic Function CallPosh(ByVal valPath As String, _\n                         ByVal valArgs As String, _\n                         Optional ByVal valTraceConsole As Boolean = False, _\n                         Optional ByVal valSuspendIfError As Boolean = False) _\n                         As String\n    \n    Dim valCommand As String\n    valCommand = \"$script = Get-Content '\" & valPath & \"';Invoke-Expression('&{' + $script + '} \" & valArgs & \"')\"\n    \n    CallPosh = ExecPosh(valCommand, valTraceConsole, valSuspendIfError)\nEnd Function\n```\n\n## \u4f7f\u3044\u65b9\uff08\u4f8b\uff09\nEXCEL\u306e\u30bb\u30eb\u304b\u3001VBA\u306e\u30a4\u30df\u30c7\u30a3\u30a8\u30a4\u30c8\u30a6\u30a3\u30f3\u30c9\u30a6\u3067\u4ee5\u4e0b\u3092\u5b9f\u884c\u3059\u308b\n\n### ExecPosh\uff08\u30b3\u30de\u30f3\u30c9\u6307\u5b9a\u30bf\u30a4\u30d7\uff09\n\n```vbnet:\nExecPosh(\"$PSVersionTable.PSVersion | Select Major,Minor | ConvertTo-Csv -NTI\")\n```\n\n```txt:\u7d50\u679c\n\"Major\",\"Minor\"\n\"5\",\"0\"\n```\n\n### CallPosh\uff08\u30b9\u30af\u30ea\u30d7\u30c8\u30d1\u30b9\u6307\u5b9a\u30bf\u30a4\u30d7\uff09\n\n```vbnet:\nCallPosh(\"sample.ps1\",\"minr \u65e5\u672c\")\n```\n\n```ps1:sample.ps1\nparam($name,$region);\necho ('\u79c1\u306e\u540d\u524d\u306f' + $name + '\u3067\u3059');\necho ($region + '\u306b\u4f4f\u3093\u3067\u3044\u307e\u3059');\n```\n\n```txt:\u7d50\u679c\n\u79c1\u306e\u540d\u524d\u306fminr\u3067\u3059\n\u65e5\u672c\u306b\u4f4f\u3093\u3067\u3044\u307e\u3059\n```\n\n## \u307e\u3068\u3081\n\u4e45\u3005\u306bVBA\u3092\u3084\u3063\u3066\u307f\u307e\u3057\u305f\u304c\u3001\u3084\u3063\u3071\u308a\u5b9f\u88c5\u304c\u9762\u5012\u81ed\u304b\u3063\u305f\u3067\u3059\u3002\n\n", "tags": ["PowerShell", "VBA"]}