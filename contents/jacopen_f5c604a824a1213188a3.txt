{"tags": ["docker", "lattice", "cloudfoundry"], "context": " More than 1 year has passed since last update.Docker image\u4e92\u63db\u306e\u30b3\u30f3\u30c6\u30ca\u7ba1\u7406\u30b7\u30b9\u30c6\u30e0\u3001Lattice(http://lattice.cf/) \u3092\u3001Google Cloud Platform\u4e0a\u306b\u69cb\u7bc9\u3059\u308b\u65b9\u6cd5\u3092\u89e3\u8aac\u3057\u307e\u3059\u3002\n\n\u4e8b\u524d\u6e96\u5099\n\nterraform\u306e\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\nLattice\u306e\u69cb\u7bc9\u306b\u306f\u3001HashiCorp\u306eTerraform\u3092\u5229\u7528\u3057\u307e\u3059\u3002\nTerraform\u306e\u30b5\u30a4\u30c8\u304b\u3089\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3057\u3066\u3001\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\u3092\u884c\u3063\u3066\u304a\u304d\u307e\u3059\nhttps://www.terraform.io/downloads.html\n\u672c\u8a18\u4e8b\u3067\u306f\u3001Terraform 0.5.0\u3092\u5229\u7528\u3057\u307e\u3059\u3002\n\nLattice\u306eclone\ngithub\u304b\u3089lattice\u3092clone\u3057\u307e\u3059\u3002\ngit clone git@github.com:cloudfoundry-incubator/lattice.git\n\n\u672c\u9805\u3067\u306fv0.2.4\u3092\u5229\u7528\u3057\u307e\u3059\u3002\n\nltc\u30b3\u30de\u30f3\u30c9\u306e\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\nLattice\u306e\u64cd\u4f5c\u306b\u5fc5\u8981\u306altc\u30b3\u30de\u30f3\u30c9\u306e\u30d0\u30a4\u30ca\u30ea\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3057\u3001PATH\u304c\u901a\u3063\u3066\u3044\u308b\u5834\u6240\u306b\u8a2d\u7f6e\u3057\u3066\u304a\u304d\u307e\u3059\nOSX https://lattice.s3.amazonaws.com/releases/v0.2.4/darwin-amd64/ltc\nLinux https://lattice.s3.amazonaws.com/releases/v0.2.4/linux-amd64/ltc\n\naccount file\u306e\u6e96\u5099\n\u4ee5\u4e0b\u306e\u624b\u9806\u3067GCP\u304b\u3089account file\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3057\u307e\u3059\u3002\n\n\n\n\u3053\u3053\u3067\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3055\u308c\u305fjson\u30d5\u30a1\u30a4\u30eb\u3092\u3001lattice\u306e\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306baccount.json\u3068\u3044\u3046\u540d\u524d\u3067\u4fdd\u5b58\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n\nSSH\u9375\u306e\u4f5c\u6210\u3068\u767b\u9332\nGCP\u3067\u5229\u7528\u3059\u308bSSH\u9375\u3092\u751f\u6210\u3057\u3066\u304a\u304d\u307e\u3059\u3002\u3053\u3053\u3067\u306f\u3001id_rsa_google\u3068\u3044\u3046\u540d\u524d\u3067\u4f5c\u6210\u3057\u307e\u3059\n$ ssh-keygen\nGenerating public/private rsa key pair.\nEnter file in which to save the key (/home/jacopen/.ssh/id_rsa): id_rsa_google\nEnter passphrase (empty for no passphrase):\nEnter same passphrase again:\n\u4ee5\u4e0b\u7565\n\n\u4f5c\u6210\u304c\u7d42\u308f\u3063\u305f\u3089\u3001\u516c\u958b\u9375\u3092GCP\u306b\u767b\u9332\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n\n\ntf\u30d5\u30a1\u30a4\u30eb\u306e\u7de8\u96c6\ncd lattice\ncp terraform/google/example/lattice.google.tf google.tf\n\nGCP\u5411\u3051\u306etf\u30d5\u30a1\u30a4\u30eb\u3092example\u304b\u3089\u30b3\u30d4\u30fc\u3057\u3001\u7de8\u96c6\u3057\u307e\u3059\u3002\nmodule \"lattice-google\" {\n    source = \"github.com/cloudfoundry-incubator/lattice//terraform//google?ref=v0.2.4-75-g958293d\"\n\n    gce_account_file = \"account.json\"\n    gce_project = \"local-pier-93718\"  # GCP\u306eProject\u540d\n    gce_ssh_user = \"jacopen\" # GCP\u306b\u767b\u9332\u3057\u305fSSH\u9375\u306euser\u540d\n    gce_ssh_private_key_file = \"id_rsa_google\"\n    num_cells = \"3\" # \u30b3\u30f3\u30c6\u30ca\u3092\u52d5\u304b\u3059Lattice Cell\u306e\u6570\n    gce_region = \"asia-east1\" # \u52d5\u4f5c\u3055\u305b\u305f\u3044Region\n    gce_zone = \"asia-east1-b\" # \u52d5\u4f5c\u3055\u305b\u305f\u3044ZONE\n    gce_machine_type_cell = \"n1-standard-1\" # Cell\u306eMachine type\n}\n\noutput \"lattice_target\" {\n    value = \"${module.lattice-google.lattice_target}\"\n}\n\noutput \"lattice_username\" {\n    value = \"${module.lattice-google.lattice_username}\"\n}\n\noutput \"lattice_password\" {\n    value = \"${module.lattice-google.lattice_password}\"\n}\n\nexample\u306b\u3001 gce_region, gce_zone, gce_machine_type_cell \u3092\u8ffd\u52a0\u3057\u3066\u3044\u307e\u3059\u3002\n\u6a19\u6e96\u3067\u306fus-central1-a\u3068\u306a\u3063\u3066\u3057\u307e\u3046\u305f\u3081\u3001\u8ddd\u96e2\u304c\u9060\u304f\u30ec\u30a4\u30c6\u30f3\u30b7\u304c\u5927\u304d\u3044\u3067\u3059\u3002\u305d\u306e\u305f\u3081\u3001asia-east1-b\u3092\u6307\u5b9a\u3057\u3066\u3044\u307e\u3059\u3002\n\u307e\u305f\u3001\u6a19\u6e96\u306eMachine Type\u306fn1-standard-4(4Core 15GB Memory)\u3068\u3001\u3061\u3087\u3063\u3068\u8a66\u3059\u5206\u306b\u306f\u904e\u5270\u306a\u30b9\u30da\u30c3\u30af\u306a\u306e\u3067\u3001n1-standard-1\u3092\u6307\u5b9a\u3057\u3066\u3044\u307e\u3059\u3002\u305d\u306e\u4ee3\u308f\u308a\u3001Cell\u306e\u6570\u30923\u3068\u3057\u3066\u3044\u307e\u3059\u3002\n\nterraform apply\n\u3053\u3053\u307e\u3067\u51fa\u6765\u308c\u3070\u3001\u5f8c\u306fterraform get -> apply\u3059\u308b\u3060\u3051\u3067\u3059\u3002\n$ terraform get\n$ terraform apply\n\n\u6700\u5f8c\u307e\u3067\u901a\u3063\u305f\u3089\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u60c5\u5831\u304c\u8868\u793a\u3055\u308c\u3066\u3066\u3044\u308b\u306f\u305a\u3067\u3059\nOutputs:\n\n  lattice_password = pass\n  lattice_target   = 104.155.237.xxx.xip.io\n  lattice_username = user\n\n\n\u8a66\u3057\u3066\u307f\u308b\nltc\u30b3\u30de\u30f3\u30c9\u3067\u3001\u5b9f\u969b\u306bLattice\u3092\u4f7f\u3063\u3066\u307f\u307e\u3057\u3087\u3046\u3002\n$ ltc target 104.155.237.xxx.xip.io\nUsername: user\nPassword:\nApi Location Set\n\n$ ltc create lattice-app cloudfoundry/lattice-app\nNo port specified, image metadata did not contain exposed ports. Defaulting to 8080.\nNo working directory specified, using working directory from the image metadata...\nMonitoring the app on port 8080...\nNo start command specified, using start command from the image metadata...\nStart command is:\n/lattice-app\nCreating App: lattice-app\n......................09 May 20:19 [APP|0] Successfully created container\n09 May 20:19 [APP|0] {\"timestamp\":\"1431170351.597540855\",\"source\":\"lattice-app\",\"message\":\"lattice-app.lattice-app.starting\",\"log_level\":1,\"data\":{\"port\":\"8080\"}}\n09 May 20:19 [APP|0] {\"timestamp\":\"1431170351.597871065\",\"source\":\"lattice-app\",\"message\":\"lattice-app.lattice-app.up\",\"log_level\":1,\"data\":{\"port\":\"8080\"}}\n.09 May 20:19 [HEALTH|0] healthcheck passed\n09 May 20:19 [HEALTH|0] Exit status 0\n09 May 20:19 [APP|0] Lattice-app. Says Hello. on index: 0\n\nlattice-app is now running.\nApp is reachable at:\nhttp://lattice-app.104.155.237.xxx.xip.io\n\n\u6700\u5f8c\u306b\u8868\u793a\u3055\u308c\u3066\u3044\u308bURL\u306b\u30a2\u30af\u30bb\u30b9\u3059\u308b\u3068\u3001\u30b5\u30f3\u30d7\u30eb\u30a2\u30d7\u30ea\u306b\u7e4b\u304c\u308b\u306f\u305a\u3067\u3059\u3002\u7c21\u5358\u3067\u3059\u306d\uff01\nTerraform\u3067\u69cb\u7bc9\u304c\u51fa\u6765\u308b\u306e\u3067\u3001AWS\u3084Digital Ocean\u306e\u5834\u5408\u3082\u305d\u3046\u5927\u5dee\u306a\u3044\u64cd\u4f5c\u3067\u69cb\u7bc9\u304c\u53ef\u80fd\u306e\u306f\u305a\u3067\u3059\u3002\u662f\u975e\u4e00\u5ea6\u8a66\u3057\u3066\u307f\u3066\u304f\u3060\u3055\u3044\u3002\n\n\u95a2\u9023\u60c5\u5831\nLattice\u6df1\u6398\u308a\u8a71 http://www.slideshare.net/jacopen/lattice-47937770\n\nDocker image\u4e92\u63db\u306e\u30b3\u30f3\u30c6\u30ca\u7ba1\u7406\u30b7\u30b9\u30c6\u30e0\u3001Lattice(http://lattice.cf/) \u3092\u3001Google Cloud Platform\u4e0a\u306b\u69cb\u7bc9\u3059\u308b\u65b9\u6cd5\u3092\u89e3\u8aac\u3057\u307e\u3059\u3002\n\n## \u4e8b\u524d\u6e96\u5099\n\n### terraform\u306e\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\n\nLattice\u306e\u69cb\u7bc9\u306b\u306f\u3001HashiCorp\u306eTerraform\u3092\u5229\u7528\u3057\u307e\u3059\u3002\nTerraform\u306e\u30b5\u30a4\u30c8\u304b\u3089\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3057\u3066\u3001\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\u3092\u884c\u3063\u3066\u304a\u304d\u307e\u3059\nhttps://www.terraform.io/downloads.html\n\n\u672c\u8a18\u4e8b\u3067\u306f\u3001Terraform 0.5.0\u3092\u5229\u7528\u3057\u307e\u3059\u3002\n\n### Lattice\u306eclone\n\ngithub\u304b\u3089lattice\u3092clone\u3057\u307e\u3059\u3002\n\n````\ngit clone git@github.com:cloudfoundry-incubator/lattice.git\n````\n\u672c\u9805\u3067\u306fv0.2.4\u3092\u5229\u7528\u3057\u307e\u3059\u3002\n\n### ltc\u30b3\u30de\u30f3\u30c9\u306e\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\n\nLattice\u306e\u64cd\u4f5c\u306b\u5fc5\u8981\u306altc\u30b3\u30de\u30f3\u30c9\u306e\u30d0\u30a4\u30ca\u30ea\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3057\u3001PATH\u304c\u901a\u3063\u3066\u3044\u308b\u5834\u6240\u306b\u8a2d\u7f6e\u3057\u3066\u304a\u304d\u307e\u3059\n\nOSX https://lattice.s3.amazonaws.com/releases/v0.2.4/darwin-amd64/ltc\nLinux https://lattice.s3.amazonaws.com/releases/v0.2.4/linux-amd64/ltc\n\n## account file\u306e\u6e96\u5099\n\n\u4ee5\u4e0b\u306e\u624b\u9806\u3067GCP\u304b\u3089account file\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3057\u307e\u3059\u3002\n\n![gcp1.png](https://qiita-image-store.s3.amazonaws.com/0/17840/14b964f8-48f3-9a19-7d9b-08c8648fd6dc.png \"gcp1.png\")\n\n![gcp2.png](https://qiita-image-store.s3.amazonaws.com/0/17840/4f06dad4-1b32-d47c-5bfc-e579bcf66201.png \"gcp2.png\")\n\n![gcp3.png](https://qiita-image-store.s3.amazonaws.com/0/17840/6ef4febb-5596-0c77-46f9-7885a0905b77.png \"gcp3.png\")\n\n\u3053\u3053\u3067\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3055\u308c\u305fjson\u30d5\u30a1\u30a4\u30eb\u3092\u3001lattice\u306e\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306baccount.json\u3068\u3044\u3046\u540d\u524d\u3067\u4fdd\u5b58\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n\n## SSH\u9375\u306e\u4f5c\u6210\u3068\u767b\u9332\n\nGCP\u3067\u5229\u7528\u3059\u308bSSH\u9375\u3092\u751f\u6210\u3057\u3066\u304a\u304d\u307e\u3059\u3002\u3053\u3053\u3067\u306f\u3001id_rsa_google\u3068\u3044\u3046\u540d\u524d\u3067\u4f5c\u6210\u3057\u307e\u3059\n\n````\n$ ssh-keygen\nGenerating public/private rsa key pair.\nEnter file in which to save the key (/home/jacopen/.ssh/id_rsa): id_rsa_google\nEnter passphrase (empty for no passphrase):\nEnter same passphrase again:\n\u4ee5\u4e0b\u7565\n````\n\n\u4f5c\u6210\u304c\u7d42\u308f\u3063\u305f\u3089\u3001\u516c\u958b\u9375\u3092GCP\u306b\u767b\u9332\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n![gcp4.png](https://qiita-image-store.s3.amazonaws.com/0/17840/524678aa-c01b-7fcf-c0bb-0d3fe004b4fb.png \"gcp4.png\")\n\n\n## tf\u30d5\u30a1\u30a4\u30eb\u306e\u7de8\u96c6\n\n````\ncd lattice\ncp terraform/google/example/lattice.google.tf google.tf\n````\n\nGCP\u5411\u3051\u306etf\u30d5\u30a1\u30a4\u30eb\u3092example\u304b\u3089\u30b3\u30d4\u30fc\u3057\u3001\u7de8\u96c6\u3057\u307e\u3059\u3002\n\n````json\nmodule \"lattice-google\" {\n    source = \"github.com/cloudfoundry-incubator/lattice//terraform//google?ref=v0.2.4-75-g958293d\"\n\n    gce_account_file = \"account.json\"\n    gce_project = \"local-pier-93718\"  # GCP\u306eProject\u540d\n    gce_ssh_user = \"jacopen\" # GCP\u306b\u767b\u9332\u3057\u305fSSH\u9375\u306euser\u540d\n    gce_ssh_private_key_file = \"id_rsa_google\"\n    num_cells = \"3\" # \u30b3\u30f3\u30c6\u30ca\u3092\u52d5\u304b\u3059Lattice Cell\u306e\u6570\n    gce_region = \"asia-east1\" # \u52d5\u4f5c\u3055\u305b\u305f\u3044Region\n    gce_zone = \"asia-east1-b\" # \u52d5\u4f5c\u3055\u305b\u305f\u3044ZONE\n    gce_machine_type_cell = \"n1-standard-1\" # Cell\u306eMachine type\n}\n\noutput \"lattice_target\" {\n    value = \"${module.lattice-google.lattice_target}\"\n}\n\noutput \"lattice_username\" {\n    value = \"${module.lattice-google.lattice_username}\"\n}\n\noutput \"lattice_password\" {\n    value = \"${module.lattice-google.lattice_password}\"\n}\n````\nexample\u306b\u3001 **gce_region**, **gce_zone**, **gce_machine_type_cell** \u3092\u8ffd\u52a0\u3057\u3066\u3044\u307e\u3059\u3002\n\n\u6a19\u6e96\u3067\u306fus-central1-a\u3068\u306a\u3063\u3066\u3057\u307e\u3046\u305f\u3081\u3001\u8ddd\u96e2\u304c\u9060\u304f\u30ec\u30a4\u30c6\u30f3\u30b7\u304c\u5927\u304d\u3044\u3067\u3059\u3002\u305d\u306e\u305f\u3081\u3001asia-east1-b\u3092\u6307\u5b9a\u3057\u3066\u3044\u307e\u3059\u3002\n\n\u307e\u305f\u3001\u6a19\u6e96\u306eMachine Type\u306fn1-standard-4(4Core 15GB Memory)\u3068\u3001\u3061\u3087\u3063\u3068\u8a66\u3059\u5206\u306b\u306f\u904e\u5270\u306a\u30b9\u30da\u30c3\u30af\u306a\u306e\u3067\u3001n1-standard-1\u3092\u6307\u5b9a\u3057\u3066\u3044\u307e\u3059\u3002\u305d\u306e\u4ee3\u308f\u308a\u3001Cell\u306e\u6570\u30923\u3068\u3057\u3066\u3044\u307e\u3059\u3002\n\n\n## terraform apply\n\n\u3053\u3053\u307e\u3067\u51fa\u6765\u308c\u3070\u3001\u5f8c\u306fterraform get -> apply\u3059\u308b\u3060\u3051\u3067\u3059\u3002\n\n````\n$ terraform get\n$ terraform apply\n````\n\n\u6700\u5f8c\u307e\u3067\u901a\u3063\u305f\u3089\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u60c5\u5831\u304c\u8868\u793a\u3055\u308c\u3066\u3066\u3044\u308b\u306f\u305a\u3067\u3059\n\n````\nOutputs:\n\n  lattice_password = pass\n  lattice_target   = 104.155.237.xxx.xip.io\n  lattice_username = user\n````\n\n## \u8a66\u3057\u3066\u307f\u308b\n\nltc\u30b3\u30de\u30f3\u30c9\u3067\u3001\u5b9f\u969b\u306bLattice\u3092\u4f7f\u3063\u3066\u307f\u307e\u3057\u3087\u3046\u3002\n\n````bash\n$ ltc target 104.155.237.xxx.xip.io\nUsername: user\nPassword:\nApi Location Set\n\n$ ltc create lattice-app cloudfoundry/lattice-app\nNo port specified, image metadata did not contain exposed ports. Defaulting to 8080.\nNo working directory specified, using working directory from the image metadata...\nMonitoring the app on port 8080...\nNo start command specified, using start command from the image metadata...\nStart command is:\n/lattice-app\nCreating App: lattice-app\n......................09 May 20:19 [APP|0] Successfully created container\n09 May 20:19 [APP|0] {\"timestamp\":\"1431170351.597540855\",\"source\":\"lattice-app\",\"message\":\"lattice-app.lattice-app.starting\",\"log_level\":1,\"data\":{\"port\":\"8080\"}}\n09 May 20:19 [APP|0] {\"timestamp\":\"1431170351.597871065\",\"source\":\"lattice-app\",\"message\":\"lattice-app.lattice-app.up\",\"log_level\":1,\"data\":{\"port\":\"8080\"}}\n.09 May 20:19 [HEALTH|0] healthcheck passed\n09 May 20:19 [HEALTH|0] Exit status 0\n09 May 20:19 [APP|0] Lattice-app. Says Hello. on index: 0\n\nlattice-app is now running.\nApp is reachable at:\nhttp://lattice-app.104.155.237.xxx.xip.io\n````\n\n\u6700\u5f8c\u306b\u8868\u793a\u3055\u308c\u3066\u3044\u308bURL\u306b\u30a2\u30af\u30bb\u30b9\u3059\u308b\u3068\u3001\u30b5\u30f3\u30d7\u30eb\u30a2\u30d7\u30ea\u306b\u7e4b\u304c\u308b\u306f\u305a\u3067\u3059\u3002\u7c21\u5358\u3067\u3059\u306d\uff01\n\nTerraform\u3067\u69cb\u7bc9\u304c\u51fa\u6765\u308b\u306e\u3067\u3001AWS\u3084Digital Ocean\u306e\u5834\u5408\u3082\u305d\u3046\u5927\u5dee\u306a\u3044\u64cd\u4f5c\u3067\u69cb\u7bc9\u304c\u53ef\u80fd\u306e\u306f\u305a\u3067\u3059\u3002\u662f\u975e\u4e00\u5ea6\u8a66\u3057\u3066\u307f\u3066\u304f\u3060\u3055\u3044\u3002\n\n## \u95a2\u9023\u60c5\u5831\n\nLattice\u6df1\u6398\u308a\u8a71 http://www.slideshare.net/jacopen/lattice-47937770\n"}