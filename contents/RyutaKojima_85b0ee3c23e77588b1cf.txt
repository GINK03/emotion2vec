{"context": " More than 1 year has passed since last update.EC2\u306eAmazonLinux\u306f\u30c7\u30d5\u30a9\u30eb\u30c8\u3067root\u30ed\u30b0\u30a4\u30f3\u3092\u7981\u6b62\u3057\u3066\u3044\u308b\u305f\u3081\n\u4e00\u65e6 ec2-user\u3067\u30ed\u30b0\u30a4\u30f3\u3057\u3066\u304b\u3089\u6bce\u56de sudo su - \u3067root\u306b\u5909\u66f4\u3057\u306a\u3044\u3068\u3044\u3051\u306a\u3044\u3002\n\u500b\u4eba\u3067\u306e\u904b\u7528\u3060\u3068\u9762\u5012\u306a\u306e\u3067\u3001root\u30ed\u30b0\u30a4\u30f3\u3092\u53ef\u80fd\u306b\u8a2d\u5b9a\u3057\u305f\u3002\n\u307e\u305fAMI\u5316\u3057\u305f\u3042\u3068\u306b\u3001\u65b0\u3057\u3044ec2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u3092\u7acb\u3061\u4e0a\u3052\u308b\u3068\u8a2d\u5b9a\u304c\u623b\u3063\u3066\u3057\u307e\u3046\u306e\u3067\u3001\u305d\u308c\u306e\u5bfe\u5fdc\u3082\u3059\u308b\u3002\n\n\u30fbroot\u30e6\u30fc\u30b6\u30fc\u306b\u5207\u308a\u66ff\u3048\u308b\nsudo su -\n\n\u30fb\u8a2d\u5b9a\u5909\u66f4\nvi /etc/ssh/sshd_config\nPermitRootLogin forced-commands-only\n \u2193\nPermitRootLogin without-password\n\n\u30fbec2-user\u306e\u516c\u958b\u9375\u3092\u305d\u306e\u307e\u307e\u30b3\u30d4\u30fc\u3057\u307e\u3059\u3002\nmv /root/.ssh/authorized_keys /root/.ssh/authorized_keys_bak\ncp -f /home/ec2-user/.ssh/authorized_keys /root/.ssh/authorized_keys\nservice sshd reload\n\n\u30fb\u3053\u306e\u72b6\u614b\u3067AMI\u3092\u4f5c\u6210\u3057\u3066\u3001\u65b0\u3057\u3044\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u3092\u7acb\u3066\u308b\u3068\n\u3000root\u3067\u30ed\u30b0\u30a4\u30f3\u3067\u304d\u306a\u3044\u72b6\u614b\u306b\u623b\u308b(authorized_keys\u304c\u5909\u66f4\u3055\u308c\u308b)\n\u3000\u306e\u3067cloud-init\u3082\u5909\u66f4\u3057\u307e\u3059\u3002\nvi /etc/cloud/cloud.cfg\ndisable_root: false\n\u2193\ndisable_root: true\n\nEC2\u306eAmazonLinux\u306f\u30c7\u30d5\u30a9\u30eb\u30c8\u3067root\u30ed\u30b0\u30a4\u30f3\u3092\u7981\u6b62\u3057\u3066\u3044\u308b\u305f\u3081\n\u4e00\u65e6 ec2-user\u3067\u30ed\u30b0\u30a4\u30f3\u3057\u3066\u304b\u3089\u6bce\u56de sudo su - \u3067root\u306b\u5909\u66f4\u3057\u306a\u3044\u3068\u3044\u3051\u306a\u3044\u3002\n\n\u500b\u4eba\u3067\u306e\u904b\u7528\u3060\u3068\u9762\u5012\u306a\u306e\u3067\u3001root\u30ed\u30b0\u30a4\u30f3\u3092\u53ef\u80fd\u306b\u8a2d\u5b9a\u3057\u305f\u3002\n\u307e\u305fAMI\u5316\u3057\u305f\u3042\u3068\u306b\u3001\u65b0\u3057\u3044ec2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u3092\u7acb\u3061\u4e0a\u3052\u308b\u3068\u8a2d\u5b9a\u304c\u623b\u3063\u3066\u3057\u307e\u3046\u306e\u3067\u3001\u305d\u308c\u306e\u5bfe\u5fdc\u3082\u3059\u308b\u3002\n\n---\n\u30fbroot\u30e6\u30fc\u30b6\u30fc\u306b\u5207\u308a\u66ff\u3048\u308b\n`sudo su -`\n\n---\n\u30fb\u8a2d\u5b9a\u5909\u66f4\n```vi /etc/ssh/sshd_config\nPermitRootLogin forced-commands-only\n \u2193\nPermitRootLogin without-password```\n\n---\n\u30fbec2-user\u306e\u516c\u958b\u9375\u3092\u305d\u306e\u307e\u307e\u30b3\u30d4\u30fc\u3057\u307e\u3059\u3002\n```mv /root/.ssh/authorized_keys /root/.ssh/authorized_keys_bak\ncp -f /home/ec2-user/.ssh/authorized_keys /root/.ssh/authorized_keys\nservice sshd reload```\n\n---\n\u30fb\u3053\u306e\u72b6\u614b\u3067AMI\u3092\u4f5c\u6210\u3057\u3066\u3001\u65b0\u3057\u3044\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u3092\u7acb\u3066\u308b\u3068\n\u3000root\u3067\u30ed\u30b0\u30a4\u30f3\u3067\u304d\u306a\u3044\u72b6\u614b\u306b\u623b\u308b(authorized_keys\u304c\u5909\u66f4\u3055\u308c\u308b)\n\u3000\u306e\u3067cloud-init\u3082\u5909\u66f4\u3057\u307e\u3059\u3002\n```vi /etc/cloud/cloud.cfg\ndisable_root: false\n\u2193\ndisable_root: true```\n\n---\n", "tags": ["EC2", "AmazonLinux"]}