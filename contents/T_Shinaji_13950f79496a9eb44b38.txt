{"context": " More than 1 year has passed since last update.3D\u30d7\u30ea\u30f3\u30bfMojo\u306e\u505c\u6b62\u3092Python\u304c\u76e3\u8996\u3057\u3066Skype\u7d4c\u7531\u3067\u77e5\u3089\u305b\u3066\u304f\u308c\u308b\u30b9\u30af\u30ea\u30d7\u30c8\u3067\u3059\uff0e\nMojo\u306e\u30ed\u30b0\u3092\u76e3\u8996\u3057\u3066\u3068\u308a\u3042\u3048\u305a\u5168\u3066\u306e\u30ed\u30b0\u3092Skype\u306e\u30c1\u30e3\u30c3\u30c8\u3067\u9001\u308b\uff0e\n\u505c\u6b62\u3057\u305f\u6642\u306f\u96fb\u8a71\u3092\u304b\u3051\u308b\u3053\u3068\u306b\u3059\u308b\uff0e\nMojo\u304c\u518d\u958b\u53ef\u80fd\u306a\u72b6\u614b\u3067\u983b\u7e41\u306b\u505c\u6b62\u3059\u308b\u306e\u3067\u505c\u6b62\u3057\u305f\u3089\u77e5\u3089\u305b\u308b\u3088\u3046\u306b\u3057\u307e\u3057\u305f\uff0e\n\u81ea\u52d5\u3067\u518d\u958b\u3057\u306a\u3044\u306e\u306f\u30d7\u30ea\u30f3\u30c8\u306e\u7570\u5e38\u3092\u76ee\u8996\u3067\u78ba\u8a8d\u3059\u308b\u5fc5\u8981\u304c\u3042\u308b\u305f\u3081\u3067\u3059\n\n\u4f7f\u7528\u30e9\u30a4\u30d6\u30e9\u30ea\n\nSkype4py (Skype for Desktop\u3068\u63a5\u7d9a)\nwatchdog (Mojo\u306e\u30ed\u30b0\u3092\u76e3\u8996)\nnumpy (\u30ed\u30b0\u3092\u8aad\u3080\u306e\u306b\u4f7f\u3046)\n\n\n\u4f7f\u3044\u65b9\nMojo\u306e\u30ed\u30b0\u3078\u306e\u30d1\u30b9\u3068Skype\u306e\u9023\u7d61\u5148\u3092\u8a2d\u5b9a\u3059\u308b\u3060\u3051\n\u5b9f\u884c\u3059\u308c\u3070\u76e3\u8996\u304c\u30b9\u30bf\u30fc\u30c8\u3059\u308b\n\n\u53c2\u8003\n\nSkype4Py\nmuddy brown thang\n\u30d5\u30a1\u30a4\u30eb\u76e3\u8996\u306bwatchdog\u304c\u304b\u306a\u308a\u4fbf\u5229\u306a\u4ef6\n\n\n\u30b9\u30af\u30ea\u30d7\u30c8\n# -*- coding: utf-8 -*-\n\nimport time\nimport os\nimport re\nimport numpy as np\nfrom watchdog.events import FileSystemEventHandler\nfrom watchdog.observers import Observer\nimport Skype4Py\n\n#Mojo\u306e\u30ed\u30b0\u3078\u306e\u30d1\u30b9\nBASEDIR = \"C:/ProgramData/Mojo/Mojo 3D Printer Software/Log/\"\nlog_filename = \"SystemLog.log\"\n\n#\u9023\u7d61\u5148\nuser_name = 'Frend name'\n\n#-------Skype4Py\u306eexamples->callfriend.py\u304b\u3089\u30b3\u30d4\u30da(call\u7528)--------->\n# This variable will get its actual value in OnCall handler\nCallStatus = 0\n\n# Here we define a set of call statuses that indicate a call\n# has been either aborted or finished\nCallIsFinished = set([Skype4Py.clsFailed, Skype4Py.clsFinished,\n                       Skype4Py.clsMissed, Skype4Py.clsRefused,\n                       Skype4Py.clsBusy, Skype4Py.clsCancelled]);\n\ndef AttachmentStatusText(status):\n   return skype.Convert.AttachmentStatusToText(status)\n\ndef CallStatusText(status):\n    return skype.Convert.CallStatusToText(status)\n\n# This handler is fired when status of Call object has changed\ndef OnCall(call, status):\n    global CallStatus\n    CallStatus = status\n    print 'Call status: ' + CallStatusText(status)\n\n# This handler is fired when Skype attatchment status changes\ndef OnAttach(status):\n    print 'API attachment status: ' + AttachmentStatusText(status)\n    if status == Skype4Py.apiAttachAvailable:\n        skype.Attach()\n#<--\u30b3\u30d4\u30da\u3053\u3053\u307e\u3067----------------------------------------------------\n\n#Skype\u306b\u30a2\u30bf\u30c3\u30c1\u30fb\u30c1\u30e3\u30c3\u30c8\u8a2d\u5b9a\nskype = Skype4Py.Skype()\nif not skype.Client.IsRunning:\n    print 'Starting Skype..'\n    skype.Client.Start()\nskype.Attach()\nskype.OnAttachmentStatus = OnAttach\nskype.OnCallStatus = OnCall\nchat = skype.CreateChatWith(user_name)\nchat.SendMessage('Mojo''s watchdog has been started!')\n\n#Mojo\u30ed\u30b0\u76e3\u8996\nclass ChangeHandler(FileSystemEventHandler):\n\n    def on_modified(self, event):\n        if event.is_directory:\n            return\n        else:\n            time.sleep(5)\n            data = np.loadtxt(\n               os.path.join(BASEDIR, log_filename),\n               delimiter=\"\\n\", dtype=str)\n            #-1\u3067\u6700\u5f8c\u306e\u884c(\u6700\u65b0\u306e\u30ed\u30b0\u60c5\u5831)\u3060\u3051\u51fa\u529b\n            print(data[-1])\n            chat.SendMessage(data[-1])\n            #Pause\u304c\u542b\u307e\u308c\u308b\u3068\u304d\u306f\u96fb\u8a71\u3092\u304b\u3051\u308b\n            n = len(re.findall('pause', data[-1])) + \\\n                len(re.findall('Paused', data[-1]))\n            if n > 0:\n                 skype.PlaceCall(user_name)\n                while not CallStatus in CallIsFinished:\n                    pass\n\n#\"\u30d5\u30a1\u30a4\u30eb\u76e3\u8996\u306bwatchdog\u304c\u304b\u306a\u308a\u4fbf\u5229\u306a\u4ef6\"\u306e\u30b3\u30fc\u30c9\u3092\u30b3\u30d4\u30da\nif __name__ in '__main__':\n    while 1:\n        event_handler = ChangeHandler()\n        observer = Observer()\n        observer.schedule(event_handler, BASEDIR, recursive=True)\n        observer.start()\n        try:\n            while True:\n                time.sleep(1)\n        except KeyboardInterrupt:\n            observer.stop()\n        observer.join()\n\n3D\u30d7\u30ea\u30f3\u30bfMojo\u306e\u505c\u6b62\u3092Python\u304c\u76e3\u8996\u3057\u3066Skype\u7d4c\u7531\u3067\u77e5\u3089\u305b\u3066\u304f\u308c\u308b\u30b9\u30af\u30ea\u30d7\u30c8\u3067\u3059\uff0e\n\nMojo\u306e\u30ed\u30b0\u3092\u76e3\u8996\u3057\u3066\u3068\u308a\u3042\u3048\u305a\u5168\u3066\u306e\u30ed\u30b0\u3092Skype\u306e\u30c1\u30e3\u30c3\u30c8\u3067\u9001\u308b\uff0e\n\u505c\u6b62\u3057\u305f\u6642\u306f\u96fb\u8a71\u3092\u304b\u3051\u308b\u3053\u3068\u306b\u3059\u308b\uff0e\n\nMojo\u304c\u518d\u958b\u53ef\u80fd\u306a\u72b6\u614b\u3067\u983b\u7e41\u306b\u505c\u6b62\u3059\u308b\u306e\u3067\u505c\u6b62\u3057\u305f\u3089\u77e5\u3089\u305b\u308b\u3088\u3046\u306b\u3057\u307e\u3057\u305f\uff0e\n\u81ea\u52d5\u3067\u518d\u958b\u3057\u306a\u3044\u306e\u306f\u30d7\u30ea\u30f3\u30c8\u306e\u7570\u5e38\u3092\u76ee\u8996\u3067\u78ba\u8a8d\u3059\u308b\u5fc5\u8981\u304c\u3042\u308b\u305f\u3081\u3067\u3059\n\n\u4f7f\u7528\u30e9\u30a4\u30d6\u30e9\u30ea\n--------------\n * Skype4py (Skype for Desktop\u3068\u63a5\u7d9a)\n * watchdog (Mojo\u306e\u30ed\u30b0\u3092\u76e3\u8996)\n * numpy (\u30ed\u30b0\u3092\u8aad\u3080\u306e\u306b\u4f7f\u3046)\n\n\u4f7f\u3044\u65b9\n------------\nMojo\u306e\u30ed\u30b0\u3078\u306e\u30d1\u30b9\u3068Skype\u306e\u9023\u7d61\u5148\u3092\u8a2d\u5b9a\u3059\u308b\u3060\u3051\n\u5b9f\u884c\u3059\u308c\u3070\u76e3\u8996\u304c\u30b9\u30bf\u30fc\u30c8\u3059\u308b\n\n\u53c2\u8003\n---------------\n * [Skype4Py](https://github.com/awahlig/skype4py \"Skype4Py\")\n * [muddy brown thang](http://d.hatena.ne.jp/moriyoshi/20100926/1285517353, \"muddy brown thang\")\n * [\u30d5\u30a1\u30a4\u30eb\u76e3\u8996\u306bwatchdog\u304c\u304b\u306a\u308a\u4fbf\u5229\u306a\u4ef6](http://qiita.com/PyYoshi@github/items/9744a138c018734c69db \"\u30d5\u30a1\u30a4\u30eb\u76e3\u8996\u306bwatchdog\u304c\u304b\u306a\u308a\u4fbf\u5229\u306a\u4ef6\")\n\n\u30b9\u30af\u30ea\u30d7\u30c8\n---------\n\n```py:\n# -*- coding: utf-8 -*-\n\nimport time\nimport os\nimport re\nimport numpy as np\nfrom watchdog.events import FileSystemEventHandler\nfrom watchdog.observers import Observer\nimport Skype4Py\n\n#Mojo\u306e\u30ed\u30b0\u3078\u306e\u30d1\u30b9\nBASEDIR = \"C:/ProgramData/Mojo/Mojo 3D Printer Software/Log/\"\nlog_filename = \"SystemLog.log\"\n\n#\u9023\u7d61\u5148\nuser_name = 'Frend name'\n\n#-------Skype4Py\u306eexamples->callfriend.py\u304b\u3089\u30b3\u30d4\u30da(call\u7528)--------->\n# This variable will get its actual value in OnCall handler\nCallStatus = 0\n\n# Here we define a set of call statuses that indicate a call\n# has been either aborted or finished\nCallIsFinished = set([Skype4Py.clsFailed, Skype4Py.clsFinished,\n                       Skype4Py.clsMissed, Skype4Py.clsRefused,\n                       Skype4Py.clsBusy, Skype4Py.clsCancelled]);\n\ndef AttachmentStatusText(status):\n   return skype.Convert.AttachmentStatusToText(status)\n\ndef CallStatusText(status):\n    return skype.Convert.CallStatusToText(status)\n\n# This handler is fired when status of Call object has changed\ndef OnCall(call, status):\n    global CallStatus\n    CallStatus = status\n    print 'Call status: ' + CallStatusText(status)\n\n# This handler is fired when Skype attatchment status changes\ndef OnAttach(status):\n    print 'API attachment status: ' + AttachmentStatusText(status)\n    if status == Skype4Py.apiAttachAvailable:\n        skype.Attach()\n#<--\u30b3\u30d4\u30da\u3053\u3053\u307e\u3067----------------------------------------------------\n\n#Skype\u306b\u30a2\u30bf\u30c3\u30c1\u30fb\u30c1\u30e3\u30c3\u30c8\u8a2d\u5b9a\nskype = Skype4Py.Skype()\nif not skype.Client.IsRunning:\n    print 'Starting Skype..'\n    skype.Client.Start()\nskype.Attach()\nskype.OnAttachmentStatus = OnAttach\nskype.OnCallStatus = OnCall\nchat = skype.CreateChatWith(user_name)\nchat.SendMessage('Mojo''s watchdog has been started!')\n\n#Mojo\u30ed\u30b0\u76e3\u8996\nclass ChangeHandler(FileSystemEventHandler):\n\n    def on_modified(self, event):\n        if event.is_directory:\n            return\n        else:\n            time.sleep(5)\n            data = np.loadtxt(\n               os.path.join(BASEDIR, log_filename),\n               delimiter=\"\\n\", dtype=str)\n            #-1\u3067\u6700\u5f8c\u306e\u884c(\u6700\u65b0\u306e\u30ed\u30b0\u60c5\u5831)\u3060\u3051\u51fa\u529b\n            print(data[-1])\n            chat.SendMessage(data[-1])\n            #Pause\u304c\u542b\u307e\u308c\u308b\u3068\u304d\u306f\u96fb\u8a71\u3092\u304b\u3051\u308b\n            n = len(re.findall('pause', data[-1])) + \\\n                len(re.findall('Paused', data[-1]))\n            if n > 0:\n\t\t\t     skype.PlaceCall(user_name)\n                while not CallStatus in CallIsFinished:\n                    pass\n\n#\"\u30d5\u30a1\u30a4\u30eb\u76e3\u8996\u306bwatchdog\u304c\u304b\u306a\u308a\u4fbf\u5229\u306a\u4ef6\"\u306e\u30b3\u30fc\u30c9\u3092\u30b3\u30d4\u30da\nif __name__ in '__main__':\n    while 1:\n        event_handler = ChangeHandler()\n        observer = Observer()\n        observer.schedule(event_handler, BASEDIR, recursive=True)\n        observer.start()\n        try:\n            while True:\n                time.sleep(1)\n        except KeyboardInterrupt:\n            observer.stop()\n        observer.join()\n```\n\n", "tags": ["Python2.7", "Skype4Py", "numpy", "watchdog", "skype"]}