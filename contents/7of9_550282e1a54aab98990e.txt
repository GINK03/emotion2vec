{"tags": ["cppBuilder", "fileIO"], "context": "\n\u52d5\u4f5c\u78ba\u8a8d\nC++ Builder XE4\n\n\n\n\u3084\u308a\u305f\u3044\u3053\u3068\nC:\\Users\\user\\Documents\\RAD Studio\\Projects\\00-work\n\n\u306e\u6700\u4e0b\u5c64\u30d5\u30a9\u30eb\u30c000-work\u3092\u4ee5\u4e0b\u306e\u3088\u3046\u306bprefix\u6587\u5b57(L\"PRE_\"\u306a\u3069)\u3092\u3064\u3051\u305f\u3044\u3002\nC:\\Users\\user\\Documents\\RAD Studio\\Projects\\PRE_00-work\n\n\ncode v0.1\n\nUnit1.cpp\n//---------------------------------------------------------------------------\n\n#include <vcl.h>\n#pragma hdrstop\n\n#include <IOUtils.hpp>\n#include <memory>\n#include \"Unit1.h\"\n//---------------------------------------------------------------------------\n#pragma package(smart_init)\n#pragma resource \"*.dfm\"\nTForm1 *Form1;\n//---------------------------------------------------------------------------\n__fastcall TForm1::TForm1(TComponent* Owner)\n    : TForm(Owner)\n{\n}\n//---------------------------------------------------------------------------\n\nString getDeepestDir(String srcstr)\n{\n    // [AAA\\\\BBB\\\\CCC\\\\DDD]\u304b\u3089[DDD]\u3092\u53d6\u5f97\u3059\u308b\n\n    std::unique_ptr<TStringList> list(new TStringList);\n\n    list->StrictDelimiter = true;\n    list->Delimiter = L'\\\\';\n    list->DelimitedText = ExcludeTrailingPathDelimiter(srcstr);\n\n    return list->Strings[list->Count - 1];\n}\n\nString addPrefixToDeepestDirName(String srcstr, String prefix)\n{\n    String dpst = getDeepestDir(srcstr);\n    String prnt = TDirectory::GetParent(srcstr);\n\n    return prnt + L\"\\\\\" + prefix + dpst;\n}\n\nvoid __fastcall TForm1::Button1Click(TObject *Sender)\n{\n    String path = L\"C:\\\\Users\\\\user\\\\Documents\\\\RAD Studio\\\\Projects\\\\00-work\";\n\n    String res = addPrefixToDeepestDirName(path, L\"PRE_\");\n    OutputDebugString(res.c_str());\n\n}\n//---------------------------------------------------------------------------\n\n\n\n\u7d50\u679c\n\u30c7\u30d0\u30c3\u30b0\u51fa\u529b: C:\\Users\\user\\Documents\\RAD Studio\\Projects\\PRE_00-work \u30d7\u30ed\u30bb\u30b9 Project1.exe (3176)\n\n\n\u95a2\u9023 \nc++ builder / fileIO > \u6700\u4e0b\u5c64\u30d5\u30a9\u30eb\u30c0\u540d\u3092\u53d6\u5f97\u3059\u308b\u5b9f\u88c5\n\ncode v0.2\naddPrefixToDeepestDirName()\u3092\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u4fee\u6b63\u3057\u305f\u3002\n\u6587\u5b57\u5217\u306e\u6700\u5f8c\u306bL\"\\\\\"\u304c\u3064\u3044\u3066\u3044\u308b\u6642\u306b\u7f6e\u63db\u304c\u5931\u6557\u3057\u3066\u3001\u6700\u4e0b\u5c64\u30d5\u30a9\u30eb\u30c0\u306e\u3055\u3089\u306b\u4e0b\u306b\u30d5\u30a9\u30eb\u30c0\u3092\u4f5c\u3063\u3066\u3057\u307e\u3046\u4e0d\u5177\u5408\u306b\u6c17\u3065\u3044\u305f\u305f\u3081\u3002\nString addPrefixToDeepestDirName(String srcstr, String prefix)\n{\n    String wrksrc = ExcludeTrailingPathDelimiter(srcstr);\n\n    String dpst = getDeepestDir(wrksrc);\n    String prnt = TDirectory::GetParent(wrksrc);\n\n    return prnt + L\"\\\\\" + prefix + dpst;\n}\n\n```txt:\u52d5\u4f5c\u78ba\u8a8d\nC++ Builder XE4\n```\n\n## \u3084\u308a\u305f\u3044\u3053\u3068\n\n```\nC:\\Users\\user\\Documents\\RAD Studio\\Projects\\00-work\n```\n\n\u306e\u6700\u4e0b\u5c64\u30d5\u30a9\u30eb\u30c000-work\u3092\u4ee5\u4e0b\u306e\u3088\u3046\u306bprefix\u6587\u5b57(L\"PRE_\"\u306a\u3069)\u3092\u3064\u3051\u305f\u3044\u3002\n\n```\nC:\\Users\\user\\Documents\\RAD Studio\\Projects\\PRE_00-work\n```\n\n\n## code v0.1\n\n```Unit1.cpp\n//---------------------------------------------------------------------------\n\n#include <vcl.h>\n#pragma hdrstop\n\n#include <IOUtils.hpp>\n#include <memory>\n#include \"Unit1.h\"\n//---------------------------------------------------------------------------\n#pragma package(smart_init)\n#pragma resource \"*.dfm\"\nTForm1 *Form1;\n//---------------------------------------------------------------------------\n__fastcall TForm1::TForm1(TComponent* Owner)\n\t: TForm(Owner)\n{\n}\n//---------------------------------------------------------------------------\n\nString getDeepestDir(String srcstr)\n{\n    // [AAA\\\\BBB\\\\CCC\\\\DDD]\u304b\u3089[DDD]\u3092\u53d6\u5f97\u3059\u308b\n\n\tstd::unique_ptr<TStringList> list(new TStringList);\n\n    list->StrictDelimiter = true;\n    list->Delimiter = L'\\\\';\n    list->DelimitedText = ExcludeTrailingPathDelimiter(srcstr);\n\n\treturn list->Strings[list->Count - 1];\n}\n\nString addPrefixToDeepestDirName(String srcstr, String prefix)\n{\n\tString dpst = getDeepestDir(srcstr);\n\tString prnt = TDirectory::GetParent(srcstr);\n\n\treturn prnt + L\"\\\\\" + prefix + dpst;\n}\n\nvoid __fastcall TForm1::Button1Click(TObject *Sender)\n{\n\tString path = L\"C:\\\\Users\\\\user\\\\Documents\\\\RAD Studio\\\\Projects\\\\00-work\";\n\n\tString res = addPrefixToDeepestDirName(path, L\"PRE_\");\n\tOutputDebugString(res.c_str());\n\n}\n//---------------------------------------------------------------------------\n```\n\n\n```txt:\u7d50\u679c\n\u30c7\u30d0\u30c3\u30b0\u51fa\u529b: C:\\Users\\user\\Documents\\RAD Studio\\Projects\\PRE_00-work \u30d7\u30ed\u30bb\u30b9 Project1.exe (3176)\n```\n\n\u95a2\u9023 \n[c++ builder / fileIO > \u6700\u4e0b\u5c64\u30d5\u30a9\u30eb\u30c0\u540d\u3092\u53d6\u5f97\u3059\u308b\u5b9f\u88c5](http://qiita.com/7of9/items/f788bfacf06a9fa99610)\n\n\n## code v0.2\n\naddPrefixToDeepestDirName()\u3092\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u4fee\u6b63\u3057\u305f\u3002\n\u6587\u5b57\u5217\u306e\u6700\u5f8c\u306b`L\"\\\\\"`\u304c\u3064\u3044\u3066\u3044\u308b\u6642\u306b\u7f6e\u63db\u304c\u5931\u6557\u3057\u3066\u3001\u6700\u4e0b\u5c64\u30d5\u30a9\u30eb\u30c0\u306e\u3055\u3089\u306b\u4e0b\u306b\u30d5\u30a9\u30eb\u30c0\u3092\u4f5c\u3063\u3066\u3057\u307e\u3046\u4e0d\u5177\u5408\u306b\u6c17\u3065\u3044\u305f\u305f\u3081\u3002\n\n```\nString addPrefixToDeepestDirName(String srcstr, String prefix)\n{\n\tString wrksrc = ExcludeTrailingPathDelimiter(srcstr);\n\n\tString dpst = getDeepestDir(wrksrc);\n\tString prnt = TDirectory::GetParent(wrksrc);\n\n    return prnt + L\"\\\\\" + prefix + dpst;\n}\n```\n"}