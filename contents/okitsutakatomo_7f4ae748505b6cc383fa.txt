{"context": " More than 1 year has passed since last update.\u7fbd\u7530\u7a7a\u6e2f\u306e\u99d0\u8eca\u5834\u4e88\u7d04\u304c\u304b\u306a\u308a\u6fc0\u6226\u306a\u306e\u3067\u4f5c\u308a\u307e\u3057\u305f\u3002\n\u307b\u3093\u3068\u3069\u3046\u3067\u3082\u3044\u3044\u5185\u5bb9\u306a\u306e\u3067\u3001\u30bd\u30fc\u30b9\u3060\u3051\u306e\u305b\u3066\u7d42\u4e86\u3057\u307e\u3059\u3002\nrequire 'open-uri'\nrequire 'nokogiri'\n\n@reserve_days = [28, 29, 30]\n\ndef reserved_dai2ordai3?(doc, parking_num, day) \n    index = 0\n    if parking_num == 2\n        index = 1 #td index\n    elsif parking_num == 3\n        index = 3 #td index\n    end\n    doc.css(\"#guide_01 table tr\")[2].css(\"td\")[index].css(\".calday\").each do |dom| \n        if dom.text == \"#{day}\"\n            return dom.attribute(\"class\").value.include?(\"bgRed\")\n        end\n    end\nend\n\ndef reserved_dai4?(doc, day) \n    doc.css(\"#calendar01 table.calendar_waku td\").each do |dom| \n        if dom.text == \"#{day}\"\n            return dom.attribute(\"class\").value.include?(\"full\")\n        end\n    end\nend\n\ndef can_reserve?(parking_num, days)\n    if parking_num == 4 \n        doc = make_doc('https://haneda-p4.jp/airport/entrance/0000.jsf')\n        days.each do |day|\n            if reserved_dai4?(doc, day)\n                return false\n            end\n        end \n    else\n        doc = make_doc('https://hnd-rsv.aeif.or.jp/airport/entrance/0000.jsf')\n        days.each do |day|\n            if reserved_dai2ordai3?(doc, parking_num, day)\n                return false\n            end\n        end \n    end\n    return true\nend\n\ndef make_doc(url)\n    charset = nil\n    html = open(url) do |f|\n      charset = f.charset\n      f.read\n    end\n\n    doc = Nokogiri::HTML.parse(html, nil, charset)\nend\n\n# dai2\np can_reserve?(2, @reserve_days)\n\n# dai3\np can_reserve?(3, @reserve_days)\n\n# dai4\np can_reserve?(4, @reserve_days)\n\n\n\u7fbd\u7530\u7a7a\u6e2f\u306e\u99d0\u8eca\u5834\u4e88\u7d04\u304c\u304b\u306a\u308a\u6fc0\u6226\u306a\u306e\u3067\u4f5c\u308a\u307e\u3057\u305f\u3002\n\u307b\u3093\u3068\u3069\u3046\u3067\u3082\u3044\u3044\u5185\u5bb9\u306a\u306e\u3067\u3001\u30bd\u30fc\u30b9\u3060\u3051\u306e\u305b\u3066\u7d42\u4e86\u3057\u307e\u3059\u3002\n\n```\nrequire 'open-uri'\nrequire 'nokogiri'\n\n@reserve_days = [28, 29, 30]\n\ndef reserved_dai2ordai3?(doc, parking_num, day) \n    index = 0\n    if parking_num == 2\n        index = 1 #td index\n    elsif parking_num == 3\n        index = 3 #td index\n    end\n    doc.css(\"#guide_01 table tr\")[2].css(\"td\")[index].css(\".calday\").each do |dom| \n        if dom.text == \"#{day}\"\n            return dom.attribute(\"class\").value.include?(\"bgRed\")\n        end\n    end\nend\n\ndef reserved_dai4?(doc, day) \n    doc.css(\"#calendar01 table.calendar_waku td\").each do |dom| \n        if dom.text == \"#{day}\"\n            return dom.attribute(\"class\").value.include?(\"full\")\n        end\n    end\nend\n\ndef can_reserve?(parking_num, days)\n    if parking_num == 4 \n        doc = make_doc('https://haneda-p4.jp/airport/entrance/0000.jsf')\n        days.each do |day|\n            if reserved_dai4?(doc, day)\n                return false\n            end\n        end \n    else\n        doc = make_doc('https://hnd-rsv.aeif.or.jp/airport/entrance/0000.jsf')\n        days.each do |day|\n            if reserved_dai2ordai3?(doc, parking_num, day)\n                return false\n            end\n        end \n    end\n    return true\nend\n\ndef make_doc(url)\n    charset = nil\n    html = open(url) do |f|\n      charset = f.charset\n      f.read\n    end\n    \n    doc = Nokogiri::HTML.parse(html, nil, charset)\nend\n\n# dai2\np can_reserve?(2, @reserve_days)\n\n# dai3\np can_reserve?(3, @reserve_days)\n\n# dai4\np can_reserve?(4, @reserve_days)\n```\n", "tags": ["\u7fbd\u7530\u7a7a\u6e2f", "Ruby", "Nokogiri"]}