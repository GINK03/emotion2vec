{"context": " More than 1 year has passed since last update.\n\n\u516c\u5f0f\u3067\u516c\u958b\u3055\u308c\u3066\u3044\u308bApache\n\n2.2.29\u30012.2\n2.4.12\u30012.4\u30012\u3001latest\n\n\u516c\u5f0f\uff1ahttps://github.com/docker-library/docs/tree/master/httpd\n\u4eca\u56de\u306f\u30012.2.29\u3092\u5c0e\u5165\u3057\u3066\u307f\u307e\u3059\u3002\n\u306a\u304a\u3001\u793e\u5185\u30d7\u30ed\u30ad\u30b7\u74b0\u5883\u3067\u3042\u308b\u305f\u3081\u3061\u3087\u304f\u3061\u3087\u304f\u4fee\u6b63\u3057\u3066\u3044\u307e\u3059\n\u618e\u304d\u30d7\u30ed\u30ad\u30b7\u3081\u2026\u3002\n\n\u74b0\u5883\n[root@master httpd]# docker version\nClient version: 1.6.2.el7\nClient API version: 1.18\nGo version (client): go1.4.2\nGit commit (client): c3ca5bb/1.6.2\nOS/Arch (client): linux/amd64\nServer version: 1.6.2.el7\nServer API version: 1.18\nGo version (server): go1.4.2\nGit commit (server): c3ca5bb/1.6.2\nOS/Arch (server): linux/amd64\n[root@master httpd]#\n[root@master httpd]# uname -a\nLinux master 3.10.0-123.el7.x86_64 #1 SMP Mon Jun 30 12:09:22 UTC 2014 x86_64 x86_64 x86_64 GNU/Linux\n\n\nDockerfile\u306e\u4f5c\u6210\n\u516c\u5f0f\u3088\u308aDockerfile\u3092\u53d6\u5f97\u3057\u3001\u30ed\u30fc\u30ab\u30eb\u3078\u30b3\u30d4\u30fc\u3057\u307e\u3059\nhttps://github.com/docker-library/httpd/blob/63cd0ad57a12c76ff70d0f501f6c2f1580fa40f5/2.2/Dockerfile\nmkdir /export/docker/httpd\ncd /export/docker/httpd\n\nvi Dockerfile\n\n\nDockerfile\nFROM debian:jessie\n\n# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added\n#RUN groupadd -r www-data && useradd -r --create-home -g www-data www-data\n\nENV HTTPD_PREFIX /usr/local/apache2\nENV PATH $PATH:$HTTPD_PREFIX/bin\nRUN mkdir -p \"$HTTPD_PREFIX\" \\\n    && chown www-data:www-data \"$HTTPD_PREFIX\"\nWORKDIR $HTTPD_PREFIX\n\n# install httpd runtime dependencies\n# https://httpd.apache.org/docs/2.4/install.html#requirements\nRUN apt-get update \\\n    && apt-get install -y --no-install-recommends \\\n        libapr1 \\\n        libaprutil1 \\\n        libpcre++0 \\\n        libssl1.0.0 \\\n    && rm -r /var/lib/apt/lists/*\n\n# see https://httpd.apache.org/download.cgi#verify\nRUN gpg --keyserver ha.pool.sks-keyservers.net --recv-keys B1B96F45DFBDCCF974019235193F180AB55D9977\n\nENV HTTPD_VERSION 2.2.29\nENV HTTPD_BZ2_URL https://www.apache.org/dist/httpd/httpd-$HTTPD_VERSION.tar.bz2\n\nRUN buildDeps=' \\\n        ca-certificates \\\n        curl \\\n        bzip2 \\\n        gcc \\\n        libapr1-dev \\\n        libaprutil1-dev \\\n        libc6-dev \\\n        libpcre++-dev \\\n        libssl-dev \\\n        make \\\n    ' \\\n    set -x \\\n    && apt-get update \\\n    && apt-get install -y --no-install-recommends $buildDeps \\\n    && rm -r /var/lib/apt/lists/* \\\n    && curl -SL \"$HTTPD_BZ2_URL\" -o httpd.tar.bz2 \\\n    && curl -SL \"$HTTPD_BZ2_URL.asc\" -o httpd.tar.bz2.asc \\\n    && gpg --verify httpd.tar.bz2.asc \\\n    && mkdir -p src/httpd \\\n    && tar -xvf httpd.tar.bz2 -C src/httpd --strip-components=1 \\\n    && rm httpd.tar.bz2* \\\n    && cd src/httpd \\\n    && ./configure --enable-so --enable-ssl --prefix=$HTTPD_PREFIX \\\n    && make -j\"$(nproc)\" \\\n    && make install \\\n    && cd ../../ \\\n    && rm -r src/httpd \\\n    && sed -ri ' \\\n        s!^(\\s*CustomLog)\\s+\\S+!\\1 /proc/self/fd/1!g; \\\n        s!^(\\s*ErrorLog)\\s+\\S+!\\1 /proc/self/fd/2!g; \\\n        ' /usr/local/apache2/conf/httpd.conf \\\n    && apt-get purge -y --auto-remove $buildDeps\n\nCOPY httpd-foreground /usr/local/bin/\n\nEXPOSE 80\nCMD [\"httpd-foreground\"]\n\n\n\u30d7\u30ed\u30ad\u30b7\u3067\u5236\u9650\u3042\u308b\u5834\u5408\n\u305d\u306e\u307e\u307edocker build\u3059\u308b\u3068\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u30e1\u30c3\u30bb\u30fc\u30b8\u304c\u51fa\u307e\u3059\nStep 6 : RUN gpg --keyserver ha.pool.sks-keyservers.net --recv-keys B1B96F45DFBDCCF974019235193F180AB55D9977\n ---> Running in c49c0ae021f2\ngpg: directory `/root/.gnupg' created\ngpg: new configuration file `/root/.gnupg/gpg.conf' created\ngpg: WARNING: options in `/root/.gnupg/gpg.conf' are not yet active during this run\ngpg: keyring `/root/.gnupg/secring.gpg' created\ngpg: keyring `/root/.gnupg/pubring.gpg' created\ngpg: requesting key B55D9977 from hkp server ha.pool.sks-keyservers.net\ngpg: keyserver timed out\ngpg: keyserver receive failed: keyserver error\nINFO[0127] The command [/bin/sh -c gpg --keyserver ha.pool.sks-keyservers.net --recv-keys B1B96F45DFBDCCF974019235193F180AB55D9977] returned a non-zero code: 2\n\n\u3068\u304b\n\n+ rm -r /var/lib/apt/lists/httpredir.debian.org_debian_dists_jessie-updates_InRelease /var/lib/apt/lists/httpredir.debian.org_debian_dists_jessie-updates_main_binary-amd64_Packages.gz /var/lib/apt/lists/httpredir.debian.org_debian_dists_jessie_InRelease /var/lib/apt/lists/httpredir.debian.org_debian_dists_jessie_main_binary-amd64_Packages.gz /var/lib/apt/lists/lock /var/lib/apt/lists/partial /var/lib/apt/lists/security.debian.org_dists_jessie_updates_InRelease /var/lib/apt/lists/security.debian.org_dists_jessie_updates_main_binary-amd64_Packages.gz\n+ curl -SL https://www.apache.org/dist/httpd/httpd-2.2.29.tar.bz2 -o httpd.tar.bz2\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:--  0:04:14 --:--:--     0curl: (7) Failed to connect to www.apache.org port 443: Connection timed out\n\n\u4ee5\u4e0b\u306e\u8a2d\u5b9a\u3092\u5909\u66f4\u3057\u307e\u3057\u3087\u3046\n-RUN gpg --keyserver ha.pool.sks-keyservers.net --recv-keys B1B96F45DFBDCCF974019235193F180AB55D9977\n\n+RUN gpg --keyserver ha.pool.sks-keyservers.net --keyserver-option http-proxy=http://\u30a2\u30ab\u30a6\u30f3\u30c8\u540d:\u30d1\u30b9\u30ef\u30fc\u30c9@\u30a2\u30c9\u30ec\u30b9:\u30dd\u30fc\u30c8 --recv-keys B1B96F45DFBDCCF974019235193F180AB55D9977\n\n\n\n\n-&& curl -SL \"$HTTPD_BZ2_URL\" -o httpd.tar.bz2 \\\n-&& curl -SL \"$HTTPD_BZ2_URL.asc\" -o httpd.tar.bz2.asc \\\n\n+&& curl -U \u30a2\u30ab\u30a6\u30f3\u30c8\u540d:\u30d1\u30b9\u30ef\u30fc\u30c9 -x \u30a2\u30c9\u30ec\u30b9:\u30dd\u30fc\u30c8 -SL \"$HTTPD_BZ2_URL\" -o httpd.tar.bz2 \\\n+&& curl -U \u30a2\u30ab\u30a6\u30f3\u30c8\u540d:\u30d1\u30b9\u30ef\u30fc\u30c9 -x \u30a2\u30c9\u30ec\u30b9:\u30dd\u30fc\u30c8 -SL \"$HTTPD_BZ2_URL.asc\" -o httpd.tar.bz2.asc \\\n\n\u203b\u30d1\u30b9\u30ef\u30fc\u30c9\u306b\u7279\u6b8a\u8a18\u53f7\u3092\u4f7f\u7528\u3057\u3066\u3044\u308b\u5834\u5408\u306fURL\u30a8\u30f3\u30b3\u30fc\u30c9\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\n\nhttpd-foreground\u306e\u4f5c\u6210\nvi httpd-foreground\nchmod a+x httpd-foreground\n\n\u4ee5\u4e0b\u306e\u5185\u5bb9\u3092\u307e\u308b\u3054\u3068\u8cbc\u308a\u4ed8\u3051\u3066\u4e0b\u3055\u3044\u3002\nhttps://github.com/docker-library/httpd/blob/63cd0ad57a12c76ff70d0f501f6c2f1580fa40f5/2.2/httpd-foreground\n#!/bin/bash\nset -e\n\n# Apache gets grumpy about PID files pre-existing\nrm -f /usr/local/apache2/logs/httpd.pid\n\nexec httpd -DFOREGROUND\n\n\ndocker build\u306e\u5b9f\u884c\ndocker build --force-rm=true --rm=true -t apache:2.2.9 .\n\n\ndocker\u30b3\u30f3\u30c6\u30ca\u8d77\u52d5\ndocker run-d -p 80 apache:2.2.9\n\n\u304a\u308f\u308a\uff01\n##\u516c\u5f0f\u3067\u516c\u958b\u3055\u308c\u3066\u3044\u308bApache\n\n* 2.2.29\u30012.2\n* 2.4.12\u30012.4\u30012\u3001latest\n\n\u516c\u5f0f\uff1ahttps://github.com/docker-library/docs/tree/master/httpd\n\n\u4eca\u56de\u306f\u30012.2.29\u3092\u5c0e\u5165\u3057\u3066\u307f\u307e\u3059\u3002\n\u306a\u304a\u3001\u793e\u5185\u30d7\u30ed\u30ad\u30b7\u74b0\u5883\u3067\u3042\u308b\u305f\u3081\u3061\u3087\u304f\u3061\u3087\u304f\u4fee\u6b63\u3057\u3066\u3044\u307e\u3059\n\n\u618e\u304d\u30d7\u30ed\u30ad\u30b7\u3081\u2026\u3002\n\n##\u74b0\u5883\n\n```bash\n[root@master httpd]# docker version\nClient version: 1.6.2.el7\nClient API version: 1.18\nGo version (client): go1.4.2\nGit commit (client): c3ca5bb/1.6.2\nOS/Arch (client): linux/amd64\nServer version: 1.6.2.el7\nServer API version: 1.18\nGo version (server): go1.4.2\nGit commit (server): c3ca5bb/1.6.2\nOS/Arch (server): linux/amd64\n[root@master httpd]#\n[root@master httpd]# uname -a\nLinux master 3.10.0-123.el7.x86_64 #1 SMP Mon Jun 30 12:09:22 UTC 2014 x86_64 x86_64 x86_64 GNU/Linux\n```\n\n\n##Dockerfile\u306e\u4f5c\u6210\n\n\u516c\u5f0f\u3088\u308aDockerfile\u3092\u53d6\u5f97\u3057\u3001\u30ed\u30fc\u30ab\u30eb\u3078\u30b3\u30d4\u30fc\u3057\u307e\u3059\nhttps://github.com/docker-library/httpd/blob/63cd0ad57a12c76ff70d0f501f6c2f1580fa40f5/2.2/Dockerfile\n\n\n```bash\nmkdir /export/docker/httpd\ncd /export/docker/httpd\n\nvi Dockerfile\n```\n\n###Dockerfile\n```vim\nFROM debian:jessie\n\n# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added\n#RUN groupadd -r www-data && useradd -r --create-home -g www-data www-data\n\nENV HTTPD_PREFIX /usr/local/apache2\nENV PATH $PATH:$HTTPD_PREFIX/bin\nRUN mkdir -p \"$HTTPD_PREFIX\" \\\n\t&& chown www-data:www-data \"$HTTPD_PREFIX\"\nWORKDIR $HTTPD_PREFIX\n\n# install httpd runtime dependencies\n# https://httpd.apache.org/docs/2.4/install.html#requirements\nRUN apt-get update \\\n\t&& apt-get install -y --no-install-recommends \\\n\t\tlibapr1 \\\n\t\tlibaprutil1 \\\n\t\tlibpcre++0 \\\n\t\tlibssl1.0.0 \\\n\t&& rm -r /var/lib/apt/lists/*\n\n# see https://httpd.apache.org/download.cgi#verify\nRUN gpg --keyserver ha.pool.sks-keyservers.net --recv-keys B1B96F45DFBDCCF974019235193F180AB55D9977\n\nENV HTTPD_VERSION 2.2.29\nENV HTTPD_BZ2_URL https://www.apache.org/dist/httpd/httpd-$HTTPD_VERSION.tar.bz2\n\nRUN buildDeps=' \\\n\t\tca-certificates \\\n\t\tcurl \\\n\t\tbzip2 \\\n\t\tgcc \\\n\t\tlibapr1-dev \\\n\t\tlibaprutil1-dev \\\n\t\tlibc6-dev \\\n\t\tlibpcre++-dev \\\n\t\tlibssl-dev \\\n\t\tmake \\\n\t' \\\n\tset -x \\\n\t&& apt-get update \\\n\t&& apt-get install -y --no-install-recommends $buildDeps \\\n\t&& rm -r /var/lib/apt/lists/* \\\n\t&& curl -SL \"$HTTPD_BZ2_URL\" -o httpd.tar.bz2 \\\n\t&& curl -SL \"$HTTPD_BZ2_URL.asc\" -o httpd.tar.bz2.asc \\\n\t&& gpg --verify httpd.tar.bz2.asc \\\n\t&& mkdir -p src/httpd \\\n\t&& tar -xvf httpd.tar.bz2 -C src/httpd --strip-components=1 \\\n\t&& rm httpd.tar.bz2* \\\n\t&& cd src/httpd \\\n\t&& ./configure --enable-so --enable-ssl --prefix=$HTTPD_PREFIX \\\n\t&& make -j\"$(nproc)\" \\\n\t&& make install \\\n\t&& cd ../../ \\\n\t&& rm -r src/httpd \\\n\t&& sed -ri ' \\\n\t\ts!^(\\s*CustomLog)\\s+\\S+!\\1 /proc/self/fd/1!g; \\\n\t\ts!^(\\s*ErrorLog)\\s+\\S+!\\1 /proc/self/fd/2!g; \\\n\t\t' /usr/local/apache2/conf/httpd.conf \\\n\t&& apt-get purge -y --auto-remove $buildDeps\n\nCOPY httpd-foreground /usr/local/bin/\n\nEXPOSE 80\nCMD [\"httpd-foreground\"]\n```\n\n###\u30d7\u30ed\u30ad\u30b7\u3067\u5236\u9650\u3042\u308b\u5834\u5408\n\n\u305d\u306e\u307e\u307edocker build\u3059\u308b\u3068\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u30e1\u30c3\u30bb\u30fc\u30b8\u304c\u51fa\u307e\u3059\n\n```bash\nStep 6 : RUN gpg --keyserver ha.pool.sks-keyservers.net --recv-keys B1B96F45DFBDCCF974019235193F180AB55D9977\n ---> Running in c49c0ae021f2\ngpg: directory `/root/.gnupg' created\ngpg: new configuration file `/root/.gnupg/gpg.conf' created\ngpg: WARNING: options in `/root/.gnupg/gpg.conf' are not yet active during this run\ngpg: keyring `/root/.gnupg/secring.gpg' created\ngpg: keyring `/root/.gnupg/pubring.gpg' created\ngpg: requesting key B55D9977 from hkp server ha.pool.sks-keyservers.net\ngpg: keyserver timed out\ngpg: keyserver receive failed: keyserver error\nINFO[0127] The command [/bin/sh -c gpg --keyserver ha.pool.sks-keyservers.net --recv-keys B1B96F45DFBDCCF974019235193F180AB55D9977] returned a non-zero code: 2\n\n\u3068\u304b\n\n+ rm -r /var/lib/apt/lists/httpredir.debian.org_debian_dists_jessie-updates_InRelease /var/lib/apt/lists/httpredir.debian.org_debian_dists_jessie-updates_main_binary-amd64_Packages.gz /var/lib/apt/lists/httpredir.debian.org_debian_dists_jessie_InRelease /var/lib/apt/lists/httpredir.debian.org_debian_dists_jessie_main_binary-amd64_Packages.gz /var/lib/apt/lists/lock /var/lib/apt/lists/partial /var/lib/apt/lists/security.debian.org_dists_jessie_updates_InRelease /var/lib/apt/lists/security.debian.org_dists_jessie_updates_main_binary-amd64_Packages.gz\n+ curl -SL https://www.apache.org/dist/httpd/httpd-2.2.29.tar.bz2 -o httpd.tar.bz2\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:--  0:04:14 --:--:--     0curl: (7) Failed to connect to www.apache.org port 443: Connection timed out\n```\n\n\n\u4ee5\u4e0b\u306e\u8a2d\u5b9a\u3092\u5909\u66f4\u3057\u307e\u3057\u3087\u3046\n\n```bash\n-RUN gpg --keyserver ha.pool.sks-keyservers.net --recv-keys B1B96F45DFBDCCF974019235193F180AB55D9977\n\n+RUN gpg --keyserver ha.pool.sks-keyservers.net --keyserver-option http-proxy=http://\u30a2\u30ab\u30a6\u30f3\u30c8\u540d:\u30d1\u30b9\u30ef\u30fc\u30c9@\u30a2\u30c9\u30ec\u30b9:\u30dd\u30fc\u30c8 --recv-keys B1B96F45DFBDCCF974019235193F180AB55D9977\n\n\n\n\n-&& curl -SL \"$HTTPD_BZ2_URL\" -o httpd.tar.bz2 \\\n-&& curl -SL \"$HTTPD_BZ2_URL.asc\" -o httpd.tar.bz2.asc \\\n\n+&& curl -U \u30a2\u30ab\u30a6\u30f3\u30c8\u540d:\u30d1\u30b9\u30ef\u30fc\u30c9 -x \u30a2\u30c9\u30ec\u30b9:\u30dd\u30fc\u30c8 -SL \"$HTTPD_BZ2_URL\" -o httpd.tar.bz2 \\\n+&& curl -U \u30a2\u30ab\u30a6\u30f3\u30c8\u540d:\u30d1\u30b9\u30ef\u30fc\u30c9 -x \u30a2\u30c9\u30ec\u30b9:\u30dd\u30fc\u30c8 -SL \"$HTTPD_BZ2_URL.asc\" -o httpd.tar.bz2.asc \\\n```\n\n\n\u203b\u30d1\u30b9\u30ef\u30fc\u30c9\u306b\u7279\u6b8a\u8a18\u53f7\u3092\u4f7f\u7528\u3057\u3066\u3044\u308b\u5834\u5408\u306fURL\u30a8\u30f3\u30b3\u30fc\u30c9\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\n\n\n##httpd-foreground\u306e\u4f5c\u6210\n\n```bash\nvi httpd-foreground\nchmod a+x httpd-foreground\n```\n\n\u4ee5\u4e0b\u306e\u5185\u5bb9\u3092\u307e\u308b\u3054\u3068\u8cbc\u308a\u4ed8\u3051\u3066\u4e0b\u3055\u3044\u3002\nhttps://github.com/docker-library/httpd/blob/63cd0ad57a12c76ff70d0f501f6c2f1580fa40f5/2.2/httpd-foreground\n\n\n```bash\n#!/bin/bash\nset -e\n\n# Apache gets grumpy about PID files pre-existing\nrm -f /usr/local/apache2/logs/httpd.pid\n\nexec httpd -DFOREGROUND\n```\n\n##docker build\u306e\u5b9f\u884c\n\n```bash\ndocker build --force-rm=true --rm=true -t apache:2.2.9 .\n```\n\n##docker\u30b3\u30f3\u30c6\u30ca\u8d77\u52d5\n```bash\ndocker run-d -p 80 apache:2.2.9\n```\n\n\n\u304a\u308f\u308a\uff01\n", "tags": ["Apache", "docker", "dockerfile", "DockerHub"]}