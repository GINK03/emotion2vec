{"context": " More than 1 year has passed since last update.\n\nRuby \u306e \u5b9a\u756a\u5bfe\u8a71\u30c4\u30fc\u30eb pry \u5fb9\u5e95\u653b\u7565 |  \u756a\u5916\u7de8 \u653b\u7565\u8a18\u4e8b\u4f5c\u6210\u4e2d\u306b\u898b\u3064\u3051\u305f pry \u306e\u30d0\u30b0\u306e\u30d7\u30eb\u30ea\u30af\u30a8\u30b9\u30c8\u4f5c\u6210\u3078\u306e\u9053\n\n \u6982\u8981\n\u653b\u7565\u8a18\u4e8b\u4f5c\u6210\u4e2d\u306b\u898b\u3064\u3051\u305f pry \u306e\u30d0\u30b0\u306e\u30d7\u30eb\u30ea\u30af\u30a8\u30b9\u30c8\u4f5c\u6210\u3078\u306e\u9053\n\n \u7d4c\u7def\n\u3053\u3053\u6700\u8fd1 pry \u306e\u57fa\u672c\u64cd\u4f5c\u306b\u95a2\u3059\u308b\u9023\u8f09\u8a18\u4e8b\u3092\u4f5c\u6210\u3057\u3066\u3044\u307e\u3059\u3002\nRuby \u306e \u5b9a\u756a\u5bfe\u8a71\u30c4\u30fc\u30eb pry \u5fb9\u5e95\u653b\u7565\n\u5c65\u6b74\u306b\u95a2\u3059\u308b\u8a18\u4e8b\u3092\u4f5c\u6210\u3057\u305f\u969b\u306b\u3001 pry \u306e\u30d0\u30b0\u3092\u8e0f\u307f\u307e\u3057\u305f\u3002\nRuby \u306e \u5b9a\u756a\u5bfe\u8a71\u30c4\u30fc\u30eb pry \u5fb9\u5e95\u653b\u7565 | Managing History\n\u5177\u4f53\u7684\u306b\u306f\u3053\u3093\u306a\u611f\u3058\u306e\u30a8\u30e9\u30fc\u306b\u306a\u308a\u307e\u3059\u3002\n$ pry\n[1] pry(main)> \"hoge\"\n=> \"hoge\"\n[2] pry(main)> hist --clear\nHistory cleared.\n[3] pry(main)> hist\nArgumentError: negative array size\nfrom /home/user/.rbenv/versions/2.0.0-p0/lib/ruby/gems/2.0.0/gems/pry-0.10.1/lib/pry/commands/hist.rb:171:in `last'\n\n\n \u539f\u56e0\u8abf\u67fb\n\n\u30a8\u30e9\u30fc\u884c\u3092\u78ba\u8a8d\nhist.rb \u306e 171 \u884c\u76ee\u304c\u30a8\u30e9\u30fc\u3068\u3044\u3046\u30ed\u30b0\u306b\u5f93\u3044\u3001\u8a72\u5f53\u884c\u3092\u78ba\u8a8d\u3002\n\u30a8\u30e9\u30fc\u30e1\u30c3\u30bb\u30fc\u30b8\u306e ArgumentError: negative array size \u3068\u5408\u308f\u305b\u3066\u5224\u65ad\u3059\u308b\u3068\nPry.history.session_line_count \u304c\u30de\u30a4\u30ca\u30b9\u3092\u8fd4\u3057\u3066\u3044\u308b\u3088\u3046\u3067\u3059\u3002\n\u203b Array.last \u306f\u8ca0\u306e\u5024\u3092\u53d7\u3051\u53d6\u308b\u3068 ArgumentError \u306b\u306a\u308b\n    def find_history\n      h = if opts.present?(:all)\n            Pry.history.to_a\n          else\n            # \u3053\u3053\u304c 171 \u884c\u76ee\n            Pry.history.to_a.last(Pry.history.session_line_count)\n          end\n      # The last value in history will be the 'hist' command itself.\n      Pry::Code(h[0..-2])\n    end\n\n\n Pry.history.session_line_count \u306e\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u3092\u78ba\u8a8d\n\u3055\u3066\u3001\u306f\u3058\u3081\u3066\u306e\u30b3\u30fc\u30c9\u30d9\u30fc\u30b9\u3092\u63a2\u7d22\u3059\u308b\u5fc5\u8981\u304c\u3042\u308b\u3088\u3046\u3067\u3059\u3002\n\u3064\u307e\u308a pry \u306e\u51fa\u756a\u3067\u3059\u3002\npry \u306e\u30d0\u30b0\u4fee\u6b63\u306b pry \u3092\u6d3b\u7528\u3057\u307e\u3059\u3002\nPry.history.session_line_count \u306e\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\n[1] pry(main)> show-source -l Pry.history.session_line_count\n\nFrom: /path/to/gems/pry-0.10.1/lib/pry/history.rb @ line 70:\nOwner: Pry::History\nVisibility: public\nNumber of lines: 3\n\n70: def session_line_count\n71:   @history.count - @original_lines\n72: end\n[2] pry(main)>\n\n\n Pry \u306e\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u5909\u6570\u306e\u5185\u5bb9\u3092\u78ba\u8a8d\nPry.history.session_line_count \u3068 Pry.history.original_lines \u306e\u5024\u3092\n\u30d0\u30b0\u3092\u518d\u73fe\u3059\u308b\u64cd\u4f5c\u306e\u4e2d\u3067\u78ba\u8a8d\u3057\u3066\u307f\u307e\u3059\u3002\n$ pry\n[1] pry(main)> \"hoge\"\n=> \"hoge\"\n[2] pry(main)> hist\n1: \"hoge\"\n[3] pry(main)> hist --clear\nHistory cleared.\n[4] pry(main)> hist\nArgumentError: negative array size\nfrom /home/user/.rbenv/versions/2.0.0-p0/lib/ruby/gems/2.0.0/gems/pry-0.10.1/lib/pry/commands/hist.rb:171:in `last'\n[4] pry(main)> Pry.history.original_lines\n=> 693\n[5] pry(main)> Pry.history.session_line_count\n=> -690\n\n\n \u539f\u56e0\u5224\u660e\nhist --clear \u306f\u5c65\u6b74\u3092\u30af\u30ea\u30a2\u3059\u308b\u6a5f\u80fd\u3067\u3059\u3002\n\u5c65\u6b74\u306b\u306f\u3001\n\n\u4ee5\u524d\u306e\u5c65\u6b74 \uff08 .pry_history \u3067\u7ba1\u7406\uff09\n\u30ab\u30ec\u30f3\u30c8\u30bb\u30c3\u30b7\u30e7\u30f3\u306e\u5c65\u6b74\n\n\u304c\u3042\u308a\u3001\u305d\u308c\u305e\u308c\n\n\u4ee5\u524d\u306e\u5c65\u6b74  => @original_lines\n\n\u30ab\u30ec\u30f3\u30c8\u30bb\u30c3\u30b7\u30e7\u30f3\u306e\u5c65\u6b74  => @history\n\n\n\u306b\u7d10\u4ed8\u3044\u3066\u3044\u307e\u3059\u3002\nhist --clear \u6642\u306b\u3001\u4ee5\u524d\u306e\u5c65\u6b74\u306b\u3042\u305f\u308b @original_lines \u306e\u5024\u3092\u30af\u30ea\u30a2\u3057\u3066\u3044\u306a\u3044\u305f\u3081\u3001\n@original_lines \u306e\u884c\u6570\u5206\u3060\u3051\u30de\u30a4\u30ca\u30b9\u306b\u306a\u3063\u3066\u3057\u307e\u3063\u3066\u3044\u308b\u306e\u3067\u3059\u3002\n\u305d\u306e\u305f\u3081\u3001 hist --clear \u6642\u306b @original_lines \u3082\u30af\u30ea\u30a2\u3059\u308b\u51e6\u7406\u3092\u5b9f\u88c5\u3057\u307e\u3059\n\n pry \u3092\u30d5\u30a9\u30fc\u30af\nGitHub \u306e pry/pry \u306e\u30ea\u30dd\u30b8\u30c8\u30ea \u304b\u3089\n\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092\u30d5\u30a9\u30fc\u30af\u3057\u307e\u3059\u3002\n\n \u30d5\u30a9\u30fc\u30af\u3057\u305f\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092\u30ed\u30fc\u30ab\u30eb\u74b0\u5883\u306b clone \u3057\u307e\u3059\n$ git clone git@github.com:tbpgr/pry.git\n\n\u203b\u5b9f\u969b\u306f ghq \u3092\u4f7f\u3063\u3066\u307e\u3059\n$ ghq get git@github.com:tbpgr/pry.git\n\n\n \u30c8\u30d4\u30c3\u30af\u30d6\u30e9\u30f3\u30c1\u306e\u4f5c\u6210\n\u8aac\u660e\u7684\u306a\u540d\u524d\u306e\u30d6\u30e9\u30f3\u30c1\u3092\u4f5c\u3063\u3066\u3001\u8a72\u5f53\u30d6\u30e9\u30f3\u30c1\u3067\u4f5c\u696d\u3092\u3057\u307e\u3059\u3002\n$ git checkout -b fix_hist_clear_negative_array_size\n\n\n TDD \u3067\u76f4\u3059\u3002\u30a8\u30e9\u30fc\u306e\u30c6\u30b9\u30c8\u30b1\u30fc\u30b9\u3092\u8ffd\u52a0\n\u307e\u305a\u306f\u30a8\u30e9\u30fc\u3092\u518d\u73fe\u3055\u305b\u308b\u30c6\u30b9\u30c8\u30b3\u30fc\u30c9\u3092\u8ffd\u52a0\u3057\u307e\u3059\u3002\npry --clear \u306e\u51e6\u7406\u672c\u4f53\u3067\u3042\u308b Pry::History#clear \u306e\u30c6\u30b9\u30c8\u30b1\u30fc\u30b9\u306b original_lines \u304c\n0 \u306b\u306a\u3063\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\u30c6\u30b9\u30c8\u30b1\u30fc\u30b9\u3092\u8ffd\u52a0\u3057\u307e\u3059\u3002\n    it \"clears this session's history\" do\n      Pry.history.to_a.size.should > 0\n      Pry.history.clear\n      Pry.history.to_a.size.should == 0\n      # \u3053\u306e1\u884c\u3092\u8ffd\u52a0\n      Pry.history.original_lines.should == 0\n    end\n\n\n\u30c6\u30b9\u30c8\u304c\u30a8\u30e9\u30fc\u306b\u306a\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3057\u307e\u3059\n\n  1) Pry#clear clears this session's history\n     Failure/Error: Pry.history.original_lines.should == 0\n       expected: 0\n            got: 6 (using ==)\n     # ./spec/history_spec.rb:56:in `block (3 levels) in <top (required)>'\n\n\n TDD \u3067\u76f4\u3059\u3002\u30c6\u30b9\u30c8\u30b1\u30fc\u30b9\u3092\u30d1\u30b9\u3059\u308b\u5b9f\u88c5\u3092\u884c\u3046\n\u30c6\u30b9\u30c8\u3092\u30d1\u30b9\u3059\u308b\u3088\u3046\u306b Pry::History#clear \u3092\u5b9f\u88c5\u3057\u307e\u3059\u3002\n    # Clear this session's history. This won't affect the contents of the\n    # history file.\n    def clear\n      @clearer.call\n      # \u3053\u306e 1 \u884c\u3092\u8ffd\u52a0\n      @original_lines = 0\n      @history = []\n    end\n\n\u30c6\u30b9\u30c8\u3092\u5b9f\u884c\u3057\u307e\u3059\n$bundle exec rspec spec/history_spec.rb\nFinished in 0.07801 seconds (files took 0.39155 seconds to load)\n14 examples, 0 failure\n\n\u76f4\u308a\u307e\u3057\u305f\u3002\n\n \u4fee\u6b63\u5185\u5bb9\u3092 push \u3057\u307e\u3059\n$ git push origin fix_hist_clear_negative_array_size\n\n\n \u30d6\u30e9\u30a6\u30b6\u3067\u30d7\u30eb\u30ea\u30af\u30a8\u30b9\u30c8\u3092\u4f5c\u6210\u3057\u307e\u3059\n\n\u30d0\u30b0\u306e\u539f\u56e0\u306e\u518d\u73fe\n\u30d0\u30b0\u306e\u539f\u56e0\n\u30d0\u30b0\u4fee\u6b63\u5f8c\u306e\u64cd\u4f5c\u4f8b\n\n\u3092\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u306e\u4f8b\u793a\u3092\u4e3b\u306b\u8aac\u660e\u3057\u307e\u3057\u305f\u3002\n\u82f1\u8a9e\u529b\u304c\u4f4e\u3044\u306e\u3092\u88dc\u3046\u624b\u6cd5\u3002\n\u3064\u3044\u3067\u306b emoji \u3082\u7e54\u308a\u4ea4\u305c\u305f\u308a\u3002\n\n\n\u4ee5\u4e0a\u3067\u30d7\u30eb\u30ea\u30af\u30a8\u30b9\u30c8\u304c\u5b8c\u4e86\u3057\u307e\u3057\u305f\u3002\nhttps://github.com/pry/pry/pull/1340\n# Ruby \u306e \u5b9a\u756a\u5bfe\u8a71\u30c4\u30fc\u30eb pry \u5fb9\u5e95\u653b\u7565 | :bug::boom::hammer: \u756a\u5916\u7de8 \u653b\u7565\u8a18\u4e8b\u4f5c\u6210\u4e2d\u306b\u898b\u3064\u3051\u305f pry \u306e\u30d0\u30b0\u306e\u30d7\u30eb\u30ea\u30af\u30a8\u30b9\u30c8\u4f5c\u6210\u3078\u306e\u9053\n## <i class=\"fa fa-cubes\" style=\"font-size:1em;\"></i> \u6982\u8981\n\u653b\u7565\u8a18\u4e8b\u4f5c\u6210\u4e2d\u306b\u898b\u3064\u3051\u305f pry \u306e\u30d0\u30b0\u306e\u30d7\u30eb\u30ea\u30af\u30a8\u30b9\u30c8\u4f5c\u6210\u3078\u306e\u9053\n\n## <i class=\"fa fa-history\" style=\"font-size:1em;\"></i> \u7d4c\u7def\n\u3053\u3053\u6700\u8fd1 pry \u306e\u57fa\u672c\u64cd\u4f5c\u306b\u95a2\u3059\u308b\u9023\u8f09\u8a18\u4e8b\u3092\u4f5c\u6210\u3057\u3066\u3044\u307e\u3059\u3002\n[Ruby \u306e \u5b9a\u756a\u5bfe\u8a71\u30c4\u30fc\u30eb pry \u5fb9\u5e95\u653b\u7565](http://qiita.com/tbpgr/items/12a60f2f9e3de61517b5)\n\n\u5c65\u6b74\u306b\u95a2\u3059\u308b\u8a18\u4e8b\u3092\u4f5c\u6210\u3057\u305f\u969b\u306b\u3001 pry \u306e\u30d0\u30b0\u3092\u8e0f\u307f\u307e\u3057\u305f\u3002\n[Ruby \u306e \u5b9a\u756a\u5bfe\u8a71\u30c4\u30fc\u30eb pry \u5fb9\u5e95\u653b\u7565 | Managing History](http://qiita.com/tbpgr/items/077681dff1aac0bfd708)\n\n\u5177\u4f53\u7684\u306b\u306f\u3053\u3093\u306a\u611f\u3058\u306e\u30a8\u30e9\u30fc\u306b\u306a\u308a\u307e\u3059\u3002\n\n~~~bash\n$ pry\n[1] pry(main)> \"hoge\"\n=> \"hoge\"\n[2] pry(main)> hist --clear\nHistory cleared.\n[3] pry(main)> hist\nArgumentError: negative array size\nfrom /home/user/.rbenv/versions/2.0.0-p0/lib/ruby/gems/2.0.0/gems/pry-0.10.1/lib/pry/commands/hist.rb:171:in `last'\n~~~\n\n## <i class=\"fa fa-search\" style=\"font-size:1em;\"></i> \u539f\u56e0\u8abf\u67fb\n### \u30a8\u30e9\u30fc\u884c\u3092\u78ba\u8a8d\nhist.rb \u306e 171 \u884c\u76ee\u304c\u30a8\u30e9\u30fc\u3068\u3044\u3046\u30ed\u30b0\u306b\u5f93\u3044\u3001\u8a72\u5f53\u884c\u3092\u78ba\u8a8d\u3002\n\n\u30a8\u30e9\u30fc\u30e1\u30c3\u30bb\u30fc\u30b8\u306e ArgumentError: negative array size \u3068\u5408\u308f\u305b\u3066\u5224\u65ad\u3059\u308b\u3068\n`Pry.history.session_line_count` \u304c\u30de\u30a4\u30ca\u30b9\u3092\u8fd4\u3057\u3066\u3044\u308b\u3088\u3046\u3067\u3059\u3002\n\u203b Array.last \u306f\u8ca0\u306e\u5024\u3092\u53d7\u3051\u53d6\u308b\u3068 ArgumentError \u306b\u306a\u308b\n\n~~~ruby\n    def find_history\n      h = if opts.present?(:all)\n            Pry.history.to_a\n          else\n            # \u3053\u3053\u304c 171 \u884c\u76ee\n            Pry.history.to_a.last(Pry.history.session_line_count)\n          end\n      # The last value in history will be the 'hist' command itself.\n      Pry::Code(h[0..-2])\n    end\n~~~\n\n## <i class=\"fa fa-code\" style=\"font-size:1em;\"></i> Pry.history.session_line_count \u306e\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u3092\u78ba\u8a8d\n\u3055\u3066\u3001\u306f\u3058\u3081\u3066\u306e\u30b3\u30fc\u30c9\u30d9\u30fc\u30b9\u3092\u63a2\u7d22\u3059\u308b\u5fc5\u8981\u304c\u3042\u308b\u3088\u3046\u3067\u3059\u3002\n\u3064\u307e\u308a ***pry*** \u306e\u51fa\u756a\u3067\u3059\u3002\n***pry*** \u306e\u30d0\u30b0\u4fee\u6b63\u306b ***pry*** \u3092\u6d3b\u7528\u3057\u307e\u3059\u3002\n\n`Pry.history.session_line_count` \u306e\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\n\n~~~\n[1] pry(main)> show-source -l Pry.history.session_line_count\n\nFrom: /path/to/gems/pry-0.10.1/lib/pry/history.rb @ line 70:\nOwner: Pry::History\nVisibility: public\nNumber of lines: 3\n\n70: def session_line_count\n71:   @history.count - @original_lines\n72: end\n[2] pry(main)>\n~~~\n\n## <i class=\"fa fa-code\" style=\"font-size:1em;\"></i> Pry \u306e\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u5909\u6570\u306e\u5185\u5bb9\u3092\u78ba\u8a8d\n`Pry.history.session_line_count` \u3068 `Pry.history.original_lines` \u306e\u5024\u3092\n\u30d0\u30b0\u3092\u518d\u73fe\u3059\u308b\u64cd\u4f5c\u306e\u4e2d\u3067\u78ba\u8a8d\u3057\u3066\u307f\u307e\u3059\u3002\n\n~~~\n$ pry\n[1] pry(main)> \"hoge\"\n=> \"hoge\"\n[2] pry(main)> hist\n1: \"hoge\"\n[3] pry(main)> hist --clear\nHistory cleared.\n[4] pry(main)> hist\nArgumentError: negative array size\nfrom /home/user/.rbenv/versions/2.0.0-p0/lib/ruby/gems/2.0.0/gems/pry-0.10.1/lib/pry/commands/hist.rb:171:in `last'\n[4] pry(main)> Pry.history.original_lines\n=> 693\n[5] pry(main)> Pry.history.session_line_count\n=> -690\n~~~\n\n## :bug: \u539f\u56e0\u5224\u660e\n`hist --clear` \u306f\u5c65\u6b74\u3092\u30af\u30ea\u30a2\u3059\u308b\u6a5f\u80fd\u3067\u3059\u3002\n\u5c65\u6b74\u306b\u306f\u3001\n\n* \u4ee5\u524d\u306e\u5c65\u6b74 \uff08 .pry_history \u3067\u7ba1\u7406\uff09\n* \u30ab\u30ec\u30f3\u30c8\u30bb\u30c3\u30b7\u30e7\u30f3\u306e\u5c65\u6b74\n\n\u304c\u3042\u308a\u3001\u305d\u308c\u305e\u308c\n\n* \u4ee5\u524d\u306e\u5c65\u6b74  => @original_lines\n* \u30ab\u30ec\u30f3\u30c8\u30bb\u30c3\u30b7\u30e7\u30f3\u306e\u5c65\u6b74  => @history\n\n\u306b\u7d10\u4ed8\u3044\u3066\u3044\u307e\u3059\u3002\n\n`hist --clear` \u6642\u306b\u3001\u4ee5\u524d\u306e\u5c65\u6b74\u306b\u3042\u305f\u308b `@original_lines` \u306e\u5024\u3092\u30af\u30ea\u30a2\u3057\u3066\u3044\u306a\u3044\u305f\u3081\u3001\n`@original_lines` \u306e\u884c\u6570\u5206\u3060\u3051\u30de\u30a4\u30ca\u30b9\u306b\u306a\u3063\u3066\u3057\u307e\u3063\u3066\u3044\u308b\u306e\u3067\u3059\u3002\n\u305d\u306e\u305f\u3081\u3001 `hist --clear` \u6642\u306b `@original_lines` \u3082\u30af\u30ea\u30a2\u3059\u308b\u51e6\u7406\u3092\u5b9f\u88c5\u3057\u307e\u3059\n\n## <i class=\"fa fa-code-fork\" style=\"font-size:1em;\"></i> pry \u3092\u30d5\u30a9\u30fc\u30af\nGitHub \u306e <i class=\"fa fa-external-link\" style=\"font-size:1em;\"></i>[pry/pry \u306e\u30ea\u30dd\u30b8\u30c8\u30ea](https://github.com/pry/pry) \u304b\u3089\n\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092\u30d5\u30a9\u30fc\u30af\u3057\u307e\u3059\u3002\n\n## <i class=\"fa fa-github\" style=\"font-size:1em;\"></i> \u30d5\u30a9\u30fc\u30af\u3057\u305f\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092\u30ed\u30fc\u30ab\u30eb\u74b0\u5883\u306b clone \u3057\u307e\u3059\n~~~bash\n$ git clone git@github.com:tbpgr/pry.git\n~~~\n\n\u203b\u5b9f\u969b\u306f ghq \u3092\u4f7f\u3063\u3066\u307e\u3059\n\n~~~bash\n$ ghq get git@github.com:tbpgr/pry.git\n~~~\n\n## <i class=\"fa fa-code-fork\" style=\"font-size:1em;\"></i> \u30c8\u30d4\u30c3\u30af\u30d6\u30e9\u30f3\u30c1\u306e\u4f5c\u6210\n\u8aac\u660e\u7684\u306a\u540d\u524d\u306e\u30d6\u30e9\u30f3\u30c1\u3092\u4f5c\u3063\u3066\u3001\u8a72\u5f53\u30d6\u30e9\u30f3\u30c1\u3067\u4f5c\u696d\u3092\u3057\u307e\u3059\u3002\n\n~~~bash\n$ git checkout -b fix_hist_clear_negative_array_size\n~~~\n\n## <i class=\"fa fa-flask\" style=\"font-size:1em;\"></i> TDD \u3067\u76f4\u3059\u3002\u30a8\u30e9\u30fc\u306e\u30c6\u30b9\u30c8\u30b1\u30fc\u30b9\u3092\u8ffd\u52a0\n\u307e\u305a\u306f\u30a8\u30e9\u30fc\u3092\u518d\u73fe\u3055\u305b\u308b\u30c6\u30b9\u30c8\u30b3\u30fc\u30c9\u3092\u8ffd\u52a0\u3057\u307e\u3059\u3002\n`pry --clear` \u306e\u51e6\u7406\u672c\u4f53\u3067\u3042\u308b `Pry::History#clear` \u306e\u30c6\u30b9\u30c8\u30b1\u30fc\u30b9\u306b original_lines \u304c\n0 \u306b\u306a\u3063\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\u30c6\u30b9\u30c8\u30b1\u30fc\u30b9\u3092\u8ffd\u52a0\u3057\u307e\u3059\u3002\n\n~~~ruby\n    it \"clears this session's history\" do\n      Pry.history.to_a.size.should > 0\n      Pry.history.clear\n      Pry.history.to_a.size.should == 0\n      # \u3053\u306e1\u884c\u3092\u8ffd\u52a0\n      Pry.history.original_lines.should == 0\n    end\n~~~\n\n* \u30c6\u30b9\u30c8\u304c\u30a8\u30e9\u30fc\u306b\u306a\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3057\u307e\u3059\n\n~~~\n  1) Pry#clear clears this session's history\n     Failure/Error: Pry.history.original_lines.should == 0\n       expected: 0\n            got: 6 (using ==)\n     # ./spec/history_spec.rb:56:in `block (3 levels) in <top (required)>'\n~~~\n\n## <i class=\"fa fa-flask\" style=\"font-size:1em;\"></i> TDD \u3067\u76f4\u3059\u3002\u30c6\u30b9\u30c8\u30b1\u30fc\u30b9\u3092\u30d1\u30b9\u3059\u308b\u5b9f\u88c5\u3092\u884c\u3046\n\u30c6\u30b9\u30c8\u3092\u30d1\u30b9\u3059\u308b\u3088\u3046\u306b `Pry::History#clear` \u3092\u5b9f\u88c5\u3057\u307e\u3059\u3002\n\n~~~ruby\n    # Clear this session's history. This won't affect the contents of the\n    # history file.\n    def clear\n      @clearer.call\n      # \u3053\u306e 1 \u884c\u3092\u8ffd\u52a0\n      @original_lines = 0\n      @history = []\n    end\n~~~\n\n\u30c6\u30b9\u30c8\u3092\u5b9f\u884c\u3057\u307e\u3059\n\n~~~\n$bundle exec rspec spec/history_spec.rb\nFinished in 0.07801 seconds (files took 0.39155 seconds to load)\n14 examples, 0 failure\n~~~\n\n\u76f4\u308a\u307e\u3057\u305f\u3002\n\n## <i class=\"fa fa-github-square\" style=\"font-size:1em;\"></i> \u4fee\u6b63\u5185\u5bb9\u3092 push \u3057\u307e\u3059\n\n~~~bash\n$ git push origin fix_hist_clear_negative_array_size\n~~~\n\n## <i class=\"fa fa-github-square\" style=\"font-size:1em;\"></i> \u30d6\u30e9\u30a6\u30b6\u3067\u30d7\u30eb\u30ea\u30af\u30a8\u30b9\u30c8\u3092\u4f5c\u6210\u3057\u307e\u3059\n\n* \u30d0\u30b0\u306e\u539f\u56e0\u306e\u518d\u73fe\n* \u30d0\u30b0\u306e\u539f\u56e0\n* \u30d0\u30b0\u4fee\u6b63\u5f8c\u306e\u64cd\u4f5c\u4f8b\n\n\u3092\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u306e\u4f8b\u793a\u3092\u4e3b\u306b\u8aac\u660e\u3057\u307e\u3057\u305f\u3002\n\u82f1\u8a9e\u529b\u304c\u4f4e\u3044\u306e\u3092\u88dc\u3046\u624b\u6cd5\u3002\n\u3064\u3044\u3067\u306b emoji \u3082\u7e54\u308a\u4ea4\u305c\u305f\u308a\u3002\n\n![pry_bug_fix1.png](https://qiita-image-store.s3.amazonaws.com/0/43480/53c2a5a0-4f41-111e-c812-aab5800adf47.png)\n![pry_bug_fix2.png](https://qiita-image-store.s3.amazonaws.com/0/43480/a7a0f9c9-9567-cc49-90e7-a67d5de01954.png)\n\n\u4ee5\u4e0a\u3067\u30d7\u30eb\u30ea\u30af\u30a8\u30b9\u30c8\u304c\u5b8c\u4e86\u3057\u307e\u3057\u305f\u3002\n\nhttps://github.com/pry/pry/pull/1340\n", "tags": ["pry", "Ruby"]}