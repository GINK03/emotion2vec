{"context": "\u4eca\u56de\u306f\u3001\u300cSpring Security OAuth\u3067\u8a8d\u53ef\u30b3\u30fc\u30c9\u30b0\u30e9\u30f3\u30c8\u30d5\u30ed\u30fc\u3092\u4f53\u611f\u3057\u3088\u3046\u300d\u306e\u7b2c\u4e8c\u56de\u3067\u3001\u307e\u301c\u3068\u308a\u3042\u3048\u305aSpring Security OAuth + Spring Boot\u3092\u4f7f\u7528\u3057\u3066\u8a8d\u53ef\u30b3\u30fc\u30c9\u30b0\u30e9\u30f3\u30c8\u30d5\u30ed\u30fc\u3067REST API\u306e\u8a8d\u8a3c\u30fb\u8a8d\u53ef\u3092\u884c\u3046\u30a2\u30d7\u30ea\u4f5c\u3063\u3066\u307f\u308b\u3053\u3068\u306b\u3057\u307e\u3059\u3002\n\n\u7b2c\uff11\u56de\uff1aOAuth 2.0\u306e\u304a\u3055\u3089\u3044\u7de8\n\n\n\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u6a5f\u80fd\u8981\u4ef6\n\u4eca\u56de\u4f5c\u6210\u3059\u308b\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u6a5f\u80fd\u8981\u4ef6\u306f\u30fb\u30fb\u30fb\n\nService Provider\nService Provider\u306f\u3001\u30e6\u30fc\u30b6\u5358\u4f4d\u3067\u30bf\u30b9\u30af\u60c5\u5831(\u30bf\u30a4\u30c8\u30eb\u3001\u8a73\u7d30\u3001\u671f\u9650\u65e5\u3001\u5b8c\u4e86\u30d5\u30e9\u30b0\u3001\u767b\u9332\u65e5\u6642\u3001\u66f4\u65b0\u65e5\u6642)\u306e\u7ba1\u7406(\u767b\u9332\u30fb\u66f4\u65b0\u30fb\u524a\u9664\u30fb\u53c2\u7167)\u3092\u884c\u3046REST API\u3092\u63d0\u4f9b\u3057\u3001REST API\u3078\u306e\u30a2\u30af\u30bb\u30b9\u306f\u3001OAuth 2.0\u306e\u8a8d\u53ef\u30b3\u30fc\u30c9\u30b0\u30e9\u30f3\u30c8\u30d5\u30ed\u30fc\u3067\u767a\u884c\u3057\u305f\u30a2\u30af\u30bb\u30b9\u30c8\u30fc\u30af\u30f3\u3092\u4f7f\u7528\u3057\u3066\u8a8d\u8a3c\u30fb\u8a8d\u53ef\u3092\u884c\u3046\u3002\n\u3068\u3044\u3046\u8981\u4ef6\u306b\u3057\u307e\u3059\u3002\n\u672c\u6765\u3067\u3042\u308c\u3070Service Provider\u5074\u306b\u3082\u30bf\u30b9\u30af\u60c5\u5831\u3092\u7ba1\u7406\u3059\u308b\u305f\u3081\u306eWeb UI\u3092\u7528\u610f\u3057\u305f\u3044\u3068\u3053\u308d\u3067\u3059\u304c\u3001Service Provider\u5074\u306eWeb UI\u306f\u672c\u30a8\u30f3\u30c8\u30ea\u30fc\u306e\u30d5\u30a9\u30fc\u30ab\u30b9\u5916\u3068\u3057\u3066\u8aac\u660e\u3082\u5272\u611b\u3055\u305b\u3066\u3082\u3089\u3044\u307e\u3059\u3002\n\nResource Server\n\u30ea\u30bd\u30fc\u30b9\u30aa\u30fc\u30ca\u306e\u30bf\u30b9\u30af\u60c5\u5831\u3092\u7ba1\u7406\u3059\u308b\u305f\u3081\u306eAPI\u3068\u3057\u3066\u3001\u4ee5\u4e0b\u306eAPI\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\n\n\nAPI\u540d\nAPI\u6982\u8981\n\u30a2\u30af\u30bb\u30b9\u3092\u8a31\u53ef\u3059\u308b\u30b9\u30b3\u30fc\u30d7\n\n\n\n\nGET /api/tasks\n\u30bf\u30b9\u30af\u60c5\u5831\u306e\u4e00\u89a7\u3092\u53d6\u5f97\u3059\u308bAPI\nread\n\n\nPOST /api/tasks\n\u30bf\u30b9\u30af\u60c5\u5831\u3092\u767b\u9332\u3059\u308bAPI\nwrite\n\n\nGET /api/tasks/{id}\n\u30bf\u30b9\u30af\u60c5\u5831\u3092\u53d6\u5f97\u3059\u308bAPI\nread\n\n\nPUT /api/tasks/{id}\n\u30bf\u30b9\u30af\u60c5\u5831\u3092\u66f4\u65b0\u3059\u308bAPI\nwrite\n\n\nDELETE /api/tasks/{id}\n\u30bf\u30b9\u30af\u60c5\u5831\u3092\u524a\u9664\u3059\u308bAPI\nwrite\n\n\n\n\nAuthorization Server\n\u30bf\u30b9\u30af\u60c5\u5831\u3078\u306e\u30a2\u30af\u30bb\u30b9\u3092\u30ea\u30bd\u30fc\u30b9\u30aa\u30fc\u30ca\u304b\u3089\u8a31\u53ef\u3057\u3066\u3082\u3089\u3046\u305f\u3081\u306b\u3001\u4ee5\u4e0b\u306e\u30a8\u30f3\u30c9\u30dd\u30a4\u30f3\u30c8\uff08\u4ee5\u964d\u3001\u300c\u8a8d\u53ef\u30a8\u30f3\u30c9\u30dd\u30a4\u30f3\u30c8\u300d\u3068\u547c\u3076\uff09\u3092\u63d0\u4f9b\u3057\u307e\u3059\u3002\u3053\u306e\u30a8\u30f3\u30c9\u30dd\u30a4\u30f3\u30c8\u306f\u3001Spring Security OAuth\u304c\u63d0\u4f9b\u3057\u3066\u304f\u308c\u308b\u305f\u3081\u3001\u958b\u767a\u8005\u304c\u4f5c\u6210\u3059\u308b\u5fc5\u8981\u306f\u3042\u308a\u307e\u305b\u3093\u3002\n\n\n\n\u30a8\u30f3\u30c9\u30dd\u30a4\u30f3\u30c8\u540d\n\u30a8\u30f3\u30c9\u30dd\u30a4\u30f3\u30c8\u6982\u8981\n\u30a2\u30af\u30bb\u30b9\u3092\u8a31\u53ef\u3059\u308b\u6761\u4ef6\n\n\n\n\nGET /oauth/authorize\n\u30ea\u30bd\u30fc\u30b9\u30aa\u30fc\u30ca\u304b\u3089\u306e\u8a8d\u53ef\u3092\u5f97\u308b\u305f\u3081\u306e\u753b\u9762\uff08\u4ee5\u964d\u3001\u300c\u8a8d\u53ef\u753b\u9762\u300d\u3068\u547c\u3076\uff09\u3092\u8868\u793a\u3059\u308b\u305f\u3081\u306e\u30a8\u30f3\u30c9\u30dd\u30a4\u30f3\u30c8\n\u8a8d\u8a3c\u6e08\u307f\u306e\u30ea\u30bd\u30fc\u30b9\u30aa\u30fc\u30ca\n\n\nPOST /oauth/authorize?user_oauth_approval\n\u30ea\u30bd\u30fc\u30b9\u30aa\u30fc\u30ca\u304b\u3089\u306e\u8a8d\u53ef\u6307\u793a(\u8a31\u53ef\u30fb\u62d2\u5426)\u3092\u53d7\u3051\u3066\u8a8d\u53ef\u30b0\u30e9\u30f3\u30c8(\u8a8d\u53ef\u30b3\u30fc\u30c9)\u3092\u767a\u884c\u3059\u308b\u305f\u3081\u306e\u30a8\u30f3\u30c9\u30dd\u30a4\u30f3\u30c8\n\u8a8d\u8a3c\u6e08\u307f\u306e\u30ea\u30bd\u30fc\u30b9\u30aa\u30fc\u30ca\n\n\n\nClient\u304c\u30ea\u30bd\u30fc\u30b9\u30aa\u30fc\u30ca\u304b\u3089\u53d6\u5f97\u3057\u305f\u8a8d\u53ef\u30b0\u30e9\u30f3\u30c8(\u8a8d\u53ef\u30b3\u30fc\u30c9)\u3092\u3082\u3068\u306b\u30a2\u30af\u30bb\u30b9\u30c8\u30fc\u30af\u30f3\u3092\u767a\u884c\u3059\u308b\u305f\u3081\u306b\u3001\u4ee5\u4e0b\u306e\u30a8\u30f3\u30c9\u30dd\u30a4\u30f3\u30c8\uff08\u4ee5\u964d\u3001\u300c\u30c8\u30fc\u30af\u30f3\u30a8\u30f3\u30c9\u30dd\u30a4\u30f3\u30c8\u300d\u3068\u547c\u3076\uff09\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\u3053\u306e\u30a8\u30f3\u30c9\u30dd\u30a4\u30f3\u30c8\u306f\u3001Spring Security OAuth\u304c\u63d0\u4f9b\u3057\u3066\u304f\u308c\u308b\u305f\u3081\u3001\u958b\u767a\u8005\u304c\u4f5c\u6210\u3059\u308b\u5fc5\u8981\u306f\u3042\u308a\u307e\u305b\u3093\u3002\n\n\n\n\u30a8\u30f3\u30c9\u30dd\u30a4\u30f3\u30c8\u540d\n\u30a8\u30f3\u30c9\u30dd\u30a4\u30f3\u30c8\u6982\u8981\n\u30a2\u30af\u30bb\u30b9\u3092\u8a31\u53ef\u3059\u308b\u6761\u4ef6\n\n\n\n\nPOST /oauth/token\n\u30ea\u30bd\u30fc\u30b9\u30aa\u30fc\u30ca\u304b\u3089\u53d6\u5f97\u3057\u305f\u8a8d\u53ef\u30b0\u30e9\u30f3\u30c8(\u8a8d\u53ef\u30b3\u30fc\u30c9\u306a\u3069)\u3092\u3082\u3068\u306b\u30a2\u30af\u30bb\u30b9\u30c8\u30fc\u30af\u30f3\u3092\u767a\u884c\u3059\u308b\u305f\u3081\u306e\u30a8\u30f3\u30c9\u30dd\u30a4\u30f3\u30c8\n\u8a8d\u8a3c\u6e08\u307f\u306eClient\n\n\n\n\nNote: \u5404\u7a2e\u30a8\u30f3\u30c9\u30dd\u30a4\u30f3\u30c8\u3078\u306e\u8a8d\u8a3c\u30fb\u8a8d\u53ef\n\u672c\u30a8\u30f3\u30c8\u30ea\u30fc\u3067\u306f\u30fb\u30fb\u30fbSpring Security\u304c\u63d0\u4f9b\u3057\u3066\u3044\u308bBasic\u8a8d\u8a3c\u3092\u5229\u7528\u3057\u3066\u3001\u3053\u308c\u3089\u306e\u30a8\u30f3\u30c9\u30dd\u30a4\u30f3\u30c8\u306b\u5bfe\u3057\u3066\u30ea\u30bd\u30fc\u30b9\u30aa\u30fc\u30ca\u53ca\u3073Client\u306e\u8a8d\u8a3c\u3092\u884c\u3044\u307e\u3059\u3002\n\n\nClient(Web UI)\nClient\u306f\u3001Service Provider\u304b\u3089\u63d0\u4f9b\u3055\u308c\u3066\u3044\u308bREST API\u3092\u4f7f\u7528\u3057\u3066\u3001\u30ea\u30bd\u30fc\u30b9\u30aa\u30fc\u30ca\u306e\u30bf\u30b9\u30af\u60c5\u5831\u3092\u7ba1\u7406\u3059\u308b\u305f\u3081\u306eWeb UI(\u30bf\u30b9\u30af\u4e00\u89a7\u753b\u9762\u3068\u30bf\u30b9\u30af\u8a73\u7d30\u753b\u9762)\u3092\u63d0\u4f9b\u3057\u307e\u3059\u3002\n\n\n\n\u30a8\u30f3\u30c9\u30dd\u30a4\u30f3\u30c8\u540d\n\u30a8\u30f3\u30c9\u30dd\u30a4\u30f3\u30c8\u6982\u8981\n\u30a2\u30af\u30bb\u30b9\u3092\u8a31\u53ef\u3059\u308b\u6761\u4ef6\n\n\n\n\nGET /tasks\n\u30ea\u30bd\u30fc\u30b9\u30b5\u30fc\u30d0\u304b\u3089\u53d6\u5f97\u3057\u305f\u30bf\u30b9\u30af\u60c5\u5831\u306e\u30bf\u30b9\u30af\u4e00\u89a7\u753b\u9762\u306b\u8868\u793a\u3059\u308b\n\u8a8d\u8a3c\u6e08\u307f\u306e\u5229\u7528\u8005\n\n\nPOST /tasks\n\u30ea\u30bd\u30fc\u30b9\u30b5\u30fc\u30d0\u306b\u30bf\u30b9\u30af\u60c5\u5831\u3092\u4f5c\u6210\u3059\u308b\n\u8a8d\u8a3c\u6e08\u307f\u306e\u5229\u7528\u8005\n\n\nGET /tasks/{id}\n\u30ea\u30bd\u30fc\u30b9\u30b5\u30fc\u30d0\u304b\u3089\u53d6\u5f97\u3057\u305f\u30bf\u30b9\u30af\u60c5\u5831\u3092\u30bf\u30b9\u30af\u8a73\u7d30\u753b\u9762\u306b\u8868\u793a\u3059\u308b\n\u8a8d\u8a3c\u6e08\u307f\u306e\u5229\u7528\u8005\n\n\nPOST /tasks/{id}?update\n\u30ea\u30bd\u30fc\u30b9\u30b5\u30fc\u30d0\u3067\u7ba1\u7406\u3057\u3066\u3044\u308b\u30bf\u30b9\u30af\u60c5\u5831\u3092\u66f4\u65b0\u3059\u308b\n\u8a8d\u8a3c\u6e08\u307f\u306e\u5229\u7528\u8005\n\n\nPOST /tasks/{id}?delete\n\u30ea\u30bd\u30fc\u30b9\u30b5\u30fc\u30d0\u3067\u7ba1\u7406\u3057\u3066\u3044\u308b\u30bf\u30b9\u30af\u60c5\u5831\u3092\u524a\u9664\u3059\u308b\n\u8a8d\u8a3c\u6e08\u307f\u306e\u5229\u7528\u8005\n\n\n\n\nNote: \u30bf\u30b9\u30af\u7ba1\u7406\u7528UI\u306e\u8a8d\u8a3c\u30fb\u8a8d\u53ef\nClient\u5074\u3067\u7528\u610f\u3059\u308b\u30bf\u30b9\u30af\u7ba1\u7406\u7528\u306e\u753b\u9762\u306f\u3001Client\u5074\u306e\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u30e6\u30fc\u30b6\u8a8d\u8a3c\u3092\u5fc5\u8981\u3068\u3057\u3066\u3001\u30e6\u30fc\u30b6\u8a8d\u8a3c\u306b\u306fSpring Security\u304c\u63d0\u4f9b\u3057\u3066\u3044\u308bBasic\u8a8d\u8a3c\u3092\u4f7f\u7528\u3057\u3066\u884c\u3044\u307e\u3059\u3002\n\n\u753b\u9762\u30a4\u30e1\u30fc\u30b8\u3068\u753b\u9762\u9077\u79fb\u306f\u4ee5\u4e0b\u306e\u901a\u308a\u3068\u3059\u308b\u3002\n\n\n\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u69cb\u6210\n\u4eca\u56de\u306f\u3001\u300c\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u300d\u3068\u300c\u30b5\u30fc\u30d3\u30b9\u30d7\u30ed\u30d0\u30a4\u30c0\uff08\u8a8d\u53ef\u30b5\u30fc\u30d0\uff0b\u30ea\u30bd\u30fc\u30b9\u30b5\u30fc\u30d0\uff09\u300d\u3068\u3044\u3046\uff12\u3064\u306eSpring Boot\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u4f5c\u6210\u3057\u3066\u3001\u8a8d\u53ef\u30b3\u30fc\u30c9\u30b0\u30e9\u30f3\u30c8\u30d5\u30ed\u30fc\u3067API\u306e\u8a8d\u8a3c\u30fb\u8a8d\u53ef\u3092\u884c\u3046\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u69cb\u7bc9\u3057\u307e\u3059\u3002\u306a\u304a\u3001\u8a8d\u53ef\u30b5\u30fc\u30d0\u3068\u30ea\u30bd\u30fc\u30b9\u30b5\u30fc\u30d0\u9593\u3067\u306e\u30a2\u30af\u30bb\u30b9\u30c8\u30fc\u30af\u30f3\u53ca\u3073\u30a2\u30af\u30bb\u30b9\u30c8\u30fc\u30af\u30f3\u306b\u7d10\u3065\u304f\u8a8d\u8a3c\u60c5\u5831\u306e\u9023\u643a\u306f\u3001Web\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u4e0a\u3067\u306e\u30a4\u30f3\u30e1\u30e2\u30ea\u9023\u643a\u3068\u3057\u307e\u3059\u3002\n\n\nWarning:\n\u672c\u30a8\u30f3\u30c8\u30ea\u30fc\u3067\u4f5c\u308b\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306fHTTP\u901a\u4fe1\u3092\u4f7f\u7528\u3057\u3066\u52d5\u304b\u3057\u307e\u3059\u304c\u30fb\u30fb\u30fbOAuth 2.0\u306e\u30d7\u30ed\u30c8\u30b3\u30eb\u30d5\u30ed\u30fc\u3067\u306f\u3001\u30ea\u30bd\u30fc\u30b9\u30aa\u30fc\u30ca\u53ca\u3073Client\u306e\u8a8d\u8a3c\u3084\u30a2\u30af\u30bb\u30b9\u30c8\u30fc\u30af\u30f3\u3092\u6271\u3046\u30a8\u30f3\u30c9\u30dd\u30a4\u30f3\u30c8\u306fHTTPS\u901a\u4fe1\u3092\u4f7f\u7528\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\n\n\n\nNote:\n\u8a8d\u53ef\u30b5\u30fc\u30d0\u3068\u30ea\u30bd\u30fc\u30b9\u30b5\u30fc\u30d0\u306f\u5f79\u5272\u304c\u9055\u3046\u305f\u3081\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u611f\u3058\u3067\u72ec\u7acb\u3057\u305fWeb\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3068\u3057\u3066\u4f5c\u6210\u3059\u308b\u30b1\u30fc\u30b9\u306e\u65b9\u304c\u591a\u3044\u3068\u601d\u3044\u307e\u3059\u304c\u3001\u4eca\u56de\u306f\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u69cb\u6210\u306e\u30b7\u30f3\u30d7\u30eb\u3055\u3092\u512a\u5148\u3057\u3001\u8a8d\u53ef\u30b5\u30fc\u30d0\u3068\u30ea\u30bd\u30fc\u30b9\u30b5\u30fc\u30d0\u306f\u3072\u3068\u3064\u306eSpring Boot\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3067\u5b9f\u73fe\u3059\u308b\u3053\u3068\u306b\u3057\u307e\u3057\u305f\u3002\n\n\u8a8d\u53ef\u30b5\u30fc\u30d0\u3068\u30ea\u30bd\u30fc\u30b9\u30b5\u30fc\u30d0\u3092\u5225\u306eWeb\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3068\u3057\u3066\u4f5c\u6210\u3059\u308b\u5834\u5408\u306f\u3001\u30a2\u30af\u30bb\u30b9\u30c8\u30fc\u30af\u30f3\u53ca\u3073\u30a2\u30af\u30bb\u30b9\u30c8\u30fc\u30af\u30f3\u306b\u7d10\u3065\u304f\u8a8d\u8a3c\u60c5\u5831\u3092\u30b5\u30fc\u30d0\u9593\u3067\u9023\u643a\u65b9\u6cd5\u306e\u9078\u629e\u304c\u3072\u3068\u3064\u306e\u30dd\u30a4\u30f3\u30f3\u30c8\u306b\u306a\u308a\u307e\u3059\u3002\u306a\u304a\u3001\u8a8d\u53ef\u30b5\u30fc\u30d0\u3068\u30ea\u30bd\u30fc\u30b9\u30b5\u30fc\u30d0\u3092\u308f\u3051\u305f\u969b\u306e\u5b9f\u88c5\u65b9\u6cd5\u306a\u3069\u306b\u3064\u3044\u3066\u306f\u3001\u6b21\u56de\u4ee5\u964d\u3067\u7d39\u4ecb\u3059\u308b\u4e88\u5b9a\u3067\u3059\u3002\n\n\n\u52d5\u4f5c\u691c\u8a3c\u6e08\u307f\u30d0\u30fc\u30b8\u30e7\u30f3\n\u672c\u30a8\u30f3\u30c8\u30ea\u30fc\u3067\u4f5c\u6210\u3059\u308b\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306f\u3001\u4ee5\u4e0b\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u306e\u30e9\u30a4\u30d6\u30e9\u30ea\u3092\u4f7f\u7528\u3057\u3066\u691c\u8a3c\u3057\u3066\u3044\u307e\u3059\u3002\n\nSpring Boot 1.5.1.RELEASE\nSpring Framework 4.3.6.RELEASE\nSpring Security 4.2.1.RELEASE\nSpring security OAuth 2.0.12.RELEASE\nThymeleaf 2.1.5.RELEASE\nH2 Database 1.4.193\n\n\n\u958b\u767a\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306e\u4f5c\u6210\n\u3067\u306f\u3001\u5b9f\u969b\u306b\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u4f5c\u3063\u3066\u3001\u8a8d\u53ef\u30b3\u30fc\u30c9\u30b0\u30e9\u30f3\u30c8\u30d5\u30ed\u30fc\u306b\u3088\u308bREST API\u306e\u8a8d\u8a3c\u30fb\u8a8d\u53ef\u3092\u4f53\u611f\u3057\u3066\u307f\u307e\u3057\u3087\u3046\u3002\n\u307e\u305a\u3001Spring Boot\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u958b\u767a\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u4f5c\u6210\u3057\u307e\u3057\u3087\u3046\u3002\u3053\u3053\u3067\u306f\u30b3\u30de\u30f3\u30c9\u30e9\u30a4\u30f3\u3067\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092\u4f5c\u6210\u3059\u308b\u4f8b\u306b\u306a\u3063\u3066\u3044\u307e\u3059\u304c\u3001SPRING INITIALIZR\u306eWeb UI\u3084\u304a\u4f7f\u3044\u306eIDE\u306e\u6a5f\u80fd\u3067\u751f\u6210\u3057\u3066\u3082\uff08\u3082\u3061\u308d\u3093\uff09OK\u3067\u3059\uff01\uff01\n\u4eca\u56de\u306f\uff12\u3064\u306e\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u4f5c\u308b\u306e\u3067\u3001\u305d\u308c\u3089\u306e\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u683c\u7d0d\u3059\u308b\u89aa\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n$ mkdir spring-security-oauth-demo\n$ cd spring-security-oauth-demo\n\n\u4f5c\u6210\u3057\u305f\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u79fb\u52d5\u3057\u305f\u5f8c\u306b\u3001Service Provider\u3068Client\u7528\u306eSpring Boot\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u958b\u767a\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\nService Provider\u7528\u306e\u958b\u767a\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u4f5c\u6210\n$ curl -s https://start.spring.io/starter.tgz\\\n       -d name=service-provider\\\n       -d artifactId=service-provider\\\n       -d dependencies=web,jdbc,h2\\\n       -d baseDir=service-provider\\\n       | tar -xzvf -\n\n\nClient\u7528\u306e\u958b\u767a\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u4f5c\u6210\n$ curl -s https://start.spring.io/starter.tgz\\\n       -d name=client\\\n       -d artifactId=client\\\n       -d dependencies=thymeleaf\\\n       -d baseDir=client\\\n       | tar -xzvf -\n\n\n\u30d3\u30eb\u30c9\u7528\u306e\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u4f5c\u6210\nService Provider\u307e\u305f\u306fClient\u306e\u958b\u767a\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u304b\u3089Maven\u30e9\u30c3\u30d1\u30fc\u306a\u3069\u5fc5\u8981\u306a\u30d5\u30a1\u30a4\u30eb\u3092\u30b3\u30d4\u30fc\u3057\u307e\u3059\u3002\n$ cp -r client/.mvn .mvn\n$ cp client/mvnw* .\n$ cp client/.gitignore .\n$ cp client/pom.xml .\n\n\u30b3\u30d4\u30fc\u3057\u305fpom.xml\u3092\u30d3\u30eb\u30c9\u7528\u306e\u8a2d\u5b9a\u306b\u4fee\u6b63\u3057\u307e\u3059\u3002\u3053\u3053\u3067\u306fservice-provider\u3068client\u3092\u30b5\u30d6\u30e2\u30b8\u30e5\u30fc\u30eb\u3068\u3057\u3066\u7ba1\u7406\u3059\u308b\u3088\u3046\u306b\u8a2d\u5b9a\u3057\u3066\u3044\u307e\u3059\u3002\u3053\u3046\u3059\u308b\u3053\u3068\u3067\u3001service-provider\u3068client\u3092\u307e\u3068\u3081\u3066Maven\u30d3\u30eb\u30c9\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\n$ vi pom.xml\n\n\npom.xml\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<project xmlns=\"http://maven.apache.org/POM/4.0.0\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n        xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd\">\n        <modelVersion>4.0.0</modelVersion>\n\n        <groupId>com.example</groupId>\n        <artifactId>spring-security-oauth-demo</artifactId>\n        <version>0.0.1-SNAPSHOT</version>\n        <packaging>pom</packaging>\n\n        <name>spring-seucirty-oauth-demo</name>\n        <description>Spring Security OAuth Demo project for Spring Boot</description>\n\n        <modules>\n                <module>service-provider</module>\n                <module>client</module>\n        </modules>\n\n</project>\n\n\n\nService Provider\u306b\u4f9d\u5b58\u30e9\u30a4\u30d6\u30e9\u30ea\u3092\u8ffd\u52a0\nService Provider\u306b\u3001\u300cSpring Security OAuth\u300d\u300cJackson\u306eJSR 310\u7528\u62e1\u5f35\u30e2\u30b8\u30e5\u30fc\u30eb\u300d\u300cJTS Topology Suite\u300d\u3092\u8ffd\u52a0\u3057\u307e\u3059\u3002\uff08\u300cJTS Topology Suite\u300d\u306f\u4eca\u56de\u306e\u30a8\u30f3\u30c8\u30ea\u30fc\u306b\u76f4\u63a5\u95a2\u4fc2\u306a\u306e\u3067\u3059\u304c\u30fb\u30fb\u30fbH2 Database\u304c\u4f7f\u7528\u3057\u3066\u3044\u3066\u5b9f\u884c\u6642\u306b\u30a8\u30e9\u30fc\u304c\u3067\u308b\u306e\u3067\u8ffd\u52a0\u3057\u3066\u3044\u307e\u3059\uff09\n$ vi service-provider/pom.xml\n\n\nservice-provider/pom.xml\n<dependency>\n    <groupId>org.springframework.security.oauth</groupId>\n    <artifactId>spring-security-oauth2</artifactId>\n</dependency>\n<dependency>\n    <groupId>com.fasterxml.jackson.datatype</groupId>\n    <artifactId>jackson-datatype-jsr310</artifactId>\n</dependency>\n<dependency>\n    <groupId>com.vividsolutions</groupId>\n    <artifactId>jts</artifactId>\n    <version>1.13</version>\n    <scope>runtime</scope>\n</dependency>\n\n\n\nClient\u306b\u4f9d\u5b58\u30e9\u30a4\u30d6\u30e9\u30ea\u3092\u8ffd\u52a0\nClient\u306b\u3001\u300cSpring Security OAuth\u300d\u300cJackson\u306eJSR 310\u7528\u62e1\u5f35\u30e2\u30b8\u30e5\u30fc\u30eb\u300d\u300cThymeleaf\u306eJSR 310\u7528\u62e1\u5f35\u30e2\u30b8\u30e5\u30fc\u30eb\u300d\u300cWebjars Locator\u300d\u300cWebJar for Bootstrap\u300d\u3092\u8ffd\u52a0\u3057\u307e\u3059\u3002\n$ vi client/pom.xml\n\n\nclient/pom.xml\n<dependency>\n    <groupId>org.springframework.security.oauth</groupId>\n    <artifactId>spring-security-oauth2</artifactId>\n</dependency>\n<dependency>\n    <groupId>com.fasterxml.jackson.datatype</groupId>\n    <artifactId>jackson-datatype-jsr310</artifactId>\n</dependency>\n<dependency>\n    <groupId>org.thymeleaf.extras</groupId>\n    <artifactId>thymeleaf-extras-java8time</artifactId>\n</dependency>\n<dependency>\n    <groupId>org.webjars</groupId>\n    <artifactId>webjars-locator</artifactId>\n</dependency>\n<dependency>\n    <groupId>org.webjars</groupId>\n    <artifactId>bootstrap</artifactId>\n    <version>3.3.7-1</version>\n</dependency>\n\n\n\nNote:\n\u300cWebjars Locator\u300d\u3068\u300cWebJar for Bootstrap\u300d\u306b\u3064\u3044\u3066\u306f\u3001\u300cSpring MVC(+Spring Boot)\u4e0a\u3067\u306e\u9759\u7684\u30ea\u30bd\u30fc\u30b9\u3078\u306e\u30a2\u30af\u30bb\u30b9\u3092\u7406\u89e3\u3059\u308b\u300d\u306e\u4e2d\u306e\u30fb\u30fb\u30fb\n\nSpring Boot\u4e0a\u3067\u306e\u9759\u7684\u30ea\u30bd\u30fc\u30b9\u3078\u306e\u30a2\u30af\u30bb\u30b9-WebJar\u306e\u5229\u7528\nSpring MVC\u306e\u72ec\u81ea\u6a5f\u80fd\u3092\u5229\u7528\u3057\u305f\u9759\u7684\u30ea\u30bd\u30fc\u30b9\u3078\u306e\u30a2\u30af\u30bb\u30b9-WebJar\u306e\u5229\u7528\n\n\u3067\u7c21\u5358\u306b\u8aac\u660e\u3057\u3066\u3044\u308b\u306e\u3067\u3001\u8208\u5473\u306e\u3042\u308b\u65b9\u306f\u3054\u89a7\u304f\u3060\u3055\u3044\u3002\n\n\nMavne\u30d3\u30eb\u30c9\u306e\u78ba\u8a8d\n\u30d3\u30eb\u30c9\u7528\u306epom.xml\u304c\u683c\u7d0d\u3055\u308c\u3066\u3044\u308b\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3067Mavne\u30d3\u30eb\u30c9(Maven Package)\u3092\u884c\u3044\u3001pom.xml\u306e\u8a2d\u5b9a\u306e\u59a5\u5f53\u6027\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u30ed\u30b0\u304c\u3067\u308c\u3070Mavne\u30d3\u30eb\u30c9\u306f\u6210\u529f\u3067\u3059\u3002\n$ ./mvnw package\n...\n[INFO] ------------------------------------------------------------------------\n[INFO] Building spring-seucirty-oauth-demo 0.0.1-SNAPSHOT\n[INFO] ------------------------------------------------------------------------\n[INFO] ------------------------------------------------------------------------\n[INFO] Reactor Summary:\n[INFO] \n[INFO] service-provider ................................... SUCCESS [  3.899 s]\n[INFO] client ............................................. SUCCESS [  2.697 s]\n[INFO] spring-seucirty-oauth-demo ......................... SUCCESS [  0.000 s]\n[INFO] ------------------------------------------------------------------------\n[INFO] BUILD SUCCESS\n[INFO] ------------------------------------------------------------------------\n[INFO] Total time: 7.088 s\n[INFO] Finished at: 2017-02-25T09:05:35+09:00\n[INFO] Final Memory: 29M/395M\n[INFO] ------------------------------------------------------------------------\n\n\nService Provider\u306e\u4f5c\u6210\n\u307e\u305a\u306f\u3001Service Provider\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\nService Provider\u306e\u30b5\u30fc\u30d0\u8a2d\u5b9a\n\u5192\u982d\u306e\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u69cb\u6210\u3067\u7d39\u4ecb\u3057\u305f\u901a\u308a\u3001Service Provider\u306e\u30dd\u30fc\u30c8\u309218081\u306b\u3001\u30b3\u30f3\u30c6\u30ad\u30b9\u30c8\u30d1\u30b9\u3092/provider\u306b\u3057\u307e\u3059\u3002\u307e\u305f\u3001REST API\u3067\u6271\u3046\u30bf\u30b9\u30af\u60c5\u5831\u304c\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u518d\u8d77\u52d5\u6642\u306b\u6d88\u3048\u306a\u3044\u3088\u3046\u306b\u3059\u308b\u305f\u3081\u306b\u3001H2\u306e\u30d5\u30a1\u30a4\u30eb\u30d9\u30fc\u30b9\u306e\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3092\u4f7f\u7528\u3059\u308b\u3088\u3046\u306b\u3057\u307e\u3059\u3002\n\nservice-provider/src/main/resources/application.properties\nserver.port=18081\nserver.context-path=/provider\nspring.datasource.url=jdbc:h2:~/.h2/service-provider\n\n\n\nNote:\nService Provider\u3068Client\u3092\u540c\u4e00\u30db\u30b9\u30c8(localhost\u306a\u3069)\u3067\u52d5\u304b\u3059\u5834\u5408\u3001context-path(\u30c7\u30d5\u30a9\u30eb\u30c8\u306f/)\u304c\u540c\u3058\u3060\u3068\u30bb\u30c3\u30b7\u30e7\u30f3ID\u3092\u7ba1\u7406\u3059\u308bCookie\u304c\u7af6\u5408\u3057\u3066HTTP\u30bb\u30c3\u30b7\u30e7\u30f3\u3092\u6b63\u3057\u304f\u6271\u3048\u306a\u3044\u3053\u3068\u304c\u3042\u308b\u305f\u3081\u3001\u30ed\u30fc\u30ab\u30eb\u74b0\u5883\u3067\u52d5\u304b\u3059\u5834\u5408\u306fcontext-path\u306e\u8a2d\u5b9a\u3082\u5fc5\u8981\u306b\u306a\u308a\u307e\u3059\u3002\n\n\n\u30c6\u30fc\u30d6\u30eb\u306e\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\n\u30bf\u30b9\u30af\u60c5\u5831\u3092\u4fdd\u5b58\u3059\u308b\u305f\u3081\u306e\u30c6\u30fc\u30d6\u30eb\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\nservice-provider/src/main/resources/schema.sql\nCREATE TABLE IF NOT EXISTS tasks (\n  id IDENTITY PRIMARY KEY\n  , username VARCHAR(255) NOT NULL\n  , title TEXT NOT NULL\n  , detail TEXT\n  , deadline DATE\n  , finished BOOLEAN NOT NULL DEFAULT FALSE\n  , created_at DATETIME DEFAULT SYSTIMESTAMP\n  , updated_at DATETIME DEFAULT SYSTIMESTAMP\n  , version BIGINT DEFAULT 1\n);\n\nCREATE INDEX IF NOT EXISTS idx_tasks_username ON tasks(username);\n\n\n\n\u30c9\u30e1\u30a4\u30f3\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306e\u4f5c\u6210\nREST API\u3067\u6271\u3046\u30bf\u30b9\u30af\u60c5\u5831\u3092\u4fdd\u6301\u3059\u308b\u30c9\u30e1\u30a4\u30f3\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\nservice-provider/src/main/java/com/example/Task.java\npackage com.example;\n\nimport java.time.LocalDate;\nimport java.time.LocalDateTime;\n\npublic class Task {\n\n    private long id;\n    private String username;\n    private String title;\n    private String detail;\n    private LocalDate deadline;\n    private boolean finished;\n    private LocalDateTime createdAt;\n    private LocalDateTime updatedAt;\n    private long version;\n\n    // getter/setter\n\n}\n\n\n\nRepository\u306e\u4f5c\u6210\n\u30bf\u30b9\u30af\u60c5\u5831\u3092\u4fdd\u6301\u3059\u308b\u30c9\u30e1\u30a4\u30f3\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306eRepository\u30af\u30e9\u30b9\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\u672c\u30a8\u30f3\u30c8\u30ea\u30fc\u3067\u306fJPA\u306a\u3069\u306eO/R Mapper\u306f\u4f7f\u308f\u305a\u306b\u3001Spring Framework\u304c\u63d0\u4f9b\u3059\u308b\u30c7\u30fc\u30bf\u30a2\u30af\u30bb\u30b9\u6a5f\u80fd(JdbcOperations)\u3092\u5229\u7528\u3057\u3066\u5b9f\u88c5\u3057\u307e\u3059\u3002\uff08\u5b9f\u969b\u306b\u306f\u30fb\u30fb\u30fb\u540d\u524d\u30d9\u30fc\u30b9\u306e\u30d1\u30e9\u30e1\u30fc\u30bf\u304c\u6271\u3048\u308bNamedParameterJdbcOperations\u3092\u4f7f\u3044\u307e\u3059\uff09\n\nNote:\nJdbcOperations\u53ca\u3073NamedParameterJdbcOperations\u306eBean\u306f\u3001Spring Boot\u306eAutoConfigure\u306e\u4ed5\u7d44\u307f\u3067Bean\u5b9a\u7fa9\u3055\u308c\u308b\u305f\u3081\u3001\u958b\u767a\u8005\u304c\u660e\u793a\u7684\u306bBean\u5b9a\u7fa9\u3059\u308b\u5fc5\u8981\u306f\u3042\u308a\u307e\u305b\u3093\u3002\n\n\nservice-provider/src/main/java/com/example/TaskRepository.java\npackage com.example;\n\nimport java.util.List;\n\nimport org.springframework.jdbc.core.BeanPropertyRowMapper;\nimport org.springframework.jdbc.core.namedparam.BeanPropertySqlParameterSource;\nimport org.springframework.jdbc.core.namedparam.MapSqlParameterSource;\nimport org.springframework.jdbc.core.namedparam.NamedParameterJdbcOperations;\nimport org.springframework.jdbc.support.GeneratedKeyHolder;\nimport org.springframework.stereotype.Repository;\nimport org.springframework.transaction.annotation.Transactional;\n\n@Transactional\n@Repository\npublic class TaskRepository {\n    private final NamedParameterJdbcOperations jdbcOperations;\n\n    public TaskRepository(NamedParameterJdbcOperations jdbcOperations) {\n        this.jdbcOperations = jdbcOperations;\n    }\n\n    public List<Task> findAll(String username) {\n        return jdbcOperations.query(\n                \"SELECT id, username, title, detail, deadline, finished, created_at, updated_at, version FROM tasks WHERE username = :username ORDER BY deadline DESC, id DESC\",\n                new MapSqlParameterSource(\"username\", username), new BeanPropertyRowMapper<>(Task.class));\n    }\n\n    public Task findOne(long id) {\n        return jdbcOperations.queryForObject(\n                \"SELECT id, username, title, detail, deadline, finished, created_at, updated_at, version FROM tasks WHERE id = :id\",\n                new MapSqlParameterSource(\"id\", id), new BeanPropertyRowMapper<>(Task.class));\n    }\n\n    public void save(Task task) {\n        if (task.getId() == null) {\n            GeneratedKeyHolder holder = new GeneratedKeyHolder();\n            jdbcOperations.update(\n                    \"INSERT INTO tasks (username, title, detail, deadline, finished) VALUES(:username, :title, :detail, :deadline, :finished)\",\n                    new BeanPropertySqlParameterSource(task), holder);\n            task.setId(holder.getKey().longValue());\n        } else {\n            jdbcOperations.update(\n                    \"UPDATE tasks SET title = :title, detail = :detail, deadline = :deadline, finished = :finished, updated_at = SYSTIMESTAMP, version = version + 1 WHERE id = :id\",\n                    new BeanPropertySqlParameterSource(task));\n        }\n    }\n\n    public void remove(long id) {\n        jdbcOperations.update(\"DELETE FROM tasks WHERE id = :id\", new MapSqlParameterSource(\"id\", id));\n    }\n\n}\n\n\n\nRestController(REST API)\u306e\u4f5c\u6210\n\u30bf\u30b9\u30af\u60c5\u5831\u306b\u5bfe\u3059\u308bCRUD\u64cd\u4f5c(REST API)\u3092\u63d0\u4f9b\u3059\u308bController\u30af\u30e9\u30b9\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002JdbcTemplate\u4f7f\u7528\u6642\u306b\u5bfe\u8c61\u30c7\u30fc\u30bf\u304c\u898b\u3064\u304b\u3089\u306a\u3044\u3068EmptyResultDataAccessException\u304c\u767a\u751f\u3059\u308b\u305f\u3081\u3001REST API\u7528\u306eHandler\u30e1\u30bd\u30c3\u30c9\u306b\u52a0\u3048\u3001EmptyResultDataAccessException\u3092\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0\u3057\u3066404 Not Found\u3092\u8fd4\u5374\u3059\u308b\u305f\u3081\u306e\u4f8b\u5916\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0\u30e1\u30bd\u30c3\u30c9\u3082\u5b9f\u88c5\u3057\u307e\u3059\u3002\n\nservice-provider/src/main/java/com/example/TaskRestController.java\npackage com.example;\n\nimport static org.springframework.web.servlet.mvc.method.annotation.MvcUriComponentsBuilder.on;\nimport static org.springframework.web.servlet.mvc.method.annotation.MvcUriComponentsBuilder.relativeTo;\n\nimport java.net.URI;\nimport java.security.Principal;\nimport java.util.List;\nimport java.util.Optional;\n\nimport org.springframework.dao.EmptyResultDataAccessException;\nimport org.springframework.http.HttpStatus;\nimport org.springframework.http.ResponseEntity;\nimport org.springframework.web.bind.annotation.DeleteMapping;\nimport org.springframework.web.bind.annotation.ExceptionHandler;\nimport org.springframework.web.bind.annotation.GetMapping;\nimport org.springframework.web.bind.annotation.PathVariable;\nimport org.springframework.web.bind.annotation.PostMapping;\nimport org.springframework.web.bind.annotation.PutMapping;\nimport org.springframework.web.bind.annotation.RequestBody;\nimport org.springframework.web.bind.annotation.RequestMapping;\nimport org.springframework.web.bind.annotation.ResponseStatus;\nimport org.springframework.web.bind.annotation.RestController;\nimport org.springframework.web.util.UriComponentsBuilder;\n\n@RequestMapping(\"/api/tasks\")\n@RestController\npublic class TaskRestController {\n\n    private final TaskRepository repository;\n\n    TaskRestController(TaskRepository repository) {\n        this.repository = repository;\n    }\n\n    @GetMapping\n    List<Task> getTasks(Principal principal) {\n        return repository.findAll(extractUsername(principal));\n    }\n\n    @PostMapping\n    ResponseEntity<Void> postTask(@RequestBody Task task, Principal principal, UriComponentsBuilder uriBuilder) {\n        task.setUsername(extractUsername(principal));\n        repository.save(task);\n        URI createdTaskUri = relativeTo(uriBuilder).withMethodCall(on(TaskRestController.class).getTask(task.getId()))\n                .build().encode().toUri();\n        return ResponseEntity.created(createdTaskUri).build();\n    }\n\n    @GetMapping(\"{id}\")\n    Task getTask(@PathVariable long id) {\n        return repository.findOne(id);\n    }\n\n    @PutMapping(\"{id}\")\n    @ResponseStatus(HttpStatus.NO_CONTENT)\n    void putTask(@PathVariable long id, @RequestBody Task task) {\n        task.setId(id);\n        repository.save(task);\n    }\n\n    @DeleteMapping(\"{id}\")\n    @ResponseStatus(HttpStatus.NO_CONTENT)\n    void deleteTask(@PathVariable long id) {\n        repository.remove(id);\n    }\n\n    private String extractUsername(Principal principal) {\n        return Optional.ofNullable(principal).map(Principal::getName).orElse(\"none\");\n    }\n\n    @ExceptionHandler(EmptyResultDataAccessException.class)\n    @ResponseStatus(HttpStatus.NOT_FOUND)\n    void handleEmptyResultDataAccessException() {\n        // NOP\n    }\n\n}\n\n\n\nREST API\u306e\u52d5\u4f5c\u78ba\u8a8d\n\u4f5c\u6210\u3057\u305fREST API\u304c\u6b63\u3057\u304f\u52d5\u4f5c\u3059\u308b\u304b\u78ba\u8a8d\u3057\u3066\u307f\u307e\u3059\u3002\n\nService Provider\u306e\u8d77\u52d5\nSpring Boot\u304c\u63d0\u4f9b\u3057\u3066\u3044\u308bMaven Plugin\u3092\u4f7f\u7528\u3057\u3066\u3001Spring Boot\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u8d77\u52d5\u3057\u307e\u3059\u3002\n$ ./mvnw -pl service-provider spring-boot:run\n\n\n\u300c\u30bf\u30b9\u30af\u60c5\u5831\u306e\u4e00\u89a7\u53d6\u5f97API\u300d\u306e\u547c\u3073\u51fa\u3057\n\u3067\u306f\u30fb\u30fb\u7121\u90aa\u6c17\u306b\u300c\u30bf\u30b9\u30af\u60c5\u5831\u306e\u4e00\u89a7\u53d6\u5f97API\u300d\u3092\u547c\u3073\u51fa\u3057\u3066\u307f\u307e\u3057\u3087\u3046\uff01\uff01\n$ $ curl -D - -s http://localhost:18081/provider/api/tasks\nHTTP/1.1 401 \nX-Content-Type-Options: nosniff\nX-XSS-Protection: 1; mode=block\nCache-Control: no-cache, no-store, max-age=0, must-revalidate\nPragma: no-cache\nExpires: 0\nX-Frame-Options: DENY\nStrict-Transport-Security: max-age=31536000 ; includeSubDomains\nWWW-Authenticate: Basic realm=\"Spring\"\nContent-Type: application/json;charset=UTF-8\nTransfer-Encoding: chunked\nDate: Sat, 25 Feb 2017 01:53:04 GMT\n\n{\"timestamp\":1487987584305,\"status\":401,\"error\":\"Unauthorized\",\"message\":\"Full authentication is required to access this resource\",\"path\":\"/provider/api/tasks\"}\n\n\u3069\u3046\u3084\u3089Basic\u8a8d\u8a3c\u304c\u5fc5\u8981\u307f\u305f\u3044\u3067\u3059\u306d\u3002\n\u3053\u308c\u306f\u3001Spring Boot\u306eAutoConfigure\u304cSpring Security\u306e\u30af\u30e9\u30b9\u3092\u307f\u3064\u3051\u308b\u3068\u30fb\u30fb\u30fb\u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u5168\u3066\u306e\u30ea\u30af\u30a8\u30b9\u30c8\u30d1\u30b9\uff08/**\uff09\u306bBasic\u8a8d\u8a3c\u3092\u8981\u6c42\u3059\u308b\u4ed5\u7d44\u307f\u306b\u306a\u3063\u3066\u3044\u308b\u305f\u3081\u3067\u3059\u3002\n\u4eca\u306fREST API\u306e\u52d5\u4f5c\u78ba\u8a8d\u304c\u3057\u305f\u3044\u306e\u3067\u3001\u3044\u3063\u305f\u3093Basic\u8a8d\u8a3c\u3092\u7121\u52b9\u5316\u3057\u3066\u3057\u307e\u3044\u307e\u3057\u3087\u3046\u3002Spring Boot\u304c\u8981\u6c42\u3059\u308bBasic\u8a8d\u8a3c\u306f\u3001security.basic.enabled=false\u3068\u3044\u3046\u8a2d\u5b9a\u3092\u8ffd\u52a0\u3059\u308b\u3053\u3068\u3067\u7121\u52b9\u5316\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\nservice-provider/src/main/resources/application.properties\nsecurity.basic.enabled=false\n\n\n\nWarning:\nREST API\u306e\u52d5\u4f5c\u78ba\u8a8d\u304c\u7d42\u308f\u3063\u305f\u3089Basic\u8a8d\u8a3c\u3092\u6709\u52b9\u5316\u3057\u3066\u304f\u3060\u3055\u3044\uff01\uff01\n\nBasic\u8a8d\u8a3c\u3092\u7121\u52b9\u5316\u3057\u305f\u5f8c\u306bREST API\u306b\u30a2\u30af\u30bb\u30b9\u3059\u308b\u3068\u3001\u7a7a\u306e\u30bf\u30b9\u30af\u4e00\u89a7\u304c\u53d6\u5f97\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3057\u305f\u3002\n$ curl -D - -s http://localhost:18081/api/tasks\nHTTP/1.1 200 \nContent-Type: application/json;charset=UTF-8\nTransfer-Encoding: chunked\nDate: Sat, 25 Feb 2017 02:01:57 GMT\n\n[]\n\n\n\u300c\u30bf\u30b9\u30af\u60c5\u5831\u306e\u4f5c\u6210API\u300d\u306e\u547c\u3073\u51fa\u3057\n\u8d77\u52d5\u76f4\u5f8c\u3067\u30bf\u30b9\u30af\u60c5\u5831\u304c\uff11\u4ef6\u3082\u767b\u9332\u3055\u308c\u3066\u306a\u3044\u306e\u3067\u3001\u300c\u30bf\u30b9\u30af\u60c5\u5831\u306e\u4f5c\u6210API\u300d\u3092\u547c\u3073\u51fa\u3057\u3066\u30bf\u30b9\u30af\u60c5\u5831\u3092\u4f5c\u6210\u3057\u3066\u307f\u307e\u3057\u3087\u3046\u3002\n$ curl -D - -s http://localhost:18081/provider/api/tasks -H \"Content-Type: application/json\" -X POST -d '{\"title\":\"Test Title\",\"detail\":\"Test Detail\",\"deadline\":\"2017-02-28\"}'\nHTTP/1.1 201 \nLocation: http://localhost:18081/provider/api/tasks/1\nContent-Length: 0\nDate: Sat, 25 Feb 2017 02:17:37 GMT\n\n\n\u30bf\u30b9\u30af\u60c5\u5831\u306e\u4f5c\u6210\u306b\u6210\u529f\u3059\u308b\u3068\u3001Location\u30d8\u30c3\u30c0\u306b\u4f5c\u6210\u3057\u305f\u30bf\u30b9\u30af\u60c5\u5831\u306b\u30a2\u30af\u30bb\u30b9\u3059\u308b\u305f\u3081\u306eURL\u304c\u8a2d\u5b9a\u3055\u308c\u307e\u3059\u3002\n\n\u300c\u30bf\u30b9\u30af\u60c5\u5831\u306e\u53d6\u5f97API\u300d\u306e\u547c\u3073\u51fa\u3057\n\u300c\u30bf\u30b9\u30af\u60c5\u5831\u306e\u53d6\u5f97API\u300d\u3092\u547c\u3073\u51fa\u3057\u3066(Location\u30d8\u30c3\u30c0\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308bURL\u306b\u30a2\u30af\u30bb\u30b9\u3057\u3066)\u3001\u4f5c\u6210\u3057\u305f\u30bf\u30b9\u30af\u60c5\u5831\u3092\u53d6\u5f97\u3057\u3066\u307f\u307e\u3057\u3087\u3046\u3002\n$ curl -D - -s http://localhost:18081/provider/api/tasks/1\nHTTP/1.1 200 \nContent-Type: application/json;charset=UTF-8\nTransfer-Encoding: chunked\nDate: Sat, 25 Feb 2017 02:29:12 GMT\n\n{\"id\":1,\"username\":\"none\",\"title\":\"Test Title\",\"detail\":\"Test Detail\",\"deadline\":[2017,2,28],\"finished\":false,\"createdAt\":[2017,2,25,11,17,37,671000000],\"updatedAt\":[2017,2,25,11,17,37,671000000],\"version\":1}\n\n\u306a\u306b\u3084\u3089\u30bf\u30b9\u30af\u60c5\u5831\u304c\u53d6\u5f97\u3067\u304d\u307e\u3057\u305f\u304c\u30fb\u30fb\u30fb\u65e5\u4ed8\u30fb\u65e5\u6642\u306e\u3068\u3053\u308d\u306e\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u304c\u3061\u3087\u3063\u3068\u6b8b\u5ff5\u306a\u611f\u3058\u306a\u306e\u3067\u3001\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u6e08\u307f\u306e\u5024\u304c\u51fa\u529b\u3055\u308c\u308b\u3088\u3046\u306b\u3057\u3066\u307f\u307e\u3057\u3087\u3046\u3002\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u6e08\u307f\u306e\u65e5\u4ed8\u30fb\u65e5\u6642\u3092\u51fa\u529b\u3057\u305f\u3044\u5834\u5408\u306f\u3001spring.jackson.serialization.write-dates-as-timestamps=false\u3092\u8a2d\u5b9a\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\nservice-provider/src/main/resources/application.properties\nspring.jackson.serialization.write-dates-as-timestamps=false\n\n\nspring.jackson.serialization.write-dates-as-timestamps=false\u3092\u8a2d\u5b9a\u3057\u305f\u5f8c\u306b\u518d\u5ea6\u30a2\u30af\u30bb\u30b9\u3059\u308b\u3068\u3001\u305d\u308c\u3063\u307d\u3044\u5f62\u5f0f\u306b\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u304c\u78ba\u8a8d\u3067\u304d\u307e\u3059\u3002\n$ curl -D - -s http://localhost:18081/provider/api/tasks/1\nHTTP/1.1 200 \nContent-Type: application/json;charset=UTF-8\nTransfer-Encoding: chunked\nDate: Sat, 25 Feb 2017 02:31:13 GMT\n\n{\"id\":1,\"username\":\"none\",\"title\":\"Test Title\",\"detail\":\"Test Detail\",\"deadline\":\"2017-02-28\",\"finished\":false,\"createdAt\":\"2017-02-25T11:17:37.671\",\"updatedAt\":\"2017-02-25T11:17:37.671\",\"version\":1}\n\n\n\u300c\u30bf\u30b9\u30af\u60c5\u5831\u306e\u66f4\u65b0API\u300d\u306e\u547c\u3073\u51fa\u3057\n\u305b\u3063\u304b\u304f\u306a\u306e\u3067\u30fb\u30fb\u30fb\u300c\u30bf\u30b9\u30af\u60c5\u5831\u306e\u66f4\u65b0API\u300d\u3092\u547c\u3073\u51fa\u3057\u3066\u3001\u30bf\u30b9\u30af\u60c5\u5831\u3092\u66f4\u65b0\u3057\u3066\u307f\u307e\u3059\u3002\n$ curl -D - -s http://localhost:18081/provider/api/tasks/1 -H \"Content-Type: application/json\" -X PUT -d '{\"title\":\"Test Title(Edit)\",\"detail\":\"Test Detail(Edit)\",\"deadline\":\"2017-03-31\"}'\nHTTP/1.1 204 \nDate: Sat, 25 Feb 2017 02:33:58 GMT\n\n\n\u66f4\u65b0\u3057\u305f\u30bf\u30b9\u30af\u60c5\u5831\u3092\u53d6\u5f97\u3059\u308b\u3068\u3001\u6b63\u3057\u304f\u66f4\u65b0\u3067\u304d\u3066\u3044\u308b\u3053\u3068\u304c\u78ba\u8a8d\u3067\u304d\u307e\u3059\u3002\n$ curl -D - -s http://localhost:18081/provider/api/tasks/1\nHTTP/1.1 200 \nContent-Type: application/json;charset=UTF-8\nTransfer-Encoding: chunked\nDate: Sat, 25 Feb 2017 02:34:21 GMT\n\n{\"id\":1,\"username\":\"none\",\"title\":\"Test Title(Edit)\",\"detail\":\"Test Detail(Edit)\",\"deadline\":\"2017-03-31\",\"finished\":false,\"createdAt\":\"2017-02-25T11:17:37.671\",\"updatedAt\":\"2017-02-25T11:33:58.51\",\"version\":2}\n\n\n\u300c\u30bf\u30b9\u30af\u60c5\u5831\u306e\u524a\u9664API\u300d\u306e\u547c\u3073\u51fa\u3057\n\u6700\u5f8c\u306e\u300c\u30bf\u30b9\u30af\u60c5\u5831\u306e\u524a\u9664API\u300d\u3092\u547c\u3073\u51fa\u3057\u3001\u4f5c\u6210\u3057\u305f\u30bf\u30b9\u30af\u60c5\u5831\u3092\u524a\u9664\u3057\u3066\u307f\u307e\u3059\u3002\n$ curl -D - -s http://localhost:18081/provider/api/tasks/1 -X DELETE\nHTTP/1.1 204 \nDate: Sat, 25 Feb 2017 02:35:20 GMT\n\n\n\u524a\u9664\u3057\u305f\u30bf\u30b9\u30af\u60c5\u5831\u3092\u53d6\u5f97\u3057\u3088\u3046\u3068\u3059\u308b\u3068\u3001\u5bfe\u8c61\u30c7\u30fc\u30bf\u304c\u306a\u3044\u3053\u3068\u3092\u901a\u77e5\u3059\u308b\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u30a8\u30e9\u30fc\uff08404: Not Found\uff09\u3057\u307e\u3059\u3002\n$ curl -D - -s http://localhost:18081/provider/api/tasks/1\nHTTP/1.1 404 \nContent-Length: 0\nDate: Sat, 25 Feb 2017 02:35:37 GMT\n\n\n\n\u8a8d\u53ef\u30b5\u30fc\u30d0\u306e\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\n\u30b3\u30f3\u30d5\u30a3\u30ae\u30e5\u30ec\u30fc\u30b7\u30e7\u30f3\u30af\u30e9\u30b9\u306b@EnableAuthorizationServer\u3092\u4ed8\u4e0e\u3057\u3066\u3001OAuth\u306e\u8a8d\u8a3c\u30fb\u8a8d\u53ef\u306b\u5fc5\u8981\u306aBean\u5b9a\u7fa9\u3092\u884c\u3044\u3001\u8a8d\u53ef\u30b5\u30fc\u30d0\u4e0a\u306b\u300c\u8a8d\u53ef\u30a8\u30f3\u30c9\u30dd\u30a4\u30f3\u30c8\u300d\u3068\u300c\u30c8\u30fc\u30af\u30f3\u30a8\u30f3\u30c9\u30dd\u30a4\u30f3\u30c8\u300d\u3092\u516c\u958b\u3057\u307e\u3059\u3002\n\nservice-provider/src/main/java/com/example/AuthorizationServerConfiguration.java\npackage com.example;\n\nimport org.springframework.context.annotation.Configuration;\nimport org.springframework.security.oauth2.config.annotation.web.configuration.EnableAuthorizationServer;\n\n@EnableAuthorizationServer\n@Configuration\npublic class AuthorizationServerConfiguration {\n}\n\n\n\u307e\u305f\u3001Spring Boot\u306e\u30c7\u30d5\u30a9\u30eb\u30c8\u3060\u3068\u4ee5\u4e0b\u306e\u5024\u304c\u8d77\u52d5\u6642\u306b\u30e9\u30f3\u30c0\u30e0\u306b\u5272\u308a\u5f53\u3066\u3089\u308c\u308b\u305f\u3081\u3001\u56fa\u5b9a\u5024\u3092\u8a2d\u5b9a\u3059\u308b\u3088\u3046\u306b\u3057\u307e\u3059\u3002\n\n\u30c7\u30d5\u30a9\u30eb\u30c8\u30e6\u30fc\u30b6(user)\u306e\u30d1\u30b9\u30ef\u30fc\u30c9\n\u30c7\u30d5\u30a9\u30eb\u30c8\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u306e\u30af\u30e9\u30a4\u30a2\u30f3\u30c8ID\n\u30c7\u30d5\u30a9\u30eb\u30c8\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u306e\u30b7\u30fc\u30af\u30ec\u30c3\u30c8\n\n\nservice-provider/src/main/resources/application.properties\nsecurity.user.password=password\nsecurity.oauth2.client.client-id=client\nsecurity.oauth2.client.client-secret=secret\n\n\n\u3055\u3089\u306b\u3001\u30c7\u30d5\u30a9\u30eb\u30c8\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u304c\u6271\u3048\u308b\u30b9\u30b3\u30fc\u30d7\u3068\u30b0\u30e9\u30f3\u30c8\u30bf\u30a4\u30d7\u306e\u6307\u5b9a\u3082\u884c\u3044\u307e\u3057\u3087\u3046\u3002\u300cpassowrd:\u30ea\u30bd\u30fc\u30b9\u30aa\u30fc\u30ca\u30d1\u30b9\u30ef\u30fc\u30c9\u30af\u30ec\u30c7\u30f3\u30b7\u30e3\u30eb\u300d\u306f\u672c\u6765\u3067\u3042\u308c\u3070\u4e0d\u8981\u306a\u306e\u3067\u3059\u304c\u3001CUI(cURL\u30b3\u30de\u30f3\u30c9)\u3092\u4f7f\u7528\u3057\u3066\u8a8d\u53ef\u30b5\u30fc\u30d0\u3068\u30ea\u30bd\u30fc\u30b9\u30b5\u30fc\u30d0\u306e\u52d5\u4f5c\u78ba\u8a8d\u3092\u884c\u3046\u305f\u3081\u306b\u6307\u5b9a\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n\nservice-provider/src/main/resources/application.properties\nsecurity.oauth2.client.scope=read,write\nsecurity.oauth2.client.authorized-grant-types=authorization_code,password\n\n\n\u3053\u306e\u72b6\u614b\u3067Service Provider\u3092\u8d77\u52d5\u3059\u308b\u3068\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u30ed\u30b0\u304c\u51fa\u529b\u3055\u308c\u3001\u8a8d\u53ef\u30b5\u30fc\u30d0\u306bOAuth\u7528\u306e\u30a8\u30f3\u30c9\u30dd\u30a4\u30f3\u30c8\u304c\u516c\u958b\u3055\u308c\u305f\u3053\u3068\u304c\u308f\u304b\u308a\u307e\u3059\u3002\n...\n2017-02-25 13:41:48.269  INFO 75893 --- [           main] .s.o.p.e.FrameworkEndpointHandlerMapping : Mapped \"{[/oauth/authorize]}\" onto public org.springframework.web.servlet.ModelAndView org.springframework.security.oauth2.provider.endpoint.AuthorizationEndpoint.authorize(java.util.Map<java.lang.String, java.lang.Object>,java.util.Map<java.lang.String, java.lang.String>,org.springframework.web.bind.support.SessionStatus,java.security.Principal)\n2017-02-25 13:41:48.270  INFO 75893 --- [           main] .s.o.p.e.FrameworkEndpointHandlerMapping : Mapped \"{[/oauth/authorize],methods=[POST],params=[user_oauth_approval]}\" onto public org.springframework.web.servlet.View org.springframework.security.oauth2.provider.endpoint.AuthorizationEndpoint.approveOrDeny(java.util.Map<java.lang.String, java.lang.String>,java.util.Map<java.lang.String, ?>,org.springframework.web.bind.support.SessionStatus,java.security.Principal)\n2017-02-25 13:41:48.271  INFO 75893 --- [           main] .s.o.p.e.FrameworkEndpointHandlerMapping : Mapped \"{[/oauth/token],methods=[GET]}\" onto public org.springframework.http.ResponseEntity<org.springframework.security.oauth2.common.OAuth2AccessToken> org.springframework.security.oauth2.provider.endpoint.TokenEndpoint.getAccessToken(java.security.Principal,java.util.Map<java.lang.String, java.lang.String>) throws org.springframework.web.HttpRequestMethodNotSupportedException\n2017-02-25 13:41:48.271  INFO 75893 --- [           main] .s.o.p.e.FrameworkEndpointHandlerMapping : Mapped \"{[/oauth/token],methods=[POST]}\" onto public org.springframework.http.ResponseEntity<org.springframework.security.oauth2.common.OAuth2AccessToken> org.springframework.security.oauth2.provider.endpoint.TokenEndpoint.postAccessToken(java.security.Principal,java.util.Map<java.lang.String, java.lang.String>) throws org.springframework.web.HttpRequestMethodNotSupportedException\n2017-02-25 13:41:48.272  INFO 75893 --- [           main] .s.o.p.e.FrameworkEndpointHandlerMapping : Mapped \"{[/oauth/check_token]}\" onto public java.util.Map<java.lang.String, ?> org.springframework.security.oauth2.provider.endpoint.CheckTokenEndpoint.checkToken(java.lang.String)\n2017-02-25 13:41:48.273  INFO 75893 --- [           main] .s.o.p.e.FrameworkEndpointHandlerMapping : Mapped \"{[/oauth/confirm_access]}\" onto public org.springframework.web.servlet.ModelAndView org.springframework.security.oauth2.provider.endpoint.WhitelabelApprovalEndpoint.getAccessConfirmation(java.util.Map<java.lang.String, java.lang.Object>,javax.servlet.http.HttpServletRequest) throws java.lang.Exception\n2017-02-25 13:41:48.290  INFO 75893 --- [           main] .s.o.p.e.FrameworkEndpointHandlerMapping : Mapped \"{[/oauth/error]}\" onto public org.springframework.web.servlet.ModelAndView org.springframework.security.oauth2.provider.endpoint.WhitelabelErrorEndpoint.handleError(javax.servlet.http.HttpServletRequest)\n...\n\n\n\u30ea\u30bd\u30fc\u30b9\u30b5\u30fc\u30d0\u306e\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\n\u30b3\u30f3\u30d5\u30a3\u30ae\u30e5\u30ec\u30fc\u30b7\u30e7\u30f3\u30af\u30e9\u30b9\u306b@EnableAuthorizationServer\u3092\u4ed8\u4e0e\u3057\u3066\u3001OAuth\u306e\u8a8d\u8a3c\u30fb\u8a8d\u53ef\u306b\u5fc5\u8981\u306aBean\u5b9a\u7fa9\u3092\u884c\u3044\u3001ResourceServerConfigurerAdapter\u306econfigure(HttpSecurity)\u3092\u30aa\u30fc\u30d0\u30fc\u30e9\u30a4\u30c9\u3057\u3066REST API\u3078\u306e\u8a8d\u53ef\u8a2d\u5b9a\u3092\u884c\u3044\u307e\u3059\u3002\n\nservice-provider/src/main/java/com/example/ResourceServerConfiguration.java\npackage com.example;\n\nimport org.springframework.context.annotation.Configuration;\nimport org.springframework.http.HttpMethod;\nimport org.springframework.security.config.annotation.web.builders.HttpSecurity;\nimport org.springframework.security.config.http.SessionCreationPolicy;\nimport org.springframework.security.oauth2.config.annotation.web.configuration.EnableResourceServer;\nimport org.springframework.security.oauth2.config.annotation.web.configuration.ResourceServerConfigurerAdapter;\n\n@EnableResourceServer\n@Configuration\npublic class ResourceServerConfiguration extends ResourceServerConfigurerAdapter {\n    @Override\n    public void configure(HttpSecurity http) throws Exception {\n        http.antMatcher(\"/api/**\")\n            .authorizeRequests()\n            .antMatchers(HttpMethod.GET, \"/**\").access(\"#oauth2.hasScope('read')\")\n            .antMatchers(HttpMethod.POST, \"/**\").access(\"#oauth2.hasScope('write')\")\n            .antMatchers(HttpMethod.PUT, \"/**\").access(\"#oauth2.hasScope('write')\")\n            .antMatchers(HttpMethod.DELETE, \"/**\").access(\"#oauth2.hasScope('write')\");\n    }\n}\n\n\n\u4e0a\u8a18\u8a2d\u5b9a\u3092\u884c\u3046\u3053\u3068\u3067\u3001/api\u914d\u4e0b\u3078\u306e\u30ea\u30af\u30a8\u30b9\u30c8\u306b\u5bfe\u3057\u3066OAuth\u306e\u8a8d\u8a3c\u30fb\u8a8d\u53ef\u3092\u9069\u7528\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n\u8a8d\u53ef\u30fb\u30ea\u30bd\u30fc\u30b9\u30b5\u30fc\u30d0\u306e\u52d5\u4f5c\u78ba\u8a8d\n\u8a8d\u53ef\u30b5\u30fc\u30d0\u3068\u30ea\u30bd\u30fc\u30b9\u30b5\u30fc\u30d0\u306e\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\u304c\u7d42\u308f\u3063\u305f\u3068\u3053\u308d\u3067\u3001\u30ea\u30bd\u30fc\u30b9\u30b5\u30fc\u30d0\u306b\u30a2\u30af\u30bb\u30b9\u3057\u3066\u307f\u307e\u3057\u3087\u3046\u3002\n$ curl -D - -s http://localhost:18081/provider/api/tasks\nHTTP/1.1 401 \nX-Content-Type-Options: nosniff\nX-XSS-Protection: 1; mode=block\nCache-Control: no-cache, no-store, max-age=0, must-revalidate\nPragma: no-cache\nExpires: 0\nX-Frame-Options: DENY\nCache-Control: no-store\nPragma: no-cache\nWWW-Authenticate: Bearer realm=\"oauth2-resource\", error=\"unauthorized\", error_description=\"Full authentication is required to access this resource\"\nContent-Type: application/json;charset=UTF-8\nTransfer-Encoding: chunked\nDate: Sat, 25 Feb 2017 09:39:55 GMT\n\n{\"error\":\"unauthorized\",\"error_description\":\"Full authentication is required to access this resource\"}\n\n\u306a\u306b\u3084\u3089\u30a8\u30e9\u30fc\u306b\u306a\u308a\u307e\u3057\u305f\u3002\u30a8\u30e9\u30fc\u5185\u5bb9\u3092\u307f\u3066\u307f\u308b\u3068\u30fb\u30fb\u30fb\u8a8d\u8a3c\u30a8\u30e9\u30fc\uff08401 Unauthorized\uff09\u3068\u306a\u308a\u3001OAuth\u306eBearer\u30c8\u30fc\u30af\u30f3\u306b\u3088\u308b\u8a8d\u8a3c\u304c\u5fc5\u8981\u3067\u3042\u308b\u3053\u3068\u304c\u901a\u77e5\u3055\u308c\u3066\u3044\u307e\u3059\u3002\n\n\u30a2\u30af\u30bb\u30b9\u30c8\u30fc\u30af\u30f3\u306e\u53d6\u5f97\n\u672c\u30a8\u30f3\u30c8\u30ea\u30fc\u306f\u300c\u8a8d\u53ef\u30b3\u30fc\u30c9\u30b0\u30e9\u30f3\u30c8\u300d\u3092\u4f7f\u7528\u3057\u3066\u30a2\u30af\u30bb\u30b9\u30c8\u30fc\u30af\u30f3\u3092\u53d6\u5f97\u3057\u3066REST API\u306b\u30a2\u30af\u30bb\u30b9\u3059\u308b\u65b9\u6cd5\u3092\u8aac\u660e\u3059\u308b\u306e\u304c\u6700\u7d42\u7684\u306a\u76ee\u7684\u3067\u3059\u304c\u3001\u307e\u305a\u306f\u30fb\u30fb\u30fb\u304a\u624b\u8efd\u306b\u30a2\u30af\u30bb\u30b9\u30c8\u30fc\u30af\u30f3\u3092\u53d6\u5f97\u3067\u304d\u308b\u300c\u30ea\u30bd\u30fc\u30b9\u30aa\u30fc\u30ca\u30fc\u30d1\u30b9\u30ef\u30fc\u30c9\u30af\u30ec\u30c7\u30f3\u30b7\u30e3\u30eb\u300d\u3092\u4f7f\u7528\u3057\u3066\u30bf\u30b9\u30af\u60c5\u5831\u306b\u30a2\u30af\u30bb\u30b9\u3059\u308b\u305f\u3081\u306e\u30a2\u30af\u30bb\u30b9\u30c8\u30fc\u30af\u30f3\u3092\u53d6\u5f97\u3057\u3066\u307f\u307e\u3057\u3087\u3046\u3002\n$ curl -D - -s -u client:secret http://localhost:18081/provider/oauth/token -X POST -d grant_type=password -d username=user -d password=password\nHTTP/1.1 200 \nX-Content-Type-Options: nosniff\nX-XSS-Protection: 1; mode=block\nCache-Control: no-cache, no-store, max-age=0, must-revalidate\nPragma: no-cache\nExpires: 0\nX-Frame-Options: DENY\nContent-Type: application/json;charset=UTF-8\nTransfer-Encoding: chunked\nDate: Sat, 25 Feb 2017 14:08:39 GMT\n\n{\"access_token\":\"d2fbded0-b8f6-4c2d-bee5-6dd3cafc0097\",\"token_type\":\"bearer\",\"expires_in\":43138,\"scope\":\"read write\"}\n\n\n\u30ea\u30bd\u30fc\u30b9\u30b5\u30fc\u30d0\u3078\u306e\u30a2\u30af\u30bb\u30b9\n\u53d6\u5f97\u3057\u305f\u30a2\u30af\u30bb\u30b9\u30c8\u30fc\u30af\u30f3\u3092\u300cAuthorization\u300d\u30d8\u30c3\u30c0\u306b\u6307\u5b9a\u3057\u3066\u30ea\u30bd\u30fc\u30b9\u30b5\u30fc\u30d0\u3078\u518d\u5ea6\u30a2\u30af\u30bb\u30b9\u3057\u307e\u3057\u3087\u3046\u3002\n$ curl -D - -s http://localhost:18081/provider/api/tasks -H \"Authorization: Bearer d2fbded0-b8f6-4c2d-bee5-6dd3cafc0097\"\nHTTP/1.1 200 \nX-Content-Type-Options: nosniff\nX-XSS-Protection: 1; mode=block\nCache-Control: no-cache, no-store, max-age=0, must-revalidate\nPragma: no-cache\nExpires: 0\nX-Frame-Options: DENY\nContent-Type: application/json;charset=UTF-8\nTransfer-Encoding: chunked\nDate: Sat, 25 Feb 2017 14:11:17 GMT\n\n[]\n\n\u305b\u3063\u304b\u304f\u306a\u306e\u3067\u30fb\u30fb\u30fb\u65b0\u3057\u3044\u30bf\u30b9\u30af\u3092\u4f5c\u6210\u3057\u3001\u4f5c\u6210\u3057\u305f\u30bf\u30b9\u30af\u60c5\u5831\u3092\u53d6\u5f97\u3057\u3066\u307f\u307e\u3057\u3087\u3046\u3002\n$ curl -D - -s http://localhost:18081/provider/api/tasks -H \"Authorization: Bearer d2fbded0-b8f6-4c2d-bee5-6dd3cafc0097\" -H \"Content-Type: application/json\" -X POST -d '{\"title\":\"Test Title\",\"detail\":\"Test Detail\",\"deadline\":\"2017-02-28\"}'\nHTTP/1.1 201 \nX-Content-Type-Options: nosniff\nX-XSS-Protection: 1; mode=block\nCache-Control: no-cache, no-store, max-age=0, must-revalidate\nPragma: no-cache\nExpires: 0\nX-Frame-Options: DENY\nLocation: http://localhost:18081/provider/api/tasks/6\nContent-Length: 0\nDate: Sat, 25 Feb 2017 15:24:40 GMT\n\n\n$ curl -D - -s http://localhost:18081/provider/api/tasks/6 -H \"Authorization: Bearer d2fbded0-b8f6-4c2d-bee5-6dd3cafc0097\"\nHTTP/1.1 200 \nX-Content-Type-Options: nosniff\nX-XSS-Protection: 1; mode=block\nCache-Control: no-cache, no-store, max-age=0, must-revalidate\nPragma: no-cache\nExpires: 0\nX-Frame-Options: DENY\nContent-Type: application/json;charset=UTF-8\nTransfer-Encoding: chunked\nDate: Sat, 25 Feb 2017 15:26:13 GMT\n\n{\"id\":6,\"username\":\"user\",\"title\":\"Test Title\",\"detail\":\"Test Detail\",\"deadline\":\"2017-02-28\",\"finished\":false,\"createdAt\":\"2017-02-26T00:24:40.843\",\"updatedAt\":\"2017-02-26T00:24:40.843\",\"version\":1}\n\n\nClient(Web UI)\u306e\u4f5c\u6210\nService Provider(\u8a8d\u53ef\u30b5\u30fc\u30d0\u3068\u30ea\u30bd\u30fc\u30b9\u30b5\u30fc\u30d0)\u306e\u4f5c\u6210\u304c\u7d42\u308f\u3063\u305f\u306e\u3067\u3001\u30ea\u30bd\u30fc\u30b9\u30b5\u30fc\u30d0\u3067\u7ba1\u7406\u3057\u3066\u3044\u308b\u30bf\u30b9\u30af\u60c5\u5831\u3092\u64cd\u4f5c\u3059\u308b\u305f\u3081\u306eWeb UI\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\nClient\u306e\u30b5\u30fc\u30d0\u8a2d\u5b9a\n\u5192\u982d\u306e\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u69cb\u6210\u3067\u7d39\u4ecb\u3057\u305f\u901a\u308a\u3001Cleint\u306e\u30dd\u30fc\u30c8\u309218080\u306b\u3001\u30b3\u30f3\u30c6\u30ad\u30b9\u30c8\u30d1\u30b9\u3092/client\u306b\u3057\u307e\u3059\u3002\n\nclient/src/main/resources/application.properties\nserver.port=18080\nserver.context-path=/client\n\n\n\u4eca\u56de\u306e\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3067\u306f\u3001Client\u5074\u306e\u30e6\u30fc\u30b6\u8a8d\u8a3c\u306fSpring Boot\u304c\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\u3057\u3066\u304f\u308c\u308bBasic\u8a8d\u8a3c\u3092\u4f7f\u7528\u3057\u307e\u3059\u3002\u30c7\u30d5\u30a9\u30eb\u30c8\u306e\u52d5\u4f5c\u3060\u3068\u8d77\u52d5\u6bce\u306b\u30c7\u30d5\u30a9\u30eb\u30c8\u30e6\u30fc\u30b6\u306e\u30d1\u30b9\u30ef\u30fc\u30c9\u304c\u304b\u308f\u308b\u306e\u3067\u3001\u30d1\u30b9\u30ef\u30fc\u30c9\u3092\u56fa\u5b9a\u5316\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n\nclient/src/main/resources/application.properties\nsecurity.user.password=password\n\n\n\nClient\u306e\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\n\u30b3\u30f3\u30d5\u30a3\u30ae\u30e5\u30ec\u30fc\u30b7\u30e7\u30f3\u30af\u30e9\u30b9\u306b@EnableOAuth2Client\u3092\u4ed8\u4e0e\u3057\u3066\u3001\u30a2\u30af\u30bb\u30b9\u30c8\u30fc\u30af\u30f3\u3092\u7ba1\u7406\u3059\u308b\u30b3\u30f3\u30dd\u30fc\u30cd\u30f3\u30c8(OAuth2ClientContext)\u3084\u30ea\u30bd\u30fc\u30b9\u30aa\u30fc\u30ca\u304b\u3089\u306e\u8a8d\u53ef\u3092\u53d6\u5f97\u3059\u308b\u305f\u3081\u306b\u30e6\u30fc\u30b6\u30a8\u30fc\u30b8\u30a7\u30f3\u30c8(\u30d6\u30e9\u30a6\u30b6\uff09\u3092\u8a8d\u53ef\u30b5\u30fc\u30d0\u3078\u8a98\u5c0e\u3059\u308b\u305f\u3081\u306e\u30b3\u30f3\u30dd\u30fc\u30cd\u30f3\u30c8(OAuth2ClientContextFilter)\u306a\u3069\u3092Bean\u5b9a\u7fa9\u3057\u307e\u3059\u3002\u3055\u3089\u306b\u3001OAuth\u7528\u306b\u62e1\u5f35\u3055\u308c\u305fRestTemplate(OAuth2RestTemplate)\u306eBean\u5b9a\u7fa9\u3092\u884c\u3044\u307e\u3059\u3002OAuth2RestTemplate\u3092\u4f7f\u7528\u3059\u308b\u3068\u3001OAuth\u95a2\u9023\u306e\u51e6\u7406\uff08\u8a8d\u53ef\u30b5\u30fc\u30d0\u304b\u3089\u30a2\u30af\u30bb\u30b9\u30c8\u30fc\u30af\u30f3\u3092\u53d6\u5f97\u3059\u308b\u51e6\u7406\u306a\u3069\uff09\u3092\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u304c\u610f\u8b58\u3059\u308b\u5fc5\u8981\u304c\u306a\u304f\u306a\u308a\u3001OAuth\u306b\u3088\u308b\u8a8d\u8a3c\u30fb\u8a8d\u53ef\u3092\u884c\u308f\u306a\u3044\u6642\u3068\u540c\u3058\u3088\u3046\u306bREST API\u3092\u547c\u3073\u51fa\u3059\u3053\u3068\u304c\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\n\nclient/src/main/java/com/example/ClientConfiguration.java\npackage com.example;\n\nimport org.springframework.context.annotation.Bean;\nimport org.springframework.context.annotation.Configuration;\nimport org.springframework.security.oauth2.client.OAuth2ClientContext;\nimport org.springframework.security.oauth2.client.OAuth2RestTemplate;\nimport org.springframework.security.oauth2.client.resource.OAuth2ProtectedResourceDetails;\nimport org.springframework.security.oauth2.config.annotation.web.configuration.EnableOAuth2Client;\n\n@EnableOAuth2Client\n@Configuration\npublic class ClientConfiguration {\n\n    @Bean\n    OAuth2RestTemplate oauth2RestTemplate(OAuth2ClientContext context, OAuth2ProtectedResourceDetails details) {\n        return new OAuth2RestTemplate(details, context);\n    }\n\n}\n\n\n\u52a0\u3048\u3066\u3001OAuth\u95a2\u9023\uff08API\u306eURL\u3001\u8a8d\u53ef\u30b5\u30fc\u30d0\u306eURL\u3001\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u60c5\u5831\uff09\u306e\u8a2d\u5b9a\u3092\u8ffd\u52a0\u3057\u307e\u3059\u3002\n\nclient/src/main/resources/application.properties\n# API\u306eURL\napi.url=http://localhost:18081/provider/api\n\n# \u8a8d\u53ef\u30b5\u30fc\u30d0\u306e\u30a8\u30f3\u30c9\u30dd\u30a4\u30f3\u30c8\u306eURL\nauth.url=http://localhost:18081/provider/oauth\nsecurity.oauth2.client.access-token-uri=${auth.url}/token\nsecurity.oauth2.client.user-authorization-uri=${auth.url}/authorize\n\n# \u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u60c5\u5831\u306e\u8a2d\u5b9a\nsecurity.oauth2.client.client-id=client\nsecurity.oauth2.client.client-secret=secret\nsecurity.oauth2.client.scope=read,write\n\n\n\nNote:\nSpring Boot\u306eAutoConfigure\u306e\u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u306f\u3001\u300c\u8a8d\u53ef\u30b3\u30fc\u30c9\u30b0\u30e9\u30f3\u30c8\u30d5\u30ed\u30fc\u300d\u3092\u4f7f\u7528\u3057\u3066\u30ea\u30bd\u30fc\u30b9\u30b5\u30fc\u30d0\u3078\u30a2\u30af\u30bb\u30b9\u3059\u308b\u3088\u3046\u306bBean\u5b9a\u7fa9\u3055\u308c\u307e\u3059\u3002\n\n\n\u30c9\u30e1\u30a4\u30f3\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306e\u4f5c\u6210\nREST API\u3092\u4ecb\u3057\u3066\u64cd\u4f5c\u3059\u308b\u30bf\u30b9\u30af\u60c5\u5831\u3092\u4fdd\u6301\u3059\u308b\u30c9\u30e1\u30a4\u30f3\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\uff08Service Provider\u3092\u4f5c\u6210\u3057\u305f\u6642\u306b\u4f5c\u6210\u3057\u305fTask\u30af\u30e9\u30b9\u3092Client\u5074\u306b\u30b3\u30d4\u30fc\u3057\u3066\u304f\u3060\u3055\u3044\uff09\n\nclient/src/main/java/com/example/Task.java\npackage com.example;\n\nimport java.time.LocalDate;\nimport java.time.LocalDateTime;\n\npublic class Task {\n\n    private long id;\n    private String username;\n    private String title;\n    private String detail;\n    private LocalDate deadline;\n    private boolean finished;\n    private LocalDateTime createdAt;\n    private LocalDateTime updatedAt;\n    private long version;\n\n    // getter/setter\n\n}\n\n\n\nRepository\u306e\u4f5c\u6210\n\u30bf\u30b9\u30af\u60c5\u5831\u3092\u4fdd\u6301\u3059\u308b\u30c9\u30e1\u30a4\u30f3\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306eRepository\u30af\u30e9\u30b9\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\u3053\u306e\u30af\u30e9\u30b9\u3067\u306f\u3001Spring Security OAuth\u304c\u63d0\u4f9b\u3057\u3066\u3044\u308bRestOperations\u30a4\u30f3\u30bf\u30d5\u30a7\u30fc\u30b9\u306e\u5b9f\u88c5\u30af\u30e9\u30b9(OAuth2RestTemplate)\u306e\u30e1\u30bd\u30c3\u30c9\u3092\u4f7f\u7528\u3057\u3066\u3001\u30ea\u30bd\u30fc\u30b9\u30b5\u30fc\u30d0\u4e0a\u3067\u7ba1\u7406\u3057\u3066\u3044\u308b\u30bf\u30b9\u30af\u60c5\u5831\u306b\u30a2\u30af\u30bb\u30b9\u3057\u307e\u3059\u3002\n\nclient/src/main/java/com/example/TaskRepository.java\npackage com.example;\n\nimport java.util.Arrays;\nimport java.util.List;\n\nimport org.springframework.beans.factory.annotation.Value;\nimport org.springframework.stereotype.Repository;\nimport org.springframework.web.client.RestOperations;\n\n@Repository\npublic class TaskRepository {\n\n    private final RestOperations restOperations;\n    private final String resourcesUrl;\n    private final String resourceUrlTemplate;\n\n    TaskRepository(RestOperations restOperations,\n            @Value(\"${api.url}/tasks\") String resourcesUrl) {\n        this.restOperations = restOperations;\n        this.resourcesUrl = resourcesUrl;\n        this.resourceUrlTemplate = resourcesUrl + \"/{id}\";\n    }\n\n    public List<Task> findAll() {\n        return Arrays.asList(restOperations.getForObject(resourcesUrl, Task[].class));\n    }\n\n    public Task findOne(long id) {\n        return restOperations.getForObject(resourceUrlTemplate, Task.class, id);\n    }\n\n    public void save(Task task) {\n        if (task.getId() == null) {\n            restOperations.postForLocation(resourcesUrl, task);\n        } else {\n            restOperations.put(resourceUrlTemplate, task, task.getId());\n        }\n    }\n\n    public void remove(long id) {\n        restOperations.delete(resourceUrlTemplate, id);\n    }\n\n}\n\n\n\nController\u306e\u4f5c\u6210\n\u30bf\u30b9\u30af\u60c5\u5831\u306eCRUD\u64cd\u4f5c\u3092\u884c\u3046\u305f\u3081\u306eWeb UI\u3092\u63d0\u4f9b\u3059\u308bController\u30af\u30e9\u30b9\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\nclient/src/main/java/com/example/TaskController.java\npackage com.example;\n\nimport java.time.LocalDate;\nimport java.time.LocalDateTime;\nimport java.util.List;\n\nimport org.hibernate.validator.constraints.NotEmpty;\nimport org.springframework.beans.BeanUtils;\nimport org.springframework.format.annotation.DateTimeFormat;\nimport org.springframework.stereotype.Controller;\nimport org.springframework.ui.Model;\nimport org.springframework.validation.BindingResult;\nimport org.springframework.validation.annotation.Validated;\nimport org.springframework.web.bind.annotation.GetMapping;\nimport org.springframework.web.bind.annotation.ModelAttribute;\nimport org.springframework.web.bind.annotation.PathVariable;\nimport org.springframework.web.bind.annotation.PostMapping;\nimport org.springframework.web.bind.annotation.RequestMapping;\nimport org.springframework.web.servlet.mvc.support.RedirectAttributes;\n\n@RequestMapping(\"/tasks\")\n@Controller\npublic class TaskController {\n\n    private final TaskRepository repository;\n\n    TaskController(TaskRepository repository) {\n        this.repository = repository;\n    }\n\n    @ModelAttribute\n    TaskForm setUpForm() {\n        return new TaskForm();\n    }\n\n    @GetMapping\n    String list(Model model) {\n        List<Task> taskList = repository.findAll();\n        model.addAttribute(taskList);\n        return \"task/list\";\n    }\n\n    @PostMapping\n    String create(@Validated TaskForm form, BindingResult bindingResult, Model model) {\n        if (bindingResult.hasErrors()) {\n            return list(model);\n        }\n        Task task = new Task();\n        BeanUtils.copyProperties(form, task);\n        repository.save(task);\n        return \"redirect:/tasks\";\n    }\n\n    @GetMapping(\"{id}\")\n    String detail(@PathVariable long id, TaskForm form, Model model) {\n        Task task = repository.findOne(id);\n        BeanUtils.copyProperties(task, form);\n        model.addAttribute(task);\n        return \"task/detail\";\n    }\n\n    @PostMapping(path = \"{id}\", params = \"update\")\n    String update(@PathVariable long id, @Validated TaskForm form, BindingResult bindingResult,\n            Model model, RedirectAttributes redirectAttributes) {\n        if (bindingResult.hasErrors()) {\n            return \"task/detail\";\n        }\n        Task task = new Task();\n        BeanUtils.copyProperties(form, task);\n        repository.save(task);\n        redirectAttributes.addAttribute(\"id\", id);\n        return \"redirect:/tasks/{id}\";\n    }\n\n    @PostMapping(path = \"{id}\", params = \"delete\")\n    String delete(@PathVariable long id) {\n        repository.remove(id);\n        return \"redirect:/tasks\";\n    }\n\n    static class TaskForm {\n        private static final String DATE_TIME_FORMAT = \"uuuu-MM-dd HH:mm:ss\";\n\n        private Long id;\n        @NotEmpty private String title;\n        private String detail;\n        @DateTimeFormat(iso = DateTimeFormat.ISO.DATE) private LocalDate deadline;\n        private boolean finished;\n        @DateTimeFormat(pattern = DATE_TIME_FORMAT) private LocalDateTime createdAt;\n        @DateTimeFormat(pattern = DATE_TIME_FORMAT) private LocalDateTime updatedAt;\n        private long version;\n\n        public Long getId() {\n            return id;\n        }\n\n        public void setId(Long id) {\n            this.id = id;\n        }\n\n        public String getTitle() {\n            return title;\n        }\n\n        public void setTitle(String title) {\n            this.title = title;\n        }\n\n        public String getDetail() {\n            return detail;\n        }\n\n        public void setDetail(String detail) {\n            this.detail = detail;\n        }\n\n        public LocalDate getDeadline() {\n            return deadline;\n        }\n\n        public void setDeadline(LocalDate deadline) {\n            this.deadline = deadline;\n        }\n\n        public boolean isFinished() {\n            return finished;\n        }\n\n        public void setFinished(boolean finished) {\n            this.finished = finished;\n        }\n\n        public LocalDateTime getCreatedAt() {\n            return createdAt;\n        }\n\n        public void setCreatedAt(LocalDateTime createdAt) {\n            this.createdAt = createdAt;\n        }\n\n        public LocalDateTime getUpdatedAt() {\n            return updatedAt;\n        }\n\n        public void setUpdatedAt(LocalDateTime updatedAt) {\n            this.updatedAt = updatedAt;\n        }\n\n        public long getVersion() {\n            return version;\n        }\n\n        public void setVersion(long version) {\n            this.version = version;\n        }\n    }\n\n}\n\n\n\nNote:\n\u767b\u9332\u65e5\u6642(createdAt)\u3084\u66f4\u65b0\u65e5\u6642(updatedAt)\u306f\u5165\u529b\u9805\u76ee\u3067\u306f\u306a\u3044\u306e\u3067\u30d5\u30a9\u30fc\u30e0\u306e\u9805\u76ee\u3068\u3057\u3066\u4fdd\u6301\u3059\u3079\u304d\u3067\u306f\u3042\u308a\u307e\u305b\u3093\u304c\u3001\u5165\u529b\u30c1\u30a7\u30c3\u30af\u30a8\u30e9\u30fc\u304c\u51fa\u308b\u305f\u3073\u306b\u30ea\u30bd\u30fc\u30b9\u30b5\u30fc\u30d0\u304b\u3089\u30bf\u30b9\u30af\u60c5\u5831\u3092\u53d6\u5f97\u3059\u308b\u306e\u3082\u5fae\u5999\u306a\u306e\u3067\u3001\u3061\u3087\u3063\u3068\u4e71\u66b4\u3067\u3059\u304c\u4eca\u56de\u306f\u30d5\u30a9\u30fc\u30e0\u306e\u9805\u76ee\u306b\u542b\u3081\u3066\u3057\u307e\u3044\u307e\u3059\u3002\n\n\n\u30bf\u30b9\u30af\u4e00\u89a7\u753b\u9762\u306e\u4f5c\u6210\n\u30ea\u30bd\u30fc\u30b9\u30b5\u30fc\u30d0\u304b\u3089\u53d6\u5f97\u3057\u305f\u30bf\u30b9\u30af\u4e00\u89a7\u3092\u8868\u793a\u3057\u3001\u65b0\u3057\u3044\u30bf\u30b9\u30af\u60c5\u5831\u3092\u4f5c\u6210\u3059\u308b\u305f\u3081\u306eWeb UI\u3092\u63d0\u4f9b\u3057\u307e\u3059\u3002\n\nclient/src/main/resources/templates/task/list.html\n<!DOCTYPE html>\n<html xmlns=\"http://www.w3.org/1999/xhtml\"\n      xmlns:th=\"http://www.thymeleaf.org\">\n<head>\n    <meta http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-8\"/>\n    <title>Task List</title>\n    <link rel=\"stylesheet\" href=\"https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.css\" type=\"text/css\"\n          th:href=\"@{/webjars/bootstrap/css/bootstrap.css}\"/>\n    <style type=\"text/css\">\n        .strike {\n            text-decoration: line-through;\n        }\n    </style>\n</head>\n<body>\n\n<div class=\"container\">\n\n    <h1>Task List</h1>\n\n    <div id=\"taskForm\">\n        <form action=\"list.html\" method=\"post\" class=\"form-horizontal\"\n              th:action=\"@{/tasks}\" th:object=\"${taskForm}\">\n            <div class=\"form-group\">\n                <label for=\"title\" class=\"col-sm-1 control-label\">Title</label>\n                <div class=\"col-sm-10\">\n                    <input type=\"text\" class=\"form-control\" id=\"title\" th:field=\"*{title}\"/>\n                    <span class=\"text-error\" th:errors=\"*{title}\">error message</span>\n                </div>\n            </div>\n            <div class=\"form-group\">\n                <label for=\"detail\" class=\"col-sm-1 control-label\">Detail</label>\n                <div class=\"col-sm-10\">\n                    <textarea class=\"form-control\" id=\"detail\" th:field=\"*{detail}\">\n                    </textarea>\n                    <span class=\"text-error\" th:errors=\"*{detail}\">error message</span>\n                </div>\n            </div>\n            <div class=\"form-group\">\n                <label for=\"detail\" class=\"col-sm-1 control-label\">Deadline</label>\n                <div class=\"col-sm-4\">\n                    <input type=\"date\" class=\"form-control\" id=\"detail\" th:field=\"*{deadline}\"/>\n                    <span class=\"text-error\" th:errors=\"*{deadline}\">error message</span>\n                </div>\n            </div>\n            <div class=\"form-group\">\n                <div class=\"col-sm-offset-1 col-sm-10\">\n                    <button type=\"submit\" class=\"btn btn-default\">Create</button>\n                </div>\n            </div>\n        </form>\n    </div>\n\n    <table id=\"todoList\" class=\"table table-hover\" th:if=\"${not #lists.isEmpty(taskList)}\">\n\n        <tr>\n            <th>#</th>\n            <th>Title</th>\n            <th>Deadline</th>\n            <th>Created Datetime</th>\n        </tr>\n\n        <tr th:each=\"task : ${taskList}\">\n            <td th:text=\"${taskStat.count}\">1</td>\n            <td>\n                <span th:class=\"${task.finished} ? 'strike'\">\n                    <a href=\"detail.html\"\n                       th:text=\"${task.title}\" th:href=\"@{/tasks/{id}(id=${task.id})}\">\n                        Create Sample Application\n                    </a>\n                </span>\n            </td>\n            <td>\n                <span th:text=\"${#temporals.format(task.deadline,'uuuu-MM-dd')}\" th:if=\"${task.deadline != null}\">2017-02-28</span>\n            </td>\n            <td>\n                <span th:text=\"${#temporals.format(task.createdAt,'uuuu-MM-dd HH:mm.ss')}\">2017-02-27 15:17:02</span>\n            </td>\n        </tr>\n\n    </table>\n\n</div>\n</body>\n</html>\n\n\n\n\u30bf\u30b9\u30af\u8a73\u7d30\u753b\u9762\u306e\u4f5c\u6210\n\u30ea\u30bd\u30fc\u30b9\u30b5\u30fc\u30d0\u304b\u3089\u53d6\u5f97\u3057\u305f\u30bf\u30b9\u30af\u60c5\u5831\u3092\u8868\u793a\u3057\u3001\u66f4\u65b0\u53ca\u3073\u524a\u9664\u3059\u308b\u305f\u3081\u306eWeb UI\u3092\u63d0\u4f9b\u3057\u307e\u3059\u3002\n\nclient/src/main/resources/templates/task/detail.html\n<!DOCTYPE html>\n<html xmlns=\"http://www.w3.org/1999/xhtml\"\n      xmlns:th=\"http://www.thymeleaf.org\">\n<head>\n    <meta http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-8\"/>\n    <title>Task Detail</title>\n    <link rel=\"stylesheet\" href=\"https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.css\" type=\"text/css\"\n          th:href=\"@{/webjars/bootstrap/css/bootstrap.css}\"/>\n</head>\n<body>\n\n<div class=\"container\">\n\n    <h1>Task Detail</h1>\n\n    <div id=\"taskForm\">\n        <form action=\"detail.html\" method=\"post\" class=\"form-horizontal\"\n              th:action=\"@{/tasks/{id}(id=*{id})}\" th:object=\"${taskForm}\">\n            <div class=\"form-group\">\n                <label for=\"title\" class=\"col-sm-2 control-label\">Title</label>\n                <div class=\"col-sm-10\">\n                    <input class=\"form-control\" id=\"title\" value=\"Create Sample Application\" th:field=\"*{title}\"/>\n                    <span class=\"text-error\" th:errors=\"*{title}\">error message</span>\n                </div>\n            </div>\n            <div class=\"form-group\">\n                <label for=\"detail\" class=\"col-sm-2 control-label\">Detail</label>\n                <div class=\"col-sm-10\">\n                    <textarea class=\"form-control\" id=\"detail\" th:field=\"*{detail}\">\n                    </textarea>\n                    <span class=\"text-error\" th:errors=\"*{detail}\">error message</span>\n                </div>\n            </div>\n            <div class=\"form-group\">\n                <label for=\"detail\" class=\"col-sm-2 control-label\">Deadline</label>\n                <div class=\"col-sm-4\">\n                    <input type=\"date\" class=\"form-control\" id=\"detail\" value=\"2017-03-10\" th:field=\"*{deadline}\"/>\n                    <span class=\"text-error\" th:errors=\"*{deadline}\">error message</span>\n                </div>\n            </div>\n            <div class=\"form-group\">\n                <label for=\"finished\" class=\"col-sm-2 control-label\">Finished ?</label>\n                <div class=\"col-sm-2\">\n                    <input type=\"checkbox\" id=\"finished\" th:field=\"*{finished}\"/>\n                </div>\n            </div>\n            <div class=\"form-group\">\n                <label for=\"createdAt\" class=\"col-sm-2 control-label\">Created Datetime</label>\n                <div class=\"col-sm-4\">\n                    <input id=\"createdAt\" class=\"form-control\" value=\"2017-02-28 15:00:01\" th:field=\"*{createdAt}\" readonly=\"readonly\"/>\n                </div>\n            </div>\n            <div class=\"form-group\">\n                <label for=\"updatedAt\" class=\"col-sm-2 control-label\">Updated Datetime</label>\n                <div class=\"col-sm-4\">\n                    <input id=\"updatedAt\" class=\"form-control\" value=\"2017-02-28 15:00:01\" th:field=\"*{updatedAt}\" readonly=\"readonly\"/>\n                </div>\n            </div>\n            <div class=\"form-group\">\n                <div class=\"col-sm-offset-2 col-sm-10\">\n                    <input type=\"hidden\" th:field=\"*{version}\"/>\n                    <button type=\"submit\" class=\"btn btn-default\" name=\"update\">Update</button>\n                    <button type=\"submit\" class=\"btn btn-default\" name=\"delete\">Delete</button>\n                </div>\n            </div>\n        </form>\n    </div>\n\n    <hr/>\n\n    <a href=\"list.html\" class=\"btn btn-default\" th:href=\"@{/tasks}\">Task List</a>\n\n</div>\n</body>\n</html>\n\n\n\n\u8a8d\u53ef\u30b3\u30fc\u30c9\u30b0\u30e9\u30f3\u30c8\u30d5\u30ed\u30fc\u3092\u4f53\u611f\u3059\u308b\nService Provider\u3068Client\u306e\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u4f5c\u6210\u304c\u7d42\u308f\u3063\u305f\u306e\u3067\u3001\u5b9f\u969b\u306b\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u4f7f\u3063\u3066\u8a8d\u53ef\u30b3\u30fc\u30c9\u30b0\u30e9\u30f3\u30c8\u30d5\u30ed\u30fc\u3092\u4f53\u611f\u3057\u3066\u307f\u307e\u3057\u3087\u3046\uff01\uff01\n\n\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u8d77\u52d5\n\u307e\u305a\u3001Service Provider\u3068Client\u306e\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u8d77\u52d5\u3057\u307e\u3059\u3002\n$ ./mvnw -pl service-provider spring-boot:run\n...\n2017-02-27 00:29:12.820  INFO 78931 --- [           main] o.s.j.e.a.AnnotationMBeanExporter        : Registering beans for JMX exposure on startup\n2017-02-27 00:29:12.867  INFO 78931 --- [           main] s.b.c.e.t.TomcatEmbeddedServletContainer : Tomcat started on port(s): 18081 (http)\n2017-02-27 00:29:12.872  INFO 78931 --- [           main] com.example.ServiceProviderApplication   : Started ServiceProviderApplication in 3.247 seconds (JVM running for 5.825)\n\n$ ./mvnw -pl client spring-boot:run\n...\n2017-02-27 00:29:49.282  INFO 78940 --- [           main] o.s.j.e.a.AnnotationMBeanExporter        : Registering beans for JMX exposure on startup\n2017-02-27 00:29:49.337  INFO 78940 --- [           main] s.b.c.e.t.TomcatEmbeddedServletContainer : Tomcat started on port(s): 18080 (http)\n2017-02-27 00:29:49.344  INFO 78940 --- [           main] com.example.ClientApplication            : Started ClientApplication in 3.033 seconds (JVM running for 6.17)\n\n\n\u30bf\u30b9\u30af\u4e00\u89a7\u753b\u9762\u306e\u8868\u793a\n\u30d6\u30e9\u30a6\u30b6\u306e\u30a2\u30c9\u30ec\u30b9\u30d0\u30fc\u306b http://localhost:18080/client/tasks \u3092\u5165\u529b\u3057\u3066\u3001\u30bf\u30b9\u30af\u4e00\u89a7\u753b\u9762\u3092\u8868\u793a\u3057\u3066\u307f\u307e\u3057\u3087\u3046\u3002\n\u521d\u56de\u30a2\u30af\u30bb\u30b9\u6642\u306f\u3001\u307e\u305aClient\u5074\u306e\u30e6\u30fc\u30b6\u8a8d\u8a3c(Basic\u8a8d\u8a3c)\u304c\u6c42\u3081\u3089\u308c\u308b\u306e\u3067\u3001\u30c0\u30a4\u30a2\u30ed\u30b0\u306b\u30e6\u30fc\u30b6\u540d(user)\u3068\u30d1\u30b9\u30ef\u30fc\u30c9(password)\u3092\u5165\u529b\u3057\u3066\u300c\u30ed\u30b0\u30a4\u30f3\u300d\u30dc\u30bf\u30f3\u3092\u62bc\u4e0b\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\nClient\u5074\u306e\u30e6\u30fc\u30b6\u8a8d\u8a3c\u304c\u6210\u529f\u3059\u308b\u3068\u3001\u30ea\u30bd\u30fc\u30b9\u30aa\u30fc\u30ca\u304b\u3089\u306e\u8a8d\u53ef\u30b0\u30e9\u30f3\u30c8(\u8a8d\u53ef\u30b3\u30fc\u30c9)\u3092\u5f97\u308b\u305f\u3081\u306bService Provider\u304b\u3089\u63d0\u4f9b\u3055\u308c\u3066\u3044\u308b\u8a8d\u53ef\u30a8\u30f3\u30c9\u30dd\u30a4\u30f3\u30c8(/oauth/authorize)\u306b\u30ea\u30c0\u30a4\u30ec\u30af\u30c8\u3055\u308c\u307e\u3059\u3002\u521d\u56de\u30a2\u30af\u30bb\u30b9\u6642\u306f\u3001Service Provider\u5074\u3067\u306e\u30ea\u30bd\u30fc\u30b9\u30aa\u30fc\u30ca\u306e\u8a8d\u8a3c(Basic\u8a8d\u8a3c)\u304c\u6c42\u3081\u3089\u308c\u308b\u306e\u3067\u3001\u30c0\u30a4\u30a2\u30ed\u30b0\u306b\u30e6\u30fc\u30b6\u540d(user)\u3068\u30d1\u30b9\u30ef\u30fc\u30c9(password)\u3092\u5165\u529b\u3057\u3066\u300c\u30ed\u30b0\u30a4\u30f3\u300d\u30dc\u30bf\u30f3\u3092\u62bc\u4e0b\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\nService Provider\u5074\u306e\u30ea\u30bd\u30fc\u30b9\u30aa\u30fc\u30ca\u306e\u8a8d\u8a3c\u304c\u6210\u529f\u3059\u308b\u3068\u3001Client\u304c\u8981\u6c42\u3057\u305f\u30b9\u30b3\u30fc\u30d7\u306b\u5bfe\u3057\u3066\u30ea\u30bd\u30fc\u30b9\u30aa\u30fc\u30ca\u306e\u8a8d\u53ef\u3092\u5f97\u308b\u305f\u3081\u306e\u753b\u9762\uff08\u8a8d\u53ef\u753b\u9762\uff09\u304c\u8868\u793a\u3055\u308c\u308b\u306e\u3067\u3001\u30b9\u30b3\u30fc\u30d7\u6bce\u306b\u8a31\u53ef\u30fb\u62d2\u5426\u3092\u9078\u629e\u3057\u3066\u300cAuthorize\u300d\u30dc\u30bf\u30f3\u3092\u62bc\u4e0b\u3057\u3066\u304f\u3060\u3055\u3044\u3002\uff08\u3053\u3053\u3067\u306f\u3001\u5168\u3066\u306e\u30b9\u30b3\u30fc\u30d7\u3092\u8a31\u53ef\u3057\u3066\u304f\u3060\u3055\u3044\uff09\n\n\nNote:\n\u672c\u30a8\u30f3\u30c8\u30ea\u30fc\u3067\u306f\u3001Spring Security OAuth\u304c\u63d0\u4f9b\u3057\u3066\u3044\u308b\u8a8d\u53ef\u753b\u9762\u3092\u4f7f\u7528\u3057\u3066\u3044\u307e\u3059\u304c\u3001\u5b9f\u969b\u306e\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u958b\u767a\u3067\u306f\u30ab\u30b9\u30bf\u30de\u30a4\u30ba\u3059\u308b\u306e\u304c\u4e00\u822c\u7684\u3060\u3068\u601d\u3046\u306e\u3067\u3001\u6b21\u56de\u4ee5\u964d\u3067\u30ab\u30b9\u30bf\u30de\u30a4\u30ba\u65b9\u6cd5\u3092\u7d39\u4ecb\u3057\u305f\u3044\u3068\u601d\u3044\u307e\u3059\u3002\n\n\u30ea\u30bd\u30fc\u30b9\u30aa\u30fc\u30ca\u304b\u3089\u306e\u8a8d\u53ef\u304c\u7d42\u308f\u308b\u3068\u3001\u30bf\u30b9\u30af\u4e00\u89a7\u753b\u9762\u304c\u8868\u793a\u3055\u308c\u307e\u3059 \n\n\n\u30bf\u30b9\u30af\u306e\u767b\u9332\n\u3068\u306f\u3044\u3048\u30fb\u30fb\u30fb\u30bf\u30b9\u30af\u304c\u672a\u767b\u9332\u306e\u305f\u3081\u3061\u3083\u3093\u3068\u30ea\u30bd\u30fc\u30b9\u30b5\u30fc\u30d0\u304b\u3089\u30bf\u30b9\u30af\u60c5\u5831\u304c\u53d6\u5f97\u3067\u304d\u3066\u3044\u308b\u306e\u304b\u308f\u304b\u3089\u306a\u3044\u30fb\u30fb\u30fb\u3067\u3059\u306d \n\u306a\u306e\u3067\u30fb\u30fb\u30fb\u6b21\u306bWeb UI\u3092\u4f7f\u3063\u3066\u30bf\u30b9\u30af\u3092\u767b\u9332\u3057\u3066\u307f\u307e\u3057\u3087\u3046\u3002\u30bf\u30b9\u30af\u4e00\u89a7\u753b\u9762\u5185\u306e\u5165\u529b\u30d5\u30a9\u30fc\u30e0\u306b\u30bf\u30b9\u30af\u60c5\u5831\u3092\u5165\u529b\u3057\u3066\u300cCreate\u300d\u30dc\u30bf\u30f3\u3092\u62bc\u4e0b\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n\n\n\u30bf\u30b9\u30af\u8a73\u7d30\u753b\u9762\u306e\u8868\u793a\n\u30bf\u30b9\u30af\u4e00\u89a7\u306b\u306f\u30bf\u30a4\u30c8\u30eb\u3001\u671f\u9650\u65e5\u3001\u4f5c\u6210\u65e5\u6642\u4ee5\u5916\u8868\u793a\u3057\u3066\u3044\u306a\u3044\u306e\u3067\u3001\u30bf\u30b9\u30af\u8a73\u7d30\u753b\u9762\u3092\u8868\u793a\u3057\u3066\u30bf\u30b9\u30af\u306e\u8a73\u7d30\u60c5\u5831\u3092\u78ba\u8a8d\u3057\u307e\u3057\u3087\u3046\u3002\u30bf\u30b9\u30af\u4e00\u89a7\u306e\u30bf\u30a4\u30c8\u30eb\u304c\u30ea\u30f3\u30af\u306b\u306a\u3063\u3066\u3044\u308b\u306e\u3067\u3001\u8868\u793a\u3057\u305f\u3044\u30bf\u30b9\u30af\u306e\u30bf\u30a4\u30c8\u30eb(\u30ea\u30f3\u30af)\u3092\u62bc\u4e0b\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n\n\u30bf\u30b9\u30af\u306e\u66f4\u65b0\u30fb\u524a\u9664\n\u30bf\u30b9\u30af\u3092\u66f4\u65b0\u307e\u305f\u306f\u524a\u9664\u3059\u308b\u5834\u5408\u306f\u3001\u30bf\u30b9\u30af\u8a73\u7d30\u753b\u9762\u306e\u300cUpdate\u300d\u307e\u305f\u306f\u300cDelete\u300d\u30dc\u30bf\u30f3\u3092\u62bc\u4e0b\u3057\u3066\u304f\u3060\u3055\u3044\u3002\u3053\u3053\u3067\u306f\u3001\u671f\u9650\u65e5\u3092\u300c2017/03/15\u300d\u306b\u66f4\u65b0\u3057\u3066\u3044\u307e\u3059\u3002\uff08\u306a\u304a\u3001\u524a\u9664\u306f\u5272\u611b\u3057\u307e\u3059\uff09\n\n\n\nwrite\u30b9\u30b3\u30fc\u30d7(\u4e00\u90e8\u306e\u30b9\u30b3\u30fc\u30d7)\u3092\u62d2\u5426\u3057\u3066\u307f\u308b\n\u30a2\u30af\u30bb\u30b9\u30c8\u30fc\u30af\u30f3\u3068\u8a8d\u53ef\u60c5\u5831\u3092\u7834\u68c4\u3059\u308b\u305f\u3081\u306b\u3001Service Provider\u3092\u518d\u8d77\u52d5\uff08\"Ctrl+C\" + \"./mvnw spring-boot:run\"\uff09\u3057\u3001\u518d\u5ea6\u30bf\u30b9\u30af\u4e00\u89a7\u753b\u9762\u3092\u8868\u793a\u3057\u307e\u3059\u3002\u3059\u308b\u3068\u30fb\u30fb\u30fbService Provider\u306e\u8a8d\u53ef\u753b\u9762\u304c\u8868\u793a\u3055\u308c\u308b\u306e\u3067\u3001write\u30b9\u30b3\u30fc\u30d7\u306e\u30a2\u30af\u30bb\u30b9\u3092\u62d2\u5426\u3057\u307e\u3059\u3002\n\n\u30bf\u30b9\u30af\u4e00\u89a7\u753b\u9762\u3067\u65b0\u3057\u3044\u30bf\u30b9\u30af\u3092\u4f5c\u6210\u3057\u3088\u3046\u3068\u3059\u308b\u3068\u30fb\u30fb\u30fb\u300cInsufficient scope for this resource\u300d\u3068\u3044\u3046\u30a8\u30e9\u30fc\u30e1\u30c3\u30bb\u30fc\u30b8\u304c\u8868\u793a\u3055\u308c\u3001\u300c\u30bf\u30b9\u30af\u4f5c\u6210API\u300d\u306e\u547c\u3073\u51fa\u3057\u304c\u62d2\u5426\u3055\u308c\u307e\u3057\u305f\u3002\n\n\n\u5168\u30b9\u30b3\u30fc\u30d7\u3092\u62d2\u5426\u3057\u3066\u307f\u308b\n\u30a2\u30af\u30bb\u30b9\u30c8\u30fc\u30af\u30f3\u3068\u8a8d\u53ef\u60c5\u5831\u3092\u7834\u68c4\u3059\u308b\u305f\u3081\u306b\u3001Service Provider\u3092\u518d\u8d77\u52d5\uff08\"Ctrl+C\" + \"./mvnw spring-boot:run\"\uff09\u3057\u3001\u518d\u5ea6\u30bf\u30b9\u30af\u4e00\u89a7\u753b\u9762\u3092\u8868\u793a\u3057\u307e\u3059\u3002\u3059\u308b\u3068\u30fb\u30fb\u30fbService Provider\u306e\u8a8d\u53ef\u753b\u9762\u304c\u8868\u793a\u3055\u308c\u308b\u306e\u3067\u3001\u5168\u30b9\u30b3\u30fc\u30d7\u306e\u30a2\u30af\u30bb\u30b9\u3092\u62d2\u5426\u3057\u307e\u3059\u3002\u3059\u308b\u3068\u30fb\u30fb\u30fb\u300c\u8a8d\u53ef\u30b3\u30fc\u30c9\u300d\u306e\u4ee3\u308f\u308a\u306b\u3001\u30ea\u30bd\u30fc\u30b9\u30aa\u30fc\u30ca\u304c\u30a2\u30af\u30bb\u30b9\u3092\u62d2\u5426\u3057\u305f\u3053\u3068\u3092\u901a\u77e5\u3059\u308b\u30d1\u30e9\u30e1\u30fc\u30bf\u3092\u4ed8\u4e0e\u3057\u3066Client\u5074\u306e\u30da\u30fc\u30b8\u306b\u30ea\u30c0\u30a4\u30ec\u30af\u30c8\u3057\u307e\u3059\u3002\n\n\n[\u8d85\u91cd\u8981] REST API\u306e\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u4e0a\u306e\u554f\u984c\u70b9\u3092\u306a\u304f\u305d\u3046\uff01\uff01\n\n\u5b9f\u306f\u3053\u3053\u307e\u3067\u3067\u4f5c\u6210\u3057\u3066\u304d\u305f\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3(REST API)\u306b\u306f\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u4e0a\u306e\u91cd\u5927\u306a\u554f\u984c\u70b9\u304c\u5b58\u5728\u3059\u308b\u306e\u3067\u3059\u304c\u3001\u4f55\u304c\u554f\u984c\u306a\u306e\u304b\u308f\u304b\u308a\u307e\u3059\u304b\uff1f \u305d\u308c\u306f\u30fb\u30fb\u30fb\u306a\u3093\u3068\u30fb\u30fb\u30fb\u4ed6\u4eba\u306e\u30bf\u30b9\u30af\u60c5\u5831\u3092\u53c2\u7167\u30fb\u66f4\u65b0\u3067\u304d\u3066\u3057\u307e\u3046\u306e\u3067\u3059   \n\u3053\u306e\u554f\u984c\u3092\u89e3\u6c7a\u3059\u308b\u65b9\u6cd5\u3068\u3057\u3066\u306f\u3001\u4ee5\u4e0b\u306e\uff12\u3064\u304c\u8003\u3048\u3089\u308c\u307e\u3059\u3002\n\n\u30bf\u30b9\u30af\u60c5\u5831\u306b\u30a2\u30af\u30bb\u30b9\u3059\u308b\u969b\u306e\u6761\u4ef6(SQL\u306e\u6761\u4ef6)\u306b\u30e6\u30fc\u30b6\u540d\u3092\u52a0\u3048\u308b\n\u30bf\u30b9\u30af\u60c5\u5831\u306e\u6240\u6709\u8005\u3068\u8a8d\u8a3c\u60c5\u5831\u306e\u30e6\u30fc\u30b6\u304c\u4e00\u81f4\u3059\u308b\u304b\u30c1\u30a7\u30c3\u30af\u3059\u308b\n\n\u3069\u3061\u3089\u306e\u65b9\u6cd5\u3092\u63a1\u7528\u3059\u308b\u304b\u306f\u3001\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u8981\u4ef6\u6b21\u7b2c\u3067\u3057\u3087\u3046\u3002\u524d\u8005\u306f\u5b58\u5728\u3057\u306a\u3044\u30bf\u30b9\u30af\u306b\u5bfe\u3057\u3066\u64cd\u4f5c\u3057\u305f\u6642\u3068\u540c\u3058\u632f\u308b\u821e\u3044(404 Not Found)\u306b\u306a\u308b\u306e\u306b\u5bfe\u3057\u3066\u3001\u5f8c\u8005\u306f\u30a2\u30af\u30bb\u30b9\u62d2\u5426(403 Forbidden)\u306b\u306a\u308b\u305f\u3081\u3001\u4e0d\u6b63\u306a\u30a2\u30af\u30bb\u30b9\u304c\u3042\u3063\u305f\u3053\u3068\u3092\u8a18\u9332\u3059\u308b\u5fc5\u8981\u304c\u3042\u308b\u5834\u5408\u306f\u5f8c\u8005\u306e\u65b9\u6cd5\u3092\u3068\u308b\u65b9\u304c\u3088\u3044\u3068\u601d\u3044\u307e\u3059\u3002\n\nSQL\u306b\u6761\u4ef6\u306b\u30e6\u30fc\u30b6\u540d\u52a0\u3048\u308b\n\u30bf\u30b9\u30af\u60c5\u5831\u306b\u30a2\u30af\u30bb\u30b9\u3059\u308b\u969b\u306e\u6761\u4ef6(SQL\u306e\u6761\u4ef6)\u306b\u30e6\u30fc\u30b6\u540d\u3092\u52a0\u3048\u308b\u5834\u5408\u306f\u3001Repository\u306e\u30e1\u30bd\u30c3\u30c9\u306e\u5f15\u6570\u306b\u30e6\u30fc\u30b6\u540d\u3092\u8ffd\u52a0\u3057\u3066SQL\u306e\u6761\u4ef6\u306b\u30e6\u30fc\u30b6\u540d\u3092\u52a0\u3048\u307e\u3057\u3087\u3046\u3002\u3053\u3053\u3067\u306f\u3001\u66f4\u65b0\u3068\u524a\u9664\u51e6\u7406\u306b\u3064\u3044\u3066\u306f\u3001\u51e6\u7406\u3092\u884c\u3046\u524d\u306bfindOne\u30e1\u30bd\u30c3\u30c9\u3092\u547c\u3073\u51fa\u3059\u3053\u3068\u81ea\u8eab\u306e\u30bf\u30b9\u30af\u60c5\u5831\u306b\u5bfe\u3059\u308b\u51e6\u7406\u304b\u30c1\u30a7\u30c3\u30af\u3059\u308b\u3088\u3046\u306b\u3057\u3066\u3044\u307e\u3059\u3002\n@Transactional\n@Repository\npublic class TaskRepository {\n    // ...\n\n    public Task findOne(long id, String username) {\n        return jdbcOperations.queryForObject(\n                \"SELECT id, username, title, detail, deadline, finished, created_at, updated_at, version FROM tasks WHERE id = :id AND username = :username\",\n                new MapSqlParameterSource(\"id\", id).addValue(\"username\", username), new BeanPropertyRowMapper<>(Task.class)); // \u2605\u2605\u2605\u4fee\u6b63\n    }\n\n    public void save(Task task, String username) {\n        if (task.getId() == null) {\n            GeneratedKeyHolder holder = new GeneratedKeyHolder();\n            jdbcOperations.update(\n                    \"INSERT INTO tasks (username, title, detail, deadline, finished) VALUES(:username, :title, :detail, :deadline, :finished)\",\n                    new BeanPropertySqlParameterSource(task), holder);\n            task.setId(holder.getKey().longValue());\n        } else {\n            findOne(task.getId(), username); // \u2605\u2605\u2605\u8ffd\u52a0\n            jdbcOperations.update(\n                    \"UPDATE tasks SET title = :title, detail = :detail, deadline = :deadline, finished = :finished, updated_at = SYSTIMESTAMP, version = version + 1 WHERE id = :id\",\n                    new BeanPropertySqlParameterSource(task));\n        }\n    }\n\n    public void remove(long id, String username) {\n        findOne(id, username); // \u2605\u2605\u2605\u8ffd\u52a0\n        jdbcOperations.update(\"DELETE FROM tasks WHERE id = :id\", new MapSqlParameterSource(\"id\", id));\n    }\n\n}\n\nRepository\u306e\u30e1\u30bd\u30c3\u30c9\u306e\u5f15\u6570\u5909\u66f4\u306b\u4f34\u3044\u3001Controller\u30af\u30e9\u30b9\u306e\u4fee\u6b63\u3082\u884c\u3044\u307e\u3059\u3002\n@RequestMapping(\"/api/tasks\")\n@RestController\npublic class TaskRestController {\n\n    // ...\n\n    @PostMapping\n    ResponseEntity<Void> postTask(@RequestBody Task task, Principal principal, UriComponentsBuilder uriBuilder) {\n        task.setUsername(extractUsername(principal));\n        repository.save(task, task.getUsername()); // \u2605\u2605\u2605\u4fee\u6b63\n        URI createdTaskUri = relativeTo(uriBuilder)\n                .withMethodCall(on(TaskRestController.class).getTask(task.getId(), principal)).build().encode().toUri(); // \u2605\u2605\u2605\u4fee\u6b63\n        return ResponseEntity.created(createdTaskUri).build();\n    }\n\n    @GetMapping(\"{id}\")\n    Task getTask(@PathVariable long id, Principal principal) {\n        return repository.findOne(id, extractUsername(principal)); // \u2605\u2605\u2605\u4fee\u6b63\n    }\n\n    @PutMapping(\"{id}\")\n    @ResponseStatus(HttpStatus.NO_CONTENT)\n    void putTask(@PathVariable long id, @RequestBody Task task, Principal principal) {\n        task.setId(id);\n        repository.save(task, extractUsername(principal)); // \u2605\u2605\u2605\u4fee\u6b63\n    }\n\n    @DeleteMapping(\"{id}\")\n    @ResponseStatus(HttpStatus.NO_CONTENT)\n    void deleteTask(@PathVariable long id, Principal principal) {\n        repository.remove(id, extractUsername(principal)); // \u2605\u2605\u2605\u4fee\u6b63\n    }\n\n    // ...\n\n}\n\n\u4ed6\u4eba\u306e\u30bf\u30b9\u30af\u60c5\u5831\u306b\u30a2\u30af\u30bb\u30b9\u3059\u308b\u3068\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u30ea\u30bd\u30fc\u30b9\u304c\u5b58\u5728\u3057\u306a\u6642\u306b\u767a\u751f\u3059\u308b\u30a8\u30e9\u30fc(404 Not Found)\u306b\u306a\u308a\u307e\u3059\u3002\n\n\n\u6240\u6709\u8005\u30c1\u30a7\u30c3\u30af\u3092\u884c\u3046\n\u30bf\u30b9\u30af\u60c5\u5831\u306e\u6240\u6709\u8005\u3068\u8a8d\u8a3c\u60c5\u5831\u306e\u30e6\u30fc\u30b6\u304c\u4e00\u81f4\u3059\u308b\u304b\u30c1\u30a7\u30c3\u30af\u3059\u308b\u5834\u5408\u306f\u3001Spring Security\u304c\u63d0\u4f9b\u3057\u3066\u3044\u308b\u30e1\u30bd\u30c3\u30c9\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u306e\u4ed5\u7d44\u307f\u3092\u5229\u7528\u3059\u308b\u306e\u304c\u3066\u3063\u3068\u308a\u65e9\u3044\u3067\u3057\u3087\u3046\u3002\n\u307e\u305a\u3001\u30e1\u30bd\u30c3\u30c9\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u306e\u4ed5\u7d44\u307f\u3092\u6709\u52b9\u5316\u3059\u308b\u305f\u3081\u306b\u3001\u30b3\u30f3\u30d5\u30a3\u30ae\u30e5\u30ec\u30fc\u30b7\u30e7\u30f3\u30af\u30e9\u30b9\u306b@EnableGlobalMethodSecurity\u3092\u4ed8\u4e0e\u3057\u307e\u3059\u3002\n\nservice-provider/src/main/java/com/example/ResourceServerConfiguration.java\n@EnableGlobalMethodSecurity(prePostEnabled = true) // \u2605\u2605\u2605\u8ffd\u52a0\n@EnableResourceServer\n@Configuration\npublic class ResourceServerConfiguration extends ResourceServerConfigurerAdapter {\n    // ...\n}\n\n\n\u6b21\u306b\u3001\u30bf\u30b9\u30af\u60c5\u5831\u3092\u53d6\u5f97\u3059\u308b\u30e1\u30bd\u30c3\u30c9\u306b\u5bfe\u3057\u3066\u3001\u30ea\u30bd\u30fc\u30b9\u30aa\u30fc\u30ca\u4ee5\u5916\u30a2\u30af\u30bb\u30b9\u3067\u304d\u306a\u3044\u3088\u3046\u306b\u8a8d\u53ef\u8a2d\u5b9a\u3092\u884c\u3044\u307e\u3059\u3002\n\nservice-provider/src/main/java/com/example/TaskRepository.java\n@Transactional\n@Repository\npublic class TaskRepository {\n    // ...\n    @PostAuthorize(\"returnObject.username == authentication.name\") // \u2605\u2605\u2605\u8ffd\u52a0\n    public Task findOne(long id) {\n        return jdbcOperations.queryForObject(\n                \"SELECT id, username, title, detail, deadline, finished, created_at, updated_at, version FROM tasks WHERE id = :id\",\n                new MapSqlParameterSource(\"id\", id), new BeanPropertyRowMapper<>(Task.class));\n    }\n    // ...\n}\n\n\n\u6700\u5f8c\u306b\u3001\u66f4\u65b0\u307e\u305f\u306f\u524a\u9664\u3059\u308b\u969b\u306b\u3082findOne\u30e1\u30bd\u30c3\u30c9\u3092\u547c\u3073\u51fa\u3059\u3088\u3046\u306b\u4fee\u6b63\u3057\u307e\u3059\u3002\n\nservice-provider/src/main/java/com/example/TaskRestController.java\n@RequestMapping(\"/api/tasks\")\n@RestController\npublic class TaskRestController {\n\n    // ...\n\n    @PutMapping(\"{id}\")\n    @ResponseStatus(HttpStatus.NO_CONTENT)\n    void putTask(@PathVariable long id, @RequestBody Task task) {\n        repository.findOne(id); // \u2605\u2605\u2605\u8ffd\u52a0 \n        task.setId(id);\n        repository.save(task);\n    }\n\n    @DeleteMapping(\"{id}\")\n    @ResponseStatus(HttpStatus.NO_CONTENT)\n    void deleteTask(@PathVariable long id) {\n        repository.findOne(id); // \u2605\u2605\u2605\u8ffd\u52a0 \n        repository.remove(id);\n    }\n\n    // ...\n\n}\n\n\n\u4ed6\u4eba\u306e\u30bf\u30b9\u30af\u60c5\u5831\u306b\u30a2\u30af\u30bb\u30b9\u3059\u308b\u3068\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u8a8d\u53ef\u30a8\u30e9\u30fc(403 Forbidden)\u306b\u306a\u308a\u307e\u3059\u3002\n\n\n\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u5b8c\u6210\u7248\n\u672c\u30a8\u30f3\u30c8\u30ea\u30fc\u3067\u4f5c\u6210\u3057\u305f\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u5b8c\u6210\u7248\u306f\u3001\u4ee5\u4e0b\u306eGitHub\u30ea\u30dd\u30b8\u30c8\u30ea\u3067\u516c\u958b\u3057\u3066\u3042\u308a\u307e\u3059\u3002\n\nhttps://github.com/kazuki43zoo/spring-security-oauth-demo\n\n\n\u307e\u3068\u3081\n\u8aac\u660e\u304c\u3061\u3087\u3063\u3068\u9577\u304f\u306a\u308a\u307e\u3057\u305f\u304c\u30fb\u30fb\u30fb\u8a8d\u53ef\u30b3\u30fc\u30c9\u30b0\u30e9\u30f3\u30c8\u30d5\u30ed\u30fc\u3092\u4f7f\u7528\u3057\u3066REST API\u306e\u8a8d\u8a3c\u30fb\u8a8d\u53ef\u3092\u884c\u3046\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u4f5c\u3063\u3066\u307f\u307e\u3057\u305f\u3002\u4eca\u56de\u306f\u3042\u304f\u307e\u3067Spring Security OAuth + Spring Boot\u3067\u8a8d\u53ef\u30b3\u30fc\u30c9\u30b0\u30e9\u30f3\u30c8\u30d5\u30ed\u30fc\u3092\u4f53\u611f\u3057\u3066\u3082\u3089\u3046\uff08\u89e6\u308c\u3066\u3082\u3089\u3046\uff09\u3053\u3068\u304c\u76ee\u7684\u3060\u3063\u305f\u306e\u3067\u3001Spring Boot\u306eAutoConfigure\u306e\u4ed5\u7d44\u307f\uff08\u30c7\u30d5\u30a9\u30eb\u30c8\u306e\u52d5\u4f5c\uff09\u3092\u6700\u5927\u9650\u306b\u6d3b\u7528\u3057\u3066\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u4f5c\u308b\u3088\u3046\u306b\u3057\u307e\u3057\u305f\u3002\n\u3057\u304b\u3057\u30fb\u30fb\u30fb\u5b9f\u969b\u306e\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u958b\u767a\u3067\u306f\u3001\u30e6\u30fc\u30b6(\u30ea\u30bd\u30fc\u30b9\u30aa\u30fc\u30ca)\u3084\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u306e\u60c5\u5831\u306f\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306a\u3069\u3067\u7ba1\u7406\u3059\u308b\u306e\u304c\u4e00\u822c\u7684\u3067\u3059\u3057\u3001\u30a2\u30af\u30bb\u30b9\u30c8\u30fc\u30af\u30f3\u3084\u8a8d\u53ef\u60c5\u5831\u3082\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u5185\u306e\u30e1\u30e2\u30ea\u4e0a\u3067\u7ba1\u7406\u3059\u308b\u306e\u3067\u306f\u306a\u304f\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306a\u3069\u306b\u6c38\u7d9a\u5316\u3059\u308b\u3053\u3068\u304c\u6c42\u3081\u3089\u308c\u308b\u30b1\u30fc\u30b9\u306e\u65b9\u304c\u591a\u3044\u3067\u3057\u3087\u3046\u3002\u3055\u3089\u306b\u3001Service Provider\u304c\u6271\u3046\u30ea\u30bd\u30fc\u30b9\u3082\uff11\u7a2e\u985e\u3067\u306f\u306a\u304f\u8907\u6570\u306b\u306a\u308b\u30b1\u30fc\u30b9\u3084\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u3082\u8907\u6570\u306eService Provider\u306e\u30ea\u30bd\u30fc\u30b9\u3078\u30a2\u30af\u30bb\u30b9\u3059\u308b\u3088\u3046\u306a\u30b1\u30fc\u30b9\u306a\u3069\u3082\u60f3\u5b9a\u3055\u308c\u308b\u305f\u3081\u3001\u4eca\u56de\u7d39\u4ecb\u3057\u305f\u5185\u5bb9\u3060\u3051\u3067\u306f\u5b9f\u904b\u7528\u306b\u8010\u3048\u3089\u308c\u308b\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u958b\u767a\u3059\u308b\u306e\u304c\u96e3\u3057\u3044\u306e\u3082\u73fe\u5b9f\u3067\u3059\u3002\n\u306a\u306e\u3067\u30fb\u30fb\u30fb\u6b21\u56de\u4ee5\u964d\u3067\u306f\u3001Spring Security OAuth\u306e\u30a2\u30fc\u30ad\u30c6\u30af\u30c1\u30e3\u3092\u8aac\u660e\u3057\u3001Spring Boot\u30fbSpring Security\u30fbSpring Security OAuth\u306e\u62e1\u5f35\u30dd\u30a4\u30f3\u30c8\u3092\u4f7f\u7528\u3057\u305f\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u958b\u767a\u65b9\u6cd5\u3092\u7d39\u4ecb\u3057\u3066\u3044\u304d\u305f\u3044\u3068\u601d\u3063\u3066\u3044\u307e\u3059\u3002\n\u3067\u306f\u3001\u307e\u305f\u6b21\u56de\uff01\uff01\n\u4eca\u56de\u306f\u3001\u300cSpring Security OAuth\u3067\u8a8d\u53ef\u30b3\u30fc\u30c9\u30b0\u30e9\u30f3\u30c8\u30d5\u30ed\u30fc\u3092\u4f53\u611f\u3057\u3088\u3046\u300d\u306e\u7b2c\u4e8c\u56de\u3067\u3001\u307e\u301c\u3068\u308a\u3042\u3048\u305aSpring Security OAuth + Spring Boot\u3092\u4f7f\u7528\u3057\u3066\u8a8d\u53ef\u30b3\u30fc\u30c9\u30b0\u30e9\u30f3\u30c8\u30d5\u30ed\u30fc\u3067REST API\u306e\u8a8d\u8a3c\u30fb\u8a8d\u53ef\u3092\u884c\u3046\u30a2\u30d7\u30ea\u4f5c\u3063\u3066\u307f\u308b\u3053\u3068\u306b\u3057\u307e\u3059\u3002\n\n* [\u7b2c\uff11\u56de\uff1aOAuth 2.0\u306e\u304a\u3055\u3089\u3044\u7de8](http://qiita.com/kazuki43zoo/items/def37371684d0e80a626)\n\n# \u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u6a5f\u80fd\u8981\u4ef6\n\n\u4eca\u56de\u4f5c\u6210\u3059\u308b\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u6a5f\u80fd\u8981\u4ef6\u306f\u30fb\u30fb\u30fb\n\n## Service Provider\n\nService Provider\u306f\u3001\u30e6\u30fc\u30b6\u5358\u4f4d\u3067\u30bf\u30b9\u30af\u60c5\u5831(\u30bf\u30a4\u30c8\u30eb\u3001\u8a73\u7d30\u3001\u671f\u9650\u65e5\u3001\u5b8c\u4e86\u30d5\u30e9\u30b0\u3001\u767b\u9332\u65e5\u6642\u3001\u66f4\u65b0\u65e5\u6642)\u306e\u7ba1\u7406(\u767b\u9332\u30fb\u66f4\u65b0\u30fb\u524a\u9664\u30fb\u53c2\u7167)\u3092\u884c\u3046REST API\u3092\u63d0\u4f9b\u3057\u3001REST API\u3078\u306e\u30a2\u30af\u30bb\u30b9\u306f\u3001OAuth 2.0\u306e\u8a8d\u53ef\u30b3\u30fc\u30c9\u30b0\u30e9\u30f3\u30c8\u30d5\u30ed\u30fc\u3067\u767a\u884c\u3057\u305f\u30a2\u30af\u30bb\u30b9\u30c8\u30fc\u30af\u30f3\u3092\u4f7f\u7528\u3057\u3066\u8a8d\u8a3c\u30fb\u8a8d\u53ef\u3092\u884c\u3046\u3002\n\n\u3068\u3044\u3046\u8981\u4ef6\u306b\u3057\u307e\u3059\u3002\n\u672c\u6765\u3067\u3042\u308c\u3070Service Provider\u5074\u306b\u3082\u30bf\u30b9\u30af\u60c5\u5831\u3092\u7ba1\u7406\u3059\u308b\u305f\u3081\u306eWeb UI\u3092\u7528\u610f\u3057\u305f\u3044\u3068\u3053\u308d\u3067\u3059\u304c\u3001Service Provider\u5074\u306eWeb UI\u306f\u672c\u30a8\u30f3\u30c8\u30ea\u30fc\u306e\u30d5\u30a9\u30fc\u30ab\u30b9\u5916\u3068\u3057\u3066\u8aac\u660e\u3082\u5272\u611b\u3055\u305b\u3066\u3082\u3089\u3044\u307e\u3059\u3002\n\n### Resource Server\n\n\u30ea\u30bd\u30fc\u30b9\u30aa\u30fc\u30ca\u306e\u30bf\u30b9\u30af\u60c5\u5831\u3092\u7ba1\u7406\u3059\u308b\u305f\u3081\u306eAPI\u3068\u3057\u3066\u3001\u4ee5\u4e0b\u306eAPI\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\n| API\u540d | API\u6982\u8981 | \u30a2\u30af\u30bb\u30b9\u3092\u8a31\u53ef\u3059\u308b\u30b9\u30b3\u30fc\u30d7 |\n| ----- | ------- | --------------------- |\n| GET /api/tasks | \u30bf\u30b9\u30af\u60c5\u5831\u306e\u4e00\u89a7\u3092\u53d6\u5f97\u3059\u308bAPI | read |\n| POST /api/tasks | \u30bf\u30b9\u30af\u60c5\u5831\u3092\u767b\u9332\u3059\u308bAPI | write |\n| GET /api/tasks/{id} | \u30bf\u30b9\u30af\u60c5\u5831\u3092\u53d6\u5f97\u3059\u308bAPI | read |\n| PUT /api/tasks/{id} | \u30bf\u30b9\u30af\u60c5\u5831\u3092\u66f4\u65b0\u3059\u308bAPI | write |\n| DELETE /api/tasks/{id} | \u30bf\u30b9\u30af\u60c5\u5831\u3092\u524a\u9664\u3059\u308bAPI | write |\n\n### Authorization Server\n\n\u30bf\u30b9\u30af\u60c5\u5831\u3078\u306e\u30a2\u30af\u30bb\u30b9\u3092\u30ea\u30bd\u30fc\u30b9\u30aa\u30fc\u30ca\u304b\u3089\u8a31\u53ef\u3057\u3066\u3082\u3089\u3046\u305f\u3081\u306b\u3001\u4ee5\u4e0b\u306e\u30a8\u30f3\u30c9\u30dd\u30a4\u30f3\u30c8\uff08\u4ee5\u964d\u3001\u300c\u8a8d\u53ef\u30a8\u30f3\u30c9\u30dd\u30a4\u30f3\u30c8\u300d\u3068\u547c\u3076\uff09\u3092\u63d0\u4f9b\u3057\u307e\u3059\u3002\u3053\u306e\u30a8\u30f3\u30c9\u30dd\u30a4\u30f3\u30c8\u306f\u3001Spring Security OAuth\u304c\u63d0\u4f9b\u3057\u3066\u304f\u308c\u308b\u305f\u3081\u3001\u958b\u767a\u8005\u304c\u4f5c\u6210\u3059\u308b\u5fc5\u8981\u306f\u3042\u308a\u307e\u305b\u3093\u3002\n\n| \u30a8\u30f3\u30c9\u30dd\u30a4\u30f3\u30c8\u540d | \u30a8\u30f3\u30c9\u30dd\u30a4\u30f3\u30c8\u6982\u8981 | \u30a2\u30af\u30bb\u30b9\u3092\u8a31\u53ef\u3059\u308b\u6761\u4ef6 |\n| ----- | ------- | ------- |\n| GET /oauth/authorize | \u30ea\u30bd\u30fc\u30b9\u30aa\u30fc\u30ca\u304b\u3089\u306e\u8a8d\u53ef\u3092\u5f97\u308b\u305f\u3081\u306e\u753b\u9762\uff08\u4ee5\u964d\u3001\u300c\u8a8d\u53ef\u753b\u9762\u300d\u3068\u547c\u3076\uff09\u3092\u8868\u793a\u3059\u308b\u305f\u3081\u306e\u30a8\u30f3\u30c9\u30dd\u30a4\u30f3\u30c8 | \u8a8d\u8a3c\u6e08\u307f\u306e\u30ea\u30bd\u30fc\u30b9\u30aa\u30fc\u30ca |\n| POST /oauth/authorize?user_oauth_approval | \u30ea\u30bd\u30fc\u30b9\u30aa\u30fc\u30ca\u304b\u3089\u306e\u8a8d\u53ef\u6307\u793a(\u8a31\u53ef\u30fb\u62d2\u5426)\u3092\u53d7\u3051\u3066\u8a8d\u53ef\u30b0\u30e9\u30f3\u30c8(\u8a8d\u53ef\u30b3\u30fc\u30c9)\u3092\u767a\u884c\u3059\u308b\u305f\u3081\u306e\u30a8\u30f3\u30c9\u30dd\u30a4\u30f3\u30c8 | \u8a8d\u8a3c\u6e08\u307f\u306e\u30ea\u30bd\u30fc\u30b9\u30aa\u30fc\u30ca |\n\nClient\u304c\u30ea\u30bd\u30fc\u30b9\u30aa\u30fc\u30ca\u304b\u3089\u53d6\u5f97\u3057\u305f\u8a8d\u53ef\u30b0\u30e9\u30f3\u30c8(\u8a8d\u53ef\u30b3\u30fc\u30c9)\u3092\u3082\u3068\u306b\u30a2\u30af\u30bb\u30b9\u30c8\u30fc\u30af\u30f3\u3092\u767a\u884c\u3059\u308b\u305f\u3081\u306b\u3001\u4ee5\u4e0b\u306e\u30a8\u30f3\u30c9\u30dd\u30a4\u30f3\u30c8\uff08\u4ee5\u964d\u3001\u300c\u30c8\u30fc\u30af\u30f3\u30a8\u30f3\u30c9\u30dd\u30a4\u30f3\u30c8\u300d\u3068\u547c\u3076\uff09\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\u3053\u306e\u30a8\u30f3\u30c9\u30dd\u30a4\u30f3\u30c8\u306f\u3001Spring Security OAuth\u304c\u63d0\u4f9b\u3057\u3066\u304f\u308c\u308b\u305f\u3081\u3001\u958b\u767a\u8005\u304c\u4f5c\u6210\u3059\u308b\u5fc5\u8981\u306f\u3042\u308a\u307e\u305b\u3093\u3002\n\n| \u30a8\u30f3\u30c9\u30dd\u30a4\u30f3\u30c8\u540d | \u30a8\u30f3\u30c9\u30dd\u30a4\u30f3\u30c8\u6982\u8981 | \u30a2\u30af\u30bb\u30b9\u3092\u8a31\u53ef\u3059\u308b\u6761\u4ef6 |\n| ----- | ------- | ------- |\n| POST /oauth/token | \u30ea\u30bd\u30fc\u30b9\u30aa\u30fc\u30ca\u304b\u3089\u53d6\u5f97\u3057\u305f\u8a8d\u53ef\u30b0\u30e9\u30f3\u30c8(\u8a8d\u53ef\u30b3\u30fc\u30c9\u306a\u3069)\u3092\u3082\u3068\u306b\u30a2\u30af\u30bb\u30b9\u30c8\u30fc\u30af\u30f3\u3092\u767a\u884c\u3059\u308b\u305f\u3081\u306e\u30a8\u30f3\u30c9\u30dd\u30a4\u30f3\u30c8 | \u8a8d\u8a3c\u6e08\u307f\u306eClient\n \n> **Note: \u5404\u7a2e\u30a8\u30f3\u30c9\u30dd\u30a4\u30f3\u30c8\u3078\u306e\u8a8d\u8a3c\u30fb\u8a8d\u53ef**\n>\n> \u672c\u30a8\u30f3\u30c8\u30ea\u30fc\u3067\u306f\u30fb\u30fb\u30fbSpring Security\u304c\u63d0\u4f9b\u3057\u3066\u3044\u308bBasic\u8a8d\u8a3c\u3092\u5229\u7528\u3057\u3066\u3001\u3053\u308c\u3089\u306e\u30a8\u30f3\u30c9\u30dd\u30a4\u30f3\u30c8\u306b\u5bfe\u3057\u3066\u30ea\u30bd\u30fc\u30b9\u30aa\u30fc\u30ca\u53ca\u3073Client\u306e\u8a8d\u8a3c\u3092\u884c\u3044\u307e\u3059\u3002\n\n## Client(Web UI)\n\nClient\u306f\u3001Service Provider\u304b\u3089\u63d0\u4f9b\u3055\u308c\u3066\u3044\u308bREST API\u3092\u4f7f\u7528\u3057\u3066\u3001\u30ea\u30bd\u30fc\u30b9\u30aa\u30fc\u30ca\u306e\u30bf\u30b9\u30af\u60c5\u5831\u3092\u7ba1\u7406\u3059\u308b\u305f\u3081\u306eWeb UI(\u30bf\u30b9\u30af\u4e00\u89a7\u753b\u9762\u3068\u30bf\u30b9\u30af\u8a73\u7d30\u753b\u9762)\u3092\u63d0\u4f9b\u3057\u307e\u3059\u3002\n\n| \u30a8\u30f3\u30c9\u30dd\u30a4\u30f3\u30c8\u540d | \u30a8\u30f3\u30c9\u30dd\u30a4\u30f3\u30c8\u6982\u8981 | \u30a2\u30af\u30bb\u30b9\u3092\u8a31\u53ef\u3059\u308b\u6761\u4ef6 |\n| ----- | ------- | ------- |\n| GET /tasks | \u30ea\u30bd\u30fc\u30b9\u30b5\u30fc\u30d0\u304b\u3089\u53d6\u5f97\u3057\u305f\u30bf\u30b9\u30af\u60c5\u5831\u306e\u30bf\u30b9\u30af\u4e00\u89a7\u753b\u9762\u306b\u8868\u793a\u3059\u308b | \u8a8d\u8a3c\u6e08\u307f\u306e\u5229\u7528\u8005 |\n| POST /tasks | \u30ea\u30bd\u30fc\u30b9\u30b5\u30fc\u30d0\u306b\u30bf\u30b9\u30af\u60c5\u5831\u3092\u4f5c\u6210\u3059\u308b | \u8a8d\u8a3c\u6e08\u307f\u306e\u5229\u7528\u8005 |\n| GET /tasks/{id} | \u30ea\u30bd\u30fc\u30b9\u30b5\u30fc\u30d0\u304b\u3089\u53d6\u5f97\u3057\u305f\u30bf\u30b9\u30af\u60c5\u5831\u3092\u30bf\u30b9\u30af\u8a73\u7d30\u753b\u9762\u306b\u8868\u793a\u3059\u308b | \u8a8d\u8a3c\u6e08\u307f\u306e\u5229\u7528\u8005 |\n| POST /tasks/{id}?update | \u30ea\u30bd\u30fc\u30b9\u30b5\u30fc\u30d0\u3067\u7ba1\u7406\u3057\u3066\u3044\u308b\u30bf\u30b9\u30af\u60c5\u5831\u3092\u66f4\u65b0\u3059\u308b | \u8a8d\u8a3c\u6e08\u307f\u306e\u5229\u7528\u8005 |\n| POST /tasks/{id}?delete | \u30ea\u30bd\u30fc\u30b9\u30b5\u30fc\u30d0\u3067\u7ba1\u7406\u3057\u3066\u3044\u308b\u30bf\u30b9\u30af\u60c5\u5831\u3092\u524a\u9664\u3059\u308b | \u8a8d\u8a3c\u6e08\u307f\u306e\u5229\u7528\u8005 |\n\n> **Note: \u30bf\u30b9\u30af\u7ba1\u7406\u7528UI\u306e\u8a8d\u8a3c\u30fb\u8a8d\u53ef**\n>\n> Client\u5074\u3067\u7528\u610f\u3059\u308b\u30bf\u30b9\u30af\u7ba1\u7406\u7528\u306e\u753b\u9762\u306f\u3001Client\u5074\u306e\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u30e6\u30fc\u30b6\u8a8d\u8a3c\u3092\u5fc5\u8981\u3068\u3057\u3066\u3001\u30e6\u30fc\u30b6\u8a8d\u8a3c\u306b\u306fSpring Security\u304c\u63d0\u4f9b\u3057\u3066\u3044\u308bBasic\u8a8d\u8a3c\u3092\u4f7f\u7528\u3057\u3066\u884c\u3044\u307e\u3059\u3002\n\n\u753b\u9762\u30a4\u30e1\u30fc\u30b8\u3068\u753b\u9762\u9077\u79fb\u306f\u4ee5\u4e0b\u306e\u901a\u308a\u3068\u3059\u308b\u3002\n\n![spring-security-oauth-1st-app-client.png](https://qiita-image-store.s3.amazonaws.com/0/117313/902457f0-338e-f2ce-b8f0-49578c9996b8.png)\n\n\n# \u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u69cb\u6210\n\n\u4eca\u56de\u306f\u3001\u300c\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u300d\u3068\u300c\u30b5\u30fc\u30d3\u30b9\u30d7\u30ed\u30d0\u30a4\u30c0\uff08\u8a8d\u53ef\u30b5\u30fc\u30d0\uff0b\u30ea\u30bd\u30fc\u30b9\u30b5\u30fc\u30d0\uff09\u300d\u3068\u3044\u3046\uff12\u3064\u306eSpring Boot\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u4f5c\u6210\u3057\u3066\u3001\u8a8d\u53ef\u30b3\u30fc\u30c9\u30b0\u30e9\u30f3\u30c8\u30d5\u30ed\u30fc\u3067API\u306e\u8a8d\u8a3c\u30fb\u8a8d\u53ef\u3092\u884c\u3046\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u69cb\u7bc9\u3057\u307e\u3059\u3002\u306a\u304a\u3001\u8a8d\u53ef\u30b5\u30fc\u30d0\u3068\u30ea\u30bd\u30fc\u30b9\u30b5\u30fc\u30d0\u9593\u3067\u306e\u30a2\u30af\u30bb\u30b9\u30c8\u30fc\u30af\u30f3\u53ca\u3073\u30a2\u30af\u30bb\u30b9\u30c8\u30fc\u30af\u30f3\u306b\u7d10\u3065\u304f\u8a8d\u8a3c\u60c5\u5831\u306e\u9023\u643a\u306f\u3001Web\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u4e0a\u3067\u306e\u30a4\u30f3\u30e1\u30e2\u30ea\u9023\u643a\u3068\u3057\u307e\u3059\u3002\n\n![spring-security-oauth-1st-app.png](https://qiita-image-store.s3.amazonaws.com/0/117313/e1089137-e867-6691-b065-e0cdca964c8b.png)\n\n\n> **Warning:**\n>\n> \u672c\u30a8\u30f3\u30c8\u30ea\u30fc\u3067\u4f5c\u308b\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306fHTTP\u901a\u4fe1\u3092\u4f7f\u7528\u3057\u3066\u52d5\u304b\u3057\u307e\u3059\u304c\u30fb\u30fb\u30fbOAuth 2.0\u306e\u30d7\u30ed\u30c8\u30b3\u30eb\u30d5\u30ed\u30fc\u3067\u306f\u3001**\u30ea\u30bd\u30fc\u30b9\u30aa\u30fc\u30ca\u53ca\u3073Client\u306e\u8a8d\u8a3c\u3084\u30a2\u30af\u30bb\u30b9\u30c8\u30fc\u30af\u30f3\u3092\u6271\u3046\u30a8\u30f3\u30c9\u30dd\u30a4\u30f3\u30c8\u306fHTTPS\u901a\u4fe1\u3092\u4f7f\u7528\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059**\u3002\n\n<p>\n\n> **Note:**\n>\n> \u8a8d\u53ef\u30b5\u30fc\u30d0\u3068\u30ea\u30bd\u30fc\u30b9\u30b5\u30fc\u30d0\u306f\u5f79\u5272\u304c\u9055\u3046\u305f\u3081\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u611f\u3058\u3067\u72ec\u7acb\u3057\u305fWeb\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3068\u3057\u3066\u4f5c\u6210\u3059\u308b\u30b1\u30fc\u30b9\u306e\u65b9\u304c\u591a\u3044\u3068\u601d\u3044\u307e\u3059\u304c\u3001\u4eca\u56de\u306f\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u69cb\u6210\u306e\u30b7\u30f3\u30d7\u30eb\u3055\u3092\u512a\u5148\u3057\u3001\u8a8d\u53ef\u30b5\u30fc\u30d0\u3068\u30ea\u30bd\u30fc\u30b9\u30b5\u30fc\u30d0\u306f\u3072\u3068\u3064\u306eSpring Boot\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3067\u5b9f\u73fe\u3059\u308b\u3053\u3068\u306b\u3057\u307e\u3057\u305f\u3002\n> \n> ![spring-security-oauth-std-app.png](https://qiita-image-store.s3.amazonaws.com/0/117313/4bac7fbe-c942-287d-42ed-7351fe196b75.png)\n\n> \u8a8d\u53ef\u30b5\u30fc\u30d0\u3068\u30ea\u30bd\u30fc\u30b9\u30b5\u30fc\u30d0\u3092\u5225\u306eWeb\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3068\u3057\u3066\u4f5c\u6210\u3059\u308b\u5834\u5408\u306f\u3001\u30a2\u30af\u30bb\u30b9\u30c8\u30fc\u30af\u30f3\u53ca\u3073\u30a2\u30af\u30bb\u30b9\u30c8\u30fc\u30af\u30f3\u306b\u7d10\u3065\u304f\u8a8d\u8a3c\u60c5\u5831\u3092\u30b5\u30fc\u30d0\u9593\u3067\u9023\u643a\u65b9\u6cd5\u306e\u9078\u629e\u304c\u3072\u3068\u3064\u306e\u30dd\u30a4\u30f3\u30f3\u30c8\u306b\u306a\u308a\u307e\u3059\u3002\u306a\u304a\u3001\u8a8d\u53ef\u30b5\u30fc\u30d0\u3068\u30ea\u30bd\u30fc\u30b9\u30b5\u30fc\u30d0\u3092\u308f\u3051\u305f\u969b\u306e\u5b9f\u88c5\u65b9\u6cd5\u306a\u3069\u306b\u3064\u3044\u3066\u306f\u3001\u6b21\u56de\u4ee5\u964d\u3067\u7d39\u4ecb\u3059\u308b\u4e88\u5b9a\u3067\u3059\u3002\n\n\n\n# \u52d5\u4f5c\u691c\u8a3c\u6e08\u307f\u30d0\u30fc\u30b8\u30e7\u30f3\n\n\u672c\u30a8\u30f3\u30c8\u30ea\u30fc\u3067\u4f5c\u6210\u3059\u308b\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306f\u3001\u4ee5\u4e0b\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u306e\u30e9\u30a4\u30d6\u30e9\u30ea\u3092\u4f7f\u7528\u3057\u3066\u691c\u8a3c\u3057\u3066\u3044\u307e\u3059\u3002\n\n* Spring Boot 1.5.1.RELEASE\n* Spring Framework 4.3.6.RELEASE\n* Spring Security 4.2.1.RELEASE\n* Spring security OAuth 2.0.12.RELEASE\n* Thymeleaf 2.1.5.RELEASE\n* H2 Database 1.4.193\n\n# \u958b\u767a\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306e\u4f5c\u6210\n\n\u3067\u306f\u3001\u5b9f\u969b\u306b\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u4f5c\u3063\u3066\u3001\u8a8d\u53ef\u30b3\u30fc\u30c9\u30b0\u30e9\u30f3\u30c8\u30d5\u30ed\u30fc\u306b\u3088\u308bREST API\u306e\u8a8d\u8a3c\u30fb\u8a8d\u53ef\u3092\u4f53\u611f\u3057\u3066\u307f\u307e\u3057\u3087\u3046\u3002\n\u307e\u305a\u3001Spring Boot\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u958b\u767a\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u4f5c\u6210\u3057\u307e\u3057\u3087\u3046\u3002\u3053\u3053\u3067\u306f\u30b3\u30de\u30f3\u30c9\u30e9\u30a4\u30f3\u3067\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092\u4f5c\u6210\u3059\u308b\u4f8b\u306b\u306a\u3063\u3066\u3044\u307e\u3059\u304c\u3001[SPRING INITIALIZR\u306eWeb UI](https://start.spring.io/)\u3084\u304a\u4f7f\u3044\u306eIDE\u306e\u6a5f\u80fd\u3067\u751f\u6210\u3057\u3066\u3082\uff08\u3082\u3061\u308d\u3093\uff09OK\u3067\u3059\uff01\uff01\n\n\u4eca\u56de\u306f\uff12\u3064\u306e\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u4f5c\u308b\u306e\u3067\u3001\u305d\u308c\u3089\u306e\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u683c\u7d0d\u3059\u308b\u89aa\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\n```\n$ mkdir spring-security-oauth-demo\n$ cd spring-security-oauth-demo\n```\n\n\u4f5c\u6210\u3057\u305f\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u79fb\u52d5\u3057\u305f\u5f8c\u306b\u3001Service Provider\u3068Client\u7528\u306eSpring Boot\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u958b\u767a\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\n\n### Service Provider\u7528\u306e\u958b\u767a\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u4f5c\u6210\n\n```\n$ curl -s https://start.spring.io/starter.tgz\\\n       -d name=service-provider\\\n       -d artifactId=service-provider\\\n       -d dependencies=web,jdbc,h2\\\n       -d baseDir=service-provider\\\n       | tar -xzvf -\n```\n\n### Client\u7528\u306e\u958b\u767a\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u4f5c\u6210\n\n```\n$ curl -s https://start.spring.io/starter.tgz\\\n       -d name=client\\\n       -d artifactId=client\\\n       -d dependencies=thymeleaf\\\n       -d baseDir=client\\\n       | tar -xzvf -\n```\n\n### \u30d3\u30eb\u30c9\u7528\u306e\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u4f5c\u6210\n\nService Provider\u307e\u305f\u306fClient\u306e\u958b\u767a\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u304b\u3089Maven\u30e9\u30c3\u30d1\u30fc\u306a\u3069\u5fc5\u8981\u306a\u30d5\u30a1\u30a4\u30eb\u3092\u30b3\u30d4\u30fc\u3057\u307e\u3059\u3002\n\n```\n$ cp -r client/.mvn .mvn\n$ cp client/mvnw* .\n$ cp client/.gitignore .\n$ cp client/pom.xml .\n```\n\n\u30b3\u30d4\u30fc\u3057\u305f`pom.xml`\u3092\u30d3\u30eb\u30c9\u7528\u306e\u8a2d\u5b9a\u306b\u4fee\u6b63\u3057\u307e\u3059\u3002\u3053\u3053\u3067\u306fservice-provider\u3068client\u3092\u30b5\u30d6\u30e2\u30b8\u30e5\u30fc\u30eb\u3068\u3057\u3066\u7ba1\u7406\u3059\u308b\u3088\u3046\u306b\u8a2d\u5b9a\u3057\u3066\u3044\u307e\u3059\u3002\u3053\u3046\u3059\u308b\u3053\u3068\u3067\u3001service-provider\u3068client\u3092\u307e\u3068\u3081\u3066Maven\u30d3\u30eb\u30c9\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\n\n```\n$ vi pom.xml\n```\n\n```xml:pom.xml\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<project xmlns=\"http://maven.apache.org/POM/4.0.0\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n        xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd\">\n        <modelVersion>4.0.0</modelVersion>\n\n        <groupId>com.example</groupId>\n        <artifactId>spring-security-oauth-demo</artifactId>\n        <version>0.0.1-SNAPSHOT</version>\n        <packaging>pom</packaging>\n\n        <name>spring-seucirty-oauth-demo</name>\n        <description>Spring Security OAuth Demo project for Spring Boot</description>\n\n        <modules>\n                <module>service-provider</module>\n                <module>client</module>\n        </modules>\n\n</project>\n```\n\n### Service Provider\u306b\u4f9d\u5b58\u30e9\u30a4\u30d6\u30e9\u30ea\u3092\u8ffd\u52a0\n\nService Provider\u306b\u3001\u300cSpring Security OAuth\u300d\u300cJackson\u306eJSR 310\u7528\u62e1\u5f35\u30e2\u30b8\u30e5\u30fc\u30eb\u300d\u300cJTS Topology Suite\u300d\u3092\u8ffd\u52a0\u3057\u307e\u3059\u3002\uff08\u300cJTS Topology Suite\u300d\u306f\u4eca\u56de\u306e\u30a8\u30f3\u30c8\u30ea\u30fc\u306b\u76f4\u63a5\u95a2\u4fc2\u306a\u306e\u3067\u3059\u304c\u30fb\u30fb\u30fbH2 Database\u304c\u4f7f\u7528\u3057\u3066\u3044\u3066\u5b9f\u884c\u6642\u306b\u30a8\u30e9\u30fc\u304c\u3067\u308b\u306e\u3067\u8ffd\u52a0\u3057\u3066\u3044\u307e\u3059\uff09\n\n```\n$ vi service-provider/pom.xml\n```\n\n```xml:service-provider/pom.xml\n<dependency>\n\t<groupId>org.springframework.security.oauth</groupId>\n\t<artifactId>spring-security-oauth2</artifactId>\n</dependency>\n<dependency>\n\t<groupId>com.fasterxml.jackson.datatype</groupId>\n\t<artifactId>jackson-datatype-jsr310</artifactId>\n</dependency>\n<dependency>\n\t<groupId>com.vividsolutions</groupId>\n\t<artifactId>jts</artifactId>\n\t<version>1.13</version>\n\t<scope>runtime</scope>\n</dependency>\n```\n\n### Client\u306b\u4f9d\u5b58\u30e9\u30a4\u30d6\u30e9\u30ea\u3092\u8ffd\u52a0\n\nClient\u306b\u3001\u300cSpring Security OAuth\u300d\u300cJackson\u306eJSR 310\u7528\u62e1\u5f35\u30e2\u30b8\u30e5\u30fc\u30eb\u300d\u300cThymeleaf\u306eJSR 310\u7528\u62e1\u5f35\u30e2\u30b8\u30e5\u30fc\u30eb\u300d\u300cWebjars Locator\u300d\u300cWebJar for Bootstrap\u300d\u3092\u8ffd\u52a0\u3057\u307e\u3059\u3002\n\n```\n$ vi client/pom.xml\n```\n\n```xml:client/pom.xml\n<dependency>\n\t<groupId>org.springframework.security.oauth</groupId>\n\t<artifactId>spring-security-oauth2</artifactId>\n</dependency>\n<dependency>\n\t<groupId>com.fasterxml.jackson.datatype</groupId>\n\t<artifactId>jackson-datatype-jsr310</artifactId>\n</dependency>\n<dependency>\n\t<groupId>org.thymeleaf.extras</groupId>\n\t<artifactId>thymeleaf-extras-java8time</artifactId>\n</dependency>\n<dependency>\n\t<groupId>org.webjars</groupId>\n\t<artifactId>webjars-locator</artifactId>\n</dependency>\n<dependency>\n\t<groupId>org.webjars</groupId>\n\t<artifactId>bootstrap</artifactId>\n\t<version>3.3.7-1</version>\n</dependency>\n```\n\n> **Note:**\n>\n> \u300cWebjars Locator\u300d\u3068\u300cWebJar for Bootstrap\u300d\u306b\u3064\u3044\u3066\u306f\u3001\u300c[Spring MVC(+Spring Boot)\u4e0a\u3067\u306e\u9759\u7684\u30ea\u30bd\u30fc\u30b9\u3078\u306e\u30a2\u30af\u30bb\u30b9\u3092\u7406\u89e3\u3059\u308b](http://qiita.com/kazuki43zoo/items/e12a72d4ac4de418ee37)\u300d\u306e\u4e2d\u306e\u30fb\u30fb\u30fb\n>\n> * [Spring Boot\u4e0a\u3067\u306e\u9759\u7684\u30ea\u30bd\u30fc\u30b9\u3078\u306e\u30a2\u30af\u30bb\u30b9-WebJar\u306e\u5229\u7528](http://qiita.com/kazuki43zoo/items/e12a72d4ac4de418ee37#webjar%E3%81%AE%E5%88%A9%E7%94%A8-1)\n> * [Spring MVC\u306e\u72ec\u81ea\u6a5f\u80fd\u3092\u5229\u7528\u3057\u305f\u9759\u7684\u30ea\u30bd\u30fc\u30b9\u3078\u306e\u30a2\u30af\u30bb\u30b9-WebJar\u306e\u5229\u7528](http://qiita.com/kazuki43zoo/items/e12a72d4ac4de418ee37#webjar%E3%81%AE%E5%88%A9%E7%94%A8)\n>\n> \u3067\u7c21\u5358\u306b\u8aac\u660e\u3057\u3066\u3044\u308b\u306e\u3067\u3001\u8208\u5473\u306e\u3042\u308b\u65b9\u306f\u3054\u89a7\u304f\u3060\u3055\u3044\u3002\n\n### Mavne\u30d3\u30eb\u30c9\u306e\u78ba\u8a8d\n\n\u30d3\u30eb\u30c9\u7528\u306e`pom.xml`\u304c\u683c\u7d0d\u3055\u308c\u3066\u3044\u308b\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3067Mavne\u30d3\u30eb\u30c9(Maven Package)\u3092\u884c\u3044\u3001`pom.xml`\u306e\u8a2d\u5b9a\u306e\u59a5\u5f53\u6027\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u30ed\u30b0\u304c\u3067\u308c\u3070Mavne\u30d3\u30eb\u30c9\u306f\u6210\u529f\u3067\u3059\u3002\n\n```\n$ ./mvnw package\n...\n[INFO] ------------------------------------------------------------------------\n[INFO] Building spring-seucirty-oauth-demo 0.0.1-SNAPSHOT\n[INFO] ------------------------------------------------------------------------\n[INFO] ------------------------------------------------------------------------\n[INFO] Reactor Summary:\n[INFO] \n[INFO] service-provider ................................... SUCCESS [  3.899 s]\n[INFO] client ............................................. SUCCESS [  2.697 s]\n[INFO] spring-seucirty-oauth-demo ......................... SUCCESS [  0.000 s]\n[INFO] ------------------------------------------------------------------------\n[INFO] BUILD SUCCESS\n[INFO] ------------------------------------------------------------------------\n[INFO] Total time: 7.088 s\n[INFO] Finished at: 2017-02-25T09:05:35+09:00\n[INFO] Final Memory: 29M/395M\n[INFO] ------------------------------------------------------------------------\n```\n\n# Service Provider\u306e\u4f5c\u6210\n\n\u307e\u305a\u306f\u3001Service Provider\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\n## Service Provider\u306e\u30b5\u30fc\u30d0\u8a2d\u5b9a\n\n\u5192\u982d\u306e\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u69cb\u6210\u3067\u7d39\u4ecb\u3057\u305f\u901a\u308a\u3001Service Provider\u306e\u30dd\u30fc\u30c8\u3092`18081`\u306b\u3001\u30b3\u30f3\u30c6\u30ad\u30b9\u30c8\u30d1\u30b9\u3092`/provider`\u306b\u3057\u307e\u3059\u3002\u307e\u305f\u3001REST API\u3067\u6271\u3046\u30bf\u30b9\u30af\u60c5\u5831\u304c\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u518d\u8d77\u52d5\u6642\u306b\u6d88\u3048\u306a\u3044\u3088\u3046\u306b\u3059\u308b\u305f\u3081\u306b\u3001H2\u306e\u30d5\u30a1\u30a4\u30eb\u30d9\u30fc\u30b9\u306e\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3092\u4f7f\u7528\u3059\u308b\u3088\u3046\u306b\u3057\u307e\u3059\u3002\n\n```properties:service-provider/src/main/resources/application.properties\nserver.port=18081\nserver.context-path=/provider\nspring.datasource.url=jdbc:h2:~/.h2/service-provider\n```\n\n> **Note:**\n>\n> Service Provider\u3068Client\u3092\u540c\u4e00\u30db\u30b9\u30c8(localhost\u306a\u3069)\u3067\u52d5\u304b\u3059\u5834\u5408\u3001`context-path`(\u30c7\u30d5\u30a9\u30eb\u30c8\u306f`/`)\u304c\u540c\u3058\u3060\u3068\u30bb\u30c3\u30b7\u30e7\u30f3ID\u3092\u7ba1\u7406\u3059\u308bCookie\u304c\u7af6\u5408\u3057\u3066HTTP\u30bb\u30c3\u30b7\u30e7\u30f3\u3092\u6b63\u3057\u304f\u6271\u3048\u306a\u3044\u3053\u3068\u304c\u3042\u308b\u305f\u3081\u3001\u30ed\u30fc\u30ab\u30eb\u74b0\u5883\u3067\u52d5\u304b\u3059\u5834\u5408\u306f`context-path`\u306e\u8a2d\u5b9a\u3082\u5fc5\u8981\u306b\u306a\u308a\u307e\u3059\u3002\n\n## \u30c6\u30fc\u30d6\u30eb\u306e\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\n\n\u30bf\u30b9\u30af\u60c5\u5831\u3092\u4fdd\u5b58\u3059\u308b\u305f\u3081\u306e\u30c6\u30fc\u30d6\u30eb\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\n```sql:service-provider/src/main/resources/schema.sql\nCREATE TABLE IF NOT EXISTS tasks (\n  id IDENTITY PRIMARY KEY\n  , username VARCHAR(255) NOT NULL\n  , title TEXT NOT NULL\n  , detail TEXT\n  , deadline DATE\n  , finished BOOLEAN NOT NULL DEFAULT FALSE\n  , created_at DATETIME DEFAULT SYSTIMESTAMP\n  , updated_at DATETIME DEFAULT SYSTIMESTAMP\n  , version BIGINT DEFAULT 1\n);\n\nCREATE INDEX IF NOT EXISTS idx_tasks_username ON tasks(username);\n```\n\n## \u30c9\u30e1\u30a4\u30f3\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306e\u4f5c\u6210\n\nREST API\u3067\u6271\u3046\u30bf\u30b9\u30af\u60c5\u5831\u3092\u4fdd\u6301\u3059\u308b\u30c9\u30e1\u30a4\u30f3\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\n```java:service-provider/src/main/java/com/example/Task.java\npackage com.example;\n\nimport java.time.LocalDate;\nimport java.time.LocalDateTime;\n\npublic class Task {\n\n\tprivate long id;\n\tprivate String username;\n\tprivate String title;\n\tprivate String detail;\n\tprivate LocalDate deadline;\n\tprivate boolean finished;\n\tprivate LocalDateTime createdAt;\n\tprivate LocalDateTime updatedAt;\n\tprivate long version;\n\n\t// getter/setter\n\n}\n```\n\n## Repository\u306e\u4f5c\u6210\n\n\u30bf\u30b9\u30af\u60c5\u5831\u3092\u4fdd\u6301\u3059\u308b\u30c9\u30e1\u30a4\u30f3\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306eRepository\u30af\u30e9\u30b9\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\u672c\u30a8\u30f3\u30c8\u30ea\u30fc\u3067\u306fJPA\u306a\u3069\u306eO/R Mapper\u306f\u4f7f\u308f\u305a\u306b\u3001Spring Framework\u304c\u63d0\u4f9b\u3059\u308b\u30c7\u30fc\u30bf\u30a2\u30af\u30bb\u30b9\u6a5f\u80fd(`JdbcOperations`)\u3092\u5229\u7528\u3057\u3066\u5b9f\u88c5\u3057\u307e\u3059\u3002\uff08\u5b9f\u969b\u306b\u306f\u30fb\u30fb\u30fb\u540d\u524d\u30d9\u30fc\u30b9\u306e\u30d1\u30e9\u30e1\u30fc\u30bf\u304c\u6271\u3048\u308b`NamedParameterJdbcOperations`\u3092\u4f7f\u3044\u307e\u3059\uff09\n\n> **Note:**\n>\n> `JdbcOperations`\u53ca\u3073`NamedParameterJdbcOperations`\u306eBean\u306f\u3001Spring Boot\u306eAutoConfigure\u306e\u4ed5\u7d44\u307f\u3067Bean\u5b9a\u7fa9\u3055\u308c\u308b\u305f\u3081\u3001\u958b\u767a\u8005\u304c\u660e\u793a\u7684\u306bBean\u5b9a\u7fa9\u3059\u308b\u5fc5\u8981\u306f\u3042\u308a\u307e\u305b\u3093\u3002\n\n\n```java:service-provider/src/main/java/com/example/TaskRepository.java\npackage com.example;\n\nimport java.util.List;\n\nimport org.springframework.jdbc.core.BeanPropertyRowMapper;\nimport org.springframework.jdbc.core.namedparam.BeanPropertySqlParameterSource;\nimport org.springframework.jdbc.core.namedparam.MapSqlParameterSource;\nimport org.springframework.jdbc.core.namedparam.NamedParameterJdbcOperations;\nimport org.springframework.jdbc.support.GeneratedKeyHolder;\nimport org.springframework.stereotype.Repository;\nimport org.springframework.transaction.annotation.Transactional;\n\n@Transactional\n@Repository\npublic class TaskRepository {\n\tprivate final NamedParameterJdbcOperations jdbcOperations;\n\n\tpublic TaskRepository(NamedParameterJdbcOperations jdbcOperations) {\n\t\tthis.jdbcOperations = jdbcOperations;\n\t}\n\n\tpublic List<Task> findAll(String username) {\n\t\treturn jdbcOperations.query(\n\t\t\t\t\"SELECT id, username, title, detail, deadline, finished, created_at, updated_at, version FROM tasks WHERE username = :username ORDER BY deadline DESC, id DESC\",\n\t\t\t\tnew MapSqlParameterSource(\"username\", username), new BeanPropertyRowMapper<>(Task.class));\n\t}\n\n\tpublic Task findOne(long id) {\n\t\treturn jdbcOperations.queryForObject(\n\t\t\t\t\"SELECT id, username, title, detail, deadline, finished, created_at, updated_at, version FROM tasks WHERE id = :id\",\n\t\t\t\tnew MapSqlParameterSource(\"id\", id), new BeanPropertyRowMapper<>(Task.class));\n\t}\n\n\tpublic void save(Task task) {\n\t\tif (task.getId() == null) {\n\t\t\tGeneratedKeyHolder holder = new GeneratedKeyHolder();\n\t\t\tjdbcOperations.update(\n\t\t\t\t\t\"INSERT INTO tasks (username, title, detail, deadline, finished) VALUES(:username, :title, :detail, :deadline, :finished)\",\n\t\t\t\t\tnew BeanPropertySqlParameterSource(task), holder);\n\t\t\ttask.setId(holder.getKey().longValue());\n\t\t} else {\n\t\t\tjdbcOperations.update(\n\t\t\t\t\t\"UPDATE tasks SET title = :title, detail = :detail, deadline = :deadline, finished = :finished, updated_at = SYSTIMESTAMP, version = version + 1 WHERE id = :id\",\n\t\t\t\t\tnew BeanPropertySqlParameterSource(task));\n\t\t}\n\t}\n\n\tpublic void remove(long id) {\n\t\tjdbcOperations.update(\"DELETE FROM tasks WHERE id = :id\", new MapSqlParameterSource(\"id\", id));\n\t}\n\n}\n```\n\n## RestController(REST API)\u306e\u4f5c\u6210\n\n\u30bf\u30b9\u30af\u60c5\u5831\u306b\u5bfe\u3059\u308bCRUD\u64cd\u4f5c(REST API)\u3092\u63d0\u4f9b\u3059\u308bController\u30af\u30e9\u30b9\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002`JdbcTemplate`\u4f7f\u7528\u6642\u306b\u5bfe\u8c61\u30c7\u30fc\u30bf\u304c\u898b\u3064\u304b\u3089\u306a\u3044\u3068`EmptyResultDataAccessException`\u304c\u767a\u751f\u3059\u308b\u305f\u3081\u3001REST API\u7528\u306eHandler\u30e1\u30bd\u30c3\u30c9\u306b\u52a0\u3048\u3001`EmptyResultDataAccessException`\u3092\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0\u3057\u3066404 Not Found\u3092\u8fd4\u5374\u3059\u308b\u305f\u3081\u306e\u4f8b\u5916\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0\u30e1\u30bd\u30c3\u30c9\u3082\u5b9f\u88c5\u3057\u307e\u3059\u3002\n\n```java:service-provider/src/main/java/com/example/TaskRestController.java\npackage com.example;\n\nimport static org.springframework.web.servlet.mvc.method.annotation.MvcUriComponentsBuilder.on;\nimport static org.springframework.web.servlet.mvc.method.annotation.MvcUriComponentsBuilder.relativeTo;\n\nimport java.net.URI;\nimport java.security.Principal;\nimport java.util.List;\nimport java.util.Optional;\n\nimport org.springframework.dao.EmptyResultDataAccessException;\nimport org.springframework.http.HttpStatus;\nimport org.springframework.http.ResponseEntity;\nimport org.springframework.web.bind.annotation.DeleteMapping;\nimport org.springframework.web.bind.annotation.ExceptionHandler;\nimport org.springframework.web.bind.annotation.GetMapping;\nimport org.springframework.web.bind.annotation.PathVariable;\nimport org.springframework.web.bind.annotation.PostMapping;\nimport org.springframework.web.bind.annotation.PutMapping;\nimport org.springframework.web.bind.annotation.RequestBody;\nimport org.springframework.web.bind.annotation.RequestMapping;\nimport org.springframework.web.bind.annotation.ResponseStatus;\nimport org.springframework.web.bind.annotation.RestController;\nimport org.springframework.web.util.UriComponentsBuilder;\n\n@RequestMapping(\"/api/tasks\")\n@RestController\npublic class TaskRestController {\n\n\tprivate final TaskRepository repository;\n\n\tTaskRestController(TaskRepository repository) {\n\t\tthis.repository = repository;\n\t}\n\n\t@GetMapping\n\tList<Task> getTasks(Principal principal) {\n\t\treturn repository.findAll(extractUsername(principal));\n\t}\n\n\t@PostMapping\n\tResponseEntity<Void> postTask(@RequestBody Task task, Principal principal, UriComponentsBuilder uriBuilder) {\n\t\ttask.setUsername(extractUsername(principal));\n\t\trepository.save(task);\n\t\tURI createdTaskUri = relativeTo(uriBuilder).withMethodCall(on(TaskRestController.class).getTask(task.getId()))\n\t\t\t\t.build().encode().toUri();\n\t\treturn ResponseEntity.created(createdTaskUri).build();\n\t}\n\n\t@GetMapping(\"{id}\")\n\tTask getTask(@PathVariable long id) {\n\t\treturn repository.findOne(id);\n\t}\n\n\t@PutMapping(\"{id}\")\n\t@ResponseStatus(HttpStatus.NO_CONTENT)\n\tvoid putTask(@PathVariable long id, @RequestBody Task task) {\n\t\ttask.setId(id);\n\t\trepository.save(task);\n\t}\n\n\t@DeleteMapping(\"{id}\")\n\t@ResponseStatus(HttpStatus.NO_CONTENT)\n\tvoid deleteTask(@PathVariable long id) {\n\t\trepository.remove(id);\n\t}\n\n\tprivate String extractUsername(Principal principal) {\n\t\treturn Optional.ofNullable(principal).map(Principal::getName).orElse(\"none\");\n\t}\n\n\t@ExceptionHandler(EmptyResultDataAccessException.class)\n\t@ResponseStatus(HttpStatus.NOT_FOUND)\n\tvoid handleEmptyResultDataAccessException() {\n\t\t// NOP\n\t}\n\n}\n```\n\n## REST API\u306e\u52d5\u4f5c\u78ba\u8a8d\n\n\u4f5c\u6210\u3057\u305fREST API\u304c\u6b63\u3057\u304f\u52d5\u4f5c\u3059\u308b\u304b\u78ba\u8a8d\u3057\u3066\u307f\u307e\u3059\u3002\n\n### Service Provider\u306e\u8d77\u52d5\n\nSpring Boot\u304c\u63d0\u4f9b\u3057\u3066\u3044\u308bMaven Plugin\u3092\u4f7f\u7528\u3057\u3066\u3001Spring Boot\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u8d77\u52d5\u3057\u307e\u3059\u3002\n\n```\n$ ./mvnw -pl service-provider spring-boot:run\n```\n\n### \u300c\u30bf\u30b9\u30af\u60c5\u5831\u306e\u4e00\u89a7\u53d6\u5f97API\u300d\u306e\u547c\u3073\u51fa\u3057\n\n\u3067\u306f\u30fb\u30fb\u7121\u90aa\u6c17\u306b\u300c\u30bf\u30b9\u30af\u60c5\u5831\u306e\u4e00\u89a7\u53d6\u5f97API\u300d\u3092\u547c\u3073\u51fa\u3057\u3066\u307f\u307e\u3057\u3087\u3046\uff01\uff01\n\n```\n$ $ curl -D - -s http://localhost:18081/provider/api/tasks\nHTTP/1.1 401 \nX-Content-Type-Options: nosniff\nX-XSS-Protection: 1; mode=block\nCache-Control: no-cache, no-store, max-age=0, must-revalidate\nPragma: no-cache\nExpires: 0\nX-Frame-Options: DENY\nStrict-Transport-Security: max-age=31536000 ; includeSubDomains\nWWW-Authenticate: Basic realm=\"Spring\"\nContent-Type: application/json;charset=UTF-8\nTransfer-Encoding: chunked\nDate: Sat, 25 Feb 2017 01:53:04 GMT\n\n{\"timestamp\":1487987584305,\"status\":401,\"error\":\"Unauthorized\",\"message\":\"Full authentication is required to access this resource\",\"path\":\"/provider/api/tasks\"}\n```\n\n\u3069\u3046\u3084\u3089Basic\u8a8d\u8a3c\u304c\u5fc5\u8981\u307f\u305f\u3044\u3067\u3059\u306d\u3002\n\u3053\u308c\u306f\u3001Spring Boot\u306eAutoConfigure\u304cSpring Security\u306e\u30af\u30e9\u30b9\u3092\u307f\u3064\u3051\u308b\u3068\u30fb\u30fb\u30fb\u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u5168\u3066\u306e\u30ea\u30af\u30a8\u30b9\u30c8\u30d1\u30b9\uff08`/**`\uff09\u306bBasic\u8a8d\u8a3c\u3092\u8981\u6c42\u3059\u308b\u4ed5\u7d44\u307f\u306b\u306a\u3063\u3066\u3044\u308b\u305f\u3081\u3067\u3059\u3002\n\u4eca\u306fREST API\u306e\u52d5\u4f5c\u78ba\u8a8d\u304c\u3057\u305f\u3044\u306e\u3067\u3001\u3044\u3063\u305f\u3093Basic\u8a8d\u8a3c\u3092\u7121\u52b9\u5316\u3057\u3066\u3057\u307e\u3044\u307e\u3057\u3087\u3046\u3002Spring Boot\u304c\u8981\u6c42\u3059\u308bBasic\u8a8d\u8a3c\u306f\u3001`security.basic.enabled=false`\u3068\u3044\u3046\u8a2d\u5b9a\u3092\u8ffd\u52a0\u3059\u308b\u3053\u3068\u3067\u7121\u52b9\u5316\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n```properties:service-provider/src/main/resources/application.properties\nsecurity.basic.enabled=false\n```\n\n> **Warning:**\n>\n> **REST API\u306e\u52d5\u4f5c\u78ba\u8a8d\u304c\u7d42\u308f\u3063\u305f\u3089Basic\u8a8d\u8a3c\u3092\u6709\u52b9\u5316\u3057\u3066\u304f\u3060\u3055\u3044\uff01\uff01**\n\nBasic\u8a8d\u8a3c\u3092\u7121\u52b9\u5316\u3057\u305f\u5f8c\u306bREST API\u306b\u30a2\u30af\u30bb\u30b9\u3059\u308b\u3068\u3001\u7a7a\u306e\u30bf\u30b9\u30af\u4e00\u89a7\u304c\u53d6\u5f97\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3057\u305f\u3002\n\n```\n$ curl -D - -s http://localhost:18081/api/tasks\nHTTP/1.1 200 \nContent-Type: application/json;charset=UTF-8\nTransfer-Encoding: chunked\nDate: Sat, 25 Feb 2017 02:01:57 GMT\n\n[]\n```\n\n### \u300c\u30bf\u30b9\u30af\u60c5\u5831\u306e\u4f5c\u6210API\u300d\u306e\u547c\u3073\u51fa\u3057\n\n\u8d77\u52d5\u76f4\u5f8c\u3067\u30bf\u30b9\u30af\u60c5\u5831\u304c\uff11\u4ef6\u3082\u767b\u9332\u3055\u308c\u3066\u306a\u3044\u306e\u3067\u3001\u300c\u30bf\u30b9\u30af\u60c5\u5831\u306e\u4f5c\u6210API\u300d\u3092\u547c\u3073\u51fa\u3057\u3066\u30bf\u30b9\u30af\u60c5\u5831\u3092\u4f5c\u6210\u3057\u3066\u307f\u307e\u3057\u3087\u3046\u3002\n\n```\n$ curl -D - -s http://localhost:18081/provider/api/tasks -H \"Content-Type: application/json\" -X POST -d '{\"title\":\"Test Title\",\"detail\":\"Test Detail\",\"deadline\":\"2017-02-28\"}'\nHTTP/1.1 201 \nLocation: http://localhost:18081/provider/api/tasks/1\nContent-Length: 0\nDate: Sat, 25 Feb 2017 02:17:37 GMT\n\n```\n\n\u30bf\u30b9\u30af\u60c5\u5831\u306e\u4f5c\u6210\u306b\u6210\u529f\u3059\u308b\u3068\u3001`Location`\u30d8\u30c3\u30c0\u306b\u4f5c\u6210\u3057\u305f\u30bf\u30b9\u30af\u60c5\u5831\u306b\u30a2\u30af\u30bb\u30b9\u3059\u308b\u305f\u3081\u306eURL\u304c\u8a2d\u5b9a\u3055\u308c\u307e\u3059\u3002\n\n\n### \u300c\u30bf\u30b9\u30af\u60c5\u5831\u306e\u53d6\u5f97API\u300d\u306e\u547c\u3073\u51fa\u3057\n\n\u300c\u30bf\u30b9\u30af\u60c5\u5831\u306e\u53d6\u5f97API\u300d\u3092\u547c\u3073\u51fa\u3057\u3066(`Location`\u30d8\u30c3\u30c0\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308bURL\u306b\u30a2\u30af\u30bb\u30b9\u3057\u3066)\u3001\u4f5c\u6210\u3057\u305f\u30bf\u30b9\u30af\u60c5\u5831\u3092\u53d6\u5f97\u3057\u3066\u307f\u307e\u3057\u3087\u3046\u3002\n\n```\n$ curl -D - -s http://localhost:18081/provider/api/tasks/1\nHTTP/1.1 200 \nContent-Type: application/json;charset=UTF-8\nTransfer-Encoding: chunked\nDate: Sat, 25 Feb 2017 02:29:12 GMT\n\n{\"id\":1,\"username\":\"none\",\"title\":\"Test Title\",\"detail\":\"Test Detail\",\"deadline\":[2017,2,28],\"finished\":false,\"createdAt\":[2017,2,25,11,17,37,671000000],\"updatedAt\":[2017,2,25,11,17,37,671000000],\"version\":1}\n```\n\n\u306a\u306b\u3084\u3089\u30bf\u30b9\u30af\u60c5\u5831\u304c\u53d6\u5f97\u3067\u304d\u307e\u3057\u305f\u304c\u30fb\u30fb\u30fb\u65e5\u4ed8\u30fb\u65e5\u6642\u306e\u3068\u3053\u308d\u306e\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u304c\u3061\u3087\u3063\u3068\u6b8b\u5ff5\u306a\u611f\u3058\u306a\u306e\u3067\u3001\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u6e08\u307f\u306e\u5024\u304c\u51fa\u529b\u3055\u308c\u308b\u3088\u3046\u306b\u3057\u3066\u307f\u307e\u3057\u3087\u3046\u3002\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u6e08\u307f\u306e\u65e5\u4ed8\u30fb\u65e5\u6642\u3092\u51fa\u529b\u3057\u305f\u3044\u5834\u5408\u306f\u3001`spring.jackson.serialization.write-dates-as-timestamps=false`\u3092\u8a2d\u5b9a\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n```properties:service-provider/src/main/resources/application.properties\nspring.jackson.serialization.write-dates-as-timestamps=false\n```\n\n`spring.jackson.serialization.write-dates-as-timestamps=false`\u3092\u8a2d\u5b9a\u3057\u305f\u5f8c\u306b\u518d\u5ea6\u30a2\u30af\u30bb\u30b9\u3059\u308b\u3068\u3001\u305d\u308c\u3063\u307d\u3044\u5f62\u5f0f\u306b\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u304c\u78ba\u8a8d\u3067\u304d\u307e\u3059\u3002\n\n```\n$ curl -D - -s http://localhost:18081/provider/api/tasks/1\nHTTP/1.1 200 \nContent-Type: application/json;charset=UTF-8\nTransfer-Encoding: chunked\nDate: Sat, 25 Feb 2017 02:31:13 GMT\n\n{\"id\":1,\"username\":\"none\",\"title\":\"Test Title\",\"detail\":\"Test Detail\",\"deadline\":\"2017-02-28\",\"finished\":false,\"createdAt\":\"2017-02-25T11:17:37.671\",\"updatedAt\":\"2017-02-25T11:17:37.671\",\"version\":1}\n```\n\n### \u300c\u30bf\u30b9\u30af\u60c5\u5831\u306e\u66f4\u65b0API\u300d\u306e\u547c\u3073\u51fa\u3057\n\n\u305b\u3063\u304b\u304f\u306a\u306e\u3067\u30fb\u30fb\u30fb\u300c\u30bf\u30b9\u30af\u60c5\u5831\u306e\u66f4\u65b0API\u300d\u3092\u547c\u3073\u51fa\u3057\u3066\u3001\u30bf\u30b9\u30af\u60c5\u5831\u3092\u66f4\u65b0\u3057\u3066\u307f\u307e\u3059\u3002\n\n```\n$ curl -D - -s http://localhost:18081/provider/api/tasks/1 -H \"Content-Type: application/json\" -X PUT -d '{\"title\":\"Test Title(Edit)\",\"detail\":\"Test Detail(Edit)\",\"deadline\":\"2017-03-31\"}'\nHTTP/1.1 204 \nDate: Sat, 25 Feb 2017 02:33:58 GMT\n\n```\n\n\u66f4\u65b0\u3057\u305f\u30bf\u30b9\u30af\u60c5\u5831\u3092\u53d6\u5f97\u3059\u308b\u3068\u3001\u6b63\u3057\u304f\u66f4\u65b0\u3067\u304d\u3066\u3044\u308b\u3053\u3068\u304c\u78ba\u8a8d\u3067\u304d\u307e\u3059\u3002\n\n```\n$ curl -D - -s http://localhost:18081/provider/api/tasks/1\nHTTP/1.1 200 \nContent-Type: application/json;charset=UTF-8\nTransfer-Encoding: chunked\nDate: Sat, 25 Feb 2017 02:34:21 GMT\n\n{\"id\":1,\"username\":\"none\",\"title\":\"Test Title(Edit)\",\"detail\":\"Test Detail(Edit)\",\"deadline\":\"2017-03-31\",\"finished\":false,\"createdAt\":\"2017-02-25T11:17:37.671\",\"updatedAt\":\"2017-02-25T11:33:58.51\",\"version\":2}\n```\n\n### \u300c\u30bf\u30b9\u30af\u60c5\u5831\u306e\u524a\u9664API\u300d\u306e\u547c\u3073\u51fa\u3057\n\n\u6700\u5f8c\u306e\u300c\u30bf\u30b9\u30af\u60c5\u5831\u306e\u524a\u9664API\u300d\u3092\u547c\u3073\u51fa\u3057\u3001\u4f5c\u6210\u3057\u305f\u30bf\u30b9\u30af\u60c5\u5831\u3092\u524a\u9664\u3057\u3066\u307f\u307e\u3059\u3002\n\n```\n$ curl -D - -s http://localhost:18081/provider/api/tasks/1 -X DELETE\nHTTP/1.1 204 \nDate: Sat, 25 Feb 2017 02:35:20 GMT\n\n```\n\n\u524a\u9664\u3057\u305f\u30bf\u30b9\u30af\u60c5\u5831\u3092\u53d6\u5f97\u3057\u3088\u3046\u3068\u3059\u308b\u3068\u3001\u5bfe\u8c61\u30c7\u30fc\u30bf\u304c\u306a\u3044\u3053\u3068\u3092\u901a\u77e5\u3059\u308b\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u30a8\u30e9\u30fc\uff08404: Not Found\uff09\u3057\u307e\u3059\u3002\n\n```\n$ curl -D - -s http://localhost:18081/provider/api/tasks/1\nHTTP/1.1 404 \nContent-Length: 0\nDate: Sat, 25 Feb 2017 02:35:37 GMT\n\n```\n\n## \u8a8d\u53ef\u30b5\u30fc\u30d0\u306e\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\n\n\u30b3\u30f3\u30d5\u30a3\u30ae\u30e5\u30ec\u30fc\u30b7\u30e7\u30f3\u30af\u30e9\u30b9\u306b`@EnableAuthorizationServer`\u3092\u4ed8\u4e0e\u3057\u3066\u3001OAuth\u306e\u8a8d\u8a3c\u30fb\u8a8d\u53ef\u306b\u5fc5\u8981\u306aBean\u5b9a\u7fa9\u3092\u884c\u3044\u3001\u8a8d\u53ef\u30b5\u30fc\u30d0\u4e0a\u306b\u300c\u8a8d\u53ef\u30a8\u30f3\u30c9\u30dd\u30a4\u30f3\u30c8\u300d\u3068\u300c\u30c8\u30fc\u30af\u30f3\u30a8\u30f3\u30c9\u30dd\u30a4\u30f3\u30c8\u300d\u3092\u516c\u958b\u3057\u307e\u3059\u3002\n\n```java:service-provider/src/main/java/com/example/AuthorizationServerConfiguration.java\npackage com.example;\n\nimport org.springframework.context.annotation.Configuration;\nimport org.springframework.security.oauth2.config.annotation.web.configuration.EnableAuthorizationServer;\n\n@EnableAuthorizationServer\n@Configuration\npublic class AuthorizationServerConfiguration {\n}\n```\n\n\u307e\u305f\u3001Spring Boot\u306e\u30c7\u30d5\u30a9\u30eb\u30c8\u3060\u3068\u4ee5\u4e0b\u306e\u5024\u304c\u8d77\u52d5\u6642\u306b\u30e9\u30f3\u30c0\u30e0\u306b\u5272\u308a\u5f53\u3066\u3089\u308c\u308b\u305f\u3081\u3001\u56fa\u5b9a\u5024\u3092\u8a2d\u5b9a\u3059\u308b\u3088\u3046\u306b\u3057\u307e\u3059\u3002\n\n* \u30c7\u30d5\u30a9\u30eb\u30c8\u30e6\u30fc\u30b6(`user`)\u306e\u30d1\u30b9\u30ef\u30fc\u30c9\n* \u30c7\u30d5\u30a9\u30eb\u30c8\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u306e\u30af\u30e9\u30a4\u30a2\u30f3\u30c8ID\n* \u30c7\u30d5\u30a9\u30eb\u30c8\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u306e\u30b7\u30fc\u30af\u30ec\u30c3\u30c8\n\n```properties:service-provider/src/main/resources/application.properties\nsecurity.user.password=password\nsecurity.oauth2.client.client-id=client\nsecurity.oauth2.client.client-secret=secret\n```\n\n\u3055\u3089\u306b\u3001\u30c7\u30d5\u30a9\u30eb\u30c8\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u304c\u6271\u3048\u308b\u30b9\u30b3\u30fc\u30d7\u3068\u30b0\u30e9\u30f3\u30c8\u30bf\u30a4\u30d7\u306e\u6307\u5b9a\u3082\u884c\u3044\u307e\u3057\u3087\u3046\u3002\u300cpassowrd:\u30ea\u30bd\u30fc\u30b9\u30aa\u30fc\u30ca\u30d1\u30b9\u30ef\u30fc\u30c9\u30af\u30ec\u30c7\u30f3\u30b7\u30e3\u30eb\u300d\u306f\u672c\u6765\u3067\u3042\u308c\u3070\u4e0d\u8981\u306a\u306e\u3067\u3059\u304c\u3001CUI(cURL\u30b3\u30de\u30f3\u30c9)\u3092\u4f7f\u7528\u3057\u3066\u8a8d\u53ef\u30b5\u30fc\u30d0\u3068\u30ea\u30bd\u30fc\u30b9\u30b5\u30fc\u30d0\u306e\u52d5\u4f5c\u78ba\u8a8d\u3092\u884c\u3046\u305f\u3081\u306b\u6307\u5b9a\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n\n```properties:service-provider/src/main/resources/application.properties\nsecurity.oauth2.client.scope=read,write\nsecurity.oauth2.client.authorized-grant-types=authorization_code,password\n```\n\n\u3053\u306e\u72b6\u614b\u3067Service Provider\u3092\u8d77\u52d5\u3059\u308b\u3068\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u30ed\u30b0\u304c\u51fa\u529b\u3055\u308c\u3001\u8a8d\u53ef\u30b5\u30fc\u30d0\u306bOAuth\u7528\u306e\u30a8\u30f3\u30c9\u30dd\u30a4\u30f3\u30c8\u304c\u516c\u958b\u3055\u308c\u305f\u3053\u3068\u304c\u308f\u304b\u308a\u307e\u3059\u3002\n\n```\n...\n2017-02-25 13:41:48.269  INFO 75893 --- [           main] .s.o.p.e.FrameworkEndpointHandlerMapping : Mapped \"{[/oauth/authorize]}\" onto public org.springframework.web.servlet.ModelAndView org.springframework.security.oauth2.provider.endpoint.AuthorizationEndpoint.authorize(java.util.Map<java.lang.String, java.lang.Object>,java.util.Map<java.lang.String, java.lang.String>,org.springframework.web.bind.support.SessionStatus,java.security.Principal)\n2017-02-25 13:41:48.270  INFO 75893 --- [           main] .s.o.p.e.FrameworkEndpointHandlerMapping : Mapped \"{[/oauth/authorize],methods=[POST],params=[user_oauth_approval]}\" onto public org.springframework.web.servlet.View org.springframework.security.oauth2.provider.endpoint.AuthorizationEndpoint.approveOrDeny(java.util.Map<java.lang.String, java.lang.String>,java.util.Map<java.lang.String, ?>,org.springframework.web.bind.support.SessionStatus,java.security.Principal)\n2017-02-25 13:41:48.271  INFO 75893 --- [           main] .s.o.p.e.FrameworkEndpointHandlerMapping : Mapped \"{[/oauth/token],methods=[GET]}\" onto public org.springframework.http.ResponseEntity<org.springframework.security.oauth2.common.OAuth2AccessToken> org.springframework.security.oauth2.provider.endpoint.TokenEndpoint.getAccessToken(java.security.Principal,java.util.Map<java.lang.String, java.lang.String>) throws org.springframework.web.HttpRequestMethodNotSupportedException\n2017-02-25 13:41:48.271  INFO 75893 --- [           main] .s.o.p.e.FrameworkEndpointHandlerMapping : Mapped \"{[/oauth/token],methods=[POST]}\" onto public org.springframework.http.ResponseEntity<org.springframework.security.oauth2.common.OAuth2AccessToken> org.springframework.security.oauth2.provider.endpoint.TokenEndpoint.postAccessToken(java.security.Principal,java.util.Map<java.lang.String, java.lang.String>) throws org.springframework.web.HttpRequestMethodNotSupportedException\n2017-02-25 13:41:48.272  INFO 75893 --- [           main] .s.o.p.e.FrameworkEndpointHandlerMapping : Mapped \"{[/oauth/check_token]}\" onto public java.util.Map<java.lang.String, ?> org.springframework.security.oauth2.provider.endpoint.CheckTokenEndpoint.checkToken(java.lang.String)\n2017-02-25 13:41:48.273  INFO 75893 --- [           main] .s.o.p.e.FrameworkEndpointHandlerMapping : Mapped \"{[/oauth/confirm_access]}\" onto public org.springframework.web.servlet.ModelAndView org.springframework.security.oauth2.provider.endpoint.WhitelabelApprovalEndpoint.getAccessConfirmation(java.util.Map<java.lang.String, java.lang.Object>,javax.servlet.http.HttpServletRequest) throws java.lang.Exception\n2017-02-25 13:41:48.290  INFO 75893 --- [           main] .s.o.p.e.FrameworkEndpointHandlerMapping : Mapped \"{[/oauth/error]}\" onto public org.springframework.web.servlet.ModelAndView org.springframework.security.oauth2.provider.endpoint.WhitelabelErrorEndpoint.handleError(javax.servlet.http.HttpServletRequest)\n...\n```\n\n## \u30ea\u30bd\u30fc\u30b9\u30b5\u30fc\u30d0\u306e\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\n\n\u30b3\u30f3\u30d5\u30a3\u30ae\u30e5\u30ec\u30fc\u30b7\u30e7\u30f3\u30af\u30e9\u30b9\u306b`@EnableAuthorizationServer`\u3092\u4ed8\u4e0e\u3057\u3066\u3001OAuth\u306e\u8a8d\u8a3c\u30fb\u8a8d\u53ef\u306b\u5fc5\u8981\u306aBean\u5b9a\u7fa9\u3092\u884c\u3044\u3001`ResourceServerConfigurerAdapter`\u306e`configure(HttpSecurity)`\u3092\u30aa\u30fc\u30d0\u30fc\u30e9\u30a4\u30c9\u3057\u3066REST API\u3078\u306e\u8a8d\u53ef\u8a2d\u5b9a\u3092\u884c\u3044\u307e\u3059\u3002\n\n```java:service-provider/src/main/java/com/example/ResourceServerConfiguration.java\npackage com.example;\n\nimport org.springframework.context.annotation.Configuration;\nimport org.springframework.http.HttpMethod;\nimport org.springframework.security.config.annotation.web.builders.HttpSecurity;\nimport org.springframework.security.config.http.SessionCreationPolicy;\nimport org.springframework.security.oauth2.config.annotation.web.configuration.EnableResourceServer;\nimport org.springframework.security.oauth2.config.annotation.web.configuration.ResourceServerConfigurerAdapter;\n\n@EnableResourceServer\n@Configuration\npublic class ResourceServerConfiguration extends ResourceServerConfigurerAdapter {\n\t@Override\n\tpublic void configure(HttpSecurity http) throws Exception {\n\t\thttp.antMatcher(\"/api/**\")\n\t\t\t.authorizeRequests()\n\t\t\t.antMatchers(HttpMethod.GET, \"/**\").access(\"#oauth2.hasScope('read')\")\n\t\t\t.antMatchers(HttpMethod.POST, \"/**\").access(\"#oauth2.hasScope('write')\")\n\t\t\t.antMatchers(HttpMethod.PUT, \"/**\").access(\"#oauth2.hasScope('write')\")\n\t\t\t.antMatchers(HttpMethod.DELETE, \"/**\").access(\"#oauth2.hasScope('write')\");\n\t}\n}\n```\n\n\u4e0a\u8a18\u8a2d\u5b9a\u3092\u884c\u3046\u3053\u3068\u3067\u3001`/api`\u914d\u4e0b\u3078\u306e\u30ea\u30af\u30a8\u30b9\u30c8\u306b\u5bfe\u3057\u3066OAuth\u306e\u8a8d\u8a3c\u30fb\u8a8d\u53ef\u3092\u9069\u7528\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n## \u8a8d\u53ef\u30fb\u30ea\u30bd\u30fc\u30b9\u30b5\u30fc\u30d0\u306e\u52d5\u4f5c\u78ba\u8a8d\n\n\u8a8d\u53ef\u30b5\u30fc\u30d0\u3068\u30ea\u30bd\u30fc\u30b9\u30b5\u30fc\u30d0\u306e\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\u304c\u7d42\u308f\u3063\u305f\u3068\u3053\u308d\u3067\u3001\u30ea\u30bd\u30fc\u30b9\u30b5\u30fc\u30d0\u306b\u30a2\u30af\u30bb\u30b9\u3057\u3066\u307f\u307e\u3057\u3087\u3046\u3002\n\n```\n$ curl -D - -s http://localhost:18081/provider/api/tasks\nHTTP/1.1 401 \nX-Content-Type-Options: nosniff\nX-XSS-Protection: 1; mode=block\nCache-Control: no-cache, no-store, max-age=0, must-revalidate\nPragma: no-cache\nExpires: 0\nX-Frame-Options: DENY\nCache-Control: no-store\nPragma: no-cache\nWWW-Authenticate: Bearer realm=\"oauth2-resource\", error=\"unauthorized\", error_description=\"Full authentication is required to access this resource\"\nContent-Type: application/json;charset=UTF-8\nTransfer-Encoding: chunked\nDate: Sat, 25 Feb 2017 09:39:55 GMT\n\n{\"error\":\"unauthorized\",\"error_description\":\"Full authentication is required to access this resource\"}\n```\n\n\u306a\u306b\u3084\u3089\u30a8\u30e9\u30fc\u306b\u306a\u308a\u307e\u3057\u305f\u3002\u30a8\u30e9\u30fc\u5185\u5bb9\u3092\u307f\u3066\u307f\u308b\u3068\u30fb\u30fb\u30fb\u8a8d\u8a3c\u30a8\u30e9\u30fc\uff08401 Unauthorized\uff09\u3068\u306a\u308a\u3001OAuth\u306eBearer\u30c8\u30fc\u30af\u30f3\u306b\u3088\u308b\u8a8d\u8a3c\u304c\u5fc5\u8981\u3067\u3042\u308b\u3053\u3068\u304c\u901a\u77e5\u3055\u308c\u3066\u3044\u307e\u3059\u3002\n\n### \u30a2\u30af\u30bb\u30b9\u30c8\u30fc\u30af\u30f3\u306e\u53d6\u5f97\n\n\u672c\u30a8\u30f3\u30c8\u30ea\u30fc\u306f\u300c\u8a8d\u53ef\u30b3\u30fc\u30c9\u30b0\u30e9\u30f3\u30c8\u300d\u3092\u4f7f\u7528\u3057\u3066\u30a2\u30af\u30bb\u30b9\u30c8\u30fc\u30af\u30f3\u3092\u53d6\u5f97\u3057\u3066REST API\u306b\u30a2\u30af\u30bb\u30b9\u3059\u308b\u65b9\u6cd5\u3092\u8aac\u660e\u3059\u308b\u306e\u304c\u6700\u7d42\u7684\u306a\u76ee\u7684\u3067\u3059\u304c\u3001\u307e\u305a\u306f\u30fb\u30fb\u30fb\u304a\u624b\u8efd\u306b\u30a2\u30af\u30bb\u30b9\u30c8\u30fc\u30af\u30f3\u3092\u53d6\u5f97\u3067\u304d\u308b\u300c\u30ea\u30bd\u30fc\u30b9\u30aa\u30fc\u30ca\u30fc\u30d1\u30b9\u30ef\u30fc\u30c9\u30af\u30ec\u30c7\u30f3\u30b7\u30e3\u30eb\u300d\u3092\u4f7f\u7528\u3057\u3066\u30bf\u30b9\u30af\u60c5\u5831\u306b\u30a2\u30af\u30bb\u30b9\u3059\u308b\u305f\u3081\u306e\u30a2\u30af\u30bb\u30b9\u30c8\u30fc\u30af\u30f3\u3092\u53d6\u5f97\u3057\u3066\u307f\u307e\u3057\u3087\u3046\u3002\n\n```\n$ curl -D - -s -u client:secret http://localhost:18081/provider/oauth/token -X POST -d grant_type=password -d username=user -d password=password\nHTTP/1.1 200 \nX-Content-Type-Options: nosniff\nX-XSS-Protection: 1; mode=block\nCache-Control: no-cache, no-store, max-age=0, must-revalidate\nPragma: no-cache\nExpires: 0\nX-Frame-Options: DENY\nContent-Type: application/json;charset=UTF-8\nTransfer-Encoding: chunked\nDate: Sat, 25 Feb 2017 14:08:39 GMT\n\n{\"access_token\":\"d2fbded0-b8f6-4c2d-bee5-6dd3cafc0097\",\"token_type\":\"bearer\",\"expires_in\":43138,\"scope\":\"read write\"}\n```\n\n### \u30ea\u30bd\u30fc\u30b9\u30b5\u30fc\u30d0\u3078\u306e\u30a2\u30af\u30bb\u30b9\n\n\u53d6\u5f97\u3057\u305f\u30a2\u30af\u30bb\u30b9\u30c8\u30fc\u30af\u30f3\u3092\u300cAuthorization\u300d\u30d8\u30c3\u30c0\u306b\u6307\u5b9a\u3057\u3066\u30ea\u30bd\u30fc\u30b9\u30b5\u30fc\u30d0\u3078\u518d\u5ea6\u30a2\u30af\u30bb\u30b9\u3057\u307e\u3057\u3087\u3046\u3002\n\n```\n$ curl -D - -s http://localhost:18081/provider/api/tasks -H \"Authorization: Bearer d2fbded0-b8f6-4c2d-bee5-6dd3cafc0097\"\nHTTP/1.1 200 \nX-Content-Type-Options: nosniff\nX-XSS-Protection: 1; mode=block\nCache-Control: no-cache, no-store, max-age=0, must-revalidate\nPragma: no-cache\nExpires: 0\nX-Frame-Options: DENY\nContent-Type: application/json;charset=UTF-8\nTransfer-Encoding: chunked\nDate: Sat, 25 Feb 2017 14:11:17 GMT\n\n[]\n```\n\n\u305b\u3063\u304b\u304f\u306a\u306e\u3067\u30fb\u30fb\u30fb\u65b0\u3057\u3044\u30bf\u30b9\u30af\u3092\u4f5c\u6210\u3057\u3001\u4f5c\u6210\u3057\u305f\u30bf\u30b9\u30af\u60c5\u5831\u3092\u53d6\u5f97\u3057\u3066\u307f\u307e\u3057\u3087\u3046\u3002\n\n```\n$ curl -D - -s http://localhost:18081/provider/api/tasks -H \"Authorization: Bearer d2fbded0-b8f6-4c2d-bee5-6dd3cafc0097\" -H \"Content-Type: application/json\" -X POST -d '{\"title\":\"Test Title\",\"detail\":\"Test Detail\",\"deadline\":\"2017-02-28\"}'\nHTTP/1.1 201 \nX-Content-Type-Options: nosniff\nX-XSS-Protection: 1; mode=block\nCache-Control: no-cache, no-store, max-age=0, must-revalidate\nPragma: no-cache\nExpires: 0\nX-Frame-Options: DENY\nLocation: http://localhost:18081/provider/api/tasks/6\nContent-Length: 0\nDate: Sat, 25 Feb 2017 15:24:40 GMT\n\n```\n\n```\n$ curl -D - -s http://localhost:18081/provider/api/tasks/6 -H \"Authorization: Bearer d2fbded0-b8f6-4c2d-bee5-6dd3cafc0097\"\nHTTP/1.1 200 \nX-Content-Type-Options: nosniff\nX-XSS-Protection: 1; mode=block\nCache-Control: no-cache, no-store, max-age=0, must-revalidate\nPragma: no-cache\nExpires: 0\nX-Frame-Options: DENY\nContent-Type: application/json;charset=UTF-8\nTransfer-Encoding: chunked\nDate: Sat, 25 Feb 2017 15:26:13 GMT\n\n{\"id\":6,\"username\":\"user\",\"title\":\"Test Title\",\"detail\":\"Test Detail\",\"deadline\":\"2017-02-28\",\"finished\":false,\"createdAt\":\"2017-02-26T00:24:40.843\",\"updatedAt\":\"2017-02-26T00:24:40.843\",\"version\":1}\n```\n\n# Client(Web UI)\u306e\u4f5c\u6210\n\nService Provider(\u8a8d\u53ef\u30b5\u30fc\u30d0\u3068\u30ea\u30bd\u30fc\u30b9\u30b5\u30fc\u30d0)\u306e\u4f5c\u6210\u304c\u7d42\u308f\u3063\u305f\u306e\u3067\u3001\u30ea\u30bd\u30fc\u30b9\u30b5\u30fc\u30d0\u3067\u7ba1\u7406\u3057\u3066\u3044\u308b\u30bf\u30b9\u30af\u60c5\u5831\u3092\u64cd\u4f5c\u3059\u308b\u305f\u3081\u306eWeb UI\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\n## Client\u306e\u30b5\u30fc\u30d0\u8a2d\u5b9a\n\n\u5192\u982d\u306e\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u69cb\u6210\u3067\u7d39\u4ecb\u3057\u305f\u901a\u308a\u3001Cleint\u306e\u30dd\u30fc\u30c8\u3092`18080`\u306b\u3001\u30b3\u30f3\u30c6\u30ad\u30b9\u30c8\u30d1\u30b9\u3092`/client`\u306b\u3057\u307e\u3059\u3002\n\n```properties:client/src/main/resources/application.properties\nserver.port=18080\nserver.context-path=/client\n```\n\n\u4eca\u56de\u306e\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3067\u306f\u3001Client\u5074\u306e\u30e6\u30fc\u30b6\u8a8d\u8a3c\u306fSpring Boot\u304c\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\u3057\u3066\u304f\u308c\u308bBasic\u8a8d\u8a3c\u3092\u4f7f\u7528\u3057\u307e\u3059\u3002\u30c7\u30d5\u30a9\u30eb\u30c8\u306e\u52d5\u4f5c\u3060\u3068\u8d77\u52d5\u6bce\u306b\u30c7\u30d5\u30a9\u30eb\u30c8\u30e6\u30fc\u30b6\u306e\u30d1\u30b9\u30ef\u30fc\u30c9\u304c\u304b\u308f\u308b\u306e\u3067\u3001\u30d1\u30b9\u30ef\u30fc\u30c9\u3092\u56fa\u5b9a\u5316\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n\n```properties:client/src/main/resources/application.properties\nsecurity.user.password=password\n```\n\n## Client\u306e\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\n\u30b3\u30f3\u30d5\u30a3\u30ae\u30e5\u30ec\u30fc\u30b7\u30e7\u30f3\u30af\u30e9\u30b9\u306b`@EnableOAuth2Client`\u3092\u4ed8\u4e0e\u3057\u3066\u3001\u30a2\u30af\u30bb\u30b9\u30c8\u30fc\u30af\u30f3\u3092\u7ba1\u7406\u3059\u308b\u30b3\u30f3\u30dd\u30fc\u30cd\u30f3\u30c8(`OAuth2ClientContext`)\u3084\u30ea\u30bd\u30fc\u30b9\u30aa\u30fc\u30ca\u304b\u3089\u306e\u8a8d\u53ef\u3092\u53d6\u5f97\u3059\u308b\u305f\u3081\u306b\u30e6\u30fc\u30b6\u30a8\u30fc\u30b8\u30a7\u30f3\u30c8(\u30d6\u30e9\u30a6\u30b6\uff09\u3092\u8a8d\u53ef\u30b5\u30fc\u30d0\u3078\u8a98\u5c0e\u3059\u308b\u305f\u3081\u306e\u30b3\u30f3\u30dd\u30fc\u30cd\u30f3\u30c8(`OAuth2ClientContextFilter`)\u306a\u3069\u3092Bean\u5b9a\u7fa9\u3057\u307e\u3059\u3002\u3055\u3089\u306b\u3001OAuth\u7528\u306b\u62e1\u5f35\u3055\u308c\u305f`RestTemplate`(`OAuth2RestTemplate`)\u306eBean\u5b9a\u7fa9\u3092\u884c\u3044\u307e\u3059\u3002`OAuth2RestTemplate`\u3092\u4f7f\u7528\u3059\u308b\u3068\u3001OAuth\u95a2\u9023\u306e\u51e6\u7406\uff08\u8a8d\u53ef\u30b5\u30fc\u30d0\u304b\u3089\u30a2\u30af\u30bb\u30b9\u30c8\u30fc\u30af\u30f3\u3092\u53d6\u5f97\u3059\u308b\u51e6\u7406\u306a\u3069\uff09\u3092\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u304c\u610f\u8b58\u3059\u308b\u5fc5\u8981\u304c\u306a\u304f\u306a\u308a\u3001OAuth\u306b\u3088\u308b\u8a8d\u8a3c\u30fb\u8a8d\u53ef\u3092\u884c\u308f\u306a\u3044\u6642\u3068\u540c\u3058\u3088\u3046\u306bREST API\u3092\u547c\u3073\u51fa\u3059\u3053\u3068\u304c\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\n\n\n```java:client/src/main/java/com/example/ClientConfiguration.java\npackage com.example;\n\nimport org.springframework.context.annotation.Bean;\nimport org.springframework.context.annotation.Configuration;\nimport org.springframework.security.oauth2.client.OAuth2ClientContext;\nimport org.springframework.security.oauth2.client.OAuth2RestTemplate;\nimport org.springframework.security.oauth2.client.resource.OAuth2ProtectedResourceDetails;\nimport org.springframework.security.oauth2.config.annotation.web.configuration.EnableOAuth2Client;\n\n@EnableOAuth2Client\n@Configuration\npublic class ClientConfiguration {\n\n\t@Bean\n\tOAuth2RestTemplate oauth2RestTemplate(OAuth2ClientContext context, OAuth2ProtectedResourceDetails details) {\n\t\treturn new OAuth2RestTemplate(details, context);\n\t}\n\n}\n```\n\n\u52a0\u3048\u3066\u3001OAuth\u95a2\u9023\uff08API\u306eURL\u3001\u8a8d\u53ef\u30b5\u30fc\u30d0\u306eURL\u3001\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u60c5\u5831\uff09\u306e\u8a2d\u5b9a\u3092\u8ffd\u52a0\u3057\u307e\u3059\u3002\n\n```properties:client/src/main/resources/application.properties\n# API\u306eURL\napi.url=http://localhost:18081/provider/api\n\n# \u8a8d\u53ef\u30b5\u30fc\u30d0\u306e\u30a8\u30f3\u30c9\u30dd\u30a4\u30f3\u30c8\u306eURL\nauth.url=http://localhost:18081/provider/oauth\nsecurity.oauth2.client.access-token-uri=${auth.url}/token\nsecurity.oauth2.client.user-authorization-uri=${auth.url}/authorize\n\n# \u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u60c5\u5831\u306e\u8a2d\u5b9a\nsecurity.oauth2.client.client-id=client\nsecurity.oauth2.client.client-secret=secret\nsecurity.oauth2.client.scope=read,write\n```\n\n> **Note:**\n>\n> Spring Boot\u306eAutoConfigure\u306e\u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u306f\u3001\u300c\u8a8d\u53ef\u30b3\u30fc\u30c9\u30b0\u30e9\u30f3\u30c8\u30d5\u30ed\u30fc\u300d\u3092\u4f7f\u7528\u3057\u3066\u30ea\u30bd\u30fc\u30b9\u30b5\u30fc\u30d0\u3078\u30a2\u30af\u30bb\u30b9\u3059\u308b\u3088\u3046\u306bBean\u5b9a\u7fa9\u3055\u308c\u307e\u3059\u3002\n\n## \u30c9\u30e1\u30a4\u30f3\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306e\u4f5c\u6210\n\nREST API\u3092\u4ecb\u3057\u3066\u64cd\u4f5c\u3059\u308b\u30bf\u30b9\u30af\u60c5\u5831\u3092\u4fdd\u6301\u3059\u308b\u30c9\u30e1\u30a4\u30f3\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\uff08Service Provider\u3092\u4f5c\u6210\u3057\u305f\u6642\u306b\u4f5c\u6210\u3057\u305f`Task`\u30af\u30e9\u30b9\u3092Client\u5074\u306b\u30b3\u30d4\u30fc\u3057\u3066\u304f\u3060\u3055\u3044\uff09\n\n```java:client/src/main/java/com/example/Task.java\npackage com.example;\n\nimport java.time.LocalDate;\nimport java.time.LocalDateTime;\n\npublic class Task {\n\n\tprivate long id;\n\tprivate String username;\n\tprivate String title;\n\tprivate String detail;\n\tprivate LocalDate deadline;\n\tprivate boolean finished;\n\tprivate LocalDateTime createdAt;\n\tprivate LocalDateTime updatedAt;\n\tprivate long version;\n\n\t// getter/setter\n\n}\n```\n\n## Repository\u306e\u4f5c\u6210\n\n\u30bf\u30b9\u30af\u60c5\u5831\u3092\u4fdd\u6301\u3059\u308b\u30c9\u30e1\u30a4\u30f3\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306eRepository\u30af\u30e9\u30b9\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\u3053\u306e\u30af\u30e9\u30b9\u3067\u306f\u3001Spring Security OAuth\u304c\u63d0\u4f9b\u3057\u3066\u3044\u308b`RestOperations`\u30a4\u30f3\u30bf\u30d5\u30a7\u30fc\u30b9\u306e\u5b9f\u88c5\u30af\u30e9\u30b9(`OAuth2RestTemplate`)\u306e\u30e1\u30bd\u30c3\u30c9\u3092\u4f7f\u7528\u3057\u3066\u3001\u30ea\u30bd\u30fc\u30b9\u30b5\u30fc\u30d0\u4e0a\u3067\u7ba1\u7406\u3057\u3066\u3044\u308b\u30bf\u30b9\u30af\u60c5\u5831\u306b\u30a2\u30af\u30bb\u30b9\u3057\u307e\u3059\u3002\n\n```java:client/src/main/java/com/example/TaskRepository.java\npackage com.example;\n\nimport java.util.Arrays;\nimport java.util.List;\n\nimport org.springframework.beans.factory.annotation.Value;\nimport org.springframework.stereotype.Repository;\nimport org.springframework.web.client.RestOperations;\n\n@Repository\npublic class TaskRepository {\n\n\tprivate final RestOperations restOperations;\n\tprivate final String resourcesUrl;\n\tprivate final String resourceUrlTemplate;\n\n\tTaskRepository(RestOperations restOperations,\n\t\t\t@Value(\"${api.url}/tasks\") String resourcesUrl) {\n\t\tthis.restOperations = restOperations;\n\t\tthis.resourcesUrl = resourcesUrl;\n\t\tthis.resourceUrlTemplate = resourcesUrl + \"/{id}\";\n\t}\n\n\tpublic List<Task> findAll() {\n\t\treturn Arrays.asList(restOperations.getForObject(resourcesUrl, Task[].class));\n\t}\n\n\tpublic Task findOne(long id) {\n\t\treturn restOperations.getForObject(resourceUrlTemplate, Task.class, id);\n\t}\n\n\tpublic void save(Task task) {\n\t\tif (task.getId() == null) {\n\t\t\trestOperations.postForLocation(resourcesUrl, task);\n\t\t} else {\n\t\t\trestOperations.put(resourceUrlTemplate, task, task.getId());\n\t\t}\n\t}\n\n\tpublic void remove(long id) {\n\t\trestOperations.delete(resourceUrlTemplate, id);\n\t}\n\n}\n```\n\n## Controller\u306e\u4f5c\u6210\n\n\u30bf\u30b9\u30af\u60c5\u5831\u306eCRUD\u64cd\u4f5c\u3092\u884c\u3046\u305f\u3081\u306eWeb UI\u3092\u63d0\u4f9b\u3059\u308bController\u30af\u30e9\u30b9\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\n```java:client/src/main/java/com/example/TaskController.java\npackage com.example;\n\nimport java.time.LocalDate;\nimport java.time.LocalDateTime;\nimport java.util.List;\n\nimport org.hibernate.validator.constraints.NotEmpty;\nimport org.springframework.beans.BeanUtils;\nimport org.springframework.format.annotation.DateTimeFormat;\nimport org.springframework.stereotype.Controller;\nimport org.springframework.ui.Model;\nimport org.springframework.validation.BindingResult;\nimport org.springframework.validation.annotation.Validated;\nimport org.springframework.web.bind.annotation.GetMapping;\nimport org.springframework.web.bind.annotation.ModelAttribute;\nimport org.springframework.web.bind.annotation.PathVariable;\nimport org.springframework.web.bind.annotation.PostMapping;\nimport org.springframework.web.bind.annotation.RequestMapping;\nimport org.springframework.web.servlet.mvc.support.RedirectAttributes;\n\n@RequestMapping(\"/tasks\")\n@Controller\npublic class TaskController {\n\n\tprivate final TaskRepository repository;\n\n\tTaskController(TaskRepository repository) {\n\t\tthis.repository = repository;\n\t}\n\n\t@ModelAttribute\n\tTaskForm setUpForm() {\n\t\treturn new TaskForm();\n\t}\n\n\t@GetMapping\n\tString list(Model model) {\n\t\tList<Task> taskList = repository.findAll();\n\t\tmodel.addAttribute(taskList);\n\t\treturn \"task/list\";\n\t}\n\n\t@PostMapping\n\tString create(@Validated TaskForm form, BindingResult bindingResult, Model model) {\n\t\tif (bindingResult.hasErrors()) {\n\t\t\treturn list(model);\n\t\t}\n\t\tTask task = new Task();\n\t\tBeanUtils.copyProperties(form, task);\n\t\trepository.save(task);\n\t\treturn \"redirect:/tasks\";\n\t}\n\n\t@GetMapping(\"{id}\")\n\tString detail(@PathVariable long id, TaskForm form, Model model) {\n\t\tTask task = repository.findOne(id);\n\t\tBeanUtils.copyProperties(task, form);\n\t\tmodel.addAttribute(task);\n\t\treturn \"task/detail\";\n\t}\n\n\t@PostMapping(path = \"{id}\", params = \"update\")\n\tString update(@PathVariable long id, @Validated TaskForm form, BindingResult bindingResult,\n\t\t\tModel model, RedirectAttributes redirectAttributes) {\n\t\tif (bindingResult.hasErrors()) {\n\t\t\treturn \"task/detail\";\n\t\t}\n\t\tTask task = new Task();\n\t\tBeanUtils.copyProperties(form, task);\n\t\trepository.save(task);\n\t\tredirectAttributes.addAttribute(\"id\", id);\n\t\treturn \"redirect:/tasks/{id}\";\n\t}\n\n\t@PostMapping(path = \"{id}\", params = \"delete\")\n\tString delete(@PathVariable long id) {\n\t\trepository.remove(id);\n\t\treturn \"redirect:/tasks\";\n\t}\n\n\tstatic class TaskForm {\n\t\tprivate static final String DATE_TIME_FORMAT = \"uuuu-MM-dd HH:mm:ss\";\n\n\t\tprivate Long id;\n\t\t@NotEmpty private String title;\n\t\tprivate String detail;\n\t\t@DateTimeFormat(iso = DateTimeFormat.ISO.DATE) private LocalDate deadline;\n\t\tprivate boolean finished;\n\t\t@DateTimeFormat(pattern = DATE_TIME_FORMAT) private LocalDateTime createdAt;\n\t\t@DateTimeFormat(pattern = DATE_TIME_FORMAT) private LocalDateTime updatedAt;\n\t\tprivate long version;\n\n\t\tpublic Long getId() {\n\t\t\treturn id;\n\t\t}\n\n\t\tpublic void setId(Long id) {\n\t\t\tthis.id = id;\n\t\t}\n\n\t\tpublic String getTitle() {\n\t\t\treturn title;\n\t\t}\n\n\t\tpublic void setTitle(String title) {\n\t\t\tthis.title = title;\n\t\t}\n\n\t\tpublic String getDetail() {\n\t\t\treturn detail;\n\t\t}\n\n\t\tpublic void setDetail(String detail) {\n\t\t\tthis.detail = detail;\n\t\t}\n\n\t\tpublic LocalDate getDeadline() {\n\t\t\treturn deadline;\n\t\t}\n\n\t\tpublic void setDeadline(LocalDate deadline) {\n\t\t\tthis.deadline = deadline;\n\t\t}\n\n\t\tpublic boolean isFinished() {\n\t\t\treturn finished;\n\t\t}\n\n\t\tpublic void setFinished(boolean finished) {\n\t\t\tthis.finished = finished;\n\t\t}\n\n\t\tpublic LocalDateTime getCreatedAt() {\n\t\t\treturn createdAt;\n\t\t}\n\n\t\tpublic void setCreatedAt(LocalDateTime createdAt) {\n\t\t\tthis.createdAt = createdAt;\n\t\t}\n\n\t\tpublic LocalDateTime getUpdatedAt() {\n\t\t\treturn updatedAt;\n\t\t}\n\n\t\tpublic void setUpdatedAt(LocalDateTime updatedAt) {\n\t\t\tthis.updatedAt = updatedAt;\n\t\t}\n\n\t\tpublic long getVersion() {\n\t\t\treturn version;\n\t\t}\n\n\t\tpublic void setVersion(long version) {\n\t\t\tthis.version = version;\n\t\t}\n\t}\n\n}\n```\n\n> **Note:**\n>\n> \u767b\u9332\u65e5\u6642(`createdAt`)\u3084\u66f4\u65b0\u65e5\u6642(`updatedAt`)\u306f\u5165\u529b\u9805\u76ee\u3067\u306f\u306a\u3044\u306e\u3067\u30d5\u30a9\u30fc\u30e0\u306e\u9805\u76ee\u3068\u3057\u3066\u4fdd\u6301\u3059\u3079\u304d\u3067\u306f\u3042\u308a\u307e\u305b\u3093\u304c\u3001\u5165\u529b\u30c1\u30a7\u30c3\u30af\u30a8\u30e9\u30fc\u304c\u51fa\u308b\u305f\u3073\u306b\u30ea\u30bd\u30fc\u30b9\u30b5\u30fc\u30d0\u304b\u3089\u30bf\u30b9\u30af\u60c5\u5831\u3092\u53d6\u5f97\u3059\u308b\u306e\u3082\u5fae\u5999\u306a\u306e\u3067\u3001\u3061\u3087\u3063\u3068\u4e71\u66b4\u3067\u3059\u304c\u4eca\u56de\u306f\u30d5\u30a9\u30fc\u30e0\u306e\u9805\u76ee\u306b\u542b\u3081\u3066\u3057\u307e\u3044\u307e\u3059\u3002\n\n## \u30bf\u30b9\u30af\u4e00\u89a7\u753b\u9762\u306e\u4f5c\u6210\n\n\u30ea\u30bd\u30fc\u30b9\u30b5\u30fc\u30d0\u304b\u3089\u53d6\u5f97\u3057\u305f\u30bf\u30b9\u30af\u4e00\u89a7\u3092\u8868\u793a\u3057\u3001\u65b0\u3057\u3044\u30bf\u30b9\u30af\u60c5\u5831\u3092\u4f5c\u6210\u3059\u308b\u305f\u3081\u306eWeb UI\u3092\u63d0\u4f9b\u3057\u307e\u3059\u3002\n\n```html:client/src/main/resources/templates/task/list.html\n<!DOCTYPE html>\n<html xmlns=\"http://www.w3.org/1999/xhtml\"\n      xmlns:th=\"http://www.thymeleaf.org\">\n<head>\n    <meta http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-8\"/>\n    <title>Task List</title>\n    <link rel=\"stylesheet\" href=\"https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.css\" type=\"text/css\"\n          th:href=\"@{/webjars/bootstrap/css/bootstrap.css}\"/>\n    <style type=\"text/css\">\n        .strike {\n            text-decoration: line-through;\n        }\n    </style>\n</head>\n<body>\n\n<div class=\"container\">\n\n    <h1>Task List</h1>\n\n    <div id=\"taskForm\">\n        <form action=\"list.html\" method=\"post\" class=\"form-horizontal\"\n              th:action=\"@{/tasks}\" th:object=\"${taskForm}\">\n            <div class=\"form-group\">\n                <label for=\"title\" class=\"col-sm-1 control-label\">Title</label>\n                <div class=\"col-sm-10\">\n                    <input type=\"text\" class=\"form-control\" id=\"title\" th:field=\"*{title}\"/>\n                    <span class=\"text-error\" th:errors=\"*{title}\">error message</span>\n                </div>\n            </div>\n            <div class=\"form-group\">\n                <label for=\"detail\" class=\"col-sm-1 control-label\">Detail</label>\n                <div class=\"col-sm-10\">\n                    <textarea class=\"form-control\" id=\"detail\" th:field=\"*{detail}\">\n                    </textarea>\n                    <span class=\"text-error\" th:errors=\"*{detail}\">error message</span>\n                </div>\n            </div>\n            <div class=\"form-group\">\n                <label for=\"detail\" class=\"col-sm-1 control-label\">Deadline</label>\n                <div class=\"col-sm-4\">\n                    <input type=\"date\" class=\"form-control\" id=\"detail\" th:field=\"*{deadline}\"/>\n                    <span class=\"text-error\" th:errors=\"*{deadline}\">error message</span>\n                </div>\n            </div>\n            <div class=\"form-group\">\n                <div class=\"col-sm-offset-1 col-sm-10\">\n                    <button type=\"submit\" class=\"btn btn-default\">Create</button>\n                </div>\n            </div>\n        </form>\n    </div>\n\n    <table id=\"todoList\" class=\"table table-hover\" th:if=\"${not #lists.isEmpty(taskList)}\">\n\n        <tr>\n            <th>#</th>\n            <th>Title</th>\n            <th>Deadline</th>\n            <th>Created Datetime</th>\n        </tr>\n\n        <tr th:each=\"task : ${taskList}\">\n            <td th:text=\"${taskStat.count}\">1</td>\n            <td>\n                <span th:class=\"${task.finished} ? 'strike'\">\n                    <a href=\"detail.html\"\n                       th:text=\"${task.title}\" th:href=\"@{/tasks/{id}(id=${task.id})}\">\n                        Create Sample Application\n                    </a>\n                </span>\n            </td>\n            <td>\n                <span th:text=\"${#temporals.format(task.deadline,'uuuu-MM-dd')}\" th:if=\"${task.deadline != null}\">2017-02-28</span>\n            </td>\n            <td>\n                <span th:text=\"${#temporals.format(task.createdAt,'uuuu-MM-dd HH:mm.ss')}\">2017-02-27 15:17:02</span>\n            </td>\n        </tr>\n\n    </table>\n\n</div>\n</body>\n</html>\n```\n\n## \u30bf\u30b9\u30af\u8a73\u7d30\u753b\u9762\u306e\u4f5c\u6210\n\n\u30ea\u30bd\u30fc\u30b9\u30b5\u30fc\u30d0\u304b\u3089\u53d6\u5f97\u3057\u305f\u30bf\u30b9\u30af\u60c5\u5831\u3092\u8868\u793a\u3057\u3001\u66f4\u65b0\u53ca\u3073\u524a\u9664\u3059\u308b\u305f\u3081\u306eWeb UI\u3092\u63d0\u4f9b\u3057\u307e\u3059\u3002\n\n```html:client/src/main/resources/templates/task/detail.html\n<!DOCTYPE html>\n<html xmlns=\"http://www.w3.org/1999/xhtml\"\n      xmlns:th=\"http://www.thymeleaf.org\">\n<head>\n    <meta http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-8\"/>\n    <title>Task Detail</title>\n    <link rel=\"stylesheet\" href=\"https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.css\" type=\"text/css\"\n          th:href=\"@{/webjars/bootstrap/css/bootstrap.css}\"/>\n</head>\n<body>\n\n<div class=\"container\">\n\n    <h1>Task Detail</h1>\n\n    <div id=\"taskForm\">\n        <form action=\"detail.html\" method=\"post\" class=\"form-horizontal\"\n              th:action=\"@{/tasks/{id}(id=*{id})}\" th:object=\"${taskForm}\">\n            <div class=\"form-group\">\n                <label for=\"title\" class=\"col-sm-2 control-label\">Title</label>\n                <div class=\"col-sm-10\">\n                    <input class=\"form-control\" id=\"title\" value=\"Create Sample Application\" th:field=\"*{title}\"/>\n                    <span class=\"text-error\" th:errors=\"*{title}\">error message</span>\n                </div>\n            </div>\n            <div class=\"form-group\">\n                <label for=\"detail\" class=\"col-sm-2 control-label\">Detail</label>\n                <div class=\"col-sm-10\">\n                    <textarea class=\"form-control\" id=\"detail\" th:field=\"*{detail}\">\n                    </textarea>\n                    <span class=\"text-error\" th:errors=\"*{detail}\">error message</span>\n                </div>\n            </div>\n            <div class=\"form-group\">\n                <label for=\"detail\" class=\"col-sm-2 control-label\">Deadline</label>\n                <div class=\"col-sm-4\">\n                    <input type=\"date\" class=\"form-control\" id=\"detail\" value=\"2017-03-10\" th:field=\"*{deadline}\"/>\n                    <span class=\"text-error\" th:errors=\"*{deadline}\">error message</span>\n                </div>\n            </div>\n            <div class=\"form-group\">\n                <label for=\"finished\" class=\"col-sm-2 control-label\">Finished ?</label>\n                <div class=\"col-sm-2\">\n                    <input type=\"checkbox\" id=\"finished\" th:field=\"*{finished}\"/>\n                </div>\n            </div>\n            <div class=\"form-group\">\n                <label for=\"createdAt\" class=\"col-sm-2 control-label\">Created Datetime</label>\n                <div class=\"col-sm-4\">\n                    <input id=\"createdAt\" class=\"form-control\" value=\"2017-02-28 15:00:01\" th:field=\"*{createdAt}\" readonly=\"readonly\"/>\n                </div>\n            </div>\n            <div class=\"form-group\">\n                <label for=\"updatedAt\" class=\"col-sm-2 control-label\">Updated Datetime</label>\n                <div class=\"col-sm-4\">\n                    <input id=\"updatedAt\" class=\"form-control\" value=\"2017-02-28 15:00:01\" th:field=\"*{updatedAt}\" readonly=\"readonly\"/>\n                </div>\n            </div>\n            <div class=\"form-group\">\n                <div class=\"col-sm-offset-2 col-sm-10\">\n                    <input type=\"hidden\" th:field=\"*{version}\"/>\n                    <button type=\"submit\" class=\"btn btn-default\" name=\"update\">Update</button>\n                    <button type=\"submit\" class=\"btn btn-default\" name=\"delete\">Delete</button>\n                </div>\n            </div>\n        </form>\n    </div>\n\n    <hr/>\n\n    <a href=\"list.html\" class=\"btn btn-default\" th:href=\"@{/tasks}\">Task List</a>\n\n</div>\n</body>\n</html>\n```\n\n# \u8a8d\u53ef\u30b3\u30fc\u30c9\u30b0\u30e9\u30f3\u30c8\u30d5\u30ed\u30fc\u3092\u4f53\u611f\u3059\u308b\n\nService Provider\u3068Client\u306e\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u4f5c\u6210\u304c\u7d42\u308f\u3063\u305f\u306e\u3067\u3001\u5b9f\u969b\u306b\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u4f7f\u3063\u3066\u8a8d\u53ef\u30b3\u30fc\u30c9\u30b0\u30e9\u30f3\u30c8\u30d5\u30ed\u30fc\u3092\u4f53\u611f\u3057\u3066\u307f\u307e\u3057\u3087\u3046\uff01\uff01\n\n## \u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u8d77\u52d5\n\n\u307e\u305a\u3001Service Provider\u3068Client\u306e\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u8d77\u52d5\u3057\u307e\u3059\u3002\n\n```\n$ ./mvnw -pl service-provider spring-boot:run\n...\n2017-02-27 00:29:12.820  INFO 78931 --- [           main] o.s.j.e.a.AnnotationMBeanExporter        : Registering beans for JMX exposure on startup\n2017-02-27 00:29:12.867  INFO 78931 --- [           main] s.b.c.e.t.TomcatEmbeddedServletContainer : Tomcat started on port(s): 18081 (http)\n2017-02-27 00:29:12.872  INFO 78931 --- [           main] com.example.ServiceProviderApplication   : Started ServiceProviderApplication in 3.247 seconds (JVM running for 5.825)\n```\n\n```\n$ ./mvnw -pl client spring-boot:run\n...\n2017-02-27 00:29:49.282  INFO 78940 --- [           main] o.s.j.e.a.AnnotationMBeanExporter        : Registering beans for JMX exposure on startup\n2017-02-27 00:29:49.337  INFO 78940 --- [           main] s.b.c.e.t.TomcatEmbeddedServletContainer : Tomcat started on port(s): 18080 (http)\n2017-02-27 00:29:49.344  INFO 78940 --- [           main] com.example.ClientApplication            : Started ClientApplication in 3.033 seconds (JVM running for 6.17)\n```\n\n## \u30bf\u30b9\u30af\u4e00\u89a7\u753b\u9762\u306e\u8868\u793a\n\n\u30d6\u30e9\u30a6\u30b6\u306e\u30a2\u30c9\u30ec\u30b9\u30d0\u30fc\u306b http://localhost:18080/client/tasks \u3092\u5165\u529b\u3057\u3066\u3001\u30bf\u30b9\u30af\u4e00\u89a7\u753b\u9762\u3092\u8868\u793a\u3057\u3066\u307f\u307e\u3057\u3087\u3046\u3002\n\u521d\u56de\u30a2\u30af\u30bb\u30b9\u6642\u306f\u3001\u307e\u305aClient\u5074\u306e\u30e6\u30fc\u30b6\u8a8d\u8a3c(Basic\u8a8d\u8a3c)\u304c\u6c42\u3081\u3089\u308c\u308b\u306e\u3067\u3001\u30c0\u30a4\u30a2\u30ed\u30b0\u306b\u30e6\u30fc\u30b6\u540d(`user`)\u3068\u30d1\u30b9\u30ef\u30fc\u30c9(`password`)\u3092\u5165\u529b\u3057\u3066\u300c\u30ed\u30b0\u30a4\u30f3\u300d\u30dc\u30bf\u30f3\u3092\u62bc\u4e0b\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n<img width=\"1284\" alt=\"spring-security-oauth-1st-app-client-auth.png\" src=\"https://qiita-image-store.s3.amazonaws.com/0/117313/294c2bd1-1039-517f-9bb0-cac1972dd857.png\">\n\nClient\u5074\u306e\u30e6\u30fc\u30b6\u8a8d\u8a3c\u304c\u6210\u529f\u3059\u308b\u3068\u3001\u30ea\u30bd\u30fc\u30b9\u30aa\u30fc\u30ca\u304b\u3089\u306e\u8a8d\u53ef\u30b0\u30e9\u30f3\u30c8(\u8a8d\u53ef\u30b3\u30fc\u30c9)\u3092\u5f97\u308b\u305f\u3081\u306bService Provider\u304b\u3089\u63d0\u4f9b\u3055\u308c\u3066\u3044\u308b\u8a8d\u53ef\u30a8\u30f3\u30c9\u30dd\u30a4\u30f3\u30c8(`/oauth/authorize`)\u306b\u30ea\u30c0\u30a4\u30ec\u30af\u30c8\u3055\u308c\u307e\u3059\u3002\u521d\u56de\u30a2\u30af\u30bb\u30b9\u6642\u306f\u3001Service Provider\u5074\u3067\u306e\u30ea\u30bd\u30fc\u30b9\u30aa\u30fc\u30ca\u306e\u8a8d\u8a3c(Basic\u8a8d\u8a3c)\u304c\u6c42\u3081\u3089\u308c\u308b\u306e\u3067\u3001\u30c0\u30a4\u30a2\u30ed\u30b0\u306b\u30e6\u30fc\u30b6\u540d(`user`)\u3068\u30d1\u30b9\u30ef\u30fc\u30c9(`password`)\u3092\u5165\u529b\u3057\u3066\u300c\u30ed\u30b0\u30a4\u30f3\u300d\u30dc\u30bf\u30f3\u3092\u62bc\u4e0b\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n<img width=\"1284\" alt=\"spring-security-oauth-1st-app-provider-auth.png\" src=\"https://qiita-image-store.s3.amazonaws.com/0/117313/31d13db6-ef4c-b31c-c907-7a41e4e23842.png\">\n\nService Provider\u5074\u306e\u30ea\u30bd\u30fc\u30b9\u30aa\u30fc\u30ca\u306e\u8a8d\u8a3c\u304c\u6210\u529f\u3059\u308b\u3068\u3001Client\u304c\u8981\u6c42\u3057\u305f\u30b9\u30b3\u30fc\u30d7\u306b\u5bfe\u3057\u3066\u30ea\u30bd\u30fc\u30b9\u30aa\u30fc\u30ca\u306e\u8a8d\u53ef\u3092\u5f97\u308b\u305f\u3081\u306e\u753b\u9762\uff08\u8a8d\u53ef\u753b\u9762\uff09\u304c\u8868\u793a\u3055\u308c\u308b\u306e\u3067\u3001\u30b9\u30b3\u30fc\u30d7\u6bce\u306b\u8a31\u53ef\u30fb\u62d2\u5426\u3092\u9078\u629e\u3057\u3066\u300cAuthorize\u300d\u30dc\u30bf\u30f3\u3092\u62bc\u4e0b\u3057\u3066\u304f\u3060\u3055\u3044\u3002\uff08\u3053\u3053\u3067\u306f\u3001\u5168\u3066\u306e\u30b9\u30b3\u30fc\u30d7\u3092\u8a31\u53ef\u3057\u3066\u304f\u3060\u3055\u3044\uff09\n\n<img width=\"1284\" alt=\"spring-security-oauth-1st-app-provider-authorize.png\" src=\"https://qiita-image-store.s3.amazonaws.com/0/117313/f6948556-c10e-2a0d-9b05-17b73361c88b.png\">\n\n> **Note:**\n>\n> \u672c\u30a8\u30f3\u30c8\u30ea\u30fc\u3067\u306f\u3001Spring Security OAuth\u304c\u63d0\u4f9b\u3057\u3066\u3044\u308b\u8a8d\u53ef\u753b\u9762\u3092\u4f7f\u7528\u3057\u3066\u3044\u307e\u3059\u304c\u3001\u5b9f\u969b\u306e\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u958b\u767a\u3067\u306f\u30ab\u30b9\u30bf\u30de\u30a4\u30ba\u3059\u308b\u306e\u304c\u4e00\u822c\u7684\u3060\u3068\u601d\u3046\u306e\u3067\u3001\u6b21\u56de\u4ee5\u964d\u3067\u30ab\u30b9\u30bf\u30de\u30a4\u30ba\u65b9\u6cd5\u3092\u7d39\u4ecb\u3057\u305f\u3044\u3068\u601d\u3044\u307e\u3059\u3002\n\n\n\u30ea\u30bd\u30fc\u30b9\u30aa\u30fc\u30ca\u304b\u3089\u306e\u8a8d\u53ef\u304c\u7d42\u308f\u308b\u3068\u3001\u30bf\u30b9\u30af\u4e00\u89a7\u753b\u9762\u304c\u8868\u793a\u3055\u308c\u307e\u3059 :laughing:\n\n<img width=\"1284\" alt=\"spring-security-oauth-1st-app-client-list.png\" src=\"https://qiita-image-store.s3.amazonaws.com/0/117313/f9b3b189-eaf7-9da7-a830-dbe4786f8436.png\">\n\n## \u30bf\u30b9\u30af\u306e\u767b\u9332\n\n\u3068\u306f\u3044\u3048\u30fb\u30fb\u30fb\u30bf\u30b9\u30af\u304c\u672a\u767b\u9332\u306e\u305f\u3081\u3061\u3083\u3093\u3068\u30ea\u30bd\u30fc\u30b9\u30b5\u30fc\u30d0\u304b\u3089\u30bf\u30b9\u30af\u60c5\u5831\u304c\u53d6\u5f97\u3067\u304d\u3066\u3044\u308b\u306e\u304b\u308f\u304b\u3089\u306a\u3044\u30fb\u30fb\u30fb\u3067\u3059\u306d :sweat_smile:\n\u306a\u306e\u3067\u30fb\u30fb\u30fb\u6b21\u306bWeb UI\u3092\u4f7f\u3063\u3066\u30bf\u30b9\u30af\u3092\u767b\u9332\u3057\u3066\u307f\u307e\u3057\u3087\u3046\u3002\u30bf\u30b9\u30af\u4e00\u89a7\u753b\u9762\u5185\u306e\u5165\u529b\u30d5\u30a9\u30fc\u30e0\u306b\u30bf\u30b9\u30af\u60c5\u5831\u3092\u5165\u529b\u3057\u3066\u300cCreate\u300d\u30dc\u30bf\u30f3\u3092\u62bc\u4e0b\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n<img width=\"1284\" alt=\"spring-security-oauth-1st-app-client-create.png\" src=\"https://qiita-image-store.s3.amazonaws.com/0/117313/a9494173-4193-9569-da16-558ee423d6f1.png\">\n\n<img width=\"1284\" alt=\"spring-security-oauth-1st-app-client-list-after-created.png\" src=\"https://qiita-image-store.s3.amazonaws.com/0/117313/c3de72a2-4a99-401e-0dd9-9ea166c07611.png\">\n\n\n## \u30bf\u30b9\u30af\u8a73\u7d30\u753b\u9762\u306e\u8868\u793a\n\n\u30bf\u30b9\u30af\u4e00\u89a7\u306b\u306f\u30bf\u30a4\u30c8\u30eb\u3001\u671f\u9650\u65e5\u3001\u4f5c\u6210\u65e5\u6642\u4ee5\u5916\u8868\u793a\u3057\u3066\u3044\u306a\u3044\u306e\u3067\u3001\u30bf\u30b9\u30af\u8a73\u7d30\u753b\u9762\u3092\u8868\u793a\u3057\u3066\u30bf\u30b9\u30af\u306e\u8a73\u7d30\u60c5\u5831\u3092\u78ba\u8a8d\u3057\u307e\u3057\u3087\u3046\u3002\u30bf\u30b9\u30af\u4e00\u89a7\u306e\u30bf\u30a4\u30c8\u30eb\u304c\u30ea\u30f3\u30af\u306b\u306a\u3063\u3066\u3044\u308b\u306e\u3067\u3001\u8868\u793a\u3057\u305f\u3044\u30bf\u30b9\u30af\u306e\u30bf\u30a4\u30c8\u30eb(\u30ea\u30f3\u30af)\u3092\u62bc\u4e0b\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n<img width=\"1284\" alt=\"spring-security-oauth-1st-app-client-detail.png\" src=\"https://qiita-image-store.s3.amazonaws.com/0/117313/60b2ea08-97c8-fa57-0400-bc36262b2825.png\">\n\n\n## \u30bf\u30b9\u30af\u306e\u66f4\u65b0\u30fb\u524a\u9664\n\n\u30bf\u30b9\u30af\u3092\u66f4\u65b0\u307e\u305f\u306f\u524a\u9664\u3059\u308b\u5834\u5408\u306f\u3001\u30bf\u30b9\u30af\u8a73\u7d30\u753b\u9762\u306e\u300cUpdate\u300d\u307e\u305f\u306f\u300cDelete\u300d\u30dc\u30bf\u30f3\u3092\u62bc\u4e0b\u3057\u3066\u304f\u3060\u3055\u3044\u3002\u3053\u3053\u3067\u306f\u3001\u671f\u9650\u65e5\u3092\u300c2017/03/15\u300d\u306b\u66f4\u65b0\u3057\u3066\u3044\u307e\u3059\u3002\uff08\u306a\u304a\u3001\u524a\u9664\u306f\u5272\u611b\u3057\u307e\u3059\uff09\n\n\n<img width=\"1284\" alt=\"spring-security-oauth-1st-app-client-update.png\" src=\"https://qiita-image-store.s3.amazonaws.com/0/117313/9b7ac0f2-c72d-4e52-2c76-8741b8241dc0.png\">\n\n<img width=\"1284\" alt=\"spring-security-oauth-1st-app-client-detail-after-updated.png\" src=\"https://qiita-image-store.s3.amazonaws.com/0/117313/f8140e1e-4f42-8e16-89a5-c768b14bf350.png\">\n\n## write\u30b9\u30b3\u30fc\u30d7(\u4e00\u90e8\u306e\u30b9\u30b3\u30fc\u30d7)\u3092\u62d2\u5426\u3057\u3066\u307f\u308b\n\n\u30a2\u30af\u30bb\u30b9\u30c8\u30fc\u30af\u30f3\u3068\u8a8d\u53ef\u60c5\u5831\u3092\u7834\u68c4\u3059\u308b\u305f\u3081\u306b\u3001Service Provider\u3092\u518d\u8d77\u52d5\uff08\"Ctrl+C\" + \"./mvnw spring-boot:run\"\uff09\u3057\u3001\u518d\u5ea6\u30bf\u30b9\u30af\u4e00\u89a7\u753b\u9762\u3092\u8868\u793a\u3057\u307e\u3059\u3002\u3059\u308b\u3068\u30fb\u30fb\u30fbService Provider\u306e\u8a8d\u53ef\u753b\u9762\u304c\u8868\u793a\u3055\u308c\u308b\u306e\u3067\u3001write\u30b9\u30b3\u30fc\u30d7\u306e\u30a2\u30af\u30bb\u30b9\u3092\u62d2\u5426\u3057\u307e\u3059\u3002\n\n<img width=\"1244\" alt=\"spring-security-oauth-1st-app-provider-reject-write.png\" src=\"https://qiita-image-store.s3.amazonaws.com/0/117313/7e8c181f-50e1-0627-e8ce-7bbd4f757c60.png\">\n\n\u30bf\u30b9\u30af\u4e00\u89a7\u753b\u9762\u3067\u65b0\u3057\u3044\u30bf\u30b9\u30af\u3092\u4f5c\u6210\u3057\u3088\u3046\u3068\u3059\u308b\u3068\u30fb\u30fb\u30fb\u300cInsufficient scope for this resource\u300d\u3068\u3044\u3046\u30a8\u30e9\u30fc\u30e1\u30c3\u30bb\u30fc\u30b8\u304c\u8868\u793a\u3055\u308c\u3001\u300c\u30bf\u30b9\u30af\u4f5c\u6210API\u300d\u306e\u547c\u3073\u51fa\u3057\u304c\u62d2\u5426\u3055\u308c\u307e\u3057\u305f\u3002\n\n<img width=\"1272\" alt=\"spring-security-oauth-1st-app-client-reject-write.png\" src=\"https://qiita-image-store.s3.amazonaws.com/0/117313/d8f6d826-8200-e284-bccc-dcf27ca42a8a.png\">\n\n\n## \u5168\u30b9\u30b3\u30fc\u30d7\u3092\u62d2\u5426\u3057\u3066\u307f\u308b\n\n\u30a2\u30af\u30bb\u30b9\u30c8\u30fc\u30af\u30f3\u3068\u8a8d\u53ef\u60c5\u5831\u3092\u7834\u68c4\u3059\u308b\u305f\u3081\u306b\u3001Service Provider\u3092\u518d\u8d77\u52d5\uff08\"Ctrl+C\" + \"./mvnw spring-boot:run\"\uff09\u3057\u3001\u518d\u5ea6\u30bf\u30b9\u30af\u4e00\u89a7\u753b\u9762\u3092\u8868\u793a\u3057\u307e\u3059\u3002\u3059\u308b\u3068\u30fb\u30fb\u30fbService Provider\u306e\u8a8d\u53ef\u753b\u9762\u304c\u8868\u793a\u3055\u308c\u308b\u306e\u3067\u3001\u5168\u30b9\u30b3\u30fc\u30d7\u306e\u30a2\u30af\u30bb\u30b9\u3092\u62d2\u5426\u3057\u307e\u3059\u3002\u3059\u308b\u3068\u30fb\u30fb\u30fb\u300c\u8a8d\u53ef\u30b3\u30fc\u30c9\u300d\u306e\u4ee3\u308f\u308a\u306b\u3001\u30ea\u30bd\u30fc\u30b9\u30aa\u30fc\u30ca\u304c\u30a2\u30af\u30bb\u30b9\u3092\u62d2\u5426\u3057\u305f\u3053\u3068\u3092\u901a\u77e5\u3059\u308b\u30d1\u30e9\u30e1\u30fc\u30bf\u3092\u4ed8\u4e0e\u3057\u3066Client\u5074\u306e\u30da\u30fc\u30b8\u306b\u30ea\u30c0\u30a4\u30ec\u30af\u30c8\u3057\u307e\u3059\u3002\n\n<img width=\"1399\" alt=\"spring-security-oauth-1st-app-client-reject-all.png\" src=\"https://qiita-image-store.s3.amazonaws.com/0/117313/bb31ed93-2f9d-ba60-6f56-f17fadfd1644.png\">\n\n# **[\u8d85\u91cd\u8981] REST API\u306e\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u4e0a\u306e\u554f\u984c\u70b9\u3092\u306a\u304f\u305d\u3046\uff01\uff01**\n\n\u5b9f\u306f\u3053\u3053\u307e\u3067\u3067\u4f5c\u6210\u3057\u3066\u304d\u305f\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3(REST API)\u306b\u306f\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u4e0a\u306e\u91cd\u5927\u306a\u554f\u984c\u70b9\u304c\u5b58\u5728\u3059\u308b\u306e\u3067\u3059\u304c\u3001\u4f55\u304c\u554f\u984c\u306a\u306e\u304b\u308f\u304b\u308a\u307e\u3059\u304b\uff1f \u305d\u308c\u306f\u30fb\u30fb\u30fb\u306a\u3093\u3068\u30fb\u30fb\u30fb**\u4ed6\u4eba\u306e\u30bf\u30b9\u30af\u60c5\u5831\u3092\u53c2\u7167\u30fb\u66f4\u65b0\u3067\u304d\u3066\u3057\u307e\u3046\u306e\u3067\u3059** :scream: :scream: :scream:\n\n\u3053\u306e\u554f\u984c\u3092\u89e3\u6c7a\u3059\u308b\u65b9\u6cd5\u3068\u3057\u3066\u306f\u3001\u4ee5\u4e0b\u306e\uff12\u3064\u304c\u8003\u3048\u3089\u308c\u307e\u3059\u3002\n\n* \u30bf\u30b9\u30af\u60c5\u5831\u306b\u30a2\u30af\u30bb\u30b9\u3059\u308b\u969b\u306e\u6761\u4ef6(SQL\u306e\u6761\u4ef6)\u306b\u30e6\u30fc\u30b6\u540d\u3092\u52a0\u3048\u308b\n* \u30bf\u30b9\u30af\u60c5\u5831\u306e\u6240\u6709\u8005\u3068\u8a8d\u8a3c\u60c5\u5831\u306e\u30e6\u30fc\u30b6\u304c\u4e00\u81f4\u3059\u308b\u304b\u30c1\u30a7\u30c3\u30af\u3059\u308b\n\n\u3069\u3061\u3089\u306e\u65b9\u6cd5\u3092\u63a1\u7528\u3059\u308b\u304b\u306f\u3001\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u8981\u4ef6\u6b21\u7b2c\u3067\u3057\u3087\u3046\u3002\u524d\u8005\u306f\u5b58\u5728\u3057\u306a\u3044\u30bf\u30b9\u30af\u306b\u5bfe\u3057\u3066\u64cd\u4f5c\u3057\u305f\u6642\u3068\u540c\u3058\u632f\u308b\u821e\u3044(404 Not Found)\u306b\u306a\u308b\u306e\u306b\u5bfe\u3057\u3066\u3001\u5f8c\u8005\u306f\u30a2\u30af\u30bb\u30b9\u62d2\u5426(403 Forbidden)\u306b\u306a\u308b\u305f\u3081\u3001\u4e0d\u6b63\u306a\u30a2\u30af\u30bb\u30b9\u304c\u3042\u3063\u305f\u3053\u3068\u3092\u8a18\u9332\u3059\u308b\u5fc5\u8981\u304c\u3042\u308b\u5834\u5408\u306f\u5f8c\u8005\u306e\u65b9\u6cd5\u3092\u3068\u308b\u65b9\u304c\u3088\u3044\u3068\u601d\u3044\u307e\u3059\u3002\n\n## SQL\u306b\u6761\u4ef6\u306b\u30e6\u30fc\u30b6\u540d\u52a0\u3048\u308b\n\n\u30bf\u30b9\u30af\u60c5\u5831\u306b\u30a2\u30af\u30bb\u30b9\u3059\u308b\u969b\u306e\u6761\u4ef6(SQL\u306e\u6761\u4ef6)\u306b\u30e6\u30fc\u30b6\u540d\u3092\u52a0\u3048\u308b\u5834\u5408\u306f\u3001Repository\u306e\u30e1\u30bd\u30c3\u30c9\u306e\u5f15\u6570\u306b\u30e6\u30fc\u30b6\u540d\u3092\u8ffd\u52a0\u3057\u3066SQL\u306e\u6761\u4ef6\u306b\u30e6\u30fc\u30b6\u540d\u3092\u52a0\u3048\u307e\u3057\u3087\u3046\u3002\u3053\u3053\u3067\u306f\u3001\u66f4\u65b0\u3068\u524a\u9664\u51e6\u7406\u306b\u3064\u3044\u3066\u306f\u3001\u51e6\u7406\u3092\u884c\u3046\u524d\u306b`findOne`\u30e1\u30bd\u30c3\u30c9\u3092\u547c\u3073\u51fa\u3059\u3053\u3068\u81ea\u8eab\u306e\u30bf\u30b9\u30af\u60c5\u5831\u306b\u5bfe\u3059\u308b\u51e6\u7406\u304b\u30c1\u30a7\u30c3\u30af\u3059\u308b\u3088\u3046\u306b\u3057\u3066\u3044\u307e\u3059\u3002\n\n```java\n@Transactional\n@Repository\npublic class TaskRepository {\n\t// ...\n\n\tpublic Task findOne(long id, String username) {\n\t\treturn jdbcOperations.queryForObject(\n\t\t\t\t\"SELECT id, username, title, detail, deadline, finished, created_at, updated_at, version FROM tasks WHERE id = :id AND username = :username\",\n\t\t\t\tnew MapSqlParameterSource(\"id\", id).addValue(\"username\", username), new BeanPropertyRowMapper<>(Task.class)); // \u2605\u2605\u2605\u4fee\u6b63\n\t}\n\n\tpublic void save(Task task, String username) {\n\t\tif (task.getId() == null) {\n\t\t\tGeneratedKeyHolder holder = new GeneratedKeyHolder();\n\t\t\tjdbcOperations.update(\n\t\t\t\t\t\"INSERT INTO tasks (username, title, detail, deadline, finished) VALUES(:username, :title, :detail, :deadline, :finished)\",\n\t\t\t\t\tnew BeanPropertySqlParameterSource(task), holder);\n\t\t\ttask.setId(holder.getKey().longValue());\n\t\t} else {\n\t\t\tfindOne(task.getId(), username); // \u2605\u2605\u2605\u8ffd\u52a0\n\t\t\tjdbcOperations.update(\n\t\t\t\t\t\"UPDATE tasks SET title = :title, detail = :detail, deadline = :deadline, finished = :finished, updated_at = SYSTIMESTAMP, version = version + 1 WHERE id = :id\",\n\t\t\t\t\tnew BeanPropertySqlParameterSource(task));\n\t\t}\n\t}\n\n\tpublic void remove(long id, String username) {\n\t\tfindOne(id, username); // \u2605\u2605\u2605\u8ffd\u52a0\n\t\tjdbcOperations.update(\"DELETE FROM tasks WHERE id = :id\", new MapSqlParameterSource(\"id\", id));\n\t}\n\n}\n```\n\nRepository\u306e\u30e1\u30bd\u30c3\u30c9\u306e\u5f15\u6570\u5909\u66f4\u306b\u4f34\u3044\u3001Controller\u30af\u30e9\u30b9\u306e\u4fee\u6b63\u3082\u884c\u3044\u307e\u3059\u3002\n\n```java\n@RequestMapping(\"/api/tasks\")\n@RestController\npublic class TaskRestController {\n\n\t// ...\n\n\t@PostMapping\n\tResponseEntity<Void> postTask(@RequestBody Task task, Principal principal, UriComponentsBuilder uriBuilder) {\n\t\ttask.setUsername(extractUsername(principal));\n\t\trepository.save(task, task.getUsername()); // \u2605\u2605\u2605\u4fee\u6b63\n\t\tURI createdTaskUri = relativeTo(uriBuilder)\n\t\t\t\t.withMethodCall(on(TaskRestController.class).getTask(task.getId(), principal)).build().encode().toUri(); // \u2605\u2605\u2605\u4fee\u6b63\n\t\treturn ResponseEntity.created(createdTaskUri).build();\n\t}\n\n\t@GetMapping(\"{id}\")\n\tTask getTask(@PathVariable long id, Principal principal) {\n\t\treturn repository.findOne(id, extractUsername(principal)); // \u2605\u2605\u2605\u4fee\u6b63\n\t}\n\n\t@PutMapping(\"{id}\")\n\t@ResponseStatus(HttpStatus.NO_CONTENT)\n\tvoid putTask(@PathVariable long id, @RequestBody Task task, Principal principal) {\n\t\ttask.setId(id);\n\t\trepository.save(task, extractUsername(principal)); // \u2605\u2605\u2605\u4fee\u6b63\n\t}\n\n\t@DeleteMapping(\"{id}\")\n\t@ResponseStatus(HttpStatus.NO_CONTENT)\n\tvoid deleteTask(@PathVariable long id, Principal principal) {\n\t\trepository.remove(id, extractUsername(principal)); // \u2605\u2605\u2605\u4fee\u6b63\n\t}\n\n\t// ...\n\n}\n```\n\n\u4ed6\u4eba\u306e\u30bf\u30b9\u30af\u60c5\u5831\u306b\u30a2\u30af\u30bb\u30b9\u3059\u308b\u3068\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u30ea\u30bd\u30fc\u30b9\u304c\u5b58\u5728\u3057\u306a\u6642\u306b\u767a\u751f\u3059\u308b\u30a8\u30e9\u30fc(404 Not Found)\u306b\u306a\u308a\u307e\u3059\u3002\n\n<img width=\"1308\" alt=\"spring-security-oauth-1st-app-client-notfound-other-owner.png\" src=\"https://qiita-image-store.s3.amazonaws.com/0/117313/1070207f-276f-838a-bdf3-d10f0589c4f6.png\">\n\n\n## \u6240\u6709\u8005\u30c1\u30a7\u30c3\u30af\u3092\u884c\u3046\n\n\u30bf\u30b9\u30af\u60c5\u5831\u306e\u6240\u6709\u8005\u3068\u8a8d\u8a3c\u60c5\u5831\u306e\u30e6\u30fc\u30b6\u304c\u4e00\u81f4\u3059\u308b\u304b\u30c1\u30a7\u30c3\u30af\u3059\u308b\u5834\u5408\u306f\u3001Spring Security\u304c\u63d0\u4f9b\u3057\u3066\u3044\u308b\u30e1\u30bd\u30c3\u30c9\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u306e\u4ed5\u7d44\u307f\u3092\u5229\u7528\u3059\u308b\u306e\u304c\u3066\u3063\u3068\u308a\u65e9\u3044\u3067\u3057\u3087\u3046\u3002\n\n\u307e\u305a\u3001\u30e1\u30bd\u30c3\u30c9\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u306e\u4ed5\u7d44\u307f\u3092\u6709\u52b9\u5316\u3059\u308b\u305f\u3081\u306b\u3001\u30b3\u30f3\u30d5\u30a3\u30ae\u30e5\u30ec\u30fc\u30b7\u30e7\u30f3\u30af\u30e9\u30b9\u306b`@EnableGlobalMethodSecurity`\u3092\u4ed8\u4e0e\u3057\u307e\u3059\u3002\n\n```java:service-provider/src/main/java/com/example/ResourceServerConfiguration.java\n@EnableGlobalMethodSecurity(prePostEnabled = true) // \u2605\u2605\u2605\u8ffd\u52a0\n@EnableResourceServer\n@Configuration\npublic class ResourceServerConfiguration extends ResourceServerConfigurerAdapter {\n\t// ...\n}\n```\n\n\u6b21\u306b\u3001\u30bf\u30b9\u30af\u60c5\u5831\u3092\u53d6\u5f97\u3059\u308b\u30e1\u30bd\u30c3\u30c9\u306b\u5bfe\u3057\u3066\u3001\u30ea\u30bd\u30fc\u30b9\u30aa\u30fc\u30ca\u4ee5\u5916\u30a2\u30af\u30bb\u30b9\u3067\u304d\u306a\u3044\u3088\u3046\u306b\u8a8d\u53ef\u8a2d\u5b9a\u3092\u884c\u3044\u307e\u3059\u3002\n\n```java:service-provider/src/main/java/com/example/TaskRepository.java\n@Transactional\n@Repository\npublic class TaskRepository {\n\t// ...\n\t@PostAuthorize(\"returnObject.username == authentication.name\") // \u2605\u2605\u2605\u8ffd\u52a0\n\tpublic Task findOne(long id) {\n\t\treturn jdbcOperations.queryForObject(\n\t\t\t\t\"SELECT id, username, title, detail, deadline, finished, created_at, updated_at, version FROM tasks WHERE id = :id\",\n\t\t\t\tnew MapSqlParameterSource(\"id\", id), new BeanPropertyRowMapper<>(Task.class));\n\t}\n\t// ...\n}\n```\n\n\u6700\u5f8c\u306b\u3001\u66f4\u65b0\u307e\u305f\u306f\u524a\u9664\u3059\u308b\u969b\u306b\u3082`findOne`\u30e1\u30bd\u30c3\u30c9\u3092\u547c\u3073\u51fa\u3059\u3088\u3046\u306b\u4fee\u6b63\u3057\u307e\u3059\u3002\n\n```java:service-provider/src/main/java/com/example/TaskRestController.java\n@RequestMapping(\"/api/tasks\")\n@RestController\npublic class TaskRestController {\n\n\t// ...\n\n\t@PutMapping(\"{id}\")\n\t@ResponseStatus(HttpStatus.NO_CONTENT)\n\tvoid putTask(@PathVariable long id, @RequestBody Task task) {\n\t\trepository.findOne(id); // \u2605\u2605\u2605\u8ffd\u52a0 \n\t\ttask.setId(id);\n\t\trepository.save(task);\n\t}\n\n\t@DeleteMapping(\"{id}\")\n\t@ResponseStatus(HttpStatus.NO_CONTENT)\n\tvoid deleteTask(@PathVariable long id) {\n\t\trepository.findOne(id); // \u2605\u2605\u2605\u8ffd\u52a0 \n\t\trepository.remove(id);\n\t}\n\n\t// ...\n\n}\n```\n\n\u4ed6\u4eba\u306e\u30bf\u30b9\u30af\u60c5\u5831\u306b\u30a2\u30af\u30bb\u30b9\u3059\u308b\u3068\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u8a8d\u53ef\u30a8\u30e9\u30fc(403 Forbidden)\u306b\u306a\u308a\u307e\u3059\u3002\n\n<img width=\"1308\" alt=\"spring-security-oauth-1st-app-client-reject-other-owner.png\" src=\"https://qiita-image-store.s3.amazonaws.com/0/117313/941c1f94-54fc-8be1-d303-307a351ebe11.png\">\n\n# \u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u5b8c\u6210\u7248\n\n\u672c\u30a8\u30f3\u30c8\u30ea\u30fc\u3067\u4f5c\u6210\u3057\u305f\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u5b8c\u6210\u7248\u306f\u3001\u4ee5\u4e0b\u306eGitHub\u30ea\u30dd\u30b8\u30c8\u30ea\u3067\u516c\u958b\u3057\u3066\u3042\u308a\u307e\u3059\u3002\n\n* https://github.com/kazuki43zoo/spring-security-oauth-demo\n\n# \u307e\u3068\u3081\n\n\u8aac\u660e\u304c\u3061\u3087\u3063\u3068\u9577\u304f\u306a\u308a\u307e\u3057\u305f\u304c\u30fb\u30fb\u30fb\u8a8d\u53ef\u30b3\u30fc\u30c9\u30b0\u30e9\u30f3\u30c8\u30d5\u30ed\u30fc\u3092\u4f7f\u7528\u3057\u3066REST API\u306e\u8a8d\u8a3c\u30fb\u8a8d\u53ef\u3092\u884c\u3046\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u4f5c\u3063\u3066\u307f\u307e\u3057\u305f\u3002\u4eca\u56de\u306f\u3042\u304f\u307e\u3067Spring Security OAuth + Spring Boot\u3067\u8a8d\u53ef\u30b3\u30fc\u30c9\u30b0\u30e9\u30f3\u30c8\u30d5\u30ed\u30fc\u3092\u4f53\u611f\u3057\u3066\u3082\u3089\u3046\uff08\u89e6\u308c\u3066\u3082\u3089\u3046\uff09\u3053\u3068\u304c\u76ee\u7684\u3060\u3063\u305f\u306e\u3067\u3001Spring Boot\u306eAutoConfigure\u306e\u4ed5\u7d44\u307f\uff08\u30c7\u30d5\u30a9\u30eb\u30c8\u306e\u52d5\u4f5c\uff09\u3092\u6700\u5927\u9650\u306b\u6d3b\u7528\u3057\u3066\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u4f5c\u308b\u3088\u3046\u306b\u3057\u307e\u3057\u305f\u3002\n\u3057\u304b\u3057\u30fb\u30fb\u30fb\u5b9f\u969b\u306e\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u958b\u767a\u3067\u306f\u3001\u30e6\u30fc\u30b6(\u30ea\u30bd\u30fc\u30b9\u30aa\u30fc\u30ca)\u3084\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u306e\u60c5\u5831\u306f\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306a\u3069\u3067\u7ba1\u7406\u3059\u308b\u306e\u304c\u4e00\u822c\u7684\u3067\u3059\u3057\u3001\u30a2\u30af\u30bb\u30b9\u30c8\u30fc\u30af\u30f3\u3084\u8a8d\u53ef\u60c5\u5831\u3082\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u5185\u306e\u30e1\u30e2\u30ea\u4e0a\u3067\u7ba1\u7406\u3059\u308b\u306e\u3067\u306f\u306a\u304f\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306a\u3069\u306b\u6c38\u7d9a\u5316\u3059\u308b\u3053\u3068\u304c\u6c42\u3081\u3089\u308c\u308b\u30b1\u30fc\u30b9\u306e\u65b9\u304c\u591a\u3044\u3067\u3057\u3087\u3046\u3002\u3055\u3089\u306b\u3001Service Provider\u304c\u6271\u3046\u30ea\u30bd\u30fc\u30b9\u3082\uff11\u7a2e\u985e\u3067\u306f\u306a\u304f\u8907\u6570\u306b\u306a\u308b\u30b1\u30fc\u30b9\u3084\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u3082\u8907\u6570\u306eService Provider\u306e\u30ea\u30bd\u30fc\u30b9\u3078\u30a2\u30af\u30bb\u30b9\u3059\u308b\u3088\u3046\u306a\u30b1\u30fc\u30b9\u306a\u3069\u3082\u60f3\u5b9a\u3055\u308c\u308b\u305f\u3081\u3001\u4eca\u56de\u7d39\u4ecb\u3057\u305f\u5185\u5bb9\u3060\u3051\u3067\u306f\u5b9f\u904b\u7528\u306b\u8010\u3048\u3089\u308c\u308b\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u958b\u767a\u3059\u308b\u306e\u304c\u96e3\u3057\u3044\u306e\u3082\u73fe\u5b9f\u3067\u3059\u3002\n\u306a\u306e\u3067\u30fb\u30fb\u30fb\u6b21\u56de\u4ee5\u964d\u3067\u306f\u3001Spring Security OAuth\u306e\u30a2\u30fc\u30ad\u30c6\u30af\u30c1\u30e3\u3092\u8aac\u660e\u3057\u3001Spring Boot\u30fbSpring Security\u30fbSpring Security OAuth\u306e\u62e1\u5f35\u30dd\u30a4\u30f3\u30c8\u3092\u4f7f\u7528\u3057\u305f\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u958b\u767a\u65b9\u6cd5\u3092\u7d39\u4ecb\u3057\u3066\u3044\u304d\u305f\u3044\u3068\u601d\u3063\u3066\u3044\u307e\u3059\u3002\n\n\u3067\u306f\u3001\u307e\u305f\u6b21\u56de\uff01\uff01\n", "tags": ["spring-security", "spring-boot", "spring", "Java", "OAuth"]}