{"context": " More than 1 year has passed since last update.eccube3\u3092\u52d5\u304b\u3059\u306e\u306b\u5fc5\u8981\u306a\u57fa\u672c\u7684\u306a\u624b\u9806\u3092\u8a18\u8ff0\u3057\u307e\u3059\u3002\n\u5b9f\u969b\u306b\u904b\u7528\u3059\u308b\u5834\u5408\u306f\u306fSSL\u901a\u3057\u305f\u308a\u3001\u7ba1\u7406\u753b\u9762\u96a0\u3057\u305f\u308a\u3001\u3044\u308d\u3044\u308d\u3068\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u5bfe\u7b56\u304c\u5fc5\u8981\u306b\u306a\u308a\u307e\u3059\u3002\u3042\u304f\u307e\u3067\u8a66\u7528\u624b\u9806\u3068\u3057\u3066\u53c2\u7167\u304f\u3060\u3055\u3044\u3002\u672c\u6295\u7a3f\u3092\u53c2\u8003\u306b\u3057\u3066\u751f\u3058\u305f\u3044\u304b\u306a\u308b\u554f\u984c\u3082\u5f53\u65b9\u3067\u306f\u8cac\u4efb\u3092\u8ca0\u3044\u304b\u306d\u307e\u3059\u3002\n\n\u57fa\u672c\u7684\u306aLAMP\u4e92\u63db\u74b0\u5883\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\n\u57fa\u672c\u7684\u306b\u306f\u3053\u3061\u3089 \u3092\u53c2\u8003\u306b\u3002\n\u74b0\u5883\n\nCentOS7.1\nnginx 1.6.3\nMariaDB 5.5.41\nPHP 5.4.16\neccube-3.0.2\n\n\nepel\u30ea\u30dd\u30b8\u30c8\u30ea\u6709\u52b9\u5316\n\u983b\u7e41\u306b\u5229\u7528\u3059\u308b\u306e\u3067\u3001epel\u30ea\u30dd\u30b8\u30c8\u30ea\u3092\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n\nconsole\n$ sudo yum install epel-release\n\n\n\n\u30ea\u30dd\u30b8\u30c8\u30ea\u66f4\u65b0\n\u6700\u65b0\u306b\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n\nconsole\n$ sudo yum update\n\n\n\nSELinux \u7121\u52b9\u5316\n\u624b\u9806\u3092\u7c21\u6613\u306b\u3059\u308b\u305f\u3081\u3001Permissive\u306b\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n\nconsole\n$ sudo setenforce 0\n\n\n\nnginx\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\nconsole\nsudo yum install nginx\n\n\n\n\u30b5\u30fc\u30d3\u30b9\u306e\u8d77\u52d5\n\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u304c\u5b8c\u4e86\u3057\u305f\u3089\u30b5\u30fc\u30d3\u30b9\u3092\u5b9f\u884c\u3057\u307e\u3059\u3002\n\u30b5\u30fc\u30d3\u30b9\u3092\u6709\u52b9\u306b\u3057\u3066\u81ea\u52d5\u3067\u8d77\u52d5\u3059\u308b\u3088\u3046\u306b\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n\nconsole\n\u30b5\u30fc\u30d3\u30b9\u6709\u52b9\u5316\n$ sudo systemctl enable nginx\nln -s '/usr/lib/systemd/system/nginx.service' '/etc/systemd/system/multi-user.target.wants/nginx.service'\n\nnginx\u8d77\u52d5\n$ sudo systemctl start nginx\n\n\u30b9\u30c6\u30fc\u30bf\u30b9\u78ba\u8a8d\n$ sudo systemctl status nginx\nnginx.service - The nginx HTTP and reverse proxy server\n   Loaded: loaded (/usr/lib/systemd/system/nginx.service; enabled)\n   Active: active (running) since Fri 2015-02-00 00:00:00 JST; 10s ago\n  Process: 22314 ExecStart=/usr/sbin/nginx (code=exited, status=0/SUCCESS)\n  Process: 22312 ExecStartPre=/usr/sbin/nginx -t (code=exited, status=0/SUCCESS)\n Main PID: 22316 (nginx)\n   CGroup: /system.slice/nginx.service\n           \u251c\u250022316 nginx: master process /usr/sbin/nginx\n           \u2514\u250022317 nginx: worker process\n\nFeb 00 00:00:00 localhost.localdomain systemd[1]: Starting The nginx HTTP and reverse proxy server...\nFeb 00 00:00:00 localhost.localdomain nginx[22312]: nginx: the configuration file /etc/nginx/nginx.conf syntax is ok\nFeb 00 00:00:00 localhost.localdomain nginx[22312]: nginx: configuration file /etc/nginx/nginx.conf test is successful\nFeb 00 00:00:00 localhost.localdomain systemd[1]: Failed to read PID from file /run/nginx.pid: Invalid argument\nFeb 00 00:00:00 localhost.localdomain systemd[1]: Started The nginx HTTP and reverse proxy server.\n\n\n\u30b9\u30c6\u30fc\u30bf\u30b9\u304cactive (running)\u306b\u306a\u3063\u3066\u3044\u308b\u306e\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\n\nFirewall\u30dd\u30fc\u30c8\u958b\u653e\n\nconsole\nhttp\u3092\u5e38\u306b\u958b\u653e\n$ sudo firewall-cmd --add-service=http --permanent\nsuccess\n\n\u8a2d\u5b9a\u30ea\u30ed\u30fc\u30c9\n$ sudo firewall-cmd --reload\nsuccess\n\n\u52d5\u4f5c\u78ba\u8a8d\n$ sudo firewall-cmd --list-service\ndhcpv6-client http mysql ssh\n\n\nhttp\u304c\u542b\u307e\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3057\u3066\u4e0b\u3055\u3044\u3002\n\n\u78ba\u8a8d\nnginx\u304cstarted\u306b\u306a\u3063\u3066\u3044\u305f\u3089\u3001\u5b9f\u969b\u306bhttp\u3067\u30a2\u30af\u30bb\u30b9\u3057\u3066\u307f\u307e\u3059\u3002\n\nconsole\n$ curl localhost\n<!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.1//EN\" \"http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd\">\n\n<html xmlns=\"http://www.w3.org/1999/xhtml\" xml:lang=\"en\">\n    <head>\n        <title>Test Page for the Nginx HTTP Server on Fedora</title>\n        <meta http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-8\" />\n(\u7701\u7565\uff09\n\n\nnginx\u306e\u30c6\u30b9\u30c8\u30da\u30fc\u30b8\u306e\u30bd\u30fc\u30b9\u304c\u8fd4\u3063\u3066\u304d\u307e\u3059\u3002\u30d6\u30e9\u30a6\u30b6\u3067\u3082\u78ba\u8a8d\u3057\u3066\u307f\u3066\u304f\u3060\u3055\u3044\u3002\n\nPHP\uff08FastCGI\uff09\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\nfastCGI\u3068\u3057\u3066\u52d5\u4f5c\u3059\u308bPHP-fpm\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\n\u307e\u305f\u3001ec-cube3\u306b\u5fc5\u8981\u306a\u30e2\u30b8\u30e5\u30fc\u30eb\u3082\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\n\u8a73\u3057\u304f\u306f\u3053\u3061\u3089\u3092\u53c2\u8003\u306b\u3057\u3066\u304f\u3060\u3055\u3044\u3002\nec-cube \u30bd\u30d5\u30c8\u30a6\u30a7\u30a2\u8981\u4ef6\uff083.0\u7cfb\uff09\n\u203bphp-hash\u306fmysqli\u306e\u4f9d\u5b58\u30d1\u30c3\u30b1\u30fc\u30b8\u3067\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u307e\u3059\u3002\n\n\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n$ sudo yum install php-fpm php-mbstring php-mysqli php-mcrypt php-apc\n\n\u30b5\u30fc\u30d3\u30b9\u6709\u52b9\u5316\n$ sudo systemctl enable php-fpm\n\n\u8d77\u52d5\n$ sudo systemctl start php-fpm\n\n\u30b9\u30c6\u30fc\u30bf\u30b9\u78ba\u8a8d\n$ sudo systemctl status php-fpm\nphp-fpm.service - The PHP FastCGI Process Manager\n   Loaded: loaded (/usr/lib/systemd/system/php-fpm.service; enabled)\n   Active: active (running) since \u6708 2015-08-17 21:45:15 JST; 7s ago\n Main PID: 22894 (php-fpm)\n   Status: \"Ready to handle connections\"\n   CGroup: /system.slice/php-fpm.service\n           tq22894 php-fpm: master process (/etc/php-fpm.conf)\n           tq22896 php-fpm: pool www\n           tq22897 php-fpm: pool www\n           tq22898 php-fpm: pool www\n           tq22899 php-fpm: pool www\n           mq22900 php-fpm: pool www\n\n 8\u6708 17 21:45:15 localhost.localdomain systemd[1]: Starting The PHP FastCGI ...\n 8\u6708 17 21:45:15 localhost.localdomain systemd[1]: Started The PHP FastCGI P...\nHint: Some lines were ellipsized, use -l to show in full.\n\n\n\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u7de8\u96c6\n\nphp.ini\u306e\u8a2d\u5b9a\n875\u884c\u76ee\u3042\u305f\u308a\u306e[Date]\u3067timezone\u3092Asia/Tokyo\u306b\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n\nconsole\n$ sudo vi /etc/php.ini\n\n\n\n/etc/php.ini\n[Date]\n; Defines the default timezone used by the date functions\n; http://php.net/date.timezone\n; date.timezone =\ndate.timezone = \"Asia/Tokyo\"\n\n\n\nwww.conf \u306e\u8a2d\u5b9a\n\nconsole\n$ sudo vi /etc/php-fpm.d/www.conf\n\n\nproxy\u304capache\u3058\u3083\u306a\u304f\u3066nginx\u306a\u306e\u3067\u3001php-fpm\u306e\u30d7\u30ed\u30bb\u30b9\u30e6\u30fc\u30b6\u30fc\u3082nginx\u306b\u5909\u66f4\u3057\u3066\u304a\u304d\u307e\u3059\u300235\u884c\u76ee\u3042\u305f\u308a\u306b\u30d7\u30ed\u30bb\u30b9\u95a2\u9023\u306e\u8a2d\u5b9a\u304c\u3042\u308a\u308b\u306e\u3067\u3001user\u3068group\u3092apache\u304b\u3089nginx\u306b\u5909\u66f4\u3057\u307e\u3059\u3002\n\n/etc/php-fpm.d/www.conf\n; Unix user/group of processes\n; Note: The user is mandatory. If the group is not set,\u3000the default user's group\n;       will be used.\n; RPM: apache Choosed to be able to access some dir as httpd\n; user = apache\nuser = nginx\n; RPM: Keep a group allowed to write in log dir.\n; group = apache\ngroup = nginx\n\n\nrestart\u3057\u3066\u8a2d\u5b9a\u3092\u53cd\u6620\u3057\u307e\u3059\u3002\n\nconsole\n$ sudo systemctl restart php-fpm\n$ sudo systemctl status php-fpm\n\n\n\u30ef\u30fc\u30ab\u30fc\u30d7\u30ed\u30bb\u30b9\u306e\u30e6\u30fc\u30b6\u30fc\u304cnginx\u306b\u306a\u3063\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\n\nconsole\n$ ps -ef | grep php\nroot     23063     1  0 22:21 ?        00:00:00 php-fpm: master process (/etc/php-fpm.conf)\nnginx    23065 23063  0 22:21 ?        00:00:00 php-fpm: pool www\nnginx    23066 23063  0 22:21 ?        00:00:00 php-fpm: pool www\nnginx    23067 23063  0 22:21 ?        00:00:00 php-fpm: pool www\nnginx    23068 23063  0 22:21 ?        00:00:00 php-fpm: pool www\nnginx    23069 23063  0 22:21 ?        00:00:00 php-fpm: pool www\n\n\n\n\u30bb\u30c3\u30b7\u30e7\u30f3\u306e\u4fdd\u7ba1\u5834\u6240\n/var/lib/php/session\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u4fdd\u7ba1\u3055\u308c\u307e\u3059\u3002\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092\u4f5c\u6210\u3057\u3066\u3001\u6240\u6709\u8005\u3092nginx\u306b\u5909\u66f4\u3057\u307e\u3059\u3002\n\nconsole\n$ sudo mkdir /var/lib/php/session\n$ sudo chown nginx:nginx /var/lib/php/session\n\n\n\nMariaDB\uff08MySQL\u4e92\u63db\uff09\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\n\u57fa\u672c\u7684\u306b\u306fMySQL\u3068\u540c\u3058\u3067\u3059\u3002MariaDB5.5\u306b\u3066EC-Cube3\u52d5\u4f5c\u78ba\u8a8d\u3057\u307e\u3057\u305f\u3002\n\n\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\nconsole\n$ sudo yum install mariadb mariadb-server\n\n\n\n\u30b5\u30fc\u30d3\u30b9\u306e\u8d77\u52d5\n\nconsole\n\u30b5\u30fc\u30d3\u30b9\u6709\u52b9\u5316\n$ sudo systemctl enable mariadb\nln -s '/usr/lib/systemd/system/mariadb.service' '/etc/systemd/system/multiuser.target.wants/mariadb.service'\n\n\u30b5\u30fc\u30d3\u30b9\u306e\u8d77\u52d5\n$ sudo systemctl start mariadb\n\u30b9\u30c6\u30fc\u30bf\u30b9\u78ba\u8a8d\nmariadb.service - MariaDB database server\n   Loaded: loaded (/usr/lib/systemd/system/mariadb.service; enabled)\n   Active: active (running) since \u6708 2015-08-17 20:10:36 JST; 6min ago\n  Process: 15091 ExecStartPost=/usr/libexec/mariadb-wait-ready $MAINPID (code=exited, status=0/SUCCESS)\n  Process: 15063 ExecStartPre=/usr/libexec/mariadb-prepare-db-dir %n (code=exited, status=0/SUCCESS)\n Main PID: 15090 (mysqld_safe)\n   CGroup: /system.slice/mariadb.service\n           tq15090 /bin/sh /usr/bin/mysqld_safe --basedir=/usr\n           mq15260 /usr/libexec/mysqld --basedir=/usr --datadir=/var/lib/mysq...\n\n 8\u6708 17 20:10:34 localhost.localdomain systemd[1]: Starting MariaDB database...\n 8\u6708 17 20:10:34 localhost.localdomain mysqld_safe[15090]: 150817 20:10:34 m...\n 8\u6708 17 20:10:34 localhost.localdomain mysqld_safe[15090]: 150817 20:10:34 m...\n 8\u6708 17 20:10:36 localhost.localdomain systemd[1]: Started MariaDB database ...\nHint: Some lines were ellipsized, use -l to show in full.\n\n\n\u30b9\u30c6\u30fc\u30bf\u30b9\u304cactive (running)\u306b\u306a\u3063\u3066\u3044\u308b\u306e\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\n\nDB\u306eroot\u30d1\u30b9\u30ef\u30fc\u30c9\u5909\u66f4\nroot\u304c\u7a7a\u30d1\u30b9\u30ef\u30fc\u30c9\u306a\u306e\u3067\u3001\u30d1\u30b9\u30ef\u30fc\u30c9\u8a2d\u5b9a\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n\nMariaDB\n$ mysql -u root\nWelcome to the MariaDB monitor.  Commands end with ; or \\g.\nYour MariaDB connection id is 2\nServer version: 5.5.41-MariaDB MariaDB Server\n\nCopyright (c) 2000, 2014, Oracle, MariaDB Corporation Ab and others.\n\nType 'help;' or '\\h' for help. Type '\\c' to clear the current input statement.\n\nMariaDB [(none)]> SET PASSWORD FOR root@localhost=PASSWORD('\u4efb\u610f\u306e\u30d1\u30b9\u30ef\u30fc\u30c9');\nQuery OK, 0 rows affected (0.00 sec)\n\nMariaDB [(none)]> exit;\nBye\n\n\u78ba\u8a8d\n$ mysql -u root -p\nEnter password:\nWelcome to the MariaDB monitor.  Commands end with ; or \\g.\nYour MariaDB connection id is 3\nServer version: 5.5.41-MariaDB MariaDB Server\n\nCopyright (c) 2000, 2014, Oracle, MariaDB Corporation Ab and others.\n\nType 'help;' or '\\h' for help. Type '\\c' to clear the current input statement.\n\nMariaDB [(none)]>exit;\n\n\n\nEC-CUBE3\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\n\n\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3068\u5c55\u958b\n\nconsole\n$ cd ~\n$ curl -O http://downloads.ec-cube.net/src/eccube-3.0.2.tar.gz\n$ tar -xvf eccube-3.0.2.tar.gz\n\n\n\n\u914d\u7f6e\n\u914d\u7f6e\u5834\u6240\u306f/var/lib\u3084/opt\u306a\u3069\u304c\u4e00\u822c\u7684\u3067\u3059\u3002\u4eca\u56de\u306f/var/lib\u306b\u914d\u7f6e\u3057\u307e\u3059\u3002\n\nconsole\n$ sudo mv ~/eccube-3.0.2 /var/lib\n\n\nnginx\u306e\u30d7\u30ed\u30bb\u30b9\u304b\u3089\u30a2\u30af\u30bb\u30b9\u3059\u308b\u306e\u3067\u3001\u30aa\u30fc\u30ca\u30fc\u3092\u5909\u66f4\u3057\u307e\u3059\u3002\n\nconsole\n$ sudo chown -R nginx:nginx /var/lib/eccube-3.0.2/\n\n\n\nnginx.conf\n\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u7de8\u96c6\u3057\u307e\u3059\u3002\n\n/etc/nginx/nginx.conf\n    server {\n...\u4e2d\u7565...\n        root         /var/lib/eccube-3.0.2/html\n...\u4e2d\u7565...\n# \u304b\u306a\u3089\u305a\u3053\u306e\u9806\u5e8f\u3067location\u3092\u6307\u5b9a\u3057\u3066\u304f\u3060\u3055\u3044\u3002install.php\u304cindex.php\u306b\u98db\u3070\u3055\u308c\u3066\u3057\u307e\u3044\u307e\u3059\u3002\n        location ~ \\.php {\n            fastcgi_pass    127.0.0.1:9000;\n            fastcgi_split_path_info ^(.+\\.php)(.*)$;\n            fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;\n            include fastcgi_params;\n\n        }\n\n        location / {\n            index index.php\n            try_files $uri $uri/ /index.php$uri;\n        }\n\n\n\n\nDB\u4f5c\u6210\n\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\uff08\u30b9\u30ad\u30fc\u30de\uff09\u3068\u30e6\u30fc\u30b6\u30fc\u3092\u4f5c\u6210\u3057\u3066\u3001\u30a2\u30af\u30bb\u30b9\u6a29\u3092\u4e0e\u3048\u307e\u3059\u3002\n\n\n\n\n\n\n\n\n\n\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u540d\uff08\u30b9\u30ad\u30fc\u30de\uff09\neccube\n\n\n\u30e6\u30fc\u30b6\u30fc\u540d\neccube_user\n\n\n\u30d1\u30b9\u30ef\u30fc\u30c9\neccube_pass\n\n\n\n\nconsole\n$ mysql -u root -p\n\nMariaDB [(none)]> create schema eccube;\nQuery OK, 1 row affected (0.01 sec)\nMariaDB [(none)]> grant all privileges on eccube.* to 'eccube_user'@'localhost' identified by 'eccube_pass';\nQuery OK, 0 rows affected (0.00 sec)\nMariaDB [(none)]> exit;\n\n\n\nWeb\u753b\u9762\u304b\u3089\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\n\u30c8\u30c3\u30d7\u753b\u9762\u306b\u30a2\u30af\u30bb\u30b9\u3059\u308b\u3068\u3001\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u753b\u9762\u3078\u98db\u3070\u3055\u308c\u307e\u3059\u3002\nhttp://yourhostname.com/\n\u753b\u9762\u306b\u5f93\u3063\u3066\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\u3057\u3066\u304f\u3060\u3055\u3044\u3002\neccube3\u3092\u52d5\u304b\u3059\u306e\u306b\u5fc5\u8981\u306a\u57fa\u672c\u7684\u306a\u624b\u9806\u3092\u8a18\u8ff0\u3057\u307e\u3059\u3002\n\u5b9f\u969b\u306b\u904b\u7528\u3059\u308b\u5834\u5408\u306f\u306fSSL\u901a\u3057\u305f\u308a\u3001\u7ba1\u7406\u753b\u9762\u96a0\u3057\u305f\u308a\u3001\u3044\u308d\u3044\u308d\u3068\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u5bfe\u7b56\u304c\u5fc5\u8981\u306b\u306a\u308a\u307e\u3059\u3002\u3042\u304f\u307e\u3067\u8a66\u7528\u624b\u9806\u3068\u3057\u3066\u53c2\u7167\u304f\u3060\u3055\u3044\u3002*\u672c\u6295\u7a3f\u3092\u53c2\u8003\u306b\u3057\u3066\u751f\u3058\u305f\u3044\u304b\u306a\u308b\u554f\u984c\u3082\u5f53\u65b9\u3067\u306f\u8cac\u4efb\u3092\u8ca0\u3044\u304b\u306d\u307e\u3059\u3002*\n\n#\u57fa\u672c\u7684\u306aLAMP\u4e92\u63db\u74b0\u5883\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\n\u57fa\u672c\u7684\u306b\u306f[\u3053\u3061\u3089](http://qiita.com/egnr-in-6matroom/items/8bda88125f56ee68448a#nginxhttp%E3%82%B5%E3%83%BC%E3%83%90%E3%83%BC) \u3092\u53c2\u8003\u306b\u3002\n\n\u74b0\u5883\n\n* CentOS7.1\n* nginx 1.6.3\n* MariaDB 5.5.41\n* PHP 5.4.16\n* eccube-3.0.2\n\n## epel\u30ea\u30dd\u30b8\u30c8\u30ea\u6709\u52b9\u5316\n\n\u983b\u7e41\u306b\u5229\u7528\u3059\u308b\u306e\u3067\u3001epel\u30ea\u30dd\u30b8\u30c8\u30ea\u3092\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n\n```bash:console\n$ sudo yum install epel-release\n```\n##\u30ea\u30dd\u30b8\u30c8\u30ea\u66f4\u65b0\n\u6700\u65b0\u306b\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n\n```bash:console\n$ sudo yum update\n```\n\n## SELinux \u7121\u52b9\u5316\n\u624b\u9806\u3092\u7c21\u6613\u306b\u3059\u308b\u305f\u3081\u3001Permissive\u306b\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n\n```bash:console\n$ sudo setenforce 0\n```\n\n## nginx\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n###\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n```bash:console\nsudo yum install nginx\n```\n\n###\u30b5\u30fc\u30d3\u30b9\u306e\u8d77\u52d5\n\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u304c\u5b8c\u4e86\u3057\u305f\u3089\u30b5\u30fc\u30d3\u30b9\u3092\u5b9f\u884c\u3057\u307e\u3059\u3002\n\u30b5\u30fc\u30d3\u30b9\u3092\u6709\u52b9\u306b\u3057\u3066\u81ea\u52d5\u3067\u8d77\u52d5\u3059\u308b\u3088\u3046\u306b\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n\n```bash:console\n\u30b5\u30fc\u30d3\u30b9\u6709\u52b9\u5316\n$ sudo systemctl enable nginx\nln -s '/usr/lib/systemd/system/nginx.service' '/etc/systemd/system/multi-user.target.wants/nginx.service'\n\nnginx\u8d77\u52d5\n$ sudo systemctl start nginx\n\n\u30b9\u30c6\u30fc\u30bf\u30b9\u78ba\u8a8d\n$ sudo systemctl status nginx\nnginx.service - The nginx HTTP and reverse proxy server\n   Loaded: loaded (/usr/lib/systemd/system/nginx.service; enabled)\n   Active: active (running) since Fri 2015-02-00 00:00:00 JST; 10s ago\n  Process: 22314 ExecStart=/usr/sbin/nginx (code=exited, status=0/SUCCESS)\n  Process: 22312 ExecStartPre=/usr/sbin/nginx -t (code=exited, status=0/SUCCESS)\n Main PID: 22316 (nginx)\n   CGroup: /system.slice/nginx.service\n           \u251c\u250022316 nginx: master process /usr/sbin/nginx\n           \u2514\u250022317 nginx: worker process\n\nFeb 00 00:00:00 localhost.localdomain systemd[1]: Starting The nginx HTTP and reverse proxy server...\nFeb 00 00:00:00 localhost.localdomain nginx[22312]: nginx: the configuration file /etc/nginx/nginx.conf syntax is ok\nFeb 00 00:00:00 localhost.localdomain nginx[22312]: nginx: configuration file /etc/nginx/nginx.conf test is successful\nFeb 00 00:00:00 localhost.localdomain systemd[1]: Failed to read PID from file /run/nginx.pid: Invalid argument\nFeb 00 00:00:00 localhost.localdomain systemd[1]: Started The nginx HTTP and reverse proxy server.\n```\n\u30b9\u30c6\u30fc\u30bf\u30b9\u304cactive (running)\u306b\u306a\u3063\u3066\u3044\u308b\u306e\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\n\n###Firewall\u30dd\u30fc\u30c8\u958b\u653e\n```bash:console\nhttp\u3092\u5e38\u306b\u958b\u653e\n$ sudo firewall-cmd --add-service=http --permanent\nsuccess\n\n\u8a2d\u5b9a\u30ea\u30ed\u30fc\u30c9\n$ sudo firewall-cmd --reload\nsuccess\n\n\u52d5\u4f5c\u78ba\u8a8d\n$ sudo firewall-cmd --list-service\ndhcpv6-client http mysql ssh\n```\nhttp\u304c\u542b\u307e\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3057\u3066\u4e0b\u3055\u3044\u3002\n###\u78ba\u8a8d\nnginx\u304cstarted\u306b\u306a\u3063\u3066\u3044\u305f\u3089\u3001\u5b9f\u969b\u306bhttp\u3067\u30a2\u30af\u30bb\u30b9\u3057\u3066\u307f\u307e\u3059\u3002\n\n```bash:console\n$ curl localhost\n<!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.1//EN\" \"http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd\">\n\n<html xmlns=\"http://www.w3.org/1999/xhtml\" xml:lang=\"en\">\n    <head>\n        <title>Test Page for the Nginx HTTP Server on Fedora</title>\n        <meta http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-8\" />\n(\u7701\u7565\uff09\n```\nnginx\u306e\u30c6\u30b9\u30c8\u30da\u30fc\u30b8\u306e\u30bd\u30fc\u30b9\u304c\u8fd4\u3063\u3066\u304d\u307e\u3059\u3002\u30d6\u30e9\u30a6\u30b6\u3067\u3082\u78ba\u8a8d\u3057\u3066\u307f\u3066\u304f\u3060\u3055\u3044\u3002\n\n##PHP\uff08FastCGI\uff09\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\nfastCGI\u3068\u3057\u3066\u52d5\u4f5c\u3059\u308bPHP-fpm\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\n\u307e\u305f\u3001ec-cube3\u306b\u5fc5\u8981\u306a\u30e2\u30b8\u30e5\u30fc\u30eb\u3082\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\n\u8a73\u3057\u304f\u306f\u3053\u3061\u3089\u3092\u53c2\u8003\u306b\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n[ec-cube \u30bd\u30d5\u30c8\u30a6\u30a7\u30a2\u8981\u4ef6\uff083.0\u7cfb\uff09](https://www.ec-cube.net/product/system.php)\n\u203bphp-hash\u306fmysqli\u306e\u4f9d\u5b58\u30d1\u30c3\u30b1\u30fc\u30b8\u3067\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u307e\u3059\u3002\n\n###\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n```\n$ sudo yum install php-fpm php-mbstring php-mysqli php-mcrypt php-apc\n\n\u30b5\u30fc\u30d3\u30b9\u6709\u52b9\u5316\n$ sudo systemctl enable php-fpm\n\n\u8d77\u52d5\n$ sudo systemctl start php-fpm\n\n\u30b9\u30c6\u30fc\u30bf\u30b9\u78ba\u8a8d\n$ sudo systemctl status php-fpm\nphp-fpm.service - The PHP FastCGI Process Manager\n   Loaded: loaded (/usr/lib/systemd/system/php-fpm.service; enabled)\n   Active: active (running) since \u6708 2015-08-17 21:45:15 JST; 7s ago\n Main PID: 22894 (php-fpm)\n   Status: \"Ready to handle connections\"\n   CGroup: /system.slice/php-fpm.service\n           tq22894 php-fpm: master process (/etc/php-fpm.conf)\n           tq22896 php-fpm: pool www\n           tq22897 php-fpm: pool www\n           tq22898 php-fpm: pool www\n           tq22899 php-fpm: pool www\n           mq22900 php-fpm: pool www\n\n 8\u6708 17 21:45:15 localhost.localdomain systemd[1]: Starting The PHP FastCGI ...\n 8\u6708 17 21:45:15 localhost.localdomain systemd[1]: Started The PHP FastCGI P...\nHint: Some lines were ellipsized, use -l to show in full.\n```\n###\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u7de8\u96c6\n####php.ini\u306e\u8a2d\u5b9a\n\n875\u884c\u76ee\u3042\u305f\u308a\u306e[Date]\u3067timezone\u3092`Asia/Tokyo`\u306b\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n\n```bash:console\n$ sudo vi /etc/php.ini\n```\n\n```ini:/etc/php.ini\n[Date]\n; Defines the default timezone used by the date functions\n; http://php.net/date.timezone\n; date.timezone =\ndate.timezone = \"Asia/Tokyo\"\n```\n\n####www\\.conf \u306e\u8a2d\u5b9a\n\n```bash:console\n$ sudo vi /etc/php-fpm.d/www.conf\n```\n\nproxy\u304capache\u3058\u3083\u306a\u304f\u3066nginx\u306a\u306e\u3067\u3001php-fpm\u306e\u30d7\u30ed\u30bb\u30b9\u30e6\u30fc\u30b6\u30fc\u3082nginx\u306b\u5909\u66f4\u3057\u3066\u304a\u304d\u307e\u3059\u300235\u884c\u76ee\u3042\u305f\u308a\u306b\u30d7\u30ed\u30bb\u30b9\u95a2\u9023\u306e\u8a2d\u5b9a\u304c\u3042\u308a\u308b\u306e\u3067\u3001user\u3068group\u3092`apache`\u304b\u3089`nginx`\u306b\u5909\u66f4\u3057\u307e\u3059\u3002\n\n```ini:/etc/php-fpm.d/www.conf\n; Unix user/group of processes\n; Note: The user is mandatory. If the group is not set,\u3000the default user's group\n;       will be used.\n; RPM: apache Choosed to be able to access some dir as httpd\n; user = apache\nuser = nginx\n; RPM: Keep a group allowed to write in log dir.\n; group = apache\ngroup = nginx\n```\nrestart\u3057\u3066\u8a2d\u5b9a\u3092\u53cd\u6620\u3057\u307e\u3059\u3002\n\n```bash:console\n$ sudo systemctl restart php-fpm\n$ sudo systemctl status php-fpm\n```\n\u30ef\u30fc\u30ab\u30fc\u30d7\u30ed\u30bb\u30b9\u306e\u30e6\u30fc\u30b6\u30fc\u304cnginx\u306b\u306a\u3063\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\n\n```bash:console\n$ ps -ef | grep php\nroot     23063     1  0 22:21 ?        00:00:00 php-fpm: master process (/etc/php-fpm.conf)\nnginx    23065 23063  0 22:21 ?        00:00:00 php-fpm: pool www\nnginx    23066 23063  0 22:21 ?        00:00:00 php-fpm: pool www\nnginx    23067 23063  0 22:21 ?        00:00:00 php-fpm: pool www\nnginx    23068 23063  0 22:21 ?        00:00:00 php-fpm: pool www\nnginx    23069 23063  0 22:21 ?        00:00:00 php-fpm: pool www\n```\n\n###\u30bb\u30c3\u30b7\u30e7\u30f3\u306e\u4fdd\u7ba1\u5834\u6240\n`/var/lib/php/session`\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u4fdd\u7ba1\u3055\u308c\u307e\u3059\u3002\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092\u4f5c\u6210\u3057\u3066\u3001\u6240\u6709\u8005\u3092nginx\u306b\u5909\u66f4\u3057\u307e\u3059\u3002\n\n```bash:console\n$ sudo mkdir /var/lib/php/session\n$ sudo chown nginx:nginx /var/lib/php/session\n```\n\n## MariaDB\uff08MySQL\u4e92\u63db\uff09\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\n\u57fa\u672c\u7684\u306b\u306fMySQL\u3068\u540c\u3058\u3067\u3059\u3002MariaDB5.5\u306b\u3066EC-Cube3\u52d5\u4f5c\u78ba\u8a8d\u3057\u307e\u3057\u305f\u3002\n###\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n```bash:console\n$ sudo yum install mariadb mariadb-server\n```\n###\u30b5\u30fc\u30d3\u30b9\u306e\u8d77\u52d5\n```bash:console\n\u30b5\u30fc\u30d3\u30b9\u6709\u52b9\u5316\n$ sudo systemctl enable mariadb\nln -s '/usr/lib/systemd/system/mariadb.service' '/etc/systemd/system/multiuser.target.wants/mariadb.service'\n\n\u30b5\u30fc\u30d3\u30b9\u306e\u8d77\u52d5\n$ sudo systemctl start mariadb\n\u30b9\u30c6\u30fc\u30bf\u30b9\u78ba\u8a8d\nmariadb.service - MariaDB database server\n   Loaded: loaded (/usr/lib/systemd/system/mariadb.service; enabled)\n   Active: active (running) since \u6708 2015-08-17 20:10:36 JST; 6min ago\n  Process: 15091 ExecStartPost=/usr/libexec/mariadb-wait-ready $MAINPID (code=exited, status=0/SUCCESS)\n  Process: 15063 ExecStartPre=/usr/libexec/mariadb-prepare-db-dir %n (code=exited, status=0/SUCCESS)\n Main PID: 15090 (mysqld_safe)\n   CGroup: /system.slice/mariadb.service\n           tq15090 /bin/sh /usr/bin/mysqld_safe --basedir=/usr\n           mq15260 /usr/libexec/mysqld --basedir=/usr --datadir=/var/lib/mysq...\n\n 8\u6708 17 20:10:34 localhost.localdomain systemd[1]: Starting MariaDB database...\n 8\u6708 17 20:10:34 localhost.localdomain mysqld_safe[15090]: 150817 20:10:34 m...\n 8\u6708 17 20:10:34 localhost.localdomain mysqld_safe[15090]: 150817 20:10:34 m...\n 8\u6708 17 20:10:36 localhost.localdomain systemd[1]: Started MariaDB database ...\nHint: Some lines were ellipsized, use -l to show in full.\n```\n\u30b9\u30c6\u30fc\u30bf\u30b9\u304cactive (running)\u306b\u306a\u3063\u3066\u3044\u308b\u306e\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\n\n###DB\u306eroot\u30d1\u30b9\u30ef\u30fc\u30c9\u5909\u66f4\nroot\u304c\u7a7a\u30d1\u30b9\u30ef\u30fc\u30c9\u306a\u306e\u3067\u3001\u30d1\u30b9\u30ef\u30fc\u30c9\u8a2d\u5b9a\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n\n```mysql:MariaDB\n$ mysql -u root\nWelcome to the MariaDB monitor.  Commands end with ; or \\g.\nYour MariaDB connection id is 2\nServer version: 5.5.41-MariaDB MariaDB Server\n\nCopyright (c) 2000, 2014, Oracle, MariaDB Corporation Ab and others.\n\nType 'help;' or '\\h' for help. Type '\\c' to clear the current input statement.\n\nMariaDB [(none)]> SET PASSWORD FOR root@localhost=PASSWORD('\u4efb\u610f\u306e\u30d1\u30b9\u30ef\u30fc\u30c9');\nQuery OK, 0 rows affected (0.00 sec)\n\nMariaDB [(none)]> exit;\nBye\n\n\u78ba\u8a8d\n$ mysql -u root -p\nEnter password:\nWelcome to the MariaDB monitor.  Commands end with ; or \\g.\nYour MariaDB connection id is 3\nServer version: 5.5.41-MariaDB MariaDB Server\n\nCopyright (c) 2000, 2014, Oracle, MariaDB Corporation Ab and others.\n\nType 'help;' or '\\h' for help. Type '\\c' to clear the current input statement.\n\nMariaDB [(none)]>exit;\n```\n\n#EC-CUBE3\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\n\n##\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3068\u5c55\u958b\n\n```bash:console\n$ cd ~\n$ curl -O http://downloads.ec-cube.net/src/eccube-3.0.2.tar.gz\n$ tar -xvf eccube-3.0.2.tar.gz\n```\n\n##\u914d\u7f6e\n\u914d\u7f6e\u5834\u6240\u306f`/var/lib`\u3084`/opt`\u306a\u3069\u304c\u4e00\u822c\u7684\u3067\u3059\u3002\u4eca\u56de\u306f`/var/lib`\u306b\u914d\u7f6e\u3057\u307e\u3059\u3002\n\n```bash:console\n$ sudo mv ~/eccube-3.0.2 /var/lib\n```\n\nnginx\u306e\u30d7\u30ed\u30bb\u30b9\u304b\u3089\u30a2\u30af\u30bb\u30b9\u3059\u308b\u306e\u3067\u3001\u30aa\u30fc\u30ca\u30fc\u3092\u5909\u66f4\u3057\u307e\u3059\u3002\n\n```bash:console\n$ sudo chown -R nginx:nginx /var/lib/eccube-3.0.2/\n```\n\n## nginx.conf\n\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u7de8\u96c6\u3057\u307e\u3059\u3002\n\n\n```conf:/etc/nginx/nginx.conf\n    server {\n...\u4e2d\u7565...\n        root         /var/lib/eccube-3.0.2/html\n...\u4e2d\u7565...\n# \u304b\u306a\u3089\u305a\u3053\u306e\u9806\u5e8f\u3067location\u3092\u6307\u5b9a\u3057\u3066\u304f\u3060\u3055\u3044\u3002install.php\u304cindex.php\u306b\u98db\u3070\u3055\u308c\u3066\u3057\u307e\u3044\u307e\u3059\u3002\n        location ~ \\.php {\n            fastcgi_pass    127.0.0.1:9000;\n            fastcgi_split_path_info ^(.+\\.php)(.*)$;\n            fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;\n            include fastcgi_params;\n\n        }\n\n        location / {\n            index index.php\n            try_files $uri $uri/ /index.php$uri;\n        }\n\n```\n##DB\u4f5c\u6210\n\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\uff08\u30b9\u30ad\u30fc\u30de\uff09\u3068\u30e6\u30fc\u30b6\u30fc\u3092\u4f5c\u6210\u3057\u3066\u3001\u30a2\u30af\u30bb\u30b9\u6a29\u3092\u4e0e\u3048\u307e\u3059\u3002\n\n| | |\n|-------------------------|--------|\n| \u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u540d\uff08\u30b9\u30ad\u30fc\u30de\uff09| eccube |\n| \u30e6\u30fc\u30b6\u30fc\u540d | eccube_user |\n| \u30d1\u30b9\u30ef\u30fc\u30c9 | eccube_pass |\n\n```mysql:console\n$ mysql -u root -p\n\nMariaDB [(none)]> create schema eccube;\nQuery OK, 1 row affected (0.01 sec)\nMariaDB [(none)]> grant all privileges on eccube.* to 'eccube_user'@'localhost' identified by 'eccube_pass';\nQuery OK, 0 rows affected (0.00 sec)\nMariaDB [(none)]> exit;\n```\n\n##Web\u753b\u9762\u304b\u3089\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\n\u30c8\u30c3\u30d7\u753b\u9762\u306b\u30a2\u30af\u30bb\u30b9\u3059\u308b\u3068\u3001\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u753b\u9762\u3078\u98db\u3070\u3055\u308c\u307e\u3059\u3002\n\nhttp\\://yourhostname.com/\n\n\u753b\u9762\u306b\u5f93\u3063\u3066\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n", "tags": ["nginx", "PHP", "centos7", "EC-CUBE3"]}