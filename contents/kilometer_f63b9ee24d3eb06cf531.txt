{"context": "\u3053\u306e\u8a18\u4e8b\u306f\u3001R Advent Calendar 2016\u306e10\u65e5\u76ee\u306e\u8a18\u4e8b\u3067\u3059\u3002\n\u6628\u65e5\u306fcallmekohei\u69d8\u306eR\u8a00\u8a9e\u3092\u4f7f\u3063\u3066\u30ed\u30c86\u3092\u5f53\u3066\u3066\u307f\u308b\uff01\u3067\u3057\u305f\u3002\n\nintro\n\u305d\u306e\u6614\u3001\u6606\u866b\u5c11\u5e74?\u3060\u3063\u305f\u6642\u4ee3\u306f\u3001AmarygminaeAmarygminaeAmarygminae\u3068\u3044\u3046\u9023\u4e2d\u3092\u76f8\u624b\u306b\u3057\u3066\u3044\u307e\u3057\u305f\u3002\n\u4e0a\u4f4d\u5206\u985e\u304cTenebrionidaeTenebrionidaeTenebrionidae\u3068\u8a00\u3044\u307e\u3057\u3066\u3001\u65e5\u672c\u8a9e\u3067\u306f\u30b4\u30df\u30e0\u30b7\u30c0\u30de\u30b7\u3068\u547c\u3073\u307e\u3059\u3002\n\u3053\u306e\u4ed6\u306b\u3082\u3001\u30ab\u30df\u30ad\u30ea\u30e2\u30c9\u30ad\u3001\u30cb\u30bb\u30de\u30b0\u30bd\u30b3\u30ac\u30cd\u3068\u304b\u3001\u305d\u30fc\u3086\u30fc\u306e\u304c\u5927\u597d\u304d\u3067\u3057\u305f\u3002\n\u3053\u306e\u7cfb\u7d71\u306e\u540d\u524d\u3067\u6587\u53e5\u7121\u3057\u306e\u30c1\u30e3\u30f3\u30d4\u30aa\u30f3\u306f\u3001\u30cb\u30bb\u30cf\u30e0\u30b7\u30c0\u30de\u30b7\u3067\u3057\u3087\u3046\u306d\u3002\n\u30cf\u30e0\u30b7\u3082\u3001\u305d\u308c\u306b\u4f3c\u305f\u30cf\u30e0\u30b7\u30c0\u30de\u30b7\u3082\u3061\u3083\u3093\u3068\u3044\u307e\u3059\u3002\n\u30cf\u30e0\u30b7\u30c0\u30de\u30b7\u306b\u4f3c\u3066\u975e\u306a\u308b\u30e0\u30b7\u3092\u898b\u3064\u3051\u3061\u3083\u3063\u305f\u304b\u3089\u3001\u30cb\u30bb\u30cf\u30e0\u30b7\u30c0\u30de\u30b7\u3002\n\u3061\u306a\u307f\u306b\u3001\u30cf\u30e0\u30b7\u30e2\u30c9\u30ad\u3068\u3044\u3046\u9023\u4e2d\u3082\u3044\u307e\u3059\u304c\u3001\n\u5be1\u805e\u306b\u3057\u3066\u3001\u30cb\u30bb\u30cf\u30e0\u30b7\u30e2\u30c9\u30ad\u306e\u5b58\u5728\u306f\u77e5\u308a\u307e\u305b\u3093\u3002\n\u3075\u3075\u3075\n\n\u30aa\u30c8\u30ca\u30c0\u30de\u30b7\n\u3048\u30fc\u3068\u3001\u4f55\u3067\u3057\u305f\u3063\u3051\u3002\n\u305d\u3046\u3002\n\u4eba\u524d\u3067\u30d7\u30ec\u30bc\u30f3\u30c6\u30fc\u30b7\u30e7\u30f3\u3092\u3059\u308b\u6a5f\u4f1a\u3001\u7d50\u69cb\u3042\u308a\u307e\u3059\u3088\u306d\u3002\uff08\u306d\uff01\uff01\uff09\n\u305d\u3093\u306a\u6642\u306b\u3001\u3050\u308b\u3050\u308b\u56de\u3063\u305f\u308a\u3001\u3050\u308a\u3050\u308a\u52d5\u3044\u305f\u308a\u3001\u30e2\u30ce\u30b9\u30b4\u30af\u30ab\u30e9\u30d5\u30eb\u3060\u3063\u305f\u308a\u3001\u305d\u3093\u306aFigure\u3092\u7686\u3055\u3093\u51fa\u3055\u308c\u307e\u3059\u3088\u306d\u3002\u3067\u3082\u3001\u5b9f\u969b\u306e\u30c7\u30fc\u30bf\u5206\u6790\u306b\u304a\u3044\u3066\u30013D\u30d7\u30ed\u30c3\u30c8\u3092\u66f8\u3044\u3066\u51c4\u304f\u7814\u7a76\u304c\u9032\u3080\u306e\u304b\uff1f\u3001\u3050\u308a\u3050\u308a\u52d5\u304b\u305b\u308b\u3068\u8ad6\u6587\u304c\u66f8\u3051\u308b\u306e\u304b\uff1f\u3068\u8a00\u308f\u308c\u308b\u3068\u3001\u307e\u3041\u3001\u7121\u3044\u3068\u601d\u3044\u307e\u3059\u306d\u3002\n\u3053\u3046\u3057\u305fFigure\u304c\u5f79\u306b\u7acb\u3064\u306e\u306f\u3001\u7dfb\u5bc6\u306a\u8ad6\u7406\u3092\u7a4d\u307f\u91cd\u306d\u3066\u8aac\u660e\u3059\u308b\u5834\u9762\u3067\u306f\u306a\u304f\u3001\u77ed\u6642\u9593\u3067\u6982\u8981\u3092\u76f4\u611f\u7684\u306b\u7406\u89e3\u3057\u3066\u3082\u3089\u3046(\u7406\u89e3\u3057\u305f\u6c17\u306b\u306a\u3063\u3066\u3082\u3089\u3046)\u5834\u9762\u306a\u306e\u3067\u3001\u901a\u79f0\u3001\u30aa\u30c8\u30ca\u30c0\u30de\u30b7\u3001\u3067\u3059\u3002\n\u4eca\u56de\u306f\u3001\u5fae\u5206\u65b9\u7a0b\u5f0f\u3092\u5206\u304b\u3063\u305f\u3075\u308a\u3092\u3059\u308b\u3001\u3068\u3044\u3046\u30aa\u30c8\u30ca\u30c0\u30de\u30b7\u3067\u3059\u3002\n\u305d\u3046\u8a00\u3048\u3070\u53bb\u5e74\u306eR\u30a2\u30c9\u30ab\u30ec\u306b\u66f8\u3044\u305f\u8a18\u4e8b\u3082\u52d5\u753b\u3067\u30d4\u30ab\u30d4\u30ab\u7cfb\u3067\u3057\u305f\u3002\n\n\u529b\u5b66\u7cfb dynamical system\n\u4eca\u56de\u306e\u6559\u79d1\u66f8\u306f\u3001\u300e\u751f\u7269\u30ea\u30ba\u30e0\u3068\u529b\u5b66\u7cfb\u300f\u3067\u3059\u3002(\u4e3b\u306b2\u7ae0)\n\u529b\u5b66\u7cfb\u3068\u3044\u3046\u7528\u8a9e\u304c\u30ad\u30fc\u30ef\u30fc\u30c9\u3067\u3059\u304c\u3001\u5b9a\u7fa9\u3092\u5f15\u7528(p.14)\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n\n\u6642\u9593\u767a\u5c55\u3059\u308b\u3042\u308a\u3068\u3042\u3089\u3086\u308b\u5bfe\u8c61\u306f\u529b\u5b66\u7cfb(dynamical systems)\u3068\u547c\u3070\u308c\u308b. \u529b\u5b66\u7cfb\u3068\u3044\u3046\u65e5\u672c\u8a9e\u3092\u805e\u304f\u3068\u529b\u5b66\u306e\u4e00\u7a2e\u306b\u611f\u3058\u308b\u304b\u3082\u3057\u308c\u306a\u3044\u304c\u3001\u82f1\u8a9e\u304b\u3089\u308f\u304b\u308b\u901a\u308a\u6642\u9593\u767a\u5c55\u3059\u308b\u3082\u306e\u4e00\u822c\u3092\u53d6\u308a\u6271\u3046\u5e83\u3044\u67a0\u7d44\u307f\u3067\u3042\u308b.\n\n\u6642\u9593\u767a\u5c55\u3059\u308b\u73fe\u8c61\u3092\u6570\u7406\u7684\u306b\u8a18\u8ff0\u3059\u308b\u3002\n\u3053\u308c\u306fTnTnT_n\u304b\u3089Tn+1Tn+1T_{n+1}\u306e\u5909\u5316\u306e\u6cd5\u5247\u3092\u66f8\u304d\u4e0b\u3059\u4e8b\u306b\u306a\u308a\u307e\u3059\u3002\n\u30aa\u30c8\u30ca\u30c0\u30de\u30b7\u306e\u8a18\u4e8b\u306a\u306e\u3067\u3001\u53b3\u5bc6\u306a\u5b9a\u7fa9\u306f\u4ed6\u306b\u8b72\u308b\u3068\u3057\u307e\u3059\u304c\u3001\nf(x)f(x)f(x)\u3092\u9023\u7d9a\u306a\u95a2\u6570\u3068\u3057\u3066\u3001\u672a\u77e5\u95a2\u6570x=x(t)x=x(t)x=x(t)\u306b\u3064\u3044\u3066\u3001\ndxdt=f(x)(1)(1)dxdt=f(x){\\frac{dx}{dt}=f(x)\\tag{1}\n}\n\u3068\u3044\u3046\u3088\u3046\u306a\u3001\u6642\u9593\u5fae\u5206\u95a2\u6570\u3067\u73fe\u8c61\u3092\u8a18\u8ff0\u3059\u308b\u6570\u7406\u30e2\u30c7\u30eb\u4e00\u822c\u3068\u3044\u3046\u30a4\u30e1\u30fc\u30b8\u3067\u3059\u3002\n\u53f3\u8fba\u304c\u5f93\u5c5e\u5909\u6570xxx\u306e\u307f\u3067\u8868\u3055\u308c\u308b\u65b9\u7a0b\u5f0f\u3092\u81ea\u5f8b\u7cfb\u3068\u547c\u3073\u307e\u3059\u3002\n\u4eca\u56de\u306f\u3001\u3044\u304f\u3064\u304b\u306e\u81ea\u5f8b\u7cfb\u306e\u6642\u9593\u767a\u5c55\u3092\u30f4\u30a3\u30b8\u30e5\u30a2\u30e9\u30a4\u30ba(\u7b11)\u3059\u308b\u4e8b\u3067\u3001\u5206\u304b\u3063\u305f\u3075\u308a\u3092\u3057\u307e\u3057\u3087\u3046\u3002\n\npackages\n\u4eca\u56de\u306f\u3001\u3053\u306e3\u3064\u3092\u4f7f\u3044\u307e\u3057\u305f\u3002\n\u5168\u3066install.packages(\"hoge\")\u3067\u843d\u3068\u305b\u307e\u3059\u3002\n\u30b3\u30fc\u30c9\u3092\u306a\u305e\u308b\u969b\u306f\u3001\u4e8b\u524d\u306blibrary(\"hoge\")\u3067\u30a2\u30af\u30c6\u30a3\u30d9\u30fc\u30c8\u3057\u3066\u304a\u304d\u307e\u3057\u3087\u3046\u3002\n\u3000 {deSolve}: \u4eca\u56de\u306e\u30e1\u30a4\u30f3\u3002\n\u3000 {rgl}: \u304a\u7d75\u304b\u304d\u7528\u3067\u3059\u3002\n\u3000 {animation}: ImageMagic\u304c\u5fc5\u8981\u306b\u306a\u308a\u307e\u3059\u3002\n\u30d0\u30fc\u30b8\u30e7\u30f3\u60c5\u5831\u7b49\u8a73\u7d30\u306f\u3001Appendix\u306b\u3066\u3002\n\n\u5358\u7d14\u306a\u4f8b\u304b\u3089\n\u5f0f(1)\u306e\u6700\u9ad8\u306b\u30b7\u30f3\u30d7\u30eb\u306a\u4f8b\u306f\u3001\ndxdt=kxdxdt=kx{\\frac{dx}{dt}=kx\n}\n\u3067\u3059\u304c\u3001\u30f4\u30a3\u30b8\u30e5\u30a2\u30e9\u30a4\u30ba(\u7b11)\u7684\u306b\u306f\u3082\u3046\u5c11\u3057\u8907\u96d1\u306b\u3057\u3066\u3001\ndxdt=kx(1\u2212x)(2)(2)dxdt=kx(1\u2212x){\\frac{dx}{dt}=kx(1-x)\\tag{2}\n}\n\u3092\u8003\u3048\u307e\u3059\u3002\nR\u3067\u5fae\u5206\u65b9\u7a0b\u5f0f\u3092\u89e3\u304f\u305f\u3081\u306e\u30d1\u30c3\u30b1\u30fc\u30b8\u304c{deSolve}\u3067\u3059\u3002\n\u307e\u305a\u306f\u5f0f(2)\u3092\u6c7a\u307e\u3063\u305f\u69d8\u5f0f\u3067\u66f8\u304d\u4e0b\u3057\u305f\u95a2\u6570\u3092\u5b9a\u7fa9\u3057\u307e\u3059\u3002\nX <- function(t, state, parameters){\n  with(as.list(c(state, parameters)),{\n    dx <- k*x*(1-x)\n    list(c(dx))\n  })\n}\n\n\u3067\u3001\u30d1\u30e9\u30e1\u30fc\u30bf\u306e\u5024\u3068\u6642\u9593\u8ef8\u3068\u521d\u671f\u5024\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\nparameters <- c(k=1)\ntimes <- seq(0, 10, by=0.2)\ninitial <- c(x=0.5)\n\n\u3067\u3001\u30c9\u30c9\u30f3\u3063\u3068\u89e3\u3044\u3066\u3057\u307e\u3044\u307e\u3059\u3002\nout <- ode(y = initial, times = times, func = X, params = parameters)\n\n\u3082\u3046\u3001\u305d\u306e\u307e\u307eplot\u3067\u3044\u3051\u307e\u3059\u3002\n\nplot(out)\n\n\n\u8a08\u7b97\u3067\u304d\u3066\u305d\u3046\u3067\u3059\u306d\u3002\u3067\u3082\u3001\u3053\u308c\u3067\u306f\u30c0\u30de\u305b\u306a\u3044\u3002\n\u305d\u3053\u3067\u3001\u30aa\u30c8\u30ca\u30c0\u30de\u30b7\u7684\u306b\u306f\u3067\u3059\u306d\u3001\u30b4\u30b8\u30e7\u30b4\u30b8\u30e7\u3084\u3063\u3066\u2026\n\n\u3053\u3093\u306a\u611f\u3058\u3067\u3057\u3087\u3046\u304b\u3002\n\u51fa\u767a\u5730\u70b9(\u521d\u671f\u5024)\u304cx0<0x0<0x_0<0\u306e\u6642\u306f\u3001\u660e\u3089\u304b\u306b\u207b\u221e\u207b\u221e\u207b\u221e\u306b\u767a\u6563\u3067\u3059\u306d\u3002\nx0=0x0=0x_0=0\u306a\u3089\u3070\u3001\u5e38\u306bx=0x=0x=0\nx0>0x0>0x_0>0\u306a\u3089\u3070\u3001t\u2192\u221et\u2192\u221et\u2192\u221e\u306e\u6642\u3001x\u221e\u21921x\u221e\u21921x_\u221e\u21921\u3067\u3059\u306d\u3002\n\u3048\uff1f\u5f0f(2)\u304b\u3089\u660e\u3089\u304b\uff1f\u3048\u3048\u3002\u30f4\u30a3\u30b8\u30e5\u30a2\u30e9\u30a4\u30ba(\u7b11)\u3057\u3066\u307f\u307e\u3057\u305f\u3002\n\u3053\u306e\u30c0\u30de\u30b7\u7d75\u306e\u66f8\u304d\u65b9\u306f\u3001Appendix\u306b\u3066\u3002\n\n2\u5909\u6570\u306e\u5834\u5408\n\n\u30ed\u30c8\u30ab\u30fb\u30f4\u30a9\u30eb\u30c6\u30e9\u65b9\u7a0b\u5f0f Lotoka-Volterra equations\n\u901a\u79f0\u3001\u55b0\u3046\u304b\u55b0\u308f\u308c\u308b\u304b\u65b9\u7a0b\u5f0f\u3067\u3059\u3002\n\u55b0\u3046\u30c1\u30fc\u30e0X\u3068\u3001\u55b0\u308f\u308c\u308b\u30c1\u30fc\u30e0Y (\u3069\u3063\u3061\u3067\u3082\u3044\u3044\u3067\u3059\u304c)\u3092\u8003\u3048\u3066\u3001\u305d\u306e\u500b\u4f53\u6570\u5909\u52d5\u3092\u8868\u73fe\u3059\u308b\u6570\u7406\u30e2\u30c7\u30eb\u3067\u3059\u3002\u96e3\u3057\u3044\u8a71\u306f\u6559\u79d1\u66f8\u306b\u8b72\u308a\u307e\u3059\u3002\n\u6559\u79d1\u66f8\u306b\u7fd2\u3044\u30015\u3064\u306e\u6b63\u306e\u5b9f\u6570a,K,b,c,ra,K,b,c,ra, K, b, c, r\u3092\u7528\u3044\u3066\u3001\u66f8\u304d\u4e0b\u3059\u3068\u3001\ndxdtdydt==a(1\u2212x/K\u2212by)x(\u2212r+cx)y(3)dxdt=a(1\u2212x/K\u2212by)x(3)dydt=(\u2212r+cx)y{\\begin{eqnarray}\n\\frac{dx}{dt}&=&a(1-x/K-by)x \\\\\n\\frac{dy}{dt}&=&(-r+cx)y \\tag{3}\n\\end{eqnarray}\n}\n\u3082\u3046\u8aac\u660e\u3092\u3059\u3063\u98db\u3070\u3057\u3066\u3001\nX <- function(t, state, parameters){\n  with(as.list(c(state, parameters)),{\n    dx <- a * (1 - x/K - b*y)\n    dy <- (-r + c* x)*y\n    list(c(dx, dy))\n  })\n}\nparameters <- c(a = 1, K = 3, b = 0.2, r = 0.1, c = 0.05)\ntimes <- seq(0, 100, 0.5)\ninitial <- c(x=3, y=1)\nout <- ode(y = initial, times = times, func = X, parms = parameters)\n\n\nplot(out)\n\n\n\u304a\u3001\u5e73\u8861\u306b\u843d\u3061\u3066\u305d\u3046\u3067\u3059\u306d\u3002\n\u3067\u3001\u30a8\u30a4\u3084\uff01\uff01\n\n\u3069\u3053\u3092\u521d\u671f\u5024\u306b\u53d6\u3063\u3066\u3082\u3001\u25cf\u306e\u70b9\u306b\u53ce\u675f\u3057\u3066\u3044\u308b\u69d8\u5b50\u304c\u30f4\u30a3\u30b8\u30e5\u30a2\u30e9\u30a4\u30ba\u3055\u308c\u307e\u3057\u305f\u306d\uff01\n\u304b\u3089\u306e\u3001\u30c9\u30a9\u30fc\u30f3\uff01\uff01\n\n\u55b0\u3046\u5074\u3082\u55b0\u308f\u308c\u308b\u5074\u3082\u3001\u305d\u308a\u3083\u3041\u8272\u3005\u3042\u308a\u307e\u3059\u308f\u306a\u3002\n\u9152\u306f\u5451\u3093\u3067\u3082\u5451\u307e\u308c\u308b\u306a(\u81ea\u6212)\u3002\n\n\u30d5\u30a1\u30f3\u30fb\u30c7\u30a2\u30fb\u30dd\u30eb\u65b9\u7a0b\u5f0f Van der Pol equations\n\u96fb\u6c17\u56de\u8def\u306e\u81ea\u52b1\u767a\u632f\u306e\u30e2\u30c7\u30eb\u65b9\u7a0b\u5f0f\u3001\u3068\u304b\u3001\u305d\u3046\u3044\u3046\u4e8b\u306f\u4e00\u5207\u304b\u307e\u308f\u305a\u3001\ndxdtdydt==ax+y\u2212x3/3\u2212x(4)dxdt=ax+y\u2212x3/3(4)dydt=\u2212x{\\begin{eqnarray}\n\\frac{dx}{dt}&=&ax+y-x^3/3\\\\\n\\frac{dy}{dt}&=&-x\\tag{4}\n\\end{eqnarray}\n}\n\u3088\u3044\u3057\u3087\u3001\nX <- function(t, state, parameters){\n  with(as.list(c(state, parameters)),{\n    dx <- a * x + y - x^3/3\n    dy <- -x\n    list(c(dx, dy))\n  })\n}\ntimes <- seq(0, 100, 0.1)\nparameters <- c(a = 0.5)\ninitial <- c(x=3, y=1)\nout <- ode(y = initial, times = times, func = X, parms = parameters)\n\n\u304b\u3089\u306e\u3001\n\nplot(out)\n\n\n\u304a\u304a\u3002\u602a\u3057\u3044\u3002\n\u304b\u3089\u306e\u3001\n\n\u3082\u3046\u4e00\u58f0\u3001\n\n\u5b9f\u306b\u30aa\u30c8\u30ca\u30c0\u30de\u30b7\u611f\u6e80\u8f09\u3067\u3059\u306d\u3002\n\u3053\u30fc\u3086\u30fc\u53ce\u675f\u306e\u4ed5\u65b9\u3092\u30ea\u30df\u30c3\u30c8\u30b5\u30a4\u30af\u30eb\u3068\u547c\u3073\u307e\u3059\u3002\n\u9154\u3063\u6255\u3044\u30c8\u30fc\u30af\u306f\u3001\u30ea\u30df\u30c3\u30c8\u30b5\u30a4\u30af\u30eb\u3057\u306a\u3044\u3088\u3046\u306b\u6c17\u3092\u3064\u3051\u307e\u3057\u3087\u3046\uff08\u81ea\u6212\uff09\u3002\n\n\u6700\u5f8c\u306f\u3053\u308c\u3067\u3057\u3087\u3046\u3002\n\u4f55\u3082\u8aac\u660e\u3057\u306a\u3044\u3068\u3044\u3046\u66b4\u6319\u3002\n\u3044\u3084\u3001\u6709\u540d\u3059\u304e\u3066\u2026\u3002\n\u305d\u308c\u306b\u3057\u3066\u3082\u7f8e\u3057\u3044\u56f3\u5f62\u3067\u3059(\u6e9c\u3081\u606f)\u3002\nX <- function(t, state, parameters){\n  with(as.list(c(state, parameters)),{\n    dx <- a*(y-x)\n    dy <- r*x-y-x*z\n    dz <- -b*z + x*y\n    list(c(dx, dy, dz))\n  })\n}\n\nparameters <- c(a = 10, b=8/3, r=40)\ntimes <- seq(0, 200, 0.01)\ninitial <- c(x=0, y=0.1, z=0)\nout <- ode(y = initial, times = times, func = X, parms = parameters)\nCol <- colorRampPalette(c(\"#ff2800\",\"#ff9900\",\"#35a16b\", \"green\"))\n\nplot3d(out[,c(\"x\", \"y\", \"z\")], type=\"n\", box=F)\npoints3d(out[,c(\"x\", \"y\", \"z\")], col=Col(length(times)))\n\n\u3053\u306e\u30d7\u30ed\u30c3\u30c8\u3092\u5165\u308c\u305f.Rmd\u3092{rmarkdown}\u3067\u66f8\u304d\u3043\u306e\u3001{knitr}\u3067.html\u4f5c\u308a\u3043\u306e\u3001Github\u306b\u4e0a\u3052\u3047\u306e\u3001htmlPreview\u3067\u30d7\u30ec\u30d3\u30e5\u30fc\u3092\u51fa\u3057\u3043\u306e\u3001\u3055\u3066\u3001\u4e0a\u624b\u304f\u30ea\u30f3\u30af\u8cbc\u308c\u305f\u304b\u3069\u3046\u304b\u30fb\u30fb\u3053\u3053\u304b\u3089\u3069\u3046\u305e\n\u30b0\u30ea\u30b0\u30ea\u3057\u3066\u697d\u3057\u3093\u3067\u304f\u3060\u3055\u3044\u3002\n\u62e1\u5927\u7e2e\u5c0f\u3082\u3067\u304d\u307e\u3059\u3088\u3002\n\n\u3042\u3068\u304c\u304d\n\u305d\u3046\u3044\u3048\u3070\u4eca\u56de\u306f\u3001{ggplot2}\u3092\u4f7f\u308f\u306a\u304b\u3063\u305f\u3067\u3059\u3002\ndeSolve::ode\u306e\u51fa\u529b\u304cdataframe\u3067\u306f\u306a\u304fmatrix\u3067\u51fa\u529b\u3055\u308c\u308b\u305f\u3081\u304b\u3001\u7279\u306b\u610f\u8b58\u305b\u305aplot\u3067\u66f8\u3044\u3061\u3083\u3044\u307e\u3057\u305f\u3002\n\u3042\u3001\u305d\u3046\u3044\u3048\u3070{dplyr}\u3082{tidyr}\u3082\u51fa\u756a\u304c\u3042\u308a\u307e\u305b\u3093\u3067\u3057\u305f\u306d\u3002\nR\u30a2\u30c9\u30ab\u30ec\u306e\u304f\u305b\u306b...\n\u30cf\u30c9\u30ea\u30f4\u30a1\u30fc\u30b9\u306e\u65b9\u89d2\u306b43\u793c24\u62cd37\u793c\u3057\u3066\u3001\u5fa1\u795e\u9152\u3092\u5099\u3048\u3066\u304a\u304d\u307e\u3059\u306e\u3067\u8a31\u3057\u3066\u4e0b\u3055\u3044\u3002\nEnjoy!!\n\nAppendix\n\n\u74b0\u5883\n> sessionInfo()\nR version 3.3.1 (2016-06-21)\nPlatform: x86_64-apple-darwin13.4.0 (64-bit)\nRunning under: OS X 10.10.5 (Yosemite)\n\nattached base packages:\n[1] stats     graphics  grDevices utils     datasets  methods   base     \n\nother attached packages:\n[1] animation_2.4      rgl_0.96.0        deSolve_1.14 \n\n\n\u30aa\u30c8\u30ca\u30c0\u30de\u30b7\u305d\u306e1\n# \u30d1\u30c3\u30b1\u30fc\u30b8\u3092\u30a2\u30af\u30c6\u30a3\u30d9\u30fc\u30c8\nlibrary(\"deSolve\")\n# \u5fae\u5206\u65b9\u7a0b\u5f0f\u30fb\u521d\u671f\u5024\u306e\u8a2d\u5b9a\nX <- function(t, state, parameters){\n  with(as.list(c(state, parameters)),{\n    dx <- k*x*(1-x)\n    list(c(dx))\n  })\n}\nparameters <- c(k = 1)\ntimes <- seq(0, 10, 0.2)\n\n# \u521d\u671f\u5024\nN <- 100\nx <- seq(0, 2, length=N)\n\n# \u5fae\u5206\u65b9\u7a0b\u5f0f\u3092\u89e3\u304f\nout <- NULL\nfor(i in 1:N){\n  initial <- c(x=x[i])\n  out[[i]] <- ode(y = initial, times = times, func = X, parms = parameters)\n}\n\n# \u30d9\u30af\u30c8\u30eb\u59cb\u70b9\u306eY\u5ea7\u6a19\u3068\u89d2\u5ea6\nA <- seq(0, 2, by=0.1)\nsita <- atan(A*(1-A))\n\n# \u30b0\u30e9\u30d5\u30a3\u30c3\u30af\u30b9\u30d1\u30e9\u30e1\u30fc\u30bf\u306e\u6e96\u5099\npar(mgp=c(1.5, 0.3, 0), tcl=-0.2, mar=c(3,3,1,1))\n# \u753b\u9762\u306e\u7528\u610f\nplot(0,0, type=\"n\", xlim=c(0, 10), ylim=c(0, 2), xlab=\"time\", ylab=\"x\")\n\n# \u77e2\u5370\u3092\u66f8\u304f\u3002\u30b4\u30ea\u62bc\u3057\u3067\u3059\u3002\u3082\u3063\u3068\u7c21\u5358\u306b\u304b\u3051\u308b\u3068\u601d\u3046\u3051\u3069\u2026\nfor(i in 0:20){\n  for(j in 1:length(sita)){\n    if(0.4*abs(sin(sita[j])) < 0.1){\n      arrows(i/2, j*0.1-0.1, i/2 + 0.4*cos(sita[j]),\n           j*0.1 + 0.4*sin(sita[j])-0.1, length=0.15, col=\"darkgrey\")\n    }else{\n      arrows(i/2, j*0.1-0.1, i/2 - 0.1*cos(sita[j])/sin(sita[j]),\n             j*0.1-0.2, length=0.15, col=\"darkgrey\")\n    }\n}}\n# \u7dda\u306f\u30ab\u30e9\u30d5\u30eb\u306b\u30ad\u3081\u307e\u3057\u3087\u3046\u3002\nfor(i in 1:N){\n  lines(out[[i]], col=rainbow(N)[i])\n}\n\n\n\u30aa\u30c8\u30ca\u30c0\u30de\u30b7\u305d\u306e2\nset.seed(1)\n\nparameters <- c(a = 1, K = 3, b = 0.2, r = 0.1, c = 0.05)\n\nX <- function(t, state, parameters){\n  with(as.list(c(state, parameters)),{\n    dx <- a * (1 - x/K - b*y)\n    dy <- (-r + c* x)*y\n    list(c(dx, dy))\n  })\n}\n\n\n# \u59cb\u70b9\u306e\u521d\u671f\u5024\u3002\u3053\u3053\u3067\u3061\u3087\u3063\u3068\u30d0\u30e9\u3064\u304b\u305b\u308b\u306e\u304c\u30aa\u30c8\u30ca\u30c0\u30de\u30b7\u7684\u30c6\u30af\u30cb\u30c3\u30af\nN <- 360\nsita <- seq(0, 2*pi, length=N)\nx <- 2 * cos(sita) + 2.1 +runif(N, 0, 0.5)\ny <- 2 * sin(sita) + 2.1+runif(N, 0, 0.5)\n\n\ntimes <- seq(0, 100, 0.5)\nout <- NULL\nfor(i in 1:N){\n  initial <- c(x=x[i], y=y[i])\n  out[[i]] <- ode(y = initial, times = times, func = X, parms = parameters)\n}\n# \u8272\u306f\u30d3\u30ab\u30d3\u30ab\u306b\u30ad\u3081\u3088\u3046\u3002\nplot(0, 0, xlim=c(0,4.5), ylim=c(0, 4.5), type=\"n\", xlab=\"x\", ylab=\"y\")\nfor(i in 1:N)\n  lines(out[[i]][,2:3], col=rainbow(N)[i], lwd=1)\npoints(x,y, col=rainbow(N), pch=20, cex=1)\npoints(2, 5/3, pch=16, cex=1.5)\n\n# 3d\u30d7\u30ed\u30c3\u30c8\u306f\u3053\u3093\u306a\u611f\u3058\u3002\ndat_x <- NULL\ndat_y <- NULL\nfor(i in 1:N){\n    dat_x <- cbind(dat_x, out[[i]][,2])\n    dat_y <- cbind(dat_y, out[[i]][,3])\n}\nplot3d(0, 0, 0, xlim=c(0, 5), ylim=c(0,5), zlim=c(0,100), type=\"n\", box=F,\n       xlab=\"x\", ylab=\"y\", zlab=\"\")\n  points3d(dat_x[1,], dat_y[1,], rep(0, N), col=rainbow(N))\n  for(i in 1:N){\n    lines3d(dat_x[,i], dat_y[,i], times, col=rainbow(N)[i])\n  }\n\n\n\u30aa\u30c8\u30ca\u30c0\u30de\u30b7\u305d\u306e3\nset.seed(1)\n# \u3053\u3053\u5927\u4e8b\nX <- function(t, state, parameters){\n  with(as.list(c(state, parameters)),{\n    dx <- a * x + y - x^3/3\n    dy <- -x\n    list(c(dx, dy))\n  })\n}\n# \u6e96\u5099\nparameters <- c(a = 0.5)\nN <- 200\ntimes <- seq(0, 100, 0.1)\nr <- seq(0, 3.5, length=N) + runif(N, 0, 0.1)\nsita <- runif(N, 0, 2*pi)\nx <- r * cos(sita)\ny <- r * sin(sita)\nCol <- rainbow(N)\n# \u304c\u3093\u3070\u308b\nout <- NULL\nfor(i in 1:N){\n  initial <- c(x=x[i], y=y[i])\n  out[[i]] <- ode(y = initial, times = times, func = X, parms = parameters)\n}\n# \u304a\u7d75\u304b\u304d\npar(mgp=c(1.5, 0.3, 0), tcl=-0.2, mar=c(3,3,1,1))\nplot(0, 0, xlim=c(-3.5, 3.5), ylim=c(-3.5, 3.5), type=\"n\", xlab=\"x\", ylab=\"y\")\nfor(i in 1:N)\n  lines(out[[i]][,2:3], col=Col[i], lwd=1)\npoints(x,y, col=Col, pch=20, cex=1.5)\na <- sample(1:N,1)\nlines(out[[a]][,2:3], lwd=3)\npoints(x[a], y[a], pch=17, cex=3)\n\ndat_x <- NULL\ndat_y <- NULL\nfor(i in 1:N){\n  dat_x <- cbind(dat_x, out[[i]][,2])\n  dat_y <- cbind(dat_y, out[[i]][,3])\n} \n\n# {animation}\u3067\u3059\u3002\nsaveGIF({\n  ani.options(interval = 0.02,\n              convert = \"/opt/ImageMagic/bin/convert\")\n#  for(k in 1:length(times)){\n  for(k in 1:150){\n      par(mgp=c(1.5, 0.3, 0), tcl=-0.2, mar=c(3,3,1,1))\n    plot(0, 0, xlim=c(-3.5, 3.5), ylim=c(-3.5, 3.5), type=\"n\", xlab=\"x\", ylab=\"y\")\n    for(i in 1:N){\n      lines(out[[i]][,2:3], col=\"lightgrey\", lwd=1)\n    }\n    points(dat_x[k,], dat_y[k,], col=Col, pch=16, cex=1.2)\n  }},\n  movie.name = \"VP1.gif\",\n  ani.width=400, ani.height=400, clean=T\n)\n\n\u3053\u306e\u8a18\u4e8b\u306f\u3001[R Advent Calendar 2016](http://qiita.com/advent-calendar/2016/r-rstudio)\u306e10\u65e5\u76ee\u306e\u8a18\u4e8b\u3067\u3059\u3002\n\n\u6628\u65e5\u306fcallmekohei\u69d8\u306e[R\u8a00\u8a9e\u3092\u4f7f\u3063\u3066\u30ed\u30c86\u3092\u5f53\u3066\u3066\u307f\u308b\uff01](http://callmekohei00.hatenablog.com/entry/2016/12/08/205001)\u3067\u3057\u305f\u3002\n\n\n# intro\n\n\u305d\u306e\u6614\u3001\u6606\u866b\u5c11\u5e74?\u3060\u3063\u305f\u6642\u4ee3\u306f\u3001$Amarygminae$\u3068\u3044\u3046\u9023\u4e2d\u3092\u76f8\u624b\u306b\u3057\u3066\u3044\u307e\u3057\u305f\u3002\n\u4e0a\u4f4d\u5206\u985e\u304c$Tenebrionidae$\u3068\u8a00\u3044\u307e\u3057\u3066\u3001\u65e5\u672c\u8a9e\u3067\u306f\u30b4\u30df\u30e0\u30b7**\u30c0\u30de\u30b7**\u3068\u547c\u3073\u307e\u3059\u3002\n\u3053\u306e\u4ed6\u306b\u3082\u3001\u30ab\u30df\u30ad\u30ea**\u30e2\u30c9\u30ad**\u3001**\u30cb\u30bb**\u30de\u30b0\u30bd\u30b3\u30ac\u30cd\u3068\u304b\u3001\u305d\u30fc\u3086\u30fc\u306e\u304c\u5927\u597d\u304d\u3067\u3057\u305f\u3002\n\n\u3053\u306e\u7cfb\u7d71\u306e\u540d\u524d\u3067\u6587\u53e5\u7121\u3057\u306e\u30c1\u30e3\u30f3\u30d4\u30aa\u30f3\u306f\u3001**\u30cb\u30bb\u30cf\u30e0\u30b7\u30c0\u30de\u30b7**\u3067\u3057\u3087\u3046\u306d\u3002\n**\u30cf\u30e0\u30b7**\u3082\u3001\u305d\u308c\u306b\u4f3c\u305f**\u30cf\u30e0\u30b7\u30c0\u30de\u30b7**\u3082\u3061\u3083\u3093\u3068\u3044\u307e\u3059\u3002\n\u30cf\u30e0\u30b7\u30c0\u30de\u30b7\u306b\u4f3c\u3066\u975e\u306a\u308b\u30e0\u30b7\u3092\u898b\u3064\u3051\u3061\u3083\u3063\u305f\u304b\u3089\u3001**\u30cb\u30bb\u30cf\u30e0\u30b7\u30c0\u30de\u30b7**\u3002\n\u3061\u306a\u307f\u306b\u3001**\u30cf\u30e0\u30b7\u30e2\u30c9\u30ad**\u3068\u3044\u3046\u9023\u4e2d\u3082\u3044\u307e\u3059\u304c\u3001\n\u5be1\u805e\u306b\u3057\u3066\u3001**\u30cb\u30bb**\u30cf\u30e0\u30b7\u30e2\u30c9\u30ad\u306e\u5b58\u5728\u306f\u77e5\u308a\u307e\u305b\u3093\u3002\n\n\n\u3075\u3075\u3075\n\n# \u30aa\u30c8\u30ca\u30c0\u30de\u30b7\n\u3048\u30fc\u3068\u3001\u4f55\u3067\u3057\u305f\u3063\u3051\u3002\n\n\u305d\u3046\u3002\n\u4eba\u524d\u3067\u30d7\u30ec\u30bc\u30f3\u30c6\u30fc\u30b7\u30e7\u30f3\u3092\u3059\u308b\u6a5f\u4f1a\u3001\u7d50\u69cb\u3042\u308a\u307e\u3059\u3088\u306d\u3002\uff08\u306d\uff01\uff01\uff09\n\n\u305d\u3093\u306a\u6642\u306b\u3001\u3050\u308b\u3050\u308b\u56de\u3063\u305f\u308a\u3001\u3050\u308a\u3050\u308a\u52d5\u3044\u305f\u308a\u3001\u30e2\u30ce\u30b9\u30b4\u30af\u30ab\u30e9\u30d5\u30eb\u3060\u3063\u305f\u308a\u3001\u305d\u3093\u306aFigure\u3092\u7686\u3055\u3093\u51fa\u3055\u308c\u307e\u3059\u3088\u306d\u3002\u3067\u3082\u3001\u5b9f\u969b\u306e\u30c7\u30fc\u30bf\u5206\u6790\u306b\u304a\u3044\u3066\u30013D\u30d7\u30ed\u30c3\u30c8\u3092\u66f8\u3044\u3066\u51c4\u304f\u7814\u7a76\u304c\u9032\u3080\u306e\u304b\uff1f\u3001\u3050\u308a\u3050\u308a\u52d5\u304b\u305b\u308b\u3068\u8ad6\u6587\u304c\u66f8\u3051\u308b\u306e\u304b\uff1f\u3068\u8a00\u308f\u308c\u308b\u3068\u3001\u307e\u3041\u3001**\u7121\u3044**\u3068\u601d\u3044\u307e\u3059\u306d\u3002\n\n\u3053\u3046\u3057\u305fFigure\u304c\u5f79\u306b\u7acb\u3064\u306e\u306f\u3001\u7dfb\u5bc6\u306a\u8ad6\u7406\u3092\u7a4d\u307f\u91cd\u306d\u3066\u8aac\u660e\u3059\u308b\u5834\u9762\u3067\u306f\u306a\u304f\u3001\u77ed\u6642\u9593\u3067\u6982\u8981\u3092\u76f4\u611f\u7684\u306b\u7406\u89e3\u3057\u3066\u3082\u3089\u3046(\u7406\u89e3\u3057\u305f**\u6c17\u306b**\u306a\u3063\u3066\u3082\u3089\u3046)\u5834\u9762\u306a\u306e\u3067\u3001\u901a\u79f0\u3001**\u30aa\u30c8\u30ca\u30c0\u30de\u30b7**\u3001\u3067\u3059\u3002\n\n\u4eca\u56de\u306f\u3001\u5fae\u5206\u65b9\u7a0b\u5f0f\u3092\u5206\u304b\u3063\u305f\u3075\u308a\u3092\u3059\u308b\u3001\u3068\u3044\u3046\u30aa\u30c8\u30ca\u30c0\u30de\u30b7\u3067\u3059\u3002\n\n\u305d\u3046\u8a00\u3048\u3070\u53bb\u5e74\u306e[R\u30a2\u30c9\u30ab\u30ec\u306b\u66f8\u3044\u305f\u8a18\u4e8b](http://qiita.com/kilometer/items/c1469970adf0b54e98ee)\u3082\u52d5\u753b\u3067\u30d4\u30ab\u30d4\u30ab\u7cfb\u3067\u3057\u305f\u3002\n\n# \u529b\u5b66\u7cfb dynamical system\n\u4eca\u56de\u306e\u6559\u79d1\u66f8\u306f\u3001[\u300e\u751f\u7269\u30ea\u30ba\u30e0\u3068\u529b\u5b66\u7cfb\u300f](https://www.amazon.co.jp/dp/4320110005)\u3067\u3059\u3002(\u4e3b\u306b2\u7ae0)\n\n**\u529b\u5b66\u7cfb**\u3068\u3044\u3046\u7528\u8a9e\u304c\u30ad\u30fc\u30ef\u30fc\u30c9\u3067\u3059\u304c\u3001\u5b9a\u7fa9\u3092\u5f15\u7528(p.14)\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n\n> \u6642\u9593\u767a\u5c55\u3059\u308b\u3042\u308a\u3068\u3042\u3089\u3086\u308b\u5bfe\u8c61\u306f**\u529b\u5b66\u7cfb**(dynamical systems)\u3068\u547c\u3070\u308c\u308b. \u529b\u5b66\u7cfb\u3068\u3044\u3046\u65e5\u672c\u8a9e\u3092\u805e\u304f\u3068\u529b\u5b66\u306e\u4e00\u7a2e\u306b\u611f\u3058\u308b\u304b\u3082\u3057\u308c\u306a\u3044\u304c\u3001\u82f1\u8a9e\u304b\u3089\u308f\u304b\u308b\u901a\u308a\u6642\u9593\u767a\u5c55\u3059\u308b\u3082\u306e\u4e00\u822c\u3092\u53d6\u308a\u6271\u3046\u5e83\u3044\u67a0\u7d44\u307f\u3067\u3042\u308b.\n\n**\u6642\u9593\u767a\u5c55**\u3059\u308b\u73fe\u8c61\u3092\u6570\u7406\u7684\u306b\u8a18\u8ff0\u3059\u308b\u3002\n\u3053\u308c\u306f$T_n$\u304b\u3089$T_{n+1}$\u306e\u5909\u5316\u306e\u6cd5\u5247\u3092\u66f8\u304d\u4e0b\u3059\u4e8b\u306b\u306a\u308a\u307e\u3059\u3002\n\n\u30aa\u30c8\u30ca**\u30c0\u30de\u30b7**\u306e\u8a18\u4e8b\u306a\u306e\u3067\u3001\u53b3\u5bc6\u306a\u5b9a\u7fa9\u306f\u4ed6\u306b\u8b72\u308b\u3068\u3057\u307e\u3059\u304c\u3001\n$f(x)$\u3092\u9023\u7d9a\u306a\u95a2\u6570\u3068\u3057\u3066\u3001\u672a\u77e5\u95a2\u6570$x=x(t)$\u306b\u3064\u3044\u3066\u3001\n\n```math\n\\frac{dx}{dt}=f(x)\\tag{1}\n```\n\n\u3068\u3044\u3046\u3088\u3046\u306a\u3001\u6642\u9593\u5fae\u5206\u95a2\u6570\u3067\u73fe\u8c61\u3092\u8a18\u8ff0\u3059\u308b\u6570\u7406\u30e2\u30c7\u30eb\u4e00\u822c\u3068\u3044\u3046\u30a4\u30e1\u30fc\u30b8\u3067\u3059\u3002\n\u53f3\u8fba\u304c\u5f93\u5c5e\u5909\u6570$x$\u306e\u307f\u3067\u8868\u3055\u308c\u308b\u65b9\u7a0b\u5f0f\u3092**\u81ea\u5f8b\u7cfb**\u3068\u547c\u3073\u307e\u3059\u3002\n\n\u4eca\u56de\u306f\u3001\u3044\u304f\u3064\u304b\u306e**\u81ea\u5f8b\u7cfb**\u306e\u6642\u9593\u767a\u5c55\u3092**\u30f4\u30a3\u30b8\u30e5\u30a2\u30e9\u30a4\u30ba(\u7b11)**\u3059\u308b\u4e8b\u3067\u3001\u5206\u304b\u3063\u305f\u3075\u308a\u3092\u3057\u307e\u3057\u3087\u3046\u3002\n\n# packages\n\u4eca\u56de\u306f\u3001\u3053\u306e3\u3064\u3092\u4f7f\u3044\u307e\u3057\u305f\u3002\n\u5168\u3066`install.packages(\"hoge\")`\u3067\u843d\u3068\u305b\u307e\u3059\u3002\n\u30b3\u30fc\u30c9\u3092\u306a\u305e\u308b\u969b\u306f\u3001\u4e8b\u524d\u306b`library(\"hoge\")`\u3067\u30a2\u30af\u30c6\u30a3\u30d9\u30fc\u30c8\u3057\u3066\u304a\u304d\u307e\u3057\u3087\u3046\u3002\n\u3000 **{deSolve}**: \u4eca\u56de\u306e\u30e1\u30a4\u30f3\u3002\n\u3000 **{rgl}**: \u304a\u7d75\u304b\u304d\u7528\u3067\u3059\u3002\n\u3000 **{animation}**: ImageMagic\u304c\u5fc5\u8981\u306b\u306a\u308a\u307e\u3059\u3002\n\n\u30d0\u30fc\u30b8\u30e7\u30f3\u60c5\u5831\u7b49\u8a73\u7d30\u306f\u3001Appendix\u306b\u3066\u3002\n\n\n\n# \u5358\u7d14\u306a\u4f8b\u304b\u3089\n\n\u5f0f(1)\u306e\u6700\u9ad8\u306b\u30b7\u30f3\u30d7\u30eb\u306a\u4f8b\u306f\u3001\n\n```math\n\\frac{dx}{dt}=kx\n```\n\n\u3067\u3059\u304c\u3001**\u30f4\u30a3\u30b8\u30e5\u30a2\u30e9\u30a4\u30ba(\u7b11)**\u7684\u306b\u306f\u3082\u3046\u5c11\u3057\u8907\u96d1\u306b\u3057\u3066\u3001\n\n```math\n\\frac{dx}{dt}=kx(1-x)\\tag{2}\n```\n\n\u3092\u8003\u3048\u307e\u3059\u3002\n\n**R**\u3067\u5fae\u5206\u65b9\u7a0b\u5f0f\u3092\u89e3\u304f\u305f\u3081\u306e\u30d1\u30c3\u30b1\u30fc\u30b8\u304c**{deSolve}**\u3067\u3059\u3002\n\u307e\u305a\u306f\u5f0f(2)\u3092\u6c7a\u307e\u3063\u305f\u69d8\u5f0f\u3067\u66f8\u304d\u4e0b\u3057\u305f\u95a2\u6570\u3092\u5b9a\u7fa9\u3057\u307e\u3059\u3002\n\n```R\nX <- function(t, state, parameters){\n  with(as.list(c(state, parameters)),{\n    dx <- k*x*(1-x)\n    list(c(dx))\n  })\n}\n```\n\n\u3067\u3001\u30d1\u30e9\u30e1\u30fc\u30bf\u306e\u5024\u3068\u6642\u9593\u8ef8\u3068\u521d\u671f\u5024\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n\n```R\nparameters <- c(k=1)\ntimes <- seq(0, 10, by=0.2)\ninitial <- c(x=0.5)\n```\n\n\u3067\u3001\u30c9\u30c9\u30f3\u3063\u3068\u89e3\u3044\u3066\u3057\u307e\u3044\u307e\u3059\u3002\n\n```R\nout <- ode(y = initial, times = times, func = X, params = parameters)\n```\n\n\u3082\u3046\u3001\u305d\u306e\u307e\u307eplot\u3067\u3044\u3051\u307e\u3059\u3002\n\n> plot(out)\n<img width=350, src=https://qiita-image-store.s3.amazonaws.com/0/92401/b8ef1a5c-ab84-e29a-024d-80717364e35c.png>\n\n\u8a08\u7b97\u3067\u304d\u3066\u305d\u3046\u3067\u3059\u306d\u3002\u3067\u3082\u3001\u3053\u308c\u3067\u306f**\u30c0\u30de**\u305b\u306a\u3044\u3002\n\n\u305d\u3053\u3067\u3001\u30aa\u30c8\u30ca\u30c0\u30de\u30b7\u7684\u306b\u306f\u3067\u3059\u306d\u3001\u30b4\u30b8\u30e7\u30b4\u30b8\u30e7\u3084\u3063\u3066\u2026\n\n<img width=600, src=https://qiita-image-store.s3.amazonaws.com/0/92401/9c471003-a9af-3b3d-234b-2541c3beea89.png>\n\n\u3053\u3093\u306a\u611f\u3058\u3067\u3057\u3087\u3046\u304b\u3002\n\n\u51fa\u767a\u5730\u70b9(\u521d\u671f\u5024)\u304c$x_0<0$\u306e\u6642\u306f\u3001\u660e\u3089\u304b\u306b$\u207b\u221e$\u306b\u767a\u6563\u3067\u3059\u306d\u3002\n$x_0=0$\u306a\u3089\u3070\u3001\u5e38\u306b$x=0$\n$x_0>0$\u306a\u3089\u3070\u3001$t\u2192\u221e$\u306e\u6642\u3001$x_\u221e\u21921$\u3067\u3059\u306d\u3002\n\u3048\uff1f\u5f0f(2)\u304b\u3089\u660e\u3089\u304b\uff1f\u3048\u3048\u3002**\u30f4\u30a3\u30b8\u30e5\u30a2\u30e9\u30a4\u30ba(\u7b11)**\u3057\u3066\u307f\u307e\u3057\u305f\u3002\n\n\u3053\u306e**\u30c0\u30de\u30b7\u7d75**\u306e\u66f8\u304d\u65b9\u306f\u3001Appendix\u306b\u3066\u3002\n\n# 2\u5909\u6570\u306e\u5834\u5408\n## \u30ed\u30c8\u30ab\u30fb\u30f4\u30a9\u30eb\u30c6\u30e9\u65b9\u7a0b\u5f0f Lotoka-Volterra equations\n\u901a\u79f0\u3001**\u55b0\u3046\u304b\u55b0\u308f\u308c\u308b\u304b\u65b9\u7a0b\u5f0f**\u3067\u3059\u3002\n\n\u55b0\u3046\u30c1\u30fc\u30e0X\u3068\u3001\u55b0\u308f\u308c\u308b\u30c1\u30fc\u30e0Y (\u3069\u3063\u3061\u3067\u3082\u3044\u3044\u3067\u3059\u304c)\u3092\u8003\u3048\u3066\u3001\u305d\u306e\u500b\u4f53\u6570\u5909\u52d5\u3092\u8868\u73fe\u3059\u308b\u6570\u7406\u30e2\u30c7\u30eb\u3067\u3059\u3002\u96e3\u3057\u3044\u8a71\u306f\u6559\u79d1\u66f8\u306b\u8b72\u308a\u307e\u3059\u3002\n\u6559\u79d1\u66f8\u306b\u7fd2\u3044\u30015\u3064\u306e\u6b63\u306e\u5b9f\u6570$a, K, b, c, r$\u3092\u7528\u3044\u3066\u3001\u66f8\u304d\u4e0b\u3059\u3068\u3001\n\n```math\n\\begin{eqnarray}\n\\frac{dx}{dt}&=&a(1-x/K-by)x \\\\\n\\frac{dy}{dt}&=&(-r+cx)y \\tag{3}\n\\end{eqnarray}\n```\n\n\u3082\u3046\u8aac\u660e\u3092\u3059\u3063\u98db\u3070\u3057\u3066\u3001\n\n```R\nX <- function(t, state, parameters){\n  with(as.list(c(state, parameters)),{\n    dx <- a * (1 - x/K - b*y)\n    dy <- (-r + c* x)*y\n    list(c(dx, dy))\n  })\n}\nparameters <- c(a = 1, K = 3, b = 0.2, r = 0.1, c = 0.05)\ntimes <- seq(0, 100, 0.5)\ninitial <- c(x=3, y=1)\nout <- ode(y = initial, times = times, func = X, parms = parameters)\n```\n\n>plot(out)\n<img width=\"400\" alt=\"\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2016-12-08 18.27.39.png\" src=\"https://qiita-image-store.s3.amazonaws.com/0/92401/0e21f195-0d9d-a316-7231-d8a5f33c2199.png\">\n\n\u304a\u3001\u5e73\u8861\u306b\u843d\u3061\u3066\u305d\u3046\u3067\u3059\u306d\u3002\n\n\u3067\u3001\u30a8\u30a4\u3084\uff01\uff01\n\n<img width=600, src=https://qiita-image-store.s3.amazonaws.com/0/92401/8ebab55b-1dc0-2867-6e8e-dbce4f032d9a.png>\n\n\u3069\u3053\u3092\u521d\u671f\u5024\u306b\u53d6\u3063\u3066\u3082\u3001\u25cf\u306e\u70b9\u306b\u53ce\u675f\u3057\u3066\u3044\u308b\u69d8\u5b50\u304c**\u30f4\u30a3\u30b8\u30e5\u30a2\u30e9\u30a4\u30ba**\u3055\u308c\u307e\u3057\u305f\u306d\uff01\n\n\n\u304b\u3089\u306e\u3001\u30c9\u30a9\u30fc\u30f3\uff01\uff01\n\n<img width=500 src=https://qiita-image-store.s3.amazonaws.com/0/92401/c74625e6-02d6-495d-382c-4ed9954314d1.png>\n\n\u55b0\u3046\u5074\u3082\u55b0\u308f\u308c\u308b\u5074\u3082\u3001\u305d\u308a\u3083\u3041**\u8272\u3005**\u3042\u308a\u307e\u3059\u308f\u306a\u3002\n\n\u9152\u306f**\u5451\u3093\u3067\u3082\u5451\u307e\u308c\u308b\u306a**(\u81ea\u6212)\u3002\n\n\n## \u30d5\u30a1\u30f3\u30fb\u30c7\u30a2\u30fb\u30dd\u30eb\u65b9\u7a0b\u5f0f Van der Pol equations\n\n\u96fb\u6c17\u56de\u8def\u306e\u81ea\u52b1\u767a\u632f\u306e\u30e2\u30c7\u30eb\u65b9\u7a0b\u5f0f\u3001\u3068\u304b\u3001\u305d\u3046\u3044\u3046\u4e8b\u306f\u4e00\u5207\u304b\u307e\u308f\u305a\u3001\n\n```math\n\\begin{eqnarray}\n\\frac{dx}{dt}&=&ax+y-x^3/3\\\\\n\\frac{dy}{dt}&=&-x\\tag{4}\n\\end{eqnarray}\n```\n\n\u3088\u3044\u3057\u3087\u3001\n\n```R\nX <- function(t, state, parameters){\n  with(as.list(c(state, parameters)),{\n    dx <- a * x + y - x^3/3\n    dy <- -x\n    list(c(dx, dy))\n  })\n}\ntimes <- seq(0, 100, 0.1)\nparameters <- c(a = 0.5)\ninitial <- c(x=3, y=1)\nout <- ode(y = initial, times = times, func = X, parms = parameters)\n```\n\n\u304b\u3089\u306e\u3001\n\n>plot(out)\n<img height=150, src=https://qiita-image-store.s3.amazonaws.com/0/92401/1ad894c5-a50f-d665-680d-420d491b23b3.png>\n\n\u304a\u304a\u3002\u602a\u3057\u3044\u3002\n\n\u304b\u3089\u306e\u3001\n<img width=600, src=https://qiita-image-store.s3.amazonaws.com/0/92401/dccdda90-d32a-ed02-d7e7-ef943cfb4fa8.png>\n\n\u3082\u3046\u4e00\u58f0\u3001\n\n![VP1.gif](https://qiita-image-store.s3.amazonaws.com/0/92401/425846db-0283-013b-cd5f-2f1b521db794.gif)\n\n\u5b9f\u306b\u30aa\u30c8\u30ca\u30c0\u30de\u30b7\u611f\u6e80\u8f09\u3067\u3059\u306d\u3002\n\n\u3053\u30fc\u3086\u30fc\u53ce\u675f\u306e\u4ed5\u65b9\u3092**\u30ea\u30df\u30c3\u30c8\u30b5\u30a4\u30af\u30eb**\u3068\u547c\u3073\u307e\u3059\u3002\n\u9154\u3063\u6255\u3044\u30c8\u30fc\u30af\u306f\u3001\u30ea\u30df\u30c3\u30c8\u30b5\u30a4\u30af\u30eb\u3057\u306a\u3044\u3088\u3046\u306b\u6c17\u3092\u3064\u3051\u307e\u3057\u3087\u3046\uff08**\u81ea\u6212**\uff09\u3002\n\n# \u6700\u5f8c\u306f\u3053\u308c\u3067\u3057\u3087\u3046\u3002\n\n**\u4f55\u3082**\u8aac\u660e\u3057\u306a\u3044\u3068\u3044\u3046\u66b4\u6319\u3002\n\u3044\u3084\u3001\u6709\u540d\u3059\u304e\u3066\u2026\u3002\n\n\u305d\u308c\u306b\u3057\u3066\u3082\u7f8e\u3057\u3044\u56f3\u5f62\u3067\u3059(\u6e9c\u3081\u606f)\u3002\n\n```R\nX <- function(t, state, parameters){\n  with(as.list(c(state, parameters)),{\n    dx <- a*(y-x)\n    dy <- r*x-y-x*z\n    dz <- -b*z + x*y\n    list(c(dx, dy, dz))\n  })\n}\n\nparameters <- c(a = 10, b=8/3, r=40)\ntimes <- seq(0, 200, 0.01)\ninitial <- c(x=0, y=0.1, z=0)\nout <- ode(y = initial, times = times, func = X, parms = parameters)\nCol <- colorRampPalette(c(\"#ff2800\",\"#ff9900\",\"#35a16b\", \"green\"))\n\nplot3d(out[,c(\"x\", \"y\", \"z\")], type=\"n\", box=F)\npoints3d(out[,c(\"x\", \"y\", \"z\")], col=Col(length(times)))\n```\n\n\u3053\u306e\u30d7\u30ed\u30c3\u30c8\u3092\u5165\u308c\u305f.Rmd\u3092`{rmarkdown}`\u3067\u66f8\u304d\u3043\u306e\u3001`{knitr}`\u3067.html\u4f5c\u308a\u3043\u306e\u3001[Github](https://github.com/)\u306b\u4e0a\u3052\u3047\u306e\u3001[htmlPreview](https://htmlpreview.github.io/)\u3067\u30d7\u30ec\u30d3\u30e5\u30fc\u3092\u51fa\u3057\u3043\u306e\u3001\u3055\u3066\u3001\u4e0a\u624b\u304f\u30ea\u30f3\u30af\u8cbc\u308c\u305f\u304b\u3069\u3046\u304b\u30fb\u30fb[\u3053\u3053\u304b\u3089\u3069\u3046\u305e](https://htmlpreview.github.io/?https://github.com/Kilometer0101/qiitaAdC/blob/master/LorenzAttractor2.html)\n\n\n\u30b0\u30ea\u30b0\u30ea\u3057\u3066\u697d\u3057\u3093\u3067\u304f\u3060\u3055\u3044\u3002\n\u62e1\u5927\u7e2e\u5c0f\u3082\u3067\u304d\u307e\u3059\u3088\u3002\n\n# \u3042\u3068\u304c\u304d\n\n\u305d\u3046\u3044\u3048\u3070\u4eca\u56de\u306f\u3001{ggplot2}\u3092\u4f7f\u308f\u306a\u304b\u3063\u305f\u3067\u3059\u3002\n`deSolve::ode`\u306e\u51fa\u529b\u304c`dataframe`\u3067\u306f\u306a\u304f`matrix`\u3067\u51fa\u529b\u3055\u308c\u308b\u305f\u3081\u304b\u3001\u7279\u306b\u610f\u8b58\u305b\u305a`plot`\u3067\u66f8\u3044\u3061\u3083\u3044\u307e\u3057\u305f\u3002\n\n\u3042\u3001\u305d\u3046\u3044\u3048\u3070{dplyr}\u3082{tidyr}\u3082\u51fa\u756a\u304c\u3042\u308a\u307e\u305b\u3093\u3067\u3057\u305f\u306d\u3002\nR\u30a2\u30c9\u30ab\u30ec\u306e\u304f\u305b\u306b...\n\n**\u30cf\u30c9\u30ea\u30f4\u30a1\u30fc\u30b9**\u306e\u65b9\u89d2\u306b43\u793c24\u62cd37\u793c\u3057\u3066\u3001\u5fa1\u795e\u9152\u3092\u5099\u3048\u3066\u304a\u304d\u307e\u3059\u306e\u3067\u8a31\u3057\u3066\u4e0b\u3055\u3044\u3002\n\n\n**Enjoy!!**\n\n\n# Appendix\n## \u74b0\u5883\n\n```R\n> sessionInfo()\nR version 3.3.1 (2016-06-21)\nPlatform: x86_64-apple-darwin13.4.0 (64-bit)\nRunning under: OS X 10.10.5 (Yosemite)\n\nattached base packages:\n[1] stats     graphics  grDevices utils     datasets  methods   base     \n\nother attached packages:\n[1] animation_2.4      rgl_0.96.0        deSolve_1.14 \n```\n\n## \u30aa\u30c8\u30ca\u30c0\u30de\u30b7\u305d\u306e1\n\n```R\n# \u30d1\u30c3\u30b1\u30fc\u30b8\u3092\u30a2\u30af\u30c6\u30a3\u30d9\u30fc\u30c8\nlibrary(\"deSolve\")\n# \u5fae\u5206\u65b9\u7a0b\u5f0f\u30fb\u521d\u671f\u5024\u306e\u8a2d\u5b9a\nX <- function(t, state, parameters){\n  with(as.list(c(state, parameters)),{\n    dx <- k*x*(1-x)\n    list(c(dx))\n  })\n}\nparameters <- c(k = 1)\ntimes <- seq(0, 10, 0.2)\n\n# \u521d\u671f\u5024\nN <- 100\nx <- seq(0, 2, length=N)\n\n# \u5fae\u5206\u65b9\u7a0b\u5f0f\u3092\u89e3\u304f\nout <- NULL\nfor(i in 1:N){\n  initial <- c(x=x[i])\n  out[[i]] <- ode(y = initial, times = times, func = X, parms = parameters)\n}\n\n# \u30d9\u30af\u30c8\u30eb\u59cb\u70b9\u306eY\u5ea7\u6a19\u3068\u89d2\u5ea6\nA <- seq(0, 2, by=0.1)\nsita <- atan(A*(1-A))\n\n# \u30b0\u30e9\u30d5\u30a3\u30c3\u30af\u30b9\u30d1\u30e9\u30e1\u30fc\u30bf\u306e\u6e96\u5099\npar(mgp=c(1.5, 0.3, 0), tcl=-0.2, mar=c(3,3,1,1))\n# \u753b\u9762\u306e\u7528\u610f\nplot(0,0, type=\"n\", xlim=c(0, 10), ylim=c(0, 2), xlab=\"time\", ylab=\"x\")\n\n# \u77e2\u5370\u3092\u66f8\u304f\u3002\u30b4\u30ea\u62bc\u3057\u3067\u3059\u3002\u3082\u3063\u3068\u7c21\u5358\u306b\u304b\u3051\u308b\u3068\u601d\u3046\u3051\u3069\u2026\nfor(i in 0:20){\n  for(j in 1:length(sita)){\n    if(0.4*abs(sin(sita[j])) < 0.1){\n      arrows(i/2, j*0.1-0.1, i/2 + 0.4*cos(sita[j]),\n           j*0.1 + 0.4*sin(sita[j])-0.1, length=0.15, col=\"darkgrey\")\n    }else{\n      arrows(i/2, j*0.1-0.1, i/2 - 0.1*cos(sita[j])/sin(sita[j]),\n             j*0.1-0.2, length=0.15, col=\"darkgrey\")\n    }\n}}\n# \u7dda\u306f\u30ab\u30e9\u30d5\u30eb\u306b\u30ad\u3081\u307e\u3057\u3087\u3046\u3002\nfor(i in 1:N){\n  lines(out[[i]], col=rainbow(N)[i])\n}\n```\n\n\n## \u30aa\u30c8\u30ca\u30c0\u30de\u30b7\u305d\u306e2\n\n```R\nset.seed(1)\n\nparameters <- c(a = 1, K = 3, b = 0.2, r = 0.1, c = 0.05)\n\nX <- function(t, state, parameters){\n  with(as.list(c(state, parameters)),{\n    dx <- a * (1 - x/K - b*y)\n    dy <- (-r + c* x)*y\n    list(c(dx, dy))\n  })\n}\n\n\n# \u59cb\u70b9\u306e\u521d\u671f\u5024\u3002\u3053\u3053\u3067\u3061\u3087\u3063\u3068\u30d0\u30e9\u3064\u304b\u305b\u308b\u306e\u304c\u30aa\u30c8\u30ca\u30c0\u30de\u30b7\u7684\u30c6\u30af\u30cb\u30c3\u30af\nN <- 360\nsita <- seq(0, 2*pi, length=N)\nx <- 2 * cos(sita) + 2.1 +runif(N, 0, 0.5)\ny <- 2 * sin(sita) + 2.1+runif(N, 0, 0.5)\n\n\ntimes <- seq(0, 100, 0.5)\nout <- NULL\nfor(i in 1:N){\n  initial <- c(x=x[i], y=y[i])\n  out[[i]] <- ode(y = initial, times = times, func = X, parms = parameters)\n}\n# \u8272\u306f\u30d3\u30ab\u30d3\u30ab\u306b\u30ad\u3081\u3088\u3046\u3002\nplot(0, 0, xlim=c(0,4.5), ylim=c(0, 4.5), type=\"n\", xlab=\"x\", ylab=\"y\")\nfor(i in 1:N)\n  lines(out[[i]][,2:3], col=rainbow(N)[i], lwd=1)\npoints(x,y, col=rainbow(N), pch=20, cex=1)\npoints(2, 5/3, pch=16, cex=1.5)\n\n# 3d\u30d7\u30ed\u30c3\u30c8\u306f\u3053\u3093\u306a\u611f\u3058\u3002\ndat_x <- NULL\ndat_y <- NULL\nfor(i in 1:N){\n\tdat_x <- cbind(dat_x, out[[i]][,2])\n\tdat_y <- cbind(dat_y, out[[i]][,3])\n}\nplot3d(0, 0, 0, xlim=c(0, 5), ylim=c(0,5), zlim=c(0,100), type=\"n\", box=F,\n       xlab=\"x\", ylab=\"y\", zlab=\"\")\n  points3d(dat_x[1,], dat_y[1,], rep(0, N), col=rainbow(N))\n  for(i in 1:N){\n    lines3d(dat_x[,i], dat_y[,i], times, col=rainbow(N)[i])\n  }\n```\n\n## \u30aa\u30c8\u30ca\u30c0\u30de\u30b7\u305d\u306e3\n\n```R\nset.seed(1)\n# \u3053\u3053\u5927\u4e8b\nX <- function(t, state, parameters){\n  with(as.list(c(state, parameters)),{\n    dx <- a * x + y - x^3/3\n    dy <- -x\n    list(c(dx, dy))\n  })\n}\n# \u6e96\u5099\nparameters <- c(a = 0.5)\nN <- 200\ntimes <- seq(0, 100, 0.1)\nr <- seq(0, 3.5, length=N) + runif(N, 0, 0.1)\nsita <- runif(N, 0, 2*pi)\nx <- r * cos(sita)\ny <- r * sin(sita)\nCol <- rainbow(N)\n# \u304c\u3093\u3070\u308b\nout <- NULL\nfor(i in 1:N){\n  initial <- c(x=x[i], y=y[i])\n  out[[i]] <- ode(y = initial, times = times, func = X, parms = parameters)\n}\n# \u304a\u7d75\u304b\u304d\npar(mgp=c(1.5, 0.3, 0), tcl=-0.2, mar=c(3,3,1,1))\nplot(0, 0, xlim=c(-3.5, 3.5), ylim=c(-3.5, 3.5), type=\"n\", xlab=\"x\", ylab=\"y\")\nfor(i in 1:N)\n  lines(out[[i]][,2:3], col=Col[i], lwd=1)\npoints(x,y, col=Col, pch=20, cex=1.5)\na <- sample(1:N,1)\nlines(out[[a]][,2:3], lwd=3)\npoints(x[a], y[a], pch=17, cex=3)\n\ndat_x <- NULL\ndat_y <- NULL\nfor(i in 1:N){\n  dat_x <- cbind(dat_x, out[[i]][,2])\n  dat_y <- cbind(dat_y, out[[i]][,3])\n} \n\n# {animation}\u3067\u3059\u3002\nsaveGIF({\n  ani.options(interval = 0.02,\n              convert = \"/opt/ImageMagic/bin/convert\")\n#  for(k in 1:length(times)){\n  for(k in 1:150){\n      par(mgp=c(1.5, 0.3, 0), tcl=-0.2, mar=c(3,3,1,1))\n    plot(0, 0, xlim=c(-3.5, 3.5), ylim=c(-3.5, 3.5), type=\"n\", xlab=\"x\", ylab=\"y\")\n    for(i in 1:N){\n      lines(out[[i]][,2:3], col=\"lightgrey\", lwd=1)\n    }\n    points(dat_x[k,], dat_y[k,], col=Col, pch=16, cex=1.2)\n  }},\n  movie.name = \"VP1.gif\",\n  ani.width=400, ani.height=400, clean=T\n)\n```\n\n", "tags": ["R", "deSolve", "rgl", "animation"]}