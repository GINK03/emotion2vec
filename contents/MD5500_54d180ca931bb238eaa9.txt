{"tags": ["AppleScript", "Excel"], "context": "FileMaker\u3082\u304f\u3082\u304f\u4f1a#14\u306e\u6210\u679c\u306eAppleScript\n\uff08FileMaker\uff1f\uff09\n\u6a19\u6e96\u306e\u4fdd\u5b58\u3067\u306fUTF-16\u3067\u4fdd\u5b58\u306f\u3067\u304d\u308b\u3082\u306e\u306e\u3001Script\u306b\u306f\u5bfe\u5fdc\u3057\u3066\u306a\u304b\u3063\u305f\u306e\u3067\u3061\u3087\u3063\u3068\u8003\u3048\u3066\u307f\u307e\u3057\u305f\u3002\n\u30c7\u30fc\u30bf\u306e\u7bc4\u56f2\u9078\u629e\u7b49\u8272\u3005\u8003\u3048\u305f\u306e\u3067\u3059\u304c\u3001\u95c7\u304c\u5e83\u304c\u3063\u3066\u304d\u305f\u306e\u3067\u66f8\u51fa\u3059\u7bc4\u56f2\u3092\u3042\u3089\u304b\u3058\u3081\u9078\u629e\u3057\u3066\u304a\u3044\u3066\u3082\u3089\u3046\u65b9\u6cd5\u306b\u3057\u307e\u3057\u305f\u3002\n\u30af\u30ea\u30c3\u30d7\u30dc\u30fc\u30c9\u6c5a\u67d3\u3057\u307e\u3059\uff08\u82e6\u7b11\n\u305d\u308c\u3068\u3001\u306a\u305c\u304b\u9023\u7d9a\u3067\u5b9f\u884c\u3059\u308b\u3068\u30a8\u30e9\u30fc\u306b\u306a\u308a\u307e\u3059\u3002\uff08\u306a\u3093\u3067\uff1f\uff1f\uff09\nExcel\u3068\u540c\u968e\u5c64\u306b\u30bf\u30d6\u533a\u5207\u308a\u30c6\u30ad\u30b9\u30c8\u3092\u66f8\u304d\u51fa\u3057\u307e\u3059\u3002\n\ntell application \"Microsoft Excel\"\n    activate\n    copy range of selection\n    set TabText to get the clipboard\n\n    set DocPath to full name of active workbook\n\n    my SaveTabText(DocPath, TabText)\n\nend tell\n\n\non SaveTabText(DocPath, TabText)\n\n    tell application \"Finder\" to set aExt to name extension of (info for (DocPath as alias))\n\n    set SaveTabText to my Delimiters(DocPath as Unicode text, aExt, \"txt\")\n    set SaveTabText to quoted form of POSIX path of SaveTabText\n\n    set shcmd to \"echo \" & TabText & \" > \" & SaveTabText\n    do shell script shcmd\nend SaveTabText\n\non Delimiters(theText, serchStr, replaceStr)\n    set OriginalDelimiters to AppleScript's text item delimiters\n    set AppleScript's text item delimiters to serchStr\n    set theText to text items of theText\n    set AppleScript's text item delimiters to replaceStr\n    set theText to theText as string\n    set AppleScript's text item delimiters to OriginalDelimiters\n    return theText\nend Delimiters\n\n\n[FileMaker\u3082\u304f\u3082\u304f\u4f1a#14](https://atnd.org/events/75502)\u306e\u6210\u679c\u306eAppleScript\n\uff08FileMaker\uff1f\uff09\n\n\u6a19\u6e96\u306e\u4fdd\u5b58\u3067\u306fUTF-16\u3067\u4fdd\u5b58\u306f\u3067\u304d\u308b\u3082\u306e\u306e\u3001Script\u306b\u306f\u5bfe\u5fdc\u3057\u3066\u306a\u304b\u3063\u305f\u306e\u3067\u3061\u3087\u3063\u3068\u8003\u3048\u3066\u307f\u307e\u3057\u305f\u3002\n\u30c7\u30fc\u30bf\u306e\u7bc4\u56f2\u9078\u629e\u7b49\u8272\u3005\u8003\u3048\u305f\u306e\u3067\u3059\u304c\u3001\u95c7\u304c\u5e83\u304c\u3063\u3066\u304d\u305f\u306e\u3067\u66f8\u51fa\u3059\u7bc4\u56f2\u3092\u3042\u3089\u304b\u3058\u3081\u9078\u629e\u3057\u3066\u304a\u3044\u3066\u3082\u3089\u3046\u65b9\u6cd5\u306b\u3057\u307e\u3057\u305f\u3002\n\n\u30af\u30ea\u30c3\u30d7\u30dc\u30fc\u30c9\u6c5a\u67d3\u3057\u307e\u3059\uff08\u82e6\u7b11\n\n\u305d\u308c\u3068\u3001\u306a\u305c\u304b\u9023\u7d9a\u3067\u5b9f\u884c\u3059\u308b\u3068\u30a8\u30e9\u30fc\u306b\u306a\u308a\u307e\u3059\u3002\uff08\u306a\u3093\u3067\uff1f\uff1f\uff09\n\nExcel\u3068\u540c\u968e\u5c64\u306b\u30bf\u30d6\u533a\u5207\u308a\u30c6\u30ad\u30b9\u30c8\u3092\u66f8\u304d\u51fa\u3057\u307e\u3059\u3002\n\n```applescript\n\ntell application \"Microsoft Excel\"\n\tactivate\n\tcopy range of selection\n\tset TabText to get the clipboard\n\t\n\tset DocPath to full name of active workbook\n\n\tmy SaveTabText(DocPath, TabText)\n\t\nend tell\n\n\non SaveTabText(DocPath, TabText)\n\t\n\ttell application \"Finder\" to set aExt to name extension of (info for (DocPath as alias))\n\t\n\tset SaveTabText to my Delimiters(DocPath as Unicode text, aExt, \"txt\")\n\tset SaveTabText to quoted form of POSIX path of SaveTabText\n\t\n\tset shcmd to \"echo \" & TabText & \" > \" & SaveTabText\n\tdo shell script shcmd\nend SaveTabText\n\non Delimiters(theText, serchStr, replaceStr)\n\tset OriginalDelimiters to AppleScript's text item delimiters\n\tset AppleScript's text item delimiters to serchStr\n\tset theText to text items of theText\n\tset AppleScript's text item delimiters to replaceStr\n\tset theText to theText as string\n\tset AppleScript's text item delimiters to OriginalDelimiters\n\treturn theText\nend Delimiters\n\n```\n"}