{"context": " More than 1 year has passed since last update.\n\u3000\u30b5\u30af\u30e9VPS CentOS release 6.5 2015/05/21\n\u3000\u53c2\u8003\n\u3000http://qiita.com/junki0605/items/6ce3df1933ef6d31ddfa\n\n\nroot\u3067\u30b5\u30fc\u30d0\u30fc\u306b\u63a5\u7d9a\n\n\u30b5\u30fc\u30d0\u30fc\u306b\u63a5\u7d9a\n$ ssh root@***.**.**.***\n\n\nroot\u30d1\u30b9\u30ef\u30fc\u30c9\u306e\u5909\u66f4\n$ passwd\n\n\nyum update\u3068\u65e5\u672c\u8a9e\u5316\n$ yum update\n\n$ vim /etc/sysconfig/i18n\n\n\u5909\u66f4\u524d\nLANG=\"C\"\n\n\u5909\u66f4\u5f8c\nLANG=\"ja_JP.UTF-8\"\n\n\n\u4f5c\u696d\u7528\u30e6\u30fc\u30b6\u30fc\u306e\u4f5c\u6210\u3068\u8a2d\u5b9a\n$ useradd chou\n$ passwd  chou\n\n\u65b0\u898f\u30e6\u30fc\u30b6\uff08chou\uff09\u3092\u30eb\u30fc\u30c8\u6a29\u9650\u3092\u5f97\u3089\u308c\u308b\u30b0\u30eb\u30fc\u30d7\u306b\u8ffd\u52a0\n$ usermod -G wheel chou\n\n$ visudo\n\n2\u884c\u76ee\u306e#\u3092\u5916\u3057\u3066\u4fdd\u5b58\u3002\u3053\u308c\u3067wheel\u30b0\u30eb\u30fc\u30d7\u306b\u5c5e\u3059\u308b\u30e6\u30fc\u30b6\u306bsudo\u30b3\u30de\u30f3\u30c9\u306e\u5b9f\u884c\u3092\u8a31\u53ef\u3059\u308b\u3002\n## Allows people in group wheel to run all commands\n# %wheel        ALL=(ALL)       ALL\n\n\n\u4f5c\u696d\u30e6\u30fc\u30b6\u30fc\u3067\u30b5\u30fc\u30d0\u30fc\u306b\u63a5\u7d9a\n\n$ ssh chou@xxx.xx.xx.xxx\n\n\n\n\u9375\u8a8d\u8a3c\u306e\u8a2d\u5b9a\n\u516c\u958b\u9375\u3092\u5165\u308c\u308b\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092\u30b5\u30fc\u30d0\u30fc\u306e\u30db\u30fc\u30e0\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u4f5c\u6210\u3057\u3066\u304a\u304f\u3002\n$ mkdir ~/.ssh\n$ chmod 700 ~/.ssh\n\n\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u5074\uff08mac\uff09\u3067ssh\u9375\u30da\u30a2\u3092\u4f5c\u6210\n$ ssh-keygen\n\n\u3059\u308b\u3068\u3001\u301c/.ssh\u3000\u30d5\u30a9\u30eb\u30c0\u306bid_rsa\uff08\u79d8\u5bc6\u9375\uff09\u3068id_rsa.pub\uff08\u516c\u958b\u9375\uff09\u304c\u4f5c\u6210\u3055\u308c\u308b\u3002\n$chmod 600 ~/.ssh/id_rsa.pub\n\n\u6b21\u306b\u516c\u958b\u9375\u3092\u30b5\u30fc\u30d0\u30fc\u306b\u8ee2\u9001\n$ scp ~/.ssh/id_rsa.pub chou@xxx.xx.xx.xxx:~/.ssh/authorized_keys\n\n\u3067\u516c\u958b\u9375\u3092\u30b5\u30fc\u30d0\u30fc\u306b\u8ee2\u9001\u3057\u3001authorized_keys\u3068\u3044\u3046\u540d\u524d\u3067\u4fdd\u5b58\u3059\u308b\u3002\n\u3053\u308c\u3067\u3001\u9375\u8a8d\u8a3c\u3067ssh\u63a5\u7d9a\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3057\u305f\u3002\n\nssh\u63a5\u7d9a\u306e\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u8a2d\u5b9a\n\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3092\u958b\u304d\u3001\u8a2d\u5b9a\u3092\u5909\u66f4\u3059\u308b\u3002\n$ sudo vim /etc/ssh/sshd_config\n\n\n\u30dd\u30fc\u30c8\u306e\u5909\u66f4\n\u30c7\u30d5\u30a9\u30eb\u30c8\u306e22\u3000\u3092\u300010022\u3000\u306b\u5909\u66f4\u3059\u308b\uff08\u8a2d\u5b9a\u53ef\u80fd\u7bc4\u56f2\uff1a1024\u301c65535\uff09\u3002\n\u5909\u66f4\u524d\n#Port 22\n\n\u5909\u66f4\u5f8c\nPort 10022\n\n\nroot\u306b\u3088\u308b\u30ed\u30b0\u30a4\u30f3\u306e\u7981\u6b62\n\u5909\u66f4\u524d\n#PermitRootLogin yes\n\n\u5909\u66f4\u5f8c\nPermitRootLogin no\n\n\npassword\u3067\u306e\u30ed\u30b0\u30a4\u30f3\u7981\u6b62\n\u5909\u66f4\u524d\n#PasswordAuthentication yes\n\n\u5909\u66f4\u5f8c\nPasswordAuthentication no\n\n\nssh\u3092\u518d\u8d77\u52d5\n$ sudo service sshd restart\n\n\nFireWall\u306e\u8a2d\u5b9a\n\niptables\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u6210\u3059\u308b\n$ sudo vim /etc/sysconfig/iptables\n\n\n\u30c7\u30d5\u30a9\u30eb\u30c8\u306710022\u756a\u3060\u3051\u306b\u30aa\u30fc\u30d7\u30f3\u3059\u308b\u3088\u3046\u306b\u5909\u66f4\u3059\u308b\u3002\n*filter\n:INPUT ACCEPT [0:0]\n:FORWARD ACCEPT [0:0]\n:OUTPUT ACCEPT [0:0]\n:RH-Firewall-1-INPUT - [0:0]\n-A INPUT -j RH-Firewall-1-INPUT\n-A FORWARD -j RH-Firewall-1-INPUT\n-A RH-Firewall-1-INPUT -i lo -j ACCEPT\n-A RH-Firewall-1-INPUT -p icmp --icmp-type any -j ACCEPT\n-A RH-Firewall-1-INPUT -p 50 -j ACCEPT\n-A RH-Firewall-1-INPUT -p 51 -j ACCEPT\n-A RH-Firewall-1-INPUT -p udp --dport 5353 -d 224.0.0.251 -j ACCEPT\n-A RH-Firewall-1-INPUT -p udp -m udp --dport 631 -j ACCEPT\n-A RH-Firewall-1-INPUT -p tcp -m tcp --dport 631 -j ACCEPT\n-A RH-Firewall-1-INPUT -m state --state ESTABLISHED,RELATED -j ACCEPT\n# SSH, HTTP, FTP1, FTP2, MySQL\n-A RH-Firewall-1-INPUT -m state --state NEW -m tcp -p tcp --dport 61203 -j ACCEPT\n-A RH-Firewall-1-INPUT -m state --state NEW -m tcp -p tcp --dport 80 -j ACCEPT\n-A RH-Firewall-1-INPUT -m state --state NEW -m tcp -p tcp --dport 20 -j ACCEPT\n-A RH-Firewall-1-INPUT -m state --state NEW -m tcp -p tcp --dport 21 -j ACCEPT\n-A RH-Firewall-1-INPUT -m state --state NEW -m tcp -p tcp --dport 10022 -j ACCEPT\n-A RH-Firewall-1-INPUT -j REJECT --reject-with icmp-host-prohibited\nCOMMIT\n\n\niptables\u3092\u518d\u8d77\u52d5\n$ sudo /etc/rc.d/init.d/iptables restart\n\n\n\u8a2d\u5b9a\u306e\u78ba\u8a8d\n$ sudo iptables -L\n\n>\u3000\u30b5\u30af\u30e9VPS CentOS release 6.5 2015/05/21\n>\u3000***\u53c2\u8003***\n>\u3000http://qiita.com/junki0605/items/6ce3df1933ef6d31ddfa\n\n\n#root\u3067\u30b5\u30fc\u30d0\u30fc\u306b\u63a5\u7d9a\n\n##\u30b5\u30fc\u30d0\u30fc\u306b\u63a5\u7d9a\n\n```bash\n$ ssh root@***.**.**.***\n```\n\n##root\u30d1\u30b9\u30ef\u30fc\u30c9\u306e\u5909\u66f4\n\n```bash\n$ passwd\n```\n\n##yum update\u3068\u65e5\u672c\u8a9e\u5316\n\n```bash\n$ yum update\n```\n\n```bash\n$ vim /etc/sysconfig/i18n\n```\n***\u5909\u66f4\u524d***\n\n```bash\nLANG=\"C\"\n```\n***\u5909\u66f4\u5f8c***\n\n```bash\nLANG=\"ja_JP.UTF-8\"\n```\n\n##\u4f5c\u696d\u7528\u30e6\u30fc\u30b6\u30fc\u306e\u4f5c\u6210\u3068\u8a2d\u5b9a\n\n```\n$ useradd chou\n$ passwd  chou\n```\n\u65b0\u898f\u30e6\u30fc\u30b6\uff08chou\uff09\u3092\u30eb\u30fc\u30c8\u6a29\u9650\u3092\u5f97\u3089\u308c\u308b\u30b0\u30eb\u30fc\u30d7\u306b\u8ffd\u52a0\n\n```bash\n$ usermod -G wheel chou\n```\n\n```\n$ visudo\n```\n2\u884c\u76ee\u306e#\u3092\u5916\u3057\u3066\u4fdd\u5b58\u3002\u3053\u308c\u3067wheel\u30b0\u30eb\u30fc\u30d7\u306b\u5c5e\u3059\u308b\u30e6\u30fc\u30b6\u306bsudo\u30b3\u30de\u30f3\u30c9\u306e\u5b9f\u884c\u3092\u8a31\u53ef\u3059\u308b\u3002\n\n```\n## Allows people in group wheel to run all commands\n# %wheel        ALL=(ALL)       ALL\n```\n\n#\u4f5c\u696d\u30e6\u30fc\u30b6\u30fc\u3067\u30b5\u30fc\u30d0\u30fc\u306b\u63a5\u7d9a\n\n> ```\n>$ ssh chou@xxx.xx.xx.xxx\n>```\n\n##\u9375\u8a8d\u8a3c\u306e\u8a2d\u5b9a\n\u516c\u958b\u9375\u3092\u5165\u308c\u308b\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092\u30b5\u30fc\u30d0\u30fc\u306e\u30db\u30fc\u30e0\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u4f5c\u6210\u3057\u3066\u304a\u304f\u3002\n\n```\n$ mkdir ~/.ssh\n$ chmod 700 ~/.ssh\n```\n\n\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u5074\uff08mac\uff09\u3067ssh\u9375\u30da\u30a2\u3092\u4f5c\u6210\n\n```\n$ ssh-keygen\n```\n\u3059\u308b\u3068\u3001\u301c/.ssh\u3000\u30d5\u30a9\u30eb\u30c0\u306bid_rsa\uff08\u79d8\u5bc6\u9375\uff09\u3068id_rsa.pub\uff08\u516c\u958b\u9375\uff09\u304c\u4f5c\u6210\u3055\u308c\u308b\u3002\n\n```\n$chmod 600 ~/.ssh/id_rsa.pub\n```\n\u6b21\u306b\u516c\u958b\u9375\u3092\u30b5\u30fc\u30d0\u30fc\u306b\u8ee2\u9001\n\n```\n$ scp ~/.ssh/id_rsa.pub chou@xxx.xx.xx.xxx:~/.ssh/authorized_keys\n```\n\u3067\u516c\u958b\u9375\u3092\u30b5\u30fc\u30d0\u30fc\u306b\u8ee2\u9001\u3057\u3001authorized_keys\u3068\u3044\u3046\u540d\u524d\u3067\u4fdd\u5b58\u3059\u308b\u3002\n\u3053\u308c\u3067\u3001\u9375\u8a8d\u8a3c\u3067ssh\u63a5\u7d9a\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3057\u305f\u3002\n\n#ssh\u63a5\u7d9a\u306e\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u8a2d\u5b9a\n\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3092\u958b\u304d\u3001\u8a2d\u5b9a\u3092\u5909\u66f4\u3059\u308b\u3002\n\n```\n$ sudo vim /etc/ssh/sshd_config\n```\n##\u30dd\u30fc\u30c8\u306e\u5909\u66f4\n\u30c7\u30d5\u30a9\u30eb\u30c8\u306e22\u3000\u3092\u300010022\u3000\u306b\u5909\u66f4\u3059\u308b\uff08\u8a2d\u5b9a\u53ef\u80fd\u7bc4\u56f2\uff1a1024\u301c65535\uff09\u3002\n\n***\u5909\u66f4\u524d***\n\n```\n#Port 22\n```\n***\u5909\u66f4\u5f8c***\n\n```\nPort 10022\n```\n##root\u306b\u3088\u308b\u30ed\u30b0\u30a4\u30f3\u306e\u7981\u6b62\n\n***\u5909\u66f4\u524d***\n\n```\n#PermitRootLogin yes\n```\n\n***\u5909\u66f4\u5f8c***\n\n```\nPermitRootLogin no\n```\n##password\u3067\u306e\u30ed\u30b0\u30a4\u30f3\u7981\u6b62\n***\u5909\u66f4\u524d***\n\n```\n#PasswordAuthentication yes\n```\n***\u5909\u66f4\u5f8c***\n\n```\nPasswordAuthentication no\n```\n###ssh\u3092\u518d\u8d77\u52d5\n\n```\n$ sudo service sshd restart\n```\n#FireWall\u306e\u8a2d\u5b9a\n##iptables\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u6210\u3059\u308b\n\n```\n$ sudo vim /etc/sysconfig/iptables\n```\n##\u30c7\u30d5\u30a9\u30eb\u30c8\u306710022\u756a\u3060\u3051\u306b\u30aa\u30fc\u30d7\u30f3\u3059\u308b\u3088\u3046\u306b\u5909\u66f4\u3059\u308b\u3002\n\n```\n*filter\n:INPUT ACCEPT [0:0]\n:FORWARD ACCEPT [0:0]\n:OUTPUT ACCEPT [0:0]\n:RH-Firewall-1-INPUT - [0:0]\n-A INPUT -j RH-Firewall-1-INPUT\n-A FORWARD -j RH-Firewall-1-INPUT\n-A RH-Firewall-1-INPUT -i lo -j ACCEPT\n-A RH-Firewall-1-INPUT -p icmp --icmp-type any -j ACCEPT\n-A RH-Firewall-1-INPUT -p 50 -j ACCEPT\n-A RH-Firewall-1-INPUT -p 51 -j ACCEPT\n-A RH-Firewall-1-INPUT -p udp --dport 5353 -d 224.0.0.251 -j ACCEPT\n-A RH-Firewall-1-INPUT -p udp -m udp --dport 631 -j ACCEPT\n-A RH-Firewall-1-INPUT -p tcp -m tcp --dport 631 -j ACCEPT\n-A RH-Firewall-1-INPUT -m state --state ESTABLISHED,RELATED -j ACCEPT\n# SSH, HTTP, FTP1, FTP2, MySQL\n-A RH-Firewall-1-INPUT -m state --state NEW -m tcp -p tcp --dport 61203 -j ACCEPT\n-A RH-Firewall-1-INPUT -m state --state NEW -m tcp -p tcp --dport 80 -j ACCEPT\n-A RH-Firewall-1-INPUT -m state --state NEW -m tcp -p tcp --dport 20 -j ACCEPT\n-A RH-Firewall-1-INPUT -m state --state NEW -m tcp -p tcp --dport 21 -j ACCEPT\n-A RH-Firewall-1-INPUT -m state --state NEW -m tcp -p tcp --dport 10022 -j ACCEPT\n-A RH-Firewall-1-INPUT -j REJECT --reject-with icmp-host-prohibited\nCOMMIT\n```\n##iptables\u3092\u518d\u8d77\u52d5\n\n```\n$ sudo /etc/rc.d/init.d/iptables restart\n```\n##\u8a2d\u5b9a\u306e\u78ba\u8a8d\n\n```\n$ sudo iptables -L\n```\n", "tags": ["vps"]}