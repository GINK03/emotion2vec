{"context": "\n\n\u6982\u8981\n\u6a5f\u68b0\u5b66\u7fd2\u3084\u30c7\u30fc\u30bf\u89e3\u6790\u3092\u52c9\u5f37\u3057\u3066\u3044\u308b\u3068\u6642\u3005\u76ee\u306b\u3059\u308b\u30d9\u30a4\u30b8\u30a2\u30f3\u30e2\u30c7\u30eb\u3092\u3056\u3063\u304f\u308a\u7406\u89e3\u3059\u308b\u305f\u3081\u306b\u4ee5\u4e0b\u306e\u5185\u5bb9\u3092\u307e\u3068\u3081\u307e\u3057\u305f\u3002\n\n\u3069\u306e\u3088\u3046\u306a\u80cc\u666f\u3067\u30d9\u30a4\u30b8\u30a2\u30f3\u30e2\u30c7\u30eb\u304c\u7814\u7a76\u3055\u308c\u3066\u3044\u308b\u306e\u304b\n\u30a4\u30e1\u30fc\u30b8\u3092\u3064\u304b\u3080\u305f\u3081\u306b\u7c21\u5358\u306a\u30d9\u30a4\u30b8\u30a2\u30f3\u30e2\u30c7\u30eb\u3092\u5b9f\u88c5\u3057\u3066\u307f\u308b\n\u4e00\u822c\u7684\u306a\u6a5f\u68b0\u5b66\u7fd2\u3068\u30d9\u30a4\u30b8\u30a2\u30f3\u30e2\u30c7\u30eb\u3068\u306e\u5bfe\u5fdc\n\n\n\u30d9\u30a4\u30b8\u30a2\u30f3\u30e2\u30c7\u30eb\u304c\u7814\u7a76\u3055\u308c\u308b\u80cc\u666f\n\nZoubin Ghahramani\u6c0f\u306e\u898b\u89e3\n\n\u30d9\u30a4\u30b8\u30a2\u30f3\u30e2\u30c7\u30eb\u306e\u30e1\u30ea\u30c3\u30c8\n\n\u30d5\u30ec\u30fc\u30e0\u30ef\u30fc\u30af\u304c\u5358\u7d14\u3067\u3001\u4e00\u610f\u7684\u3002\u30cb\u30e5\u30fc\u30e9\u30eb\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306e\u3088\u3046\u306b\u4efb\u610f\u6027\u306e\u3042\u308b\u6b63\u5247\u5316\u9805\u304c\u767b\u5834\u3057\u305f\u308a\u3057\u306a\u3044\u3002\n\nGaussian Process\u306e\u3088\u3046\u306a\u30ce\u30f3\u30d1\u30e9\u30e1\u30c8\u30ea\u30c3\u30af\u30fb\u30d9\u30a4\u30b8\u30a2\u30f3\u30e2\u30c7\u30eb\u306f\u8868\u73fe\u529b\u304c\u9ad8\u3044\uff08\u95a2\u6570\u7a7a\u9593\u306e\u30ab\u30d0\u30fc\u9818\u57df\u304c\u5e83\u3044\uff09\u3002\n\u904e\u9069\u5408\u304c\u751f\u3058\u306a\u3044\u3002\n\n\n\u30d9\u30a4\u30b8\u30a2\u30f3\u30e2\u30c7\u30eb\u306e\u30c7\u30e1\u30ea\u30c3\u30c8\n\n\u4e26\u5217\u51e6\u7406\u306b\u5411\u304b\u306a\u3044\u3002\n\u30e2\u30c7\u30eb\u306e\u89e3\u91c8\u304c\u96e3\u3057\u3044\u3053\u3068\u304c\u3042\u308b\u3002\n\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u306e\u518d\u73fe\u6027\u304c\u306a\u3044\u5834\u5408\u304c\u3042\u308b\u3002\n\n\uff08\u8ffd\u8a18 2017/02/17\uff09\n\u672c\u7bc0\u306e\u5185\u5bb9\u306f\u4e0d\u6b63\u78ba\u3067\u306f\u306a\u3044\u304b\u3068\u306e\u3054\u6307\u6458\u3092\u3044\u305f\u3060\u3044\u3066\u3044\u307e\u3059\u3002\n\u672c\u7bc0\u306f\u3053\u306e\u8b1b\u7fa9\u306e\u5185\u5bb9\u3092\u79c1\u306a\u308a\u306e\u89e3\u91c8\u3067\u307e\u3068\u3081\u305f\u3064\u3082\u308a\u3067\u3057\u305f\u304c\u3001\u30d9\u30a4\u30b8\u30a2\u30f3\u30e2\u30c7\u30eb\u5168\u822c\u306b\u95a2\u3059\u308b\u4e3b\u5f35\u3068\u3057\u3066\u306f\u4e0d\u6b63\u78ba\u3067\u3042\u308b\u3068\u601d\u308f\u308c\u308b\u306e\u3067\u3001\u3044\u305f\u3060\u3044\u305f\u3054\u6307\u6458\u3068\u5408\u308f\u305b\u3066\u5143\u306e\u52d5\u753b\u3092\u898b\u3066\u3044\u305f\u3060\u3051\u308c\u3070\u3068\u601d\u3044\u307e\u3059\u3002\n\n\u6a5f\u68b0\u5b66\u7fd2\u306b\u5bfe\u3059\u308b2\u3064\u306e\u8003\u3048\u65b9\n\n\u30c7\u30fc\u30bf\u3092\u8272\u3005\u306a\u624b\u6cd5\u306b\u5165\u529b\u3057\u3066\u307f\u3066\u3001\u826f\u3044\u6027\u80fd\u3092\u793a\u3059\u3082\u306e\u3092\u4f7f\u3063\u3066\u4e88\u6e2c\u3084\u610f\u601d\u6c7a\u5b9a\u3092\u3059\u308b\u3002\n\u30e2\u30c7\u30eb\u304c\u53d6\u308a\u3046\u308b\u7a7a\u9593\u3092\u5b9a\u7fa9\u3057\u3001\u30c7\u30fc\u30bf\u304b\u3089\u30d1\u30e9\u30e1\u30fc\u30bf\u3092\u5b66\u7fd2\u3057\u3066\u4e88\u6e2c\u3084\u610f\u601d\u6c7a\u5b9a\u3092\u3059\u308b\u3002\n\n\u3069\u3061\u3089\u306e\u30a2\u30d7\u30ed\u30fc\u30c1\u3082\u4e00\u9577\u4e00\u77ed\u304c\u3042\u308a\u307e\u3059\u304c\u3001\u30d9\u30a4\u30b8\u30a2\u30f3\u30e2\u30c7\u30eb\u306f\u5f8c\u8005\u306e\u7acb\u5834\u306b\u7acb\u3064\u4eba\u306b\u597d\u307e\u308c\u307e\u3059\u3002\u7279\u306b\u5b9a\u5f0f\u5316\u304c\u300c\u30a8\u30ec\u30ac\u30f3\u30c8\u3067\u3042\u308b\u300d\u70b9\u3067\u5f8c\u8005\u3068\u89aa\u548c\u6027\u304c\u9ad8\u3044\u70b9\u304c\u5f37\u8abf\u3055\u308c\u307e\u3059\u3002\n\n\u7d71\u8a08\u30e2\u30c7\u30ea\u30f3\u30b0\u624b\u6cd5\u3068\u3057\u3066\n\u4e45\u4fdd\u62d3\u5f25\u6c0f\u306e\u8457\u66f8\u3067\u306f\u3001\u73fe\u5b9f\u7684\u306a\u7d71\u8a08\u30e2\u30c7\u30eb\u69cb\u7bc9\u306e\u305f\u3081\u306b\u30d9\u30a4\u30b8\u30a2\u30f3\u30e2\u30c7\u30eb\u304c\u6709\u7528\u3067\u3042\u308b\u3053\u3068\u304c\u8aac\u660e\u3055\u308c\u3066\u3044\u307e\u3059\u3002\u4f8b\u3048\u3070\u7a7a\u9593\u69cb\u9020\u304c\u3042\u308b\u968e\u5c64\u30d9\u30a4\u30b8\u30a2\u30f3\u30e2\u30c7\u30eb\u304c\u308f\u304b\u308a\u3084\u3059\u3044\u5fdc\u7528\u4f8b\u3067\u3059\u3002\n\n\u7c21\u5358\u306a\u30d9\u30a4\u30b8\u30a2\u30f3\u30e2\u30c7\u30eb\u306e\u5b9f\u88c5\n\n\u307e\u305a\u306f\u975e\u30d9\u30a4\u30b8\u30a2\u30f3\u306e\u7d71\u8a08\u30e2\u30c7\u30eb\u304b\u3089\n\u8aac\u660e\u5909\u6570xxx\u306b\u3088\u3063\u3066\u76ee\u7684\u5909\u6570yyy\u3092\u8aac\u660e\u3059\u308b\u30e2\u30c7\u30eb\u3092\u8003\u3048\u307e\u3059\u3002\n\u3053\u306e\u3088\u3046\u306a\u6563\u5e03\u56f3\uff08\uff1d\u5b66\u7fd2\u30c7\u30fc\u30bf\uff09\u304b\u3089\u3001\n\n\u3053\u306e\u3088\u3046\u306b\u672a\u77e5\u306e\u5024\u3092\u4e88\u6e2c\u3067\u304d\u308b\u7dda\u3092\u5f15\u304f\u305f\u3081\u306b\u3001\n\n\u4ee5\u4e0b\u306e\u3088\u3046\u306aGLM\u3092\u8003\u3048\u307e\u3059\u3002\ny \\sim \\mathrm{Pois} (\\lambda)\ny\u223cPois(\u03bb)y\u223cPois(\u03bb){y \\sim \\mathrm{Pois} (\\lambda)\n}\n\\lambda = \\beta_1 + \\beta_2 \\ln x\n\u03bb=\u03b21+\u03b22lnx\u03bb=\u03b21+\u03b22lnx{\\lambda = \\beta_1 + \\beta_2 \\ln x\n}\n\n\u5165\u529b\u30c7\u30fc\u30bf\u751f\u6210\n\u73fe\u5b9f\u554f\u984c\u306e\u30c7\u30fc\u30bf\u89e3\u6790\u3067\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u65e2\u77e5\u306e\u5206\u5e03\u304b\u3089\u4eba\u5de5\u7684\u306b\u30c7\u30fc\u30bf\u304c\u751f\u6210\u3055\u308c\u308b\u3053\u3068\u306f\u306a\u3044\u3067\u3059\u304c\u3001\u89e3\u6790\u306e\u59a5\u5f53\u6027\u3092\u793a\u3059\u305f\u3081\u306b\u65e2\u77e5\u306e\u5206\u5e03\u3092\u4f7f\u3044\u307e\u3059\u3002\nnum_data <- 10\nX <- runif(n = num_data, min = 0, max = 2)\nbeta_1 <- 1\nbeta_2 <- 3\nlambda <- exp(beta_1 + beta_2 * log(X))\nY <- rpois(n = length(lambda), lambda = lambda)\n\n\nGLM\u306b\u3088\u308b\u56de\u5e30\ndf <- data.frame(x = log(X), y = Y)\nglm_result <- glm(y ~ x, data = df, family = \"poisson\")\ndf$glm <- glm_result$fitted.values\nf <- ggplot(df, aes(x, y))\nf + geom_point() + geom_line(aes(x, glm))\nglm_result\n\n\nresult\nCall:  glm(formula = y ~ x, family = \"poisson\", data = df)\n\nCoefficients:\n(Intercept)            x  \n      1.044        3.098  \n\nDegrees of Freedom: 9 Total (i.e. Null);  8 Residual\nNull Deviance:      72.94 \nResidual Deviance: 5.081    AIC: 31.59\n\n\n\u30dd\u30ef\u30bd\u30f3\u5206\u5e03\u306e\u30d1\u30e9\u30e1\u30fc\u30bf\u03bb\u03bb\\lambda\u3092\u4e0e\u3048\u308b\u5207\u7247(1.044)\u3068\u50be\u304d(3.098)\u304c\u30c7\u30fc\u30bf\u751f\u6210\u306b\u7528\u3044\u305f\u5024\u03b21=1,\u03b22=3\u03b21=1,\u03b22=3\\beta_1 = 1, \\beta_2 = 3\u306b\u305d\u308c\u306a\u308a\u306b\u8fd1\u304f\u306a\u308a\u307e\u3057\u305f\u3002\n\n\u30d9\u30a4\u30b8\u30a2\u30f3\u30e2\u30c7\u30eb\u3092\u9069\u7528\u3059\u308b\n\u3053\u306eGLM\u3092\u30d9\u30a4\u30b8\u30a2\u30f3\u30e2\u30c7\u30eb\u306b\u3059\u308b\u3053\u3068\u306f\u3056\u3063\u304f\u308a\u8a00\u3046\u3068\u300c\u03b21,\u03b22\u03b21,\u03b22\\beta_1, \\beta_2\u3092\u78ba\u7387\u5909\u6570\u3068\u3057\u3066\u6271\u3046\u3053\u3068\u300d\u306b\u5bfe\u5fdc\u3057\u307e\u3059\u3002\n\u30d9\u30a4\u30b8\u30a2\u30f3\u30e2\u30c7\u30eb\u306e\u5927\u307e\u304b\u306a\u6d41\u308c\u306f\u3001\u30d9\u30a4\u30ba\u306e\u5b9a\u7406\nP(\u30d1\u30e9\u30e1\u30fc\u30bf|\u76ee\u7684\u5909\u6570\uff09 \\propto P(\u76ee\u7684\u5909\u6570\\vert \u30d1\u30e9\u30e1\u30fc\u30bf)P(\u30d1\u30e9\u30e1\u30fc\u30bf)\nP(\u30d1\u30e9\u30e1\u30fc\u30bf|\u76ee\u7684\u5909\u6570\uff09\u221dP(\u76ee\u7684\u5909\u6570|\u30d1\u30e9\u30e1\u30fc\u30bf)P(\u30d1\u30e9\u30e1\u30fc\u30bf)P(\u30d1\u30e9\u30e1\u30fc\u30bf|\u76ee\u7684\u5909\u6570\uff09\u221dP(\u76ee\u7684\u5909\u6570|\u30d1\u30e9\u30e1\u30fc\u30bf)P(\u30d1\u30e9\u30e1\u30fc\u30bf){P(\u30d1\u30e9\u30e1\u30fc\u30bf|\u76ee\u7684\u5909\u6570\uff09 \\propto P(\u76ee\u7684\u5909\u6570\\vert \u30d1\u30e9\u30e1\u30fc\u30bf)P(\u30d1\u30e9\u30e1\u30fc\u30bf)\n}\n\u3092\u7528\u3044\u3001\n\nP(\u76ee\u7684\u5909\u6570|\u30d1\u30e9\u30e1\u30fc\u30bf)P(\u76ee\u7684\u5909\u6570 \\vert \u30d1\u30e9\u30e1\u30fc\u30bf) = \u5c24\u5ea6\u95a2\u6570\u3092\u5b9a\u7fa9\uff08\u30e2\u30c7\u30ea\u30f3\u30b0\uff09\u3057\u3001\nP(\u30d1\u30e9\u30e1\u30fc\u30bf)P(\u30d1\u30e9\u30e1\u30fc\u30bf) = \u4e8b\u524d\u5206\u5e03\u3092\u5b9a\u7fa9\u3057\u3001\n\u4f55\u3089\u304b\u306e\u65b9\u6cd5(MCMC\u306a\u3069)\u3067P(\u30d1\u30e9\u30e1\u30fc\u30bf|\u76ee\u7684\u5909\u6570)P(\u30d1\u30e9\u30e1\u30fc\u30bf \\vert \u76ee\u7684\u5909\u6570) = \u4e8b\u5f8c\u5206\u5e03\u3092\u6c42\u3081\u3001\n\u5f97\u3089\u308c\u305f\u4e8b\u5f8c\u5206\u5e03\u3092\u4e88\u6e2c\u3084\u610f\u601d\u6c7a\u5b9a\u306b\u4f7f\u3046\n\n\u3068\u3044\u3063\u305f\u3082\u306e\u3067\u3059\u3002\n\uff08\u3053\u306e\u8a18\u4e8b\u306f\u7c21\u4fbf\u5316\u306e\u305f\u3081\u306b\u8aac\u660e\u5909\u6570\u306f\u5b9a\u6570\u3068\u3057\u3066\u6271\u3044\u307e\u3059\uff09\n\u4eca\u56de\u306e\u30e2\u30c7\u30eb\u3067\u306f\u30c7\u30fc\u30bf\u6570\u3092nn\u3001X={x1,\u22ef,xn}X = \\lbrace x_1, \\cdots, x_n \\rbrace\u3001Y={y1,\u22ef,yn}Y = \\lbrace y_1, \\cdots, y_n\\rbrace\u3068\u3059\u308c\u3070\u3001\nP(y_i \\vert \\beta_1, \\beta_2, x_i)\n= \\frac{\\lambda^{y_i}}{y_i! \\exp \\lambda}\n= \\frac{(\\beta_1 + \\beta_2x_i)^{y_i}}{y_i! \\exp(\\beta_1 + \\beta_2 x_i)}\nP(yi|\u03b21,\u03b22,xi)=\u03bbyiyi!exp\u03bb=(\u03b21+\u03b22xi)yiyi!exp(\u03b21+\u03b22xi){P(y_i \\vert \\beta_1, \\beta_2, x_i)\n= \\frac{\\lambda^{y_i}}{y_i! \\exp \\lambda}\n= \\frac{(\\beta_1 + \\beta_2x_i)^{y_i}}{y_i! \\exp(\\beta_1 + \\beta_2 x_i)}\n}\nP(Y \\vert \\beta_1, \\beta_2, X) = \\prod_i P(y_i \\vert \\beta_1, \\beta_2, x_i)\nP(Y|\u03b21,\u03b22,X)=\u220fiP(yi|\u03b21,\u03b22,xi){P(Y \\vert \\beta_1, \\beta_2, X) = \\prod_i P(y_i \\vert \\beta_1, \\beta_2, x_i)\n}\n\u3068\u3044\u3046\u95a2\u4fc2\u3092\u5229\u7528\u3057\u3001\neach_likelihood_function <- function(y, x, beta_1, beta_2) {\n  dpois(x = y, lambda = exp(beta_1 + beta_2 * log(x)), log = TRUE)\n}\n\nlikelihood_function <- function(Y, X, beta_1, beta_2) {\n  each_likelihood_function(Y, X, beta_1, beta_2) %>% sum %>% exp\n}\n\n\u4ee5\u4e0a\u306e\u5c24\u5ea6\u95a2\u6570\u3092\u5b9a\u7fa9\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n\u220f\u22c5\\prod \\cdot\u306e\u4ee3\u308f\u308a\u306bexp(\u2211ln\u22c5)\\exp (\\sum \\ln \\cdot )\u3092\u4f7f\u3046\u306e\u306f\u30a2\u30f3\u30c0\u30fc\u30d5\u30ed\u30fc\u3092\u907f\u3051\u308b\u305f\u3081\u3067\u3059\u3002\n\u5b9f\u88c5\u304c\u7c21\u5358\u306b\u306a\u308b\u306e\u3067\u3001\u4ee5\u4e0b\u306e\u03b21,\u03b22\\beta_1, \\beta_2\u306e\u683c\u5b50\u70b9\u306b\u3064\u3044\u3066\u306e\u5c24\u5ea6\u3092\u53d6\u5f97\u3057\u3066\u304a\u304d\u307e\u3059\u3002\nbeta_1_candidates <- seq(from = 0.5, to = 1.5, by = 0.1)\nbeta_2_candidates <- seq(from = 2.5, to = 3.5, by = 0.1)\nparams_candidates <- merge(x = beta_1_candidates, y = beta_2_candidates, all = TRUE)\nnames(params_candidates) <- c(\"beta_1\", \"beta_2\")\nlikelihood_df <- ddply(params_candidates, .(beta_1, beta_2), function(params) {\n  data.frame(likelihood = likelihood_function(Y, X, params$beta_1, params$beta_2))\n})\nfilled.contour(\n  beta_1_candidates,\n  beta_2_candidates,\n  likelihood_df$likelihood %>% matrix(nrow = length(beta_1_candidates)),\n  key.title = title(main = \"likelihood\"),\n  xlab = \"beta_1\", ylab = \"beta_2\"\n)\n\n\nGLM\u3084\u6700\u5c24\u6cd5\u306f\u3001\u3053\u306e\u5c24\u5ea6\u3092\u6700\u5927\u5316\u3055\u305b\u308b\u03b21,\u03b22\\beta_1, \\beta_2\u3092\u6c42\u3081\u3066\u3044\u308b\u3053\u3068\u306b\u306a\u308a\u307e\u3059\u3002\n\n\u7121\u60c5\u5831\u4e8b\u524d\u5206\u5e03\n\u4e8b\u524d\u5206\u5e03P(\u03b21)P(\\beta_1)\u306f\u77e5\u308b\u3053\u3068\u304c\u3067\u304d\u305a\u3001\u5b9a\u7fa9\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\n\u3088\u304f\u4f7f\u308f\u308c\u308b\u306e\u306f\u300c\u5927\u304d\u306a\u7bc4\u56f2\u306e\u4e00\u69d8\u5206\u5e03\u300d\u3082\u3057\u304f\u306f\u300c\u3072\u3089\u3079\u3063\u305f\u3044\u6b63\u898f\u5206\u5e03\u300d\u3067\u3059\u304c[1]\u3001\u3053\u306e\u8a18\u4e8b\u3067\u306f\u524d\u8005\u3092\u9069\u7528\u3057\u3066\u9805\u3092\u7121\u8996\u3057\u307e\u3059\u3002\n\nMCMC\u3001Gibbs Sampling\n\n\u5c24\u5ea6\u95a2\u6570\u3001\u4e8b\u524d\u5206\u5e03\u3092\u5b9a\u7fa9\u3057\u305f\u3089\u3001\u3044\u3088\u3044\u3088\u4e8b\u5f8c\u5206\u5e03\u3092\u8a08\u7b97\u3067\u304d\u307e\u3059\u3002\n\u4eca\u56de\u306fMCMC(Markov chain Monte Carlo)\u306b\u5206\u985e\u3055\u308c\u308bGibbs Sampling\u3092\u5b9f\u88c5\u3057\u3066\u307f\u307e\u3059\u3002\u30cb\u30e5\u30fc\u30e9\u30eb\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u307e\u308f\u308a\u3092\u52c9\u5f37\u3055\u308c\u3066\u3044\u308b\u65b9\u306f\u3001RBM\u3067\u304a\u99b4\u67d3\u307f\u306e\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u3067\u3059\u3002\n\u03b21,\u03b22\\beta_1, \\beta_2\u3092\u3001\u4e00\u65b9\u306e\u30d1\u30e9\u30e1\u30fc\u30bf\u3092\u30b5\u30f3\u30d7\u30eb\u3059\u308b\u3068\u304d\u306f\u4ed6\u65b9\u306e\u30d1\u30e9\u30e1\u30fc\u30bf\u3092\u56fa\u5b9a\u3057\u3066\u30b5\u30f3\u30d7\u30ea\u30f3\u30b0\u3057\u307e\u3059\u3002\u4e8b\u524d\u5206\u5e03\u306f\u4e00\u69d8\u5206\u5e03\u3067\u3042\u308b\u305f\u3081\u306b\u7121\u8996\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u308b\u306e\u3067\u3001\u4ee5\u4e0b\u306e\u78ba\u7387\u5206\u5e03\u3092\u7528\u3044\u307e\u3059\u3002\nP(\\beta_1 \\vert Y, \\beta_2) \\propto P(Y \\vert \\beta_1, \\beta_2)\nP(\u03b21|Y,\u03b22)\u221dP(Y|\u03b21,\u03b22){P(\\beta_1 \\vert Y, \\beta_2) \\propto P(Y \\vert \\beta_1, \\beta_2)\n}\nP(\\beta_2 \\vert Y, \\beta_1) \\propto P(Y \\vert \\beta_1, \\beta_2)\nP(\u03b22|Y,\u03b21)\u221dP(Y|\u03b21,\u03b22){P(\\beta_2 \\vert Y, \\beta_1) \\propto P(Y \\vert \\beta_1, \\beta_2)\n}\n\u3053\u306e\u78ba\u7387\u306fFull conditional distribution\u3068\u3044\u3044\u307e\u3059\u3002\nupdate_beta <- function(candidates, full_conditional_distribution) {\n  distribution_function <- function(beta) {\n    approxfun(x = full_conditional_distribution$beta, y = full_conditional_distribution$likelihood)(beta)\n  }\n  threshold <- full_conditional_distribution$likelihood %>% max * 1.1\n\n  sample_from_distribution(\n    candidates = candidates,\n    distribution = distribution_function,\n    threshold = threshold\n  )\n}\n\ngibbs_samples <- data.frame(\n  beta_1 = vector(mode = \"numeric\", length = num_samples),\n  beta_2 = vector(mode = \"numeric\", length = num_samples)\n)\nbeta_1_sample <- head(beta_1_candidates, 1)\nbeta_2_sample <- head(beta_2_candidates, 1)\n\nfor (sample_index in 1:num_samples) {\n  # update beta_1_sample\n  full_conditional_distribution_1 <- likelihood_df[likelihood_df$beta_2 == beta_2_sample, c(\"beta_1\", \"likelihood\")]\n  names(full_conditional_distribution_1) <- c(\"beta\", \"likelihood\")\n  beta_1_sample <- update_beta(\n    candidates = beta_1_candidates,\n    full_conditional_distribution = full_conditional_distribution_1\n  )\n\n  # update beta_2_sample\n  full_conditional_distribution_2 <- likelihood_df[likelihood_df$beta_1 == beta_1_sample, c(\"beta_2\", \"likelihood\")]\n  names(full_conditional_distribution_2) <- c(\"beta\", \"likelihood\")\n\n  beta_2_sample <- update_beta(\n    candidates = beta_2_candidates,\n    full_conditional_distribution = full_conditional_distribution_2\n  )\n  gibbs_samples[sample_index, \"beta_1\"] <- beta_1_sample\n  gibbs_samples[sample_index, \"beta_2\"] <- beta_2_sample\n}\n\n\u3053\u3053\u3067\u3001\u4e0e\u3048\u3089\u308c\u305f\u78ba\u7387\u5bc6\u5ea6\u95a2\u6570\u304b\u3089\u30b5\u30f3\u30d7\u30ea\u30f3\u30b0\u3059\u308b\u624b\u6cd5\u3068\u3057\u3066Rejection Sampling\u3092\u4f7f\u7528\u3057\u305f\u306e\u3067\u6b21\u7bc0\u306b\u66f8\u304d\u307e\u3059\u3002\n\nRejection Sampling\n\n\u8a73\u7d30\u306fWikipedia\u3092\u3054\u53c2\u7167\u304f\u3060\u3055\u3044\u3002\u30b3\u30fc\u30c9\u3060\u3051\u8f09\u305b\u3066\u304a\u304d\u307e\u3059\u3002\n# sample_from_distribution(candidates, distribution ,threshold, n = 1)\n# returns a vector of samples that follow a given distribution by the rejection method\n# arguments:\n#   candidates : a vector from which to choose domain samples\n#   distribution : a distribution function\n#   threshold : the upper limit for the rejection method\n#   n : number of samples to return\n# usage:\n#   candidates <- seq(from = -1.0, to = 1.0, by = 0.1)\n#   distribution <- function(x) dnorm(x)\n#   threshold <- dnorm(0) * 1.2\n#   hist(sample_from_distribution(candidates, distribution, threshold))\n\nsample_from_distribution <- function(candidates, distribution, threshold, n = 1) {\n  sapply(seq(n), function(n_) {\n    while (TRUE) {\n      x <- sample(candidates, size = 1)\n      dice <- runif(n = 1, min = 0, max = 1)\n      if (dice < distribution(x) / threshold) {\n        return(x)\n      }\n    }\n  })\n}\n\n\n\u5b9f\u884c\u7d50\u679c\nhist(gibbs_samples$beta_1, probability = TRUE)\nhist(gibbs_samples$beta_2, probability = TRUE)\n\n\u3092\u898b\u3066\u307f\u308b\u3068\u3001\u4ee5\u4e0b\u306e\u30d2\u30b9\u30c8\u30b0\u30e9\u30e0\u3092\u5f97\u307e\u3059\u3002\n\n\n\u751f\u6210\u306b\u7528\u3044\u305f\u771f\u5024\u03b21=1,\u03b22=3\\beta_1 = 1, \\beta_2 = 3\u306e\u5468\u8fba\u306e\u5206\u5e03\u3092\u5f97\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3057\u305f\u3002\n\n\u4e00\u822c\u7684\u306a\u6a5f\u68b0\u5b66\u7fd2\u3068\u306e\u5bfe\u5fdc\n\u3053\u306e\u3088\u3046\u306b\u30d9\u30a4\u30b8\u30a2\u30f3\u30e2\u30c7\u30eb\u3067\u3082\u7d50\u5c40\u3084\u308b\u3053\u3068\u306f\u3001\u4e0e\u3048\u3089\u308c\u305f\u30c7\u30fc\u30bf\u30bb\u30c3\u30c8\u3092\u5b66\u7fd2\u3059\u308b\u305f\u3081\u306b\u6700\u9069\u5316\u3084\u30b5\u30f3\u30d7\u30ea\u30f3\u30b0\u306a\u3069\u306e\u8a08\u7b97\u3092\u884c\u3046\u3068\u3044\u3046\u70b9\u3067\u4ed6\u306e\u6a5f\u68b0\u5b66\u7fd2\u3068\u540c\u69d8\u3067\u3059\u3002\n\u6982\u5ff5\u7684\u306b\u306f\u4ee5\u4e0b\u3088\u3046\u306a\u5bfe\u5fdc\u3092\u3042\u3066\u306f\u3081\u308b\u3068\u30a4\u30e1\u30fc\u30b8\u3057\u3084\u3059\u3044\u3067\u3059\u3002\n\n\n\n\u4e00\u822c\u7684\u306a\u6a5f\u68b0\u5b66\u7fd2\n\u30d9\u30a4\u30b8\u30a2\u30f3\u30e2\u30c7\u30eb\n\n\n\n\n\u5b66\u7fd2\nMCMC\u7b49\n\n\n\u5b66\u7fd2\u30d1\u30e9\u30e1\u30fc\u30bf\n\u78ba\u7387\u30e2\u30c7\u30eb\u306e\u30d1\u30e9\u30e1\u30fc\u30bf\n\n\n\u8a55\u4fa1\u95a2\u6570\n\u4e8b\u5f8c\u78ba\u7387\n\n\n\n\n\u53c2\u8003\u6587\u732e\n\n[1] amazon: \u30c7\u30fc\u30bf\u89e3\u6790\u306e\u305f\u3081\u306e\u7d71\u8a08\u30e2\u30c7\u30ea\u30f3\u30b0\u5165\u9580\u2015\u2015\u4e00\u822c\u5316\u7dda\u5f62\u30e2\u30c7\u30eb\u30fb\u968e\u5c64\u30d9\u30a4\u30ba\u30e2\u30c7\u30eb\u30fbMCMC (\u78ba\u7387\u3068\u60c5\u5831\u306e\u79d1\u5b66)\npdf: MCMC\u3068\u968e\u5c64\u30d9\u30a4\u30ba\u30e2\u30c7\u30eb\nvideo: Why Bayesian Nonparametrics?\nvideo: Gaussian Process Basics\n\n# \u6982\u8981\n\n\u6a5f\u68b0\u5b66\u7fd2\u3084\u30c7\u30fc\u30bf\u89e3\u6790\u3092\u52c9\u5f37\u3057\u3066\u3044\u308b\u3068\u6642\u3005\u76ee\u306b\u3059\u308b\u30d9\u30a4\u30b8\u30a2\u30f3\u30e2\u30c7\u30eb\u3092\u3056\u3063\u304f\u308a\u7406\u89e3\u3059\u308b\u305f\u3081\u306b\u4ee5\u4e0b\u306e\u5185\u5bb9\u3092\u307e\u3068\u3081\u307e\u3057\u305f\u3002\n\n- \u3069\u306e\u3088\u3046\u306a\u80cc\u666f\u3067\u30d9\u30a4\u30b8\u30a2\u30f3\u30e2\u30c7\u30eb\u304c\u7814\u7a76\u3055\u308c\u3066\u3044\u308b\u306e\u304b\n- \u30a4\u30e1\u30fc\u30b8\u3092\u3064\u304b\u3080\u305f\u3081\u306b\u7c21\u5358\u306a\u30d9\u30a4\u30b8\u30a2\u30f3\u30e2\u30c7\u30eb\u3092\u5b9f\u88c5\u3057\u3066\u307f\u308b\n- \u4e00\u822c\u7684\u306a\u6a5f\u68b0\u5b66\u7fd2\u3068\u30d9\u30a4\u30b8\u30a2\u30f3\u30e2\u30c7\u30eb\u3068\u306e\u5bfe\u5fdc\n\n# \u30d9\u30a4\u30b8\u30a2\u30f3\u30e2\u30c7\u30eb\u304c\u7814\u7a76\u3055\u308c\u308b\u80cc\u666f\n\n## [Zoubin Ghahramani](http://videolectures.net/nipsworkshops2011_ghahramani_nonparametrics/)\u6c0f\u306e\u898b\u89e3\n\n### \u30d9\u30a4\u30b8\u30a2\u30f3\u30e2\u30c7\u30eb\u306e\u30e1\u30ea\u30c3\u30c8\n- \u30d5\u30ec\u30fc\u30e0\u30ef\u30fc\u30af\u304c\u5358\u7d14\u3067\u3001\u4e00\u610f\u7684\u3002\u30cb\u30e5\u30fc\u30e9\u30eb\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306e\u3088\u3046\u306b\u4efb\u610f\u6027\u306e\u3042\u308b\u6b63\u5247\u5316\u9805\u304c\u767b\u5834\u3057\u305f\u308a\u3057\u306a\u3044\u3002\n- [Gaussian Process](https://en.wikipedia.org/wiki/Gaussian_process)\u306e\u3088\u3046\u306a\u30ce\u30f3\u30d1\u30e9\u30e1\u30c8\u30ea\u30c3\u30af\u30fb\u30d9\u30a4\u30b8\u30a2\u30f3\u30e2\u30c7\u30eb\u306f\u8868\u73fe\u529b\u304c\u9ad8\u3044\uff08\u95a2\u6570\u7a7a\u9593\u306e\u30ab\u30d0\u30fc\u9818\u57df\u304c\u5e83\u3044\uff09\u3002\n- \u904e\u9069\u5408\u304c\u751f\u3058\u306a\u3044\u3002\n\n### \u30d9\u30a4\u30b8\u30a2\u30f3\u30e2\u30c7\u30eb\u306e\u30c7\u30e1\u30ea\u30c3\u30c8\n\n- \u4e26\u5217\u51e6\u7406\u306b\u5411\u304b\u306a\u3044\u3002\n- \u30e2\u30c7\u30eb\u306e\u89e3\u91c8\u304c\u96e3\u3057\u3044\u3053\u3068\u304c\u3042\u308b\u3002\n- \u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u306e\u518d\u73fe\u6027\u304c\u306a\u3044\u5834\u5408\u304c\u3042\u308b\u3002\n\n\uff08\u8ffd\u8a18 2017/02/17\uff09\n\u672c\u7bc0\u306e\u5185\u5bb9\u306f\u4e0d\u6b63\u78ba\u3067\u306f\u306a\u3044\u304b\u3068\u306e[\u3054\u6307\u6458](http://qiita.com/sergeant-wizard/items/d0ec93f625e596258182/patches/29641)\u3092\u3044\u305f\u3060\u3044\u3066\u3044\u307e\u3059\u3002\n\u672c\u7bc0\u306f[\u3053\u306e\u8b1b\u7fa9](http://videolectures.net/nipsworkshops2011_ghahramani_nonparametrics/)\u306e\u5185\u5bb9\u3092\u79c1\u306a\u308a\u306e\u89e3\u91c8\u3067\u307e\u3068\u3081\u305f\u3064\u3082\u308a\u3067\u3057\u305f\u304c\u3001\u30d9\u30a4\u30b8\u30a2\u30f3\u30e2\u30c7\u30eb\u5168\u822c\u306b\u95a2\u3059\u308b\u4e3b\u5f35\u3068\u3057\u3066\u306f\u4e0d\u6b63\u78ba\u3067\u3042\u308b\u3068\u601d\u308f\u308c\u308b\u306e\u3067\u3001\u3044\u305f\u3060\u3044\u305f\u3054\u6307\u6458\u3068\u5408\u308f\u305b\u3066\u5143\u306e\u52d5\u753b\u3092\u898b\u3066\u3044\u305f\u3060\u3051\u308c\u3070\u3068\u601d\u3044\u307e\u3059\u3002\n\n### \u6a5f\u68b0\u5b66\u7fd2\u306b\u5bfe\u3059\u308b2\u3064\u306e\u8003\u3048\u65b9\n\n- \u30c7\u30fc\u30bf\u3092\u8272\u3005\u306a\u624b\u6cd5\u306b\u5165\u529b\u3057\u3066\u307f\u3066\u3001\u826f\u3044\u6027\u80fd\u3092\u793a\u3059\u3082\u306e\u3092\u4f7f\u3063\u3066\u4e88\u6e2c\u3084\u610f\u601d\u6c7a\u5b9a\u3092\u3059\u308b\u3002\n- \u30e2\u30c7\u30eb\u304c\u53d6\u308a\u3046\u308b\u7a7a\u9593\u3092\u5b9a\u7fa9\u3057\u3001\u30c7\u30fc\u30bf\u304b\u3089\u30d1\u30e9\u30e1\u30fc\u30bf\u3092\u5b66\u7fd2\u3057\u3066\u4e88\u6e2c\u3084\u610f\u601d\u6c7a\u5b9a\u3092\u3059\u308b\u3002\n\n\u3069\u3061\u3089\u306e\u30a2\u30d7\u30ed\u30fc\u30c1\u3082\u4e00\u9577\u4e00\u77ed\u304c\u3042\u308a\u307e\u3059\u304c\u3001\u30d9\u30a4\u30b8\u30a2\u30f3\u30e2\u30c7\u30eb\u306f\u5f8c\u8005\u306e\u7acb\u5834\u306b\u7acb\u3064\u4eba\u306b\u597d\u307e\u308c\u307e\u3059\u3002\u7279\u306b\u5b9a\u5f0f\u5316\u304c\u300c\u30a8\u30ec\u30ac\u30f3\u30c8\u3067\u3042\u308b\u300d\u70b9\u3067\u5f8c\u8005\u3068\u89aa\u548c\u6027\u304c\u9ad8\u3044\u70b9\u304c\u5f37\u8abf\u3055\u308c\u307e\u3059\u3002\n\n## \u7d71\u8a08\u30e2\u30c7\u30ea\u30f3\u30b0\u624b\u6cd5\u3068\u3057\u3066\n\n[\u4e45\u4fdd\u62d3\u5f25\u6c0f\u306e\u8457\u66f8](http://www.amazon.co.jp/%E3%83%87%E3%83%BC%E3%82%BF%E8%A7%A3%E6%9E%90%E3%81%AE%E3%81%9F%E3%82%81%E3%81%AE%E7%B5%B1%E8%A8%88%E3%83%A2%E3%83%87%E3%83%AA%E3%83%B3%E3%82%B0%E5%85%A5%E9%96%80%E2%80%95%E2%80%95%E4%B8%80%E8%88%AC%E5%8C%96%E7%B7%9A%E5%BD%A2%E3%83%A2%E3%83%87%E3%83%AB%E3%83%BB%E9%9A%8E%E5%B1%A4%E3%83%99%E3%82%A4%E3%82%BA%E3%83%A2%E3%83%87%E3%83%AB%E3%83%BBMCMC-%E7%A2%BA%E7%8E%87%E3%81%A8%E6%83%85%E5%A0%B1%E3%81%AE%E7%A7%91%E5%AD%A6-%E4%B9%85%E4%BF%9D-%E6%8B%93%E5%BC%A5/dp/400006973X)\u3067\u306f\u3001\u73fe\u5b9f\u7684\u306a\u7d71\u8a08\u30e2\u30c7\u30eb\u69cb\u7bc9\u306e\u305f\u3081\u306b\u30d9\u30a4\u30b8\u30a2\u30f3\u30e2\u30c7\u30eb\u304c\u6709\u7528\u3067\u3042\u308b\u3053\u3068\u304c\u8aac\u660e\u3055\u308c\u3066\u3044\u307e\u3059\u3002\u4f8b\u3048\u3070[\u7a7a\u9593\u69cb\u9020\u304c\u3042\u308b\u968e\u5c64\u30d9\u30a4\u30b8\u30a2\u30f3\u30e2\u30c7\u30eb](http://hosho.ees.hokudai.ac.jp/~kubo/stat/2010/j/kuboLec2010j.pdf)\u304c\u308f\u304b\u308a\u3084\u3059\u3044\u5fdc\u7528\u4f8b\u3067\u3059\u3002\n\n# \u7c21\u5358\u306a\u30d9\u30a4\u30b8\u30a2\u30f3\u30e2\u30c7\u30eb\u306e\u5b9f\u88c5\n\n## \u307e\u305a\u306f\u975e\u30d9\u30a4\u30b8\u30a2\u30f3\u306e\u7d71\u8a08\u30e2\u30c7\u30eb\u304b\u3089\n\n\u8aac\u660e\u5909\u6570$x$\u306b\u3088\u3063\u3066\u76ee\u7684\u5909\u6570$y$\u3092\u8aac\u660e\u3059\u308b\u30e2\u30c7\u30eb\u3092\u8003\u3048\u307e\u3059\u3002\n\n\u3053\u306e\u3088\u3046\u306a\u6563\u5e03\u56f3\uff08\uff1d\u5b66\u7fd2\u30c7\u30fc\u30bf\uff09\u304b\u3089\u3001\n![non_bayesian_input.png](https://qiita-image-store.s3.amazonaws.com/0/67217/44588496-4021-dfb0-43c5-06a30c35e349.png)\n\n\n\n\u3053\u306e\u3088\u3046\u306b\u672a\u77e5\u306e\u5024\u3092\u4e88\u6e2c\u3067\u304d\u308b\u7dda\u3092\u5f15\u304f\u305f\u3081\u306b\u3001\n![non_bayesian_regression.png](https://qiita-image-store.s3.amazonaws.com/0/67217/ae6091a4-70ac-096b-1901-9364e0293437.png)\n\n\u4ee5\u4e0b\u306e\u3088\u3046\u306aGLM\u3092\u8003\u3048\u307e\u3059\u3002\n\n```math\ny \\sim \\mathrm{Pois} (\\lambda)\n```\n\n```math\n\\lambda = \\beta_1 + \\beta_2 \\ln x\n```\n\n### \u5165\u529b\u30c7\u30fc\u30bf\u751f\u6210\n\n\u73fe\u5b9f\u554f\u984c\u306e\u30c7\u30fc\u30bf\u89e3\u6790\u3067\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u65e2\u77e5\u306e\u5206\u5e03\u304b\u3089\u4eba\u5de5\u7684\u306b\u30c7\u30fc\u30bf\u304c\u751f\u6210\u3055\u308c\u308b\u3053\u3068\u306f\u306a\u3044\u3067\u3059\u304c\u3001\u89e3\u6790\u306e\u59a5\u5f53\u6027\u3092\u793a\u3059\u305f\u3081\u306b\u65e2\u77e5\u306e\u5206\u5e03\u3092\u4f7f\u3044\u307e\u3059\u3002\n\n```r\nnum_data <- 10\nX <- runif(n = num_data, min = 0, max = 2)\nbeta_1 <- 1\nbeta_2 <- 3\nlambda <- exp(beta_1 + beta_2 * log(X))\nY <- rpois(n = length(lambda), lambda = lambda)\n```\n\n### GLM\u306b\u3088\u308b\u56de\u5e30\n\n```r\ndf <- data.frame(x = log(X), y = Y)\nglm_result <- glm(y ~ x, data = df, family = \"poisson\")\ndf$glm <- glm_result$fitted.values\nf <- ggplot(df, aes(x, y))\nf + geom_point() + geom_line(aes(x, glm))\nglm_result\n```\n\n```r:result\nCall:  glm(formula = y ~ x, family = \"poisson\", data = df)\n\nCoefficients:\n(Intercept)            x  \n      1.044        3.098  \n\nDegrees of Freedom: 9 Total (i.e. Null);  8 Residual\nNull Deviance:\t    72.94 \nResidual Deviance: 5.081 \tAIC: 31.59\n```\n\n\u30dd\u30ef\u30bd\u30f3\u5206\u5e03\u306e\u30d1\u30e9\u30e1\u30fc\u30bf$\\lambda$\u3092\u4e0e\u3048\u308b\u5207\u7247(`1.044`)\u3068\u50be\u304d(`3.098`)\u304c\u30c7\u30fc\u30bf\u751f\u6210\u306b\u7528\u3044\u305f\u5024$\\beta_1 = 1, \\beta_2 = 3$\u306b\u305d\u308c\u306a\u308a\u306b\u8fd1\u304f\u306a\u308a\u307e\u3057\u305f\u3002\n\n## \u30d9\u30a4\u30b8\u30a2\u30f3\u30e2\u30c7\u30eb\u3092\u9069\u7528\u3059\u308b\n\n\u3053\u306eGLM\u3092\u30d9\u30a4\u30b8\u30a2\u30f3\u30e2\u30c7\u30eb\u306b\u3059\u308b\u3053\u3068\u306f\u3056\u3063\u304f\u308a\u8a00\u3046\u3068\u300c$\\beta_1, \\beta_2$\u3092\u78ba\u7387\u5909\u6570\u3068\u3057\u3066\u6271\u3046\u3053\u3068\u300d\u306b\u5bfe\u5fdc\u3057\u307e\u3059\u3002\n\u30d9\u30a4\u30b8\u30a2\u30f3\u30e2\u30c7\u30eb\u306e\u5927\u307e\u304b\u306a\u6d41\u308c\u306f\u3001\u30d9\u30a4\u30ba\u306e\u5b9a\u7406\n\n```math\nP(\u30d1\u30e9\u30e1\u30fc\u30bf|\u76ee\u7684\u5909\u6570\uff09 \\propto P(\u76ee\u7684\u5909\u6570\\vert \u30d1\u30e9\u30e1\u30fc\u30bf)P(\u30d1\u30e9\u30e1\u30fc\u30bf)\n```\n\n\u3092\u7528\u3044\u3001\n\n1. $P(\u76ee\u7684\u5909\u6570 \\vert \u30d1\u30e9\u30e1\u30fc\u30bf)$ = \u5c24\u5ea6\u95a2\u6570\u3092\u5b9a\u7fa9\uff08\u30e2\u30c7\u30ea\u30f3\u30b0\uff09\u3057\u3001\n2. $P(\u30d1\u30e9\u30e1\u30fc\u30bf)$ = \u4e8b\u524d\u5206\u5e03\u3092\u5b9a\u7fa9\u3057\u3001\n3. \u4f55\u3089\u304b\u306e\u65b9\u6cd5(MCMC\u306a\u3069)\u3067$P(\u30d1\u30e9\u30e1\u30fc\u30bf \\vert \u76ee\u7684\u5909\u6570)$ = \u4e8b\u5f8c\u5206\u5e03\u3092\u6c42\u3081\u3001\n4. \u5f97\u3089\u308c\u305f\u4e8b\u5f8c\u5206\u5e03\u3092\u4e88\u6e2c\u3084\u610f\u601d\u6c7a\u5b9a\u306b\u4f7f\u3046\n\n\u3068\u3044\u3063\u305f\u3082\u306e\u3067\u3059\u3002\n\uff08\u3053\u306e\u8a18\u4e8b\u306f\u7c21\u4fbf\u5316\u306e\u305f\u3081\u306b\u8aac\u660e\u5909\u6570\u306f\u5b9a\u6570\u3068\u3057\u3066\u6271\u3044\u307e\u3059\uff09\n\n\u4eca\u56de\u306e\u30e2\u30c7\u30eb\u3067\u306f\u30c7\u30fc\u30bf\u6570\u3092$n$\u3001$X = \\lbrace x_1, \\cdots, x_n \\rbrace$\u3001$Y = \\lbrace y_1, \\cdots, y_n\\rbrace$\u3068\u3059\u308c\u3070\u3001\n\n```math\nP(y_i \\vert \\beta_1, \\beta_2, x_i)\n= \\frac{\\lambda^{y_i}}{y_i! \\exp \\lambda}\n= \\frac{(\\beta_1 + \\beta_2x_i)^{y_i}}{y_i! \\exp(\\beta_1 + \\beta_2 x_i)}\n```\n\n```math\nP(Y \\vert \\beta_1, \\beta_2, X) = \\prod_i P(y_i \\vert \\beta_1, \\beta_2, x_i)\n```\n\n\u3068\u3044\u3046\u95a2\u4fc2\u3092\u5229\u7528\u3057\u3001\n\n```r\neach_likelihood_function <- function(y, x, beta_1, beta_2) {\n  dpois(x = y, lambda = exp(beta_1 + beta_2 * log(x)), log = TRUE)\n}\n\nlikelihood_function <- function(Y, X, beta_1, beta_2) {\n  each_likelihood_function(Y, X, beta_1, beta_2) %>% sum %>% exp\n}\n```\n\n\u4ee5\u4e0a\u306e\u5c24\u5ea6\u95a2\u6570\u3092\u5b9a\u7fa9\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n$\\prod \\cdot$\u306e\u4ee3\u308f\u308a\u306b$\\exp (\\sum \\ln \\cdot )$\u3092\u4f7f\u3046\u306e\u306f\u30a2\u30f3\u30c0\u30fc\u30d5\u30ed\u30fc\u3092\u907f\u3051\u308b\u305f\u3081\u3067\u3059\u3002\n\n\u5b9f\u88c5\u304c\u7c21\u5358\u306b\u306a\u308b\u306e\u3067\u3001\u4ee5\u4e0b\u306e$\\beta_1, \\beta_2$\u306e\u683c\u5b50\u70b9\u306b\u3064\u3044\u3066\u306e\u5c24\u5ea6\u3092\u53d6\u5f97\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n\n```r\nbeta_1_candidates <- seq(from = 0.5, to = 1.5, by = 0.1)\nbeta_2_candidates <- seq(from = 2.5, to = 3.5, by = 0.1)\nparams_candidates <- merge(x = beta_1_candidates, y = beta_2_candidates, all = TRUE)\nnames(params_candidates) <- c(\"beta_1\", \"beta_2\")\nlikelihood_df <- ddply(params_candidates, .(beta_1, beta_2), function(params) {\n  data.frame(likelihood = likelihood_function(Y, X, params$beta_1, params$beta_2))\n})\nfilled.contour(\n  beta_1_candidates,\n  beta_2_candidates,\n  likelihood_df$likelihood %>% matrix(nrow = length(beta_1_candidates)),\n  key.title = title(main = \"likelihood\"),\n  xlab = \"beta_1\", ylab = \"beta_2\"\n)\n```\n\n![likelihood_contour.png](https://qiita-image-store.s3.amazonaws.com/0/67217/36952d0c-e94a-0b09-8b20-50d89823ac61.png)\n\nGLM\u3084\u6700\u5c24\u6cd5\u306f\u3001\u3053\u306e\u5c24\u5ea6\u3092\u6700\u5927\u5316\u3055\u305b\u308b$\\beta_1, \\beta_2$\u3092\u6c42\u3081\u3066\u3044\u308b\u3053\u3068\u306b\u306a\u308a\u307e\u3059\u3002\n\n### \u7121\u60c5\u5831\u4e8b\u524d\u5206\u5e03\n\n\u4e8b\u524d\u5206\u5e03$P(\\beta_1)$\u306f\u77e5\u308b\u3053\u3068\u304c\u3067\u304d\u305a\u3001\u5b9a\u7fa9\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\n\u3088\u304f\u4f7f\u308f\u308c\u308b\u306e\u306f\u300c\u5927\u304d\u306a\u7bc4\u56f2\u306e\u4e00\u69d8\u5206\u5e03\u300d\u3082\u3057\u304f\u306f\u300c\u3072\u3089\u3079\u3063\u305f\u3044\u6b63\u898f\u5206\u5e03\u300d\u3067\u3059\u304c[1]\u3001\u3053\u306e\u8a18\u4e8b\u3067\u306f\u524d\u8005\u3092\u9069\u7528\u3057\u3066\u9805\u3092\u7121\u8996\u3057\u307e\u3059\u3002\n\n### [MCMC](https://en.wikipedia.org/wiki/Markov_chain_Monte_Carlo)\u3001[Gibbs Sampling](https://en.wikipedia.org/wiki/Gibbs_sampling)\n\n\u5c24\u5ea6\u95a2\u6570\u3001\u4e8b\u524d\u5206\u5e03\u3092\u5b9a\u7fa9\u3057\u305f\u3089\u3001\u3044\u3088\u3044\u3088\u4e8b\u5f8c\u5206\u5e03\u3092\u8a08\u7b97\u3067\u304d\u307e\u3059\u3002\n\u4eca\u56de\u306fMCMC(Markov chain Monte Carlo)\u306b\u5206\u985e\u3055\u308c\u308bGibbs Sampling\u3092\u5b9f\u88c5\u3057\u3066\u307f\u307e\u3059\u3002\u30cb\u30e5\u30fc\u30e9\u30eb\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u307e\u308f\u308a\u3092\u52c9\u5f37\u3055\u308c\u3066\u3044\u308b\u65b9\u306f\u3001[RBM](https://en.wikipedia.org/wiki/Restricted_Boltzmann_machine)\u3067\u304a\u99b4\u67d3\u307f\u306e\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u3067\u3059\u3002\n\n$\\beta_1, \\beta_2$\u3092\u3001\u4e00\u65b9\u306e\u30d1\u30e9\u30e1\u30fc\u30bf\u3092\u30b5\u30f3\u30d7\u30eb\u3059\u308b\u3068\u304d\u306f\u4ed6\u65b9\u306e\u30d1\u30e9\u30e1\u30fc\u30bf\u3092\u56fa\u5b9a\u3057\u3066\u30b5\u30f3\u30d7\u30ea\u30f3\u30b0\u3057\u307e\u3059\u3002\u4e8b\u524d\u5206\u5e03\u306f\u4e00\u69d8\u5206\u5e03\u3067\u3042\u308b\u305f\u3081\u306b\u7121\u8996\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u308b\u306e\u3067\u3001\u4ee5\u4e0b\u306e\u78ba\u7387\u5206\u5e03\u3092\u7528\u3044\u307e\u3059\u3002\n\n```math\nP(\\beta_1 \\vert Y, \\beta_2) \\propto P(Y \\vert \\beta_1, \\beta_2)\n```\n```math\nP(\\beta_2 \\vert Y, \\beta_1) \\propto P(Y \\vert \\beta_1, \\beta_2)\n```\n\n\u3053\u306e\u78ba\u7387\u306fFull conditional distribution\u3068\u3044\u3044\u307e\u3059\u3002\n\n```r\nupdate_beta <- function(candidates, full_conditional_distribution) {\n  distribution_function <- function(beta) {\n    approxfun(x = full_conditional_distribution$beta, y = full_conditional_distribution$likelihood)(beta)\n  }\n  threshold <- full_conditional_distribution$likelihood %>% max * 1.1\n  \n  sample_from_distribution(\n    candidates = candidates,\n    distribution = distribution_function,\n    threshold = threshold\n  )\n}\n\ngibbs_samples <- data.frame(\n  beta_1 = vector(mode = \"numeric\", length = num_samples),\n  beta_2 = vector(mode = \"numeric\", length = num_samples)\n)\nbeta_1_sample <- head(beta_1_candidates, 1)\nbeta_2_sample <- head(beta_2_candidates, 1)\n\nfor (sample_index in 1:num_samples) {\n  # update beta_1_sample\n  full_conditional_distribution_1 <- likelihood_df[likelihood_df$beta_2 == beta_2_sample, c(\"beta_1\", \"likelihood\")]\n  names(full_conditional_distribution_1) <- c(\"beta\", \"likelihood\")\n  beta_1_sample <- update_beta(\n    candidates = beta_1_candidates,\n    full_conditional_distribution = full_conditional_distribution_1\n  )\n  \n  # update beta_2_sample\n  full_conditional_distribution_2 <- likelihood_df[likelihood_df$beta_1 == beta_1_sample, c(\"beta_2\", \"likelihood\")]\n  names(full_conditional_distribution_2) <- c(\"beta\", \"likelihood\")\n  \n  beta_2_sample <- update_beta(\n    candidates = beta_2_candidates,\n    full_conditional_distribution = full_conditional_distribution_2\n  )\n  gibbs_samples[sample_index, \"beta_1\"] <- beta_1_sample\n  gibbs_samples[sample_index, \"beta_2\"] <- beta_2_sample\n}\n```\n\n\u3053\u3053\u3067\u3001\u4e0e\u3048\u3089\u308c\u305f\u78ba\u7387\u5bc6\u5ea6\u95a2\u6570\u304b\u3089\u30b5\u30f3\u30d7\u30ea\u30f3\u30b0\u3059\u308b\u624b\u6cd5\u3068\u3057\u3066Rejection Sampling\u3092\u4f7f\u7528\u3057\u305f\u306e\u3067\u6b21\u7bc0\u306b\u66f8\u304d\u307e\u3059\u3002\n\n#### [Rejection Sampling](https://en.wikipedia.org/wiki/Rejection_sampling)\n\n\u8a73\u7d30\u306fWikipedia\u3092\u3054\u53c2\u7167\u304f\u3060\u3055\u3044\u3002\u30b3\u30fc\u30c9\u3060\u3051\u8f09\u305b\u3066\u304a\u304d\u307e\u3059\u3002\n\n```r\n# sample_from_distribution(candidates, distribution ,threshold, n = 1)\n# returns a vector of samples that follow a given distribution by the rejection method\n# arguments:\n#   candidates : a vector from which to choose domain samples\n#   distribution : a distribution function\n#   threshold : the upper limit for the rejection method\n#   n : number of samples to return\n# usage:\n#   candidates <- seq(from = -1.0, to = 1.0, by = 0.1)\n#   distribution <- function(x) dnorm(x)\n#   threshold <- dnorm(0) * 1.2\n#   hist(sample_from_distribution(candidates, distribution, threshold))\n\nsample_from_distribution <- function(candidates, distribution, threshold, n = 1) {\n  sapply(seq(n), function(n_) {\n    while (TRUE) {\n      x <- sample(candidates, size = 1)\n      dice <- runif(n = 1, min = 0, max = 1)\n      if (dice < distribution(x) / threshold) {\n        return(x)\n      }\n    }\n  })\n}\n```\n\n## \u5b9f\u884c\u7d50\u679c\n\n```\nhist(gibbs_samples$beta_1, probability = TRUE)\nhist(gibbs_samples$beta_2, probability = TRUE)\n```\n\n\u3092\u898b\u3066\u307f\u308b\u3068\u3001\u4ee5\u4e0b\u306e\u30d2\u30b9\u30c8\u30b0\u30e9\u30e0\u3092\u5f97\u307e\u3059\u3002\n\n![beta_1_density.png](https://qiita-image-store.s3.amazonaws.com/0/67217/23d0e3e4-2c8f-aa22-4915-d80905b22573.png)\n\n![beta_2_density.png](https://qiita-image-store.s3.amazonaws.com/0/67217/869d4269-1186-cffe-b401-13ce2153857a.png)\n\n\u751f\u6210\u306b\u7528\u3044\u305f\u771f\u5024$\\beta_1 = 1, \\beta_2 = 3$\u306e\u5468\u8fba\u306e\u5206\u5e03\u3092\u5f97\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3057\u305f\u3002\n\n# \u4e00\u822c\u7684\u306a\u6a5f\u68b0\u5b66\u7fd2\u3068\u306e\u5bfe\u5fdc\n\n\u3053\u306e\u3088\u3046\u306b\u30d9\u30a4\u30b8\u30a2\u30f3\u30e2\u30c7\u30eb\u3067\u3082\u7d50\u5c40\u3084\u308b\u3053\u3068\u306f\u3001\u4e0e\u3048\u3089\u308c\u305f\u30c7\u30fc\u30bf\u30bb\u30c3\u30c8\u3092\u5b66\u7fd2\u3059\u308b\u305f\u3081\u306b\u6700\u9069\u5316\u3084\u30b5\u30f3\u30d7\u30ea\u30f3\u30b0\u306a\u3069\u306e\u8a08\u7b97\u3092\u884c\u3046\u3068\u3044\u3046\u70b9\u3067\u4ed6\u306e\u6a5f\u68b0\u5b66\u7fd2\u3068\u540c\u69d8\u3067\u3059\u3002\n\u6982\u5ff5\u7684\u306b\u306f\u4ee5\u4e0b\u3088\u3046\u306a\u5bfe\u5fdc\u3092\u3042\u3066\u306f\u3081\u308b\u3068\u30a4\u30e1\u30fc\u30b8\u3057\u3084\u3059\u3044\u3067\u3059\u3002\n\n|\u4e00\u822c\u7684\u306a\u6a5f\u68b0\u5b66\u7fd2|\u30d9\u30a4\u30b8\u30a2\u30f3\u30e2\u30c7\u30eb|\n|---|---|\n|\u5b66\u7fd2|MCMC\u7b49|\n|\u5b66\u7fd2\u30d1\u30e9\u30e1\u30fc\u30bf|\u78ba\u7387\u30e2\u30c7\u30eb\u306e\u30d1\u30e9\u30e1\u30fc\u30bf|\n|\u8a55\u4fa1\u95a2\u6570|\u4e8b\u5f8c\u78ba\u7387|\n\n# \u53c2\u8003\u6587\u732e\n\n- [[1] amazon: \u30c7\u30fc\u30bf\u89e3\u6790\u306e\u305f\u3081\u306e\u7d71\u8a08\u30e2\u30c7\u30ea\u30f3\u30b0\u5165\u9580\u2015\u2015\u4e00\u822c\u5316\u7dda\u5f62\u30e2\u30c7\u30eb\u30fb\u968e\u5c64\u30d9\u30a4\u30ba\u30e2\u30c7\u30eb\u30fbMCMC (\u78ba\u7387\u3068\u60c5\u5831\u306e\u79d1\u5b66)](http://www.amazon.co.jp/%E3%83%87%E3%83%BC%E3%82%BF%E8%A7%A3%E6%9E%90%E3%81%AE%E3%81%9F%E3%82%81%E3%81%AE%E7%B5%B1%E8%A8%88%E3%83%A2%E3%83%87%E3%83%AA%E3%83%B3%E3%82%B0%E5%85%A5%E9%96%80%E2%80%95%E2%80%95%E4%B8%80%E8%88%AC%E5%8C%96%E7%B7%9A%E5%BD%A2%E3%83%A2%E3%83%87%E3%83%AB%E3%83%BB%E9%9A%8E%E5%B1%A4%E3%83%99%E3%82%A4%E3%82%BA%E3%83%A2%E3%83%87%E3%83%AB%E3%83%BBMCMC-%E7%A2%BA%E7%8E%87%E3%81%A8%E6%83%85%E5%A0%B1%E3%81%AE%E7%A7%91%E5%AD%A6-%E4%B9%85%E4%BF%9D-%E6%8B%93%E5%BC%A5/dp/400006973X/ref=sr_1_1?ie=UTF8&qid=1449449812&sr=8-1&keywords=%E4%B9%85%E4%BF%9D+%E7%B5%B1%E8%A8%88)\n- [pdf: MCMC\u3068\u968e\u5c64\u30d9\u30a4\u30ba\u30e2\u30c7\u30eb](http://hosho.ees.hokudai.ac.jp/~kubo/stat/2014/nicoFeb/kubo2014nicoFeb.pdf)\n- [video: Why Bayesian Nonparametrics?](http://videolectures.net/nipsworkshops2011_ghahramani_nonparametrics/)\n- [video: Gaussian Process Basics](http://videolectures.net/gpip06_mackay_gpb/)\n", "tags": ["\u6a5f\u68b0\u5b66\u7fd2", "MachineLearning", "R", "\u30c7\u30fc\u30bf\u5206\u6790"]}