{"context": " More than 1 year has passed since last update.\nGoodpatch Advent Calendar 5\u65e5\u76ee\u306e\u6295\u7a3f\u3067\u3059\u3002\n\u3053\u3093\u306b\u3061\u306f\u3002@hi6484\u3067\u3059\u3002\nGoodpatch\u3067\u65e5\u3005Android\u30a2\u30d7\u30ea\u3092\u4f5c\u3063\u3066\u307e\u3059\u3002\n\u4eca\u5e74\u5ea6\u3001Android\u30a2\u30d7\u30ea\u3092\u4f5c\u3063\u3066\u3044\u3066\u30cf\u30de\u3063\u305f\u30dd\u30a4\u30f3\u30c8\u3067\u3059\u3002\nWebView\u3068\u304b\u3067\u8f9b\u3044\u601d\u3044\u3092\u3059\u308b\u306e\u306f\u5acc\u306a\u3093\u3067\u3001\n\u5b9f\u88c5\u3092\u8ae6\u3081\u3088\u3046\u304b\u3068\u304a\u3082\u3063\u305f\u306e\u3067\u3059\u304c\u3001\u306a\u3093\u3084\u304b\u3093\u3084\u3067\u5b9f\u88c5\u3067\u304d\u307e\u3057\u305f\u3002\n\u5b9f\u88c5\u3067\u304d\u305f\u305f\u3081\u3001Advent Calendar\u306b\u3082\u53c2\u52a0\u3067\u304d\u308b\u5e78\u305b\u3082\u306e\u3067\u3059\u3002\n\n\u8981\u4ef6\n\u3068\u3042\u308b \u30a6\u30a7\u30d6\u30da\u30fc\u30b8\u306e\u753b\u50cf\u3092\u8868\u793a\u3055\u305b\u308b\uff08\u7c21\u5358\u306b\u3044\u3046\u3068Interstitial\u5e83\u544a\uff09\n\u5e83\u544aSDK\u306f\u3042\u308b\u3093\u3067\u3059\u304c\u3001interstitial\u672a\u5bfe\u5fdc\u306a\u305f\u3081\u3001\u30a2\u30d7\u30ea\u5074\u3067\u5b9f\u88c5\u3002\n\u753b\u50cf\u30b5\u30a4\u30ba\u306f\u53ef\u5909\u3002\u3082\u3061\u308d\u3093JS\u3067\u52d5\u304f\niOS\u5074\u3067\u306f\u65e2\u306b\u5b9f\u88c5\u6e08\u307f\u3067\u3001\u753b\u50cf\u30b5\u30a4\u30ba\u3092\u53d6\u5f97\u3059\u308b\u306e\u306f\u4e0b\u8a18\u306e\u3088\u3046\u306a\u611f\u3058\u3002\nCGSize contentSize = CGSizeMake([[webView\n        stringByEvaluatingJavaScriptFromString:\n        @\"document.body.scrollWidth;\"] floatValue],\n        [[webView stringByEvaluatingJavaScriptFromString:\n        @\"document.body.scrollHeight;\"] floatValue]);\n\n\nAndroid\nAndroid\u3067\u3069\u3046\u3084\u308b\u306e\u304b\u3002\nAndroid4.4(Kitkat)\u4ee5\u4e0a\u306b\u5bfe\u5fdc\u3057\u3066\u304a\u308a\u307e\u3059\u3002\n\u305d\u308c\u4ee5\u4e0b\u306e\u5b9f\u88c5\u65b9\u6cd5\u3092\u77e5\u3063\u3066\u3044\u308b\u65b9\u304c\u3044\u307e\u3057\u305f\u3089\u6559\u3048\u3066\u304f\u3060\u3055\u3044\u3002\nXML\n<?xml version=\"1.0\" encoding=\"utf-8\"?>\n<FrameLayout\n    xmlns:android=\"http://schemas.android.com/apk/res/android\"\n    android:id=\"@+id/interstitial_view\"\n    android:orientation=\"vertical\"\n    android:layout_width=\"match_parent\"\n    android:layout_height=\"match_parent\"\n    android:clickable=\"true\"\n    android:background=\"#B2000000\"\n    >\n    <WebView\n        android:id=\"@+id/web_view\"\n        android:layout_width=\"0dip\"\n        android:layout_height=\"wrap_content\"\n        android:layout_gravity=\"center\"\n        />\n</FrameLayout>\n\n\u3053\u3053\u3067\u91cd\u8981\u306a\u306e\u306fandroid:layout_width=\"0dip\"\u3068\u306a\u308a\u307e\u3059\u3002\n\u3053\u3053\u3092wrap_content\u3084match_parent\u3068\u6307\u5b9a\u3057\u3066\u304a\u304f\u3068\u3001\n\u753b\u9762\u30b5\u30a4\u30ba\u3088\u308a\u5c0f\u3055\u3044\u753b\u50cf\u306e\u5834\u5408\u306f\u753b\u9762\u306e\u6a2a\u5e45\u304c\u53d6\u5f97\u3055\u308c\u307e\u3059\u3002\nJAVA\n    private void loadWebView() {\n        WebSettings webSettings = mWebView.getSettings();\n        webSettings.setJavaScriptEnabled(true);\n        mWebView.setWebViewClient(new SampleWebViewClient());\n        String url = \"http://wwww.hogehoge.com/image\";\n        mWebView.loadUrl(url);\n    }\n\n    private class SampleWebViewClient extends WebViewClient {\n        @Override\n        public void onPageFinished(WebView view, String url) {\n            super.onPageFinished(view, url);\n            if(Build.VERSION.SDK_INT >= Build.VERSION_CODES.KITKAT) {\n                // \u4f59\u767d\u3092\u6d88\u3059.\n                mWebView.evaluateJavascript(\n\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\"javascript:document.body.style.margin='0';\",\n                       null);\n\n                // \u9ad8\u3055\u3092\u53d6\u5f97.\n                String heightScript =\n                        \"javascript:document.body.scrollHeight;\";\n                mWebView.evaluateJavascript(heightScript,\n                        new ValueCallback<String>()\n                        {\n                            @Override\n                            public void onReceiveValue(String value) {\n                                mHeight = Integer.valueOf(value);\n                            }\n                        });\n                // \u5e45\u3092\u53d6\u5f97.\n                String widthScript =\n                        \"javascript:document.body.scrollWidth;\";\n                mWebView.evaluateJavascript(widthScript,\n                        new ValueCallback<String>()\n                        {\n                            @Override\n                            public void onReceiveValue(String value) {\n                                mWidth = Integer.valueOf(value);\n                            }\n                        });\n\n            }\n        }\n    }\n\n\nAndroid4.4\u3088\u308a\u8ffd\u52a0\u3055\u308c\u305f\u3001WebView.evaluateJavascript(String script, ValueCallback resultCallback)\u306b\u3001\nscript\u3092\u6e21\u3057\u3066\u3001\u7d50\u679c\u3092callback\u3067\u53d7\u3051\u53d6\u308b\u3060\u3051\u3002\n\u660e\u65e5\u306fGoodpatch\u306eiOS\u30a8\u30f3\u30b8\u30cb\u30a2 @eedawa \u304c\u82f1\u8a9e\uff1f\u3067iOS\u306e\u4e8b\u3092\u66f8\u3044\u3066\u304f\u308c\u307e\u3059\u3002\n\u304a\u697d\u3057\u307f\u306b\uff01\uff01\uff01\n![advent_calender_5.png](https://qiita-image-store.s3.amazonaws.com/0/58514/8bd6f461-9867-f889-0539-a6eb144fdb7c.png)\n\nGoodpatch Advent Calendar 5\u65e5\u76ee\u306e\u6295\u7a3f\u3067\u3059\u3002\n\u3053\u3093\u306b\u3061\u306f\u3002[@hi6484](https://twitter.com/hi6484)\u3067\u3059\u3002\nGoodpatch\u3067\u65e5\u3005Android\u30a2\u30d7\u30ea\u3092\u4f5c\u3063\u3066\u307e\u3059\u3002\n\n\u4eca\u5e74\u5ea6\u3001Android\u30a2\u30d7\u30ea\u3092\u4f5c\u3063\u3066\u3044\u3066\u30cf\u30de\u3063\u305f\u30dd\u30a4\u30f3\u30c8\u3067\u3059\u3002\nWebView\u3068\u304b\u3067\u8f9b\u3044\u601d\u3044\u3092\u3059\u308b\u306e\u306f\u5acc\u306a\u3093\u3067\u3001\n\u5b9f\u88c5\u3092\u8ae6\u3081\u3088\u3046\u304b\u3068\u304a\u3082\u3063\u305f\u306e\u3067\u3059\u304c\u3001\u306a\u3093\u3084\u304b\u3093\u3084\u3067\u5b9f\u88c5\u3067\u304d\u307e\u3057\u305f\u3002\n\u5b9f\u88c5\u3067\u304d\u305f\u305f\u3081\u3001Advent Calendar\u306b\u3082\u53c2\u52a0\u3067\u304d\u308b\u5e78\u305b\u3082\u306e\u3067\u3059\u3002\n\n#\u8981\u4ef6\n\u3068\u3042\u308b \u30a6\u30a7\u30d6\u30da\u30fc\u30b8\u306e\u753b\u50cf\u3092\u8868\u793a\u3055\u305b\u308b\uff08\u7c21\u5358\u306b\u3044\u3046\u3068Interstitial\u5e83\u544a\uff09\n\u5e83\u544aSDK\u306f\u3042\u308b\u3093\u3067\u3059\u304c\u3001interstitial\u672a\u5bfe\u5fdc\u306a\u305f\u3081\u3001\u30a2\u30d7\u30ea\u5074\u3067\u5b9f\u88c5\u3002\n\u753b\u50cf\u30b5\u30a4\u30ba\u306f\u53ef\u5909\u3002\u3082\u3061\u308d\u3093JS\u3067\u52d5\u304f\n\niOS\u5074\u3067\u306f\u65e2\u306b\u5b9f\u88c5\u6e08\u307f\u3067\u3001\u753b\u50cf\u30b5\u30a4\u30ba\u3092\u53d6\u5f97\u3059\u308b\u306e\u306f\u4e0b\u8a18\u306e\u3088\u3046\u306a\u611f\u3058\u3002\n\n```objc\nCGSize contentSize = CGSizeMake([[webView\n        stringByEvaluatingJavaScriptFromString:\n        @\"document.body.scrollWidth;\"] floatValue],\n        [[webView stringByEvaluatingJavaScriptFromString:\n        @\"document.body.scrollHeight;\"] floatValue]);\n```\n\n#Android\nAndroid\u3067\u3069\u3046\u3084\u308b\u306e\u304b\u3002\nAndroid4.4(Kitkat)\u4ee5\u4e0a\u306b\u5bfe\u5fdc\u3057\u3066\u304a\u308a\u307e\u3059\u3002\n\u305d\u308c\u4ee5\u4e0b\u306e\u5b9f\u88c5\u65b9\u6cd5\u3092\u77e5\u3063\u3066\u3044\u308b\u65b9\u304c\u3044\u307e\u3057\u305f\u3089\u6559\u3048\u3066\u304f\u3060\u3055\u3044\u3002\n\n\nXML\n\n```xml\n<?xml version=\"1.0\" encoding=\"utf-8\"?>\n<FrameLayout\n    xmlns:android=\"http://schemas.android.com/apk/res/android\"\n    android:id=\"@+id/interstitial_view\"\n    android:orientation=\"vertical\"\n    android:layout_width=\"match_parent\"\n    android:layout_height=\"match_parent\"\n    android:clickable=\"true\"\n    android:background=\"#B2000000\"\n    >\n    <WebView\n        android:id=\"@+id/web_view\"\n        android:layout_width=\"0dip\"\n        android:layout_height=\"wrap_content\"\n        android:layout_gravity=\"center\"\n        />\n</FrameLayout>\n```\n\u3053\u3053\u3067\u91cd\u8981\u306a\u306e\u306f**android:layout_width=\"0dip\"**\u3068\u306a\u308a\u307e\u3059\u3002\n\u3053\u3053\u3092wrap_content\u3084match_parent\u3068\u6307\u5b9a\u3057\u3066\u304a\u304f\u3068\u3001\n\u753b\u9762\u30b5\u30a4\u30ba\u3088\u308a\u5c0f\u3055\u3044\u753b\u50cf\u306e\u5834\u5408\u306f\u753b\u9762\u306e\u6a2a\u5e45\u304c\u53d6\u5f97\u3055\u308c\u307e\u3059\u3002\n\nJAVA\n\n```java\n    private void loadWebView() {\n        WebSettings webSettings = mWebView.getSettings();\n        webSettings.setJavaScriptEnabled(true);\n        mWebView.setWebViewClient(new SampleWebViewClient());\n        String url = \"http://wwww.hogehoge.com/image\";\n        mWebView.loadUrl(url);\n    }\n\n    private class SampleWebViewClient extends WebViewClient {\n        @Override\n        public void onPageFinished(WebView view, String url) {\n            super.onPageFinished(view, url);\n            if(Build.VERSION.SDK_INT >= Build.VERSION_CODES.KITKAT) {\n                // \u4f59\u767d\u3092\u6d88\u3059.\n                mWebView.evaluateJavascript(\n\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\"javascript:document.body.style.margin='0';\",\n                       null);\n\n                // \u9ad8\u3055\u3092\u53d6\u5f97.\n                String heightScript =\n                        \"javascript:document.body.scrollHeight;\";\n                mWebView.evaluateJavascript(heightScript,\n                        new ValueCallback<String>()\n                        {\n                            @Override\n                            public void onReceiveValue(String value) {\n                                mHeight = Integer.valueOf(value);\n                            }\n                        });\n                // \u5e45\u3092\u53d6\u5f97.\n                String widthScript =\n                        \"javascript:document.body.scrollWidth;\";\n                mWebView.evaluateJavascript(widthScript,\n                        new ValueCallback<String>()\n                        {\n                            @Override\n                            public void onReceiveValue(String value) {\n                                mWidth = Integer.valueOf(value);\n                            }\n                        });\n\n            }\n        }\n    }\n\n```\nAndroid4.4\u3088\u308a\u8ffd\u52a0\u3055\u308c\u305f\u3001[WebView.evaluateJavascript(String script, ValueCallback<String> resultCallback)]\n(http://developer.android.com/intl/ja/reference/android/webkit/WebView.html#evaluateJavascript(java.lang.String, android.webkit.ValueCallback<java.lang.String>))\u306b\u3001\nscript\u3092\u6e21\u3057\u3066\u3001\u7d50\u679c\u3092callback\u3067\u53d7\u3051\u53d6\u308b\u3060\u3051\u3002\n\n\u660e\u65e5\u306fGoodpatch\u306eiOS\u30a8\u30f3\u30b8\u30cb\u30a2 @eedawa \u304c\u82f1\u8a9e\uff1f\u3067iOS\u306e\u4e8b\u3092\u66f8\u3044\u3066\u304f\u308c\u307e\u3059\u3002\n\u304a\u697d\u3057\u307f\u306b\uff01\uff01\uff01\n\n\n", "tags": ["Android", "webView"]}