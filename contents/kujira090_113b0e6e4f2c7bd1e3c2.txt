{"context": "\n\n\u524d\u56de\u307e\u3067\u306e\u307e\u3068\u3081\n\u30fb\u305d\u306e\uff11\n\u30fb\u305d\u306e\uff12\n\u30fb\u305d\u306e\uff13\n\u524d\u56de\u307e\u3067\u306e\u4f5c\u696d\u3067PPS\u30e2\u30b8\u30e5\u30fc\u30eb\u306e\u5b9f\u9a13\u307e\u3067\u3067\u304d\u3066\u3044\u308b\u3068\u601d\u3044\u307e\u3059\u3002\n\n\u5bb9\u91cf\u4e0d\u8db3\u306b\u306a\u308b\u306e\u3067\u3001\u30a4\u30e1\u30fc\u30b8\u30d5\u30a1\u30a4\u30eb\u3092\u5e83\u3052\u308b\n\u30a4\u30e1\u30fc\u30b8\u30d5\u30a1\u30a4\u30eb\u3092\u5927\u304d\u304f\u3059\u308b\u3068dd\u3067SD\u30ab\u30fc\u30c9\u306b\u66f8\u304d\u8fbc\u3080\u6642\u9593\u3082\u6bd4\u4f8b\u3057\u3066\u9577\u304f\u306a\u308b\u305f\u3081\u3001\u4eca\u307e\u3067\u907f\u3051\u3066\u6765\u3066\u307e\u3057\u305f\u3002\u3057\u304b\u3057\u30c6\u30b9\u30c8\u3057\u3066\u307f\u305f\u3068\u3053\u308d\u4e88\u60f3\u4ee5\u4e0a\u306b\u5bb9\u91cf\u3092\u4f7f\u3044100%\u306b\u306a\u3063\u3066\u3057\u307e\u3063\u305f\u305f\u3081\u3001\u3053\u3053\u3044\u3089\u3067\u8ae6\u3081\u3066\u30a4\u30e1\u30fc\u30b8\u30d5\u30a1\u30a4\u30eb\u306e\u5bb9\u91cf\u3092\u5897\u3084\u3057\u307e\u3059\u3002\n\n/dev/zero\n\u30a4\u30e1\u30fc\u30b8\u30d5\u30a1\u30a4\u30eb\u3092\u30de\u30a6\u30f3\u30c8\u3057\u3066\u305f\u308a\u3059\u308b\u5834\u5408\u306f\u89e3\u9664\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\u30fb/dev/zero\u3067\u62e1\u5f35\u3059\u308b\u3002\n\uff08parted\u3067\u6700\u521d\u306eprint\u3092\u5b9f\u884c\u3057\u5fd8\u308c\u3066\u3001\u5f8c\u304b\u3089\u8ffd\u8a18\u3057\u307e\u3057\u305f\uff09\n$ cd ~/\n$ dd bs=1M if=/dev/zero count=512 >> 2017-02-16-raspbian-jessie-lite.img\n$ sudo losetup -f -P --show ./2017-02-16-raspbian-jessie-lite.img \n/dev/loop0\n$ sudo parted /dev/loop0\n(parted) print \n(parted) rm 2  \n(parted) print \nModel: Loopback device (loopback)\nDisk /dev/loop0: 1974MB\nSector size (logical/physical): 512B/512B\nPartition Table: msdos\nDisk Flags: \n\nNumber  Start   End     Size    Type     File system  Flags\n 1      4194kB  70.3MB  66.1MB  primary  fat32        lba\n\n(parted) mkpart primary 70.3 1974\n(parted) print                                                            \nModel: Loopback device (loopback)\nDisk /dev/loop0: 1974MB\nSector size (logical/physical): 512B/512B\nPartition Table: msdos\nDisk Flags: \n\nNumber  Start   End     Size    Type     File system  Flags\n 1      4194kB  70.3MB  66.1MB  primary  fat32        lba\n 2      70.3MB  1974MB  1904MB  primary               lba\n\n(parted) quit \n\n$ sudo e2fsck -f /dev/loop0p2 \n$ sudo resize2fs /dev/loop0p2 \n$ sudo sh ./rpi-imgmount.sh \n/dev/loop0\n$ df -h |grep loop0\n/dev/loop0p2    1.8G  1.4G  296M  83% /home/parallels/rpi_mnt\n/dev/loop0p1     63M   30M   33M  48% /home/parallels/rpi_mnt/boot\n\n\u5168\u3066\u4f5c\u696d\u3092\u7d42\u3048\u305f\u74b0\u5883\u3067df\u3092\u5b9f\u884c\u3057\u3066\u3044\u308b\u305f\u3081\u3001\u5bb9\u91cf\u306f\u591a\u5c11\u9055\u3046\u306f\u305a\u3067\u3059\u3002\n\nntp\u3092QEMU\u3067\u30b3\u30f3\u30d1\u30a4\u30eb\u3057\u3066deb\u30d1\u30c3\u30b1\u30fc\u30b8\u306b\u307e\u3068\u3081\u308b\ndeb\u30d1\u30c3\u30b1\u30fc\u30b8\u306e\u307e\u307e\u6271\u3044\u305f\u3044\u306e\u3067\u3001\u3053\u3093\u306a\u6d41\u308c\u3067\u9032\u3081\u307e\u3059\u3002\n\u30fbntp\u30d1\u30c3\u30b1\u30fc\u30b8\u306e\u30b3\u30f3\u30d1\u30a4\u30eb\u306b\u5fc5\u8981\u306a\u30c4\u30fc\u30eb\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\u30fbdeb\u30d1\u30c3\u30b1\u30fc\u30b8\u3092\u6271\u3046\u30c4\u30fc\u30eb\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\u30fbdeb\u30d1\u30c3\u30b1\u30fc\u30b8\u30c4\u30fc\u30eb\u3067\u30b3\u30f3\u30d1\u30a4\u30eb\n(3/12\u8ffd\u8a18\u30e1\u30e2)\nHow to run parallel make with debuild?\nhttp://askubuntu.com/questions/337093/how-to-run-parallel-make-with-debuild\n(\u30e1\u30e2\u3053\u3053\u307e\u3067)\n$ cd ~/rpi_mnt\n$ sudo chroot . bin/bash\n# su - pi\n$ sudo apt-get build-dep ntp\n$ sudo apt-get install devscripts\n\n\nntp\u306e\u30bd\u30fc\u30b9\u30d1\u30c3\u30b1\u30fc\u30b8\u3092\u62fe\u3063\u3066\u304f\u308b\n$ cd ~/\n$ mkdir ntp-build\n$ cd ntp-build\n$ apt-get source ntp\n$ ls\nntp-4.2.6.p5+dfsg                         ntp_4.2.6.p5+dfsg-7+deb8u2.dsc\nntp_4.2.6.p5+dfsg-7+deb8u2.debian.tar.xz  ntp_4.2.6.p5+dfsg.orig.tar.gz\n\n\nntp\u30d1\u30c3\u30b1\u30fc\u30b8\u306e\u30b3\u30f3\u30d1\u30a4\u30eb\u30aa\u30d7\u30b7\u30e7\u30f3\u3092\u5909\u66f4\n\u4f5c\u696d\u306e\u6d41\u308c\u306f\u3053\u3093\u306a\u611f\u3058\u3067\u3059\u3002\n\u30fbchange log\u3092\u66f8\u304f\n\u30d1\u30c3\u30b1\u30fc\u30b8\u306e\u5909\u66f4\u5185\u5bb9\u30e1\u30e2\u3092\u8a18\u8ff0\u3057\u307e\u3059\n\u30fbPPS\u306b\u5bfe\u5fdc\u3059\u308b\u305f\u3081\u306bdebian/rules\u306e26\u884c\u76ee\u3042\u305f\u308a\u306b --enable-linuxcaps \\ --enable-ATOM \\\u3092\u8ffd\u52a0\u3057\u307e\u3059\n\u30fbdeb\u30d1\u30c3\u30b1\u30fc\u30b8\u30c4\u30fc\u30eb\u3067\u30b3\u30f3\u30d1\u30a4\u30eb\u3059\u308b\n\u306a\u304a\u4ed6\u306e\u30d1\u30c3\u30b1\u30fc\u30b8\u3067\u3082\u5927\u4f53\u306e\u3082\u306e\u306f./configure --help\u3067\u3001\u3069\u3093\u306a\u30aa\u30d7\u30b7\u30e7\u30f3\u304c\u3042\u308b\u306e\u304b\u78ba\u8a8d\u3067\u304d\u307e\u3059\u3002\u53c2\u8003\u307e\u3067\u306b\u3002\n$ cd ~/ntp-build/ntp-4.2.6.p5+dfsg/\n$ debchange -i\n\n\nSelect an editor.  To change later, run 'select-editor'.\n  1. /bin/ed\n  2. /bin/nano        <---- easiest\n  3. /usr/bin/vim.basic\n  4. /usr/bin/vim.tiny\n\nChoose 1-4 [2]: 3 \n  * --enable-linuxcaps \n  * --enable-ATOM \n\n$ ./configure --help\n$ vi debian/rules\n--enable-linuxcaps \\\n--enable-ATOM \\\n\n$ debuild -us -uc\n$ ls ../\nntp-4.2.6.p5+dfsg\nntp_4.2.6.p5+dfsg-7+deb8u2.1_armhf.build\nntp_4.2.6.p5+dfsg-7+deb8u2.1_armhf.changes\nntp_4.2.6.p5+dfsg-7+deb8u2.1_armhf.deb\nntp_4.2.6.p5+dfsg-7+deb8u2.1.debian.tar.xz\nntp_4.2.6.p5+dfsg-7+deb8u2.1.dsc\nntp_4.2.6.p5+dfsg-7+deb8u2.debian.tar.xz\nntp_4.2.6.p5+dfsg-7+deb8u2.dsc\nntp_4.2.6.p5+dfsg.orig.tar.gz\nntpdate_4.2.6.p5+dfsg-7+deb8u2.1_armhf.deb\nntp-doc_4.2.6.p5+dfsg-7+deb8u2.1_all.deb\n$ cd ~/\n\n\n\u30d1\u30c3\u30b1\u30fc\u30b8\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n$ cd ~/ntp-build\n$ ls\n$ sudo dpkg -i ntp_4.2.6.p5+dfsg-7+deb8u2.1_armhf.deb \n\n\n\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3092\u5909\u66f4\nrestrict\u306e\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306f\u3001\u81ea\u5206\u306e\u74b0\u5883\u306b\u5408\u308f\u305b\u3066\u304f\u3060\u3055\u3044\u3002\n$ sudo vi /etc/ntp.conf\n\n#server 0.debian.pool.ntp.org iburst\n#server 1.debian.pool.ntp.org iburst\n#server 2.debian.pool.ntp.org iburst\n#server 3.debian.pool.ntp.org iburst\n\nserver 127.127.28.0 minpoll 4 maxpoll 4\nfudge 127.127.28.0 refid GPS stratum 15\n\nserver 127.127.22.0 minpoll 4 maxpoll 4\nfudge 127.127.22.0 flag3 1 refid PPS\nserver ntp.nict.jp iburst prefer\n\nrestrict 192.168.1.0 mask 255.255.255.0 nomodify notrap\n\n\n\u305d\u306e\u4ed6\u30d1\u30c3\u30b1\u30fc\u30b8\u3092\u5165\u308c\u308b\nmunin\u3068\u304bnginx\u3068\u304b\u304a\u597d\u307f\u3067\u3002\n$ sudo apt-get install munin nginx\n\n\nsshd\u3092\u6709\u52b9\u306b\u3059\u308b\n\u7a7a\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u3063\u3066\u304a\u304f\u3068\u6709\u52b9\u306b\u306a\u308a\u307e\u3059\u3002\nhttp://www.raspi.jp/2016/12/raspbian-2016-11-25-release/\n$ sudo touch /boot/ssh\n\n\nWiFi\u306e\u8a2d\u5b9a\u3082\u5165\u308c\u3066\u304a\u304f\nPi3\u3068\u304bzero W\u3068\u304b\u306fWifi\u306e\u6697\u53f7\u5316\u30ad\u30fc\u3084\u3001Wifi Location\u306e\u8a2d\u5b9a\u3092\u3042\u3089\u304b\u3058\u3081\u5165\u308c\u3066\u304a\u304f\u3068\u3001\u6700\u521d\u304b\u3089\u30d8\u30c3\u30c9\u30ec\u30b9\u3067\u4f7f\u3048\u308b\u306e\u3067\u4fbf\u5229\u3060\u3068\u601d\u3044\u307e\u3059\u3002\n\n$ sudo su\n# wpa_passphrase MySSID MyPassPhrase >> /etc/wpa_supplicant/wpa_supplicant.conf\n# exit\n\n\n\nchroot\u3092\u7d42\u4e86\n$ exit\n# exit\n\n$ cd ~/\n$ sudo sh ~/rpi-imgumount.sh\n\n\n\u30d0\u30c3\u30af\u30a2\u30c3\u30d7\u3068Pi\u713c\u304d\n/dev/sdb=SD\u30ab\u30fc\u30c9\n$ cd ~/\n$ cp 2017-02-16-raspbian-jessie-lite.img 2017-02-16-raspbian-jessie-lite_4.9PPS_tool_ntp.img\n$ sudo bs=1M if=~/2017-02-16-raspbian-jessie-lite_4.9.img of=/dev/sdb\n\n\nRaspberryPi\u3067\u52d5\u4f5c\u78ba\u8a8d\n\u53d7\u4fe1\u72b6\u614b\u306f\u60aa\u3044\u307f\u305f\u3044\u3060\u3051\u3069\u4e00\u5fdc\u306f\u53d7\u4fe1\u3057\u3066\u308b\u6a21\u69d8\u3002\n\n$ ntpq -p\n     remote           refid      st t when poll reach   delay   offset  jitter\n==============================================================================\n SHM(0)          .GPS.           15 l    -   16    0    0.000    0.000   0.000\nxPPS(0)          .PPS.            0 l    4   16  377    0.000   -7.263   0.730\nxntp-a2.nict.go. .NICT.           1 u   39   64  377   18.385   -4.306   1.218\n\npi@raspberrypi:~ $ ntpq -c rv\nassocid=0 status=0018 leap_none, sync_unspec, 1 event, no_sys_peer,\nversion=\"ntpd 4.2.6p5@1.2349-o Fri Mar  3 15:59:56 UTC 2017 (1)\",\nprocessor=\"armv6l\", system=\"Linux/4.9.12+\", leap=00, stratum=1,\nprecision=-20, rootdelay=0.000, rootdisp=9.320, refid=PPS,\nreftime=dc654a1b.b9c8ed82  Sat, Mar  4 2017 23:13:47.725,\nclock=dc654b02.80b999fe  Sat, Mar  4 2017 23:17:38.502, peer=0, tc=4,\nmintc=3, offset=-5.893, frequency=-0.051, sys_jitter=0.426,\nclk_jitter=1.178, clk_wander=0.018\n\n\n$ sudo su\n# echo \"performance\" > /sys/devices/system/cpu/cpu0/cpufreq/scaling_governor\n# apt-get install setserial\n# setserial /dev/ttyAMA0 low_latency\n# reboot\n$ ntpq -p\n$ ntpq -c rv\n\n\nPC\u306a\u3069\u304b\u3089\u78ba\u8a8d\u3059\u308b\nPC\u306e\u8a2d\u5b9a\u3092\u5909\u66f4\u3057\u3066RaspberryPi\u306eNTP\u3067\u5408\u308f\u305b\u308b\u3088\u3046\u306b\u5909\u66f4\u3002\n\nwindows\n\nMacOS\n\n\u78ba\u8a8d\nhttps://www.nict.go.jp/JST/JST5.html\n\n\u305b\u3063\u304b\u304f\u306a\u306e\u3067\u96fb\u6ce2\u6642\u8a08\u306e\u4fee\u6b63\u306b\u4f7f\u3063\u3066\u307f\u308b\n\u30e9\u30ba\u30d1\u30a4\u3067\u96fb\u6ce2\u3092\u9001\u308a\u96fb\u6ce2\u6642\u8a08\u3092\u5408\u308f\u305b\u3088\u3046\nhttp://itpro.nikkeibp.co.jp/pc/atcl/knowhow/15/010600003/\n\u8a18\u4e8b\u4e2d\u306e\u30d7\u30ed\u30b0\u30e9\u30e0\u3067\u5fc5\u8981\u306a\u30e9\u30a4\u30d6\u30e9\u30ea\u3092\u7528\u610f\u3059\u308b\u3002\n$ cd ~/\n$ wget http://www.airspayce.com/mikem/bcm2835/bcm2835-1.52.tar.gz\n$ tar xzvf bcm2835-1.52.tar.gz\n$ cd bcm2835-1.52/\n$ ./configure\n$ make\n$ sudo make check\n$ sudo make install\n\n\n\u304a\u308f\u308a\n\uff08\u6642\u9593\u304c\u8db3\u308a\u306a\u3044\u305f\u3081\u3001\u5f8c\u65e5\u30c6\u30b9\u30c8\u3059\u308b\uff09\n#\u524d\u56de\u307e\u3067\u306e\u307e\u3068\u3081\n\u30fb[\u305d\u306e\uff11](http://qiita.com/kujira090/items/7ae5a13dceb3867de095)\n\u30fb[\u305d\u306e\uff12](http://qiita.com/kujira090/items/79f304bdfe8f6443235c)\n\u30fb[\u305d\u306e\uff13](http://qiita.com/kujira090/items/a030007f4cd295ea67bd)\n\u524d\u56de\u307e\u3067\u306e\u4f5c\u696d\u3067PPS\u30e2\u30b8\u30e5\u30fc\u30eb\u306e\u5b9f\u9a13\u307e\u3067\u3067\u304d\u3066\u3044\u308b\u3068\u601d\u3044\u307e\u3059\u3002\n\n#\u5bb9\u91cf\u4e0d\u8db3\u306b\u306a\u308b\u306e\u3067\u3001\u30a4\u30e1\u30fc\u30b8\u30d5\u30a1\u30a4\u30eb\u3092\u5e83\u3052\u308b\n\u30a4\u30e1\u30fc\u30b8\u30d5\u30a1\u30a4\u30eb\u3092\u5927\u304d\u304f\u3059\u308b\u3068dd\u3067SD\u30ab\u30fc\u30c9\u306b\u66f8\u304d\u8fbc\u3080\u6642\u9593\u3082\u6bd4\u4f8b\u3057\u3066\u9577\u304f\u306a\u308b\u305f\u3081\u3001\u4eca\u307e\u3067\u907f\u3051\u3066\u6765\u3066\u307e\u3057\u305f\u3002\u3057\u304b\u3057\u30c6\u30b9\u30c8\u3057\u3066\u307f\u305f\u3068\u3053\u308d\u4e88\u60f3\u4ee5\u4e0a\u306b\u5bb9\u91cf\u3092\u4f7f\u3044100%\u306b\u306a\u3063\u3066\u3057\u307e\u3063\u305f\u305f\u3081\u3001\u3053\u3053\u3044\u3089\u3067\u8ae6\u3081\u3066\u30a4\u30e1\u30fc\u30b8\u30d5\u30a1\u30a4\u30eb\u306e\u5bb9\u91cf\u3092\u5897\u3084\u3057\u307e\u3059\u3002\n\n##/dev/zero\n\u30a4\u30e1\u30fc\u30b8\u30d5\u30a1\u30a4\u30eb\u3092\u30de\u30a6\u30f3\u30c8\u3057\u3066\u305f\u308a\u3059\u308b\u5834\u5408\u306f\u89e3\u9664\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\u30fb/dev/zero\u3067\u62e1\u5f35\u3059\u308b\u3002\n\uff08parted\u3067\u6700\u521d\u306eprint\u3092\u5b9f\u884c\u3057\u5fd8\u308c\u3066\u3001\u5f8c\u304b\u3089\u8ffd\u8a18\u3057\u307e\u3057\u305f\uff09\n\n```bash\n$ cd ~/\n$ dd bs=1M if=/dev/zero count=512 >> 2017-02-16-raspbian-jessie-lite.img\n$ sudo losetup -f -P --show ./2017-02-16-raspbian-jessie-lite.img \n/dev/loop0\n$ sudo parted /dev/loop0\n(parted) print \n(parted) rm 2  \n(parted) print \nModel: Loopback device (loopback)\nDisk /dev/loop0: 1974MB\nSector size (logical/physical): 512B/512B\nPartition Table: msdos\nDisk Flags: \n\nNumber  Start   End     Size    Type     File system  Flags\n 1      4194kB  70.3MB  66.1MB  primary  fat32        lba\n\n(parted) mkpart primary 70.3 1974\n(parted) print                                                            \nModel: Loopback device (loopback)\nDisk /dev/loop0: 1974MB\nSector size (logical/physical): 512B/512B\nPartition Table: msdos\nDisk Flags: \n\nNumber  Start   End     Size    Type     File system  Flags\n 1      4194kB  70.3MB  66.1MB  primary  fat32        lba\n 2      70.3MB  1974MB  1904MB  primary               lba\n\n(parted) quit \n\n$ sudo e2fsck -f /dev/loop0p2 \n$ sudo resize2fs /dev/loop0p2 \n$ sudo sh ./rpi-imgmount.sh \n/dev/loop0\n$ df -h |grep loop0\n/dev/loop0p2    1.8G  1.4G  296M  83% /home/parallels/rpi_mnt\n/dev/loop0p1     63M   30M   33M  48% /home/parallels/rpi_mnt/boot\n```\n\u5168\u3066\u4f5c\u696d\u3092\u7d42\u3048\u305f\u74b0\u5883\u3067df\u3092\u5b9f\u884c\u3057\u3066\u3044\u308b\u305f\u3081\u3001\u5bb9\u91cf\u306f\u591a\u5c11\u9055\u3046\u306f\u305a\u3067\u3059\u3002\n\n#ntp\u3092QEMU\u3067\u30b3\u30f3\u30d1\u30a4\u30eb\u3057\u3066deb\u30d1\u30c3\u30b1\u30fc\u30b8\u306b\u307e\u3068\u3081\u308b\ndeb\u30d1\u30c3\u30b1\u30fc\u30b8\u306e\u307e\u307e\u6271\u3044\u305f\u3044\u306e\u3067\u3001\u3053\u3093\u306a\u6d41\u308c\u3067\u9032\u3081\u307e\u3059\u3002\n\u30fbntp\u30d1\u30c3\u30b1\u30fc\u30b8\u306e\u30b3\u30f3\u30d1\u30a4\u30eb\u306b\u5fc5\u8981\u306a\u30c4\u30fc\u30eb\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\u30fbdeb\u30d1\u30c3\u30b1\u30fc\u30b8\u3092\u6271\u3046\u30c4\u30fc\u30eb\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\u30fbdeb\u30d1\u30c3\u30b1\u30fc\u30b8\u30c4\u30fc\u30eb\u3067\u30b3\u30f3\u30d1\u30a4\u30eb\n\n(3/12\u8ffd\u8a18\u30e1\u30e2)\nHow to run parallel make with debuild?\nhttp://askubuntu.com/questions/337093/how-to-run-parallel-make-with-debuild\n(\u30e1\u30e2\u3053\u3053\u307e\u3067)\n\n```bash\n$ cd ~/rpi_mnt\n$ sudo chroot . bin/bash\n# su - pi\n$ sudo apt-get build-dep ntp\n$ sudo apt-get install devscripts\n```\n\n##ntp\u306e\u30bd\u30fc\u30b9\u30d1\u30c3\u30b1\u30fc\u30b8\u3092\u62fe\u3063\u3066\u304f\u308b\n\n```bash\n$ cd ~/\n$ mkdir ntp-build\n$ cd ntp-build\n$ apt-get source ntp\n$ ls\nntp-4.2.6.p5+dfsg                         ntp_4.2.6.p5+dfsg-7+deb8u2.dsc\nntp_4.2.6.p5+dfsg-7+deb8u2.debian.tar.xz  ntp_4.2.6.p5+dfsg.orig.tar.gz\n```\n\n\n##ntp\u30d1\u30c3\u30b1\u30fc\u30b8\u306e\u30b3\u30f3\u30d1\u30a4\u30eb\u30aa\u30d7\u30b7\u30e7\u30f3\u3092\u5909\u66f4\n\u4f5c\u696d\u306e\u6d41\u308c\u306f\u3053\u3093\u306a\u611f\u3058\u3067\u3059\u3002\n\u30fbchange log\u3092\u66f8\u304f\n\u30d1\u30c3\u30b1\u30fc\u30b8\u306e\u5909\u66f4\u5185\u5bb9\u30e1\u30e2\u3092\u8a18\u8ff0\u3057\u307e\u3059\n\u30fbPPS\u306b\u5bfe\u5fdc\u3059\u308b\u305f\u3081\u306bdebian/rules\u306e26\u884c\u76ee\u3042\u305f\u308a\u306b --enable-linuxcaps \\ --enable-ATOM \\\u3092\u8ffd\u52a0\u3057\u307e\u3059\n\u30fbdeb\u30d1\u30c3\u30b1\u30fc\u30b8\u30c4\u30fc\u30eb\u3067\u30b3\u30f3\u30d1\u30a4\u30eb\u3059\u308b\n\n\u306a\u304a\u4ed6\u306e\u30d1\u30c3\u30b1\u30fc\u30b8\u3067\u3082\u5927\u4f53\u306e\u3082\u306e\u306f./configure --help\u3067\u3001\u3069\u3093\u306a\u30aa\u30d7\u30b7\u30e7\u30f3\u304c\u3042\u308b\u306e\u304b\u78ba\u8a8d\u3067\u304d\u307e\u3059\u3002\u53c2\u8003\u307e\u3067\u306b\u3002\n\n```bash\n$ cd ~/ntp-build/ntp-4.2.6.p5+dfsg/\n$ debchange -i\n\n\nSelect an editor.  To change later, run 'select-editor'.\n  1. /bin/ed\n  2. /bin/nano        <---- easiest\n  3. /usr/bin/vim.basic\n  4. /usr/bin/vim.tiny\n\nChoose 1-4 [2]: 3 \n  * --enable-linuxcaps \n  * --enable-ATOM \n\n$ ./configure --help\n$ vi debian/rules\n--enable-linuxcaps \\\n--enable-ATOM \\\n\n$ debuild -us -uc\n$ ls ../\nntp-4.2.6.p5+dfsg\nntp_4.2.6.p5+dfsg-7+deb8u2.1_armhf.build\nntp_4.2.6.p5+dfsg-7+deb8u2.1_armhf.changes\nntp_4.2.6.p5+dfsg-7+deb8u2.1_armhf.deb\nntp_4.2.6.p5+dfsg-7+deb8u2.1.debian.tar.xz\nntp_4.2.6.p5+dfsg-7+deb8u2.1.dsc\nntp_4.2.6.p5+dfsg-7+deb8u2.debian.tar.xz\nntp_4.2.6.p5+dfsg-7+deb8u2.dsc\nntp_4.2.6.p5+dfsg.orig.tar.gz\nntpdate_4.2.6.p5+dfsg-7+deb8u2.1_armhf.deb\nntp-doc_4.2.6.p5+dfsg-7+deb8u2.1_all.deb\n$ cd ~/\n```\n\n#\u30d1\u30c3\u30b1\u30fc\u30b8\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n```bash\n$ cd ~/ntp-build\n$ ls\n$ sudo dpkg -i ntp_4.2.6.p5+dfsg-7+deb8u2.1_armhf.deb \n```\n\n#\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3092\u5909\u66f4\nrestrict\u306e\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306f\u3001\u81ea\u5206\u306e\u74b0\u5883\u306b\u5408\u308f\u305b\u3066\u304f\u3060\u3055\u3044\u3002\n\n```bash\n$ sudo vi /etc/ntp.conf\n\n#server 0.debian.pool.ntp.org iburst\n#server 1.debian.pool.ntp.org iburst\n#server 2.debian.pool.ntp.org iburst\n#server 3.debian.pool.ntp.org iburst\n\nserver 127.127.28.0 minpoll 4 maxpoll 4\nfudge 127.127.28.0 refid GPS stratum 15\n\nserver 127.127.22.0 minpoll 4 maxpoll 4\nfudge 127.127.22.0 flag3 1 refid PPS\nserver ntp.nict.jp iburst prefer\n\nrestrict 192.168.1.0 mask 255.255.255.0 nomodify notrap\n```\n\n#\u305d\u306e\u4ed6\u30d1\u30c3\u30b1\u30fc\u30b8\u3092\u5165\u308c\u308b\nmunin\u3068\u304bnginx\u3068\u304b\u304a\u597d\u307f\u3067\u3002\n\n```bash\n$ sudo apt-get install munin nginx\n```\n\n#sshd\u3092\u6709\u52b9\u306b\u3059\u308b\n\u7a7a\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u3063\u3066\u304a\u304f\u3068\u6709\u52b9\u306b\u306a\u308a\u307e\u3059\u3002\nhttp://www.raspi.jp/2016/12/raspbian-2016-11-25-release/\n\n```bash\n$ sudo touch /boot/ssh\n```\n\n#WiFi\u306e\u8a2d\u5b9a\u3082\u5165\u308c\u3066\u304a\u304f\nPi3\u3068\u304bzero W\u3068\u304b\u306fWifi\u306e\u6697\u53f7\u5316\u30ad\u30fc\u3084\u3001Wifi Location\u306e\u8a2d\u5b9a\u3092\u3042\u3089\u304b\u3058\u3081\u5165\u308c\u3066\u304a\u304f\u3068\u3001\u6700\u521d\u304b\u3089\u30d8\u30c3\u30c9\u30ec\u30b9\u3067\u4f7f\u3048\u308b\u306e\u3067\u4fbf\u5229\u3060\u3068\u601d\u3044\u307e\u3059\u3002\n\n```bash\n\n$ sudo su\n# wpa_passphrase MySSID MyPassPhrase >> /etc/wpa_supplicant/wpa_supplicant.conf\n# exit\n\n```\n\n#chroot\u3092\u7d42\u4e86\n```bash\n$ exit\n# exit\n```\n\n```bash\n$ cd ~/\n$ sudo sh ~/rpi-imgumount.sh\n```\n\n#\u30d0\u30c3\u30af\u30a2\u30c3\u30d7\u3068Pi\u713c\u304d\n/dev/sdb=SD\u30ab\u30fc\u30c9\n\n```bash\n$ cd ~/\n$ cp 2017-02-16-raspbian-jessie-lite.img 2017-02-16-raspbian-jessie-lite_4.9PPS_tool_ntp.img\n$ sudo bs=1M if=~/2017-02-16-raspbian-jessie-lite_4.9.img of=/dev/sdb\n```\n\n#RaspberryPi\u3067\u52d5\u4f5c\u78ba\u8a8d\n\n\u53d7\u4fe1\u72b6\u614b\u306f\u60aa\u3044\u307f\u305f\u3044\u3060\u3051\u3069\u4e00\u5fdc\u306f\u53d7\u4fe1\u3057\u3066\u308b\u6a21\u69d8\u3002\n\n```bash\n\n$ ntpq -p\n     remote           refid      st t when poll reach   delay   offset  jitter\n==============================================================================\n SHM(0)          .GPS.           15 l    -   16    0    0.000    0.000   0.000\nxPPS(0)          .PPS.            0 l    4   16  377    0.000   -7.263   0.730\nxntp-a2.nict.go. .NICT.           1 u   39   64  377   18.385   -4.306   1.218\n\npi@raspberrypi:~ $ ntpq -c rv\nassocid=0 status=0018 leap_none, sync_unspec, 1 event, no_sys_peer,\nversion=\"ntpd 4.2.6p5@1.2349-o Fri Mar  3 15:59:56 UTC 2017 (1)\",\nprocessor=\"armv6l\", system=\"Linux/4.9.12+\", leap=00, stratum=1,\nprecision=-20, rootdelay=0.000, rootdisp=9.320, refid=PPS,\nreftime=dc654a1b.b9c8ed82  Sat, Mar  4 2017 23:13:47.725,\nclock=dc654b02.80b999fe  Sat, Mar  4 2017 23:17:38.502, peer=0, tc=4,\nmintc=3, offset=-5.893, frequency=-0.051, sys_jitter=0.426,\nclk_jitter=1.178, clk_wander=0.018\n\n```\n\n```\n$ sudo su\n# echo \"performance\" > /sys/devices/system/cpu/cpu0/cpufreq/scaling_governor\n# apt-get install setserial\n# setserial /dev/ttyAMA0 low_latency\n# reboot\n$ ntpq -p\n$ ntpq -c rv\n```\n\n#PC\u306a\u3069\u304b\u3089\u78ba\u8a8d\u3059\u308b\nPC\u306e\u8a2d\u5b9a\u3092\u5909\u66f4\u3057\u3066RaspberryPi\u306eNTP\u3067\u5408\u308f\u305b\u308b\u3088\u3046\u306b\u5909\u66f4\u3002\n\n##windows\n##MacOS\n##\u78ba\u8a8d\nhttps://www.nict.go.jp/JST/JST5.html\n\n#\u305b\u3063\u304b\u304f\u306a\u306e\u3067\u96fb\u6ce2\u6642\u8a08\u306e\u4fee\u6b63\u306b\u4f7f\u3063\u3066\u307f\u308b\n\n\u30e9\u30ba\u30d1\u30a4\u3067\u96fb\u6ce2\u3092\u9001\u308a\u96fb\u6ce2\u6642\u8a08\u3092\u5408\u308f\u305b\u3088\u3046\nhttp://itpro.nikkeibp.co.jp/pc/atcl/knowhow/15/010600003/\n\n\u8a18\u4e8b\u4e2d\u306e\u30d7\u30ed\u30b0\u30e9\u30e0\u3067\u5fc5\u8981\u306a\u30e9\u30a4\u30d6\u30e9\u30ea\u3092\u7528\u610f\u3059\u308b\u3002\n\n```bash\n$ cd ~/\n$ wget http://www.airspayce.com/mikem/bcm2835/bcm2835-1.52.tar.gz\n$ tar xzvf bcm2835-1.52.tar.gz\n$ cd bcm2835-1.52/\n$ ./configure\n$ make\n$ sudo make check\n$ sudo make install\n```\n\n#\u304a\u308f\u308a\n\uff08\u6642\u9593\u304c\u8db3\u308a\u306a\u3044\u305f\u3081\u3001\u5f8c\u65e5\u30c6\u30b9\u30c8\u3059\u308b\uff09\n", "tags": ["RaspberryPi", "ntp", "QEMU"]}