{"context": "PHP \u3067 Excel \u306e\u30c7\u30fc\u30bf\u3092\u8aad\u307f\u66f8\u304d\u3059\u308b\u306e\u306f\u4e00\u7b4b\u7e04\u3067\u306f\u3044\u304d\u307e\u305b\u3093\u3002\u30b5\u30fc\u30c9\u30d1\u30fc\u30c6\u30a3\u30fc\u306e\u30e9\u30a4\u30d6\u30e9\u30ea\u3092\u5229\u7528\u3059\u308b\u306e\u304c\u4e00\u822c\u7684\u3067\u3059\u304c\u3001\u3053\u3053\u3067\u306f CData ODBC Driver for Excel \u3092\u5229\u7528\u3057\u3066\u3001ODBC \u7d4c\u7531\u3067 Excel \u30c7\u30fc\u30bf\u306b\u30a2\u30af\u30bb\u30b9\u3059\u308b\u65b9\u6cd5\u3092\u7c21\u5358\u306b\u7d39\u4ecb\u3057\u307e\u3059\u3002\n\nDNS\u3092\u69cb\u6210\nODBC\u306e\u30c7\u30fc\u30bf\u30bd\u30fc\u30b9\u3092\u8ffd\u52a0\u3057\u307e\u3059\u3002\nCData ODBC Driver for Excel- DNS\u69cb\u6210 \u3092\u8d77\u52d5\u3057\u3066\u3001\u30a2\u30af\u30bb\u30b9\u3059\u308bExcel\u30d5\u30a1\u30a4\u30eb\u306e\u30d1\u30b9\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n\n\u8aad\u307f\u8fbc\u3080 Excel \u306e\u5185\u5bb9\u306f\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u8868\u3067\u3059\u3002\n\n\n\u63a5\u7d9a\u3092\u78ba\u7acb\nodbc_connect \u307e\u305f\u306f odbc_pconnect \u95a2\u6570\u3092\u4f7f\u7528\u3057\u3066\u3001Excel\u3078\u306e\u63a5\u7d9a\u3092\u78ba\u7acb\u3057\u307e\u3059\u3002\u78ba\u7acb\u3057\u305f\u63a5\u7d9a\u3092\u9589\u3058\u308b\u306b\u306f\u3001odbc_close \u307e\u305f\u306f odbc_close_all \u95a2\u6570\u3092\u4f7f\u7528\u3057\u307e\u3059\u3002\n$conn = odbc_connect('CData Excel Source', '', '');\n// ...\u4f55\u304b\u306e\u51e6\u7406...\nodbc_close($conn);\n\n\n\u30d7\u30ea\u30da\u30a2\u30c9\u30b9\u30c6\u30fc\u30c8\u30e1\u30f3\u30c8\u3092\u4f5c\u6210\nodbc_prepare \u95a2\u6570\u3092\u4f7f\u7528\u3057\u3066\u3001\u30d7\u30ea\u30b3\u30f3\u30d1\u30a4\u30eb\u6e08\u307f\u306eSQL\u6587\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u751f\u6210\u3057\u307e\u3059\u3002\n$pstmt = odbc_prepare($conn, 'SELECT * FROM Temp');\n\n\n\u30af\u30a8\u30ea\u3092\u5b9f\u884c\nodbc_execute \u95a2\u6570\u3092\u4f7f\u7528\u3057\u3066\u3001SQL\u6587\u3092\u5b9f\u884c\u3057\u307e\u3059\u3002\n$success = odbc_execute($pstmt);\n\n\n\u7d50\u679c\u30bb\u30c3\u30c8\u3092\u53d6\u5f97\nodbc_fetch_array \u95a2\u6570\u3092\u4f7f\u7528\u3057\u3066\u3001SQL\u6587\u306e\u7d50\u679c\u30bb\u30c3\u30c8\u3092\u53d6\u5f97\u3057\u307e\u3059\u3002\nwhile ($row = odbc_fetch_array($pstmt)) {\n    print_r($row). \"\\n\";\n}\n\n\n\n\u7d50\u679c\u306f\u4e0a\u56f3\u306e\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\n\u3053\u308c\u306f\u3054\u304f\u3054\u304f\u7c21\u5358\u306a\u4f8b\u3067\u3059\u304c\u3001\u3053\u306e\u3088\u3046\u306b\u3001ODBC \u7d4c\u7531\u3067\u7c21\u5358\u306b PHP \u304b\u3089 Excel \u30c7\u30fc\u30bf\u306b\u30a2\u30af\u30bb\u30b9\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\nPHP \u3067 Excel \u306e\u30c7\u30fc\u30bf\u3092\u8aad\u307f\u66f8\u304d\u3059\u308b\u306e\u306f\u4e00\u7b4b\u7e04\u3067\u306f\u3044\u304d\u307e\u305b\u3093\u3002\u30b5\u30fc\u30c9\u30d1\u30fc\u30c6\u30a3\u30fc\u306e\u30e9\u30a4\u30d6\u30e9\u30ea\u3092\u5229\u7528\u3059\u308b\u306e\u304c\u4e00\u822c\u7684\u3067\u3059\u304c\u3001\u3053\u3053\u3067\u306f [CData ODBC Driver for Excel](http://www.cdata.com/jp/drivers/excel/download/odbc/) \u3092\u5229\u7528\u3057\u3066\u3001ODBC \u7d4c\u7531\u3067 Excel \u30c7\u30fc\u30bf\u306b\u30a2\u30af\u30bb\u30b9\u3059\u308b\u65b9\u6cd5\u3092\u7c21\u5358\u306b\u7d39\u4ecb\u3057\u307e\u3059\u3002\n\n#DNS\u3092\u69cb\u6210\nODBC\u306e\u30c7\u30fc\u30bf\u30bd\u30fc\u30b9\u3092\u8ffd\u52a0\u3057\u307e\u3059\u3002\nCData ODBC Driver for Excel- DNS\u69cb\u6210 \u3092\u8d77\u52d5\u3057\u3066\u3001\u30a2\u30af\u30bb\u30b9\u3059\u308bExcel\u30d5\u30a1\u30a4\u30eb\u306e\u30d1\u30b9\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n\n![fig5_01.png](https://qiita-image-store.s3.amazonaws.com/0/141193/97033463-bd70-0c27-402b-090821507c61.png)\n\n\u8aad\u307f\u8fbc\u3080 Excel \u306e\u5185\u5bb9\u306f\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u8868\u3067\u3059\u3002\n\n![fig5_02.png](https://qiita-image-store.s3.amazonaws.com/0/141193/d9035870-795e-aa64-c959-ea47d44ec4e0.png)\n\n\n#\u63a5\u7d9a\u3092\u78ba\u7acb\nodbc_connect \u307e\u305f\u306f odbc_pconnect \u95a2\u6570\u3092\u4f7f\u7528\u3057\u3066\u3001Excel\u3078\u306e\u63a5\u7d9a\u3092\u78ba\u7acb\u3057\u307e\u3059\u3002\u78ba\u7acb\u3057\u305f\u63a5\u7d9a\u3092\u9589\u3058\u308b\u306b\u306f\u3001odbc_close \u307e\u305f\u306f odbc_close_all \u95a2\u6570\u3092\u4f7f\u7528\u3057\u307e\u3059\u3002\n\n```php\n$conn = odbc_connect('CData Excel Source', '', '');\n// ...\u4f55\u304b\u306e\u51e6\u7406...\nodbc_close($conn);\n```\n\n#\u30d7\u30ea\u30da\u30a2\u30c9\u30b9\u30c6\u30fc\u30c8\u30e1\u30f3\u30c8\u3092\u4f5c\u6210\nodbc_prepare \u95a2\u6570\u3092\u4f7f\u7528\u3057\u3066\u3001\u30d7\u30ea\u30b3\u30f3\u30d1\u30a4\u30eb\u6e08\u307f\u306eSQL\u6587\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u751f\u6210\u3057\u307e\u3059\u3002\n\n```php\n$pstmt = odbc_prepare($conn, 'SELECT * FROM Temp');\n```\n#\u30af\u30a8\u30ea\u3092\u5b9f\u884c\nodbc_execute \u95a2\u6570\u3092\u4f7f\u7528\u3057\u3066\u3001SQL\u6587\u3092\u5b9f\u884c\u3057\u307e\u3059\u3002\n\n```php\n$success = odbc_execute($pstmt);\n```\n\n#\u7d50\u679c\u30bb\u30c3\u30c8\u3092\u53d6\u5f97\nodbc_fetch_array \u95a2\u6570\u3092\u4f7f\u7528\u3057\u3066\u3001SQL\u6587\u306e\u7d50\u679c\u30bb\u30c3\u30c8\u3092\u53d6\u5f97\u3057\u307e\u3059\u3002\n\n```php\nwhile ($row = odbc_fetch_array($pstmt)) {\n\tprint_r($row). \"\\n\";\n}\n```\n\n![fig5_03.png](https://qiita-image-store.s3.amazonaws.com/0/141193/d515db5a-624e-fff8-bdd7-fda0b94ce030.png)\n![fig5_04.png](https://qiita-image-store.s3.amazonaws.com/0/141193/2b00782e-4a0b-c604-c6ab-d1b2d7725778.png)\n\n\n\u7d50\u679c\u306f\u4e0a\u56f3\u306e\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\n\u3053\u308c\u306f\u3054\u304f\u3054\u304f\u7c21\u5358\u306a\u4f8b\u3067\u3059\u304c\u3001\u3053\u306e\u3088\u3046\u306b\u3001ODBC \u7d4c\u7531\u3067\u7c21\u5358\u306b PHP \u304b\u3089 Excel \u30c7\u30fc\u30bf\u306b\u30a2\u30af\u30bb\u30b9\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n", "tags": ["CData", "PHP", "Excel"]}