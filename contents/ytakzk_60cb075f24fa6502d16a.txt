{"context": " More than 1 year has passed since last update.Meteor\u3067\u4f5c\u6210\u3057\u305f\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u81ea\u5206\u306e\u30b5\u30fc\u30d0\u306b\u30c7\u30d7\u30ed\u30a4\u3057\u305f\u304c\u3001Ubuntu\u306b\u5bfe\u3059\u308b\u30c7\u30d7\u30ed\u30a4\u60c5\u5831\u306f\u30cd\u30c3\u30c8\u306b\u3042\u3063\u305f\u3082\u306e\u306eCentOS\u306b\u30c7\u30d7\u30ed\u30a4\u3059\u308b\u65b9\u6cd5\u304c\u307b\u3068\u3093\u3069\u306a\u304b\u3063\u305f\u306e\u3067\u30b7\u30a7\u30a2\u3057\u3066\u307f\u308b\u3002\n80\u756a\u30dd\u30fc\u30c8\u306b\u306f\u65e2\u306bhttp-proxy\u3067apache\u3084node\u306e\u30b5\u30fc\u30d0\u306b\u30eb\u30fc\u30c6\u30a3\u30f3\u30b0\u3057\u3066\u3044\u308b\u306e\u3067\u3001http-proxy\u3067Meteor\u306e\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306b\u3082\u30eb\u30fc\u30c6\u30a3\u30f3\u30b0\u51fa\u6765\u308b\u3088\u3046\u306b\u3057\u305f\u3002\n\n\u74b0\u5883\n\u3055\u304f\u3089VPS CentOS 6.5 64bit\nMeteor 1.0\nNodeJS v0.10.29\nMongoDB v2.6.5\n\nMeteor\u306e\u30c7\u30d7\u30ed\u30a4\n\n\u30ed\u30fc\u30ab\u30eb\u3067\u306e\u4f5c\u696d\n\u958b\u767a\u74b0\u5883(mac\u3067\u3082\u306a\u3093\u3067\u3082)\u3067\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u304c\u51fa\u6765\u4e0a\u304c\u308b\u3068\u305d\u306emeteor\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092\u30d1\u30c3\u30b1\u30fc\u30b8\u5316\u3059\u308b\u3002\n\u306a\u304a\u3001\u3042\u3089\u304b\u3058\u3081CentOS\u306b\u306fMeteor\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u3066\u3044\u308b\u3082\u306e\u3068\u3059\u308b\u3002\n$ meteor build [\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u3042\u308b\u30d1\u30b9]\n\n\u3082\u3057\u304f\u306fmeteor\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306e\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u5185\u3067\n$ meteor build .\n\n\u3059\u308b\u3068\u4ee5\u4e0b\u306e\u30d5\u30a1\u30a4\u30eb\u304c\u51fa\u6765\u308b\u3002\n[\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u540d].tar.gz\n\n\u3053\u308c\u3092FTP\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u306a\u308a\u306a\u3093\u306a\u308a\u3067CentOS\u306e\u4efb\u610f\u306e\u5834\u6240\u306b\u30b3\u30d4\u30fc\u3059\u308b\u3002\n\n\u30ea\u30e2\u30fc\u30c8\n\u4eca\u56de\u306f\u4ee5\u4e0b\u306e\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u30b3\u30d4\u30fc\u3057\u305f\u306e\u3067\u3001\n/var/www/[\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u540d]/[\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u540d].tar.gz\n\n\u3053\u308c\u3092\u5c55\u958b\u3059\u308b\u3002\n$ tar -zxf [\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u540d].tar.gz\n\n\u3059\u308b\u3068\u3001bundle\u3068\u3044\u3046\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u304c\u3067\u304d\u308b\u306e\u3067\u3001\u6b21\u306e\u3088\u3046\u306b\u30d1\u30c3\u30b1\u30fc\u30b8\u3092\u3044\u304f\u3064\u304b\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\u3002\n\u3053\u306e\u969b\u3044\u304f\u3064\u304bwarning\u304c\u51fa\u308b\u304b\u3082\u3057\u308c\u306a\u3044\u304c\u3001\u3068\u308a\u3042\u3048\u305a\u652f\u969c\u306f\u306a\u3044\u306e\u3067\u653e\u7f6e\u3057\u3066\u304a\u304f\u3002\n$ cd bundle/programs/server\n$ npm install\n\n\u3053\u308c\u3067\u672c\u6765\u306f\u5b8c\u4e86\u306a\u306f\u305a\u306a\u306e\u3060\u304c\u3001bundle\u306b\u623b\u3063\u3066\u4ee5\u4e0b\u306e\u30b3\u30de\u30f3\u30c9\u3092\u6253\u3064\u3068\u30a8\u30e9\u30fc\u304c\u51fa\u3066\u304d\u3066\u3057\u307e\u3046\u3002\n$ node main.js\n\n/****/****/bundle/programs/server/node_modules/fibers/future.js:173\nthrow(ex);\n^\nError: /home/****/bundle/programs/server/npm/npm-bcrypt/node_modules/bcrypt/build/Release/bcrypt_lib.node: invalid ELF header\nat Module.load (module.js:356:32)\nat Function.Module._load (module.js:312:12)\nat Module.require (module.js:364:17)\nat require (module.js:380:17)\nat bindings (/home/****/bundle/programs/server/npm/npm-bcrypt/node_modules/bcrypt/node_modules/bindings/bindings.js:74:15)\nat Object.<anonymous> (/home/****/bundle/programs/server/npm/npm-bcrypt/node_modules/bcrypt/bcrypt.js:1:97)\nat Module._compile (module.js:456:26)\nat Object.Module._extensions..js (module.js:474:10)\nat Module.load (module.js:356:32)\nat Function.Module._load (module.js:312:12)\n\n\u3069\u3046\u3084\u3089mac\u3067\u306f\u6b63\u5e38\u306b\u52d5\u3044\u3066\u3044\u305f\u306f\u305a\u306ebcrypt\u304clinux\u3067\u306f\u306a\u305c\u304b\u4e0a\u624b\u304f\u52d5\u3044\u3066\u3044\u306a\u3044\u3088\u3046\u306a\u306e\u3067\u3001\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u76f4\u3057\u3066\u307f\u308b\u3002\n\u307e\u305f\u3001Meteor\u304cbcrypt\u3092bundle/programs/server/npm/npm-bcrypt/node_modules\u306b\u30b3\u30d4\u30fc\u3057\u3066\u3044\u308b\u307f\u305f\u3044\u306a\u306e\u3067\u3001\u305d\u308c\u3082\u4e0a\u66f8\u304d\u3059\u308b\u3002\n$ cd bundle/programs/server\n$ npm install bcrypt\n$ cp -r bundle/programs/server/node_modules/bcrypt bundle/programs/server/npm/npm-bcrypt/node_modules\n\n\u3053\u308c\u3067Meteor\u306b\u5bfe\u3059\u308b\u51e6\u7406\u306f\u7d42\u308f\u308a\u3002\nREADME\u5185\u306b\u3042\u308b\u30b3\u30de\u30f3\u30c9\u3092\u6253\u3064\u3068\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u304c\u7acb\u3061\u4e0a\u304c\u308b\u3002\n\uff11\u884c\u76ee\u306f\u5148\u306e\u4f5c\u696d\u3067\u7d42\u3048\u3066\u3044\u308b\u304b\u3089\u5fc5\u8981\u306a\u3044\u3002  \nMeteor\u306b\u306f\u74b0\u5883\u5909\u6570\u304c\u3044\u304f\u3064\u304b\u3042\u3063\u3066\u3001\nMONGO_URL\u3067mongo\u306e\u6307\u5b9a\u3001\nROOT_URL\u3067\u30db\u30b9\u30c8\u306e\u6307\u5b9a\u3001\nMAIL_URL\u3067\u30e1\u30fc\u30eb\u30b5\u30fc\u30d0\u306e\u6307\u5b9a\u306a\u3069\u304c\u51fa\u6765\u308b\u3002\nREADME\u306b\u306f\u306a\u3044\u304c\u3001POOT\u3067\u30dd\u30fc\u30c8\u306e\u6307\u5b9a\u3082\u53ef\u80fd\u3002\n$ (cd programs/server && npm install)\n$ export MONGO_URL='mongodb://user:password@host:port/databasename'\n$ export ROOT_URL='http://example.com'\n$ export MAIL_URL='smtp://user:password@mailhost:port/'\n$ node main.js\n\n\nMongo\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\u3053\u3053\u306fmongo\u306e\u516c\u5f0f\u30b5\u30a4\u30c8\u306b\u3042\u308b\u306e\u3067\u8aac\u660e\u306f\u7c21\u5358\u306b\u3002\n$ vi /etc/yum.repos.d/mongodb.repo\n\n\u3067\u4ee5\u4e0b\u3092\u8cbc\u308a\u4ed8\u3051\u3066\u3001\n[mongodb]\nname=MongoDB Repository\nbaseurl=http://downloads-distro.mongodb.org/repo/redhat/os/x86_64/\ngpgcheck=0\nenabled=1\n\n\u6b21\u306e\u30b3\u30de\u30f3\u30c9\u3067mongo\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3002\n$ sudo yum install -y mongodb-org\n\nmongo\u306eadmin\u3092\u8a2d\u5b9a\u3059\u308b\u306a\u3069\u3057\u3066\u304b\u3089\u30c7\u30fc\u30bf\u306e\u4fdd\u5b58\u5834\u6240\u3092\u78ba\u4fdd\u3059\u308b\u3002\n$ sudo mkdir /data/db_mongo (\u3053\u306e\u5834\u6240\u306f\u4efb\u610f)\n$ sudo chown 'mongod:mongod' /data/db_mongo\n\n\u4eca\u4f5c\u6210\u3057\u305fdb\u306e\u4fdd\u5b58\u5834\u6240\u3092\u793a\u3059\u30d1\u30b9\u3092\u6307\u5b9a\u3057\u3066\u3001mongo\u3092\u7acb\u3061\u4e0a\u3052\u308b\u3002\n$ mongod --dbpath /data/db_mongo\n\n\u3053\u3053\u3067\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u7528\u306eDB\u3092\u4f5c\u6210\u3057\u3001\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u4e0a\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306badmin\u30e6\u30fc\u30b6\u3092\u4f5c\u6210\u3059\u308b\u3002\n$ mongo\n\n$ db.createCollection(\"[\u30b3\u30ec\u30af\u30b7\u30e7\u30f3\u306e\u540d\u524d]\");\n$ use [\u30b3\u30ec\u30af\u30b7\u30e7\u30f3\u306e\u540d\u524d]\n$ db.createUser('[\u30e6\u30fc\u30b6\u540d]','[\u30d1\u30b9\u30ef\u30fc\u30c9]');\n\n\nhttp-proxy\u3067\u30eb\u30fc\u30c6\u30a3\u30f3\u30b0\n\u307e\u305a\u306fhost\u3068port\u306e\u6574\u7406\u3092\u3002\n\n\n\n\u30db\u30b9\u30c8\n\u30dd\u30fc\u30c8\n\u7528\u9014\n\n\n\n\nexample.com\n80\nhttp-proxy\u306b\u3088\u308b\u30d7\u30ed\u30ad\u30b7\u30b5\u30fc\u30d0\u30fc\n\n\n127.0.0.1(localhost)\n3100\nMeteor\u306e\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\n\n\n127.0.0.1(localhost)\n27017\nMongoDB\n\n\n\nhttp-proxy\u306e\u8aac\u660e\u306fhttp://qiita.com/ytakzk/items/e4422555549b069e3d90\n\u3053\u306e\u8fba\u3067\u8aac\u660e\u3057\u3066\u3044\u308b\u306e\u3067\u898b\u3066\u3044\u305f\u3060\u304f\u3068\u3057\u3066\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u8a2d\u5b9a\u3059\u308b\u3002\n\nproxy.js\nvar http = require('http');\nvar httpProxy = require('http-proxy');\n\n// apache\u306e\u30b5\u30fc\u30d0(\u5225\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u305f\u3081\u306b\u7acb\u3066\u3066\u3044\u308b)\nvar apacheProxy = new httpProxy.createProxyServer({\n    target: {\n    host: 'localhost',\n    port: 8081\n}});\n\n// ghost\u306e\u30b5\u30fc\u30d0(\u5225\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u305f\u3081\u306b\u7acb\u3066\u3066\u3044\u308b)\nvar ghostProxy = new httpProxy.createProxyServer({\n    target: {\n    host: 'localhost',\n    port: 6666\n}});\n\n// meteor\u306e\u30b5\u30fc\u30d0(\u4eca\u56de\u306b\u5fc5\u8981\u306a\u3082\u306e)\nvar meteorProxy = new httpProxy.createProxyServer({\n    target: {\n    host: '127.0.0.1',\n    port: 3100\n}});\n\n// \u30eb\u30fc\u30c6\u30a3\u30f3\u30b0\nvar server = http.createServer(function ( req, res ) {\n    var proxy;\n    if (req.headers.host == 'example1.com') {\n        proxy = apacheProxy.web( req, res );\n    } else if (req.headers.host == 'example2.com') {\n        proxy = ghostProxy.web( req, res );\n    } else if (req.headers.host == 'example.com') {\n        proxy = meteorProxy.web( req, res, function(err) {\n      console.log(err);\n    });\n    } else {\n        res.writeHead(404);\n        res.end();\n    }\n});\n\n// websocket\nserver.on( 'upgrade', function( req, socket, head ) {\n    meteorProxy.ws( req, socket, head );\n});\n\nserver.listen(80, function(){\n  process.setuid(500);\n});\nconsole.log('It Works!');\n\n\n\niptables\u306e\u8a2d\u5b9a\niptables\u306b\u30dd\u30fc\u30c83100\u3092\u8ffd\u52a0\u3059\u308b\u3002\n$ sudo vi  /etc/sysconfig/iptables\n\n\u4ee5\u4e0b\u306e\uff11\u884c\u3092\u8ffd\u52a0\n-A SERVICES -p tcp --dport 3100 -j ACCEPT\n\n\n\u6700\u7d42\u7684\u306a\u30c7\u30d7\u30ed\u30a4\nnpm\u3067forever\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u3066\u304a\u304f\u3002(\u5272\u611b)  \n\u307e\u305a\u306f\u30d7\u30ed\u30ad\u30b7\u30b5\u30fc\u30d0\u30fc\u3092\u8d77\u52d5\n$ sudo forever start proxy.js\n\nmongo\u3092\u30d0\u30c3\u30af\u30b0\u30e9\u30a6\u30f3\u30c9\u3067\u8d77\u52d5\n$ sudo mongod --fork --dbpath /data/db_mongo --logpath /var/log/mongodb/db.log\n\nmeteor\u306e\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u8d77\u52d5\n$ export MONGO_URL='mongodb://[\u5148\u306b\u4f5c\u6210\u3057\u305fdb\u306e\u30e6\u30fc\u30b6\u540d]:[\u5148\u306b\u4f5c\u6210\u3057\u305fdb\u306e\u30e6\u30d1\u30b9\u30ef\u30fc\u30c9]@127.0.0.1:27017/[\u30b3\u30ec\u30af\u30b7\u30e7\u30f3\u540d]'\n$ export ROOT_URL='http://127.0.0.1'\n$ export PORT=3100\n$ forever start main.js\n\n\n\u518d\u30c7\u30d7\u30ed\u30a4\u306e\u624b\u9806\n\u3053\u308c\u307e\u3067\u3068\u624b\u9806\u306f\u4e00\u7dd2\u3002\n\u958b\u767a\u74b0\u5883\u3067tar\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u3063\u3066\u540c\u3058\u4f5c\u696d\u3092\u7e70\u308a\u8fd4\u305b\u3070\u826f\u3044\u3002\n\u30d7\u30ed\u30ad\u30b7\u30b5\u30fc\u30d0\u30fc\u3084mongo\u306f\u3059\u3067\u306b\u7acb\u3063\u3066\u3044\u308b\u304b\u3089\u305d\u308c\u306f\u5fc5\u8981\u306a\u3044\u3051\u3069\u3002\n\u30b7\u30a7\u30eb\u3067\u4ee5\u4e0b\u3092\u8d70\u3089\u305b\u308c\u3070\u4e00\u767a\u3067\u518d\u30c7\u30d7\u30ed\u30a4\u7d42\u4e86\u3002\n$ tar -zxf [\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u540d].tar.gz\n$ (cd bundle/programs/server & npm install bcrypt)\n$ cp -r bundle/programs/server/node_modules/bcrypt bundle/programs/server/npm/npm-bcrypt/node_modules\n\n$ export MONGO_URL='mongodb://user:password@host:port/databasename'\n$ export ROOT_URL='http://example.com'\n$ export MAIL_URL='smtp://user:password@mailhost:port/'\n$ export MAIL_URL='smtp://postmaster%40wasabihunt.com:ebeeb40a2355e809ee691f817b4d3c81@smtp.mailgun.org:587'\n$ forever restart main.js\n\n\n\u5b9f\u969b\u306e\u30d7\u30ed\u30c0\u30af\u30c8\n\u5b9f\u969b\u306bMeteor\u3067\u4f5c\u3063\u305f\u30d7\u30ed\u30c0\u30af\u30c8\u304c\u3053\u3061\u3089\u3002\n\u3068\u3044\u3063\u3066\u3082\u307e\u3060\u03b2\u7248\u306b\u904e\u304e\u306a\u3044\u3051\u3069\u3082\u3002\nhttp://wasabihunt.com/\n\u4ee5\u4e0a\uff01\nMeteor\u3067\u4f5c\u6210\u3057\u305f\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u81ea\u5206\u306e\u30b5\u30fc\u30d0\u306b\u30c7\u30d7\u30ed\u30a4\u3057\u305f\u304c\u3001Ubuntu\u306b\u5bfe\u3059\u308b\u30c7\u30d7\u30ed\u30a4\u60c5\u5831\u306f\u30cd\u30c3\u30c8\u306b\u3042\u3063\u305f\u3082\u306e\u306eCentOS\u306b\u30c7\u30d7\u30ed\u30a4\u3059\u308b\u65b9\u6cd5\u304c\u307b\u3068\u3093\u3069\u306a\u304b\u3063\u305f\u306e\u3067\u30b7\u30a7\u30a2\u3057\u3066\u307f\u308b\u3002\n\n80\u756a\u30dd\u30fc\u30c8\u306b\u306f\u65e2\u306bhttp-proxy\u3067apache\u3084node\u306e\u30b5\u30fc\u30d0\u306b\u30eb\u30fc\u30c6\u30a3\u30f3\u30b0\u3057\u3066\u3044\u308b\u306e\u3067\u3001http-proxy\u3067Meteor\u306e\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306b\u3082\u30eb\u30fc\u30c6\u30a3\u30f3\u30b0\u51fa\u6765\u308b\u3088\u3046\u306b\u3057\u305f\u3002\n\n## \u74b0\u5883\n\u3055\u304f\u3089VPS CentOS 6.5 64bit\nMeteor 1.0\nNodeJS v0.10.29\nMongoDB v2.6.5\n\n## Meteor\u306e\u30c7\u30d7\u30ed\u30a4\n\n####\u30ed\u30fc\u30ab\u30eb\u3067\u306e\u4f5c\u696d\n\u958b\u767a\u74b0\u5883(mac\u3067\u3082\u306a\u3093\u3067\u3082)\u3067\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u304c\u51fa\u6765\u4e0a\u304c\u308b\u3068\u305d\u306emeteor\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092\u30d1\u30c3\u30b1\u30fc\u30b8\u5316\u3059\u308b\u3002\n\n\u306a\u304a\u3001\u3042\u3089\u304b\u3058\u3081CentOS\u306b\u306fMeteor\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u3066\u3044\u308b\u3082\u306e\u3068\u3059\u308b\u3002\n\n```\n$ meteor build [\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u3042\u308b\u30d1\u30b9]\n```\n\n\u3082\u3057\u304f\u306fmeteor\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306e\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u5185\u3067\n\n```\n$ meteor build .\n```\n\n\n\u3059\u308b\u3068\u4ee5\u4e0b\u306e\u30d5\u30a1\u30a4\u30eb\u304c\u51fa\u6765\u308b\u3002\n\n```\n[\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u540d].tar.gz\n```\n\n\n\u3053\u308c\u3092FTP\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u306a\u308a\u306a\u3093\u306a\u308a\u3067CentOS\u306e\u4efb\u610f\u306e\u5834\u6240\u306b\u30b3\u30d4\u30fc\u3059\u308b\u3002\n\n####\u30ea\u30e2\u30fc\u30c8\n\n\u4eca\u56de\u306f\u4ee5\u4e0b\u306e\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u30b3\u30d4\u30fc\u3057\u305f\u306e\u3067\u3001\n\n```\n/var/www/[\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u540d]/[\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u540d].tar.gz\n```\n\n\u3053\u308c\u3092\u5c55\u958b\u3059\u308b\u3002\n\n```\n$ tar -zxf [\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u540d].tar.gz\n```\n\n\u3059\u308b\u3068\u3001bundle\u3068\u3044\u3046\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u304c\u3067\u304d\u308b\u306e\u3067\u3001\u6b21\u306e\u3088\u3046\u306b\u30d1\u30c3\u30b1\u30fc\u30b8\u3092\u3044\u304f\u3064\u304b\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\u3002\n\u3053\u306e\u969b\u3044\u304f\u3064\u304bwarning\u304c\u51fa\u308b\u304b\u3082\u3057\u308c\u306a\u3044\u304c\u3001\u3068\u308a\u3042\u3048\u305a\u652f\u969c\u306f\u306a\u3044\u306e\u3067\u653e\u7f6e\u3057\u3066\u304a\u304f\u3002\n\n```\n$ cd bundle/programs/server\n$ npm install\n```\n\n\u3053\u308c\u3067\u672c\u6765\u306f\u5b8c\u4e86\u306a\u306f\u305a\u306a\u306e\u3060\u304c\u3001bundle\u306b\u623b\u3063\u3066\u4ee5\u4e0b\u306e\u30b3\u30de\u30f3\u30c9\u3092\u6253\u3064\u3068\u30a8\u30e9\u30fc\u304c\u51fa\u3066\u304d\u3066\u3057\u307e\u3046\u3002\n\n```\n$ node main.js\n```\n\n```\n/****/****/bundle/programs/server/node_modules/fibers/future.js:173\nthrow(ex);\n^\nError: /home/****/bundle/programs/server/npm/npm-bcrypt/node_modules/bcrypt/build/Release/bcrypt_lib.node: invalid ELF header\nat Module.load (module.js:356:32)\nat Function.Module._load (module.js:312:12)\nat Module.require (module.js:364:17)\nat require (module.js:380:17)\nat bindings (/home/****/bundle/programs/server/npm/npm-bcrypt/node_modules/bcrypt/node_modules/bindings/bindings.js:74:15)\nat Object.<anonymous> (/home/****/bundle/programs/server/npm/npm-bcrypt/node_modules/bcrypt/bcrypt.js:1:97)\nat Module._compile (module.js:456:26)\nat Object.Module._extensions..js (module.js:474:10)\nat Module.load (module.js:356:32)\nat Function.Module._load (module.js:312:12)\n```\n\n\u3069\u3046\u3084\u3089mac\u3067\u306f\u6b63\u5e38\u306b\u52d5\u3044\u3066\u3044\u305f\u306f\u305a\u306ebcrypt\u304clinux\u3067\u306f\u306a\u305c\u304b\u4e0a\u624b\u304f\u52d5\u3044\u3066\u3044\u306a\u3044\u3088\u3046\u306a\u306e\u3067\u3001\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u76f4\u3057\u3066\u307f\u308b\u3002\n\u307e\u305f\u3001Meteor\u304cbcrypt\u3092```bundle/programs/server/npm/npm-bcrypt/node_modules```\u306b\u30b3\u30d4\u30fc\u3057\u3066\u3044\u308b\u307f\u305f\u3044\u306a\u306e\u3067\u3001\u305d\u308c\u3082\u4e0a\u66f8\u304d\u3059\u308b\u3002\n\n```\n$ cd bundle/programs/server\n$ npm install bcrypt\n$ cp -r bundle/programs/server/node_modules/bcrypt bundle/programs/server/npm/npm-bcrypt/node_modules\n```\n\n\u3053\u308c\u3067Meteor\u306b\u5bfe\u3059\u308b\u51e6\u7406\u306f\u7d42\u308f\u308a\u3002\n\nREADME\u5185\u306b\u3042\u308b\u30b3\u30de\u30f3\u30c9\u3092\u6253\u3064\u3068\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u304c\u7acb\u3061\u4e0a\u304c\u308b\u3002\n\n\uff11\u884c\u76ee\u306f\u5148\u306e\u4f5c\u696d\u3067\u7d42\u3048\u3066\u3044\u308b\u304b\u3089\u5fc5\u8981\u306a\u3044\u3002  \n\nMeteor\u306b\u306f\u74b0\u5883\u5909\u6570\u304c\u3044\u304f\u3064\u304b\u3042\u3063\u3066\u3001\nMONGO_URL\u3067mongo\u306e\u6307\u5b9a\u3001\nROOT_URL\u3067\u30db\u30b9\u30c8\u306e\u6307\u5b9a\u3001\nMAIL_URL\u3067\u30e1\u30fc\u30eb\u30b5\u30fc\u30d0\u306e\u6307\u5b9a\u306a\u3069\u304c\u51fa\u6765\u308b\u3002\nREADME\u306b\u306f\u306a\u3044\u304c\u3001POOT\u3067\u30dd\u30fc\u30c8\u306e\u6307\u5b9a\u3082\u53ef\u80fd\u3002\n\n```\n$ (cd programs/server && npm install)\n$ export MONGO_URL='mongodb://user:password@host:port/databasename'\n$ export ROOT_URL='http://example.com'\n$ export MAIL_URL='smtp://user:password@mailhost:port/'\n$ node main.js\n```\n\n\n## Mongo\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n\u3053\u3053\u306fmongo\u306e\u516c\u5f0f\u30b5\u30a4\u30c8\u306b\u3042\u308b\u306e\u3067\u8aac\u660e\u306f\u7c21\u5358\u306b\u3002\n\n```\n$ vi /etc/yum.repos.d/mongodb.repo\n```\n\u3067\u4ee5\u4e0b\u3092\u8cbc\u308a\u4ed8\u3051\u3066\u3001\n\n```\n[mongodb]\nname=MongoDB Repository\nbaseurl=http://downloads-distro.mongodb.org/repo/redhat/os/x86_64/\ngpgcheck=0\nenabled=1\n```\n\n\u6b21\u306e\u30b3\u30de\u30f3\u30c9\u3067mongo\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3002\n\n```\n$ sudo yum install -y mongodb-org\n```\n\nmongo\u306eadmin\u3092\u8a2d\u5b9a\u3059\u308b\u306a\u3069\u3057\u3066\u304b\u3089\u30c7\u30fc\u30bf\u306e\u4fdd\u5b58\u5834\u6240\u3092\u78ba\u4fdd\u3059\u308b\u3002\n\n```\n$ sudo mkdir /data/db_mongo (\u3053\u306e\u5834\u6240\u306f\u4efb\u610f)\n$ sudo chown 'mongod:mongod' /data/db_mongo\n```\n\n\u4eca\u4f5c\u6210\u3057\u305fdb\u306e\u4fdd\u5b58\u5834\u6240\u3092\u793a\u3059\u30d1\u30b9\u3092\u6307\u5b9a\u3057\u3066\u3001mongo\u3092\u7acb\u3061\u4e0a\u3052\u308b\u3002\n\n```\n$ mongod --dbpath /data/db_mongo\n```\n\n\u3053\u3053\u3067\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u7528\u306eDB\u3092\u4f5c\u6210\u3057\u3001\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u4e0a\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306badmin\u30e6\u30fc\u30b6\u3092\u4f5c\u6210\u3059\u308b\u3002\n\n```\n$ mongo\n\n$ db.createCollection(\"[\u30b3\u30ec\u30af\u30b7\u30e7\u30f3\u306e\u540d\u524d]\");\n$ use [\u30b3\u30ec\u30af\u30b7\u30e7\u30f3\u306e\u540d\u524d]\n$ db.createUser('[\u30e6\u30fc\u30b6\u540d]','[\u30d1\u30b9\u30ef\u30fc\u30c9]');\n```\n\n## http-proxy\u3067\u30eb\u30fc\u30c6\u30a3\u30f3\u30b0\n\n\u307e\u305a\u306fhost\u3068port\u306e\u6574\u7406\u3092\u3002\n\n|        \u30db\u30b9\u30c8        | \u30dd\u30fc\u30c8 |\u7528\u9014|\n|:--------------------:|:------:|:--------------------------------:|\n|      example.com     |   80   | http-proxy\u306b\u3088\u308b\u30d7\u30ed\u30ad\u30b7\u30b5\u30fc\u30d0\u30fc |\n| 127.0.0.1(localhost) |  3100  |     Meteor\u306e\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3     |\n| 127.0.0.1(localhost) |  27017 |              MongoDB             |\n\nhttp-proxy\u306e\u8aac\u660e\u306fhttp://qiita.com/ytakzk/items/e4422555549b069e3d90\n\u3053\u306e\u8fba\u3067\u8aac\u660e\u3057\u3066\u3044\u308b\u306e\u3067\u898b\u3066\u3044\u305f\u3060\u304f\u3068\u3057\u3066\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u8a2d\u5b9a\u3059\u308b\u3002\n\n```js:proxy.js\nvar http = require('http');\nvar httpProxy = require('http-proxy');\n\n// apache\u306e\u30b5\u30fc\u30d0(\u5225\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u305f\u3081\u306b\u7acb\u3066\u3066\u3044\u308b)\nvar apacheProxy = new httpProxy.createProxyServer({\n    target: {\n    host: 'localhost',\n    port: 8081\n}});\n\n// ghost\u306e\u30b5\u30fc\u30d0(\u5225\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u305f\u3081\u306b\u7acb\u3066\u3066\u3044\u308b)\nvar ghostProxy = new httpProxy.createProxyServer({\n    target: {\n    host: 'localhost',\n    port: 6666\n}});\n\n// meteor\u306e\u30b5\u30fc\u30d0(\u4eca\u56de\u306b\u5fc5\u8981\u306a\u3082\u306e)\nvar meteorProxy = new httpProxy.createProxyServer({\n    target: {\n    host: '127.0.0.1',\n    port: 3100\n}});\n\n// \u30eb\u30fc\u30c6\u30a3\u30f3\u30b0\nvar server = http.createServer(function ( req, res ) {\n    var proxy;\n    if (req.headers.host == 'example1.com') {\n        proxy = apacheProxy.web( req, res );\n    } else if (req.headers.host == 'example2.com') {\n        proxy = ghostProxy.web( req, res );\n    } else if (req.headers.host == 'example.com') {\n        proxy = meteorProxy.web( req, res, function(err) {\n\t  console.log(err);\n\t});\n    } else {\n        res.writeHead(404);\n        res.end();\n    }\n});\n\n// websocket\nserver.on( 'upgrade', function( req, socket, head ) {\n    meteorProxy.ws( req, socket, head );\n});\n\nserver.listen(80, function(){\n  process.setuid(500);\n});\nconsole.log('It Works!');\n```\n\n## iptables\u306e\u8a2d\u5b9a\n\niptables\u306b\u30dd\u30fc\u30c83100\u3092\u8ffd\u52a0\u3059\u308b\u3002\n\n```\n$ sudo vi  /etc/sysconfig/iptables\n```\n\n\u4ee5\u4e0b\u306e\uff11\u884c\u3092\u8ffd\u52a0\n\n```\n-A SERVICES -p tcp --dport 3100 -j ACCEPT\n```\n\n## \u6700\u7d42\u7684\u306a\u30c7\u30d7\u30ed\u30a4\nnpm\u3067forever\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u3066\u304a\u304f\u3002(\u5272\u611b)  \n\n\u307e\u305a\u306f\u30d7\u30ed\u30ad\u30b7\u30b5\u30fc\u30d0\u30fc\u3092\u8d77\u52d5\n\n```\n$ sudo forever start proxy.js\n```\n\nmongo\u3092\u30d0\u30c3\u30af\u30b0\u30e9\u30a6\u30f3\u30c9\u3067\u8d77\u52d5\n\n```\n$ sudo mongod --fork --dbpath /data/db_mongo --logpath /var/log/mongodb/db.log\n```\n\nmeteor\u306e\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u8d77\u52d5\n\n```\n$ export MONGO_URL='mongodb://[\u5148\u306b\u4f5c\u6210\u3057\u305fdb\u306e\u30e6\u30fc\u30b6\u540d]:[\u5148\u306b\u4f5c\u6210\u3057\u305fdb\u306e\u30e6\u30d1\u30b9\u30ef\u30fc\u30c9]@127.0.0.1:27017/[\u30b3\u30ec\u30af\u30b7\u30e7\u30f3\u540d]'\n$ export ROOT_URL='http://127.0.0.1'\n$ export PORT=3100\n$ forever start main.js\n```\n\n## \u518d\u30c7\u30d7\u30ed\u30a4\u306e\u624b\u9806\n\u3053\u308c\u307e\u3067\u3068\u624b\u9806\u306f\u4e00\u7dd2\u3002\n\u958b\u767a\u74b0\u5883\u3067tar\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u3063\u3066\u540c\u3058\u4f5c\u696d\u3092\u7e70\u308a\u8fd4\u305b\u3070\u826f\u3044\u3002\n\u30d7\u30ed\u30ad\u30b7\u30b5\u30fc\u30d0\u30fc\u3084mongo\u306f\u3059\u3067\u306b\u7acb\u3063\u3066\u3044\u308b\u304b\u3089\u305d\u308c\u306f\u5fc5\u8981\u306a\u3044\u3051\u3069\u3002\n\u30b7\u30a7\u30eb\u3067\u4ee5\u4e0b\u3092\u8d70\u3089\u305b\u308c\u3070\u4e00\u767a\u3067\u518d\u30c7\u30d7\u30ed\u30a4\u7d42\u4e86\u3002\n\n```\n$ tar -zxf [\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u540d].tar.gz\n$ (cd bundle/programs/server & npm install bcrypt)\n$ cp -r bundle/programs/server/node_modules/bcrypt bundle/programs/server/npm/npm-bcrypt/node_modules\n\n$ export MONGO_URL='mongodb://user:password@host:port/databasename'\n$ export ROOT_URL='http://example.com'\n$ export MAIL_URL='smtp://user:password@mailhost:port/'\n$ export MAIL_URL='smtp://postmaster%40wasabihunt.com:ebeeb40a2355e809ee691f817b4d3c81@smtp.mailgun.org:587'\n$ forever restart main.js\n```\n\n## \u5b9f\u969b\u306e\u30d7\u30ed\u30c0\u30af\u30c8\n\u5b9f\u969b\u306bMeteor\u3067\u4f5c\u3063\u305f\u30d7\u30ed\u30c0\u30af\u30c8\u304c\u3053\u3061\u3089\u3002\n\u3068\u3044\u3063\u3066\u3082\u307e\u3060\u03b2\u7248\u306b\u904e\u304e\u306a\u3044\u3051\u3069\u3082\u3002\nhttp://wasabihunt.com/\n\n\u4ee5\u4e0a\uff01\n", "tags": ["Meteor1.0", "JavaScript", "Node.js0.10.29", "MongoDB2.6.5"]}