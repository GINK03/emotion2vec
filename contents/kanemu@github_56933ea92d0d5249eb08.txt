{"context": " More than 1 year has passed since last update.\u904e\u53bb\u30c7\u30fc\u30bf\u304b\u3089\u5f15\u304d\u7d99\u3044\u3067\u304d\u305f\u30c7\u30fc\u30bf\u3067\u3001\u672a\u3060\u306b\u62e1\u5f35\u5b50\u306e\u306a\u3044\u30ea\u30f3\u30af\u30d5\u30a1\u30a4\u30eb\u304c\u3042\u308b\u306e\u3067\u30c1\u30a7\u30c3\u30af\u3059\u308b\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u66f8\u3044\u305f\u3002\nInDesign CS5\u3001Mac OS X 10.8.5\u306b\u3066\u78ba\u8a8d\u3002\n(function(){\n    if(!app.documents.length) return;\n    checkExtention(app.activeDocument);\n}());\n\nfunction checkExtention(doc){\n    var grapics = doc.allGraphics;\n    var checkRegs = {\n        'adobe pdf':(/\\.(ai|pdf)$/i)\n       ,'tiff':(/\\.tiff?$/i)\n       ,'eps':(/\\.eps$/i)\n       ,'photoshop':(/\\.psd$/i)\n    };\n    var i = grapics.length;\n    var checkList = [];\n    while(i--){\n        var grapic = grapics[i];\n        var link = grapic.itemLink;\n        if(link && link.isValid){\n            var graphicType = grapic.imageTypeName.toLowerCase();\n            var checkReg = checkRegs[graphicType] || new RegExp('\\\\.'+graphicType+'$','i');\n            if(!checkReg.test(link.name)){\n                checkList.push('\u30d5\u30a1\u30a4\u30eb\u540d:'+link.name+', \u30bf\u30a4\u30d7:'+graphicType);\n            }\n        }\n    };\n    if(checkList.length){\n        alert('\u62e1\u5f35\u5b50\u306e\u306a\u3044\u30d5\u30a1\u30a4\u30eb\u304c' + checkList.length + '\u500b\u3042\u308a\u307e\u3059\\n'+checkList.join('\\n'));\n    }else{\n        alert('OK');\n    }\n}\n\n\u3053\u3053\u307e\u3067\u3067\u304d\u305f\u3089\u3001\u81ea\u52d5\u3067\u62e1\u5f35\u5b50\u3092\u3064\u3051\u3066\u30d5\u30a1\u30a4\u30eb\u3092\u30ea\u30f3\u30af\u3057\u76f4\u3057\u3066\u6b32\u3057\u3044\u3068\u601d\u3046\u3051\u3069\u3001\u3068\u308a\u3042\u3048\u305a\u4eca\u306f\u3053\u3053\u307e\u3067\u3002\n2014/05/07 \u8ffd\u8a18\n\u30ea\u30f3\u30af\u3092\u5909\u66f4\u3059\u308b\u3068\u3053\u308d\u307e\u3067\u66f8\u3044\u305f\u3002\nInDesign CS4\u4ee5\u964d\u3001Mac\u306e\u307f\u3067\u52d5\u4f5c\u3002\n2014/08/22\n\u30ea\u30f3\u30af\u304c\u7f6e\u304d\u63db\u308f\u3089\u306a\u3044\u90e8\u5206\u3092\u4fee\u6b63\u3002\n(function(){\n    if(!app.documents.length) return;\n    var doc = app.activeDocument;\n    var checkMap = checkExtention(app.activeDocument);\n    reLinkWithExtention(doc,checkMap);\n    alert('OK');\n}());\n\n/**\u30d5\u30a1\u30a4\u30eb\u3092\u62e1\u5f35\u5b50\u4ed8\u304d\u3067\u30ea\u30cd\u30fc\u30e0\u3057\u3066\u518d\u30ea\u30f3\u30af*/\nfunction reLinkWithExtention(doc,checkMap){\n    var exts = {\n        'adobe pdf':'.ai'\n       ,'tiff':'.tif'\n       ,'eps':'.eps'\n       ,'photoshop':'.psd'\n    };\n    for(var i in checkMap){\n        var graphics = checkMap[i];\n        var ext = exts[graphics[0].imageTypeName.toLowerCase()];\n        var linkPath = getPosixPath(i);\n        var count = 0;\n        for(;;){\n            var suffix = count? '_'+count: '';\n            var renamePath = linkPath+suffix+ext;\n            var renameFile = new File(linkPath+suffix+ext);\n            if(!renameFile.exists) break;\n            count++;\n        }\n        var linkFile = new File(linkPath);\n        if(linkFile.exists){\n            var linkName = linkPath.match(/[^\\/]+$/)[0];\n            var relinkName = linkName + suffix + ext;\n            $.writeln(linkName +' -> '+relinkName);\n            linkFile.rename(relinkName);\n            for(var g=0,glen=graphics.length;g<glen;g++){\n                graphics[g].itemLink.relink(linkFile);\n            }\n        }\n    }\n};\n\n/**\u62e1\u5f35\u5b50\u306e\u306a\u3044\u30ea\u30f3\u30af\u3092\u96c6\u3081\u308b*/\nfunction checkExtention(doc){\n    var grapics = doc.allGraphics;\n    var checkRegs = {\n        'adobe pdf':(/\\.(ai|pdf)$/i)\n       ,'tiff':(/\\.tiff?$/i)\n       ,'eps':(/\\.eps$/i)\n       ,'photoshop':(/\\.psd$/i)\n    };\n    var i = grapics.length;\n    var checkMap = {};\n    while(i--){\n        var grapic = grapics[i];\n        var link = grapic.itemLink;\n        if(link && link.isValid){\n            var graphicType = grapic.imageTypeName.toLowerCase();\n            var checkReg = checkRegs[graphicType] || new RegExp('\\\\.'+graphicType+'$','i');\n            var linkName = link.name;\n            if(!checkReg.test(linkName)){\n                var linkPath = link.filePath;\n                if(!checkMap[linkPath]){\n                    checkMap[linkPath] = [];\n                }\n                checkMap[linkPath].push(grapic);\n            }\n        }\n    };\n    return checkMap;\n};\n\n/**\u30ed\u30fc\u30ab\u30eb\u30d1\u30b9\u304b\u3089Posix\u30d1\u30b9\u3092\u5f97\u308b*/\nfunction getPosixPath(localPath) {\n    if (localPath && Folder.fs == \"Macintosh\") {\n        localPath = escapeAppleScript(localPath);\n        var posixPath = app.doScript('\"' + localPath + '\"\\'s POSIX path', ScriptLanguage.APPLESCRIPT_LANGUAGE);\n        return posixPath.replace(/<([0-9a-fA-F]{4})>/g, function(){\n            return String.fromCharCode(parseInt(\"0x\"+arguments[1]));\n        });\n    }\n    return false;\n};\n\n/**AppleScript\u7528\u306b\u30a8\u30b9\u30b1\u30fc\u30d7*/\nfunction escapeAppleScript(str) {\n    return str.replace(/(?=[\"\\\\])/g, '\\\\');\n};\n\n\n\u904e\u53bb\u30c7\u30fc\u30bf\u304b\u3089\u5f15\u304d\u7d99\u3044\u3067\u304d\u305f\u30c7\u30fc\u30bf\u3067\u3001\u672a\u3060\u306b\u62e1\u5f35\u5b50\u306e\u306a\u3044\u30ea\u30f3\u30af\u30d5\u30a1\u30a4\u30eb\u304c\u3042\u308b\u306e\u3067\u30c1\u30a7\u30c3\u30af\u3059\u308b\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u66f8\u3044\u305f\u3002\nInDesign CS5\u3001Mac OS X 10.8.5\u306b\u3066\u78ba\u8a8d\u3002\n\n```javascript:\n(function(){\n    if(!app.documents.length) return;\n    checkExtention(app.activeDocument);\n}());\n\nfunction checkExtention(doc){\n    var grapics = doc.allGraphics;\n    var checkRegs = {\n        'adobe pdf':(/\\.(ai|pdf)$/i)\n       ,'tiff':(/\\.tiff?$/i)\n       ,'eps':(/\\.eps$/i)\n       ,'photoshop':(/\\.psd$/i)\n    };\n    var i = grapics.length;\n    var checkList = [];\n    while(i--){\n        var grapic = grapics[i];\n        var link = grapic.itemLink;\n        if(link && link.isValid){\n            var graphicType = grapic.imageTypeName.toLowerCase();\n            var checkReg = checkRegs[graphicType] || new RegExp('\\\\.'+graphicType+'$','i');\n            if(!checkReg.test(link.name)){\n                checkList.push('\u30d5\u30a1\u30a4\u30eb\u540d:'+link.name+', \u30bf\u30a4\u30d7:'+graphicType);\n            }\n        }\n    };\n    if(checkList.length){\n        alert('\u62e1\u5f35\u5b50\u306e\u306a\u3044\u30d5\u30a1\u30a4\u30eb\u304c' + checkList.length + '\u500b\u3042\u308a\u307e\u3059\\n'+checkList.join('\\n'));\n    }else{\n        alert('OK');\n    }\n}\n```\n\n\u3053\u3053\u307e\u3067\u3067\u304d\u305f\u3089\u3001\u81ea\u52d5\u3067\u62e1\u5f35\u5b50\u3092\u3064\u3051\u3066\u30d5\u30a1\u30a4\u30eb\u3092\u30ea\u30f3\u30af\u3057\u76f4\u3057\u3066\u6b32\u3057\u3044\u3068\u601d\u3046\u3051\u3069\u3001\u3068\u308a\u3042\u3048\u305a\u4eca\u306f\u3053\u3053\u307e\u3067\u3002\n\n2014/05/07 \u8ffd\u8a18\n\u30ea\u30f3\u30af\u3092\u5909\u66f4\u3059\u308b\u3068\u3053\u308d\u307e\u3067\u66f8\u3044\u305f\u3002\nInDesign CS4\u4ee5\u964d\u3001Mac\u306e\u307f\u3067\u52d5\u4f5c\u3002\n\n2014/08/22\n\u30ea\u30f3\u30af\u304c\u7f6e\u304d\u63db\u308f\u3089\u306a\u3044\u90e8\u5206\u3092\u4fee\u6b63\u3002\n\n```javascript:\n(function(){\n    if(!app.documents.length) return;\n    var doc = app.activeDocument;\n    var checkMap = checkExtention(app.activeDocument);\n    reLinkWithExtention(doc,checkMap);\n    alert('OK');\n}());\n\n/**\u30d5\u30a1\u30a4\u30eb\u3092\u62e1\u5f35\u5b50\u4ed8\u304d\u3067\u30ea\u30cd\u30fc\u30e0\u3057\u3066\u518d\u30ea\u30f3\u30af*/\nfunction reLinkWithExtention(doc,checkMap){\n    var exts = {\n        'adobe pdf':'.ai'\n       ,'tiff':'.tif'\n       ,'eps':'.eps'\n       ,'photoshop':'.psd'\n    };\n    for(var i in checkMap){\n        var graphics = checkMap[i];\n        var ext = exts[graphics[0].imageTypeName.toLowerCase()];\n        var linkPath = getPosixPath(i);\n        var count = 0;\n        for(;;){\n            var suffix = count? '_'+count: '';\n            var renamePath = linkPath+suffix+ext;\n            var renameFile = new File(linkPath+suffix+ext);\n            if(!renameFile.exists) break;\n            count++;\n        }\n        var linkFile = new File(linkPath);\n        if(linkFile.exists){\n            var linkName = linkPath.match(/[^\\/]+$/)[0];\n            var relinkName = linkName + suffix + ext;\n            $.writeln(linkName +' -> '+relinkName);\n            linkFile.rename(relinkName);\n            for(var g=0,glen=graphics.length;g<glen;g++){\n                graphics[g].itemLink.relink(linkFile);\n            }\n        }\n    }\n};\n\n/**\u62e1\u5f35\u5b50\u306e\u306a\u3044\u30ea\u30f3\u30af\u3092\u96c6\u3081\u308b*/\nfunction checkExtention(doc){\n    var grapics = doc.allGraphics;\n    var checkRegs = {\n        'adobe pdf':(/\\.(ai|pdf)$/i)\n       ,'tiff':(/\\.tiff?$/i)\n       ,'eps':(/\\.eps$/i)\n       ,'photoshop':(/\\.psd$/i)\n    };\n    var i = grapics.length;\n    var checkMap = {};\n    while(i--){\n        var grapic = grapics[i];\n        var link = grapic.itemLink;\n        if(link && link.isValid){\n            var graphicType = grapic.imageTypeName.toLowerCase();\n            var checkReg = checkRegs[graphicType] || new RegExp('\\\\.'+graphicType+'$','i');\n            var linkName = link.name;\n            if(!checkReg.test(linkName)){\n                var linkPath = link.filePath;\n                if(!checkMap[linkPath]){\n                    checkMap[linkPath] = [];\n                }\n                checkMap[linkPath].push(grapic);\n            }\n        }\n    };\n    return checkMap;\n};\n\n/**\u30ed\u30fc\u30ab\u30eb\u30d1\u30b9\u304b\u3089Posix\u30d1\u30b9\u3092\u5f97\u308b*/\nfunction getPosixPath(localPath) {\n    if (localPath && Folder.fs == \"Macintosh\") {\n        localPath = escapeAppleScript(localPath);\n        var posixPath = app.doScript('\"' + localPath + '\"\\'s POSIX path', ScriptLanguage.APPLESCRIPT_LANGUAGE);\n        return posixPath.replace(/<([0-9a-fA-F]{4})>/g, function(){\n            return String.fromCharCode(parseInt(\"0x\"+arguments[1]));\n        });\n    }\n    return false;\n};\n\n/**AppleScript\u7528\u306b\u30a8\u30b9\u30b1\u30fc\u30d7*/\nfunction escapeAppleScript(str) {\n    return str.replace(/(?=[\"\\\\])/g, '\\\\');\n};\n```\n\n", "tags": ["indesign", "extendscript", "adobe"]}