{"context": " More than 1 year has passed since last update.\n\n\u76ee\u7684\n\nCloudAtCost\u306eDebian\u304cLVM\u3067\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u3066\u3044\u305f\u3002\n\n\n/dev/sda3\u304c\u65e2\u5b58\u306eLVM(8.6G)\n/dev/sda1(237M)\u3068/dev/sda2(954M)\u3092\u524a\u9664\u3057\u3001\n/dev/sda1(1.3G)\u3092\u4f5c\u6210\u3057\u65e2\u5b58\u306eLVM\u306b\u8ffd\u52a0\u3057\u305f\u3044(8.6G+1.3G=>9.8G)\n\n\n\n\n\u53c2\u8003\n\nLVM\u306e\u69cb\u7bc9\u65b9\u6cd5\uff08\u8ad6\u7406\u30dc\u30ea\u30e5\u30fc\u30e0\u306e\u5927\u304d\u3055\u3092\u62e1\u5f35\u3059\u308b\uff09\uff1a\u3074\u308d\u306b\u3063\u304d\uff1aSo-net\u30d6\u30ed\u30b0\nLVM\u306e\u4f7f\u3044\u65b9 - \u308f\u3059\u308c\u306a\u3044\u3046\u3061\u306b\u30e1\u30e2\u3057\u3088\u3046\n\n\n\u73fe\u72b6\u78ba\u8a8d\n# df -h /dev/dm-0\nFilesystem      Size  Used Avail Use% Mounted on\n/dev/dm-0       8.6G  1.4G  6.8G  18% /\n\n# fdisk -l /dev/sda\n\nDisk /dev/sda: 10 GiB, 10737418240 bytes, 20971520 sectors\nUnits: sectors of 1 * 512 = 512 bytes\nSector size (logical/physical): 512 bytes / 512 bytes\nI/O size (minimum/optimal): 512 bytes / 512 bytes\nDisklabel type: dos\nDisk identifier: 0x0001cb21\n\nDevice     Boot    Start      End  Sectors  Size Id Type\n/dev/sda1  *        2048   487423   485376  237M 83 Linux\n/dev/sda2         487424  2441215  1953792  954M 82 Linux swap / Solaris\n/dev/sda3        2441216 20969471 18528256  8.9G 8e Linux LVM\n/dev/sda4       20969472 20971519     2048    1M 8e Linux LVM\n\n\nswap off\n# swapoff /dev/sda2\n\n\n/etc/fstab\u306eswap\u524a\u9664\n\n\n/dev/sda1,2\u3092\u524a\u9664\n# fdisk /dev/sda\n\nWelcome to fdisk (util-linux 2.25.2).\nChanges will remain in memory only, until you decide to write them.\nBe careful before using the write command.\n\n\nCommand (m for help): p\nDisk /dev/sda: 10 GiB, 10737418240 bytes, 20971520 sectors\nUnits: sectors of 1 * 512 = 512 bytes\nSector size (logical/physical): 512 bytes / 512 bytes\nI/O size (minimum/optimal): 512 bytes / 512 bytes\nDisklabel type: dos\nDisk identifier: 0x0001cb21\n\nDevice     Boot    Start      End  Sectors  Size Id Type\n/dev/sda1  *        2048   487423   485376  237M 83 Linux\n/dev/sda2         487424  2441215  1953792  954M 82 Linux swap / Solaris\n/dev/sda3        2441216 20969471 18528256  8.9G 8e Linux LVM\n/dev/sda4       20969472 20971519     2048    1M 8e Linux LVM\n\n\nCommand (m for help): d\nPartition number (1-4, default 4): 1\n\nPartition 1 has been deleted.\n\nCommand (m for help): d\nPartition number (2-4, default 4): 2\n\nPartition 2 has been deleted.\n\nCommand (m for help): p\nDisk /dev/sda: 10 GiB, 10737418240 bytes, 20971520 sectors\nUnits: sectors of 1 * 512 = 512 bytes\nSector size (logical/physical): 512 bytes / 512 bytes\nI/O size (minimum/optimal): 512 bytes / 512 bytes\nDisklabel type: dos\nDisk identifier: 0x0001cb21\n\nDevice     Boot    Start      End  Sectors  Size Id Type\n/dev/sda3        2441216 20969471 18528256  8.9G 8e Linux LVM\n/dev/sda4       20969472 20971519     2048    1M 8e Linux LVM\n\n\nCommand (m for help): w\nThe partition table has been altered.\nCalling ioctl() to re-read partition table.\nRe-reading the partition table failed.: Device or resource busy\n\nThe kernel still uses the old table. The new table will be used at the next reboot or after you run partprobe(8) or kpartx(8).\n\n# reboot\n\n\n/dev/sda1\u4f5c\u6210\n\n/dev/sda1\u4f5c\u6210\n# fdisk /dev/sda\n\nWelcome to fdisk (util-linux 2.25.2).\nChanges will remain in memory only, until you decide to write them.\nBe careful before using the write command.\n\n\nCommand (m for help): n\nPartition type\n   p   primary (2 primary, 0 extended, 2 free)\n   e   extended (container for logical partitions)\nSelect (default p): p\nPartition number (1,2, default 1): \nFirst sector (2048-20971519, default 2048): \nLast sector, +sectors or +size{K,M,G,T,P} (2048-2441215, default 2441215): \n\nCreated a new partition 1 of type 'Linux' and of size 1.2 GiB.\n\nCommand (m for help): t\nPartition number (1,3,4, default 4): 1\nHex code (type L to list all codes): 8e\n\nChanged type of partition 'Linux' to 'Linux LVM'.\n\nCommand (m for help): p\nDisk /dev/sda: 10 GiB, 10737418240 bytes, 20971520 sectors\nUnits: sectors of 1 * 512 = 512 bytes\nSector size (logical/physical): 512 bytes / 512 bytes\nI/O size (minimum/optimal): 512 bytes / 512 bytes\nDisklabel type: dos\nDisk identifier: 0x0001cb21\n\nDevice     Boot    Start      End  Sectors  Size Id Type\n/dev/sda1           2048  2441215  2439168  1.2G 8e Linux LVM\n/dev/sda3        2441216 20969471 18528256  8.9G 8e Linux LVM\n/dev/sda4       20969472 20971519     2048    1M 8e Linux LVM\n\n\nCommand (m for help): w\nThe partition table has been altered.\nCalling ioctl() to re-read partition table.\nRe-reading the partition table failed.: Device or resource busy\n\nThe kernel still uses the old table. The new table will be used at the next reboot or after you run partprobe(8) or kpartx(8).\n\n# reboot\n\n\n\npvcreate\n# fdisk -l /dev/sda\n\nDisk /dev/sda: 10 GiB, 10737418240 bytes, 20971520 sectors\nUnits: sectors of 1 * 512 = 512 bytes\nSector size (logical/physical): 512 bytes / 512 bytes\nI/O size (minimum/optimal): 512 bytes / 512 bytes\nDisklabel type: dos\nDisk identifier: 0x0001cb21\n\nDevice     Boot    Start      End  Sectors  Size Id Type\n/dev/sda1           2048  2441215  2439168  1.2G 8e Linux LVM\n/dev/sda3        2441216 20969471 18528256  8.9G 8e Linux LVM\n/dev/sda4       20969472 20971519     2048    1M 8e Linux LVM\n\n# pvdisplay -v\n    DEGRADED MODE. Incomplete RAID LVs will be processed.\n    Scanning for physical volume names\n  --- Physical volume ---\n  PV Name               /dev/sda3\n  VG Name               vg_cac\n  PV Size               8.83 GiB / not usable 3.00 MiB\n  Allocatable           yes (but full)\n  PE Size               4.00 MiB\n  Total PE              2261\n  Free PE               0\n  Allocated PE          2261\n  PV UUID               gjBdEp-9uoK-Hnxo-9isu-Hi30-3ZZ3-lzdY3b\n\n# pvscan\n  PV /dev/sda3   VG vg_cac   lvm2 [8.83 GiB / 0    free]\n  Total: 1 [8.83 GiB] / in use: 1 [8.83 GiB] / in no VG: 0 [0   ]\n# pvcreate /dev/sda1\n  Physical volume \"/dev/sda1\" successfully created\n# vgscan\n  Reading all physical volumes.  This may take a while...\n  Found volume group \"vg_cac\" using metadata type lvm2\n\n# vgextend vg_cac /dev/sda1\n  Volume group \"vg_cac\" successfully extended\n# df -h /dev/dm-0\nFilesystem      Size  Used Avail Use% Mounted on\n/dev/dm-0       8.6G  1.3G  6.9G  16% /\n# vgdisplay \n  --- Volume group ---\n  VG Name               vg_cac\n  System ID             \n  Format                lvm2\n  Metadata Areas        2\n  Metadata Sequence No  3\n  VG Access             read/write\n  VG Status             resizable\n  MAX LV                0\n  Cur LV                1\n  Open LV               1\n  Max PV                0\n  Cur PV                2\n  Act PV                2\n  VG Size               9.99 GiB\n  PE Size               4.00 MiB\n  Total PE              2558\n  Alloc PE / Size       2261 / 8.83 GiB\n  Free  PE / Size       297 / 1.16 GiB\n  VG UUID               AlBirr-duAr-Mwzy-JYtP-rhgG-T7y4-C6LR09\n\n\nlvextend\n# lvextend -l +297 /dev/vg_cac/root_cac\n  Size of logical volume vg_cac/root_cac changed from 8.83 GiB (2261 extents) to 9.99 GiB (2558 extents).\n  Logical volume root_cac successfully resized\n# df -h /dev/dm-0\nFilesystem      Size  Used Avail Use% Mounted on\n/dev/dm-0       8.6G  1.3G  6.9G  16% /\n\n\nresize2fs\n# resize2fs /dev/vg_cac/root_cac\nresize2fs 1.42.12 (29-Aug-2014)\nFilesystem at /dev/vg_cac/root_cac is mounted on /; on-line resizing required\nold_desc_blocks = 1, new_desc_blocks = 1\nThe filesystem on /dev/vg_cac/root_cac is now 2619392 (4k) blocks long.\n\n# df -h /dev/dm-0\nFilesystem      Size  Used Avail Use% Mounted on\n/dev/dm-0       9.8G  1.3G  8.0G  14% /\n\n\u5b8c\u6210\n# \u76ee\u7684\n\n* CloudAtCost\u306eDebian\u304cLVM\u3067\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u3066\u3044\u305f\u3002\n    * /dev/sda3\u304c\u65e2\u5b58\u306eLVM(8.6G)\n    * /dev/sda1(237M)\u3068/dev/sda2(954M)\u3092\u524a\u9664\u3057\u3001\n    * /dev/sda1(1.3G)\u3092\u4f5c\u6210\u3057\u65e2\u5b58\u306eLVM\u306b\u8ffd\u52a0\u3057\u305f\u3044(8.6G+1.3G=>9.8G)\n\n## \u53c2\u8003\n\n* [LVM\u306e\u69cb\u7bc9\u65b9\u6cd5\uff08\u8ad6\u7406\u30dc\u30ea\u30e5\u30fc\u30e0\u306e\u5927\u304d\u3055\u3092\u62e1\u5f35\u3059\u308b\uff09\uff1a\u3074\u308d\u306b\u3063\u304d\uff1aSo-net\u30d6\u30ed\u30b0](http://piro791.blog.so-net.ne.jp/2008-10-01-3)\n* [LVM\u306e\u4f7f\u3044\u65b9 - \u308f\u3059\u308c\u306a\u3044\u3046\u3061\u306b\u30e1\u30e2\u3057\u3088\u3046](http://d.hatena.ne.jp/kt_hiro/20120117/1326764520)\n\n## \u73fe\u72b6\u78ba\u8a8d\n\n```bash:\n# df -h /dev/dm-0\nFilesystem      Size  Used Avail Use% Mounted on\n/dev/dm-0       8.6G  1.4G  6.8G  18% /\n```\n\n```bash:\n# fdisk -l /dev/sda\n\nDisk /dev/sda: 10 GiB, 10737418240 bytes, 20971520 sectors\nUnits: sectors of 1 * 512 = 512 bytes\nSector size (logical/physical): 512 bytes / 512 bytes\nI/O size (minimum/optimal): 512 bytes / 512 bytes\nDisklabel type: dos\nDisk identifier: 0x0001cb21\n\nDevice     Boot    Start      End  Sectors  Size Id Type\n/dev/sda1  *        2048   487423   485376  237M 83 Linux\n/dev/sda2         487424  2441215  1953792  954M 82 Linux swap / Solaris\n/dev/sda3        2441216 20969471 18528256  8.9G 8e Linux LVM\n/dev/sda4       20969472 20971519     2048    1M 8e Linux LVM\n```\n\n## swap off\n\n```bash:\n# swapoff /dev/sda2\n```\n\n* /etc/fstab\u306eswap\u524a\u9664\n\n## /dev/sda1,2\u3092\u524a\u9664\n\n```bash:\n# fdisk /dev/sda\n\nWelcome to fdisk (util-linux 2.25.2).\nChanges will remain in memory only, until you decide to write them.\nBe careful before using the write command.\n\n\nCommand (m for help): p\nDisk /dev/sda: 10 GiB, 10737418240 bytes, 20971520 sectors\nUnits: sectors of 1 * 512 = 512 bytes\nSector size (logical/physical): 512 bytes / 512 bytes\nI/O size (minimum/optimal): 512 bytes / 512 bytes\nDisklabel type: dos\nDisk identifier: 0x0001cb21\n\nDevice     Boot    Start      End  Sectors  Size Id Type\n/dev/sda1  *        2048   487423   485376  237M 83 Linux\n/dev/sda2         487424  2441215  1953792  954M 82 Linux swap / Solaris\n/dev/sda3        2441216 20969471 18528256  8.9G 8e Linux LVM\n/dev/sda4       20969472 20971519     2048    1M 8e Linux LVM\n\n\nCommand (m for help): d\nPartition number (1-4, default 4): 1\n\nPartition 1 has been deleted.\n\nCommand (m for help): d\nPartition number (2-4, default 4): 2\n\nPartition 2 has been deleted.\n\nCommand (m for help): p\nDisk /dev/sda: 10 GiB, 10737418240 bytes, 20971520 sectors\nUnits: sectors of 1 * 512 = 512 bytes\nSector size (logical/physical): 512 bytes / 512 bytes\nI/O size (minimum/optimal): 512 bytes / 512 bytes\nDisklabel type: dos\nDisk identifier: 0x0001cb21\n\nDevice     Boot    Start      End  Sectors  Size Id Type\n/dev/sda3        2441216 20969471 18528256  8.9G 8e Linux LVM\n/dev/sda4       20969472 20971519     2048    1M 8e Linux LVM\n\n\nCommand (m for help): w\nThe partition table has been altered.\nCalling ioctl() to re-read partition table.\nRe-reading the partition table failed.: Device or resource busy\n\nThe kernel still uses the old table. The new table will be used at the next reboot or after you run partprobe(8) or kpartx(8).\n\n# reboot\n```\n\n## /dev/sda1\u4f5c\u6210\n\n```bash:/dev/sda1\u4f5c\u6210\n# fdisk /dev/sda\n\nWelcome to fdisk (util-linux 2.25.2).\nChanges will remain in memory only, until you decide to write them.\nBe careful before using the write command.\n\n\nCommand (m for help): n\nPartition type\n   p   primary (2 primary, 0 extended, 2 free)\n   e   extended (container for logical partitions)\nSelect (default p): p\nPartition number (1,2, default 1): \nFirst sector (2048-20971519, default 2048): \nLast sector, +sectors or +size{K,M,G,T,P} (2048-2441215, default 2441215): \n\nCreated a new partition 1 of type 'Linux' and of size 1.2 GiB.\n\nCommand (m for help): t\nPartition number (1,3,4, default 4): 1\nHex code (type L to list all codes): 8e\n\nChanged type of partition 'Linux' to 'Linux LVM'.\n\nCommand (m for help): p\nDisk /dev/sda: 10 GiB, 10737418240 bytes, 20971520 sectors\nUnits: sectors of 1 * 512 = 512 bytes\nSector size (logical/physical): 512 bytes / 512 bytes\nI/O size (minimum/optimal): 512 bytes / 512 bytes\nDisklabel type: dos\nDisk identifier: 0x0001cb21\n\nDevice     Boot    Start      End  Sectors  Size Id Type\n/dev/sda1           2048  2441215  2439168  1.2G 8e Linux LVM\n/dev/sda3        2441216 20969471 18528256  8.9G 8e Linux LVM\n/dev/sda4       20969472 20971519     2048    1M 8e Linux LVM\n\n\nCommand (m for help): w\nThe partition table has been altered.\nCalling ioctl() to re-read partition table.\nRe-reading the partition table failed.: Device or resource busy\n\nThe kernel still uses the old table. The new table will be used at the next reboot or after you run partprobe(8) or kpartx(8).\n\n# reboot\n```\n\n## pvcreate\n\n```bash:\n# fdisk -l /dev/sda\n\nDisk /dev/sda: 10 GiB, 10737418240 bytes, 20971520 sectors\nUnits: sectors of 1 * 512 = 512 bytes\nSector size (logical/physical): 512 bytes / 512 bytes\nI/O size (minimum/optimal): 512 bytes / 512 bytes\nDisklabel type: dos\nDisk identifier: 0x0001cb21\n\nDevice     Boot    Start      End  Sectors  Size Id Type\n/dev/sda1           2048  2441215  2439168  1.2G 8e Linux LVM\n/dev/sda3        2441216 20969471 18528256  8.9G 8e Linux LVM\n/dev/sda4       20969472 20971519     2048    1M 8e Linux LVM\n\n# pvdisplay -v\n    DEGRADED MODE. Incomplete RAID LVs will be processed.\n    Scanning for physical volume names\n  --- Physical volume ---\n  PV Name               /dev/sda3\n  VG Name               vg_cac\n  PV Size               8.83 GiB / not usable 3.00 MiB\n  Allocatable           yes (but full)\n  PE Size               4.00 MiB\n  Total PE              2261\n  Free PE               0\n  Allocated PE          2261\n  PV UUID               gjBdEp-9uoK-Hnxo-9isu-Hi30-3ZZ3-lzdY3b\n   \n# pvscan\n  PV /dev/sda3   VG vg_cac   lvm2 [8.83 GiB / 0    free]\n  Total: 1 [8.83 GiB] / in use: 1 [8.83 GiB] / in no VG: 0 [0   ]\n# pvcreate /dev/sda1\n  Physical volume \"/dev/sda1\" successfully created\n# vgscan\n  Reading all physical volumes.  This may take a while...\n  Found volume group \"vg_cac\" using metadata type lvm2\n```\n\n```bash:\n# vgextend vg_cac /dev/sda1\n  Volume group \"vg_cac\" successfully extended\n# df -h /dev/dm-0\nFilesystem      Size  Used Avail Use% Mounted on\n/dev/dm-0       8.6G  1.3G  6.9G  16% /\n# vgdisplay \n  --- Volume group ---\n  VG Name               vg_cac\n  System ID             \n  Format                lvm2\n  Metadata Areas        2\n  Metadata Sequence No  3\n  VG Access             read/write\n  VG Status             resizable\n  MAX LV                0\n  Cur LV                1\n  Open LV               1\n  Max PV                0\n  Cur PV                2\n  Act PV                2\n  VG Size               9.99 GiB\n  PE Size               4.00 MiB\n  Total PE              2558\n  Alloc PE / Size       2261 / 8.83 GiB\n  Free  PE / Size       297 / 1.16 GiB\n  VG UUID               AlBirr-duAr-Mwzy-JYtP-rhgG-T7y4-C6LR09\n```\n\n## lvextend\n\n```bash:\n# lvextend -l +297 /dev/vg_cac/root_cac\n  Size of logical volume vg_cac/root_cac changed from 8.83 GiB (2261 extents) to 9.99 GiB (2558 extents).\n  Logical volume root_cac successfully resized\n# df -h /dev/dm-0\nFilesystem      Size  Used Avail Use% Mounted on\n/dev/dm-0       8.6G  1.3G  6.9G  16% /\n```\n\n## resize2fs\n\n```bash:\n# resize2fs /dev/vg_cac/root_cac\nresize2fs 1.42.12 (29-Aug-2014)\nFilesystem at /dev/vg_cac/root_cac is mounted on /; on-line resizing required\nold_desc_blocks = 1, new_desc_blocks = 1\nThe filesystem on /dev/vg_cac/root_cac is now 2619392 (4k) blocks long.\n\n# df -h /dev/dm-0\nFilesystem      Size  Used Avail Use% Mounted on\n/dev/dm-0       9.8G  1.3G  8.0G  14% /\n```\n\n\u5b8c\u6210\n", "tags": ["lvm", "CloudatCost", "vps"]}