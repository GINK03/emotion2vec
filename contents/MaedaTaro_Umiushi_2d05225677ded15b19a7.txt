{"context": "\u30b2\u30ce\u30e0\u60c5\u5831\u3092\u3082\u3068\u306b\u6570\u767e\u306e\u907a\u4f1d\u5b50\u3092\u4f7f\u3063\u3066\u7cfb\u7d71\u89e3\u6790\u3092\u3057\u3088\u3046\u3068\u3057\u305f\u306e\u3067\u3059\u304c\u3001\u30d5\u30a1\u30a4\u30eb\u306e\u7d50\u5408\u306a\u3069\u306e\u3044\u3044\u30c4\u30fc\u30eb\u304c\u898b\u3064\u304b\u3089\u306a\u304b\u3063\u305f\u306e\u3067\u3001Biopython\u3067\u305d\u3053\u3044\u3089\u306e\u51e6\u7406\u304c\u697d\u306b\u306a\u308b\u3088\u3046\u306b\u3057\u307e\u3057\u305f\u3002\u307e\u305fConsel\u3092\u3064\u304b\u3063\u305fAU\u691c\u5b9a\u3067\u3061\u3087\u3063\u3068\u3064\u307e\u305a\u3044\u305f\u306e\u3067\u3001\u305d\u3053\u306b\u3064\u3044\u3066\u3082\u8a18\u9332\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n\u521d\u5fc3\u8005\u306a\u306e\u3067\u3001\u9593\u9055\u3044\u306a\u3069\u306e\u30b3\u30e1\u30f3\u30c8\u6b53\u8fce\u3067\u3059\u3002\n\n\u53c2\u8003\u30b5\u30a4\u30c8\nhttp://biopython.org/wiki/SeqIO\nhttp://www.stevekellylab.com/software/orthofinder\n\n1,\u30b7\u30f3\u30b0\u30eb\u30b3\u30d4\u30fc\u907a\u4f1d\u5b50\u3092\u9078\u51fa\u3059\u308b\northofinder \u306e\u51fa\u529b\u30d5\u30a1\u30a4\u30eb\uff08Orthogroups_.csv\u306a\u3069\uff09\u304b\u3089single copy\u907a\u4f1d\u5b50\u3060\u3051\u3092\u9078\u629c\u3057\u3001\u4ee5\u4e0b\u306e\u69d8\u306a\u30b9\u30da\u30fc\u30b9\u533a\u5207\u308a\u306e\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u308b\u3002\n1\u5217\u76ee\u304c\u30aa\u30fc\u30bd\u30ed\u30ac\u30b9\u30b0\u30eb\u30fc\u30d7\u540d(OG)\u3067\u3001\u4ee5\u964d\u304c\u5404OG\u306b\u5c5e\u3059\u308b\u914d\u5217\u306e\u540d\u524d\u306b\u306a\u3063\u3066\u3044\u308b\u3002\n\nOG_list.txt\nOG0000000 fasta_ID_sp_A_seq1 fasta_ID_sp_B_seq2 fasta_ID_sp_C_seq3\nOG0000001 fasta_ID_sp_A_seq2 fasta_ID_sp_B_seq2 fasta_ID_sp_C_seq3 \nOG0000002 fasta_ID_sp_A_seq3 fasta_ID_sp_B_seq2 fasta_ID_sp_C_seq3\n\n\n\u3059\u3079\u3066\u306e\u914d\u5217\u60c5\u5831\u304c\u5165\u3063\u3066\u3044\u308bmultiple fasta\u3082\u6e96\u5099\u3059\u308b\u3002\n(\u5404\u751f\u7269\u7a2e\u6bce\u306b\u5168CDS\u60c5\u5831\u3092fasta\u3067\u3068\u3063\u3066\u304d\u3066cat\u3067\u7d50\u5408\u306a\u3069\u3059\u308b\uff09\n\nall_seq.fa\n>fasta_ID_sp_A_seq1\nXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX\n>fasta_ID_sp_B_seq2\nXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX\n>fasta_ID_sp_C_seq3\nXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX\n........\n\n\n\n2,OG\u6bce\u306b\u5404\u914d\u5217\u60c5\u5831\u3092\u5225\u30d5\u30a1\u30a4\u30eb\u306b\u3044\u308c\u5206\u3051\u308b\n\u4ee5\u4e0b\u306e\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u4f7f\u3063\u3066\u3001\u30c7\u30fc\u30bf\u3092\u5206\u3051\u308b\n\u5404OG\u540d\u304c\u30d5\u30a1\u30a4\u30eb\u540d\u306b\u306a\u3063\u305ffasta\u304c\u4f5c\u6210\u3055\u308c\u308b\u3002\n\u5404\u30d5\u30a1\u30a4\u30eb\u306b\u3001\u305d\u308c\u305e\u308c\u306eOG\u306b\u5c5e\u3059\u308b\u914d\u5217\u304c\u5165\u3063\u3066\u3044\u308b\u3002\n\nOG_separater.py\n#!/usr/bin/env python\n# -*- coding: utf-8 -*-\n\nimport sys\nfrom Bio import SeqIO\n\nfasta_in = sys.argv[1]                            #\uff11\u756a\u76ee\u306e\u5f15\u6570\u306b\u306f\u4e0a\u8a18\u306eall_seq.fa\u306a\u3069fasta\u30d5\u30a1\u30a4\u30eb\u3092\u6307\u5b9a\u3059\u308b\nquery_in = sys.argv[2]                            #\uff12\u756a\u76ee\u306e\u5f15\u6570\u306b\u306f\u4e0a\u8a18\u306eOG_list.txt\u306a\u3069\u30aa\u30fc\u30bd\u30ed\u30b0\u30d5\u30a1\u30a4\u30eb\u3092\u6307\u5b9a\u3059\u308b\n\nfor q in open(query_in, \"r\"):                     #\u30aa\u30fc\u30bd\u30ed\u30b0\u30d5\u30a1\u30a4\u30eb\u3092\u958b\u3044\u30661\u884c\u3065\u3064\u8aad\u307f\u8fbc\u3080\n    query = q.split()                             #\u30b9\u30da\u30fc\u30b9\u6bce\u306b\u5207\u308a\u3068\u3063\u3066\u30ea\u30b9\u30c8\u5f62\u5f0f\u3067query\u306b\u4fdd\u5b58\u3059\u308b\n    f = open(query[0], 'w')                       #\u6700\u521d\u306e\u5217(OG\u540d\uff09\u3068\u540c\u3058\u540d\u524d\u306e\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u6210\u3059\u308b\n    for record in SeqIO.parse(fasta_in, 'fasta'): #fasta\u30d5\u30a1\u30a4\u30eb\u3092\u958b\u304fSeqIO\u3092\u4f7f\u3063\u3066\u30d1\u30fc\u30b9\u3059\u308b(1\u9805\u76ee\u3065\u3064\u8aad\u307f\u8fbc\u3080\uff09\n        id_part = record.id                       #fasta\u306eID\u90e8\u5206\u3092\u8aad\u307f\u8fbc\u3080\n        desc_part = record.description            #fasta\u306edescription\u90e8\u5206\u3092\u8aad\u307f\u8fbc\u3080\n        seq = record.seq                          #fastan\u306e\u914d\u5217\u90e8\u5206\u3092\u8aad\u307f\u8fbc\u3080\n        for i in xrange(len(query)):              #\u30aa\u30fc\u30bd\u30ed\u30b0\u30d5\u30a1\u30a4\u30eb\u4e2d\u306e\u5404OG\u306b\u542b\u307e\u308c\u308b\u914d\u5217\u6570\u3092\u6570\u3048\u3066\u3001\u305d\u306e\u5206\u7e70\u308a\u8fd4\u3059\n            if desc_part == query[i] :            #\u30aa\u30fc\u30bd\u30ed\u30b0\u30d5\u30a1\u30a4\u30eb\u306e\u914d\u5217description\u3068fasta\u306e\u914d\u5217description\u304c\u4e00\u81f4\u3057\u305f\u3089\u3001\u3001\u3001\n                fasta_seq = '>' + desc_part + '\\n' + seq + '\\n'     #fasta\u5f62\u5f0f\u306b\u6574\u3048\u3066\n                print(fasta_seq)                  #\u6a19\u6e96\u51fa\u529b\u306bfasta\u3092\u51fa\u529b\uff08\u9032\u884c\u72b6\u6cc1\u628a\u63e1\u7528\uff09\n                f.write(str(fasta_seq))           #\u5404OG\u30d5\u30a1\u30a4\u30eb\u306bfasta\u3092\u51fa\u529b\n    f.close()\n\n\n\n3,\u30a2\u30e9\u30a4\u30e1\u30f3\u30c8\u3068\u30c8\u30ea\u30df\u30f3\u30b0\nmafft \u3068 trimal\u3092\u4f7f\u3063\u3066\u5404OG\u30d5\u30a1\u30a4\u30eb\u3092\u30a2\u30e9\u30a4\u30e1\u30f3\u30c8\uff0b\u30c8\u30ea\u30df\u30f3\u30b0\u3059\u308b\n\nalign.sh\n#!/bin/sh\n#$ -S /bin/bash\n#$ -cwd\n#$ -v PATH\nmafft --maxiterate 1000 --localpair --thread 10 $1 > $1.maffted\ntrimal -automated1 -in $1.maffted -out $1.maffted.trimal.fa\n\n\n\n4,\u8907\u6570\u306eOG\u30d5\u30a1\u30a4\u30eb\u304b\u3089\u3001\u9806\u756a\u305d\u306e\u307e\u307e\u3001fasta\u3092\u6a2a\u306b\u7d50\u5408\u3057\u3066\u3044\u304f\n\u9806\u756a\u305d\u306e\u307e\u307e\u3001fasta\u3092\u6a2a\u306b\u7d50\u5408\u3057\u3066\u3044\u304f\uff08bash\u306epaste\u30b3\u30de\u30f3\u30c9\u3063\u307d\u304f\u7d50\u5408\u3059\u308b\uff09\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u4f5c\u6210\u3057\u305f\n\n\u4f8b\n\n\nGeneA.fa\n>sp1_A\nAAAAAAAAAA\n>sp2_A\nBBBBBBBBB\n>sp3_A\nCCCCCCCCCC\n>sp4_A\nDDDDDDDDDD\n\n\n\nGeneB.fa\n>sp1_B\nEEEEEEEEEE\n>sp2_B\nFFFFFFFFFF\n>sp3_B\nGGGGGGGGGG\n>sp4_B\nHHHHHHHHHH\n\n\n\nout.fa\n>sp1_A;sp1_B\nAAAAAAAAAAEEEEEEEEEE\n>sp2_A;sp2_B\nBBBBBBBBBFFFFFFFFFF\n>sp3_A;sp3_B\nCCCCCCCCCCGGGGGGGGGG\n>sp4_A;sp4_B\nDDDDDDDDDDHHHHHHHHHH\n\n\n\n\u7121\u9650\u306b\u5f15\u6570\u3092\u3068\u308c\u308b\u3088\u3046\u306b\u306a\u3063\u3066\u3044\u308b\u306e\u3067\u4ee5\u4e0b\u306e\u69d8\u306b\u30ef\u30a4\u30eb\u30c9\u30ab\u30fc\u30c9\u3092\u3064\u304b\u3063\u3066\u3082OK\n\njoint.sh\npython fasta_merge_orderkeep.py *.maffted.trimal.fa\n\n\n\u4ee5\u4e0b\u30b9\u30af\u30ea\u30d7\u30c8\n\nfasta_merge_orderkeep.py\n#!/usr/bin/env python\n# -*- coding: utf-8 -*-\n\n#TARO MAEDA 2017 14 Jul. \n\nimport sys\nfrom Bio import SeqIO\n\nnum_file=len(sys.argv)-1  #\u5165\u529b\u30d5\u30a1\u30a4\u30eb\u6570\u3092\u6570\u3048\u308b\nprint(\"Detected file number\")\nprint(num_file)\n\nid_list = {}              #ID\u306e\u8f9e\u66f8\u3092\u5ba3\u8a00\nseq_list = {}             #seq\u306e\u8f9e\u66f8\u3092\u5ba3\u8a00\ncounter_file = int(\"0\")   #\u30d5\u30a1\u30a4\u30eb\u30ab\u30a6\u30f3\u30bf\u30fc\u3092\u521d\u671f\u5316\n\n\nprint(\"File opening...\") \n\nfor i in xrange(num_file):                    #\u30d5\u30a1\u30a4\u30eb\u6570\u5206\u7e70\u308a\u8fd4\u3059\uff08fasta\u30d5\u30a1\u30a4\u30eb\u306e\u4e2d\u8eab\u3092\u8f9e\u66f8\u306b\u5165\u529b)\n    counter_file += 1                         #\u30d5\u30a1\u30a4\u30eb\u30ab\u30a6\u30f3\u30bf\u30fc\u3092\u307e\u308f\u3059\n    counter_order = int(\"0\")                  #\u30d5\u30a1\u30a4\u30eb\u4e2d\u306efasta\u306e\u9806\u756a\u3092\u30ab\u30a6\u30f3\u30c8\u3059\u308border\u30ab\u30a6\u30f3\u30bf\u30fc\u3092\u521d\u671f\u5316\u3059\u308b\n    for file1 in SeqIO.parse(sys.argv[counter_file], 'fasta'):  #\u5f15\u6570N\u756a\u76ee\u306e\u30d5\u30a1\u30a4\u30eb\u3092\u8aad\u307f\u8fbc\u3080\n        counter_order +=1                     #order\u30ab\u30a6\u30f3\u30bf\u30fc\u3092\u307e\u308f\u3059\n        print(\"now getting \" +  file1.id)     #\u72b6\u6cc1\u78ba\u8a8d\u7528\uff08\u53d6\u308a\u8fbc\u307f\u4e2d\u306efasta id\u3092\u51fa\u529b\u3059\u308b\uff09\n        id_list[\"ID_file\" + str(counter_file) + \"order\" + str(counter_order)] = file1.id    #fastaID\u3092\u8f9e\u66f8\u306b\u5165\u529b\u3057\u3066\u3044\u304f\u3001order\u30ab\u30a6\u30f3\u30bf\u30fc\u3068\u30d5\u30a1\u30a4\u30eb\u30ab\u30a6\u30f3\u30bf\u3067\u30ad\u30fc\u306e\u5024\u3092\u6307\u5b9a\u3057\u3066\u3044\u304f\u3002\n        seq_list[\"Seq_file\" + str(counter_file) + \"order\" + str(counter_order)] = file1.seq #fasta\u306e\u914d\u5217\u60c5\u5831\u3092\u8f9e\u66f8\u306b\u5165\u529b\u3057\u3066\u3044\u304f\u3001order\u30ab\u30a6\u30f3\u30bf\u30fc\u3068\u30d5\u30a1\u30a4\u30eb\u30ab\u30a6\u30f3\u30bf\u3067\u30ad\u30fc\u306e\u5024\u3092\u6307\u5b9a\u3057\u3066\u3044\u304f\u3002\n\n\nmax_count_file = counter_file    #\u6700\u7d42\u7684\u306b\u8aad\u307e\u308c\u305f\u3059\u3079\u3066\u306e\u30d5\u30a1\u30a4\u30eb\u6570\u3092\u7372\u5f97\u3059\u308b\nmax_count_order = counter_order  #\u6700\u7d42\u7684\u306b\u8aad\u307e\u308c\u305f\u3059\u3079\u3066\u306e\u7a2e\u6570\uff081fasta\u30d5\u30a1\u30a4\u30eb\u4e2d\u306efasta\u30c7\u30fc\u30bf\u6570\uff09\u3092\u7372\u5f97\u3059\u308b\nnow_order = int(\"0\")                    #\u4eca\u51fa\u529b\u3057\u3066\u3044\u308b\u7a2e\u304c\u4f55\u756a\u76ee\u306e\u7a2e\u304b\uff08fasta\u30d5\u30a1\u30a4\u30eb\u4e2d\u306e\u4f55\u756a\u76ee\u306efasta\u30c7\u30fc\u30bf\u304b\uff09\u3092\u6570\u3048\u308b\u30ab\u30a6\u30f3\u30bf\u30fc\u3092\u521d\u671f\u5316\u3059\u308b\n\n\nprint(\"File writing...\") \n\n\nf = open(\"marged_out.fa\", 'w')            #\u7d50\u679c\u51fa\u529b\u7528\u30d5\u30a1\u30a4\u30eb\u3092\u958b\u304f\nfor now_order in xrange(max_count_order): #\u7a2e\u6570\u5206\u51e6\u7406\u3092\u7e70\u308a\u8fd4\u3059\n    out_id  = \"\"                          #\u51fa\u529b\u7528\u5909\u6570\u3092\u521d\u671f\u5316\u3059\u308b\u3002\n    out_seq  = \"\"                         #\u51fa\u529b\u7528\u5909\u6570\u3092\u521d\u671f\u5316\u3059\u308b\u3002\n    for now_file in xrange(max_count_file): #\u5168\u30d5\u30a1\u30a4\u30eb\u6570\u5206\u7e70\u308a\u8fd4\u3059\n        out_id += id_list[\"ID_file\" + str(now_file+1) + \"order\" + str(now_order+1)] +\";\" \n        out_seq += str(seq_list[\"Seq_file\" + str(now_file+1) + \"order\" + str(now_order+1)]) \n    outfasta =\">\" + out_id + \"\\n\" + out_seq + \"\\n\"\n    f.write(outfasta)\nf.close()\n\nprint(\"Output file was made as marged_out.fa\") \n\n\n\u30b2\u30ce\u30e0\u60c5\u5831\u3092\u3082\u3068\u306b\u6570\u767e\u306e\u907a\u4f1d\u5b50\u3092\u4f7f\u3063\u3066\u7cfb\u7d71\u89e3\u6790\u3092\u3057\u3088\u3046\u3068\u3057\u305f\u306e\u3067\u3059\u304c\u3001\u30d5\u30a1\u30a4\u30eb\u306e\u7d50\u5408\u306a\u3069\u306e\u3044\u3044\u30c4\u30fc\u30eb\u304c\u898b\u3064\u304b\u3089\u306a\u304b\u3063\u305f\u306e\u3067\u3001Biopython\u3067\u305d\u3053\u3044\u3089\u306e\u51e6\u7406\u304c\u697d\u306b\u306a\u308b\u3088\u3046\u306b\u3057\u307e\u3057\u305f\u3002\u307e\u305fConsel\u3092\u3064\u304b\u3063\u305fAU\u691c\u5b9a\u3067\u3061\u3087\u3063\u3068\u3064\u307e\u305a\u3044\u305f\u306e\u3067\u3001\u305d\u3053\u306b\u3064\u3044\u3066\u3082\u8a18\u9332\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n\n\u521d\u5fc3\u8005\u306a\u306e\u3067\u3001\u9593\u9055\u3044\u306a\u3069\u306e\u30b3\u30e1\u30f3\u30c8\u6b53\u8fce\u3067\u3059\u3002\n\n\n#\u53c2\u8003\u30b5\u30a4\u30c8\nhttp://biopython.org/wiki/SeqIO\nhttp://www.stevekellylab.com/software/orthofinder\n\n#1,\u30b7\u30f3\u30b0\u30eb\u30b3\u30d4\u30fc\u907a\u4f1d\u5b50\u3092\u9078\u51fa\u3059\u308b\n\northofinder \u306e\u51fa\u529b\u30d5\u30a1\u30a4\u30eb\uff08Orthogroups_.csv\u306a\u3069\uff09\u304b\u3089single copy\u907a\u4f1d\u5b50\u3060\u3051\u3092\u9078\u629c\u3057\u3001\u4ee5\u4e0b\u306e\u69d8\u306a\u30b9\u30da\u30fc\u30b9\u533a\u5207\u308a\u306e\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u308b\u3002\n\n1\u5217\u76ee\u304c\u30aa\u30fc\u30bd\u30ed\u30ac\u30b9\u30b0\u30eb\u30fc\u30d7\u540d(OG)\u3067\u3001\u4ee5\u964d\u304c\u5404OG\u306b\u5c5e\u3059\u308b\u914d\u5217\u306e\u540d\u524d\u306b\u306a\u3063\u3066\u3044\u308b\u3002\n\n```text:OG_list.txt\nOG0000000 fasta_ID_sp_A_seq1 fasta_ID_sp_B_seq2 fasta_ID_sp_C_seq3\nOG0000001 fasta_ID_sp_A_seq2 fasta_ID_sp_B_seq2 fasta_ID_sp_C_seq3 \nOG0000002 fasta_ID_sp_A_seq3 fasta_ID_sp_B_seq2 fasta_ID_sp_C_seq3\n```\n\u3059\u3079\u3066\u306e\u914d\u5217\u60c5\u5831\u304c\u5165\u3063\u3066\u3044\u308bmultiple fasta\u3082\u6e96\u5099\u3059\u308b\u3002\n(\u5404\u751f\u7269\u7a2e\u6bce\u306b\u5168CDS\u60c5\u5831\u3092fasta\u3067\u3068\u3063\u3066\u304d\u3066cat\u3067\u7d50\u5408\u306a\u3069\u3059\u308b\uff09\n\n```fasta:all_seq.fa\n>fasta_ID_sp_A_seq1\nXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX\n>fasta_ID_sp_B_seq2\nXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX\n>fasta_ID_sp_C_seq3\nXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX\n........\n```\n\n#2,OG\u6bce\u306b\u5404\u914d\u5217\u60c5\u5831\u3092\u5225\u30d5\u30a1\u30a4\u30eb\u306b\u3044\u308c\u5206\u3051\u308b\n\n\u4ee5\u4e0b\u306e\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u4f7f\u3063\u3066\u3001\u30c7\u30fc\u30bf\u3092\u5206\u3051\u308b\n\n\u5404OG\u540d\u304c\u30d5\u30a1\u30a4\u30eb\u540d\u306b\u306a\u3063\u305ffasta\u304c\u4f5c\u6210\u3055\u308c\u308b\u3002\n\u5404\u30d5\u30a1\u30a4\u30eb\u306b\u3001\u305d\u308c\u305e\u308c\u306eOG\u306b\u5c5e\u3059\u308b\u914d\u5217\u304c\u5165\u3063\u3066\u3044\u308b\u3002\n\n```python:OG_separater.py\n#!/usr/bin/env python\n# -*- coding: utf-8 -*-\n\nimport sys\nfrom Bio import SeqIO\n\nfasta_in = sys.argv[1]                            #\uff11\u756a\u76ee\u306e\u5f15\u6570\u306b\u306f\u4e0a\u8a18\u306eall_seq.fa\u306a\u3069fasta\u30d5\u30a1\u30a4\u30eb\u3092\u6307\u5b9a\u3059\u308b\nquery_in = sys.argv[2]                            #\uff12\u756a\u76ee\u306e\u5f15\u6570\u306b\u306f\u4e0a\u8a18\u306eOG_list.txt\u306a\u3069\u30aa\u30fc\u30bd\u30ed\u30b0\u30d5\u30a1\u30a4\u30eb\u3092\u6307\u5b9a\u3059\u308b\n\nfor q in open(query_in, \"r\"):                     #\u30aa\u30fc\u30bd\u30ed\u30b0\u30d5\u30a1\u30a4\u30eb\u3092\u958b\u3044\u30661\u884c\u3065\u3064\u8aad\u307f\u8fbc\u3080\n    query = q.split()                             #\u30b9\u30da\u30fc\u30b9\u6bce\u306b\u5207\u308a\u3068\u3063\u3066\u30ea\u30b9\u30c8\u5f62\u5f0f\u3067query\u306b\u4fdd\u5b58\u3059\u308b\n    f = open(query[0], 'w')                       #\u6700\u521d\u306e\u5217(OG\u540d\uff09\u3068\u540c\u3058\u540d\u524d\u306e\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u6210\u3059\u308b\n    for record in SeqIO.parse(fasta_in, 'fasta'): #fasta\u30d5\u30a1\u30a4\u30eb\u3092\u958b\u304fSeqIO\u3092\u4f7f\u3063\u3066\u30d1\u30fc\u30b9\u3059\u308b(1\u9805\u76ee\u3065\u3064\u8aad\u307f\u8fbc\u3080\uff09\n        id_part = record.id                       #fasta\u306eID\u90e8\u5206\u3092\u8aad\u307f\u8fbc\u3080\n        desc_part = record.description            #fasta\u306edescription\u90e8\u5206\u3092\u8aad\u307f\u8fbc\u3080\n        seq = record.seq                          #fastan\u306e\u914d\u5217\u90e8\u5206\u3092\u8aad\u307f\u8fbc\u3080\n        for i in xrange(len(query)):              #\u30aa\u30fc\u30bd\u30ed\u30b0\u30d5\u30a1\u30a4\u30eb\u4e2d\u306e\u5404OG\u306b\u542b\u307e\u308c\u308b\u914d\u5217\u6570\u3092\u6570\u3048\u3066\u3001\u305d\u306e\u5206\u7e70\u308a\u8fd4\u3059\n            if desc_part == query[i] :            #\u30aa\u30fc\u30bd\u30ed\u30b0\u30d5\u30a1\u30a4\u30eb\u306e\u914d\u5217description\u3068fasta\u306e\u914d\u5217description\u304c\u4e00\u81f4\u3057\u305f\u3089\u3001\u3001\u3001\n                fasta_seq = '>' + desc_part + '\\n' + seq + '\\n'     #fasta\u5f62\u5f0f\u306b\u6574\u3048\u3066\n                print(fasta_seq)                  #\u6a19\u6e96\u51fa\u529b\u306bfasta\u3092\u51fa\u529b\uff08\u9032\u884c\u72b6\u6cc1\u628a\u63e1\u7528\uff09\n                f.write(str(fasta_seq))           #\u5404OG\u30d5\u30a1\u30a4\u30eb\u306bfasta\u3092\u51fa\u529b\n    f.close()\n```\n\n#3,\u30a2\u30e9\u30a4\u30e1\u30f3\u30c8\u3068\u30c8\u30ea\u30df\u30f3\u30b0\n\nmafft \u3068 trimal\u3092\u4f7f\u3063\u3066\u5404OG\u30d5\u30a1\u30a4\u30eb\u3092\u30a2\u30e9\u30a4\u30e1\u30f3\u30c8\uff0b\u30c8\u30ea\u30df\u30f3\u30b0\u3059\u308b\n\n```bash:align.sh\n#!/bin/sh\n#$ -S /bin/bash\n#$ -cwd\n#$ -v PATH\nmafft --maxiterate 1000 --localpair --thread 10 $1 > $1.maffted\ntrimal -automated1 -in $1.maffted -out $1.maffted.trimal.fa\n```\n\n#4,\u8907\u6570\u306eOG\u30d5\u30a1\u30a4\u30eb\u304b\u3089\u3001\u9806\u756a\u305d\u306e\u307e\u307e\u3001fasta\u3092\u6a2a\u306b\u7d50\u5408\u3057\u3066\u3044\u304f\n\u9806\u756a\u305d\u306e\u307e\u307e\u3001fasta\u3092\u6a2a\u306b\u7d50\u5408\u3057\u3066\u3044\u304f\uff08bash\u306epaste\u30b3\u30de\u30f3\u30c9\u3063\u307d\u304f\u7d50\u5408\u3059\u308b\uff09\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u4f5c\u6210\u3057\u305f\n\n- \u4f8b\n\n```fasta:GeneA.fa\n>sp1_A\nAAAAAAAAAA\n>sp2_A\nBBBBBBBBB\n>sp3_A\nCCCCCCCCCC\n>sp4_A\nDDDDDDDDDD\n```\n\n```fasta:GeneB.fa\n>sp1_B\nEEEEEEEEEE\n>sp2_B\nFFFFFFFFFF\n>sp3_B\nGGGGGGGGGG\n>sp4_B\nHHHHHHHHHH\n```\n\n```fasta:out.fa\n>sp1_A;sp1_B\nAAAAAAAAAAEEEEEEEEEE\n>sp2_A;sp2_B\nBBBBBBBBBFFFFFFFFFF\n>sp3_A;sp3_B\nCCCCCCCCCCGGGGGGGGGG\n>sp4_A;sp4_B\nDDDDDDDDDDHHHHHHHHHH\n\n```\n\n\n\u7121\u9650\u306b\u5f15\u6570\u3092\u3068\u308c\u308b\u3088\u3046\u306b\u306a\u3063\u3066\u3044\u308b\u306e\u3067\u4ee5\u4e0b\u306e\u69d8\u306b\u30ef\u30a4\u30eb\u30c9\u30ab\u30fc\u30c9\u3092\u3064\u304b\u3063\u3066\u3082OK\n\n```ssh:joint.sh\npython fasta_merge_orderkeep.py *.maffted.trimal.fa\n```\n\n\n\u4ee5\u4e0b\u30b9\u30af\u30ea\u30d7\u30c8\n\n```python:fasta_merge_orderkeep.py\n#!/usr/bin/env python\n# -*- coding: utf-8 -*-\n\n#TARO MAEDA 2017 14 Jul. \n\nimport sys\nfrom Bio import SeqIO\n\nnum_file=len(sys.argv)-1  #\u5165\u529b\u30d5\u30a1\u30a4\u30eb\u6570\u3092\u6570\u3048\u308b\nprint(\"Detected file number\")\nprint(num_file)\n\nid_list = {}              #ID\u306e\u8f9e\u66f8\u3092\u5ba3\u8a00\nseq_list = {}             #seq\u306e\u8f9e\u66f8\u3092\u5ba3\u8a00\ncounter_file = int(\"0\")   #\u30d5\u30a1\u30a4\u30eb\u30ab\u30a6\u30f3\u30bf\u30fc\u3092\u521d\u671f\u5316\n\n\nprint(\"File opening...\") \n\nfor i in xrange(num_file):                    #\u30d5\u30a1\u30a4\u30eb\u6570\u5206\u7e70\u308a\u8fd4\u3059\uff08fasta\u30d5\u30a1\u30a4\u30eb\u306e\u4e2d\u8eab\u3092\u8f9e\u66f8\u306b\u5165\u529b)\n    counter_file += 1                         #\u30d5\u30a1\u30a4\u30eb\u30ab\u30a6\u30f3\u30bf\u30fc\u3092\u307e\u308f\u3059\n    counter_order = int(\"0\")                  #\u30d5\u30a1\u30a4\u30eb\u4e2d\u306efasta\u306e\u9806\u756a\u3092\u30ab\u30a6\u30f3\u30c8\u3059\u308border\u30ab\u30a6\u30f3\u30bf\u30fc\u3092\u521d\u671f\u5316\u3059\u308b\n    for file1 in SeqIO.parse(sys.argv[counter_file], 'fasta'):  #\u5f15\u6570N\u756a\u76ee\u306e\u30d5\u30a1\u30a4\u30eb\u3092\u8aad\u307f\u8fbc\u3080\n        counter_order +=1                     #order\u30ab\u30a6\u30f3\u30bf\u30fc\u3092\u307e\u308f\u3059\n        print(\"now getting \" +  file1.id)     #\u72b6\u6cc1\u78ba\u8a8d\u7528\uff08\u53d6\u308a\u8fbc\u307f\u4e2d\u306efasta id\u3092\u51fa\u529b\u3059\u308b\uff09\n        id_list[\"ID_file\" + str(counter_file) + \"order\" + str(counter_order)] = file1.id    #fastaID\u3092\u8f9e\u66f8\u306b\u5165\u529b\u3057\u3066\u3044\u304f\u3001order\u30ab\u30a6\u30f3\u30bf\u30fc\u3068\u30d5\u30a1\u30a4\u30eb\u30ab\u30a6\u30f3\u30bf\u3067\u30ad\u30fc\u306e\u5024\u3092\u6307\u5b9a\u3057\u3066\u3044\u304f\u3002\n        seq_list[\"Seq_file\" + str(counter_file) + \"order\" + str(counter_order)] = file1.seq #fasta\u306e\u914d\u5217\u60c5\u5831\u3092\u8f9e\u66f8\u306b\u5165\u529b\u3057\u3066\u3044\u304f\u3001order\u30ab\u30a6\u30f3\u30bf\u30fc\u3068\u30d5\u30a1\u30a4\u30eb\u30ab\u30a6\u30f3\u30bf\u3067\u30ad\u30fc\u306e\u5024\u3092\u6307\u5b9a\u3057\u3066\u3044\u304f\u3002\n\n\nmax_count_file = counter_file    #\u6700\u7d42\u7684\u306b\u8aad\u307e\u308c\u305f\u3059\u3079\u3066\u306e\u30d5\u30a1\u30a4\u30eb\u6570\u3092\u7372\u5f97\u3059\u308b\nmax_count_order = counter_order  #\u6700\u7d42\u7684\u306b\u8aad\u307e\u308c\u305f\u3059\u3079\u3066\u306e\u7a2e\u6570\uff081fasta\u30d5\u30a1\u30a4\u30eb\u4e2d\u306efasta\u30c7\u30fc\u30bf\u6570\uff09\u3092\u7372\u5f97\u3059\u308b\nnow_order = int(\"0\")                    #\u4eca\u51fa\u529b\u3057\u3066\u3044\u308b\u7a2e\u304c\u4f55\u756a\u76ee\u306e\u7a2e\u304b\uff08fasta\u30d5\u30a1\u30a4\u30eb\u4e2d\u306e\u4f55\u756a\u76ee\u306efasta\u30c7\u30fc\u30bf\u304b\uff09\u3092\u6570\u3048\u308b\u30ab\u30a6\u30f3\u30bf\u30fc\u3092\u521d\u671f\u5316\u3059\u308b\n\n\nprint(\"File writing...\") \n\n\nf = open(\"marged_out.fa\", 'w')            #\u7d50\u679c\u51fa\u529b\u7528\u30d5\u30a1\u30a4\u30eb\u3092\u958b\u304f\nfor now_order in xrange(max_count_order): #\u7a2e\u6570\u5206\u51e6\u7406\u3092\u7e70\u308a\u8fd4\u3059\n    out_id  = \"\"                          #\u51fa\u529b\u7528\u5909\u6570\u3092\u521d\u671f\u5316\u3059\u308b\u3002\n    out_seq  = \"\"                         #\u51fa\u529b\u7528\u5909\u6570\u3092\u521d\u671f\u5316\u3059\u308b\u3002\n    for now_file in xrange(max_count_file): #\u5168\u30d5\u30a1\u30a4\u30eb\u6570\u5206\u7e70\u308a\u8fd4\u3059\n        out_id += id_list[\"ID_file\" + str(now_file+1) + \"order\" + str(now_order+1)] +\";\" \n        out_seq += str(seq_list[\"Seq_file\" + str(now_file+1) + \"order\" + str(now_order+1)]) \n    outfasta =\">\" + out_id + \"\\n\" + out_seq + \"\\n\"\n    f.write(outfasta)\nf.close()\n\nprint(\"Output file was made as marged_out.fa\") \n```\n", "tags": ["RaxML", "Biopython", "bioinformatics"]}