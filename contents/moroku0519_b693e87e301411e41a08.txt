{"context": "\u524d\u56de\u304b\u3089Chainer\u306e\u57fa\u672c\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306b\u3064\u3044\u3066\uff0c\u79c1\u304c\u52c9\u5f37\u3057\u305f\u3053\u3068\u3092\u66f8\u3044\u3066\u3044\u307e\u3059\uff0e\n\u4eca\u56de\u306fChain\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306b\u3064\u3044\u3066\u66f8\u3044\u3066\u3044\u304d\u307e\u3059\uff0e\n\nChain\n\u524d\u3005\u56de\u306ffunctions\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\uff0c\u524d\u56de\u306flinks\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u7d39\u4ecb\u3057\u307e\u3057\u305f\u304c\uff0c\u4eca\u56de\u306eChain\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306f\u305d\u308c\u3089\u3067\u63d0\u4f9b\u3055\u308c\u308b\u95a2\u6570\u3092\u5408\u6210\u3057\u3066\u30d1\u30e9\u30e1\u30fc\u30bf\u306e\u63a8\u5b9a\u3092\u884c\u3044\u307e\u3059\uff0e\u305d\u306e\u5408\u6210\u95a2\u6570\u3053\u305d\u304c\u30e2\u30c7\u30eb\u3092\u8868\u73fe\u3057\u3066\u3044\u307e\u3059\uff0e\n\u307e\u305a\uff0c\u4ee5\u4e0b\u306e\u56f3\u306e\u3088\u3046\u306a3\u5c64\u304b\u3089\u306a\u308b\u30cb\u30e5\u30fc\u30e9\u30eb\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u3092\u8003\u3048\u307e\u3059\uff0e\n\n\u7b2c1\u5c64\u304b\u3089\u7b2c2\u5c64\u3078\u306e\u5909\u63db\u306flinks\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306e\u969b\u306b\u7d39\u4ecb\u3057\u305f\u3088\u3046\u306b\nv=w1x+b1\u3000...(1)v=w1x+b1\u3000...(1){v = w_1x + b_1\u3000...(1)\n}\n\u3067\u8868\u73fe\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\uff0e\uff08v\u306f\u7b2c2\u5c64\u6642\u70b9\u3067\u306e\u5909\u6570\u306e\u72b6\u614b\uff09\n\u6b21\u306b\uff0c\u7b2c2\u5c64\u304b\u3089\u7b2c3\u5c64\u3078\u306e\u5909\u63db\u306f\ny=w2v+b2...(2)y=w2v+b2...(2){y = w_2v + b_2 ...(2)\n}\n\u3067\u8868\u73fe\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\uff0e\n(1)(2)\u3088\u308a\uff0c\u7b2c1\u5c64\u304b\u3089\u7b2c3\u5c64\u3078\u306e\u5909\u63db\u306f\ny=w2(w1x+b1)+b2...(3)y=w2(w1x+b1)+b2...(3){y = w_2(w_1x + b_1) + b_2 ...(3)\n}\n\u3067\u8868\u3059\u3053\u3068\u304c\u3067\u304d\u307e\u3059\uff0e\n\u3057\u304b\u3057\uff0c\u7b2c2\u5c64\u306b\u306f\u6d3b\u6027\u5316\u95a2\u6570\u3092\u305d\u308c\u305e\u308c\u306e\u30ce\u30fc\u30c9\u3067\u9069\u5fdc\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\uff0e\n\u3088\u3063\u3066\uff0c(3)\u306f\ny=w2\u03b4(w1x+b1)+b2y=w2\u03b4(w1x+b1)+b2{y = w_2\u03b4(w_1x + b_1) + b_2\n}\n\u3068\u8868\u73fe\u3055\u308c\u307e\u3059\uff0e\uff08\u03b4\u306f\u6d3b\u6027\u5316\u95a2\u6570\uff09\n\u3053\u306e\u95a2\u6570\u306ffunctions\u3068links\u306e\u95a2\u6570\u3067\u8868\u73fe\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\uff0e\n\u305d\u306e\u305f\u3081\u306bChain\u30af\u30e9\u30b9\u3092\u7528\u3044\u307e\u3059\uff0e\n\u3053\u3053\u3067\u306fChain\u30af\u30e9\u30b9\u3092\u7d99\u627f\u3057\u305fMyChain\u3092\u4f7f\u3044\u307e\u3059\uff0e\n\u307e\u305a\uff0c\u30b3\u30f3\u30b9\u30c8\u30e9\u30af\u30bf\u306b\u3066\u5c64\u304b\u3089\u5c64\u3078\u306e\u5199\u50cf\u3092links\u306e\u95a2\u6570\u306b\u3088\u3063\u3066\u5217\u6319\u3057\u307e\u3059\uff0e\nclass MyChain(Chain):\n  def __init__(self):\n     super(MyClass, self).__init__(\n       l1 = L.linear(4, 3),\n       l2 = L.linear(3, 3)\n     )\n\n\u305d\u3057\u3066\uff0c\u9806\u65b9\u5411\u306e\u8a08\u7b97\uff0c\u3059\u306a\u308f\u3061\u6d3b\u6027\u5316\u95a2\u6570\u306e\u51e6\u7406\u3092\u30e1\u30bd\u30c3\u30c9\u3068\u3057\u3066\u5b9a\u7fa9\u3057\u307e\u3059\uff0e\ndef forward(self, x):\n  return F.sigmoid(self.l1(x)):\n\n\u305d\u3057\u3066\uff0c\u640d\u5931\u95a2\u6570\uff08\u8aa4\u5dee\u95a2\u6570\uff09\u3092call\u306b\u66f8\u304d\u307e\u3059\uff0emean_squqred_error\u306f\u4e8c\u4e57\u8aa4\u5dee\u95a2\u6570\u3067\u3059\uff0e\ndef __call__(self, x, y):\n  result = self.forward(x)\n  loss = F.mean_squared_error(result, y)\n  return loss\n\n\u3053\u308c\u3067\u8aa4\u5dee\u306e\u8a08\u7b97\u307e\u3067\u884c\u3046\u3053\u3068\u304c\u3067\u304d\u307e\u3059\uff0e\n\u4eca\u56de\u306f\u3053\u3053\u307e\u3067\uff0e\n\u6b21\u56de\u306foptimizers\u306b\u3064\u3044\u3066\u66f8\u304d\u307e\u3059\uff0e\n\n\u53c2\u8003\n\u65b0\u7d0d\u6d69\u5e78\nChainer\u306b\u3088\u308b\u5b9f\u8df5\u6df1\u5c64\u5b66\u7fd2\uff5e\u8907\u96d1\u306aNN\u306e\u5b9f\u88c5\u65b9\u6cd5\uff5e\u3000\u30aa\u30fc\u30e0\u793e\n\u524d\u56de\u304b\u3089Chainer\u306e\u57fa\u672c\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306b\u3064\u3044\u3066\uff0c\u79c1\u304c\u52c9\u5f37\u3057\u305f\u3053\u3068\u3092\u66f8\u3044\u3066\u3044\u307e\u3059\uff0e\n\u4eca\u56de\u306fChain\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306b\u3064\u3044\u3066\u66f8\u3044\u3066\u3044\u304d\u307e\u3059\uff0e\n\n#Chain\n[\u524d\u3005\u56de](http://qiita.com/moroku0519/items/6b2075b8c6facc36e7da)\u306ffunctions\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\uff0c[\u524d\u56de](http://qiita.com/moroku0519/items/d648bd2ed3d1001f7f16)\u306flinks\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u7d39\u4ecb\u3057\u307e\u3057\u305f\u304c\uff0c\u4eca\u56de\u306eChain\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306f\u305d\u308c\u3089\u3067\u63d0\u4f9b\u3055\u308c\u308b\u95a2\u6570\u3092\u5408\u6210\u3057\u3066\u30d1\u30e9\u30e1\u30fc\u30bf\u306e\u63a8\u5b9a\u3092\u884c\u3044\u307e\u3059\uff0e\u305d\u306e\u5408\u6210\u95a2\u6570\u3053\u305d\u304c\u30e2\u30c7\u30eb\u3092\u8868\u73fe\u3057\u3066\u3044\u307e\u3059\uff0e\n\n\u307e\u305a\uff0c\u4ee5\u4e0b\u306e\u56f3\u306e\u3088\u3046\u306a3\u5c64\u304b\u3089\u306a\u308b\u30cb\u30e5\u30fc\u30e9\u30eb\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u3092\u8003\u3048\u307e\u3059\uff0e\n![Chain.png](https://qiita-image-store.s3.amazonaws.com/0/28622/8a14bc85-9363-5046-f6df-5322164bd06e.png)\n\n\u7b2c1\u5c64\u304b\u3089\u7b2c2\u5c64\u3078\u306e\u5909\u63db\u306f[links\u30aa\u30d6\u30b8\u30a7\u30af\u30c8](http://qiita.com/moroku0519/items/d648bd2ed3d1001f7f16)\u306e\u969b\u306b\u7d39\u4ecb\u3057\u305f\u3088\u3046\u306b\n\n```math\nv = w_1x + b_1\u3000...(1)\n```\n\n\u3067\u8868\u73fe\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\uff0e\uff08v\u306f\u7b2c2\u5c64\u6642\u70b9\u3067\u306e\u5909\u6570\u306e\u72b6\u614b\uff09\n\u6b21\u306b\uff0c\u7b2c2\u5c64\u304b\u3089\u7b2c3\u5c64\u3078\u306e\u5909\u63db\u306f\n\n```math\ny = w_2v + b_2 ...(2)\n```\n\n\u3067\u8868\u73fe\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\uff0e\n(1)(2)\u3088\u308a\uff0c\u7b2c1\u5c64\u304b\u3089\u7b2c3\u5c64\u3078\u306e\u5909\u63db\u306f\n\n```math\ny = w_2(w_1x + b_1) + b_2 ...(3)\n```\n\n\u3067\u8868\u3059\u3053\u3068\u304c\u3067\u304d\u307e\u3059\uff0e\n\u3057\u304b\u3057\uff0c\u7b2c2\u5c64\u306b\u306f\u6d3b\u6027\u5316\u95a2\u6570\u3092\u305d\u308c\u305e\u308c\u306e\u30ce\u30fc\u30c9\u3067\u9069\u5fdc\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\uff0e\n\u3088\u3063\u3066\uff0c(3)\u306f\n\n```math\ny = w_2\u03b4(w_1x + b_1) + b_2\n```\n\n\u3068\u8868\u73fe\u3055\u308c\u307e\u3059\uff0e\uff08\u03b4\u306f\u6d3b\u6027\u5316\u95a2\u6570\uff09\n\n\u3053\u306e\u95a2\u6570\u306ffunctions\u3068links\u306e\u95a2\u6570\u3067\u8868\u73fe\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\uff0e\n\u305d\u306e\u305f\u3081\u306bChain\u30af\u30e9\u30b9\u3092\u7528\u3044\u307e\u3059\uff0e\n\n\u3053\u3053\u3067\u306fChain\u30af\u30e9\u30b9\u3092\u7d99\u627f\u3057\u305fMyChain\u3092\u4f7f\u3044\u307e\u3059\uff0e\n\n\u307e\u305a\uff0c\u30b3\u30f3\u30b9\u30c8\u30e9\u30af\u30bf\u306b\u3066\u5c64\u304b\u3089\u5c64\u3078\u306e\u5199\u50cf\u3092links\u306e\u95a2\u6570\u306b\u3088\u3063\u3066\u5217\u6319\u3057\u307e\u3059\uff0e\n\n```\nclass MyChain(Chain):\n  def __init__(self):\n     super(MyClass, self).__init__(\n       l1 = L.linear(4, 3),\n       l2 = L.linear(3, 3)\n     )\n```\n\n\u305d\u3057\u3066\uff0c\u9806\u65b9\u5411\u306e\u8a08\u7b97\uff0c\u3059\u306a\u308f\u3061\u6d3b\u6027\u5316\u95a2\u6570\u306e\u51e6\u7406\u3092\u30e1\u30bd\u30c3\u30c9\u3068\u3057\u3066\u5b9a\u7fa9\u3057\u307e\u3059\uff0e\n\n```\ndef forward(self, x):\n  return F.sigmoid(self.l1(x)):\n```\n\u305d\u3057\u3066\uff0c\u640d\u5931\u95a2\u6570\uff08\u8aa4\u5dee\u95a2\u6570\uff09\u3092__call__\u306b\u66f8\u304d\u307e\u3059\uff0emean_squqred_error\u306f\u4e8c\u4e57\u8aa4\u5dee\u95a2\u6570\u3067\u3059\uff0e\n\n```\ndef __call__(self, x, y):\n  result = self.forward(x)\n  loss = F.mean_squared_error(result, y)\n  return loss\n```\n\n\u3053\u308c\u3067\u8aa4\u5dee\u306e\u8a08\u7b97\u307e\u3067\u884c\u3046\u3053\u3068\u304c\u3067\u304d\u307e\u3059\uff0e\n\u4eca\u56de\u306f\u3053\u3053\u307e\u3067\uff0e\n\u6b21\u56de\u306foptimizers\u306b\u3064\u3044\u3066\u66f8\u304d\u307e\u3059\uff0e\n\n#\u53c2\u8003\n\u65b0\u7d0d\u6d69\u5e78\nChainer\u306b\u3088\u308b\u5b9f\u8df5\u6df1\u5c64\u5b66\u7fd2\uff5e\u8907\u96d1\u306aNN\u306e\u5b9f\u88c5\u65b9\u6cd5\uff5e\u3000\u30aa\u30fc\u30e0\u793e\n\n\n\n", "tags": ["Chainer"]}