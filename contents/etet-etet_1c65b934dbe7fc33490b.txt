{"context": "\u7c21\u5358\u306aWeb\u30a2\u30d7\u30ea\u3092\u4f5c\u308b\u6a5f\u4f1a\u304c\u3042\u3063\u305f\u306e\u3067\u3001Node.js + Express\u5165\u9580\u3057\u3066\u307f\u305f\u3002\n\nNode.js\u3068npm\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\nnodebrew\u3092\u5165\u308c\u308b\u3002\n$ curl -L git.io/nodebrew | perl - setup\n\n.bash_profile\u7b49\u306b\u30d1\u30b9\u3092\u8ffd\u52a0\nexport PATH=$HOME/.nodebrew/current/bin:$PATH\n\n$ nodebrew -v\nnodebrew 0.9.6\n\n$ nodebrew ls\nv4.6.2\nv6.9.1\nv7.1.0\n\ncurrent: nonde\n$ nodebrew use v6.9.1\n$ nodebrew ls\nv4.6.2\nv6.9.1\nv7.1.0\n\ncurrent: v6.9.1\n$ npm -v\n3.10.8\n\n\nExpress\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\nnpm\u3067\u7c21\u5358\u306b\u5c0e\u5165\n$ npm install -g express\n\n\u305f\u3060\u3001\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u4f5c\u308b\u3068\u304d\u306b\u306fexpress-generator\u304c\u3042\u308b\u3068\u3088\u308a\u7c21\u5358\u306a\u306e\u3067\u3053\u308c\u3082\u5165\u308c\u308b\n$ npm install -g express-generator\n\n\nExpress\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092\u4f5c\u6210\nexpress-generator\u306b\u3088\u308a\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u304c\u751f\u6210\u3055\u308c\u308b\u3002\n\u4f7f\u3044\u65b9\u306frails\u306egenerate\u3068\u4f3c\u305f\u3088\u3046\u306a\u611f\u3058\u3002\n\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u30a8\u30f3\u30b8\u30f3\u3092jade\u306b\u3057\u305f\u3044\u5834\u5408\u306f\u3001warning\u3067--view=jade\u3092\u6307\u5b9a\u3059\u308b\u3088\u3046\u306b\u6012\u3089\u308c\u3066\u3044\u308b\u304c\u4eca\u56de\u306f\u305d\u306e\u307e\u307e\u30b9\u30eb\u30fc\u3002\u5c06\u6765\u7684\u306b\u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u306a\u304f\u306a\u308b\u3089\u3057\u3044\u3002\n$ express sampleapp\n\n  warning: the default view engine will not be jade in future releases\n  warning: use `--view=jade' or `--help' for additional options\n\n\n   create : sampleapp\n   create : sampleapp/package.json\n   create : sampleapp/app.js\n   create : sampleapp/public\n   create : sampleapp/public/javascripts\n   create : sampleapp/public/images\n   create : sampleapp/routes\n   create : sampleapp/routes/index.js\n   create : sampleapp/routes/users.js\n   create : sampleapp/public/stylesheets\n   create : sampleapp/public/stylesheets/style.css\n   create : sampleapp/views\n   create : sampleapp/views/index.jade\n   create : sampleapp/views/layout.jade\n   create : sampleapp/views/error.jade\n   create : sampleapp/bin\n   create : sampleapp/bin/www\n\n   install dependencies:\n     $ cd sampleapp && npm install\n\n   run the app:\n     $ DEBUG=sampleapp:* npm start\n\n\u4f9d\u5b58\u30e2\u30b8\u30e5\u30fc\u30eb\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n$ npm install\n\n\n\u7acb\u3061\u4e0a\u3052\u3066\u307f\u308b\nExpress\u3092\u8d77\u52d5\u3057\u3066\u30d6\u30e9\u30a6\u30b6\u3067\u30a2\u30af\u30bb\u30b9(localhost:3000)\n$ npm start\n\u53c8\u306f\n$ node bin/www\n\n\u69cb\u7bc9\u5b8c\u4e86\u3002\n\n\n\u3082\u3046\u5c11\u3057\u7d30\u304b\u304f\u898b\u3066\u307f\u308b\n\napp.js\u3068routing\n\u3053\u3053\u306b\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306b\u95a2\u3059\u308b\u8a18\u8ff0\u304c\u5165\u3063\u3066\u3044\u308b\u3002\nvar index = require('./routes/index');\nvar users = require('./routes/users');\n...\napp.use('/', index);\napp.use('/users', users);\n\n\u3053\u306e\u3088\u3046\u306a\u8a18\u8ff0\u304c\u3042\u308a\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u52d5\u304f\u3002\nURL\u3067document root ('/')\u306b\u30a2\u30af\u30bb\u30b9\u3057\u305f\u6642\u306b\u306f\u3001routes/index.js\u304c\u8aad\u307f\u8fbc\u307e\u308c\u305d\u3053\u306b\u8a18\u8ff0\u3057\u305f\u51e6\u7406\u304c\u9069\u7528\u3055\u308c\u308b\u3002\nroutes/index.js\u3092\u898b\u3066\u307f\u308b\u3068\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u306a\u3063\u3066\u304a\u308a\u3001GET\u304c\u5b9a\u7fa9\u3055\u308c\u3066\u3044\u308b\u3002\n/* GET home page. */\nrouter.get('/', function(req, res, next) {\n  res.render('index', { title: 'Express' });\n});\n\n\u305f\u3068\u3048\u3070\u3053\u3053\u306b\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u5909\u3048\u305f\u5834\u5408\u3001/hogehoge\u3067\u30a2\u30af\u30bb\u30b9\u51fa\u6765\u308b\u3002\n/* GET home page. */\nrouter.get('/hogehoge', function(req, res, next) {\n  res.render('index', { title: 'Express' });\n});\n\n\u307e\u305f\u3001app.use\u306e\u90e8\u5206\u3092\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u5909\u3048\u308b\u3068\u3001\u9055\u3046\u30d1\u30b9\u306b\u30de\u30a6\u30f3\u30c8\u3055\u308c\u308b\u611f\u3058\u3067\u7528\u610f\u306b\u5207\u308a\u66ff\u3048\u308b\u3053\u3068\u304c\u3067\u304d\u308b\u3089\u3057\u3044\u3002\n\u3053\u3046\u3059\u308b\u3068\u3001/hoge/hogehoge\u3068\u3044\u3046\u30d1\u30b9\u3067\u30a2\u30af\u30bb\u30b9\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u308b\u3002\nvar index = require('./routes/index');\nvar users = require('./routes/users');\n...\n// app.use('/', index); \u4ee5\u4e0b\u306e\u3088\u3046\u306b\u5909\u3048\u3066\u307f\u308b\napp.use('/hoge', index);\napp.use('/users', users);\n\napp.use\u306e\u4ed6\u306b\u3082\u3001app.get\u3084app.post\u3067\u76f4\u63a5\u30d1\u30b9\u3092\u6307\u5b9a\u3067\u304d\u308b\u304c\u3001\u62e1\u5f35\u6027\u306a\u3069\u3092\u8003\u3048\u308b\u3068app.use\u3068\u3059\u308b\u306e\u304c\u4fbf\u5229\u305d\u3046\u3002\n\nnpm forever\u3092\u4f7f\u3063\u3066\u30c7\u30fc\u30e2\u30f3\u5316\nnode bin/www\u306e\u8d77\u52d5\u3060\u3068\u3001\u30b3\u30de\u30f3\u30c9\u7d42\u4e86\u3059\u308b\u3068\u30b5\u30fc\u30d0\u3082\u505c\u6b62\u3057\u3066\u3057\u307e\u3046\u305f\u3081\u3001forever\u3068\u3044\u3046\u3082\u306e\u3092\u4f7f\u3063\u3066\u307f\u308b\u3002\n\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n$ npm install forver -g\n\nforever\u3092\u4f7f\u3063\u3066\u8d77\u52d5\u3059\u308b\n$ forever start bin/www\nwarn:    --minUptime not set. Defaulting to: 1000ms\nwarn:    --spinSleepTime not set. Your script will exit if it does not stay up for at least 1000ms\ninfo:    Forever processing file: bin/www\n$\n\n\u3053\u306e\u8d77\u52d5\u306e\u5834\u5408\u306f\u3001\u30ed\u30b0\u30d5\u30a1\u30a4\u30eb\u540d\u306f\u8d77\u52d5\u6bce\u306b\u5909\u308f\u308a~/.forever/xxx.log\u306b\u51fa\u529b\u3055\u308c\u308b\u3002\n\u30ed\u30b0\u30d5\u30a1\u30a4\u30eb\u540d\u3092\u6307\u5b9a\u3059\u308b\u5834\u5408\u306f\u30aa\u30d7\u30b7\u30e7\u30f3\u3092\u4ed8\u3051\u3066\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u3059\u308b\u3002\n$ forever start -a -l app.log -e error.log bin/www\n\n\u203b-a\u3092\u4ed8\u3051\u306a\u3044\u3068\u3001\u6b21\u56de\u8d77\u52d5\u6642\u306b\u4e0b\u8a18\u306e\u3088\u3046\u306b\u6012\u3089\u308c\u308b\nerror:   Cannot start forever\nerror:   log file /xxxxxx/.forever/app.log exists. Use the -a or --append option to append log.\n\n\u8d77\u52d5\u5f8c\u306e\u78ba\u8a8d\n$ forever list\ninfo:    Forever processes running\ndata:        uid  command                                          script  forever pid   id logfile                             uptime\ndata:    [0] FRen /Users/xxxxxx/.nodebrew/node/v6.9.1/bin/node bin/www 61131   61132    /Users/xxxxxx/.forever/FRen.log 0:0:0:18.592\n$\n\n\u30d7\u30ed\u30bb\u30b9\u304c\u8d77\u52d5\u3057\u3066\u3044\u308b\u306e\u304c\u5206\u304b\u308b\u3002\n\u505c\u6b62\u3059\u308b\u3068\u304d\u306f\u3001\n$ forever stop bin/www\ninfo:    Forever stopped process:\n    uid  command                                          script  forever pid   id logfile                             uptime\n[0] FRen /Users/xxxxxx/.nodebrew/node/v6.9.1/bin/node bin/www 61131   61132    /Users/xxxxxx/.forever/FRen.log 0:0:1:42.953\n\n\n\u74b0\u5883\u306e\u5207\u308a\u66ff\u3048\n\u8d77\u52d5\u6642\u306bNODE_ENV\u3092\u6307\u5b9a\u3059\u308b\u3053\u3068\u3067\u3001\u74b0\u5883\u3054\u3068\u306e\u8a2d\u5b9a\u3092\u3059\u308b\u3002\n$ NODE_ENV=development forever start bin/www // \u958b\u767a\n$ NODE_ENV=stage forever start bin/www // \u30b9\u30c6\u30fc\u30b8\u30f3\u30b0\n$ NODE_ENV=production forever start bin/www // \u672c\u756a\n\n\u3042\u3068\u306fconfig\u306eyml\u304b\u306a\u3093\u304b\u3092\u4f5c\u3063\u3066\u3001ENV\u3092\u8aad\u307f\u8fbc\u3081\u308b\u3088\u3046\u306b\u3059\u308b\u3002\n\u4ee5\u4e0b\u306fdatabase\u63a5\u7d9a\u3092\u74b0\u5883\u3054\u3068\u306b\u5206\u3051\u308b\u4f8b\u3002\n\nconfig/config.yml\nenv:\n  development:\n    database:\n      host: localhost\n      port: 5432\n      user: localuser\n      password: localpass\n\n  stage:\n    database:\n      host: xxx.xxx.xx.xxx // DB\u30b5\u30fc\u30d0\u306eIP\n      port: 5432\n      user: user1\n      password: xxxxx\n\n  production:\n    database:\n      host: yyy.yyy.yy.yyy // DB\u30b5\u30fc\u30d0\u306eIP\n      port: 5432\n      user: user1\n      password: yyyyy\n\n\n\nconfig/config.js\n'use strict'\n\nvar jsYaml = require('js-yaml')\n  , fs = require('fs')\n  , yml = jsYaml.safeLoad(fs.readFileSync(__dirname + '/config.yml', 'utf8'))\n  ;\n\nexports.getEnvConfig = getEnvConfig;\n\nfunction getEnvConfig() {\n  var currentEnv = process.env.NODE_ENV || 'production' // \u3053\u3053\u3067\u8d77\u52d5\u6642\u306b\u8a2d\u5b9a\u3057\u305f\u3082\u306e\u3092\u8aad\u307f\u8fbc\u3080\n    ;\n\n  return yml.env[currentEnv];\n}\n\n\n\u4f7f\u3046\u5074\u306e\u4f8b\n'use strict'\n\nvar options = {}\n  , config = require('../config/config')\n  , dbConfig = config.getConfig()['database']\n  , pgp = require(\"pg-promise\")(options)\n  , connection = {}\n  , db = null\n  ;\n\nconnection = {\n    host: dbConfig.host,\n    port: dbConfig.port,\n    database: 'db_name',\n    user: dbConfig.user,\n    password: dbConfig.password\n};\ndb = pgp(connection);\n\nmodule.exports = db;\n\n\u7c21\u5358\u306aWeb\u30a2\u30d7\u30ea\u3092\u4f5c\u308b\u6a5f\u4f1a\u304c\u3042\u3063\u305f\u306e\u3067\u3001Node.js + Express\u5165\u9580\u3057\u3066\u307f\u305f\u3002\n\n# Node.js\u3068npm\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\nnodebrew\u3092\u5165\u308c\u308b\u3002\n\n```\n$ curl -L git.io/nodebrew | perl - setup\n```\n\n.bash_profile\u7b49\u306b\u30d1\u30b9\u3092\u8ffd\u52a0\n\n```\nexport PATH=$HOME/.nodebrew/current/bin:$PATH\n```\n\n```\n$ nodebrew -v\nnodebrew 0.9.6\n```\n\n```\n$ nodebrew ls\nv4.6.2\nv6.9.1\nv7.1.0\n\ncurrent: nonde\n$ nodebrew use v6.9.1\n$ nodebrew ls\nv4.6.2\nv6.9.1\nv7.1.0\n\ncurrent: v6.9.1\n$ npm -v\n3.10.8\n```\n\n# Express\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\nnpm\u3067\u7c21\u5358\u306b\u5c0e\u5165\n\n```\n$ npm install -g express\n```\n\n\u305f\u3060\u3001\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u4f5c\u308b\u3068\u304d\u306b\u306fexpress-generator\u304c\u3042\u308b\u3068\u3088\u308a\u7c21\u5358\u306a\u306e\u3067\u3053\u308c\u3082\u5165\u308c\u308b\n\n```\n$ npm install -g express-generator\n```\n\n# Express\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092\u4f5c\u6210\nexpress-generator\u306b\u3088\u308a\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u304c\u751f\u6210\u3055\u308c\u308b\u3002\n\u4f7f\u3044\u65b9\u306frails\u306egenerate\u3068\u4f3c\u305f\u3088\u3046\u306a\u611f\u3058\u3002\n\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u30a8\u30f3\u30b8\u30f3\u3092jade\u306b\u3057\u305f\u3044\u5834\u5408\u306f\u3001warning\u3067--view=jade\u3092\u6307\u5b9a\u3059\u308b\u3088\u3046\u306b\u6012\u3089\u308c\u3066\u3044\u308b\u304c\u4eca\u56de\u306f\u305d\u306e\u307e\u307e\u30b9\u30eb\u30fc\u3002\u5c06\u6765\u7684\u306b\u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u306a\u304f\u306a\u308b\u3089\u3057\u3044\u3002\n\n```\n$ express sampleapp\n\n  warning: the default view engine will not be jade in future releases\n  warning: use `--view=jade' or `--help' for additional options\n\n\n   create : sampleapp\n   create : sampleapp/package.json\n   create : sampleapp/app.js\n   create : sampleapp/public\n   create : sampleapp/public/javascripts\n   create : sampleapp/public/images\n   create : sampleapp/routes\n   create : sampleapp/routes/index.js\n   create : sampleapp/routes/users.js\n   create : sampleapp/public/stylesheets\n   create : sampleapp/public/stylesheets/style.css\n   create : sampleapp/views\n   create : sampleapp/views/index.jade\n   create : sampleapp/views/layout.jade\n   create : sampleapp/views/error.jade\n   create : sampleapp/bin\n   create : sampleapp/bin/www\n\n   install dependencies:\n     $ cd sampleapp && npm install\n\n   run the app:\n     $ DEBUG=sampleapp:* npm start\n```\n\n\u4f9d\u5b58\u30e2\u30b8\u30e5\u30fc\u30eb\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n```\n$ npm install\n```\n\n# \u7acb\u3061\u4e0a\u3052\u3066\u307f\u308b\nExpress\u3092\u8d77\u52d5\u3057\u3066\u30d6\u30e9\u30a6\u30b6\u3067\u30a2\u30af\u30bb\u30b9(localhost:3000)\n\n```\n$ npm start\n\u53c8\u306f\n$ node bin/www\n```\n\n\u69cb\u7bc9\u5b8c\u4e86\u3002\n\n<img width=\"1285\" alt=\"Screen Shot 2016-12-07 at 11.14.39 AM.png\" src=\"https://qiita-image-store.s3.amazonaws.com/0/29379/6e267d6e-c692-934d-12d2-26a33e1b6bd6.png\">\n\n# \u3082\u3046\u5c11\u3057\u7d30\u304b\u304f\u898b\u3066\u307f\u308b\n## app.js\u3068routing\n\u3053\u3053\u306b\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306b\u95a2\u3059\u308b\u8a18\u8ff0\u304c\u5165\u3063\u3066\u3044\u308b\u3002\n\n```js\nvar index = require('./routes/index');\nvar users = require('./routes/users');\n...\napp.use('/', index);\napp.use('/users', users);\n```\n\n\u3053\u306e\u3088\u3046\u306a\u8a18\u8ff0\u304c\u3042\u308a\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u52d5\u304f\u3002\nURL\u3067document root ('/')\u306b\u30a2\u30af\u30bb\u30b9\u3057\u305f\u6642\u306b\u306f\u3001routes/index.js\u304c\u8aad\u307f\u8fbc\u307e\u308c\u305d\u3053\u306b\u8a18\u8ff0\u3057\u305f\u51e6\u7406\u304c\u9069\u7528\u3055\u308c\u308b\u3002\nroutes/index.js\u3092\u898b\u3066\u307f\u308b\u3068\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u306a\u3063\u3066\u304a\u308a\u3001GET\u304c\u5b9a\u7fa9\u3055\u308c\u3066\u3044\u308b\u3002\n\n```js\n/* GET home page. */\nrouter.get('/', function(req, res, next) {\n  res.render('index', { title: 'Express' });\n});\n```\n\n\u305f\u3068\u3048\u3070\u3053\u3053\u306b\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u5909\u3048\u305f\u5834\u5408\u3001/hogehoge\u3067\u30a2\u30af\u30bb\u30b9\u51fa\u6765\u308b\u3002\n\n\n```js\n/* GET home page. */\nrouter.get('/hogehoge', function(req, res, next) {\n  res.render('index', { title: 'Express' });\n});\n```\n\n\u307e\u305f\u3001app.use\u306e\u90e8\u5206\u3092\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u5909\u3048\u308b\u3068\u3001\u9055\u3046\u30d1\u30b9\u306b\u30de\u30a6\u30f3\u30c8\u3055\u308c\u308b\u611f\u3058\u3067\u7528\u610f\u306b\u5207\u308a\u66ff\u3048\u308b\u3053\u3068\u304c\u3067\u304d\u308b\u3089\u3057\u3044\u3002\n\u3053\u3046\u3059\u308b\u3068\u3001/hoge/hogehoge\u3068\u3044\u3046\u30d1\u30b9\u3067\u30a2\u30af\u30bb\u30b9\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u308b\u3002\n\n```js\nvar index = require('./routes/index');\nvar users = require('./routes/users');\n...\n// app.use('/', index); \u4ee5\u4e0b\u306e\u3088\u3046\u306b\u5909\u3048\u3066\u307f\u308b\napp.use('/hoge', index);\napp.use('/users', users);\n```\n\napp.use\u306e\u4ed6\u306b\u3082\u3001app.get\u3084app.post\u3067\u76f4\u63a5\u30d1\u30b9\u3092\u6307\u5b9a\u3067\u304d\u308b\u304c\u3001\u62e1\u5f35\u6027\u306a\u3069\u3092\u8003\u3048\u308b\u3068app.use\u3068\u3059\u308b\u306e\u304c\u4fbf\u5229\u305d\u3046\u3002\n\n## npm forever\u3092\u4f7f\u3063\u3066\u30c7\u30fc\u30e2\u30f3\u5316\nnode bin/www\u306e\u8d77\u52d5\u3060\u3068\u3001\u30b3\u30de\u30f3\u30c9\u7d42\u4e86\u3059\u308b\u3068\u30b5\u30fc\u30d0\u3082\u505c\u6b62\u3057\u3066\u3057\u307e\u3046\u305f\u3081\u3001[forever](https://www.npmjs.com/package/forever)\u3068\u3044\u3046\u3082\u306e\u3092\u4f7f\u3063\u3066\u307f\u308b\u3002\n\n\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n```\n$ npm install forver -g\n```\n\nforever\u3092\u4f7f\u3063\u3066\u8d77\u52d5\u3059\u308b\n\n```\n$ forever start bin/www\nwarn:    --minUptime not set. Defaulting to: 1000ms\nwarn:    --spinSleepTime not set. Your script will exit if it does not stay up for at least 1000ms\ninfo:    Forever processing file: bin/www\n$\n```\n\n\u3053\u306e\u8d77\u52d5\u306e\u5834\u5408\u306f\u3001\u30ed\u30b0\u30d5\u30a1\u30a4\u30eb\u540d\u306f\u8d77\u52d5\u6bce\u306b\u5909\u308f\u308a```~/.forever/xxx.log```\u306b\u51fa\u529b\u3055\u308c\u308b\u3002\n\n\u30ed\u30b0\u30d5\u30a1\u30a4\u30eb\u540d\u3092\u6307\u5b9a\u3059\u308b\u5834\u5408\u306f\u30aa\u30d7\u30b7\u30e7\u30f3\u3092\u4ed8\u3051\u3066\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u3059\u308b\u3002\n\n```\n$ forever start -a -l app.log -e error.log bin/www\n```\n\n\u203b-a\u3092\u4ed8\u3051\u306a\u3044\u3068\u3001\u6b21\u56de\u8d77\u52d5\u6642\u306b\u4e0b\u8a18\u306e\u3088\u3046\u306b\u6012\u3089\u308c\u308b\n\n```\nerror:   Cannot start forever\nerror:   log file /xxxxxx/.forever/app.log exists. Use the -a or --append option to append log.\n```\n\n\u8d77\u52d5\u5f8c\u306e\u78ba\u8a8d\n\n```\n$ forever list\ninfo:    Forever processes running\ndata:        uid  command                                          script  forever pid   id logfile                             uptime\ndata:    [0] FRen /Users/xxxxxx/.nodebrew/node/v6.9.1/bin/node bin/www 61131   61132    /Users/xxxxxx/.forever/FRen.log 0:0:0:18.592\n$\n```\n\n\u30d7\u30ed\u30bb\u30b9\u304c\u8d77\u52d5\u3057\u3066\u3044\u308b\u306e\u304c\u5206\u304b\u308b\u3002\n\u505c\u6b62\u3059\u308b\u3068\u304d\u306f\u3001\n\n```\n$ forever stop bin/www\ninfo:    Forever stopped process:\n    uid  command                                          script  forever pid   id logfile                             uptime\n[0] FRen /Users/xxxxxx/.nodebrew/node/v6.9.1/bin/node bin/www 61131   61132    /Users/xxxxxx/.forever/FRen.log 0:0:1:42.953\n```\n\n## \u74b0\u5883\u306e\u5207\u308a\u66ff\u3048\n\u8d77\u52d5\u6642\u306bNODE_ENV\u3092\u6307\u5b9a\u3059\u308b\u3053\u3068\u3067\u3001\u74b0\u5883\u3054\u3068\u306e\u8a2d\u5b9a\u3092\u3059\u308b\u3002\n\n```\n$ NODE_ENV=development forever start bin/www // \u958b\u767a\n$ NODE_ENV=stage forever start bin/www // \u30b9\u30c6\u30fc\u30b8\u30f3\u30b0\n$ NODE_ENV=production forever start bin/www // \u672c\u756a\n```\n\n\u3042\u3068\u306fconfig\u306eyml\u304b\u306a\u3093\u304b\u3092\u4f5c\u3063\u3066\u3001ENV\u3092\u8aad\u307f\u8fbc\u3081\u308b\u3088\u3046\u306b\u3059\u308b\u3002\n\u4ee5\u4e0b\u306fdatabase\u63a5\u7d9a\u3092\u74b0\u5883\u3054\u3068\u306b\u5206\u3051\u308b\u4f8b\u3002\n\n```yaml:config/config.yml\nenv:\n  development:\n    database:\n      host: localhost\n      port: 5432\n      user: localuser\n      password: localpass\n\n  stage:\n    database:\n      host: xxx.xxx.xx.xxx // DB\u30b5\u30fc\u30d0\u306eIP\n      port: 5432\n      user: user1\n      password: xxxxx\n\n  production:\n    database:\n      host: yyy.yyy.yy.yyy // DB\u30b5\u30fc\u30d0\u306eIP\n      port: 5432\n      user: user1\n      password: yyyyy\n```\n\n```js:config/config.js\n'use strict'\n\nvar jsYaml = require('js-yaml')\n  , fs = require('fs')\n  , yml = jsYaml.safeLoad(fs.readFileSync(__dirname + '/config.yml', 'utf8'))\n  ;\n\nexports.getEnvConfig = getEnvConfig;\n\nfunction getEnvConfig() {\n  var currentEnv = process.env.NODE_ENV || 'production' // \u3053\u3053\u3067\u8d77\u52d5\u6642\u306b\u8a2d\u5b9a\u3057\u305f\u3082\u306e\u3092\u8aad\u307f\u8fbc\u3080\n    ;\n\n  return yml.env[currentEnv];\n}\n```\n\n\u4f7f\u3046\u5074\u306e\u4f8b\n\n```js\n'use strict'\n\nvar options = {}\n  , config = require('../config/config')\n  , dbConfig = config.getConfig()['database']\n  , pgp = require(\"pg-promise\")(options)\n  , connection = {}\n  , db = null\n  ;\n\nconnection = {\n    host: dbConfig.host,\n    port: dbConfig.port,\n    database: 'db_name',\n    user: dbConfig.user,\n    password: dbConfig.password\n};\ndb = pgp(connection);\n\nmodule.exports = db;\n```\n\n", "tags": ["Node.js", "Express", "JavaScript", "npm"]}