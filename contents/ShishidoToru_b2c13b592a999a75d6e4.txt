{"context": "\u3000\u3053\u308c\u304b\u3089\u6642\u3005GAS\u306b\u3064\u3044\u3066\u6295\u7a3f\u3057\u3066\u3044\u3053\u3046\u3068\u601d\u3044\u307e\u3059\u3002GAS\u306e\u8aad\u307f\u65b9\u3067\u3059\u304c\u79c1\u306f\u300c\u30ae\u30e3\u30b9\u300d\u3068\u547c\u3076\u3088\u3046\u306b\u3057\u3066\u3044\u307e\u3059\uff08\u300c\u30ac\u30b9\u300d\u3088\u308a\u3082\u683c\u597d\u3044\u3044\u97ff\u304d\u3067\u306f\u306a\u3044\u304b\u3068\uff09\u3002\n\u3000\u3055\u3066\u3001\u90f5\u4fbf\u5c40\u306e\u30b5\u30a4\u30c8\u306e\u306a\u304b\u306b\u3042\u308b\u3001\u90f5\u4fbf\u756a\u53f7\u30c7\u30fc\u30bf\u306e\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u30da\u30fc\u30b8\u3067\u3059\u3002\n\u3000http://www.post.japanpost.jp/zipcode/dl/kogaki-zip.html\n\n\u3000\u901a\u5e38\u306f\u3053\u3053\u304b\u3089\u30d5\u30a1\u30a4\u30eb\u3092\u30c9\u30e9\u30a4\u30d6\u306b\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3057\u3066\u958b\u3044\u3066\u3068\u3044\u3046\u6d41\u308c\u306b\u306a\u308d\u3046\u304b\u3068\u601d\u3044\u307e\u3059\u304c\u76f4\u63a5\u3053\u3053\u304b\u3089\u30b9\u30d7\u30ec\u30c3\u30c9\u30b7\u30fc\u30c8\u306b\u5f15\u3063\u5f35\u3063\u3066\u3053\u308c\u306a\u3044\u3082\u306e\u304b\u3068\u601d\u3044\u3001\u3084\u3063\u3066\u307f\u307e\u3057\u305f\u3002\n\u3000\u5168\u56fd\u4e00\u62ec\u306f12\u4e07\u4ef6\u8d85\u3042\u308a\u3001\u3055\u3059\u304c\u306bGAS\u3067\u306f\u8aad\u53d6\u308a\u306b5\u5206\u304f\u3089\u3044\u304b\u304b\u3063\u3066\u3057\u307e\u3044\u307e\u3057\u305f\u304c\u3001\u500b\u3005\u306e\u90fd\u9053\u5e9c\u770c\u306a\u3089\u308f\u308a\u3068\u30b9\u30e0\u30fc\u30ba\u306b\u3067\u304d\u307e\u3057\u305f\u3002\n\u3000\u6771\u4eac\u90fd\u3092\u4f8b\u306b\u3084\u3063\u3066\u307f\u307e\u3057\u305f\u3002\n\n\u30b3\u30fc\u30c9.gs\nvar ss = SpreadsheetApp.getActiveSpreadsheet();\nvar sh = ss.getActiveSheet();\n\nfunction getPostData() {\n\n  // zip\u30d5\u30a1\u30a4\u30eb\u53d6\u5f97\n  var url = \"http://www.post.japanpost.jp/zipcode/dl/kogaki/zip/13tokyo.zip\";\n  var zipblob = UrlFetchApp.fetch(url).getBlob();\n\n  // \u89e3\u51cd\n  var unzipblob = Utilities.unzip(zipblob);\n\n  // \u30c7\u30fc\u30bf\u53d6\u5f97\n  var data = unzipblob[0].getDataAsString(\"Shift_JIS\");\n\n  // \u884c\u3054\u3068\u306b\u914d\u5217\u306b\u683c\u7d0d\n  var ary = data.split(\"\\n\");\n\n  // \u6700\u5f8c\u306e\u7a7a\u914d\u5217\u9664\u53bb\n  ary.pop();\n\n  // 2\u6b21\u5143\u914d\u5217\u306b\u7d44\u307f\u76f4\u3057\n  var ary2 = [];\n  var ary3 = [];\n  for (var i in ary) {\n    ary2 = ary[i].split(\",\");\n    ary3.push(ary2);\n    ary2 = [];\n  }\n\n  // \u30b7\u30fc\u30c8\u306b\u53cd\u6620\n  sh.getRange(1,1,ary.length,15).setValues(ary3);\n\n}\n\n\n\u3000\u5b9f\u306fUtilities.parseCsv()\u3092\u4f7f\u3048\u3070\u3082\u3063\u3068\u30b7\u30f3\u30d7\u30eb\u306b\u3067\u304d\u307e\u3059\u3002\n\n\u30b3\u30fc\u30c9.gs\nvar ss = SpreadsheetApp.getActiveSpreadsheet();\nvar sh = ss.getActiveSheet();\n\nfunction getPostData() {\n\n  // zip\u30d5\u30a3\u30a2\u30eb\u53d6\u5f97\n  var url = \"http://www.post.japanpost.jp/zipcode/dl/kogaki/zip/13tokyo.zip\";\n  var zipblob = UrlFetchApp.fetch(url).getBlob();\n\n  // \u89e3\u51cd\n  var unzipblob = Utilities.unzip(zipblob);\n\n  // \u30c7\u30fc\u30bf\u53d6\u5f97\n  var data = unzipblob[0].getDataAsString(\"Shift_JIS\");\n\n  // 2\u6b21\u5143\u914d\u5217\u306b\u8ee2\u63db\n  var ary = Utilities.parseCsv(data);\n\n  // \u30b7\u30fc\u30c8\u306b\u53cd\u6620\n  sh.getRange(1,1,ary.length,15).setValues(ary);\n\n}\n\n\n\u3000\u53d6\u308a\u8fbc\u3093\u3060\u7d50\u679c\u3067\u3059\u30023810\u884c\u3067\u3057\u305f\u3002\n\n\u3000\u3053\u308c\u304b\u3089\u6642\u3005GAS\u306b\u3064\u3044\u3066\u6295\u7a3f\u3057\u3066\u3044\u3053\u3046\u3068\u601d\u3044\u307e\u3059\u3002GAS\u306e\u8aad\u307f\u65b9\u3067\u3059\u304c\u79c1\u306f\u300c\u30ae\u30e3\u30b9\u300d\u3068\u547c\u3076\u3088\u3046\u306b\u3057\u3066\u3044\u307e\u3059\uff08\u300c\u30ac\u30b9\u300d\u3088\u308a\u3082\u683c\u597d\u3044\u3044\u97ff\u304d\u3067\u306f\u306a\u3044\u304b\u3068\uff09\u3002\n\n\u3000\u3055\u3066\u3001\u90f5\u4fbf\u5c40\u306e\u30b5\u30a4\u30c8\u306e\u306a\u304b\u306b\u3042\u308b\u3001\u90f5\u4fbf\u756a\u53f7\u30c7\u30fc\u30bf\u306e\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u30da\u30fc\u30b8\u3067\u3059\u3002\n\u3000http://www.post.japanpost.jp/zipcode/dl/kogaki-zip.html\n\n![\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2016-08-31 17.53.37.png](https://qiita-image-store.s3.amazonaws.com/0/139134/1ee51365-dfaa-d506-3535-1ba8bbf3adcf.png)\n\n\u3000\u901a\u5e38\u306f\u3053\u3053\u304b\u3089\u30d5\u30a1\u30a4\u30eb\u3092\u30c9\u30e9\u30a4\u30d6\u306b\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3057\u3066\u958b\u3044\u3066\u3068\u3044\u3046\u6d41\u308c\u306b\u306a\u308d\u3046\u304b\u3068\u601d\u3044\u307e\u3059\u304c\u76f4\u63a5\u3053\u3053\u304b\u3089\u30b9\u30d7\u30ec\u30c3\u30c9\u30b7\u30fc\u30c8\u306b\u5f15\u3063\u5f35\u3063\u3066\u3053\u308c\u306a\u3044\u3082\u306e\u304b\u3068\u601d\u3044\u3001\u3084\u3063\u3066\u307f\u307e\u3057\u305f\u3002\n\n\u3000\u5168\u56fd\u4e00\u62ec\u306f12\u4e07\u4ef6\u8d85\u3042\u308a\u3001\u3055\u3059\u304c\u306bGAS\u3067\u306f\u8aad\u53d6\u308a\u306b5\u5206\u304f\u3089\u3044\u304b\u304b\u3063\u3066\u3057\u307e\u3044\u307e\u3057\u305f\u304c\u3001\u500b\u3005\u306e\u90fd\u9053\u5e9c\u770c\u306a\u3089\u308f\u308a\u3068\u30b9\u30e0\u30fc\u30ba\u306b\u3067\u304d\u307e\u3057\u305f\u3002\n\n\u3000\u6771\u4eac\u90fd\u3092\u4f8b\u306b\u3084\u3063\u3066\u307f\u307e\u3057\u305f\u3002\n\n~~~js:\u30b3\u30fc\u30c9.gs\nvar ss = SpreadsheetApp.getActiveSpreadsheet();\nvar sh = ss.getActiveSheet();\n\nfunction getPostData() {\n\n  // zip\u30d5\u30a1\u30a4\u30eb\u53d6\u5f97\n  var url = \"http://www.post.japanpost.jp/zipcode/dl/kogaki/zip/13tokyo.zip\";\n  var zipblob = UrlFetchApp.fetch(url).getBlob();\n\n  // \u89e3\u51cd\n  var unzipblob = Utilities.unzip(zipblob);\n\n  // \u30c7\u30fc\u30bf\u53d6\u5f97\n  var data = unzipblob[0].getDataAsString(\"Shift_JIS\");\n\n  // \u884c\u3054\u3068\u306b\u914d\u5217\u306b\u683c\u7d0d\n  var ary = data.split(\"\\n\");\n\n  // \u6700\u5f8c\u306e\u7a7a\u914d\u5217\u9664\u53bb\n  ary.pop();\n\n  // 2\u6b21\u5143\u914d\u5217\u306b\u7d44\u307f\u76f4\u3057\n  var ary2 = [];\n  var ary3 = [];\n  for (var i in ary) {\n    ary2 = ary[i].split(\",\");\n    ary3.push(ary2);\n    ary2 = [];\n  }\n\n  // \u30b7\u30fc\u30c8\u306b\u53cd\u6620\n  sh.getRange(1,1,ary.length,15).setValues(ary3);\n\n}\n~~~\n\n\u3000\u5b9f\u306fUtilities.parseCsv()\u3092\u4f7f\u3048\u3070\u3082\u3063\u3068\u30b7\u30f3\u30d7\u30eb\u306b\u3067\u304d\u307e\u3059\u3002\n\n~~~js:\u30b3\u30fc\u30c9.gs\nvar ss = SpreadsheetApp.getActiveSpreadsheet();\nvar sh = ss.getActiveSheet();\n\nfunction getPostData() {\n\n  // zip\u30d5\u30a3\u30a2\u30eb\u53d6\u5f97\n  var url = \"http://www.post.japanpost.jp/zipcode/dl/kogaki/zip/13tokyo.zip\";\n  var zipblob = UrlFetchApp.fetch(url).getBlob();\n\n  // \u89e3\u51cd\n  var unzipblob = Utilities.unzip(zipblob);\n\n  // \u30c7\u30fc\u30bf\u53d6\u5f97\n  var data = unzipblob[0].getDataAsString(\"Shift_JIS\");\n\n  // 2\u6b21\u5143\u914d\u5217\u306b\u8ee2\u63db\n  var ary = Utilities.parseCsv(data);\n\n  // \u30b7\u30fc\u30c8\u306b\u53cd\u6620\n  sh.getRange(1,1,ary.length,15).setValues(ary);\n\n}\n~~~\n\n\u3000\u53d6\u308a\u8fbc\u3093\u3060\u7d50\u679c\u3067\u3059\u30023810\u884c\u3067\u3057\u305f\u3002\n\n![\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2016-08-31 18.17.02.png](https://qiita-image-store.s3.amazonaws.com/0/139134/4f5bab65-ff79-5f86-40ee-3c92a1ca06d7.png)\n", "tags": ["GoogleAppsScript"]}