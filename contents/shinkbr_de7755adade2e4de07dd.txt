{"tags": ["xss", "\u8106\u5f31\u6027"], "context": "\u672c\u8a18\u4e8b\u306f\u8106\u5f31\u6027\"&'<<>\\ Advent Calendar 2016\u306e14\u65e5\u76ee\u306e\u8a18\u4e8b\u3067\u3059\u3002\n\u6628\u5e74\u306e\u8106\u5f31\u6027\"&'<<>\\ Advent Calendar 2015\u3067\u306fAmazon\u306bXSS\u30922\u3064\u5831\u544a\u3057\u305f\u8a18\u4e8b\u3092\u66f8\u304d\u307e\u3057\u305f\u304c\u3001\u3053\u308c\u306e2\u3064\u76ee\u306eXSS\u306b\u985e\u4f3c\u3057\u305fXSS\u3092\u6700\u8fd1\u307e\u305fAmazon\u306b\u767a\u898b\u30fb\u5831\u544a\u3057\u305f\u304a\u8a71\u3067\u3059\u3002\n\n\u6982\u8981\n\n\n\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8\u306e\u901a\u308a\u3001www.amazon.co.jp\u306e\u691c\u7d22\u30d0\u30fc\u304b\u3089'><script>alert(1)</script> \u3068\u691c\u7d22\u3059\u308b\u3060\u3051\u3067\u8d77\u304d\u308b\u53cd\u5c04\u578bXSS\u3067\u3059\u3002\n<div data-ad-details='{\"adPlacementMetaData\": {\"searchTerms\": \"<the_search_query>\", ...}}'>\n\n\u3068\u3044\u3046\u98a8\u306b\u30b7\u30f3\u30b0\u30eb\u30af\u30aa\u30fc\u30c8\u3067\u56f2\u3063\u305fattribute\u306b\u691c\u7d22\u30af\u30a8\u30ea\u3092\u542b\u3080JSON\u3092\u66f8\u304d\u8fbc\u3093\u3067\u3044\u308b\u7b87\u6240\u3067\u3001\u30b7\u30f3\u30b0\u30eb\u30af\u30aa\u30fc\u30c8\u304c\u30a8\u30b9\u30b1\u30fc\u30d7\u3055\u308c\u3066\u3044\u306a\u3044\u3053\u3068\u304c\u554f\u984c\u3067\u3057\u305f\u3002\n<div data-ad-details='{\"adPlacementMetaData\": {\"searchTerms\": \"'><script>alert(1)</script>\", ...}}'>\n\n\u3053\u306e\u3088\u3046\u306bJSON\u3084JavaScript\u306e\u4e2d\u306b\u542b\u307e\u308c\u308b\u6587\u5b57\u5217\u3067\u306f\u3001\u554f\u984c\u3092\u5f15\u304d\u8d77\u3053\u3057\u3066\u3044\u308b'\u3092\u542b\u3081\u691c\u7d22\u30af\u30a8\u30ea\u5168\u4f53\u3092Unicode Escape Sequence\u306b\u5909\u63db\u3057\u3066\\x27\\x3e\\x3cscript\\x3ealert\\x281\\x29\\x3c\\x2fscript\\x3e\u3068\u3059\u308b\u306e\u304c\u5b89\u5168\u306a\u30a8\u30b9\u30b1\u30fc\u30d7\u65b9\u6cd5\u3067\u3059\u3002\n<div data-ad-details='{\"adPlacementMetaData\": {\"searchTerms\": \"\\x27\\x3e\\x3cscript\\x3ealert\\x281\\x29\\x3c\\x2fscript\\x3e\", ...}}'>\n\n\njjencode yet again\n\u5192\u982d\u3067\u4ee5\u524d\u767a\u898b\u3057\u305fXSS\u306b\u985e\u4f3c\u3057\u3066\u3044\u308b\u3068\u66f8\u3044\u305f\u306e\u306f\u3001\u3053\u308c\u3082\u691c\u7d22\u306e\u7d50\u679cAmazon\u306e\u5546\u54c1\u304c1\u3064\u4ee5\u4e0a\u30d2\u30c3\u30c8\u3057\u306a\u3044\u3068\u554f\u984c\u306e\u7b87\u6240\u304c\u51fa\u529b\u3055\u308c\u305a\u3001XSS\u304c\u8d77\u304d\u306a\u3044\u3068\u3044\u3046\u6027\u8cea\u306e\u305f\u3081\u3067\u3059\u3002\u4eca\u56de\u3082\"High Alert Status\"\u3068\u3044\u3046\u30ec\u30fc\u30d9\u30eb\u306e\"Degree of the Streets Volume 1\"\u3068\u3044\u3046\u30a2\u30eb\u30d0\u30e0\u306b\u53ce\u9332\u3055\u308c\u3066\u3044\u308b\"Script Ta Unscripted\"\u3068\u3044\u3046\u697d\u66f2\u304c\u4ed5\u4e8b\u3092\u3057\u3066\u304f\u308c\u305f\u304a\u304b\u3052\u3067'><script>alert(1)</script>\u306b\u3088\u308aXSS\u304c\u78ba\u8a8d\u3067\u304d\u307e\u3057\u305f\u3002(\u753b\u50cf1\u679a\u76ee)\n\u306a\u306e\u3067\u3001\u4eca\u56de\u3082jjencode\u306a\u3069\u3067\u691c\u7d22\u3092\u90aa\u9b54\u3057\u306a\u3044\u3088\u3046\u306b\u3057\u3066<script>\u30bf\u30b0\u3092\u6ce8\u5165\u3059\u308b\u3053\u3068\u3067\u4efb\u610f\u306eJavaScript\u3092\u4ed5\u8fbc\u3080\u3053\u3068\u304c\u3067\u304d\u307e\u3057\u305f\u3002\n\n2016/12/9\u306b\u5831\u544a\u3057\u30011\u65e5\u3067\u4fee\u6b63\u3055\u308c\u307e\u3057\u305f\u3002\u3061\u306a\u307f\u306b\u3001\u305d\u306e\u4fee\u6b63\u65b9\u6cd5\u304c\u5c11\u3057\u5909\u308f\u3063\u3066\u3044\u3066\u3001\u691c\u7d22\u30af\u30a8\u30ea\u3092base64\u3067\u51fa\u529b\u3059\u308b\u3068\u3044\u3046\u3082\u306e\u3067\u3057\u305f\u3002\n\n% echo -n 'Jz48c2NyaXB0PmFsZXJ0KDEpPC9zY3JpcHQ+' | base64 -D\n'><script>alert(1)</script>\n\n\n\u7d50\u8ad6\u30fb\u6240\u611f\nAmazon\u306b\u30d0\u30b0\u30d0\u30a6\u30f3\u30c6\u30a3\u6765\u306a\u3044\u306e\u304b (575)\n\u672c\u8a18\u4e8b\u306f[\u8106\u5f31\u6027\"&'<<>\\ Advent Calendar 2016](http://www.adventar.org/calendars/1404)\u306e14\u65e5\u76ee\u306e\u8a18\u4e8b\u3067\u3059\u3002\n\n\u6628\u5e74\u306e[\u8106\u5f31\u6027\"&'<<>\\ Advent Calendar 2015](http://www.adventar.org/calendars/811/)\u3067\u306f[Amazon\u306bXSS\u30922\u3064\u5831\u544a\u3057\u305f\u8a18\u4e8b](http://qiita.com/shinkbr/items/4867beb2858fa6e854b7)\u3092\u66f8\u304d\u307e\u3057\u305f\u304c\u3001\u3053\u308c\u306e2\u3064\u76ee\u306eXSS\u306b\u985e\u4f3c\u3057\u305fXSS\u3092\u6700\u8fd1\u307e\u305fAmazon\u306b\u767a\u898b\u30fb\u5831\u544a\u3057\u305f\u304a\u8a71\u3067\u3059\u3002\n\n# \u6982\u8981\n\n<img width=\"696\" alt=\"screenshot_alert_1.png\" src=\"https://qiita-image-store.s3.amazonaws.com/0/53690/7e2a8d07-e013-fdaf-c3e0-69cc4cf11000.png\">\n\n<img width=\"828\" alt=\"screenshot_html_with_box.png\" src=\"https://qiita-image-store.s3.amazonaws.com/0/53690/e6aa190a-6c9d-a491-fd7e-fe655b45651f.png\">\n\n\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8\u306e\u901a\u308a\u3001www.amazon.co.jp\u306e\u691c\u7d22\u30d0\u30fc\u304b\u3089`'><script>alert(1)</script>` \u3068\u691c\u7d22\u3059\u308b\u3060\u3051\u3067\u8d77\u304d\u308b\u53cd\u5c04\u578bXSS\u3067\u3059\u3002\n\n```html\n<div data-ad-details='{\"adPlacementMetaData\": {\"searchTerms\": \"<the_search_query>\", ...}}'>\n```\n\n\u3068\u3044\u3046\u98a8\u306b\u30b7\u30f3\u30b0\u30eb\u30af\u30aa\u30fc\u30c8\u3067\u56f2\u3063\u305fattribute\u306b\u691c\u7d22\u30af\u30a8\u30ea\u3092\u542b\u3080JSON\u3092\u66f8\u304d\u8fbc\u3093\u3067\u3044\u308b\u7b87\u6240\u3067\u3001\u30b7\u30f3\u30b0\u30eb\u30af\u30aa\u30fc\u30c8\u304c\u30a8\u30b9\u30b1\u30fc\u30d7\u3055\u308c\u3066\u3044\u306a\u3044\u3053\u3068\u304c\u554f\u984c\u3067\u3057\u305f\u3002\n\n```html\n<div data-ad-details='{\"adPlacementMetaData\": {\"searchTerms\": \"'><script>alert(1)</script>\", ...}}'>\n```\n\n\u3053\u306e\u3088\u3046\u306bJSON\u3084JavaScript\u306e\u4e2d\u306b\u542b\u307e\u308c\u308b\u6587\u5b57\u5217\u3067\u306f\u3001\u554f\u984c\u3092\u5f15\u304d\u8d77\u3053\u3057\u3066\u3044\u308b`'`\u3092\u542b\u3081\u691c\u7d22\u30af\u30a8\u30ea\u5168\u4f53\u3092Unicode Escape Sequence\u306b\u5909\u63db\u3057\u3066`\\x27\\x3e\\x3cscript\\x3ealert\\x281\\x29\\x3c\\x2fscript\\x3e`\u3068\u3059\u308b\u306e\u304c\u5b89\u5168\u306a\u30a8\u30b9\u30b1\u30fc\u30d7\u65b9\u6cd5\u3067\u3059\u3002\n\n```html\n<div data-ad-details='{\"adPlacementMetaData\": {\"searchTerms\": \"\\x27\\x3e\\x3cscript\\x3ealert\\x281\\x29\\x3c\\x2fscript\\x3e\", ...}}'>\n```\n\n# jjencode yet again\n\n\u5192\u982d\u3067\u4ee5\u524d\u767a\u898b\u3057\u305fXSS\u306b\u985e\u4f3c\u3057\u3066\u3044\u308b\u3068\u66f8\u3044\u305f\u306e\u306f\u3001\u3053\u308c\u3082\u691c\u7d22\u306e\u7d50\u679cAmazon\u306e\u5546\u54c1\u304c1\u3064\u4ee5\u4e0a\u30d2\u30c3\u30c8\u3057\u306a\u3044\u3068\u554f\u984c\u306e\u7b87\u6240\u304c\u51fa\u529b\u3055\u308c\u305a\u3001XSS\u304c\u8d77\u304d\u306a\u3044\u3068\u3044\u3046\u6027\u8cea\u306e\u305f\u3081\u3067\u3059\u3002\u4eca\u56de\u3082\"High **Alert** Status\"\u3068\u3044\u3046\u30ec\u30fc\u30d9\u30eb\u306e\"Degree of the Streets Volume **1**\"\u3068\u3044\u3046\u30a2\u30eb\u30d0\u30e0\u306b\u53ce\u9332\u3055\u308c\u3066\u3044\u308b[\"**Script** Ta Unscripted\"](https://www.amazon.co.jp/dp/B0044Q3IL4)\u3068\u3044\u3046\u697d\u66f2\u304c\u4ed5\u4e8b\u3092\u3057\u3066\u304f\u308c\u305f\u304a\u304b\u3052\u3067`'><script>alert(1)</script>`\u306b\u3088\u308aXSS\u304c\u78ba\u8a8d\u3067\u304d\u307e\u3057\u305f\u3002(\u753b\u50cf1\u679a\u76ee)\n\n\u306a\u306e\u3067\u3001\u4eca\u56de\u3082jjencode\u306a\u3069\u3067\u691c\u7d22\u3092\u90aa\u9b54\u3057\u306a\u3044\u3088\u3046\u306b\u3057\u3066`<script>`\u30bf\u30b0\u3092\u6ce8\u5165\u3059\u308b\u3053\u3068\u3067\u4efb\u610f\u306eJavaScript\u3092\u4ed5\u8fbc\u3080\u3053\u3068\u304c\u3067\u304d\u307e\u3057\u305f\u3002\n\n<img width=\"696\" alt=\"screenshot_alert_document.domain.png\" src=\"https://qiita-image-store.s3.amazonaws.com/0/53690/a0ae25a4-2dfa-cd35-7333-de3b86d3498f.png\">\n\n2016/12/9\u306b\u5831\u544a\u3057\u30011\u65e5\u3067\u4fee\u6b63\u3055\u308c\u307e\u3057\u305f\u3002\u3061\u306a\u307f\u306b\u3001\u305d\u306e\u4fee\u6b63\u65b9\u6cd5\u304c\u5c11\u3057\u5909\u308f\u3063\u3066\u3044\u3066\u3001\u691c\u7d22\u30af\u30a8\u30ea\u3092base64\u3067\u51fa\u529b\u3059\u308b\u3068\u3044\u3046\u3082\u306e\u3067\u3057\u305f\u3002\n\n<img width=\"831\" alt=\"screenshot_html_base64_with_box.png\" src=\"https://qiita-image-store.s3.amazonaws.com/0/53690/9ba5a0e2-a3c6-751d-32be-bd398d74add9.png\">\n\n```bash\n% echo -n 'Jz48c2NyaXB0PmFsZXJ0KDEpPC9zY3JpcHQ+' | base64 -D\n'><script>alert(1)</script>\n```\n\n# \u7d50\u8ad6\u30fb\u6240\u611f\nAmazon\u306b\u30d0\u30b0\u30d0\u30a6\u30f3\u30c6\u30a3\u6765\u306a\u3044\u306e\u304b (575)\n"}