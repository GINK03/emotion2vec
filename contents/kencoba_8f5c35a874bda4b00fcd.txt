{"context": " More than 1 year has passed since last update.\u8907\u6570\u306eExcel\u30d6\u30c3\u30af\u306b\u767b\u9332\u3055\u308c\u305f\u7533\u8fbc\u30c7\u30fc\u30bf\u304b\u3089\u3001\n\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u3060\u3051\u3092\u629c\u304d\u51fa\u3059\u3001\n\u3068\u304b\u3044\u3046\u4f5c\u696d\u3092\u624b\u3067\u3084\u308b\u306e\u306f\u82e6\u75db\u3002\n\u3068\u3044\u3046\u308f\u3051\u3067\u4f5c\u3063\u305f\u30de\u30af\u30ed\u3002\nSheet1\u306b\u3001\u4ee5\u4e0b\u306e\u901a\u308a\u5bfe\u8c61\u30c7\u30fc\u30bf\u30ea\u30b9\u30c8\u3092\u683c\u7d0d\u3057\u3066\u304a\u304f\u3002\n------------+-------+-------+---------+\n\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u540d|\u30d6\u30c3\u30af\u540d|\u30b7\u30fc\u30c8\u540d|\u5148\u982d\u30bb\u30eb\u540d|\nc:\\Directory|\u30c7\u30fc\u30bf.xlsx|\u7533\u8fbc|D2|\n\u5b9f\u884c\u3059\u308b\u3068\u3001\u65b0\u3057\u3044\u30d6\u30c3\u30af\u3092\u4f5c\u6210\u3059\u308b\u3002\n\u5bfe\u8c61\u30c7\u30fc\u30bf\u30ea\u30b9\u30c8\u306e\u30b7\u30fc\u30c8\u304b\u3089\u3001\u30c7\u30fc\u30bf\u3092\u62bd\u51fa\u3057\u3066\u3001Sheet2\u306b\u96c6\u7d04\u3057\u3066\u3044\u304f\u3002\n\u300c\u5148\u982d\u30bb\u30eb\u540d\u300d\u3067\u6307\u5b9a\u3055\u308c\u305f\u30bb\u30eb\u306e\u5217\u306b\u3042\u308b\u30c7\u30fc\u30bf\u304c\u5168\u90e8\u30de\u30fc\u30b8\u3055\u308c\u308b\u3002\n\n\u30c7\u30fc\u30bf\u62bd\u51fa\nOption Explicit\n\nSub \u30c7\u30fc\u30bf\u62bd\u51fa()\n    Dim bkInput As Workbook\n    Set bkInput = ThisWorkbook\n    Dim shtInput As Worksheet\n    Set shtInput = bkInput.Sheets(1)\n    Dim bkOutput As Workbook\n    Set bkOutput = Workbooks.Add\n    shtInput.Copy Before:=bkOutput.Sheets(1)\n    Dim shtOutput As Worksheet\n    Set shtOutput = bkOutput.Sheets(1)\n    Dim shtOutputData As Worksheet\n    Set shtOutputData = bkOutput.Sheets(2)\n\n    Dim sPath As String\n    Dim sBook As String\n    Dim sSheet As String\n\n    Dim Target As Range\n    Set Target = shtOutputData.Cells(1, 1)\n\n\n    Dim nRow As Integer\n    nRow = 2\n    Do While shtOutput.Cells(nRow, 1) <> \"\"\n        sPath = shtOutput.Cells(nRow, 1)\n        sBook = shtOutput.Cells(nRow, 2)\n        sSheet = shtOutput.Cells(nRow, 3)\n\n        Dim bkData As Workbook\n        Dim shtData As Worksheet\n\n        Set bkData = Workbooks.Open(Filename:=sPath & \"\\\" & sBook, ReadOnly:=True)\n        Set shtData = bkData.Worksheets(sSheet)\n\n        Dim sInputCell As String\n        sInputCell = shtOutput.Cells(nRow, 4)\n\n\n        Dim Source As Range\n        Set Source = shtData.Range(sInputCell).Resize(shtData.Range(sInputCell).End(xlDown).Row) ' \u884c\u3060\u3051\u6700\u7d42\u884c\u307e\u3067\u6301\u3063\u3066\u3044\u304f\n\n        Source.Copy Target\n\n        bkData.Close\n\n        Set Target = shtOutputData.Cells(1, 1).End(xlDown).Offset(1, 0) '\u6700\u7d42\u884c\u306e\u4e00\u3064\u4e0b\u3092\u6b21\u306eTarget\u306b\u3059\u308b\n\n        nRow = nRow + 1\n    Loop\n\nEnd Sub\n\n\n\u8907\u6570\u306eExcel\u30d6\u30c3\u30af\u306b\u767b\u9332\u3055\u308c\u305f\u7533\u8fbc\u30c7\u30fc\u30bf\u304b\u3089\u3001\n\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u3060\u3051\u3092\u629c\u304d\u51fa\u3059\u3001\n\u3068\u304b\u3044\u3046\u4f5c\u696d\u3092\u624b\u3067\u3084\u308b\u306e\u306f\u82e6\u75db\u3002\n\u3068\u3044\u3046\u308f\u3051\u3067\u4f5c\u3063\u305f\u30de\u30af\u30ed\u3002\n\nSheet1\u306b\u3001\u4ee5\u4e0b\u306e\u901a\u308a\u5bfe\u8c61\u30c7\u30fc\u30bf\u30ea\u30b9\u30c8\u3092\u683c\u7d0d\u3057\u3066\u304a\u304f\u3002\n\n------------+-------+-------+---------+\n\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u540d|\u30d6\u30c3\u30af\u540d|\u30b7\u30fc\u30c8\u540d|\u5148\u982d\u30bb\u30eb\u540d|\nc:\\Directory\\|\u30c7\u30fc\u30bf.xlsx|\u7533\u8fbc|D2|\n\n\u5b9f\u884c\u3059\u308b\u3068\u3001\u65b0\u3057\u3044\u30d6\u30c3\u30af\u3092\u4f5c\u6210\u3059\u308b\u3002\n\u5bfe\u8c61\u30c7\u30fc\u30bf\u30ea\u30b9\u30c8\u306e\u30b7\u30fc\u30c8\u304b\u3089\u3001\u30c7\u30fc\u30bf\u3092\u62bd\u51fa\u3057\u3066\u3001Sheet2\u306b\u96c6\u7d04\u3057\u3066\u3044\u304f\u3002\n\u300c\u5148\u982d\u30bb\u30eb\u540d\u300d\u3067\u6307\u5b9a\u3055\u308c\u305f\u30bb\u30eb\u306e\u5217\u306b\u3042\u308b\u30c7\u30fc\u30bf\u304c\u5168\u90e8\u30de\u30fc\u30b8\u3055\u308c\u308b\u3002\n\n\n```vb:\u30c7\u30fc\u30bf\u62bd\u51fa\nOption Explicit\n\nSub \u30c7\u30fc\u30bf\u62bd\u51fa()\n    Dim bkInput As Workbook\n    Set bkInput = ThisWorkbook\n    Dim shtInput As Worksheet\n    Set shtInput = bkInput.Sheets(1)\n    Dim bkOutput As Workbook\n    Set bkOutput = Workbooks.Add\n    shtInput.Copy Before:=bkOutput.Sheets(1)\n    Dim shtOutput As Worksheet\n    Set shtOutput = bkOutput.Sheets(1)\n    Dim shtOutputData As Worksheet\n    Set shtOutputData = bkOutput.Sheets(2)\n    \n    Dim sPath As String\n    Dim sBook As String\n    Dim sSheet As String\n    \n    Dim Target As Range\n    Set Target = shtOutputData.Cells(1, 1)\n    \n    \n    Dim nRow As Integer\n    nRow = 2\n    Do While shtOutput.Cells(nRow, 1) <> \"\"\n        sPath = shtOutput.Cells(nRow, 1)\n        sBook = shtOutput.Cells(nRow, 2)\n        sSheet = shtOutput.Cells(nRow, 3)\n        \n        Dim bkData As Workbook\n        Dim shtData As Worksheet\n        \n        Set bkData = Workbooks.Open(Filename:=sPath & \"\\\" & sBook, ReadOnly:=True)\n        Set shtData = bkData.Worksheets(sSheet)\n        \n        Dim sInputCell As String\n        sInputCell = shtOutput.Cells(nRow, 4)\n        \n        \n        Dim Source As Range\n        Set Source = shtData.Range(sInputCell).Resize(shtData.Range(sInputCell).End(xlDown).Row) ' \u884c\u3060\u3051\u6700\u7d42\u884c\u307e\u3067\u6301\u3063\u3066\u3044\u304f\n        \n        Source.Copy Target\n\n        bkData.Close\n\n        Set Target = shtOutputData.Cells(1, 1).End(xlDown).Offset(1, 0) '\u6700\u7d42\u884c\u306e\u4e00\u3064\u4e0b\u3092\u6b21\u306eTarget\u306b\u3059\u308b\n\n        nRow = nRow + 1\n    Loop\n    \nEnd Sub\n```", "tags": ["VBA"]}