{"context": " More than 1 year has passed since last update.AngularJS+Typescript\u3067\u4f1a\u54e1\u5236\u30b5\u30fc\u30d3\u30b9\u3092\u4f5c\u3063\u305f\u306e\u3067\u3001\u305d\u306e\u6642\u306b\u4f7f\u3063\u305f\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u306e\u4e00\u90e8\u3067\u3059\u3002\n\u30da\u30fc\u30b8\u9077\u79fb\u6642\u306bresponse\u3092\u30a4\u30f3\u30bf\u30fc\u30bb\u30d7\u30c8\u3057\u3066\u30b9\u30c6\u30fc\u30bf\u30b9\u304c401\u3060\u3063\u305f\u3089\u30ed\u30b0\u30a4\u30f3\u306b\u98db\u3070\u3059\u3002\n\u753b\u9762\u30ea\u30ed\u30fc\u30c9\u6642\u306b\u306f$routeChangeSuccess\u304c\u547c\u3070\u308c\u306a\u3044\u306e\u3067\u3001\u30b3\u30f3\u30c8\u30ed\u30fc\u30e9\u304c\u547c\u3070\u308c\u308b\u305f\u3073\u306b\u8a8d\u8a3c\u30c1\u30a7\u30c3\u30af\u3059\u308b\u51e6\u7406\u304c\u5225\u9014\u5fc5\u8981\u306b\u306a\u308a\u307e\u3059\u3002\n\napp.ts\n/**\n * \u30a4\u30f3\u30bf\u30fc\u30bb\u30d7\u30bf\u30fc\n */\ncontext.app.factory(\"SessionInterceptor\", function ($q:ng.IQService, $location:ng.ILocationService) {\n    return {\n        request: function (config) {\n            return config || $q.when(config);\n        },\n        requestError: function(request){\n            return $q.reject(request);\n        },\n        response: function (response) {\n            return response || $q.when(response);\n        },\n        responseError: function (response) {\n            if (response && response.status === 401) {\n                $location.url(\"/login\");\n            }\n            return $q.reject(response);\n        }\n    };\n});\n\n/**\n * \u74b0\u5883\u8a2d\u5b9a\n */\ncontext.app.config(function ($routeProvider:ng.route.IRouteProvider, $locationProvider:ng.ILocationProvider, $translateProvider:ng.translate.ITranslateProvider, $httpProvider:ng.IHttpProvider) {\n    $locationProvider.html5Mode(true);\n    $locationProvider.hashPrefix('!');\n\n    /**\n     * route\u8a2d\u5b9a\n     */\n    $routeProvider\n        .when(\"/\",         { templateUrl: \"/view/top/Top.html\" })\n        .when(\"/login\",    { templateUrl: \"/view/login/Login.html\" })\n        .otherwise({redirectTo: \"/notFound\"});\n\n    /**\n     * \u30bb\u30c3\u30b7\u30e7\u30f3\u30c1\u30a7\u30c3\u30af\n     */\n    $httpProvider.interceptors.push(\"SessionInterceptor\");\n}).run(function($rootScope:ng.IRootScopeService, loginService:domain.login.ILoginService, $location:ng.ILocationService) {\n    // route\u5909\u66f4\u6642\u306e\u30a4\u30d9\u30f3\u30c8\n    $rootScope.$on(\"$routeChangeSuccess\", function(event, current, next) {\n        if(!loginService.isLogged) {\n            $location.url(\"/login\");\n        }\n    });\n});\n\n\n\nAngularJS+Typescript\u3067\u4f1a\u54e1\u5236\u30b5\u30fc\u30d3\u30b9\u3092\u4f5c\u3063\u305f\u306e\u3067\u3001\u305d\u306e\u6642\u306b\u4f7f\u3063\u305f\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u306e\u4e00\u90e8\u3067\u3059\u3002\n\n\u30da\u30fc\u30b8\u9077\u79fb\u6642\u306bresponse\u3092\u30a4\u30f3\u30bf\u30fc\u30bb\u30d7\u30c8\u3057\u3066\u30b9\u30c6\u30fc\u30bf\u30b9\u304c401\u3060\u3063\u305f\u3089\u30ed\u30b0\u30a4\u30f3\u306b\u98db\u3070\u3059\u3002\n\n\u753b\u9762\u30ea\u30ed\u30fc\u30c9\u6642\u306b\u306f$routeChangeSuccess\u304c\u547c\u3070\u308c\u306a\u3044\u306e\u3067\u3001\u30b3\u30f3\u30c8\u30ed\u30fc\u30e9\u304c\u547c\u3070\u308c\u308b\u305f\u3073\u306b\u8a8d\u8a3c\u30c1\u30a7\u30c3\u30af\u3059\u308b\u51e6\u7406\u304c\u5225\u9014\u5fc5\u8981\u306b\u306a\u308a\u307e\u3059\u3002\n\n```js:app.ts\n/**\n * \u30a4\u30f3\u30bf\u30fc\u30bb\u30d7\u30bf\u30fc\n */\ncontext.app.factory(\"SessionInterceptor\", function ($q:ng.IQService, $location:ng.ILocationService) {\n    return {\n        request: function (config) {\n            return config || $q.when(config);\n        },\n        requestError: function(request){\n            return $q.reject(request);\n        },\n        response: function (response) {\n            return response || $q.when(response);\n        },\n        responseError: function (response) {\n            if (response && response.status === 401) {\n                $location.url(\"/login\");\n            }\n            return $q.reject(response);\n        }\n    };\n});\n\n/**\n * \u74b0\u5883\u8a2d\u5b9a\n */\ncontext.app.config(function ($routeProvider:ng.route.IRouteProvider, $locationProvider:ng.ILocationProvider, $translateProvider:ng.translate.ITranslateProvider, $httpProvider:ng.IHttpProvider) {\n    $locationProvider.html5Mode(true);\n    $locationProvider.hashPrefix('!');\n\n    /**\n     * route\u8a2d\u5b9a\n     */\n    $routeProvider\n        .when(\"/\",         { templateUrl: \"/view/top/Top.html\" })\n        .when(\"/login\",    { templateUrl: \"/view/login/Login.html\" })\n        .otherwise({redirectTo: \"/notFound\"});\n\n    /**\n     * \u30bb\u30c3\u30b7\u30e7\u30f3\u30c1\u30a7\u30c3\u30af\n     */\n    $httpProvider.interceptors.push(\"SessionInterceptor\");\n}).run(function($rootScope:ng.IRootScopeService, loginService:domain.login.ILoginService, $location:ng.ILocationService) {\n    // route\u5909\u66f4\u6642\u306e\u30a4\u30d9\u30f3\u30c8\n    $rootScope.$on(\"$routeChangeSuccess\", function(event, current, next) {\n        if(!loginService.isLogged) {\n            $location.url(\"/login\");\n        }\n    });\n});\n\n```\n\n", "tags": ["TypeScript", "\u30ed\u30b0\u30a4\u30f3", "AngularJS"]}