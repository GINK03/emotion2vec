{"tags": ["AWS", "APIGateway", "Node.js", "JavaScript", "lambda"], "context": "\n\n\u306f\u3058\u3081\u306b\nAWS API Gateway \u306f\u4fbf\u5229\u306a\u30b5\u30fc\u30d3\u30b9\u3067\u3059\u304c\u3001Node.js \u304b\u3089\u4f7f\u304a\u3046\u3068\u3059\u308b\u3068\u3001\u81ea\u52d5\u3067\u751f\u6210\u3055\u308c\u308b JavaScript \u306eSDK\u304c\u30d6\u30e9\u30a6\u30b6\u7528\u3057\u304b\u7528\u610f\u3055\u308c\u3066\u3044\u306a\u304b\u3063\u305f\u308a\u3001\u30a8\u30f3\u30c9\u30dd\u30a4\u30f3\u30c8\u3054\u3068\u306b\u30e1\u30bd\u30c3\u30c9\u304c\u81ea\u52d5\u3067\u751f\u6210\u3055\u308c\u3066\u3044\u3066\u3001API\u306e\u30a8\u30f3\u30c9\u30dd\u30a4\u30f3\u30c8\u3092\u5909\u66f4\u3059\u308b\u3054\u3068\u306bSDK\u3092\u751f\u6210\u3057\u76f4\u3055\u306a\u3051\u308c\u3070\u306a\u3089\u306a\u304b\u3063\u305f\u308a\u3068\u4e0d\u4fbf\u3060\u3063\u305f\u305f\u3081\u3001Node.js \u304b\u3089 API Gateway \u3092\u7c21\u5358\u306b\u4f7f\u3048\u308b\u30d1\u30c3\u30b1\u30fc\u30b8\u3092\u4f5c\u308a\u307e\u3057\u305f\u3002\naws-api-gateway-client\nhttps://github.com/kndt84/aws-api-gateway-client\n\u53c2\u8003\uff1a\nAPI Gateway \u3067\u751f\u6210\u3057\u305f JavaScript SDK \u3092\u4f7f\u7528\u3059\u308b\nIAM\u8a8d\u8a3c(AWS SignatureV4)\u3067APIGateway\u3092Node.js\u304b\u3089\u547c\u3073\u51fa\u3059\n\n\u4e8b\u524d\u6e96\u5099\nAPI\u3092\u5229\u7528\u3059\u308b\u305f\u3081\u306b\u306f\u3001Cross-Origin Resource Sharing (CORS) \u3092\u6709\u52b9\u306b\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u306e\u3067\u3001\u4e0b\u8a18\u306e\u30da\u30fc\u30b8\u3092\u53c2\u8003\u306bCORS\u3092\u6709\u52b9\u306b\u3057\u307e\u3059\u3002\nAPI Gateway \u30ea\u30bd\u30fc\u30b9\u306e CORS \u3092\u6709\u52b9\u306b\u3059\u308b\n\n\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\nnpm \u30b3\u30de\u30f3\u30c9\u3067\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u53ef\u80fd\u3067\u3059\u3002\nnpm install aws-api-gateway-client\n\n\nSDK\u306e\u5229\u7528\n\n\u30e2\u30b8\u30e5\u30fc\u30eb\u306e\u30ea\u30af\u30a8\u30b9\u30c8\nvar apigClientFactory = require('aws-api-gateway-client')\n\n\n\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u306e\u4f5c\u6210\nconfig \u306b invokeUrl \u3092\u8a2d\u5b9a\u3057\u3066\u3001\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u751f\u6210\u3057\u307e\u3059\u3002\u305f\u3060\u3057\u3001config \u306b\u306fIAM\u3082\u3057\u304f\u306fAPI\u30ad\u30fc\u3092\u8ffd\u52a0\u3067\u8a2d\u5b9a\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u3001\u3053\u308c\u3089\u306f\u4e0b\u8a18\u3067\u8aac\u660e\u3057\u307e\u3059\u3002\nconfig = {invokeUrl:'https://xxxxx.execute-api.us-east-1.amazonaws.com'}\nvar apigClient = apigClientFactory.newClient(config);\n\n\n\u3000IAM\u8a8d\u8a3c\nAWS\u306e\u8a8d\u8a3c\u60c5\u5831\u3092\u5229\u7528\u3057\u3066\u30a2\u30af\u30bb\u30b9\u3059\u308b\u5834\u5408\u306f\u3001\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u751f\u6210\u3059\u308b\u6642\u70b9\u3067\u3001invokeUrl \u306b\u52a0\u3048\u3066\u3001\u30a2\u30af\u30bb\u30b9\u30ad\u30fc\u3001\u30b7\u30fc\u30af\u30ec\u30c3\u30c8\u30ad\u30fc\u3001\u30bb\u30c3\u30b7\u30e7\u30f3\u30ad\u30fc\u3092\u4e0b\u8a18\u306e\u901a\u308a\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n\nvar apigClient = apigClientFactory.newClient({\n    accessKey: 'ACCESS_KEY',\n    secretKey: 'SECRET_KEY',\n    sessionToken: 'SESSION_TOKEN', //OPTIONAL: If you are using temporary credentials you must include the session token\n    region: 'eu-west-1' // OPTIONAL: The region where the API is deployed, by default this parameter is set to us-east-1\n});\n\n\n\u3000API\u30ad\u30fc\u8a8d\u8a3c\nAPI\u30ad\u30fc\u3092\u4f7f\u3046\u5834\u5408\u306f\u3001invokeUrl \u306b\u52a0\u3048\u3066\u3001\u4e0b\u8a18\u306e\u901a\u308a\u30ad\u30fc\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\nvar apigClient = apigClientFactory.newClient({\n    apiKey: 'API_KEY'\n});\n\n\n\u30d1\u30e9\u30e1\u30fc\u30bf\u306e\u8a2d\u5b9a\nvar params = {\n    //This is where any header, path, or querystring request params go. The key is the parameter named as defined in the API\n    userId: '1234',\n};\n// Template syntax follows url-template https://www.npmjs.com/package/url-template\nvar pathTemplate = '/users/{userID}/profile'\nvar method = 'GET';\nvar additionalParams = {\n    //If there are any unmodeled query parameters or headers that need to be sent with the request you can add them here\n    headers: {\n        param0: '',\n        param1: ''\n    },\n    queryParams: {\n        param0: '',\n        param1: ''\n    }\n};\nvar body = {\n    //This is where you define the body of the request\n};\n\n\nAPI\u306e\u30b3\u30fc\u30eb\n\u4e0a\u8a18\u3067\u8a2d\u5b9a\u3057\u305f\u30d1\u30e9\u30e1\u30fc\u30bf\u3092\u4e0b\u8a18\u306e\u3088\u3046\u306b\u5f15\u6570\u306b\u3068\u3063\u3066API \u3092\u30b3\u30fc\u30eb\u3057\u307e\u3059\u3002API \u306f\u30d7\u30ed\u30df\u30b9\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u8fd4\u3057\u3001\u6210\u529f\u307e\u305f\u306f\u5931\u6557\u306e\u30b3\u30fc\u30eb\u30d0\u30c3\u30af\u95a2\u6570\u3092\u547c\u3073\u307e\u3059\u3002\napigClient.invokeApi(params, pathTemplate, method, additionalParams, body)\n    .then(function(result){\n        //This is where you would put a success callback\n    }).catch( function(result){\n        //This is where you would put an error callback\n    });\n\n# \u306f\u3058\u3081\u306b\nAWS API Gateway \u306f\u4fbf\u5229\u306a\u30b5\u30fc\u30d3\u30b9\u3067\u3059\u304c\u3001Node.js \u304b\u3089\u4f7f\u304a\u3046\u3068\u3059\u308b\u3068\u3001\u81ea\u52d5\u3067\u751f\u6210\u3055\u308c\u308b JavaScript \u306eSDK\u304c\u30d6\u30e9\u30a6\u30b6\u7528\u3057\u304b\u7528\u610f\u3055\u308c\u3066\u3044\u306a\u304b\u3063\u305f\u308a\u3001\u30a8\u30f3\u30c9\u30dd\u30a4\u30f3\u30c8\u3054\u3068\u306b\u30e1\u30bd\u30c3\u30c9\u304c\u81ea\u52d5\u3067\u751f\u6210\u3055\u308c\u3066\u3044\u3066\u3001API\u306e\u30a8\u30f3\u30c9\u30dd\u30a4\u30f3\u30c8\u3092\u5909\u66f4\u3059\u308b\u3054\u3068\u306bSDK\u3092\u751f\u6210\u3057\u76f4\u3055\u306a\u3051\u308c\u3070\u306a\u3089\u306a\u304b\u3063\u305f\u308a\u3068\u4e0d\u4fbf\u3060\u3063\u305f\u305f\u3081\u3001Node.js \u304b\u3089 API Gateway \u3092\u7c21\u5358\u306b\u4f7f\u3048\u308b\u30d1\u30c3\u30b1\u30fc\u30b8\u3092\u4f5c\u308a\u307e\u3057\u305f\u3002\n\n**aws-api-gateway-client**\nhttps://github.com/kndt84/aws-api-gateway-client\n\n\u53c2\u8003\uff1a\n[API Gateway \u3067\u751f\u6210\u3057\u305f JavaScript SDK \u3092\u4f7f\u7528\u3059\u308b](\nhttp://docs.aws.amazon.com/ja_jp/apigateway/latest/developerguide/how-to-generate-sdk-javascript.html)\n[IAM\u8a8d\u8a3c(AWS SignatureV4)\u3067APIGateway\u3092Node.js\u304b\u3089\u547c\u3073\u51fa\u3059]\n(http://qiita.com/toshihirock/items/a92cbda51d5f469bb0ac)\n\n# \u4e8b\u524d\u6e96\u5099\nAPI\u3092\u5229\u7528\u3059\u308b\u305f\u3081\u306b\u306f\u3001Cross-Origin Resource Sharing (CORS) \u3092\u6709\u52b9\u306b\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u306e\u3067\u3001\u4e0b\u8a18\u306e\u30da\u30fc\u30b8\u3092\u53c2\u8003\u306bCORS\u3092\u6709\u52b9\u306b\u3057\u307e\u3059\u3002\n\n[API Gateway \u30ea\u30bd\u30fc\u30b9\u306e CORS \u3092\u6709\u52b9\u306b\u3059\u308b]\n(http://docs.aws.amazon.com/ja_jp/apigateway/latest/developerguide/how-to-cors.html)\n\n# \u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\nnpm \u30b3\u30de\u30f3\u30c9\u3067\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u53ef\u80fd\u3067\u3059\u3002\n\n```shell-session\nnpm install aws-api-gateway-client\n```\n\n# SDK\u306e\u5229\u7528\n\n## \u30e2\u30b8\u30e5\u30fc\u30eb\u306e\u30ea\u30af\u30a8\u30b9\u30c8\n\n```js\nvar apigClientFactory = require('aws-api-gateway-client')\n```\n\n## \u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u306e\u4f5c\u6210\nconfig \u306b invokeUrl \u3092\u8a2d\u5b9a\u3057\u3066\u3001\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u751f\u6210\u3057\u307e\u3059\u3002\u305f\u3060\u3057\u3001config \u306b\u306fIAM\u3082\u3057\u304f\u306fAPI\u30ad\u30fc\u3092\u8ffd\u52a0\u3067\u8a2d\u5b9a\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u3001\u3053\u308c\u3089\u306f\u4e0b\u8a18\u3067\u8aac\u660e\u3057\u307e\u3059\u3002\n\n```js\nconfig = {invokeUrl:'https://xxxxx.execute-api.us-east-1.amazonaws.com'}\nvar apigClient = apigClientFactory.newClient(config);\n```\n\n##\u3000IAM\u8a8d\u8a3c\n\nAWS\u306e\u8a8d\u8a3c\u60c5\u5831\u3092\u5229\u7528\u3057\u3066\u30a2\u30af\u30bb\u30b9\u3059\u308b\u5834\u5408\u306f\u3001\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u751f\u6210\u3059\u308b\u6642\u70b9\u3067\u3001invokeUrl \u306b\u52a0\u3048\u3066\u3001\u30a2\u30af\u30bb\u30b9\u30ad\u30fc\u3001\u30b7\u30fc\u30af\u30ec\u30c3\u30c8\u30ad\u30fc\u3001\u30bb\u30c3\u30b7\u30e7\u30f3\u30ad\u30fc\u3092\u4e0b\u8a18\u306e\u901a\u308a\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n\n```js\n\nvar apigClient = apigClientFactory.newClient({\n    accessKey: 'ACCESS_KEY',\n    secretKey: 'SECRET_KEY',\n    sessionToken: 'SESSION_TOKEN', //OPTIONAL: If you are using temporary credentials you must include the session token\n    region: 'eu-west-1' // OPTIONAL: The region where the API is deployed, by default this parameter is set to us-east-1\n});\n```\n\n##\u3000API\u30ad\u30fc\u8a8d\u8a3c\nAPI\u30ad\u30fc\u3092\u4f7f\u3046\u5834\u5408\u306f\u3001invokeUrl \u306b\u52a0\u3048\u3066\u3001\u4e0b\u8a18\u306e\u901a\u308a\u30ad\u30fc\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n\n```js\nvar apigClient = apigClientFactory.newClient({\n    apiKey: 'API_KEY'\n});\n```\n\n# \u30d1\u30e9\u30e1\u30fc\u30bf\u306e\u8a2d\u5b9a\n\n```js\nvar params = {\n    //This is where any header, path, or querystring request params go. The key is the parameter named as defined in the API\n    userId: '1234',\n};\n// Template syntax follows url-template https://www.npmjs.com/package/url-template\nvar pathTemplate = '/users/{userID}/profile'\nvar method = 'GET';\nvar additionalParams = {\n    //If there are any unmodeled query parameters or headers that need to be sent with the request you can add them here\n    headers: {\n        param0: '',\n        param1: ''\n    },\n    queryParams: {\n        param0: '',\n        param1: ''\n    }\n};\nvar body = {\n    //This is where you define the body of the request\n};\n```\n\n# API\u306e\u30b3\u30fc\u30eb\n\u4e0a\u8a18\u3067\u8a2d\u5b9a\u3057\u305f\u30d1\u30e9\u30e1\u30fc\u30bf\u3092\u4e0b\u8a18\u306e\u3088\u3046\u306b\u5f15\u6570\u306b\u3068\u3063\u3066API \u3092\u30b3\u30fc\u30eb\u3057\u307e\u3059\u3002API \u306f\u30d7\u30ed\u30df\u30b9\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u8fd4\u3057\u3001\u6210\u529f\u307e\u305f\u306f\u5931\u6557\u306e\u30b3\u30fc\u30eb\u30d0\u30c3\u30af\u95a2\u6570\u3092\u547c\u3073\u307e\u3059\u3002\n\n```\napigClient.invokeApi(params, pathTemplate, method, additionalParams, body)\n    .then(function(result){\n        //This is where you would put a success callback\n    }).catch( function(result){\n        //This is where you would put an error callback\n    });\n```\n\n\n\n\n\n\n\n"}