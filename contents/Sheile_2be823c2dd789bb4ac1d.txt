{"context": "Elastic stack\u3067\u30ed\u30b0\u5206\u6790\u3092\u884c\u3046\u4e0a\u3067\u4fbf\u5229\u306b\u4f7f\u3048\u308blogstash\u3002\n\u3053\u308c\u306b\u542b\u307e\u308c\u308bgrok\u30d5\u30a3\u30eb\u30bf\u306f\u3001Apache log\u3084Syslog\u306a\u3069\u69d8\u3005\u306a\u30ed\u30b0\u3092\u3046\u307e\u304f\u69cb\u9020\u5316\u3057\u3066\u304f\u308c\u308b\u6b63\u898f\u8868\u73fe\u304c\u8a70\u3081\u8fbc\u307e\u308c\u3066\u304a\u308a\u3001\u5206\u6790\u306e\u524d\u51e6\u7406\u3068\u3057\u3066\u4fbf\u5229\u306b\u4f7f\u7528\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\u3057\u304b\u3057\u3001\u6c17\u8efd\u306b\u30ed\u30b0\u3092\u30d1\u30fc\u30b9\u3057\u305f\u3044\u5834\u5408\u3001logstash\u30b5\u30fc\u30d0\u3092\u7acb\u3066\u305a\u3001\u5358\u7d14\u306b\u6b63\u898f\u8868\u73fe\u30de\u30c3\u30c1\u3092\u4f7f\u3044\u305f\u3044\u5834\u5408\u3082\u3042\u308a\u307e\u3059\u3002\nlogstash-grok-pattern\u306b\u542b\u307e\u308c\u308b\u30d1\u30bf\u30fc\u30f3\u3092\u4f7f\u308f\u305b\u3066\u3082\u3089\u3044\u305f\u3044\u6240\u3067\u3059\u304c\u3001\u3053\u308c\u306f\u90e8\u5206\u90e8\u5206\u306e\u6b63\u898f\u8868\u73fe\u3092\u72ec\u81ea\u5f62\u5f0f\u3067\u307e\u3068\u3081\u305f\u7269\u306b\u306a\u3063\u3066\u3044\u308b\u305f\u3081\u3001\u901a\u5e38\u306e\u6b63\u898f\u8868\u73fe\u3092\u51fa\u529b\u3059\u308b\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u66f8\u304d\u307e\u3057\u305f\u3002\n\n\u30b9\u30af\u30ea\u30d7\u30c8\nmkdir grok-regexp\ncd grok-regexp\ngit clone https://github.com/logstash-plugins/logstash-patterns-core\nvi grok-regexp.rb\n\n\ngrok-regexp.rb\n#!/bin/env ruby\n\npatterns = {}\nkeyword = ARGV[0]\n\nDir.glob('logstash-patterns-core/patterns/*') do |path|\n  File.foreach(path) do |line|\n    line.chomp!\n    next if line.start_with?('#')\n    next if line.empty?\n\n    matches = line.match(/(\\w+) (.*)/)\n    unless matches\n      puts 'Parse error on following line'\n      puts line\n      exit 1\n    end\n\n    patterns[matches[1]] = matches[2]\n  end\nend\n\ndef replace(pattern, patterns)\n  pattern.gsub(/%\\{(\\w+)(:\\w+)?\\}/) do\n    sub_pattern = replace(patterns[$1], patterns)\n    $2.nil? ? sub_pattern : \"(?<#{$2[1..-1]}>#{sub_pattern})\"\n  end\nend\n\nunless patterns.include?(keyword)\n  puts \"#{keyword} does not exists in patterns.\"\n  exit 1\nend\n\nregex = replace(patterns[keyword], patterns)\nputs regex\n\n\n\n\u4f7f\u3044\u65b9\n$ ruby grok-regexp.rb \u5909\u63db\u3057\u305f\u3044\u30d1\u30bf\u30fc\u30f3\u540d    # \u307e\u305f\u306f\u5b9f\u884c\u6a29\u9650\u4e0e\u3048\u3066./grok-regexp.rb\n\n$ ruby grok-regexp.rb MONTH\n\\b(?:[Jj]an(?:uary|uar)?|[Ff]eb(?:ruary|ruar)?|[Mm](?:a|\u00e4)?r(?:ch|z)?|[Aa]pr(?:il)?|[Mm]a(?:y|i)?|[Jj]un(?:e|i)?|[Jj]ul(?:y)?|[Aa]ug(?:ust)?|[Ss]ep(?:tember)?|[Oo](?:c|k)?t(?:ober)?|[Nn]ov(?:ember)?|[Dd]e(?:c|z)(?:ember)?)\\b\n\n$ ruby grok-regexp.rb SYSLOGBASE\n(?<timestamp>\\b(?:[Jj]an(?:uary|uar)?|[Ff]eb(?:ruary|ruar)?|[Mm](?:a|\u00e4)?r(?:ch|z)?|[Aa]pr(?:il)?|[Mm]a(?:y|i)?|[Jj]un(?:e|i)?|[Jj]ul(?:y)?|[Aa]ug(?:ust)?|[Ss]ep(?:tember)?|[Oo](?:c|k)?t(?:ober)?|[Nn]ov(?:ember)?|[Dd]e(?:c|z)(?:ember)?)\\b +(?:(?:0[1-9])|(?:[12][0-9])|(?:3[01])|[1-9]) (?!<[0-9])(?:2[0123]|[01]?[0-9]):(?:[0-5][0-9])(?::(?:(?:[0-5]?[0-9]|60)(?:[:.,][0-9]+)?))(?![0-9])) (?:<(?<facility>\\b(?:[0-9]+)\\b).(?<priority>\\b(?:[0-9]+)\\b)> )?(?<logsource>(?:(?:((([0-9A-Fa-f]{1,4}:){7}([0-9A-Fa-f]{1,4}|:))|(([0-9A-Fa-f]{1,4}:){6}(:[0-9A-Fa-f]{1,4}|((25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){5}(((:[0-9A-Fa-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){4}(((:[0-9A-Fa-f]{1,4}){1,3})|((:[0-9A-Fa-f]{1,4})?:((25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){3}(((:[0-9A-Fa-f]{1,4}){1,4})|((:[0-9A-Fa-f]{1,4}){0,2}:((25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){2}(((:[0-9A-Fa-f]{1,4}){1,5})|((:[0-9A-Fa-f]{1,4}){0,3}:((25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){1}(((:[0-9A-Fa-f]{1,4}){1,6})|((:[0-9A-Fa-f]{1,4}){0,4}:((25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3}))|:))|(:(((:[0-9A-Fa-f]{1,4}){1,7})|((:[0-9A-Fa-f]{1,4}){0,5}:((25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3}))|:)))(%.+)?|(?<![0-9])(?:(?:[0-1]?[0-9]{1,2}|2[0-4][0-9]|25[0-5])[.](?:[0-1]?[0-9]{1,2}|2[0-4][0-9]|25[0-5])[.](?:[0-1]?[0-9]{1,2}|2[0-4][0-9]|25[0-5])[.](?:[0-1]?[0-9]{1,2}|2[0-4][0-9]|25[0-5]))(?![0-9]))|\\b(?:[0-9A-Za-z][0-9A-Za-z-]{0,62})(?:\\.(?:[0-9A-Za-z][0-9A-Za-z-]{0,62}))*(\\.?|\\b))) (?<program>[\\x21-\\x5a\\x5c\\x5e-\\x7e]+)(?:\\[(?<pid>\\b(?:[1-9][0-9]*)\\b)\\])?:\n\n\n\u8a66\u3057\u306b\u6b63\u898f\u8868\u73fe\u3092\u4f7f\u3063\u3066\u307f\u308b\nsyslog = 'Jun 21 10:16:00 ip-127-0-0-1 clamd[2763]: SelfCheck: Database status OK.'\nregexp = /(?<timestamp>\\b(?:[Jj]an(?:uary|uar)?|[Ff]eb(?:ruary|ruar)?|[Mm](?:a|\u00e4)?r(?:ch|z)?|[Aa]pr(?:il)?|[Mm]a(?:y|i)?|[Jj]un(?:e|i)?|[Jj]ul(?:y)?|[Aa]ug(?:ust)?|[Ss]ep(?:tember)?|[Oo](?:c|k)?t(?:ober)?|[Nn]ov(?:ember)?|[Dd]e(?:c|z)(?:ember)?)\\b +(?:(?:0[1-9])|(?:[12][0-9])|(?:3[01])|[1-9]) (?!<[0-9])(?:2[0123]|[01]?[0-9]):(?:[0-5][0-9])(?::(?:(?:[0-5]?[0-9]|60)(?:[:.,][0-9]+)?))(?![0-9])) (?:<(?<facility>\\b(?:[0-9]+)\\b).(?<priority>\\b(?:[0-9]+)\\b)> )?(?<logsource>(?:(?:((([0-9A-Fa-f]{1,4}:){7}([0-9A-Fa-f]{1,4}|:))|(([0-9A-Fa-f]{1,4}:){6}(:[0-9A-Fa-f]{1,4}|((25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){5}(((:[0-9A-Fa-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){4}(((:[0-9A-Fa-f]{1,4}){1,3})|((:[0-9A-Fa-f]{1,4})?:((25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){3}(((:[0-9A-Fa-f]{1,4}){1,4})|((:[0-9A-Fa-f]{1,4}){0,2}:((25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){2}(((:[0-9A-Fa-f]{1,4}){1,5})|((:[0-9A-Fa-f]{1,4}){0,3}:((25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){1}(((:[0-9A-Fa-f]{1,4}){1,6})|((:[0-9A-Fa-f]{1,4}){0,4}:((25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3}))|:))|(:(((:[0-9A-Fa-f]{1,4}){1,7})|((:[0-9A-Fa-f]{1,4}){0,5}:((25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3}))|:)))(%.+)?|(?<![0-9])(?:(?:[0-1]?[0-9]{1,2}|2[0-4][0-9]|25[0-5])[.](?:[0-1]?[0-9]{1,2}|2[0-4][0-9]|25[0-5])[.](?:[0-1]?[0-9]{1,2}|2[0-4][0-9]|25[0-5])[.](?:[0-1]?[0-9]{1,2}|2[0-4][0-9]|25[0-5]))(?![0-9]))|\\b(?:[0-9A-Za-z][0-9A-Za-z-]{0,62})(?:\\.(?:[0-9A-Za-z][0-9A-Za-z-]{0,62}))*(\\.?|\\b))) (?<program>[\\x21-\\x5a\\x5c\\x5e-\\x7e]+)(?:\\[(?<pid>\\b(?:[1-9][0-9]*)\\b)\\])?:/\nsyslog.match(regexp)\n=> #<MatchData\n \"Jun 21 10:16:00 ip-127-0-0-1 clamd[2763]:\"\n timestamp:\"Jun 21 10:16:00\"\n facility:nil\n priority:nil\n logsource:\"ip-127-0-0-1\"\n program:\"clamd\"\n pid:\"2763\">\n\nElastic stack\u3067\u30ed\u30b0\u5206\u6790\u3092\u884c\u3046\u4e0a\u3067\u4fbf\u5229\u306b\u4f7f\u3048\u308blogstash\u3002\n\u3053\u308c\u306b\u542b\u307e\u308c\u308bgrok\u30d5\u30a3\u30eb\u30bf\u306f\u3001Apache log\u3084Syslog\u306a\u3069\u69d8\u3005\u306a\u30ed\u30b0\u3092\u3046\u307e\u304f\u69cb\u9020\u5316\u3057\u3066\u304f\u308c\u308b\u6b63\u898f\u8868\u73fe\u304c\u8a70\u3081\u8fbc\u307e\u308c\u3066\u304a\u308a\u3001\u5206\u6790\u306e\u524d\u51e6\u7406\u3068\u3057\u3066\u4fbf\u5229\u306b\u4f7f\u7528\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n\u3057\u304b\u3057\u3001\u6c17\u8efd\u306b\u30ed\u30b0\u3092\u30d1\u30fc\u30b9\u3057\u305f\u3044\u5834\u5408\u3001logstash\u30b5\u30fc\u30d0\u3092\u7acb\u3066\u305a\u3001\u5358\u7d14\u306b\u6b63\u898f\u8868\u73fe\u30de\u30c3\u30c1\u3092\u4f7f\u3044\u305f\u3044\u5834\u5408\u3082\u3042\u308a\u307e\u3059\u3002\n[logstash-grok-pattern](https://github.com/logstash-plugins/logstash-patterns-core)\u306b\u542b\u307e\u308c\u308b\u30d1\u30bf\u30fc\u30f3\u3092\u4f7f\u308f\u305b\u3066\u3082\u3089\u3044\u305f\u3044\u6240\u3067\u3059\u304c\u3001\u3053\u308c\u306f\u90e8\u5206\u90e8\u5206\u306e\u6b63\u898f\u8868\u73fe\u3092\u72ec\u81ea\u5f62\u5f0f\u3067\u307e\u3068\u3081\u305f\u7269\u306b\u306a\u3063\u3066\u3044\u308b\u305f\u3081\u3001\u901a\u5e38\u306e\u6b63\u898f\u8868\u73fe\u3092\u51fa\u529b\u3059\u308b\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u66f8\u304d\u307e\u3057\u305f\u3002\n\n\u30b9\u30af\u30ea\u30d7\u30c8\n--------------------------\n```bash\nmkdir grok-regexp\ncd grok-regexp\ngit clone https://github.com/logstash-plugins/logstash-patterns-core\nvi grok-regexp.rb\n```\n\n```ruby:grok-regexp.rb\n#!/bin/env ruby\n\npatterns = {}\nkeyword = ARGV[0]\n\nDir.glob('logstash-patterns-core/patterns/*') do |path|\n  File.foreach(path) do |line|\n    line.chomp!\n    next if line.start_with?('#')\n    next if line.empty?\n\n    matches = line.match(/(\\w+) (.*)/)\n    unless matches\n      puts 'Parse error on following line'\n      puts line\n      exit 1\n    end\n\n    patterns[matches[1]] = matches[2]\n  end\nend\n\ndef replace(pattern, patterns)\n  pattern.gsub(/%\\{(\\w+)(:\\w+)?\\}/) do\n    sub_pattern = replace(patterns[$1], patterns)\n    $2.nil? ? sub_pattern : \"(?<#{$2[1..-1]}>#{sub_pattern})\"\n  end\nend\n\nunless patterns.include?(keyword)\n  puts \"#{keyword} does not exists in patterns.\"\n  exit 1\nend\n\nregex = replace(patterns[keyword], patterns)\nputs regex\n```\n\n\n\u4f7f\u3044\u65b9\n----------------------\n```bash\n$ ruby grok-regexp.rb \u5909\u63db\u3057\u305f\u3044\u30d1\u30bf\u30fc\u30f3\u540d    # \u307e\u305f\u306f\u5b9f\u884c\u6a29\u9650\u4e0e\u3048\u3066./grok-regexp.rb\n\n$ ruby grok-regexp.rb MONTH\n\\b(?:[Jj]an(?:uary|uar)?|[Ff]eb(?:ruary|ruar)?|[Mm](?:a|\u00e4)?r(?:ch|z)?|[Aa]pr(?:il)?|[Mm]a(?:y|i)?|[Jj]un(?:e|i)?|[Jj]ul(?:y)?|[Aa]ug(?:ust)?|[Ss]ep(?:tember)?|[Oo](?:c|k)?t(?:ober)?|[Nn]ov(?:ember)?|[Dd]e(?:c|z)(?:ember)?)\\b\n\n$ ruby grok-regexp.rb SYSLOGBASE\n(?<timestamp>\\b(?:[Jj]an(?:uary|uar)?|[Ff]eb(?:ruary|ruar)?|[Mm](?:a|\u00e4)?r(?:ch|z)?|[Aa]pr(?:il)?|[Mm]a(?:y|i)?|[Jj]un(?:e|i)?|[Jj]ul(?:y)?|[Aa]ug(?:ust)?|[Ss]ep(?:tember)?|[Oo](?:c|k)?t(?:ober)?|[Nn]ov(?:ember)?|[Dd]e(?:c|z)(?:ember)?)\\b +(?:(?:0[1-9])|(?:[12][0-9])|(?:3[01])|[1-9]) (?!<[0-9])(?:2[0123]|[01]?[0-9]):(?:[0-5][0-9])(?::(?:(?:[0-5]?[0-9]|60)(?:[:.,][0-9]+)?))(?![0-9])) (?:<(?<facility>\\b(?:[0-9]+)\\b).(?<priority>\\b(?:[0-9]+)\\b)> )?(?<logsource>(?:(?:((([0-9A-Fa-f]{1,4}:){7}([0-9A-Fa-f]{1,4}|:))|(([0-9A-Fa-f]{1,4}:){6}(:[0-9A-Fa-f]{1,4}|((25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){5}(((:[0-9A-Fa-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){4}(((:[0-9A-Fa-f]{1,4}){1,3})|((:[0-9A-Fa-f]{1,4})?:((25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){3}(((:[0-9A-Fa-f]{1,4}){1,4})|((:[0-9A-Fa-f]{1,4}){0,2}:((25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){2}(((:[0-9A-Fa-f]{1,4}){1,5})|((:[0-9A-Fa-f]{1,4}){0,3}:((25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){1}(((:[0-9A-Fa-f]{1,4}){1,6})|((:[0-9A-Fa-f]{1,4}){0,4}:((25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3}))|:))|(:(((:[0-9A-Fa-f]{1,4}){1,7})|((:[0-9A-Fa-f]{1,4}){0,5}:((25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3}))|:)))(%.+)?|(?<![0-9])(?:(?:[0-1]?[0-9]{1,2}|2[0-4][0-9]|25[0-5])[.](?:[0-1]?[0-9]{1,2}|2[0-4][0-9]|25[0-5])[.](?:[0-1]?[0-9]{1,2}|2[0-4][0-9]|25[0-5])[.](?:[0-1]?[0-9]{1,2}|2[0-4][0-9]|25[0-5]))(?![0-9]))|\\b(?:[0-9A-Za-z][0-9A-Za-z-]{0,62})(?:\\.(?:[0-9A-Za-z][0-9A-Za-z-]{0,62}))*(\\.?|\\b))) (?<program>[\\x21-\\x5a\\x5c\\x5e-\\x7e]+)(?:\\[(?<pid>\\b(?:[1-9][0-9]*)\\b)\\])?:\n```\n\n\n\u8a66\u3057\u306b\u6b63\u898f\u8868\u73fe\u3092\u4f7f\u3063\u3066\u307f\u308b\n----------------------\n```ruby\nsyslog = 'Jun 21 10:16:00 ip-127-0-0-1 clamd[2763]: SelfCheck: Database status OK.'\nregexp = /(?<timestamp>\\b(?:[Jj]an(?:uary|uar)?|[Ff]eb(?:ruary|ruar)?|[Mm](?:a|\u00e4)?r(?:ch|z)?|[Aa]pr(?:il)?|[Mm]a(?:y|i)?|[Jj]un(?:e|i)?|[Jj]ul(?:y)?|[Aa]ug(?:ust)?|[Ss]ep(?:tember)?|[Oo](?:c|k)?t(?:ober)?|[Nn]ov(?:ember)?|[Dd]e(?:c|z)(?:ember)?)\\b +(?:(?:0[1-9])|(?:[12][0-9])|(?:3[01])|[1-9]) (?!<[0-9])(?:2[0123]|[01]?[0-9]):(?:[0-5][0-9])(?::(?:(?:[0-5]?[0-9]|60)(?:[:.,][0-9]+)?))(?![0-9])) (?:<(?<facility>\\b(?:[0-9]+)\\b).(?<priority>\\b(?:[0-9]+)\\b)> )?(?<logsource>(?:(?:((([0-9A-Fa-f]{1,4}:){7}([0-9A-Fa-f]{1,4}|:))|(([0-9A-Fa-f]{1,4}:){6}(:[0-9A-Fa-f]{1,4}|((25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){5}(((:[0-9A-Fa-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){4}(((:[0-9A-Fa-f]{1,4}){1,3})|((:[0-9A-Fa-f]{1,4})?:((25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){3}(((:[0-9A-Fa-f]{1,4}){1,4})|((:[0-9A-Fa-f]{1,4}){0,2}:((25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){2}(((:[0-9A-Fa-f]{1,4}){1,5})|((:[0-9A-Fa-f]{1,4}){0,3}:((25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){1}(((:[0-9A-Fa-f]{1,4}){1,6})|((:[0-9A-Fa-f]{1,4}){0,4}:((25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3}))|:))|(:(((:[0-9A-Fa-f]{1,4}){1,7})|((:[0-9A-Fa-f]{1,4}){0,5}:((25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3}))|:)))(%.+)?|(?<![0-9])(?:(?:[0-1]?[0-9]{1,2}|2[0-4][0-9]|25[0-5])[.](?:[0-1]?[0-9]{1,2}|2[0-4][0-9]|25[0-5])[.](?:[0-1]?[0-9]{1,2}|2[0-4][0-9]|25[0-5])[.](?:[0-1]?[0-9]{1,2}|2[0-4][0-9]|25[0-5]))(?![0-9]))|\\b(?:[0-9A-Za-z][0-9A-Za-z-]{0,62})(?:\\.(?:[0-9A-Za-z][0-9A-Za-z-]{0,62}))*(\\.?|\\b))) (?<program>[\\x21-\\x5a\\x5c\\x5e-\\x7e]+)(?:\\[(?<pid>\\b(?:[1-9][0-9]*)\\b)\\])?:/\nsyslog.match(regexp)\n=> #<MatchData\n \"Jun 21 10:16:00 ip-127-0-0-1 clamd[2763]:\"\n timestamp:\"Jun 21 10:16:00\"\n facility:nil\n priority:nil\n logsource:\"ip-127-0-0-1\"\n program:\"clamd\"\n pid:\"2763\">\n```\n", "tags": ["Ruby", "Logstash", "\u6b63\u898f\u8868\u73fe"]}