{"tags": ["JavaScript", "photoshop", "Bridge"], "context": "Lab\u3092\u6307\u5b9a\u3057\u3001L\u306e\u307f0\u301c100\u3057\u305f\u30b0\u30e9\u30c7\u306eCMYK\u5024\u3092Photoshop\u306b\u5410\u304d\u51fa\u3055\u305b\u3066\u3001Bridge\u3067\u8aad\u307f\u8fbc\u307f\u753b\u50cf\u306b\u3057\u307e\u3059\u3002\n\u6c5a\u3044\u3051\u3069\u4e00\u5fdc\u3046\u3054\u304f\u304b\u3089\u89e6\u3089\u306a\u3044\uff01\uff08\u518d\nPhotoshop\u74b0\u5883\u8a2d\u5b9a\u306eCMYK\u30d7\u30ed\u30d5\u30a1\u30a4\u30eb\uff0b\u30de\u30c3\u30c1\u30f3\u30b0\u65b9\u6cd5\u3092\u8a2d\u5b9a\u3057\u3066\u304a\u3044\u3066\u5b9f\u884c\u3002\n\u30ab\u30e9\u30fc\u30d4\u30c3\u30ab\u30fc\u3067\u4efb\u610f\u306e\u8272\u3092\u9078\u629e\u3059\u308b\u3068\u3001\u30c7\u30b9\u30af\u30c8\u30c3\u30d7\u306b\u30d7\u30ed\u30d5\u30a1\u30a4\u30eb\u540d\uff0bLab\u306eA\uff0bLab\u306eB\u306e\u30d5\u30a1\u30a4\u30eb\u540d\u306e\u30c6\u30ad\u30b9\u30c8\u3092\u66f8\u304d\u51fa\u3059\u3002\n\nPhotoshopCMYK.jsx\n#target photoshop\nvar myColor = new SolidColor;\napp.showColorPicker();\n\nvar doc = app.documents.add(100, 50, 72, \"CMYK Separation Curves\", NewDocumentMode.CMYK);\nvar profile_name = doc.colorProfileName;\nvar myFColor = app.foregroundColor.lab.a+'_'+app.foregroundColor.lab.b;\ndoc.close(SaveOptions.DONOTSAVECHANGES);\nprofile_name=profile_name.replace (/\\//g, '_');\n\nvar myFile=new File('~/Desktop/'+profile_name+'_'+myFColor);\nmyFile.open(\"w\");\nmyFile.encoding='BINARY';\nfor (var myG=0;myG<101;myG++){\n    myColor.lab.l=myG;\n    myColor.lab.a = app.foregroundColor.lab.a;\n    myColor.lab.b = app.foregroundColor.lab.b;\n    myC = myColor.cmyk.cyan;\n    myM = myColor.cmyk.magenta;\n    myY = myColor.cmyk.yellow;\n    myK = myColor.cmyk.black;\n    myR = myColor.rgb.red;\n    myGr = myColor.rgb.green;\n    myB = myColor.rgb.blue;   \n    myWrite = myG+\"\\t\"+myR+\"\\t\"+myGr+\"\\t\"+myB+\"\\t\"+myC+\"\\t\"+myM+\"\\t\"+myY+\"\\t\"+myK;\n    myFile.writeln(myWrite);\n\n    }\nmyFile.close();\n\n\nBridge\u3067\u66f8\u304d\u51fa\u3057\u305f\u30c6\u30ad\u30b9\u30c8\u3092\u9078\u629e\u3057\u3066\u304a\u3044\u3066\u5b9f\u884c\u3002\n\u30c7\u30b9\u30af\u30c8\u30c3\u30d7\u306bgrid.png\u3092\u7f6e\u3044\u3066\u304a\u304d\u3001\u305d\u306e\u4e0a\u306b\u63cf\u753b\u3059\u308b\u3002\n\u30d5\u30a1\u30a4\u30eb\u540d\u306f\u30c6\u30ad\u30b9\u30c8\u30d5\u30a1\u30a4\u30eb\u540d\uff0bjpg\n\nBridgeCMYKChart.jsx\n#target \"Bridge\"\nvar myFile=app.document.selections;\nvar mySc=File(myFile[0].path);\n\nvar myLine=new Array();\nmySc.open(\"r\");\nwhile(!mySc.eof){myLine.push(mySc.readln());}\nmySc.close();\n\nvar myImg=new BitmapData(new File(\"~/Desktop/grid.png\"));\n\nvar myAry=new Array();\nfor(var i=0;i<100;i++){\n    myAry[i]=myLine[i].split(\"\\t\");\n\n    var myColor=new Color(0,255,255);\n    var myColor2 = new Color(myAry[i][1],myAry[i][2],myAry[i][3]);\n    myDraw2(i*4,201,myColor2);\nmyDraw(i*4, 200-myAry[i][4]*2,myColor);\n        var myColor=new Color(255,0,255);\nmyDraw(i*4, 200-myAry[i][5]*2, myColor);\n        var myColor=new Color(255,255,0);\n myDraw(i*4, 200-myAry[i][6]*2, myColor);\n        var myColor=new Color(0,0,0);\n myDraw (i*4, 200-myAry[i][7]*2, myColor);\n\n}\n\nmyImg.exportTo(new File(myFile[0].path+\".jpg\"),100);\n\nfunction myDraw(x,y,c){\n    for(var a=0;a<4;a++){\n        for(var b=0;b<2;b++){\n    myImg.setPixel (x+a, y+b, c);\n    }\n}\n}\nfunction myDraw2(x,y,c){\n    for(var a=0;a<4;a++){\n        for(var b=0;b<20;b++){\n    myImg.setPixel (x+a, y+b, c);\n    }\n}\n}\n\n\n\ngrid.png\n\u30c7\u30b9\u30af\u30c8\u30c3\u30d7\u306b\u7f6e\u3044\u3066\u304a\u304f\u3002\n\n\nLab\u3092\u6307\u5b9a\u3057\u3001L\u306e\u307f0\u301c100\u3057\u305f\u30b0\u30e9\u30c7\u306eCMYK\u5024\u3092Photoshop\u306b\u5410\u304d\u51fa\u3055\u305b\u3066\u3001Bridge\u3067\u8aad\u307f\u8fbc\u307f\u753b\u50cf\u306b\u3057\u307e\u3059\u3002\n\u6c5a\u3044\u3051\u3069\u4e00\u5fdc\u3046\u3054\u304f\u304b\u3089\u89e6\u3089\u306a\u3044\uff01\uff08\u518d\n\nPhotoshop\u74b0\u5883\u8a2d\u5b9a\u306eCMYK\u30d7\u30ed\u30d5\u30a1\u30a4\u30eb\uff0b\u30de\u30c3\u30c1\u30f3\u30b0\u65b9\u6cd5\u3092\u8a2d\u5b9a\u3057\u3066\u304a\u3044\u3066\u5b9f\u884c\u3002\n\u30ab\u30e9\u30fc\u30d4\u30c3\u30ab\u30fc\u3067\u4efb\u610f\u306e\u8272\u3092\u9078\u629e\u3059\u308b\u3068\u3001\u30c7\u30b9\u30af\u30c8\u30c3\u30d7\u306b\u30d7\u30ed\u30d5\u30a1\u30a4\u30eb\u540d\uff0bLab\u306eA\uff0bLab\u306eB\u306e\u30d5\u30a1\u30a4\u30eb\u540d\u306e\u30c6\u30ad\u30b9\u30c8\u3092\u66f8\u304d\u51fa\u3059\u3002\n\n```Javascript:PhotoshopCMYK.jsx\n#target photoshop\nvar myColor = new SolidColor;\napp.showColorPicker();\n\nvar doc = app.documents.add(100, 50, 72, \"CMYK Separation Curves\", NewDocumentMode.CMYK);\nvar profile_name = doc.colorProfileName;\nvar myFColor = app.foregroundColor.lab.a+'_'+app.foregroundColor.lab.b;\ndoc.close(SaveOptions.DONOTSAVECHANGES);\nprofile_name=profile_name.replace (/\\//g, '_');\n\nvar myFile=new File('~/Desktop/'+profile_name+'_'+myFColor);\nmyFile.open(\"w\");\nmyFile.encoding='BINARY';\nfor (var myG=0;myG<101;myG++){\n    myColor.lab.l=myG;\n    myColor.lab.a = app.foregroundColor.lab.a;\n    myColor.lab.b = app.foregroundColor.lab.b;\n    myC = myColor.cmyk.cyan;\n    myM = myColor.cmyk.magenta;\n    myY = myColor.cmyk.yellow;\n    myK = myColor.cmyk.black;\n    myR = myColor.rgb.red;\n    myGr = myColor.rgb.green;\n    myB = myColor.rgb.blue;   \n    myWrite = myG+\"\\t\"+myR+\"\\t\"+myGr+\"\\t\"+myB+\"\\t\"+myC+\"\\t\"+myM+\"\\t\"+myY+\"\\t\"+myK;\n    myFile.writeln(myWrite);\n        \n    }\nmyFile.close();\n```\n\nBridge\u3067\u66f8\u304d\u51fa\u3057\u305f\u30c6\u30ad\u30b9\u30c8\u3092\u9078\u629e\u3057\u3066\u304a\u3044\u3066\u5b9f\u884c\u3002\n\u30c7\u30b9\u30af\u30c8\u30c3\u30d7\u306bgrid.png\u3092\u7f6e\u3044\u3066\u304a\u304d\u3001\u305d\u306e\u4e0a\u306b\u63cf\u753b\u3059\u308b\u3002\n\u30d5\u30a1\u30a4\u30eb\u540d\u306f\u30c6\u30ad\u30b9\u30c8\u30d5\u30a1\u30a4\u30eb\u540d\uff0bjpg\n\n```Javascript:BridgeCMYKChart.jsx\n#target \"Bridge\"\nvar myFile=app.document.selections;\nvar mySc=File(myFile[0].path);\n\nvar myLine=new Array();\nmySc.open(\"r\");\nwhile(!mySc.eof){myLine.push(mySc.readln());}\nmySc.close();\n\nvar myImg=new BitmapData(new File(\"~/Desktop/grid.png\"));\n\nvar myAry=new Array();\nfor(var i=0;i<100;i++){\n    myAry[i]=myLine[i].split(\"\\t\");\n \n    var myColor=new Color(0,255,255);\n    var myColor2 = new Color(myAry[i][1],myAry[i][2],myAry[i][3]);\n    myDraw2(i*4,201,myColor2);\nmyDraw(i*4, 200-myAry[i][4]*2,myColor);\n        var myColor=new Color(255,0,255);\nmyDraw(i*4, 200-myAry[i][5]*2, myColor);\n        var myColor=new Color(255,255,0);\n myDraw(i*4, 200-myAry[i][6]*2, myColor);\n        var myColor=new Color(0,0,0);\n myDraw (i*4, 200-myAry[i][7]*2, myColor);\n \n}\n\nmyImg.exportTo(new File(myFile[0].path+\".jpg\"),100);\n\nfunction myDraw(x,y,c){\n    for(var a=0;a<4;a++){\n        for(var b=0;b<2;b++){\n    myImg.setPixel (x+a, y+b, c);\n    }\n}\n}\nfunction myDraw2(x,y,c){\n    for(var a=0;a<4;a++){\n        for(var b=0;b<20;b++){\n    myImg.setPixel (x+a, y+b, c);\n    }\n}\n}\n```\n\n##grid.png\n\n\u30c7\u30b9\u30af\u30c8\u30c3\u30d7\u306b\u7f6e\u3044\u3066\u304a\u304f\u3002\n\n![grid.png](https://qiita-image-store.s3.amazonaws.com/0/35477/7b1af952-b411-f610-b07d-e89c317d0f49.png \"grid.png\")\n"}