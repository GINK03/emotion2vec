{"tags": ["Python2.x", "JSON", "Validation", "Voluptuous"], "context": " More than 1 year has passed since last update.Python\u3067Voluptuous\u30e9\u30a4\u30d6\u30e9\u30ea\u3092\u4f7f\u3063\u3066JSON\u306e\u5024\u306e\u691c\u8a3c(validation)\u3092\u5b9f\u65bd\u3059\u308b\u65b9\u6cd5\u3002\n\nVoluptuous\u3068\u306f\nPython\u306eJSON\u7b49\u306evalidation\u30e9\u30a4\u30d6\u30e9\u30ea\u3002\n\u516c\u5f0f\u30ea\u30dd\u30b8\u30c8\u30ea\uff1a https://github.com/alecthomas/voluptuous\n\nVoluptuous, despite the name, is a Python data validation library. It is primarily intended for validating data coming into Python as JSON, YAML, etc.\n\n\u30ea\u30dd\u30b8\u30c8\u30ea\u5185\u306e\u8aac\u660e\u3067\u3082\u89e6\u308c\u3066\u3044\u308b\u304c\u3001\u3059\u3054\u3044\u540d\u524d\u3060\u3002\n\nvoluptuous\n1 \u8089\u6b32\u306b\u3075\u3051\u308b\uff0c\u9152\u8272\u306b\u304a\u307c\u308c\u308b\uff0c\u5b98\u80fd\u7684\u306a.\n2 \u8089\u611f\u7684\u306a\uff0c\u8272\u3063\u307d\u3044\uff0c\u3042\u3060\u3063\u307d\u3044\uff0c\u30bb\u30af\u30b7\u30fc\u306a.\n3\u3008\u611f\u89e6\u306a\u3069\u3009\u5fc3\u5730\u3088\u3044.\n\n\n\ninstall\n\nPython 2.6\u4ee5\u4e0a\npip\u3067\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3067\u304d\u308b\u3002\n# pip install voluptuous\n\n\nPython 2.5\n\u516c\u5f0f\u3067\u306f\u975e\u30b5\u30dd\u30fc\u30c8\u306a\u3082\u306e\u306e Python2.5\u3067Voluptuous\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b \u3067\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3068\u672c\u8a18\u4e8b\u30ec\u30d9\u30eb\u306e\u52d5\u4f5c\u306f\u53ef\u3002\n\nSample program\n\u52d5\u4f5c\u3092\u793a\u3059\u30b5\u30f3\u30d7\u30eb\u30d7\u30ed\u30b0\u30e9\u30e0\u3002\nget_schema \u5185\u306eSchema\u5ba3\u8a00\u304c\u6838\u3068\u306a\u308b\u3068\u3053\u308d\u3002\n\u3053\u308c\u304cVoluptuous\u3067\u306eJSON\u30b9\u30ad\u30fc\u30de\u306e\u5b9a\u7fa9\u3068\u306a\u308b\u3002\nfrom __future__ import with_statement\nimport re\nimport sys\nimport json  # Python 2.5\u3067\u306fsimplejson\nimport six\nfrom voluptuous import Schema, Required, Any, Range, Invalid, ALLOW_EXTRA\n\n\ndef validate_io_size(v):\n    if re.search(\"^[0-9]+[bkm]\", v) is None:\n        raise Invalid(\"not a valid value (%s)\" % str(v))\n\n\ndef get_schema():\n    schema = Schema({\n        \"comment\"                   : six.text_type,\n        Required(\"operation\")       : Any(\"read\", \"write\"),\n        \"thread\"                    : Range(min=1),\n        Required(\"io_size\")         : validate_io_size,\n        Required(\"access_percentage\")   : Range(min=1, max=100),\n    }, extra=ALLOW_EXTRA)\n\n    return schema\n\n\ndef main():\n    schema  = get_schema()\n\n    with open(sys.argv[1], \"r\") as fp:\n        dict_sample = json.load(fp)\n\n    schema(dict_sample)\n    six.print_(dict_sample)\n\n    return 0\n\n\nif __name__ == '__main__':\n    sys.exit(main())\n\n\n\u8a73\u7d30\n\nVoluptuous\u7528\u8a9e\n\n\n\n\u30ad\u30fc\u30ef\u30fc\u30c9\n\u610f\u5473\n\n\n\n\nRequired\n\u5fc5\u9808\u30d1\u30e9\u30e1\u30fc\u30bf\u3002\u3053\u308c\u3092\u3064\u3051\u3066\u3044\u306a\u3044\u30d1\u30e9\u30e1\u30fc\u30bf\u306f\u7701\u3044\u3066\u3082\u30a8\u30e9\u30fc\u306b\u306a\u3089\u306a\u3044\u3002\n\n\nAny\n\u5ba3\u8a00\u4e2d\u306e\u3044\u305a\u308c\u304b\u306e\u5024\u306a\u3089OK\u3002\n\n\nRange\nmin\u4ee5\u4e0a\u3001max\u4ee5\u4e0b\u306a\u3089OK\u3002min or max\u306e\u307f\u6307\u5b9a\u3059\u308b\u3053\u3068\u3082\u3067\u304d\u308b\u3002\n\n\nALLOW_EXTRA\n\u30b9\u30ad\u30fc\u30de\u306b\u5b9a\u7fa9\u304c\u7121\u3044\u30d1\u30e9\u30e1\u30fc\u30bf\u306e\u5b58\u5728\u3092\u8a31\u3059\u3002\n\n\n\n\nvalidation\u306e\u65b9\u6cd5\n\u4ee5\u4e0b\u306e\u3044\u305a\u308c\u304b\n\n\u53d6\u308a\u5f97\u308b\u5024\u306e\u76f4\u63a5\u6307\u5b9a\u3002Any\u3001Range\u3001\u7b49\u3067\u5e45\u3092\u6301\u305f\u305b\u308b\u3053\u3068\u3082\u3067\u304d\u308b\u3002\n\u30af\u30e9\u30b9(int, float\u7b49\u306e\u4ed6\u3001six.text_type\u3068\u3044\u3063\u305f\u6307\u5b9a\u3082\u53ef)\n\n\n\u30af\u30e9\u30b9\u304c\u5408\u81f4\u3057\u3066\u3044\u308c\u3070\u5024\u306f\u4f55\u3067\u3082OK\n\n\nvalidation\u95a2\u6570\u3092\u6307\u5b9a\u3059\u308b\n\n\n\u524d\u8ff0\u306evalidate_io_size\u95a2\u6570\u304c\u3053\u308c\nvalidation\u95a2\u6570\u306f\u6761\u4ef6\u3092\u6e80\u305f\u3055\u306a\u3044\u5834\u5408\u306fInvalid\u4f8b\u5916\u3092\u6295\u3052\u308b\n\n\n\n\n\u52d5\u4f5c\u4f8b\n\n\u74b0\u5883\n\nPython 2.5/2.7\nvoluptuous 0.8.8\n\n\n\u6b63\u5e38\u52d5\u4f5c\u4f8b\n\nvalid1.json\n{\n    \"comment\"           : \"comment\",\n    \"operation\"         : \"write\",\n    \"thread\"            : 8,\n    \"io_size\"           : \"8k\",\n    \"access_percentage\" : 100\n}\n\n\n# python voluptuous_sample.py valid1.json\n{u'comment': u'comment', u'operation': u'write', u'access_percentage': 100, u'thread': 8, u'io_size': u'8k'}\n#\n\n\n\u6b63\u5e38\u52d5\u4f5c\u4f8b(\u5fc5\u9808\u30d1\u30e9\u30e1\u30fc\u30bf\u7701\u7565)\n\nvalid2.json\n{\n    \"operation\"         : \"write\",\n    \"io_size\"           : \"8k\",\n    \"access_percentage\" : 100\n}\n\n\n# python voluptuous_sample.py valid2.json\n{u'operation': u'write', u'access_percentage': 100, u'io_size': u'8k'}\n\n\u5fc5\u9808\u30d1\u30e9\u30e1\u30fc\u30bf\u610f\u5916\u306f\u7121\u304f\u3066\u3082\u30a8\u30e9\u30fc\u306b\u306a\u3089\u306a\u3044\u3002\n\n\u30a8\u30e9\u30fc\u52d5\u4f5c\u4f8b\n\ninvalid.json\n{\n    \"comment\"           : \"comment\",\n    \"operation\"         : \"<invalid value>\",\n    \"thread\"            : 8,\n    \"io_size\"           : \"8k\",\n    \"access_percentage\" : 100\n}\n\n\n# python voluptuous_sample.py invalid.json\nTraceback (most recent call last):\n  File \"voluptuous_sample.py\", line 36, in <module>\n    sys.exit(main())\n  File \"voluptuous_sample.py\", line 29, in main\n    schema(dict_sample)\n  File \"/usr/local/lib/python2.7/dist-packages/voluptuous.py\", line 337, in __call__\n    return self._compiled([], data)\n  File \"/usr/local/lib/python2.7/dist-packages/voluptuous.py\", line 635, in validate_dict\n    return base_validate(path, iteritems(data), out)\n  File \"/usr/local/lib/python2.7/dist-packages/voluptuous.py\", line 471, in validate_mapping\n    raise MultipleInvalid(errors)\nvoluptuous.MultipleInvalid: not a valid value for dictionary value @ data[u'operation']\n#\n\n\u30b9\u30ad\u30fc\u30de\u306b\u5408\u81f4\u3057\u306a\u3044\u30d1\u30e9\u30e1\u30fc\u30bf\u304c\u3042\u308b\u3068voluptuous.MultipleInvalid\u304c\u9001\u51fa\u3055\u308c\u3001\n\u30d1\u30e9\u30e1\u30fc\u30bf\uff08\u4f8b\u3067\u306foperation)\u306e\u5024\u304c\u6b63\u3057\u304f\u306a\u3044\u3088\u3001\u3068\u3044\u3046\u30e1\u30c3\u30bb\u30fc\u30b8\u304c\u51fa\u308b\u3002\n\n\u30a8\u30e9\u30fc\u52d5\u4f5c\u4f8b(validation\u95a2\u6570\u6307\u5b9a\u6642)\n\ninvalid2.json\n{\n    \"comment\"           : \"comment\",\n    \"operation\"         : \"write\",\n    \"thread\"            : 8,\n    \"io_size\"           : \"a8k\",\n    \"access_percentage\" : 100\n}\n\n\n# python voluptuous_sample.py invalid2.json\nTraceback (most recent call last):\n  File \"voluptuous_sample.py\", line 38, in <module>\n    sys.exit(main())\n  File \"voluptuous_sample.py\", line 31, in main\n    schema(dict_sample)\n  File \"/usr/local/lib/python2.7/dist-packages/voluptuous.py\", line 337, in __call__\n    return self._compiled([], data)\n  File \"/usr/local/lib/python2.7/dist-packages/voluptuous.py\", line 635, in validate_dict\n    return base_validate(path, iteritems(data), out)\n  File \"/usr/local/lib/python2.7/dist-packages/voluptuous.py\", line 471, in validate_mapping\n    raise MultipleInvalid(errors)\nvoluptuous.MultipleInvalid: not a valid value (a8k) for dictionary value @ data[u'io_size']\n\nvalidation\u95a2\u6570\u3092\u6307\u5b9a\u3057\u305f\u5834\u5408\u3082\u3053\u306e\u3088\u3046\u306b\u3002\nPython\u3067Voluptuous\u30e9\u30a4\u30d6\u30e9\u30ea\u3092\u4f7f\u3063\u3066JSON\u306e\u5024\u306e\u691c\u8a3c(validation)\u3092\u5b9f\u65bd\u3059\u308b\u65b9\u6cd5\u3002\n\n# Voluptuous\u3068\u306f\nPython\u306eJSON\u7b49\u306evalidation\u30e9\u30a4\u30d6\u30e9\u30ea\u3002\n\n\u516c\u5f0f\u30ea\u30dd\u30b8\u30c8\u30ea\uff1a https://github.com/alecthomas/voluptuous\n\n> Voluptuous, despite the name, is a Python data validation library. It is primarily intended for validating data coming into Python as JSON, YAML, etc.\n\n\u30ea\u30dd\u30b8\u30c8\u30ea\u5185\u306e\u8aac\u660e\u3067\u3082\u89e6\u308c\u3066\u3044\u308b\u304c\u3001\u3059\u3054\u3044\u540d\u524d\u3060\u3002\n\n```commnet:voluptuous\n1 \u8089\u6b32\u306b\u3075\u3051\u308b\uff0c\u9152\u8272\u306b\u304a\u307c\u308c\u308b\uff0c\u5b98\u80fd\u7684\u306a.\n2 \u8089\u611f\u7684\u306a\uff0c\u8272\u3063\u307d\u3044\uff0c\u3042\u3060\u3063\u307d\u3044\uff0c\u30bb\u30af\u30b7\u30fc\u306a.\n3\u3008\u611f\u89e6\u306a\u3069\u3009\u5fc3\u5730\u3088\u3044.\n```\n\n# install\n## Python 2.6\u4ee5\u4e0a\npip\u3067\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3067\u304d\u308b\u3002\n\n```console\n# pip install voluptuous\n```\n\n## Python 2.5\n\u516c\u5f0f\u3067\u306f\u975e\u30b5\u30dd\u30fc\u30c8\u306a\u3082\u306e\u306e [Python2.5\u3067Voluptuous\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b](http://qiita.com/hombashi/items/8f08e1221c4213e14460) \u3067\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3068\u672c\u8a18\u4e8b\u30ec\u30d9\u30eb\u306e\u52d5\u4f5c\u306f\u53ef\u3002\n\n# Sample program\n\u52d5\u4f5c\u3092\u793a\u3059\u30b5\u30f3\u30d7\u30eb\u30d7\u30ed\u30b0\u30e9\u30e0\u3002\nget_schema \u5185\u306eSchema\u5ba3\u8a00\u304c\u6838\u3068\u306a\u308b\u3068\u3053\u308d\u3002\n\u3053\u308c\u304cVoluptuous\u3067\u306eJSON\u30b9\u30ad\u30fc\u30de\u306e\u5b9a\u7fa9\u3068\u306a\u308b\u3002\n\n```python\nfrom __future__ import with_statement\nimport re\nimport sys\nimport json  # Python 2.5\u3067\u306fsimplejson\nimport six\nfrom voluptuous import Schema, Required, Any, Range, Invalid, ALLOW_EXTRA\n\n\ndef validate_io_size(v):\n\tif re.search(\"^[0-9]+[bkm]\", v) is None:\n\t\traise Invalid(\"not a valid value (%s)\" % str(v))\n\n\ndef get_schema():\n\tschema = Schema({\n\t\t\"comment\"\t\t\t\t\t: six.text_type,\n\t\tRequired(\"operation\")\t\t: Any(\"read\", \"write\"),\n\t\t\"thread\"\t\t\t\t\t: Range(min=1),\n\t\tRequired(\"io_size\")\t\t\t: validate_io_size,\n\t\tRequired(\"access_percentage\")\t: Range(min=1, max=100),\n\t}, extra=ALLOW_EXTRA)\n\t\n\treturn schema\n\n\ndef main():\n\tschema\t= get_schema()\n\t\n\twith open(sys.argv[1], \"r\") as fp:\n\t\tdict_sample\t= json.load(fp)\n\t\n\tschema(dict_sample)\n\tsix.print_(dict_sample)\n\t\n\treturn 0\n\n\nif __name__ == '__main__':\n\tsys.exit(main())\n```\n\n\n# \u8a73\u7d30\n## Voluptuous\u7528\u8a9e\n\u30ad\u30fc\u30ef\u30fc\u30c9|\u610f\u5473\n---|---\nRequired|\u5fc5\u9808\u30d1\u30e9\u30e1\u30fc\u30bf\u3002\u3053\u308c\u3092\u3064\u3051\u3066\u3044\u306a\u3044\u30d1\u30e9\u30e1\u30fc\u30bf\u306f\u7701\u3044\u3066\u3082\u30a8\u30e9\u30fc\u306b\u306a\u3089\u306a\u3044\u3002\nAny|\u5ba3\u8a00\u4e2d\u306e\u3044\u305a\u308c\u304b\u306e\u5024\u306a\u3089OK\u3002\nRange|min\u4ee5\u4e0a\u3001max\u4ee5\u4e0b\u306a\u3089OK\u3002min or max\u306e\u307f\u6307\u5b9a\u3059\u308b\u3053\u3068\u3082\u3067\u304d\u308b\u3002\nALLOW_EXTRA|\u30b9\u30ad\u30fc\u30de\u306b\u5b9a\u7fa9\u304c\u7121\u3044\u30d1\u30e9\u30e1\u30fc\u30bf\u306e\u5b58\u5728\u3092\u8a31\u3059\u3002\n\n## validation\u306e\u65b9\u6cd5\n\u4ee5\u4e0b\u306e\u3044\u305a\u308c\u304b\n\n1. \u53d6\u308a\u5f97\u308b\u5024\u306e\u76f4\u63a5\u6307\u5b9a\u3002Any\u3001Range\u3001\u7b49\u3067\u5e45\u3092\u6301\u305f\u305b\u308b\u3053\u3068\u3082\u3067\u304d\u308b\u3002\n2. \u30af\u30e9\u30b9(int, float\u7b49\u306e\u4ed6\u3001six.text_type\u3068\u3044\u3063\u305f\u6307\u5b9a\u3082\u53ef)\n - \u30af\u30e9\u30b9\u304c\u5408\u81f4\u3057\u3066\u3044\u308c\u3070\u5024\u306f\u4f55\u3067\u3082OK\n3. validation\u95a2\u6570\u3092\u6307\u5b9a\u3059\u308b\n - \u524d\u8ff0\u306evalidate_io_size\u95a2\u6570\u304c\u3053\u308c\n - validation\u95a2\u6570\u306f\u6761\u4ef6\u3092\u6e80\u305f\u3055\u306a\u3044\u5834\u5408\u306fInvalid\u4f8b\u5916\u3092\u6295\u3052\u308b\n\n\n# \u52d5\u4f5c\u4f8b\n## \u74b0\u5883\n- Python 2.5/2.7\n- voluptuous 0.8.8\n\n## \u6b63\u5e38\u52d5\u4f5c\u4f8b\n```json:valid1.json\n{\n\t\"comment\"\t\t\t: \"comment\",\n\t\"operation\"\t\t\t: \"write\",\n\t\"thread\"\t\t\t: 8,\n\t\"io_size\"\t\t\t: \"8k\",\n\t\"access_percentage\"\t: 100\n}\n```\n\n```console\n# python voluptuous_sample.py valid1.json\n{u'comment': u'comment', u'operation': u'write', u'access_percentage': 100, u'thread': 8, u'io_size': u'8k'}\n#\n```\n\n## \u6b63\u5e38\u52d5\u4f5c\u4f8b(\u5fc5\u9808\u30d1\u30e9\u30e1\u30fc\u30bf\u7701\u7565)\n```json:valid2.json\n{\n\t\"operation\"\t\t\t: \"write\",\n\t\"io_size\"\t\t\t: \"8k\",\n\t\"access_percentage\"\t: 100\n}\n```\n\n```console\n# python voluptuous_sample.py valid2.json\n{u'operation': u'write', u'access_percentage': 100, u'io_size': u'8k'}\n```\n\n\u5fc5\u9808\u30d1\u30e9\u30e1\u30fc\u30bf\u610f\u5916\u306f\u7121\u304f\u3066\u3082\u30a8\u30e9\u30fc\u306b\u306a\u3089\u306a\u3044\u3002\n\n## \u30a8\u30e9\u30fc\u52d5\u4f5c\u4f8b\n```json:invalid.json\n{\n\t\"comment\"\t\t\t: \"comment\",\n\t\"operation\"\t\t\t: \"<invalid value>\",\n\t\"thread\"\t\t\t: 8,\n\t\"io_size\"\t\t\t: \"8k\",\n\t\"access_percentage\"\t: 100\n}\n```\n\n```pytb\n# python voluptuous_sample.py invalid.json\nTraceback (most recent call last):\n  File \"voluptuous_sample.py\", line 36, in <module>\n    sys.exit(main())\n  File \"voluptuous_sample.py\", line 29, in main\n    schema(dict_sample)\n  File \"/usr/local/lib/python2.7/dist-packages/voluptuous.py\", line 337, in __call__\n    return self._compiled([], data)\n  File \"/usr/local/lib/python2.7/dist-packages/voluptuous.py\", line 635, in validate_dict\n    return base_validate(path, iteritems(data), out)\n  File \"/usr/local/lib/python2.7/dist-packages/voluptuous.py\", line 471, in validate_mapping\n    raise MultipleInvalid(errors)\nvoluptuous.MultipleInvalid: not a valid value for dictionary value @ data[u'operation']\n#\n```\n\n\u30b9\u30ad\u30fc\u30de\u306b\u5408\u81f4\u3057\u306a\u3044\u30d1\u30e9\u30e1\u30fc\u30bf\u304c\u3042\u308b\u3068voluptuous.MultipleInvalid\u304c\u9001\u51fa\u3055\u308c\u3001\n\u30d1\u30e9\u30e1\u30fc\u30bf\uff08\u4f8b\u3067\u306foperation)\u306e\u5024\u304c\u6b63\u3057\u304f\u306a\u3044\u3088\u3001\u3068\u3044\u3046\u30e1\u30c3\u30bb\u30fc\u30b8\u304c\u51fa\u308b\u3002\n\n## \u30a8\u30e9\u30fc\u52d5\u4f5c\u4f8b(validation\u95a2\u6570\u6307\u5b9a\u6642)\n```json:invalid2.json\n{\n\t\"comment\"\t\t\t: \"comment\",\n\t\"operation\"\t\t\t: \"write\",\n\t\"thread\"\t\t\t: 8,\n\t\"io_size\"\t\t\t: \"a8k\",\n\t\"access_percentage\"\t: 100\n}\n```\n\n```pytb\n# python voluptuous_sample.py invalid2.json\nTraceback (most recent call last):\n  File \"voluptuous_sample.py\", line 38, in <module>\n    sys.exit(main())\n  File \"voluptuous_sample.py\", line 31, in main\n    schema(dict_sample)\n  File \"/usr/local/lib/python2.7/dist-packages/voluptuous.py\", line 337, in __call__\n    return self._compiled([], data)\n  File \"/usr/local/lib/python2.7/dist-packages/voluptuous.py\", line 635, in validate_dict\n    return base_validate(path, iteritems(data), out)\n  File \"/usr/local/lib/python2.7/dist-packages/voluptuous.py\", line 471, in validate_mapping\n    raise MultipleInvalid(errors)\nvoluptuous.MultipleInvalid: not a valid value (a8k) for dictionary value @ data[u'io_size']\n```\n\nvalidation\u95a2\u6570\u3092\u6307\u5b9a\u3057\u305f\u5834\u5408\u3082\u3053\u306e\u3088\u3046\u306b\u3002\n\n"}