{"tags": ["Rails", "Ruby", "session"], "context": " More than 1 year has passed since last update.Rails\u3067\u306f\u300cdevise\u300d(gem)\u3092\u4f7f\u3048\u3070\u7c21\u5358\u306b\u30e6\u30fc\u30b6\u30fc\u30ed\u30b0\u30a4\u30f3\u6a5f\u80fd\u3092\u5b9f\u88c5\u51fa\u6765\u307e\u3059\u3002\u305d\u306e\u305f\u3081\u3001\u305d\u308c\u3067\u5341\u5206\u697d\u306a\u306e\u3067\u3059\u304c\u3001\u30bb\u30c3\u30b7\u30e7\u30f3\u7ba1\u7406(gem\u306a\u3057)\u3067\u7c21\u6613\u30e6\u30fc\u30b6\u30fc\u7ba1\u7406\u3092\u3084\u3063\u3066\u307f\u305f\u306e\u3067\u899a\u66f8\u7a0b\u5ea6\u306b\u66f8\u3044\u3066\u304a\u304d\u307e\u3059\u3002\n\n\u4ed5\u69d8\n\n\u30e6\u30fc\u30b6\u30fc\u304c\u30b5\u30a4\u30c8\u5185\u306b\u30a2\u30af\u30bb\u30b9\u3057\u3066\u304d\u305f\u3089\u3001user_id\u3092\u767a\u884c\u3057\u30bb\u30c3\u30b7\u30e7\u30f3\u3092\u6b8b\u3059\u3002\n\u30bb\u30c3\u30b7\u30e7\u30f3\u671f\u9650\u306f1\u30f6\u6708\u306e\u8a2d\u5b9a\u3002\n\u30bb\u30c3\u30b7\u30e7\u30f3\u306edelete\u30dc\u30bf\u30f3\u3067\u30bb\u30c3\u30b7\u30e7\u30f3\u524a\u9664\u3002\uff08user\u524a\u9664)\n\n\ncreate\nuser\u30c6\u30fc\u30d6\u30eb\u3092\u4f5c\u6210\u3059\u308b\u3002\n\u305d\u306e\u5f8c\u3001\u4e0b\u8a18\u3092application_controller.rb\u5185\u306b\u8a18\u8ff0\u3002\n\u30b5\u30a4\u30c8\u5185\u306b\u30a2\u30af\u30bb\u30b9\u3057\u305f\u3089\u3001\u30e6\u30fc\u30b6\u30fc\u751f\u6210\u3002\n\napplication_controller.rb\n  before_action :login\n\n  def login\n    if session[:user_id].blank?\n      user = User.create\n      session[:user_id] = user.id\n    end\n    @user_id = session[:user_id]\n  end\n\n\n\ndestroy\n\u4efb\u610f\u306e\u5834\u6240\u306b\u4e0b\u8a18\u306e\u30a2\u30af\u30b7\u30e7\u30f3\u3092\u8a2d\u5b9a\u3057\u3001route\u3092\u8a2d\u5b9a\u3002\n  def destroy\n    reset_session\n    user =User.find(@user_id)\n    user.destroy\n    redirect_to root_path\n  end\n\n\n\u30bb\u30c3\u30b7\u30e7\u30f3\u671f\u9650\n\u4e0b\u8a18\u3092\u8ffd\u8a18\u3057\u3066\u30bb\u30c3\u30b7\u30e7\u30f3\u306e\u6709\u52b9\u671f\u9650\u3092\u8a2d\u5b9a\u3002\n\n/config/initializers/session_store.rb\nRails.application.config.session_store :cookie_store, key: '_user_id_session', expire_after: 1.month\n\n\nexpire_after\u304c1\u30f6\u6708\u306e\u6709\u52b9\u671f\u9650\u3002\n\n\u88dc\u8db3\n\u3061\u306a\u307f\u306b\u3001delete\u3057\u305f\u5f8c\u306b\u3059\u3050\u306b\u307e\u305f\u65b0\u3057\u3044user\u304c\u767a\u884c\u3055\u308c\u307e\u3059\u3002\napplication_controller\u5185\u306b\u4f5c\u6210\u3057\u305flogin\u30a2\u30af\u30b7\u30e7\u30f3\u3092\u4efb\u610f\u306e\u30b3\u30f3\u30c8\u30ed\u30fc\u30e9\u30fc\u306b\u79fb\u3057\u3001delete\u306e\u3088\u3046\u306broute\u3092\u8a2d\u5b9a\u3059\u308c\u3070\u3001user\u4f5c\u6210\u30dc\u30bf\u30f3\u3067\u4f5c\u6210\u3057\u3001user\u524a\u9664\u30dc\u30bf\u30f3\u3067\u524a\u9664\u3059\u308b\u3068\u3044\u3046\u4ed5\u69d8\u306b\u5909\u66f4\u3082\u51fa\u6765\u307e\u3059\u306d\u3002\u9700\u8981\u306f\u306a\u3055\u305d\u3046\u3067\u3059\u304c\u3001\u8ffd\u8a18\u3002\n\n\u53c2\u8003\nRails4\u3067\u306e\u57fa\u672c\u7684\u306a\u30bb\u30c3\u30b7\u30e7\u30f3\u306e\u4f7f\u3044\u65b9\nRails\u3067session\u306e\u6709\u52b9\u671f\u9650\u3092\u8a2d\u5b9a\nRails\u3067\u306f\u300cdevise\u300d(gem)\u3092\u4f7f\u3048\u3070\u7c21\u5358\u306b\u30e6\u30fc\u30b6\u30fc\u30ed\u30b0\u30a4\u30f3\u6a5f\u80fd\u3092\u5b9f\u88c5\u51fa\u6765\u307e\u3059\u3002\u305d\u306e\u305f\u3081\u3001\u305d\u308c\u3067\u5341\u5206\u697d\u306a\u306e\u3067\u3059\u304c\u3001\u30bb\u30c3\u30b7\u30e7\u30f3\u7ba1\u7406(gem\u306a\u3057)\u3067\u7c21\u6613\u30e6\u30fc\u30b6\u30fc\u7ba1\u7406\u3092\u3084\u3063\u3066\u307f\u305f\u306e\u3067\u899a\u66f8\u7a0b\u5ea6\u306b\u66f8\u3044\u3066\u304a\u304d\u307e\u3059\u3002\n\n##\u4ed5\u69d8\n* \u30e6\u30fc\u30b6\u30fc\u304c\u30b5\u30a4\u30c8\u5185\u306b\u30a2\u30af\u30bb\u30b9\u3057\u3066\u304d\u305f\u3089\u3001user_id\u3092\u767a\u884c\u3057\u30bb\u30c3\u30b7\u30e7\u30f3\u3092\u6b8b\u3059\u3002\n* \u30bb\u30c3\u30b7\u30e7\u30f3\u671f\u9650\u306f1\u30f6\u6708\u306e\u8a2d\u5b9a\u3002\n* \u30bb\u30c3\u30b7\u30e7\u30f3\u306edelete\u30dc\u30bf\u30f3\u3067\u30bb\u30c3\u30b7\u30e7\u30f3\u524a\u9664\u3002\uff08user\u524a\u9664)\n\n##create\n\nuser\u30c6\u30fc\u30d6\u30eb\u3092\u4f5c\u6210\u3059\u308b\u3002\n\u305d\u306e\u5f8c\u3001\u4e0b\u8a18\u3092application_controller.rb\u5185\u306b\u8a18\u8ff0\u3002\n\u30b5\u30a4\u30c8\u5185\u306b\u30a2\u30af\u30bb\u30b9\u3057\u305f\u3089\u3001\u30e6\u30fc\u30b6\u30fc\u751f\u6210\u3002\n\n```rb:application_controller.rb\n  before_action :login\n\n  def login\n    if session[:user_id].blank?\n      user = User.create\n      session[:user_id] = user.id\n    end\n    @user_id = session[:user_id]\n  end\n```\n\n##destroy\n\n\u4efb\u610f\u306e\u5834\u6240\u306b\u4e0b\u8a18\u306e\u30a2\u30af\u30b7\u30e7\u30f3\u3092\u8a2d\u5b9a\u3057\u3001route\u3092\u8a2d\u5b9a\u3002\n\n```rb\n  def destroy\n    reset_session\n    user =User.find(@user_id)\n    user.destroy\n    redirect_to root_path\n  end\n```\n\n##\u30bb\u30c3\u30b7\u30e7\u30f3\u671f\u9650\n\n\u4e0b\u8a18\u3092\u8ffd\u8a18\u3057\u3066\u30bb\u30c3\u30b7\u30e7\u30f3\u306e\u6709\u52b9\u671f\u9650\u3092\u8a2d\u5b9a\u3002\n\n```rb:/config/initializers/session_store.rb\nRails.application.config.session_store :cookie_store, key: '_user_id_session', expire_after: 1.month\n```\n\nexpire_after\u304c1\u30f6\u6708\u306e\u6709\u52b9\u671f\u9650\u3002\n\n##\u88dc\u8db3\n\u3061\u306a\u307f\u306b\u3001delete\u3057\u305f\u5f8c\u306b\u3059\u3050\u306b\u307e\u305f\u65b0\u3057\u3044user\u304c\u767a\u884c\u3055\u308c\u307e\u3059\u3002\napplication_controller\u5185\u306b\u4f5c\u6210\u3057\u305flogin\u30a2\u30af\u30b7\u30e7\u30f3\u3092\u4efb\u610f\u306e\u30b3\u30f3\u30c8\u30ed\u30fc\u30e9\u30fc\u306b\u79fb\u3057\u3001delete\u306e\u3088\u3046\u306broute\u3092\u8a2d\u5b9a\u3059\u308c\u3070\u3001user\u4f5c\u6210\u30dc\u30bf\u30f3\u3067\u4f5c\u6210\u3057\u3001user\u524a\u9664\u30dc\u30bf\u30f3\u3067\u524a\u9664\u3059\u308b\u3068\u3044\u3046\u4ed5\u69d8\u306b\u5909\u66f4\u3082\u51fa\u6765\u307e\u3059\u306d\u3002\u9700\u8981\u306f\u306a\u3055\u305d\u3046\u3067\u3059\u304c\u3001\u8ffd\u8a18\u3002\n\n##\u53c2\u8003\n[Rails4\u3067\u306e\u57fa\u672c\u7684\u306a\u30bb\u30c3\u30b7\u30e7\u30f3\u306e\u4f7f\u3044\u65b9](http://ruby-rails.hatenadiary.com/entry/20141130/1417334030)\n[Rails\u3067session\u306e\u6709\u52b9\u671f\u9650\u3092\u8a2d\u5b9a](http://blog.hello-world.jp.net/ruby/936/)\n"}