{"tags": ["PowerShell", "\u30b3\u30de\u30f3\u30c9\u30d7\u30ed\u30f3\u30d7\u30c8", "bat", "Windows"], "context": " \u3053\u306e\u8a18\u4e8b\u306f\u6700\u7d42\u66f4\u65b0\u65e5\u304b\u30891\u5e74\u4ee5\u4e0a\u304c\u7d4c\u904e\u3057\u3066\u3044\u307e\u3059\u3002PowerShell\u3084\u30d0\u30c3\u30c1\u30d5\u30a1\u30a4\u30eb\u3067,\n\u300c \u7ba1\u7406\u8005\u3068\u3057\u3066\u5b9f\u884c\u300d\u3057\u305f\u304b\u3069\u3046\u304b\u3092\u5224\u5b9a\u3059\u308b\u4f8b\u6587\u306f\u4e0b\u8a18\u306e\u901a\u308a.\n\nPowerShell\nif (([Security.Principal.WindowsPrincipal] [Security.Principal.WindowsIdentity]::GetCurrent()).IsInRole(`\n        [Security.Principal.WindowsBuiltInRole] \"Administrator\")) {\n    Write-Output \"\u7ba1\u7406\u8005\u3068\u3057\u3066\u5b9f\u884c\u3057\u307e\u3057\u305f. \u30b7\u30f3\u30dc\u30ea\u30c3\u30af\u30fb\u30ea\u30f3\u30af\u306e\u4f5c\u6210\u3092\u8a66\u307f\u307e\u3059. \"\n    CMD /C MKLINK /D \"$Env:HOME\\.emacs.d\" \"$Env:USERPROFILE\\Dropbox\\.emacs.d\"\n}\n\nelse {\n    Write-Warning \"\u7ba1\u7406\u8005\u3068\u3057\u3066\u5b9f\u884c\u3057\u3066\u3044\u307e\u305b\u3093. \u30b7\u30f3\u30dc\u30ea\u30c3\u30af\u30fb\u30ea\u30f3\u30af\u306e\u4f5c\u6210\u306f\u3067\u304d\u307e\u305b\u3093. \"\n    exit 1\n}\n\n(if\u306e\u6761\u4ef6\u5f0f\u304c\u9577\u3044\u306e\u3067, \u6587\u672b\u306e`(\u30d0\u30c3\u30af\u30af\u30a9\u30fc\u30c8)\u306b\u3088\u308a,\n\u6761\u4ef6\u5f0f\u3092\u8907\u6570\u884c\u306b\u5206\u3051\u3066\u66f8\u3044\u3066\u3044\u308b\u3053\u3068\u306b\u6ce8\u610f. )\n\n\u53c2\u8003\n\nCheck for Admin Credentials in a PowerShell Script --- Hey, Scripting Guy! Blog\nCheck for Administrative Privileges --- PowerShell.com\n\n\n\u30d0\u30c3\u30c1\u30d5\u30a1\u30a4\u30eb\nNET SESSION > NUL 2>&1\nIF %ERRORLEVEL% == 0 (\n    ECHO \u7ba1\u7406\u8005\u3068\u3057\u3066\u5b9f\u884c\u3057\u307e\u3057\u305f. \u30b7\u30f3\u30dc\u30ea\u30c3\u30af\u30fb\u30ea\u30f3\u30af\u306e\u4f5c\u6210\u3092\u8a66\u307f\u307e\u3059.\n    MKLINK /D %HOME%\\.emacs.d %USERPROFILE%\\Dropbox\\.emacs.d\n) ELSE (\n    ECHO \u7ba1\u7406\u8005\u3068\u3057\u3066\u5b9f\u884c\u3057\u3066\u3044\u307e\u305b\u3093. \u30b7\u30f3\u30dc\u30ea\u30c3\u30af\u30fb\u30ea\u30f3\u30af\u306e\u4f5c\u6210\u306f\u3067\u304d\u307e\u305b\u3093. >&2\n    EXIT /B 1\n)\n\n(NET SESSION\u306f\u672c\u6765\u306e\u7528\u9014\u3067\u306f\u306a\u304f, \u5358\u306b\u7ba1\u7406\u8005\u7279\u6a29\u306e\u6709\u7121\u306e\u5224\u5b9a\u306b\u4f7f\u7528\u3055\u308c\u3066\u3044\u308b.\n\u3088\u3063\u3066, NET SESSION\u3067\u306a\u304f\u3068\u3082, \u7ba1\u7406\u8005\u7279\u6a29\u304c\u5fc5\u8981\u306a\u30b3\u30de\u30f3\u30c9\u3067\u3042\u308c\u3070\u826f\u3044\u3088\u3046\u3060. )\n\n\u53c2\u8003\n\nBatch script: how to check for admin rights --- Stack Overflow\n\nPowerShell\u3084\u30d0\u30c3\u30c1\u30d5\u30a1\u30a4\u30eb\u3067,\n\u300c __\u7ba1\u7406\u8005\u3068\u3057\u3066\u5b9f\u884c__\u300d\u3057\u305f\u304b\u3069\u3046\u304b\u3092\u5224\u5b9a\u3059\u308b\u4f8b\u6587\u306f\u4e0b\u8a18\u306e\u901a\u308a.\n\n# PowerShell\n\n```powershell\nif (([Security.Principal.WindowsPrincipal] [Security.Principal.WindowsIdentity]::GetCurrent()).IsInRole(`\n        [Security.Principal.WindowsBuiltInRole] \"Administrator\")) {\n    Write-Output \"\u7ba1\u7406\u8005\u3068\u3057\u3066\u5b9f\u884c\u3057\u307e\u3057\u305f. \u30b7\u30f3\u30dc\u30ea\u30c3\u30af\u30fb\u30ea\u30f3\u30af\u306e\u4f5c\u6210\u3092\u8a66\u307f\u307e\u3059. \"\n    CMD /C MKLINK /D \"$Env:HOME\\.emacs.d\" \"$Env:USERPROFILE\\Dropbox\\.emacs.d\"\n}\n\nelse {\n    Write-Warning \"\u7ba1\u7406\u8005\u3068\u3057\u3066\u5b9f\u884c\u3057\u3066\u3044\u307e\u305b\u3093. \u30b7\u30f3\u30dc\u30ea\u30c3\u30af\u30fb\u30ea\u30f3\u30af\u306e\u4f5c\u6210\u306f\u3067\u304d\u307e\u305b\u3093. \"\n    exit 1\n}\n```\n\n(`if`\u306e\u6761\u4ef6\u5f0f\u304c\u9577\u3044\u306e\u3067, \u6587\u672b\u306e`(\u30d0\u30c3\u30af\u30af\u30a9\u30fc\u30c8)\u306b\u3088\u308a,\n\u6761\u4ef6\u5f0f\u3092\u8907\u6570\u884c\u306b\u5206\u3051\u3066\u66f8\u3044\u3066\u3044\u308b\u3053\u3068\u306b\u6ce8\u610f. )\n\n### \u53c2\u8003\n\n- [Check for Admin Credentials in a PowerShell Script --- Hey, Scripting Guy! Blog](http://blogs.technet.com/b/heyscriptingguy/archive/2011/05/11/check-for-admin-credentials-in-a-powershell-script.aspx)\n- [Check for Administrative Privileges --- PowerShell.com](http://powershell.com/cs/media/p/200.aspx)\n\n\n# \u30d0\u30c3\u30c1\u30d5\u30a1\u30a4\u30eb\n\n```bat\nNET SESSION > NUL 2>&1\nIF %ERRORLEVEL% == 0 (\n    ECHO \u7ba1\u7406\u8005\u3068\u3057\u3066\u5b9f\u884c\u3057\u307e\u3057\u305f. \u30b7\u30f3\u30dc\u30ea\u30c3\u30af\u30fb\u30ea\u30f3\u30af\u306e\u4f5c\u6210\u3092\u8a66\u307f\u307e\u3059.\n    MKLINK /D %HOME%\\.emacs.d %USERPROFILE%\\Dropbox\\.emacs.d\n) ELSE (\n    ECHO \u7ba1\u7406\u8005\u3068\u3057\u3066\u5b9f\u884c\u3057\u3066\u3044\u307e\u305b\u3093. \u30b7\u30f3\u30dc\u30ea\u30c3\u30af\u30fb\u30ea\u30f3\u30af\u306e\u4f5c\u6210\u306f\u3067\u304d\u307e\u305b\u3093. >&2\n    EXIT /B 1\n)\n```\n\n(`NET SESSION`\u306f\u672c\u6765\u306e\u7528\u9014\u3067\u306f\u306a\u304f, \u5358\u306b\u7ba1\u7406\u8005\u7279\u6a29\u306e\u6709\u7121\u306e\u5224\u5b9a\u306b\u4f7f\u7528\u3055\u308c\u3066\u3044\u308b.\n\u3088\u3063\u3066, `NET SESSION`\u3067\u306a\u304f\u3068\u3082, \u7ba1\u7406\u8005\u7279\u6a29\u304c\u5fc5\u8981\u306a\u30b3\u30de\u30f3\u30c9\u3067\u3042\u308c\u3070\u826f\u3044\u3088\u3046\u3060. )\n\n### \u53c2\u8003\n\n- [Batch script: how to check for admin rights --- Stack Overflow](http://stackoverflow.com/questions/4051883/batch-script-how-to-check-for-admin-rights/11995662)\n"}