{"context": " More than 1 year has passed since last update.\narchlinux, centos5,6,7, ubuntu14.04,16.04, debian7\u3067\u52d5\u4f5c\u78ba\u8a8d\n\n\n\u53c2\u8003\n\nmunin\u306e3\u5206\u9593\u30c1\u30e5\u30fc\u30cb\u30f3\u30b0 - Qiita\n\n\n\u30b9\u30af\u30ea\u30d7\u30c8\n\nmunin_plugin_link.sh\n#!/bin/sh\nset -eu\ncd /etc/munin/plugins\n\n#-----------------------\nORGDIR=\"/usr/share/munin/plugins\"\n# archlinux\nif [ -e /usr/lib/munin/plugins ];then\n    ORGDIR=\"/usr/lib/munin/plugins\"\nfi\n\n# plugin\u524a\u9664\u3002\u305f\u3060\u3057snmp\u76e3\u8996\u3057\u3066\u3044\u308b\u5834\u5408\u306f\u6d88\u3055\u306a\u3044\nmu_clear() {\n  SNMPCOUNT=$(ls /etc/munin/plugins/snmp* 2>/dev/null | wc -l)\n  if [ $SNMPCOUNT -eq 0 ];then \n      rm -f /etc/munin/plugins/*\n  fi\n}\n\n# plugin\u306e\u30ea\u30f3\u30af\u8cbc\u308a\nmu_enable() {\n if [ -e $ORGDIR/$1 -a ! -e $1 ];then\n   ln -s $ORGDIR/$1 $1\n fi\n}\n\n# plugin\u306e\u30ea\u30f3\u30af\u8cbc\u308a(\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u30c7\u30d0\u30a4\u30b9)\nmu_enable_interface() {\n for device in $(/sbin/ip a s | grep \\/2[4-9] | awk '{print $NF}')\n do\n   ln -s $ORGDIR/if_ if_${device}\n done\n}\n\n# \u30ea\u30f3\u30af\u8cbc\u308a \u7a3c\u50cd\u3057\u3066\u3044\u308b\u30b5\u30fc\u30d3\u30b9\u3092\u898b\u3066\u5224\u5b9a\nmu_enable_if() {\n PS_COUNT=$(ps -ef | grep $2 | grep -v grep | wc -l)\n if [ $PS_COUNT -ge 1 ];then\n   ln -s $ORGDIR/$1 .\n fi\n}\n\n# munin-node\u30ea\u30ed\u30fc\u30c9\nmu_reload() {\n  if [ ! -e /etc/init.d/munin-node ];then\n    systemctl restart munin-node\n  else\n    /etc/init.d/munin-node restart\n  fi\n  ls --color\n}\n#-----------------------\n\nmu_clear\n\nmu_enable_interface\n\nmu_enable cpu\nmu_enable diskstats\nmu_enable load\nmu_enable users\nmu_enable memory\nmu_enable uptime\n\nmu_enable_if postfix_mailqueue smtpd\nmu_enable_if samba smbd\n\nmu_reload\n\n\n\n\u7d50\u679c\n\n\nmunin\u51e6\u7406\u6642\u9593\u306e\u30b0\u30e9\u30d5\u3092\u51fa\u3059\u5834\u5408\nln -s /usr/share/munin/plugins/munin_stats .\n\n\n\u8ca0\u8377\u304c7\u5272\u7a0b\u5ea6\u306b\u6e1b\u3063\u305f\u306e\u3068\u3001\u4e0d\u8981\u306a\u76e3\u8996\u5bfe\u8c61\u304c\u6e1b\u3063\u3066\u826f\u304f\u306a\u3063\u305f\u3002\n\n* archlinux, centos5,6,7, ubuntu14.04,16.04, debian7\u3067\u52d5\u4f5c\u78ba\u8a8d\n\n## \u53c2\u8003\n\n* [munin\u306e3\u5206\u9593\u30c1\u30e5\u30fc\u30cb\u30f3\u30b0 - Qiita](http://qiita.com/hirata-qwt/items/5fb08bdf08b7a504de5b)\n\n## \u30b9\u30af\u30ea\u30d7\u30c8\n\n```bash:munin_plugin_link.sh\n#!/bin/sh\nset -eu\ncd /etc/munin/plugins\n\n#-----------------------\nORGDIR=\"/usr/share/munin/plugins\"\n# archlinux\nif [ -e /usr/lib/munin/plugins ];then\n    ORGDIR=\"/usr/lib/munin/plugins\"\nfi\n\n# plugin\u524a\u9664\u3002\u305f\u3060\u3057snmp\u76e3\u8996\u3057\u3066\u3044\u308b\u5834\u5408\u306f\u6d88\u3055\u306a\u3044\nmu_clear() {\n  SNMPCOUNT=$(ls /etc/munin/plugins/snmp* 2>/dev/null | wc -l)\n  if [ $SNMPCOUNT -eq 0 ];then \n      rm -f /etc/munin/plugins/*\n  fi\n}\n\n# plugin\u306e\u30ea\u30f3\u30af\u8cbc\u308a\nmu_enable() {\n if [ -e $ORGDIR/$1 -a ! -e $1 ];then\n   ln -s $ORGDIR/$1 $1\n fi\n}\n\n# plugin\u306e\u30ea\u30f3\u30af\u8cbc\u308a(\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u30c7\u30d0\u30a4\u30b9)\nmu_enable_interface() {\n for device in $(/sbin/ip a s | grep \\/2[4-9] | awk '{print $NF}')\n do\n   ln -s $ORGDIR/if_ if_${device}\n done\n}\n\n# \u30ea\u30f3\u30af\u8cbc\u308a \u7a3c\u50cd\u3057\u3066\u3044\u308b\u30b5\u30fc\u30d3\u30b9\u3092\u898b\u3066\u5224\u5b9a\nmu_enable_if() {\n PS_COUNT=$(ps -ef | grep $2 | grep -v grep | wc -l)\n if [ $PS_COUNT -ge 1 ];then\n   ln -s $ORGDIR/$1 .\n fi\n}\n\n# munin-node\u30ea\u30ed\u30fc\u30c9\nmu_reload() {\n  if [ ! -e /etc/init.d/munin-node ];then\n    systemctl restart munin-node\n  else\n    /etc/init.d/munin-node restart\n  fi\n  ls --color\n}\n#-----------------------\n\nmu_clear\n\nmu_enable_interface\n\nmu_enable cpu\nmu_enable diskstats\nmu_enable load\nmu_enable users\nmu_enable memory\nmu_enable uptime\n\nmu_enable_if postfix_mailqueue smtpd\nmu_enable_if samba smbd\n\nmu_reload\n```\n\n## \u7d50\u679c\n\n![\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8_2016-01-20_08-07-01.png](https://qiita-image-store.s3.amazonaws.com/0/25728/f81d5084-c57d-e961-d952-511c0a2e498f.png)\n\n```bash:munin\u51e6\u7406\u6642\u9593\u306e\u30b0\u30e9\u30d5\u3092\u51fa\u3059\u5834\u5408\nln -s /usr/share/munin/plugins/munin_stats .\n```\n\n\u8ca0\u8377\u304c7\u5272\u7a0b\u5ea6\u306b\u6e1b\u3063\u305f\u306e\u3068\u3001\u4e0d\u8981\u306a\u76e3\u8996\u5bfe\u8c61\u304c\u6e1b\u3063\u3066\u826f\u304f\u306a\u3063\u305f\u3002\n\n![\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8_2016-01-20_09-22-47.png](https://qiita-image-store.s3.amazonaws.com/0/25728/05c1d1f7-9189-4fa4-40d5-2ae5ff560457.png)\n", "tags": ["Munin"]}