{"context": "var simulation = d3.forceSimulation();\n\n\u3068\u306f\u3001\n\nhttp://bl.ocks.org/mbostock/4062045\n\u306e\u3088\u3046\u306a\u3001\u30b0\u30e9\u30d5\u53ef\u8996\u5316\u304c\u3067\u304d\u308b\u30b7\u30b9\u30c6\u30e0\u3002\u30ea\u30f3\u30af\u5148\u3092\u898b\u308c\u3070\u30b3\u30fc\u30c9\u306e\u66f8\u304d\u65b9\u306f\u3060\u3044\u305f\u3044\u5206\u304b\u308b\u3051\u308c\u3069\u3082\u3001\u5b9f\u969b\u306b\u81ea\u5206\u306e\u30c7\u30fc\u30bf\u3067\u3084\u3063\u3066\u307f\u308b\u3068\u3001\u3044\u3044\u611f\u3058\u306b\u306a\u308b\u30d1\u30e9\u30e1\u30fc\u30bf\u306e\u8abf\u6574\u304c\u610f\u5916\u3068\u96e3\u3057\u3044\u306e\u3067\u3001\u3053\u306e\u4e16\u754c\u3092\u7c21\u5358\u306b\u89e3\u8aac\u3059\u308b\u3002\u8a73\u3057\u3044\u8aac\u660e\u306f\u3001\nhttps://github.com/d3/d3-force\n\n\u529b\u3042\u308c\n\n1. \u6469\u64e6\u529b\n\u3053\u306e\u4e16\u754c\u306b\u306f\u6469\u64e6\u529b\u304c\u3042\u308b\u306e\u3067\u3001\u52d5\u3044\u3066\u3044\u308b\u3082\u306e\u306f\u3084\u304c\u3066\u6b62\u307e\u308b\u3002\nsimulation.velocityDecay(0.01)\n\n\u3067\u6469\u64e6\u4fc2\u6570\u3092\u6307\u5b9a\u3067\u304d\u308b\u3002\u3044\u3044\u611f\u3058\u306b\u306a\u308b\u524d\u306b\u6b62\u307e\u3063\u3066\u3057\u307e\u3046\u5834\u5408\u306f\u5c0f\u3055\u304f\u3001\u3075\u3089\u3075\u3089\u52d5\u304d\u7d9a\u3051\u3066\u56f0\u308b\u5834\u5408\u306f\u5927\u304d\u304f\u3059\u308b\u3002\u30c7\u30d5\u30a9\u30eb\u30c8\u306f 0.4.\n\n2. \u91cd\u529b\n\u30a2\u30ea\u30b9\u30c8\u30c6\u30ec\u30b9\u306e\u91cd\u529b\u3088\u308d\u3057\u304f\u3001\u4e16\u754c\u306e\u4e2d\u5fc3\u306b\u843d\u3061\u3066\u3044\u304f\u529b d3.forceCenter\u3002\nsimulation.force(\"center\", d3.forceCenter(width / 2, height / 2))\n\n\u4e00\u70b9\u3067\u306f\u306a\u304f\u3066\u4e00\u76f4\u7dda\u4e0a\u306b\u843d\u3061\u3066\u3044\u304f\u3088\u3046\u306b\u3057\u305f\u3044\u5834\u5408\u306f d3.forceX(x) d3.forceY(y) \u304c\u3042\u308b\u3002\n\n3. \u30d0\u30cd\n\u3044\u308f\u3086\u308b\u30d5\u30c3\u30af\u306e\u6cd5\u5247\u3002\u30b0\u30e9\u30d5\u306e edge/link/\u679d\u304c distance \u3088\u308a\u3082\u9577\u3044\u5834\u5408\u306f\u305d\u306e\u4f38\u3073\u306b\u6bd4\u4f8b\u3057\u3066\u5f15\u3063\u5f35\u3089\u308c\u3001\u77ed\u3044\u5834\u5408\u306f\u62bc\u3057\u5408\u3046\u3002\u529b\u306f strength \u3067\u6307\u5b9a\u3067\u304d\u308b\u304c\u30012\u3088\u308a\u5927\u304d\u3044\u5024\u3092\u5165\u308c\u308b\u3068\u306a\u305c\u304b\u7206\u767a\u3059\u308b\u3002\nsimulation.force(\"link\", d3.forceLink().id(function(d) { return d.id; }))\n\nsimulation.force(\"link\")\n          .links(graph.links)\n          .distance(function(){ return 10;})\n          .strength(function(){ return 2; })\n\n\n4. \u30af\u30fc\u30ed\u30f3\u529b\uff0f\u4e07\u6709\u5f15\u529b\nsimulation.force(\"charge\", d3.forceManyBody())\n\nsimulation.force(\"charge\")\n          .strength(function() { return -0.1; })\n\nstrength \u306b\u8ca0\u306e\u6570\u3092\u5165\u308c\u308b\u3068\u4e92\u3044\u306b\u53cd\u767a\u3057\u3066\u3001\u6b63\u306e\u6570\u3060\u3068\u5f15\u304b\u308c\u5408\u3046\u3002\n\n5. \u63a5\u89e6\u529b\nd3.forceCollide([radius])\n\n\u30b0\u30e9\u30d5\u306e vertex/node/\u9802\u70b9 \u304c\u534a\u5f84 radius \u306e\u7403\u306e\u3088\u3046\u306b\u3076\u3064\u304b\u308b\u3088\u3046\u306b\u306a\u308b\u3002\n\n\u56fa\u5b9a\nnode0 = simulation.nodes()[0]\nnode0.fx = x;\nnode0.fy = y;\n\nnode0 \u3092 (x,y) \u306b\u56fa\u5b9a\u3059\u308b\u3002\n\nalpha\nalpha \u3068\u3044\u3046\u306e\u306f\u7802\u6642\u8a08\u306e\u3088\u3046\u306a\u3082\u306e\u3067\u3001\u6642\u9593\u3068\u3068\u3082\u306b\u6e1b\u3063\u3066\u3044\u3063\u3066\u3001\u4f55\u30b9\u30c6\u30c3\u30d7\u4e16\u754c\u304c\u52d5\u304f\u304b\u3092\u53f8\u308b\u3002\nsimulation.alpha([alpha])  // = 1\nsimulation.alphaMin([min]) // = 0.001\nsimulation.alphaDecay([decay]) // = 0.0228 = 1 - pow(0.001, 1/300)\nsimulation.alphaTarget([target]) // = 0\n\n\uff11\u30b9\u30c6\u30c3\u30d7\u3067\uff08\u5358\u4f4d\u6642\u9593\u3042\u305f\u308a\uff09\u901f\u5ea6\u304c\u6469\u64e6\u529b\u3067\nvelocity <- velocity * velocityDecay\n\n\u3060\u3051\u6e1b\u5c11\u3057\u3066\u3001alpha \u304c\u3001\nalpha <- alpha + (alphaTarget - alpha) * alphaDecay\n\n\u306b\u306a\u308b\u3002alpha \u304c alphaMin \u3092\u4e0b\u56de\u308b\u3068\u6b62\u307e\u308a\u3001\u30c7\u30d5\u30a9\u30eb\u30c8\u306e\u30d1\u30e9\u30e1\u30bf\u3067\u306f300\u30b9\u30c6\u30c3\u30d7\u306b\u76f8\u5f53\u3059\u308b\u3002\u306a\u305c\u3053\u3093\u306a\u30d1\u30e9\u30e1\u30bf\u306a\u306e\u304b\u308f\u304b\u3089\u306a\u3044\u3051\u308c\u3069\u3082:\n\n\nalpha \u306f alphaTarget \u306b\u6f38\u8fd1\u3059\u308b\u3002\n\u3088\u3063\u3066\u3001alphaTarget \u304c alphaMin \u4ee5\u4e0a\u3060\u3068\u6b62\u307e\u3089\u306a\u3044\u3002\nalphaDecay \u304c\u5927\u304d\u3051\u308c\u3070\u5c11\u306a\u3044\u30b9\u30c6\u30c3\u30d7\u3067alphaTarget\u306b\u8fd1\u3065\u3044\u3066\u6b62\u307e\u308b\u3002\n\n\n\u4f8b\n\u5c06\u68cb\u306e\u5e8f\u76e4\u3092\u30b0\u30e9\u30d5\u3057\u3066\u307f\u305f\u3051\u308c\u3069\u3082\u3001\u306f\u307f\u3060\u3057\u305f\u308a\u3057\u3066\u306a\u304b\u306a\u304b\u601d\u3046\u3088\u3046\u306b\u3044\u304b\u306a\u3044...\nhttps://junkoda.github.io/kyokumen/graph/2016_1.html\n\n```javascript\nvar simulation = d3.forceSimulation();\n```\n\n\u3068\u306f\u3001\n\n![d3js_force_simulation.png](https://qiita-image-store.s3.amazonaws.com/0/63210/898b7b82-6695-4492-28cf-946a162799b0.png \"d3js_force_simulation.png\")\n\nhttp://bl.ocks.org/mbostock/4062045\n\n\u306e\u3088\u3046\u306a\u3001\u30b0\u30e9\u30d5\u53ef\u8996\u5316\u304c\u3067\u304d\u308b\u30b7\u30b9\u30c6\u30e0\u3002\u30ea\u30f3\u30af\u5148\u3092\u898b\u308c\u3070\u30b3\u30fc\u30c9\u306e\u66f8\u304d\u65b9\u306f\u3060\u3044\u305f\u3044\u5206\u304b\u308b\u3051\u308c\u3069\u3082\u3001\u5b9f\u969b\u306b\u81ea\u5206\u306e\u30c7\u30fc\u30bf\u3067\u3084\u3063\u3066\u307f\u308b\u3068\u3001\u3044\u3044\u611f\u3058\u306b\u306a\u308b\u30d1\u30e9\u30e1\u30fc\u30bf\u306e\u8abf\u6574\u304c\u610f\u5916\u3068\u96e3\u3057\u3044\u306e\u3067\u3001\u3053\u306e\u4e16\u754c\u3092\u7c21\u5358\u306b\u89e3\u8aac\u3059\u308b\u3002\u8a73\u3057\u3044\u8aac\u660e\u306f\u3001\nhttps://github.com/d3/d3-force\n\n## \u529b\u3042\u308c\n\n### 1. \u6469\u64e6\u529b\n\u3053\u306e\u4e16\u754c\u306b\u306f\u6469\u64e6\u529b\u304c\u3042\u308b\u306e\u3067\u3001\u52d5\u3044\u3066\u3044\u308b\u3082\u306e\u306f\u3084\u304c\u3066\u6b62\u307e\u308b\u3002\n\n```\nsimulation.velocityDecay(0.01)\n```\n\n\u3067\u6469\u64e6\u4fc2\u6570\u3092\u6307\u5b9a\u3067\u304d\u308b\u3002\u3044\u3044\u611f\u3058\u306b\u306a\u308b\u524d\u306b\u6b62\u307e\u3063\u3066\u3057\u307e\u3046\u5834\u5408\u306f\u5c0f\u3055\u304f\u3001\u3075\u3089\u3075\u3089\u52d5\u304d\u7d9a\u3051\u3066\u56f0\u308b\u5834\u5408\u306f\u5927\u304d\u304f\u3059\u308b\u3002\u30c7\u30d5\u30a9\u30eb\u30c8\u306f 0.4.\n\n### 2. \u91cd\u529b\n\n\u30a2\u30ea\u30b9\u30c8\u30c6\u30ec\u30b9\u306e\u91cd\u529b\u3088\u308d\u3057\u304f\u3001\u4e16\u754c\u306e\u4e2d\u5fc3\u306b\u843d\u3061\u3066\u3044\u304f\u529b `d3.forceCenter`\u3002\n\n```javascript\nsimulation.force(\"center\", d3.forceCenter(width / 2, height / 2))\n```\n\n\u4e00\u70b9\u3067\u306f\u306a\u304f\u3066\u4e00\u76f4\u7dda\u4e0a\u306b\u843d\u3061\u3066\u3044\u304f\u3088\u3046\u306b\u3057\u305f\u3044\u5834\u5408\u306f `d3.forceX(x)` `d3.forceY(y)` \u304c\u3042\u308b\u3002\n\n### 3. \u30d0\u30cd\n\n\u3044\u308f\u3086\u308b\u30d5\u30c3\u30af\u306e\u6cd5\u5247\u3002\u30b0\u30e9\u30d5\u306e edge/link/\u679d\u304c `distance` \u3088\u308a\u3082\u9577\u3044\u5834\u5408\u306f\u305d\u306e\u4f38\u3073\u306b\u6bd4\u4f8b\u3057\u3066\u5f15\u3063\u5f35\u3089\u308c\u3001\u77ed\u3044\u5834\u5408\u306f\u62bc\u3057\u5408\u3046\u3002\u529b\u306f `strength` \u3067\u6307\u5b9a\u3067\u304d\u308b\u304c\u30012\u3088\u308a\u5927\u304d\u3044\u5024\u3092\u5165\u308c\u308b\u3068\u306a\u305c\u304b\u7206\u767a\u3059\u308b\u3002\n\n\n```javascript\nsimulation.force(\"link\", d3.forceLink().id(function(d) { return d.id; }))\n\nsimulation.force(\"link\")\n          .links(graph.links)\n          .distance(function(){ return 10;})\n          .strength(function(){ return 2; })\n```\n\n### 4. \u30af\u30fc\u30ed\u30f3\u529b\uff0f\u4e07\u6709\u5f15\u529b\n\n```javascript\nsimulation.force(\"charge\", d3.forceManyBody())\n\nsimulation.force(\"charge\")\n          .strength(function() { return -0.1; })\n```\n\n`strength` \u306b\u8ca0\u306e\u6570\u3092\u5165\u308c\u308b\u3068\u4e92\u3044\u306b\u53cd\u767a\u3057\u3066\u3001\u6b63\u306e\u6570\u3060\u3068\u5f15\u304b\u308c\u5408\u3046\u3002\n\n### 5. \u63a5\u89e6\u529b\n\n```javascript\nd3.forceCollide([radius])\n```\n\n\u30b0\u30e9\u30d5\u306e vertex/node/\u9802\u70b9 \u304c\u534a\u5f84 `radius` \u306e\u7403\u306e\u3088\u3046\u306b\u3076\u3064\u304b\u308b\u3088\u3046\u306b\u306a\u308b\u3002\n\n## \u56fa\u5b9a\n\n```javascript\nnode0 = simulation.nodes()[0]\nnode0.fx = x;\nnode0.fy = y;\n```\n\n`node0` \u3092 (x,y) \u306b\u56fa\u5b9a\u3059\u308b\u3002\n\n## alpha\n\n`alpha` \u3068\u3044\u3046\u306e\u306f\u7802\u6642\u8a08\u306e\u3088\u3046\u306a\u3082\u306e\u3067\u3001\u6642\u9593\u3068\u3068\u3082\u306b\u6e1b\u3063\u3066\u3044\u3063\u3066\u3001\u4f55\u30b9\u30c6\u30c3\u30d7\u4e16\u754c\u304c\u52d5\u304f\u304b\u3092\u53f8\u308b\u3002\n\n```javascript\nsimulation.alpha([alpha])  // = 1\nsimulation.alphaMin([min]) // = 0.001\nsimulation.alphaDecay([decay]) // = 0.0228 = 1 - pow(0.001, 1/300)\nsimulation.alphaTarget([target]) // = 0\n```\n\n\uff11\u30b9\u30c6\u30c3\u30d7\u3067\uff08\u5358\u4f4d\u6642\u9593\u3042\u305f\u308a\uff09\u901f\u5ea6\u304c\u6469\u64e6\u529b\u3067\n\n```R\nvelocity <- velocity * velocityDecay\n```\n\n\u3060\u3051\u6e1b\u5c11\u3057\u3066\u3001alpha \u304c\u3001\n\n```R\nalpha <- alpha + (alphaTarget - alpha) * alphaDecay\n```\n\n\u306b\u306a\u308b\u3002`alpha` \u304c `alphaMin` \u3092\u4e0b\u56de\u308b\u3068\u6b62\u307e\u308a\u3001\u30c7\u30d5\u30a9\u30eb\u30c8\u306e\u30d1\u30e9\u30e1\u30bf\u3067\u306f300\u30b9\u30c6\u30c3\u30d7\u306b\u76f8\u5f53\u3059\u308b\u3002\u306a\u305c\u3053\u3093\u306a\u30d1\u30e9\u30e1\u30bf\u306a\u306e\u304b\u308f\u304b\u3089\u306a\u3044\u3051\u308c\u3069\u3082:\n\n* `alpha` \u306f `alphaTarget` \u306b\u6f38\u8fd1\u3059\u308b\u3002\n* \u3088\u3063\u3066\u3001`alphaTarget` \u304c `alphaMin` \u4ee5\u4e0a\u3060\u3068\u6b62\u307e\u3089\u306a\u3044\u3002\n* alphaDecay \u304c\u5927\u304d\u3051\u308c\u3070\u5c11\u306a\u3044\u30b9\u30c6\u30c3\u30d7\u3067alphaTarget\u306b\u8fd1\u3065\u3044\u3066\u6b62\u307e\u308b\u3002\n\n\n# \u4f8b\n\u5c06\u68cb\u306e\u5e8f\u76e4\u3092\u30b0\u30e9\u30d5\u3057\u3066\u307f\u305f\u3051\u308c\u3069\u3082\u3001\u306f\u307f\u3060\u3057\u305f\u308a\u3057\u3066\u306a\u304b\u306a\u304b\u601d\u3046\u3088\u3046\u306b\u3044\u304b\u306a\u3044...\nhttps://junkoda.github.io/kyokumen/graph/2016_1.html\n\n\n", "tags": ["forceSimulation", "d3.js"]}