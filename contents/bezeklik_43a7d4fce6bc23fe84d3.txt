{"context": "\n\nLinux Malware Detect (maldetect)\nhttps://www.rfxn.com/projects/linux-malware-detect/\nLinux Malware Detect (maldetect) \u306f\u5171\u6709\u30db\u30b9\u30c8\u74b0\u5883\u306e\u8105\u5a01\u306b\u5bfe\u5fdc\u3059\u308b\u305f\u3081\u306b\u4f5c\u3089\u308c\u305f\u30de\u30eb\u30a6\u30a7\u30a2\u30b9\u30ad\u30e3\u30ca\u30fc\u3002\n\u6700\u65b0\u7248\u306f 2015/09/19 \u30ea\u30ea\u30fc\u30b9\u306e 1.5 \u306b\u306a\u308b\u3002\n\n\u6a5f\u80fd\n\n\u8fc5\u901f\u306b\u8105\u5a01\u3092\u8b58\u5225\u3059\u308b\u305f\u3081\u306eMD5\u30d5\u30a1\u30a4\u30eb\u30cf\u30c3\u30b7\u30e5\u691c\u51fa\n\u8105\u5a01\u306e\u5909\u7570\u4f53\u3092\u8b58\u5225\u3059\u308b\u305f\u3081\u306eHEX\u30d9\u30fc\u30b9\u306e\u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0\n\u96e3\u8aad\u5316\u3055\u308c\u305f\u8105\u5a01\u306e\u691c\u51fa\u306e\u305f\u3081\u306e\u7d71\u8a08\u7684\u5206\u6790\u30b3\u30f3\u30dd\u30fc\u30cd\u30f3\u30c8\uff08\u4f8b: base64\uff09\n\u30d1\u30d5\u30a9\u30fc\u30de\u30f3\u30b9\u5411\u4e0a\u306e\u305f\u3081\u30b9\u30ad\u30e3\u30ca\u30fc\u30a8\u30f3\u30b8\u30f3\u3068\u3057\u3066\u4f7f\u7528\u3059\u308b ClamAV \u306e\u691c\u51fa\u3092\u7d71\u5408\nintegrated signature update feature with -u|\u2013update\nintegrated version update feature with -d|\u2013update-ver\nscan-recent option to scan only files that have been added/changed in X days\nscan-all option for full path based scanning\ncheckout option to upload suspected malware to rfxn.com for review / hashing\nfull reporting system to view current and previous scan results\nquarantine queue that stores threats in a safe fashion with no permissions\nquarantine batching option to quarantine the results of a current or past scans\nquarantine restore option to restore files to original path, owner and perms\nquarantine suspend account option to Cpanel suspend or shell revoke users\ncleaner rules to attempt removal of malware injected strings\ncleaner batching option to attempt cleaning of previous scan reports\ncleaner rules to remove base64 and gzinflate(base64 injected malware\n\u30e6\u30fc\u30b6\u30fc\u306e\u30db\u30fc\u30e0\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u30fc\u5185\u306e\u76f4\u8fd124\u6642\u9593\u306e\u3059\u3079\u3066\u306e\u5909\u66f4\u306e cron \u30d9\u30fc\u30b9\u306e\u65e5\u6b21\u30b9\u30ad\u30e3\u30f3\nRed Hat \u7cfb\u30b7\u30b9\u30c6\u30e0\u3001Cpanel\u3001Ensim \u3068\u4e92\u63db\u6027\u306e\u3042\u308b\u65e5\u6b21 cron \u30b9\u30af\u30ea\u30d7\u30c8\n\u4f5c\u6210\u3001\u66f4\u65b0\u3001\u79fb\u52d5\u3055\u308c\u305f\u30d5\u30a1\u30a4\u30eb\u3092 kernel \u30d9\u30fc\u30b9\u306e inotify \u3067\u30ea\u30a2\u30eb\u30bf\u30a4\u30e0\u30b9\u30ad\u30e3\u30f3\n\u6a19\u6e96\u5165\u529b\u307e\u305f\u306f\u30d5\u30a1\u30a4\u30eb\u304b\u3089\u30d1\u30b9\u60c5\u5831\u3092\u53d6\u5f97\u3067\u304d\u308b kernel inotify \u30e2\u30cb\u30bf\u30fc\n\u30b7\u30b9\u30c6\u30e0\u30e6\u30fc\u30b6\u30fc\u3092\u76e3\u8996\u3059\u308b\u305f\u3081\u306e\u4fbf\u5229\u306a\u6a5f\u80fd\u306e kernel inotify \u30e2\u30cb\u30bf\u30fc\nkernel inotify \u30e2\u30cb\u30bf\u30fc\u306f\u8a2d\u5b9a\u53ef\u80fd\u306a\u30e6\u30fc\u30b6\u30fc\u306e html \u30eb\u30fc\u30c8\u306b\u5236\u9650\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u308b\n\u6700\u9069\u306a\u30d1\u30d5\u30a9\u30fc\u30de\u30f3\u30b9\u306e\u305f\u3081\u306e\u52d5\u7684\u306a sysctl \u5236\u9650\u306e\u3042\u308b kernel inotify \u30e2\u30cb\u30bf\u30fc\n\u65e5\u6b21\u304a\u3088\u3073\u9031\u6b21\u306e\u30ec\u30dd\u30fc\u30c8\u3067\u306e kernel inotify \u30a2\u30e9\u30fc\u30c8\n\u624b\u52d5\u304a\u3088\u3073\u65e5\u6b21\u306e\u30b9\u30ad\u30e3\u30f3\u5b9f\u884c\u3054\u3068\u306e\u30e1\u30fc\u30eb\u30a2\u30e9\u30fc\u30c8\u30ec\u30dd\u30fc\u30c8\npath, extension and signature based ignore options\n\u81ea\u52d5\u30b9\u30ad\u30e3\u30f3\u64cd\u4f5c\u306e\u305f\u3081\u306e\u30d0\u30c3\u30af\u30b0\u30e9\u30a6\u30f3\u30c9\u30b9\u30ad\u30e3\u30ca\u30fc\u30aa\u30d7\u30b7\u30e7\u30f3\n\u5168\u3066\u306e\u30a2\u30af\u30b7\u30e7\u30f3\u306e\u8a73\u7d30\u306a\u30ed\u30b0\u3068\u51fa\u529b\n\n\n\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n\u30d1\u30c3\u30b1\u30fc\u30b8\nyum install http://repo.iotti.biz/CentOS/7/noarch/lux-release-7-1.noarch.rpm\nyum install maldetect\n\nLux \u30ea\u30dd\u30b8\u30c8\u30ea\u306b\u306e\u307f\u30d1\u30c3\u30b1\u30fc\u30b8\u304c\u5b58\u5728\u3059\u308b\u3002\n\u3053\u306e\u30d1\u30c3\u30b1\u30fc\u30b8\u3067\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u308b\u306e\u306f 2013/02/25 \u30ea\u30ea\u30fc\u30b9\u306e 1.4.2 \u306b\u306a\u308b\u3002\n\n\u30a2\u30c3\u30d7\u30c7\u30fc\u30c8\nmaldet --update\n\nmaldet -u \u3067\u3082\u540c\u69d8\u3002\n\u30bd\u30fc\u30b9\u304b\u3089\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u305f\u5834\u5408\u306f maldet -d \u3067\u672c\u4f53\u3092\u30d0\u30fc\u30b8\u30e7\u30f3\u30a2\u30c3\u30d7\u3067\u304d\u308b\u3088\u3046\u3060\u304c\u3001\u30d1\u30c3\u30b1\u30fc\u30b8\u3067\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u305f\u5834\u5408\u306f\u3046\u307e\u304f\u3044\u304b\u306a\u3044\u3088\u3046\u3060\u3002\n\n\u30b9\u30ad\u30e3\u30f3\n\n\u8a2d\u5b9a\u5909\u66f4\nsed -i.org '/quar_hits=/s/0/1/' /etc/maldetect/conf.maldet\n\n\u691c\u75ab\u306e\u6709\u52b9\u5316\u3002\n\n\u691c\u51fa\u30b5\u30f3\u30d7\u30eb\ncurl -O http://www.eicar.org/download/eicar.com\n\n\n\u30b9\u30ad\u30e3\u30f3\u5b9f\u65bd\nmaldet --scan-all ~\n\n\n\u51fa\u529b\u4f8b\nLinux Malware Detect v1.4.2\n            (C) 2002-2013, R-fx Networks <proj@r-fx.org>\n            (C) 2013, Ryan MacDonald <ryan@r-fx.org>\ninotifywait (C) 2007, Rohan McGovern <rohan@mcgovern.id.au>\nThis program may be freely redistributed under the terms of the GNU GPL v2\n\nmaldet(9499): {scan} signatures loaded: 10904 (8987 MD5 / 1917 HEX)\nmaldet(9499): {scan} building file list for /root, this might take awhile...\nmaldet(9499): {scan} file list completed, found 28 files...\nmaldet(9499): {scan} found ClamAV clamscan binary, using as scanner engine...\nmaldet(9499): {scan} scan of /root (28 files) in progress...\nmaldet(9499): {scan} processing scan results for hits: 1 hits 0 cleaned\nmaldet(9499): {scan} scan completed on /root: files 28, malware hits 1, cleaned hits 0\nmaldet(9499): {scan} scan report saved, to view run: maldet --report 081016-2242.9499\n\n\nmaldet -a ~ \u3067\u3082\u540c\u69d8\u3002\n\n\u30b9\u30ad\u30e3\u30f3\u7d50\u679c\nmaldet --report 081016-2242.9499\n\n\n\u51fa\u529b\u4f8b\nmalware detect scan report for localhost.localdomain:\nSCAN ID: 081016-2242.9499\nTIME:  8\u6708 10 22:42:42 +0900\nPATH: /root\nTOTAL FILES: 28\nTOTAL HITS: 1\nTOTAL CLEANED: 0\n\nFILE HIT LIST:\n{HEX}EICAR.TEST.10 : /root/eicar.com => /var/lib/maldetect/quarantine/eicar.com.2524\n===============================================\nLinux Malware Detect v1.4.2 < proj@rfxn.com >\n\n\n\u30de\u30eb\u30a6\u30a7\u30a2\u5224\u5b9a\u3055\u308c\u305f\u30d5\u30a1\u30a4\u30eb\u304c /var/lib/maldetect/quarantine/ \u3078\u691c\u75ab\uff08\u79fb\u52d5\uff09\u3055\u308c\u3066\u3044\u308b\u3002\n\n\u30c7\u30d5\u30a9\u30eb\u30c8\u8a2d\u5b9a\n\n\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\n\n/etc/maldetect/conf.maldet\nemail_alert=0\nemail_subj=\"maldet alert from $(hostname)\"\nemail_addr=\"you@domain.com\"\nemail_ignore_clean=0\nquar_hits=0\nquar_clean=1\nquar_susp=0\nquar_susp_minuid=500\nmaxdepth=15\nminfilesize=32\nmaxfilesize=\"768k\"\nhexdepth=61440\nhex_fifo_scan=1\nhex_fifo_depth=524288\nclamav_scan=1\npublic_scan=0\nstring_length_scan=\"0\"      # [ 0 = disabled, 1 = enabled ]\nstring_length=\"150000\"      # [ max string length ]\ninotify_base_watches=15360\ninotify_stime=30\ninotify_minuid=500\ninotify_webdir=public_html\ninotify_nice=10\n\n\n\ncron\n\n/etc/cron.daily/maldet\nexport PATH=/bin:/sbin:/usr/bin:/usr/sbin:/usr/local/bin:/usr/local/sbin:$PATH\nexport LMDCRON=1\ninspath='/usr/local/maldetect'\nintcnf=\"$inspath/internals/internals.conf\"\nif [ -f \"$intcnf\" ]; then\n    source $intcnf\nelse\n    echo \"\\$intcnf not found.\"\n    exit 1\nfi\nif [ -f \"$cnf\" ]; then\n    source $cnf\n    if [ -f \"$compatcnf\" ]; then\n            source $compatcnf\n    fi\nelse\n    echo \"could not find \\$cnf, fatal error, bye.\"\n    exit 1\nfi\nif [ -f \"/etc/sysconfig/maldet\" ]; then\n    . /etc/sysconfig/maldet\nelif [ -f \"/etc/default/maldet\" ]; then\n    . /etc/default/maldet\nfi\nif [ -f \"$cron_custom_conf\" ]; then\n    . $cron_custom_conf\nfi\nif [ -z \"$scan_days\" ]; then\n    scan_days=1\nfi\nif [ \"$find\" ]; then\n    tmpdirs=\"$tmpdir $varlibpath/sess $varlibpath/quarantine $varlibpath/pub\"\n    for dir in $tmpdirs; do\n     if [ -d \"$dir\" ]; then\n      $find $dir -type f -mtime +7 -print0 | xargs -0 rm -f >> /dev/null 2>&1\n     fi\n    done\nfi\nif [ \"$autoupdate_version\" == \"1\" ] || [ \"$autoupdate_signatures\" == \"1\" ]; then\n    sleep $(echo $RANDOM | cut -c1-3) >> /dev/null 2>&1\nfi\nif [ \"$autoupdate_version\" == \"1\" ]; then\n    $inspath/maldet -d >> /dev/null 2>&1\nfi\nif [ \"$autoupdate_signatures\" == \"1\" ]; then\n    $inspath/maldet -u >> /dev/null 2>&1\nfi\nif [ \"$(ps -A --user root -o \"cmd\" | grep maldetect | grep inotifywait)\" ]; then\n        $inspath/maldet --monitor-report >> /dev/null 2>&1\nelse\n    if [ -d \"/home/virtual\" ] && [ -d \"/usr/lib/opcenter\" ]; then\n            $inspath/maldet -b -r /home/virtual/?/fst/var/www/html/,/home/virtual/?/fst/home/?/public_html/ $scan_days >> /dev/null 2>&1\n    elif [ -d \"/etc/psa\" ] && [ -d \"/var/lib/psa\" ]; then\n        $inspath/maldet -b -r /var/www/vhosts/?/ $scan_days >> /dev/null 2>&1\n        elif [ -d \"/usr/local/directadmin\" ]; then\n                $inspath/maldet -b -r /home?/?/domains/?/public_html/,/var/www/html/?/ $scan_days >> /dev/null 2>&1\n    elif [ -d \"/var/www/clients\" ]; then\n                $inspath/maldet -b -r /var/www/clients/?/web?/web,/var/www $scan_days >> /dev/null 2>&1\n    elif [ -d \"/etc/webmin/virtual-server\" ]; then\n                $inspath/maldet -b -r /home/?/public_html/,/home/?/domains/?/public_html/ $scan_days >> /dev/null 2>&1\n    elif [ -d \"/usr/local/ispmgr\" ]; then\n        $inspath/maldet -b -r /var/www/?/data/,/home/?/data/ $scan_days >> /dev/null 2>&1\n    elif [ -d \"/var/customers/webs\" ]; then\n        $inspath/maldet -b -r /var/customers/webs/ $scan_days >> /dev/null 2>&1\n        elif [ -d \"/usr/local/vesta\" ]; then\n                $inspath/maldet -b -r /home/?/web/?/public_html/,/home/?/web/?/public_shtml/,/home/?/tmp/,/home/?/web/?/private/ $scan_days >> /dev/null 2>&1\n        elif [ -d \"/usr/share/dtc\" ]; then\n                if [ -f /var/lib/dtc/saved_install_config ]; then\n                    . /var/lib/dtc/saved_install_config\n                fi\n                $inspath/maldet -b -r ${conf_hosting_path:-/var/www/sites}/?/?/subdomains/?/html/ $scan_days >> /dev/null 2>&1\n    else\n            $inspath/maldet -b -r /home?/?/public_html/,/var/www/html/,/usr/local/apache/htdocs/ $scan_days >> /dev/null 2>&1\n    fi\nfi\nif [ -f \"$cron_custom_exec\" ]; then\n    . $cron_custom_exec\nfi\n\n\n\n\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u95a2\u9023\u8a18\u4e8b\n\nPHP\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u5f37\u5316\u30e2\u30b8\u30e5\u30fc\u30eb Suhosin\nDoS\u653b\u6483/\u30d6\u30eb\u30fc\u30c8\u30d5\u30a9\u30fc\u30b9\u653b\u6483\u5bfe\u7b56\u30a2\u30d7\u30ea\u306e\u8fd1\u6cc1\nLinux\u30a2\u30f3\u30c1\u30a6\u30a4\u30eb\u30b9\u30bd\u30d5\u30c8 ClamAV\n\u30de\u30eb\u30a6\u30a7\u30a2\u691c\u51fa\u30c4\u30fc\u30eb Linux Malware Detect\n\u30eb\u30fc\u30c8\u30ad\u30c3\u30c8\u691c\u51fa\u30c4\u30fc\u30eb Rootkit Hunter (rkhunter)\n\u30eb\u30fc\u30c8\u30ad\u30c3\u30c8\u691c\u51fa\u30c4\u30fc\u30eb chkrootkit\n\u30d5\u30a1\u30a4\u30eb\u6539\u3056\u3093\u691c\u77e5\u30c4\u30fc\u30eb AFICK\n\u30d5\u30a1\u30a4\u30eb\u6539\u3056\u3093\u691c\u77e5\u30c4\u30fc\u30eb AIDE\n\u30d5\u30a1\u30a4\u30eb\u6539\u3056\u3093\u691c\u77e5\u30c4\u30fc\u30eb OSSEC\n\u30d5\u30a1\u30a4\u30eb\u6539\u3056\u3093\u691c\u77e5\u30c4\u30fc\u30eb Samhain\n\u30d5\u30a1\u30a4\u30eb\u6539\u3056\u3093\u691c\u77e5\u30c4\u30fc\u30eb Tripwire\n\u8106\u5f31\u6027\u30b9\u30ad\u30e3\u30ca\u30fc OpenVAS\n\u8106\u5f31\u6027\u30b9\u30ad\u30e3\u30ca\u30fc Nessus\n\u8106\u5f31\u6027\u30b9\u30ad\u30e3\u30ca\u30fc Nikto\nLinux\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u76e3\u67fb\u30c4\u30fc\u30eb Lynis\n\n# Linux Malware Detect (maldetect)\nhttps://www.rfxn.com/projects/linux-malware-detect/\n**Linux Malware Detect** (maldetect) \u306f\u5171\u6709\u30db\u30b9\u30c8\u74b0\u5883\u306e\u8105\u5a01\u306b\u5bfe\u5fdc\u3059\u308b\u305f\u3081\u306b\u4f5c\u3089\u308c\u305f\u30de\u30eb\u30a6\u30a7\u30a2\u30b9\u30ad\u30e3\u30ca\u30fc\u3002\n\u6700\u65b0\u7248\u306f 2015/09/19 \u30ea\u30ea\u30fc\u30b9\u306e 1.5 \u306b\u306a\u308b\u3002\n\n# \u6a5f\u80fd\n* \u8fc5\u901f\u306b\u8105\u5a01\u3092\u8b58\u5225\u3059\u308b\u305f\u3081\u306eMD5\u30d5\u30a1\u30a4\u30eb\u30cf\u30c3\u30b7\u30e5\u691c\u51fa\n* \u8105\u5a01\u306e\u5909\u7570\u4f53\u3092\u8b58\u5225\u3059\u308b\u305f\u3081\u306eHEX\u30d9\u30fc\u30b9\u306e\u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0\n* \u96e3\u8aad\u5316\u3055\u308c\u305f\u8105\u5a01\u306e\u691c\u51fa\u306e\u305f\u3081\u306e\u7d71\u8a08\u7684\u5206\u6790\u30b3\u30f3\u30dd\u30fc\u30cd\u30f3\u30c8\uff08\u4f8b: base64\uff09\n* \u30d1\u30d5\u30a9\u30fc\u30de\u30f3\u30b9\u5411\u4e0a\u306e\u305f\u3081\u30b9\u30ad\u30e3\u30ca\u30fc\u30a8\u30f3\u30b8\u30f3\u3068\u3057\u3066\u4f7f\u7528\u3059\u308b ClamAV \u306e\u691c\u51fa\u3092\u7d71\u5408\n* integrated signature update feature with -u|\u2013update\n* integrated version update feature with -d|\u2013update-ver\n* scan-recent option to scan only files that have been added/changed in X days\n* scan-all option for full path based scanning\n* checkout option to upload suspected malware to rfxn.com for review / hashing\n* full reporting system to view current and previous scan results\n* quarantine queue that stores threats in a safe fashion with no permissions\n* quarantine batching option to quarantine the results of a current or past scans\n* quarantine restore option to restore files to original path, owner and perms\n* quarantine suspend account option to Cpanel suspend or shell revoke users\n* cleaner rules to attempt removal of malware injected strings\n* cleaner batching option to attempt cleaning of previous scan reports\n* cleaner rules to remove base64 and gzinflate(base64 injected malware\n* \u30e6\u30fc\u30b6\u30fc\u306e\u30db\u30fc\u30e0\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u30fc\u5185\u306e\u76f4\u8fd124\u6642\u9593\u306e\u3059\u3079\u3066\u306e\u5909\u66f4\u306e cron \u30d9\u30fc\u30b9\u306e\u65e5\u6b21\u30b9\u30ad\u30e3\u30f3\n* Red Hat \u7cfb\u30b7\u30b9\u30c6\u30e0\u3001Cpanel\u3001Ensim \u3068\u4e92\u63db\u6027\u306e\u3042\u308b\u65e5\u6b21 cron \u30b9\u30af\u30ea\u30d7\u30c8\n* \u4f5c\u6210\u3001\u66f4\u65b0\u3001\u79fb\u52d5\u3055\u308c\u305f\u30d5\u30a1\u30a4\u30eb\u3092 kernel \u30d9\u30fc\u30b9\u306e inotify \u3067\u30ea\u30a2\u30eb\u30bf\u30a4\u30e0\u30b9\u30ad\u30e3\u30f3\n* \u6a19\u6e96\u5165\u529b\u307e\u305f\u306f\u30d5\u30a1\u30a4\u30eb\u304b\u3089\u30d1\u30b9\u60c5\u5831\u3092\u53d6\u5f97\u3067\u304d\u308b kernel inotify \u30e2\u30cb\u30bf\u30fc\n* \u30b7\u30b9\u30c6\u30e0\u30e6\u30fc\u30b6\u30fc\u3092\u76e3\u8996\u3059\u308b\u305f\u3081\u306e\u4fbf\u5229\u306a\u6a5f\u80fd\u306e kernel inotify \u30e2\u30cb\u30bf\u30fc\n* kernel inotify \u30e2\u30cb\u30bf\u30fc\u306f\u8a2d\u5b9a\u53ef\u80fd\u306a\u30e6\u30fc\u30b6\u30fc\u306e html \u30eb\u30fc\u30c8\u306b\u5236\u9650\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u308b\n* \u6700\u9069\u306a\u30d1\u30d5\u30a9\u30fc\u30de\u30f3\u30b9\u306e\u305f\u3081\u306e\u52d5\u7684\u306a sysctl \u5236\u9650\u306e\u3042\u308b kernel inotify \u30e2\u30cb\u30bf\u30fc\n* \u65e5\u6b21\u304a\u3088\u3073\u9031\u6b21\u306e\u30ec\u30dd\u30fc\u30c8\u3067\u306e kernel inotify \u30a2\u30e9\u30fc\u30c8\n* \u624b\u52d5\u304a\u3088\u3073\u65e5\u6b21\u306e\u30b9\u30ad\u30e3\u30f3\u5b9f\u884c\u3054\u3068\u306e\u30e1\u30fc\u30eb\u30a2\u30e9\u30fc\u30c8\u30ec\u30dd\u30fc\u30c8\n* path, extension and signature based ignore options\n* \u81ea\u52d5\u30b9\u30ad\u30e3\u30f3\u64cd\u4f5c\u306e\u305f\u3081\u306e\u30d0\u30c3\u30af\u30b0\u30e9\u30a6\u30f3\u30c9\u30b9\u30ad\u30e3\u30ca\u30fc\u30aa\u30d7\u30b7\u30e7\u30f3\n* \u5168\u3066\u306e\u30a2\u30af\u30b7\u30e7\u30f3\u306e\u8a73\u7d30\u306a\u30ed\u30b0\u3068\u51fa\u529b\n\n# \u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n## \u30d1\u30c3\u30b1\u30fc\u30b8\n```bash\nyum install http://repo.iotti.biz/CentOS/7/noarch/lux-release-7-1.noarch.rpm\nyum install maldetect\n```\nLux \u30ea\u30dd\u30b8\u30c8\u30ea\u306b\u306e\u307f\u30d1\u30c3\u30b1\u30fc\u30b8\u304c\u5b58\u5728\u3059\u308b\u3002\n\u3053\u306e\u30d1\u30c3\u30b1\u30fc\u30b8\u3067\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u308b\u306e\u306f 2013/02/25 \u30ea\u30ea\u30fc\u30b9\u306e 1.4.2 \u306b\u306a\u308b\u3002\n\n# \u30a2\u30c3\u30d7\u30c7\u30fc\u30c8\n```bash\nmaldet --update\n```\n`maldet -u` \u3067\u3082\u540c\u69d8\u3002\n\n\u30bd\u30fc\u30b9\u304b\u3089\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u305f\u5834\u5408\u306f `maldet -d` \u3067\u672c\u4f53\u3092\u30d0\u30fc\u30b8\u30e7\u30f3\u30a2\u30c3\u30d7\u3067\u304d\u308b\u3088\u3046\u3060\u304c\u3001\u30d1\u30c3\u30b1\u30fc\u30b8\u3067\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u305f\u5834\u5408\u306f\u3046\u307e\u304f\u3044\u304b\u306a\u3044\u3088\u3046\u3060\u3002\n\n# \u30b9\u30ad\u30e3\u30f3\n## \u8a2d\u5b9a\u5909\u66f4\n```bash\nsed -i.org '/quar_hits=/s/0/1/' /etc/maldetect/conf.maldet\n```\n\u691c\u75ab\u306e\u6709\u52b9\u5316\u3002\n\n## \u691c\u51fa\u30b5\u30f3\u30d7\u30eb\n```bash\ncurl -O http://www.eicar.org/download/eicar.com\n```\n\n## \u30b9\u30ad\u30e3\u30f3\u5b9f\u65bd\n```bash\nmaldet --scan-all ~\n```\n```text:\u51fa\u529b\u4f8b\nLinux Malware Detect v1.4.2\n            (C) 2002-2013, R-fx Networks <proj@r-fx.org>\n            (C) 2013, Ryan MacDonald <ryan@r-fx.org>\ninotifywait (C) 2007, Rohan McGovern <rohan@mcgovern.id.au>\nThis program may be freely redistributed under the terms of the GNU GPL v2\n\nmaldet(9499): {scan} signatures loaded: 10904 (8987 MD5 / 1917 HEX)\nmaldet(9499): {scan} building file list for /root, this might take awhile...\nmaldet(9499): {scan} file list completed, found 28 files...\nmaldet(9499): {scan} found ClamAV clamscan binary, using as scanner engine...\nmaldet(9499): {scan} scan of /root (28 files) in progress...\nmaldet(9499): {scan} processing scan results for hits: 1 hits 0 cleaned\nmaldet(9499): {scan} scan completed on /root: files 28, malware hits 1, cleaned hits 0\nmaldet(9499): {scan} scan report saved, to view run: maldet --report 081016-2242.9499\n```\n`maldet -a ~` \u3067\u3082\u540c\u69d8\u3002\n\n## \u30b9\u30ad\u30e3\u30f3\u7d50\u679c\n```bash\nmaldet --report 081016-2242.9499\n```\n```text:\u51fa\u529b\u4f8b\nmalware detect scan report for localhost.localdomain:\nSCAN ID: 081016-2242.9499\nTIME:  8\u6708 10 22:42:42 +0900\nPATH: /root\nTOTAL FILES: 28\nTOTAL HITS: 1\nTOTAL CLEANED: 0\n\nFILE HIT LIST:\n{HEX}EICAR.TEST.10 : /root/eicar.com => /var/lib/maldetect/quarantine/eicar.com.2524\n===============================================\nLinux Malware Detect v1.4.2 < proj@rfxn.com >\n```\n\u30de\u30eb\u30a6\u30a7\u30a2\u5224\u5b9a\u3055\u308c\u305f\u30d5\u30a1\u30a4\u30eb\u304c /var/lib/maldetect/quarantine/ \u3078\u691c\u75ab\uff08\u79fb\u52d5\uff09\u3055\u308c\u3066\u3044\u308b\u3002\n\n# \u30c7\u30d5\u30a9\u30eb\u30c8\u8a2d\u5b9a\n## \u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\n```bash:/etc/maldetect/conf.maldet\nemail_alert=0\nemail_subj=\"maldet alert from $(hostname)\"\nemail_addr=\"you@domain.com\"\nemail_ignore_clean=0\nquar_hits=0\nquar_clean=1\nquar_susp=0\nquar_susp_minuid=500\nmaxdepth=15\nminfilesize=32\nmaxfilesize=\"768k\"\nhexdepth=61440\nhex_fifo_scan=1\nhex_fifo_depth=524288\nclamav_scan=1\npublic_scan=0\nstring_length_scan=\"0\"\t\t# [ 0 = disabled, 1 = enabled ]\nstring_length=\"150000\"\t\t# [ max string length ]\ninotify_base_watches=15360\ninotify_stime=30\ninotify_minuid=500\ninotify_webdir=public_html\ninotify_nice=10\n```\n\n## cron\n```bash:/etc/cron.daily/maldet\nexport PATH=/bin:/sbin:/usr/bin:/usr/sbin:/usr/local/bin:/usr/local/sbin:$PATH\nexport LMDCRON=1\ninspath='/usr/local/maldetect'\nintcnf=\"$inspath/internals/internals.conf\"\nif [ -f \"$intcnf\" ]; then\n\tsource $intcnf\nelse\n\techo \"\\$intcnf not found.\"\n\texit 1\nfi\nif [ -f \"$cnf\" ]; then\n\tsource $cnf\n\tif [ -f \"$compatcnf\" ]; then\n\t        source $compatcnf\n\tfi\nelse\n\techo \"could not find \\$cnf, fatal error, bye.\"\n\texit 1\nfi\nif [ -f \"/etc/sysconfig/maldet\" ]; then\n\t. /etc/sysconfig/maldet\nelif [ -f \"/etc/default/maldet\" ]; then\n\t. /etc/default/maldet\nfi\nif [ -f \"$cron_custom_conf\" ]; then\n\t. $cron_custom_conf\nfi\nif [ -z \"$scan_days\" ]; then\n\tscan_days=1\nfi\nif [ \"$find\" ]; then\n\ttmpdirs=\"$tmpdir $varlibpath/sess $varlibpath/quarantine $varlibpath/pub\"\n\tfor dir in $tmpdirs; do\n\t if [ -d \"$dir\" ]; then\n\t  $find $dir -type f -mtime +7 -print0 | xargs -0 rm -f >> /dev/null 2>&1\n\t fi\n\tdone\nfi\nif [ \"$autoupdate_version\" == \"1\" ] || [ \"$autoupdate_signatures\" == \"1\" ]; then\n\tsleep $(echo $RANDOM | cut -c1-3) >> /dev/null 2>&1\nfi\nif [ \"$autoupdate_version\" == \"1\" ]; then\n\t$inspath/maldet -d >> /dev/null 2>&1\nfi\nif [ \"$autoupdate_signatures\" == \"1\" ]; then\n\t$inspath/maldet -u >> /dev/null 2>&1\nfi\nif [ \"$(ps -A --user root -o \"cmd\" | grep maldetect | grep inotifywait)\" ]; then\n        $inspath/maldet --monitor-report >> /dev/null 2>&1\nelse\n\tif [ -d \"/home/virtual\" ] && [ -d \"/usr/lib/opcenter\" ]; then\n\t        $inspath/maldet -b -r /home/virtual/?/fst/var/www/html/,/home/virtual/?/fst/home/?/public_html/ $scan_days >> /dev/null 2>&1\n\telif [ -d \"/etc/psa\" ] && [ -d \"/var/lib/psa\" ]; then\n\t\t$inspath/maldet -b -r /var/www/vhosts/?/ $scan_days >> /dev/null 2>&1\n        elif [ -d \"/usr/local/directadmin\" ]; then\n                $inspath/maldet -b -r /home?/?/domains/?/public_html/,/var/www/html/?/ $scan_days >> /dev/null 2>&1\n\telif [ -d \"/var/www/clients\" ]; then\n                $inspath/maldet -b -r /var/www/clients/?/web?/web,/var/www $scan_days >> /dev/null 2>&1\n\telif [ -d \"/etc/webmin/virtual-server\" ]; then\n                $inspath/maldet -b -r /home/?/public_html/,/home/?/domains/?/public_html/ $scan_days >> /dev/null 2>&1\n\telif [ -d \"/usr/local/ispmgr\" ]; then\n\t\t$inspath/maldet -b -r /var/www/?/data/,/home/?/data/ $scan_days >> /dev/null 2>&1\n\telif [ -d \"/var/customers/webs\" ]; then\n\t\t$inspath/maldet -b -r /var/customers/webs/ $scan_days >> /dev/null 2>&1\n        elif [ -d \"/usr/local/vesta\" ]; then\n                $inspath/maldet -b -r /home/?/web/?/public_html/,/home/?/web/?/public_shtml/,/home/?/tmp/,/home/?/web/?/private/ $scan_days >> /dev/null 2>&1\n        elif [ -d \"/usr/share/dtc\" ]; then\n                if [ -f /var/lib/dtc/saved_install_config ]; then\n                    . /var/lib/dtc/saved_install_config\n                fi\n                $inspath/maldet -b -r ${conf_hosting_path:-/var/www/sites}/?/?/subdomains/?/html/ $scan_days >> /dev/null 2>&1\n\telse\n\t        $inspath/maldet -b -r /home?/?/public_html/,/var/www/html/,/usr/local/apache/htdocs/ $scan_days >> /dev/null 2>&1\n\tfi\nfi\nif [ -f \"$cron_custom_exec\" ]; then\n\t. $cron_custom_exec\nfi\n```\n\n# \u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u95a2\u9023\u8a18\u4e8b\n* [PHP\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u5f37\u5316\u30e2\u30b8\u30e5\u30fc\u30eb Suhosin](http://qiita.com/bezeklik/items/5e8b1f76465e39dc6cd0)\n* [DoS\u653b\u6483/\u30d6\u30eb\u30fc\u30c8\u30d5\u30a9\u30fc\u30b9\u653b\u6483\u5bfe\u7b56\u30a2\u30d7\u30ea\u306e\u8fd1\u6cc1](http://qiita.com/bezeklik/items/6d86a162e278f576e4ca)\n* [Linux\u30a2\u30f3\u30c1\u30a6\u30a4\u30eb\u30b9\u30bd\u30d5\u30c8 ClamAV](http://qiita.com/bezeklik/items/4696e15c889ffff6bc41)\n* [\u30de\u30eb\u30a6\u30a7\u30a2\u691c\u51fa\u30c4\u30fc\u30eb Linux Malware Detect](http://qiita.com/bezeklik/items/43a7d4fce6bc23fe84d3)\n* [\u30eb\u30fc\u30c8\u30ad\u30c3\u30c8\u691c\u51fa\u30c4\u30fc\u30eb Rootkit Hunter (rkhunter)](http://qiita.com/bezeklik/items/bc7affef8afe7c63f2ce)\n* [\u30eb\u30fc\u30c8\u30ad\u30c3\u30c8\u691c\u51fa\u30c4\u30fc\u30eb chkrootkit](http://qiita.com/bezeklik/items/7964ce67f1a1363b694e)\n* [\u30d5\u30a1\u30a4\u30eb\u6539\u3056\u3093\u691c\u77e5\u30c4\u30fc\u30eb AFICK](http://qiita.com/bezeklik/items/298dafd2aeb053b4ca88)\n* [\u30d5\u30a1\u30a4\u30eb\u6539\u3056\u3093\u691c\u77e5\u30c4\u30fc\u30eb AIDE](http://qiita.com/bezeklik/items/d144d77a3e54cd35c06b)\n* [\u30d5\u30a1\u30a4\u30eb\u6539\u3056\u3093\u691c\u77e5\u30c4\u30fc\u30eb OSSEC](http://qiita.com/bezeklik/items/2143c02f1432d90f5c38)\n* [\u30d5\u30a1\u30a4\u30eb\u6539\u3056\u3093\u691c\u77e5\u30c4\u30fc\u30eb Samhain](http://qiita.com/bezeklik/items/6b7fb75f1a37b0fc41a2)\n* [\u30d5\u30a1\u30a4\u30eb\u6539\u3056\u3093\u691c\u77e5\u30c4\u30fc\u30eb Tripwire](http://qiita.com/bezeklik/items/2dfb871b9397211c735b)\n* [\u8106\u5f31\u6027\u30b9\u30ad\u30e3\u30ca\u30fc OpenVAS](http://qiita.com/bezeklik/items/a64cad37eb03a1db2de4)\n* [\u8106\u5f31\u6027\u30b9\u30ad\u30e3\u30ca\u30fc Nessus](http://qiita.com/bezeklik/items/d6feb569fb5e4d639332)\n* [\u8106\u5f31\u6027\u30b9\u30ad\u30e3\u30ca\u30fc Nikto](http://qiita.com/bezeklik/items/12643654dc0c45f4eb29)\n* [Linux\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u76e3\u67fb\u30c4\u30fc\u30eb Lynis](http://qiita.com/bezeklik/items/cf9be2deb546c69123e7)\n", "tags": ["maldetect1.4.2", "maldet1.4.2", "\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3", "CentOS6, 7", "Linux"]}