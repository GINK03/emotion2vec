{"context": "\n\n\u306f\u3058\u3081\u306b\n\u4f3c\u305f\u3088\u3046\u306a2\u3064\u306e\u4fe1\u53f7\u306b\u3064\u3044\u3066\u3001\u305d\u308c\u3089\u306e\u9045\u5ef6\u6642\u9593\u3092\u76f8\u4e92\u76f8\u95a2\u95a2\u6570\u3092\u8a08\u7b97\u3059\u308b\u3053\u3068\u306b\u3088\u3063\u3066\u63a8\u5b9a\u3057\u307e\u3059\u3002\n\u76f8\u4e92\u76f8\u95a2\u95a2\u6570\u306e\u8a08\u7b97\u306b\u306f\u3001Python\u306eNumpy\u3092\u7528\u3044\u307e\u3059\u3002\n\n\u4fe1\u53f7\u306e\u4f5c\u6210\n\u4f8b\u3068\u3057\u3066\u3001\u6b63\u898f\u5206\u5e03\u306e\u76ee\u7684\u4fe1\u53f7\u306b\u6b63\u898f\u5206\u5e03\u306e\u30ce\u30a4\u30ba\u306b\u91cd\u306d\u305f\u4fe1\u53f7\u3092\u3001\u9045\u5ef6\u306e\u6709\u308b\u3082\u306e\u3068\u7121\u3044\u3082\u306e\u306e2\u3064\u4f5c\u6210\u3057\u307e\u3059\u3002\nimport numpy as np\n\ntarget_sig = np.random.normal(size=1000) * 1.0\ndelay = 800\nsig1 = np.random.normal(size=2000) * 0.2\nsig1[delay:delay+1000] += target_sig\nsig2 = np.random.normal(size=2000) * 0.2\nsig2[:1000] += target_sig\n\n\n\n\u76f8\u4e92\u76f8\u95a2\u95a2\u6570\u306e\u8a08\u7b97\n\u4f5c\u6210\u3057\u305f2\u3064\u306e\u4fe1\u53f7\u306e\u76f8\u4e92\u76f8\u95a2\u95a2\u6570\u3092np.correlate()\u3067\u8a08\u7b97\u3057\u307e\u3059\u3002\u76f8\u4e92\u76f8\u95a2\u95a2\u6570\u306e\u6700\u5927\u3068\u306a\u308b\u4f4d\u7f6e\u304c\u3001\u9045\u5ef6\u6642\u9593\u3068\u306a\u308a\u307e\u3059\u3002\n\u3072\u3068\u3064\u6ce8\u610f\u70b9\u3068\u3057\u3066\u3001\u4fe1\u53f7\u306e\u5e73\u5747\u5024\u304c0\u304b\u3089\u96e2\u308c\u3066\u3044\u308b\u5834\u5408\u3001\u76f8\u4e92\u76f8\u95a2\u95a2\u6570\u306e\u8a08\u7b97\u306b\u5f71\u97ff\u3092\u4e0e\u3048\u308b\u306e\u3067\u3001\nsig1 = sig1 - sig1.mean()\u3068\u3044\u3063\u305f\u3088\u3046\u306b\u5e73\u5747\u30920\u306b\u3059\u308b\u3068\u3044\u3063\u305f\u51e6\u7406\u3092\u52a0\u3048\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\nimport numpy as np\n\ncorr = np.correlate(sig1, sig2, \"full\")\nestimated_delay = corr.argmax() - (len(sig2) - 1)\nprint(\"estimated delay is \" + str(estimated_delay))\n\nestimated delay is 800\n\n\n\u63cf\u753b\n\u6700\u5f8c\u306b\u63cf\u753b\u3057\u307e\u3059\u3002\u76f8\u4e92\u76f8\u95a2\u95a2\u6570\u306e\u5024\u306b\u304a\u3044\u3066\u3001\u9045\u5ef6\u6642\u9593\u3092\u793a\u3059\u90e8\u5206\u306b\u5927\u304d\u306a\u30d4\u30fc\u30af\u304c\u7acb\u3063\u3066\u3044\u308b\u306e\u304c\u5206\u304b\u308a\u307e\u3059\u3002\nimport matplotlib.pyplot as plt\n\nplt.subplot(4, 1, 1)\nplt.ylabel(\"sig1\")\nplt.plot(sig1)\n\nplt.subplot(4, 1, 2)\nplt.ylabel(\"sig2\")\nplt.plot(sig2, color=\"g\")\n\nplt.subplot(4, 1, 3)\nplt.ylabel(\"fit\")\nplt.plot(np.arange(len(sig1)), sig1)\nplt.plot(np.arange(len(sig2)) + estimated_delay, sig2 )\nplt.xlim([0, len(sig1)])\n\nplt.subplot(4, 1, 4)\nplt.ylabel(\"corr\")\nplt.plot(np.arange(len(corr)) - len(sig2) + 1, corr, color=\"r\")\nplt.xlim([0, len(sig1)])\n\nplt.show()\n\n\n# \u306f\u3058\u3081\u306b\n\u4f3c\u305f\u3088\u3046\u306a2\u3064\u306e\u4fe1\u53f7\u306b\u3064\u3044\u3066\u3001\u305d\u308c\u3089\u306e\u9045\u5ef6\u6642\u9593\u3092\u76f8\u4e92\u76f8\u95a2\u95a2\u6570\u3092\u8a08\u7b97\u3059\u308b\u3053\u3068\u306b\u3088\u3063\u3066\u63a8\u5b9a\u3057\u307e\u3059\u3002\n\u76f8\u4e92\u76f8\u95a2\u95a2\u6570\u306e\u8a08\u7b97\u306b\u306f\u3001Python\u306eNumpy\u3092\u7528\u3044\u307e\u3059\u3002\n\n# \u4fe1\u53f7\u306e\u4f5c\u6210\n\u4f8b\u3068\u3057\u3066\u3001\u6b63\u898f\u5206\u5e03\u306e\u76ee\u7684\u4fe1\u53f7\u306b\u6b63\u898f\u5206\u5e03\u306e\u30ce\u30a4\u30ba\u306b\u91cd\u306d\u305f\u4fe1\u53f7\u3092\u3001\u9045\u5ef6\u306e\u6709\u308b\u3082\u306e\u3068\u7121\u3044\u3082\u306e\u306e2\u3064\u4f5c\u6210\u3057\u307e\u3059\u3002\n\n```py3\nimport numpy as np\n\ntarget_sig = np.random.normal(size=1000) * 1.0\ndelay = 800\nsig1 = np.random.normal(size=2000) * 0.2\nsig1[delay:delay+1000] += target_sig\nsig2 = np.random.normal(size=2000) * 0.2\nsig2[:1000] += target_sig\n```\n![sig12.png](https://qiita-image-store.s3.amazonaws.com/0/61468/6afccdc0-5c2d-056d-d575-13016f1f9b4c.png)\n\n# \u76f8\u4e92\u76f8\u95a2\u95a2\u6570\u306e\u8a08\u7b97\n\u4f5c\u6210\u3057\u305f2\u3064\u306e\u4fe1\u53f7\u306e\u76f8\u4e92\u76f8\u95a2\u95a2\u6570\u3092```np.correlate()```\u3067\u8a08\u7b97\u3057\u307e\u3059\u3002\u76f8\u4e92\u76f8\u95a2\u95a2\u6570\u306e\u6700\u5927\u3068\u306a\u308b\u4f4d\u7f6e\u304c\u3001\u9045\u5ef6\u6642\u9593\u3068\u306a\u308a\u307e\u3059\u3002\n\u3072\u3068\u3064\u6ce8\u610f\u70b9\u3068\u3057\u3066\u3001**\u4fe1\u53f7\u306e\u5e73\u5747\u5024\u304c0\u304b\u3089\u96e2\u308c\u3066\u3044\u308b\u5834\u5408**\u3001\u76f8\u4e92\u76f8\u95a2\u95a2\u6570\u306e\u8a08\u7b97\u306b\u5f71\u97ff\u3092\u4e0e\u3048\u308b\u306e\u3067\u3001\n```sig1 = sig1 - sig1.mean()```\u3068\u3044\u3063\u305f\u3088\u3046\u306b**\u5e73\u5747\u30920\u306b\u3059\u308b**\u3068\u3044\u3063\u305f\u51e6\u7406\u3092\u52a0\u3048\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\n\n```py3\nimport numpy as np\n\ncorr = np.correlate(sig1, sig2, \"full\")\nestimated_delay = corr.argmax() - (len(sig2) - 1)\nprint(\"estimated delay is \" + str(estimated_delay))\n```\n\n```\nestimated delay is 800\n```\n\n# \u63cf\u753b\n\u6700\u5f8c\u306b\u63cf\u753b\u3057\u307e\u3059\u3002\u76f8\u4e92\u76f8\u95a2\u95a2\u6570\u306e\u5024\u306b\u304a\u3044\u3066\u3001\u9045\u5ef6\u6642\u9593\u3092\u793a\u3059\u90e8\u5206\u306b\u5927\u304d\u306a\u30d4\u30fc\u30af\u304c\u7acb\u3063\u3066\u3044\u308b\u306e\u304c\u5206\u304b\u308a\u307e\u3059\u3002\n\n```py3\nimport matplotlib.pyplot as plt\n\nplt.subplot(4, 1, 1)\nplt.ylabel(\"sig1\")\nplt.plot(sig1)\n\nplt.subplot(4, 1, 2)\nplt.ylabel(\"sig2\")\nplt.plot(sig2, color=\"g\")\n\nplt.subplot(4, 1, 3)\nplt.ylabel(\"fit\")\nplt.plot(np.arange(len(sig1)), sig1)\nplt.plot(np.arange(len(sig2)) + estimated_delay, sig2 )\nplt.xlim([0, len(sig1)])\n\nplt.subplot(4, 1, 4)\nplt.ylabel(\"corr\")\nplt.plot(np.arange(len(corr)) - len(sig2) + 1, corr, color=\"r\")\nplt.xlim([0, len(sig1)])\n\nplt.show()\n```\n![res.png](https://qiita-image-store.s3.amazonaws.com/0/61468/c040f756-4d7d-875d-f664-c966d21ef1c7.png)\n\n", "tags": ["\u4fe1\u53f7\u51e6\u7406", "Python"]}