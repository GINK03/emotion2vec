{"context": " More than 1 year has passed since last update.\n\n\u76ee\u7684\nOctave \u3067\u3061\u3083\u3061\u3083\u3063\u3068 SVM \u3092\u8a66\u3057\u3066\u307f\u307e\u3059\uff0e\n\n\u30c7\u30fc\u30bf\u306e\u6e96\u5099\n\u95a2\u6570\u3068\u5206\u985e\u3059\u308b\u305f\u3081\u306e\u30c7\u30fc\u30bf\u3092\u3061\u3083\u3061\u3083\u3063\u3068\u7528\u610f\u3057\u307e\u3059\uff0eA \u3068 B \u306f\u305d\u308c\u305e\u308c\u9069\u5f53\u306a\u4f4d\u7f6e\u3092\u4e2d\u5fc3\u306b\u3057\u3066\u9069\u5f53\u306a\u5e45\u3092\u6301\u3063\u305f\u5206\u5e03\u304b\u3089\u30b5\u30f3\u30d7\u30ea\u30f3\u30b0\u3057\u307e\u3059\uff0erot() \u306f\u5206\u5e03\u3092\u56de\u8ee2\u3055\u305b\u308b\u305f\u3081\u306e\u884c\u5217\u3067\u3059\uff0e\u7279\u5fb4\u91cf\u306f X \u3067\u5206\u985e\u306e\u305f\u3081\u306e\u30e9\u30d9\u30eb\u306f Y \u3067\u3059\uff0e\n# \u56de\u8ee2\u884c\u5217\nrot = @(t) [cos(t) -sin(t); sin(t) cos(t)];\n\n# \u9069\u5f53\u306b\u30c7\u30fc\u30bf\u3092\u7528\u610f\u3057\u307e\u3059\nA = bsxfun(@plus, ...\n     randn(300,2)*eye(5*rand(1,2))*rot(pi*rand()), 10*rand(2,1));\nB = bsxfun(@plus, ...\n     randn(300,2)*eye(5*rand(1,2))*rot(pi*rand()), 10*rand(2,1));\n\n# SVM \u8a08\u7b97\u7528\u306b\u30c7\u30fc\u30bf\u3092\u6574\u7406\u3057\u307e\u3059\nX = [[A;B], ones(600,1)];\nY = [ones(300,1); -ones(300,1)];\n\n\n\u6700\u9069\u5316\nSVM \u306b\u3088\u3063\u3066 xy \u5e73\u9762\u306b\u30c7\u30fc\u30bf\u3092 2 \u5206\u3059\u308b\u305f\u3081\u306e\u76f4\u7dda\u3092\u5f15\u304d\u307e\u3059\uff0e\nw_1x + w_2y + w_3 = 0\n\n\u30d9\u30af\u30c8\u30eb w \u3092\u6c42\u3081\u307e\u3059\uff0e\u30bd\u30d5\u30c8\u30de\u30fc\u30b8\u30f3 SVM \u3067\u306f\u4ee5\u4e0b\u306e\u5f0f\u3092 w \u306b\u3064\u3044\u3066\u6700\u5c0f\u5316\u3059\u308b\u3053\u3068\u3067\u5206\u985e\u3059\u308b\u305f\u3081\u306e\u30d1\u30e9\u30e1\u30bf w \u3092\u6c42\u3081\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\uff0e\n\\mathcal{L}({\\bf w}) = \\sum_n \\max\n\\bigl(\n1 - Y_n \\left({\\bf X}_n \\cdot {\\bf w} \\right) \n\\bigr)\n+ C ||{\\bf w}||_{2}\n\nOctave \u306e\u8868\u5f0f\u306b\u5408\u308f\u305b\u3066\u76ee\u7684\u95a2\u6570 L \u3092\u5b9a\u7fa9\u3057\u307e\u3059\uff0e C \u306f\u6b63\u5247\u5316\u9805\u306e\u4fc2\u6570\u3067\u3059\uff0e\nL = @(w,C) sum(max(1.0-Y.*(X*w(:)),0)) + C*sumsq(w);\n\nL \u306e\u6700\u5c0f\u5024\u3092\u6c42\u3081\u308b\u305f\u3081\u306b sqp \u3092\u5229\u7528\u3057\u307e\u3059\uff0e \u95a2\u6570\u3092\u7dda\u5f62\u8fd1\u4f3c\u3057\u3066 iterative \u306b\u4e8c\u6b21\u8a08\u753b\u6cd5\u3092\u89e3\u304f\u3053\u3068\u306b\u3088\u3063\u3066\uff0c\u975e\u7dda\u5f62\u95a2\u6570\u306e\u6700\u5c0f\u5024\u3092\u6c42\u3081\u3066\u3044\u308b\u3088\u3046\u3067\u3059\uff0e\u521d\u671f\u5024\u306f\u9069\u5f53\u306b\u5165\u308c\u307e\u3059\uff0e\n# \u6b63\u5247\u5316\u9805\u306e\u4fc2\u6570\u3092 C = 0.01 \u306b\u3057\u305f\u7121\u540d\u95a2\u6570\u3092\u5f15\u6570\u306b\u6e21\u3057\u307e\u3059\nw = sqp([-1;1;1], @(w) L(w,1e-2))\n\n# \u3068\u3042\u308b\u30c7\u30fc\u30bf\u306b\u5bfe\u3059\u308b\u7d50\u679c\n# w =\n# \n#   -0.82591\n#    0.97024\n#    0.82691\n#\n\n\u305b\u3063\u304b\u304f\u306a\u306e\u3067\u53ef\u8996\u5316\u3057\u3066\u307f\u307e\u3059\uff0e\n# \u53ef\u8996\u5316\u306e\u305f\u3081\u306b dirty \u306a\u95a2\u6570\u3092\u7528\u610f\nLplot = @(x,y) log10((reshape(cellfun(@(w) L(w,1e-5), ...\n          mat2cell([x(:),y(:),zeros(size(x(:)))], ...\n          ones(numel(x),1),3)),size(x,1),size(x,2))));\n\n# \u30d7\u30ed\u30c3\u30c8\u3057\u3066\u307f\u308b\nsubplot(1,2,2);\n  # w(3) = 0 \u5e73\u9762\u3067\u306e\u76ee\u7684\u95a2\u6570\u306e\u5024\u3092\u30ab\u30e9\u30fc\u30de\u30c3\u30d7\u3067\u8868\u793a\n  ezsurf(Lp,[-8,2,-4,6],64); view(2);\n  title(\"Objective Function (at w(3)=0)\");\n  xlabel(\"w(1)\"); ylabel(\"w(2)\");\nsubplot(1,2,1);\n  # A, B \u3068\u5206\u96e2\u5e73\u9762(\u76f4\u7dda)\u3092\u8868\u793a\n  plot(A(:,1),A(:,2),'1o', B(:,1), B(:,2),'3p');\n  hold('on');\n  ezplot(@(x,y) w(1)*x+w(2)*y+w(3),[-8,14,-8,15]);\n  hold('off');\n\n\n\u305d\u308c\u3063\u307d\u3044\u3068\u3053\u308d\u306b\u76f4\u7dda\u304c\u5f15\u3051\u307e\u3057\u305f\uff0e\u6700\u9069\u5316\u306e\u521d\u671f\u5024\u3084\u30b0\u30e9\u30d5\u306e\u8ef8\u306f\u9069\u5f53\u306b\u8abf\u6574\u3057\u3066\u304f\u3060\u3055\u3044\uff0e\n# \u76ee\u7684\nOctave \u3067\u3061\u3083\u3061\u3083\u3063\u3068 SVM \u3092\u8a66\u3057\u3066\u307f\u307e\u3059\uff0e\n\n\n## \u30c7\u30fc\u30bf\u306e\u6e96\u5099\n\u95a2\u6570\u3068\u5206\u985e\u3059\u308b\u305f\u3081\u306e\u30c7\u30fc\u30bf\u3092\u3061\u3083\u3061\u3083\u3063\u3068\u7528\u610f\u3057\u307e\u3059\uff0eA \u3068 B \u306f\u305d\u308c\u305e\u308c\u9069\u5f53\u306a\u4f4d\u7f6e\u3092\u4e2d\u5fc3\u306b\u3057\u3066\u9069\u5f53\u306a\u5e45\u3092\u6301\u3063\u305f\u5206\u5e03\u304b\u3089\u30b5\u30f3\u30d7\u30ea\u30f3\u30b0\u3057\u307e\u3059\uff0e`rot()` \u306f\u5206\u5e03\u3092\u56de\u8ee2\u3055\u305b\u308b\u305f\u3081\u306e\u884c\u5217\u3067\u3059\uff0e\u7279\u5fb4\u91cf\u306f `X` \u3067\u5206\u985e\u306e\u305f\u3081\u306e\u30e9\u30d9\u30eb\u306f `Y` \u3067\u3059\uff0e\n\n```octave\n# \u56de\u8ee2\u884c\u5217\nrot = @(t) [cos(t) -sin(t); sin(t) cos(t)];\n\n# \u9069\u5f53\u306b\u30c7\u30fc\u30bf\u3092\u7528\u610f\u3057\u307e\u3059\nA = bsxfun(@plus, ...\n     randn(300,2)*eye(5*rand(1,2))*rot(pi*rand()), 10*rand(2,1));\nB = bsxfun(@plus, ...\n     randn(300,2)*eye(5*rand(1,2))*rot(pi*rand()), 10*rand(2,1));\n\n# SVM \u8a08\u7b97\u7528\u306b\u30c7\u30fc\u30bf\u3092\u6574\u7406\u3057\u307e\u3059\nX = [[A;B], ones(600,1)];\nY = [ones(300,1); -ones(300,1)];\n```\n\n##\u6700\u9069\u5316\nSVM \u306b\u3088\u3063\u3066 xy \u5e73\u9762\u306b\u30c7\u30fc\u30bf\u3092 2 \u5206\u3059\u308b\u305f\u3081\u306e\u76f4\u7dda\u3092\u5f15\u304d\u307e\u3059\uff0e\n\n```math\nw_1x + w_2y + w_3 = 0\n```\n\n\u30d9\u30af\u30c8\u30eb __w__ \u3092\u6c42\u3081\u307e\u3059\uff0e\u30bd\u30d5\u30c8\u30de\u30fc\u30b8\u30f3 SVM \u3067\u306f\u4ee5\u4e0b\u306e\u5f0f\u3092 __w__ \u306b\u3064\u3044\u3066\u6700\u5c0f\u5316\u3059\u308b\u3053\u3068\u3067\u5206\u985e\u3059\u308b\u305f\u3081\u306e\u30d1\u30e9\u30e1\u30bf __w__ \u3092\u6c42\u3081\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\uff0e\n\n```math\n\\mathcal{L}({\\bf w}) = \\sum_n \\max\n\\bigl(\n1 - Y_n \\left({\\bf X}_n \\cdot {\\bf w} \\right) \n\\bigr)\n+ C ||{\\bf w}||_{2}\n```\n\nOctave \u306e\u8868\u5f0f\u306b\u5408\u308f\u305b\u3066\u76ee\u7684\u95a2\u6570 _L_ \u3092\u5b9a\u7fa9\u3057\u307e\u3059\uff0e C \u306f\u6b63\u5247\u5316\u9805\u306e\u4fc2\u6570\u3067\u3059\uff0e\n\n```octave\nL = @(w,C) sum(max(1.0-Y.*(X*w(:)),0)) + C*sumsq(w);\n```\n\n_L_ \u306e\u6700\u5c0f\u5024\u3092\u6c42\u3081\u308b\u305f\u3081\u306b `sqp` \u3092\u5229\u7528\u3057\u307e\u3059\uff0e \u95a2\u6570\u3092\u7dda\u5f62\u8fd1\u4f3c\u3057\u3066 iterative \u306b\u4e8c\u6b21\u8a08\u753b\u6cd5\u3092\u89e3\u304f\u3053\u3068\u306b\u3088\u3063\u3066\uff0c\u975e\u7dda\u5f62\u95a2\u6570\u306e\u6700\u5c0f\u5024\u3092\u6c42\u3081\u3066\u3044\u308b\u3088\u3046\u3067\u3059\uff0e\u521d\u671f\u5024\u306f\u9069\u5f53\u306b\u5165\u308c\u307e\u3059\uff0e\n\n```octave\n# \u6b63\u5247\u5316\u9805\u306e\u4fc2\u6570\u3092 C = 0.01 \u306b\u3057\u305f\u7121\u540d\u95a2\u6570\u3092\u5f15\u6570\u306b\u6e21\u3057\u307e\u3059\nw = sqp([-1;1;1], @(w) L(w,1e-2))\n\n# \u3068\u3042\u308b\u30c7\u30fc\u30bf\u306b\u5bfe\u3059\u308b\u7d50\u679c\n# w =\n# \n#   -0.82591\n#    0.97024\n#    0.82691\n#\n```\n\n\u305b\u3063\u304b\u304f\u306a\u306e\u3067\u53ef\u8996\u5316\u3057\u3066\u307f\u307e\u3059\uff0e\n\n```octave\n# \u53ef\u8996\u5316\u306e\u305f\u3081\u306b dirty \u306a\u95a2\u6570\u3092\u7528\u610f\nLplot = @(x,y) log10((reshape(cellfun(@(w) L(w,1e-5), ...\n          mat2cell([x(:),y(:),zeros(size(x(:)))], ...\n          ones(numel(x),1),3)),size(x,1),size(x,2))));\n\n# \u30d7\u30ed\u30c3\u30c8\u3057\u3066\u307f\u308b\nsubplot(1,2,2);\n  # w(3) = 0 \u5e73\u9762\u3067\u306e\u76ee\u7684\u95a2\u6570\u306e\u5024\u3092\u30ab\u30e9\u30fc\u30de\u30c3\u30d7\u3067\u8868\u793a\n  ezsurf(Lp,[-8,2,-4,6],64); view(2);\n  title(\"Objective Function (at w(3)=0)\");\n  xlabel(\"w(1)\"); ylabel(\"w(2)\");\nsubplot(1,2,1);\n  # A, B \u3068\u5206\u96e2\u5e73\u9762(\u76f4\u7dda)\u3092\u8868\u793a\n  plot(A(:,1),A(:,2),'1o', B(:,1), B(:,2),'3p');\n  hold('on');\n  ezplot(@(x,y) w(1)*x+w(2)*y+w(3),[-8,14,-8,15]);\n  hold('off');\n```\n\n![Screenshot from 2015-07-02 13:48:40.png](https://qiita-image-store.s3.amazonaws.com/0/46396/b6f152c9-ea0d-f594-2f25-4720b2d021b5.png)\n\n\u305d\u308c\u3063\u307d\u3044\u3068\u3053\u308d\u306b\u76f4\u7dda\u304c\u5f15\u3051\u307e\u3057\u305f\uff0e\u6700\u9069\u5316\u306e\u521d\u671f\u5024\u3084\u30b0\u30e9\u30d5\u306e\u8ef8\u306f\u9069\u5f53\u306b\u8abf\u6574\u3057\u3066\u304f\u3060\u3055\u3044\uff0e\n", "tags": ["Octave", "\u6a5f\u68b0\u5b66\u7fd2"]}