{"context": " More than 1 year has passed since last update.Tutum\u304c\u63d0\u4f9b\u3057\u3066\u3044\u308bGrafana\u3068Elasticsearch\u3068Grafana\u306eDocker\u30a4\u30e1\u30fc\u30b8\u3092\u4f7f\u3063\u3066IoT\u7528\u306e\u30c7\u30fc\u30bf\u30b9\u30c8\u30a2\u3068\u53ef\u8996\u5316\u30d7\u30e9\u30c3\u30c8\u30d5\u30a9\u30fc\u30e0\u3092\u69cb\u7bc9\u3057\u307e\u3059\u3002MQTT\u30d6\u30ed\u30fc\u30ab\u30fc\u306eMosca\u3068\u307e\u3060\u9023\u643a\u3057\u3066\u3044\u306a\u3044\u306e\u3067\u3001\u30c0\u30df\u30fc\u30c7\u30fc\u30bf\u3068\u3057\u3066dweet.io\u306e\u30c7\u30fc\u30bf\u3092InfluxDB\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u4f7f\u3044\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306b\u53d6\u308a\u8fbc\u307f\u307e\u3059\u3002dweet.io + InfluxDB + Grafana\u306e\u6295\u7a3f\u3092\u53c2\u8003\u306b\u3001\u30ab\u30ea\u30d5\u30a9\u30eb\u30cb\u30a2\u306e\u30a2\u30dc\u30ac\u30c9\u679c\u6a39\u5712\u306e\u30bb\u30f3\u30b5\u30fc\u30c7\u30fc\u30bf\u3092dweet.io\u304b\u3089\u53d6\u5f97\u3057\u307e\u3059\u3002\n\nInfluxDB\u30b3\u30f3\u30c6\u30ca\nIoT\u306e\u30c7\u30fc\u30bf\u30b9\u30c8\u30a2\u3068\u3057\u3066InfluxDB\u3092\u4f7f\u3044\u307e\u3059\u3002Docker\u30a4\u30e1\u30fc\u30b8\u306ftutum/influxdb\u3067\u3059\u3002\n$ docker pull tutum/influxdb\n$ docker run --name influxdb \\\n  -d \\\n  -p 8083:8083 \\\n  -p 8086:8086 \\\n  --expose 8090 \\\n  --expose 8099 \\\n  -e PRE_CREATE_DB=\"influxdb\"  \\\n  tutum/influxdb\n\n\u30d6\u30e9\u30a6\u30b6\u3067\u78ba\u8a8d\u3057\u307e\u3059\u3002username\u3068password\u306f\u4ee5\u4e0b\u3067\u3059\u3002\n\nuesrname: root\npassword root\n\nhttp://10.1.3.67:8083\n\ncurl\u3067\u30ec\u30b3\u30fc\u30c9\u306e\u767b\u9332\u3068\u53d6\u5f97\u306e\u30c6\u30b9\u30c8\u3092\u3057\u307e\u3059\u3002\n$ curl -X POST -d '[{\"name\":\"foo\",\"columns\":[\"val\"],\"points\":[[23]]}]' 'http://localhost:8086/db/influxdb/series?u=root&p=root'\n\n\u30ec\u30b3\u30fc\u30c9\u3092\u30af\u30a8\u30ea\u3057\u3066\u307f\u307e\u3059\u3002time\u3068sequence_number\u306f\u81ea\u52d5\u7684\u306b\u5165\u308a\u307e\u3059\u3002\n$ curl -G 'http://localhost:8086/db/influxdb/series?u=root&p=root&pretty=true' --data-urlencode \"q=select * from foo\"\n[\n    {\n        \"name\": \"foo\",\n        \"columns\": [\n            \"time\",\n            \"sequence_number\",\n            \"val\"\n        ],\n        \"points\": [\n            [\n                1423550210688,\n                10001,\n                23\n            ]\n        ]\n    }\n]\n\n\nElasticsearch\u30b3\u30f3\u30c6\u30ca\nElasticsearch\u306b\u306fGrafana\u306e\u30c0\u30c3\u30b7\u30e5\u30dc\u30fc\u30c9\u8a2d\u5b9a\u60c5\u5831\u3092\u4fdd\u5b58\u3057\u307e\u3059\u3002Docker\u30d9\u30fc\u30b9\u30a4\u30e1\u30fc\u30b8\u306ftutum/elasticsearch\u3067\u3059\u3002\u4eca\u56de\u306eDocker\u30db\u30b9\u30c8\u306e\u74b0\u5883\u306fIPv6\u304c\u7121\u52b9\u306b\u306a\u3063\u3066\u3044\u308b\u305f\u3081\u3001Docker Hub Registry\u304b\u3089\u53d6\u5f97\u3057\u305f\u30a4\u30e1\u30fc\u30b8\u306f\u8d77\u52d5\u306b\u5931\u6557\u3057\u3066\u3057\u307e\u3044\u307e\u3059\u3002IPv6\u3092\u7121\u52b9\u306b\u3059\u308b\u305f\u3081Nginx\u306e\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3092\u4fee\u6b63\u3057\u3066Docker\u30a4\u30e1\u30fc\u30b8\u306f\u4f5c\u308a\u76f4\u3057\u307e\u3059\u3002\n$ mkdir -p ~/docker_apps/es\n$ cd !$\n\nsed\u3067IPv6\u306e\u8a2d\u5b9a\u3092\u30b3\u30e1\u30f3\u30c8\u30a2\u30a6\u30c8\u3057\u3066\u3001Dockerfile\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\nDockerfile\nFROM tutum/elasticsearch\nRUN sed -i  '/listen \\[::\\]:9200/s/\\(listen \\[::\\]:9200.*\\)/#\\1/' /etc/nginx/sites-enabled/default\n\n\n\u30a4\u30e1\u30fc\u30b8\u3092\u30d3\u30eb\u30c9\u3057\u3066\u30b3\u30f3\u30c6\u30ca\u3092\u8d77\u52d5\u3057\u307e\u3059\u3002\n$ docker build masato/elasticsearch .\n$ docker run \\\n  --name es \\\n  -d \\\n  -p 9200:9200 \\\n  -e ELASTICSEARCH_USER=admin \\\n  -e ELASTICSEARCH_PASS=mypass \\\n  masato/elasticsearch\n\ncurl\u3067Elasticsearch\u306e\u8d77\u52d5\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\n$ curl admin:mypass@10.1.3.67:9200\n  \"status\" : 200,\n  \"name\" : \"Madcap\",\n  \"version\" : {\n    \"number\" : \"1.3.2\",\n    \"build_hash\" : \"dee175dbe2f254f3f26992f5d7591939aaefd12f\",\n    \"build_timestamp\" : \"2014-08-13T14:29:30Z\",\n    \"build_snapshot\" : false,\n    \"lucene_version\" : \"4.9\"\n  },\n  \"tagline\" : \"You Know, for Search\"\n}\n\n\nGrafana\u30b3\u30f3\u30c6\u30ca\nGrafana\u306eDocker\u30d9\u30fc\u30b9\u30a4\u30e1\u30fc\u30b8\u306ftutum/grafana\u3067\u3059\u3002Elasticsearch\u3068\u540c\u69d8\u306bNginx\u306eIPv6\u306e\u8a2d\u5b9a\u3092\u30b3\u30e1\u30f3\u30c8\u30a2\u30a6\u30c8\u3057\u307e\u3059\u3002Docker\u30a4\u30e1\u30fc\u30b8\u3092\u30d3\u30eb\u30c9\u3059\u308b\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306e\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n$ mkdir -p ~/docker_apps/grafana\n$ cd !$\n\nDockerfile\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002sed\u3067Nginx\u306eIPv6\u8a2d\u5b9a\u3092\u30b3\u30e1\u30f3\u30c8\u30a2\u30a6\u30c8\u3057\u307e\u3059\u3002\n\nDockerfile\nFROM tutum/grafana\nRUN sed -i '/listen \\[::\\]:80/s/\\(listen \\[::\\]:80.*\\)/#\\1/' /etc/nginx/sites-enabled/default\n\n\n\u30a4\u30e1\u30fc\u30b8\u3092\u30d3\u30eb\u30c9\u3057\u3066\u30b3\u30f3\u30c6\u30ca\u3092\u8d77\u52d5\u3057\u307e\u3059\u3002\u74b0\u5883\u5909\u6570\u306bInfluxDB\u306eIP\u30a2\u30c9\u30ec\u30b9\u3084\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u540d\u306a\u3069\u306e\u63a5\u7d9a\u60c5\u5831\u3092\u6307\u5b9a\u3057\u307e\u3059\u3002\n$ docker build -t masato/grafana .\n$ docker run --name grafana \\\n  -d \\\n  -p 8080:80 \\\n  -e INFLUXDB_HOST=10.1.3.67 \\\n  -e INFLUXDB_PORT=8086 \\\n  -e INFLUXDB_NAME=dweet  \\\n  -e INFLUXDB_USER=root \\\n  -e INFLUXDB_PASS=root \\\n  -e ELASTICSEARCH_HOST=10.1.3.67 \\\n  -e ELASTICSEARCH_PORT=9200 \\\n  -e ELASTICSEARCH_USER=admin \\\n  -e ELASTICSEARCH_PASS=mypass \\\n  masato/grafana\n\n\u30ed\u30b0\u3092\u78ba\u8a8d\u3057\u3066\u81ea\u52d5\u751f\u6210\u3055\u308c\u305f\u30d1\u30b9\u30ef\u30fc\u30c9\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\n$ docker logs grafana\n=> Creating basic auth for \"admin\" user with random password\nAdding password for user admin\n=> Done!\n========================================================================\nYou can now connect to Grafana with the following credential:\n\n    admin:DUx0iSs3Zd10\n\n========================================================================\n=> Configuring InfluxDB\n=> InfluxDB has been configured as follows:\n   InfluxDB ADDRESS:  10.1.3.67\n   InfluxDB PORT:     8086\n   InfluxDB DB NAME:  sensortag\n   InfluxDB USERNAME: root\n   InfluxDB PASSWORD: root\n   ** Please check your environment variables if you find something is misconfigured. **\n=> Done!\n=> Found Elasticsearch settings.\n=> Set Elasticsearch url to \"http://admin:mypass@10.1.3.67:9200\".\n=> Done!\n=> Starting and running Nginx...\n\n\u30d6\u30e9\u30a6\u30b6\u3067\u78ba\u8a8d\u3057\u307e\u3059\u3002username\u3068\u81ea\u52d5\u751f\u6210\u3055\u308c\u305f\u30d1\u30b9\u30ef\u30fc\u30c9\u306f\u4ee5\u4e0b\u3067\u3059\u3002\n\nusername: admin\npassword: DUx0iSs3Zd10\n\nhttp://10.1.3.67:8080\n\n\nInfluxDB\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u30b3\u30f3\u30c6\u30ca\ndweet.io + InfluxDB + Grafana\u3092\u53c2\u8003\u306b\u3057\u3066\u3001\u30ab\u30ea\u30d5\u30a9\u30eb\u30cb\u30a2\u306e\u30a2\u30dc\u30ac\u30c9\u679c\u6a39\u5712\u306e\u5b9f\u969b\u306e\u30c7\u30fc\u30bf\u3092\u4f7f\u3063\u3066\u30c6\u30b9\u30c8\u3092\u3057\u307e\u3059\u3002InfluxDB\u306ePython\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u306einfluxdb-python\u3092\u4f7f\u3044InfluxDB\u306b\u30ec\u30b3\u30fc\u30c9\u3092\u767b\u9332\u3057\u3066\u3044\u304d\u307e\u3059\u3002Docker\u306e\u30d9\u30fc\u30b9\u30a4\u30e1\u30fc\u30b8\u306fgoogle/python-runtime\u3092\u4f7f\u3044\u307e\u3059\u3002\n$ mkdir -p ~/docker_apps/dwingest\n$ cd !$\n\npip\u3067\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\u30d1\u30c3\u30b1\u30fc\u30b8\u3092\u6307\u5b9a\u3057\u307e\u3059\u3002\n\nrequirements.txt\ninfluxdb\n\n\nDockerfile\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002ENTRYPOINT\u306b\u5b9f\u884c\u3059\u308bPython\u30b9\u30af\u30ea\u30d7\u30c8\u3068\u5f15\u6570\u3092\u6307\u5b9a\u3057\u307e\u3059\u3002\n\nDockerfile\nFROM google/python-runtime\nENTRYPOINT [\"/env/bin/python\", \"/app/dwingest.py\",\"10.1.3.67\",\"AvocadoGrove\",\"aiHotWaterTemp_degreesF\",\"20\"]\n\n\n\u30c6\u30b9\u30c8\u7528\u306bInfluxDB\u306e\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3068\u30e6\u30fc\u30b6\u30fc\u3092curl\u3092\u4f7f\u3044\u4f5c\u6210\u3057\u307e\u3059\u3002\n\ndatabase: dweet\nusername: dweet\npassword: dweet\n\n$ curl -X POST 'http://10.1.3.67:8086/db?u=root&p=root' -d '{\"name\": \"dweet\"}'\n$ curl -X POST 'http://10.1.3.67:8086/db/dweet/users?u=root&p=root' \\\n  -d '{\"name\": \"dweet\", \"password\": \"dweet\"}'\n\n\u4f5c\u696d\u7528\u30b3\u30f3\u30c6\u30ca\u3092\u8d77\u52d5\u3057\u3066dweet.io\u304b\u3089\u30af\u30a8\u30ea\u3057\u306a\u304c\u3089InfluxDB\u306b\u767b\u9332\u3057\u3066\u3044\u304d\u307e\u3059\u3002\n$ docker run --rm --name dwingest dwingest\n2015-02-10T07:12:27 Using InfluxDB host at 10.1.3.67:8086\n2015-02-10T07:12:27 ================================================================================\n2015-02-10T07:12:27 Querying thing AvocadoGrove with key aiHotWaterTemp_degreesF every 10 sec\n2015-02-10T07:12:27 --------------------------------------------------------------------------------\n2015-02-10T07:12:27 Starting new HTTP connection (1): 10.1.3.67\n2015-02-10T07:12:28 Ingested value: 95.661\n2015-02-10T07:12:38 --------------------------------------------------------------------------------\n2015-02-10T07:12:38 Resetting dropped connection: 10.1.3.67\n2015-02-10T07:12:38 Ingested value: 95.691\n2015-02-10T07:12:48 --------------------------------------------------------------------------------\n2015-02-10T07:12:49 Resetting dropped connection: 10.1.3.67\n2015-02-10T07:12:49 Ingested value: 95.691\n...\n\n\nGrafana\u3067\u30b0\u30e9\u30d5\u4f5c\u6210\n\u3053\u3093\u306a\u611f\u3058\u3067\u753b\u9762\u4e0a\u3067\u8a2d\u5b9a\u3092\u3057\u3066\u30b0\u30e9\u30d5\u304c\u7c21\u5358\u306b\u4f5c\u308c\u307e\u3059\u3002\n\n[Tutum](https://www.tutum.co/)\u304c\u63d0\u4f9b\u3057\u3066\u3044\u308bGrafana\u3068Elasticsearch\u3068Grafana\u306eDocker\u30a4\u30e1\u30fc\u30b8\u3092\u4f7f\u3063\u3066IoT\u7528\u306e\u30c7\u30fc\u30bf\u30b9\u30c8\u30a2\u3068\u53ef\u8996\u5316\u30d7\u30e9\u30c3\u30c8\u30d5\u30a9\u30fc\u30e0\u3092\u69cb\u7bc9\u3057\u307e\u3059\u3002MQTT\u30d6\u30ed\u30fc\u30ab\u30fc\u306eMosca\u3068\u307e\u3060\u9023\u643a\u3057\u3066\u3044\u306a\u3044\u306e\u3067\u3001\u30c0\u30df\u30fc\u30c7\u30fc\u30bf\u3068\u3057\u3066[dweet.io](http://dweet.io/)\u306e\u30c7\u30fc\u30bf\u3092InfluxDB\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u4f7f\u3044\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306b\u53d6\u308a\u8fbc\u307f\u307e\u3059\u3002[dweet.io + InfluxDB + Grafana](http://datadventures.ghost.io/2014/09/07/dweet-io-influxdb-grafana/)\u306e\u6295\u7a3f\u3092\u53c2\u8003\u306b\u3001\u30ab\u30ea\u30d5\u30a9\u30eb\u30cb\u30a2\u306e\u30a2\u30dc\u30ac\u30c9\u679c\u6a39\u5712\u306e\u30bb\u30f3\u30b5\u30fc\u30c7\u30fc\u30bf\u3092dweet.io\u304b\u3089\u53d6\u5f97\u3057\u307e\u3059\u3002\n\n## InfluxDB\u30b3\u30f3\u30c6\u30ca\n\nIoT\u306e\u30c7\u30fc\u30bf\u30b9\u30c8\u30a2\u3068\u3057\u3066InfluxDB\u3092\u4f7f\u3044\u307e\u3059\u3002Docker\u30a4\u30e1\u30fc\u30b8\u306f[tutum/influxdb](https://registry.hub.docker.com/u/tutum/influxdb/)\u3067\u3059\u3002\n\n``` bash\n$ docker pull tutum/influxdb\n$ docker run --name influxdb \\\n  -d \\\n  -p 8083:8083 \\\n  -p 8086:8086 \\\n  --expose 8090 \\\n  --expose 8099 \\\n  -e PRE_CREATE_DB=\"influxdb\"  \\\n  tutum/influxdb\n```\n\n\u30d6\u30e9\u30a6\u30b6\u3067\u78ba\u8a8d\u3057\u307e\u3059\u3002username\u3068password\u306f\u4ee5\u4e0b\u3067\u3059\u3002\n\n* uesrname: root\n* password root\n\nhttp://10.1.3.67:8083\n\n![influxdb-login.png](https://qiita-image-store.s3.amazonaws.com/0/43745/9a382eff-d641-0f82-973e-a43b4080cef4.png)\n\ncurl\u3067\u30ec\u30b3\u30fc\u30c9\u306e\u767b\u9332\u3068\u53d6\u5f97\u306e\u30c6\u30b9\u30c8\u3092\u3057\u307e\u3059\u3002\n\n``` bash\n$ curl -X POST -d '[{\"name\":\"foo\",\"columns\":[\"val\"],\"points\":[[23]]}]' 'http://localhost:8086/db/influxdb/series?u=root&p=root'\n```\n\n\u30ec\u30b3\u30fc\u30c9\u3092\u30af\u30a8\u30ea\u3057\u3066\u307f\u307e\u3059\u3002time\u3068sequence_number\u306f\u81ea\u52d5\u7684\u306b\u5165\u308a\u307e\u3059\u3002\n\n``` bash\n$ curl -G 'http://localhost:8086/db/influxdb/series?u=root&p=root&pretty=true' --data-urlencode \"q=select * from foo\"\n[\n    {\n        \"name\": \"foo\",\n        \"columns\": [\n            \"time\",\n            \"sequence_number\",\n            \"val\"\n        ],\n        \"points\": [\n            [\n                1423550210688,\n                10001,\n                23\n            ]\n        ]\n    }\n]\n```\n\n## Elasticsearch\u30b3\u30f3\u30c6\u30ca\n\nElasticsearch\u306b\u306fGrafana\u306e\u30c0\u30c3\u30b7\u30e5\u30dc\u30fc\u30c9\u8a2d\u5b9a\u60c5\u5831\u3092\u4fdd\u5b58\u3057\u307e\u3059\u3002Docker\u30d9\u30fc\u30b9\u30a4\u30e1\u30fc\u30b8\u306f[tutum/elasticsearch](https://registry.hub.docker.com/u/tutum/elasticsearch/)\u3067\u3059\u3002\u4eca\u56de\u306eDocker\u30db\u30b9\u30c8\u306e\u74b0\u5883\u306fIPv6\u304c\u7121\u52b9\u306b\u306a\u3063\u3066\u3044\u308b\u305f\u3081\u3001Docker Hub Registry\u304b\u3089\u53d6\u5f97\u3057\u305f\u30a4\u30e1\u30fc\u30b8\u306f\u8d77\u52d5\u306b\u5931\u6557\u3057\u3066\u3057\u307e\u3044\u307e\u3059\u3002IPv6\u3092\u7121\u52b9\u306b\u3059\u308b\u305f\u3081Nginx\u306e\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3092\u4fee\u6b63\u3057\u3066Docker\u30a4\u30e1\u30fc\u30b8\u306f\u4f5c\u308a\u76f4\u3057\u307e\u3059\u3002\n\n``` bash\n$ mkdir -p ~/docker_apps/es\n$ cd !$\n```\n\nsed\u3067IPv6\u306e\u8a2d\u5b9a\u3092\u30b3\u30e1\u30f3\u30c8\u30a2\u30a6\u30c8\u3057\u3066\u3001Dockerfile\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\n``` bash:Dockerfile\nFROM tutum/elasticsearch\nRUN sed -i  '/listen \\[::\\]:9200/s/\\(listen \\[::\\]:9200.*\\)/#\\1/' /etc/nginx/sites-enabled/default\n```\n\n\u30a4\u30e1\u30fc\u30b8\u3092\u30d3\u30eb\u30c9\u3057\u3066\u30b3\u30f3\u30c6\u30ca\u3092\u8d77\u52d5\u3057\u307e\u3059\u3002\n\n``` bash\n$ docker build masato/elasticsearch .\n$ docker run \\\n  --name es \\\n  -d \\\n  -p 9200:9200 \\\n  -e ELASTICSEARCH_USER=admin \\\n  -e ELASTICSEARCH_PASS=mypass \\\n  masato/elasticsearch\n```\n\ncurl\u3067Elasticsearch\u306e\u8d77\u52d5\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\n\n``` bash\n$ curl admin:mypass@10.1.3.67:9200\n  \"status\" : 200,\n  \"name\" : \"Madcap\",\n  \"version\" : {\n    \"number\" : \"1.3.2\",\n    \"build_hash\" : \"dee175dbe2f254f3f26992f5d7591939aaefd12f\",\n    \"build_timestamp\" : \"2014-08-13T14:29:30Z\",\n    \"build_snapshot\" : false,\n    \"lucene_version\" : \"4.9\"\n  },\n  \"tagline\" : \"You Know, for Search\"\n}\n```\n\n\n## Grafana\u30b3\u30f3\u30c6\u30ca\n\nGrafana\u306eDocker\u30d9\u30fc\u30b9\u30a4\u30e1\u30fc\u30b8\u306f[tutum/grafana](https://registry.hub.docker.com/u/tutum/grafana/)\u3067\u3059\u3002Elasticsearch\u3068\u540c\u69d8\u306bNginx\u306eIPv6\u306e\u8a2d\u5b9a\u3092\u30b3\u30e1\u30f3\u30c8\u30a2\u30a6\u30c8\u3057\u307e\u3059\u3002Docker\u30a4\u30e1\u30fc\u30b8\u3092\u30d3\u30eb\u30c9\u3059\u308b\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306e\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\n``` bash\n$ mkdir -p ~/docker_apps/grafana\n$ cd !$\n```\n\nDockerfile\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002sed\u3067Nginx\u306eIPv6\u8a2d\u5b9a\u3092\u30b3\u30e1\u30f3\u30c8\u30a2\u30a6\u30c8\u3057\u307e\u3059\u3002\n\n``` bash:Dockerfile\nFROM tutum/grafana\nRUN sed -i '/listen \\[::\\]:80/s/\\(listen \\[::\\]:80.*\\)/#\\1/' /etc/nginx/sites-enabled/default\n```\n\n\u30a4\u30e1\u30fc\u30b8\u3092\u30d3\u30eb\u30c9\u3057\u3066\u30b3\u30f3\u30c6\u30ca\u3092\u8d77\u52d5\u3057\u307e\u3059\u3002\u74b0\u5883\u5909\u6570\u306bInfluxDB\u306eIP\u30a2\u30c9\u30ec\u30b9\u3084\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u540d\u306a\u3069\u306e\u63a5\u7d9a\u60c5\u5831\u3092\u6307\u5b9a\u3057\u307e\u3059\u3002\n\n``` bash\n$ docker build -t masato/grafana .\n$ docker run --name grafana \\\n  -d \\\n  -p 8080:80 \\\n  -e INFLUXDB_HOST=10.1.3.67 \\\n  -e INFLUXDB_PORT=8086 \\\n  -e INFLUXDB_NAME=dweet  \\\n  -e INFLUXDB_USER=root \\\n  -e INFLUXDB_PASS=root \\\n  -e ELASTICSEARCH_HOST=10.1.3.67 \\\n  -e ELASTICSEARCH_PORT=9200 \\\n  -e ELASTICSEARCH_USER=admin \\\n  -e ELASTICSEARCH_PASS=mypass \\\n  masato/grafana\n```\n\n\u30ed\u30b0\u3092\u78ba\u8a8d\u3057\u3066\u81ea\u52d5\u751f\u6210\u3055\u308c\u305f\u30d1\u30b9\u30ef\u30fc\u30c9\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\n\n``` bash\n$ docker logs grafana\n=> Creating basic auth for \"admin\" user with random password\nAdding password for user admin\n=> Done!\n========================================================================\nYou can now connect to Grafana with the following credential:\n\n    admin:DUx0iSs3Zd10\n\n========================================================================\n=> Configuring InfluxDB\n=> InfluxDB has been configured as follows:\n   InfluxDB ADDRESS:  10.1.3.67\n   InfluxDB PORT:     8086\n   InfluxDB DB NAME:  sensortag\n   InfluxDB USERNAME: root\n   InfluxDB PASSWORD: root\n   ** Please check your environment variables if you find something is misconfigured. **\n=> Done!\n=> Found Elasticsearch settings.\n=> Set Elasticsearch url to \"http://admin:mypass@10.1.3.67:9200\".\n=> Done!\n=> Starting and running Nginx...\n```\n\n\u30d6\u30e9\u30a6\u30b6\u3067\u78ba\u8a8d\u3057\u307e\u3059\u3002username\u3068\u81ea\u52d5\u751f\u6210\u3055\u308c\u305f\u30d1\u30b9\u30ef\u30fc\u30c9\u306f\u4ee5\u4e0b\u3067\u3059\u3002\n\n* username: admin\n* password: DUx0iSs3Zd10\n\nhttp://10.1.3.67:8080\n![grafana.png](https://qiita-image-store.s3.amazonaws.com/0/43745/0d04fd56-f3bd-8679-6ee4-507a5cb7a3c5.png)\n\n## InfluxDB\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u30b3\u30f3\u30c6\u30ca\n\n[dweet.io + InfluxDB + Grafana](http://datadventures.ghost.io/2014/09/07/dweet-io-influxdb-grafana/)\u3092\u53c2\u8003\u306b\u3057\u3066\u3001\u30ab\u30ea\u30d5\u30a9\u30eb\u30cb\u30a2\u306e\u30a2\u30dc\u30ac\u30c9\u679c\u6a39\u5712\u306e\u5b9f\u969b\u306e\u30c7\u30fc\u30bf\u3092\u4f7f\u3063\u3066\u30c6\u30b9\u30c8\u3092\u3057\u307e\u3059\u3002InfluxDB\u306ePython\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u306e[influxdb-python](https://github.com/influxdb/influxdb-python)\u3092\u4f7f\u3044InfluxDB\u306b\u30ec\u30b3\u30fc\u30c9\u3092\u767b\u9332\u3057\u3066\u3044\u304d\u307e\u3059\u3002Docker\u306e\u30d9\u30fc\u30b9\u30a4\u30e1\u30fc\u30b8\u306f[google/python-runtime](https://registry.hub.docker.com/u/google/python-runtime/)\u3092\u4f7f\u3044\u307e\u3059\u3002\n\n``` bash\n$ mkdir -p ~/docker_apps/dwingest\n$ cd !$\n```\n\npip\u3067\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\u30d1\u30c3\u30b1\u30fc\u30b8\u3092\u6307\u5b9a\u3057\u307e\u3059\u3002\n\n```txt:requirements.txt\ninfluxdb\n```\n\nDockerfile\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002ENTRYPOINT\u306b\u5b9f\u884c\u3059\u308bPython\u30b9\u30af\u30ea\u30d7\u30c8\u3068\u5f15\u6570\u3092\u6307\u5b9a\u3057\u307e\u3059\u3002\n\n``` bash:Dockerfile\nFROM google/python-runtime\nENTRYPOINT [\"/env/bin/python\", \"/app/dwingest.py\",\"10.1.3.67\",\"AvocadoGrove\",\"aiHotWaterTemp_degreesF\",\"20\"]\n```\n\n\u30c6\u30b9\u30c8\u7528\u306bInfluxDB\u306e\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3068\u30e6\u30fc\u30b6\u30fc\u3092curl\u3092\u4f7f\u3044\u4f5c\u6210\u3057\u307e\u3059\u3002\n\n* database: dweet\n* username: dweet\n* password: dweet\n\n``` bash\n$ curl -X POST 'http://10.1.3.67:8086/db?u=root&p=root' -d '{\"name\": \"dweet\"}'\n$ curl -X POST 'http://10.1.3.67:8086/db/dweet/users?u=root&p=root' \\\n  -d '{\"name\": \"dweet\", \"password\": \"dweet\"}'\n```\n\n\u4f5c\u696d\u7528\u30b3\u30f3\u30c6\u30ca\u3092\u8d77\u52d5\u3057\u3066dweet.io\u304b\u3089\u30af\u30a8\u30ea\u3057\u306a\u304c\u3089InfluxDB\u306b\u767b\u9332\u3057\u3066\u3044\u304d\u307e\u3059\u3002\n\n``` bash\n$ docker run --rm --name dwingest dwingest\n2015-02-10T07:12:27 Using InfluxDB host at 10.1.3.67:8086\n2015-02-10T07:12:27 ================================================================================\n2015-02-10T07:12:27 Querying thing AvocadoGrove with key aiHotWaterTemp_degreesF every 10 sec\n2015-02-10T07:12:27 --------------------------------------------------------------------------------\n2015-02-10T07:12:27 Starting new HTTP connection (1): 10.1.3.67\n2015-02-10T07:12:28 Ingested value: 95.661\n2015-02-10T07:12:38 --------------------------------------------------------------------------------\n2015-02-10T07:12:38 Resetting dropped connection: 10.1.3.67\n2015-02-10T07:12:38 Ingested value: 95.691\n2015-02-10T07:12:48 --------------------------------------------------------------------------------\n2015-02-10T07:12:49 Resetting dropped connection: 10.1.3.67\n2015-02-10T07:12:49 Ingested value: 95.691\n...\n```\n\n## Grafana\u3067\u30b0\u30e9\u30d5\u4f5c\u6210\n\n\u3053\u3093\u306a\u611f\u3058\u3067\u753b\u9762\u4e0a\u3067\u8a2d\u5b9a\u3092\u3057\u3066\u30b0\u30e9\u30d5\u304c\u7c21\u5358\u306b\u4f5c\u308c\u307e\u3059\u3002\n\n![grafana-edit.png](https://qiita-image-store.s3.amazonaws.com/0/43745/ea91e09f-3017-76a6-c5e5-6a7db7f2d901.png)\n", "tags": ["influxdb0.8.8", "grafana1.9.0", "Elasticsearch1.3", "docker1.4.1", "dweet.o"]}