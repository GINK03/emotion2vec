{"tags": ["Excel", "ExcelVBA", "VBA"], "context": " More than 1 year has passed since last update.\n\nExcel\u3067\u4e0a\u306e\u884c\u3068\u30c7\u30fc\u30bf\u5185\u5bb9\u304c\u88ab\u3063\u305f\u5834\u5408\u306b\u6b21\u306e\u884c\u306e\u30c7\u30fc\u30bf\u306e\u6587\u5b57\u8272\u3092\u8584\u304f\u3059\u308b\n\n\u3053\u3093\u306a\u30c7\u30fc\u30bf\u3092\n\n\n\n\u3053\u3046\u3059\u308b\n\n\n\nVBA\n' \u958b\u59cb\u884c\nPublic Const FirstRow = \"5\"\n' \u5909\u66f4\u5f8c\u306e\u6587\u5b57\u8272\nPublic Const DupCellColor = \"&HAAAAAA\"\n\n' \u30e1\u30a4\u30f3\u51e6\u7406\nSub UpdateDilColor()\n\n    Dim LoopCnt As Integer                         ' \u30eb\u30fc\u30d7\u30ab\u30a6\u30f3\u30bf\n    Dim CellColArray As Variant                    ' \u5bfe\u8c61\u5217\u306e\u914d\u5217\n    CellColArray = Array(\"B\", \"C\", \"D\", \"E\", \"F\")  ' \u914d\u5217\u521d\u671f\u5316\n\n    Dim CurRange As Range                          ' \u73fe\u5728\u884c\n    Dim NextRange As Range                         ' \u6b21\u306e\u884c\n\n    ' \u5bfe\u8c61\u5217\u306e\u914d\u5217\u5206\u30eb\u30fc\u30d7\n    For LoopCnt = LBound(CellColArray) To UBound(CellColArray)\n        ' \u73fe\u5728\u884c\u30bb\u30eb\u3092\u30bb\u30c3\u30c8\n        Set CurRange = Range(CellColArray(LoopCnt) & FirstRow)\n        ' \u6b21\u306e\u884c\u30bb\u30eb\u3092\u30bb\u30c3\u30c8\n        Set NextRange = GetNextRowRange(CurRange)\n        ' \u8272\u66f4\u65b0\n        Call ChangeColor(CurRange, NextRange)\n    Next LoopCnt\n\nEnd Sub\n\n' \u6b21\u306e\u884c\u30bb\u30eb\u53d6\u5f97\nFunction GetNextRowRange(argRange As Range) As Range\n\n    Dim val As Range\n    Set GetNextRowRange = argRange.Offset(RowOffset:=1)\n\nEnd Function\n\n' \u8272\u5909\u63db\uff08\u9078\u629e\u5217\u306e\u6700\u4e0b\u884c\u307e\u3067\u518d\u5e30\u547c\u3073\u51fa\u3057\u3067\u30eb\u30fc\u30d7\uff09\nSub ChangeColor(argCurRange As Range, argNextRange As Range)\n\n    Dim CurRange As Range\n    Dim NextRange As Range\n    Set CurRange = argCurRange\n    Set NextRange = argNextRange\n\n    ' \u6b21\u306e\u884c\u30bb\u30eb\u304c\u7a7a\u306a\u3089\u518d\u5e30\u547c\u3073\u51fa\u3057\u7d42\u4e86\uff08\u51e6\u7406\u306a\u3057\uff09\n    If NextRange.Value <> \"\" Then\n        ' \u73fe\u5728\u30bb\u30eb\u3068\u6b21\u306e\u884c\u30bb\u30eb\u304c\u30c0\u30d6\u3063\u3066\u3044\u305f\u3089\u6b21\u306e\u884c\u30bb\u30eb\u306e\u6587\u5b57\u8272\u5909\u66f4\n        If CurRange.Value = NextRange.Value And NextRange.Value <> \"-\" Then\n            If CurRange.Offset(, columnOffset:=-1).Value = NextRange.Offset(, columnOffset:=-1).Value Then\n                NextRange.Font.Color = CLng(DupCellColor)\n            End If\n        End If\n\n        ' \u73fe\u5728\u30bb\u30eb\u3001\u6b21\u306e\u884c\u30bb\u30eb\u30921\u884c\u79fb\u52d5\n        Set CurRange = GetNextRowRange(CurRange)\n        Set NextRange = GetNextRowRange(NextRange)\n\n        ' \u518d\u5e30\u547c\u3073\u51fa\u3057\n        Call ChangeColor(CurRange, NextRange)\n\n    End If\n\nEnd Sub\n\n\n\n\u4e0a\u3068\u540c\u3058\u30c7\u30fc\u30bf\u3060\u3051\u3069\u3001\u5de6\u3067\u5207\u308a\u66ff\u308f\u308a\u304c\u3042\u3063\u305f\u304b\u3089\u5225\u30c7\u30fc\u30bf\u3068\u307f\u306a\u3059\u3001\u307f\u305f\u3044\u306a\u3053\u3068\u3092\u3057\u3066\u308b\u90e8\u5206\u304c\u6c5a\u3044\u3051\u3069\u307e\u3041\u3088\u3057\u3068\u3057\u3088\u3046\n\n## Excel\u3067\u4e0a\u306e\u884c\u3068\u30c7\u30fc\u30bf\u5185\u5bb9\u304c\u88ab\u3063\u305f\u5834\u5408\u306b\u6b21\u306e\u884c\u306e\u30c7\u30fc\u30bf\u306e\u6587\u5b57\u8272\u3092\u8584\u304f\u3059\u308b\n\n\n* \u3053\u3093\u306a\u30c7\u30fc\u30bf\u3092\n\n![aa.png](https://qiita-image-store.s3.amazonaws.com/0/40160/92ab3937-7db2-3a4a-92ca-53547d78516d.png)\n\n* \u3053\u3046\u3059\u308b\n\n![aa.png](https://qiita-image-store.s3.amazonaws.com/0/40160/3ad7b588-bc77-32ec-df80-ba63a2d332c7.png)\n\n```vbnet:VBA\n' \u958b\u59cb\u884c\nPublic Const FirstRow = \"5\"\n' \u5909\u66f4\u5f8c\u306e\u6587\u5b57\u8272\nPublic Const DupCellColor = \"&HAAAAAA\"\n\n' \u30e1\u30a4\u30f3\u51e6\u7406\nSub UpdateDilColor()\n    \n    Dim LoopCnt As Integer                         ' \u30eb\u30fc\u30d7\u30ab\u30a6\u30f3\u30bf\n    Dim CellColArray As Variant                    ' \u5bfe\u8c61\u5217\u306e\u914d\u5217\n    CellColArray = Array(\"B\", \"C\", \"D\", \"E\", \"F\")  ' \u914d\u5217\u521d\u671f\u5316\n\n    Dim CurRange As Range                          ' \u73fe\u5728\u884c\n    Dim NextRange As Range                         ' \u6b21\u306e\u884c\n    \n    ' \u5bfe\u8c61\u5217\u306e\u914d\u5217\u5206\u30eb\u30fc\u30d7\n    For LoopCnt = LBound(CellColArray) To UBound(CellColArray)\n        ' \u73fe\u5728\u884c\u30bb\u30eb\u3092\u30bb\u30c3\u30c8\n        Set CurRange = Range(CellColArray(LoopCnt) & FirstRow)\n        ' \u6b21\u306e\u884c\u30bb\u30eb\u3092\u30bb\u30c3\u30c8\n        Set NextRange = GetNextRowRange(CurRange)\n        ' \u8272\u66f4\u65b0\n        Call ChangeColor(CurRange, NextRange)\n    Next LoopCnt\n        \nEnd Sub\n\n' \u6b21\u306e\u884c\u30bb\u30eb\u53d6\u5f97\nFunction GetNextRowRange(argRange As Range) As Range\n\n    Dim val As Range\n    Set GetNextRowRange = argRange.Offset(RowOffset:=1)\n\nEnd Function\n\n' \u8272\u5909\u63db\uff08\u9078\u629e\u5217\u306e\u6700\u4e0b\u884c\u307e\u3067\u518d\u5e30\u547c\u3073\u51fa\u3057\u3067\u30eb\u30fc\u30d7\uff09\nSub ChangeColor(argCurRange As Range, argNextRange As Range)\n\n    Dim CurRange As Range\n    Dim NextRange As Range\n    Set CurRange = argCurRange\n    Set NextRange = argNextRange\n\n    ' \u6b21\u306e\u884c\u30bb\u30eb\u304c\u7a7a\u306a\u3089\u518d\u5e30\u547c\u3073\u51fa\u3057\u7d42\u4e86\uff08\u51e6\u7406\u306a\u3057\uff09\n    If NextRange.Value <> \"\" Then\n        ' \u73fe\u5728\u30bb\u30eb\u3068\u6b21\u306e\u884c\u30bb\u30eb\u304c\u30c0\u30d6\u3063\u3066\u3044\u305f\u3089\u6b21\u306e\u884c\u30bb\u30eb\u306e\u6587\u5b57\u8272\u5909\u66f4\n        If CurRange.Value = NextRange.Value And NextRange.Value <> \"-\" Then\n            If CurRange.Offset(, columnOffset:=-1).Value = NextRange.Offset(, columnOffset:=-1).Value Then\n                NextRange.Font.Color = CLng(DupCellColor)\n            End If\n        End If\n        \n        ' \u73fe\u5728\u30bb\u30eb\u3001\u6b21\u306e\u884c\u30bb\u30eb\u30921\u884c\u79fb\u52d5\n        Set CurRange = GetNextRowRange(CurRange)\n        Set NextRange = GetNextRowRange(NextRange)\n        \n        ' \u518d\u5e30\u547c\u3073\u51fa\u3057\n        Call ChangeColor(CurRange, NextRange)\n    \n    End If\n\nEnd Sub\n```\n\n* \u4e0a\u3068\u540c\u3058\u30c7\u30fc\u30bf\u3060\u3051\u3069\u3001\u5de6\u3067\u5207\u308a\u66ff\u308f\u308a\u304c\u3042\u3063\u305f\u304b\u3089\u5225\u30c7\u30fc\u30bf\u3068\u307f\u306a\u3059\u3001\u307f\u305f\u3044\u306a\u3053\u3068\u3092\u3057\u3066\u308b\u90e8\u5206\u304c\u6c5a\u3044\u3051\u3069\u307e\u3041\u3088\u3057\u3068\u3057\u3088\u3046\n"}