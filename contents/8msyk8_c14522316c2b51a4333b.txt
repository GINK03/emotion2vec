{"context": "VBA\u30b3\u30fc\u30c9\u66f8\u304d\u307e\u3057\u305f\u3002\n\u203b\u5f8c\u307b\u3069\u8a73\u7d30\u5171\u6709\u4e88\u5b9a\u3067\u3059\u3002\nSub \u30dc\u30bf\u30f31_Click()\n'1.\nB11 = Sheet1.Cells(11, 3).Value '\u65e5\u4ed8\nB12 = Sheet1.Cells(12, 3).Value '\u5834\u6240\nB13 = Sheet1.Cells(13, 3).Value '\u7530\u3093\u307c\nB14 = Sheet1.Cells(14, 3).Value '\u6c34\u91cf\nMaxCol = Sheet2.Range(\"C8\").End(xlToRight).Column\nMaxRow = Sheet2.Range(\"B8\").End(xlDown).Row\nfirsttime = True '\u5148\u982d\u884c\u306bB12,B13\u306e\u540c\u4e00\u30c7\u30fc\u30bf\u304c\u306a\u3044\u3002/\u5165\u529b\u6e08\u306b\u623b\u3063\u305f\u6642\n'\u521d\u671f\u5316\u6642\u306e\u884c\u6307\u5b9a\u306e\u305f\u3081\nIf MaxRow = 1048576 Then\nMaxRow = 8\nEnd If\n'http://excelvba.pc-users.net/fol7/7_1.html\nlngYLine = Worksheets(\"Sheet1\").Cells.Find(B13, LookAt:=xlWhole).Row\nintXLine = Worksheets(\"Sheet1\").Cells.Find(B13, LookAt:=xlWhole).Column\n''        MsgBox B13 + \"\u306f\" + CStr(lngYLine) + \"\u884c\u76ee\u306e\" _\n''                + CStr(intXLine) + \"\u5217\u76ee\u306b\u3042\u308a\u307e\u3059\"\n''        MsgBox (intXLine)\n''        MsgBox (lngYLine)\n    wtr = Cells(lngYLine, intXLine + 1).Value\n    'MsgBox (wtr)\n\nFor i = 4 To MaxCol\n' date\nIf Sheet2.Cells(8, i) = B11 Then\n'MsgBox (\"OK\")\nFor l = 9 To MaxRow + 1\n'\nIf Sheet2.Cells(l, 2).Value = B12 And Sheet2.Cells(l, 3).Value = B13 Then\n   Sheet2.Cells(l, i) = wtr / B14\n      firsttime = False 'B12,B13\u3068\u306e\u540c\u4e00\u30c7\u30fc\u30bf\u3092\u898b\u3064\u3051\u3066\u5165\u529b\u6e08\nEnd If\nlast_Data = l 'L\n If Sheet2.Cells(l, 2).Value <> B12 Or Sheet2.Cells(l, 3).Value <> B13 Then '\u7247\u65b9\u3069\u3061\u3089\u304b\u304c\u9055\u3046\u3068\u3068\u304a\nIf MaxRow = last_Data Then\nIf firsttime <> False Then\n' MsgBox (\"!!\")\n    Sheet2.Cells(MaxRow + 1, 2) = B12\n    Sheet2.Cells(MaxRow + 1, 3) = B13\n    Sheet2.Cells(MaxRow + 1, i) = wtr / B14\n    firsttime = False\n End If\n End If\n End If\nNext l\nEnd If\nNext i\nfirsttime = True\nDim varCheck As Variant\nvarDeleteCheck = Sheet1.CheckBox1.Value\nvarMoveCheck = Sheet1.CheckBox2.Value\n\n'3 \u30c7\u30fc\u30bf\u524a\u9664\nIf varDeleteCheck = True Then\nSheet1.Range(\"C11:C14\").ClearContents\nEnd If\n'4 \u4f5c\u696d\u5b8c\u4e86\nIf varMoveCheck = True Then\nSheet2.Activate\nEnd If\nEnd Sub\nVBA\u30b3\u30fc\u30c9\u66f8\u304d\u307e\u3057\u305f\u3002\n\u203b\u5f8c\u307b\u3069\u8a73\u7d30\u5171\u6709\u4e88\u5b9a\u3067\u3059\u3002\n\nSub \u30dc\u30bf\u30f31_Click()\n\n '1.\nB11 = Sheet1.Cells(11, 3).Value '\u65e5\u4ed8\nB12 = Sheet1.Cells(12, 3).Value '\u5834\u6240\nB13 = Sheet1.Cells(13, 3).Value '\u7530\u3093\u307c\nB14 = Sheet1.Cells(14, 3).Value '\u6c34\u91cf\nMaxCol = Sheet2.Range(\"C8\").End(xlToRight).Column\nMaxRow = Sheet2.Range(\"B8\").End(xlDown).Row\nfirsttime = True '\u5148\u982d\u884c\u306bB12,B13\u306e\u540c\u4e00\u30c7\u30fc\u30bf\u304c\u306a\u3044\u3002/\u5165\u529b\u6e08\u306b\u623b\u3063\u305f\u6642\n\n\n'\u521d\u671f\u5316\u6642\u306e\u884c\u6307\u5b9a\u306e\u305f\u3081\nIf MaxRow = 1048576 Then\nMaxRow = 8\nEnd If\n'http://excelvba.pc-users.net/fol7/7_1.html\nlngYLine = Worksheets(\"Sheet1\").Cells.Find(B13, LookAt:=xlWhole).Row\nintXLine = Worksheets(\"Sheet1\").Cells.Find(B13, LookAt:=xlWhole).Column\n''        MsgBox B13 + \"\u306f\" + CStr(lngYLine) + \"\u884c\u76ee\u306e\" _\n''                + CStr(intXLine) + \"\u5217\u76ee\u306b\u3042\u308a\u307e\u3059\"\n''        MsgBox (intXLine)\n''        MsgBox (lngYLine)\n        \n        wtr = Cells(lngYLine, intXLine + 1).Value\n        'MsgBox (wtr)\n\n\n\nFor i = 4 To MaxCol\n\n' date\nIf Sheet2.Cells(8, i) = B11 Then\n'MsgBox (\"OK\")\n\nFor l = 9 To MaxRow + 1\n\n'\nIf Sheet2.Cells(l, 2).Value = B12 And Sheet2.Cells(l, 3).Value = B13 Then\n   Sheet2.Cells(l, i) = wtr / B14\n      firsttime = False 'B12,B13\u3068\u306e\u540c\u4e00\u30c7\u30fc\u30bf\u3092\u898b\u3064\u3051\u3066\u5165\u529b\u6e08\nEnd If\n\n last_Data = l 'L\n If Sheet2.Cells(l, 2).Value <> B12 Or Sheet2.Cells(l, 3).Value <> B13 Then '\u7247\u65b9\u3069\u3061\u3089\u304b\u304c\u9055\u3046\u3068\u3068\u304a\n \n If MaxRow = last_Data Then\n \nIf firsttime <> False Then\n \n \n   ' MsgBox (\"!!\")\n    Sheet2.Cells(MaxRow + 1, 2) = B12\n    Sheet2.Cells(MaxRow + 1, 3) = B13\n    Sheet2.Cells(MaxRow + 1, i) = wtr / B14\n    firsttime = False\n End If\n End If\n End If\n \n\nNext l\n    \nEnd If\n\nNext i\n\nfirsttime = True\n\n  Dim varCheck As Variant\n    \n    varDeleteCheck = Sheet1.CheckBox1.Value\n    varMoveCheck = Sheet1.CheckBox2.Value\n\n'3 \u30c7\u30fc\u30bf\u524a\u9664\nIf varDeleteCheck = True Then\nSheet1.Range(\"C11:C14\").ClearContents\nEnd If\n\n'4 \u4f5c\u696d\u5b8c\u4e86\nIf varMoveCheck = True Then\nSheet2.Activate\nEnd If\n\nEnd Sub\n\n", "tags": ["VBA"]}