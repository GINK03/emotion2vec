{"context": " More than 1 year has passed since last update.\n\nWhy Logging?\nThe most important thing of running a webservice like EZTABLE is to keep the service 24/7 available. However, things always happen in unexpected ways. Having a monitoring system improves the response time when the service operates abnormally. Having a logging system allows DevOps and software developers to foresee the problems before it happens.\nIf you are going to run a webserviice, I would suggest you to log everything at day 1.\n\nWhat is a Good Logging System?\nWhen choosing a logging system, I would always consider the following features:\n\nCapability of logging from different programming languages and sources.\nIntegration with storage components like S3 and HDFS.\nSupporting for server farm and fault recovery.\n\nCurrently, the best open source solutions are Apache Flume, fluentd, and Scribe.\nThose solutions support at least one of the popular RPC libraries like Thrift, or have very good integration with language's logging frameworks like Log4j or Monolog. Being able to store logs in various storage system and a distributed architecture are the for-sure features. \n\nScribe, Open Sourced by Facebook\nFacebook open sourced Scribe in 2008. As the following figure, the architecture is simple tree model.\n          'client'                    'central'\n----------------------------     --------------------\n| Port 1464                 |    | Port 1463         |\n|        ----------------   |    | ----------------  |\n|     -> | scribe server |--|--->| | scribe server | |\n|        ----------------   |    | ----------------  |\n|                |          |    |    |         |    |\n|            temp file      |    |    |    temp file |\n|---------------------------     |-------------------\n                                      |\n                                   -------------------\n                                   | /tmp/scribetest/ |\n                                   -------------------\n\nRunning a Scribe deamon on each server. Applications use Thrift to communicate with Scribe server on localhost. The local Scribe deamon buffered the logs and forward to the upstream Scribe server. Finally the central Scribe server append the logs to the filesystem.\nDetailed installation guide and examples are on Github. Basically you can get Scribe on production with the following steps:\n1.Instell Thrift.\n2. Install FB303 from Thrift's contrib folder.\n3. Install Scribe.\n4. Write the configuration file for buffers and central. Start Scribe deamon.\n5. Generate the source code for your language from the scribe/if folder.\n\nLog Format\nI highly recommend you to store logs in JSON format. It can be processed by all languages.\n\nGotchas\nI was having a hard time compiling Scribe after I upgrade the libboost package. I found this blog post solving my problem. Basically, just add the following when ./configure\n$ ./configure CPPFLAGS=\"-DHAVE_INTTYPES_H -DHAVE_NETINET_IN_H -DBOOST_FILESYSTEM_VERSION=2\"\n\n# Why Logging?\n\nThe most important thing of running a webservice like [EZTABLE](http://www.eztable.com/) is to keep the service 24/7 available. However, things always happen in unexpected ways. Having a monitoring system improves the response time when the service operates abnormally. Having a logging system allows DevOps and software developers to foresee the problems before it happens.\n\nIf you are going to run a webserviice, I would suggest you to log everything at day 1.\n\n# What is a Good Logging System?\n\nWhen choosing a logging system, I would always consider the following features:\n\n- Capability of logging from different programming languages and sources.\n- Integration with storage components like S3 and HDFS.\n- Supporting for server farm and fault recovery.\n\nCurrently, the best open source solutions are [Apache Flume](http://flume.apache.org/), [fluentd](http://fluentd.org/), and [Scribe](https://github.com/facebook/scribe).\n\nThose solutions support at least one of the popular RPC libraries like [Thrift](http://thrift.apache.org/), or have very good integration with language's logging frameworks like [Log4j](http://logging.apache.org/log4j/) or [Monolog](https://github.com/Seldaek/monolog). Being able to store logs in various storage system and a distributed architecture are the for-sure features. \n\n# Scribe, Open Sourced by Facebook\n\nFacebook open sourced Scribe in 2008. As the following figure, the architecture is simple tree model.\n\n```\n          'client'                    'central'\n----------------------------     --------------------\n| Port 1464                 |    | Port 1463         |\n|        ----------------   |    | ----------------  |\n|     -> | scribe server |--|--->| | scribe server | |\n|        ----------------   |    | ----------------  |\n|                |          |    |    |         |    |\n|            temp file      |    |    |    temp file |\n|---------------------------     |-------------------\n                                      |\n                                   -------------------\n                                   | /tmp/scribetest/ |\n                                   -------------------\n```\n\nRunning a Scribe deamon on each server. Applications use Thrift to communicate with Scribe server on localhost. The local Scribe deamon buffered the logs and forward to the upstream Scribe server. Finally the central Scribe server append the logs to the filesystem.\n\nDetailed [installation guide](https://github.com/facebook/scribe) and [examples](https://github.com/facebook/scribe/tree/master/examples) are on Github. Basically you can get Scribe on production with the following steps:\n\n1.[Instell Thrift](http://wiki.apache.org/thrift/ThriftInstallation).\n2. Install FB303 from Thrift's contrib folder.\n3. Install Scribe.\n4. Write the configuration file for buffers and central. Start Scribe deamon.\n5. Generate the source code for your language from the scribe/if folder.\n\n# Log Format\n\nI highly recommend you to store logs in JSON format. It can be processed by all languages.\n\n# Gotchas\n\nI was having a hard time compiling Scribe after I upgrade the libboost package. I found [this blog post](http://www.nosql.se/2012/10/tutorial-installing-scribe-on-debianubuntu/) solving my problem. Basically, just add the following when ./configure\n\n```\n$ ./configure CPPFLAGS=\"-DHAVE_INTTYPES_H -DHAVE_NETINET_IN_H -DBOOST_FILESYSTEM_VERSION=2\"\n```\n", "tags": ["log", "scribe"]}