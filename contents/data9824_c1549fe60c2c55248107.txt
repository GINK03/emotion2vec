{"context": " More than 1 year has passed since last update.\u307e\u305a\u3001\u3053\u306e\u7dda\u5f62\u57fa\u5e95\u95a2\u6570\u30e2\u30c7\u30eb\u3067\u7528\u3044\u308b\u30ac\u30a6\u30b9\u57fa\u5e95\u95a2\u6570\u3092\u56f3\u793a\u3057\u307e\u3059\u3002\n\u6b21\u306b\u3001PRML\u56f33.10\u306e\u53f3\u56f3\u3068\u540c\u69d8\u306b\u3001\u3053\u306e\u30e2\u30c7\u30eb\u306b\u304a\u3051\u308b\u7b49\u4fa1\u30ab\u30fc\u30cd\u30eb\u3092\u56f3\u793a\u3057\u307e\u3059\u3002\u305f\u3060\u3057\u3001\u30b5\u30f3\u30d7\u30eb\u306f[-1,1]\u306e\u533a\u9593\u306e\u7b49\u9593\u9694\u306e6\u70b9\u304b\u3089\u53d6\u5f97\u3057\u307e\u3059\u3002\n\u3055\u3089\u306b\u3001\u30b5\u30f3\u30d7\u30eb\u70b9xn\u3054\u3068\u306e\u7b49\u4fa1\u30ab\u30fc\u30cd\u30ebk(x,xn)\u306e\u5024\u3092\u56f3\u793a\u3057\u307e\u3059\u3002\n\u6700\u5f8c\u306b\u3001\u30b5\u30f3\u30d7\u30eb\u5024tn\u3001\u304a\u3088\u3073\u305d\u306e\u30b5\u30f3\u30d7\u30eb\u306b\u5bfe\u5fdc\u3059\u308b\u3001\u7b49\u4fa1\u30ab\u30fc\u30cd\u30eb\u3068\u30b5\u30f3\u30d7\u30eb\u76ee\u6a19\u5024\u3068\u306e\u7a4dk(x,xn)tn\u3092\u56f3\u793a\u3057\u3001\u305d\u308c\u3089\u306e\u548c\u306b\u3088\u3063\u3066\u7dda\u5f62\u5e73\u6ed1\u5668\u306b\u3088\u308b\u4e88\u6e2c\u304c\u5f97\u3089\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u793a\u3057\u307e\u3059\u3002\n\nframe()\nset.seed(0)\npar(mfrow=c(2, 2))\npar(mar=c(2, 2, 1, 0.1))\npar(mgp=c(1, 0.2, 0))\nxrange <- c(-1.0, 1.0)\nyrange <- c(-1.5, 1.5)\nx1 <- seq(xrange[1], xrange[2], .02)\nx2 <- seq(yrange[1], yrange[2], .02)\ncolors <- rainbow(450)[256:1]\nM <- 10\nN <- 6\n\nbase <- function(m, x) {\n#   r <- x^m                                        #\u591a\u9805\u5f0f\u57fa\u5e95\u306e\u5834\u5408\n    r <- exp(-(x-(2*(m-1)/(M-2)-1))^2/(2*0.2^2))    #\u30ac\u30a6\u30b9\u57fa\u5e95\u306e\u5834\u5408\n    r[m == 0]<-1                                    # w0\u3092\u30d0\u30a4\u30a2\u30b9\u9805\u3068\u3059\u308b\u305f\u3081\u03c60=1\n    r\n}\nfor (m in (1:M)) {\n    basem <- function(x) { base(m, x) }\n    par(new=(m>1))\n    curve(basem, xlim=xrange, ylim=yrange, ylab=\"phi(x)\")\n}\ntitle(\"basis func.\")\n\nmakePhi<-function(M, x) {\n    A <- matrix(nrow=length(x), ncol=M)\n    for (i in 1:length(x)) {\n        for (j in 0:(M-1)) {\n            A[i, 1+j] <- base(j, x[i])\n        }\n    }\n    A\n}\nx <- seq(-1, 1, 2 / (N - 1))\ny <- rnorm(length(x), sin(2 * pi * x), 0.2)\n\nalpha <- 0.1\nbeta <- (1 / 0.2) ^ 2\n\n# prior probability distribution\ns0inv <- alpha * diag(1, M)\nm0 <- rep(0, M)\ncat(\"s0\");print(solve(s0inv))\ncat(\"m0\");print(m0)\n\n# derive the posterior\nphi <- makePhi(M, x)\nsninv <- s0inv + beta * t(phi) %*% phi\nsn <- solve(sninv)\nmn <- sn %*% (s0inv %*% m0 + beta * t(phi) %*% y)\ncat(\"sn\");print(sn)\ncat(\"mn\");print(mn)\n\nkernel <- function(x, xd) {\n    phix <- t(makePhi(M, x))\n    phixd <- t(makePhi(M, xd))\n    beta * t(phix) %*% sn %*% phixd\n}\nimage(x1, x2, outer(x1, x2, Vectorize(kernel)), xlim=xrange, ylim=xrange, col=colors, xlab=\"x\", ylab=\"x'\")\ntitle(\"k(x,x')\")\n\nplot(x, y, type=\"n\", xlim=xrange, ylim=yrange)\nfor (n in 1:N) {\n    col = rainbow(N)[n]\n    kernelN <- function(xx) {\n        kernel(xx, x[n])\n    }\n    par(new=T)\n    curve(kernelN, xlim=xrange, ylim=yrange, xlab=\"\", ylab=\"\", axes=F, col=col)\n}\nlegend(\"bottomright\", legend=paste(\"x'=\", round(x,1)), col=rainbow(N), lty=1, cex=1, y.intersp=1)\ntitle(\"k(x,x')\")\n\nplot(x, y, type=\"n\", xlim=xrange, ylim=yrange)\nestimate <- function(xx) {\n    kernel(xx, x) %*% y\n}\npar(new=T)\ncurve(estimate, xlim=xrange, ylim=yrange, xlab=\"\", ylab=\"\", axes=F, col=gray(0.5))\nfor (n in 1:N) {\n    col = rainbow(N)[n]\n    par(new=T)\n    plot(x[n], y[n], pch=16, xlim=xrange, ylim=yrange, xlab=\"\", ylab=\"\", axes=F, col=col)\n    kernelT <- function(xx) {\n        kernel(xx, x[n]) * y[n]\n    }\n    par(new=T)\n    curve(kernelT, xlim=xrange, ylim=yrange, xlab=\"\", ylab=\"\", axes=F, col=col)\n}\ntitle(\"tn, k(x,xn)tn, y(x)\")\n\n\u307e\u305a\u3001\u3053\u306e\u7dda\u5f62\u57fa\u5e95\u95a2\u6570\u30e2\u30c7\u30eb\u3067\u7528\u3044\u308b\u30ac\u30a6\u30b9\u57fa\u5e95\u95a2\u6570\u3092\u56f3\u793a\u3057\u307e\u3059\u3002\n\u6b21\u306b\u3001PRML\u56f33.10\u306e\u53f3\u56f3\u3068\u540c\u69d8\u306b\u3001\u3053\u306e\u30e2\u30c7\u30eb\u306b\u304a\u3051\u308b\u7b49\u4fa1\u30ab\u30fc\u30cd\u30eb\u3092\u56f3\u793a\u3057\u307e\u3059\u3002\u305f\u3060\u3057\u3001\u30b5\u30f3\u30d7\u30eb\u306f[-1,1]\u306e\u533a\u9593\u306e\u7b49\u9593\u9694\u306e6\u70b9\u304b\u3089\u53d6\u5f97\u3057\u307e\u3059\u3002\n\u3055\u3089\u306b\u3001\u30b5\u30f3\u30d7\u30eb\u70b9xn\u3054\u3068\u306e\u7b49\u4fa1\u30ab\u30fc\u30cd\u30ebk(x,xn)\u306e\u5024\u3092\u56f3\u793a\u3057\u307e\u3059\u3002\n\u6700\u5f8c\u306b\u3001\u30b5\u30f3\u30d7\u30eb\u5024tn\u3001\u304a\u3088\u3073\u305d\u306e\u30b5\u30f3\u30d7\u30eb\u306b\u5bfe\u5fdc\u3059\u308b\u3001\u7b49\u4fa1\u30ab\u30fc\u30cd\u30eb\u3068\u30b5\u30f3\u30d7\u30eb\u76ee\u6a19\u5024\u3068\u306e\u7a4dk(x,xn)tn\u3092\u56f3\u793a\u3057\u3001\u305d\u308c\u3089\u306e\u548c\u306b\u3088\u3063\u3066\u7dda\u5f62\u5e73\u6ed1\u5668\u306b\u3088\u308b\u4e88\u6e2c\u304c\u5f97\u3089\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u793a\u3057\u307e\u3059\u3002\n\n![](https://dl.dropbox.com/sh/cwfemibvr7gk4cy/_ti9_Mf_Ui/13.EquivalentKernel.png)\n\n```r\nframe()\nset.seed(0)\npar(mfrow=c(2, 2))\npar(mar=c(2, 2, 1, 0.1))\npar(mgp=c(1, 0.2, 0))\nxrange <- c(-1.0, 1.0)\nyrange <- c(-1.5, 1.5)\nx1 <- seq(xrange[1], xrange[2], .02)\nx2 <- seq(yrange[1], yrange[2], .02)\ncolors <- rainbow(450)[256:1]\nM <- 10\nN <- 6\n\nbase <- function(m, x) {\n#\tr <- x^m\t\t\t\t\t\t\t\t\t\t#\u591a\u9805\u5f0f\u57fa\u5e95\u306e\u5834\u5408\n\tr <- exp(-(x-(2*(m-1)/(M-2)-1))^2/(2*0.2^2))\t#\u30ac\u30a6\u30b9\u57fa\u5e95\u306e\u5834\u5408\n\tr[m == 0]<-1\t\t\t\t\t\t\t\t\t# w0\u3092\u30d0\u30a4\u30a2\u30b9\u9805\u3068\u3059\u308b\u305f\u3081\u03c60=1\n\tr\n}\nfor (m in (1:M)) {\n\tbasem <- function(x) { base(m, x) }\n\tpar(new=(m>1))\n\tcurve(basem, xlim=xrange, ylim=yrange, ylab=\"phi(x)\")\n}\ntitle(\"basis func.\")\n \nmakePhi<-function(M, x) {\n\tA <- matrix(nrow=length(x), ncol=M)\n\tfor (i in 1:length(x)) {\n\t\tfor (j in 0:(M-1)) {\n\t\t\tA[i, 1+j] <- base(j, x[i])\n\t\t}\n\t}\n\tA\n}\nx <- seq(-1, 1, 2 / (N - 1))\ny <- rnorm(length(x), sin(2 * pi * x), 0.2)\n\nalpha <- 0.1\nbeta <- (1 / 0.2) ^ 2\n\n# prior probability distribution\ns0inv <- alpha * diag(1, M)\nm0 <- rep(0, M)\ncat(\"s0\");print(solve(s0inv))\ncat(\"m0\");print(m0)\n\n# derive the posterior\nphi <- makePhi(M, x)\nsninv <- s0inv + beta * t(phi) %*% phi\nsn <- solve(sninv)\nmn <- sn %*% (s0inv %*% m0 + beta * t(phi) %*% y)\ncat(\"sn\");print(sn)\ncat(\"mn\");print(mn)\n\nkernel <- function(x, xd) {\n\tphix <- t(makePhi(M, x))\n\tphixd <- t(makePhi(M, xd))\n\tbeta * t(phix) %*% sn %*% phixd\n}\nimage(x1, x2, outer(x1, x2, Vectorize(kernel)), xlim=xrange, ylim=xrange, col=colors, xlab=\"x\", ylab=\"x'\")\ntitle(\"k(x,x')\")\n\nplot(x, y, type=\"n\", xlim=xrange, ylim=yrange)\nfor (n in 1:N) {\n\tcol = rainbow(N)[n]\n\tkernelN <- function(xx) {\n\t\tkernel(xx, x[n])\n\t}\n\tpar(new=T)\n\tcurve(kernelN, xlim=xrange, ylim=yrange, xlab=\"\", ylab=\"\", axes=F, col=col)\n}\nlegend(\"bottomright\", legend=paste(\"x'=\", round(x,1)), col=rainbow(N), lty=1, cex=1, y.intersp=1)\ntitle(\"k(x,x')\")\n\nplot(x, y, type=\"n\", xlim=xrange, ylim=yrange)\nestimate <- function(xx) {\n\tkernel(xx, x) %*% y\n}\npar(new=T)\ncurve(estimate, xlim=xrange, ylim=yrange, xlab=\"\", ylab=\"\", axes=F, col=gray(0.5))\nfor (n in 1:N) {\n\tcol = rainbow(N)[n]\n\tpar(new=T)\n\tplot(x[n], y[n], pch=16, xlim=xrange, ylim=yrange, xlab=\"\", ylab=\"\", axes=F, col=col)\n\tkernelT <- function(xx) {\n\t\tkernel(xx, x[n]) * y[n]\n\t}\n\tpar(new=T)\n\tcurve(kernelT, xlim=xrange, ylim=yrange, xlab=\"\", ylab=\"\", axes=F, col=col)\n}\ntitle(\"tn, k(x,xn)tn, y(x)\")\n```\n", "tags": ["R", "PRML"]}