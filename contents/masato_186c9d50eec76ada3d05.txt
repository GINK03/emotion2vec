{"tags": ["myThings", "IDCF\u30af\u30e9\u30a6\u30c9", "mqtt", "IoT", "mosquitto"], "context": " More than 1 year has passed since last update.Mesublu\u306f\u8907\u6570\u306e\u30c8\u30e9\u30f3\u30dd\u30fc\u30c8\u30d7\u30ed\u30c8\u30b3\u30eb\u306b\u5bfe\u5fdc\u3057\u3066\u3044\u307e\u3059\u3002HTTP POST\u3057\u305f\u30e1\u30c3\u30bb\u30fc\u30b8\u3092MQTT\u3067subscribe\u3057\u3066\u53d7\u4fe1\u3059\u308b\u3053\u3068\u3082\u3067\u304d\u307e\u3059\u3002\u201dPart2: IDCF\u30af\u30e9\u30a6\u30c9\u306b\u300cIDCF\u300d\u30c1\u30e3\u30f3\u30cd\u30eb\u3092\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\u3059\u308b\u201d\u3067\u69cb\u7bc9\u3057\u305f\u30b5\u30fc\u30d0\u3092\u30d6\u30ed\u30fc\u30ab\u30fc\u3068\u3057\u3066\u3001\u30e1\u30c3\u30bb\u30fc\u30b8\u30f3\u30b0\u3068\u30c7\u30fc\u30bf\u4fdd\u5b58\u306e\u30c6\u30b9\u30c8\u3092\u3057\u3066\u307f\u307e\u3059\u3002\n\nMQTT\u30d6\u30ed\u30fc\u30ab\u30fc\u3092\u4f7f\u3063\u305f\u30e1\u30c3\u30bb\u30fc\u30b8\u30f3\u30b0\nMQTT\u306e\u57fa\u672c\u7684\u306a\u30e1\u30c3\u30bb\u30fc\u30b8\u30f3\u30b0\u3092\u30c6\u30b9\u30c8\u3057\u307e\u3059\u3002trigger-1\u3068action-1\u306euuid\u3092\u4f7f\u3044\u307e\u3059\u3002\n\n\u30e1\u30c3\u30bb\u30fc\u30b8\u9001\u4fe1: trigger-1\n\u30e1\u30c3\u30bb\u30fc\u30b8\u53d7\u4fe1: action-1\n\n\nMQTT\u3092publish,subscribe\u3059\u308b\u305f\u3081\u306eclient\u3068\u3057\u3066\u3001mosquitto-clients\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u305f\u30db\u30b9\u30c8\u3092\u6e96\u5099\u3057\u3001MQTT\u30d6\u30ed\u30fc\u30ab\u30fc\u3068\u901a\u4fe1\u3055\u305b\u307e\u3059\u3002\n\nMQTT\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\nMQTT\u3067\u306e\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u9001\u4fe1\uff08publish\uff09,\u53d7\u4fe1(subscribe)\u3092\u3059\u308b\u305f\u3081\u306b\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u3068\u3057\u3066\u3001mosquitto-clients\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\u4eca\u56de\u306f\u4fbf\u5b9c\u4e0a\u3001\u9001\u53d7\u4fe1\u306e\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u3068\u30d6\u30ed\u30fc\u30ab\u30fc\u3092\u540c\u3058\u30db\u30b9\u30c8\u4e0a\u3067\u69cb\u7bc9\u3057\u307e\u3059\u3002\n$ apt-get install mosquitto-clients\n\n\naction-1\u3067MQTT subscribe\naction-1\u306euuid\u3092\u4f7f\u3044\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u9001\u4fe1\u3057\u307e\u3059\u3002\u300cIDCF\u300d\u30c1\u30e3\u30f3\u30cd\u30eb\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u305f\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u79fb\u52d5\u3057\u3066\u3001\u30b3\u30de\u30f3\u30c9\u30e9\u30a4\u30f3\u30c4\u30fc\u30eb\u304b\u3089token\u3068uuid\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\n$ cd ~/iot_apps/meshblu-compose\n$ docker-compose run --rm iotutil show -- -k action-1\n\n> iotutil@0.0.1 start /app\n> node app.js \"show\" \"-k\" \"action-1\"\n\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 keyword  \u2502 token    \u2502 uuid                                 \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 action-1 \u2502 8a83d71f \u2502 b61d3398-ac99-4694-9dc4-dd632faf6f6a \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n\naction-1\u304b\u3089MQTT\u306e\u30e1\u30c3\u30bb\u30fc\u30b8\u3092subscribe\u3057\u307e\u3059\u3002Meshblu\u3067\u306fsubscribe\u3059\u308b\u30c8\u30d4\u30c3\u30af\u540d\u306f\u3001\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u53d7\u4fe1\u3059\u308b\u30c7\u30d0\u30a4\u30b9\u306euuid\u306b\u306a\u308a\u307e\u3059\u3002\u3053\u306e\u4f8b\u3067\u306faction-1\u306euuid\u306b\u306a\u308a\u307e\u3059\u3002\u307e\u305fusername\u3068password\u3082\u5fc5\u9808\u9805\u76ee\u3067\u3059\u3002\u305d\u308c\u305e\u308c\u30c7\u30d0\u30a4\u30b9\u306euuid\u3068token\u3092\u6307\u5b9a\u3057\u307e\u3059\u3002\n\n\u30db\u30b9\u30c8: \u300cIDCF\u300d\u30c1\u30e3\u30f3\u30cd\u30eb\u306eIP\u30a2\u30c9\u30ec\u30b9\n\u30dd\u30fc\u30c8: 1883\n\n\u30c8\u30d4\u30c3\u30af: action-1\u306euuid\n\nusername: action-1\u306euuid\npassword: action-1\u306etoken\n\n$ mosquitto_sub \\\n    -h 210.140.162.58  \\\n    -p 1883  \\\n    -t b61d3398-ac99-4694-9dc4-dd632faf6f6a  \\\n    -u b61d3398-ac99-4694-9dc4-dd632faf6f6a  \\\n    -P 8a83d71f \\\n    -d\n\n\u51fa\u529b\u7d50\u679c\nReceived CONNACK\nReceived SUBACK\nSubscribed (mid: 1): 0\n\n\u4e0a\u8a18\u306e\u3068\u304a\u308a\u51fa\u529b\u3055\u308c\u3001\u8a72\u5f53\u306e\u30e1\u30c3\u30bb\u30fc\u30b8\u304cpublish\u3055\u308c\u308b\u306e\u3092\u5f85\u3064\u72b6\u614b\u306b\u306a\u308a\u307e\u3059\u3002\n\u4f5c\u696d\u3092\u7d9a\u3051\u308b\u305f\u3081\u3001\u65b0\u3057\u3044\u30b7\u30a7\u30eb\u3092\u958b\u304d\u307e\u3059\u3002\n\ntrigger-1\u304b\u3089MQTT publish message\ntrigger-1\u306euuid\u3092\u4f7f\u3044\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u9001\u4fe1\u3057\u307e\u3059\u3002token\u3068uuid\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\n$ docker-compose run --rm iotutil show -- -k trigger-1\n\n> iotutil@0.0.1 start /app\n> node app.js \"show\" \"-k\" \"trigger-1\"\n\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 keyword   \u2502 token    \u2502 uuid                                 \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 trigger-1 \u2502 d286ba8d \u2502 ffa6934d-f1b3-467f-98b3-766b330d436d \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n\nMeshblu\u306b\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u9001\u4fe1\u3059\u308b\u5834\u5408\u306f\u4ee5\u4e0b\u306e\u4ed5\u69d8\u306b\u306a\u308a\u307e\u3059\u3002\n\n\n\u30c8\u30d4\u30c3\u30af\u540d: message\n\n\u9001\u4fe1\u5148uuid: \u30e1\u30c3\u30bb\u30fc\u30b8\u306edevices\u30ad\u30fc\u306e\u5024\n\u30e1\u30c3\u30bb\u30fc\u30b8\u672c\u6587: \u30e1\u30c3\u30bb\u30fc\u30b8\u306epayload\u30ad\u30fc\u306e\u5024(JSON\u3001\u6587\u5b57\u5217)\n\nmosquitto_pub\u30b3\u30de\u30f3\u30c9\u3092\u4f7f\u3063\u3066publish\u3057\u307e\u3059\u3002\n$ mosquitto_pub \\\n  -h 210.140.162.58  \\\n  -p 1883 \\\n  -t message \\\n  -m '{\"devices\": [\"b61d3398-ac99-4694-9dc4-dd632faf6f6a\"], \"payload\": {\"led\":\"on\"}}' \\\n  -u ffa6934d-f1b3-467f-98b3-766b330d436d \\\n  -P d286ba8d \\\n  -d\n\n\u51fa\u529b\u7d50\u679c\nReceived CONNACK\nSending PUBLISH (d0, q0, r0, m1, 'message', ... (78 bytes))\n\nmosquitto_sub\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3057\u3066\u3044\u308b\u3082\u3046\u4e00\u3064\u306e\u30b7\u30a7\u30eb\u306b\u30e1\u30c3\u30bb\u30fc\u30b8\u304c\u5c4a\u304d\u307e\u3059\u3002\n{\"data\":{\"led\":\"on\"}}\n\n\ntrigger-1\u304b\u3089HTTP POST /messages\nMQTT subscriber\u306bHTTP POST\u304b\u3089\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u9001\u4fe1\u3059\u308b\u3053\u3068\u3082\u3067\u304d\u307e\u3059\u3002trigger-1\u306euuid\u3068token\u306f\u8a8d\u8a3c\u60c5\u5831\u3068\u3057\u3066HTTP\u30d8\u30c3\u30c0\u306b\u8a18\u8ff0\u3057\u307e\u3059\u3002\n\nURL: /messages\nContent-Type: application/json\nmeshblu_auth_uuid: trigger-1\u306euuid\nmeshblu_auth_token: trigger-1\u306etoken\n\n\u5148\u307b\u3069\u306emosquitto_sub\u30b3\u30de\u30f3\u30c9\u304c\u8d77\u52d5\u3057\u3066\u3044\u308b\u72b6\u614b\u3067\u65b0\u3057\u3044\u30b7\u30a7\u30eb\u3092\u958b\u304d\u307e\u3059\u3002curl\u3067\u30e1\u30c3\u30bb\u30fc\u30b8\u3092POST\u3057\u307e\u3059\u3002\n$ curl -X POST \\\n  http://210.140.162.58/messages \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\"devices\": \"4dbe71d3-ad32-45e5-99fc-88c225bf11b8\", \"payload\": {\"led\":\"off\"}}' \\\n  --header \"meshblu_auth_uuid: ffa6934d-f1b3-467f-98b3-766b330d436d\"  \\\n  --header \"meshblu_auth_token: d286ba8d\"\n\n\u51fa\u529b\u7d50\u679c\n{\"devices\":\"4dbe71d3-ad32-45e5-99fc-88c225bf11b8\",\"payload\":{\"led\":\"off\"}}\n\nmosquitto_sub\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3057\u3066\u3044\u308b\u30b7\u30a7\u30eb\u306b\u30e1\u30c3\u30bb\u30fc\u30b8\u304c\u5c4a\u304d\u307e\u3059\u3002\n{\"data\":{\"led\":\"on\"}}\n\n\n[Mesublu](http://meshblu.octoblu.com/)\u306f\u8907\u6570\u306e\u30c8\u30e9\u30f3\u30dd\u30fc\u30c8\u30d7\u30ed\u30c8\u30b3\u30eb\u306b\u5bfe\u5fdc\u3057\u3066\u3044\u307e\u3059\u3002HTTP POST\u3057\u305f\u30e1\u30c3\u30bb\u30fc\u30b8\u3092MQTT\u3067subscribe\u3057\u3066\u53d7\u4fe1\u3059\u308b\u3053\u3068\u3082\u3067\u304d\u307e\u3059\u3002[\u201dPart2: IDCF\u30af\u30e9\u30a6\u30c9\u306b\u300cIDCF\u300d\u30c1\u30e3\u30f3\u30cd\u30eb\u3092\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\u3059\u308b\u201d\u3067\u69cb\u7bc9\u3057\u305f\u30b5\u30fc\u30d0](http://qiita.com/masato/items/f9be4a15216fe29de7fb)\u3092\u30d6\u30ed\u30fc\u30ab\u30fc\u3068\u3057\u3066\u3001\u30e1\u30c3\u30bb\u30fc\u30b8\u30f3\u30b0\u3068\u30c7\u30fc\u30bf\u4fdd\u5b58\u306e\u30c6\u30b9\u30c8\u3092\u3057\u3066\u307f\u307e\u3059\u3002\n\n## MQTT\u30d6\u30ed\u30fc\u30ab\u30fc\u3092\u4f7f\u3063\u305f\u30e1\u30c3\u30bb\u30fc\u30b8\u30f3\u30b0\n\nMQTT\u306e\u57fa\u672c\u7684\u306a\u30e1\u30c3\u30bb\u30fc\u30b8\u30f3\u30b0\u3092\u30c6\u30b9\u30c8\u3057\u307e\u3059\u3002trigger-1\u3068action-1\u306euuid\u3092\u4f7f\u3044\u307e\u3059\u3002\n\n* \u30e1\u30c3\u30bb\u30fc\u30b8\u9001\u4fe1: trigger-1\n* \u30e1\u30c3\u30bb\u30fc\u30b8\u53d7\u4fe1: action-1\n\n![\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2015-09-09 14.15.21.png](https://qiita-image-store.s3.amazonaws.com/0/51786/dab02194-8d40-c084-59a0-daff0c316063.png)\n\nMQTT\u3092publish,subscribe\u3059\u308b\u305f\u3081\u306eclient\u3068\u3057\u3066\u3001mosquitto-clients\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u305f\u30db\u30b9\u30c8\u3092\u6e96\u5099\u3057\u3001[MQTT\u30d6\u30ed\u30fc\u30ab\u30fc](http://qiita.com/masato/items/f9be4a15216fe29de7fb)\u3068\u901a\u4fe1\u3055\u305b\u307e\u3059\u3002\n\n### MQTT\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\nMQTT\u3067\u306e\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u9001\u4fe1\uff08publish\uff09,\u53d7\u4fe1(subscribe)\u3092\u3059\u308b\u305f\u3081\u306b\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u3068\u3057\u3066\u3001mosquitto-clients\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\u4eca\u56de\u306f\u4fbf\u5b9c\u4e0a\u3001\u9001\u53d7\u4fe1\u306e\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u3068\u30d6\u30ed\u30fc\u30ab\u30fc\u3092\u540c\u3058\u30db\u30b9\u30c8\u4e0a\u3067\u69cb\u7bc9\u3057\u307e\u3059\u3002\n\n```bash\n$ apt-get install mosquitto-clients\n```\n\n### action-1\u3067MQTT subscribe\n\naction-1\u306euuid\u3092\u4f7f\u3044\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u9001\u4fe1\u3057\u307e\u3059\u3002\u300cIDCF\u300d\u30c1\u30e3\u30f3\u30cd\u30eb\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u305f\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u79fb\u52d5\u3057\u3066\u3001\u30b3\u30de\u30f3\u30c9\u30e9\u30a4\u30f3\u30c4\u30fc\u30eb\u304b\u3089token\u3068uuid\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\n\n```bash\n$ cd ~/iot_apps/meshblu-compose\n$ docker-compose run --rm iotutil show -- -k action-1\n\n> iotutil@0.0.1 start /app\n> node app.js \"show\" \"-k\" \"action-1\"\n\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 keyword  \u2502 token    \u2502 uuid                                 \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 action-1 \u2502 8a83d71f \u2502 b61d3398-ac99-4694-9dc4-dd632faf6f6a \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n```\n\naction-1\u304b\u3089MQTT\u306e\u30e1\u30c3\u30bb\u30fc\u30b8\u3092subscribe\u3057\u307e\u3059\u3002[Meshblu](http://meshblu.octoblu.com/)\u3067\u306fsubscribe\u3059\u308b\u30c8\u30d4\u30c3\u30af\u540d\u306f\u3001\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u53d7\u4fe1\u3059\u308b\u30c7\u30d0\u30a4\u30b9\u306euuid\u306b\u306a\u308a\u307e\u3059\u3002\u3053\u306e\u4f8b\u3067\u306faction-1\u306euuid\u306b\u306a\u308a\u307e\u3059\u3002\u307e\u305fusername\u3068password\u3082\u5fc5\u9808\u9805\u76ee\u3067\u3059\u3002\u305d\u308c\u305e\u308c\u30c7\u30d0\u30a4\u30b9\u306euuid\u3068token\u3092\u6307\u5b9a\u3057\u307e\u3059\u3002\n\n\n\n* \u30db\u30b9\u30c8: \u300cIDCF\u300d\u30c1\u30e3\u30f3\u30cd\u30eb\u306eIP\u30a2\u30c9\u30ec\u30b9\n* \u30dd\u30fc\u30c8: 1883\n* \n**\u30c8\u30d4\u30c3\u30af: action-1\u306euuid**\n* username: action-1\u306euuid\n* password: action-1\u306etoken\n\n\n```bash\n$ mosquitto_sub \\\n    -h 210.140.162.58  \\\n    -p 1883  \\\n    -t b61d3398-ac99-4694-9dc4-dd632faf6f6a  \\\n    -u b61d3398-ac99-4694-9dc4-dd632faf6f6a  \\\n    -P 8a83d71f \\\n    -d\n```\n\n\u51fa\u529b\u7d50\u679c\n\n```bash\nReceived CONNACK\nReceived SUBACK\nSubscribed (mid: 1): 0\n```\n\n\u4e0a\u8a18\u306e\u3068\u304a\u308a\u51fa\u529b\u3055\u308c\u3001\u8a72\u5f53\u306e\u30e1\u30c3\u30bb\u30fc\u30b8\u304cpublish\u3055\u308c\u308b\u306e\u3092\u5f85\u3064\u72b6\u614b\u306b\u306a\u308a\u307e\u3059\u3002\n\u4f5c\u696d\u3092\u7d9a\u3051\u308b\u305f\u3081\u3001**\u65b0\u3057\u3044\u30b7\u30a7\u30eb**\u3092\u958b\u304d\u307e\u3059\u3002\n\n\n### trigger-1\u304b\u3089MQTT publish message\n\ntrigger-1\u306euuid\u3092\u4f7f\u3044\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u9001\u4fe1\u3057\u307e\u3059\u3002token\u3068uuid\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\n\n```bash\n$ docker-compose run --rm iotutil show -- -k trigger-1\n\n> iotutil@0.0.1 start /app\n> node app.js \"show\" \"-k\" \"trigger-1\"\n\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 keyword   \u2502 token    \u2502 uuid                                 \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 trigger-1 \u2502 d286ba8d \u2502 ffa6934d-f1b3-467f-98b3-766b330d436d \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n```\n\nMeshblu\u306b\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u9001\u4fe1\u3059\u308b\u5834\u5408\u306f\u4ee5\u4e0b\u306e\u4ed5\u69d8\u306b\u306a\u308a\u307e\u3059\u3002\n\n* \n**\u30c8\u30d4\u30c3\u30af\u540d: message**\n* \u9001\u4fe1\u5148uuid: \u30e1\u30c3\u30bb\u30fc\u30b8\u306edevices\u30ad\u30fc\u306e\u5024\n* \u30e1\u30c3\u30bb\u30fc\u30b8\u672c\u6587: \u30e1\u30c3\u30bb\u30fc\u30b8\u306epayload\u30ad\u30fc\u306e\u5024(JSON\u3001\u6587\u5b57\u5217)\n\nmosquitto_pub\u30b3\u30de\u30f3\u30c9\u3092\u4f7f\u3063\u3066publish\u3057\u307e\u3059\u3002\n\n```bash\n$ mosquitto_pub \\\n  -h 210.140.162.58  \\\n  -p 1883 \\\n  -t message \\\n  -m '{\"devices\": [\"b61d3398-ac99-4694-9dc4-dd632faf6f6a\"], \"payload\": {\"led\":\"on\"}}' \\\n  -u ffa6934d-f1b3-467f-98b3-766b330d436d \\\n  -P d286ba8d \\\n  -d\n```\n\n\u51fa\u529b\u7d50\u679c\n\n```bash\nReceived CONNACK\nSending PUBLISH (d0, q0, r0, m1, 'message', ... (78 bytes))\n```\n\nmosquitto_sub\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3057\u3066\u3044\u308b\u3082\u3046\u4e00\u3064\u306e\u30b7\u30a7\u30eb\u306b\u30e1\u30c3\u30bb\u30fc\u30b8\u304c\u5c4a\u304d\u307e\u3059\u3002\n\n```bash\n{\"data\":{\"led\":\"on\"}}\n```\n\n### trigger-1\u304b\u3089HTTP POST /messages\n\nMQTT subscriber\u306bHTTP POST\u304b\u3089\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u9001\u4fe1\u3059\u308b\u3053\u3068\u3082\u3067\u304d\u307e\u3059\u3002trigger-1\u306euuid\u3068token\u306f\u8a8d\u8a3c\u60c5\u5831\u3068\u3057\u3066HTTP\u30d8\u30c3\u30c0\u306b\u8a18\u8ff0\u3057\u307e\u3059\u3002\n\n* URL: /messages\n* Content-Type: application/json\n* meshblu_auth_uuid: trigger-1\u306euuid\n* meshblu_auth_token: trigger-1\u306etoken\n\n\u5148\u307b\u3069\u306emosquitto_sub\u30b3\u30de\u30f3\u30c9\u304c\u8d77\u52d5\u3057\u3066\u3044\u308b\u72b6\u614b\u3067\u65b0\u3057\u3044\u30b7\u30a7\u30eb\u3092\u958b\u304d\u307e\u3059\u3002curl\u3067\u30e1\u30c3\u30bb\u30fc\u30b8\u3092POST\u3057\u307e\u3059\u3002\n\n```bash\n$ curl -X POST \\\n  http://210.140.162.58/messages \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\"devices\": \"4dbe71d3-ad32-45e5-99fc-88c225bf11b8\", \"payload\": {\"led\":\"off\"}}' \\\n  --header \"meshblu_auth_uuid: ffa6934d-f1b3-467f-98b3-766b330d436d\"  \\\n  --header \"meshblu_auth_token: d286ba8d\"\n```\n\n\u51fa\u529b\u7d50\u679c\n\n```bash\n{\"devices\":\"4dbe71d3-ad32-45e5-99fc-88c225bf11b8\",\"payload\":{\"led\":\"off\"}}\n```\n\nmosquitto_sub\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3057\u3066\u3044\u308b\u30b7\u30a7\u30eb\u306b\u30e1\u30c3\u30bb\u30fc\u30b8\u304c\u5c4a\u304d\u307e\u3059\u3002\n\n```bash\n{\"data\":{\"led\":\"on\"}}\n```\n"}