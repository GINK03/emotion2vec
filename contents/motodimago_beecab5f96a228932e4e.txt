{"tags": ["SQLite3", "Android"], "context": " More than 1 year has passed since last update.\u30c1\u30e3\u30aa\uff01\nSQLite\u306bMap\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u7a81\u3063\u8fbc\u307f\u305f\u3044\u5834\u5408\u3063\u3066\u3042\u308b\u3042\u308b\u3067\u3059\u3088\u306d\uff01\n\nMap\u3092SQLite\u306b\u4fdd\u5b58\n\u305d\u3046\u3044\u3046\u5834\u5408\u306f\n\nMap \u2192 JSONObject \u2192 String\n\u3067\u4fdd\u5b58\u3057\u3066\n\nString \u2192 JSONObject \u2192 Map\n\u3067\u8aad\u307f\u8fbc\u3080\u306e\u304c\u304a\u3059\u3059\u3081\uff01\n\nMap\u304b\u3089String\u306b\nMap\u304b\u3089String\u306f\u8d85\u7c21\u5358\u266a\npublic String mapToJsonString(Map data) {\n    if (data == null) {\n        return null;\n    }\n    return new JSONObject(data).toString();\n}\n\n\nString\u304b\u3089Map\u306b\nString\u304b\u3089Map\u306f\u3061\u3087\u3063\u3068\u9762\u5012\npublic Map jsonStringToMap(String data) {\n    if (data == null) {\n        return null;\n    }\n    try {\n        JSONObject json = new JSONObject(data);\n        Iterator<Object> keys = json.keys();\n        Map<String, Object> params = new HashMap<String, Object>();\n        while (keys.hasNext()) {\n            String key = keys.next().toString();\n            String val = json.getString(key);\n            params.put(key, val);\n        }\n\n        return params;\n    } catch (JSONException e) {\n        return null;\n    }\n\n    return null;\n}\n\n\u3053\u308c\u3067\u3082\u3082\u3046Map\u3092\u4fdd\u5b58\u3057\u653e\u984c\u3060\u306d\uff01\n\nActiveAndroid\u3092\u4f7f\u3046\u5834\u5408\n\u30ca\u30a6\u306a\u30e4\u30f3\u30b0\u306fandroid\u3067sqlite\u3092\u4f7f\u3046\u5834\u5408ORM\u3092\u4f7f\u3063\u3066\u3044\u308b\u3068\u601d\u3046\u3051\u3069\u3001\n\u304a\u3059\u3059\u3081\u306fActiveAndroid\uff01\n\n\u52dd\u624b\u306b\u3067\u304d\u308bId\u304c\u5fae\u5999\n\u8907\u6570\u306exxx.db\u306f\u4f7f\u3048\u306a\u3044\uff08\uff1f\uff09\n\n\u3068\u304b\u8272\u3005\u30a2\u30ec\u306a\u6240\u3082\u3042\u308b\u3051\u3069\u3001\u305d\u308c\u3092\u4e0a\u56de\u308b\u9b45\u529b\u304c\uff01\n\u3067\u3001ActivieAndroid\u3067Map\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u4fdd\u5b58\u3059\u308b\u306b\u306f\n\n\u72ec\u81eaTypeSerializer\u3092\u7528\u610f\u3059\u308b\nAndroidManifest.xml\u306b\u4e00\u884c\u8ffd\u52a0\n\n\u306e2\u30b9\u30c6\u30c3\u30d7\u3060\u3051\u3067\u4fdd\u5b58\u3057\u653e\u984c\uff01\n\n1.\u72ec\u81eaTypeSerializer\u3092\u7528\u610f\u3059\u308b\n\u597d\u304d\u306a\u6240\u306bTypeSerializer\u3092\u7d99\u627f\u3057\u305fMapSerializer.java\u3092\u4fdd\u5b58\n\nMapSerializer.java\npackage com.mypackage;\n\nimport com.activeandroid.serializer.TypeSerializer;\n\nimport org.json.JSONException;\nimport org.json.JSONObject;\n\nimport java.util.HashMap;\nimport java.util.Iterator;\nimport java.util.Map;\n\npublic class MapSerializer extends TypeSerializer {\n\n    @Override\n    public Class<?> getDeserializedType() {\n        return Map.class;\n    }\n\n    @Override\n    public Class<?> getSerializedType() {\n        return String.class;\n    }\n\n    @Override\n    public String serialize(Object data) {\n        if (data == null) {\n            return null;\n        }\n        return new JSONObject((Map)data).toString();\n    }\n\n    @Override\n    public Map deserialize(Object data) {\n        if (data == null) {\n            return null;\n        }\n        try {\n            JSONObject json = new JSONObject((String) data);\n            Iterator<Object> keys = json.keys();\n            Map<String, Object> params = new HashMap<String, Object>();\n            while (keys.hasNext()) {\n                String key = keys.next().toString();\n                String val = json.getString(key);\n                params.put(key, val);\n            }\n\n            return params;\n        } catch (JSONException e) {\n            e.printStackTrace();\n        }\n\n        return null;\n    }\n}\n\n\n\n2.AndroidManifest.xml\u306b\u4e00\u884c\u8ffd\u52a0\nAndroidManifest.xml\u306b\u4e0b\u8a18\u3092\u8ffd\u8a18\u3059\u308b\u308c\u3070\u6e96\u5099\u5b8c\u4e86\uff01\n\nAndroidManifest.xml\n<meta-data android:name=\"AA_SERIALIZERS\" android:value=\"com.mypackage.MapSerializer\" />\n\n\n\u4f8b\u3048\u3070\u66f4\u306bDate\u3092\u4fdd\u5b58\u3059\u308b\u305f\u3081\u306eDateSerializer\u3092\u8ffd\u52a0\u3057\u305f\u5834\u5408\u306f\n\nAndroidManifest.xml\n<meta-data android:name=\"AA_SERIALIZERS\" android:value=\"com.mypackage.Dateerializer,com.mypackage.MapSerializer\" />\n\n\n\u3063\u3066\u611f\u3058\u3067\u8ffd\u52a0\u3059\u308c\u3070\u3044\u3044\u611f\u3058\u3002\n\n\u4f7f\u3063\u3066\u307f\u308b\n\u3042\u3068\u306f\u30e2\u30c7\u30eb\u3067\u666e\u901a\u306bMap\u3092\u6307\u5b9a\u3057\u3066\u304a\u3051\u3070OKOK\uff01\n@Table(name = \"myTable\")\npublic class MyTable extends Model {\n\n    @Column(name = \"data\")\n    public Map data;\n}\n\n\n\u30c1\u30e3\u30aa\uff01\nSQLite\u306bMap\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u7a81\u3063\u8fbc\u307f\u305f\u3044\u5834\u5408\u3063\u3066\u3042\u308b\u3042\u308b\u3067\u3059\u3088\u306d\uff01\n\n# Map\u3092SQLite\u306b\u4fdd\u5b58\n\n\u305d\u3046\u3044\u3046\u5834\u5408\u306f\n##### Map \u2192 JSONObject \u2192 String\n\u3067\u4fdd\u5b58\u3057\u3066\n\n##### String \u2192 JSONObject \u2192 Map\n\u3067\u8aad\u307f\u8fbc\u3080\u306e\u304c\u304a\u3059\u3059\u3081\uff01\n\n## Map\u304b\u3089String\u306b\n\nMap\u304b\u3089String\u306f\u8d85\u7c21\u5358\u266a\n\n```Java:\npublic String mapToJsonString(Map data) {\n\tif (data == null) {\n\t\treturn null;\n\t}\n\treturn new JSONObject(data).toString();\n}\n```\n\n## String\u304b\u3089Map\u306b\n\nString\u304b\u3089Map\u306f\u3061\u3087\u3063\u3068\u9762\u5012\n\n```Java:\npublic Map jsonStringToMap(String data) {\n\tif (data == null) {\n\t\treturn null;\n\t}\n\ttry {\n\t\tJSONObject json = new JSONObject(data);\n\t\tIterator<Object> keys = json.keys();\n\t\tMap<String, Object> params = new HashMap<String, Object>();\n\t\twhile (keys.hasNext()) {\n\t\t\tString key = keys.next().toString();\n\t\t\tString val = json.getString(key);\n\t\t\tparams.put(key, val);\n\t\t}\n\n\t\treturn params;\n\t} catch (JSONException e) {\n\t\treturn null;\n\t}\n\n\treturn null;\n}\n```\n\n\u3053\u308c\u3067\u3082\u3082\u3046Map\u3092\u4fdd\u5b58\u3057\u653e\u984c\u3060\u306d\uff01\n\n\n# ActiveAndroid\u3092\u4f7f\u3046\u5834\u5408\n\n\u30ca\u30a6\u306a\u30e4\u30f3\u30b0\u306fandroid\u3067sqlite\u3092\u4f7f\u3046\u5834\u5408ORM\u3092\u4f7f\u3063\u3066\u3044\u308b\u3068\u601d\u3046\u3051\u3069\u3001\n\u304a\u3059\u3059\u3081\u306f[ActiveAndroid](http://www.activeandroid.com/)\uff01\n\n* \u52dd\u624b\u306b\u3067\u304d\u308bId\u304c\u5fae\u5999\n* \u8907\u6570\u306exxx.db\u306f\u4f7f\u3048\u306a\u3044\uff08\uff1f\uff09\n\n\u3068\u304b\u8272\u3005\u30a2\u30ec\u306a\u6240\u3082\u3042\u308b\u3051\u3069\u3001\u305d\u308c\u3092\u4e0a\u56de\u308b\u9b45\u529b\u304c\uff01\n\n\u3067\u3001ActivieAndroid\u3067Map\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u4fdd\u5b58\u3059\u308b\u306b\u306f\n\n1. \u72ec\u81eaTypeSerializer\u3092\u7528\u610f\u3059\u308b\n* AndroidManifest.xml\u306b\u4e00\u884c\u8ffd\u52a0\n\n\u306e2\u30b9\u30c6\u30c3\u30d7\u3060\u3051\u3067\u4fdd\u5b58\u3057\u653e\u984c\uff01\n\n### 1.\u72ec\u81eaTypeSerializer\u3092\u7528\u610f\u3059\u308b\n\n\u597d\u304d\u306a\u6240\u306bTypeSerializer\u3092\u7d99\u627f\u3057\u305fMapSerializer.java\u3092\u4fdd\u5b58\n\n```Java:MapSerializer.java\npackage com.mypackage;\n\nimport com.activeandroid.serializer.TypeSerializer;\n\nimport org.json.JSONException;\nimport org.json.JSONObject;\n\nimport java.util.HashMap;\nimport java.util.Iterator;\nimport java.util.Map;\n\npublic class MapSerializer extends TypeSerializer {\n\n    @Override\n    public Class<?> getDeserializedType() {\n        return Map.class;\n    }\n\n    @Override\n    public Class<?> getSerializedType() {\n        return String.class;\n    }\n\n    @Override\n    public String serialize(Object data) {\n        if (data == null) {\n            return null;\n        }\n        return new JSONObject((Map)data).toString();\n    }\n\n    @Override\n    public Map deserialize(Object data) {\n        if (data == null) {\n            return null;\n        }\n        try {\n            JSONObject json = new JSONObject((String) data);\n            Iterator<Object> keys = json.keys();\n            Map<String, Object> params = new HashMap<String, Object>();\n            while (keys.hasNext()) {\n                String key = keys.next().toString();\n                String val = json.getString(key);\n                params.put(key, val);\n            }\n\n            return params;\n        } catch (JSONException e) {\n            e.printStackTrace();\n        }\n\n        return null;\n    }\n}\n```\n\n### 2.AndroidManifest.xml\u306b\u4e00\u884c\u8ffd\u52a0\n\nAndroidManifest.xml\u306b\u4e0b\u8a18\u3092\u8ffd\u8a18\u3059\u308b\u308c\u3070\u6e96\u5099\u5b8c\u4e86\uff01\n\n```xml:AndroidManifest.xml\n<meta-data android:name=\"AA_SERIALIZERS\" android:value=\"com.mypackage.MapSerializer\" />\n```\n\n\u4f8b\u3048\u3070\u66f4\u306bDate\u3092\u4fdd\u5b58\u3059\u308b\u305f\u3081\u306eDateSerializer\u3092\u8ffd\u52a0\u3057\u305f\u5834\u5408\u306f\n\n```xml:AndroidManifest.xml\n<meta-data android:name=\"AA_SERIALIZERS\" android:value=\"com.mypackage.Dateerializer,com.mypackage.MapSerializer\" />\n```\n\n\u3063\u3066\u611f\u3058\u3067\u8ffd\u52a0\u3059\u308c\u3070\u3044\u3044\u611f\u3058\u3002\n\n### \u4f7f\u3063\u3066\u307f\u308b\n\n\u3042\u3068\u306f\u30e2\u30c7\u30eb\u3067\u666e\u901a\u306bMap\u3092\u6307\u5b9a\u3057\u3066\u304a\u3051\u3070OKOK\uff01\n\n```Java:\n@Table(name = \"myTable\")\npublic class MyTable extends Model {\n\n    @Column(name = \"data\")\n    public Map data;\n}\n```\n\n"}