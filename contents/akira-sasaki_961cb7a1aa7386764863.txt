{"context": "\n\n\u4e8b\u524d\u6e96\u5099\nAWS API Gateway\u3068AWS Lambda\u3067\u3001HelloWorld\u3092\u4f5c\u6210\u3059\u308b\nhttp://qiita.com/akira-sasaki/items/b9e8e8a0330818e3b71d\n\nFacebook\u30a2\u30d7\u30ea\u306e\u4f5c\u6210\nhttps://developers.facebook.com/quickstarts/?platform=web\n\n\n\n\nReload\u3092\u62bc\u3059\u3002\n\n\n\nFacebook Page\u306e\u4f5c\u6210\nhttps://www.facebook.com/pages/create/\n\n\n\n\n\n\n\nAWS Lamdba\u306e\u4f5c\u6210\n\n\n\u30e1\u30c3\u30bb\u30fc\u30b8\u53d7\u4fe1\u7528\u306eScript\n\nFacebookBotCallback\nexports.handler = function(event, context) {\n    console.log('Received event:', JSON.stringify(event, null, 2));\n}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nCloud Watch\u3067\u30ed\u30b0\u3092\u30c1\u30a7\u30c3\u30af\n\n\n\n\n\n\n\nValidation\u7528\u306eScript\n\nFacebookBotValidation\nvar validationToken = \"ValidationToken\";\n\nexports.handler = function(event, context) {\n    console.log('Received event:', JSON.stringify(event, null, 2));\n\n    if (!event[\"hub.verify_token\"] || !event[\"hub.challenge\"]) {\n        context.fail(\"invalid parameter\");\n        return;\n    }\n\n    if (event[\"hub.verify_token\"] === validationToken) {\n        context.done(null, Number(event[\"hub.challenge\"]));\n    } else {\n        context.fail(\"validation failed\");\n    }\n};\n\n\n\n\n\n\n\n\n\nAWS API Gateway\n\n\n\n\n\u53d7\u4fe1\u7528\u306ePOST\u30e1\u30bd\u30c3\u30c9\u3092\u4f5c\u6210\n\n\n\n\nCurl\u3067\u547c\u3073\u51fa\u3057\u3066\u307f\u308b\u3002\ncurl -v -H \"Accept: application/json\" -H \"Content-type: application/json\" -X POd '{\"key1\":\"test1\",\"key2\":\"test2\",\"key3\":\"test3\"}' https://#####.execute-api.ap-northeast-1.amazonaws.com/botcallback/botcallback\n\nCloud Watch\u3067\u30ed\u30b0\u78ba\u8a8d\n\n\n\n\n\n\nValidation\u7528\u306eGET\u30e1\u30bd\u30c3\u30c9\u3092\u4f5c\u6210\n\n\n\n\n\n\n\n\n\nhub.challenge\n\nhub.verify_token\n\n\u3092\u8ffd\u52a0\u3002\n\n\n\n\n\napplication/json\n{\n  \"hub.verify_token\": \"$input.params('hub.verify_token')\",\n  \"hub.challenge\": \"$input.params('hub.challenge')\"\n}\n\n\n\nFacebook\u3068AWS API Gateway\u3092\u9023\u643a\n\n\n\n\ncurl -ik -X POST \"https://graph.facebook.com/v2.6/me/subscribed_apps?access_token=\u30c8\u30fc\u30af\u30f3\"\n\n\u3092\u30b3\u30de\u30f3\u30c9\u30e9\u30a4\u30f3\u3067\u5b9f\u884c\u3002\n\n\n\n\n\u4f5c\u6210\u3057\u305f\u30da\u30fc\u30b8\u3067\u30e1\u30c3\u30bb\u30fc\u30b8\u66f8\u304d\u8fbc\u307f\n\u4f5c\u6210\u3057\u305f\u30da\u30fc\u30b8\u306e\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u66f8\u304d\u8fbc\u3080\n\nCloud Watch\u3067\u30ed\u30b0\u78ba\u8a8d\n\n\n\n\n\u30e1\u30c3\u30bb\u30fc\u30b8\u304c\u30ed\u30b0\u306b\u3067\u305f\u3089\u6210\u529f!\n\n\u304a\u3046\u3080\u8fd4\u3057Bot\u306e\u30d7\u30ed\u30b0\u30e9\u30e0\u4f5c\u6210\u3000\nhttp://qiita.com/akira-sasaki/items/cbb667653579db9743ec\n\n# \u4e8b\u524d\u6e96\u5099\n\nAWS API Gateway\u3068AWS Lambda\u3067\u3001HelloWorld\u3092\u4f5c\u6210\u3059\u308b\nhttp://qiita.com/akira-sasaki/items/b9e8e8a0330818e3b71d\n\n# Facebook\u30a2\u30d7\u30ea\u306e\u4f5c\u6210\n\nhttps://developers.facebook.com/quickstarts/?platform=web\n\n![bot001.png](https://qiita-image-store.s3.amazonaws.com/0/63450/1bcfc80b-c0dc-4eb3-00f8-3cc002e6fa13.png)\n\n![bot002.png](https://qiita-image-store.s3.amazonaws.com/0/63450/6ff9c666-5818-bb08-e792-c321aa3ddc78.png)\n\n![bot003.png](https://qiita-image-store.s3.amazonaws.com/0/63450/3ed9a98b-b9ba-3572-0b6b-55048afe55d7.png)\n\n![bot004.png](https://qiita-image-store.s3.amazonaws.com/0/63450/be9c11b5-a584-4b09-ab09-c2545ed09d2d.png)\n\nReload\u3092\u62bc\u3059\u3002\n\n![bot005.png](https://qiita-image-store.s3.amazonaws.com/0/63450/bbee401e-c110-9ab6-8805-d26e700d4f17.png)\n\n![bot007.png](https://qiita-image-store.s3.amazonaws.com/0/63450/3c6ca9f9-0835-be61-55d9-2b8c50f65c57.png)\n\n# Facebook Page\u306e\u4f5c\u6210\n\nhttps://www.facebook.com/pages/create/\n\n![page001.png](https://qiita-image-store.s3.amazonaws.com/0/63450/df6336a2-93a7-4960-66a6-03cb2b671c75.png)\n\n![page002.png](https://qiita-image-store.s3.amazonaws.com/0/63450/1a3ee4ce-f6c6-2e42-fcfc-c2068ef6db37.png)\n\n![page003.png](https://qiita-image-store.s3.amazonaws.com/0/63450/f1dd5874-7e8f-3ff5-323b-8eeacdd7d942.png)\n\n![page004.png](https://qiita-image-store.s3.amazonaws.com/0/63450/00191c8a-dd54-b0a3-bab7-faf5a6715848.png)\n\n![page005.png](https://qiita-image-store.s3.amazonaws.com/0/63450/b6ce505a-088d-874f-c8ee-3546c455266c.png)\n\n![page006.png](https://qiita-image-store.s3.amazonaws.com/0/63450/99749fda-1c6f-249b-ecfb-48c8d5be0815.png)\n\n# AWS Lamdba\u306e\u4f5c\u6210\n\n![lamdba001.png](https://qiita-image-store.s3.amazonaws.com/0/63450/87c33225-9dae-bb7e-8563-88819da461c6.png)\n\n## \u30e1\u30c3\u30bb\u30fc\u30b8\u53d7\u4fe1\u7528\u306eScript\n\n```js:FacebookBotCallback\nexports.handler = function(event, context) {\n    console.log('Received event:', JSON.stringify(event, null, 2));\n}\n```\n\n![lamdba002.png](https://qiita-image-store.s3.amazonaws.com/0/63450/b28a6be2-48fa-0e7d-5056-2ba402bfcb01.png)\n\n![lamdba003.png](https://qiita-image-store.s3.amazonaws.com/0/63450/01aa5f9c-591e-c3f7-976b-3cb82a2bf970.png)\n\n![lamdba004.png](https://qiita-image-store.s3.amazonaws.com/0/63450/b9e1851e-7b39-5851-941f-51268a730613.png)\n\n![lamdba005.png](https://qiita-image-store.s3.amazonaws.com/0/63450/f69c5968-84bf-2754-254b-479bfffef2e0.png)\n\n![lamdba006.png](https://qiita-image-store.s3.amazonaws.com/0/63450/44f41dc8-ab02-d778-4a99-9aa1e71757f0.png)\n\n![lamdba007.png](https://qiita-image-store.s3.amazonaws.com/0/63450/827d2fd3-f4ed-6b36-d64c-683cd4bfd718.png)\n\n![lamdba008.png](https://qiita-image-store.s3.amazonaws.com/0/63450/6da10334-7c5f-732a-e7ec-03433f253574.png)\n\n![lamdba009.png](https://qiita-image-store.s3.amazonaws.com/0/63450/35626eb4-0296-56af-714b-e016a5366327.png)\n\n![lamdba010.png](https://qiita-image-store.s3.amazonaws.com/0/63450/17570d76-cbb4-63c8-dbfa-d147514042d1.png)\n\n![lamdba011.png](https://qiita-image-store.s3.amazonaws.com/0/63450/20ccf98f-2183-6f01-4ca5-2f7995f31f55.png)\n\n![lamdba012.png](https://qiita-image-store.s3.amazonaws.com/0/63450/a4922af3-0750-931a-d68a-65a918e137bb.png)\n\n## Cloud Watch\u3067\u30ed\u30b0\u3092\u30c1\u30a7\u30c3\u30af\n\n![lamdba013.png](https://qiita-image-store.s3.amazonaws.com/0/63450/19aee76f-991c-274b-ec31-b5e9ec8fb86c.png)\n\n![watch001.png](https://qiita-image-store.s3.amazonaws.com/0/63450/954f5e6c-8824-795c-f3df-f182f10a5153.png)\n\n![watch002.png](https://qiita-image-store.s3.amazonaws.com/0/63450/ae28bc74-064a-37ba-9baf-e3fd820e39e7.png)\n\n![watch003.png](https://qiita-image-store.s3.amazonaws.com/0/63450/4caab358-54e7-4c3e-ad50-664bd27077ef.png)\n\n![watch004.png](https://qiita-image-store.s3.amazonaws.com/0/63450/9285822e-c727-a7d8-fb2b-6cf758191aec.png)\n\n![watch005.png](https://qiita-image-store.s3.amazonaws.com/0/63450/3c6e85a2-6fb6-7753-66e4-6e985bfa8ce9.png)\n\n## Validation\u7528\u306eScript\n\n```js:FacebookBotValidation\nvar validationToken = \"ValidationToken\";\n\nexports.handler = function(event, context) {\n    console.log('Received event:', JSON.stringify(event, null, 2));\n    \n    if (!event[\"hub.verify_token\"] || !event[\"hub.challenge\"]) {\n        context.fail(\"invalid parameter\");\n        return;\n    }\n\n    if (event[\"hub.verify_token\"] === validationToken) {\n        context.done(null, Number(event[\"hub.challenge\"]));\n    } else {\n        context.fail(\"validation failed\");\n    }\n};\n```\n\n![val001.png](https://qiita-image-store.s3.amazonaws.com/0/63450/484605f3-4933-fdfe-230f-2bacf5935661.png)\n\n![lamdba003.png](https://qiita-image-store.s3.amazonaws.com/0/63450/01aa5f9c-591e-c3f7-976b-3cb82a2bf970.png)\n\n![val002.png](https://qiita-image-store.s3.amazonaws.com/0/63450/db254a92-8a6a-4ad6-2e3f-cf038b1a4549.png)\n\n![val003.png](https://qiita-image-store.s3.amazonaws.com/0/63450/30dc074f-204d-2d20-b007-e4285d3be59d.png)\n\n![val004.png](https://qiita-image-store.s3.amazonaws.com/0/63450/5daa3632-1a41-14f9-6ce8-f25ef5f6c3f6.png)\n\n![val006.png](https://qiita-image-store.s3.amazonaws.com/0/63450/9a312205-32c6-9033-1deb-63b20e00c54d.png)\n\n\n# AWS API Gateway\n\n![api001.png](https://qiita-image-store.s3.amazonaws.com/0/63450/40c00c87-301f-5da0-bffd-bcae17604054.png)\n\n![api002.png](https://qiita-image-store.s3.amazonaws.com/0/63450/d69c80b4-dc54-22fb-ed7a-0c80fa5e1c02.png)\n\n![api101_1.png](https://qiita-image-store.s3.amazonaws.com/0/63450/665ca279-ae76-7923-81e0-0f2bea7e2e9a.png)\n\n## \u53d7\u4fe1\u7528\u306ePOST\u30e1\u30bd\u30c3\u30c9\u3092\u4f5c\u6210\n\n![api102_1.png](https://qiita-image-store.s3.amazonaws.com/0/63450/45be018e-3d08-37cd-5f0b-16bd68b3357f.png)\n\n![api103_1.png](https://qiita-image-store.s3.amazonaws.com/0/63450/75dfd53a-b246-021b-1b6a-d74266818f87.png)\n\n![api104_1.png](https://qiita-image-store.s3.amazonaws.com/0/63450/d9b2625d-35cf-4b46-f212-ae625f158a3f.png)\n\n![api105_1.png](https://qiita-image-store.s3.amazonaws.com/0/63450/49ddf205-1757-18bd-2811-84714ec84be1.png)\n\n\nCurl\u3067\u547c\u3073\u51fa\u3057\u3066\u307f\u308b\u3002\n\n```shell-session\ncurl -v -H \"Accept: application/json\" -H \"Content-type: application/json\" -X POd '{\"key1\":\"test1\",\"key2\":\"test2\",\"key3\":\"test3\"}' https://#####.execute-api.ap-northeast-1.amazonaws.com/botcallback/botcallback\n```\n\nCloud Watch\u3067\u30ed\u30b0\u78ba\u8a8d\n\n![watch001.png](https://qiita-image-store.s3.amazonaws.com/0/63450/954f5e6c-8824-795c-f3df-f182f10a5153.png)\n\n![watch002.png](https://qiita-image-store.s3.amazonaws.com/0/63450/ae28bc74-064a-37ba-9baf-e3fd820e39e7.png)\n\n![watch003.png](https://qiita-image-store.s3.amazonaws.com/0/63450/4caab358-54e7-4c3e-ad50-664bd27077ef.png)\n\n![watch004.png](https://qiita-image-store.s3.amazonaws.com/0/63450/9285822e-c727-a7d8-fb2b-6cf758191aec.png)\n\n![api017.png](https://qiita-image-store.s3.amazonaws.com/0/63450/4545126f-b45e-7daa-85ca-dd4c7c33886f.png)\n\n## Validation\u7528\u306eGET\u30e1\u30bd\u30c3\u30c9\u3092\u4f5c\u6210\n\n![api201_1.png](https://qiita-image-store.s3.amazonaws.com/0/63450/c322a021-c642-9778-0dad-6cfd7d55a8df.png)\n\n![api202.png](https://qiita-image-store.s3.amazonaws.com/0/63450/77a93cd2-a522-a53c-2360-68adb692f48a.png)\n\n![api204.png](https://qiita-image-store.s3.amazonaws.com/0/63450/5ba9352d-679c-6923-a929-054abd604d68.png)\n\n![api205.png](https://qiita-image-store.s3.amazonaws.com/0/63450/779117cb-d5fa-1d94-9cd7-9f14aaf6b735.png)\n\n![api206.png](https://qiita-image-store.s3.amazonaws.com/0/63450/0a1713a3-9156-6f2b-1ac1-338012542427.png)\n\n![api207.png](https://qiita-image-store.s3.amazonaws.com/0/63450/adc81b22-b2f2-9d5e-5df9-bead7f19ca55.png)\n\n![api208.png](https://qiita-image-store.s3.amazonaws.com/0/63450/6028a03f-9932-682b-269a-8fc38f14db0e.png)\n\n![api209.png](https://qiita-image-store.s3.amazonaws.com/0/63450/92d5cfb3-58e2-96f8-731f-5a6ee8f8fcfe.png)\n\n* hub.challenge\t\t\n* hub.verify_token\n\n\u3092\u8ffd\u52a0\u3002\n\n![api210.png](https://qiita-image-store.s3.amazonaws.com/0/63450/79f8559f-e6f3-5b80-13f0-cf0172e6a75f.png)\n\n![api211.png](https://qiita-image-store.s3.amazonaws.com/0/63450/ec2f4b9e-948b-6279-411a-30fb93e707fb.png)\n\n![api212.png](https://qiita-image-store.s3.amazonaws.com/0/63450/5b0ea94b-688c-af46-6d94-2f093dc7ea6f.png)\n\n![api213.png](https://qiita-image-store.s3.amazonaws.com/0/63450/90be1b82-13a0-b60a-1c61-ab322ec5ab14.png)\n\n\n\n```json:application/json\n{\n  \"hub.verify_token\": \"$input.params('hub.verify_token')\",\n  \"hub.challenge\": \"$input.params('hub.challenge')\"\n}\n```\n\n# Facebook\u3068AWS API Gateway\u3092\u9023\u643a\n\n![fb001.png](https://qiita-image-store.s3.amazonaws.com/0/63450/4e67dfe0-c3fb-2b91-ea26-071fdbc7dc28.png)\n\n![fb002.png](https://qiita-image-store.s3.amazonaws.com/0/63450/467cc8d1-c6f3-b405-9d69-0a3ec94247e6.png)\n\n![fb003.png](https://qiita-image-store.s3.amazonaws.com/0/63450/7ddd61cf-6c92-7ce6-1c59-95f361379c16.png)\n\n> curl -ik -X POST \"https://graph.facebook.com/v2.6/me/subscribed_apps?access_token=\u30c8\u30fc\u30af\u30f3\"\n\n\u3092\u30b3\u30de\u30f3\u30c9\u30e9\u30a4\u30f3\u3067\u5b9f\u884c\u3002\n\n![fb004.png](https://qiita-image-store.s3.amazonaws.com/0/63450/cbbe1642-4774-1dcb-c165-13fe9ba28341.png)\n\n![fb005.png](https://qiita-image-store.s3.amazonaws.com/0/63450/67a959f9-da2b-98aa-1d9f-68e11debdfc0.png)\n\n![fb006.png](https://qiita-image-store.s3.amazonaws.com/0/63450/a425fd7b-e373-f296-e7c1-412d3758d7fe.png)\n\n# \u4f5c\u6210\u3057\u305f\u30da\u30fc\u30b8\u3067\u30e1\u30c3\u30bb\u30fc\u30b8\u66f8\u304d\u8fbc\u307f\n\n\u4f5c\u6210\u3057\u305f\u30da\u30fc\u30b8\u306e\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u66f8\u304d\u8fbc\u3080\n\n## Cloud Watch\u3067\u30ed\u30b0\u78ba\u8a8d\n\n![watch001.png](https://qiita-image-store.s3.amazonaws.com/0/63450/954f5e6c-8824-795c-f3df-f182f10a5153.png)\n\n![watch002.png](https://qiita-image-store.s3.amazonaws.com/0/63450/ae28bc74-064a-37ba-9baf-e3fd820e39e7.png)\n\n![watch003.png](https://qiita-image-store.s3.amazonaws.com/0/63450/4caab358-54e7-4c3e-ad50-664bd27077ef.png)\n\n![watch004.png](https://qiita-image-store.s3.amazonaws.com/0/63450/9285822e-c727-a7d8-fb2b-6cf758191aec.png)\n\n\u30e1\u30c3\u30bb\u30fc\u30b8\u304c\u30ed\u30b0\u306b\u3067\u305f\u3089\u6210\u529f!\n\n# \u304a\u3046\u3080\u8fd4\u3057Bot\u306e\u30d7\u30ed\u30b0\u30e9\u30e0\u4f5c\u6210\u3000\n\nhttp://qiita.com/akira-sasaki/items/cbb667653579db9743ec\n", "tags": ["fabo", "GClue", "APIGateway", "lambda", "Facebook"]}