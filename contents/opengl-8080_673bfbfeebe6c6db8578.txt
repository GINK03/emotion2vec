{"context": " More than 1 year has passed since last update.\u7d44\u307f\u8fbc\u307f\u5229\u7528\u3067\u306e Jetty \u306e\u4f7f\u3044\u65b9\u3092\u30e1\u30e2\u3002\n\nHello World\n\nbuild.gradle\n\nbuild.gradle\napply plugin: 'java'\n\nrepositories {\n    mavenCentral()\n}\n\ndependencies {\n    compile 'org.eclipse.jetty.aggregate:jetty-all:9.1.4.v20140401'\n}\n\n\n\n\u5b9f\u88c5\n\nHelloJetty.java\npackage sample.jetty;\n\nimport java.io.IOException;\n\nimport javax.servlet.ServletException;\nimport javax.servlet.http.HttpServletRequest;\nimport javax.servlet.http.HttpServletResponse;\n\nimport org.eclipse.jetty.server.Request;\nimport org.eclipse.jetty.server.Server;\nimport org.eclipse.jetty.server.handler.AbstractHandler;\n\npublic class HelloJetty extends AbstractHandler {\n\n    public static void main(String[] args) throws Exception {\n        Server server = new Server(1234);\n        server.setHandler(new HelloJetty());\n        server.start();\n        server.join();\n    }\n\n    @Override\n    public void handle(String target, Request baseRequest, HttpServletRequest request, HttpServletResponse response) throws IOException, ServletException {\n        System.out.println(\"target = \" + target);\n\n        response.setContentType(\"text/html;charset=utf-8\");\n        response.setStatus(HttpServletResponse.SC_OK);\n        baseRequest.setHandled(true);\n        response.getWriter().println(\"<h1>Hello Jetty!!</h1>\");\n    }\n}\n\n\n\n\u52d5\u4f5c\u78ba\u8a8d\n\u5b9f\u884c\u3057\u3066\u3001 Web \u30d6\u30e9\u30a6\u30b6\u304b\u3089 http://localhost:1234 \u306b\u30a2\u30af\u30bb\u30b9\u3059\u308b\u3002\n\n\n\u30b3\u30f3\u30bd\u30fc\u30eb\u51fa\u529b\ntarget = /\n\n\n\n\u8aac\u660e\n\nServer\n\nJetty \u3092\u7d44\u307f\u8fbc\u307f\u3067\u4f7f\u3046\u3068\u304d\u306f\u3001 Server \u30af\u30e9\u30b9\u3092\u4f7f\u7528\u3059\u308b\u3002\n\u30b3\u30f3\u30b9\u30c8\u30e9\u30af\u30bf\u306e\u5f15\u6570\u3067\u3001\u30dd\u30fc\u30c8\u756a\u53f7\u3092\u6307\u5b9a\u3067\u304d\u308b\u3002\n\n\nHandler\n\nHandler \u3092 Server \u306b\u767b\u9332\u3057\u3066\u304a\u304f\u3068\u3001\u5168\u3066\u306e\u30ea\u30af\u30a8\u30b9\u30c8\u304c\u3053\u306e Handler \u306b\u6e21\u3055\u308c\u308b\u3002\n\u30ea\u30af\u30a8\u30b9\u30c8\u304c\u5c4a\u304f\u3068\u3001 Handler \u306e handle() \u30e1\u30bd\u30c3\u30c9\u304c\u5b9f\u884c\u3055\u308c\u308b\u3002\n\nhandle() \u30e1\u30bd\u30c3\u30c9\u306e\u7b2c\u4e00\u5f15\u6570\u306b\u306f\u3001\u30ea\u30af\u30a8\u30b9\u30c8\u306e\u3042\u3063\u305f URI \u304c\u6e21\u3055\u308c\u308b\u3002\n\n\nServlet \u3092\u767b\u9332\u3059\u308b\n\n\u5b9f\u88c5\n\nSampleServlet.java\npackage sample.jetty;\n\nimport java.io.IOException;\n\nimport javax.servlet.http.HttpServlet;\nimport javax.servlet.http.HttpServletRequest;\nimport javax.servlet.http.HttpServletResponse;\n\nimport org.eclipse.jetty.server.Server;\nimport org.eclipse.jetty.servlet.ServletHandler;\n\npublic class SampleServlet extends HttpServlet {\n    private static final long serialVersionUID = 1L;\n\n    public static void main(String[] args) throws Exception {\n        ServletHandler handler = new ServletHandler();\n        handler.addServletWithMapping(SampleServlet.class, \"/sample\");\n\n        Server server = new Server(1234);\n        server.setHandler(handler);\n        server.start();\n        server.join();\n    }\n\n    @Override\n    public void doGet(HttpServletRequest req, HttpServletResponse res) throws IOException {\n        res.getWriter().println(\"Servlet on Jetty.\");\n    }\n}\n\n\n\n\u52d5\u4f5c\u78ba\u8a8d\n\u5b9f\u884c\u3057\u3066\u3001 Web \u30d6\u30e9\u30a6\u30b6\u304b\u3089 http://localhost:1234/sample \u306b\u30a2\u30af\u30bb\u30b9\u3059\u308b\u3002\n\n\n\u8aac\u660e\n\n\nServletHandler#addServletWithMapping() \u30e1\u30bd\u30c3\u30c9\u3067 Servlet \u3068 URI \u306e\u30de\u30c3\u30d4\u30f3\u30b0\u3092\u5b9a\u7fa9\u3059\u308b\u3002\n\n\nwar \u30d5\u30a1\u30a4\u30eb\u3092\u30c7\u30d7\u30ed\u30a4\u3059\u308b\n\u7d44\u307f\u8fbc\u307f\u3067\u8d77\u52d5\u3059\u308b jetty \u306b war \u30d5\u30a1\u30a4\u30eb\u3092\u30c7\u30d7\u30ed\u30a4\u3059\u308b\u3002\n\n\u30c7\u30d7\u30ed\u30a4\u3059\u308b war \u30d7\u30ed\u30b8\u30a7\u30af\u30c8\n\u4f55\u306e\u5909\u54f2\u3082\u306a\u3044 war \u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3002\n\nbuild.gradle\n\nbuild.gradle\napply plugin: 'war'\n\nrepositories {\n    mavenCentral()\n}\n\ndependencies {\n    providedCompile 'javax.servlet:javax.servlet-api:3.1.0'\n}\n\nwar.baseName = 'sample'\n\n\n\n\u5b9f\u88c5\n\nsample.jetty.SampleServlet.java\npackage sample.jetty;\n\nimport javax.servlet.annotation.WebServlet;\nimport javax.servlet.http.HttpServlet;\nimport javax.servlet.http.HttpServletRequest;\nimport javax.servlet.http.HttpServletResponse;\nimport java.io.IOException;\n\n@WebServlet(\"/servlet\")\npublic class SampleServlet extends HttpServlet {\n    private static final long serialVersionUID = 1L;\n\n    @Override\n    public void doGet(HttpServletRequest req, HttpServletResponse res) throws IOException {\n        res.getWriter().println(\"war on jetty.\");\n    }\n}\n\n\n\n\u8d77\u52d5\u5074\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\n\nbuild.gradle\n\nbuild.gradle\napply plugin: 'java'\n\nrepositories {\n    mavenCentral()\n}\n\ndependencies {\n    compile 'org.eclipse.jetty:jetty-webapp:9.1.4.v20140401'\n    compile 'org.eclipse.jetty:jetty-annotations:9.1.4.v20140401'\n}\n\n\n\n\njetty-all \u3060\u3068\u3001 @WebServlet \u306e\u3088\u3046\u306a Servlet 3.0 \u6d41\u306e\u5b9f\u88c5\u3092\u4f7f\u3063\u305f\u3068\u304d\u306b ClassNotFoundException \u304c\u767a\u751f\u3059\u308b\u306e\u3067\u3001 dependencies \u3092\u82e5\u5e72\u5909\u3048\u3066\u308b\uff08\u63a8\u79fb\u7684\u306a\u4f9d\u5b58\u95a2\u4fc2\u306e\u7ba1\u7406\u3068\u306f\u4f55\u3060\u3063\u305f\u306e\u304b...\uff09\u3002\n\n\n\u5b9f\u88c5\n\nMain.java\npackage sample.jetty;\n\nimport org.eclipse.jetty.annotations.AnnotationConfiguration;\nimport org.eclipse.jetty.plus.webapp.EnvConfiguration;\nimport org.eclipse.jetty.plus.webapp.PlusConfiguration;\nimport org.eclipse.jetty.server.Server;\nimport org.eclipse.jetty.webapp.Configuration;\nimport org.eclipse.jetty.webapp.FragmentConfiguration;\nimport org.eclipse.jetty.webapp.JettyWebXmlConfiguration;\nimport org.eclipse.jetty.webapp.MetaInfConfiguration;\nimport org.eclipse.jetty.webapp.WebAppContext;\nimport org.eclipse.jetty.webapp.WebInfConfiguration;\nimport org.eclipse.jetty.webapp.WebXmlConfiguration;\n\npublic class Main {\n    public static void main(String[] args) throws Exception {\n        // 1. war \u30d5\u30a1\u30a4\u30eb\u306e\u8a2d\u5b9a\n        WebAppContext war = new WebAppContext();\n        war.setContextPath(\"/sample\");\n        war.setWar(\"./sample.war\");\n\n        // 2. @WebServlet \u3068\u304b\u3092\u6709\u52b9\u306b\u3057\u3066\u3044\u308b\n        Configuration[] configurations = {\n            new AnnotationConfiguration(),\n            new WebInfConfiguration(),\n            new WebXmlConfiguration(),\n            new MetaInfConfiguration(),\n            new FragmentConfiguration(),\n            new EnvConfiguration(),\n            new PlusConfiguration(),\n            new JettyWebXmlConfiguration()\n        };\n\n        war.setConfigurations(configurations);\n\n        Server server = new Server(1234);\n        server.setHandler(war);\n        server.start();\n        server.join();\n    }\n}\n\n\n\n\nWebAppContext \u306e setContextPath() \u3067\u30b3\u30f3\u30c6\u30ad\u30b9\u30c8\u30d1\u30b9\u3092\u3001 setWar() \u3067\u30c7\u30d7\u30ed\u30a4\u3059\u308b war \u306e\u30d1\u30b9\u3092\u6307\u5b9a\u3057\u3066\u3044\u308b\u3002\n\u4e0a\u8a18\u306e\u3088\u3046\u306a\u611f\u3058\u3067 setConfigurations() \u3092\u8a2d\u5b9a\u3057\u306a\u3044\u3068\u3001 @WebServlet \u306e\u8a2d\u5b9a\u306f\u7121\u8996\u3055\u308c\u3001 Servlet 3.0 \u6d41\u306e\u5b9f\u88c5\u304c\u3067\u304d\u306a\u3044\u3002\n\n\n\u52d5\u4f5c\u78ba\u8a8d\n\u8d77\u52d5\u3057\u305f\u3089 Web \u30d6\u30e9\u30a6\u30b6\u3067 http://localhost:1234/sample/servlet \u306b\u30a2\u30af\u30bb\u30b9\u3059\u308b\u3002\n\n\n\u5b9f\u884c\u53ef\u80fd\u306a war \u3092\u4f5c\u6210\u3059\u308b\njenkins \u307f\u305f\u3044\u306b\n>java -jar hoge.war\n\n\u3067\u30b5\u30fc\u30d0\u30fc\u306e\u8d77\u52d5\u3068 war \u306e\u914d\u5099\u304c\u3067\u304d\u305f\u3089 cool \u3067\u3059\u3088\u306d\u3002\n\u3068\u3044\u3046\u3053\u3068\u3067\u3001\u3084\u3063\u3066\u307f\u308b\u3002\n\nbuild.gradle\n\nbuild.gradle\napply plugin: 'war'\n\nrepositories {\n    mavenCentral()\n}\n\ndependencies {\n    providedCompile 'org.eclipse.jetty:jetty-webapp:9.1.4.v20140401'\n    providedCompile 'org.eclipse.jetty:jetty-annotations:9.1.4.v20140401'\n}\n\nwar {\n    baseName = 'jetty-sample'\n\n    from {\n        configurations.providedCompile.collect {\n            it.isDirectory() ? it : project.zipTree(it)\n        }\n    }\n    from fileTree(dir: 'build/classes/main', include: '**/Main.class')\n\n    manifest.attributes('Main-Class': 'sample.jetty.Main')\n}\n\n\n\n\u5b9f\u88c5\n\nsample.jetty.Main.java\npackage sample.jetty;\n\nimport java.net.URL;\nimport java.security.ProtectionDomain;\n\nimport org.eclipse.jetty.annotations.AnnotationConfiguration;\nimport org.eclipse.jetty.plus.webapp.EnvConfiguration;\nimport org.eclipse.jetty.plus.webapp.PlusConfiguration;\nimport org.eclipse.jetty.server.Server;\nimport org.eclipse.jetty.webapp.Configuration;\nimport org.eclipse.jetty.webapp.FragmentConfiguration;\nimport org.eclipse.jetty.webapp.JettyWebXmlConfiguration;\nimport org.eclipse.jetty.webapp.MetaInfConfiguration;\nimport org.eclipse.jetty.webapp.WebAppContext;\nimport org.eclipse.jetty.webapp.WebInfConfiguration;\nimport org.eclipse.jetty.webapp.WebXmlConfiguration;\n\npublic class Main {\n    public static void main(String[] args) throws Exception {\n\n        WebAppContext war = new WebAppContext();\n        war.setContextPath(\"/sample\");\n\n        // \u3053\u3053\u3067 war \u30d5\u30a1\u30a4\u30eb\u306e\u5834\u6240\u3092\u53d6\u5f97\u3057\u3066\u3044\u308b\n        ProtectionDomain domain = Main.class.getProtectionDomain();\n        URL warLocation = domain.getCodeSource().getLocation();\n        war.setWar(warLocation.toExternalForm());\n\n        Configuration[] configurations = {\n            new AnnotationConfiguration(),\n            new WebInfConfiguration(),\n            new WebXmlConfiguration(),\n            new MetaInfConfiguration(),\n            new FragmentConfiguration(),\n            new EnvConfiguration(),\n            new PlusConfiguration(),\n            new JettyWebXmlConfiguration()\n        };\n\n        war.setConfigurations(configurations);\n\n        Server server = new Server(1234);\n        server.setHandler(war);\n        server.start();\n        server.join();\n    }\n}\n\n\n\nsample.jetty.SampleServlet.java\npackage sample.jetty;\n\nimport java.io.IOException;\n\nimport javax.servlet.annotation.WebServlet;\nimport javax.servlet.http.HttpServlet;\nimport javax.servlet.http.HttpServletRequest;\nimport javax.servlet.http.HttpServletResponse;\n\n@WebServlet(\"/servlet\")\npublic class SampleServlet extends HttpServlet {\n    private static final long serialVersionUID = 1L;\n\n    @Override\n    public void doGet(HttpServletRequest req, HttpServletResponse res) throws IOException {\n        res.getWriter().println(\"executable war.\");\n    }\n}\n\n\n\n\u52d5\u4f5c\u78ba\u8a8d\nwar \u3092\u4f5c\u3063\u3066\u8d77\u52d5\u3059\u308b\u3002\n>gradle war\n\n>java -jar build\\libs\\jetty-sample.war\n2014-04-29 23:39:57.074:INFO::main: Logging initialized @105ms\n2014-04-29 23:39:57.130:INFO:oejs.Server:main: jetty-9.1.z-SNAPSHOT\n2014-04-29 23:39:57.840:INFO:oejw.StandardDescriptorProcessor:main: NO JSP Support for /sample, did not find org.apache.jasper.servlet.JspServlet\n2014-04-29 23:39:57.869:INFO:oejsh.ContextHandler:main: Started o.e.j.w.WebAppContext@483bf400{/sample,file:/<\u7701\u7565>/jetty-0.0.0.0-1234-jetty-sample.war-_sample-any-951802741547862236.dir/webapp/,AVAILABLE}{file:<\u7701\u7565>/build/libs/jetty-sample.war}\n2014-04-29 23:39:57.888:INFO:oejs.ServerConnector:main: Started ServerConnector@5d624da6{HTTP/1.1}{0.0.0.0:1234}\n2014-04-29 23:39:57.888:INFO:oejs.Server:main: Started @938ms\n\nWeb \u30d6\u30e9\u30a6\u30b6\u3092\u958b\u3044\u3066\u3001 http://localhost:1234/sample/servlet \u306b\u30a2\u30af\u30bb\u30b9\u3059\u308b\u3002\n\n\u505c\u6b62\u306f\u30b3\u30de\u30f3\u30c9\u30e9\u30a4\u30f3\u4e0a\u3067 Ctrl + C \u3002\n\n\u8aac\u660e\n\nwar \u30d5\u30a1\u30a4\u30eb\u306e\u5834\u6240\u3092\u53d6\u5f97\u3059\u308b\u65b9\u6cd5\n\nMain.java\nProtectionDomain domain = Main.class.getProtectionDomain();\nURL warLocation = domain.getCodeSource().getLocation();\nwar.setWar(warLocation.toExternalForm());\n\n\n\u4ed5\u7d44\u307f\u306f\u3088\u304f\u308f\u304b\u3063\u3066\u306a\u3044\u3051\u3069\u3001\u3053\u3046\u3059\u308c\u3070 jar \u3068\u3057\u3066\u5b9f\u884c\u3057\u3066\u3044\u308b\u300c\u3053\u306e war \u30d5\u30a1\u30a4\u30eb\u306e\u5834\u6240\u300d\u304c\u53d6\u5f97\u3067\u304d\u308b\u3089\u3057\u3044\u3002\n\nwar \u30d5\u30a1\u30a4\u30eb\u3092\u300c\u5b9f\u884c\u53ef\u80fd jar \u5f62\u5f0f\u300d\u306b\u3059\u308b\u65b9\u6cd5\n\nbuild.gradle\nwar {\n    // 1\n    from {\n        configurations.providedCompile.collect {\n            it.isDirectory() ? it : project.zipTree(it)\n        }\n    }\n\n    // 2\n    from fileTree(dir: 'build/classes/main', include: '**/Main.class')\n\n    // 3\n    manifest.attributes('Main-Class': 'sample.jetty.Main')\n}\n\n\n\njetty \u304a\u3088\u3073\u305d\u306e\u4f9d\u5b58\u5bfe\u8c61\u3092 war \u306e\u76f4\u4e0b\u306b\u5c55\u958b\u3057\u3066\u3044\u308b\u3002\n\u8d77\u52d5\u7528\u306e Main \u30af\u30e9\u30b9\u3092 war \u306e\u76f4\u4e0b\u306b\u5c55\u958b\u3057\u3066\u3044\u308b\u3002\n\u30de\u30cb\u30d5\u30a7\u30b9\u30c8\u30d5\u30a1\u30a4\u30eb\u306b Main \u30af\u30e9\u30b9\u3092\u5b9a\u7fa9\u3057\u3066\u3044\u308b\u3002\n\nwar \u30d5\u30a1\u30a4\u30eb\u3092\u89e3\u51cd\u3059\u308b\u3068\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u69cb\u6210\u306b\u306a\u3063\u3066\u3044\u308b\u3002\njetty-sample/\n\u2502\n\u2502  about.html\n\u2502  jetty-dir.css\n\u2502  jndi.properties\n\u251cjavax/\n\u2502  \u251cannotation/\n\u2502  \u2514servlet/\n\u251corg/\n\u2502  \u251ceclipse/\n\u2502  \u2502  \u2514jetty/\n\u2502  \u2514objectweb/\n\u2502      \u2514asm/\n\u251cMETA-INF/\n\u2502  \u2514MANIFEST.MF\n\u251csample/\n\u2502  \u2514jetty/\n\u2502     Main.class\n\u2502\n\u2514WEB-INF/\n    \u2514classes/\n        \u2514sample/\n            \u2514jetty/\n               Main.class\n               SampleServlet.class\n\n\u5b9f\u884c\u53ef\u80fd jar \u3068\u3057\u3066\u306e\u69cb\u6210\u3068 war \u3068\u3057\u3066\u306e\u69cb\u6210\u304c\u3054\u3061\u3083\u6df7\u305c\u306b\u306a\u3063\u305f\u69cb\u9020\u306b\u306a\u3063\u3066\u3044\u308b\u3002\n\u3064\u307e\u308a\u3001\u5f53\u7136 http://localhost:1234/sample/abount.html \u3068\u304b http://localhost:1234/sample/org/eclipse/jetty/server/Server.class \u306b\u30a2\u30af\u30bb\u30b9\u3059\u308b\u3068\u3001\u5f53\u8a72\u30d5\u30a1\u30a4\u30eb\u304c\u4e38\u898b\u3048\u306b\u306a\u3063\u3066\u3044\u308b\u3002\n\n\u3084\u3084\u683c\u597d\u60aa\u3044\u3051\u3069\u3001\u6211\u6162\u3059\u308b\u304b\u3001\u3069\u3046\u3057\u3066\u3082\u5acc\u306a\u3089 Filter \u3092\u4f5c\u3063\u3066\u3001\u898b\u3089\u308c\u305f\u304f\u306a\u3044\u30d1\u30b9\u3078\u306e\u30a2\u30af\u30bb\u30b9\u306f\u5168\u90e8 404 \u306b\u3057\u3066\u3057\u307e\u3046\u3068\u3044\u3046\u65b9\u6cd5\u3082\u3042\u308a\u304b\u306a\u3068\u3002\n\nweb \u30d5\u30a9\u30eb\u30c0\u3092\u6307\u5b9a\u3059\u308b\n\nMain.java\npackage sample.jetty;\n\nimport java.net.URL;\nimport java.security.ProtectionDomain;\n\nimport org.eclipse.jetty.annotations.AnnotationConfiguration;\nimport org.eclipse.jetty.plus.webapp.EnvConfiguration;\nimport org.eclipse.jetty.plus.webapp.PlusConfiguration;\nimport org.eclipse.jetty.server.Server;\nimport org.eclipse.jetty.webapp.Configuration;\nimport org.eclipse.jetty.webapp.FragmentConfiguration;\nimport org.eclipse.jetty.webapp.JettyWebXmlConfiguration;\nimport org.eclipse.jetty.webapp.MetaInfConfiguration;\nimport org.eclipse.jetty.webapp.WebAppContext;\nimport org.eclipse.jetty.webapp.WebInfConfiguration;\nimport org.eclipse.jetty.webapp.WebXmlConfiguration;\n\npublic class Main {\n    public static void main(String[] args) throws Exception {\n        WebAppContext war = new WebAppContext();\n        war.setContextPath(\"/sample\");\n        war.setResourceBase(\"src/main/webapp\");\n\n        Configuration[] configurations = {\n            new AnnotationConfiguration(),\n            new WebInfConfiguration(),\n            new WebXmlConfiguration(),\n            new MetaInfConfiguration(),\n            new FragmentConfiguration(),\n            new EnvConfiguration(),\n            new PlusConfiguration(),\n            new JettyWebXmlConfiguration()\n        };\n\n        war.setConfigurations(configurations);\n\n        Server server = new Server(1234);\n        server.setHandler(war);\n        server.start();\n        server.join();\n    }\n}\n\n\n\n\nWebAppContext#setResourceBase(path) \u3067\u3001 web \u30d5\u30a9\u30eb\u30c0\u3092\u6307\u5b9a\u3057\u3066\u8d77\u52d5\u3067\u304d\u308b\u3002\n\n\u53c2\u8003\n\nTomcat\u304b\u3089Jetty\u3078 - Narwhal\n\n\n\u53c2\u8003\n\nChapter 25. Embedding | Jetty : The Definitive Reference\njava - Embedding Jetty as a Servlet Container - Stack Overflow\njetty-project/embedded-servlet-3.1 | GitHub\nLinked Java: Executable Wars with Gradle and Jetty\nExecutable WARs with Jetty | EclipseSource Blog\n\n\u7d44\u307f\u8fbc\u307f\u5229\u7528\u3067\u306e Jetty \u306e\u4f7f\u3044\u65b9\u3092\u30e1\u30e2\u3002\n\n#Hello World\n##build.gradle\n```groovy:build.gradle\napply plugin: 'java'\n\nrepositories {\n    mavenCentral()\n}\n\ndependencies {\n    compile 'org.eclipse.jetty.aggregate:jetty-all:9.1.4.v20140401'\n}\n```\n\n##\u5b9f\u88c5\n```java:HelloJetty.java\npackage sample.jetty;\n\nimport java.io.IOException;\n\nimport javax.servlet.ServletException;\nimport javax.servlet.http.HttpServletRequest;\nimport javax.servlet.http.HttpServletResponse;\n\nimport org.eclipse.jetty.server.Request;\nimport org.eclipse.jetty.server.Server;\nimport org.eclipse.jetty.server.handler.AbstractHandler;\n\npublic class HelloJetty extends AbstractHandler {\n    \n    public static void main(String[] args) throws Exception {\n        Server server = new Server(1234);\n        server.setHandler(new HelloJetty());\n        server.start();\n        server.join();\n    }\n\n    @Override\n    public void handle(String target, Request baseRequest, HttpServletRequest request, HttpServletResponse response) throws IOException, ServletException {\n        System.out.println(\"target = \" + target);\n        \n        response.setContentType(\"text/html;charset=utf-8\");\n        response.setStatus(HttpServletResponse.SC_OK);\n        baseRequest.setHandled(true);\n        response.getWriter().println(\"<h1>Hello Jetty!!</h1>\");\n    }\n}\n```\n\n##\u52d5\u4f5c\u78ba\u8a8d\n\u5b9f\u884c\u3057\u3066\u3001 Web \u30d6\u30e9\u30a6\u30b6\u304b\u3089 `http://localhost:1234` \u306b\u30a2\u30af\u30bb\u30b9\u3059\u308b\u3002\n\n![jetty.JPG](https://qiita-image-store.s3.amazonaws.com/0/28302/0c748d5b-57ac-848a-c023-3a3054ed7887.jpeg)\n\n```text:\u30b3\u30f3\u30bd\u30fc\u30eb\u51fa\u529b\ntarget = /\n```\n\n##\u8aac\u660e\n###Server\n- Jetty \u3092\u7d44\u307f\u8fbc\u307f\u3067\u4f7f\u3046\u3068\u304d\u306f\u3001 Server \u30af\u30e9\u30b9\u3092\u4f7f\u7528\u3059\u308b\u3002\n- \u30b3\u30f3\u30b9\u30c8\u30e9\u30af\u30bf\u306e\u5f15\u6570\u3067\u3001\u30dd\u30fc\u30c8\u756a\u53f7\u3092\u6307\u5b9a\u3067\u304d\u308b\u3002\n\n###Handler\n- Handler \u3092 Server \u306b\u767b\u9332\u3057\u3066\u304a\u304f\u3068\u3001\u5168\u3066\u306e\u30ea\u30af\u30a8\u30b9\u30c8\u304c\u3053\u306e Handler \u306b\u6e21\u3055\u308c\u308b\u3002\n- \u30ea\u30af\u30a8\u30b9\u30c8\u304c\u5c4a\u304f\u3068\u3001 Handler \u306e `handle()` \u30e1\u30bd\u30c3\u30c9\u304c\u5b9f\u884c\u3055\u308c\u308b\u3002\n- `handle()` \u30e1\u30bd\u30c3\u30c9\u306e\u7b2c\u4e00\u5f15\u6570\u306b\u306f\u3001\u30ea\u30af\u30a8\u30b9\u30c8\u306e\u3042\u3063\u305f URI \u304c\u6e21\u3055\u308c\u308b\u3002\n\n#Servlet \u3092\u767b\u9332\u3059\u308b\n##\u5b9f\u88c5\n```java:SampleServlet.java\npackage sample.jetty;\n\nimport java.io.IOException;\n\nimport javax.servlet.http.HttpServlet;\nimport javax.servlet.http.HttpServletRequest;\nimport javax.servlet.http.HttpServletResponse;\n\nimport org.eclipse.jetty.server.Server;\nimport org.eclipse.jetty.servlet.ServletHandler;\n\npublic class SampleServlet extends HttpServlet {\n    private static final long serialVersionUID = 1L;\n    \n    public static void main(String[] args) throws Exception {\n        ServletHandler handler = new ServletHandler();\n        handler.addServletWithMapping(SampleServlet.class, \"/sample\");\n        \n        Server server = new Server(1234);\n        server.setHandler(handler);\n        server.start();\n        server.join();\n    }\n    \n    @Override\n    public void doGet(HttpServletRequest req, HttpServletResponse res) throws IOException {\n        res.getWriter().println(\"Servlet on Jetty.\");\n    }\n}\n```\n\n##\u52d5\u4f5c\u78ba\u8a8d\n\u5b9f\u884c\u3057\u3066\u3001 Web \u30d6\u30e9\u30a6\u30b6\u304b\u3089 `http://localhost:1234/sample` \u306b\u30a2\u30af\u30bb\u30b9\u3059\u308b\u3002\n\n![jetty.JPG](https://qiita-image-store.s3.amazonaws.com/0/28302/8913c113-cac3-20a0-ba26-37746ff93d4c.jpeg)\n\n##\u8aac\u660e\n- `ServletHandler#addServletWithMapping()` \u30e1\u30bd\u30c3\u30c9\u3067 Servlet \u3068 URI \u306e\u30de\u30c3\u30d4\u30f3\u30b0\u3092\u5b9a\u7fa9\u3059\u308b\u3002\n\n#war \u30d5\u30a1\u30a4\u30eb\u3092\u30c7\u30d7\u30ed\u30a4\u3059\u308b\n\u7d44\u307f\u8fbc\u307f\u3067\u8d77\u52d5\u3059\u308b jetty \u306b war \u30d5\u30a1\u30a4\u30eb\u3092\u30c7\u30d7\u30ed\u30a4\u3059\u308b\u3002\n\n##\u30c7\u30d7\u30ed\u30a4\u3059\u308b war \u30d7\u30ed\u30b8\u30a7\u30af\u30c8\n\u4f55\u306e\u5909\u54f2\u3082\u306a\u3044 war \u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3002\n\n###build.gradle\n```groovy:build.gradle\napply plugin: 'war'\n\nrepositories {\n    mavenCentral()\n}\n\ndependencies {\n    providedCompile 'javax.servlet:javax.servlet-api:3.1.0'\n}\n\nwar.baseName = 'sample'\n```\n\n###\u5b9f\u88c5\n```java:sample.jetty.SampleServlet.java\npackage sample.jetty;\n\nimport javax.servlet.annotation.WebServlet;\nimport javax.servlet.http.HttpServlet;\nimport javax.servlet.http.HttpServletRequest;\nimport javax.servlet.http.HttpServletResponse;\nimport java.io.IOException;\n\n@WebServlet(\"/servlet\")\npublic class SampleServlet extends HttpServlet {\n    private static final long serialVersionUID = 1L;\n\n    @Override\n    public void doGet(HttpServletRequest req, HttpServletResponse res) throws IOException {\n        res.getWriter().println(\"war on jetty.\");\n    }\n}\n```\n\n##\u8d77\u52d5\u5074\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\n###build.gradle\n```groovy:build.gradle\napply plugin: 'java'\n\nrepositories {\n    mavenCentral()\n}\n\ndependencies {\n    compile 'org.eclipse.jetty:jetty-webapp:9.1.4.v20140401'\n    compile 'org.eclipse.jetty:jetty-annotations:9.1.4.v20140401'\n}\n```\n\n- `jetty-all` \u3060\u3068\u3001 `@WebServlet` \u306e\u3088\u3046\u306a Servlet 3.0 \u6d41\u306e\u5b9f\u88c5\u3092\u4f7f\u3063\u305f\u3068\u304d\u306b `ClassNotFoundException` \u304c\u767a\u751f\u3059\u308b\u306e\u3067\u3001 `dependencies` \u3092\u82e5\u5e72\u5909\u3048\u3066\u308b\uff08\u63a8\u79fb\u7684\u306a\u4f9d\u5b58\u95a2\u4fc2\u306e\u7ba1\u7406\u3068\u306f\u4f55\u3060\u3063\u305f\u306e\u304b...\uff09\u3002\n\n###\u5b9f\u88c5\n```java:Main.java\npackage sample.jetty;\n\nimport org.eclipse.jetty.annotations.AnnotationConfiguration;\nimport org.eclipse.jetty.plus.webapp.EnvConfiguration;\nimport org.eclipse.jetty.plus.webapp.PlusConfiguration;\nimport org.eclipse.jetty.server.Server;\nimport org.eclipse.jetty.webapp.Configuration;\nimport org.eclipse.jetty.webapp.FragmentConfiguration;\nimport org.eclipse.jetty.webapp.JettyWebXmlConfiguration;\nimport org.eclipse.jetty.webapp.MetaInfConfiguration;\nimport org.eclipse.jetty.webapp.WebAppContext;\nimport org.eclipse.jetty.webapp.WebInfConfiguration;\nimport org.eclipse.jetty.webapp.WebXmlConfiguration;\n\npublic class Main {\n    public static void main(String[] args) throws Exception {\n        // 1. war \u30d5\u30a1\u30a4\u30eb\u306e\u8a2d\u5b9a\n        WebAppContext war = new WebAppContext();\n        war.setContextPath(\"/sample\");\n        war.setWar(\"./sample.war\");\n        \n        // 2. @WebServlet \u3068\u304b\u3092\u6709\u52b9\u306b\u3057\u3066\u3044\u308b\n        Configuration[] configurations = {\n            new AnnotationConfiguration(),\n            new WebInfConfiguration(),\n            new WebXmlConfiguration(),\n            new MetaInfConfiguration(),\n            new FragmentConfiguration(),\n            new EnvConfiguration(),\n            new PlusConfiguration(),\n            new JettyWebXmlConfiguration()\n        };\n        \n        war.setConfigurations(configurations);\n\n        Server server = new Server(1234);\n        server.setHandler(war);\n        server.start();\n        server.join();\n    }\n}\n```\n\n1. `WebAppContext` \u306e `setContextPath()` \u3067\u30b3\u30f3\u30c6\u30ad\u30b9\u30c8\u30d1\u30b9\u3092\u3001 `setWar()` \u3067\u30c7\u30d7\u30ed\u30a4\u3059\u308b war \u306e\u30d1\u30b9\u3092\u6307\u5b9a\u3057\u3066\u3044\u308b\u3002\n2. \u4e0a\u8a18\u306e\u3088\u3046\u306a\u611f\u3058\u3067 `setConfigurations()` \u3092\u8a2d\u5b9a\u3057\u306a\u3044\u3068\u3001 `@WebServlet` \u306e\u8a2d\u5b9a\u306f\u7121\u8996\u3055\u308c\u3001 Servlet 3.0 \u6d41\u306e\u5b9f\u88c5\u304c\u3067\u304d\u306a\u3044\u3002\n\n##\u52d5\u4f5c\u78ba\u8a8d\n\u8d77\u52d5\u3057\u305f\u3089 Web \u30d6\u30e9\u30a6\u30b6\u3067 `http://localhost:1234/sample/servlet` \u306b\u30a2\u30af\u30bb\u30b9\u3059\u308b\u3002\n\n![jetty.JPG](https://qiita-image-store.s3.amazonaws.com/0/28302/226870e5-7e84-9ba1-fbfa-fa0f7728c4c6.jpeg)\n\n#\u5b9f\u884c\u53ef\u80fd\u306a war \u3092\u4f5c\u6210\u3059\u308b\njenkins \u307f\u305f\u3044\u306b\n\n```text:\n>java -jar hoge.war\n```\n\n\u3067\u30b5\u30fc\u30d0\u30fc\u306e\u8d77\u52d5\u3068 war \u306e\u914d\u5099\u304c\u3067\u304d\u305f\u3089 cool \u3067\u3059\u3088\u306d\u3002\n\n\u3068\u3044\u3046\u3053\u3068\u3067\u3001\u3084\u3063\u3066\u307f\u308b\u3002\n\n##build.gradle\n```groovy:build.gradle\napply plugin: 'war'\n\nrepositories {\n    mavenCentral()\n}\n\ndependencies {\n    providedCompile 'org.eclipse.jetty:jetty-webapp:9.1.4.v20140401'\n    providedCompile 'org.eclipse.jetty:jetty-annotations:9.1.4.v20140401'\n}\n\nwar {\n    baseName = 'jetty-sample'\n    \n    from {\n        configurations.providedCompile.collect {\n            it.isDirectory() ? it : project.zipTree(it)\n        }\n    }\n    from fileTree(dir: 'build/classes/main', include: '**/Main.class')\n    \n    manifest.attributes('Main-Class': 'sample.jetty.Main')\n}\n```\n\n##\u5b9f\u88c5\n```java:sample.jetty.Main.java\npackage sample.jetty;\n\nimport java.net.URL;\nimport java.security.ProtectionDomain;\n\nimport org.eclipse.jetty.annotations.AnnotationConfiguration;\nimport org.eclipse.jetty.plus.webapp.EnvConfiguration;\nimport org.eclipse.jetty.plus.webapp.PlusConfiguration;\nimport org.eclipse.jetty.server.Server;\nimport org.eclipse.jetty.webapp.Configuration;\nimport org.eclipse.jetty.webapp.FragmentConfiguration;\nimport org.eclipse.jetty.webapp.JettyWebXmlConfiguration;\nimport org.eclipse.jetty.webapp.MetaInfConfiguration;\nimport org.eclipse.jetty.webapp.WebAppContext;\nimport org.eclipse.jetty.webapp.WebInfConfiguration;\nimport org.eclipse.jetty.webapp.WebXmlConfiguration;\n\npublic class Main {\n    public static void main(String[] args) throws Exception {\n        \n        WebAppContext war = new WebAppContext();\n        war.setContextPath(\"/sample\");\n        \n        // \u3053\u3053\u3067 war \u30d5\u30a1\u30a4\u30eb\u306e\u5834\u6240\u3092\u53d6\u5f97\u3057\u3066\u3044\u308b\n        ProtectionDomain domain = Main.class.getProtectionDomain();\n        URL warLocation = domain.getCodeSource().getLocation();\n        war.setWar(warLocation.toExternalForm());\n        \n        Configuration[] configurations = {\n            new AnnotationConfiguration(),\n            new WebInfConfiguration(),\n            new WebXmlConfiguration(),\n            new MetaInfConfiguration(),\n            new FragmentConfiguration(),\n            new EnvConfiguration(),\n            new PlusConfiguration(),\n            new JettyWebXmlConfiguration()\n        };\n        \n        war.setConfigurations(configurations);\n\n        Server server = new Server(1234);\n        server.setHandler(war);\n        server.start();\n        server.join();\n    }\n}\n```\n\n```java:sample.jetty.SampleServlet.java\npackage sample.jetty;\n\nimport java.io.IOException;\n\nimport javax.servlet.annotation.WebServlet;\nimport javax.servlet.http.HttpServlet;\nimport javax.servlet.http.HttpServletRequest;\nimport javax.servlet.http.HttpServletResponse;\n\n@WebServlet(\"/servlet\")\npublic class SampleServlet extends HttpServlet {\n    private static final long serialVersionUID = 1L;\n    \n    @Override\n    public void doGet(HttpServletRequest req, HttpServletResponse res) throws IOException {\n        res.getWriter().println(\"executable war.\");\n    }\n}\n```\n\n##\u52d5\u4f5c\u78ba\u8a8d\nwar \u3092\u4f5c\u3063\u3066\u8d77\u52d5\u3059\u308b\u3002\n\n```text:\n>gradle war\n\n>java -jar build\\libs\\jetty-sample.war\n2014-04-29 23:39:57.074:INFO::main: Logging initialized @105ms\n2014-04-29 23:39:57.130:INFO:oejs.Server:main: jetty-9.1.z-SNAPSHOT\n2014-04-29 23:39:57.840:INFO:oejw.StandardDescriptorProcessor:main: NO JSP Support for /sample, did not find org.apache.jasper.servlet.JspServlet\n2014-04-29 23:39:57.869:INFO:oejsh.ContextHandler:main: Started o.e.j.w.WebAppContext@483bf400{/sample,file:/<\u7701\u7565>/jetty-0.0.0.0-1234-jetty-sample.war-_sample-any-951802741547862236.dir/webapp/,AVAILABLE}{file:<\u7701\u7565>/build/libs/jetty-sample.war}\n2014-04-29 23:39:57.888:INFO:oejs.ServerConnector:main: Started ServerConnector@5d624da6{HTTP/1.1}{0.0.0.0:1234}\n2014-04-29 23:39:57.888:INFO:oejs.Server:main: Started @938ms\n```\n\nWeb \u30d6\u30e9\u30a6\u30b6\u3092\u958b\u3044\u3066\u3001 `http://localhost:1234/sample/servlet` \u306b\u30a2\u30af\u30bb\u30b9\u3059\u308b\u3002\n\n![jetty.JPG](https://qiita-image-store.s3.amazonaws.com/0/28302/f5744ea4-8410-c1dd-c8c9-d1ba31dc343e.jpeg)\n\n\u505c\u6b62\u306f\u30b3\u30de\u30f3\u30c9\u30e9\u30a4\u30f3\u4e0a\u3067 `Ctrl + C` \u3002\n\n##\u8aac\u660e\n###war \u30d5\u30a1\u30a4\u30eb\u306e\u5834\u6240\u3092\u53d6\u5f97\u3059\u308b\u65b9\u6cd5\n```java:Main.java\nProtectionDomain domain = Main.class.getProtectionDomain();\nURL warLocation = domain.getCodeSource().getLocation();\nwar.setWar(warLocation.toExternalForm());\n```\n\n\u4ed5\u7d44\u307f\u306f\u3088\u304f\u308f\u304b\u3063\u3066\u306a\u3044\u3051\u3069\u3001\u3053\u3046\u3059\u308c\u3070 jar \u3068\u3057\u3066\u5b9f\u884c\u3057\u3066\u3044\u308b\u300c\u3053\u306e war \u30d5\u30a1\u30a4\u30eb\u306e\u5834\u6240\u300d\u304c\u53d6\u5f97\u3067\u304d\u308b\u3089\u3057\u3044\u3002\n\n###war \u30d5\u30a1\u30a4\u30eb\u3092\u300c\u5b9f\u884c\u53ef\u80fd jar \u5f62\u5f0f\u300d\u306b\u3059\u308b\u65b9\u6cd5\n```groovy:build.gradle\nwar {\n    // 1\n    from {\n        configurations.providedCompile.collect {\n            it.isDirectory() ? it : project.zipTree(it)\n        }\n    }\n    \n    // 2\n    from fileTree(dir: 'build/classes/main', include: '**/Main.class')\n    \n    // 3\n    manifest.attributes('Main-Class': 'sample.jetty.Main')\n}\n```\n\n1. jetty \u304a\u3088\u3073\u305d\u306e\u4f9d\u5b58\u5bfe\u8c61\u3092 war \u306e\u76f4\u4e0b\u306b\u5c55\u958b\u3057\u3066\u3044\u308b\u3002\n2. \u8d77\u52d5\u7528\u306e Main \u30af\u30e9\u30b9\u3092 war \u306e\u76f4\u4e0b\u306b\u5c55\u958b\u3057\u3066\u3044\u308b\u3002\n3. \u30de\u30cb\u30d5\u30a7\u30b9\u30c8\u30d5\u30a1\u30a4\u30eb\u306b Main \u30af\u30e9\u30b9\u3092\u5b9a\u7fa9\u3057\u3066\u3044\u308b\u3002\n\nwar \u30d5\u30a1\u30a4\u30eb\u3092\u89e3\u51cd\u3059\u308b\u3068\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u69cb\u6210\u306b\u306a\u3063\u3066\u3044\u308b\u3002\n\n```text:\njetty-sample/\n\u2502\n\u2502  about.html\n\u2502  jetty-dir.css\n\u2502  jndi.properties\n\u251cjavax/\n\u2502  \u251cannotation/\n\u2502  \u2514servlet/\n\u251corg/\n\u2502  \u251ceclipse/\n\u2502  \u2502  \u2514jetty/\n\u2502  \u2514objectweb/\n\u2502      \u2514asm/\n\u251cMETA-INF/\n\u2502  \u2514MANIFEST.MF\n\u251csample/\n\u2502  \u2514jetty/\n\u2502     Main.class\n\u2502\n\u2514WEB-INF/\n    \u2514classes/\n        \u2514sample/\n            \u2514jetty/\n               Main.class\n               SampleServlet.class\n```\n\n\u5b9f\u884c\u53ef\u80fd jar \u3068\u3057\u3066\u306e\u69cb\u6210\u3068 war \u3068\u3057\u3066\u306e\u69cb\u6210\u304c\u3054\u3061\u3083\u6df7\u305c\u306b\u306a\u3063\u305f\u69cb\u9020\u306b\u306a\u3063\u3066\u3044\u308b\u3002\n\n\u3064\u307e\u308a\u3001\u5f53\u7136 `http://localhost:1234/sample/abount.html` \u3068\u304b `http://localhost:1234/sample/org/eclipse/jetty/server/Server.class` \u306b\u30a2\u30af\u30bb\u30b9\u3059\u308b\u3068\u3001\u5f53\u8a72\u30d5\u30a1\u30a4\u30eb\u304c\u4e38\u898b\u3048\u306b\u306a\u3063\u3066\u3044\u308b\u3002\n\n![jetty.JPG](https://qiita-image-store.s3.amazonaws.com/0/28302/29c56b3a-e083-6954-cacb-d2fee53e1c3f.jpeg)\n\n\u3084\u3084\u683c\u597d\u60aa\u3044\u3051\u3069\u3001\u6211\u6162\u3059\u308b\u304b\u3001\u3069\u3046\u3057\u3066\u3082\u5acc\u306a\u3089 Filter \u3092\u4f5c\u3063\u3066\u3001\u898b\u3089\u308c\u305f\u304f\u306a\u3044\u30d1\u30b9\u3078\u306e\u30a2\u30af\u30bb\u30b9\u306f\u5168\u90e8 404 \u306b\u3057\u3066\u3057\u307e\u3046\u3068\u3044\u3046\u65b9\u6cd5\u3082\u3042\u308a\u304b\u306a\u3068\u3002\n\n#web \u30d5\u30a9\u30eb\u30c0\u3092\u6307\u5b9a\u3059\u308b\n```java:Main.java\npackage sample.jetty;\n\nimport java.net.URL;\nimport java.security.ProtectionDomain;\n\nimport org.eclipse.jetty.annotations.AnnotationConfiguration;\nimport org.eclipse.jetty.plus.webapp.EnvConfiguration;\nimport org.eclipse.jetty.plus.webapp.PlusConfiguration;\nimport org.eclipse.jetty.server.Server;\nimport org.eclipse.jetty.webapp.Configuration;\nimport org.eclipse.jetty.webapp.FragmentConfiguration;\nimport org.eclipse.jetty.webapp.JettyWebXmlConfiguration;\nimport org.eclipse.jetty.webapp.MetaInfConfiguration;\nimport org.eclipse.jetty.webapp.WebAppContext;\nimport org.eclipse.jetty.webapp.WebInfConfiguration;\nimport org.eclipse.jetty.webapp.WebXmlConfiguration;\n\npublic class Main {\n    public static void main(String[] args) throws Exception {\n        WebAppContext war = new WebAppContext();\n        war.setContextPath(\"/sample\");\n        war.setResourceBase(\"src/main/webapp\");\n\n        Configuration[] configurations = {\n            new AnnotationConfiguration(),\n            new WebInfConfiguration(),\n            new WebXmlConfiguration(),\n            new MetaInfConfiguration(),\n            new FragmentConfiguration(),\n            new EnvConfiguration(),\n            new PlusConfiguration(),\n            new JettyWebXmlConfiguration()\n        };\n\n        war.setConfigurations(configurations);\n\n        Server server = new Server(1234);\n        server.setHandler(war);\n        server.start();\n        server.join();\n    }\n}\n```\n\n- `WebAppContext#setResourceBase(path)` \u3067\u3001 web \u30d5\u30a9\u30eb\u30c0\u3092\u6307\u5b9a\u3057\u3066\u8d77\u52d5\u3067\u304d\u308b\u3002\n\n__\u53c2\u8003__\n\n- [Tomcat\u304b\u3089Jetty\u3078 - Narwhal](http://d.hatena.ne.jp/nosa1/20120124/1327397386)\n\n\n\n#\u53c2\u8003\n- [Chapter 25. Embedding | Jetty : The Definitive Reference](http://www.eclipse.org/jetty/documentation/current/embedding-jetty.html)\n- [java - Embedding Jetty as a Servlet Container - Stack Overflow](http://stackoverflow.com/questions/17246512/embedding-jetty-as-a-servlet-container)\n- [jetty-project/embedded-servlet-3.1 | GitHub](https://github.com/jetty-project/embedded-servlet-3.1)\n- [Linked Java: Executable Wars with Gradle and Jetty](http://linkedjava.blogspot.jp/2012/05/executable-wars-with-gradle-and-jetty.html)\n- [Executable WARs with Jetty | EclipseSource Blog](http://eclipsesource.com/blogs/2009/10/02/executable-wars-with-jetty/)\n", "tags": ["Java", "jetty", "gradle"]}