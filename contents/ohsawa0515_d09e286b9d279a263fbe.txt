{"tags": ["AWS", "Cloudtrail", "CloudWatch"], "context": " More than 1 year has passed since last update.AWS\u306eAPI\u30b3\u30fc\u30eb\u3092CloudTrail\u3067\u8a18\u9332\u3057\u3001CloudWatch Logs\u3067\u4fdd\u7ba1\u3057\u3066\u3044\u308b\u3002\n\u77ed\u671f\u306e\u5c65\u6b74\u3092\u691c\u7d22\u3059\u308b\u5834\u5408\u306fCloudTrail\u304c\u7c21\u5358\u3060\u304c\u30011\u9031\u9593\u4ee5\u4e0a\u524d\u306e\u5c65\u6b74\u3084\u8a73\u7d30\u691c\u7d22\u306a\u3069\u3057\u305f\u3044\u5834\u5408\u306fCloudWatch Logs\u304b\u3089\u691c\u7d22\u3057\u3066\u3044\u308b\u3002\nCloudWatch Logs\u306e\u691c\u7d22\u306f\u30d5\u30a3\u30eb\u30bf\u306e\u69cb\u6587\u3092\u4f7f\u3046\u5fc5\u8981\u304c\u3042\u308a\u3001\u691c\u7d22\u3057\u3065\u3089\u3044\u3002\n\u305d\u3053\u3067\u3088\u304f\u4f7f\u3063\u3066\u3044\u308b\u691c\u7d22\u30d5\u30a3\u30eb\u30bf\u30d1\u30bf\u30fc\u30f3\u3092\u5217\u6319\u3057\u3066\u307f\u308b\u3002\n\n\u30a4\u30d9\u30f3\u30c8\u540d\u6307\u5b9a\n\u4f8b) EC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u8d77\u52d5\u306e\u30a4\u30d9\u30f3\u30c8\u3092\u6307\u5b9a\u3059\u308b\u5834\u5408\n{ $.eventName = \"StartInstances\" }\n\n\n\u30a4\u30d9\u30f3\u30c8\u30bd\u30fc\u30b9\u6307\u5b9a\n\u4f8b) EC2\u306b\u95a2\u3059\u308b\u30ea\u30bd\u30fc\u30b9\u3092\u6307\u5b9a\u3059\u308b\u5834\u5408\n{ $.eventSource = \"ec2.amazonaws.com\" }\n\n\n\u30e6\u30fc\u30b6\u3092\u6307\u5b9a\n\u7279\u5b9a\u306e\u30e6\u30fc\u30b6\u304c\u4f55\u3092\u3057\u305f\u304b\u3092\u8abf\u3079\u305f\u3044\u3068\u304d\u306b\u4f7f\u3046\u3002\n{ $.userIdentity.userName = \"<\u30e6\u30fc\u30b6\u540d>\" }\n\n\n\u30a2\u30af\u30bb\u30b9\u5143IP\u30a2\u30c9\u30ec\u30b9\u3092\u6307\u5b9a\n\u3069\u3053\u304b\u3089\u306eIP\u30a2\u30c9\u30ec\u30b9\u304b\u3089\u64cd\u4f5c\u3057\u3066\u3044\u308b\u304b\u3092\u8abf\u3079\u305f\u3044\u6642\u306b\u4f7f\u3046\u3002\n{ $.sourceIPAddress = \"xxx.xxx.xxx.xxx\" }\n\n\n\u30de\u30cd\u30b8\u30e1\u30f3\u30c8\u30b3\u30f3\u30bd\u30fc\u30eb\u3078\u306e\u30ed\u30b0\u30a4\u30f3\u5931\u6557\n{ $.responseElements.ConsoleLogin = \"Failure\" }\n\n\n\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9ID\u6307\u5b9a\n{ $.requestParameters.filterSet.items[0].valueSet.items[0].value = \"i-xxxxxxxx\" }\n\n\n\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\n\n\u30d5\u30a3\u30eb\u30bf\u3068\u30d1\u30bf\u30fc\u30f3\u306e\u69cb\u6587\n\n\nAWS\u306eAPI\u30b3\u30fc\u30eb\u3092CloudTrail\u3067\u8a18\u9332\u3057\u3001CloudWatch Logs\u3067\u4fdd\u7ba1\u3057\u3066\u3044\u308b\u3002\n\u77ed\u671f\u306e\u5c65\u6b74\u3092\u691c\u7d22\u3059\u308b\u5834\u5408\u306fCloudTrail\u304c\u7c21\u5358\u3060\u304c\u30011\u9031\u9593\u4ee5\u4e0a\u524d\u306e\u5c65\u6b74\u3084\u8a73\u7d30\u691c\u7d22\u306a\u3069\u3057\u305f\u3044\u5834\u5408\u306fCloudWatch Logs\u304b\u3089\u691c\u7d22\u3057\u3066\u3044\u308b\u3002\nCloudWatch Logs\u306e\u691c\u7d22\u306f\u30d5\u30a3\u30eb\u30bf\u306e\u69cb\u6587\u3092\u4f7f\u3046\u5fc5\u8981\u304c\u3042\u308a\u3001\u691c\u7d22\u3057\u3065\u3089\u3044\u3002\n\u305d\u3053\u3067\u3088\u304f\u4f7f\u3063\u3066\u3044\u308b\u691c\u7d22\u30d5\u30a3\u30eb\u30bf\u30d1\u30bf\u30fc\u30f3\u3092\u5217\u6319\u3057\u3066\u307f\u308b\u3002\n\n## \u30a4\u30d9\u30f3\u30c8\u540d\u6307\u5b9a\n\n\u4f8b) EC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u8d77\u52d5\u306e\u30a4\u30d9\u30f3\u30c8\u3092\u6307\u5b9a\u3059\u308b\u5834\u5408\n\n```\n{ $.eventName = \"StartInstances\" }\n```\n\n## \u30a4\u30d9\u30f3\u30c8\u30bd\u30fc\u30b9\u6307\u5b9a\n\n\u4f8b) EC2\u306b\u95a2\u3059\u308b\u30ea\u30bd\u30fc\u30b9\u3092\u6307\u5b9a\u3059\u308b\u5834\u5408\n\n```\n{ $.eventSource = \"ec2.amazonaws.com\" }\n```\n\n## \u30e6\u30fc\u30b6\u3092\u6307\u5b9a\n\n\u7279\u5b9a\u306e\u30e6\u30fc\u30b6\u304c\u4f55\u3092\u3057\u305f\u304b\u3092\u8abf\u3079\u305f\u3044\u3068\u304d\u306b\u4f7f\u3046\u3002\n\n```\n{ $.userIdentity.userName = \"<\u30e6\u30fc\u30b6\u540d>\" }\n```\n\n## \u30a2\u30af\u30bb\u30b9\u5143IP\u30a2\u30c9\u30ec\u30b9\u3092\u6307\u5b9a\n\n\u3069\u3053\u304b\u3089\u306eIP\u30a2\u30c9\u30ec\u30b9\u304b\u3089\u64cd\u4f5c\u3057\u3066\u3044\u308b\u304b\u3092\u8abf\u3079\u305f\u3044\u6642\u306b\u4f7f\u3046\u3002\n\n```\n{ $.sourceIPAddress = \"xxx.xxx.xxx.xxx\" }\n```\n\n## \u30de\u30cd\u30b8\u30e1\u30f3\u30c8\u30b3\u30f3\u30bd\u30fc\u30eb\u3078\u306e\u30ed\u30b0\u30a4\u30f3\u5931\u6557\n\n```\n{ $.responseElements.ConsoleLogin = \"Failure\" }\n```\n\n## \u30a4\u30f3\u30b9\u30bf\u30f3\u30b9ID\u6307\u5b9a\n\n```\n{ $.requestParameters.filterSet.items[0].valueSet.items[0].value = \"i-xxxxxxxx\" }\n```\n\n## \u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\n\n* [\u30d5\u30a3\u30eb\u30bf\u3068\u30d1\u30bf\u30fc\u30f3\u306e\u69cb\u6587](https://docs.aws.amazon.com/ja_jp/AmazonCloudWatch/latest/DeveloperGuide/FilterAndPatternSyntax.html)\n\n"}