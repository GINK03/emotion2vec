{"context": " More than 1 year has passed since last update.\u3053\u3093\u306b\u3061\u306f\u3002\n\u79c1\u306fD\u8a00\u8a9e\u3067\u66f8\u304f\u300cXlib\u300d\u306b\u3064\u3044\u3066\u66f8\u304b\u305b\u3066\u3044\u305f\u3060\u304d\u305f\u3044\u3068\u601d\u3044\u307e\u3059\u3002\n\u305d\u308c\u3067\u306f\u65e9\u901f...\u305d\u3082\u305d\u3082\u306e\u8a71\u3001Xlib \u3063\u3066\u4f55\u306a\u306e\u3067\u3057\u3087\u3046\u304b\u3002\n\nXlib\u3068\u306f\nX Window System \u3068\u3044\u3046UNIX-OS\u306eGUI\u3092\u53f8\u308b\u30d7\u30ed\u30b3\u30c8\u30eb\u304c\u3042\u3063\u3066\u3001Xlib\u306fC\u3067\u8a18\u8ff0\u3055\u308c\u305f\u3001\u305d\u306e\u5e95\u8fba\u30e9\u30a4\u30d6\u30e9\u30ea\u3067\u3059\u3002\u300c\u5e95\u8fba\u300d\u3068\u805e\u304f\u3068\u805e\u3053\u3048\u304c\u60aa\u3044\u3067\u3059\u304c\u3001\u8981\u3059\u308b\u306bQt\u3084GTK+\u306a\u3069\u4e0a\u4f4d\u30c4\u30fc\u30eb\u30ad\u30c3\u30c8\u306e\u8e0f\u307f\u53f0\u3068\u306a\u3063\u3066\u3044\u308b\u306e\u3067\u3059\u3002\n\u305d\u308c\u3092\u76f4\u63a5\u66f8\u304f\u3068\u3044\u3046\u3053\u3068\u306f\u3001Win32API\u3092\u53e9\u304f\u3068\u601d\u3046\u3068\u5206\u304b\u308a\u3084\u3059\u3044\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u3002\u3067\u3082\u305f\u3076\u3093\u3001\u305d\u308c\u3088\u308a\u305a\u3063\u3068\u7c21\u5358\u3002\n\n\u4f55\u3067Xlib\u306a\u306e\nQt\u3084GTK+\u304cXlib\u3092\u8e0f\u307f\u53f0\u306b\u3057\u3066\u3044\u308b\u3068\u8a00\u3063\u305f\u3088\u3046\u306b\u3001\u305d\u306e\u4e2d\u8eab\u3092\u77e5\u308b\u305f\u3081\u306b\u306fXlib\u306e\u77e5\u8b58\u304c\u6b20\u304b\u305b\u307e\u305b\u3093\u3002\u307e\u305f\u3001Xlib\u306e\u66f8\u7c4d\u3092\u8aad\u3093\u3067\u307f\u308b\u3068X Window System \u3068\u306e\u901a\u4fe1\u306b\u3064\u3044\u3066\u7d30\u304b\u304f\u89e6\u308c\u3089\u308c\u308b\u3053\u3068\u304c\u3088\u304f\u3042\u308a\u307e\u3059\u3002\u5e95\u8fba\u3086\u3048\u3067\u3059\u304b\u306d\u3002\u3057\u304b\u3057\u3001\u66f8\u7c4d\u306f\u53e4\u3044\u306e\u3057\u304b\u306a\u304f\u3001\u56f3\u66f8\u9928\u306b\u884c\u3063\u3066\u6c42\u3081\u308b\u3050\u3089\u3044\u3067\u3057\u304b\u7c21\u5358\u306b\u624b\u306b\u5165\u3089\u306a\u304f\u306a\u3063\u3066\u3044\u308b\u306e\u304c\u73fe\u72b6\u3067\u3059\u3002\n\u306a\u306e\u3067\u4eca\u304b\u3089Xlib\u3092\u4f7f\u3063\u3066\u30a2\u30d7\u30ea\u958b\u767a\u3092\u3057\u3088\u3046\uff01\u3000\u3068\u3044\u3046\u6d41\u308c\u306b\u306f\u306a\u3089\u306a\u3044\u3068\u601d\u3044\u307e\u3059\u3002\u8981\u3059\u308b\u306b\u5b66\u7fd2\u7528\u3067\u3059\u3002\u3057\u304b\u3057\u3001\u7c21\u5358\u306a\u30d7\u30ed\u30b0\u30e9\u30e0\u3092\u66f8\u304f\u306e\u306f\u697d\u3057\u3044\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u3002\u79c1\u306f\u300coneko\u300d\u3068\u3044\u3046\u30b8\u30e7\u30fc\u30af\u30d7\u30ed\u30b0\u30e9\u30e0\u304b\u3089Xlib\u306e\u5b58\u5728\u3092\u77e5\u3063\u305f\u306e\u3067\u3059\u304c\u3001\u30bd\u30fc\u30b9\u3092\u8997\u3044\u3066\u307f\u308b\u3068\u306a\u304b\u306a\u304b\u697d\u3057\u3044\u3082\u306e\u304c\u3042\u308a\u307e\u3059\u3002\u4eca\u56de\u306f\u3001\u300coneko\u300d\u306b\u8fd1\u3065\u304f\u89b3\u70b9\u304b\u3089Xlib\u306b\u8feb\u3063\u3066\u884c\u304d\u305f\u3044\u3068\u601d\u3044\u307e\u3059\u3002\n\n\u3067\u3082\u305d\u308d\u305d\u308dD\u306e\u8a71\u3092...\nD\u8a00\u8a9e Advent Calendar 1\u65e5\u76ee \u3067repeatedly \u3055\u3093\u304b\u3089\u304a\u8a71\u304c\u3042\u3063\u305f\u3088\u3046\u306b\u3001C\u30e9\u30c3\u30d1\u30fc\u306e\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306b\u300cDeimos\u300d\u3068\u3044\u3046\u3082\u306e\u304c\u3042\u308a\u3001Member \u306b\u306f\u3001repeatedly \u3055\u3093\u3068shoo \u3055\u3093\u304c\u53c2\u52a0\u3055\u308c\u3066\u3044\u307e\u3059\u3002Xlib\u306eD\u30d0\u30a4\u30f3\u30c7\u30a3\u30f3\u30b0\u306f\u3053\u306e\u4e2d\u306b\u3042\u308a\u307e\u3059\u3002\n\u3055\u3066\u3001\u9045\u304f\u306a\u308a\u307e\u3057\u305f\u304c\u30b3\u30fc\u30c9\u306e\u65b9\u3092\u898b\u3066\u307f\u307e\u3059\u3002\u307e\u305a\u306f\u30a6\u30a3\u30f3\u30c9\u30a6\u3092\u8868\u793a\u3059\u308b\u3060\u3051\u3002GUI\u306b\u304a\u3051\u308b\"Hello World.\"\u3067\u3059\u306d\u3002C\u306e\u30b3\u30fc\u30c9\u3068\u6bd4\u8f03\u3057\u306a\u304c\u3089\u3001D\u3067\u66f8\u304f\u969b\u306e\u6ce8\u610f\u70b9\u3092\u898b\u3066\u3044\u304d\u307e\u3059\u3002\n\nmain.d\nimport deimos.X11.X;\nimport deimos.X11.Xlib;\nimport deimos.X11.Xutil;\n\nvoid main()\n{\n    Display* dpy;\n    Window root;\n    Window win;\n    int screen;\n    uint black, white;\n    XEvent e;\n\n    dpy = XOpenDisplay(null);\n\n    root = DefaultRootWindow(*dpy);\n    screen = DefaultScreen(*dpy);\n\n    white = WhitePixel(*dpy, screen);\n    black = BlackPixel(*dpy, screen);\n\n    win = XCreateSimpleWindow(dpy, root, 32, 32, 64, 64, 2, black, white);\n\n    XSelectInput(dpy, win, EventMask.KeyPressMask);\n\n    XMapWindow(dpy, win);\n    XMoveWindow(dpy, win, 32, 32);\n\n    XFlush(dpy);\n\n    while(true){\n        XNextEvent(dpy, &e);\n\n        switch(e.type){\n            case EventType.KeyPress:\n                XDestroyWindow(dpy, win);\n                XCloseDisplay(dpy);\n                return;\n            default:\n        }\n    }\n}\n\n\n\nmain.c\n#include <X11/Xlib.h>\n#include <X11/Xutil.h>\n\nint main(){\n    Display *dpy;\n    Window root;\n    Window win;\n    int screen;\n    unsigned long black, white;\n    XEvent e;\n\n    dpy = XOpenDisplay(\"\");\n\n    root = DefaultRootWindow(dpy);\n    screen = DefaultScreen(dpy);\n\n    white = WhitePixel(dpy, screen);\n    black = BlackPixel(dpy, screen);\n\n    win = XCreateSimpleWindow(dpy, root, 32, 32, 64, 64, 2, black, white);\n\n    XSelectInput(dpy, win, KeyPressMask);\n\n    XMapWindow(dpy, win);\n    XMoveWindow(dpy, win, 32, 32);\n\n    XFlush(dpy);\n\n    while(1){\n        XNextEvent(dpy, &e);\n\n        switch(e.type){\n            case KeyPress:\n                XDestroyWindow(dpy, win);\n                XCloseDisplay(dpy);\n                return 0;\n        }\n    }\n}\n\n\n\u3068\u8a00\u3063\u3066\u30822\u3064\u304f\u3089\u3044\u3067\u3059\u3002\n\u307e\u305aimport\u90e8\u5206\u3067\u3059\u3002C\u306e#include\u306fpublic\u306b\u5bfe\u3057\u3066D\u306eimport\u306fprivate\u306a\u306e\u3067\u3001C\u306eX.h\u306b\u5f53\u305f\u308b\u90e8\u5206\u3082\u53d6\u3063\u3066\u304f\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\n\u6b21\u306b\u5b9a\u6570\u3067\u3059\u3002Deimos \u306elibX11\u306b\u8a18\u8ff0\u3055\u308c\u3066\u3044\u308benum\u306f\u540d\u524d\u4ed8\u304d\u5217\u6319\u4f53\u306a\u306e\u3067\u3001\u305d\u306e\u5b9a\u6570\u306e\u578b\u3092\u8abf\u3079\u3066\u304f\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\n...\u4ed8\u3051\u8db3\u3059\u3068\u3057\u305f\u3089\u30d0\u30b0\u304c\u3042\u308b\u3068\u3053\u308d\u3067\u3059\u3002\u73fe\u5728\u3001\u3042\u308b\u95a2\u6570\u7fa4\u306f\u4f7f\u3046\u3068SIGSEGV\u3092\u3082\u3089\u3063\u3066\u3057\u307e\u3044\u307e\u3059\u3002\nProgram received signal SIGSEGV, Segmentation fault.\n0x00000000 in ?? ()\n\u3053\u308c\u306fgdb\u3067\u306e\u7d50\u679c\u3067\u3059\u3002\u4eca\u539f\u56e0\u3092\u8003\u3048\u3066\u3044\u308b\u306e\u3067\u3059\u304c\u3001\u3044\u307e\u3044\u3061\u89e3\u6c7a\u306b\u307e\u3067\u81f3\u3063\u3066\u3044\u307e\u305b\u3093\u3002\u3082\u3057\u5206\u304b\u308b\u65b9\u304c\u3044\u308c\u3070\u6295\u3052\u3066\u304f\u308c\u308b\u3068\u5b09\u3057\u3044\u3067\u3059\u3002\nmake\u6642\u306e\u30d0\u30b0\u3082\u3042\u3063\u305f\u308a\u3067\u3001\u81ea\u5206\u306f\u3072\u3068\u3064\u306e\u307f\u8a02\u6b63\u3057\u305f\u306e\u3067\u3059\u304c\u3001\u4ed6\u306e\u65b9\u306b\u3082\u898b\u3066\u3044\u305f\u3060\u3051\u308b\u3068\u3044\u3044\u306a\u3042\u3001\u3068\u3044\u3046\u306e\u304c\u500b\u4eba\u7684\u306a\u611f\u60f3\u3067\u3059\u3002\u5bc2\u3057\u3044\u958b\u767a\u901f\u5ea6\u3067\u3059\u3002\n\u307e\u305f\u3001\u30d0\u30b0\u3067\u306f\u306a\u3044\u306e\u3067\u3059\u304c\u3001\u307e\u3060\u4e2d\u8eab\u304c\u5145\u5b9f\u3057\u3066\u3044\u306a\u3044\u5370\u8c61\u3067\u3059\u3002extensions\u306eshape\u3082\u306a\u3044\u306e\u3067\u3001\u300coneko\u300d\u3082\u66f8\u3051\u306a\u3044\u72b6\u6cc1\u3067\u3059\u3002\u3053\u308c\u306b\u95a2\u3057\u3066\u306f\u3001\u30b5\u30fc\u30c9\u30d1\u30fc\u30c6\u30a3\u306b\u304a\u4efb\u305b\u3057\u3066\u3044\u308b\u307f\u305f\u3044\u306a\u306e\u3067\u3001\u3069\u3057\u3069\u3057\u8ca2\u732e\u3057\u305f\u3044\u3067\u3059\u3002\n\u30b3\u30f3\u30d1\u30a4\u30eb\u306b\u3064\u3044\u3066\u3067\u3059\u304c\u3001make\u6642\u306b\u751f\u6210\u3055\u308c\u305fPKG-CONFIG\u7528\u30d5\u30a1\u30a4\u30eb\u306f\u3001dmd\u306b\u306f\u5408\u3063\u3066\u3044\u307e\u305b\u3093\u3002\u4ed6\u306e\u30b3\u30f3\u30d1\u30a4\u30e9\u306b\u3064\u3044\u3066\u306f\u3088\u304f\u5206\u304b\u3063\u3066\u3044\u306a\u3044\u306e\u3067\u3059\u304c\u3001\u3053\u3093\u306a\u98a8\u306b\u76f4\u3057\u307e\u3059\u3002\nLibs: -L/usr/local/lib -L-lDX11-dmd\n\u3053\u308c\u3092\nLibs: -L-L/usr/local/lib -L-lDX11-dmd\n\u3053\u3046(\u672c\u6765\u306fMakefile\u304b\u3089\u76f4\u3059\u3079\u304d\u3067\u3059\u304c...)\u3002\n\u305d\u3046\u3059\u308c\u3070\u3001dmd main.d `pkg-config --libs --clags DX11` -L-lX11 \u3067\u30b3\u30f3\u30d1\u30a4\u30eb\u3067\u304d\u307e\u3059\u3002\n\n\u7c21\u5358\u306a\u30b8\u30e7\u30fc\u30af\u30d7\u30ed\u30b0\u30e9\u30e0\u306e\u4f8b\n\u300coneko\u300d\u306b\u3064\u3044\u3066\u8003\u3048\u3066\u307f\u307e\u3057\u3087\u3046\u3002xbm\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u304b\u3089\u732b\u306e\u753b\u50cf\u3092\u6301\u3063\u3066\u304d\u3066\u3001\u30de\u30a6\u30b9\u3092\u8ffd\u3044\u304b\u3051\u307e\u3059\u3002xbm\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u306f\u3001C\u304b\u3089include\u3059\u308b\u306e\u306b\u3074\u3063\u305f\u308a\u306a\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u306e\u5f62\u3067\u3059\u304c\u3001D\u3067\u5229\u7528\u3059\u308b\u5834\u5408\u3069\u306e\u3088\u3046\u306b\u66f8\u3051\u308b\u3067\u3057\u3087\u3046\u304b\u3002\n\u4eca\u56de\u3001D\u8a00\u8a9e\u30de\u30b9\u30b3\u30c3\u30c8\u30ad\u30e3\u30e9\u30af\u30bf\u304c\u30de\u30a6\u30b9\u3092\u8ffd\u3044\u304b\u3051\u3066\u304f\u308b\u30b8\u30e7\u30fc\u30af\u30a2\u30d7\u30ea\u3092\u8003\u3048\u3066\u307f\u307e\u3059\uff08\u6df1\u591c\u306b\u52d5\u4f5c\u78ba\u8a8d\u3057\u305f\u306e\u3067\u3059\u304c\u3059\u3054\u304f\u6016\u304b\u3063\u305f\u3067\u3059...)\u3002\n\u30ab\u30e9\u30fc\u60c5\u5831\u304c\u5931\u308f\u308c\u308b\u3068\u5bc2\u3057\u3044\u306e\u3067\u3001xpm\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u3067\u884c\u3044\u307e\u3059\u3002\u6700\u3082png\u3084jpeg\u306a\u3069\u306e\u4e00\u822c\u7684\u306a\u753b\u50cf\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u3067\u884c\u3046\u306e\u304c\u9069\u5f53\u306a\u306e\u3067\u3057\u3087\u3046\u304c\u3001\u582a\u5fcd\u3057\u3066\u304f\u3060\u3055\u3044\u3002\nD\u8a00\u8a9e\u3067\u6271\u3046\u5834\u5408\u3001\u7d50\u5c40module\u3068\u3057\u3066\u6271\u308f\u306a\u3044\u3068\u3044\u3051\u306a\u3044\u306e\u3067\u3001\u601d\u3044\u5207\u3063\u3066\u66f8\u304d\u306a\u304a\u3057\u3066\u3057\u307e\u3044\u307e\u3059\u3002\n\nd_image.xpm\n/* XPM */\nstatic char * d3_xpm[] = {\n\"162 309 4 1\",\n\"   c None\",\n\".  c #000000\",\n\"+  c #FFFFFF\",\n\"@  c #FF0000\",\n\"\n/*...(\u305a\u3063\u3068\u7d9a\u3044\u3066\u3044\u304f*/\n\n\n\u3053\u308c\u3092\u3001\n\nd_image.d\n/* XPM */\nmodule resorce;  // \u30b3\u30b3\n\n       //\u30b3\u30b3\nstatic string[] d_image = [\n\"162 309 4 1\",\n\"   c None\",\n\".  c #000000\",\n\"+  c #FFFFFF\",\n\"@  c #FF0000\",\n\"\"\n// \u305a\u3063\u3068\u7d9a\u3044\u3066\u3044\u304f\n\n\n\u3053\u3046\u66f8\u304d\u63db\u3048\u3066\u3057\u307e\u3044\u307e\u3059\u3002\n\u6b21\u306b\u5229\u7528\u3059\u308b\u5074\u306e\u30d7\u30ed\u30b0\u30e9\u30e0\u3067\u3059\u3002\n\nmain.d\nimport deimos.X11.X;\nimport deimos.X11.Xlib;\nimport deimos.X11.Xutil;\n\n// \u753b\u50cf\u306e\u8aad\u307f\u8fbc\u307f\nimport resorce : d_image;\n\nextern(System){\n// \u81ea\u4f5c\u95a2\u6570\u3067\u4f7f\u3046\nstruct Hints{\n    ulong flags;\n    ulong functions;\n    ulong decorations;\n    long inputMode;\n    ulong status;\n}\n\nconst Atom XA_CARDINAL = cast(Atom)6;\n\n}\n\nimport std.stdio : chomp;\nimport std.string : split;\nimport std.conv : to;\nimport std.math;\nimport std.range;\nimport std.array;\n// \u6e21\u3055\u308c\u305fwin\u306b\u76f4\u63a5\u63cf\u753b\u3057\u3066\u3057\u307e\u3046\u3002\nvoid drawImage(Display* dpy, Window win, GC gc, string[] xpm){\n    // \u30d8\u30c3\u30c0\u60c5\u5831\u3092\u5165\u624b\u3059\u308b\u3002\n    string[] head = xpm[0].chomp.split;\n    int width = head[0].to!int;\n    int height = head[1].to!int;\n    int num = head[2].to!int;\n    uint clist[char];             // \u8272\u306e\u9023\u60f3\u914d\u5217\n\n    Colormap cmap = DefaultColormap(*dpy, DefaultScreen(*dpy));\n\n    // clist \u306e\u521d\u671f\u5316\n    for(int i=1; i<=num; ++i){\n        string[] str = xpm[i].chomp.split;\n        XColor color, exact;\n\n        if(str.length<3)continue;\n\n        char c = str.front[0];\n        str.popFront; str.popFront;\n        string name = str.front;\n        str.popFront;\n        assert(str.length==0);\n\n        XAllocNamedColor(dpy, cmap, name.toCString, &color, &exact);\n        uint d_color = color.pixel;\n\n        clist[c] = d_color;\n    }\n\n    // win \u3078\u306e\u63cf\u753b\u30021\u753b\u7d20\u305a\u3064\u898b\u3066\u3044\u304f\n    for(int y=0; y<height; ++y){\n        for(int x=0; x<width; ++x){\n            char c = xpm[(num+1)+y][x];\n            if((c in clist) != null){\n                uint d_color = clist[c];\n                XSetForeground(dpy, gc, d_color);\n                XDrawPoint(dpy, win, gc, x, y);\n            }\n        }\n    }\n}\n\nbool isEventTime(Display* dpy, EventType trg){\n    XEvent e;\n    XNextEvent(dpy, &e);\n\n    return e.type == trg;\n}\n\nvoid main(){\n    Display *dpy = XOpenDisplay(null);\n\n    Window root = DefaultRootWindow(*dpy);\n    uint white = WhitePixel(*dpy, DefaultScreen(*dpy));\n\n    Window win = XCreateSimpleWindow(dpy, root, 32, 32, 162, 309, 0, white, white);\n\n    GC gc = XCreateGC(dpy, win, 0, null);\n\n    // \u30a6\u30a3\u30f3\u30c9\u30a6\u88c5\u98fe\u306f\u30a6\u30a3\u30f3\u30c9\u30a6\u30de\u30cd\u30fc\u30b8\u30e3\u304c\u52dd\u624b\u306b\u3064\u3051\u3066\u304f\u308c\u305f\u3082\u306e\u3067\u3059\u3002\u4eca\u56de\u306f\u90aa\u9b54\u306b\u306a\u308b\u306e\u3067\u81ea\u4f5c\u95a2\u6570\u306b\u3066\u53d6\u308a\u9664\u304d\u307e\u3059\u3002\n    escape_decoration(dpy, win);\n\n    XSelectInput(dpy, win, EventMask.StructureNotifyMask);\n    XMapWindow(dpy, win);\n    // \u6700\u521d\u306e\u30de\u30c3\u30d7\u6642\u306b\u306f\u3001\u30a6\u30a3\u30f3\u30c9\u30a6\u30de\u30cd\u30fc\u30b8\u30e3\u306b\u3088\u3063\u3066\u5ea7\u6a19\u304c\u6c7a\u307e\u308b\u306e\u3067\u3001\u3082\u3046\u4e00\u56de\u52d5\u304b\u3059\u5fc5\u8981\u304c\u3042\u308b\u3002\n    XMoveWindow(dpy, win, 32, 32);\n    XFlush(dpy);\n\n    // \u30de\u30c3\u30d7\u304c\u5b8c\u4e86\u3055\u308c\u308b\u307e\u3067\u5f85\u3064\n    while(!isEventTime(dpy, EventType.MapNotify)){\n    }\n\n    while(true){\n        drawImage(dpy, win, gc, d_image);\n        XFlush(dpy);\n\n        // \u30de\u30a6\u30b9\u4f4d\u7f6e\u306e\u53d6\u5f97\n        Window q_root, q_child;\n        int AbsX, AbsY;\n        int RelX, RelY;\n        uint ModKeyMask;\n        XQueryPointer(dpy, win, &q_root, &q_child, &AbsX, &AbsY, &RelX, &RelY, &ModKeyMask);\n\n        // \u30a6\u30a3\u30f3\u30c9\u30a6\u4f4d\u7f6e\u306e\u53d6\u5f97\n        int x, y;\n        uint w, h, b, d;\n        XGetGeometry(dpy, win, &root, &x, &y, &w, &h, &b, &d);\n        double[2] v = [cast(double)(AbsX-(x+cast(int)w/2)), cast(double)(AbsY-(y+cast(int)h/2))];   // \u753b\u50cf\u304b\u3089\u30de\u30a6\u30b9\u3078\u306e\u65b9\u5411\u30d9\u30af\u30c8\u30eb\n\n        // \u8fd1\u3065\u304d\u3059\u304e\u305f\u3089\u7d42\u4e86\u3002\u9003\u3052\u308d\uff01\n        if(v.d < w/8.){\n            break;\n        }\n\n        v[]/=v.d;   // \u5358\u4f4d\u30d9\u30af\u30c8\u30eb\u3092\u6c42\u3081\u308b\n        v[]*=8.;    // \u8ddd\u96e28pixel\u3050\u3089\u3044\u306e\u901f\u3055\uff1f\n        int dx = cast(int)v[0];\n        int dy = cast(int)v[1];\n\n        XMoveWindow(dpy, win, x+dx, y+dy);\n    }\n\n    // \u30ea\u30bd\u30fc\u30b9\u306e\u958b\u653e\n    XFreeGC(dpy, gc);\n    XDestroyWindow(dpy, win);\n    XCloseDisplay(dpy);\n}\n\ndouble d(double[2] v){\n    return sqrt((v[0]*v[0] + v[1]*v[1]));\n}\n\nextern(System){\n    // SIGSEGV \u3092\u3082\u3089\u3063\u3066\u3057\u307e\u3046\u95a2\u6570\u306e\u4e00\u90e8\uff08\u4f7f\u3046\u306e\u3067\u8db3\u3059\uff09\n    Window DefaultRootWindow(ref Display dpy){\n        return ScreenOfDisplay( dpy,DefaultScreen( dpy ) ).root;\n    }\n    uint WhitePixel(ref Display dpy,int scr){\n        return cast(uint)ScreenOfDisplay( dpy,scr ).white_pixel;\n    }\n    Colormap DefaultColormap(ref Display dpy, int scr){\n        return ScreenOfDisplay(dpy, scr).cmap;\n    }\n}\n\nvoid escape_decoration(Display* dpy, Window win){\n    Hints hints;\n    Atom property;\n    hints.flags = 2;\n    hints.decorations = 0;\n    property = XInternAtom(dpy, \"_MOTIF_WM_HINTS\".toCString, Bool.True);\n    debug { writefln(\"%x\", property); }\n    XChangeProperty(dpy, win, property, property, 32, PropertyMode.PropModeReplace, cast(ubyte *)&hints, 5);\n}\n\nvoid set_opacity(Display* dpy, Window win, double opacity){\n    Atom property = XInternAtom(dpy, \"_NET_WM_WINDOW_OPACITY\".toCString, Bool.False);\n    const uint OPACITY = 0xffff_ffff;\n    uint real_opacity = cast(uint)(OPACITY * opacity);\n    XChangeProperty(dpy, win, property, XA_CARDINAL, 32, PropertyMode.PropModeReplace, cast(ubyte *)&real_opacity, 1);\n}\n\nchar* toCString(string str){\n    return (str ~ \"\\0\").dup.ptr;\n}\n\n\n...\u7279\u306bD\u8a00\u8a9e\u3089\u3057\u3044\u66f8\u304d\u65b9\u3092\u3057\u3066\u3044\u308b\u308f\u3051\u3067\u3082\u306a\u304f\u7533\u3057\u8a33\u306a\u3044\u3067\u3059\u3002\u3067\u3082\u9023\u60f3\u914d\u5217\u3084\u30d9\u30af\u30c8\u30eb\u6f14\u7b97\u304c\u3055\u3055\u3063\u3068\u304b\u3051\u3066\u3057\u307e\u3046\u306e\u306f\u6c17\u6301\u3061\u304c\u3044\u3044\u3067\u3059\u306d\u3002\u3059\u3050\u983c\u3063\u3066\u3057\u307e\u3044\u307e\u3059\u3002\n\u307e\u305f\u3001\u30d0\u30a4\u30f3\u30c7\u30a3\u30f3\u30b0\u306fC\u306e\u30e9\u30a4\u30d6\u30e9\u30ea\u95a2\u6570\u3092\u547c\u3073\u51fa\u3059\u95a2\u4fc2\u3067exturn\u5ba3\u8a00\u3057\u304b\u898b\u3048\u306a\u3044\u95a2\u6570\u3082\u3042\u308a\u3001CTFE\u304c\u3067\u304d\u307e\u305b\u3093\u3002\u3046\u3050\u3050\u3002\n\u3067\u3001\u5b9f\u884c\u6642\u306e\u753b\u50cf\u306f\u3053\u3093\u306a\u611f\u3058\u3067\u3059\u3002\n\n\n\u7d42\u308f\u308a\u306b\nD\u8a00\u8a9e\u304b\u3089\u5165\u308bXlib\u5165\u9580\u3068\u3044\u3046\u3053\u3068\u3067\u3057\u305f\u304c\u3001\u3044\u304b\u304c\u3060\u3063\u305f\u3067\u3057\u3087\u3046\u304b\u3002\u5c11\u3057\u3067\u3082\u8208\u5473\u3092\u6301\u3063\u3066\u3044\u305f\u3060\u3051\u305f\u3089\u5e78\u3044\u3067\u3059\u3002\u5b9f\u969b\u306b\u95a2\u6570\u306e\u3072\u3068\u3064\u3072\u3068\u3064\u306e\u52d5\u304d\u3092\u898b\u308b\u306a\u3089\u3001\u3053\u3061\u3089\u306e\u30b5\u30a4\u30c8\u306a\u3069\u304c\u304a\u3059\u3059\u3081\u3067\u3059(\u3082\u3061\u308d\u3093C)\u3002\u4ed6\u306b\u3082\u8abf\u3079\u308b\u3068\u7d50\u69cb\u51fa\u3066\u304f\u308b\u306e\u3067\u3001\u3084\u3063\u3066\u307f\u305f\u3044\u65b9\u306f\u305c\u3072\u305c\u3072\u3002\n\u307e\u305f\u3001Xlib\u306b\u9650\u3089\u305aDeimos\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306f\u3072\u3063\u305d\u308a\u3057\u3066\u3044\u308b\u5370\u8c61\u304c\u3042\u308b\u306e\u3067\u3001(\u305f\u3076\u3093\u307e\u3060\u4f7f\u3044\u52dd\u624b\u306f\u826f\u304f\u306a\u3044\u3068\u601d\u3046\u306e\u3067)\u958b\u767a\u304c\u76db\u308a\u4e0a\u304c\u308b\u3068\u3044\u3044\u306a\u3042\u3001\u3068\u601d\u3044\u307e\u3059\u3002\n\u660e\u65e5\u300119\u65e5\u306f@9rnsr\u3055\u3093\u3067\u3059\uff01\n\u3053\u3093\u306b\u3061\u306f\u3002\n\u79c1\u306fD\u8a00\u8a9e\u3067\u66f8\u304f\u300cXlib\u300d\u306b\u3064\u3044\u3066\u66f8\u304b\u305b\u3066\u3044\u305f\u3060\u304d\u305f\u3044\u3068\u601d\u3044\u307e\u3059\u3002\n\u305d\u308c\u3067\u306f\u65e9\u901f...\u305d\u3082\u305d\u3082\u306e\u8a71\u3001Xlib \u3063\u3066\u4f55\u306a\u306e\u3067\u3057\u3087\u3046\u304b\u3002\n\n##Xlib\u3068\u306f\nX Window System \u3068\u3044\u3046UNIX-OS\u306eGUI\u3092\u53f8\u308b\u30d7\u30ed\u30b3\u30c8\u30eb\u304c\u3042\u3063\u3066\u3001Xlib\u306fC\u3067\u8a18\u8ff0\u3055\u308c\u305f\u3001\u305d\u306e\u5e95\u8fba\u30e9\u30a4\u30d6\u30e9\u30ea\u3067\u3059\u3002\u300c\u5e95\u8fba\u300d\u3068\u805e\u304f\u3068\u805e\u3053\u3048\u304c\u60aa\u3044\u3067\u3059\u304c\u3001\u8981\u3059\u308b\u306bQt\u3084GTK+\u306a\u3069\u4e0a\u4f4d\u30c4\u30fc\u30eb\u30ad\u30c3\u30c8\u306e\u8e0f\u307f\u53f0\u3068\u306a\u3063\u3066\u3044\u308b\u306e\u3067\u3059\u3002\n\u305d\u308c\u3092\u76f4\u63a5\u66f8\u304f\u3068\u3044\u3046\u3053\u3068\u306f\u3001Win32API\u3092\u53e9\u304f\u3068\u601d\u3046\u3068\u5206\u304b\u308a\u3084\u3059\u3044\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u3002\u3067\u3082\u305f\u3076\u3093\u3001\u305d\u308c\u3088\u308a\u305a\u3063\u3068\u7c21\u5358\u3002\n\n##\u4f55\u3067Xlib\u306a\u306e\nQt\u3084GTK+\u304cXlib\u3092\u8e0f\u307f\u53f0\u306b\u3057\u3066\u3044\u308b\u3068\u8a00\u3063\u305f\u3088\u3046\u306b\u3001\u305d\u306e\u4e2d\u8eab\u3092\u77e5\u308b\u305f\u3081\u306b\u306fXlib\u306e\u77e5\u8b58\u304c\u6b20\u304b\u305b\u307e\u305b\u3093\u3002\u307e\u305f\u3001Xlib\u306e\u66f8\u7c4d\u3092\u8aad\u3093\u3067\u307f\u308b\u3068X Window System \u3068\u306e\u901a\u4fe1\u306b\u3064\u3044\u3066\u7d30\u304b\u304f\u89e6\u308c\u3089\u308c\u308b\u3053\u3068\u304c\u3088\u304f\u3042\u308a\u307e\u3059\u3002\u5e95\u8fba\u3086\u3048\u3067\u3059\u304b\u306d\u3002\u3057\u304b\u3057\u3001\u66f8\u7c4d\u306f\u53e4\u3044\u306e\u3057\u304b\u306a\u304f\u3001\u56f3\u66f8\u9928\u306b\u884c\u3063\u3066\u6c42\u3081\u308b\u3050\u3089\u3044\u3067\u3057\u304b\u7c21\u5358\u306b\u624b\u306b\u5165\u3089\u306a\u304f\u306a\u3063\u3066\u3044\u308b\u306e\u304c\u73fe\u72b6\u3067\u3059\u3002\n\u306a\u306e\u3067\u4eca\u304b\u3089Xlib\u3092\u4f7f\u3063\u3066\u30a2\u30d7\u30ea\u958b\u767a\u3092\u3057\u3088\u3046\uff01\u3000\u3068\u3044\u3046\u6d41\u308c\u306b\u306f\u306a\u3089\u306a\u3044\u3068\u601d\u3044\u307e\u3059\u3002\u8981\u3059\u308b\u306b\u5b66\u7fd2\u7528\u3067\u3059\u3002\u3057\u304b\u3057\u3001\u7c21\u5358\u306a\u30d7\u30ed\u30b0\u30e9\u30e0\u3092\u66f8\u304f\u306e\u306f\u697d\u3057\u3044\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u3002\u79c1\u306f\u300coneko\u300d\u3068\u3044\u3046\u30b8\u30e7\u30fc\u30af\u30d7\u30ed\u30b0\u30e9\u30e0\u304b\u3089Xlib\u306e\u5b58\u5728\u3092\u77e5\u3063\u305f\u306e\u3067\u3059\u304c\u3001\u30bd\u30fc\u30b9\u3092\u8997\u3044\u3066\u307f\u308b\u3068\u306a\u304b\u306a\u304b\u697d\u3057\u3044\u3082\u306e\u304c\u3042\u308a\u307e\u3059\u3002\u4eca\u56de\u306f\u3001\u300c__oneko__\u300d\u306b\u8fd1\u3065\u304f\u89b3\u70b9\u304b\u3089Xlib\u306b\u8feb\u3063\u3066\u884c\u304d\u305f\u3044\u3068\u601d\u3044\u307e\u3059\u3002\n\n##\u3067\u3082\u305d\u308d\u305d\u308dD\u306e\u8a71\u3092...\n[D\u8a00\u8a9e Advent Calendar 1\u65e5\u76ee](http://qiita.com/items/0960bc29b49722dc1d1f) \u3067repeatedly \u3055\u3093\u304b\u3089\u304a\u8a71\u304c\u3042\u3063\u305f\u3088\u3046\u306b\u3001C\u30e9\u30c3\u30d1\u30fc\u306e\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306b\u300cDeimos\u300d\u3068\u3044\u3046\u3082\u306e\u304c\u3042\u308a\u3001Member \u306b\u306f\u3001repeatedly \u3055\u3093\u3068shoo \u3055\u3093\u304c\u53c2\u52a0\u3055\u308c\u3066\u3044\u307e\u3059\u3002Xlib\u306eD\u30d0\u30a4\u30f3\u30c7\u30a3\u30f3\u30b0\u306f\u3053\u306e\u4e2d\u306b\u3042\u308a\u307e\u3059\u3002\n\u3055\u3066\u3001\u9045\u304f\u306a\u308a\u307e\u3057\u305f\u304c\u30b3\u30fc\u30c9\u306e\u65b9\u3092\u898b\u3066\u307f\u307e\u3059\u3002\u307e\u305a\u306f\u30a6\u30a3\u30f3\u30c9\u30a6\u3092\u8868\u793a\u3059\u308b\u3060\u3051\u3002GUI\u306b\u304a\u3051\u308b\"Hello World.\"\u3067\u3059\u306d\u3002C\u306e\u30b3\u30fc\u30c9\u3068\u6bd4\u8f03\u3057\u306a\u304c\u3089\u3001D\u3067\u66f8\u304f\u969b\u306e\u6ce8\u610f\u70b9\u3092\u898b\u3066\u3044\u304d\u307e\u3059\u3002\n\n```d:main.d\nimport deimos.X11.X;\nimport deimos.X11.Xlib;\nimport deimos.X11.Xutil;\n\nvoid main()\n{\n\tDisplay* dpy;\n\tWindow root;\n\tWindow win;\n\tint screen;\n\tuint black, white;\n\tXEvent e;\n\t\n\tdpy = XOpenDisplay(null);\n\t\n\troot = DefaultRootWindow(*dpy);\n\tscreen = DefaultScreen(*dpy);\n\t\n\twhite = WhitePixel(*dpy, screen);\n\tblack = BlackPixel(*dpy, screen);\n\t\n\twin = XCreateSimpleWindow(dpy, root, 32, 32, 64, 64, 2, black, white);\n\t\n\tXSelectInput(dpy, win, EventMask.KeyPressMask);\n\t\n\tXMapWindow(dpy, win);\n\tXMoveWindow(dpy, win, 32, 32);\n\t\n\tXFlush(dpy);\n\t\n\twhile(true){\n\t\tXNextEvent(dpy, &e);\n\t\t\n\t\tswitch(e.type){\n\t\t\tcase EventType.KeyPress:\n\t\t\t\tXDestroyWindow(dpy, win);\n\t\t\t\tXCloseDisplay(dpy);\n\t\t\t\treturn;\n\t\t\tdefault:\n\t\t}\n\t}\n}\n```\n\n```c:main.c\n#include <X11/Xlib.h>\n#include <X11/Xutil.h>\n\nint main(){\n\tDisplay *dpy;\n\tWindow root;\n\tWindow win;\n\tint screen;\n\tunsigned long black, white;\n\tXEvent e;\n\t\n\tdpy = XOpenDisplay(\"\");\n\t\n\troot = DefaultRootWindow(dpy);\n\tscreen = DefaultScreen(dpy);\n\t\n\twhite = WhitePixel(dpy, screen);\n\tblack = BlackPixel(dpy, screen);\n\t\n\twin = XCreateSimpleWindow(dpy, root, 32, 32, 64, 64, 2, black, white);\n\t\n\tXSelectInput(dpy, win, KeyPressMask);\n\t\n\tXMapWindow(dpy, win);\n\tXMoveWindow(dpy, win, 32, 32);\n\t\n\tXFlush(dpy);\n\t\n\twhile(1){\n\t\tXNextEvent(dpy, &e);\n\t\t\n\t\tswitch(e.type){\n\t\t\tcase KeyPress:\n\t\t\t\tXDestroyWindow(dpy, win);\n\t\t\t\tXCloseDisplay(dpy);\n\t\t\t\treturn 0;\n\t\t}\n\t}\n}\n```\n\n\u3068\u8a00\u3063\u3066\u30822\u3064\u304f\u3089\u3044\u3067\u3059\u3002\n\u307e\u305aimport\u90e8\u5206\u3067\u3059\u3002C\u306e#include\u306fpublic\u306b\u5bfe\u3057\u3066D\u306eimport\u306fprivate\u306a\u306e\u3067\u3001C\u306eX.h\u306b\u5f53\u305f\u308b\u90e8\u5206\u3082\u53d6\u3063\u3066\u304f\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\n\u6b21\u306b\u5b9a\u6570\u3067\u3059\u3002Deimos \u306elibX11\u306b\u8a18\u8ff0\u3055\u308c\u3066\u3044\u308benum\u306f\u540d\u524d\u4ed8\u304d\u5217\u6319\u4f53\u306a\u306e\u3067\u3001\u305d\u306e\u5b9a\u6570\u306e\u578b\u3092\u8abf\u3079\u3066\u304f\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\n...\u4ed8\u3051\u8db3\u3059\u3068\u3057\u305f\u3089\u30d0\u30b0\u304c\u3042\u308b\u3068\u3053\u308d\u3067\u3059\u3002\u73fe\u5728\u3001\u3042\u308b\u95a2\u6570\u7fa4\u306f\u4f7f\u3046\u3068SIGSEGV\u3092\u3082\u3089\u3063\u3066\u3057\u307e\u3044\u307e\u3059\u3002\n`Program received signal SIGSEGV, Segmentation fault.\n0x00000000 in ?? ()`\n\u3053\u308c\u306fgdb\u3067\u306e\u7d50\u679c\u3067\u3059\u3002\u4eca\u539f\u56e0\u3092\u8003\u3048\u3066\u3044\u308b\u306e\u3067\u3059\u304c\u3001\u3044\u307e\u3044\u3061\u89e3\u6c7a\u306b\u307e\u3067\u81f3\u3063\u3066\u3044\u307e\u305b\u3093\u3002\u3082\u3057\u5206\u304b\u308b\u65b9\u304c\u3044\u308c\u3070\u6295\u3052\u3066\u304f\u308c\u308b\u3068\u5b09\u3057\u3044\u3067\u3059\u3002\nmake\u6642\u306e\u30d0\u30b0\u3082\u3042\u3063\u305f\u308a\u3067\u3001\u81ea\u5206\u306f\u3072\u3068\u3064\u306e\u307f\u8a02\u6b63\u3057\u305f\u306e\u3067\u3059\u304c\u3001\u4ed6\u306e\u65b9\u306b\u3082\u898b\u3066\u3044\u305f\u3060\u3051\u308b\u3068\u3044\u3044\u306a\u3042\u3001\u3068\u3044\u3046\u306e\u304c\u500b\u4eba\u7684\u306a\u611f\u60f3\u3067\u3059\u3002\u5bc2\u3057\u3044\u958b\u767a\u901f\u5ea6\u3067\u3059\u3002\n\u307e\u305f\u3001\u30d0\u30b0\u3067\u306f\u306a\u3044\u306e\u3067\u3059\u304c\u3001\u307e\u3060\u4e2d\u8eab\u304c\u5145\u5b9f\u3057\u3066\u3044\u306a\u3044\u5370\u8c61\u3067\u3059\u3002extensions\u306eshape\u3082\u306a\u3044\u306e\u3067\u3001\u300c__oneko__\u300d\u3082\u66f8\u3051\u306a\u3044\u72b6\u6cc1\u3067\u3059\u3002\u3053\u308c\u306b\u95a2\u3057\u3066\u306f\u3001\u30b5\u30fc\u30c9\u30d1\u30fc\u30c6\u30a3\u306b\u304a\u4efb\u305b\u3057\u3066\u3044\u308b\u307f\u305f\u3044\u306a\u306e\u3067\u3001\u3069\u3057\u3069\u3057\u8ca2\u732e\u3057\u305f\u3044\u3067\u3059\u3002\n\n\u30b3\u30f3\u30d1\u30a4\u30eb\u306b\u3064\u3044\u3066\u3067\u3059\u304c\u3001make\u6642\u306b\u751f\u6210\u3055\u308c\u305fPKG-CONFIG\u7528\u30d5\u30a1\u30a4\u30eb\u306f\u3001dmd\u306b\u306f\u5408\u3063\u3066\u3044\u307e\u305b\u3093\u3002\u4ed6\u306e\u30b3\u30f3\u30d1\u30a4\u30e9\u306b\u3064\u3044\u3066\u306f\u3088\u304f\u5206\u304b\u3063\u3066\u3044\u306a\u3044\u306e\u3067\u3059\u304c\u3001\u3053\u3093\u306a\u98a8\u306b\u76f4\u3057\u307e\u3059\u3002\n`Libs: -L/usr/local/lib -L-lDX11-dmd`\n\u3053\u308c\u3092\n`Libs: -L-L/usr/local/lib -L-lDX11-dmd`\n\u3053\u3046(\u672c\u6765\u306fMakefile\u304b\u3089\u76f4\u3059\u3079\u304d\u3067\u3059\u304c...)\u3002\n\u305d\u3046\u3059\u308c\u3070\u3001dmd main.d \\`pkg-config --libs --clags DX11\\` -L-lX11 \u3067\u30b3\u30f3\u30d1\u30a4\u30eb\u3067\u304d\u307e\u3059\u3002\n\n##\u7c21\u5358\u306a\u30b8\u30e7\u30fc\u30af\u30d7\u30ed\u30b0\u30e9\u30e0\u306e\u4f8b\n\u300c__oneko__\u300d\u306b\u3064\u3044\u3066\u8003\u3048\u3066\u307f\u307e\u3057\u3087\u3046\u3002xbm\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u304b\u3089\u732b\u306e\u753b\u50cf\u3092\u6301\u3063\u3066\u304d\u3066\u3001\u30de\u30a6\u30b9\u3092\u8ffd\u3044\u304b\u3051\u307e\u3059\u3002xbm\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u306f\u3001C\u304b\u3089include\u3059\u308b\u306e\u306b\u3074\u3063\u305f\u308a\u306a\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u306e\u5f62\u3067\u3059\u304c\u3001D\u3067\u5229\u7528\u3059\u308b\u5834\u5408\u3069\u306e\u3088\u3046\u306b\u66f8\u3051\u308b\u3067\u3057\u3087\u3046\u304b\u3002\n\u4eca\u56de\u3001D\u8a00\u8a9e\u30de\u30b9\u30b3\u30c3\u30c8\u30ad\u30e3\u30e9\u30af\u30bf\u304c\u30de\u30a6\u30b9\u3092\u8ffd\u3044\u304b\u3051\u3066\u304f\u308b\u30b8\u30e7\u30fc\u30af\u30a2\u30d7\u30ea\u3092\u8003\u3048\u3066\u307f\u307e\u3059\uff08\u6df1\u591c\u306b\u52d5\u4f5c\u78ba\u8a8d\u3057\u305f\u306e\u3067\u3059\u304c\u3059\u3054\u304f\u6016\u304b\u3063\u305f\u3067\u3059...)\u3002\n\u30ab\u30e9\u30fc\u60c5\u5831\u304c\u5931\u308f\u308c\u308b\u3068\u5bc2\u3057\u3044\u306e\u3067\u3001xpm\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u3067\u884c\u3044\u307e\u3059\u3002\u6700\u3082png\u3084jpeg\u306a\u3069\u306e\u4e00\u822c\u7684\u306a\u753b\u50cf\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u3067\u884c\u3046\u306e\u304c\u9069\u5f53\u306a\u306e\u3067\u3057\u3087\u3046\u304c\u3001\u582a\u5fcd\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\nD\u8a00\u8a9e\u3067\u6271\u3046\u5834\u5408\u3001\u7d50\u5c40module\u3068\u3057\u3066\u6271\u308f\u306a\u3044\u3068\u3044\u3051\u306a\u3044\u306e\u3067\u3001\u601d\u3044\u5207\u3063\u3066\u66f8\u304d\u306a\u304a\u3057\u3066\u3057\u307e\u3044\u307e\u3059\u3002\n\n```c:d_image.xpm\n/* XPM */\nstatic char * d3_xpm[] = {\n\"162 309 4 1\",\n\" \tc None\",\n\".\tc #000000\",\n\"+\tc #FFFFFF\",\n\"@\tc #FF0000\",\n\"\n/*...(\u305a\u3063\u3068\u7d9a\u3044\u3066\u3044\u304f*/\n```\n\n\u3053\u308c\u3092\u3001\n\n```d:d_image.d\n/* XPM */\nmodule resorce;  // \u30b3\u30b3\n\n       //\u30b3\u30b3\nstatic string[] d_image = [\n\"162 309 4 1\",\n\" \tc None\",\n\".\tc #000000\",\n\"+\tc #FFFFFF\",\n\"@\tc #FF0000\",\n\"\"\n// \u305a\u3063\u3068\u7d9a\u3044\u3066\u3044\u304f\n```\n\n\u3053\u3046\u66f8\u304d\u63db\u3048\u3066\u3057\u307e\u3044\u307e\u3059\u3002\n\u6b21\u306b\u5229\u7528\u3059\u308b\u5074\u306e\u30d7\u30ed\u30b0\u30e9\u30e0\u3067\u3059\u3002\n\n```d:main.d\nimport deimos.X11.X;\nimport deimos.X11.Xlib;\nimport deimos.X11.Xutil;\n\n// \u753b\u50cf\u306e\u8aad\u307f\u8fbc\u307f\nimport resorce : d_image;\n\nextern(System){\n// \u81ea\u4f5c\u95a2\u6570\u3067\u4f7f\u3046\nstruct Hints{\n\tulong flags;\n\tulong functions;\n\tulong decorations;\n\tlong inputMode;\n\tulong status;\n}\n\t\nconst Atom XA_CARDINAL = cast(Atom)6;\n\n}\n\nimport std.stdio : chomp;\nimport std.string : split;\nimport std.conv : to;\nimport std.math;\nimport std.range;\nimport std.array;\n// \u6e21\u3055\u308c\u305fwin\u306b\u76f4\u63a5\u63cf\u753b\u3057\u3066\u3057\u307e\u3046\u3002\nvoid drawImage(Display* dpy, Window win, GC gc, string[] xpm){\n\t// \u30d8\u30c3\u30c0\u60c5\u5831\u3092\u5165\u624b\u3059\u308b\u3002\n\tstring[] head = xpm[0].chomp.split;\n\tint width = head[0].to!int;\n\tint height = head[1].to!int;\n\tint num = head[2].to!int;\n\tuint clist[char];             // \u8272\u306e\u9023\u60f3\u914d\u5217\n\t\n\tColormap cmap = DefaultColormap(*dpy, DefaultScreen(*dpy));\n\t\n\t// clist \u306e\u521d\u671f\u5316\n\tfor(int i=1; i<=num; ++i){\n\t\tstring[] str = xpm[i].chomp.split;\n\t\tXColor color, exact;\n\t\t\n\t\tif(str.length<3)continue;\n\t\t\n\t\tchar c = str.front[0];\n\t\tstr.popFront; str.popFront;\n\t\tstring name = str.front;\n\t\tstr.popFront;\n\t\tassert(str.length==0);\n\t\t\n\t\tXAllocNamedColor(dpy, cmap, name.toCString, &color, &exact);\n\t\tuint d_color = color.pixel;\n\t\t\n\t\tclist[c] = d_color;\n\t}\n\t\n\t// win \u3078\u306e\u63cf\u753b\u30021\u753b\u7d20\u305a\u3064\u898b\u3066\u3044\u304f\n\tfor(int y=0; y<height; ++y){\n\t\tfor(int x=0; x<width; ++x){\n\t\t\tchar c = xpm[(num+1)+y][x];\n\t\t\tif((c in clist) != null){\n\t\t\t\tuint d_color = clist[c];\n\t\t\t\tXSetForeground(dpy, gc, d_color);\n\t\t\t\tXDrawPoint(dpy, win, gc, x, y);\n\t\t\t}\n\t\t}\n\t}\n}\n\nbool isEventTime(Display* dpy, EventType trg){\n\tXEvent e;\n\tXNextEvent(dpy, &e);\n\t\n\treturn e.type == trg;\n}\n\nvoid main(){\n\tDisplay *dpy = XOpenDisplay(null);\n\t\n\tWindow root = DefaultRootWindow(*dpy);\n\tuint white = WhitePixel(*dpy, DefaultScreen(*dpy));\n\t\n\tWindow win = XCreateSimpleWindow(dpy, root, 32, 32, 162, 309, 0, white, white);\n\t\n\tGC gc = XCreateGC(dpy, win, 0, null);\n\t\n\t// \u30a6\u30a3\u30f3\u30c9\u30a6\u88c5\u98fe\u306f\u30a6\u30a3\u30f3\u30c9\u30a6\u30de\u30cd\u30fc\u30b8\u30e3\u304c\u52dd\u624b\u306b\u3064\u3051\u3066\u304f\u308c\u305f\u3082\u306e\u3067\u3059\u3002\u4eca\u56de\u306f\u90aa\u9b54\u306b\u306a\u308b\u306e\u3067\u81ea\u4f5c\u95a2\u6570\u306b\u3066\u53d6\u308a\u9664\u304d\u307e\u3059\u3002\n\tescape_decoration(dpy, win);\n\n\tXSelectInput(dpy, win, EventMask.StructureNotifyMask);\n\tXMapWindow(dpy, win);\n\t// \u6700\u521d\u306e\u30de\u30c3\u30d7\u6642\u306b\u306f\u3001\u30a6\u30a3\u30f3\u30c9\u30a6\u30de\u30cd\u30fc\u30b8\u30e3\u306b\u3088\u3063\u3066\u5ea7\u6a19\u304c\u6c7a\u307e\u308b\u306e\u3067\u3001\u3082\u3046\u4e00\u56de\u52d5\u304b\u3059\u5fc5\u8981\u304c\u3042\u308b\u3002\n\tXMoveWindow(dpy, win, 32, 32);\n\tXFlush(dpy);\n\t\n\t// \u30de\u30c3\u30d7\u304c\u5b8c\u4e86\u3055\u308c\u308b\u307e\u3067\u5f85\u3064\n\twhile(!isEventTime(dpy, EventType.MapNotify)){\n\t}\n\t\n\twhile(true){\n\t\tdrawImage(dpy, win, gc, d_image);\n\t\tXFlush(dpy);\n\t\t\n\t\t// \u30de\u30a6\u30b9\u4f4d\u7f6e\u306e\u53d6\u5f97\n\t\tWindow q_root, q_child;\n\t\tint AbsX, AbsY;\n\t\tint RelX, RelY;\n\t\tuint ModKeyMask;\n\t\tXQueryPointer(dpy, win, &q_root, &q_child, &AbsX, &AbsY, &RelX, &RelY, &ModKeyMask);\n\t\t\n\t\t// \u30a6\u30a3\u30f3\u30c9\u30a6\u4f4d\u7f6e\u306e\u53d6\u5f97\n\t\tint x, y;\n\t\tuint w, h, b, d;\n\t\tXGetGeometry(dpy, win, &root, &x, &y, &w, &h, &b, &d);\n\t\tdouble[2] v = [cast(double)(AbsX-(x+cast(int)w/2)), cast(double)(AbsY-(y+cast(int)h/2))];\t// \u753b\u50cf\u304b\u3089\u30de\u30a6\u30b9\u3078\u306e\u65b9\u5411\u30d9\u30af\u30c8\u30eb\n\t\t\n\t\t// \u8fd1\u3065\u304d\u3059\u304e\u305f\u3089\u7d42\u4e86\u3002\u9003\u3052\u308d\uff01\n\t\tif(v.d < w/8.){\n\t\t\tbreak;\n\t\t}\n\n\t\tv[]/=v.d;\t// \u5358\u4f4d\u30d9\u30af\u30c8\u30eb\u3092\u6c42\u3081\u308b\n\t\tv[]*=8.;\t// \u8ddd\u96e28pixel\u3050\u3089\u3044\u306e\u901f\u3055\uff1f\n\t\tint dx = cast(int)v[0];\n\t\tint dy = cast(int)v[1];\n\t\t\n\t\tXMoveWindow(dpy, win, x+dx, y+dy);\n\t}\n\t\n\t// \u30ea\u30bd\u30fc\u30b9\u306e\u958b\u653e\n\tXFreeGC(dpy, gc);\n\tXDestroyWindow(dpy, win);\n\tXCloseDisplay(dpy);\n}\n\ndouble d(double[2] v){\n\treturn sqrt((v[0]*v[0] + v[1]*v[1]));\n}\n\nextern(System){\n\t// SIGSEGV \u3092\u3082\u3089\u3063\u3066\u3057\u307e\u3046\u95a2\u6570\u306e\u4e00\u90e8\uff08\u4f7f\u3046\u306e\u3067\u8db3\u3059\uff09\n\tWindow DefaultRootWindow(ref Display dpy){\n\t\treturn ScreenOfDisplay( dpy,DefaultScreen( dpy ) ).root;\n\t}\n\tuint WhitePixel(ref Display dpy,int scr){\n\t\treturn cast(uint)ScreenOfDisplay( dpy,scr ).white_pixel;\n\t}\n\tColormap DefaultColormap(ref Display dpy, int scr){\n\t\treturn ScreenOfDisplay(dpy, scr).cmap;\n\t}\n}\n\nvoid escape_decoration(Display* dpy, Window win){\n\tHints hints;\n\tAtom property;\n\thints.flags = 2;\n\thints.decorations = 0;\n\tproperty = XInternAtom(dpy, \"_MOTIF_WM_HINTS\".toCString, Bool.True);\n\tdebug { writefln(\"%x\", property); }\n\tXChangeProperty(dpy, win, property, property, 32, PropertyMode.PropModeReplace, cast(ubyte *)&hints, 5);\n}\n\nvoid set_opacity(Display* dpy, Window win, double opacity){\n\tAtom property = XInternAtom(dpy, \"_NET_WM_WINDOW_OPACITY\".toCString, Bool.False);\n\tconst uint OPACITY = 0xffff_ffff;\n\tuint real_opacity = cast(uint)(OPACITY * opacity);\n\tXChangeProperty(dpy, win, property, XA_CARDINAL, 32, PropertyMode.PropModeReplace, cast(ubyte *)&real_opacity, 1);\n}\n\nchar* toCString(string str){\n\treturn (str ~ \"\\0\").dup.ptr;\n}\n```\n\n...\u7279\u306bD\u8a00\u8a9e\u3089\u3057\u3044\u66f8\u304d\u65b9\u3092\u3057\u3066\u3044\u308b\u308f\u3051\u3067\u3082\u306a\u304f\u7533\u3057\u8a33\u306a\u3044\u3067\u3059\u3002\u3067\u3082\u9023\u60f3\u914d\u5217\u3084\u30d9\u30af\u30c8\u30eb\u6f14\u7b97\u304c\u3055\u3055\u3063\u3068\u304b\u3051\u3066\u3057\u307e\u3046\u306e\u306f\u6c17\u6301\u3061\u304c\u3044\u3044\u3067\u3059\u306d\u3002\u3059\u3050\u983c\u3063\u3066\u3057\u307e\u3044\u307e\u3059\u3002\n\u307e\u305f\u3001\u30d0\u30a4\u30f3\u30c7\u30a3\u30f3\u30b0\u306fC\u306e\u30e9\u30a4\u30d6\u30e9\u30ea\u95a2\u6570\u3092\u547c\u3073\u51fa\u3059\u95a2\u4fc2\u3067exturn\u5ba3\u8a00\u3057\u304b\u898b\u3048\u306a\u3044\u95a2\u6570\u3082\u3042\u308a\u3001CTFE\u304c\u3067\u304d\u307e\u305b\u3093\u3002\u3046\u3050\u3050\u3002\n\n\u3067\u3001\u5b9f\u884c\u6642\u306e\u753b\u50cf\u306f\u3053\u3093\u306a\u611f\u3058\u3067\u3059\u3002\n![D-mascot](https://lh5.googleusercontent.com/-9QuMZeOXBwI/UM9EVX-8SPI/AAAAAAAAADs/zLkkzewAGsk/s800/Screenshot%252520from%2525202012-12-18%25252001%25253A00%25253A33.png \"\u30b8\u30e7\u30fc\u30af\u30a2\u30d7\u30ea\u306e\u4f8b\")\n\n##\u7d42\u308f\u308a\u306b\nD\u8a00\u8a9e\u304b\u3089\u5165\u308bXlib\u5165\u9580\u3068\u3044\u3046\u3053\u3068\u3067\u3057\u305f\u304c\u3001\u3044\u304b\u304c\u3060\u3063\u305f\u3067\u3057\u3087\u3046\u304b\u3002\u5c11\u3057\u3067\u3082\u8208\u5473\u3092\u6301\u3063\u3066\u3044\u305f\u3060\u3051\u305f\u3089\u5e78\u3044\u3067\u3059\u3002\u5b9f\u969b\u306b\u95a2\u6570\u306e\u3072\u3068\u3064\u3072\u3068\u3064\u306e\u52d5\u304d\u3092\u898b\u308b\u306a\u3089\u3001[\u3053\u3061\u3089\u306e\u30b5\u30a4\u30c8](http://homepage3.nifty.com/rio_i/lab/xlib/)\u306a\u3069\u304c\u304a\u3059\u3059\u3081\u3067\u3059(\u3082\u3061\u308d\u3093C)\u3002\u4ed6\u306b\u3082\u8abf\u3079\u308b\u3068\u7d50\u69cb\u51fa\u3066\u304f\u308b\u306e\u3067\u3001\u3084\u3063\u3066\u307f\u305f\u3044\u65b9\u306f\u305c\u3072\u305c\u3072\u3002\n\u307e\u305f\u3001Xlib\u306b\u9650\u3089\u305aDeimos\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306f\u3072\u3063\u305d\u308a\u3057\u3066\u3044\u308b\u5370\u8c61\u304c\u3042\u308b\u306e\u3067\u3001(\u305f\u3076\u3093\u307e\u3060\u4f7f\u3044\u52dd\u624b\u306f\u826f\u304f\u306a\u3044\u3068\u601d\u3046\u306e\u3067)\u958b\u767a\u304c\u76db\u308a\u4e0a\u304c\u308b\u3068\u3044\u3044\u306a\u3042\u3001\u3068\u601d\u3044\u307e\u3059\u3002\n\n\u660e\u65e5\u300119\u65e5\u306f[@9rnsr](http://qiita.com/users/9rnsr)\u3055\u3093\u3067\u3059\uff01", "tags": ["Xlib", "Dlanguage", "dlang"]}