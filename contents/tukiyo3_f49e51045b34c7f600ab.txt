{"context": "\n\n\u53c2\u8003\n\nRunning CoreOS on VMware\nCoreOS\u306eSSH\u30dd\u30fc\u30c8\u3092\u5909\u66f4\u3059\u308b - Qiita\nCoreOS \u3067 Docker \u3092\u306f\u3058\u3081\u308b - Qiita\nCoreOS\u306bscreen\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\u541b\u4f5c\u3063\u305f - Qiita\n\n\n\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u624b\u9806\n\n\u8aad\u307f\u8fbc\u307f\nsudo -s\npasswd core\nip addr add 10.0.2.15/24 dev ens192\nip route add default via 10.0.2.1\necho \"nameserver 8.8.8.8\" > /etc/resolv.conf \n\nwget http://192.168.100.70/cloud-config.yml\ncoreos-cloudinit -validate=true -from-file=cloud-config.yml\n#coreos-install -d /dev/sda -C stable -c cloud-config.yml\ncoreos-install -d /dev/sda -C alpha -V 1081.2.0 -c cloud-config.yml\nreboot\n\n\n\ncloud-config.yml\n\u7279\u5fb4\n\n\u81ea\u52d5\u518d\u8d77\u52d5\u3092OFF\ndocker\u8d77\u52d5\nTimezone\u3092Asia/Tokyo\nsshd\u306e\u30dd\u30fc\u30c8\u309222\u304b\u3089\u5909\u66f4\ntoolbox\u306e\u521d\u671f\u8a2d\u5b9a\nscreen\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u30b3\u30de\u30f3\u30c9\u8a2d\u7f6e\n\n\n\nuser\u306e\u30d1\u30b9\u30ef\u30fc\u30c9\u6587\u5b57\u5217\u751f\u6210\n$ openssl passwd -salt coreos -1 fjpoaeifji\n$1$coreos$5tow1kTF0qjJ0qi.G8N9/1\n\n\n\ncloud-config.yml\n#cloud-config\n\nhostname: coreos01\n\n#-----------\ncoreos:\n#-----------\n  #update:\n    # disable auto update.\n    #reboot-strategy: off\n\n  units:\n\n    - name: 10-static.network\n      runtime: no\n      content: |\n        [Match]\n        Name=eth*\n        [Network]\n        Address=192.168.100.202/24\n        Gateway=192.168.100.1\n        DNS=8.8.8.8\n\n    # set timezone Asia/Tokyo.\n    - name: timezone.service\n      command: start\n      content: |\n        [Unit]\n        Description=timezone\n        [Service]\n        Type=oneshot\n        RemainAfterExit=yes\n        ExecStart=/usr/bin/ln -sf ../usr/share/zoneinfo/Japan /etc/localtime\n\n    # change ssh listen port.\n    - name: sshd.socket\n      command: start\n      content: |\n        [Socket]\n        #ListenStream=22\n        ListenStream=9100\n        Accept=yes\n\n#-----------\nusers:\n#-----------\n  - name: core\n    passwd: $1$coreos$5tow1kTF0qjJ0qi.G8N9/1\n    ssh-authorized-keys: \n      - ssh-rsa ... osx/id_rsa\n  - groups:\n      - sudo\n      - docker\n\n#-----------\nwrite_files:\n#-----------\n  - path: /etc/ssh/sshd_config\n    permissions: 0600\n    owner: root:root\n    content: |\n      # Use most defaults for sshd configuration.\n      UsePrivilegeSeparation sandbox\n      Subsystem sftp internal-sftp\n      ClientAliveInterval 180\n      #\n      PermitRootLogin no\n      MaxAuthTries 1\n      PasswordAuthentication no\n      ChallengeResponseAuthentication no\n      AllowUsers core\n\n  # toolbox\n  - path: /home/core/.toolbox\n    permissions: 0644\n    owner: core:core\n    content: |\n      TOOLBOX_DOCKER_IMAGE=ubuntu\n      TOOLBOX_DOCKER_TAG=latest\n\n  # custom .bash_profile\n  - path: /home/core/.bash_profile\n    permissions: 0644\n    owner: core:core\n    content: |\n      alias toolbox='toolbox --bind=/run:/run'\n      alias t='toolbox --bind=/run:/run'\n\n  # update cloud-config.yml\n  - path: /home/core/update-cloud-config.sh\n    permissions: 0700\n    owner: core:core\n    content: |\n      sudo coreos-cloudinit --from-url=http://192.168.100.70:8000/cloud-config.yml\n\n  # install screen command\n  - path: /home/core/install_screen.sh\n    permissions: 0700\n    owner: core:core\n    content: |\n      sudo wget -q https://raw.githubusercontent.com/tukiyo/coreos-screen.run/master/screen.run -O /usr/share/oem/screen.run\n      sudo sh /usr/share/oem/screen.run\n\n\n\n## \u53c2\u8003\n\n* [Running CoreOS on VMware](https://coreos.com/os/docs/latest/booting-on-vmware.html)\n* [CoreOS\u306eSSH\u30dd\u30fc\u30c8\u3092\u5909\u66f4\u3059\u308b - Qiita](http://qiita.com/blackle0pard_/items/60e2cc2c4697781bba86)\n* [CoreOS \u3067 Docker \u3092\u306f\u3058\u3081\u308b - Qiita](http://qiita.com/japboy/items/ca00baeaf0acada31235)\n* [CoreOS\u306bscreen\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\u541b\u4f5c\u3063\u305f - Qiita](http://qiita.com/tukiyo3/items/1c7d567a1d8d086de077)\n\n\n## \u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u624b\u9806\n\n```bash:\u8aad\u307f\u8fbc\u307f\nsudo -s\npasswd core\nip addr add 10.0.2.15/24 dev ens192\nip route add default via 10.0.2.1\necho \"nameserver 8.8.8.8\" > /etc/resolv.conf \n\nwget http://192.168.100.70/cloud-config.yml\ncoreos-cloudinit -validate=true -from-file=cloud-config.yml\n#coreos-install -d /dev/sda -C stable -c cloud-config.yml\ncoreos-install -d /dev/sda -C alpha -V 1081.2.0 -c cloud-config.yml\nreboot\n```\n\n\n## cloud-config.yml\n\n\u7279\u5fb4\n\n* \u81ea\u52d5\u518d\u8d77\u52d5\u3092OFF\n* docker\u8d77\u52d5\n* Timezone\u3092Asia/Tokyo\n* sshd\u306e\u30dd\u30fc\u30c8\u309222\u304b\u3089\u5909\u66f4\n* toolbox\u306e\u521d\u671f\u8a2d\u5b9a\n* screen\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u30b3\u30de\u30f3\u30c9\u8a2d\u7f6e\n\n----\n\n```bash:user\u306e\u30d1\u30b9\u30ef\u30fc\u30c9\u6587\u5b57\u5217\u751f\u6210\n$ openssl passwd -salt coreos -1 fjpoaeifji\n$1$coreos$5tow1kTF0qjJ0qi.G8N9/1\n```\n\n```rb:cloud-config.yml\n#cloud-config\n\nhostname: coreos01\n\n#-----------\ncoreos:\n#-----------\n  #update:\n    # disable auto update.\n    #reboot-strategy: off\n\n  units:\n\n    - name: 10-static.network\n      runtime: no\n      content: |\n        [Match]\n        Name=eth*\n        [Network]\n        Address=192.168.100.202/24\n        Gateway=192.168.100.1\n        DNS=8.8.8.8\n\n    # set timezone Asia/Tokyo.\n    - name: timezone.service\n      command: start\n      content: |\n        [Unit]\n        Description=timezone\n        [Service]\n        Type=oneshot\n        RemainAfterExit=yes\n        ExecStart=/usr/bin/ln -sf ../usr/share/zoneinfo/Japan /etc/localtime\n\n    # change ssh listen port.\n    - name: sshd.socket\n      command: start\n      content: |\n        [Socket]\n        #ListenStream=22\n        ListenStream=9100\n        Accept=yes\n\n#-----------\nusers:\n#-----------\n  - name: core\n    passwd: $1$coreos$5tow1kTF0qjJ0qi.G8N9/1\n    ssh-authorized-keys: \n      - ssh-rsa ... osx/id_rsa\n  - groups:\n      - sudo\n      - docker\n\n#-----------\nwrite_files:\n#-----------\n  - path: /etc/ssh/sshd_config\n    permissions: 0600\n    owner: root:root\n    content: |\n      # Use most defaults for sshd configuration.\n      UsePrivilegeSeparation sandbox\n      Subsystem sftp internal-sftp\n      ClientAliveInterval 180\n      #\n      PermitRootLogin no\n      MaxAuthTries 1\n      PasswordAuthentication no\n      ChallengeResponseAuthentication no\n      AllowUsers core\n\n  # toolbox\n  - path: /home/core/.toolbox\n    permissions: 0644\n    owner: core:core\n    content: |\n      TOOLBOX_DOCKER_IMAGE=ubuntu\n      TOOLBOX_DOCKER_TAG=latest\n\n  # custom .bash_profile\n  - path: /home/core/.bash_profile\n    permissions: 0644\n    owner: core:core\n    content: |\n      alias toolbox='toolbox --bind=/run:/run'\n      alias t='toolbox --bind=/run:/run'\n\n  # update cloud-config.yml\n  - path: /home/core/update-cloud-config.sh\n    permissions: 0700\n    owner: core:core\n    content: |\n      sudo coreos-cloudinit --from-url=http://192.168.100.70:8000/cloud-config.yml\n\n  # install screen command\n  - path: /home/core/install_screen.sh\n    permissions: 0700\n    owner: core:core\n    content: |\n      sudo wget -q https://raw.githubusercontent.com/tukiyo/coreos-screen.run/master/screen.run -O /usr/share/oem/screen.run\n      sudo sh /usr/share/oem/screen.run\n```\n", "tags": ["CoreOS", "cloud-config"]}