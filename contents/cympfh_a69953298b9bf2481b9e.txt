{"context": "\n\nchainer CRF \u691c\u7d22\nv.1.13.0 \u304b\u3089\u5b58\u5728\u304c\u78ba\u8a8d\u3055\u308c\u3066\u3044\u308b chainer.functions.crf1d \u3092\u4f7f\u3046\u30c6\u30b9\u30c8\n\n\u30ea\u30f3\u30af\n\nCRF\u3092\u4f5c\u308b\u305e\u3068\u3044\u3046\u30bb\u30eb\u30d5 issue\n\n\nhttps://github.com/pfnet/chainer/issues/1020\n\n\ncrf1d \u306e\u5b9f\u88c5\n\n\nhttp://docs.chainer.org/en/stable/reference/functions.html#chainer.functions.crf1d\n\nhttp://docs.chainer.org/en/stable/_modules/chainer/links/loss/crf1d.html#CRF1d (link)\n\nhttp://docs.chainer.org/en/stable/reference/functions.html#chainer.functions.crf1d (function)\n\n\ncrf1d \u3092\u4f7f\u3046\u4f8b\n\n\npfnet/chainer \u306e postagging \u30d6\u30e9\u30f3\u30c1\u306bPOS\u30bf\u30ae\u30f3\u30b0\u306e\u4f8b\u304c\u3042\u308a\u307e\u3057\u305f:\n\n\nhttps://github.com/pfnet/chainer/blob/postagging/examples/pos/postagging.py\n\n\n\n\n\n\nCRF\nCRF \u81ea\u4f53\u306f\u6700\u8fd1\u306e\u3082\u306e\u3067\u306f\u3042\u308a\u307e\u305b\u3093\u304b\u3089\u3001\u307f\u306a\u3055\u3093\u3088\u304f\u3054\u5b58\u77e5\u3060\u3068\u601d\u3044\u307e\u3059.\ncrf1d \u306e\u5b9f\u88c5\u306b\u5f53\u3063\u3066\u30ea\u30d5\u30a1\u30fc\u3055\u308c\u3066\u308b\u8ad6\u6587\u3092\u79c1\u306f\u8aad\u3093\u3067\u306a\u304f\u3001chainer\u5b9f\u88c5\u3057\u304b\u8aad\u3093\u3067\u306a\u3044\u306e\u3067\u3059\u304c\u3001\u3053\u308cCRF\u3068\u7b49\u4fa1\u306a\u3093\u3067\u3059\u304b\uff1f\n\u8868\u73fe\u529b\u304c\u304b\u306a\u308a\u9650\u5b9a\u3055\u308c\u3066\u308b\u6c17\u304c\u3059\u308b\u306e\u3067\u3059\u304c...\n\u4f7f\u7528\u4f8b\u3092\u8aad\u307e\u305a\u306b\u3044\u304d\u306a\u308a crf1d \u306e\u5b9f\u88c5\u3092\u8aad\u3080\u3068\u308f\u3051\u304c\u308f\u304b\u3089\u306a\u3044\u6c17\u304c\u3057\u307e\u3059.\nx \u3063\u3066\u66f8\u304b\u308c\u308b\u3068\u5c64\u3078\u306e\u5165\u529b\u3068\u601d\u3063\u3066\u3057\u307e\u3044\u307e\u3059\u3057.\n\u4ee5\u4e0b\u306fchainer\u5b9f\u88c5\u3092\u8aad\u3093\u3067\u306e\u79c1\u306e\u89e3\u91c8\u3067\u3059.\n\n\u7cfb\u5217\u30e9\u30d9\u30ea\u30f3\u30b0\n\u5165\u529b\u306f\u4f55\u304b\u3057\u3089\u306e\u5217:\nx=x1,x2,x3,\u2026,xnx = x_1, x_2, x_3, \\ldots, x_n\n\u3067\u3001\u3053\u308c\u304b\u3089\u540c\u3058\u9577\u3055\u306e\u5217\ny1,y2,y3,\u2026,yn.y_1, y_2, y_3, \\ldots, y_n.\n\u3092\u4e88\u6e2c\u3057\u305f\u3044.\n(\u5178\u578b\u7684\u306a\u30bf\u30b9\u30af\u4f8b\u3068\u3057\u3066\u306f\u3001POS\u30bf\u30b0\u4e88\u6e2c. xx \u304c\u6587\u3059\u306a\u308f\u3061\u8a9e\u306e\u5217\u3067\u3001\u5404\u8a9e\u306b\u3064\u3044\u3066POS (\u54c1\u8a5e) \u3092\u30e9\u30d9\u30ea\u30f3\u30b0\u3059\u308b.)\n\n\u3053\u3053\u3067 yiy_i \u306f\u30e9\u30d9\u30eb (\u96e2\u6563\u5024).\n\u30e9\u30d9\u30eb\u96c6\u5408\u306e\u5927\u304d\u3055\u3092 kk \u3068\u3057\u3066\nyi\u22080,1,\u2026,k\u22121=Yy_i \\in {0,1,\\ldots,k - 1} = \\mathcal{Y}\n\u3060\u3068\u3059\u308b.\n\u3059\u3050\u306b\u601d\u3044\u3064\u304f\u65b9\u6cd5\u3068\u3057\u3066\u306f yiy_i \u3092\u4e88\u6e2c\u3059\u308b\u306e\u306b xix_i \u53ca\u3073\u305d\u306e\u5468\u8fba (xi\u22122\u2026xi+2x_{i-2} \\ldots x_{i+2} \u304f\u3089\u3044) \u3092\u7d20\u6027\u3068\u3059\u308b\u3053\u3068.\n\u6b21\u306e\u7d75\u306f y2y_2 \u3092 x1,x2,x3x_1, x_2, x_3 \u304b\u3089\u4e88\u6e2c\u3059\u308b\u611f\u3058\u306e\u7d75.\n\n\u540c\u69d8\u306b 1\u2264i\u2264n1 \\leq i \\leq n \u306b\u3064\u3044\u3066 yiy_i \u3092 f(xi\u22121,xi,xi+1)f(x_{i-1}, x_i, x_{i+1}) \u3067\u4e88\u6e2c\u3059\u308b.\n\u3082\u3061\u308d\u3093 yiy_i \u306f\u96e2\u6563\u5024\u306a\u306e\u3067 f(..)\u2208Rkf(..) \\in \\mathbb{R}^k \u3068\u3057\u3066\u5024\u304c\u6700\u5927\u3068\u6210\u308b\u30a4\u30f3\u30c7\u30c3\u30af\u30b9 (argmax) \u3092\u4e88\u6e2c\u30e9\u30d9\u30eb\u3068\u3059\u308b\u308f\u3051.\nff \u81ea\u4f53\u306f\u304a\u597d\u304d\u306a NNs \u3092\u7d44\u3081\u3070\u5b9f\u73fe\u3067\u304d\u308b.\n\u307e\u305f\u3001\u5217\u306e\u4e21\u7aef (y1y_1, yny_n) \u3092\u4e88\u6e2c\u3059\u308b\u305f\u3081\u306b\u3001\u4eee\u60f3\u7684\u306a x0x_0 \u53ca\u3073 xn+1x_{n+1} \u3092\u4ed8\u3051\u8db3\u3059\u5fc5\u8981\u304c\u3042\u308b.\n\u81ea\u7136\u8a00\u8a9e\u51e6\u7406\u754c\u9688\u3067\u306f\u3001\u5165\u529b\u304c\u6587\u306e\u5834\u5408\u3001\u3088\u304f bos (begin-of-sentence), eos (end-of-sentnece) \u3068\u304b\u3001HTML\u98a8\u306b <s> </s> \u3068\u3044\u3046\u4ed6\u3068\u88ab\u3089\u306a\u3044\u7279\u5225\u306a\u30e9\u30d9\u30eb\u3092\u7528\u3044\u308b.\n\n\u3068\u3053\u308d\u3067\u3001\u305d\u308c\u304c\u672c\u5f53\u306b\u4e00\u3064\u306e\u5217\u306a\u3089\u3001\u305d\u306e\u9806\u5e8f\u306b\u95a2\u3057\u3066\u4f55\u304b\u3057\u3089\u306e\u50be\u5411\u304c\u3042\u3063\u3066\u3082\u826f\u3044\u306f\u305a\u3067\u3042\u308b.\n\u3053\u306e\u30e9\u30d9\u30eb\u306e\u6b21\u306b\u3053\u306e\u30e9\u30d9\u30eb\u304c\u6765\u3084\u3059\u3044\u3001\u6765\u306b\u304f\u3044\u3001\u307f\u305f\u3044\u306a.\nchainer.links.CRF1d \u306f __call__ \u304c\u640d\u5931\u95a2\u6570\u3001 argmax \u304c\u4e88\u6e2c\u95a2\u6570\u3068\u3057\u3066\u8a2d\u8a08\u3055\u308c\u3066\u3044\u308b.\n\u640d\u5931\u95a2\u6570\u3067\u306f ff \u306b\u3088\u3063\u3066\u4e88\u6e2c\u3055\u308c\u305f\u5217 y\u2032=y\u20321,y\u20322,\u2026,y\u2032ny' = y_1', y_2', \\ldots, y_n' \u3068\u3001\n\u6b63\u89e3\u306e\u5217 y=y1,y2,\u2026,yny = y_1, y_2, \\ldots, y_n \u3068\u3092\u6bd4\u8f03\u3059\u308b\u304c\u3001\n\u305d\u308c\u306b\u52a0\u3048\u3066 yi\u22121,yiy_{i-1}, y_i (i=2,\u2026,n)(i=2,\\ldots,n) \u3092\u6bd4\u8f03\u3057\u3066\u3001\u3053\u306e\u30e9\u30d9\u30eb\u306e\u6b21\u306b\u3053\u306e\u30e9\u30d9\u30eb\u306f\u6765\u306b\u304f\u3044\u30cf\u30ba\u3001\u3068\u3044\u3046\u50be\u5411\u3092\u30b3\u30b9\u30c8\u3068\u3044\u3046\u5f62\u3067\u640d\u5931\u306b\u52a0\u3048\u308b.\n\u305d\u306e\u3088\u3046\u306a\u30b3\u30b9\u30c8\u306f\u5b66\u7fd2\u6642\u306b\u9006\u4f1d\u64ad\u3055\u308c\u3001\u307e\u305f\u4e88\u6e2c\u3067\u306f ff \u306b\u3088\u308b\u4e88\u6e2c\u306b\u3053\u306e\u30b3\u30b9\u30c8\u3092\u52a0\u5473\u3059\u308b.\nyiy_i \u306e\u4e88\u6e2c\u306b xix_i \u53ca\u3073\u305d\u306e\u5468\u8fba\u306e\u307f\u306a\u3089\u305a\u3001yi\u22121y_{i-1} \u3082\u5b9f\u8cea\u7684\u306b\u7d20\u6027\u306b\u7528\u3044\u3066\u3044\u308b\u3053\u3068\u306b\u306a\u308b.\n\n\n\u5b9f\u88c5 (\u5229\u7528\u4f8b)\n\u4f7f\u3044\u65b9\u306e\u5fc3\u306f\u5206\u304b\u3063\u305f\u306e\u3067\u5b9f\u969b\u306b\u4f7f\u3063\u3066\u307f\u308b.\n\u6587 (\u6587\u5b57\u306e\u5217\u3068\u307f\u306a\u3057\u307e\u3059) \u304b\u3089\u9854\u6587\u5b57\u3092\u691c\u51fa\u3059\u308b\u3053\u3068\u3092\u76ee\u6307\u3057\u307e\u3059.\n(\u9854\u6587\u5b57\u691c\u51fa\u3092\u5927\u6614\u306b\u3084\u3063\u3066\u305f\u3053\u3068\u304c\u3042\u3063\u3066\u3001\u305d\u306e\u75d5\u8de1\u3092\u898b\u3064\u3051\u305f\u304b\u3089\u601d\u3044\u3064\u3044\u305f\u306e\u3060\u3051\u3069\u3001\u5225\u306b\u5927\u91cf\u306e\u8a13\u7df4\u30c7\u30fc\u30bf\u304c\u3042\u308b\u3068\u304b\u3067\u306f\u306a\u3044.)\n\u3053\u308c\u306f\u7cfb\u5217\u30e9\u30d9\u30ea\u30f3\u30b0\u3067\u3082\u533a\u9593\u3092\u691c\u51fa\u3059\u308b\u30bf\u30b9\u30af\u306a\u306e\u3067IOB\u30bf\u30b0\u3092\u4ed8\u3051\u308b\u3053\u3068\u306b\u3057\u307e\u3059.\nIOB\u30bf\u30b0\u306b\u3064\u3044\u3066\u306f https://en.wikipedia.org/wiki/Inside_Outside_Beginning \u306a\u3069\u3092\u53c2\u7167\u304f\u3060\u3055\u3044.\n\u6a19\u6e96\u5165\u529b\u304b\u3089\u8a13\u7df4\u30c7\u30fc\u30bf\u3092\u8aad\u307f\u307e\u3059.\n\u4e00\u884c\u4e00\u6587 (200\u6587\u5b57\u4ee5\u4e0b\u3092\u4eee\u5b9a) \u3067\u3001<>\u3068 <> \u306b\u56f2\u307e\u308c\u305f\u90e8\u5206\u3092\u9854\u6587\u5b57\u3060\u3068\u3057\u3066\u5b66\u7fd2\u3057\u307e\u3059.\n\n\u30b3\u30fc\u30c9\n\nhttps://gist.github.com/cympfh/9c592779a63ba804294a16a7402ae910\n\n\n\u7d50\u679c\ntest = '\u4e16\u754c\u304c\u5e73\u548c\u3067\u3042\u308a\u307e\u3059\u3088\u3046\u306b( \uff1b\u00b4\u0414\uff40)'\n# =>\n# [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 2, 2, 2, 2]\n# \u4e16\u754c\u304c\u5e73\u548c\u3067\u3042\u308a\u307e\u3059\u3088\u3046\u306b<>( \uff1b\u00b4\u0414\uff40)<>\n\n\u3068\u3044\u3046\u308f\u3051\u3067 \u4e16\u754c\u304c\u5e73\u548c\u3067\u3042\u308a\u307e\u3059\u3088\u3046\u306b( \uff1b\u00b4\u0414\uff40) \u306e\u3046\u3061 ( \uff1b\u00b4\u0414\uff40) \u304c\u9854\u6587\u5b57\u3068\u691c\u51fa\u3055\u308c\u307e\u3057\u305f.\n\u521d\u3081 yiy_i \u306e\u4e88\u6e2c\u306b\u5148\u306b\u8aac\u660e\u3057\u305f\u4f8b\u306e\u3088\u3046\u306b xi\u22121,xi,xi+1x_{i-1},x_i,x_{i+1} (\u30a6\u30a3\u30f3\u30c9\u30a6\u5e45 3) \u3092\u7d20\u6027\u306b\u8a66\u3057\u305f\u306e\u3067\u3059\u304c\u3001\u9854\u6587\u5b57\u691c\u51fa\u306e\u5834\u5408\u3001\u3061\u3087\u3063\u3068\u3053\u308c\u306f\u8db3\u308a\u306a\u3044\u3088\u3046\u3067\u3059. \u4f8b\u3048\u3070\u3001\u3053\u306e\u9854\u6587\u5b57\u306e\u62ec\u5f27\u304c\u672c\u6765\u306e\u610f\u5473\u306e\u62ec\u5f27\u3068\u3057\u3066\u4f7f\u308f\u308c\u3066\u308b\u304b\u3069\u3046\u304b\u306a\u3093\u3066\u524d\u5f8c1\u6587\u5b57\u3060\u3051\u3067\u306f\u3061\u3087\u3063\u3068\u3080\u305a\u304b\u3057\u3044\u3067\u3059. ) \u306a\u3093\u3066\u4e00\u3064\u524d\u304c\u305f\u3060\u306e\u534a\u89d2\u7a7a\u767d\u3067\u4e00\u3064\u6b21\u304c\u6587\u672b\u306a\u306e\u3067. \u4e0a\u306e\u3046\u307e\u304f\u884c\u3063\u305f\u4f8b\u306f\u30a6\u30a3\u30f3\u30c9\u30a6\u5e45\u30925\u306b\u3057\u3066\u8a66\u3057\u305f\u7d50\u679c\u3067\u3059\u3002\u30b3\u30fc\u30c9\u3082\u305d\u3046\u306a\u3063\u3066\u3044\u307e\u3059\u3002\n# chainer CRF \u691c\u7d22\n\nv.1.13.0 \u304b\u3089\u5b58\u5728\u304c\u78ba\u8a8d\u3055\u308c\u3066\u3044\u308b chainer.functions.crf1d \u3092\u4f7f\u3046\u30c6\u30b9\u30c8\n\n## \u30ea\u30f3\u30af\n\n- CRF\u3092\u4f5c\u308b\u305e\u3068\u3044\u3046\u30bb\u30eb\u30d5 issue\n    - https://github.com/pfnet/chainer/issues/1020\n- crf1d \u306e\u5b9f\u88c5\n    - http://docs.chainer.org/en/stable/reference/functions.html#chainer.functions.crf1d\n    - http://docs.chainer.org/en/stable/_modules/chainer/links/loss/crf1d.html#CRF1d (link)\n    - http://docs.chainer.org/en/stable/reference/functions.html#chainer.functions.crf1d (function)\n- crf1d \u3092\u4f7f\u3046\u4f8b\n    - pfnet/chainer \u306e postagging \u30d6\u30e9\u30f3\u30c1\u306bPOS\u30bf\u30ae\u30f3\u30b0\u306e\u4f8b\u304c\u3042\u308a\u307e\u3057\u305f:\n        - https://github.com/pfnet/chainer/blob/postagging/examples/pos/postagging.py\n\n## CRF\n\nCRF \u81ea\u4f53\u306f\u6700\u8fd1\u306e\u3082\u306e\u3067\u306f\u3042\u308a\u307e\u305b\u3093\u304b\u3089\u3001\u307f\u306a\u3055\u3093\u3088\u304f\u3054\u5b58\u77e5\u3060\u3068\u601d\u3044\u307e\u3059.\ncrf1d \u306e\u5b9f\u88c5\u306b\u5f53\u3063\u3066\u30ea\u30d5\u30a1\u30fc\u3055\u308c\u3066\u308b\u8ad6\u6587\u3092\u79c1\u306f\u8aad\u3093\u3067\u306a\u304f\u3001chainer\u5b9f\u88c5\u3057\u304b\u8aad\u3093\u3067\u306a\u3044\u306e\u3067\u3059\u304c\u3001\u3053\u308cCRF\u3068\u7b49\u4fa1\u306a\u3093\u3067\u3059\u304b\uff1f\n\u8868\u73fe\u529b\u304c\u304b\u306a\u308a\u9650\u5b9a\u3055\u308c\u3066\u308b\u6c17\u304c\u3059\u308b\u306e\u3067\u3059\u304c...\n\n\u4f7f\u7528\u4f8b\u3092\u8aad\u307e\u305a\u306b\u3044\u304d\u306a\u308a crf1d \u306e\u5b9f\u88c5\u3092\u8aad\u3080\u3068\u308f\u3051\u304c\u308f\u304b\u3089\u306a\u3044\u6c17\u304c\u3057\u307e\u3059.\n`x` \u3063\u3066\u66f8\u304b\u308c\u308b\u3068\u5c64\u3078\u306e\u5165\u529b\u3068\u601d\u3063\u3066\u3057\u307e\u3044\u307e\u3059\u3057.\n\n\u4ee5\u4e0b\u306fchainer\u5b9f\u88c5\u3092\u8aad\u3093\u3067\u306e\u79c1\u306e\u89e3\u91c8\u3067\u3059.\n\n### \u7cfb\u5217\u30e9\u30d9\u30ea\u30f3\u30b0\n\n\u5165\u529b\u306f\u4f55\u304b\u3057\u3089\u306e\u5217:\n\n$$x = x_1, x_2, x_3, \\ldots, x_n$$\n\n\u3067\u3001\u3053\u308c\u304b\u3089\u540c\u3058\u9577\u3055\u306e\u5217\n\n$$y_1, y_2, y_3, \\ldots, y_n.$$\n\n\u3092\u4e88\u6e2c\u3057\u305f\u3044.\n(\u5178\u578b\u7684\u306a\u30bf\u30b9\u30af\u4f8b\u3068\u3057\u3066\u306f\u3001POS\u30bf\u30b0\u4e88\u6e2c. $x$ \u304c\u6587\u3059\u306a\u308f\u3061\u8a9e\u306e\u5217\u3067\u3001\u5404\u8a9e\u306b\u3064\u3044\u3066POS (\u54c1\u8a5e) \u3092\u30e9\u30d9\u30ea\u30f3\u30b0\u3059\u308b.)\n\n![1.png](https://qiita-image-store.s3.amazonaws.com/0/17022/f3b050d1-d8e6-6d55-41dd-8a6a639cba49.png)\n\n\u3053\u3053\u3067 $y_i$ \u306f\u30e9\u30d9\u30eb (\u96e2\u6563\u5024).\n\u30e9\u30d9\u30eb\u96c6\u5408\u306e\u5927\u304d\u3055\u3092 $k$ \u3068\u3057\u3066\n$y_i \\in \\{0,1,\\ldots,k - 1\\} = \\mathcal{Y}$\n\u3060\u3068\u3059\u308b.\n\n\u3059\u3050\u306b\u601d\u3044\u3064\u304f\u65b9\u6cd5\u3068\u3057\u3066\u306f $y_i$ \u3092\u4e88\u6e2c\u3059\u308b\u306e\u306b $x_i$ \u53ca\u3073\u305d\u306e\u5468\u8fba ($x_{i-2} \\ldots x_{i+2}$ \u304f\u3089\u3044) \u3092\u7d20\u6027\u3068\u3059\u308b\u3053\u3068.\n\u6b21\u306e\u7d75\u306f $y_2$ \u3092 $x_1, x_2, x_3$ \u304b\u3089\u4e88\u6e2c\u3059\u308b\u611f\u3058\u306e\u7d75.\n\n![2.png](https://qiita-image-store.s3.amazonaws.com/0/17022/75eea3bd-5500-033f-9fa1-64c2d1b965fc.png)\n\n\u540c\u69d8\u306b $1 \\leq i \\leq n$ \u306b\u3064\u3044\u3066 $y_i$ \u3092 $f(x_{i-1}, x_i, x_{i+1})$ \u3067\u4e88\u6e2c\u3059\u308b.\n\u3082\u3061\u308d\u3093 $y_i$ \u306f\u96e2\u6563\u5024\u306a\u306e\u3067 $f(..) \\in \\mathbb{R}^k$ \u3068\u3057\u3066\u5024\u304c\u6700\u5927\u3068\u6210\u308b\u30a4\u30f3\u30c7\u30c3\u30af\u30b9 (argmax) \u3092\u4e88\u6e2c\u30e9\u30d9\u30eb\u3068\u3059\u308b\u308f\u3051.\n\n$f$ \u81ea\u4f53\u306f\u304a\u597d\u304d\u306a NNs \u3092\u7d44\u3081\u3070\u5b9f\u73fe\u3067\u304d\u308b.\n\u307e\u305f\u3001\u5217\u306e\u4e21\u7aef ($y_1$, $y_n$) \u3092\u4e88\u6e2c\u3059\u308b\u305f\u3081\u306b\u3001\u4eee\u60f3\u7684\u306a $x_0$ \u53ca\u3073 $x_{n+1}$ \u3092\u4ed8\u3051\u8db3\u3059\u5fc5\u8981\u304c\u3042\u308b.\n\u81ea\u7136\u8a00\u8a9e\u51e6\u7406\u754c\u9688\u3067\u306f\u3001\u5165\u529b\u304c\u6587\u306e\u5834\u5408\u3001\u3088\u304f bos (begin-of-sentence), eos (end-of-sentnece) \u3068\u304b\u3001HTML\u98a8\u306b `<s>` `</s>` \u3068\u3044\u3046\u4ed6\u3068\u88ab\u3089\u306a\u3044\u7279\u5225\u306a\u30e9\u30d9\u30eb\u3092\u7528\u3044\u308b.\n\n![3.png](https://qiita-image-store.s3.amazonaws.com/0/17022/cfee8a2c-4473-057e-e5cd-a279252709fd.png)\n\n\u3068\u3053\u308d\u3067\u3001\u305d\u308c\u304c\u672c\u5f53\u306b\u4e00\u3064\u306e\u5217\u306a\u3089\u3001\u305d\u306e\u9806\u5e8f\u306b\u95a2\u3057\u3066\u4f55\u304b\u3057\u3089\u306e\u50be\u5411\u304c\u3042\u3063\u3066\u3082\u826f\u3044\u306f\u305a\u3067\u3042\u308b.\n\u3053\u306e\u30e9\u30d9\u30eb\u306e\u6b21\u306b\u3053\u306e\u30e9\u30d9\u30eb\u304c\u6765\u3084\u3059\u3044\u3001\u6765\u306b\u304f\u3044\u3001\u307f\u305f\u3044\u306a.\n\n`chainer.links.CRF1d` \u306f `__call__` \u304c\u640d\u5931\u95a2\u6570\u3001 `argmax` \u304c\u4e88\u6e2c\u95a2\u6570\u3068\u3057\u3066\u8a2d\u8a08\u3055\u308c\u3066\u3044\u308b.\n\n\u640d\u5931\u95a2\u6570\u3067\u306f $f$ \u306b\u3088\u3063\u3066\u4e88\u6e2c\u3055\u308c\u305f\u5217 $y' = y_1', y_2', \\ldots, y_n'$ \u3068\u3001\n\u6b63\u89e3\u306e\u5217 $y = y_1, y_2, \\ldots, y_n$ \u3068\u3092\u6bd4\u8f03\u3059\u308b\u304c\u3001\n\u305d\u308c\u306b\u52a0\u3048\u3066 $y_{i-1}, y_i$ $(i=2,\\ldots,n)$ \u3092\u6bd4\u8f03\u3057\u3066\u3001\u3053\u306e\u30e9\u30d9\u30eb\u306e\u6b21\u306b\u3053\u306e\u30e9\u30d9\u30eb\u306f\u6765\u306b\u304f\u3044\u30cf\u30ba\u3001\u3068\u3044\u3046\u50be\u5411\u3092\u30b3\u30b9\u30c8\u3068\u3044\u3046\u5f62\u3067\u640d\u5931\u306b\u52a0\u3048\u308b.\n\n\u305d\u306e\u3088\u3046\u306a\u30b3\u30b9\u30c8\u306f\u5b66\u7fd2\u6642\u306b\u9006\u4f1d\u64ad\u3055\u308c\u3001\u307e\u305f\u4e88\u6e2c\u3067\u306f $f$ \u306b\u3088\u308b\u4e88\u6e2c\u306b\u3053\u306e\u30b3\u30b9\u30c8\u3092\u52a0\u5473\u3059\u308b.\n$y_i$ \u306e\u4e88\u6e2c\u306b $x_i$ \u53ca\u3073\u305d\u306e\u5468\u8fba\u306e\u307f\u306a\u3089\u305a\u3001$y_{i-1}$ \u3082\u5b9f\u8cea\u7684\u306b\u7d20\u6027\u306b\u7528\u3044\u3066\u3044\u308b\u3053\u3068\u306b\u306a\u308b.\n\n![4.png](https://qiita-image-store.s3.amazonaws.com/0/17022/b1b8537c-fd42-eb7f-fd25-c7c72f74cf4a.png)\n\n\n## \u5b9f\u88c5 (\u5229\u7528\u4f8b)\n\n\u4f7f\u3044\u65b9\u306e\u5fc3\u306f\u5206\u304b\u3063\u305f\u306e\u3067\u5b9f\u969b\u306b\u4f7f\u3063\u3066\u307f\u308b.\n\u6587 (\u6587\u5b57\u306e\u5217\u3068\u307f\u306a\u3057\u307e\u3059) \u304b\u3089\u9854\u6587\u5b57\u3092\u691c\u51fa\u3059\u308b\u3053\u3068\u3092\u76ee\u6307\u3057\u307e\u3059.\n\n(\u9854\u6587\u5b57\u691c\u51fa\u3092\u5927\u6614\u306b\u3084\u3063\u3066\u305f\u3053\u3068\u304c\u3042\u3063\u3066\u3001\u305d\u306e\u75d5\u8de1\u3092\u898b\u3064\u3051\u305f\u304b\u3089\u601d\u3044\u3064\u3044\u305f\u306e\u3060\u3051\u3069\u3001\u5225\u306b\u5927\u91cf\u306e\u8a13\u7df4\u30c7\u30fc\u30bf\u304c\u3042\u308b\u3068\u304b\u3067\u306f\u306a\u3044.)\n\n\u3053\u308c\u306f\u7cfb\u5217\u30e9\u30d9\u30ea\u30f3\u30b0\u3067\u3082\u533a\u9593\u3092\u691c\u51fa\u3059\u308b\u30bf\u30b9\u30af\u306a\u306e\u3067IOB\u30bf\u30b0\u3092\u4ed8\u3051\u308b\u3053\u3068\u306b\u3057\u307e\u3059.\nIOB\u30bf\u30b0\u306b\u3064\u3044\u3066\u306f https://en.wikipedia.org/wiki/Inside_Outside_Beginning \u306a\u3069\u3092\u53c2\u7167\u304f\u3060\u3055\u3044.\n\n\u6a19\u6e96\u5165\u529b\u304b\u3089\u8a13\u7df4\u30c7\u30fc\u30bf\u3092\u8aad\u307f\u307e\u3059.\n\u4e00\u884c\u4e00\u6587 (200\u6587\u5b57\u4ee5\u4e0b\u3092\u4eee\u5b9a) \u3067\u3001`<>`\u3068 `<>` \u306b\u56f2\u307e\u308c\u305f\u90e8\u5206\u3092\u9854\u6587\u5b57\u3060\u3068\u3057\u3066\u5b66\u7fd2\u3057\u307e\u3059.\n\n### \u30b3\u30fc\u30c9\n\n- https://gist.github.com/cympfh/9c592779a63ba804294a16a7402ae910\n\n### \u7d50\u679c\n\n```py3\ntest = '\u4e16\u754c\u304c\u5e73\u548c\u3067\u3042\u308a\u307e\u3059\u3088\u3046\u306b( \uff1b\u00b4\u0414\uff40)'\n# =>\n# [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 2, 2, 2, 2]\n# \u4e16\u754c\u304c\u5e73\u548c\u3067\u3042\u308a\u307e\u3059\u3088\u3046\u306b<>( \uff1b\u00b4\u0414\uff40)<>\n```\n\n\u3068\u3044\u3046\u308f\u3051\u3067 `\u4e16\u754c\u304c\u5e73\u548c\u3067\u3042\u308a\u307e\u3059\u3088\u3046\u306b( \uff1b\u00b4\u0414\uff40)` \u306e\u3046\u3061 `( \uff1b\u00b4\u0414\uff40)` \u304c\u9854\u6587\u5b57\u3068\u691c\u51fa\u3055\u308c\u307e\u3057\u305f.\n\n\u521d\u3081 $y_i$ \u306e\u4e88\u6e2c\u306b\u5148\u306b\u8aac\u660e\u3057\u305f\u4f8b\u306e\u3088\u3046\u306b $x_{i-1},x_i,x_{i+1}$ (\u30a6\u30a3\u30f3\u30c9\u30a6\u5e45 3) \u3092\u7d20\u6027\u306b\u8a66\u3057\u305f\u306e\u3067\u3059\u304c\u3001\u9854\u6587\u5b57\u691c\u51fa\u306e\u5834\u5408\u3001\u3061\u3087\u3063\u3068\u3053\u308c\u306f\u8db3\u308a\u306a\u3044\u3088\u3046\u3067\u3059. \u4f8b\u3048\u3070\u3001\u3053\u306e\u9854\u6587\u5b57\u306e\u62ec\u5f27\u304c\u672c\u6765\u306e\u610f\u5473\u306e\u62ec\u5f27\u3068\u3057\u3066\u4f7f\u308f\u308c\u3066\u308b\u304b\u3069\u3046\u304b\u306a\u3093\u3066\u524d\u5f8c1\u6587\u5b57\u3060\u3051\u3067\u306f\u3061\u3087\u3063\u3068\u3080\u305a\u304b\u3057\u3044\u3067\u3059. `)` \u306a\u3093\u3066\u4e00\u3064\u524d\u304c\u305f\u3060\u306e\u534a\u89d2\u7a7a\u767d\u3067\u4e00\u3064\u6b21\u304c\u6587\u672b\u306a\u306e\u3067. \u4e0a\u306e\u3046\u307e\u304f\u884c\u3063\u305f\u4f8b\u306f\u30a6\u30a3\u30f3\u30c9\u30a6\u5e45\u30925\u306b\u3057\u3066\u8a66\u3057\u305f\u7d50\u679c\u3067\u3059\u3002\u30b3\u30fc\u30c9\u3082\u305d\u3046\u306a\u3063\u3066\u3044\u307e\u3059\u3002\n", "tags": ["\u81ea\u7136\u8a00\u8a9e\u51e6\u7406", "Chainer", "\u6a5f\u68b0\u5b66\u7fd2"]}