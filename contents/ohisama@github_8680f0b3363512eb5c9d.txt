{"context": "\n\n\u6982\u8981\nQiita api\u3092\u53e9\u3044\u3066\u3001\u81ea\u5206\u3092\u30d5\u30a9\u30ed\u30fc\u3057\u3066\u3044\u308b\u65b9\u3005\u306e\u30d5\u30a9\u30ed\u30fc\u30ea\u30b9\u30c8\u306e\u4e2d\u306b\u30e9\u30a4\u30d0\u30eb\u3068\u306a\u308b\u65b9\u304c\u3044\u306a\u3044\u304b\u3001\u8abf\u3079\u3066\u307f\u305f\u3002\n\u3044\u305f\u3002knoguchi\u3055\u3093\u3060\u3002\n\n\u5199\u771f\n\n\n\u6210\u679c\u7269\nhttp://jsdo.it/ohisama1/kbaP\nhttp://jsdo.it/ohisama1/6Pow\n\n\u30b5\u30f3\u30d7\u30eb\u30b3\u30fc\u30c9\nvar usr = [{\n    \"name\": \"ohisama@github\",\n    \"imports\": [\"knoguchi\",\"yukimori\",\"stone89son\",\"soburi\",\"kexi\",\"7of9\",\"ienaga\",\"takish\",\"nubata\",\"selious\",\"tm1122@github\"]\n}];\nvar main = [];\nvar map = {};\nmain.push(usr[0]);\nvar res = [];\nfor (var a in usr[0].imports)\n{\n    var name = usr[0].imports[a];\n    var url = \"https://qiita.com/api/v2/users/\" + name + \"/followees?page=1&per_page=20\";\n    alert(url);\n    res.push($.ajax({\n        url: url,\n        type: 'GET'\n    }));\n}\n$.when.apply($, res).done(function() {\n    for (var i = 0; i < arguments.length; i++) \n    {\n        var result = arguments[i];\n        var name = usr[0].imports[i];\n        var json = result[0];\n        var nl = []; \n        for (var j in json)\n        {\n            var jj = json[j].id;\n            nl.push(jj);\n            var node = map[jj];\n            if (!node) \n            {\n                map[jj] = 0;\n                main.push({ \n                    \"name\": jj,\n                    \"imports\": [name]\n                });\n            }\n        }\n        main.push({\n            \"name\": name,\n            \"imports\": nl\n        });\n    }\n    var json = JSON.stringify(main);\n    var blob = new Blob([json], {\n        type: \"application/json\"\n    });\n    var url1 = URL.createObjectURL(blob);\n    var a = document.createElement('a');    \n    a.download = \"koko2.json\";\n    a.href = url1;\n    a.textContent = \"Download koko2.json\";\n    document.getElementById('koko').appendChild(a);\n});\n\n\n\u30b5\u30f3\u30d7\u30eb\u30b3\u30fc\u30c9\nvar diameter = 960,\n    radius = diameter / 2,\n    innerRadius = radius - 120;\nvar cluster = d3.layout.cluster().size([360, innerRadius]).sort(null).value(function(d) { \n    return d.size;\n});\nvar bundle = d3.layout.bundle();\nvar line = d3.svg.line.radial().interpolate(\"bundle\").tension(.85).radius(function(d) {\n    return d.y;\n}).angle(function(d) {\n    return d.x / 180 * Math.PI;\n});\nvar svg = d3.select(\"body\").append(\"svg\").attr(\"width\", diameter).attr(\"height\", diameter).append(\"g\").attr(\"transform\", \"translate(\" + radius + \",\" + radius + \")\");\nvar link = svg.append(\"g\").selectAll(\".link\"),\n    node = svg.append(\"g\").selectAll(\".node\");\nfunction mouseovered(d) {\n    node.each(function(n) { \n        n.target = n.source = false;\n    });\n    link.classed(\"link--target\", function(l) {\n        if (l.target === d) return l.source.source = true;\n    }).classed(\"link--source\", function(l) { \n        if (l.source === d) return l.target.target = true;\n    }).filter(function(l) { \n        return l.target === d || l.source === d;\n    }).each(function() { \n        this.parentNode.appendChild(this); \n    });\n    node.classed(\"node--target\", function(n) {\n        return n.target;\n    }).classed(\"node--source\", function(n) {\n        return n.source;\n    });\n}\nfunction mouseouted(d) {\n    link.classed(\"link--target\", false).classed(\"link--source\", false);\n    node.classed(\"node--target\", false).classed(\"node--source\", false);\n}\nd3.select(self.frameElement).style(\"height\", diameter + \"px\");\nfunction packageHierarchy(classes) {\n    var map = {};\n    function find(name, data) {\n        var node = map[name],\n            i;\n        if (!node) \n        {\n            node = map[name] = data || {\n                name: name, \n                children: []\n            };\n            if (name.length)\n            {\n                node.parent = find(name.substring(0, i = name.lastIndexOf(\".\")));\n                node.parent.children.push(node);\n                node.key = name.substring(i + 1);\n            }\n        }\n        return node;\n    }\n    classes.forEach(function(d) {\n        find(d.name, d);\n    });\n    return map[\"\"];\n}\nfunction packageImports(nodes) {\n    var map = {},\n        imports = [];\n    nodes.forEach(function(d) {\n        map[d.name] = d;\n    });\n    nodes.forEach(function(d) {\n        if (d.imports) d.imports.forEach(function(i) {\n            imports.push({\n                source: map[d.name],\n                target: map[i]\n            });\n        });\n    });\n    return imports;\n}\nd3.json(\"http://jsrun.it/assets/4/Y/j/5/4Yj5j\", function(error, classes) {\n    if (error) throw error;\n    var nodes = cluster.nodes(packageHierarchy(classes)),\n        links = packageImports(nodes);\n    node = node.data(nodes.filter(function(n) {\n        return !n.children;\n    })).enter().append(\"text\").attr(\"class\", \"node\").attr(\"dy\", \".31em\").attr(\"transform\", function(d) {\n        return \"rotate(\" + (d.x - 90) + \")translate(\" + (d.y + 8) + \",0)\" + (d.x < 180 ? \"\" : \"rotate(180)\"); \n    }).style(\"text-anchor\", function(d) {\n        return d.x < 180 ? \"start\" : \"end\";\n    }).text(function(d) {\n        return d.key; \n    }).on(\"mouseover\", mouseovered).on(\"mouseout\", mouseouted);\n    link = link.data(bundle(links)).enter().append(\"path\").each(function(d) {\n        d.source = d[0],\n        d.target = d[d.length - 1];\n    }).attr(\"class\", \"link\").attr(\"d\", line);\n});\n\n#\u6982\u8981\nQiita api\u3092\u53e9\u3044\u3066\u3001\u81ea\u5206\u3092\u30d5\u30a9\u30ed\u30fc\u3057\u3066\u3044\u308b\u65b9\u3005\u306e\u30d5\u30a9\u30ed\u30fc\u30ea\u30b9\u30c8\u306e\u4e2d\u306b\u30e9\u30a4\u30d0\u30eb\u3068\u306a\u308b\u65b9\u304c\u3044\u306a\u3044\u304b\u3001\u8abf\u3079\u3066\u307f\u305f\u3002\n\u3044\u305f\u3002knoguchi\u3055\u3093\u3060\u3002\n\n#\u5199\u771f\n![](http://jsdo-static-contents.s3.amazonaws.com/images/capture/6/P/o/6Pow.jpg?t=1489184649)\n\n#\u6210\u679c\u7269\n\nhttp://jsdo.it/ohisama1/kbaP\nhttp://jsdo.it/ohisama1/6Pow\n\n#\u30b5\u30f3\u30d7\u30eb\u30b3\u30fc\u30c9\n\n```\nvar usr = [{\n    \"name\": \"ohisama@github\",\n    \"imports\": [\"knoguchi\",\"yukimori\",\"stone89son\",\"soburi\",\"kexi\",\"7of9\",\"ienaga\",\"takish\",\"nubata\",\"selious\",\"tm1122@github\"]\n}];\nvar main = [];\nvar map = {};\nmain.push(usr[0]);\nvar res = [];\nfor (var a in usr[0].imports)\n{\n    var name = usr[0].imports[a];\n    var url = \"https://qiita.com/api/v2/users/\" + name + \"/followees?page=1&per_page=20\";\n    alert(url);\n    res.push($.ajax({\n        url: url,\n        type: 'GET'\n    }));\n}\n$.when.apply($, res).done(function() {\n    for (var i = 0; i < arguments.length; i++) \n    {\n        var result = arguments[i];\n        var name = usr[0].imports[i];\n        var json = result[0];\n        var nl = []; \n        for (var j in json)\n        {\n            var jj = json[j].id;\n            nl.push(jj);\n            var node = map[jj];\n            if (!node) \n            {\n                map[jj] = 0;\n                main.push({ \n                    \"name\": jj,\n                    \"imports\": [name]\n                });\n            }\n        }\n        main.push({\n            \"name\": name,\n            \"imports\": nl\n        });\n    }\n    var json = JSON.stringify(main);\n    var blob = new Blob([json], {\n        type: \"application/json\"\n    });\n    var url1 = URL.createObjectURL(blob);\n    var a = document.createElement('a');    \n    a.download = \"koko2.json\";\n    a.href = url1;\n    a.textContent = \"Download koko2.json\";\n    document.getElementById('koko').appendChild(a);\n});\n```\n\n#\u30b5\u30f3\u30d7\u30eb\u30b3\u30fc\u30c9\n\n```\nvar diameter = 960,\n    radius = diameter / 2,\n    innerRadius = radius - 120;\nvar cluster = d3.layout.cluster().size([360, innerRadius]).sort(null).value(function(d) { \n    return d.size;\n});\nvar bundle = d3.layout.bundle();\nvar line = d3.svg.line.radial().interpolate(\"bundle\").tension(.85).radius(function(d) {\n    return d.y;\n}).angle(function(d) {\n    return d.x / 180 * Math.PI;\n});\nvar svg = d3.select(\"body\").append(\"svg\").attr(\"width\", diameter).attr(\"height\", diameter).append(\"g\").attr(\"transform\", \"translate(\" + radius + \",\" + radius + \")\");\nvar link = svg.append(\"g\").selectAll(\".link\"),\n    node = svg.append(\"g\").selectAll(\".node\");\nfunction mouseovered(d) {\n    node.each(function(n) { \n        n.target = n.source = false;\n    });\n    link.classed(\"link--target\", function(l) {\n        if (l.target === d) return l.source.source = true;\n    }).classed(\"link--source\", function(l) { \n        if (l.source === d) return l.target.target = true;\n    }).filter(function(l) { \n        return l.target === d || l.source === d;\n    }).each(function() { \n        this.parentNode.appendChild(this); \n    });\n    node.classed(\"node--target\", function(n) {\n        return n.target;\n    }).classed(\"node--source\", function(n) {\n        return n.source;\n    });\n}\nfunction mouseouted(d) {\n    link.classed(\"link--target\", false).classed(\"link--source\", false);\n    node.classed(\"node--target\", false).classed(\"node--source\", false);\n}\nd3.select(self.frameElement).style(\"height\", diameter + \"px\");\nfunction packageHierarchy(classes) {\n    var map = {};\n    function find(name, data) {\n        var node = map[name],\n            i;\n        if (!node) \n        {\n            node = map[name] = data || {\n                name: name, \n                children: []\n            };\n            if (name.length)\n            {\n                node.parent = find(name.substring(0, i = name.lastIndexOf(\".\")));\n                node.parent.children.push(node);\n                node.key = name.substring(i + 1);\n            }\n        }\n        return node;\n    }\n    classes.forEach(function(d) {\n        find(d.name, d);\n    });\n    return map[\"\"];\n}\nfunction packageImports(nodes) {\n    var map = {},\n        imports = [];\n    nodes.forEach(function(d) {\n        map[d.name] = d;\n    });\n    nodes.forEach(function(d) {\n        if (d.imports) d.imports.forEach(function(i) {\n            imports.push({\n                source: map[d.name],\n                target: map[i]\n            });\n        });\n    });\n    return imports;\n}\nd3.json(\"http://jsrun.it/assets/4/Y/j/5/4Yj5j\", function(error, classes) {\n    if (error) throw error;\n    var nodes = cluster.nodes(packageHierarchy(classes)),\n        links = packageImports(nodes);\n    node = node.data(nodes.filter(function(n) {\n        return !n.children;\n    })).enter().append(\"text\").attr(\"class\", \"node\").attr(\"dy\", \".31em\").attr(\"transform\", function(d) {\n        return \"rotate(\" + (d.x - 90) + \")translate(\" + (d.y + 8) + \",0)\" + (d.x < 180 ? \"\" : \"rotate(180)\"); \n    }).style(\"text-anchor\", function(d) {\n        return d.x < 180 ? \"start\" : \"end\";\n    }).text(function(d) {\n        return d.key; \n    }).on(\"mouseover\", mouseovered).on(\"mouseout\", mouseouted);\n    link = link.data(bundle(links)).enter().append(\"path\").each(function(d) {\n        d.source = d[0],\n        d.target = d[d.length - 1];\n    }).attr(\"class\", \"link\").attr(\"d\", line);\n});\n```\n", "tags": ["QiitaAPI", "jsdo", "d3.js", "\u30c7\u30fc\u30bf\u30d3\u30b8\u30e5\u30a2\u30ea\u30bc\u30fc\u30b7\u30e7\u30f3"]}