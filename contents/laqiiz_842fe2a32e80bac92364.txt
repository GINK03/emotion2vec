{"tags": ["PostgreSQL", "geocoder", "ShellScript", "\u30aa\u30fc\u30d7\u30f3\u30c7\u30fc\u30bf", "\u5730\u56f3"], "context": " More than 1 year has passed since last update.\u95a2\u9023\u3057\u3066\u4ee5\u4e0b\u3082\u53c2\u8003\u306b\u3057\u3066\u304f\u3060\u3055\u3044\n\n\n\u521d\u3081\u3066\u5730\u56f3\u5468\u308a\u306e\u6280\u8853\u306b\u89e6\u308c\u305f\u6642\u306b\u4f5c\u3063\u305f\u307e\u3068\u3081\u8cc7\u6599 - Qiita\nGoogleMap\u306e\u30aa\u30fc\u30d7\u30f3\u30bd\u30fc\u30b9\u7248\u5730\u56f3\u30a2\u30d7\u30ea\uff08OSRM\uff09\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb - Qiita\n\n\n\n\u3084\u308a\u305f\u3044\u4e8b\nGoogle\u306eGeocoding\u3067\u3042\u3063\u305f\u308aYahoo!\u306e\u30b8\u30aa\u30b3\u30fc\u30c0API\u3092\u7528\u3044\u308c\u3070\u3001\u4f4f\u6240\u306e\u8868\u8a18\u3086\u308c\u306b\u3082\u5bfe\u5fdc\u3057\u305f\u3088\u308a\u30b9\u30de\u30fc\u30c8\u306a\u7def\u5ea6\u7d4c\u5ea6\u53d6\u5f97\u304c\u53ef\u80fd\u3067\u3059\u304c\u3001\u5229\u7528\u6570\u306e\u5236\u9650\u3084\u898f\u7d04\u304c\u3042\u308b\u306e\u304c\u4e0d\u4fbf\u3067\u3059\u3002\n\u3082\u3063\u3068\u4f55\u5ea6\u3067\u3082\u7e70\u308a\u8fd4\u3057\u81ea\u7531\u306b\u4f7f\u3048\u308b\u74b0\u5883\u304c\u6b32\u3057\u3044\uff01\u3068\u3044\u3046\u3053\u3068\u3067\u672c\u8a18\u4e8b\u306e\u5185\u5bb9\u3068\u306a\u308a\u307e\u3059\u3002\n\u300c\u5e02\u533a\u753a\u6751\u756a\u5730\u304b\u3089\u7def\u5ea6\u7d4c\u5ea6\u300d\u3067\u306f\u306a\u304f\u3001\u300c\u7def\u5ea6\u7d4c\u5ea6\u304b\u3089\u5e02\u533a\u753a\u6751\u756a\u5730\u300d\u3092\u53d6\u5f97\u3059\u308b\u683c\u597d\u3044\u3044\u3084\u308a\u65b9\u306f\u3001masuidrive\u69d8\u306e\u7d20\u6674\u3089\u3057\u304f\u53c2\u8003\u306b\u306a\u308b\u8a18\u4e8b\u3092\u53c2\u8003\u4e0b\u3055\u3044\u3002\n\n\u56fd\u571f\u4ea4\u901a\u7701\u306e\u30c7\u30fc\u30bf\u3092\u4f7f\u3063\u3066\u3001\u7def\u5ea6\u7d4c\u5ea6\u304b\u3089\u5e02\u533a\u753a\u6751\u307e\u3067\u3092\u53d6\u308a\u51fa\u3059 - Qiita\n\n\n\u30b5\u30de\u30ea\n\n\u30c7\u30fc\u30bf\u53d6\u5f97\nPostgreSQL\u306b\u7a81\u3063\u8fbc\u3080\n\u52d5\u4f5c\u78ba\u8a8d\n\n\n\u30c7\u30fc\u30bf\u53d6\u5f97\n\u4f4d\u7f6e\u53c2\u7167\u60c5\u5831\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u30b5\u30fc\u30d3\u30b9\u306b\u3064\u3044\u3066\u304b\u3089\u30c7\u30fc\u30bf\u53d6\u5f97\n\u56fd\u571f\u4ea4\u901a\u7701\u304c\u51fa\u3057\u3066\u304f\u308c\u3066\u3044\u308b\u30c7\u30fc\u30bf\u3067\u3059\u3002\n2014\u5e74\u3053\u308d\u304b\u3089\u753a\u4e01\u76ee\u30ec\u30d9\u30eb\u306e\u30c7\u30fc\u30bf\u3092\u63d0\u4f9b\u3057\u3066\u304f\u308c\u3066\u3044\u308b\u305d\u3046\u3067\u3059\u3002\n\n\u300c\u4f4d\u7f6e\u53c2\u7167\u60c5\u5831\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u30b5\u30fc\u30d3\u30b9\u3078\u300d\u306e\u30ea\u30f3\u30af\u3092\u30af\u30ea\u30c3\u30af\n\u3000\u2192\u300c\u90fd\u9053\u5e9c\u770c\u9078\u629e\u300d\u306e\u30ea\u30f3\u30af\u3092\u30af\u30ea\u30c3\u30af\n\u3000\u3000\u2192\u300c\u5168\u3066\u306e\u90fd\u9053\u5e9c\u770c\u3092\u9078\u629e\u300d\n\u3000\u3000\u3000\u2192\u300c\u8857\u533a\u30ec\u30d9\u30eb\u300d\u3092\u9078\u629e\u3057\u3066\u305d\u308c\u305e\u308c\u30dd\u30c1\u30dd\u30c1DL\n(\u203b)\u90fd\u9053\u5e9c\u770c\u3054\u3068\u306b\u30dd\u30c1\u30dd\u30c1\u3059\u308b\u306e\u3067\u6642\u9593\u304b\u304b\u308a\u307e\u3059\u2025\u3002\n\n\n\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u7d50\u679c\n  % ls                                                                                    \n01000-12.0a.zip  09000-12.0a.zip  17000-12.0a.zip  25000-12.0a.zip  33000-12.0a.zip  41000-12.0a.zip\n02000-12.0a.zip  10000-12.0a.zip  18000-12.0a.zip  26000-12.0a.zip  34000-12.0a.zip  42000-12.0a.zip\n03000-12.0a.zip  11000-12.0a.zip  19000-12.0a.zip  27000-12.0a.zip  35000-12.0a.zip  43000-12.0a.zip\n04000-12.0a.zip  12000-12.0a.zip  20000-12.0a.zip  28000-12.0a.zip  36000-12.0a.zip  44000-12.0a.zip\n05000-12.0a.zip  13000-12.0a.zip  21000-12.0a.zip  29000-12.0a.zip  37000-12.0a.zip  45000-12.0a.zip\n06000-12.0a.zip  14000-12.0a.zip  22000-12.0a.zip  30000-12.0a.zip  38000-12.0a.zip  46000-12.0a.zip\n07000-12.0a.zip  15000-12.0a.zip  23000-12.0a.zip  31000-12.0a.zip  39000-12.0a.zip  47000-12.0a.zip\n08000-12.0a.zip  16000-12.0a.zip  24000-12.0a.zip  32000-12.0a.zip  40000-12.0a.zip\n\n\n\n\n\u30c7\u30fc\u30bf\u69cb\u9020\n\u4ee5\u4e0b\u3067\u5b9a\u7fa9\u3055\u308c\u3066\u3044\u307e\u3059\u3002\nhttp://nlftp.mlit.go.jp/isj/data.html\n\nPostgreSQL\u306b\u7a81\u3063\u8fbc\u3080\nPostgreSQL\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u306f\u3053\u306e\u3042\u305f\u308a\u3092\u53c2\u8003\u306b\u3002\n \u683c\u7d0d\u5148\u306e\u30c6\u30fc\u30d6\u30eb\u306f\u4ee5\u4e0b\u306e\u5f62\u5f0f\u3068\u3057\u3066\u3044\u307e\u3059\u3002\n \uff08\u30b8\u30aa\u30b0\u30e9\u30d5\u30a3\u30fc\u578b\u3068\u304b\u77e5\u3089\u306a\u3044\uff01\uff09 \n\n\ncreate\u6587\ncreate table m_address_gaiku (\n   prefectures_nm    varchar(4),\n   city_nm           varchar(10),\n   oaza_nm                varchar(20),\n   block_no            varchar(15),\n   coordinate_no   numeric(3),\n   x_coordinate      numeric(8, 1),\n   y_coordinate      numeric(8,1 ),\n   latitude           varchar(15),\n   longitude          varchar(15),\n   displayed_address_flg         char(1),\n   representative_flg    char(1),\n   before_history_flg    char(1),\n   after_history_flg char(1)\n);\n\n\n\n\u5148\u307b\u3069\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3057\u305fZIP\u30d5\u30a1\u30a4\u30eb\u3092\u89e3\u51cd\u3057\u3066\u3001\u683c\u7d0d\u3055\u308c\u3066\u3044\u308bCSV\u30d5\u30a1\u30a4\u30eb\u3092PostgreSQL\u306b\u8aad\u307f\u8fbc\u307e\u305b\u307e\u3059\nCopy\u30b3\u30de\u30f3\u30c9\u3092\u7528\u3044\u308b\u306e\u3067\u3001\u30e6\u30fc\u30b6\u6a29\u9650\u3092SuperUser\u306b\u3057\u3066\u304a\u304f\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\n\n\u53c2\u8003\u60c5\u5831 - PostgreSQL \u3067 COPY \u304c\u4f7f\u3048\u306a\u3044\u6642\n\n\n\u51e6\u7406\u5bfe\u8c61\u3092CSV\u306b\u62bd\u51fa\n# \u89e3\u51cd\nfind ./ -name \"*.zip\" -type f -print0 | xargs -0 -I {} unzip {} \n\n# \u5bfe\u8c61\u306eCSV\u4e00\u89a7\u3092\u51fa\u529b\nfind ./ -name \"*.csv\" -type f -print0 | xargs -0 -I {}  echo `pwd`/{} > list.txt\n\n\n\nCopy\u30b3\u30de\u30f3\u30c9\u5b9f\u884c\u7528\u306eshell\u3092\u4f5c\u6210\u3002\n\ncopy.sh\n#!/bin/sh\n\n# copy\u30b3\u30de\u30f3\u30c9\u4f5c\u6210\ncd `dirname $0`\ncat list.txt | while read file; do\necho $file\npsql gis << EOF\n        COPY m_address_gaiku (\n            prefectures_nm,\n            city_nm,\n            oaza_nm,\n            block_no,\n            coordinate_no,\n            x_coordinate,\n            y_coordinate,\n            latitude,\n            longitude,\n            displayed_address_flg,\n            representative_flg,\n            before_history_flg,\n            after_history_flg\n        )\n        FROM\n            '$file'\n        WITH\n        (\n            format      csv,\n            header      true,\n            delimiter   ',',\n            quote       '\"',\n            encoding    'Shift-JIS'\n        );\nEOF\ndone\n\n\n\u5148\u307b\u3069\u4f5c\u6210\u3057\u305fcopy.sh\u3092\u5b9f\u884c\u3057\u307e\u3059\u3002\n\u30d5\u30a1\u30a4\u30eb\u30d1\u30b9\u3068\u305d\u308c\u305e\u308c\u306e\u53d6\u308a\u8fbc\u307f\u4ef6\u6570\u304c\u8868\u793a\u3055\u308c\u307e\u3059\u3002\n\n\u5b9f\u884c\u7d50\u679c\n\n# \u53d6\u308a\u8fbc\u307fshell\u306e\u5b9f\u884c\n% sh copy.sh\n\n# \u5b9f\u884c\u7d50\u679c\n/home/mano/postgis/data/./38000-12.0a/38_2013.csv\nCOPY 202088\n/home/mano/postgis/data/./41000-12.0a/41_2013.csv\nCOPY 101563\n/home/mano/postgis/data/./02000-12.0a/02_2013.csv\nCOPY 136475\n#\u30fb\u30fb\u30fb\u4ee5\u4e0b\u7565\u30fb\u30fb\u30fb\n\n\n\n\u52d5\u4f5c\u78ba\u8a8d\n969\u4e07\u4ef6\u3068\u304b\u7d50\u69cb\u306a\u4ef6\u6570\u306b\u306a\u3063\u3066\u307e\u3059\u3002\n\n\u7d50\u679c\u4ef6\u6570\n=# select count(*) from m_address_gaiku;\n  count  \n---------\n 9696619\n(1 row)\n\n\n\u809d\u5fc3\u306e\u4e2d\u8eab\u30c1\u30a7\u30c3\u30af\u3002\n\u300c\u5317\u6d77\u9053\u306e\u65ed\u5ddd\u56db\u6761\u901a20\u4e01\u76ee\u300d\u306e\u7def\u5ea6\u7d4c\u5ea6\u3092\u8abf\u3079\u3066\u307f\u308b\u3002\nprefectures\u3084city\u3084area\u30ab\u30e9\u30e0\u305d\u308c\u305e\u308c\u306b\u30d0\u30a4\u30f3\u30c9\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\n\n\u7def\u5ea6\u7d4c\u5ea6\u7d50\u679c\n=# select prefectures_nm, city_nm, oaza_nm, block_no, latitude, longitude  from m_address_gaiku where prefectures_nm= '\u5317\u6d77\u9053' and city_nm= '\u65ed\u5ddd\u5e02' and oaza_nm like '\u56db\u6761\u901a\u4e8c\u5341\u4e01%';\n\nprefectures_nm|  city_nm|      oaza_nm      | block_no | latitude  | longitude  \n-------------+--------+----------------+------------+-----------+------------\n \u5317\u6d77\u9053      | \u65ed\u5ddd\u5e02 | \u56db\u6761\u901a\u4e8c\u5341\u4e01\u76ee | 1720       | 43.763105 | 142.379743\n \u5317\u6d77\u9053      | \u65ed\u5ddd\u5e02 | \u56db\u6761\u901a\u4e8c\u5341\u4e01\u76ee | \u53f35        | 43.763105 | 142.379743\n \u5317\u6d77\u9053      | \u65ed\u5ddd\u5e02 | \u56db\u6761\u901a\u4e8c\u5341\u4e01\u76ee | 9          | 43.763105 | 142.379743\n \u5317\u6d77\u9053      | \u65ed\u5ddd\u5e02 | \u56db\u6761\u901a\u4e8c\u5341\u4e01\u76ee | \u53f310       | 43.763105 | 142.379743\n \u5317\u6d77\u9053      | \u65ed\u5ddd\u5e02 | \u56db\u6761\u901a\u4e8c\u5341\u4e01\u76ee | 1717       | 43.763671 | 142.380069\n \u5317\u6d77\u9053      | \u65ed\u5ddd\u5e02 | \u56db\u6761\u901a\u4e8c\u5341\u4e01\u76ee | 4          | 43.763671 | 142.380069\n \u5317\u6d77\u9053      | \u65ed\u5ddd\u5e02 | \u56db\u6761\u901a\u4e8c\u5341\u4e01\u76ee | \u5de69        | 43.763671 | 142.380069\n \u5317\u6d77\u9053      | \u65ed\u5ddd\u5e02 | \u56db\u6761\u901a\u4e8c\u5341\u4e01\u76ee | \u5de66        | 43.763671 | 142.380069\n \u5317\u6d77\u9053      | \u65ed\u5ddd\u5e02 | \u56db\u6761\u901a\u4e8c\u5341\u4e01\u76ee | \u5de65        | 43.763671 | 142.380069\n \u5317\u6d77\u9053      | \u65ed\u5ddd\u5e02 | \u56db\u6761\u901a\u4e8c\u5341\u4e01\u76ee | \u5de62        | 43.763671 | 142.380069\n \u5317\u6d77\u9053      | \u65ed\u5ddd\u5e02 | \u56db\u6761\u901a\u4e8c\u5341\u4e01\u76ee | \u5de64        | 43.763671 | 142.380069\n\n\n\u3053\u306e\u30af\u30a8\u30ea\u7d50\u679c\u3092giocoding\u7d50\u679c\u3068\u6bd4\u3079\u3066\u307f\u308b\u3068\u2026\nwww.geocoding.jp/?q=\u5317\u6d77\u9053\u56db\u6761\u901a\uff12\uff10\u4e01\u76ee\n\n\u2026\u5408\u3063\u3066\u307e\u3059\u306d\uff01\n\n\u307e\u3068\u3081\n\n\u4f4f\u6240\u306e\u63fa\u308c\u3055\u3048\u7121\u8996\u3067\u304d\u308b\u74b0\u5883\u3067\u3042\u308c\u3070\u7def\u5ea6\u30fb\u7d4c\u5ea6\u3092\u53d6\u5f97\u3067\u304d\u308b\uff01\n\u4f4f\u6240\u304b\u3089\u7def\u5ea6\u7d4c\u5ea6\u3092\u5927\u91cf\u4ef6\u6570\u5f15\u304d\u5f53\u3066\u305f\u3044\u6642\u3092\u9664\u3051\u3070\u3001\u3068\u3066\u3082\u8ce2\u3044giocoding\u304b\u30b8\u30aa\u30b3\u30fc\u30c0API\u3092\u4f7f\u3044\u305f\u3044\uff01\n\n\u95a2\u9023\u3057\u3066\u4ee5\u4e0b\u3082\u53c2\u8003\u306b\u3057\u3066\u304f\u3060\u3055\u3044\n\n> * [\u521d\u3081\u3066\u5730\u56f3\u5468\u308a\u306e\u6280\u8853\u306b\u89e6\u308c\u305f\u6642\u306b\u4f5c\u3063\u305f\u307e\u3068\u3081\u8cc7\u6599 - Qiita] (http://qiita.com/laqiiz/items/7d256108920ff7afbf08)\n* [GoogleMap\u306e\u30aa\u30fc\u30d7\u30f3\u30bd\u30fc\u30b9\u7248\u5730\u56f3\u30a2\u30d7\u30ea\uff08OSRM\uff09\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb - Qiita](http://qiita.com/laqiiz/items/e188b0d5d21fe7aa0de7)\n\n# \u3084\u308a\u305f\u3044\u4e8b\n\nGoogle\u306e[Geocoding](http://www.geocoding.jp/)\u3067\u3042\u3063\u305f\u308aYahoo!\u306e[\u30b8\u30aa\u30b3\u30fc\u30c0API](http://developer.yahoo.co.jp/webapi/map/openlocalplatform/v1/geocoder.html)\u3092\u7528\u3044\u308c\u3070\u3001\u4f4f\u6240\u306e\u8868\u8a18\u3086\u308c\u306b\u3082\u5bfe\u5fdc\u3057\u305f\u3088\u308a\u30b9\u30de\u30fc\u30c8\u306a\u7def\u5ea6\u7d4c\u5ea6\u53d6\u5f97\u304c\u53ef\u80fd\u3067\u3059\u304c\u3001\u5229\u7528\u6570\u306e\u5236\u9650\u3084\u898f\u7d04\u304c\u3042\u308b\u306e\u304c\u4e0d\u4fbf\u3067\u3059\u3002\n\n\u3082\u3063\u3068\u4f55\u5ea6\u3067\u3082\u7e70\u308a\u8fd4\u3057\u81ea\u7531\u306b\u4f7f\u3048\u308b\u74b0\u5883\u304c\u6b32\u3057\u3044\uff01\u3068\u3044\u3046\u3053\u3068\u3067\u672c\u8a18\u4e8b\u306e\u5185\u5bb9\u3068\u306a\u308a\u307e\u3059\u3002\n\u300c\u5e02\u533a\u753a\u6751\u756a\u5730\u304b\u3089\u7def\u5ea6\u7d4c\u5ea6\u300d\u3067\u306f\u306a\u304f\u3001\u300c\u7def\u5ea6\u7d4c\u5ea6\u304b\u3089\u5e02\u533a\u753a\u6751\u756a\u5730\u300d\u3092\u53d6\u5f97\u3059\u308b\u683c\u597d\u3044\u3044\u3084\u308a\u65b9\u306f\u3001masuidrive\u69d8\u306e\u7d20\u6674\u3089\u3057\u304f\u53c2\u8003\u306b\u306a\u308b\u8a18\u4e8b\u3092\u53c2\u8003\u4e0b\u3055\u3044\u3002\n> [\u56fd\u571f\u4ea4\u901a\u7701\u306e\u30c7\u30fc\u30bf\u3092\u4f7f\u3063\u3066\u3001\u7def\u5ea6\u7d4c\u5ea6\u304b\u3089\u5e02\u533a\u753a\u6751\u307e\u3067\u3092\u53d6\u308a\u51fa\u3059 - Qiita](http://qiita.com/masuidrive/items/21a282c7bf54fd6a4985)\n\n# \u30b5\u30de\u30ea\n\n0. \u30c7\u30fc\u30bf\u53d6\u5f97\n0. PostgreSQL\u306b\u7a81\u3063\u8fbc\u3080\n0. \u52d5\u4f5c\u78ba\u8a8d\n\n# \u30c7\u30fc\u30bf\u53d6\u5f97\n\n[\u4f4d\u7f6e\u53c2\u7167\u60c5\u5831\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u30b5\u30fc\u30d3\u30b9\u306b\u3064\u3044\u3066](http://nlftp.mlit.go.jp/isj/)\u304b\u3089\u30c7\u30fc\u30bf\u53d6\u5f97\n\u56fd\u571f\u4ea4\u901a\u7701\u304c\u51fa\u3057\u3066\u304f\u308c\u3066\u3044\u308b\u30c7\u30fc\u30bf\u3067\u3059\u3002\n2014\u5e74\u3053\u308d\u304b\u3089\u753a\u4e01\u76ee\u30ec\u30d9\u30eb\u306e\u30c7\u30fc\u30bf\u3092\u63d0\u4f9b\u3057\u3066\u304f\u308c\u3066\u3044\u308b\u305d\u3046\u3067\u3059\u3002\n\n![\u4f4d\u7f6e\u53c2\u7167\u30b5\u30fc\u30d3\u30b9.png](https://qiita-image-store.s3.amazonaws.com/0/6463/647c0be2-977e-388d-8550-80c7593363c5.png)\n\n\u300c\u4f4d\u7f6e\u53c2\u7167\u60c5\u5831\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u30b5\u30fc\u30d3\u30b9\u3078\u300d\u306e\u30ea\u30f3\u30af\u3092\u30af\u30ea\u30c3\u30af\n\u3000\u2192\u300c\u90fd\u9053\u5e9c\u770c\u9078\u629e\u300d\u306e\u30ea\u30f3\u30af\u3092\u30af\u30ea\u30c3\u30af\n\u3000\u3000\u2192\u300c\u5168\u3066\u306e\u90fd\u9053\u5e9c\u770c\u3092\u9078\u629e\u300d\n\u3000\u3000\u3000\u2192\u300c\u8857\u533a\u30ec\u30d9\u30eb\u300d\u3092\u9078\u629e\u3057\u3066\u305d\u308c\u305e\u308c\u30dd\u30c1\u30dd\u30c1DL\n\n(\u203b)\u90fd\u9053\u5e9c\u770c\u3054\u3068\u306b\u30dd\u30c1\u30dd\u30c1\u3059\u308b\u306e\u3067\u6642\u9593\u304b\u304b\u308a\u307e\u3059\u2025\u3002\n\n> ```shell:\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u7d50\u679c\n  % ls                                                                                    \n01000-12.0a.zip  09000-12.0a.zip  17000-12.0a.zip  25000-12.0a.zip  33000-12.0a.zip  41000-12.0a.zip\n02000-12.0a.zip  10000-12.0a.zip  18000-12.0a.zip  26000-12.0a.zip  34000-12.0a.zip  42000-12.0a.zip\n03000-12.0a.zip  11000-12.0a.zip  19000-12.0a.zip  27000-12.0a.zip  35000-12.0a.zip  43000-12.0a.zip\n04000-12.0a.zip  12000-12.0a.zip  20000-12.0a.zip  28000-12.0a.zip  36000-12.0a.zip  44000-12.0a.zip\n05000-12.0a.zip  13000-12.0a.zip  21000-12.0a.zip  29000-12.0a.zip  37000-12.0a.zip  45000-12.0a.zip\n06000-12.0a.zip  14000-12.0a.zip  22000-12.0a.zip  30000-12.0a.zip  38000-12.0a.zip  46000-12.0a.zip\n07000-12.0a.zip  15000-12.0a.zip  23000-12.0a.zip  31000-12.0a.zip  39000-12.0a.zip  47000-12.0a.zip\n08000-12.0a.zip  16000-12.0a.zip  24000-12.0a.zip  32000-12.0a.zip  40000-12.0a.zip\n ```\n\n# \u30c7\u30fc\u30bf\u69cb\u9020\n\n\u4ee5\u4e0b\u3067\u5b9a\u7fa9\u3055\u308c\u3066\u3044\u307e\u3059\u3002\nhttp://nlftp.mlit.go.jp/isj/data.html\n\n# PostgreSQL\u306b\u7a81\u3063\u8fbc\u3080\n\n PostgreSQL\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u306f\u3053\u306e[\u3042\u305f\u308a](http://blog.scimpr.com/2012/09/01/ubuntu12-04%E3%81%A7postgresql%E3%82%92%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB%E3%81%99%E3%82%8B/)\u3092\u53c2\u8003\u306b\u3002\n \u683c\u7d0d\u5148\u306e\u30c6\u30fc\u30d6\u30eb\u306f\u4ee5\u4e0b\u306e\u5f62\u5f0f\u3068\u3057\u3066\u3044\u307e\u3059\u3002\n \uff08\u30b8\u30aa\u30b0\u30e9\u30d5\u30a3\u30fc\u578b\u3068\u304b\u77e5\u3089\u306a\u3044\uff01\uff09 \n \n >```sql:create\u6587\n >create table m_address_gaiku (\n >    prefectures_nm    varchar(4),\n >    city_nm           varchar(10),\n >    oaza_nm                varchar(20),\n >    block_no\t          varchar(15),\n >    coordinate_no   numeric(3),\n >    x_coordinate\t\tnumeric(8, 1),\n >    y_coordinate\t\tnumeric(8,1 ),\n >    latitude\t\t\t varchar(15),\n >    longitude\t\t\t varchar(15),\n >    displayed_address_flg\t\t\tchar(1),\n >    representative_flg\tchar(1),\n >    before_history_flg\tchar(1),\n >    after_history_flg\tchar(1)\n >);\n >```\n \n\n\u5148\u307b\u3069\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3057\u305fZIP\u30d5\u30a1\u30a4\u30eb\u3092\u89e3\u51cd\u3057\u3066\u3001\u683c\u7d0d\u3055\u308c\u3066\u3044\u308bCSV\u30d5\u30a1\u30a4\u30eb\u3092PostgreSQL\u306b\u8aad\u307f\u8fbc\u307e\u305b\u307e\u3059\nCopy\u30b3\u30de\u30f3\u30c9\u3092\u7528\u3044\u308b\u306e\u3067\u3001\u30e6\u30fc\u30b6\u6a29\u9650\u3092SuperUser\u306b\u3057\u3066\u304a\u304f\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\n> [\u53c2\u8003\u60c5\u5831 - PostgreSQL \u3067 COPY \u304c\u4f7f\u3048\u306a\u3044\u6642](http://bmath.org/wordpress/?p=1427)\n\n```sh:\u51e6\u7406\u5bfe\u8c61\u3092CSV\u306b\u62bd\u51fa\n# \u89e3\u51cd\nfind ./ -name \"*.zip\" -type f -print0 | xargs -0 -I {} unzip {} \n\n# \u5bfe\u8c61\u306eCSV\u4e00\u89a7\u3092\u51fa\u529b\nfind ./ -name \"*.csv\" -type f -print0 | xargs -0 -I {}  echo `pwd`/{} > list.txt\n\n```\n\nCopy\u30b3\u30de\u30f3\u30c9\u5b9f\u884c\u7528\u306eshell\u3092\u4f5c\u6210\u3002\n\n```sh:copy.sh\n#!/bin/sh\n\n# copy\u30b3\u30de\u30f3\u30c9\u4f5c\u6210\ncd `dirname $0`\ncat list.txt | while read file; do\necho $file\npsql gis << EOF\n        COPY m_address_gaiku (\n    \t    prefectures_nm,\n            city_nm,\n        \toaza_nm,\n        \tblock_no,\n        \tcoordinate_no,\n        \tx_coordinate,\n\t        y_coordinate,\n\t        latitude,\n\t        longitude,\n\t        displayed_address_flg,\n\t        representative_flg,\n\t        before_history_flg,\n\t        after_history_flg\n        )\n        FROM\n            '$file'\n        WITH\n        (\n\t        format\t\tcsv,\n        \theader\t\ttrue,\n        \tdelimiter\t',',\n        \tquote\t\t'\"',\n\t        encoding\t'Shift-JIS'\n        );\nEOF\ndone\n```\n\n\u5148\u307b\u3069\u4f5c\u6210\u3057\u305f```copy.sh```\u3092\u5b9f\u884c\u3057\u307e\u3059\u3002\n\u30d5\u30a1\u30a4\u30eb\u30d1\u30b9\u3068\u305d\u308c\u305e\u308c\u306e\u53d6\u308a\u8fbc\u307f\u4ef6\u6570\u304c\u8868\u793a\u3055\u308c\u307e\u3059\u3002\n\n```sh:\u5b9f\u884c\u7d50\u679c\n\n# \u53d6\u308a\u8fbc\u307fshell\u306e\u5b9f\u884c\n% sh copy.sh\n\n# \u5b9f\u884c\u7d50\u679c\n/home/mano/postgis/data/./38000-12.0a/38_2013.csv\nCOPY 202088\n/home/mano/postgis/data/./41000-12.0a/41_2013.csv\nCOPY 101563\n/home/mano/postgis/data/./02000-12.0a/02_2013.csv\nCOPY 136475\n#\u30fb\u30fb\u30fb\u4ee5\u4e0b\u7565\u30fb\u30fb\u30fb\n```\n\n# \u52d5\u4f5c\u78ba\u8a8d\n\n969\u4e07\u4ef6\u3068\u304b\u7d50\u69cb\u306a\u4ef6\u6570\u306b\u306a\u3063\u3066\u307e\u3059\u3002\n\n```sql:\u7d50\u679c\u4ef6\u6570\n=# select count(*) from m_address_gaiku;\n  count  \n---------\n 9696619\n(1 row)\n```\n\n\u809d\u5fc3\u306e\u4e2d\u8eab\u30c1\u30a7\u30c3\u30af\u3002\n\u300c\u5317\u6d77\u9053\u306e\u65ed\u5ddd\u56db\u6761\u901a20\u4e01\u76ee\u300d\u306e\u7def\u5ea6\u7d4c\u5ea6\u3092\u8abf\u3079\u3066\u307f\u308b\u3002\n```prefectures```\u3084```city```\u3084```area```\u30ab\u30e9\u30e0\u305d\u308c\u305e\u308c\u306b\u30d0\u30a4\u30f3\u30c9\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\n\n```sql:\u7def\u5ea6\u7d4c\u5ea6\u7d50\u679c\n=# select prefectures_nm, city_nm, oaza_nm, block_no, latitude, longitude  from m_address_gaiku where prefectures_nm= '\u5317\u6d77\u9053' and city_nm= '\u65ed\u5ddd\u5e02' and oaza_nm like '\u56db\u6761\u901a\u4e8c\u5341\u4e01%';\n\nprefectures_nm|  city_nm|      oaza_nm      | block_no | latitude  | longitude  \n-------------+--------+----------------+------------+-----------+------------\n \u5317\u6d77\u9053      | \u65ed\u5ddd\u5e02 | \u56db\u6761\u901a\u4e8c\u5341\u4e01\u76ee | 1720       | 43.763105 | 142.379743\n \u5317\u6d77\u9053      | \u65ed\u5ddd\u5e02 | \u56db\u6761\u901a\u4e8c\u5341\u4e01\u76ee | \u53f35        | 43.763105 | 142.379743\n \u5317\u6d77\u9053      | \u65ed\u5ddd\u5e02 | \u56db\u6761\u901a\u4e8c\u5341\u4e01\u76ee | 9          | 43.763105 | 142.379743\n \u5317\u6d77\u9053      | \u65ed\u5ddd\u5e02 | \u56db\u6761\u901a\u4e8c\u5341\u4e01\u76ee | \u53f310       | 43.763105 | 142.379743\n \u5317\u6d77\u9053      | \u65ed\u5ddd\u5e02 | \u56db\u6761\u901a\u4e8c\u5341\u4e01\u76ee | 1717       | 43.763671 | 142.380069\n \u5317\u6d77\u9053      | \u65ed\u5ddd\u5e02 | \u56db\u6761\u901a\u4e8c\u5341\u4e01\u76ee | 4          | 43.763671 | 142.380069\n \u5317\u6d77\u9053      | \u65ed\u5ddd\u5e02 | \u56db\u6761\u901a\u4e8c\u5341\u4e01\u76ee | \u5de69        | 43.763671 | 142.380069\n \u5317\u6d77\u9053      | \u65ed\u5ddd\u5e02 | \u56db\u6761\u901a\u4e8c\u5341\u4e01\u76ee | \u5de66        | 43.763671 | 142.380069\n \u5317\u6d77\u9053      | \u65ed\u5ddd\u5e02 | \u56db\u6761\u901a\u4e8c\u5341\u4e01\u76ee | \u5de65        | 43.763671 | 142.380069\n \u5317\u6d77\u9053      | \u65ed\u5ddd\u5e02 | \u56db\u6761\u901a\u4e8c\u5341\u4e01\u76ee | \u5de62        | 43.763671 | 142.380069\n \u5317\u6d77\u9053      | \u65ed\u5ddd\u5e02 | \u56db\u6761\u901a\u4e8c\u5341\u4e01\u76ee | \u5de64        | 43.763671 | 142.380069\n```\n\n\u3053\u306e\u30af\u30a8\u30ea\u7d50\u679c\u3092giocoding\u7d50\u679c\u3068\u6bd4\u3079\u3066\u307f\u308b\u3068\u2026\n[www.geocoding.jp/?q=\u5317\u6d77\u9053\u56db\u6761\u901a\uff12\uff10\u4e01\u76ee](http://www.geocoding.jp/?q=%E5%8C%97%E6%B5%B7%E9%81%93%E5%9B%9B%E6%9D%A1%E9%80%9A%EF%BC%92%EF%BC%90%E4%B8%81%E7%9B%AE)\n![giocoding.png](https://qiita-image-store.s3.amazonaws.com/0/6463/c992a2be-cd6f-f4c7-9176-f286c8d088b3.png)\n\n\u2026\u5408\u3063\u3066\u307e\u3059\u306d\uff01\n\n\n# \u307e\u3068\u3081\n\n* \u4f4f\u6240\u306e\u63fa\u308c\u3055\u3048\u7121\u8996\u3067\u304d\u308b\u74b0\u5883\u3067\u3042\u308c\u3070\u7def\u5ea6\u30fb\u7d4c\u5ea6\u3092\u53d6\u5f97\u3067\u304d\u308b\uff01\n* \u4f4f\u6240\u304b\u3089\u7def\u5ea6\u7d4c\u5ea6\u3092\u5927\u91cf\u4ef6\u6570\u5f15\u304d\u5f53\u3066\u305f\u3044\u6642\u3092\u9664\u3051\u3070\u3001\u3068\u3066\u3082\u8ce2\u3044giocoding\u304b\u30b8\u30aa\u30b3\u30fc\u30c0API\u3092\u4f7f\u3044\u305f\u3044\uff01\n"}