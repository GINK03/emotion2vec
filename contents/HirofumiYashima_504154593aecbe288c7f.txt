{"context": " More than 1 year has passed since last update.\n\nTAR\uff08\u95be\u5024\uff09\u30e2\u30c7\u30eb\u3068\u306f\n\n\u3053\u308c\u307e\u3067 Qiita \u306b\u6295\u7a3f\u3057\u305f\u8a18\u4e8b\u306e\u4e2d\u3067\u3001\u8003\u5bdf\u3059\u308b\u30c7\u30fc\u30bf\u671f\u9593\u4e2d\u306b\u3001\u6642\u7cfb\u5217\u5909\u6570\u9593\u306e\u30e2\u30c7\u30eb\u69cb\u9020\u304c\u5909\u5316\u3057\u3066\u3057\u307e\u3046\uff08\u306a\u3044\u3057\u306f\u3001\u5909\u5316\u3059\u308b\u53ef\u80fd\u6027\u306e\u3042\u308b\uff09\u5834\u5408\u306b\u3001\u6709\u52b9\u306a\u6642\u7cfb\u5217\u89e3\u6790\u624b\u6cd5\u3092\u7d39\u4ecb\u3057\u3066\u304d\u307e\u3057\u305f\u3002\n\uff08\u904e\u53bb\u306e\u6295\u7a3f\uff09\n\u300c\u3010R\u8a00\u8a9e\u3011\u6642\u9593\u306e\u52d5\u304d\u306b\u3042\u308f\u305b\u3066 \u5b9a\u6570\u9805 \u3084 \u56de\u5e30\u4fc2\u6570 \u304c\u52d5\u7684\u306b\u5909\u5316\u3057\u3066\u3044\u304f\u56de\u5e30\u30e2\u30c7\u30eb\u3092\u89e3\u6790\u3059\u308b\u65b9\u6cd5\uff08\u30c7\u30fc\u30bf\u306e\u89b3\u6e2c\u8aa4\u5dee\u3092\u53d6\u308a\u9664\u3044\u305f\u300c\u771f\u306e\u5024\u300d\u3092\u540c\u6642\u306b\u63a8\u5b9a\uff09\u300d\n\u300cR\u8a00\u8a9e\u3067\u30a6\u30a7\u30fc\u30d6\u30ec\u30c3\u30c8\u5909\u63db \uff5e\u6642\u7cfb\u5217\u30c7\u30fc\u30bf\u306e\u5404\u6ce2\u9577\u6210\u5206\u306e\u542b\u6709\u6fc3\u5ea6\u304c\u3001\u6642\u9593\u63a8\u79fb\u3068\u3068\u3082\u306b\u3069\u3046\u5909\u5316\u3059\u308b\u304b\u3092\u8996\u899a\u5316\u3059\u308b\u65b9\u6cd5\u300d\n\u4eca\u56de\u306f\u3001\u4ee5\u4e0b\u306e\u30e2\u30c7\u30eb \u3068 R \u3067\u306e\u5b9f\u88c5\u30d1\u30c3\u30b1\u30fc\u30b8\uff08\u95a2\u6570\uff09\u3092\u7d39\u4ecb\u3057\u307e\u3059\n \uff08\u5f15\u7528\u5143\uff09 \u9577\u5009 \u5927\u8f14\uff08\u6176\u61c9\u7fa9\u587e\u5927\u5b66\uff09Power point \u8cc7\u6599\u300c\u72b6\u614b\u5909\u5316\u3092\u4f34\u3046\u30e2\u30c7\u30eb\u300d\n\n\u95be\u5024\u30e2\u30c7\u30eb\u3068\u306f\u30e2\u30c7\u30eb\u306e\u30d1\u30e9\u30e1\u30fc\u30bf\u30fc\u304c\u72b6\u614b\u306b\u4f9d\u5b58\u3057\u3066\n\u5909\u5316\u3059\u308b\u30e2\u30c7\u30eb\u306e\u7dcf\u79f0\u3067\u3042\u308b\u3002\n\u72b6\u614b\u306f\u901a\u5e38\u3042\u308b\u89b3\u6e2c\u53ef\u80fd\u306a\u5909\u6570\u306b\u3088\u3063\u3066\u8868\u3055\u308c\u308b\u3002\n\u4f8b\u3048\u3070\u3042\u308b\u89b3\u6e2c\u53ef\u80fd\u306a\u5909\u6570\u3092 st \u3068\u3059\u308b\u3068\u3001\u3042\u308b\u5024 a \u306b\u5bfe\n\u3057\u3066\u3001 st < a \u306a\u3089\u72b6\u614b 1\u3001 st \u2265 a \u306a\u3089\u72b6\u614b 2\u306e\u3088\u3046\u306b\u72b6\u614b\n\u3092\u5b9a\u7fa9\u3059\u308b\u3002\n\u3053\u306e\u3088\u3046\u306a\u5909\u6570 st \u3092\u72b6\u614b\u5909\u6570\u3068\u3088\u3076\u3002\u72b6\u614b\u5909\u6570\u3092\u3069\u306e\u3088\n\u3046\u306b\u9078\u3076\u304b\u306f\u5206\u6790\u306e\u76ee\u7684\u306b\u4f9d\u5b58\u3059\u308b\u3002\n\n \u4ee5\u4e0b\u3001\u9577\u5009 \u5927\u8f14\uff08\u6176\u61c9\u7fa9\u587e\u5927\u5b66\uff09Power point \u8cc7\u6599\u300c\u72b6\u614b\u5909\u5316\u3092\u4f34\u3046\u30e2\u30c7\u30eb\u300d\u3088\u308a\u8ee2\u8f09\n\n\n\n\n\n\n\n\uff08\u53c2\u8003\u8cc7\u6599\uff09\n \u2460 \u9577\u5009 \u5927\u8f14\uff08\u6176\u61c9\u7fa9\u587e\u5927\u5b66\uff09\u300c\u72b6\u614b\u5909\u5316\u3092\u4f34\u3046\u30e2\u30c7\u30eb\u300d\n \u2461 \u9577\u5009 \u5927\u8f14\uff08\u6176\u61c9\u7fa9\u587e\u5927\u5b66\uff09\u300cR \u306b\u3088\u308b\u6642\u7cfb\u5217\u5206\u6790 5\u300d1. TAR \u30e2\u30c7\u30eb\u3092\u63a8\u5b9a\u3059\u308b\n \u2462 \u9280\u5ea7\u3067\u50cd\u304f\u30c7\u30fc\u30bf\u30b5\u30a4\u30a8\u30f3\u30c6\u30a3\u30b9\u30c8\u306e\u30d6\u30ed\u30b0 \uff082013-08-22\uff09\u300cR\u3067\u8a08\u91cf\u6642\u7cfb\u5217\u5206\u6790\uff1a\u72b6\u614b\u5909\u5316\u3092\u4f34\u3046\u30e2\u30c7\u30eb\uff08\u95be\u5024\u30e2\u30c7\u30eb\u3001\u5e73\u6ed1\u63a8\u79fb\u30e2\u30c7\u30eb\u3001\u30de\u30eb\u30b3\u30d5\u8ee2\u63db\u30e2\u30c7\u30eb\uff09\u300d\n\n\uff08\u5229\u7528\u4e8b\u4f8b\uff09\n \u7802\u7530 \u6d0b\u5fd7\uff08\u5c71\u5f62\u5927\u5b66 \u4eba\u6587\u5b66\u90e8\uff09\u300c\u95be\u5024\u81ea\u5df1\u56de\u5e30\u30e2\u30c7\u30eb\u306e\u65e5\u7d4c\u5e73\u5747\u682a\u4fa1\u6307\u6570\u3078\u306e\u5fdc\u7528\u300d\uff082006\uff09 \n \u7027\u672c\u592a\u90ce\u30fb\u5742\u672c\u76f4\u6a39\u300c\u69cb\u9020\u5909\u5316\u3068\u975e\u7dda\u5f62\u6027\u3092\u8003\u616e\u3057\u305f\u30e2\u30c7\u30eb\u306b\u3088\u308b\u308f\u304c\u56fd\u306e\u6b73\u5165\u3068\u6b73\u51fa\u306e\u56e0\u679c\u6027\u5206\u6790\u300d\n \u4f50\u7af9\u5149\u5f66\u300c\u65e5\u672c\u306b\u304a\u3051\u308b\u30d5\u30a3\u30c3\u30b7\u30e3\u30fc\u4eee\u8aac\u306e\u691c\u8a3c\n\u2015 TAR \u30e2\u30c7\u30eb\u3092\u7528\u3044\u305f\u4e00\u8003\u5bdf\u2015\u300d \n\n\nR \u306b\u304a\u3051\u308b\u5b9f\u88c5\u30d1\u30c3\u30b1\u30fc\u30b8\n\n\u30d1\u30c3\u30b1\u30fc\u30b8 {tsDyn}\n\n\n\u975e\u7dda\u5f62\u81ea\u5df1\u56de\u5e30\uff08\u6642\u7cfb\u5217\uff09\u30e2\u30c7\u30eb\u306e\u89e3\u6790\u306b\u7279\u5316\u3057\u305f\u30d1\u30c3\u30b1\u30fc\u30b8\u306b {tsDyn} (timeseries dynamics)\u304c\u3042\u308a\u307e\u3059\n \uff08 CRAN \u767b\u9332 \u30d1\u30c3\u30b1\u30fc\u30b8\u30de\u30cb\u30e5\u30a2\u30eb \u3078\u306e\u30ea\u30f3\u30af \uff09\n  \uff08 \u4e0a\u8a18\u30de\u30cb\u30e5\u30a2\u30eb\u304b\u3089\u8cbc\u3089\u308c\u3066\u3044\u308b\u30ea\u30f3\u30af\u30da\u30fc\u30b8\uff09 \n\ntsDyn is an R package for nonlinear time series modelling.\nIn particular, some non-linear autoregressive models are implemented (NLAR):\nSETAR\nLSTAR\nSTAR\nNNET\nAAR\nThere are also some tests for nonlinearity and independence. A short guide is bundled, once installed type\nvignette('tsDyn')\n\n\n\u4e0a\u8a18\u306e\u3088\u3046\u306b\u3001\u8907\u6570\u306e\u975e\u7dda\u5f62\u81ea\u5df1\u56de\u5e30\u30e2\u30c7\u30eb\u3092\u6271\u3046\u305f\u3081\u306e\u95a2\u6570\u304c\u7528\u610f\u3055\u308c\u3066\u3044\u307e\u3059\u3002\n\n\n\u81ea\u5df1\u52b1\u8d77\uff08 Self-Exciting Threshold AutoRegressive \uff09 (SETAR)\u30e2\u30c7\u30eb\n\n\n \uff08 Wikipedia \uff09 \n\n\n\u5e73\u6ed1\u63a8\u79fb\uff08 ST \uff09\u81ea\u5df1\u56de\u5e30 \uff08 AR \uff09\u30e2\u30c7\u30eb\u3000(smooth-transition model)\n\n\n \uff08 \u9280\u5ea7\u3067\u50cd\u304f\u30c7\u30fc\u30bf\u30b5\u30a4\u30a8\u30f3\u30c6\u30a3\u30b9\u30c8\u306e\u30d6\u30ed\u30af \uff09 \n\n\n\u30ed\u30b8\u30b9\u30c6\u30a3\u30c3\u30af\uff08 L \uff09 \u5e73\u6ed1\u63a8\u79fb\uff08 ST \uff09\u81ea\u5df1\u56de\u5e30 \uff08 AR \uff09\u30e2\u30c7\u30eb\u3000(logistic smooth-transition model)\n\n\n \uff08 \u9280\u5ea7\u3067\u50cd\u304f\u30c7\u30fc\u30bf\u30b5\u30a4\u30a8\u30f3\u30c6\u30a3\u30b9\u30c8\u306e\u30d6\u30ed\u30af \uff09 \n\n\nnnet \uff08\u975e\u7dda\u5f62\u6700\u5c0f\u30cb\u4e57\u6cd5\uff09\u30e2\u30c7\u30eb\n\n\nAAR \u52a0\u6cd5\uff08Additive\uff09\u975e\u7dda\u5f62\uff08nonlinear\uff09\u81ea\u5df1\u56de\u5e30\uff08autoregressive\uff09\u30e2\u30c7\u30eb\u3000\n\n iAnalysis \uff5e\u304a\u3068\u3046\u3055\u3093\u306e\u89e3\u6790\u65e5\u8a18\uff5e\u3000\uff082010-05-14\uff09\u300c[R\u30e9\u30a4\u30d6\u30e9\u30ea\u63a2\u7d22]R\u30e9\u30a4\u30d6\u30e9\u30ea\u306e\u63a2\u7d223\uff08\u6642\u7cfb\u5217\u30e2\u30c7\u30eb\u3001\u7d4c\u6e08\uff09\n\n\n\n\u672c\u7a3f\u3067\u306f\u3053\u306e\u3046\u3061\u3001\u72b6\u614b\u5909\u6570\u304c\u3001\u81ea\u5df1\u306e\u904e\u53bb\u6642\u70b9\u306e\u5024\uff08\u4f55\u671f\u524d\u304b\u306e\u671f\u6570\u3092AR(m)\u306e\u6b21\u6570m\u3067\u5b9a\u7fa9\uff09\u3067\u3042\u308b\u8a2d\u5b9a\u30e2\u30c7\u30eb\u306e setar( ) \uff08\u81ea\u5df1\u52b1\u8d77\u95be\u5024\u30e2\u30c7\u30eb\uff09\u95a2\u6570\u3092\u4f7f\u3046\u65b9\u6cd5\u3092\u3068\u308a\u3042\u3052\u307e\u3059\u3002\n\n\uff08 \u4f7f\u3044\u65b9 \uff09\n[\u7d44\u8fbc\u307f\u30c7\u30fc\u30bf] lynx  \uff08\u5317\u897f\u30ab\u30ca\u30c0\u306e\u30aa\u30aa\u30e4\u30de\u30cd\u30b3\u3000\u5e74\u6b21\u6355\u7372\u500b\u4f53\u6570\uff09\n[\u95a2\u6570] setar(  )  \u95a2\u6570  \n\n\uff08\u95a2\u6570\u306e\u5f15\u6570\uff09\u3000\u30c7\u30fc\u30bf\u30aa\u30d6\u30b8\u30a7\u30af\u30c8 , \u5404\u30ec\u30b8\u30fc\u30e0\u306e AR\u30e2\u30c7\u30eb\u6b21\u6570 , \u30ec\u30b8\u30fc\u30e0\u6570, etc\u3000\n\n\uff08\u95a2\u6570\u306e\u623b\u308a\u5024\uff09\n\n\n\u3010\u30e2\u30c7\u30eb\u69cb\u7bc9 \u53ca\u3073 \u63a8\u8a08\u306e\u624b\u9806\u3011\n\n\n\uff08\uff11\uff09\u30e2\u30c7\u30eb\u8a2d\u8a08  setar( ) \uff1a \u3042\u3089\u304b\u3058\u3081 \u60f3\u5b9a\u3055\u308c\u308b \u5909\u5316\u306e\u6570\uff08\u533a\u5206\u6570\uff09 \u3068 \u5909\u5316\u306e\u7bc4\u56f2\uff08\u533a\u5206\u533a\u9593\uff09 \u3092\u5f15\u6570\u306b\u6e21\u3059\n\n\uff08\uff12\uff09\u30e2\u30c7\u30eb\u63a8\u8a08  summary( \u30e2\u30c7\u30eb\u540d ) \uff1a \u63a8\u8a08\u306e\u5b9f\u884c\u3068\u7d50\u679c\u306e\u53d6\u5f97\n\n\uff08\uff13\uff09\u7d50\u679c\u306e\u8996\u899a\u5316 plot(summary( )) \uff1a\u30b0\u30e9\u30d5\u51fa\u529b\n[\u95a2\u6570 \u4ed5\u69d8\uff08\u8a73\u7d30\uff09]\n\nR\n?setar\n\n\nSETAR {tsDyn}   R Documentation\nSelf Threshold Autoregressive model\n\nDescription \uff08\u6982\u8981\uff09\n\nSelf Exciting Threshold AutoRegressive model.\n\nUsage \uff08\u95a2\u6570\u306e\u4ed5\u69d8\uff09\n\nsetar(x, m, d=1, steps=d, series, mL, mM, mH, thDelay=0, mTh, thVar, th, trace=FALSE, \n      nested=FALSE, include = c( \"const\", \"trend\",\"none\", \"both\"), \n      common=c(\"none\", \"include\",\"lags\", \"both\"), model=c(\"TAR\", \"MTAR\"), ML=seq_len(mL), \n      MM=seq_len(mM), MH=seq_len(mH),nthresh=1,trim=0.15, type=c(\"level\", \"diff\", \"ADF\"),\n      restriction=c(\"none\",\"OuterSymAll\",\"OuterSymTh\") )\nArguments\n\nx   \ntime series\n\nm, d, steps \nembedding dimension, time delay, forecasting steps\n\nseries  \ntime series name (optional)\n\nmL,mM, mH   \nautoregressive order for \u2018low\u2019 (mL) \u2018middle\u2019 (mM, only useful if nthresh=2) and \u2018high\u2019 (mH)regime (default values: m). Must be <=m. Alternatively, you can specify ML\n\nthDelay \n'time delay' for the threshold variable (as multiple of embedding time delay d)\n\nmTh \ncoefficients for the lagged time series, to obtain the threshold variable\n\nthVar   \nexternal threshold variable\n\nth  \nthreshold value (if missing, a search over a reasonable grid is tried)\n\ntrace   \nshould additional infos be printed? (logical)\n\ninclude \nType of deterministic regressors to include\n\ncommon  \nIndicates which elements are common to all regimes: no, only the include variables, the lags or both\n\nML,MM,MH    \nvector of lags for order for \u2018low\u2019 (ML) \u2018middle\u2019 (MM, only useful if nthresh=2) and \u2018high\u2019 (MH)regime. Max must be <=m\n\nmodel   \nCurrently not implemented\n\nnthresh \nNumber of threshold of the model\n\ntrim    \ntrimming parameter indicating the minimal percentage of observations in each regime. Default to 0.15\n\ntype    \nWhether the variable is taken is level, difference or a mix (diff y= y-1, diff lags) as in the ADF test\n\nrestriction \nRestriction on the threshold. OuterSymAll will take a symmetric threshold and symmetric coefficients for outer regimes. OuterSymTh currently unavailable\n\nnested  \nWhether is this a nested call? (useful for correcting final model df)\n\n\nValue \uff08\u623b\u308a\u5024\uff09\n\nAn object of class nlar, subclass setar\n\nExamples\n\nR\n#fit a SETAR model, with threshold as suggested in Tong(1990, p 377)\nmod.setar <- setar(log10(lynx), m=2, thDelay=1, th=3.25)\nmod.setar\nsummary(mod.setar)\n\nif(require(FinTS)) {\n    data(m.unrate)\n    setar(diff(m.unrate), ML=c(2,3,4,12), MH=c(2,4,12), th=0.1, include=\"none\")\n}\n\n\n\n\n\uff08 \u4f7f\u7528\u4f8b \uff09\n\n\uff08\u4ee5\u4e0b\u3001\u53c2\u8003\u8cc7\u6599 \u2461\u306e\u30b9\u30af\u30ea\u30d7\u30c8\u306b\u3001\u8cc7\u6599 \u2462\u306e\u95a2\u6570\u4f7f\u7528\u6cd5\u3092\u8ffd\u52a0\u3057\u3066\u5b9f\u884c\u3059\u308b\u3053\u3068\u3067\u3001{tsDyn} \u306e\u4f7f\u3044\u65b9\u3092\u78ba\u8a8d\u3057\u307e\u3059\uff09\n \uff08\u4ee5\u4e0b\u3001\u8cc7\u6599 \u2461 \u9577\u5009\uff08\u6176\u61c9\u7fa9\u587e\u5927\u5b66\uff09\u6240\u53ce\u306e\u30b3\u30fc\u30c9\u3092\u3001\u307b\u307c\u305d\u306e\u307e\u307e\u5b9f\u884c\uff09\n\n\u30d1\u30c3\u30b1\u30fc\u30b8\u7528\u610f\n\n\nR\ninstall.packages(\"tseriesChaos\")\ninstall.packages(\"tsDyn\")\n\nrequire(tseriesChaos)\nrequire(tsDyn)\n\n\n\n**\u7d44\u8fbc\u307f\u30c7\u30fc\u30bf\u306e\u30ed\u30fc\u30c9 \u3068 \u4e2d\u8eab\u306e\u78ba\u8a8d\n\nR\ndata(lynx) #load data ( yearly data of observered (caputured) numbers of cats at Northwestern Canada )  \nstr(lynx)  #see data structure\n\n\nTime-Series [1:114] from 1821 to 1934: 269 321 585 871 1475 ...\n\n\nR\nsummary(lynx)\n\n\n Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n   39.0   348.2   771.0  1538.0  2567.0  6991.0 \n\n\nR\nprint(class(lynx))\n\n\n[1] \"ts\"\n\nts.plot(lynx)\n\n\n\nR\nx <- log10(lynx)\nts.plot(x)\n\n\n\n\n\n\uff08\u307e\u305a\u306f\u3001\u3075\u3064\u3046\u306eAR\u30e2\u30c7\u30eb\uff09\n\nAR(2)\u30e2\u30c7\u30eb\n\u3010\u30e2\u30c7\u30eb\u8a2d\u8a08\u95a2\u6570\u3011 linear() \u95a2\u6570\n\nR\nar2 <- linear(x, m=2)\n\nprint(ar2)\n\n\nNon linear autoregressive model\n\nAR model\nCoefficients:\n     const      phi.1      phi.2 \n 1.0576005  1.3842377 -0.7477757 \n\n\n\nTAR \uff08\u95be\uff08\u3057\u304d\u3044\uff09\u5024 \u30e2\u30c7\u30eb\uff09\n\n\u30e2\u30c7\u30eb\u8a2d\u5b9a\u4e8b\u4f8b 1\n(all of parameters L, H, m to be set to 3)\n( L: AR order degree of Low regime / H: AR order degree of High regime )\n\nR\n# setar() function\nset <- setar(x, m=3)\n\n\nWarning message:\nPossible unit root in the high  regime. Roots are: 0.9858 0.9858 4.3523 \n\n\nR\nsummary(set)\n\n\nNon linear autoregressive model\n\nSETAR model ( 2 regimes)\nCoefficients:\nLow regime:\n    phiL.1     phiL.2     phiL.3    const L \n 1.1175812 -0.1165550 -0.1532651  0.5886583 \n\nHigh regime:\n    phiH.1     phiH.2     phiH.3    const H \n 1.4029086 -0.6538670 -0.2364283  1.4051764 \n\nThreshold:\n-Variable: Z(t) = + (1) X(t)+ (0)X(t-1)+ (0)X(t-2)\n-Value: 2.588\nProportion of points in low regime: 30.63%   High regime: 69.37% \n\nResiduals:\n      Min        1Q    Median        3Q       Max \n-0.566419 -0.105803  0.013666  0.135648  0.426856 \n\nFit:\nresiduals variance = 0.03842,  AIC = -354, MAPE = 5.683%\n\nCoefficient(s):\n\n         Estimate  Std. Error  t value  Pr(>|t|)    \nconst L   0.58866     0.29640   1.9860 0.0496118 *  \nphiL.1    1.11758     0.16442   6.7970 6.482e-10 ***\nphiL.2   -0.11655     0.20023  -0.5821 0.5617302    \nphiL.3   -0.15327     0.11730  -1.3066 0.1941901    \nconst H   1.40518     0.23618   5.9495 3.513e-08 ***\nphiH.1    1.40291     0.11249  12.4719 < 2.2e-16 ***\nphiH.2   -0.65387     0.18814  -3.4754 0.0007403 ***\nphiH.3   -0.23643     0.13197  -1.7915 0.0760691 .  \n---\nSignif. codes:  0 \u2018***\u2019 0.001 \u2018**\u2019 0.01 \u2018*\u2019 0.05 \u2018.\u2019 0.1 \u2018 \u2019 1\n\nThreshold\nVariable: Z(t) = + (1) X(t) + (0) X(t-1)+ (0) X(t-2)\n\nValue: 2.588\n\n \u9280\u5ea7\u3067\u5b66\u3076\u30c7\u30fc\u30bf\u30b5\u30a4\u30a8\u30f3\u30c6\u30a3\u30b9\u30c8\u306e\u30d6\u30ed\u30b0 \u3092\u53c2\u8003\u306b\u3001\u30b0\u30e9\u30d5\u63cf\u753b \n\nR\nplot(set)\n\n\n> plot(set)\nHit <Return> to see next plot: \n\n\nHit <Return> to see next plot:\n\n\nHit <Return> to see next plot:\n\n\nHit <Return> to see next plot:\n\n\nHit <Return> to see next plot:\n\n\nHit <Return> to see next plot:\n\n\nHit <Return> to see next plot:\n\n\nHit <Return> to see next plot:\n\n\nHit <Return> to see next plot:\n\n\n\u30e2\u30c7\u30eb\u8a2d\u5b9a\u4e8b\u4f8b 2\nEstimate TAR model (parameter L=1 , H=2. set different AR order degrees between L (Low regime) and H (High regime))\n\nR\nset2 <- setar(x, mL=1, mH=2)\n\nsummary(set2)\n\n\nNon linear autoregressive model\n\nSETAR model ( 2 regimes)\nCoefficients:\nLow regime:\n   phiL.1   const L \n0.9863628 0.1930968 \n\nHigh regime:\n    phiH.1     phiH.2    const H \n 1.5476983 -0.9562741  1.1808695 \n\nThreshold:\n-Variable: Z(t) = + (1) X(t)+ (0)X(t-1)\n-Value: 2.558\nProportion of points in low regime: 27.68%   High regime: 72.32% \n\nResiduals:\n      Min        1Q    Median        3Q       Max \n-0.689146 -0.127983  0.029727  0.142420  0.474525 \n\nFit:\nresiduals variance = 0.0443,  AIC = -343, MAPE = 6.156%\n\nCoefficient(s):\n\n         Estimate  Std. Error  t value  Pr(>|t|)    \nconst L  0.193097    0.292729   0.6596    0.5109    \nphiL.1   0.986363    0.132005   7.4722 2.093e-11 ***\nconst H  1.180869    0.213553   5.5296 2.220e-07 ***\nphiH.1   1.547698    0.088773  17.4343 < 2.2e-16 ***\nphiH.2  -0.956274    0.073336 -13.0396 < 2.2e-16 ***\n---\nSignif. codes:  0 \u2018***\u2019 0.001 \u2018**\u2019 0.01 \u2018*\u2019 0.05 \u2018.\u2019 0.1 \u2018 \u2019 1\n\nThreshold\nVariable: Z(t) = + (1) X(t) + (0) X(t-1)\n\nValue: 2.558\n\n\nR\nplot(set2)\n\n\n\n\n\n\n\n\n\n\n\u30e2\u30c7\u30eb\u8a2d\u5b9a\u4e8b\u4f8b 3\nChange state variable \uff08\u72b6\u614b\u5909\u6570\uff09from Xt to Xt-1\nEstimate TAR model (parameter L=1 , H=2. set different AR order degrees between L (Low regime) and H (High regime))\n\nR\n#set \"thDelay\" to 1\nset3 <- setar(x, mL=1, mH=2, thDelay=1)\n\n\nWarning messages:\n1: Possible unit root in the high  regime. Roots are: 0.929 0.929 \n\n\nR\nsummary(set3)\n\n\n\nNon linear autoregressive model\n\nSETAR model ( 2 regimes)\nCoefficients:\nLow regime:\n    phiL.1    const L \n1.08403352 0.01640729 \n\nHigh regime:\n   phiH.1    phiH.2   const H \n 1.492201 -1.158738  2.069329 \n\nThreshold:\n-Variable: Z(t) = + (0) X(t)+ (1)X(t-1)\n-Value: 2.867\nProportion of points in low regime: 49.11%   High regime: 50.89% \n\nResiduals:\n      Min        1Q    Median        3Q       Max \n-0.725279 -0.117072  0.023711  0.115959  0.511283 \n\nFit:\nresiduals variance = 0.04379,  AIC = -345, MAPE = 5.959%\n\nCoefficient(s):\n\n         Estimate  Std. Error  t value  Pr(>|t|)    \nconst L  0.016407    0.168480   0.0974    0.9226    \nphiL.1   1.084034    0.066237  16.3660 < 2.2e-16 ***\nconst H  2.069329    0.402274   5.1441 1.196e-06 ***\nphiH.1   1.492201    0.086225  17.3060 < 2.2e-16 ***\nphiH.2  -1.158738    0.122828  -9.4339 8.375e-16 ***\n---\nSignif. codes:  0 \u2018***\u2019 0.001 \u2018**\u2019 0.01 \u2018*\u2019 0.05 \u2018.\u2019 0.1 \u2018 \u2019 1\n\nThreshold\nVariable: Z(t) = + (0) X(t) + (1) X(t-1)\n\nValue: 2.867\n\n\nR\nplot(set3)\n\n\n\n\n\n\n\n\n\n\n\u30e2\u30c7\u30eb\u8a2d\u5b9a\u4e8b\u4f8b 4\nEstimate TAR model (parameter L=1 , M=1, H=2. set different AR order degrees between L (Low regime) and H (High regime))\n\nR\n\nset4 <- setar(x, mL=1, mM=1, mH=2, nthresh=2)\n\nsummary(set4)\n\n\nLow regime: , Mid regime: , High regime: \u306e3\u533a\u5206\u3001const L , const M , const H \u306e3\u3064\u306e\u30d1\u30e9\u30e1\u30fc\u30bf\u304c\u623b\u308a\u5024\u3067\u8fd4\u3055\u308c\u3066\u3044\u308b\nNon linear autoregressive model\n\nSETAR model ( 3 regimes)\nCoefficients:\nLow regime:\n   phiL.1   const L \n0.9525294 0.2593074 \n\nMid regime:\n    phiM.1    const M \n-0.4309422  3.8469124 \n\nHigh regime:\n    phiH.1     phiH.2    const H \n 1.5363549 -0.9983326  1.3595496 \n\nThreshold:\n-Variable: Z(t) = + (1) X(t)+ (0)X(t-1)+ (1)X(t-0)\n-Value: 2.538 2.769\nProportion of points in low regime: 25%      Middle regime: 17.86%   High regime: 57.14% \n\nResiduals:\n      Min        1Q    Median        3Q       Max \n-0.867471 -0.131310  0.033701  0.157642  0.637476 \n\nFit:\nresiduals variance = 0.06517,  AIC = -293, MAPE = 7.413%\n\nCoefficient(s):\n\n         Estimate  Std. Error  t value  Pr(>|t|)    \nconst L   0.25931     0.38401   0.6753 0.5009696    \nphiL.1    0.95253     0.17630   5.4029 4.000e-07 ***\nconst M   3.84691     2.09650   1.8349 0.0692951 .  \nphiM.1   -0.43094     0.79242  -0.5438 0.5876876    \nconst H   1.35955     0.39537   3.4387 0.0008341 ***\nphiH.1    1.53635     0.15051  10.2076 < 2.2e-16 ***\nphiH.2   -0.99833     0.11370  -8.7803 2.899e-14 ***\n---\nSignif. codes:  0 \u2018***\u2019 0.001 \u2018**\u2019 0.01 \u2018*\u2019 0.05 \u2018.\u2019 0.1 \u2018 \u2019 1\n\nThreshold\nVariable: Z(t) = + (1) X(t) + (0) X(t-1)\n\nValue: 2.538 2.769\n\n\nR\nplot(set4)\n\n\n\n\n\n\n\n\n\n\n\n\u30e2\u30c7\u30eb\u8a2d\u5b9a\u4e8b\u4f8b 5\nChange state variable \uff08\u72b6\u614b\u5909\u6570\uff09from Xt to Xt-1\nEstimate TAR model (parameter L=1 , M=1, H=2. set different AR order degrees between L (Low regime) and H (High regime))\n\nR\n\n#set \"thDelay\" to 1\nset5 <- setar(x, mL=1, mM=1, mH=2, nthresh=2, thDelay=1)\n\nsummary(set5)\n\n\nLow regime: , Mid regime: , High regime: \u306e3\u533a\u5206\u3001const L , const M , const H \u306e3\u3064\u306e\u30d1\u30e9\u30e1\u30fc\u30bf\u304c\u623b\u308a\u5024\u3067\u8fd4\u3055\u308c\u3066\u3044\u308b\nNon linear autoregressive model\n\nSETAR model ( 3 regimes)\nCoefficients:\nLow regime:\n    phiL.1    const L \n1.09504843 0.08583062 \n\nMid regime:\n    phiM.1    const M \n 1.2548998 -0.5209049 \n\nHigh regime:\n   phiH.1    phiH.2   const H \n 1.492201 -1.158738  2.069329 \n\nThreshold:\n-Variable: Z(t) = + (0) X(t)+ (1)X(t-1)+ (0)X(t-0)\n-Value: 2.446 2.867\nProportion of points in low regime: 22.32%   Middle regime: 26.79%   High regime: 50.89% \n\nResiduals:\n        Min          1Q      Median          3Q         Max \n-0.56028028 -0.13249555  0.00073843  0.12941293  0.50777153 \n\nFit:\nresiduals variance = 0.03885,  AIC = -352, MAPE = 5.68%\n\nCoefficient(s):\n\n         Estimate  Std. Error  t value  Pr(>|t|)    \nconst L  0.085831    0.264395   0.3246   0.74609    \nphiL.1   1.095048    0.113891   9.6149 3.802e-16 ***\nconst M -0.520905    0.242603  -2.1472   0.03404 *  \nphiM.1   1.254900    0.089362  14.0429 < 2.2e-16 ***\nconst H  2.069329    0.382450   5.4107 3.866e-07 ***\nphiH.1   1.492201    0.081975  18.2030 < 2.2e-16 ***\nphiH.2  -1.158738    0.116775  -9.9229 < 2.2e-16 ***\n---\nSignif. codes:  0 \u2018***\u2019 0.001 \u2018**\u2019 0.01 \u2018*\u2019 0.05 \u2018.\u2019 0.1 \u2018 \u2019 1\n\nThreshold\nVariable: Z(t) = + (0) X(t) + (1) X(t-1)\n\nValue: 2.446 2.867\n\n\nR\nplot(set5)\n\n\n\n\n\n\n\n\n\n\n\u30e2\u30c7\u30eb\u8a2d\u5b9a\u4e8b\u4f8b 6\nChange state variable \uff08\u72b6\u614b\u5909\u6570\uff09from Xt to Xt-1\nEstimate TAR model (parameter L=3 , M=4, H=5. set different AR order degrees between L (Low regime) and H (High regime))\n\nR\n\n#set \"thDelay\" to 1\nset6 <- setar(x, mL=3, mM=4, mH=5, nthresh=2, thDelay=1)\n\nsummary(set6)\n\n\nNon linear autoregressive model\n\nSETAR model ( 3 regimes)\nCoefficients:\nLow regime:\n     phiL.1      phiL.2      phiL.3     const L \n 1.06675248 -0.08337226 -0.23461191  0.84307966 \n\nMid regime:\n    phiM.1     phiM.2     phiM.3     phiM.4    const M \n 0.9814068  1.0982503 -0.6292274 -0.2263754 -1.2417259 \n\nHigh regime:\n    phiH.1     phiH.2     phiH.3     phiH.4     phiH.5    const H \n 1.9362242 -2.1139923  1.5157125 -0.9123496  0.3276137  0.7088992 \n\nThreshold:\n-Variable: Z(t) = + (0) X(t)+ (1)X(t-1)+ (0)X(t-2)+ (0)X(t-3)\n-Value: 3.310 3.475\nProportion of points in low regime: 68.81%   Middle regime: 14.68%   High regime: 16.51% \n\nResiduals:\n      Min        1Q    Median        3Q       Max \n-0.531476 -0.095800  0.016631  0.109983  0.464993 \n\nFit:\nresiduals variance = 0.03011,  AIC = -365, MAPE = 5.103%\n\nCoefficient(s):\n\n         Estimate  Std. Error  t value  Pr(>|t|)    \nconst L  0.843080    0.164679   5.1195 1.508e-06 ***\nphiL.1   1.066752    0.096707  11.0307 < 2.2e-16 ***\nphiL.2  -0.083372    0.149867  -0.5563 0.5792551    \nphiL.3  -0.234612    0.089051  -2.6346 0.0097784 ** \nconst M -1.241726    4.337193  -0.2863 0.7752488    \nphiM.1   0.981407    0.279116   3.5161 0.0006624 ***\nphiM.2   1.098250    1.679618   0.6539 0.5147122    \nphiM.3  -0.629227    0.417373  -1.5076 0.1348443    \nphiM.4  -0.226375    0.253323  -0.8936 0.3736912    \nconst H  0.708899    1.501065   0.4723 0.6377775    \nphiH.1   1.936224    0.176319  10.9813 < 2.2e-16 ***\nphiH.2  -2.113992    0.550442  -3.8405 0.0002167 ***\nphiH.3   1.515712    0.512822   2.9556 0.0039001 ** \nphiH.4  -0.912350    0.454459  -2.0076 0.0474164 *  \nphiH.5   0.327614    0.266495   1.2293 0.2218564    \n---\nSignif. codes:  0 \u2018***\u2019 0.001 \u2018**\u2019 0.01 \u2018*\u2019 0.05 \u2018.\u2019 0.1 \u2018 \u2019 1\n\nThreshold\nVariable: Z(t) = + (0) X(t) + (1) X(t-1)+ (0) X(t-2)+ (0) X(t-3)+ (0) X(t-4)\n\nValue: 3.310 3.475\n\n\nR\nplot(set6)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\u305d\u306e\u4ed6 \u95a2\u9023\u3059\u308b\u5206\u6790\u624b\u6cd5\n\u30de\u30eb\u30b3\u30d5\u30fb\u30b9\u30a4\u30c3\u30c1\u30f3\u30b0\u30e2\u30c7\u30eb \uff08 Markov Switching \uff09\n\u203b \u672c\u7a3f\u3067\u5f15\u7528\u3057\u3066\u304d\u305f\u300c\u9280\u5ea7\u3067\u50cd\u304f\u30c7\u30fc\u30bf\u30b5\u30a4\u30a8\u30f3\u30c6\u30a3\u30b9\u30c8\u306e\u30d6\u30ed\u30b0\u300d\u8a18\u4e8b\u3067\u3082\u53d6\u308a\u4e0a\u3052\u3089\u308c\u3066\u3044\u308b\u304c\u3001\u624b\u6cd5\u306e\u6982\u8981\u8aac\u660e\u306f\u4ed6\u66f8\u306b\u59d4\u306d\u3089\u308c\u3066\u3044\u308b\u305f\u3081\u3001\u308f\u304b\u308a\u3065\u3089\u3044\n\uff08 \u4ee5\u4e0b\u304c\u5206\u304b\u308a\u3084\u3059\u3044 \uff09\n \u6c96\u672c\u7adc\u7fa9\uff082013\u5e746\u670823\u65e5\uff09\u300c\u30de\u30eb\u30b3\u30d5\u30b9\u30a4\u30c3\u30c1\u30f3\u30b0\u30e2\u30c7\u30eb\u306e\u30de\u30af\u30ed\u7d4c\u6e08\u30fb\u30d5\u30a1\u30a4\u30ca\u30f3\u30b9\u3078\u306e\u5fdc\u5fdc\u7528\u300d\n\n\n\n\uff08\u4ee5\u4e0b\u306f\u3001\u3088\u308a\u304b\u307f\u304f\u3060\u3044\u3060\u8aac\u660e\uff09\n \u30a4\u30f3\u30bf\u30fc\u30cd\u30c3\u30c8\u5e83\u544a\u4ee3\u7406\u5e97\u3067\u50cd\u304f\u30c7\u30fc\u30bf\u30b5\u30a4\u30a8\u30f3\u30c6\u30a3\u30b9\u30c8\u306e\u30d6\u30ed\u30b0\uff082013-12-04\uff09\u300c\u30b5\u30fc\u30e2\u30f3\u3068\u30a4\u30f3\u30bf\u30fc\u30cd\u30c3\u30c8\u5e83\u544a\u3068\u30de\u30eb\u30b3\u30d5\u8ee2\u63db\u30e2\u30c7\u30eb\u300d\n\n\n\n\n\uff08 \u5229\u7528\u4e8b\u4f8b \uff09\n \u5927\u585a\u82b3\u5b8f\uff082011\uff09\u300c\u30de\u30eb\u30b3\u30d5\u30fb\u30b9\u30a4\u30c3\u30c1\u30f3\u30b0\u6642\u7a7a\u9593\u81ea\u5df1\u56de\u5e30\u30e2\u30c7\u30eb\u306b\u3088\u308b\u65e5\u672c\u306e\u5730\u57df\u5225\u306e\u666f\u6c17\u5faa\u74b0\u306e\u8a08\u91cf\u5206\u6790\u300d\n\n \u5c0f\u6c60\u5149\u592a\u90ce\uff08\u5b66\u4f4d\u8ad6\u65872005\u5e74\u5ea6\uff09\u300c\u30de\u30eb\u30b3\u30d5\u30e2\u30c7\u30eb\u3092\u7528\u3044\u305f\u30d5\u30c3\u30c8\u30b5\u30eb\u306e\u8a66\u5408\u5206\u6790\u300d\n###**TAR\uff08\u95be\u5024\uff09\u30e2\u30c7\u30eb\u3068\u306f**\n\n\u3053\u308c\u307e\u3067 _**Qiita**_ \u306b\u6295\u7a3f\u3057\u305f\u8a18\u4e8b\u306e\u4e2d\u3067\u3001\u8003\u5bdf\u3059\u308b\u30c7\u30fc\u30bf\u671f\u9593\u4e2d\u306b\u3001\u6642\u7cfb\u5217\u5909\u6570\u9593\u306e\u30e2\u30c7\u30eb\u69cb\u9020\u304c\u5909\u5316\u3057\u3066\u3057\u307e\u3046\uff08\u306a\u3044\u3057\u306f\u3001\u5909\u5316\u3059\u308b\u53ef\u80fd\u6027\u306e\u3042\u308b\uff09\u5834\u5408\u306b\u3001\u6709\u52b9\u306a\u6642\u7cfb\u5217\u89e3\u6790\u624b\u6cd5\u3092\u7d39\u4ecb\u3057\u3066\u304d\u307e\u3057\u305f\u3002\n\n**\uff08\u904e\u53bb\u306e\u6295\u7a3f\uff09**\n\n[\u300c\u3010R\u8a00\u8a9e\u3011\u6642\u9593\u306e\u52d5\u304d\u306b\u3042\u308f\u305b\u3066 \u5b9a\u6570\u9805 \u3084 \u56de\u5e30\u4fc2\u6570 \u304c\u52d5\u7684\u306b\u5909\u5316\u3057\u3066\u3044\u304f\u56de\u5e30\u30e2\u30c7\u30eb\u3092\u89e3\u6790\u3059\u308b\u65b9\u6cd5\uff08\u30c7\u30fc\u30bf\u306e\u89b3\u6e2c\u8aa4\u5dee\u3092\u53d6\u308a\u9664\u3044\u305f\u300c\u771f\u306e\u5024\u300d\u3092\u540c\u6642\u306b\u63a8\u5b9a\uff09\u300d](http://qiita.com/HirofumiYashima/items/873c8930a30b6669be20)\n\n[\u300cR\u8a00\u8a9e\u3067\u30a6\u30a7\u30fc\u30d6\u30ec\u30c3\u30c8\u5909\u63db \uff5e\u6642\u7cfb\u5217\u30c7\u30fc\u30bf\u306e\u5404\u6ce2\u9577\u6210\u5206\u306e\u542b\u6709\u6fc3\u5ea6\u304c\u3001\u6642\u9593\u63a8\u79fb\u3068\u3068\u3082\u306b\u3069\u3046\u5909\u5316\u3059\u308b\u304b\u3092\u8996\u899a\u5316\u3059\u308b\u65b9\u6cd5\u300d](http://qiita.com/HirofumiYashima/items/0d1cbde1c0bd0d60203b)\n\n**\u4eca\u56de\u306f\u3001\u4ee5\u4e0b\u306e\u30e2\u30c7\u30eb** \u3068 _**R**_ \u3067\u306e\u5b9f\u88c5\u30d1\u30c3\u30b1\u30fc\u30b8\uff08\u95a2\u6570\uff09\u3092\u7d39\u4ecb\u3057\u307e\u3059\n\n[ \uff08\u5f15\u7528\u5143\uff09 \u9577\u5009 \u5927\u8f14\uff08\u6176\u61c9\u7fa9\u587e\u5927\u5b66\uff09_Power point \u8cc7\u6599_\u300c\u72b6\u614b\u5909\u5316\u3092\u4f34\u3046\u30e2\u30c7\u30eb\u300d]\n(http://web.keio.jp/~nagakura/zemi/ts16_slide.pdf)\n> \u95be\u5024\u30e2\u30c7\u30eb\u3068\u306f\u30e2\u30c7\u30eb\u306e\u30d1\u30e9\u30e1\u30fc\u30bf\u30fc\u304c\u72b6\u614b\u306b\u4f9d\u5b58\u3057\u3066\n\u5909\u5316\u3059\u308b\u30e2\u30c7\u30eb\u306e\u7dcf\u79f0\u3067\u3042\u308b\u3002\n>\u72b6\u614b\u306f\u901a\u5e38\u3042\u308b\u89b3\u6e2c\u53ef\u80fd\u306a\u5909\u6570\u306b\u3088\u3063\u3066\u8868\u3055\u308c\u308b\u3002\n>\n>\u4f8b\u3048\u3070\u3042\u308b\u89b3\u6e2c\u53ef\u80fd\u306a\u5909\u6570\u3092 st \u3068\u3059\u308b\u3068\u3001\u3042\u308b\u5024 a \u306b\u5bfe\n\u3057\u3066\u3001 st < a \u306a\u3089\u72b6\u614b 1\u3001 st \u2265 a \u306a\u3089\u72b6\u614b 2\u306e\u3088\u3046\u306b\u72b6\u614b\n\u3092\u5b9a\u7fa9\u3059\u308b\u3002\n>\n>\u3053\u306e\u3088\u3046\u306a\u5909\u6570 st \u3092\u72b6\u614b\u5909\u6570\u3068\u3088\u3076\u3002\u72b6\u614b\u5909\u6570\u3092\u3069\u306e\u3088\n\u3046\u306b\u9078\u3076\u304b\u306f\u5206\u6790\u306e\u76ee\u7684\u306b\u4f9d\u5b58\u3059\u308b\u3002\n\n[ \u4ee5\u4e0b\u3001\u9577\u5009 \u5927\u8f14\uff08\u6176\u61c9\u7fa9\u587e\u5927\u5b66\uff09_Power point \u8cc7\u6599_\u300c\u72b6\u614b\u5909\u5316\u3092\u4f34\u3046\u30e2\u30c7\u30eb\u300d\u3088\u308a\u8ee2\u8f09]\n(http://web.keio.jp/~nagakura/zemi/ts16_slide.pdf)\n![nagakura.1.png](https://qiita-image-store.s3.amazonaws.com/0/43487/4b4ca5a5-69d9-629f-fed1-b256c3500be7.png)\n\n![nagakura.2.png](https://qiita-image-store.s3.amazonaws.com/0/43487/81f8453d-a7c2-1bd8-b9e0-574a610eeb1d.png)\n\n![nagakura.3.png](https://qiita-image-store.s3.amazonaws.com/0/43487/8477b48c-7f71-076b-aa7d-e4205e7636ea.png)\n\n![nagakura.4.png](https://qiita-image-store.s3.amazonaws.com/0/43487/2e7ad14d-74ba-d5d8-e009-5553ac091c04.png)\n\n![nagakura.5.png](https://qiita-image-store.s3.amazonaws.com/0/43487/430ca691-0ce0-c85b-3ac0-e3705930c166.png)\n\n![nagakura.6.png](https://qiita-image-store.s3.amazonaws.com/0/43487/39544847-eae9-2fd4-4dc7-669cbfaad58e.png)\n\n\n##### \uff08\u53c2\u8003\u8cc7\u6599\uff09\n[ \u2460 \u9577\u5009 \u5927\u8f14\uff08\u6176\u61c9\u7fa9\u587e\u5927\u5b66\uff09\u300c\u72b6\u614b\u5909\u5316\u3092\u4f34\u3046\u30e2\u30c7\u30eb\u300d](http://web.keio.jp/~nagakura/zemi/ts16_slide.pdf)\n\n[ \u2461 \u9577\u5009 \u5927\u8f14\uff08\u6176\u61c9\u7fa9\u587e\u5927\u5b66\uff09\u300cR \u306b\u3088\u308b\u6642\u7cfb\u5217\u5206\u6790 5\u300d1. TAR \u30e2\u30c7\u30eb\u3092\u63a8\u5b9a\u3059\u308b](http://web.keio.jp/~nagakura/R/ts_R5_2013.pdf)\n\n[ \u2462 \u9280\u5ea7\u3067\u50cd\u304f\u30c7\u30fc\u30bf\u30b5\u30a4\u30a8\u30f3\u30c6\u30a3\u30b9\u30c8\u306e\u30d6\u30ed\u30b0 \uff082013-08-22\uff09\u300cR\u3067\u8a08\u91cf\u6642\u7cfb\u5217\u5206\u6790\uff1a\u72b6\u614b\u5909\u5316\u3092\u4f34\u3046\u30e2\u30c7\u30eb\uff08\u95be\u5024\u30e2\u30c7\u30eb\u3001\u5e73\u6ed1\u63a8\u79fb\u30e2\u30c7\u30eb\u3001\u30de\u30eb\u30b3\u30d5\u8ee2\u63db\u30e2\u30c7\u30eb\uff09\u300d](http://tjo.hatenablog.com/entry/2013/08/22/204451)\n\n\n\n##### \uff08\u5229\u7528\u4e8b\u4f8b\uff09\n[ \u7802\u7530 \u6d0b\u5fd7\uff08\u5c71\u5f62\u5927\u5b66 \u4eba\u6587\u5b66\u90e8\uff09\u300c\u95be\u5024\u81ea\u5df1\u56de\u5e30\u30e2\u30c7\u30eb\u306e\u65e5\u7d4c\u5e73\u5747\u682a\u4fa1\u6307\u6570\u3078\u306e\u5fdc\u7528\u300d\uff082006\uff09 ](http://www.ose.or.jp/f/general_cms_pages/15567/wysiwyg/rerk0608.pdf)\n\n\n[ \u7027\u672c\u592a\u90ce\u30fb\u5742\u672c\u76f4\u6a39\u300c\u69cb\u9020\u5909\u5316\u3068\u975e\u7dda\u5f62\u6027\u3092\u8003\u616e\u3057\u305f\u30e2\u30c7\u30eb\u306b\u3088\u308b\u308f\u304c\u56fd\u306e\u6b73\u5165\u3068\u6b73\u51fa\u306e\u56e0\u679c\u6027\u5206\u6790\u300d](http://catalog.lib.kyushu-u.ac.jp/handle/2324/20497/p111.pdf)\n\n\n[ \u4f50\u7af9\u5149\u5f66\u300c\u65e5\u672c\u306b\u304a\u3051\u308b\u30d5\u30a3\u30c3\u30b7\u30e3\u30fc\u4eee\u8aac\u306e\u691c\u8a3c\n\u2015 TAR \u30e2\u30c7\u30eb\u3092\u7528\u3044\u305f\u4e00\u8003\u5bdf\u2015\u300d ](http://doors.doshisha.ac.jp/webopac/bdyview.do?bodyid=BD00005562&elmid=Body&lfname=034057030008.pdf)\n\n-----------------------------------------------------------------------------------\n# _**R**_ \u306b\u304a\u3051\u308b\u5b9f\u88c5\u30d1\u30c3\u30b1\u30fc\u30b8\n## \u30d1\u30c3\u30b1\u30fc\u30b8 _**{tsDyn}**_\n##### **\u975e\u7dda\u5f62\u81ea\u5df1\u56de\u5e30\uff08\u6642\u7cfb\u5217\uff09\u30e2\u30c7\u30eb**\u306e\u89e3\u6790\u306b\u7279\u5316\u3057\u305f\u30d1\u30c3\u30b1\u30fc\u30b8\u306b _**{tsDyn}**_ (timeseries dynamics)\u304c\u3042\u308a\u307e\u3059 \n\n[ \uff08 _CRAN_ \u767b\u9332 \u30d1\u30c3\u30b1\u30fc\u30b8\u30de\u30cb\u30e5\u30a2\u30eb \u3078\u306e\u30ea\u30f3\u30af \uff09](http://cran.r-project.org/web/packages/tsDyn/tsDyn.pdf)\n\n[  \uff08 \u4e0a\u8a18\u30de\u30cb\u30e5\u30a2\u30eb\u304b\u3089\u8cbc\u3089\u308c\u3066\u3044\u308b\u30ea\u30f3\u30af\u30da\u30fc\u30b8\uff09 ](https://code.google.com/p/tsdyn/)\n>tsDyn is an R package for nonlinear time series modelling.\n>\n>**In particular, some non-linear autoregressive models are implemented (NLAR):**\n>\n>SETAR\nLSTAR\nSTAR\nNNET\nAAR\n>\n>There are also some tests for nonlinearity and independence. A short guide is bundled, once installed type\n> vignette('tsDyn')\n\n#### \u4e0a\u8a18\u306e\u3088\u3046\u306b\u3001\u8907\u6570\u306e\u975e\u7dda\u5f62\u81ea\u5df1\u56de\u5e30\u30e2\u30c7\u30eb\u3092\u6271\u3046\u305f\u3081\u306e\u95a2\u6570\u304c\u7528\u610f\u3055\u308c\u3066\u3044\u307e\u3059\u3002\n-------------------------------------------------------------------------------------\n###### **\u81ea\u5df1\u52b1\u8d77\uff08**  _**Self-Exciting Threshold AutoRegressive**_ **\uff09** **(SETAR)\u30e2\u30c7\u30eb** \n###### [ \uff08 _Wikipedia_ \uff09 ](http://en.wikipedia.org/wiki/SETAR_(model))\n\n###### **\u5e73\u6ed1\u63a8\u79fb\uff08 _ST_ \uff09\u81ea\u5df1\u56de\u5e30 \uff08 _AR_ \uff09\u30e2\u30c7\u30eb\u3000(smooth-transition model)**\n###### [ \uff08 \u9280\u5ea7\u3067\u50cd\u304f\u30c7\u30fc\u30bf\u30b5\u30a4\u30a8\u30f3\u30c6\u30a3\u30b9\u30c8\u306e\u30d6\u30ed\u30af \uff09 ](http://tjo.hatenablog.com/entry/2013/08/22/204451)\n\n###### **\u30ed\u30b8\u30b9\u30c6\u30a3\u30c3\u30af\uff08 _L_ \uff09 \u5e73\u6ed1\u63a8\u79fb\uff08 _ST_ \uff09\u81ea\u5df1\u56de\u5e30 \uff08 _AR_ \uff09\u30e2\u30c7\u30eb\u3000(logistic smooth-transition model)**\n###### [ \uff08 \u9280\u5ea7\u3067\u50cd\u304f\u30c7\u30fc\u30bf\u30b5\u30a4\u30a8\u30f3\u30c6\u30a3\u30b9\u30c8\u306e\u30d6\u30ed\u30af \uff09 ](http://tjo.hatenablog.com/entry/2013/08/22/204451)\n\n###### _**nnet**_ **\uff08\u975e\u7dda\u5f62\u6700\u5c0f\u30cb\u4e57\u6cd5\uff09\u30e2\u30c7\u30eb**\n\n###### _**AAR**_ **\u52a0\u6cd5\uff08Additive\uff09\u975e\u7dda\u5f62\uff08nonlinear\uff09\u81ea\u5df1\u56de\u5e30\uff08autoregressive\uff09\u30e2\u30c7\u30eb**\u3000\n###### [ iAnalysis \uff5e\u304a\u3068\u3046\u3055\u3093\u306e\u89e3\u6790\u65e5\u8a18\uff5e\u3000\uff082010-05-14\uff09\u300c[R\u30e9\u30a4\u30d6\u30e9\u30ea\u63a2\u7d22]R\u30e9\u30a4\u30d6\u30e9\u30ea\u306e\u63a2\u7d223\uff08\u6642\u7cfb\u5217\u30e2\u30c7\u30eb\u3001\u7d4c\u6e08\uff09](http://d.hatena.ne.jp/isseing333/20100514/1273829174)\n-------------------------------------------------------------------------------------\n\n#### \u672c\u7a3f\u3067\u306f\u3053\u306e\u3046\u3061\u3001\u72b6\u614b\u5909\u6570\u304c\u3001\u81ea\u5df1\u306e\u904e\u53bb\u6642\u70b9\u306e\u5024\uff08\u4f55\u671f\u524d\u304b\u306e\u671f\u6570\u3092AR(m)\u306e\u6b21\u6570m\u3067\u5b9a\u7fa9\uff09\u3067\u3042\u308b\u8a2d\u5b9a\u30e2\u30c7\u30eb\u306e _**setar( )**_ \uff08\u81ea\u5df1\u52b1\u8d77\u95be\u5024\u30e2\u30c7\u30eb\uff09\u95a2\u6570\u3092\u4f7f\u3046\u65b9\u6cd5\u3092\u3068\u308a\u3042\u3052\u307e\u3059\u3002\n\n# \uff08 \u4f7f\u3044\u65b9 \uff09\n\n**[\u7d44\u8fbc\u307f\u30c7\u30fc\u30bf]** _**lynx**_  \uff08\u5317\u897f\u30ab\u30ca\u30c0\u306e\u30aa\u30aa\u30e4\u30de\u30cd\u30b3\u3000\u5e74\u6b21\u6355\u7372\u500b\u4f53\u6570\uff09\n\n**[\u95a2\u6570]**  _**setar(  )**_  \u95a2\u6570  \n\n######**\uff08\u95a2\u6570\u306e\u5f15\u6570\uff09**\u3000\u30c7\u30fc\u30bf\u30aa\u30d6\u30b8\u30a7\u30af\u30c8 , \u5404\u30ec\u30b8\u30fc\u30e0\u306e **AR\u30e2\u30c7\u30eb\u6b21\u6570** , \u30ec\u30b8\u30fc\u30e0\u6570, etc\u3000\n\n######**\uff08\u95a2\u6570\u306e\u623b\u308a\u5024\uff09**\n\n#### **\u3010\u30e2\u30c7\u30eb\u69cb\u7bc9 \u53ca\u3073 \u63a8\u8a08\u306e\u624b\u9806\u3011** \n#####\uff08\uff11\uff09\u30e2\u30c7\u30eb\u8a2d\u8a08  _**setar( )**_ \uff1a \u3042\u3089\u304b\u3058\u3081 \u60f3\u5b9a\u3055\u308c\u308b **\u5909\u5316\u306e\u6570\uff08\u533a\u5206\u6570\uff09** \u3068 **\u5909\u5316\u306e\u7bc4\u56f2\uff08\u533a\u5206\u533a\u9593\uff09** \u3092\u5f15\u6570\u306b\u6e21\u3059\n#####\uff08\uff12\uff09\u30e2\u30c7\u30eb\u63a8\u8a08  _**summary( \u30e2\u30c7\u30eb\u540d )**_ \uff1a \u63a8\u8a08\u306e\u5b9f\u884c\u3068\u7d50\u679c\u306e\u53d6\u5f97\n#####\uff08\uff13\uff09\u7d50\u679c\u306e\u8996\u899a\u5316 _**plot(summary( ))**_ \uff1a\u30b0\u30e9\u30d5\u51fa\u529b\n\n\n**[\u95a2\u6570 \u4ed5\u69d8\uff08\u8a73\u7d30\uff09]**\n\n```{r:R}\n?setar\n```\n\n```\nSETAR {tsDyn}\tR Documentation\nSelf Threshold Autoregressive model\n\nDescription \uff08\u6982\u8981\uff09\n\nSelf Exciting Threshold AutoRegressive model.\n\nUsage \uff08\u95a2\u6570\u306e\u4ed5\u69d8\uff09\n\nsetar(x, m, d=1, steps=d, series, mL, mM, mH, thDelay=0, mTh, thVar, th, trace=FALSE, \n      nested=FALSE, include = c( \"const\", \"trend\",\"none\", \"both\"), \n      common=c(\"none\", \"include\",\"lags\", \"both\"), model=c(\"TAR\", \"MTAR\"), ML=seq_len(mL), \n      MM=seq_len(mM), MH=seq_len(mH),nthresh=1,trim=0.15, type=c(\"level\", \"diff\", \"ADF\"),\n      restriction=c(\"none\",\"OuterSymAll\",\"OuterSymTh\") )\nArguments\n\nx\t\ntime series\n\nm, d, steps\t\nembedding dimension, time delay, forecasting steps\n\nseries\t\ntime series name (optional)\n\nmL,mM, mH\t\nautoregressive order for \u2018low\u2019 (mL) \u2018middle\u2019 (mM, only useful if nthresh=2) and \u2018high\u2019 (mH)regime (default values: m). Must be <=m. Alternatively, you can specify ML\n\nthDelay\t\n'time delay' for the threshold variable (as multiple of embedding time delay d)\n\nmTh\t\ncoefficients for the lagged time series, to obtain the threshold variable\n\nthVar\t\nexternal threshold variable\n\nth\t\nthreshold value (if missing, a search over a reasonable grid is tried)\n\ntrace\t\nshould additional infos be printed? (logical)\n\ninclude\t\nType of deterministic regressors to include\n\ncommon\t\nIndicates which elements are common to all regimes: no, only the include variables, the lags or both\n\nML,MM,MH\t\nvector of lags for order for \u2018low\u2019 (ML) \u2018middle\u2019 (MM, only useful if nthresh=2) and \u2018high\u2019 (MH)regime. Max must be <=m\n\nmodel\t\nCurrently not implemented\n\nnthresh\t\nNumber of threshold of the model\n\ntrim\t\ntrimming parameter indicating the minimal percentage of observations in each regime. Default to 0.15\n\ntype\t\nWhether the variable is taken is level, difference or a mix (diff y= y-1, diff lags) as in the ADF test\n\nrestriction\t\nRestriction on the threshold. OuterSymAll will take a symmetric threshold and symmetric coefficients for outer regimes. OuterSymTh currently unavailable\n\nnested\t\nWhether is this a nested call? (useful for correcting final model df)\n\n\nValue \uff08\u623b\u308a\u5024\uff09\n\nAn object of class nlar, subclass setar\n```\n\n\n**Examples**\n\n```{r:R}\n#fit a SETAR model, with threshold as suggested in Tong(1990, p 377)\nmod.setar <- setar(log10(lynx), m=2, thDelay=1, th=3.25)\nmod.setar\nsummary(mod.setar)\n\nif(require(FinTS)) {\n\tdata(m.unrate)\n\tsetar(diff(m.unrate), ML=c(2,3,4,12), MH=c(2,4,12), th=0.1, include=\"none\")\n}\n```\n-----------------------------------------------------------------------------------\n# \uff08 \u4f7f\u7528\u4f8b \uff09\n#### \uff08\u4ee5\u4e0b\u3001\u53c2\u8003\u8cc7\u6599 \u2461\u306e\u30b9\u30af\u30ea\u30d7\u30c8\u306b\u3001\u8cc7\u6599 \u2462\u306e\u95a2\u6570\u4f7f\u7528\u6cd5\u3092\u8ffd\u52a0\u3057\u3066\u5b9f\u884c\u3059\u308b\u3053\u3068\u3067\u3001_**{tsDyn}**_ \u306e\u4f7f\u3044\u65b9\u3092\u78ba\u8a8d\u3057\u307e\u3059\uff09\n\n[ \uff08\u4ee5\u4e0b\u3001\u8cc7\u6599 \u2461 \u9577\u5009\uff08\u6176\u61c9\u7fa9\u587e\u5927\u5b66\uff09\u6240\u53ce\u306e\u30b3\u30fc\u30c9\u3092\u3001\u307b\u307c\u305d\u306e\u307e\u307e\u5b9f\u884c\uff09](http://web.keio.jp/~nagakura/R/ts_R5_2013.pdf)\n\n#### **\u30d1\u30c3\u30b1\u30fc\u30b8\u7528\u610f**\n```{r:R}\ninstall.packages(\"tseriesChaos\")\ninstall.packages(\"tsDyn\")\n\nrequire(tseriesChaos)\nrequire(tsDyn)\n```\n\n#### **\u7d44\u8fbc\u307f\u30c7\u30fc\u30bf\u306e\u30ed\u30fc\u30c9 \u3068 \u4e2d\u8eab\u306e\u78ba\u8a8d\n```{r:R}\ndata(lynx) #load data ( yearly data of observered (caputured) numbers of cats at Northwestern Canada )  \nstr(lynx)  #see data structure\n```\n\n```\nTime-Series [1:114] from 1821 to 1934: 269 321 585 871 1475 ...\n```\n\n```{r:R}\nsummary(lynx)\n```\n\n```\n Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n   39.0   348.2   771.0  1538.0  2567.0  6991.0 \n```\n\n\n```{r:R}\nprint(class(lynx))\n```\n\n\n```\n[1] \"ts\"\n```\n\n\n\n```\nts.plot(lynx)\n```\n![graph.1.png](https://qiita-image-store.s3.amazonaws.com/0/43487/025ac476-1e49-fac2-73d6-a2a44ad325ac.png)\n\n```{r:R}\nx <- log10(lynx)\nts.plot(x)\n```\n![graph.2.png](https://qiita-image-store.s3.amazonaws.com/0/43487/72c105bd-b9f7-3a93-d729-3e88ae5cb0ff.png)\n\n----------------------------------------------------------------------------------\n#### **\uff08\u307e\u305a\u306f\u3001\u3075\u3064\u3046\u306eAR\u30e2\u30c7\u30eb\uff09**\n\n**AR(2)\u30e2\u30c7\u30eb**\n\n**\u3010\u30e2\u30c7\u30eb\u8a2d\u8a08\u95a2\u6570\u3011** _**linear()**_ \u95a2\u6570\n\n```{r:R}\nar2 <- linear(x, m=2)\n\nprint(ar2)\n```\n\n\n```\nNon linear autoregressive model\n\nAR model\nCoefficients:\n     const      phi.1      phi.2 \n 1.0576005  1.3842377 -0.7477757 \n```\n\n----------------------------------------------------------------------------------\n\n#### **TAR \uff08\u95be\uff08\u3057\u304d\u3044\uff09\u5024 \u30e2\u30c7\u30eb\uff09**\n\n**\u30e2\u30c7\u30eb\u8a2d\u5b9a\u4e8b\u4f8b 1**\n\n(all of parameters L, H, m to be set to 3)\n( L: AR order degree of Low regime / H: AR order degree of High regime )\n\n```{r:R}\n# setar() function\nset <- setar(x, m=3)\n```\n\n\n```\nWarning message:\nPossible unit root in the high  regime. Roots are: 0.9858 0.9858 4.3523 \n```\n\n\n```{r:R}\nsummary(set)\n```\n\n```\nNon linear autoregressive model\n\nSETAR model ( 2 regimes)\nCoefficients:\nLow regime:\n    phiL.1     phiL.2     phiL.3    const L \n 1.1175812 -0.1165550 -0.1532651  0.5886583 \n\nHigh regime:\n    phiH.1     phiH.2     phiH.3    const H \n 1.4029086 -0.6538670 -0.2364283  1.4051764 \n\nThreshold:\n-Variable: Z(t) = + (1) X(t)+ (0)X(t-1)+ (0)X(t-2)\n-Value: 2.588\nProportion of points in low regime: 30.63% \t High regime: 69.37% \n\nResiduals:\n      Min        1Q    Median        3Q       Max \n-0.566419 -0.105803  0.013666  0.135648  0.426856 \n\nFit:\nresiduals variance = 0.03842,  AIC = -354, MAPE = 5.683%\n\nCoefficient(s):\n\n         Estimate  Std. Error  t value  Pr(>|t|)    \nconst L   0.58866     0.29640   1.9860 0.0496118 *  \nphiL.1    1.11758     0.16442   6.7970 6.482e-10 ***\nphiL.2   -0.11655     0.20023  -0.5821 0.5617302    \nphiL.3   -0.15327     0.11730  -1.3066 0.1941901    \nconst H   1.40518     0.23618   5.9495 3.513e-08 ***\nphiH.1    1.40291     0.11249  12.4719 < 2.2e-16 ***\nphiH.2   -0.65387     0.18814  -3.4754 0.0007403 ***\nphiH.3   -0.23643     0.13197  -1.7915 0.0760691 .  \n---\nSignif. codes:  0 \u2018***\u2019 0.001 \u2018**\u2019 0.01 \u2018*\u2019 0.05 \u2018.\u2019 0.1 \u2018 \u2019 1\n\nThreshold\nVariable: Z(t) = + (1) X(t) + (0) X(t-1)+ (0) X(t-2)\n\nValue: 2.588\n```\n\n[ \u9280\u5ea7\u3067\u5b66\u3076\u30c7\u30fc\u30bf\u30b5\u30a4\u30a8\u30f3\u30c6\u30a3\u30b9\u30c8\u306e\u30d6\u30ed\u30b0 \u3092\u53c2\u8003\u306b\u3001\u30b0\u30e9\u30d5\u63cf\u753b ](http://tjo.hatenablog.com/entry/2013/08/22/204451)\n\n```{r:R}\nplot(set)\n```\n\n```\n> plot(set)\nHit <Return> to see next plot: \n```\n![graph.3.png](https://qiita-image-store.s3.amazonaws.com/0/43487/0f9cf4c8-965c-7674-1b22-d2374f7435f0.png)\n\n\n```\nHit <Return> to see next plot:\n```\n![graph.4.png](https://qiita-image-store.s3.amazonaws.com/0/43487/7f94a61b-b013-ef89-f7d7-0e0d75d649a9.png)\n\n\n```\nHit <Return> to see next plot:\n```\n![graph.5.png](https://qiita-image-store.s3.amazonaws.com/0/43487/7a2cd5de-d175-71e7-1d44-e0c5e01ca5c5.png)\n\n```\nHit <Return> to see next plot:\n```\n![graph.6.png](https://qiita-image-store.s3.amazonaws.com/0/43487/12febe83-7fa6-85a7-1cc4-337555d1287c.png)\n\n```\nHit <Return> to see next plot:\n```\n![graph.7.png](https://qiita-image-store.s3.amazonaws.com/0/43487/db2e4646-eb35-6965-58ee-f2316e726240.png)\n\n```\nHit <Return> to see next plot:\n```\n![graph.8.png](https://qiita-image-store.s3.amazonaws.com/0/43487/a2d2d2d9-428e-9017-bf47-e3a30e247275.png)\n\n\n```\nHit <Return> to see next plot:\n```\n![graph.9.png](https://qiita-image-store.s3.amazonaws.com/0/43487/1ad84fe4-718d-a039-117a-315818ec591d.png)\n\n```\nHit <Return> to see next plot:\n```\n![graph.10.png](https://qiita-image-store.s3.amazonaws.com/0/43487/c12203ae-eccc-30dd-c757-8b6aab26e2be.png)\n\n\n```\nHit <Return> to see next plot:\n```\n![graph.11.png](https://qiita-image-store.s3.amazonaws.com/0/43487/36602680-1d6a-0265-0a12-f62cd6ec3230.png)\n\n\n**\u30e2\u30c7\u30eb\u8a2d\u5b9a\u4e8b\u4f8b 2**\nEstimate TAR model (parameter L=1 , H=2. set different AR order degrees between L (Low regime) and H (High regime))\n\n```{r:R}\nset2 <- setar(x, mL=1, mH=2)\n\nsummary(set2)\n```\n\n```\nNon linear autoregressive model\n\nSETAR model ( 2 regimes)\nCoefficients:\nLow regime:\n   phiL.1   const L \n0.9863628 0.1930968 \n\nHigh regime:\n    phiH.1     phiH.2    const H \n 1.5476983 -0.9562741  1.1808695 \n\nThreshold:\n-Variable: Z(t) = + (1) X(t)+ (0)X(t-1)\n-Value: 2.558\nProportion of points in low regime: 27.68% \t High regime: 72.32% \n\nResiduals:\n      Min        1Q    Median        3Q       Max \n-0.689146 -0.127983  0.029727  0.142420  0.474525 \n\nFit:\nresiduals variance = 0.0443,  AIC = -343, MAPE = 6.156%\n\nCoefficient(s):\n\n         Estimate  Std. Error  t value  Pr(>|t|)    \nconst L  0.193097    0.292729   0.6596    0.5109    \nphiL.1   0.986363    0.132005   7.4722 2.093e-11 ***\nconst H  1.180869    0.213553   5.5296 2.220e-07 ***\nphiH.1   1.547698    0.088773  17.4343 < 2.2e-16 ***\nphiH.2  -0.956274    0.073336 -13.0396 < 2.2e-16 ***\n---\nSignif. codes:  0 \u2018***\u2019 0.001 \u2018**\u2019 0.01 \u2018*\u2019 0.05 \u2018.\u2019 0.1 \u2018 \u2019 1\n\nThreshold\nVariable: Z(t) = + (1) X(t) + (0) X(t-1)\n\nValue: 2.558\n```\n\n\n```{r:R}\nplot(set2)\n```\n![graph.12.png](https://qiita-image-store.s3.amazonaws.com/0/43487/a284af3c-640c-22fe-3779-515363a85e50.png)\n\n![graph.13.png](https://qiita-image-store.s3.amazonaws.com/0/43487/545419ee-49b0-f180-58fd-ee5ab1091252.png)\n\n![graph.14.png](https://qiita-image-store.s3.amazonaws.com/0/43487/f3a36ae0-1f1e-32f0-89ce-dbc5b8ae00c9.png)\n\n![graph.15.png](https://qiita-image-store.s3.amazonaws.com/0/43487/e75d567e-d9e9-e304-8162-1104608904cf.png)\n\n![graph.16.png](https://qiita-image-store.s3.amazonaws.com/0/43487/fd3ac1d8-8c71-bd38-6f9b-00d6defcd69c.png)\n\n![graph.17.png](https://qiita-image-store.s3.amazonaws.com/0/43487/57e70783-c456-0d3b-2caa-0c8e9c000055.png)\n\n\n![graph.18.png](https://qiita-image-store.s3.amazonaws.com/0/43487/6baef26a-cf6e-91cc-40f2-d34bd61998d1.png)\n\n![graph.19.png](https://qiita-image-store.s3.amazonaws.com/0/43487/3987925a-8b2c-37a6-4a22-fea8fd3383bc.png)\n\n**\u30e2\u30c7\u30eb\u8a2d\u5b9a\u4e8b\u4f8b 3**\n\nChange state variable \uff08\u72b6\u614b\u5909\u6570\uff09from Xt to Xt-1\n\nEstimate TAR model (parameter L=1 , H=2. set different AR order degrees between L (Low regime) and H (High regime))\n\n\n```{r:R}\n#set \"thDelay\" to 1\nset3 <- setar(x, mL=1, mH=2, thDelay=1)\n```\n\n```\nWarning messages:\n1: Possible unit root in the high  regime. Roots are: 0.929 0.929 \n```\n\n\n```{r:R}\nsummary(set3)\n\n```\n\n```\nNon linear autoregressive model\n\nSETAR model ( 2 regimes)\nCoefficients:\nLow regime:\n    phiL.1    const L \n1.08403352 0.01640729 \n\nHigh regime:\n   phiH.1    phiH.2   const H \n 1.492201 -1.158738  2.069329 \n\nThreshold:\n-Variable: Z(t) = + (0) X(t)+ (1)X(t-1)\n-Value: 2.867\nProportion of points in low regime: 49.11% \t High regime: 50.89% \n\nResiduals:\n      Min        1Q    Median        3Q       Max \n-0.725279 -0.117072  0.023711  0.115959  0.511283 \n\nFit:\nresiduals variance = 0.04379,  AIC = -345, MAPE = 5.959%\n\nCoefficient(s):\n\n         Estimate  Std. Error  t value  Pr(>|t|)    \nconst L  0.016407    0.168480   0.0974    0.9226    \nphiL.1   1.084034    0.066237  16.3660 < 2.2e-16 ***\nconst H  2.069329    0.402274   5.1441 1.196e-06 ***\nphiH.1   1.492201    0.086225  17.3060 < 2.2e-16 ***\nphiH.2  -1.158738    0.122828  -9.4339 8.375e-16 ***\n---\nSignif. codes:  0 \u2018***\u2019 0.001 \u2018**\u2019 0.01 \u2018*\u2019 0.05 \u2018.\u2019 0.1 \u2018 \u2019 1\n\nThreshold\nVariable: Z(t) = + (0) X(t) + (1) X(t-1)\n\nValue: 2.867\n```\n\n\n```{r:R}\nplot(set3)\n```\n![graph.20.png](https://qiita-image-store.s3.amazonaws.com/0/43487/467ebf0d-047e-bede-1750-9c5873ee6558.png)\n\n\n![graph.21.png](https://qiita-image-store.s3.amazonaws.com/0/43487/87a2d1ad-45fb-8567-d0ad-2c27231e386e.png)\n\n![graph.22.png](https://qiita-image-store.s3.amazonaws.com/0/43487/8f845305-a9d4-edd4-3138-5e5bb26bc09d.png)\n\n![graph.23.png](https://qiita-image-store.s3.amazonaws.com/0/43487/470882b4-7bc4-9c68-076b-788d3691f617.png)\n\n![graph.24.png](https://qiita-image-store.s3.amazonaws.com/0/43487/00d9770d-2ed6-427d-8817-bce1f5f89d6d.png)\n\n![graph.25.png](https://qiita-image-store.s3.amazonaws.com/0/43487/61665eee-155e-1d70-1b36-59a23ae2c2ad.png)\n\n![graph.26.png](https://qiita-image-store.s3.amazonaws.com/0/43487/d8ebcb09-87ea-7195-51ba-62cfff14b6d8.png)\n\n![graph.27.png](https://qiita-image-store.s3.amazonaws.com/0/43487/17aa3bed-b3ac-1207-d220-ffa971daae82.png)\n\n\n\n**\u30e2\u30c7\u30eb\u8a2d\u5b9a\u4e8b\u4f8b 4**\nEstimate TAR model (parameter L=1 , M=1, H=2. set different AR order degrees between L (Low regime) and H (High regime))\n\n```{r:R}\n\nset4 <- setar(x, mL=1, mM=1, mH=2, nthresh=2)\n\nsummary(set4)\n```\n\n**Low regime:** , **Mid regime:** , **High regime:** \u306e3\u533a\u5206\u3001**const L** , **const M** , **const H** \u306e3\u3064\u306e\u30d1\u30e9\u30e1\u30fc\u30bf\u304c\u623b\u308a\u5024\u3067\u8fd4\u3055\u308c\u3066\u3044\u308b\n\n```\nNon linear autoregressive model\n\nSETAR model ( 3 regimes)\nCoefficients:\nLow regime:\n   phiL.1   const L \n0.9525294 0.2593074 \n\nMid regime:\n    phiM.1    const M \n-0.4309422  3.8469124 \n\nHigh regime:\n    phiH.1     phiH.2    const H \n 1.5363549 -0.9983326  1.3595496 \n\nThreshold:\n-Variable: Z(t) = + (1) X(t)+ (0)X(t-1)+ (1)X(t-0)\n-Value: 2.538 2.769\nProportion of points in low regime: 25% \t Middle regime: 17.86% \t High regime: 57.14% \n\nResiduals:\n      Min        1Q    Median        3Q       Max \n-0.867471 -0.131310  0.033701  0.157642  0.637476 \n\nFit:\nresiduals variance = 0.06517,  AIC = -293, MAPE = 7.413%\n\nCoefficient(s):\n\n         Estimate  Std. Error  t value  Pr(>|t|)    \nconst L   0.25931     0.38401   0.6753 0.5009696    \nphiL.1    0.95253     0.17630   5.4029 4.000e-07 ***\nconst M   3.84691     2.09650   1.8349 0.0692951 .  \nphiM.1   -0.43094     0.79242  -0.5438 0.5876876    \nconst H   1.35955     0.39537   3.4387 0.0008341 ***\nphiH.1    1.53635     0.15051  10.2076 < 2.2e-16 ***\nphiH.2   -0.99833     0.11370  -8.7803 2.899e-14 ***\n---\nSignif. codes:  0 \u2018***\u2019 0.001 \u2018**\u2019 0.01 \u2018*\u2019 0.05 \u2018.\u2019 0.1 \u2018 \u2019 1\n\nThreshold\nVariable: Z(t) = + (1) X(t) + (0) X(t-1)\n\nValue: 2.538 2.769\n```\n\n\n```{r:R}\nplot(set4)\n\n```\n![plot.1.png](https://qiita-image-store.s3.amazonaws.com/0/43487/1489ca65-d498-8691-0ed3-809a29e05d41.png)\n\n\n![plot.2.png](https://qiita-image-store.s3.amazonaws.com/0/43487/1a2dddb9-3ed8-b990-50c5-83195d4e1381.png)\n\n\n![plot.3.png](https://qiita-image-store.s3.amazonaws.com/0/43487/8b2a12d9-4623-40ff-44a0-156418b54c9c.png)\n\n\n![plot.4.png](https://qiita-image-store.s3.amazonaws.com/0/43487/198180b2-1bf7-c2f1-b59e-e613bcbd06ba.png)\n\n\n![plot.5.png](https://qiita-image-store.s3.amazonaws.com/0/43487/468b0c2b-7357-a022-0dca-88687e1b0449.png)\n\n![plot.6.png](https://qiita-image-store.s3.amazonaws.com/0/43487/daa559ac-4600-4bb0-29d9-e84e612179a8.png)\n\n\n![plot.7.png](https://qiita-image-store.s3.amazonaws.com/0/43487/c1e6baa5-56dd-7449-c488-86102f215778.png)\n\n![plot.8.png](https://qiita-image-store.s3.amazonaws.com/0/43487/779df3d8-4bd4-0e3e-b803-b4546617eedf.png)\n\n\n**\u30e2\u30c7\u30eb\u8a2d\u5b9a\u4e8b\u4f8b 5**\n\nChange state variable \uff08\u72b6\u614b\u5909\u6570\uff09from Xt to Xt-1\n\nEstimate TAR model (parameter L=1 , M=1, H=2. set different AR order degrees between L (Low regime) and H (High regime))\n\n```{r:R}\n\n#set \"thDelay\" to 1\nset5 <- setar(x, mL=1, mM=1, mH=2, nthresh=2, thDelay=1)\n\nsummary(set5)\n```\n\n**Low regime:** , **Mid regime:** , **High regime:** \u306e3\u533a\u5206\u3001**const L** , **const M** , **const H** \u306e3\u3064\u306e\u30d1\u30e9\u30e1\u30fc\u30bf\u304c\u623b\u308a\u5024\u3067\u8fd4\u3055\u308c\u3066\u3044\u308b\n\n```\nNon linear autoregressive model\n\nSETAR model ( 3 regimes)\nCoefficients:\nLow regime:\n    phiL.1    const L \n1.09504843 0.08583062 \n\nMid regime:\n    phiM.1    const M \n 1.2548998 -0.5209049 \n\nHigh regime:\n   phiH.1    phiH.2   const H \n 1.492201 -1.158738  2.069329 \n\nThreshold:\n-Variable: Z(t) = + (0) X(t)+ (1)X(t-1)+ (0)X(t-0)\n-Value: 2.446 2.867\nProportion of points in low regime: 22.32% \t Middle regime: 26.79% \t High regime: 50.89% \n\nResiduals:\n        Min          1Q      Median          3Q         Max \n-0.56028028 -0.13249555  0.00073843  0.12941293  0.50777153 \n\nFit:\nresiduals variance = 0.03885,  AIC = -352, MAPE = 5.68%\n\nCoefficient(s):\n\n         Estimate  Std. Error  t value  Pr(>|t|)    \nconst L  0.085831    0.264395   0.3246   0.74609    \nphiL.1   1.095048    0.113891   9.6149 3.802e-16 ***\nconst M -0.520905    0.242603  -2.1472   0.03404 *  \nphiM.1   1.254900    0.089362  14.0429 < 2.2e-16 ***\nconst H  2.069329    0.382450   5.4107 3.866e-07 ***\nphiH.1   1.492201    0.081975  18.2030 < 2.2e-16 ***\nphiH.2  -1.158738    0.116775  -9.9229 < 2.2e-16 ***\n---\nSignif. codes:  0 \u2018***\u2019 0.001 \u2018**\u2019 0.01 \u2018*\u2019 0.05 \u2018.\u2019 0.1 \u2018 \u2019 1\n\nThreshold\nVariable: Z(t) = + (0) X(t) + (1) X(t-1)\n\nValue: 2.446 2.867\n```\n\n\n```{r:R}\nplot(set5)\n```\n![plot.9.png](https://qiita-image-store.s3.amazonaws.com/0/43487/25a4780f-6a33-1184-18e7-be501fbf0ca3.png)\n\n![plot.10.png](https://qiita-image-store.s3.amazonaws.com/0/43487/b0f188fd-3344-f241-e505-308b569fdb15.png)\n\n![plot.11.png](https://qiita-image-store.s3.amazonaws.com/0/43487/c3126641-5f61-de67-ffe4-66985bcf24d2.png)\n\n![plot.12.png](https://qiita-image-store.s3.amazonaws.com/0/43487/6773a2ad-0b30-7040-7be2-0b77283b3b54.png)\n\n![plot.13.png](https://qiita-image-store.s3.amazonaws.com/0/43487/7fac15b0-e3d5-3290-217f-b82c5644e862.png)\n\n\n![plot.14.png](https://qiita-image-store.s3.amazonaws.com/0/43487/4ff69cc7-5990-01e3-6af5-855506a7ff87.png)\n\n![plot.15.png](https://qiita-image-store.s3.amazonaws.com/0/43487/3367ef0c-8ef8-9d95-20c0-f2a6f0200370.png)\n\n![plot.16.png](https://qiita-image-store.s3.amazonaws.com/0/43487/588a4a85-4957-c449-58db-adcec2cb86e5.png)\n\n\n**\u30e2\u30c7\u30eb\u8a2d\u5b9a\u4e8b\u4f8b 6**\n\nChange state variable \uff08\u72b6\u614b\u5909\u6570\uff09from Xt to Xt-1\n\nEstimate TAR model (parameter L=3 , M=4, H=5. set different AR order degrees between L (Low regime) and H (High regime))\n\n```{r:R}\n\n#set \"thDelay\" to 1\nset6 <- setar(x, mL=3, mM=4, mH=5, nthresh=2, thDelay=1)\n\nsummary(set6)\n```\n\n\n```\nNon linear autoregressive model\n\nSETAR model ( 3 regimes)\nCoefficients:\nLow regime:\n     phiL.1      phiL.2      phiL.3     const L \n 1.06675248 -0.08337226 -0.23461191  0.84307966 \n\nMid regime:\n    phiM.1     phiM.2     phiM.3     phiM.4    const M \n 0.9814068  1.0982503 -0.6292274 -0.2263754 -1.2417259 \n\nHigh regime:\n    phiH.1     phiH.2     phiH.3     phiH.4     phiH.5    const H \n 1.9362242 -2.1139923  1.5157125 -0.9123496  0.3276137  0.7088992 \n\nThreshold:\n-Variable: Z(t) = + (0) X(t)+ (1)X(t-1)+ (0)X(t-2)+ (0)X(t-3)\n-Value: 3.310 3.475\nProportion of points in low regime: 68.81% \t Middle regime: 14.68% \t High regime: 16.51% \n\nResiduals:\n      Min        1Q    Median        3Q       Max \n-0.531476 -0.095800  0.016631  0.109983  0.464993 \n\nFit:\nresiduals variance = 0.03011,  AIC = -365, MAPE = 5.103%\n\nCoefficient(s):\n\n         Estimate  Std. Error  t value  Pr(>|t|)    \nconst L  0.843080    0.164679   5.1195 1.508e-06 ***\nphiL.1   1.066752    0.096707  11.0307 < 2.2e-16 ***\nphiL.2  -0.083372    0.149867  -0.5563 0.5792551    \nphiL.3  -0.234612    0.089051  -2.6346 0.0097784 ** \nconst M -1.241726    4.337193  -0.2863 0.7752488    \nphiM.1   0.981407    0.279116   3.5161 0.0006624 ***\nphiM.2   1.098250    1.679618   0.6539 0.5147122    \nphiM.3  -0.629227    0.417373  -1.5076 0.1348443    \nphiM.4  -0.226375    0.253323  -0.8936 0.3736912    \nconst H  0.708899    1.501065   0.4723 0.6377775    \nphiH.1   1.936224    0.176319  10.9813 < 2.2e-16 ***\nphiH.2  -2.113992    0.550442  -3.8405 0.0002167 ***\nphiH.3   1.515712    0.512822   2.9556 0.0039001 ** \nphiH.4  -0.912350    0.454459  -2.0076 0.0474164 *  \nphiH.5   0.327614    0.266495   1.2293 0.2218564    \n---\nSignif. codes:  0 \u2018***\u2019 0.001 \u2018**\u2019 0.01 \u2018*\u2019 0.05 \u2018.\u2019 0.1 \u2018 \u2019 1\n\nThreshold\nVariable: Z(t) = + (0) X(t) + (1) X(t-1)+ (0) X(t-2)+ (0) X(t-3)+ (0) X(t-4)\n\nValue: 3.310 3.475\n```\n\n\n```{r:R}\nplot(set6)\n\n```\n\n![plot.17.png](https://qiita-image-store.s3.amazonaws.com/0/43487/323fcd0a-bc21-e49f-6f50-5f9a7a80e770.png)\n\n![plot.18.png](https://qiita-image-store.s3.amazonaws.com/0/43487/6149274e-ef55-b100-8c24-6178498c3ef6.png)\n\n![plot.19.png](https://qiita-image-store.s3.amazonaws.com/0/43487/e7779a37-b8e5-a9d0-ed22-772384e19405.png)\n\n![plot.20.png](https://qiita-image-store.s3.amazonaws.com/0/43487/94efdc18-983f-1d5b-f241-f48137b8d010.png)\n\n![plot.21.png](https://qiita-image-store.s3.amazonaws.com/0/43487/c0ded6ab-fa55-42e3-4c01-3a14f1555fa0.png)\n\n![plot.22.png](https://qiita-image-store.s3.amazonaws.com/0/43487/b40978c1-bbf3-d2b5-5edd-1b01ea01aab3.png)\n\n![plot.23.png](https://qiita-image-store.s3.amazonaws.com/0/43487/c9ea2964-fd61-d6d8-a673-4fdc409802d7.png)\n\n![plot.24.png](https://qiita-image-store.s3.amazonaws.com/0/43487/bd5b8e29-db68-273c-d3ae-290defed7887.png)\n\n![plot.25.png](https://qiita-image-store.s3.amazonaws.com/0/43487/75b44628-f853-ba00-b0f3-1c3cab5988f5.png)\n\n\n![plot.26.png](https://qiita-image-store.s3.amazonaws.com/0/43487/94fe1a4f-2193-85a4-fbfa-e8182f453e79.png)\n\n![plot.27.png](https://qiita-image-store.s3.amazonaws.com/0/43487/3a36efcd-f3c2-c0fa-c6f1-fee7fd0745bf.png)\n\n## \u305d\u306e\u4ed6 \u95a2\u9023\u3059\u308b\u5206\u6790\u624b\u6cd5\n**\u30de\u30eb\u30b3\u30d5\u30fb\u30b9\u30a4\u30c3\u30c1\u30f3\u30b0\u30e2\u30c7\u30eb** _**\uff08 Markov Switching \uff09**_\n\n\u203b \u672c\u7a3f\u3067\u5f15\u7528\u3057\u3066\u304d\u305f\u300c\u9280\u5ea7\u3067\u50cd\u304f\u30c7\u30fc\u30bf\u30b5\u30a4\u30a8\u30f3\u30c6\u30a3\u30b9\u30c8\u306e\u30d6\u30ed\u30b0\u300d\u8a18\u4e8b\u3067\u3082\u53d6\u308a\u4e0a\u3052\u3089\u308c\u3066\u3044\u308b\u304c\u3001\u624b\u6cd5\u306e\u6982\u8981\u8aac\u660e\u306f\u4ed6\u66f8\u306b\u59d4\u306d\u3089\u308c\u3066\u3044\u308b\u305f\u3081\u3001\u308f\u304b\u308a\u3065\u3089\u3044\n\n**\uff08 \u4ee5\u4e0b\u304c\u5206\u304b\u308a\u3084\u3059\u3044 \uff09**\n\n[ \u6c96\u672c\u7adc\u7fa9\uff082013\u5e746\u670823\u65e5\uff09\u300c\u30de\u30eb\u30b3\u30d5\u30b9\u30a4\u30c3\u30c1\u30f3\u30b0\u30e2\u30c7\u30eb\u306e\u30de\u30af\u30ed\u7d4c\u6e08\u30fb\u30d5\u30a1\u30a4\u30ca\u30f3\u30b9\u3078\u306e\u5fdc\u5fdc\u7528\u300d](http://stat.econ.osaka-u.ac.jp/~suryo/201306/msmodel_jea13.pdf)\n![MSmodel.png](https://qiita-image-store.s3.amazonaws.com/0/43487/6b2a3f43-bb10-0c29-5573-257e6029df92.png)\n\n![MSmodel.2.png](https://qiita-image-store.s3.amazonaws.com/0/43487/db5a0960-0aa2-1283-7827-ecf9c49116dc.png)\n\n---------------------------------------------------------------------------------\n\n**\uff08\u4ee5\u4e0b\u306f\u3001\u3088\u308a\u304b\u307f\u304f\u3060\u3044\u3060\u8aac\u660e\uff09**\n\n[ \u30a4\u30f3\u30bf\u30fc\u30cd\u30c3\u30c8\u5e83\u544a\u4ee3\u7406\u5e97\u3067\u50cd\u304f\u30c7\u30fc\u30bf\u30b5\u30a4\u30a8\u30f3\u30c6\u30a3\u30b9\u30c8\u306e\u30d6\u30ed\u30b0\uff082013-12-04\uff09\u300c\u30b5\u30fc\u30e2\u30f3\u3068\u30a4\u30f3\u30bf\u30fc\u30cd\u30c3\u30c8\u5e83\u544a\u3068\u30de\u30eb\u30b3\u30d5\u8ee2\u63db\u30e2\u30c7\u30eb\u300d](http://ameblo.jp/cyberanalyst/entry-11717614381.html)\n![ameba.0.png](https://qiita-image-store.s3.amazonaws.com/0/43487/e2ec634c-900e-27b7-3942-5d3358aafaa4.png)\n\n![ameba.0.5.png](https://qiita-image-store.s3.amazonaws.com/0/43487/d3f555f1-835a-330e-de72-a98f8025a522.png)\n\n![ameba.1.png](https://qiita-image-store.s3.amazonaws.com/0/43487/fd9edfd3-7a63-5cc7-4d39-3c11574771a0.png)\n\n![ameba.2.png](https://qiita-image-store.s3.amazonaws.com/0/43487/ac594101-f8db-54fb-b69a-0a8aa04c6ae0.png)\n\n\n**\uff08 \u5229\u7528\u4e8b\u4f8b \uff09**\n[ \u5927\u585a\u82b3\u5b8f\uff082011\uff09\u300c\u30de\u30eb\u30b3\u30d5\u30fb\u30b9\u30a4\u30c3\u30c1\u30f3\u30b0\u6642\u7a7a\u9593\u81ea\u5df1\u56de\u5e30\u30e2\u30c7\u30eb\u306b\u3088\u308b\u65e5\u672c\u306e\u5730\u57df\u5225\u306e\u666f\u6c17\u5faa\u74b0\u306e\u8a08\u91cf\u5206\u6790\u300d\n  ](http://www.terrapub.co.jp/journals/jjssj/pdf/4002/40020089.pdf)\n\n[ \u5c0f\u6c60\u5149\u592a\u90ce\uff08\u5b66\u4f4d\u8ad6\u65872005\u5e74\u5ea6\uff09\u300c\u30de\u30eb\u30b3\u30d5\u30e2\u30c7\u30eb\u3092\u7528\u3044\u305f\u30d5\u30c3\u30c8\u30b5\u30eb\u306e\u8a66\u5408\u5206\u6790\u300d](http://www.ise.chuo-u.ac.jp/ise-labs/taguchi-lab/pdf/r01d8104023.pdf)\n", "tags": ["R", "\u6642\u7cfb\u5217\u89e3\u6790", "\u7d71\u8a08\u5b66", "\u30c7\u30fc\u30bf\u5206\u6790", "statistics"]}