{"context": "\u4ee5\u524d\u66f8\u3044\u305fLINE BOT\u3092Node.js\u3067\u5916\u90e8\u4f9d\u5b58\u30e2\u30b8\u30e5\u30fc\u30eb\u3092\u4f7f\u7528\u305b\u305a\u306b\u4f5c\u308b\u306e\u30b3\u30fc\u30c9\u3092\u3082\u3068\u306b\u5148\u65e5SuperAgent\u5229\u7528\u7248\u3092\u66f8\u304d\u307e\u3057\u305f\u3002\u4eca\u56de\u306faxios\u3092\u5229\u7528\u3057\u3066\u307f\u307e\u3059\u3002\nLINE BOT\u306e\u3082\u304f\u3082\u304f\u4f1a\u4e2d\u306b\u66f8\u3044\u3066\u307e\u3059\u3002\n  \n  \u3082\u304f\u3082\u304f\u3000#BotAwards n0bisuke\u3055\u3093(@n0bisuke)\u304c\u6295\u7a3f\u3057\u305f\u5199\u771f - 2017  2\u6708 8 2:33\u5348\u524d PST\n\n\naxios\nhttps://www.npmjs.com/package/axios\nHTTP\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u30e9\u30a4\u30d6\u30e9\u30ea\u3067\u3059\u3002\n\u5148\u65e5\u306e#nodeschool_tokyo\u3067\u4f1a\u9577\u304c\u30e9\u30a4\u30d6\u30b3\u30fc\u30c7\u30a3\u30f3\u30b0\u3067\u4f7f\u3063\u3066\u3044\u307e\u3057\u305f\u3002\nSuperAgent\u306e\u30e1\u30bd\u30c3\u30c9\u30c1\u30a7\u30fc\u30f3\u5229\u7528\u304c\u3057\u3063\u304f\u308a\u3053\u306a\u3044\u4eba\u306faxios\u3092\u4f7f\u3046\u5834\u5408\u304c\u591a\u3044\u3088\u3046\u3067\u3059\u3002\n\u57fa\u672c\u306e\u4f7f\u3044\u65b9\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u611f\u3058\u3067Promise\u306a\u66f8\u304d\u65b9\u3067\u4f7f\u3048\u307e\u3059\u3002\n\napp.js\nvar axios = require('axios');\n\naxios.post('/user', {\n    firstName: 'Fred',\n    lastName: 'Flintstone'\n  })\n  .then(function (response) {\n    console.log(response);\n  })\n  .catch(function (error) {\n    console.log(error);\n  });\n\n\n\nLINE Bot\u3092\u4f5c\u308b\nNode.js v7.4.0\u3067\u8a66\u3057\u3066\u3044\u307e\u3059\u3002\n\n\u6e96\u5099\n\n$ mkdir mylinebot && cd mylinebot\n$ npm init --yes\n$ npm i --save axios\n\n\napp.js\u3092\u4f5c\u308b\n\n\u300cLINE BOT\u3092Node.js\u3067\u5916\u90e8\u4f9d\u5b58\u30e2\u30b8\u30e5\u30fc\u30eb\u3092\u4f7f\u7528\u305b\u305a\u306b\u4f5c\u308b\u300d\u3067\u5229\u7528\u3057\u3066\u308b\u30b3\u30fc\u30c9\u304b\u3089HTTP\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u306e\u90e8\u5206\u3092\u4e3b\u306b\u5dee\u3057\u66ff\u3048\u3066\u307e\u3059\u3002\n\napp.js\n'use strict';\n\nconst http = require('http');\nconst crypto = require('crypto');\nconst axios = require('axios');\nconst BASE_URL = 'https://api.line.me';\nconst REPLY_PATH = '/v2/bot/message/reply';//\u30ea\u30d7\u30e9\u30a4\u7528\nconst CH_SECRET = process.env.SECRET || ''; //Channel Secret\u3092\u6307\u5b9a\nconst CH_ACCESS_TOKEN = process.env.TOKEN || ''; //Channel Access Token\u3092\u6307\u5b9a\nconst SIGNATURE = crypto.createHmac('sha256', CH_SECRET);\nconst PORT = process.env.PORT || 3000;\n\nhttp.createServer((req, res) => {    \n    if(req.url !== '/' || req.method !== 'POST'){\n        res.writeHead(200, {'Content-Type': 'text/plain'});\n        res.end('hello');\n    }\n\n    let body = '';\n    req.on('data', (chunk) => {\n        body += chunk;\n    });        \n    req.on('end', () => {\n        if(body === ''){\n          console.log('body\u304c\u7a7a\u3067\u3059\u3002');\n          return;\n        }\n\n        let WebhookEventObject = JSON.parse(body).events[0];\n\n        //\u30e1\u30c3\u30bb\u30fc\u30b8\u304c\u9001\u3089\u308c\u3066\u6765\u305f\u5834\u5408\n        if(WebhookEventObject.type === 'message'){\n            let SendMessageObject;\n            if(WebhookEventObject.message.type === 'text'){\n                SendMessageObject = [{\n                    type: 'text',\n                    text: WebhookEventObject.message.text\n                }];\n            }\n\n            axios.request({\n                method: 'post',\n                baseURL: BASE_URL,\n                headers: {\n                    'Content-Type': 'application/json; charset=UTF-8',\n                    'X-Line-Signature': SIGNATURE,\n                    'Authorization': `Bearer ${CH_ACCESS_TOKEN}`\n                },\n                url: REPLY_PATH,\n                data: {replyToken: WebhookEventObject.replyToken, messages: SendMessageObject},\n            }).then((res) => {\n                console.log(res.status);\n            })\n            .catch((error) => {\n                console.log(error);\n            });\n        }\n\n        res.writeHead(200, {'Content-Type': 'text/plain'});\n        res.end('success');\n    });\n}).listen(PORT);\n\nconsole.log(`Server running at ${PORT}`);\n\n\n\n\u5b9f\u884c\n\n(\u203b)\u4eca\u56de\u306fprocess.env.SECRET\u3068process.env.TOKEN\u304b\u3089LINE BOT\u306echannel secret\u3068channel access token\u3092\u53d7\u3051\u53d6\u308b\u3088\u3046\u306b\u3057\u3066\u3044\u307e\u3059\u3002\n$ SECRET=xxxx TOKEN=xxxxxxxx node app.js\n\n\u3053\u308c\u3067\u5b9f\u884c\u3059\u308b\u3068\u304a\u3046\u3080\u8fd4\u3057\u3057\u3066\u304f\u308c\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\n\n\u304a\u308f\u308a\u306b\naxios\u3092\u4f7f\u3063\u3066LINE BOT\u958b\u767a\u3092\u3057\u305f\u3044\u65b9\u306e\u53c2\u8003\u306b\u306a\u308c\u3070\u5e78\u3044\u3067\u3059\u3002\n\u307e\u3060\u3082\u304f\u3082\u304f\u4f1a\u3084\u308b\u306e\u3067\u304d\u3066\u304f\u3060\u3055\u3044\u306d\u301c\n\n2/9 at LINE\u672c\u793e https://linedev.connpass.com/event/49982/\n\n\n\n\u4ee5\u524d\u66f8\u3044\u305f[LINE BOT\u3092Node.js\u3067\u5916\u90e8\u4f9d\u5b58\u30e2\u30b8\u30e5\u30fc\u30eb\u3092\u4f7f\u7528\u305b\u305a\u306b\u4f5c\u308b](http://qiita.com/n0bisuke/items/56d7ace2193fbc106639)\u306e\u30b3\u30fc\u30c9\u3092\u3082\u3068\u306b\u5148\u65e5[SuperAgent\u5229\u7528\u7248](http://qiita.com/n0bisuke/items/52a0512782446fd52c2b)\u3092\u66f8\u304d\u307e\u3057\u305f\u3002\u4eca\u56de\u306faxios\u3092\u5229\u7528\u3057\u3066\u307f\u307e\u3059\u3002\n\n[LINE BOT\u306e\u3082\u304f\u3082\u304f\u4f1a](https://linedev.connpass.com/event/49885/)\u4e2d\u306b\u66f8\u3044\u3066\u307e\u3059\u3002\n\n<blockquote class=\"instagram-media\" data-instgrm-captioned data-instgrm-version=\"7\" style=\" background:#FFF; border:0; border-radius:3px; box-shadow:0 0 1px 0 rgba(0,0,0,0.5),0 1px 10px 0 rgba(0,0,0,0.15); margin: 1px; max-width:658px; padding:0; width:99.375%; width:-webkit-calc(100% - 2px); width:calc(100% - 2px);\"><div style=\"padding:8px;\"> <div style=\" background:#F8F8F8; line-height:0; margin-top:40px; padding:37.5% 0; text-align:center; width:100%;\"> <div style=\" background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACwAAAAsCAMAAAApWqozAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAMUExURczMzPf399fX1+bm5mzY9AMAAADiSURBVDjLvZXbEsMgCES5/P8/t9FuRVCRmU73JWlzosgSIIZURCjo/ad+EQJJB4Hv8BFt+IDpQoCx1wjOSBFhh2XssxEIYn3ulI/6MNReE07UIWJEv8UEOWDS88LY97kqyTliJKKtuYBbruAyVh5wOHiXmpi5we58Ek028czwyuQdLKPG1Bkb4NnM+VeAnfHqn1k4+GPT6uGQcvu2h2OVuIf/gWUFyy8OWEpdyZSa3aVCqpVoVvzZZ2VTnn2wU8qzVjDDetO90GSy9mVLqtgYSy231MxrY6I2gGqjrTY0L8fxCxfCBbhWrsYYAAAAAElFTkSuQmCC); display:block; height:44px; margin:0 auto -44px; position:relative; top:-22px; width:44px;\"></div></div> <p style=\" margin:8px 0 0 0; padding:0 4px;\"> <a href=\"https://www.instagram.com/p/BQP1X7mDmpK/\" style=\" color:#000; font-family:Arial,sans-serif; font-size:14px; font-style:normal; font-weight:normal; line-height:17px; text-decoration:none; word-wrap:break-word;\" target=\"_blank\">\u3082\u304f\u3082\u304f\u3000#BotAwards</a></p> <p style=\" color:#c9c8cd; font-family:Arial,sans-serif; font-size:14px; line-height:17px; margin-bottom:0; margin-top:8px; overflow:hidden; padding:8px 0 7px; text-align:center; text-overflow:ellipsis; white-space:nowrap;\">n0bisuke\u3055\u3093(@n0bisuke)\u304c\u6295\u7a3f\u3057\u305f\u5199\u771f - <time style=\" font-family:Arial,sans-serif; font-size:14px; line-height:17px;\" datetime=\"2017-02-08T10:33:33+00:00\">2017  2\u6708 8 2:33\u5348\u524d PST</time></p></div></blockquote>\n<script async defer src=\"//platform.instagram.com/en_US/embeds.js\"></script>\n\n## axios\n\nhttps://www.npmjs.com/package/axios\n\nHTTP\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u30e9\u30a4\u30d6\u30e9\u30ea\u3067\u3059\u3002\n\n[\u5148\u65e5\u306e#nodeschool_tokyo](https://nodejs.connpass.com/event/45720/)\u3067\u4f1a\u9577\u304c\u30e9\u30a4\u30d6\u30b3\u30fc\u30c7\u30a3\u30f3\u30b0\u3067\u4f7f\u3063\u3066\u3044\u307e\u3057\u305f\u3002\n\nSuperAgent\u306e\u30e1\u30bd\u30c3\u30c9\u30c1\u30a7\u30fc\u30f3\u5229\u7528\u304c\u3057\u3063\u304f\u308a\u3053\u306a\u3044\u4eba\u306faxios\u3092\u4f7f\u3046\u5834\u5408\u304c\u591a\u3044\u3088\u3046\u3067\u3059\u3002\n\n\u57fa\u672c\u306e\u4f7f\u3044\u65b9\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u611f\u3058\u3067Promise\u306a\u66f8\u304d\u65b9\u3067\u4f7f\u3048\u307e\u3059\u3002\n\n```app.js\nvar axios = require('axios');\n\naxios.post('/user', {\n    firstName: 'Fred',\n    lastName: 'Flintstone'\n  })\n  .then(function (response) {\n    console.log(response);\n  })\n  .catch(function (error) {\n    console.log(error);\n  });\n```\n\n## LINE Bot\u3092\u4f5c\u308b\n\n`Node.js v7.4.0`\u3067\u8a66\u3057\u3066\u3044\u307e\u3059\u3002\n\n* \u6e96\u5099\n\n```bash\n$ mkdir mylinebot && cd mylinebot\n$ npm init --yes\n$ npm i --save axios\n```\n\n* app.js\u3092\u4f5c\u308b\n\n\u300c[LINE BOT\u3092Node.js\u3067\u5916\u90e8\u4f9d\u5b58\u30e2\u30b8\u30e5\u30fc\u30eb\u3092\u4f7f\u7528\u305b\u305a\u306b\u4f5c\u308b](http://qiita.com/n0bisuke/items/56d7ace2193fbc106639)\u300d\u3067\u5229\u7528\u3057\u3066\u308b\u30b3\u30fc\u30c9\u304b\u3089HTTP\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u306e\u90e8\u5206\u3092\u4e3b\u306b\u5dee\u3057\u66ff\u3048\u3066\u307e\u3059\u3002\n\n```app.js\n'use strict';\n\nconst http = require('http');\nconst crypto = require('crypto');\nconst axios = require('axios');\nconst BASE_URL = 'https://api.line.me';\nconst REPLY_PATH = '/v2/bot/message/reply';//\u30ea\u30d7\u30e9\u30a4\u7528\nconst CH_SECRET = process.env.SECRET || ''; //Channel Secret\u3092\u6307\u5b9a\nconst CH_ACCESS_TOKEN = process.env.TOKEN || ''; //Channel Access Token\u3092\u6307\u5b9a\nconst SIGNATURE = crypto.createHmac('sha256', CH_SECRET);\nconst PORT = process.env.PORT || 3000;\n\nhttp.createServer((req, res) => {    \n    if(req.url !== '/' || req.method !== 'POST'){\n        res.writeHead(200, {'Content-Type': 'text/plain'});\n        res.end('hello');\n    }\n\n    let body = '';\n    req.on('data', (chunk) => {\n        body += chunk;\n    });        \n    req.on('end', () => {\n        if(body === ''){\n          console.log('body\u304c\u7a7a\u3067\u3059\u3002');\n          return;\n        }\n\n        let WebhookEventObject = JSON.parse(body).events[0];\n        \n        //\u30e1\u30c3\u30bb\u30fc\u30b8\u304c\u9001\u3089\u308c\u3066\u6765\u305f\u5834\u5408\n        if(WebhookEventObject.type === 'message'){\n            let SendMessageObject;\n            if(WebhookEventObject.message.type === 'text'){\n                SendMessageObject = [{\n                    type: 'text',\n                    text: WebhookEventObject.message.text\n                }];\n            }\n\n            axios.request({\n                method: 'post',\n                baseURL: BASE_URL,\n                headers: {\n                    'Content-Type': 'application/json; charset=UTF-8',\n                    'X-Line-Signature': SIGNATURE,\n                    'Authorization': `Bearer ${CH_ACCESS_TOKEN}`\n                },\n                url: REPLY_PATH,\n                data: {replyToken: WebhookEventObject.replyToken, messages: SendMessageObject},\n            }).then((res) => {\n                console.log(res.status);\n            })\n            .catch((error) => {\n                console.log(error);\n            });\n        }\n\n        res.writeHead(200, {'Content-Type': 'text/plain'});\n        res.end('success');\n    });\n}).listen(PORT);\n\nconsole.log(`Server running at ${PORT}`);\n```\n\n* \u5b9f\u884c\n\n(\u203b)\u4eca\u56de\u306f`process.env.SECRET`\u3068`process.env.TOKEN`\u304b\u3089LINE BOT\u306e`channel secret`\u3068`channel access token`\u3092\u53d7\u3051\u53d6\u308b\u3088\u3046\u306b\u3057\u3066\u3044\u307e\u3059\u3002\n\n```bash\n$ SECRET=xxxx TOKEN=xxxxxxxx node app.js\n```\n\n\u3053\u308c\u3067\u5b9f\u884c\u3059\u308b\u3068\u304a\u3046\u3080\u8fd4\u3057\u3057\u3066\u304f\u308c\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\n\n##\u304a\u308f\u308a\u306b\n\n\u0010axios\u3092\u4f7f\u3063\u3066LINE BOT\u958b\u767a\u3092\u3057\u305f\u3044\u65b9\u306e\u53c2\u8003\u306b\u306a\u308c\u3070\u5e78\u3044\u3067\u3059\u3002\n\n\u307e\u3060\u3082\u304f\u3082\u304f\u4f1a\u3084\u308b\u306e\u3067\u304d\u3066\u304f\u3060\u3055\u3044\u306d\u301c\n\n* 2/9 at LINE\u672c\u793e https://linedev.connpass.com/event/49982/\n", "tags": ["LINEmessagingAPI", "Node.js", "Line", "linebot", "JavaScript"]}