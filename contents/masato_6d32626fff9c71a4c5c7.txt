{"context": " More than 1 year has passed since last update.CoreOS\u30af\u30e9\u30b9\u30bf\u4e0a\u306b\u69cb\u7bc9\u3057\u305fCouchbase Server\u30af\u30e9\u30b9\u30bf\u3092\u3057\u3070\u3089\u304f\u653e\u7f6e\u3057\u3066\u3044\u305f\u3089\u3044\u304f\u3064\u304bunits\u304c\u6b7b\u3093\u3067\u3044\u307e\u3057\u305f\u3002CoreOS\u306ereboot-strategy\u306f\u30c7\u30d5\u30a9\u30eb\u30c8\u306ebest-effort\u3067\u3059\u3002CoreOS\u306e\u518d\u8d77\u52d5\u5f8c\u306b\u8d77\u52d5\u306b\u5931\u6557\u3057\u3066\u3044\u308bfleet units\u304c\u3042\u308a\u307e\u3057\u305f\u3002\n\nfleet units\u306e\u78ba\u8a8d\nfleetctl\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u306f0.8.3\u3067\u3059\u3002\n$ fleetctl version\nfleetctl version 0.8.3\n\nfleetctl\u30b3\u30de\u30f3\u30c9\u3067units\u3092\u30ea\u30b9\u30c8\u3057\u307e\u3059\u3002Couchbase Server\u306f3\u30ce\u30fc\u30c9\u4e2d2\u30ce\u30fc\u30c9\u304cactive\u306a\u306e\u3067\u3001\u52d5\u4f5c\u306f\u3057\u3066\u3044\u308b\u72b6\u614b\u3067\u3059\u3002\n$ fleetctl list-units\nUNIT                        MACHINE         ACTIVE      SUB\ncouchbase_bootstrap_node.service        f0f5fcc4.../10.3.0.47   active      running\ncouchbase_bootstrap_node_announce.service   f0f5fcc4.../10.3.0.47   active      running\ncouchbase_node.1.service            33bf6324.../10.3.0.7    inactive    dead\ncouchbase_node.2.service            461b77ab.../10.3.0.193  active      running\nsync_gw_announce@1.service          33bf6324.../10.3.0.7    inactive    dead\nsync_gw_node@1.service              33bf6324.../10.3.0.7    inactive    dead\n\n\nCorOS\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u3092\u78ba\u8a8d\n\u73fe\u5728\u306eCoreOS\u30af\u30e9\u30b9\u30bf\u306e\u69cb\u6210\u306f\u4ee5\u4e0b\u306e\u901a\u308a\u3067\u3059\u3002\n$ fleetctl list-machines\nMACHINE     IP      METADATA\n33bf6324... 10.3.0.7    -\n461b77ab... 10.3.0.193  -\n80e8c0f2... 10.3.0.210  -\nf0f5fcc4... 10.3.0.47   -\n\n\u6700\u521dCoreOS\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u306f494.5.0\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u3066\u3044\u307e\u3057\u305f\u304c522.4.0\u306b\u81ea\u52d5\u30a2\u30c3\u30d7\u30c7\u30fc\u30c8\u3055\u308c\u3066\u3044\u307e\u3059\u3002\n$ fleetctl ssh 33bf6324 'cat /etc/os-release | grep VERSION_ID'\nVERSION_ID=522.4.0\n$ fleetctl ssh 461b77ab 'cat /etc/os-release | grep VERSION_ID'\nVERSION_ID=522.5.0\n$ fleetctl ssh 80e8c0f2 'cat /etc/os-release | grep VERSION_ID'\nVERSION_ID=522.4.0\n$ fleetctl ssh f0f5fcc4 'cat /etc/os-release | grep VERSION_ID'\nVERSION_ID=522.4.0\n\n\n\u505c\u6b62\u3057\u3066\u3044\u308bunits\u306e\u518d\u8d77\u52d5\ndead\u72b6\u614b\u306b\u306a\u3063\u3066\u3044\u308bfleet units\u3092load\u3057\u3066launch\u3055\u305b\u307e\u3059\u3002\n$ fleetctl stop couchbase_node.1.service\nUnit couchbase_node.1.service loaded on 33bf6324.../10.3.0.7\n$ fleetctl start couchbase_node.1.service\nUnit couchbase_node.1.service launched on 33bf6324.../10.3.0.7\n$ fleetctl stop sync_gw_node@1.service\nUnit sync_gw_node@1.service loaded on 33bf6324.../10.3.0.7\n$ fleetctl start sync_gw_node@1.service\nUnit sync_gw_node@1.service launched on 33bf6324.../10.3.0.7\n$ fleetctl stop sync_gw_announce@1.service\nUnit sync_gw_announce@1.service loaded on 33bf6324.../10.3.0.7\nc$ fleetctl start sync_gw_announce@1.service\nUnit sync_gw_announce@1.service launched on 33bf6324.../10.3.0.7\n\n\u3059\u3079\u3066\u306eunits\u304c\u6b63\u5e38\u306b\u52d5\u4f5c\u3057\u307e\u3057\u305f\u3002\n$ fleetctl list-units\nUNIT                        MACHINE         ACTIVE  SUB\ncouchbase_bootstrap_node.service        f0f5fcc4.../10.3.0.47   active  running\ncouchbase_bootstrap_node_announce.service   f0f5fcc4.../10.3.0.47   active  running\ncouchbase_node.1.service            33bf6324.../10.3.0.7    active  running\ncouchbase_node.2.service            461b77ab.../10.3.0.193  active  running\nsync_gw_announce@1.service          33bf6324.../10.3.0.7    active  running\nsync_gw_node@1.service              33bf6324.../10.3.0.7    active  running\n\n\nServer Nodes\u306eRebalance\nCouchbase\u7ba1\u7406Web\u30b3\u30f3\u30bd\u30fc\u30eb\u306b\u30ed\u30b0\u30a4\u30f3\u3057\u3066\u3001Server Nodes\u30bf\u30d6\u304b\u3089Rebalance\u30dc\u30bf\u30f3\u3092\u30af\u30ea\u30c3\u30af\u3057\u307e\u3059\u3002Couchbase\u306f\u753b\u9762\u304b\u3089\u7c21\u5358\u306b\u30af\u30e9\u30b9\u30bf\u306e\u30ce\u30fc\u30c9\u7ba1\u7406\u304c\u3067\u304d\u307e\u3059\u3002\n\nCoreOS\u30af\u30e9\u30b9\u30bf\u4e0a\u306b\u69cb\u7bc9\u3057\u305fCouchbase Server\u30af\u30e9\u30b9\u30bf\u3092\u3057\u3070\u3089\u304f\u653e\u7f6e\u3057\u3066\u3044\u305f\u3089\u3044\u304f\u3064\u304bunits\u304c\u6b7b\u3093\u3067\u3044\u307e\u3057\u305f\u3002CoreOS\u306ereboot-strategy\u306f\u30c7\u30d5\u30a9\u30eb\u30c8\u306ebest-effort\u3067\u3059\u3002CoreOS\u306e\u518d\u8d77\u52d5\u5f8c\u306b\u8d77\u52d5\u306b\u5931\u6557\u3057\u3066\u3044\u308bfleet units\u304c\u3042\u308a\u307e\u3057\u305f\u3002\n\n\n## fleet units\u306e\u78ba\u8a8d\n\nfleetctl\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u306f0.8.3\u3067\u3059\u3002\n\n``` bash\n$ fleetctl version\nfleetctl version 0.8.3\n```\n\nfleetctl\u30b3\u30de\u30f3\u30c9\u3067units\u3092\u30ea\u30b9\u30c8\u3057\u307e\u3059\u3002Couchbase Server\u306f3\u30ce\u30fc\u30c9\u4e2d2\u30ce\u30fc\u30c9\u304cactive\u306a\u306e\u3067\u3001\u52d5\u4f5c\u306f\u3057\u3066\u3044\u308b\u72b6\u614b\u3067\u3059\u3002\n\n``` bash\n$ fleetctl list-units\nUNIT\t\t\t\t\t\tMACHINE\t\t\tACTIVE\t\tSUB\ncouchbase_bootstrap_node.service\t\tf0f5fcc4.../10.3.0.47\tactive\t\trunning\ncouchbase_bootstrap_node_announce.service\tf0f5fcc4.../10.3.0.47\tactive\t\trunning\ncouchbase_node.1.service\t\t\t33bf6324.../10.3.0.7\tinactive\tdead\ncouchbase_node.2.service\t\t\t461b77ab.../10.3.0.193\tactive\t\trunning\nsync_gw_announce@1.service\t\t\t33bf6324.../10.3.0.7\tinactive\tdead\nsync_gw_node@1.service\t\t\t\t33bf6324.../10.3.0.7\tinactive\tdead\n```\n\n## CorOS\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u3092\u78ba\u8a8d\n\n\u73fe\u5728\u306eCoreOS\u30af\u30e9\u30b9\u30bf\u306e\u69cb\u6210\u306f\u4ee5\u4e0b\u306e\u901a\u308a\u3067\u3059\u3002\n\n``` bash\n$ fleetctl list-machines\nMACHINE\t\tIP\t\tMETADATA\n33bf6324...\t10.3.0.7\t-\n461b77ab...\t10.3.0.193\t-\n80e8c0f2...\t10.3.0.210\t-\nf0f5fcc4...\t10.3.0.47\t-\n```\n\n\u6700\u521dCoreOS\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u306f`494.5.0`\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u3066\u3044\u307e\u3057\u305f\u304c`522.4.0`\u306b\u81ea\u52d5\u30a2\u30c3\u30d7\u30c7\u30fc\u30c8\u3055\u308c\u3066\u3044\u307e\u3059\u3002\n\n``` bash\n$ fleetctl ssh 33bf6324 'cat /etc/os-release | grep VERSION_ID'\nVERSION_ID=522.4.0\n$ fleetctl ssh 461b77ab 'cat /etc/os-release | grep VERSION_ID'\nVERSION_ID=522.5.0\n$ fleetctl ssh 80e8c0f2 'cat /etc/os-release | grep VERSION_ID'\nVERSION_ID=522.4.0\n$ fleetctl ssh f0f5fcc4 'cat /etc/os-release | grep VERSION_ID'\nVERSION_ID=522.4.0\n```\n\n## \u505c\u6b62\u3057\u3066\u3044\u308bunits\u306e\u518d\u8d77\u52d5\n\ndead\u72b6\u614b\u306b\u306a\u3063\u3066\u3044\u308bfleet units\u3092load\u3057\u3066launch\u3055\u305b\u307e\u3059\u3002\n\n``` bash\n$ fleetctl stop couchbase_node.1.service\nUnit couchbase_node.1.service loaded on 33bf6324.../10.3.0.7\n$ fleetctl start couchbase_node.1.service\nUnit couchbase_node.1.service launched on 33bf6324.../10.3.0.7\n$ fleetctl stop sync_gw_node@1.service\nUnit sync_gw_node@1.service loaded on 33bf6324.../10.3.0.7\n$ fleetctl start sync_gw_node@1.service\nUnit sync_gw_node@1.service launched on 33bf6324.../10.3.0.7\n$ fleetctl stop sync_gw_announce@1.service\nUnit sync_gw_announce@1.service loaded on 33bf6324.../10.3.0.7\nc$ fleetctl start sync_gw_announce@1.service\nUnit sync_gw_announce@1.service launched on 33bf6324.../10.3.0.7\n```\n\n\u3059\u3079\u3066\u306eunits\u304c\u6b63\u5e38\u306b\u52d5\u4f5c\u3057\u307e\u3057\u305f\u3002\n\n```\n$ fleetctl list-units\nUNIT\t\t\t\t\t\tMACHINE\t\t\tACTIVE\tSUB\ncouchbase_bootstrap_node.service\t\tf0f5fcc4.../10.3.0.47\tactive\trunning\ncouchbase_bootstrap_node_announce.service\tf0f5fcc4.../10.3.0.47\tactive\trunning\ncouchbase_node.1.service\t\t\t33bf6324.../10.3.0.7\tactive\trunning\ncouchbase_node.2.service\t\t\t461b77ab.../10.3.0.193\tactive\trunning\nsync_gw_announce@1.service\t\t\t33bf6324.../10.3.0.7\tactive\trunning\nsync_gw_node@1.service\t\t\t\t33bf6324.../10.3.0.7\tactive\trunning\n```\n\n## Server Nodes\u306eRebalance\n\nCouchbase\u7ba1\u7406Web\u30b3\u30f3\u30bd\u30fc\u30eb\u306b\u30ed\u30b0\u30a4\u30f3\u3057\u3066\u3001Server Nodes\u30bf\u30d6\u304b\u3089Rebalance\u30dc\u30bf\u30f3\u3092\u30af\u30ea\u30c3\u30af\u3057\u307e\u3059\u3002Couchbase\u306f\u753b\u9762\u304b\u3089\u7c21\u5358\u306b\u30af\u30e9\u30b9\u30bf\u306e\u30ce\u30fc\u30c9\u7ba1\u7406\u304c\u3067\u304d\u307e\u3059\u3002\n\n![couchbase-console-rebalance.png](https://qiita-image-store.s3.amazonaws.com/0/43745/0f881b86-55dd-a204-7875-6f6b9da6f43c.png)\n\n", "tags": ["CoreOS522.4.0", "IDCF\u30af\u30e9\u30a6\u30c9", "Couchbase3.0.1", "fleetctl0.8.3"]}