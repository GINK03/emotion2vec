{"context": " More than 1 year has passed since last update.\n\n\u524d\u63d0\n\u30c9\u30e1\u30a4\u30f3\u306fexample.com\u3001\u30e1\u30fc\u30eb\u30b5\u30fc\u30d0\u30fc\u306fmail.example.com\u3001\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u306fuser@example.com \u3068\u3059\u308b\u3002\n\u307e\u305f\u3001\u8a8d\u8a3c\u306fLinux\u306e\u30e6\u30fc\u30b6\u8a8d\u8a3c\u3068\u540c\u3058\u30e6\u30fc\u30b6\u540d/\u30d1\u30b9\u30ef\u30fc\u30c9\u3092\u5229\u7528\u3059\u308b\u3002\n\n\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306e\u6e96\u5099\n22\uff08SSH\uff09\u300125\uff08SMTP\uff09\u3001465\uff08SMTPS\uff09\u3001993\uff08IMAPS\uff09\u30dd\u30fc\u30c8\u3092\u958b\u3051\u3066\u304a\u304f\u3002\n$ sudo yum update\n\n\npostfix\n\u25aa\ufe0fpostfix\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n$ sudo yum -y install postfix\n\n\u25aa\ufe0fpostfix\u306e\u8a2d\u5b9a\n$ sudo vim /etc/postfix/main.cf\n\n\u4ee5\u4e0b\u8a2d\u5b9a\u5185\u5bb9\n# \u30e1\u30fc\u30eb\u30b5\u30fc\u30d0\u306e\u30db\u30b9\u30c8\u540d(mail.example.com)\u3092\u8a2d\u5b9a\nmyhostname = mail.example.com\n# \u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u3067\u5229\u7528\u3059\u308b\u30c9\u30e1\u30a4\u30f3(example.com)\u3092\u8a2d\u5b9a\nmydomain = example.com\n# \u30ed\u30fc\u30ab\u30eb\u304b\u3089\u914d\u4fe1\u3055\u308c\u305f\u30e1\u30fc\u30eb\u306f\u3001example.com\u306e\u30e1\u30fc\u30eb\u3067\u3042\u308b\u3068\u8a8d\u8b58\u3055\u305b\u308b\u305f\u3081\u306e\u8a2d\u5b9a\nmyorigin = $mydomain\n# \u81ea\u30c9\u30e1\u30a4\u30f3\u5b9b\u30e1\u30fc\u30eb\u3092\u53d7\u4fe1\u3067\u304d\u308b\u3088\u3046\u306b\u3059\u308b\nmydestination = $myhostname, localhost.$mydomain, localhost, $mydomain\n# \u5916\u90e8\u304b\u3089\u306e\u30e1\u30fc\u30eb\u53d7\u4fe1\u3092\u8a31\u53ef\u3059\u308b\u3088\u3046\u306b\u5909\u66f4\ninet_interfaces = all\n# VPC\u5168\u4f53\u3092\u4fe1\u983c\u3059\u308b\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u3068\u3057\u3066\u8a2d\u5b9a\nmynetworks = 192.168.0.0/24, 127.0.0.0/8\n# \u30e1\u30fc\u30eb\u306e\u4fdd\u5b58\u5f62\u5f0f\u3092\u30e1\u30fc\u30eb\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u5f62\u5f0f\u306b\u8a2d\u5b9a\u3002 \u30e1\u30fc\u30eb\u306f\u5b9b\u5148\u30e6\u30fc\u30b6\u306e\u30db\u30fc\u30e0\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\uff08user@example.cpm\u306a\u3089\u3070\u3001/home/user/\uff09\u306eMaildir\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u4fdd\u5b58\u3055\u308c\u308b\u3002\nhome_mailbox = Maildir/\n# \u30e1\u30fc\u30eb\u30b5\u30fc\u30d0\u3092\u96a0\u853d\u3059\u308b\u8a2d\u5b9a\u3092\u8ffd\u52a0\nsmtpd_banner = $myhostname ESMTP unknown\n# \u53d7\u4fe1\u30e1\u30fc\u30eb\u30b5\u30a4\u30ba\u306e\u5236\u9650\u306e\u8a2d\u5b9a\u3092\u8ffd\u52a0\nmessage_size_limit = 10485760\n# saslauthd\u3092\u5229\u7528\u3059\u308b\u305f\u3081\u306e\u8a2d\u5b9a\nsmtpd_sasl_auth_enable = yes\nbroken_sasl_auth_clients = yes\nsmtpd_sasl_security_options = noanonymous\nsmtpd_sasl_local_domain = $myhostname\nsmtpd_sender_restrictions = reject_unknown_sender_domain\nsmtpd_client_restrictions = permit_mynetworks,reject_unknown_client,permit\nsmtpd_recipient_restrictions = permit_mynetworks,permit_sasl_authenticated,reject_unauth_destination\n\n\u25aa\ufe0fsubmission\u30dd\u30fc\u30c8\u3068smpts\u30dd\u30fc\u30c8\u3092\u4f7f\u3046\u305f\u3081\u306e\u8a2d\u5b9a\n$ sudo vim /etc/postfix/master.cf\n\n\u4ee5\u4e0b\u3092\u30b3\u30e1\u30f3\u30c8\u30a4\u30f3\nsubmission inet n       -       n       -       -       smtpd\n  -o smtpd_tls_security_level=encrypt\n  -o smtpd_sasl_auth_enable=yes\n  -o smtpd_client_restrictions=permit_sasl_authenticated,reject\n  -o milter_macro_daemon_name=ORIGINATING\nsmtps     inet  n       -       n       -       -       smtpd\n  -o smtpd_tls_wrappermode=yes\n  -o smtpd_sasl_auth_enable=yes\n  -o smtpd_client_restrictions=permit_sasl_authenticated,reject\n  -o milter_macro_daemon_name=ORIGINATING\n\n\u25aa\ufe0f\u8a8d\u8a3c\u7528\u306eSMTP-Auth\u306e\u305f\u3081\u306esaslauthd\u3092\u8d77\u52d5\u3002\u307e\u305f\u3001\u81ea\u52d5\u8d77\u52d5\u306e\u8a2d\u5b9a\u3082\u884c\u3046\u3002\n$ sudo service saslauthd start\n$ sudo chkconfig saslauthd on\n\n\u25aa\ufe0f\u30c7\u30d5\u30a9\u30eb\u30c8MTA\u306e\u5909\u66f4\n$ sudo alternatives --config mta\n\n\u203b 2\u3092\u9078\u629e\n\u25aa\ufe0fsendmail\u306e\u505c\u6b62\n$ sudo /etc/rc.d/init.d/sendmail stop\n$ sudo chkconfig sendmail off\n\n\u25aa\ufe0fpostfix\u306e\u8d77\u52d5\n$ sudo service postfix start\n$ sudo chkconfig postfix on\n\n\ndovecot\n\u25aa\ufe0fdovecot\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n$ sudo yum -y install dovecot\n\n\u25aa\ufe0fdovecot\u306e\u8a2d\u5b9a\n$ sudo vim /etc/dovecot/conf.d/10-mail.conf\n\n\u4ee5\u4e0b\u8ffd\u52a0\nmail_location = maildir:~/Maildir\n\n\u25aa\ufe0f\u53d7\u4fe1\u306e\u969b\u306e\u8a8d\u8a3c\u65b9\u6cd5\u306blogin\u3092\u8ffd\u52a0\n$ sudo vim /etc/dovecot/conf.d/10-auth.conf\n\n\u4ee5\u4e0b\u8ffd\u52a0\nauth_mechanisms = plain login\n\n\u25aa\ufe0f\u30dd\u30fc\u30c8\u306e\u8a2d\u5b9a\n$ sudo vim /etc/dovecot/conf.d/10-master.conf\n\n\u4ee5\u4e0b\u30b3\u30e1\u30f3\u30c8\u30a4\u30f3\u3001\u8ffd\u8a18\nservice imap-login {\n  inet_listener imap {\n    port = 143\n  }\n  inet_listener imaps {\n    port = 993\n    ssl = yes\n  }\n}\n\nservice pop3-login {\n  inet_listener pop3 {\n    port = 110\n  }\n  inet_listener pop3s {\n    port = 995\n    ssl = yes\n  }\n}\n\nservice auth {\n  # Postfix smtp-auth\n  unix_listener /var/spool/postfix/private/auth {\n    mode = 0666\n    user = postfix\n    group = postfix\n  }\n}\n\n\n\u305d\u306e\u4ed6\u306e\u8a2d\u5b9a\n\u25aa\ufe0f\u65b0\u898f\u30e6\u30fc\u30b6\u8ffd\u52a0\u6642\u306b\u3001\u30db\u30fc\u30e0\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306bMaildir\u5f62\u5f0f\u306e\u30e1\u30fc\u30eb\u30dc\u30c3\u30af\u30b9\u3092\u4f5c\u6210\u3059\u308b\u3088\u3046\u306b\u3059\u308b\u3002\n$ sudo mkdir -p /etc/skel/Maildir/{new,cur,tmp}\n$ sudo chmod -R 700 /etc/skel/Maildir/\n\n\u25aa\ufe0f\u30e6\u30fc\u30b6\u30fc\u306e\u4f5c\u6210\n$ sudo useradd user\n$ sudo passwd user\n\n\u25aa\ufe0f\u8a3c\u660e\u66f8\u3092\u6307\u5b9a\n$ sudo vim /etc/postfix/main.cf\n\nTLS \u3092\u5229\u7528\u3059\u308b\u305f\u3081\u306e\u8a2d\u5b9a\u3001\u8a3c\u660e\u66f8\u3092\u6307\u5b9a\u3059\u308b\n\nsmtpd_tls_cert_file = /etc/pki/tls/certs/server.crt\nsmtpd_tls_key_file = /etc/pki/tls/certs/server.key\nsmtpd_use_tls = yes\n\n\u25aa\ufe0fSSL\u3092\u4f7f\u3048\u308b\u3088\u3046\u306b\u3059\u308b\n$ sudo vim /etc/dovecot/conf.d/10-ssl.conf\n\n# (\u5909\u66f4)\n# SSL\u8a3c\u660e\u66f8\nssl_cert = </etc/pki/tls/certs/server.crt\nssl_key = </etc/pki/tls/certs/server.key\n# (\u8ffd\u8a18)\nssl = yes\nssl_key_password = \"\u524d\u8ff0\u306e\u8a3c\u660e\u66f8\u4f5c\u6210\u6642\u306e\u30d1\u30b9\u30d5\u30ec\u30fc\u30ba\"\n\n\u25aa\ufe0fdovecot\u306e\u8d77\u52d5\n$ sudo service dovecot start\n$ sudo chkconfig dovecot on\n\n\u25aa\ufe0fpostfix\u306e\u518d\u8d77\u52d5\n$ sudo service postfix restart\n\n\u304a\u308f\u308a\u3067\u3059\u3002\n\u3046\u307e\u304f\u3044\u304b\u306a\u3044\u5834\u5408\u306f/var/log/maillog\u3092\u78ba\u8a8d\u3057\u3066\u307f\u3066\u304f\u3060\u3055\u3044\u3002\nThunderbird\u306a\u3069\u3068\u9023\u643a\u3067\u304d\u307e\u3059\u3002\n# \u524d\u63d0\n\u30c9\u30e1\u30a4\u30f3\u306fexample.com\u3001\u30e1\u30fc\u30eb\u30b5\u30fc\u30d0\u30fc\u306fmail.example.com\u3001\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u306fuser@example.com \u3068\u3059\u308b\u3002\n\u307e\u305f\u3001\u8a8d\u8a3c\u306fLinux\u306e\u30e6\u30fc\u30b6\u8a8d\u8a3c\u3068\u540c\u3058\u30e6\u30fc\u30b6\u540d/\u30d1\u30b9\u30ef\u30fc\u30c9\u3092\u5229\u7528\u3059\u308b\u3002\n\n# \u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306e\u6e96\u5099\n22\uff08SSH\uff09\u300125\uff08SMTP\uff09\u3001465\uff08SMTPS\uff09\u3001993\uff08IMAPS\uff09\u30dd\u30fc\u30c8\u3092\u958b\u3051\u3066\u304a\u304f\u3002\n\n```bash\n$ sudo yum update\n```\n# postfix\n\u25aa\ufe0fpostfix\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n```bash\n$ sudo yum -y install postfix\n```\n\n\u25aa\ufe0fpostfix\u306e\u8a2d\u5b9a\n\n```bah\n$ sudo vim /etc/postfix/main.cf\n```\n\u4ee5\u4e0b\u8a2d\u5b9a\u5185\u5bb9\n\n```\n# \u30e1\u30fc\u30eb\u30b5\u30fc\u30d0\u306e\u30db\u30b9\u30c8\u540d(mail.example.com)\u3092\u8a2d\u5b9a\nmyhostname = mail.example.com\n# \u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u3067\u5229\u7528\u3059\u308b\u30c9\u30e1\u30a4\u30f3(example.com)\u3092\u8a2d\u5b9a\nmydomain = example.com\n# \u30ed\u30fc\u30ab\u30eb\u304b\u3089\u914d\u4fe1\u3055\u308c\u305f\u30e1\u30fc\u30eb\u306f\u3001example.com\u306e\u30e1\u30fc\u30eb\u3067\u3042\u308b\u3068\u8a8d\u8b58\u3055\u305b\u308b\u305f\u3081\u306e\u8a2d\u5b9a\nmyorigin = $mydomain\n# \u81ea\u30c9\u30e1\u30a4\u30f3\u5b9b\u30e1\u30fc\u30eb\u3092\u53d7\u4fe1\u3067\u304d\u308b\u3088\u3046\u306b\u3059\u308b\nmydestination = $myhostname, localhost.$mydomain, localhost, $mydomain\n# \u5916\u90e8\u304b\u3089\u306e\u30e1\u30fc\u30eb\u53d7\u4fe1\u3092\u8a31\u53ef\u3059\u308b\u3088\u3046\u306b\u5909\u66f4\ninet_interfaces = all\n# VPC\u5168\u4f53\u3092\u4fe1\u983c\u3059\u308b\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u3068\u3057\u3066\u8a2d\u5b9a\nmynetworks = 192.168.0.0/24, 127.0.0.0/8\n# \u30e1\u30fc\u30eb\u306e\u4fdd\u5b58\u5f62\u5f0f\u3092\u30e1\u30fc\u30eb\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u5f62\u5f0f\u306b\u8a2d\u5b9a\u3002 \u30e1\u30fc\u30eb\u306f\u5b9b\u5148\u30e6\u30fc\u30b6\u306e\u30db\u30fc\u30e0\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\uff08user@example.cpm\u306a\u3089\u3070\u3001/home/user/\uff09\u306eMaildir\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u4fdd\u5b58\u3055\u308c\u308b\u3002\nhome_mailbox = Maildir/\n# \u30e1\u30fc\u30eb\u30b5\u30fc\u30d0\u3092\u96a0\u853d\u3059\u308b\u8a2d\u5b9a\u3092\u8ffd\u52a0\nsmtpd_banner = $myhostname ESMTP unknown\n# \u53d7\u4fe1\u30e1\u30fc\u30eb\u30b5\u30a4\u30ba\u306e\u5236\u9650\u306e\u8a2d\u5b9a\u3092\u8ffd\u52a0\nmessage_size_limit = 10485760\n# saslauthd\u3092\u5229\u7528\u3059\u308b\u305f\u3081\u306e\u8a2d\u5b9a\nsmtpd_sasl_auth_enable = yes\nbroken_sasl_auth_clients = yes\nsmtpd_sasl_security_options = noanonymous\nsmtpd_sasl_local_domain = $myhostname\nsmtpd_sender_restrictions = reject_unknown_sender_domain\nsmtpd_client_restrictions = permit_mynetworks,reject_unknown_client,permit\nsmtpd_recipient_restrictions = permit_mynetworks,permit_sasl_authenticated,reject_unauth_destination\n```\n\n\n\u25aa\ufe0fsubmission\u30dd\u30fc\u30c8\u3068smpts\u30dd\u30fc\u30c8\u3092\u4f7f\u3046\u305f\u3081\u306e\u8a2d\u5b9a\n\n```bash\n$ sudo vim /etc/postfix/master.cf\n```\n\u4ee5\u4e0b\u3092\u30b3\u30e1\u30f3\u30c8\u30a4\u30f3\n\n```\nsubmission inet n       -       n       -       -       smtpd\n  -o smtpd_tls_security_level=encrypt\n  -o smtpd_sasl_auth_enable=yes\n  -o smtpd_client_restrictions=permit_sasl_authenticated,reject\n  -o milter_macro_daemon_name=ORIGINATING\nsmtps     inet  n       -       n       -       -       smtpd\n  -o smtpd_tls_wrappermode=yes\n  -o smtpd_sasl_auth_enable=yes\n  -o smtpd_client_restrictions=permit_sasl_authenticated,reject\n  -o milter_macro_daemon_name=ORIGINATING\n```\n\n\u25aa\ufe0f\u8a8d\u8a3c\u7528\u306eSMTP-Auth\u306e\u305f\u3081\u306esaslauthd\u3092\u8d77\u52d5\u3002\u307e\u305f\u3001\u81ea\u52d5\u8d77\u52d5\u306e\u8a2d\u5b9a\u3082\u884c\u3046\u3002\n\n```bash\n$ sudo service saslauthd start\n$ sudo chkconfig saslauthd on\n```\n\n\u25aa\ufe0f\u30c7\u30d5\u30a9\u30eb\u30c8MTA\u306e\u5909\u66f4\n\n```bash\n$ sudo alternatives --config mta\n```\n\u203b 2\u3092\u9078\u629e\n\n\n\u25aa\ufe0fsendmail\u306e\u505c\u6b62\n\n```bash\n$ sudo /etc/rc.d/init.d/sendmail stop\n$ sudo chkconfig sendmail off\n```\n\n\u25aa\ufe0fpostfix\u306e\u8d77\u52d5\n\n```bash\n$ sudo service postfix start\n$ sudo chkconfig postfix on\n```\n\n# dovecot\n\u25aa\ufe0fdovecot\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n```bash\n$ sudo yum -y install dovecot\n```\n\u25aa\ufe0fdovecot\u306e\u8a2d\u5b9a\n\n```bash\n$ sudo vim /etc/dovecot/conf.d/10-mail.conf\n```\n\u4ee5\u4e0b\u8ffd\u52a0\n\n```\nmail_location = maildir:~/Maildir\n```\n\n\u25aa\ufe0f\u53d7\u4fe1\u306e\u969b\u306e\u8a8d\u8a3c\u65b9\u6cd5\u306blogin\u3092\u8ffd\u52a0\n\n```bash\n$ sudo vim /etc/dovecot/conf.d/10-auth.conf\n```\n\u4ee5\u4e0b\u8ffd\u52a0\n\n```\nauth_mechanisms = plain login\n```\n\n\u25aa\ufe0f\u30dd\u30fc\u30c8\u306e\u8a2d\u5b9a\n\n```bash\n$ sudo vim /etc/dovecot/conf.d/10-master.conf\n```\n\u4ee5\u4e0b\u30b3\u30e1\u30f3\u30c8\u30a4\u30f3\u3001\u8ffd\u8a18\n\n```\nservice imap-login {\n  inet_listener imap {\n    port = 143\n  }\n  inet_listener imaps {\n    port = 993\n    ssl = yes\n  }\n}\n\nservice pop3-login {\n  inet_listener pop3 {\n    port = 110\n  }\n  inet_listener pop3s {\n    port = 995\n    ssl = yes\n  }\n}\n\nservice auth {\n  # Postfix smtp-auth\n  unix_listener /var/spool/postfix/private/auth {\n    mode = 0666\n    user = postfix\n    group = postfix\n  }\n}\n```\n\n# \u305d\u306e\u4ed6\u306e\u8a2d\u5b9a\n\u25aa\ufe0f\u65b0\u898f\u30e6\u30fc\u30b6\u8ffd\u52a0\u6642\u306b\u3001\u30db\u30fc\u30e0\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306bMaildir\u5f62\u5f0f\u306e\u30e1\u30fc\u30eb\u30dc\u30c3\u30af\u30b9\u3092\u4f5c\u6210\u3059\u308b\u3088\u3046\u306b\u3059\u308b\u3002\n\n```bash\n$ sudo mkdir -p /etc/skel/Maildir/{new,cur,tmp}\n$ sudo chmod -R 700 /etc/skel/Maildir/\n```\n\u25aa\ufe0f\u30e6\u30fc\u30b6\u30fc\u306e\u4f5c\u6210\n\n```bash\n$ sudo useradd user\n$ sudo passwd user\n```\n\u25aa\ufe0f\u8a3c\u660e\u66f8\u3092\u6307\u5b9a\n\n```bash\n$ sudo vim /etc/postfix/main.cf\n```\nTLS \u3092\u5229\u7528\u3059\u308b\u305f\u3081\u306e\u8a2d\u5b9a\u3001\u8a3c\u660e\u66f8\u3092\u6307\u5b9a\u3059\u308b\n```\nsmtpd_tls_cert_file = /etc/pki/tls/certs/server.crt\nsmtpd_tls_key_file = /etc/pki/tls/certs/server.key\nsmtpd_use_tls = yes\n```\n\u25aa\ufe0fSSL\u3092\u4f7f\u3048\u308b\u3088\u3046\u306b\u3059\u308b\n\n```bash\n$ sudo vim /etc/dovecot/conf.d/10-ssl.conf\n```\n```\n# (\u5909\u66f4)\n# SSL\u8a3c\u660e\u66f8\nssl_cert = </etc/pki/tls/certs/server.crt\nssl_key = </etc/pki/tls/certs/server.key\n# (\u8ffd\u8a18)\nssl = yes\nssl_key_password = \"\u524d\u8ff0\u306e\u8a3c\u660e\u66f8\u4f5c\u6210\u6642\u306e\u30d1\u30b9\u30d5\u30ec\u30fc\u30ba\"\n```\n\n\u25aa\ufe0fdovecot\u306e\u8d77\u52d5\n\n```bash\n$ sudo service dovecot start\n$ sudo chkconfig dovecot on\n```\n\u25aa\ufe0fpostfix\u306e\u518d\u8d77\u52d5\n\n```bash\n$ sudo service postfix restart\n```\n\u304a\u308f\u308a\u3067\u3059\u3002\n\u3046\u307e\u304f\u3044\u304b\u306a\u3044\u5834\u5408\u306f/var/log/maillog\u3092\u78ba\u8a8d\u3057\u3066\u307f\u3066\u304f\u3060\u3055\u3044\u3002\n\nThunderbird\u306a\u3069\u3068\u9023\u643a\u3067\u304d\u307e\u3059\u3002\n", "tags": ["EC2", "postfix", "dovecot"]}