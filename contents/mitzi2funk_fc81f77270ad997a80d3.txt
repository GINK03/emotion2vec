{"context": " More than 1 year has passed since last update.\n\n\u306f\u3058\u3081\u306b\n\n\u25a0\u76ee\u7684\nImageMagick \u3068 PHP\u3002\n\u305d\u3057\u3066PHP\u304b\u3089ImageMagick\u3092\u5229\u7528\u3059\u308b\u305f\u3081\u306ePHP \u62e1\u5f35\u30e2\u30b8\u30e5\u30fc\u30ebImagick\u3002\n\u3053\u308c\u3089\u3092\u5229\u7528\u3059\u308b\u3053\u3068\u3067PHP\u30b9\u30af\u30ea\u30d7\u30c8\u304b\u3089\u753b\u50cf\u5909\u63db\u304c\u51fa\u6765\u307e\u3059\u3002\n\u3057\u304b\u3057\u3001\u3053\u308c\u3060\u3051\u3067\u306fPDF\u304b\u3089\u753b\u50cf\u5909\u63db\u304c\u51fa\u6765\u307e\u305b\u3093\u3002\n\u305d\u3053\u3067Ghostscript\u3092\u5c0e\u5165\u3057PDF\u306e\u753b\u50cf\u5909\u63db\u3092\u884c\u3063\u3066\u307f\u307e\u3057\u305f\u3002\n\n\u25a0Ghostscript\u3068\u306f\nPostScript/PDF \u30a4\u30f3\u30bf\u30d7\u30ea\u30bf\u3002\n\u3088\u304f\u5206\u304b\u308a\u307e\u305b\u3093\u304c\u3001\u30a2\u30c9\u30d3\u30b7\u30b9\u30c6\u30e0\u30ba\u306ePostScript\u30d5\u30a1\u30a4\u30eb\u3092\u753b\u50cf\u30d5\u30a1\u30a4\u30eb\u306b\u5909\u63db\u3059\u308b\u3053\u3068\u304c\u51fa\u6765\u308b\u3082\u306e\u306e\u3088\u3046\u3067\u3059\u3002\n\u3053\u3061\u3089\u3092\u5c0e\u5165\u3059\u308b\u3053\u3068\u3067ImageMagick+PHP\u3067PDF\u3088\u308a\u753b\u50cf\u5909\u63db\u304c\u53ef\u80fd\u3068\u306a\u308b\u3068\u306e\u3053\u3068\u3002\n\u25a0\u516c\u5f0f\u30b5\u30a4\u30c8\nhttp://www.ghostscript.com/\n\n\u25a0\u4eca\u56de\u306e\u5b9f\u88c5\u74b0\u5883\nCentOS 6.5 (64bit)\nphp 5.4.33\nhttpd 2.2.15\nImageMagick 6.5.4.7\nimagick 3.1.2\n\n00. \u4e8b\u524d\u6e96\u5099\n\u25bd\u30b3\u30f3\u30d1\u30a4\u30eb\u306b\u5fc5\u8981\u306a\u30d1\u30c3\u30b1\u30fc\u30b8\u306e\u5c0e\u5165\u72b6\u6cc1\u78ba\u8a8d\n# rpm -qa | grep \"make\\|gcc\"\nlibgcc-4.4.7-4.el6.x86_64\ngcc-c++-4.4.7-4.el6.x86_64\nmake-3.81-20.el6.x86_64\ngcc-4.4.7-4.el6.x86_64\n\n\u7121\u3051\u308c\u3070\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n# yum install make gcc\n\n\u3082\u3057\u304f\u306f\u3001\u958b\u767a\u30c4\u30fc\u30eb\u4e00\u62ec\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n# yum groupinstall 'Development tools'\n\n\u25bdGhostScript\u5c0e\u5165\u306b\u5fc5\u8981\u306a\u30d1\u30c3\u30b1\u30fc\u30b8\u304c\u5165\u3063\u3066\u3044\u308b\u304b\u78ba\u8a8d\n# rpm -qa | grep \"libXt-devel\"\nlibXt-1.1.4-6.1.el6.x86_64\n\n\n01.\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\u25a0\u30bd\u30fc\u30b9\u914d\u5e03\u5143\n\u516c\u5f0f\u30b5\u30a4\u30c8\u3088\u308a\u3001Ghostscript 9.15 Source for all platforms \u306e \u30ea\u30f3\u30af\u3092\u53d6\u5f97 (2015/01/01\u6642\u70b9\u306e\u6700\u65b0\u7248)\nhttp://downloads.ghostscript.com/public/ghostscript-9.15.tar.gz\n# cd /usr/local/src/\n# curl -OL http://downloads.ghostscript.com/public/ghostscript-9.15.tar.gz\n# tar -zxvf ghostscript-9.15.tar.gz\n# cd ghostscript-9.15\n# ./configure --disable-compile-inits --with-x --with-drivers=ALL --without-luratech --with-libiconv=gnu --prefix=/usr/local\n\u203b\u30aa\u30d7\u30b7\u30e7\u30f3\u300c--disable-compile-inits\u300d\u3092\u6307\u5b9a\u3057\u306a\u3044\u3068\u3001\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u5f8c\u306e\u8a2d\u5b9a\u5909\u66f4\u304c\u3067\u304d\u306a\u304f\u306a\u308b\u3068\u306e\u3053\u3068\n\n(\u7701\u7565)\n\nLibtiff is now configured for x86_64-unknown-linux-gnu\n\n  Installation directory:             /usr/local\n  Documentation directory:            ${prefix}/share/doc/tiff-4.0.1\n  C compiler:                         gcc -g -O2 -Wall -W\n  C++ compiler:                       g++ -g -O2\n  Enable runtime linker paths:        no\n  Enable linker symbol versioning:    no\n  Support Microsoft Document Imaging: yes\n  Use win32 IO:                       no\n\n Support for internal codecs:\n  CCITT Group 3 & 4 algorithms:       yes\n  Macintosh PackBits algorithm:       yes\n  LZW algorithm:                      yes\n  ThunderScan 4-bit RLE algorithm:    yes\n  NeXT 2-bit RLE algorithm:           yes\n  LogLuv high dynamic range encoding: yes\n\n Support for external codecs:\n  ZLIB support:                       yes\n  Pixar log-format algorithm:         yes\n  JPEG support:                       yes\n  Old JPEG support:                   yes\n  JPEG 8/12 bit dual mode:            no\n  ISO JBIG support:                   no\n  LZMA2 support:                      no\n\n  C++ support:                        yes\n\n  OpenGL support:                     no\n\n(\u7701\u7565)\n\nconfigure: WARNING: Unable to include opvp/oprp driver due to missing or disabled prerequisites...\nconfigure: WARNING: Unable to include opvp/oprp driver due to missing iconv/libiconv...\n\n\u203b\u4e0a\u8a18\u3001configure\u4e2d\u306b\u6c17\u306b\u306a\u3063\u305f\u30e1\u30c3\u30bb\u30fc\u30b8\u629c\u7c8b \u2192 \u3053\u306e\u5f8c\u3001\u554f\u984c\u3068\u306a\u308b\u3053\u3068\u306f\u3042\u308a\u307e\u305b\u3093\u3067\u3057\u305f\u3002\n\n# make\n# make install\n\n\u3053\u308c\u3067\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u5b8c\u4e86\u3067\u3059\u3002\n\n02.\u8a2d\u5b9a\n\n\u25a002-1a. \u65e5\u672c\u8a9e\u3092\u6271\u3048\u308b\u3088\u3046\u306b\u3059\u308b(IPA\u30d5\u30a9\u30f3\u30c8\u3001IPAex\u30d5\u30a9\u30f3\u30c8 \u30a4\u30f3\u30b9\u30c8\u30fc\u30eb)\n\u25a0IPA\u72ec\u7acb\u884c\u653f\u6cd5\u4eba (\u914d\u5e03\u5143)\nhttp://ipafont.ipa.go.jp/ipafont/download.html\n# cd /usr/local/src\n# mkdir font\n# cd font\n# wget 'http://dl.ipafont.ipa.go.jp/IPAexfont/IPAexfont00201.zip'\n# wget 'http://dl.ipafont.ipa.go.jp/IPAfont/IPAfont00303.zip'\n# unzip IPAfont00303.zip\n  inflating: IPAfont00303/ipag.ttf\n  inflating: IPAfont00303/ipagp.ttf\n  inflating: IPAfont00303/ipam.ttf\n  inflating: IPAfont00303/ipamp.ttf\n\n# unzip IPAexfont00201.zip\n  inflating: IPAexfont00201/ipaexg.ttf\n  inflating: IPAexfont00201/ipaexm.ttf\n\n# mkdir -p /usr/share/fonts/ipa/TrueType/\n# cp -p ./IPAexfont00201/*.ttf /usr/share/fonts/ipa/TrueType/.\n# cp -p ./IPAfont00303/*.ttf /usr/share/fonts/ipa/TrueType/.\n# ls -l /usr/share/fonts/ipa/TrueType/\nipaexg.ttf\nipaexm.ttf\nipag.ttf\nipagp.ttf\nipam.ttf\nipamp.ttf\n\n\u30fb\u30d5\u30a9\u30f3\u30c8\u30ad\u30e3\u30b7\u30e5\u30af\u30ea\u30a2\n# fc-cache -fv\n\n\u30fb\u30d5\u30a9\u30f3\u30c8\u4e00\u89a7\u3067\u540d\u79f0\u3092\u78ba\u8a8d\n# fc-list | grep -i ipa\nIPAex\u30b4\u30b7\u30c3\u30af,IPAexGothic:style=Regular,Regulare\nIPA\u30b4\u30b7\u30c3\u30af,IPAGothic:style=Regular\nIPA P\u30b4\u30b7\u30c3\u30af,IPAPGothic:style=Regular\nIPAex\u660e\u671d,IPAexMincho:style=Regular\nIPA\u660e\u671d,IPAMincho:style=Regular\nIPA P\u660e\u671d,IPAPMincho:style=Regular\n\n\n\u25a002-1b. msttcorefonts\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\u25bd\u914d\u5e03\u5143(\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u65b9\u6cd5\u3082\u8a18\u8f09\u30a2\u30ea)\nAn easy way to install Microsoft's TrueType core fonts on linux\nhttp://corefonts.sourceforge.net/\n1) \u5fc5\u8981\u306a\u30d1\u30c3\u30b1\u30fc\u30b8\n\u30fbrpm-build\n\u30fbttmkfdir\n\u30fbcabextract (http://www.cabextract.org.uk )\n# yum install rpm-build ttmkfdir\n\n# cd /usr/local/src/\n# wget http://www.cabextract.org.uk/cabextract-1.4-1.src.rpm\n# rpmbuild --rebuild cabextract-1.4-1.src.rpm\n# rpm -ivh /root/rpmbuild/RPMS/x86_64/cabextract-1.4-1.x86_64.rpm\n\u203bbuild\u3057\u305frpm\u30d5\u30a1\u30a4\u30eb\u306f\u3001\u300c$HOME/rpmbuild/RPMS/x86_64/\u300d\u914d\u4e0b\u306b\u683c\u7d0d\u3055\u308c\u308b\n\n2) spec\u30d5\u30a1\u30a4\u30eb\u3088\u308a msttcorefonts \u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n# cd /usr/local/src/\n# wget http://corefonts.sourceforge.net/msttcorefonts-2.5-1.spec\n# rpmbuild -bb msttcorefonts-2.5-1.spec\n# rpm -ivh /root/rpmbuild/RPMS/noarch/msttcorefonts-2.5-1.noarch.rpm\n\u203bbuild\u3057\u305frpm\u30d5\u30a1\u30a4\u30eb\u306f\u3001\u300c$HOME/rpmbuild/RPMS/noarch/\u300d\u914d\u4e0b\u306b\u683c\u7d0d\u3055\u308c\u308b\n\n\u30fb\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u5148\u306f\u4ee5\u4e0b\n/usr/share/fonts/msttcorefonts/*.ttf\n\n\n\u25a002-2. cidfmap\n\u30fbCID\u30d5\u30a9\u30f3\u30c8\u3068\u5b9f\u969b\u306eTrueType\uff08OpenType\uff09\u30d5\u30a9\u30f3\u30c8\u3068\u306e\u5bfe\u5fdc\u3092\u6307\u5b9a\u3059\u308b\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3002\n\u6700\u4e0b\u884c\u306b\u4f7f\u7528\u3059\u308b\u30d5\u30a9\u30f3\u30c8\u3001\u30d5\u30a9\u30f3\u30c8\u3078\u306e\u30d1\u30b9\u3092\u8ffd\u8a18\u3002\n# cd /usr/local/share/ghostscript/9.15/Resource/Init\n# cp -p cidfmap cidfmap.org\n\n# vi cidfmap\n----------\n/Ryumin-Light         /IPAEXMincho      ;\n/GothicBBB-Medium     /IPAGothic        ;\n/HeiseiMin-W3         /Ryumin-Light     ;\n/HeiseiKakuGo-W5      /GothicBBB-Medium ;\n\n%%% Alias for dvips\n/ipamincho    /IPAMincho ;\n/ipapmincho   /IPAPMincho ;\n/ipagothic    /IPAGothic ;\n/ipapgothic   /IPAPGothic ;\n/ipam         /IPAMincho ;\n/ipamp        /IPAPMincho ;\n/ipag         /IPAGothic ;\n/ipagp        /IPAPGothic ;\n/ipaexm       /IPAEXMincho ;\n/ipaexg       /IPAEXGothic ;\n\n/IPAMincho\n<<\n/FileType /TrueType\n/CSI [(Japan1) 6]\n/Path (/usr/share/fonts/ipa/TrueType/ipam.ttf)\n/SubfontID 0\n>> ;\n\n/IPAPMincho\n<<\n/FileType /TrueType\n/CSI [(Japan1) 6]\n/Path (/usr/share/fonts/ipa/TrueType/ipamp.ttf)\n/SubfontID 0\n>> ;\n\n/IPAGothic\n<<\n/FileType /TrueType\n/CSI [(Japan1) 6]\n/Path (/usr/share/fonts/ipa/TrueType/ipag.ttf)\n/SubfontID 0\n>> ;\n\n/IPAPGothic\n<<\n/FileType /TrueType\n/CSI [(Japan1) 6]\n/Path (/usr/share/fonts/ipa/TrueType/ipagp.ttf)\n/SubfontID 0\n>> ;\n\n/IPAEXMincho\n<<\n/FileType /TrueType\n/CSI [(Japan1) 6]\n/Path (/usr/share/fonts/ipa/TrueType/ipaexm.ttf)\n/SubfontID 0\n>> ;\n\n/IPAEXGothic\n<<\n/FileType /TrueType\n/CSI [(Japan1) 6]\n/Path (/usr/share/fonts/ipa/TrueType/ipaexg.ttf)\n/SubfontID 0\n>> ;\n\n/Arial\n<<\n/FileType /TrueType\n/CSI [(Artifex) (Unicode) 0]\n/Path (/usr/share/fonts/msttcorefonts/arial.ttf)\n/SubfontID 0\n>> ;\n\n\n\u25a002-3. gs_res.ps\n\u30fbGhostscript\u304c\u53c2\u7167\u3059\u308b\u69d8\u3005\u306a\u30ea\u30bd\u30fc\u30b9\uff08\u30d5\u30a1\u30a4\u30eb\u7b49\uff09\u306e\u5834\u6240\u3092\u6307\u5b9a\u3059\u308b\u30d5\u30a1\u30a4\u30eb\u3002\n\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u305f\u74b0\u5883\u306b\u5408\u308f\u305b\u3066\u9069\u5207\u306b\u4fee\u6b63\u3059\u308b\u3002\u5177\u4f53\u7684\u306b\u306f\u3001319\u884c\u76ee\u306e/FontResourceDir\u3068321\u884c\u76ee\u306e/GenericResourceDir\u3092\u7de8\u96c6\u3059\u308b\n# cd /usr/local/share/ghostscript/9.15/Resource/Init\n# cp -p gs_res.ps gs_res.ps.org\n# vi gs_res.ps\n------\n%   /FontResourceDir (Font) .resource_dir_name\n   /FontResourceDir (/usr/local/share/ghostscript/9.15/Resource/Font/) .resource_dir_name\n\n%  /GenericResourceDir () .resource_dir_name\n  /GenericResourceDir (/usr/local/share/ghostscript/9.15/Resource) .resource_dir_name\n\n\n03.\u52d5\u4f5c\u78ba\u8a8d\n\u25a0\u53c2\u8003\u30b5\u30a4\u30c8\n[\u516c\u5f0f] How to use Ghostscript\nhttp://www.ghostscript.com/doc/current/Use.htm\n\u25a0\u5b9f\u884c\u30d5\u30a1\u30a4\u30eb\u306e\u5834\u6240\n# which gs\n/usr/local/bin/gs\n\n\u25a0\u30b3\u30de\u30f3\u30c9\u306e\u57fa\u672c\u66f8\u5f0f\n# gs [\u30aa\u30d7\u30b7\u30e7\u30f3] [\u5165\u529b\u30d5\u30a1\u30a4\u30eb]\n\n\n\u25a003-1. PDF\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u6210\u3059\u308b\n\u30fb\u30b5\u30f3\u30d7\u30eb\u753b\u50cf(tiger.eps)\u3092\u5229\u7528\u3057\u3066PDF\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u6210\u3059\u308b\n# cd /usr/local/share/ghostscript/9.15/examples\n# gs -sDEVICE=pdfwrite -sOutputFile=tiger.pdf tiger.eps\n>>showpage, press <return> to continue<<\u3000\u2190\u30a8\u30f3\u30bf\u30fc\u62bc\u4e0b\nGS>\nGS>quit\n\n# ls -l tiger.pdf\ntiger.pdf\n\n\u25bd\u30aa\u30d7\u30b7\u30e7\u30f3\u306e\u8aac\u660e\n\u30d8\u30eb\u30d7\u306e\u5185\u5bb9\u3092\u8a18\u8f09\u3057\u305f\u3060\u3051\u3067\u3059\n-sDEVICE=[\u51fa\u529b\u30c7\u30d0\u30a4\u30b9] \u203bDEVICE\u3068\u306a\u3063\u3066\u3044\u308b\u304c\u3001\u4eca\u56de\u306fPNG\u3084JPEG\u306a\u3069\u306e\u753b\u50cf\u5f62\u5f0f\u3092\u6307\u5b9a\n-sOutputFile=[\u51fa\u529b\u30d5\u30a1\u30a4\u30eb\u540d]\n-dBATCH \u203b\u30d7\u30ed\u30f3\u30d7\u30c8\u3092\u81ea\u52d5\u7684\u306b\u629c\u3051\u51e6\u7406\u3092\u5b9f\u884c\u3057\u3066\u304f\u308c\u308b\n-r[\u89e3\u50cf\u5ea6] \u203b\u30c7\u30d5\u30a9\u30eb\u30c8\u306f72dpi\n-g<width>x<height> \u203bpage size in pixels\n\n\n04. ImageMagick & Imagick \u3068\u306e\u9023\u643a\n\n\u25a004-1. \u5b9f\u88c5\n\u25a0\u53c2\u8003URL\n[\u516c\u5f0f] \u753b\u50cf\u51e6\u7406 (ImageMagick)\nhttp://php.net/manual/ja/book.imagick.php\n\u25a0\u307e\u305ayum\u3067\u300cImageMagick\u300d\u300cImageMagick-devel\u300d\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n# yum install ImageMagick ImageMagick-devel\n\n\u25a0pecl\u3092\u4f7f\u3048\u308b\u3088\u3046\u306b\u3059\u308b\n# yum install php-pear php-devel httpd-devel\n\n\u25a0PECL\u3067\u300cimagick\u300d\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n# pecl install imagick\nPlease provide the prefix of Imagemagick installation [autodetect] :\u3000\u305d\u306e\u307e\u307e\u30a8\u30f3\u30bf\u30fc\u3067\u81ea\u52d5\u7684\u306bImageMagick\u3092\u63a2\u3057\u3066\u3082\u3089\u3046\n\n\u25a0php.ini\u306e\u8a2d\u5b9a\n\u30fbimagick\u3092\u6709\u52b9\u306b\u3059\u308b\n# cp -p /etc/php.ini /etc/php.ini.org\n# vi /etc/php.ini\n------\nextension=imagick.so\u3000\u3053\u3061\u3089\u3092\u8ffd\u8a18\n\n\u25a0PHP\u30e2\u30b8\u30e5\u30fc\u30eb\u3068\u3057\u3066\u8ffd\u52a0\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\n# php -m | grep imagick\nimagick\n\n\n\u25a004-2. \u52d5\u4f5c\u78ba\u8a8d\n\u25a0\u307e\u305a\u30b3\u30de\u30f3\u30c9\u30e9\u30a4\u30f3\u3088\u308a\n\u30fbTiger.pdf\u3092PNG\u30d5\u30a1\u30a4\u30eb\u306b\u5909\u63db\u3059\u308b\u3002\n# cd /usr/local/share/ghostscript/9.15/examples\n# convert tiger.pdf tiger.png\n# ls tiger.png\ntiger.png\n\n\ntiger.png\n\u30fb\u8907\u6570\u30da\u30fc\u30b8\u3042\u308bannots.pdf\u3092PNG\u30d5\u30a1\u30a4\u30eb\u306b\u5909\u63db\u3059\u308b\n# convert annots.pdf annots.png\n# ls annots*.png\nannots-0.png  annots-1.png  annots-2.png  annots-3.png  annots-4.png  annots-5.png\n\u203b\u30da\u30fc\u30b8\u6bce\u306b\u753b\u50cf\u30d5\u30a1\u30a4\u30eb\u3078\u5909\u63db\u3055\u308c\u308b\n\n\nannots-1.png\n\u25a0\u30b9\u30af\u30ea\u30d7\u30c8\u3088\u308a\u5b9f\u884c\n\u30fbapache\u3067\u66f8\u304d\u8fbc\u307f\u304c\u51fa\u6765\u308b\u3088\u3046\u6a29\u9650\u4ed8\u4e0e\u3057\u3066\u304a\u304f\n# cd /var/www/html\n# mkdir /var/www/html/pdf\n# chown root.apache /var/www/html/pdf\n# chmod 775 /var/www/html/pdf\n\n\u30fbPDF\u30d5\u30a1\u30a4\u30eb\u306e\u5168\u30da\u30fc\u30b8\u3092\u753b\u50cf\u306b\u5909\u63db\u3059\u308b\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u7528\u610f\n# vi /var/www/html/pdf/Imagick-Ghostscript.php\n\n<?php\n\n//ImageMagic\u5b9a\u7fa9\n$im = new imagick();\n//$im->setResolution(144,144);\n\n//\u5bfe\u8c61\u306e\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092\u6307\u5b9a(\u30ab\u30ec\u30f3\u30c8\u30c7\u30a3\u30ec\u30af\u30c8\u30ea);\n$serch_dir = dirname(__FILE__);\n\n$files = new RecursiveIteratorIterator(\n            new RecursiveDirectoryIterator($serch_dir,\n                    FilesystemIterator::CURRENT_AS_FILEINFO |\n                    FilesystemIterator::KEY_AS_PATHNAME |\n                    FilesystemIterator::SKIP_DOTS\n            )\n        );\n\n// \u62e1\u5f35\u5b50\u304cpdf\u306e\u30d5\u30a1\u30a4\u30eb\u306e\u307f\u62bd\u51fa\n$files = new RegexIterator($files, '/^.+\\.pdf$/i', RecursiveRegexIterator::MATCH);\n\nforeach($files as $file_path => $file_info) {\n//    echo 'file name : '. basename($file_path)          .PHP_EOL; //\u30d5\u30a1\u30a4\u30eb\u540d\n//    echo 'file path : '. $file_path                    .PHP_EOL; //\u30d5\u30a1\u30a4\u30eb\u306e\u30d5\u30eb\u30d1\u30b9\n//    echo 'file size : '. $file_info->getSize()         .PHP_EOL; //\u30d5\u30a1\u30a4\u30eb\u30b5\u30a4\u30ba\n//    echo 'contents  : '. file_get_contents($file_path) .PHP_EOL; //\u30d5\u30a1\u30a4\u30eb\u306e\u5185\u5bb9\u3092\u53d6\u5f97\n//    echo 'serch dir : '. $serch_dir                    .PHP_EOL; //\n\n      //\u30d5\u30a1\u30a4\u30eb\u540d\u306e\u307f\u53d6\u5f97\n      $file_name = basename($file_path);\n      $reg=\"/(.*)(?:\\.([^.]+$))/\";\n      preg_match($reg,$file_name,$retArr);\n      $file_name  = $retArr[1];\n      $extension  = $retArr[2];\n\n      //ImageMagic\u51e6\u7406\n      //im->readimage($file_path);\n      //$page_count = $im->getImageScene();\n\n      //PDF\u304b\u3089\u753b\u50cf\u30d5\u30a1\u30a4\u30eb\u3078\u306e\u5909\u63db\u51e6\u7406\n      $output = shell_exec(\"convert \".$file_path.\" \".$serch_dir.\"/\".$file_name.\".png 2>&1\");\n      print_r ($output);\n\n//      for($i = 0; $i <= $page_count-1; $i++) {\n//          $im->setIteratorIndex($i);\n//          $im->setImageFormat('png');\n//          $im->writeimage($serch_dir.'/'.$file_name . $i . \"png\");\n//      }\n\n}\n\n$im->clear();\n\n?>\n\n\u25a0\u52d5\u4f5c\u78ba\u8a8d\n\u30fb\u30d6\u30e9\u30a6\u30b6\u3088\u308a\u30a2\u30af\u30bb\u30b9\nhttp://(IP or Domain)/Imagick-Ghostscript.php\n\u30fb\u30b3\u30de\u30f3\u30c9\u30e9\u30a4\u30f3\u3088\u308a\u5b9f\u884c\n# chmod 775 /var/www/html/pdf/Imagick-Ghostscript.php\n# chown root.apache /var/www/html/pdf/Imagick-Ghostscript.php\n# php /var/www/html/pdf/Imagick-Ghostscript.php\n\n\u554f\u984c\u306a\u304f\u5909\u63db\u3059\u308b\u3053\u3068\u304c\u51fa\u6765\u307e\u3057\u305f\u3002\n\n05.\u304a\u307e\u3051\n\n\u25a005-1. \u516c\u5f0f\u975e\u63a8\u5968\u3068\u3055\u308c\u3066\u3044\u308bImagick\u30e2\u30b8\u30e5\u30fc\u30eb\n1) Imagick::setImageIndex\nhttp://php.net/manual/ja/imagick.setimageindex.php\n2) destroy();\nhttp://php.net/manual/ja/imagick.destroy.php\n\u2192\u4ee3\u66ff Imagick::clear\n\n\u25a005-2. web\u30b5\u30fc\u30d0\u304b\u3089\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u5b9f\u884c\u3057\u305f\u969b\u306b\u53e4\u3044gs\u304c\u547c\u3073\u51fa\u3055\u308c\u30a8\u30e9\u30fc\u3068\u306a\u3063\u305f\u5834\u5408\n\u203b\u3069\u306e\u30bf\u30a4\u30df\u30f3\u30b0\u304b\u306f\u5206\u304b\u308a\u307e\u305b\u3093\u304c\u3001GhostScript 8.7\u304c\u6700\u521d\u304b\u3089\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u3066\u3044\u308b\u3068\u3053\u306e\u73fe\u8c61\u304c\u767a\u751f\u3059\u308b\u3088\u3046\u3067\u3059\u3002\n# view /var/log/httpd/error_log\n----------\nGPL Ghostscript 8.70: Unrecoverable error, exit code 1 \u2605\u30d0\u30fc\u30b8\u30e7\u30f3\u304c\u53e4\u3044\nconvert: Postscript delegate failed `./sample.pdf': No such file or directory @ pdf.c/ReadPDFImage/611.\nconvert: missing an image filename `./sample_thumb.jpg' @ convert.c/ConvertImageCommand/2800.\n\n\u25bd\u5bfe\u51e6\uff1a\u30b7\u30f3\u30dc\u30ea\u30c3\u30af\u30ea\u30f3\u30af\u3092\u8cbc\u308b\n\u30fb\u4eca\u56de\u5c0e\u5165\u3057\u305f\u6700\u65b0\u7248\u304c\u5b9f\u884c\u3055\u308c\u308b\u3088\u3046\u30b7\u30f3\u30dc\u30ea\u30c3\u30af\u30ea\u30f3\u30af\u3092\u8cbc\u308b\u3053\u3068\u3067\u5bfe\u51e6\n# ln -sb /usr/local/bin/gs /usr/bin/gs\n----------\nlrwxrwxrwx 1 root root 17  1\u6708  5 22:36 2015 /usr/bin/gs -> /usr/local/bin/gs\n\n\u4ee5\u4e0a\u306b\u306a\u308a\u307e\u3059\u3002\n# \u306f\u3058\u3081\u306b\n## \u25a0\u76ee\u7684\nImageMagick \u3068 PHP\u3002\n\u305d\u3057\u3066PHP\u304b\u3089ImageMagick\u3092\u5229\u7528\u3059\u308b\u305f\u3081\u306ePHP \u62e1\u5f35\u30e2\u30b8\u30e5\u30fc\u30ebImagick\u3002\n\u3053\u308c\u3089\u3092\u5229\u7528\u3059\u308b\u3053\u3068\u3067PHP\u30b9\u30af\u30ea\u30d7\u30c8\u304b\u3089\u753b\u50cf\u5909\u63db\u304c\u51fa\u6765\u307e\u3059\u3002\n\n\u3057\u304b\u3057\u3001\u3053\u308c\u3060\u3051\u3067\u306fPDF\u304b\u3089\u753b\u50cf\u5909\u63db\u304c\u51fa\u6765\u307e\u305b\u3093\u3002\n\u305d\u3053\u3067Ghostscript\u3092\u5c0e\u5165\u3057PDF\u306e\u753b\u50cf\u5909\u63db\u3092\u884c\u3063\u3066\u307f\u307e\u3057\u305f\u3002\n\n## \u25a0Ghostscript\u3068\u306f\nPostScript/PDF \u30a4\u30f3\u30bf\u30d7\u30ea\u30bf\u3002\n\u3088\u304f\u5206\u304b\u308a\u307e\u305b\u3093\u304c\u3001\u30a2\u30c9\u30d3\u30b7\u30b9\u30c6\u30e0\u30ba\u306ePostScript\u30d5\u30a1\u30a4\u30eb\u3092\u753b\u50cf\u30d5\u30a1\u30a4\u30eb\u306b\u5909\u63db\u3059\u308b\u3053\u3068\u304c\u51fa\u6765\u308b\u3082\u306e\u306e\u3088\u3046\u3067\u3059\u3002\n\u3053\u3061\u3089\u3092\u5c0e\u5165\u3059\u308b\u3053\u3068\u3067ImageMagick+PHP\u3067PDF\u3088\u308a\u753b\u50cf\u5909\u63db\u304c\u53ef\u80fd\u3068\u306a\u308b\u3068\u306e\u3053\u3068\u3002\n\n\u25a0\u516c\u5f0f\u30b5\u30a4\u30c8\nhttp://www.ghostscript.com/\n\n\n## \u25a0\u4eca\u56de\u306e\u5b9f\u88c5\u74b0\u5883\nCentOS `6.5 (64bit)`\nphp `5.4.33`\nhttpd `2.2.15`\nImageMagick `6.5.4.7`\nimagick `3.1.2`\n\n# 00. \u4e8b\u524d\u6e96\u5099\n\u25bd\u30b3\u30f3\u30d1\u30a4\u30eb\u306b\u5fc5\u8981\u306a\u30d1\u30c3\u30b1\u30fc\u30b8\u306e\u5c0e\u5165\u72b6\u6cc1\u78ba\u8a8d\n\n```bash\n# rpm -qa | grep \"make\\|gcc\"\nlibgcc-4.4.7-4.el6.x86_64\ngcc-c++-4.4.7-4.el6.x86_64\nmake-3.81-20.el6.x86_64\ngcc-4.4.7-4.el6.x86_64\n```\n\n\u7121\u3051\u308c\u3070\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n```bash \n# yum install make gcc\n```\n\n\u3082\u3057\u304f\u306f\u3001\u958b\u767a\u30c4\u30fc\u30eb\u4e00\u62ec\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n```bash \n# yum groupinstall 'Development tools'\n```\n\n\n\u25bdGhostScript\u5c0e\u5165\u306b\u5fc5\u8981\u306a\u30d1\u30c3\u30b1\u30fc\u30b8\u304c\u5165\u3063\u3066\u3044\u308b\u304b\u78ba\u8a8d\n\n```bash \n# rpm -qa | grep \"libXt-devel\"\nlibXt-1.1.4-6.1.el6.x86_64\n```\n\n# 01.\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\u25a0\u30bd\u30fc\u30b9\u914d\u5e03\u5143\n\u516c\u5f0f\u30b5\u30a4\u30c8\u3088\u308a\u3001Ghostscript 9.15 Source for all platforms \u306e \u30ea\u30f3\u30af\u3092\u53d6\u5f97 (2015/01/01\u6642\u70b9\u306e\u6700\u65b0\u7248)\nhttp://downloads.ghostscript.com/public/ghostscript-9.15.tar.gz\n\n```bash \n# cd /usr/local/src/\n# curl -OL http://downloads.ghostscript.com/public/ghostscript-9.15.tar.gz\n# tar -zxvf ghostscript-9.15.tar.gz\n# cd ghostscript-9.15\n# ./configure --disable-compile-inits --with-x --with-drivers=ALL --without-luratech --with-libiconv=gnu --prefix=/usr/local\n\u203b\u30aa\u30d7\u30b7\u30e7\u30f3\u300c--disable-compile-inits\u300d\u3092\u6307\u5b9a\u3057\u306a\u3044\u3068\u3001\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u5f8c\u306e\u8a2d\u5b9a\u5909\u66f4\u304c\u3067\u304d\u306a\u304f\u306a\u308b\u3068\u306e\u3053\u3068\n\n(\u7701\u7565)\n\nLibtiff is now configured for x86_64-unknown-linux-gnu\n\n  Installation directory:             /usr/local\n  Documentation directory:            ${prefix}/share/doc/tiff-4.0.1\n  C compiler:                         gcc -g -O2 -Wall -W\n  C++ compiler:                       g++ -g -O2\n  Enable runtime linker paths:        no\n  Enable linker symbol versioning:    no\n  Support Microsoft Document Imaging: yes\n  Use win32 IO:                       no\n\n Support for internal codecs:\n  CCITT Group 3 & 4 algorithms:       yes\n  Macintosh PackBits algorithm:       yes\n  LZW algorithm:                      yes\n  ThunderScan 4-bit RLE algorithm:    yes\n  NeXT 2-bit RLE algorithm:           yes\n  LogLuv high dynamic range encoding: yes\n\n Support for external codecs:\n  ZLIB support:                       yes\n  Pixar log-format algorithm:         yes\n  JPEG support:                       yes\n  Old JPEG support:                   yes\n  JPEG 8/12 bit dual mode:            no\n  ISO JBIG support:                   no\n  LZMA2 support:                      no\n\n  C++ support:                        yes\n\n  OpenGL support:                     no\n\n(\u7701\u7565)\n\nconfigure: WARNING: Unable to include opvp/oprp driver due to missing or disabled prerequisites...\nconfigure: WARNING: Unable to include opvp/oprp driver due to missing iconv/libiconv...\n\n\u203b\u4e0a\u8a18\u3001configure\u4e2d\u306b\u6c17\u306b\u306a\u3063\u305f\u30e1\u30c3\u30bb\u30fc\u30b8\u629c\u7c8b \u2192 \u3053\u306e\u5f8c\u3001\u554f\u984c\u3068\u306a\u308b\u3053\u3068\u306f\u3042\u308a\u307e\u305b\u3093\u3067\u3057\u305f\u3002\n```\n\n```bash\n# make\n# make install\n```\n\u3053\u308c\u3067\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u5b8c\u4e86\u3067\u3059\u3002\n\n# 02.\u8a2d\u5b9a\n## \u25a002-1a. \u65e5\u672c\u8a9e\u3092\u6271\u3048\u308b\u3088\u3046\u306b\u3059\u308b(IPA\u30d5\u30a9\u30f3\u30c8\u3001IPAex\u30d5\u30a9\u30f3\u30c8 \u30a4\u30f3\u30b9\u30c8\u30fc\u30eb)\n\n\u25a0IPA\u72ec\u7acb\u884c\u653f\u6cd5\u4eba (\u914d\u5e03\u5143)\nhttp://ipafont.ipa.go.jp/ipafont/download.html\n\n```bash \n# cd /usr/local/src\n# mkdir font\n# cd font\n# wget 'http://dl.ipafont.ipa.go.jp/IPAexfont/IPAexfont00201.zip'\n# wget 'http://dl.ipafont.ipa.go.jp/IPAfont/IPAfont00303.zip'\n# unzip IPAfont00303.zip\n  inflating: IPAfont00303/ipag.ttf\n  inflating: IPAfont00303/ipagp.ttf\n  inflating: IPAfont00303/ipam.ttf\n  inflating: IPAfont00303/ipamp.ttf\n\n# unzip IPAexfont00201.zip\n  inflating: IPAexfont00201/ipaexg.ttf\n  inflating: IPAexfont00201/ipaexm.ttf\n\n# mkdir -p /usr/share/fonts/ipa/TrueType/\n# cp -p ./IPAexfont00201/*.ttf /usr/share/fonts/ipa/TrueType/.\n# cp -p ./IPAfont00303/*.ttf /usr/share/fonts/ipa/TrueType/.\n# ls -l /usr/share/fonts/ipa/TrueType/\nipaexg.ttf\nipaexm.ttf\nipag.ttf\nipagp.ttf\nipam.ttf\nipamp.ttf\n```\n\n```bash \n\u30fb\u30d5\u30a9\u30f3\u30c8\u30ad\u30e3\u30b7\u30e5\u30af\u30ea\u30a2\n# fc-cache -fv\n\n\u30fb\u30d5\u30a9\u30f3\u30c8\u4e00\u89a7\u3067\u540d\u79f0\u3092\u78ba\u8a8d\n# fc-list | grep -i ipa\nIPAex\u30b4\u30b7\u30c3\u30af,IPAexGothic:style=Regular,Regulare\nIPA\u30b4\u30b7\u30c3\u30af,IPAGothic:style=Regular\nIPA P\u30b4\u30b7\u30c3\u30af,IPAPGothic:style=Regular\nIPAex\u660e\u671d,IPAexMincho:style=Regular\nIPA\u660e\u671d,IPAMincho:style=Regular\nIPA P\u660e\u671d,IPAPMincho:style=Regular\n```\n\n## \u25a002-1b. msttcorefonts\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n\u25bd\u914d\u5e03\u5143(\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u65b9\u6cd5\u3082\u8a18\u8f09\u30a2\u30ea)\nAn easy way to install Microsoft's TrueType core fonts on linux\nhttp://corefonts.sourceforge.net/\n\n1) \u5fc5\u8981\u306a\u30d1\u30c3\u30b1\u30fc\u30b8\n\u30fbrpm-build\n\u30fbttmkfdir\n\u30fbcabextract (http://www.cabextract.org.uk )\n\n```bash \n# yum install rpm-build ttmkfdir\n\n# cd /usr/local/src/\n# wget http://www.cabextract.org.uk/cabextract-1.4-1.src.rpm\n# rpmbuild --rebuild cabextract-1.4-1.src.rpm\n# rpm -ivh /root/rpmbuild/RPMS/x86_64/cabextract-1.4-1.x86_64.rpm\n\u203bbuild\u3057\u305frpm\u30d5\u30a1\u30a4\u30eb\u306f\u3001\u300c$HOME/rpmbuild/RPMS/x86_64/\u300d\u914d\u4e0b\u306b\u683c\u7d0d\u3055\u308c\u308b\n```\n\n2) spec\u30d5\u30a1\u30a4\u30eb\u3088\u308a msttcorefonts \u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n```bash \n# cd /usr/local/src/\n# wget http://corefonts.sourceforge.net/msttcorefonts-2.5-1.spec\n# rpmbuild -bb msttcorefonts-2.5-1.spec\n# rpm -ivh /root/rpmbuild/RPMS/noarch/msttcorefonts-2.5-1.noarch.rpm\n\u203bbuild\u3057\u305frpm\u30d5\u30a1\u30a4\u30eb\u306f\u3001\u300c$HOME/rpmbuild/RPMS/noarch/\u300d\u914d\u4e0b\u306b\u683c\u7d0d\u3055\u308c\u308b\n\n\u30fb\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u5148\u306f\u4ee5\u4e0b\n/usr/share/fonts/msttcorefonts/*.ttf\n```\n\n## \u25a002-2. cidfmap\n\u30fbCID\u30d5\u30a9\u30f3\u30c8\u3068\u5b9f\u969b\u306eTrueType\uff08OpenType\uff09\u30d5\u30a9\u30f3\u30c8\u3068\u306e\u5bfe\u5fdc\u3092\u6307\u5b9a\u3059\u308b\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3002\n\u6700\u4e0b\u884c\u306b\u4f7f\u7528\u3059\u308b\u30d5\u30a9\u30f3\u30c8\u3001\u30d5\u30a9\u30f3\u30c8\u3078\u306e\u30d1\u30b9\u3092\u8ffd\u8a18\u3002\n\n```bash \n# cd /usr/local/share/ghostscript/9.15/Resource/Init\n# cp -p cidfmap cidfmap.org\n```\n\n```bash \n# vi cidfmap\n----------\n/Ryumin-Light         /IPAEXMincho      ;\n/GothicBBB-Medium     /IPAGothic        ;\n/HeiseiMin-W3         /Ryumin-Light     ;\n/HeiseiKakuGo-W5      /GothicBBB-Medium ;\n\n%%% Alias for dvips\n/ipamincho    /IPAMincho ;\n/ipapmincho   /IPAPMincho ;\n/ipagothic    /IPAGothic ;\n/ipapgothic   /IPAPGothic ;\n/ipam         /IPAMincho ;\n/ipamp        /IPAPMincho ;\n/ipag         /IPAGothic ;\n/ipagp        /IPAPGothic ;\n/ipaexm       /IPAEXMincho ;\n/ipaexg       /IPAEXGothic ;\n\n/IPAMincho\n<<\n/FileType /TrueType\n/CSI [(Japan1) 6]\n/Path (/usr/share/fonts/ipa/TrueType/ipam.ttf)\n/SubfontID 0\n>> ;\n\n/IPAPMincho\n<<\n/FileType /TrueType\n/CSI [(Japan1) 6]\n/Path (/usr/share/fonts/ipa/TrueType/ipamp.ttf)\n/SubfontID 0\n>> ;\n\n/IPAGothic\n<<\n/FileType /TrueType\n/CSI [(Japan1) 6]\n/Path (/usr/share/fonts/ipa/TrueType/ipag.ttf)\n/SubfontID 0\n>> ;\n\n/IPAPGothic\n<<\n/FileType /TrueType\n/CSI [(Japan1) 6]\n/Path (/usr/share/fonts/ipa/TrueType/ipagp.ttf)\n/SubfontID 0\n>> ;\n\n/IPAEXMincho\n<<\n/FileType /TrueType\n/CSI [(Japan1) 6]\n/Path (/usr/share/fonts/ipa/TrueType/ipaexm.ttf)\n/SubfontID 0\n>> ;\n\n/IPAEXGothic\n<<\n/FileType /TrueType\n/CSI [(Japan1) 6]\n/Path (/usr/share/fonts/ipa/TrueType/ipaexg.ttf)\n/SubfontID 0\n>> ;\n\n/Arial\n<<\n/FileType /TrueType\n/CSI [(Artifex) (Unicode) 0]\n/Path (/usr/share/fonts/msttcorefonts/arial.ttf)\n/SubfontID 0\n>> ;\n```\n\n## \u25a002-3. gs_res.ps\n\u30fbGhostscript\u304c\u53c2\u7167\u3059\u308b\u69d8\u3005\u306a\u30ea\u30bd\u30fc\u30b9\uff08\u30d5\u30a1\u30a4\u30eb\u7b49\uff09\u306e\u5834\u6240\u3092\u6307\u5b9a\u3059\u308b\u30d5\u30a1\u30a4\u30eb\u3002\n\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u305f\u74b0\u5883\u306b\u5408\u308f\u305b\u3066\u9069\u5207\u306b\u4fee\u6b63\u3059\u308b\u3002\u5177\u4f53\u7684\u306b\u306f\u3001319\u884c\u76ee\u306e/FontResourceDir\u3068321\u884c\u76ee\u306e/GenericResourceDir\u3092\u7de8\u96c6\u3059\u308b\n\n```bash\n# cd /usr/local/share/ghostscript/9.15/Resource/Init\n# cp -p gs_res.ps gs_res.ps.org\n# vi gs_res.ps\n------\n%   /FontResourceDir (Font) .resource_dir_name\n   /FontResourceDir (/usr/local/share/ghostscript/9.15/Resource/Font/) .resource_dir_name\n\n%  /GenericResourceDir () .resource_dir_name\n  /GenericResourceDir (/usr/local/share/ghostscript/9.15/Resource) .resource_dir_name\n```\n\n## 03.\u52d5\u4f5c\u78ba\u8a8d\n\n\u25a0\u53c2\u8003\u30b5\u30a4\u30c8\n[\u516c\u5f0f] How to use Ghostscript\nhttp://www.ghostscript.com/doc/current/Use.htm\n\n\u25a0\u5b9f\u884c\u30d5\u30a1\u30a4\u30eb\u306e\u5834\u6240\n\n```bash \n# which gs\n/usr/local/bin/gs\n```\n\n\u25a0\u30b3\u30de\u30f3\u30c9\u306e\u57fa\u672c\u66f8\u5f0f\n\n```bash \n# gs [\u30aa\u30d7\u30b7\u30e7\u30f3] [\u5165\u529b\u30d5\u30a1\u30a4\u30eb]\n```\n\n## \u25a003-1. PDF\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u6210\u3059\u308b\n\n\u30fb\u30b5\u30f3\u30d7\u30eb\u753b\u50cf(tiger.eps)\u3092\u5229\u7528\u3057\u3066PDF\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u6210\u3059\u308b\n\n```\n# cd /usr/local/share/ghostscript/9.15/examples\n# gs -sDEVICE=pdfwrite -sOutputFile=tiger.pdf tiger.eps\n>>showpage, press <return> to continue<<\u3000\u2190\u30a8\u30f3\u30bf\u30fc\u62bc\u4e0b\nGS>\nGS>quit\n```\n\n````\n# ls -l tiger.pdf\ntiger.pdf\n````\n\n\u25bd\u30aa\u30d7\u30b7\u30e7\u30f3\u306e\u8aac\u660e\n\n```\n\u30d8\u30eb\u30d7\u306e\u5185\u5bb9\u3092\u8a18\u8f09\u3057\u305f\u3060\u3051\u3067\u3059\n-sDEVICE=[\u51fa\u529b\u30c7\u30d0\u30a4\u30b9] \u203bDEVICE\u3068\u306a\u3063\u3066\u3044\u308b\u304c\u3001\u4eca\u56de\u306fPNG\u3084JPEG\u306a\u3069\u306e\u753b\u50cf\u5f62\u5f0f\u3092\u6307\u5b9a\n-sOutputFile=[\u51fa\u529b\u30d5\u30a1\u30a4\u30eb\u540d]\n-dBATCH \u203b\u30d7\u30ed\u30f3\u30d7\u30c8\u3092\u81ea\u52d5\u7684\u306b\u629c\u3051\u51e6\u7406\u3092\u5b9f\u884c\u3057\u3066\u304f\u308c\u308b\n-r[\u89e3\u50cf\u5ea6] \u203b\u30c7\u30d5\u30a9\u30eb\u30c8\u306f72dpi\n-g<width>x<height> \u203bpage size in pixels\n```\n\n# 04. ImageMagick & Imagick \u3068\u306e\u9023\u643a\n\n## \u25a004-1. \u5b9f\u88c5\n\n\u25a0\u53c2\u8003URL\n[\u516c\u5f0f] \u753b\u50cf\u51e6\u7406 (ImageMagick)\nhttp://php.net/manual/ja/book.imagick.php\n\n\n\u25a0\u307e\u305ayum\u3067\u300cImageMagick\u300d\u300cImageMagick-devel\u300d\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n```\n# yum install ImageMagick ImageMagick-devel\n```\n\n\u25a0pecl\u3092\u4f7f\u3048\u308b\u3088\u3046\u306b\u3059\u308b\n\n```\n# yum install php-pear php-devel httpd-devel\n```\n\n\u25a0PECL\u3067\u300cimagick\u300d\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n```\n# pecl install imagick\nPlease provide the prefix of Imagemagick installation [autodetect] :\u3000\u305d\u306e\u307e\u307e\u30a8\u30f3\u30bf\u30fc\u3067\u81ea\u52d5\u7684\u306bImageMagick\u3092\u63a2\u3057\u3066\u3082\u3089\u3046\n```\n\n\u25a0php.ini\u306e\u8a2d\u5b9a\n\n\u30fbimagick\u3092\u6709\u52b9\u306b\u3059\u308b\n\n```\n# cp -p /etc/php.ini /etc/php.ini.org\n# vi /etc/php.ini\n------\nextension=imagick.so\u3000\u3053\u3061\u3089\u3092\u8ffd\u8a18\n```\n\n\u25a0PHP\u30e2\u30b8\u30e5\u30fc\u30eb\u3068\u3057\u3066\u8ffd\u52a0\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\n\n```\n# php -m | grep imagick\nimagick\n```\n\n## \u25a004-2. \u52d5\u4f5c\u78ba\u8a8d\n\n\u25a0\u307e\u305a\u30b3\u30de\u30f3\u30c9\u30e9\u30a4\u30f3\u3088\u308a\n\u30fbTiger.pdf\u3092PNG\u30d5\u30a1\u30a4\u30eb\u306b\u5909\u63db\u3059\u308b\u3002\n\n```\n# cd /usr/local/share/ghostscript/9.15/examples\n# convert tiger.pdf tiger.png\n# ls tiger.png\ntiger.png\n```\n\n![tiger.png](https://qiita-image-store.s3.amazonaws.com/0/50310/6a730167-94ab-ab94-67db-c28a9dec7197.png)\n\n<div style=\"text-align: center;\">tiger.png</div>\n\n\u30fb\u8907\u6570\u30da\u30fc\u30b8\u3042\u308bannots.pdf\u3092PNG\u30d5\u30a1\u30a4\u30eb\u306b\u5909\u63db\u3059\u308b\n\n```\n# convert annots.pdf annots.png\n# ls annots*.png\nannots-0.png  annots-1.png  annots-2.png  annots-3.png  annots-4.png  annots-5.png\n\u203b\u30da\u30fc\u30b8\u6bce\u306b\u753b\u50cf\u30d5\u30a1\u30a4\u30eb\u3078\u5909\u63db\u3055\u308c\u308b\n```\n\n![annots-1.png](https://qiita-image-store.s3.amazonaws.com/0/50310/0861b0fc-bc0a-cdf5-e66b-31e81e2d77cd.png)\n<div style=\"text-align: center;\">annots-1.png</div>\n\n\n\u25a0\u30b9\u30af\u30ea\u30d7\u30c8\u3088\u308a\u5b9f\u884c\n\n\u30fbapache\u3067\u66f8\u304d\u8fbc\u307f\u304c\u51fa\u6765\u308b\u3088\u3046\u6a29\u9650\u4ed8\u4e0e\u3057\u3066\u304a\u304f\n\n```\n# cd /var/www/html\n# mkdir /var/www/html/pdf\n# chown root.apache /var/www/html/pdf\n# chmod 775 /var/www/html/pdf\n```\n\n\u30fbPDF\u30d5\u30a1\u30a4\u30eb\u306e\u5168\u30da\u30fc\u30b8\u3092\u753b\u50cf\u306b\u5909\u63db\u3059\u308b\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u7528\u610f\n\n```\n# vi /var/www/html/pdf/Imagick-Ghostscript.php\n```\n\n```php \n<?php\n\n//ImageMagic\u5b9a\u7fa9\n$im = new imagick();\n//$im->setResolution(144,144);\n\n//\u5bfe\u8c61\u306e\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092\u6307\u5b9a(\u30ab\u30ec\u30f3\u30c8\u30c7\u30a3\u30ec\u30af\u30c8\u30ea);\n$serch_dir = dirname(__FILE__);\n\n$files = new RecursiveIteratorIterator(\n            new RecursiveDirectoryIterator($serch_dir,\n                    FilesystemIterator::CURRENT_AS_FILEINFO |\n                    FilesystemIterator::KEY_AS_PATHNAME |\n                    FilesystemIterator::SKIP_DOTS\n            )\n        );\n\n// \u62e1\u5f35\u5b50\u304cpdf\u306e\u30d5\u30a1\u30a4\u30eb\u306e\u307f\u62bd\u51fa\n$files = new RegexIterator($files, '/^.+\\.pdf$/i', RecursiveRegexIterator::MATCH);\n\nforeach($files as $file_path => $file_info) {\n//    echo 'file name : '. basename($file_path)          .PHP_EOL; //\u30d5\u30a1\u30a4\u30eb\u540d\n//    echo 'file path : '. $file_path                    .PHP_EOL; //\u30d5\u30a1\u30a4\u30eb\u306e\u30d5\u30eb\u30d1\u30b9\n//    echo 'file size : '. $file_info->getSize()         .PHP_EOL; //\u30d5\u30a1\u30a4\u30eb\u30b5\u30a4\u30ba\n//    echo 'contents  : '. file_get_contents($file_path) .PHP_EOL; //\u30d5\u30a1\u30a4\u30eb\u306e\u5185\u5bb9\u3092\u53d6\u5f97\n//    echo 'serch dir : '. $serch_dir                    .PHP_EOL; //\n\n      //\u30d5\u30a1\u30a4\u30eb\u540d\u306e\u307f\u53d6\u5f97\n      $file_name = basename($file_path);\n      $reg=\"/(.*)(?:\\.([^.]+$))/\";\n      preg_match($reg,$file_name,$retArr);\n      $file_name  = $retArr[1];\n      $extension  = $retArr[2];\n\n      //ImageMagic\u51e6\u7406\n      //im->readimage($file_path);\n      //$page_count = $im->getImageScene();\n\n      //PDF\u304b\u3089\u753b\u50cf\u30d5\u30a1\u30a4\u30eb\u3078\u306e\u5909\u63db\u51e6\u7406\n      $output = shell_exec(\"convert \".$file_path.\" \".$serch_dir.\"/\".$file_name.\".png 2>&1\");\n      print_r ($output);\n\n//      for($i = 0; $i <= $page_count-1; $i++) {\n//          $im->setIteratorIndex($i);\n//          $im->setImageFormat('png');\n//          $im->writeimage($serch_dir.'/'.$file_name . $i . \"png\");\n//      }\n\n}\n\n$im->clear();\n\n?>\n```\n\n\u25a0\u52d5\u4f5c\u78ba\u8a8d\n\u30fb\u30d6\u30e9\u30a6\u30b6\u3088\u308a\u30a2\u30af\u30bb\u30b9\nhttp://(IP or Domain)/Imagick-Ghostscript.php\n\n\u30fb\u30b3\u30de\u30f3\u30c9\u30e9\u30a4\u30f3\u3088\u308a\u5b9f\u884c\n\n```\n# chmod 775 /var/www/html/pdf/Imagick-Ghostscript.php\n# chown root.apache /var/www/html/pdf/Imagick-Ghostscript.php\n# php /var/www/html/pdf/Imagick-Ghostscript.php\n```\n\n\u554f\u984c\u306a\u304f\u5909\u63db\u3059\u308b\u3053\u3068\u304c\u51fa\u6765\u307e\u3057\u305f\u3002\n\n# 05.\u304a\u307e\u3051\n\n## \u25a005-1. \u516c\u5f0f\u975e\u63a8\u5968\u3068\u3055\u308c\u3066\u3044\u308bImagick\u30e2\u30b8\u30e5\u30fc\u30eb\n1) Imagick::setImageIndex\nhttp://php.net/manual/ja/imagick.setimageindex.php\n\n2) destroy();\nhttp://php.net/manual/ja/imagick.destroy.php\n\u2192\u4ee3\u66ff Imagick::clear\n\n\n## \u25a005-2. web\u30b5\u30fc\u30d0\u304b\u3089\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u5b9f\u884c\u3057\u305f\u969b\u306b\u53e4\u3044gs\u304c\u547c\u3073\u51fa\u3055\u308c\u30a8\u30e9\u30fc\u3068\u306a\u3063\u305f\u5834\u5408\n\u203b\u3069\u306e\u30bf\u30a4\u30df\u30f3\u30b0\u304b\u306f\u5206\u304b\u308a\u307e\u305b\u3093\u304c\u3001GhostScript 8.7\u304c\u6700\u521d\u304b\u3089\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u3066\u3044\u308b\u3068\u3053\u306e\u73fe\u8c61\u304c\u767a\u751f\u3059\u308b\u3088\u3046\u3067\u3059\u3002\n\n```\n# view /var/log/httpd/error_log\n----------\nGPL Ghostscript 8.70: Unrecoverable error, exit code 1 \u2605\u30d0\u30fc\u30b8\u30e7\u30f3\u304c\u53e4\u3044\nconvert: Postscript delegate failed `./sample.pdf': No such file or directory @ pdf.c/ReadPDFImage/611.\nconvert: missing an image filename `./sample_thumb.jpg' @ convert.c/ConvertImageCommand/2800.\n```\n\n\u25bd\u5bfe\u51e6\uff1a\u30b7\u30f3\u30dc\u30ea\u30c3\u30af\u30ea\u30f3\u30af\u3092\u8cbc\u308b\n\u30fb\u4eca\u56de\u5c0e\u5165\u3057\u305f\u6700\u65b0\u7248\u304c\u5b9f\u884c\u3055\u308c\u308b\u3088\u3046\u30b7\u30f3\u30dc\u30ea\u30c3\u30af\u30ea\u30f3\u30af\u3092\u8cbc\u308b\u3053\u3068\u3067\u5bfe\u51e6\n\n```\n# ln -sb /usr/local/bin/gs /usr/bin/gs\n----------\nlrwxrwxrwx 1 root root 17  1\u6708  5 22:36 2015 /usr/bin/gs -> /usr/local/bin/gs\n```\n\n\n\u4ee5\u4e0a\u306b\u306a\u308a\u307e\u3059\u3002\n", "tags": ["CentOS6.5", "PHP5.4.33", "GhostScript9.15", "httpd2.2.15", "ImageMagick6.5.4.7"]}