{"context": " More than 1 year has passed since last update.\n\nviz::WCloud\u3092\u898b\u3064\u3051\u305f\u306e\u30673\u6b21\u5143\u70b9\u7fa4\u3092\u8272\u4ed8\u304d\u3067\u8868\u793a\u3057\u3066\u307f\u305f\n\n3\u6b21\u5143\u70b9\u7fa4\u53ef\u8996\u5316\u7528\u306eVizWindow\u751f\u6210\n\nviz::Viz3d myWindow(\"Point Cloud\");\n\n\nrgb, depth\u30c7\u30fc\u30bf\u306e\u8aad\u307f\u8fbc\u307f\n\n\u30b5\u30f3\u30d7\u30eb\uff08rgb.png, depth.png\uff09\u304cmodules/rgbd/testdata/rgbd/odometry\u306e\u4e2d\u306b\u3042\u308a\u307e\u3059\n\n    float fx = 525.0f, // default\n          fy = 525.0f,\n          cx = 319.5f,\n          cy = 239.5f;\n\n    Mat colorImage;\n    Mat depth, depth_flt;\n\n    colorImage = imread(\"rgb.png\");\n    depth = imread(\"depth.png\", -1);\n    imshow(\"rgb\", colorImage);\n    imshow(\"depth\", depth);\n\n    depth.convertTo(depth_flt, CV_32FC1, 1.f / 5000.f);\n    depth_flt.setTo(std::numeric_limits<float>::quiet_NaN(), depth == 0);\n    depth = depth_flt;\n\n\n3\u6b21\u5143\u70b9\u7fa4\u306e\u751f\u6210\n    int height = 480, width = 640;\n    Mat pCloud(height, width, CV_32FC3);\n    for (int y = 0; y < 480; y++){\n        for (int x = 0; x < 640; x++){\n            if (depth.at<float>(y, x) < 8.0 && depth.at<float>(y, x) > 0.4){\n                //RGB-D Dataset\n                float Z = depth.at<float>(y, x);\n                float X = (x - cx) * Z / fx;\n                float Y = (y - cy) * Z / fy;\n                pCloud.at<Vec3f>(y, x) = Vec3f(X, Y, Z);\n            }\n            else{\n                //RGB-D Dataset\n                pCloud.at<Vec3f>(y, x) = Vec3f(0.f, 0.f, 0.f);\n            }\n        }\n    }\n\n\nVizWindow\u306b\u8868\u793a\n    viz::WCloud wcloud(pCloud, colorImage);\n    myWindow.showWidget(\"CLOUD\", wcloud);\n    myWindow.spin();\n\n\n3\u6b21\u5143\u70b9\u7fa4\u3068\u8272\u753b\u50cf\u306e\u30b5\u30a4\u30ba\u306f\u540c\u3058\u3067\u306a\u3044\u3068\u3044\u3051\u307e\u305b\u3093\nshowWidget\u306e\u540d\u524d\u3092\"CLOUD2\"\u306e\u3088\u3046\u306b\u5909\u3048\u3066\u3044\u304f\u3053\u3068\u3067\u7c21\u5358\u306b\u70b9\u7fa4\u3092\u5897\u3084\u3057\u3066\u8868\u793a\u3067\u304d\u307e\u3059\n\u30eb\u30fc\u30d7\u306e\u4e2d\u3067\u70b9\u7fa4\u3092\u5897\u3084\u3059\u5834\u5408\u3001myWindow.spinOnce(1, true);\u3067\u66f4\u65b0\u3059\u308c\u3070\u3044\u3044\u3067\u3059\n\n\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u306f\u3053\u3061\u3089\n\n\u5b9f\u884c\u6e96\u5099\nOpenCV3.0\u306e\u5c0e\u5165\u306b\u3064\u3044\u3066\u306f\u3053\u3061\u3089\nAdditional Include Directories\n$(OPENCV_DIR)\\build\\include;\nC:\\Program Files (x86)\\PCL 1.7.2\\3rdParty\\VTK\\include\\vtk-5.10;\nAdditional Library Directories\n$(OPENCV_DIR)\\build\\x86\\vc12\\lib;\nC:\\Program Files (x86)\\PCL 1.7.2\\3rdParty\\VTK\\lib\\vtk-5.10;\nopencv_vtk_lib.hpp\u306fopencv300\\build\\include\u306e\u4e0b\u306b\u7f6e\u3044\u3066\u304f\u3060\u3055\u3044\n\u203bwidget_accessor\u3092\u4f7f\u308f\u306a\u3044\u3068\u304dVTK\u306f\u4e0d\u8981\u3067\u3059\u3002\n\n\u5b9f\u884c\u7d50\u679c\n\u6700\u521d\u306f\u3053\u3093\u306a\u611f\u3058\u3002\u8868\u793a\u3059\u308b\u3068\u304d\u306e\u5ea7\u6a19\u7cfb\u304c\u9055\u3046\u3002\n\n\u30c9\u30e9\u30c3\u30b0\u3067\u56de\u8ee2\nShift+\u30c9\u30e9\u30c3\u30b0\u3067\u5e73\u884c\u79fb\u52d5\nCtrl+\u30c9\u30e9\u30c3\u30b0\u3067\u89d2\u5ea6\u8abf\u6574\n\u30b9\u30af\u30ed\u30fc\u30eb\u3067\u30ba\u30fc\u30e0\n\n\n\u95a2\u9023\u8a18\u4e8b\nCreating Widgets (Viz+VTK)\n#viz::WCloud\u3092\u898b\u3064\u3051\u305f\u306e\u30673\u6b21\u5143\u70b9\u7fa4\u3092\u8272\u4ed8\u304d\u3067\u8868\u793a\u3057\u3066\u307f\u305f\n\n##3\u6b21\u5143\u70b9\u7fa4\u53ef\u8996\u5316\u7528\u306eVizWindow\u751f\u6210\n\n- viz::Viz3d myWindow(\"Point Cloud\");\n\n##rgb, depth\u30c7\u30fc\u30bf\u306e\u8aad\u307f\u8fbc\u307f\n- \u30b5\u30f3\u30d7\u30eb\uff08rgb.png, depth.png\uff09\u304cmodules/rgbd/testdata/rgbd/odometry\u306e\u4e2d\u306b\u3042\u308a\u307e\u3059\n\n~~~\n\tfloat fx = 525.0f, // default\n\t\t  fy = 525.0f,\n\t\t  cx = 319.5f,\n\t\t  cy = 239.5f;\n\n\tMat colorImage;\n\tMat depth, depth_flt;\n\n\tcolorImage = imread(\"rgb.png\");\n\tdepth = imread(\"depth.png\", -1);\n\timshow(\"rgb\", colorImage);\n\timshow(\"depth\", depth);\n\n\tdepth.convertTo(depth_flt, CV_32FC1, 1.f / 5000.f);\n\tdepth_flt.setTo(std::numeric_limits<float>::quiet_NaN(), depth == 0);\n\tdepth = depth_flt;\n~~~\n\n## 3\u6b21\u5143\u70b9\u7fa4\u306e\u751f\u6210\n\n~~~\n\tint height = 480, width = 640;\n\tMat pCloud(height, width, CV_32FC3);\n\tfor (int y = 0; y < 480; y++){\n\t\tfor (int x = 0; x < 640; x++){\n\t\t\tif (depth.at<float>(y, x) < 8.0 && depth.at<float>(y, x) > 0.4){\n\t\t\t\t//RGB-D Dataset\n\t\t\t\tfloat Z = depth.at<float>(y, x);\n\t\t\t\tfloat X = (x - cx) * Z / fx;\n\t\t\t\tfloat Y = (y - cy) * Z / fy;\n\t\t\t\tpCloud.at<Vec3f>(y, x) = Vec3f(X, Y, Z);\n\t\t\t}\n\t\t\telse{\n\t\t\t\t//RGB-D Dataset\n\t\t\t\tpCloud.at<Vec3f>(y, x) = Vec3f(0.f, 0.f, 0.f);\n\t\t\t}\n\t\t}\n\t}\n~~~\n\n##VizWindow\u306b\u8868\u793a\n\n~~~\n\tviz::WCloud wcloud(pCloud, colorImage);\n\tmyWindow.showWidget(\"CLOUD\", wcloud);\n\tmyWindow.spin();\n~~~\n\n- 3\u6b21\u5143\u70b9\u7fa4\u3068\u8272\u753b\u50cf\u306e\u30b5\u30a4\u30ba\u306f\u540c\u3058\u3067\u306a\u3044\u3068\u3044\u3051\u307e\u305b\u3093\n- showWidget\u306e\u540d\u524d\u3092\"CLOUD2\"\u306e\u3088\u3046\u306b\u5909\u3048\u3066\u3044\u304f\u3053\u3068\u3067\u7c21\u5358\u306b\u70b9\u7fa4\u3092\u5897\u3084\u3057\u3066\u8868\u793a\u3067\u304d\u307e\u3059\n- \u30eb\u30fc\u30d7\u306e\u4e2d\u3067\u70b9\u7fa4\u3092\u5897\u3084\u3059\u5834\u5408\u3001myWindow.spinOnce(1, true);\u3067\u66f4\u65b0\u3059\u308c\u3070\u3044\u3044\u3067\u3059\n\n\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u306f[\u3053\u3061\u3089](https://github.com/SatoshiRobatoFujimoto/PointCloudViz)\n\n#\u5b9f\u884c\u6e96\u5099\nOpenCV3.0\u306e\u5c0e\u5165\u306b\u3064\u3044\u3066\u306f[\u3053\u3061\u3089](http://qiita.com/SatoshiRobatoFujimoto/items/c65022a5a6bf845d219b)\n\nAdditional Include Directories\n$(OPENCV_DIR)\\build\\include;\n~~C:\\Program Files (x86)\\PCL 1.7.2\\3rdParty\\VTK\\include\\vtk-5.10;~~\n\nAdditional Library Directories\n$(OPENCV_DIR)\\build\\x86\\vc12\\lib;\n~~C:\\Program Files (x86)\\PCL 1.7.2\\3rdParty\\VTK\\lib\\vtk-5.10;~~\n\n~~opencv_vtk_lib.hpp\u306fopencv300\\build\\include\u306e\u4e0b\u306b\u7f6e\u3044\u3066\u304f\u3060\u3055\u3044~~\n\n\u203bwidget_accessor\u3092\u4f7f\u308f\u306a\u3044\u3068\u304dVTK\u306f\u4e0d\u8981\u3067\u3059\u3002\n\n#\u5b9f\u884c\u7d50\u679c\n\u6700\u521d\u306f\u3053\u3093\u306a\u611f\u3058\u3002\u8868\u793a\u3059\u308b\u3068\u304d\u306e\u5ea7\u6a19\u7cfb\u304c\u9055\u3046\u3002\n![VTKCloud.png](https://qiita-image-store.s3.amazonaws.com/0/63863/8d427fc3-9b4d-a394-5253-85cbccbd1c75.png)\n\n\u30c9\u30e9\u30c3\u30b0\u3067\u56de\u8ee2\nShift+\u30c9\u30e9\u30c3\u30b0\u3067\u5e73\u884c\u79fb\u52d5\nCtrl+\u30c9\u30e9\u30c3\u30b0\u3067\u89d2\u5ea6\u8abf\u6574\n\u30b9\u30af\u30ed\u30fc\u30eb\u3067\u30ba\u30fc\u30e0\n![VTKCloud2.png](https://qiita-image-store.s3.amazonaws.com/0/63863/e2335de9-d53a-a7a3-7790-c76395b351a5.png)\n\n#\u95a2\u9023\u8a18\u4e8b\n[Creating Widgets (Viz+VTK)](http://qiita.com/SatoshiRobatoFujimoto/items/5d9c1eaeda224f92c527)\n\n", "tags": ["OpenCV", "VisualStudio", "C++", "3D", "OpenGL"]}