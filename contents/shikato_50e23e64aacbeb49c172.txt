{"context": "Stetho\u304c\u4fbf\u5229\u306a\u306e\u3067\u3001\u3088\u308a\u6d3b\u7528\u3059\u308b\u3079\u304f\u3001Custom dumpapp Plugins\u306e\u4f5c\u308a\u65b9\u3092\u8abf\u3079\u3066\u307f\u307e\u3057\u305f\u3002\n\n\nStetho\u306b\u3064\u3044\u3066\n\n\u307e\u305a\u3001Stetho\u306b\u3064\u3044\u3066\u3067\u3059\u304c\u3001Chrome DevTools\u4e0a\u3067\u306eAndroid\u30a2\u30d7\u30ea\u306e\u30c7\u30d0\u30c3\u30b0\u3092\u53ef\u80fd\u3068\u3057\u3066\u304f\u308c\u308bFacebook\u88fd\u30bd\u30d5\u30c8\u30a6\u30a7\u30a2\u3067\u3059\u3002\nStetho\nStetho\u3092\u4f7f\u3046\u3068\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u3053\u3068\u304c\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u308b\u3002\n\nNetwork Inspection\n\n\nChrome DevTools\u306eNetwork Inspection\uff08JSON\u30ec\u30b9\u30dd\u30f3\u30b9helper\u3084\u753b\u50cf\u30d7\u30ec\u30d3\u30e5\u30fc\u3001HAR\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u3067\u306e\u30a8\u30af\u30b9\u30dd\u30fc\u30c8\u306a\u3069\uff09\u3092Android\u30a2\u30d7\u30ea\u306e\u901a\u4fe1\u306b\u304a\u3044\u3066\u3082\u4f7f\u3048\u308b\u3088\u3046\u306b\u306a\u308b\u3002\n\nDatabase Inspection\n\n\nSQLite\u3084Preference\u306e\u5024\u3092\u3001Chrome DevTools\u306e\u4f7f\u3044\u6163\u308c\u305fUI\u3067\u3001\u78ba\u8a8d\u3057\u305f\u308a\u66f8\u304d\u63db\u3048\u305f\u308a\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u308b\u3002\n\nView Hierarchy\n\n\nChrome DevTools\u306e\u898b\u6163\u308c\u305f\u753b\u9762\u3067\u3001\u30a2\u30d7\u30ea\u306eView hierarchy\u3092\u78ba\u8a8d\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u308b\u3002\n\u300cCopy XPATH\u300d\u3068\u304b\u3082\u4f7f\u3048\u308b\u306e\u3067\u3001Appium\u3068\u304b\u3067\u30c6\u30b9\u30c8\u3059\u308b\u3068\u304d\u3082\u4fbf\u5229\u305d\u3046\u3002\n\ndumpapp\n\n\n\u3053\u308c\u306f\u4ed6\u3068\u5c11\u3057\u6bdb\u8272\u306e\u9055\u3046\u6a5f\u80fd\u3067\u3001dumpapp\u306fChrome DevTools\u3092\u4f7f\u3063\u3066\u3067\u306f\u306a\u304f\u3001\u30b3\u30de\u30f3\u30c9\u30e9\u30a4\u30f3\u4e0a\u304b\u3089\u306eAndroid\u30a2\u30d7\u30ea\u306e\u30c7\u30d0\u30c3\u30b0\u3092\u53ef\u80fd\u3068\u3057\u3066\u304f\u308c\u308b\u3002\n\u3055\u3089\u306bdumpapp\u306f\u62e1\u5f35\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u308b\uff08Custom dumpapp Plugins\uff09\u3002\n\u305d\u306eCustom dumpapp Plugins\u306e\u4f5c\u30ea\u65b9\u306b\u95a2\u3057\u3066\u306f\u3001\u300cSee the stetho-sample project for more details.\u300d\u3068\u66f8\u3044\u3066\u3042\u308b\u306e\u307f\u3067\u3001\u4ed6\u306b\u8aac\u660e\u306f\u7121\u3044\u3063\u307d\u3044\u306e\u3067\u3001\u30b5\u30f3\u30d7\u30eb\u3092\u53c2\u7167\u3057\u306a\u304c\u3089\u3001\u5b9f\u969b\u306b\u4f5c\u3063\u3066\u307f\u308b\u3053\u3068\u306b\u3059\u308b\u3002\n\nStetho\u306e\u5c0e\u5165\n\n\nbuild.gradle\n\n\nbuild.gradle\ncompile 'com.facebook.stetho:stetho:1.1.1'\n// \u4ee5\u4e0b\u306fNetwork inspection\u3059\u308b\u5834\u5408\u306b\u5fc5\u8981\n// OkHttp\u3092\u4f7f\u3046\u5834\u5408\ncompile 'com.facebook.stetho:stetho-okhttp:1.1.1'\n// UrlConnection\u3092\u4f7f\u3046\u5834\u5408\ncompile 'com.facebook.stetho:stetho-urlconnection:1.1.1'\n\n\n\nApplicatio\u30af\u30e9\u30b9\n\npublic class MyApplication extends Application {\n    public void onCreate() {\n        super.onCreate();\n        Stetho.initialize(\n             Stetho.newInitializerBuilder(this)\n             // dumpapp\u3092\u6709\u52b9\u306b\u3059\u308b\n             .enableDumpapp(\n                  Stetho.defaultDumperPluginsProvider(this))\n             // Chrome DevTools\u3067\u306e\u30c7\u30d0\u30c3\u30b0\u3092\u6709\u52b9\u306b\u3059\u308b\n             .enableWebKitInspector(\n                  Stetho.defaultInspectorModulesProvider(this))\n             .build());\n   }\n}\n\n\nNetwork Inspection\u6a5f\u80fd\u3092\u4f7f\u3046\u5834\u5408\n\nOkHttp\nOkHttp\u306eNetworkInterceptors\u306bStethoInterceptor\u3092\u8ffd\u52a0\u3059\u308b\u3060\u3051\u3067OK\u3002\nOkHttpClient client = new OkHttpClient();\nclient.networkInterceptors().add(new StethoInterceptor());\n\nHttpURLConnection\nHttpURLConnection\u306e\u5834\u5408\u306f\u3001\u3061\u3087\u3063\u3068\u9762\u5012\u3002\n\u4ee5\u4e0b\u306e\u30b5\u30f3\u30d7\u30eb\u306e\u3088\u3046\u306b\u5b9f\u88c5\u3059\u308b\u5fc5\u8981\u304c\u3042\u308b\u3002\nNetworker.java\n\ndumpapp\u3092\u4f7f\u3046\u5834\u5408\n\ndumpapp\u30b3\u30de\u30f3\u30c9(stetho\u306e\u30ea\u30dd\u30b8\u30c8\u30ea\u306b\u542b\u307e\u308c\u3066\u3044\u308b)\u306e\u30d1\u30b9\u3092\u74b0\u5883\u5909\u6570\u306b\u8ffd\u52a0\nexport PATH=\u201d$PATH:/path/to/stetho/scripts\u201d\n\n\u203b Python 3\u304c\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u3066\u306a\u3044\u5834\u5408\u306f\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u304c\u5fc5\u8981\u3002\n\nStetho\u304c\u63d0\u4f9b\u3059\u308bdumpapp Plugins\n\n\u6700\u521d\u304b\u3089\u3001\u3044\u304f\u3064\u304b\u306edumpapp Plugins\u304c\u63d0\u4f9b\u3055\u308c\u3066\u3044\u308b\u306e\u3067\u3001\u8abf\u67fb\u304c\u3066\u3089\u898b\u3066\u307f\u308b\u3002\nStetho.defaultDumperPluginsProvider(this)\u3067\u4f7f\u3048\u308b\u3088\u3046\u306b\u306a\u308b\u306e\u306f\u3001\u4ee5\u4e0b\u306e3\u3064\u3002\n\nStetho.java\nplugins.add(new HprofDumperPlugin(context));\nplugins.add(new SharedPreferencesDumperPlugin(context));\nplugins.add(new CrashDumperPlugin());\n\n\nStetho.java\n\nSharedPreferencesDumperPlugin\n\nSharedPreference\u306e\u5024\u3092\u51fa\u529b\u3057\u305f\u308a\u66f8\u304d\u63db\u3048\u305f\u308a\u3067\u304d\u308b\u3002\nSharedPreferencesDumperPlugin.java\nwrite\n# dumpapp prefs write <path> <key> <boolean|int|long|float|string|set> <value>\ndumpapp prefs write shikato shikatokey string shikatoval\n\nprint\ndumpapp prefs print\n# \u4ee5\u4e0b\u306e\u3088\u3046\u306b\u51fa\u529b\u3055\u308c\u308b\n# shikato:\n# shikatokey = shikatoval\n\n\nCrashDumperPlugin\n\n\u30af\u30e9\u30c3\u30b7\u30e5\u3092\u610f\u56f3\u7684\u306b\u767a\u751f\u3055\u305b\u308b\u3053\u3068\u304c\u3067\u304d\u308b\u3002\nCrashDumperPlugin.java\n\u5f15\u6570\u3067\u6307\u5b9a\uff08\u30c7\u30d5\u30a9\u30eb\u30c8\u306fjava.lang.Error\uff09\u3057\u305f\u4f8b\u5916\u3092\u767a\u751f\u3055\u305b\u308b\u3002(simulates a program crash)\ndumpapp crash throw java.lang.NullPointerException\n\nSystem.exit\u3092\u4f7f\u3046\u3002(simulates an abnormal Android exit strategy)\ndumpapp crash exit\n\nProcessBuilder\u3092\u4f7f\u3063\u3066kill\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3002(simulates the low memory killer)\ndumpapp crash kill\n\n\nHprofDumperPlugin\n\nHeap dump\uff08HPROF\uff09\u3092\u3001stdout\u306b\u51fa\u529b\u3057\u305f\u308a\u3001Android\u7aef\u672b\u5185\u306e\u30d5\u30a1\u30a4\u30eb\u306b\u66f8\u304d\u8fbc\u3093\u3060\u308a\u3067\u304d\u308b\u3002\nHprofDumperPlugin.java\ndumpapp hprof -\n\n\nCustom dumpapp Plugins\u306e\u4f5c\u308a\u65b9\n\nHelloWorld\u306a\u30b5\u30f3\u30d7\u30eb dumpapp Plugin\u3002\n\nHelloWorldDumperPlugin.java\n// DumperPlugin\u3092implements\u3059\u308b\npublic class HelloWorldDumperPlugin implements DumperPlugin {\n  private static final String NAME = \"hello\";\n\n  // getName\u3067\u8fd4\u3059\u5024\u304cdumpappp\u5b9f\u884c\u6642\u306e\u30b3\u30de\u30f3\u30c9\u3068\u306a\u308b\n  // ex.) appdump {{NAME}}\n  @Override\n  public String getName() {\n    return NAME;\n  }\n\n  // getName\u3067\u6307\u5b9a\u3057\u305f\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3057\u305f\u3068\u304d\u306b\u547c\u3070\u308c\u308b\u30e1\u30bd\u30c3\u30c9\n  @Override\n  public void dump(DumperContext dumpContext) throws DumpException {\n    PrintStream writer = dumpContext.getStdout();\n    // {{NAME}}\u4ee5\u964d\u306e\u5f15\u6570\u304c\u8fd4\u3063\u3066\u304f\u308b\n    // appdump {{NAME}} hoge huga\n    Iterator<String> args = dumpContext.getArgsAsList().iterator();\n\n    String helloToWhom = args.hasNext() ? args.next() : null;\n    if (helloToWhom != null) {\n      doHello(writer, helloToWhom);\n    } else {\n      doUsage(writer);\n    }\n  }\n\n  private void doHello(PrintStream writer, String name) throws DumpUsageException {\n    if (TextUtils.isEmpty(name)) {\n      // This will print an error to the dumpapp user and cause a non-zero exit of the\n      // script.\n      throw new DumpUsageException(\"Name is empty\");\n    }\n\n    writer.println(\"Hello \" + name + \"!\");\n  }\n\n  private void doUsage(PrintStream writer) {\n    writer.println(\"Usage: dumpapp \" + NAME + \" <name>\");\n  }\n}\n\n\nHelloWorldDumperPlugin.java\n\u4f5c\u3063\u305fCoustom dumpapp Plugin\u3092\u6709\u52b9\u306b\u3059\u308b\u306b\u306f\u4ee5\u4e0b\u306e\u69d8\u306b\u5b9f\u88c5\u3059\u308b\u3002\n\nSampleDebugApplication.java\n  @Override\n  public void onCreate() {\n    super.onCreate();\n\n    long startTime = SystemClock.elapsedRealtime();\n    final Context context = this;\n    Stetho.initialize(\n        Stetho.newInitializerBuilder(context)\n            // DumperPluginsProvider\u3092implements\u3057\u305f\u30af\u30e9\u30b9\u3092\u6e21\u3059\n            .enableDumpapp(new SampleDumperPluginsProvider(context))\n            .enableWebKitInspector(Stetho.defaultInspectorModulesProvider(context))\n            .build());\n    long elapsed = SystemClock.elapsedRealtime() - startTime;\n    Log.i(TAG, \"Stetho initialized in \" + elapsed + \" ms\");\n  }\n\n  // DumperPluginsProvider\u3092implements\u3057\u305f\u30af\u30e9\u30b9\u3092\u7528\u610f\u3059\u308b\n  private static class SampleDumperPluginsProvider implements DumperPluginsProvider {\n    private final Context mContext;\n\n    public SampleDumperPluginsProvider(Context context) {\n      mContext = context;\n    }\n\n    @Override\n    public Iterable<DumperPlugin> get() {\n      ArrayList<DumperPlugin> plugins = new ArrayList<DumperPlugin>();\n      for (DumperPlugin defaultPlugin : Stetho.defaultDumperPluginsProvider(mContext).get()) {\n        plugins.add(defaultPlugin);\n      }\n      // \u6709\u52b9\u306b\u3057\u305f\u3044Plugin\u3092\u8ffd\u52a0\u3059\u308b\n      plugins.add(new HelloWorldDumperPlugin());\n      plugins.add(new APODDumperPlugin(mContext.getContentResolver()));\n      return plugins;\n    }\n  }\n\n\nSampleDebugApplication.java\nHelloWorldDumperPlugin\u3092\u5b9f\u884c\u3059\u308b\u3068\u3001\u3053\u3093\u306a\u611f\u3058\u306b\u51fa\u529b\u3055\u308c\u308b\u3002\n\n\nInfoDumperPlugin\n\n\u7c21\u5358\u306b\u4f5c\u308c\u305d\u3046\u306a\u306e\u3067\u3001\u5b9f\u969b\u306b\u4f5c\u3063\u3066\u307f\u308b\u3002\n\u4f5c\u3063\u3066\u307f\u305f\u306e\u306f\u3001dpi\u3084BuildConfig\u306e\u5024\u306a\u3069\u3001\u30b3\u30de\u30f3\u30c9\u30e9\u30a4\u30f3\u4e0a\u304b\u3089\u78ba\u8a8d\u3067\u304d\u308b\u3068\u4fbf\u5229\u305d\u3046\u306a\u5024\u3092\u51fa\u529b\u3059\u308b\u30d7\u30e9\u30b0\u30a4\u30f3\u3002\ninfo-dumper\n\n\u4eca\u306e\u3068\u3053\u308d\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u60c5\u5831\u3092\u8868\u793a\u3067\u304d\u308b\u3002\n\n\n\nCommand\nAction\n\n\n\n\nbuildconf\nBuildConfig fields.\n\n\nid\nAndroidID, UUID, Advertising ID.\n\n\ndpi\ndpi info.\n\n\nmemory\nMemory info\n\n\nnetwork\nNetwork info.\n\n\npermission\nRequired permissions.\n\n\nlastupdate\nLastupdate time.\n\n\nerror\nError state info.\n\n\ntel\nTelephonyManager info.\n\n\nappinfo\nandroid.content.pm.ApplicationInfo fields.\n\n\nosbuild\nandroid.os.Build fields.\n\n\nall\nall.\n\n\n\n\n\u6700\u5f8c\u306b\n\nStetho\u304b\u306a\u308a\u4fbf\u5229\u3002dumpapp\u3082\u3063\u3068\u6d3b\u7528\u3057\u3066\u3044\u304d\u305f\u3044\u3002\n\u305b\u3063\u304b\u304f\u4f5c\u3063\u305fInfoDumperPlugin\u3082\u3001\u3082\u3046\u3061\u3087\u3063\u3068\u4fbf\u5229\u306b\u3057\u305f\u3044\u3002\n\n\u30e1\u30e2\n\nDevTools\u306bdumpapp\u304c\u7d44\u307f\u8fbc\u307e\u308c\u308b\u304b\u3082\uff1f\nlynfogeek commented on 23 Feb\n\nThe DumperPlugins are great, but it would be even better to embed them into the DevTools.\nOne solution could be to create a new tab (like this extension does) , and list there all the enable plugins. Whenever the user click on one of them, it pulls the data and display it.\n\n\uff08commented on 23 Feb\u3068\u306a\u3063\u3066\u308b\u306e\u3067\u671b\u307f\u8584\u304b\u3082\u3060\u3051\u3069\uff09\nhttps://github.com/facebook/stetho/issues/68\nStetho\u304c\u4fbf\u5229\u306a\u306e\u3067\u3001\u3088\u308a\u6d3b\u7528\u3059\u308b\u3079\u304f\u3001Custom dumpapp Plugins\u306e\u4f5c\u308a\u65b9\u3092\u8abf\u3079\u3066\u307f\u307e\u3057\u305f\u3002\n\n![\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2015-05-28 21.54.46.png](https://qiita-image-store.s3.amazonaws.com/0/47437/cc3fbeef-8530-b571-7411-d13d00b66484.png)\n\n\n## **Stetho\u306b\u3064\u3044\u3066**\n\u307e\u305a\u3001Stetho\u306b\u3064\u3044\u3066\u3067\u3059\u304c\u3001Chrome DevTools\u4e0a\u3067\u306eAndroid\u30a2\u30d7\u30ea\u306e\u30c7\u30d0\u30c3\u30b0\u3092\u53ef\u80fd\u3068\u3057\u3066\u304f\u308c\u308bFacebook\u88fd\u30bd\u30d5\u30c8\u30a6\u30a7\u30a2\u3067\u3059\u3002\n[Stetho](http://facebook.github.io/stetho/)\n\nStetho\u3092\u4f7f\u3046\u3068\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u3053\u3068\u304c\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u308b\u3002\n\n### **Network Inspection**\n![\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2015-05-28 21.55.28.png](https://qiita-image-store.s3.amazonaws.com/0/47437/e4290cc2-098b-139e-5292-cce200d25f2a.png)\nChrome DevTools\u306eNetwork Inspection\uff08JSON\u30ec\u30b9\u30dd\u30f3\u30b9helper\u3084\u753b\u50cf\u30d7\u30ec\u30d3\u30e5\u30fc\u3001HAR\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u3067\u306e\u30a8\u30af\u30b9\u30dd\u30fc\u30c8\u306a\u3069\uff09\u3092Android\u30a2\u30d7\u30ea\u306e\u901a\u4fe1\u306b\u304a\u3044\u3066\u3082\u4f7f\u3048\u308b\u3088\u3046\u306b\u306a\u308b\u3002\n\n### **Database Inspection**\n![\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2015-05-28 22.07.17.png](https://qiita-image-store.s3.amazonaws.com/0/47437/853165f4-c2a6-e8a4-0e11-8bf8bd9149e5.png)\nSQLite\u3084Preference\u306e\u5024\u3092\u3001Chrome DevTools\u306e\u4f7f\u3044\u6163\u308c\u305fUI\u3067\u3001\u78ba\u8a8d\u3057\u305f\u308a\u66f8\u304d\u63db\u3048\u305f\u308a\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u308b\u3002\n\n### **View Hierarchy**\n![\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2015-05-28 21.54.33.png](https://qiita-image-store.s3.amazonaws.com/0/47437/4f715e63-1740-959b-4c38-18eefd784f14.png)\n\nChrome DevTools\u306e\u898b\u6163\u308c\u305f\u753b\u9762\u3067\u3001\u30a2\u30d7\u30ea\u306eView hierarchy\u3092\u78ba\u8a8d\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u308b\u3002\n\u300cCopy XPATH\u300d\u3068\u304b\u3082\u4f7f\u3048\u308b\u306e\u3067\u3001Appium\u3068\u304b\u3067\u30c6\u30b9\u30c8\u3059\u308b\u3068\u304d\u3082\u4fbf\u5229\u305d\u3046\u3002\n\n### **dumpapp**\n![\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2015-05-28 22.16.54.png](https://qiita-image-store.s3.amazonaws.com/0/47437/ef6f9251-61c1-e783-f2ff-2effbd22bdf8.png)\n\u3053\u308c\u306f\u4ed6\u3068\u5c11\u3057\u6bdb\u8272\u306e\u9055\u3046\u6a5f\u80fd\u3067\u3001dumpapp\u306fChrome DevTools\u3092\u4f7f\u3063\u3066\u3067\u306f\u306a\u304f\u3001\u30b3\u30de\u30f3\u30c9\u30e9\u30a4\u30f3\u4e0a\u304b\u3089\u306eAndroid\u30a2\u30d7\u30ea\u306e\u30c7\u30d0\u30c3\u30b0\u3092\u53ef\u80fd\u3068\u3057\u3066\u304f\u308c\u308b\u3002\n\u3055\u3089\u306bdumpapp\u306f\u62e1\u5f35\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u308b\uff08**Custom dumpapp Plugins**\uff09\u3002\n\u305d\u306e**Custom dumpapp Plugins**\u306e\u4f5c\u30ea\u65b9\u306b\u95a2\u3057\u3066\u306f\u3001\u300cSee the stetho-sample project for more details.\u300d\u3068\u66f8\u3044\u3066\u3042\u308b\u306e\u307f\u3067\u3001\u4ed6\u306b\u8aac\u660e\u306f\u7121\u3044\u3063\u307d\u3044\u306e\u3067\u3001\u30b5\u30f3\u30d7\u30eb\u3092\u53c2\u7167\u3057\u306a\u304c\u3089\u3001\u5b9f\u969b\u306b\u4f5c\u3063\u3066\u307f\u308b\u3053\u3068\u306b\u3059\u308b\u3002\n\n\n### **Stetho\u306e\u5c0e\u5165**\n#### **build.gradle**\n\n```groovy:build.gradle\ncompile 'com.facebook.stetho:stetho:1.1.1'\n// \u4ee5\u4e0b\u306fNetwork inspection\u3059\u308b\u5834\u5408\u306b\u5fc5\u8981\n// OkHttp\u3092\u4f7f\u3046\u5834\u5408\ncompile 'com.facebook.stetho:stetho-okhttp:1.1.1'\n// UrlConnection\u3092\u4f7f\u3046\u5834\u5408\ncompile 'com.facebook.stetho:stetho-urlconnection:1.1.1'\n```\n\n#### **Applicatio\u30af\u30e9\u30b9**\n\n```java\npublic class MyApplication extends Application {\n    public void onCreate() {\n        super.onCreate();\n        Stetho.initialize(\n             Stetho.newInitializerBuilder(this)\n             // dumpapp\u3092\u6709\u52b9\u306b\u3059\u308b\n             .enableDumpapp(\n                  Stetho.defaultDumperPluginsProvider(this))\n             // Chrome DevTools\u3067\u306e\u30c7\u30d0\u30c3\u30b0\u3092\u6709\u52b9\u306b\u3059\u308b\n             .enableWebKitInspector(\n                  Stetho.defaultInspectorModulesProvider(this))\n             .build());\n   }\n}\n```\n\n#### **Network Inspection\u6a5f\u80fd\u3092\u4f7f\u3046\u5834\u5408**\n\n**OkHttp**\nOkHttp\u306eNetworkInterceptors\u306bStethoInterceptor\u3092\u8ffd\u52a0\u3059\u308b\u3060\u3051\u3067OK\u3002\n\n```java:\nOkHttpClient client = new OkHttpClient();\nclient.networkInterceptors().add(new StethoInterceptor());\n```\n\n**HttpURLConnection**\nHttpURLConnection\u306e\u5834\u5408\u306f\u3001\u3061\u3087\u3063\u3068\u9762\u5012\u3002\n\u4ee5\u4e0b\u306e\u30b5\u30f3\u30d7\u30eb\u306e\u3088\u3046\u306b\u5b9f\u88c5\u3059\u308b\u5fc5\u8981\u304c\u3042\u308b\u3002\n[Networker.java](https://github.com/facebook/stetho/blob/master/stetho-sample/src/main/java/com/facebook/stetho/sample/Networker.java)\n\n\n#### **dumpapp\u3092\u4f7f\u3046\u5834\u5408**\n\ndumpapp\u30b3\u30de\u30f3\u30c9([stetho\u306e\u30ea\u30dd\u30b8\u30c8\u30ea\u306b\u542b\u307e\u308c\u3066\u3044\u308b](https://github.com/facebook/stetho/tree/master/scripts))\u306e\u30d1\u30b9\u3092\u74b0\u5883\u5909\u6570\u306b\u8ffd\u52a0\n\n```zsh\nexport PATH=\u201d$PATH:/path/to/stetho/scripts\u201d\n```\n\u203b Python 3\u304c\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u3066\u306a\u3044\u5834\u5408\u306f\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u304c\u5fc5\u8981\u3002\n\n## **Stetho\u304c\u63d0\u4f9b\u3059\u308bdumpapp Plugins**\n\n\u6700\u521d\u304b\u3089\u3001\u3044\u304f\u3064\u304b\u306edumpapp Plugins\u304c\u63d0\u4f9b\u3055\u308c\u3066\u3044\u308b\u306e\u3067\u3001\u8abf\u67fb\u304c\u3066\u3089\u898b\u3066\u307f\u308b\u3002\nStetho.defaultDumperPluginsProvider(this)\u3067\u4f7f\u3048\u308b\u3088\u3046\u306b\u306a\u308b\u306e\u306f\u3001\u4ee5\u4e0b\u306e3\u3064\u3002\n\n```java:Stetho.java\nplugins.add(new HprofDumperPlugin(context));\nplugins.add(new SharedPreferencesDumperPlugin(context));\nplugins.add(new CrashDumperPlugin());\n```\n[Stetho.java](https://github.com/facebook/stetho/blob/master/stetho/src/main/java/com/facebook/stetho/Stetho.java#L120-L122)\n\n\n### **SharedPreferencesDumperPlugin**\nSharedPreference\u306e\u5024\u3092\u51fa\u529b\u3057\u305f\u308a\u66f8\u304d\u63db\u3048\u305f\u308a\u3067\u304d\u308b\u3002\n[SharedPreferencesDumperPlugin.java](https://github.com/facebook/stetho/blob/master/stetho/src/main/java/com/facebook/stetho/dumpapp/plugins/SharedPreferencesDumperPlugin.java)\n\n**write**\n\n```zsh\n# dumpapp prefs write <path> <key> <boolean|int|long|float|string|set> <value>\ndumpapp prefs write shikato shikatokey string shikatoval\n```\n\n**print**\n\n```zsh\ndumpapp prefs print\n# \u4ee5\u4e0b\u306e\u3088\u3046\u306b\u51fa\u529b\u3055\u308c\u308b\n# shikato:\n# shikatokey = shikatoval\n```\n\n\n### **CrashDumperPlugin**\n\u30af\u30e9\u30c3\u30b7\u30e5\u3092\u610f\u56f3\u7684\u306b\u767a\u751f\u3055\u305b\u308b\u3053\u3068\u304c\u3067\u304d\u308b\u3002\n[CrashDumperPlugin.java](https://github.com/facebook/stetho/blob/master/stetho/src/main/java/com/facebook/stetho/dumpapp/plugins/CrashDumperPlugin.java)\n\n\n\u5f15\u6570\u3067\u6307\u5b9a\uff08\u30c7\u30d5\u30a9\u30eb\u30c8\u306fjava.lang.Error\uff09\u3057\u305f\u4f8b\u5916\u3092\u767a\u751f\u3055\u305b\u308b\u3002(simulates a program crash)\n\n```zsh\ndumpapp crash throw java.lang.NullPointerException\n```\n\nSystem.exit\u3092\u4f7f\u3046\u3002(simulates an abnormal Android exit strategy)\n\n```\ndumpapp crash exit\n```\n\nProcessBuilder\u3092\u4f7f\u3063\u3066kill\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3002(simulates the low memory killer)\n\n```\ndumpapp crash kill\n```\n\n### **HprofDumperPlugin**\nHeap dump\uff08HPROF\uff09\u3092\u3001stdout\u306b\u51fa\u529b\u3057\u305f\u308a\u3001Android\u7aef\u672b\u5185\u306e\u30d5\u30a1\u30a4\u30eb\u306b\u66f8\u304d\u8fbc\u3093\u3060\u308a\u3067\u304d\u308b\u3002\n[HprofDumperPlugin.java](https://github.com/facebook/stetho/blob/master/stetho/src/main/java/com/facebook/stetho/dumpapp/plugins/HprofDumperPlugin.java)\n\n```zsh\ndumpapp hprof -\n```\n\n\n## **Custom dumpapp Plugins\u306e\u4f5c\u308a\u65b9**\nHelloWorld\u306a\u30b5\u30f3\u30d7\u30eb dumpapp Plugin\u3002\n\n```java:HelloWorldDumperPlugin.java\n// DumperPlugin\u3092implements\u3059\u308b\npublic class HelloWorldDumperPlugin implements DumperPlugin {\n  private static final String NAME = \"hello\";\n\n  // getName\u3067\u8fd4\u3059\u5024\u304cdumpappp\u5b9f\u884c\u6642\u306e\u30b3\u30de\u30f3\u30c9\u3068\u306a\u308b\n  // ex.) appdump {{NAME}}\n  @Override\n  public String getName() {\n    return NAME;\n  }\n\n  // getName\u3067\u6307\u5b9a\u3057\u305f\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3057\u305f\u3068\u304d\u306b\u547c\u3070\u308c\u308b\u30e1\u30bd\u30c3\u30c9\n  @Override\n  public void dump(DumperContext dumpContext) throws DumpException {\n    PrintStream writer = dumpContext.getStdout();\n    // {{NAME}}\u4ee5\u964d\u306e\u5f15\u6570\u304c\u8fd4\u3063\u3066\u304f\u308b\n    // appdump {{NAME}} hoge huga\n    Iterator<String> args = dumpContext.getArgsAsList().iterator();\n\n    String helloToWhom = args.hasNext() ? args.next() : null;\n    if (helloToWhom != null) {\n      doHello(writer, helloToWhom);\n    } else {\n      doUsage(writer);\n    }\n  }\n\n  private void doHello(PrintStream writer, String name) throws DumpUsageException {\n    if (TextUtils.isEmpty(name)) {\n      // This will print an error to the dumpapp user and cause a non-zero exit of the\n      // script.\n      throw new DumpUsageException(\"Name is empty\");\n    }\n\n    writer.println(\"Hello \" + name + \"!\");\n  }\n\n  private void doUsage(PrintStream writer) {\n    writer.println(\"Usage: dumpapp \" + NAME + \" <name>\");\n  }\n}\n```\n[HelloWorldDumperPlugin.java](https://github.com/facebook/stetho/blob/master/stetho-sample/src/debug/java/com/facebook/stetho/sample/HelloWorldDumperPlugin.java)\n\n\u4f5c\u3063\u305fCoustom dumpapp Plugin\u3092\u6709\u52b9\u306b\u3059\u308b\u306b\u306f\u4ee5\u4e0b\u306e\u69d8\u306b\u5b9f\u88c5\u3059\u308b\u3002\n\n```java:SampleDebugApplication.java\n  @Override\n  public void onCreate() {\n    super.onCreate();\n\n    long startTime = SystemClock.elapsedRealtime();\n    final Context context = this;\n    Stetho.initialize(\n        Stetho.newInitializerBuilder(context)\n            // DumperPluginsProvider\u3092implements\u3057\u305f\u30af\u30e9\u30b9\u3092\u6e21\u3059\n            .enableDumpapp(new SampleDumperPluginsProvider(context))\n            .enableWebKitInspector(Stetho.defaultInspectorModulesProvider(context))\n            .build());\n    long elapsed = SystemClock.elapsedRealtime() - startTime;\n    Log.i(TAG, \"Stetho initialized in \" + elapsed + \" ms\");\n  }\n\n  // DumperPluginsProvider\u3092implements\u3057\u305f\u30af\u30e9\u30b9\u3092\u7528\u610f\u3059\u308b\n  private static class SampleDumperPluginsProvider implements DumperPluginsProvider {\n    private final Context mContext;\n\n    public SampleDumperPluginsProvider(Context context) {\n      mContext = context;\n    }\n\n    @Override\n    public Iterable<DumperPlugin> get() {\n      ArrayList<DumperPlugin> plugins = new ArrayList<DumperPlugin>();\n      for (DumperPlugin defaultPlugin : Stetho.defaultDumperPluginsProvider(mContext).get()) {\n        plugins.add(defaultPlugin);\n      }\n      // \u6709\u52b9\u306b\u3057\u305f\u3044Plugin\u3092\u8ffd\u52a0\u3059\u308b\n      plugins.add(new HelloWorldDumperPlugin());\n      plugins.add(new APODDumperPlugin(mContext.getContentResolver()));\n      return plugins;\n    }\n  }\n```\n[SampleDebugApplication.java](https://github.com/facebook/stetho/blob/master/stetho-sample/src/debug/java/com/facebook/stetho/sample/SampleDebugApplication.java)\n\nHelloWorldDumperPlugin\u3092\u5b9f\u884c\u3059\u308b\u3068\u3001\u3053\u3093\u306a\u611f\u3058\u306b\u51fa\u529b\u3055\u308c\u308b\u3002\n![\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2015-05-28 22.32.16.png](https://qiita-image-store.s3.amazonaws.com/0/47437/150d94c6-38a5-58bf-9b59-7e5d3c37bd83.png)\n\n## **InfoDumperPlugin**\n\u7c21\u5358\u306b\u4f5c\u308c\u305d\u3046\u306a\u306e\u3067\u3001\u5b9f\u969b\u306b\u4f5c\u3063\u3066\u307f\u308b\u3002\n\n\u4f5c\u3063\u3066\u307f\u305f\u306e\u306f\u3001dpi\u3084BuildConfig\u306e\u5024\u306a\u3069\u3001\u30b3\u30de\u30f3\u30c9\u30e9\u30a4\u30f3\u4e0a\u304b\u3089\u78ba\u8a8d\u3067\u304d\u308b\u3068\u4fbf\u5229\u305d\u3046\u306a\u5024\u3092\u51fa\u529b\u3059\u308b\u30d7\u30e9\u30b0\u30a4\u30f3\u3002\n\n[info-dumper](https://github.com/shikato/info-dumper)\n\n![screen gif](http://38.media.tumblr.com/aa7134963258048bfe1758fbaa821111/tumblr_np2dmkXiOC1ro6w1ho1_500.gif)\n\n\u4eca\u306e\u3068\u3053\u308d\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u60c5\u5831\u3092\u8868\u793a\u3067\u304d\u308b\u3002\n\n| Command | Action |\n|:-----------|------------:|\n| buildconf   |BuildConfig fields.|\n| id     |AndroidID, UUID, Advertising ID. |\n| dpi       |dpi info. |\n| memory         |Memory info|\n| network    |Network info. |\n| permission       |Required permissions. |\n| lastupdate    | Lastupdate time. |\n| error    |    Error state info. |\n| tel    |     TelephonyManager info. |\n| appinfo    | android.content.pm.ApplicationInfo fields. |\n| osbuild    | android.os.Build fields.|\n| all    |     all. |\n\n\n## **\u6700\u5f8c\u306b**\nStetho\u304b\u306a\u308a\u4fbf\u5229\u3002dumpapp\u3082\u3063\u3068\u6d3b\u7528\u3057\u3066\u3044\u304d\u305f\u3044\u3002\n\u305b\u3063\u304b\u304f\u4f5c\u3063\u305fInfoDumperPlugin\u3082\u3001\u3082\u3046\u3061\u3087\u3063\u3068\u4fbf\u5229\u306b\u3057\u305f\u3044\u3002\n\n#### **\u30e1\u30e2**\nDevTools\u306bdumpapp\u304c\u7d44\u307f\u8fbc\u307e\u308c\u308b\u304b\u3082\uff1f\n\n\n```\nlynfogeek commented on 23 Feb\n\nThe DumperPlugins are great, but it would be even better to embed them into the DevTools.\nOne solution could be to create a new tab (like this extension does) , and list there all the enable plugins. Whenever the user click on one of them, it pulls the data and display it.\n```\n\uff08commented on 23 Feb\u3068\u306a\u3063\u3066\u308b\u306e\u3067\u671b\u307f\u8584\u304b\u3082\u3060\u3051\u3069\uff09\nhttps://github.com/facebook/stetho/issues/68\n", "tags": ["Android", "debug", "Chrome", "Facebook", "Stetho"]}