{"context": "\u30cf\u30f3\u30ba\u30aa\u30f3\u306e\u5f8c\u59cb\u672b\u3068\u3057\u3066\u3001\u4f7f\u308f\u306a\u3044\u30c9\u30e1\u30a4\u30f3\u306ehosted zone\u3092\u524a\u9664\u3057\u307e\u3059\u3002\n\n\u524d\u63d0\u6761\u4ef6\n\nRoute53\u3078\u306e\u6a29\u9650\nRoute53\u306b\u5bfe\u3057\u3066\u30d5\u30eb\u6a29\u9650\u304c\u3042\u308b\u3053\u3068\u3002\n\nAWS CLI\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\n\u4ee5\u4e0b\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u3067\u52d5\u4f5c\u78ba\u8a8d\u6e08\n\nAWS CLI 1.10.38\n\n\n\u30b3\u30de\u30f3\u30c9\naws --version\n\n\n\n\u7d50\u679c(\u4f8b)\n      aws-cli/1.10.38 Python/2.7.11 Darwin/15.5.0 botocore/1.4.28\n\n\n\n0. \u6e96\u5099\n\n0.1. \u30ea\u30fc\u30b8\u30e7\u30f3\u306e\u6c7a\u5b9a\n\u69cb\u7bc9\u3059\u308b\u30ea\u30fc\u30b8\u30e7\u30f3\u3092\u6c7a\u3081\u307e\u3059\u3002 (\u30ab\u30ec\u30f3\u30c8\u30e6\u30fc\u30b6\u304c\u5229\u7528\u3059\u308b\u30ab\u30ec\u30f3\u30c8\u30ea\u30fc\u30b8\u30e7\u30f3\u3082\u5207\u308a\u5909\u308f\u308a\u307e\u3059\u3002)\n\n\u30b3\u30de\u30f3\u30c9(\u6771\u4eac\u30ea\u30fc\u30b8\u30e7\u30f3\u306e\u5834\u5408)\nexport AWS_DEFAULT_REGION='ap-northeast-1'\n\n\n\n0.2. \u5909\u6570\u306e\u78ba\u8a8d\n\u30d7\u30ed\u30d5\u30a1\u30a4\u30eb\u304c\u60f3\u5b9a\u306e\u3082\u306e\u306b\u306a\u3063\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\n\n\u30b3\u30de\u30f3\u30c9\naws configure list\n\n\n\n\u7d50\u679c(\u4f8b)\n            Name                    Value             Type    Location\n            ----                    -----             ----    --------\n         profile         administrator-prjz-mbp13        env    AWS_DEFAULT_PROFILE\n      access_key     ****************XXXX shared-credentials-file\n      secret_key     ****************XXXX shared-credentials-file\n          region                         ap-northeast-1  env    AWS_DEFAULT_REGION\n\n\nAssumeRole\u3092\u5229\u7528\u3057\u3066\u3044\u308b\u5834\u5408\u306fprofile\u304c ''\u3068\u8868\u793a\u3055\u308c\u307e\u3059\u3002 \u305d\u308c\u4ee5\u5916\u306e\u3068\u304d\u306bprofile\u304c '' \u3068\u8868\u793a\u3055\u308c\u308b\u5834\u5408\u306f\u3001\u4ee5\u4e0b\u3092\u5b9f\u884c\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n\u5909\u6570\u306e\u8a2d\u5b9a\nexport AWS_DEFAULT_PROFILE=<IAM\u30e6\u30fc\u30b6\u540d>\n\n\n\n0.3. \u524a\u9664\u5bfe\u8c61\u30b5\u30d6\u30c9\u30e1\u30a4\u30f3\u306e\u6307\u5b9a\nRoute53\u304b\u3089\u524a\u9664\u3059\u308b\u30b5\u30d6\u30c9\u30e1\u30a4\u30f3\u3092\u6c7a\u3081\u307e\u3059\u3002\n\u30d0\u30b1\u30c3\u30c8\u306e\u4f5c\u6210 (\u72ec\u81ea\u30c9\u30e1\u30a4\u30f3)\n( http://qiita.com/tcsh/items/1f707443e667b6b3c8cf )\u3067\u72ec\u81ea\u30c9\u30e1\u30a4\u30f3\u7528\u306e\u30d0\u30b1\u30c3\u30c8\u304c\u5bfe\u8c61\u3067\u3042\u308c\u3070\u3001\u4e0b\u8a18\u306e\u3088\u3046\u306b\u5909\u6570\u306b\u30c9\u30e1\u30a4\u30f3\u540d\u3092\u683c\u7d0d\u3057\u307e\u3059\u3002\n\n\u5909\u6570\u306e\u8a2d\u5b9a\nR53_ZONE_NAME=\"${DOMAIN_NAME}\" \\\n        && echo ${R53_ZONE_NAME}\n\n\n\n0.4. hosted zone id\u306e\u53d6\u5f97\n\u524a\u9664\u3059\u308b\u30c9\u30e1\u30a4\u30f3\u306ehosted zone id\u3092\u53d6\u5f97\u3057\u307e\u3059\u3002\n\n\u30b3\u30de\u30f3\u30c9\nR53_ZONE_ID=$( \\\n        aws route53 list-hosted-zones \\\n          --query \"HostedZones[?Name == \\`${R53_ZONE_NAME}.\\`].Id\" \\\n          --output text \\\n        | sed 's/\\/hostedzone\\///' \\\n) && echo ${R53_ZONE_ID}\n\n\n\n\u7d50\u679c(\u4f8b)\n      Zxxxxxxxxxxxx\n\n\n\n1. \u4e8b\u524d\u4f5c\u696d\n(\u306a\u3057)\n\n2. \u5168\u30ec\u30b3\u30fc\u30c9\u306e\u524a\u9664\nhosted zone\u3092\u524a\u9664\u3059\u308b\u306b\u306f\u3001\u767b\u9332\u3055\u308c\u3066\u3044\u308b\u5168\u30ec\u30b3\u30fc\u30c9\u3092\u3042\u3089\u304b\u3058\u3081\u524a\u9664\u3057\u3066\u304a\u304f\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\n\n2.1. \u767b\u9332\u30ec\u30b3\u30fc\u30c9\u306e\u78ba\u8a8d\n\u767b\u9332\u30ec\u30b3\u30fc\u30c9\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\n\n\u30b3\u30de\u30f3\u30c9\naws route53 list-resource-record-sets \\\n        --hosted-zone-id /hostedzone/${R53_ZONE_ID} \\\n        --query 'ResourceRecordSets[?Type != `SOA`]'\n\n\n\n\u7d50\u679c(\u4f8b)\n      [\n        {\n          \"ResourceRecords\": [\n              {\n                  \"Value\": \"ns-xxx.awsdns-xx.co.uk.\"\n              },\n              {\n                  \"Value\": \"ns-xxx.awsdns-xx.net.\"\n              },\n              {\n                  \"Value\": \"ns-xxx.awsdns-xx.com.\"\n              },\n              {\n                  \"Value\": \"ns-xxx.awsdns-xx.org.\"\n              }\n          ],\n          \"Type\": \"NS\",\n          \"Name\": \"example.jp.\",\n          \"TTL\": 172800\n        },\n        {\n          \"AliasTarget\": {\n              \"HostedZoneId\": \"Z3BJ6K6RIION7M\",\n              \"EvaluateTargetHealth\": false,\n              \"DNSName\": \"s3-website-ap-northeast-1.amazonaws.com.\"\n          },\n          \"Type\": \"A\",\n          \"Name\": \"www.example.jp.\"\n        }\n      ]\n\n\n\u3053\u3053\u306b\u8868\u793a\u3055\u308c\u305f\u30ea\u30bd\u30fc\u30b9\u30ec\u30b3\u30fc\u30c9\u306e\u3046\u3061\u3001\u767b\u9332\u3057\u305f\u30be\u30fc\u30f3\u306eNS\u4ee5\u5916\u306e\u30ec\u30b3\u30fc\u30c9\u3092\u524a\u9664\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\n\n2.2. \u524a\u9664\u30ec\u30b3\u30fc\u30c9\u30bb\u30c3\u30c8\u306e\u4f5c\u6210\n\u524a\u9664\u3059\u308b\u30ea\u30bd\u30fc\u30b9\u30ec\u30b3\u30fc\u30c9\u30bb\u30c3\u30c8\u306e\u5b9a\u7fa9\u3092JSON\u5f62\u5f0f\u3067\u8a18\u8ff0\u3057\u307e\u3059\u3002\n\n\u5909\u6570\u306e\u8a2d\u5b9a\nR53_RRSET_NAME=\"www.${R53_ZONE_NAME}\"\nR53_RRSET_TYPE='A'\nR53_ACTION='DELETE'\nDNS_NAME='s3-website-ap-northeast-1.amazonaws.com.'\nFILE_INPUT='delete.json'\n\n\n\n\u5909\u6570\u306e\u8a2d\u5b9a\ncat << ETX\n\n        R53_RRSET_NAME: ${R53_RRSET_NAME}\n        R53_RRSET_TYPE: ${R53_RRSET_TYPE}\n        R53_ACTION:     ${R53_ACTION}\n        DNS_NAME:       ${DNS_NAME}\n        FILE_INPUT:     ${FILE_INPUT}\n\nETX\n\n\n\n\u30b3\u30de\u30f3\u30c9\ncat << EOF > ${FILE_INPUT}\n{\n        \"Changes\": [\n          {\n            \"Action\": \"${R53_ACTION}\",\n            \"ResourceRecordSet\": {\n              \"Name\": \"${R53_RRSET_NAME}.\",\n              \"Type\": \"${R53_RRSET_TYPE}\",\n              \"AliasTarget\": {\n                \"HostedZoneId\": \"${S3_HOSTED_ZONE_ID}\",\n                \"DNSName\": \"${DNS_NAME}\",\n                \"EvaluateTargetHealth\": false\n              }\n            }\n          }\n        ]\n}\nEOF\n\ncat ${FILE_INPUT}\n\n\nJSON\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u6210\u3057\u305f\u3089\u3001\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u304c\u58ca\u308c\u3066\u306a\u3044\u304b\u5fc5\u305a\u78ba\u8a8d\u3057\u307e\u3059\u3002\n\n\u30b3\u30de\u30f3\u30c9\njsonlint -q ${FILE_INPUT}\n\n\n\u30a8\u30e9\u30fc\u304c\u51fa\u529b\u3055\u308c\u306a\u3051\u308c\u3070OK\u3067\u3059\u3002\n\n2.3. \u30ec\u30b3\u30fc\u30c9\u306e\u524a\u9664\n\u5b9f\u969b\u306b\u30ec\u30b3\u30fc\u30c9\u3092\u524a\u9664\u3057\u307e\u3059\u3002\n\n\u5909\u6570\u306e\u78ba\u8a8d\ncat << ETX\n\n        R53_ZONE_ID: ${R53_ZONE_ID}\n        FILE_INPUT:  ${FILE_INPUT}\n\nETX\n\n\n\n\u30b3\u30de\u30f3\u30c9\naws route53 change-resource-record-sets \\\n        --hosted-zone-id ${R53_ZONE_ID} \\\n        --change-batch file://${FILE_INPUT}\n\n\n\n\u7d50\u679c(\u4f8b)\n      {\n          \"ChangeInfo\": {\n              \"Status\": \"PENDING\", \n              \"SubmittedAt\": \"2014-05-27T07:56:56.970Z\", \n              \"Id\": \"/change/CXXXXXXXXXXXXX\"\n          }\n      }\n\n\n\n2.4. \u7e70\u308a\u8fd4\u3057\n\u6b8b\u767b\u9332\u30ec\u30b3\u30fc\u30c9\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\n\n\u30b3\u30de\u30f3\u30c9\naws route53 list-resource-record-sets \\\n        --hosted-zone-id /hostedzone/${R53_ZONE_ID} \\\n        --query 'ResourceRecordSets[?Type != `SOA`]'\n\n\n\n\u7d50\u679c(\u4f8b)\n      [\n        {\n          \"ResourceRecords\": [\n              {\n                  \"Value\": \"ns-xxx.awsdns-xx.co.uk.\"\n              },\n              {\n                  \"Value\": \"ns-xxx.awsdns-xx.net.\"\n              },\n              {\n                  \"Value\": \"ns-xxx.awsdns-xx.com.\"\n              },\n              {\n                  \"Value\": \"ns-xxx.awsdns-xx.org.\"\n              }\n          ],\n          \"Type\": \"NS\",\n          \"Name\": \"example.jp.\",\n          \"TTL\": 172800\n        }\n      ]\n\n\n\u30be\u30fc\u30f3\u306eNS\u30ec\u30b3\u30fc\u30c9\u4ee5\u5916\u306e\u30ea\u30bd\u30fc\u30b9\u30ec\u30b3\u30fc\u30c9\u304c\u306a\u304f\u306a\u308b\u307e\u3067\u3001\u30ea\u30bd\u30fc\u30b9\u30ec\u30b3\u30fc\u30c9\u306e\u524a\u9664\u3092\u7e70\u308a\u8fd4\u3057\u307e\u3059\u3002\n\n3. hosted zone\u306e\u524a\u9664\nSOA\u30ec\u30b3\u30fc\u30c9\u3001NS\u30ec\u30b3\u30fc\u30c9\u4ee5\u5916\u306e\u30ea\u30bd\u30fc\u30b9\u30ec\u30b3\u30fc\u30c9\u3092\u524a\u9664\u304c\u5b8c\u4e86\u3057\u305f\u3089\u3001hosted zone\u3092\u524a\u9664\u3057\u307e\u3059\u3002\n\n\u5909\u6570\u306e\u78ba\u8a8d\ncat << ETX\n\n        R53_ZONE_ID: ${R53_ZONE_ID}\n\nETX\n\n\n\n\u30b3\u30de\u30f3\u30c9\naws route53 delete-hosted-zone \\\n        --id ${R53_ZONE_ID}\n\n\n\n\u7d50\u679c(\u4f8b)\n{\n        \"ChangeInfo\": {\n          \"Status\": \"PENDING\",\n          \"SubmittedAt\": \"6\u6708 20, 2016T01:23:45.678Z\",\n          \"Id\": \"/change/CXXXXXXXXXXXXX\"\n        }\n}\n\n\n\n4. \u4e8b\u5f8c\u4f5c\u696d\n\n\u524a\u9664\u78ba\u8a8d\n\u524a\u9664\u5bfe\u8c61\u306e\u30c9\u30e1\u30a4\u30f3\u304chosted zone\u306e\u4e00\u89a7\u306b\u7121\u3051\u308c\u3070\u3001\u524a\u9664\u306f\u5b8c\u4e86\u3057\u3066\u3044\u307e\u3059\u3002\n\n\u30b3\u30de\u30f3\u30c9\naws route53 list-hosted-zones \n\n\n\n\u7d50\u679c(\u4f8b)\n{\n    \"HostedZones\": []\n}\n\n\n\n\u5b8c\u4e86\n\u30cf\u30f3\u30ba\u30aa\u30f3\u306e\u5f8c\u59cb\u672b\u3068\u3057\u3066\u3001\u4f7f\u308f\u306a\u3044\u30c9\u30e1\u30a4\u30f3\u306ehosted zone\u3092\u524a\u9664\u3057\u307e\u3059\u3002\n\n\n\u524d\u63d0\u6761\u4ef6\n========\n\n\nRoute53\u3078\u306e\u6a29\u9650\n---------------\n\nRoute53\u306b\u5bfe\u3057\u3066\u30d5\u30eb\u6a29\u9650\u304c\u3042\u308b\u3053\u3068\u3002\n\n\nAWS CLI\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\n-------------------\n\n\u4ee5\u4e0b\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u3067\u52d5\u4f5c\u78ba\u8a8d\u6e08\n\n* AWS CLI 1.10.38\n\n```bash:\u30b3\u30de\u30f3\u30c9:\naws --version\n```\n\n```text:\u7d50\u679c(\u4f8b):\n      aws-cli/1.10.38 Python/2.7.11 Darwin/15.5.0 botocore/1.4.28\n```\n\n\n0. \u6e96\u5099\n=======\n\n\n0.1. \u30ea\u30fc\u30b8\u30e7\u30f3\u306e\u6c7a\u5b9a\n---------------------\n\n\u69cb\u7bc9\u3059\u308b\u30ea\u30fc\u30b8\u30e7\u30f3\u3092\u6c7a\u3081\u307e\u3059\u3002 (\u30ab\u30ec\u30f3\u30c8\u30e6\u30fc\u30b6\u304c\u5229\u7528\u3059\u308b\u30ab\u30ec\u30f3\u30c8\u30ea\u30fc\u30b8\u30e7\u30f3\u3082\u5207\u308a\u5909\u308f\u308a\u307e\u3059\u3002)\n\n```bash:\u30b3\u30de\u30f3\u30c9(\u6771\u4eac\u30ea\u30fc\u30b8\u30e7\u30f3\u306e\u5834\u5408):\nexport AWS_DEFAULT_REGION='ap-northeast-1'\n```\n\n\n0.2. \u5909\u6570\u306e\u78ba\u8a8d\n---------------\n\n\u30d7\u30ed\u30d5\u30a1\u30a4\u30eb\u304c\u60f3\u5b9a\u306e\u3082\u306e\u306b\u306a\u3063\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\n\n```bash:\u30b3\u30de\u30f3\u30c9:\naws configure list\n```\n\n```text:\u7d50\u679c(\u4f8b)\n            Name                    Value             Type    Location\n            ----                    -----             ----    --------\n         profile         administrator-prjz-mbp13        env    AWS_DEFAULT_PROFILE\n      access_key     ****************XXXX shared-credentials-file\n      secret_key     ****************XXXX shared-credentials-file\n          region                         ap-northeast-1  env    AWS_DEFAULT_REGION\n```\n\nAssumeRole\u3092\u5229\u7528\u3057\u3066\u3044\u308b\u5834\u5408\u306fprofile\u304c '<not set>'\u3068\u8868\u793a\u3055\u308c\u307e\u3059\u3002 \u305d\u308c\u4ee5\u5916\u306e\u3068\u304d\u306bprofile\u304c '<not set>' \u3068\u8868\u793a\u3055\u308c\u308b\u5834\u5408\u306f\u3001\u4ee5\u4e0b\u3092\u5b9f\u884c\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n```bash:\u5909\u6570\u306e\u8a2d\u5b9a:\nexport AWS_DEFAULT_PROFILE=<IAM\u30e6\u30fc\u30b6\u540d>\n```\n\n\n\n\n\n0.3. \u524a\u9664\u5bfe\u8c61\u30b5\u30d6\u30c9\u30e1\u30a4\u30f3\u306e\u6307\u5b9a\n-------------------------------\n\nRoute53\u304b\u3089\u524a\u9664\u3059\u308b\u30b5\u30d6\u30c9\u30e1\u30a4\u30f3\u3092\u6c7a\u3081\u307e\u3059\u3002\n\n\u30d0\u30b1\u30c3\u30c8\u306e\u4f5c\u6210 (\u72ec\u81ea\u30c9\u30e1\u30a4\u30f3)\n( http://qiita.com/tcsh/items/1f707443e667b6b3c8cf )\u3067\u72ec\u81ea\u30c9\u30e1\u30a4\u30f3\u7528\u306e\u30d0\u30b1\u30c3\u30c8\u304c\u5bfe\u8c61\u3067\u3042\u308c\u3070\u3001\u4e0b\u8a18\u306e\u3088\u3046\u306b\u5909\u6570\u306b\u30c9\u30e1\u30a4\u30f3\u540d\u3092\u683c\u7d0d\u3057\u307e\u3059\u3002\n\n```bash:\u5909\u6570\u306e\u8a2d\u5b9a:\nR53_ZONE_NAME=\"${DOMAIN_NAME}\" \\\n        && echo ${R53_ZONE_NAME}\n```\n\n\n\n\n0.4. hosted zone id\u306e\u53d6\u5f97\n-------------------------\n\n\u524a\u9664\u3059\u308b\u30c9\u30e1\u30a4\u30f3\u306ehosted zone id\u3092\u53d6\u5f97\u3057\u307e\u3059\u3002\n\n```bash:\u30b3\u30de\u30f3\u30c9:\nR53_ZONE_ID=$( \\\n        aws route53 list-hosted-zones \\\n          --query \"HostedZones[?Name == \\`${R53_ZONE_NAME}.\\`].Id\" \\\n          --output text \\\n        | sed 's/\\/hostedzone\\///' \\\n) && echo ${R53_ZONE_ID}\n```\n\n```text:\u7d50\u679c(\u4f8b):\n      Zxxxxxxxxxxxx\n```\n\n\n1. \u4e8b\u524d\u4f5c\u696d\n===========\n\n(\u306a\u3057)\n\n2. \u5168\u30ec\u30b3\u30fc\u30c9\u306e\u524a\u9664\n===================\n\nhosted zone\u3092\u524a\u9664\u3059\u308b\u306b\u306f\u3001\u767b\u9332\u3055\u308c\u3066\u3044\u308b\u5168\u30ec\u30b3\u30fc\u30c9\u3092\u3042\u3089\u304b\u3058\u3081\u524a\u9664\u3057\u3066\u304a\u304f\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\n\n\n2.1. \u767b\u9332\u30ec\u30b3\u30fc\u30c9\u306e\u78ba\u8a8d\n-----------------------\n\n\u767b\u9332\u30ec\u30b3\u30fc\u30c9\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\n\n```bash:\u30b3\u30de\u30f3\u30c9:\naws route53 list-resource-record-sets \\\n        --hosted-zone-id /hostedzone/${R53_ZONE_ID} \\\n        --query 'ResourceRecordSets[?Type != `SOA`]'\n```\n\n```json:\u7d50\u679c(\u4f8b)\n      [\n        {\n          \"ResourceRecords\": [\n              {\n                  \"Value\": \"ns-xxx.awsdns-xx.co.uk.\"\n              },\n              {\n                  \"Value\": \"ns-xxx.awsdns-xx.net.\"\n              },\n              {\n                  \"Value\": \"ns-xxx.awsdns-xx.com.\"\n              },\n              {\n                  \"Value\": \"ns-xxx.awsdns-xx.org.\"\n              }\n          ],\n          \"Type\": \"NS\",\n          \"Name\": \"example.jp.\",\n          \"TTL\": 172800\n        },\n        {\n          \"AliasTarget\": {\n              \"HostedZoneId\": \"Z3BJ6K6RIION7M\",\n              \"EvaluateTargetHealth\": false,\n              \"DNSName\": \"s3-website-ap-northeast-1.amazonaws.com.\"\n          },\n          \"Type\": \"A\",\n          \"Name\": \"www.example.jp.\"\n        }\n      ]\n```\n\n\u3053\u3053\u306b\u8868\u793a\u3055\u308c\u305f\u30ea\u30bd\u30fc\u30b9\u30ec\u30b3\u30fc\u30c9\u306e\u3046\u3061\u3001\u767b\u9332\u3057\u305f\u30be\u30fc\u30f3\u306eNS\u4ee5\u5916\u306e\u30ec\u30b3\u30fc\u30c9\u3092\u524a\u9664\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\n\n\n2.2. \u524a\u9664\u30ec\u30b3\u30fc\u30c9\u30bb\u30c3\u30c8\u306e\u4f5c\u6210\n-----------------------------\n\n\u524a\u9664\u3059\u308b\u30ea\u30bd\u30fc\u30b9\u30ec\u30b3\u30fc\u30c9\u30bb\u30c3\u30c8\u306e\u5b9a\u7fa9\u3092JSON\u5f62\u5f0f\u3067\u8a18\u8ff0\u3057\u307e\u3059\u3002\n\n```bash:\u5909\u6570\u306e\u8a2d\u5b9a:\nR53_RRSET_NAME=\"www.${R53_ZONE_NAME}\"\nR53_RRSET_TYPE='A'\nR53_ACTION='DELETE'\nDNS_NAME='s3-website-ap-northeast-1.amazonaws.com.'\nFILE_INPUT='delete.json'\n```\n\n```bash:\u5909\u6570\u306e\u8a2d\u5b9a:\ncat << ETX\n\n        R53_RRSET_NAME: ${R53_RRSET_NAME}\n        R53_RRSET_TYPE: ${R53_RRSET_TYPE}\n        R53_ACTION:     ${R53_ACTION}\n        DNS_NAME:       ${DNS_NAME}\n        FILE_INPUT:     ${FILE_INPUT}\n\nETX\n```\n\n```bash:\u30b3\u30de\u30f3\u30c9:\ncat << EOF > ${FILE_INPUT}\n{\n        \"Changes\": [\n          {\n            \"Action\": \"${R53_ACTION}\",\n            \"ResourceRecordSet\": {\n              \"Name\": \"${R53_RRSET_NAME}.\",\n              \"Type\": \"${R53_RRSET_TYPE}\",\n              \"AliasTarget\": {\n                \"HostedZoneId\": \"${S3_HOSTED_ZONE_ID}\",\n                \"DNSName\": \"${DNS_NAME}\",\n                \"EvaluateTargetHealth\": false\n              }\n            }\n          }\n        ]\n}\nEOF\n\ncat ${FILE_INPUT}\n```\n\nJSON\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u6210\u3057\u305f\u3089\u3001\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u304c\u58ca\u308c\u3066\u306a\u3044\u304b\u5fc5\u305a\u78ba\u8a8d\u3057\u307e\u3059\u3002\n\n```bash:\u30b3\u30de\u30f3\u30c9:\njsonlint -q ${FILE_INPUT}\n```\n\n\u30a8\u30e9\u30fc\u304c\u51fa\u529b\u3055\u308c\u306a\u3051\u308c\u3070OK\u3067\u3059\u3002\n\n\n2.3. \u30ec\u30b3\u30fc\u30c9\u306e\u524a\u9664\n-------------------\n\n\u5b9f\u969b\u306b\u30ec\u30b3\u30fc\u30c9\u3092\u524a\u9664\u3057\u307e\u3059\u3002\n\n```bash:\u5909\u6570\u306e\u78ba\u8a8d:\ncat << ETX\n\n        R53_ZONE_ID: ${R53_ZONE_ID}\n        FILE_INPUT:  ${FILE_INPUT}\n\nETX\n```\n\n```bash:\u30b3\u30de\u30f3\u30c9:\naws route53 change-resource-record-sets \\\n        --hosted-zone-id ${R53_ZONE_ID} \\\n        --change-batch file://${FILE_INPUT}\n```\n\n```json:\u7d50\u679c(\u4f8b):\n      {\n          \"ChangeInfo\": {\n              \"Status\": \"PENDING\", \n              \"SubmittedAt\": \"2014-05-27T07:56:56.970Z\", \n              \"Id\": \"/change/CXXXXXXXXXXXXX\"\n          }\n      }\n```\n\n\n2.4. \u7e70\u308a\u8fd4\u3057\n-------------\n\n\u6b8b\u767b\u9332\u30ec\u30b3\u30fc\u30c9\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\n\n```bash:\u30b3\u30de\u30f3\u30c9:\naws route53 list-resource-record-sets \\\n        --hosted-zone-id /hostedzone/${R53_ZONE_ID} \\\n        --query 'ResourceRecordSets[?Type != `SOA`]'\n```\n\n```json:\u7d50\u679c(\u4f8b)\n      [\n        {\n          \"ResourceRecords\": [\n              {\n                  \"Value\": \"ns-xxx.awsdns-xx.co.uk.\"\n              },\n              {\n                  \"Value\": \"ns-xxx.awsdns-xx.net.\"\n              },\n              {\n                  \"Value\": \"ns-xxx.awsdns-xx.com.\"\n              },\n              {\n                  \"Value\": \"ns-xxx.awsdns-xx.org.\"\n              }\n          ],\n          \"Type\": \"NS\",\n          \"Name\": \"example.jp.\",\n          \"TTL\": 172800\n        }\n      ]\n```\n\n\u30be\u30fc\u30f3\u306eNS\u30ec\u30b3\u30fc\u30c9\u4ee5\u5916\u306e\u30ea\u30bd\u30fc\u30b9\u30ec\u30b3\u30fc\u30c9\u304c\u306a\u304f\u306a\u308b\u307e\u3067\u3001\u30ea\u30bd\u30fc\u30b9\u30ec\u30b3\u30fc\u30c9\u306e\u524a\u9664\u3092\u7e70\u308a\u8fd4\u3057\u307e\u3059\u3002\n\n\n3. hosted zone\u306e\u524a\u9664\n====================\n\nSOA\u30ec\u30b3\u30fc\u30c9\u3001NS\u30ec\u30b3\u30fc\u30c9\u4ee5\u5916\u306e\u30ea\u30bd\u30fc\u30b9\u30ec\u30b3\u30fc\u30c9\u3092\u524a\u9664\u304c\u5b8c\u4e86\u3057\u305f\u3089\u3001hosted zone\u3092\u524a\u9664\u3057\u307e\u3059\u3002\n\n```bash:\u5909\u6570\u306e\u78ba\u8a8d:\ncat << ETX\n\n        R53_ZONE_ID: ${R53_ZONE_ID}\n\nETX\n```\n\n```bash:\u30b3\u30de\u30f3\u30c9:\naws route53 delete-hosted-zone \\\n        --id ${R53_ZONE_ID}\n```\n\n```json:\u7d50\u679c(\u4f8b):\n{\n        \"ChangeInfo\": {\n          \"Status\": \"PENDING\",\n          \"SubmittedAt\": \"6\u6708 20, 2016T01:23:45.678Z\",\n          \"Id\": \"/change/CXXXXXXXXXXXXX\"\n        }\n}\n```\n\n\n4. \u4e8b\u5f8c\u4f5c\u696d\n===========\n\n\n\u524a\u9664\u78ba\u8a8d\n--------\n\n\u524a\u9664\u5bfe\u8c61\u306e\u30c9\u30e1\u30a4\u30f3\u304chosted zone\u306e\u4e00\u89a7\u306b\u7121\u3051\u308c\u3070\u3001\u524a\u9664\u306f\u5b8c\u4e86\u3057\u3066\u3044\u307e\u3059\u3002\n\n```bash:\u30b3\u30de\u30f3\u30c9:\naws route53 list-hosted-zones \n```\n\n```json:\u7d50\u679c(\u4f8b):\n{\n    \"HostedZones\": []\n}\n```\n\n\u5b8c\u4e86\n====\n", "tags": ["AWS", "aws-cli", "route53"]}