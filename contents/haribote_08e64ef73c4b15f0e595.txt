{"context": "Web Storage \u3059\u306a\u308f\u3061\u3001 localStorage / sessionStorage \u3092\u7528\u3044\u305f\u6a5f\u80fd\u306e\u30c6\u30b9\u30c8\u3092\u624b\u8efd\u306b\u66f8\u304f\u8a71\u3067\u3059\u3002\nWeb Storage \u81ea\u4f53\u306f\u30d6\u30e9\u30a6\u30b6\u30cd\u30a4\u30c6\u30a3\u30d6\u306a\u6a5f\u80fd\u306a\u306e\u3067\u52d5\u3044\u3066\u5f53\u305f\u308a\u524d\u306a\u3093\u3060\u3051\u3069\u3001\u300cWeb Storage \u3092\u7528\u3044\u308b\u300d\u3068\u3044\u3046\u5b9f\u88c5\u4ed5\u69d8\u306f\u30c6\u30b9\u30c8\u306b\u66f8\u3044\u3066\u304a\u304d\u305f\u3044\u306e\u3067\u3059\u3002\n\u3059\u3050\u306b\u601d\u3044\u4ed8\u304f\u306e\u306f Sinon.js \u3067 spy \u3057\u305f\u308a\u3001\u30d8\u30c3\u30c9\u30ec\u30b9\u30d6\u30e9\u30a6\u30b6\u3067\u74b0\u5883\u3092\u518d\u73fe\u3059\u308b\u3001\u306a\u3069\u306e\u65b9\u6cd5\u3067\u3057\u3087\u3046\u304b\u3002\n\u3057\u304b\u3057\u4eca\u56de\u306f\u3001\u3088\u308a\u624b\u8efd\u306b Web Storage \u3092\u30e2\u30c3\u30af\u3057\u3066\u304f\u308c\u308b\u30d1\u30c3\u30b1\u30fc\u30b8\u3092\u4f7f\u3044\u307e\u3059\u3002  \n\nmock-local-storage\n\u4f7f\u7528\u3059\u308b\u30d1\u30c3\u30b1\u30fc\u30b8\u306f\u3053\u3061\u3089\u3002\nmocha \u3067\u5229\u7528\u3067\u304d\u307e\u3059\u3002\nhttps://github.com/letsrock-today/mock-local-storage\n\nMock lodcalStorage for headless unit tests\nInspired by StackOverflow answers and wrapped into rpm package to be used with mocha.\n\n\n\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\nnpm install mocha mock-local-storage babel-register --save-dev\n\n\u203b mocha \u672c\u4f53\u3068 babel \u95a2\u9023\u306f\u74b0\u5883\u306b\u5fdc\u3058\u3066\u9069\u5207\u306b\u3002\n\n\u30c6\u30b9\u30c8\u30b3\u30de\u30f3\u30c9\nmocha --compilers js:babel-register -r mock-local-storage\n\n\u203b \u4e0a\u8a18\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u30b3\u30de\u30f3\u30c9\u306e\u3088\u3046\u306b mocha \u3092\u30ed\u30fc\u30ab\u30eb\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u305f\u5834\u5408\u306f npm run-script \u7d4c\u7531\u306a\u3069\u3067\u8d77\u52d5\u3055\u305b\u308b\u3002\n\nmocha.opts\n\u81ea\u5206\u306e\u5834\u5408\u306f\u30c6\u30b9\u30c8\u3092 WebStorm \u304b\u3089\u7acb\u3061\u4e0a\u3052\u305f\u3044\u306e\u3067\u3001 mocha \u306e\u8d77\u52d5\u30aa\u30d7\u30b7\u30e7\u30f3\u306f mocha.opts \u306b\u66f8\u304d\u51fa\u3057\u3066\u3044\u307e\u3059\u3002\n\nmocha.opts\n--compilers js:babel-register --require mock-local-storage\n\n\n\n\u30e2\u30b8\u30e5\u30fc\u30eb\u3068\u30c6\u30b9\u30c8\u30b3\u30fc\u30c9\n\u826f\u304f\u3042\u308b Web Storage \u3092\u7528\u3044\u308b\u6a5f\u80fd\u3068\u3044\u3048\u3070 localStorage \u304b\u3089\u30c7\u30fc\u30bf\u3092\u547c\u3073\u51fa\u3059\u51e6\u7406\u3092 Promise \u3067\u30e9\u30c3\u30d7\u3057\u3066\u3042\u308b\u3082\u306e\u3067\u3057\u3087\u3046\u304b\u3002\n\u4f8b\u3048\u3070\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u30e2\u30b8\u30e5\u30fc\u30eb\u3067\u3059\u3002\n\nsrc/storage.js\nexport function loadDataFromLocalStorage(key = '') {\n  return new Promise((resolve, reject) => {\n    const loaded = localStorage.getItem(key);\n    if (loaded !== null) {\n      resolve(loaded);\n    } else {\n      reject(new Error('Not Found'));\n    }\n  });\n}\n\n\n\u3053\u306e\u30e2\u30b8\u30e5\u30fc\u30eb\u306b\u5bfe\u3059\u308b\u30c6\u30b9\u30c8\u30b3\u30fc\u30c9\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\n\ntest/test.js\nconst assert = require(\"power-assert\");\nimport { loadDataFromLocalStorage } from '../src/storage.js';\n\ndescribe('loadDataFromLocalStorage', () => {\n  const KEY   = 'knownKey';\n  const VALUE = 'value';\n\n  beforeEach(() => {\n    localStorage.setItem(KEY, VALUE);\n  });\n\n  afterEach(() => {\n    localStorage.clear();\n  });\n\n  it('should be DONE when load data from localStorage by KNOWN-KEY', () => {\n    return loadDataFromLocalStorage(KEY)\n      .then((response) => {\n        assert.equal(response, VALUE);\n      });\n  });\n\n  it('should be FAILED when load data from localStorage by UNKNOWN-KEY', () => {\n    return loadDataFromLocalStorage('unknownKey')\n      .catch((error) => {\n        assert.equal(error.message, 'Not Found');\n      });\n  });\n});\n\n\nPromise \u3068 localStorage \u3092\u4f7f\u3063\u3066\u3044\u308b\u306e\u3067\u30c6\u30b9\u30c8\u3092\u66f8\u304f\u306e\u306f\u3061\u3087\u3063\u3068\u9762\u5012\u306b\u601d\u3048\u307e\u3059\u304c\u3001 mocha \u3068 mock-local-storage \u3092\u7528\u3044\u308c\u3070\u3068\u3066\u3082\u7c21\u5358\u3067\u3059\u3002\nmock-local-storage \u306f mocha \u306e\u8d77\u52d5\u30aa\u30d7\u30b7\u30e7\u30f3\u3067\u4f9d\u5b58\u6ce8\u5165\u3055\u305b\u3066\u3044\u308b\u306e\u3067\u3001\u30c6\u30b9\u30c8\u30d5\u30a1\u30a4\u30eb\u3092\u8907\u6570\u306b\u5206\u3051\u305f\u3068\u3057\u3066\u3082\u3069\u3053\u304b\u3089\u3067\u3082 Web Storage \u306e\u30e2\u30c3\u30af\u3092\u5229\u7528\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\u308f\u3056\u308f\u3056\u81ea\u524d\u3067\u30e2\u30c3\u30af\u3092\u66f8\u304b\u306a\u304f\u3066\u826f\u3044\u306e\u3067\u3061\u3083\u3061\u3083\u3063\u3068\u30c6\u30b9\u30c8\u3092\u66f8\u304f\u3053\u3068\u304c\u3067\u304d\u307e\u3057\u305f\uff01\n\nWeb Storage \u3059\u306a\u308f\u3061\u3001 localStorage / sessionStorage \u3092\u7528\u3044\u305f\u6a5f\u80fd\u306e\u30c6\u30b9\u30c8\u3092\u624b\u8efd\u306b\u66f8\u304f\u8a71\u3067\u3059\u3002\nWeb Storage \u81ea\u4f53\u306f\u30d6\u30e9\u30a6\u30b6\u30cd\u30a4\u30c6\u30a3\u30d6\u306a\u6a5f\u80fd\u306a\u306e\u3067\u52d5\u3044\u3066\u5f53\u305f\u308a\u524d\u306a\u3093\u3060\u3051\u3069\u3001\u300cWeb Storage \u3092\u7528\u3044\u308b\u300d\u3068\u3044\u3046\u5b9f\u88c5\u4ed5\u69d8\u306f\u30c6\u30b9\u30c8\u306b\u66f8\u3044\u3066\u304a\u304d\u305f\u3044\u306e\u3067\u3059\u3002  \n\u3059\u3050\u306b\u601d\u3044\u4ed8\u304f\u306e\u306f Sinon.js \u3067 spy \u3057\u305f\u308a\u3001\u30d8\u30c3\u30c9\u30ec\u30b9\u30d6\u30e9\u30a6\u30b6\u3067\u74b0\u5883\u3092\u518d\u73fe\u3059\u308b\u3001\u306a\u3069\u306e\u65b9\u6cd5\u3067\u3057\u3087\u3046\u304b\u3002  \n\u3057\u304b\u3057\u4eca\u56de\u306f\u3001\u3088\u308a\u624b\u8efd\u306b Web Storage \u3092\u30e2\u30c3\u30af\u3057\u3066\u304f\u308c\u308b\u30d1\u30c3\u30b1\u30fc\u30b8\u3092\u4f7f\u3044\u307e\u3059\u3002  \n\n## mock-local-storage\n\u4f7f\u7528\u3059\u308b\u30d1\u30c3\u30b1\u30fc\u30b8\u306f\u3053\u3061\u3089\u3002\nmocha \u3067\u5229\u7528\u3067\u304d\u307e\u3059\u3002\nhttps://github.com/letsrock-today/mock-local-storage\n> Mock lodcalStorage for headless unit tests\n> Inspired by StackOverflow answers and wrapped into rpm package to be used with mocha.\n\n\n### \u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n```Bash\nnpm install mocha mock-local-storage babel-register --save-dev\n```\n\u203b mocha \u672c\u4f53\u3068 babel \u95a2\u9023\u306f\u74b0\u5883\u306b\u5fdc\u3058\u3066\u9069\u5207\u306b\u3002\n\n### \u30c6\u30b9\u30c8\u30b3\u30de\u30f3\u30c9\n```Bash\nmocha --compilers js:babel-register -r mock-local-storage\n```\n\u203b \u4e0a\u8a18\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u30b3\u30de\u30f3\u30c9\u306e\u3088\u3046\u306b mocha \u3092\u30ed\u30fc\u30ab\u30eb\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u305f\u5834\u5408\u306f ```npm run-script``` \u7d4c\u7531\u306a\u3069\u3067\u8d77\u52d5\u3055\u305b\u308b\u3002\n\n### mocha.opts\n\u81ea\u5206\u306e\u5834\u5408\u306f\u30c6\u30b9\u30c8\u3092 WebStorm \u304b\u3089\u7acb\u3061\u4e0a\u3052\u305f\u3044\u306e\u3067\u3001 mocha \u306e\u8d77\u52d5\u30aa\u30d7\u30b7\u30e7\u30f3\u306f ```mocha.opts``` \u306b\u66f8\u304d\u51fa\u3057\u3066\u3044\u307e\u3059\u3002\n\n```ini:mocha.opts\n--compilers js:babel-register --require mock-local-storage\n```\n\n## \u30e2\u30b8\u30e5\u30fc\u30eb\u3068\u30c6\u30b9\u30c8\u30b3\u30fc\u30c9\n\u826f\u304f\u3042\u308b Web Storage \u3092\u7528\u3044\u308b\u6a5f\u80fd\u3068\u3044\u3048\u3070 localStorage \u304b\u3089\u30c7\u30fc\u30bf\u3092\u547c\u3073\u51fa\u3059\u51e6\u7406\u3092 Promise \u3067\u30e9\u30c3\u30d7\u3057\u3066\u3042\u308b\u3082\u306e\u3067\u3057\u3087\u3046\u304b\u3002\n\u4f8b\u3048\u3070\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u30e2\u30b8\u30e5\u30fc\u30eb\u3067\u3059\u3002\n\n```JavaScript:src/storage.js\nexport function loadDataFromLocalStorage(key = '') {\n  return new Promise((resolve, reject) => {\n    const loaded = localStorage.getItem(key);\n    if (loaded !== null) {\n      resolve(loaded);\n    } else {\n      reject(new Error('Not Found'));\n    }\n  });\n}\n```\n\n\u3053\u306e\u30e2\u30b8\u30e5\u30fc\u30eb\u306b\u5bfe\u3059\u308b\u30c6\u30b9\u30c8\u30b3\u30fc\u30c9\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\n\n```JavaScript:test/test.js\nconst assert = require(\"power-assert\");\nimport { loadDataFromLocalStorage } from '../src/storage.js';\n\ndescribe('loadDataFromLocalStorage', () => {\n  const KEY   = 'knownKey';\n  const VALUE = 'value';\n\n  beforeEach(() => {\n    localStorage.setItem(KEY, VALUE);\n  });\n\n  afterEach(() => {\n    localStorage.clear();\n  });\n\n  it('should be DONE when load data from localStorage by KNOWN-KEY', () => {\n    return loadDataFromLocalStorage(KEY)\n      .then((response) => {\n        assert.equal(response, VALUE);\n      });\n  });\n\n  it('should be FAILED when load data from localStorage by UNKNOWN-KEY', () => {\n    return loadDataFromLocalStorage('unknownKey')\n      .catch((error) => {\n        assert.equal(error.message, 'Not Found');\n      });\n  });\n});\n```\n\nPromise \u3068 localStorage \u3092\u4f7f\u3063\u3066\u3044\u308b\u306e\u3067\u30c6\u30b9\u30c8\u3092\u66f8\u304f\u306e\u306f\u3061\u3087\u3063\u3068\u9762\u5012\u306b\u601d\u3048\u307e\u3059\u304c\u3001 mocha \u3068 mock-local-storage \u3092\u7528\u3044\u308c\u3070\u3068\u3066\u3082\u7c21\u5358\u3067\u3059\u3002\nmock-local-storage \u306f mocha \u306e\u8d77\u52d5\u30aa\u30d7\u30b7\u30e7\u30f3\u3067\u4f9d\u5b58\u6ce8\u5165\u3055\u305b\u3066\u3044\u308b\u306e\u3067\u3001\u30c6\u30b9\u30c8\u30d5\u30a1\u30a4\u30eb\u3092\u8907\u6570\u306b\u5206\u3051\u305f\u3068\u3057\u3066\u3082\u3069\u3053\u304b\u3089\u3067\u3082 Web Storage \u306e\u30e2\u30c3\u30af\u3092\u5229\u7528\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\u308f\u3056\u308f\u3056\u81ea\u524d\u3067\u30e2\u30c3\u30af\u3092\u66f8\u304b\u306a\u304f\u3066\u826f\u3044\u306e\u3067\u3061\u3083\u3061\u3083\u3063\u3068\u30c6\u30b9\u30c8\u3092\u66f8\u304f\u3053\u3068\u304c\u3067\u304d\u307e\u3057\u305f\uff01\n", "tags": ["JavaScript", "mocha"]}