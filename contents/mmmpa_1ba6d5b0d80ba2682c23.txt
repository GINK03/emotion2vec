{"context": " More than 1 year has passed since last update.Heroku\u3092\u3082\u3063\u3068\u8efd\u304f\u4f7f\u3063\u3066\u3044\u3053\u3046\u3068Sinatra\u3092\u3044\u3058\u3063\u3066\u3044\u307e\u3059\u3002\n\u305d\u3046\u306a\u308b\u3068\u8a8d\u8a3c\u304c\u554f\u984c\u3067\u3059\u304c\u3001\u624b\u306b\u99b4\u67d3\u3093\u3060Authlogic\u3092\u4f7f\u3044\u305f\u3044\u3068\u304a\u3082\u3044\u307e\u3057\u305f\u3002\n\u8efd\u304f\u3050\u3050\u3063\u305f\u3068\u3053\u308d\u3001\u30ed\u30b0\u30a4\u30f3\u30bb\u30c3\u30b7\u30e7\u30f3\u7ba1\u7406\u304c\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u4ed5\u69d8\u306e\u6642\u4ee3\u306e\u3082\u306e\u3060\u3051\u3060\u3063\u305f\u306e\u3067\u3001\u30e1\u30e2\u3092\u6b8b\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n\n\u30bd\u30fc\u30b9\u3068\u305d\u308c\u3092Heroku\u306b\u305d\u306e\u307e\u307e\u4e57\u305b\u305f\u3082\u306e\nmmmpa/authlogic_with_sinatra\nhttps://mmmpa-sinatra-authlogic.herokuapp.com\n\n\u30ad\u30e2\nAuthlogic\u306fSinatra\u3067\u3082\u4f7f\u3048\u308b\u3088\u3046\u306bSinatraAdapter\u3092\u6301\u3063\u3066\u304a\u308a\u3001\u81ea\u52d5\u3067include\u3055\u308c\u308b\u306e\u3067\u3001\u7279\u306b\u3084\u3084\u3053\u3057\u3044\u3053\u3068\u3092\u305b\u305a\u306b\u4f7f\u3048\u307e\u3059\u3002\n\u305f\u3060\u3057Sinatra\u3067\u30bb\u30c3\u30b7\u30e7\u30f3\u3092\u6709\u52b9\u306b\u3059\u308b\u306e\u3092\u5fd8\u308c\u308b\u3068\u3001\u81ea\u5206\u3067\u30af\u30c3\u30ad\u30fc\u3092\u98df\u308f\u305b\u305f\u308a\u3059\u308b\u30cf\u30e1\u306b\u306a\u3063\u3066\u7121\u99c4\u306a\u6642\u9593\u3092\u4f7f\u3046\u306e\u3067\u6c17\u3092\u3064\u3051\u307e\u3057\u3087\u3046\uff08\u4f7f\u3044\u307e\u3057\u305f\uff09\u3002\nenable :sessions\n\n\u3042\u3068\u306fSinatra\u3067ActiveRecord\u3092\u4f7f\u3048\u308b\u3088\u3046\u306b\u3059\u308c\u3070\u3001Rails\u3068\u307b\u307c\u540c\u3058\u624b\u9806\u3067\u6271\u3048\u307e\u3059\u306e\u3067\u3001\u4ee5\u4e0b\u306f\u86c7\u8db3\u307f\u305f\u3044\u306a\u5185\u5bb9\u3067\u3059\u3002\n\nActiveRecord\u306e\u6e96\u5099\n\n\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306e\u6e96\u5099\nconfig/database.yml\u306b\u8a2d\u5b9a\u3092\u66f8\u3044\u3066\u304a\u304f\u3068gem\u304c\u3088\u3057\u306a\u306b\u3057\u3066\u304f\u308c\u308b\u3088\u3046\u3067\u3059\u3002\nSinatra\u4ed5\u69d8\u3067\u3082Heroku\u306bpush\u3059\u308b\u3068\u81ea\u52d5\u306b\u3059\u3052\u304b\u3048\u3066\u304f\u308c\u308b\u306e\u3067\u4fbf\u5229\u3067\u3059\u306d\u3002\n\nconfig/database.yml\ndefault: &default\n  adapter: postgresql\n  encoding: unicode\n  pool: 5\n  username: <%= ENV['PG_USER'] %>\n  password: <%= ENV['PG_PASSWORD'] %>\n\ndevelopment:\n  <<: *default\n  database: <%= ENV['PG_DATABASE_NAME'] %>_development\n\n\n\n\u30de\u30a4\u30b0\u30ec\u30fc\u30b7\u30e7\u30f3\n\u4ee5\u4e0b\u3092\u3059\u308b\u3053\u3068\u306b\u3088\u308a\u3001\u304a\u306a\u3058\u307f\u306erake db:migrate\u306a\u3069\u304c\u4f7f\u3048\u307e\u3059\u3002\n\nGemfile\ngem 'sinatra-activerecord'\n\n\n\nRakefile\nrequire 'sinatra/activerecord'\nrequire 'sinatra/activerecord/rake'\n\n\n\u30de\u30a4\u30b0\u30ec\u30fc\u30b7\u30e7\u30f3\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u6210\u3059\u308b\u3002Authlogic\u306eattributes\u306f\u304a\u597d\u307f\u3067\u3002\nbundle exec rake:create_migration NAME=create_user\n\nclass CreateUser < ActiveRecord::Migration\n  def change\n    create_table :users do |t|\n      t.string :login, null: false\n      t.string :email, null: false\n\n      t.string :crypted_password, null: false\n      t.string :password_salt, null: false\n\n      t.string :persistence_token\n      t.string :single_access_token\n      t.string :perishable_token\n\n      t.integer :login_count, default: 0, null: false\n      t.integer :failed_login_count, default: 0, null: false\n      t.datetime :last_request_at\n      t.datetime :current_login_at\n      t.datetime :last_login_at\n      t.string :current_login_ip\n      t.string :last_login_ip\n\n      t.timestamps null: false\n    end\n  end\nend\n\n\nAuthlogic\u306e\u6e96\u5099\nRails\u3067\u4f7f\u3046\u3068\u304d\u3068\u8a2d\u5b9a\u5185\u5bb9\u306f\u540c\u3058\u3067\u3059\u3002\n\nUser\nrequire 'active_record'\nrequire 'authlogic'\n\nclass User < ActiveRecord::Base\n  acts_as_authentic do |config|\n    config.login_field = :login\n    config.require_password_confirmation = false\n  end\nend\n\n\nUserSession\nrequire 'authlogic'\n\nclass UserSession < Authlogic::Session::Base\nend\n\n\nSinatra\u306e\u6e96\u5099\n\n\u30bb\u30c3\u30b7\u30e7\u30f3\u3092\u6709\u52b9\u306b\n\u5927\u5207\u3067\u3059\u3002\u5fd8\u308c\u308b\u3068\u6642\u9593\u3092\u7121\u99c4\u306b\u8cbb\u3084\u3057\u307e\u3059\u3002\nenable :sessions\n\n\nSinatra+ActiveRecord\u3067\u767a\u751f\u3059\u308b\u30bf\u30a4\u30e0\u30a2\u30a6\u30c8\u5bfe\u7b56\u3092\nafter do\n  ActiveRecord::Base.connection.close\nend\n\n\n\u30eb\u30fc\u30c6\u30a3\u30f3\u30b0\n\u627f\u8a8d\u3042\u305f\u308a\u306f\u3053\u3093\u306a\u611f\u3058\u3067\u3002\nbefore '/room' do\n  redirect '/in' unless !!UserSession.find\nend\n\nbefore '/in' do\n  redirect '/room' if !!UserSession.find\nend\n\n\u4f5c\u6210\u3001\u30bb\u30c3\u30b7\u30e7\u30f3\u958b\u59cb\u306a\u3069\u306f\u3044\u3064\u3082\u306eAuthlogic\u3067\u3059\u3002\nauthlogic_with_sinatra/app.rb at master \u00b7 mmmpa/authlogic_with_sinatra\n\n\u3042\u3068\nAuthlogic\u306b\u9650\u3089\u305a\u3067\u3059\u304cCSRF\u5bfe\u7b56\u3068\u304b\u306a\u3044\u306e\u3067\u3001\u305d\u3053\u3089\u3078\u3093\u3092\u3069\u3046\u306b\u304b\u3057\u3066\u8efd\u304f\u52d5\u304b\u3057\u3066\u3044\u3051\u308b\u3088\u3046\u306b\u306a\u308a\u305f\u3044\u3002\nHeroku\u3092\u3082\u3063\u3068\u8efd\u304f\u4f7f\u3063\u3066\u3044\u3053\u3046\u3068Sinatra\u3092\u3044\u3058\u3063\u3066\u3044\u307e\u3059\u3002\n\n\u305d\u3046\u306a\u308b\u3068\u8a8d\u8a3c\u304c\u554f\u984c\u3067\u3059\u304c\u3001\u624b\u306b\u99b4\u67d3\u3093\u3060Authlogic\u3092\u4f7f\u3044\u305f\u3044\u3068\u304a\u3082\u3044\u307e\u3057\u305f\u3002\n\n\u8efd\u304f\u3050\u3050\u3063\u305f\u3068\u3053\u308d\u3001\u30ed\u30b0\u30a4\u30f3\u30bb\u30c3\u30b7\u30e7\u30f3\u7ba1\u7406\u304c\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u4ed5\u69d8\u306e\u6642\u4ee3\u306e\u3082\u306e\u3060\u3051\u3060\u3063\u305f\u306e\u3067\u3001\u30e1\u30e2\u3092\u6b8b\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n\n# \u30bd\u30fc\u30b9\u3068\u305d\u308c\u3092Heroku\u306b\u305d\u306e\u307e\u307e\u4e57\u305b\u305f\u3082\u306e\n\n[mmmpa/authlogic_with_sinatra](https://github.com/mmmpa/authlogic_with_sinatra)\n\n[https://mmmpa-sinatra-authlogic.herokuapp.com](https://mmmpa-sinatra-authlogic.herokuapp.com/)\n\n# \u30ad\u30e2\n\nAuthlogic\u306fSinatra\u3067\u3082\u4f7f\u3048\u308b\u3088\u3046\u306bSinatraAdapter\u3092\u6301\u3063\u3066\u304a\u308a\u3001\u81ea\u52d5\u3067include\u3055\u308c\u308b\u306e\u3067\u3001\u7279\u306b\u3084\u3084\u3053\u3057\u3044\u3053\u3068\u3092\u305b\u305a\u306b\u4f7f\u3048\u307e\u3059\u3002\n\n\u305f\u3060\u3057Sinatra\u3067\u30bb\u30c3\u30b7\u30e7\u30f3\u3092\u6709\u52b9\u306b\u3059\u308b\u306e\u3092\u5fd8\u308c\u308b\u3068\u3001\u81ea\u5206\u3067\u30af\u30c3\u30ad\u30fc\u3092\u98df\u308f\u305b\u305f\u308a\u3059\u308b\u30cf\u30e1\u306b\u306a\u3063\u3066\u7121\u99c4\u306a\u6642\u9593\u3092\u4f7f\u3046\u306e\u3067\u6c17\u3092\u3064\u3051\u307e\u3057\u3087\u3046\uff08\u4f7f\u3044\u307e\u3057\u305f\uff09\u3002\n\n```rb\nenable :sessions\n```\n\n\u3042\u3068\u306fSinatra\u3067ActiveRecord\u3092\u4f7f\u3048\u308b\u3088\u3046\u306b\u3059\u308c\u3070\u3001Rails\u3068\u307b\u307c\u540c\u3058\u624b\u9806\u3067\u6271\u3048\u307e\u3059\u306e\u3067\u3001\u4ee5\u4e0b\u306f\u86c7\u8db3\u307f\u305f\u3044\u306a\u5185\u5bb9\u3067\u3059\u3002\n\n# ActiveRecord\u306e\u6e96\u5099\n\n## \u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306e\u6e96\u5099\n\n`config/database.yml`\u306b\u8a2d\u5b9a\u3092\u66f8\u3044\u3066\u304a\u304f\u3068gem\u304c\u3088\u3057\u306a\u306b\u3057\u3066\u304f\u308c\u308b\u3088\u3046\u3067\u3059\u3002\n\nSinatra\u4ed5\u69d8\u3067\u3082Heroku\u306bpush\u3059\u308b\u3068\u81ea\u52d5\u306b\u3059\u3052\u304b\u3048\u3066\u304f\u308c\u308b\u306e\u3067\u4fbf\u5229\u3067\u3059\u306d\u3002\n\n```yaml:config/database.yml\ndefault: &default\n  adapter: postgresql\n  encoding: unicode\n  pool: 5\n  username: <%= ENV['PG_USER'] %>\n  password: <%= ENV['PG_PASSWORD'] %>\n\ndevelopment:\n  <<: *default\n  database: <%= ENV['PG_DATABASE_NAME'] %>_development\n```\n\n## \u30de\u30a4\u30b0\u30ec\u30fc\u30b7\u30e7\u30f3\n\n\u4ee5\u4e0b\u3092\u3059\u308b\u3053\u3068\u306b\u3088\u308a\u3001\u304a\u306a\u3058\u307f\u306e`rake db:migrate`\u306a\u3069\u304c\u4f7f\u3048\u307e\u3059\u3002\n\n```rb:Gemfile\ngem 'sinatra-activerecord'\n```\n\n```rb:Rakefile\nrequire 'sinatra/activerecord'\nrequire 'sinatra/activerecord/rake'\n```\n\n\u30de\u30a4\u30b0\u30ec\u30fc\u30b7\u30e7\u30f3\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u6210\u3059\u308b\u3002Authlogic\u306eattributes\u306f\u304a\u597d\u307f\u3067\u3002\n\n```\nbundle exec rake:create_migration NAME=create_user\n```\n\n```rb\nclass CreateUser < ActiveRecord::Migration\n  def change\n    create_table :users do |t|\n      t.string :login, null: false\n      t.string :email, null: false\n\n      t.string :crypted_password, null: false\n      t.string :password_salt, null: false\n\n      t.string :persistence_token\n      t.string :single_access_token\n      t.string :perishable_token\n\n      t.integer :login_count, default: 0, null: false\n      t.integer :failed_login_count, default: 0, null: false\n      t.datetime :last_request_at\n      t.datetime :current_login_at\n      t.datetime :last_login_at\n      t.string :current_login_ip\n      t.string :last_login_ip\n\n      t.timestamps null: false\n    end\n  end\nend\n```\n\n# Authlogic\u306e\u6e96\u5099\n\nRails\u3067\u4f7f\u3046\u3068\u304d\u3068\u8a2d\u5b9a\u5185\u5bb9\u306f\u540c\u3058\u3067\u3059\u3002\n\n## User\n\n```rb\nrequire 'active_record'\nrequire 'authlogic'\n\nclass User < ActiveRecord::Base\n  acts_as_authentic do |config|\n    config.login_field = :login\n    config.require_password_confirmation = false\n  end\nend\n```\n\n## UserSession\n\n```rb\nrequire 'authlogic'\n\nclass UserSession < Authlogic::Session::Base\nend\n```\n\n# Sinatra\u306e\u6e96\u5099\n\n## \u30bb\u30c3\u30b7\u30e7\u30f3\u3092\u6709\u52b9\u306b\n\n\u5927\u5207\u3067\u3059\u3002\u5fd8\u308c\u308b\u3068\u6642\u9593\u3092\u7121\u99c4\u306b\u8cbb\u3084\u3057\u307e\u3059\u3002\n\n```rb\nenable :sessions\n```\n\n## Sinatra+ActiveRecord\u3067\u767a\u751f\u3059\u308b\u30bf\u30a4\u30e0\u30a2\u30a6\u30c8\u5bfe\u7b56\u3092\n\n```rb\nafter do\n  ActiveRecord::Base.connection.close\nend\n```\n\n## \u30eb\u30fc\u30c6\u30a3\u30f3\u30b0\n\n\u627f\u8a8d\u3042\u305f\u308a\u306f\u3053\u3093\u306a\u611f\u3058\u3067\u3002\n\n```rb\nbefore '/room' do\n  redirect '/in' unless !!UserSession.find\nend\n\nbefore '/in' do\n  redirect '/room' if !!UserSession.find\nend\n```\n\n\u4f5c\u6210\u3001\u30bb\u30c3\u30b7\u30e7\u30f3\u958b\u59cb\u306a\u3069\u306f\u3044\u3064\u3082\u306eAuthlogic\u3067\u3059\u3002\n\n[authlogic_with_sinatra/app.rb at master \u00b7 mmmpa/authlogic_with_sinatra](https://github.com/mmmpa/authlogic_with_sinatra/blob/master/app.rb)\n\n# \u3042\u3068\n\nAuthlogic\u306b\u9650\u3089\u305a\u3067\u3059\u304cCSRF\u5bfe\u7b56\u3068\u304b\u306a\u3044\u306e\u3067\u3001\u305d\u3053\u3089\u3078\u3093\u3092\u3069\u3046\u306b\u304b\u3057\u3066\u8efd\u304f\u52d5\u304b\u3057\u3066\u3044\u3051\u308b\u3088\u3046\u306b\u306a\u308a\u305f\u3044\u3002\n", "tags": ["Sinatra", "Authlogic"]}