{"context": " More than 1 year has passed since last update.Controlled MCMC (Markov chain Monte Carlo) \u6cd5\u306f\u3001\u9069\u5fdc\u7684 MCMC (Adaptive MCMC) \u306e\u4e00\u7a2e\u3067\u3042\u308b\u3002AMCMC \u306f\u5909\u7570\u6226\u7565\u3092\u9069\u5fdc\u7684\u306b\u5909\u5316\u3055\u305b\u308b MCMC \u4e00\u822c\u306e\u3053\u3068\u3067\u3001CMCMC \u306f\u3042\u308b\u5909\u7570\u6226\u7565\u306e\u30d1\u30e9\u30e1\u30fc\u30bf\u3092\u9069\u5fdc\u7684\u306b\u5909\u5316\u3055\u305b\u308b MCMC \u306e\u3053\u3068\u3002\n\u53c2\u8003\u6587\u732e\u306e\u30d5\u30a9\u30c8\u30f3\u30c8\u30ec\u30fc\u30b7\u30f3\u30b0\u3067\u5229\u7528\u3055\u308c\u3066\u3044\u308b\u3002\n\n\u5b9a\u5f0f\u5316\n\u5909\u7570\u6226\u7565\u306e\u30d1\u30e9\u30e1\u30fc\u30bf \u03b8\\theta \u3092\n\\theta_{i+1} = \\theta_{i} + H(i, \\theta_{i}, \\{u_{i}\\}_{i=1}^{i})\n\u03b8i+1=\u03b8i+H(i,\u03b8i,{ui}ii=1){\\theta_{i+1} = \\theta_{i} + H(i, \\theta_{i}, \\{u_{i}\\}_{i=1}^{i})\n}\n\u3068\u3057\u3066\u8abf\u6574\u3059\u308b\u3053\u3068\u3092\u8003\u3048\u308b\u3002\n\u6761\u4ef6\u306e\u3072\u3068\u3064\u3068\u3057\u3066\n\\lim_{i \\rightarrow \\infty} H(i, \\theta_{i}, \\{u_{i}\\}_{i=1}^{i}) = 0\nlimi\u2192\u221eH(i,\u03b8i,{ui}ii=1)=0{\\lim_{i \\rightarrow \\infty} H(i, \\theta_{i}, \\{u_{i}\\}_{i=1}^{i}) = 0\n}\n\u3067\u3042\u308b\u5fc5\u8981\u304c\u3042\u308b\u3002\u3053\u308c\u3092\u6e1b\u8870\u9069\u5fdc\u6761\u4ef6 (diminishing adaptation condition) \u3068\u3044\u3046\u3002\n\u3082\u3046\u4e00\u3064\u306e\u6761\u4ef6\u3068\u3057\u3066\u3001\u512a\u53ce\u675f\u6761\u4ef6 (bounded convergence condition) \u304c\u3042\u308b\u3002\u3053\u308c\u306f\u72b6\u614b\u6570 (\u72b6\u614b\u7a7a\u9593\u00d7\u5909\u7570\u7a7a\u9593) \u304c\u6709\u9650\u3067\u3042\u308b\u3053\u3068\u3092\u8981\u8acb\u3057\u3066\u3044\u308b\u304c\u3001\u30b3\u30f3\u30d4\u30e5\u30fc\u30bf\u3067\u6d6e\u52d5\u5c0f\u6570\u70b9\u6570\u3092\u6271\u3046\u9650\u308a\u306f\u6e80\u305f\u3055\u308c\u308b\u306e\u3067\u6c17\u306b\u3057\u306a\u304f\u3066\u3082\u3088\u3044\u3002\n\n\u5fdc\u7528\u4f8b\n\u76ee\u6a19\u3068\u3059\u308b\u53d7\u7406\u78ba\u7387 A\u2217A^{*} \u306b\u3042\u3046\u3088\u3046\u306b\u30d1\u30e9\u30e1\u30bf\u30fc\u3092\u8abf\u6574\u3059\u308b\u65b9\u6cd5\u304c\u8003\u3048\u3089\u308c\u308b\u3002\n\\theta_{i+1} = \\theta_{i} + H(i, A^{*}, A_{i})\n\u03b8i+1=\u03b8i+H(i,A\u2217,Ai){\\theta_{i+1} = \\theta_{i} + H(i, A^{*}, A_{i})\n}\n\u3053\u3053\u3067 AiA_{i} \u306f ii \u756a\u76ee\u306e\u30b5\u30f3\u30d7\u30eb\u306e\u53d7\u7406\u78ba\u7387\u3067\u3042\u308b\u3002A\u2217A^{*} \u306f 0.2340.234 \u7a0b\u5ea6\u306b\u8a2d\u5b9a\u3059\u308b\u3068\u3088\u3044\u3089\u3057\u3044\u3002\n\u30e9\u30f3\u30c0\u30e0\u5909\u7570\u306b\u3088\u308b\u30b5\u30f3\u30d7\u30eb uu \u306b\u5bfe\u3059\u308b\u6442\u52d5\u5e45\u3092\n\\Delta u = \\textrm{sgn}(2 \\xi_{0} - 1) \\xi_{1}^{1 + \\frac{1}{\\theta_{i}}}\n\u0394u=sgn(2\u03be0\u22121)\u03be1+1\u03b8i1{\\Delta u = \\textrm{sgn}(2 \\xi_{0} - 1) \\xi_{1}^{1 + \\frac{1}{\\theta_{i}}}\n}\n\u3068\u3059\u308b\u3002\u03be0\\xi_{0} \u304a\u3088\u3073 \u03be1\\xi_{1} \u306f (0,1)(0,1) \u306e\u4e00\u69d8\u4e71\u6570\u3002\u03b8i\\theta_{i} \u304c\u8abf\u6574\u5bfe\u8c61\u306e\u30d1\u30e9\u30e1\u30fc\u30bf\u3067\u3042\u308b (\u03b8i=\u221e\\theta_{i} = \\infty \u3067\u4e00\u69d8\u5206\u5e03\u306b\u306a\u308b)\u3002\nH(i, A^{*}, A_{i}) = \\gamma_{i} (A_{i} - A^{*})\nH(i,A\u2217,Ai)=\u03b3i(Ai\u2212A\u2217){H(i, A^{*}, A_{i}) = \\gamma_{i} (A_{i} - A^{*})\n}\n\u3068\u3057\u3066\u3001limi\u2192\u221eH=0\\lim_{i \\rightarrow \\infty} H = 0\u306e\u6761\u4ef6\u3092\u6e80\u305f\u3059\u305f\u3081\u306b \u03b3i=1i\\gamma_{i} = \\frac{1}{i} \u3068\u3059\u308b\u3002\u307e\u305f\u3001\u03b81=1\\theta_{1} = 1 \u3068\u3059\u308b\u3002\n\u53d7\u7406\u78ba\u7387\u306f\u3001\u6442\u52d5\u5e45\u304c\u5e83\u3044\u3068\u4e0b\u304c\u308a\u3001\u72ed\u3044\u3068\u4e0a\u304c\u308b\u3068\u3044\u3046\u4eee\u5b9a\u306e\u3082\u3068\u306e\u5b9a\u5f0f\u5316\u306b\u306a\u3063\u3066\u3044\u308b\u3002\n\n\u64ec\u4f3c\u30b3\u30fc\u30c9\n# \u521d\u671f\u5316\nu     = uniform() # \u30b5\u30f3\u30d7\u30eb\ntheta = 1         # \u6442\u52d5\u30d1\u30e9\u30e1\u30fc\u30bf\nac    = 0         # \u5909\u7570\u306e\u53d7\u7406\u56de\u6570 (accept count)\n\n# \u30b5\u30f3\u30d7\u30ea\u30f3\u30b0\nfor i = 1:N\n  v = u + sign(2*rand()-1) * rand()^(1 + 1/theta) # \u5909\u7570\n  if (rand() < acceptance_ratio(u, v)) {\n    u = v\n    ac++\n  }\n  # A = ac / i, and then\n  # theta += (A - 0.234) / i;\n  theta += (ac - 0.234 * i) / (i * i);\nend\n\n\n\u53c2\u8003\u6587\u732e\n\nT. Hachisuka and H. W. Jensen: \"Robust Adaptive Photon Tracing using Photon Path Visibility,\" ACM Transactions on Graphics, Volume 30, Issue 5, 2011.\n\nControlled MCMC (Markov chain Monte Carlo) \u6cd5\u306f\u3001\u9069\u5fdc\u7684 MCMC (Adaptive MCMC) \u306e\u4e00\u7a2e\u3067\u3042\u308b\u3002AMCMC \u306f\u5909\u7570\u6226\u7565\u3092\u9069\u5fdc\u7684\u306b\u5909\u5316\u3055\u305b\u308b MCMC \u4e00\u822c\u306e\u3053\u3068\u3067\u3001CMCMC \u306f\u3042\u308b\u5909\u7570\u6226\u7565\u306e\u30d1\u30e9\u30e1\u30fc\u30bf\u3092\u9069\u5fdc\u7684\u306b\u5909\u5316\u3055\u305b\u308b MCMC \u306e\u3053\u3068\u3002\n\n\u53c2\u8003\u6587\u732e\u306e\u30d5\u30a9\u30c8\u30f3\u30c8\u30ec\u30fc\u30b7\u30f3\u30b0\u3067\u5229\u7528\u3055\u308c\u3066\u3044\u308b\u3002\n\n# \u5b9a\u5f0f\u5316\n\n\u5909\u7570\u6226\u7565\u306e\u30d1\u30e9\u30e1\u30fc\u30bf $\\theta$ \u3092\n\n~~~math\n\\theta_{i+1} = \\theta_{i} + H(i, \\theta_{i}, \\{u_{i}\\}_{i=1}^{i})\n~~~\n\n\u3068\u3057\u3066\u8abf\u6574\u3059\u308b\u3053\u3068\u3092\u8003\u3048\u308b\u3002\n\n\u6761\u4ef6\u306e\u3072\u3068\u3064\u3068\u3057\u3066\n\n~~~math\n\\lim_{i \\rightarrow \\infty} H(i, \\theta_{i}, \\{u_{i}\\}_{i=1}^{i}) = 0\n~~~\n\n\u3067\u3042\u308b\u5fc5\u8981\u304c\u3042\u308b\u3002\u3053\u308c\u3092\u6e1b\u8870\u9069\u5fdc\u6761\u4ef6 (diminishing adaptation condition) \u3068\u3044\u3046\u3002\n\n\u3082\u3046\u4e00\u3064\u306e\u6761\u4ef6\u3068\u3057\u3066\u3001\u512a\u53ce\u675f\u6761\u4ef6 (bounded convergence condition) \u304c\u3042\u308b\u3002\u3053\u308c\u306f\u72b6\u614b\u6570 (\u72b6\u614b\u7a7a\u9593\u00d7\u5909\u7570\u7a7a\u9593) \u304c\u6709\u9650\u3067\u3042\u308b\u3053\u3068\u3092\u8981\u8acb\u3057\u3066\u3044\u308b\u304c\u3001\u30b3\u30f3\u30d4\u30e5\u30fc\u30bf\u3067\u6d6e\u52d5\u5c0f\u6570\u70b9\u6570\u3092\u6271\u3046\u9650\u308a\u306f\u6e80\u305f\u3055\u308c\u308b\u306e\u3067\u6c17\u306b\u3057\u306a\u304f\u3066\u3082\u3088\u3044\u3002\n\n# \u5fdc\u7528\u4f8b\n\n\u76ee\u6a19\u3068\u3059\u308b\u53d7\u7406\u78ba\u7387 $A^{*}$ \u306b\u3042\u3046\u3088\u3046\u306b\u30d1\u30e9\u30e1\u30bf\u30fc\u3092\u8abf\u6574\u3059\u308b\u65b9\u6cd5\u304c\u8003\u3048\u3089\u308c\u308b\u3002\n\n~~~math\n\\theta_{i+1} = \\theta_{i} + H(i, A^{*}, A_{i})\n~~~\n\n\u3053\u3053\u3067 $A_{i}$ \u306f $i$ \u756a\u76ee\u306e\u30b5\u30f3\u30d7\u30eb\u306e\u53d7\u7406\u78ba\u7387\u3067\u3042\u308b\u3002$A^{*}$ \u306f $0.234$ \u7a0b\u5ea6\u306b\u8a2d\u5b9a\u3059\u308b\u3068\u3088\u3044\u3089\u3057\u3044\u3002\n\n\u30e9\u30f3\u30c0\u30e0\u5909\u7570\u306b\u3088\u308b\u30b5\u30f3\u30d7\u30eb $u$ \u306b\u5bfe\u3059\u308b\u6442\u52d5\u5e45\u3092\n\n~~~math\n\\Delta u = \\textrm{sgn}(2 \\xi_{0} - 1) \\xi_{1}^{1 + \\frac{1}{\\theta_{i}}}\n~~~\n\n\u3068\u3059\u308b\u3002$\\xi_{0}$ \u304a\u3088\u3073 $\\xi_{1}$ \u306f $(0,1)$ \u306e\u4e00\u69d8\u4e71\u6570\u3002$\\theta_{i}$ \u304c\u8abf\u6574\u5bfe\u8c61\u306e\u30d1\u30e9\u30e1\u30fc\u30bf\u3067\u3042\u308b ($\\theta_{i} = \\infty$ \u3067\u4e00\u69d8\u5206\u5e03\u306b\u306a\u308b)\u3002\n\n~~~math\nH(i, A^{*}, A_{i}) = \\gamma_{i} (A_{i} - A^{*})\n~~~\n\n\u3068\u3057\u3066\u3001$\\lim_{i \\rightarrow \\infty} H = 0$\u306e\u6761\u4ef6\u3092\u6e80\u305f\u3059\u305f\u3081\u306b $\\gamma_{i} = \\frac{1}{i}$ \u3068\u3059\u308b\u3002\u307e\u305f\u3001$\\theta_{1} = 1$ \u3068\u3059\u308b\u3002\n\n\u53d7\u7406\u78ba\u7387\u306f\u3001\u6442\u52d5\u5e45\u304c\u5e83\u3044\u3068\u4e0b\u304c\u308a\u3001\u72ed\u3044\u3068\u4e0a\u304c\u308b\u3068\u3044\u3046\u4eee\u5b9a\u306e\u3082\u3068\u306e\u5b9a\u5f0f\u5316\u306b\u306a\u3063\u3066\u3044\u308b\u3002\n\n# \u64ec\u4f3c\u30b3\u30fc\u30c9\n\n~~~julia\n# \u521d\u671f\u5316\nu     = uniform() # \u30b5\u30f3\u30d7\u30eb\ntheta = 1         # \u6442\u52d5\u30d1\u30e9\u30e1\u30fc\u30bf\nac    = 0         # \u5909\u7570\u306e\u53d7\u7406\u56de\u6570 (accept count)\n\n# \u30b5\u30f3\u30d7\u30ea\u30f3\u30b0\nfor i = 1:N\n  v = u + sign(2*rand()-1) * rand()^(1 + 1/theta) # \u5909\u7570\n  if (rand() < acceptance_ratio(u, v)) {\n    u = v\n    ac++\n  }\n  # A = ac / i, and then\n  # theta += (A - 0.234) / i;\n  theta += (ac - 0.234 * i) / (i * i);\nend\n~~~\n\n# \u53c2\u8003\u6587\u732e\n\n0. T. Hachisuka and H. W. Jensen: \"[Robust Adaptive Photon Tracing using Photon Path Visibility](http://www.ci.i.u-tokyo.ac.jp/~hachisuka/),\" ACM Transactions on Graphics, Volume 30, Issue 5, 2011.\n", "tags": ["3DCG", "\u7269\u7406\u30d9\u30fc\u30b9\u30ec\u30f3\u30c0\u30ea\u30f3\u30b0"]}