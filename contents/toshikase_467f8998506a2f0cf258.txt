{"context": "\u524d\u56de\u306fSolidity\u306e\u4f7f\u3044\u65b9\u306b\u3064\u3044\u3066\u3054\u8aac\u660e\u3057\u307e\u3057\u305f\u3002\u4eca\u56de\u306fSolidity\u3092\u7528\u3044\u3066\u30aa\u30d7\u30b7\u30e7\u30f3\u53d6\u5f15\u3092\u5b9f\u88c5\u3057\u3066\u307f\u307e\u3057\u3087\u3046\u3002\n\n\u30b3\u30f3\u30c8\u30e9\u30af\u30c8\u6982\u8981\n\u4eca\u56de\u306f\u30b3\u30fc\u30eb\u30fb\u30aa\u30d7\u30b7\u30e7\u30f3\u3092\u5b9f\u88c5\u3057\u307e\u3059\u3002\u30b3\u30fc\u30eb\u30fb\u30aa\u30d7\u30b7\u30e7\u30f3\u3068\u306f\u3042\u308b\u8cc7\u7523\u3092\u8cb7\u3046\u6a29\u5229\u306e\u3053\u3068\u3067\u3059\u3002(\u3061\u306a\u307f\u306b\u3042\u308b\u8cc7\u7523\u3092\u58f2\u308b\u6a29\u5229\u3092\u30d7\u30c3\u30c8\u30fb\u30aa\u30d7\u30b7\u30e7\u30f3\u3068\u3044\u3044\u307e\u3059)\u3002\n\u30b3\u30fc\u30eb\u30fb\u30aa\u30d7\u30b7\u30e7\u30f3\u306e\u30ab\u30e9\u30e0\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u3057\u307e\u3059\u3002\n\n\n\nkey\nvalue\n\n\n\n\n\u8cc7\u7523\n\u30d3\u30c3\u30c8\u30b3\u30a4\u30f3\n\n\n\u6570\u91cf\n1\n\n\n\u6a29\u5229\u884c\u4f7f\u4fa1\u683c\n\u00a550,000\n\n\n\u30d7\u30ec\u30df\u30a2\u30e0\n\u00a55,000\n\n\n\u671f\u65e5\n1463127335\n\n\n\u58f2\u308a\u624b\n0xfffe72483eb0bc804295af2416d2aeb4fa15a8bc\n\n\n\u8cb7\u3044\u624b\n0x0e7b3774402f2f19a05e7a279238a4a1fe5e2bc0\n\n\n\n\u203b1463127335\u306f2016/05/13 8:15am(UTC)\u306eUNIX TimeStamp\u3067\u3059\n\u4ee5\u4e0b\u304c\u5b8c\u6210\u5f62\u306e\u30b3\u30fc\u30c9\u3067\u3059\n\ncall_option.sol\ncontract CallOption{\n    address public buyer;\n    address public seller;\n    uint public btc_amount;\n    uint public btc_price;\n    uint public premium;\n    uint public exercise_date;\n    mapping (address => uint) public balanceOfJPY;\n    mapping (address => uint) public balanceOfBTC;\n    function CallOption(\n      address _seller,\n      uint _seller_jpy,\n      uint _seller_btc,\n      uint _btc_price,\n      uint _btc_amount,\n      uint _premium,\n      uint _exercise_date\n      ){\n      seller = _seller;\n      balanceOfJPY[seller] = _seller_jpy;\n      balanceOfBTC[seller] = _seller_btc;\n      btc_price = _btc_price;\n      btc_amount = _btc_amount;\n      premium = _premium;\n      exercise_date = _exercise_date;\n    }\n    function Respond (address _buyer, uint _buyer_jpy) {\n      buyer = _buyer;\n      balanceOfJPY[buyer] = _buyer_jpy;\n      if (balanceOfJPY[buyer] < premium + btc_amount * btc_price) throw;\n      balanceOfJPY[buyer] -= premium;\n      balanceOfJPY[seller] += premium;\n    }\n    function Expire (uint _current_btc_price, uint _current_time){\n      if (_current_time < exercise_date) throw;\n      if (_current_btc_price < btc_price) throw;\n      balanceOfJPY[buyer] -= btc_price * btc_amount;\n      balanceOfJPY[seller] += btc_price * btc_amount;\n      balanceOfBTC[buyer] += btc_amount;\n      balanceOfBTC[seller] -= btc_amount;\n    }\n    function () {\n      throw;\n    }\n}\n\n\n\nCallOption\uff1a\u521d\u671f\u5316(\u4eca\u56de\u306f\u3001\u30aa\u30d7\u30b7\u30e7\u30f3\u306e\u767a\u884c\u4e3b\u4f53\u306f\u5e38\u306b\u58f2\u308a\u624b\u3068\u3057\u307e\u3059\u3002)\nRespond\uff1a\u8cb7\u3044\u624b\u306e\u767b\u9332\nExpire\uff1a\u30aa\u30d7\u30b7\u30e7\u30f3\u5b9f\u884c\n\n\n\u30b3\u30f3\u30c8\u30e9\u30af\u30c8\u767b\u9332\n\u307e\u305a\u30b3\u30fc\u30c9\u3092\u30b3\u30f3\u30d1\u30a4\u30eb\u3057\u307e\u3059\u3002\n> var source = \"contract CallOption{    address public buyer;    address public seller;    uint public btc_amount;    uint public btc_price;    uint public premium;    uint public exercise_date;    mapping (address => uint) public balanceOfJPY;    mapping (address => uint) public balanceOfBTC;    function CallOption(      address _seller,      uint _seller_jpy,      uint _seller_btc,      uint _btc_price,      uint _btc_amount,      uint _premium,      uint _exercise_date      ){      seller = _seller;      balanceOfJPY[seller] = _seller_jpy;      balanceOfBTC[seller] = _seller_btc;      btc_price = _btc_price;      btc_amount = _btc_amount;      premium = _premium;      exercise_date = _exercise_date;    }    function Respond (address _buyer, uint _buyer_jpy) {      buyer = _buyer;      balanceOfJPY[buyer] = _buyer_jpy;      if (balanceOfJPY[buyer] < premium + btc_amount * btc_price) throw;      balanceOfJPY[buyer] -= premium;      balanceOfJPY[seller] += premium;    }    function Expire (uint _current_btc_price, uint _current_time){      if (_current_time < exercise_date) throw;      if (_current_btc_price < btc_price) throw;      balanceOfJPY[buyer] -= btc_price * btc_amount;      balanceOfJPY[seller] += btc_price * btc_amount;      balanceOfBTC[buyer] += btc_amount;      balanceOfBTC[seller] -= btc_amount;    }    function () {      throw;    }}\"\n> var compiledSource = eth.compile.solidity(source)\n\n\u7d9a\u3044\u3066\u3001\u30b3\u30f3\u30c8\u30e9\u30af\u30c8\u3092Ethereum\u306e\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306b\u9001\u4fe1\u3057\u307e\u3059\u3002\n> var abiDefinition = compiledSource.CallOption.info.abiDefinition\n> var compiledContract = eth.contract(abiDefinition)\n> var seller = \"0xfffe72483eb0bc804295af2416d2aeb4fa15a8bc\"\n> var buyer = \"0x0e7b3774402f2f19a05e7a279238a4a1fe5e2bc0\"\n> var contract = compiledContract.new(seller, 100000, 1,  50000, 1, 1463127335, {from: seller, data: compiledSource.CallOption.code, gas:1000000})\n\n\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u30b3\u30f3\u30c8\u30e9\u30af\u30c8\u304c\u9001\u4fe1\u3055\u308c\u307e\u3057\u305f\u3002\n\u3057\u304b\u3057\u307e\u3060\u30de\u30a4\u30cb\u30f3\u30b0\u3055\u308c\u3066\u3044\u306a\u3044\u306e\u3067\u3001\u30a2\u30c9\u30ec\u30b9\u306f\u5272\u308a\u5f53\u3066\u3089\u308c\u3066\u3044\u307e\u305b\u3093\u3002\n> contract\n{\n  address: undefined,\n  transactionHash: \"0xf194ae6298b85b7fa6b0a9b75d115181ffb44ef546e4da9bcd970b943b01fa02\"\n}\n\n\u30de\u30a4\u30cb\u30f3\u30b0\u304c\u5b8c\u4e86\u3059\u308b\u3068\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\u30a2\u30c9\u30ec\u30b9\u304c\u4ed8\u4e0e\u3055\u308c\u308b\u3066\u3044\u308b\u306e\u304c\u308f\u304b\u308a\u307e\u3059\u3002\n> contract\n{\n  address: \"0x0bc2c62ecc340e0a4606d087f2d9d9afe0ef16d6\",\n  transactionHash: \"0xf194ae6298b85b7fa6b0a9b75d115181ffb44ef546e4da9bcd970b943b01fa02\",\n  Expire: function(),\n  Respond: function(),\n  allEvents: function(),\n  balanceOfBTC: function(),\n  balanceOfJPY: function(),\n  btc_amount: function(),\n  btc_price: function(),\n  buyer: function(),\n  exercise_date: function(),\n  premium: function(),\n  seller: function()\n}\n\n\n\nRespond\u30e1\u30bd\u30c3\u30c9\n\u521d\u671f\u5316\u304c\u5b8c\u4e86\u3057\u307e\u3057\u305f\u3002\u7d9a\u3044\u3066Respond\u30e1\u30bd\u30c3\u30c9\u3092\u5b9f\u884c\u3057\u307e\u3057\u3087\u3046\u3002\n\u4ee5\u4e0b\u304c\u30b3\u30fc\u30c9\u3067\u3059\u3002\u7b2c\u4e00\u5f15\u6570\u306f\u8cb7\u3044\u624b\u306e\u30a2\u30c9\u30ec\u30b9\u3001\u7b2c\u4e8c\u5f15\u6570\u306f\u8cb7\u3044\u624b\u306eJPY\u6b8b\u9ad8\u3092\u8868\u3057\u3066\u3044\u307e\u3059\u3002\n function Respond (address _buyer, uint _buyer_jpy) {\n      buyer = _buyer;\n      balanceOfJPY[buyer] = _buyer_jpy;\n      if (balanceOfJPY[buyer] < premium + btc_amount * btc_price) throw;\n      balanceOfJPY[buyer] -= premium;\n      balanceOfJPY[seller] += premium;\n }\n\n\u4ee5\u4e0b\u306e\u6761\u4ef6\u6587\u306f\u3001\u3082\u3057\u3082\u8cb7\u3044\u624b\u306eJPY\u6b8b\u9ad8\u304c (\u30d3\u30c3\u30c8\u30b3\u30a4\u30f3\u306e\u8cfc\u5165\u8cbb+\u30d7\u30ec\u30df\u30a2\u30e0) \u3088\u308a\u5c11\u306a\u3044\u5834\u5408\u306f\u3001\u3053\u306e\u30e1\u30bd\u30c3\u30c9\u306f\u7121\u52b9\u306b\u3059\u308b\u3082\u306e\u3067\u3059\u3002\nif (balanceOfJPY[buyer] < premium + btc_amount * btc_price) throw;\n\n\u30e1\u30bd\u30c3\u30c9\u3092\u547c\u3073\u51fa\u3057\u307e\u3057\u3087\u3046\u3002\n> contract.Respond.sendTransaction(buyer, 100000, {from: buyer, gas:1000000})\n\n\u307e\u3060\u30de\u30a4\u30cb\u30f3\u30b0\u304c\u5b8c\u4e86\u3057\u3066\u3044\u306a\u3044\u306e\u3067\u3001\u58f2\u308a\u3066\u3068\u8cb7\u3044\u624b\u306eJPY\u6b8b\u9ad8\u306f\u5909\u5316\u3057\u3066\u3044\u307e\u305b\u3093\u3002\n> contract.balanceOfJPY(seller)\n100000\n> contract.balanceOfJPY(buyer)\n0\n\n\u30de\u30a4\u30cb\u30f3\u30b0\u5b8c\u4e86\u5f8c\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u6b8b\u9ad8\u304c\u5909\u5316\u3057\u307e\u3059\u3002\u30d7\u30ec\u30df\u30a2\u30e0\u5206\u3060\u3051\u58f2\u308a\u624b\u306e\u6b8b\u9ad8\u304c\u5897\u3048\u3066\u3044\u308b\u306e\u304c\u308f\u304b\u308a\u307e\u3059\u3002\n> contract.balanceOfJPY(seller)\n105000\n> contract.balanceOfJPY(buyer)\n95000\n\n\nExpire\u30e1\u30bd\u30c3\u30c9\u547c\u3073\u51fa\u3057\n\u6700\u5f8c\u306bExpire\u30e1\u30bd\u30c3\u30c9\u3092\u5b9f\u884c\u3057\u307e\u3057\u3087\u3046\u3002\u3053\u308c\u306f\u671f\u65e5\u3092\u904e\u304e\u305f\u3089\u3001\u5951\u7d04\u5185\u5bb9\u306b\u6cbf\u3063\u3066\u53d6\u5f15\u3092\u5b9f\u52b9\u3059\u308b\u30e1\u30bd\u30c3\u30c9\u3067\u3059\u3002\n  function Expire (uint _current_btc_price, uint _current_time){\n      if (_current_time < exercise_date) throw; \n      if (_current_btc_price < btc_price) throw;\n      balanceOfJPY[buyer] -= btc_price * btc_amount;\n      balanceOfJPY[seller] += btc_price * btc_amount;\n      balanceOfBTC[buyer] += btc_amount;\n      balanceOfBTC[seller] -= btc_amount;\n    }\n\n\u671f\u65e5\u306b\u9054\u3057\u3066\u306a\u3044\u5834\u5408\u306f\u7121\u52b9\u3068\u3059\u308b\u6761\u4ef6\u6587\u3067\u3059\u3002\nif (_current_time < exercise_date) throw;\n\n\u73fe\u5728\u306eBTC\u4fa1\u683c\u304c\u3001\u6a29\u5229\u884c\u4f7f\u4fa1\u683c\u3088\u308a\u5b89\u3044\u5834\u5408\u306f\u7121\u52b9\u3068\u3059\u308b\u6761\u4ef6\u6587\u3067\u3059\u3002\nif (_current_btc_price < btc_price) throw;\n\n\u30e1\u30bd\u30c3\u30c9\u3092\u547c\u3073\u51fa\u3057\u307e\u3059\u3002\ncontract.Expire.sendTransaction(55000, 1463127340, {from:seller, gas:1000000}\n\nBTC\u4fa1\u683c\u306f\u00a555000(>\u00a550000)\u3001\u73fe\u5728\u6642\u523b\u306f1463127340(>1463127335)\u3067\u3042\u308b\u305f\u3081\u3001\u5951\u7d04\u306f\u5b9f\u884c\u3055\u308c\u308b\u306f\u305a\u3067\u3059\u3002\n\u30de\u30a4\u30cb\u30f3\u30b0\u524d\n> contract.balanceOfBTC(seller)\n1\n> contract.balanceOfBTC(buyer)\n0\n> contract.balanceOfJPY(seller)\n105000\n> contract.balanceOfJPY(buyer)\n95000\n\n\n\u30de\u30a4\u30cb\u30f3\u30b0\u5f8c\n> contract.balanceOfBTC(seller)\n0\n> contract.balanceOfBTC(buyer)\n1\n> contract.balanceOfJPY(seller)\n155000\n> contract.balanceOfJPY(buyer)\n45000\n\n\u5951\u7d04\u6761\u4ef6\u306b\u6cbf\u3063\u3066\u3001\u58f2\u308a\u624b\u3068\u8cb7\u3044\u624b\u306eJPY\u6b8b\u9ad8\u3068BTC\u6b8b\u9ad8\u304c\u5909\u5316\u3057\u3066\u3044\u308b\u306e\u304c\u78ba\u8a8d\u51fa\u6765\u307e\u3057\u305f\u3002\n\n\u307e\u3068\u3081\n\u4eca\u56de\u306fSolidity\u3092\u7528\u3044\u305f\u30aa\u30d7\u30b7\u30e7\u30f3\u53d6\u5f15\u306e\u5b9f\u88c5\u65b9\u6cd5\u3092\u3054\u8aac\u660e\u3057\u307e\u3057\u305f\u3002\u6b21\u56de\u306f\u30b9\u30ef\u30c3\u30d7\u53d6\u5f15\u306e\u5b9f\u88c5\u65b9\u6cd5\u3092\u3054\u7d39\u4ecb\u81f4\u3057\u307e\u3059\u3002\n[\u524d\u56de](http://qiita.com/toshikase/items/28725215f7ad678b4b68)\u306fSolidity\u306e\u4f7f\u3044\u65b9\u306b\u3064\u3044\u3066\u3054\u8aac\u660e\u3057\u307e\u3057\u305f\u3002\u4eca\u56de\u306fSolidity\u3092\u7528\u3044\u3066\u30aa\u30d7\u30b7\u30e7\u30f3\u53d6\u5f15\u3092\u5b9f\u88c5\u3057\u3066\u307f\u307e\u3057\u3087\u3046\u3002\n\n##\u30b3\u30f3\u30c8\u30e9\u30af\u30c8\u6982\u8981\n\u4eca\u56de\u306f\u30b3\u30fc\u30eb\u30fb\u30aa\u30d7\u30b7\u30e7\u30f3\u3092\u5b9f\u88c5\u3057\u307e\u3059\u3002\u30b3\u30fc\u30eb\u30fb\u30aa\u30d7\u30b7\u30e7\u30f3\u3068\u306f\u3042\u308b\u8cc7\u7523\u3092\u8cb7\u3046\u6a29\u5229\u306e\u3053\u3068\u3067\u3059\u3002(\u3061\u306a\u307f\u306b\u3042\u308b\u8cc7\u7523\u3092\u58f2\u308b\u6a29\u5229\u3092\u30d7\u30c3\u30c8\u30fb\u30aa\u30d7\u30b7\u30e7\u30f3\u3068\u3044\u3044\u307e\u3059)\u3002\n\n\u30b3\u30fc\u30eb\u30fb\u30aa\u30d7\u30b7\u30e7\u30f3\u306e\u30ab\u30e9\u30e0\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u3057\u307e\u3059\u3002\n\n| key | value | \n|:----------|:-----------|\n| \u8cc7\u7523 | \u30d3\u30c3\u30c8\u30b3\u30a4\u30f3 |\n| \u6570\u91cf | 1 | \n| \u6a29\u5229\u884c\u4f7f\u4fa1\u683c | \u00a550,000 |\n| \u30d7\u30ec\u30df\u30a2\u30e0 | \u00a55,000 | \n| \u671f\u65e5 |  1463127335 |\n| \u58f2\u308a\u624b |  0xfffe72483eb0bc804295af2416d2aeb4fa15a8bc | \n| \u8cb7\u3044\u624b | 0x0e7b3774402f2f19a05e7a279238a4a1fe5e2bc0 |  \n\n\u203b**1463127335**\u306f**2016/05/13 8:15am(UTC)**\u306e[UNIX TimeStamp](http://www.unixtimestamp.com/)\u3067\u3059\n\n\u4ee5\u4e0b\u304c\u5b8c\u6210\u5f62\u306e\u30b3\u30fc\u30c9\u3067\u3059\n\n```call_option.sol\ncontract CallOption{\n    address public buyer;\n    address public seller;\n    uint public btc_amount;\n    uint public btc_price;\n    uint public premium;\n    uint public exercise_date;\n    mapping (address => uint) public balanceOfJPY;\n    mapping (address => uint) public balanceOfBTC;\n    function CallOption(\n      address _seller,\n      uint _seller_jpy,\n      uint _seller_btc,\n      uint _btc_price,\n      uint _btc_amount,\n      uint _premium,\n      uint _exercise_date\n      ){\n      seller = _seller;\n      balanceOfJPY[seller] = _seller_jpy;\n      balanceOfBTC[seller] = _seller_btc;\n      btc_price = _btc_price;\n      btc_amount = _btc_amount;\n      premium = _premium;\n      exercise_date = _exercise_date;\n    }\n    function Respond (address _buyer, uint _buyer_jpy) {\n      buyer = _buyer;\n      balanceOfJPY[buyer] = _buyer_jpy;\n      if (balanceOfJPY[buyer] < premium + btc_amount * btc_price) throw;\n      balanceOfJPY[buyer] -= premium;\n      balanceOfJPY[seller] += premium;\n    }\n    function Expire (uint _current_btc_price, uint _current_time){\n      if (_current_time < exercise_date) throw;\n      if (_current_btc_price < btc_price) throw;\n      balanceOfJPY[buyer] -= btc_price * btc_amount;\n      balanceOfJPY[seller] += btc_price * btc_amount;\n      balanceOfBTC[buyer] += btc_amount;\n      balanceOfBTC[seller] -= btc_amount;\n    }\n    function () {\n      throw;\n    }\n}\n```\n\n- CallOption\uff1a\u521d\u671f\u5316(\u4eca\u56de\u306f\u3001\u30aa\u30d7\u30b7\u30e7\u30f3\u306e\u767a\u884c\u4e3b\u4f53\u306f\u5e38\u306b\u58f2\u308a\u624b\u3068\u3057\u307e\u3059\u3002)\n- Respond\uff1a\u8cb7\u3044\u624b\u306e\u767b\u9332\n- Expire\uff1a\u30aa\u30d7\u30b7\u30e7\u30f3\u5b9f\u884c\n\n##\u30b3\u30f3\u30c8\u30e9\u30af\u30c8\u767b\u9332\n\n\u307e\u305a\u30b3\u30fc\u30c9\u3092\u30b3\u30f3\u30d1\u30a4\u30eb\u3057\u307e\u3059\u3002\n\n```\n> var source = \"contract CallOption{    address public buyer;    address public seller;    uint public btc_amount;    uint public btc_price;    uint public premium;    uint public exercise_date;    mapping (address => uint) public balanceOfJPY;    mapping (address => uint) public balanceOfBTC;    function CallOption(      address _seller,      uint _seller_jpy,      uint _seller_btc,      uint _btc_price,      uint _btc_amount,      uint _premium,      uint _exercise_date      ){      seller = _seller;      balanceOfJPY[seller] = _seller_jpy;      balanceOfBTC[seller] = _seller_btc;      btc_price = _btc_price;      btc_amount = _btc_amount;      premium = _premium;      exercise_date = _exercise_date;    }    function Respond (address _buyer, uint _buyer_jpy) {      buyer = _buyer;      balanceOfJPY[buyer] = _buyer_jpy;      if (balanceOfJPY[buyer] < premium + btc_amount * btc_price) throw;      balanceOfJPY[buyer] -= premium;      balanceOfJPY[seller] += premium;    }    function Expire (uint _current_btc_price, uint _current_time){      if (_current_time < exercise_date) throw;      if (_current_btc_price < btc_price) throw;      balanceOfJPY[buyer] -= btc_price * btc_amount;      balanceOfJPY[seller] += btc_price * btc_amount;      balanceOfBTC[buyer] += btc_amount;      balanceOfBTC[seller] -= btc_amount;    }    function () {      throw;    }}\"\n> var compiledSource = eth.compile.solidity(source)\n```\n\n\u7d9a\u3044\u3066\u3001\u30b3\u30f3\u30c8\u30e9\u30af\u30c8\u3092Ethereum\u306e\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306b\u9001\u4fe1\u3057\u307e\u3059\u3002\n\n```\n> var abiDefinition = compiledSource.CallOption.info.abiDefinition\n> var compiledContract = eth.contract(abiDefinition)\n> var seller = \"0xfffe72483eb0bc804295af2416d2aeb4fa15a8bc\"\n> var buyer = \"0x0e7b3774402f2f19a05e7a279238a4a1fe5e2bc0\"\n> var contract = compiledContract.new(seller, 100000, 1,  50000, 1, 1463127335, {from: seller, data: compiledSource.CallOption.code, gas:1000000})\n```\n\n\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u30b3\u30f3\u30c8\u30e9\u30af\u30c8\u304c\u9001\u4fe1\u3055\u308c\u307e\u3057\u305f\u3002\n\u3057\u304b\u3057\u307e\u3060\u30de\u30a4\u30cb\u30f3\u30b0\u3055\u308c\u3066\u3044\u306a\u3044\u306e\u3067\u3001\u30a2\u30c9\u30ec\u30b9\u306f\u5272\u308a\u5f53\u3066\u3089\u308c\u3066\u3044\u307e\u305b\u3093\u3002\n\n```\n> contract\n{\n  address: undefined,\n  transactionHash: \"0xf194ae6298b85b7fa6b0a9b75d115181ffb44ef546e4da9bcd970b943b01fa02\"\n}\n```\n\n\u30de\u30a4\u30cb\u30f3\u30b0\u304c\u5b8c\u4e86\u3059\u308b\u3068\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\u30a2\u30c9\u30ec\u30b9\u304c\u4ed8\u4e0e\u3055\u308c\u308b\u3066\u3044\u308b\u306e\u304c\u308f\u304b\u308a\u307e\u3059\u3002\n\n```\n> contract\n{\n  address: \"0x0bc2c62ecc340e0a4606d087f2d9d9afe0ef16d6\",\n  transactionHash: \"0xf194ae6298b85b7fa6b0a9b75d115181ffb44ef546e4da9bcd970b943b01fa02\",\n  Expire: function(),\n  Respond: function(),\n  allEvents: function(),\n  balanceOfBTC: function(),\n  balanceOfJPY: function(),\n  btc_amount: function(),\n  btc_price: function(),\n  buyer: function(),\n  exercise_date: function(),\n  premium: function(),\n  seller: function()\n}\n\n```\n\n##Respond\u30e1\u30bd\u30c3\u30c9\n\u521d\u671f\u5316\u304c\u5b8c\u4e86\u3057\u307e\u3057\u305f\u3002\u7d9a\u3044\u3066Respond\u30e1\u30bd\u30c3\u30c9\u3092\u5b9f\u884c\u3057\u307e\u3057\u3087\u3046\u3002\n\u4ee5\u4e0b\u304c\u30b3\u30fc\u30c9\u3067\u3059\u3002\u7b2c\u4e00\u5f15\u6570\u306f\u8cb7\u3044\u624b\u306e\u30a2\u30c9\u30ec\u30b9\u3001\u7b2c\u4e8c\u5f15\u6570\u306f\u8cb7\u3044\u624b\u306eJPY\u6b8b\u9ad8\u3092\u8868\u3057\u3066\u3044\u307e\u3059\u3002\n\n```\n function Respond (address _buyer, uint _buyer_jpy) {\n      buyer = _buyer;\n      balanceOfJPY[buyer] = _buyer_jpy;\n      if (balanceOfJPY[buyer] < premium + btc_amount * btc_price) throw;\n      balanceOfJPY[buyer] -= premium;\n      balanceOfJPY[seller] += premium;\n }\n```\n\n\u4ee5\u4e0b\u306e\u6761\u4ef6\u6587\u306f\u3001\u3082\u3057\u3082\u8cb7\u3044\u624b\u306eJPY\u6b8b\u9ad8\u304c (\u30d3\u30c3\u30c8\u30b3\u30a4\u30f3\u306e\u8cfc\u5165\u8cbb+\u30d7\u30ec\u30df\u30a2\u30e0) \u3088\u308a\u5c11\u306a\u3044\u5834\u5408\u306f\u3001\u3053\u306e\u30e1\u30bd\u30c3\u30c9\u306f\u7121\u52b9\u306b\u3059\u308b\u3082\u306e\u3067\u3059\u3002\n\n```\nif (balanceOfJPY[buyer] < premium + btc_amount * btc_price) throw;\n```\n\n\u30e1\u30bd\u30c3\u30c9\u3092\u547c\u3073\u51fa\u3057\u307e\u3057\u3087\u3046\u3002\n\n```\n> contract.Respond.sendTransaction(buyer, 100000, {from: buyer, gas:1000000})\n```\n\n\u307e\u3060\u30de\u30a4\u30cb\u30f3\u30b0\u304c\u5b8c\u4e86\u3057\u3066\u3044\u306a\u3044\u306e\u3067\u3001\u58f2\u308a\u3066\u3068\u8cb7\u3044\u624b\u306eJPY\u6b8b\u9ad8\u306f\u5909\u5316\u3057\u3066\u3044\u307e\u305b\u3093\u3002\n\n```\n> contract.balanceOfJPY(seller)\n100000\n> contract.balanceOfJPY(buyer)\n0\n```\n\n\u30de\u30a4\u30cb\u30f3\u30b0\u5b8c\u4e86\u5f8c\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u6b8b\u9ad8\u304c\u5909\u5316\u3057\u307e\u3059\u3002\u30d7\u30ec\u30df\u30a2\u30e0\u5206\u3060\u3051\u58f2\u308a\u624b\u306e\u6b8b\u9ad8\u304c\u5897\u3048\u3066\u3044\u308b\u306e\u304c\u308f\u304b\u308a\u307e\u3059\u3002\n\n```\n> contract.balanceOfJPY(seller)\n105000\n> contract.balanceOfJPY(buyer)\n95000\n```\n\n##Expire\u30e1\u30bd\u30c3\u30c9\u547c\u3073\u51fa\u3057\n\u6700\u5f8c\u306bExpire\u30e1\u30bd\u30c3\u30c9\u3092\u5b9f\u884c\u3057\u307e\u3057\u3087\u3046\u3002\u3053\u308c\u306f\u671f\u65e5\u3092\u904e\u304e\u305f\u3089\u3001\u5951\u7d04\u5185\u5bb9\u306b\u6cbf\u3063\u3066\u53d6\u5f15\u3092\u5b9f\u52b9\u3059\u308b\u30e1\u30bd\u30c3\u30c9\u3067\u3059\u3002\n\n```\n  function Expire (uint _current_btc_price, uint _current_time){\n      if (_current_time < exercise_date) throw; \n      if (_current_btc_price < btc_price) throw;\n      balanceOfJPY[buyer] -= btc_price * btc_amount;\n      balanceOfJPY[seller] += btc_price * btc_amount;\n      balanceOfBTC[buyer] += btc_amount;\n      balanceOfBTC[seller] -= btc_amount;\n    }\n```\n\n\u671f\u65e5\u306b\u9054\u3057\u3066\u306a\u3044\u5834\u5408\u306f\u7121\u52b9\u3068\u3059\u308b\u6761\u4ef6\u6587\u3067\u3059\u3002\n\n```\nif (_current_time < exercise_date) throw;\n```\n\n\u73fe\u5728\u306eBTC\u4fa1\u683c\u304c\u3001\u6a29\u5229\u884c\u4f7f\u4fa1\u683c\u3088\u308a\u5b89\u3044\u5834\u5408\u306f\u7121\u52b9\u3068\u3059\u308b\u6761\u4ef6\u6587\u3067\u3059\u3002\n\n```\nif (_current_btc_price < btc_price) throw;\n```\n\n\u30e1\u30bd\u30c3\u30c9\u3092\u547c\u3073\u51fa\u3057\u307e\u3059\u3002\n\n```\ncontract.Expire.sendTransaction(55000, 1463127340, {from:seller, gas:1000000}\n```\n\nBTC\u4fa1\u683c\u306f\u00a555000(>\u00a550000)\u3001\u73fe\u5728\u6642\u523b\u306f1463127340(>1463127335)\u3067\u3042\u308b\u305f\u3081\u3001\u5951\u7d04\u306f\u5b9f\u884c\u3055\u308c\u308b\u306f\u305a\u3067\u3059\u3002\n\n\u30de\u30a4\u30cb\u30f3\u30b0\u524d\n\n```\n> contract.balanceOfBTC(seller)\n1\n> contract.balanceOfBTC(buyer)\n0\n> contract.balanceOfJPY(seller)\n105000\n> contract.balanceOfJPY(buyer)\n95000\n\n```\n\n\u30de\u30a4\u30cb\u30f3\u30b0\u5f8c\n\n```\n> contract.balanceOfBTC(seller)\n0\n> contract.balanceOfBTC(buyer)\n1\n> contract.balanceOfJPY(seller)\n155000\n> contract.balanceOfJPY(buyer)\n45000\n```\n\n\u5951\u7d04\u6761\u4ef6\u306b\u6cbf\u3063\u3066\u3001\u58f2\u308a\u624b\u3068\u8cb7\u3044\u624b\u306eJPY\u6b8b\u9ad8\u3068BTC\u6b8b\u9ad8\u304c\u5909\u5316\u3057\u3066\u3044\u308b\u306e\u304c\u78ba\u8a8d\u51fa\u6765\u307e\u3057\u305f\u3002\n\n\n##\u307e\u3068\u3081\n\u4eca\u56de\u306fSolidity\u3092\u7528\u3044\u305f\u30aa\u30d7\u30b7\u30e7\u30f3\u53d6\u5f15\u306e\u5b9f\u88c5\u65b9\u6cd5\u3092\u3054\u8aac\u660e\u3057\u307e\u3057\u305f\u3002\u6b21\u56de\u306f\u30b9\u30ef\u30c3\u30d7\u53d6\u5f15\u306e\u5b9f\u88c5\u65b9\u6cd5\u3092\u3054\u7d39\u4ecb\u81f4\u3057\u307e\u3059\u3002\n\n", "tags": ["Ethereum", "solidity"]}