{"context": " More than 1 year has passed since last update.\n\nGoogle \u304b\u3089\u306e\u8b66\u544a\nGoogle\u304b\u3089\u4ee5\u4e0b\u306e\u30e1\u30fc\u30eb\u304c\u5c4a\u304d\u307e\u3057\u305f\u3002\nHello Google Play Developer,\n\nYour app listed at the end of this email has an unsafe implementation of  \nthe WebViewClient.onReceivedSslError handler. Specifically, the  \nimplementation ignores all SSL certificate validation errors, making your  \napp vulnerable to man-in-the-middle attacks. An attacker could change the  \naffected WebView's content, read transmitted data (such as login  \ncredentials), and execute code inside the app using JavaScript.\n\nPlease address this vulnerability as soon as possible and increment the  \nversion number of the upgraded APK. To properly handle SSL certificate  \nvalidation, change your code to invoke SslErrorHandler.proceed() whenever  \nthe certificate presented by the server meets your expectations, and invoke  \nSslErrorHandler.cancel() otherwise. If you are using a 3rd party library  \nthat's responsible for this, please notify the 3rd party and work with them  \nto address the issue.\n\nFor more information about the SSL error handler, please see our  \ndocumentation in the Android Developers Help Center. For other technical  \nquestions, you can post to Stack Overflow and use the tags  \n\u201candroid-security\u201d and \u201cSslErrorHandler.\u201d\n\nTo confirm you've upgraded correctly, submit the updated version to the  \nDeveloper Console and check back after five hours. If the app hasn't been  \nupgraded correctly, we will display a warning.\n\nWhile these specific issues may not affect every app that uses WebView SSL,  \nit's best to stay up to date on all security patches. Apps with  \nvulnerabilities that expose users to risk of compromise may be considered  \nDangerous Products in violation of the Content Policy and section 4.4 of  \nthe Developer Distribution Agreement.\n\nApps must also comply with the Developer Distribution Agreement and Content  \nPolicy. If you feel we have sent this warning in error, contact our policy  \nsupport team through the Google Play Developer Help Center.\n\nRegards,\n\nThe Google Play Team\n\n\u00a92016 Google Inc. 1600 Amphitheatre Parkway, Mountain View, CA 94043\n\nEmail preferences: You have received this mandatory email service  \nannouncement to update you about important changes to your Google Play  \nDeveloper account.\n\n\nAffected app(s), version(s), and class(es):\n\n\u4e0d\u6b63\u306aSSL\u8a3c\u660e\u66f8\u306e\u6271\u3044\u306b\u8106\u5f31\u6027\u304c\u3042\u308b\u305f\u3081\u4fee\u6b63\u3057\u3066\u3001\u3068\u306e\u3053\u3068\u3002\n\u65e9\u901fgg\u308b\u3068Qiita\u306e\u5148\u4eba\u306e\u30dd\u30b9\u30c8\u304c\u30d2\u30c3\u30c8\u3002\u3042\u308a\u304c\u305f\u3044\u3053\u3068\u3067\u3059\u3002\nWebViewClient.onReceivedSslError\u306e\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30a2\u30e9\u30fc\u30c8\u306e\u5bfe\u51e6\u6cd5\nhttp://qiita.com/hymmr/items/218e15541191a7a681e4\n\u4e0d\u6b63\u306a\u8a3c\u660e\u66f8\u306b\u906d\u9047\u3057\u305f\u5834\u5408\u306f\u3001\u30c0\u30a4\u30a2\u30ed\u30b0\u3092\u51fa\u3057\u3066\u30e6\u30fc\u30b6\u30fc\u306b\u51e6\u7406\u3092\u9032\u3081\u308b\u304b\u9078\u3070\u305b\u308b\u30bd\u30ea\u30e5\u30fc\u30b7\u30e7\u30f3\u3067\u3059\u3002\n\u7d20\u6674\u3089\u3057\u3044\uff01\n\u305d\u306e\u307e\u307e\u5bfe\u5fdc\u3057\u3066\u3082\u3044\u3044\u3093\u3067\u3059\u304c\u3001\u30af\u30e9\u30b9\u5316\u3057\u3066\u307f\u307e\u3057\u305f\u3002\n\nSSL\u8a3c\u660e\u66f8\u30a8\u30e9\u30fc\u6642\u306b\u30c0\u30a4\u30a2\u30ed\u30b0\u3092\u51fa\u529b\u3059\u308b\u30af\u30e9\u30b9\n\nSslAlertDialog.java\nimport android.app.Activity;\nimport android.app.AlertDialog;\nimport android.webkit.SslErrorHandler;\nimport android.content.DialogInterface;\n\n/**\n * SSL\u30a2\u30e9\u30fc\u30c8\u5c02\u7528\u30c0\u30a4\u30a2\u30ed\u30b0\u30af\u30e9\u30b9<br>\n * \u8a3c\u660e\u66f8\u304c\u6b63\u3057\u304f\u306a\u3044\u6642\u306b\u30e6\u30fc\u30b6\u30fc\u306b\u51e6\u7406\u3092\u9032\u3081\u308b\u304b\u3069\u3046\u3059\u308b\u304b\u9078\u3070\u305b\u308b\n */\npublic class SslAlertDialog {\n\n    private SslErrorHandler handler = null;\n    private AlertDialog dialog = null;\n\n    public SslAlertDialog(SslErrorHandler errorHandler, Activity activity) {\n\n        if (errorHandler == null || activity == null) return;\n\n        handler = errorHandler;\n\n        AlertDialog.Builder builder = new AlertDialog.Builder(activity);\n        builder.setMessage(\"ssl\u8a3c\u660e\u66f8\u304c\u6b63\u3057\u304f\u3042\u308a\u307e\u305b\u3093\u3002\u30da\u30fc\u30b8\u3092\u958b\u304d\u307e\u3059\u304b\uff1f\");\n        builder.setPositiveButton(\"yes\", new DialogInterface.OnClickListener() {\n            @Override\n            public void onClick(DialogInterface dialog, int which) {\n                handler.proceed();\n            }\n        });\n        builder.setNegativeButton(\"no\", new DialogInterface.OnClickListener() {\n            @Override\n            public void onClick(DialogInterface dialog, int which) {\n                handler.cancel();\n            }\n        });\n\n        dialog = builder.create();\n    }\n\n    public void show() {\n        dialog.show();\n    }\n\n}\n\n\n\n\u4f7f\u3044\u65b9\npublic void onReceivedSslError(WebView view, SslErrorHandler handler, SslError error) {\n    SslAlertDialog dialog = new SslAlertDialog(handler, HogeActivity.this);\n    dialog.show();\n}\n\n\u7a81\u7136google\u304b\u3089\u8b66\u544a\u304c\u5c4a\u3044\u305f\u3089\u8a66\u3057\u3066\u307f\u3066\u304f\u3060\u3055\u3044\u3002\n## Google \u304b\u3089\u306e\u8b66\u544a\n\nGoogle\u304b\u3089\u4ee5\u4e0b\u306e\u30e1\u30fc\u30eb\u304c\u5c4a\u304d\u307e\u3057\u305f\u3002\n\n```\nHello Google Play Developer,\n\nYour app listed at the end of this email has an unsafe implementation of  \nthe WebViewClient.onReceivedSslError handler. Specifically, the  \nimplementation ignores all SSL certificate validation errors, making your  \napp vulnerable to man-in-the-middle attacks. An attacker could change the  \naffected WebView's content, read transmitted data (such as login  \ncredentials), and execute code inside the app using JavaScript.\n\nPlease address this vulnerability as soon as possible and increment the  \nversion number of the upgraded APK. To properly handle SSL certificate  \nvalidation, change your code to invoke SslErrorHandler.proceed() whenever  \nthe certificate presented by the server meets your expectations, and invoke  \nSslErrorHandler.cancel() otherwise. If you are using a 3rd party library  \nthat's responsible for this, please notify the 3rd party and work with them  \nto address the issue.\n\nFor more information about the SSL error handler, please see our  \ndocumentation in the Android Developers Help Center. For other technical  \nquestions, you can post to Stack Overflow and use the tags  \n\u201candroid-security\u201d and \u201cSslErrorHandler.\u201d\n\nTo confirm you've upgraded correctly, submit the updated version to the  \nDeveloper Console and check back after five hours. If the app hasn't been  \nupgraded correctly, we will display a warning.\n\nWhile these specific issues may not affect every app that uses WebView SSL,  \nit's best to stay up to date on all security patches. Apps with  \nvulnerabilities that expose users to risk of compromise may be considered  \nDangerous Products in violation of the Content Policy and section 4.4 of  \nthe Developer Distribution Agreement.\n\nApps must also comply with the Developer Distribution Agreement and Content  \nPolicy. If you feel we have sent this warning in error, contact our policy  \nsupport team through the Google Play Developer Help Center.\n\nRegards,\n\nThe Google Play Team\n\n\u00a92016 Google Inc. 1600 Amphitheatre Parkway, Mountain View, CA 94043\n\nEmail preferences: You have received this mandatory email service  \nannouncement to update you about important changes to your Google Play  \nDeveloper account.\n\n\nAffected app(s), version(s), and class(es):\n```\n\n\n\u4e0d\u6b63\u306aSSL\u8a3c\u660e\u66f8\u306e\u6271\u3044\u306b\u8106\u5f31\u6027\u304c\u3042\u308b\u305f\u3081\u4fee\u6b63\u3057\u3066\u3001\u3068\u306e\u3053\u3068\u3002\n\u65e9\u901fgg\u308b\u3068Qiita\u306e\u5148\u4eba\u306e\u30dd\u30b9\u30c8\u304c\u30d2\u30c3\u30c8\u3002\u3042\u308a\u304c\u305f\u3044\u3053\u3068\u3067\u3059\u3002\n\nWebViewClient.onReceivedSslError\u306e\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30a2\u30e9\u30fc\u30c8\u306e\u5bfe\u51e6\u6cd5\nhttp://qiita.com/hymmr/items/218e15541191a7a681e4\n\n\u4e0d\u6b63\u306a\u8a3c\u660e\u66f8\u306b\u906d\u9047\u3057\u305f\u5834\u5408\u306f\u3001\u30c0\u30a4\u30a2\u30ed\u30b0\u3092\u51fa\u3057\u3066\u30e6\u30fc\u30b6\u30fc\u306b\u51e6\u7406\u3092\u9032\u3081\u308b\u304b\u9078\u3070\u305b\u308b\u30bd\u30ea\u30e5\u30fc\u30b7\u30e7\u30f3\u3067\u3059\u3002\n\u7d20\u6674\u3089\u3057\u3044\uff01\n\n\u305d\u306e\u307e\u307e\u5bfe\u5fdc\u3057\u3066\u3082\u3044\u3044\u3093\u3067\u3059\u304c\u3001\u30af\u30e9\u30b9\u5316\u3057\u3066\u307f\u307e\u3057\u305f\u3002\n\n\n## SSL\u8a3c\u660e\u66f8\u30a8\u30e9\u30fc\u6642\u306b\u30c0\u30a4\u30a2\u30ed\u30b0\u3092\u51fa\u529b\u3059\u308b\u30af\u30e9\u30b9\n\n```SslAlertDialog.java\nimport android.app.Activity;\nimport android.app.AlertDialog;\nimport android.webkit.SslErrorHandler;\nimport android.content.DialogInterface;\n\n/**\n * SSL\u30a2\u30e9\u30fc\u30c8\u5c02\u7528\u30c0\u30a4\u30a2\u30ed\u30b0\u30af\u30e9\u30b9<br>\n * \u8a3c\u660e\u66f8\u304c\u6b63\u3057\u304f\u306a\u3044\u6642\u306b\u30e6\u30fc\u30b6\u30fc\u306b\u51e6\u7406\u3092\u9032\u3081\u308b\u304b\u3069\u3046\u3059\u308b\u304b\u9078\u3070\u305b\u308b\n */\npublic class SslAlertDialog {\n\n    private SslErrorHandler handler = null;\n    private AlertDialog dialog = null;\n\n    public SslAlertDialog(SslErrorHandler errorHandler, Activity activity) {\n\n        if (errorHandler == null || activity == null) return;\n\n        handler = errorHandler;\n\n        AlertDialog.Builder builder = new AlertDialog.Builder(activity);\n        builder.setMessage(\"ssl\u8a3c\u660e\u66f8\u304c\u6b63\u3057\u304f\u3042\u308a\u307e\u305b\u3093\u3002\u30da\u30fc\u30b8\u3092\u958b\u304d\u307e\u3059\u304b\uff1f\");\n        builder.setPositiveButton(\"yes\", new DialogInterface.OnClickListener() {\n            @Override\n            public void onClick(DialogInterface dialog, int which) {\n                handler.proceed();\n            }\n        });\n        builder.setNegativeButton(\"no\", new DialogInterface.OnClickListener() {\n            @Override\n            public void onClick(DialogInterface dialog, int which) {\n                handler.cancel();\n            }\n        });\n\n        dialog = builder.create();\n    }\n\n    public void show() {\n        dialog.show();\n    }\n\n}\n\n```\n\n\n\u4f7f\u3044\u65b9\n\n```java\npublic void onReceivedSslError(WebView view, SslErrorHandler handler, SslError error) {\n    SslAlertDialog dialog = new SslAlertDialog(handler, HogeActivity.this);\n    dialog.show();\n}\n```\n\n\u7a81\u7136google\u304b\u3089\u8b66\u544a\u304c\u5c4a\u3044\u305f\u3089\u8a66\u3057\u3066\u307f\u3066\u304f\u3060\u3055\u3044\u3002\n\n", "tags": ["Android", "webView"]}