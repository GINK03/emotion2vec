{"tags": ["Slack", "gas"], "context": " More than 1 year has passed since last update.\nGoogle Apps Script\u3067\u30b9\u30af\u30ec\u30a4\u30d4\u30f3\u30b0\u3057\u3066Slack\u306bPOST\u3057\u3066\u307e\u3059\u3002\nGAS\u3067\u63d0\u4f9b\u3055\u308c\u3066\u3044\u308bUrlFetchApp\u304c\u4fbf\u5229\u3067\u3059\u3002\n\u5b9a\u671f\u6295\u7a3f\u306f\u5404\u81ea\u597d\u304d\u306a\u30bf\u30a4\u30df\u30f3\u30b0\u3067myFunction\u304c\u5b9f\u884c\u3055\u308c\u308b\u3088\u3046\u306b\u30c8\u30ea\u30ac\u30fc\u3092\u8a2d\u5b9a\u3057\u3066\u304f\u3060\u3055\u3044\uff08GUI\u3060\u3051\u3067\u3067\u304d\u307e\u3059\uff09\u3002\n\n\u30b3\u30fc\u30c9.gs\nvar code = \"1111\" // \u3042\u306a\u305f\u304c\u898b\u305f\u3044\u4f1a\u793e\u306e\u8a3c\u5238\u30b3\u30fc\u30c9\nvar slack = {\n  postUrl: 'https://slack.com/api/chat.postMessage',\n  token: 'xoxp-AAAAAAAAAAAAAAAA', // Slack\u306etoken\n  channelId: \"C0BBBBBBBBB\",       // \u682a\u4fa1\u3061\u3083\u3093\u306d\u308b\u306eID\n  userName: \"\u682a\u4fa1\u76e3\u8996\u541b\"            // bot\u306e\u540d\u524d\n}\n\nvar postMessage = function(text) {\n  UrlFetchApp.fetch(slack[\"postUrl\"], {\n    \"method\" : \"post\",\n    \"payload\" : {\n      token: slack[\"token\"],\n      channel: slack[\"channelId\"],\n      username: slack[\"userName\"],\n      text: text\n    }\n  });\n}\n\nfunction myFunction() {\n  var response = UrlFetchApp.fetch(\"http://stocks.finance.yahoo.co.jp/stocks/detail/?code=\" + code + \".n\");\n\n  var myRegexp = /<td class=\"stoksPrice\">([\\s\\S]*?)<\\/td>/i;\n  var match = myRegexp.exec(response.getContentText());\n  var amount = match[1];\n\n  Logger.log(amount);\n  postMessage(\"\u73fe\u5728\u306e\u682a\u4fa1\uff1a \" + amount + \"\u5186\");\n}\n\n\n![\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8_2015_01_13_19_06.png](https://qiita-image-store.s3.amazonaws.com/0/4194/b1b4fb72-891a-ca70-53a3-074989a2bba6.png)\n\nGoogle Apps Script\u3067\u30b9\u30af\u30ec\u30a4\u30d4\u30f3\u30b0\u3057\u3066Slack\u306bPOST\u3057\u3066\u307e\u3059\u3002\n\nGAS\u3067\u63d0\u4f9b\u3055\u308c\u3066\u3044\u308b`UrlFetchApp`\u304c\u4fbf\u5229\u3067\u3059\u3002\n\n\u5b9a\u671f\u6295\u7a3f\u306f\u5404\u81ea\u597d\u304d\u306a\u30bf\u30a4\u30df\u30f3\u30b0\u3067myFunction\u304c\u5b9f\u884c\u3055\u308c\u308b\u3088\u3046\u306b\u30c8\u30ea\u30ac\u30fc\u3092\u8a2d\u5b9a\u3057\u3066\u304f\u3060\u3055\u3044\uff08GUI\u3060\u3051\u3067\u3067\u304d\u307e\u3059\uff09\u3002\n\n```js:\u30b3\u30fc\u30c9.gs\nvar code = \"1111\" // \u3042\u306a\u305f\u304c\u898b\u305f\u3044\u4f1a\u793e\u306e\u8a3c\u5238\u30b3\u30fc\u30c9\nvar slack = {\n  postUrl: 'https://slack.com/api/chat.postMessage',\n  token: 'xoxp-AAAAAAAAAAAAAAAA', // Slack\u306etoken\n  channelId: \"C0BBBBBBBBB\",       // \u682a\u4fa1\u3061\u3083\u3093\u306d\u308b\u306eID\n  userName: \"\u682a\u4fa1\u76e3\u8996\u541b\"            // bot\u306e\u540d\u524d\n}\n\nvar postMessage = function(text) {\n  UrlFetchApp.fetch(slack[\"postUrl\"], {\n    \"method\" : \"post\",\n    \"payload\" : {\n      token: slack[\"token\"],\n      channel: slack[\"channelId\"],\n      username: slack[\"userName\"],\n      text: text\n    }\n  });\n}\n\nfunction myFunction() {\n  var response = UrlFetchApp.fetch(\"http://stocks.finance.yahoo.co.jp/stocks/detail/?code=\" + code + \".n\");\n\n  var myRegexp = /<td class=\"stoksPrice\">([\\s\\S]*?)<\\/td>/i;\n  var match = myRegexp.exec(response.getContentText());\n  var amount = match[1];\n\n  Logger.log(amount);\n  postMessage(\"\u73fe\u5728\u306e\u682a\u4fa1\uff1a \" + amount + \"\u5186\");\n}\n```\n"}