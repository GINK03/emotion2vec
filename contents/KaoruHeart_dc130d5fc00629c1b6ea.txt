{"context": "WPF\u3067\u753b\u50cf\u3092\u6271\u304a\u3046\u3068\u3057\u305f\u3089\u3001\u3068\u3066\u3082\u7a2e\u985e\u304c\u591a\u3044\u3053\u3068\u304c\u308f\u304b\u3063\u305f\u306e\u3067\u3001\u76f8\u4e92\u30b3\u30f3\u30d0\u30fc\u30bf\u30fc\u3092\u4f5c\u308b\u3053\u3068\u306b\u3057\u305f\u3002\n\u307e\u305a\u6700\u521d\u306f\u5b9a\u756a\u306eSystem.Drawing.Bitmap\u304b\u3089System.Windows.Controls.Image\u3078\u306e\u5909\u63db\u3002\n    [System.Runtime.InteropServices.DllImport(\"gdi32.dll\")]\n    public static extern bool DeleteObject(IntPtr hObject);\n    public static System.Windows.Controls.Image\n        SystemDrawingBitmap2SystemWindowsControlsImage(System.Drawing.Bitmap original) {\n\n        IntPtr hBitmap = original.GetHbitmap();\n        var newimage = new System.Windows.Controls.Image();\n        try {\n            newimage.Source = System.Windows.Interop.Imaging.CreateBitmapSourceFromHBitmap(\n                hBitmap,\n                IntPtr.Zero,\n                Int32Rect.Empty,\n                System.Windows.Media.Imaging.BitmapSizeOptions.FromEmptyOptions());\n        }\n        finally {\n            DeleteObject(hBitmap);\n        }\n        return newimage;\n    }\n\nWPF\u3067\u753b\u50cf\u3092\u6271\u304a\u3046\u3068\u3057\u305f\u3089\u3001\u3068\u3066\u3082\u7a2e\u985e\u304c\u591a\u3044\u3053\u3068\u304c\u308f\u304b\u3063\u305f\u306e\u3067\u3001\u76f8\u4e92\u30b3\u30f3\u30d0\u30fc\u30bf\u30fc\u3092\u4f5c\u308b\u3053\u3068\u306b\u3057\u305f\u3002\n\u307e\u305a\u6700\u521d\u306f\u5b9a\u756a\u306eSystem.Drawing.Bitmap\u304b\u3089System.Windows.Controls.Image\u3078\u306e\u5909\u63db\u3002\n\n\n\t\t[System.Runtime.InteropServices.DllImport(\"gdi32.dll\")]\n\t\tpublic static extern bool DeleteObject(IntPtr hObject);\n\t\tpublic static System.Windows.Controls.Image\n\t\t\tSystemDrawingBitmap2SystemWindowsControlsImage(System.Drawing.Bitmap original) {\n\n\t\t\tIntPtr hBitmap = original.GetHbitmap();\n\t\t\tvar newimage = new System.Windows.Controls.Image();\n\t\t\ttry {\n\t\t\t\tnewimage.Source = System.Windows.Interop.Imaging.CreateBitmapSourceFromHBitmap(\n\t\t\t\t\thBitmap,\n\t\t\t\t\tIntPtr.Zero,\n\t\t\t\t\tInt32Rect.Empty,\n\t\t\t\t\tSystem.Windows.Media.Imaging.BitmapSizeOptions.FromEmptyOptions());\n\t\t\t}\n\t\t\tfinally {\n\t\t\t\tDeleteObject(hBitmap);\n\t\t\t}\n\t\t\treturn newimage;\n\t\t}\n\n", "tags": ["WPF"]}