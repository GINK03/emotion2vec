{"context": "\n\n\u53c2\u8003\n\nQuickstart for Mac OS X \u00a0|\u00a0 Cloud SDK Documentation \u00a0|\u00a0 Google Cloud Platform\nGo+App Engine+Cloud SQL\u3067\u59cb\u3081\u308bGo\u8a00\u8a9eWeb\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u958b\u767a | eureka tech blog\n\n\ncloud\n\ngoogle-cloud-sdk-131.0.0-darwin-x86_64.tar.gz \u3092\u5c55\u958b\u3057\u3066\n\ncd ./google-cloud-sdk/\n./install.sh\n\nmkdir ~/prj1 && cd ~/prj1\ngcloud init\n\n\nSDK\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\n\nDownload and Install the SDK for App Engine \u00a0|\u00a0 App Engine Documentation \u00a0|\u00a0 Google Cloud Platform\n\u305b\u3063\u304b\u304f\u306a\u306e\u3067Go\u3092\u9078\u629e\u3057\u305f\u3002\n\nbrew install go\nmkdir ~/vendor/gopath/\n\nexport PATH=$PATH:/usr/local/opt/go/libexec/bin\nexport PATH=$PATH:~/vendor/go_appengine/\nexport GOPATH=~/vendor/gopath/\n\n\napp.yaml\u306a\u3069\n\n\nGAE for GO\u306e\u74b0\u5883\u3092\u69cb\u7bc9\u3059\u308b - Qiita\u3092\u306a\u305e\u308b\u3002\n\ntouch app.yaml\ntouch hello.go\n\n\napp.yaml\napplication: helloworld\nversion: 1\nruntime: go\napi_version: go1\n\nhandlers:\n- url: /.*\n  script: _go_app\n\n\n\nhello.go\npackage hello\n\nimport (\n    \"fmt\"\n    \"net/http\"\n)\n\nfunc init() {\n    http.HandleFunc(\"/\", handler)\n}\n\nfunc handler(w http.ResponseWriter, r *http.Request) {\n    var html =`\n<head>\n<link rel=\"stylesheet\" href=\"https://cdn.rawgit.com/milligram/milligram/master/dist/milligram.css\">\n<script src=\"https://cdn.rawgit.com/chjj/marked/master/marked.min.js\"></script>\n</head>\n<body>\n<div class=\"container\">\n<div id=\"mdrender\"></div>\n</div>\n<div id=\"mdraw\" style=\"display:none;\">\n\n# \u65e5\u672c\u8a9e\u3067OK\n\n1. bb\n\n<pre>\n1. bb\n</pre>\n\n</div>\n</body>\n<script> document.getElementById(\"mdrender\").innerHTML = marked(document.getElementById(\"mdraw\").innerHTML); </script>\n`\n    fmt.Fprint(w, html)\n}\n\n\ngoapp serve ./\n\n\n\nhttp://localhost:8080 \u306b\u30a2\u30af\u30bb\u30b9\u3059\u308b\u3068\u65e5\u672c\u8a9e\u3067OK\u304c\u78ba\u8a8d\u3067\u304d\u308b\u3002\n\n\n\u30c7\u30d7\u30ed\u30a4\n\n\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092\u7528\u610f\u3057\u3066\u304a\u304f\u3002console\n\n\n\napp.yaml\n- application: helloworld\n+ application: go-2016\n\n\ngoapp deploy\n\n\ngcloud Overview \u00a0|\u00a0 Cloud SDK Documentation \u00a0|\u00a0 Google Cloud Platform\n\n\nweb\u30d6\u30e9\u30a6\u30b6\u3067\u78ba\u8a8d\ngcloud preview app browse\n\n\n\nhttps://go-2016.appspot.com/\n\n\nhtml\u3092\u3082\u3063\u3068\u7c21\u5358\u306b\u4f7f\u3046\n\n\u53c2\u8003: Reinbach\n\n\n\nhello.go\npackage hello\n\nimport (\n    \"net/http\"\n    \"html/template\"\n)\n\nfunc init() {\n    http.HandleFunc(\"/\", Home)\n}\n\nfunc Home(w http.ResponseWriter, req *http.Request) {\n    render(w, \"index.html\")\n}\n\nfunc render(w http.ResponseWriter, tmpl string) {\n    t, _ := template.ParseFiles(\"templates/\" + tmpl)\n    t.Execute(w, \"\")\n}\n\n\n\n\ntemplates/index.html \u304c\u8aad\u307f\u8fbc\u307e\u308c\u308b\u3002\n\n\n\u9759\u7684\u30d5\u30a1\u30a4\u30eb\u3092\u8868\u793a\u3059\u308b\n\nhello.go\npackage hello\n\nimport (\n    \"net/http\"\n    \"html/template\"\n    \"io\"\n    \"time\"\n    \"fmt\"\n)\n\nconst STATIC_URL string = \"/static/\"\nconst STATIC_ROOT string = \"static/\"\n\nfunc init() {\n    http.HandleFunc(\"/\", Home)\n    http.HandleFunc(\"/ip\", Ip)\n    http.HandleFunc(STATIC_URL, StaticHandler)\n}\n\nfunc Home(w http.ResponseWriter, req *http.Request) {\n    render(w, \"index.html\")\n}\nfunc Ip(w http.ResponseWriter, req *http.Request) {\n    fmt.Fprint(w, req.RemoteAddr)\n}\nfunc render(w http.ResponseWriter, tmpl string) {\n    t, _ := template.ParseFiles(STATIC_ROOT + tmpl)\n    t.Execute(w, \"\")\n}\n\nfunc StaticHandler(w http.ResponseWriter, req *http.Request) {\n    static_file := req.URL.Path[len(STATIC_URL):]\n    if len(static_file) != 0 {\n        f, err := http.Dir(STATIC_ROOT).Open(static_file)\n        if err == nil {\n            content := io.ReadSeeker(f)\n            http.ServeContent(w, req, static_file, time.Now(), content)\n            return\n        }\n    }\n    http.NotFound(w, req)\n}\n\n\n\n\nhttp://localhost:8080/ => ./index.html\n\nhttp://localhost:8080/ip => ip\u30a2\u30c9\u30ec\u30b9\u8868\u793a\n\nhttp://localhost:8080/static/date.html => ./static/date.html\n\n## \u53c2\u8003\n\n* [Quickstart for Mac OS X \u00a0|\u00a0 Cloud SDK Documentation \u00a0|\u00a0 Google Cloud Platform](https://cloud.google.com/sdk/docs/quickstart-mac-os-x?hl=ja)\n* [Go+App Engine+Cloud SQL\u3067\u59cb\u3081\u308bGo\u8a00\u8a9eWeb\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u958b\u767a | eureka tech blog](https://developers.eure.jp/tech/go-appengine-sql-waf/)\n\n## cloud\n\n* google-cloud-sdk-131.0.0-darwin-x86_64.tar.gz \u3092\u5c55\u958b\u3057\u3066\n\n```bash:\ncd ./google-cloud-sdk/\n./install.sh\n\nmkdir ~/prj1 && cd ~/prj1\ngcloud init\n```\n\n\n## SDK\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\n\n* [Download and Install the SDK for App Engine \u00a0|\u00a0 App Engine Documentation \u00a0|\u00a0 Google Cloud Platform](https://cloud.google.com/appengine/downloads)\n\n* \u305b\u3063\u304b\u304f\u306a\u306e\u3067Go\u3092\u9078\u629e\u3057\u305f\u3002\n\n```bash:\nbrew install go\nmkdir ~/vendor/gopath/\n\nexport PATH=$PATH:/usr/local/opt/go/libexec/bin\nexport PATH=$PATH:~/vendor/go_appengine/\nexport GOPATH=~/vendor/gopath/\n```\n\n## app.yaml\u306a\u3069\n\n* [GAE for GO\u306e\u74b0\u5883\u3092\u69cb\u7bc9\u3059\u308b - Qiita](http://qiita.com/135yshr/items/de2b8cc7ec9ae1ce2cd9)\u3092\u306a\u305e\u308b\u3002\n\n```bash:\ntouch app.yaml\ntouch hello.go\n```\n\n```rb:app.yaml\napplication: helloworld\nversion: 1\nruntime: go\napi_version: go1\n\nhandlers:\n- url: /.*\n  script: _go_app\n```\n\n```go:hello.go\npackage hello\n\nimport (\n    \"fmt\"\n    \"net/http\"\n)\n\nfunc init() {\n    http.HandleFunc(\"/\", handler)\n}\n\nfunc handler(w http.ResponseWriter, r *http.Request) {\n    var html =`\n<head>\n<link rel=\"stylesheet\" href=\"https://cdn.rawgit.com/milligram/milligram/master/dist/milligram.css\">\n<script src=\"https://cdn.rawgit.com/chjj/marked/master/marked.min.js\"></script>\n</head>\n<body>\n<div class=\"container\">\n<div id=\"mdrender\"></div>\n</div>\n<div id=\"mdraw\" style=\"display:none;\">\n\n# \u65e5\u672c\u8a9e\u3067OK\n\n1. bb\n\n<pre>\n1. bb\n</pre>\n\n</div>\n</body>\n<script> document.getElementById(\"mdrender\").innerHTML = marked(document.getElementById(\"mdraw\").innerHTML); </script>\n`\n    fmt.Fprint(w, html)\n}\n```\n\n```bash:\ngoapp serve ./\n```\n\n* http://localhost:8080 \u306b\u30a2\u30af\u30bb\u30b9\u3059\u308b\u3068`\u65e5\u672c\u8a9e\u3067OK`\u304c\u78ba\u8a8d\u3067\u304d\u308b\u3002\n\n## \u30c7\u30d7\u30ed\u30a4\n\n* \u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092\u7528\u610f\u3057\u3066\u304a\u304f\u3002[console](https://console.cloud.google.com/projectselector/appengine?hl=ja&pli=1)\n\n```diff:app.yaml\n- application: helloworld\n+ application: go-2016\n```\n\n```\ngoapp deploy\n```\n\n* [gcloud Overview \u00a0|\u00a0 Cloud SDK Documentation \u00a0|\u00a0 Google Cloud Platform](https://cloud.google.com/sdk/gcloud/?hl=ja)\n\n```bash:web\u30d6\u30e9\u30a6\u30b6\u3067\u78ba\u8a8d\ngcloud preview app browse\n```\n\n* https://go-2016.appspot.com/\n\n## html\u3092\u3082\u3063\u3068\u7c21\u5358\u306b\u4f7f\u3046\n\n* \u53c2\u8003: [Reinbach](http://reinbach.com/golang-webapps-1.html)\n\n```go:hello.go\npackage hello\n\nimport (\n    \"net/http\"\n    \"html/template\"\n)\n\nfunc init() {\n    http.HandleFunc(\"/\", Home)\n}\n\nfunc Home(w http.ResponseWriter, req *http.Request) {\n    render(w, \"index.html\")\n}\n\nfunc render(w http.ResponseWriter, tmpl string) {\n    t, _ := template.ParseFiles(\"templates/\" + tmpl)\n    t.Execute(w, \"\")\n}\n```\n\n* `templates/index.html` \u304c\u8aad\u307f\u8fbc\u307e\u308c\u308b\u3002\n\n\n### \u9759\u7684\u30d5\u30a1\u30a4\u30eb\u3092\u8868\u793a\u3059\u308b\n\n\n```go:hello.go\npackage hello\n\nimport (\n    \"net/http\"\n    \"html/template\"\n    \"io\"\n    \"time\"\n    \"fmt\"\n)\n\nconst STATIC_URL string = \"/static/\"\nconst STATIC_ROOT string = \"static/\"\n\nfunc init() {\n    http.HandleFunc(\"/\", Home)\n    http.HandleFunc(\"/ip\", Ip)\n    http.HandleFunc(STATIC_URL, StaticHandler)\n}\n\nfunc Home(w http.ResponseWriter, req *http.Request) {\n    render(w, \"index.html\")\n}\nfunc Ip(w http.ResponseWriter, req *http.Request) {\n    fmt.Fprint(w, req.RemoteAddr)\n}\nfunc render(w http.ResponseWriter, tmpl string) {\n    t, _ := template.ParseFiles(STATIC_ROOT + tmpl)\n    t.Execute(w, \"\")\n}\n\nfunc StaticHandler(w http.ResponseWriter, req *http.Request) {\n    static_file := req.URL.Path[len(STATIC_URL):]\n    if len(static_file) != 0 {\n        f, err := http.Dir(STATIC_ROOT).Open(static_file)\n        if err == nil {\n            content := io.ReadSeeker(f)\n            http.ServeContent(w, req, static_file, time.Now(), content)\n            return\n        }\n    }\n    http.NotFound(w, req)\n}\n```\n\n* http://localhost:8080/ => ./index.html\n* http://localhost:8080/ip => ip\u30a2\u30c9\u30ec\u30b9\u8868\u793a\n* http://localhost:8080/static/date.html => ./static/date.html\n", "tags": ["GAE"]}