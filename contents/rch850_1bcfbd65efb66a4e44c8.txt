{"context": " More than 1 year has passed since last update.\u30bf\u30a4\u30c8\u30eb\u9577\u3059\u304e\uff01\nIAM \u30ed\u30fc\u30eb\u3092\u4f7f\u7528\u3057\u305f\u30af\u30ed\u30b9\u30a2\u30ab\u30a6\u30f3\u30c8 API \u30a2\u30af\u30bb\u30b9\u306e\u30a6\u30a9\u30fc\u30af\u30b9\u30eb\u30fc - AWS Identity and Access Management \u3092\u8aad\u3093\u3067\u307f\u305f\u3093\u3060\u3051\u3069\u3001\u3084\u305f\u3089\u9762\u5012\u3060\u3063\u305f\u308a\u3001\u82e5\u5e72\u3084\u308a\u305f\u3044\u3053\u3068\u3068\u305a\u308c\u3066\u305f\u308a\u3057\u305f\u306e\u3067\u3001bucket policy \u3067\u306a\u3093\u3068\u304b\u3057\u3066\u307f\u305f\u3002\n+--AWS\u2009Account\u2009A------+\u2009\u2009\u2009\u2009\u2009\u2009\u2009\u2009\u2009\u2009\u2009\u2009\u2009\u2009+---AWS\u2009Account\u2009B----+\n|    EC2\u2009Instance \u2009 --+------------+---->\u2009S3\u2009Bucket\u2009\u2009\u2009\u2009\u2009 |\n|     (IAM Role)      |            |   (Bucket Policy)  |\n+---------------------+\u2009\u2009\u2009\u2009\u2009\u2009\u2009\u2009\u2009\u2009\u2009\u2009\u2009\u2009+-------------------+\n\n{\n    \"Version\": \"2012-10-17\",\n    \"Statement\": [\n        {\n            \"Effect\": \"Allow\",\n            \"Principal\": {\n                \"AWS\": \"arn:aws:iam::XXXXXXXXXXXX:role/SomeRole\"\n            },\n            \"Action\": \"s3:ListBucket\",\n            \"Resource\": [\n                \"arn:aws:s3:::bucket-name\"\n            ]\n        },\n        {\n            \"Effect\": \"Allow\",\n            \"Principal\": {\n                \"AWS\": \"arn:aws:iam::XXXXXXXXXXXX:role/SomeRole\"\n            },\n            \"Action\": [\n                \"s3:GetObject\",\n                \"s3:PutObject\",\n                \"s3:DeleteObject\"\n            ],\n            \"Resource\": [\n                \"arn:aws:s3:::bucket-name/*\"\n            ]\n        }\n    ]\n}\n\nPrincipal \u306b\u306f\u3001\u30a2\u30af\u30bb\u30b9\u3059\u308b\u5074\uff08\u30a2\u30af\u30bb\u30b9\u3092\u8a31\u53ef\u3055\u308c\u308b\u5074\u3001AWS Account A\uff09\u306e Role \u306e ARN \u3092\u6307\u5b9a\u3059\u308b\u3002\n\n\u30a2\u30af\u30bb\u30b9\u3059\u308b\u5074\u306e Role \u306b\u5bfe\u3057\u3066\u306f\u3001S3 \u3078\u306e\u30a2\u30af\u30bb\u30b9\u3092\u8a31\u53ef\u3059\u308b Policy \u3092\u66f8\u3044\u3066\u3042\u3052\u308b\u3002\u304a\u304a\u3056\u3063\u3071\u306b\u66f8\u304f\u306a\u3089\u3053\u3093\u306a\u611f\u3058\u3002\u30d0\u30b1\u30c3\u30c8\u6307\u5b9a\u3055\u307c\u3063\u3066\u307e\u3059\u3002\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"s3:ListBucket\", \"s3:GetObject\"\n      ],\n      \"Resource\": [\n        \"arn:aws:s3:::*\"\n      ]\n    }\n  ]\n}\n\n\u3053\u308c\u3067\u5225\u30a2\u30ab\u30a6\u30f3\u30c8\u306e EC2 \u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u304b\u3089 aws s3 \u30b3\u30de\u30f3\u30c9\u3067\u3082\u306b\u3087\u3082\u306b\u3087\u3067\u304d\u305f\u3002\n\u53c2\u8003:\n\nIAM policies and Bucket Policies and ACLs! Oh My! (Controlling Access to S3 Resources) - AWS Security Blog\nBucket Policy Examples - Amazon Simple Storage Service\n\n\u30bf\u30a4\u30c8\u30eb\u9577\u3059\u304e\uff01\n\n[IAM \u30ed\u30fc\u30eb\u3092\u4f7f\u7528\u3057\u305f\u30af\u30ed\u30b9\u30a2\u30ab\u30a6\u30f3\u30c8 API \u30a2\u30af\u30bb\u30b9\u306e\u30a6\u30a9\u30fc\u30af\u30b9\u30eb\u30fc - AWS Identity and Access Management](http://docs.aws.amazon.com/ja_jp/IAM/latest/UserGuide/cross-acct-access-walkthrough.html) \u3092\u8aad\u3093\u3067\u307f\u305f\u3093\u3060\u3051\u3069\u3001\u3084\u305f\u3089\u9762\u5012\u3060\u3063\u305f\u308a\u3001\u82e5\u5e72\u3084\u308a\u305f\u3044\u3053\u3068\u3068\u305a\u308c\u3066\u305f\u308a\u3057\u305f\u306e\u3067\u3001bucket policy \u3067\u306a\u3093\u3068\u304b\u3057\u3066\u307f\u305f\u3002\n\n```text\n+--AWS\u2009Account\u2009A------+\u2009\u2009\u2009\u2009\u2009\u2009\u2009\u2009\u2009\u2009\u2009\u2009\u2009\u2009+---AWS\u2009Account\u2009B----+\n|    EC2\u2009Instance \u2009 --+------------+---->\u2009S3\u2009Bucket\u2009\u2009\u2009\u2009\u2009 |\n|     (IAM Role)      |            |   (Bucket Policy)  |\n+---------------------+\u2009\u2009\u2009\u2009\u2009\u2009\u2009\u2009\u2009\u2009\u2009\u2009\u2009\u2009+-------------------+\n```\n\n```json\n{\n\t\"Version\": \"2012-10-17\",\n\t\"Statement\": [\n\t\t{\n\t\t\t\"Effect\": \"Allow\",\n\t\t\t\"Principal\": {\n\t\t\t\t\"AWS\": \"arn:aws:iam::XXXXXXXXXXXX:role/SomeRole\"\n\t\t\t},\n\t\t\t\"Action\": \"s3:ListBucket\",\n\t\t\t\"Resource\": [\n\t\t\t\t\"arn:aws:s3:::bucket-name\"\n\t\t\t]\n\t\t},\n\t\t{\n\t\t\t\"Effect\": \"Allow\",\n\t\t\t\"Principal\": {\n\t\t\t\t\"AWS\": \"arn:aws:iam::XXXXXXXXXXXX:role/SomeRole\"\n\t\t\t},\n\t\t\t\"Action\": [\n\t\t\t\t\"s3:GetObject\",\n\t\t\t\t\"s3:PutObject\",\n\t\t\t\t\"s3:DeleteObject\"\n\t\t\t],\n\t\t\t\"Resource\": [\n\t\t\t\t\"arn:aws:s3:::bucket-name/*\"\n\t\t\t]\n\t\t}\n\t]\n}\n```\n\nPrincipal \u306b\u306f\u3001\u30a2\u30af\u30bb\u30b9\u3059\u308b\u5074\uff08\u30a2\u30af\u30bb\u30b9\u3092\u8a31\u53ef\u3055\u308c\u308b\u5074\u3001AWS Account A\uff09\u306e Role \u306e ARN \u3092\u6307\u5b9a\u3059\u308b\u3002\n\n![iam.png](https://qiita-image-store.s3.amazonaws.com/0/6870/77ff95a1-f8c3-28b5-2279-6b68dcfcdf98.png)\n\n\u30a2\u30af\u30bb\u30b9\u3059\u308b\u5074\u306e Role \u306b\u5bfe\u3057\u3066\u306f\u3001S3 \u3078\u306e\u30a2\u30af\u30bb\u30b9\u3092\u8a31\u53ef\u3059\u308b Policy \u3092\u66f8\u3044\u3066\u3042\u3052\u308b\u3002\u304a\u304a\u3056\u3063\u3071\u306b\u66f8\u304f\u306a\u3089\u3053\u3093\u306a\u611f\u3058\u3002\u30d0\u30b1\u30c3\u30c8\u6307\u5b9a\u3055\u307c\u3063\u3066\u307e\u3059\u3002\n\n```json\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"s3:ListBucket\", \"s3:GetObject\"\n      ],\n      \"Resource\": [\n        \"arn:aws:s3:::*\"\n      ]\n    }\n  ]\n}\n```\n\n\u3053\u308c\u3067\u5225\u30a2\u30ab\u30a6\u30f3\u30c8\u306e EC2 \u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u304b\u3089 aws s3 \u30b3\u30de\u30f3\u30c9\u3067\u3082\u306b\u3087\u3082\u306b\u3087\u3067\u304d\u305f\u3002\n\n\u53c2\u8003:\n\n - [IAM policies and Bucket Policies and ACLs! Oh My! (Controlling Access to S3 Resources) - AWS Security Blog](http://blogs.aws.amazon.com/security/post/TxPOJBY6FE360K/IAM-policies-and-Bucket-Policies-and-ACLs-Oh-My-Controlling-Access-to-S3-Resourc)\n - [Bucket Policy Examples - Amazon Simple Storage Service](http://docs.aws.amazon.com/AmazonS3/latest/dev/example-bucket-policies.html)\n", "tags": ["AWS", "S3"]}