{"context": "RDO\u3092\u4f7f\u7528\u3057\u305fNewton\u7248OpenStack\u69cb\u7bc9\u30e1\u30e2\u3067\u3059\u3002\n\n\u25a0 OpenStack\u74b0\u5883\u6574\u5099\u306e\u76ee\u6a19\u611f\nKVM\u74b0\u5883\u3092\u6574\u5099\u3057\u3066\u3001OpenStack\u7528\u306e\u4eee\u60f3\u30de\u30b7\u30f3\u3092\u30c7\u30d7\u30ed\u30a4\u3057\u307e\u3059\u3002\n\u5fc5\u8981\u6700\u5c0f\u9650\u306aAll-In-One\u69cb\u6210\u3092\u76ee\u6307\u3057\u307e\u3059\u3002\n\n\u4eee\u60f3\u30de\u30b7\u30f3\u540d\uff1anewton\nCPU\u6570\uff1a4CPU\n\u30e1\u30e2\u30ea\uff1a8,192MB\n\u30cf\u30fc\u30c9\u30c7\u30a3\u30b9\u30af\uff1a80GB\nCentOS\u30d0\u30fc\u30b8\u30e7\u30f3\uff1aCentOS Linux release 7.3.1611 (Core) \n\n\n\u25a0 OpenStack\u69cb\u7bc9\u30e1\u30e2\n\n(1) CentOS\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\u307e\u305a\u306f\u3001OpenStack\u69cb\u7bc9\u3059\u308b\u305f\u3081\u306eLinux\u6bcd\u8266\u3068\u3057\u3066\u3001CentOS\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\n\n\"CentOS-7-x86_64-Minimal-1611.iso\"\u306e\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\uff08/home/tsubo/iso\u914d\u4e0b\u306b\u7f6e\u304f\u3082\u306e\u3068\u3059\u308b\uff09\nCentOS\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n$ sudo virt-install \\\n> --name newton \\\n> --ram 8192 \\\n> --disk path=/var/lib/libvirt/images/newton.qcow2,size=80,bus=virtio,format=qcow2 \\\n> --vcpus 4 \\\n> --os-variant rhel7 \\\n> --network bridge=br-ext \\\n> --graphics none \\\n> --console pty,target_type=serial \\\n> --location /home/tsubo/iso/CentOS-7-x86_64-Minimal-1611.iso \\\n> --extra-args 'console=ttyS0,115200n8 serial'\n\n\n\u30c6\u30ad\u30b9\u30c8\u30e2\u30fc\u30c9\u3067\u306e\u5404\u7a2e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u306e\u30d1\u30e9\u30e1\u30fc\u30bf\u8a2d\u5b9a\n\nStarting installer, one moment...\nanaconda 21.48.22.93-1 for CentOS Linux 7 started.\n * installation log files are stored in /tmp during the installation\n * shell is available on TTY2\n * when reporting a bug add logs from /tmp as separate text/plain attachments\n00:47:09 Not asking for VNC because we don't have a network\n================================================================================\n================================================================================\nInstallation\n\n 1) [x] Language settings                 2) [!] Time settings\n        (English (United States))                (Timezone is not set.)\n 3) [!] Installation source               4) [!] Software selection\n        (Processing...)                          (Processing...)\n 5) [!] Installation Destination          6) [x] Kdump\n        (No disks selected)                      (Kdump is enabled)\n 7) [ ] Network configuration             8) [!] Root password\n        (Not connected)                          (Password is not set.)\n 9) [!] User creation\n        (No user will be created)\n  Please make your choice from above ['q' to quit | 'b' to begin installation |\n  'r' to refresh]: \n\n[anaconda] 1:main* 2:shell  3:log  4:storage-lo> Switch tab: Alt+Tab | Help: F1 \n\n\u301c \u4ee5\u4e0b\u3001\u7701\u7565\u3000\u301c\n\nIntel VT-x\u306e\u6709\u52b9\u5316\u306e\u305f\u3081\u3001xml\u30d5\u30a1\u30a4\u30eb\u7de8\u96c6\n\n$ sudo virsh define /etc/libvirt/qemu/newton.xml \n$ virsh dumpxml newton\n  ...\n\n  <cpu mode='custom' match='exact'>\n    <model fallback='allow'>IvyBridge</model>\n    <feature policy='require' name='vmx'/>\n  </cpu>\n\n  ...\n\n\n\"newton\"\u4eee\u60f3\u30de\u30b7\u30f3\u306e\u8d77\u52d5\n\n$ virsh start newton\n\n\n\"newton\"\u4eee\u60f3\u30de\u30b7\u30f3\u4e0a\u3067\u3001vt-x\u304c\u6709\u52b9\u5316\u306e\u78ba\u8a8d\n\n[root@newton ~]# cat /proc/cpuinfo | grep vmx\nflags       : fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush mmx fxsr sse sse2 syscall nx rdtscp lm constant_tsc rep_good nopl eagerfpu pni pclmulqdq vmx ssse3 cx16 sse4_1 sse4_2 x2apic popcnt tsc_deadline_timer aes xsave avx f16c rdrand hypervisor lahf_lm arat tpr_shadow vnmi flexpriority ept vpid fsgsbase smep erms xsaveopt\nflags       : fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush mmx fxsr sse sse2 syscall nx rdtscp lm constant_tsc rep_good nopl eagerfpu pni pclmulqdq vmx ssse3 cx16 sse4_1 sse4_2 x2apic popcnt tsc_deadline_timer aes xsave avx f16c rdrand hypervisor lahf_lm arat tpr_shadow vnmi flexpriority ept vpid fsgsbase smep erms xsaveopt\nflags       : fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush mmx fxsr sse sse2 syscall nx rdtscp lm constant_tsc rep_good nopl eagerfpu pni pclmulqdq vmx ssse3 cx16 sse4_1 sse4_2 x2apic popcnt tsc_deadline_timer aes xsave avx f16c rdrand hypervisor lahf_lm arat tpr_shadow vnmi flexpriority ept vpid fsgsbase smep erms xsaveopt\nflags       : fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush mmx fxsr sse sse2 syscall nx rdtscp lm constant_tsc rep_good nopl eagerfpu pni pclmulqdq vmx ssse3 cx16 sse4_1 sse4_2 x2apic popcnt tsc_deadline_timer aes xsave avx f16c rdrand hypervisor lahf_lm arat tpr_shadow vnmi flexpriority ept vpid fsgsbase smep erms xsaveopt\n\n\nntp\u306e\u8a2d\u5b9a\n\n[root@newton ~]# yum install -y ntp\n[root@newton ~]# echo \"server ntp.nict.jp prefer iburst\" >> /etc/ntp.conf\n[root@newton ~]# systemctl start ntpd\n[root@newton ~]# systemctl enable ntpd\n\n\nFirewall\u306e\u7121\u52b9\u5316\n\n[root@newton ~]# yum install -y iptables-services\n[root@newton ~]# systemctl stop firewalld.service\n[root@newton ~]# systemctl disable firewalld.service\n[root@newton ~]# systemctl start iptables.service\n[root@newton ~]# systemctl enable iptables.service\n\n\nSELinux\u306e\u7121\u52b9\u5316\n\n[root@newton ~]# sed -i \"s/SELINUX=.*/SELINUX=permissive/\" /etc/selinux/config\n[root@newton ~]# setenforce 0\n\n\n\u82f1\u8a9e\u30ed\u30b1\u30fc\u30eb\u8a2d\u5b9a\n\n[root@newton ~]# echo \"LANG=en_US.utf-8\" > /etc/environment\n[root@newton ~]# echo \"LC_ALL=en_US.utf-8\" >> /etc/environment\n\n\n\u30ab\u30fc\u30cd\u30eb\u30d1\u30e9\u30e1\u30fc\u30bf\u306e\u8a2d\u5b9a\n\n# cat <<'EOF' > /etc/sysconfig/modules/openstack-neutron.modules\n> #!/bin/sh\n> modprobe -b bridge >/dev/null 2>&1\n> exit 0\n> EOF\n\n# chmod u+x /etc/sysconfig/modules/openstack-neutron.modules\n\n# cat <<'EOF' > /etc/sysctl.d/bridge-nf-call\n> net.bridge.bridge-nf-call-ip6tables = 1\n> net.bridge.bridge-nf-call-iptables = 1\n> net.bridge.bridge-nf-call-arptables = 1\n> EOF\n\n\n(2) RDO\u74b0\u5883\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\n\nRDO\u306e\u30d1\u30c3\u30b1\u30fc\u30b8\u3068PackStack\u306e\u53d6\u5f97\n\n[root@newton ~]# yum install -y centos-release-openstack-newton\n[root@newton ~]# yum update -y\n[root@newton ~]# yum install -y openstack-packstack\n[root@newton ~]# reboot\n\n\nAnswer File\u306e\u4f5c\u6210\n\n[root@newton ~]# cd /root\n[root@newton ~]# packstack --gen-answer-file=/root/answer.txt \\\n> --default-password=secrete \\\n> --os-heat-install=y \\\n> --os-heat-cloudwatch-install=y \\\n> --os-heat-cfn-install=y \\\n> \n\n\nPackStack\u306e\u5b9f\u884c\n\n[root@newton ~]# packstack --answer-file=/root/answer.txt\nWelcome to the Packstack setup utility\n\nThe installation log file is available at: /var/tmp/packstack/20170202-113439-SALMrK/openstack-setup.log\n\nInstalling:\nClean Up                                             [ DONE ]\nDiscovering ip protocol version                      [ DONE ]\nSetting up ssh keys                                  [ DONE ]\n\n... (snip)\n\n10.79.5.190_compute.pp:                              [ DONE ]     \nApplying Puppet manifests                            [ DONE ]\nFinalizing                                           [ DONE ]\n\n **** Installation completed successfully ******\n\nAdditional information:\n * Time synchronization installation was skipped. Please note that unsynchronized time on server instances might be problem for some OpenStack components.\n * Warning: NetworkManager is active on 10.79.5.190. OpenStack networking currently does not work on systems that have the Network Manager service enabled.\n * File /root/keystonerc_admin has been created on OpenStack client host 10.79.5.190. To use the command line tools you need to source the file.\n * To access the OpenStack Dashboard browse to http://10.79.5.190/dashboard .\nPlease, find your login credentials stored in the keystonerc_admin in your home directory.\n * To use Nagios, browse to http://10.79.5.190/nagios username: nagiosadmin, password: secrete\n * Because of the kernel update the host 10.79.5.190 requires reboot.\n * The installation log file is available at: /var/tmp/packstack/20170202-134107-oxzCAT/openstack-setup.log\n * The generated manifests are available at: /var/tmp/packstack/20170202-134107-oxzCAT/manifests\n\n\nNetworkManager\u306e\u7121\u52b9\u5316\n\n[root@newton ~]# systemctl stop NetworkManager\n[root@newton ~]# systemctl disable NetworkManager\n\n\nOpenStack\u69cb\u7bc9\u7d50\u679c\u306e\u78ba\u8a8d\n\n[root@newton ~]# yum install -y openstack-utils\n[root@newton ~]# cd /root\n[root@newton ~]# source keystonerc_admin\n[root@newton ~(keystone_admin)]# openstack-status\n== Nova services ==\nopenstack-nova-api:                     active\nopenstack-nova-compute:                 active\nopenstack-nova-network:                 inactive  (disabled on boot)\nopenstack-nova-scheduler:               active\nopenstack-nova-cert:                    active\nopenstack-nova-conductor:               active\nopenstack-nova-console:                 inactive  (disabled on boot)\nopenstack-nova-consoleauth:             active\nopenstack-nova-xvpvncproxy:             inactive  (disabled on boot)\n== Glance services ==\nopenstack-glance-api:                   active\nopenstack-glance-registry:              active\n== Keystone service ==\nopenstack-keystone:                     inactive  (disabled on boot)\n== Horizon service ==\nopenstack-dashboard:                    active\n== neutron services ==\nneutron-server:                         active\nneutron-dhcp-agent:                     active\nneutron-l3-agent:                       active\nneutron-metadata-agent:                 active\nneutron-openvswitch-agent:              active\nneutron-metering-agent:                 active\n== Cinder services ==\nopenstack-cinder-api:                   active\nopenstack-cinder-scheduler:             active\nopenstack-cinder-volume:                active\nopenstack-cinder-backup:                active\n== Ceilometer services ==\nopenstack-ceilometer-api:               inactive  (disabled on boot)\nopenstack-ceilometer-central:           active\nopenstack-ceilometer-compute:           active\nopenstack-ceilometer-collector:         active\nopenstack-ceilometer-notification:      active\n== Heat services ==\nopenstack-heat-api:                     active\nopenstack-heat-api-cfn:                 active\nopenstack-heat-api-cloudwatch:          active\nopenstack-heat-engine:                  active\n== Support services ==\nmariadb:                                active\nopenvswitch:                            active\ndbus:                                   active\ntarget:                                 active\nrabbitmq-server:                        active\nmemcached:                              active\n== Keystone users ==\n/usr/bin/openstack-status: line 267: keystone: command not found\n== Glance images ==\n+--------------------------------------+--------+\n| ID                                   | Name   |\n+--------------------------------------+--------+\n| f91e45cb-114e-4322-8883-109f7392c912 | cirros |\n+--------------------------------------+--------+\n== Nova managed services ==\n+----+------------------+--------+----------+---------+-------+----------------------------+-----------------+\n| Id | Binary           | Host   | Zone     | Status  | State | Updated_at                 | Disabled Reason |\n+----+------------------+--------+----------+---------+-------+----------------------------+-----------------+\n| 1  | nova-cert        | newton | internal | enabled | up    | 2017-02-02T05:03:55.000000 | -               |\n| 2  | nova-consoleauth | newton | internal | enabled | up    | 2017-02-02T05:03:55.000000 | -               |\n| 7  | nova-scheduler   | newton | internal | enabled | up    | 2017-02-02T05:03:54.000000 | -               |\n| 8  | nova-conductor   | newton | internal | enabled | up    | 2017-02-02T05:03:55.000000 | -               |\n| 9  | nova-compute     | newton | nova     | enabled | up    | 2017-02-02T05:03:49.000000 | -               |\n+----+------------------+--------+----------+---------+-------+----------------------------+-----------------+\n== Nova networks ==\nWARNING: Command network-list is deprecated and will be removed after Nova 15.0.0 is released. Use python-neutronclient or python-openstackclient instead.\n+--------------------------------------+---------+------+\n| ID                                   | Label   | Cidr |\n+--------------------------------------+---------+------+\n| a0a076fe-fd31-4f37-a8ba-1f3d77ebb1da | public  | -    |\n| bfb970fd-e8a6-4286-8f4e-59be750f76ed | private | -    |\n+--------------------------------------+---------+------+\n== Nova instance flavors ==\n+----+-----------+-----------+------+-----------+------+-------+-------------+-----------+\n| ID | Name      | Memory_MB | Disk | Ephemeral | Swap | VCPUs | RXTX_Factor | Is_Public |\n+----+-----------+-----------+------+-----------+------+-------+-------------+-----------+\n| 1  | m1.tiny   | 512       | 1    | 0         |      | 1     | 1.0         | True      |\n| 2  | m1.small  | 2048      | 20   | 0         |      | 1     | 1.0         | True      |\n| 3  | m1.medium | 4096      | 40   | 0         |      | 2     | 1.0         | True      |\n| 4  | m1.large  | 8192      | 80   | 0         |      | 4     | 1.0         | True      |\n| 5  | m1.xlarge | 16384     | 160  | 0         |      | 8     | 1.0         | True      |\n+----+-----------+-----------+------+-----------+------+-------+-------------+-----------+\n== Nova instances ==\n+----+------+-----------+--------+------------+-------------+----------+\n| ID | Name | Tenant ID | Status | Task State | Power State | Networks |\n+----+------+-----------+--------+------------+-------------+----------+\n+----+------+-----------+--------+------------+-------------+----------+\n\n\n\u73fe\u72b6\u306e\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u60c5\u5831\u306e\u78ba\u8a8d\n\n[root@newton ~]# ip addr\n1: lo: <LOOPBACK,UP,LOWER_UP> mtu 65536 qdisc noqueue state UNKNOWN qlen 1\n    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00\n    inet 127.0.0.1/8 scope host lo\n       valid_lft forever preferred_lft forever\n    inet6 ::1/128 scope host \n       valid_lft forever preferred_lft forever\n2: eth0: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc pfifo_fast state UP qlen 1000\n    link/ether 52:54:00:da:d9:d6 brd ff:ff:ff:ff:ff:ff\n    inet 10.79.5.190/24 brd 10.79.5.255 scope global eth0\n       valid_lft forever preferred_lft forever\n    inet6 fe80::5054:ff:feda:d9d6/64 scope link \n       valid_lft forever preferred_lft forever\n3: ovs-system: <BROADCAST,MULTICAST> mtu 1500 qdisc noop state DOWN qlen 1000\n    link/ether ae:d6:ce:67:cc:ba brd ff:ff:ff:ff:ff:ff\n5: br-int: <BROADCAST,MULTICAST> mtu 1500 qdisc noop state DOWN qlen 1000\n    link/ether 7a:4a:e3:ba:2e:44 brd ff:ff:ff:ff:ff:ff\n7: br-tun: <BROADCAST,MULTICAST> mtu 1500 qdisc noop state DOWN qlen 1000\n    link/ether e6:16:11:c4:52:47 brd ff:ff:ff:ff:ff:ff\n9: br-ex: <BROADCAST,MULTICAST> mtu 1500 qdisc noop state DOWN qlen 1000\n    link/ether c2:46:27:8a:20:4d brd ff:ff:ff:ff:ff:ff\n\n\n\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u30d6\u30ea\u30c3\u30b8\u306e\u8a2d\u5b9a\n\n[root@newton ~]# ovs-vsctl list-br\nbr-ex\nbr-int\nbr-tun\n\n[root@newton ~]# vi /etc/sysconfig/network-scripts/ifcfg-br-ex\n\n\n/etc/sysconfig/network-scripts/ifcfg-br-ex\nDEVICE=br-ex\nDEVICETYPE=ovs\nTYPE=OVSBridge\nBOOTPROTO=static\nIPADDR=10.79.5.190\nNETMASK=255.255.255.0\nGATEWAY=10.79.5.1\nDEFROUTE=yes\nONBOOT=yes\n\n\n[root@newton ~]# vi /etc/sysconfig/network-scripts/ifcfg-eth0\n\n\n/etc/sysconfig/network-scripts/ifcfg-eth0\nDEVICE=eth0\nTYPE=OVSPort\nDEVICETYPE=ovs\nNM_CONTROLLED=no\nONBOOT=yes\nOVS_BRIDGE=br-ex\n\n\n\n\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u518d\u8d77\u52d5\n\n[root@newton ~]# service network restart\n\n\n\u518d\u5ea6\u3001\u73fe\u72b6\u306e\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u60c5\u5831\u306e\u78ba\u8a8d\n\n[root@newton ~]# ip addr\n1: lo: <LOOPBACK,UP,LOWER_UP> mtu 65536 qdisc noqueue state UNKNOWN qlen 1\n    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00\n    inet 127.0.0.1/8 scope host lo\n       valid_lft forever preferred_lft forever\n    inet6 ::1/128 scope host \n       valid_lft forever preferred_lft forever\n2: eth0: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc pfifo_fast master ovs-system state UP qlen 1000\n    link/ether 52:54:00:da:d9:d6 brd ff:ff:ff:ff:ff:ff\n    inet6 fe80::5054:ff:feda:d9d6/64 scope link \n       valid_lft forever preferred_lft forever\n3: ovs-system: <BROADCAST,MULTICAST> mtu 1500 qdisc noop state DOWN qlen 1000\n    link/ether ae:d6:ce:67:cc:ba brd ff:ff:ff:ff:ff:ff\n5: br-int: <BROADCAST,MULTICAST> mtu 1500 qdisc noop state DOWN qlen 1000\n    link/ether 7a:4a:e3:ba:2e:44 brd ff:ff:ff:ff:ff:ff\n7: br-tun: <BROADCAST,MULTICAST> mtu 1500 qdisc noop state DOWN qlen 1000\n    link/ether e6:16:11:c4:52:47 brd ff:ff:ff:ff:ff:ff\n9: br-ex: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UNKNOWN qlen 1000\n    link/ether c2:46:27:8a:20:4d brd ff:ff:ff:ff:ff:ff\n    inet 10.79.5.190/24 brd 10.79.5.255 scope global br-ex\n       valid_lft forever preferred_lft forever\n    inet6 fe80::c046:27ff:fe8a:204d/64 scope link \n       valid_lft forever preferred_lft forever\n\n\n\u25a0 OpenStack\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u5f8c\u306e\u5404\u7a2e\u8a2d\u5b9a\n\n(1) neutron\u4eee\u60f3\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u518d\u69cb\u7bc9\n\n\u30c7\u30d5\u30a9\u30eb\u30c9\u306e\u4eee\u60f3\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306e\u524a\u9664\n\n[root@newton ~]# cd /root\n[root@newton ~]# source /root/keystonerc_admin\n[root@newton ~(keystone_admin)]# neutron router-gateway-clear router1\n[root@newton ~(keystone_admin)]# neutron router-interface-delete router1 private_subnet\n[root@newton ~(keystone_admin)]# openstack router delete router1\n[root@newton ~(keystone_admin)]# openstack network delete private\n[root@newton ~(keystone_admin)]# openstack network delete public\n\n\n\u201cPublic_net\u201d\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306e\u4f5c\u6210\n\n[root@newton ~]# cd /root\n[root@newton ~]# source /root/keystonerc_admin\n[root@newton ~(keystone_admin)]# openstack network create public_net --external\n+---------------------------+--------------------------------------+\n| Field                     | Value                                |\n+---------------------------+--------------------------------------+\n| admin_state_up            | UP                                   |\n| availability_zone_hints   |                                      |\n| availability_zones        |                                      |\n| created_at                | 2017-02-02T09:02:02Z                 |\n| description               |                                      |\n| headers                   |                                      |\n| id                        | c920de08-7acf-44c9-8b13-b97033312267 |\n| ipv4_address_scope        | None                                 |\n| ipv6_address_scope        | None                                 |\n| is_default                | False                                |\n| mtu                       | 1450                                 |\n| name                      | public_net                           |\n| project_id                | f88a985676884b468bb75550d4e86999     |\n| project_id                | f88a985676884b468bb75550d4e86999     |\n| provider:network_type     | vxlan                                |\n| provider:physical_network | None                                 |\n| provider:segmentation_id  | 62                                   |\n| revision_number           | 2                                    |\n| router:external           | External                             |\n| shared                    | False                                |\n| status                    | ACTIVE                               |\n| subnets                   |                                      |\n| tags                      | []                                   |\n| updated_at                | 2017-02-02T09:02:02Z                 |\n+---------------------------+--------------------------------------+\n\n\n\u201cPublic_subnet\u201d\u30b5\u30d6\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306e\u4f5c\u6210\n\n[root@newton ~(keystone_admin)]# openstack subnet create public_subnet \\\n> --subnet-range 10.79.5.0/24 \\\n> --allocation-pool start=10.79.5.191,end=10.79.5.195 \\\n> --gateway 10.79.5.1 \\\n> --no-dhcp \\\n> --network public_net\n+-------------------+--------------------------------------+\n| Field             | Value                                |\n+-------------------+--------------------------------------+\n| allocation_pools  | 10.79.5.191-10.79.5.195              |\n| cidr              | 10.79.5.0/24                         |\n| created_at        | 2017-02-02T09:04:39Z                 |\n| description       |                                      |\n| dns_nameservers   |                                      |\n| enable_dhcp       | False                                |\n| gateway_ip        | 10.79.5.1                            |\n| headers           |                                      |\n| host_routes       |                                      |\n| id                | 2bb1c25e-aafb-407d-bf4d-a54e97c4cf0b |\n| ip_version        | 4                                    |\n| ipv6_address_mode | None                                 |\n| ipv6_ra_mode      | None                                 |\n| name              | public_subnet                        |\n| network_id        | c920de08-7acf-44c9-8b13-b97033312267 |\n| project_id        | f88a985676884b468bb75550d4e86999     |\n| project_id        | f88a985676884b468bb75550d4e86999     |\n| revision_number   | 2                                    |\n| service_types     | []                                   |\n| subnetpool_id     | None                                 |\n| updated_at        | 2017-02-02T09:04:39Z                 |\n+-------------------+--------------------------------------+\n\n\n\u201cadmin_net\u201d\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306e\u4f5c\u6210\n\n[root@newton ~]# cd /root\n[root@newton ~]# source /root/keystonerc_demo\n[root@newton ~(keystone_demo)]# openstack network create admin_net\n+-------------------------+--------------------------------------+\n| Field                   | Value                                |\n+-------------------------+--------------------------------------+\n| admin_state_up          | UP                                   |\n| availability_zone_hints |                                      |\n| availability_zones      |                                      |\n| created_at              | 2017-02-02T09:06:10Z                 |\n| description             |                                      |\n| headers                 |                                      |\n| id                      | 9ea97f2d-7ead-44b1-91e1-afc7ca22e21e |\n| ipv4_address_scope      | None                                 |\n| ipv6_address_scope      | None                                 |\n| mtu                     | 1450                                 |\n| name                    | admin_net                            |\n| project_id              | 67d85efd952f4b6a8c03c6f86fecb8ea     |\n| project_id              | 67d85efd952f4b6a8c03c6f86fecb8ea     |\n| revision_number         | 2                                    |\n| router:external         | Internal                             |\n| shared                  | False                                |\n| status                  | ACTIVE                               |\n| subnets                 |                                      |\n| tags                    | []                                   |\n| updated_at              | 2017-02-02T09:06:10Z                 |\n+-------------------------+--------------------------------------+\n\n\n\u201cadmin_subnet\u201d\u30b5\u30d6\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306e\u4f5c\u6210\n\n[root@newton ~(keystone_demo)]# openstack subnet create admin_subnet \\\n> --subnet-range 10.0.0.0/24 \\\n> --allocation-pool start=10.0.0.2,end=10.0.0.100 \\\n> --gateway 10.0.0.1 \\\n> --network admin_net\n+-------------------+--------------------------------------+\n| Field             | Value                                |\n+-------------------+--------------------------------------+\n| allocation_pools  | 10.0.0.2-10.0.0.100                  |\n| cidr              | 10.0.0.0/24                          |\n| created_at        | 2017-02-02T09:07:33Z                 |\n| description       |                                      |\n| dns_nameservers   |                                      |\n| enable_dhcp       | True                                 |\n| gateway_ip        | 10.0.0.1                             |\n| headers           |                                      |\n| host_routes       |                                      |\n| id                | 31a40092-042b-4f27-a00c-54c9324db2ac |\n| ip_version        | 4                                    |\n| ipv6_address_mode | None                                 |\n| ipv6_ra_mode      | None                                 |\n| name              | admin_subnet                         |\n| network_id        | 9ea97f2d-7ead-44b1-91e1-afc7ca22e21e |\n| project_id        | 67d85efd952f4b6a8c03c6f86fecb8ea     |\n| project_id        | 67d85efd952f4b6a8c03c6f86fecb8ea     |\n| revision_number   | 2                                    |\n| service_types     | []                                   |\n| subnetpool_id     | None                                 |\n| updated_at        | 2017-02-02T09:07:33Z                 |\n+-------------------+--------------------------------------+\n\n\n\u201cuser_net\u201d\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306e\u4f5c\u6210\n\n[root@newton ~(keystone_demo)]# openstack network create user_net\n+-------------------------+--------------------------------------+\n| Field                   | Value                                |\n+-------------------------+--------------------------------------+\n| admin_state_up          | UP                                   |\n| availability_zone_hints |                                      |\n| availability_zones      |                                      |\n| created_at              | 2017-02-02T09:09:05Z                 |\n| description             |                                      |\n| headers                 |                                      |\n| id                      | 80feacbb-6bd5-4a3a-adff-a715b78c5d3e |\n| ipv4_address_scope      | None                                 |\n| ipv6_address_scope      | None                                 |\n| mtu                     | 1450                                 |\n| name                    | user_net                             |\n| project_id              | 67d85efd952f4b6a8c03c6f86fecb8ea     |\n| project_id              | 67d85efd952f4b6a8c03c6f86fecb8ea     |\n| revision_number         | 2                                    |\n| router:external         | Internal                             |\n| shared                  | False                                |\n| status                  | ACTIVE                               |\n| subnets                 |                                      |\n| tags                    | []                                   |\n| updated_at              | 2017-02-02T09:09:05Z                 |\n+-------------------------+--------------------------------------+\n\n\n\u201cuser_subnet\u201d\u30b5\u30d6\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306e\u4f5c\u6210\n\n[root@newton ~(keystone_demo)]# openstack subnet create user_subnet \\\n> --subnet-range 172.16.0.0/24 \\\n> --allocation-pool start=172.16.0.2,end=172.16.0.100 \\\n> --gateway 172.16.0.1 \\\n> --network user_net\n+-------------------+--------------------------------------+\n| Field             | Value                                |\n+-------------------+--------------------------------------+\n| allocation_pools  | 172.16.0.2-172.16.0.100              |\n| cidr              | 172.16.0.0/24                        |\n| created_at        | 2017-02-02T09:09:56Z                 |\n| description       |                                      |\n| dns_nameservers   |                                      |\n| enable_dhcp       | True                                 |\n| gateway_ip        | 172.16.0.1                           |\n| headers           |                                      |\n| host_routes       |                                      |\n| id                | 9f0e59df-d6c8-4c2d-9de5-8979798e5350 |\n| ip_version        | 4                                    |\n| ipv6_address_mode | None                                 |\n| ipv6_ra_mode      | None                                 |\n| name              | user_subnet                          |\n| network_id        | 80feacbb-6bd5-4a3a-adff-a715b78c5d3e |\n| project_id        | 67d85efd952f4b6a8c03c6f86fecb8ea     |\n| project_id        | 67d85efd952f4b6a8c03c6f86fecb8ea     |\n| revision_number   | 2                                    |\n| service_types     | []                                   |\n| subnetpool_id     | None                                 |\n| updated_at        | 2017-02-02T09:09:56Z                 |\n+-------------------+--------------------------------------+\n\n\n\u30eb\u30fc\u30bf\u30fc\u306e\u4f5c\u6210\n\n[root@newton ~]# cd /root\n[root@newton ~]# source /root/keystonerc_demo\n[root@newton ~(keystone_demo)]# openstack router create router1\n+-------------------------+--------------------------------------+\n| Field                   | Value                                |\n+-------------------------+--------------------------------------+\n| admin_state_up          | UP                                   |\n| availability_zone_hints |                                      |\n| availability_zones      |                                      |\n| created_at              | 2017-02-02T09:10:50Z                 |\n| description             |                                      |\n| external_gateway_info   | null                                 |\n| flavor_id               | None                                 |\n| headers                 |                                      |\n| id                      | 5ac71d5c-7c98-43d5-a59d-e219902fa867 |\n| name                    | router1                              |\n| project_id              | 67d85efd952f4b6a8c03c6f86fecb8ea     |\n| project_id              | 67d85efd952f4b6a8c03c6f86fecb8ea     |\n| revision_number         | 2                                    |\n| routes                  |                                      |\n| status                  | ACTIVE                               |\n| updated_at              | 2017-02-02T09:10:50Z                 |\n+-------------------------+--------------------------------------+\n\n[root@newton ~(keystone_demo)]# neutron router-gateway-set router1 public_net\n[root@newton ~(keystone_demo)]# neutron router-interface-add router1 admin_subnet\n\n\n(2) nova\u4eee\u60f3\u30de\u30b7\u30f3\u3092KVM\u30cf\u30a4\u30d1\u30fc\u30d0\u30a4\u30b6\u3067\u52d5\u4f5c\u3055\u305b\u308b\n\nINTEL VT-x\u306e\u6709\u52b9\u5316\n\n[root@newton ~]# sudo modprobe kvm_intel\n[root@newton ~]# lsmod|grep kvm\nkvm_intel             170181  0 \nkvm                   554609  1 kvm_intel\nirqbypass              13503  1 kvm\n\n\nnova\u8a2d\u5b9a\u306e\u5909\u66f4\n\n[root@newton ~]# vi /etc/nova/nova.conf\n\n\n/etc/nova/nova.conf\n# Allowed values: kvm, lxc, qemu, uml, xen, parallels\nvirt_type=kvm\n#virt_type=qemu\n\n\n\nOS\u518d\u8d77\u52d5\n\n[root@newton ~]# reboot\n\n\n(3) Ubuntu\u30a4\u30e1\u30fc\u30b8\u767b\u9332\n\nUbuntu 16.04\u30a4\u30e1\u30fc\u30b8\u30d5\u30a1\u30a4\u30eb\u306e\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\n\n[root@newton ~]# sudo yum install -y wget\n[root@newton ~]# wget http://cloud-images.ubuntu.com/releases/16.04/release/ubuntu-16.04-server-cloudimg-amd64-disk1.img -P /var/kvm/images\n\n\nGlane\u3078\u306e\u30a4\u30e1\u30fc\u30b8\u8ffd\u52a0\n\n[root@newton ~]# cd /root\n[root@newton ~]# source keystonerc_admin\n[root@newton ~(keystone_admin)]# glance image-create --name \"Ubuntu1604\" --file /var/kvm/images/ubuntu-16.04-server-cloudimg-amd64-disk1.img --disk-format qcow2 --container-format bare --visibility public\n+------------------+--------------------------------------+\n| Property         | Value                                |\n+------------------+--------------------------------------+\n| checksum         | 186969f89823de2586e36b87e0f69875     |\n| container_format | bare                                 |\n| created_at       | 2017-02-02T05:54:34Z                 |\n| disk_format      | qcow2                                |\n| id               | 343a2c82-2959-4221-b567-bfc113020488 |\n| min_disk         | 0                                    |\n| min_ram          | 0                                    |\n| name             | Ubuntu1604                           |\n| owner            | f88a985676884b468bb75550d4e86999     |\n| protected        | False                                |\n| size             | 322502656                            |\n| status           | active                               |\n| tags             | []                                   |\n| updated_at       | 2017-02-02T05:54:37Z                 |\n| virtual_size     | None                                 |\n| visibility       | public                               |\n+------------------+--------------------------------------+\n\n\n\u767b\u9332\u6e08\u307fGlance\u30a4\u30e1\u30fc\u30b8\u306e\u78ba\u8a8d\n\n[root@newton ~(keystone_admin)]# glance image-list\n+--------------------------------------+------------+\n| ID                                   | Name       |\n+--------------------------------------+------------+\n| f91e45cb-114e-4322-8883-109f7392c912 | cirros     |\n| 343a2c82-2959-4221-b567-bfc113020488 | Ubuntu1604 |\n+--------------------------------------+------------+\n\n\n(4) nova\u8af8\u8a2d\u5b9a\u306e\u8ffd\u52a0\n\nkeypair\u8ffd\u52a0\n\n[root@newton ~]# cd /root\n[root@newton ~]# source keystonerc_demo\n[root@newton ~(keystone_demo)]# openstack keypair create mykey\n-----BEGIN RSA PRIVATE KEY-----\n\n... (snip)\n\n-----END RSA PRIVATE KEY-----\n\n[root@newton ~(keystone_demo)]# nova keypair-list \n+-------+------+-------------------------------------------------+\n| Name  | Type | Fingerprint                                     |\n+-------+------+-------------------------------------------------+\n| mykey | ssh  | 04:8c:27:d1:44:b3:e1:19:1a:d6:d8:13:70:d3:f9:70 |\n+-------+------+-------------------------------------------------+\n\n\n\u30ed\u30fc\u30ab\u30ebPC\u74b0\u5883\u306b\u3001\u30d7\u30e9\u30a4\u30d9\u30fc\u30c8\u30ad\u30fc\u60c5\u5831\u3092\u4fdd\u5b58\n\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30b0\u30eb\u30fc\u30d7\u8a2d\u5b9a\u8ffd\u52a0\uff08ICMP\u9001\u4fe1/\u53d7\u4fe1, TCP\u306e\u5168\u30dd\u30fc\u30c8\u9001\u4fe1/\u53d7\u4fe1\u3092\u958b\u653e\uff09\n\n[root@newton ~(keystone_demo)]# neutron security-group-rule-create --protocol icmp default\nCreated a new security_group_rule:\n+-------------------+--------------------------------------+\n| Field             | Value                                |\n+-------------------+--------------------------------------+\n| created_at        | 2017-02-02T10:24:03Z                 |\n| description       |                                      |\n| direction         | ingress                              |\n| ethertype         | IPv4                                 |\n| id                | 7abf3219-5de4-4747-a8e8-e233c913ce13 |\n| port_range_max    |                                      |\n| port_range_min    |                                      |\n| project_id        | 67d85efd952f4b6a8c03c6f86fecb8ea     |\n| protocol          | icmp                                 |\n| remote_group_id   |                                      |\n| remote_ip_prefix  |                                      |\n| revision_number   | 1                                    |\n| security_group_id | bff315ad-0f08-45f8-8b14-5d19a9f95aa6 |\n| tenant_id         | 67d85efd952f4b6a8c03c6f86fecb8ea     |\n| updated_at        | 2017-02-02T10:24:03Z                 |\n+-------------------+--------------------------------------+\n\n[root@newton ~(keystone_demo)]# neutron security-group-rule-create --protocol tcp --port-range-min 1 --port-range-max 65535 default\nCreated a new security_group_rule:\n+-------------------+--------------------------------------+\n| Field             | Value                                |\n+-------------------+--------------------------------------+\n| created_at        | 2017-02-02T10:24:37Z                 |\n| description       |                                      |\n| direction         | ingress                              |\n| ethertype         | IPv4                                 |\n| id                | d8a982f6-99cc-4f73-ac35-814842937760 |\n| port_range_max    | 65535                                |\n| port_range_min    | 1                                    |\n| project_id        | 67d85efd952f4b6a8c03c6f86fecb8ea     |\n| protocol          | tcp                                  |\n| remote_group_id   |                                      |\n| remote_ip_prefix  |                                      |\n| revision_number   | 1                                    |\n| security_group_id | bff315ad-0f08-45f8-8b14-5d19a9f95aa6 |\n| tenant_id         | 67d85efd952f4b6a8c03c6f86fecb8ea     |\n| updated_at        | 2017-02-02T10:24:37Z                 |\n+-------------------+--------------------------------------+\n\n\n\u767b\u9332\u6e08\u307f\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30dd\u30ea\u30b7\u306e\u78ba\u8a8d\n\n[root@newton ~(keystone_demo)]# neutron security-group-list\n+--------------------------------------+---------+----------------------------------------------------------------------+\n| id                                   | name    | security_group_rules                                                 |\n+--------------------------------------+---------+----------------------------------------------------------------------+\n| bff315ad-0f08-45f8-8b14-5d19a9f95aa6 | default | egress, IPv4                                                         |\n|                                      |         | egress, IPv6                                                         |\n|                                      |         | ingress, IPv4, 1-65535/tcp                                           |\n|                                      |         | ingress, IPv4, icmp                                                  |\n|                                      |         | ingress, IPv4, remote_group_id: bff315ad-0f08-45f8-8b14-5d19a9f95aa6 |\n|                                      |         | ingress, IPv6, remote_group_id: bff315ad-0f08-45f8-8b14-5d19a9f95aa6 |\n+--------------------------------------+---------+----------------------------------------------------------------------+\n\n\n\u767b\u9332\u6e08\u307f\u30d5\u30ec\u30fc\u30d0\u30fc\u306e\u78ba\u8a8d\n\n[root@newton ~(keystone_demo)]# nova flavor-list\n+----+-----------+-----------+------+-----------+------+-------+-------------+-----------+\n| ID | Name      | Memory_MB | Disk | Ephemeral | Swap | VCPUs | RXTX_Factor | Is_Public |\n+----+-----------+-----------+------+-----------+------+-------+-------------+-----------+\n| 1  | m1.tiny   | 512       | 1    | 0         |      | 1     | 1.0         | True      |\n| 2  | m1.small  | 2048      | 20   | 0         |      | 1     | 1.0         | True      |\n| 3  | m1.medium | 4096      | 40   | 0         |      | 2     | 1.0         | True      |\n| 4  | m1.large  | 8192      | 80   | 0         |      | 4     | 1.0         | True      |\n| 5  | m1.xlarge | 16384     | 160  | 0         |      | 8     | 1.0         | True      |\n+----+-----------+-----------+------+-----------+------+-------+-------------+-----------+\n\n\n\u25a0 \u8a66\u3057\u306b\u3001nova\u4eee\u60f3\u30de\u30b7\u30f3\u3092\u4f5c\u6210\u3057\u3066\u307f\u308b\n\n(1) \u30c6\u30ca\u30f3\u30c8\u30cd\u30c3\u30c8\u30ef\u30fc\u30af/nova\u4eee\u60f3\u30de\u30b7\u30f3\u306e\u6574\u5099\n\nadmin\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u7528\u30dd\u30fc\u30c8\u4f5c\u6210\n\n[root@newton ~(keystone_demo)]# neutron port-create admin_net\nCreated a new port:\n+-----------------------+---------------------------------------------------------------------------------+\n| Field                 | Value                                                                           |\n+-----------------------+---------------------------------------------------------------------------------+\n| admin_state_up        | True                                                                            |\n| allowed_address_pairs |                                                                                 |\n| binding:vnic_type     | normal                                                                          |\n| created_at            | 2017-02-02T10:28:07Z                                                            |\n| description           |                                                                                 |\n| device_id             |                                                                                 |\n| device_owner          |                                                                                 |\n| extra_dhcp_opts       |                                                                                 |\n| fixed_ips             | {\"subnet_id\": \"31a40092-042b-4f27-a00c-54c9324db2ac\", \"ip_address\": \"10.0.0.4\"} |\n| id                    | 3155cbf3-ddcb-4acd-b5a1-dc37f4a49a4c                                            |\n| mac_address           | fa:16:3e:49:48:8e                                                               |\n| name                  |                                                                                 |\n| network_id            | 9ea97f2d-7ead-44b1-91e1-afc7ca22e21e                                            |\n| project_id            | 67d85efd952f4b6a8c03c6f86fecb8ea                                                |\n| revision_number       | 4                                                                               |\n| security_groups       | bff315ad-0f08-45f8-8b14-5d19a9f95aa6                                            |\n| status                | DOWN                                                                            |\n| tenant_id             | 67d85efd952f4b6a8c03c6f86fecb8ea                                                |\n| updated_at            | 2017-02-02T10:28:07Z                                                            |\n+-----------------------+---------------------------------------------------------------------------------+\n\n\nnova\u4eee\u60f3\u30de\u30b7\u30f3\u306e\u4f5c\u6210\uff08\u7ba1\u7406\u30dd\u30fc\u30c8\uff1aUUID: 3155cbf3-ddcb-4acd-b5a1-dc37f4a49a4c\uff09\n\n[root@newton ~(keystone_demo)]# nova boot --flavor 2 --image Ubuntu1604 --key-name mykey --security-groups default --nic port-id=3155cbf3-ddcb-4acd-b5a1-dc37f4a49a4c server1\n+--------------------------------------+---------------------------------------------------+\n| Property                             | Value                                             |\n+--------------------------------------+---------------------------------------------------+\n| OS-DCF:diskConfig                    | MANUAL                                            |\n| OS-EXT-AZ:availability_zone          |                                                   |\n| OS-EXT-STS:power_state               | 0                                                 |\n| OS-EXT-STS:task_state                | scheduling                                        |\n| OS-EXT-STS:vm_state                  | building                                          |\n| OS-SRV-USG:launched_at               | -                                                 |\n| OS-SRV-USG:terminated_at             | -                                                 |\n| accessIPv4                           |                                                   |\n| accessIPv6                           |                                                   |\n| adminPass                            | u4qBLa6NB7nr                                      |\n| config_drive                         |                                                   |\n| created                              | 2017-02-02T10:32:02Z                              |\n| description                          | -                                                 |\n| flavor                               | m1.small (2)                                      |\n| hostId                               |                                                   |\n| id                                   | ab70f784-385d-44a8-b010-1322e7be94a7              |\n| image                                | Ubuntu1604 (343a2c82-2959-4221-b567-bfc113020488) |\n| key_name                             | mykey                                             |\n| locked                               | False                                             |\n| metadata                             | {}                                                |\n| name                                 | server1                                           |\n| os-extended-volumes:volumes_attached | []                                                |\n| progress                             | 0                                                 |\n| security_groups                      | default                                           |\n| status                               | BUILD                                             |\n| tags                                 | []                                                |\n| tenant_id                            | 67d85efd952f4b6a8c03c6f86fecb8ea                  |\n| updated                              | 2017-02-02T10:32:03Z                              |\n| user_id                              | 538dcaaea36c4757bfd10fb862d50709                  |\n+--------------------------------------+---------------------------------------------------+\n\n\nnova\u4eee\u60f3\u30de\u30b7\u30f3\u306e\u63a5\u7d9a\u30a4\u30f3\u30bf\u30d5\u30a7\u30fc\u30b9\u78ba\u8a8d\n\n[root@newton ~(keystone_demo)]# nova interface-list server1\n+------------+--------------------------------------+--------------------------------------+--------------+-------------------+\n| Port State | Port ID                              | Net ID                               | IP addresses | MAC Addr          |\n+------------+--------------------------------------+--------------------------------------+--------------+-------------------+\n| ACTIVE     | 3155cbf3-ddcb-4acd-b5a1-dc37f4a49a4c | 9ea97f2d-7ead-44b1-91e1-afc7ca22e21e | 10.0.0.4     | fa:16:3e:49:48:8e |\n+------------+--------------------------------------+--------------------------------------+--------------+-------------------+\n\n\n(2) \u5916\u90e8\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u3068\u306e\u30a2\u30af\u30bb\u30b9\u74b0\u5883\u306e\u6574\u5099\n\nFloatingip\u306e\u4f5c\u6210\n\n[root@newton ~(keystone_demo)]# neutron floatingip-create public_net\nCreated a new floatingip:\n+---------------------+--------------------------------------+\n| Field               | Value                                |\n+---------------------+--------------------------------------+\n| created_at          | 2017-02-02T10:32:59Z                 |\n| description         |                                      |\n| fixed_ip_address    |                                      |\n| floating_ip_address | 10.79.5.191                          |\n| floating_network_id | c920de08-7acf-44c9-8b13-b97033312267 |\n| id                  | affd1370-760d-4148-9d48-5afb9f97eaf5 |\n| port_id             |                                      |\n| project_id          | 67d85efd952f4b6a8c03c6f86fecb8ea     |\n| revision_number     | 1                                    |\n| router_id           |                                      |\n| status              | DOWN                                 |\n| tenant_id           | 67d85efd952f4b6a8c03c6f86fecb8ea     |\n| updated_at          | 2017-02-02T10:32:59Z                 |\n+---------------------+--------------------------------------+\n\n\n\u767b\u9332\u6e08\u307fFloatingip\u306e\u78ba\u8a8d\n\n[root@newton ~(keystone_demo)]# neutron floatingip-list\n+--------------------------------------+------------------+---------------------+---------+\n| id                                   | fixed_ip_address | floating_ip_address | port_id |\n+--------------------------------------+------------------+---------------------+---------+\n| affd1370-760d-4148-9d48-5afb9f97eaf5 |                  | 10.79.5.191         |         |\n+--------------------------------------+------------------+---------------------+---------+\n\n\nFloatingip\u3068Port\u3068\u306e\u5bfe\u5fdc\u4ed8\u3051\n\n[root@newton ~(keystone_demo)]# neutron floatingip-associate affd1370-760d-4148-9d48-5afb9f97eaf5 3155cbf3-ddcb-4acd-b5a1-dc37f4a49a4c\n\n[root@newton ~(keystone_demo)]# neutron floatingip-list\n+--------------------------------------+------------------+---------------------+--------------------------------------+\n| id                                   | fixed_ip_address | floating_ip_address | port_id                              |\n+--------------------------------------+------------------+---------------------+--------------------------------------+\n| affd1370-760d-4148-9d48-5afb9f97eaf5 | 10.0.0.4         | 10.79.5.191         | 3155cbf3-ddcb-4acd-b5a1-dc37f4a49a4c |\n+--------------------------------------+------------------+---------------------+--------------------------------------+\n\n\n(3) \u5916\u90e8\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u304b\u3089\u306e\u30a2\u30af\u30bb\u30b9\u78ba\u8a8d\n\nnova\u4eee\u60f3\u30de\u30b7\u30f3\u5b9b\u3078\u306ePing\u30a2\u30af\u30bb\u30b9\n\n$ ping 10.79.5.191\nPING 10.79.5.191 (10.79.5.191): 56 data bytes\n64 bytes from 10.79.5.191: icmp_seq=0 ttl=60 time=6.981 ms\n64 bytes from 10.79.5.191: icmp_seq=1 ttl=60 time=3.223 ms\n64 bytes from 10.79.5.191: icmp_seq=2 ttl=60 time=3.115 ms\n64 bytes from 10.79.5.191: icmp_seq=3 ttl=60 time=10.910 ms\n64 bytes from 10.79.5.191: icmp_seq=4 ttl=60 time=6.581 ms\n^C\n--- 10.79.5.191 ping statistics ---\n5 packets transmitted, 5 packets received, 0.0% packet loss\nround-trip min/avg/max/stddev = 3.115/6.162/10.910/2.874 ms\n\n\nnova\u4eee\u60f3\u30de\u30b7\u30f3\u3078\u306essh\u30ed\u30b0\u30a4\u30f3\n\n$ ssh -i mykey.pem ubuntu@10.79.5.191\nThe authenticity of host '10.79.5.191 (10.79.5.191)' can't be established.\nECDSA key fingerprint is SHA256:PTCeFS89cTqGAPGxGkDHuadrWsfjeMo0sU5zmEhXrmY.\nAre you sure you want to continue connecting (yes/no)? yes\nWarning: Permanently added '10.79.5.191' (ECDSA) to the list of known hosts.\nWelcome to Ubuntu 16.04.1 LTS (GNU/Linux 4.4.0-59-generic x86_64)\n\n * Documentation:  https://help.ubuntu.com\n * Management:     https://landscape.canonical.com\n * Support:        https://ubuntu.com/advantage\n\n  Get cloud support with Ubuntu Advantage Cloud Guest:\n    http://www.ubuntu.com/business/services/cloud\n\n0 packages can be updated.\n0 updates are security updates.\n\n\nLast login: Thu Feb  2 10:34:53 2017 from 10.79.5.117\nTo run a command as administrator (user \"root\"), use \"sudo <command>\".\nSee \"man sudo_root\" for details.\n\nubuntu@server1:~$ ip addr\n1: lo: <LOOPBACK,UP,LOWER_UP> mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1\n    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00\n    inet 127.0.0.1/8 scope host lo\n       valid_lft forever preferred_lft forever\n    inet6 ::1/128 scope host \n       valid_lft forever preferred_lft forever\n2: ens3: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1450 qdisc pfifo_fast state UP group default qlen 1000\n    link/ether fa:16:3e:49:48:8e brd ff:ff:ff:ff:ff:ff\n    inet 10.0.0.4/24 brd 10.0.0.255 scope global ens3\n       valid_lft forever preferred_lft forever\n    inet6 fe80::f816:3eff:fe49:488e/64 scope link \n       valid_lft forever preferred_lft forever\n\n\n\u25a0 \u3055\u3089\u306b\u3001\uff12\u53f0\u76ee\u306enova\u4eee\u60f3\u30de\u30b7\u30f3\u3092\u4f5c\u6210\u3059\u308b\n\n(1) \u30c6\u30ca\u30f3\u30c8\u30cd\u30c3\u30c8\u30ef\u30fc\u30af/nova\u4eee\u60f3\u30de\u30b7\u30f3\u306e\u6574\u5099\n\nadmin\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u7528\u30dd\u30fc\u30c8\u4f5c\u6210\n\n[root@newton ~(keystone_demo)]# neutron port-create admin_net\nCreated a new port:\n+-----------------------+----------------------------------------------------------------------------------+\n| Field                 | Value                                                                            |\n+-----------------------+----------------------------------------------------------------------------------+\n| admin_state_up        | True                                                                             |\n| allowed_address_pairs |                                                                                  |\n| binding:vnic_type     | normal                                                                           |\n| created_at            | 2017-02-02T10:40:11Z                                                             |\n| description           |                                                                                  |\n| device_id             |                                                                                  |\n| device_owner          |                                                                                  |\n| extra_dhcp_opts       |                                                                                  |\n| fixed_ips             | {\"subnet_id\": \"31a40092-042b-4f27-a00c-54c9324db2ac\", \"ip_address\": \"10.0.0.11\"} |\n| id                    | 75f7e4ac-600b-4a45-9948-d45b3ec7169b                                             |\n| mac_address           | fa:16:3e:7c:92:60                                                                |\n| name                  |                                                                                  |\n| network_id            | 9ea97f2d-7ead-44b1-91e1-afc7ca22e21e                                             |\n| project_id            | 67d85efd952f4b6a8c03c6f86fecb8ea                                                 |\n| revision_number       | 4                                                                                |\n| security_groups       | bff315ad-0f08-45f8-8b14-5d19a9f95aa6                                             |\n| status                | DOWN                                                                             |\n| tenant_id             | 67d85efd952f4b6a8c03c6f86fecb8ea                                                 |\n| updated_at            | 2017-02-02T10:40:11Z                                                             |\n+-----------------------+----------------------------------------------------------------------------------+\n\n\nnova\u4eee\u60f3\u30de\u30b7\u30f3\u306e\u4f5c\u6210\uff08\u7ba1\u7406\u30dd\u30fc\u30c8\uff1aUUID: 75f7e4ac-600b-4a45-9948-d45b3ec7169b\uff09\n\n[root@newton ~(keystone_demo)]# nova boot --flavor 1 --image cirros --key-name mykey --security-groups default --nic port-id=75f7e4ac-600b-4a45-9948-d45b3ec7169b server2\n+--------------------------------------+-----------------------------------------------+\n| Property                             | Value                                         |\n+--------------------------------------+-----------------------------------------------+\n| OS-DCF:diskConfig                    | MANUAL                                        |\n| OS-EXT-AZ:availability_zone          |                                               |\n| OS-EXT-STS:power_state               | 0                                             |\n| OS-EXT-STS:task_state                | scheduling                                    |\n| OS-EXT-STS:vm_state                  | building                                      |\n| OS-SRV-USG:launched_at               | -                                             |\n| OS-SRV-USG:terminated_at             | -                                             |\n| accessIPv4                           |                                               |\n| accessIPv6                           |                                               |\n| adminPass                            | Qcu3AEVN3m4P                                  |\n| config_drive                         |                                               |\n| created                              | 2017-02-02T10:41:35Z                          |\n| description                          | -                                             |\n| flavor                               | m1.tiny (1)                                   |\n| hostId                               |                                               |\n| id                                   | 06521269-bddb-4def-8369-3f92fd2f4622          |\n| image                                | cirros (f91e45cb-114e-4322-8883-109f7392c912) |\n| key_name                             | mykey                                         |\n| locked                               | False                                         |\n| metadata                             | {}                                            |\n| name                                 | server2                                       |\n| os-extended-volumes:volumes_attached | []                                            |\n| progress                             | 0                                             |\n| security_groups                      | default                                       |\n| status                               | BUILD                                         |\n| tags                                 | []                                            |\n| tenant_id                            | 67d85efd952f4b6a8c03c6f86fecb8ea              |\n| updated                              | 2017-02-02T10:41:35Z                          |\n| user_id                              | 538dcaaea36c4757bfd10fb862d50709              |\n+--------------------------------------+-----------------------------------------------+\n\n\nnova\u4eee\u60f3\u30de\u30b7\u30f3\u306e\u63a5\u7d9a\u30a4\u30f3\u30bf\u30d5\u30a7\u30fc\u30b9\u78ba\u8a8d\n\n[root@newton ~(keystone_demo)]# nova interface-list server2\n+------------+--------------------------------------+--------------------------------------+--------------+-------------------+\n| Port State | Port ID                              | Net ID                               | IP addresses | MAC Addr          |\n+------------+--------------------------------------+--------------------------------------+--------------+-------------------+\n| ACTIVE     | 75f7e4ac-600b-4a45-9948-d45b3ec7169b | 9ea97f2d-7ead-44b1-91e1-afc7ca22e21e | 10.0.0.11    | fa:16:3e:7c:92:60 |\n+------------+--------------------------------------+--------------------------------------+--------------+-------------------+\n\n\n(2) \u5916\u90e8\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u3068\u306e\u30a2\u30af\u30bb\u30b9\u74b0\u5883\u306e\u6574\u5099\n\nFloatingip\u306e\u4f5c\u6210\n\n[root@newton ~(keystone_demo)]# neutron floatingip-create public_net\nCreated a new floatingip:\n+---------------------+--------------------------------------+\n| Field               | Value                                |\n+---------------------+--------------------------------------+\n| created_at          | 2017-02-02T10:44:47Z                 |\n| description         |                                      |\n| fixed_ip_address    |                                      |\n| floating_ip_address | 10.79.5.195                          |\n| floating_network_id | c920de08-7acf-44c9-8b13-b97033312267 |\n| id                  | cb83e8bc-47c2-438a-8c74-2f1654ddc09c |\n| port_id             |                                      |\n| project_id          | 67d85efd952f4b6a8c03c6f86fecb8ea     |\n| revision_number     | 1                                    |\n| router_id           |                                      |\n| status              | DOWN                                 |\n| tenant_id           | 67d85efd952f4b6a8c03c6f86fecb8ea     |\n| updated_at          | 2017-02-02T10:44:47Z                 |\n+---------------------+--------------------------------------+\n\n\nFloatingip\u3068Port\u3068\u306e\u5bfe\u5fdc\u4ed8\u3051\n\n[root@newton ~(keystone_demo)]# neutron floatingip-associate cb83e8bc-47c2-438a-8c74-2f1654ddc09c 75f7e4ac-600b-4a45-9948-d45b3ec7169b\n\n[root@newton ~(keystone_demo)]# neutron floatingip-list\n+--------------------------------------+------------------+---------------------+--------------------------------------+\n| id                                   | fixed_ip_address | floating_ip_address | port_id                              |\n+--------------------------------------+------------------+---------------------+--------------------------------------+\n| affd1370-760d-4148-9d48-5afb9f97eaf5 | 10.0.0.4         | 10.79.5.191         | 3155cbf3-ddcb-4acd-b5a1-dc37f4a49a4c |\n| cb83e8bc-47c2-438a-8c74-2f1654ddc09c | 10.0.0.11        | 10.79.5.195         | 75f7e4ac-600b-4a45-9948-d45b3ec7169b |\n+--------------------------------------+------------------+---------------------+--------------------------------------+\n\n\n(3) \u5916\u90e8\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u304b\u3089\u306e\u30a2\u30af\u30bb\u30b9\u78ba\u8a8d\n\nnova\u4eee\u60f3\u30de\u30b7\u30f3\u5b9b\u3078\u306ePing\u30a2\u30af\u30bb\u30b9\n\n$ ping 10.79.5.195\nPING 10.79.5.195 (10.79.5.195): 56 data bytes\n64 bytes from 10.79.5.195: icmp_seq=0 ttl=60 time=213.721 ms\n64 bytes from 10.79.5.195: icmp_seq=1 ttl=60 time=8.048 ms\n64 bytes from 10.79.5.195: icmp_seq=2 ttl=60 time=2.879 ms\n64 bytes from 10.79.5.195: icmp_seq=3 ttl=60 time=5.780 ms\n64 bytes from 10.79.5.195: icmp_seq=4 ttl=60 time=8.354 ms\n^C\n--- 10.79.5.195 ping statistics ---\n5 packets transmitted, 5 packets received, 0.0% packet loss\nround-trip min/avg/max/stddev = 2.879/47.756/213.721/83.005 ms\n\n\nnova\u4eee\u60f3\u30de\u30b7\u30f3\u3078\u306essh\u30ed\u30b0\u30a4\u30f3\n\n$ ssh -i mykey.pem cirros@10.79.5.195\nThe authenticity of host '10.79.5.195 (10.79.5.195)' can't be established.\nRSA key fingerprint is SHA256:VHpD4TfqBg2vMYnU6I2NRj4NXlN4SKhpQjTm50rW9Tc.\nAre you sure you want to continue connecting (yes/no)? yes\nWarning: Permanently added '10.79.5.195' (RSA) to the list of known hosts.\n$ ip addr\n1: lo: <LOOPBACK,UP,LOWER_UP> mtu 16436 qdisc noqueue \n    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00\n    inet 127.0.0.1/8 scope host lo\n    inet6 ::1/128 scope host \n       valid_lft forever preferred_lft forever\n2: eth0: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1450 qdisc pfifo_fast qlen 1000\n    link/ether fa:16:3e:7c:92:60 brd ff:ff:ff:ff:ff:ff\n    inet 10.0.0.11/24 brd 10.0.0.255 scope global eth0\n    inet6 fe80::f816:3eff:fe7c:9260/64 scope link \n       valid_lft forever preferred_lft forever\n$ ip addr\n1: lo: <LOOPBACK,UP,LOWER_UP> mtu 16436 qdisc noqueue \n    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00\n    inet 127.0.0.1/8 scope host lo\n    inet6 ::1/128 scope host \n       valid_lft forever preferred_lft forever\n2: eth0: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1450 qdisc pfifo_fast qlen 1000\n    link/ether fa:16:3e:7c:92:60 brd ff:ff:ff:ff:ff:ff\n    inet 10.0.0.11/24 brd 10.0.0.255 scope global eth0\n    inet6 fe80::f816:3eff:fe7c:9260/64 scope link \n       valid_lft forever preferred_lft forever\n\n\n\u25a0 \u6700\u7d42\u7684\u306b\u4f5c\u6210\u3057\u305fneutron\u4eee\u60f3\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u69cb\u6210\n\nnova\u4eee\u60f3\u30de\u30b7\u30f3\u4e00\u89a7\u306e\u78ba\u8a8d\n\n[root@newton ~(keystone_demo)]# nova list\n+--------------------------------------+---------+--------+------------+-------------+----------------------------------+\n| ID                                   | Name    | Status | Task State | Power State | Networks                         |\n+--------------------------------------+---------+--------+------------+-------------+----------------------------------+\n| ab70f784-385d-44a8-b010-1322e7be94a7 | server1 | ACTIVE | -          | Running     | admin_net=10.0.0.4, 10.79.5.191  |\n| 06521269-bddb-4def-8369-3f92fd2f4622 | server2 | ACTIVE | -          | Running     | admin_net=10.0.0.11, 10.79.5.195 |\n+--------------------------------------+---------+--------+------------+-------------+----------------------------------+\n\n\nneutron\u30d5\u30ed\u30fc\u30c6\u30a3\u30f3\u30b0IP\u4e00\u89a7\u306e\u78ba\u8a8d\n\n[root@newton ~(keystone_demo)]# neutron floatingip-list\n+--------------------------------------+------------------+---------------------+--------------------------------------+\n| id                                   | fixed_ip_address | floating_ip_address | port_id                              |\n+--------------------------------------+------------------+---------------------+--------------------------------------+\n| affd1370-760d-4148-9d48-5afb9f97eaf5 | 10.0.0.4         | 10.79.5.191         | 3155cbf3-ddcb-4acd-b5a1-dc37f4a49a4c |\n| cb83e8bc-47c2-438a-8c74-2f1654ddc09c | 10.0.0.11        | 10.79.5.195         | 75f7e4ac-600b-4a45-9948-d45b3ec7169b |\n+--------------------------------------+------------------+---------------------+--------------------------------------+\n\n\nNewton\u7248OpenStack\u304c\u69cb\u7bc9\u3067\u304d\u305f\u306e\u3067\u3001\u601d\u3046\u5b58\u5206\u306b\u3001OpenStack\u6280\u8853\u3092\u7fd2\u719f\u3057\u305f\u3044\u3068\u601d\u3044\u307e\u3059\u3002\nRDO\u3092\u4f7f\u7528\u3057\u305fNewton\u7248OpenStack\u69cb\u7bc9\u30e1\u30e2\u3067\u3059\u3002\n\n## \u25a0 OpenStack\u74b0\u5883\u6574\u5099\u306e\u76ee\u6a19\u611f\nKVM\u74b0\u5883\u3092\u6574\u5099\u3057\u3066\u3001OpenStack\u7528\u306e\u4eee\u60f3\u30de\u30b7\u30f3\u3092\u30c7\u30d7\u30ed\u30a4\u3057\u307e\u3059\u3002\n\u5fc5\u8981\u6700\u5c0f\u9650\u306aAll-In-One\u69cb\u6210\u3092\u76ee\u6307\u3057\u307e\u3059\u3002\n\n- \u4eee\u60f3\u30de\u30b7\u30f3\u540d\uff1anewton\n- CPU\u6570\uff1a4CPU\n- \u30e1\u30e2\u30ea\uff1a8,192MB\n- \u30cf\u30fc\u30c9\u30c7\u30a3\u30b9\u30af\uff1a80GB\n- CentOS\u30d0\u30fc\u30b8\u30e7\u30f3\uff1aCentOS Linux release 7.3.1611 (Core) \n\n## \u25a0 OpenStack\u69cb\u7bc9\u30e1\u30e2\n### (1) CentOS\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\u307e\u305a\u306f\u3001OpenStack\u69cb\u7bc9\u3059\u308b\u305f\u3081\u306eLinux\u6bcd\u8266\u3068\u3057\u3066\u3001CentOS\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\n\n- \"CentOS-7-x86_64-Minimal-1611.iso\"\u306e\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\uff08/home/tsubo/iso\u914d\u4e0b\u306b\u7f6e\u304f\u3082\u306e\u3068\u3059\u308b\uff09\n- CentOS\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n```\n$ sudo virt-install \\\n> --name newton \\\n> --ram 8192 \\\n> --disk path=/var/lib/libvirt/images/newton.qcow2,size=80,bus=virtio,format=qcow2 \\\n> --vcpus 4 \\\n> --os-variant rhel7 \\\n> --network bridge=br-ext \\\n> --graphics none \\\n> --console pty,target_type=serial \\\n> --location /home/tsubo/iso/CentOS-7-x86_64-Minimal-1611.iso \\\n> --extra-args 'console=ttyS0,115200n8 serial'\n```\n- \u30c6\u30ad\u30b9\u30c8\u30e2\u30fc\u30c9\u3067\u306e\u5404\u7a2e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u306e\u30d1\u30e9\u30e1\u30fc\u30bf\u8a2d\u5b9a\n\n```\nStarting installer, one moment...\nanaconda 21.48.22.93-1 for CentOS Linux 7 started.\n * installation log files are stored in /tmp during the installation\n * shell is available on TTY2\n * when reporting a bug add logs from /tmp as separate text/plain attachments\n00:47:09 Not asking for VNC because we don't have a network\n================================================================================\n================================================================================\nInstallation\n\n 1) [x] Language settings                 2) [!] Time settings\n        (English (United States))                (Timezone is not set.)\n 3) [!] Installation source               4) [!] Software selection\n        (Processing...)                          (Processing...)\n 5) [!] Installation Destination          6) [x] Kdump\n        (No disks selected)                      (Kdump is enabled)\n 7) [ ] Network configuration             8) [!] Root password\n        (Not connected)                          (Password is not set.)\n 9) [!] User creation\n        (No user will be created)\n  Please make your choice from above ['q' to quit | 'b' to begin installation |\n  'r' to refresh]: \n\n[anaconda] 1:main* 2:shell  3:log  4:storage-lo> Switch tab: Alt+Tab | Help: F1 \n```\n\n\u301c \u4ee5\u4e0b\u3001\u7701\u7565\u3000\u301c\n\n\n- Intel VT-x\u306e\u6709\u52b9\u5316\u306e\u305f\u3081\u3001xml\u30d5\u30a1\u30a4\u30eb\u7de8\u96c6\n\n```\n$ sudo virsh define /etc/libvirt/qemu/newton.xml \n$ virsh dumpxml newton\n  ...\n\n  <cpu mode='custom' match='exact'>\n    <model fallback='allow'>IvyBridge</model>\n    <feature policy='require' name='vmx'/>\n  </cpu>\n\n  ...\n```\n\n- \"newton\"\u4eee\u60f3\u30de\u30b7\u30f3\u306e\u8d77\u52d5\n\n```\n$ virsh start newton\n```\n\n- \"newton\"\u4eee\u60f3\u30de\u30b7\u30f3\u4e0a\u3067\u3001vt-x\u304c\u6709\u52b9\u5316\u306e\u78ba\u8a8d\n\n```\n[root@newton ~]# cat /proc/cpuinfo | grep vmx\nflags\t\t: fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush mmx fxsr sse sse2 syscall nx rdtscp lm constant_tsc rep_good nopl eagerfpu pni pclmulqdq vmx ssse3 cx16 sse4_1 sse4_2 x2apic popcnt tsc_deadline_timer aes xsave avx f16c rdrand hypervisor lahf_lm arat tpr_shadow vnmi flexpriority ept vpid fsgsbase smep erms xsaveopt\nflags\t\t: fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush mmx fxsr sse sse2 syscall nx rdtscp lm constant_tsc rep_good nopl eagerfpu pni pclmulqdq vmx ssse3 cx16 sse4_1 sse4_2 x2apic popcnt tsc_deadline_timer aes xsave avx f16c rdrand hypervisor lahf_lm arat tpr_shadow vnmi flexpriority ept vpid fsgsbase smep erms xsaveopt\nflags\t\t: fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush mmx fxsr sse sse2 syscall nx rdtscp lm constant_tsc rep_good nopl eagerfpu pni pclmulqdq vmx ssse3 cx16 sse4_1 sse4_2 x2apic popcnt tsc_deadline_timer aes xsave avx f16c rdrand hypervisor lahf_lm arat tpr_shadow vnmi flexpriority ept vpid fsgsbase smep erms xsaveopt\nflags\t\t: fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush mmx fxsr sse sse2 syscall nx rdtscp lm constant_tsc rep_good nopl eagerfpu pni pclmulqdq vmx ssse3 cx16 sse4_1 sse4_2 x2apic popcnt tsc_deadline_timer aes xsave avx f16c rdrand hypervisor lahf_lm arat tpr_shadow vnmi flexpriority ept vpid fsgsbase smep erms xsaveopt\n```\n- ntp\u306e\u8a2d\u5b9a\n\n```\n[root@newton ~]# yum install -y ntp\n[root@newton ~]# echo \"server ntp.nict.jp prefer iburst\" >> /etc/ntp.conf\n[root@newton ~]# systemctl start ntpd\n[root@newton ~]# systemctl enable ntpd\n```\n- Firewall\u306e\u7121\u52b9\u5316\n\n```\n[root@newton ~]# yum install -y iptables-services\n[root@newton ~]# systemctl stop firewalld.service\n[root@newton ~]# systemctl disable firewalld.service\n[root@newton ~]# systemctl start iptables.service\n[root@newton ~]# systemctl enable iptables.service\n```\n- SELinux\u306e\u7121\u52b9\u5316\n\n```\n[root@newton ~]# sed -i \"s/SELINUX=.*/SELINUX=permissive/\" /etc/selinux/config\n[root@newton ~]# setenforce 0\n```\n- \u82f1\u8a9e\u30ed\u30b1\u30fc\u30eb\u8a2d\u5b9a\n\n```\n[root@newton ~]# echo \"LANG=en_US.utf-8\" > /etc/environment\n[root@newton ~]# echo \"LC_ALL=en_US.utf-8\" >> /etc/environment\n```\n- \u30ab\u30fc\u30cd\u30eb\u30d1\u30e9\u30e1\u30fc\u30bf\u306e\u8a2d\u5b9a\n\n```\n# cat <<'EOF' > /etc/sysconfig/modules/openstack-neutron.modules\n> #!/bin/sh\n> modprobe -b bridge >/dev/null 2>&1\n> exit 0\n> EOF\n```\n```\n# chmod u+x /etc/sysconfig/modules/openstack-neutron.modules\n```\n\n```\n# cat <<'EOF' > /etc/sysctl.d/bridge-nf-call\n> net.bridge.bridge-nf-call-ip6tables = 1\n> net.bridge.bridge-nf-call-iptables = 1\n> net.bridge.bridge-nf-call-arptables = 1\n> EOF\n```\n\n### (2) RDO\u74b0\u5883\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\n\n- RDO\u306e\u30d1\u30c3\u30b1\u30fc\u30b8\u3068PackStack\u306e\u53d6\u5f97\n\n```\n[root@newton ~]# yum install -y centos-release-openstack-newton\n[root@newton ~]# yum update -y\n[root@newton ~]# yum install -y openstack-packstack\n[root@newton ~]# reboot\n```\n- Answer File\u306e\u4f5c\u6210\n\n```\n[root@newton ~]# cd /root\n[root@newton ~]# packstack --gen-answer-file=/root/answer.txt \\\n> --default-password=secrete \\\n> --os-heat-install=y \\\n> --os-heat-cloudwatch-install=y \\\n> --os-heat-cfn-install=y \\\n> \n```\n- PackStack\u306e\u5b9f\u884c\n\n```\n[root@newton ~]# packstack --answer-file=/root/answer.txt\nWelcome to the Packstack setup utility\n\nThe installation log file is available at: /var/tmp/packstack/20170202-113439-SALMrK/openstack-setup.log\n\nInstalling:\nClean Up                                             [ DONE ]\nDiscovering ip protocol version                      [ DONE ]\nSetting up ssh keys                                  [ DONE ]\n\n... (snip)\n\n10.79.5.190_compute.pp:                              [ DONE ]     \nApplying Puppet manifests                            [ DONE ]\nFinalizing                                           [ DONE ]\n\n **** Installation completed successfully ******\n\nAdditional information:\n * Time synchronization installation was skipped. Please note that unsynchronized time on server instances might be problem for some OpenStack components.\n * Warning: NetworkManager is active on 10.79.5.190. OpenStack networking currently does not work on systems that have the Network Manager service enabled.\n * File /root/keystonerc_admin has been created on OpenStack client host 10.79.5.190. To use the command line tools you need to source the file.\n * To access the OpenStack Dashboard browse to http://10.79.5.190/dashboard .\nPlease, find your login credentials stored in the keystonerc_admin in your home directory.\n * To use Nagios, browse to http://10.79.5.190/nagios username: nagiosadmin, password: secrete\n * Because of the kernel update the host 10.79.5.190 requires reboot.\n * The installation log file is available at: /var/tmp/packstack/20170202-134107-oxzCAT/openstack-setup.log\n * The generated manifests are available at: /var/tmp/packstack/20170202-134107-oxzCAT/manifests\n```\n- NetworkManager\u306e\u7121\u52b9\u5316\n\n```\n[root@newton ~]# systemctl stop NetworkManager\n[root@newton ~]# systemctl disable NetworkManager\n```\n- OpenStack\u69cb\u7bc9\u7d50\u679c\u306e\u78ba\u8a8d\n\n```\n[root@newton ~]# yum install -y openstack-utils\n[root@newton ~]# cd /root\n[root@newton ~]# source keystonerc_admin\n[root@newton ~(keystone_admin)]# openstack-status\n== Nova services ==\nopenstack-nova-api:                     active\nopenstack-nova-compute:                 active\nopenstack-nova-network:                 inactive  (disabled on boot)\nopenstack-nova-scheduler:               active\nopenstack-nova-cert:                    active\nopenstack-nova-conductor:               active\nopenstack-nova-console:                 inactive  (disabled on boot)\nopenstack-nova-consoleauth:             active\nopenstack-nova-xvpvncproxy:             inactive  (disabled on boot)\n== Glance services ==\nopenstack-glance-api:                   active\nopenstack-glance-registry:              active\n== Keystone service ==\nopenstack-keystone:                     inactive  (disabled on boot)\n== Horizon service ==\nopenstack-dashboard:                    active\n== neutron services ==\nneutron-server:                         active\nneutron-dhcp-agent:                     active\nneutron-l3-agent:                       active\nneutron-metadata-agent:                 active\nneutron-openvswitch-agent:              active\nneutron-metering-agent:                 active\n== Cinder services ==\nopenstack-cinder-api:                   active\nopenstack-cinder-scheduler:             active\nopenstack-cinder-volume:                active\nopenstack-cinder-backup:                active\n== Ceilometer services ==\nopenstack-ceilometer-api:               inactive  (disabled on boot)\nopenstack-ceilometer-central:           active\nopenstack-ceilometer-compute:           active\nopenstack-ceilometer-collector:         active\nopenstack-ceilometer-notification:      active\n== Heat services ==\nopenstack-heat-api:                     active\nopenstack-heat-api-cfn:                 active\nopenstack-heat-api-cloudwatch:          active\nopenstack-heat-engine:                  active\n== Support services ==\nmariadb:                                active\nopenvswitch:                            active\ndbus:                                   active\ntarget:                                 active\nrabbitmq-server:                        active\nmemcached:                              active\n== Keystone users ==\n/usr/bin/openstack-status: line 267: keystone: command not found\n== Glance images ==\n+--------------------------------------+--------+\n| ID                                   | Name   |\n+--------------------------------------+--------+\n| f91e45cb-114e-4322-8883-109f7392c912 | cirros |\n+--------------------------------------+--------+\n== Nova managed services ==\n+----+------------------+--------+----------+---------+-------+----------------------------+-----------------+\n| Id | Binary           | Host   | Zone     | Status  | State | Updated_at                 | Disabled Reason |\n+----+------------------+--------+----------+---------+-------+----------------------------+-----------------+\n| 1  | nova-cert        | newton | internal | enabled | up    | 2017-02-02T05:03:55.000000 | -               |\n| 2  | nova-consoleauth | newton | internal | enabled | up    | 2017-02-02T05:03:55.000000 | -               |\n| 7  | nova-scheduler   | newton | internal | enabled | up    | 2017-02-02T05:03:54.000000 | -               |\n| 8  | nova-conductor   | newton | internal | enabled | up    | 2017-02-02T05:03:55.000000 | -               |\n| 9  | nova-compute     | newton | nova     | enabled | up    | 2017-02-02T05:03:49.000000 | -               |\n+----+------------------+--------+----------+---------+-------+----------------------------+-----------------+\n== Nova networks ==\nWARNING: Command network-list is deprecated and will be removed after Nova 15.0.0 is released. Use python-neutronclient or python-openstackclient instead.\n+--------------------------------------+---------+------+\n| ID                                   | Label   | Cidr |\n+--------------------------------------+---------+------+\n| a0a076fe-fd31-4f37-a8ba-1f3d77ebb1da | public  | -    |\n| bfb970fd-e8a6-4286-8f4e-59be750f76ed | private | -    |\n+--------------------------------------+---------+------+\n== Nova instance flavors ==\n+----+-----------+-----------+------+-----------+------+-------+-------------+-----------+\n| ID | Name      | Memory_MB | Disk | Ephemeral | Swap | VCPUs | RXTX_Factor | Is_Public |\n+----+-----------+-----------+------+-----------+------+-------+-------------+-----------+\n| 1  | m1.tiny   | 512       | 1    | 0         |      | 1     | 1.0         | True      |\n| 2  | m1.small  | 2048      | 20   | 0         |      | 1     | 1.0         | True      |\n| 3  | m1.medium | 4096      | 40   | 0         |      | 2     | 1.0         | True      |\n| 4  | m1.large  | 8192      | 80   | 0         |      | 4     | 1.0         | True      |\n| 5  | m1.xlarge | 16384     | 160  | 0         |      | 8     | 1.0         | True      |\n+----+-----------+-----------+------+-----------+------+-------+-------------+-----------+\n== Nova instances ==\n+----+------+-----------+--------+------------+-------------+----------+\n| ID | Name | Tenant ID | Status | Task State | Power State | Networks |\n+----+------+-----------+--------+------------+-------------+----------+\n+----+------+-----------+--------+------------+-------------+----------+\n```\n- \u73fe\u72b6\u306e\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u60c5\u5831\u306e\u78ba\u8a8d\n\n```\n[root@newton ~]# ip addr\n1: lo: <LOOPBACK,UP,LOWER_UP> mtu 65536 qdisc noqueue state UNKNOWN qlen 1\n    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00\n    inet 127.0.0.1/8 scope host lo\n       valid_lft forever preferred_lft forever\n    inet6 ::1/128 scope host \n       valid_lft forever preferred_lft forever\n2: eth0: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc pfifo_fast state UP qlen 1000\n    link/ether 52:54:00:da:d9:d6 brd ff:ff:ff:ff:ff:ff\n    inet 10.79.5.190/24 brd 10.79.5.255 scope global eth0\n       valid_lft forever preferred_lft forever\n    inet6 fe80::5054:ff:feda:d9d6/64 scope link \n       valid_lft forever preferred_lft forever\n3: ovs-system: <BROADCAST,MULTICAST> mtu 1500 qdisc noop state DOWN qlen 1000\n    link/ether ae:d6:ce:67:cc:ba brd ff:ff:ff:ff:ff:ff\n5: br-int: <BROADCAST,MULTICAST> mtu 1500 qdisc noop state DOWN qlen 1000\n    link/ether 7a:4a:e3:ba:2e:44 brd ff:ff:ff:ff:ff:ff\n7: br-tun: <BROADCAST,MULTICAST> mtu 1500 qdisc noop state DOWN qlen 1000\n    link/ether e6:16:11:c4:52:47 brd ff:ff:ff:ff:ff:ff\n9: br-ex: <BROADCAST,MULTICAST> mtu 1500 qdisc noop state DOWN qlen 1000\n    link/ether c2:46:27:8a:20:4d brd ff:ff:ff:ff:ff:ff\n```\n- \u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u30d6\u30ea\u30c3\u30b8\u306e\u8a2d\u5b9a\n\n```\n[root@newton ~]# ovs-vsctl list-br\nbr-ex\nbr-int\nbr-tun\n```\n```\n[root@newton ~]# vi /etc/sysconfig/network-scripts/ifcfg-br-ex\n```\n```text:/etc/sysconfig/network-scripts/ifcfg-br-ex\nDEVICE=br-ex\nDEVICETYPE=ovs\nTYPE=OVSBridge\nBOOTPROTO=static\nIPADDR=10.79.5.190\nNETMASK=255.255.255.0\nGATEWAY=10.79.5.1\nDEFROUTE=yes\nONBOOT=yes\n```\n```\n[root@newton ~]# vi /etc/sysconfig/network-scripts/ifcfg-eth0\n```\n```text:/etc/sysconfig/network-scripts/ifcfg-eth0\nDEVICE=eth0\nTYPE=OVSPort\nDEVICETYPE=ovs\nNM_CONTROLLED=no\nONBOOT=yes\nOVS_BRIDGE=br-ex\n```\n- \u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u518d\u8d77\u52d5\n\n```\n[root@newton ~]# service network restart\n```\n- \u518d\u5ea6\u3001\u73fe\u72b6\u306e\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u60c5\u5831\u306e\u78ba\u8a8d\n\n```\n[root@newton ~]# ip addr\n1: lo: <LOOPBACK,UP,LOWER_UP> mtu 65536 qdisc noqueue state UNKNOWN qlen 1\n    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00\n    inet 127.0.0.1/8 scope host lo\n       valid_lft forever preferred_lft forever\n    inet6 ::1/128 scope host \n       valid_lft forever preferred_lft forever\n2: eth0: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc pfifo_fast master ovs-system state UP qlen 1000\n    link/ether 52:54:00:da:d9:d6 brd ff:ff:ff:ff:ff:ff\n    inet6 fe80::5054:ff:feda:d9d6/64 scope link \n       valid_lft forever preferred_lft forever\n3: ovs-system: <BROADCAST,MULTICAST> mtu 1500 qdisc noop state DOWN qlen 1000\n    link/ether ae:d6:ce:67:cc:ba brd ff:ff:ff:ff:ff:ff\n5: br-int: <BROADCAST,MULTICAST> mtu 1500 qdisc noop state DOWN qlen 1000\n    link/ether 7a:4a:e3:ba:2e:44 brd ff:ff:ff:ff:ff:ff\n7: br-tun: <BROADCAST,MULTICAST> mtu 1500 qdisc noop state DOWN qlen 1000\n    link/ether e6:16:11:c4:52:47 brd ff:ff:ff:ff:ff:ff\n9: br-ex: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UNKNOWN qlen 1000\n    link/ether c2:46:27:8a:20:4d brd ff:ff:ff:ff:ff:ff\n    inet 10.79.5.190/24 brd 10.79.5.255 scope global br-ex\n       valid_lft forever preferred_lft forever\n    inet6 fe80::c046:27ff:fe8a:204d/64 scope link \n       valid_lft forever preferred_lft forever\n```\n\n## \u25a0 OpenStack\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u5f8c\u306e\u5404\u7a2e\u8a2d\u5b9a\n### (1) neutron\u4eee\u60f3\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u518d\u69cb\u7bc9\n\n- \u30c7\u30d5\u30a9\u30eb\u30c9\u306e\u4eee\u60f3\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306e\u524a\u9664\n\n```\n[root@newton ~]# cd /root\n[root@newton ~]# source /root/keystonerc_admin\n[root@newton ~(keystone_admin)]# neutron router-gateway-clear router1\n[root@newton ~(keystone_admin)]# neutron router-interface-delete router1 private_subnet\n[root@newton ~(keystone_admin)]# openstack router delete router1\n[root@newton ~(keystone_admin)]# openstack network delete private\n[root@newton ~(keystone_admin)]# openstack network delete public\n```\n- \u201cPublic_net\u201d\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306e\u4f5c\u6210\n\n```\n[root@newton ~]# cd /root\n[root@newton ~]# source /root/keystonerc_admin\n[root@newton ~(keystone_admin)]# openstack network create public_net --external\n+---------------------------+--------------------------------------+\n| Field                     | Value                                |\n+---------------------------+--------------------------------------+\n| admin_state_up            | UP                                   |\n| availability_zone_hints   |                                      |\n| availability_zones        |                                      |\n| created_at                | 2017-02-02T09:02:02Z                 |\n| description               |                                      |\n| headers                   |                                      |\n| id                        | c920de08-7acf-44c9-8b13-b97033312267 |\n| ipv4_address_scope        | None                                 |\n| ipv6_address_scope        | None                                 |\n| is_default                | False                                |\n| mtu                       | 1450                                 |\n| name                      | public_net                           |\n| project_id                | f88a985676884b468bb75550d4e86999     |\n| project_id                | f88a985676884b468bb75550d4e86999     |\n| provider:network_type     | vxlan                                |\n| provider:physical_network | None                                 |\n| provider:segmentation_id  | 62                                   |\n| revision_number           | 2                                    |\n| router:external           | External                             |\n| shared                    | False                                |\n| status                    | ACTIVE                               |\n| subnets                   |                                      |\n| tags                      | []                                   |\n| updated_at                | 2017-02-02T09:02:02Z                 |\n+---------------------------+--------------------------------------+\n```\n- \u201cPublic_subnet\u201d\u30b5\u30d6\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306e\u4f5c\u6210\n\n```\n[root@newton ~(keystone_admin)]# openstack subnet create public_subnet \\\n> --subnet-range 10.79.5.0/24 \\\n> --allocation-pool start=10.79.5.191,end=10.79.5.195 \\\n> --gateway 10.79.5.1 \\\n> --no-dhcp \\\n> --network public_net\n+-------------------+--------------------------------------+\n| Field             | Value                                |\n+-------------------+--------------------------------------+\n| allocation_pools  | 10.79.5.191-10.79.5.195              |\n| cidr              | 10.79.5.0/24                         |\n| created_at        | 2017-02-02T09:04:39Z                 |\n| description       |                                      |\n| dns_nameservers   |                                      |\n| enable_dhcp       | False                                |\n| gateway_ip        | 10.79.5.1                            |\n| headers           |                                      |\n| host_routes       |                                      |\n| id                | 2bb1c25e-aafb-407d-bf4d-a54e97c4cf0b |\n| ip_version        | 4                                    |\n| ipv6_address_mode | None                                 |\n| ipv6_ra_mode      | None                                 |\n| name              | public_subnet                        |\n| network_id        | c920de08-7acf-44c9-8b13-b97033312267 |\n| project_id        | f88a985676884b468bb75550d4e86999     |\n| project_id        | f88a985676884b468bb75550d4e86999     |\n| revision_number   | 2                                    |\n| service_types     | []                                   |\n| subnetpool_id     | None                                 |\n| updated_at        | 2017-02-02T09:04:39Z                 |\n+-------------------+--------------------------------------+\n```\n- \u201cadmin_net\u201d\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306e\u4f5c\u6210\n\n```\n[root@newton ~]# cd /root\n[root@newton ~]# source /root/keystonerc_demo\n[root@newton ~(keystone_demo)]# openstack network create admin_net\n+-------------------------+--------------------------------------+\n| Field                   | Value                                |\n+-------------------------+--------------------------------------+\n| admin_state_up          | UP                                   |\n| availability_zone_hints |                                      |\n| availability_zones      |                                      |\n| created_at              | 2017-02-02T09:06:10Z                 |\n| description             |                                      |\n| headers                 |                                      |\n| id                      | 9ea97f2d-7ead-44b1-91e1-afc7ca22e21e |\n| ipv4_address_scope      | None                                 |\n| ipv6_address_scope      | None                                 |\n| mtu                     | 1450                                 |\n| name                    | admin_net                            |\n| project_id              | 67d85efd952f4b6a8c03c6f86fecb8ea     |\n| project_id              | 67d85efd952f4b6a8c03c6f86fecb8ea     |\n| revision_number         | 2                                    |\n| router:external         | Internal                             |\n| shared                  | False                                |\n| status                  | ACTIVE                               |\n| subnets                 |                                      |\n| tags                    | []                                   |\n| updated_at              | 2017-02-02T09:06:10Z                 |\n+-------------------------+--------------------------------------+\n```\n- \u201cadmin_subnet\u201d\u30b5\u30d6\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306e\u4f5c\u6210\n\n```\n[root@newton ~(keystone_demo)]# openstack subnet create admin_subnet \\\n> --subnet-range 10.0.0.0/24 \\\n> --allocation-pool start=10.0.0.2,end=10.0.0.100 \\\n> --gateway 10.0.0.1 \\\n> --network admin_net\n+-------------------+--------------------------------------+\n| Field             | Value                                |\n+-------------------+--------------------------------------+\n| allocation_pools  | 10.0.0.2-10.0.0.100                  |\n| cidr              | 10.0.0.0/24                          |\n| created_at        | 2017-02-02T09:07:33Z                 |\n| description       |                                      |\n| dns_nameservers   |                                      |\n| enable_dhcp       | True                                 |\n| gateway_ip        | 10.0.0.1                             |\n| headers           |                                      |\n| host_routes       |                                      |\n| id                | 31a40092-042b-4f27-a00c-54c9324db2ac |\n| ip_version        | 4                                    |\n| ipv6_address_mode | None                                 |\n| ipv6_ra_mode      | None                                 |\n| name              | admin_subnet                         |\n| network_id        | 9ea97f2d-7ead-44b1-91e1-afc7ca22e21e |\n| project_id        | 67d85efd952f4b6a8c03c6f86fecb8ea     |\n| project_id        | 67d85efd952f4b6a8c03c6f86fecb8ea     |\n| revision_number   | 2                                    |\n| service_types     | []                                   |\n| subnetpool_id     | None                                 |\n| updated_at        | 2017-02-02T09:07:33Z                 |\n+-------------------+--------------------------------------+\n```\n- \u201cuser_net\u201d\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306e\u4f5c\u6210\n\n```\n[root@newton ~(keystone_demo)]# openstack network create user_net\n+-------------------------+--------------------------------------+\n| Field                   | Value                                |\n+-------------------------+--------------------------------------+\n| admin_state_up          | UP                                   |\n| availability_zone_hints |                                      |\n| availability_zones      |                                      |\n| created_at              | 2017-02-02T09:09:05Z                 |\n| description             |                                      |\n| headers                 |                                      |\n| id                      | 80feacbb-6bd5-4a3a-adff-a715b78c5d3e |\n| ipv4_address_scope      | None                                 |\n| ipv6_address_scope      | None                                 |\n| mtu                     | 1450                                 |\n| name                    | user_net                             |\n| project_id              | 67d85efd952f4b6a8c03c6f86fecb8ea     |\n| project_id              | 67d85efd952f4b6a8c03c6f86fecb8ea     |\n| revision_number         | 2                                    |\n| router:external         | Internal                             |\n| shared                  | False                                |\n| status                  | ACTIVE                               |\n| subnets                 |                                      |\n| tags                    | []                                   |\n| updated_at              | 2017-02-02T09:09:05Z                 |\n+-------------------------+--------------------------------------+\n```\n- \u201cuser_subnet\u201d\u30b5\u30d6\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306e\u4f5c\u6210\n\n```\n[root@newton ~(keystone_demo)]# openstack subnet create user_subnet \\\n> --subnet-range 172.16.0.0/24 \\\n> --allocation-pool start=172.16.0.2,end=172.16.0.100 \\\n> --gateway 172.16.0.1 \\\n> --network user_net\n+-------------------+--------------------------------------+\n| Field             | Value                                |\n+-------------------+--------------------------------------+\n| allocation_pools  | 172.16.0.2-172.16.0.100              |\n| cidr              | 172.16.0.0/24                        |\n| created_at        | 2017-02-02T09:09:56Z                 |\n| description       |                                      |\n| dns_nameservers   |                                      |\n| enable_dhcp       | True                                 |\n| gateway_ip        | 172.16.0.1                           |\n| headers           |                                      |\n| host_routes       |                                      |\n| id                | 9f0e59df-d6c8-4c2d-9de5-8979798e5350 |\n| ip_version        | 4                                    |\n| ipv6_address_mode | None                                 |\n| ipv6_ra_mode      | None                                 |\n| name              | user_subnet                          |\n| network_id        | 80feacbb-6bd5-4a3a-adff-a715b78c5d3e |\n| project_id        | 67d85efd952f4b6a8c03c6f86fecb8ea     |\n| project_id        | 67d85efd952f4b6a8c03c6f86fecb8ea     |\n| revision_number   | 2                                    |\n| service_types     | []                                   |\n| subnetpool_id     | None                                 |\n| updated_at        | 2017-02-02T09:09:56Z                 |\n+-------------------+--------------------------------------+\n```\n- \u30eb\u30fc\u30bf\u30fc\u306e\u4f5c\u6210\n\n```\n[root@newton ~]# cd /root\n[root@newton ~]# source /root/keystonerc_demo\n[root@newton ~(keystone_demo)]# openstack router create router1\n+-------------------------+--------------------------------------+\n| Field                   | Value                                |\n+-------------------------+--------------------------------------+\n| admin_state_up          | UP                                   |\n| availability_zone_hints |                                      |\n| availability_zones      |                                      |\n| created_at              | 2017-02-02T09:10:50Z                 |\n| description             |                                      |\n| external_gateway_info   | null                                 |\n| flavor_id               | None                                 |\n| headers                 |                                      |\n| id                      | 5ac71d5c-7c98-43d5-a59d-e219902fa867 |\n| name                    | router1                              |\n| project_id              | 67d85efd952f4b6a8c03c6f86fecb8ea     |\n| project_id              | 67d85efd952f4b6a8c03c6f86fecb8ea     |\n| revision_number         | 2                                    |\n| routes                  |                                      |\n| status                  | ACTIVE                               |\n| updated_at              | 2017-02-02T09:10:50Z                 |\n+-------------------------+--------------------------------------+\n```\n```\n[root@newton ~(keystone_demo)]# neutron router-gateway-set router1 public_net\n[root@newton ~(keystone_demo)]# neutron router-interface-add router1 admin_subnet\n```\n### (2) nova\u4eee\u60f3\u30de\u30b7\u30f3\u3092KVM\u30cf\u30a4\u30d1\u30fc\u30d0\u30a4\u30b6\u3067\u52d5\u4f5c\u3055\u305b\u308b\n- INTEL VT-x\u306e\u6709\u52b9\u5316\n\n```\n[root@newton ~]# sudo modprobe kvm_intel\n[root@newton ~]# lsmod|grep kvm\nkvm_intel             170181  0 \nkvm                   554609  1 kvm_intel\nirqbypass              13503  1 kvm\n```\n- nova\u8a2d\u5b9a\u306e\u5909\u66f4\n\n```\n[root@newton ~]# vi /etc/nova/nova.conf\n```\n```text:/etc/nova/nova.conf\n# Allowed values: kvm, lxc, qemu, uml, xen, parallels\nvirt_type=kvm\n#virt_type=qemu\n```\n- OS\u518d\u8d77\u52d5\n\n```\n[root@newton ~]# reboot\n```\n### (3) Ubuntu\u30a4\u30e1\u30fc\u30b8\u767b\u9332\n- Ubuntu 16.04\u30a4\u30e1\u30fc\u30b8\u30d5\u30a1\u30a4\u30eb\u306e\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\n\n```\n[root@newton ~]# sudo yum install -y wget\n[root@newton ~]# wget http://cloud-images.ubuntu.com/releases/16.04/release/ubuntu-16.04-server-cloudimg-amd64-disk1.img -P /var/kvm/images\n```\n- Glane\u3078\u306e\u30a4\u30e1\u30fc\u30b8\u8ffd\u52a0\n\n```\n[root@newton ~]# cd /root\n[root@newton ~]# source keystonerc_admin\n[root@newton ~(keystone_admin)]# glance image-create --name \"Ubuntu1604\" --file /var/kvm/images/ubuntu-16.04-server-cloudimg-amd64-disk1.img --disk-format qcow2 --container-format bare --visibility public\n+------------------+--------------------------------------+\n| Property         | Value                                |\n+------------------+--------------------------------------+\n| checksum         | 186969f89823de2586e36b87e0f69875     |\n| container_format | bare                                 |\n| created_at       | 2017-02-02T05:54:34Z                 |\n| disk_format      | qcow2                                |\n| id               | 343a2c82-2959-4221-b567-bfc113020488 |\n| min_disk         | 0                                    |\n| min_ram          | 0                                    |\n| name             | Ubuntu1604                           |\n| owner            | f88a985676884b468bb75550d4e86999     |\n| protected        | False                                |\n| size             | 322502656                            |\n| status           | active                               |\n| tags             | []                                   |\n| updated_at       | 2017-02-02T05:54:37Z                 |\n| virtual_size     | None                                 |\n| visibility       | public                               |\n+------------------+--------------------------------------+\n```\n- \u767b\u9332\u6e08\u307fGlance\u30a4\u30e1\u30fc\u30b8\u306e\u78ba\u8a8d\n\n```\n[root@newton ~(keystone_admin)]# glance image-list\n+--------------------------------------+------------+\n| ID                                   | Name       |\n+--------------------------------------+------------+\n| f91e45cb-114e-4322-8883-109f7392c912 | cirros     |\n| 343a2c82-2959-4221-b567-bfc113020488 | Ubuntu1604 |\n+--------------------------------------+------------+\n```\n### (4) nova\u8af8\u8a2d\u5b9a\u306e\u8ffd\u52a0\n- keypair\u8ffd\u52a0\n\n```\n[root@newton ~]# cd /root\n[root@newton ~]# source keystonerc_demo\n[root@newton ~(keystone_demo)]# openstack keypair create mykey\n-----BEGIN RSA PRIVATE KEY-----\n\n... (snip)\n\n-----END RSA PRIVATE KEY-----\n```\n```\n[root@newton ~(keystone_demo)]# nova keypair-list \n+-------+------+-------------------------------------------------+\n| Name  | Type | Fingerprint                                     |\n+-------+------+-------------------------------------------------+\n| mykey | ssh  | 04:8c:27:d1:44:b3:e1:19:1a:d6:d8:13:70:d3:f9:70 |\n+-------+------+-------------------------------------------------+\n```\n- \u30ed\u30fc\u30ab\u30ebPC\u74b0\u5883\u306b\u3001\u30d7\u30e9\u30a4\u30d9\u30fc\u30c8\u30ad\u30fc\u60c5\u5831\u3092\u4fdd\u5b58\n- \u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30b0\u30eb\u30fc\u30d7\u8a2d\u5b9a\u8ffd\u52a0\uff08ICMP\u9001\u4fe1/\u53d7\u4fe1, TCP\u306e\u5168\u30dd\u30fc\u30c8\u9001\u4fe1/\u53d7\u4fe1\u3092\u958b\u653e\uff09\n\n```\n[root@newton ~(keystone_demo)]# neutron security-group-rule-create --protocol icmp default\nCreated a new security_group_rule:\n+-------------------+--------------------------------------+\n| Field             | Value                                |\n+-------------------+--------------------------------------+\n| created_at        | 2017-02-02T10:24:03Z                 |\n| description       |                                      |\n| direction         | ingress                              |\n| ethertype         | IPv4                                 |\n| id                | 7abf3219-5de4-4747-a8e8-e233c913ce13 |\n| port_range_max    |                                      |\n| port_range_min    |                                      |\n| project_id        | 67d85efd952f4b6a8c03c6f86fecb8ea     |\n| protocol          | icmp                                 |\n| remote_group_id   |                                      |\n| remote_ip_prefix  |                                      |\n| revision_number   | 1                                    |\n| security_group_id | bff315ad-0f08-45f8-8b14-5d19a9f95aa6 |\n| tenant_id         | 67d85efd952f4b6a8c03c6f86fecb8ea     |\n| updated_at        | 2017-02-02T10:24:03Z                 |\n+-------------------+--------------------------------------+\n```\n```\n[root@newton ~(keystone_demo)]# neutron security-group-rule-create --protocol tcp --port-range-min 1 --port-range-max 65535 default\nCreated a new security_group_rule:\n+-------------------+--------------------------------------+\n| Field             | Value                                |\n+-------------------+--------------------------------------+\n| created_at        | 2017-02-02T10:24:37Z                 |\n| description       |                                      |\n| direction         | ingress                              |\n| ethertype         | IPv4                                 |\n| id                | d8a982f6-99cc-4f73-ac35-814842937760 |\n| port_range_max    | 65535                                |\n| port_range_min    | 1                                    |\n| project_id        | 67d85efd952f4b6a8c03c6f86fecb8ea     |\n| protocol          | tcp                                  |\n| remote_group_id   |                                      |\n| remote_ip_prefix  |                                      |\n| revision_number   | 1                                    |\n| security_group_id | bff315ad-0f08-45f8-8b14-5d19a9f95aa6 |\n| tenant_id         | 67d85efd952f4b6a8c03c6f86fecb8ea     |\n| updated_at        | 2017-02-02T10:24:37Z                 |\n+-------------------+--------------------------------------+\n```\n- \u767b\u9332\u6e08\u307f\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30dd\u30ea\u30b7\u306e\u78ba\u8a8d\n\n```\n[root@newton ~(keystone_demo)]# neutron security-group-list\n+--------------------------------------+---------+----------------------------------------------------------------------+\n| id                                   | name    | security_group_rules                                                 |\n+--------------------------------------+---------+----------------------------------------------------------------------+\n| bff315ad-0f08-45f8-8b14-5d19a9f95aa6 | default | egress, IPv4                                                         |\n|                                      |         | egress, IPv6                                                         |\n|                                      |         | ingress, IPv4, 1-65535/tcp                                           |\n|                                      |         | ingress, IPv4, icmp                                                  |\n|                                      |         | ingress, IPv4, remote_group_id: bff315ad-0f08-45f8-8b14-5d19a9f95aa6 |\n|                                      |         | ingress, IPv6, remote_group_id: bff315ad-0f08-45f8-8b14-5d19a9f95aa6 |\n+--------------------------------------+---------+----------------------------------------------------------------------+\n```\n- \u767b\u9332\u6e08\u307f\u30d5\u30ec\u30fc\u30d0\u30fc\u306e\u78ba\u8a8d\n\n```\n[root@newton ~(keystone_demo)]# nova flavor-list\n+----+-----------+-----------+------+-----------+------+-------+-------------+-----------+\n| ID | Name      | Memory_MB | Disk | Ephemeral | Swap | VCPUs | RXTX_Factor | Is_Public |\n+----+-----------+-----------+------+-----------+------+-------+-------------+-----------+\n| 1  | m1.tiny   | 512       | 1    | 0         |      | 1     | 1.0         | True      |\n| 2  | m1.small  | 2048      | 20   | 0         |      | 1     | 1.0         | True      |\n| 3  | m1.medium | 4096      | 40   | 0         |      | 2     | 1.0         | True      |\n| 4  | m1.large  | 8192      | 80   | 0         |      | 4     | 1.0         | True      |\n| 5  | m1.xlarge | 16384     | 160  | 0         |      | 8     | 1.0         | True      |\n+----+-----------+-----------+------+-----------+------+-------+-------------+-----------+\n```\n## \u25a0 \u8a66\u3057\u306b\u3001nova\u4eee\u60f3\u30de\u30b7\u30f3\u3092\u4f5c\u6210\u3057\u3066\u307f\u308b\n### (1) \u30c6\u30ca\u30f3\u30c8\u30cd\u30c3\u30c8\u30ef\u30fc\u30af/nova\u4eee\u60f3\u30de\u30b7\u30f3\u306e\u6574\u5099\n- admin\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u7528\u30dd\u30fc\u30c8\u4f5c\u6210\n\n```\n[root@newton ~(keystone_demo)]# neutron port-create admin_net\nCreated a new port:\n+-----------------------+---------------------------------------------------------------------------------+\n| Field                 | Value                                                                           |\n+-----------------------+---------------------------------------------------------------------------------+\n| admin_state_up        | True                                                                            |\n| allowed_address_pairs |                                                                                 |\n| binding:vnic_type     | normal                                                                          |\n| created_at            | 2017-02-02T10:28:07Z                                                            |\n| description           |                                                                                 |\n| device_id             |                                                                                 |\n| device_owner          |                                                                                 |\n| extra_dhcp_opts       |                                                                                 |\n| fixed_ips             | {\"subnet_id\": \"31a40092-042b-4f27-a00c-54c9324db2ac\", \"ip_address\": \"10.0.0.4\"} |\n| id                    | 3155cbf3-ddcb-4acd-b5a1-dc37f4a49a4c                                            |\n| mac_address           | fa:16:3e:49:48:8e                                                               |\n| name                  |                                                                                 |\n| network_id            | 9ea97f2d-7ead-44b1-91e1-afc7ca22e21e                                            |\n| project_id            | 67d85efd952f4b6a8c03c6f86fecb8ea                                                |\n| revision_number       | 4                                                                               |\n| security_groups       | bff315ad-0f08-45f8-8b14-5d19a9f95aa6                                            |\n| status                | DOWN                                                                            |\n| tenant_id             | 67d85efd952f4b6a8c03c6f86fecb8ea                                                |\n| updated_at            | 2017-02-02T10:28:07Z                                                            |\n+-----------------------+---------------------------------------------------------------------------------+\n```\n- nova\u4eee\u60f3\u30de\u30b7\u30f3\u306e\u4f5c\u6210\uff08\u7ba1\u7406\u30dd\u30fc\u30c8\uff1aUUID: 3155cbf3-ddcb-4acd-b5a1-dc37f4a49a4c\uff09\n\n```\n[root@newton ~(keystone_demo)]# nova boot --flavor 2 --image Ubuntu1604 --key-name mykey --security-groups default --nic port-id=3155cbf3-ddcb-4acd-b5a1-dc37f4a49a4c server1\n+--------------------------------------+---------------------------------------------------+\n| Property                             | Value                                             |\n+--------------------------------------+---------------------------------------------------+\n| OS-DCF:diskConfig                    | MANUAL                                            |\n| OS-EXT-AZ:availability_zone          |                                                   |\n| OS-EXT-STS:power_state               | 0                                                 |\n| OS-EXT-STS:task_state                | scheduling                                        |\n| OS-EXT-STS:vm_state                  | building                                          |\n| OS-SRV-USG:launched_at               | -                                                 |\n| OS-SRV-USG:terminated_at             | -                                                 |\n| accessIPv4                           |                                                   |\n| accessIPv6                           |                                                   |\n| adminPass                            | u4qBLa6NB7nr                                      |\n| config_drive                         |                                                   |\n| created                              | 2017-02-02T10:32:02Z                              |\n| description                          | -                                                 |\n| flavor                               | m1.small (2)                                      |\n| hostId                               |                                                   |\n| id                                   | ab70f784-385d-44a8-b010-1322e7be94a7              |\n| image                                | Ubuntu1604 (343a2c82-2959-4221-b567-bfc113020488) |\n| key_name                             | mykey                                             |\n| locked                               | False                                             |\n| metadata                             | {}                                                |\n| name                                 | server1                                           |\n| os-extended-volumes:volumes_attached | []                                                |\n| progress                             | 0                                                 |\n| security_groups                      | default                                           |\n| status                               | BUILD                                             |\n| tags                                 | []                                                |\n| tenant_id                            | 67d85efd952f4b6a8c03c6f86fecb8ea                  |\n| updated                              | 2017-02-02T10:32:03Z                              |\n| user_id                              | 538dcaaea36c4757bfd10fb862d50709                  |\n+--------------------------------------+---------------------------------------------------+\n```\n- nova\u4eee\u60f3\u30de\u30b7\u30f3\u306e\u63a5\u7d9a\u30a4\u30f3\u30bf\u30d5\u30a7\u30fc\u30b9\u78ba\u8a8d\n\n```\n[root@newton ~(keystone_demo)]# nova interface-list server1\n+------------+--------------------------------------+--------------------------------------+--------------+-------------------+\n| Port State | Port ID                              | Net ID                               | IP addresses | MAC Addr          |\n+------------+--------------------------------------+--------------------------------------+--------------+-------------------+\n| ACTIVE     | 3155cbf3-ddcb-4acd-b5a1-dc37f4a49a4c | 9ea97f2d-7ead-44b1-91e1-afc7ca22e21e | 10.0.0.4     | fa:16:3e:49:48:8e |\n+------------+--------------------------------------+--------------------------------------+--------------+-------------------+\n```\n### (2) \u5916\u90e8\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u3068\u306e\u30a2\u30af\u30bb\u30b9\u74b0\u5883\u306e\u6574\u5099\n- Floatingip\u306e\u4f5c\u6210\n\n```\n[root@newton ~(keystone_demo)]# neutron floatingip-create public_net\nCreated a new floatingip:\n+---------------------+--------------------------------------+\n| Field               | Value                                |\n+---------------------+--------------------------------------+\n| created_at          | 2017-02-02T10:32:59Z                 |\n| description         |                                      |\n| fixed_ip_address    |                                      |\n| floating_ip_address | 10.79.5.191                          |\n| floating_network_id | c920de08-7acf-44c9-8b13-b97033312267 |\n| id                  | affd1370-760d-4148-9d48-5afb9f97eaf5 |\n| port_id             |                                      |\n| project_id          | 67d85efd952f4b6a8c03c6f86fecb8ea     |\n| revision_number     | 1                                    |\n| router_id           |                                      |\n| status              | DOWN                                 |\n| tenant_id           | 67d85efd952f4b6a8c03c6f86fecb8ea     |\n| updated_at          | 2017-02-02T10:32:59Z                 |\n+---------------------+--------------------------------------+\n```\n- \u767b\u9332\u6e08\u307fFloatingip\u306e\u78ba\u8a8d\n\n```\n[root@newton ~(keystone_demo)]# neutron floatingip-list\n+--------------------------------------+------------------+---------------------+---------+\n| id                                   | fixed_ip_address | floating_ip_address | port_id |\n+--------------------------------------+------------------+---------------------+---------+\n| affd1370-760d-4148-9d48-5afb9f97eaf5 |                  | 10.79.5.191         |         |\n+--------------------------------------+------------------+---------------------+---------+\n```\n- Floatingip\u3068Port\u3068\u306e\u5bfe\u5fdc\u4ed8\u3051\n\n```\n[root@newton ~(keystone_demo)]# neutron floatingip-associate affd1370-760d-4148-9d48-5afb9f97eaf5 3155cbf3-ddcb-4acd-b5a1-dc37f4a49a4c\n```\n```\n[root@newton ~(keystone_demo)]# neutron floatingip-list\n+--------------------------------------+------------------+---------------------+--------------------------------------+\n| id                                   | fixed_ip_address | floating_ip_address | port_id                              |\n+--------------------------------------+------------------+---------------------+--------------------------------------+\n| affd1370-760d-4148-9d48-5afb9f97eaf5 | 10.0.0.4         | 10.79.5.191         | 3155cbf3-ddcb-4acd-b5a1-dc37f4a49a4c |\n+--------------------------------------+------------------+---------------------+--------------------------------------+\n```\n\n### (3) \u5916\u90e8\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u304b\u3089\u306e\u30a2\u30af\u30bb\u30b9\u78ba\u8a8d\n- nova\u4eee\u60f3\u30de\u30b7\u30f3\u5b9b\u3078\u306ePing\u30a2\u30af\u30bb\u30b9\n\n```\n$ ping 10.79.5.191\nPING 10.79.5.191 (10.79.5.191): 56 data bytes\n64 bytes from 10.79.5.191: icmp_seq=0 ttl=60 time=6.981 ms\n64 bytes from 10.79.5.191: icmp_seq=1 ttl=60 time=3.223 ms\n64 bytes from 10.79.5.191: icmp_seq=2 ttl=60 time=3.115 ms\n64 bytes from 10.79.5.191: icmp_seq=3 ttl=60 time=10.910 ms\n64 bytes from 10.79.5.191: icmp_seq=4 ttl=60 time=6.581 ms\n^C\n--- 10.79.5.191 ping statistics ---\n5 packets transmitted, 5 packets received, 0.0% packet loss\nround-trip min/avg/max/stddev = 3.115/6.162/10.910/2.874 ms\n```\n- nova\u4eee\u60f3\u30de\u30b7\u30f3\u3078\u306essh\u30ed\u30b0\u30a4\u30f3\n\n```\n$ ssh -i mykey.pem ubuntu@10.79.5.191\nThe authenticity of host '10.79.5.191 (10.79.5.191)' can't be established.\nECDSA key fingerprint is SHA256:PTCeFS89cTqGAPGxGkDHuadrWsfjeMo0sU5zmEhXrmY.\nAre you sure you want to continue connecting (yes/no)? yes\nWarning: Permanently added '10.79.5.191' (ECDSA) to the list of known hosts.\nWelcome to Ubuntu 16.04.1 LTS (GNU/Linux 4.4.0-59-generic x86_64)\n\n * Documentation:  https://help.ubuntu.com\n * Management:     https://landscape.canonical.com\n * Support:        https://ubuntu.com/advantage\n\n  Get cloud support with Ubuntu Advantage Cloud Guest:\n    http://www.ubuntu.com/business/services/cloud\n\n0 packages can be updated.\n0 updates are security updates.\n\n\nLast login: Thu Feb  2 10:34:53 2017 from 10.79.5.117\nTo run a command as administrator (user \"root\"), use \"sudo <command>\".\nSee \"man sudo_root\" for details.\n\nubuntu@server1:~$ ip addr\n1: lo: <LOOPBACK,UP,LOWER_UP> mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1\n    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00\n    inet 127.0.0.1/8 scope host lo\n       valid_lft forever preferred_lft forever\n    inet6 ::1/128 scope host \n       valid_lft forever preferred_lft forever\n2: ens3: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1450 qdisc pfifo_fast state UP group default qlen 1000\n    link/ether fa:16:3e:49:48:8e brd ff:ff:ff:ff:ff:ff\n    inet 10.0.0.4/24 brd 10.0.0.255 scope global ens3\n       valid_lft forever preferred_lft forever\n    inet6 fe80::f816:3eff:fe49:488e/64 scope link \n       valid_lft forever preferred_lft forever\n```\n\n## \u25a0 \u3055\u3089\u306b\u3001\uff12\u53f0\u76ee\u306enova\u4eee\u60f3\u30de\u30b7\u30f3\u3092\u4f5c\u6210\u3059\u308b\n### (1) \u30c6\u30ca\u30f3\u30c8\u30cd\u30c3\u30c8\u30ef\u30fc\u30af/nova\u4eee\u60f3\u30de\u30b7\u30f3\u306e\u6574\u5099\n- admin\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u7528\u30dd\u30fc\u30c8\u4f5c\u6210\n\n```\n[root@newton ~(keystone_demo)]# neutron port-create admin_net\nCreated a new port:\n+-----------------------+----------------------------------------------------------------------------------+\n| Field                 | Value                                                                            |\n+-----------------------+----------------------------------------------------------------------------------+\n| admin_state_up        | True                                                                             |\n| allowed_address_pairs |                                                                                  |\n| binding:vnic_type     | normal                                                                           |\n| created_at            | 2017-02-02T10:40:11Z                                                             |\n| description           |                                                                                  |\n| device_id             |                                                                                  |\n| device_owner          |                                                                                  |\n| extra_dhcp_opts       |                                                                                  |\n| fixed_ips             | {\"subnet_id\": \"31a40092-042b-4f27-a00c-54c9324db2ac\", \"ip_address\": \"10.0.0.11\"} |\n| id                    | 75f7e4ac-600b-4a45-9948-d45b3ec7169b                                             |\n| mac_address           | fa:16:3e:7c:92:60                                                                |\n| name                  |                                                                                  |\n| network_id            | 9ea97f2d-7ead-44b1-91e1-afc7ca22e21e                                             |\n| project_id            | 67d85efd952f4b6a8c03c6f86fecb8ea                                                 |\n| revision_number       | 4                                                                                |\n| security_groups       | bff315ad-0f08-45f8-8b14-5d19a9f95aa6                                             |\n| status                | DOWN                                                                             |\n| tenant_id             | 67d85efd952f4b6a8c03c6f86fecb8ea                                                 |\n| updated_at            | 2017-02-02T10:40:11Z                                                             |\n+-----------------------+----------------------------------------------------------------------------------+\n```\n- nova\u4eee\u60f3\u30de\u30b7\u30f3\u306e\u4f5c\u6210\uff08\u7ba1\u7406\u30dd\u30fc\u30c8\uff1aUUID: 75f7e4ac-600b-4a45-9948-d45b3ec7169b\uff09\n\n```\n[root@newton ~(keystone_demo)]# nova boot --flavor 1 --image cirros --key-name mykey --security-groups default --nic port-id=75f7e4ac-600b-4a45-9948-d45b3ec7169b server2\n+--------------------------------------+-----------------------------------------------+\n| Property                             | Value                                         |\n+--------------------------------------+-----------------------------------------------+\n| OS-DCF:diskConfig                    | MANUAL                                        |\n| OS-EXT-AZ:availability_zone          |                                               |\n| OS-EXT-STS:power_state               | 0                                             |\n| OS-EXT-STS:task_state                | scheduling                                    |\n| OS-EXT-STS:vm_state                  | building                                      |\n| OS-SRV-USG:launched_at               | -                                             |\n| OS-SRV-USG:terminated_at             | -                                             |\n| accessIPv4                           |                                               |\n| accessIPv6                           |                                               |\n| adminPass                            | Qcu3AEVN3m4P                                  |\n| config_drive                         |                                               |\n| created                              | 2017-02-02T10:41:35Z                          |\n| description                          | -                                             |\n| flavor                               | m1.tiny (1)                                   |\n| hostId                               |                                               |\n| id                                   | 06521269-bddb-4def-8369-3f92fd2f4622          |\n| image                                | cirros (f91e45cb-114e-4322-8883-109f7392c912) |\n| key_name                             | mykey                                         |\n| locked                               | False                                         |\n| metadata                             | {}                                            |\n| name                                 | server2                                       |\n| os-extended-volumes:volumes_attached | []                                            |\n| progress                             | 0                                             |\n| security_groups                      | default                                       |\n| status                               | BUILD                                         |\n| tags                                 | []                                            |\n| tenant_id                            | 67d85efd952f4b6a8c03c6f86fecb8ea              |\n| updated                              | 2017-02-02T10:41:35Z                          |\n| user_id                              | 538dcaaea36c4757bfd10fb862d50709              |\n+--------------------------------------+-----------------------------------------------+\n```\n- nova\u4eee\u60f3\u30de\u30b7\u30f3\u306e\u63a5\u7d9a\u30a4\u30f3\u30bf\u30d5\u30a7\u30fc\u30b9\u78ba\u8a8d\n\n```\n[root@newton ~(keystone_demo)]# nova interface-list server2\n+------------+--------------------------------------+--------------------------------------+--------------+-------------------+\n| Port State | Port ID                              | Net ID                               | IP addresses | MAC Addr          |\n+------------+--------------------------------------+--------------------------------------+--------------+-------------------+\n| ACTIVE     | 75f7e4ac-600b-4a45-9948-d45b3ec7169b | 9ea97f2d-7ead-44b1-91e1-afc7ca22e21e | 10.0.0.11    | fa:16:3e:7c:92:60 |\n+------------+--------------------------------------+--------------------------------------+--------------+-------------------+\n```\n### (2) \u5916\u90e8\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u3068\u306e\u30a2\u30af\u30bb\u30b9\u74b0\u5883\u306e\u6574\u5099\n- Floatingip\u306e\u4f5c\u6210\n\n```\n[root@newton ~(keystone_demo)]# neutron floatingip-create public_net\nCreated a new floatingip:\n+---------------------+--------------------------------------+\n| Field               | Value                                |\n+---------------------+--------------------------------------+\n| created_at          | 2017-02-02T10:44:47Z                 |\n| description         |                                      |\n| fixed_ip_address    |                                      |\n| floating_ip_address | 10.79.5.195                          |\n| floating_network_id | c920de08-7acf-44c9-8b13-b97033312267 |\n| id                  | cb83e8bc-47c2-438a-8c74-2f1654ddc09c |\n| port_id             |                                      |\n| project_id          | 67d85efd952f4b6a8c03c6f86fecb8ea     |\n| revision_number     | 1                                    |\n| router_id           |                                      |\n| status              | DOWN                                 |\n| tenant_id           | 67d85efd952f4b6a8c03c6f86fecb8ea     |\n| updated_at          | 2017-02-02T10:44:47Z                 |\n+---------------------+--------------------------------------+\n```\n- Floatingip\u3068Port\u3068\u306e\u5bfe\u5fdc\u4ed8\u3051\n\n```\n[root@newton ~(keystone_demo)]# neutron floatingip-associate cb83e8bc-47c2-438a-8c74-2f1654ddc09c 75f7e4ac-600b-4a45-9948-d45b3ec7169b\n```\n```\n[root@newton ~(keystone_demo)]# neutron floatingip-list\n+--------------------------------------+------------------+---------------------+--------------------------------------+\n| id                                   | fixed_ip_address | floating_ip_address | port_id                              |\n+--------------------------------------+------------------+---------------------+--------------------------------------+\n| affd1370-760d-4148-9d48-5afb9f97eaf5 | 10.0.0.4         | 10.79.5.191         | 3155cbf3-ddcb-4acd-b5a1-dc37f4a49a4c |\n| cb83e8bc-47c2-438a-8c74-2f1654ddc09c | 10.0.0.11        | 10.79.5.195         | 75f7e4ac-600b-4a45-9948-d45b3ec7169b |\n+--------------------------------------+------------------+---------------------+--------------------------------------+\n```\n\n### (3) \u5916\u90e8\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u304b\u3089\u306e\u30a2\u30af\u30bb\u30b9\u78ba\u8a8d\n- nova\u4eee\u60f3\u30de\u30b7\u30f3\u5b9b\u3078\u306ePing\u30a2\u30af\u30bb\u30b9\n\n```\n$ ping 10.79.5.195\nPING 10.79.5.195 (10.79.5.195): 56 data bytes\n64 bytes from 10.79.5.195: icmp_seq=0 ttl=60 time=213.721 ms\n64 bytes from 10.79.5.195: icmp_seq=1 ttl=60 time=8.048 ms\n64 bytes from 10.79.5.195: icmp_seq=2 ttl=60 time=2.879 ms\n64 bytes from 10.79.5.195: icmp_seq=3 ttl=60 time=5.780 ms\n64 bytes from 10.79.5.195: icmp_seq=4 ttl=60 time=8.354 ms\n^C\n--- 10.79.5.195 ping statistics ---\n5 packets transmitted, 5 packets received, 0.0% packet loss\nround-trip min/avg/max/stddev = 2.879/47.756/213.721/83.005 ms\n```\n- nova\u4eee\u60f3\u30de\u30b7\u30f3\u3078\u306essh\u30ed\u30b0\u30a4\u30f3\n\n```\n$ ssh -i mykey.pem cirros@10.79.5.195\nThe authenticity of host '10.79.5.195 (10.79.5.195)' can't be established.\nRSA key fingerprint is SHA256:VHpD4TfqBg2vMYnU6I2NRj4NXlN4SKhpQjTm50rW9Tc.\nAre you sure you want to continue connecting (yes/no)? yes\nWarning: Permanently added '10.79.5.195' (RSA) to the list of known hosts.\n$ ip addr\n1: lo: <LOOPBACK,UP,LOWER_UP> mtu 16436 qdisc noqueue \n    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00\n    inet 127.0.0.1/8 scope host lo\n    inet6 ::1/128 scope host \n       valid_lft forever preferred_lft forever\n2: eth0: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1450 qdisc pfifo_fast qlen 1000\n    link/ether fa:16:3e:7c:92:60 brd ff:ff:ff:ff:ff:ff\n    inet 10.0.0.11/24 brd 10.0.0.255 scope global eth0\n    inet6 fe80::f816:3eff:fe7c:9260/64 scope link \n       valid_lft forever preferred_lft forever\n$ ip addr\n1: lo: <LOOPBACK,UP,LOWER_UP> mtu 16436 qdisc noqueue \n    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00\n    inet 127.0.0.1/8 scope host lo\n    inet6 ::1/128 scope host \n       valid_lft forever preferred_lft forever\n2: eth0: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1450 qdisc pfifo_fast qlen 1000\n    link/ether fa:16:3e:7c:92:60 brd ff:ff:ff:ff:ff:ff\n    inet 10.0.0.11/24 brd 10.0.0.255 scope global eth0\n    inet6 fe80::f816:3eff:fe7c:9260/64 scope link \n       valid_lft forever preferred_lft forever\n```\n\n## \u25a0 \u6700\u7d42\u7684\u306b\u4f5c\u6210\u3057\u305fneutron\u4eee\u60f3\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u69cb\u6210\n- nova\u4eee\u60f3\u30de\u30b7\u30f3\u4e00\u89a7\u306e\u78ba\u8a8d\n\n```\n[root@newton ~(keystone_demo)]# nova list\n+--------------------------------------+---------+--------+------------+-------------+----------------------------------+\n| ID                                   | Name    | Status | Task State | Power State | Networks                         |\n+--------------------------------------+---------+--------+------------+-------------+----------------------------------+\n| ab70f784-385d-44a8-b010-1322e7be94a7 | server1 | ACTIVE | -          | Running     | admin_net=10.0.0.4, 10.79.5.191  |\n| 06521269-bddb-4def-8369-3f92fd2f4622 | server2 | ACTIVE | -          | Running     | admin_net=10.0.0.11, 10.79.5.195 |\n+--------------------------------------+---------+--------+------------+-------------+----------------------------------+\n```\n- neutron\u30d5\u30ed\u30fc\u30c6\u30a3\u30f3\u30b0IP\u4e00\u89a7\u306e\u78ba\u8a8d\n\n```\n[root@newton ~(keystone_demo)]# neutron floatingip-list\n+--------------------------------------+------------------+---------------------+--------------------------------------+\n| id                                   | fixed_ip_address | floating_ip_address | port_id                              |\n+--------------------------------------+------------------+---------------------+--------------------------------------+\n| affd1370-760d-4148-9d48-5afb9f97eaf5 | 10.0.0.4         | 10.79.5.191         | 3155cbf3-ddcb-4acd-b5a1-dc37f4a49a4c |\n| cb83e8bc-47c2-438a-8c74-2f1654ddc09c | 10.0.0.11        | 10.79.5.195         | 75f7e4ac-600b-4a45-9948-d45b3ec7169b |\n+--------------------------------------+------------------+---------------------+--------------------------------------+\n```\n![topology.png](https://qiita-image-store.s3.amazonaws.com/0/103595/de455a5d-58ff-73e9-6e88-96e916901232.png)\n\n\nNewton\u7248OpenStack\u304c\u69cb\u7bc9\u3067\u304d\u305f\u306e\u3067\u3001\u601d\u3046\u5b58\u5206\u306b\u3001OpenStack\u6280\u8853\u3092\u7fd2\u719f\u3057\u305f\u3044\u3068\u601d\u3044\u307e\u3059\u3002\n", "tags": ["openstack"]}