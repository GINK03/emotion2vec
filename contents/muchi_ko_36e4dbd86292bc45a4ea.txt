{"context": " More than 1 year has passed since last update.\n\nDependencies\n\nPHP >= 5.3.0\n\nMonolog == 1.17.2\n\nfluent-logger-php == v1.0.0\n\n\nFluentHandler.php\nuse Monolog\\Logger;\nuse Monolog\\Handler\\AbstractProcessingHandler;\n\nuse Fluent\\Logger\\Entity;\nuse Fluent\\Logger\\FluentLogger;\n\nclass FluentHandler extends AbstractProcessingHandler\n{\n    protected $logger;\n\n    public function __construct($host = FluentLogger::DEFAULT_ADDRESS,\n                                $port = FluentLogger::DEFAULT_LISTEN_PORT,\n                                $level = Logger::DEBUG,\n                                $bubble = true)\n    {\n\n        parent::__construct($level, $bubble);\n        $this->logger = new FluentLogger($host, $port);\n    }\n\n    /**\n     * {@inheritdoc}\n     */\n    protected function write(array $record)\n    {\n        $tag  = $record['channel'] . '.' . strtolower($record['level_name']);\n        $time = $record['datetime']->getTimestamp();\n\n        $data = $record['context'];\n        $data['message'] = $record['message'];\n\n        $entity = new Entity($tag, $data, $time);\n        $this->logger->post2($entity);\n    }\n}\n\n\n\nindex.php\n$autoload = include realpath(__DIR__ . '/vendor/autoload.php');\n\nuse Monolog\\Logger;\n\ninclude realpath(__DIR__ . '/FluentHandler.php');\n\n$log = new Logger('fluentd.test');\n$log->pushHandler(new FluentHandler(\"unix:///var/run/td-agent/td-agent.sock\"));\n$log->warning('message', array(\"from\"=>\"userA\", \"to\"=>\"userB\"));\n\n\n\n## Dependencies ##\n\n- PHP >= 5.3.0\n- [Monolog](http://github.com/Seldaek/monolog) == 1.17.2\n- [fluent-logger-php](http://github.com/fluent/fluent-logger-php) == v1.0.0\n\n```php:FluentHandler.php\nuse Monolog\\Logger;\nuse Monolog\\Handler\\AbstractProcessingHandler;\n\nuse Fluent\\Logger\\Entity;\nuse Fluent\\Logger\\FluentLogger;\n\nclass FluentHandler extends AbstractProcessingHandler\n{\n    protected $logger;\n\n    public function __construct($host = FluentLogger::DEFAULT_ADDRESS,\n                                $port = FluentLogger::DEFAULT_LISTEN_PORT,\n                                $level = Logger::DEBUG,\n                                $bubble = true)\n    {\n\n        parent::__construct($level, $bubble);\n        $this->logger = new FluentLogger($host, $port);\n    }\n\n    /**\n     * {@inheritdoc}\n     */\n    protected function write(array $record)\n    {\n        $tag  = $record['channel'] . '.' . strtolower($record['level_name']);\n        $time = $record['datetime']->getTimestamp();\n\n        $data = $record['context'];\n        $data['message'] = $record['message'];\n\n        $entity = new Entity($tag, $data, $time);\n        $this->logger->post2($entity);\n    }\n}\n```\n\n```php:index.php\n$autoload = include realpath(__DIR__ . '/vendor/autoload.php');\n\nuse Monolog\\Logger;\n\ninclude realpath(__DIR__ . '/FluentHandler.php');\n\n$log = new Logger('fluentd.test');\n$log->pushHandler(new FluentHandler(\"unix:///var/run/td-agent/td-agent.sock\"));\n$log->warning('message', array(\"from\"=>\"userA\", \"to\"=>\"userB\"));\n\n```\n", "tags": ["PHP", "fluentd"]}