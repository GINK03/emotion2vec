{"context": "\n\n\u306f\u3058\u3081\u306b\nPlay\u306fTypesafe\u793e\u304c\u63d0\u4f9b\u3057\u3066\u3044\u308bWeb\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u305f\u3081\u306e\u30d5\u30ec\u30fc\u30e0\u30ef\u30fc\u30af\u3067\u3059\u3002\n\u4ed6\u306e\u30d5\u30ec\u30fc\u30e0\u30ef\u30fc\u30af\u3068\u540c\u69d8\u3001Play\u3082MVC\u30a2\u30fc\u30ad\u30c6\u30af\u30c1\u30e3\u30fc\u3092\u63a1\u7528\u3057\u3066\u3044\u308b\u306e\u3067\u3059\u304c\u3001\u9762\u767d\u3044\u70b9\u306fModel\u3068Controller\u306e\u5b9f\u88c5\u3092Java\u3068Scala\u306e2\u3064\u304b\u3089\u9078\u3079\u308b\u3053\u3068\u3002\n\u300cJava\u3068Scala\u306e2\u3064\u3092\u63d0\u4f9b\u3057\u3066\u3044\u308b\u3093\u3060\u3063\u305f\u3089\u4f55\u3082Java\u306e\u4f5c\u6cd5\u306b\u7e1b\u3089\u308c\u308b\u3053\u3068\u306a\u3044\u3088\u306d\u300d\u3068\u3044\u3046\u3053\u3068\u306a\u306e\u304b\u3001Play\u306b\u306f\u3001Java\u3067Web\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3068\u306a\u308c\u3070\u5f53\u7136\u51fa\u3066\u304f\u308b\u30b5\u30fc\u30d6\u30ec\u30c3\u30c8\u3084JSP\u3068\u3044\u3063\u305fJavaEE\u306e\u6982\u5ff5\u30e2\u30c7\u30eb\u306f\u4e00\u5207\u306a\u304f\u3001\u3069\u3061\u3089\u304b\u3068\u3044\u3046\u3068\u3001Ruby on Rails\u306e\u3088\u3046\u306a\u8efd\u91cf\u30d5\u30ec\u30fc\u30e0\u30ef\u30fc\u30af\u3068\u3057\u3066\u5b9f\u88c5\u3055\u308c\u3066\u3044\u308b\u3088\u3046\u3067\u3059\u3002\n\u9577\u5e74Java\u4e00\u7b4b\u3067\u3001Web\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306f\u57fa\u672c\u30b5\u30fc\u30d6\u30ec\u30c3\u30c8\u3001\u6b21\u3005\u3068\u65b0\u3057\u3044\u30d5\u30ec\u30fc\u30e0\u30ef\u30fc\u30af\u304c\u51fa\u3066\u3082JavaEE\u306e\u7bc4\u7587\u3067\u3002\u3002\u3002\u305d\u3093\u306a\u4e2d\u3001Rails\u306e\u6ce2\u306b\u3082\u4e57\u308b\u3053\u3068\u304c\u3067\u304d\u305a\u3001\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u306e\u7169\u96d1\u3055\u3084\u958b\u767a\u30b9\u30d4\u30fc\u30c9\u306e\u5dee\u306b\u6c17\u4ed8\u3044\u3066\u306f\u3044\u3066\u3082\u3001Ruby\u306f\u52d5\u7684\u578b\u4ed8\u3060\u304b\u3089\u3002\u3002\u3002\u3068\u81ea\u5206\u3092\u8a00\u3044\u805e\u304b\u305b\u3066\u304d\u305f\u65e5\u3005\u3002\u3002\u3002\nJava\u3082Scala\u3082\u9759\u7684\u578b\u4ed8\u8a00\u8a9e\u3001\u30d7\u30e9\u30b9Rails\u306e\u3088\u3046\u306a\u8efd\u91cf\u30d5\u30ec\u30fc\u30e0\u30ef\u30fc\u30af\u3002\u4eca\u56dePlay\u306e\u5b9f\u529b\u3092\u78ba\u304b\u3081\u308b\u3079\u304f\u3001Java\u3068Scala\u3067\u5358\u7d14\u306aWeb\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u4f5c\u6210\u3057\u3066\u307f\u307e\u3057\u305f\u3002\n\u5c11\u3057\u898b\u3065\u3089\u3044\u306e\u3067\u3059\u304c\u3001\u305b\u3063\u304b\u304f\u3067\u3059\u306e\u3067\u3001Java\u3068Scala\u306e2\u3064\u306e\u30b3\u30fc\u30c9\u3092\u8f09\u305b\u3066\u6bd4\u8f03\u3057\u3066\u307f\u305f\u3044\u3068\u601d\u3044\u307e\u3059\u3002\n\u306a\u304a\u3001Scala\u306e\u5b9f\u88c5\u306b\u3064\u304d\u307e\u3057\u3066\u306f\u3001\u4e0b\u8a18\u306e\u8a18\u4e8b\u306e\u65b9\u304c\u30b9\u30de\u30fc\u30c8\u306a\u5b9f\u88c5\u306b\u306a\u3063\u3066\u3044\u307e\u3059\u306e\u3067\u3001\u305d\u3061\u3089\u3092\u3054\u53c2\u7167\u304f\u3060\u3055\u3044\u3002\nPlay 2.5\u3067\u306eCRUD\u51e6\u7406\u304a\u3088\u3073\u30e1\u30fc\u30eb\u9001\u4fe1\uff08activator\u306b\u3088\u308b\u958b\u767a\u74b0\u5883\u306e\u69cb\u7bc9\u304b\u3089keter\u306b\u3088\u308b\u30c7\u30d7\u30ed\u30a4\u307e\u3067\n\n\u74b0\u5883\nPlay Framework 2.4.3\nJava 8\nScala 2.11\nEbean ORM\uff1f\nSlick 3.0\n\n\u4f5c\u6210\u3059\u308bWeb\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306b\u3064\u3044\u3066\n\u643a\u5e2f\u96fb\u8a71\u306e\u30ab\u30ec\u30f3\u30c0\u30fc\u6a5f\u80fd\u306b\u306f\u3001\u4e88\u5b9a\u3092\u767b\u9332\u3059\u308b\u3068\u3001\u305d\u306e\u958b\u59cb\u65e5\u6642\u306e\u25cb\u5206\u524d\u306b\u30a2\u30e9\u30fc\u30e0\u3092\u306a\u3089\u3059\u6a5f\u80fd\u304c\u3042\u308b\u304b\u3068\u601d\u3044\u307e\u3059\u3002\u79c1\u306e\u30ac\u30e9\u30db\uff08AQUOS K SHF32\uff09\u3067\u306f\u30a2\u30e9\u30fc\u30e0\u306f\u547c\u51fa\u97f3\u306e\u8a2d\u5b9a\u3068\u9023\u52d5\u3057\u3066\u3044\u308b\u3088\u3046\u3067\u3001\u547c\u51fa\u97f3\u3092\u5207\u3063\u3066\u30d0\u30a4\u30d6\u306e\u307f\u3067\u4f7f\u7528\u3057\u3066\u3044\u308b\u3068\u3001\u5f53\u7136\u30a2\u30e9\u30fc\u30e0\u306f\u9cf4\u3089\u305a\u3001\u305d\u308c\u3060\u3051\u306a\u3089\u307e\u3060\u3057\u3082\u3001\u30d0\u30a4\u30d6\u3059\u3089\u3057\u3066\u304f\u308c\u306a\u3044\u3068\u3044\u3046\u4f7f\u3044\u52dd\u624b\u306e\u60aa\u3055\u3002\n\u3068\u3044\u3046\u3053\u3068\u3067\u3001\u305d\u306e\u6a5f\u80fd\u3092Web\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3068\u3057\u3066\u4f5c\u6210\u3059\u308b\u3053\u3068\u306b\u3057\u3066\u307f\u307e\u3057\u305f\u3002\n\u6982\u8981\u306f\u3001\u30b5\u30a4\u30c8\u306b\u30a2\u30af\u30bb\u30b9\u3057\u3001\u4ef6\u540d\u3001\u958b\u59cb\u6642\u523b\u3001\u901a\u77e5\u6642\u9593\uff08\u25cb\u5206\u524d\uff09\u3001\u8aac\u660e\u6587\u3092\u767b\u9332\u3059\u308b\u3068\u3001\u30b5\u30fc\u30d0\u5074\u3067\u305d\u306e\u901a\u77e5\u6642\u523b\u306b\u306a\u3063\u305f\u6642\u70b9\u3067\u3001\u30e1\u30fc\u30eb\u3092\u914d\u4fe1\u3057\u3066\u304f\u308c\u308b\u3068\u3044\u3046Web\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3067\u3059\u3002\n\n\n\nModel\u3068DAO\u306e\u4f5c\u6210\uff08Java\u7de8\uff09\n\u307e\u305aModel\u306e\u4f5c\u6210\u304b\u3089\u59cb\u3081\u3066\u3044\u304d\u307e\u3059\u3002\n\u307e\u305a\u306f\u6163\u308c\u89aa\u3057\u3093\u3060Java\u304b\u3089\u3002Java\u3067\u306f\u300cEbean ORM\u300d\u3068\u3044\u3046ORM\u3092\u4f7f\u3044\u307e\u3059\u3002Ebean\u3092\u4f7f\u7528\u3059\u308b\u305f\u3081\u3001Play2.4\u306e\u30aa\u30d5\u30a3\u30b7\u30e3\u30eb\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u3092\u53c2\u8003\u306b\u4e0b\u8a18\u306e3\u70b9\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n\uff11\uff0eproject/plugins.sbt\u306b\u4e0b\u8a18\u3092\u8ffd\u8a18\n\nproject/plugins.sbt\naddSbtPlugin(\"com.typesafe.sbt\" % \"sbt-play-ebean\" % \"1.0.0\")\n\n\n\uff12\uff0ebuild.sbt\u306b\u4e0b\u8a18\u3092\u8ffd\u8a18\n\nbuild.sbt\nlazy val myProject = (project in file(\".\")).enablePlugins(PlayJava, PlayEbean)\n\n\n\uff13\uff0econf/application.conf\u306b\u4e0b\u8a18\u3092\u8ffd\u8a18\n\nconf/application.conf\ndb.default.driver=org.h2.Driver\ndb.default.url=\"jdbc:h2:mem:play\"\nebean.default = [\"models.*\"]\n\n\n\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306fH2\u306e\u30e1\u30e2\u30ea\u30b9\u30c8\u30ec\u30fc\u30b8\u3067\u884c\u3044\u307e\u3059\u3002\n\u305d\u3057\u3066\u3001app/models/Notification.java\u306b\u4e0b\u8a18\u306e\u5b9f\u88c5\u3092\u3002\n\napp/models/Notification.java\npackage models;\n\nimport java.util.*;\n\nimport javax.persistence.*;\n\nimport com.avaje.ebean.Model;\nimport com.avaje.ebean.annotation.*;\n\nimport play.data.validation.Constraints.*;\nimport play.data.format.*;\n\n@Entity\npublic class Notification extends Model {\n    @Id\n    public Long id;\n\n    @Required(message = \"\u5fc5\u9808\u9805\u76ee\u3067\u3059\u3002\")\n    public String subject;\n\n    @Required(message = \"\u5fc5\u9808\u9805\u76ee\u3067\u3059\u3002\")\n    @Formats.DateTime(pattern = \"yyyy-MM-dd'T'HH:mm\")\n    public Date actionDate;\n\n    public Integer notificationPeriod;\n\n    public String summary;\n\n    @Formats.DateTime(pattern = \"yyyy-MM-dd'T'HH:mm\")\n    public Date notificationDate;\n\n    public boolean isSent;\n\n    @CreatedTimestamp\n    @Formats.DateTime(pattern = \"yyyy-MM-dd'T'HH:mm\")\n    public Date createdDate;\n\n    @UpdatedTimestamp\n    @Formats.DateTime(pattern = \"yyyy-MM-dd'T'HH:mm\")\n    public Date updatedDate;\n\n    @Override\n    public void save() {\n        notificationDate = calcNotificationDate(actionDate, notificationPeriod);\n        super.save();\n    }\n\n    @Override\n    public void update() {\n        notificationDate = calcNotificationDate(actionDate, notificationPeriod);\n        super.update();\n    }\n\n    private Date calcNotificationDate(Date actionDate, Integer notificationPeriod) {\n        Calendar cl = Calendar.getInstance();\n        cl.setTime(actionDate);\n        cl.add(Calendar.MINUTE, -notificationPeriod);\n        return cl.getTime();\n    }\n}\n\n\nEbean\u306fModel\u30af\u30e9\u30b9\u306b\u5bfe\u3057\u3066\u3001\u76f4\u63a5save()\u3084update()\u3092\u30b3\u30fc\u30eb\u3059\u308b\u3053\u3068\u306b\u3088\u308a\u81ea\u52d5\u7684\u306b\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3078INSERT\u3084UPDATE\u3057\u3066\u304f\u308c\u308b\u512a\u308c\u3082\u306e\u3002\u307e\u305f\u3001@CreatedTimestamp\u306e\u30a2\u30ce\u30c6\u30fc\u30b7\u30e7\u30f3\u306fINSERT\u6642\u306b\u30bf\u30a4\u30e0\u30b9\u30bf\u30f3\u30d7\u3092\u3001@UpdatedTimestamp\u306e\u30a2\u30ce\u30c6\u30fc\u30b7\u30e7\u30f3\u306fUPDATE\u6bce\u306b\u81ea\u52d5\u7684\u306b\u30bf\u30a4\u30e0\u30b9\u30bf\u30f3\u30d7\u3092\u767b\u9332\u3057\u3066\u304f\u308c\u307e\u3059\u3002\nprivate Date calcNotificationDate(Date, Integer)\u306f\u958b\u59cb\u6642\u523b\u3068\u25cb\u5206\u524d\u3067\u6307\u5b9a\u3055\u308c\u305f\u901a\u77e5\u6642\u9593\u304b\u3089\u901a\u77e5\u6642\u523b\u3092\u8a08\u7b97\u3057\u307e\u3059\u3002DAO\u5074\u306b\u5b9f\u88c5\u3059\u308b\u51e6\u7406\u306e\u3088\u3046\u306a\u6c17\u3082\u3057\u307e\u3059\u304c\u3001\u30b9\u30fc\u30d1\u30fc\u30af\u30e9\u30b9\u306ecom.avaje.ebean.Model\u5074\u306bsave()\u3084update()\u304c\u5185\u5305\u3055\u308c\u3066\u3057\u307e\u3063\u3066\u3044\u308b\u306e\u3067\u3001@Override\u3057\u3066\u3053\u3061\u3089\u304b\u3089\u547c\u3073\u51fa\u3059\u3053\u3068\u306b\u3002\n\u5f8c\u3001Ebean\u306e\u5834\u5408\u3001\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u81ea\u4f53\u306fEbean\u5074\u304c\u81ea\u52d5\u7684\u306bSQL\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u751f\u6210\u3057\u3001Play\u5074\u304cconf/evolutions/default/1.sql\u306b\u8a18\u8ff0\u3055\u308c\u305fSQL\u3092\u5b9f\u884c\u3057\u30c6\u30fc\u30d6\u30eb\u3092\u81ea\u52d5\u4f5c\u6210\u3057\u3066\u304f\u308c\u308b\u306e\u3082\u4fbf\u5229\u306a\u3068\u3053\u308d\u3002\n\u7d9a\u3044\u3066CRUD\u51e6\u7406\u3092\u884c\u3046DAO\u3092app/dao/NotificationDAO.java\u306b\u3002\n\napp/dao/NotificationDAO.java\npackage dao;\n\nimport models.Notification;\n\nimport java.util.Calendar;\nimport java.util.Date;\nimport java.util.List;\n\nimport javax.inject.Singleton;\n\nimport com.avaje.ebean.Model.Finder;\n\n@Singleton\npublic class NotificationDAO {\n\n    private static Finder<Long, Notification> find = new Finder<Long, Notification>(Notification.class);\n\n    public void create(Notification notification) {\n        notification.save();\n    }\n\n    public void update(Notification notification) {\n        notification.update();\n    }\n\n    public void delete(Notification notification) {\n        notification.delete();\n    }\n\n    public List<Notification> all() {\n        return find.all();\n    }\n\n    public Notification byId(long id) {\n        return find.byId(id);\n    }\n\n    public List<Notification> getNotificationList() {\n        return find.where().eq(\"isSent\", false).le(\"notificationDate\", new Date()).findList();\n    }\n}\n\n\nEbean\u306e\u5834\u5408\u3001\u66f4\u65b0\u7cfb\u306f\u3042\u3089\u304b\u3058\u3081Notification\u306e\u30b9\u30fc\u30d1\u30fc\u30af\u30e9\u30b9\u3067\u3042\u308bcom.avaje.ebean.Model\u306b\u5b9f\u88c5\u3055\u308c\u3066\u3044\u308bsave()\u3001update()\u3001delete()\u3092\u30b3\u30fc\u30eb\u3059\u308b\u3060\u3051\u3002\u53c2\u7167\u7cfb\u306fcom.avaje.ebean.Model.Finder\u306e\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u4f7f\u3063\u3066\u884c\u3044\u307e\u3059\u3002\nall()\u306f\u3059\u3079\u3066\u53d6\u5f97\u3001byId(long)\u306f\u30d7\u30e9\u30a4\u30de\u30ea\u30ad\u30fc\u306eID\u3067\u53d6\u5f97\u3001getNotificationList()\u306f\u691c\u7d22\u3057\u3066\u53d6\u5f97\u3057\u3066\u3044\u307e\u3059\u3002\n\u672c\u30a2\u30d7\u30ea\u306f\u901a\u77e5\u6642\u523b\u306b\u30e1\u30fc\u30eb\u9001\u4fe1\u3092\u884c\u3046\u305f\u3081\u3001\u300c\u30e1\u30fc\u30eb\u9001\u4fe1\u3057\u3066\u3044\u306a\u3044\u300d\u4e14\u3064\u300c\u901a\u77e5\u6642\u523b\uff1c\uff1d\u73fe\u5728\u6642\u523b\u300d\u3068\u3044\u3046\u6761\u4ef6\u306egetNotificationList()\u3092\u5b9a\u7fa9\u3057\u3066\u3044\u307e\u3059\u3002\n\nModel\u3068DAO\u306e\u4f5c\u6210\uff08Scala\u7de8\uff09\n\u6b21\u306bScala\u3067\u306eModel\u3068DAO\u306e\u4f5c\u6210\u3092\u898b\u3066\u307f\u307e\u3059\u3002\nScala\u3067\u306f\u300cSlick\u300d\u3068\u3044\u3046ORMFRM\u3092\u4f7f\u3044\u307e\u3059\u3002Slick\u306f\u300cScala Language-Integrated Connection Kit\u300d\u306e\u7565\u3067Play\u3068\u540c\u3058Typesafe\u793e\u304c\u63d0\u4f9b\u3057\u3066\u3044\u308bORM\u306a\u3089\u306cFRM\u300cFunctional Relational Mapping\u300d\u3060\u305d\u3046\u3067\u3059\u3002\uff08\u4fee\u6b63\uff1a2015/10/30\uff09\nSlick\u3092\u4f7f\u7528\u3059\u308b\u305f\u3081\u3001Play2.4\u306e\u30aa\u30d5\u30a3\u30b7\u30e3\u30eb\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u3092\u53c2\u8003\u306b\u4e0b\u8a18\u306e2\u70b9\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n\uff11\uff0ebuild.sbt\u306b\u4e0b\u8a18\u3092\u8ffd\u8a18\n\nbuild.sbt\nlibraryDependencies += \"com.typesafe.play\" %% \"play-slick\" % \"1.0.1\"\nlibraryDependencies += \"com.typesafe.play\" %% \"play-slick-evolutions\" % \"1.0.1\"\nlibraryDependencies += \"com.h2database\" % \"h2\" % \"1.3.176\"\n\n\n\u203bbuild.sbt\u304b\u3089\u300cjdbc\u300d\u306e\u4f9d\u5b58\u306e\u8a18\u8ff0\u3092\u30b3\u30e1\u30f3\u30c8\u30a2\u30a6\u30c8\uff08\u8d77\u52d5\u6642\u306bbinding\u306e\u30a8\u30e9\u30fc\u304c\u51fa\u308b\u305f\u3081\uff09\n\uff12\uff0econf/application.conf\u306b\u4e0b\u8a18\u3092\u8ffd\u8a18\n\nconf/application.conf\nslick.dbs.default.driver=\"slick.driver.H2Driver$\"\nslick.dbs.default.db.driver=\"org.h2.Driver\"\nslick.dbs.default.db.url=\"jdbc:h2:mem:play\"\n\n\n\u3053\u3061\u3089\u3082\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306fH2\u306e\u30e1\u30e2\u30ea\u30b9\u30c8\u30ec\u30fc\u30b8\u3067\u884c\u3044\u307e\u3059\u3002\n\u305d\u3057\u3066\u3001app/models/Notification.scala\u306b\u4e0b\u8a18\u306e\u5b9f\u88c5\u3092\u3002\n\napp/models/Notification.scala\npackage models\n\nimport java.util.Date\n\ncase class Notification (\n    id: Option[Long],\n    subject: String,\n    actionDate: Date,\n    notificationPeriod: Int,\n    summary: String,\n    notificationDate: Date,\n    isSent: Boolean,\n    createdDate: Date,\n    updatedDate: Date\n)\n\n\nScala\u306fCase\u30af\u30e9\u30b9\u3092\u4f7f\u7528\u3059\u308b\u305f\u3081\u3001Model\u306e\u5b9a\u7fa9\u81ea\u4f53\u306f\u7c21\u5358\u3067\u3059\u3002\n\u305f\u3060\u3001Slick\u306e\u5834\u5408\u3001Ebean\u3068\u9055\u3063\u3066SQL\u30b9\u30af\u30ea\u30d7\u30c8\u306e\u81ea\u52d5\u751f\u6210\u306f\u884c\u3063\u3066\u304f\u308c\u307e\u305b\u3093\u306e\u3067\u3001conf/evolutions/default/1.sql\u306f\u81ea\u5206\u3067\u7528\u610f\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\n\nconf/evolutions/default/1.sql\n# Notification\n\n# --- !Ups\n\nCREATE TABLE \"notification\" (\n    \"id\" bigint(20) NOT NULL AUTO_INCREMENT,\n    \"subject\" varchar(255),\n    \"action_date\" timestamp,\n    \"notification_period\" integer,\n    \"summary\" varchar(255),\n    \"notification_date\" timestamp,\n    \"is_sent\" boolean,\n    \"created_date\" timestamp,\n    \"updated_date\" timestamp,\n    PRIMARY KEY (\"id\")\n);\n\n# --- !Downs\n\nDROP TABLE \"notification\";\n\n\n\u7d9a\u3044\u3066CRUD\u51e6\u7406\u3092\u884c\u3046DAO\u3092app/dao/NotificationDAO.scala\u306b\u3002\n\napp/dao/NotificationDAO.scala\npackage dao\n\nimport scala.concurrent.Future\nimport java.util.Date\nimport java.util.Calendar\nimport java.sql.Timestamp\nimport javax.inject.Inject\nimport javax.inject.Singleton\nimport models.Notification\nimport play.api.db.slick.DatabaseConfigProvider\nimport play.api.libs.concurrent.Execution.Implicits.defaultContext\nimport slick.driver.JdbcProfile\n\n@Singleton\nclass NotificationDAO @Inject()(val dbConfigProvider: DatabaseConfigProvider) {\n\n  val dbConfig = dbConfigProvider.get[JdbcProfile]\n\n  import dbConfig.driver.api._\n\n  implicit def javaDateMapper = MappedColumnType.base[Date, Timestamp](\n      dt => new Timestamp(dt.getTime),\n      ts => new Date(ts.getTime)\n  )\n\n  private class NotificationTable(tag: Tag) extends Table[Notification](tag, \"notification\") {\n\n    def id = column[Long](\"id\", O.PrimaryKey, O.AutoInc)\n    def subject = column[String](\"subject\")\n    def actionDate = column[Date](\"action_date\")\n    def notificationPeriod = column[Int](\"notification_period\")\n    def summary = column[String](\"summary\")\n    def notificationDate = column[Date](\"notification_date\")\n    def isSent = column[Boolean](\"is_sent\", O.Default(false))\n    def createdDate = column[Date](\"created_date\")\n    def updatedDate = column[Date](\"updated_date\")\n\n    def * = (id.?, subject, actionDate, notificationPeriod, summary, notificationDate, isSent, createdDate, updatedDate) <> ((Notification.apply _).tupled, Notification.unapply)\n  }\n\n  private val notifications = TableQuery[NotificationTable]\n\n  def all(): Future[List[Notification]] = dbConfig.db.run(notifications.result).map(_.toList)\n\n  def byId(id: Long): Future[Option[Notification]] = dbConfig.db.run(notifications.filter(_.id === id).result.headOption)\n\n  def getNotificationList(): Future[List[Notification]] =\n    dbConfig.db.run(notifications.filter(n => (n.isSent === false) && (n.notificationDate < new Date)).result).map(_.toList)\n\n  def create(notification: Notification): Future[Int] = {\n    val n = notification.copy(\n        notificationDate = calcNotificationDate(notification.actionDate, notification.notificationPeriod),\n        isSent = false,\n        createdDate = new Date,\n        updatedDate = new Date\n    )\n    dbConfig.db.run(notifications += n)\n  }\n\n  def update(notification: Notification): Future[Int] = {\n    dbConfig.db.run(notifications.filter(_.id === notification.id).map(\n        n => (\n            n.subject,\n            n.actionDate,\n            n.notificationPeriod,\n            n.summary,\n            n.notificationDate,\n            n.updatedDate\n            )\n      ).update(\n        notification.subject,\n        notification.actionDate,\n        notification.notificationPeriod,\n        notification.summary,\n        calcNotificationDate(notification.actionDate, notification.notificationPeriod),\n        new Date\n      )\n    )\n  }\n\n  def sent(id: Long): Future[Int] = {\n    dbConfig.db.run(notifications.filter(_.id === id).map(\n        n => (n.isSent, n.updatedDate)\n      ).update(\n        true, new Date\n      )\n    )\n  }\n\n  def delete(id: Long): Future[Int] = dbConfig.db.run(notifications.filter(_.id === id).delete)\n\n  private def calcNotificationDate(actionDate: Date, notificationPeriod: Int): Date = {\n    val cl = Calendar.getInstance\n    cl.setTime(actionDate)\n    cl.add(Calendar.MINUTE, -notificationPeriod)\n    cl.getTime\n  }\n\n}\n\n\n\u3053\u3061\u3089\u306fEbean\u3068\u7570\u306a\u308a\u3001\u304b\u306a\u308a\u306e\u30dc\u30ea\u30e5\u30fc\u30e0\u306b\u3002\u3002\u3002\n\u6982\u8981\u3068\u3057\u3066\u306f\u3001\n\nModel\u3067\u3042\u308bNotification\u3092\u578b\u306b\u6301\u3063\u305fTable\u3092\u30b9\u30fc\u30d1\u30fc\u30af\u30e9\u30b9\u306b\u3057\u3066NotificationTable\u3092\u4f5c\u6210\u3002\n\u305d\u308c\u3092\u5143\u306bJava\u5074\u306eFinder\u306b\u76f8\u5f53\u3059\u308bTableQuery\u3092\u4f5c\u6210\u3002\nSlick\u304cjava.util.Date\u306b\u5bfe\u5fdc\u3057\u3066\u3044\u306a\u305f\u3081\u3001\u5bfe\u5fdc\u3057\u3066\u3044\u308bjava.sql.Timestamp\u3068\u306e\u76f8\u4e92\u5909\u63db\u306e\u305f\u3081\u306eimplicit def javaDateMapper\u3092\u4f5c\u6210\u3002\n\u5f8c\u306fCRUD\u306e\u5b9f\u88c5\n\n\u3068\u3044\u3063\u305f\u6d41\u308c\u306b\u306a\u308a\u307e\u3059\u3002\nEbean\u3068\u306e\u30d0\u30e9\u30f3\u30b9\u3092\u3068\u308b\u305f\u3081\u306b\u306f\u3001NotificationTable\u3092Model\u5074\u306b\u5b9f\u88c5\u3059\u308b\u3068\u3044\u3044\u306e\u3067\u3057\u3087\u3046\u304c\u3001Slick3.0\u3068\u30a4\u30f3\u30b8\u30a7\u30af\u30b7\u30e7\u30f3\u306e\u7d61\u307f\u3067\u306a\u3093\u3060\u304b\u5c11\u3057\u96e3\u3057\u305d\u3046\u3002\u3002\nSlick3.0\u306f\u7d50\u679c\u3092Future\u3067\u8fd4\u3059\u3068\u3053\u308d\u304c\u5c11\u3057\u308f\u304b\u308a\u3065\u3089\u3044\u3067\u3059\u306d\u3002\nSlick\u3067\u306f\u3001FRM\u306e\u601d\u60f3\u3068\u3057\u3066\u3001TableQuery\u3092Scala\u306e\u30b3\u30ec\u30af\u30b7\u30e7\u30f3\u611f\u899a\u3067\u64cd\u4f5c\u3059\u308b\u3053\u3068\u306b\u306a\u308b\u305f\u3081\u3001query\u3068\u3044\u3063\u305f\u5909\u6570\u540d\u3067\u306f\u306a\u304fnotifications\u306e\u3088\u3046\u306b\u30ea\u30b9\u30c8\u3063\u307d\u3044\u5909\u6570\u540d\u306b\u3059\u308b\u3053\u3068\u304c\u30dd\u30a4\u30f3\u30c8\u306e\u3088\u3046\u3067\u3059\u3002\uff08\u8ffd\u8a18\uff1a2015\u5e7410\u670830\u65e5\uff09\n\nModel\u3068DAO\u306b\u3064\u3044\u3066\u306eJava\u3068Scala\u306e\u6bd4\u8f03\nORM\u3068FRM\u3067\u305d\u308c\u305e\u308c\u7570\u306a\u308b\u305f\u3081\u3001Java\u3068Scala\u306e\u8a00\u8a9e\u7684\u306a\u6bd4\u8f03\u3068\u3044\u3046\u3088\u308a\u306f\u3001Ebean\u3068Slick\u306e\u6bd4\u8f03\u306b\u306a\u3063\u3066\u3057\u307e\u3044\u307e\u3059\u304c\u3001\u5b9f\u611f\u3068\u3057\u3066\u306f\u5727\u5012\u7684\u306bEbean\u304c\u7c21\u5358\u3067\u3057\u305f\u3002Slick\u306f\u30c7\u30fc\u30bf\u306e\u30de\u30c3\u30d4\u30f3\u30b0\u90e8\u5206\u304c\u3084\u3084\u3053\u3057\u304f\u3001Ebean\u306f\u305d\u306e\u70b9\u3001\u81ea\u52d5\u3067\u3084\u3063\u3066\u304f\u308c\u307e\u3059\u306e\u3067\u3002\nPlay\u3082Akka\u3082Java\u3068Scala\u306b\u5bfe\u5fdc\u3057\u3066\u3044\u308b\u306e\u3060\u304b\u3089\u3001ORM\u306b\u3064\u3044\u3066\u3082\u4f55\u304b\u5171\u901a\u3057\u305f\u3082\u306e\u304c\u3042\u308c\u3070\u3044\u3044\u306e\u3067\u3059\u304c\u3002\u3067\u304d\u308c\u3070Ebean\u3088\u308a\u3067\u3002\uff08\u524a\u9664\uff1a2015\u5e7410\u670830\u65e5\uff09\n\u4ee5\u524d\u306fScala\u5b9f\u88c5\u306eEbean\u3082\u3042\u3063\u305f\u3088\u3046\u3067\u3059\u304c\u3001Play\u3068\u540c\u3058Typesafe\u793e\u304cScala\u306e\u95a2\u6570\u578b\u8a00\u8a9e\u306e\u5074\u9762\u3092\u62bc\u3057\u51fa\u3057Slick\u3068\u3044\u3046FRM\u3092\u63a1\u7528\u3057\u3066\u3044\u308b\u3053\u3068\u304b\u3089\u3001Java\u3067\u306fORM\u3001Scala\u3067\u306fFRM\u3068\u3044\u3046\u9078\u629e\u306b\u306a\u308b\u306e\u3060\u3068\u601d\u3044\u307e\u3059\u3002\uff08\u8ffd\u8a18\uff1a2015\u5e7410\u670830\u65e5\uff09\n\nAkka\u306b\u3088\u308b\u30b9\u30b1\u30b8\u30e5\u30fc\u30ea\u30f3\u30b0\uff08Java\u7de8\uff09\nController\u90e8\u5206\u306b\u884c\u304f\u524d\u306b\u3001\u5148\u306bAkka\u306b\u3088\u308b\u30b9\u30b1\u30b8\u30e5\u30fc\u30ea\u30f3\u30b0\u6a5f\u80fd\u3092\u5b9f\u88c5\u3057\u307e\u3059\u3002\n\u672c\u30a2\u30d7\u30ea\u3067\u306f\u30011\u5206\u6bce\u306b\u30b5\u30fc\u30d0\u304c\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306b\u767b\u9332\u3055\u308c\u3066\u3044\u308b\u901a\u77e5\u30b9\u30b1\u30b8\u30e5\u30fc\u30eb\u3092\u30c1\u30a7\u30c3\u30af\u3057\u3001\u8a72\u5f53\u3059\u308b\u3082\u306e\u304c\u3042\u308c\u3070\u30e1\u30fc\u30eb\u9001\u4fe1\u3092\u884c\u3044\u307e\u3059\u3002\n\u5f53\u521d\u3053\u306e\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u30a4\u30e1\u30fc\u30b8\u3057\u305f\u3068\u304d\u306f\u3001\u30b5\u30fc\u30d0\u5074\u306eCRON\u3092\u5229\u7528\u3057\u3066\u3001\u30c1\u30a7\u30c3\u30af\u7528\u306e\u5225\u30a2\u30d7\u30ea\u304bURL\u3092\u53e9\u304f\u3088\u3046\u306a\u65b9\u5f0f\u3092\u8003\u3048\u3066\u3044\u307e\u3057\u305f\u304c\u3001Play\u81ea\u4f53\u306b\u7d44\u307f\u8fbc\u307e\u308c\u3066\u3044\u308bTypesafe\u793e\u306eAkka\u3067\u540c\u69d8\u306e\u6a5f\u80fd\u304c\u5b9f\u73fe\u3067\u304d\u308b\u3068\u77e5\u308a\u3001\u5f53\u7136\u305d\u3061\u3089\u306e\u65b9\u5f0f\u3067\u3002\nAkka\u306fActor\u30e2\u30c7\u30eb\u3092\u5b9f\u88c5\u3057\u305f\u4e26\u884c\u51e6\u7406\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306e\u305f\u3081\u306e\u30e2\u30b8\u30e5\u30fc\u30eb\u306b\u306a\u308a\u307e\u3059\u3002\u4eca\u56de\u306f\u3001Actor\u306b1\u5206\u6bce\u306b\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u9001\u308a\u3001Actor\u304c\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3092\u30c1\u30a7\u30c3\u30af\u3057\u3001\u30e1\u30fc\u30eb\u306e\u9001\u4fe1\u3001\u9001\u4fe1\u30d5\u30e9\u30b0\u306e\u66f4\u65b0\u3092\u884c\u3046\u3053\u3068\u306b\u306a\u308a\u307e\u3059\u3002\n\u30e1\u30fc\u30eb\u9001\u4fe1\u306fPlay\u306e\u30d7\u30e9\u30b0\u30a4\u30f3\u3067\u63d0\u4f9b\u3055\u308c\u3066\u3044\u308bplay-mailer\u3092\u4f7f\u7528\u3059\u308b\u306e\u3067\u4e0b\u8a18\u8a2d\u5b9a\u3092\u8ffd\u52a0\u3057\u307e\u3059\u3002\n\uff11\uff0ebuild.sbt\u306b\u4e0b\u8a18\u3092\u8ffd\u8a18\n\nbuild.sbt\nlibraryDependencies += \"com.typesafe.play\" %% \"play-mailer\" % \"3.0.1\"\n\n\n\uff12\uff0econf/application.conf\u306b\u4e0b\u8a18\u3092\u8ffd\u8a18\n\nconf/application.conf\nplay.mailer {\n    host=\u30e1\u30fc\u30eb\u30b5\u30fc\u30d0\u306e\u30db\u30b9\u30c8\u540d\n    port=\u30dd\u30fc\u30c8\u756a\u53f7\n}\nnotify.mail {\n    from = \"\u9001\u4fe1\u8005\u540d <\u9001\u4fe1\u5143\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9>\"\n    to = \"\u9001\u4fe1\u5148\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\"\n}\n\n\n\u3067\u3001app/actors/NotifyActor.java\u306b\u4e0b\u8a18\u306e\u5b9f\u88c5\u3092\u3002\n\napp/actors/NotifyActor.java\npackage actors;\n\nimport models.Notification;\nimport dao.NotificationDAO;\n\nimport java.util.List;\nimport java.util.Date;\n\nimport play.libs.mailer.MailerClient;\nimport play.libs.mailer.Email;\nimport akka.actor.UntypedActor;\nimport akka.actor.Props;\nimport akka.japi.Creator;\nimport play.Logger;\n\nimport com.typesafe.config.Config;\nimport com.typesafe.config.ConfigFactory;\n\npublic class NotifyActor extends UntypedActor {\n\n    public static Props props(final NotificationDAO dao, final MailerClient mc) {\n        return Props.create(new Creator<NotifyActor>() {\n            private static final long serialVersionUID = 1L;\n            @Override\n            public NotifyActor create() throws Exception {\n                return new NotifyActor(dao, mc);\n            }\n        });\n    }\n\n    private final NotificationDAO dao;\n    private final MailerClient mc;\n    private final String mailFrom;\n    private final String mailTo;\n\n    public NotifyActor(NotificationDAO dao, MailerClient mc) {\n        this.dao = dao;\n        this.mc = mc;\n        Config config = ConfigFactory.load();\n        mailFrom = config.getString(\"notify.mail.from\");\n        mailTo = config.getString(\"notify.mail.to\");\n    }\n\n    @Override\n    public void onReceive(Object message) throws Exception {\n        if (message.equals(\"NOTIFY\")) {\n            Logger.info((new Date()).toString());\n            Logger.info(\"Message(NOTIFY) received\");\n            List<Notification> notifications = dao.getNotificationList();\n            Logger.info(\"notifications.size() -> \" + notifications.size());\n            for (Notification notification : notifications) {\n                Logger.info(\"notification.id() -> \" + notification.id);\n                Email email = new Email();\n                email.setSubject(notification.subject);\n                email.setFrom(mailFrom);\n                email.addTo(mailTo);\n                email.setBodyText(notification.actionDate + \"\\n\" + notification.summary);\n                mc.send(email);\n                Logger.info(\"Mail sent\");\n                notification.isSent = true;\n                dao.update(notification);\n                Logger.info(\"Model(notification) updated\");\n            }\n        }\n    }\n\n}\n\n\n\u30b3\u30f3\u30b9\u30c8\u30e9\u30af\u30bf\u3067\u306f\u3001DAO\u3068\u30e1\u30fc\u30eb\u9001\u4fe1\u306e\u305f\u3081\u306e\u30e2\u30b8\u30e5\u30fc\u30eb\u3067\u3042\u308bMailerClient\u3092\u53d7\u3051\u53d6\u308a\u3001Play\u306e\u30b3\u30f3\u30d5\u30a3\u30b0\u30ec\u30fc\u30b7\u30e7\u30f3\u30d5\u30a1\u30a4\u30eb\u304b\u3089\u3001\u9001\u4fe1\u5143\u3068\u9001\u4fe1\u5148\u306e\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u3092\u8aad\u307f\u8fbc\u307f\u307e\u3059\u3002\n@Override\u3055\u308c\u305fpublic void onReceive(Object)\u3067\u5b9f\u969b\u306b\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u53d7\u4fe1\u3057\u305f\u969b\u306e\u51e6\u7406\u3092\u8a18\u8ff0\u3057\u307e\u3059\u3002\u51e6\u7406\u306e\u6d41\u308c\u3068\u3057\u3066\u306f\u3001\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306e\u30c1\u30a7\u30c3\u30af\u3001\u30e1\u30fc\u30eb\u9001\u4fe1\u3001\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306e\u66f4\u65b0\u3068\u306a\u308a\u307e\u3059\u3002\nActor\u306f\u5b9f\u969b\u306b\u5229\u7528\u3059\u308b\u969b\u306fActorRef\u3068\u3044\u3046\u53c2\u7167\u306b\u5bfe\u3057\u3066\u30b9\u30b1\u30b8\u30e5\u30fc\u30eb\u306e\u958b\u59cb\u3092\u6307\u793a\u3057\u307e\u3059\u306e\u3067\u3001\u30b3\u30f3\u30b9\u30c8\u30e9\u30af\u30bf\u306b\u5f15\u6570\u3092\u6301\u305f\u305b\u308b\u305f\u3081\u3001public static Props props(NotificationDAO, MailerClient)\u3092\u5b9f\u88c5\u3057\u3066\u3044\u307e\u3059\u3002\n\nAkka\u306b\u3088\u308b\u30b9\u30b1\u30b8\u30e5\u30fc\u30ea\u30f3\u30b0\uff08Scala\u7de8\uff09\n\u3053\u3061\u3089\u3082\u30e1\u30fc\u30eb\u9001\u4fe1\u306fPlay\u306e\u30d7\u30e9\u30b0\u30a4\u30f3\u3067\u63d0\u4f9b\u3055\u308c\u3066\u3044\u308bplay-mailer\u3092\u4f7f\u7528\u3059\u308b\u306e\u3067\u4e0b\u8a18\u8a2d\u5b9a\u3092\u8ffd\u52a0\u3057\u307e\u3059\u3002\n\uff11\uff0ebuild.sbt\u306b\u4e0b\u8a18\u3092\u8ffd\u8a18\n\nbuild.sbt\nlibraryDependencies += \"com.typesafe.play\" %% \"play-mailer\" % \"3.0.1\"\n\n\n\uff12\uff0econf/application.conf\u306b\u4e0b\u8a18\u3092\u8ffd\u8a18\n\nconf/application.conf\nplay.mailer {\n    host=\u30e1\u30fc\u30eb\u30b5\u30fc\u30d0\u306e\u30db\u30b9\u30c8\u540d\n    port=\u30dd\u30fc\u30c8\u756a\u53f7\n}\nnotify.mail {\n    from = \"\u9001\u4fe1\u8005\u540d <\u9001\u4fe1\u5143\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9>\"\n    to = \"\u9001\u4fe1\u5148\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\"\n}\n\n\nActor\u3092Scala\u3067\u5b9f\u88c5\u3059\u308b\u3068\u3001\u4e0b\u8a18app/actors/NotifyActor.scala\u306e\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\n\napp/actors/NotifyActor.scala\npackage actors\n\nimport dao.NotificationDAO\nimport akka.actor._\nimport javax.inject.Inject\nimport play.api.libs.concurrent.Execution.Implicits.defaultContext\nimport play.api.libs.mailer.{MailerClient, Email}\nimport com.typesafe.config.ConfigFactory\n\nimport play.Logger\n\nobject NotifyActor {\n  def props(dao: NotificationDAO, mc: MailerClient) = Props(classOf[NotifyActor], dao, mc)\n}\n\nclass NotifyActor(dao: NotificationDAO, mc: MailerClient) extends Actor {\n\n  val config = ConfigFactory.load()\n  val mailFrom = config.getString(\"notify.mail.from\")\n  val mailTo = config.getString(\"notify.mail.to\")\n\n  def receive = {\n    case \"NOTIFY\" =>\n      Logger.info((new java.util.Date).toString)\n      Logger.info(\"Message(NOTIFY) received\")\n      dao.getNotificationList().map { notifications =>\n        Logger.info(\"notifications.size -> \" + notifications.size)\n        for (notification <- notifications) {\n          Logger.info(\"notification.id -> \" + notification.id)\n          val email = Email(\n            notification.subject,\n            mailFrom,\n            Seq(mailTo),\n            bodyText = Some(notification.actionDate + \"\\n\" + notification.summary),\n            bodyHtml = Some(\"\")\n          )\n          mc.send(email)\n          Logger.info(\"Mail sent\")\n          dao.sent(notification.id.getOrElse(0))\n          Logger.info(\"Model(notification) updated\")\n        }\n      }\n  }\n}\n\n\n\u3084\u3063\u3066\u3044\u308b\u3053\u3068\u306f\u307b\u307c\u540c\u3058\u3067\u3059\u304c\u3001\u8a18\u6cd5\u306e\u5dee\u3067\u3001\u304b\u306a\u308a\u30b3\u30f3\u30d1\u30af\u30c8\u306b\u4ed5\u4e0a\u304c\u3063\u3066\u3044\u307e\u3059\u3002\u30af\u30e9\u30b9\u5b9a\u7fa9\u306b\u30b3\u30f3\u30b9\u30c8\u30e9\u30af\u30bf\u30e1\u30bd\u30c3\u30c9\u304c\u8a18\u8ff0\u3067\u304d\u3001\u521d\u671f\u51e6\u7406\u3092\u30e1\u30f3\u30d0\u5b9a\u7fa9\u306e\u3068\u3053\u308d\u306b\u8a18\u8ff0\u3067\u304d\u308b\u306e\u304c\u5927\u304d\u3044\u306e\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u3002\n\nAkka\u306b\u3064\u3044\u3066\u306eJava\u3068Scala\u306e\u6bd4\u8f03\n\u3053\u3061\u3089\u306f\u305d\u308c\u307b\u3069\u9055\u3044\u304c\u306a\u3044\u3088\u3046\u3067\u3059\u304c\u3001\u3084\u306f\u308aScala\u306e\u65b9\u304c\u30b3\u30f3\u30d1\u30af\u30c8\u306b\u8a18\u8ff0\u3067\u304d\u308b\u6c17\u304c\u3002\u5f37\u529b\u306a\u578b\u63a8\u8ad6\u306e\u304a\u304b\u3052\u3067\u3001Java\u306e\u3088\u3046\u306b\u5168\u3066\u3092\u8a18\u8ff0\u3059\u308b\u5fc5\u8981\u304c\u306a\u3044\u3067\u3059\u3057\u3002\n\nController\u306e\u4f5c\u6210\uff08Java\u7de8\uff09\n\u6b21\u306bController\u90e8\u5206\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\u307e\u305a\u306fJava\u304b\u3089\u3002\napp/controllers/Application.java\u306b\u4e0b\u8a18\u306e\u5b9f\u88c5\u3092\u3002\n\napp/controllers/Application.java\npackage controllers;\n\nimport dao.NotificationDAO;\nimport models.Notification;\nimport actors.NotifyActor;\n\nimport java.util.Calendar;\nimport java.util.List;\nimport java.util.concurrent.TimeUnit;\n\nimport javax.inject.Inject;\nimport javax.inject.Singleton;\n\nimport akka.actor.ActorRef;\nimport akka.actor.ActorSystem;\n\nimport scala.concurrent.duration.Duration;\n\nimport play.libs.mailer.MailerClient;\nimport play.mvc.Controller;\nimport play.mvc.Result;\nimport play.data.Form;\nimport play.libs.Json;\nimport views.html.*;\nimport play.Logger;\n\n@Singleton\npublic class Application extends Controller {\n\n    @Inject NotificationDAO dao;\n    @Inject MailerClient mc;\n    private boolean isInit = false;\n\n    synchronized public Result init() {\n        if (!isInit) {\n            Logger.info(\"IN init()\");\n            Logger.info(\"start Actaor\");\n            ActorSystem system = ActorSystem.create(\"myActor\");\n            ActorRef notifyActor = system.actorOf(NotifyActor.props(dao, mc));\n            Calendar cl = Calendar.getInstance();\n            cl.set(Calendar.SECOND, 0);\n            cl.set(Calendar.MILLISECOND, 0);\n            cl.add(Calendar.MINUTE, 1);\n            system.scheduler().schedule(\n                Duration.create(cl.getTimeInMillis() - System.currentTimeMillis(), TimeUnit.MILLISECONDS),\n                Duration.create(1, TimeUnit.MINUTES),\n                notifyActor,\n                \"NOTIFY\",\n                system.dispatcher(),\n                null\n            );\n            Logger.info(\"Actor has started\");\n            Logger.info(\"OUT init()\");\n            isInit = true;\n        }\n        return ok(index.render(\"\"));\n    }\n\n    public Result index() {\n        return ok(index.render(\"\"));\n    }\n\n    public Result add() {\n        Form<Notification> form = Form.form(Notification.class);\n        return ok(register.render(\"\", form));\n    }\n\n    public Result create() {\n        Form<Notification> form = Form.form(Notification.class).bindFromRequest();\n        if (!form.hasErrors()) {\n            Notification notification = form.get();\n            dao.create(notification);\n            return ok(index.render(\"\u767b\u9332\u3057\u307e\u3057\u305f\"));\n        } else {\n            return badRequest(register.render(\"ERROR\", form));\n        }\n    }\n\n    public Result getNotifications() {\n        List<Notification> notifications = dao.all();\n        return ok(list.render(\"\", notifications));\n    }\n\n    public Result read(Long id) {\n        Notification notification = dao.byId(id);\n        if (notification != null) {\n            Form form = Form.form(Notification.class).fill(notification);\n            return ok(edit.render(\"\", form));\n        } else {\n            List<Notification> notifications = dao.all();\n            return badRequest(list.render(\"ERROR\", notifications));\n        }\n    }\n\n    public Result update() {\n        Form<Notification> form = Form.form(Notification.class).bindFromRequest();\n        if (!form.hasErrors()) {\n            Notification notification = form.get();\n            dao.update(notification);\n            List<Notification> notifications = dao.all();\n            return ok(list.render(\"\u66f4\u65b0\u3057\u307e\u3057\u305f\", notifications));\n        } else {\n            return badRequest(edit.render(\"ERROR\", form));\n        }\n    }\n\n    public Result delete(Long id) {\n        Notification notification = dao.byId(id);\n        if (notification != null) {\n            dao.delete(notification);\n            List<Notification> notifications = dao.all();\n            return ok(list.render(\"\u524a\u9664\u3057\u307e\u3057\u305f\", notifications));\n        } else {\n            List<Notification> notifications = dao.all();\n            return badRequest(list.render(\"ERROR\", notifications));\n        }\n    }\n}\n\n\n\u3084\u3063\u3066\u3044\u308b\u3053\u3068\u306f\u5404\u753b\u9762\u9077\u79fb\u3068DAO\u3092\u4ecb\u3057\u305fCRUD\u51e6\u7406\u3067\u3059\u3002\u521d\u671f\u51e6\u7406\u3068\u3057\u3066\u5148\u307b\u3069\u5b9f\u88c5\u3057\u305fActor\u30921\u5206\u5358\u4f4d\u3067\u8d77\u52d5\u3057\u3066\u3044\u307e\u3059\u3002\nPlay2.3\u307e\u3067\u306f\u521d\u671f\u51e6\u7406\u3092GlobalSettings\u3092\u7d99\u627f\u3057\u305f\u30af\u30e9\u30b9\u3067\u884c\u3063\u3066\u3044\u305f\u306e\u3067\u3059\u304c\u3001Play2.4\u304b\u3089\u306f\u63a8\u5968\u3055\u308c\u3066\u304a\u3089\u305a\u3001\u4ee3\u66ff\u624b\u6bb5\u3082\u308f\u304b\u3089\u306a\u304b\u3063\u305f\u305f\u3081\u3001init()\u3092\u5916\u90e8\u304b\u3089\u53e9\u304f\u3088\u3046\u306a\u5c11\u3057\u82e6\u3057\u3044\u5b9f\u88c5\u306b\u306a\u3063\u3066\u3044\u307e\u3059\u3002\n\u305d\u308c\u305e\u308c\u306e\u30e1\u30bd\u30c3\u30c9\u306e\u6982\u8981\u306f\u4e0b\u8a18\u306e\u901a\u308a\u3068\u306a\u308a\u307e\u3059\u3002\n\n\nindex()\u3000\u30c8\u30c3\u30d7\u30da\u30fc\u30b8\uff08\u30e1\u30cb\u30e5\u30fc\u30da\u30fc\u30b8\uff09\u306e\u8868\u793a\n\nadd()\u3000\u767b\u9332\u753b\u9762\u306e\u8868\u793a\n\ncreate()\u3000\u767b\u9332\u753b\u9762\u304b\u3089\u306e\u5165\u529b\u5185\u5bb9\u3092\u53d7\u3051\u767b\u9332\u51e6\u7406\n\ngetNotifications()\u3000\u4e00\u89a7\u753b\u9762\u306e\u8868\u793a\n\nread(Long)\u3000\u7de8\u96c6\u753b\u9762\u306e\u8868\u793a\n\nupdate()\u3000\u7de8\u96c6\u753b\u9762\u304b\u3089\u306e\u5165\u529b\u5185\u5bb9\u3092\u53d7\u3051\u66f4\u65b0\u51e6\u7406\n\ndelete(Long)\u3000\u524a\u9664\u51e6\u7406\n\nbindFromRequest()\u306f\u30d5\u30a9\u30fc\u30e0\u306e\u5165\u529b\u5185\u5bb9\u3092Model\u306b\u30de\u30c3\u30d4\u30f3\u30b0\u3057\u3066\u304f\u308c\u308b\u51e6\u7406\u3067\u3001Ebean\u306e\u5834\u5408\u3001\u7279\u306b\u4f55\u3082\u8003\u3048\u306a\u304f\u3066\u3082\u3001\u305d\u308c\u306a\u308a\u306b\u9069\u5207\u306b\u30de\u30c3\u30d4\u30f3\u30b0\u3057\u3066\u304f\u308c\u308b\u3088\u3046\u3067\u3059\u3002\n\nController\u306e\u4f5c\u6210\uff08Scala\u7de8\uff09\n\u7d9a\u3044\u3066Scala\u306eController\u306e\u4f5c\u6210\u3067\u3059\u3002\napp/controllers/Application.scala\u306b\u4e0b\u8a18\u306e\u5b9f\u88c5\u3092\u3002\n\napp/controllers/Application.scala\npackage controllers\n\nimport scala.concurrent.Future\n\nimport dao.NotificationDAO\nimport actors.NotifyActor\nimport models.Notification\n\nimport java.util.concurrent.TimeUnit\nimport java.util.Calendar\nimport java.util.Date\n\nimport javax.inject.Inject\nimport javax.inject.Singleton\n\nimport akka.actor._\nimport scala.concurrent.duration._\nimport scala.concurrent.ExecutionContext.Implicits.global\n\nimport play.api.data.Form\nimport play.api.data.Forms.mapping\nimport play.api.data.Forms.{longNumber,text,date,number,nonEmptyText,optional}\nimport play.api.libs.concurrent.Execution.Implicits.defaultContext\nimport play.api.mvc.Action\nimport play.api.mvc.Controller\n\nimport play.api.libs.mailer._\n\nimport play.api.i18n.MessagesApi\nimport play.api.i18n.I18nSupport\n\nimport play.api.libs.json.Json\n\nimport play.Logger;\n\n@Singleton\nclass Application @Inject() (val messagesApi: MessagesApi, dao: NotificationDAO, system: ActorSystem, mc: MailerClient) extends Controller with I18nSupport {\n\n  val notificationForm = Form(\n    mapping(\n      \"id\" -> optional(longNumber),\n      \"subject\" -> nonEmptyText,\n      \"actionDate\" -> date(\"yyyy-MM-dd'T'HH:mm\"),\n      \"notificationPeriod\" -> number,\n      \"summary\" -> text\n    )(formapply)(formunapply)\n  )\n  private def formapply(id: Option[Long], subject: String, actionDate: Date, notificationPeriod: Int, summary: String) =\n    new Notification(id, subject, actionDate, notificationPeriod, summary, new Date, false, new Date, new Date)\n  private def formunapply(n: Notification) = Some((n.id, n.subject, n.actionDate, n.notificationPeriod, n.summary))\n\n  Logger.info(\"start Actaor\")\n  val notifyActor = system.actorOf(NotifyActor.props(dao, mc), \"notify-actor\")\n  var cl = Calendar.getInstance\n  cl.set(Calendar.SECOND, 0)\n  cl.set(Calendar.MILLISECOND, 0)\n  cl.add(Calendar.MINUTE, 1)\n  system.scheduler.schedule(\n      (cl.getTimeInMillis - System.currentTimeMillis).milliseconds,\n      1.minutes,\n      notifyActor,\n      \"NOTIFY\"\n  )\n  Logger.info(\"Actor has started\")\n\n  def index = Action {\n    Ok(views.html.index(\"\"))\n  }\n\n  def add = Action {\n    Ok(views.html.register(\"\", notificationForm))\n  }\n\n  def create = Action.async { implicit request =>\n    notificationForm.bindFromRequest.fold(\n        formWithErrors => {\n          Future(BadRequest(views.html.register(\"ERROR\", formWithErrors)))\n        },\n        notification => {\n          dao.create(notification).map(cnt => Ok(views.html.index(\"\u767b\u9332\u3057\u307e\u3057\u305f\")))\n        }\n    )\n  }\n\n  def getNotifications = Action.async {\n    dao.all().map(notifications => Ok(views.html.list(\"\", notifications)))\n  }\n\n  def read(id: Long) = Action.async {\n    dao.byId(id).flatMap(option =>\n      option match {\n        case Some(notification) => Future(Ok(views.html.edit(\"\", notificationForm.fill(notification))))\n        case None => dao.all().map(notifications => BadRequest(views.html.list(\"ERROR\", notifications)))\n      }\n    )\n  }\n\n  def update = Action.async { implicit request =>\n    notificationForm.bindFromRequest.fold(\n        formWithErrors => {\n          Future(BadRequest(views.html.edit(\"ERROR\", formWithErrors)))\n        },\n        notification => {\n          dao.update(notification).flatMap(cnt =>\n            if (cnt != 0) dao.all().map(notifications => Ok(views.html.list(\"\u66f4\u65b0\u3057\u307e\u3057\u305f\", notifications)))\n            else dao.all().map(notifications => BadRequest(views.html.edit(\"ERROR\", notificationForm.fill(notification))))\n          )\n        }\n    )\n  }\n\n  def delete(id: Long) = Action.async {\n    dao.delete(id).flatMap(cnt =>\n      if (cnt != 0) dao.all().map(notifications => Ok(views.html.list(\"\u524a\u9664\u3057\u307e\u3057\u305f\", notifications)))\n      else dao.all().map(notifications => BadRequest(views.html.list(\"ERROR\", notifications)))\n    )\n  }\n}\n\n\nScala\u306e\u5834\u5408\u3001Slick\u304c\u305d\u3053\u307e\u3067\u9811\u5f35\u3063\u3066\u304f\u308c\u306a\u3044\u306e\u3067\u3001\u30d5\u30a9\u30fc\u30e0\u3068Model\u306e\u30de\u30c3\u30d4\u30f3\u30b0\u306b\u3064\u3044\u3066\u591a\u5c11\u306e\u5b9f\u88c5\u304c\u5fc5\u8981\u3068\u306a\u308a\u307e\u3059\u3002\n\u4e2d\u3067\u3082\u3001apply\u30e1\u30bd\u30c3\u30c9\u3068unapply\u30e1\u30bd\u30c3\u30c9\u306e\u7b87\u6240\u304c\u5c11\u3005\u96e3\u3057\u304f\u3001\u30d5\u30a9\u30fc\u30e0\u306e\u9805\u76ee\u3068\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\uff08Model\uff09\u306e\u9805\u76ee\u304c\u540c\u3058\u3067\u3042\u308c\u3070\u3001Case\u30af\u30e9\u30b9\u306e\u30c7\u30d5\u30a9\u30eb\u30c8\u306eapply\u30e1\u30bd\u30c3\u30c9\u3068unapply\u30e1\u30bd\u30c3\u30c9\u3092\u305d\u306e\u307e\u307e\u4f7f\u3048\u308b\u306e\u3067\u3059\u304c\u3001\u9805\u76ee\u304c\u7570\u306a\u308b\u5834\u5408\u306b\u306f\u3001\u6050\u3089\u304f\u4eca\u56de\u306e\u3088\u3046\u306b\u81ea\u529b\u3067\u5b9f\u88c5\u3059\u308b\u5fc5\u8981\u304c\u3042\u308b\u3082\u306e\u3068\u601d\u308f\u308c\u307e\u3059\u3002\n\u4ed6\u306e\u7b87\u6240\u306f\u3001\u5404\u753b\u9762\u9077\u79fb\u3068DAO\u3092\u4ecb\u3057\u305fCRUD\u51e6\u7406\u3067\u3059\u3002\u521d\u671f\u51e6\u7406\u3068\u3057\u3066\u5148\u307b\u3069\u5b9f\u88c5\u3057\u305fActor\u30921\u5206\u5358\u4f4d\u3067\u8d77\u52d5\u3057\u3066\u3044\u307e\u3059\u3002\nScala\u306f\u521d\u671f\u51e6\u7406\u3092\u30e1\u30f3\u30d0\u5b9a\u7fa9\u306e\u3068\u3053\u308d\u306b\u8a18\u8ff0\u3067\u304d\u308b\u306e\u3067\u3001Java\u306e\u3088\u3046\u306b\u5225\u9014init()\u3092\u5916\u90e8\u304b\u3089\u53e9\u304f\u3088\u3046\u306a\u5b9f\u88c5\u306f\u4e0d\u8981\u3068\u306a\u308a\u307e\u3059\u3002\uff08\u305f\u3060\u3001\u521d\u671f\u51e6\u7406\u306f\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u8d77\u52d5\u6642\u3067\u306f\u306a\u304f\u3001\u3044\u305a\u308c\u304b\u306e\u30da\u30fc\u30b8\u304c\u30a2\u30af\u30bb\u30b9\u3055\u308c\u305f\u30bf\u30a4\u30df\u30f3\u30b0\u3067\u306e\u8d77\u52d5\u3068\u306a\u308a\u307e\u3059\u3002\uff09\n\u305d\u308c\u305e\u308c\u306e\u30e1\u30bd\u30c3\u30c9\u306e\u6982\u8981\u306f\u4e0b\u8a18\u306e\u901a\u308a\u3068\u306a\u308a\u307e\u3059\u3002\n\n\nindex\u3000\u30c8\u30c3\u30d7\u30da\u30fc\u30b8\uff08\u30e1\u30cb\u30e5\u30fc\u30da\u30fc\u30b8\uff09\u306e\u8868\u793a\n\nadd\u3000\u767b\u9332\u753b\u9762\u306e\u8868\u793a\n\ncreate\u3000\u767b\u9332\u753b\u9762\u304b\u3089\u306e\u5165\u529b\u5185\u5bb9\u3092\u53d7\u3051\u767b\u9332\u51e6\u7406\n\ngetNotifications\u3000\u4e00\u89a7\u753b\u9762\u306e\u8868\u793a\n\nread(Long)\u3000\u7de8\u96c6\u753b\u9762\u306e\u8868\u793a\n\nupdate\u3000\u7de8\u96c6\u753b\u9762\u304b\u3089\u306e\u5165\u529b\u5185\u5bb9\u3092\u53d7\u3051\u66f4\u65b0\u51e6\u7406\n\ndelete(Long)\u3000\u524a\u9664\u51e6\u7406\n\nbindFromRequest\u306f\u30d5\u30a9\u30fc\u30e0\u306e\u5165\u529b\u5185\u5bb9\u3092Model\u306b\u30de\u30c3\u30d4\u30f3\u30b0\u3057\u3066\u304f\u308c\u308b\u51e6\u7406\u3067\u3001Ebean\u3068\u7570\u306a\u308a\u3001\u5148\u307b\u3069\u306eapply\u30e1\u30bd\u30c3\u30c9\u3068unapply\u30e1\u30bd\u30c3\u30c9\u306e\u5b9f\u88c5\u306b\u5f93\u3063\u3066\u30de\u30c3\u30d4\u30f3\u30b0\u3092\u884c\u3044\u307e\u3059\u3002\n\nController\u306b\u3064\u3044\u3066\u306eJava\u3068Scala\u306e\u6bd4\u8f03\n\u3053\u3061\u3089\u3082Model\u3068\u540c\u69d8\u3001Ebean\u3068Slick\u306e\u5dee\u306e\u3088\u3046\u306b\u611f\u3058\u307e\u3059\u304c\u3001Scala\u7684\u306b\u306f\u3001\u30d5\u30a9\u30fc\u30e0\u306e\u30de\u30c3\u30d4\u30f3\u30b0\u306e\u8a18\u8ff0\u306fScala\u3089\u3057\u3044\u8a18\u8ff0\u306e\u3088\u3046\u3067\u3059\u306e\u3067\u3001\u6587\u5316\u306e\u5dee\u306e\u3068\u3044\u3046\u3053\u3068\u306a\u306e\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u3002\nPlay2.4\u304b\u3089GlobalSettings\u304c\u63a8\u5968\u3055\u308c\u306a\u304f\u306a\u3063\u305f\u305f\u3081\u3001\u521d\u671f\u51e6\u7406\u3092\u884c\u3046\u306b\u969b\u3057\u3001Java\u3067\u306f\u4ee3\u66ff\u624b\u6bb5\u304c\u898b\u3064\u304b\u3089\u305a\u3001\u305d\u306e\u3042\u305f\u308a\u306fScala\u306e\u65b9\u304c\u5bfe\u5fdc\u3057\u3084\u3059\u304b\u3063\u305f\u3067\u3059\u3002\n\nView\u306e\u4f5c\u6210\uff08Java\u3001Scala\u5171\u901a\uff09\nView\u306fScala\u306e\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u306e\u305f\u3081\u3001Java\u3068Scala\u3067\u540c\u3058\u5b9f\u88c5\u306b\u306a\u308a\u307e\u3059\u3002\n\u552f\u4e00register.scala.html\u3068edit.scala.html\u306e1\u884c\u76ee\u306e(implicit messages: Messages)\u306f\u3001Java\u306e\u5834\u5408\u3001\u524a\u9664\u3057\u306a\u3051\u308c\u3070\u3044\u3051\u307e\u305b\u3093\u3002\n\napp/views/main.scala.html\n@(title: String)(content: Html)\n\n<!DOCTYPE html>\n\n<html lang=\"jp\">\n    <head>\n        <title>@title</title>\n        <link rel=\"stylesheet\" media=\"screen\" href=\"@routes.Assets.versioned(\"stylesheets/main.css\")\">\n        <link rel=\"shortcut icon\" type=\"image/png\" href=\"@routes.Assets.versioned(\"images/favicon.png\")\">\n        <meta name=\"viewport\" content=\"width=device-width\">\n    </head>\n    <body>\n        @content\n    </body>\n</html>\n\n\n\napp/views/index.scala.html\n@(message: String)\n\n@main(\"\u30e1\u30cb\u30e5\u30fc\u753b\u9762\") {\n\n    <h1>\u30e1\u30cb\u30e5\u30fc\u753b\u9762</h1>\n    <p>@message</p>\n\n    <p><a href=\"/add\">[\u767b\u9332]</a></p>\n    <p><a href=\"/list\">[\u4e00\u89a7]</a></p>\n\n}\n\n\n\napp/views/register.scala.html\n@(message: String, form1: Form[models.Notification])(implicit messages: Messages)\n\n@main(\"\u767b\u9332\u753b\u9762\") {\n\n    <h1>\u767b\u9332\u753b\u9762</h1>\n    <p>@message</p>\n\n    @helper.form(action=routes.Application.create) {\n        @(helper.inputText (\n            field = form1(\"subject\"),\n            '_label -> \"\u4ef6\u540d\"\n        ))\n        @helper.input(form1(\"actionDate\"), '_label -> \"\u65e5\u6642\") { (id, name, value, args) =>\n            <input type=\"datetime-local\" name=\"@name\" id=\"@id\" value=\"@value\" @toHtmlArgs(args)>\n        }\n        @(helper.select (\n            field = form1(\"notificationPeriod\"),\n            options = Seq(\"1\" -> \"1\u5206\u524d\", \"10\" -> \"10\u5206\u524d\", \"15\" -> \"15\u5206\u524d\", \"20\" -> \"20\u5206\u524d\", \"25\" -> \"25\u5206\u524d\"\n                        , \"30\" -> \"30\u5206\u524d\", \"45\" -> \"45\u5206\u524d\", \"60\" -> \"1\u6642\u9593\u524d\"),\n            args = 'size -> 1,\n            '_label -> \"\u901a\u77e5\u6642\u9593\"\n        ))\n        @(helper.textarea (\n            field = form1(\"summary\"),\n            '_label -> \"\u8aac\u660e\"\n        ))\n        <button>\u767b\u9332</button>\n    }\n\n    <p><a href=\"/\">[HOME]</a></p>\n}\n\n\n\napp/views/list.scala.html\n@(message: String, notifications: List[models.Notification])\n\n@main(\"\u4e00\u89a7\u753b\u9762\") {\n\n    <h1>\u4e00\u89a7\u753b\u9762</h1>\n    <p>@message</p>\n\n    <ul id=\"notifyItems\">\n    @for(notification <- notifications) {\n        <li>\n        <a href=\"/item/@notification.id\">[\u7de8\u96c6]</a>\n        <a href=\"/remove/@notification.id\">[\u524a\u9664]</a>\n        @notification.subject\n        </li>\n    }\n    </ul>\n\n    <p><a href=\"/\">[HOME]</a></p>\n}\n\n\n\napp/views/edit.scala.html\n@(message: String, form1: Form[models.Notification])(implicit messages: Messages)\n\n@main(\"\u7de8\u96c6\u753b\u9762\") {\n\n    <h1>\u7de8\u96c6\u753b\u9762</h1>\n    <p>@message</p>\n\n    @helper.form(action=routes.Application.update) {\n        <input type=\"hidden\" name=\"id\" value=\"@form1(\"id\").value\">\n        @(helper.inputText (\n            field = form1(\"subject\"),\n            '_label -> \"\u4ef6\u540d\"\n        ))\n        @helper.input(form1(\"actionDate\"), '_label -> \"\u65e5\u6642\") { (id, name, value, args) =>\n            <input type=\"datetime-local\" name=\"@name\" id=\"@id\" value=\"@value\" @toHtmlArgs(args)>\n        }\n        @(helper.select (\n            field = form1(\"notificationPeriod\"),\n            options = Seq(\"1\" -> \"1\u5206\u524d\", \"10\" -> \"10\u5206\u524d\", \"15\" -> \"15\u5206\u524d\", \"20\" -> \"20\u5206\u524d\", \"25\" -> \"25\u5206\u524d\"\n                        , \"30\" -> \"30\u5206\u524d\", \"45\" -> \"45\u5206\u524d\", \"60\" -> \"1\u6642\u9593\u524d\"),\n            args = 'size -> 1,\n            '_label -> \"\u901a\u77e5\u6642\u9593\"\n        ))\n        @(helper.textarea (\n            field = form1(\"summary\"),\n            '_label -> \"\u8aac\u660e\"\n        ))\n        <button>\u66f4\u65b0</button>\n    }\n\n    <p><a href=\"/list\">[\u4e00\u89a7]</a></p>\n    <p><a href=\"/\">[HOME]</a></p>\n}\n\n\n\nRoutes\u306e\u4f5c\u6210\uff08Java\u3001Scala\u5171\u901a\uff09\n\u6700\u5f8c\u306bView\u3068Controller\u306e\u30eb\u30fc\u30c8\u30de\u30c3\u30d4\u30f3\u30b0\u3092\u884c\u3044\u307e\u3059\u3002\n\nconf/routes\n# Routes\n# This file defines all application routes (Higher priority routes first)\n# ~~~~\n\n# Home page\n#GET     /init                       controllers.Application.init\nGET     /                           controllers.Application.index\nGET     /add                        controllers.Application.add\nPOST    /create                     controllers.Application.create\nGET     /item/:id                   controllers.Application.read(id: Long)\nPOST    /update                     controllers.Application.update\nGET     /remove/:id                 controllers.Application.delete(id: Long)\nGET     /list                       controllers.Application.getNotifications\n\n# Map static resources from the /public folder to the /assets URL path\nGET     /assets/*file               controllers.Assets.versioned(path=\"/public\", file: Asset)\n\n\nJava\u306e\u5834\u5408\u306f\u3001\u30a2\u30af\u30bf\u30fc\u8d77\u52d5\u306e\u305f\u3081\u306b\u3001\u30b3\u30e1\u30f3\u30c8\u30a2\u30a6\u30c8\u3057\u3066\u3044\u308binit\u51e6\u7406\u3092\u547c\u3073\u51fa\u3059\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\n\u4e00\u5fdc\u30d1\u30fc\u30bd\u30ca\u30eb\u30e6\u30fc\u30b9\u306a\u306e\u3067\u3001GET\u3067\u524a\u9664\u51e6\u7406\u3092\u884c\u3063\u3066\u3044\u308b\u90e8\u5206\u306b\u306f\u76ee\u3092\u3064\u3080\u3063\u3066\u304f\u3060\u3055\u3044\u3002\u3002\n\u5f8c\u3001\u672c\u30a2\u30d7\u30ea\u306f\u30ac\u30e9\u30db\u304b\u3089\u306e\u5229\u7528\u3092\u60f3\u5b9a\u3057\u3066\u3044\u308b\u306e\u3067\u3001\u4e0b\u8a18\u306e\u3088\u3046\u306aCSS\u3092\u8a2d\u5b9a\u3057\u3066\u3044\u307e\u3059\u3002\n\npublic/stylesheets/main.css\nbody {\n    font-size: 16pt;\n    color: #000066;\n}\nbutton {\n    font-size: 14pt;\n    padding: 5px 20px;\n}\nh1 {\n    font-size: 20pt;\n    font-weight: bold;\n    background-color: #6666aa;\n    color: #ccccff;\n    padding: 3px;\n}\ninput#subject {\n    width: 280px;\n    height: 30px;\n}\ninput#actionDate {\n    height: 30px;\n}\nselect#notificationPeriod {\n    height: 30px;\n}\ntextarea#summary {\n    width: 280px;\n}\n\n\n\n\u3055\u3044\u3054\u306b\nJava\u3068Scala\u306e\u4e21\u65b9\u306e\u30bd\u30fc\u30b9\u3092\u63b2\u8f09\u3057\u305f\u305f\u3081\u3001\u304b\u306a\u308a\u306e\u884c\u6570\u3068\u306a\u3063\u3066\u3057\u307e\u3044\u307e\u3057\u305f\u304c\u3001Play2.4\u3067\u306e\u7c21\u5358\u306aCRUD\u51e6\u7406\uff08\uff0bAkka\uff09\u306b\u3064\u3044\u3066\u306e\u5b9f\u88c5\u3067\u3057\u305f\u3002\n\u4eca\u56de\u306eWeb\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u4f5c\u6210\u3092\u901a\u3058\u3001\u6700\u3082Play\u304c\u512a\u308c\u3066\u3044\u308b\u3068\u611f\u3058\u305f\u70b9\u306f\u3001View\u3060\u3051\u3067\u306a\u304fModel\u3084Controller\u3001\u306f\u305f\u307e\u305fRoutes\u306b\u81f3\u308b\u307e\u3067\u3059\u3079\u3066\u304c\u52d5\u7684\u30b3\u30f3\u30d1\u30a4\u30eb\u306e\u5bfe\u8c61\u3068\u306a\u3063\u3066\u3044\u308b\u3053\u3068\u3067\u3059\u3002\n\u9759\u7684\u306a\u30b3\u30f3\u30d1\u30a4\u30eb\u3068\u52d5\u7684\u306a\u30b3\u30f3\u30d1\u30a4\u30eb\u304c\u6df7\u5728\u3059\u308b\u3068\u3001\u958b\u767a\u30b3\u30b9\u30c8\u306e\u5dee\u304b\u3089\u3001\u958b\u767a\u306e\u30d0\u30e9\u30f3\u30b9\u304c\u5d29\u308c\u3066\u3057\u307e\u3044\u3001\u7cbe\u795e\u7684\u306b\u3042\u307e\u308a\u5b9c\u3057\u304f\u306a\u3044\u72b6\u614b\u3068\u306a\u308b\u306e\u3067\u3059\u304c\u3001Play\u306f\u3059\u3079\u3066\u3092\u5e73\u7b49\u306b\u6271\u3063\u3066\u3044\u308b\u611f\u304c\u3042\u308b\u306e\u3067\u3001MVC\u3092\u5fb9\u5e95\u7684\u306b\u610f\u8b58\u3057\u305f\u30b9\u30c8\u30ec\u30b9\u306e\u306a\u3044\u5b9f\u88c5\u304c\u53ef\u80fd\u306b\u306a\u308b\u3068\u601d\u3044\u307e\u3059\u3002\nPlay\u306f\u30d0\u30fc\u30b8\u30e7\u30f3\u30a2\u30c3\u30d7\u306e\u5ea6\u306b\u3001\u304b\u306a\u308a\u5927\u80c6\u306b\u4ed5\u69d8\u3092\u5909\u66f4\u3057\u3066\u3044\u308b\u3089\u3057\u304f\u3001\u5c06\u6765\u7684\u306b\u3088\u308a\u826f\u3044\u30d5\u30ec\u30fc\u30e0\u30ef\u30fc\u30af\u306b\u6210\u9577\u3059\u308b\u3068\u3044\u3046\u671f\u5f85\u611f\u304c\u9ad8\u307e\u308b\u4e00\u65b9\u3001\u4eca\u56de\u306e\u5b9f\u88c5\u3067\u306f\u304b\u306a\u308a\u306e\u78ba\u7387\u3067\u30cd\u30c3\u30c8\u306e\u60c5\u5831\u306b\u30df\u30b9\u30ea\u30fc\u30c9\u3055\u305b\u3089\u308c\u3066\u3057\u307e\u3044\u307e\u3057\u305f\u3002Play2.3\u306e\u60c5\u5831\u304c\u53c2\u8003\u306b\u306a\u3089\u306a\u3044\u3053\u3068\u3082\u6570\u591a\u304f\u3042\u308a\u307e\u3059\u306e\u3067\u3001\u3054\u6ce8\u610f\u3092\u3002\n\u305d\u306e\u4e2d\u3067\u3082\u30aa\u30d5\u30a3\u30b7\u30e3\u30eb\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u306f\u30d0\u30fc\u30b8\u30e7\u30f3\u6bce\u306b\u304d\u3061\u3093\u3068\u4f5c\u6210\u3055\u308c\u3066\u3044\u3066\u3001\u304b\u306a\u308a\u306e\u60c5\u5831\u91cf\u3068\u306a\u3063\u3066\u3044\u307e\u3059\u3002\u307e\u305a\u306f\u30aa\u30d5\u30a3\u30b7\u30e3\u30eb\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u306b\u3069\u3063\u3077\u308a\u3068\u8ef8\u8db3\u3092\u7f6e\u3044\u3066\u3044\u305f\u3060\u304d\u3001\u5916\u90e8\u30b5\u30a4\u30c8\u3092\u53c2\u8003\u306b\u3059\u308b\u969b\u306b\u306f\u3001\u30d0\u30fc\u30b8\u30e7\u30f3\u306e\u78ba\u8a8d\u3092\u5fb9\u5e95\u3059\u308b\u3053\u3068\u304c\u5927\u5207\u3060\u3068\u601d\u3044\u307e\u3059\u3002\n# \u306f\u3058\u3081\u306b\n\nPlay\u306fTypesafe\u793e\u304c\u63d0\u4f9b\u3057\u3066\u3044\u308bWeb\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u305f\u3081\u306e\u30d5\u30ec\u30fc\u30e0\u30ef\u30fc\u30af\u3067\u3059\u3002\n\n\u4ed6\u306e\u30d5\u30ec\u30fc\u30e0\u30ef\u30fc\u30af\u3068\u540c\u69d8\u3001Play\u3082MVC\u30a2\u30fc\u30ad\u30c6\u30af\u30c1\u30e3\u30fc\u3092\u63a1\u7528\u3057\u3066\u3044\u308b\u306e\u3067\u3059\u304c\u3001\u9762\u767d\u3044\u70b9\u306fModel\u3068Controller\u306e\u5b9f\u88c5\u3092Java\u3068Scala\u306e2\u3064\u304b\u3089\u9078\u3079\u308b\u3053\u3068\u3002\n\n\u300cJava\u3068Scala\u306e2\u3064\u3092\u63d0\u4f9b\u3057\u3066\u3044\u308b\u3093\u3060\u3063\u305f\u3089\u4f55\u3082Java\u306e\u4f5c\u6cd5\u306b\u7e1b\u3089\u308c\u308b\u3053\u3068\u306a\u3044\u3088\u306d\u300d\u3068\u3044\u3046\u3053\u3068\u306a\u306e\u304b\u3001Play\u306b\u306f\u3001Java\u3067Web\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3068\u306a\u308c\u3070\u5f53\u7136\u51fa\u3066\u304f\u308b\u30b5\u30fc\u30d6\u30ec\u30c3\u30c8\u3084JSP\u3068\u3044\u3063\u305fJavaEE\u306e\u6982\u5ff5\u30e2\u30c7\u30eb\u306f\u4e00\u5207\u306a\u304f\u3001\u3069\u3061\u3089\u304b\u3068\u3044\u3046\u3068\u3001Ruby on Rails\u306e\u3088\u3046\u306a\u8efd\u91cf\u30d5\u30ec\u30fc\u30e0\u30ef\u30fc\u30af\u3068\u3057\u3066\u5b9f\u88c5\u3055\u308c\u3066\u3044\u308b\u3088\u3046\u3067\u3059\u3002\n\n\u9577\u5e74Java\u4e00\u7b4b\u3067\u3001Web\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306f\u57fa\u672c\u30b5\u30fc\u30d6\u30ec\u30c3\u30c8\u3001\u6b21\u3005\u3068\u65b0\u3057\u3044\u30d5\u30ec\u30fc\u30e0\u30ef\u30fc\u30af\u304c\u51fa\u3066\u3082JavaEE\u306e\u7bc4\u7587\u3067\u3002\u3002\u3002\u305d\u3093\u306a\u4e2d\u3001Rails\u306e\u6ce2\u306b\u3082\u4e57\u308b\u3053\u3068\u304c\u3067\u304d\u305a\u3001\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u306e\u7169\u96d1\u3055\u3084\u958b\u767a\u30b9\u30d4\u30fc\u30c9\u306e\u5dee\u306b\u6c17\u4ed8\u3044\u3066\u306f\u3044\u3066\u3082\u3001Ruby\u306f\u52d5\u7684\u578b\u4ed8\u3060\u304b\u3089\u3002\u3002\u3002\u3068\u81ea\u5206\u3092\u8a00\u3044\u805e\u304b\u305b\u3066\u304d\u305f\u65e5\u3005\u3002\u3002\u3002\n\nJava\u3082Scala\u3082\u9759\u7684\u578b\u4ed8\u8a00\u8a9e\u3001\u30d7\u30e9\u30b9Rails\u306e\u3088\u3046\u306a\u8efd\u91cf\u30d5\u30ec\u30fc\u30e0\u30ef\u30fc\u30af\u3002\u4eca\u56dePlay\u306e\u5b9f\u529b\u3092\u78ba\u304b\u3081\u308b\u3079\u304f\u3001Java\u3068Scala\u3067\u5358\u7d14\u306aWeb\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u4f5c\u6210\u3057\u3066\u307f\u307e\u3057\u305f\u3002\n\n\u5c11\u3057\u898b\u3065\u3089\u3044\u306e\u3067\u3059\u304c\u3001\u305b\u3063\u304b\u304f\u3067\u3059\u306e\u3067\u3001Java\u3068Scala\u306e2\u3064\u306e\u30b3\u30fc\u30c9\u3092\u8f09\u305b\u3066\u6bd4\u8f03\u3057\u3066\u307f\u305f\u3044\u3068\u601d\u3044\u307e\u3059\u3002\n\n\u306a\u304a\u3001Scala\u306e\u5b9f\u88c5\u306b\u3064\u304d\u307e\u3057\u3066\u306f\u3001\u4e0b\u8a18\u306e\u8a18\u4e8b\u306e\u65b9\u304c\u30b9\u30de\u30fc\u30c8\u306a\u5b9f\u88c5\u306b\u306a\u3063\u3066\u3044\u307e\u3059\u306e\u3067\u3001\u305d\u3061\u3089\u3092\u3054\u53c2\u7167\u304f\u3060\u3055\u3044\u3002\n[Play 2.5\u3067\u306eCRUD\u51e6\u7406\u304a\u3088\u3073\u30e1\u30fc\u30eb\u9001\u4fe1\uff08activator\u306b\u3088\u308b\u958b\u767a\u74b0\u5883\u306e\u69cb\u7bc9\u304b\u3089keter\u306b\u3088\u308b\u30c7\u30d7\u30ed\u30a4\u307e\u3067](http://qiita.com/erin/items/1a49e728b42473a9364f)\n\n# \u74b0\u5883\n\nPlay Framework 2.4.3\nJava 8\nScala 2.11\nEbean ORM\uff1f\nSlick 3.0\n\n# \u4f5c\u6210\u3059\u308bWeb\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306b\u3064\u3044\u3066\n\n\u643a\u5e2f\u96fb\u8a71\u306e\u30ab\u30ec\u30f3\u30c0\u30fc\u6a5f\u80fd\u306b\u306f\u3001\u4e88\u5b9a\u3092\u767b\u9332\u3059\u308b\u3068\u3001\u305d\u306e\u958b\u59cb\u65e5\u6642\u306e\u25cb\u5206\u524d\u306b\u30a2\u30e9\u30fc\u30e0\u3092\u306a\u3089\u3059\u6a5f\u80fd\u304c\u3042\u308b\u304b\u3068\u601d\u3044\u307e\u3059\u3002\u79c1\u306e\u30ac\u30e9\u30db\uff08AQUOS K SHF32\uff09\u3067\u306f\u30a2\u30e9\u30fc\u30e0\u306f\u547c\u51fa\u97f3\u306e\u8a2d\u5b9a\u3068\u9023\u52d5\u3057\u3066\u3044\u308b\u3088\u3046\u3067\u3001\u547c\u51fa\u97f3\u3092\u5207\u3063\u3066\u30d0\u30a4\u30d6\u306e\u307f\u3067\u4f7f\u7528\u3057\u3066\u3044\u308b\u3068\u3001\u5f53\u7136\u30a2\u30e9\u30fc\u30e0\u306f\u9cf4\u3089\u305a\u3001\u305d\u308c\u3060\u3051\u306a\u3089\u307e\u3060\u3057\u3082\u3001\u30d0\u30a4\u30d6\u3059\u3089\u3057\u3066\u304f\u308c\u306a\u3044\u3068\u3044\u3046\u4f7f\u3044\u52dd\u624b\u306e\u60aa\u3055\u3002\n\n\u3068\u3044\u3046\u3053\u3068\u3067\u3001\u305d\u306e\u6a5f\u80fd\u3092Web\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3068\u3057\u3066\u4f5c\u6210\u3059\u308b\u3053\u3068\u306b\u3057\u3066\u307f\u307e\u3057\u305f\u3002\n\n\u6982\u8981\u306f\u3001\u30b5\u30a4\u30c8\u306b\u30a2\u30af\u30bb\u30b9\u3057\u3001\u4ef6\u540d\u3001\u958b\u59cb\u6642\u523b\u3001\u901a\u77e5\u6642\u9593\uff08\u25cb\u5206\u524d\uff09\u3001\u8aac\u660e\u6587\u3092\u767b\u9332\u3059\u308b\u3068\u3001\u30b5\u30fc\u30d0\u5074\u3067\u305d\u306e\u901a\u77e5\u6642\u523b\u306b\u306a\u3063\u305f\u6642\u70b9\u3067\u3001\u30e1\u30fc\u30eb\u3092\u914d\u4fe1\u3057\u3066\u304f\u308c\u308b\u3068\u3044\u3046Web\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3067\u3059\u3002\n\n![index.png](https://qiita-image-store.s3.amazonaws.com/0/94455/9c74106b-d96c-3e95-4d5b-f2878ae181b8.png)![register.png](https://qiita-image-store.s3.amazonaws.com/0/94455/077e6441-4ceb-b07b-41ae-0bff151f5626.png)\n![list.png](https://qiita-image-store.s3.amazonaws.com/0/94455/042cbd9d-2c55-3c87-bce2-e1810ef89931.png)![edit.png](https://qiita-image-store.s3.amazonaws.com/0/94455/b2d840f4-a6ed-8603-a35f-5d142cf77ca2.png)\n\n# Model\u3068DAO\u306e\u4f5c\u6210\uff08Java\u7de8\uff09\n\n\u307e\u305aModel\u306e\u4f5c\u6210\u304b\u3089\u59cb\u3081\u3066\u3044\u304d\u307e\u3059\u3002\n\n\u307e\u305a\u306f\u6163\u308c\u89aa\u3057\u3093\u3060Java\u304b\u3089\u3002Java\u3067\u306f\u300cEbean ORM\u300d\u3068\u3044\u3046ORM\u3092\u4f7f\u3044\u307e\u3059\u3002Ebean\u3092\u4f7f\u7528\u3059\u308b\u305f\u3081\u3001Play2.4\u306e[\u30aa\u30d5\u30a3\u30b7\u30e3\u30eb\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8](https://www.playframework.com/documentation/2.4.x/JavaEbean)\u3092\u53c2\u8003\u306b\u4e0b\u8a18\u306e3\u70b9\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n\n\uff11\uff0e`project/plugins.sbt`\u306b\u4e0b\u8a18\u3092\u8ffd\u8a18\n\n```scala:project/plugins.sbt\naddSbtPlugin(\"com.typesafe.sbt\" % \"sbt-play-ebean\" % \"1.0.0\")\n```\n\n\uff12\uff0e`build.sbt`\u306b\u4e0b\u8a18\u3092\u8ffd\u8a18\n\n```scala:build.sbt\nlazy val myProject = (project in file(\".\")).enablePlugins(PlayJava, PlayEbean)\n```\n\n\uff13\uff0e`conf/application.conf`\u306b\u4e0b\u8a18\u3092\u8ffd\u8a18\n\n```scala:conf/application.conf\ndb.default.driver=org.h2.Driver\ndb.default.url=\"jdbc:h2:mem:play\"\nebean.default = [\"models.*\"]\n```\n\n\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306fH2\u306e\u30e1\u30e2\u30ea\u30b9\u30c8\u30ec\u30fc\u30b8\u3067\u884c\u3044\u307e\u3059\u3002\n\n\u305d\u3057\u3066\u3001`app/models/Notification.java`\u306b\u4e0b\u8a18\u306e\u5b9f\u88c5\u3092\u3002\n\n```java:app/models/Notification.java\npackage models;\n\nimport java.util.*;\n\nimport javax.persistence.*;\n\nimport com.avaje.ebean.Model;\nimport com.avaje.ebean.annotation.*;\n\nimport play.data.validation.Constraints.*;\nimport play.data.format.*;\n\n@Entity\npublic class Notification extends Model {\n\t@Id\n\tpublic Long id;\n\n\t@Required(message = \"\u5fc5\u9808\u9805\u76ee\u3067\u3059\u3002\")\n\tpublic String subject;\n\n\t@Required(message = \"\u5fc5\u9808\u9805\u76ee\u3067\u3059\u3002\")\n\t@Formats.DateTime(pattern = \"yyyy-MM-dd'T'HH:mm\")\n\tpublic Date actionDate;\n\n\tpublic Integer notificationPeriod;\n\n\tpublic String summary;\n\n\t@Formats.DateTime(pattern = \"yyyy-MM-dd'T'HH:mm\")\n\tpublic Date notificationDate;\n\n\tpublic boolean isSent;\n\n\t@CreatedTimestamp\n\t@Formats.DateTime(pattern = \"yyyy-MM-dd'T'HH:mm\")\n\tpublic Date createdDate;\n\n\t@UpdatedTimestamp\n\t@Formats.DateTime(pattern = \"yyyy-MM-dd'T'HH:mm\")\n\tpublic Date updatedDate;\n\n\t@Override\n\tpublic void save() {\n\t\tnotificationDate = calcNotificationDate(actionDate, notificationPeriod);\n\t\tsuper.save();\n\t}\n\n\t@Override\n\tpublic void update() {\n\t\tnotificationDate = calcNotificationDate(actionDate, notificationPeriod);\n\t\tsuper.update();\n\t}\n\n\tprivate Date calcNotificationDate(Date actionDate, Integer notificationPeriod) {\n\t\tCalendar cl = Calendar.getInstance();\n\t\tcl.setTime(actionDate);\n\t\tcl.add(Calendar.MINUTE, -notificationPeriod);\n\t\treturn cl.getTime();\n\t}\n}\n```\n\nEbean\u306fModel\u30af\u30e9\u30b9\u306b\u5bfe\u3057\u3066\u3001\u76f4\u63a5`save()`\u3084`update()`\u3092\u30b3\u30fc\u30eb\u3059\u308b\u3053\u3068\u306b\u3088\u308a\u81ea\u52d5\u7684\u306b\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3078`INSERT`\u3084`UPDATE`\u3057\u3066\u304f\u308c\u308b\u512a\u308c\u3082\u306e\u3002\u307e\u305f\u3001@CreatedTimestamp\u306e\u30a2\u30ce\u30c6\u30fc\u30b7\u30e7\u30f3\u306f`INSERT`\u6642\u306b\u30bf\u30a4\u30e0\u30b9\u30bf\u30f3\u30d7\u3092\u3001@UpdatedTimestamp\u306e\u30a2\u30ce\u30c6\u30fc\u30b7\u30e7\u30f3\u306f`UPDATE`\u6bce\u306b\u81ea\u52d5\u7684\u306b\u30bf\u30a4\u30e0\u30b9\u30bf\u30f3\u30d7\u3092\u767b\u9332\u3057\u3066\u304f\u308c\u307e\u3059\u3002\n\n`private Date calcNotificationDate(Date, Integer)`\u306f\u958b\u59cb\u6642\u523b\u3068\u25cb\u5206\u524d\u3067\u6307\u5b9a\u3055\u308c\u305f\u901a\u77e5\u6642\u9593\u304b\u3089\u901a\u77e5\u6642\u523b\u3092\u8a08\u7b97\u3057\u307e\u3059\u3002DAO\u5074\u306b\u5b9f\u88c5\u3059\u308b\u51e6\u7406\u306e\u3088\u3046\u306a\u6c17\u3082\u3057\u307e\u3059\u304c\u3001\u30b9\u30fc\u30d1\u30fc\u30af\u30e9\u30b9\u306e`com.avaje.ebean.Model`\u5074\u306b`save()`\u3084`update()`\u304c\u5185\u5305\u3055\u308c\u3066\u3057\u307e\u3063\u3066\u3044\u308b\u306e\u3067\u3001@Override\u3057\u3066\u3053\u3061\u3089\u304b\u3089\u547c\u3073\u51fa\u3059\u3053\u3068\u306b\u3002\n\n\u5f8c\u3001Ebean\u306e\u5834\u5408\u3001\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u81ea\u4f53\u306fEbean\u5074\u304c\u81ea\u52d5\u7684\u306bSQL\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u751f\u6210\u3057\u3001Play\u5074\u304c`conf/evolutions/default/1.sql`\u306b\u8a18\u8ff0\u3055\u308c\u305fSQL\u3092\u5b9f\u884c\u3057\u30c6\u30fc\u30d6\u30eb\u3092\u81ea\u52d5\u4f5c\u6210\u3057\u3066\u304f\u308c\u308b\u306e\u3082\u4fbf\u5229\u306a\u3068\u3053\u308d\u3002\n\n\u7d9a\u3044\u3066CRUD\u51e6\u7406\u3092\u884c\u3046DAO\u3092`app/dao/NotificationDAO.java`\u306b\u3002\n\n```java:app/dao/NotificationDAO.java\npackage dao;\n\nimport models.Notification;\n\nimport java.util.Calendar;\nimport java.util.Date;\nimport java.util.List;\n\nimport javax.inject.Singleton;\n\nimport com.avaje.ebean.Model.Finder;\n\n@Singleton\npublic class NotificationDAO {\n\n\tprivate static Finder<Long, Notification> find = new Finder<Long, Notification>(Notification.class);\n\n\tpublic void create(Notification notification) {\n\t\tnotification.save();\n\t}\n\n\tpublic void update(Notification notification) {\n\t\tnotification.update();\n\t}\n\n\tpublic void delete(Notification notification) {\n\t\tnotification.delete();\n\t}\n\n\tpublic List<Notification> all() {\n\t\treturn find.all();\n\t}\n\n\tpublic Notification byId(long id) {\n\t\treturn find.byId(id);\n\t}\n\n\tpublic List<Notification> getNotificationList() {\n\t\treturn find.where().eq(\"isSent\", false).le(\"notificationDate\", new Date()).findList();\n\t}\n}\n```\n\nEbean\u306e\u5834\u5408\u3001\u66f4\u65b0\u7cfb\u306f\u3042\u3089\u304b\u3058\u3081`Notification`\u306e\u30b9\u30fc\u30d1\u30fc\u30af\u30e9\u30b9\u3067\u3042\u308b`com.avaje.ebean.Model`\u306b\u5b9f\u88c5\u3055\u308c\u3066\u3044\u308b`save()`\u3001`update()`\u3001`delete()`\u3092\u30b3\u30fc\u30eb\u3059\u308b\u3060\u3051\u3002\u53c2\u7167\u7cfb\u306f`com.avaje.ebean.Model.Finder`\u306e\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u4f7f\u3063\u3066\u884c\u3044\u307e\u3059\u3002\n`all()`\u306f\u3059\u3079\u3066\u53d6\u5f97\u3001`byId(long)`\u306f\u30d7\u30e9\u30a4\u30de\u30ea\u30ad\u30fc\u306eID\u3067\u53d6\u5f97\u3001`getNotificationList()`\u306f\u691c\u7d22\u3057\u3066\u53d6\u5f97\u3057\u3066\u3044\u307e\u3059\u3002\n\u672c\u30a2\u30d7\u30ea\u306f\u901a\u77e5\u6642\u523b\u306b\u30e1\u30fc\u30eb\u9001\u4fe1\u3092\u884c\u3046\u305f\u3081\u3001\u300c\u30e1\u30fc\u30eb\u9001\u4fe1\u3057\u3066\u3044\u306a\u3044\u300d\u4e14\u3064\u300c\u901a\u77e5\u6642\u523b\uff1c\uff1d\u73fe\u5728\u6642\u523b\u300d\u3068\u3044\u3046\u6761\u4ef6\u306e`getNotificationList()`\u3092\u5b9a\u7fa9\u3057\u3066\u3044\u307e\u3059\u3002\n\n# Model\u3068DAO\u306e\u4f5c\u6210\uff08Scala\u7de8\uff09\n\n\u6b21\u306bScala\u3067\u306eModel\u3068DAO\u306e\u4f5c\u6210\u3092\u898b\u3066\u307f\u307e\u3059\u3002\n\nScala\u3067\u306f\u300cSlick\u300d\u3068\u3044\u3046~~ORM~~FRM\u3092\u4f7f\u3044\u307e\u3059\u3002Slick\u306f\u300cScala Language-Integrated Connection Kit\u300d\u306e\u7565\u3067Play\u3068\u540c\u3058Typesafe\u793e\u304c\u63d0\u4f9b\u3057\u3066\u3044\u308bORM\u306a\u3089\u306cFRM\u300cFunctional Relational Mapping\u300d\u3060\u305d\u3046\u3067\u3059\u3002\uff08\u4fee\u6b63\uff1a2015/10/30\uff09\n\nSlick\u3092\u4f7f\u7528\u3059\u308b\u305f\u3081\u3001Play2.4\u306e[\u30aa\u30d5\u30a3\u30b7\u30e3\u30eb\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8](https://www.playframework.com/documentation/2.4.x/PlaySlick)\u3092\u53c2\u8003\u306b\u4e0b\u8a18\u306e2\u70b9\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n\n\uff11\uff0e`build.sbt`\u306b\u4e0b\u8a18\u3092\u8ffd\u8a18\n\n```scala:build.sbt\nlibraryDependencies += \"com.typesafe.play\" %% \"play-slick\" % \"1.0.1\"\nlibraryDependencies += \"com.typesafe.play\" %% \"play-slick-evolutions\" % \"1.0.1\"\nlibraryDependencies += \"com.h2database\" % \"h2\" % \"1.3.176\"\n```\n\u203b`build.sbt`\u304b\u3089\u300cjdbc\u300d\u306e\u4f9d\u5b58\u306e\u8a18\u8ff0\u3092\u30b3\u30e1\u30f3\u30c8\u30a2\u30a6\u30c8\uff08\u8d77\u52d5\u6642\u306bbinding\u306e\u30a8\u30e9\u30fc\u304c\u51fa\u308b\u305f\u3081\uff09\n\n\uff12\uff0e`conf/application.conf`\u306b\u4e0b\u8a18\u3092\u8ffd\u8a18\n\n```scala:conf/application.conf\nslick.dbs.default.driver=\"slick.driver.H2Driver$\"\nslick.dbs.default.db.driver=\"org.h2.Driver\"\nslick.dbs.default.db.url=\"jdbc:h2:mem:play\"\n```\n\n\u3053\u3061\u3089\u3082\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306fH2\u306e\u30e1\u30e2\u30ea\u30b9\u30c8\u30ec\u30fc\u30b8\u3067\u884c\u3044\u307e\u3059\u3002\n\n\u305d\u3057\u3066\u3001`app/models/Notification.scala`\u306b\u4e0b\u8a18\u306e\u5b9f\u88c5\u3092\u3002\n\n```scala:app/models/Notification.scala\npackage models\n\nimport java.util.Date\n\ncase class Notification (\n    id: Option[Long],\n    subject: String,\n    actionDate: Date,\n    notificationPeriod: Int,\n    summary: String,\n    notificationDate: Date,\n    isSent: Boolean,\n    createdDate: Date,\n    updatedDate: Date\n)\n```\n\nScala\u306fCase\u30af\u30e9\u30b9\u3092\u4f7f\u7528\u3059\u308b\u305f\u3081\u3001Model\u306e\u5b9a\u7fa9\u81ea\u4f53\u306f\u7c21\u5358\u3067\u3059\u3002\n\n\u305f\u3060\u3001Slick\u306e\u5834\u5408\u3001Ebean\u3068\u9055\u3063\u3066SQL\u30b9\u30af\u30ea\u30d7\u30c8\u306e\u81ea\u52d5\u751f\u6210\u306f\u884c\u3063\u3066\u304f\u308c\u307e\u305b\u3093\u306e\u3067\u3001`conf/evolutions/default/1.sql`\u306f\u81ea\u5206\u3067\u7528\u610f\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\n\n```conf/evolutions/default/1.sql\n# Notification\n\n# --- !Ups\n\nCREATE TABLE \"notification\" (\n    \"id\" bigint(20) NOT NULL AUTO_INCREMENT,\n    \"subject\" varchar(255),\n    \"action_date\" timestamp,\n    \"notification_period\" integer,\n    \"summary\" varchar(255),\n    \"notification_date\" timestamp,\n    \"is_sent\" boolean,\n    \"created_date\" timestamp,\n    \"updated_date\" timestamp,\n    PRIMARY KEY (\"id\")\n);\n\n# --- !Downs\n\nDROP TABLE \"notification\";\n```\n\n\u7d9a\u3044\u3066CRUD\u51e6\u7406\u3092\u884c\u3046DAO\u3092`app/dao/NotificationDAO.scala`\u306b\u3002\n\n```scala:app/dao/NotificationDAO.scala\npackage dao\n\nimport scala.concurrent.Future\nimport java.util.Date\nimport java.util.Calendar\nimport java.sql.Timestamp\nimport javax.inject.Inject\nimport javax.inject.Singleton\nimport models.Notification\nimport play.api.db.slick.DatabaseConfigProvider\nimport play.api.libs.concurrent.Execution.Implicits.defaultContext\nimport slick.driver.JdbcProfile\n\n@Singleton\nclass NotificationDAO @Inject()(val dbConfigProvider: DatabaseConfigProvider) {\n\n  val dbConfig = dbConfigProvider.get[JdbcProfile]\n\n  import dbConfig.driver.api._\n\n  implicit def javaDateMapper = MappedColumnType.base[Date, Timestamp](\n      dt => new Timestamp(dt.getTime),\n      ts => new Date(ts.getTime)\n  )\n\n  private class NotificationTable(tag: Tag) extends Table[Notification](tag, \"notification\") {\n\n    def id = column[Long](\"id\", O.PrimaryKey, O.AutoInc)\n    def subject = column[String](\"subject\")\n    def actionDate = column[Date](\"action_date\")\n    def notificationPeriod = column[Int](\"notification_period\")\n    def summary = column[String](\"summary\")\n    def notificationDate = column[Date](\"notification_date\")\n    def isSent = column[Boolean](\"is_sent\", O.Default(false))\n    def createdDate = column[Date](\"created_date\")\n    def updatedDate = column[Date](\"updated_date\")\n\n    def * = (id.?, subject, actionDate, notificationPeriod, summary, notificationDate, isSent, createdDate, updatedDate) <> ((Notification.apply _).tupled, Notification.unapply)\n  }\n\n  private val notifications = TableQuery[NotificationTable]\n\n  def all(): Future[List[Notification]] = dbConfig.db.run(notifications.result).map(_.toList)\n\n  def byId(id: Long): Future[Option[Notification]] = dbConfig.db.run(notifications.filter(_.id === id).result.headOption)\n\n  def getNotificationList(): Future[List[Notification]] =\n    dbConfig.db.run(notifications.filter(n => (n.isSent === false) && (n.notificationDate < new Date)).result).map(_.toList)\n\n  def create(notification: Notification): Future[Int] = {\n    val n = notification.copy(\n        notificationDate = calcNotificationDate(notification.actionDate, notification.notificationPeriod),\n        isSent = false,\n        createdDate = new Date,\n        updatedDate = new Date\n    )\n    dbConfig.db.run(notifications += n)\n  }\n\n  def update(notification: Notification): Future[Int] = {\n    dbConfig.db.run(notifications.filter(_.id === notification.id).map(\n        n => (\n            n.subject,\n            n.actionDate,\n            n.notificationPeriod,\n            n.summary,\n            n.notificationDate,\n            n.updatedDate\n            )\n      ).update(\n        notification.subject,\n        notification.actionDate,\n        notification.notificationPeriod,\n        notification.summary,\n        calcNotificationDate(notification.actionDate, notification.notificationPeriod),\n        new Date\n      )\n    )\n  }\n\n  def sent(id: Long): Future[Int] = {\n    dbConfig.db.run(notifications.filter(_.id === id).map(\n        n => (n.isSent, n.updatedDate)\n      ).update(\n        true, new Date\n      )\n    )\n  }\n\n  def delete(id: Long): Future[Int] = dbConfig.db.run(notifications.filter(_.id === id).delete)\n\n  private def calcNotificationDate(actionDate: Date, notificationPeriod: Int): Date = {\n    val cl = Calendar.getInstance\n    cl.setTime(actionDate)\n    cl.add(Calendar.MINUTE, -notificationPeriod)\n    cl.getTime\n  }\n\n}\n```\n\n\u3053\u3061\u3089\u306fEbean\u3068\u7570\u306a\u308a\u3001\u304b\u306a\u308a\u306e\u30dc\u30ea\u30e5\u30fc\u30e0\u306b\u3002\u3002\u3002\n\n\u6982\u8981\u3068\u3057\u3066\u306f\u3001\n\n1. Model\u3067\u3042\u308b`Notification`\u3092\u578b\u306b\u6301\u3063\u305f`Table`\u3092\u30b9\u30fc\u30d1\u30fc\u30af\u30e9\u30b9\u306b\u3057\u3066`NotificationTable`\u3092\u4f5c\u6210\u3002\n2. \u305d\u308c\u3092\u5143\u306bJava\u5074\u306e`Finder`\u306b\u76f8\u5f53\u3059\u308b`TableQuery`\u3092\u4f5c\u6210\u3002\n3. Slick\u304c`java.util.Date`\u306b\u5bfe\u5fdc\u3057\u3066\u3044\u306a\u305f\u3081\u3001\u5bfe\u5fdc\u3057\u3066\u3044\u308b`java.sql.Timestamp`\u3068\u306e\u76f8\u4e92\u5909\u63db\u306e\u305f\u3081\u306e`implicit def javaDateMapper`\u3092\u4f5c\u6210\u3002\n4. \u5f8c\u306fCRUD\u306e\u5b9f\u88c5\n\n\u3068\u3044\u3063\u305f\u6d41\u308c\u306b\u306a\u308a\u307e\u3059\u3002\n\nEbean\u3068\u306e\u30d0\u30e9\u30f3\u30b9\u3092\u3068\u308b\u305f\u3081\u306b\u306f\u3001`NotificationTable`\u3092Model\u5074\u306b\u5b9f\u88c5\u3059\u308b\u3068\u3044\u3044\u306e\u3067\u3057\u3087\u3046\u304c\u3001Slick3.0\u3068\u30a4\u30f3\u30b8\u30a7\u30af\u30b7\u30e7\u30f3\u306e\u7d61\u307f\u3067\u306a\u3093\u3060\u304b\u5c11\u3057\u96e3\u3057\u305d\u3046\u3002\u3002\n\nSlick3.0\u306f\u7d50\u679c\u3092Future\u3067\u8fd4\u3059\u3068\u3053\u308d\u304c\u5c11\u3057\u308f\u304b\u308a\u3065\u3089\u3044\u3067\u3059\u306d\u3002\n\nSlick\u3067\u306f\u3001FRM\u306e\u601d\u60f3\u3068\u3057\u3066\u3001TableQuery\u3092Scala\u306e\u30b3\u30ec\u30af\u30b7\u30e7\u30f3\u611f\u899a\u3067\u64cd\u4f5c\u3059\u308b\u3053\u3068\u306b\u306a\u308b\u305f\u3081\u3001query\u3068\u3044\u3063\u305f\u5909\u6570\u540d\u3067\u306f\u306a\u304fnotifications\u306e\u3088\u3046\u306b\u30ea\u30b9\u30c8\u3063\u307d\u3044\u5909\u6570\u540d\u306b\u3059\u308b\u3053\u3068\u304c\u30dd\u30a4\u30f3\u30c8\u306e\u3088\u3046\u3067\u3059\u3002\uff08\u8ffd\u8a18\uff1a2015\u5e7410\u670830\u65e5\uff09\n\n# Model\u3068DAO\u306b\u3064\u3044\u3066\u306eJava\u3068Scala\u306e\u6bd4\u8f03\n\nORM\u3068FRM\u3067\u305d\u308c\u305e\u308c\u7570\u306a\u308b\u305f\u3081\u3001Java\u3068Scala\u306e\u8a00\u8a9e\u7684\u306a\u6bd4\u8f03\u3068\u3044\u3046\u3088\u308a\u306f\u3001Ebean\u3068Slick\u306e\u6bd4\u8f03\u306b\u306a\u3063\u3066\u3057\u307e\u3044\u307e\u3059\u304c\u3001\u5b9f\u611f\u3068\u3057\u3066\u306f\u5727\u5012\u7684\u306bEbean\u304c\u7c21\u5358\u3067\u3057\u305f\u3002Slick\u306f\u30c7\u30fc\u30bf\u306e\u30de\u30c3\u30d4\u30f3\u30b0\u90e8\u5206\u304c\u3084\u3084\u3053\u3057\u304f\u3001Ebean\u306f\u305d\u306e\u70b9\u3001\u81ea\u52d5\u3067\u3084\u3063\u3066\u304f\u308c\u307e\u3059\u306e\u3067\u3002\n\n~~Play\u3082Akka\u3082Java\u3068Scala\u306b\u5bfe\u5fdc\u3057\u3066\u3044\u308b\u306e\u3060\u304b\u3089\u3001ORM\u306b\u3064\u3044\u3066\u3082\u4f55\u304b\u5171\u901a\u3057\u305f\u3082\u306e\u304c\u3042\u308c\u3070\u3044\u3044\u306e\u3067\u3059\u304c\u3002\u3067\u304d\u308c\u3070Ebean\u3088\u308a\u3067\u3002~~\uff08\u524a\u9664\uff1a2015\u5e7410\u670830\u65e5\uff09\n\n\u4ee5\u524d\u306fScala\u5b9f\u88c5\u306eEbean\u3082\u3042\u3063\u305f\u3088\u3046\u3067\u3059\u304c\u3001Play\u3068\u540c\u3058Typesafe\u793e\u304cScala\u306e\u95a2\u6570\u578b\u8a00\u8a9e\u306e\u5074\u9762\u3092\u62bc\u3057\u51fa\u3057Slick\u3068\u3044\u3046FRM\u3092\u63a1\u7528\u3057\u3066\u3044\u308b\u3053\u3068\u304b\u3089\u3001Java\u3067\u306fORM\u3001Scala\u3067\u306fFRM\u3068\u3044\u3046\u9078\u629e\u306b\u306a\u308b\u306e\u3060\u3068\u601d\u3044\u307e\u3059\u3002\uff08\u8ffd\u8a18\uff1a2015\u5e7410\u670830\u65e5\uff09\n\n# Akka\u306b\u3088\u308b\u30b9\u30b1\u30b8\u30e5\u30fc\u30ea\u30f3\u30b0\uff08Java\u7de8\uff09\n\nController\u90e8\u5206\u306b\u884c\u304f\u524d\u306b\u3001\u5148\u306bAkka\u306b\u3088\u308b\u30b9\u30b1\u30b8\u30e5\u30fc\u30ea\u30f3\u30b0\u6a5f\u80fd\u3092\u5b9f\u88c5\u3057\u307e\u3059\u3002\n\n\u672c\u30a2\u30d7\u30ea\u3067\u306f\u30011\u5206\u6bce\u306b\u30b5\u30fc\u30d0\u304c\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306b\u767b\u9332\u3055\u308c\u3066\u3044\u308b\u901a\u77e5\u30b9\u30b1\u30b8\u30e5\u30fc\u30eb\u3092\u30c1\u30a7\u30c3\u30af\u3057\u3001\u8a72\u5f53\u3059\u308b\u3082\u306e\u304c\u3042\u308c\u3070\u30e1\u30fc\u30eb\u9001\u4fe1\u3092\u884c\u3044\u307e\u3059\u3002\n\n\u5f53\u521d\u3053\u306e\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u30a4\u30e1\u30fc\u30b8\u3057\u305f\u3068\u304d\u306f\u3001\u30b5\u30fc\u30d0\u5074\u306eCRON\u3092\u5229\u7528\u3057\u3066\u3001\u30c1\u30a7\u30c3\u30af\u7528\u306e\u5225\u30a2\u30d7\u30ea\u304bURL\u3092\u53e9\u304f\u3088\u3046\u306a\u65b9\u5f0f\u3092\u8003\u3048\u3066\u3044\u307e\u3057\u305f\u304c\u3001Play\u81ea\u4f53\u306b\u7d44\u307f\u8fbc\u307e\u308c\u3066\u3044\u308bTypesafe\u793e\u306eAkka\u3067\u540c\u69d8\u306e\u6a5f\u80fd\u304c\u5b9f\u73fe\u3067\u304d\u308b\u3068\u77e5\u308a\u3001\u5f53\u7136\u305d\u3061\u3089\u306e\u65b9\u5f0f\u3067\u3002\n\nAkka\u306fActor\u30e2\u30c7\u30eb\u3092\u5b9f\u88c5\u3057\u305f\u4e26\u884c\u51e6\u7406\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306e\u305f\u3081\u306e\u30e2\u30b8\u30e5\u30fc\u30eb\u306b\u306a\u308a\u307e\u3059\u3002\u4eca\u56de\u306f\u3001Actor\u306b1\u5206\u6bce\u306b\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u9001\u308a\u3001Actor\u304c\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3092\u30c1\u30a7\u30c3\u30af\u3057\u3001\u30e1\u30fc\u30eb\u306e\u9001\u4fe1\u3001\u9001\u4fe1\u30d5\u30e9\u30b0\u306e\u66f4\u65b0\u3092\u884c\u3046\u3053\u3068\u306b\u306a\u308a\u307e\u3059\u3002\n\n\u30e1\u30fc\u30eb\u9001\u4fe1\u306fPlay\u306e\u30d7\u30e9\u30b0\u30a4\u30f3\u3067\u63d0\u4f9b\u3055\u308c\u3066\u3044\u308bplay-mailer\u3092\u4f7f\u7528\u3059\u308b\u306e\u3067\u4e0b\u8a18\u8a2d\u5b9a\u3092\u8ffd\u52a0\u3057\u307e\u3059\u3002\n\n\uff11\uff0e`build.sbt`\u306b\u4e0b\u8a18\u3092\u8ffd\u8a18\n\n```scala:build.sbt\nlibraryDependencies += \"com.typesafe.play\" %% \"play-mailer\" % \"3.0.1\"\n```\n\n\uff12\uff0e`conf/application.conf`\u306b\u4e0b\u8a18\u3092\u8ffd\u8a18\n\n```scala:conf/application.conf\nplay.mailer {\n\thost=\u30e1\u30fc\u30eb\u30b5\u30fc\u30d0\u306e\u30db\u30b9\u30c8\u540d\n\tport=\u30dd\u30fc\u30c8\u756a\u53f7\n}\nnotify.mail {\n\tfrom = \"\u9001\u4fe1\u8005\u540d <\u9001\u4fe1\u5143\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9>\"\n\tto = \"\u9001\u4fe1\u5148\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\"\n}\n```\n\n\u3067\u3001`app/actors/NotifyActor.java`\u306b\u4e0b\u8a18\u306e\u5b9f\u88c5\u3092\u3002\n\n```java:app/actors/NotifyActor.java\npackage actors;\n\nimport models.Notification;\nimport dao.NotificationDAO;\n\nimport java.util.List;\nimport java.util.Date;\n\nimport play.libs.mailer.MailerClient;\nimport play.libs.mailer.Email;\nimport akka.actor.UntypedActor;\nimport akka.actor.Props;\nimport akka.japi.Creator;\nimport play.Logger;\n\nimport com.typesafe.config.Config;\nimport com.typesafe.config.ConfigFactory;\n\npublic class NotifyActor extends UntypedActor {\n\n\tpublic static Props props(final NotificationDAO dao, final MailerClient mc) {\n\t\treturn Props.create(new Creator<NotifyActor>() {\n\t\t\tprivate static final long serialVersionUID = 1L;\n\t\t\t@Override\n\t\t\tpublic NotifyActor create() throws Exception {\n\t\t\t\treturn new NotifyActor(dao, mc);\n\t\t\t}\n\t\t});\n\t}\n\n\tprivate final NotificationDAO dao;\n\tprivate final MailerClient mc;\n\tprivate final String mailFrom;\n\tprivate final String mailTo;\n\n\tpublic NotifyActor(NotificationDAO dao, MailerClient mc) {\n\t\tthis.dao = dao;\n\t\tthis.mc = mc;\n\t\tConfig config = ConfigFactory.load();\n\t\tmailFrom = config.getString(\"notify.mail.from\");\n\t\tmailTo = config.getString(\"notify.mail.to\");\n\t}\n\n\t@Override\n\tpublic void onReceive(Object message) throws Exception {\n\t\tif (message.equals(\"NOTIFY\")) {\n\t\t\tLogger.info((new Date()).toString());\n\t\t\tLogger.info(\"Message(NOTIFY) received\");\n\t\t\tList<Notification> notifications = dao.getNotificationList();\n\t\t\tLogger.info(\"notifications.size() -> \" + notifications.size());\n\t\t\tfor (Notification notification : notifications) {\n\t\t\t\tLogger.info(\"notification.id() -> \" + notification.id);\n\t\t\t\tEmail email = new Email();\n\t\t\t\temail.setSubject(notification.subject);\n\t\t\t\temail.setFrom(mailFrom);\n\t\t\t\temail.addTo(mailTo);\n\t\t\t\temail.setBodyText(notification.actionDate + \"\\n\" + notification.summary);\n\t\t\t\tmc.send(email);\n\t\t\t\tLogger.info(\"Mail sent\");\n\t\t\t\tnotification.isSent = true;\n\t\t\t\tdao.update(notification);\n\t\t\t\tLogger.info(\"Model(notification) updated\");\n\t\t\t}\n\t\t}\n\t}\n\n}\n```\n\n\u30b3\u30f3\u30b9\u30c8\u30e9\u30af\u30bf\u3067\u306f\u3001DAO\u3068\u30e1\u30fc\u30eb\u9001\u4fe1\u306e\u305f\u3081\u306e\u30e2\u30b8\u30e5\u30fc\u30eb\u3067\u3042\u308b`MailerClient`\u3092\u53d7\u3051\u53d6\u308a\u3001Play\u306e\u30b3\u30f3\u30d5\u30a3\u30b0\u30ec\u30fc\u30b7\u30e7\u30f3\u30d5\u30a1\u30a4\u30eb\u304b\u3089\u3001\u9001\u4fe1\u5143\u3068\u9001\u4fe1\u5148\u306e\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u3092\u8aad\u307f\u8fbc\u307f\u307e\u3059\u3002\n\n@Override\u3055\u308c\u305f`public void onReceive(Object)`\u3067\u5b9f\u969b\u306b\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u53d7\u4fe1\u3057\u305f\u969b\u306e\u51e6\u7406\u3092\u8a18\u8ff0\u3057\u307e\u3059\u3002\u51e6\u7406\u306e\u6d41\u308c\u3068\u3057\u3066\u306f\u3001\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306e\u30c1\u30a7\u30c3\u30af\u3001\u30e1\u30fc\u30eb\u9001\u4fe1\u3001\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306e\u66f4\u65b0\u3068\u306a\u308a\u307e\u3059\u3002\n\nActor\u306f\u5b9f\u969b\u306b\u5229\u7528\u3059\u308b\u969b\u306f`ActorRef`\u3068\u3044\u3046\u53c2\u7167\u306b\u5bfe\u3057\u3066\u30b9\u30b1\u30b8\u30e5\u30fc\u30eb\u306e\u958b\u59cb\u3092\u6307\u793a\u3057\u307e\u3059\u306e\u3067\u3001\u30b3\u30f3\u30b9\u30c8\u30e9\u30af\u30bf\u306b\u5f15\u6570\u3092\u6301\u305f\u305b\u308b\u305f\u3081\u3001`public static Props props(NotificationDAO, MailerClient)`\u3092\u5b9f\u88c5\u3057\u3066\u3044\u307e\u3059\u3002\n\n# Akka\u306b\u3088\u308b\u30b9\u30b1\u30b8\u30e5\u30fc\u30ea\u30f3\u30b0\uff08Scala\u7de8\uff09\n\n\u3053\u3061\u3089\u3082\u30e1\u30fc\u30eb\u9001\u4fe1\u306fPlay\u306e\u30d7\u30e9\u30b0\u30a4\u30f3\u3067\u63d0\u4f9b\u3055\u308c\u3066\u3044\u308bplay-mailer\u3092\u4f7f\u7528\u3059\u308b\u306e\u3067\u4e0b\u8a18\u8a2d\u5b9a\u3092\u8ffd\u52a0\u3057\u307e\u3059\u3002\n\n\uff11\uff0e`build.sbt`\u306b\u4e0b\u8a18\u3092\u8ffd\u8a18\n\n```scala:build.sbt\nlibraryDependencies += \"com.typesafe.play\" %% \"play-mailer\" % \"3.0.1\"\n```\n\n\uff12\uff0e`conf/application.conf`\u306b\u4e0b\u8a18\u3092\u8ffd\u8a18\n\n```scala:conf/application.conf\nplay.mailer {\n\thost=\u30e1\u30fc\u30eb\u30b5\u30fc\u30d0\u306e\u30db\u30b9\u30c8\u540d\n\tport=\u30dd\u30fc\u30c8\u756a\u53f7\n}\nnotify.mail {\n\tfrom = \"\u9001\u4fe1\u8005\u540d <\u9001\u4fe1\u5143\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9>\"\n\tto = \"\u9001\u4fe1\u5148\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\"\n}\n```\n\nActor\u3092Scala\u3067\u5b9f\u88c5\u3059\u308b\u3068\u3001\u4e0b\u8a18`app/actors/NotifyActor.scala`\u306e\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\n\n```scala:app/actors/NotifyActor.scala\npackage actors\n\nimport dao.NotificationDAO\nimport akka.actor._\nimport javax.inject.Inject\nimport play.api.libs.concurrent.Execution.Implicits.defaultContext\nimport play.api.libs.mailer.{MailerClient, Email}\nimport com.typesafe.config.ConfigFactory\n\nimport play.Logger\n\nobject NotifyActor {\n  def props(dao: NotificationDAO, mc: MailerClient) = Props(classOf[NotifyActor], dao, mc)\n}\n\nclass NotifyActor(dao: NotificationDAO, mc: MailerClient) extends Actor {\n\n  val config = ConfigFactory.load()\n  val mailFrom = config.getString(\"notify.mail.from\")\n  val mailTo = config.getString(\"notify.mail.to\")\n\n  def receive = {\n    case \"NOTIFY\" =>\n      Logger.info((new java.util.Date).toString)\n      Logger.info(\"Message(NOTIFY) received\")\n      dao.getNotificationList().map { notifications =>\n        Logger.info(\"notifications.size -> \" + notifications.size)\n        for (notification <- notifications) {\n          Logger.info(\"notification.id -> \" + notification.id)\n          val email = Email(\n            notification.subject,\n            mailFrom,\n            Seq(mailTo),\n            bodyText = Some(notification.actionDate + \"\\n\" + notification.summary),\n            bodyHtml = Some(\"\")\n          )\n          mc.send(email)\n          Logger.info(\"Mail sent\")\n          dao.sent(notification.id.getOrElse(0))\n          Logger.info(\"Model(notification) updated\")\n        }\n      }\n  }\n}\n```\n\n\u3084\u3063\u3066\u3044\u308b\u3053\u3068\u306f\u307b\u307c\u540c\u3058\u3067\u3059\u304c\u3001\u8a18\u6cd5\u306e\u5dee\u3067\u3001\u304b\u306a\u308a\u30b3\u30f3\u30d1\u30af\u30c8\u306b\u4ed5\u4e0a\u304c\u3063\u3066\u3044\u307e\u3059\u3002\u30af\u30e9\u30b9\u5b9a\u7fa9\u306b\u30b3\u30f3\u30b9\u30c8\u30e9\u30af\u30bf\u30e1\u30bd\u30c3\u30c9\u304c\u8a18\u8ff0\u3067\u304d\u3001\u521d\u671f\u51e6\u7406\u3092\u30e1\u30f3\u30d0\u5b9a\u7fa9\u306e\u3068\u3053\u308d\u306b\u8a18\u8ff0\u3067\u304d\u308b\u306e\u304c\u5927\u304d\u3044\u306e\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u3002\n\n# Akka\u306b\u3064\u3044\u3066\u306eJava\u3068Scala\u306e\u6bd4\u8f03\n\n\u3053\u3061\u3089\u306f\u305d\u308c\u307b\u3069\u9055\u3044\u304c\u306a\u3044\u3088\u3046\u3067\u3059\u304c\u3001\u3084\u306f\u308aScala\u306e\u65b9\u304c\u30b3\u30f3\u30d1\u30af\u30c8\u306b\u8a18\u8ff0\u3067\u304d\u308b\u6c17\u304c\u3002\u5f37\u529b\u306a\u578b\u63a8\u8ad6\u306e\u304a\u304b\u3052\u3067\u3001Java\u306e\u3088\u3046\u306b\u5168\u3066\u3092\u8a18\u8ff0\u3059\u308b\u5fc5\u8981\u304c\u306a\u3044\u3067\u3059\u3057\u3002\n\n# Controller\u306e\u4f5c\u6210\uff08Java\u7de8\uff09\n\n\u6b21\u306bController\u90e8\u5206\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\u307e\u305a\u306fJava\u304b\u3089\u3002\n\n`app/controllers/Application.java`\u306b\u4e0b\u8a18\u306e\u5b9f\u88c5\u3092\u3002\n\n```java:app/controllers/Application.java\npackage controllers;\n\nimport dao.NotificationDAO;\nimport models.Notification;\nimport actors.NotifyActor;\n\nimport java.util.Calendar;\nimport java.util.List;\nimport java.util.concurrent.TimeUnit;\n\nimport javax.inject.Inject;\nimport javax.inject.Singleton;\n\nimport akka.actor.ActorRef;\nimport akka.actor.ActorSystem;\n\nimport scala.concurrent.duration.Duration;\n\nimport play.libs.mailer.MailerClient;\nimport play.mvc.Controller;\nimport play.mvc.Result;\nimport play.data.Form;\nimport play.libs.Json;\nimport views.html.*;\nimport play.Logger;\n\n@Singleton\npublic class Application extends Controller {\n\n\t@Inject NotificationDAO dao;\n\t@Inject MailerClient mc;\n\tprivate boolean isInit = false;\n\n\tsynchronized public Result init() {\n\t\tif (!isInit) {\n\t\t\tLogger.info(\"IN init()\");\n\t\t\tLogger.info(\"start Actaor\");\n\t\t\tActorSystem system = ActorSystem.create(\"myActor\");\n\t\t\tActorRef notifyActor = system.actorOf(NotifyActor.props(dao, mc));\n\t\t\tCalendar cl = Calendar.getInstance();\n\t\t\tcl.set(Calendar.SECOND, 0);\n\t\t\tcl.set(Calendar.MILLISECOND, 0);\n\t\t\tcl.add(Calendar.MINUTE, 1);\n\t\t\tsystem.scheduler().schedule(\n\t\t\t\tDuration.create(cl.getTimeInMillis() - System.currentTimeMillis(), TimeUnit.MILLISECONDS),\n\t\t\t\tDuration.create(1, TimeUnit.MINUTES),\n\t\t\t\tnotifyActor,\n\t\t\t\t\"NOTIFY\",\n\t\t\t\tsystem.dispatcher(),\n\t\t\t\tnull\n\t\t\t);\n\t\t\tLogger.info(\"Actor has started\");\n\t\t\tLogger.info(\"OUT init()\");\n\t\t\tisInit = true;\n\t\t}\n\t\treturn ok(index.render(\"\"));\n\t}\n\n\tpublic Result index() {\n\t\treturn ok(index.render(\"\"));\n\t}\n\n\tpublic Result add() {\n\t\tForm<Notification> form = Form.form(Notification.class);\n\t\treturn ok(register.render(\"\", form));\n\t}\n\n\tpublic Result create() {\n\t\tForm<Notification> form = Form.form(Notification.class).bindFromRequest();\n\t\tif (!form.hasErrors()) {\n\t\t\tNotification notification = form.get();\n\t\t\tdao.create(notification);\n\t\t\treturn ok(index.render(\"\u767b\u9332\u3057\u307e\u3057\u305f\"));\n\t\t} else {\n\t\t\treturn badRequest(register.render(\"ERROR\", form));\n\t\t}\n\t}\n\n\tpublic Result getNotifications() {\n\t\tList<Notification> notifications = dao.all();\n\t\treturn ok(list.render(\"\", notifications));\n\t}\n\n\tpublic Result read(Long id) {\n\t\tNotification notification = dao.byId(id);\n\t\tif (notification != null) {\n\t\t\tForm form = Form.form(Notification.class).fill(notification);\n\t\t\treturn ok(edit.render(\"\", form));\n\t\t} else {\n\t\t\tList<Notification> notifications = dao.all();\n\t\t\treturn badRequest(list.render(\"ERROR\", notifications));\n\t\t}\n\t}\n\n\tpublic Result update() {\n\t\tForm<Notification> form = Form.form(Notification.class).bindFromRequest();\n\t\tif (!form.hasErrors()) {\n\t\t\tNotification notification = form.get();\n\t\t\tdao.update(notification);\n\t\t\tList<Notification> notifications = dao.all();\n\t\t\treturn ok(list.render(\"\u66f4\u65b0\u3057\u307e\u3057\u305f\", notifications));\n\t\t} else {\n\t\t\treturn badRequest(edit.render(\"ERROR\", form));\n\t\t}\n\t}\n\n\tpublic Result delete(Long id) {\n\t\tNotification notification = dao.byId(id);\n\t\tif (notification != null) {\n\t\t\tdao.delete(notification);\n\t\t\tList<Notification> notifications = dao.all();\n\t\t\treturn ok(list.render(\"\u524a\u9664\u3057\u307e\u3057\u305f\", notifications));\n\t\t} else {\n\t\t\tList<Notification> notifications = dao.all();\n\t\t\treturn badRequest(list.render(\"ERROR\", notifications));\n\t\t}\n\t}\n}\n```\n\n\u3084\u3063\u3066\u3044\u308b\u3053\u3068\u306f\u5404\u753b\u9762\u9077\u79fb\u3068DAO\u3092\u4ecb\u3057\u305fCRUD\u51e6\u7406\u3067\u3059\u3002\u521d\u671f\u51e6\u7406\u3068\u3057\u3066\u5148\u307b\u3069\u5b9f\u88c5\u3057\u305fActor\u30921\u5206\u5358\u4f4d\u3067\u8d77\u52d5\u3057\u3066\u3044\u307e\u3059\u3002\n\nPlay2.3\u307e\u3067\u306f\u521d\u671f\u51e6\u7406\u3092`GlobalSettings`\u3092\u7d99\u627f\u3057\u305f\u30af\u30e9\u30b9\u3067\u884c\u3063\u3066\u3044\u305f\u306e\u3067\u3059\u304c\u3001Play2.4\u304b\u3089\u306f\u63a8\u5968\u3055\u308c\u3066\u304a\u3089\u305a\u3001\u4ee3\u66ff\u624b\u6bb5\u3082\u308f\u304b\u3089\u306a\u304b\u3063\u305f\u305f\u3081\u3001`init()`\u3092\u5916\u90e8\u304b\u3089\u53e9\u304f\u3088\u3046\u306a\u5c11\u3057\u82e6\u3057\u3044\u5b9f\u88c5\u306b\u306a\u3063\u3066\u3044\u307e\u3059\u3002\n\n\u305d\u308c\u305e\u308c\u306e\u30e1\u30bd\u30c3\u30c9\u306e\u6982\u8981\u306f\u4e0b\u8a18\u306e\u901a\u308a\u3068\u306a\u308a\u307e\u3059\u3002\n\n- `index()`\u3000\u30c8\u30c3\u30d7\u30da\u30fc\u30b8\uff08\u30e1\u30cb\u30e5\u30fc\u30da\u30fc\u30b8\uff09\u306e\u8868\u793a\n- `add()`\u3000\u767b\u9332\u753b\u9762\u306e\u8868\u793a\n- `create()`\u3000\u767b\u9332\u753b\u9762\u304b\u3089\u306e\u5165\u529b\u5185\u5bb9\u3092\u53d7\u3051\u767b\u9332\u51e6\u7406\n- `getNotifications()`\u3000\u4e00\u89a7\u753b\u9762\u306e\u8868\u793a\n- `read(Long)`\u3000\u7de8\u96c6\u753b\u9762\u306e\u8868\u793a\n- `update()`\u3000\u7de8\u96c6\u753b\u9762\u304b\u3089\u306e\u5165\u529b\u5185\u5bb9\u3092\u53d7\u3051\u66f4\u65b0\u51e6\u7406\n- `delete(Long)`\u3000\u524a\u9664\u51e6\u7406\n\n`bindFromRequest()`\u306f\u30d5\u30a9\u30fc\u30e0\u306e\u5165\u529b\u5185\u5bb9\u3092Model\u306b\u30de\u30c3\u30d4\u30f3\u30b0\u3057\u3066\u304f\u308c\u308b\u51e6\u7406\u3067\u3001Ebean\u306e\u5834\u5408\u3001\u7279\u306b\u4f55\u3082\u8003\u3048\u306a\u304f\u3066\u3082\u3001\u305d\u308c\u306a\u308a\u306b\u9069\u5207\u306b\u30de\u30c3\u30d4\u30f3\u30b0\u3057\u3066\u304f\u308c\u308b\u3088\u3046\u3067\u3059\u3002\n\n# Controller\u306e\u4f5c\u6210\uff08Scala\u7de8\uff09\n\n\u7d9a\u3044\u3066Scala\u306eController\u306e\u4f5c\u6210\u3067\u3059\u3002\n\n`app/controllers/Application.scala`\u306b\u4e0b\u8a18\u306e\u5b9f\u88c5\u3092\u3002\n\n```scala:app/controllers/Application.scala\npackage controllers\n\nimport scala.concurrent.Future\n\nimport dao.NotificationDAO\nimport actors.NotifyActor\nimport models.Notification\n\nimport java.util.concurrent.TimeUnit\nimport java.util.Calendar\nimport java.util.Date\n\nimport javax.inject.Inject\nimport javax.inject.Singleton\n\nimport akka.actor._\nimport scala.concurrent.duration._\nimport scala.concurrent.ExecutionContext.Implicits.global\n\nimport play.api.data.Form\nimport play.api.data.Forms.mapping\nimport play.api.data.Forms.{longNumber,text,date,number,nonEmptyText,optional}\nimport play.api.libs.concurrent.Execution.Implicits.defaultContext\nimport play.api.mvc.Action\nimport play.api.mvc.Controller\n\nimport play.api.libs.mailer._\n\nimport play.api.i18n.MessagesApi\nimport play.api.i18n.I18nSupport\n\nimport play.api.libs.json.Json\n\nimport play.Logger;\n\n@Singleton\nclass Application @Inject() (val messagesApi: MessagesApi, dao: NotificationDAO, system: ActorSystem, mc: MailerClient) extends Controller with I18nSupport {\n\n  val notificationForm = Form(\n    mapping(\n      \"id\" -> optional(longNumber),\n      \"subject\" -> nonEmptyText,\n      \"actionDate\" -> date(\"yyyy-MM-dd'T'HH:mm\"),\n      \"notificationPeriod\" -> number,\n      \"summary\" -> text\n    )(formapply)(formunapply)\n  )\n  private def formapply(id: Option[Long], subject: String, actionDate: Date, notificationPeriod: Int, summary: String) =\n    new Notification(id, subject, actionDate, notificationPeriod, summary, new Date, false, new Date, new Date)\n  private def formunapply(n: Notification) = Some((n.id, n.subject, n.actionDate, n.notificationPeriod, n.summary))\n\n  Logger.info(\"start Actaor\")\n  val notifyActor = system.actorOf(NotifyActor.props(dao, mc), \"notify-actor\")\n  var cl = Calendar.getInstance\n  cl.set(Calendar.SECOND, 0)\n  cl.set(Calendar.MILLISECOND, 0)\n  cl.add(Calendar.MINUTE, 1)\n  system.scheduler.schedule(\n      (cl.getTimeInMillis - System.currentTimeMillis).milliseconds,\n      1.minutes,\n      notifyActor,\n      \"NOTIFY\"\n  )\n  Logger.info(\"Actor has started\")\n\n  def index = Action {\n    Ok(views.html.index(\"\"))\n  }\n\n  def add = Action {\n    Ok(views.html.register(\"\", notificationForm))\n  }\n\n  def create = Action.async { implicit request =>\n    notificationForm.bindFromRequest.fold(\n        formWithErrors => {\n          Future(BadRequest(views.html.register(\"ERROR\", formWithErrors)))\n        },\n        notification => {\n          dao.create(notification).map(cnt => Ok(views.html.index(\"\u767b\u9332\u3057\u307e\u3057\u305f\")))\n        }\n    )\n  }\n\n  def getNotifications = Action.async {\n    dao.all().map(notifications => Ok(views.html.list(\"\", notifications)))\n  }\n\n  def read(id: Long) = Action.async {\n    dao.byId(id).flatMap(option =>\n      option match {\n        case Some(notification) => Future(Ok(views.html.edit(\"\", notificationForm.fill(notification))))\n        case None => dao.all().map(notifications => BadRequest(views.html.list(\"ERROR\", notifications)))\n      }\n    )\n  }\n\n  def update = Action.async { implicit request =>\n    notificationForm.bindFromRequest.fold(\n        formWithErrors => {\n          Future(BadRequest(views.html.edit(\"ERROR\", formWithErrors)))\n        },\n        notification => {\n          dao.update(notification).flatMap(cnt =>\n            if (cnt != 0) dao.all().map(notifications => Ok(views.html.list(\"\u66f4\u65b0\u3057\u307e\u3057\u305f\", notifications)))\n            else dao.all().map(notifications => BadRequest(views.html.edit(\"ERROR\", notificationForm.fill(notification))))\n          )\n        }\n    )\n  }\n\n  def delete(id: Long) = Action.async {\n    dao.delete(id).flatMap(cnt =>\n      if (cnt != 0) dao.all().map(notifications => Ok(views.html.list(\"\u524a\u9664\u3057\u307e\u3057\u305f\", notifications)))\n      else dao.all().map(notifications => BadRequest(views.html.list(\"ERROR\", notifications)))\n    )\n  }\n}\n```\n\nScala\u306e\u5834\u5408\u3001Slick\u304c\u305d\u3053\u307e\u3067\u9811\u5f35\u3063\u3066\u304f\u308c\u306a\u3044\u306e\u3067\u3001\u30d5\u30a9\u30fc\u30e0\u3068Model\u306e\u30de\u30c3\u30d4\u30f3\u30b0\u306b\u3064\u3044\u3066\u591a\u5c11\u306e\u5b9f\u88c5\u304c\u5fc5\u8981\u3068\u306a\u308a\u307e\u3059\u3002\n\u4e2d\u3067\u3082\u3001apply\u30e1\u30bd\u30c3\u30c9\u3068unapply\u30e1\u30bd\u30c3\u30c9\u306e\u7b87\u6240\u304c\u5c11\u3005\u96e3\u3057\u304f\u3001\u30d5\u30a9\u30fc\u30e0\u306e\u9805\u76ee\u3068\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\uff08Model\uff09\u306e\u9805\u76ee\u304c\u540c\u3058\u3067\u3042\u308c\u3070\u3001Case\u30af\u30e9\u30b9\u306e\u30c7\u30d5\u30a9\u30eb\u30c8\u306eapply\u30e1\u30bd\u30c3\u30c9\u3068unapply\u30e1\u30bd\u30c3\u30c9\u3092\u305d\u306e\u307e\u307e\u4f7f\u3048\u308b\u306e\u3067\u3059\u304c\u3001\u9805\u76ee\u304c\u7570\u306a\u308b\u5834\u5408\u306b\u306f\u3001\u6050\u3089\u304f\u4eca\u56de\u306e\u3088\u3046\u306b\u81ea\u529b\u3067\u5b9f\u88c5\u3059\u308b\u5fc5\u8981\u304c\u3042\u308b\u3082\u306e\u3068\u601d\u308f\u308c\u307e\u3059\u3002\n\n\u4ed6\u306e\u7b87\u6240\u306f\u3001\u5404\u753b\u9762\u9077\u79fb\u3068DAO\u3092\u4ecb\u3057\u305fCRUD\u51e6\u7406\u3067\u3059\u3002\u521d\u671f\u51e6\u7406\u3068\u3057\u3066\u5148\u307b\u3069\u5b9f\u88c5\u3057\u305fActor\u30921\u5206\u5358\u4f4d\u3067\u8d77\u52d5\u3057\u3066\u3044\u307e\u3059\u3002\n\nScala\u306f\u521d\u671f\u51e6\u7406\u3092\u30e1\u30f3\u30d0\u5b9a\u7fa9\u306e\u3068\u3053\u308d\u306b\u8a18\u8ff0\u3067\u304d\u308b\u306e\u3067\u3001Java\u306e\u3088\u3046\u306b\u5225\u9014`init()`\u3092\u5916\u90e8\u304b\u3089\u53e9\u304f\u3088\u3046\u306a\u5b9f\u88c5\u306f\u4e0d\u8981\u3068\u306a\u308a\u307e\u3059\u3002\uff08\u305f\u3060\u3001\u521d\u671f\u51e6\u7406\u306f\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u8d77\u52d5\u6642\u3067\u306f\u306a\u304f\u3001\u3044\u305a\u308c\u304b\u306e\u30da\u30fc\u30b8\u304c\u30a2\u30af\u30bb\u30b9\u3055\u308c\u305f\u30bf\u30a4\u30df\u30f3\u30b0\u3067\u306e\u8d77\u52d5\u3068\u306a\u308a\u307e\u3059\u3002\uff09\n\n\u305d\u308c\u305e\u308c\u306e\u30e1\u30bd\u30c3\u30c9\u306e\u6982\u8981\u306f\u4e0b\u8a18\u306e\u901a\u308a\u3068\u306a\u308a\u307e\u3059\u3002\n\n- `index`\u3000\u30c8\u30c3\u30d7\u30da\u30fc\u30b8\uff08\u30e1\u30cb\u30e5\u30fc\u30da\u30fc\u30b8\uff09\u306e\u8868\u793a\n- `add`\u3000\u767b\u9332\u753b\u9762\u306e\u8868\u793a\n- `create`\u3000\u767b\u9332\u753b\u9762\u304b\u3089\u306e\u5165\u529b\u5185\u5bb9\u3092\u53d7\u3051\u767b\u9332\u51e6\u7406\n- `getNotifications`\u3000\u4e00\u89a7\u753b\u9762\u306e\u8868\u793a\n- `read(Long)`\u3000\u7de8\u96c6\u753b\u9762\u306e\u8868\u793a\n- `update`\u3000\u7de8\u96c6\u753b\u9762\u304b\u3089\u306e\u5165\u529b\u5185\u5bb9\u3092\u53d7\u3051\u66f4\u65b0\u51e6\u7406\n- `delete(Long)`\u3000\u524a\u9664\u51e6\u7406\n\n`bindFromRequest`\u306f\u30d5\u30a9\u30fc\u30e0\u306e\u5165\u529b\u5185\u5bb9\u3092Model\u306b\u30de\u30c3\u30d4\u30f3\u30b0\u3057\u3066\u304f\u308c\u308b\u51e6\u7406\u3067\u3001Ebean\u3068\u7570\u306a\u308a\u3001\u5148\u307b\u3069\u306eapply\u30e1\u30bd\u30c3\u30c9\u3068unapply\u30e1\u30bd\u30c3\u30c9\u306e\u5b9f\u88c5\u306b\u5f93\u3063\u3066\u30de\u30c3\u30d4\u30f3\u30b0\u3092\u884c\u3044\u307e\u3059\u3002\n\n# Controller\u306b\u3064\u3044\u3066\u306eJava\u3068Scala\u306e\u6bd4\u8f03\n\n\u3053\u3061\u3089\u3082Model\u3068\u540c\u69d8\u3001Ebean\u3068Slick\u306e\u5dee\u306e\u3088\u3046\u306b\u611f\u3058\u307e\u3059\u304c\u3001Scala\u7684\u306b\u306f\u3001\u30d5\u30a9\u30fc\u30e0\u306e\u30de\u30c3\u30d4\u30f3\u30b0\u306e\u8a18\u8ff0\u306fScala\u3089\u3057\u3044\u8a18\u8ff0\u306e\u3088\u3046\u3067\u3059\u306e\u3067\u3001\u6587\u5316\u306e\u5dee\u306e\u3068\u3044\u3046\u3053\u3068\u306a\u306e\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u3002\n\nPlay2.4\u304b\u3089`GlobalSettings`\u304c\u63a8\u5968\u3055\u308c\u306a\u304f\u306a\u3063\u305f\u305f\u3081\u3001\u521d\u671f\u51e6\u7406\u3092\u884c\u3046\u306b\u969b\u3057\u3001Java\u3067\u306f\u4ee3\u66ff\u624b\u6bb5\u304c\u898b\u3064\u304b\u3089\u305a\u3001\u305d\u306e\u3042\u305f\u308a\u306fScala\u306e\u65b9\u304c\u5bfe\u5fdc\u3057\u3084\u3059\u304b\u3063\u305f\u3067\u3059\u3002\n\n# View\u306e\u4f5c\u6210\uff08Java\u3001Scala\u5171\u901a\uff09\n\nView\u306fScala\u306e\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u306e\u305f\u3081\u3001Java\u3068Scala\u3067\u540c\u3058\u5b9f\u88c5\u306b\u306a\u308a\u307e\u3059\u3002\n\n\u552f\u4e00`register.scala.html`\u3068`edit.scala.html`\u306e1\u884c\u76ee\u306e`(implicit messages: Messages)`\u306f\u3001Java\u306e\u5834\u5408\u3001\u524a\u9664\u3057\u306a\u3051\u308c\u3070\u3044\u3051\u307e\u305b\u3093\u3002\n\n```scala:app/views/main.scala.html\n@(title: String)(content: Html)\n\n<!DOCTYPE html>\n\n<html lang=\"jp\">\n\t<head>\n\t\t<title>@title</title>\n\t\t<link rel=\"stylesheet\" media=\"screen\" href=\"@routes.Assets.versioned(\"stylesheets/main.css\")\">\n\t\t<link rel=\"shortcut icon\" type=\"image/png\" href=\"@routes.Assets.versioned(\"images/favicon.png\")\">\n\t\t<meta name=\"viewport\" content=\"width=device-width\">\n\t</head>\n\t<body>\n\t\t@content\n\t</body>\n</html>\n```\n```scala:app/views/index.scala.html\n@(message: String)\n\n@main(\"\u30e1\u30cb\u30e5\u30fc\u753b\u9762\") {\n\n\t<h1>\u30e1\u30cb\u30e5\u30fc\u753b\u9762</h1>\n\t<p>@message</p>\n\n\t<p><a href=\"/add\">[\u767b\u9332]</a></p>\n\t<p><a href=\"/list\">[\u4e00\u89a7]</a></p>\n\n}\n```\n```scala:app/views/register.scala.html\n@(message: String, form1: Form[models.Notification])(implicit messages: Messages)\n\n@main(\"\u767b\u9332\u753b\u9762\") {\n\n\t<h1>\u767b\u9332\u753b\u9762</h1>\n\t<p>@message</p>\n\n\t@helper.form(action=routes.Application.create) {\n\t\t@(helper.inputText (\n\t\t\tfield = form1(\"subject\"),\n\t\t\t'_label -> \"\u4ef6\u540d\"\n\t\t))\n\t\t@helper.input(form1(\"actionDate\"), '_label -> \"\u65e5\u6642\") { (id, name, value, args) =>\n\t\t    <input type=\"datetime-local\" name=\"@name\" id=\"@id\" value=\"@value\" @toHtmlArgs(args)>\n\t\t}\n\t\t@(helper.select (\n\t\t\tfield = form1(\"notificationPeriod\"),\n\t\t\toptions = Seq(\"1\" -> \"1\u5206\u524d\", \"10\" -> \"10\u5206\u524d\", \"15\" -> \"15\u5206\u524d\", \"20\" -> \"20\u5206\u524d\", \"25\" -> \"25\u5206\u524d\"\n\t\t\t\t\t\t, \"30\" -> \"30\u5206\u524d\", \"45\" -> \"45\u5206\u524d\", \"60\" -> \"1\u6642\u9593\u524d\"),\n\t\t\targs = 'size -> 1,\n\t\t\t'_label -> \"\u901a\u77e5\u6642\u9593\"\n\t\t))\n\t\t@(helper.textarea (\n\t\t\tfield = form1(\"summary\"),\n\t\t\t'_label -> \"\u8aac\u660e\"\n\t\t))\n\t    <button>\u767b\u9332</button>\n\t}\n\n\t<p><a href=\"/\">[HOME]</a></p>\n}\n```\n```scala:app/views/list.scala.html\n@(message: String, notifications: List[models.Notification])\n\n@main(\"\u4e00\u89a7\u753b\u9762\") {\n\n\t<h1>\u4e00\u89a7\u753b\u9762</h1>\n\t<p>@message</p>\n\n\t<ul id=\"notifyItems\">\n\t@for(notification <- notifications) {\n\t\t<li>\n\t\t<a href=\"/item/@notification.id\">[\u7de8\u96c6]</a>\n\t\t<a href=\"/remove/@notification.id\">[\u524a\u9664]</a>\n\t\t@notification.subject\n\t\t</li>\n\t}\n\t</ul>\n\n\t<p><a href=\"/\">[HOME]</a></p>\n}\n```\n```scala:app/views/edit.scala.html\n@(message: String, form1: Form[models.Notification])(implicit messages: Messages)\n\n@main(\"\u7de8\u96c6\u753b\u9762\") {\n\n\t<h1>\u7de8\u96c6\u753b\u9762</h1>\n\t<p>@message</p>\n\n\t@helper.form(action=routes.Application.update) {\n\t\t<input type=\"hidden\" name=\"id\" value=\"@form1(\"id\").value\">\n\t\t@(helper.inputText (\n\t\t\tfield = form1(\"subject\"),\n\t\t\t'_label -> \"\u4ef6\u540d\"\n\t\t))\n\t\t@helper.input(form1(\"actionDate\"), '_label -> \"\u65e5\u6642\") { (id, name, value, args) =>\n\t\t    <input type=\"datetime-local\" name=\"@name\" id=\"@id\" value=\"@value\" @toHtmlArgs(args)>\n\t\t}\n\t\t@(helper.select (\n\t\t\tfield = form1(\"notificationPeriod\"),\n\t\t\toptions = Seq(\"1\" -> \"1\u5206\u524d\", \"10\" -> \"10\u5206\u524d\", \"15\" -> \"15\u5206\u524d\", \"20\" -> \"20\u5206\u524d\", \"25\" -> \"25\u5206\u524d\"\n\t\t\t\t\t\t, \"30\" -> \"30\u5206\u524d\", \"45\" -> \"45\u5206\u524d\", \"60\" -> \"1\u6642\u9593\u524d\"),\n\t\t\targs = 'size -> 1,\n\t\t\t'_label -> \"\u901a\u77e5\u6642\u9593\"\n\t\t))\n\t\t@(helper.textarea (\n\t\t\tfield = form1(\"summary\"),\n\t\t\t'_label -> \"\u8aac\u660e\"\n\t\t))\n\t    <button>\u66f4\u65b0</button>\n\t}\n\n\t<p><a href=\"/list\">[\u4e00\u89a7]</a></p>\n\t<p><a href=\"/\">[HOME]</a></p>\n}\n```\n\n# Routes\u306e\u4f5c\u6210\uff08Java\u3001Scala\u5171\u901a\uff09\n\n\u6700\u5f8c\u306bView\u3068Controller\u306e\u30eb\u30fc\u30c8\u30de\u30c3\u30d4\u30f3\u30b0\u3092\u884c\u3044\u307e\u3059\u3002\n\n```scala:conf/routes\n# Routes\n# This file defines all application routes (Higher priority routes first)\n# ~~~~\n\n# Home page\n#GET     /init                       controllers.Application.init\nGET     /                           controllers.Application.index\nGET     /add                        controllers.Application.add\nPOST    /create                     controllers.Application.create\nGET     /item/:id                   controllers.Application.read(id: Long)\nPOST    /update                     controllers.Application.update\nGET     /remove/:id                 controllers.Application.delete(id: Long)\nGET     /list                       controllers.Application.getNotifications\n\n# Map static resources from the /public folder to the /assets URL path\nGET     /assets/*file               controllers.Assets.versioned(path=\"/public\", file: Asset)\n```\n\nJava\u306e\u5834\u5408\u306f\u3001\u30a2\u30af\u30bf\u30fc\u8d77\u52d5\u306e\u305f\u3081\u306b\u3001\u30b3\u30e1\u30f3\u30c8\u30a2\u30a6\u30c8\u3057\u3066\u3044\u308binit\u51e6\u7406\u3092\u547c\u3073\u51fa\u3059\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\n\u4e00\u5fdc\u30d1\u30fc\u30bd\u30ca\u30eb\u30e6\u30fc\u30b9\u306a\u306e\u3067\u3001GET\u3067\u524a\u9664\u51e6\u7406\u3092\u884c\u3063\u3066\u3044\u308b\u90e8\u5206\u306b\u306f\u76ee\u3092\u3064\u3080\u3063\u3066\u304f\u3060\u3055\u3044\u3002\u3002\n\n\u5f8c\u3001\u672c\u30a2\u30d7\u30ea\u306f\u30ac\u30e9\u30db\u304b\u3089\u306e\u5229\u7528\u3092\u60f3\u5b9a\u3057\u3066\u3044\u308b\u306e\u3067\u3001\u4e0b\u8a18\u306e\u3088\u3046\u306aCSS\u3092\u8a2d\u5b9a\u3057\u3066\u3044\u307e\u3059\u3002\n\n```css:public/stylesheets/main.css\nbody {\n\tfont-size: 16pt;\n\tcolor: #000066;\n}\nbutton {\n\tfont-size: 14pt;\n\tpadding: 5px 20px;\n}\nh1 {\n\tfont-size: 20pt;\n\tfont-weight: bold;\n\tbackground-color: #6666aa;\n\tcolor: #ccccff;\n\tpadding: 3px;\n}\ninput#subject {\n\twidth: 280px;\n\theight: 30px;\n}\ninput#actionDate {\n\theight: 30px;\n}\nselect#notificationPeriod {\n\theight: 30px;\n}\ntextarea#summary {\n\twidth: 280px;\n}\n```\n\n# \u3055\u3044\u3054\u306b\n\nJava\u3068Scala\u306e\u4e21\u65b9\u306e\u30bd\u30fc\u30b9\u3092\u63b2\u8f09\u3057\u305f\u305f\u3081\u3001\u304b\u306a\u308a\u306e\u884c\u6570\u3068\u306a\u3063\u3066\u3057\u307e\u3044\u307e\u3057\u305f\u304c\u3001Play2.4\u3067\u306e\u7c21\u5358\u306aCRUD\u51e6\u7406\uff08\uff0bAkka\uff09\u306b\u3064\u3044\u3066\u306e\u5b9f\u88c5\u3067\u3057\u305f\u3002\n\n\u4eca\u56de\u306eWeb\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u4f5c\u6210\u3092\u901a\u3058\u3001\u6700\u3082Play\u304c\u512a\u308c\u3066\u3044\u308b\u3068\u611f\u3058\u305f\u70b9\u306f\u3001View\u3060\u3051\u3067\u306a\u304fModel\u3084Controller\u3001\u306f\u305f\u307e\u305fRoutes\u306b\u81f3\u308b\u307e\u3067\u3059\u3079\u3066\u304c\u52d5\u7684\u30b3\u30f3\u30d1\u30a4\u30eb\u306e\u5bfe\u8c61\u3068\u306a\u3063\u3066\u3044\u308b\u3053\u3068\u3067\u3059\u3002\n\n\u9759\u7684\u306a\u30b3\u30f3\u30d1\u30a4\u30eb\u3068\u52d5\u7684\u306a\u30b3\u30f3\u30d1\u30a4\u30eb\u304c\u6df7\u5728\u3059\u308b\u3068\u3001\u958b\u767a\u30b3\u30b9\u30c8\u306e\u5dee\u304b\u3089\u3001\u958b\u767a\u306e\u30d0\u30e9\u30f3\u30b9\u304c\u5d29\u308c\u3066\u3057\u307e\u3044\u3001\u7cbe\u795e\u7684\u306b\u3042\u307e\u308a\u5b9c\u3057\u304f\u306a\u3044\u72b6\u614b\u3068\u306a\u308b\u306e\u3067\u3059\u304c\u3001Play\u306f\u3059\u3079\u3066\u3092\u5e73\u7b49\u306b\u6271\u3063\u3066\u3044\u308b\u611f\u304c\u3042\u308b\u306e\u3067\u3001MVC\u3092\u5fb9\u5e95\u7684\u306b\u610f\u8b58\u3057\u305f\u30b9\u30c8\u30ec\u30b9\u306e\u306a\u3044\u5b9f\u88c5\u304c\u53ef\u80fd\u306b\u306a\u308b\u3068\u601d\u3044\u307e\u3059\u3002\n\nPlay\u306f\u30d0\u30fc\u30b8\u30e7\u30f3\u30a2\u30c3\u30d7\u306e\u5ea6\u306b\u3001\u304b\u306a\u308a\u5927\u80c6\u306b\u4ed5\u69d8\u3092\u5909\u66f4\u3057\u3066\u3044\u308b\u3089\u3057\u304f\u3001\u5c06\u6765\u7684\u306b\u3088\u308a\u826f\u3044\u30d5\u30ec\u30fc\u30e0\u30ef\u30fc\u30af\u306b\u6210\u9577\u3059\u308b\u3068\u3044\u3046\u671f\u5f85\u611f\u304c\u9ad8\u307e\u308b\u4e00\u65b9\u3001\u4eca\u56de\u306e\u5b9f\u88c5\u3067\u306f\u304b\u306a\u308a\u306e\u78ba\u7387\u3067\u30cd\u30c3\u30c8\u306e\u60c5\u5831\u306b\u30df\u30b9\u30ea\u30fc\u30c9\u3055\u305b\u3089\u308c\u3066\u3057\u307e\u3044\u307e\u3057\u305f\u3002Play2.3\u306e\u60c5\u5831\u304c\u53c2\u8003\u306b\u306a\u3089\u306a\u3044\u3053\u3068\u3082\u6570\u591a\u304f\u3042\u308a\u307e\u3059\u306e\u3067\u3001\u3054\u6ce8\u610f\u3092\u3002\n\n\u305d\u306e\u4e2d\u3067\u3082[\u30aa\u30d5\u30a3\u30b7\u30e3\u30eb\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8](https://www.playframework.com/documentation/2.4.x/Home)\u306f\u30d0\u30fc\u30b8\u30e7\u30f3\u6bce\u306b\u304d\u3061\u3093\u3068\u4f5c\u6210\u3055\u308c\u3066\u3044\u3066\u3001\u304b\u306a\u308a\u306e\u60c5\u5831\u91cf\u3068\u306a\u3063\u3066\u3044\u307e\u3059\u3002\u307e\u305a\u306f\u30aa\u30d5\u30a3\u30b7\u30e3\u30eb\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u306b\u3069\u3063\u3077\u308a\u3068\u8ef8\u8db3\u3092\u7f6e\u3044\u3066\u3044\u305f\u3060\u304d\u3001\u5916\u90e8\u30b5\u30a4\u30c8\u3092\u53c2\u8003\u306b\u3059\u308b\u969b\u306b\u306f\u3001\u30d0\u30fc\u30b8\u30e7\u30f3\u306e\u78ba\u8a8d\u3092\u5fb9\u5e95\u3059\u308b\u3053\u3068\u304c\u5927\u5207\u3060\u3068\u601d\u3044\u307e\u3059\u3002\n", "tags": ["Play", "Scala", "Akka", "Java"]}