{"tags": ["Octopress", "S3", "gzip", "Rakefile"], "context": " More than 1 year has passed since last update.\nRakefile\ndeploy_default = \"s3\"\n## -- S3 Deploy config -- #\ns3_bucket      = \"hugehugehuge\"  # Enter your S3 bucket name here\ns3_cache_secs  = \"3600\" # Number of seconds to keep objects in cache - 3600 = 1 hour\n\n\ndesc \"Deploy website via s3cmd\"\ntask :s3 do\n  (Dir[\"#{deploy_dir}/*\"]).each { |f| rm_rf(f) }\n  Rake::Task[:copydot].invoke(public_dir, deploy_dir)\n  puts \"\\n## Copying #{public_dir} to #{deploy_dir}\"\n  cp_r \"#{public_dir}/.\", deploy_dir\n  puts \"## Compile css,html,js,xml to gz\"\n  Dir.glob(\"#{deploy_dir}/**/*.{css,html,js,xml}\") do |f|\n    system(\"gzip -n #{f}\")\n  end\n  system(\"find #{deploy_dir}/ -iname '*.gz' -exec rename 's/\\.gz$//i' {} +\")\n  puts \"## Deploying website via s3cmd\"\n  ok_failed system(\"s3cmd sync --acl-public --add-header \\\"Cache-Control: max-age=#{s3_cache_secs}\\\" #{deploy_dir}/* s3://#{s3_bucket}/ --exclude '*.sh' --exclude '*.html' --exclude '*.js' --exclude '*.css' --exclude '*.xml' \")\n  ok_failed system(\"s3cmd sync --acl-public --add-header \\\"Cache-Control: max-age=#{s3_cache_secs}\\\" --add-header 'Content-Encoding:gzip'  #{deploy_dir}/* s3://#{s3_bucket}/ --exclude '*.*' --include '*.html' --include '*.js' --include '*.css' --include '*.xml'\")\nend\n\n\nbrew install rename s3cmd\n\n\u53c2\u8003\n- http://www.furida.mu/blog/2012/02/29/gzip-your-octopress/\n- http://blog.nambo.jp/2013/07/25/octopress-aws-s3/\n\u8ffd\u8a18\n\u3053\u3063\u3061\u306e\u65b9\u304c\u3044\u3044\u304b\u3082\nhttp://qiita.com/soramugi/items/568357c49e6cb7ec867e\n```ruby:Rakefile\ndeploy_default = \"s3\"\n## -- S3 Deploy config -- #\ns3_bucket      = \"hugehugehuge\"  # Enter your S3 bucket name here\ns3_cache_secs  = \"3600\" # Number of seconds to keep objects in cache - 3600 = 1 hour\n\n\ndesc \"Deploy website via s3cmd\"\ntask :s3 do\n  (Dir[\"#{deploy_dir}/*\"]).each { |f| rm_rf(f) }\n  Rake::Task[:copydot].invoke(public_dir, deploy_dir)\n  puts \"\\n## Copying #{public_dir} to #{deploy_dir}\"\n  cp_r \"#{public_dir}/.\", deploy_dir\n  puts \"## Compile css,html,js,xml to gz\"\n  Dir.glob(\"#{deploy_dir}/**/*.{css,html,js,xml}\") do |f|\n    system(\"gzip -n #{f}\")\n  end\n  system(\"find #{deploy_dir}/ -iname '*.gz' -exec rename 's/\\.gz$//i' {} +\")\n  puts \"## Deploying website via s3cmd\"\n  ok_failed system(\"s3cmd sync --acl-public --add-header \\\"Cache-Control: max-age=#{s3_cache_secs}\\\" #{deploy_dir}/* s3://#{s3_bucket}/ --exclude '*.sh' --exclude '*.html' --exclude '*.js' --exclude '*.css' --exclude '*.xml' \")\n  ok_failed system(\"s3cmd sync --acl-public --add-header \\\"Cache-Control: max-age=#{s3_cache_secs}\\\" --add-header 'Content-Encoding:gzip'  #{deploy_dir}/* s3://#{s3_bucket}/ --exclude '*.*' --include '*.html' --include '*.js' --include '*.css' --include '*.xml'\")\nend\n```\n\n    brew install rename s3cmd\n\n\u53c2\u8003\n- <http://www.furida.mu/blog/2012/02/29/gzip-your-octopress/>\n- <http://blog.nambo.jp/2013/07/25/octopress-aws-s3/>\n\n\u8ffd\u8a18\n\u3053\u3063\u3061\u306e\u65b9\u304c\u3044\u3044\u304b\u3082\n<http://qiita.com/soramugi/items/568357c49e6cb7ec867e>"}