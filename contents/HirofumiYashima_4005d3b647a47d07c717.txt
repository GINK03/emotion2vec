{"tags": ["R", "\u5730\u7406\u7a7a\u9593\u30c7\u30fc\u30bf\u5206\u6790", "\u7a7a\u9593\u30c7\u30fc\u30bf\u306e\u7d71\u8a08\u5206\u6790", "GIS"], "context": " More than 1 year has passed since last update.\n\n\u6559\u79d1\u66f8\u300eR\u306b\u3088\u308b\u7a7a\u9593\u30c7\u30fc\u30bf\u306e\u7d71\u8a08\u5206\u6790\u300f\u3092\u4f7f\u3063\u3066\u3001\u57fa\u672c\u4e8b\u9805\u306e\u6574\u7406\u3068\u304a\u3055\u3089\u3044\u3092\u5099\u5fd8\u9332\u307e\u3067 \n\n\n\u3010 \u6559\u79d1\u66f8 \u3011\n\n\uff08\u4e0b\u8a18\u306e\u6559\u79d1\u66f8\u306e\u30b3\u30fc\u30c9\u306b\u4e00\u90e8\u624b\u3092\u52a0\u3048\u3066\u5b9f\u884c\u3057\u307e\u3059\uff09\n\n\u53e4\u8c37 \u77e5\u4e4b\uff08\u8457\uff09\u300eR\u306b\u3088\u308b\u7a7a\u9593\u30c7\u30fc\u30bf\u306e\u7d71\u8a08\u5206\u6790\u300f\n\n\n\uff08\u51fa\u7248\u5143\u30da\u30fc\u30b8\u3078\u306e\u30ea\u30f3\u30af\uff09\u671d\u5009\u66f8\u5e97 \u51fa\u7248\u66f8\u7c4d\u30da\u30fc\u30b8 \n\n\n\u3010 \u30b3\u30fc\u30c9 & \u4f7f\u7528\u30c7\u30fc\u30bf \u63b2\u8f09\u30da\u30fc\u30b8 \u3011\n\n \uff08\u30ea\u30f3\u30af\uff09\u7a7a\u9593\u30c7\u30fc\u30bf\u306e\u7d71\u8a08\u5206\u6790\u3000\u203b\u7b2c\uff13\u7ae0\u306e\u30b3\u30fc\u30c9\u3092\u5b9f\u884c\u3057\u3066\u307f\u307e\u3059 \n\n\n\n\u3010 \u4ee5\u4e0b\u3001\u30b3\u30fc\u30c9\u306e\u5b9f\u884c\u958b\u59cb \u3011\n\n\u30d1\u30c3\u30b1\u30fc\u30b8\u306e\u8aad\u307f\u8fbc\u307f {spatstat} \u30d1\u30c3\u30b1\u30fc\u30b8\n\n{spatstat} \u30d1\u30c3\u30b1\u30fc\u30b8\n\n CRAN \u30d1\u30c3\u30b1\u30fc\u30b8\u89e3\u8aac\u30da\u30fc\u30b8\u3078\u306e\u30ea\u30f3\u30af  \n\n\nspatstat: Spatial Point Pattern analysis, model-fitting, simulation, tests\nA package for analysing spatial data, mainly Spatial Point Patterns, including multitype/marked points and spatial covariates, in any two-dimensional spatial region. \nAlso supports three-dimensional point patterns, space-time point patterns in any number of dimensions, and point patterns on a linear network. \nContains over 1500 functions for plotting spatial data, exploratory data analysis, model-fitting, simulation, spatial sampling, model diagnostics, and formal inference. \n\n\nR\ninstall.packages(\"spatstat\")\nlibrary(spatstat)\n\n\n\n\u6b63\u898f\u4e71\u6570\u3092 500 \u500b\u767a\u751f\u3055\u305b\u3066\u300150\u500b\u306e\u70b9\u306e x \u5ea7\u6a19\u30fb y \u5ea7\u6a19\u306e\u5024\u306b\u8a2d\u5b9a\n\nR\npx <- rnorm(500, mean=0.5, sd=0.15)\npy <- rnorm(500, mean=0.5, sd=0.15)\n\nprint(px); print(py)\n\n\n> print(px); print(py)\n  [1] 0.4877668 0.3964044 0.7393111 0.5074049 0.5477586 0.4219417 0.6666681 0.5731946\n  [9] 0.4730770 0.5900082 0.4180877 0.3053868 0.6587158 0.4592235 0.6377342 0.6003220\n [17] 0.4915519 0.4305164 0.6352159 0.3279266 0.6215754 0.4664938 0.4623558 0.4304521\n [25] 0.4679763 0.4692060 0.4212702 0.2585981 0.3656028 0.6094632 0.5718021 0.4503670\n [33] 0.6261588 0.4867760 0.4797466 0.2988391 0.6023116 0.5675159 0.6169262 0.5020055\n [41] 0.5101369 0.4803519 0.4941492 0.8488133 0.3874145 0.5191675 0.4469395 0.5927724\n [49] 0.4185109 0.6643391 0.6873000 0.4124238 0.4326694 0.5372189 0.6183382 0.3939910\n [57] 0.3523926 0.5006428 0.5533586 0.4641681 0.5214386 0.4802347 0.6659463 0.4672774\n [65] 0.4238121 0.2388040 0.4962146 0.3537430 0.5752674 0.4368208 0.5370585 0.4518592\n [73] 0.2081121 0.4530766 0.5599422 0.5430525 0.4598898 0.3408733 0.6955840 0.5303705\n [81] 0.3355380 0.4850117 0.4162080 0.4605791 0.3768562 0.6144250 0.5685050 0.4711901\n [89] 0.3877657 0.4758134 0.7566999 0.2437114 0.6322586 0.6867814 0.5132898 0.4363732\n [97] 0.6753041 0.6450605 0.4080503 0.4912454 0.2209825 0.3528761 0.3804104 0.5512639\n[105] 0.4836440 0.4721079 0.4474131 0.3727344 0.4126090 0.8935069 0.5575137 0.5297238\n[113] 0.2765811 0.3290084 0.5566105 0.5298046 0.6396980 0.8248917 0.3846370 0.7160794\n[121] 0.6274552 0.2675971 0.7185214 0.7256355 0.6393061 0.5851981 0.7364208 0.3763757\n[129] 0.6468349 0.6415093 0.3560325 0.4634379 0.5611336 0.9290947 0.5524423 0.5006441\n[137] 0.5123403 0.4000159 0.5905159 0.5594007 0.7128238 0.4493448 0.5307536 0.5671264\n[145] 0.5963774 0.2706815 0.4681396 0.5952200 0.4933437 0.3496127 0.3901082 0.7040349\n[153] 0.4437271 0.7066725 0.7396373 0.6096610 0.6714411 0.5326159 0.5169527 0.4861479\n[161] 0.4380102 0.4954926 0.5950085 0.1239395 0.4075075 0.2862518 0.4073972 0.5410020\n[169] 0.3988672 0.4223816 0.3628344 0.4393361 0.2342147 0.2870189 0.5770008 0.4231268\n[177] 0.5207962 0.6689790 0.1952204 0.5156138 0.4322896 0.4891704 0.5119051 0.6508915\n[185] 0.3874496 0.6720016 0.3413937 0.8128456 0.7449742 0.2513206 0.4886894 0.6236523\n[193] 0.4988265 0.5522528 0.7752561 0.5770696 0.4068689 0.6754563 0.4231971 0.5542412\n[201] 0.5434759 0.4263458 0.3384787 0.5568030 0.4236443 0.3407508 0.4618437 0.8809418\n[209] 0.1811509 0.4889407 0.6507687 0.3694134 0.2571589 0.2416258 0.5160078 0.2846232\n[217] 0.4681284 0.5656441 0.5268878 0.3776212 0.5040936 0.1930056 0.1805594 0.6551629\n[225] 0.3292273 0.3994422 0.4653087 0.4847731 0.4719756 0.4757514 0.3320586 0.8150064\n[233] 0.4403267 0.5288456 0.5793722 0.4984769 0.3354057 0.5071991 0.2663133 0.5292332\n[241] 0.5129447 0.2873337 0.4716680 0.4307840 0.2791643 0.3630354 0.2930557 0.3322659\n[249] 0.3519187 0.6880300 0.5195064 0.5938086 0.7544631 0.7235473 0.5497354 0.7089724\n[257] 0.3082584 0.3242692 0.4195846 0.4474575 0.5296258 0.5482011 0.4441550 0.4070449\n[265] 0.3588582 0.6480897 0.4356991 0.5040407 0.5704213 0.3244726 0.4830912 0.5071489\n[273] 0.6593887 0.5253757 0.5239701 0.4713969 0.3835243 0.6541177 0.3727662 0.5760531\n[281] 0.4730060 0.5037203 0.4085178 0.4157654 0.6652741 0.4014249 0.3309386 0.4634156\n[289] 0.3872792 0.3282098 0.3124914 0.5193412 0.5296058 0.4694765 0.5103234 0.4647420\n[297] 0.5734207 0.5239427 0.7611971 0.7488952 0.4232080 0.6837551 0.6596057 0.5840515\n[305] 0.4664663 0.2878079 0.8255472 0.5923218 0.6054610 0.4569400 0.4828138 0.4423359\n[313] 0.6906711 0.3731789 0.7574085 0.4659975 0.2027208 0.5310263 0.4350103 0.3633219\n[321] 0.5979862 0.3553402 0.7587244 0.4597812 0.4641267 0.9006362 0.4534343 0.4948856\n[329] 0.5436758 0.7002612 0.4441344 0.1976811 0.1836977 0.4725887 0.5441082 0.4963657\n[337] 0.3706957 0.5147328 0.6809895 0.5506793 0.5713492 0.2630642 0.6852124 0.5359180\n[345] 0.5578194 0.6419856 0.2705493 0.4266319 0.5254393 0.3730454 0.6972025 0.4031385\n[353] 0.5917684 0.5436788 0.6655890 0.4762723 0.5093550 0.5195106 0.4812051 0.1901478\n[361] 0.3599995 0.2304854 0.5003427 0.6270968 0.6362568 0.3812185 0.5047621 0.5199079\n[369] 0.5639360 0.7311760 0.7761160 0.3869009 0.3341742 0.5139067 0.2733014 0.5086451\n[377] 0.3329588 0.4666103 0.2307387 0.5970109 0.5120012 0.5723911 0.5781624 0.3343667\n[385] 0.6125994 0.4655761 0.7918597 0.3598020 0.4780492 0.8965052 0.6927190 0.6196254\n[393] 0.6385996 0.4508638 0.4364598 0.3411753 0.4441655 0.3598449 0.4336419 0.1493859\n[401] 0.4447385 0.1455207 0.3858488 0.4638547 0.3226867 0.3096936 0.6508486 0.5253868\n[409] 0.6138122 0.7156298 0.6108667 0.4588731 0.4474336 0.3726579 0.4757414 0.4843362\n[417] 0.5045572 0.1309913 0.4619781 0.6567299 0.6726132 0.5615573 0.3498204 0.3573989\n[425] 0.4770254 0.6515465 0.5376328 0.4300571 0.6076764 0.6029329 0.4279721 0.4658107\n[433] 0.3575277 0.4052370 0.5692749 0.6746281 0.5065675 0.4170293 0.3981357 0.6436467\n[441] 0.5627623 0.5619181 0.5676761 0.5200357 0.3011875 0.3907988 0.5201342 0.3559531\n[449] 0.3532272 0.5504834 0.3373139 0.4504355 0.7770836 0.5962978 0.5574071 0.3874114\n[457] 0.5005151 0.6233351 0.3992560 0.5259145 0.4887593 0.4178543 0.3166815 0.5712611\n[465] 0.4880263 0.6158020 0.5995304 0.5014918 0.8198414 0.5320304 0.5501207 0.4240985\n[473] 0.6152616 0.9176310 0.4706137 0.4842415 0.4920729 0.4770263 0.4034290 0.3205154\n[481] 0.6358586 0.5648774 0.6036038 0.5991628 0.7014034 0.4651720 0.6604330 0.4460697\n[489] 0.4324744 0.3387417 0.6326111 0.7396774 0.4693626 0.4967534 0.7245734 0.6454172\n[497] 0.6427333 0.4286473 0.5944166 0.6954978\n\n\n  [1] 0.46401148 0.46898893 0.52227747 0.72975876 0.29764401 0.33698669 0.55015641\n  [8] 0.49700803 0.32072895 0.67005475 0.72341612 0.26810593 0.54492604 0.32242007\n [15] 0.83592261 0.59274663 0.86713790 0.56741973 0.60923216 0.45252598 0.40104978\n [22] 0.69460624 0.37621748 0.73622573 0.29405128 0.44632427 0.39418065 0.72143032\n [29] 0.48628089 0.70511933 0.46740409 0.57172675 0.58965763 0.59866473 0.17194532\n [36] 0.51077265 0.56746600 0.27598037 0.45573772 0.44618893 0.40110839 0.70948626\n [43] 0.49880063 0.33654741 0.73789467 0.55222737 0.64141189 0.53661314 0.39326486\n [50] 0.98884759 0.36044986 0.55027084 0.67789085 0.32488306 0.59815186 0.71701208\n [57] 0.63896124 0.74077848 0.61042402 0.38334013 0.37778325 0.61272721 0.60614120\n [64] 0.46542782 0.56521390 0.36494938 0.31077039 0.37369334 0.61901978 0.73591532\n [71] 0.49817794 0.15878078 0.59018119 0.14489271 0.31291021 0.54528271 0.53837932\n [78] 0.64306717 0.62949855 0.52812346 0.63595236 0.32581235 0.47036712 0.46358964\n [85] 0.17859077 0.45889218 0.45794958 0.10963482 0.02180589 0.42709147 0.73035403\n [92] 0.53390499 0.53770732 0.44519122 0.34929836 0.63149583 0.75211662 0.63423295\n [99] 0.38832921 0.38769760 0.48820031 0.60885877 0.35757150 0.65019894 0.52691029\n[106] 0.61275493 0.54424926 0.43927380 0.51186187 0.47839782 0.55133921 0.52970471\n[113] 0.55192559 0.50476328 0.33031420 0.16730212 0.56057031 0.65929690 0.41580727\n[120] 0.50265366 0.36105810 0.48172703 0.48979012 0.63944086 0.63329353 0.53347285\n[127] 0.31985683 0.57241556 0.49803457 0.22309060 0.64427100 0.44014309 0.47771370\n[134] 0.45656992 0.46378786 0.54857884 0.63173986 0.49679121 0.44611475 0.63614786\n[141] 0.41349845 0.50397392 0.52434673 0.46401135 0.51901427 0.52564091 0.38446157\n[148] 0.41129352 0.25075016 0.51751694 0.60898038 0.30333930 0.59759239 0.63101501\n[155] 0.61240976 0.39946450 0.39078496 0.46522779 0.39674833 0.54020165 0.45773595\n[162] 0.42357942 0.49672918 0.74136252 0.64377882 0.42698818 0.33543341 0.59478782\n[169] 0.45685885 0.38123487 0.60438105 0.28997587 0.56145439 0.66966818 0.69013487\n[176] 0.66346918 0.58098172 0.40358155 0.35858528 0.72758835 0.44555859 0.51080507\n[183] 0.52872370 0.58056180 0.66054770 0.38271689 0.45637145 0.18421312 0.61764603\n[190] 0.38484259 0.44498725 0.56553288 0.62789333 0.39315332 0.60974027 0.48581314\n[197] 0.16160323 0.42132874 0.51388490 0.56321543 0.59267358 0.72000298 0.48756751\n[204] 0.41494549 0.56213348 0.37730576 0.58601628 0.56578264 0.57585324 0.54230569\n[211] 0.36812426 0.40543840 0.44407118 0.54982636 0.73813207 0.52240406 0.37923406\n[218] 0.64807340 0.61257191 0.77263120 0.41555359 0.36620385 0.30899195 0.39268806\n[225] 0.52257743 0.35032193 0.48364786 0.41506476 0.44277749 0.28072443 0.54082830\n[232] 0.56135558 0.59818071 0.64506459 0.18768075 0.12387590 0.35751070 0.52566537\n[239] 0.34884046 0.53386628 0.79423926 0.29605435 0.33459858 0.65976427 0.61097769\n[246] 0.21289654 0.36405468 0.47955687 0.41841831 0.74487924 0.64859983 0.66342718\n[253] 0.49154576 0.25838127 0.43233348 0.34276217 0.48090822 0.46060228 0.45007797\n[260] 0.52265265 0.55814497 0.53103383 0.69016382 0.81254829 0.34945356 0.55196410\n[267] 0.76354145 0.63111295 0.38258002 0.69360847 0.45292752 0.36691580 0.44868894\n[274] 0.44712522 0.33339442 0.36484451 0.38502709 0.41172577 0.31915434 0.42021397\n[281] 0.29971594 0.25053138 0.73399193 0.62400947 0.49352964 0.47548836 0.56132253\n[288] 0.64794695 0.60771962 0.70483175 0.42051432 0.37762275 0.33070252 0.28707715\n[295] 0.49330455 0.68012075 0.38863832 0.64350452 0.30807444 0.28781549 0.44037576\n[302] 0.56807934 0.45633324 0.78326490 0.53225536 0.42693770 0.72101244 0.72221471\n[309] 0.48100701 0.32349843 0.69842956 0.48529575 0.45412856 0.46427951 0.72883508\n[316] 0.31759605 0.61383261 0.52993688 0.47460640 0.45428884 0.50636056 0.70863073\n[323] 0.36606019 0.63290391 0.42453289 0.56179731 0.63999698 0.38538493 0.68865203\n[330] 0.48116468 0.29143576 0.46653583 0.50886945 0.41292812 0.36826640 0.60259957\n[337] 0.44603903 0.56105803 0.58687426 0.56012948 0.65632739 0.43648091 0.48212277\n[344] 0.29988331 0.51452493 0.27444678 0.51408833 0.66544833 0.13215547 0.31612760\n[351] 0.43776308 0.62918542 0.76192442 0.40544096 0.47799577 0.57978815 0.50584371\n[358] 0.67206003 0.50982376 0.68600311 0.64750719 0.46631450 0.48982132 0.65316235\n[365] 0.57021301 0.69370944 0.30258910 0.27909686 0.31859593 0.47390460 0.57757245\n[372] 0.27171368 0.48178371 0.45989335 0.58878901 0.68594019 0.76993825 0.71440694\n[379] 0.33207748 0.42041941 0.78058190 0.39030602 0.45601804 0.65000656 0.22627587\n[386] 0.46632460 0.57292774 0.71054290 0.58019947 0.92236046 0.34780539 0.56739920\n[393] 0.17582408 0.50012721 0.59788063 0.66694312 0.40492753 0.63287913 0.43542975\n[400] 0.31052332 0.39003352 0.73476431 0.48243597 0.78021695 0.51734665 0.78391126\n[407] 0.36553094 0.35504401 0.43198499 0.79382139 0.60093581 0.52616080 0.63295373\n[414] 0.75133879 0.41868283 0.67138687 0.25362936 0.28500154 0.62646776 0.32243822\n[421] 0.53591794 0.65471945 0.71100819 0.49103629 0.29886499 0.44981691 0.57095943\n[428] 0.35090430 0.52839266 0.22983630 0.53891801 0.68247963 0.53104624 0.67087904\n[435] 0.53512636 0.36205853 0.59856995 0.36977881 0.31198392 0.36929543 0.31175626\n[442] 0.59334178 0.50396374 0.67914907 0.46201194 0.25609066 0.51989017 0.48518120\n[449] 0.53722135 0.63773256 0.65918477 0.40439324 0.56580041 0.43308950 0.80925302\n[456] 0.60042790 0.51729635 0.25574373 0.42099300 0.43703262 0.45013234 0.62132058\n[463] 0.52934315 0.38264990 0.30687781 0.51470221 0.42653515 0.25378732 0.62345130\n[470] 0.39494568 0.36172542 0.42742077 0.68109519 0.20145650 0.71241410 0.81677475\n[477] 0.47671077 0.44884640 0.71764743 0.49187977 0.30267133 0.55760780 0.45412859\n[484] 0.44755360 0.55775745 0.48934940 0.36888305 0.77942587 0.32758783 0.46867105\n[491] 0.40950190 0.82820446 0.55789476 0.35800236 0.45580777 0.49436489 0.51263546\n[498] 0.51271529 0.57919735 0.78294877\n\n\n\u5404\u5ea7\u6a19\u5024\u306e\u70b9\u306e\u5c5e\u6027\u5024\u3092\u8a2d\u5b9a\npz <- as.data.frame(rep(1, 500))\ncolnames(pz) <- c(\"pz\")\n\n\nppp() \u95a2\u6570\u3000\u3092\u7528\u3044\u3066\u3001Point Pattern \u30c7\u30fc\u30bf\u3092\u4f5c\u6210\n\n\u203b \u4ee5\u4e0b\u3001 ?ppp() \u5b9f\u884c\u7d50\u679c\u3092\u629c\u7c8b\u3057\u3066\u548c\u8a33\n\n\u3010 \u623b\u308a\u5024 \u3011Point Pattern \u30aa\u30d6\u30b8\u30a7\u30af\u30c8\n\n\u3010 \u66f8\u5f0f \u3011 **  ppp(x,y, ..., window, marks, check=TRUE, drop=TRUE)**\n\n\n\u3010 \u5f15\u6570 \u3011 \u2460 x, y : 2\u6b21\u5143\u30c7\u30fc\u30bf\u306ex\u5ea7\u6a19\u5024\u3068y\u5ea7\u6a19\u5024 \u2461 window :\u89b3\u6e2c\u5024\u306e\u7bc4\u56f2\uff08 window \uff09\n\nR\npnt <- ppp(px, py, c(0,1), c(0,1))\n\nprint(pnt)\n\n\nplanar point pattern: 500 points\nwindow: rectangle = [0, 1] x [0, 1] units\n\n\n\u3001Point Pattern \u30c7\u30fc\u30bf\u3092\u63cf\u753b\n\nR\nplot(pnt, type=\"p\")\n\n\n\n\ndensity() \u95a2\u6570\u3067\u5024\u306e\u5bc6\u5ea6\u5206\u5e03\u66f2\u7dda\u3092\u7b97\u51fa\n\nR\nprint(density(pnt))\n\n\nreal-valued pixel image\n128 x 128 pixel array (ny, nx)\nenclosing rectangle: [0, 1] x [0, 1] units\n\n\nR\nplot(density(pnt), 0.1)\n\n\n\n\ncontour() \u95a2\u6570\u3067\u3001\u7b49\u9ad8\u7dda\u3092\u8ffd\u8a18\n\nR\ncontour(density(pnt), add=T)\n\n\n\n\n\u5404\u5ea7\u6a19\u5024\u306e\u5024\uff08\u70b9\uff09\u3092\u30b0\u30e9\u30d5\u306b\u8ffd\u8a18\n\nR\nplot(pnt, type=\"p\", add=T)\n\n\n\n\nx\u5ea7\u6a19 \u3068 y\u5ea7\u6a19 \u306e\u5ea7\u6a19\u5024\u306e\u7d44\u30c7\u30fc\u30bf\u3092\u3001cbind() \u95a2\u6570\u3067\u5217\u7d50\u5408\n\nSpatialPoints() \u95a2\u6570\u3067\u3001 SpatialPoints \u578b\u30c7\u30fc\u30bf\u306b\u578b\u5909\u63db\n\nR\npnt_xy <- cbind(px, py)\npnt_sp <- SpatialPoints(data.frame(px, py))\n\nclass(pnt_sp)\n\n\n[1] \"SpatialPoints\"\nattr(,\"package\")\n[1] \"sp\"\n\n\nSpatialPointsDataFrame() \u95a2\u6570\u3067\u3001 SpatialPointsDataFrame \u578b\u30c7\u30fc\u30bf\u306b\u578b\u5909\u63db\n\nR\npnt_spdf <- SpatialPointsDataFrame(pnt_sp, pz)\n\nclass(pnt_spdf)\n\n\n[1] \"SpatialPointsDataFrame\"\nattr(,\"package\")\n[1] \"sp\"\n\n\n\u4e2d\u8eab\u3092\u78ba\u8a8d\n\nR\nprint(pnt_spdf)\n\n\n                coordinates pz\n1    (0.4877668, 0.4640115)  1\n2    (0.3964044, 0.4689889)  1\n3    (0.7393111, 0.5222775)  1\n4    (0.5074049, 0.7297588)  1\n5     (0.5477586, 0.297644)  1\n6    (0.4219417, 0.3369867)  1\n7    (0.6666681, 0.5501564)  1\n8     (0.5731946, 0.497008)  1\n9     (0.473077, 0.3207289)  1\n10   (0.5900082, 0.6700548)  1\n11   (0.4180877, 0.7234161)  1\n12   (0.3053868, 0.2681059)  1\n13    (0.6587158, 0.544926)  1\n14   (0.4592235, 0.3224201)  1\n15   (0.6377342, 0.8359226)  1\n\n        \uff08\u4e2d\u7565\uff09\n\n\n490   (0.3387417, 0.468671)  1\n491  (0.6326111, 0.4095019)  1\n492  (0.7396774, 0.8282045)  1\n493  (0.4693626, 0.5578948)  1\n494  (0.4967534, 0.3580024)  1\n495  (0.7245734, 0.4558078)  1\n496  (0.6454172, 0.4943649)  1\n497  (0.6427333, 0.5126355)  1\n498  (0.4286473, 0.5127153)  1\n499  (0.5944166, 0.5791974)  1\n500  (0.6954978, 0.7829488)  1\n\n\n\u30b0\u30e9\u30d5\u3092\u63cf\u753b\n\nR\nplot(pnt_spdf)\n\n\n\n\n?quadratcount() \u5b9f\u884c\u7d50\u679c\u3088\u308a\u629c\u7c8b\n\n\u3010 \u8981\u7d04 \u3011 \u5ea7\u6a19\u7a7a\u9593\u306e\u5404\u6b63\u65b9\u5f62\u67a0\u306b\u5b58\u5728\u3059\u308b\u30c7\u30fc\u30bf\u70b9\u306e\u500b\u6570\u3092\u30ab\u30a6\u30f3\u30c8\u3059\u308b\u95a2\u6570\n\nQuadrat counting for a point pattern\nDescription\nDivides window into quadrats and counts the numbers of points in each quadrat.\nUsage \uff08\u66f8\u5f0f\uff09\nquadratcount(X, ...)\n## S3 method for class 'ppp'\nquadratcount(X, nx=5, ny=nx, ...,\n               xbreaks=NULL, ybreaks=NULL, tess=NULL)\n## S3 method for class 'splitppp'\nquadratcount(X, ...)\nArguments \uff08\u5f15\u6570\uff09\nX\nA point pattern (object of class \"ppp\") or a split point pattern (object of class \"splitppp\").\nnx,ny\nNumbers of rectangular quadrats in the x and y directions. Incompatible with xbreaks and ybreaks.\nAdditional arguments passed to quadratcount.ppp.\nxbreaks\nNumeric vector giving the x coordinates of the boundaries of the rectangular quadrats. Incompatible with nx.\nybreaks\nNumeric vector giving the y coordinates of the boundaries of the rectangular quadrats. Incompatible with ny.\ntess\nTessellation (object of class \"tess\") determining the quadrats. Incompatible with nx,ny,xbreaks,ybreaks\nValue \uff08\u623b\u308a\u5024\uff09\nThe value of quadratcount.ppp is a contingency table containing the number of points in each quadrat. The table is also an object of the special class \"quadratcount\" and there is a plot method for this class.\nThe value of quadratcount.splitppp is a list of such contingency tables, each containing the quadrat counts for one of the component point patterns in X. This list also has the class \"listof\" which has print and plot methods.\n\n\n\nR\nquadratcount(pnt, nx=2, ny=2)\n\n\n         x\ny         [0,0.5] (0.5,1]\n  (0.5,1]     126     120\n  [0,0.5]     134     120\n\n\nR\nquadratcount(pnt, nx=2, ny=2)/(0.5^2)\n\n\n    x\ny         [0,0.5] (0.5,1]\n  (0.5,1]     504     480\n  [0,0.5]     536     480\n\n\nR\nplot(pnt, type=\"p\")\n\n\n\n\n\u30aa\u30d7\u30b7\u30e7\u30f3 add=T \u3067\u3001\u6b63\u65b9\u5f62\u67a0\u306e\u67a0\u7dda\u3092\u8ffd\u8a18\u3057\u3066\u3001\u5404\u67a0\u5185\u306e\u30c7\u30fc\u30bf\u70b9 \u500b\u6570\u306e\u6570\u5024\u3082\u8ffd\u8a18\n\nR\nplot(quadratcount(pnt, nx=2, ny=2), add=T, col=\"red\")\n\n\n\n\nR\nquadratcount(pnt, nx=4, ny=4)\n\n\n            x\ny            [0,0.25] (0.25,0.5] (0.5,0.75] (0.75,1]\n  (0.75,1]          0         12         15        2\n  (0.5,0.75]       14         99         96        9\n  (0.25,0.5]        7        112        105        9\n  [0,0.25]          0          7         12        1\n\n\nR\nquadratcount(pnt, nx=4, ny=4)/(0.25^2)\n\n\n            x\ny            [0,0.25] (0.25,0.5] (0.5,0.75] (0.75,1]\n  (0.75,1]          0        192        240       32\n  (0.5,0.75]      224       1584       1536      144\n  (0.25,0.5]      112       1792       1680      144\n  [0,0.25]          0        112        192       16\n\n\nR\nplot(pnt, type=\"p\")\nplot(quadratcount(pnt, nx=4, ny=4), add=T, col=\"red\")\n\n\n\n\n\u89d2\u5ea7\u6a19\u70b9\u3092\u76f4\u7dda\u3067\u7d50\u3093\u3067\u3001\u30dd\u30ea\u30b4\u30f3\u3092\u4f5c\u6210\n\nR\npoly1 <- cbind(\n                c(0, 0.75, 0.75, 0.5, 0.5, 0.25, 0.25, 0, 0), \n                c(0, 0, 0.25, 0.25, 0.5, 0.5, 0.75, 0.75, 0)\n               )\n\npoly2 <- cbind(\n                c(0.25, 0.75, 0.75, 0.25, 0.25), \n                c(0.5, 0.5, 0.75, 0.75, 0.5)\n               )\n\npoly3 <- cbind(\n                c(0.75, 1, 1, 0.75, 0.75, 0.5, 0.5, 0.75, 0.75), \n                c(0, 0, 0.75, 0.75, 0.5, 0.5, 0.25, 0.25, 0)\n               )\n\n\npoly4 <- cbind(\n                c(0, 1, 1, 0, 0), \n                c(0.75, 0.75, 1, 1, 0.75)\n               )\n\npoly1_pl <- Polygons(list(Polygon(poly1)), \"poly1\")\npoly2_pl <- Polygons(list(Polygon(poly2)), \"poly2\")\npoly3_pl <- Polygons(list(Polygon(poly3)), \"poly3\")\npoly4_pl <- Polygons(list(Polygon(poly4)), \"poly4\")\n\n\n\n\u30c7\u30fc\u30bf\u578b\u5909\u63db\n\nR\npoly_sp <- SpatialPolygons(list(poly1_pl, poly2_pl, poly3_pl, poly4_pl))\n\npoly_spdf <- SpatialPolygonsDataFrame(poly_sp, data.frame(c(1:4), row.names=c(\"poly1\", \"poly2\", \"poly3\", \"poly4\")))\n\n\n\n\u63cf\u753b\u51fa\u529b\n\nR\nplot(poly_spdf)\n\n\n\n\nR\nplot(pnt, type=\"p\", add=T)\n\n\n\n\nR\noverlay(pnt_spdf, poly_spdf, fn=colSums)\n\n\nError in base::colSums(x, na.rm = na.rm, dims = dims, ...) : \n  'x' must be an array of at least two dimensions\nIn addition: Warning message:\n'.local' is deprecated.\nUse 'over' instead.\nSee help(\"Deprecated\") and help(\"sp-deprecated\"). \n\n\nR\narea.poly_spdf <- c(0.25^2*6, 0.25^2*2, 0.25^2*4, 0.25^2*4)\n\n\n\nR\noverlay(pnt_spdf, poly_spdf, fn=colSums)/area.poly_spdf\n\n\nError in base::colSums(x, na.rm = na.rm, dims = dims, ...) : \n  'x' must be an array of at least two dimensions\nIn addition: Warning message:\n'.local' is deprecated.\nUse 'over' instead.\nSee help(\"Deprecated\") and help(\"sp-deprecated\"). \n\n#### \u6559\u79d1\u66f8\u300eR\u306b\u3088\u308b\u7a7a\u9593\u30c7\u30fc\u30bf\u306e\u7d71\u8a08\u5206\u6790\u300f\u3092\u4f7f\u3063\u3066\u3001\u57fa\u672c\u4e8b\u9805\u306e\u6574\u7406\u3068\u304a\u3055\u3089\u3044\u3092\u5099\u5fd8\u9332\u307e\u3067 :blush: \n\n## \u3010 \u6559\u79d1\u66f8 \u3011 \n#### \uff08\u4e0b\u8a18\u306e\u6559\u79d1\u66f8\u306e\u30b3\u30fc\u30c9\u306b\u4e00\u90e8\u624b\u3092\u52a0\u3048\u3066\u5b9f\u884c\u3057\u307e\u3059\uff09\n### **\u53e4\u8c37 \u77e5\u4e4b\uff08\u8457\uff09\u300eR\u306b\u3088\u308b\u7a7a\u9593\u30c7\u30fc\u30bf\u306e\u7d71\u8a08\u5206\u6790\u300f**\n#### [\uff08\u51fa\u7248\u5143\u30da\u30fc\u30b8\u3078\u306e\u30ea\u30f3\u30af\uff09\u671d\u5009\u66f8\u5e97 \u51fa\u7248\u66f8\u7c4d\u30da\u30fc\u30b8 ](http://www.asakura.co.jp/books/isbn/978-4-254-12815-4/) \n\n## \u3010 \u30b3\u30fc\u30c9 & \u4f7f\u7528\u30c7\u30fc\u30bf \u63b2\u8f09\u30da\u30fc\u30b8 \u3011\n#### [ \uff08\u30ea\u30f3\u30af\uff09\u7a7a\u9593\u30c7\u30fc\u30bf\u306e\u7d71\u8a08\u5206\u6790\u3000\u203b\u7b2c\uff13\u7ae0\u306e\u30b3\u30fc\u30c9\u3092\u5b9f\u884c\u3057\u3066\u307f\u307e\u3059 ](http://web.sfc.keio.ac.jp/~maunz/wiki/index.php?%B6%F5%B4%D6%A5%C7%A1%BC%A5%BF%A4%CE%C5%FD%B7%D7%CA%AC%C0%CF)\n\n------------------------------------------------------------------------------------\n\n## \u3010 \u4ee5\u4e0b\u3001\u30b3\u30fc\u30c9\u306e\u5b9f\u884c\u958b\u59cb \u3011\n#### \u30d1\u30c3\u30b1\u30fc\u30b8\u306e\u8aad\u307f\u8fbc\u307f _**{spatstat}**_ \u30d1\u30c3\u30b1\u30fc\u30b8\n\n##### _**{spatstat}**_ \u30d1\u30c3\u30b1\u30fc\u30b8\n##### [ _CRAN_ \u30d1\u30c3\u30b1\u30fc\u30b8\u89e3\u8aac\u30da\u30fc\u30b8\u3078\u306e\u30ea\u30f3\u30af  ](http://cran.r-project.org/web/packages/spatstat/index.html)\n> **spatstat: Spatial Point Pattern analysis, model-fitting, simulation, tests**\n>\n>A package for analysing spatial data, mainly Spatial Point Patterns, including multitype/marked points and spatial covariates, in any two-dimensional spatial region. \n>\n>Also supports three-dimensional point patterns, space-time point patterns in any number of dimensions, and point patterns on a linear network. \n>\n>Contains over 1500 functions for plotting spatial data, exploratory data analysis, model-fitting, simulation, spatial sampling, model diagnostics, and formal inference. \n\n\n```{r:R}\ninstall.packages(\"spatstat\")\nlibrary(spatstat)\n```\n\n#### \u6b63\u898f\u4e71\u6570\u3092 **500** \u500b\u767a\u751f\u3055\u305b\u3066\u3001**50**\u500b\u306e\u70b9\u306e _**x**_ \u5ea7\u6a19\u30fb _**y**_ \u5ea7\u6a19\u306e\u5024\u306b\u8a2d\u5b9a\n```{r:R}\npx <- rnorm(500, mean=0.5, sd=0.15)\npy <- rnorm(500, mean=0.5, sd=0.15)\n\nprint(px); print(py)\n```\n\n```\n> print(px); print(py)\n  [1] 0.4877668 0.3964044 0.7393111 0.5074049 0.5477586 0.4219417 0.6666681 0.5731946\n  [9] 0.4730770 0.5900082 0.4180877 0.3053868 0.6587158 0.4592235 0.6377342 0.6003220\n [17] 0.4915519 0.4305164 0.6352159 0.3279266 0.6215754 0.4664938 0.4623558 0.4304521\n [25] 0.4679763 0.4692060 0.4212702 0.2585981 0.3656028 0.6094632 0.5718021 0.4503670\n [33] 0.6261588 0.4867760 0.4797466 0.2988391 0.6023116 0.5675159 0.6169262 0.5020055\n [41] 0.5101369 0.4803519 0.4941492 0.8488133 0.3874145 0.5191675 0.4469395 0.5927724\n [49] 0.4185109 0.6643391 0.6873000 0.4124238 0.4326694 0.5372189 0.6183382 0.3939910\n [57] 0.3523926 0.5006428 0.5533586 0.4641681 0.5214386 0.4802347 0.6659463 0.4672774\n [65] 0.4238121 0.2388040 0.4962146 0.3537430 0.5752674 0.4368208 0.5370585 0.4518592\n [73] 0.2081121 0.4530766 0.5599422 0.5430525 0.4598898 0.3408733 0.6955840 0.5303705\n [81] 0.3355380 0.4850117 0.4162080 0.4605791 0.3768562 0.6144250 0.5685050 0.4711901\n [89] 0.3877657 0.4758134 0.7566999 0.2437114 0.6322586 0.6867814 0.5132898 0.4363732\n [97] 0.6753041 0.6450605 0.4080503 0.4912454 0.2209825 0.3528761 0.3804104 0.5512639\n[105] 0.4836440 0.4721079 0.4474131 0.3727344 0.4126090 0.8935069 0.5575137 0.5297238\n[113] 0.2765811 0.3290084 0.5566105 0.5298046 0.6396980 0.8248917 0.3846370 0.7160794\n[121] 0.6274552 0.2675971 0.7185214 0.7256355 0.6393061 0.5851981 0.7364208 0.3763757\n[129] 0.6468349 0.6415093 0.3560325 0.4634379 0.5611336 0.9290947 0.5524423 0.5006441\n[137] 0.5123403 0.4000159 0.5905159 0.5594007 0.7128238 0.4493448 0.5307536 0.5671264\n[145] 0.5963774 0.2706815 0.4681396 0.5952200 0.4933437 0.3496127 0.3901082 0.7040349\n[153] 0.4437271 0.7066725 0.7396373 0.6096610 0.6714411 0.5326159 0.5169527 0.4861479\n[161] 0.4380102 0.4954926 0.5950085 0.1239395 0.4075075 0.2862518 0.4073972 0.5410020\n[169] 0.3988672 0.4223816 0.3628344 0.4393361 0.2342147 0.2870189 0.5770008 0.4231268\n[177] 0.5207962 0.6689790 0.1952204 0.5156138 0.4322896 0.4891704 0.5119051 0.6508915\n[185] 0.3874496 0.6720016 0.3413937 0.8128456 0.7449742 0.2513206 0.4886894 0.6236523\n[193] 0.4988265 0.5522528 0.7752561 0.5770696 0.4068689 0.6754563 0.4231971 0.5542412\n[201] 0.5434759 0.4263458 0.3384787 0.5568030 0.4236443 0.3407508 0.4618437 0.8809418\n[209] 0.1811509 0.4889407 0.6507687 0.3694134 0.2571589 0.2416258 0.5160078 0.2846232\n[217] 0.4681284 0.5656441 0.5268878 0.3776212 0.5040936 0.1930056 0.1805594 0.6551629\n[225] 0.3292273 0.3994422 0.4653087 0.4847731 0.4719756 0.4757514 0.3320586 0.8150064\n[233] 0.4403267 0.5288456 0.5793722 0.4984769 0.3354057 0.5071991 0.2663133 0.5292332\n[241] 0.5129447 0.2873337 0.4716680 0.4307840 0.2791643 0.3630354 0.2930557 0.3322659\n[249] 0.3519187 0.6880300 0.5195064 0.5938086 0.7544631 0.7235473 0.5497354 0.7089724\n[257] 0.3082584 0.3242692 0.4195846 0.4474575 0.5296258 0.5482011 0.4441550 0.4070449\n[265] 0.3588582 0.6480897 0.4356991 0.5040407 0.5704213 0.3244726 0.4830912 0.5071489\n[273] 0.6593887 0.5253757 0.5239701 0.4713969 0.3835243 0.6541177 0.3727662 0.5760531\n[281] 0.4730060 0.5037203 0.4085178 0.4157654 0.6652741 0.4014249 0.3309386 0.4634156\n[289] 0.3872792 0.3282098 0.3124914 0.5193412 0.5296058 0.4694765 0.5103234 0.4647420\n[297] 0.5734207 0.5239427 0.7611971 0.7488952 0.4232080 0.6837551 0.6596057 0.5840515\n[305] 0.4664663 0.2878079 0.8255472 0.5923218 0.6054610 0.4569400 0.4828138 0.4423359\n[313] 0.6906711 0.3731789 0.7574085 0.4659975 0.2027208 0.5310263 0.4350103 0.3633219\n[321] 0.5979862 0.3553402 0.7587244 0.4597812 0.4641267 0.9006362 0.4534343 0.4948856\n[329] 0.5436758 0.7002612 0.4441344 0.1976811 0.1836977 0.4725887 0.5441082 0.4963657\n[337] 0.3706957 0.5147328 0.6809895 0.5506793 0.5713492 0.2630642 0.6852124 0.5359180\n[345] 0.5578194 0.6419856 0.2705493 0.4266319 0.5254393 0.3730454 0.6972025 0.4031385\n[353] 0.5917684 0.5436788 0.6655890 0.4762723 0.5093550 0.5195106 0.4812051 0.1901478\n[361] 0.3599995 0.2304854 0.5003427 0.6270968 0.6362568 0.3812185 0.5047621 0.5199079\n[369] 0.5639360 0.7311760 0.7761160 0.3869009 0.3341742 0.5139067 0.2733014 0.5086451\n[377] 0.3329588 0.4666103 0.2307387 0.5970109 0.5120012 0.5723911 0.5781624 0.3343667\n[385] 0.6125994 0.4655761 0.7918597 0.3598020 0.4780492 0.8965052 0.6927190 0.6196254\n[393] 0.6385996 0.4508638 0.4364598 0.3411753 0.4441655 0.3598449 0.4336419 0.1493859\n[401] 0.4447385 0.1455207 0.3858488 0.4638547 0.3226867 0.3096936 0.6508486 0.5253868\n[409] 0.6138122 0.7156298 0.6108667 0.4588731 0.4474336 0.3726579 0.4757414 0.4843362\n[417] 0.5045572 0.1309913 0.4619781 0.6567299 0.6726132 0.5615573 0.3498204 0.3573989\n[425] 0.4770254 0.6515465 0.5376328 0.4300571 0.6076764 0.6029329 0.4279721 0.4658107\n[433] 0.3575277 0.4052370 0.5692749 0.6746281 0.5065675 0.4170293 0.3981357 0.6436467\n[441] 0.5627623 0.5619181 0.5676761 0.5200357 0.3011875 0.3907988 0.5201342 0.3559531\n[449] 0.3532272 0.5504834 0.3373139 0.4504355 0.7770836 0.5962978 0.5574071 0.3874114\n[457] 0.5005151 0.6233351 0.3992560 0.5259145 0.4887593 0.4178543 0.3166815 0.5712611\n[465] 0.4880263 0.6158020 0.5995304 0.5014918 0.8198414 0.5320304 0.5501207 0.4240985\n[473] 0.6152616 0.9176310 0.4706137 0.4842415 0.4920729 0.4770263 0.4034290 0.3205154\n[481] 0.6358586 0.5648774 0.6036038 0.5991628 0.7014034 0.4651720 0.6604330 0.4460697\n[489] 0.4324744 0.3387417 0.6326111 0.7396774 0.4693626 0.4967534 0.7245734 0.6454172\n[497] 0.6427333 0.4286473 0.5944166 0.6954978\n\n\n  [1] 0.46401148 0.46898893 0.52227747 0.72975876 0.29764401 0.33698669 0.55015641\n  [8] 0.49700803 0.32072895 0.67005475 0.72341612 0.26810593 0.54492604 0.32242007\n [15] 0.83592261 0.59274663 0.86713790 0.56741973 0.60923216 0.45252598 0.40104978\n [22] 0.69460624 0.37621748 0.73622573 0.29405128 0.44632427 0.39418065 0.72143032\n [29] 0.48628089 0.70511933 0.46740409 0.57172675 0.58965763 0.59866473 0.17194532\n [36] 0.51077265 0.56746600 0.27598037 0.45573772 0.44618893 0.40110839 0.70948626\n [43] 0.49880063 0.33654741 0.73789467 0.55222737 0.64141189 0.53661314 0.39326486\n [50] 0.98884759 0.36044986 0.55027084 0.67789085 0.32488306 0.59815186 0.71701208\n [57] 0.63896124 0.74077848 0.61042402 0.38334013 0.37778325 0.61272721 0.60614120\n [64] 0.46542782 0.56521390 0.36494938 0.31077039 0.37369334 0.61901978 0.73591532\n [71] 0.49817794 0.15878078 0.59018119 0.14489271 0.31291021 0.54528271 0.53837932\n [78] 0.64306717 0.62949855 0.52812346 0.63595236 0.32581235 0.47036712 0.46358964\n [85] 0.17859077 0.45889218 0.45794958 0.10963482 0.02180589 0.42709147 0.73035403\n [92] 0.53390499 0.53770732 0.44519122 0.34929836 0.63149583 0.75211662 0.63423295\n [99] 0.38832921 0.38769760 0.48820031 0.60885877 0.35757150 0.65019894 0.52691029\n[106] 0.61275493 0.54424926 0.43927380 0.51186187 0.47839782 0.55133921 0.52970471\n[113] 0.55192559 0.50476328 0.33031420 0.16730212 0.56057031 0.65929690 0.41580727\n[120] 0.50265366 0.36105810 0.48172703 0.48979012 0.63944086 0.63329353 0.53347285\n[127] 0.31985683 0.57241556 0.49803457 0.22309060 0.64427100 0.44014309 0.47771370\n[134] 0.45656992 0.46378786 0.54857884 0.63173986 0.49679121 0.44611475 0.63614786\n[141] 0.41349845 0.50397392 0.52434673 0.46401135 0.51901427 0.52564091 0.38446157\n[148] 0.41129352 0.25075016 0.51751694 0.60898038 0.30333930 0.59759239 0.63101501\n[155] 0.61240976 0.39946450 0.39078496 0.46522779 0.39674833 0.54020165 0.45773595\n[162] 0.42357942 0.49672918 0.74136252 0.64377882 0.42698818 0.33543341 0.59478782\n[169] 0.45685885 0.38123487 0.60438105 0.28997587 0.56145439 0.66966818 0.69013487\n[176] 0.66346918 0.58098172 0.40358155 0.35858528 0.72758835 0.44555859 0.51080507\n[183] 0.52872370 0.58056180 0.66054770 0.38271689 0.45637145 0.18421312 0.61764603\n[190] 0.38484259 0.44498725 0.56553288 0.62789333 0.39315332 0.60974027 0.48581314\n[197] 0.16160323 0.42132874 0.51388490 0.56321543 0.59267358 0.72000298 0.48756751\n[204] 0.41494549 0.56213348 0.37730576 0.58601628 0.56578264 0.57585324 0.54230569\n[211] 0.36812426 0.40543840 0.44407118 0.54982636 0.73813207 0.52240406 0.37923406\n[218] 0.64807340 0.61257191 0.77263120 0.41555359 0.36620385 0.30899195 0.39268806\n[225] 0.52257743 0.35032193 0.48364786 0.41506476 0.44277749 0.28072443 0.54082830\n[232] 0.56135558 0.59818071 0.64506459 0.18768075 0.12387590 0.35751070 0.52566537\n[239] 0.34884046 0.53386628 0.79423926 0.29605435 0.33459858 0.65976427 0.61097769\n[246] 0.21289654 0.36405468 0.47955687 0.41841831 0.74487924 0.64859983 0.66342718\n[253] 0.49154576 0.25838127 0.43233348 0.34276217 0.48090822 0.46060228 0.45007797\n[260] 0.52265265 0.55814497 0.53103383 0.69016382 0.81254829 0.34945356 0.55196410\n[267] 0.76354145 0.63111295 0.38258002 0.69360847 0.45292752 0.36691580 0.44868894\n[274] 0.44712522 0.33339442 0.36484451 0.38502709 0.41172577 0.31915434 0.42021397\n[281] 0.29971594 0.25053138 0.73399193 0.62400947 0.49352964 0.47548836 0.56132253\n[288] 0.64794695 0.60771962 0.70483175 0.42051432 0.37762275 0.33070252 0.28707715\n[295] 0.49330455 0.68012075 0.38863832 0.64350452 0.30807444 0.28781549 0.44037576\n[302] 0.56807934 0.45633324 0.78326490 0.53225536 0.42693770 0.72101244 0.72221471\n[309] 0.48100701 0.32349843 0.69842956 0.48529575 0.45412856 0.46427951 0.72883508\n[316] 0.31759605 0.61383261 0.52993688 0.47460640 0.45428884 0.50636056 0.70863073\n[323] 0.36606019 0.63290391 0.42453289 0.56179731 0.63999698 0.38538493 0.68865203\n[330] 0.48116468 0.29143576 0.46653583 0.50886945 0.41292812 0.36826640 0.60259957\n[337] 0.44603903 0.56105803 0.58687426 0.56012948 0.65632739 0.43648091 0.48212277\n[344] 0.29988331 0.51452493 0.27444678 0.51408833 0.66544833 0.13215547 0.31612760\n[351] 0.43776308 0.62918542 0.76192442 0.40544096 0.47799577 0.57978815 0.50584371\n[358] 0.67206003 0.50982376 0.68600311 0.64750719 0.46631450 0.48982132 0.65316235\n[365] 0.57021301 0.69370944 0.30258910 0.27909686 0.31859593 0.47390460 0.57757245\n[372] 0.27171368 0.48178371 0.45989335 0.58878901 0.68594019 0.76993825 0.71440694\n[379] 0.33207748 0.42041941 0.78058190 0.39030602 0.45601804 0.65000656 0.22627587\n[386] 0.46632460 0.57292774 0.71054290 0.58019947 0.92236046 0.34780539 0.56739920\n[393] 0.17582408 0.50012721 0.59788063 0.66694312 0.40492753 0.63287913 0.43542975\n[400] 0.31052332 0.39003352 0.73476431 0.48243597 0.78021695 0.51734665 0.78391126\n[407] 0.36553094 0.35504401 0.43198499 0.79382139 0.60093581 0.52616080 0.63295373\n[414] 0.75133879 0.41868283 0.67138687 0.25362936 0.28500154 0.62646776 0.32243822\n[421] 0.53591794 0.65471945 0.71100819 0.49103629 0.29886499 0.44981691 0.57095943\n[428] 0.35090430 0.52839266 0.22983630 0.53891801 0.68247963 0.53104624 0.67087904\n[435] 0.53512636 0.36205853 0.59856995 0.36977881 0.31198392 0.36929543 0.31175626\n[442] 0.59334178 0.50396374 0.67914907 0.46201194 0.25609066 0.51989017 0.48518120\n[449] 0.53722135 0.63773256 0.65918477 0.40439324 0.56580041 0.43308950 0.80925302\n[456] 0.60042790 0.51729635 0.25574373 0.42099300 0.43703262 0.45013234 0.62132058\n[463] 0.52934315 0.38264990 0.30687781 0.51470221 0.42653515 0.25378732 0.62345130\n[470] 0.39494568 0.36172542 0.42742077 0.68109519 0.20145650 0.71241410 0.81677475\n[477] 0.47671077 0.44884640 0.71764743 0.49187977 0.30267133 0.55760780 0.45412859\n[484] 0.44755360 0.55775745 0.48934940 0.36888305 0.77942587 0.32758783 0.46867105\n[491] 0.40950190 0.82820446 0.55789476 0.35800236 0.45580777 0.49436489 0.51263546\n[498] 0.51271529 0.57919735 0.78294877\n```\n\n#### \u5404\u5ea7\u6a19\u5024\u306e\u70b9\u306e\u5c5e\u6027\u5024\u3092\u8a2d\u5b9a\n```\npz <- as.data.frame(rep(1, 500))\ncolnames(pz) <- c(\"pz\")\n```\n\n####  _*ppp()*_ *\u95a2\u6570*\u3000\u3092\u7528\u3044\u3066\u3001_Point Pattern_ \u30c7\u30fc\u30bf\u3092\u4f5c\u6210\n#### \u203b \u4ee5\u4e0b\u3001 _?ppp()_ \u5b9f\u884c\u7d50\u679c\u3092\u629c\u7c8b\u3057\u3066\u548c\u8a33\n\n##### \u3010 \u623b\u308a\u5024 \u3011Point Pattern \u30aa\u30d6\u30b8\u30a7\u30af\u30c8\n##### \u3010 \u66f8\u5f0f \u3011 _**  ppp(x,y, ..., window, marks, check=TRUE, drop=TRUE)**_\n##### \u3010 \u5f15\u6570 \u3011 \u2460 x, y : 2\u6b21\u5143\u30c7\u30fc\u30bf\u306ex\u5ea7\u6a19\u5024\u3068y\u5ea7\u6a19\u5024 \u2461 _window_ :\u89b3\u6e2c\u5024\u306e\u7bc4\u56f2\uff08 _window_ \uff09 \n\n\n```{r:R}\npnt <- ppp(px, py, c(0,1), c(0,1))\n\nprint(pnt)\n```\n\n```\nplanar point pattern: 500 points\nwindow: rectangle = [0, 1] x [0, 1] units\n```\n\n#### \u3001_Point Pattern_ \u30c7\u30fc\u30bf\u3092\u63cf\u753b\n```{r:R}\nplot(pnt, type=\"p\")\n```\n![Chap.3.1.png](https://qiita-image-store.s3.amazonaws.com/0/43487/e97de4ae-fae0-fc20-6974-146217945f0c.png)\n\n#### _density()_ \u95a2\u6570\u3067\u5024\u306e\u5bc6\u5ea6\u5206\u5e03\u66f2\u7dda\u3092\u7b97\u51fa\n```{r:R}\nprint(density(pnt))\n```\n\n```\nreal-valued pixel image\n128 x 128 pixel array (ny, nx)\nenclosing rectangle: [0, 1] x [0, 1] units\n```\n\n```{r:R}\nplot(density(pnt), 0.1)\n```\n![Chap3.2.png](https://qiita-image-store.s3.amazonaws.com/0/43487/1455aa84-9d0c-eda4-2036-0826be09663a.png)\n\n#### _contour()_ \u95a2\u6570\u3067\u3001\u7b49\u9ad8\u7dda\u3092\u8ffd\u8a18\n```{r:R}\ncontour(density(pnt), add=T)\n```\n![Chap3.3.png](https://qiita-image-store.s3.amazonaws.com/0/43487/958db728-610e-0669-63fe-ddda386e20c0.png)\n\n### \u5404\u5ea7\u6a19\u5024\u306e\u5024\uff08\u70b9\uff09\u3092\u30b0\u30e9\u30d5\u306b\u8ffd\u8a18\n```{r:R}\nplot(pnt, type=\"p\", add=T)\n```\n![Chap3.4.png](https://qiita-image-store.s3.amazonaws.com/0/43487/f922bf64-7197-0aeb-db7d-5c4754a35c14.png)\n\n\n### x\u5ea7\u6a19 \u3068 y\u5ea7\u6a19 \u306e\u5ea7\u6a19\u5024\u306e\u7d44\u30c7\u30fc\u30bf\u3092\u3001_**cbind()**_ \u95a2\u6570\u3067\u5217\u7d50\u5408\n### _**SpatialPoints()**_ \u95a2\u6570\u3067\u3001 _**SpatialPoints**_ \u578b\u30c7\u30fc\u30bf\u306b\u578b\u5909\u63db\n```{r:R}\npnt_xy <- cbind(px, py)\npnt_sp <- SpatialPoints(data.frame(px, py))\n\nclass(pnt_sp)\n```\n\n```\n[1] \"SpatialPoints\"\nattr(,\"package\")\n[1] \"sp\"\n```\n\n### _**SpatialPointsDataFrame()**_ \u95a2\u6570\u3067\u3001 _**SpatialPointsDataFrame**_ \u578b\u30c7\u30fc\u30bf\u306b\u578b\u5909\u63db\n```{r:R}\npnt_spdf <- SpatialPointsDataFrame(pnt_sp, pz)\n\nclass(pnt_spdf)\n```\n\n```\n[1] \"SpatialPointsDataFrame\"\nattr(,\"package\")\n[1] \"sp\"\n```\n\n### \u4e2d\u8eab\u3092\u78ba\u8a8d\n```{r:R}\nprint(pnt_spdf)\n```\n\n```\n                coordinates pz\n1    (0.4877668, 0.4640115)  1\n2    (0.3964044, 0.4689889)  1\n3    (0.7393111, 0.5222775)  1\n4    (0.5074049, 0.7297588)  1\n5     (0.5477586, 0.297644)  1\n6    (0.4219417, 0.3369867)  1\n7    (0.6666681, 0.5501564)  1\n8     (0.5731946, 0.497008)  1\n9     (0.473077, 0.3207289)  1\n10   (0.5900082, 0.6700548)  1\n11   (0.4180877, 0.7234161)  1\n12   (0.3053868, 0.2681059)  1\n13    (0.6587158, 0.544926)  1\n14   (0.4592235, 0.3224201)  1\n15   (0.6377342, 0.8359226)  1\n\n        \uff08\u4e2d\u7565\uff09\n\n\n490   (0.3387417, 0.468671)  1\n491  (0.6326111, 0.4095019)  1\n492  (0.7396774, 0.8282045)  1\n493  (0.4693626, 0.5578948)  1\n494  (0.4967534, 0.3580024)  1\n495  (0.7245734, 0.4558078)  1\n496  (0.6454172, 0.4943649)  1\n497  (0.6427333, 0.5126355)  1\n498  (0.4286473, 0.5127153)  1\n499  (0.5944166, 0.5791974)  1\n500  (0.6954978, 0.7829488)  1\n```\n\n### \u30b0\u30e9\u30d5\u3092\u63cf\u753b\n```{r:R}\nplot(pnt_spdf)\n```\n![new.1.png](https://qiita-image-store.s3.amazonaws.com/0/43487/99666bd3-787a-6a37-4016-3f226225c781.png)\n\n\n#### _?quadratcount()_ \u5b9f\u884c\u7d50\u679c\u3088\u308a\u629c\u7c8b\n#### \u3010 \u8981\u7d04 \u3011 \u5ea7\u6a19\u7a7a\u9593\u306e\u5404\u6b63\u65b9\u5f62\u67a0\u306b\u5b58\u5728\u3059\u308b\u30c7\u30fc\u30bf\u70b9\u306e\u500b\u6570\u3092\u30ab\u30a6\u30f3\u30c8\u3059\u308b\u95a2\u6570\n\n> **Quadrat counting for a point pattern**\n>\n> **Description**\n>\n>Divides window into quadrats and counts the numbers of points in each quadrat.\n>\n>**Usage** \uff08\u66f8\u5f0f\uff09\n>\n> _**quadratcount(X, ...)**_\n>\n>  ## S3 method for class 'ppp'\n>quadratcount(X, nx=5, ny=nx, ...,\n               xbreaks=NULL, ybreaks=NULL, tess=NULL)\n>\n>  ## S3 method for class 'splitppp'\n>quadratcount(X, ...)\n> **Arguments** \uff08\u5f15\u6570\uff09\n>\n>X\t\n>A point pattern (object of class \"ppp\") or a split point pattern (object of class \"splitppp\").\n>\n>nx,ny\t\n>Numbers of rectangular quadrats in the x and y directions. Incompatible with xbreaks and ybreaks.\n>\n> **Additional arguments passed to quadratcount.ppp.**\n>\n>xbreaks\t\n>Numeric vector giving the x coordinates of the boundaries of the rectangular quadrats. Incompatible with nx.\n>\n>ybreaks\t\n>Numeric vector giving the y coordinates of the boundaries of the rectangular quadrats. Incompatible with ny.\n>\n>tess\t\n>Tessellation (object of class \"tess\") determining the quadrats. Incompatible with nx,ny,xbreaks,ybreaks\n>\n> **Value** \uff08\u623b\u308a\u5024\uff09\n>The value of quadratcount.ppp is a contingency table containing the number of points in each quadrat. The table is also an object of the special class \"quadratcount\" and there is a plot method for this class.\n>\n>The value of quadratcount.splitppp is a list of such contingency tables, each containing the quadrat counts for one of the component point patterns in X. This list also has the class \"listof\" which has print and plot methods.\n\n---------------------------------------------------\n\n\n```{r:R}\nquadratcount(pnt, nx=2, ny=2)\n```\n\n```\n         x\ny         [0,0.5] (0.5,1]\n  (0.5,1]     126     120\n  [0,0.5]     134     120\n```\n\n```{r:R}\nquadratcount(pnt, nx=2, ny=2)/(0.5^2)\n```\n\n```\n    x\ny         [0,0.5] (0.5,1]\n  (0.5,1]     504     480\n  [0,0.5]     536     480\n```\n\n\n```{r:R}\nplot(pnt, type=\"p\")\n```\n![new.2.png](https://qiita-image-store.s3.amazonaws.com/0/43487/229b38bd-c667-d312-02be-91daed23949d.png)\n\n#### \u30aa\u30d7\u30b7\u30e7\u30f3 _add=T_ \u3067\u3001\u6b63\u65b9\u5f62\u67a0\u306e\u67a0\u7dda\u3092\u8ffd\u8a18\u3057\u3066\u3001\u5404\u67a0\u5185\u306e\u30c7\u30fc\u30bf\u70b9 \u500b\u6570\u306e\u6570\u5024\u3082\u8ffd\u8a18\n```{r:R}\nplot(quadratcount(pnt, nx=2, ny=2), add=T, col=\"red\")\n```\n![new3.png](https://qiita-image-store.s3.amazonaws.com/0/43487/a64f7430-661d-2c5a-d09f-add5df9c17a4.png)\n\n\n```{r:R}\nquadratcount(pnt, nx=4, ny=4)\n```\n\n\n```\n            x\ny            [0,0.25] (0.25,0.5] (0.5,0.75] (0.75,1]\n  (0.75,1]          0         12         15        2\n  (0.5,0.75]       14         99         96        9\n  (0.25,0.5]        7        112        105        9\n  [0,0.25]          0          7         12        1\n```\n\n\n```{r:R}\nquadratcount(pnt, nx=4, ny=4)/(0.25^2)\n```\n\n```\n            x\ny            [0,0.25] (0.25,0.5] (0.5,0.75] (0.75,1]\n  (0.75,1]          0        192        240       32\n  (0.5,0.75]      224       1584       1536      144\n  (0.25,0.5]      112       1792       1680      144\n  [0,0.25]          0        112        192       16\n```\n\n\n```{r:R}\nplot(pnt, type=\"p\")\nplot(quadratcount(pnt, nx=4, ny=4), add=T, col=\"red\")\n```\n![add.1.png](https://qiita-image-store.s3.amazonaws.com/0/43487/c8129091-7bdf-1718-2669-4583d39ea4f9.png)\n\n#### \u89d2\u5ea7\u6a19\u70b9\u3092\u76f4\u7dda\u3067\u7d50\u3093\u3067\u3001\u30dd\u30ea\u30b4\u30f3\u3092\u4f5c\u6210\n```{r:R}\npoly1 <- cbind(\n                c(0, 0.75, 0.75, 0.5, 0.5, 0.25, 0.25, 0, 0), \n                c(0, 0, 0.25, 0.25, 0.5, 0.5, 0.75, 0.75, 0)\n               )\n\npoly2 <- cbind(\n                c(0.25, 0.75, 0.75, 0.25, 0.25), \n                c(0.5, 0.5, 0.75, 0.75, 0.5)\n               )\n\npoly3 <- cbind(\n                c(0.75, 1, 1, 0.75, 0.75, 0.5, 0.5, 0.75, 0.75), \n                c(0, 0, 0.75, 0.75, 0.5, 0.5, 0.25, 0.25, 0)\n               )\n\n\npoly4 <- cbind(\n                c(0, 1, 1, 0, 0), \n                c(0.75, 0.75, 1, 1, 0.75)\n               )\n\npoly1_pl <- Polygons(list(Polygon(poly1)), \"poly1\")\npoly2_pl <- Polygons(list(Polygon(poly2)), \"poly2\")\npoly3_pl <- Polygons(list(Polygon(poly3)), \"poly3\")\npoly4_pl <- Polygons(list(Polygon(poly4)), \"poly4\")\n```\n\n#### \u30c7\u30fc\u30bf\u578b\u5909\u63db\n```{r:R}\npoly_sp <- SpatialPolygons(list(poly1_pl, poly2_pl, poly3_pl, poly4_pl))\n\npoly_spdf <- SpatialPolygonsDataFrame(poly_sp, data.frame(c(1:4), row.names=c(\"poly1\", \"poly2\", \"poly3\", \"poly4\")))\n```\n\n#### \u63cf\u753b\u51fa\u529b\n```{r:R}\nplot(poly_spdf)\n```\n![new4.png](https://qiita-image-store.s3.amazonaws.com/0/43487/8ca8c089-90cd-67af-98b3-769e741b984a.png)\n\n```{r:R}\nplot(pnt, type=\"p\", add=T)\n```\n![new5.png](https://qiita-image-store.s3.amazonaws.com/0/43487/2fcaf729-eb74-60eb-71ec-27feb70f9c20.png)\n\n\n```{r:R}\noverlay(pnt_spdf, poly_spdf, fn=colSums)\n```\n\n```\nError in base::colSums(x, na.rm = na.rm, dims = dims, ...) : \n  'x' must be an array of at least two dimensions\nIn addition: Warning message:\n'.local' is deprecated.\nUse 'over' instead.\nSee help(\"Deprecated\") and help(\"sp-deprecated\"). \n```\n\n\n```{r:R}\narea.poly_spdf <- c(0.25^2*6, 0.25^2*2, 0.25^2*4, 0.25^2*4)\n```\n\n```{r:R}\noverlay(pnt_spdf, poly_spdf, fn=colSums)/area.poly_spdf\n```\n\n```\nError in base::colSums(x, na.rm = na.rm, dims = dims, ...) : \n  'x' must be an array of at least two dimensions\nIn addition: Warning message:\n'.local' is deprecated.\nUse 'over' instead.\nSee help(\"Deprecated\") and help(\"sp-deprecated\"). \n```\n\n\n\n\n\n\n\n\n\n"}