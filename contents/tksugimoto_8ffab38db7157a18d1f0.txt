{"tags": ["Slack", "lambda", "Terraform"], "context": "Slack\u306e\u516c\u5f0f\u30ea\u30de\u30a4\u30f3\u30c0\u30fc\u304c\uff08\u65e5\u672c\u306e\uff09\u795d\u65e5\u3092\u89e3\u91c8\u3057\u3066\u304f\u308c\u306a\u3044\u306e\u3067\u3001\u795d\u65e5\u3092\u9664\u5916\u3057\u305fSlack\u30ea\u30de\u30a4\u30f3\u30c0\u30fc\u3092\u4f5c\u308a\u307e\u3057\u305f\u3002\ntksugimoto/aws-lambda_slack-reminder-except-holiday\n\n\u7279\u5fb4\n\n\u571f\u65e5\u795d\u65e5\u306f\u30ea\u30de\u30a4\u30f3\u30c9\u3057\u306a\u3044\n\n\n\u5e74\u672b\u5e74\u59cb\u306a\u3069\u4efb\u610f\u4f11\u65e5\u3082\u8a2d\u5b9a\u53ef\u80fd\n\n\n\u30ea\u30de\u30a4\u30f3\u30c0\u30fc\u3092\u30c6\u30ad\u30b9\u30c8\u5f62\u5f0f\u3067\u7ba1\u7406\u53ef\u80fd\uff08Slack Reminder as Code\uff09\n\u30ea\u30de\u30a4\u30f3\u30c0\u30fc\u306e\u4f5c\u6210 / \u5909\u66f4\u306e\u53cd\u6620\u306f\u30b3\u30de\u30f3\u30c9\u4e00\u767a\n\n\nterraform apply\n\n\n\n\n11\u664230\u5206\u306b\u304a\u663c\u3092\u901a\u77e5\u3059\u308b\u30ea\u30de\u30a4\u30f3\u30c0\u30fc\u306e\u30ec\u30b7\u30d4\nmodule \"slack_reminder_sample\" {\n    source = \"./slack_reminder\"\n    prefix = \"${var.prefix}\"\n    iam_for_lambda_arn = \"${aws_iam_role.iam_for_lambda.arn}\"\n\n    # \u2193 \u3053\u3053\u304b\u3089\u8a2d\u5b9a \u2193\n    name = \"lunch\"\n    reminder_text = \"\u305d\u308d\u305d\u308d\u304a\u663c\u3067\u3059\"\n\n    schedule_name = \"every_day_11-30am_JST\"\n    schedule_expression = \"cron(30 2 * * ? *)\"\n\n    slack_webhook_url = \"${var.slack_webhook_url}\"\n\n    # \u795d\u65e5\u8ffd\u52a0\uff08\u5e74\u672b\u5e74\u59cb\u306a\u3069\uff09\n    additional_holidays = \"12/30-31 1/1-7\"\n}\n\n\n\n\u7d4c\u7def\n\nSlack\u306e\u30ea\u30de\u30a4\u30f3\u30c0\u30fc\u6a5f\u80fd\u3067\u5e73\u65e5\u306e\u5915\u65b9\u306b\u30ea\u30de\u30a4\u30f3\u30c9\u6295\u7a3f\u3092\u8a2d\u5b9a\u3057\u3066\u3044\u305f\n2016\u5e74\u306e\u52e4\u52b4\u611f\u8b1d\u306e\u65e5(11/23)\u306f\u6c34\u66dc\u65e5\u3060\u3063\u305f\u306e\u3067Slack\u3067\u8a2d\u5b9a\u3057\u305f\u5e73\u65e5\u306e\u307f\u306e\u30ea\u30de\u30a4\u30f3\u30c0\u30fc\u306f\u3044\u3064\u3082\u3069\u304a\u308a\u5b9f\u884c\u3055\u308c\u305f\nBOSS  \n\n\n\n\n\u4ed5\u7d44\u307f\n\n\u6bce\u65e5\u306e\u30ea\u30de\u30a4\u30f3\u30c0\u30fc\n\n\nAWS CloudWatch Events\u306e\u30b9\u30b1\u30b8\u30e5\u30fc\u30e9\u30fc\u3092\u4f7f\u3063\u3066\u6bce\u65e5\u5b9a\u523b\u306bAWS Lambda\u8d77\u52d5\nAWS Lambda\u304b\u3089Slack\u306eIncoming WebHooks\u3092\u4f7f\u3063\u3066Slack\u306b\u6295\u7a3f\n\n\nAWS Lambda\u95a2\u6570\u5185\u3067\u571f\u65e5\u30fb\u795d\u65e5\u30fb\u72ec\u81ea\u5b9a\u7fa9\u4f11\u65e5\u306e\u5224\u5b9a\u3092\u884c\u306a\u3044\u5e73\u65e5\u306e\u307f\u6295\u7a3f\n\n\n\n\n\u4e0a\u8a18\u74b0\u5883\u306e\u81ea\u52d5\u69cb\u7bc9\n\n\nTerraform\u3092\u4f7f\u7528\n\n\nTerraform\u3092\u4f7f\u3046\u3053\u3068\u3067\u30ea\u30de\u30a4\u30f3\u30c0\u30fc\u3092\u30c6\u30ad\u30b9\u30c8\u5f62\u5f0f\u3067\u7ba1\u7406\u53ef\u80fd\nAWS Lambda\u306e\u74b0\u5883\u5909\u6570\u3068Terraform\u306emodule\u6a5f\u80fd\u3067\u30ea\u30de\u30a4\u30f3\u30c0\u30fc\u306e\u8907\u6570\u5b9a\u7fa9\u3092\u30b5\u30dd\u30fc\u30c8\n\n\n\n\n\u8a2d\u5b9a\u4f8b\u30fb\u66f8\u5f0f\n\n11\u664230\u5206\u306b\u304a\u663c\u3092\u901a\u77e5\u3059\u308b\u30ea\u30de\u30a4\u30f3\u30c0\u30fc\u306e\u30ec\u30b7\u30d4(30_main.tf)\nmodule \"slack_reminder-2\" {\n    source = \"./slack_reminder\"\n    prefix = \"${var.prefix}\"\n    iam_for_lambda_arn = \"${aws_iam_role.iam_for_lambda.arn}\"\n\n    # \u2193 \u3053\u3053\u304b\u3089\u8a2d\u5b9a \u2193\n    name = \"lunch\" # AWS\u306e\u30de\u30cd\u30b8\u30e1\u30f3\u30c8\u30b3\u30f3\u30bd\u30fc\u30eb\u306b\u8868\u793a\u3055\u308c\u308b\u306e\u3067\u308f\u304b\u308a\u3084\u3059\u304f\u4e00\u610f\u306a\u3082\u306e\n    reminder_text = \"\u305d\u308d\u305d\u308d\u304a\u663c\u3067\u3059\"\n\n    schedule_name = \"every_day_11-30am_JST\" # AWS\u306e\u30de\u30cd\u30b8\u30e1\u30f3\u30c8\u30b3\u30f3\u30bd\u30fc\u30eb\u306b\u8868\u793a\u3055\u308c\u308b\u306e\u3067\u308f\u304b\u308a\u3084\u3059\u3044\u3082\u306e\n    schedule_expression = \"cron(30 2 * * ? *)\" # \u203b UTC\u306a\u306e\u3067\u65e5\u672c\u6642\u9593-9\u6642\u9593\n\n    slack_webhook_url = \"${var.slack_webhook_url}\"\n\n    # \u795d\u65e5\u8ffd\u52a0\uff08\u5e74\u672b\u5e74\u59cb\u306a\u3069\uff09\n    additional_holidays = \"12/30-31 1/1-7\"\n\n    # \u30aa\u30d7\u30b7\u30e7\u30f3\u8a2d\u5b9a\uff08\u8a2d\u5b9a\u306a\u3057/\u7a7a\u6587\u5b57\u306e\u5834\u5408\u306fWebhook\u306e\u30c7\u30d5\u30a9\u30eb\u30c8\u5024\uff09\n    channel = \"#random\"\n    username = \"reminder bot\"\n    icon_emoji = \":bento:\"\n}\n\n\n\u203b \u9069\u5207\u306a\u30b7\u30f3\u30bf\u30c3\u30af\u30b9\u30cf\u30a4\u30e9\u30a4\u30c8\u304c\u7121\u304b\u3063\u305f\u306e\u3067\u3001\u4e00\u756a\u898b\u3084\u3059\u3044\u3068\u601d\u3063\u305fbash\u306b\u3057\u3066\u3042\u308a\u307e\u3059\n\u2191\u306e\u30ea\u30de\u30a4\u30f3\u30c0\u30fc\u306f\u2193\u306e\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002 \n2016\u5e74\u306e\u5929\u7687\u8a95\u751f\u65e512/23(\u91d1)\u306b\u306f\u30ea\u30de\u30a4\u30f3\u30c9\u3055\u308c\u3066\u306a\u3044\u3053\u3068\u304c\u78ba\u8a8d\u3067\u304d\u307e\u3059\u3002\n\n\u8a2d\u5b9a\u306e\u30b5\u30f3\u30d7\u30eb 30_main.tf.sample \u3092\u898b\u3066\u3082\u3089\u3048\u308c\u3070\u3069\u3093\u306a\u66f8\u304d\u65b9\u304c\u3042\u308b\u306e\u304b\u5206\u304b\u308a\u3084\u3059\u3044\u3068\u601d\u3044\u307e\u3059\u3002\n\u6ce8\u610f\u70b9\u306f\u3001\u30b9\u30b1\u30b8\u30e5\u30fc\u30e9\u30fc\u306fUTC\u306a\u306e\u3067\u3001 schedule_expression \u306b\u66f8\u304f\u6642\u523b\u306f\u65e5\u672c\u6642\u9593-9\u6642\u9593\u3067\u3042\u308b\u5fc5\u8981\u304c\u3042\u308b\u3053\u3068\u3067\u3059\u3002\n\u30b9\u30b1\u30b8\u30e5\u30fc\u30eb\u66f8\u5f0f\u306e\u8a73\u7d30\u306f \u2192 Rate \u307e\u305f\u306f Cron \u3092\u4f7f\u7528\u3057\u305f\u30b9\u30b1\u30b8\u30e5\u30fc\u30eb\u5f0f - AWS Lambda\n\n\u4f7f\u3044\u65b9\ntksugimoto/aws-lambda_slack-reminder-except-holiday\u306eREADME\u53c2\u7167\u3002\n\n\u6599\u91d1\n\u901a\u5e38\u306e\u30ea\u30de\u30a4\u30f3\u30c0\u30fc\u306a\u3089\u7121\u6599\u67a0\u5185\u3067\u53ce\u307e\u308a\u307e\u3059\u3002\n\n\u5b9f\u884c\u74b0\u5883 AWS Lambda\n\n\u7121\u6599\u67a0\u304c\u591a\u3044\u306e\u3067\u3053\u306e\u30ea\u30de\u30a4\u30f3\u30c0\u30fc\u306b\u3088\u3063\u3066\u8ab2\u91d1\u3055\u308c\u308b\u3053\u3068\u306f\u901a\u5e38\u306f\u7121\u3044\u3068\u601d\u308f\u308c\u307e\u3059\u3002\n\n100 \u4e07\u4ef6\u00a01 \u304b\u6708\u3042\u305f\u308a\u306e\u7121\u6599\u30ea\u30af\u30a8\u30b9\u30c8\u6570\n1 \u304b\u6708\u3042\u305f\u308a\u6700\u5927 320 \u4e07\u79d2\u00a01 \u304b\u6708\u3042\u305f\u308a\u306e\u30b3\u30f3\u30d4\u30e5\u30fc\u30c6\u30a3\u30f3\u30b0\u6642\u9593\n12 \u304b\u6708\u9593\u306e AWS \u7121\u6599\u5229\u7528\u67a0\u671f\u9593\u7d42\u4e86\u5f8c\u306b\u3082\u671f\u9650\u5207\u308c\u306b\u306a\u308a\u307e\u305b\u3093\u3002\n\n\u7121\u6599\u306e\u30af\u30e9\u30a6\u30c9\u30b5\u30fc\u30d3\u30b9 | AWS \u7121\u6599\u5229\u7528\u67a0\n\u5b9f\u969b\u306e\u5b9f\u884c\u6642\u9593\u306e\u30ed\u30b0\uff08\u4e00\u4f8b\uff09\u3092\u4ee5\u4e0b\u306b\u793a\u3057\u307e\u3059\u3002\n\n\u4f11\u65e5\uff08Slack\u3078\u306e\u901a\u4fe1\u306a\u3057\uff09\nDuration:  6.08 ms  Billed Duration:  100 ms Memory Size: 128 MB    Max Memory Used: 17 MB\nDuration:  2.08 ms  Billed Duration:  100 ms Memory Size: 128 MB    Max Memory Used: 12 MB\nDuration: 49.61 ms  Billed Duration:  100 ms Memory Size: 128 MB    Max Memory Used: 16 MB\n\n\n\n\u5e73\u65e5\uff08Slack\u3078\u306e\u901a\u4fe1\u3042\u308a\uff09\nDuration: 749.63 ms Billed Duration:  800 ms Memory Size: 128 MB    Max Memory Used: 18 MB\nDuration: 983.10 ms Billed Duration: 1000 ms Memory Size: 128 MB    Max Memory Used: 20 MB\nDuration: 719.58 ms Billed Duration:  800 ms Memory Size: 128 MB    Max Memory Used: 20 MB\n\n\nSlack\uff08Incoming Webhooks\uff09\u3078\u901a\u4fe1\u3057\u306a\u3044\u4f11\u65e5\u306f100 ms\u4ee5\u4e0b\u3067\u3001\u901a\u4fe1\u3059\u308b\u5e73\u65e5\u306f800m s\u7a0b\u5ea6\u3067\u3057\u305f\u3002\n\u7c21\u5358\u306e\u305f\u3081\u306b\u6bce\u65e5\u304c\u5e73\u65e5\u30671000 ms / day / reminder\u306eLambda\u5b9f\u884c\u304c\u3055\u308c\u305f\u3068\u3059\u308b\u3068\u3001\u7121\u6599\u67a0\u3092\u8d85\u3048\u308b\u306b\u306f\u7d0410\u4e07\u30ea\u30de\u30a4\u30f3\u30c0\u30fc\u306e\u8a2d\u5b9a\u304c\u5fc5\u8981\u3067\u3059\u3002\u3053\u308c\u306f1\u79d2\u306b1\u56de\u4ee5\u4e0a\u30ea\u30de\u30a4\u30f3\u30c9\u3055\u308c\u308b\u8a08\u7b97\u306b\u306a\u308a\u307e\u3059\u3002\n\u306a\u304a\u3001\u7121\u6599\u67a0\u3092\u65e2\u306b\u8d85\u3048\u3066\u3044\u308b\u5834\u5408\u306f\u3001\u30e1\u30e2\u30ea\u306e\u6700\u5c0f\u5358\u4f4d128MB\u3067 $ 0.000000208 / 100 ms \u306a\u306e\u3067\u30011\u7a2e\u985e\u306e\u30ea\u30de\u30a4\u30f3\u30c0\u30fc\u30921\u30f6\u6708\u52d5\u304b\u3059\u3068\u3001\n$\\, 0.000000208 / 100\\, \\mathrm{ms} \\times 1\\, \\mathrm{s} / \\mathrm{reminder} \\times 31\\, \\mathrm{reminder} / \\mathrm{month} = $\\, 0.00006448 / \\mathrm{month}\n$0.000000208/100ms\u00d71s/reminder\u00d731reminder/month=$0.00006448/month$0.000000208/100ms\u00d71s/reminder\u00d731reminder/month=$0.00006448/month{$\\, 0.000000208 / 100\\, \\mathrm{ms} \\times 1\\, \\mathrm{s} / \\mathrm{reminder} \\times 31\\, \\mathrm{reminder} / \\mathrm{month} = $\\, 0.00006448 / \\mathrm{month}\n}\n\u65e5\u672c\u5186\u3067\u7d04 0.007\u5186\u3068\u306a\u308a\u307e\u3059\u3002\n\n\u5b9a\u671f\u7684\u306a\u5b9f\u884c AWS CloudWatch Events\n\n\u3068\u3066\u3082\u5b89\u3044\u306e\u3067\u7121\u8996\u3057\u3066\u3088\u3044\u3068\u601d\u3044\u307e\u3059\u3002\n100\u4e07\u30ea\u30af\u30a8\u30b9\u30c8\u3067 $1 \u3060\u305d\u3046\u306a\u306e\u3067\u3001\u7d04300\u7a2e\u985e\u306e\u30ea\u30de\u30a4\u30f3\u30c0\u30fc\u30921\u30f6\u6708\u52d5\u304b\u3059\u30681\u5186\u306b\u306a\u308a\u307e\u3059\u3002\n\nAmazon CloudWatch Events - Custom Events\n$1.00 per million custom events generated\n\n\u6599\u91d1 - AWS CloudWatch | AWS\n\n\u795d\u65e5\u5224\u5b9a\nNode.js\u306epackage japanese-holidays \u3092\u4f7f\u3063\u3066\u3044\u307e\u3059\u3002\nnpm\u3067\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3067\u304d\u3066\u3001\u4f9d\u5b58\u304c\u5c11\u306a\u3044\u3082\u306e\u3092\u9078\u629e\u3057\u307e\u3057\u305f\u3002\n\u305d\u306e\u5e74\u306e\u795d\u65e5\u3092\u3059\u3079\u3066\u8a08\u7b97\u3057\u3066\u3044\u308b\u306e\u3067\u82e5\u5e72\u8a08\u7b97\u91cf\u304c\u591a\u3044\u3067\u3059\u304c\u3001AWS Lambda\u304c\u5341\u5206\u9ad8\u901f\uff061\u30ea\u30de\u30a4\u30f3\u30c0\u30fc\u30671\u56de\u3057\u304b\u547c\u3070\u306a\u3044\u306e\u3067\u8a08\u7b97\u6642\u9593\u306f\u8aa4\u5dee\u3068\u5224\u65ad\u3057\u307e\u3057\u305f\u3002\n\nQiita: \u65e5\u672c\u306e\u4f11\u65e5\u3092\u6c42\u3081\u308b\uff08\u4f11\u65e5\u5224\u5b9a\uff09 - Qiita\n\nnpmjs: japanese-holidays\n\n\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9(GitHub): osamutake/japanese-holidays-js: Provides utilities to manipulate japanese holidays.\n\n\nSlack\u306e\u516c\u5f0f\u30ea\u30de\u30a4\u30f3\u30c0\u30fc\u304c\uff08\u65e5\u672c\u306e\uff09\u795d\u65e5\u3092\u89e3\u91c8\u3057\u3066\u304f\u308c\u306a\u3044\u306e\u3067\u3001\u795d\u65e5\u3092\u9664\u5916\u3057\u305fSlack\u30ea\u30de\u30a4\u30f3\u30c0\u30fc\u3092\u4f5c\u308a\u307e\u3057\u305f\u3002\n\n[tksugimoto/aws-lambda_slack-reminder-except-holiday](https://github.com/tksugimoto/aws-lambda_slack-reminder-except-holiday \"https://github.com/tksugimoto/aws-lambda_slack-reminder-except-holiday\")\n\n# \u7279\u5fb4\n* \u571f\u65e5\u795d\u65e5\u306f\u30ea\u30de\u30a4\u30f3\u30c9\u3057\u306a\u3044\n    * \u5e74\u672b\u5e74\u59cb\u306a\u3069\u4efb\u610f\u4f11\u65e5\u3082\u8a2d\u5b9a\u53ef\u80fd\n* \u30ea\u30de\u30a4\u30f3\u30c0\u30fc\u3092\u30c6\u30ad\u30b9\u30c8\u5f62\u5f0f\u3067\u7ba1\u7406\u53ef\u80fd\uff08**Slack Reminder as Code**\uff09\n* \u30ea\u30de\u30a4\u30f3\u30c0\u30fc\u306e\u4f5c\u6210 / \u5909\u66f4\u306e\u53cd\u6620\u306f\u30b3\u30de\u30f3\u30c9\u4e00\u767a\n    * `terraform apply`\n\n```bash:11\u664230\u5206\u306b\u304a\u663c\u3092\u901a\u77e5\u3059\u308b\u30ea\u30de\u30a4\u30f3\u30c0\u30fc\u306e\u30ec\u30b7\u30d4\nmodule \"slack_reminder_sample\" {\n\tsource = \"./slack_reminder\"\n\tprefix = \"${var.prefix}\"\n\tiam_for_lambda_arn = \"${aws_iam_role.iam_for_lambda.arn}\"\n\n\t# \u2193 \u3053\u3053\u304b\u3089\u8a2d\u5b9a \u2193\n\tname = \"lunch\"\n\treminder_text = \"\u305d\u308d\u305d\u308d\u304a\u663c\u3067\u3059\"\n\n\tschedule_name = \"every_day_11-30am_JST\"\n\tschedule_expression = \"cron(30 2 * * ? *)\"\n\n\tslack_webhook_url = \"${var.slack_webhook_url}\"\n\n\t# \u795d\u65e5\u8ffd\u52a0\uff08\u5e74\u672b\u5e74\u59cb\u306a\u3069\uff09\n\tadditional_holidays = \"12/30-31 1/1-7\"\n}\n```\n\n# \u7d4c\u7def\n1. Slack\u306e\u30ea\u30de\u30a4\u30f3\u30c0\u30fc\u6a5f\u80fd\u3067\u5e73\u65e5\u306e\u5915\u65b9\u306b\u30ea\u30de\u30a4\u30f3\u30c9\u6295\u7a3f\u3092\u8a2d\u5b9a\u3057\u3066\u3044\u305f\n2. 2016\u5e74\u306e\u52e4\u52b4\u611f\u8b1d\u306e\u65e5(11/23)\u306f\u6c34\u66dc\u65e5\u3060\u3063\u305f\u306e\u3067Slack\u3067\u8a2d\u5b9a\u3057\u305f\u5e73\u65e5\u306e\u307f\u306e\u30ea\u30de\u30a4\u30f3\u30c0\u30fc\u306f\u3044\u3064\u3082\u3069\u304a\u308a\u5b9f\u884c\u3055\u308c\u305f\n3. BOSS :angry: :anger:     \n    ![\u795d\u65e5\u306eSlack reminder\u306b\u6fc0\u304a\u3053.png](https://qiita-image-store.s3.amazonaws.com/0/92375/1c78fec9-6fa8-0203-3866-9d839ec5f120.png)\n\n\n# \u4ed5\u7d44\u307f\n## \u6bce\u65e5\u306e\u30ea\u30de\u30a4\u30f3\u30c0\u30fc\n1. [AWS CloudWatch Events](http://docs.aws.amazon.com/ja_jp/AmazonCloudWatch/latest/events/WhatIsCloudWatchEvents.html \"http://docs.aws.amazon.com/ja_jp/AmazonCloudWatch/latest/events/WhatIsCloudWatchEvents.html\")\u306e\u30b9\u30b1\u30b8\u30e5\u30fc\u30e9\u30fc\u3092\u4f7f\u3063\u3066\u6bce\u65e5\u5b9a\u523b\u306b[AWS Lambda](http://docs.aws.amazon.com/ja_jp/lambda/latest/dg/welcome.html \"http://docs.aws.amazon.com/ja_jp/lambda/latest/dg/welcome.html\")\u8d77\u52d5\n2. AWS Lambda\u304b\u3089Slack\u306e[Incoming WebHooks](https://api.slack.com/incoming-webhooks \"https://api.slack.com/incoming-webhooks\")\u3092\u4f7f\u3063\u3066Slack\u306b\u6295\u7a3f\n    * AWS Lambda\u95a2\u6570\u5185\u3067\u571f\u65e5\u30fb\u795d\u65e5\u30fb\u72ec\u81ea\u5b9a\u7fa9\u4f11\u65e5\u306e\u5224\u5b9a\u3092\u884c\u306a\u3044\u5e73\u65e5\u306e\u307f\u6295\u7a3f\n\n## \u4e0a\u8a18\u74b0\u5883\u306e\u81ea\u52d5\u69cb\u7bc9\n* [Terraform](https://www.terraform.io/ \"https://www.terraform.io/\")\u3092\u4f7f\u7528\n    * Terraform\u3092\u4f7f\u3046\u3053\u3068\u3067\u30ea\u30de\u30a4\u30f3\u30c0\u30fc\u3092\u30c6\u30ad\u30b9\u30c8\u5f62\u5f0f\u3067\u7ba1\u7406\u53ef\u80fd\n    * AWS Lambda\u306e\u74b0\u5883\u5909\u6570\u3068Terraform\u306emodule\u6a5f\u80fd\u3067\u30ea\u30de\u30a4\u30f3\u30c0\u30fc\u306e\u8907\u6570\u5b9a\u7fa9\u3092\u30b5\u30dd\u30fc\u30c8\n\n# \u8a2d\u5b9a\u4f8b\u30fb\u66f8\u5f0f\n```bash:11\u664230\u5206\u306b\u304a\u663c\u3092\u901a\u77e5\u3059\u308b\u30ea\u30de\u30a4\u30f3\u30c0\u30fc\u306e\u30ec\u30b7\u30d4(30_main.tf)\nmodule \"slack_reminder-2\" {\n\tsource = \"./slack_reminder\"\n\tprefix = \"${var.prefix}\"\n\tiam_for_lambda_arn = \"${aws_iam_role.iam_for_lambda.arn}\"\n\n\t# \u2193 \u3053\u3053\u304b\u3089\u8a2d\u5b9a \u2193\n\tname = \"lunch\" # AWS\u306e\u30de\u30cd\u30b8\u30e1\u30f3\u30c8\u30b3\u30f3\u30bd\u30fc\u30eb\u306b\u8868\u793a\u3055\u308c\u308b\u306e\u3067\u308f\u304b\u308a\u3084\u3059\u304f\u4e00\u610f\u306a\u3082\u306e\n\treminder_text = \"\u305d\u308d\u305d\u308d\u304a\u663c\u3067\u3059\"\n\n\tschedule_name = \"every_day_11-30am_JST\" # AWS\u306e\u30de\u30cd\u30b8\u30e1\u30f3\u30c8\u30b3\u30f3\u30bd\u30fc\u30eb\u306b\u8868\u793a\u3055\u308c\u308b\u306e\u3067\u308f\u304b\u308a\u3084\u3059\u3044\u3082\u306e\n\tschedule_expression = \"cron(30 2 * * ? *)\" # \u203b UTC\u306a\u306e\u3067\u65e5\u672c\u6642\u9593-9\u6642\u9593\n\n\tslack_webhook_url = \"${var.slack_webhook_url}\"\n\n\t# \u795d\u65e5\u8ffd\u52a0\uff08\u5e74\u672b\u5e74\u59cb\u306a\u3069\uff09\n\tadditional_holidays = \"12/30-31 1/1-7\"\n\n\t# \u30aa\u30d7\u30b7\u30e7\u30f3\u8a2d\u5b9a\uff08\u8a2d\u5b9a\u306a\u3057/\u7a7a\u6587\u5b57\u306e\u5834\u5408\u306fWebhook\u306e\u30c7\u30d5\u30a9\u30eb\u30c8\u5024\uff09\n\tchannel = \"#random\"\n\tusername = \"reminder bot\"\n\ticon_emoji = \":bento:\"\n}\n```\n\u203b \u9069\u5207\u306a\u30b7\u30f3\u30bf\u30c3\u30af\u30b9\u30cf\u30a4\u30e9\u30a4\u30c8\u304c\u7121\u304b\u3063\u305f\u306e\u3067\u3001\u4e00\u756a\u898b\u3084\u3059\u3044\u3068\u601d\u3063\u305fbash\u306b\u3057\u3066\u3042\u308a\u307e\u3059\n\n\u2191\u306e\u30ea\u30de\u30a4\u30f3\u30c0\u30fc\u306f\u2193\u306e\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002 \n2016\u5e74\u306e\u5929\u7687\u8a95\u751f\u65e512/23(\u91d1)\u306b\u306f\u30ea\u30de\u30a4\u30f3\u30c9\u3055\u308c\u3066\u306a\u3044\u3053\u3068\u304c\u78ba\u8a8d\u3067\u304d\u307e\u3059\u3002\n![image](https://qiita-image-store.s3.amazonaws.com/0/92375/0756c3dc-3b86-e13e-4364-1f0bfb742ced.png)\n\n\u8a2d\u5b9a\u306e\u30b5\u30f3\u30d7\u30eb [30_main.tf.sample](https://github.com/tksugimoto/aws-lambda_slack-reminder-except-holiday/blob/master/30_main.tf.sample \"https://github.com/tksugimoto/aws-lambda_slack-reminder-except-holiday/blob/master/30_main.tf.sample\") \u3092\u898b\u3066\u3082\u3089\u3048\u308c\u3070\u3069\u3093\u306a\u66f8\u304d\u65b9\u304c\u3042\u308b\u306e\u304b\u5206\u304b\u308a\u3084\u3059\u3044\u3068\u601d\u3044\u307e\u3059\u3002\n\u6ce8\u610f\u70b9\u306f\u3001\u30b9\u30b1\u30b8\u30e5\u30fc\u30e9\u30fc\u306fUTC\u306a\u306e\u3067\u3001 `schedule_expression` \u306b\u66f8\u304f\u6642\u523b\u306f\u65e5\u672c\u6642\u9593-9\u6642\u9593\u3067\u3042\u308b\u5fc5\u8981\u304c\u3042\u308b\u3053\u3068\u3067\u3059\u3002\n\u30b9\u30b1\u30b8\u30e5\u30fc\u30eb\u66f8\u5f0f\u306e\u8a73\u7d30\u306f \u2192 [Rate \u307e\u305f\u306f Cron \u3092\u4f7f\u7528\u3057\u305f\u30b9\u30b1\u30b8\u30e5\u30fc\u30eb\u5f0f - AWS Lambda](http://docs.aws.amazon.com/ja_jp/lambda/latest/dg/tutorial-scheduled-events-schedule-expressions.html \"http://docs.aws.amazon.com/ja_jp/lambda/latest/dg/tutorial-scheduled-events-schedule-expressions.html\")\n\n# \u4f7f\u3044\u65b9\n[tksugimoto/aws-lambda_slack-reminder-except-holiday](https://github.com/tksugimoto/aws-lambda_slack-reminder-except-holiday \"https://github.com/tksugimoto/aws-lambda_slack-reminder-\u8a73\u3057\u304f\u306fexcept-holiday\")\u306eREADME\u53c2\u7167\u3002\n\n# \u6599\u91d1\n\u901a\u5e38\u306e\u30ea\u30de\u30a4\u30f3\u30c0\u30fc\u306a\u3089\u7121\u6599\u67a0\u5185\u3067\u53ce\u307e\u308a\u307e\u3059\u3002\n\n## \u5b9f\u884c\u74b0\u5883 [AWS Lambda](http://docs.aws.amazon.com/ja_jp/lambda/latest/dg/welcome.html \"http://docs.aws.amazon.com/ja_jp/lambda/latest/dg/welcome.html\")\n\u7121\u6599\u67a0\u304c\u591a\u3044\u306e\u3067\u3053\u306e\u30ea\u30de\u30a4\u30f3\u30c0\u30fc\u306b\u3088\u3063\u3066\u8ab2\u91d1\u3055\u308c\u308b\u3053\u3068\u306f\u901a\u5e38\u306f\u7121\u3044\u3068\u601d\u308f\u308c\u307e\u3059\u3002\n\n> **100 \u4e07\u4ef6**\u00a01 \u304b\u6708\u3042\u305f\u308a\u306e\u7121\u6599\u30ea\u30af\u30a8\u30b9\u30c8\u6570\n> **1 \u304b\u6708\u3042\u305f\u308a\u6700\u5927 320 \u4e07\u79d2**\u00a01 \u304b\u6708\u3042\u305f\u308a\u306e\u30b3\u30f3\u30d4\u30e5\u30fc\u30c6\u30a3\u30f3\u30b0\u6642\u9593\n> 12 \u304b\u6708\u9593\u306e AWS \u7121\u6599\u5229\u7528\u67a0\u671f\u9593\u7d42\u4e86\u5f8c\u306b\u3082\u671f\u9650\u5207\u308c\u306b\u306a\u308a\u307e\u305b\u3093\u3002\n\n[\u7121\u6599\u306e\u30af\u30e9\u30a6\u30c9\u30b5\u30fc\u30d3\u30b9 | AWS \u7121\u6599\u5229\u7528\u67a0](https://aws.amazon.com/jp/free/ \"https://aws.amazon.com/jp/free/\")\n\n\u5b9f\u969b\u306e\u5b9f\u884c\u6642\u9593\u306e\u30ed\u30b0\uff08\u4e00\u4f8b\uff09\u3092\u4ee5\u4e0b\u306b\u793a\u3057\u307e\u3059\u3002\n\n```text:\u4f11\u65e5\uff08Slack\u3078\u306e\u901a\u4fe1\u306a\u3057\uff09\nDuration:  6.08 ms\tBilled Duration:  100 ms Memory Size: 128 MB\tMax Memory Used: 17 MB\nDuration:  2.08 ms\tBilled Duration:  100 ms Memory Size: 128 MB\tMax Memory Used: 12 MB\nDuration: 49.61 ms\tBilled Duration:  100 ms Memory Size: 128 MB\tMax Memory Used: 16 MB\n```\n```text:\u5e73\u65e5\uff08Slack\u3078\u306e\u901a\u4fe1\u3042\u308a\uff09\nDuration: 749.63 ms\tBilled Duration:  800 ms Memory Size: 128 MB\tMax Memory Used: 18 MB\nDuration: 983.10 ms\tBilled Duration: 1000 ms Memory Size: 128 MB\tMax Memory Used: 20 MB\nDuration: 719.58 ms\tBilled Duration:  800 ms Memory Size: 128 MB\tMax Memory Used: 20 MB\n```\n\nSlack\uff08Incoming Webhooks\uff09\u3078\u901a\u4fe1\u3057\u306a\u3044\u4f11\u65e5\u306f`100 ms`\u4ee5\u4e0b\u3067\u3001\u901a\u4fe1\u3059\u308b\u5e73\u65e5\u306f`800m s`\u7a0b\u5ea6\u3067\u3057\u305f\u3002\n\n\u7c21\u5358\u306e\u305f\u3081\u306b\u6bce\u65e5\u304c\u5e73\u65e5\u3067`1000 ms / day / reminder`\u306eLambda\u5b9f\u884c\u304c\u3055\u308c\u305f\u3068\u3059\u308b\u3068\u3001\u7121\u6599\u67a0\u3092\u8d85\u3048\u308b\u306b\u306f\u7d0410\u4e07\u30ea\u30de\u30a4\u30f3\u30c0\u30fc\u306e\u8a2d\u5b9a\u304c\u5fc5\u8981\u3067\u3059\u3002\u3053\u308c\u306f1\u79d2\u306b1\u56de\u4ee5\u4e0a\u30ea\u30de\u30a4\u30f3\u30c9\u3055\u308c\u308b\u8a08\u7b97\u306b\u306a\u308a\u307e\u3059\u3002\n\u306a\u304a\u3001\u7121\u6599\u67a0\u3092\u65e2\u306b\u8d85\u3048\u3066\u3044\u308b\u5834\u5408\u306f\u3001\u30e1\u30e2\u30ea\u306e\u6700\u5c0f\u5358\u4f4d128MB\u3067 `$ 0.000000208 / 100 ms` \u306a\u306e\u3067\u30011\u7a2e\u985e\u306e\u30ea\u30de\u30a4\u30f3\u30c0\u30fc\u30921\u30f6\u6708\u52d5\u304b\u3059\u3068\u3001\n\n```math\n$\\, 0.000000208 / 100\\, \\mathrm{ms} \\times 1\\, \\mathrm{s} / \\mathrm{reminder} \\times 31\\, \\mathrm{reminder} / \\mathrm{month} = $\\, 0.00006448 / \\mathrm{month}\n```\n\u65e5\u672c\u5186\u3067\u7d04 0.007\u5186\u3068\u306a\u308a\u307e\u3059\u3002\n\n## \u5b9a\u671f\u7684\u306a\u5b9f\u884c [AWS CloudWatch Events](http://docs.aws.amazon.com/ja_jp/AmazonCloudWatch/latest/events/WhatIsCloudWatchEvents.html \"http://docs.aws.amazon.com/ja_jp/AmazonCloudWatch/latest/events/WhatIsCloudWatchEvents.html\")\n\u3068\u3066\u3082\u5b89\u3044\u306e\u3067\u7121\u8996\u3057\u3066\u3088\u3044\u3068\u601d\u3044\u307e\u3059\u3002\n100\u4e07\u30ea\u30af\u30a8\u30b9\u30c8\u3067 `$1` \u3060\u305d\u3046\u306a\u306e\u3067\u3001\u7d04300\u7a2e\u985e\u306e\u30ea\u30de\u30a4\u30f3\u30c0\u30fc\u30921\u30f6\u6708\u52d5\u304b\u3059\u30681\u5186\u306b\u306a\u308a\u307e\u3059\u3002\n\n> **Amazon CloudWatch Events - Custom Events**\n> $1.00 per million custom events generated\n\n[\u6599\u91d1 - AWS CloudWatch | AWS](https://aws.amazon.com/jp/cloudwatch/pricing/ \"https://aws.amazon.com/jp/cloudwatch/pricing/\")\n\n\n# \u795d\u65e5\u5224\u5b9a\nNode.js\u306epackage [japanese-holidays](https://www.npmjs.com/package/japanese-holidays \"https://www.npmjs.com/package/japanese-holidays\") \u3092\u4f7f\u3063\u3066\u3044\u307e\u3059\u3002\nnpm\u3067\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3067\u304d\u3066\u3001\u4f9d\u5b58\u304c\u5c11\u306a\u3044\u3082\u306e\u3092\u9078\u629e\u3057\u307e\u3057\u305f\u3002\n\u305d\u306e\u5e74\u306e\u795d\u65e5\u3092\u3059\u3079\u3066\u8a08\u7b97\u3057\u3066\u3044\u308b\u306e\u3067\u82e5\u5e72\u8a08\u7b97\u91cf\u304c\u591a\u3044\u3067\u3059\u304c\u3001AWS Lambda\u304c\u5341\u5206\u9ad8\u901f\uff061\u30ea\u30de\u30a4\u30f3\u30c0\u30fc\u30671\u56de\u3057\u304b\u547c\u3070\u306a\u3044\u306e\u3067\u8a08\u7b97\u6642\u9593\u306f\u8aa4\u5dee\u3068\u5224\u65ad\u3057\u307e\u3057\u305f\u3002\n\n* Qiita: [\u65e5\u672c\u306e\u4f11\u65e5\u3092\u6c42\u3081\u308b\uff08\u4f11\u65e5\u5224\u5b9a\uff09 - Qiita](http://qiita.com/osamu_takeuchi/items/0623c8aceda43b57914c \"http://qiita.com/osamu_takeuchi/items/0623c8aceda43b57914c\")\n* npmjs: [japanese-holidays](https://www.npmjs.com/package/japanese-holidays \"https://www.npmjs.com/package/japanese-holidays\")\n* \u30bd\u30fc\u30b9\u30b3\u30fc\u30c9(GitHub): [osamutake/japanese-holidays-js: Provides utilities to manipulate japanese holidays.](https://github.com/osamutake/japanese-holidays-js \"https://github.com/osamutake/japanese-holidays-js\")\n"}