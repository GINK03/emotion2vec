{"context": "\n\n1 \u691c\u8a3c\u74b0\u5883\n[root@master1 ~]# cat /etc/redhat-release\nCentOS Linux release 7.2.1511 (Core)\n\n\n\n2 dnsmasq\u3068\u306f\n\ndnsmasq - A lightweight DHCP and caching DNS server.\n\n\n3 dnsmasq\u8d77\u52d5&\u505c\u6b62\n53\u756a\u30dd\u30fc\u30c8\u306f\u4f7f\u308f\u308c\u3066\u3044\u306a\u3044\u3002\n[root@master1 ~]# lsof -i:53\n[root@master1 ~]#\n\ndnsmasq\u3092\u8d77\u52d5\u3059\u308b\u3002\u30dd\u30fc\u30c8\u756a\u53f753\u304c\u4f7f\u308f\u308c\u305f\u3053\u3068\u304c\u308f\u304b\u308b\u3002\n[root@master1 ~]# systemctl start dnsmasq\n[root@master1 ~]# lsof -i:53\nCOMMAND   PID   USER   FD   TYPE DEVICE SIZE/OFF NODE NAME\ndnsmasq 11677 nobody    4u  IPv4  99963      0t0  UDP *:domain\ndnsmasq 11677 nobody    5u  IPv4  99964      0t0  TCP *:domain (LISTEN)\ndnsmasq 11677 nobody    6u  IPv6  99965      0t0  UDP *:domain\ndnsmasq 11677 nobody    7u  IPv6  99966      0t0  TCP *:domain (LISTEN)\n[root@master1 ~]#\n\ndnsmasq\u3092\u505c\u6b62\u3059\u308b\u3002\n[root@master1 ~]# systemctl stop dnsmasq\n[root@master1 ~]# lsof -i:53\n[root@master1 ~]#\n\n\n\n4 \u30ad\u30e3\u30c3\u30b7\u30e5\u306e\u6709\u52b9\u6027\u3092\u78ba\u8a8d\nnameserver\u3068\u3057\u3066127.0.0.1\u3092\u8ffd\u52a0\u3059\u308b\u3002\u3064\u307e\u308a\u3001dig\u30b3\u30de\u30f3\u30c9\u3067\u540d\u524d\u89e3\u6c7a\u3092\u3059\u308b\u3068\u3001dnsmasq\u306b\u554f\u3044\u5408\u308f\u305b\u3092\u3059\u308b\u3088\u3046\u306b\u306a\u308b\u3002\n[root@master1 ~]# cat /etc/resolv.conf\n# Generated by NetworkManager\nnameserver 127.0.0.1\nnameserver 8.8.8.8\n[root@master1 ~]#\n\n\u5225\u30bf\u30fc\u30df\u30ca\u30eb\u3067tcpdump\u3092\u8d77\u52d5\u3059\u308b\u3002\n[root@master1 ~]# tcpdump -i eth0 port 53 -n\n\ndig\u3092\u5b9f\u884c\u3059\u308b\u3002\n[root@master1 ~]# dig ntp.nict.jp +short\n133.243.238.243\n133.243.238.244\n133.243.238.163\n133.243.238.164\n\n1\u56de\u76ee\u306edig\u3092\u5b9f\u884c\u3059\u308b\u3068\u3001google\u306e\u516c\u958bDNS\u30b5\u30fc\u30d0(8.8.8.8)\u306b\u554f\u3044\u5408\u308f\u305b\u3092\u3057\u3066\u3044\u308b\u3002\n[root@master1 ~]# tcpdump -i eth0 port 53 -n\ntcpdump: verbose output suppressed, use -v or -vv for full protocol decode\nlistening on eth0, link-type EN10MB (Ethernet), capture size 65535 bytes\n22:04:03.991370 IP 192.168.0.10.34228 > 8.8.8.8.domain: 18634+ [1au] A? ntp.nict.jp. (40)\n22:04:04.012549 IP 8.8.8.8.domain > 192.168.0.10.34228: 18634 4/0/1 A 133.243.238.243, A 133.243.238.164, A 133.243.238.163, A 133.243.238.244 (104)\n\n2\u56de\u76ee\u306edig\u306f\u516c\u958bDNS\u30b5\u30fc\u30d0\u306b\u554f\u3044\u5408\u308f\u305b\u306f\u305b\u305a\u30011\u56de\u76ee\u306b\u5f97\u305f\u60c5\u5831\u3092\u8868\u793a\u3057\u305f\u3053\u3068\u304c\u308f\u304b\u308b\u3002\n[root@master1 ~]# dig ntp.nict.jp +short\n133.243.238.163\n133.243.238.164\n133.243.238.243\n133.243.238.244\n\n\n\u3064\u307e\u308a\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u3084\u308a\u3068\u308a\u306b\u306a\u3063\u3066\u3044\u308b\u3002\n\n    dig                        dnsmasq            8.8.8.8\n     |                           |                   |\n     |----- ntp.nict.jp ? -------------------------->|\n     |<------ response ------------------------------|\n     |                           | cache             |\n     |                           |                   |\n     |                           |                   |\n     |----- ntp.nict.jp ? ------>|                   |\n     |<------ response ----------| cache             |\n     |                           |                   |\n     |                           |                   |\n\n\n\n\n#1 \u691c\u8a3c\u74b0\u5883\n\n```\n[root@master1 ~]# cat /etc/redhat-release\nCentOS Linux release 7.2.1511 (Core)\n\n```\n\n\n#2 dnsmasq\u3068\u306f\n>dnsmasq - A lightweight DHCP and caching DNS server.\n\n\n#3 dnsmasq\u8d77\u52d5&\u505c\u6b62\n\n```\n53\u756a\u30dd\u30fc\u30c8\u306f\u4f7f\u308f\u308c\u3066\u3044\u306a\u3044\u3002\n[root@master1 ~]# lsof -i:53\n[root@master1 ~]#\n\ndnsmasq\u3092\u8d77\u52d5\u3059\u308b\u3002\u30dd\u30fc\u30c8\u756a\u53f753\u304c\u4f7f\u308f\u308c\u305f\u3053\u3068\u304c\u308f\u304b\u308b\u3002\n[root@master1 ~]# systemctl start dnsmasq\n[root@master1 ~]# lsof -i:53\nCOMMAND   PID   USER   FD   TYPE DEVICE SIZE/OFF NODE NAME\ndnsmasq 11677 nobody    4u  IPv4  99963      0t0  UDP *:domain\ndnsmasq 11677 nobody    5u  IPv4  99964      0t0  TCP *:domain (LISTEN)\ndnsmasq 11677 nobody    6u  IPv6  99965      0t0  UDP *:domain\ndnsmasq 11677 nobody    7u  IPv6  99966      0t0  TCP *:domain (LISTEN)\n[root@master1 ~]#\n\ndnsmasq\u3092\u505c\u6b62\u3059\u308b\u3002\n[root@master1 ~]# systemctl stop dnsmasq\n[root@master1 ~]# lsof -i:53\n[root@master1 ~]#\n\n```\n\n\n#4 \u30ad\u30e3\u30c3\u30b7\u30e5\u306e\u6709\u52b9\u6027\u3092\u78ba\u8a8d\n\n```\nnameserver\u3068\u3057\u3066127.0.0.1\u3092\u8ffd\u52a0\u3059\u308b\u3002\u3064\u307e\u308a\u3001dig\u30b3\u30de\u30f3\u30c9\u3067\u540d\u524d\u89e3\u6c7a\u3092\u3059\u308b\u3068\u3001dnsmasq\u306b\u554f\u3044\u5408\u308f\u305b\u3092\u3059\u308b\u3088\u3046\u306b\u306a\u308b\u3002\n[root@master1 ~]# cat /etc/resolv.conf\n# Generated by NetworkManager\nnameserver 127.0.0.1\nnameserver 8.8.8.8\n[root@master1 ~]#\n\n\u5225\u30bf\u30fc\u30df\u30ca\u30eb\u3067tcpdump\u3092\u8d77\u52d5\u3059\u308b\u3002\n[root@master1 ~]# tcpdump -i eth0 port 53 -n\n\ndig\u3092\u5b9f\u884c\u3059\u308b\u3002\n[root@master1 ~]# dig ntp.nict.jp +short\n133.243.238.243\n133.243.238.244\n133.243.238.163\n133.243.238.164\n\n1\u56de\u76ee\u306edig\u3092\u5b9f\u884c\u3059\u308b\u3068\u3001google\u306e\u516c\u958bDNS\u30b5\u30fc\u30d0(8.8.8.8)\u306b\u554f\u3044\u5408\u308f\u305b\u3092\u3057\u3066\u3044\u308b\u3002\n[root@master1 ~]# tcpdump -i eth0 port 53 -n\ntcpdump: verbose output suppressed, use -v or -vv for full protocol decode\nlistening on eth0, link-type EN10MB (Ethernet), capture size 65535 bytes\n22:04:03.991370 IP 192.168.0.10.34228 > 8.8.8.8.domain: 18634+ [1au] A? ntp.nict.jp. (40)\n22:04:04.012549 IP 8.8.8.8.domain > 192.168.0.10.34228: 18634 4/0/1 A 133.243.238.243, A 133.243.238.164, A 133.243.238.163, A 133.243.238.244 (104)\n\n2\u56de\u76ee\u306edig\u306f\u516c\u958bDNS\u30b5\u30fc\u30d0\u306b\u554f\u3044\u5408\u308f\u305b\u306f\u305b\u305a\u30011\u56de\u76ee\u306b\u5f97\u305f\u60c5\u5831\u3092\u8868\u793a\u3057\u305f\u3053\u3068\u304c\u308f\u304b\u308b\u3002\n[root@master1 ~]# dig ntp.nict.jp +short\n133.243.238.163\n133.243.238.164\n133.243.238.243\n133.243.238.244\n\n\n\u3064\u307e\u308a\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u3084\u308a\u3068\u308a\u306b\u306a\u3063\u3066\u3044\u308b\u3002\n\n    dig                        dnsmasq            8.8.8.8\n     |                           |                   |\n     |----- ntp.nict.jp ? -------------------------->|\n     |<------ response ------------------------------|\n     |                           | cache             |\n     |                           |                   |\n     |                           |                   |\n     |----- ntp.nict.jp ? ------>|                   |\n     |<------ response ----------| cache             |\n     |                           |                   |\n     |                           |                   |\n\n\n\n```\n\n", "tags": ["dns", "centos7", "dnsmasq"]}