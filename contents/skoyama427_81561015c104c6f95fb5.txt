{"context": "R\u3067Topological data analysis\nmclust\u306ediabees\u30c7\u30fc\u30bf\u3092\u8a66\u3057\u3066\u307f\u308b\u3002\nfilter function\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u3057\u3066\u307f\u305f\nf(x)=\u2211yexp\u2212(distance(y\u2212x))2\u03f5f(x)=\u2211yexp\u2212(distance(y\u2212x))2\u03f5{f(x)=\\sum_y exp\\frac{-(distance(y-x))^2}{\\epsilon}  \n}\n(\u03f5=130000)(\u03f5=130000){(\\epsilon=130000)\n}\nlibrary(mclust)\nlibrary(TDAmapper)\nlibrary(igraph)\n\ndata(diabetes)\n.data <- diabetes[,2:4]\n.dist <- dist(.data, diag=T, upper=T)\n.mat <- as.matrix(.dist)\n.kernel <- function(d) sum(exp(-(d^2)/130000))\n.filter <- apply(.mat, 2, .kernel)\n\n#\nmap <- mapper1D(.dist, filter=.filter, num_intervals=5, percent_overlap = 50)\ng <- graph.adjacency(map$adjacency, mode=\"undirected\")\n\n#\u30ce\u30fc\u30c9\u5185\u306e\u30c7\u30fc\u30bf\u6570\u306b\u5fdc\u3058\u3066\u30ce\u30fc\u30c9\u30b5\u30a4\u30ba\u3092\u5909\u66f4\nV(g)$size <- 5*sqrt(sapply(map$points_in_vertex, length))\n\n.col <- c()\nN <- length(V(g))\nfor(i in 1:N){\n  tmp <- as.numeric((table(diabetes[map$points_in_vertex[[i]], 1])))\n  t <- tmp/sum(tmp)\n  .col[i] <- rgb(t[1], t[2], t[3])\n}\nV(g)$color <- .col\nplot(g)\n\n\n> pv <- map$points_in_vertex\n> labels <- diabetes[,1]\n> glucose <- diabetes[,2]\n> insulin <- diabetes[,3]\n> sspg <- diabetes[,4]\n\n> rbind(\n+   table(labels[pv[[9]]]),\n+   table(labels[pv[[1]]]),\n+   table(labels[pv[[3]]])\n+ )\n     Chemical Normal Overt\n[1,]       29     75     2\n[2,]        4      0     0\n[3,]        0      0    26\n\n> summary(diabetes[map$points_in_vertex[[9]], 2:4])\n    glucose          insulin           sspg      \n Min.   : 70.00   Min.   :269.0   Min.   : 73.0  \n 1st Qu.: 87.25   1st Qu.:333.2   1st Qu.:131.2  \n Median : 93.00   Median :372.0   Median :167.0  \n Mean   : 94.27   Mean   :392.6   Mean   :183.2  \n 3rd Qu.: 99.75   3rd Qu.:428.2   3rd Qu.:221.0  \n Max.   :140.00   Max.   :643.0   Max.   :408.0  \n> summary(diabetes[map$points_in_vertex[[1]], 2:4])\n    glucose         insulin           sspg      \n Min.   : 95.0   Min.   :469.0   Min.   :564.0  \n 1st Qu.: 99.5   1st Qu.:505.0   1st Qu.:596.2  \n Median :102.0   Median :527.0   Median :614.5  \n Mean   :102.5   Mean   :520.2   Mean   :635.2  \n 3rd Qu.:105.0   3rd Qu.:542.2   3rd Qu.:653.5  \n Max.   :111.0   Max.   :558.0   Max.   :748.0  \n> summary(diabetes[map$points_in_vertex[[3]], 2:4])\n    glucose         insulin            sspg       \n Min.   :146.0   Min.   : 832.0   Min.   : 10.00  \n 1st Qu.:188.5   1st Qu.: 931.8   1st Qu.: 41.25  \n Median :224.5   Median :1123.0   Median : 76.50  \n Mean   :241.7   Mean   :1152.9   Mean   : 75.69  \n 3rd Qu.:302.2   3rd Qu.:1370.8   3rd Qu.:102.75  \n Max.   :353.0   Max.   :1568.0   Max.   :160.00  \n\n\u3082\u3046\u5c11\u3057chemical\u306e\u5206\u96e2\u3092\u3088\u304f\u3057\u305f\u3044\u304c\u3001\u4e00\u5fdcovert\u3068\u305d\u306e\u4ed6\u306e\u5206\u985e\u306f\u3067\u304d\u3066\u3044\u308b\u3002\nR\u3067Topological data analysis\nmclust\u306ediabees\u30c7\u30fc\u30bf\u3092\u8a66\u3057\u3066\u307f\u308b\u3002\nfilter function\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u3057\u3066\u307f\u305f\n\n```math\nf(x)=\\sum_y exp\\frac{-(distance(y-x))^2}{\\epsilon}  \n```\n\n```math\n(\\epsilon=130000)\n```\n\n```r\nlibrary(mclust)\nlibrary(TDAmapper)\nlibrary(igraph)\n\ndata(diabetes)\n.data <- diabetes[,2:4]\n.dist <- dist(.data, diag=T, upper=T)\n.mat <- as.matrix(.dist)\n.kernel <- function(d) sum(exp(-(d^2)/130000))\n.filter <- apply(.mat, 2, .kernel)\n\n#\nmap <- mapper1D(.dist, filter=.filter, num_intervals=5, percent_overlap = 50)\ng <- graph.adjacency(map$adjacency, mode=\"undirected\")\n\n#\u30ce\u30fc\u30c9\u5185\u306e\u30c7\u30fc\u30bf\u6570\u306b\u5fdc\u3058\u3066\u30ce\u30fc\u30c9\u30b5\u30a4\u30ba\u3092\u5909\u66f4\nV(g)$size <- 5*sqrt(sapply(map$points_in_vertex, length))\n\n.col <- c()\nN <- length(V(g))\nfor(i in 1:N){\n  tmp <- as.numeric((table(diabetes[map$points_in_vertex[[i]], 1])))\n  t <- tmp/sum(tmp)\n  .col[i] <- rgb(t[1], t[2], t[3])\n}\nV(g)$color <- .col\nplot(g)\n```\n\n![TDA (2).jpg](https://qiita-image-store.s3.amazonaws.com/0/145593/fa8fa35d-2bc4-487a-ec23-d6a161f366f3.jpeg)\n\n```r\n> pv <- map$points_in_vertex\n> labels <- diabetes[,1]\n> glucose <- diabetes[,2]\n> insulin <- diabetes[,3]\n> sspg <- diabetes[,4]\n\n> rbind(\n+   table(labels[pv[[9]]]),\n+   table(labels[pv[[1]]]),\n+   table(labels[pv[[3]]])\n+ )\n     Chemical Normal Overt\n[1,]       29     75     2\n[2,]        4      0     0\n[3,]        0      0    26\n\n> summary(diabetes[map$points_in_vertex[[9]], 2:4])\n    glucose          insulin           sspg      \n Min.   : 70.00   Min.   :269.0   Min.   : 73.0  \n 1st Qu.: 87.25   1st Qu.:333.2   1st Qu.:131.2  \n Median : 93.00   Median :372.0   Median :167.0  \n Mean   : 94.27   Mean   :392.6   Mean   :183.2  \n 3rd Qu.: 99.75   3rd Qu.:428.2   3rd Qu.:221.0  \n Max.   :140.00   Max.   :643.0   Max.   :408.0  \n> summary(diabetes[map$points_in_vertex[[1]], 2:4])\n    glucose         insulin           sspg      \n Min.   : 95.0   Min.   :469.0   Min.   :564.0  \n 1st Qu.: 99.5   1st Qu.:505.0   1st Qu.:596.2  \n Median :102.0   Median :527.0   Median :614.5  \n Mean   :102.5   Mean   :520.2   Mean   :635.2  \n 3rd Qu.:105.0   3rd Qu.:542.2   3rd Qu.:653.5  \n Max.   :111.0   Max.   :558.0   Max.   :748.0  \n> summary(diabetes[map$points_in_vertex[[3]], 2:4])\n    glucose         insulin            sspg       \n Min.   :146.0   Min.   : 832.0   Min.   : 10.00  \n 1st Qu.:188.5   1st Qu.: 931.8   1st Qu.: 41.25  \n Median :224.5   Median :1123.0   Median : 76.50  \n Mean   :241.7   Mean   :1152.9   Mean   : 75.69  \n 3rd Qu.:302.2   3rd Qu.:1370.8   3rd Qu.:102.75  \n Max.   :353.0   Max.   :1568.0   Max.   :160.00  \n```\n\u3082\u3046\u5c11\u3057chemical\u306e\u5206\u96e2\u3092\u3088\u304f\u3057\u305f\u3044\u304c\u3001\u4e00\u5fdcovert\u3068\u305d\u306e\u4ed6\u306e\u5206\u985e\u306f\u3067\u304d\u3066\u3044\u308b\u3002\n\n\n\n", "tags": ["R", "statistics", "TopologicalDataAnalysis"]}