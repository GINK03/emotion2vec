{"tags": ["javamail", "gmail"], "context": " \u3053\u306e\u8a18\u4e8b\u306f\u6700\u7d42\u66f4\u65b0\u65e5\u304b\u30891\u5e74\u4ee5\u4e0a\u304c\u7d4c\u904e\u3057\u3066\u3044\u307e\u3059\u3002\u5b50\u4f9b\u304c\u5b9f\u969b\u306b\u3084\u3063\u305f\u304b\u3069\u3046\u304b\u3092\u78ba\u8a8d\u3059\u308b\u305f\u3081\u306b\u3001\u56de\u7b54\u3092\u4fdd\u5b58\u3057\u305f\u5f8c\u3067\u3001\u30e1\u30fc\u30eb\u306e\u9001\u4fe1\u3092\u884c\u3044\u307e\u3059\u3002\n\u672c\u7b4b\u3068\u306f\u95a2\u4fc2\u306a\u3044\u3051\u3069\u3001\u3044\u3064\u3082\u5fd8\u308c\u3066\u3042\u3061\u3053\u3061\u898b\u3066\u56de\u3063\u305f\u308a\u3059\u308b\u306e\u3067\u3001\u5fd8\u5099\u9332\u3068\u3057\u3066\u66f8\u3044\u3066\u304a\u304d\u307e\u3059\u3002\n\njavamail\n\u57fa\u672c\u7684\u306b\u4ee5\u4e0b\u306e\u624b\u9806\u3067\u30e1\u30fc\u30eb\u3092\u9001\u4fe1\u3057\u307e\u3059\u3002\n\nSession#getInstance(Properties, Authenticator) \u3067\u30bb\u30c3\u30b7\u30e7\u30f3\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\nnew MimeMessage(Session) \u3067\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u751f\u6210\u3057\u307e\u3059\u3002\nMimeMessage#setSubject(String, String) \u3067\u30bf\u30a4\u30c8\u30eb\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\u7b2c2\u5f15\u6570\u306e\u6587\u5b57\u30b3\u30fc\u30c9\u306f ISO-2022-JP \u3092\u6307\u5b9a\u3057\u307e\u3059\u3002\nMimeMessage#setText(String, String) \u3067\u672c\u6587\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\u7b2c2\u5f15\u6570\u306f\u30bf\u30a4\u30c8\u30eb\u3068\u4e00\u7dd2\u3067\u3059\u3002\u672c\u6587\u306e\u6539\u884c\u306b\u306f \\r\\n \u3092\u4f7f\u7528\u3057\u307e\u3059\u3002\nMimeMessage#setRecipients(MimeMessage.RecipientType.TO, InternetAddress) \u3067\u3042\u3066\u5148\u3092\u6307\u5b9a\u3057\u307e\u3059\u3002\nMimeMessage#saveChanges() \u3067\u30e1\u30fc\u30eb\u3092\u4fdd\u5b58\u3057\u307e\u3059\u3002\nTransport#send(MimeMessage) \u3067\u30e1\u30fc\u30eb\u3092\u9001\u4fe1\u3057\u307e\u3059\u3002\n\n\nGMail\u3067\u306e\u9001\u4fe1\u8a2d\u5b9a\u5185\u5bb9\nGMail\u3092\u5229\u7528\u3057\u3066\u30e1\u30fc\u30eb\u9001\u4fe1\u3059\u308b\u5834\u5408\u306f\u4ee5\u4e0b\u306e\u8a2d\u5b9a\u3092\u30bb\u30c3\u30b7\u30e7\u30f3\u3092\u751f\u6210\u3059\u308b\u969b\u306e\u30d7\u30ed\u30d1\u30c6\u30a3\u306b\u6307\u5b9a\u3057\u307e\u3059\u3002\nmail.smtp.host = smtp.gmail.com\nmail.smtp.port = 587\nmail.smtp.auth = true\nmail.smtp.starttls.enable = true\n\n\u30e1\u30fc\u30eb\u9001\u4fe1\u306e\u30ed\u30b0\u3092\u51fa\u529b\u3057\u305f\u3044\u5834\u5408\u306f mail.debug = true \u3082\u30d7\u30ed\u30d1\u30c6\u30a3\u306b\u6307\u5b9a\u3057\u307e\u3059\u3002\n\u4eca\u56de\u4f5c\u3063\u305f\u30e1\u30fc\u30eb\u9001\u4fe1\u30af\u30e9\u30b9\u306f\u4ee5\u4e0b\u306e\u901a\u308a\u3067\u3059\u3002\n\nMailSender.java\npackage homework.utils;\n\nimport java.util.List;\nimport java.util.Properties;\n\nimport javax.mail.Authenticator;\nimport javax.mail.MessagingException;\nimport javax.mail.PasswordAuthentication;\nimport javax.mail.Session;\nimport javax.mail.Transport;\nimport javax.mail.internet.InternetAddress;\nimport javax.mail.internet.MimeMessage;\n\nimport org.apache.commons.lang3.StringUtils;\n\nimport homework.entity.Answer;\nimport homework.entity.History;\nimport homework.entity.User;\nimport homework.utils.Constant.CorrectWrong;\n\n/**\n * \u30e1\u30fc\u30eb\u9001\u4fe1\u30af\u30e9\u30b9\u3002\n * @author satake\n */\npublic class MailSender implements Runnable {\n\n    /** \u30e1\u30fc\u30eb\u9001\u4fe1\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u540d */\n    private static final String CONFIG_NAME = \"mail.properties\";\n    /** \u9001\u4fe1\u7528\u30a2\u30ab\u30a6\u30f3\u30c8\u3092\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u304b\u3089\u53d6\u5f97\u3059\u308b\u30ad\u30fc\u306e\u5b9a\u7fa9 */\n    private static final String KEY_USERID = \"account\";\n    /** \u9001\u4fe1\u7528\u30d1\u30b9\u30ef\u30fc\u30c9\u3092\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u304b\u3089\u53d6\u5f97\u3059\u308b\u30ad\u30fc\u306e\u5b9a\u7fa9 */\n    private static final String KEY_PASSWD = \"password\";\n    /** \u9001\u4fe1\u5148\u30a2\u30c9\u30ec\u30b9\u306e\u30bb\u30d1\u30ec\u30fc\u30bf\u306e\u5b9a\u7fa9 */\n    private static final String MAIL_SEPARATOR = \"\\\\|@\\\\|\";\n    /** \u30e1\u30fc\u30eb\u672c\u6587\u306e\u6539\u884c\u6587\u5b57\u306e\u5b9a\u7fa9 */\n    private static final String NEXT_LINE = \"\\r\\n\";\n    /** \u30e1\u30fc\u30eb\u306e\u6587\u5b57\u30b3\u30fc\u30c9\u306e\u5b9a\u7fa9 */\n    private static final String CHAR_SET = \"ISO-2022-JP\";\n\n    private final User user;\n    private final History history;\n    private final List<Answer> answers;\n\n    /**\n     * \u30b3\u30f3\u30b9\u30c8\u30e9\u30af\u30bf\u3002\n     * @param user      \u30e6\u30fc\u30b6\u60c5\u5831\n     * @param history   \u5c65\u6b74\u60c5\u5831\n     * @param answers   \u56de\u7b54\u60c5\u5831\n     */\n    public MailSender(User user, History history, List<Answer> answers) {\n        this.user = user;\n        this.history = history;\n        this.answers = answers;\n    }\n\n    @Override\n    public void run() {\n        send();\n    }\n\n    /**\n     * \u5b9f\u65bd\u7d50\u679c\u3092\u30e1\u30fc\u30eb\u9001\u4fe1\u3059\u308b\u3002\n     */\n    public void send() {\n        try {\n            // \u8a2d\u5b9a\u8aad\u307f\u8fbc\u307f\n            Properties property = new Properties();\n            property.load(getClass().getClassLoader().getResourceAsStream(CONFIG_NAME));\n\n            // \u30bb\u30c3\u30b7\u30e7\u30f3\u306e\u4f5c\u6210\n            Session session = Session.getInstance(property, new Authenticator() {\n                @Override\n                protected PasswordAuthentication getPasswordAuthentication() {\n                    return new PasswordAuthentication(property.getProperty(KEY_USERID), property.getProperty(KEY_PASSWD));\n                }\n            });\n\n            // \u30e1\u30fc\u30eb\u306e\u4f5c\u6210\n            MimeMessage mimeMessage = createMail(session);\n\n            // \u5b9b\u5148\u306e\u8a2d\u5b9a\n            String[] noticeMails = user.getNoticeMail().split(MAIL_SEPARATOR);\n            InternetAddress[] toAddress = new InternetAddress[noticeMails.length];\n            for (int i = 0; i < noticeMails.length; i++) {\n                toAddress[i] = new InternetAddress(noticeMails[i]);\n            }\n            mimeMessage.setRecipients(MimeMessage.RecipientType.TO, toAddress);\n\n            // \u9001\u4fe1\u8005\u306e\u8a2d\u5b9a\n            InternetAddress fromAddress = new InternetAddress(\"noreply@system.com\", \"\u30db\u30fc\u30e0\u30ef\u30fc\u30af\");\n            mimeMessage.setFrom(fromAddress);\n\n            // \u4fdd\u5b58\n            mimeMessage.saveChanges();\n\n            // \u9001\u4fe1\n            Transport.send(mimeMessage);\n        }\n        catch (Exception e) {\n            throw new SystemException(\"\u30e1\u30fc\u30eb\u9001\u4fe1\u306b\u5931\u6557\u3057\u307e\u3057\u305f\u3002\", e);\n        }\n    }\n\n    /**\n     * \u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u751f\u6210\u3059\u308b\u3002\n     * @param session   \u30e1\u30fc\u30eb\u30bb\u30c3\u30b7\u30e7\u30f3\n     * @return  \u30e1\u30c3\u30bb\u30fc\u30b8\n     * @throws MessagingException   \u30e1\u30c3\u30bb\u30fc\u30b8\u306e\u8a2d\u5b9a\u306b\u5931\u6557\u3057\u305f\u5834\u5408\u3002\n     */\n    private MimeMessage createMail(Session session) throws MessagingException {\n        MimeMessage mimeMessage = new MimeMessage(session);\n\n        // \u30bf\u30a4\u30c8\u30eb\n        String title = \"\u3010\u30c9\u30ea\u30eb\u306e\u7d50\u679c\u3011\uff08\" + DateUtil.toString(DateUtil.getDate(), \"yyyy/MM/dd\") + \"\uff09\" + user.getLastName() + user.getFirstName();\n        mimeMessage.setSubject(title, CHAR_SET);\n\n        // \u672c\u6587\n        StringBuilder text = new StringBuilder();\n        text.append(user.getLastName()).append(user.getFirstName()).append(\"\u3055\u3093\u306e\u5b9f\u65bd\u7d50\u679c\").append(NEXT_LINE);\n        text.append(NEXT_LINE);\n        int elapsed = history.getElapsed() / 1000;\n        text.append(\"\u6240\u8981\u6642\u9593\uff1a \u7d04\").append(elapsed / 60).append(\"\u5206\").append(elapsed % 60).append(\"\u79d2\").append(NEXT_LINE);\n        text.append(\"\u6b63\u89e3\u7387\u3000\uff1a \").append(history.getCorrectPercent()).append(\"%\").append(NEXT_LINE);\n        text.append(NEXT_LINE);\n        text.append(\"\u554f\u984c\u3068\u89e3\u7b54\u306f\u4ee5\u4e0b\u306e\u901a\u308a\u3067\u3059\u3002\").append(NEXT_LINE);\n        text.append(\"-----------------------------------------------------\").append(NEXT_LINE);\n        int index = 1;\n        for (Answer answer : answers) {\n            text.append(\"\u554f\u984c\").append(index).append(NEXT_LINE);\n            text.append(\"\u3000\u3000\").append(answer.getQuestion().getQuestion()).append(NEXT_LINE);\n            text.append(\"\u56de\u7b54\u3000\u21d2\u3000\").append(answer.getCorrectWrong() == CorrectWrong.COLLECT ? \"\u6b63\u89e3\" : \"\u4e0d\u6b63\u89e3\").append(NEXT_LINE);\n            text.append(\"\u3000\u3000\").append(StringUtils.isNotBlank(answer.getAnswer()) ? answer.getAnswer() : \"\u672a\u56de\u7b54\").append(NEXT_LINE);\n            text.append(\"\u89e3\u7b54\").append(NEXT_LINE);\n            text.append(\"\u3000\u3000\").append(answer.getQuestion().getCorrect()).append(NEXT_LINE);\n            text.append(\"-----------------------------------------------------\").append(NEXT_LINE);\n            index++;\n        }\n        text.append(NEXT_LINE);\n        text.append(NEXT_LINE);\n        text.append(\"-----------------------------------------------------\").append(NEXT_LINE);\n        text.append(\"\u203b \u3053\u306e\u30e1\u30fc\u30eb\u306f\u30b7\u30b9\u30c6\u30e0\u3088\u308a\u81ea\u52d5\u7684\u306b\u9001\u4fe1\u3055\u308c\u3066\u3044\u307e\u3059\u3002\").append(NEXT_LINE);\n        text.append(NEXT_LINE);\n        mimeMessage.setText(text.toString(), CHAR_SET);\n\n        return mimeMessage;\n    }\n}\n\n\n\nmail.properties\n# Gmail \u9001\u4fe1\u8a2d\u5b9a\nmail.smtp.host = smtp.gmail.com\nmail.smtp.port = 587\nmail.smtp.auth = true\nmail.smtp.starttls.enable = true\nmail.debug = true\n\n# \u8a8d\u8a3c\u8a2d\u5b9a\naccount = \u9001\u4fe1\u306b\u4f7f\u7528\u3059\u308bGMail\u30a2\u30c9\u30ec\u30b9\npassword = \u9001\u4fe1\u306b\u4f7f\u7528\u3059\u308bGMail\u30a2\u30c9\u30ec\u30b9\u306e\u30d1\u30b9\u30ef\u30fc\u30c9\n\n\n\u306a\u304a\u3001\u30e1\u30fc\u30eb\u306e\u9001\u4fe1\u306b\u306f\u6642\u9593\u304c\u304b\u304b\u308b\u306e\u3067\u3001\u5225\u30b9\u30ec\u30c3\u30c9\u3067\u51e6\u7406\u3055\u305b\u308b\u3053\u3068\u306b\u3057\u307e\u3057\u305f\u3002\n\nUserService.java\n    protected Responce registAnswer(Request request) {\n        ..........\n        // \u30e1\u30fc\u30eb\u9001\u4fe1\n        if (StringUtils.isNotBlank(request.getUser().getNoticeMail())) {\n            MailSender mailSender = new MailSender(request.getUser(), history, request.getAnswers());\n            Executors.newSingleThreadExecutor().execute(mailSender);\n        }\n        ..........\n    }\n\n\nRESTEasy\u3068JPA\u3068AngularJS\u3092\u4f7f\u3063\u3066Web\u30a2\u30d7\u30ea\u3092\u4f5c\u3063\u3066\u307f\u308b\uff17\uff08\u30b5\u30fc\u30d3\u30b9\u30af\u30e9\u30b9\u306e\u516c\u958b\uff09\u3078\n\u5b50\u4f9b\u304c\u5b9f\u969b\u306b\u3084\u3063\u305f\u304b\u3069\u3046\u304b\u3092\u78ba\u8a8d\u3059\u308b\u305f\u3081\u306b\u3001\u56de\u7b54\u3092\u4fdd\u5b58\u3057\u305f\u5f8c\u3067\u3001\u30e1\u30fc\u30eb\u306e\u9001\u4fe1\u3092\u884c\u3044\u307e\u3059\u3002\n\n\u672c\u7b4b\u3068\u306f\u95a2\u4fc2\u306a\u3044\u3051\u3069\u3001\u3044\u3064\u3082\u5fd8\u308c\u3066\u3042\u3061\u3053\u3061\u898b\u3066\u56de\u3063\u305f\u308a\u3059\u308b\u306e\u3067\u3001\u5fd8\u5099\u9332\u3068\u3057\u3066\u66f8\u3044\u3066\u304a\u304d\u307e\u3059\u3002\n\n# javamail\n\u57fa\u672c\u7684\u306b\u4ee5\u4e0b\u306e\u624b\u9806\u3067\u30e1\u30fc\u30eb\u3092\u9001\u4fe1\u3057\u307e\u3059\u3002\n\n- Session#getInstance(Properties, Authenticator) \u3067\u30bb\u30c3\u30b7\u30e7\u30f3\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n- new MimeMessage(Session) \u3067\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u751f\u6210\u3057\u307e\u3059\u3002\n- MimeMessage#setSubject(String, String) \u3067\u30bf\u30a4\u30c8\u30eb\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\u7b2c2\u5f15\u6570\u306e\u6587\u5b57\u30b3\u30fc\u30c9\u306f ISO-2022-JP \u3092\u6307\u5b9a\u3057\u307e\u3059\u3002\n- MimeMessage#setText(String, String) \u3067\u672c\u6587\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\u7b2c2\u5f15\u6570\u306f\u30bf\u30a4\u30c8\u30eb\u3068\u4e00\u7dd2\u3067\u3059\u3002\u672c\u6587\u306e\u6539\u884c\u306b\u306f \\r\\n \u3092\u4f7f\u7528\u3057\u307e\u3059\u3002\n- MimeMessage#setRecipients(MimeMessage.RecipientType.TO, InternetAddress) \u3067\u3042\u3066\u5148\u3092\u6307\u5b9a\u3057\u307e\u3059\u3002\n- MimeMessage#saveChanges() \u3067\u30e1\u30fc\u30eb\u3092\u4fdd\u5b58\u3057\u307e\u3059\u3002\n- Transport#send(MimeMessage) \u3067\u30e1\u30fc\u30eb\u3092\u9001\u4fe1\u3057\u307e\u3059\u3002\n\n# GMail\u3067\u306e\u9001\u4fe1\u8a2d\u5b9a\u5185\u5bb9\nGMail\u3092\u5229\u7528\u3057\u3066\u30e1\u30fc\u30eb\u9001\u4fe1\u3059\u308b\u5834\u5408\u306f\u4ee5\u4e0b\u306e\u8a2d\u5b9a\u3092\u30bb\u30c3\u30b7\u30e7\u30f3\u3092\u751f\u6210\u3059\u308b\u969b\u306e\u30d7\u30ed\u30d1\u30c6\u30a3\u306b\u6307\u5b9a\u3057\u307e\u3059\u3002\n\n```properties\nmail.smtp.host = smtp.gmail.com\nmail.smtp.port = 587\nmail.smtp.auth = true\nmail.smtp.starttls.enable = true\n```\n\n\u30e1\u30fc\u30eb\u9001\u4fe1\u306e\u30ed\u30b0\u3092\u51fa\u529b\u3057\u305f\u3044\u5834\u5408\u306f mail.debug = true \u3082\u30d7\u30ed\u30d1\u30c6\u30a3\u306b\u6307\u5b9a\u3057\u307e\u3059\u3002\n\n\u4eca\u56de\u4f5c\u3063\u305f\u30e1\u30fc\u30eb\u9001\u4fe1\u30af\u30e9\u30b9\u306f\u4ee5\u4e0b\u306e\u901a\u308a\u3067\u3059\u3002\n\n```java:MailSender.java\npackage homework.utils;\n\nimport java.util.List;\nimport java.util.Properties;\n\nimport javax.mail.Authenticator;\nimport javax.mail.MessagingException;\nimport javax.mail.PasswordAuthentication;\nimport javax.mail.Session;\nimport javax.mail.Transport;\nimport javax.mail.internet.InternetAddress;\nimport javax.mail.internet.MimeMessage;\n\nimport org.apache.commons.lang3.StringUtils;\n\nimport homework.entity.Answer;\nimport homework.entity.History;\nimport homework.entity.User;\nimport homework.utils.Constant.CorrectWrong;\n\n/**\n * \u30e1\u30fc\u30eb\u9001\u4fe1\u30af\u30e9\u30b9\u3002\n * @author satake\n */\npublic class MailSender implements Runnable {\n\n\t/** \u30e1\u30fc\u30eb\u9001\u4fe1\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u540d */\n\tprivate static final String CONFIG_NAME = \"mail.properties\";\n\t/** \u9001\u4fe1\u7528\u30a2\u30ab\u30a6\u30f3\u30c8\u3092\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u304b\u3089\u53d6\u5f97\u3059\u308b\u30ad\u30fc\u306e\u5b9a\u7fa9 */\n\tprivate static final String KEY_USERID = \"account\";\n\t/** \u9001\u4fe1\u7528\u30d1\u30b9\u30ef\u30fc\u30c9\u3092\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u304b\u3089\u53d6\u5f97\u3059\u308b\u30ad\u30fc\u306e\u5b9a\u7fa9 */\n\tprivate static final String KEY_PASSWD = \"password\";\n\t/** \u9001\u4fe1\u5148\u30a2\u30c9\u30ec\u30b9\u306e\u30bb\u30d1\u30ec\u30fc\u30bf\u306e\u5b9a\u7fa9 */\n\tprivate static final String MAIL_SEPARATOR = \"\\\\|@\\\\|\";\n\t/** \u30e1\u30fc\u30eb\u672c\u6587\u306e\u6539\u884c\u6587\u5b57\u306e\u5b9a\u7fa9 */\n\tprivate static final String NEXT_LINE = \"\\r\\n\";\n\t/** \u30e1\u30fc\u30eb\u306e\u6587\u5b57\u30b3\u30fc\u30c9\u306e\u5b9a\u7fa9 */\n\tprivate static final String CHAR_SET = \"ISO-2022-JP\";\n\n\tprivate final User user;\n\tprivate final History history;\n\tprivate final List<Answer> answers;\n\n\t/**\n\t * \u30b3\u30f3\u30b9\u30c8\u30e9\u30af\u30bf\u3002\n\t * @param user\t\t\u30e6\u30fc\u30b6\u60c5\u5831\n\t * @param history\t\u5c65\u6b74\u60c5\u5831\n\t * @param answers\t\u56de\u7b54\u60c5\u5831\n\t */\n\tpublic MailSender(User user, History history, List<Answer> answers) {\n\t\tthis.user = user;\n\t\tthis.history = history;\n\t\tthis.answers = answers;\n\t}\n\n\t@Override\n\tpublic void run() {\n\t\tsend();\n\t}\n\n\t/**\n\t * \u5b9f\u65bd\u7d50\u679c\u3092\u30e1\u30fc\u30eb\u9001\u4fe1\u3059\u308b\u3002\n\t */\n\tpublic void send() {\n\t\ttry {\n\t\t\t// \u8a2d\u5b9a\u8aad\u307f\u8fbc\u307f\n\t\t\tProperties property = new Properties();\n\t\t\tproperty.load(getClass().getClassLoader().getResourceAsStream(CONFIG_NAME));\n\n\t\t\t// \u30bb\u30c3\u30b7\u30e7\u30f3\u306e\u4f5c\u6210\n\t\t\tSession session = Session.getInstance(property, new Authenticator() {\n\t\t\t\t@Override\n\t\t\t\tprotected PasswordAuthentication getPasswordAuthentication() {\n\t\t\t\t\treturn new PasswordAuthentication(property.getProperty(KEY_USERID), property.getProperty(KEY_PASSWD));\n\t\t\t\t}\n\t\t\t});\n\n\t\t\t// \u30e1\u30fc\u30eb\u306e\u4f5c\u6210\n\t\t\tMimeMessage mimeMessage = createMail(session);\n\n\t\t\t// \u5b9b\u5148\u306e\u8a2d\u5b9a\n\t\t\tString[] noticeMails = user.getNoticeMail().split(MAIL_SEPARATOR);\n\t\t\tInternetAddress[] toAddress = new InternetAddress[noticeMails.length];\n\t\t\tfor (int i = 0; i < noticeMails.length; i++) {\n\t\t\t\ttoAddress[i] = new InternetAddress(noticeMails[i]);\n\t\t\t}\n\t\t\tmimeMessage.setRecipients(MimeMessage.RecipientType.TO, toAddress);\n\n\t\t\t// \u9001\u4fe1\u8005\u306e\u8a2d\u5b9a\n\t\t\tInternetAddress fromAddress = new InternetAddress(\"noreply@system.com\", \"\u30db\u30fc\u30e0\u30ef\u30fc\u30af\");\n\t\t\tmimeMessage.setFrom(fromAddress);\n\n\t\t\t// \u4fdd\u5b58\n\t\t\tmimeMessage.saveChanges();\n\n\t\t\t// \u9001\u4fe1\n\t\t\tTransport.send(mimeMessage);\n\t\t}\n\t\tcatch (Exception e) {\n\t\t\tthrow new SystemException(\"\u30e1\u30fc\u30eb\u9001\u4fe1\u306b\u5931\u6557\u3057\u307e\u3057\u305f\u3002\", e);\n\t\t}\n\t}\n\n\t/**\n\t * \u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u751f\u6210\u3059\u308b\u3002\n\t * @param session\t\u30e1\u30fc\u30eb\u30bb\u30c3\u30b7\u30e7\u30f3\n\t * @return\t\u30e1\u30c3\u30bb\u30fc\u30b8\n\t * @throws MessagingException\t\u30e1\u30c3\u30bb\u30fc\u30b8\u306e\u8a2d\u5b9a\u306b\u5931\u6557\u3057\u305f\u5834\u5408\u3002\n\t */\n\tprivate MimeMessage createMail(Session session) throws MessagingException {\n\t\tMimeMessage mimeMessage = new MimeMessage(session);\n\n\t\t// \u30bf\u30a4\u30c8\u30eb\n\t\tString title = \"\u3010\u30c9\u30ea\u30eb\u306e\u7d50\u679c\u3011\uff08\" + DateUtil.toString(DateUtil.getDate(), \"yyyy/MM/dd\") + \"\uff09\" + user.getLastName() + user.getFirstName();\n\t\tmimeMessage.setSubject(title, CHAR_SET);\n\n\t\t// \u672c\u6587\n\t\tStringBuilder text = new StringBuilder();\n\t\ttext.append(user.getLastName()).append(user.getFirstName()).append(\"\u3055\u3093\u306e\u5b9f\u65bd\u7d50\u679c\").append(NEXT_LINE);\n\t\ttext.append(NEXT_LINE);\n\t\tint elapsed = history.getElapsed() / 1000;\n\t\ttext.append(\"\u6240\u8981\u6642\u9593\uff1a \u7d04\").append(elapsed / 60).append(\"\u5206\").append(elapsed % 60).append(\"\u79d2\").append(NEXT_LINE);\n\t\ttext.append(\"\u6b63\u89e3\u7387\u3000\uff1a \").append(history.getCorrectPercent()).append(\"%\").append(NEXT_LINE);\n\t\ttext.append(NEXT_LINE);\n\t\ttext.append(\"\u554f\u984c\u3068\u89e3\u7b54\u306f\u4ee5\u4e0b\u306e\u901a\u308a\u3067\u3059\u3002\").append(NEXT_LINE);\n\t\ttext.append(\"-----------------------------------------------------\").append(NEXT_LINE);\n\t\tint index = 1;\n\t\tfor (Answer answer : answers) {\n\t\t\ttext.append(\"\u554f\u984c\").append(index).append(NEXT_LINE);\n\t\t\ttext.append(\"\u3000\u3000\").append(answer.getQuestion().getQuestion()).append(NEXT_LINE);\n\t\t\ttext.append(\"\u56de\u7b54\u3000\u21d2\u3000\").append(answer.getCorrectWrong() == CorrectWrong.COLLECT ? \"\u6b63\u89e3\" : \"\u4e0d\u6b63\u89e3\").append(NEXT_LINE);\n\t\t\ttext.append(\"\u3000\u3000\").append(StringUtils.isNotBlank(answer.getAnswer()) ? answer.getAnswer() : \"\u672a\u56de\u7b54\").append(NEXT_LINE);\n\t\t\ttext.append(\"\u89e3\u7b54\").append(NEXT_LINE);\n\t\t\ttext.append(\"\u3000\u3000\").append(answer.getQuestion().getCorrect()).append(NEXT_LINE);\n\t\t\ttext.append(\"-----------------------------------------------------\").append(NEXT_LINE);\n\t\t\tindex++;\n\t\t}\n\t\ttext.append(NEXT_LINE);\n\t\ttext.append(NEXT_LINE);\n\t\ttext.append(\"-----------------------------------------------------\").append(NEXT_LINE);\n\t\ttext.append(\"\u203b \u3053\u306e\u30e1\u30fc\u30eb\u306f\u30b7\u30b9\u30c6\u30e0\u3088\u308a\u81ea\u52d5\u7684\u306b\u9001\u4fe1\u3055\u308c\u3066\u3044\u307e\u3059\u3002\").append(NEXT_LINE);\n\t\ttext.append(NEXT_LINE);\n\t\tmimeMessage.setText(text.toString(), CHAR_SET);\n\n\t\treturn mimeMessage;\n\t}\n}\n```\n```properties:mail.properties\n# Gmail \u9001\u4fe1\u8a2d\u5b9a\nmail.smtp.host = smtp.gmail.com\nmail.smtp.port = 587\nmail.smtp.auth = true\nmail.smtp.starttls.enable = true\nmail.debug = true\n\n# \u8a8d\u8a3c\u8a2d\u5b9a\naccount = \u9001\u4fe1\u306b\u4f7f\u7528\u3059\u308bGMail\u30a2\u30c9\u30ec\u30b9\npassword = \u9001\u4fe1\u306b\u4f7f\u7528\u3059\u308bGMail\u30a2\u30c9\u30ec\u30b9\u306e\u30d1\u30b9\u30ef\u30fc\u30c9\n```\n\n\u306a\u304a\u3001\u30e1\u30fc\u30eb\u306e\u9001\u4fe1\u306b\u306f\u6642\u9593\u304c\u304b\u304b\u308b\u306e\u3067\u3001\u5225\u30b9\u30ec\u30c3\u30c9\u3067\u51e6\u7406\u3055\u305b\u308b\u3053\u3068\u306b\u3057\u307e\u3057\u305f\u3002\n\n```java:UserService.java\n\tprotected Responce registAnswer(Request request) {\n\t\t..........\n\t\t// \u30e1\u30fc\u30eb\u9001\u4fe1\n\t\tif (StringUtils.isNotBlank(request.getUser().getNoticeMail())) {\n\t\t\tMailSender mailSender = new MailSender(request.getUser(), history, request.getAnswers());\n\t\t\tExecutors.newSingleThreadExecutor().execute(mailSender);\n\t\t}\n\t\t..........\n\t}\n```\n\n\n\n[RESTEasy\u3068JPA\u3068AngularJS\u3092\u4f7f\u3063\u3066Web\u30a2\u30d7\u30ea\u3092\u4f5c\u3063\u3066\u307f\u308b\uff17\uff08\u30b5\u30fc\u30d3\u30b9\u30af\u30e9\u30b9\u306e\u516c\u958b\uff09](http://qiita.com/1roh/items/bf8435aade5b33be66d2)\u3078\n\n\n"}