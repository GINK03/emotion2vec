{"context": "\n\n\u6982\u8981\nGROVE\u306e\u571f\u4e2d\u6c34\u5206\u30bb\u30f3\u30b5\u30fc\u3068AD\u30b3\u30f3\u30d0\u30fc\u30bf(MCP3002)\u3067\u571f\u4e2d\u306b\u542b\u307e\u308c\u308b\u6c34\u5206\u91cf\u3092\uff15\u5206\u304a\u304d\u306b\u8a08\u6e2c\u3057\u3001\u6c34\u5206\u91cf\u304c\u95be\u5024\u3092\u4e0b\u56de\u3063\u305f\u3089\u706f\u6cb9\u30dd\u30f3\u30d7\u3092\u4f5c\u52d5\u3055\u305b\u3001\u6c34\u30bf\u30f3\u30af\u304b\u3089\u6c34\u3092\u6c72\u307f\u4e0a\u3052\u3066\u30d7\u30e9\u30f3\u30bf\u30fc\u306b\u6c34\u3092\u3084\u308b\u3068\u3044\u3046\u306e\u3092\u4f5c\u3063\u3066\u307f\u307e\u3057\u305f\u3002\n\n\u56de\u8def\u56f3\n\n\n\n\u571f\u4e2d\u6c34\u5206\u30bb\u30f3\u30b5\u30fc\u306e\u5024\u3092\u8aad\u307f\u53d6\u308b\n\u6c34\u5206\u30bb\u30f3\u30b5\u30fc\u306f\u6c34\u5206\u91cf\u306b\u5fdc\u3058\u305f\u96fb\u5727\uff08\u30a2\u30ca\u30ed\u30b0\u5024\uff09\u304c\u51fa\u529b\u3055\u308c\u307e\u3059\u3002\nRaspberry Pi\u306f\u30c7\u30b8\u30bf\u30eb\u5165\u529b\u3057\u304b\u3067\u304d\u306a\u3044\u306e\u3067\u3001AD\u30b3\u30f3\u30d0\u30fc\u30bf\u3067\u30c7\u30b8\u30bf\u30eb\u30c7\u30fc\u30bf\u306b\u5909\u63db\u3057\u3066\u8aad\u307f\u53d6\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\u4eca\u56de\u306fAD\u30b3\u30f3\u30d0\u30fc\u30bf\u306b\u306fMCP3002\u3092\u4f7f\u7528\u3057\u307e\u3057\u305f\u3002\nRaspberry Pi\u3068MCP3002\u306e\u63a5\u7d9a\u306f\u4ee5\u4e0b\u306e\u8a18\u4e8b\u3092\u53c2\u8003\u306b\u3055\u305b\u3066\u3044\u305f\u3060\u304d\u307e\u3057\u305f\u3002\nRaspberry Pi\u306bA/D\u30b3\u30f3\u30d0\u30fc\u30bfMCP3002\u3092\u3064\u306a\u3050\n\u571f\u4e2d\u6c34\u5206\u30bb\u30f3\u30b5\u306f\u4ee5\u4e0b\u306e\u7269\u3092\u4f7f\u7528\u3057\u307e\u3057\u305f\u3002\nhttps://www.switch-science.com/catalog/814/\n\u30bb\u30f3\u30b5\u30fc\u306f\u30d7\u30e9\u30f3\u30bf\u30fc\u306b\u7a74\u3092\u3042\u3051\u3066\u5dee\u3057\u8fbc\u3093\u3067\u3044\u307e\u3059\u3002\n\n\n\u706f\u6cb9\u30dd\u30f3\u30d7\u3092\u4f5c\u52d5\u3055\u305b\u3066\u6c34\u3092\u3084\u308b\n\n\u6c34\u3084\u308a\u306e\u90e8\u5206\u306f\u96fb\u52d5\u5f0f\u706f\u6cb9\u30dd\u30f3\u30d7\u3068GPIO\u3092\u63a5\u7d9a\u3057\u3066GPIO\u3092ON\u306b\u3059\u308b\u3053\u3068\u3067\u706f\u6cb9\u30dd\u30f3\u30d7\u304c\u4f5c\u52d5\u3059\u308b\u3088\u3046\u306b\u3057\u3066\u3044\u307e\u3059\u3002\n\u305f\u3060\u3001\u30dd\u30f3\u30d7\u306f\u30e2\u30fc\u30bf\u304c\u4f5c\u52d5\u3059\u308b\u306e\u3067\u3059\u304c\u3001Raspberry Pi\u306eGPIO\u3067\u30e2\u30fc\u30bf\u3092\u52d5\u304b\u305d\u3046\u3068\u3059\u308b\u3068\u3001\u96fb\u529b\u4e0d\u8db3\u306b\u9665\u3063\u3066\u3057\u307e\u3046\u306e\u3067\u3001\u706f\u6cb9\u30dd\u30f3\u30d7\u306f\u6700\u521d\u304b\u3089\u3064\u3044\u3066\u3044\u308b\u706f\u6cb9\u30dd\u30f3\u30d7\u306e\u96fb\u6c60\u30dc\u30c3\u30af\u30b9\u306e\u96fb\u6e90\u3067\u4f5c\u52d5\u3055\u305b\u308b\u3088\u3046\u306b\u3057\u3001Raspberry Pi\u304b\u3089\u306f\u30ea\u30ec\u30fc\u30b9\u30a4\u30c3\u30c1\u306e\u5236\u5fa1\u3092\u884c\u3044\u307e\u3059\u3002\nRaspberry Pi\u306eGPIO\u3092Python\u3067\u5236\u5fa1\u3067\u304d\u308b\u3088\u3046\u306b\u3059\u308b\u306b\u306f\u3001\u4ee5\u4e0b\u306e\u8a18\u4e8b\u3092\u53c2\u8003\u306b\u3055\u305b\u3066\u3044\u305f\u3060\u304d\u307e\u3057\u305f\u3002\nGPIO\u3067LED\u306e\u70b9\u6ec5(Python)\n\nPython\u30b3\u30fc\u30c9\n\uff15\u5206\u304a\u304d\u306b\u571f\u4e2d\u6c34\u5206\u91cf\u3092\u8a08\u6e2c\u3057\u3001\u95be\u5024\u3092\u4e0b\u56de\u3063\u305f\u3089\u706f\u6cb9\u30dd\u30f3\u30d7\u309230\u79d2\u52d5\u304b\u3057\u307e\u3059\u3002\n\u6c34\u30bf\u30f3\u30af\u304c\u7a7a\u306b\u306a\u3063\u3066\u3057\u307e\u3063\u3066\u3044\u305f\u5834\u5408\u306f\u3001\u706f\u6cb9\u30dd\u30f3\u30d7\u3092\u4f5c\u52d5\u3055\u305b\u3066\u3082\u6c34\u5206\u91cf\u304c\u56de\u5fa9\u305b\u305a\u3001\u307e\u305f5\u5206\u5f8c\u306b\u6c34\u3092\u3084\u308d\u3046\u3068\u3057\u3066\u3057\u307e\u3044\u3001\u706f\u6cb9\u30dd\u30f3\u30d7\u306e\u96fb\u6c60\u306e\u7121\u99c4\u9063\u3044\u306b\u306a\u3063\u3066\u3057\u307e\u3046\u306e\u3067\u3001\u4e00\u5ea6\u6c34\u3092\u3084\u3063\u305f\u3089\u305d\u306e\u5f8c\u3057\u3070\u3089\u304f\u306f\u6c34\u3084\u308a\u3092\u3057\u306a\u3044\u3088\u3046\u306b\u3057\u3066\u3044\u307e\u3059\u3002\n\nwater.py\nimport spidev\nimport time\nimport datetime\nimport subprocess\nimport RPi.GPIO as GPIO\n\nwet_low = 450\nwater_check_enable = True\nwater_wait_count = 0\ncheck_reset = 10\n\n\ndef write_log(log_text):\n    f = open(\"/var/log/water\",\"a\")\n    d = datetime.datetime.today()\n    f.write (d.strftime(\"%Y-%m-%d %H:%M:%S\" + \",\" + log_text + \"\\n\" ))\n    #print log_text\n    f.close()\n\ndef read_wet_level():\n    spi=spidev.SpiDev()\n    spi.open(0,0)\n        resp=spi.xfer2([0x68,0x00])\n        value=(resp[0] * 256 + resp[1]) & 0x3ff\n        write_log(\"wet_level:\" + str(value))\n        spi.close()\n        return value\n\ndef water():\n    write_log(\"***** water start *****\")\n\n    GPIO.setmode(GPIO.BOARD)\n    GPIO.setup(16,GPIO.OUT)\n    GPIO.output(16,True)\n    time.sleep(30)\n    GPIO.output(16,False)\n    GPIO.cleanup()\n\n    write_log(\"***** water end *****\")\n\nwhile True:\n    wet_level =read_wet_level()\n\n    if water_check_enable == False:\n        water_wait_count += 1\n        if water_wait_count > check_reset:\n            water_check_enable = True\n            water_wait_count = 0\n\n    if wet_level < wet_low and water_check_enable == True:\n        water_check_enable = False\n        water()\n    time.sleep(300)\n\n\n\n#\u6982\u8981\nGROVE\u306e\u571f\u4e2d\u6c34\u5206\u30bb\u30f3\u30b5\u30fc\u3068AD\u30b3\u30f3\u30d0\u30fc\u30bf(MCP3002)\u3067\u571f\u4e2d\u306b\u542b\u307e\u308c\u308b\u6c34\u5206\u91cf\u3092\uff15\u5206\u304a\u304d\u306b\u8a08\u6e2c\u3057\u3001\u6c34\u5206\u91cf\u304c\u95be\u5024\u3092\u4e0b\u56de\u3063\u305f\u3089\u706f\u6cb9\u30dd\u30f3\u30d7\u3092\u4f5c\u52d5\u3055\u305b\u3001\u6c34\u30bf\u30f3\u30af\u304b\u3089\u6c34\u3092\u6c72\u307f\u4e0a\u3052\u3066\u30d7\u30e9\u30f3\u30bf\u30fc\u306b\u6c34\u3092\u3084\u308b\u3068\u3044\u3046\u306e\u3092\u4f5c\u3063\u3066\u307f\u307e\u3057\u305f\u3002\n\n#\u56de\u8def\u56f3\n![water_system_\u56de\u8def\u56f3.png](https://qiita-image-store.s3.amazonaws.com/0/123845/cff29939-d958-8211-6ca2-bdd77ea3e5b0.png)\n\n![IMG_3902.jpg](https://qiita-image-store.s3.amazonaws.com/0/123845/4e710e29-09ff-461f-64e6-93066c94ba99.jpeg)\n\n#\u571f\u4e2d\u6c34\u5206\u30bb\u30f3\u30b5\u30fc\u306e\u5024\u3092\u8aad\u307f\u53d6\u308b\n\u6c34\u5206\u30bb\u30f3\u30b5\u30fc\u306f\u6c34\u5206\u91cf\u306b\u5fdc\u3058\u305f\u96fb\u5727\uff08\u30a2\u30ca\u30ed\u30b0\u5024\uff09\u304c\u51fa\u529b\u3055\u308c\u307e\u3059\u3002\nRaspberry Pi\u306f\u30c7\u30b8\u30bf\u30eb\u5165\u529b\u3057\u304b\u3067\u304d\u306a\u3044\u306e\u3067\u3001AD\u30b3\u30f3\u30d0\u30fc\u30bf\u3067\u30c7\u30b8\u30bf\u30eb\u30c7\u30fc\u30bf\u306b\u5909\u63db\u3057\u3066\u8aad\u307f\u53d6\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\u4eca\u56de\u306fAD\u30b3\u30f3\u30d0\u30fc\u30bf\u306b\u306fMCP3002\u3092\u4f7f\u7528\u3057\u307e\u3057\u305f\u3002\nRaspberry Pi\u3068MCP3002\u306e\u63a5\u7d9a\u306f\u4ee5\u4e0b\u306e\u8a18\u4e8b\u3092\u53c2\u8003\u306b\u3055\u305b\u3066\u3044\u305f\u3060\u304d\u307e\u3057\u305f\u3002\n[Raspberry Pi\u306bA/D\u30b3\u30f3\u30d0\u30fc\u30bfMCP3002\u3092\u3064\u306a\u3050](http://qiita.com/f_nishio/items/4b9723c4e622a51aaeb5)\n\n\u571f\u4e2d\u6c34\u5206\u30bb\u30f3\u30b5\u306f\u4ee5\u4e0b\u306e\u7269\u3092\u4f7f\u7528\u3057\u307e\u3057\u305f\u3002\nhttps://www.switch-science.com/catalog/814/\n\u30bb\u30f3\u30b5\u30fc\u306f\u30d7\u30e9\u30f3\u30bf\u30fc\u306b\u7a74\u3092\u3042\u3051\u3066\u5dee\u3057\u8fbc\u3093\u3067\u3044\u307e\u3059\u3002\n![IMG_4033.jpg](https://qiita-image-store.s3.amazonaws.com/0/123845/18c20e45-c693-9280-37ad-8d131237282f.jpeg)\n\n\n#\u706f\u6cb9\u30dd\u30f3\u30d7\u3092\u4f5c\u52d5\u3055\u305b\u3066\u6c34\u3092\u3084\u308b\n\n![IMG_4032.jpg](https://qiita-image-store.s3.amazonaws.com/0/123845/bed926fa-b2b1-4bcd-49b9-61ab5eb2c89e.jpeg)\n\n\u6c34\u3084\u308a\u306e\u90e8\u5206\u306f\u96fb\u52d5\u5f0f\u706f\u6cb9\u30dd\u30f3\u30d7\u3068GPIO\u3092\u63a5\u7d9a\u3057\u3066GPIO\u3092ON\u306b\u3059\u308b\u3053\u3068\u3067\u706f\u6cb9\u30dd\u30f3\u30d7\u304c\u4f5c\u52d5\u3059\u308b\u3088\u3046\u306b\u3057\u3066\u3044\u307e\u3059\u3002\n\u305f\u3060\u3001\u30dd\u30f3\u30d7\u306f\u30e2\u30fc\u30bf\u304c\u4f5c\u52d5\u3059\u308b\u306e\u3067\u3059\u304c\u3001Raspberry Pi\u306eGPIO\u3067\u30e2\u30fc\u30bf\u3092\u52d5\u304b\u305d\u3046\u3068\u3059\u308b\u3068\u3001\u96fb\u529b\u4e0d\u8db3\u306b\u9665\u3063\u3066\u3057\u307e\u3046\u306e\u3067\u3001\u706f\u6cb9\u30dd\u30f3\u30d7\u306f\u6700\u521d\u304b\u3089\u3064\u3044\u3066\u3044\u308b\u706f\u6cb9\u30dd\u30f3\u30d7\u306e\u96fb\u6c60\u30dc\u30c3\u30af\u30b9\u306e\u96fb\u6e90\u3067\u4f5c\u52d5\u3055\u305b\u308b\u3088\u3046\u306b\u3057\u3001Raspberry Pi\u304b\u3089\u306f\u30ea\u30ec\u30fc\u30b9\u30a4\u30c3\u30c1\u306e\u5236\u5fa1\u3092\u884c\u3044\u307e\u3059\u3002\nRaspberry Pi\u306eGPIO\u3092Python\u3067\u5236\u5fa1\u3067\u304d\u308b\u3088\u3046\u306b\u3059\u308b\u306b\u306f\u3001\u4ee5\u4e0b\u306e\u8a18\u4e8b\u3092\u53c2\u8003\u306b\u3055\u305b\u3066\u3044\u305f\u3060\u304d\u307e\u3057\u305f\u3002\n[GPIO\u3067LED\u306e\u70b9\u6ec5(Python)](http://make.bcde.jp/raspberry-pi/gpio%E3%81%A7led%E3%81%AE%E7%82%B9%E6%BB%85python/)\n\n#Python\u30b3\u30fc\u30c9\n\n\uff15\u5206\u304a\u304d\u306b\u571f\u4e2d\u6c34\u5206\u91cf\u3092\u8a08\u6e2c\u3057\u3001\u95be\u5024\u3092\u4e0b\u56de\u3063\u305f\u3089\u706f\u6cb9\u30dd\u30f3\u30d7\u309230\u79d2\u52d5\u304b\u3057\u307e\u3059\u3002\n\u6c34\u30bf\u30f3\u30af\u304c\u7a7a\u306b\u306a\u3063\u3066\u3057\u307e\u3063\u3066\u3044\u305f\u5834\u5408\u306f\u3001\u706f\u6cb9\u30dd\u30f3\u30d7\u3092\u4f5c\u52d5\u3055\u305b\u3066\u3082\u6c34\u5206\u91cf\u304c\u56de\u5fa9\u305b\u305a\u3001\u307e\u305f5\u5206\u5f8c\u306b\u6c34\u3092\u3084\u308d\u3046\u3068\u3057\u3066\u3057\u307e\u3044\u3001\u706f\u6cb9\u30dd\u30f3\u30d7\u306e\u96fb\u6c60\u306e\u7121\u99c4\u9063\u3044\u306b\u306a\u3063\u3066\u3057\u307e\u3046\u306e\u3067\u3001\u4e00\u5ea6\u6c34\u3092\u3084\u3063\u305f\u3089\u305d\u306e\u5f8c\u3057\u3070\u3089\u304f\u306f\u6c34\u3084\u308a\u3092\u3057\u306a\u3044\u3088\u3046\u306b\u3057\u3066\u3044\u307e\u3059\u3002\n\n```water.py\nimport spidev\nimport time\nimport datetime\nimport subprocess\nimport RPi.GPIO as GPIO\n\nwet_low = 450\nwater_check_enable = True\nwater_wait_count = 0\ncheck_reset = 10\n\n\ndef write_log(log_text):\n\tf = open(\"/var/log/water\",\"a\")\n\td = datetime.datetime.today()\n\tf.write (d.strftime(\"%Y-%m-%d %H:%M:%S\" + \",\" + log_text + \"\\n\" ))\n\t#print log_text\n\tf.close()\n\ndef read_wet_level():\n\tspi=spidev.SpiDev()\n\tspi.open(0,0)\n        resp=spi.xfer2([0x68,0x00])\n        value=(resp[0] * 256 + resp[1]) & 0x3ff\n        write_log(\"wet_level:\" + str(value))\n        spi.close()\n        return value\n\ndef water():\n\twrite_log(\"***** water start *****\")\n\n\tGPIO.setmode(GPIO.BOARD)\n\tGPIO.setup(16,GPIO.OUT)\n\tGPIO.output(16,True)\n\ttime.sleep(30)\n\tGPIO.output(16,False)\n\tGPIO.cleanup()\n\n\twrite_log(\"***** water end *****\")\n\nwhile True:\n\twet_level =read_wet_level()\n\n\tif water_check_enable == False:\n\t\twater_wait_count += 1\n\t\tif water_wait_count > check_reset:\n\t\t\twater_check_enable = True\n\t\t\twater_wait_count = 0\n\n\tif wet_level < wet_low and water_check_enable == True:\n\t\twater_check_enable = False\n  \t\twater()\n\ttime.sleep(300)\n\t\n```\n", "tags": ["RaspberryPi", "\u96fb\u5b50\u5de5\u4f5c", "\u6c34\u3084\u308a", "Python", "MCP3002\u30bb\u30f3\u30b5\u30fc"]}