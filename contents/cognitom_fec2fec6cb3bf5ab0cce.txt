{"context": " More than 1 year has passed since last update.FQL\u3067\u306fJOIN\u304c\u4f7f\u3048\u306a\u3044\u305f\u3081\u3001\u8907\u6570\u306e\u30c6\u30fc\u30d6\u30eb\u304c\u95a2\u4fc2\u3059\u308b\u30c7\u30fc\u30bf\u3092\u6271\u3046\u306b\u306f\u3001\u8907\u6570\u30af\u30a8\u30ea\u306b\u5206\u3051\u308b\u30b1\u30fc\u30b9\u304c\u591a\u3044\u3067\u3059\u3002\u305f\u3060\u3001API\u306e\u30b3\u30fc\u30eb\u56de\u6570\u306f\u306a\u308b\u3079\u304f\u6e1b\u3089\u3055\u306a\u3044\u3068\u3001\u30b9\u30d4\u30fc\u30c9\u306e\u70b9\u3067\u4e0d\u5229\u306b\u306a\u3063\u3066\u3057\u307e\u3044\u307e\u3059\u3002\n\u3053\u3053\u3067\u306f\u3001\u6b21\u306e\u30dd\u30a4\u30f3\u30c8\u3092\u62bc\u3055\u3048\u3066\u3001\u30a4\u30d9\u30f3\u30c8\u60c5\u5831\u3068\u51fa\u5e2d\u8005\u30ea\u30b9\u30c8\u3092\u53d6\u5f97\u3059\u308b\u4f8b\u3092\u7d39\u4ecb\u3057\u307e\u3059\u3002\n\n\u30af\u30a8\u30ea\u306e\u767a\u884c\u56de\u6570\u306f1\u56de\u306b\n\u76f4\u524d\u306e\u30af\u30a8\u30ea\u306e\u7d50\u679c\u3092\u518d\u5229\u7528\n\u30a4\u30d9\u30f3\u30c8\u60c5\u5831\u306b\u51fa\u5e2d\u8005\u60c5\u5831\u3092\u57cb\u3081\u8fbc\u3093\u3067JSON\u3067\u51fa\u529b\n\n\n\u5358\u6570\u30af\u30a8\u30ea\n\u901a\u5e38\u306eFQL\u306f\u3001\u6b21\u306e\u3088\u3046\u306b\u767a\u884c\u3057\u307e\u3059\u3002\n<?php\n$result = $facebook->api(array(\n    'method' => 'fql.query',\n    'query' => 'SELECT ...',\n));\n\n\u3072\u3068\u3064\u306eFQL\u3067\u30011\u56deAPI\u3092\u30b3\u30fc\u30eb\u3057\u3066\u3057\u307e\u3046\u306e\u3067\u3001PHP\u5074\u304b\u3089\u8907\u6570\u56de\u547c\u51fa\u3059\u3068\u975e\u5e38\u306b\u6642\u9593\u304c\u304b\u304b\u308b\u306e\u304c\u96e3\u70b9\u3002\u7279\u306b\u3001\u4e00\u56de\u76ee\u306eFQL\u306e\u7d50\u679c\u306e\u4ef6\u6570\u3060\u3051\u3001\u518d\u5ea6FQL\u3092\u5b9f\u884c\u3059\u308b\u3088\u3046\u306a\u5b9f\u88c5\u306f\u907f\u3051\u308b\u3079\u304d\u3067\u3059\u3002\n(\u5f8c\u8ff0\u306e\u4f8b\u3067\u8003\u3048\u308b\u306a\u3089\u3001\u30a4\u30d9\u30f3\u30c85\u4ef6\u3092\u53d6\u5f97\u5f8c\u3001\u305d\u308c\u305e\u308c\u304b\u3089\u5358\u6570\u30af\u30a8\u30ea\u3067\u51fa\u5e2d\u8005\u60c5\u5831\u3092\u53d6\u5f97\u3059\u308b\u3068\u3001\u5c11\u306a\u304f\u3068\u30826\u56de\u306eAPI\u30b3\u30fc\u30eb\u304c\u5fc5\u8981\u3067\u3059)\n\n\u8907\u6570\u30af\u30a8\u30ea\n\u305d\u308c\u3067\u306f\u3001\u3069\u306e\u3088\u3046\u306b\u3059\u308b\u306e\u304c\u671b\u307e\u3057\u3044\u3067\u3057\u3087\u3046\u304b? Facebook PHP SDK\u306b\u306f\u3001\u8907\u6570\u30af\u30a8\u30ea\u3092\u767a\u884c\u3059\u308b\u6a5f\u80fd\u304c\u7528\u610f\u3055\u308c\u3066\u3044\u307e\u3059\u3002\u6b21\u306e\u3088\u3046\u306b\u3001\u5b9f\u884c\u3059\u308b\u3053\u3068\u3067...\n<?php\n$results = $facebook->api(array(\n    'method' => 'fql.multiquery',\n    'queries' => array(\n        'query1' => 'SELECT ..(\u7701\u7565)..',\n        'query2' => 'SELECT ..(\u7701\u7565)..',\n    ),\n));\n\n\u8907\u6570\u306e\u30af\u30a8\u30ea\u306e\u5b9f\u884c\u7d50\u679c\u304c\u3001\u914d\u5217\u3068\u3057\u3066\u8fd4\u3063\u3066\u304d\u307e\u3059\u3002\n<?php\narray(\n    array(\n        'name' => 'query1',\n        'fql_result_set' => array(\n            ..(\u7701\u7565)..\n        ),\n    ),\n    array(\n        'name' => 'query2',\n        'fql_result_set' => array(\n            ..(\u7701\u7565)..\n        ),\n    ),\n)\n\n\n\u30af\u30a8\u30ea\u306e\u518d\u5229\u7528\n\u6700\u521d\u306e\u30af\u30a8\u30ea\u306e\u7d50\u679c\u306b\u95a2\u4fc2\u3059\u308b\u9805\u76ee\u3060\u3051\u63a2\u3057\u305f\u3044\u5834\u5408\u3001\u300c#query1\u300d\u306e\u3088\u3046\u306a\u8a18\u8ff0\u3092\u4f7f\u3046\u3068\u3001\u7c21\u7565\u5316\u3067\u304d\u307e\u3059\u3002\u6b21\u306e\u4f8b\u3067\u306f\u3001query2\u3067\u306f\u3001query1\u306e\u7d50\u679c\u3092\u30c6\u30fc\u30d6\u30eb\u3068\u307f\u306a\u3057\u3066\u3001\u305d\u3053\u304b\u3089\u30e6\u30fc\u30b6ID(uid)\u306e\u4e00\u89a7\u3092\u53d6\u308a\u51fa\u3057\u307e\u3059\u3002\n<?php\n$results = $facebook->api(array(\n    'method' => 'fql.multiquery',\n    'queries' => array(\n        'query1' => 'SELECT ..(\u7701\u7565)..',\n        'query2' => 'SELECT ..(\u7701\u7565).. FROM user WHERE uid IN (SELECT FROM #query1)',\n    ),\n));\n\n\n\u30a4\u30d9\u30f3\u30c8\u60c5\u5831\u3068\u51fa\u5e2d\u8005\u30ea\u30b9\u30c8\u3092\u53d6\u5f97\u3059\u308b\u4f8b\n\u4ee5\u4e0a\u3075\u307e\u3048\u3066\u3001\u5b9f\u969b\u306b\u4e0b\u5317\u6ca2\u30aa\u30fc\u30d7\u30f3\u30bd\u30fc\u30b9Cafe\u3067\u4f7f\u308f\u308c\u3066\u3044\u308b\u30b3\u30fc\u30c9\u3092\u898b\u3066\u307f\u307e\u3057\u3087\u3046\u3002\u51e6\u7406\u306e\u6d41\u308c\u3092\u7b87\u6761\u66f8\u304d\u306b\u3057\u3066\u304a\u304d\u307e\u3059\u3002\u8a73\u3057\u304f\u306f\u3001\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u5185\u306e\u30b3\u30e1\u30f3\u30c8\u53c2\u7167\u3002\n\nFacebook\u30af\u30e9\u30b9\u306e\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u3092\u4f5c\u6210\n\u30a4\u30d9\u30f3\u30c8(event)\u30fb\u95a2\u4fc2(event_member)\u30fb\u30e6\u30fc\u30b6(user)\u305d\u308c\u305e\u308c\u306eFQL\u3092\u69cb\u7bc9\nAPI\u3092\u547c\u51fa\u3059\n\u5404\u7d50\u679c\u3092\u6dfb\u5b57\u914d\u5217\u306b\u683c\u7d0d\u3057\u306a\u304a\u3059\n\u5404\u30a4\u30d9\u30f3\u30c8\u60c5\u5831\u306b\u3001\u51fa\u5e2d\u8005\u60c5\u5831\u3092\u4ed8\u52a0\n\u914d\u5217\u3092JSON\u5f62\u5f0f\u3067\u51fa\u529b\n\n<?php\n    $facebook = new Facebook(array(\n        'appId'=>$_SERVER['FACEBOOK_APPID'],\n        'secret'=>$_SERVER['FACEBOOK_SECRET'],\n    ));\n\n    $page_id = 131130253626713;//\u4e0b\u5317\u6ca2\u30aa\u30fc\u30d7\u30f3\u30bd\u30fc\u30b9Cafe\u306eID\n    $yesterday = time()-60*60*12;//12\u6642\u9593\u524d\u3092\u57fa\u6e96\u306b\n    $fql = array();\n\n    //\u30a4\u30d9\u30f3\u30c8\u60c5\u5831\u3092\u53d6\u5f97\u3059\u308b\u30af\u30a8\u30ea\n    $fql['events'] = <<<________FQL\n        SELECT description, eid, name, pic, pic_big, start_time\n        FROM event\n        WHERE\n            eid in (\n                SELECT eid \n                FROM event_member \n                WHERE uid = $page_id AND $yesterday < start_time)\n            AND privacy = 'OPEN'\n        ORDER BY start_time\n        LIMIT 5\n________FQL;\n\n    //\u30a4\u30d9\u30f3\u30c8\u3068\u51fa\u5e2d\u8005\u306e\u95a2\u4fc2(event_member)\u3092\u53d6\u5f97\u3059\u308b\u30af\u30a8\u30ea\n    $fql['map'] = <<<________FQL\n        SELECT eid, uid\n        FROM event_member\n        WHERE\n            rsvp_status IN (\"attending\", \"unsure\") AND\n            eid in (SELECT eid FROM #events)\n________FQL;\n\n    //\u51fa\u5e2d\u8005\u60c5\u5831\u3092\u53d6\u5f97\u3059\u308b\u30af\u30a8\u30ea\n    $fql['attendees'] = <<<________FQL\n        SELECT uid, pic_square, profile_url\n        FROM user\n        WHERE uid in (SELECT uid FROM #map)\n________FQL;\n\n    //Facebook SDK \u3092\u4f7f\u3063\u3066\u3001\u8907\u6570\u30af\u30a8\u30ea\u3092\u767a\u884c\n    $results = $facebook->api(array(\n        'method'=>'fql.multiquery',\n        'queries'=>$fql,\n    ));\n\n    $map = array();\n    $events = array();\n    $attendees = array();\n\n    //$results\u5185\u306f\u6dfb\u5b57\u7121\u3057\u306e\u914d\u5217\u306a\u306e\u3067\u3001\u4e0b\u8a18\u306e\u3088\u3046\u306b\u51e6\u7406\u3059\u308b\u5fc5\u8981\u3042\u308a\u3002\n    foreach ($results as $result)\n        switch ($result['name']) {\n            case 'map':\n                $map = $result['fql_result_set'];\n                break;\n            case 'attendees':\n                foreach ($result['fql_result_set'] as $row)\n                    $attendees[$row['uid']] = $row;\n                break;\n            case 'events':\n                foreach ($result['fql_result_set'] as $row)\n                    $events[$row['eid']] = $row;\n                break;\n        }\n\n    //$map\u306b\u5f93\u3063\u3066\u3001\u5404\u30a4\u30d9\u30f3\u30c8\u306b\u51fa\u5e2d\u8005(attendees)\u60c5\u5831\u3092\u52a0\u3048\u308b\n    foreach ($map as $m){\n        $uid = $m['uid']; $eid = $m['eid'];\n        if (!isset($events[$eid]['attendees']))\n            $events[$eid]['attendees'] = array();\n        $events[$eid]['attendees'][] = $attendees[$uid];\n    }\n\n    //JSON\u5f62\u5f0f\u3067\u51fa\u529b\n    echo json_encode($events);\n\n\nFQL\u3067\u306fJOIN\u304c\u4f7f\u3048\u306a\u3044\u305f\u3081\u3001\u8907\u6570\u306e\u30c6\u30fc\u30d6\u30eb\u304c\u95a2\u4fc2\u3059\u308b\u30c7\u30fc\u30bf\u3092\u6271\u3046\u306b\u306f\u3001\u8907\u6570\u30af\u30a8\u30ea\u306b\u5206\u3051\u308b\u30b1\u30fc\u30b9\u304c\u591a\u3044\u3067\u3059\u3002\u305f\u3060\u3001API\u306e\u30b3\u30fc\u30eb\u56de\u6570\u306f\u306a\u308b\u3079\u304f\u6e1b\u3089\u3055\u306a\u3044\u3068\u3001\u30b9\u30d4\u30fc\u30c9\u306e\u70b9\u3067\u4e0d\u5229\u306b\u306a\u3063\u3066\u3057\u307e\u3044\u307e\u3059\u3002\n\n\u3053\u3053\u3067\u306f\u3001\u6b21\u306e\u30dd\u30a4\u30f3\u30c8\u3092\u62bc\u3055\u3048\u3066\u3001\u30a4\u30d9\u30f3\u30c8\u60c5\u5831\u3068\u51fa\u5e2d\u8005\u30ea\u30b9\u30c8\u3092\u53d6\u5f97\u3059\u308b\u4f8b\u3092\u7d39\u4ecb\u3057\u307e\u3059\u3002\n\n0. \u30af\u30a8\u30ea\u306e\u767a\u884c\u56de\u6570\u306f1\u56de\u306b\n0. \u76f4\u524d\u306e\u30af\u30a8\u30ea\u306e\u7d50\u679c\u3092\u518d\u5229\u7528\n0. \u30a4\u30d9\u30f3\u30c8\u60c5\u5831\u306b\u51fa\u5e2d\u8005\u60c5\u5831\u3092\u57cb\u3081\u8fbc\u3093\u3067JSON\u3067\u51fa\u529b\n\n##\u5358\u6570\u30af\u30a8\u30ea\n\n\u901a\u5e38\u306eFQL\u306f\u3001\u6b21\u306e\u3088\u3046\u306b\u767a\u884c\u3057\u307e\u3059\u3002\n\n```php\n<?php\n$result = $facebook->api(array(\n\t'method' => 'fql.query',\n\t'query' => 'SELECT ...',\n));\n```\n\n\u3072\u3068\u3064\u306eFQL\u3067\u30011\u56deAPI\u3092\u30b3\u30fc\u30eb\u3057\u3066\u3057\u307e\u3046\u306e\u3067\u3001PHP\u5074\u304b\u3089\u8907\u6570\u56de\u547c\u51fa\u3059\u3068\u975e\u5e38\u306b\u6642\u9593\u304c\u304b\u304b\u308b\u306e\u304c\u96e3\u70b9\u3002\u7279\u306b\u3001\u4e00\u56de\u76ee\u306eFQL\u306e\u7d50\u679c\u306e\u4ef6\u6570\u3060\u3051\u3001\u518d\u5ea6FQL\u3092\u5b9f\u884c\u3059\u308b\u3088\u3046\u306a\u5b9f\u88c5\u306f\u907f\u3051\u308b\u3079\u304d\u3067\u3059\u3002\n\n(\u5f8c\u8ff0\u306e\u4f8b\u3067\u8003\u3048\u308b\u306a\u3089\u3001\u30a4\u30d9\u30f3\u30c85\u4ef6\u3092\u53d6\u5f97\u5f8c\u3001\u305d\u308c\u305e\u308c\u304b\u3089\u5358\u6570\u30af\u30a8\u30ea\u3067\u51fa\u5e2d\u8005\u60c5\u5831\u3092\u53d6\u5f97\u3059\u308b\u3068\u3001\u5c11\u306a\u304f\u3068\u30826\u56de\u306eAPI\u30b3\u30fc\u30eb\u304c\u5fc5\u8981\u3067\u3059)\n\n##\u8907\u6570\u30af\u30a8\u30ea\n\n\u305d\u308c\u3067\u306f\u3001\u3069\u306e\u3088\u3046\u306b\u3059\u308b\u306e\u304c\u671b\u307e\u3057\u3044\u3067\u3057\u3087\u3046\u304b? [Facebook PHP SDK](https://github.com/facebook/facebook-php-sdk)\u306b\u306f\u3001\u8907\u6570\u30af\u30a8\u30ea\u3092\u767a\u884c\u3059\u308b\u6a5f\u80fd\u304c\u7528\u610f\u3055\u308c\u3066\u3044\u307e\u3059\u3002\u6b21\u306e\u3088\u3046\u306b\u3001\u5b9f\u884c\u3059\u308b\u3053\u3068\u3067...\n\n```php\n<?php\n$results = $facebook->api(array(\n\t'method' => 'fql.multiquery',\n\t'queries' => array(\n\t\t'query1' => 'SELECT ..(\u7701\u7565)..',\n\t\t'query2' => 'SELECT ..(\u7701\u7565)..',\n\t),\n));\n```\n\n\u8907\u6570\u306e\u30af\u30a8\u30ea\u306e\u5b9f\u884c\u7d50\u679c\u304c\u3001\u914d\u5217\u3068\u3057\u3066\u8fd4\u3063\u3066\u304d\u307e\u3059\u3002\n\n```php\n<?php\narray(\n\tarray(\n\t\t'name' => 'query1',\n\t\t'fql_result_set' => array(\n\t\t\t..(\u7701\u7565)..\n\t\t),\n\t),\n\tarray(\n\t\t'name' => 'query2',\n\t\t'fql_result_set' => array(\n\t\t\t..(\u7701\u7565)..\n\t\t),\n\t),\n)\n```\n\n##\u30af\u30a8\u30ea\u306e\u518d\u5229\u7528\n\n\u6700\u521d\u306e\u30af\u30a8\u30ea\u306e\u7d50\u679c\u306b\u95a2\u4fc2\u3059\u308b\u9805\u76ee\u3060\u3051\u63a2\u3057\u305f\u3044\u5834\u5408\u3001\u300c#query1\u300d\u306e\u3088\u3046\u306a\u8a18\u8ff0\u3092\u4f7f\u3046\u3068\u3001\u7c21\u7565\u5316\u3067\u304d\u307e\u3059\u3002\u6b21\u306e\u4f8b\u3067\u306f\u3001query2\u3067\u306f\u3001query1\u306e\u7d50\u679c\u3092\u30c6\u30fc\u30d6\u30eb\u3068\u307f\u306a\u3057\u3066\u3001\u305d\u3053\u304b\u3089\u30e6\u30fc\u30b6ID(uid)\u306e\u4e00\u89a7\u3092\u53d6\u308a\u51fa\u3057\u307e\u3059\u3002\n\n```php\n<?php\n$results = $facebook->api(array(\n\t'method' => 'fql.multiquery',\n\t'queries' => array(\n\t\t'query1' => 'SELECT ..(\u7701\u7565)..',\n\t\t'query2' => 'SELECT ..(\u7701\u7565).. FROM user WHERE uid IN (SELECT FROM #query1)',\n\t),\n));\n```\n\n##\u30a4\u30d9\u30f3\u30c8\u60c5\u5831\u3068\u51fa\u5e2d\u8005\u30ea\u30b9\u30c8\u3092\u53d6\u5f97\u3059\u308b\u4f8b\n\n\u4ee5\u4e0a\u3075\u307e\u3048\u3066\u3001\u5b9f\u969b\u306b[\u4e0b\u5317\u6ca2\u30aa\u30fc\u30d7\u30f3\u30bd\u30fc\u30b9Cafe](http://www.osscafe.net/)\u3067\u4f7f\u308f\u308c\u3066\u3044\u308b\u30b3\u30fc\u30c9\u3092\u898b\u3066\u307f\u307e\u3057\u3087\u3046\u3002\u51e6\u7406\u306e\u6d41\u308c\u3092\u7b87\u6761\u66f8\u304d\u306b\u3057\u3066\u304a\u304d\u307e\u3059\u3002\u8a73\u3057\u304f\u306f\u3001\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u5185\u306e\u30b3\u30e1\u30f3\u30c8\u53c2\u7167\u3002\n\n0. Facebook\u30af\u30e9\u30b9\u306e\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u3092\u4f5c\u6210\n0. \u30a4\u30d9\u30f3\u30c8(event)\u30fb\u95a2\u4fc2(event_member)\u30fb\u30e6\u30fc\u30b6(user)\u305d\u308c\u305e\u308c\u306eFQL\u3092\u69cb\u7bc9\n0. API\u3092\u547c\u51fa\u3059\n0. \u5404\u7d50\u679c\u3092\u6dfb\u5b57\u914d\u5217\u306b\u683c\u7d0d\u3057\u306a\u304a\u3059\n0. \u5404\u30a4\u30d9\u30f3\u30c8\u60c5\u5831\u306b\u3001\u51fa\u5e2d\u8005\u60c5\u5831\u3092\u4ed8\u52a0\n0. \u914d\u5217\u3092JSON\u5f62\u5f0f\u3067\u51fa\u529b\n\n```php\n<?php\n\t$facebook = new Facebook(array(\n\t\t'appId'=>$_SERVER['FACEBOOK_APPID'],\n\t\t'secret'=>$_SERVER['FACEBOOK_SECRET'],\n\t));\n\t\n\t$page_id = 131130253626713;//\u4e0b\u5317\u6ca2\u30aa\u30fc\u30d7\u30f3\u30bd\u30fc\u30b9Cafe\u306eID\n\t$yesterday = time()-60*60*12;//12\u6642\u9593\u524d\u3092\u57fa\u6e96\u306b\n\t$fql = array();\n\n\t//\u30a4\u30d9\u30f3\u30c8\u60c5\u5831\u3092\u53d6\u5f97\u3059\u308b\u30af\u30a8\u30ea\n\t$fql['events'] = <<<________FQL\n\t\tSELECT description, eid, name, pic, pic_big, start_time\n\t\tFROM event\n\t\tWHERE\n\t\t\teid in (\n\t\t\t\tSELECT eid \n\t\t\t\tFROM event_member \n\t\t\t\tWHERE uid = $page_id AND $yesterday < start_time)\n\t\t\tAND privacy = 'OPEN'\n\t\tORDER BY start_time\n\t\tLIMIT 5\n________FQL;\n\n\t//\u30a4\u30d9\u30f3\u30c8\u3068\u51fa\u5e2d\u8005\u306e\u95a2\u4fc2(event_member)\u3092\u53d6\u5f97\u3059\u308b\u30af\u30a8\u30ea\n\t$fql['map'] = <<<________FQL\n\t\tSELECT eid, uid\n\t\tFROM event_member\n\t\tWHERE\n\t\t\trsvp_status IN (\"attending\", \"unsure\") AND\n\t\t\teid in (SELECT eid FROM #events)\n________FQL;\n\n\t//\u51fa\u5e2d\u8005\u60c5\u5831\u3092\u53d6\u5f97\u3059\u308b\u30af\u30a8\u30ea\n\t$fql['attendees'] = <<<________FQL\n\t\tSELECT uid, pic_square, profile_url\n\t\tFROM user\n\t\tWHERE uid in (SELECT uid FROM #map)\n________FQL;\n\n\t//Facebook SDK \u3092\u4f7f\u3063\u3066\u3001\u8907\u6570\u30af\u30a8\u30ea\u3092\u767a\u884c\n\t$results = $facebook->api(array(\n\t\t'method'=>'fql.multiquery',\n\t\t'queries'=>$fql,\n\t));\n\n\t$map = array();\n\t$events = array();\n\t$attendees = array();\n\n\t//$results\u5185\u306f\u6dfb\u5b57\u7121\u3057\u306e\u914d\u5217\u306a\u306e\u3067\u3001\u4e0b\u8a18\u306e\u3088\u3046\u306b\u51e6\u7406\u3059\u308b\u5fc5\u8981\u3042\u308a\u3002\n\tforeach ($results as $result)\n\t\tswitch ($result['name']) {\n\t\t\tcase 'map':\n\t\t\t\t$map = $result['fql_result_set'];\n\t\t\t\tbreak;\n\t\t\tcase 'attendees':\n\t\t\t\tforeach ($result['fql_result_set'] as $row)\n\t\t\t\t\t$attendees[$row['uid']] = $row;\n\t\t\t\tbreak;\n\t\t\tcase 'events':\n\t\t\t\tforeach ($result['fql_result_set'] as $row)\n\t\t\t\t\t$events[$row['eid']] = $row;\n\t\t\t\tbreak;\n\t\t}\n\n\t//$map\u306b\u5f93\u3063\u3066\u3001\u5404\u30a4\u30d9\u30f3\u30c8\u306b\u51fa\u5e2d\u8005(attendees)\u60c5\u5831\u3092\u52a0\u3048\u308b\n\tforeach ($map as $m){\n\t\t$uid = $m['uid']; $eid = $m['eid'];\n\t\tif (!isset($events[$eid]['attendees']))\n\t\t\t$events[$eid]['attendees'] = array();\n\t\t$events[$eid]['attendees'][] = $attendees[$uid];\n\t}\n\t\n\t//JSON\u5f62\u5f0f\u3067\u51fa\u529b\n\techo json_encode($events);\n```", "tags": ["PHP", "FQL", "Facebook"]}