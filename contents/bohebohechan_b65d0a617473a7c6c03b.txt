{"tags": ["Elasticsearch1.2.1", "kibana33.1.0"], "context": " More than 1 year has passed since last update.Chef\u306e\u30ec\u30b7\u30d4\u306b\u3057\u3066\u304a\u304f\u3068\u4fbf\u5229\u304b\u306a\u3068\u3002\n\n\u74b0\u5883\nCentOS 6.5\n\nelasticsearch\n\nrecipes/elasticsearch.rb\n## java install\npackage \"java-1.7.0-openjdk\" do\n  action :install\nend\n\n## install\nbash \"elasticsearch\" do\n  not_if \"ls /usr/local/share/elasticsearch-1.2.1\"\n  user \"root\"\n  cwd \"/usr/local/src\"\n  code <<-EOH\n    wget https://download.elasticsearch.org/elasticsearch/elasticsearch/elasticsearch-1.2.1.tar.gz\n    tar xvzf elasticsearch-1.2.1.tar.gz -C /usr/local/share/\n  EOH\nend\n\n## add service\nbash \"elasticsearch_as_service\" do\n  not_if \"ls usr/local/share/elasticsearch-1.2.1/bin/service\"\n  user \"root\"\n  cwd \"/usr/local/src\"\n  code <<-EOH\n    wget https://github.com/elasticsearch/elasticsearch-servicewrapper/archive/master.zip\n    unzip /usr/local/src/master\n    mv /usr/local/src/elasticsearch-servicewrapper-master/service/ /usr/local/share/elasticsearch-1.2.1/bin/\n    /usr/local/share/elasticsearch-1.2.1/bin/service/elasticsearch install\n  EOH\nend\n\n## elasticsearch log dir\ndirectory '/usr/local/share/elasticsearch-1.2.1/logs/' do\n  owner 'root'\n  group 'root'\n  mode '0755'\n  action :create\nend\n\n## elasticsearch.yml\ntemplate \"/usr/local/share/elasticsearch-1.2.1/config/elasticsearch.yml\" do\n  source \"elasticsearch.yml.erb\"\n  owner \"root\"\n  group \"root\"\n  mode 755\nend\n\n\n## service start\nservice \"elasticsearch\" do\n    action [ :enable, :start ]\n    subscribes :restart, resources(:template => \"/usr/local/share/elasticsearch-1.2.1/config/elasticsearch.yml\")\nend\n\n## chkconfig\nexecute \"add_elasticsearch_service\" do\n  user \"root\"\n  command  \"chkconfig elasticsearch on\"\n  action :run\nend\n\n\n\ntemplate/default\n\n\u3053\u306e\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u4ee5\u4e0b\u306e\u30d5\u30a1\u30a4\u30eb\u3092\u304a\u3044\u3066\u304a\u304f\u3053\u3068\u3002\n\nelasticsearch.yml.erb\n\n\n\u3042\u308c\uff1f\u3063\u3066\u601d\u3063\u305f\u3053\u3068\n\nlog\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u304c\u306a\u304f\u3066\u3001\u8d77\u52d5\u306b\u5931\u6557\u3057\u305f\u306e\u3067\u3001\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u4f5c\u6210\u3092\u8ffd\u52a0\u3057\u305f\njava\u304c\u306a\u304b\u3063\u305f\u306e\u3067\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3057\u305f\u3002\u3002\n\n\nkibana\n\nrecipes/kibana.rb\n## directory\ndirectory '/var/www/html/kibana' do\n  owner 'root'\n  group 'root'\n  mode '0755'\n  action :create\nend\n\n## kibana install\nbash \"kibana\" do\n  not_if \"ls /var/www/html/kibana\"\n  user \"root\"\n  cwd \"/usr/local/src\"\n  code <<-EOH\n    wget https://download.elasticsearch.org/kibana/kibana/kibana-3.1.0.tar.gz\n    tar xvzf kibana-3.1.0.tar.gz -C /var/www/html\n    mv /var/www/html/kibana-3.1.0 /var/www/html/kibana\n  EOH\nend\n\n## kibana config setting\ntemplate \"/var/www/html/kibana/config.js\" do\n  source \"config.js.erb\"\n  owner \"root\"\n  group \"root\"\n  mode 755\nend\n\n\napache\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u306f\u5225\u30ec\u30b7\u30d4\u306b\u3057\u3066\u4f7f\u3044\u56de\u3057\n\nrecipes/apache.rb\npackage \"httpd\" do\n    version \"2.2.15-30.el6.centos\"\n    action :install\nend\n\nservice \"httpd\" do\n  supports :status =>true, :restart=>true, :reload=>true\n  action [:enable, :start]\nend\n\nexecute \"add_httpd_service\" do\n  user \"root\"\n  command  \"chkconfig httpd on\"\n  action :run\nend\n\n\n\ntemplate/default\n\n\u3053\u306e\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u4ee5\u4e0b\u306e\u30d5\u30a1\u30a4\u30eb\u3092\u304a\u3044\u3066\u304a\u304f\u3053\u3068\u3002\n\nconfig.js.erb\n\nChef\u306e\u30ec\u30b7\u30d4\u306b\u3057\u3066\u304a\u304f\u3068\u4fbf\u5229\u304b\u306a\u3068\u3002\n\n# \u74b0\u5883\nCentOS 6.5\n\n#elasticsearch\n\n```rb:recipes/elasticsearch.rb\n## java install\npackage \"java-1.7.0-openjdk\" do\n  action :install\nend\n\n## install\nbash \"elasticsearch\" do\n  not_if \"ls /usr/local/share/elasticsearch-1.2.1\"\n  user \"root\"\n  cwd \"/usr/local/src\"\n  code <<-EOH\n    wget https://download.elasticsearch.org/elasticsearch/elasticsearch/elasticsearch-1.2.1.tar.gz\n    tar xvzf elasticsearch-1.2.1.tar.gz -C /usr/local/share/\n  EOH\nend\n\n## add service\nbash \"elasticsearch_as_service\" do\n  not_if \"ls usr/local/share/elasticsearch-1.2.1/bin/service\"\n  user \"root\"\n  cwd \"/usr/local/src\"\n  code <<-EOH\n    wget https://github.com/elasticsearch/elasticsearch-servicewrapper/archive/master.zip\n    unzip /usr/local/src/master\n    mv /usr/local/src/elasticsearch-servicewrapper-master/service/ /usr/local/share/elasticsearch-1.2.1/bin/\n    /usr/local/share/elasticsearch-1.2.1/bin/service/elasticsearch install\n  EOH\nend\n\n## elasticsearch log dir\ndirectory '/usr/local/share/elasticsearch-1.2.1/logs/' do\n  owner 'root'\n  group 'root'\n  mode '0755'\n  action :create\nend\n\n## elasticsearch.yml\ntemplate \"/usr/local/share/elasticsearch-1.2.1/config/elasticsearch.yml\" do\n  source \"elasticsearch.yml.erb\"\n  owner \"root\"\n  group \"root\"\n  mode 755\nend\n\n\n## service start\nservice \"elasticsearch\" do\n    action [ :enable, :start ]\n    subscribes :restart, resources(:template => \"/usr/local/share/elasticsearch-1.2.1/config/elasticsearch.yml\")\nend\n\n## chkconfig\nexecute \"add_elasticsearch_service\" do\n  user \"root\"\n  command  \"chkconfig elasticsearch on\"\n  action :run\nend\n```\n\n* template/default\n\n  \u3053\u306e\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u4ee5\u4e0b\u306e\u30d5\u30a1\u30a4\u30eb\u3092\u304a\u3044\u3066\u304a\u304f\u3053\u3068\u3002\n\n> elasticsearch.yml.erb\n\n\n## \u3042\u308c\uff1f\u3063\u3066\u601d\u3063\u305f\u3053\u3068\n\n* log\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u304c\u306a\u304f\u3066\u3001\u8d77\u52d5\u306b\u5931\u6557\u3057\u305f\u306e\u3067\u3001\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u4f5c\u6210\u3092\u8ffd\u52a0\u3057\u305f\n* java\u304c\u306a\u304b\u3063\u305f\u306e\u3067\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3057\u305f\u3002\u3002\n\n#kibana\n```rb:recipes/kibana.rb\n## directory\ndirectory '/var/www/html/kibana' do\n  owner 'root'\n  group 'root'\n  mode '0755'\n  action :create\nend\n\n## kibana install\nbash \"kibana\" do\n  not_if \"ls /var/www/html/kibana\"\n  user \"root\"\n  cwd \"/usr/local/src\"\n  code <<-EOH\n    wget https://download.elasticsearch.org/kibana/kibana/kibana-3.1.0.tar.gz\n    tar xvzf kibana-3.1.0.tar.gz -C /var/www/html\n    mv /var/www/html/kibana-3.1.0 /var/www/html/kibana\n  EOH\nend\n\n## kibana config setting\ntemplate \"/var/www/html/kibana/config.js\" do\n  source \"config.js.erb\"\n  owner \"root\"\n  group \"root\"\n  mode 755\nend\n```\n\napache\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u306f\u5225\u30ec\u30b7\u30d4\u306b\u3057\u3066\u4f7f\u3044\u56de\u3057\n\n```rb:recipes/apache.rb\npackage \"httpd\" do\n    version \"2.2.15-30.el6.centos\"\n    action :install\nend\n\nservice \"httpd\" do\n  supports :status =>true, :restart=>true, :reload=>true\n  action [:enable, :start]\nend\n\nexecute \"add_httpd_service\" do\n  user \"root\"\n  command  \"chkconfig httpd on\"\n  action :run\nend\n```\n\n* template/default\n\n  \u3053\u306e\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u4ee5\u4e0b\u306e\u30d5\u30a1\u30a4\u30eb\u3092\u304a\u3044\u3066\u304a\u304f\u3053\u3068\u3002\n\n> config.js.erb\n"}