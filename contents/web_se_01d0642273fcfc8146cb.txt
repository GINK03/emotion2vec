{"context": "12/22 \u306eGCPUG\u5fd8\u5e74\u4f1a\u306e\u969b\u306bLT\u306b\u3042\u308a\u307e\u3057\u305fkubectl\u3067persistent disk\u3092\u5fc5\u8981\u306a\u3068\u304d\u306b\u52d5\u7684\u306b\u4f5c\u6210\u3059\u308b\u3053\u3068\u304c\u53ef\u80fd\nkubectl\u30c4\u30fc\u30eb\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u304b\u3089\nhirutaMacBook-Air:pv-provisioning hiruta$ sudo gcloud components update kubectl\nYou have specified individual components to update.  If you are trying\n to install new components, use:\n  $ gcloud components install kubectl\n\nDo you want to run install instead (y/N)?\n\nGKE\u30af\u30e9\u30b9\u30bf\u306e\u4f5c\u6210\n$ gcloud container clusters create test-cluster001 --zone asia-northeast1-a --num-nodes 2 --machine-type g1-small\n\nkubectl\u304b\u3089\u63a5\u7d9a\u3059\u308b\u305f\u3081\u306e\u6e96\u5099\ngcloud config set container/cluster test-cluster001\n\ngcloud container clusters get-credentials --zone asia-northeast1-a test-cluster001 \n\n\u30c7\u30e2\u7528\u30ea\u30dd\u30b8\u30c8\u30ea\u3092github\u304b\u3089\u53d6\u5f97\u3057\u307e\u3059\u3002\ngit clone https://github.com/kubernetes/contrib.git\n\ncd contrib/micro-demos/pv-provisioning\n\nnamespaes\u306e\u4f5c\u6210\nhirutaMacBook-Air:pv-provisioning hiruta$ kubectl create namespace demos\nnamespace \"demos\" created\n\nProvision Disk\u306e\u4f5c\u6210\nhirutaMacBook-Air:pv-provisioning hiruta$ kubectl --namespace=demos create -f claim.yaml\npersistentvolumeclaim \"pv-provisioning-demo\" created\n\nhirutaMacBook-Air:pv-provisioning hiruta$ kubectl --namespace=demos describe pvc pv-provisioning-demo\nName:       pv-provisioning-demo\nNamespace:  demos\nStatus:     Bound\nVolume:     pvc-e4c49d86-c8cd-11e6-a74a-42010a920012\nLabels:     demo=pv-provisioning\nCapacity:   10Gi\nAccess Modes:   RWO\nNo events.\n\n10GiB\u306epersistent disk\u304c\u4f5c\u6210\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u304c\u308f\u304b\u308a\u307e\u3059\u3002\n\u5b9f\u306f\u30018GiB\u3068\u304b\u3067\u3082\u30b3\u30de\u30f3\u30c9\u4e0a\u306f\u4f5c\u6210\u3067\u304d\u3066\u3057\u307e\u3044\u307e\u3059\u3002Web UI\u304b\u3089\u306f\u4f5c\u6210\u306f\u3067\u304d\u307e\u305b\u3093\u3002\nhirutaMacBook-Air:pv-provisioning hiruta$ gcloud compute disks list\nNAME                                                             ZONE               SIZE_GB  TYPE         STATUS\ngke-test-cluster001-38-pvc-e4c49d86-c8cd-11e6-a74a-42010a920012  asia-northeast1-a  10       pd-standard  READY\ngke-test-cluster001-default-pool-99aa09bf-7kdr                   asia-northeast1-a  100      pd-standard  READY\ngke-test-cluster001-default-pool-99aa09bf-cnhz                   asia-northeast1-a  100      pd-standard  READY\n\nPod\u306eProvisioning\nhirutaMacBook-Air:pv-provisioning hiruta$ kubectl --namespace=demos describe pods -l demo=pv-provisioning\nName:       pv-provisioning-demo-ut26m\nNamespace:  demos\nNode:       gke-test-cluster001-default-pool-99aa09bf-7kdr/10.146.0.2\nStart Time: Fri, 23 Dec 2016 14:12:21 +0900\nLabels:     demo=pv-provisioning\nStatus:     Pending\nIP:\nControllers:    <none>\nContainers:\n  busybox:\n    Container ID:\n    Image:      busybox\n    Image ID:\n    Port:\n    Command:\n      sh\n      -c\n      touch /pv/`hostname`; while true; do sleep 3600; done\n    State:      Waiting\n      Reason:       ContainerCreating\n    Ready:      False\n    Restart Count:  0\n    Volume Mounts:\n      /pv from pv (rw)\n      /var/run/secrets/kubernetes.io/serviceaccount from default-token-2ehyr (ro)\n    Environment Variables:  <none>\nConditions:\n  Type      Status\n  Initialized   True\n  Ready     False\n  PodScheduled  True\nVolumes:\n  pv:\n    Type:   PersistentVolumeClaim (a reference to a PersistentVolumeClaim in the same namespace)\n    ClaimName:  pv-provisioning-demo\n    ReadOnly:   false\n  default-token-2ehyr:\n    Type:   Secret (a volume populated by a Secret)\n    SecretName: default-token-2ehyr\nQoS Class:  BestEffort\nTolerations:    <none>\nEvents:\n  FirstSeen LastSeen    Count   From            SubobjectPath   Type        Reason      Message\n  --------- --------    -----   ----            -------------   --------    ------      -------\n  40s       40s     1   {default-scheduler }            Normal      Scheduled   Successfully assigned pv-provisioning-demo-ut26m to gke-test-cluster001-default-pool-99aa09bf-7kdr\n\n/pv\u306b\u30de\u30a6\u30f3\u30c8\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u304c\u308f\u304b\u308a\u307e\u3059\u3002\nhirutaMacBook-Air:pv-provisioning hiruta$ kubectl --namespace=demos exec --tty -i pv-provisioning-demo-ut26m sh\n/ # df\nFilesystem           1K-blocks      Used Available Use% Mounted on\noverlay               98819296   2434024  96368888   2% /\ntmpfs                   869948         0    869948   0% /dev\ntmpfs                   869948         0    869948   0% /sys/fs/cgroup\n/dev/sdb              10190100     36888   9612540   0% /pv\n/dev/sda1             98819296   2434024  96368888   2% /dev/termination-log\ntmpfs                   869948        12    869936   0% /var/run/secrets/kubernetes.io/serviceaccount\n/dev/sda1             98819296   2434024  96368888   2% /etc/resolv.conf\n/dev/sda1             98819296   2434024  96368888   2% /etc/hostname\n/dev/sda1             98819296   2434024  96368888   2% /etc/hosts\nshm                      65536         0     65536   0% /dev/shm\ntmpfs                   869948         0    869948   0% /proc/kcore\ntmpfs                   869948         0    869948   0% /proc/timer_stats\n\nPod\u306e\u524a\u9664\nhirutaMacBook-Air:pv-provisioning hiruta$ kubectl --namespace=demos delete pods -l demo=pv-provisioning\npod \"pv-provisioning-demo-ut26m\" deleted\n\nhirutaMacBook-Air:pv-provisioning hiruta$ kubectl --namespace=demos describe pvc pv-provisioning-demo\nName:       pv-provisioning-demo\nNamespace:  demos\nStatus:     Bound\nVolume:     pvc-e4c49d86-c8cd-11e6-a74a-42010a920012\nLabels:     demo=pv-provisioning\nCapacity:   10Gi\nAccess Modes:   RWO\nNo events.\n\npersistent disk \u306e\u524a\u9664\nhirutaMacBook-Air:pv-provisioning hiruta$ kubectl --namespace=demos delete pvc -l demo=pv-provisioning\npersistentvolumeclaim \"pv-provisioning-demo\" deleted\n\n12/22 \u306eGCPUG\u5fd8\u5e74\u4f1a\u306e\u969b\u306bLT\u306b\u3042\u308a\u307e\u3057\u305fkubectl\u3067persistent disk\u3092\u5fc5\u8981\u306a\u3068\u304d\u306b\u52d5\u7684\u306b\u4f5c\u6210\u3059\u308b\u3053\u3068\u304c\u53ef\u80fd\n\nkubectl\u30c4\u30fc\u30eb\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u304b\u3089\n\n```\nhirutaMacBook-Air:pv-provisioning hiruta$ sudo gcloud components update kubectl\nYou have specified individual components to update.  If you are trying\n to install new components, use:\n  $ gcloud components install kubectl\n\nDo you want to run install instead (y/N)?\n```\n\nGKE\u30af\u30e9\u30b9\u30bf\u306e\u4f5c\u6210\n\n```\n$ gcloud container clusters create test-cluster001 --zone asia-northeast1-a --num-nodes 2 --machine-type g1-small\n```\n\nkubectl\u304b\u3089\u63a5\u7d9a\u3059\u308b\u305f\u3081\u306e\u6e96\u5099\n\n```\ngcloud config set container/cluster test-cluster001\n```\n\n```\ngcloud container clusters get-credentials --zone asia-northeast1-a test-cluster001 \n```\n\n\u30c7\u30e2\u7528\u30ea\u30dd\u30b8\u30c8\u30ea\u3092github\u304b\u3089\u53d6\u5f97\u3057\u307e\u3059\u3002\n\n```\ngit clone https://github.com/kubernetes/contrib.git\n```\n\n```\ncd contrib/micro-demos/pv-provisioning\n```\n\nnamespaes\u306e\u4f5c\u6210\n\n```\nhirutaMacBook-Air:pv-provisioning hiruta$ kubectl create namespace demos\nnamespace \"demos\" created\n```\n\nProvision Disk\u306e\u4f5c\u6210\n\n```\nhirutaMacBook-Air:pv-provisioning hiruta$ kubectl --namespace=demos create -f claim.yaml\npersistentvolumeclaim \"pv-provisioning-demo\" created\n```\n\n```\nhirutaMacBook-Air:pv-provisioning hiruta$ kubectl --namespace=demos describe pvc pv-provisioning-demo\nName:\t\tpv-provisioning-demo\nNamespace:\tdemos\nStatus:\t\tBound\nVolume:\t\tpvc-e4c49d86-c8cd-11e6-a74a-42010a920012\nLabels:\t\tdemo=pv-provisioning\nCapacity:\t10Gi\nAccess Modes:\tRWO\nNo events.\n```\n\n10GiB\u306epersistent disk\u304c\u4f5c\u6210\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u304c\u308f\u304b\u308a\u307e\u3059\u3002\n\u5b9f\u306f\u30018GiB\u3068\u304b\u3067\u3082\u30b3\u30de\u30f3\u30c9\u4e0a\u306f\u4f5c\u6210\u3067\u304d\u3066\u3057\u307e\u3044\u307e\u3059\u3002Web UI\u304b\u3089\u306f\u4f5c\u6210\u306f\u3067\u304d\u307e\u305b\u3093\u3002\n\n```\nhirutaMacBook-Air:pv-provisioning hiruta$ gcloud compute disks list\nNAME                                                             ZONE               SIZE_GB  TYPE         STATUS\ngke-test-cluster001-38-pvc-e4c49d86-c8cd-11e6-a74a-42010a920012  asia-northeast1-a  10       pd-standard  READY\ngke-test-cluster001-default-pool-99aa09bf-7kdr                   asia-northeast1-a  100      pd-standard  READY\ngke-test-cluster001-default-pool-99aa09bf-cnhz                   asia-northeast1-a  100      pd-standard  READY\n```\n\nPod\u306eProvisioning\n\n```\nhirutaMacBook-Air:pv-provisioning hiruta$ kubectl --namespace=demos describe pods -l demo=pv-provisioning\nName:\t\tpv-provisioning-demo-ut26m\nNamespace:\tdemos\nNode:\t\tgke-test-cluster001-default-pool-99aa09bf-7kdr/10.146.0.2\nStart Time:\tFri, 23 Dec 2016 14:12:21 +0900\nLabels:\t\tdemo=pv-provisioning\nStatus:\t\tPending\nIP:\nControllers:\t<none>\nContainers:\n  busybox:\n    Container ID:\n    Image:\t\tbusybox\n    Image ID:\n    Port:\n    Command:\n      sh\n      -c\n      touch /pv/`hostname`; while true; do sleep 3600; done\n    State:\t\tWaiting\n      Reason:\t\tContainerCreating\n    Ready:\t\tFalse\n    Restart Count:\t0\n    Volume Mounts:\n      /pv from pv (rw)\n      /var/run/secrets/kubernetes.io/serviceaccount from default-token-2ehyr (ro)\n    Environment Variables:\t<none>\nConditions:\n  Type\t\tStatus\n  Initialized \tTrue\n  Ready \tFalse\n  PodScheduled \tTrue\nVolumes:\n  pv:\n    Type:\tPersistentVolumeClaim (a reference to a PersistentVolumeClaim in the same namespace)\n    ClaimName:\tpv-provisioning-demo\n    ReadOnly:\tfalse\n  default-token-2ehyr:\n    Type:\tSecret (a volume populated by a Secret)\n    SecretName:\tdefault-token-2ehyr\nQoS Class:\tBestEffort\nTolerations:\t<none>\nEvents:\n  FirstSeen\tLastSeen\tCount\tFrom\t\t\tSubobjectPath\tType\t\tReason\t\tMessage\n  ---------\t--------\t-----\t----\t\t\t-------------\t--------\t------\t\t-------\n  40s\t\t40s\t\t1\t{default-scheduler }\t\t\tNormal\t\tScheduled\tSuccessfully assigned pv-provisioning-demo-ut26m to gke-test-cluster001-default-pool-99aa09bf-7kdr\n```\n\n/pv\u306b\u30de\u30a6\u30f3\u30c8\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u304c\u308f\u304b\u308a\u307e\u3059\u3002\n\n```\nhirutaMacBook-Air:pv-provisioning hiruta$ kubectl --namespace=demos exec --tty -i pv-provisioning-demo-ut26m sh\n/ # df\nFilesystem           1K-blocks      Used Available Use% Mounted on\noverlay               98819296   2434024  96368888   2% /\ntmpfs                   869948         0    869948   0% /dev\ntmpfs                   869948         0    869948   0% /sys/fs/cgroup\n/dev/sdb              10190100     36888   9612540   0% /pv\n/dev/sda1             98819296   2434024  96368888   2% /dev/termination-log\ntmpfs                   869948        12    869936   0% /var/run/secrets/kubernetes.io/serviceaccount\n/dev/sda1             98819296   2434024  96368888   2% /etc/resolv.conf\n/dev/sda1             98819296   2434024  96368888   2% /etc/hostname\n/dev/sda1             98819296   2434024  96368888   2% /etc/hosts\nshm                      65536         0     65536   0% /dev/shm\ntmpfs                   869948         0    869948   0% /proc/kcore\ntmpfs                   869948         0    869948   0% /proc/timer_stats\n```\n\nPod\u306e\u524a\u9664\n\n```\nhirutaMacBook-Air:pv-provisioning hiruta$ kubectl --namespace=demos delete pods -l demo=pv-provisioning\npod \"pv-provisioning-demo-ut26m\" deleted\n```\n\n```\nhirutaMacBook-Air:pv-provisioning hiruta$ kubectl --namespace=demos describe pvc pv-provisioning-demo\nName:\t\tpv-provisioning-demo\nNamespace:\tdemos\nStatus:\t\tBound\nVolume:\t\tpvc-e4c49d86-c8cd-11e6-a74a-42010a920012\nLabels:\t\tdemo=pv-provisioning\nCapacity:\t10Gi\nAccess Modes:\tRWO\nNo events.\n```\n\npersistent disk\t\u306e\u524a\u9664\n\n```\nhirutaMacBook-Air:pv-provisioning hiruta$ kubectl --namespace=demos delete pvc -l demo=pv-provisioning\npersistentvolumeclaim \"pv-provisioning-demo\" deleted\n```\n", "tags": ["GoogleCloudPlatform"]}