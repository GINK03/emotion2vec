{"context": "\u7279\u306b\u76ee\u7684\u306f\u3042\u308a\u307e\u305b\u3093\u304c\u3001\u5e38\u7528\u3057\u3066\u3044\u308b unicorn+nginx \u3068\u9055\u3046\u74b0\u5883\u304c\u6b32\u3057\u304b\u3063\u305f\u306e\u3067apache2+passenger\u3067\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u3066\u307f\u307e\u3057\u305f\u3002\n\n\u524d\u63d0\u6761\u4ef6\nOS\uff1aRaspbian GNU/Linux 8 (jessie)\nMW:apache2\u3001mysql-server\u3001ruby\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u6e08\u307f\u3002\n\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\uff1a/usr/local/redmine3\n\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u30bd\u30fc\u30b9\uff1aSVN\u30ea\u30dd\u30b8\u30c8\u30ea\n\nruby\u6700\u65b0\u5316\u3001\u30d1\u30c3\u30b1\u30fc\u30b8\u8ffd\u52a0\npi\u30e6\u30fc\u30b6\u3067\u4f5c\u696d\nsudo gem update --system\nsudo gem install rdoc --no-rdoc --no-ri\nsudo gem install bundler --no-rdoc --no-ri\n\nsudo apt-get install \\\n ruby-dev                 \\\n libapache2-mod-passenger \\\n libmysqlclient-dev       \\\n imagemagick              \\\n libmagickcore-dev        \\\n libmagickwand-dev        \\\n apache2-dev              \\\n libcurl4-openssl-dev     \\\n libapr1-dev              \\\n libaprutil1-dev\n\n\nDB\u8a2d\u5b9a\nmysql -u root -p\n\nDB\u4f5c\u6210\ncreate database db_redmine default character set utf8;\ngrant all on db_redmine.* to user_redmine@localhost identified by 'Password';\ngrant all on db_redmine.* to user_redmine@'%' identified by 'Password';\nflush privileges;\nexit;\n\n\n\nRedmine3.3\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\nsudo mkdir -p /usr/local/redmine3\nsudo chown www-data:www-data /usr/local/redmine3/\nsudo su - www-data -s /bin/bash\n\n\u4ee5\u4e0b\u3001www-data\u30e6\u30fc\u30b6\u3067\u4f5c\u696d\ncd /usr/local/\nsvn co http://svn.redmine.org/redmine/branches/3.3-stable/ redmine3/\nmkdir -p /usr/local/redmine3/public/plugin_assets\n\n\nDB\u8a2d\u5b9a\n\n/usr/local/redmine3/config/database.yml\nproduction:\n  adapter: mysql2\n  database: db_redmine\n  host: localhost\n  username: user_redmine\n  password: Password\n  encoding: utf8\n\n\n\nSMTP&\u30af\u30c3\u30ad\u30fc\u8a2d\u5b9a\n\n/usr/local/redmine3/config/configuration.yml\nproduction:\n  email_delivery:\n    delivery_method: :smtp\n    smtp_settings:\n      address: \"XXX.XXX.XXX\"\n      port: 25\n      domain: 'yyy.yyy.jp'\n\nautologin_cookie_path: Redmine::Utils.relative_url_root\n\n\n\nGem\u306e\u8ffd\u52a0\ncd /usr/local/redmine3\nexport PKG_CONFIG_PATH=/usr/lib/pkgconfig\nbundle install --path vendor/bundle --without development test\n\n\n\u521d\u671fDB\u4f5c\u6210\ncd /usr/local/redmine3\nbundle exec rake generate_secret_token\nRAILS_ENV=production bundle exec rake db:migrate\n\n\n\u30ed\u30b0\u30ed\u30fc\u30c6\u30fc\u30c8\u306e\u8a2d\u5b9a\n\u3053\u3053\u306froot\u3067\u3002\n\n/etc/logrotate.d/redmine\n/usr/local/redmine3/log/production.log {\n    daily\n    rotate 5\n    copytruncate\n    compress\n    notifempty\n    missingok\n}\n\n\n\nWeb\u30b5\u30fc\u30d0\u8a2d\u5b9a\n\nPassenger\u306e\u30d3\u30eb\u30c9\npi\u30e6\u30fc\u30b6\u306b\u623b\u308a\u307e\u3059\u3002\nsudo gem install passenger --no-rdoc --no-ri\nsudo passenger-install-apache2-module\n\n\u30d3\u30eb\u30c9\u304c\u6210\u529f\u3059\u308b\u3068\u3001\u3053\u3093\u306a\u30e1\u30c3\u30bb\u30fc\u30b8\u304c\u8868\u793a\u3055\u308c\u307e\u3059\u3002\nThe Apache 2 module was successfully installed.\n\nPlease edit your Apache configuration file, and add these lines:\n\nLoadModule passenger_module /var/lib/gems/2.1.0/gems/passenger-5.0.30/buildout/apache2/mod_passenger.so\n   \n     PassengerRoot /var/lib/gems/2.1.0/gems/passenger-5.0.30\n     PassengerDefaultRuby /usr/bin/ruby2.1\n   \n\nAfter you restart Apache, you are ready to deploy any number of Ruby on Rails\napplications on Apache, without any further Ruby on Rails-specific\nconfiguration!\n\nPress ENTER to continue.\n\n\u30d3\u30eb\u30c9\u3057\u305f\u30e2\u30b8\u30e5\u30fc\u30eb\u306e\u30d1\u30b9\u3092\u30c7\u30d5\u30a9\u30eb\u30c8\u5024\u3068\u5dee\u3057\u66ff\u3048\u307e\u3059\u3002\n\n/etc/apache2/mods-enabled/passenger.load\nLoadModule passenger_module /var/lib/gems/2.1.0/gems/passenger-5.0.30/buildout/apache2/mod_passenger.so\n\n\n\napache\u306e\u8a2d\u5b9a\u5909\u66f4\n\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u30eb\u30fc\u30c8\u914d\u4e0b\u306b\u30b7\u30f3\u30dc\u30ea\u30c3\u30af\u30ea\u30f3\u30af\u3092\u7f6e\u304f\u65b9\u5f0f\u306b\u3057\u307e\u3057\u305f\u3002\nsudo ln -s /usr/local/redmine3/public /var/www/html/redmine3\n\n\u30d3\u30eb\u30c9\u7d50\u679c\u304b\u3089\u30b3\u30d4\u30da\u3057\u3066\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\n/etc/apache2/sites-enabled/redmine.conf\n<IfModule mod_passenger.c>\n  PassengerRoot /var/lib/gems/2.1.0/gems/passenger-5.0.30\n  PassengerDefaultRuby /usr/bin/ruby2.1\n</IfModule>\n\nPassengerMaxPoolSize 20\nPassengerMaxInstancesPerApp 4\nPassengerPoolIdleTime 3600\nPassengerHighPerformance on\nPassengerStatThrottleRate 10\nRailsSpawnMethod smart\nRailsAppSpawnerIdleTime 86400\nPassengerMaxPreloaderIdleTime 0\n\nRackBaseURI /redmine3\n\n\n\n\u8d77\u52d5\nsudo systemctl enable apache2\nsudo systemctl start apache2\n\nhttp://[\u30e9\u30ba\u30d1\u30a4\u306eIP]/redmine3/ \u306b\u30a2\u30af\u30bb\u30b9\u3057\u3066\u5f8c\u306f\u666e\u6bb5\u901a\u308a\u306b\u8a2d\u5b9a\u3002\nRuby version\u306e\u90e8\u5206\u3067\u304b\u3059\u304b\u306b\u30e9\u30ba\u30d1\u30a4\u3068\u308f\u304b\u308b\u7a0b\u5ea6\u3067\u3059\u306d\u3002\n\n\u7279\u306b\u76ee\u7684\u306f\u3042\u308a\u307e\u305b\u3093\u304c\u3001\u5e38\u7528\u3057\u3066\u3044\u308b unicorn+nginx \u3068\u9055\u3046\u74b0\u5883\u304c\u6b32\u3057\u304b\u3063\u305f\u306e\u3067apache2+passenger\u3067\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u3066\u307f\u307e\u3057\u305f\u3002\n\n# \u524d\u63d0\u6761\u4ef6\nOS\uff1aRaspbian GNU/Linux 8 (jessie)\nMW:apache2\u3001mysql-server\u3001ruby\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u6e08\u307f\u3002\n\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\uff1a/usr/local/redmine3\n\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u30bd\u30fc\u30b9\uff1aSVN\u30ea\u30dd\u30b8\u30c8\u30ea\n\n\n# ruby\u6700\u65b0\u5316\u3001\u30d1\u30c3\u30b1\u30fc\u30b8\u8ffd\u52a0\npi\u30e6\u30fc\u30b6\u3067\u4f5c\u696d\n<pre>\nsudo gem update --system\nsudo gem install rdoc --no-rdoc --no-ri\nsudo gem install bundler --no-rdoc --no-ri\n</pre>\n<pre>\nsudo apt-get install \\\n ruby-dev                 \\\n libapache2-mod-passenger \\\n libmysqlclient-dev       \\\n imagemagick              \\\n libmagickcore-dev        \\\n libmagickwand-dev        \\\n apache2-dev              \\\n libcurl4-openssl-dev     \\\n libapr1-dev              \\\n libaprutil1-dev\n</pre>\n\n# DB\u8a2d\u5b9a\n<pre>\nmysql -u root -p\n</pre>\nDB\u4f5c\u6210\n<pre>\ncreate database db_redmine default character set utf8;\ngrant all on db_redmine.* to user_redmine@localhost identified by 'Password';\ngrant all on db_redmine.* to user_redmine@'%' identified by 'Password';\nflush privileges;\nexit;\n\n</pre>\n# Redmine3.3\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n<pre>\nsudo mkdir -p /usr/local/redmine3\nsudo chown www-data:www-data /usr/local/redmine3/\nsudo su - www-data -s /bin/bash\n</pre>\n\u4ee5\u4e0b\u3001www-data\u30e6\u30fc\u30b6\u3067\u4f5c\u696d\n<pre>\ncd /usr/local/\nsvn co http://svn.redmine.org/redmine/branches/3.3-stable/ redmine3/\nmkdir -p /usr/local/redmine3/public/plugin_assets\n</pre>\n\n## DB\u8a2d\u5b9a\n```text:/usr/local/redmine3/config/database.yml\nproduction:\n  adapter: mysql2\n  database: db_redmine\n  host: localhost\n  username: user_redmine\n  password: Password\n  encoding: utf8\n```\n## SMTP&\u30af\u30c3\u30ad\u30fc\u8a2d\u5b9a\n```text:/usr/local/redmine3/config/configuration.yml\nproduction:\n  email_delivery:\n    delivery_method: :smtp\n    smtp_settings:\n      address: \"XXX.XXX.XXX\"\n      port: 25\n      domain: 'yyy.yyy.jp'\n\nautologin_cookie_path: Redmine::Utils.relative_url_root\n```\n\n## Gem\u306e\u8ffd\u52a0\n<pre>\ncd /usr/local/redmine3\nexport PKG_CONFIG_PATH=/usr/lib/pkgconfig\nbundle install --path vendor/bundle --without development test\n</pre>\n\n## \u521d\u671fDB\u4f5c\u6210\n<pre>\ncd /usr/local/redmine3\nbundle exec rake generate_secret_token\nRAILS_ENV=production bundle exec rake db:migrate\n</pre>\n\n## \u30ed\u30b0\u30ed\u30fc\u30c6\u30fc\u30c8\u306e\u8a2d\u5b9a\n\u3053\u3053\u306froot\u3067\u3002\n\n```text:/etc/logrotate.d/redmine\n/usr/local/redmine3/log/production.log {\n    daily\n    rotate 5\n    copytruncate\n    compress\n    notifempty\n    missingok\n}\n```\n\n# Web\u30b5\u30fc\u30d0\u8a2d\u5b9a\n## Passenger\u306e\u30d3\u30eb\u30c9\npi\u30e6\u30fc\u30b6\u306b\u623b\u308a\u307e\u3059\u3002\n\n<pre>\nsudo gem install passenger --no-rdoc --no-ri\nsudo passenger-install-apache2-module\n</pre>\n\u30d3\u30eb\u30c9\u304c\u6210\u529f\u3059\u308b\u3068\u3001\u3053\u3093\u306a\u30e1\u30c3\u30bb\u30fc\u30b8\u304c\u8868\u793a\u3055\u308c\u307e\u3059\u3002\n<pre>\nThe Apache 2 module was successfully installed.\n\nPlease edit your Apache configuration file, and add these lines:\n\n   LoadModule passenger_module /var/lib/gems/2.1.0/gems/passenger-5.0.30/buildout/apache2/mod_passenger.so\n   <IfModule mod_passenger.c>\n     PassengerRoot /var/lib/gems/2.1.0/gems/passenger-5.0.30\n     PassengerDefaultRuby /usr/bin/ruby2.1\n   </IfModule>\n\nAfter you restart Apache, you are ready to deploy any number of Ruby on Rails\napplications on Apache, without any further Ruby on Rails-specific\nconfiguration!\n\nPress ENTER to continue.\n</pre>\n\n\u30d3\u30eb\u30c9\u3057\u305f\u30e2\u30b8\u30e5\u30fc\u30eb\u306e\u30d1\u30b9\u3092\u30c7\u30d5\u30a9\u30eb\u30c8\u5024\u3068\u5dee\u3057\u66ff\u3048\u307e\u3059\u3002\n\n```text:/etc/apache2/mods-enabled/passenger.load\nLoadModule passenger_module /var/lib/gems/2.1.0/gems/passenger-5.0.30/buildout/apache2/mod_passenger.so\n```\n\n## apache\u306e\u8a2d\u5b9a\u5909\u66f4\n\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u30eb\u30fc\u30c8\u914d\u4e0b\u306b\u30b7\u30f3\u30dc\u30ea\u30c3\u30af\u30ea\u30f3\u30af\u3092\u7f6e\u304f\u65b9\u5f0f\u306b\u3057\u307e\u3057\u305f\u3002\n<pre>\nsudo ln -s /usr/local/redmine3/public /var/www/html/redmine3\n</pre>\n\n\u30d3\u30eb\u30c9\u7d50\u679c\u304b\u3089\u30b3\u30d4\u30da\u3057\u3066\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\n```text:/etc/apache2/sites-enabled/redmine.conf\n<IfModule mod_passenger.c>\n  PassengerRoot /var/lib/gems/2.1.0/gems/passenger-5.0.30\n  PassengerDefaultRuby /usr/bin/ruby2.1\n</IfModule>\n\nPassengerMaxPoolSize 20\nPassengerMaxInstancesPerApp 4\nPassengerPoolIdleTime 3600\nPassengerHighPerformance on\nPassengerStatThrottleRate 10\nRailsSpawnMethod smart\nRailsAppSpawnerIdleTime 86400\nPassengerMaxPreloaderIdleTime 0\n\nRackBaseURI /redmine3\n```\n\n# \u8d77\u52d5\n<pre>\nsudo systemctl enable apache2\nsudo systemctl start apache2\n</pre>\n\nhttp://[\u30e9\u30ba\u30d1\u30a4\u306eIP]/redmine3/ \u306b\u30a2\u30af\u30bb\u30b9\u3057\u3066\u5f8c\u306f\u666e\u6bb5\u901a\u308a\u306b\u8a2d\u5b9a\u3002\nRuby version\u306e\u90e8\u5206\u3067\u304b\u3059\u304b\u306b\u30e9\u30ba\u30d1\u30a4\u3068\u308f\u304b\u308b\u7a0b\u5ea6\u3067\u3059\u306d\u3002\n![redmine3.3_raspi3.png](https://qiita-image-store.s3.amazonaws.com/0/63464/704ef4f8-0ef3-ed06-4a6b-d6f4af0deed0.png)\n\n\n", "tags": ["RaspberryPi", "Redmine"]}