{"context": "\u30e1\u30e2\u3002\n\u53c2\u8003\u306b\u3057\u305f\u52d5\u753b\uff1aA Simple REST API with Express, RethinkDB, and Thinky\n\n\u4e0b\u6e96\u5099\n\n\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\nthinky\u3092require\u3059\u308b\u6642\u306b\u3001\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\u60c5\u5831\u3092\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3067\u6e21\u3057\u3066\u5b9f\u884c\u3059\u308b\u3002\nconst thinky = require('thinky')({\n  host: 'localhost',\n  port: 28015,\n  db: 'People'\n})\n\n\nRethinkDB\u30c9\u30e9\u30a4\u30d0\u3078\u306e\u53c2\u7167\nthinky\u306b\u306frethinkDB\u3078\u306e\u53c2\u7167\u304c\u7d10\u4ed8\u3044\u3066\u3044\u308b\u306e\u3067\u3001\u5909\u6570\u683c\u7d0d\u3057\u3066\u304a\u304f\u3002\nconst r = thinky.r\n\n\n\u30e2\u30c7\u30eb\u306e\u4f5c\u6210\nthinky.createModel('TableName', {schema})\nconst People = thinky.createModel('People', {\n  firstName: String,\n  lastName: String,\n  coolnessFactor: Number,\n  date: { _type: Date, default: r.now() }\n})\n\nthinky/#createmodel\n\n\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u4f5c\u6210\ndate\u30ab\u30e9\u30e0\u304c\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u306b\u9069\u3057\u3066\u3044\u308b\u304b\u3069\u3046\u304b\u306f\u3055\u3066\u304a\u304d\u2026\nPeople.ensureIndex('date')\n\nmodel/#ensureindex\n\nREST API\n\nget\nconst get = function (req, res) {\n  People.get(req.params.id).run().then((person) => {\n    res.json(person)\n  }).error((err) => {\n    res.json({ message: err })\n  })\n}\n\n\ngetAll\nconst getAll = function (req, res) {\n  People.orderBy({ index: r.desc('date') }).run().then((people) => {\n    res.json(people)\n  }).error((err) => {\n    res.json({ message: err })\n  })\n}\n\n\nadd\nconst add = function (req, res) {\n  var person = new People(req.body)\n  person.save().then((result) => {\n    res.json(result)\n  }).error((err) => {\n    res.json({ message: err })\n  })\n}\n\n\ndelete\nconst delete = function (req, res) {\n  People.get(req.params.id).run().then((person) => {\n    person.delete().then((result) => {\n      res.json(result)\n    }).error((err) => {\n      res.json({ message: err })\n    })\n  }).error((err) => {\n    res.json({ message: err })\n  })\n}\n\n\nupdate\nconst update = function (req, res) {\n  People.get(req.params.id).run().then((person) => {\n    if(req.body.firstName) {\n      person.firstName = req.body.firstName\n    }\n\n    if(req.body.lastName) {\n      person.lastName = req.body.lastName\n    }\n\n    if(req.body.coolnessFactor) {\n      person.coolnessFactor = parseInt(req.body.coolnessFactor)\n    }\n    person.data = r.now()\n\n    person.save().then((result) => {\n      res.json(result)\n    }).error((err) => {\n      res.json({ message: err})\n    })\n  })\n}\n\n\u3042\u3068\u306f\u3001express\u306a\u308a\u306a\u3093\u306a\u308a\u3067route\u3057\u3066\u3042\u3052\u308c\u3070\u52d5\u304d\u307e\u3059\u3002\n\u30e1\u30e2\u3002\n\u53c2\u8003\u306b\u3057\u305f\u52d5\u753b\uff1a[A Simple REST API with Express, RethinkDB, and Thinky](https://www.youtube.com/watch?v=d01rLeIjTLE)\n\n## \u4e0b\u6e96\u5099\n\n### \u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\n\nthinky\u3092require\u3059\u308b\u6642\u306b\u3001\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\u60c5\u5831\u3092\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3067\u6e21\u3057\u3066\u5b9f\u884c\u3059\u308b\u3002\n\n```js\nconst thinky = require('thinky')({\n  host: 'localhost',\n  port: 28015,\n  db: 'People'\n})\n```\n\n### RethinkDB\u30c9\u30e9\u30a4\u30d0\u3078\u306e\u53c2\u7167\n\nthinky\u306b\u306frethinkDB\u3078\u306e\u53c2\u7167\u304c\u7d10\u4ed8\u3044\u3066\u3044\u308b\u306e\u3067\u3001\u5909\u6570\u683c\u7d0d\u3057\u3066\u304a\u304f\u3002\n\n```js\nconst r = thinky.r\n```\n\n### \u30e2\u30c7\u30eb\u306e\u4f5c\u6210\n\nthinky.createModel('TableName', {schema})\n\n```js\nconst People = thinky.createModel('People', {\n  firstName: String,\n  lastName: String,\n  coolnessFactor: Number,\n  date: { _type: Date, default: r.now() }\n})\n```\n\n[thinky/#createmodel](https://thinky.io/documentation/api/thinky/#createmodel)\n\n### \u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u4f5c\u6210\n\ndate\u30ab\u30e9\u30e0\u304c\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u306b\u9069\u3057\u3066\u3044\u308b\u304b\u3069\u3046\u304b\u306f\u3055\u3066\u304a\u304d\u2026\n\n```js\nPeople.ensureIndex('date')\n```\n\n[model/#ensureindex](https://thinky.io/documentation/api/model/#ensureindex)\n\n## REST API\n\n### get\n\n```js\nconst get = function (req, res) {\n  People.get(req.params.id).run().then((person) => {\n    res.json(person)\n  }).error((err) => {\n    res.json({ message: err })\n  })\n}\n```\n\n### getAll \n\n```js\nconst getAll = function (req, res) {\n  People.orderBy({ index: r.desc('date') }).run().then((people) => {\n    res.json(people)\n  }).error((err) => {\n    res.json({ message: err })\n  })\n}\n```\n\n### add \n\n```js\nconst add = function (req, res) {\n  var person = new People(req.body)\n  person.save().then((result) => {\n    res.json(result)\n  }).error((err) => {\n    res.json({ message: err })\n  })\n}\n```\n\n### delete\n\n```js\nconst delete = function (req, res) {\n  People.get(req.params.id).run().then((person) => {\n    person.delete().then((result) => {\n      res.json(result)\n    }).error((err) => {\n      res.json({ message: err })\n    })\n  }).error((err) => {\n    res.json({ message: err })\n  })\n}\n```\n\n### update\n\n```js\nconst update = function (req, res) {\n  People.get(req.params.id).run().then((person) => {\n    if(req.body.firstName) {\n      person.firstName = req.body.firstName\n    }\n  \n    if(req.body.lastName) {\n      person.lastName = req.body.lastName\n    }\n    \n    if(req.body.coolnessFactor) {\n      person.coolnessFactor = parseInt(req.body.coolnessFactor)\n    }\n    person.data = r.now()\n    \n    person.save().then((result) => {\n      res.json(result)\n    }).error((err) => {\n      res.json({ message: err})\n    })\n  })\n}\n```\n\n\u3042\u3068\u306f\u3001express\u306a\u308a\u306a\u3093\u306a\u308a\u3067route\u3057\u3066\u3042\u3052\u308c\u3070\u52d5\u304d\u307e\u3059\u3002\n", "tags": ["Thinky", "RethinkDB", "REST-API"]}