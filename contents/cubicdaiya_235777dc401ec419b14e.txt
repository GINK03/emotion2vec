{"context": "(\u8ffd\u8a18:\u30bf\u30a4\u30c8\u30eb\u304c\u5c11\u3005\u717d\u308a\u6c17\u5473\u306a\u6c17\u304c\u3057\u305f\u306e\u3067\u5fae\u5999\u306b\u5909\u66f4\u3057\u307e\u3057\u305f\u3002)\n\nh2o\u3068nginx\u306e\u6027\u80fd\u6bd4\u8f03\nnginx\u3088\u308a\u3082\u901f\u3044\u3068\u3055\u308c\u308bh2o\u3067\u3059\u304c\u3001\u5b9f\u969b\u306b\u81ea\u5206\u3067\u3082\u30ed\u30fc\u30ab\u30eb\u3067\u30d9\u30f3\u30c1\u30de\u30fc\u30af\u3092\u53d6\u3063\u3066\u307f\u307e\u3057\u305f\u3002\u74b0\u5883\u306f\u4ee5\u4e0b\u306e\u901a\u308a\u3067\u3059\u3002\n\nEC2\u306ec4.8xlarge\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\ngcc (GCC) 4.8.2 20140120 (Red Hat 4.8.2-16)\nLinux ip-172-31-13-40 3.14.35-28.38.amzn1.x86_64 #1 SMP Wed Mar 11 22:50:37 UTC 2015 x86_64 x86_64 x86_64 GNU/Linux\nnginx-1.8.0\nh2o-1.2.1-alpha1\n\nwrk(\u30d9\u30f3\u30c1\u30de\u30fc\u30af)\n\n\n\u30d9\u30f3\u30c1\u30de\u30fc\u30af\u30b3\u30de\u30f3\u30c9\n\u5b9f\u884c\u3059\u308b\u30d9\u30f3\u30c1\u30de\u30fc\u30af\u30b3\u30de\u30f3\u30c9\u306f\u4ee5\u4e0b\u306b\u306a\u308a\u307e\u3059\u3002\u306a\u304a\u3001\u30aa\u30d7\u30b7\u30e7\u30f3\u306f\u3067\u304d\u308b\u3060\u3051Request/sec\u304c\u5927\u304d\u304f\u306a\u308b\u3088\u3046\u306b\u8abf\u6574\u3057\u3066\u3044\u307e\u3059\u3002\n./wrk -c 100 -t 10 -d 10 http://127.0.0.1/\n\n\n\u30b5\u30fc\u30d0\u304c\u8fd4\u3059\u30ec\u30b9\u30dd\u30f3\u30b9\n\u30b5\u30fc\u30d0\u304c\u8fd4\u3059\u30ec\u30b9\u30dd\u30f3\u30b9\u306fnginx\u306b\u4ed8\u5c5e\u3057\u3066\u3044\u308bindex.html\u3067\u3059\u3002\u30b5\u30a4\u30ba\u306f612\u30d0\u30a4\u30c8\u3067\u3059\u3002\n\nindex.html\n$ cat /usr/local/nginx/html/index.html \n<!DOCTYPE html>\n<html>\n<head>\n<title>Welcome to nginx!</title>\n<style>\n    body {\n        width: 35em;\n        margin: 0 auto;\n        font-family: Tahoma, Verdana, Arial, sans-serif;\n    }\n</style>\n</head>\n<body>\n<h1>Welcome to nginx!</h1>\n<p>If you see this page, the nginx web server is successfully installed and\nworking. Further configuration is required.</p>\n\n<p>For online documentation and support please refer to\n<a href=\"http://nginx.org/\">nginx.org</a>.<br/>\nCommercial support is available at\n<a href=\"http://nginx.com/\">nginx.com</a>.</p>\n\n<p><em>Thank you for using nginx.</em></p>\n</body>\n</html>\n$\n\n\n\nsysctl.conf\n\u307e\u305f\u3001\u3042\u3089\u304b\u3058\u3081\u4e0b\u8a18\u306e\u30d1\u30e9\u30e1\u30fc\u30bf\u3092\u8ffd\u52a0\u3057\u3066\u30ab\u30fc\u30cd\u30eb\u30d1\u30e9\u30e1\u30fc\u30bf\u306e\u30c1\u30e5\u30fc\u30cb\u30f3\u30b0\u3092\u3057\u3066\u304a\u304d\u307e\u3059\u3002(\u5225\u306b\u3044\u3089\u3093\u304b\u3063\u305f\u304b\u3082)\n\nsysctl.conf\nnet.core.somaxconn=32768\nnet.core.netdev_max_backlog=32768\nnet.ipv4.tcp_max_syn_backlog=32768\nnet.ipv4.tcp_tw_recycle=1\nnet.ipv4.tcp_tw_reuse=1\nnet.ipv4.tcp_fin_timeout=10\nnet.core.rmem_max  = 16777216\nnet.core.wmem_max  = 16777216\nnet.ipv4.tcp_rmem  = 4096 349520 16777216\nnet.ipv4.tcp_wmem  = 4096 65536 16777216\nnet.ipv4.ip_local_port_range= 1024 65535\nnet.ipv4.tcp_timestamps = 0\n\n\n\nh2o\n\u3067\u306f\u307e\u305ah2o\u306e\u30d9\u30f3\u30c1\u30de\u30fc\u30af\u304b\u3089\u306f\u3058\u3081\u307e\u3059\u3002\n\nh2o.conf(\u521d\u671f\u72b6\u614b)\nh2o\u306e\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb(\u521d\u671f\u72b6\u614b)\u3092\u3053\u3093\u306a\u611f\u3058\u3067\u5b9a\u7fa9\u3057\u307e\u3059\u3002\n\nh2o.conf\nlisten: 80\nhosts:\n  \"127.0.0.1:80\":\n    paths:\n      /:\n        file.dir: /usr/local/nginx/html\n\n\n\n\u30d9\u30f3\u30c1\u30de\u30fc\u30af(\u521d\u671f\u72b6\u614b)\n\u3053\u308c\u3067\u30d9\u30f3\u30c1\u30de\u30fc\u30af\u3092\u8d70\u3089\u305b\u308b\u3068\u3001\nRunning 10s test @ http://127.0.0.1\n  10 threads and 100 connections\n  Thread Stats   Avg      Stdev     Max   +/- Stdev\n    Latency   265.78us  760.09us  17.04ms   96.66%\n    Req/Sec    59.04k     7.09k  116.13k    71.93%\n  5880641 requests in 10.10s, 4.56GB read\nRequests/sec: 582269.87\nTransfer/sec:    462.01MB\n\n\u79d2\u959358\u4e07\u30ea\u30af\u30a8\u30b9\u30c8\u634c\u3051\u307e\u3057\u305f\u3002\n\n\u30b9\u30ec\u30c3\u30c9\u6570\u3092\u8abf\u6574\u3059\u308b\nh2o\u306f\u30c7\u30d5\u30a9\u30eb\u30c8\u3067CPU\u30b3\u30a2\u6570\u3068\u540c\u3058\u6570\u306e\u30ef\u30fc\u30ab\u30fc\u30b9\u30ec\u30c3\u30c9\u3092\u8d77\u52d5\u3057\u307e\u3059\u3002\n\u3053\u308c\u306f\u3053\u308c\u3067\u3088\u3044\u306e\u3067\u3059\u304c\u3001\u4eca\u56de\u306e\u3088\u3046\u306b\u30ed\u30fc\u30ab\u30eb\u3067\u30d9\u30f3\u30c1\u30de\u30fc\u30af\u3092\u5b9f\u884c\u3059\u308b\u5834\u5408\u3001\nCPU\u30b3\u30a2\u6570\u3068\u540c\u3058\u6570\u306e\u30ef\u30fc\u30ab\u30fc\u30b9\u30ec\u30c3\u30c9\u3092\u8d77\u52d5\u3057\u3066\u3057\u307e\u3046\u3068\u30d9\u30f3\u30c1\u30de\u30fc\u30af\u30d7\u30ed\u30b0\u30e9\u30e0\u3068CPU\u3092\u53d6\u308a\u5408\u3063\u3066\u3057\u307e\u3046\u306e\u3067\u30ef\u30fc\u30ab\u30b9\u30ec\u30c3\u30c9\u306e\u6570\u3092\u5c0f\u3055\u304f\u3057\u3066\u307f\u307e\u3059\u3002(\u3064\u3044\u3067\u306b\u6700\u5927\u30b3\u30cd\u30af\u30b7\u30e7\u30f3\u6570\u3082\u5f15\u304d\u4e0a\u3052\u307e\u3059)\nnum-threads: 16\nnum-name-resolution-threads: 1\nmax-connections: 10240\n\n\u3053\u308c\u3067\u518d\u5ea6\u30d9\u30f3\u30c1\u30de\u30fc\u30af\u3092\u5b9f\u884c\u3059\u308b\u3068\u3001\nRunning 10s test @ http://127.0.0.1\n  10 threads and 100 connections\n  Thread Stats   Avg      Stdev     Max   +/- Stdev\n    Latency   158.90us  302.95us  14.96ms   97.11%\n    Req/Sec    71.36k    10.12k  106.08k    70.63%\n  7153711 requests in 10.10s, 5.54GB read\nRequests/sec: 708328.89\nTransfer/sec:    562.03MB\n\n\u79d2\u959370\u4e07\u30ea\u30af\u30a8\u30b9\u30c8\u3092\u8d8a\u3048\u307e\u3057\u305f\u3002\u306a\u304a\u3001num-threads\u306f\u3053\u308c\u4ee5\u4e0a\u5897\u3084\u3057\u3066\u3082wrk\u3068CPU\u3092\u53d6\u308a\u5408\u3063\u3066\u3057\u307e\u3046\u305b\u3044\u304b\u6027\u80fd\u304c\u4e0a\u304c\u308a\u307e\u305b\u3093\u3067\u3057\u305f\u3002\n\u6700\u7d42\u7684\u306ah2o.conf\u306f\u3053\u3061\u3089\u3002\n\nh2o.conf\nnum-threads: 16\nnum-name-resolution-threads: 1\nmax-connections: 10240\nlisten: 80\nhosts:\n  \"127.0.0.1:80\":\n    paths:\n      /:\n        file.dir: /usr/local/nginx/html\n\n\n\nnginx\n\u3064\u3065\u3044\u3066nginx\u3067\u3059\u3002\n\nnginx.conf(\u521d\u671f\u72b6\u614b)\nnginx.conf\u306e\u521d\u671f\u72b6\u614b\u306f\u4ee5\u4e0b\u306b\u306a\u308a\u307e\u3059\u3002nginx\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u305f\u76f4\u5f8c\u306enginx.conf\u304b\u3089\u30a8\u30e9\u30fc\u7cfb\u306e\u8a2d\u5b9a\u3084\u30b3\u30e1\u30f3\u30c8\u306e\u9664\u53bb\u3001\u30a2\u30af\u30bb\u30b9\u30ed\u30b0\u3092\u30aa\u30d5\u3068\u3044\u3063\u305f\u3053\u3068\u3092\u884c\u3063\u3066\u3044\u307e\u3059\u3002\n\nnginx.conf\nworker_processes  1;\n\nevents {\n    worker_connections  1024;\n}\n\nhttp {\n    include       mime.types;\n    default_type  application/octet-stream;\n\n    access_log off;\n\n    sendfile on;\n\n    keepalive_timeout  65;\n\n    server {\n        listen       80;\n        server_name  localhost;\n        location / {\n            root   html;\n            index  index.html index.htm;\n        }\n    }\n}\n\n\n\n\u30d9\u30f3\u30c1\u30de\u30fc\u30af(\u521d\u671f\u72b6\u614b)\n\u3053\u308c\u3067\u30d9\u30f3\u30c1\u30de\u30fc\u30af\u3092\u8d70\u3089\u305b\u308b\u3068\u3001\nRunning 10s test @ http://127.0.0.1/\n  10 threads and 100 connections\n  Thread Stats   Avg      Stdev     Max   +/- Stdev\n    Latency    45.04ms   58.61ms 206.35ms   78.77%\n    Req/Sec     5.52k     2.77k   10.10k    62.83%\n  535382 requests in 10.02s, 433.46MB read\nRequests/sec:  53433.93\nTransfer/sec:     43.26MB\n\n\u79d2\u95935\u4e07\u30ea\u30af\u30a8\u30b9\u30c8\u3002h2o\u306e\u521d\u671f\u72b6\u614b\u306e10\u5206\u306e1\u7a0b\u5ea6\u3067\u3059\u3002\n\n\u30ef\u30fc\u30ab\u30d7\u30ed\u30bb\u30b9\u6570\u3068\u30b3\u30cd\u30af\u30b7\u30e7\u30f3\u6570\u3092\u4e0a\u3052\u308b\nnginx\u306fh2o\u3068\u9055\u3044\u3001\u30c7\u30d5\u30a9\u30eb\u30c8\u306e\u30ef\u30fc\u30ab\u6570\u304c\u5c0f\u3055\u3044\u306e\u3067\u3053\u308c\u3092\u3055\u304d\u307b\u3069\u306eh2o.conf\u3068\u540c\u3058\u304f16\u306b\u3057\u307e\u3059\u3002(\u307e\u305f\u6700\u5927\u30b3\u30cd\u30af\u30b7\u30e7\u30f3\u6570\u3082\u540c\u3058\u306b\u3057\u307e\u3059)\nworker_processes 16;\nevents {\n    worker_connections 10240;\n}\n\n(\u8ffd\u8a18: h2o\u306emax-connectoins \u2252 nginx\u306eworker_processes * worker_connections\u306a\u306e\u3067\u5b9f\u969b\u306b\u306f\u5dee\u304c\u3042\u308b\u304b\u3082\u3001\u3068\u3044\u3046\u610f\u898b\u3092\u9802\u3044\u305f\u306e\u3067\u5ff5\u306e\u305f\u3081\u8ffd\u8a66\u3057\u3066\u307f\u307e\u3057\u305f\u304c\u3001\u30b3\u30cd\u30af\u30b7\u30e7\u30f3\u6570\u306f\u5909\u3048\u3066\u3082\u30b9\u30b3\u30a2\u306f\u307b\u307c\u540c\u3058\u3067\u3057\u305f\u3002(h2o\u306emax-connections\u309210240\u3001nginx\u306eworker_connections\u30921024 or 640\u306b\u3057\u3066\u5b9f\u65bd))\n\u3053\u308c\u3067\u30d9\u30f3\u30c1\u30de\u30fc\u30af\u3092\u8d70\u3089\u305b\u308b\u3068\u3001\nRunning 10s test @ http://127.0.0.1\n  10 threads and 100 connections\n  Thread Stats   Avg      Stdev     Max   +/- Stdev\n    Latency   827.38us    2.79ms  64.81ms   94.35%\n    Req/Sec    62.79k     8.74k   77.95k    84.26%\n  6308521 requests in 10.10s, 4.99GB read\nRequests/sec: 624638.51\nTransfer/sec:    505.72MB\n\n\u79d2\u959362\u4e07\u30ea\u30af\u30a8\u30b9\u30c8\u3002\u4e00\u6c17\u306b\u4f38\u3073\u307e\u3057\u305f\u3002\n\nopen_file_cache\u3067\u30d5\u30a1\u30a4\u30eb\u60c5\u5831\u3092\u30ad\u30e3\u30c3\u30b7\u30e5\nnginx\u306b\u306f\u4e00\u5ea6\u30aa\u30fc\u30d7\u30f3\u3057\u305f\u30d5\u30a1\u30a4\u30eb\u306e\u30c7\u30a3\u30b9\u30af\u30ea\u30d7\u30bf\u3084\u30b5\u30a4\u30ba\u3001\u66f4\u65b0\u6642\u523b\u3001i-node\u3068\u3044\u3063\u305f\u60c5\u5831\u3092\u30ad\u30e3\u30c3\u30b7\u30e5\u3059\u308b\u305f\u3081\u306eopen_file_cache\u3068\u3044\u3046\u30c7\u30a3\u30ec\u30af\u30c6\u30a3\u30d6\u304c\u3042\u308a\u307e\u3059\u3002\n# max: \u30ad\u30e3\u30c3\u30b7\u30e5\u306e\u6700\u5927\u6570\n# inactive: \u30a2\u30af\u30bb\u30b9\u304c\u306a\u3044\u30ad\u30e3\u30c3\u30b7\u30e5\u306e\u6709\u52b9\u671f\u9650\nopen_file_cache max=100 inactive=20s;\n\n\u3053\u308c\u3092\u8a2d\u5b9a\u3057\u3066\u30d9\u30f3\u30c1\u30de\u30fc\u30af\u3092\u8d70\u3089\u305b\u308b\u3068\u3001\nRunning 10s test @ http://127.0.0.1\n  10 threads and 100 connections\n  Thread Stats   Avg      Stdev     Max   +/- Stdev\n    Latency   761.52us    6.12ms 138.30ms   98.88%\n    Req/Sec    70.55k     8.20k   85.08k    87.69%\n  7073264 requests in 10.10s, 5.59GB read\nRequests/sec: 700324.14\nTransfer/sec:    567.00MB\n\nh2o\u3068\u540c\u3058\u304f\u3089\u3044\u306e\u3068\u3053\u308d\u307e\u3067\u6765\u307e\u3057\u305f\u3002\n\naccept_mutex_delay\naccept_mutex_delay\u306faccept()\u6642\u306emutex\u306e\u78ba\u4fdd\u306b\u5931\u6557\u3057\u305f\u969b\u306e\u5f85\u6a5f\u6642\u9593\u3092\u8abf\u6574\u3059\u308b\u305f\u3081\u306e\u30c7\u30a3\u30ec\u30af\u30c6\u30a3\u30d6\u3067\u3059\u3002\u30c7\u30d5\u30a9\u30eb\u30c8\u3060\u3068500ms\u3067\u3053\u308c\u3060\u3068\u5c11\u3057\u5927\u304d\u3044\u306e\u3067100ms\u306b\u3057\u307e\u3059\u3002\naccept_mutex_delay 100ms;\n\n\u3053\u308c\u3067\u30d9\u30f3\u30c1\u30de\u30fc\u30af\u3092\u8d70\u3089\u305b\u308b\u3068\u3001\nRunning 10s test @ http://127.0.0.1\n  10 threads and 100 connections\n  Thread Stats   Avg      Stdev     Max   +/- Stdev\n    Latency   401.34us    2.83ms  85.56ms   98.64%\n    Req/Sec    72.03k     8.27k  105.77k    86.40%\n  7216133 requests in 10.10s, 5.71GB read\nRequests/sec: 714511.56\nTransfer/sec:    578.48MB\n\nh2o\u3092\u8d8a\u3048\u307e\u3057\u305f\u3002\n\ntcp_nopush\ntcp_nopush\u306fnginx\u304c\u5229\u7528\u3059\u308bTCP\u30bd\u30b1\u30c3\u30c8\u306bTCP_CORK(Linux)\u3001\u3042\u308b\u3044\u306fTCP_NOPSUH(BSD)\u306e\u30aa\u30d7\u30b7\u30e7\u30f3\u3092\u30bb\u30c3\u30c8\u3059\u308b\u30c7\u30a3\u30ec\u30af\u30c6\u30a3\u30d6\u3067\u3059\u3002\u3053\u308c\u3092\u6709\u52b9\u306b\u3057\u305f\u5834\u5408\u3001\u7c21\u5358\u306b\u8a00\u3046\u3068\u30ec\u30b9\u30dd\u30f3\u30b9\u30d8\u30c3\u30c0\u3068\u30d5\u30a1\u30a4\u30eb\u306e\u5185\u5bb9\u3092\u307e\u3068\u3081\u3066\u9001\u308b\u3088\u3046\u306b\u306a\u308b\u306e\u3067\u9001\u4fe1\u3059\u308b\u30d1\u30b1\u30c3\u30c8\u6570\u3092\u6700\u5c0f\u5316\u3067\u304d\u307e\u3059\u3002\ntcp_nopush on;\n\n\u3053\u308c\u3067\u30d9\u30f3\u30c1\u30de\u30fc\u30af\u3092\u8d70\u3089\u305b\u308b\u3068\u3001\nRunning 10s test @ http://127.0.0.1\n  10 threads and 100 connections\n  Thread Stats   Avg      Stdev     Max   +/- Stdev\n    Latency   163.09us    0.99ms  36.45ms   99.12%\n    Req/Sec    82.93k     9.71k  110.85k    69.90%\n  8330029 requests in 10.10s, 6.59GB read\nRequests/sec: 824799.77\nTransfer/sec:    667.78MB\n\n\u79d2\u959382\u4e07\u30ea\u30af\u30a8\u30b9\u30c8\u3002\u3059\u3054\u3044\u3067\u3059\u306d\u3002\u6700\u7d42\u7684\u306anginx.conf\u306f\u4ee5\u4e0b\u306b\u306a\u308a\u307e\u3059\u3002\n\nnginx.conf\nworker_processes 16;\n\nevents {\n    worker_connections  10240;\n    accept_mutex_delay 100ms;\n}\n\nhttp {\n    include       mime.types;\n    default_type  application/octet-stream;\n\n    access_log off;\n\n    sendfile on;\n    open_file_cache max=100 inactive=20s;\n    tcp_nopush on;\n\n    keepalive_timeout  65;\n\n    server {\n        listen       80;\n        server_name  localhost;\n        location / {\n            root   html;\n            index  index.html index.htm;\n        }\n    }\n}\n\n\n\n\u307e\u3068\u3081\nh2o\u3068nginx\u306e\u30d9\u30f3\u30c1\u30de\u30fc\u30af\u3092\u30ed\u30fc\u30ab\u30eb\u3067\u53d6\u3063\u3066\u307f\u307e\u3057\u305f\u3002\u5b9f\u969b\u3084\u3063\u3066\u307f\u305f\u611f\u60f3\u3068\u3057\u3066\u306f\n\nh2o\u306f\u307b\u3068\u3093\u3069\u8a2d\u5b9a\u3057\u306a\u304f\u3066\u3082\u304b\u306a\u308a\u30d1\u30d5\u30a9\u30fc\u30de\u30f3\u30b9\u304c\u51fa\u308b\u3088\u3046\u306b\u306a\u3063\u3066\u308b\nnginx\u3082\u30c1\u30e5\u30fc\u30cb\u30f3\u30b0\u6b21\u7b2c\u3067h2o\u306b\u5339\u6575\u3059\u308b\u30d1\u30d5\u30a9\u30fc\u30de\u30f3\u30b9\u306f\u51fa\u308b\n\n\u3068\u3044\u3063\u305f\u6240\u3067\u3057\u3087\u3046\u304b\uff1f\u4e00\u65b9\u3067\u4eca\u56denginx\u5074\u3067\u6709\u52b9\u306b\u3057\u305fopen_file_cache\u3084tcp_nopush\u76f8\u5f53\u306e\u6a5f\u80fd\u306f\u307e\u3060h2o\u306b\u306f\u5b9f\u88c5\u3055\u308c\u3066\u3044\u307e\u305b\u3093\u3002\u3053\u306e\u4e8c\u3064\u3060\u3051\u3067\u79d2\u959320\u4e07\u304f\u3089\u3044\u9055\u3046\u306e\u3067h2o\u3067\u3082\u3053\u308c\u3089\u304c\u5b9f\u88c5\u3055\u308c\u308b\u3068\u30ac\u30c1\u30ac\u30c1\u306b\u30c1\u30e5\u30fc\u30cb\u30f3\u30b0\u3057\u305fnginx\u3088\u308a\u3082\u901f\u304f\u306a\u308a\u305d\u3046\u3067\u3059\u3002open_file_cache\u306b\u3064\u3044\u3066\u306f\u9032\u884c\u4e2d\u306e\u30d6\u30e9\u30f3\u30c1\u304c\u3042\u308b\u3088\u3046\u3067\u3059\u3002\n\u3068\u3053\u308d\u3067\u3001tcp_nopush\u306f\u672c\u6765tcp_nodelay(nginx\u3067\u306f\u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u6709\u52b9)\u3068\u306f\u53cd\u5bfe\u306e\u52d5\u304d\u3092\u3059\u308b\u306e\u3067\u3059\u304c\u3001nginx\u306f\u3053\u306e\u4e8c\u3064\u3092\u7d44\u307f\u5408\u308f\u305b\u3066\u3082\u3046\u307e\u304f\u52d5\u4f5c\u3059\u308b\u3088\u3046\u306b\u5b9f\u88c5\u3055\u308c\u3066\u3044\u308b\u3088\u3046\u3067\u3059\u3002(NGINX OPTIMIZATION: UNDERSTANDING SENDFILE, TCP_NODELAY AND TCP_NOPUSH)\n\n\u53c2\u8003\n\nnginx documentation\nH2O\nG-WAN\u306f\u306a\u305c\u901f\u3044\u306e\u304b\uff1f\u3092nginx\u3068\u6bd4\u3079\u306a\u304c\u3089\u691c\u8a3c\u3057\u3066\u307f\u305f\nNGINX OPTIMIZATION: UNDERSTANDING SENDFILE, TCP_NODELAY AND TCP_NOPUSH\n\n(\u8ffd\u8a18:\u30bf\u30a4\u30c8\u30eb\u304c\u5c11\u3005\u717d\u308a\u6c17\u5473\u306a\u6c17\u304c\u3057\u305f\u306e\u3067\u5fae\u5999\u306b\u5909\u66f4\u3057\u307e\u3057\u305f\u3002)\n\n# h2o\u3068nginx\u306e\u6027\u80fd\u6bd4\u8f03\n\n[nginx](http://nginx.org/en/docs/)\u3088\u308a\u3082\u901f\u3044\u3068\u3055\u308c\u308b[h2o](http://h2o.github.io/)\u3067\u3059\u304c\u3001\u5b9f\u969b\u306b\u81ea\u5206\u3067\u3082\u30ed\u30fc\u30ab\u30eb\u3067\u30d9\u30f3\u30c1\u30de\u30fc\u30af\u3092\u53d6\u3063\u3066\u307f\u307e\u3057\u305f\u3002\u74b0\u5883\u306f\u4ee5\u4e0b\u306e\u901a\u308a\u3067\u3059\u3002\n\n * EC2\u306e`c4.8xlarge`\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\n * gcc (GCC) 4.8.2 20140120 (Red Hat 4.8.2-16)\n * Linux ip-172-31-13-40 3.14.35-28.38.amzn1.x86_64 #1 SMP Wed Mar 11 22:50:37 UTC 2015 x86_64 x86_64 x86_64 GNU/Linux\n * nginx-1.8.0\n * h2o-1.2.1-alpha1\n * [wrk](https://github.com/wg/wrk)(\u30d9\u30f3\u30c1\u30de\u30fc\u30af)\n\n# \u30d9\u30f3\u30c1\u30de\u30fc\u30af\u30b3\u30de\u30f3\u30c9\n\n\u5b9f\u884c\u3059\u308b\u30d9\u30f3\u30c1\u30de\u30fc\u30af\u30b3\u30de\u30f3\u30c9\u306f\u4ee5\u4e0b\u306b\u306a\u308a\u307e\u3059\u3002\u306a\u304a\u3001\u30aa\u30d7\u30b7\u30e7\u30f3\u306f\u3067\u304d\u308b\u3060\u3051Request/sec\u304c\u5927\u304d\u304f\u306a\u308b\u3088\u3046\u306b\u8abf\u6574\u3057\u3066\u3044\u307e\u3059\u3002\n\n```\n./wrk -c 100 -t 10 -d 10 http://127.0.0.1/\n```\n\n# \u30b5\u30fc\u30d0\u304c\u8fd4\u3059\u30ec\u30b9\u30dd\u30f3\u30b9\n\n\u30b5\u30fc\u30d0\u304c\u8fd4\u3059\u30ec\u30b9\u30dd\u30f3\u30b9\u306fnginx\u306b\u4ed8\u5c5e\u3057\u3066\u3044\u308b`index.html`\u3067\u3059\u3002\u30b5\u30a4\u30ba\u306f612\u30d0\u30a4\u30c8\u3067\u3059\u3002\n\n```html:index.html\n$ cat /usr/local/nginx/html/index.html \n<!DOCTYPE html>\n<html>\n<head>\n<title>Welcome to nginx!</title>\n<style>\n    body {\n        width: 35em;\n        margin: 0 auto;\n        font-family: Tahoma, Verdana, Arial, sans-serif;\n    }\n</style>\n</head>\n<body>\n<h1>Welcome to nginx!</h1>\n<p>If you see this page, the nginx web server is successfully installed and\nworking. Further configuration is required.</p>\n\n<p>For online documentation and support please refer to\n<a href=\"http://nginx.org/\">nginx.org</a>.<br/>\nCommercial support is available at\n<a href=\"http://nginx.com/\">nginx.com</a>.</p>\n\n<p><em>Thank you for using nginx.</em></p>\n</body>\n</html>\n$\n```\n\n## sysctl.conf\n\n\u307e\u305f\u3001\u3042\u3089\u304b\u3058\u3081\u4e0b\u8a18\u306e\u30d1\u30e9\u30e1\u30fc\u30bf\u3092\u8ffd\u52a0\u3057\u3066\u30ab\u30fc\u30cd\u30eb\u30d1\u30e9\u30e1\u30fc\u30bf\u306e\u30c1\u30e5\u30fc\u30cb\u30f3\u30b0\u3092\u3057\u3066\u304a\u304d\u307e\u3059\u3002(\u5225\u306b\u3044\u3089\u3093\u304b\u3063\u305f\u304b\u3082)\n\n```sysctl.conf\nnet.core.somaxconn=32768\nnet.core.netdev_max_backlog=32768\nnet.ipv4.tcp_max_syn_backlog=32768\nnet.ipv4.tcp_tw_recycle=1\nnet.ipv4.tcp_tw_reuse=1\nnet.ipv4.tcp_fin_timeout=10\nnet.core.rmem_max  = 16777216\nnet.core.wmem_max  = 16777216\nnet.ipv4.tcp_rmem  = 4096 349520 16777216\nnet.ipv4.tcp_wmem  = 4096 65536 16777216\nnet.ipv4.ip_local_port_range= 1024 65535\nnet.ipv4.tcp_timestamps = 0\n```\n\n# h2o\n\n\u3067\u306f\u307e\u305ah2o\u306e\u30d9\u30f3\u30c1\u30de\u30fc\u30af\u304b\u3089\u306f\u3058\u3081\u307e\u3059\u3002\n\n## h2o.conf(\u521d\u671f\u72b6\u614b)\n\nh2o\u306e\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb(\u521d\u671f\u72b6\u614b)\u3092\u3053\u3093\u306a\u611f\u3058\u3067\u5b9a\u7fa9\u3057\u307e\u3059\u3002\n\n```yaml:h2o.conf\nlisten: 80\nhosts:\n  \"127.0.0.1:80\":\n    paths:\n      /:\n        file.dir: /usr/local/nginx/html\n```\n\n## \u30d9\u30f3\u30c1\u30de\u30fc\u30af(\u521d\u671f\u72b6\u614b)\n\n\u3053\u308c\u3067\u30d9\u30f3\u30c1\u30de\u30fc\u30af\u3092\u8d70\u3089\u305b\u308b\u3068\u3001\n\n```\nRunning 10s test @ http://127.0.0.1\n  10 threads and 100 connections\n  Thread Stats   Avg      Stdev     Max   +/- Stdev\n    Latency   265.78us  760.09us  17.04ms   96.66%\n    Req/Sec    59.04k     7.09k  116.13k    71.93%\n  5880641 requests in 10.10s, 4.56GB read\nRequests/sec: 582269.87\nTransfer/sec:    462.01MB\n```\n\n\u79d2\u959358\u4e07\u30ea\u30af\u30a8\u30b9\u30c8\u634c\u3051\u307e\u3057\u305f\u3002\n\n## \u30b9\u30ec\u30c3\u30c9\u6570\u3092\u8abf\u6574\u3059\u308b\n\nh2o\u306f\u30c7\u30d5\u30a9\u30eb\u30c8\u3067CPU\u30b3\u30a2\u6570\u3068\u540c\u3058\u6570\u306e\u30ef\u30fc\u30ab\u30fc\u30b9\u30ec\u30c3\u30c9\u3092\u8d77\u52d5\u3057\u307e\u3059\u3002\n\u3053\u308c\u306f\u3053\u308c\u3067\u3088\u3044\u306e\u3067\u3059\u304c\u3001\u4eca\u56de\u306e\u3088\u3046\u306b\u30ed\u30fc\u30ab\u30eb\u3067\u30d9\u30f3\u30c1\u30de\u30fc\u30af\u3092\u5b9f\u884c\u3059\u308b\u5834\u5408\u3001\nCPU\u30b3\u30a2\u6570\u3068\u540c\u3058\u6570\u306e\u30ef\u30fc\u30ab\u30fc\u30b9\u30ec\u30c3\u30c9\u3092\u8d77\u52d5\u3057\u3066\u3057\u307e\u3046\u3068\u30d9\u30f3\u30c1\u30de\u30fc\u30af\u30d7\u30ed\u30b0\u30e9\u30e0\u3068CPU\u3092\u53d6\u308a\u5408\u3063\u3066\u3057\u307e\u3046\u306e\u3067\u30ef\u30fc\u30ab\u30b9\u30ec\u30c3\u30c9\u306e\u6570\u3092\u5c0f\u3055\u304f\u3057\u3066\u307f\u307e\u3059\u3002(\u3064\u3044\u3067\u306b\u6700\u5927\u30b3\u30cd\u30af\u30b7\u30e7\u30f3\u6570\u3082\u5f15\u304d\u4e0a\u3052\u307e\u3059)\n\n```yaml\nnum-threads: 16\nnum-name-resolution-threads: 1\nmax-connections: 10240\n```\n\n\u3053\u308c\u3067\u518d\u5ea6\u30d9\u30f3\u30c1\u30de\u30fc\u30af\u3092\u5b9f\u884c\u3059\u308b\u3068\u3001\n\n```\nRunning 10s test @ http://127.0.0.1\n  10 threads and 100 connections\n  Thread Stats   Avg      Stdev     Max   +/- Stdev\n    Latency   158.90us  302.95us  14.96ms   97.11%\n    Req/Sec    71.36k    10.12k  106.08k    70.63%\n  7153711 requests in 10.10s, 5.54GB read\nRequests/sec: 708328.89\nTransfer/sec:    562.03MB\n```\n\n\u79d2\u959370\u4e07\u30ea\u30af\u30a8\u30b9\u30c8\u3092\u8d8a\u3048\u307e\u3057\u305f\u3002\u306a\u304a\u3001`num-threads`\u306f\u3053\u308c\u4ee5\u4e0a\u5897\u3084\u3057\u3066\u3082`wrk`\u3068CPU\u3092\u53d6\u308a\u5408\u3063\u3066\u3057\u307e\u3046\u305b\u3044\u304b\u6027\u80fd\u304c\u4e0a\u304c\u308a\u307e\u305b\u3093\u3067\u3057\u305f\u3002\n\n\u6700\u7d42\u7684\u306ah2o.conf\u306f\u3053\u3061\u3089\u3002\n\n```yaml:h2o.conf\nnum-threads: 16\nnum-name-resolution-threads: 1\nmax-connections: 10240\nlisten: 80\nhosts:\n  \"127.0.0.1:80\":\n    paths:\n      /:\n        file.dir: /usr/local/nginx/html\n```\n\n# nginx\n\n\u3064\u3065\u3044\u3066nginx\u3067\u3059\u3002\n\n## nginx.conf(\u521d\u671f\u72b6\u614b)\n\nnginx.conf\u306e\u521d\u671f\u72b6\u614b\u306f\u4ee5\u4e0b\u306b\u306a\u308a\u307e\u3059\u3002nginx\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u305f\u76f4\u5f8c\u306enginx.conf\u304b\u3089\u30a8\u30e9\u30fc\u7cfb\u306e\u8a2d\u5b9a\u3084\u30b3\u30e1\u30f3\u30c8\u306e\u9664\u53bb\u3001\u30a2\u30af\u30bb\u30b9\u30ed\u30b0\u3092\u30aa\u30d5\u3068\u3044\u3063\u305f\u3053\u3068\u3092\u884c\u3063\u3066\u3044\u307e\u3059\u3002\n\n```nginx:nginx.conf\nworker_processes  1;\n\nevents {\n    worker_connections  1024;\n}\n\nhttp {\n    include       mime.types;\n    default_type  application/octet-stream;\n\n    access_log off;\n\n    sendfile on;\n\n    keepalive_timeout  65;\n\n    server {\n        listen       80;\n        server_name  localhost;\n        location / {\n            root   html;\n            index  index.html index.htm;\n        }\n    }\n}\n```\n\n## \u30d9\u30f3\u30c1\u30de\u30fc\u30af(\u521d\u671f\u72b6\u614b)\n\n\u3053\u308c\u3067\u30d9\u30f3\u30c1\u30de\u30fc\u30af\u3092\u8d70\u3089\u305b\u308b\u3068\u3001\n\n```\nRunning 10s test @ http://127.0.0.1/\n  10 threads and 100 connections\n  Thread Stats   Avg      Stdev     Max   +/- Stdev\n    Latency    45.04ms   58.61ms 206.35ms   78.77%\n    Req/Sec     5.52k     2.77k   10.10k    62.83%\n  535382 requests in 10.02s, 433.46MB read\nRequests/sec:  53433.93\nTransfer/sec:     43.26MB\n```\n\n\u79d2\u95935\u4e07\u30ea\u30af\u30a8\u30b9\u30c8\u3002h2o\u306e\u521d\u671f\u72b6\u614b\u306e10\u5206\u306e1\u7a0b\u5ea6\u3067\u3059\u3002\n\n## \u30ef\u30fc\u30ab\u30d7\u30ed\u30bb\u30b9\u6570\u3068\u30b3\u30cd\u30af\u30b7\u30e7\u30f3\u6570\u3092\u4e0a\u3052\u308b\n\nnginx\u306fh2o\u3068\u9055\u3044\u3001\u30c7\u30d5\u30a9\u30eb\u30c8\u306e\u30ef\u30fc\u30ab\u6570\u304c\u5c0f\u3055\u3044\u306e\u3067\u3053\u308c\u3092\u3055\u304d\u307b\u3069\u306eh2o.conf\u3068\u540c\u3058\u304f16\u306b\u3057\u307e\u3059\u3002(\u307e\u305f\u6700\u5927\u30b3\u30cd\u30af\u30b7\u30e7\u30f3\u6570\u3082\u540c\u3058\u306b\u3057\u307e\u3059)\n\n```nginx\nworker_processes 16;\nevents {\n    worker_connections 10240;\n}\n```\n\n(\u8ffd\u8a18: h2o\u306emax-connectoins \u2252 nginx\u306eworker_processes * worker_connections\u306a\u306e\u3067\u5b9f\u969b\u306b\u306f\u5dee\u304c\u3042\u308b\u304b\u3082\u3001\u3068\u3044\u3046\u610f\u898b\u3092\u9802\u3044\u305f\u306e\u3067\u5ff5\u306e\u305f\u3081\u8ffd\u8a66\u3057\u3066\u307f\u307e\u3057\u305f\u304c\u3001\u30b3\u30cd\u30af\u30b7\u30e7\u30f3\u6570\u306f\u5909\u3048\u3066\u3082\u30b9\u30b3\u30a2\u306f\u307b\u307c\u540c\u3058\u3067\u3057\u305f\u3002(h2o\u306emax-connections\u309210240\u3001nginx\u306eworker_connections\u30921024 or 640\u306b\u3057\u3066\u5b9f\u65bd))\n\n\u3053\u308c\u3067\u30d9\u30f3\u30c1\u30de\u30fc\u30af\u3092\u8d70\u3089\u305b\u308b\u3068\u3001\n\n```\nRunning 10s test @ http://127.0.0.1\n  10 threads and 100 connections\n  Thread Stats   Avg      Stdev     Max   +/- Stdev\n    Latency   827.38us    2.79ms  64.81ms   94.35%\n    Req/Sec    62.79k     8.74k   77.95k    84.26%\n  6308521 requests in 10.10s, 4.99GB read\nRequests/sec: 624638.51\nTransfer/sec:    505.72MB\n```\n\n\u79d2\u959362\u4e07\u30ea\u30af\u30a8\u30b9\u30c8\u3002\u4e00\u6c17\u306b\u4f38\u3073\u307e\u3057\u305f\u3002\n\n## open_file_cache\u3067\u30d5\u30a1\u30a4\u30eb\u60c5\u5831\u3092\u30ad\u30e3\u30c3\u30b7\u30e5\n\nnginx\u306b\u306f\u4e00\u5ea6\u30aa\u30fc\u30d7\u30f3\u3057\u305f\u30d5\u30a1\u30a4\u30eb\u306e\u30c7\u30a3\u30b9\u30af\u30ea\u30d7\u30bf\u3084\u30b5\u30a4\u30ba\u3001\u66f4\u65b0\u6642\u523b\u3001i-node\u3068\u3044\u3063\u305f\u60c5\u5831\u3092\u30ad\u30e3\u30c3\u30b7\u30e5\u3059\u308b\u305f\u3081\u306e`open_file_cache`\u3068\u3044\u3046\u30c7\u30a3\u30ec\u30af\u30c6\u30a3\u30d6\u304c\u3042\u308a\u307e\u3059\u3002\n\n```nginx\n# max: \u30ad\u30e3\u30c3\u30b7\u30e5\u306e\u6700\u5927\u6570\n# inactive: \u30a2\u30af\u30bb\u30b9\u304c\u306a\u3044\u30ad\u30e3\u30c3\u30b7\u30e5\u306e\u6709\u52b9\u671f\u9650\nopen_file_cache max=100 inactive=20s;\n```\n\n\u3053\u308c\u3092\u8a2d\u5b9a\u3057\u3066\u30d9\u30f3\u30c1\u30de\u30fc\u30af\u3092\u8d70\u3089\u305b\u308b\u3068\u3001\n\n```\nRunning 10s test @ http://127.0.0.1\n  10 threads and 100 connections\n  Thread Stats   Avg      Stdev     Max   +/- Stdev\n    Latency   761.52us    6.12ms 138.30ms   98.88%\n    Req/Sec    70.55k     8.20k   85.08k    87.69%\n  7073264 requests in 10.10s, 5.59GB read\nRequests/sec: 700324.14\nTransfer/sec:    567.00MB\n```\n\nh2o\u3068\u540c\u3058\u304f\u3089\u3044\u306e\u3068\u3053\u308d\u307e\u3067\u6765\u307e\u3057\u305f\u3002\n\n## accept_mutex_delay\n\n`accept_mutex_delay`\u306f`accept()`\u6642\u306emutex\u306e\u78ba\u4fdd\u306b\u5931\u6557\u3057\u305f\u969b\u306e\u5f85\u6a5f\u6642\u9593\u3092\u8abf\u6574\u3059\u308b\u305f\u3081\u306e\u30c7\u30a3\u30ec\u30af\u30c6\u30a3\u30d6\u3067\u3059\u3002\u30c7\u30d5\u30a9\u30eb\u30c8\u3060\u3068500ms\u3067\u3053\u308c\u3060\u3068\u5c11\u3057\u5927\u304d\u3044\u306e\u3067100ms\u306b\u3057\u307e\u3059\u3002\n\n```nginx\naccept_mutex_delay 100ms;\n```\n\n\u3053\u308c\u3067\u30d9\u30f3\u30c1\u30de\u30fc\u30af\u3092\u8d70\u3089\u305b\u308b\u3068\u3001\n\n```\nRunning 10s test @ http://127.0.0.1\n  10 threads and 100 connections\n  Thread Stats   Avg      Stdev     Max   +/- Stdev\n    Latency   401.34us    2.83ms  85.56ms   98.64%\n    Req/Sec    72.03k     8.27k  105.77k    86.40%\n  7216133 requests in 10.10s, 5.71GB read\nRequests/sec: 714511.56\nTransfer/sec:    578.48MB\n```\n\nh2o\u3092\u8d8a\u3048\u307e\u3057\u305f\u3002\n\n## tcp_nopush\n\n`tcp_nopush`\u306fnginx\u304c\u5229\u7528\u3059\u308bTCP\u30bd\u30b1\u30c3\u30c8\u306bTCP_CORK(Linux)\u3001\u3042\u308b\u3044\u306fTCP_NOPSUH(BSD)\u306e\u30aa\u30d7\u30b7\u30e7\u30f3\u3092\u30bb\u30c3\u30c8\u3059\u308b\u30c7\u30a3\u30ec\u30af\u30c6\u30a3\u30d6\u3067\u3059\u3002\u3053\u308c\u3092\u6709\u52b9\u306b\u3057\u305f\u5834\u5408\u3001\u7c21\u5358\u306b\u8a00\u3046\u3068\u30ec\u30b9\u30dd\u30f3\u30b9\u30d8\u30c3\u30c0\u3068\u30d5\u30a1\u30a4\u30eb\u306e\u5185\u5bb9\u3092\u307e\u3068\u3081\u3066\u9001\u308b\u3088\u3046\u306b\u306a\u308b\u306e\u3067\u9001\u4fe1\u3059\u308b\u30d1\u30b1\u30c3\u30c8\u6570\u3092\u6700\u5c0f\u5316\u3067\u304d\u307e\u3059\u3002\n\n```nginx\ntcp_nopush on;\n```\n\n\u3053\u308c\u3067\u30d9\u30f3\u30c1\u30de\u30fc\u30af\u3092\u8d70\u3089\u305b\u308b\u3068\u3001\n\n```\nRunning 10s test @ http://127.0.0.1\n  10 threads and 100 connections\n  Thread Stats   Avg      Stdev     Max   +/- Stdev\n    Latency   163.09us    0.99ms  36.45ms   99.12%\n    Req/Sec    82.93k     9.71k  110.85k    69.90%\n  8330029 requests in 10.10s, 6.59GB read\nRequests/sec: 824799.77\nTransfer/sec:    667.78MB\n```\n\n\u79d2\u959382\u4e07\u30ea\u30af\u30a8\u30b9\u30c8\u3002\u3059\u3054\u3044\u3067\u3059\u306d\u3002\u6700\u7d42\u7684\u306anginx.conf\u306f\u4ee5\u4e0b\u306b\u306a\u308a\u307e\u3059\u3002\n\n```nginx:nginx.conf\nworker_processes 16;\n\nevents {\n    worker_connections  10240;\n    accept_mutex_delay 100ms;\n}\n\nhttp {\n    include       mime.types;\n    default_type  application/octet-stream;\n\n    access_log off;\n\n    sendfile on;\n    open_file_cache max=100 inactive=20s;\n    tcp_nopush on;\n\n    keepalive_timeout  65;\n\n    server {\n        listen       80;\n        server_name  localhost;\n        location / {\n            root   html;\n            index  index.html index.htm;\n        }\n    }\n}\n```\n\n# \u307e\u3068\u3081\n\nh2o\u3068nginx\u306e\u30d9\u30f3\u30c1\u30de\u30fc\u30af\u3092\u30ed\u30fc\u30ab\u30eb\u3067\u53d6\u3063\u3066\u307f\u307e\u3057\u305f\u3002\u5b9f\u969b\u3084\u3063\u3066\u307f\u305f\u611f\u60f3\u3068\u3057\u3066\u306f\n\n * h2o\u306f\u307b\u3068\u3093\u3069\u8a2d\u5b9a\u3057\u306a\u304f\u3066\u3082\u304b\u306a\u308a\u30d1\u30d5\u30a9\u30fc\u30de\u30f3\u30b9\u304c\u51fa\u308b\u3088\u3046\u306b\u306a\u3063\u3066\u308b\n * nginx\u3082\u30c1\u30e5\u30fc\u30cb\u30f3\u30b0\u6b21\u7b2c\u3067h2o\u306b\u5339\u6575\u3059\u308b\u30d1\u30d5\u30a9\u30fc\u30de\u30f3\u30b9\u306f\u51fa\u308b\n\n\u3068\u3044\u3063\u305f\u6240\u3067\u3057\u3087\u3046\u304b\uff1f\u4e00\u65b9\u3067\u4eca\u56denginx\u5074\u3067\u6709\u52b9\u306b\u3057\u305f`open_file_cache`\u3084`tcp_nopush`\u76f8\u5f53\u306e\u6a5f\u80fd\u306f\u307e\u3060h2o\u306b\u306f\u5b9f\u88c5\u3055\u308c\u3066\u3044\u307e\u305b\u3093\u3002\u3053\u306e\u4e8c\u3064\u3060\u3051\u3067\u79d2\u959320\u4e07\u304f\u3089\u3044\u9055\u3046\u306e\u3067h2o\u3067\u3082\u3053\u308c\u3089\u304c\u5b9f\u88c5\u3055\u308c\u308b\u3068\u30ac\u30c1\u30ac\u30c1\u306b\u30c1\u30e5\u30fc\u30cb\u30f3\u30b0\u3057\u305fnginx\u3088\u308a\u3082\u901f\u304f\u306a\u308a\u305d\u3046\u3067\u3059\u3002`open_file_cache`\u306b\u3064\u3044\u3066\u306f\u9032\u884c\u4e2d\u306e[\u30d6\u30e9\u30f3\u30c1](https://github.com/h2o/h2o/pull/138)\u304c\u3042\u308b\u3088\u3046\u3067\u3059\u3002\n\n\u3068\u3053\u308d\u3067\u3001`tcp_nopush`\u306f\u672c\u6765`tcp_nodelay`(nginx\u3067\u306f\u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u6709\u52b9)\u3068\u306f\u53cd\u5bfe\u306e\u52d5\u304d\u3092\u3059\u308b\u306e\u3067\u3059\u304c\u3001nginx\u306f\u3053\u306e\u4e8c\u3064\u3092\u7d44\u307f\u5408\u308f\u305b\u3066\u3082\u3046\u307e\u304f\u52d5\u4f5c\u3059\u308b\u3088\u3046\u306b\u5b9f\u88c5\u3055\u308c\u3066\u3044\u308b\u3088\u3046\u3067\u3059\u3002([NGINX OPTIMIZATION: UNDERSTANDING SENDFILE, TCP_NODELAY AND TCP_NOPUSH](https://t37.net/nginx-optimization-understanding-sendfile-tcp_nodelay-and-tcp_nopush.html))\n\n# \u53c2\u8003\n\n * [nginx documentation](http://nginx.org/en/docs/)\n * [H2O](http://h2o.github.io/)\n * [G-WAN\u306f\u306a\u305c\u901f\u3044\u306e\u304b\uff1f\u3092nginx\u3068\u6bd4\u3079\u306a\u304c\u3089\u691c\u8a3c\u3057\u3066\u307f\u305f](http://blog.nomadscafe.jp/2013/09/benchmark-g-wan-and-nginx.html)\n * [NGINX OPTIMIZATION: UNDERSTANDING SENDFILE, TCP_NODELAY AND TCP_NOPUSH](https://t37.net/nginx-optimization-understanding-sendfile-tcp_nodelay-and-tcp_nopush.html)\n", "tags": ["nginx", "h2o"]}