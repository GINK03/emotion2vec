{"context": " More than 1 year has passed since last update.\n\n\u6982\u8981\n\n\u672a\u3060\u306bOffice\u7cfb\u306e\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u7b49\u304c\u3044\u3063\u3071\u3044\u3042\u308b\u306e\u3067Github\u7b49\u306ewiki\u306b\u8f09\u305b\u3061\u3083\u304a\u3046\n\u30ea\u30f3\u30af\u66f8\u304f\u306e\u3081\u3093\u3069\u304f\u3055\n\u4e00\u89a7\u3092\u751f\u6210\u3057\u3066\u3057\u307e\u3048\n\n\n\u30b9\u30af\u30ea\u30d7\u30c8\n\nFileList2Markdown.ps1\nparam(\n    [Parameter(Mandatory=$true)]\n    [string]\n    $TargetPath,\n\n    [string]\n    $OutputPath\n)\nfunction Convert-Markdown {\n    param(\n        [Parameter(ValueFromPipeline=$true)]\n        [PSObject]\n        $TargetInfo,\n\n        [int]\n        $Depth=1,\n\n        [Parameter(Mandatory=$true)]\n        [string]\n        $Parent\n    )\n    process {\n        $row = \"#\" * ($Depth+1) + \" \"\n        $row += $TargetInfo.Name\n        Write-File $row\n        if($TargetInfo.PSIsContainer) {\n            Get-ChildItem $TargetInfo.FullName | Convert-Markdown -Depth ($Depth+1) -Parent (Join-Path $Parent $TargetInfo.Name)\n        } else {\n            Get-FileLink -FileName $TargetInfo.Name -ParentDir $Parent | Write-File\n        }\n    }\n}\nfunction Get-FileLink {\n    param(\n        [Parameter(Mandatory=$true)]\n        [string]\n        $FileName,\n\n        [Parameter(Mandatory=$true)]\n        [string]\n        $ParentDir\n    )\n    $path = Join-Path $ParentDir $FileName\n    \"[{0}]{{{1}}}`n\" -F $FileName, ($path -replace \"\\\\\" , \"/\")\n}\nfunction Write-File {\n    param(\n        [Parameter(ValueFromPipeline=$true,Mandatory=$true)]\n        [string]\n        $Body\n    )\n    Out-File $OutputPath -Encoding UTF8 -Append -InputObject $Body\n}\n\n$title = \"# Documents\"\nif(-not (Test-Path $TargetPath)) {\n    throw [System.IO.DirectoryNotFoundException] \"$TargetPath not found.\"\n}\n$TargetDir = Convert-Path $TargetPath\n\nif(-not (Get-Item $TargetDir).PSIsContainer) {\n    $TargetDir = Split-Path $TargetDir -Parent\n}\n\nif( -not $OutputPath) {\n    $OutputPath = (Split-Path $TargetDir -leaf) + \".md\"\n}\n\n$null = New-Item $OutputPath -Type file -Force\nWrite-File $title\nGet-ChildItem $TargetDir | Convert-Markdown -Parent (Split-Path $TargetDir -leaf)\n\n\n\n\u69cb\u9020(INPUT)\n...\\DOC\n|   111.txt\n|\n\\---aaa\n    |   bbb.txt\n    |\n    \\---ccc\n            ddd.txt\n\n\nMarkdown(OUTPUT)\n# Documents\n## aaa\n### ccc\n#### ddd.txt\n[ddd.txt](Doc/aaa/ccc/ddd.txt)\n\n### bbb.txt\n[bbb.txt](Doc/aaa/bbb.txt)\n\n## 111.txt\n[111.txt](Doc/111.txt)\n\n\n\n\u4f7f\u3044\u65b9\n# .\\FileList2Markdown.ps1 -TargetPath {\u5bfe\u8c61\u30c7\u30a3\u30ec\u30af\u30c8\u30ea} -OutputPath {\u51fa\u529b\u5148}\n\n.\\FileList2Markdown.ps1 -TargetPath .\\Doc -OutputPath Documents.md\n.\\FileList2Markdown.ps1 .\\Doc # \u3067\u3082OK\uff08Doc.md\u306b\u51fa\u529b\u3055\u308c\u308b\uff09\n\npre-commit\u30d5\u30c3\u30af\u304b\u3089\u8aad\u3093\u3058\u3083\u3046\u306e\u3082\u3042\u308a\u304b\u3068\n# \u6982\u8981\n0. \u672a\u3060\u306bOffice\u7cfb\u306e\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u7b49\u304c\u3044\u3063\u3071\u3044\u3042\u308b\u306e\u3067Github\u7b49\u306ewiki\u306b\u8f09\u305b\u3061\u3083\u304a\u3046\n1. \u30ea\u30f3\u30af\u66f8\u304f\u306e\u3081\u3093\u3069\u304f\u3055\n2. \u4e00\u89a7\u3092\u751f\u6210\u3057\u3066\u3057\u307e\u3048\n\n## \u30b9\u30af\u30ea\u30d7\u30c8\n```ps1:FileList2Markdown.ps1\nparam(\n    [Parameter(Mandatory=$true)]\n    [string]\n    $TargetPath,\n\n    [string]\n    $OutputPath\n)\nfunction Convert-Markdown {\n    param(\n        [Parameter(ValueFromPipeline=$true)]\n        [PSObject]\n        $TargetInfo,\n\n        [int]\n        $Depth=1,\n\n        [Parameter(Mandatory=$true)]\n        [string]\n        $Parent\n    )\n    process {\n        $row = \"#\" * ($Depth+1) + \" \"\n        $row += $TargetInfo.Name\n        Write-File $row\n        if($TargetInfo.PSIsContainer) {\n            Get-ChildItem $TargetInfo.FullName | Convert-Markdown -Depth ($Depth+1) -Parent (Join-Path $Parent $TargetInfo.Name)\n        } else {\n            Get-FileLink -FileName $TargetInfo.Name -ParentDir $Parent | Write-File\n        }\n    }\n}\nfunction Get-FileLink {\n    param(\n        [Parameter(Mandatory=$true)]\n        [string]\n        $FileName,\n\n        [Parameter(Mandatory=$true)]\n        [string]\n        $ParentDir\n    )\n    $path = Join-Path $ParentDir $FileName\n    \"[{0}]{{{1}}}`n\" -F $FileName, ($path -replace \"\\\\\" , \"/\")\n}\nfunction Write-File {\n    param(\n        [Parameter(ValueFromPipeline=$true,Mandatory=$true)]\n        [string]\n        $Body\n    )\n    Out-File $OutputPath -Encoding UTF8 -Append -InputObject $Body\n}\n\n$title = \"# Documents\"\nif(-not (Test-Path $TargetPath)) {\n    throw [System.IO.DirectoryNotFoundException] \"$TargetPath not found.\"\n}\n$TargetDir = Convert-Path $TargetPath\n\nif(-not (Get-Item $TargetDir).PSIsContainer) {\n    $TargetDir = Split-Path $TargetDir -Parent\n}\n\nif( -not $OutputPath) {\n    $OutputPath = (Split-Path $TargetDir -leaf) + \".md\"\n}\n\n$null = New-Item $OutputPath -Type file -Force\nWrite-File $title\nGet-ChildItem $TargetDir | Convert-Markdown -Parent (Split-Path $TargetDir -leaf)\n```\n\n### \u69cb\u9020(INPUT)\n```\n...\\DOC\n|   111.txt\n|\n\\---aaa\n    |   bbb.txt\n    |\n    \\---ccc\n            ddd.txt\n```\n\n### Markdown(OUTPUT)\n```\n# Documents\n## aaa\n### ccc\n#### ddd.txt\n[ddd.txt](Doc/aaa/ccc/ddd.txt)\n\n### bbb.txt\n[bbb.txt](Doc/aaa/bbb.txt)\n\n## 111.txt\n[111.txt](Doc/111.txt)\n```\n\n![markdown.png](https://qiita-image-store.s3.amazonaws.com/0/54591/e1a419dd-2566-0a95-c6f1-44b80157c028.png)\n\n### \u4f7f\u3044\u65b9\n```ps1\n# .\\FileList2Markdown.ps1 -TargetPath {\u5bfe\u8c61\u30c7\u30a3\u30ec\u30af\u30c8\u30ea} -OutputPath {\u51fa\u529b\u5148}\n\n.\\FileList2Markdown.ps1 -TargetPath .\\Doc -OutputPath Documents.md\n.\\FileList2Markdown.ps1 .\\Doc # \u3067\u3082OK\uff08Doc.md\u306b\u51fa\u529b\u3055\u308c\u308b\uff09\n```\n\n`pre-commit`\u30d5\u30c3\u30af\u304b\u3089\u8aad\u3093\u3058\u3083\u3046\u306e\u3082\u3042\u308a\u304b\u3068\n", "tags": ["PowerShell", "Markdown", "GitHub"]}