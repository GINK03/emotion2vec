{"context": "IBM Data Scientist Experience \u306e Python2 with Spark1.6\u306b\u3066\u5b9f\u884c\n(1\uff09\u30af\u30ec\u30c7\u30f3\u30b7\u30e3\u30eb\uff08\u8cc7\u683c\u60c5\u5831\uff09\u3092\u5b9a\u7fa9\n\u3042\u3089\u304b\u3058\u3081DSX\u306b\u81ea\u5206\u306edashDB\u3092\u767b\u9332\u3057\u3066\u304a\u3044\u305f\u306e\u3067\u3001\"insert to code\"\u3092\u30af\u30ea\u30c3\u30af\u3057\u3066\u8a2d\u5b9a\u3002\uff08\u30e6\u30fc\u30b6\u30fc\u540d\u3068\u30d1\u30b9\u30ef\u30fc\u30c9\u306f\u4f0f\u5b57\u306b\u3057\u3066..\u307e\u3059\uff09\n\ncredentials_2 = {\n  'port':'50000',\n  'db':'BLUDB',\n  'username':'dashXXXXX',\n  'ssljdbcurl':'jdbc:db2://dashdb-entry-yp-dal09-07.services.dal.bluemix.net:50001/BLUDB:sslConnection=true;',\n  'host':'dashdb-entry-yp-dal09-07.services.dal.bluemix.net',\n  'https_url':'https://dashdb-entry-yp-dal09-07.services.dal.bluemix.net:8443',\n  'dsn':'DATABASE=BLUDB;HOSTNAME=dashdb-entry-yp-dal09-07.services.dal.bluemix.net;PORT=50000;PROTOCOL=TCPIP;UID=dashXXXX;PWD=XXXXXXXXXXX;',\n  'hostname':'dashdb-entry-yp-dal09-07.services.dal.bluemix.net',\n  'jdbcurl':'jdbc:db2://dashdb-entry-yp-dal09-07.services.dal.bluemix.net:50000/BLUDB',\n  'ssldsn':'DATABASE=BLUDB;HOSTNAME=dashdb-entry-yp-dal09-07.services.dal.bluemix.net;PORT=50001;PROTOCOL=TCPIP;UID=dash7836;PWD=82f9d02e61da;Security=SSL;',\n  'uri':'db2://dashXXXX:XXXXXXXXXXX@dashdb-entry-yp-dal09-07.services.dal.bluemix.net:50000/BLUDB',\n  'password':\"\"\"XXXXXXXXXXXXX\"\"\"\n}\n\n(2) \u30c7\u30fc\u30bf\u53d6\u5f97\u7528\u306e\u95a2\u6570\u3092\u5b9a\u7fa9\n\u53c2\u8003\u306b\u3057\u305f\u30b5\u30a4\u30c8 --->  http://stackoverflow.com/questions/37688993/how-to-use-pandas-on-spark-notebook-data-on-dashdb-in-python\ndef getDashData(credentials,schemaName , tableName):\n    from pyspark.sql import SQLContext\n    sqlContext = SQLContext(sc)\n    props = {}\n    props['user'] = credentials['username']\n    props['password'] = credentials['password']\n    table = schemaName + '.' + tableName     \n    return sqlContext.read.jdbc(credentials['jdbcurl'],table,properties=props)\n\n(3) dashDB\u304b\u3089\u30c7\u30fc\u30bf\u3092\u53d6\u308a\u51fa\u3057& \u5148\u982d\uff11\uff10\u30ec\u30b3\u30fc\u30c9\u3092\u78ba\u8a8d\ndf_dash = getDashData(credentials_2 , 'DASH7836', 'TEST1' )\ndf_dash.toPandas().head(10)\n\n\nIBM Data Scientist Experience \u306e Python2 with Spark1.6\u306b\u3066\u5b9f\u884c\n(1\uff09\u30af\u30ec\u30c7\u30f3\u30b7\u30e3\u30eb\uff08\u8cc7\u683c\u60c5\u5831\uff09\u3092\u5b9a\u7fa9\n\u3042\u3089\u304b\u3058\u3081DSX\u306b\u81ea\u5206\u306edashDB\u3092\u767b\u9332\u3057\u3066\u304a\u3044\u305f\u306e\u3067\u3001\"insert to code\"\u3092\u30af\u30ea\u30c3\u30af\u3057\u3066\u8a2d\u5b9a\u3002\uff08\u30e6\u30fc\u30b6\u30fc\u540d\u3068\u30d1\u30b9\u30ef\u30fc\u30c9\u306f\u4f0f\u5b57\u306b\u3057\u3066..\u307e\u3059\uff09\n<img width=\"1273\" alt=\"Screen Shot 2016-11-16 at 17.46.16.png\" src=\"https://qiita-image-store.s3.amazonaws.com/0/149522/5aae0167-7db9-9511-923e-7393ed2e45ff.png\">\n\n```\ncredentials_2 = {\n  'port':'50000',\n  'db':'BLUDB',\n  'username':'dashXXXXX',\n  'ssljdbcurl':'jdbc:db2://dashdb-entry-yp-dal09-07.services.dal.bluemix.net:50001/BLUDB:sslConnection=true;',\n  'host':'dashdb-entry-yp-dal09-07.services.dal.bluemix.net',\n  'https_url':'https://dashdb-entry-yp-dal09-07.services.dal.bluemix.net:8443',\n  'dsn':'DATABASE=BLUDB;HOSTNAME=dashdb-entry-yp-dal09-07.services.dal.bluemix.net;PORT=50000;PROTOCOL=TCPIP;UID=dashXXXX;PWD=XXXXXXXXXXX;',\n  'hostname':'dashdb-entry-yp-dal09-07.services.dal.bluemix.net',\n  'jdbcurl':'jdbc:db2://dashdb-entry-yp-dal09-07.services.dal.bluemix.net:50000/BLUDB',\n  'ssldsn':'DATABASE=BLUDB;HOSTNAME=dashdb-entry-yp-dal09-07.services.dal.bluemix.net;PORT=50001;PROTOCOL=TCPIP;UID=dash7836;PWD=82f9d02e61da;Security=SSL;',\n  'uri':'db2://dashXXXX:XXXXXXXXXXX@dashdb-entry-yp-dal09-07.services.dal.bluemix.net:50000/BLUDB',\n  'password':\"\"\"XXXXXXXXXXXXX\"\"\"\n}\n```\n(2) \u30c7\u30fc\u30bf\u53d6\u5f97\u7528\u306e\u95a2\u6570\u3092\u5b9a\u7fa9\n\u53c2\u8003\u306b\u3057\u305f\u30b5\u30a4\u30c8 --->  http://stackoverflow.com/questions/37688993/how-to-use-pandas-on-spark-notebook-data-on-dashdb-in-python\n\n```\ndef getDashData(credentials,schemaName , tableName):\n    from pyspark.sql import SQLContext\n    sqlContext = SQLContext(sc)\n    props = {}\n    props['user'] = credentials['username']\n    props['password'] = credentials['password']\n    table = schemaName + '.' + tableName     \n    return sqlContext.read.jdbc(credentials['jdbcurl'],table,properties=props)\n```\n\n(3) dashDB\u304b\u3089\u30c7\u30fc\u30bf\u3092\u53d6\u308a\u51fa\u3057& \u5148\u982d\uff11\uff10\u30ec\u30b3\u30fc\u30c9\u3092\u78ba\u8a8d\n\n```\ndf_dash = getDashData(credentials_2 , 'DASH7836', 'TEST1' )\ndf_dash.toPandas().head(10)\n```\n<img width=\"259\" alt=\"Screen Shot 2016-11-16 at 17.56.05.png\" src=\"https://qiita-image-store.s3.amazonaws.com/0/149522/8ce83066-ebfe-4c0f-8c18-820eb91a293c.png\">\n\n", "tags": ["Python", "Spark", "dashDB"]}