{"tags": ["NDK", "Android\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3", "JNI", "AndroidStudio", "Android"], "context": " More than 1 year has passed since last update.\n\n\u76ee\u7684\n\n\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u306e\u5411\u4e0a\n\n\nAndroid\u306eapk\u30d1\u30c3\u30b1\u30fc\u30b8\u306f\u3001ProGuard\u3067\u96e3\u8aad\u5316\u304c\u884c\u308f\u308c\u307e\u3059\u3002\u3057\u304b\u3057\u3001\u96e3\u8aad\u5316\u306f\u6697\u53f7\u5316\u3067\u306f\u306a\u3044\u306e\u3067\u3001\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u4e0a\u306b\u3001\u6697\u8a3c\u756a\u53f7\u306a\u3069\u3092\u8a18\u8f09\u3057\u3066\u3044\u305f\u5834\u5408\u3001\u30ea\u30d0\u30fc\u30b9\u30a8\u30f3\u30b8\u30cb\u30a2\u30ea\u30f3\u30b0\u3067\u3059\u3050\u306b\u898b\u7834\u3089\u308c\u3066\u3057\u307e\u3044\u307e\u3059\u3002\nNative(C,C++)\u306e\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u5185\u306b\u6697\u8a3c\u756a\u53f7\u3092\u8a18\u8f09\u3057\u3001\u305d\u308c\u3092Java\u304b\u3089\u547c\u3073\u51fa\u3059\u3053\u3068\u3067\u3001\u96a0\u853d\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n\n\u9ad8\u901f\u5316\n\n\nAndroid\u306eDalvik VM\uff08\u4eee\u60f3\u30de\u30b7\u30f3\u3067\uff09\u306f\u3001VM\u3067\u3042\u308b\u304c\u3086\u3048\u306b\u51e6\u7406\u901f\u5ea6\u3067\u8d8a\u3048\u3089\u308c\u306a\u3044\u58c1\u304c\u5b58\u5728\u3057\u307e\u3059\u3002\u3053\u306e\u8d8a\u3048\u3089\u308c\u306a\u3044\u58c1\u3092\u8d8a\u3048\u306a\u3051\u308c\u3070\u3044\u3051\u306a\u3044\u72b6\u6cc1\u306b\u9665\u3063\u305f\u6642\u306b\u3001OS\u304c\u76f4\u63a5\u5b9f\u884c\u3067\u304d\u308b\u30d0\u30a4\u30c8\u30b3\u30fc\u30c9\u306b\u3067\u304d\u308bNDK\u304c\u6709\u52b9\u3067\u3059\u3002\n\u307b\u3068\u3093\u3069\u306e\u5834\u5408\u3001Java\u306e\u30d7\u30ed\u30b0\u30e9\u30e0\u306e\u6700\u9069\u5316\u3067\u6e08\u3080\u3068\u601d\u3044\u307e\u3059\u304c\u3001\u7aef\u672b\u5185\u3067\u753b\u50cf\u51e6\u7406\u3092\u884c\u3046\u306a\u3069\u306e\u5834\u5408\u306b\u306f\u3001\u9078\u629e\u80a2\u306b\u5165\u3063\u3066\u304f\u308b\u3068\u601d\u3044\u307e\u3059\u3002\n\n\niOS,Android\u3067\u306e\u30e9\u30a4\u30d6\u30e9\u30ea\u306e\u5171\u901a\u5316\n\n\nC,C++\u3067\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u3092\u66f8\u304f\u3053\u3068\u304c\u3067\u304d\u308b\u306e\u3067\u3001iOS(Objective-C)\u304b\u3089\u3082\u8aad\u307f\u8fbc\u3080\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3057\u3001Android\u3067\u3082JNI\u306e\u578b\u306b\u30de\u30c3\u30c1\u3055\u305b\u308c\u3070\u3001\u8aad\u307f\u8fbc\u3080\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\u5185\u90e8\u30ed\u30b8\u30c3\u30af\u306f\u305d\u306e\u307e\u307e\u3067\u3001\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30a4\u30b9\u306e\u66f8\u304d\u63db\u3048\uff08\u3082\u3057\u304f\u306f\u3001\u30e9\u30c3\u30d7\uff09\u306e\u307f\u3067\u4e21OS\u304b\u3089\u3001\u5229\u7528\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\u6ce8\u610f\u70b9\u3068\u3057\u3066\u306f\u3001\u74b0\u5883\u306b\u3088\u3063\u3066\u30d0\u30a4\u30c8\u30aa\u30fc\u30c0\u30fc\uff08\u30d3\u30c3\u30b0\u30a8\u30f3\u30c7\u30a3\u30a2\u30f3, \u30ea\u30c8\u30eb\u30a8\u30f3\u30c7\u30a3\u30a2\u30f3\uff09\u304c\u7570\u306a\u308a\u307e\u3059\u3002\n\n\n\n\n\u74b0\u5883\u69cb\u7bc9\uff082015/10/10\u73fe\u5728\uff09\nAndroid NDK Preview\nAndroid Studio 1.3\u4ee5\u4e0a\u3001Gradle 2.5\u4ee5\u4e0a\u304c\u5fc5\u9808\u306e\u3088\u3046\u3067\u3059\u3002\n\u4eca\u56de\u306f\u3001\u4ee5\u4e0b\u306e\u74b0\u5883\u3067\u8a66\u3057\u307e\u3057\u305f\u3002\n\nAndroid Studio 1.4\nGradle 2.5\nAndroid NDK r10e\n\n\nGradle\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u30a2\u30c3\u30d7\nAndroid Studio 1.4\u3067\u3001\u65b0\u898f\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092\u4f5c\u6210\u3057\u305f\u5834\u5408\u3001Gradle\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u306f\u30012.4\u3067\u3057\u305f\u3002\n 1. Android Studio\u3092\u8d77\u52d5\n 2. \u5de6\u30e1\u30cb\u30e5\u30fc\uff08Project\uff09\u306e\u300eapp\u300f\u3092<<\u53f3\u30af\u30ea\u30c3\u30af>>\u3001\u300eOpen Module Settings\u300f\u3092\u9078\u629e\u3057\u307e\u3059\u3002\n 3. \u300eProject\u300f\u306e\u201dGradle version\u201d\u3092\u6700\u65b0\u306eGradle\u306b\u3057\u307e\u3059\u3002\u4eca\u56de\u306f\u3001\u300e2.5\u300f\u3068\u5165\u529b\u3057\u307e\u3057\u305f\u3002\n 4. \"Gradle project sync in progress...\"\u3068\u8868\u793a\u3055\u308c\u3001\u81ea\u52d5\u7684\u306b\u30d0\u30fc\u30b8\u30e7\u30f3\u30a2\u30c3\u30d7\u304c\u884c\u308f\u308c\u307e\u3059\u3002\n 5. 5\u5206\u307b\u3069\u3067\u5b8c\u4e86\u3057\u307e\u3059\u3002\n\nAndroid NDK\u306e\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\n\nAndroidStudio\u3092\u8d77\u52d5\n\u5de6\u30e1\u30cb\u30e5\u30fc\uff08Project\uff09\u306e\u300eapp\u300f\u3092<<\u53f3\u30af\u30ea\u30c3\u30af>>\u3001\u300eSDK Location\u300f\u3092\u9078\u629e\u3057\u307e\u3059\u3002\n\"Android SDK Location:\"\u306e\u4e0b\u306b\u3042\u308b\u300eDownload Android NDK\u300f\u3092\u30af\u30ea\u30c3\u30af\u3057\u307e\u3059\u3002\n20\u5206\u307b\u3069\u3067\u5b8c\u4e86\u3057\u307e\u3059\u3002\n\n\nExperimental Plugin\u306e\u9069\u7528\nExperimental Plugin User Guide\n\n\u300egradle-wrapper.properties\u300f\u4fee\u6b63\n\n\u5909\u66f4\u524d\n\n\n/gradle/wrapper/gradle-wrapper.properties\ndistributionUrl=https\\://services.gradle.org/distributions/gradle-2.4-all.zip\n\n\n\n\u5909\u66f4\u5f8c\n\n\n/gradle/wrapper/gradle-wrapper.properties\ndistributionUrl=https\\://services.gradle.org/distributions/gradle-2.5-all.zip\n\n\n\n\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306e\u300ebuild.gradle\u300f\u4fee\u6b63\n\n\u5909\u66f4\u524d\n\n\n/build.gradle\nbuildscript {\n    repositories {\n        jcenter()\n    }\n    dependencies {\n        classpath 'com.android.tools.build:gradle:1.3.0'\n    }\n}\n\n\n\n\n\u5909\u66f4\u5f8c\uff08\u5b9f\u9a13\u7684\u2026\u2026\u3002\u307e\u3041\u3001\u5b9f\u9a13\u597d\u304d\u3067\u3059\u3051\u3069\uff09\n\n\n/build.gradle\nbuildscript {\n    repositories {\n        jcenter()\n    }\n    dependencies {\n        classpath 'com.android.tools.build:gradle-experimental:0.2.0'\n    }\n}\n\n\n\n\napp\u306e\u300ebuild.gradle\u300f\u306e\u4fee\u6b63\n\n\u5909\u66f4\u524d\n\n\n/app/build.gradle\napply plugin: 'com.android.application'\n\nandroid {\n    compileSdkVersion 23\n    buildToolsVersion \"23.0.1\"\n\n    defaultConfig {\n        applicationId \"info.*****.sbx.ndk01\"\n        minSdkVersion 22\n        targetSdkVersion 23\n        versionCode 1\n        versionName \"1.0\"\n    }\n    buildTypes {\n        release {\n            minifyEnabled false\n            proguardFiles getDefaultProguardFile('proguard-android.txt'), 'proguard-rules.pro'\n        }\n    }\n}\n\ndependencies {\n    compile fileTree(dir: 'libs', include: ['*.jar'])\n    testCompile 'junit:junit:4.12'\n    compile 'com.android.support:appcompat-v7:23.0.1'\n    compile 'com.android.support:design:23.0.1'\n}\n\n\n\n\u5909\u66f4\u5f8c\n\n\nplugin\u304c\u5909\u308f\u308b\u306e\u3067\u3001\u305d\u3082\u305d\u3082\u306eDSL\uff08\u8a18\u8ff0\u65b9\u6cd5\uff09\u304c\u5909\u308f\u308a\u307e\u3059\u3002\n\u4eca\u56de\u306f\u3001\u300ehello.c\u300f\u3068\u3044\u3046\u30d5\u30a1\u30a4\u30eb\u3092\u300elibhello.so\u300f\u3068\u3044\u3046\u30c0\u30a4\u30ca\u30df\u30c3\u30af\u30ea\u30f3\u30af\u30e9\u30a4\u30d6\u30e9\u30ea\u306b\u30b3\u30f3\u30d1\u30a4\u30eb\u3057\u3066\u3001Android\u5185\u304b\u3089\u5229\u7528\u3059\u308b\u60f3\u5b9a\u3067\u3059\u3002\n\n\n\n\n/app/build.gradle\napply plugin: 'com.android.model.application'\n\nmodel {\n    android {\n        compileSdkVersion = 23\n        buildToolsVersion = \"23.0.1\"\n\n        defaultConfig.with {\n            applicationId = \"info.*****.sbx.ndk01\"\n            minSdkVersion.apiLevel = 22\n            targetSdkVersion.apiLevel = 23\n        }\n    }\n\n    /*\n     * native build settings\n     */\n    android.ndk {\n        moduleName = \"hello\"\n        /*\n         * Other ndk flags configurable here are\n         * cppFlags += \"-fno-rtti\"\n         * cppFlags += \"-fno-exceptions\"\n         * ldLibs    = [\"android\", \"log\"]\n         * stl       = \"system\"\n         */\n    }\n    android.buildTypes {\n        release {\n            minifyEnabled = false\n            proguardFiles  += file('proguard-rules.txt')\n        }\n    }\n    android.productFlavors {\n        create(\"arm\") {\n            ndk.abiFilters += \"armeabi\"\n        }\n        create(\"arm7\") {\n            ndk.abiFilters += \"armeabi-v7a\"\n        }\n        create(\"arm8\") {\n            ndk.abiFilters += \"arm64-v8a\"\n        }\n        create(\"x86\") {\n            ndk.abiFilters += \"x86\"\n        }\n        create(\"x86-64\") {\n            ndk.abiFilters += \"x86_64\"\n        }\n        create(\"mips\") {\n            ndk.abiFilters += \"mips\"\n        }\n        create(\"mips-64\") {\n            ndk.abiFilters += \"mips64\"\n        }\n        // To include all cpu architectures, leaves abiFilters empty\n        create(\"all\")\n    }\n\n}\ndependencies {\n    compile fileTree(dir: 'libs', include: ['*.jar'])\n    compile 'com.android.support:appcompat-v7:23.0.1'\n    compile 'com.android.support:design:23.0.1'\n}\n\n\n\n\"Sync Now!\" \n\n\nJNI(Java Native Interface)\u3067\u3001Hello World!\n\n\u30e9\u30a4\u30d6\u30e9\u30ea\u30d5\u30a1\u30a4\u30eb\u306e\u4f5c\u6210\n\nJNI\u7528\u306e\u30d5\u30a9\u30eb\u30c0\u3092\u4f5c\u6210\u3057\u307e\u3059\n\n\napp/src/main/jni/\n\n\nhello.c\u3092\u4f5c\u6210\u3057\u307e\u3059\n\n\n\u30d8\u30c3\u30c0\u30d5\u30a1\u30a4\u30eb\uff08.h\uff09\u306f\u4e0d\u8981\u3002 \n\u3053\u306e\u6642\u91cd\u8981\u306a\u306e\u306f\u95a2\u6570\u540d\u3067\u3059\u3002\u3053\u308c\u3092\u9593\u9055\u3048\u308b\u3068\u3001\u6642\u9593\u3060\u3051\u304c\u6d6a\u8cbb\u3055\u308c\u307e\u3059\u3002\nJNI(Java Native Interface)\u306e\u540d\u304c\u793a\u3059\u901a\u308a\u3001\u30d3\u30eb\u30c9\u6642\u306b\u547d\u540d\u898f\u5247\u306b\u5f93\u3063\u3066\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30a4\u30b9\u3092\u30de\u30c3\u30d7\u3057\u3066\u304f\u308c\u307e\u3059\u3002\nJava_{\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u30c7\u30a3\u30ec\u30af\u30c8\u30ea}{\u547c\u3073\u51fa\u3057\u5143\u30af\u30e9\u30b9\u540d}{\u30e1\u30bd\u30c3\u30c9\u540d}\n\n\n\n\napp/src/main/jni/hello.c\n#include <string.h>\n#include <jni.h>\n\njstring\nJava_info_*****_sbx_ndk01_MainActivity_stringFromJNI( JNIEnv* env, jobject thiz ) {\n    return (*env)->NewStringUTF(env, \"Hello JNI !\");\n}\n\n\n\nMainActivity\u304b\u3089\u306e\u547c\u3073\u51fa\u3057\n\nMainActivity.java\npublic class MainActivity extends AppCompatActivity {\n\n    // hello.so\u306e\u8aad\u307f\u8fbc\u307f\n    static {\n        System.loadLibrary(\"hello\");\n    }\n\n    // hello\u30e9\u30a4\u30d6\u30e9\u30ea\u306b\u3042\u308b\u30e1\u30bd\u30c3\u30c9\u306e\u5b9a\u7fa9\n    public native String  stringFromJNI();\n\n    @Override\n    protected void onCreate(Bundle savedInstanceState) {\n        super.onCreate(savedInstanceState);\n        setContentView(R.layout.activity_main);\n\n        // \u30e1\u30bd\u30c3\u30c9\u306e\u547c\u3073\u51fa\u3057\n        // Hello JNI !\u3068\u8868\u793a\u3055\u308c\u308b\n        Log.i(\"\", stringFromJNI());\n    }\n}\n\n\n\n\n\u53c2\u7167\n\nAndroid NDK\nAndroid NDK Sample\n\n\n\u3061\u3087\u3063\u3068\u3044\u3063\u3077\u304f\n\n\u5b9f\u969b\u306e\u30c0\u30a4\u30ca\u30df\u30c3\u30af\u30ea\u30f3\u30af\u30e9\u30a4\u30d6\u30e9\u30ea\u306f\u3069\u3053\u306b\u3042\u308b\u306e\u304b\uff1f\n\n\n\u30c7\u30d0\u30c3\u30b0\u30d3\u30eb\u30c9\u3060\u3068\u4ee5\u4e0b\u306e\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u3042\u308b\u3088\u3046\u3067\u3059\u3002\napp/build/intermediates/binaries/debug/all/obj/armeabi-v7a/libhello.so\n\n\nEclipse + NDK\n\n\n3~4\u5e74\u524d\u3001\u5b9f\u969b\u306e\u88fd\u54c1\u3092\u4f5c\u3063\u305f\u6642\u306b\u306f\u3001Windows + Eclipse + NDK\u3067\u3001C\u30bd\u30fc\u30b9\u3092\u66f8\u304d\u63db\u3048\u308b\u305f\u3073\u306bCygwin\u3067\u30d3\u30eb\u30c9\u3057\u3066\u3001\u305d\u306e\u5f8c\u3001Eclipse\u3067\u30d3\u30eb\u30c9\u3057\u3066\u3001\u3068\u624b\u9593\u304c\u591a\u304b\u3063\u305f\u3067\u3059\u304c\u3001AndroidStudio\u3067\u306f\u3001\u4e8c\u3064\u306e\u30d3\u30eb\u30c9\u3092\u4e00\u6c17\u306b\u3084\u3063\u3066\u304f\u308c\u307e\u3059\u3002\n\u57fa\u672c\u7684\u306b\u3001\u300e.so\u300f\u30d5\u30a1\u30a4\u30eb\u306b\u5909\u66f4\u304c\u306a\u3051\u308c\u3070\u3001\u305d\u306e\u307e\u307e\u30ea\u30ea\u30fc\u30b9\u3057\u3066\u3044\u307e\u3057\u305f\u304c\u3001\u4f55\u304b\u306e\u62cd\u5b50\u306b\u540c\u5c01\u3057\u5fd8\u308c\u3066\uff08\u8b66\u544a\u306f\u3067\u306a\u3044\uff09\u3059\u3068\u3093\u3068\u843d\u3061\u3066\u3044\u305f\u3068\u3044\u3046\u3053\u3068\u304c\u3042\u308a\u307e\u3057\u305f\u3002AndroidStudio\u3067\u306f\u3001\u30ef\u30f3\u30b9\u30c8\u30c3\u30d7\u306a\u306e\u3067\u3001\u304d\u3063\u3068\u305d\u3093\u306a\u3053\u3068\u3082\u306a\u304f\u306a\u308b\u3067\u3057\u3087\u3046\u3002\n\n\n\u4f7f\u3044\u6240\n\n\n Google\u306e\u30b5\u30f3\u30d7\u30eb\u3092\u898b\u308b\u9650\u308a\u3001\u3084\u306f\u308a\u30de\u30eb\u30c1\u30e1\u30c7\u30a3\u30a2\uff08\u97f3\u58f0\u3001\u753b\u50cf\u30013D\u30e2\u30c7\u30ea\u30f3\u30b0\uff09\u306e\u6271\u3044\u304c\u591a\u3044\u3088\u3046\u3067\u3059\u3002\n\n\n\n\n\u3064\u3065\u304f\n\nJNI\u306e\u578b\u3068\u30c7\u30fc\u30bf\u69cb\u9020\uff08\u4e88\u5b9a\uff09\n\u30c7\u30d0\u30c3\u30b0\u65b9\u6cd5\uff08\u4e88\u5b9a\uff09\nNDK\u3092\u5229\u7528\u3057\u305f\u6697\u8a3c\u756a\u53f7\u306e\u96a0\u853d\uff08\u4e88\u5b9a\uff09\n\n\n## \u76ee\u7684\n* \u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u306e\u5411\u4e0a\n * Android\u306eapk\u30d1\u30c3\u30b1\u30fc\u30b8\u306f\u3001ProGuard\u3067\u96e3\u8aad\u5316\u304c\u884c\u308f\u308c\u307e\u3059\u3002\u3057\u304b\u3057\u3001\u96e3\u8aad\u5316\u306f\u6697\u53f7\u5316\u3067\u306f\u306a\u3044\u306e\u3067\u3001\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u4e0a\u306b\u3001\u6697\u8a3c\u756a\u53f7\u306a\u3069\u3092\u8a18\u8f09\u3057\u3066\u3044\u305f\u5834\u5408\u3001\u30ea\u30d0\u30fc\u30b9\u30a8\u30f3\u30b8\u30cb\u30a2\u30ea\u30f3\u30b0\u3067\u3059\u3050\u306b\u898b\u7834\u3089\u308c\u3066\u3057\u307e\u3044\u307e\u3059\u3002\n * Native(C,C++)\u306e\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u5185\u306b\u6697\u8a3c\u756a\u53f7\u3092\u8a18\u8f09\u3057\u3001\u305d\u308c\u3092Java\u304b\u3089\u547c\u3073\u51fa\u3059\u3053\u3068\u3067\u3001\u96a0\u853d\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n* \u9ad8\u901f\u5316\n * Android\u306eDalvik VM\uff08\u4eee\u60f3\u30de\u30b7\u30f3\u3067\uff09\u306f\u3001VM\u3067\u3042\u308b\u304c\u3086\u3048\u306b\u51e6\u7406\u901f\u5ea6\u3067\u8d8a\u3048\u3089\u308c\u306a\u3044\u58c1\u304c\u5b58\u5728\u3057\u307e\u3059\u3002\u3053\u306e\u8d8a\u3048\u3089\u308c\u306a\u3044\u58c1\u3092\u8d8a\u3048\u306a\u3051\u308c\u3070\u3044\u3051\u306a\u3044\u72b6\u6cc1\u306b\u9665\u3063\u305f\u6642\u306b\u3001OS\u304c\u76f4\u63a5\u5b9f\u884c\u3067\u304d\u308b\u30d0\u30a4\u30c8\u30b3\u30fc\u30c9\u306b\u3067\u304d\u308bNDK\u304c\u6709\u52b9\u3067\u3059\u3002\n * \u307b\u3068\u3093\u3069\u306e\u5834\u5408\u3001Java\u306e\u30d7\u30ed\u30b0\u30e9\u30e0\u306e\u6700\u9069\u5316\u3067\u6e08\u3080\u3068\u601d\u3044\u307e\u3059\u304c\u3001\u7aef\u672b\u5185\u3067\u753b\u50cf\u51e6\u7406\u3092\u884c\u3046\u306a\u3069\u306e\u5834\u5408\u306b\u306f\u3001\u9078\u629e\u80a2\u306b\u5165\u3063\u3066\u304f\u308b\u3068\u601d\u3044\u307e\u3059\u3002\n* iOS,Android\u3067\u306e\u30e9\u30a4\u30d6\u30e9\u30ea\u306e\u5171\u901a\u5316\n * C,C++\u3067\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u3092\u66f8\u304f\u3053\u3068\u304c\u3067\u304d\u308b\u306e\u3067\u3001iOS(Objective-C)\u304b\u3089\u3082\u8aad\u307f\u8fbc\u3080\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3057\u3001Android\u3067\u3082JNI\u306e\u578b\u306b\u30de\u30c3\u30c1\u3055\u305b\u308c\u3070\u3001\u8aad\u307f\u8fbc\u3080\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\u5185\u90e8\u30ed\u30b8\u30c3\u30af\u306f\u305d\u306e\u307e\u307e\u3067\u3001\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30a4\u30b9\u306e\u66f8\u304d\u63db\u3048\uff08\u3082\u3057\u304f\u306f\u3001\u30e9\u30c3\u30d7\uff09\u306e\u307f\u3067\u4e21OS\u304b\u3089\u3001\u5229\u7528\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n * \u6ce8\u610f\u70b9\u3068\u3057\u3066\u306f\u3001\u74b0\u5883\u306b\u3088\u3063\u3066\u30d0\u30a4\u30c8\u30aa\u30fc\u30c0\u30fc\uff08\u30d3\u30c3\u30b0\u30a8\u30f3\u30c7\u30a3\u30a2\u30f3\b, \u30ea\u30c8\u30eb\u30a8\u30f3\u30c7\u30a3\u30a2\u30f3\uff09\u304c\u7570\u306a\u308a\u307e\u3059\u3002\n\n\n## \u74b0\u5883\u69cb\u7bc9\uff082015/10/10\u73fe\u5728\uff09\n[Android NDK Preview](http://tools.android.com/tech-docs/android-ndk-preview)\nAndroid Studio 1.3\u4ee5\u4e0a\u3001Gradle 2.5\u4ee5\u4e0a\u304c\u5fc5\u9808\u306e\u3088\u3046\u3067\u3059\u3002\n\u4eca\u56de\u306f\u3001\u4ee5\u4e0b\u306e\u74b0\u5883\u3067\u8a66\u3057\u307e\u3057\u305f\u3002\n\n* Android Studio 1.4\n* Gradle 2.5\n* Android NDK r10e\n\n### Gradle\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u30a2\u30c3\u30d7\nAndroid Studio 1.4\u3067\u3001\u65b0\u898f\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092\u4f5c\u6210\u3057\u305f\u5834\u5408\u3001Gradle\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u306f\u30012.4\u3067\u3057\u305f\u3002\n 1. Android Studio\u3092\u8d77\u52d5\n 2. \u5de6\u30e1\u30cb\u30e5\u30fc\uff08Project\uff09\u306e\u300eapp\u300f\u3092<<\u53f3\u30af\u30ea\u30c3\u30af>>\u3001\u300eOpen Module Settings\u300f\u3092\u9078\u629e\u3057\u307e\u3059\u3002\n 3. \u300eProject\u300f\u306e\u201dGradle version\u201d\u3092[\u6700\u65b0\u306eGradle](http://services.gradle.org/distributions)\u306b\u3057\u307e\u3059\u3002\u4eca\u56de\u306f\u3001\u300e2.5\u300f\u3068\u5165\u529b\u3057\u307e\u3057\u305f\u3002\n 4. \"Gradle project sync in progress...\"\u3068\u8868\u793a\u3055\u308c\u3001\u81ea\u52d5\u7684\u306b\u30d0\u30fc\u30b8\u30e7\u30f3\u30a2\u30c3\u30d7\u304c\u884c\u308f\u308c\u307e\u3059\u3002\n 5. 5\u5206\u307b\u3069\u3067\u5b8c\u4e86\u3057\u307e\u3059\u3002\n\n### Android NDK\u306e\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\n 1. AndroidStudio\u3092\u8d77\u52d5\n 2. \u5de6\u30e1\u30cb\u30e5\u30fc\uff08Project\uff09\u306e\u300eapp\u300f\u3092<<\u53f3\u30af\u30ea\u30c3\u30af>>\u3001\u300eSDK Location\u300f\u3092\u9078\u629e\u3057\u307e\u3059\u3002\n 2. \"Android SDK Location:\"\u306e\u4e0b\u306b\u3042\u308b\u300eDownload Android NDK\u300f\u3092\u30af\u30ea\u30c3\u30af\u3057\u307e\u3059\u3002\n 3. 20\u5206\u307b\u3069\u3067\u5b8c\u4e86\u3057\u307e\u3059\u3002\n\n###Experimental Plugin\u306e\u9069\u7528\n[Experimental Plugin User Guide](http://tools.android.com/tech-docs/new-build-system/gradle-experimental)\n\n#### \u300egradle-wrapper.properties\u300f\u4fee\u6b63\n * \u5909\u66f4\u524d\n \n```./gradle/wrapper/gradle-wrapper.properties\ndistributionUrl=https\\://services.gradle.org/distributions/gradle-2.4-all.zip\n```\n\n * \u5909\u66f4\u5f8c\n\n```./gradle/wrapper/gradle-wrapper.properties\ndistributionUrl=https\\://services.gradle.org/distributions/gradle-2.5-all.zip\n```\n\n\n#### \u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306e\u300ebuild.gradle\u300f\u4fee\u6b63\n * \u5909\u66f4\b\u524d\n\n```./build.gradle\nbuildscript {\n    repositories {\n        jcenter()\n    }\n    dependencies {\n        classpath 'com.android.tools.build:gradle:1.3.0'\n    }\n}\n\n```\n * \u5909\u66f4\u5f8c\uff08\u5b9f\u9a13\u7684\u2026\u2026\u3002\u307e\u3041\u3001\u5b9f\u9a13\u597d\u304d\u3067\u3059\u3051\u3069\uff09\n\n```./build.gradle\nbuildscript {\n    repositories {\n        jcenter()\n    }\n    dependencies {\n        classpath 'com.android.tools.build:gradle-experimental:0.2.0'\n    }\n}\n\n```\n\n#### app\u306e\u300ebuild.gradle\u300f\u306e\u4fee\u6b63\n * \u5909\u66f4\u524d\n \n```./app/build.gradle\napply plugin: 'com.android.application'\n\nandroid {\n    compileSdkVersion 23\n    buildToolsVersion \"23.0.1\"\n\n    defaultConfig {\n        applicationId \"info.*****.sbx.ndk01\"\n        minSdkVersion 22\n        targetSdkVersion 23\n        versionCode 1\n        versionName \"1.0\"\n    }\n    buildTypes {\n        release {\n            minifyEnabled false\n            proguardFiles getDefaultProguardFile('proguard-android.txt'), 'proguard-rules.pro'\n        }\n    }\n}\n\ndependencies {\n    compile fileTree(dir: 'libs', include: ['*.jar'])\n    testCompile 'junit:junit:4.12'\n    compile 'com.android.support:appcompat-v7:23.0.1'\n    compile 'com.android.support:design:23.0.1'\n}\n```\n\n* \u5909\u66f4\u5f8c\n * plugin\u304c\u5909\u308f\u308b\u306e\u3067\u3001\u305d\u3082\u305d\u3082\u306eDSL\uff08\u8a18\u8ff0\u65b9\u6cd5\uff09\u304c\u5909\u308f\u308a\u307e\u3059\u3002\n * \u4eca\u56de\u306f\u3001\u300ehello.c\u300f\u3068\u3044\u3046\u30d5\u30a1\u30a4\u30eb\u3092\u300elibhello.so\u300f\u3068\u3044\u3046\u30c0\u30a4\u30ca\u30df\u30c3\u30af\u30ea\u30f3\u30af\u30e9\u30a4\u30d6\u30e9\u30ea\u306b\u30b3\u30f3\u30d1\u30a4\u30eb\u3057\u3066\u3001Android\u5185\u304b\u3089\u5229\u7528\u3059\u308b\u60f3\u5b9a\u3067\u3059\u3002\n\n```./app/build.gradle\napply plugin: 'com.android.model.application'\n\nmodel {\n    android {\n        compileSdkVersion = 23\n        buildToolsVersion = \"23.0.1\"\n\n        defaultConfig.with {\n            applicationId = \"info.*****.sbx.ndk01\"\n            minSdkVersion.apiLevel = 22\n            targetSdkVersion.apiLevel = 23\n        }\n    }\n\n    /*\n     * native build settings\n     */\n    android.ndk {\n        moduleName = \"hello\"\n        /*\n         * Other ndk flags configurable here are\n         * cppFlags += \"-fno-rtti\"\n         * cppFlags += \"-fno-exceptions\"\n         * ldLibs    = [\"android\", \"log\"]\n         * stl       = \"system\"\n         */\n    }\n    android.buildTypes {\n        release {\n            minifyEnabled = false\n            proguardFiles  += file('proguard-rules.txt')\n        }\n    }\n    android.productFlavors {\n        create(\"arm\") {\n            ndk.abiFilters += \"armeabi\"\n        }\n        create(\"arm7\") {\n            ndk.abiFilters += \"armeabi-v7a\"\n        }\n        create(\"arm8\") {\n            ndk.abiFilters += \"arm64-v8a\"\n        }\n        create(\"x86\") {\n            ndk.abiFilters += \"x86\"\n        }\n        create(\"x86-64\") {\n            ndk.abiFilters += \"x86_64\"\n        }\n        create(\"mips\") {\n            ndk.abiFilters += \"mips\"\n        }\n        create(\"mips-64\") {\n            ndk.abiFilters += \"mips64\"\n        }\n        // To include all cpu architectures, leaves abiFilters empty\n        create(\"all\")\n    }\n\n}\ndependencies {\n    compile fileTree(dir: 'libs', include: ['*.jar'])\n    compile 'com.android.support:appcompat-v7:23.0.1'\n    compile 'com.android.support:design:23.0.1'\n}\n```\n\n * \"Sync Now!\" \n\n## JNI(Java Native Interface)\u3067\u3001Hello World!\n### \u30e9\u30a4\u30d6\u30e9\u30ea\u30d5\u30a1\u30a4\u30eb\u306e\u4f5c\u6210\n* JNI\u7528\u306e\u30d5\u30a9\u30eb\u30c0\u3092\u4f5c\u6210\u3057\u307e\u3059\n * app/src/main/jni/\n* hello.c\u3092\u4f5c\u6210\u3057\u307e\u3059\n * \u30d8\u30c3\u30c0\u30d5\u30a1\u30a4\u30eb\uff08.h\uff09\u306f\u4e0d\u8981\u3002 \n * \u3053\u306e\u6642\u91cd\u8981\u306a\u306e\u306f\u95a2\u6570\u540d\u3067\u3059\u3002\u3053\u308c\u3092\u9593\u9055\u3048\u308b\u3068\u3001\u6642\u9593\u3060\u3051\u304c\u6d6a\u8cbb\u3055\u308c\u307e\u3059\u3002\n * JNI(Java Native Interface)\u306e\u540d\u304c\u793a\u3059\u901a\u308a\u3001\u30d3\u30eb\u30c9\u6642\u306b\u547d\u540d\u898f\u5247\u306b\u5f93\u3063\u3066\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30a4\u30b9\u3092\u30de\u30c3\u30d7\u3057\u3066\u304f\u308c\u307e\u3059\u3002\n * Java_{\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u30c7\u30a3\u30ec\u30af\u30c8\u30ea}_{\u547c\u3073\u51fa\u3057\u5143\u30af\u30e9\u30b9\u540d}_{\u30e1\u30bd\u30c3\u30c9\u540d}\n\n```cpp:app/src/main/jni/hello.c\n#include <string.h>\n#include <jni.h>\n\njstring\nJava_info_*****_sbx_ndk01_MainActivity_stringFromJNI( JNIEnv* env, jobject thiz ) {\n    return (*env)->NewStringUTF(env, \"Hello JNI !\");\n}\n```\n\n### MainActivity\u304b\u3089\u306e\u547c\u3073\u51fa\u3057\n```java:MainActivity.java\npublic class MainActivity extends AppCompatActivity {\n\n\t// hello.so\u306e\u8aad\u307f\u8fbc\u307f\n    static {\n        System.loadLibrary(\"hello\");\n    }\n\n\t// hello\u30e9\u30a4\u30d6\u30e9\u30ea\u306b\u3042\u308b\u30e1\u30bd\u30c3\u30c9\u306e\u5b9a\u7fa9\n    public native String  stringFromJNI();\n\n    @Override\n    protected void onCreate(Bundle savedInstanceState) {\n        super.onCreate(savedInstanceState);\n        setContentView(R.layout.activity_main);\n\n\t\t// \u30e1\u30bd\u30c3\u30c9\u306e\u547c\u3073\u51fa\u3057\n\t\t// Hello JNI !\u3068\u8868\u793a\u3055\u308c\u308b\n        Log.i(\"\", stringFromJNI());\n    }\n}\n\n```\n\n## \u53c2\u7167\n * [Android NDK](http://developer.android.com/ndk/index.html)\n * [Android NDK Sample](https://github.com/googlesamples/android-ndk)\n\n## \u3061\u3087\u3063\u3068\u3044\u3063\u3077\u304f\n* \u5b9f\u969b\u306e\u30c0\u30a4\u30ca\u30df\u30c3\u30af\u30ea\u30f3\u30af\u30e9\u30a4\u30d6\u30e9\u30ea\u306f\u3069\u3053\u306b\u3042\u308b\u306e\u304b\uff1f\n * \u30c7\u30d0\u30c3\u30b0\u30d3\u30eb\u30c9\u3060\u3068\u4ee5\u4e0b\u306e\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u3042\u308b\u3088\u3046\u3067\u3059\u3002\n * app/build/intermediates/binaries/debug/all/obj/armeabi-v7a/libhello.so\n* Eclipse + NDK\n * 3~4\u5e74\u524d\u3001\u5b9f\u969b\u306e\u88fd\u54c1\u3092\u4f5c\u3063\u305f\u6642\u306b\u306f\u3001Windows + Eclipse + NDK\u3067\u3001C\u30bd\u30fc\u30b9\u3092\u66f8\u304d\u63db\u3048\u308b\u305f\u3073\u306bCygwin\u3067\u30d3\u30eb\u30c9\u3057\u3066\u3001\u305d\u306e\u5f8c\u3001Eclipse\u3067\u30d3\u30eb\u30c9\u3057\u3066\u3001\u3068\u624b\u9593\u304c\u591a\u304b\u3063\u305f\u3067\u3059\u304c\u3001AndroidStudio\u3067\u306f\u3001\u4e8c\u3064\u306e\u30d3\u30eb\u30c9\u3092\u4e00\u6c17\u306b\u3084\u3063\u3066\u304f\u308c\u307e\u3059\u3002\n * \u57fa\u672c\u7684\u306b\u3001\u300e.so\u300f\u30d5\u30a1\u30a4\u30eb\u306b\u5909\u66f4\u304c\u306a\u3051\u308c\u3070\u3001\u305d\u306e\u307e\u307e\u30ea\u30ea\u30fc\u30b9\u3057\u3066\u3044\u307e\u3057\u305f\u304c\u3001\u4f55\u304b\u306e\u62cd\u5b50\u306b\u540c\u5c01\u3057\u5fd8\u308c\u3066\uff08\u8b66\u544a\u306f\u3067\u306a\u3044\uff09\u3059\u3068\u3093\u3068\u843d\u3061\u3066\u3044\u305f\u3068\u3044\u3046\u3053\u3068\u304c\u3042\u308a\u307e\u3057\u305f\u3002AndroidStudio\u3067\u306f\u3001\u30ef\u30f3\u30b9\u30c8\u30c3\u30d7\u306a\u306e\u3067\u3001\u304d\u3063\u3068\u305d\u3093\u306a\u3053\u3068\u3082\u306a\u304f\u306a\u308b\u3067\u3057\u3087\u3046\u3002\n* \u4f7f\u3044\u6240\n *  Google\u306e\u30b5\u30f3\u30d7\u30eb\u3092\u898b\u308b\u9650\u308a\u3001\u3084\u306f\u308a\u30de\u30eb\u30c1\u30e1\u30c7\u30a3\u30a2\uff08\u97f3\u58f0\u3001\u753b\u50cf\u30013D\u30e2\u30c7\u30ea\u30f3\u30b0\uff09\u306e\u6271\u3044\u304c\u591a\u3044\u3088\u3046\u3067\u3059\u3002\n\n\n## \u3064\u3065\u304f\n * JNI\u306e\u578b\u3068\u30c7\u30fc\u30bf\u69cb\u9020\uff08\u4e88\u5b9a\uff09\n * \u30c7\u30d0\u30c3\u30b0\u65b9\u6cd5\uff08\u4e88\u5b9a\uff09\n * NDK\u3092\u5229\u7528\u3057\u305f\u6697\u8a3c\u756a\u53f7\u306e\u96a0\u853d\uff08\u4e88\u5b9a\uff09\n"}