{"context": "https://hexdocs.pm/ecto/getting-started.html (Ecto v2.0.5) \u306e\u7ffb\u8a33\u306b\u306a\u308a\u307e\u3059\u3002\n\u8a33\u304c\u9593\u9055\u3063\u3066\u3044\u308b\u3001\u629c\u3051\u3066\u3044\u308b\u306a\u3069\u306e\u7b87\u6240\u306a\u3069\u3092\u898b\u3064\u3051\u305f\u3089\u6307\u6458\u3057\u3066\u3044\u305f\u3060\u3051\u308b\u3068\u52a9\u304b\u308a\u307e\u3059\u3002\n\n\nGetting Started\n\u3053\u306e\u30ac\u30a4\u30c9\u306fElixir\u306e\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u30e9\u30c3\u30d1\u30fc\u53ca\u3073\u30af\u30a8\u30ea\u30b8\u30a7\u30cd\u30ec\u30fc\u30bfEcto\u3078\u306e\u30a4\u30f3\u30c8\u30ed\u30c0\u30af\u30b7\u30e7\u30f3\u3067\u3059\u3002Ecto\u306f\u3001Elixir\u30c7\u30d9\u30ed\u30c3\u30d1\u30fc\u304c\u3069\u3093\u306a\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3092\u4f7f\u3063\u3066\u3044\u3088\u3046\u3068\u540c\u3058\u3088\u3046\u306a\u65b9\u6cd5\u3067\u30af\u30a8\u30ea\u306b\u3088\u308b\u554f\u3044\u5408\u308f\u305b\u304c\u3067\u304d\u308b\u3088\u3046\u306b\u3001\u6a19\u6e96\u5316\u3055\u308c\u305fAPI\u3068\u62bd\u8c61\u5316\u3055\u308c\u305f\u65b9\u6cd5\u3092\u63d0\u4f9b\u3057\u3066\u3044\u307e\u3059\u3002\n\u3053\u306e\u30ac\u30a4\u30c9\u3067\u306f\u3001PostgreSQL\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306e\u30ec\u30b3\u30fc\u30c9\u306e\u4f5c\u6210\u30fb\u8aad\u307f\u8fbc\u307f\u30fb\u66f4\u65b0\u30fb\u524a\u9664\u306e\u3088\u3046\u306a\u57fa\u672c\u7684\u306a\u3053\u3068\u306b\u3064\u3044\u3066\u5b66\u3079\u307e\u3059\u3002\u3082\u3057\u3053\u306e\u30ac\u30a4\u30c9\u4e2d\u306e\u30b3\u30fc\u30c9\u3092\u898b\u305f\u3051\u308c\u3070\u3001\u3053\u3053(at ecto/examples/friends on GitHub)\u306e\u30b3\u30fc\u30c9\u3092\u898b\u3066\u304f\u3060\u3055\u3044\u3002\n\u3053\u306e\u30ac\u30a4\u30c9\u306f\u4e8b\u524d\u306bPostgreSQL\u304c\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\u3055\u308c\u3066\u3044\u308b\u306e\u3092\u524d\u63d0\u3068\u3057\u3066\u3044\u307e\u3059\n\nEcto\u306e\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3078\u306e\u8ffd\u52a0\n\u624b\u59cb\u3081\u306b\u3001\u65b0\u3057\u3044Elixir\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u4f5c\u308b\u305f\u3081\u3001\u4ee5\u4e0b\u306e\u30b3\u30de\u30f3\u30c9\u3092\u4f7f\u3044\u307e\u3059\u3002\nmix new friends --sup\n\n--sup \u30aa\u30d7\u30b7\u30e7\u30f3\u306f\u3053\u306e\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u304ca supervision tree\u3092\u6301\u3063\u3066\u3044\u308b\u3053\u3068\u78ba\u8a8d\u3057\u307e\u3059\u3002\u3053\u308c\u306f\u5c11\u3057\u5f8c\u3067\u5fc5\u8981\u306b\u306a\u308a\u307e\u3059\u3002\n\u3053\u306e\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306bEcto\u3092\u8ffd\u52a0\u3059\u308b\u306e\u306b\u3044\u304f\u3064\u304b\u306e\u30b9\u30c6\u30c3\u30d7\u3092\u8e0f\u3080\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\u6700\u521d\u306e\u30b9\u30c6\u30c3\u30d7\u306fmix.exs \u30d5\u30a1\u30a4\u30eb\u306e deps \u3092\u5909\u66f4\u3057\u3066\u3001Ecto\u3068Postgrex\u3068\u3044\u3046\u30c9\u30e9\u30a4\u30d0\u3092 \u8ffd\u52a0\u3059\u308b\u3053\u3068\u3067\u3059\u3002\ndefp deps do\n  [{:ecto, \"~> 2.0\"},\n   {:postgrex, \"~> 0.11\"}]\nend\n\nEcto\u306f\u4e00\u822c\u7684\u306a\u30af\u30a8\u30eaAPI\u3092\u63d0\u4f9b\u3057\u307e\u3059\u304c\u3001Ecto\u304cPostgreSQL\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u304c\u89e3\u91c8\u3067\u304d\u308b\u8a9e\u3067\u8a71\u3059\u305f\u3081\u306bPostgrex\u30c9\u30e9\u30a4\u30d0\u3092\u5fc5\u8981\u3068\u3057\u307e\u3059\u3002\n\u4ee5\u4e0a\u306e\u4f9d\u5b58\u30d5\u30a1\u30a4\u30eb\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\u305f\u3081\u306b\u306f\u3001\u4ee5\u4e0b\u306e\u30b3\u30de\u30f3\u30c9\u3092\u4f7f\u3044\u307e\u3059\u3002\nmix deps.get\n\n\u540c\u69d8\u306b\u540c\u3058\u30d5\u30a1\u30a4\u30eb\u3067\u3001ecto \u3068 postgrex \u3092 applications\u306e\u30ea\u30b9\u30c8\u306b\u8ffd\u52a0\u3057\u307e\u3059\u3002\ndef application do\n  [applications: [:logger, :ecto, :postgrex],\n   mod: {Friends, []}]\nend\n\nPostgrex\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306fEcto\u304b\u3089\u30af\u30a8\u30ea\u3092\u53d7\u3051\u53d6\u308a\u3001\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306b\u5bfe\u3057\u3066\u30af\u30a8\u30ea\u3092\u5b9f\u884c\u3057\u307e\u3059\u3002\u3082\u3057\u3053\u306e\u30b9\u30c6\u30c3\u30d7\u3092\u8e0f\u307e\u306a\u3051\u308c\u3070\u3001\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306b\u5bfe\u3059\u308b\u554f\u3044\u5408\u308f\u305b\u306f\u307e\u3063\u305f\u304f\u3067\u304d\u306a\u3044\u3067\u3057\u3087\u3046\u3002\n\u4e8c\u756a\u76ee\u306e\u30b9\u30c6\u30c3\u30d7\u306b\u79fb\u308a\u307e\u3057\u3087\u3046\u3002Ecto\u3068Postgrex\u3092\u4f9d\u5b58\u95a2\u4fc2\u306b\u7d44\u307f\u8fbc\u3093\u3060\u3042\u3068\u306f\u3001\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u30b3\u30fc\u30c9\u3067\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3092\u64cd\u4f5c\u3059\u308b\u305f\u3081\u306b\u3044\u304f\u3064\u304b\u8a2d\u5b9a\u304c\u5fc5\u8981\u3067\u3059\u3002\n\u3053\u306e\u8a2d\u5b9a\u306b\u306f\u4ee5\u4e0b\u306e\u30b3\u30de\u30f3\u30c9\u3092\u4f7f\u7528\u3057\u307e\u3059\u3002\nmix ecto.gen.repo -r Friends.Repo\n\n\u3053\u306e\u30b3\u30de\u30f3\u30c9\u306f\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3068\u63a5\u7d9a\u3059\u308b\u305f\u3081\u306e\u8a2d\u5b9a\u3092\u751f\u6210\u3057\u307e\u3059\u3002config/config.exs \u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u8a2d\u5b9a\u306b\u306a\u308a\u307e\u3059\u3002\nconfig :friends, Friends.Repo,\n  adapter: Ecto.Adapters.Postgres,\n  database: \"friends_repo\",\n  username: \"user\",\n  password: \"pass\",\n  hostname: \"localhost\"\n\nNOTE: PostgreSQL\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306f\n\n\u30e6\u30fc\u30b6\u30fc\u540d\u30fb\u30d1\u30b9\u30ef\u30fc\u30c9\u3092\u5fc5\u8981\u3068\u3057\u306a\u3044\u3088\u3046\u306b\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\u3059\u308b\u3053\u3068\u3082\u3067\u304d\u307e\u3059\u3002\u3082\u3057\u4e0a\u306e\u8a2d\u5b9a\u3067\u3046\u307e\u304f\u3044\u304b\u306a\u3044\u306a\u3089\u3001username/password \u306e\u30d5\u30a3\u30fc\u30eb\u30c9\u3092\u53d6\u308a\u9664\u304f\u304b\u3001\u3069\u3061\u3089\u3082\"postgres\"\u3068\u30bb\u30c3\u30c8\u3059\u308c\u3070\u826f\u3044\u3067\u3059\u3002\n\u975e\u6a19\u6e96\u7684\u306a\u30dd\u30fc\u30c8\u3067\u52d5\u4f5c\u3055\u305b\u308b\u3088\u3046\u306b\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\u3059\u308b\u3053\u3068\u3082\u3067\u304d\u307e\u3059\u3002port: 15432 \u306e\u3088\u3046\u306b\u30dd\u30fc\u30c8\u756a\u53f7\u3092\u6307\u5b9a\u3059\u308c\u3070\u826f\u3044\u3067\u3059\u3002\n\n\u3053\u306e\u8a2d\u5b9a\u306b\u3088\u308a \"friends\" \u3068\u540d\u4ed8\u3051\u305f\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3078\u3069\u306e\u3088\u3046\u306b\u63a5\u7d9a\u3059\u308b\u304b\u3092\u6c7a\u3081\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\u53b3\u5bc6\u306b\u8a00\u3048\u3070 \"repo\" \u3092\u8a2d\u5b9a\u3057\u3066\u3044\u308b\u3002\u3088\u308a\u8a73\u3057\u3044\u60c5\u5831\u306fEcto.Repo can be found in its documentation\u3092\u53c2\u7167\u3059\u308b\u3068\u826f\u3044\u3067\u3059\u3002\nFriends.Repo \u30e2\u30b8\u30e5\u30fc\u30eb\u306f mix ecto.gen.repo \u30b3\u30de\u30f3\u30c9\u3067 lib/friends/repo.ex \u306b\u5b9a\u7fa9\u3055\u308c\u3066\u3044\u307e\u3059\u3002\ndefmodule Friends.Repo do\n  use Ecto.Repo, otp_app: :friends\nend\n\n\u3053\u306e\u30e2\u30b8\u30e5\u30fc\u30eb\u306f\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306b\u554f\u3044\u5408\u308f\u305b\u3092\u3059\u308b\u305f\u3081\u306b\u4f7f\u3046\u3082\u306e\u3067\u3059\u3002\u3053\u306e\u30e2\u30b8\u30e5\u30fc\u30eb\u306f Ecto.Repo \u30e2\u30b8\u30e5\u30fc\u30eb\u3092\u4f7f\u3044\u3001otp_app \u306fEcto\u306b\u3069\u306eElixir\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306e\u8a2d\u5b9a\u3092\u63a2\u3059\u304b\u3092\u4f1d\u3048\u307e\u3059\u3002\u4eca\u56de\u306e\u30ac\u30a4\u30c9\u306e\u5834\u5408\u3001Ecto\u304c\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3092\u898b\u3064\u3051\u308b\u3053\u3068\u304c\u3067\u304d\u308b\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092 :friends \u306b\u6307\u5b9a\u3057\u3066\u3044\u308b\u306e\u3067Ecto\u306f\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\u6e08\u307f\u306e\u8a2d\u5b9a\u3092\u4f7f\u3046\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\u3053\u306e\u8a2d\u5b9a\u306e\u6700\u5f8c\u306e\u30d4\u30fc\u30b9\u306f\u3001Friends.Repo \u3092\u30b9\u30fc\u30d1\u30fc\u30d0\u30a4\u30b6\u30fc\u3068\u3057\u3066\u76e3\u8996\u30c4\u30ea\u30fc\u306b\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\u3059\u308b\u3053\u3068\u3067\u3059\u3002lib/friends.ex \u306e start/2 \u95a2\u6570\u306e\u4e2d\u3067\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\u306f\u3067\u304d\u307e\u3059\u3002\ndef start(_type, _args) do\n  import Supervisor.Spec, warn: false\n\n  children = [\n    supervisor(Friends.Repo, []),\n  ]\n\n  ...\n\n\u3053\u306e\u8a2d\u5b9a\u306fEcto\u30d7\u30ed\u30bb\u30b9\u3092\u958b\u59cb\u3055\u305b\u3001\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u30af\u30a8\u30ea\u306e\u53d7\u3051\u53d6\u308a\u53ca\u3073\u5b9f\u884c\u3059\u308b\u3053\u3068\u3092\u53ef\u80fd\u306b\u3057\u307e\u3059\u3002\u3053\u306e\u8a2d\u5b9a\u306a\u3057\u3067\u306f\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306b\u554f\u3044\u5408\u308f\u305b\u3059\u308b\u3053\u3068\u306f\u5168\u304f\u3067\u304d\u306a\u3044\u3067\u3057\u3087\u3046!\n\u6700\u5f8c\u306b\u30b8\u30a7\u30cd\u30ec\u30fc\u30bf\u304c\u81ea\u52d5\u3067\u52a0\u3048\u3066\u304f\u308c\u305f\u308a\u306f\u3057\u306a\u3044\u306e\u3067\u3001\u81ea\u5206\u81ea\u8eab\u3092config/config.exs \u306b\u4ee5\u4e0b\u306e\u30b3\u30fc\u30c9\u3092\u8ffd\u52a0\u3057\u307e\u3059\u3002\nconfig :friends, ecto_repos: [Friends.Repo]\n\n\u3053\u306e\u30b3\u30fc\u30c9\u306b\u3088\u3063\u3066\u3001mix ecto.create \u306a\u3069\u306e\u30b3\u30de\u30f3\u30c9\u3092\u52d5\u4f5c\u3055\u305b\u308b repo \u306b\u3064\u3044\u3066\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306b\u4f1d\u3048\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\u4ee5\u4e0a\u306e\u8a2d\u5b9a\u3067\u3001\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306b\u554f\u3044\u5408\u308f\u305b\u3092\u884c\u3046\u3053\u3068\u304c\u3067\u304d\u308b\u3088\u3046\u306b\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u8a2d\u5b9a\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3057\u305f\u3002\u7d9a\u3044\u3066\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u30fb\u30c6\u30fc\u30d6\u30eb\u3092\u4f5c\u6210\u3057\u3066\u554f\u3044\u5408\u308f\u305b\u3092\u884c\u3063\u3066\u307f\u307e\u3057\u3087\u3046\u3002\n\n\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306e\u8a2d\u5b9a\n\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3078\u554f\u3044\u5408\u308f\u305b\u3092\u3059\u308b\u305f\u3081\u306b\u306f\u3001\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u304c\u5b58\u5728\u3057\u3066\u306a\u3051\u308c\u3070\u306a\u308a\u307e\u305b\u3093\u3002\u6b21\u306e\u30b3\u30de\u30f3\u30c9\u3067\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\nmix ecto.create\n\n\u3082\u3057\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u304c\u3059\u3067\u306b\u4f5c\u3089\u308c\u3066\u3044\u308b\u306a\u3089\u3070\u3001\u6b21\u306e\u30e1\u30c3\u30bb\u30fc\u30b8\u304c\u8868\u793a\u3055\u308c\u307e\u3059\u3002\nThe database for Friends.Repo has been created.\n\nNOTE: \u3082\u3057\u30a8\u30e9\u30fc\u306b\u306a\u3063\u3066\u3057\u307e\u3063\u305f\u3089\u3001\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3078\u306e\u8a8d\u8a3c\u304c\u901a\u308b\u3088\u3046\u306b config/config.exs \u306e\u8a2d\u5b9a\u3092\u5909\u66f4\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\n\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3060\u3051\u3067\u306f\u554f\u3044\u5408\u308f\u305b\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u306a\u3044\u306e\u3067\u3001\u6b21\u306b\u30c6\u30fc\u30d6\u30eb\u3092\u4f5c\u308a\u307e\u3059\u3002\u30c6\u30fc\u30d6\u30eb\u3092\u4f5c\u308b\u306b\u306f migration \u3092\u884c\u3044\u307e\u3059\u3002\u3082\u3057Active Record\u3084\u305d\u306e\u985e\u4f3c\u54c1\u3092\u77e5\u3063\u3066\u3044\u308b\u306a\u3089\u898b\u305f\u3053\u3068\u304c\u3042\u308b\u3067\u3057\u3087\u3046\u3002\u30de\u30a4\u30b0\u30ec\u30fc\u30b7\u30e7\u30f3\u306f\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3092\u69cb\u6210\u3059\u308b\u904e\u7a0b\u306e\u4e00\u3064\u306e\u30b9\u30c6\u30c3\u30d7\u3067\u3059\u3002\n\u30de\u30a4\u30b0\u30ec\u30fc\u30b7\u30e7\u30f3\u306f\u6b21\u306e\u30b3\u30de\u30f3\u30c9\u3067\u4f5c\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\nmix ecto.gen.migration create_people\n\n\u3053\u306e\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3059\u308b\u3068 priv/repo/migrations \u306b\u65b0\u3057\u3044\u30de\u30a4\u30b0\u30ec\u30fc\u30b7\u30e7\u30f3\u7528\u306e\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u306f\u7a7a\u30d5\u30a1\u30a4\u30eb\u306b\u306a\u308a\u307e\u3059\u3002\ndefmodule Friends.Repo.Migrations.CreatePeople do\n  use Ecto.Migration\n\n  def change do\n\n  end\nend\n\n\u3044\u304f\u3064\u304b\u306e\u30ab\u30e9\u30e0\u3092\u6301\u3063\u305f \"people\" \u30c6\u30fc\u30d6\u30eb\u3092\u4f5c\u308b\u306b\u306f\u3001\u3053\u306e\u30d5\u30a1\u30a4\u30eb\u306b\u3044\u304f\u3064\u304b\u30b3\u30fc\u30c9\u3092\u8ffd\u52a0\u3057\u307e\u3059\u3002\ndefmodule Friends.Repo.Migrations.CreatePeople do\n  use Ecto.Migration\n\n  def change do\n    create table(:people) do\n      add :first_name, :string\n      add :last_name, :string\n      add :age, :integer\n    end\n  end\nend\n\n\u3053\u306e\u65b0\u3057\u3044\u30b3\u30fc\u30c9\u306b\u3088\u3063\u3066 people \u3068\u540d\u4ed8\u3051\u305f\u65b0\u3057\u3044\u30c6\u30fc\u30d6\u30eb\u3092\u4f5c\u308b\u3088\u3046\u306bEcto\u306b\u4f1d\u3048\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002first_name\u3001last_name\u3001age \u304c\u30ab\u30e9\u30e0\u3068\u3057\u3066\u8ffd\u52a0\u3055\u308c\u307e\u3059\u3002\u3053\u306e\u30d5\u30a3\u30fc\u30eb\u30c9\u306e\u578b\u306f string \u3068 integer \u3067\u3059\u3002(Ecto\u304c\u30b5\u30dd\u30fc\u30c8\u3059\u308b\u578b\u306fEcto.Schema\u3067\u898b\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059)\nNOTE: Ecto\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306e\u30c6\u30fc\u30d6\u30eb\u306e\u30cd\u30fc\u30df\u30f3\u30b0\u30eb\u30fc\u30eb\u306f\u8907\u6570\u5f62\u3067\u3059\u3002\n\u4f5c\u6210\u3057\u305f\u30de\u30a4\u30b0\u30ec\u30fc\u30b7\u30e7\u30f3\u3092\u5b9f\u884c\u3057\u3066 people \u30c6\u30fc\u30d6\u30eb\u3092\u4f5c\u308b\u306b\u306f\u6b21\u306e\u30b3\u30de\u30f3\u30c9\u304c\u5fc5\u8981\u3067\u3059\u3002\nmix ecto.migrate\n\n\u30de\u30a4\u30b0\u30ec\u30fc\u30b7\u30e7\u30f3\u306b\u30df\u30b9\u3092\u898b\u3064\u3051\u305f\u3068\u304d\u306f\u3001mix ecto.rollback \u3067\u305d\u306e\u30de\u30a4\u30b0\u30ec\u30fc\u30b7\u30e7\u30f3\u306e\u5909\u66f4\u3092\u6253\u3061\u6d88\u3059\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\u30de\u30a4\u30b0\u30ec\u30fc\u30b7\u30e7\u30f3\u3092\u4fee\u6b63\u3057\u305f\u3089\u518d\u3073 mix ecto.migrate \u3092\u5b9f\u884c\u3057\u307e\u3059\u3002mix ecto.rollback \u3092\u4e00\u5ea6\u5b9f\u884c\u3057\u3066\u307f\u308b\u3068\u3001\u4f5c\u3089\u308c\u305f\u30c6\u30fc\u30d6\u30eb\u304c\u524a\u9664\u3055\u308c\u308b\u306e\u304c\u308f\u304b\u308b\u3067\u3057\u3087\u3046\u3002\n\u3053\u3053\u307e\u3067\u3067\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306b\u30c6\u30fc\u30d6\u30eb\u3092\u4f5c\u6210\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3057\u305f\u3002\u6b21\u306e\u30b9\u30c6\u30c3\u30d7\u3067\u306f\u30b9\u30ad\u30fc\u30de\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\n\u30b9\u30ad\u30fc\u30de\u306e\u4f5c\u6210\n\u30b9\u30ad\u30fc\u30de\u306f\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306e\u30c7\u30fc\u30bf\u3092Elixir\u3067\u8868\u73fe\u3057\u305f\u3082\u306e\u3067\u3059\u3002\u30b9\u30ad\u30fc\u30de\u306f\u4e00\u822c\u7684\u306b\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306e\u30c6\u30fc\u30d6\u30eb\u3068\u95a2\u9023\u4ed8\u3051\u3089\u308c\u3066\u3044\u307e\u3059\u304c\u3001\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306e\u30d3\u30e5\u30fc\u3068\u3082\u540c\u69d8\u4ed8\u3051\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\nlib/friends/person.ex \u306b\u30b9\u30ad\u30fc\u30de\u3092\u4f5c\u3063\u3066\u307f\u307e\u3057\u3087\u3046\u3002\ndefmodule Friends.Person do\n  use Ecto.Schema\n\n  schema \"people\" do\n    field :first_name, :string\n    field :last_name, :string\n    field :age, :integer\n  end\nend\n\n\u3053\u306e\u30b3\u30fc\u30c9\u3067\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306e\u30b9\u30ad\u30fc\u30de\u3068\u5bfe\u5fdc\u3059\u308b\u30b9\u30ad\u30fc\u30de\u3092\u5b9a\u7fa9\u3067\u304d\u307e\u3059\u3002\u3053\u306e\u5834\u5408\u3001Friends.Person \u30b9\u30ad\u30fc\u30de\u306f\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306e people \u30c6\u30fc\u30d6\u30eb\u3001first_name\u30fblast_name\u30fbage \u30d5\u30a3\u30fc\u30eb\u30c9\u3068\u95a2\u9023\u4ed8\u3051\u3089\u308c\u307e\u3059\u3002\nEcto\u306e\u30cd\u30fc\u30df\u30f3\u30b0\u5909\u63db\u306f\u5358\u6570\u5f62\u306e\u305f\u3081\u3001\u3053\u306e\u30b9\u30ad\u30fc\u30de\u3092 Person \u3068\u547c\u3073\u307e\u3059\u3002\n\u3053\u306e\u30b9\u30ad\u30fc\u30de\u306f iex-S mix \u3067\u8d77\u52d5\u3057\u305fIEx\u30bb\u30c3\u30b7\u30e7\u30f3\u3067\u8a66\u3057\u3066\u307f\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\u6b21\u306e\u30b3\u30fc\u30c9\u3092\u5b9f\u884c\u3057\u3066\u307f\u307e\u3057\u3087\u3046\u3002\nperson = %Friends.Person{}\n\n\u3053\u306e\u30b3\u30fc\u30c9\u3067\u65b0\u3057\u304f Friends.Person \u306e\u69cb\u9020\u3092\u6301\u3061\u5404\u30d5\u30a3\u30fc\u30eb\u30c9\u304c nil \u306e\u69cb\u9020\u4f53\u304c\u5f97\u3089\u308c\u307e\u3059\u3002\u3053\u308c\u3089\u306e\u30d5\u30a3\u30fc\u30eb\u30c9\u306f\u65b0\u3057\u304f\u69cb\u9020\u4f53\u3092\u4f5c\u308b\u3053\u3068\u3067\u5024\u3092\u30bb\u30c3\u30c8\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\nperson = %Friends.Person{age: 28}\n\n\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u6587\u6cd5\u3067\u3082\u540c\u69d8\u3067\u3059\u3002\n%{person | age: 28}\n\n\u69cb\u9020\u4f53\u306e\u5024\u306f\u4ee5\u4e0b\u306e\u6587\u6cd5\u3067\u5f97\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\nperson.age # => 28\n\n\u6b21\u306b\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306b\u3069\u306e\u3088\u3046\u306b\u30c7\u30fc\u30bf\u3092\u633f\u5165\u3059\u308b\u304b\u3092\u898b\u3066\u3044\u304d\u307e\u3057\u3087\u3046\u3002\n\n\u30c7\u30fc\u30bf\u306e\u633f\u5165\npeople \u30c6\u30fc\u30d6\u30eb\u306b\u6b21\u306e\u30b3\u30fc\u30c9\u3067\u65b0\u3057\u3044\u30ec\u30b3\u30fc\u30c9\u3092\u633f\u5165\u3067\u304d\u307e\u3059\u3002\nperson = %Friends.Person{}\nFriends.Repo.insert(person)\n\n\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306b\u30c7\u30fc\u30bf\u3092\u633f\u5165\u3059\u308b\u306b\u306f\u3001Friends.Repo \u306e insert \u3092\u547c\u3073\u51fa\u3057\u307e\u3059\u3002\u3053\u306e\u30e2\u30b8\u30e5\u30fc\u30eb\u306f\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3092\u4f7f\u7528\u3059\u308b\u306e\u306b Ecto \u3092\u4f7f\u7528\u3057\u3066\u3044\u307e\u3059\u3002\u3053\u306e\u95a2\u6570\u306f Ecto \u306b Friends.Repo \u306b\u5bfe\u5fdc\u3059\u308b\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306b \u65b0\u3057\u3044 Friends.Person \u30ec\u30b3\u30fc\u30c9\u3092\u633f\u5165\u3057\u305f\u3044\u3053\u3068\u3092\u4f1d\u3048\u307e\u3059\u3002\u3053\u3053\u3067\u306e person \u69cb\u9020\u4f53\u306f\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306b\u633f\u5165\u3057\u305f\u3044\u30c7\u30fc\u30bf\u3092\u8868\u3057\u3066\u3044\u307e\u3059\u3002\n\u633f\u5165\u304c\u6210\u529f\u3057\u305f\u5834\u5408\u306f\u6b21\u306e\u3088\u3046\u306a\u30bf\u30d7\u30eb\u3092\u8fd4\u3057\u307e\u3059\u3002\n{:ok,\n %Friends.Person{__meta__: #Ecto.Schema.Metadata<:loaded>, age: nil,\n  first_name: nil, id: 1, last_name: nil}}\n\n:ok \u30a2\u30c8\u30e0\u306f\u30c7\u30fc\u30bf\u633f\u5165\u304c\u6210\u529f\u3057\u305f\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\u305f\u3081\u306b\u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u3067\u4f7f\u3046\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\u633f\u5165\u304c\u5931\u6557\u3059\u308b\u30b7\u30c1\u30e5\u30a8\u30fc\u30b7\u30e7\u30f3\u306f\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u4e0a\u3067\u5236\u7d04\u304c\u3042\u308b\u5834\u5408\u3067\u3059\u3002\u4f8b\u3048\u3070\u3001\u3082\u3057\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u304c email \u304c\u4e00\u4eba\u306e\u30ec\u30b3\u30fc\u30c9\u306e\u307f\u306b\u4f7f\u308f\u308c\u308b\u3088\u3046\u306b\u3059\u308b\u305f\u3081\u306b\u3001\u30e6\u30cb\u30fc\u30af\u5236\u7d04\u3092 email \u30d5\u30a3\u30fc\u30eb\u30c9\u306b\u304b\u3051\u3066\u3044\u305f\u3089\u633f\u5165\u306f\u5931\u6557\u3059\u308b\u3067\u3057\u3087\u3046\u3002\n\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306b\u633f\u5165\u3057\u305f\u30ec\u30b3\u30fc\u30c9\u3092\u53c2\u7167\u3057\u305f\u3044\u5834\u5408\u3001\u30bf\u30d7\u30eb\u306b\u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u3059\u308b\u3088\u3046\u306b\u3059\u308b\u3068\u826f\u3044\u3067\u3059\u3002\n{:ok, person} = Friends.Repo.insert person\n\n\n\u5909\u66f4\u306e\u691c\u8a3c(\u30d0\u30ea\u30c7\u30fc\u30b7\u30e7\u30f3)\nEcto \u3067\u306f\u3001\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306b\u5909\u66f4\u304c\u4f1d\u308f\u308b\u524d\u306b\u3001\u5909\u66f4\u306b\u30d0\u30ea\u30c7\u30fc\u30b7\u30e7\u30f3\u3092\u304b\u3051\u305f\u3044\u3068\u601d\u3046\u3067\u3057\u3087\u3046\u3002\u4f8b\u3048\u3070\u3001\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306b\u30ec\u30b3\u30fc\u30c9\u306e\u60c5\u5831\u304c\u884c\u304f\u524d\u306b\u3001\u4e00\u4eba\u306e\u4eba\u304c\u82d7\u5b57\u3068\u540d\u524d\u3092\u6301\u3063\u3066\u3044\u308b\u3053\u3068\u3092\u671b\u3080\u3068\u3057\u307e\u3057\u3087\u3046\u3002\u3053\u308c\u3092\u691c\u8a3c\u3059\u308b\u305f\u3081\u306b Ecto \u306f changesets \u3092\u6301\u3063\u3066\u3044\u307e\u3059\u3002\nlib/friends/person.ex \u306e Friends.Person \u30e2\u30b8\u30e5\u30fc\u30eb\u306b changeset \u3092\u8ffd\u52a0\u3057\u307e\u3057\u3087\u3046\u3002\ndef changeset(person, params \\\\ %{}) do\n  person\n  |> Ecto.Changeset.cast(params, [:first_name, :last_name, :age])\n  |> Ecto.Changeset.validate_required([:first_name, :last_name])\nend\n\nchangeset \u306f person \u3068\u30d1\u30e9\u30e1\u30fc\u30bf\u30fc\u30bb\u30c3\u30c8\u3092\u5f15\u6570\u306b\u53d6\u308a\u307e\u3059\u3002\u3053\u306e\u30d1\u30e9\u30e1\u30fc\u30bf\u30fc\u30bb\u30c3\u30c8\u306f person \u306b\u5bfe\u3057\u3066\u884c\u3044\u305f\u3044\u5909\u66f4\u3067\u3059\u3002changeset \u95a2\u6570\u306f\u6e21\u3055\u308c\u305f\u30d1\u30e9\u30e1\u30fc\u30bf\u30fc\u304b\u3089 first_name \u3068 last_name \u30ad\u30fc\u3092\u30ad\u30e3\u30b9\u30c8\u3057\u307e\u3059\u3002\u30ad\u30e3\u30b9\u30c8\u306f\u3069\u306e\u30d1\u30e9\u30e1\u30fc\u30bf\u30fc\u304c\u5909\u66f4\u306b\u542b\u307e\u308c\u3066\u826f\u3044\u304b\u3092\u6c7a\u3081\u3001\u30ea\u30b9\u30c8\u306b\u542b\u307e\u308c\u3066\u3044\u306a\u3044\u3082\u306e\u306f\u7121\u8996\u3055\u308c\u307e\u3059\u3002\n\u6b21\u306e\u884c\u3067\u306f\u3001validate_required \u3092\u547c\u3073\u51fa\u3057\u307e\u3059\u3002\u3053\u308c\u306f first_name \u3068 last_name \u304c\u5024\u3092\u6301\u3063\u3066\u3044\u308b\u3053\u3068\u3092\u671f\u5f85\u3057\u307e\u3059\u3002\u3053\u306e changeset \u3092\u4f7f\u3063\u3066\u3001first_name \u3068 last_name \u304c\u306a\u3044\u65b0\u3057\u3044\u30ec\u30b3\u30fc\u30c9\u3092\u4f5c\u308d\u3046\u3068\u3057\u3066\u307f\u307e\u3057\u3087\u3046\u3002\nperson = %Friends.Person{}\nchangeset = Friends.Person.changeset(person, %{})\nFriends.Repo.insert(changeset)\n\n\u6700\u521d\u306e\u884c\u3067\u306f\u3001Friends.Person \u30e2\u30b8\u30e5\u30fc\u30eb\u304b\u3089\u69cb\u9020\u4f53\u3092\u4f5c\u6210\u3057\u3066\u3044\u307e\u3059\u3002\u5c11\u3057\u524d\u306b\u898b\u305f\u3070\u304b\u308a\u3060\u304b\u3089\u899a\u3048\u3066\u3044\u308b\u3067\u3057\u3087\u3046\u3002\u6b21\u306e\u884c\u3067\u306f changeset \u3092\u5b9a\u7fa9\u3059\u308b\u3068\u3044\u3046\u65b0\u3057\u3044\u3053\u3068\u3092\u3057\u3066\u3044\u307e\u3059\u3002\u3053\u306e changeset \u306f person \u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306e\u5909\u66f4\u304c\u4f5c\u3089\u308c\u308b\u306e\u3092\u898b\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\u3053\u306e\u30b1\u30fc\u30b9\u3067\u306f\u3001\u5168\u304f\u5909\u66f4\u304c\u306a\u3044\u3053\u3068\u304c\u308f\u304b\u308a\u307e\u3059\u3002\n\u6700\u5f8c\u306e\u884c\u3067\u306f\u3001person \u3092\u633f\u5165\u3059\u308b\u306e\u3067\u306f\u306a\u304f\u3001changeset \u3092\u633f\u5165\u3057\u3066\u3044\u307e\u3059\u3002changeset \u306f person \u3068\u305d\u306e\u5909\u66f4\u3001\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306b\u306f\u30c7\u30fc\u30bf\u304c\u884c\u304f\u524d\u306b\u884c\u308f\u308c\u308b\u3079\u304d\u30d0\u30ea\u30c7\u30fc\u30b7\u30e7\u30f3\u30eb\u30fc\u30eb\u306b\u3064\u3044\u3066\u77e5\u3063\u3066\u3044\u307e\u3059\u3002\n{:error,\n #Ecto.Changeset<action: :insert, changes: %{},\n  errors: [first_name: \"can't be blank\", last_name: \"can't be blank\"],\n  data: #Friends.Person<>, valid?: false>}\n\n\u6700\u5f8c\u306b\u633f\u5165\u3092\u884c\u3063\u305f\u3068\u304d\u306e\u3088\u3046\u306b\u3001\u3053\u306e\u30b3\u30fc\u30c9\u306f\u30bf\u30d7\u30eb\u3092\u8fd4\u3057\u307e\u3059\u3002\u3057\u304b\u3057\u3001\u3053\u306e\u5834\u5408\u306f\u554f\u984c\u304c\u3042\u308b\u3053\u3068\u793a\u3059\u305f\u3081\u306b\u30bf\u30d7\u30eb\u306e\u6700\u521d\u306e\u8981\u7d20\u306f :error \u306b\u306a\u308a\u307e\u3059\u3002\u4f55\u304c\u8d77\u3053\u3063\u305f\u304b\u306f\u8fd4\u3063\u3066\u304d\u305f changeset \u306b\u542b\u307e\u308c\u3066\u3044\u307e\u3059\u3002\u3053\u308c\u306f\u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u3092\u3059\u308b\u3053\u3068\u304c\u53d6\u308a\u51fa\u3059\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n{:error, changeset} = Friends.Repo.insert(changeset)\n\nchangeset.errors \u3092\u884c\u3046\u3053\u3068\u3067\u30a8\u30e9\u30fc\u3092\u5f97\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n[first_name: \"can't be blank\", last_name: \"can't be blank\"]\n\n\u633f\u5165\u3092\u884c\u3046\u524d\u306b\u3067\u3082\u3001changeset \u305d\u308c\u81ea\u4f53\u304c\u6b63\u3057\u3044\u304b\u3092\u691c\u8a3c\u3067\u304d\u307e\u3059\u3002\nchangeset.valid?\n#=> false\n\n\u3053\u306e changeset \u306f\u30a8\u30e9\u30fc\u3092\u6301\u3063\u3066\u3044\u308b\u306e\u3067\u3001people \u30c6\u30fc\u30d6\u30eb\u306b\u306f\u4f55\u3082\u633f\u5165\u3055\u308c\u307e\u305b\u3093\u3002\n\u6b63\u3057\u3044\u30c7\u30fc\u30bf\u3067\u3082\u8a66\u3057\u3066\u307f\u307e\u3057\u3087\u3046\u3002\nperson = %Friends.Person{}\nchangeset = Friends.Person.changeset(person, %{first_name: \"Ryan\", last_name: \"Bigg\"})\n\n\u666e\u901a\u306e Friends.Person \u69cb\u9020\u4f53\u304b\u3089\u306f\u3058\u3081\u3066\u307f\u307e\u3057\u3087\u3046\u3002\u6b21\u306b first_name \u3068 last_name \u30d1\u30e9\u30e1\u30fc\u30bf\u30fc\u304c\u6307\u5b9a\u3055\u308c\u305f person \u306e changeset \u3092\u4f5c\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\u3053\u306e\u6642\u70b9\u3067 changeset \u306b\u30a8\u30e9\u30fc\u304c\u3042\u308b\u304b\u3069\u3046\u304b\u3092\u5c0b\u306d\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\nchangeset.errors\n#=> []\n\n\u305d\u3057\u3066\u3001\u3053\u306e\u30c7\u30fc\u30bf\u304c\u6b63\u3057\u3044\u304b\u305d\u3046\u3067\u306a\u3044\u304b\u3092\u5c0b\u306d\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\nchangeset.valid?\n#=> true\n\nchangeset \u306f\u30a8\u30e9\u30fc\u3092\u6301\u305f\u306a\u3044\u305f\u3081\u6b63\u3057\u3044\u3053\u3068\u304c\u308f\u304b\u308a\u307e\u3059\u3002\u3053\u306e\u3053\u3068\u304b\u3089\u3001\u3053\u306e changeset \u3092\u633f\u5165\u3057\u3088\u3046\u3068\u3057\u305f\u5834\u5408\u3001\u305d\u308c\u306f\u9069\u5207\u306b\u52d5\u4f5c\u3057\u307e\u3059\u3002\nFriends.Repo.insert(changeset)\n#=> {:ok,\n     %Friends.Person{__meta__: #Ecto.Schema.Metadata<:loaded>, age: nil,\n      first_name: \"Ryan\", id: 3, last_name: \"Bigg\"}}\n\nFriends.Repo.insert \u304c\u30bf\u30d7\u30eb\u3092\u8fd4\u3059\u306e\u3067\u3001case \u3092\u4f7f\u3046\u3053\u3068\u3067\u3001\u4f55\u304c\u8d77\u3053\u3063\u305f\u304b\u306b\u3088\u3063\u3066\u3069\u306e\u30b3\u30fc\u30c9\u3092\u4f7f\u7528\u3059\u308b\u304b\u6c7a\u3081\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\ncase Friends.Repo.insert(changeset) do\n  {:ok, person} ->\n    # do something with person\n  {:error, changeset} ->\n    # do something with changeset\nend\n\nNOTE: changeset.valid? \u306f uniqueness_constraint \u306e\u3088\u3046\u306a\u5236\u7d04\u306e\u30c1\u30a7\u30c3\u30af\u306f\u884c\u3044\u307e\u305b\u3093\u3002\u3053\u306e\u305f\u3081\u3001\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306b\u633f\u5165\u3092\u884c\u3063\u3066\u307f\u3066\u30a8\u30e9\u30fc\u3092\u30c1\u30a7\u30c3\u30af\u3059\u308b\u3053\u3068\u304c\u5fc5\u8981\u3068\u306a\u308a\u307e\u3059\u3002\u3053\u306e\u3053\u3068\u304b\u3089\u3001\u5b9f\u969b\u306b\u30c7\u30fc\u30bf\u633f\u5165\u3092\u884c\u3063\u3066\u307f\u3066\u3001Friends.Repo.insert \u306e\u623b\u308a\u5024\u306e\u30bf\u30d7\u30eb\u3092\u691c\u8a3c\u3059\u308b\u3053\u3068\u304c\u6b63\u3057\u3044\u30a8\u30e9\u30fc\u3092\u5f97\u308b\u305f\u3081\u306e\u30d9\u30b9\u30c8\u30d7\u30e9\u30af\u30c6\u30a3\u30b9\u306b\u306a\u308b\u3067\u3057\u3087\u3046\u3002\u633f\u5165\u3059\u308b\u524d\u306e changeset \u306f\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u30ec\u30d9\u30eb\u306e\u30d0\u30ea\u30c7\u30fc\u30b7\u30e7\u30f3\u30a8\u30e9\u30fc\u3057\u304b\u542b\u307e\u306a\u3044\u304b\u3089\u3067\u3059\u3002\nchangeset \u306e\u633f\u5165\u304c\u6210\u529f\u3057\u305f\u3089\u3001\u7d50\u679c\u306b\u542b\u307e\u308c\u308b person \u3092\u3069\u306e\u3088\u3046\u306a\u3053\u3068\u306b\u3067\u3082\u5229\u7528\u3067\u304d\u307e\u3059\u3002\u3082\u3057\u5931\u6557\u3057\u305f\u3089\u3001changeset \u3092\u53c2\u7167\u3057\u3066\u305d\u306e\u30a8\u30e9\u30fc\u3092\u898b\u307e\u3057\u3087\u3046\u3002\u5931\u6557\u306e\u5834\u5408\u3001\u30a8\u30f3\u30c9\u30e6\u30fc\u30b6\u30fc\u306b\u305d\u308c\u3092\u8868\u793a\u3057\u305f\u3044\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u3002changeset \u306e\u30a8\u30e9\u30fc\u306f\u6b21\u306e\u3088\u3046\u306a\u30ad\u30fc\u30ef\u30fc\u30c9\u306e\u30ea\u30b9\u30c8\u3067\u3059\u3002\n[first_name: {\"can't be blank\", []},\n last_name: {\"can't be blank\", []}]\n\n\u30bf\u30d7\u30eb\u306e\u6700\u521d\u306e\u8981\u7d20\u306f\u30d0\u30ea\u30c7\u30fc\u30b7\u30e7\u30f3\u30e1\u30c3\u30bb\u30fc\u30b8\u3067\u3001\u6b21\u306e\u8981\u7d20\u304c\u30d0\u30ea\u30c7\u30fc\u30b7\u30e7\u30f3\u30e1\u30c3\u30bb\u30fc\u30b8\u306b\u5bfe\u3059\u308b\u30aa\u30d7\u30b7\u30e7\u30f3\u306e\u30ad\u30fc\u30ef\u30fc\u30c9\u306e\u30ea\u30b9\u30c8\u3067\u3059\u3002validate_required/3 \u30d0\u30ea\u30c7\u30fc\u30b7\u30e7\u30f3\u306f\u30aa\u30d7\u30b7\u30e7\u30f3\u3092\u8fd4\u3057\u307e\u305b\u3093\u304c\u3001\u4ed6\u306e validate_length/3 \u306e\u3088\u3046\u306a\u30e1\u30bd\u30c3\u30c9\u306f\u8fd4\u3057\u307e\u3059\u3002bio \u3068\u3044\u3046\u30d0\u30ea\u30c7\u30fc\u30b7\u30e7\u30f3\u3092\u3057\u3066\u3044\u305f\u30d5\u30a3\u30fc\u30eb\u30c9\u304c\u3042\u308a\u3001\u305d\u306e\u30d5\u30a3\u30fc\u30eb\u30c9\u304c15\u6587\u5b57\u4ee5\u4e0a\u3067\u306a\u3051\u308c\u3070\u3044\u3051\u306a\u3044\u3068\u3057\u307e\u3057\u3087\u3046\u3002\u3053\u308c\u306b\u5927\u3057\u3066\u306f\u6b21\u306e\u30b3\u30fc\u30c9\u304c\u8fd4\u3055\u308c\u307e\u3059\u3002\n[first_name: {\"can't be blank\", []},\n last_name: {\"can't be blank\", []},\n bio: {\"should be at least %{count} characters\", [count: 15]}]\n\n\u4eba\u304c\u898b\u308b\u306e\u306b\u512a\u3057\u3044\u65b9\u6cd5\u3067\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u8868\u793a\u3055\u305b\u308b\u306b\u306f\u3001Ecto.Changeset.traverse_errors/2 \u3092\u4f7f\u3046\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\ntraverse_errors(changeset, fn {msg, opts} ->\n  Enum.reduce(opts, msg, fn {key, value}, acc ->\n    String.replace(msg, \"%{#{key}}\", to_string(value))\n  end)\nend)\n\n\u3053\u308c\u306f\u4e0a\u3067\u8868\u793a\u3055\u308c\u305f\u30a8\u30e9\u30fc\u306b\u5bfe\u3057\u3066\u6b21\u306e\u30b3\u30fc\u30c9\u3092\u8fd4\u3057\u307e\u3059\u3002\n%{\n  first_name: [\"can't be blank\"],\n  last_name: [\"can't be blank\"],\n   bio: [\"should be at least 15 characters\"],\n}\n\n\u6700\u5f8c\u306b\u8a00\u3044\u305f\u3044\u3053\u3068\u306f\u3001Friends.Repo.insert!/2 \u3092\u4f7f\u3046\u3053\u3068\u3067\u4f8b\u5916\u3092\u5f15\u304d\u8d77\u3053\u3059\u3053\u3068\u304c\u3067\u304d\u308b\u3068\u3044\u3046\u3053\u3068\u3067\u3059\u3002\u3082\u3057\u3001\u5909\u66f4\u304c\u6b63\u3057\u304f\u306a\u3044\u5834\u5408\u3001Ecto.InvalidChangesetError \u4f8b\u5916\u304c\u767a\u751f\u3057\u307e\u3059\u3002\u4f8b\u3092\u6b21\u306b\u793a\u3057\u307e\u3059\u3002\nFriends.Repo.insert! Friends.Person.changeset(%Friends.Person{}, %{first_name: \"Ryan\"})\n\n** (Ecto.InvalidChangesetError) could not perform insert because changeset is invalid.\n\n* Changeset changes\n\n%{first_name: \"Ryan\"}\n\n* Changeset params\n\n%{\"first_name\" => \"Ryan\"}\n\n* Changeset errors\n\n[last_name: \"can't be blank\"]\n\n    lib/ecto/repo/schema.ex:111: Ecto.Repo.Schema.insert!/4\n\n\u3053\u306e\u4f8b\u5916\u306f\u5909\u66f4\u3068\u5909\u66f4\u304c\u3069\u306e\u3088\u3046\u306b\u9593\u9055\u3063\u3066\u3044\u308b\u304b\u3092\u8868\u793a\u3057\u3066\u3044\u307e\u3059\u3002\u3053\u308c\u306f\u30c7\u30fc\u30bf\u3092\u633f\u5165\u3057\u305f\u3044\u3068\u304d\u306b\u5f79\u7acb\u3061\u3001\u30c7\u30fc\u30bf\u304c\u6b63\u3057\u304f\u633f\u5165\u3067\u304d\u306a\u3044\u5834\u5408\u306f\u4f8b\u5916\u3092\u767a\u751f\u3055\u305b\u307e\u3059\u3002\n\u3053\u308c\u3067\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3078\u306e\u30c7\u30fc\u30bf\u306e\u633f\u5165\u3092\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3057\u305f\u3002\u6b21\u306b\u30c7\u30fc\u30bf\u3092\u3069\u306e\u3088\u3046\u306b\u53d6\u308a\u51fa\u3059\u304b\u3092\u898b\u3066\u3044\u304d\u307e\u3057\u3087\u3046\u3002\n\n\u6700\u521d\u306e\u30af\u30a8\u30ea\nEcto\u306b\u3088\u308b\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306b\u3078\u306e\u554f\u3044\u5408\u308f\u305b\u306f\u4e8c\u3064\u306e\u30b9\u30c6\u30c3\u30d7\u3092\u5fc5\u8981\u3068\u3057\u307e\u3059\u3002\u30af\u30a8\u30ea\u3092\u7d44\u307f\u7acb\u3066\u3001\u30ea\u30dd\u30b8\u30c8\u30ea\u306b\u30af\u30a8\u30ea\u3092\u6e21\u3057\u3066\u5b9f\u884c\u3057\u307e\u3059\u3002\u3053\u308c\u3092\u3059\u308b\u524d\u306b\u3001\u30a2\u30d7\u30ea\u306e\u305f\u3081\u306b\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3092\u518d\u4f5c\u6210\u3057\u3001\u3044\u304f\u3064\u304b\u306e\u30c6\u30b9\u30c8\u30c7\u30fc\u30bf\u3092\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\u3057\u307e\u3057\u3087\u3046\u3002\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3092\u518d\u4f5c\u6210\u3059\u308b\u305f\u3081\u306b\u306f\u3001\u6b21\u306e\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3057\u307e\u3059\u3002\nmix ecto.drop\nmix ecto.create\nmix ecto.migrate\n\n\u305d\u3057\u3066\u3001\u30c6\u30b9\u30c8\u30c7\u30fc\u30bf\u3092\u4f5c\u308b\u305f\u3081\u306b\u3001iex -S mix \u30bb\u30c3\u30b7\u30e7\u30f3\u3067\u6b21\u306e\u30b3\u30fc\u30c9\u3092\u5b9f\u884c\u3057\u307e\u3059\u3002\npeople = [\n  %Friends.Person{first_name: \"Ryan\", last_name: \"Bigg\", age: 28},\n  %Friends.Person{first_name: \"John\", last_name: \"Smith\", age: 27},\n  %Friends.Person{first_name: \"Jane\", last_name: \"Smith\", age: 26},\n]\n\nEnum.each(people, fn (person) -> Friends.Repo.insert(person) end)\n\n\u3053\u306e\u30b3\u30fc\u30c9\u306f\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306b\u3001Ryan\u3001John\u3001Jane\u306e\u4e09\u3064\u306e people \u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\u30c7\u30fc\u30bf\u3092\u691c\u8a3c\u3059\u308b\u306e\u306b changeset \u304c\u4f7f\u3048\u307e\u3059\u304c\u3001\u4eca\u56de\u306f\u3057\u3066\u3044\u307e\u305b\u3093\u3002\n\u6b21\u306e\u30bb\u30af\u30b7\u30e7\u30f3\u3067\u306f people \u306b\u8db3\u3057\u3066\u554f\u3044\u5408\u308f\u305b\u3092\u884c\u3044\u307e\u3057\u3087\u3046\u3002\u3055\u3041\u6b21\u3078\uff01\n\n\u5358\u4e00\u30ec\u30b3\u30fc\u30c9\u306e\u53d6\u308a\u51fa\u3057\npeople \u30c6\u30fc\u30d6\u30eb\u304b\u3089\u4e00\u3064\u306e\u30ec\u30b3\u30fc\u30c9\u3092\u53d6\u308a\u51fa\u3059\u3053\u3068\u304b\u3089\u59cb\u3081\u307e\u3057\u3087\u3046\u3002\nFriends.Person |> Ecto.Query.first\n\n\u3053\u306e\u30b3\u30fc\u30c9\u306f\u6b21\u306e\u3088\u3046\u306a Ecto.Query \u3092\u4f5c\u308a\u51fa\u3057\u307e\u3059\u3002\n#Ecto.Query<from p in Friends.Person, order_by: [asc: p.id], limit: 1>\n\n\u3000\u3000\n\u89d2\u30ab\u30c3\u30b3 <...> \u306e\u9593\u306e\u30b3\u30fc\u30c9\u306f\u7d44\u307f\u7acb\u3066\u3089\u308c\u305f Ecto \u30af\u30a8\u30ea\u3092\u8868\u3057\u3066\u3044\u307e\u3059\u3002\u6b21\u306e\u3088\u3046\u306a\u307b\u3068\u3093\u3069\u540c\u3058\u3088\u3046\u306a\u30b7\u30f3\u30bf\u30c3\u30af\u30b9\u3067\u3082\u3053\u306e\u30af\u30a8\u30ea\u3092\u7d44\u307f\u7acb\u3066\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\nrequire Ecto.Query\nEcto.Query.from p in Friends.Person, order_by: [asc: p.id], limit: 1\n\n\u30de\u30af\u30ed\u3092\u6709\u52b9\u306b\u3059\u308b\u305f\u3081 require Ecto.Query \u3092\u5fc5\u8981\u3068\u3057\u307e\u3059\u3002Ecto.Query \u306e from \u3092\u547c\u3073\u51fa\u3057\u3001\u89d2\u30ab\u30c3\u30b3\u306e\u9593\u3092\u6e21\u3057\u307e\u3059\u3002\u3053\u3053\u3067\u898b\u3066\u3044\u308b\u3088\u3046\u306b\u3001Ecto.Query.first \u3092\u4f7f\u3046\u3053\u3068\u3067 order \u3068 limit \u3092\u4f7f\u308f\u306a\u304f\u3066\u3082\u6e08\u307f\u307e\u3059\u3002\n\u3053\u306e\u30af\u30a8\u30ea\u3092\u5b9f\u884c\u3059\u308b\u305f\u3081\u306b\u306f\u3001Friends.Repo.one \u3092\u547c\u3073\u51fa\u3057\u307e\u3059\u3002\nFriends.Person |> Ecto.Query.first |> Friends.Repo.one\n\none \u95a2\u6570\u306f\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u304b\u3089\u4e00\u3064\u3060\u3051\u30ec\u30b3\u30fc\u30c9\u3092\u53d6\u308a\u51fa\u3057\u3001Friends.Person \u30e2\u30b8\u30e5\u30fc\u30eb\u5185\u306e\u65b0\u3057\u3044\u69cb\u9020\u4f53\u3092\u8fd4\u3057\u307e\u3059\u3002\n%Friends.Person{__meta__: #Ecto.Schema.Metadata<:loaded>, age: 28,\n first_name: \"Ryan\", id: 1, last_name: \"Bigg\"}\n\nfirst \u3082\u540c\u69d8\u3067\u3001last \u3068\u3044\u3046\u95a2\u6570\u3082\u3042\u308a\u307e\u3059\u3002\nFriends.Person |> Ecto.Query.last |> Friends.Repo.one\n#=> %Friends.Person{__meta__: #Ecto.Schema.Metadata<:loaded>, age: 26,\n     first_name: \"Jane\", id: 3, last_name: \"Smith\"}\n\nEcto.Repo.one \u95a2\u6570\u306f\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306e\u30ec\u30b3\u30fc\u30c9\u304c\u4e00\u3064\u3060\u3051\u306a\u3089\u3070\u3001\u4e00\u3064\u69cb\u9020\u4f53\u3092\u8fd4\u3057\u307e\u3059\u3002\u4e00\u3064\u4ee5\u4e0a\u30ec\u30b3\u30fc\u30c9\u304c\u3042\u3063\u305f\u3089\u3001Ecto.MultipleResultsError \u4f8b\u5916\u304c\u6295\u3052\u3089\u308c\u307e\u3059\u3002\u6b21\u306e\u30b3\u30fc\u30c9\u306f\u305d\u306e\u554f\u984c\u3092\u5f15\u304d\u8d77\u3053\u3057\u307e\u3059\u3002\nFriends.Person |> Friends.Repo.one\n\nEcto.Query.first \u304c\u306a\u304f\u3001\u30af\u30a8\u30ea\u306b\u5bfe\u3057\u3066\u5b9f\u884c\u3055\u308c\u308b limit \u3084 order \u53e5\u3082\u3042\u308a\u307e\u305b\u3093\u3002\u30c7\u30d0\u30c3\u30b0\u30ed\u30b0\u3067\u5b9f\u884c\u3055\u308c\u308b\u30af\u30a8\u30ea\u3092\u898b\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n[timestamp] [debug] SELECT p0.\"id\", p0.\"first_name\", p0.\"last_name\", p0.\"age\" FROM \"people\" AS p0 [] OK query=1.8ms\n\n\u3053\u306e\u3059\u3050\u5f8c\u306b Ecto.MultipleResultsError \u4f8b\u5916\u304c\u767a\u751f\u3057\u307e\u3059\u3002\n** (Ecto.MultipleResultsError) expected at most one result but got 3 in query:\n\nfrom p in Friends.Person\n\n    lib/ecto/repo/queryable.ex:67: Ecto.Repo.Queryable.one/4\n\n\u3053\u308c\u306f Ecto \u304c\u8907\u6570\u306e\u30ec\u30b3\u30fc\u30c9\u304c\u3042\u308b\u3068\u63a2\u3057\u3066\u3044\u308b\u30ec\u30b3\u30fc\u30c9\u304c\u4e0d\u660e\u3067\u3042\u308b\u305f\u3081\u306b\u8d77\u3053\u308a\u307e\u3059\u3002Ecto \u306f\u63a2\u3057\u3066\u3044\u308b\u3082\u306e\u304c\u660e\u793a\u7684\u306a\u30af\u30a8\u30ea\u306b\u306e\u307f\u7d50\u679c\u3092\u8fd4\u3057\u307e\u3059\u3002\n\u30af\u30a8\u30ea\u306b\u30de\u30c3\u30c1\u3059\u308b\u30ec\u30b3\u30fc\u30c9\u304c\u306a\u3044\u5834\u5408\u306f\u3001one \u306f nil \u3092\u8fd4\u3057\u307e\u3059\u3002\n\nFetching all records\n\n\u5168\u30ec\u30b3\u30fc\u30c9\u306e\u53d6\u308a\u51fa\u3057\n\u30b9\u30ad\u30fc\u30de\u304b\u3089\u5168\u3066\u306e\u30ec\u30b3\u30fc\u30c9\u3092\u53d6\u308a\u51fa\u3059\u305f\u3081\u306b\u3001Ecto \u306f all \u95a2\u6570\u3092\u6301\u3063\u3066\u3044\u307e\u3059\u3002\nFriends.Person |> Friends.Repo.all\n\n\u3053\u308c\u306f\u3001people \u30c6\u30fc\u30d6\u30eb\u306b\u73fe\u5728\u5165\u3063\u3066\u3044\u308b\u30ec\u30b3\u30fc\u30c9\u3092 Friends.Person \u69cb\u9020\u4f53\u5f62\u5f0f\u3067\u8fd4\u3057\u307e\u3059\u3002\n[%Friends.Person{__meta__: #Ecto.Schema.Metadata<:loaded>, age: 28,\n  first_name: \"Ryan\", id: 1, last_name: \"Bigg\"},\n %Friends.Person{__meta__: #Ecto.Schema.Metadata<:loaded>, age: 27,\n  first_name: \"John\", id: 2, last_name: \"Smith\"},\n %Friends.Person{__meta__: #Ecto.Schema.Metadata<:loaded>, age: 26,\n  first_name: \"Jane\", id: 3, last_name: \"Smith\"}]\n\n\nID\u3092\u3082\u3068\u306b\u3057\u305f\u5358\u4e00\u30ec\u30b3\u30fc\u30c9\u306e\u53d6\u308a\u51fa\u3057\nID \u3092\u3082\u3068\u306b\u30ec\u30b3\u30fc\u30c9\u3092\u53d6\u308a\u51fa\u3059\u3068\u304d\u306f get \u95a2\u6570\u3092\u4f7f\u3044\u307e\u3059\u3002\nFriends.Person |> Friends.Repo.get(1)\n%Friends.Person{__meta__: #Ecto.Schema.Metadata<:loaded>, age: 28,\n first_name: \"Ryan\", id: 1, last_name: \"Bigg\"}\n\n\n\u7279\u5b9a\u306e\u5c5e\u6027\u3092\u3082\u3068\u306b\u3057\u305f\u5358\u4e00\u30ec\u30b3\u30fc\u30c9\u306e\u53d6\u308a\u51fa\u3057\nid \u4ee5\u5916\u306e\u5c5e\u6027\u3092\u3082\u3068\u306b\u30ec\u30b3\u30fc\u30c9\u3092\u53d6\u308a\u51fa\u3057\u305f\u3044\u5834\u5408\u306f\u3001get_by \u95a2\u6570\u3092\u4f7f\u3046\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n Friends.Person |> Friends.Repo.get_by(first_name: \"Ryan\")\n %Friends.Person{__meta__: #Ecto.Schema.Metadata<:loaded>, age: 28,\n  first_name: \"Ryan\", id: 1, last_name: \"Bigg\"}\n\n\n\u30d5\u30a3\u30eb\u30bf\u30ea\u30f3\u30b0\n\u7279\u5b9a\u306e\u5c5e\u6027\u306b\u30de\u30c3\u30c1\u3059\u308b\u8907\u6570\u306e\u30ec\u30b3\u30fc\u30c9\u3092\u53d6\u308a\u51fa\u3059\u305f\u3081\u306b\u306f where \u304c\u4f7f\u3048\u307e\u3059\u3002\nFriends.Person |> Ecto.Query.where(last_name: \"Smith\") |> Friends.Repo.all\n\n[%Friends.Person{__meta__: #Ecto.Schema.Metadata<:loaded>, age: 27,\n  first_name: \"John\", id: 2, last_name: \"Smith\"},\n %Friends.Person{__meta__: #Ecto.Schema.Metadata<:loaded>, age: 26,\n  first_name: \"Jane\", id: 3, last_name: \"Smith\"}]\n\n\u3082\u3057\u3001\u672b\u5c3e\u306e Friends.Repo.all \u304c\u306a\u3044\u5834\u5408\u3001Ecto \u304c\u6b21\u306e\u30af\u30a8\u30ea\u3092\u751f\u6210\u3059\u308b\u306e\u304c\u308f\u304b\u308b\u3067\u3057\u3087\u3046\u3002\n#Ecto.Query<from p in Friends.Person, where: p.last_name == \"Smith\">\n\n\u540c\u3058\u30ec\u30b3\u30fc\u30c9\u3092\u53d6\u308a\u51fa\u3059\u306e\u306b\u3053\u306e\u30af\u30a8\u30ea\u30b7\u30f3\u30bf\u30c3\u30af\u30b9\u3092\u4f7f\u3046\u3053\u3068\u3082\u3067\u304d\u307e\u3059\u3002\nEcto.Query.from(p in Friends.Person, where: p.last_name == \"Smith\") |> Friends.Repo.all\n\n\u3069\u3061\u3089\u306e\u30af\u30a8\u30ea\u30b7\u30f3\u30bf\u30c3\u30af\u30b9\u306b\u3064\u3044\u3066\u3082\u30d4\u30f3\u6f14\u7b97\u5b50(^)\u3092\u4f7f\u3063\u3066\u3001\u30d4\u30f3\u3055\u308c\u305f\u5909\u6570\u3092\u5fc5\u8981\u3068\u3057\u307e\u3059\u3002\nlast_name = \"Smith\"\nFriends.Person |> Ecto.Query.where(last_name: last_name) |> Friends.Repo.all\n\n** (Ecto.Query.CompileError) variable `last_name` is not a valid query expression.\n  Variables need to be explicitly interpolated in queries with ^\n             expanding macro: Ecto.Query.where/2\n             iex:1: (file)\n    (elixir) expanding macro: Kernel.|>/2\n             iex:1: (file)\n\n\u3088\u308a\u9577\u3044\u30af\u30a8\u30ea\u30b7\u30f3\u30bf\u30c3\u30af\u30b9\u3067\u3082\u540c\u3058\u3053\u3068\u304c\u8d77\u3053\u308a\u307e\u3059\u3002\nEcto.Query.from(p in Friends.Person, where: p.last_name == last_name) |> Friends.Repo.all\n\n** (Ecto.Query.CompileError) variable `last_name` is not a valid query expression. \n  Variables need to be explicitly interpolated in queries with ^\n             expanding macro: Ecto.Query.where/3\n             iex:1: (file)\n             expanding macro: Ecto.Query.from/2\n             iex:1: (file)\n    (elixir) expanding macro: Kernel.|>/2\n             iex:1: (file)\n\n\u3053\u308c\u3092\u5b9f\u884c\u3057\u3066\u30c7\u30fc\u30bf\u3092\u53d6\u308a\u51fa\u3059\u306b\u306f\u3001\u30d4\u30f3\u6f14\u7b97\u5b50(^)\u3092\u4f7f\u3044\u307e\u3059\u3002\nlast_name = \"Smith\"\nFriends.Person |> Ecto.Query.where(last_name: ^last_name) |> Friends.Repo.all\n\n\u3082\u3057\u304f\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u3001\nlast_name = \"Smith\"\nEcto.Query.from(p in Friends.Person, where: p.last_name == ^last_name) |> Friends.Repo.all\n\n\u30d4\u30f3\u6f14\u7b97\u5b50\u306f\u30af\u30a8\u30ea\u30d3\u30eb\u30c0\u30fc\u306bSQL\u30a4\u30f3\u30b8\u30a7\u30af\u30b7\u30e7\u30f3\u5bfe\u7b56\u304c\u65bd\u3055\u308c\u305f\u30d1\u30e9\u30e1\u30fc\u30bf\u30fc\u5316\u3055\u308c\u305fSQL\u30af\u30a8\u30ea\u3092\u4f7f\u3046\u3088\u3046\u306b\u3057\u307e\u3059\u3002\n\nEcto\u30af\u30a8\u30ea\u306e\u7d44\u307f\u7acb\u3066\nEcto\u30af\u30a8\u30ea\u306f\u4e00\u3064\u306e\u5834\u6240\u3067\u7d44\u307f\u7acb\u3066\u308b\u5fc5\u8981\u306f\u3042\u308a\u307e\u305b\u3093\u3002\u3059\u3067\u306b\u5b58\u5728\u3059\u308b\u30af\u30a8\u30ea\u304b\u3089 Ecto.Query \u95a2\u6570\u3092\u547c\u3073\u51fa\u3059\u3053\u3068\u3067\u30af\u30a8\u30ea\u3092\u4f5c\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\u4f8b\u3048\u3070\u3001\u540d\u524d\u304c \"Smith\" \u3067\u3042\u308b\u5168\u3066\u306e\u4eba\u3092\u898b\u3064\u3051\u305f\u3044\u3068\u3057\u307e\u3057\u3087\u3046\u3002\u6b21\u306e\u3088\u3046\u306b\u3067\u304d\u307e\u3059\u3002\nquery = Friends.Person |> Ecto.Query.where(last_name: \"Smith\") \n\n\u82d7\u5b57\u304c \"Jane\" \u306e\u4eba\u3060\u3051\u306b\u30b9\u30b3\u30fc\u30d7\u3092\u7d5e\u308a\u305f\u3044\u306a\u3089\u3070\u3001\u6b21\u306e\u3088\u3046\u306b\u3067\u304d\u307e\u3059\u3002\nquery = query |> Ecto.Query.where(first_name: \"Jane\")\n\n\u30af\u30a8\u30ea\u306f\u3053\u306e\u6642\u70b9\u3067\u4e8c\u3064\u306e where \u53e5\u3092\u6301\u3064\u3053\u3068\u306b\u306a\u308a\u307e\u3059\u3002\n#Ecto.Query<from p in Friends.Person, where: p.last_name == \"Smith\",\n where: p.first_name == \"Jane\">\n\n\u3053\u308c\u306f\u6700\u521d\u306e\u30af\u30a8\u30ea\u3067\u4f55\u304b\u4f5c\u696d\u3092\u3057\u3066\u304b\u3089\u3001\u305d\u306e\u5f8c\u3067\u305d\u306e\u30af\u30a8\u30ea\u3092\u4f7f\u3063\u3066\u5225\u306a\u30af\u30a8\u30ea\u3092\u69cb\u7bc9\u3059\u308b\u306e\u306b\u5f79\u7acb\u3061\u307e\u3059\u3002\n\n\u30ec\u30b3\u30fc\u30c9\u306e\u66f4\u65b0\n\u30ec\u30b3\u30fc\u30c9\u3092 Ecto \u3067\u66f4\u65b0\u3059\u308b\u306b\u306f\u3001\u6700\u521d\u306b\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u304b\u3089\u30ec\u30b3\u30fc\u30c9\u3092\u53d6\u308a\u51fa\u3059\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\u305d\u306e\u5f8c\u3067\u3001\u30ec\u30b3\u30fc\u30c9\u304b\u3089 changeset \u3068\u30ec\u30b3\u30fc\u30c9\u306b\u5bfe\u3059\u308b\u5909\u66f4\u3092\u69cb\u6210\u3057\u3001Ecto.Repo.update \u95a2\u6570\u3092\u547c\u3073\u51fa\u3057\u307e\u3059\u3002\n\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u304b\u3089\u6700\u521d\u306e person \u30ec\u30b3\u30fc\u30c9\u3092\u53d6\u308a\u51fa\u3057\u3001\u5e74\u9f62(age)\u3092\u5909\u66f4\u3057\u3066\u307f\u307e\u3057\u3087\u3046\u3002\u6700\u521d\u306b person \u3092\u53d6\u308a\u51fa\u3057\u307e\u3059\u3002\nperson = Friends.Person |> Ecto.Query.first |> Friends.Repo.one\n\n\u6b21\u306b\u3001changeset \u3092\u4f5c\u308a\u307e\u3059\u3002\u5358\u306b\u65b0\u3057\u3044\u5e74\u9f62(age)\u3092\u6301\u3063\u305f\u65b0\u3057\u3044 Friends.Person \u69cb\u9020\u4f53\u3092\u4f5c\u308b\u306e\u3067\u3001changeset \u304c\u5fc5\u8981\u306b\u306a\u308a\u307e\u3059\u3002Ecto \u306f\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3068\u306e\u9023\u643a\u306a\u3057\u3067\u306f\u5e74\u9f62\u304c\u5909\u66f4\u3055\u308c\u308b\u304b\u3092\u77e5\u308b\u3053\u3068\u304c\u3067\u304d\u306a\u3044\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u3002changeset \u3092\u4f5c\u3063\u3066\u307f\u307e\u3057\u3087\u3046\u3002\nchangeset = Friends.Person.changeset(person, %{age: 29})\n\nchangeset \u306f\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306b\u5e74\u9f62\u304c29\u306b\u3059\u308b\u305f\u3081\u306b\u30ec\u30b3\u30fc\u30c9\u3092\u66f4\u65b0\u3057\u305f\u3044\u3053\u3068\u3092\u77e5\u3089\u305b\u307e\u3059\u3002\u5909\u66f4\u306b\u3064\u3044\u3066\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3068\u3084\u308a\u53d6\u308a\u3059\u308b\u305f\u3081\u306b\u3001\u6b21\u306e\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3057\u307e\u3059\u3002\nFriends.Repo.update(changeset)\n\nFriends.Repo.insert \u3068\u540c\u3058\u3088\u3046\u306b\u3001Friends.Repo.update \u306f\u30bf\u30d7\u30eb\u3092\u8fd4\u3057\u307e\u3059\u3002\n{:ok,\n %Friends.Person{__meta__: #Ecto.Schema.Metadata<:loaded>, age: 29,\n  first_name: \"Ryan\", id: 1, last_name: \"Bigg\"}}\n\n\u4f55\u304b\u306e\u7406\u7531\u3067 changeset \u304c\u5931\u6557\u3057\u305f\u3089\u3001Friends.Repo.update \u306e\u7d50\u679c\u306f {:error, changeset} \u306b\u306a\u308a\u307e\u3059\u3002\u3053\u308c\u306f first_name \u304c\u7a7a\u306b\u306a\u308b\u3088\u3046\u306b changeset \u306e\u30d1\u30e9\u30e1\u30fc\u30bf\u30fc\u3092\u5909\u3048\u308b\u3053\u3068\u3067\u5f15\u304d\u8d77\u3053\u3059\u3053\u3068\u3082\u3067\u304d\u307e\u3059\u3002\nchangeset = Friends.Person.changeset(person, %{first_name: \"\"})\n#=> {:error,\n     #Ecto.Changeset<action: :update, changes: %{first_name: \"\"},\n      errors: [first_name: \"can't be blank\"], data: #Friends.Person<>,\n      valid?: false>}\n\n\u3053\u306e\u3053\u3068\u306f update \u95a2\u6570\u304b\u3089\u306e\u7d50\u679c\u306b\u3088\u3063\u3066\u7570\u306a\u3063\u305f\u30b3\u30fc\u30c9\u3092\u5b9f\u884c\u3059\u308b\u306e\u306b\u3001case \u30b9\u30c6\u30fc\u30c8\u30e1\u30f3\u30c8\u3092\u4f7f\u3048\u308b\u3068\u3044\u3046\u3053\u3068\u3092\u610f\u5473\u3057\u3066\u3044\u307e\u3059\u3002\ncase Friends.Repo.update(changeset) do\n  {:ok, person} ->\n    # do something with person\n  {:error, changeset} ->\n    # do something with changeset\nend\n\ninsert! \u3068\u540c\u3058\u3088\u3046\u306b\u3001changeset \u306b\u554f\u984c\u304c\u3042\u308b\u5834\u5408\u306b\u4f8b\u5916\u3092\u5f15\u304d\u8d77\u3053\u3059 update! \u95a2\u6570\u304c\u3042\u308a\u307e\u3059\u3002\nchangeset = Friends.Person.changeset(person, %{first_name: \"\"})\nFriends.Repo.update! changeset\n\n** (Ecto.InvalidChangesetError) could not perform update because changeset is invalid.\n\n* Changeset changes\n\n%{first_name: \"\"}\n\n* Changeset params\n\n%{\"first_name\" => \"\"}\n\n* Changeset errors\n\n[first_name: {\"can't be blank\", []}]\n\n    lib/ecto/repo/schema.ex:132: Ecto.Repo.Schema.update!/4\n\n\n\u30ec\u30b3\u30fc\u30c9\u306e\u524a\u9664\n\u30ec\u30b3\u30fc\u30c9\u306e\u4f5c\u6210(insert)\u30fb\u8aad\u307f\u8fbc\u307f(get, get_by, where)\u30fb\u66f4\u65b0\u306b\u3064\u3044\u3066\u30ab\u30d0\u30fc\u3057\u307e\u3057\u305f\u3002\u3053\u306e\u30ac\u30a4\u30c9\u306e\u6700\u5f8c\u306b\u884c\u3063\u305f\u306e\u306f Ecto \u3092\u4f7f\u3063\u305f\u30ec\u30b3\u30fc\u30c9\u306e\u524a\u9664\u306b\u3064\u3044\u3066\u3067\u3057\u305f\u3002\n\u66f4\u65b0\u3068\u540c\u3058\u3088\u3046\u306b\u3001\u30ec\u30b3\u30fc\u30c9\u3092\u524a\u9664\u3059\u308b\u306b\u306f\u3001\u6700\u521d\u306b\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u304b\u3089\u30ec\u30b3\u30fc\u30c9\u3092\u53d6\u308a\u51fa\u3057\u3001Friends.Repo.delete \u3092\u547c\u3073\u51fa\u3057\u307e\u3059\u3002\nperson = Friends.Repo.get(Friends.Person, 1)\nFriends.Repo.delete(person)\n{:ok,\n %Friends.Person{__meta__: #Ecto.Schema.Metadata<:deleted>, age: 29,\n  first_name: \"Ryan\", id: 2, last_name: \"Bigg\"}}\n\ninsert \u3084 update \u3068\u540c\u3058\u3088\u3046\u306b\u3001delete \u306f\u30bf\u30d7\u30eb\u3092\u8fd4\u3057\u307e\u3059\u3002\u524a\u9664\u304c\u5b8c\u4e86\u3057\u305f\u3089\u30bf\u30d7\u30eb\u306e\u6700\u521d\u306e\u8981\u7d20\u306f :ok\u3001\u5931\u6557\u3057\u305f\u3089 :error \u306b\u306a\u308a\u307e\u3059\u3002\n<https://hexdocs.pm/ecto/getting-started.html> (Ecto v2.0.5) \u306e\u7ffb\u8a33\u306b\u306a\u308a\u307e\u3059\u3002\n\n\u8a33\u304c\u9593\u9055\u3063\u3066\u3044\u308b\u3001\u629c\u3051\u3066\u3044\u308b\u306a\u3069\u306e\u7b87\u6240\u306a\u3069\u3092\u898b\u3064\u3051\u305f\u3089\u6307\u6458\u3057\u3066\u3044\u305f\u3060\u3051\u308b\u3068\u52a9\u304b\u308a\u307e\u3059\u3002\n\n\n\n---\n\n# Getting Started\n\n\u3053\u306e\u30ac\u30a4\u30c9\u306fElixir\u306e\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u30e9\u30c3\u30d1\u30fc\u53ca\u3073\u30af\u30a8\u30ea\u30b8\u30a7\u30cd\u30ec\u30fc\u30bf[Ecto](https://github.com/elixir-lang/ecto)\u3078\u306e\u30a4\u30f3\u30c8\u30ed\u30c0\u30af\u30b7\u30e7\u30f3\u3067\u3059\u3002Ecto\u306f\u3001Elixir\u30c7\u30d9\u30ed\u30c3\u30d1\u30fc\u304c\u3069\u3093\u306a\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3092\u4f7f\u3063\u3066\u3044\u3088\u3046\u3068\u540c\u3058\u3088\u3046\u306a\u65b9\u6cd5\u3067\u30af\u30a8\u30ea\u306b\u3088\u308b\u554f\u3044\u5408\u308f\u305b\u304c\u3067\u304d\u308b\u3088\u3046\u306b\u3001\u6a19\u6e96\u5316\u3055\u308c\u305fAPI\u3068\u62bd\u8c61\u5316\u3055\u308c\u305f\u65b9\u6cd5\u3092\u63d0\u4f9b\u3057\u3066\u3044\u307e\u3059\u3002\n\n\u3053\u306e\u30ac\u30a4\u30c9\u3067\u306f\u3001PostgreSQL\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306e\u30ec\u30b3\u30fc\u30c9\u306e\u4f5c\u6210\u30fb\u8aad\u307f\u8fbc\u307f\u30fb\u66f4\u65b0\u30fb\u524a\u9664\u306e\u3088\u3046\u306a\u57fa\u672c\u7684\u306a\u3053\u3068\u306b\u3064\u3044\u3066\u5b66\u3079\u307e\u3059\u3002\u3082\u3057\u3053\u306e\u30ac\u30a4\u30c9\u4e2d\u306e\u30b3\u30fc\u30c9\u3092\u898b\u305f\u3051\u308c\u3070\u3001\u3053\u3053([at ecto/examples/friends on GitHub](https://github.com/elixir-lang/ecto/tree/master/examples/friends))\u306e\u30b3\u30fc\u30c9\u3092\u898b\u3066\u304f\u3060\u3055\u3044\u3002\n\n**\u3053\u306e\u30ac\u30a4\u30c9\u306f\u4e8b\u524d\u306bPostgreSQL\u304c\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\u3055\u308c\u3066\u3044\u308b\u306e\u3092\u524d\u63d0\u3068\u3057\u3066\u3044\u307e\u3059**\n\n## Ecto\u306e\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3078\u306e\u8ffd\u52a0\n\n\u624b\u59cb\u3081\u306b\u3001\u65b0\u3057\u3044Elixir\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u4f5c\u308b\u305f\u3081\u3001\u4ee5\u4e0b\u306e\u30b3\u30de\u30f3\u30c9\u3092\u4f7f\u3044\u307e\u3059\u3002\n\n\n```\nmix new friends --sup\n```\n\n`--sup` \u30aa\u30d7\u30b7\u30e7\u30f3\u306f\u3053\u306e\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u304c[a supervision tree](http://elixir-lang.org/getting-started/mix-otp/supervisor-and-application.html)\u3092\u6301\u3063\u3066\u3044\u308b\u3053\u3068\u78ba\u8a8d\u3057\u307e\u3059\u3002\u3053\u308c\u306f\u5c11\u3057\u5f8c\u3067\u5fc5\u8981\u306b\u306a\u308a\u307e\u3059\u3002\n\n\u3053\u306e\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306bEcto\u3092\u8ffd\u52a0\u3059\u308b\u306e\u306b\u3044\u304f\u3064\u304b\u306e\u30b9\u30c6\u30c3\u30d7\u3092\u8e0f\u3080\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\u6700\u521d\u306e\u30b9\u30c6\u30c3\u30d7\u306f`mix.exs` \u30d5\u30a1\u30a4\u30eb\u306e `deps` \u3092\u5909\u66f4\u3057\u3066\u3001Ecto\u3068Postgrex\u3068\u3044\u3046\u30c9\u30e9\u30a4\u30d0\u3092 \u8ffd\u52a0\u3059\u308b\u3053\u3068\u3067\u3059\u3002\n\n```elixir\ndefp deps do\n  [{:ecto, \"~> 2.0\"},\n   {:postgrex, \"~> 0.11\"}]\nend\n```\n\nEcto\u306f\u4e00\u822c\u7684\u306a\u30af\u30a8\u30eaAPI\u3092\u63d0\u4f9b\u3057\u307e\u3059\u304c\u3001Ecto\u304cPostgreSQL\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u304c\u89e3\u91c8\u3067\u304d\u308b\u8a9e\u3067\u8a71\u3059\u305f\u3081\u306bPostgrex\u30c9\u30e9\u30a4\u30d0\u3092\u5fc5\u8981\u3068\u3057\u307e\u3059\u3002\n\n\u4ee5\u4e0a\u306e\u4f9d\u5b58\u30d5\u30a1\u30a4\u30eb\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\u305f\u3081\u306b\u306f\u3001\u4ee5\u4e0b\u306e\u30b3\u30de\u30f3\u30c9\u3092\u4f7f\u3044\u307e\u3059\u3002\n\n```\nmix deps.get\n```\n\n\u540c\u69d8\u306b\u540c\u3058\u30d5\u30a1\u30a4\u30eb\u3067\u3001`ecto` \u3068 `postgrex` \u3092 applications\u306e\u30ea\u30b9\u30c8\u306b\u8ffd\u52a0\u3057\u307e\u3059\u3002\n\n```elixir\ndef application do\n  [applications: [:logger, :ecto, :postgrex],\n   mod: {Friends, []}]\nend\n```\n\nPostgrex\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306fEcto\u304b\u3089\u30af\u30a8\u30ea\u3092\u53d7\u3051\u53d6\u308a\u3001\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306b\u5bfe\u3057\u3066\u30af\u30a8\u30ea\u3092\u5b9f\u884c\u3057\u307e\u3059\u3002\u3082\u3057\u3053\u306e\u30b9\u30c6\u30c3\u30d7\u3092\u8e0f\u307e\u306a\u3051\u308c\u3070\u3001\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306b\u5bfe\u3059\u308b\u554f\u3044\u5408\u308f\u305b\u306f\u307e\u3063\u305f\u304f\u3067\u304d\u306a\u3044\u3067\u3057\u3087\u3046\u3002\n\n\u4e8c\u756a\u76ee\u306e\u30b9\u30c6\u30c3\u30d7\u306b\u79fb\u308a\u307e\u3057\u3087\u3046\u3002Ecto\u3068Postgrex\u3092\u4f9d\u5b58\u95a2\u4fc2\u306b\u7d44\u307f\u8fbc\u3093\u3060\u3042\u3068\u306f\u3001\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u30b3\u30fc\u30c9\u3067\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3092\u64cd\u4f5c\u3059\u308b\u305f\u3081\u306b\u3044\u304f\u3064\u304b\u8a2d\u5b9a\u304c\u5fc5\u8981\u3067\u3059\u3002\n\n\u3053\u306e\u8a2d\u5b9a\u306b\u306f\u4ee5\u4e0b\u306e\u30b3\u30de\u30f3\u30c9\u3092\u4f7f\u7528\u3057\u307e\u3059\u3002\n\n```\nmix ecto.gen.repo -r Friends.Repo\n```\n\n\u3053\u306e\u30b3\u30de\u30f3\u30c9\u306f\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3068\u63a5\u7d9a\u3059\u308b\u305f\u3081\u306e\u8a2d\u5b9a\u3092\u751f\u6210\u3057\u307e\u3059\u3002`config/config.exs` \u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u8a2d\u5b9a\u306b\u306a\u308a\u307e\u3059\u3002\n\n```elixir\nconfig :friends, Friends.Repo,\n  adapter: Ecto.Adapters.Postgres,\n  database: \"friends_repo\",\n  username: \"user\",\n  password: \"pass\",\n  hostname: \"localhost\"\n```\n\n**NOTE**: PostgreSQL\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306f\n\n- \u30e6\u30fc\u30b6\u30fc\u540d\u30fb\u30d1\u30b9\u30ef\u30fc\u30c9\u3092\u5fc5\u8981\u3068\u3057\u306a\u3044\u3088\u3046\u306b\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\u3059\u308b\u3053\u3068\u3082\u3067\u304d\u307e\u3059\u3002\u3082\u3057\u4e0a\u306e\u8a2d\u5b9a\u3067\u3046\u307e\u304f\u3044\u304b\u306a\u3044\u306a\u3089\u3001username/password \u306e\u30d5\u30a3\u30fc\u30eb\u30c9\u3092\u53d6\u308a\u9664\u304f\u304b\u3001\u3069\u3061\u3089\u3082\"postgres\"\u3068\u30bb\u30c3\u30c8\u3059\u308c\u3070\u826f\u3044\u3067\u3059\u3002\n- \u975e\u6a19\u6e96\u7684\u306a\u30dd\u30fc\u30c8\u3067\u52d5\u4f5c\u3055\u305b\u308b\u3088\u3046\u306b\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\u3059\u308b\u3053\u3068\u3082\u3067\u304d\u307e\u3059\u3002`port: 15432` \u306e\u3088\u3046\u306b\u30dd\u30fc\u30c8\u756a\u53f7\u3092\u6307\u5b9a\u3059\u308c\u3070\u826f\u3044\u3067\u3059\u3002\n\n\u3053\u306e\u8a2d\u5b9a\u306b\u3088\u308a \"friends\" \u3068\u540d\u4ed8\u3051\u305f\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3078\u3069\u306e\u3088\u3046\u306b\u63a5\u7d9a\u3059\u308b\u304b\u3092\u6c7a\u3081\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\u53b3\u5bc6\u306b\u8a00\u3048\u3070 \"repo\" \u3092\u8a2d\u5b9a\u3057\u3066\u3044\u308b\u3002\u3088\u308a\u8a73\u3057\u3044\u60c5\u5831\u306f[Ecto.Repo can be found in its documentation](https://hexdocs.pm/ecto/Ecto.Repo.html)\u3092\u53c2\u7167\u3059\u308b\u3068\u826f\u3044\u3067\u3059\u3002\n\n`Friends.Repo` \u30e2\u30b8\u30e5\u30fc\u30eb\u306f `mix ecto.gen.repo` \u30b3\u30de\u30f3\u30c9\u3067 `lib/friends/repo.ex` \u306b\u5b9a\u7fa9\u3055\u308c\u3066\u3044\u307e\u3059\u3002\n\n```elixir\ndefmodule Friends.Repo do\n  use Ecto.Repo, otp_app: :friends\nend\n```\n\n\u3053\u306e\u30e2\u30b8\u30e5\u30fc\u30eb\u306f\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306b\u554f\u3044\u5408\u308f\u305b\u3092\u3059\u308b\u305f\u3081\u306b\u4f7f\u3046\u3082\u306e\u3067\u3059\u3002\u3053\u306e\u30e2\u30b8\u30e5\u30fc\u30eb\u306f `Ecto.Repo` \u30e2\u30b8\u30e5\u30fc\u30eb\u3092\u4f7f\u3044\u3001`otp_app` \u306fEcto\u306b\u3069\u306eElixir\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306e\u8a2d\u5b9a\u3092\u63a2\u3059\u304b\u3092\u4f1d\u3048\u307e\u3059\u3002\u4eca\u56de\u306e\u30ac\u30a4\u30c9\u306e\u5834\u5408\u3001Ecto\u304c\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3092\u898b\u3064\u3051\u308b\u3053\u3068\u304c\u3067\u304d\u308b\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092 `:friends` \u306b\u6307\u5b9a\u3057\u3066\u3044\u308b\u306e\u3067Ecto\u306f\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\u6e08\u307f\u306e\u8a2d\u5b9a\u3092\u4f7f\u3046\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n\u3053\u306e\u8a2d\u5b9a\u306e\u6700\u5f8c\u306e\u30d4\u30fc\u30b9\u306f\u3001`Friends.Repo` \u3092\u30b9\u30fc\u30d1\u30fc\u30d0\u30a4\u30b6\u30fc\u3068\u3057\u3066\u76e3\u8996\u30c4\u30ea\u30fc\u306b\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\u3059\u308b\u3053\u3068\u3067\u3059\u3002`lib/friends.ex` \u306e `start/2` \u95a2\u6570\u306e\u4e2d\u3067\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\u306f\u3067\u304d\u307e\u3059\u3002\n\n```elixir\ndef start(_type, _args) do\n  import Supervisor.Spec, warn: false\n\n  children = [\n    supervisor(Friends.Repo, []),\n  ]\n\n  ...\n```\n\n\u3053\u306e\u8a2d\u5b9a\u306fEcto\u30d7\u30ed\u30bb\u30b9\u3092\u958b\u59cb\u3055\u305b\u3001\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u30af\u30a8\u30ea\u306e\u53d7\u3051\u53d6\u308a\u53ca\u3073\u5b9f\u884c\u3059\u308b\u3053\u3068\u3092\u53ef\u80fd\u306b\u3057\u307e\u3059\u3002\u3053\u306e\u8a2d\u5b9a\u306a\u3057\u3067\u306f\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306b\u554f\u3044\u5408\u308f\u305b\u3059\u308b\u3053\u3068\u306f\u5168\u304f\u3067\u304d\u306a\u3044\u3067\u3057\u3087\u3046!\n\n\u6700\u5f8c\u306b\u30b8\u30a7\u30cd\u30ec\u30fc\u30bf\u304c\u81ea\u52d5\u3067\u52a0\u3048\u3066\u304f\u308c\u305f\u308a\u306f\u3057\u306a\u3044\u306e\u3067\u3001\u81ea\u5206\u81ea\u8eab\u3092`config/config.exs` \u306b\u4ee5\u4e0b\u306e\u30b3\u30fc\u30c9\u3092\u8ffd\u52a0\u3057\u307e\u3059\u3002\n\n```elixir\nconfig :friends, ecto_repos: [Friends.Repo]\n```\n\n\u3053\u306e\u30b3\u30fc\u30c9\u306b\u3088\u3063\u3066\u3001`mix ecto.create` \u306a\u3069\u306e\u30b3\u30de\u30f3\u30c9\u3092\u52d5\u4f5c\u3055\u305b\u308b repo \u306b\u3064\u3044\u3066\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306b\u4f1d\u3048\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n\u4ee5\u4e0a\u306e\u8a2d\u5b9a\u3067\u3001\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306b\u554f\u3044\u5408\u308f\u305b\u3092\u884c\u3046\u3053\u3068\u304c\u3067\u304d\u308b\u3088\u3046\u306b\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u8a2d\u5b9a\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3057\u305f\u3002\u7d9a\u3044\u3066\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u30fb\u30c6\u30fc\u30d6\u30eb\u3092\u4f5c\u6210\u3057\u3066\u554f\u3044\u5408\u308f\u305b\u3092\u884c\u3063\u3066\u307f\u307e\u3057\u3087\u3046\u3002\n\n## \u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306e\u8a2d\u5b9a\n\n\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3078\u554f\u3044\u5408\u308f\u305b\u3092\u3059\u308b\u305f\u3081\u306b\u306f\u3001\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u304c\u5b58\u5728\u3057\u3066\u306a\u3051\u308c\u3070\u306a\u308a\u307e\u305b\u3093\u3002\u6b21\u306e\u30b3\u30de\u30f3\u30c9\u3067\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\n```\nmix ecto.create\n```\n\n\u3082\u3057\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u304c\u3059\u3067\u306b\u4f5c\u3089\u308c\u3066\u3044\u308b\u306a\u3089\u3070\u3001\u6b21\u306e\u30e1\u30c3\u30bb\u30fc\u30b8\u304c\u8868\u793a\u3055\u308c\u307e\u3059\u3002\n\n```\nThe database for Friends.Repo has been created.\n```\n\n**NOTE:** \u3082\u3057\u30a8\u30e9\u30fc\u306b\u306a\u3063\u3066\u3057\u307e\u3063\u305f\u3089\u3001\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3078\u306e\u8a8d\u8a3c\u304c\u901a\u308b\u3088\u3046\u306b `config/config.exs` \u306e\u8a2d\u5b9a\u3092\u5909\u66f4\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\n\n\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3060\u3051\u3067\u306f\u554f\u3044\u5408\u308f\u305b\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u306a\u3044\u306e\u3067\u3001\u6b21\u306b\u30c6\u30fc\u30d6\u30eb\u3092\u4f5c\u308a\u307e\u3059\u3002\u30c6\u30fc\u30d6\u30eb\u3092\u4f5c\u308b\u306b\u306f _migration_ \u3092\u884c\u3044\u307e\u3059\u3002\u3082\u3057Active Record\u3084\u305d\u306e\u985e\u4f3c\u54c1\u3092\u77e5\u3063\u3066\u3044\u308b\u306a\u3089\u898b\u305f\u3053\u3068\u304c\u3042\u308b\u3067\u3057\u3087\u3046\u3002\u30de\u30a4\u30b0\u30ec\u30fc\u30b7\u30e7\u30f3\u306f\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3092\u69cb\u6210\u3059\u308b\u904e\u7a0b\u306e\u4e00\u3064\u306e\u30b9\u30c6\u30c3\u30d7\u3067\u3059\u3002\n\n\u30de\u30a4\u30b0\u30ec\u30fc\u30b7\u30e7\u30f3\u306f\u6b21\u306e\u30b3\u30de\u30f3\u30c9\u3067\u4f5c\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n```\nmix ecto.gen.migration create_people\n```\n\n\u3053\u306e\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3059\u308b\u3068 `priv/repo/migrations` \u306b\u65b0\u3057\u3044\u30de\u30a4\u30b0\u30ec\u30fc\u30b7\u30e7\u30f3\u7528\u306e\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u306f\u7a7a\u30d5\u30a1\u30a4\u30eb\u306b\u306a\u308a\u307e\u3059\u3002\n\n```elixir\ndefmodule Friends.Repo.Migrations.CreatePeople do\n  use Ecto.Migration\n\n  def change do\n\n  end\nend\n```\n\n\u3044\u304f\u3064\u304b\u306e\u30ab\u30e9\u30e0\u3092\u6301\u3063\u305f \"people\" \u30c6\u30fc\u30d6\u30eb\u3092\u4f5c\u308b\u306b\u306f\u3001\u3053\u306e\u30d5\u30a1\u30a4\u30eb\u306b\u3044\u304f\u3064\u304b\u30b3\u30fc\u30c9\u3092\u8ffd\u52a0\u3057\u307e\u3059\u3002\n\n```elixir\ndefmodule Friends.Repo.Migrations.CreatePeople do\n  use Ecto.Migration\n\n  def change do\n    create table(:people) do\n      add :first_name, :string\n      add :last_name, :string\n      add :age, :integer\n    end\n  end\nend\n```\n\n\u3053\u306e\u65b0\u3057\u3044\u30b3\u30fc\u30c9\u306b\u3088\u3063\u3066 `people` \u3068\u540d\u4ed8\u3051\u305f\u65b0\u3057\u3044\u30c6\u30fc\u30d6\u30eb\u3092\u4f5c\u308b\u3088\u3046\u306bEcto\u306b\u4f1d\u3048\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002`first_name`\u3001`last_name`\u3001`age` \u304c\u30ab\u30e9\u30e0\u3068\u3057\u3066\u8ffd\u52a0\u3055\u308c\u307e\u3059\u3002\u3053\u306e\u30d5\u30a3\u30fc\u30eb\u30c9\u306e\u578b\u306f `string` \u3068 `integer` \u3067\u3059\u3002(Ecto\u304c\u30b5\u30dd\u30fc\u30c8\u3059\u308b\u578b\u306f[Ecto.Schema](https://hexdocs.pm/ecto/Ecto.Schema.html)\u3067\u898b\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059)\n\n**NOTE**: Ecto\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306e\u30c6\u30fc\u30d6\u30eb\u306e\u30cd\u30fc\u30df\u30f3\u30b0\u30eb\u30fc\u30eb\u306f\u8907\u6570\u5f62\u3067\u3059\u3002\n\n\u4f5c\u6210\u3057\u305f\u30de\u30a4\u30b0\u30ec\u30fc\u30b7\u30e7\u30f3\u3092\u5b9f\u884c\u3057\u3066 `people` \u30c6\u30fc\u30d6\u30eb\u3092\u4f5c\u308b\u306b\u306f\u6b21\u306e\u30b3\u30de\u30f3\u30c9\u304c\u5fc5\u8981\u3067\u3059\u3002\n\n```\nmix ecto.migrate\n```\n\n\u30de\u30a4\u30b0\u30ec\u30fc\u30b7\u30e7\u30f3\u306b\u30df\u30b9\u3092\u898b\u3064\u3051\u305f\u3068\u304d\u306f\u3001`mix ecto.rollback` \u3067\u305d\u306e\u30de\u30a4\u30b0\u30ec\u30fc\u30b7\u30e7\u30f3\u306e\u5909\u66f4\u3092\u6253\u3061\u6d88\u3059\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\u30de\u30a4\u30b0\u30ec\u30fc\u30b7\u30e7\u30f3\u3092\u4fee\u6b63\u3057\u305f\u3089\u518d\u3073 `mix ecto.migrate` \u3092\u5b9f\u884c\u3057\u307e\u3059\u3002`mix ecto.rollback` \u3092\u4e00\u5ea6\u5b9f\u884c\u3057\u3066\u307f\u308b\u3068\u3001\u4f5c\u3089\u308c\u305f\u30c6\u30fc\u30d6\u30eb\u304c\u524a\u9664\u3055\u308c\u308b\u306e\u304c\u308f\u304b\u308b\u3067\u3057\u3087\u3046\u3002\n\n\u3053\u3053\u307e\u3067\u3067\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306b\u30c6\u30fc\u30d6\u30eb\u3092\u4f5c\u6210\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3057\u305f\u3002\u6b21\u306e\u30b9\u30c6\u30c3\u30d7\u3067\u306f\u30b9\u30ad\u30fc\u30de\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\n## \u30b9\u30ad\u30fc\u30de\u306e\u4f5c\u6210\n\n\u30b9\u30ad\u30fc\u30de\u306f\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306e\u30c7\u30fc\u30bf\u3092Elixir\u3067\u8868\u73fe\u3057\u305f\u3082\u306e\u3067\u3059\u3002\u30b9\u30ad\u30fc\u30de\u306f\u4e00\u822c\u7684\u306b\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306e\u30c6\u30fc\u30d6\u30eb\u3068\u95a2\u9023\u4ed8\u3051\u3089\u308c\u3066\u3044\u307e\u3059\u304c\u3001\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306e\u30d3\u30e5\u30fc\u3068\u3082\u540c\u69d8\u4ed8\u3051\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n`lib/friends/person.ex` \u306b\u30b9\u30ad\u30fc\u30de\u3092\u4f5c\u3063\u3066\u307f\u307e\u3057\u3087\u3046\u3002\n\n```elixir\ndefmodule Friends.Person do\n  use Ecto.Schema\n\n  schema \"people\" do\n    field :first_name, :string\n    field :last_name, :string\n    field :age, :integer\n  end\nend\n```\n\n\u3053\u306e\u30b3\u30fc\u30c9\u3067\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306e\u30b9\u30ad\u30fc\u30de\u3068\u5bfe\u5fdc\u3059\u308b\u30b9\u30ad\u30fc\u30de\u3092\u5b9a\u7fa9\u3067\u304d\u307e\u3059\u3002\u3053\u306e\u5834\u5408\u3001`Friends.Person` \u30b9\u30ad\u30fc\u30de\u306f\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306e `people` \u30c6\u30fc\u30d6\u30eb\u3001`first_name`\u30fb`last_name`\u30fb`age` \u30d5\u30a3\u30fc\u30eb\u30c9\u3068\u95a2\u9023\u4ed8\u3051\u3089\u308c\u307e\u3059\u3002\n\nEcto\u306e\u30cd\u30fc\u30df\u30f3\u30b0\u5909\u63db\u306f\u5358\u6570\u5f62\u306e\u305f\u3081\u3001\u3053\u306e\u30b9\u30ad\u30fc\u30de\u3092 `Person` \u3068\u547c\u3073\u307e\u3059\u3002\n\n\u3053\u306e\u30b9\u30ad\u30fc\u30de\u306f `iex-S mix` \u3067\u8d77\u52d5\u3057\u305fIEx\u30bb\u30c3\u30b7\u30e7\u30f3\u3067\u8a66\u3057\u3066\u307f\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\u6b21\u306e\u30b3\u30fc\u30c9\u3092\u5b9f\u884c\u3057\u3066\u307f\u307e\u3057\u3087\u3046\u3002\n\n```elixir\nperson = %Friends.Person{}\n```\n\n\u3053\u306e\u30b3\u30fc\u30c9\u3067\u65b0\u3057\u304f `Friends.Person` \u306e\u69cb\u9020\u3092\u6301\u3061\u5404\u30d5\u30a3\u30fc\u30eb\u30c9\u304c `nil` \u306e\u69cb\u9020\u4f53\u304c\u5f97\u3089\u308c\u307e\u3059\u3002\u3053\u308c\u3089\u306e\u30d5\u30a3\u30fc\u30eb\u30c9\u306f\u65b0\u3057\u304f\u69cb\u9020\u4f53\u3092\u4f5c\u308b\u3053\u3068\u3067\u5024\u3092\u30bb\u30c3\u30c8\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n```elixir\nperson = %Friends.Person{age: 28}\n```\n\n\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u6587\u6cd5\u3067\u3082\u540c\u69d8\u3067\u3059\u3002\n\n```elixir\n%{person | age: 28}\n```\n\n\u69cb\u9020\u4f53\u306e\u5024\u306f\u4ee5\u4e0b\u306e\u6587\u6cd5\u3067\u5f97\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n```elixir\nperson.age # => 28\n```\n\n\u6b21\u306b\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306b\u3069\u306e\u3088\u3046\u306b\u30c7\u30fc\u30bf\u3092\u633f\u5165\u3059\u308b\u304b\u3092\u898b\u3066\u3044\u304d\u307e\u3057\u3087\u3046\u3002\n\n## \u30c7\u30fc\u30bf\u306e\u633f\u5165\n\n`people` \u30c6\u30fc\u30d6\u30eb\u306b\u6b21\u306e\u30b3\u30fc\u30c9\u3067\u65b0\u3057\u3044\u30ec\u30b3\u30fc\u30c9\u3092\u633f\u5165\u3067\u304d\u307e\u3059\u3002\n\n```elixir\nperson = %Friends.Person{}\nFriends.Repo.insert(person)\n```\n\n\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306b\u30c7\u30fc\u30bf\u3092\u633f\u5165\u3059\u308b\u306b\u306f\u3001`Friends.Repo` \u306e `insert` \u3092\u547c\u3073\u51fa\u3057\u307e\u3059\u3002\u3053\u306e\u30e2\u30b8\u30e5\u30fc\u30eb\u306f\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3092\u4f7f\u7528\u3059\u308b\u306e\u306b Ecto \u3092\u4f7f\u7528\u3057\u3066\u3044\u307e\u3059\u3002\u3053\u306e\u95a2\u6570\u306f Ecto \u306b `Friends.Repo` \u306b\u5bfe\u5fdc\u3059\u308b\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306b \u65b0\u3057\u3044 `Friends.Person` \u30ec\u30b3\u30fc\u30c9\u3092\u633f\u5165\u3057\u305f\u3044\u3053\u3068\u3092\u4f1d\u3048\u307e\u3059\u3002\u3053\u3053\u3067\u306e `person` \u69cb\u9020\u4f53\u306f\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306b\u633f\u5165\u3057\u305f\u3044\u30c7\u30fc\u30bf\u3092\u8868\u3057\u3066\u3044\u307e\u3059\u3002\n\n\u633f\u5165\u304c\u6210\u529f\u3057\u305f\u5834\u5408\u306f\u6b21\u306e\u3088\u3046\u306a\u30bf\u30d7\u30eb\u3092\u8fd4\u3057\u307e\u3059\u3002\n\n```elixir\n{:ok,\n %Friends.Person{__meta__: #Ecto.Schema.Metadata<:loaded>, age: nil,\n  first_name: nil, id: 1, last_name: nil}}\n```\n\n`:ok` \u30a2\u30c8\u30e0\u306f\u30c7\u30fc\u30bf\u633f\u5165\u304c\u6210\u529f\u3057\u305f\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\u305f\u3081\u306b\u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u3067\u4f7f\u3046\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\u633f\u5165\u304c\u5931\u6557\u3059\u308b\u30b7\u30c1\u30e5\u30a8\u30fc\u30b7\u30e7\u30f3\u306f\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u4e0a\u3067\u5236\u7d04\u304c\u3042\u308b\u5834\u5408\u3067\u3059\u3002\u4f8b\u3048\u3070\u3001\u3082\u3057\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u304c email \u304c\u4e00\u4eba\u306e\u30ec\u30b3\u30fc\u30c9\u306e\u307f\u306b\u4f7f\u308f\u308c\u308b\u3088\u3046\u306b\u3059\u308b\u305f\u3081\u306b\u3001\u30e6\u30cb\u30fc\u30af\u5236\u7d04\u3092 `email` \u30d5\u30a3\u30fc\u30eb\u30c9\u306b\u304b\u3051\u3066\u3044\u305f\u3089\u633f\u5165\u306f\u5931\u6557\u3059\u308b\u3067\u3057\u3087\u3046\u3002\n\n\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306b\u633f\u5165\u3057\u305f\u30ec\u30b3\u30fc\u30c9\u3092\u53c2\u7167\u3057\u305f\u3044\u5834\u5408\u3001\u30bf\u30d7\u30eb\u306b\u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u3059\u308b\u3088\u3046\u306b\u3059\u308b\u3068\u826f\u3044\u3067\u3059\u3002\n\n```elixir\n{:ok, person} = Friends.Repo.insert person\n```\n\n## \u5909\u66f4\u306e\u691c\u8a3c(\u30d0\u30ea\u30c7\u30fc\u30b7\u30e7\u30f3)\n\nEcto \u3067\u306f\u3001\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306b\u5909\u66f4\u304c\u4f1d\u308f\u308b\u524d\u306b\u3001\u5909\u66f4\u306b\u30d0\u30ea\u30c7\u30fc\u30b7\u30e7\u30f3\u3092\u304b\u3051\u305f\u3044\u3068\u601d\u3046\u3067\u3057\u3087\u3046\u3002\u4f8b\u3048\u3070\u3001\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306b\u30ec\u30b3\u30fc\u30c9\u306e\u60c5\u5831\u304c\u884c\u304f\u524d\u306b\u3001\u4e00\u4eba\u306e\u4eba\u304c\u82d7\u5b57\u3068\u540d\u524d\u3092\u6301\u3063\u3066\u3044\u308b\u3053\u3068\u3092\u671b\u3080\u3068\u3057\u307e\u3057\u3087\u3046\u3002\u3053\u308c\u3092\u691c\u8a3c\u3059\u308b\u305f\u3081\u306b Ecto \u306f [_changesets_](https://hexdocs.pm/ecto/Ecto.Changeset.html) \u3092\u6301\u3063\u3066\u3044\u307e\u3059\u3002\n\n`lib/friends/person.ex` \u306e `Friends.Person` \u30e2\u30b8\u30e5\u30fc\u30eb\u306b changeset \u3092\u8ffd\u52a0\u3057\u307e\u3057\u3087\u3046\u3002\n\n```elixir\ndef changeset(person, params \\\\ %{}) do\n  person\n  |> Ecto.Changeset.cast(params, [:first_name, :last_name, :age])\n  |> Ecto.Changeset.validate_required([:first_name, :last_name])\nend\n```\n\nchangeset \u306f `person` \u3068\u30d1\u30e9\u30e1\u30fc\u30bf\u30fc\u30bb\u30c3\u30c8\u3092\u5f15\u6570\u306b\u53d6\u308a\u307e\u3059\u3002\u3053\u306e\u30d1\u30e9\u30e1\u30fc\u30bf\u30fc\u30bb\u30c3\u30c8\u306f person \u306b\u5bfe\u3057\u3066\u884c\u3044\u305f\u3044\u5909\u66f4\u3067\u3059\u3002`changeset` \u95a2\u6570\u306f\u6e21\u3055\u308c\u305f\u30d1\u30e9\u30e1\u30fc\u30bf\u30fc\u304b\u3089 `first_name` \u3068 `last_name` \u30ad\u30fc\u3092\u30ad\u30e3\u30b9\u30c8\u3057\u307e\u3059\u3002\u30ad\u30e3\u30b9\u30c8\u306f\u3069\u306e\u30d1\u30e9\u30e1\u30fc\u30bf\u30fc\u304c\u5909\u66f4\u306b\u542b\u307e\u308c\u3066\u826f\u3044\u304b\u3092\u6c7a\u3081\u3001\u30ea\u30b9\u30c8\u306b\u542b\u307e\u308c\u3066\u3044\u306a\u3044\u3082\u306e\u306f\u7121\u8996\u3055\u308c\u307e\u3059\u3002\n\n\u6b21\u306e\u884c\u3067\u306f\u3001`validate_required` \u3092\u547c\u3073\u51fa\u3057\u307e\u3059\u3002\u3053\u308c\u306f `first_name` \u3068 `last_name` \u304c\u5024\u3092\u6301\u3063\u3066\u3044\u308b\u3053\u3068\u3092\u671f\u5f85\u3057\u307e\u3059\u3002\u3053\u306e changeset \u3092\u4f7f\u3063\u3066\u3001`first_name` \u3068 `last_name` \u304c\u306a\u3044\u65b0\u3057\u3044\u30ec\u30b3\u30fc\u30c9\u3092\u4f5c\u308d\u3046\u3068\u3057\u3066\u307f\u307e\u3057\u3087\u3046\u3002\n\n```elixir\nperson = %Friends.Person{}\nchangeset = Friends.Person.changeset(person, %{})\nFriends.Repo.insert(changeset)\n```\n\n\u6700\u521d\u306e\u884c\u3067\u306f\u3001`Friends.Person` \u30e2\u30b8\u30e5\u30fc\u30eb\u304b\u3089\u69cb\u9020\u4f53\u3092\u4f5c\u6210\u3057\u3066\u3044\u307e\u3059\u3002\u5c11\u3057\u524d\u306b\u898b\u305f\u3070\u304b\u308a\u3060\u304b\u3089\u899a\u3048\u3066\u3044\u308b\u3067\u3057\u3087\u3046\u3002\u6b21\u306e\u884c\u3067\u306f changeset \u3092\u5b9a\u7fa9\u3059\u308b\u3068\u3044\u3046\u65b0\u3057\u3044\u3053\u3068\u3092\u3057\u3066\u3044\u307e\u3059\u3002\u3053\u306e changeset \u306f `person` \u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306e\u5909\u66f4\u304c\u4f5c\u3089\u308c\u308b\u306e\u3092\u898b\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\u3053\u306e\u30b1\u30fc\u30b9\u3067\u306f\u3001\u5168\u304f\u5909\u66f4\u304c\u306a\u3044\u3053\u3068\u304c\u308f\u304b\u308a\u307e\u3059\u3002\n\n\u6700\u5f8c\u306e\u884c\u3067\u306f\u3001`person` \u3092\u633f\u5165\u3059\u308b\u306e\u3067\u306f\u306a\u304f\u3001`changeset` \u3092\u633f\u5165\u3057\u3066\u3044\u307e\u3059\u3002`changeset` \u306f `person` \u3068\u305d\u306e\u5909\u66f4\u3001\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306b\u306f\u30c7\u30fc\u30bf\u304c\u884c\u304f\u524d\u306b\u884c\u308f\u308c\u308b\u3079\u304d\u30d0\u30ea\u30c7\u30fc\u30b7\u30e7\u30f3\u30eb\u30fc\u30eb\u306b\u3064\u3044\u3066\u77e5\u3063\u3066\u3044\u307e\u3059\u3002\n\n```elixir\n{:error,\n #Ecto.Changeset<action: :insert, changes: %{},\n  errors: [first_name: \"can't be blank\", last_name: \"can't be blank\"],\n  data: #Friends.Person<>, valid?: false>}\n```\n\n\u6700\u5f8c\u306b\u633f\u5165\u3092\u884c\u3063\u305f\u3068\u304d\u306e\u3088\u3046\u306b\u3001\u3053\u306e\u30b3\u30fc\u30c9\u306f\u30bf\u30d7\u30eb\u3092\u8fd4\u3057\u307e\u3059\u3002\u3057\u304b\u3057\u3001\u3053\u306e\u5834\u5408\u306f\u554f\u984c\u304c\u3042\u308b\u3053\u3068\u793a\u3059\u305f\u3081\u306b\u30bf\u30d7\u30eb\u306e\u6700\u521d\u306e\u8981\u7d20\u306f `:error` \u306b\u306a\u308a\u307e\u3059\u3002\u4f55\u304c\u8d77\u3053\u3063\u305f\u304b\u306f\u8fd4\u3063\u3066\u304d\u305f changeset \u306b\u542b\u307e\u308c\u3066\u3044\u307e\u3059\u3002\u3053\u308c\u306f\u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u3092\u3059\u308b\u3053\u3068\u304c\u53d6\u308a\u51fa\u3059\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n```elixir\n{:error, changeset} = Friends.Repo.insert(changeset)\n```\n\n`changeset.errors` \u3092\u884c\u3046\u3053\u3068\u3067\u30a8\u30e9\u30fc\u3092\u5f97\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n```elixir\n[first_name: \"can't be blank\", last_name: \"can't be blank\"]\n```\n\n\u633f\u5165\u3092\u884c\u3046\u524d\u306b\u3067\u3082\u3001`changeset` \u305d\u308c\u81ea\u4f53\u304c\u6b63\u3057\u3044\u304b\u3092\u691c\u8a3c\u3067\u304d\u307e\u3059\u3002\n\n```elixir\nchangeset.valid?\n#=> false\n```\n\n\u3053\u306e changeset \u306f\u30a8\u30e9\u30fc\u3092\u6301\u3063\u3066\u3044\u308b\u306e\u3067\u3001`people` \u30c6\u30fc\u30d6\u30eb\u306b\u306f\u4f55\u3082\u633f\u5165\u3055\u308c\u307e\u305b\u3093\u3002\n\n\u6b63\u3057\u3044\u30c7\u30fc\u30bf\u3067\u3082\u8a66\u3057\u3066\u307f\u307e\u3057\u3087\u3046\u3002\n\n```elixir\nperson = %Friends.Person{}\nchangeset = Friends.Person.changeset(person, %{first_name: \"Ryan\", last_name: \"Bigg\"})\n```\n\n\u666e\u901a\u306e `Friends.Person` \u69cb\u9020\u4f53\u304b\u3089\u306f\u3058\u3081\u3066\u307f\u307e\u3057\u3087\u3046\u3002\u6b21\u306b `first_name` \u3068 `last_name` \u30d1\u30e9\u30e1\u30fc\u30bf\u30fc\u304c\u6307\u5b9a\u3055\u308c\u305f `person` \u306e changeset \u3092\u4f5c\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\u3053\u306e\u6642\u70b9\u3067 changeset \u306b\u30a8\u30e9\u30fc\u304c\u3042\u308b\u304b\u3069\u3046\u304b\u3092\u5c0b\u306d\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n\n```elixir\nchangeset.errors\n#=> []\n```\n\n\u305d\u3057\u3066\u3001\u3053\u306e\u30c7\u30fc\u30bf\u304c\u6b63\u3057\u3044\u304b\u305d\u3046\u3067\u306a\u3044\u304b\u3092\u5c0b\u306d\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n```elixir\nchangeset.valid?\n#=> true\n```\n\nchangeset \u306f\u30a8\u30e9\u30fc\u3092\u6301\u305f\u306a\u3044\u305f\u3081\u6b63\u3057\u3044\u3053\u3068\u304c\u308f\u304b\u308a\u307e\u3059\u3002\u3053\u306e\u3053\u3068\u304b\u3089\u3001\u3053\u306e changeset \u3092\u633f\u5165\u3057\u3088\u3046\u3068\u3057\u305f\u5834\u5408\u3001\u305d\u308c\u306f\u9069\u5207\u306b\u52d5\u4f5c\u3057\u307e\u3059\u3002\n\n```elixir\nFriends.Repo.insert(changeset)\n#=> {:ok,\n     %Friends.Person{__meta__: #Ecto.Schema.Metadata<:loaded>, age: nil,\n      first_name: \"Ryan\", id: 3, last_name: \"Bigg\"}}\n```\n\n`Friends.Repo.insert` \u304c\u30bf\u30d7\u30eb\u3092\u8fd4\u3059\u306e\u3067\u3001`case` \u3092\u4f7f\u3046\u3053\u3068\u3067\u3001\u4f55\u304c\u8d77\u3053\u3063\u305f\u304b\u306b\u3088\u3063\u3066\u3069\u306e\u30b3\u30fc\u30c9\u3092\u4f7f\u7528\u3059\u308b\u304b\u6c7a\u3081\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n```elixir\ncase Friends.Repo.insert(changeset) do\n  {:ok, person} ->\n    # do something with person\n  {:error, changeset} ->\n    # do something with changeset\nend\n```\n\n**NOTE:** `changeset.valid?` \u306f uniqueness_constraint \u306e\u3088\u3046\u306a\u5236\u7d04\u306e\u30c1\u30a7\u30c3\u30af\u306f\u884c\u3044\u307e\u305b\u3093\u3002\u3053\u306e\u305f\u3081\u3001\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306b\u633f\u5165\u3092\u884c\u3063\u3066\u307f\u3066\u30a8\u30e9\u30fc\u3092\u30c1\u30a7\u30c3\u30af\u3059\u308b\u3053\u3068\u304c\u5fc5\u8981\u3068\u306a\u308a\u307e\u3059\u3002\u3053\u306e\u3053\u3068\u304b\u3089\u3001\u5b9f\u969b\u306b\u30c7\u30fc\u30bf\u633f\u5165\u3092\u884c\u3063\u3066\u307f\u3066\u3001`Friends.Repo.insert` \u306e\u623b\u308a\u5024\u306e\u30bf\u30d7\u30eb\u3092\u691c\u8a3c\u3059\u308b\u3053\u3068\u304c\u6b63\u3057\u3044\u30a8\u30e9\u30fc\u3092\u5f97\u308b\u305f\u3081\u306e\u30d9\u30b9\u30c8\u30d7\u30e9\u30af\u30c6\u30a3\u30b9\u306b\u306a\u308b\u3067\u3057\u3087\u3046\u3002\u633f\u5165\u3059\u308b\u524d\u306e changeset \u306f\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u30ec\u30d9\u30eb\u306e\u30d0\u30ea\u30c7\u30fc\u30b7\u30e7\u30f3\u30a8\u30e9\u30fc\u3057\u304b\u542b\u307e\u306a\u3044\u304b\u3089\u3067\u3059\u3002\n\nchangeset \u306e\u633f\u5165\u304c\u6210\u529f\u3057\u305f\u3089\u3001\u7d50\u679c\u306b\u542b\u307e\u308c\u308b `person` \u3092\u3069\u306e\u3088\u3046\u306a\u3053\u3068\u306b\u3067\u3082\u5229\u7528\u3067\u304d\u307e\u3059\u3002\u3082\u3057\u5931\u6557\u3057\u305f\u3089\u3001changeset \u3092\u53c2\u7167\u3057\u3066\u305d\u306e\u30a8\u30e9\u30fc\u3092\u898b\u307e\u3057\u3087\u3046\u3002\u5931\u6557\u306e\u5834\u5408\u3001\u30a8\u30f3\u30c9\u30e6\u30fc\u30b6\u30fc\u306b\u305d\u308c\u3092\u8868\u793a\u3057\u305f\u3044\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u3002changeset \u306e\u30a8\u30e9\u30fc\u306f\u6b21\u306e\u3088\u3046\u306a\u30ad\u30fc\u30ef\u30fc\u30c9\u306e\u30ea\u30b9\u30c8\u3067\u3059\u3002\n\n\n```elixir\n[first_name: {\"can't be blank\", []},\n last_name: {\"can't be blank\", []}]\n```\n\n\u30bf\u30d7\u30eb\u306e\u6700\u521d\u306e\u8981\u7d20\u306f\u30d0\u30ea\u30c7\u30fc\u30b7\u30e7\u30f3\u30e1\u30c3\u30bb\u30fc\u30b8\u3067\u3001\u6b21\u306e\u8981\u7d20\u304c\u30d0\u30ea\u30c7\u30fc\u30b7\u30e7\u30f3\u30e1\u30c3\u30bb\u30fc\u30b8\u306b\u5bfe\u3059\u308b\u30aa\u30d7\u30b7\u30e7\u30f3\u306e\u30ad\u30fc\u30ef\u30fc\u30c9\u306e\u30ea\u30b9\u30c8\u3067\u3059\u3002`validate_required/3` \u30d0\u30ea\u30c7\u30fc\u30b7\u30e7\u30f3\u306f\u30aa\u30d7\u30b7\u30e7\u30f3\u3092\u8fd4\u3057\u307e\u305b\u3093\u304c\u3001\u4ed6\u306e `validate_length/3` \u306e\u3088\u3046\u306a\u30e1\u30bd\u30c3\u30c9\u306f\u8fd4\u3057\u307e\u3059\u3002`bio` \u3068\u3044\u3046\u30d0\u30ea\u30c7\u30fc\u30b7\u30e7\u30f3\u3092\u3057\u3066\u3044\u305f\u30d5\u30a3\u30fc\u30eb\u30c9\u304c\u3042\u308a\u3001\u305d\u306e\u30d5\u30a3\u30fc\u30eb\u30c9\u304c15\u6587\u5b57\u4ee5\u4e0a\u3067\u306a\u3051\u308c\u3070\u3044\u3051\u306a\u3044\u3068\u3057\u307e\u3057\u3087\u3046\u3002\u3053\u308c\u306b\u5927\u3057\u3066\u306f\u6b21\u306e\u30b3\u30fc\u30c9\u304c\u8fd4\u3055\u308c\u307e\u3059\u3002\n\n\n```elixir\n[first_name: {\"can't be blank\", []},\n last_name: {\"can't be blank\", []},\n bio: {\"should be at least %{count} characters\", [count: 15]}]\n```\n\n\u4eba\u304c\u898b\u308b\u306e\u306b\u512a\u3057\u3044\u65b9\u6cd5\u3067\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u8868\u793a\u3055\u305b\u308b\u306b\u306f\u3001`Ecto.Changeset.traverse_errors/2` \u3092\u4f7f\u3046\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n\n```elixir\ntraverse_errors(changeset, fn {msg, opts} ->\n  Enum.reduce(opts, msg, fn {key, value}, acc ->\n    String.replace(msg, \"%{#{key}}\", to_string(value))\n  end)\nend)\n```\n\n\u3053\u308c\u306f\u4e0a\u3067\u8868\u793a\u3055\u308c\u305f\u30a8\u30e9\u30fc\u306b\u5bfe\u3057\u3066\u6b21\u306e\u30b3\u30fc\u30c9\u3092\u8fd4\u3057\u307e\u3059\u3002\n\n```elixir\n%{\n  first_name: [\"can't be blank\"],\n  last_name: [\"can't be blank\"],\n   bio: [\"should be at least 15 characters\"],\n}\n```\n\n\u6700\u5f8c\u306b\u8a00\u3044\u305f\u3044\u3053\u3068\u306f\u3001`Friends.Repo.insert!/2` \u3092\u4f7f\u3046\u3053\u3068\u3067\u4f8b\u5916\u3092\u5f15\u304d\u8d77\u3053\u3059\u3053\u3068\u304c\u3067\u304d\u308b\u3068\u3044\u3046\u3053\u3068\u3067\u3059\u3002\u3082\u3057\u3001\u5909\u66f4\u304c\u6b63\u3057\u304f\u306a\u3044\u5834\u5408\u3001`Ecto.InvalidChangesetError` \u4f8b\u5916\u304c\u767a\u751f\u3057\u307e\u3059\u3002\u4f8b\u3092\u6b21\u306b\u793a\u3057\u307e\u3059\u3002\n\n```\nFriends.Repo.insert! Friends.Person.changeset(%Friends.Person{}, %{first_name: \"Ryan\"})\n\n** (Ecto.InvalidChangesetError) could not perform insert because changeset is invalid.\n\n* Changeset changes\n\n%{first_name: \"Ryan\"}\n\n* Changeset params\n\n%{\"first_name\" => \"Ryan\"}\n\n* Changeset errors\n\n[last_name: \"can't be blank\"]\n\n    lib/ecto/repo/schema.ex:111: Ecto.Repo.Schema.insert!/4\n```\n\n\u3053\u306e\u4f8b\u5916\u306f\u5909\u66f4\u3068\u5909\u66f4\u304c\u3069\u306e\u3088\u3046\u306b\u9593\u9055\u3063\u3066\u3044\u308b\u304b\u3092\u8868\u793a\u3057\u3066\u3044\u307e\u3059\u3002\u3053\u308c\u306f\u30c7\u30fc\u30bf\u3092\u633f\u5165\u3057\u305f\u3044\u3068\u304d\u306b\u5f79\u7acb\u3061\u3001\u30c7\u30fc\u30bf\u304c\u6b63\u3057\u304f\u633f\u5165\u3067\u304d\u306a\u3044\u5834\u5408\u306f\u4f8b\u5916\u3092\u767a\u751f\u3055\u305b\u307e\u3059\u3002\n\n\u3053\u308c\u3067\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3078\u306e\u30c7\u30fc\u30bf\u306e\u633f\u5165\u3092\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3057\u305f\u3002\u6b21\u306b\u30c7\u30fc\u30bf\u3092\u3069\u306e\u3088\u3046\u306b\u53d6\u308a\u51fa\u3059\u304b\u3092\u898b\u3066\u3044\u304d\u307e\u3057\u3087\u3046\u3002\n\n## \u6700\u521d\u306e\u30af\u30a8\u30ea\n\nEcto\u306b\u3088\u308b\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306b\u3078\u306e\u554f\u3044\u5408\u308f\u305b\u306f\u4e8c\u3064\u306e\u30b9\u30c6\u30c3\u30d7\u3092\u5fc5\u8981\u3068\u3057\u307e\u3059\u3002\u30af\u30a8\u30ea\u3092\u7d44\u307f\u7acb\u3066\u3001\u30ea\u30dd\u30b8\u30c8\u30ea\u306b\u30af\u30a8\u30ea\u3092\u6e21\u3057\u3066\u5b9f\u884c\u3057\u307e\u3059\u3002\u3053\u308c\u3092\u3059\u308b\u524d\u306b\u3001\u30a2\u30d7\u30ea\u306e\u305f\u3081\u306b\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3092\u518d\u4f5c\u6210\u3057\u3001\u3044\u304f\u3064\u304b\u306e\u30c6\u30b9\u30c8\u30c7\u30fc\u30bf\u3092\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\u3057\u307e\u3057\u3087\u3046\u3002\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3092\u518d\u4f5c\u6210\u3059\u308b\u305f\u3081\u306b\u306f\u3001\u6b21\u306e\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3057\u307e\u3059\u3002\n\n```\nmix ecto.drop\nmix ecto.create\nmix ecto.migrate\n```\n\n\u305d\u3057\u3066\u3001\u30c6\u30b9\u30c8\u30c7\u30fc\u30bf\u3092\u4f5c\u308b\u305f\u3081\u306b\u3001`iex -S mix` \u30bb\u30c3\u30b7\u30e7\u30f3\u3067\u6b21\u306e\u30b3\u30fc\u30c9\u3092\u5b9f\u884c\u3057\u307e\u3059\u3002\n\n```elixir\npeople = [\n  %Friends.Person{first_name: \"Ryan\", last_name: \"Bigg\", age: 28},\n  %Friends.Person{first_name: \"John\", last_name: \"Smith\", age: 27},\n  %Friends.Person{first_name: \"Jane\", last_name: \"Smith\", age: 26},\n]\n\nEnum.each(people, fn (person) -> Friends.Repo.insert(person) end)\n```\n\n\u3053\u306e\u30b3\u30fc\u30c9\u306f\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306b\u3001Ryan\u3001John\u3001Jane\u306e\u4e09\u3064\u306e people \u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\u30c7\u30fc\u30bf\u3092\u691c\u8a3c\u3059\u308b\u306e\u306b changeset \u304c\u4f7f\u3048\u307e\u3059\u304c\u3001\u4eca\u56de\u306f\u3057\u3066\u3044\u307e\u305b\u3093\u3002\n\n\u6b21\u306e\u30bb\u30af\u30b7\u30e7\u30f3\u3067\u306f people \u306b\u8db3\u3057\u3066\u554f\u3044\u5408\u308f\u305b\u3092\u884c\u3044\u307e\u3057\u3087\u3046\u3002\u3055\u3041\u6b21\u3078\uff01\n\n### \u5358\u4e00\u30ec\u30b3\u30fc\u30c9\u306e\u53d6\u308a\u51fa\u3057\n\n`people` \u30c6\u30fc\u30d6\u30eb\u304b\u3089\u4e00\u3064\u306e\u30ec\u30b3\u30fc\u30c9\u3092\u53d6\u308a\u51fa\u3059\u3053\u3068\u304b\u3089\u59cb\u3081\u307e\u3057\u3087\u3046\u3002\n\n```elixir\nFriends.Person |> Ecto.Query.first\n```\n\n\u3053\u306e\u30b3\u30fc\u30c9\u306f\u6b21\u306e\u3088\u3046\u306a `Ecto.Query` \u3092\u4f5c\u308a\u51fa\u3057\u307e\u3059\u3002\n\n```\n#Ecto.Query<from p in Friends.Person, order_by: [asc: p.id], limit: 1>\n```\n\u3000\u3000\n\u89d2\u30ab\u30c3\u30b3 `<...>` \u306e\u9593\u306e\u30b3\u30fc\u30c9\u306f\u7d44\u307f\u7acb\u3066\u3089\u308c\u305f Ecto \u30af\u30a8\u30ea\u3092\u8868\u3057\u3066\u3044\u307e\u3059\u3002\u6b21\u306e\u3088\u3046\u306a\u307b\u3068\u3093\u3069\u540c\u3058\u3088\u3046\u306a\u30b7\u30f3\u30bf\u30c3\u30af\u30b9\u3067\u3082\u3053\u306e\u30af\u30a8\u30ea\u3092\u7d44\u307f\u7acb\u3066\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n```elixir\nrequire Ecto.Query\nEcto.Query.from p in Friends.Person, order_by: [asc: p.id], limit: 1\n```\n\n\u30de\u30af\u30ed\u3092\u6709\u52b9\u306b\u3059\u308b\u305f\u3081 `require Ecto.Query` \u3092\u5fc5\u8981\u3068\u3057\u307e\u3059\u3002`Ecto.Query` \u306e `from` \u3092\u547c\u3073\u51fa\u3057\u3001\u89d2\u30ab\u30c3\u30b3\u306e\u9593\u3092\u6e21\u3057\u307e\u3059\u3002\u3053\u3053\u3067\u898b\u3066\u3044\u308b\u3088\u3046\u306b\u3001`Ecto.Query.first` \u3092\u4f7f\u3046\u3053\u3068\u3067 `order` \u3068 `limit` \u3092\u4f7f\u308f\u306a\u304f\u3066\u3082\u6e08\u307f\u307e\u3059\u3002\n\n\u3053\u306e\u30af\u30a8\u30ea\u3092\u5b9f\u884c\u3059\u308b\u305f\u3081\u306b\u306f\u3001`Friends.Repo.one` \u3092\u547c\u3073\u51fa\u3057\u307e\u3059\u3002\n\n```elixir\nFriends.Person |> Ecto.Query.first |> Friends.Repo.one\n```\n\n`one` \u95a2\u6570\u306f\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u304b\u3089\u4e00\u3064\u3060\u3051\u30ec\u30b3\u30fc\u30c9\u3092\u53d6\u308a\u51fa\u3057\u3001`Friends.Person` \u30e2\u30b8\u30e5\u30fc\u30eb\u5185\u306e\u65b0\u3057\u3044\u69cb\u9020\u4f53\u3092\u8fd4\u3057\u307e\u3059\u3002\n\n```elixir\n%Friends.Person{__meta__: #Ecto.Schema.Metadata<:loaded>, age: 28,\n first_name: \"Ryan\", id: 1, last_name: \"Bigg\"}\n```\n\n`first` \u3082\u540c\u69d8\u3067\u3001`last` \u3068\u3044\u3046\u95a2\u6570\u3082\u3042\u308a\u307e\u3059\u3002\n\n```elixir\nFriends.Person |> Ecto.Query.last |> Friends.Repo.one\n#=> %Friends.Person{__meta__: #Ecto.Schema.Metadata<:loaded>, age: 26,\n     first_name: \"Jane\", id: 3, last_name: \"Smith\"}\n ```\n\n`Ecto.Repo.one` \u95a2\u6570\u306f\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306e\u30ec\u30b3\u30fc\u30c9\u304c\u4e00\u3064\u3060\u3051\u306a\u3089\u3070\u3001\u4e00\u3064\u69cb\u9020\u4f53\u3092\u8fd4\u3057\u307e\u3059\u3002\u4e00\u3064\u4ee5\u4e0a\u30ec\u30b3\u30fc\u30c9\u304c\u3042\u3063\u305f\u3089\u3001`Ecto.MultipleResultsError` \u4f8b\u5916\u304c\u6295\u3052\u3089\u308c\u307e\u3059\u3002\u6b21\u306e\u30b3\u30fc\u30c9\u306f\u305d\u306e\u554f\u984c\u3092\u5f15\u304d\u8d77\u3053\u3057\u307e\u3059\u3002\n\n```elixir\nFriends.Person |> Friends.Repo.one\n```\n\n`Ecto.Query.first` \u304c\u306a\u304f\u3001\u30af\u30a8\u30ea\u306b\u5bfe\u3057\u3066\u5b9f\u884c\u3055\u308c\u308b `limit` \u3084 `order` \u53e5\u3082\u3042\u308a\u307e\u305b\u3093\u3002\u30c7\u30d0\u30c3\u30b0\u30ed\u30b0\u3067\u5b9f\u884c\u3055\u308c\u308b\u30af\u30a8\u30ea\u3092\u898b\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n```\n[timestamp] [debug] SELECT p0.\"id\", p0.\"first_name\", p0.\"last_name\", p0.\"age\" FROM \"people\" AS p0 [] OK query=1.8ms\n```\n\n\u3053\u306e\u3059\u3050\u5f8c\u306b `Ecto.MultipleResultsError` \u4f8b\u5916\u304c\u767a\u751f\u3057\u307e\u3059\u3002\n\n```\n** (Ecto.MultipleResultsError) expected at most one result but got 3 in query:\n\nfrom p in Friends.Person\n\n    lib/ecto/repo/queryable.ex:67: Ecto.Repo.Queryable.one/4\n```\n\n\u3053\u308c\u306f Ecto \u304c\u8907\u6570\u306e\u30ec\u30b3\u30fc\u30c9\u304c\u3042\u308b\u3068\u63a2\u3057\u3066\u3044\u308b\u30ec\u30b3\u30fc\u30c9\u304c\u4e0d\u660e\u3067\u3042\u308b\u305f\u3081\u306b\u8d77\u3053\u308a\u307e\u3059\u3002Ecto \u306f\u63a2\u3057\u3066\u3044\u308b\u3082\u306e\u304c\u660e\u793a\u7684\u306a\u30af\u30a8\u30ea\u306b\u306e\u307f\u7d50\u679c\u3092\u8fd4\u3057\u307e\u3059\u3002\n\n\u30af\u30a8\u30ea\u306b\u30de\u30c3\u30c1\u3059\u308b\u30ec\u30b3\u30fc\u30c9\u304c\u306a\u3044\u5834\u5408\u306f\u3001`one` \u306f `nil` \u3092\u8fd4\u3057\u307e\u3059\u3002\n\n### Fetching all records\n### \u5168\u30ec\u30b3\u30fc\u30c9\u306e\u53d6\u308a\u51fa\u3057\n\n\u30b9\u30ad\u30fc\u30de\u304b\u3089\u5168\u3066\u306e\u30ec\u30b3\u30fc\u30c9\u3092\u53d6\u308a\u51fa\u3059\u305f\u3081\u306b\u3001Ecto \u306f `all` \u95a2\u6570\u3092\u6301\u3063\u3066\u3044\u307e\u3059\u3002\n\n```elixir\nFriends.Person |> Friends.Repo.all\n```\n\n\u3053\u308c\u306f\u3001`people` \u30c6\u30fc\u30d6\u30eb\u306b\u73fe\u5728\u5165\u3063\u3066\u3044\u308b\u30ec\u30b3\u30fc\u30c9\u3092 `Friends.Person` \u69cb\u9020\u4f53\u5f62\u5f0f\u3067\u8fd4\u3057\u307e\u3059\u3002\n\n```elixir\n[%Friends.Person{__meta__: #Ecto.Schema.Metadata<:loaded>, age: 28,\n  first_name: \"Ryan\", id: 1, last_name: \"Bigg\"},\n %Friends.Person{__meta__: #Ecto.Schema.Metadata<:loaded>, age: 27,\n  first_name: \"John\", id: 2, last_name: \"Smith\"},\n %Friends.Person{__meta__: #Ecto.Schema.Metadata<:loaded>, age: 26,\n  first_name: \"Jane\", id: 3, last_name: \"Smith\"}]\n```\n\n### ID\u3092\u3082\u3068\u306b\u3057\u305f\u5358\u4e00\u30ec\u30b3\u30fc\u30c9\u306e\u53d6\u308a\u51fa\u3057\n\nID \u3092\u3082\u3068\u306b\u30ec\u30b3\u30fc\u30c9\u3092\u53d6\u308a\u51fa\u3059\u3068\u304d\u306f `get` \u95a2\u6570\u3092\u4f7f\u3044\u307e\u3059\u3002\n\n```elixir\nFriends.Person |> Friends.Repo.get(1)\n%Friends.Person{__meta__: #Ecto.Schema.Metadata<:loaded>, age: 28,\n first_name: \"Ryan\", id: 1, last_name: \"Bigg\"}\n```\n\n### \u7279\u5b9a\u306e\u5c5e\u6027\u3092\u3082\u3068\u306b\u3057\u305f\u5358\u4e00\u30ec\u30b3\u30fc\u30c9\u306e\u53d6\u308a\u51fa\u3057\n\n`id` \u4ee5\u5916\u306e\u5c5e\u6027\u3092\u3082\u3068\u306b\u30ec\u30b3\u30fc\u30c9\u3092\u53d6\u308a\u51fa\u3057\u305f\u3044\u5834\u5408\u306f\u3001`get_by` \u95a2\u6570\u3092\u4f7f\u3046\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n```elixir\n Friends.Person |> Friends.Repo.get_by(first_name: \"Ryan\")\n %Friends.Person{__meta__: #Ecto.Schema.Metadata<:loaded>, age: 28,\n  first_name: \"Ryan\", id: 1, last_name: \"Bigg\"}\n```\n\n### \u30d5\u30a3\u30eb\u30bf\u30ea\u30f3\u30b0\n\n\u7279\u5b9a\u306e\u5c5e\u6027\u306b\u30de\u30c3\u30c1\u3059\u308b\u8907\u6570\u306e\u30ec\u30b3\u30fc\u30c9\u3092\u53d6\u308a\u51fa\u3059\u305f\u3081\u306b\u306f `where` \u304c\u4f7f\u3048\u307e\u3059\u3002\n\n```elixir\nFriends.Person |> Ecto.Query.where(last_name: \"Smith\") |> Friends.Repo.all\n```\n\n```elixir\n[%Friends.Person{__meta__: #Ecto.Schema.Metadata<:loaded>, age: 27,\n  first_name: \"John\", id: 2, last_name: \"Smith\"},\n %Friends.Person{__meta__: #Ecto.Schema.Metadata<:loaded>, age: 26,\n  first_name: \"Jane\", id: 3, last_name: \"Smith\"}]\n```\n\n\u3082\u3057\u3001\u672b\u5c3e\u306e `Friends.Repo.all` \u304c\u306a\u3044\u5834\u5408\u3001Ecto \u304c\u6b21\u306e\u30af\u30a8\u30ea\u3092\u751f\u6210\u3059\u308b\u306e\u304c\u308f\u304b\u308b\u3067\u3057\u3087\u3046\u3002\n\n```\n#Ecto.Query<from p in Friends.Person, where: p.last_name == \"Smith\">\n```\n\n\u540c\u3058\u30ec\u30b3\u30fc\u30c9\u3092\u53d6\u308a\u51fa\u3059\u306e\u306b\u3053\u306e\u30af\u30a8\u30ea\u30b7\u30f3\u30bf\u30c3\u30af\u30b9\u3092\u4f7f\u3046\u3053\u3068\u3082\u3067\u304d\u307e\u3059\u3002\n\n\n```elixir\nEcto.Query.from(p in Friends.Person, where: p.last_name == \"Smith\") |> Friends.Repo.all\n```\n\n\u3069\u3061\u3089\u306e\u30af\u30a8\u30ea\u30b7\u30f3\u30bf\u30c3\u30af\u30b9\u306b\u3064\u3044\u3066\u3082\u30d4\u30f3\u6f14\u7b97\u5b50(`^`)\u3092\u4f7f\u3063\u3066\u3001\u30d4\u30f3\u3055\u308c\u305f\u5909\u6570\u3092\u5fc5\u8981\u3068\u3057\u307e\u3059\u3002\n\n```elixir\nlast_name = \"Smith\"\nFriends.Person |> Ecto.Query.where(last_name: last_name) |> Friends.Repo.all\n```\n\n```\n** (Ecto.Query.CompileError) variable `last_name` is not a valid query expression.\n  Variables need to be explicitly interpolated in queries with ^\n             expanding macro: Ecto.Query.where/2\n             iex:1: (file)\n    (elixir) expanding macro: Kernel.|>/2\n             iex:1: (file)\n```\n\n\u3088\u308a\u9577\u3044\u30af\u30a8\u30ea\u30b7\u30f3\u30bf\u30c3\u30af\u30b9\u3067\u3082\u540c\u3058\u3053\u3068\u304c\u8d77\u3053\u308a\u307e\u3059\u3002\n\n```elixir\nEcto.Query.from(p in Friends.Person, where: p.last_name == last_name) |> Friends.Repo.all\n```\n\n```\n** (Ecto.Query.CompileError) variable `last_name` is not a valid query expression. \n  Variables need to be explicitly interpolated in queries with ^\n             expanding macro: Ecto.Query.where/3\n             iex:1: (file)\n             expanding macro: Ecto.Query.from/2\n             iex:1: (file)\n    (elixir) expanding macro: Kernel.|>/2\n             iex:1: (file)\n```\n\n\u3053\u308c\u3092\u5b9f\u884c\u3057\u3066\u30c7\u30fc\u30bf\u3092\u53d6\u308a\u51fa\u3059\u306b\u306f\u3001\u30d4\u30f3\u6f14\u7b97\u5b50(`^`)\u3092\u4f7f\u3044\u307e\u3059\u3002\n\n```elixir\nlast_name = \"Smith\"\nFriends.Person |> Ecto.Query.where(last_name: ^last_name) |> Friends.Repo.all\n```\n\n\u3082\u3057\u304f\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u3001\n\n```elixir\nlast_name = \"Smith\"\nEcto.Query.from(p in Friends.Person, where: p.last_name == ^last_name) |> Friends.Repo.all\n```\n\n\u30d4\u30f3\u6f14\u7b97\u5b50\u306f\u30af\u30a8\u30ea\u30d3\u30eb\u30c0\u30fc\u306bSQL\u30a4\u30f3\u30b8\u30a7\u30af\u30b7\u30e7\u30f3\u5bfe\u7b56\u304c\u65bd\u3055\u308c\u305f\u30d1\u30e9\u30e1\u30fc\u30bf\u30fc\u5316\u3055\u308c\u305fSQL\u30af\u30a8\u30ea\u3092\u4f7f\u3046\u3088\u3046\u306b\u3057\u307e\u3059\u3002\n\n### Ecto\u30af\u30a8\u30ea\u306e\u7d44\u307f\u7acb\u3066\n\nEcto\u30af\u30a8\u30ea\u306f\u4e00\u3064\u306e\u5834\u6240\u3067\u7d44\u307f\u7acb\u3066\u308b\u5fc5\u8981\u306f\u3042\u308a\u307e\u305b\u3093\u3002\u3059\u3067\u306b\u5b58\u5728\u3059\u308b\u30af\u30a8\u30ea\u304b\u3089 `Ecto.Query` \u95a2\u6570\u3092\u547c\u3073\u51fa\u3059\u3053\u3068\u3067\u30af\u30a8\u30ea\u3092\u4f5c\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\u4f8b\u3048\u3070\u3001\u540d\u524d\u304c \"Smith\" \u3067\u3042\u308b\u5168\u3066\u306e\u4eba\u3092\u898b\u3064\u3051\u305f\u3044\u3068\u3057\u307e\u3057\u3087\u3046\u3002\u6b21\u306e\u3088\u3046\u306b\u3067\u304d\u307e\u3059\u3002\n\n```elixir\nquery = Friends.Person |> Ecto.Query.where(last_name: \"Smith\") \n```\n\n\u82d7\u5b57\u304c \"Jane\" \u306e\u4eba\u3060\u3051\u306b\u30b9\u30b3\u30fc\u30d7\u3092\u7d5e\u308a\u305f\u3044\u306a\u3089\u3070\u3001\u6b21\u306e\u3088\u3046\u306b\u3067\u304d\u307e\u3059\u3002\n\n```elixir\nquery = query |> Ecto.Query.where(first_name: \"Jane\")\n```\n\n\u30af\u30a8\u30ea\u306f\u3053\u306e\u6642\u70b9\u3067\u4e8c\u3064\u306e `where` \u53e5\u3092\u6301\u3064\u3053\u3068\u306b\u306a\u308a\u307e\u3059\u3002\n\n```\n#Ecto.Query<from p in Friends.Person, where: p.last_name == \"Smith\",\n where: p.first_name == \"Jane\">\n```\n\n\u3053\u308c\u306f\u6700\u521d\u306e\u30af\u30a8\u30ea\u3067\u4f55\u304b\u4f5c\u696d\u3092\u3057\u3066\u304b\u3089\u3001\u305d\u306e\u5f8c\u3067\u305d\u306e\u30af\u30a8\u30ea\u3092\u4f7f\u3063\u3066\u5225\u306a\u30af\u30a8\u30ea\u3092\u69cb\u7bc9\u3059\u308b\u306e\u306b\u5f79\u7acb\u3061\u307e\u3059\u3002\n\n## \u30ec\u30b3\u30fc\u30c9\u306e\u66f4\u65b0\n\n\u30ec\u30b3\u30fc\u30c9\u3092 Ecto \u3067\u66f4\u65b0\u3059\u308b\u306b\u306f\u3001\u6700\u521d\u306b\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u304b\u3089\u30ec\u30b3\u30fc\u30c9\u3092\u53d6\u308a\u51fa\u3059\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\u305d\u306e\u5f8c\u3067\u3001\u30ec\u30b3\u30fc\u30c9\u304b\u3089 changeset \u3068\u30ec\u30b3\u30fc\u30c9\u306b\u5bfe\u3059\u308b\u5909\u66f4\u3092\u69cb\u6210\u3057\u3001`Ecto.Repo.update` \u95a2\u6570\u3092\u547c\u3073\u51fa\u3057\u307e\u3059\u3002\n\n\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u304b\u3089\u6700\u521d\u306e person \u30ec\u30b3\u30fc\u30c9\u3092\u53d6\u308a\u51fa\u3057\u3001\u5e74\u9f62(age)\u3092\u5909\u66f4\u3057\u3066\u307f\u307e\u3057\u3087\u3046\u3002\u6700\u521d\u306b person \u3092\u53d6\u308a\u51fa\u3057\u307e\u3059\u3002\n\n```elixir\nperson = Friends.Person |> Ecto.Query.first |> Friends.Repo.one\n```\n\n\u6b21\u306b\u3001changeset \u3092\u4f5c\u308a\u307e\u3059\u3002\u5358\u306b\u65b0\u3057\u3044\u5e74\u9f62(age)\u3092\u6301\u3063\u305f\u65b0\u3057\u3044 `Friends.Person` \u69cb\u9020\u4f53\u3092\u4f5c\u308b\u306e\u3067\u3001changeset \u304c\u5fc5\u8981\u306b\u306a\u308a\u307e\u3059\u3002Ecto \u306f\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3068\u306e\u9023\u643a\u306a\u3057\u3067\u306f\u5e74\u9f62\u304c\u5909\u66f4\u3055\u308c\u308b\u304b\u3092\u77e5\u308b\u3053\u3068\u304c\u3067\u304d\u306a\u3044\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u3002changeset \u3092\u4f5c\u3063\u3066\u307f\u307e\u3057\u3087\u3046\u3002\n\n\n```elixir\nchangeset = Friends.Person.changeset(person, %{age: 29})\n```\n\nchangeset \u306f\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306b\u5e74\u9f62\u304c29\u306b\u3059\u308b\u305f\u3081\u306b\u30ec\u30b3\u30fc\u30c9\u3092\u66f4\u65b0\u3057\u305f\u3044\u3053\u3068\u3092\u77e5\u3089\u305b\u307e\u3059\u3002\u5909\u66f4\u306b\u3064\u3044\u3066\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3068\u3084\u308a\u53d6\u308a\u3059\u308b\u305f\u3081\u306b\u3001\u6b21\u306e\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3057\u307e\u3059\u3002\n\n```elixir\nFriends.Repo.update(changeset)\n```\n\n`Friends.Repo.insert` \u3068\u540c\u3058\u3088\u3046\u306b\u3001`Friends.Repo.update` \u306f\u30bf\u30d7\u30eb\u3092\u8fd4\u3057\u307e\u3059\u3002\n\n```elixir\n{:ok,\n %Friends.Person{__meta__: #Ecto.Schema.Metadata<:loaded>, age: 29,\n  first_name: \"Ryan\", id: 1, last_name: \"Bigg\"}}\n```\n\n\u4f55\u304b\u306e\u7406\u7531\u3067 changeset \u304c\u5931\u6557\u3057\u305f\u3089\u3001`Friends.Repo.update` \u306e\u7d50\u679c\u306f `{:error, changeset}` \u306b\u306a\u308a\u307e\u3059\u3002\u3053\u308c\u306f `first_name` \u304c\u7a7a\u306b\u306a\u308b\u3088\u3046\u306b changeset \u306e\u30d1\u30e9\u30e1\u30fc\u30bf\u30fc\u3092\u5909\u3048\u308b\u3053\u3068\u3067\u5f15\u304d\u8d77\u3053\u3059\u3053\u3068\u3082\u3067\u304d\u307e\u3059\u3002\n\n```elixir\nchangeset = Friends.Person.changeset(person, %{first_name: \"\"})\n#=> {:error,\n     #Ecto.Changeset<action: :update, changes: %{first_name: \"\"},\n      errors: [first_name: \"can't be blank\"], data: #Friends.Person<>,\n      valid?: false>}\n```\n\n\u3053\u306e\u3053\u3068\u306f `update` \u95a2\u6570\u304b\u3089\u306e\u7d50\u679c\u306b\u3088\u3063\u3066\u7570\u306a\u3063\u305f\u30b3\u30fc\u30c9\u3092\u5b9f\u884c\u3059\u308b\u306e\u306b\u3001`case` \u30b9\u30c6\u30fc\u30c8\u30e1\u30f3\u30c8\u3092\u4f7f\u3048\u308b\u3068\u3044\u3046\u3053\u3068\u3092\u610f\u5473\u3057\u3066\u3044\u307e\u3059\u3002\n\n```elixir\ncase Friends.Repo.update(changeset) do\n  {:ok, person} ->\n    # do something with person\n  {:error, changeset} ->\n    # do something with changeset\nend\n```\n\n`insert!` \u3068\u540c\u3058\u3088\u3046\u306b\u3001changeset \u306b\u554f\u984c\u304c\u3042\u308b\u5834\u5408\u306b\u4f8b\u5916\u3092\u5f15\u304d\u8d77\u3053\u3059 `update!` \u95a2\u6570\u304c\u3042\u308a\u307e\u3059\u3002\n\n```\nchangeset = Friends.Person.changeset(person, %{first_name: \"\"})\nFriends.Repo.update! changeset\n\n** (Ecto.InvalidChangesetError) could not perform update because changeset is invalid.\n\n* Changeset changes\n\n%{first_name: \"\"}\n\n* Changeset params\n\n%{\"first_name\" => \"\"}\n\n* Changeset errors\n\n[first_name: {\"can't be blank\", []}]\n\n    lib/ecto/repo/schema.ex:132: Ecto.Repo.Schema.update!/4\n```\n\n## \u30ec\u30b3\u30fc\u30c9\u306e\u524a\u9664\n\n\u30ec\u30b3\u30fc\u30c9\u306e\u4f5c\u6210(`insert`)\u30fb\u8aad\u307f\u8fbc\u307f(`get`, `get_by`, `where`)\u30fb\u66f4\u65b0\u306b\u3064\u3044\u3066\u30ab\u30d0\u30fc\u3057\u307e\u3057\u305f\u3002\u3053\u306e\u30ac\u30a4\u30c9\u306e\u6700\u5f8c\u306b\u884c\u3063\u305f\u306e\u306f Ecto \u3092\u4f7f\u3063\u305f\u30ec\u30b3\u30fc\u30c9\u306e\u524a\u9664\u306b\u3064\u3044\u3066\u3067\u3057\u305f\u3002\n\n\u66f4\u65b0\u3068\u540c\u3058\u3088\u3046\u306b\u3001\u30ec\u30b3\u30fc\u30c9\u3092\u524a\u9664\u3059\u308b\u306b\u306f\u3001\u6700\u521d\u306b\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u304b\u3089\u30ec\u30b3\u30fc\u30c9\u3092\u53d6\u308a\u51fa\u3057\u3001`Friends.Repo.delete` \u3092\u547c\u3073\u51fa\u3057\u307e\u3059\u3002\n\n```elixir\nperson = Friends.Repo.get(Friends.Person, 1)\nFriends.Repo.delete(person)\n{:ok,\n %Friends.Person{__meta__: #Ecto.Schema.Metadata<:deleted>, age: 29,\n  first_name: \"Ryan\", id: 2, last_name: \"Bigg\"}}\n```\n\n`insert` \u3084 `update` \u3068\u540c\u3058\u3088\u3046\u306b\u3001`delete` \u306f\u30bf\u30d7\u30eb\u3092\u8fd4\u3057\u307e\u3059\u3002\u524a\u9664\u304c\u5b8c\u4e86\u3057\u305f\u3089\u30bf\u30d7\u30eb\u306e\u6700\u521d\u306e\u8981\u7d20\u306f `:ok`\u3001\u5931\u6557\u3057\u305f\u3089 `:error` \u306b\u306a\u308a\u307e\u3059\u3002\n", "tags": ["Elixir", "ecto", "\u7ffb\u8a33"]}