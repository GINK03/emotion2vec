{"tags": ["soft", "VyOS", "GRE", "\u30cd\u30c3\u30c8\u30ef\u30fc\u30af"], "context": "\n\n1. \u306f\u3058\u3081\u306b\n\u3000\u30af\u30e9\u30a6\u30c9\u30b7\u30b9\u30c6\u30e0\u306e\u57fa\u76e4\u69cb\u7bc9\u3092\u884c\u3046\u4e0a\u3067\u3001\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306f\u91cd\u8981\u306a\u8981\u7d20\u306e\u4e00\u3064\u3067\u3059\u3002\u5b66\u7fd2\u3059\u308b\u4e0a\u3067\u5b9f\u6a5f\u3092\u4f7f\u3063\u3066\u884c\u3046\u307b\u3046\u304c\u3001\u7406\u89e3\u304c\u6df1\u307e\u308a\u307e\u3059\u3002\n \u305f\u3060\u3001\u5fc5\u8981\u306a\u6a5f\u6750\u3092\u6e96\u5099\u3059\u308b\u3068\u8cbb\u7528\u3068\u6642\u9593\u304c\u304b\u304b\u308a\u307e\u3059\u304c\u3001SoftLayre\u3092\u4f7f\u3063\u3066\u3001\u5b89\u304f\u77ed\u6642\u9593\u306b\u5b9f\u6a5f\u3067\u69cb\u7bc9\u5b66\u7fd2\u3092\u884c\u3044\u307e\u3059\u3002\n \uff08\u3053\u308c\u304c\u30af\u30e9\u30a6\u30c9\u306e\u826f\u3044\u3068\u3053\u308d\u3060\u3067\u3059\u3002\uff09\n\u4eca\u56de\u306f\u3001\u57fa\u672c\u3068\u3057\u3066GRE\u306e\u8a2d\u5b9a\u3057\u3066\u307f\u307e\u3059\u3002\n\n2. GRE\u306b\u3064\u3044\u3066\n\u3000GRE(Generic Routing Encapsulation)\u306e\u524d\u306b\u3001VPN\u306b\u3064\u3044\u3066\u3092\u8aac\u660e\u3057\u307e\u3059\u3002\n VPN(Virtual Private Network)\u306f\u6587\u5b57\u901a\u308a\u3001\u516c\u8846\u30cd\u30c3\u30c8\u30ef\u30fc\u30af(Internet)\u3092\u4ecb\u3057\u3066\u30d7\u30e9\u30a4\u30d9\u30fc\u30c8\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u9593\u3092\u63a5\u7d9a\u3057\u307e\u3059\u3002\n \u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306f\u3001\u3042\u305f\u304b\u3082\u81ea\u5206\u5c02\u7528\u306e\u56de\u7dda\u3068\u3057\u3066\u63a5\u7d9a\u3055\u308c\u307e\u3059\u306e\u3067\u3001\u516c\u8846\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u7d4c\u7531\u3067\u3082\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u3092\u9ad8\u3081\u3066\u304f\u308c\u307e\u3059\u3002\n \u3000\n  \u305d\u306eVPN\u306e\u4ed5\u7d44\u307f\u3067\u91cd\u8981\u306a\u8981\u7d20\u306f\u3001\n      \uff08\uff11\uff09\u30c8\u30f3\u30cd\u30ea\u30f3\u30b0-----\u7d4c\u8def\n      \uff08\uff12\uff09\u6697\u53f7\u5316------------\u30c7\u30fc\u30bf\u3000 \u3067\u3059\u3002\n\u3000\n GRE\u306f\u30c8\u30f3\u30cd\u30ea\u30f3\u30b0\u30d7\u30ed\u30c8\u30b3\u30eb\u306e\u3072\u3068\u3064\u3067\u3001\u4ed6\u306b\u306f\n \u30fbLayer2\u30c8\u30f3\u30cd\u30ea\u30f3\u30b0\u306eL2F, PPTP, L2TP\n \u30fbLayer3\u30c8\u30f3\u30cd\u30ea\u30f3\u30b0\u306eGRE, IPsec\u3000\u306a\u3069\u304c\u3042\u308a\u307e\u3059\u3002\n\u307e\u305f\u3001\u6697\u53f7\u5316\u306fIPsec\u306e\u307f\u3067\u3059\u306e\u3067\u3001L2TP/IPsec\u306e\u3088\u3046\u306b\u30c8\u30f3\u30cd\u30ea\u30f3\u30b0\u3068\u6697\u53f7\u5316\u3092\u7d44\u307f\u5408\u308f\u305b\u3066\u5229\u7528\u3057\u307e\u3059\u3002\n\u4eca\u56de\u306f\u3001GRE\u306e\u30c8\u30f3\u30cd\u30ea\u30f3\u30b0\u3060\u3051\u3067\u6697\u53f7\u5316\u306f\u884c\u3044\u307e\u305b\u3093\u3002\n\n3. \u69cb\u6210\u306b\u3064\u3044\u3066\n\u3000SoftLayer\u306e\u30b7\u30f3\u30ac\u30dd\u30fc\u30eb\u3068\u6771\u4eac\u306e\uff12\u30ed\u30b1\u30fc\u30b7\u30e7\u30f3\u3092GRE(VyOS)\u3067\u63a5\u7d9a\u3057\u3066\u3001\u5404\u30ed\u30b1\u30fc\u30b7\u30e7\u30f3\u306b\u30c7\u30d7\u30ed\u30a4\u3057\u305fWindows2012\u30b5\u30fc\u30d0\u9593\u3067\u30c7\u30fc\u30bf\u306e\u9001\u53d7\u4fe1\u3092\u884c\u3044\u307e\u3059\u3002\n \u6ce8\u610f\u70b9\u3068\u3057\u3066\u3001VLAN\u30b9\u30d1\u30cb\u30f3\u30b0\u3092\u30aa\u30d5\u306b\u3057\u3066\u3001\uff12\u30ed\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u30d7\u30e9\u30a4\u30d9\u30fc\u30c8\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u304c\u63a5\u7d9a\u3055\u308c\u3066\u3044\u306a\u3044\u72b6\u614b\u3067\u78ba\u8a8d\u30c6\u30b9\u30c8\u3092\u884c\u3044\u307e\u3059\u3002\n\u3000\u307e\u305f\u3001VyOS\u306e\u5c0e\u5165\u306f\u4e0b\u8a18\u60c5\u5831\u306a\u3069\u3092\u53c2\u8003\u306b\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n QIITA\u300cSoftLayer\u4eee\u60f3\u30b5\u30fc\u30d0\u306bVyOS\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3057\u305f\u300d\nhttp://qiita.com/Mitsu-Murakita/items/d793250566a8e9f3562b\n \n \n \n\n4. \u69cb\u7bc9\u624b\u9806\n \n\n\uff15. \u69cb\u7bc9\n\u3000VyOS\u306e\u57fa\u672c\u7684\u306a\u64cd\u4f5c\u306b\u3064\u3044\u3066\n\nVyOS\u306b\u306f\u300c\u4e00\u822c\u30e2\u30fc\u30c9\u300d(\u30d7\u30ed\u30f3\u30d7\u30c8$)\u3068\u300c\u8a2d\u5b9a\u30e2\u30fc\u30c9\u300d(\u30d7\u30ed\u30f3\u30d7\u30c8#)\u304c\u3042\u308a\u307e\u3059\u3002\n\u30e2\u30fc\u30c9\u5909\u66f4\u306f\u3001\n\u30fb\u300c\u4e00\u822c\u30e2\u30fc\u30c9\u300d\u304b\u3089\u300c\u8a2d\u5b9a\u30e2\u30fc\u30c9\u300d\u3078\u5909\u66f4\u306f\u201dconfigure\u201d\u30b3\u30de\u30f3\u30c9\n\u30fb\u300c\u8a2d\u5b9a\u30e2\u30fc\u30c9\u300d\u304b\u3089\u300c\u4e00\u822c\u30e2\u30fc\u30c9\u300d\u3078\u5909\u66f4\u306f\"exit\"\u30b3\u30de\u30f3\u30c9\u3000\u3067\u3059\u3002\n \n \u300c\u4e00\u822c\u30e2\u30fc\u30c9\u300d\u3067\u306f\u3001\u8a2d\u5b9a\u72b6\u614b\u3084\u52d5\u4f5c\u72b6\u614b\u304c\u78ba\u8a8d\u3067\u304d\u307e\u3059\u3002\n \u300c\u8a2d\u5b9a\u30e2\u30fc\u30c9\u300d\u3067\u306f\u3001\u52d5\u4f5c\u306e\u305f\u3081\u306e\u5024\u304c\u8a2d\u5b9a\u3067\u304d\u307e\u3059\u3002\n \u300c\u8a2d\u5b9a\u30e2\u30fc\u30c9\u300d\u3067\u3088\u304f\u4f7f\u3046\u30b3\u30de\u30f3\u30c9\u306f\u3001\n \"set\"-------\u5024\u306e\u5165\u529b\n \"delete\"---\u5024\u306e\u524a\u9664\n \"discard\"--\u5165\u529b\u3057\u305f\u5024\u306e\u7834\u68c4(commit\u524d\u306a\u3089\u6709\u52b9)\n \"commit\"--\u5165\u529b\u3057\u305f\u5024\u306e\u6709\u52b9\u5316\n \"save\"-----\u4fdd\u5b58(save\u3057\u306a\u3044\u3067\u518d\u8d77\u52d5\u3059\u308b\u3068\u3001\u5024\u304c\u6d88\u3048\u3066\u3057\u307e\u3044\u307e\u3059\u3002)\n \"show\"----\u69cb\u6210\u60c5\u5831\u306e\u8868\u793a\n\n\n\uff15-1. VLAN\u30b9\u30d1\u30cb\u30f3\u30b0\u3092OFF\nSoftLayer\u30dd\u30fc\u30bf\u30eb\u3067\u306e\u64cd\u4f5c\u3067\u3059\u3002\n \n\u300cNetwork\u300d\u21d2\u300cVLANs\u300d\u21d2\u300cSpan\u300d\u30bf\u30b0\n \n\u300cOff\u300d\u9078\u629e\n\u4ee5\u4e0a\u3067\u300cVLAN\u30b9\u30d1\u30cb\u30f3\u30b0\u3092OFF\u300d\u5b8c\u4e86\u3067\u3059\u3002\n\u203b\u30c6\u30b9\u30c8\u7d42\u308f\u308a\u307e\u3057\u305f\u3089\u3001ON\u306b\u623b\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n\uff15-2. VyOS-TOK(VyOS)\u306e\u8a2d\u5b9a\n\u307e\u305a\u3001Tokyo\u5074\u304b\u3089\u8a2d\u5b9a\u3002\nIP\u3092\u307e\u3060\u8a2d\u5b9a\u3057\u3066\u306a\u3044\u306e\u3067\u3001SoftLayer\u306eKVM\u64cd\u4f5c\u3067\u3059\u3002\nVyOS\u306e\u521d\u671f\u5024\u306f\u4e0b\u8a18\u306e\u901a\u308a\u3067\u3059\u3002\n\nvyos\u521d\u671f\u5024\ninterfaces {\n    ethernet eth0 {\n        hw-id 06:ce84:86:0a:e6\n    }\n    ethernet eth1 {\n        hw-id 06:96:da:92:17:25\n    }\n    loopback lo {\n    }\n}\nsystem {\n    config-management {\n        commit-revisions 20\n    }\n    console {\n        device hvc0 {\n            speed 9600\n        }\n        device ttyS0 {\n            speed 9600\n        }\n    }\n    login {\n        user vyos {\n            authentication {\n                encrypted-password  \n                plaintext-password \"\"\n            }\n            level admin\n        }\n    }\n    ntp {\n        server 0.pool.ntp.org {\n        }\n        server 1.pool.ntp.org {\n        }\n        server 2.pool.ntp.org {\n        }\n    }\n    package {\n        repository community {\n            components main\n            distribution helium\n            url http://packages.vyos.net/vyos\n        }\n    }\n    syslog {\n        global {\n            facility all {\n                level notice\n            }\n            facility protocols {\n                level debug\n            }\n        }\n    }\n}\n\n\n\u3053\u306e\u521d\u671f\u5024\u306b\u5024\u3092\u8a2d\u5b9a\u3057\u3066\u3044\u304d\u307e\u3059\u3002\n\nIP(interface)\u306e\u8a2d\u5b9a\n\u3053\u3053\u3067\u306f\u3001eth0\u304c\u30d7\u30e9\u30a4\u30d9\u30fc\u30c8\u3001eth1\u304c\u30d1\u30d6\u30ea\u30c3\u30af\u3067\u3059\u3002\n\nIP(interfaces)\u306e\u8a2d\u5b9a\n# set interfaces ethernet eth0 address 10.132.52.247/26 \u23ce\n# set interfaces ethernet eth1 address 161.202.91.38/28 \u23ce\n# commit \u23ce\n# save \u23ce\n\n\n\u4e0b\u8a18\uff13\u884c\u306f\u518d\u8d77\u52d5\u5f8c\u3001\u81ea\u52d5\u7684\u306b\u8ffd\u52a0\u3055\u308c\u307e\u3059\u304c\u3001\u3053\u3053\u3067\u306f\u660e\u793a\u7684\u306b\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n\u30fbduplex auto\n\u30fbsmp_affinity auto\n\u30fbspeed auto\n\nIP(interfaces)\u306e\u8a2d\u5b9a\u7d9a\u304d\n# set interfaces ethernet eth0 duplex auto \u23ce\n# set interfaces ethernet eth1 duplex auto \u23ce\n# set interfaces ethernet eth0 smp_affinity auto \u23ce\n# set interfaces ethernet eth1 smp_affinity auto \u23ce\n# set interfaces ethernet eth0 speed auto \u23ce\n# set interfaces ethernet eth1 speed auto \u23ce\n# commit \u23ce\n# save \u23ce\n\n\n\nssh(service)\u306e\u8a2d\u5b9a\n\u30af\u30e9\u30a4\u30a2\u30f3\u30c8PC\u304b\u3089ssh\u63a5\u7d9a\u3067\u304d\u308b\u3088\u3046\u306b\u3057\u307e\u3059\u3002\n\nssh(service)\u306e\u8a2d\u5b9a\n# set service ssh port 22 \u23ce\n# commit \u23ce\n# save \u23ce\n\n\n\nGateway\u30a2\u30c9\u30ec\u30b9(system)\u306e\u8a2d\u5b9a\n\u30d1\u30d6\u30ea\u30c3\u30af\u306e\u30b2\u30fc\u30c8\u30a6\u30a7\u30a4\u30a2\u30c9\u30ec\u30b9\u3092\u8a2d\u5b9a\u3002\n\nGateway\u30a2\u30c9\u30ec\u30b9(system)\u306e\u8a2d\u5b9a\n# set system gateway-address 161.202.91.33 \u23ce\n# commit \u23ce\n# save \u23ce\n\n\n\nDNS(system)\u306e\u8a2d\u5b9a\nSoftLayer\u306eDNS\u3001\n\u30fb10.0.80.11\n\u30fb10.0.80.12 \u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n\nDNS(system)\u306e\u8a2d\u5b9a\n# set system name-server 10.0.80.11 \u23ce\n# set system name-server 10.0.80.12 \u23ce\n# commit \u23ce\n# save \u23ce\n\n\n\n\u30c9\u30e1\u30a4\u30f3\u540d(system)\u306e\u8a2d\u5b9a\n\u3053\u3053\u3067\u306f\u30c9\u30e1\u30a4\u30f3\u540d\u3092\u300csoftlayer.com\u300d\u306b\u3057\u307e\u3057\u305f\u3002\n\n\u30c9\u30e1\u30a4\u30f3\u540d(system)\u306e\u8a2d\u5b9a\n# set system domain-name softlayer.com \u23ce\n# commit \u23ce\n# save \u23ce\n\n\n\n\u30db\u30b9\u30c8\u540d(system)\u306e\u8a2d\u5b9a\n\u3053\u3053\u3067\u306f\u30db\u30b9\u30c8\u540d\u3092\u300cVyOS-TOK\u300d\u306b\u3057\u307e\u3057\u305f\u3002\n\n\u30db\u30b9\u30c8\u540d(system)\u306e\u8a2d\u5b9a\n# set system host-name VyOS-TOK \u23ce\n# commit \u23ce\n# save \u23ce\n\n\n\n\u30bf\u30a4\u30e0\u30be\u30fc\u30f3(system)\u306e\u8a2d\u5b9a\n\u3053\u3053\u3067\u306f\u30bf\u30a4\u30e0\u30be\u30fc\u30f3\u3092\u300cAsia/Tokyo\u300d\u306b\u3057\u307e\u3057\u305f\u3002\n\n\u30db\u30b9\u30c8\u540d(system)\u306e\u8a2d\u5b9a\n# set system time-zone Asia/Tokyo \u23ce\n# commit \u23ce\n# save \u23ce\n\n\n\nGRE\u30c8\u30f3\u30cd\u30eb(interfaces)\u306e\u8a2d\u5b9a\n\u30c8\u30f3\u30cd\u30eb\u306f\u300ctun0\u300d\u3068\u3044\u3046\u540d\u524d\u306b\u3057\u307e\u3059\u3002\nTokyo\u5074\u306e\u30c8\u30f3\u30cd\u30ebIP\u306f\u3001\u201d10.20.20.2/24\u201d\u3067\u3059\u3002\n\nGRE\u30c8\u30f3\u30cd\u30eb(interfaces)\u306e\u8a2d\u5b9a-Tokyo\u5074\u30c8\u30f3\u30cd\u30ebIP\u8a2d\u5b9a\n# set interfaces tunnel tun0 address 10.20.20.2/24 \u23ce\n# commit \u23ce\n# save \u23ce\n\n\n\u30c8\u30f3\u30cd\u30eb\u306e\u8a18\u8ff0\u3092\u3001\"GRE tunnel to VyOS-SNG\u201d\u306b\u3057\u307e\u3059\u3002\n\nGRE\u30c8\u30f3\u30cd\u30eb(interfaces)\u306e\u8a2d\u5b9a-Tokyo\u5074\u30c8\u30f3\u30cd\u30eb\u8a18\u8ff0\u8a2d\u5b9a\n# set interfaces tunnel tun0 description \"GRE tunnel to VyOS-SNG\u201d \u23ce\n# commit \u23ce\n# save \u23ce\n\n\n\u30d1\u30b1\u30c3\u30c8\u306b\u65b0\u3057\u3044\u30d8\u30c3\u30c0\u3092\u4ed8\u3051\u52a0\u3048\u3001\u30ab\u30d7\u30bb\u30eb\u5316\uff08Encapsulation\uff09\u3057\u3066\u901a\u4fe1\u3059\u308b\u306e\u306bGRE\u3092\u4f7f\u3044\u307e\u3059\u3002\n\nGRE\u30c8\u30f3\u30cd\u30eb(interfaces)\u306e\u8a2d\u5b9a-\u30ab\u30d7\u30bb\u30eb\u5316\u306bGRE\u4f7f\u7528\n# set interfaces tunnel tun0 encapsulation gre \u23ce\n# commit \u23ce\n# save \u23ce\n\n\n\u30ed\u30fc\u30ab\u30ebIP\u6307\u5b9a(Tokyo\u5074\u30d1\u30d6\u30ea\u30c3\u30afIP)\n\nGRE\u30c8\u30f3\u30cd\u30eb(interfaces)\u306e\u8a2d\u5b9a-\u30ed\u30fc\u30ab\u30ebIP\u6307\u5b9a(Tokyo\u5074\u30d1\u30d6\u30ea\u30c3\u30afIP)\n# set interfaces tunnel tun0 local-ip 161.202.91.38 \u23ce\n# commit \u23ce\n# save \u23ce\n\n\n\u30ea\u30e2\u30fc\u30c8IP\u6307\u5b9a(Singapore\u5074\u30d1\u30d6\u30ea\u30c3\u30afIP)\n\nGRE\u30c8\u30f3\u30cd\u30eb(interfaces)\u306e\u8a2d\u5b9a-\u30ea\u30e2\u30fc\u30c8IP\u6307\u5b9a(Singapore\u5074\u30d1\u30d6\u30ea\u30c3\u30afIP)\n# set interfaces tunnel tun0 remote-ip 161.202.24.119 \u23ce\n# commit \u23ce\n# save \u23ce\n\n\n\nSingapore\u306b\u5bfe\u3057\u3066\u306e\u30b9\u30bf\u30c6\u30a3\u30c3\u30af\u30eb\u30fc\u30c8(protocols)\u306e\u8a2d\u5b9a\n\nGRE\u30c8\u30f3\u30cd\u30eb(interfaces)\u306e\u8a2d\u5b9a-Singapore\u306b\u5bfe\u3057\u3066\u306e\u30b9\u30bf\u30c6\u30a3\u30c3\u30af\u30eb\u30fc\u30c8(protocols)\u306e\u8a2d\u5b9a\n# set protocols static route 10.116.145.0/26  next-hop 10.20.20.2 \u23ce\n# commit \u23ce\n# save \u23ce\n\n\n\u4ee5\u4e0a\u3067\u3001\u300cVyOS-TOK(VyOS)\u306e\u8a2d\u5b9a\u300d\u5b8c\u4e86\u3067\u3059\u3002\n\"show\"\u30b3\u30de\u30f3\u30c9\u3067\u8a2d\u5b9a\u5024\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\n\nGRE\u30c8\u30f3\u30cd\u30eb\u306e\u8a2d\u5b9a(Tokyo)-show\u30b3\u30de\u30f3\u30c9\u3067\u78ba\u8a8d\n interfaces {\n     ethernet eth0 {\n         address 10.132.52.247/26\n         duplex auto\n         hw-id 06:ce:84:86:0a:e6\n         smp_affinity auto\n         speed auto\n     }\n     ethernet eth1 {\n         address 161.202.91.38/28\n         duplex auto\n         hw-id 06:96:da:92:17:25\n         smp_affinity auto\n         speed auto\n     }\n     loopback lo {\n     }\n     tunnel tun0 {\n         address 10.20.20.2/24\n         description \"GRE tunnel to VyOS-SNG\"\n         encapsulation gre\n         local-ip 161.202.91.38\n         remote-ip 161.202.24.119\n      }\n }\n protocols {\n     static {\n         route 10.116.145.0/26 {\n             next-hop 10.20.20.2 {\n             }\n         }\n     }\n }\n service {\n     ssh {\n         port 22\n     }\n }\n system {\n     config-management {\n         commit-revisions 20\n     }\n     console {\n         device hvc0 {\n             speed 9600\n         }\n          device ttyS0 {\n             speed 9600\n         }\n     }\n     domain-name softlayer.com\n     gateway-address 161.202.91.33\n     host-name VyOS-TOK\n     login {\n         user vyos {\n             authentication {\n                 encrypted-password \n                 plaintext-password \"\"\n             }\n             level admin\n         }\n     }\n     name-server 10.0.80.11\n     name-server 10.0.80.12\n     ntp {\n         server 0.pool.ntp.org {\n         }\n         server 1.pool.ntp.org {\n         }\n          server 2.pool.ntp.org {\n         }\n     }\n     package {\n         auto-sync 1\n         repository community {\n             components main\n             distribution helium\n             password \"\"\n             url http://packages.vyos.net/vyos\n             username \"\"\n         }\n     }\n     syslog {\n         global {\n             facility all {\n                 level notice\n             }\n             facility protocols {\n                 level debug\n             }\n         }\n     }\n      time-zone Asia/Tokyo\n }\n\n\n\n\uff15-\uff13. VyOS-SNG(VyOS)\u306e\u8a2d\u5b9a\n\u300c\uff15-2. VyOS-TOK(VyOS)\u306e\u8a2d\u5b9a\u300d\u3068\u540c\u3058\u64cd\u4f5c\u3067\u8a2d\u5b9a\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\nGRE\u30c8\u30f3\u30cd\u30eb\u306e\u8a2d\u5b9a(Singapore)-show\u30b3\u30de\u30f3\u30c9\u3067\u78ba\u8a8d\n interfaces {\n     ethernet eth0 {\n         address 10.116.145.13/26\n         duplex auto\n         hw-id 06:bd:96:13:b1:e0\n         smp_affinity auto\n         speed auto\n     }\n     ethernet eth1 {\n         address 161.202.24.119/28\n         duplex auto\n         hw-id 06:f0:5f:d6:7b:c4\n         smp_affinity auto\n         speed auto\n     }\n     loopback lo {\n     }\n     tunnel tun0 {\n         address 10.20.20.1/24\n         description \"GRE tunnel to VyOS-TOK\"\n         encapsulation gre\n         local-ip 161.202.24.119\n         remote-ip 161.202.91.38\n      }\n }\n protocols {\n     static {\n         route 10.132.52.192/26 {\n             next-hop 10.20.20.1 {\n             }\n         }\n     }\n }\n service {\n     ssh {\n         port 22\n     }\n }\n system {\n     config-management {\n         commit-revisions 20\n     }\n     console {\n         device hvc0 {\n             speed 9600\n         }\n          device ttyS0 {\n             speed 9600\n         }\n     }\n     domain-name softlayer.com\n     gateway-address 161.202.24.113\n     host-name VyOS-SNG\n     login {\n         user vyos {\n             authentication {\n                 encrypted-password \n                 plaintext-password \"\"\n             }\n             level admin\n         }\n     }\n     name-server 10.0.80.11\n     name-server 10.0.80.12\n     ntp {\n         server 0.pool.ntp.org {\n         }\n         server 1.pool.ntp.org {\n         }\n          server 2.pool.ntp.org {\n         }\n     }\n     package {\n         auto-sync 1\n         repository community {\n             components main\n             distribution helium\n             password \"\"\n             url http://packages.vyos.net/vyos\n             username \"\"\n         }\n     }\n     syslog {\n         global {\n             facility all {\n                 level notice\n             }\n             facility protocols {\n                 level debug\n             }\n         }\n     }\n      time-zone Asia/Tokyo\n }\n\n\n\n6. GRE\u30c8\u30f3\u30cd\u30eb\u63a5\u7d9a\u78ba\u8a8d\n\n6-1. VyOS\u30c8\u30f3\u30cd\u30eb\u304c\u201dup\u201d\u72b6\u614b\u3067\u3042\u308b\u3053\u3068\u3092\u78ba\u8a8d\nVyOS\u306e\u300c\u4e00\u822c\u30e2\u30fc\u30c9\u300d\u3067\u884c\u3044\u307e\u3059\u3002\nshow \u30b3\u30de\u30f3\u30c9\u3067\u78ba\u8a8d\u3057\u307e\u3059\u3002\n\nGRE\u30c8\u30f3\u30cd\u30ebup\u78ba\u8a8d\n$ show interfaces tunnel \u23ce\n\n\n \n\nGRE\u30c8\u30f3\u30cd\u30ebup\u78ba\u8a8d-\u8a73\u7d30\n$ show interfaces tunnel detail\u23ce\n\n\n \nToykyo\u5074\u3067\u78ba\u8a8d\u3057\u307e\u3057\u305f\u304c\u3001Shigapore\u5074\u3067\u3082\u78ba\u8a8d\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n6-2. PING\u3067\u78ba\u8a8d\nPING\u306fVyOS\u306e\u300c\u4e00\u822c\u30e2\u30fc\u30c9\u300d\u3067\u884c\u3044\u307e\u3059\u3002\n\uff08\uff11\uff09Tokyo\u5074\u306eVyOS-TOK\u304b\u3089\u3001Singapore\u5074\u306eVyOS-SNG\u306e\u30d7\u30e9\u30a4\u30d9\u30fc\u30c8\u30a2\u30c9\u30ec\u30b9(10.116.145.13)\u306b\u5bfe\u3057\u3066PING\u304c\u901a\u308b\u4e8b\u3092\u78ba\u8a8d\u3059\u308b\u3002\n\uff08\uff12\uff09Singaporeo\u5074\u306eVyOS-SNG\u304b\u3089\u3001Tokyo\u5074\u306eVyOS-TOK\u306e\u30d7\u30e9\u30a4\u30d9\u30fc\u30c8\u30a2\u30c9\u30ec\u30b9(10.132.52.247)\u306b\u5bfe\u3057\u3066PING\u304c\u901a\u308b\u4e8b\u3092\u78ba\u8a8d\u3059\u308b\u3002\n\n7. Windows2012R2\u30b5\u30fc\u30d0\u3001\u30b9\u30bf\u30c6\u30a3\u30c3\u30af\u30eb\u30fc\u30c8\u306e\u8a2d\u5b9a\nPowerShell\u3067\u306e\u64cd\u4f5c\u3067\u3059\u3002\n\u30fbW2012R2-TOK\u8a2d\u5b9a\n\nW2012R2-TOK\u30b9\u30bf\u30c6\u30a3\u30c3\u30af\u30eb\u30fc\u30c8\u8a2d\u5b9a\n>route add -p 10.116.145.0 mask 255.255.255.0 10.132.52.247 \u23ce\n\n\n\u30fbW2012R2-SNG\u8a2d\u5b9a\n\nW2012R2-SNG\u30b9\u30bf\u30c6\u30a3\u30c3\u30af\u30eb\u30fc\u30c8\u8a2d\u5b9a\n>route add -p 10.132.52.0 mask 255.255.255.0 10.116.145.13 \u23ce\n\n\n\n8 Windows2012Server\u9593\u30c7\u30fc\u30bf\u8ee2\u9001\u78ba\u8a8d\n\u300c6. GRE\u30c8\u30f3\u30cd\u30eb\u63a5\u7d9a\u78ba\u8a8d\u300d\u3092\u53c2\u8003\u306b\u3057\u3066\u78ba\u8a8d\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\uff08\uff11\uff09Tokyo\u5074\u306eW2012R2-TOK\u304b\u3089\u3001Singapore\u5074\u306eW2012R2-SNG\u306e\u30d7\u30e9\u30a4\u30d9\u30fc\u30c8\u30a2\u30c9\u30ec\u30b9(10.116.145.25)\u306b\u5bfe\u3057\u3066PING\u304c\u901a\u308b\u4e8b\u3092\u78ba\u8a8d\u3059\u308b\u3002\n\uff08\uff12\uff09Singaporeo\u5074\u306eW2012R2-SNG\u304b\u3089\u3001Tokyo\u5074\u306eW2012R2-TOK\u306e\u30d7\u30e9\u30a4\u30d9\u30fc\u30c8\u30a2\u30c9\u30ec\u30b9(10.132.52.213)\u306b\u5bfe\u3057\u3066PING\u304c\u901a\u308b\u4e8b\u3092\u78ba\u8a8d\u3059\u308b\u3002\n\n6. \u304a\u308f\u308a\u306b\n\u3000IP\u30a2\u30c9\u30ec\u30b9\u306b\u306f\u8868\u793a\u4e0a\u30de\u30b9\u30af\u3092\u304b\u3051\u308b\u306e\u304c\u5b89\u5168\u3067\u3059\u304c\u3001\u308f\u304b\u308a\u306b\u304f\u304f\u306a\u308b\u3068\u601d\u3044\u3001\u3042\u3048\u3066\u30de\u30b9\u30af\u3092\u304b\u3051\u307e\u305b\u3093\u3067\u3057\u305f\u3002\n\uff08\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u3092\u524a\u9664\u3059\u308b\u4e88\u5b9a\u3067\u3059\u3002\uff09\nSoftLayer\u3092\u6d3b\u7528\u3059\u308b\u3068\u3001\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u3092\u52c9\u5f37\u3059\u308b\u4e0a\u3067\u3001\u5c11\u306a\u3044\u8cbb\u7528\u3067\u5b9f\u6a5f\u52c9\u5f37\u3067\u304d\u77e5\u8b58\u304c\u6df1\u307e\u308a\u307e\u3059\u3002\n\u4eca\u5f8c\u3001L2TP\u3084IPsec\u3082\u6295\u7a3f\u3059\u308b\u4e88\u5b9a\u3067\u3059\u3002\n# 1. \u306f\u3058\u3081\u306b\n\u3000\u30af\u30e9\u30a6\u30c9\u30b7\u30b9\u30c6\u30e0\u306e\u57fa\u76e4\u69cb\u7bc9\u3092\u884c\u3046\u4e0a\u3067\u3001\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306f\u91cd\u8981\u306a\u8981\u7d20\u306e\u4e00\u3064\u3067\u3059\u3002\u5b66\u7fd2\u3059\u308b\u4e0a\u3067\u5b9f\u6a5f\u3092\u4f7f\u3063\u3066\u884c\u3046\u307b\u3046\u304c\u3001\u7406\u89e3\u304c\u6df1\u307e\u308a\u307e\u3059\u3002\n \u305f\u3060\u3001\u5fc5\u8981\u306a\u6a5f\u6750\u3092\u6e96\u5099\u3059\u308b\u3068\u8cbb\u7528\u3068\u6642\u9593\u304c\u304b\u304b\u308a\u307e\u3059\u304c\u3001SoftLayre\u3092\u4f7f\u3063\u3066\u3001\u5b89\u304f\u77ed\u6642\u9593\u306b\u5b9f\u6a5f\u3067\u69cb\u7bc9\u5b66\u7fd2\u3092\u884c\u3044\u307e\u3059\u3002\n \uff08\u3053\u308c\u304c\u30af\u30e9\u30a6\u30c9\u306e\u826f\u3044\u3068\u3053\u308d\u3060\u3067\u3059\u3002\uff09\n \n \u4eca\u56de\u306f\u3001\u57fa\u672c\u3068\u3057\u3066GRE\u306e\u8a2d\u5b9a\u3057\u3066\u307f\u307e\u3059\u3002\n\n# 2. GRE\u306b\u3064\u3044\u3066\n\u3000GRE(Generic Routing Encapsulation)\u306e\u524d\u306b\u3001VPN\u306b\u3064\u3044\u3066\u3092\u8aac\u660e\u3057\u307e\u3059\u3002\n VPN(Virtual Private Network)\u306f\u6587\u5b57\u901a\u308a\u3001\u516c\u8846\u30cd\u30c3\u30c8\u30ef\u30fc\u30af(Internet)\u3092\u4ecb\u3057\u3066\u30d7\u30e9\u30a4\u30d9\u30fc\u30c8\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u9593\u3092\u63a5\u7d9a\u3057\u307e\u3059\u3002\n \u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306f\u3001\u3042\u305f\u304b\u3082\u81ea\u5206\u5c02\u7528\u306e\u56de\u7dda\u3068\u3057\u3066\u63a5\u7d9a\u3055\u308c\u307e\u3059\u306e\u3067\u3001\u516c\u8846\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u7d4c\u7531\u3067\u3082\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u3092\u9ad8\u3081\u3066\u304f\u308c\u307e\u3059\u3002\n \u3000\n  \u305d\u306eVPN\u306e\u4ed5\u7d44\u307f\u3067\u91cd\u8981\u306a\u8981\u7d20\u306f\u3001\n      \uff08\uff11\uff09\u30c8\u30f3\u30cd\u30ea\u30f3\u30b0-----\u7d4c\u8def\n      \uff08\uff12\uff09\u6697\u53f7\u5316------------\u30c7\u30fc\u30bf\u3000 \u3067\u3059\u3002\n\u3000\n GRE\u306f\u30c8\u30f3\u30cd\u30ea\u30f3\u30b0\u30d7\u30ed\u30c8\u30b3\u30eb\u306e\u3072\u3068\u3064\u3067\u3001\u4ed6\u306b\u306f\n \u30fbLayer2\u30c8\u30f3\u30cd\u30ea\u30f3\u30b0\u306eL2F, PPTP, L2TP\n \u30fbLayer3\u30c8\u30f3\u30cd\u30ea\u30f3\u30b0\u306eGRE, IPsec\u3000\u306a\u3069\u304c\u3042\u308a\u307e\u3059\u3002\n\u307e\u305f\u3001\u6697\u53f7\u5316\u306fIPsec\u306e\u307f\u3067\u3059\u306e\u3067\u3001L2TP/IPsec\u306e\u3088\u3046\u306b\u30c8\u30f3\u30cd\u30ea\u30f3\u30b0\u3068\u6697\u53f7\u5316\u3092\u7d44\u307f\u5408\u308f\u305b\u3066\u5229\u7528\u3057\u307e\u3059\u3002\n\n\u4eca\u56de\u306f\u3001GRE\u306e\u30c8\u30f3\u30cd\u30ea\u30f3\u30b0\u3060\u3051\u3067\u6697\u53f7\u5316\u306f\u884c\u3044\u307e\u305b\u3093\u3002\n\n      \n# 3. \u69cb\u6210\u306b\u3064\u3044\u3066\n\u3000SoftLayer\u306e\u30b7\u30f3\u30ac\u30dd\u30fc\u30eb\u3068\u6771\u4eac\u306e\uff12\u30ed\u30b1\u30fc\u30b7\u30e7\u30f3\u3092GRE(VyOS)\u3067\u63a5\u7d9a\u3057\u3066\u3001\u5404\u30ed\u30b1\u30fc\u30b7\u30e7\u30f3\u306b\u30c7\u30d7\u30ed\u30a4\u3057\u305fWindows2012\u30b5\u30fc\u30d0\u9593\u3067\u30c7\u30fc\u30bf\u306e\u9001\u53d7\u4fe1\u3092\u884c\u3044\u307e\u3059\u3002\n \u6ce8\u610f\u70b9\u3068\u3057\u3066\u3001VLAN\u30b9\u30d1\u30cb\u30f3\u30b0\u3092\u30aa\u30d5\u306b\u3057\u3066\u3001\uff12\u30ed\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u30d7\u30e9\u30a4\u30d9\u30fc\u30c8\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u304c\u63a5\u7d9a\u3055\u308c\u3066\u3044\u306a\u3044\u72b6\u614b\u3067\u78ba\u8a8d\u30c6\u30b9\u30c8\u3092\u884c\u3044\u307e\u3059\u3002\n\u3000\u307e\u305f\u3001VyOS\u306e\u5c0e\u5165\u306f\u4e0b\u8a18\u60c5\u5831\u306a\u3069\u3092\u53c2\u8003\u306b\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n QIITA\u300cSoftLayer\u4eee\u60f3\u30b5\u30fc\u30d0\u306bVyOS\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3057\u305f\u300d\n http://qiita.com/Mitsu-Murakita/items/d793250566a8e9f3562b\n ![03.png](http://www.seahorse-inc.com/QIITA/Network-GRE/03.png) \n![05.png](http://www.seahorse-inc.com/QIITA/Network-GRE/05.png) \n![06.png](http://www.seahorse-inc.com/QIITA/Network-GRE/06.png) \n\n# 4. \u69cb\u7bc9\u624b\u9806\n![07.png](http://www.seahorse-inc.com/QIITA/Network-GRE/07.png) \n \n# \uff15. \u69cb\u7bc9\n\u3000VyOS\u306e\u57fa\u672c\u7684\u306a\u64cd\u4f5c\u306b\u3064\u3044\u3066\n> VyOS\u306b\u306f\u300c\u4e00\u822c\u30e2\u30fc\u30c9\u300d(\u30d7\u30ed\u30f3\u30d7\u30c8$)\u3068\u300c\u8a2d\u5b9a\u30e2\u30fc\u30c9\u300d(\u30d7\u30ed\u30f3\u30d7\u30c8#)\u304c\u3042\u308a\u307e\u3059\u3002\n\u30e2\u30fc\u30c9\u5909\u66f4\u306f\u3001\n\u30fb\u300c\u4e00\u822c\u30e2\u30fc\u30c9\u300d\u304b\u3089\u300c\u8a2d\u5b9a\u30e2\u30fc\u30c9\u300d\u3078\u5909\u66f4\u306f\u201dconfigure\u201d\u30b3\u30de\u30f3\u30c9\n\u30fb\u300c\u8a2d\u5b9a\u30e2\u30fc\u30c9\u300d\u304b\u3089\u300c\u4e00\u822c\u30e2\u30fc\u30c9\u300d\u3078\u5909\u66f4\u306f\"exit\"\u30b3\u30de\u30f3\u30c9\u3000\u3067\u3059\u3002\n ![08.png](http://www.seahorse-inc.com/QIITA/Network-GRE/08.png) \n \u300c\u4e00\u822c\u30e2\u30fc\u30c9\u300d\u3067\u306f\u3001\u8a2d\u5b9a\u72b6\u614b\u3084\u52d5\u4f5c\u72b6\u614b\u304c\u78ba\u8a8d\u3067\u304d\u307e\u3059\u3002\n \u300c\u8a2d\u5b9a\u30e2\u30fc\u30c9\u300d\u3067\u306f\u3001\u52d5\u4f5c\u306e\u305f\u3081\u306e\u5024\u304c\u8a2d\u5b9a\u3067\u304d\u307e\u3059\u3002\n \u300c\u8a2d\u5b9a\u30e2\u30fc\u30c9\u300d\u3067\u3088\u304f\u4f7f\u3046\u30b3\u30de\u30f3\u30c9\u306f\u3001\n \"set\"-------\u5024\u306e\u5165\u529b\n \"delete\"---\u5024\u306e\u524a\u9664\n \"discard\"--\u5165\u529b\u3057\u305f\u5024\u306e\u7834\u68c4(commit\u524d\u306a\u3089\u6709\u52b9)\n \"commit\"--\u5165\u529b\u3057\u305f\u5024\u306e\u6709\u52b9\u5316\n \"save\"-----\u4fdd\u5b58(save\u3057\u306a\u3044\u3067\u518d\u8d77\u52d5\u3059\u308b\u3068\u3001\u5024\u304c\u6d88\u3048\u3066\u3057\u307e\u3044\u307e\u3059\u3002)\n \"show\"----\u69cb\u6210\u60c5\u5831\u306e\u8868\u793a\n >\n \n## \uff15-1. VLAN\u30b9\u30d1\u30cb\u30f3\u30b0\u3092OFF\nSoftLayer\u30dd\u30fc\u30bf\u30eb\u3067\u306e\u64cd\u4f5c\u3067\u3059\u3002\n![09.png](http://www.seahorse-inc.com/QIITA/Network-GRE/09.png) \n\u300cNetwork\u300d\u21d2\u300cVLANs\u300d\u21d2\u300cSpan\u300d\u30bf\u30b0\n\n![10.png](http://www.seahorse-inc.com/QIITA/Network-GRE/10.png) \n\u300cOff\u300d\u9078\u629e\n\n\u4ee5\u4e0a\u3067\u300cVLAN\u30b9\u30d1\u30cb\u30f3\u30b0\u3092OFF\u300d\u5b8c\u4e86\u3067\u3059\u3002\n\u203b\u30c6\u30b9\u30c8\u7d42\u308f\u308a\u307e\u3057\u305f\u3089\u3001ON\u306b\u623b\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n## \uff15-2. VyOS-TOK(VyOS)\u306e\u8a2d\u5b9a\n\u307e\u305a\u3001Tokyo\u5074\u304b\u3089\u8a2d\u5b9a\u3002\nIP\u3092\u307e\u3060\u8a2d\u5b9a\u3057\u3066\u306a\u3044\u306e\u3067\u3001SoftLayer\u306eKVM\u64cd\u4f5c\u3067\u3059\u3002\n\nVyOS\u306e\u521d\u671f\u5024\u306f\u4e0b\u8a18\u306e\u901a\u308a\u3067\u3059\u3002\n\n ```Command:vyos\u521d\u671f\u5024\ninterfaces {\n\tethernet eth0 {\n\t\thw-id 06:ce84:86:0a:e6\n\t}\n\tethernet eth1 {\n\t\thw-id 06:96:da:92:17:25\n\t}\n\tloopback lo {\n\t}\n}\nsystem {\n\tconfig-management {\n\t\tcommit-revisions 20\n\t}\n\tconsole {\n\t\tdevice hvc0 {\n\t\t\tspeed 9600\n\t\t}\n\t\tdevice ttyS0 {\n\t\t\tspeed 9600\n\t\t}\n\t}\n\tlogin {\n\t\tuser vyos {\n\t\t\tauthentication {\n\t\t\t\tencrypted-password  \n\t\t\t\tplaintext-password \"\"\n\t\t\t}\n\t\t\tlevel admin\n\t\t}\n\t}\n\tntp {\n\t\tserver 0.pool.ntp.org {\n\t\t}\n\t\tserver 1.pool.ntp.org {\n\t\t}\n\t\tserver 2.pool.ntp.org {\n\t\t}\n\t}\n\tpackage {\n\t\trepository community {\n\t\t\tcomponents main\n\t\t\tdistribution helium\n\t\t\turl http://packages.vyos.net/vyos\n\t\t}\n\t}\n\tsyslog {\n\t\tglobal {\n\t\t\tfacility all {\n\t\t\t\tlevel notice\n\t\t\t}\n\t\t\tfacility protocols {\n\t\t\t\tlevel debug\n\t\t\t}\n\t\t}\n\t}\n}\n``` \n\n \u3053\u306e\u521d\u671f\u5024\u306b\u5024\u3092\u8a2d\u5b9a\u3057\u3066\u3044\u304d\u307e\u3059\u3002\n### IP(interface)\u306e\u8a2d\u5b9a\n \u3053\u3053\u3067\u306f\u3001eth0\u304c\u30d7\u30e9\u30a4\u30d9\u30fc\u30c8\u3001eth1\u304c\u30d1\u30d6\u30ea\u30c3\u30af\u3067\u3059\u3002\n \n ```Command:IP(interfaces)\u306e\u8a2d\u5b9a\n# set interfaces ethernet eth0 address 10.132.52.247/26 \u23ce\n# set interfaces ethernet eth1 address 161.202.91.38/28 \u23ce\n# commit \u23ce\n# save \u23ce\n```\n\n\u4e0b\u8a18\uff13\u884c\u306f\u518d\u8d77\u52d5\u5f8c\u3001\u81ea\u52d5\u7684\u306b\u8ffd\u52a0\u3055\u308c\u307e\u3059\u304c\u3001\u3053\u3053\u3067\u306f\u660e\u793a\u7684\u306b\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n\u30fbduplex auto\n\u30fbsmp_affinity auto\n\u30fbspeed auto\n\n ```Command:IP(interfaces)\u306e\u8a2d\u5b9a\u7d9a\u304d\n# set interfaces ethernet eth0 duplex auto \u23ce\n# set interfaces ethernet eth1 duplex auto \u23ce\n# set interfaces ethernet eth0 smp_affinity auto \u23ce\n# set interfaces ethernet eth1 smp_affinity auto \u23ce\n# set interfaces ethernet eth0 speed auto \u23ce\n# set interfaces ethernet eth1 speed auto \u23ce\n# commit \u23ce\n# save \u23ce\n```\n\n### ssh(service)\u306e\u8a2d\u5b9a \n \u30af\u30e9\u30a4\u30a2\u30f3\u30c8PC\u304b\u3089ssh\u63a5\u7d9a\u3067\u304d\u308b\u3088\u3046\u306b\u3057\u307e\u3059\u3002\n\n```Command:ssh(service)\u306e\u8a2d\u5b9a\n# set service ssh port 22 \u23ce\n# commit \u23ce\n# save \u23ce\n```\n\n### Gateway\u30a2\u30c9\u30ec\u30b9(system)\u306e\u8a2d\u5b9a \n \u30d1\u30d6\u30ea\u30c3\u30af\u306e\u30b2\u30fc\u30c8\u30a6\u30a7\u30a4\u30a2\u30c9\u30ec\u30b9\u3092\u8a2d\u5b9a\u3002\n\n```Command:Gateway\u30a2\u30c9\u30ec\u30b9(system)\u306e\u8a2d\u5b9a\n# set system gateway-address 161.202.91.33 \u23ce\n# commit \u23ce\n# save \u23ce\n```\n\n### DNS(system)\u306e\u8a2d\u5b9a \nSoftLayer\u306eDNS\u3001\n\u30fb10.0.80.11\n\u30fb10.0.80.12 \u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n\n```Command:DNS(system)\u306e\u8a2d\u5b9a\n# set system name-server 10.0.80.11 \u23ce\n# set system name-server 10.0.80.12 \u23ce\n# commit \u23ce\n# save \u23ce\n```\n\n### \u30c9\u30e1\u30a4\u30f3\u540d(system)\u306e\u8a2d\u5b9a \n\u3053\u3053\u3067\u306f\u30c9\u30e1\u30a4\u30f3\u540d\u3092\u300csoftlayer.com\u300d\u306b\u3057\u307e\u3057\u305f\u3002\n\n```Command:\u30c9\u30e1\u30a4\u30f3\u540d(system)\u306e\u8a2d\u5b9a\n# set system domain-name softlayer.com \u23ce\n# commit \u23ce\n# save \u23ce\n```\n\n### \u30db\u30b9\u30c8\u540d(system)\u306e\u8a2d\u5b9a \n\u3053\u3053\u3067\u306f\u30db\u30b9\u30c8\u540d\u3092\u300cVyOS-TOK\u300d\u306b\u3057\u307e\u3057\u305f\u3002\n\n```Command:\u30db\u30b9\u30c8\u540d(system)\u306e\u8a2d\u5b9a\n# set system host-name VyOS-TOK \u23ce\n# commit \u23ce\n# save \u23ce\n```\n### \u30bf\u30a4\u30e0\u30be\u30fc\u30f3(system)\u306e\u8a2d\u5b9a \n\u3053\u3053\u3067\u306f\u30bf\u30a4\u30e0\u30be\u30fc\u30f3\u3092\u300cAsia/Tokyo\u300d\u306b\u3057\u307e\u3057\u305f\u3002\n\n```Command:\u30db\u30b9\u30c8\u540d(system)\u306e\u8a2d\u5b9a\n# set system time-zone Asia/Tokyo \u23ce\n# commit \u23ce\n# save \u23ce\n```\n\n### GRE\u30c8\u30f3\u30cd\u30eb(interfaces)\u306e\u8a2d\u5b9a\n\u30c8\u30f3\u30cd\u30eb\u306f\u300ctun0\u300d\u3068\u3044\u3046\u540d\u524d\u306b\u3057\u307e\u3059\u3002\nTokyo\u5074\u306e\u30c8\u30f3\u30cd\u30ebIP\u306f\u3001\u201d10.20.20.2/24\u201d\u3067\u3059\u3002\n\n```Command:GRE\u30c8\u30f3\u30cd\u30eb(interfaces)\u306e\u8a2d\u5b9a-Tokyo\u5074\u30c8\u30f3\u30cd\u30ebIP\u8a2d\u5b9a\n# set interfaces tunnel tun0 address 10.20.20.2/24 \u23ce\n# commit \u23ce\n# save \u23ce\n```\n\n\u30c8\u30f3\u30cd\u30eb\u306e\u8a18\u8ff0\u3092\u3001\"GRE tunnel to VyOS-SNG\u201d\u306b\u3057\u307e\u3059\u3002\n\n```Command:GRE\u30c8\u30f3\u30cd\u30eb(interfaces)\u306e\u8a2d\u5b9a-Tokyo\u5074\u30c8\u30f3\u30cd\u30eb\u8a18\u8ff0\u8a2d\u5b9a\n# set interfaces tunnel tun0 description \"GRE tunnel to VyOS-SNG\u201d \u23ce\n# commit \u23ce\n# save \u23ce\n```\n\n\u30d1\u30b1\u30c3\u30c8\u306b\u65b0\u3057\u3044\u30d8\u30c3\u30c0\u3092\u4ed8\u3051\u52a0\u3048\u3001\u30ab\u30d7\u30bb\u30eb\u5316\uff08Encapsulation\uff09\u3057\u3066\u901a\u4fe1\u3059\u308b\u306e\u306bGRE\u3092\u4f7f\u3044\u307e\u3059\u3002\n\n```Command:GRE\u30c8\u30f3\u30cd\u30eb(interfaces)\u306e\u8a2d\u5b9a-\u30ab\u30d7\u30bb\u30eb\u5316\u306bGRE\u4f7f\u7528\n# set interfaces tunnel tun0 encapsulation gre \u23ce\n# commit \u23ce\n# save \u23ce\n```\n\n\u30ed\u30fc\u30ab\u30ebIP\u6307\u5b9a(Tokyo\u5074\u30d1\u30d6\u30ea\u30c3\u30afIP)\n\n```Command:GRE\u30c8\u30f3\u30cd\u30eb(interfaces)\u306e\u8a2d\u5b9a-\u30ed\u30fc\u30ab\u30ebIP\u6307\u5b9a(Tokyo\u5074\u30d1\u30d6\u30ea\u30c3\u30afIP)\n# set interfaces tunnel tun0 local-ip 161.202.91.38 \u23ce\n# commit \u23ce\n# save \u23ce\n```\n\n\u30ea\u30e2\u30fc\u30c8IP\u6307\u5b9a(Singapore\u5074\u30d1\u30d6\u30ea\u30c3\u30afIP)\n\n```Command:GRE\u30c8\u30f3\u30cd\u30eb(interfaces)\u306e\u8a2d\u5b9a-\u30ea\u30e2\u30fc\u30c8IP\u6307\u5b9a(Singapore\u5074\u30d1\u30d6\u30ea\u30c3\u30afIP)\n# set interfaces tunnel tun0 remote-ip 161.202.24.119 \u23ce\n# commit \u23ce\n# save \u23ce\n```\n\n### Singapore\u306b\u5bfe\u3057\u3066\u306e\u30b9\u30bf\u30c6\u30a3\u30c3\u30af\u30eb\u30fc\u30c8(protocols)\u306e\u8a2d\u5b9a\n```Command:GRE\u30c8\u30f3\u30cd\u30eb(interfaces)\u306e\u8a2d\u5b9a-Singapore\u306b\u5bfe\u3057\u3066\u306e\u30b9\u30bf\u30c6\u30a3\u30c3\u30af\u30eb\u30fc\u30c8(protocols)\u306e\u8a2d\u5b9a\n# set protocols static route 10.116.145.0/26  next-hop 10.20.20.2 \u23ce\n# commit \u23ce\n# save \u23ce\n```\n\n\n\u4ee5\u4e0a\u3067\u3001\u300cVyOS-TOK(VyOS)\u306e\u8a2d\u5b9a\u300d\u5b8c\u4e86\u3067\u3059\u3002\n\"show\"\u30b3\u30de\u30f3\u30c9\u3067\u8a2d\u5b9a\u5024\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\n\n```Command:GRE\u30c8\u30f3\u30cd\u30eb\u306e\u8a2d\u5b9a(Tokyo)-show\u30b3\u30de\u30f3\u30c9\u3067\u78ba\u8a8d\n interfaces {\n     ethernet eth0 {\n         address 10.132.52.247/26\n         duplex auto\n         hw-id 06:ce:84:86:0a:e6\n         smp_affinity auto\n         speed auto\n     }\n     ethernet eth1 {\n         address 161.202.91.38/28\n         duplex auto\n         hw-id 06:96:da:92:17:25\n         smp_affinity auto\n         speed auto\n     }\n     loopback lo {\n     }\n     tunnel tun0 {\n         address 10.20.20.2/24\n         description \"GRE tunnel to VyOS-SNG\"\n         encapsulation gre\n         local-ip 161.202.91.38\n         remote-ip 161.202.24.119\n      }\n }\n protocols {\n     static {\n         route 10.116.145.0/26 {\n             next-hop 10.20.20.2 {\n             }\n         }\n     }\n }\n service {\n     ssh {\n         port 22\n     }\n }\n system {\n     config-management {\n         commit-revisions 20\n     }\n     console {\n         device hvc0 {\n             speed 9600\n         }\n          device ttyS0 {\n             speed 9600\n         }\n     }\n     domain-name softlayer.com\n     gateway-address 161.202.91.33\n     host-name VyOS-TOK\n     login {\n         user vyos {\n             authentication {\n                 encrypted-password \n                 plaintext-password \"\"\n             }\n             level admin\n         }\n     }\n     name-server 10.0.80.11\n     name-server 10.0.80.12\n     ntp {\n         server 0.pool.ntp.org {\n         }\n         server 1.pool.ntp.org {\n         }\n          server 2.pool.ntp.org {\n         }\n     }\n     package {\n         auto-sync 1\n         repository community {\n             components main\n             distribution helium\n             password \"\"\n             url http://packages.vyos.net/vyos\n             username \"\"\n         }\n     }\n     syslog {\n         global {\n             facility all {\n                 level notice\n             }\n             facility protocols {\n                 level debug\n             }\n         }\n     }\n      time-zone Asia/Tokyo\n }\n```\n\n## \uff15-\uff13. VyOS-SNG(VyOS)\u306e\u8a2d\u5b9a\n  \u300c\uff15-2. VyOS-TOK(VyOS)\u306e\u8a2d\u5b9a\u300d\u3068\u540c\u3058\u64cd\u4f5c\u3067\u8a2d\u5b9a\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n  ```Command:GRE\u30c8\u30f3\u30cd\u30eb\u306e\u8a2d\u5b9a(Singapore)-show\u30b3\u30de\u30f3\u30c9\u3067\u78ba\u8a8d\n interfaces {\n     ethernet eth0 {\n         address 10.116.145.13/26\n         duplex auto\n         hw-id 06:bd:96:13:b1:e0\n         smp_affinity auto\n         speed auto\n     }\n     ethernet eth1 {\n         address 161.202.24.119/28\n         duplex auto\n         hw-id 06:f0:5f:d6:7b:c4\n         smp_affinity auto\n         speed auto\n     }\n     loopback lo {\n     }\n     tunnel tun0 {\n         address 10.20.20.1/24\n         description \"GRE tunnel to VyOS-TOK\"\n         encapsulation gre\n         local-ip 161.202.24.119\n         remote-ip 161.202.91.38\n      }\n }\n protocols {\n     static {\n         route 10.132.52.192/26 {\n             next-hop 10.20.20.1 {\n             }\n         }\n     }\n }\n service {\n     ssh {\n         port 22\n     }\n }\n system {\n     config-management {\n         commit-revisions 20\n     }\n     console {\n         device hvc0 {\n             speed 9600\n         }\n          device ttyS0 {\n             speed 9600\n         }\n     }\n     domain-name softlayer.com\n     gateway-address 161.202.24.113\n     host-name VyOS-SNG\n     login {\n         user vyos {\n             authentication {\n                 encrypted-password \n                 plaintext-password \"\"\n             }\n             level admin\n         }\n     }\n     name-server 10.0.80.11\n     name-server 10.0.80.12\n     ntp {\n         server 0.pool.ntp.org {\n         }\n         server 1.pool.ntp.org {\n         }\n          server 2.pool.ntp.org {\n         }\n     }\n     package {\n         auto-sync 1\n         repository community {\n             components main\n             distribution helium\n             password \"\"\n             url http://packages.vyos.net/vyos\n             username \"\"\n         }\n     }\n     syslog {\n         global {\n             facility all {\n                 level notice\n             }\n             facility protocols {\n                 level debug\n             }\n         }\n     }\n      time-zone Asia/Tokyo\n }\n```\n\n# 6. GRE\u30c8\u30f3\u30cd\u30eb\u63a5\u7d9a\u78ba\u8a8d\n## 6-1. VyOS\u30c8\u30f3\u30cd\u30eb\u304c\u201dup\u201d\u72b6\u614b\u3067\u3042\u308b\u3053\u3068\u3092\u78ba\u8a8d\nVyOS\u306e\u300c\u4e00\u822c\u30e2\u30fc\u30c9\u300d\u3067\u884c\u3044\u307e\u3059\u3002\nshow \u30b3\u30de\u30f3\u30c9\u3067\u78ba\u8a8d\u3057\u307e\u3059\u3002\n\n```Command:GRE\u30c8\u30f3\u30cd\u30ebup\u78ba\u8a8d\n$ show interfaces tunnel \u23ce\n```\n![11.png](http://www.seahorse-inc.com/QIITA/Network-GRE/11.png) \n \n```Command:GRE\u30c8\u30f3\u30cd\u30ebup\u78ba\u8a8d-\u8a73\u7d30\n$ show interfaces tunnel detail\u23ce\n```\n![12.png](http://www.seahorse-inc.com/QIITA/Network-GRE/12.png) \n \nToykyo\u5074\u3067\u78ba\u8a8d\u3057\u307e\u3057\u305f\u304c\u3001Shigapore\u5074\u3067\u3082\u78ba\u8a8d\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n## 6-2. PING\u3067\u78ba\u8a8d\nPING\u306fVyOS\u306e\u300c\u4e00\u822c\u30e2\u30fc\u30c9\u300d\u3067\u884c\u3044\u307e\u3059\u3002\n\n\uff08\uff11\uff09Tokyo\u5074\u306eVyOS-TOK\u304b\u3089\u3001Singapore\u5074\u306eVyOS-SNG\u306e\u30d7\u30e9\u30a4\u30d9\u30fc\u30c8\u30a2\u30c9\u30ec\u30b9(10.116.145.13)\u306b\u5bfe\u3057\u3066PING\u304c\u901a\u308b\u4e8b\u3092\u78ba\u8a8d\u3059\u308b\u3002\n\n\uff08\uff12\uff09Singaporeo\u5074\u306eVyOS-SNG\u304b\u3089\u3001Tokyo\u5074\u306eVyOS-TOK\u306e\u30d7\u30e9\u30a4\u30d9\u30fc\u30c8\u30a2\u30c9\u30ec\u30b9(10.132.52.247)\u306b\u5bfe\u3057\u3066PING\u304c\u901a\u308b\u4e8b\u3092\u78ba\u8a8d\u3059\u308b\u3002\n\n\n# 7. Windows2012R2\u30b5\u30fc\u30d0\u3001\u30b9\u30bf\u30c6\u30a3\u30c3\u30af\u30eb\u30fc\u30c8\u306e\u8a2d\u5b9a\nPowerShell\u3067\u306e\u64cd\u4f5c\u3067\u3059\u3002\n\n\u30fbW2012R2-TOK\u8a2d\u5b9a\n\n```Command:W2012R2-TOK\u30b9\u30bf\u30c6\u30a3\u30c3\u30af\u30eb\u30fc\u30c8\u8a2d\u5b9a\n>route add -p 10.116.145.0 mask 255.255.255.0 10.132.52.247 \u23ce\n```\n\u30fbW2012R2-SNG\u8a2d\u5b9a\n\n```Command:W2012R2-SNG\u30b9\u30bf\u30c6\u30a3\u30c3\u30af\u30eb\u30fc\u30c8\u8a2d\u5b9a\n>route add -p 10.132.52.0 mask 255.255.255.0 10.116.145.13 \u23ce\n```\n\n# 8 Windows2012Server\u9593\u30c7\u30fc\u30bf\u8ee2\u9001\u78ba\u8a8d\n\u300c6. GRE\u30c8\u30f3\u30cd\u30eb\u63a5\u7d9a\u78ba\u8a8d\u300d\u3092\u53c2\u8003\u306b\u3057\u3066\u78ba\u8a8d\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n\uff08\uff11\uff09Tokyo\u5074\u306eW2012R2-TOK\u304b\u3089\u3001Singapore\u5074\u306eW2012R2-SNG\u306e\u30d7\u30e9\u30a4\u30d9\u30fc\u30c8\u30a2\u30c9\u30ec\u30b9(10.116.145.25)\u306b\u5bfe\u3057\u3066PING\u304c\u901a\u308b\u4e8b\u3092\u78ba\u8a8d\u3059\u308b\u3002\n\n\uff08\uff12\uff09Singaporeo\u5074\u306eW2012R2-SNG\u304b\u3089\u3001Tokyo\u5074\u306eW2012R2-TOK\u306e\u30d7\u30e9\u30a4\u30d9\u30fc\u30c8\u30a2\u30c9\u30ec\u30b9(10.132.52.213)\u306b\u5bfe\u3057\u3066PING\u304c\u901a\u308b\u4e8b\u3092\u78ba\u8a8d\u3059\u308b\u3002\n\n# 6. \u304a\u308f\u308a\u306b\n\u3000IP\u30a2\u30c9\u30ec\u30b9\u306b\u306f\u8868\u793a\u4e0a\u30de\u30b9\u30af\u3092\u304b\u3051\u308b\u306e\u304c\u5b89\u5168\u3067\u3059\u304c\u3001\u308f\u304b\u308a\u306b\u304f\u304f\u306a\u308b\u3068\u601d\u3044\u3001\u3042\u3048\u3066\u30de\u30b9\u30af\u3092\u304b\u3051\u307e\u305b\u3093\u3067\u3057\u305f\u3002\n\uff08\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u3092\u524a\u9664\u3059\u308b\u4e88\u5b9a\u3067\u3059\u3002\uff09\n\nSoftLayer\u3092\u6d3b\u7528\u3059\u308b\u3068\u3001\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u3092\u52c9\u5f37\u3059\u308b\u4e0a\u3067\u3001\u5c11\u306a\u3044\u8cbb\u7528\u3067\u5b9f\u6a5f\u52c9\u5f37\u3067\u304d\u77e5\u8b58\u304c\u6df1\u307e\u308a\u307e\u3059\u3002\n\n\u4eca\u5f8c\u3001L2TP\u3084IPsec\u3082\u6295\u7a3f\u3059\u308b\u4e88\u5b9a\u3067\u3059\u3002\n\n"}