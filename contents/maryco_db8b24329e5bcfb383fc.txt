{"tags": ["Drupal8", "\u5165\u9580"], "context": "\n\nTIPS\n\n\nTIPS. Front\u5224\u5b9a\n\nphp\n  $is_front = \\Drupal::service('path.matcher')->isFrontPage();\n\n\n\n\\core\\includes\\theme.inc\n\n\nTIPS. Path(Route)\u3092\u53d6\u5f97\u3059\u308b\u65b9\u6cd5\u3044\u308d\u3044\u308d\u3002\n\u30a2\u30af\u30bb\u30b9URL\u4f8b\uff1ahttp://mydrupal.com/node/6\n\\Drupal::routeMatch()->getRouteName();\n\u7d50\u679c\uff1a> 'entity.node.canonical'\n\n$route = \\Drupal::routeMatch()->getRouteObject();\n$path = $route->getPath();\n\u7d50\u679c\uff1a> '/node/{node}'\n\n\\Drupal::service('path.current')->getPath();\n\u7d50\u679c\uff1a> '/node/6'\n\n\u30a2\u30af\u30bb\u30b9URL\u4f8b\uff1ahttp://mydrupal.com/popular\n\\Drupal::routeMatch()->getRouteName();\n\u7d50\u679c\uff1a> 'view.content_popular.page_1'\n\n$route = \\Drupal::routeMatch()->getRouteObject();\n$path = $route->getPath();\n\u7d50\u679c\uff1a> '/popular'\n\n\\Drupal::service('path.current')->getPath();\n\u7d50\u679c\uff1a> '/popular'\n\n\nTIPS. Uri\u3092\u751f\u6210\u3059\u308b\u65b9\u6cd5\u3044\u308d\u3044\u308d\u3002\n\u4f8b) \u30d5\u30ed\u30f3\u30c8\u306eURL\u3002\n$front_url = \\Drupal\\Core\\Url::fromRoute('<front>');\n\n\u4f8b) URI\u304b\u3089\u751f\u6210\u3002\n$url = \\Drupal\\Core\\Url::fromUri('base:articles/author/'.$node->getOwnerId());\n\n\nDrupal\u306e\u751f\u6210\u3057\u305f\u30da\u30fc\u30b8\u306a\u3089\\Drupal\\Core\\Url::fromRoute($route_name)\u3092\u4f7f\u3046\u3079\u304d\u3089\u3057\u3044\u3002\n\\Drupal::Url()\u306f9.0\u3067\u524a\u9664\u3055\u308c\u308b\u3089\u3057\u3044\u304b\u3089\u4f7f\u308f\u306a\u3044\u307b\u3046\u304c\u3088\u3055\u305d\u3046\n\u53c2\u7167\uff1a\\core\\lib\\Drupal\\Core\\Url.php\n\n\u4f8b) theme_preprocess_xxx()\u3067\u7528\u610f\u3057\u3066twig\u3067\u306f\u51fa\u529b\u3059\u308b\u3060\u3051\u306e\u5834\u5408\n\ntheme\n  $authors_article_url = \\Drupal\\Core\\Url::fromRoute('view.author_contents_page.page_1',\n    array('author_id' => $node->getOwnerId()));\n\n  $variables['authors_article_link_item'] = array(\n    'text' => '\u3053\u306e\u8a18\u8005\u306e\u4ed6\u306e\u8a18\u4e8b',\n    'url' => $authors_article_url\n  );\n\n\n\ntwig\n<p><a href=\"{{ authors_article_link_item.url }}\">{{ authors_article_link_item.text }}</a></p>\n\n\n\nTIPS. \u30d1\u30e9\u30e1\u30fc\u30bf\u3092\u53d6\u5f97\u3059\u308b\n\nURL\u3092\u300c/articles/author/%author_id\u300d\u3068\u5b9a\u7fa9\u3057\u305fView\n\u300c/articles/author/5\u300d \u3067\u30a2\u30af\u30bb\u30b9\u3057\u3066\u3082\u5b9a\u7fa9\u3057\u305f\u30d1\u30e9\u30e1\u30fc\u30bf\u540d(author_id)\u3067\u53d6\u5f97\u53ef\u80fd\n\n$author_id = \\Drupal::routeMatch()->getParameter('author_id');\n\n\nTIPS. Node\u304b\u3089User entity\u3092\u53d6\u308a\u51fa\u3057\u3001User entity\u306b\u8ffd\u52a0\u3057\u305f\u30ab\u30b9\u30bf\u30e0\u30d5\u30a3\u30fc\u30eb\u30c9\u3092\u53d6\u308a\u51fa\u3059\n\ntheme\n  $author = $node->getOwner();\n  $variables['user_detail'] = array(\n    'custom_field' => $author->get('field_my_custom_field')->value\n  );\n\n\n\n\\core\\lib\\Drupal\\Core\\Entity\\ContentEntityBase.php\n\\core\\lib\\Drupal\\Core\\Field\\FieldItemBase.php\n\n\nTIPS. Twig\u3067\u30ea\u30f3\u30af\u751f\u6210\u3002path()\u3068url()\n\ntwig\n<p><a href=\"{{ path('view.author_contents_page.page_1', {'author_id': node.ownerid}) }}\">\u3053\u306e\u8a18\u8005\u306e\u4ed6\u306e\u8a18\u4e8b</a></p>\n\n\n\nhtml\n<p><a href=\"/articles/author/5\">\u3053\u306e\u8a18\u8005\u306e\u4ed6\u306e\u8a18\u4e8b</a></p>\n\n\n\ntwig\n<p><a href=\"{{ url('view.author_contents_page.page_1', {'author_id': node.ownerid}) }}\">\u3053\u306e\u8a18\u8005\u306e\u4ed6\u306e\u8a18\u4e8b</a></p>\n\n\n\nhtml\n<p><a href=\"http://mydrupal.com/articles/author/5\">\u3053\u306e\u8a18\u8005\u306e\u4ed6\u306e\u8a18\u4e8b</a></p>\n\n\n\nCreating Links Within Twig Templates Using path() and url()\n\u53c2\u7167\uff1a\\core\\lib\\Drupal\\Core\\Template\\TwigExtension.php\n\n\nTIPS. \u30da\u30fc\u30b8\u306e\u30bf\u30a4\u30c8\u30eb\u3092\u53d6\u5f97\u3059\u308b\n\ntheme\n  $request = \\Drupal::request();\n  $route_match = \\Drupal::routeMatch();\n  $title = \\Drupal::service('title_resolver')->getTitle($request, $route_match->getRouteObject());\n\n\n\nTIPS. \u30d8\u30c3\u30c0\u306e\u60c5\u5831\u3092\u5909\u66f4\u3059\u308b\nhttp://qiita.com/maryco/items/5c75feaa233edd4a4de1\n\u4f8b\uff1alink\u30bf\u30b0prev\u3092\u8ffd\u52a0\u3059\u308b\n\ntheme\n  pager_find_page()\u306f1\u30da\u30fc\u30b8\u76ee\u304c\u300c0\u300d\u59cb\u307e\u308a\u306a\u306e\u3067\u6ce8\u610f\u3002\n  if (\\Drupal::request()->query->has('page') && pager_find_page() > 0) {\n      global $base_url;\n      $path = \\Drupal::service('path.current')->getPath() . '?page=' . (pager_find_page() - 1);\n\n      $attachments['#attached']['html_head'][] = [\n          [\n              '#tag' => 'link',\n              '#attributes' => [\n                  'rel' => 'prev',\n                  'href' => $base_url . $path,\n              ],\n          ],\n          'link_prev',\n      ];\n  }\n\n\n\n\u53c2\u7167\uff1a- Trying to add an html head tag in Drupal 8, beta 2\n\n\\core\\lib\\Drupal\\Core\\Render\\theme.api.php\n\\core\\lib\\Drupal\\Core\\Render\\HtmlResponseAttachmentsProcessor.php\n\n\nTIPS. \u5404\u7a2eEntity\u306e\u8aad\u307f\u51fa\u3057\n\ntheme\n  // \u30e6\u30fc\u30b6\u30fc\n  $uid = \\Drupal::routeMatch()->getParameter('author_id');\n  $author = \\Drupal\\user\\Entity\\User::load($uid);\n\n  // \u5404\u30d5\u30a3\u30fc\u30eb\u30c9\u306e\u53c2\u7167\u306f\u4ee5\u4e0b\u306e\u3069\u3061\u3089\u3067\u3082\u53ef\u80fd\n  $author_public_name = $author->toArray()['field_public_name'][0]['value'];\n  $author_public_name = $author->get('field_public_name')->value;\n\n\n\ntheme\n  // \u30bf\u30af\u30bd\u30ce\u30df\u30fc\n  $taxonomy_term = \\Drupal::entityTypeManager()->getStorage('taxonomy_term')->load($tid);\n  $name = $taxonomy_term->toArray()['name'][0]['value'];\n\n\n\n\u53c2\u8003\n\nTheming in Drupal 8 with Twig (Part 2)\nTwig best practices - preprocess functions and templates\nFunctions - In Twig Templates\n\nDrupal\u306e\u30c6\u30fc\u30de\u4f5c\u6210\u306a\u3069\u3067\u3001\u3088\u304f\u4f7f\u3046API(\u95a2\u6570)\u307e\u3068\u3081\n\nDrupal7\u307e\u3067\u306e\u7269\u304c\u591a\u3044\u3002\u3002\u3002\n\n\n\n\n\u305d\u306e\u4ed6\u672a\u6574\u7406\u30e1\u30e2\n\nvariables\u306e\u300c#\u300d\u4ed8\u304d\u306e\u30ad\u30fc\u306f\u81ea\u5206\u306e\u30d7\u30ed\u30d1\u30c6\u30a3\u3001\u300c#\u300d\u7121\u3057\u306e\u30ad\u30fc\u306f\u5b50\u8981\u7d20\uff08\uff1f\uff09\n\u30d1\u30f3\u304f\u305a\u306f\u300csystem\u300d\u30e2\u30b8\u30e5\u30fc\u30eb\u3067\u3042\u308a\u3001\u300cmenu\u300d\u30e2\u30b8\u30e5\u30fc\u30eb\u3067\u306f\u306a\u3044\u305f\u3081\u3001\u7ba1\u7406\u753b\u9762\u304b\u3089\u30ab\u30b9\u30bf\u30de\u30a4\u30ba\u3059\u308b\u3053\u3068\u306f\u3067\u304d\u306a\u3044\uff1f\nfield_view_field() and field_view_value() moved to view() methods on FieldItemListInterface and FieldItemInterface\nfield_view_field()\n\n## **TIPS**\n\n### **TIPS.** Front\u5224\u5b9a\n\n```:php\n  $is_front = \\Drupal::service('path.matcher')->isFrontPage();\n```\n\n- \\core\\includes\\theme.inc\n\n### **TIPS.** Path(Route)\u3092\u53d6\u5f97\u3059\u308b\u65b9\u6cd5\u3044\u308d\u3044\u308d\u3002\n\n\u30a2\u30af\u30bb\u30b9URL\u4f8b\uff1a```http://mydrupal.com/node/6```\n\n```\n\\Drupal::routeMatch()->getRouteName();\n\u7d50\u679c\uff1a> 'entity.node.canonical'\n\n$route = \\Drupal::routeMatch()->getRouteObject();\n$path = $route->getPath();\n\u7d50\u679c\uff1a> '/node/{node}'\n\n\\Drupal::service('path.current')->getPath();\n\u7d50\u679c\uff1a> '/node/6'\n```\n\n\u30a2\u30af\u30bb\u30b9URL\u4f8b\uff1a```http://mydrupal.com/popular```\n\n```\n\\Drupal::routeMatch()->getRouteName();\n\u7d50\u679c\uff1a> 'view.content_popular.page_1'\n\n$route = \\Drupal::routeMatch()->getRouteObject();\n$path = $route->getPath();\n\u7d50\u679c\uff1a> '/popular'\n\n\\Drupal::service('path.current')->getPath();\n\u7d50\u679c\uff1a> '/popular'\n```\n\n### **TIPS.** Uri\u3092\u751f\u6210\u3059\u308b\u65b9\u6cd5\u3044\u308d\u3044\u308d\u3002\n\n\u4f8b) \u30d5\u30ed\u30f3\u30c8\u306eURL\u3002\n\n```\n$front_url = \\Drupal\\Core\\Url::fromRoute('<front>');\n```\n\n\u4f8b) URI\u304b\u3089\u751f\u6210\u3002\n\n```\n$url = \\Drupal\\Core\\Url::fromUri('base:articles/author/'.$node->getOwnerId());\n```\n\n- Drupal\u306e\u751f\u6210\u3057\u305f\u30da\u30fc\u30b8\u306a\u3089```\\Drupal\\Core\\Url::fromRoute($route_name)```\u3092\u4f7f\u3046\u3079\u304d\u3089\u3057\u3044\u3002\n- \\Drupal::Url()\u306f9.0\u3067\u524a\u9664\u3055\u308c\u308b\u3089\u3057\u3044\u304b\u3089\u4f7f\u308f\u306a\u3044\u307b\u3046\u304c\u3088\u3055\u305d\u3046\n- \u53c2\u7167\uff1a\\core\\lib\\Drupal\\Core\\Url.php\n\n\u4f8b) theme_preprocess_xxx()\u3067\u7528\u610f\u3057\u3066twig\u3067\u306f\u51fa\u529b\u3059\u308b\u3060\u3051\u306e\u5834\u5408\n\n```:theme\n  $authors_article_url = \\Drupal\\Core\\Url::fromRoute('view.author_contents_page.page_1',\n    array('author_id' => $node->getOwnerId()));\n\n  $variables['authors_article_link_item'] = array(\n    'text' => '\u3053\u306e\u8a18\u8005\u306e\u4ed6\u306e\u8a18\u4e8b',\n    'url' => $authors_article_url\n  );\n```\n\n```:twig\n<p><a href=\"{{ authors_article_link_item.url }}\">{{ authors_article_link_item.text }}</a></p>\n```\n\n### **TIPS.** \u30d1\u30e9\u30e1\u30fc\u30bf\u3092\u53d6\u5f97\u3059\u308b\n\n- URL\u3092\u300c/articles/author/%author_id\u300d\u3068\u5b9a\u7fa9\u3057\u305fView\n- \u300c/articles/author/5\u300d \u3067\u30a2\u30af\u30bb\u30b9\u3057\u3066\u3082\u5b9a\u7fa9\u3057\u305f\u30d1\u30e9\u30e1\u30fc\u30bf\u540d(author_id)\u3067\u53d6\u5f97\u53ef\u80fd\n\n```\n$author_id = \\Drupal::routeMatch()->getParameter('author_id');\n```\n\n### **TIPS.** Node\u304b\u3089User entity\u3092\u53d6\u308a\u51fa\u3057\u3001User entity\u306b\u8ffd\u52a0\u3057\u305f\u30ab\u30b9\u30bf\u30e0\u30d5\u30a3\u30fc\u30eb\u30c9\u3092\u53d6\u308a\u51fa\u3059\n\n```:theme\n  $author = $node->getOwner();\n  $variables['user_detail'] = array(\n    'custom_field' => $author->get('field_my_custom_field')->value\n  );\n```\n\n- \\core\\lib\\Drupal\\Core\\Entity\\ContentEntityBase.php\n- \\core\\lib\\Drupal\\Core\\Field\\FieldItemBase.php\n\n\n### **TIPS.** Twig\u3067\u30ea\u30f3\u30af\u751f\u6210\u3002path()\u3068url()\n\n```:twig\n<p><a href=\"{{ path('view.author_contents_page.page_1', {'author_id': node.ownerid}) }}\">\u3053\u306e\u8a18\u8005\u306e\u4ed6\u306e\u8a18\u4e8b</a></p>\n```\n```:html\n<p><a href=\"/articles/author/5\">\u3053\u306e\u8a18\u8005\u306e\u4ed6\u306e\u8a18\u4e8b</a></p>\n```\n```:twig\n<p><a href=\"{{ url('view.author_contents_page.page_1', {'author_id': node.ownerid}) }}\">\u3053\u306e\u8a18\u8005\u306e\u4ed6\u306e\u8a18\u4e8b</a></p>\n```\n```:html\n<p><a href=\"http://mydrupal.com/articles/author/5\">\u3053\u306e\u8a18\u8005\u306e\u4ed6\u306e\u8a18\u4e8b</a></p>\n```\n\n- [Creating Links Within Twig Templates Using path() and url()](https://chromatichq.com/blog/creating-links-within-twig-templates-using-path-and-url)\n- \u53c2\u7167\uff1a\\core\\lib\\Drupal\\Core\\Template\\TwigExtension.php\n\n### **TIPS.** \u30da\u30fc\u30b8\u306e\u30bf\u30a4\u30c8\u30eb\u3092\u53d6\u5f97\u3059\u308b\n\n```:theme\n  $request = \\Drupal::request();\n  $route_match = \\Drupal::routeMatch();\n  $title = \\Drupal::service('title_resolver')->getTitle($request, $route_match->getRouteObject());\n```\n\n### **TIPS.** \u30d8\u30c3\u30c0\u306e\u60c5\u5831\u3092\u5909\u66f4\u3059\u308b\n\nhttp://qiita.com/maryco/items/5c75feaa233edd4a4de1\n\n\u4f8b\uff1alink\u30bf\u30b0prev\u3092\u8ffd\u52a0\u3059\u308b\n\n```:theme\n  pager_find_page()\u306f1\u30da\u30fc\u30b8\u76ee\u304c\u300c0\u300d\u59cb\u307e\u308a\u306a\u306e\u3067\u6ce8\u610f\u3002\n  if (\\Drupal::request()->query->has('page') && pager_find_page() > 0) {\n      global $base_url;\n      $path = \\Drupal::service('path.current')->getPath() . '?page=' . (pager_find_page() - 1);\n\n      $attachments['#attached']['html_head'][] = [\n          [\n              '#tag' => 'link',\n              '#attributes' => [\n                  'rel' => 'prev',\n                  'href' => $base_url . $path,\n              ],\n          ],\n          'link_prev',\n      ];\n  }\n```\n\n- \u53c2\u7167\uff1a- [Trying to add an html head tag in Drupal 8, beta 2](http://www.ceus-now.com/trying-to-add-an-html-head-tag-in-drupal-8-beta-2/)\n- \\core\\lib\\Drupal\\Core\\Render\\theme.api.php\n- \\core\\lib\\Drupal\\Core\\Render\\HtmlResponseAttachmentsProcessor.php\n\n### **TIPS.** \u5404\u7a2eEntity\u306e\u8aad\u307f\u51fa\u3057\n\n```:theme\n  // \u30e6\u30fc\u30b6\u30fc\n  $uid = \\Drupal::routeMatch()->getParameter('author_id');\n  $author = \\Drupal\\user\\Entity\\User::load($uid);\n  \n  // \u5404\u30d5\u30a3\u30fc\u30eb\u30c9\u306e\u53c2\u7167\u306f\u4ee5\u4e0b\u306e\u3069\u3061\u3089\u3067\u3082\u53ef\u80fd\n  $author_public_name = $author->toArray()['field_public_name'][0]['value'];\n  $author_public_name = $author->get('field_public_name')->value;\n```\n\n```:theme\n  // \u30bf\u30af\u30bd\u30ce\u30df\u30fc\n  $taxonomy_term = \\Drupal::entityTypeManager()->getStorage('taxonomy_term')->load($tid);\n  $name = $taxonomy_term->toArray()['name'][0]['value'];\n```\n\n## \u53c2\u8003\n- [Theming in Drupal 8 with Twig (Part 2)](http://www.undpaul.de/en/blog/2013/02/26/theming-drupal-8-twig-part-2)\n- [Twig best practices - preprocess functions and templates](https://www.drupal.org/node/1920746)\n- [Functions - In Twig Templates](https://www.drupal.org/node/2486991)\n- [Drupal\u306e\u30c6\u30fc\u30de\u4f5c\u6210\u306a\u3069\u3067\u3001\u3088\u304f\u4f7f\u3046API(\u95a2\u6570)\u307e\u3068\u3081](http://shared-blog.kddi-web.com/webinfo/41)\n - Drupal7\u307e\u3067\u306e\u7269\u304c\u591a\u3044\u3002\u3002\u3002\n\n## \u305d\u306e\u4ed6\u672a\u6574\u7406\u30e1\u30e2\n\n- variables\u306e\u300c#\u300d\u4ed8\u304d\u306e\u30ad\u30fc\u306f\u81ea\u5206\u306e\u30d7\u30ed\u30d1\u30c6\u30a3\u3001\u300c#\u300d\u7121\u3057\u306e\u30ad\u30fc\u306f\u5b50\u8981\u7d20\uff08\uff1f\uff09\n- \u30d1\u30f3\u304f\u305a\u306f\u300csystem\u300d\u30e2\u30b8\u30e5\u30fc\u30eb\u3067\u3042\u308a\u3001\u300cmenu\u300d\u30e2\u30b8\u30e5\u30fc\u30eb\u3067\u306f\u306a\u3044\u305f\u3081\u3001\u7ba1\u7406\u753b\u9762\u304b\u3089\u30ab\u30b9\u30bf\u30de\u30a4\u30ba\u3059\u308b\u3053\u3068\u306f\u3067\u304d\u306a\u3044\uff1f\n\n- [field_view_field() and field_view_value() moved to view() methods on FieldItemListInterface and FieldItemInterface](https://www.drupal.org/node/2208327)\n- [field_view_field()](http://drupal.stackexchange.com/questions/180580/field-view-field)\n\n"}