{"context": " More than 1 year has passed since last update.\n\n\u524d\u63d0\u6761\u4ef6\n\nAmazonLinux\u3067\u8d77\u52d5\u3067\u304d\u305f\u30b9\u30af\u30ea\u30d7\u30c8\u3067\u3059\nconfiguration\u306eJSON\u30d5\u30a1\u30a4\u30eb\u306e\u30d1\u30b9\u306f\u9069\u5b9c\u5909\u66f4\u304f\u3060\u3055\u3044\u3002\nzookeeper + jubaconfig + jubarecommender_proxy + jubavisor + jubavisor \u306e\u69cb\u6210\u3092jubactl\u3067\u8d77\u52d5\u3059\u308b\u5f62\u3067\u3059\u3002\n\n\n\u8a2d\u7f6e\u5834\u6240\n/etc/init.d \u306b\u914d\u7f6e\u3002\n\n\u4f7f\u3044\u65b9\n$ sudo service jubatus-recommender\nUsage : /etc/init.d/jubatus-recommender (start|stop|status|restart)\n\n# START\n$ sudo service jubatus-recommender start\nStarting jubatus-recommender:\nJMX enabled by default\nUsing config: /home/ec2-user/zookeeper-X.X.X/bin/../conf/zoo.cfg\nStarting zookeeper ... STARTED\n3669 INFO  [zk.cpp:586] got ZooKeeper event: type SESSION_EVENT(-1), state CONNECTED_STATE(3)\n3669 INFO  [zk.cpp:597] ZooKeeper session established, negotiated timeout 10000 ms\n3667 INFO  [zk.cpp:113] connected to zk: 127.0.0.1:2181\n3672 INFO  [zk.cpp:586] got ZooKeeper event: type SESSION_EVENT(-1), state CONNECTED_STATE(3)\n3672 INFO  [zk.cpp:597] ZooKeeper session established, negotiated timeout 10000 ms\n3670 INFO  [zk.cpp:113] connected to zk: 127.0.0.1:2181\n3670 INFO  [config.cpp:143] set config to zookeeper: /jubatus/config/recommender/XXXX\nRecommender Proxy Started                                  [  OK  ]\nJubavisor Started                                          [  OK  ]\n3689 INFO  [zk.cpp:586] got ZooKeeper event: type SESSION_EVENT(-1), state CONNECTED_STATE(3)\n3689 INFO  [zk.cpp:597] ZooKeeper session established, negotiated timeout 10000 ms\n3687 INFO  [zk.cpp:113] connected to zk: 127.0.0.1:2181\nsending start / jubarecommender/XXXX to XXX.XXX.XXX.XXX_9200...ok.\nRecommender Started                                        [  OK  ]\n3708 INFO  [zk.cpp:586] got ZooKeeper event: type SESSION_EVENT(-1), state CONNECTED_STATE(3)\n3708 INFO  [zk.cpp:597] ZooKeeper session established, negotiated timeout 10000 ms\n3706 INFO  [zk.cpp:113] connected to zk: 127.0.0.1:2181\nsending load / XXXX to XXX.XXX.XXX.XXX_9201...ok.\n\n# STATUS\n$ sudo service jubatus-recommender status\njubatus-recommender (pid  XXXX) is running...\n3726 INFO  [zk.cpp:586] got ZooKeeper event: type SESSION_EVENT(-1), state CONNECTED_STATE(3)\n3726 INFO  [zk.cpp:597] ZooKeeper session established, negotiated timeout 10000 ms\n3724 INFO  [zk.cpp:113] connected to zk: 127.0.0.1:2181\nactive jubaproxy members:\nXXX.XXX.XXX.XXX_9199\nactive jubavisor members:\nXXX.XXX.XXX.XXX_9200\nactive XXXX members:\nXXX.XXX.XXX.XXX_9201\n\n# STOP\n$ sudo service jubatus-recommender stop\nStopping jubatus-recommender:\n2825 INFO  [zk.cpp:586] got ZooKeeper event: type SESSION_EVENT(-1), state CONNECTED_STATE(3)\n2825 INFO  [zk.cpp:597] ZooKeeper session established, negotiated timeout 10000 ms\n2823 INFO  [zk.cpp:113] connected to zk: 127.0.0.1:2181\nsending save / XXXX to XXX.XXX.XXX.XXX_9201...ok.\n2828 INFO  [zk.cpp:586] got ZooKeeper event: type SESSION_EVENT(-1), state CONNECTED_STATE(3)\n2828 INFO  [zk.cpp:597] ZooKeeper session established, negotiated timeout 10000 ms\n2826 INFO  [zk.cpp:113] connected to zk: 127.0.0.1:2181\nsending stop / jubarecommender/XXXX to XXX.XXX.XXX.XXX_9200...ok.\nRecommender Stopped                                        [  OK  ]\nRecommender Proxy Stopped                                  [  OK  ]\nJubavisor Stopped                                          [  OK  ]\nJMX enabled by default\nUsing config: /home/ec2-user/zookeeper-X.X.X/bin/../conf/zoo.cfg\nStopping zookeeper ... STOPPED\n\n\n\n\u8d77\u52d5\u30b9\u30af\u30ea\u30d7\u30c8\n\n\u3053\u306e\u65b9\u306e\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u53c2\u8003\u306b\u3057\u307e\u3057\u305f\u3002\u5927\u5909\u53c2\u8003\u306b\u306a\u308a\u307e\u3057\u305f\u3002\u3042\u308a\u304c\u3068\u3046\u3054\u3056\u3044\u307e\u3057\u305f\u3002\njubatus - jubaclassifier \u8d77\u52d5\u30b9\u30af\u30ea\u30d7\u30c8 \uff08\u30b9\u30bf\u30f3\u30c9\u30a2\u30ed\u30f3\uff09 - Qiita\n\n\njubatus-recommender.sh\n#!/bin/sh\n#\n# chkconfig: - 99 32\n\n# Source function library\n. /etc/init.d/functions\n\nSERVICENAME=\"jubatus-recommender\"\nRETVAL=0\n\nPROXY_PIDFILE=/var/run/jubatus-recommender_proxy.pid\nRECOMMENDER_PIDFILE=/var/run/jubatus-recommender.pid\nVISOR_PIDFILE=/var/run/jubatus-visor.pid\nPREFIX_HOST=`/sbin/ifconfig | grep 'inet addr' | grep -v 127.0.0.1 | awk '{print $2;}' | cut -d: -f2`\nJUBACONFIG=/usr/bin/jubaconfig\nJUBARECOMMENDER_PROXY=/usr/bin/jubarecommender_proxy\nJUBARECOMMENDER=/usr/bin/jubarecommender\nJUBAVISOR=/usr/bin/jubavisor\nJUBACTL=/usr/bin/jubactl\nJUBATUS_TYPE=recommender\nRECOMMENDER_NAME=XXXX  # \u9069\u5b9c\u8a2d\u5b9a\u3057\u3066\u304f\u3060\u3055\u3044\nRECOMMENDER_PORT=9200\nZOOKEEPER=/home/ec2-user/zookeeper-X.X.X/bin/zkServer.sh  # \u9069\u5b9c\u8a2d\u5b9a\u3057\u3066\u304f\u3060\u3055\u3044\nZOOKEEPER_HOST=localhost\nZOOKEEPER_PORT=2181\n\nCONFIG=/etc/jubatus/config.json\nLOGDIR=/var/log/jubatus\nMODELDIR=/tmp\nLOGCONFIG=/usr/share/jubatus/example/log/log4cxx.xml\nMODEL_FILE=/tmp/${PREFIX_HOST}_9201_${JUBATUS_TYPE}_${RECOMMENDER_NAME}.jubatus\n\nstart() {\n    ## \u30ed\u30c3\u30af\u30d5\u30a1\u30a4\u30eb\u306e\u78ba\u8a8d\n    if [ -f $PROXY_PIDFILE -a -f $VISOR_PIDFILE -a -f $RECOMMENDER_PIDFILE ]; then\n        echo \"Jubatus Recommender Service is already started\"\n        exit 1\n    fi\n\n    echo \"Starting ${SERVICENAME}:\"\n    ## \u30ed\u30b0\u30d5\u30a9\u30eb\u30c0\u304c\u306a\u3044\u5834\u5408\u306b\u4f5c\u6210\u3059\u308b\n    if [ ! -e ${LOGDIR} ]; then\n        mkdir ${LOGDIR}\n    fi\n    ${ZOOKEEPER} start\n    wait\n    ${JUBACONFIG} --cmd delete --zookeeper=${ZOOKEEPER_HOST}:${ZOOKEEPER_PORT} --file ${CONFIG} --name ${RECOMMENDER_NAME} --type ${JUBATUS_TYPE}\n    wait\n    ${JUBACONFIG} --cmd write --zookeeper=${ZOOKEEPER_HOST}:${ZOOKEEPER_PORT} --file ${CONFIG} --name ${RECOMMENDER_NAME} --type ${JUBATUS_TYPE}\n    wait\n    sleep 2\n    ${JUBARECOMMENDER_PROXY} --zookeeper ${ZOOKEEPER_HOST}:${ZOOKEEPER_PORT} -g ${LOGCONFIG} -l ${LOGDIR} &\n    RETVAL=$?\n    if [ ${RETVAL} = 0 ]; then\n        success\n        touch /var/lock/subsys/${SERVICENAME}_proxy\n        /sbin/pidof ${JUBARECOMMENDER_PROXY} > ${PROXY_PIDFILE}\n        echo \"Recommender Proxy Started\"\n    else\n        failure\n    fi\n\n    ${JUBAVISOR} --rpc-port=${RECOMMENDER_PORT} --zookeeper ${ZOOKEEPER_HOST}:${ZOOKEEPER_PORT} -g ${LOGCONFIG} -l ${LOGDIR} --daemon\n    RETVAL=$?\n    if [ ${RETVAL} = 0 ]; then\n        success\n        touch /var/lock/subsys/${SERVICENAME}_visor\n        /sbin/pidof ${JUBAVISOR} > ${VISOR_PIDFILE}\n       echo \"Jubavisor Started\"\n    else\n        failure\n    fi\n\n    ${JUBACTL} -c start --server=jubarecommender --type=recommender --name=${RECOMMENDER_NAME} --zookeeper ${ZOOKEEPER_HOST}:${ZOOKEEPER_PORT} -G ${LOGCONFIG} -L ${LOGDIR}\n    RETVAL=$?\n    if [ ${RETVAL} = 0 ]; then\n        success\n        touch /var/lock/subsys/${SERVICENAME}\n        /sbin/pidof ${JUBARECOMMENDER} > ${RECOMMENDER_PIDFILE}\n        echo \"Recommender Started\"\n    else\n        failure\n    fi\n\n    sleep 3\n    ${JUBACTL} -c load --server=jubarecommender --type=recommender --name=${RECOMMENDER_NAME} --zookeeper ${ZOOKEEPER_HOST}:${ZOOKEEPER_PORT}\n    RETVAL=$?\n    if [ ${RETVAL} = 0 ]; then\n        success\n    else\n        failure\n    fi\n    echo\n}\n\nstop() {\n    ## \u30ed\u30c3\u30af\u30d5\u30a1\u30a4\u30eb\u306e\u78ba\u8a8d\n    if [ ! -e $PROXY_PIDFILE -a ! -e $VISOR_PIDFILE -a ! -e $RECOMMENDER_PIDFILE ]; then\n        echo \"Jubatus Recommender Service is already stopped\"\n        exit 1\n    fi\n\n    echo \"Stopping ${SERVICENAME}:\"\n    if [ -f $RECOMMENDER_PIDFILE ]; then\n        ${JUBACTL} -c save --server=jubarecommender --type=recommender --name=${RECOMMENDER_NAME} --zookeeper ${ZOOKEEPER_HOST}:${ZOOKEEPER_PORT}\n        ${JUBACTL} -c stop --server=jubarecommender --type=recommender --name=${RECOMMENDER_NAME} --zookeeper ${ZOOKEEPER_HOST}:${ZOOKEEPER_PORT}\n        RETVAL=$?\n        if [ ${RETVAL} -eq 0 ]; then\n            rm -f /var/lock/subsys/${SERVICENAME}\n            rm -f ${RECOMMENDER_PIDFILE}\n            success\n            echo \"Recommender Stopped\"\n        fi\n    fi\n\n    if [ -f $PROXY_PIDFILE ]; then\n        kill -KILL `/sbin/pidof $JUBARECOMMENDER_PROXY`\n        RETVAL=$?\n        if [ ${RETVAL} -eq 0 ]; then\n            rm -f /var/lock/subsys/${SERVICENAME}_proxy\n            rm -f ${PROXY_PIDFILE}\n            success\n            echo \"Recommender Proxy Stopped\"\n        fi\n    fi\n\n    if [ -f $VISOR_PIDFILE ]; then\n        kill -KILL `/sbin/pidof $JUBAVISOR`\n        RETVAL=$?\n        if [ ${RETVAL} -eq 0 ]; then\n            rm -f /var/lock/subsys/${SERVICENAME}_visor\n            rm -f ${VISOR_PIDFILE}\n            success\n            echo \"Jubavisor Stopped\"\n        fi\n    fi\n\n    ${ZOOKEEPER} stop\n    echo\n}\n\ncase \"$1\" in\n    start)\n        start\n        ;;\n    stop)\n        stop\n        ;;\n    status)\n        status ${SERVICENAME}\n        ${JUBACTL} -c status --server=jubarecommender --type=recommender --name=${RECOMMENDER_NAME} --zookeeper ${ZOOKEEPER_HOST}:${ZOOKEEPER_PORT}\n        ;;\n    restart)\n        stop\n        start\n        ;;\n    *)\n        echo \"Usage : $0 (start|stop|status|restart)\"\n        RETVAL=1\nesac\n\nexit ${RETVAL}\n\n\n\n#\u524d\u63d0\u6761\u4ef6\n- AmazonLinux\u3067\u8d77\u52d5\u3067\u304d\u305f\u30b9\u30af\u30ea\u30d7\u30c8\u3067\u3059\n- configuration\u306eJSON\u30d5\u30a1\u30a4\u30eb\u306e\u30d1\u30b9\u306f\u9069\u5b9c\u5909\u66f4\u304f\u3060\u3055\u3044\u3002\n- zookeeper + jubaconfig + jubarecommender_proxy + jubavisor + jubavisor \u306e\u69cb\u6210\u3092jubactl\u3067\u8d77\u52d5\u3059\u308b\u5f62\u3067\u3059\u3002\n\n#\u8a2d\u7f6e\u5834\u6240\n/etc/init.d \u306b\u914d\u7f6e\u3002\n\n#\u4f7f\u3044\u65b9\n\n```shell-session\n$ sudo service jubatus-recommender\nUsage : /etc/init.d/jubatus-recommender (start|stop|status|restart)\n\n# START\n$ sudo service jubatus-recommender start\nStarting jubatus-recommender:\nJMX enabled by default\nUsing config: /home/ec2-user/zookeeper-X.X.X/bin/../conf/zoo.cfg\nStarting zookeeper ... STARTED\n3669 INFO  [zk.cpp:586] got ZooKeeper event: type SESSION_EVENT(-1), state CONNECTED_STATE(3)\n3669 INFO  [zk.cpp:597] ZooKeeper session established, negotiated timeout 10000 ms\n3667 INFO  [zk.cpp:113] connected to zk: 127.0.0.1:2181\n3672 INFO  [zk.cpp:586] got ZooKeeper event: type SESSION_EVENT(-1), state CONNECTED_STATE(3)\n3672 INFO  [zk.cpp:597] ZooKeeper session established, negotiated timeout 10000 ms\n3670 INFO  [zk.cpp:113] connected to zk: 127.0.0.1:2181\n3670 INFO  [config.cpp:143] set config to zookeeper: /jubatus/config/recommender/XXXX\nRecommender Proxy Started                                  [  OK  ]\nJubavisor Started                                          [  OK  ]\n3689 INFO  [zk.cpp:586] got ZooKeeper event: type SESSION_EVENT(-1), state CONNECTED_STATE(3)\n3689 INFO  [zk.cpp:597] ZooKeeper session established, negotiated timeout 10000 ms\n3687 INFO  [zk.cpp:113] connected to zk: 127.0.0.1:2181\nsending start / jubarecommender/XXXX to XXX.XXX.XXX.XXX_9200...ok.\nRecommender Started                                        [  OK  ]\n3708 INFO  [zk.cpp:586] got ZooKeeper event: type SESSION_EVENT(-1), state CONNECTED_STATE(3)\n3708 INFO  [zk.cpp:597] ZooKeeper session established, negotiated timeout 10000 ms\n3706 INFO  [zk.cpp:113] connected to zk: 127.0.0.1:2181\nsending load / XXXX to XXX.XXX.XXX.XXX_9201...ok.\n\n# STATUS\n$ sudo service jubatus-recommender status\njubatus-recommender (pid  XXXX) is running...\n3726 INFO  [zk.cpp:586] got ZooKeeper event: type SESSION_EVENT(-1), state CONNECTED_STATE(3)\n3726 INFO  [zk.cpp:597] ZooKeeper session established, negotiated timeout 10000 ms\n3724 INFO  [zk.cpp:113] connected to zk: 127.0.0.1:2181\nactive jubaproxy members:\nXXX.XXX.XXX.XXX_9199\nactive jubavisor members:\nXXX.XXX.XXX.XXX_9200\nactive XXXX members:\nXXX.XXX.XXX.XXX_9201\n\n# STOP\n$ sudo service jubatus-recommender stop\nStopping jubatus-recommender:\n2825 INFO  [zk.cpp:586] got ZooKeeper event: type SESSION_EVENT(-1), state CONNECTED_STATE(3)\n2825 INFO  [zk.cpp:597] ZooKeeper session established, negotiated timeout 10000 ms\n2823 INFO  [zk.cpp:113] connected to zk: 127.0.0.1:2181\nsending save / XXXX to XXX.XXX.XXX.XXX_9201...ok.\n2828 INFO  [zk.cpp:586] got ZooKeeper event: type SESSION_EVENT(-1), state CONNECTED_STATE(3)\n2828 INFO  [zk.cpp:597] ZooKeeper session established, negotiated timeout 10000 ms\n2826 INFO  [zk.cpp:113] connected to zk: 127.0.0.1:2181\nsending stop / jubarecommender/XXXX to XXX.XXX.XXX.XXX_9200...ok.\nRecommender Stopped                                        [  OK  ]\nRecommender Proxy Stopped                                  [  OK  ]\nJubavisor Stopped                                          [  OK  ]\nJMX enabled by default\nUsing config: /home/ec2-user/zookeeper-X.X.X/bin/../conf/zoo.cfg\nStopping zookeeper ... STOPPED\n\n```\n\n#\u8d77\u52d5\u30b9\u30af\u30ea\u30d7\u30c8\n- \u3053\u306e\u65b9\u306e\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u53c2\u8003\u306b\u3057\u307e\u3057\u305f\u3002\u5927\u5909\u53c2\u8003\u306b\u306a\u308a\u307e\u3057\u305f\u3002\u3042\u308a\u304c\u3068\u3046\u3054\u3056\u3044\u307e\u3057\u305f\u3002\n- [jubatus - jubaclassifier \u8d77\u52d5\u30b9\u30af\u30ea\u30d7\u30c8 \uff08\u30b9\u30bf\u30f3\u30c9\u30a2\u30ed\u30f3\uff09 - Qiita](http://qiita.com/oggy8021/items/fc31633b22fe97caaf56)\n\n```jubatus-recommender.sh\n#!/bin/sh\n#\n# chkconfig: - 99 32\n\n# Source function library\n. /etc/init.d/functions\n\nSERVICENAME=\"jubatus-recommender\"\nRETVAL=0\n\nPROXY_PIDFILE=/var/run/jubatus-recommender_proxy.pid\nRECOMMENDER_PIDFILE=/var/run/jubatus-recommender.pid\nVISOR_PIDFILE=/var/run/jubatus-visor.pid\nPREFIX_HOST=`/sbin/ifconfig | grep 'inet addr' | grep -v 127.0.0.1 | awk '{print $2;}' | cut -d: -f2`\nJUBACONFIG=/usr/bin/jubaconfig\nJUBARECOMMENDER_PROXY=/usr/bin/jubarecommender_proxy\nJUBARECOMMENDER=/usr/bin/jubarecommender\nJUBAVISOR=/usr/bin/jubavisor\nJUBACTL=/usr/bin/jubactl\nJUBATUS_TYPE=recommender\nRECOMMENDER_NAME=XXXX  # \u9069\u5b9c\u8a2d\u5b9a\u3057\u3066\u304f\u3060\u3055\u3044\nRECOMMENDER_PORT=9200\nZOOKEEPER=/home/ec2-user/zookeeper-X.X.X/bin/zkServer.sh  # \u9069\u5b9c\u8a2d\u5b9a\u3057\u3066\u304f\u3060\u3055\u3044\nZOOKEEPER_HOST=localhost\nZOOKEEPER_PORT=2181\n\nCONFIG=/etc/jubatus/config.json\nLOGDIR=/var/log/jubatus\nMODELDIR=/tmp\nLOGCONFIG=/usr/share/jubatus/example/log/log4cxx.xml\nMODEL_FILE=/tmp/${PREFIX_HOST}_9201_${JUBATUS_TYPE}_${RECOMMENDER_NAME}.jubatus\n\nstart() {\n    ## \u30ed\u30c3\u30af\u30d5\u30a1\u30a4\u30eb\u306e\u78ba\u8a8d\n    if [ -f $PROXY_PIDFILE -a -f $VISOR_PIDFILE -a -f $RECOMMENDER_PIDFILE ]; then\n        echo \"Jubatus Recommender Service is already started\"\n        exit 1\n    fi\n\n    echo \"Starting ${SERVICENAME}:\"\n    ## \u30ed\u30b0\u30d5\u30a9\u30eb\u30c0\u304c\u306a\u3044\u5834\u5408\u306b\u4f5c\u6210\u3059\u308b\n    if [ ! -e ${LOGDIR} ]; then\n        mkdir ${LOGDIR}\n    fi\n    ${ZOOKEEPER} start\n    wait\n    ${JUBACONFIG} --cmd delete --zookeeper=${ZOOKEEPER_HOST}:${ZOOKEEPER_PORT} --file ${CONFIG} --name ${RECOMMENDER_NAME} --type ${JUBATUS_TYPE}\n    wait\n    ${JUBACONFIG} --cmd write --zookeeper=${ZOOKEEPER_HOST}:${ZOOKEEPER_PORT} --file ${CONFIG} --name ${RECOMMENDER_NAME} --type ${JUBATUS_TYPE}\n    wait\n    sleep 2\n    ${JUBARECOMMENDER_PROXY} --zookeeper ${ZOOKEEPER_HOST}:${ZOOKEEPER_PORT} -g ${LOGCONFIG} -l ${LOGDIR} &\n    RETVAL=$?\n    if [ ${RETVAL} = 0 ]; then\n        success\n        touch /var/lock/subsys/${SERVICENAME}_proxy\n        /sbin/pidof ${JUBARECOMMENDER_PROXY} > ${PROXY_PIDFILE}\n        echo \"Recommender Proxy Started\"\n    else\n        failure\n    fi\n\n    ${JUBAVISOR} --rpc-port=${RECOMMENDER_PORT} --zookeeper ${ZOOKEEPER_HOST}:${ZOOKEEPER_PORT} -g ${LOGCONFIG} -l ${LOGDIR} --daemon\n    RETVAL=$?\n    if [ ${RETVAL} = 0 ]; then\n        success\n        touch /var/lock/subsys/${SERVICENAME}_visor\n        /sbin/pidof ${JUBAVISOR} > ${VISOR_PIDFILE}\n       echo \"Jubavisor Started\"\n    else\n        failure\n    fi\n\n    ${JUBACTL} -c start --server=jubarecommender --type=recommender --name=${RECOMMENDER_NAME} --zookeeper ${ZOOKEEPER_HOST}:${ZOOKEEPER_PORT} -G ${LOGCONFIG} -L ${LOGDIR}\n    RETVAL=$?\n    if [ ${RETVAL} = 0 ]; then\n        success\n        touch /var/lock/subsys/${SERVICENAME}\n        /sbin/pidof ${JUBARECOMMENDER} > ${RECOMMENDER_PIDFILE}\n        echo \"Recommender Started\"\n    else\n        failure\n    fi\n\n    sleep 3\n    ${JUBACTL} -c load --server=jubarecommender --type=recommender --name=${RECOMMENDER_NAME} --zookeeper ${ZOOKEEPER_HOST}:${ZOOKEEPER_PORT}\n    RETVAL=$?\n    if [ ${RETVAL} = 0 ]; then\n        success\n    else\n        failure\n    fi\n    echo\n}\n\nstop() {\n    ## \u30ed\u30c3\u30af\u30d5\u30a1\u30a4\u30eb\u306e\u78ba\u8a8d\n    if [ ! -e $PROXY_PIDFILE -a ! -e $VISOR_PIDFILE -a ! -e $RECOMMENDER_PIDFILE ]; then\n        echo \"Jubatus Recommender Service is already stopped\"\n        exit 1\n    fi\n\n    echo \"Stopping ${SERVICENAME}:\"\n    if [ -f $RECOMMENDER_PIDFILE ]; then\n        ${JUBACTL} -c save --server=jubarecommender --type=recommender --name=${RECOMMENDER_NAME} --zookeeper ${ZOOKEEPER_HOST}:${ZOOKEEPER_PORT}\n        ${JUBACTL} -c stop --server=jubarecommender --type=recommender --name=${RECOMMENDER_NAME} --zookeeper ${ZOOKEEPER_HOST}:${ZOOKEEPER_PORT}\n        RETVAL=$?\n        if [ ${RETVAL} -eq 0 ]; then\n            rm -f /var/lock/subsys/${SERVICENAME}\n            rm -f ${RECOMMENDER_PIDFILE}\n            success\n            echo \"Recommender Stopped\"\n        fi\n    fi\n\n    if [ -f $PROXY_PIDFILE ]; then\n        kill -KILL `/sbin/pidof $JUBARECOMMENDER_PROXY`\n        RETVAL=$?\n        if [ ${RETVAL} -eq 0 ]; then\n            rm -f /var/lock/subsys/${SERVICENAME}_proxy\n            rm -f ${PROXY_PIDFILE}\n            success\n            echo \"Recommender Proxy Stopped\"\n        fi\n    fi\n\n    if [ -f $VISOR_PIDFILE ]; then\n        kill -KILL `/sbin/pidof $JUBAVISOR`\n        RETVAL=$?\n        if [ ${RETVAL} -eq 0 ]; then\n            rm -f /var/lock/subsys/${SERVICENAME}_visor\n            rm -f ${VISOR_PIDFILE}\n            success\n            echo \"Jubavisor Stopped\"\n        fi\n    fi\n\n    ${ZOOKEEPER} stop\n    echo\n}\n\ncase \"$1\" in\n    start)\n        start\n        ;;\n    stop)\n        stop\n        ;;\n    status)\n        status ${SERVICENAME}\n        ${JUBACTL} -c status --server=jubarecommender --type=recommender --name=${RECOMMENDER_NAME} --zookeeper ${ZOOKEEPER_HOST}:${ZOOKEEPER_PORT}\n        ;;\n    restart)\n        stop\n        start\n        ;;\n    *)\n        echo \"Usage : $0 (start|stop|status|restart)\"\n        RETVAL=1\nesac\n\nexit ${RETVAL}\n```\n", "tags": ["jubatus", "ShellScript", "ZooKeeper", "Recommendation"]}