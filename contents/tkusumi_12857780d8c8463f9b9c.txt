{"tags": ["kubernetes"], "context": "Kubernetes Helm\u3092\u8a66\u3057\u3066\u307f\u307e\u3057\u305f\u3002\u4e0b\u8a18\u306fv2.0.0-alpha.5\u3067\u6642\u70b9\u3067\u306e\u60c5\u5831\u3067\u3059\u3002\n\nKubernetes Helm\u3068\u306f\nKubernetes Helm(\u4ee5\u964dHelm)\u3068\u306fKubernetes\u306e\u30d1\u30c3\u30b1\u30fc\u30b8\u30de\u30cd\u30fc\u30b8\u30e3\u30fc\u3067\u3059\u3002Helm\u306fKubernetes\u306eSIG-Apps\u3067\u958b\u767a\u304c\u3055\u308c\u3066\u3044\u307e\u3059\u3002\u30d1\u30c3\u30b1\u30fc\u30b8\u306fChart(s)\u3068\u547c\u3070\u308c\u3001\u516c\u5f0f\u3067\u30ec\u30dd\u30b8\u30c8\u30eakubernetes/charts\u304c\u7528\u610f\u3055\u308c\u3066\u3044\u307e\u3059\u3002Kubernetes\u30af\u30e9\u30b9\u30bf\u306b\u5074\u306b\u306ftiller\u3068\u547c\u3070\u308c\u308b\u30c7\u30d7\u30ed\u30a4\u7528\u306e\u30b3\u30f3\u30dd\u30fc\u30cd\u30f3\u30c8\u3092\u914d\u7f6e\u3057\u3066\u4f7f\u7528\u3057\u307e\u3059\u3002\n\n\n\n\u7528\u8a9e\n\u610f\u5473\n\u5f79\u5272\n\n\n\n\nhelm\n\u8239\u306e\u304b\u3058\nyum, apt\u306b\u76f8\u5f53\u3059\u308b\u30d1\u30c3\u30b1\u30fc\u30b8\u30de\u30cd\u30fc\u30b8\u30e3\u30fc\u3002Linux, OSX\u306e\u30d0\u30a4\u30ca\u30ea\u304c\u7528\u610f\u3055\u308c\u3066\u3044\u308b\n\n\nchart\n\u6d77\u56f3\ndeb, rpm\u306b\u76f8\u5f53\u3059\u308b\u30d1\u30c3\u30b1\u30fc\u30b8\u3002Kubernetes\u306e\u30de\u30cb\u30d5\u30a7\u30b9\u30c8\u306e\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u3092\u307e\u3068\u3081\u305f\u3082\u306e\n\n\ntiller\n\u8235\u67c4\n\u30c7\u30d7\u30ed\u30a4\u3092\u62c5\u3046\u30b5\u30fc\u30d0\u30fc\u30b3\u30f3\u30dd\u30fc\u30cd\u30f3\u30c8\n\n\n\n\n\u516c\u5f0f\u30ec\u30dd\u30b8\u30c8\u30ea\n\u516c\u5f0f\u30ec\u30dd\u30b8\u30c8\u30ea\u3067\u306fstable\u3068incubator\u306e2\u3064\u306b\u5206\u3051\u3066\u7ba1\u7406\u3055\u308c\u3066\u3044\u307e\u3059\u3002kubernetes/charts\u306estable\u306e\u8aac\u660e\u306b\u3088\u308b\u3068\u4e0b\u8a18\u306e\u30dd\u30ea\u30b7\u30fc\u3067\u904b\u7528\u3055\u308c\u3066\u3044\u307e\u3059\u3002\n\n\u30c7\u30fc\u30bf\u6c38\u7d9a\u5316\u306e\u65b9\u6cd5\u304c\u63d0\u4f9b\u3055\u308c\u308b\n\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u30a2\u30c3\u30d7\u30b0\u30ec\u30fc\u30c9\u304c\u30b5\u30dd\u30fc\u30c8\u3055\u308c\u308b\n\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u8a2d\u5b9a\u306e\u30ab\u30b9\u30bf\u30de\u30a4\u30ba\u3092\u8a31\u53ef\u3059\u308b\n\u30bb\u30ad\u30e5\u30a2\u306a\u30c7\u30d5\u30a9\u30eb\u30c8\u8a2d\u5b9a\u3092\u6301\u3064\nKubernetes\u306e\u30a2\u30eb\u30d5\u30a1\u6a5f\u80fd\u3092\u5229\u7528\u3057\u306a\u3044\n\n\u516c\u5f0f\u30ec\u30dd\u30b8\u30c8\u30ea\u4ee5\u5916\u306b\u4efb\u610f\u306e\u30ec\u30dd\u30b8\u30c8\u30ea\u3092\u4f7f\u7528\u3059\u308b\u3053\u3068\u3082\u53ef\u80fd\u3067\u3059\u3002\u306a\u304a\u3001\u73fe\u5728\u306f\u4e0b\u8a18\u306e\u30d1\u30c3\u30b1\u30fc\u30b8\u304c\u63d0\u4f9b\u3055\u308c\u3066\u3044\u307e\u3059\u3002\n\nStable\n\ndrupal\njenkins\nmariadb\nmysql\nredmine\nwordpress\n\n\nIncubator\n\nconsul\nelasticsearch\netcd\ngrafana\nmongodb\npatroni\nprometheus\nspark\nzookeeper\n\n\n\u65e7Helm\u3001DeploymentManager\u3068\u306e\u95a2\u4fc2\nKubernetes Helm\u306fHelm Classic(\u65e7Helm)\u3068\u3044\u3046\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3068\u3001Kubernetes\u30c1\u30fc\u30e0\u304c\u958b\u767a\u3059\u308bdeployment-manager(dm)\u3068\u3044\u30462\u3064\u306e\u30c4\u30fc\u30eb\u304c\u7d71\u5408\u3055\u308c\u305f\u3082\u306e\u3067\u3059\u3002Integrate helm and dm #171\u306b\u3088\u308b\u3068\u3001\u30cf\u30c3\u30ab\u30bd\u30f3\u3067\u3053\u306e2\u3064\u3092\u7d71\u5408\u3059\u308b\u3068\u6c7a\u3081\u305f\u3089\u3057\u304f\u3001\u30ec\u30dd\u30b8\u30c8\u30ea\u540d\u3082\"deployment-manager\"\u304b\u3089\"helm\"\u306b\u5909\u66f4\u3055\u308c\u307e\u3057\u305f\u3002\u73fe\u5728\u306eKubernetes Helm\u3082\u4e3b\u306bDeis(Engine Yard)\u306e\u30a8\u30f3\u30b8\u30cb\u30a2\u304c\u958b\u767a\u3057\u3066\u3044\u307e\u3059\u3002\u53c2\u8003: Kubernetes Helm\u306eContributors\n\nHelm\u3092\u8a66\u3057\u3066\u307f\u308b\n\nHelm\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\nHelm\u306e\u30af\u30e9\u30a4\u30a2\u30f3\u30c8(helm\u30b3\u30de\u30f3\u30c9)\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3092\u884c\u3044\u307e\u3059\u3002Homebrew Cask\u306eformula\u304c\u7528\u610f\u3055\u308c\u3066\u307e\u3059\u304c\u3001\u6700\u65b0\u306e\u30d0\u30fc\u30b8\u30e7\u30f3(v2.0.0-alpha.5)\u3092\u4f7f\u3044\u305f\u304b\u3063\u305f\u306e\u3067\u3001releases\u304b\u3089\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3057PATH\u306e\u901a\u3063\u305f\u5834\u6240\u306bhelm\u30d0\u30a4\u30ca\u30ea\u3092\u914d\u7f6e\u3057\u307e\u3057\u305f\u3002\n$ export HELM_OS=darwin && wget https://storage.googleapis.com/kubernetes-helm/helm-v2.0.0-alpha.5-$HELM_OS-amd64.tar.gz && tar -zxvf helm-v2.0.0-alpha.5-$HELM_OS-amd64.tar.gz && cd $HELM_OS-amd64\n\n\u4e0b\u8a18\u306e\u30b3\u30de\u30f3\u30c9\u3067\u30af\u30e9\u30b9\u30bf\u306e\u521d\u671f\u5316\u3092\u884c\u3044\u307e\u3059\u3002\u521d\u671f\u5316\u3067\u306fkubernetes\u30af\u30e9\u30b9\u30bf\u306b\u30b5\u30fc\u30d0\u30fc\u30b3\u30f3\u30dd\u30fc\u30cd\u30f3\u30c8(tiller)\u306e\u30c7\u30d7\u30ed\u30a4\u3092\u884c\u3046\u305f\u3081\u3001kubectl\u306e\u63a5\u7d9a\u5148\u8a2d\u5b9a\u3082\u3055\u308c\u3066\u3044\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\n$ helm init\n\nCreating /Users/tkusumi/.helm\nCreating /Users/tkusumi/.helm/repository\nCreating /Users/tkusumi/.helm/repository/cache\nCreating /Users/tkusumi/.helm/repository/local\nCreating /Users/tkusumi/.helm/repository/repositories.yaml\nCreating /Users/tkusumi/.helm/repository/local/index.yaml\n$HELM_HOME has been configured at $HOME/.helm.\n\nTiller (the helm server side component) has been installed into your Kubernetes Cluster.\nHappy Helming!\n\n\u4e0b\u8a18\u306e\u3088\u3046\u306b\u30b5\u30fc\u30d0\u30fc\u30b3\u30f3\u30dd\u30fc\u30cd\u30f3\u30c8\u306etiller\u304ckubernetes\u30af\u30e9\u30b9\u30bf\u306ekube-system\u30cd\u30fc\u30e0\u30b9\u30da\u30fc\u30b9\u306b\u30c7\u30d7\u30ed\u30a4\u3055\u308c\u307e\u3059\u3002\n$ kubectl get pods --all-namespaces | grep tiller\nkube-system   tiller-deploy-637859184-v6za1                         1/1       Running   0          1m\n\nhelm version\u3067\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u3001\u30b5\u30fc\u30d0\u30fc\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u3092\u78ba\u8a8d\u3067\u304d\u307e\u3059\u3002\n$ helm version\nClient: &version.Version{SemVer:\"v2.0.0-alpha.5\", GitCommit:\"36ec1901ebd68ae976fa8ef332ca5ed44598fc24\", GitTreeState:\"clean\"}\nServer: &version.Version{SemVer:\"v2.0.0-alpha.5\", GitCommit:\"4de5c4aa578ed9ca173aff472f00d2167ec59a88\", GitTreeState:\"dirty\"}\n\n\u53c2\u8003\n\nhttps://github.com/kubernetes/helm/blob/master/docs/install.md\n\n\nHelm\u3067\u30d1\u30c3\u30b1\u30fc\u30b8\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\nhelm search\u3067stable\u30d1\u30c3\u30b1\u30fc\u30b8\u306e\u4e00\u89a7\u304c\u53d6\u5f97\u3067\u304d\u307e\u3059\u3002(2.0.0-Alpha.5\u304b\u3089\u306e\u6a5f\u80fd)\n$ helm search\nNAME                    VERSION DESCRIPTION\nstable/drupal           0.3.2   One of the most versatile open source content m...\nstable/jenkins          0.1.0   A Jenkins Helm chart for Kubernetes.\nstable/mariadb          0.5.0   Chart for MariaDB\nstable/mysql            0.1.0   Chart for MySQL\nstable/redmine          0.3.1   A flexible project management web application.\nstable/wordpress        0.3.0   Web publishing platform for building blogs and ...\n\nhelm install PACKAGE_NAME\u3067\u30d1\u30c3\u30b1\u30fc\u30b8\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3092\u884c\u3044\u307e\u3059\u3002\u3053\u3053\u3067\u306fJenkins\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u3066\u307f\u307e\u3059\u3002\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u6642\u306b\u30d1\u30c3\u30b1\u30fc\u30b8\u3054\u3068\u306e\u8a2d\u5b9a\u3092\u6307\u5b9a\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\u6307\u5b9a\u53ef\u80fd\u306a\u5024\u306f\u5404\u30d1\u30c3\u30b1\u30fc\u30b8\u306eREADME\u306b\u304b\u304b\u308c\u3066\u3044\u307e\u3059\u3002\u53c2\u8003: Jenkins\u306eREADME\n$ helm install stable/jenkins\nFetched stable/jenkins to jenkins-0.1.0.tgz\nviable-robin\nLast Deployed: Tue Oct 11 13:57:50 2016\nNamespace: default\nStatus: DEPLOYED\n\n~\u7701\u7565~\n\nNotes:\nGetting Started:\n\n1. Get your 'admin' user password by running:\n  printf $(printf '\\%o' `kubectl get secret --namespace default viable-robin-jenkins -o jsonpath=\"{.data.jenkins-admin-password[*]}\"`);echo\n\n2. Get the Jenkins URL to visit by running these commands in the same shell:\n**** NOTE: It may take a few minutes for the LoadBalancer IP to be available.                      ****\n****       You can watch the status of by running 'kubectl get svc -w viable-robin-jenkins' ****\n  export SERVICE_IP=$(kubectl get svc --namespace default viable-robin-jenkins -o jsonpath='{.status.loadBalancer.ingress[0].ip}')\n  echo http://$SERVICE_IP:8080/login\n\n3. Login with the password from step 1 and the username: admin\n\nFor more information on running Jenkins on Kubernetes, visit:\nhttps://cloud.google.com/solutions/jenkins-on-container-engine\n\nJenkins\u306b\u30a2\u30af\u30bb\u30b9\u3059\u308b\u624b\u9806\u304c\u8868\u793a\u3055\u308c\u308b\u306e\u3067\u624b\u9806\u306e\u901a\u308a\u30a2\u30af\u30bb\u30b9\u3057\u3001\u6b63\u3057\u304fJenkins\u304c\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u305f\u3053\u3068\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\n\n\u4e0b\u8a18\u306e\u3088\u3046\u306bJenkins\u306ePod\u304c\u914d\u7f6e\u3055\u308c\u307e\u3057\u305f\u3002\n$ kubectl get pods\nNAME                                    READY     STATUS    RESTARTS   AGE\nviable-robin-jenkins-4218656479-dvu4v   1/1       Running   0          4m\n\nhelm list\u30b3\u30de\u30f3\u30c9\u3067\u30c7\u30d7\u30ed\u30a4\u3055\u308c\u305f\u4e00\u89a7\u3092\u78ba\u8a8d\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n$ helm list\nNAME            REVISION        UPDATED                         STATUS          CHART\nviable-robin    1               Tue Oct 11 13:57:50 2016        DEPLOYED        jenkins-0.1.0\n\n\n\u30d1\u30c3\u30b1\u30fc\u30b8(Charts)\u3092\u8a66\u3057\u306b\u4f5c\u3063\u3066\u307f\u308b\nhttps://github.com/kubernetes/helm/blob/master/docs/charts.md\n\u3053\u3053\u3067\u306f\u30b5\u30f3\u30d7\u30eb\u306b\u4efb\u610f\u306e\u6587\u5b57\u5217\u3092\u8a2d\u5b9a\u3067\u304d\u308bnginx\u306e\u30d1\u30c3\u30b1\u30fc\u30b8(Charts)\u3092\u4f5c\u308a\u307e\u3059\u3002\nhelm create\u3068\u3044\u3046\u30b3\u30de\u30f3\u30c9\u3067\u96db\u5f62\u3092\u751f\u6210\u3057\u307e\u3059\u3002\n$ helm create helloworld\nCreating helloworld\n\n\u4e0b\u8a18\u306e\u69cb\u6210\u3067\u30d5\u30a1\u30a4\u30eb\u304c\u4f5c\u3089\u308c\u307e\u3059\u3002\nhelloworld/\n  Chart.yaml    # chart\u306e\u60c5\u5831\u3092\u8a18\u8f09\u3059\u308byaml\n  values.yaml   # chart\u306e\u30c7\u30d5\u30a9\u30eb\u30c8\u8a2d\u5b9a\n  charts/       # chart\u306e\u4f9d\u5b58\u3092\u542b\u3081\u308b\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\n  templates/    # \u30de\u30cb\u30d5\u30a7\u30b9\u30c8\u30d5\u30a1\u30a4\u30eb\u306e\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u3092\u914d\u7f6e\u3059\u308b\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\n\ntemplates/\u4ee5\u4e0b\u306bkubernetes\u306e\u30de\u30cb\u30d5\u30a7\u30b9\u30c8\u30d5\u30a1\u30a4\u30eb\u306e\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u3092\u914d\u7f6e\u3057\u307e\u3059\u3002\u3053\u3053\u3067\u306f\u4e0b\u8a18\u306e\u30de\u30cb\u30d5\u30a7\u30b9\u30c8\u306e\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u3092\u914d\u7f6e\u3057\u307e\u3057\u305f\u3002\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u306fGo\u306etext/template\u5f62\u5f0f\u3067\u8a18\u8ff0\u3057\u307e\u3059\u3002.Values\u3068\u3044\u3046\u306e\u304c\u4efb\u610f\u306b\u8a2d\u5b9a\u3059\u308b\u60c5\u5831\u3067\u3059\u3002\n\nhello-deployment.yaml\napiVersion: extensions/v1beta1\nkind: Deployment\nmetadata:\n  # \u672c\u6765\u306f{{.Release.Name}}\u306a\u3069\u3092\u4f7f\u3063\u3066\u30e6\u30cb\u30fc\u30af\u306b\u3059\u308b\u5fc5\u8981\u304c\u3042\u308b\n  name: \"hello-nginx\"\n  labels:\nspec:\n  # \u4efb\u610f\u306e\u30ec\u30d7\u30ea\u30ab\u6570\u3092\u8a2d\u5b9a\u3067\u304d\u308b\n  replicas: {{.Values.replicaCount}}\n  template:\n    metadata:\n      labels:\n        app: \"hello-nginx\"\n    spec:\n      containers:\n      - image: nginx:1.11.4\n        name: nginx\n        ports:\n        - containerPort: 80\n        command:\n        - /bin/bash\n        - -c\n        # \u4efb\u610f\u306e\u5024\u3092index.html\u3067\u8868\u793a\n        - 'echo \"<h1>{{.Values.message}}</h1>\" > /usr/share/nginx/html/index.html; /usr/sbin/nginx -g \"daemon off;\"'\n\n\n\nhello-svc.yaml\napiVersion: v1\nkind: Service\nmetadata:\n  name: hello-nginx\n  labels:\nspec:\n  ports:\n    - port: 80\n      name: http\n      targetPort: 80\n  selector:\n    app: \"hello-nginx\"\n  type: LoadBalancer\n\n\nvalues.yaml\u306b\u521d\u671f\u5024\u3092\u8a18\u8f09\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n\nvalues.yaml\nreplicaCount: 2\nmessage: hello world!\n\n\nhelm lint\u3068\u3044\u3046\u69cb\u6587\u30c1\u30a7\u30c3\u30af\u30c4\u30fc\u30eb\u304c\u4ed8\u5c5e\u3057\u3066\u3044\u304a\u308a\u3001\u69cb\u6587\u30a8\u30e9\u30fc\u3092\u30c1\u30a7\u30c3\u30af\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n$ helm lint helloworld\n==> Linting helloworld\n[ERROR] templates/: render error in \"helloworld/templates/hello-deployment.yaml\": template: helloworld/templates/hello-deployment.yaml:14:24: executing \"helloworld/templates/hello-deployment.yaml\" at <{{template \"fullname...>: template \"fullname\" not defined\n\nError: 1 chart(s) linted, 1 chart(s) failed\n\n\u69cb\u6587\u306b\u554f\u984c\u304c\u306a\u3051\u308c\u3070\u30d1\u30c3\u30b1\u30fc\u30b8(tgz\u30d5\u30a1\u30a4\u30eb)\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n$ helm package helloworld\n\n\u30d1\u30c3\u30b1\u30fc\u30b8\u3055\u308c\u305fhelloworld-0.1.0.tgz\u304c\u4f5c\u6210\u3055\u308c\u307e\u3057\u305f\u3002\u4e0b\u8a18\u306e\u7528\u306b\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u304c\u3067\u304d\u307e\u3059\u3002\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u306e\u5909\u6570\u306f--set\u30d5\u30e9\u30b0\u3067\u30ab\u30f3\u30de\u533a\u5207\u308a\u306ekey=value\u5f62\u5f0f\u3001\u307e\u305f\u306f--values\u30d5\u30e9\u30b0\u3067yaml\u5f62\u5f0f\u3067\u6307\u5b9a\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n$ helm install --set 'message=It works!,replicaCount=3' helloworld-0.1.0.tgz\nright-quail\nLast Deployed: Tue Oct 11 16:19:10 2016\nNamespace: default\nStatus: DEPLOYED\n\nResources:\n==> extensions/Deployment\nNAME          DESIRED   CURRENT   UP-TO-DATE   AVAILABLE   AGE\nhello-nginx   3         3         3            0           0s\n\n==> v1/Service\nNAME          CLUSTER-IP     EXTERNAL-IP   PORT(S)   AGE\nhello-nginx   10.187.251.4   <pending>     80/TCP    0s\n\n\u30ed\u30fc\u30c9\u30d0\u30e9\u30f3\u30b5\u306eEXTERNAL-IP\u3092\u78ba\u8a8d\u3057\u3066\u30d6\u30e9\u30a6\u30b6\u3067\u30a2\u30af\u30bb\u30b9\u3057\u307e\u3059\u3002\n$ kubectl get svc hello-nginx\nNAME          CLUSTER-IP     EXTERNAL-IP       PORT(S)   AGE\nhello-nginx   10.187.251.4   104.155.129.166   80/TCP    53s\n\n\n\u65e2\u5b58\u306eChart\u3092\u898b\u308b\u3068\u3001\u4ed6\u306b\u3082\u30e9\u30d9\u30eb\u306a\u3069\u306e\u8a2d\u5b9a\u304c\u3044\u308d\u3044\u308d\u3068\u3042\u308b\u306e\u3067\u3001\u5b9f\u969b\u306b\u4f5c\u308b\u969b\u306f\u65e2\u5b58\u306e\u3082\u306e\u3092\u53c2\u8003\u306b\u3059\u308b\u3068\u3088\u3044\u3068\u601d\u3044\u307e\u3059\u3002\u4f8b\u3048\u3070Release.Name(\u6307\u5b9a\u3057\u306a\u3044\u3068\u30e9\u30f3\u30c0\u30e0\u3067\u4ed8\u3051\u3089\u308c\u308b)\u306e\u3088\u3046\u306a\u4e8b\u524d\u306b\u5b9a\u7fa9\u3055\u308c\u305f\u5909\u6570\u304c\u3042\u308a\u3001\u3053\u308c\u3089\u3092\u4f7f\u3063\u3066\u30e6\u30cb\u30fc\u30af\u306aname\u3092\u8a2d\u5b9a\u3057\u305f\u308a\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\n\n\u305d\u306e\u4ed6\u306bChart\u3067\u3067\u304d\u308b\u3053\u3068\nCharts\u306e\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u306b\u3088\u308b\u3068\u4ed6\u306bCharts\u3067\u4e0b\u8a18\u306e\u3053\u3068\u304c\u3067\u304d\u308b\u3088\u3046\u3067\u3059\u3002\n\n\u4f9d\u5b58\u95a2\u4fc2\nChart\u306e\u4f9d\u5b58\u95a2\u4fc2\u3092charts/\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3078\u306e\u30b3\u30d4\u30fc\u307e\u305f\u306frequirements.yaml\u306b\u3088\u308b\u5b9a\u7fa9\u3067\u8868\u73fe\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\u3053\u308c\u306b\u3088\u308a\u81ea\u52d5\u7684\u306bChart\u306e\u4f9d\u5b58\u95a2\u4fc2\u3092\u89e3\u6c7a\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\nrequirements.yaml\ndependencies:\n  - name: apache\n    version: 1.2.3\n    repository: http://example.com/charts\n  - name: mysql\n    version: 3.2.1\n    repository: http://another.example.com/charts\n\n\n\n\u30d5\u30c3\u30af\n\u30d1\u30c3\u30b1\u30fc\u30b8\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3001\u524a\u9664\u3001\u30a2\u30c3\u30d7\u30b0\u30ec\u30fc\u30c9\u6642\u306b\u30d5\u30c3\u30af\u3059\u308b\u6a5f\u80fd\u304c\u63d0\u4f9b\u3055\u308c\u3066\u3044\u307e\u3059\u3002\u4f8b\u3048\u3070\u30b7\u30fc\u30af\u30ec\u30c3\u30c8\u3092\u52d5\u7684\u306b\u4f5c\u308b\u3053\u3068\u3084\u3001\u30a2\u30c3\u30d7\u30b0\u30ec\u30fc\u30c9\u524d\u306bDB\u306e\u30d0\u30c3\u30af\u30a2\u30c3\u30d7\u3092\u53d6\u308b\u306a\u3069\u306e\u7528\u9014\u306b\u5229\u7528\u3067\u304d\u307e\u3059\u3002\u4e0b\u8a18\u306e\u30d5\u30c3\u30af\u30dd\u30a4\u30f3\u30c8\u304c\u7528\u610f\u3055\u308c\u3066\u3044\u307e\u3059\u3002\n\npre-install\npost-install\npre-delete\npost-delete\npre-upgrade\npost-upgrade\n\n\u30d5\u30c3\u30af\u306e\u51e6\u7406\u306fKubernetes\u306eBatch Job\u3068\u3057\u3066\u5b9a\u7fa9\u3057\u3001\u4e0b\u8a18\u306e\u3088\u3046\u306b\u30a2\u30ce\u30c6\u30fc\u30b7\u30e7\u30f3\u3067\u30d5\u30c3\u30af\u30dd\u30a4\u30f3\u30c8\u3092\u6307\u5b9a\u3067\u304d\u307e\u3059\u3002\u30ab\u30f3\u30de\u533a\u5207\u308a\u3067\u8907\u6570\u3057\u3066\u3044\u3059\u308b\u3053\u3068\u3082\u3067\u304d\u307e\u3059\u3002\n  annotations:\n    \"helm.sh/hook\": post-install\n\n\n\u53c2\u8003\n\nhttps://github.com/kubernetes/helm\nhttps://github.com/kubernetes/charts\nhttp://blog.kubernetes.io/2016/10/helm-charts-making-it-simple-to-package-and-deploy-apps-on-kubernetes.html\n\n[Kubernetes Helm](https://github.com/kubernetes/helm)\u3092\u8a66\u3057\u3066\u307f\u307e\u3057\u305f\u3002\u4e0b\u8a18\u306f`v2.0.0-alpha.5`\u3067\u6642\u70b9\u3067\u306e\u60c5\u5831\u3067\u3059\u3002\n\n# Kubernetes Helm\u3068\u306f\n\n**Kubernetes Helm**(\u4ee5\u964d**Helm**)\u3068\u306fKubernetes\u306e\u30d1\u30c3\u30b1\u30fc\u30b8\u30de\u30cd\u30fc\u30b8\u30e3\u30fc\u3067\u3059\u3002Helm\u306fKubernetes\u306e[SIG-Apps](https://github.com/kubernetes/community/tree/master/sig-apps)\u3067\u958b\u767a\u304c\u3055\u308c\u3066\u3044\u307e\u3059\u3002\u30d1\u30c3\u30b1\u30fc\u30b8\u306f**Chart**(s)\u3068\u547c\u3070\u308c\u3001\u516c\u5f0f\u3067\u30ec\u30dd\u30b8\u30c8\u30ea[kubernetes/charts](https://github.com/kubernetes/charts)\u304c\u7528\u610f\u3055\u308c\u3066\u3044\u307e\u3059\u3002Kubernetes\u30af\u30e9\u30b9\u30bf\u306b\u5074\u306b\u306f**tiller**\u3068\u547c\u3070\u308c\u308b\u30c7\u30d7\u30ed\u30a4\u7528\u306e\u30b3\u30f3\u30dd\u30fc\u30cd\u30f3\u30c8\u3092\u914d\u7f6e\u3057\u3066\u4f7f\u7528\u3057\u307e\u3059\u3002\n\n\u7528\u8a9e | \u610f\u5473 | \u5f79\u5272\n--- | --- | ---\nhelm | \u8239\u306e\u304b\u3058 | yum, apt\u306b\u76f8\u5f53\u3059\u308b\u30d1\u30c3\u30b1\u30fc\u30b8\u30de\u30cd\u30fc\u30b8\u30e3\u30fc\u3002Linux, OSX\u306e\u30d0\u30a4\u30ca\u30ea\u304c\u7528\u610f\u3055\u308c\u3066\u3044\u308b\nchart | \u6d77\u56f3 | deb, rpm\u306b\u76f8\u5f53\u3059\u308b\u30d1\u30c3\u30b1\u30fc\u30b8\u3002Kubernetes\u306e\u30de\u30cb\u30d5\u30a7\u30b9\u30c8\u306e\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u3092\u307e\u3068\u3081\u305f\u3082\u306e\ntiller | \u8235\u67c4 | \u30c7\u30d7\u30ed\u30a4\u3092\u62c5\u3046\u30b5\u30fc\u30d0\u30fc\u30b3\u30f3\u30dd\u30fc\u30cd\u30f3\u30c8\n\n## \u516c\u5f0f\u30ec\u30dd\u30b8\u30c8\u30ea\n\n\u516c\u5f0f\u30ec\u30dd\u30b8\u30c8\u30ea\u3067\u306f[stable](https://github.com/kubernetes/charts/tree/master/stable)\u3068[incubator](https://github.com/kubernetes/charts/tree/master/incubator)\u306e2\u3064\u306b\u5206\u3051\u3066\u7ba1\u7406\u3055\u308c\u3066\u3044\u307e\u3059\u3002[kubernetes/charts](https://github.com/kubernetes/charts)\u306estable\u306e\u8aac\u660e\u306b\u3088\u308b\u3068\u4e0b\u8a18\u306e\u30dd\u30ea\u30b7\u30fc\u3067\u904b\u7528\u3055\u308c\u3066\u3044\u307e\u3059\u3002\n\n- \u30c7\u30fc\u30bf\u6c38\u7d9a\u5316\u306e\u65b9\u6cd5\u304c\u63d0\u4f9b\u3055\u308c\u308b\n- \u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u30a2\u30c3\u30d7\u30b0\u30ec\u30fc\u30c9\u304c\u30b5\u30dd\u30fc\u30c8\u3055\u308c\u308b\n- \u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u8a2d\u5b9a\u306e\u30ab\u30b9\u30bf\u30de\u30a4\u30ba\u3092\u8a31\u53ef\u3059\u308b\n- \u30bb\u30ad\u30e5\u30a2\u306a\u30c7\u30d5\u30a9\u30eb\u30c8\u8a2d\u5b9a\u3092\u6301\u3064\n- Kubernetes\u306e\u30a2\u30eb\u30d5\u30a1\u6a5f\u80fd\u3092\u5229\u7528\u3057\u306a\u3044\n\n\u516c\u5f0f\u30ec\u30dd\u30b8\u30c8\u30ea\u4ee5\u5916\u306b\u4efb\u610f\u306e\u30ec\u30dd\u30b8\u30c8\u30ea\u3092\u4f7f\u7528\u3059\u308b\u3053\u3068\u3082\u53ef\u80fd\u3067\u3059\u3002\u306a\u304a\u3001\u73fe\u5728\u306f\u4e0b\u8a18\u306e\u30d1\u30c3\u30b1\u30fc\u30b8\u304c\u63d0\u4f9b\u3055\u308c\u3066\u3044\u307e\u3059\u3002\n\n### Stable\n\n- [drupal](https://github.com/kubernetes/charts/tree/master/stable/drupal)\n- [jenkins](https://github.com/kubernetes/charts/tree/master/stable/jenkins)\n- [mariadb](https://github.com/kubernetes/charts/tree/master/stable/mariadb)\n- [mysql](https://github.com/kubernetes/charts/tree/master/stable/mysql)\n- [redmine](https://github.com/kubernetes/charts/tree/master/stable/redmine)\n- [wordpress](https://github.com/kubernetes/charts/tree/master/stable/wordpress)\n\n### Incubator\n\n- [consul](https://github.com/kubernetes/charts/tree/master/incubator/consul)\n- [elasticsearch](https://github.com/kubernetes/charts/tree/master/incubator/elasticsearch)\n- [etcd](https://github.com/kubernetes/charts/tree/master/incubator/etcd)\n- [grafana](https://github.com/kubernetes/charts/tree/master/incubator/grafana)\n- [mongodb](https://github.com/kubernetes/charts/tree/master/incubator/mongodb)\n- [patroni](https://github.com/kubernetes/charts/tree/master/incubator/patroni)\n- [prometheus](https://github.com/kubernetes/charts/tree/master/incubator/prometheus)\n- [spark](https://github.com/kubernetes/charts/tree/master/incubator/spark)\n- [zookeeper](https://github.com/kubernetes/charts/tree/master/incubator/zookeeper)\n\n## \u65e7Helm\u3001DeploymentManager\u3068\u306e\u95a2\u4fc2\n\nKubernetes Helm\u306f[Helm Classic](https://github.com/helm/helm-classic)(\u65e7Helm)\u3068\u3044\u3046\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3068\u3001Kubernetes\u30c1\u30fc\u30e0\u304c\u958b\u767a\u3059\u308bdeployment-manager(dm)\u3068\u3044\u30462\u3064\u306e\u30c4\u30fc\u30eb\u304c\u7d71\u5408\u3055\u308c\u305f\u3082\u306e\u3067\u3059\u3002[Integrate helm and dm #171](https://github.com/kubernetes/helm/issues/171)\u306b\u3088\u308b\u3068\u3001\u30cf\u30c3\u30ab\u30bd\u30f3\u3067\u3053\u306e2\u3064\u3092\u7d71\u5408\u3059\u308b\u3068\u6c7a\u3081\u305f\u3089\u3057\u304f\u3001\u30ec\u30dd\u30b8\u30c8\u30ea\u540d\u3082\"deployment-manager\"\u304b\u3089\"helm\"\u306b\u5909\u66f4\u3055\u308c\u307e\u3057\u305f\u3002\u73fe\u5728\u306eKubernetes Helm\u3082\u4e3b\u306bDeis(Engine Yard)\u306e\u30a8\u30f3\u30b8\u30cb\u30a2\u304c\u958b\u767a\u3057\u3066\u3044\u307e\u3059\u3002\u53c2\u8003: [Kubernetes Helm\u306eContributors](https://github.com/kubernetes/helm/graphs/contributors)\n\n# Helm\u3092\u8a66\u3057\u3066\u307f\u308b\n\n## Helm\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\nHelm\u306e\u30af\u30e9\u30a4\u30a2\u30f3\u30c8(`helm`\u30b3\u30de\u30f3\u30c9)\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3092\u884c\u3044\u307e\u3059\u3002Homebrew Cask\u306eformula\u304c\u7528\u610f\u3055\u308c\u3066\u307e\u3059\u304c\u3001\u6700\u65b0\u306e\u30d0\u30fc\u30b8\u30e7\u30f3(`v2.0.0-alpha.5`)\u3092\u4f7f\u3044\u305f\u304b\u3063\u305f\u306e\u3067\u3001[releases](https://github.com/kubernetes/helm/releases/tag/v2.0.0-alpha.5)\u304b\u3089\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3057PATH\u306e\u901a\u3063\u305f\u5834\u6240\u306b`helm`\u30d0\u30a4\u30ca\u30ea\u3092\u914d\u7f6e\u3057\u307e\u3057\u305f\u3002\n\n```bash\n$ export HELM_OS=darwin && wget https://storage.googleapis.com/kubernetes-helm/helm-v2.0.0-alpha.5-$HELM_OS-amd64.tar.gz && tar -zxvf helm-v2.0.0-alpha.5-$HELM_OS-amd64.tar.gz && cd $HELM_OS-amd64\n```\n\n\u4e0b\u8a18\u306e\u30b3\u30de\u30f3\u30c9\u3067\u30af\u30e9\u30b9\u30bf\u306e\u521d\u671f\u5316\u3092\u884c\u3044\u307e\u3059\u3002\u521d\u671f\u5316\u3067\u306fkubernetes\u30af\u30e9\u30b9\u30bf\u306b\u30b5\u30fc\u30d0\u30fc\u30b3\u30f3\u30dd\u30fc\u30cd\u30f3\u30c8(`tiller`)\u306e\u30c7\u30d7\u30ed\u30a4\u3092\u884c\u3046\u305f\u3081\u3001kubectl\u306e\u63a5\u7d9a\u5148\u8a2d\u5b9a\u3082\u3055\u308c\u3066\u3044\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\n\n```bash\n$ helm init\n\nCreating /Users/tkusumi/.helm\nCreating /Users/tkusumi/.helm/repository\nCreating /Users/tkusumi/.helm/repository/cache\nCreating /Users/tkusumi/.helm/repository/local\nCreating /Users/tkusumi/.helm/repository/repositories.yaml\nCreating /Users/tkusumi/.helm/repository/local/index.yaml\n$HELM_HOME has been configured at $HOME/.helm.\n\nTiller (the helm server side component) has been installed into your Kubernetes Cluster.\nHappy Helming!\n```\n\n\u4e0b\u8a18\u306e\u3088\u3046\u306b\u30b5\u30fc\u30d0\u30fc\u30b3\u30f3\u30dd\u30fc\u30cd\u30f3\u30c8\u306e*tiller*\u304ckubernetes\u30af\u30e9\u30b9\u30bf\u306e`kube-system`\u30cd\u30fc\u30e0\u30b9\u30da\u30fc\u30b9\u306b\u30c7\u30d7\u30ed\u30a4\u3055\u308c\u307e\u3059\u3002\n\n```bash\n$ kubectl get pods --all-namespaces | grep tiller\nkube-system   tiller-deploy-637859184-v6za1                         1/1       Running   0          1m\n```\n\n`helm version`\u3067\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u3001\u30b5\u30fc\u30d0\u30fc\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u3092\u78ba\u8a8d\u3067\u304d\u307e\u3059\u3002\n\n```bash\n$ helm version\nClient: &version.Version{SemVer:\"v2.0.0-alpha.5\", GitCommit:\"36ec1901ebd68ae976fa8ef332ca5ed44598fc24\", GitTreeState:\"clean\"}\nServer: &version.Version{SemVer:\"v2.0.0-alpha.5\", GitCommit:\"4de5c4aa578ed9ca173aff472f00d2167ec59a88\", GitTreeState:\"dirty\"}\n```\n\n\u53c2\u8003\n\n- https://github.com/kubernetes/helm/blob/master/docs/install.md\n\n## Helm\u3067\u30d1\u30c3\u30b1\u30fc\u30b8\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\n\n`helm search`\u3067stable\u30d1\u30c3\u30b1\u30fc\u30b8\u306e\u4e00\u89a7\u304c\u53d6\u5f97\u3067\u304d\u307e\u3059\u3002(`2.0.0-Alpha.5`\u304b\u3089\u306e\u6a5f\u80fd)\n\n```\n$ helm search\nNAME                    VERSION DESCRIPTION\nstable/drupal           0.3.2   One of the most versatile open source content m...\nstable/jenkins          0.1.0   A Jenkins Helm chart for Kubernetes.\nstable/mariadb          0.5.0   Chart for MariaDB\nstable/mysql            0.1.0   Chart for MySQL\nstable/redmine          0.3.1   A flexible project management web application.\nstable/wordpress        0.3.0   Web publishing platform for building blogs and ...\n```\n\n`helm install PACKAGE_NAME`\u3067\u30d1\u30c3\u30b1\u30fc\u30b8\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3092\u884c\u3044\u307e\u3059\u3002\u3053\u3053\u3067\u306fJenkins\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u3066\u307f\u307e\u3059\u3002\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u6642\u306b\u30d1\u30c3\u30b1\u30fc\u30b8\u3054\u3068\u306e\u8a2d\u5b9a\u3092\u6307\u5b9a\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\u6307\u5b9a\u53ef\u80fd\u306a\u5024\u306f\u5404\u30d1\u30c3\u30b1\u30fc\u30b8\u306eREADME\u306b\u304b\u304b\u308c\u3066\u3044\u307e\u3059\u3002\u53c2\u8003: [Jenkins\u306eREADME](https://github.com/kubernetes/charts/blob/master/stable/jenkins/README.md)\n\n```bash\n$ helm install stable/jenkins\nFetched stable/jenkins to jenkins-0.1.0.tgz\nviable-robin\nLast Deployed: Tue Oct 11 13:57:50 2016\nNamespace: default\nStatus: DEPLOYED\n\n~\u7701\u7565~\n\nNotes:\nGetting Started:\n\n1. Get your 'admin' user password by running:\n  printf $(printf '\\%o' `kubectl get secret --namespace default viable-robin-jenkins -o jsonpath=\"{.data.jenkins-admin-password[*]}\"`);echo\n\n2. Get the Jenkins URL to visit by running these commands in the same shell:\n**** NOTE: It may take a few minutes for the LoadBalancer IP to be available.                      ****\n****       You can watch the status of by running 'kubectl get svc -w viable-robin-jenkins' ****\n  export SERVICE_IP=$(kubectl get svc --namespace default viable-robin-jenkins -o jsonpath='{.status.loadBalancer.ingress[0].ip}')\n  echo http://$SERVICE_IP:8080/login\n\n3. Login with the password from step 1 and the username: admin\n\nFor more information on running Jenkins on Kubernetes, visit:\nhttps://cloud.google.com/solutions/jenkins-on-container-engine\n```\n\nJenkins\u306b\u30a2\u30af\u30bb\u30b9\u3059\u308b\u624b\u9806\u304c\u8868\u793a\u3055\u308c\u308b\u306e\u3067\u624b\u9806\u306e\u901a\u308a\u30a2\u30af\u30bb\u30b9\u3057\u3001\u6b63\u3057\u304fJenkins\u304c\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u305f\u3053\u3068\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\n\n![image](https://qiita-image-store.s3.amazonaws.com/0/100377/131c2244-dc2f-7d88-0069-01a38605caa4.png)\n\n\n\u4e0b\u8a18\u306e\u3088\u3046\u306bJenkins\u306ePod\u304c\u914d\u7f6e\u3055\u308c\u307e\u3057\u305f\u3002\n\n```bash\n$ kubectl get pods\nNAME                                    READY     STATUS    RESTARTS   AGE\nviable-robin-jenkins-4218656479-dvu4v   1/1       Running   0          4m\n```\n\n`helm list`\u30b3\u30de\u30f3\u30c9\u3067\u30c7\u30d7\u30ed\u30a4\u3055\u308c\u305f\u4e00\u89a7\u3092\u78ba\u8a8d\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n```bash\n$ helm list\nNAME            REVISION        UPDATED                         STATUS          CHART\nviable-robin    1               Tue Oct 11 13:57:50 2016        DEPLOYED        jenkins-0.1.0\n```\n\n# \u30d1\u30c3\u30b1\u30fc\u30b8(Charts)\u3092\u8a66\u3057\u306b\u4f5c\u3063\u3066\u307f\u308b\n\nhttps://github.com/kubernetes/helm/blob/master/docs/charts.md\n\n\u3053\u3053\u3067\u306f\u30b5\u30f3\u30d7\u30eb\u306b\u4efb\u610f\u306e\u6587\u5b57\u5217\u3092\u8a2d\u5b9a\u3067\u304d\u308bnginx\u306e\u30d1\u30c3\u30b1\u30fc\u30b8(Charts)\u3092\u4f5c\u308a\u307e\u3059\u3002\n\n`helm create`\u3068\u3044\u3046\u30b3\u30de\u30f3\u30c9\u3067\u96db\u5f62\u3092\u751f\u6210\u3057\u307e\u3059\u3002\n\n```\n$ helm create helloworld\nCreating helloworld\n```\n\n\u4e0b\u8a18\u306e\u69cb\u6210\u3067\u30d5\u30a1\u30a4\u30eb\u304c\u4f5c\u3089\u308c\u307e\u3059\u3002\n\n```\nhelloworld/\n  Chart.yaml    # chart\u306e\u60c5\u5831\u3092\u8a18\u8f09\u3059\u308byaml\n  values.yaml   # chart\u306e\u30c7\u30d5\u30a9\u30eb\u30c8\u8a2d\u5b9a\n  charts/       # chart\u306e\u4f9d\u5b58\u3092\u542b\u3081\u308b\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\n  templates/    # \u30de\u30cb\u30d5\u30a7\u30b9\u30c8\u30d5\u30a1\u30a4\u30eb\u306e\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u3092\u914d\u7f6e\u3059\u308b\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\n```\n\n`templates/`\u4ee5\u4e0b\u306bkubernetes\u306e\u30de\u30cb\u30d5\u30a7\u30b9\u30c8\u30d5\u30a1\u30a4\u30eb\u306e\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u3092\u914d\u7f6e\u3057\u307e\u3059\u3002\u3053\u3053\u3067\u306f\u4e0b\u8a18\u306e\u30de\u30cb\u30d5\u30a7\u30b9\u30c8\u306e\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u3092\u914d\u7f6e\u3057\u307e\u3057\u305f\u3002\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u306fGo\u306e[text/template](https://golang.org/pkg/text/template/)\u5f62\u5f0f\u3067\u8a18\u8ff0\u3057\u307e\u3059\u3002`.Values`\u3068\u3044\u3046\u306e\u304c\u4efb\u610f\u306b\u8a2d\u5b9a\u3059\u308b\u60c5\u5831\u3067\u3059\u3002\n\n```yaml:hello-deployment.yaml\napiVersion: extensions/v1beta1\nkind: Deployment\nmetadata:\n  # \u672c\u6765\u306f{{.Release.Name}}\u306a\u3069\u3092\u4f7f\u3063\u3066\u30e6\u30cb\u30fc\u30af\u306b\u3059\u308b\u5fc5\u8981\u304c\u3042\u308b\n  name: \"hello-nginx\"\n  labels:\nspec:\n  # \u4efb\u610f\u306e\u30ec\u30d7\u30ea\u30ab\u6570\u3092\u8a2d\u5b9a\u3067\u304d\u308b\n  replicas: {{.Values.replicaCount}}\n  template:\n    metadata:\n      labels:\n        app: \"hello-nginx\"\n    spec:\n      containers:\n      - image: nginx:1.11.4\n        name: nginx\n        ports:\n        - containerPort: 80\n        command:\n        - /bin/bash\n        - -c\n        # \u4efb\u610f\u306e\u5024\u3092index.html\u3067\u8868\u793a\n        - 'echo \"<h1>{{.Values.message}}</h1>\" > /usr/share/nginx/html/index.html; /usr/sbin/nginx -g \"daemon off;\"'\n```\n\n```hello-svc.yaml\napiVersion: v1\nkind: Service\nmetadata:\n  name: hello-nginx\n  labels:\nspec:\n  ports:\n    - port: 80\n      name: http\n      targetPort: 80\n  selector:\n    app: \"hello-nginx\"\n  type: LoadBalancer\n```\n\n`values.yaml`\u306b\u521d\u671f\u5024\u3092\u8a18\u8f09\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n\n```yaml:values.yaml\nreplicaCount: 2\nmessage: hello world!\n```\n\n`helm lint`\u3068\u3044\u3046\u69cb\u6587\u30c1\u30a7\u30c3\u30af\u30c4\u30fc\u30eb\u304c\u4ed8\u5c5e\u3057\u3066\u3044\u304a\u308a\u3001\u69cb\u6587\u30a8\u30e9\u30fc\u3092\u30c1\u30a7\u30c3\u30af\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n```bash\n$ helm lint helloworld\n==> Linting helloworld\n[ERROR] templates/: render error in \"helloworld/templates/hello-deployment.yaml\": template: helloworld/templates/hello-deployment.yaml:14:24: executing \"helloworld/templates/hello-deployment.yaml\" at <{{template \"fullname...>: template \"fullname\" not defined\n\nError: 1 chart(s) linted, 1 chart(s) failed\n```\n\n\u69cb\u6587\u306b\u554f\u984c\u304c\u306a\u3051\u308c\u3070\u30d1\u30c3\u30b1\u30fc\u30b8(`tgz`\u30d5\u30a1\u30a4\u30eb)\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\n```bash\n$ helm package helloworld\n```\n\n\u30d1\u30c3\u30b1\u30fc\u30b8\u3055\u308c\u305f`helloworld-0.1.0.tgz`\u304c\u4f5c\u6210\u3055\u308c\u307e\u3057\u305f\u3002\u4e0b\u8a18\u306e\u7528\u306b\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u304c\u3067\u304d\u307e\u3059\u3002\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u306e\u5909\u6570\u306f`--set`\u30d5\u30e9\u30b0\u3067\u30ab\u30f3\u30de\u533a\u5207\u308a\u306ekey=value\u5f62\u5f0f\u3001\u307e\u305f\u306f`--values`\u30d5\u30e9\u30b0\u3067yaml\u5f62\u5f0f\u3067\u6307\u5b9a\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n```bash\n$ helm install --set 'message=It works!,replicaCount=3' helloworld-0.1.0.tgz\nright-quail\nLast Deployed: Tue Oct 11 16:19:10 2016\nNamespace: default\nStatus: DEPLOYED\n\nResources:\n==> extensions/Deployment\nNAME          DESIRED   CURRENT   UP-TO-DATE   AVAILABLE   AGE\nhello-nginx   3         3         3            0           0s\n\n==> v1/Service\nNAME          CLUSTER-IP     EXTERNAL-IP   PORT(S)   AGE\nhello-nginx   10.187.251.4   <pending>     80/TCP    0s\n```\n\n\u30ed\u30fc\u30c9\u30d0\u30e9\u30f3\u30b5\u306eEXTERNAL-IP\u3092\u78ba\u8a8d\u3057\u3066\u30d6\u30e9\u30a6\u30b6\u3067\u30a2\u30af\u30bb\u30b9\u3057\u307e\u3059\u3002\n\n```\n$ kubectl get svc hello-nginx\nNAME          CLUSTER-IP     EXTERNAL-IP       PORT(S)   AGE\nhello-nginx   10.187.251.4   104.155.129.166   80/TCP    53s\n```\n\n![image](https://qiita-image-store.s3.amazonaws.com/0/100377/1730135a-f7ef-0c44-1418-747f86fad638.png)\n\n[\u65e2\u5b58\u306eChart](https://github.com/kubernetes/charts)\u3092\u898b\u308b\u3068\u3001\u4ed6\u306b\u3082\u30e9\u30d9\u30eb\u306a\u3069\u306e\u8a2d\u5b9a\u304c\u3044\u308d\u3044\u308d\u3068\u3042\u308b\u306e\u3067\u3001\u5b9f\u969b\u306b\u4f5c\u308b\u969b\u306f\u65e2\u5b58\u306e\u3082\u306e\u3092\u53c2\u8003\u306b\u3059\u308b\u3068\u3088\u3044\u3068\u601d\u3044\u307e\u3059\u3002\u4f8b\u3048\u3070`Release.Name`(\u6307\u5b9a\u3057\u306a\u3044\u3068\u30e9\u30f3\u30c0\u30e0\u3067\u4ed8\u3051\u3089\u308c\u308b)\u306e\u3088\u3046\u306a[\u4e8b\u524d\u306b\u5b9a\u7fa9\u3055\u308c\u305f\u5909\u6570](https://github.com/kubernetes/helm/blob/master/docs/charts.md#predefined-values)\u304c\u3042\u308a\u3001\u3053\u308c\u3089\u3092\u4f7f\u3063\u3066\u30e6\u30cb\u30fc\u30af\u306a`name`\u3092\u8a2d\u5b9a\u3057\u305f\u308a\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\n\n## \u305d\u306e\u4ed6\u306bChart\u3067\u3067\u304d\u308b\u3053\u3068\n\n[Charts\u306e\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8](https://github.com/kubernetes/helm/blob/master/docs/charts.md)\u306b\u3088\u308b\u3068\u4ed6\u306bCharts\u3067\u4e0b\u8a18\u306e\u3053\u3068\u304c\u3067\u304d\u308b\u3088\u3046\u3067\u3059\u3002\n\n### \u4f9d\u5b58\u95a2\u4fc2\n\nChart\u306e\u4f9d\u5b58\u95a2\u4fc2\u3092`charts/`\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3078\u306e\u30b3\u30d4\u30fc\u307e\u305f\u306f`requirements.yaml`\u306b\u3088\u308b\u5b9a\u7fa9\u3067\u8868\u73fe\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\u3053\u308c\u306b\u3088\u308a\u81ea\u52d5\u7684\u306bChart\u306e\u4f9d\u5b58\u95a2\u4fc2\u3092\u89e3\u6c7a\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n```yaml:requirements.yaml\ndependencies:\n  - name: apache\n    version: 1.2.3\n    repository: http://example.com/charts\n  - name: mysql\n    version: 3.2.1\n    repository: http://another.example.com/charts\n```\n\n### \u30d5\u30c3\u30af\n\n\u30d1\u30c3\u30b1\u30fc\u30b8\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3001\u524a\u9664\u3001\u30a2\u30c3\u30d7\u30b0\u30ec\u30fc\u30c9\u6642\u306b\u30d5\u30c3\u30af\u3059\u308b\u6a5f\u80fd\u304c\u63d0\u4f9b\u3055\u308c\u3066\u3044\u307e\u3059\u3002\u4f8b\u3048\u3070\u30b7\u30fc\u30af\u30ec\u30c3\u30c8\u3092\u52d5\u7684\u306b\u4f5c\u308b\u3053\u3068\u3084\u3001\u30a2\u30c3\u30d7\u30b0\u30ec\u30fc\u30c9\u524d\u306bDB\u306e\u30d0\u30c3\u30af\u30a2\u30c3\u30d7\u3092\u53d6\u308b\u306a\u3069\u306e\u7528\u9014\u306b\u5229\u7528\u3067\u304d\u307e\u3059\u3002\u4e0b\u8a18\u306e\u30d5\u30c3\u30af\u30dd\u30a4\u30f3\u30c8\u304c\u7528\u610f\u3055\u308c\u3066\u3044\u307e\u3059\u3002\n\n- pre-install\n- post-install\n- pre-delete\n- post-delete\n- pre-upgrade\n- post-upgrade\n\n\u30d5\u30c3\u30af\u306e\u51e6\u7406\u306fKubernetes\u306eBatch Job\u3068\u3057\u3066\u5b9a\u7fa9\u3057\u3001\u4e0b\u8a18\u306e\u3088\u3046\u306b\u30a2\u30ce\u30c6\u30fc\u30b7\u30e7\u30f3\u3067\u30d5\u30c3\u30af\u30dd\u30a4\u30f3\u30c8\u3092\u6307\u5b9a\u3067\u304d\u307e\u3059\u3002\u30ab\u30f3\u30de\u533a\u5207\u308a\u3067\u8907\u6570\u3057\u3066\u3044\u3059\u308b\u3053\u3068\u3082\u3067\u304d\u307e\u3059\u3002\n\n\n```yaml\n  annotations:\n    \"helm.sh/hook\": post-install\n```\n\n\n# \u53c2\u8003\n- https://github.com/kubernetes/helm\n- https://github.com/kubernetes/charts\n- http://blog.kubernetes.io/2016/10/helm-charts-making-it-simple-to-package-and-deploy-apps-on-kubernetes.html\n"}