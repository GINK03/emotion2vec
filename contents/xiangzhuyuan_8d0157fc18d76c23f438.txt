{"context": "\n\n\u76ee\u5f55\n\u63a5\u4e0b\u6765\u8981\u8bbe\u8ba1\u5230\u4ee5\u4e0b\u7684\u5185\u5bb9\n\nActions & action creator\nReducers\nStore\nData Flow\nUsage with React\nExample: Todo List\n\n\n\u52a8\u4f5c\u53ca\u52a8\u4f5c\u521b\u5efa\u8005\n\u6240\u8c13\u52a8\u4f5c\u5c31\u662f\u666e\u901a javascript \u7684\u5bf9\u8c61, \u5b83\u7528\u6765\u63cf\u8ff0\u52a8\u4f5c\u7684\u5185\u5bb9, \n\u4ed6\u4eec\u4ece app \u53d1\u9001\u5230 store. \u4ed6\u4eec\u5c31\u662f store \u91cc\u7684\u6570\u636e\u7684\u6e90\u5934. \u901a\u8fc7store.dispatch() \u6765\u53d1\u9001\u6570\u636e.\n{\n  type: 'ADD_TODO',\n  text: 'Build my first Redux app'\n\n}\n\n\n\u901a\u5e38\u6211\u4eec\u628a\u52a8\u4f5c\u7684\u7c7b\u578b\u5b9a\u4e49\u4e3a\u4e00\u4e2a\u5e38\u91cf\n\nconst ADD_TODO = 'ADD_TODO'\n\n\u5176\u5b9e\u6240\u8c13 \u52a8\u4f5c \u5c31\u662f\u4e00\u4e2a\u666e\u901a\u7684 javascript \u5bf9\u8c61, \u5b83\u5fc5\u987b\u6709\u4e00\u4e2atype \u5c5e\u6027, \u7528\u6765\u8868\u660e\u5b83\u80fd\u505a\u4ec0\u4e48\u6837\u7684\u52a8\u4f5c.\u800c\u8fd9\u4e2a type \u5fc5\u987b\u662f\u4e00\u4e2a\u58f0\u660e\u4e3a\u5e38\u91cf\u7684\u5b57\u7b26\u4e32\u5bf9\u8c61. \u800c\u4e14\u4e00\u822capp \u7684 action \u90fd\u4f1a\u5f88\u591a,\u6240\u4ee5\u53ef\u4ee5\u5355\u72ec\u628a\u4ed6\u4eec\u653e\u5728\u4e00\u4e2a\u6587\u4ef6. \u7136\u540e\u53ef\u4ee5\u8fd9\u6837\u5f15\u7528:\nimport { ADD_TODO, REMOVE_TODO } from '../actionTypes'\n\n\u63a5\u4e0b\u6765,\u6211\u4eec\u5c06\u8981\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u52a8\u4f5c,\u7528\u6765\u63cf\u8ff0\u7528\u6237\u52fe\u9009\u67d0\u4e2a todo \u4e3a\u5b8c\u6210\u7684\u52a8\u4f5c. \u6211\u4eec\u4f1a\u901a\u8fc7index \u6765\u6807\u8bb0\u6bcf\u4e00\u4e2atodo .\u56e0\u4e3a\u6211\u4eec\u628a\u4ed6\u4eec\u653e\u5728array \u91cc,\u8fd9\u91cc\u53ea\u662f demo, \u800c\u771f\u5b9e\u7684 app \u6700\u597d\u6709\u4e13\u95e8\u7684\u903b\u8f91\u7528\u6765\u751f\u6210\u627e\u4e2a id.\n{\n  type: TOGGLE_TODO,\n  index: 5\n}\n\n\u5728\u8fd9,\u5176\u5b9e\u6bcf\u4e00\u4e2a\u52a8\u4f5c\u5c3d\u53ef\u80fd\u8ba9\u5b83\u643a\u5e26\u6700\u7b80\u5316\u7684\u6570\u636e\u96c6. \u4f8b\u5982, \u6211\u4eec\u901a\u8fc7index \u5c31\u53ef\u4ee5\u4ee3\u8868\u8fd9\u4e2a todo\u5bf9\u8c61.\n{\n  type: SET_VISIBILITY_FILTER,\n  filter: SHOW_COMPLETED\n}\n\n\u52a8\u4f5c\u6211\u4eec\u5148\u8bf4\u5230\u8fd9\u513f,\u63a5\u4e0b\u6765\u8bf4\u8bf4\u52a8\u4f5c\u521b\u5efa\u8005. \u5728 Redux \u4e2d, \u52a8\u4f5c\u7684\u521b\u5efa\u8005 \u5c31\u662f\u4e00\u4e2a\u5730\u9053\u7684\u51fd\u6570, \u7528\u6765\u521b\u5efa\u5e76\u8fd4\u56de\u4e00\u4e2a\u52a8\u4f5c. \u53ef\u80fd\u5f88\u5bb9\u6613\u5728\u8fd9\u91cc\u6df7\u6dc6\u52a8\u4f5c\u548c\u52a8\u4f5c\u521b\u5efa\u8005.\n\u52a8\u4f5c\u521b\u5efa\u8005\u7684\u4f5c\u7528\u5c31\u662f\u8fd4\u56de\u4e00\u4e2a\u52a8\u4f5c:\nfunction addTodo(text){\n  return {\n    type: ADD_TODO,\n    text\n  }\n}\n\n\n\n\u5728\u4f20\u7edf\u7684 Flux \u67b6\u6784\u4e2d, \u4e00\u4e2a\u52a8\u4f5c\u8005\u901a\u5e38\u5728\u5b9a\u4e49\u4e00\u4e2a action, \u4e4b\u540e\u8fd8\u6709\u5206\u53d1\u5230\u5df2\u7ecf\u6ce8\u518c\u7684\u67d0\u4e2a store \u91cc?\n\nfunction addTodoWithDispatch(text) {\n  const action = {\n    type: ADD_TODO,\n    text\n  }\n  dispatch(action)\n}\n\n\n\n\u800c\u5728 Redux \u4e2d\u4e0d\u8fd9\u4e48\u5904\u7406. \u53d6\u800c\u4ee3\u4e4b\u7684\u662f\u53bb\u8c03\u7528Store \u7684dispatch()\u51fd\u6570. \u628a\u4e00\u4e2a\u52a8\u4f5c\u4f5c\u4e3a\u53c2\u6570\u4f20\u9012\u7ed9\u5b83.\nStore.dispatch(addTodo(text))\nStore.dispatch(completeTodo(index))\n\n\u6216\u8005,\u53ef\u4ee5\u521b\u5efa\u4e00\u4e2a\u7ed1\u5b9a\u52a8\u4f5c\u521b\u5efa\u8005( bound action creator) \u6765\u81ea\u52a8\u5b9e\u73b0\u52a8\u4f5c\u7684\u5206\u53d1:\nconst boundAddTodo = (text) => dispatch(addTodo(text))\nconst boundCompleteTodo = (index) => dispatch(completeTodo(index))\n\n\n\u73b0\u5728\u53ef\u4ee5\u8fd9\u6837\u4f7f\u7528\u4ed6\u4eec:\nboundAddTodo(text)\nboundCompleteTodo(index)\n\n\u8fd9\u4e2a\u5206\u53d1dispatch() \u51fd\u6570\u53ef\u4ee5\u76f4\u63a5\u901a\u8fc7store.dispatch()\u5728store \u91cc\u8bbf\u95ee\u5230, \u6216\u8005\u76f4\u63a5\u901a\u8fc7react-redux \u7684\u5e2e\u52a9\u7c7b\u65b9\u6cd5 connect(), \u4f7f\u7528bindActionCreators()\u6765\u81ea\u52a8\u5c06\u8fd9\u4e9b\u52a8\u4f5c\u521b\u5efa\u8005\u7ed1\u5b9a\u5230\u5bf9\u5e94\u7684dispatch() \u51fd\u6570\u4e0a.\n\u52a8\u4f5c\u521b\u5efa\u8005\u8fd8\u53ef\u4ee5\u662f\u5f02\u6b65\u7684,\u4f46\u5177\u6709\u526f\u4f5c\u7528.\n\nYou can read about async actions in the advanced tutorial to learn how to handle AJAX responses and compose action creators into async control flow. \n\n\u8bf4\u4e86\u8fd9\u4e48\u591a, \u6765\u770b\u770b\u5168\u90e8\u7684\u6e90\u7801.\n/*\n * action types\n */\n\nexport const ADD_TODO = 'ADD_TODO'\nexport const TOGGLE_TODO = 'TOGGLE_TODO'\nexport const SET_VISIBILITY_FILTER = 'SET_VISIBILITY_FILTER'\n\n/*\n * other constants\n */\n\nexport const VisibilityFilters = {\n  SHOW_ALL: 'SHOW_ALL',\n  SHOW_COMPLETED: 'SHOW_COMPLETED',\n  SHOW_ACTIVE: 'SHOW_ACTIVE'\n}\n\n/*\n * action creators\n */\n\nexport function addTodo(text) {\n  return { type: ADD_TODO, text }\n}\n\nexport function toggleTodo(index) {\n  return { type: TOGGLE_TODO, index }\n}\n\nexport function setVisibilityFilter(filter) {\n  return { type: SET_VISIBILITY_FILTER, filter }\n}\n\n\u63a5\u7740\u8bf4, \u521a\u624d\u6211\u4eec\u8bf4\u5230\u4e86\u521b\u5efa\u52a8\u4f5c\u548c\u52a8\u4f5c\u521b\u5efa\u8005\u4ee5\u53ca\u5982\u4f55\u7ed1\u5b9a\u548c\u5206\u53d1\u52a8\u4f5c.\n\u63a5\u4e0b\u6765\u6211\u4eec\u770b\u770breducer.\n\nReducer\n\u73b0\u5728\u6211\u4eec\u8003\u8651\u7684\u95ee\u9898\u5c31\u662f, \u52a8\u4f5c\u5206\u53d1\u4e86\u4e4b\u540e\u5462, \u5230\u54ea\u513f\u53bb,\u5e72\u4e86\u4ec0\u4e48!?\n\u5173\u4e8e\u52a8\u4f5c, \u5b83\u662f\u5b9e\u5b9e\u5728\u5728\u5b9a\u4e49\u4e86\u5e72\u4ec0\u4e48. \u4f46\u662f\u5b83\u5e72\u4ec0\u4e48\u600e\u4e48\u624d\u80fd\u591f\u5f71\u54cd\u5230 app \u7684\u72b6\u6001\u5462, \u8ba9 app \u505a\u51fa\u5bf9\u5e94\u7684\u54cd\u5e94\u5462, \u8fd9\u5c31\u662freducer \u7684\u8981\u505a\u7684.\n\n\u8bbe\u8ba1\u72b6\u6001\u7ed3\u6784\n\u5148\u6765\u8bf4\u8bf4state,\u5728 redux \u91cc\u6240\u6709\u7684\u72b6\u6001\u90fd\u662f\u4fdd\u6301\u5728\u4e00\u4e2a\u5355\u4e2a\u7684\u5bf9\u8c61\u91cc,\u73b0\u5728\u6211\u4eec\u6765\u60f3\u60f3\u4e00\u4e0b\u5979\u7684\u6837\u5b50.\n\u62fftodo app\u6765\u8bf4,\u6211\u4eec\u8981\u5b58\u50a82\u6837\u4e1c\u897f:\n\ntodo \u7684 list\n\n\n\u8fd9\u4e2a\u662f\u6700\u4e3b\u8981\u7684,\u65f6\u523b\u90fd\u80fd\u591f\u53d6\u5230\u5b8c\u6574\u7684 todo \u6570\u636e.\n\n\n\u5f53\u524d\u88ab\u9009\u4e2d\u7684\u663e\u793a\u8fc7\u6ee4\u5668(\u8981\u663e\u793a\u4ec0\u4e48\u72b6\u6001\u7684 todo)\n\n\n\u8fd9\u91cc\u6211\u4eec\u53ea\u9700\u8981\u4fdd\u5b58\u5f53\u524d\u7528\u6237\u9009\u4e2d\u9700\u8981\u663e\u5f0f\u90a3\u4e2a\u7c7b\u578b\u7684 todo \u5c31\u597d,(\u5982\u5f53\u524d\u8fdb\u884c\u7684\u6216\u8005\u5df2\u7ecf\u5b8c\u6210\u7684.)\n\n\n\n\u53ef\u80fd\u5bf9\u4e8e\u4e00\u4e2a app \u6765\u8bf4,\u6211\u4eec\u901a\u5e38\u4e0b\u610f\u8bc6\u4f1a\u8ba4\u4e3a\u6709\u5f88\u591a\u4e8b\u60c5,\u6570\u636e\u9700\u8981\u5904\u7406. \u6709\u5f88\u591a\u7684 case. \u4f46\u662f\u5bf9\u4e8e\u8fd9\u91cc\u6240\u8bb2\u7684\u72b6\u6001\u6765\u8bf4, \u6211\u4eec\u9700\u8981\u62bd\u8c61,\u53d6\u51fa\u6700\u4e3b\u8981\u7684\u4e1c\u897f. \n\u6bd4\u5982\u8bf4, \u6211\u4eec\u53ea\u9700\u8981 care \u8fd9\u4e9b\u6570\u636e\u5c31\u53ef\u4ee5, \u5229\u7528\u8fd9\u4e9b\u6570\u636e\u6211\u4eec\u5c31\u80fd\u591f\u6b63\u5e38\u8fd0\u8f6c app\n{\n  visibilityFilter: 'SHOW_ALL',\n  todos: [\n    {\n      text: 'Consider using Redux',\n      completed: true,\n    },\n    {\n      text: 'Keep all state in a single tree',\n      completed: false\n    }\n  ]\n}\n\n\n\u5728\u4e00\u4e2a\u8f83\u590d\u6742\u7684 app \u4e2d,\u53ef\u80fd\u5b9e\u4f53\u4e4b\u95f4\u4f1a\u76f8\u4e92\u5f15\u7528.\u6211\u4eec\u5efa\u8bae\u5c3d\u91cf\u628a\u72b6\u6001\u4fdd\u6301\u8d8a\u7b80\u5355\u8d8a\u597d. \u4e0d\u8981\u6709\u5d4c\u5957\u7684\u5173\u7cfb\u5b58\u5728. \n\u5c3d\u91cf\u7136\u540e\u6bcf\u4e00\u4e2a\u5bf9\u8c61\u6709\u4e00\u4e2a id \u80fd\u591f\u8bc6\u522b. \u901a\u8fc7 id \u6765\u5f15\u7528.\u60f3\u8c61 app \u7684\u72b6\u6001\u5c31\u548c database \u91cc\u7684\u72b6\u6001\u7c7b\u4f3c. \u8fd9\u4e2a\u53ef\u4ee5\u67e5\u770b normalizr \u7684\u8be6\u7ec6\u6587\u6863\u6765\u770b.\n\n\n\u5904\u7406\u52a8\u4f5c\n\u4e0a\u9762\u6211\u4eec\u5927\u6982\u77e5\u9053\u4e86\u627e\u4e2a todo app \u91cc\u72b6\u6001\u5bf9\u8c61\u6837\u5b50, \u63a5\u4e0b\u6765\u6211\u4eec\u5199reducer. \n\n\u91cd\u8981\u4e8b\u60c5\u8bf4\u4e09\u904d\n\nreducer \u5c31\u662f\u4e00\u4e2a\u7eaf\u51fd\u6570,\u63a5\u53d72\u4e2a\u53c2\u6570, \u7b2c\u4e00\u4e2a\u7684\u5f53\u524d\u7684\u72b6\u6001,\u7b2c\u4e8c\u4e2a\u662f\u52a8\u4f5c, \u7136\u540e\u8fd4\u56de\u6700\u65b0\u7684\u72b6\u6001.\nreducer \u5c31\u662f\u4e00\u4e2a\u7eaf\u51fd\u6570,\u63a5\u53d72\u4e2a\u53c2\u6570, \u7b2c\u4e00\u4e2a\u7684\u5f53\u524d\u7684\u72b6\u6001,\u7b2c\u4e8c\u4e2a\u662f\u52a8\u4f5c, \u7136\u540e\u8fd4\u56de\u6700\u65b0\u7684\u72b6\u6001.\nreducer \u5c31\u662f\u4e00\u4e2a\u7eaf\u51fd\u6570,\u63a5\u53d72\u4e2a\u53c2\u6570, \u7b2c\u4e00\u4e2a\u7684\u5f53\u524d\u7684\u72b6\u6001,\u7b2c\u4e8c\u4e2a\u662f\u52a8\u4f5c, \u7136\u540e\u8fd4\u56de\u6700\u65b0\u7684\u72b6\u6001.\n(previousState, action) => newState\n\n\u8fd9\u4e2a\u6211\u5c31\u79f0\u4e4b\u4e3areducer, \u56e0\u4e3a\u5b83\u5176\u5b9e\u662f\u8fd9\u6837\u4e00\u4e2a\u5b9e\u73b0:\nArray.prototype.reduce(reducer, ?initialValue)\n\n\u5bf9\u4e8ereducer \u6765\u8bf4\u4fdd\u8bc1\u5b83\u7684\u7eaf\u6d01\u6027\u662f\u975e\u5e38\u91cd\u8981\u7684.\u5728 reducer \u91cc\u4fdd\u8bc1\u4e0d\u80fd\u591f\u53d1\u751f\u5982\u4e0b\u7684\u4e8b\u60c5:\n\n\u6539\u53d8\u53c2\u6570\n\u4e0d\u80fd\u591f\u505a\u5176\u4ed6\u4e8b\u60c5\u5982\u8c03\u7528 API \u6216\u8005\u4fee\u6539 route\n\u8c03\u7528\u4e0d pure \u7684\u51fd\u6570\u5982 Date.now() \u6216\u8005 Math.random()\n\n\n\u8fd9\u91cc\u5148\u4e0d\u8ba8\u8bba\u526f\u4f5c\u7528\u7684\u4e1c\u897f\u4e4b\u540e\u9ad8\u9636\u65f6\u5019\u4f1a\u8bf4. \u73b0\u5728\u6211\u4eec\u53ea\u8bb0\u4f4f\u5bf9\u4e8e reducer \u7684 function \u5fc5\u987b\u662f pure \u7684. \u7ed9\u4e00\u6837\u7684\u53c2\u6570,\u603b\u662f\u8fd4\u56de\u540c\u6837\u7684\u7ed3\u679c,\u6ca1\u6709\u526f\u4f5c\u7528,\u6ca1\u6709 api \u8c03\u7528,\u6ca1\u6709\u7a81\u53d8,\u53ea\u662f\u4e00\u4e2a\u8ba1\u7b97.\n\u63a5\u4e0b\u6765\u6211\u4eec\u4e00\u6b65\u6b65\u7684\u6765\u7406\u89e3\u4e4b\u524d\u5b9a\u4e49\u7684action. \u9996\u9009\u6211\u4eec\u521d\u59cb\u5316\u72b6\u6001. redux \u4f1a\u8c03\u7528\u4e00\u4e2a reducer \u800c\u5f53\u524d\u662fundefined \u72b6\u6001. \u6b64\u65f6\u5c31\u662f\u4e00\u4e2a\u673a\u4f1a\u6765\u521d\u59cb\u5316 app \u7684\u72b6\u6001.\n\nimport { VisibilityFilters } from './actions'\n\nconst initialState = {\n  visibilityFilter = VisibilityFilters.SHOW_ALL,\n  todos: []\n}\n\nfunction todoAPP(state, action) {\n  if (typeof state === 'undefined'){\n    return initialState\n  }\n  // For now, don't handle any actions\n  // and just return the state given to us\n  return state\n}\n\n\u4e0a\u9762\u4ee3\u7801\u91cc\u7684\u5173\u4e8estate \u53ef\u4ee5\u7528es6\u7684\u53c2\u6570\u9ed8\u8ba4\u503c\u8bed\u6cd5\u6765\u5199\u5c31\u662f:\nfunction todoAPP(state = initialState, action){\n return state\n}\n\n\u8ba9\u6211\u4eec\u6765\u5904\u7406SET_VISIBILITY_FILTER, \u6211\u4eec\u53ea\u9700\u8981\u6765\u4fee\u6539\u8fd9\u4e2avisibilityFilter \u7684\u503c:\nfunction todoApp(state = initialState, action) {\n  switch (action.type) {\n    case SET_VISIBILITY_FILTER:\n      return Object.assign({}, state, {\n        visibilityFilter: action.filter\n      })\n    default:\n      return state\n  }\n}\n\n\n\u6ce8\u610f\n\n\n\u6211\u4eec\u8fd9\u91cc\u4e0d\u4f1a\u4fee\u6539state,\u800c\u662f\u901a\u8fc7object.assign() \u51fd\u6570\u6765\u62f7\u8d1d\u8fd9\u4e2a\u5bf9\u8c61. \n\n\n\u800cObject.assgin(state, {visibilityFilyer: action.filter})\u540c\u6837\u662f\u9519\u8bef\u7684. \u56e0\u4e3astate \u4f5c\u4e3a\u7b2c\u4e00\u4e2a\u53c2\u6570\u4f20\u9012, \u5b83\u5c06\u8981\u88ab\u4fee\u6539. \u4f60\u5fc5\u987b\u4f20\u9012\u4e00\u4e2a\u7a7a\u7684\u5bf9\u8c61\u7ed9\u7b2c\u4e00\u4e2a\u53c2\u6570. \u770b\u8fd9\u91cc\n\n\n\n\u6211\u4eec\u540c\u65f6\u628a\u9ed8\u8ba4\u7684\u521d\u59cb\u72b6\u6001\u4f5c\u4e3a\u9ed8\u8ba4\u8fd4\u56de\u503c. \u8fd9\u4e2a\u5f88\u91cd\u8981\u4e00\u65e6\u9047\u5230\u672a\u77e5\u7684 action\u7684\u60c5\u51b5\u4e0b\u8fd8\u662f\u8981\u8fd4\u56de\u72b6\u6001.\n\n\u6ce8\u610f:\n\nObject.assign()\u662f es6\u7684\u4e00\u90e8\u5206,\u76ee\u524d\u8fd8\u6ca1\u6709\u5927\u90e8\u5206\u5b9e\u73b0\u652f\u6301.\u9700\u8981\u4e00\u4e2a polyfill \u6765\u652f\u6301.\u6211\u4eec\u7528 Babel \u7684\u4e00\u4e2a\u63d2\u4ef6.\n\n\n\u5904\u7406\u66f4\u591a\u52a8\u4f5c\nfunction todoApp(state = initialState, action) {\n  switch (action.type) {\n    case SET_VISIBILITY_FILTER:\n      return Object.assign({}, state, {\n        visibilityFilter: action.filter\n      })\n    case ADD_TODO:\n      return Object.assign({}, state, {\n        todos: [\n          ...state.todos,\n          {\n            text: action.text,\n            completed: false\n          }\n        ]\n      })    \n    default:\n      return state\n  }\n}\n\n\u4e0a\u9762\u5f88\u660e\u663e\u6211\u4eec\u90fd\u4e0d\u662f\u76f4\u63a5\u5728\u4fee\u6539state, \u800c\u662f\u53d6\u800c\u4ee3\u4e4b\u7528\u4e00\u4e2a\u65b0\u7684 object \u6765\u63a5\u4f4f\u4e4b\u524d\u7684 state, \u7136\u540e\u518d merge \u6700\u540e\u7684 todo, \u8fd9\u6837\u505a\u5230\u4e0d\u4fee\u6539\u539f\u6709\u7684\u72b6\u6001.\n\u6700\u540eTOGGLE_TODO \u7684\u52a8\u4f5c\u4e5f\u5c31\u5f88\u5bb9\u6613\u4e86:\ncase TOGGLE_TODO:\n  return Object.assign({}, state, {\n    todos: state.todos.map((todo, index) => {\n      if (index === action.index) {\n        return Object.assign({}, todo, {\n          completed: !todo.completed\n        })\n      }\n      return todo\n    })\n  })\n\n\u6211\u4eec\u5e0c\u671b\u8981\u4fee\u6539\u4e00\u4e2aarray \u91cc\u7279\u5b9a\u7684 ite m \u800c\u4e0d\u7a81\u53d8.\u6211\u4eec\u9700\u8981\u5229\u7528\u5f53\u524d\u7684 array\u521b\u5efa\u4e00\u4e2a\u65b0\u7684 array, \u800c\u9664\u4e86\u90a3\u4e2a\u5373\u5c06\u8981\u88ab\u4fee\u6539\u7684. \u800c\u8fd9\u6837\u7684\u52a8\u4f5c\u4f3c\u4e4e\u7ecf\u5e38\u53d1\u751f. \u6211\u4eec\u5c31\u53ef\u4ee5\u63a5\u4f4f\u5e2e\u52a9\u7c7b\u5982react--addons-update,updeep \u6765\u5b8c\u6210. \u751a\u81f3\u6709\u4e00\u4e2a\u5e93\u53ef\u4ee5\u5e72\u8fd9\u6837\u7684\u4e8b\u60c5, [Immutable(http://facebook.github.io/immutable-js/), \u8bb0\u4f4f\u522b\u53bb\u52a8 state.\n\n\u5206\u9694Reducers\nfunction todoApp(state = initialState, action) {\n  switch (action.type) {\n    case SET_VISIBILITY_FILTER:\n      return Object.assign({}, state, {\n        visibilityFilter: action.filter\n      })\n    case ADD_TODO:\n      return Object.assign({}, state, {\n        todos: [\n          ...state.todos,\n          {\n            text: action.text,\n            completed: false\n          }\n        ]\n      })\n    case TOGGLE_TODO:\n      return Object.assign({}, state, {\n        todos: state.todos.map((todo, index) => {\n          if(index === action.index) {\n            return Object.assign({}, todo, {\n              completed: !todo.completed\n            })\n          }\n          return todo\n        })\n      })\n    default:\n      return state\n  }\n}\n\n\n\u76ee\u524d\u770b\u4e0a\u53bb\u6211\u4eec\u7684\u4ee3\u7801\u7c7b\u4f3c\u8fd9\u6837\u7684. \u770b\u4e0a\u53bbtodos \u548cvisibilityFilter \u4ed6\u4eec\u662f\u5355\u72ec\u66f4\u65b0\u7684.\u6709\u65f6\u5019state \u662f\u9700\u8981\u66f4\u52a0\u7684\u72ec\u7acb\u7684.\u4f46\u662f\u8fd9\u91cc\u53ef\u4ee5\u5427 todo \u7684\u66f4\u65b0\u5148\u5355\u72ec\u5230\u4e00\u4e2a\u51fd\u6570\u91cc:\nfunction todos(state = [], action) {\n  switch (action.type) {\n    case ADD_TODO:\n      return [\n        ...state,\n        {\n          text: action.text,\n          completed: false\n        }\n      ]\n    case TOGGLE_TODO:\n      return state.map((todo, index) => {\n        if (index === action.index) {\n          return Object.assign({}, todo, {\n            completed: !todo.completed\n          })\n        }\n        return todo\n      })\n    default:\n      return state\n  }\n}\n\nfunction todoApp(state = initialState, action) {\n  switch (action.type) {\n    case SET_VISIBILITY_FILTER:\n      return Object.assign({}, state, {\n        visibilityFilter: action.filter\n      })\n    case ADD_TODO:\n    case TOGGLE_TODO:\n      return Object.assign({}, state, {\n        todos: todos(state.todos, action)\n      })\n    default:\n      return state\n  }\n}\n\n\u6ce8\u610f, \u8fd9\u91cc\u7684todos \u5b9a\u4e49\u4e5f\u662f\u63a5\u6536\u4e00\u4e2astate, \u800c\u5b83\u662f\u4e00\u4e2a array. \u73b0\u5728todoAPP \u7ed9\u4e86\u5b83\u4e00\u6bb5 state \u8ba9\u4ed6\u6765\u7ba1\u7406(\u4e5f\u5c31\u662ftodo list). \u800c todos \u77e5\u9053\u5982\u4f55\u6765\u66f4\u65b0\u8fd9\u4e2a\u7247\u6bb5(\u600e\u4e48\u77e5\u9053\u7684?). \u8fd9\u4e2a\u79f0\u4f5c \u590d\u5408reducer,\u800c\u4e14\u5b83\u662f\u6784\u5efaredux app \u7684\u57fa\u7840\u6a21\u5f0f.\n\u8ba9\u6211\u4eec\u6765\u770b\u770b\u8fd9\u4e2a\u590d\u5408\u7684 reducer, \u6211\u4eec\u662f\u5426\u53ef\u4ee5\u628a\u5bf9\u4e8e visibilityFilter \u7684\u7ba1\u7406\u4e5f\u62bd\u51fa\u6765\u4f5c\u4e3a reducer manager \u5462, \u53ef\u4ee5\u7684:\n\nfunction visibilityFilter(state = SHOW_ALL, action){\n  switch (action.type){\n    case SET_VISIBILITY_FILTER:\n      return action.filer\n\n    default:\n      reuturn state\n  }\n}\n\n\u73b0\u5728\u6211\u4eec\u53ef\u4ee5\u91cd\u5199\u4e3b reducer \u6765\u8c03\u7528\u6bcf\u4e00\u4e2a\u5355\u72ec\u7684reducer manager. \u7136\u540e\u628a\u4ed6\u4eec\u5408\u5e76\u5230\u4e00\u4e2a\u5355\u4e2a\u7684\u5bf9\u8c61\u91cc. \u4ece\u6b64\u5b83\u4e0d\u9700\u8981\u518d\u53bb\u77e5\u9053\u5b8c\u6574\u7684\u521d\u59cb\u72b6\u6001\u4e86. \u53ea\u9700\u8981\u8ba9\u5b50 reducer \u6765\u8fd4\u56de\u4e00\u4e2aundefined \u7684\u521d\u59cb\u72b6\u6001.\nfunction todos(state = [], action) {\n  switch (action.type) {\n    case ADD_TODO:\n      return [\n        ...state,\n        {\n          text: action.text,\n          completed: false\n        }\n      ]\n    case TOGGLE_TODO:\n      return state.map((todo, index) => {\n        if (index === action.index) {\n          return Object.assign({}, todo, {\n            completed: !todo.completed\n          })\n        }\n        return todo\n      })\n    default:\n      return state\n  }\n}\n\nfunction visibilityFilter(state = SHOW_ALL, action) {\n  switch (action.type) {\n    case SET_VISIBILITY_FILTER:\n      return action.filter\n    default:\n      return state\n  }\n}\n\nfunction todoApp(state = {}, action) {\n  return {\n    visibilityFilter: visibilityFilter(state.visibilityFilter, action),\n    todos: todos(state.todos, action)\n  }\n}\n\n\u6ce8\u610f\n\n\u8fd9\u91cc\u6bcf\u4e00\u4e2a reducer \u4ed6\u4eec\u624b\u91cc\u9762\u7684state \u5e76\u4e0d\u662f\u4e00\u6837\u7684,\u4ed6\u4eec\u53ea\u8d1f\u8d23\u4ed6\u4eec\u5404\u81ea\u5bf9\u5e94\u7684 state\u7247\u6bb5.\n\n\u5230\u8fd9\u91cc\u770b\u4e0a\u53bb\u5c31\u4e0d\u9519\u4e86. \u5f53\u968f\u7740 app \u4e0d\u65ad\u590d\u6742,\u6211\u4eec\u53ef\u4ee5\u628a reducer \u5206\u5272\u5230\u4e0d\u540c\u7684\u6587\u4ef6\u91cc,\u6700\u540e\u5728\u4e3b reducer \u91cc\u7ec4\u5408\u5c31\u597d. \u800c\u4e14 redux \u63d0\u4f9b\u4e00\u4e2a\u5de5\u5177 -- combineReducers() \u901a\u8fc7\u8fd9\u4e2a\u53ef\u4ee5\u66f4\u52a0\u65b9\u4fbf\u7684\u628a\u96f6\u6563\u7684 reducer \u7ec4\u5408\u8d77\u6765,\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u91cd\u6784\u4e4b\u524d\u7684 todoAPP \u5982\u4e0b:\nimport { combineReducers } from 'redux'\n\nconst todoApp = combineReducers({\n  visibilityFilter,\n  todos\n})\n\nexport default todoApp\n\n\u8fd8\u6709\u8fd9\u6837\u7684\u5199\u6cd5:\nexport default function todoApp(state = {}, action) {\n  return {\n    visibilityFilter: visibilityFilter(state.visibilityFilter, action),\n    todos: todos(state.todos, action)\n  }\n}\n\n\u751a\u81f3\u53ef\u4ee5\u7ed9\u6bcf\u4e00\u4e2a reducer \u6307\u6d3e\u4e0d\u540c\u7684\u952e, \u7136\u540e\u8fd9\u6837\u7528:\nconst reducer = combineReducers({\n  a: doSomethingWithA,\n  b: processB,\n  c: c\n})\nfunction reducer(state = {}, action) {\n  return {\n    a: doSomethingWithA(state.a, action),\n    b: processB(state.b, action),\n    c: c(state.c, action)\n  }\n}\n\n\u6240\u6709\u7684combineReducers() \u5176\u5b9e\u5c31\u505a\u4e00\u4ef6\u4e8b\u60c5,\u751f\u6210\u4e00\u4e2a\u51fd\u6570,\u7136\u540e\u8ba9\u6bcf\u4e00\u4e2a reducer \u6765\u901a\u8fc7\u4e0d\u540c\u5bf9\u5e94\u7684\u952e\u5229\u7528\u81ea\u5df1\u7684\u4e00\u6bb5 state.\u6700\u540e\u628a\u7ed3\u679c\u5408\u5e76\u8d77\u6765\u8d5b\u9053\u4e00\u4e2a\u5355\u4e2a\u5bf9\u8c61.\n\u90fd\u80fd\u5199\u6210\u8fd9\u6837:\n\nNote for ES6 Savvy Users\nBecause combineReducers expects an object, we can put all top-level reducers into a separate file, export each reducer function, and use import * as reducers to get them as an object with their names as the keys:\n\nimport { combineReducers } from 'redux'\nimport * as reducers from './reducers'\n\nconst todoApp = combineReducers(reducers)\n\n\nBecause import * is still new syntax, we don't use it anymore in the documentation to avoid confusion, but you may encounter it in some community examples.\n\n\u6700\u7ec8\u7684\u4ee3\u7801\u5982\u4e0b:\nimport { combineReducers } from 'redux'\nimport { ADD_TODO, TOGGLE_TODO, SET_VISIBILITY_FILTER, VisibilityFilters } from './actions'\nconst { SHOW_ALL } = VisibilityFilters\n\nfunction visibilityFilter(state = SHOW_ALL, action) {\n  switch (action.type) {\n    case SET_VISIBILITY_FILTER:\n      return action.filter\n    default:\n      return state\n  }\n}\n\nfunction todos(state = [], action) {\n  switch (action.type) {\n    case ADD_TODO:\n      return [\n        ...state,\n        {\n          text: action.text,\n          completed: false\n        }\n      ]\n    case TOGGLE_TODO:\n      return state.map((todo, index) => {\n        if (index === action.index) {\n          return Object.assign({}, todo, {\n            completed: !todo.completed\n          })\n        }\n        return todo\n      })\n    default:\n      return state\n  }\n}\n\nconst todoApp = combineReducers({\n  visibilityFilter,\n  todos\n})\n\nexport default todoApp\n\n\n\u63a5\u4e0b\u6765\u6211\u4eec\u770b\u5982\u4f55\u521b\u5efa\u4e00\u4e2a redux \u7684 store, \u5b83\u662f\u5982\u4f55\u5904\u7406state \u8fd8\u6709\u5982\u4f55 \u5728\u6307\u6d3e\u4e00\u4e2a action \u4e4b\u540e\u5982\u4f55\u8c03\u7528 reducer.\n\nStore\n\u4e0a\u9762\u6211\u4eec\u63a5\u89e6\u5230\u5982\u4f55\u5b9a\u4e49 action \u6765\u8868\u793a\u53d1\u751f\u4e86\u4ec0\u4e48\u53d8\u5316, \u8fd8\u6709 reducer \u5b83\u662f\u5982\u4f55\u901a\u8fc7\u4e0d\u540c\u7684 action \u6765\u4fee\u6539 app \u7684 state. \n\u4e0b\u9762\u6211\u4eec\u8981\u8bf4\u7684Store , Store \u662f\u4ec0\u4e48,\u4ece\u5b57\u9762\u610f\u601d\u770b\u5b83\u662f\u7528\u6765\u5b58\u50a8\u4ec0\u4e48\u7684, \u5bf9, \u5b83\u5c31\u662f\u5b58\u50a8 state tree \u7684. \nStore \u6709\u8fd9\u6837\u7684\u4f5c\u7528:\n\n\u7ba1\u7406app\u7684 state\n\n\u53ef\u4ee5\u901a\u8fc7getState()\u6765\u8bbf\u95ee state\n\n\u901a\u8fc7dispatch(action)\u6765\u4fee\u6539 app \u7684state\n\n\u901a\u8fc7subscribe(listener)\u6765\u6ce8\u518c\u76d1\u542c\n\u5904\u7406\u6ca1\u6709\u6ce8\u518c\u7684\u76d1\u542c\n\n\n\u518d\u6b21\u91cd\u7533: Redux app \u7684 state \u662f\u4fdd\u6301\u5728\u4e00\u4e2a\u5355\u72ec\u7684\u5bf9\u8c61\u91cc. \u5f53\u9700\u8981\u5206\u5272\u5904\u7406\u6570\u636e\u7684\u903b\u8f91\u65f6, \u5e94\u8be5\u4f7f\u7528\u590d\u5408 reducer\u6765\u66ff\u4ee3\u591a\u4e2a store.\n\n\u5982\u679c\u4f60\u6709 reducer,\u5f88\u5bb9\u6613\u6765\u521b\u5efastore. \u4e0a\u9762\u6211\u4eec\u4f7f\u7528\u4e86combineReducer()\u6765\u7ec4\u5408\u591a\u4e2a reducer, \u73b0\u5728\u6211\u4eec\u5f15\u7528\u5b83\u7136\u540e\u628a\u5b83\u4f20\u9012\u7ed9createStore().\nimport { createStore } from 'redux'\nimport todoApp from './reducers'\nlet store = createStore(todoApp)\n\n\n\u4f60\u53ef\u4ee5\u901a\u8fc7\u4f20\u9012\u4e00\u4e2a\u53ef\u9009\u7684\u53c2\u6570\u7ed9createStore()\u6765\u7ed9 app \u4e00\u4e2a\u521d\u59cb\u7684\u72b6\u6001,\u7528\u6765\u5904\u7406\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u5668\u7aef\u4e0d\u540c\u7684\u72b6\u6001(\u00d7)\n\nlet store = createStore(todoApp, window.STATE_FROM_SERVER)\n\n\n\u5206\u53d1\u52a8\u4f5c\n\u81f3\u6b64, \u6211\u4eec\u5df2\u7ecf\u521b\u5efa\u4e86Store, \u8ba9\u6211\u4eec\u6765\u9a8c\u8bc1 app \u662f\u5426\u5de5\u4f5c,\u6211\u4eec\u53ef\u4ee5\u5728\u6ca1UI \u7684\u60c5\u51b5\u4e0b\u6d4b\u8bd5\u66f4\u65b0\u903b\u8f91:\nimport { addTodo, toggleTodo, setVisibilityFilter, VisibilityFilters } from './actions'\n// Log the initial state\nconsole.log(store.getState())\n// Every time the state changes, log it\n// Note that subscribe() returns a function for unregistering the listener\nlet unsubscribe = store.subscribe(() =>\n  console.log(store.getState())\n)\n// Dispatch some actions\n// \u901a\u8fc7 store.dispatch() \u65b9\u6cd5\u53ef\u4ee5\u6a21\u62df\u7528\u6237\u4ea4\u4e92, \u51fa\u53d1 action\nstore.dispatch(addTodo('Learn about actions'))\nstore.dispatch(addTodo('Learn about reducers'))\nstore.dispatch(addTodo('Learn about store'))\nstore.dispatch(toggleTodo(0))\nstore.dispatch(toggleTodo(1))\nstore.dispatch(setVisibilityFilter(VisibilityFilters.SHOW_COMPLETED))\n// Stop listening to state updates\nunsubscribe()\n```\n\n\nindex.js\n\nimport { createStore } from 'redux'\nimport todoApp from './reducers'\n\nlet store = createStore(todoApp)\n\n\u63a5\u4e0b\u6765\u6211\u4eec\u8981\u4e86\u89e3 redux app \u91cc\u7684\u6570\u636e\u6d41\n\u521a\u624d\u8bf4\u5230\u4e86 Store \n\u63a5\u4e0b\u6765\u8bf4 \u6570\u636e\u6d41\nRedux \u4f7f\u7528\u5355\u5411\u6570\u636e\u6d41\n\u8fd9\u5c31\u610f\u5473\u7740\u5728 app \u91cc\u6240\u6709\u7684\u6570\u636e\u90fd\u4f1a\u7ecf\u8fc7\u540c\u6837 \u7684\u751f\u547d\u5468\u671f\u6a21\u5f0f. \u8ba9\u4f60\u7684\u7a0b\u5e8f\u903b\u8f91\u66f4\u52a0\u53ef\u4ee5\u9884\u6d4b\u548c\u5bb9\u6613\u7406\u89e3.\u5bf9\u4e8e\u6570\u636e\u7684\u5904\u7406\u540c\u6837\u8981\u4f18\u5316\u7cbe\u534e. \u800c\u4e0d\u662f\u8ba9\u4f60\u6b7b\u5728\u591a\u4efd\u540c\u6837\u7684\u6570\u636e, \u4f60\u624b\u91cc\u7684\u6570\u636e\u540c\u6837\u80fd\u591f\u88ab\u4ed6\u4eba\u6765\u4fee\u6539. \u90fd\u4e0d\u77e5\u9053\u81ea\u5df1\u600e\u4e48\u6b7b\u7684.\n\u5982\u679c\u8fd8\u662f\u6ca1\u6709\u88ab\u8bf4\u670d,\u5efa\u8bae\u8bfb\u4e00\u4e0b 1 2 \u540c\u65f6\u5efa\u8bae\u8bfb\u4e00\u4e0b Redux \u4e0d\u7b80\u5355\u662f Flux \u7684\u53d8\u79cd\u5b83\u540c\u6837\u8bf4\u660e\u4e86\u4e00\u4e9b\u4e3a\u4ec0\u4e48\u8981\u5355\u5411\u6570\u636e\u6d41\u7684\u597d\u5904.\nRedux \u5e94\u7528\u91cc\u7684\u6570\u636e\u5927\u81f4\u4f1a\u8d704\u6b65:\n\n\u5f53\u4f60\u8c03\u7528` store.dispatch(action). \u89e6\u53d1\u4e86\u4e00\u4e2a\u52a8\u4f5c.\n\n\u4e00\u4e2a\u52a8\u4f5c\u5c31\u662f\u4e00\u4e2a\u7b80\u5355\u7684\u5bf9\u8c61,\u8bf4\u660e\u4e86\u4f1a\u53d1\u751f\u4ec0\u4e48.\n\n { type: 'LIKE_ARTICLE', articleId: 42 }\n { type: 'FETCH_USER_SUCCESS', response: { id: 3, name: 'Mary' } }\n { type: 'ADD_TODO', text: 'Read the Redux docs.' }\n\n\u63cf\u8ff0\u4e86\u4e00\u4e2a\u52a8\u4f5c, \u5df2\u7ecf\u4e00\u4e9b\u53c2\u6570\u7528\u6765\u6307\u660e\u52a8\u4f5c\u4f5c\u7528\u7684\u5bf9\u8c61.\n\u597d\u6bd4\u8fd9\u6837\u8bf4: \u4e00\u4e2a\u52a8\u4f5c\u5c31\u662f'\u67d0\u67d0\u559c\u6b22\u627e\u4e2a\u6587\u7ae0', \u770b redux \u7684\u6587\u7ae0`\u7b49\u7b49.\n\u4f60\u53ef\u4ee5\u5728 redux app \u7684\u4efb\u4f55\u5730\u65b9\u4f7f\u7528` store.dispatch(action), \u5305\u62ec\u7ec4\u4ef6\u6216\u8005 XHR \u7684\u56de\u8c03, \u751a\u81f3\u662f\u4e00\u4e2a\u5faa\u73af\u8c03\u7528.\n\nRedux store \u8c03\u7528\u4f60\u7ed9\u5b83\u7684 reducer \u51fd\u6570\n\nstore \u662f\u4f1a\u4f20\u9012\u4e24\u4e2a\u53c2\u6570\u7ed9reducer \u7684. \u7b2c\u4e00\u4e2a\u662f\u5f53\u524d\u7684\u72b6\u6001, \u7b2c\u4e8c\u4e2a\u662f action, \u7136\u540e\u8fd4\u56de action \u4f5c\u7528\u4e4b\u540e\u7684\u6700\u65b0\u72b6\u6001. \u518d\u6765\u770b\u4e2a\u4f8b\u5b50:\n let previousState = { // \u5f53\u524d\u7684\u72b6\u6001\n   visibleTodoFilter: 'SHOW_ALL',  //\u8981\u663e\u793a\u4ec0\u4e48\u7c7b\u578b\n   todos: [  //\u6240\u6709\u7684 todo\n     {\n       text: 'Read the docs.',\n       complete: false\n     }\n   ]\n }\n\n // \u8fd9\u662f\u4e00\u4e2a\u6dfb\u52a0 todo \u7684\u52a8\u4f5c\n let action = {\n   type: 'ADD_TODO',\n   text: 'Understand the flow.'\n }\n\n // \u83b7\u53d6\u6700\u65b0\u7684\u72b6\u6001\n let nextState = todoApp(previousState, action)\n\n\n\n\u4e00\u5b9a\u8981\u4fdd\u8bc1reducer \u90fd\u662f pure \u7684\u51fd\u6570,\u4e5f\u5c31\u662f\u8bf4\u6bcf\u6b21\u7ed9\u540c\u6837\u7684\u53c2\u6570\u8fd4\u56de\u7ed3\u679c\u90fd\u662f\u4e00\u6837\u7684.\n\n\n\u6839 reducer \u53ef\u4ee5\u7ec4\u5408\u591a\u4e2a reducer \u5230\u4e00\u4e2a\u5355\u72ec\u7684\u72b6\u6001\u6811\u91cc.\n\n\u5982\u4f55\u7ec4\u7ec7*\u6839 reducer *\u5b8c\u5168\u662f\u4e2a\u4eba\u559c\u597d, Redux \u63d0\u4f9b\u4e00\u4e2acombineReducers() \u51fd\u6570\u7528\u6765\u5e2e\u52a9\u7ec4\u7ec7\u5206\u6563\u7684 Reducer. \u4e0b\u9762\u518d\u770b\u770b\u4ed6\u4eec\u662f\u5982\u4f55\u88ab\u7ec4\u7ec7\u8d77\u6765\u7684:\n function todos(state = [], action) {\n   // Somehow calculate it...\n   return nextState\n }\n\n function visibleTodoFilter(state = 'SHOW_ALL', action) {\n   // Somehow calculate it...\n   return nextState\n }\n\n let todoApp = combineReducers({\n   todos,\n   visibleTodoFilter\n })\n\n\u5f53\u4f60\u89e6\u53d1\u4e00\u4e2a\u52a8\u4f5c, \u7136\u540e todoAPP \u5c31\u4f1a\u8c03\u7528\u7531combineReducers\u8fd4\u56de\u7684\u5bf9\u5e94\u7684 reducer:\nlet nextTodos = todos(state.todos, action)\nlet nextVisibleTodoFilter = visibleTodoFilter(state.visibleTodoFilter, action)\n\n\u5176\u5b9e\u4e0a\u9762\u7684\u60c5\u51b5\u5c31\u662f\u8fd4\u56de\n return {\n   todos: nextTodos,\n   visibleTodoFilter: nextVisibleTodoFilter\n }\n\n\n\n\nRedux Store \u4f1a\u628a\u6240\u6709\u7684 reducer \u8fd4\u56de\u7684 state \u5199\u4f1a\u5355\u72ec\u5b8c\u6574\u7684 state \u91cc.\n\n\u81f3\u6b64,\u7b97\u662f\u6211\u4eec\u5df2\u7ecf\u5b8c\u6210\u7684 backend \u903b\u8f91, \u63a5\u4e0b\u6765\u6211\u4eec\u4f1a\u5b66\u4e60\u5982\u4f55\u7ed3\u5408react \u5b8c\u5168 UI \u90e8\u5206.\n\n\u4f7f\u7528 React\n\u8fd9\u91cc\u8bf4\u660e\u7684\u5c31\u662f\u5176\u5b9e Redux \u5b83\u5b8c\u6210\u7684\u903b\u8f91\u662f\u4e0d\u9650\u4e8e react \u6765\u5b8c\u6210 UI \u90e8\u5206\u7684. \u4f60\u5b8c\u5168\u53ef\u4ee5\u4f7f\u7528\u5982Angular Ember \u6216\u8005jQuery \u7b49 frontend \u6846\u67b6\u6765\u5199. \u800c\u53ea\u662f Redux \u53ef\u4ee5\u66f4\u597d\u5730\u548c react \u6216\u8005 deku \u7ed3\u5408\u4f7f\u7528. \u56e0\u4e3a\u4ece react \u4ed6\u4eec\u7684\u6982\u5ff5\u5b9a\u4e49\u6765\u8bf4, \u63cf\u8ff0 UI \u7684\u8fc7\u7a0b\u5c31\u662f\u5728\u8bf4\u660e\u4e00\u4e2a\u72b6\u6001\u7684\u51fd\u6570. \u548c Redux \u54cd\u5e94\u4e00\u4e2a\u52a8\u4f5c\u51fa\u53d1\u72b6\u6001\u66f4\u65b0. \n\u63a5\u4e0b\u6765\u6211\u4eec\u4f7f\u7528 react \u6765\u6784\u5efa\u8fd9\u4e2a todoapp \u7684 UI \u90e8\u5206.\n\n\u5b89\u88c5 react redux\nreact \u7ed1\u5b9a \u662f\u5355\u72ec\u4e0e redux \u5b58\u5728,\u6211\u4eec\u73b0\u5728\u5b89\u88c5\u5b83:\nnpm install --save react-redux\n\n\nIf you don't use npm, you may grab the latest UMD build from unpkg (either a development or a production build). \nThe UMD build exports a global called window.\nReactRedux if you add it to your page via a <script> tag.\n\n\n\u5c55\u793a\u5bb9\u5668\u7ec4\u4ef6(\u7528\u6765\u753b UI, \u65e0\u903b\u8f91)\nReact redux \u7ed1\u5b9a\u5c01\u88c5\u4e86\u5c55\u793a\u548c\u5bb9\u5668\u7ec4\u4ef6\u5206\u79bb\u7684\u6982\u5ff5. \u82e5\u4e0d\u719f\u6089\u5148\u8bfb\u5b83,\n\u5f88\u91cd\u8981,\u53ef\u4ee5\u79bb\u5f00\u653e\u4e0b\u8fd9\u91cc,\u7b49\u4f60.\n\u56de\u6765...\n\u6211\u4eec\u603b\u7ed3\u4e0b\u6709\u4ec0\u4e48\u4e0d\u540c\u4e4b\u5904:\n\n\n\n\\\n\u5c55\u793a\u7ec4\u4ef6\n\u5bb9\u5668\u7ec4\u4ef6\n\n\n\n\n\u76ee\u7684\n\u770b\u4e0a\u53bb\u50cf\u4ec0\u4e48\n\u4ed6\u4eec\u662f\u600e\u4e48\u5de5\u4f5c\u7684\n\n\n\u548c Redux\u901a\u4fe1\n\u4e0d\n\u662f\n\n\n\u600e\u4e48\u8bfb\u53d6\u6570\u636e\n\u4ece\u5c5e\u6027 props\n\u8ba2\u9605 redux \u7684\u72b6\u6001\n\n\n\u600e\u4e48\u4fee\u6539\u6570\u636e\n\u901a\u8fc7\u5c5e\u6027\u91cc\u7684\u56de\u8c03\n\u89e6\u53d1 redux \u7684\u52a8\u4f5c\n\n\n\u8c01\u5199\u7684\n\u81ea\u5df1\u7528\u624b\n\u901a\u5e38\u7531react redux \u4f1a\u751f\u6210\n\n\n\n\u6211\u4eec\u9700\u8981\u5904\u7406\u7684\u5927\u90e8\u5206\u7684\u90fd\u662f\u5c55\u793a\u7ec4\u4ef6, \u5f53\u7136\u4e5f\u8981\u5904\u7406\u4e00\u4e9b\u5bb9\u5668\u7ec4\u4ef6, \u4ed6\u4eec\u7528\u6765\u548creudx store \u8fde\u63a5\u8d77\u6765.\n\u6280\u672f\u4e0a\u6765\u8bf4, \u4f60\u53ef\u4ee5\u901a\u8fc7\u8c03\u7528store.subscribe()\u6765\u5199\u5bb9\u5668\u7ec4\u4ef6,\u4f46\u662f\u4e0d\u5efa\u8bae\u4f60\u90a3\u6837\u505a.\n\u56e0\u4e3aReact redux \u901a\u5e38\u4f1a\u505a\u5f88\u591a\u7684\u4f18\u5316, \u4ed6\u4eec\u90fd\u662f\u624b\u52a8\u65e0\u6cd5\u5b8c\u6210\u7684. \n\u56e0\u4e3a\u8fd9\u4e2a, \u6211\u4eec\u66f4\u52a0\u8d8b\u5411\u4e8e\u901a\u8fc7\u4f7f\u7528 react-reudx \u7684connect() \u51fd\u6570\u6765\u751f\u6210\u4ed6\u4eec.\n\n\u8bbe\u8ba1\u7ec4\u4ef6\u4f53\u7cfb\u7ed3\u6784\n\u4e4b\u524d\u6211\u4eec\u540c\u6837\u9047\u5230\u4e00\u4e2a\u73af\u8282\u5c31\u662f\u5728\u52a8\u624b\u4e4b\u524d\u8bbe\u8ba1\u6211\u4eec\u7684 state \u4f53\u7cfb. \u73b0\u5728\u6211\u4eec\u8981\u8bbe\u8ba1\u5982\u4f55\u7ec4\u7ec7 UI \u7ed3\u6784\u4e86. \u8fd9\u91cc\u5c31\u4e0d\u662f redux \u7684\u8303\u7574\u4e86. \u53ef\u4ee5\u901a\u8fc7\u5982\u4f55\u4f7f\u7528 react \u6765\u5b66\u4e60\u7406\u89e3\u5982\u4f55\u5904\u7406.\n\u6211\u4eec\u5728\u8fd9\u91cc\u7684\u8bbe\u8ba1\u5f88\u7b80\u5355\u4e86, \u6211\u4eec\u8981\u663e\u793a\u4e00\u4e2a todo \u7684 list. \u70b9\u51fb todo \u7684 item, \u5b83\u5c31\u6807\u8bb0\u4e3a\u5b8c\u6210. \u800c\u4e14\u53ef\u4ee5\u8fc7\u6ee4\u663e\u793a\u6ca1\u6709\u5b8c\u6210\u7684,\u6216\u8005\u5df2\u7ecf\u5b8c\u6210\u7684.\n\n\n\u5c55\u793a\u7ec4\u4ef6\n\u901a\u8fc7\u4e0a\u9762\u5927\u81f4\u7684\u8bb2\u8ff0,\u6211\u73b0\u5728\u8111\u6d77\u91cc\u5c31\u662f\u8fd9\u6837\u4e00\u4e9b\u4e1c\u897f\u6d6e\u73b0;\n\n\nTodoList \u7528\u6765\u8868\u793a\u53ef\u89c1\u7684 todo \u5217\u8868\n\ntodos:Array \u5c31\u662f\u4e00\u7ec4 todo \u7684 item, \u5927\u6982\u5185\u5bb9\u5c31\u662f {id,text,completed}.\nonTodoClick(id:number) \u662f\u4e00\u4e2a\u56de\u8c03\u5f53\u4e00\u4e2a todo \u7684 item \u88ab\u70b9\u51fb\u7684\u65f6\u5019.\n\n\n\nTodo \u5c31\u662f\u8868\u793a\u4e00\u4e2a\u5355\u72ec\u7684 todo\n\ntext:string \u5f53\u524d todo \u7684\u5185\u5bb9\ncompleted:boolean \u5f53\u524d\u662f\u5426\u6807\u8bb0\u4e3a\u5b8c\u6210\nonClick() \u662f\u4e00\u4e2a\u56de\u8c03, \u5f53\u5728 item \u88ab\u70b9\u51fb\u7684\u65f6\u5019\u89e6\u53d1\n\n\n\nLink \u56de\u8c03\u7528\n\nonClick() link \u5728\u88ab\u70b9\u51fb\u540e\u89e6\u53d1\u7684\u56de\u8c03\n\n\nFooter \u7528\u6765\u663e\u793a\u4ec0\u4e48\u72b6\u6001\u7684 toggle\nApp \u5c31\u662f\u5f53\u524d app \u7684\u6839\u5143\u7d20\n\n\u4ed6\u4eec\u5b8c\u5168\u4e0d\u4f9d\u8d56redux, \u5f53\u4f60\u628a redux \u8fc1\u79fb\u5230\u5176\u4ed6\u7684\u6846\u67b6\u4e0a\u65f6, \u8fd9\u4e9b\u4e1c\u897f\u5b8c\u5168\u4e0d\u9700\u8981\u4fee\u6539. \u4ed6\u4eec\u53ea\u662f\u7528\u6765\u6e32\u67d3\u4f60\u60f3\u8981\u5728 UI \u4e0a\u770b\u5230\u7684\u4e1c\u897f\n\n\n\u5bb9\u5668\u7ec4\u4ef6\n\u5bb9\u5668\u7ec4\u4ef6\u5728\u8fd9\u91cc\u5145\u5f53\u7684\u89d2\u8272\u5c31\u662f\u7528\u5b83\u6765\u8fde\u63a5\u5c55\u793a\u7ec4\u4ef6\u548c redux, \u8ba9redux \u7684\u6570\u80fd\u5bf9\u5e94\u7684\u663e\u793a\u5728\u5c55\u793a\u7ec4\u4ef6\u4e0a. \u6bd4\u5982\u521a\u624d\u5b9a\u4e49\u7684\u5c55\u793a\u7ec4\u4ef6TodoList \u7ec4\u4ef6\u5b83\u5c31\u9700\u8981\u4e00\u4e2a\u5bb9\u5668\u6bd4\u5982\u53ebVisibleTodoList, \u7136\u540e\u8ba9\u5b83\u8ba2\u9605\u5230Redux store\u91cc\u7684\u5f53\u524d\u5bf9\u5e94\u53ef\u89c1\u7684todo, \u4e3a\u4e86\u4fee\u6539\u53ef\u89c1\u8fc7\u6ee4\u5668,\u6211\u4eec\u9700\u8981\u4e00\u4e2a\u6bd4\u5982FilterLink \u7684\u5bb9\u5668\u6765\u5b8c\u6210\u6e32\u67d3\u4e00\u4e2aLink \u6765\u8ba9\u5b83\u5b8c\u6210\u4e00\u4e2a\u52a8\u4f5c\u7684\u89e6\u53d1\u5f53\u70b9\u51fb\u5b83\u7684\u65f6\u5019:\n\nVisibleTodoList \u901a\u8fc7\u5f53\u524d\u7684\u663e\u793a\u8fc7\u6ee4\u6761\u4ef6\u62ff\u5230 todo list\nFilterLink \u83b7\u53d6\u5f53\u524d\u7684\u8fc7\u6ee4\u6761\u4ef6\u7136\u540e\u6e32\u67d3\u4e00\u4e2a link\n\n\nFilter:string \n\n\n\n\n\u5176\u4ed6\u7ec4\u4ef6\n\u6709\u65f6\u5019\u5f88\u96be\u754c\u5b9a\u5b83\u5230\u5e95\u662f\u5c55\u793a\u7ec4\u4ef6\u8fd8\u662f\u5bb9\u5668\u7ec4\u4ef6. \u4f8b\u5982\u6709\u65f6\u5019\u4e00\u4e2a\u8868\u5355\u6216\u8005\u4e00\u4e2a\u51fd\u6570\u4ed6\u4eec\u7cbe\u5bc6\u7684\u7f20\u7ed5,\u5982\n\nAddTodo \u5c31\u662f\u4e00\u4e2a\u8f93\u5165\u6846\u52a0\u4e00\u4e2a\u6dfb\u52a0\u6309\u94ae\n\n\u6280\u672f\u4e0a\u8bb2\u6211\u4eec\u53ef\u4ee5\u628a\u4ed6\u4eec\u5206\u5f00,\u4f46\u662f\u5462\u73b0\u5728\u8fd9\u4e2a\u521d\u7ea7\u9636\u6bb5\u6211\u4eec\u6700\u597d\u628a\u5b83\u6df7\u5408\u5728\u4e00\u8d77. \u56e0\u4e3a\u7ec4\u4ef6\u7684\u903b\u8f91\u4e5f\u4e0d\u662f\u5f88\u9ebb\u70e6, \u968f\u7740 app \u7684\u6210\u957f,\u5982\u4f55\u5206\u5272\u4ed6\u4eec\u5c31\u53d8\u5f97\u8d8a\u6765\u8d8a\u660e\u663e.\n\n\u52a8\u624b\u5b9e\u73b0\u7ec4\u4ef6\n\u6211\u4eec\u5148\u4ece\u5c55\u793a\u7ec4\u4ef6\u5f00\u59cb,\u56e0\u4e3a\u6211\u4eec\u4e0d\u9700\u8981\u8003\u8651\u5982\u4f55\u548c redux \u8054\u7cfb\u8d77\u6765.\n\n\u5c55\u793a\u7ec4\u4ef6\n\u8fd9\u4e9b\u90fd\u662f\u666e\u901a\u7684 React \u7ec4\u4ef6.\u6211\u4eec\u4e5f\u4e0d\u4f1a\u6d89\u53ca\u592a\u591a,\u5c31\u662f\u5199\u4e00\u4e9b\u65e0\u72b6\u6001\u7684\u7eaf\u51fd\u6570.\n\u9664\u975e\u6211\u4eec\u8fd8\u9700\u8981\u4e00\u4e9b\u672c\u5730\u7684\u72b6\u6001\u6216\u8005\u751f\u547d\u5468\u671f\u7684\u65b9\u6cd5.\u5f53\u7136\u4e5f\u4e0d\u662f\u8bf4\u7ec4\u4ef6\u5fc5\u987b\u662f\u51fd\u6570.\u53ea\u662f\u7528\u51fd\u6570\u7b80\u5355.\n\u5982\u4f55\u4f60\u4e4b\u540e\u8bbe\u8ba1\u5230\u672c\u5730\u72b6\u6001,\u751f\u547d\u5468\u671f\u7684\u65b9\u6cd5,\u6216\u8005\u6027\u80fd\u4f18\u5316\u7684\u65f6\u5019\u53ef\u4ee5\u628a\u5b83\u4eec\u5199\u6210\u7c7b.\n\ncomponents/Todo.js\n\nimport React, { PropTypes } from 'react'\n// \u5b9a\u4e49\u5355\u4e2a todo \u5bf9\u8c61\n// \u9700\u89813\u4e2a\u53c2\u6570,1 click\u4e8b\u4ef6, 2 \u662f\u5426\u5b8c\u6210, 3 \u663e\u5f0f\u6587\u672c\nconst Todo = ({ onClick, completed, text }) => (\n  <li onClick={onClick} style={{ textDecoration: completed ? 'line-through' : 'none' }} > {text} </li>\n)\n\n// \u9a8c\u8bc13\u4e2a\u53c2\u6570\nTodo.propTypes = {\n  onClick: PropTypes.func.isRequired,\n  completed: PropTypes.bool.isRequired,\n  text: PropTypes.string.isRequired\n}\n\nexport default Todo\n\n\n\ncomponents/TodoList.js\nimport React, { PropTypes } from 'react'\nimport Todo from './Todo'\n\nconst TodoList = ({ todos, onTodoClick }) => (\n  <ul>\n    {todos.map(todo =>\n      <Todo\n        key={todo.id}\n        {...todo}\n        onClick={() => onTodoClick(todo.id)}\n      />\n    )}\n  </ul>\n)\n\nTodoList.propTypes = {\n  todos: PropTypes.arrayOf(PropTypes.shape({\n    id: PropTypes.number.isRequired,\n    completed: PropTypes.bool.isRequired,\n    text: PropTypes.string.isRequired\n  }).isRequired).isRequired,\n  onTodoClick: PropTypes.func.isRequired\n}\n\nexport default TodoList\n\n\n\ncomponents/link.js\nimport React, { PropTypes } from 'react'\n\nconst Link = ({ active, children, onClick }) => {\n  if (active) {\n    return <span>{children}</span>\n  }\n\n  return (\n    <a href=\"#\"\n       onClick={e => {\n         e.preventDefault()\n         onClick()\n      }}\n    >\n      {children}\n    </a>\n  )\n}\n\nLink.propTypes = {\n  active: PropTypes.bool.isRequired,\n  children: PropTypes.node.isRequired,\n  onClick: PropTypes.func.isRequired\n}\n\nexport default Link\n\n\n\ncomponents/Footer.js\nimport React from 'react'\nimport FilterLink from '../containers/FilterLink'\n\nconst Footer = () => (\n  <p>\n    Show:\n    {\" \"}\n    <FilterLink filter=\"SHOW_ALL\">\n      All\n    </FilterLink>\n    {\", \"}\n    <FilterLink filter=\"SHOW_ACTIVE\">\n      Active\n    </FilterLink>\n    {\", \"}\n    <FilterLink filter=\"SHOW_COMPLETED\">\n      Completed\n    </FilterLink>\n  </p>\n)\n\nexport default Footer\n\n\n\ncomponents/App.js\nimport React from 'react'\nimport Footer from './Footer'\nimport AddTodo from '../containers/AddTodo'\nimport VisibleTodoList from '../containers/VisibleTodoList'\n\nconst App = () => (\n  <div>\n    <AddTodo />\n    <VisibleTodoList />\n    <Footer />\n  </div>\n)\n\nexport default App\n\n\n\n\u5bb9\u5668\u7ec4\u4ef6\n\u73b0\u5728\u662f\u65f6\u5019\u628a\u8fd9\u4e9b\u89c6\u56fe\u7ec4\u4ef6 hook \u5230 redux \u91cc\u901a\u8fc7\u521b\u5efa\u4e00\u4e9b\u5bb9\u5668\u7ec4\u4ef6. \u6280\u672f\u4e0a\u6765\u8bf4, \u4e00\u4e2a\u5bb9\u5668\u7ec4\u4ef6\u5c31\u662f\u4e00\u4e2a React \u7684\u7ec4\u4ef6( component), \u4ed6\u4eec\u901a\u8fc7\u4f7f\u7528store.subscribe()\u6765\u8bfb\u53d6Redux \u72b6\u6001\u6811\u4e2d\u7684\u90e8\u5206\u72b6\u6001\u6570\u636e,\u7136\u540e\u7ed9\u89c6\u56fe\u7ec4\u4ef6\u7684props \u5bf9\u8c61,\u4e4b\u540e\u5c55\u793a\u7684\u8fc7\u7a0b\u548c\u903b\u8f91. \u4f60\u53ef\u4ee5\u624b\u6572\u4e00\u4e2a\u5bb9\u5668\u7ec4\u4ef6, \u4f46\u662f\u4e0d\u5efa\u8bae\u8fd9\u4e48\u505a\u6709\u70b9\u50bb,\u5efa\u8bae\u4f60\u901a\u8fc7\u4f7f\u7528 react redux \u7684\u5e93\u63d0\u4f9b\u7684connect() \u51fd\u6570\u6765\u751f\u6210\u8fd9\u4e9b\u5bb9\u5668\u7ec4\u4ef6.\u4ed6\u4eec\u540c\u65f6\u63d0\u4f9b\u4e86\u5f88\u591a\u4f18\u5316\u6765\u9632\u6b62\u91cd\u590d\u6ca1\u7528\u7684\u6e32\u67d3.\n\u4e3a\u4e86\u4f7f\u7528connect(),\u4f60\u9700\u8981\u5b9a\u4e49\u4e00\u4e2a\u7279\u6b8a\u7684\u51fd\u6570\u540d\u5b57\u53eb\u505amapStateToProps, \u5b83\u7684\u4f5c\u7528\u5c31\u662f\u544a\u8bc9\u5f53\u524d\u7684 app \u5982\u4f55\u628a redux \u91cc\u7684\u7279\u5b9a\u7684\u72b6\u6001\u7247\u6bb5\u5bf9\u5e94\u5230\u7279\u5b9a\u7ec4\u4ef6\u7684props \u5c5e\u6027\u4e0a.\u4e3e\u4e2a\u4f8b\u5b50, VisibleTodoList \u9700\u8981\u8ba1\u7b97todos, \u628a\u5b83\u4f20\u7ed9TodoList. \u6240\u4ee5\u6211\u4eec\u9700\u8981\u5b9a\u4e49\u4e00\u4e2a\u51fd\u6570,\u5b83\u80fd\u591f\u8fc7\u6ee4\u51fastate.todos, \u901a\u8fc7state.visibilityFilter, \u4e4b\u540e\u5728mapStateToProps \u91cc\u662f\u8fd9\u6837\u7684:\nconst getVisibleTodos = (todos, filter) => {\n  switch (filter) {\n    case 'SHOW_ALL':\n      return todos\n    case 'SHOW_COMPLETED':\n      return todos.filter(t => t.completed)\n    case 'SHOW_ACTIVE':\n      return todos.filter(t => !t.completed)\n  }\n}\n\nconst mapStateToProps = (state) => {\n  return {\n    todos: getVisibleTodos(state.todos, state.visibilityFilter)\n  }\n}\n\n\u9664\u4e86\u8bfb\u53d6 redux \u7684\u72b6\u6001,\u5bb9\u5668\u7ec4\u4ef6\u8fd8\u53ef\u4ee5\u5206\u53d1\u52a8\u4f5c. \u901a\u5e38\u6d41\u884c\u7684\u5199\u6cd5\u662f\u4f60\u53ef\u4ee5\u5b9a\u4e49\u4e00\u4e2amapDispatchToProps()\u51fd\u6570.\u4ed6\u53ef\u4ee5\u63a5\u6536\u4e00\u4e2adispatch() \u65b9\u6cd5,\u7136\u540e\u8fd4\u56de\u4e00\u4e2a\u56de\u8c03\u53c2\u6570, \u8fd9\u4e2a\u56de\u8c03\u53c2\u6570\u5c31\u662f\u4f60\u60f3\u8981 hook\u5230\u89c6\u56fe\u7ec4\u4ef6\u4e2d\u7684. \u4f8b\u5982, \u6211\u4eec\u60f3\u8981\u628aVisibleTodoList \u6ce8\u5165\u4e00\u4e2aonTodoClick \u7684\u5c5e\u6027\u5230TodoList \u7684\u7ec4\u4ef6.\u800c\u4e14\u8fd9\u4e2aonTodoClick\u8fd8\u53ef\u4ee5\u65b9\u6cd5TOGGLE_TODO \u7684\u52a8\u4f5c:\nconst mapDispatchToProps = (dispatch) => {\n  return {\n    onTodoClick: (id) => {\n      dispatch(toggleTodo(id))\n    }\n  }\n}\n\n\u6700\u7ec8,\u6211\u4eec\u901a\u8fc7\u8c03\u7528connect() \u4f20\u90122\u4e2a\u53c2\u6570, \u521b\u5efa\u4e86VisibleTodoList\u5bf9\u8c61.\nimport { connect } from 'react-redux'\n\nconst VisibleTodoList = connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(TodoList)\n\nexport default VisibleTodoList\n\n\u8fd9\u4e9b\u90fd\u662f React redux \u57fa\u672c\u7684 API, \u4f46\u662f\u8fd8\u6709\u5f88\u591a\u65b9\u4fbf\u597d\u7528\u7684\u65b9\u6cd5\u6240\u4ee5\u5efa\u8bae\u4f60\u9605\u8bfb\u5b83\u7684\u6587\u6863,\u5982\u679c\u4f60 \u7ecf\u5e38\u62c5\u5fc3mapStateToProps\u521b\u5efa\u65b0\u7684\u5bf9\u8c61,\u4f60\u53ef\u4ee5\u5b66\u4e60computing derived data with reselect.\n\u63a5\u4e0b\u6765\u662f\u5168\u90e8\u7684\u5bb9\u5668\u7ec4\u4ef6\u7684\u4ee3\u7801:\n\ncontainers/FilterLink.js\n\nimport { connect } from 'react-redux'\nimport { setVisibilityFilter } from '../actions'\nimport Link from '../components/Link'\n\nconst mapStateToProps = (state, ownProps) => {\n  return {\n    active: ownProps.filter === state.visibilityFilter\n  }\n}\n\nconst mapDispatchToProps = (dispatch, ownProps) => {\n  return {\n    onClick: () => {\n      dispatch(setVisibilityFilter(ownProps.filter))\n    }\n  }\n}\n\nconst FilterLink = connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(Link)\n\nexport default FilterLink\n\n\n\ncontainers/VisibleTodoList.js\nimport { connect } from 'react-redux'\nimport { toggleTodo } from '../actions'\nimport TodoList from '../components/TodoList'\n\nconst getVisibleTodos = (todos, filter) => {\n  switch (filter) {\n    case 'SHOW_ALL':\n      return todos\n    case 'SHOW_COMPLETED':\n      return todos.filter(t => t.completed)\n    case 'SHOW_ACTIVE':\n      return todos.filter(t => !t.completed)\n  }\n}\n\nconst mapStateToProps = (state) => {\n  return {\n    todos: getVisibleTodos(state.todos, state.visibilityFilter)\n  }\n}\n\nconst mapDispatchToProps = (dispatch) => {\n  return {\n    onTodoClick: (id) => {\n      dispatch(toggleTodo(id))\n    }\n  }\n}\n\nconst VisibleTodoList = connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(TodoList)\n\nexport default VisibleTodoList\n\n\n\n\u5176\u4ed6\u7684\u7ec4\u4ef6\n\ncontainers/AddTodo.js\n\nimport React from 'react'\nimport { connect } from 'react-redux'\nimport { addTodo } from '../actions'\n\nlet AddTodo = ({ dispatch }) => {\n  let input\n\n  return (\n    <div>\n      <form onSubmit={e => {\n        e.preventDefault()\n        if (!input.value.trim()) {\n          return\n        }\n        dispatch(addTodo(input.value))\n        input.value = ''\n      }}>\n        <input ref={node => {\n          input = node\n        }} />\n        <button type=\"submit\">\n          Add Todo\n        </button>\n      </form>\n    </div>\n  )\n}\nAddTodo = connect()(AddTodo)\n\nexport default AddTodo\n\n\n\n\u4f20\u9012 Store\n\u6240\u6709\u7684\u5bb9\u5668\u7ec4\u4ef6\u90fd\u80fd\u591f\u8bbf\u95ee Redux \u7684 store, \u6240\u4ee5\u4ed6\u4eec\u53ef\u4ee5\u8ba2\u9605\u5b83. \u6709\u4e2a\u65b9\u6cd5\u5c31\u662f\u53ef\u4ee5\u628a\u5b83\u5f53\u505a\u4e00\u4e2a\u53c2\u6570 prop \u4f20\u9012\u7ed9\u6bcf\u4e00\u4e2a\u5bb9\u5668\u7ec4\u4ef6. \u4f46\u662f\u8fd9\u6837\u5f88\u65e0\u804a,\u4f60\u9700\u8981\u628a\u5b83\u5728\u6240\u6709\u89c6\u56fe\u7ec4\u4ef6\u4e2d\u4f20\u9012?\n\u5c31\u662f\u56e0\u4e3a\u4ed6\u4eec\u5728\u7ec4\u4ef6\u6811\u91cc\u5f88\u6df1\u7684\u4f4d\u7f6e\u54e6.?\u4e0d\u61c2\n\u6211\u4eec\u63a8\u8350\u7684\u4e00\u4e2a\u65b9\u6cd5\u5c31\u662f\u4f7f\u7528\u4e00\u4e2a\u7279\u6b8a\u7684 react redux \u7ec4\u4ef6\u53eb\u505a<Provider>,\u5b83\u53ef\u4ee5\u5f88\u9b54\u6027\u7684\u8ba9 store\u53d8\u5f97\u5728\u6240\u6709\u7684\u5bb9\u5668\u7ec4\u4ef6\u4e2d\u53ef\u89c1, \u800c\u4e0d\u9700\u8981\u518d\u53bb\u663e\u793a\u7684\u4f20\u9012\u5b83, \u56e0\u4e3a\u4f60\u53ea\u9700\u8981\u5728\u6839\u7ec4\u4ef6\u91cc\u5f15\u7528\u4e00\u6b21.\n\nindex.js\n\nimport React from 'react'\nimport { render } from 'react-dom'\nimport { Provider } from 'react-redux'\nimport { createStore } from 'redux'\nimport todoApp from './reducers'\nimport App from './components/App'\n\nlet store = createStore(todoApp)\n\nrender(\n  <Provider store={store}>\n    <App />\n  </Provider>,\n  document.getElementById('root')\n)\n\n\n\n\u5230\u8fd9\u91cc, \u4e00\u4e2atodo app \u4e5f\u5c31\u5b8c\u4e8b\u513f, \u6211\u4eec\u56de\u8fc7\u5934\u6765\u91cd\u65b0\u67e5\u770b\u5b83\u7684\u6e90\u7801, \u5bf9\u6bd4\u4e0a\u9762\u6211\u4eec\u6240\u8bb2\u89e3\u8fc7\u7684\u4e00\u5207. \u518d\u53bb\u611f\u53d7\u5982\u4f55 build \u4e00\u4e2aredux-react app.\n-THE END-\n\n## \u76ee\u5f55\n\n\u63a5\u4e0b\u6765\u8981\u8bbe\u8ba1\u5230\u4ee5\u4e0b\u7684\u5185\u5bb9\n\n- Actions & action creator\n- Reducers\n- Store\n- Data Flow\n- Usage with React\n- Example: Todo List\n\n\n### \u52a8\u4f5c\u53ca\u52a8\u4f5c\u521b\u5efa\u8005\n\n\u6240\u8c13\u52a8\u4f5c\u5c31\u662f\u666e\u901a javascript \u7684\u5bf9\u8c61, \u5b83\u7528\u6765\u63cf\u8ff0\u52a8\u4f5c\u7684\u5185\u5bb9, \n\u4ed6\u4eec\u4ece app \u53d1\u9001\u5230 store. \u4ed6\u4eec\u5c31\u662f store \u91cc\u7684\u6570\u636e\u7684\u6e90\u5934. \u901a\u8fc7` store.dispatch()` \u6765\u53d1\u9001\u6570\u636e.\n\n```\n{\n  type: 'ADD_TODO',\n  text: 'Build my first Redux app'\n\n}\n```\n> \u901a\u5e38\u6211\u4eec\u628a\u52a8\u4f5c\u7684\u7c7b\u578b\u5b9a\u4e49\u4e3a\u4e00\u4e2a\u5e38\u91cf\n\n\n```\nconst ADD_TODO = 'ADD_TODO'\n```\n\n\n\u5176\u5b9e\u6240\u8c13 **\u52a8\u4f5c** \u5c31\u662f\u4e00\u4e2a\u666e\u901a\u7684 **javascript** \u5bf9\u8c61, \u5b83\u5fc5\u987b\u6709\u4e00\u4e2a` type` \u5c5e\u6027, \u7528\u6765\u8868\u660e\u5b83\u80fd\u505a\u4ec0\u4e48\u6837\u7684\u52a8\u4f5c.\u800c\u8fd9\u4e2a type \u5fc5\u987b\u662f\u4e00\u4e2a\u58f0\u660e\u4e3a\u5e38\u91cf\u7684\u5b57\u7b26\u4e32\u5bf9\u8c61. \u800c\u4e14\u4e00\u822capp \u7684 action \u90fd\u4f1a\u5f88\u591a,\u6240\u4ee5\u53ef\u4ee5\u5355\u72ec\u628a\u4ed6\u4eec\u653e\u5728\u4e00\u4e2a\u6587\u4ef6. \u7136\u540e\u53ef\u4ee5\u8fd9\u6837\u5f15\u7528:\n\n```\nimport { ADD_TODO, REMOVE_TODO } from '../actionTypes'\n```\n\n\u63a5\u4e0b\u6765,\u6211\u4eec\u5c06\u8981\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u52a8\u4f5c,\u7528\u6765\u63cf\u8ff0\u7528\u6237\u52fe\u9009\u67d0\u4e2a todo \u4e3a\u5b8c\u6210\u7684\u52a8\u4f5c. \u6211\u4eec\u4f1a\u901a\u8fc7` index` \u6765\u6807\u8bb0\u6bcf\u4e00\u4e2a` todo` .\u56e0\u4e3a\u6211\u4eec\u628a\u4ed6\u4eec\u653e\u5728` array` \u91cc,\u8fd9\u91cc\u53ea\u662f demo, \u800c\u771f\u5b9e\u7684 app \u6700\u597d\u6709\u4e13\u95e8\u7684\u903b\u8f91\u7528\u6765\u751f\u6210\u627e\u4e2a id.\n\n```\n{\n  type: TOGGLE_TODO,\n  index: 5\n}\n```\n\n\u5728\u8fd9,\u5176\u5b9e\u6bcf\u4e00\u4e2a\u52a8\u4f5c\u5c3d\u53ef\u80fd\u8ba9\u5b83\u643a\u5e26\u6700\u7b80\u5316\u7684\u6570\u636e\u96c6. \u4f8b\u5982, \u6211\u4eec\u901a\u8fc7` index` \u5c31\u53ef\u4ee5\u4ee3\u8868\u8fd9\u4e2a todo\u5bf9\u8c61.\n\n```\n{\n  type: SET_VISIBILITY_FILTER,\n  filter: SHOW_COMPLETED\n}\n```\n\n`\u52a8\u4f5c`\u6211\u4eec\u5148\u8bf4\u5230\u8fd9\u513f,\u63a5\u4e0b\u6765\u8bf4\u8bf4`\u52a8\u4f5c\u521b\u5efa\u8005`. \u5728 Redux \u4e2d, **\u52a8\u4f5c\u7684\u521b\u5efa\u8005** \u5c31\u662f\u4e00\u4e2a\u5730\u9053\u7684\u51fd\u6570, \u7528\u6765\u521b\u5efa\u5e76\u8fd4\u56de\u4e00\u4e2a\u52a8\u4f5c. \u53ef\u80fd\u5f88\u5bb9\u6613\u5728\u8fd9\u91cc\u6df7\u6dc6`\u52a8\u4f5c`\u548c`\u52a8\u4f5c\u521b\u5efa\u8005`.\n\n`\u52a8\u4f5c\u521b\u5efa\u8005`\u7684\u4f5c\u7528\u5c31\u662f\u8fd4\u56de\u4e00\u4e2a\u52a8\u4f5c:\n\n```\nfunction addTodo(text){\n  return {\n    type: ADD_TODO,\n    text\n  }\n}\n```\n\n---\n\n> \u5728\u4f20\u7edf\u7684 Flux \u67b6\u6784\u4e2d, \u4e00\u4e2a\u52a8\u4f5c\u8005\u901a\u5e38\u5728\u5b9a\u4e49\u4e00\u4e2a action, \u4e4b\u540e\u8fd8\u6709`\u5206\u53d1`\u5230\u5df2\u7ecf\u6ce8\u518c\u7684\u67d0\u4e2a store \u91cc?\n\n```\nfunction addTodoWithDispatch(text) {\n  const action = {\n    type: ADD_TODO,\n    text\n  }\n  dispatch(action)\n}\n\n```\n\n\n---\n\n\u800c\u5728 Redux \u4e2d\u4e0d\u8fd9\u4e48\u5904\u7406. \u53d6\u800c\u4ee3\u4e4b\u7684\u662f\u53bb\u8c03\u7528` Store` \u7684` dispatch()`\u51fd\u6570. \u628a\u4e00\u4e2a\u52a8\u4f5c\u4f5c\u4e3a\u53c2\u6570\u4f20\u9012\u7ed9\u5b83.\n\n```\nStore.dispatch(addTodo(text))\nStore.dispatch(completeTodo(index))\n```\n\n\n\u6216\u8005,\u53ef\u4ee5\u521b\u5efa\u4e00\u4e2a`\u7ed1\u5b9a\u52a8\u4f5c\u521b\u5efa\u8005( bound action creator)` \u6765\u81ea\u52a8\u5b9e\u73b0\u52a8\u4f5c\u7684\u5206\u53d1:\n\n```\nconst boundAddTodo = (text) => dispatch(addTodo(text))\nconst boundCompleteTodo = (index) => dispatch(completeTodo(index))\n\n```\n\n\u73b0\u5728\u53ef\u4ee5\u8fd9\u6837\u4f7f\u7528\u4ed6\u4eec:\n\n```\nboundAddTodo(text)\nboundCompleteTodo(index)\n```\n\n\u8fd9\u4e2a\u5206\u53d1` dispatch()` \u51fd\u6570\u53ef\u4ee5\u76f4\u63a5\u901a\u8fc7` store.dispatch()`\u5728` store` \u91cc\u8bbf\u95ee\u5230, \u6216\u8005\u76f4\u63a5\u901a\u8fc7` react-redux` \u7684`\u5e2e\u52a9\u7c7b\u65b9\u6cd5 connect()`, \u4f7f\u7528` bindActionCreators()`\u6765**\u81ea\u52a8**\u5c06\u8fd9\u4e9b`\u52a8\u4f5c\u521b\u5efa\u8005`\u7ed1\u5b9a\u5230\u5bf9\u5e94\u7684` dispatch()` \u51fd\u6570\u4e0a.\n\n\u52a8\u4f5c\u521b\u5efa\u8005\u8fd8\u53ef\u4ee5\u662f\u5f02\u6b65\u7684,\u4f46\u5177\u6709\u526f\u4f5c\u7528.\n\n> You can read about async actions in the advanced tutorial to learn how to handle AJAX responses and compose action creators into async control flow. \n\n\u8bf4\u4e86\u8fd9\u4e48\u591a, \u6765\u770b\u770b\u5168\u90e8\u7684\u6e90\u7801.\n\n```\n/*\n * action types\n */\n\nexport const ADD_TODO = 'ADD_TODO'\nexport const TOGGLE_TODO = 'TOGGLE_TODO'\nexport const SET_VISIBILITY_FILTER = 'SET_VISIBILITY_FILTER'\n\n/*\n * other constants\n */\n\nexport const VisibilityFilters = {\n  SHOW_ALL: 'SHOW_ALL',\n  SHOW_COMPLETED: 'SHOW_COMPLETED',\n  SHOW_ACTIVE: 'SHOW_ACTIVE'\n}\n\n/*\n * action creators\n */\n\nexport function addTodo(text) {\n  return { type: ADD_TODO, text }\n}\n\nexport function toggleTodo(index) {\n  return { type: TOGGLE_TODO, index }\n}\n\nexport function setVisibilityFilter(filter) {\n  return { type: SET_VISIBILITY_FILTER, filter }\n}\n```\n\n\n\u63a5\u7740\u8bf4, \u521a\u624d\u6211\u4eec\u8bf4\u5230\u4e86`\u521b\u5efa\u52a8\u4f5c`\u548c`\u52a8\u4f5c\u521b\u5efa\u8005`\u4ee5\u53ca\u5982\u4f55\u7ed1\u5b9a\u548c\u5206\u53d1\u52a8\u4f5c.\n\n\u63a5\u4e0b\u6765\u6211\u4eec\u770b\u770b` reducer`.\n\n### Reducer\n\n\u73b0\u5728\u6211\u4eec\u8003\u8651\u7684\u95ee\u9898\u5c31\u662f, \u52a8\u4f5c\u5206\u53d1\u4e86\u4e4b\u540e\u5462, \u5230\u54ea\u513f\u53bb,\u5e72\u4e86\u4ec0\u4e48!?\n\n\u5173\u4e8e`\u52a8\u4f5c`, \u5b83\u662f\u5b9e\u5b9e\u5728\u5728\u5b9a\u4e49\u4e86\u5e72\u4ec0\u4e48. \u4f46\u662f\u5b83\u5e72\u4ec0\u4e48\u600e\u4e48\u624d\u80fd\u591f\u5f71\u54cd\u5230 app \u7684\u72b6\u6001\u5462, \u8ba9 app \u505a\u51fa\u5bf9\u5e94\u7684\u54cd\u5e94\u5462, **\u8fd9\u5c31\u662f` reducer` \u7684\u8981\u505a\u7684.**\n\n####\u8bbe\u8ba1\u72b6\u6001\u7ed3\u6784\n\n\u5148\u6765\u8bf4\u8bf4` state`,\u5728 redux \u91cc\u6240\u6709\u7684\u72b6\u6001\u90fd\u662f\u4fdd\u6301\u5728\u4e00\u4e2a\u5355\u4e2a\u7684\u5bf9\u8c61\u91cc,\u73b0\u5728\u6211\u4eec\u6765\u60f3\u60f3\u4e00\u4e0b\u5979\u7684\u6837\u5b50.\n\n\u62ff` todo app `\u6765\u8bf4,\u6211\u4eec\u8981\u5b58\u50a82\u6837\u4e1c\u897f:\n\n- todo \u7684 list\n\t- \u8fd9\u4e2a\u662f\u6700\u4e3b\u8981\u7684,\u65f6\u523b\u90fd\u80fd\u591f\u53d6\u5230\u5b8c\u6574\u7684 todo \u6570\u636e.\n- \u5f53\u524d\u88ab\u9009\u4e2d\u7684\u663e\u793a\u8fc7\u6ee4\u5668(\u8981\u663e\u793a\u4ec0\u4e48\u72b6\u6001\u7684 todo)\n\t- \u8fd9\u91cc\u6211\u4eec\u53ea\u9700\u8981\u4fdd\u5b58\u5f53\u524d\u7528\u6237\u9009\u4e2d\u9700\u8981\u663e\u5f0f\u90a3\u4e2a\u7c7b\u578b\u7684 todo \u5c31\u597d,(\u5982\u5f53\u524d\u8fdb\u884c\u7684\u6216\u8005\u5df2\u7ecf\u5b8c\u6210\u7684.)\n\n\u53ef\u80fd\u5bf9\u4e8e\u4e00\u4e2a app \u6765\u8bf4,\u6211\u4eec\u901a\u5e38\u4e0b\u610f\u8bc6\u4f1a\u8ba4\u4e3a\u6709\u5f88\u591a\u4e8b\u60c5,\u6570\u636e\u9700\u8981\u5904\u7406. \u6709\u5f88\u591a\u7684 case. \u4f46\u662f\u5bf9\u4e8e\u8fd9\u91cc\u6240\u8bb2\u7684`\u72b6\u6001`\u6765\u8bf4, \u6211\u4eec\u9700\u8981\u62bd\u8c61,\u53d6\u51fa\u6700\u4e3b\u8981\u7684\u4e1c\u897f. \n\n\u6bd4\u5982\u8bf4, \u6211\u4eec\u53ea\u9700\u8981 care \u8fd9\u4e9b\u6570\u636e\u5c31\u53ef\u4ee5, \u5229\u7528\u8fd9\u4e9b\u6570\u636e\u6211\u4eec\u5c31\u80fd\u591f\u6b63\u5e38\u8fd0\u8f6c app\n\n\n```\n{\n  visibilityFilter: 'SHOW_ALL',\n  todos: [\n    {\n      text: 'Consider using Redux',\n      completed: true,\n    },\n    {\n      text: 'Keep all state in a single tree',\n      completed: false\n    }\n  ]\n}\n```\n\n> \u5728\u4e00\u4e2a\u8f83\u590d\u6742\u7684 app \u4e2d,\u53ef\u80fd\u5b9e\u4f53\u4e4b\u95f4\u4f1a\u76f8\u4e92\u5f15\u7528.\u6211\u4eec\u5efa\u8bae\u5c3d\u91cf\u628a\u72b6\u6001\u4fdd\u6301\u8d8a\u7b80\u5355\u8d8a\u597d. \u4e0d\u8981\u6709\u5d4c\u5957\u7684\u5173\u7cfb\u5b58\u5728. \n> \u5c3d\u91cf\u7136\u540e\u6bcf\u4e00\u4e2a\u5bf9\u8c61\u6709\u4e00\u4e2a id \u80fd\u591f\u8bc6\u522b. \u901a\u8fc7 id \u6765\u5f15\u7528.\u60f3\u8c61 app \u7684\u72b6\u6001\u5c31\u548c database \u91cc\u7684\u72b6\u6001\u7c7b\u4f3c. \u8fd9\u4e2a\u53ef\u4ee5\u67e5\u770b [normalizr](https://github.com/gaearon/normalizr) \u7684\u8be6\u7ec6\u6587\u6863\u6765\u770b.\n\n#### \u5904\u7406\u52a8\u4f5c\n\n\u4e0a\u9762\u6211\u4eec\u5927\u6982\u77e5\u9053\u4e86\u627e\u4e2a todo app \u91cc`\u72b6\u6001`\u5bf9\u8c61\u6837\u5b50, \u63a5\u4e0b\u6765\u6211\u4eec\u5199` reducer`. \n\n> \u91cd\u8981\u4e8b\u60c5\u8bf4\u4e09\u904d\n\n**`reducer` \u5c31\u662f\u4e00\u4e2a`\u7eaf\u51fd\u6570`,\u63a5\u53d72\u4e2a\u53c2\u6570, \u7b2c\u4e00\u4e2a\u7684\u5f53\u524d\u7684\u72b6\u6001,\u7b2c\u4e8c\u4e2a\u662f\u52a8\u4f5c, \u7136\u540e\u8fd4\u56de\u6700\u65b0\u7684\u72b6\u6001.**\n**`reducer` \u5c31\u662f\u4e00\u4e2a`\u7eaf\u51fd\u6570`,\u63a5\u53d72\u4e2a\u53c2\u6570, \u7b2c\u4e00\u4e2a\u7684\u5f53\u524d\u7684\u72b6\u6001,\u7b2c\u4e8c\u4e2a\u662f\u52a8\u4f5c, \u7136\u540e\u8fd4\u56de\u6700\u65b0\u7684\u72b6\u6001.**\n**`reducer` \u5c31\u662f\u4e00\u4e2a`\u7eaf\u51fd\u6570`,\u63a5\u53d72\u4e2a\u53c2\u6570, \u7b2c\u4e00\u4e2a\u7684\u5f53\u524d\u7684\u72b6\u6001,\u7b2c\u4e8c\u4e2a\u662f\u52a8\u4f5c, \u7136\u540e\u8fd4\u56de\u6700\u65b0\u7684\u72b6\u6001.**\n\n\n\n```\n(previousState, action) => newState\n```\n\n\u8fd9\u4e2a\u6211\u5c31\u79f0\u4e4b\u4e3a` reducer`, \u56e0\u4e3a\u5b83\u5176\u5b9e\u662f\u8fd9\u6837\u4e00\u4e2a\u5b9e\u73b0:\n\n```\nArray.prototype.reduce(reducer, ?initialValue)\n```\n\n\u5bf9\u4e8e` reducer` \u6765\u8bf4\u4fdd\u8bc1\u5b83\u7684[`\u7eaf\u6d01\u6027`](https://en.wikipedia.org/wiki/Pure_function)\u662f\u975e\u5e38\u91cd\u8981\u7684.\u5728 reducer \u91cc\u4fdd\u8bc1\u4e0d\u80fd\u591f\u53d1\u751f\u5982\u4e0b\u7684\u4e8b\u60c5:\n\n- \u6539\u53d8\u53c2\u6570\n- \u4e0d\u80fd\u591f\u505a\u5176\u4ed6\u4e8b\u60c5\u5982\u8c03\u7528 API \u6216\u8005\u4fee\u6539 route\n- \u8c03\u7528\u4e0d `pure` \u7684\u51fd\u6570\u5982 `Date.now()` \u6216\u8005 `Math.random()`\n\n\u8fd9\u91cc\u5148\u4e0d\u8ba8\u8bba\u526f\u4f5c\u7528\u7684\u4e1c\u897f\u4e4b\u540e\u9ad8\u9636\u65f6\u5019\u4f1a\u8bf4. \u73b0\u5728\u6211\u4eec\u53ea\u8bb0\u4f4f\u5bf9\u4e8e reducer \u7684 function \u5fc5\u987b\u662f pure \u7684. `\u7ed9\u4e00\u6837\u7684\u53c2\u6570,\u603b\u662f\u8fd4\u56de\u540c\u6837\u7684\u7ed3\u679c,\u6ca1\u6709\u526f\u4f5c\u7528,\u6ca1\u6709 api \u8c03\u7528,\u6ca1\u6709\u7a81\u53d8,\u53ea\u662f\u4e00\u4e2a\u8ba1\u7b97`.\n\n\u63a5\u4e0b\u6765\u6211\u4eec\u4e00\u6b65\u6b65\u7684\u6765\u7406\u89e3\u4e4b\u524d\u5b9a\u4e49\u7684` action`. \u9996\u9009\u6211\u4eec\u521d\u59cb\u5316`\u72b6\u6001`. redux \u4f1a\u8c03\u7528\u4e00\u4e2a reducer \u800c\u5f53\u524d\u662f` undefined` \u72b6\u6001. \u6b64\u65f6\u5c31\u662f\u4e00\u4e2a\u673a\u4f1a\u6765\u521d\u59cb\u5316 app \u7684\u72b6\u6001.\n\n```\n\nimport { VisibilityFilters } from './actions'\n\nconst initialState = {\n  visibilityFilter = VisibilityFilters.SHOW_ALL,\n  todos: []\n}\n\nfunction todoAPP(state, action) {\n  if (typeof state === 'undefined'){\n    return initialState\n  }\n  // For now, don't handle any actions\n  // and just return the state given to us\n  return state\n}\n```\n\n\u4e0a\u9762\u4ee3\u7801\u91cc\u7684\u5173\u4e8e` state` \u53ef\u4ee5\u7528` es6`\u7684`\u53c2\u6570\u9ed8\u8ba4\u503c`\u8bed\u6cd5\u6765\u5199\u5c31\u662f:\n\n```\nfunction todoAPP(state = initialState, action){\n return state\n}\n```\n\n\u8ba9\u6211\u4eec\u6765\u5904\u7406` SET_VISIBILITY_FILTER`, \u6211\u4eec\u53ea\u9700\u8981\u6765\u4fee\u6539\u8fd9\u4e2a` visibilityFilter` \u7684\u503c:\n\n```\nfunction todoApp(state = initialState, action) {\n  switch (action.type) {\n    case SET_VISIBILITY_FILTER:\n      return Object.assign({}, state, {\n        visibilityFilter: action.filter\n      })\n    default:\n      return state\n  }\n}\n```\n\n>\u6ce8\u610f\n\n1. \u6211\u4eec\u8fd9\u91cc\u4e0d\u4f1a\u4fee\u6539` state`,\u800c\u662f\u901a\u8fc7` object.assign()` \u51fd\u6570\u6765\u62f7\u8d1d\u8fd9\u4e2a\u5bf9\u8c61. \n\t2. \u800c` Object.assgin(state, {visibilityFilyer: action.filter})`\u540c\u6837\u662f\u9519\u8bef\u7684. \u56e0\u4e3a` state` \u4f5c\u4e3a\u7b2c\u4e00\u4e2a\u53c2\u6570\u4f20\u9012, \u5b83\u5c06\u8981\u88ab\u4fee\u6539. \u4f60\u5fc5\u987b\u4f20\u9012\u4e00\u4e2a\u7a7a\u7684\u5bf9\u8c61\u7ed9\u7b2c\u4e00\u4e2a\u53c2\u6570. \u770b[\u8fd9\u91cc](http://redux.js.org/docs/recipes/UsingObjectSpreadOperator.html)\n2. \u6211\u4eec\u540c\u65f6\u628a\u9ed8\u8ba4\u7684\u521d\u59cb\u72b6\u6001\u4f5c\u4e3a\u9ed8\u8ba4\u8fd4\u56de\u503c. \u8fd9\u4e2a\u5f88\u91cd\u8981\u4e00\u65e6\u9047\u5230\u672a\u77e5\u7684 action\u7684\u60c5\u51b5\u4e0b\u8fd8\u662f\u8981\u8fd4\u56de\u72b6\u6001.\n\n\u6ce8\u610f:\n\n> Object.assign()\u662f es6\u7684\u4e00\u90e8\u5206,\u76ee\u524d\u8fd8\u6ca1\u6709\u5927\u90e8\u5206\u5b9e\u73b0\u652f\u6301.\u9700\u8981\u4e00\u4e2a polyfill \u6765\u652f\u6301.\u6211\u4eec\u7528 Babel \u7684\u4e00\u4e2a\u63d2\u4ef6.\n\n#### \u5904\u7406\u66f4\u591a\u52a8\u4f5c\n\n```\nfunction todoApp(state = initialState, action) {\n  switch (action.type) {\n    case SET_VISIBILITY_FILTER:\n      return Object.assign({}, state, {\n        visibilityFilter: action.filter\n      })\n    case ADD_TODO:\n      return Object.assign({}, state, {\n        todos: [\n          ...state.todos,\n          {\n            text: action.text,\n            completed: false\n          }\n        ]\n      })    \n    default:\n      return state\n  }\n}\n```\n\n\u4e0a\u9762\u5f88\u660e\u663e\u6211\u4eec\u90fd\u4e0d\u662f\u76f4\u63a5\u5728\u4fee\u6539` state`, \u800c\u662f\u53d6\u800c\u4ee3\u4e4b\u7528\u4e00\u4e2a\u65b0\u7684 object \u6765\u63a5\u4f4f\u4e4b\u524d\u7684 state, \u7136\u540e\u518d merge \u6700\u540e\u7684 todo, \u8fd9\u6837\u505a\u5230\u4e0d\u4fee\u6539\u539f\u6709\u7684\u72b6\u6001.\n\n\u6700\u540e` TOGGLE_TODO` \u7684\u52a8\u4f5c\u4e5f\u5c31\u5f88\u5bb9\u6613\u4e86:\n\n\n```\ncase TOGGLE_TODO:\n  return Object.assign({}, state, {\n    todos: state.todos.map((todo, index) => {\n      if (index === action.index) {\n        return Object.assign({}, todo, {\n          completed: !todo.completed\n        })\n      }\n      return todo\n    })\n  })\n```\n\n\u6211\u4eec\u5e0c\u671b\u8981\u4fee\u6539\u4e00\u4e2aarray \u91cc\u7279\u5b9a\u7684 ite m \u800c\u4e0d\u7a81\u53d8.\u6211\u4eec\u9700\u8981\u5229\u7528\u5f53\u524d\u7684 array\u521b\u5efa\u4e00\u4e2a\u65b0\u7684 array, \u800c\u9664\u4e86\u90a3\u4e2a\u5373\u5c06\u8981\u88ab\u4fee\u6539\u7684. \u800c\u8fd9\u6837\u7684\u52a8\u4f5c\u4f3c\u4e4e\u7ecf\u5e38\u53d1\u751f. \u6211\u4eec\u5c31\u53ef\u4ee5\u63a5\u4f4f\u5e2e\u52a9\u7c7b\u5982` react--addons-update`,`updeep` \u6765\u5b8c\u6210. \u751a\u81f3\u6709\u4e00\u4e2a\u5e93\u53ef\u4ee5\u5e72\u8fd9\u6837\u7684\u4e8b\u60c5, [Immutable(http://facebook.github.io/immutable-js/), \u8bb0\u4f4f\u522b\u53bb\u52a8 state.\n\n### \u5206\u9694Reducers\n\n```\nfunction todoApp(state = initialState, action) {\n  switch (action.type) {\n    case SET_VISIBILITY_FILTER:\n      return Object.assign({}, state, {\n        visibilityFilter: action.filter\n      })\n    case ADD_TODO:\n      return Object.assign({}, state, {\n        todos: [\n          ...state.todos,\n          {\n            text: action.text,\n            completed: false\n          }\n        ]\n      })\n    case TOGGLE_TODO:\n      return Object.assign({}, state, {\n        todos: state.todos.map((todo, index) => {\n          if(index === action.index) {\n            return Object.assign({}, todo, {\n              completed: !todo.completed\n            })\n          }\n          return todo\n        })\n      })\n    default:\n      return state\n  }\n}\n\n```\n\n\u76ee\u524d\u770b\u4e0a\u53bb\u6211\u4eec\u7684\u4ee3\u7801\u7c7b\u4f3c\u8fd9\u6837\u7684. \u770b\u4e0a\u53bb` todos` \u548c` visibilityFilter` \u4ed6\u4eec\u662f\u5355\u72ec\u66f4\u65b0\u7684.\u6709\u65f6\u5019` state` \u662f\u9700\u8981\u66f4\u52a0\u7684\u72ec\u7acb\u7684.\u4f46\u662f\u8fd9\u91cc\u53ef\u4ee5\u5427 todo \u7684\u66f4\u65b0\u5148\u5355\u72ec\u5230\u4e00\u4e2a\u51fd\u6570\u91cc:\n\n```\nfunction todos(state = [], action) {\n  switch (action.type) {\n    case ADD_TODO:\n      return [\n        ...state,\n        {\n          text: action.text,\n          completed: false\n        }\n      ]\n    case TOGGLE_TODO:\n      return state.map((todo, index) => {\n        if (index === action.index) {\n          return Object.assign({}, todo, {\n            completed: !todo.completed\n          })\n        }\n        return todo\n      })\n    default:\n      return state\n  }\n}\n\nfunction todoApp(state = initialState, action) {\n  switch (action.type) {\n    case SET_VISIBILITY_FILTER:\n      return Object.assign({}, state, {\n        visibilityFilter: action.filter\n      })\n    case ADD_TODO:\n    case TOGGLE_TODO:\n      return Object.assign({}, state, {\n        todos: todos(state.todos, action)\n      })\n    default:\n      return state\n  }\n}\n```\n\n\n\u6ce8\u610f, \u8fd9\u91cc\u7684` todos` \u5b9a\u4e49\u4e5f\u662f\u63a5\u6536\u4e00\u4e2a` state`, \u800c\u5b83\u662f\u4e00\u4e2a array. \u73b0\u5728` todoAPP` \u7ed9\u4e86\u5b83\u4e00\u6bb5 state \u8ba9\u4ed6\u6765\u7ba1\u7406(\u4e5f\u5c31\u662ftodo list). \u800c `todos` **\u77e5\u9053\u5982\u4f55\u6765\u66f4\u65b0\u8fd9\u4e2a\u7247\u6bb5**(\u600e\u4e48\u77e5\u9053\u7684?). **\u8fd9\u4e2a\u79f0\u4f5c \u590d\u5408reducer,\u800c\u4e14\u5b83\u662f\u6784\u5efaredux app \u7684\u57fa\u7840\u6a21\u5f0f**.\n\n\u8ba9\u6211\u4eec\u6765\u770b\u770b\u8fd9\u4e2a**\u590d\u5408\u7684 reducer**, \u6211\u4eec\u662f\u5426\u53ef\u4ee5\u628a\u5bf9\u4e8e visibilityFilter \u7684\u7ba1\u7406\u4e5f\u62bd\u51fa\u6765\u4f5c\u4e3a reducer manager \u5462, \u53ef\u4ee5\u7684:\n\n\n```\n\nfunction visibilityFilter(state = SHOW_ALL, action){\n  switch (action.type){\n    case SET_VISIBILITY_FILTER:\n      return action.filer\n      \n    default:\n      reuturn state\n  }\n}\n```\n\n\u73b0\u5728\u6211\u4eec\u53ef\u4ee5\u91cd\u5199\u4e3b reducer \u6765\u8c03\u7528**\u6bcf\u4e00\u4e2a\u5355\u72ec\u7684reducer manager**. \u7136\u540e\u628a\u4ed6\u4eec\u5408\u5e76\u5230\u4e00\u4e2a\u5355\u4e2a\u7684\u5bf9\u8c61\u91cc. \u4ece\u6b64\u5b83\u4e0d\u9700\u8981\u518d\u53bb\u77e5\u9053\u5b8c\u6574\u7684\u521d\u59cb\u72b6\u6001\u4e86. \u53ea\u9700\u8981\u8ba9\u5b50 reducer \u6765\u8fd4\u56de\u4e00\u4e2a` undefined` \u7684\u521d\u59cb\u72b6\u6001.\n\n\n```\nfunction todos(state = [], action) {\n  switch (action.type) {\n    case ADD_TODO:\n      return [\n        ...state,\n        {\n          text: action.text,\n          completed: false\n        }\n      ]\n    case TOGGLE_TODO:\n      return state.map((todo, index) => {\n        if (index === action.index) {\n          return Object.assign({}, todo, {\n            completed: !todo.completed\n          })\n        }\n        return todo\n      })\n    default:\n      return state\n  }\n}\n\nfunction visibilityFilter(state = SHOW_ALL, action) {\n  switch (action.type) {\n    case SET_VISIBILITY_FILTER:\n      return action.filter\n    default:\n      return state\n  }\n}\n\nfunction todoApp(state = {}, action) {\n  return {\n    visibilityFilter: visibilityFilter(state.visibilityFilter, action),\n    todos: todos(state.todos, action)\n  }\n}\n```\n\n**\u6ce8\u610f**\n\n> \u8fd9\u91cc\u6bcf\u4e00\u4e2a reducer \u4ed6\u4eec\u624b\u91cc\u9762\u7684` state` \u5e76\u4e0d\u662f\u4e00\u6837\u7684,\u4ed6\u4eec\u53ea\u8d1f\u8d23\u4ed6\u4eec\u5404\u81ea\u5bf9\u5e94\u7684 **state\u7247\u6bb5**.\n\n\u5230\u8fd9\u91cc\u770b\u4e0a\u53bb\u5c31\u4e0d\u9519\u4e86. \u5f53\u968f\u7740 app \u4e0d\u65ad\u590d\u6742,\u6211\u4eec\u53ef\u4ee5\u628a reducer \u5206\u5272\u5230\u4e0d\u540c\u7684\u6587\u4ef6\u91cc,\u6700\u540e\u5728\u4e3b reducer \u91cc\u7ec4\u5408\u5c31\u597d. \u800c\u4e14 redux \u63d0\u4f9b\u4e00\u4e2a\u5de5\u5177 -- `combineReducers()` \u901a\u8fc7\u8fd9\u4e2a\u53ef\u4ee5\u66f4\u52a0\u65b9\u4fbf\u7684\u628a\u96f6\u6563\u7684 reducer \u7ec4\u5408\u8d77\u6765,\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u91cd\u6784\u4e4b\u524d\u7684 todoAPP \u5982\u4e0b:\n\n```\nimport { combineReducers } from 'redux'\n\nconst todoApp = combineReducers({\n  visibilityFilter,\n  todos\n})\n\nexport default todoApp\n```\n\n\u8fd8\u6709\u8fd9\u6837\u7684\u5199\u6cd5:\n\n```\nexport default function todoApp(state = {}, action) {\n  return {\n    visibilityFilter: visibilityFilter(state.visibilityFilter, action),\n    todos: todos(state.todos, action)\n  }\n}\n```\n\n\u751a\u81f3\u53ef\u4ee5\u7ed9\u6bcf\u4e00\u4e2a reducer \u6307\u6d3e\u4e0d\u540c\u7684`\u952e`, \u7136\u540e\u8fd9\u6837\u7528:\n\n\n```\nconst reducer = combineReducers({\n  a: doSomethingWithA,\n  b: processB,\n  c: c\n})\nfunction reducer(state = {}, action) {\n  return {\n    a: doSomethingWithA(state.a, action),\n    b: processB(state.b, action),\n    c: c(state.c, action)\n  }\n}\n```\n\n\n\u6240\u6709\u7684` combineReducers()` \u5176\u5b9e\u5c31\u505a\u4e00\u4ef6\u4e8b\u60c5,\u751f\u6210\u4e00\u4e2a\u51fd\u6570,\u7136\u540e\u8ba9\u6bcf\u4e00\u4e2a reducer \u6765\u901a\u8fc7\u4e0d\u540c\u5bf9\u5e94\u7684\u952e\u5229\u7528\u81ea\u5df1\u7684\u4e00\u6bb5 state.\u6700\u540e\u628a\u7ed3\u679c\u5408\u5e76\u8d77\u6765\u8d5b\u9053\u4e00\u4e2a\u5355\u4e2a\u5bf9\u8c61.\n\n\u90fd\u80fd\u5199\u6210\u8fd9\u6837:\n\n>Note for ES6 Savvy Users\n\n>Because combineReducers expects an object, we can put all top-level reducers into a separate file, export each reducer function, and use import * as reducers to get them as an object with their names as the keys:\n\n\n```\nimport { combineReducers } from 'redux'\nimport * as reducers from './reducers'\n\nconst todoApp = combineReducers(reducers)\n```\n\n>Because import * is still new syntax, we don't use it anymore in the documentation to avoid confusion, but you may encounter it in some community examples.\n\n\n\u6700\u7ec8\u7684\u4ee3\u7801\u5982\u4e0b:\n\n```\nimport { combineReducers } from 'redux'\nimport { ADD_TODO, TOGGLE_TODO, SET_VISIBILITY_FILTER, VisibilityFilters } from './actions'\nconst { SHOW_ALL } = VisibilityFilters\n\nfunction visibilityFilter(state = SHOW_ALL, action) {\n  switch (action.type) {\n    case SET_VISIBILITY_FILTER:\n      return action.filter\n    default:\n      return state\n  }\n}\n\nfunction todos(state = [], action) {\n  switch (action.type) {\n    case ADD_TODO:\n      return [\n        ...state,\n        {\n          text: action.text,\n          completed: false\n        }\n      ]\n    case TOGGLE_TODO:\n      return state.map((todo, index) => {\n        if (index === action.index) {\n          return Object.assign({}, todo, {\n            completed: !todo.completed\n          })\n        }\n        return todo\n      })\n    default:\n      return state\n  }\n}\n\nconst todoApp = combineReducers({\n  visibilityFilter,\n  todos\n})\n\nexport default todoApp\n\n```\n\n\u63a5\u4e0b\u6765\u6211\u4eec\u770b\u5982\u4f55\u521b\u5efa\u4e00\u4e2a redux \u7684 `store`, \u5b83\u662f\u5982\u4f55\u5904\u7406` state` \u8fd8\u6709\u5982\u4f55 \u5728\u6307\u6d3e\u4e00\u4e2a action \u4e4b\u540e\u5982\u4f55\u8c03\u7528 reducer.\n\n\n\n###Store\n\n\u4e0a\u9762\u6211\u4eec\u63a5\u89e6\u5230\u5982\u4f55\u5b9a\u4e49 action \u6765\u8868\u793a\u53d1\u751f\u4e86\u4ec0\u4e48\u53d8\u5316, \u8fd8\u6709 **reducer** \u5b83\u662f\u5982\u4f55\u901a\u8fc7\u4e0d\u540c\u7684 action \u6765\u4fee\u6539 app \u7684 state. \n\n\u4e0b\u9762\u6211\u4eec\u8981\u8bf4\u7684` Store` , **Store** \u662f\u4ec0\u4e48,\u4ece\u5b57\u9762\u610f\u601d\u770b\u5b83\u662f\u7528\u6765\u5b58\u50a8\u4ec0\u4e48\u7684, \u5bf9, \u5b83\u5c31\u662f\u5b58\u50a8 `state tree` \u7684. \n\n`Store` \u6709\u8fd9\u6837\u7684\u4f5c\u7528:\n\n- \u7ba1\u7406app\u7684 `state`\n- \u53ef\u4ee5\u901a\u8fc7` getState()`\u6765\u8bbf\u95ee `state`\n- \u901a\u8fc7` dispatch(action)`\u6765\u4fee\u6539 app \u7684` state`\n- \u901a\u8fc7` subscribe(listener)`\u6765\u6ce8\u518c\u76d1\u542c\n- \u5904\u7406\u6ca1\u6709\u6ce8\u518c\u7684\u76d1\u542c\n\n---\n\n\u518d\u6b21\u91cd\u7533: **Redux app** \u7684 `state` \u662f\u4fdd\u6301\u5728\u4e00\u4e2a\u5355\u72ec\u7684\u5bf9\u8c61\u91cc. \u5f53\u9700\u8981\u5206\u5272\u5904\u7406\u6570\u636e\u7684\u903b\u8f91\u65f6, \u5e94\u8be5\u4f7f\u7528`\u590d\u5408 reducer`\u6765\u66ff\u4ee3\u591a\u4e2a store.\n\n---\n\n\u5982\u679c\u4f60\u6709 reducer,\u5f88\u5bb9\u6613\u6765\u521b\u5efa` store`. \u4e0a\u9762\u6211\u4eec\u4f7f\u7528\u4e86`combineReducer()`\u6765\u7ec4\u5408\u591a\u4e2a reducer, \u73b0\u5728\u6211\u4eec\u5f15\u7528\u5b83\u7136\u540e\u628a\u5b83\u4f20\u9012\u7ed9` createStore()`.\n\n```\nimport { createStore } from 'redux'\nimport todoApp from './reducers'\nlet store = createStore(todoApp)\n```\n\n>\u4f60\u53ef\u4ee5\u901a\u8fc7\u4f20\u9012\u4e00\u4e2a\u53ef\u9009\u7684\u53c2\u6570\u7ed9`createStore()`\u6765\u7ed9 **app** \u4e00\u4e2a\u521d\u59cb\u7684\u72b6\u6001,\u7528\u6765\u5904\u7406\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u5668\u7aef\u4e0d\u540c\u7684\u72b6\u6001(\u00d7)\n\n\n```\nlet store = createStore(todoApp, window.STATE_FROM_SERVER)\n```\n\n###\u5206\u53d1\u52a8\u4f5c\n\n\n\u81f3\u6b64, \u6211\u4eec\u5df2\u7ecf\u521b\u5efa\u4e86` Store`, \u8ba9\u6211\u4eec\u6765\u9a8c\u8bc1 app \u662f\u5426\u5de5\u4f5c,\u6211\u4eec\u53ef\u4ee5\u5728\u6ca1**UI** \u7684\u60c5\u51b5\u4e0b\u6d4b\u8bd5\u66f4\u65b0\u903b\u8f91:\n\nimport { addTodo, toggleTodo, setVisibilityFilter, VisibilityFilters } from './actions'\n\n// Log the initial state\nconsole.log(store.getState())\n\n// Every time the state changes, log it\n// Note that subscribe() returns a function for unregistering the listener\nlet unsubscribe = store.subscribe(() =>\n  console.log(store.getState())\n)\n\n// Dispatch some actions\n// \u901a\u8fc7 store.dispatch() \u65b9\u6cd5\u53ef\u4ee5\u6a21\u62df\u7528\u6237\u4ea4\u4e92, \u51fa\u53d1 action\nstore.dispatch(addTodo('Learn about actions'))\nstore.dispatch(addTodo('Learn about reducers'))\nstore.dispatch(addTodo('Learn about store'))\nstore.dispatch(toggleTodo(0))\nstore.dispatch(toggleTodo(1))\nstore.dispatch(setVisibilityFilter(VisibilityFilters.SHOW_COMPLETED))\n\n// Stop listening to state updates\nunsubscribe()\n```\n\n![](http://i.imgur.com/zMMtoMz.png)\n\n> index.js\n\n```\nimport { createStore } from 'redux'\nimport todoApp from './reducers'\n\nlet store = createStore(todoApp)\n```\n\n**\u63a5\u4e0b\u6765\u6211\u4eec\u8981\u4e86\u89e3 redux app \u91cc\u7684\u6570\u636e\u6d41**\n\n\n\u521a\u624d\u8bf4\u5230\u4e86 [Store ](http://qiita.com/xiangzhuyuan/items/9ce23a8c9f3b26c48838)\n\n\u63a5\u4e0b\u6765\u8bf4 **\u6570\u636e\u6d41**\n\nRedux \u4f7f\u7528**\u5355\u5411\u6570\u636e\u6d41**\n\n\u8fd9\u5c31\u610f\u5473\u7740\u5728 app \u91cc\u6240\u6709\u7684\u6570\u636e\u90fd\u4f1a\u7ecf\u8fc7\u540c\u6837 \u7684\u751f\u547d\u5468\u671f\u6a21\u5f0f. \u8ba9\u4f60\u7684\u7a0b\u5e8f\u903b\u8f91\u66f4\u52a0\u53ef\u4ee5\u9884\u6d4b\u548c\u5bb9\u6613\u7406\u89e3.\u5bf9\u4e8e\u6570\u636e\u7684\u5904\u7406\u540c\u6837\u8981\u4f18\u5316\u7cbe\u534e. \u800c\u4e0d\u662f\u8ba9\u4f60\u6b7b\u5728\u591a\u4efd\u540c\u6837\u7684\u6570\u636e, \u4f60\u624b\u91cc\u7684\u6570\u636e\u540c\u6837\u80fd\u591f\u88ab\u4ed6\u4eba\u6765\u4fee\u6539. \u90fd\u4e0d\u77e5\u9053\u81ea\u5df1\u600e\u4e48\u6b7b\u7684.\n\n\u5982\u679c\u8fd8\u662f\u6ca1\u6709\u88ab\u8bf4\u670d,\u5efa\u8bae\u8bfb\u4e00\u4e0b [1](http://redux.js.org/docs/introduction/Motivation.html) [2](https://medium.com/@dan_abramov/the-case-for-flux-379b7d1982c6) \u540c\u65f6\u5efa\u8bae\u8bfb\u4e00\u4e0b[ Redux \u4e0d\u7b80\u5355\u662f Flux \u7684\u53d8\u79cd](http://redux.js.org/docs/introduction/PriorArt.html)\u5b83\u540c\u6837\u8bf4\u660e\u4e86\u4e00\u4e9b\u4e3a\u4ec0\u4e48\u8981\u5355\u5411\u6570\u636e\u6d41\u7684\u597d\u5904.\n\nRedux \u5e94\u7528\u91cc\u7684\u6570\u636e\u5927\u81f4\u4f1a\u8d704\u6b65:\n\n1. \u5f53\u4f60\u8c03\u7528` store.dispatch(action). \u89e6\u53d1\u4e86\u4e00\u4e2a\u52a8\u4f5c.\n\n\u4e00\u4e2a\u52a8\u4f5c\u5c31\u662f\u4e00\u4e2a\u7b80\u5355\u7684\u5bf9\u8c61,\u8bf4\u660e\u4e86\u4f1a\u53d1\u751f\u4ec0\u4e48.\n\n```\n\n { type: 'LIKE_ARTICLE', articleId: 42 }\n { type: 'FETCH_USER_SUCCESS', response: { id: 3, name: 'Mary' } }\n { type: 'ADD_TODO', text: 'Read the Redux docs.' }\n```\n\n\u63cf\u8ff0\u4e86\u4e00\u4e2a\u52a8\u4f5c, \u5df2\u7ecf\u4e00\u4e9b\u53c2\u6570\u7528\u6765\u6307\u660e\u52a8\u4f5c\u4f5c\u7528\u7684\u5bf9\u8c61.\n\u597d\u6bd4\u8fd9\u6837\u8bf4: \u4e00\u4e2a\u52a8\u4f5c\u5c31\u662f'\u67d0\u67d0\u559c\u6b22\u627e\u4e2a\u6587\u7ae0', \u770b redux \u7684\u6587\u7ae0`\u7b49\u7b49.\n\n**\u4f60\u53ef\u4ee5\u5728 redux app \u7684\u4efb\u4f55\u5730\u65b9\u4f7f\u7528` store.dispatch(action), \u5305\u62ec\u7ec4\u4ef6\u6216\u8005 XHR \u7684\u56de\u8c03, \u751a\u81f3\u662f\u4e00\u4e2a\u5faa\u73af\u8c03\u7528.**\n\n2. Redux store \u8c03\u7528\u4f60\u7ed9\u5b83\u7684 reducer \u51fd\u6570\n\n**store \u662f\u4f1a\u4f20\u9012\u4e24\u4e2a\u53c2\u6570\u7ed9` reducer` \u7684. \u7b2c\u4e00\u4e2a\u662f\u5f53\u524d\u7684\u72b6\u6001, \u7b2c\u4e8c\u4e2a\u662f action, \u7136\u540e\u8fd4\u56de action \u4f5c\u7528\u4e4b\u540e\u7684\u6700\u65b0\u72b6\u6001.** \u518d\u6765\u770b\u4e2a\u4f8b\u5b50:\n\n```\n let previousState = { // \u5f53\u524d\u7684\u72b6\u6001\n   visibleTodoFilter: 'SHOW_ALL',  //\u8981\u663e\u793a\u4ec0\u4e48\u7c7b\u578b\n   todos: [  //\u6240\u6709\u7684 todo\n     {\n       text: 'Read the docs.',\n       complete: false\n     }\n   ]\n }\n\n // \u8fd9\u662f\u4e00\u4e2a\u6dfb\u52a0 todo \u7684\u52a8\u4f5c\n let action = {\n   type: 'ADD_TODO',\n   text: 'Understand the flow.'\n }\n\n // \u83b7\u53d6\u6700\u65b0\u7684\u72b6\u6001\n let nextState = todoApp(previousState, action)\n\n\n```\n\n\u4e00\u5b9a\u8981\u4fdd\u8bc1` reducer` \u90fd\u662f **pure** \u7684\u51fd\u6570,\u4e5f\u5c31\u662f\u8bf4\u6bcf\u6b21\u7ed9\u540c\u6837\u7684\u53c2\u6570\u8fd4\u56de\u7ed3\u679c\u90fd\u662f\u4e00\u6837\u7684.\n \n 3. **\u6839 reducer** \u53ef\u4ee5\u7ec4\u5408\u591a\u4e2a reducer \u5230\u4e00\u4e2a\u5355\u72ec\u7684\u72b6\u6001\u6811\u91cc.\n\n\u5982\u4f55\u7ec4\u7ec7*\u6839 reducer *\u5b8c\u5168\u662f\u4e2a\u4eba\u559c\u597d, Redux \u63d0\u4f9b\u4e00\u4e2a` combineReducers()` \u51fd\u6570\u7528\u6765\u5e2e\u52a9\u7ec4\u7ec7\u5206\u6563\u7684 Reducer. \u4e0b\u9762\u518d\u770b\u770b\u4ed6\u4eec\u662f\u5982\u4f55\u88ab\u7ec4\u7ec7\u8d77\u6765\u7684:\n\n\n```\n function todos(state = [], action) {\n   // Somehow calculate it...\n   return nextState\n }\n\n function visibleTodoFilter(state = 'SHOW_ALL', action) {\n   // Somehow calculate it...\n   return nextState\n }\n\n let todoApp = combineReducers({\n   todos,\n   visibleTodoFilter\n })\n```\n\n\u5f53\u4f60\u89e6\u53d1\u4e00\u4e2a\u52a8\u4f5c, \u7136\u540e todoAPP \u5c31\u4f1a\u8c03\u7528\u7531`combineReducers`\u8fd4\u56de\u7684\u5bf9\u5e94\u7684 reducer:\n\n\n```\nlet nextTodos = todos(state.todos, action)\nlet nextVisibleTodoFilter = visibleTodoFilter(state.visibleTodoFilter, action)\n```\n\n\u5176\u5b9e\u4e0a\u9762\u7684\u60c5\u51b5\u5c31\u662f\u8fd4\u56de\n\n```\n return {\n   todos: nextTodos,\n   visibleTodoFilter: nextVisibleTodoFilter\n }\n\n```\n\n4. **Redux Store** \u4f1a\u628a\u6240\u6709\u7684 **reducer** \u8fd4\u56de\u7684 state \u5199\u4f1a\u5355\u72ec\u5b8c\u6574\u7684 state \u91cc.\n\n \n\u81f3\u6b64,\u7b97\u662f\u6211\u4eec\u5df2\u7ecf\u5b8c\u6210\u7684 backend \u903b\u8f91, \u63a5\u4e0b\u6765\u6211\u4eec\u4f1a\u5b66\u4e60\u5982\u4f55\u7ed3\u5408` react` \u5b8c\u5168 UI \u90e8\u5206.\n\n\n### \u4f7f\u7528 React\n\n\u8fd9\u91cc\u8bf4\u660e\u7684\u5c31\u662f\u5176\u5b9e Redux \u5b83\u5b8c\u6210\u7684\u903b\u8f91\u662f\u4e0d\u9650\u4e8e react \u6765\u5b8c\u6210 UI \u90e8\u5206\u7684. \u4f60\u5b8c\u5168\u53ef\u4ee5\u4f7f\u7528\u5982`Angular` `Ember` \u6216\u8005` jQuery` \u7b49 frontend \u6846\u67b6\u6765\u5199. \u800c\u53ea\u662f Redux \u53ef\u4ee5\u66f4\u597d\u5730\u548c react \u6216\u8005 deku \u7ed3\u5408\u4f7f\u7528. \u56e0\u4e3a\u4ece react \u4ed6\u4eec\u7684\u6982\u5ff5\u5b9a\u4e49\u6765\u8bf4, \u63cf\u8ff0 UI \u7684\u8fc7\u7a0b\u5c31\u662f\u5728\u8bf4\u660e\u4e00\u4e2a\u72b6\u6001\u7684\u51fd\u6570. \u548c Redux \u54cd\u5e94\u4e00\u4e2a\u52a8\u4f5c\u51fa\u53d1\u72b6\u6001\u66f4\u65b0. \n\n\u63a5\u4e0b\u6765\u6211\u4eec\u4f7f\u7528 react \u6765\u6784\u5efa\u8fd9\u4e2a todoapp \u7684 UI \u90e8\u5206.\n\n#### \u5b89\u88c5 react redux\n\n[react \u7ed1\u5b9a](https://github.com/reactjs/react-redux) \u662f\u5355\u72ec\u4e0e redux \u5b58\u5728,\u6211\u4eec\u73b0\u5728\u5b89\u88c5\u5b83:\n\n```\nnpm install --save react-redux\n```\n\n\n\n> If you don't use npm, you may grab the latest UMD build from unpkg (either a development or a production build). \n> The UMD build exports a global called window.\n> ReactRedux if you add it to your page via a \\<script\\> tag.\n\n\n### \u5c55\u793a\u5bb9\u5668\u7ec4\u4ef6(\u7528\u6765\u753b UI, \u65e0\u903b\u8f91)\n\n**React redux \u7ed1\u5b9a**\u5c01\u88c5\u4e86`\u5c55\u793a\u548c\u5bb9\u5668\u7ec4\u4ef6\u5206\u79bb`\u7684\u6982\u5ff5. [\u82e5\u4e0d\u719f\u6089\u5148\u8bfb\u5b83](https://medium.com/@dan_abramov/smart-and-dumb-components-7ca2f9a7c7d0),\n\n\u5f88\u91cd\u8981,\u53ef\u4ee5\u79bb\u5f00\u653e\u4e0b\u8fd9\u91cc,\u7b49\u4f60.\n\n\n\u56de\u6765...\n\n\u6211\u4eec\u603b\u7ed3\u4e0b\u6709\u4ec0\u4e48\u4e0d\u540c\u4e4b\u5904:\n\n| \\   |\u5c55\u793a\u7ec4\u4ef6|\u5bb9\u5668\u7ec4\u4ef6|\n|:--:|:-----:|:----:|\n|\u76ee\u7684|\u770b\u4e0a\u53bb\u50cf\u4ec0\u4e48|\u4ed6\u4eec\u662f\u600e\u4e48\u5de5\u4f5c\u7684|\n|\u548c Redux\u901a\u4fe1|\u4e0d|\u662f|\n|\u600e\u4e48\u8bfb\u53d6\u6570\u636e|\u4ece\u5c5e\u6027 props|\u8ba2\u9605 redux \u7684\u72b6\u6001|\n|\u600e\u4e48\u4fee\u6539\u6570\u636e|\u901a\u8fc7\u5c5e\u6027\u91cc\u7684\u56de\u8c03|\u89e6\u53d1 redux \u7684\u52a8\u4f5c|\n|\u8c01\u5199\u7684|\u81ea\u5df1\u7528\u624b|\u901a\u5e38\u7531react redux \u4f1a\u751f\u6210|\n\n\n\u6211\u4eec\u9700\u8981\u5904\u7406\u7684\u5927\u90e8\u5206\u7684\u90fd\u662f\u5c55\u793a\u7ec4\u4ef6, \u5f53\u7136\u4e5f\u8981\u5904\u7406\u4e00\u4e9b\u5bb9\u5668\u7ec4\u4ef6, \u4ed6\u4eec\u7528\u6765\u548c` reudx store` \u8fde\u63a5\u8d77\u6765.\n\n\u6280\u672f\u4e0a\u6765\u8bf4, \u4f60\u53ef\u4ee5\u901a\u8fc7\u8c03\u7528` store.subscribe()`\u6765\u5199\u5bb9\u5668\u7ec4\u4ef6,\u4f46\u662f\u4e0d\u5efa\u8bae\u4f60\u90a3\u6837\u505a.\n\u56e0\u4e3a` React redux` \u901a\u5e38\u4f1a\u505a\u5f88\u591a\u7684\u4f18\u5316, \u4ed6\u4eec\u90fd\u662f\u624b\u52a8\u65e0\u6cd5\u5b8c\u6210\u7684. \n\u56e0\u4e3a\u8fd9\u4e2a, \u6211\u4eec\u66f4\u52a0\u8d8b\u5411\u4e8e\u901a\u8fc7\u4f7f\u7528 react-reudx \u7684` connect()` \u51fd\u6570\u6765\u751f\u6210\u4ed6\u4eec.\n\n###\u8bbe\u8ba1\u7ec4\u4ef6\u4f53\u7cfb\u7ed3\u6784\n\n\u4e4b\u524d\u6211\u4eec\u540c\u6837\u9047\u5230\u4e00\u4e2a\u73af\u8282\u5c31\u662f\u5728[\u52a8\u624b\u4e4b\u524d\u8bbe\u8ba1\u6211\u4eec\u7684 state \u4f53\u7cfb](http://redux.js.org/docs/basics/Reducers.html). \u73b0\u5728\u6211\u4eec\u8981\u8bbe\u8ba1\u5982\u4f55\u7ec4\u7ec7 UI \u7ed3\u6784\u4e86. \u8fd9\u91cc\u5c31\u4e0d\u662f redux \u7684\u8303\u7574\u4e86. \u53ef\u4ee5\u901a\u8fc7[\u5982\u4f55\u4f7f\u7528 react](https://facebook.github.io/react/docs/thinking-in-react.html) \u6765\u5b66\u4e60\u7406\u89e3\u5982\u4f55\u5904\u7406.\n\n\u6211\u4eec\u5728\u8fd9\u91cc\u7684\u8bbe\u8ba1\u5f88\u7b80\u5355\u4e86, \u6211\u4eec\u8981\u663e\u793a\u4e00\u4e2a todo \u7684 list. \u70b9\u51fb todo \u7684 item, \u5b83\u5c31\u6807\u8bb0\u4e3a\u5b8c\u6210. \u800c\u4e14\u53ef\u4ee5\u8fc7\u6ee4\u663e\u793a\u6ca1\u6709\u5b8c\u6210\u7684,\u6216\u8005\u5df2\u7ecf\u5b8c\u6210\u7684.\n\n---\n\n####\u5c55\u793a\u7ec4\u4ef6\n\n\u901a\u8fc7\u4e0a\u9762\u5927\u81f4\u7684\u8bb2\u8ff0,\u6211\u73b0\u5728\u8111\u6d77\u91cc\u5c31\u662f\u8fd9\u6837\u4e00\u4e9b\u4e1c\u897f\u6d6e\u73b0;\n\n- TodoList \u7528\u6765\u8868\u793a\u53ef\u89c1\u7684 todo \u5217\u8868\n\t- todos:Array \u5c31\u662f\u4e00\u7ec4 todo \u7684 item, \u5927\u6982\u5185\u5bb9\u5c31\u662f {id,text,completed}.\n\t- onTodoClick(id:number) \u662f\u4e00\u4e2a\u56de\u8c03\u5f53\u4e00\u4e2a todo \u7684 item \u88ab\u70b9\u51fb\u7684\u65f6\u5019.\n\n- Todo \u5c31\u662f\u8868\u793a\u4e00\u4e2a\u5355\u72ec\u7684 todo\n\t- text:string \u5f53\u524d todo \u7684\u5185\u5bb9\n\t- completed:boolean \u5f53\u524d\u662f\u5426\u6807\u8bb0\u4e3a\u5b8c\u6210\n\t- onClick() \u662f\u4e00\u4e2a\u56de\u8c03, \u5f53\u5728 item \u88ab\u70b9\u51fb\u7684\u65f6\u5019\u89e6\u53d1\n\n- Link \u56de\u8c03\u7528\n\t- onClick() link \u5728\u88ab\u70b9\u51fb\u540e\u89e6\u53d1\u7684\u56de\u8c03\n\n- Footer \u7528\u6765\u663e\u793a\u4ec0\u4e48\u72b6\u6001\u7684 toggle\n- App \u5c31\u662f\u5f53\u524d app \u7684\u6839\u5143\u7d20\n\n\u4ed6\u4eec\u5b8c\u5168\u4e0d\u4f9d\u8d56redux, \u5f53\u4f60\u628a redux \u8fc1\u79fb\u5230\u5176\u4ed6\u7684\u6846\u67b6\u4e0a\u65f6, \u8fd9\u4e9b\u4e1c\u897f\u5b8c\u5168\u4e0d\u9700\u8981\u4fee\u6539. \u4ed6\u4eec\u53ea\u662f\u7528\u6765\u6e32\u67d3\u4f60\u60f3\u8981\u5728 UI \u4e0a\u770b\u5230\u7684\u4e1c\u897f\n\n---\n\n#### \u5bb9\u5668\u7ec4\u4ef6\n\n\u5bb9\u5668\u7ec4\u4ef6\u5728\u8fd9\u91cc\u5145\u5f53\u7684\u89d2\u8272\u5c31\u662f\u7528\u5b83\u6765\u8fde\u63a5\u5c55\u793a\u7ec4\u4ef6\u548c redux, \u8ba9redux \u7684\u6570\u80fd\u5bf9\u5e94\u7684\u663e\u793a\u5728\u5c55\u793a\u7ec4\u4ef6\u4e0a. \u6bd4\u5982\u521a\u624d\u5b9a\u4e49\u7684\u5c55\u793a\u7ec4\u4ef6` TodoList` \u7ec4\u4ef6\u5b83\u5c31\u9700\u8981\u4e00\u4e2a\u5bb9\u5668\u6bd4\u5982\u53eb` VisibleTodoList`, \u7136\u540e\u8ba9\u5b83\u8ba2\u9605\u5230` Redux store`\u91cc\u7684\u5f53\u524d\u5bf9\u5e94\u53ef\u89c1\u7684` todo`, \u4e3a\u4e86\u4fee\u6539\u53ef\u89c1\u8fc7\u6ee4\u5668,\u6211\u4eec\u9700\u8981\u4e00\u4e2a\u6bd4\u5982` FilterLink` \u7684\u5bb9\u5668\u6765\u5b8c\u6210\u6e32\u67d3\u4e00\u4e2a`Link` \u6765\u8ba9\u5b83\u5b8c\u6210\u4e00\u4e2a\u52a8\u4f5c\u7684\u89e6\u53d1\u5f53\u70b9\u51fb\u5b83\u7684\u65f6\u5019:\n\n- VisibleTodoList \u901a\u8fc7\u5f53\u524d\u7684\u663e\u793a\u8fc7\u6ee4\u6761\u4ef6\u62ff\u5230 todo list\n- FilterLink \u83b7\u53d6\u5f53\u524d\u7684\u8fc7\u6ee4\u6761\u4ef6\u7136\u540e\u6e32\u67d3\u4e00\u4e2a link\n\t- Filter:string \n\n\n####\u5176\u4ed6\u7ec4\u4ef6\n\n\u6709\u65f6\u5019\u5f88\u96be\u754c\u5b9a\u5b83\u5230\u5e95\u662f\u5c55\u793a\u7ec4\u4ef6\u8fd8\u662f\u5bb9\u5668\u7ec4\u4ef6. \u4f8b\u5982\u6709\u65f6\u5019\u4e00\u4e2a\u8868\u5355\u6216\u8005\u4e00\u4e2a\u51fd\u6570\u4ed6\u4eec\u7cbe\u5bc6\u7684\u7f20\u7ed5,\u5982\n\n- AddTodo \u5c31\u662f\u4e00\u4e2a\u8f93\u5165\u6846\u52a0\u4e00\u4e2a`\u6dfb\u52a0`\u6309\u94ae\n\n\u6280\u672f\u4e0a\u8bb2\u6211\u4eec\u53ef\u4ee5\u628a\u4ed6\u4eec\u5206\u5f00,\u4f46\u662f\u5462\u73b0\u5728\u8fd9\u4e2a\u521d\u7ea7\u9636\u6bb5\u6211\u4eec\u6700\u597d\u628a\u5b83\u6df7\u5408\u5728\u4e00\u8d77. \u56e0\u4e3a\u7ec4\u4ef6\u7684\u903b\u8f91\u4e5f\u4e0d\u662f\u5f88\u9ebb\u70e6, \u968f\u7740 app \u7684\u6210\u957f,\u5982\u4f55\u5206\u5272\u4ed6\u4eec\u5c31\u53d8\u5f97\u8d8a\u6765\u8d8a\u660e\u663e.\n\n\n### \u52a8\u624b\u5b9e\u73b0\u7ec4\u4ef6\n\n\u6211\u4eec\u5148\u4ece`\u5c55\u793a\u7ec4\u4ef6`\u5f00\u59cb,\u56e0\u4e3a\u6211\u4eec\u4e0d\u9700\u8981\u8003\u8651\u5982\u4f55\u548c redux \u8054\u7cfb\u8d77\u6765.\n\n####\u5c55\u793a\u7ec4\u4ef6\n\n\u8fd9\u4e9b\u90fd\u662f\u666e\u901a\u7684 React \u7ec4\u4ef6.\u6211\u4eec\u4e5f\u4e0d\u4f1a\u6d89\u53ca\u592a\u591a,\u5c31\u662f\u5199\u4e00\u4e9b\u65e0\u72b6\u6001\u7684\u7eaf\u51fd\u6570.\n\n\u9664\u975e\u6211\u4eec\u8fd8\u9700\u8981\u4e00\u4e9b\u672c\u5730\u7684\u72b6\u6001\u6216\u8005\u751f\u547d\u5468\u671f\u7684\u65b9\u6cd5.\u5f53\u7136\u4e5f\u4e0d\u662f\u8bf4\u7ec4\u4ef6\u5fc5\u987b\u662f\u51fd\u6570.\u53ea\u662f\u7528\u51fd\u6570\u7b80\u5355.\n\n\u5982\u4f55\u4f60\u4e4b\u540e\u8bbe\u8ba1\u5230\u672c\u5730\u72b6\u6001,\u751f\u547d\u5468\u671f\u7684\u65b9\u6cd5,\u6216\u8005\u6027\u80fd\u4f18\u5316\u7684\u65f6\u5019\u53ef\u4ee5\u628a\u5b83\u4eec\u5199\u6210`\u7c7b`.\n\n \n```components/Todo.js\n\nimport React, { PropTypes } from 'react'\n// \u5b9a\u4e49\u5355\u4e2a todo \u5bf9\u8c61\n// \u9700\u89813\u4e2a\u53c2\u6570,1 click\u4e8b\u4ef6, 2 \u662f\u5426\u5b8c\u6210, 3 \u663e\u5f0f\u6587\u672c\nconst Todo = ({ onClick, completed, text }) => (\n  <li onClick={onClick} style={{ textDecoration: completed ? 'line-through' : 'none' }} > {text} </li>\n)\n\n// \u9a8c\u8bc13\u4e2a\u53c2\u6570\nTodo.propTypes = {\n  onClick: PropTypes.func.isRequired,\n  completed: PropTypes.bool.isRequired,\n  text: PropTypes.string.isRequired\n}\n\nexport default Todo\n```\n\n\n\n\n```components/TodoList.js\nimport React, { PropTypes } from 'react'\nimport Todo from './Todo'\n\nconst TodoList = ({ todos, onTodoClick }) => (\n  <ul>\n    {todos.map(todo =>\n      <Todo\n        key={todo.id}\n        {...todo}\n        onClick={() => onTodoClick(todo.id)}\n      />\n    )}\n  </ul>\n)\n\nTodoList.propTypes = {\n  todos: PropTypes.arrayOf(PropTypes.shape({\n    id: PropTypes.number.isRequired,\n    completed: PropTypes.bool.isRequired,\n    text: PropTypes.string.isRequired\n  }).isRequired).isRequired,\n  onTodoClick: PropTypes.func.isRequired\n}\n\nexport default TodoList\n```\n\n\n\n```components/link.js\nimport React, { PropTypes } from 'react'\n\nconst Link = ({ active, children, onClick }) => {\n  if (active) {\n    return <span>{children}</span>\n  }\n\n  return (\n    <a href=\"#\"\n       onClick={e => {\n         e.preventDefault()\n         onClick()\n      }}\n    >\n      {children}\n    </a>\n  )\n}\n\nLink.propTypes = {\n  active: PropTypes.bool.isRequired,\n  children: PropTypes.node.isRequired,\n  onClick: PropTypes.func.isRequired\n}\n\nexport default Link\n```\n\n\n```components/Footer.js\nimport React from 'react'\nimport FilterLink from '../containers/FilterLink'\n\nconst Footer = () => (\n  <p>\n    Show:\n    {\" \"}\n    <FilterLink filter=\"SHOW_ALL\">\n      All\n    </FilterLink>\n    {\", \"}\n    <FilterLink filter=\"SHOW_ACTIVE\">\n      Active\n    </FilterLink>\n    {\", \"}\n    <FilterLink filter=\"SHOW_COMPLETED\">\n      Completed\n    </FilterLink>\n  </p>\n)\n\nexport default Footer\n```\n\n\n\n```components/App.js\nimport React from 'react'\nimport Footer from './Footer'\nimport AddTodo from '../containers/AddTodo'\nimport VisibleTodoList from '../containers/VisibleTodoList'\n\nconst App = () => (\n  <div>\n    <AddTodo />\n    <VisibleTodoList />\n    <Footer />\n  </div>\n)\n\nexport default App\n```\n\n#### \u5bb9\u5668\u7ec4\u4ef6\n\n\u73b0\u5728\u662f\u65f6\u5019\u628a\u8fd9\u4e9b\u89c6\u56fe\u7ec4\u4ef6 hook \u5230 redux \u91cc\u901a\u8fc7\u521b\u5efa\u4e00\u4e9b\u5bb9\u5668\u7ec4\u4ef6. \u6280\u672f\u4e0a\u6765\u8bf4, \u4e00\u4e2a\u5bb9\u5668\u7ec4\u4ef6\u5c31\u662f\u4e00\u4e2a React \u7684\u7ec4\u4ef6( component), \u4ed6\u4eec\u901a\u8fc7\u4f7f\u7528` store.subscribe()`\u6765\u8bfb\u53d6` Redux` \u72b6\u6001\u6811\u4e2d\u7684\u90e8\u5206\u72b6\u6001\u6570\u636e,\u7136\u540e\u7ed9\u89c6\u56fe\u7ec4\u4ef6\u7684` props` \u5bf9\u8c61,\u4e4b\u540e\u5c55\u793a\u7684\u8fc7\u7a0b\u548c\u903b\u8f91. \u4f60\u53ef\u4ee5\u624b\u6572\u4e00\u4e2a\u5bb9\u5668\u7ec4\u4ef6, \u4f46\u662f\u4e0d\u5efa\u8bae\u8fd9\u4e48\u505a\u6709\u70b9\u50bb,\u5efa\u8bae\u4f60\u901a\u8fc7\u4f7f\u7528 react redux \u7684\u5e93\u63d0\u4f9b\u7684` connect()` \u51fd\u6570\u6765\u751f\u6210\u8fd9\u4e9b\u5bb9\u5668\u7ec4\u4ef6.\u4ed6\u4eec\u540c\u65f6\u63d0\u4f9b\u4e86\u5f88\u591a\u4f18\u5316\u6765\u9632\u6b62\u91cd\u590d\u6ca1\u7528\u7684\u6e32\u67d3.\n\n \u4e3a\u4e86\u4f7f\u7528` connect()`,\u4f60\u9700\u8981\u5b9a\u4e49\u4e00\u4e2a\u7279\u6b8a\u7684\u51fd\u6570\u540d\u5b57\u53eb\u505a` mapStateToProps`, \u5b83\u7684\u4f5c\u7528\u5c31\u662f\u544a\u8bc9\u5f53\u524d\u7684 app \u5982\u4f55\u628a redux \u91cc\u7684\u7279\u5b9a\u7684\u72b6\u6001\u7247\u6bb5\u5bf9\u5e94\u5230\u7279\u5b9a\u7ec4\u4ef6\u7684` props` \u5c5e\u6027\u4e0a.\u4e3e\u4e2a\u4f8b\u5b50, `VisibleTodoList` \u9700\u8981\u8ba1\u7b97` todos`, \u628a\u5b83\u4f20\u7ed9` TodoList`. \u6240\u4ee5\u6211\u4eec\u9700\u8981\u5b9a\u4e49\u4e00\u4e2a\u51fd\u6570,\u5b83\u80fd\u591f\u8fc7\u6ee4\u51fa` state.todos`, \u901a\u8fc7` state.visibilityFilter`, \u4e4b\u540e\u5728` mapStateToProps` \u91cc\u662f\u8fd9\u6837\u7684:\n \n```\nconst getVisibleTodos = (todos, filter) => {\n  switch (filter) {\n    case 'SHOW_ALL':\n      return todos\n    case 'SHOW_COMPLETED':\n      return todos.filter(t => t.completed)\n    case 'SHOW_ACTIVE':\n      return todos.filter(t => !t.completed)\n  }\n}\n\nconst mapStateToProps = (state) => {\n  return {\n    todos: getVisibleTodos(state.todos, state.visibilityFilter)\n  }\n}\n```\n\n\u9664\u4e86\u8bfb\u53d6 redux \u7684\u72b6\u6001,\u5bb9\u5668\u7ec4\u4ef6\u8fd8\u53ef\u4ee5\u5206\u53d1\u52a8\u4f5c. \u901a\u5e38\u6d41\u884c\u7684\u5199\u6cd5\u662f\u4f60\u53ef\u4ee5\u5b9a\u4e49\u4e00\u4e2a` mapDispatchToProps()`\u51fd\u6570.\u4ed6\u53ef\u4ee5\u63a5\u6536\u4e00\u4e2a`dispatch()` \u65b9\u6cd5,\u7136\u540e\u8fd4\u56de\u4e00\u4e2a\u56de\u8c03\u53c2\u6570, \u8fd9\u4e2a\u56de\u8c03\u53c2\u6570\u5c31\u662f\u4f60\u60f3\u8981 hook\u5230\u89c6\u56fe\u7ec4\u4ef6\u4e2d\u7684. \u4f8b\u5982, \u6211\u4eec\u60f3\u8981\u628a` VisibleTodoList` \u6ce8\u5165\u4e00\u4e2a` onTodoClick` \u7684\u5c5e\u6027\u5230` TodoList` \u7684\u7ec4\u4ef6.\u800c\u4e14\u8fd9\u4e2a` onTodoClick`\u8fd8\u53ef\u4ee5\u65b9\u6cd5` TOGGLE_TODO` \u7684\u52a8\u4f5c:\n\n```\nconst mapDispatchToProps = (dispatch) => {\n  return {\n    onTodoClick: (id) => {\n      dispatch(toggleTodo(id))\n    }\n  }\n}\n```\n\n\u6700\u7ec8,\u6211\u4eec\u901a\u8fc7\u8c03\u7528` connect()` \u4f20\u90122\u4e2a\u53c2\u6570, \u521b\u5efa\u4e86` VisibleTodoList`\u5bf9\u8c61.\n\n```\nimport { connect } from 'react-redux'\n\nconst VisibleTodoList = connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(TodoList)\n\nexport default VisibleTodoList\n```\n\n\u8fd9\u4e9b\u90fd\u662f React redux \u57fa\u672c\u7684 API, \u4f46\u662f\u8fd8\u6709\u5f88\u591a\u65b9\u4fbf\u597d\u7528\u7684\u65b9\u6cd5\u6240\u4ee5[\u5efa\u8bae\u4f60\u9605\u8bfb\u5b83\u7684\u6587\u6863](https://github.com/reactjs/react-redux),\u5982\u679c\u4f60 \u7ecf\u5e38\u62c5\u5fc3` mapStateToProps`\u521b\u5efa\u65b0\u7684\u5bf9\u8c61,\u4f60\u53ef\u4ee5\u5b66\u4e60[computing derived data](http://redux.js.org/docs/recipes/ComputingDerivedData.html) with [reselect](https://github.com/reactjs/reselect).\n\n\n\u63a5\u4e0b\u6765\u662f\u5168\u90e8\u7684\u5bb9\u5668\u7ec4\u4ef6\u7684\u4ee3\u7801:\n\n\n```containers/FilterLink.js\n\nimport { connect } from 'react-redux'\nimport { setVisibilityFilter } from '../actions'\nimport Link from '../components/Link'\n\nconst mapStateToProps = (state, ownProps) => {\n  return {\n    active: ownProps.filter === state.visibilityFilter\n  }\n}\n\nconst mapDispatchToProps = (dispatch, ownProps) => {\n  return {\n    onClick: () => {\n      dispatch(setVisibilityFilter(ownProps.filter))\n    }\n  }\n}\n\nconst FilterLink = connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(Link)\n\nexport default FilterLink\n```\n\n\n\n```containers/VisibleTodoList.js\nimport { connect } from 'react-redux'\nimport { toggleTodo } from '../actions'\nimport TodoList from '../components/TodoList'\n\nconst getVisibleTodos = (todos, filter) => {\n  switch (filter) {\n    case 'SHOW_ALL':\n      return todos\n    case 'SHOW_COMPLETED':\n      return todos.filter(t => t.completed)\n    case 'SHOW_ACTIVE':\n      return todos.filter(t => !t.completed)\n  }\n}\n\nconst mapStateToProps = (state) => {\n  return {\n    todos: getVisibleTodos(state.todos, state.visibilityFilter)\n  }\n}\n\nconst mapDispatchToProps = (dispatch) => {\n  return {\n    onTodoClick: (id) => {\n      dispatch(toggleTodo(id))\n    }\n  }\n}\n\nconst VisibleTodoList = connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(TodoList)\n\nexport default VisibleTodoList\n```\n\n###\u5176\u4ed6\u7684\u7ec4\u4ef6\n\n \n```containers/AddTodo.js\n\nimport React from 'react'\nimport { connect } from 'react-redux'\nimport { addTodo } from '../actions'\n\nlet AddTodo = ({ dispatch }) => {\n  let input\n\n  return (\n    <div>\n      <form onSubmit={e => {\n        e.preventDefault()\n        if (!input.value.trim()) {\n          return\n        }\n        dispatch(addTodo(input.value))\n        input.value = ''\n      }}>\n        <input ref={node => {\n          input = node\n        }} />\n        <button type=\"submit\">\n          Add Todo\n        </button>\n      </form>\n    </div>\n  )\n}\nAddTodo = connect()(AddTodo)\n\nexport default AddTodo\n```\n\n###\u4f20\u9012 Store\n\n\u6240\u6709\u7684\u5bb9\u5668\u7ec4\u4ef6\u90fd\u80fd\u591f\u8bbf\u95ee Redux \u7684 store, \u6240\u4ee5\u4ed6\u4eec\u53ef\u4ee5\u8ba2\u9605\u5b83. \u6709\u4e2a\u65b9\u6cd5\u5c31\u662f\u53ef\u4ee5\u628a\u5b83\u5f53\u505a\u4e00\u4e2a\u53c2\u6570 prop \u4f20\u9012\u7ed9\u6bcf\u4e00\u4e2a\u5bb9\u5668\u7ec4\u4ef6. \u4f46\u662f\u8fd9\u6837\u5f88\u65e0\u804a,\u4f60\u9700\u8981\u628a\u5b83\u5728\u6240\u6709\u89c6\u56fe\u7ec4\u4ef6\u4e2d\u4f20\u9012?\n\u5c31\u662f\u56e0\u4e3a\u4ed6\u4eec\u5728\u7ec4\u4ef6\u6811\u91cc\u5f88\u6df1\u7684\u4f4d\u7f6e\u54e6.?**\u4e0d\u61c2**\n\n\u6211\u4eec\u63a8\u8350\u7684\u4e00\u4e2a\u65b9\u6cd5\u5c31\u662f\u4f7f\u7528\u4e00\u4e2a\u7279\u6b8a\u7684 react redux \u7ec4\u4ef6\u53eb\u505a` <Provider>`,\u5b83\u53ef\u4ee5\u5f88\u9b54\u6027\u7684\u8ba9 `store `\u53d8\u5f97\u5728\u6240\u6709\u7684\u5bb9\u5668\u7ec4\u4ef6\u4e2d\u53ef\u89c1, \u800c\u4e0d\u9700\u8981\u518d\u53bb\u663e\u793a\u7684\u4f20\u9012\u5b83, \u56e0\u4e3a\u4f60\u53ea\u9700\u8981\u5728\u6839\u7ec4\u4ef6\u91cc\u5f15\u7528\u4e00\u6b21.\n\n\n\n```index.js\n\nimport React from 'react'\nimport { render } from 'react-dom'\nimport { Provider } from 'react-redux'\nimport { createStore } from 'redux'\nimport todoApp from './reducers'\nimport App from './components/App'\n\nlet store = createStore(todoApp)\n\nrender(\n  <Provider store={store}>\n    <App />\n  </Provider>,\n  document.getElementById('root')\n)\n\n```\n\n\u5230\u8fd9\u91cc, \u4e00\u4e2a` todo` app \u4e5f\u5c31\u5b8c\u4e8b\u513f, \u6211\u4eec\u56de\u8fc7\u5934\u6765\u91cd\u65b0\u67e5\u770b\u5b83\u7684\u6e90\u7801, \u5bf9\u6bd4\u4e0a\u9762\u6211\u4eec\u6240\u8bb2\u89e3\u8fc7\u7684\u4e00\u5207. \u518d\u53bb\u611f\u53d7\u5982\u4f55 build \u4e00\u4e2aredux-react app.\n\n-THE END-\n\n", "tags": ["React", "redux"]}