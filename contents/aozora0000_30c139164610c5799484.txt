{"context": "\u5272\u3068\u4ee5\u524d\u306bminio\u30b5\u30fc\u30d0\u30fc\u306b\u3055\u308f\u3063\u305f\u3093\u3067\u3059\u304c\u3001\u30ea\u30d9\u30f3\u30b8\u30de\u30c3\u30c1\uff01\n\u3068\u3044\u3046\u4e8b\u3067\u3001\u4eca\u56de\u306fLaravel5.2\u304b\u3089Storage\u30d5\u30a1\u30b5\u30fc\u30c9\u3092\u7d4c\u7531\u3057\u3066Minio\u30b5\u30fc\u30d0\u30fc\u306b\u63a5\u7d9a\u3057\u305f\u3044\u3068\u601d\u3044\u307e\u3059\u3002\n\n\u6e96\u5099\n\nminio\nLaravel5.2\n\n\u5c1a\u3001Laravel\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u306f\u6e08\u3093\u3067\u3044\u308b\u7269\u3068\u3057\u3066\u9032\u3081\u307e\u3059\u3002\n\nminio\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\nhttps://github.com/minio/minio\n\nMac\u5229\u7528\u306a\u3089https://github.com/minio/minio#os-x\n\nLinux\u5229\u7528\u306a\u3089https://github.com/minio/minio#gnulinux\n\nWindows\u5229\u7528\u306a\u3089https://github.com/minio/minio#microsoft-windows\n\n\n\u3092\u4f7f\u3063\u3066\u304f\u3060\u3055\u3044\u3002\n\nminio\u30b5\u30fc\u30d0\u30fc\u7acb\u3061\u4e0a\u3052\nminio server [\u30d5\u30a1\u30a4\u30eb\u683c\u7d0d\u30c7\u30a3\u30ec\u30af\u30c8\u30ea]\n\n\u3053\u308c\u3067\u8d77\u52d5\u3057\u307e\u3059\u3002\nvagrant\u306e\u5834\u5408\u306f\nminio server /vagrant/storages/\n\n\u3060\u3068\u30db\u30b9\u30c8PC\u304b\u3089\u30d5\u30a1\u30a4\u30eb\u3092\u76f4\u3067\u30c1\u30a7\u30c3\u30af\u51fa\u6765\u308b\u306e\u3067\u30aa\u30b9\u30b9\u30e1\u3067\u3059\u3002\n\nFilesystem/S3\u30a2\u30c0\u30d7\u30bf\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\nphp composer require league/flysystem-aws-s3-v3\n\n\u4eca\u56de\u306faws-php-sdk\u306eversion3\u3092\u5229\u7528\u3057\u307e\u3059\u3002\n\nMinioStorageServiceProvider\u306e\u4f5c\u6210\nphp artisan make:provider MinioStorageServiceProvider\n\n\u3053\u308c\u3067app/Providers\u4ee5\u4e0b\u306bMinioStorageServiceProvider\u304c\u8a2d\u7f6e\u3055\u308c\u3066\u3044\u307e\u3059\u3002\n\u4ee5\u4e0b\u306e\u3088\u3046\u306b\n\nMinioStorageServiceProvider.php\n<?php\nnamespace App\\Providers;\n\n\nuse Aws\\S3\\S3Client;\nuse Illuminate\\Support\\ServiceProvider;\nuse League\\Flysystem\\AwsS3v3\\AwsS3Adapter;\nuse League\\Flysystem\\Filesystem;\n\nclass MinioStorageServiceProvider extends ServiceProvider\n{\n    public function boot()\n    {\n        \\Storage::extend('minio', function ($app, $config) {\n            $client = new S3Client([\n                'credentials' => [\n                    'key'    => $config[\"key\"],\n                    'secret' => $config[\"secret\"]\n                ],\n                'region'      => $config[\"region\"],\n                'version'     => \"latest\",\n                'endpoint'    => $config[\"endpoint\"],\n            ]);\n            return new Filesystem(new AwsS3Adapter($client, $config[\"bucket\"]));\n        });\n    }\n\n    /**\n     * Register the service provider.\n     *\n     * @return void\n     */\n    public function register()\n    {\n\n    }\n}\n\n\n\nStorage\u30d5\u30a1\u30b5\u30fc\u30c9\u3092\u74b0\u5883\u3067\u5207\u308a\u66ff\u3048\u3089\u308c\u308b\u3088\u3046\u306b\u3059\u308b\n\nconfig/filesystem.php\nreturn [\n    'default' => env(\"FILE_SYSTEM\", \"local\"),\n    'cloud' => 's3',\n    'disks' => [\n        'local' => [\n            'driver' => 'local',\n            'root' => storage_path('app'),\n        ],\n        'public' => [\n            'driver' => 'local',\n            'root' => storage_path('app/public'),\n            'visibility' => 'public',\n        ],\n        's3' => [\n            'driver' => 's3',\n            'key' => env(\"S3_ACCESS_KEY\"),\n            'secret' => env(\"S3_ACCESS_SECRET\"),\n            'region' => env(\"S3_ACCESS_REGION\"),\n            'bucket' => env(\"S3_BUCKET_NAME\"),\n        ],\n        'minio' => [\n            'driver' => 'minio',\n            'key' => env(\"S3_ACCESS_KEY\"),\n            'secret' => env(\"S3_ACCESS_SECRET\"),\n            'region' => env(\"S3_ACCESS_REGION\"),\n            'bucket' => env(\"S3_BUCKET_NAME\"),\n            'endpoint' => env(\"S3_ACCESS_ENDPOINT\"),\n        ]\n    ],\n];\n\n\n\u3053\u308c\u3067Storage\u30d5\u30a1\u30b5\u30fc\u30c9\u306e\u4e2d\u306edisk\u8a2d\u5b9a\u3067\u3001minio\u3092\u9078\u629e\u51fa\u6765\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\n\u5f8c\u306f.env\u3067\nFILE_SYSTEM=minio\nS3_ACCESS_KEY=[minio\u8d77\u52d5\u6642\u306b\u51fa\u308baccess_key]\nS3_ACCESS_SECRET=[minio\u8d77\u52d5\u6642\u306b\u51fa\u308bsecret_key]\nS3_ACCESS_REGION=[minio\u8d77\u52d5\u6642\u306b\u51fa\u308bregion]\nS3_BUCKET_NAME=[\u5229\u7528\u3057\u305f\u3044\u30d0\u30b1\u30c3\u30c8\u540d]\nS3_ACCESS_ENDPOINT=http://[minio\u8d77\u52d5\u30b5\u30fc\u30d0\u30fc\u306eIP]:9000\n\n\u3053\u3093\u306a\u611f\u3058\u306b\u3057\u3066\u3084\u308b\u3060\u3051\u3067\u3001Storage\u306e\u30c7\u30d5\u30a9\u30eb\u30c8\u547c\u3073\u51fa\u3057\u304c\u5207\u308a\u66ff\u3048\u3089\u308c\u307e\u3059\u3002\n\u30d7\u30ed\u30c0\u30af\u30b7\u30e7\u30f3\u74b0\u5883\u3067\u306fs3\u3001\u30ed\u30fc\u30ab\u30eb\u3084Vagrant\u30fb\u30c6\u30b9\u30c8\u30b5\u30fc\u30d0\u30fc\u3067\u306fminio \u3068\u3044\u3046\u611f\u3058\u3067\u4f7f\u3048\u307e\u3059\u306d\u3002\n\n\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u30fb\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\n\u666e\u901a\u306bput\u3084get\u3001exists\u304c\u4f7f\u3048\u307e\u3059\u3002\n\\Storage::put(\"test.txt\", \"\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u30c6\u30b9\u30c8\");\n\nif(\\Storage::exists(\"test.txt\")) {\n    echo \\Storage::get(\"test.txt\");\n}\n\n\n\u611f\u60f3\n\u6b63\u76f4local\u306e\u30d5\u30a1\u30a4\u30eb\u30b9\u30c8\u30ec\u30fc\u30b8\u3067\u3082\u3044\u3044\u306e\u3067\u3059\u304c\u30fb\u30fb\u30fb\n\u793e\u5185\u30c4\u30fc\u30eb\u4f5c\u6210\u306e\u30c7\u30d7\u30ed\u30a4\u304cdocker image\u3060\u3063\u305f\u70ba\u3001\u624b\u8efd\u306b\u6c38\u7d9a\u5316\u3055\u305b\u305f\u304f\u3066minio\u3092\u9078\u3073\u307e\u3057\u305f\u3002\ndocker\u3092\u65e2\u306b\u4f7f\u3063\u3066\u3044\u308b\u306a\u3089\ndocker run -p 9000:9000 --name minio \\\n  --restart=always \\\n  -v /mnt/export/minio:/export \\\n  -v /mnt/config/minio:/root/.minio \\\n  minio/minio /export\n\n\u3053\u3093\u306a\u5f62\u3067\u8d77\u52d5\u3059\u308b\u3060\u3051\u3067\u3059\u3050\u306b\u4f7f\u3046\u4e8b\u3082\u51fa\u6765\u308b\u306e\u3067\u30aa\u30b9\u30b9\u30e1\u3067\u3059\u3002\n\n\u958b\u767a\u74b0\u5883\uff1a Vagrant\n\u30c6\u30b9\u30c8\u74b0\u5883\uff1a dokku\n\u30d7\u30ed\u30c0\u30af\u30b7\u30e7\u30f3\u74b0\u5883\uff1a AWS(\u4e88\u5b9a)\n\n\u306a\u3093\u3066\u3044\u3046\u30b5\u30fc\u30d3\u30b9\u306e\u4f5c\u308a\u65b9\u306b\u30d4\u30c3\u30bf\u30ea\u3060\u3068\u601d\u3044\u307e\u3059\u3002\n\u5272\u3068\u4ee5\u524d\u306b[minio\u30b5\u30fc\u30d0\u30fc\u306b\u3055\u308f\u3063\u305f](http://qiita.com/aozora0000/items/e2cbdaf70c45cb564c21)\u3093\u3067\u3059\u304c\u3001\u30ea\u30d9\u30f3\u30b8\u30de\u30c3\u30c1\uff01\n\u3068\u3044\u3046\u4e8b\u3067\u3001\u4eca\u56de\u306fLaravel5.2\u304b\u3089Storage\u30d5\u30a1\u30b5\u30fc\u30c9\u3092\u7d4c\u7531\u3057\u3066Minio\u30b5\u30fc\u30d0\u30fc\u306b\u63a5\u7d9a\u3057\u305f\u3044\u3068\u601d\u3044\u307e\u3059\u3002\n\n# \u6e96\u5099\n- minio\n- Laravel5.2\n\n\u5c1a\u3001Laravel\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u306f\u6e08\u3093\u3067\u3044\u308b\u7269\u3068\u3057\u3066\u9032\u3081\u307e\u3059\u3002\n\n## minio\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\nhttps://github.com/minio/minio\n\n- Mac\u5229\u7528\u306a\u3089https://github.com/minio/minio#os-x\n- Linux\u5229\u7528\u306a\u3089https://github.com/minio/minio#gnulinux\n- Windows\u5229\u7528\u306a\u3089https://github.com/minio/minio#microsoft-windows\n\n\u3092\u4f7f\u3063\u3066\u304f\u3060\u3055\u3044\u3002\n\n## minio\u30b5\u30fc\u30d0\u30fc\u7acb\u3061\u4e0a\u3052\n```\nminio server [\u30d5\u30a1\u30a4\u30eb\u683c\u7d0d\u30c7\u30a3\u30ec\u30af\u30c8\u30ea]\n```\n\u3053\u308c\u3067\u8d77\u52d5\u3057\u307e\u3059\u3002\n\nvagrant\u306e\u5834\u5408\u306f\n\n```\nminio server /vagrant/storages/\n```\n\u3060\u3068\u30db\u30b9\u30c8PC\u304b\u3089\u30d5\u30a1\u30a4\u30eb\u3092\u76f4\u3067\u30c1\u30a7\u30c3\u30af\u51fa\u6765\u308b\u306e\u3067\u30aa\u30b9\u30b9\u30e1\u3067\u3059\u3002\n\n## Filesystem/S3\u30a2\u30c0\u30d7\u30bf\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n```\nphp composer require league/flysystem-aws-s3-v3\n```\n\u4eca\u56de\u306faws-php-sdk\u306eversion3\u3092\u5229\u7528\u3057\u307e\u3059\u3002\n\n## MinioStorageServiceProvider\u306e\u4f5c\u6210\n```\nphp artisan make:provider MinioStorageServiceProvider\n```\n\n\u3053\u308c\u3067app/Providers\u4ee5\u4e0b\u306bMinioStorageServiceProvider\u304c\u8a2d\u7f6e\u3055\u308c\u3066\u3044\u307e\u3059\u3002\n\u4ee5\u4e0b\u306e\u3088\u3046\u306b\n\n```MinioStorageServiceProvider.php\n<?php\nnamespace App\\Providers;\n\n\nuse Aws\\S3\\S3Client;\nuse Illuminate\\Support\\ServiceProvider;\nuse League\\Flysystem\\AwsS3v3\\AwsS3Adapter;\nuse League\\Flysystem\\Filesystem;\n\nclass MinioStorageServiceProvider extends ServiceProvider\n{\n    public function boot()\n    {\n        \\Storage::extend('minio', function ($app, $config) {\n            $client = new S3Client([\n                'credentials' => [\n                    'key'    => $config[\"key\"],\n                    'secret' => $config[\"secret\"]\n                ],\n                'region'      => $config[\"region\"],\n                'version'     => \"latest\",\n                'endpoint'    => $config[\"endpoint\"],\n            ]);\n            return new Filesystem(new AwsS3Adapter($client, $config[\"bucket\"]));\n        });\n    }\n\n    /**\n     * Register the service provider.\n     *\n     * @return void\n     */\n    public function register()\n    {\n\n    }\n}\n```\n\n## Storage\u30d5\u30a1\u30b5\u30fc\u30c9\u3092\u74b0\u5883\u3067\u5207\u308a\u66ff\u3048\u3089\u308c\u308b\u3088\u3046\u306b\u3059\u308b\n\n```config/filesystem.php\nreturn [\n    'default' => env(\"FILE_SYSTEM\", \"local\"),\n    'cloud' => 's3',\n    'disks' => [\n        'local' => [\n            'driver' => 'local',\n            'root' => storage_path('app'),\n        ],\n        'public' => [\n            'driver' => 'local',\n            'root' => storage_path('app/public'),\n            'visibility' => 'public',\n        ],\n        's3' => [\n            'driver' => 's3',\n            'key' => env(\"S3_ACCESS_KEY\"),\n            'secret' => env(\"S3_ACCESS_SECRET\"),\n            'region' => env(\"S3_ACCESS_REGION\"),\n            'bucket' => env(\"S3_BUCKET_NAME\"),\n        ],\n        'minio' => [\n            'driver' => 'minio',\n            'key' => env(\"S3_ACCESS_KEY\"),\n            'secret' => env(\"S3_ACCESS_SECRET\"),\n            'region' => env(\"S3_ACCESS_REGION\"),\n            'bucket' => env(\"S3_BUCKET_NAME\"),\n            'endpoint' => env(\"S3_ACCESS_ENDPOINT\"),\n        ]\n    ],\n];\n```\n\u3053\u308c\u3067Storage\u30d5\u30a1\u30b5\u30fc\u30c9\u306e\u4e2d\u306edisk\u8a2d\u5b9a\u3067\u3001minio\u3092\u9078\u629e\u51fa\u6765\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\n\u5f8c\u306f.env\u3067\n\n```.env\nFILE_SYSTEM=minio\nS3_ACCESS_KEY=[minio\u8d77\u52d5\u6642\u306b\u51fa\u308baccess_key]\nS3_ACCESS_SECRET=[minio\u8d77\u52d5\u6642\u306b\u51fa\u308bsecret_key]\nS3_ACCESS_REGION=[minio\u8d77\u52d5\u6642\u306b\u51fa\u308bregion]\nS3_BUCKET_NAME=[\u5229\u7528\u3057\u305f\u3044\u30d0\u30b1\u30c3\u30c8\u540d]\nS3_ACCESS_ENDPOINT=http://[minio\u8d77\u52d5\u30b5\u30fc\u30d0\u30fc\u306eIP]:9000\n```\n\n\u3053\u3093\u306a\u611f\u3058\u306b\u3057\u3066\u3084\u308b\u3060\u3051\u3067\u3001Storage\u306e\u30c7\u30d5\u30a9\u30eb\u30c8\u547c\u3073\u51fa\u3057\u304c\u5207\u308a\u66ff\u3048\u3089\u308c\u307e\u3059\u3002\n\u30d7\u30ed\u30c0\u30af\u30b7\u30e7\u30f3\u74b0\u5883\u3067\u306fs3\u3001\u30ed\u30fc\u30ab\u30eb\u3084Vagrant\u30fb\u30c6\u30b9\u30c8\u30b5\u30fc\u30d0\u30fc\u3067\u306fminio \u3068\u3044\u3046\u611f\u3058\u3067\u4f7f\u3048\u307e\u3059\u306d\u3002\n\n# \u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u30fb\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\n\u666e\u901a\u306bput\u3084get\u3001exists\u304c\u4f7f\u3048\u307e\u3059\u3002\n\n```\n\\Storage::put(\"test.txt\", \"\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u30c6\u30b9\u30c8\");\n```\n \n```\nif(\\Storage::exists(\"test.txt\")) {\n    echo \\Storage::get(\"test.txt\");\n}\n```\n\n# \u611f\u60f3\n\u6b63\u76f4local\u306e\u30d5\u30a1\u30a4\u30eb\u30b9\u30c8\u30ec\u30fc\u30b8\u3067\u3082\u3044\u3044\u306e\u3067\u3059\u304c\u30fb\u30fb\u30fb\n\u793e\u5185\u30c4\u30fc\u30eb\u4f5c\u6210\u306e\u30c7\u30d7\u30ed\u30a4\u304cdocker image\u3060\u3063\u305f\u70ba\u3001\u624b\u8efd\u306b\u6c38\u7d9a\u5316\u3055\u305b\u305f\u304f\u3066minio\u3092\u9078\u3073\u307e\u3057\u305f\u3002\ndocker\u3092\u65e2\u306b\u4f7f\u3063\u3066\u3044\u308b\u306a\u3089\n\n```\ndocker run -p 9000:9000 --name minio \\\n  --restart=always \\\n  -v /mnt/export/minio:/export \\\n  -v /mnt/config/minio:/root/.minio \\\n  minio/minio /export\n```\n\n\u3053\u3093\u306a\u5f62\u3067\u8d77\u52d5\u3059\u308b\u3060\u3051\u3067\u3059\u3050\u306b\u4f7f\u3046\u4e8b\u3082\u51fa\u6765\u308b\u306e\u3067\u30aa\u30b9\u30b9\u30e1\u3067\u3059\u3002\n\n- \u958b\u767a\u74b0\u5883\uff1a Vagrant\n- \u30c6\u30b9\u30c8\u74b0\u5883\uff1a dokku\n- \u30d7\u30ed\u30c0\u30af\u30b7\u30e7\u30f3\u74b0\u5883\uff1a AWS(\u4e88\u5b9a)\n\n\u306a\u3093\u3066\u3044\u3046\u30b5\u30fc\u30d3\u30b9\u306e\u4f5c\u308a\u65b9\u306b\u30d4\u30c3\u30bf\u30ea\u3060\u3068\u601d\u3044\u307e\u3059\u3002\n", "tags": ["PHP", "laravel5", "minio", "ObjectStorage"]}