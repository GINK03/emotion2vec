{"tags": ["Ubuntu", "Ubuntu14.04", "Ansible"], "context": " More than 1 year has passed since last update.Packer\u3067provisioning\u306bansible\u3092\u4f7f\u3063\u3066\u3001docker, AMI, vagrant\u306eimage\u3092\u4f5c\u6210\u3092\u3057\u305f\u969b\u306bsuperuser\u3092\u8ffd\u52a0\u3057\u305f\u304b\u3063\u305f\u306e\u3067\u3059\u304c\u3001\u3061\u3087\u3063\u3068\u3057\u305f\u74b0\u5883\u306e\u9055\u3044\u3067\u8272\u3005\u3068\u30cf\u30de\u3063\u305f\u306e\u3067\u305d\u306e\u6642\u306e\u30e1\u30e2\u3067\u3059\u3002\nAmazon\u304c\u63d0\u4f9b\u3057\u3066\u3044\u308bubunut AMI\u3067\u306f\u3001\u30c7\u30d5\u30a9\u30eb\u30c8\u3067admin group\u304c/etc/sudoers\u306b\u3042\u308a\u307e\u3059\u304c\u3001ubuntu\u306eserver\u7528\u306e\u30a4\u30e1\u30fc\u30b8\u3092\u3064\u304b\u3046\u5834\u5408\u306f\u81ea\u5206\u3067group\u3092\u4f5c\u3063\u3066\u3001/etc/sudoers\u306b\u8ffd\u52a0\u3057\u306a\u3044\u3068\u3044\u3051\u307e\u305b\u3093\u3002state=present\u306b\u306a\u3063\u3066\u3044\u308c\u3070\u3001\u3059\u3067\u306b\u66f8\u304b\u308c\u3066\u3044\u3066\u3082\u554f\u984c\u306a\u304f\u52d5\u304d\u307e\u3059\u3002\n- vars:\n    username: 'foobar'\n    password: '$6$7AVE1GtWIiA$ZevelSCKTO/DS4iNbAfog0Tf03chM/kFbOafLOSOGi8lAGf79oaGDjZl1nQ6dH6JcsahrtuwbF52O7weN/JFj1'\n- name: add admin group\n  group: name=admin state=present\n\n- name: add admin group to /etc/sudoers\n  lineinfile: \"dest=/etc/sudoers backup=yes state=present regexp='^%admin' line='%admin ALL=(ALL) ALL'\"\n\n- name: add a sudo-able user\n  user: name={{ username }} password={{ password }} groups=admin state=present\n\n\u30d1\u30b9\u30ef\u30fc\u30c9\u306b\u95a2\u3057\u3066\u306f\u5e73\u6587\u3067\u6e21\u3059\u306e\u3067\u306f\u306a\u304f\u3001mkpasswd\u306a\u3069\u3092\u4f7f\u3063\u3066\u751f\u6210\u3057\u305f\u3082\u306e\u3092\u6e21\u3057\u307e\u3059\u3002salt\u304c\u9055\u3046\u305f\u3081\u3001\u540c\u3058\u30d1\u30b9\u30ef\u30fc\u30c9\u3067\u3082\u9055\u3046\u6587\u5b57\u5217\u306b\u306a\u308b\u3053\u3068\u306b\u6ce8\u610f\u3057\u3066\u304f\u3060\u3055\u3044\u3002\nmkpasswd --method=SHA-512\n\n\nreferences\n\nHow do I generate crypted passwords for the user module?\n\nPacker\u3067provisioning\u306bansible\u3092\u4f7f\u3063\u3066\u3001docker, AMI, vagrant\u306eimage\u3092\u4f5c\u6210\u3092\u3057\u305f\u969b\u306bsuperuser\u3092\u8ffd\u52a0\u3057\u305f\u304b\u3063\u305f\u306e\u3067\u3059\u304c\u3001\u3061\u3087\u3063\u3068\u3057\u305f\u74b0\u5883\u306e\u9055\u3044\u3067\u8272\u3005\u3068\u30cf\u30de\u3063\u305f\u306e\u3067\u305d\u306e\u6642\u306e\u30e1\u30e2\u3067\u3059\u3002\n\nAmazon\u304c\u63d0\u4f9b\u3057\u3066\u3044\u308bubunut AMI\u3067\u306f\u3001\u30c7\u30d5\u30a9\u30eb\u30c8\u3067`admin group`\u304c`/etc/sudoers`\u306b\u3042\u308a\u307e\u3059\u304c\u3001ubuntu\u306eserver\u7528\u306e\u30a4\u30e1\u30fc\u30b8\u3092\u3064\u304b\u3046\u5834\u5408\u306f\u81ea\u5206\u3067group\u3092\u4f5c\u3063\u3066\u3001`/etc/sudoers`\u306b\u8ffd\u52a0\u3057\u306a\u3044\u3068\u3044\u3051\u307e\u305b\u3093\u3002`state=present`\u306b\u306a\u3063\u3066\u3044\u308c\u3070\u3001\u3059\u3067\u306b\u66f8\u304b\u308c\u3066\u3044\u3066\u3082\u554f\u984c\u306a\u304f\u52d5\u304d\u307e\u3059\u3002\n\n```yaml\n- vars:\n    username: 'foobar'\n    password: '$6$7AVE1GtWIiA$ZevelSCKTO/DS4iNbAfog0Tf03chM/kFbOafLOSOGi8lAGf79oaGDjZl1nQ6dH6JcsahrtuwbF52O7weN/JFj1'\n- name: add admin group\n  group: name=admin state=present\n\n- name: add admin group to /etc/sudoers\n  lineinfile: \"dest=/etc/sudoers backup=yes state=present regexp='^%admin' line='%admin ALL=(ALL) ALL'\"\n\n- name: add a sudo-able user\n  user: name={{ username }} password={{ password }} groups=admin state=present\n```\n\n\u30d1\u30b9\u30ef\u30fc\u30c9\u306b\u95a2\u3057\u3066\u306f\u5e73\u6587\u3067\u6e21\u3059\u306e\u3067\u306f\u306a\u304f\u3001`mkpasswd`\u306a\u3069\u3092\u4f7f\u3063\u3066\u751f\u6210\u3057\u305f\u3082\u306e\u3092\u6e21\u3057\u307e\u3059\u3002salt\u304c\u9055\u3046\u305f\u3081\u3001\u540c\u3058\u30d1\u30b9\u30ef\u30fc\u30c9\u3067\u3082\u9055\u3046\u6587\u5b57\u5217\u306b\u306a\u308b\u3053\u3068\u306b\u6ce8\u610f\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n```\nmkpasswd --method=SHA-512\n```\n\n##### references\n\n* [How do I generate crypted passwords for the user module?](http://docs.ansible.com/ansible/faq.html#how-do-i-generate-crypted-passwords-for-the-user-module)\n"}