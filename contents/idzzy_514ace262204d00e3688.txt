{"context": " More than 1 year has passed since last update.\n\nInstall and configure the necessary dependencies\n\nssh\n# yum install openssh-server openssh-clients\n# systemctl enable sshd\n# systemctl start sshd\n# systemctl list-units --type=service  | grep ssh\nsshd.service                       loaded active running OpenSSH server daemon\n\n\npostfix\n# yum install postfix\n# systemctl enable postfix\n# systemctl start postfix\n# systemctl list-units --type=service  | grep postfix\npostfix.service                    loaded active running Postfix Mail Transport Agent\n\n\nothers\n# yum install curl policycoreutils\n\n\nfirewall\n# firewall-cmd --add-service=http --zone=public --permanent\nsuccess\n\n# systemctl reload firewalld\nsuccess\n\n# firewall-cmd --zone=public --list-services\nhttp ssh\n\n\nAdd the GitLab package server and install the package\n# curl https://packages.gitlab.com/install/repositories/gitlab/gitlab-ce/script.rpm.sh | sudo bash\n\n# yum install gitlab-ce\n\n\nConfigure\n\nUpdate gitlab.rb\n\nMAIL\n\n# vi /etc/gitlab/gitlab.rb\n\n# diff /etc/gitlab/gitlab.rb.org /etc/gitlab/gitlab.rb\n206,208c206,208\n< # gitlab_rails['smtp_enable'] = true\n< # gitlab_rails['smtp_address'] = \"smtp.server\"\n< # gitlab_rails['smtp_port'] = 456\n---\n> gitlab_rails['smtp_enable'] = true\n> gitlab_rails['smtp_address'] = <SMTP_SERVER>\n> gitlab_rails['smtp_port'] = <SMTP_SERVER_PORT>\n\n\nOther Configuration options\n\nhttp://doc.gitlab.com/omnibus/settings/configuration.html\n\nRun configure\n# gitlab-ctl reconfigure\n\n\nBrowse to the gitlab UI\nid : root\npw : 5iveL!fe (default)\n\n\ngitlab-ctl command\n\nStatus\n# gitlab-ctl status\nrun: logrotate: (pid 21213) 3179s; run: log: (pid 29874) 14275015s\nrun: nginx: (pid 11526) 8650626s; run: log: (pid 29860) 14275017s\nrun: postgresql: (pid 11535) 8650625s; run: log: (pid 29752) 14275077s\nrun: redis: (pid 11537) 8650625s; run: log: (pid 29672) 14275088s\nrun: sidekiq: (pid 11549) 8650625s; run: log: (pid 29845) 14275019s\nrun: unicorn: (pid 11575) 8650622s; run: log: (pid 29809) 14275021s\n\n\nShow config\n# gitlab-ctl show-config\nStarting Chef Client, version 12.4.0.rc.2\nresolving cookbooks for run list: [\"gitlab::show_config\"]\nSynchronizing Cookbooks:\n  - package\n  - runit\n  - gitlab\nCompiling Cookbooks...\n{\n  \"gitlab\": {\n    \"bootstrap\": {\n\n    },\n    \"omnibus-gitconfig\": {\n\n    },\n    \"user\": {\n      \"git_user_email\": \"gitlab@<HOST_IP>\"\n    },\n    \"redis\": {\n\n    },\n    \"ci-redis\": {\n\n    },\n    \"gitlab-rails\": {\n      \"smtp_enable\": true,\n      \"smtp_address\": \"<SMTP_SERVER>\",\n      \"smtp_port\": 587,\n      \"secret_token\": \"**********\",\n      \"gitlab_host\": \"<HOST_IP>\",\n      \"gitlab_email_from\": \"gitlab@<HOST_IP>\",\n      \"gitlab_https\": false,\n      \"gitlab_port\": 80,\n      \"db_username\": \"gitlab\",\n      \"db_host\": null,\n      \"db_port\": 5432\n    },\n    \"gitlab-ci\": {\n      \"secret_token\": null,\n      \"secret_key_base\": \"**********\",\n      \"db_key_base\": \"**********\",\n      \"db_username\": \"gitlab_ci\",\n      \"db_host\": null,\n      \"db_port\": 5432\n    },\n    \"gitlab-shell\": {\n      \"secret_token\": \"**********\"\n    },\n    \"unicorn\": {\n\n    },\n    \"ci-unicorn\": {\n\n    },\n    \"sidekiq\": {\n\n    },\n    \"ci-sidekiq\": {\n\n    },\n    \"nginx\": {\n      \"listen_port\": 80\n    },\n    \"ci-nginx\": {\n      \"listen_port\": 80\n    },\n    \"logging\": {\n\n    },\n    \"remote-syslog\": {\n\n    },\n    \"logrotate\": {\n\n    },\n    \"high-availability\": {\n\n    },\n    \"postgresql\": {\n\n    },\n    \"web-server\": {\n\n    },\n    \"external-url\": \"http://<HOST_IP>\",\n    \"ci-external-url\": null\n  }\n}\nConverging 0 resources\n\nRunning handlers:\nRunning handlers complete\nChef Client finished, 0/0 resources updated in 1.889371755 seconds\n\n\nService list\n# gitlab-ctl service-list\nlogrotate*\nnginx*\npostgresql*\nredis*\nsidekiq*\nunicorn*\n\n\nShow log\n# gitlab-ctl tail <SERVICE_NAME>\n\nex) gitlab-ctl tail nginx\n\n\nStart/Stop\n# gitlab-ctl [start|stop]\n\n\nEnvironment\n\nOS\n# cat /etc/redhat-release\nCentOS Linux release 7.1.1503 (Core)\n\n\nGitlab\n# rpm -q gitlab-ce\ngitlab-ce-7.13.5-ce.0.el7.x86_64\n\n\nNginx\n# /opt/gitlab/embedded/sbin/nginx -V\nnginx version: nginx/1.7.12\nbuilt by gcc 4.8.3 20140911 (Red Hat 4.8.3-9) (GCC)\nTLS SNI support enabled\nconfigure arguments: --prefix=/opt/gitlab/embedded --with-http_ssl_module --with-http_stub_status_module --with-http_gzip_static_module --with-ipv6 --with-debug --with-ld-opt=-L/opt/gitlab/embedded/lib --with-cc-opt='-L/opt/gitlab/embedded/lib -I/opt/gitlab/embedded/include'\n\n\nPostgreSQL\n# /opt/gitlab/embedded/bin/psql --version\npsql (PostgreSQL) 9.2.10\n\n\nRedis\n# /opt/gitlab/embedded/bin/redis-server --version\nRedis server v=2.8.21 sha=00000000:0 malloc=jemalloc-3.6.0 bits=64 build=dd0e407d8cdbadbb\n\n\nReference\nhttps://about.gitlab.com/downloads/\n## Install and configure the necessary dependencies\n\n##### ssh\n\n    # yum install openssh-server openssh-clients\n    # systemctl enable sshd\n    # systemctl start sshd\n    # systemctl list-units --type=service  | grep ssh\n    sshd.service                       loaded active running OpenSSH server daemon\n\n##### postfix\n\n    # yum install postfix\n    # systemctl enable postfix\n    # systemctl start postfix\n    # systemctl list-units --type=service  | grep postfix\n    postfix.service                    loaded active running Postfix Mail Transport Agent\n\n\n##### others\n\n    # yum install curl policycoreutils\n\n##### firewall\n\n    # firewall-cmd --add-service=http --zone=public --permanent\n    success\n\n    # systemctl reload firewalld\n    success\n\n    # firewall-cmd --zone=public --list-services\n    http ssh\n\n\n##  Add the GitLab package server and install the package\n\n    # curl https://packages.gitlab.com/install/repositories/gitlab/gitlab-ce/script.rpm.sh | sudo bash\n\n    # yum install gitlab-ce\n\n\n## Configure\n\n##### Update gitlab.rb\n\n* MAIL\n\n```\n# vi /etc/gitlab/gitlab.rb\n\n# diff /etc/gitlab/gitlab.rb.org /etc/gitlab/gitlab.rb\n206,208c206,208\n< # gitlab_rails['smtp_enable'] = true\n< # gitlab_rails['smtp_address'] = \"smtp.server\"\n< # gitlab_rails['smtp_port'] = 456\n---\n> gitlab_rails['smtp_enable'] = true\n> gitlab_rails['smtp_address'] = <SMTP_SERVER>\n> gitlab_rails['smtp_port'] = <SMTP_SERVER_PORT>\n```\n\n* Other Configuration options\n\n[http://doc.gitlab.com/omnibus/settings/configuration.html][link-01]\n\n##### Run configure\n\n    # gitlab-ctl reconfigure\n\n## Browse to the gitlab UI\n\n    id : root\n    pw : 5iveL!fe (default)\n\n\n## gitlab-ctl command\n\n##### Status\n\n    # gitlab-ctl status\n    run: logrotate: (pid 21213) 3179s; run: log: (pid 29874) 14275015s\n    run: nginx: (pid 11526) 8650626s; run: log: (pid 29860) 14275017s\n    run: postgresql: (pid 11535) 8650625s; run: log: (pid 29752) 14275077s\n    run: redis: (pid 11537) 8650625s; run: log: (pid 29672) 14275088s\n    run: sidekiq: (pid 11549) 8650625s; run: log: (pid 29845) 14275019s\n    run: unicorn: (pid 11575) 8650622s; run: log: (pid 29809) 14275021s\n\n##### Show config\n\n    # gitlab-ctl show-config\n    Starting Chef Client, version 12.4.0.rc.2\n    resolving cookbooks for run list: [\"gitlab::show_config\"]\n    Synchronizing Cookbooks:\n      - package\n      - runit\n      - gitlab\n    Compiling Cookbooks...\n    {\n      \"gitlab\": {\n        \"bootstrap\": {\n\n        },\n        \"omnibus-gitconfig\": {\n\n        },\n        \"user\": {\n          \"git_user_email\": \"gitlab@<HOST_IP>\"\n        },\n        \"redis\": {\n\n        },\n        \"ci-redis\": {\n\n        },\n        \"gitlab-rails\": {\n          \"smtp_enable\": true,\n          \"smtp_address\": \"<SMTP_SERVER>\",\n          \"smtp_port\": 587,\n          \"secret_token\": \"**********\",\n          \"gitlab_host\": \"<HOST_IP>\",\n          \"gitlab_email_from\": \"gitlab@<HOST_IP>\",\n          \"gitlab_https\": false,\n          \"gitlab_port\": 80,\n          \"db_username\": \"gitlab\",\n          \"db_host\": null,\n          \"db_port\": 5432\n        },\n        \"gitlab-ci\": {\n          \"secret_token\": null,\n          \"secret_key_base\": \"**********\",\n          \"db_key_base\": \"**********\",\n          \"db_username\": \"gitlab_ci\",\n          \"db_host\": null,\n          \"db_port\": 5432\n        },\n        \"gitlab-shell\": {\n          \"secret_token\": \"**********\"\n        },\n        \"unicorn\": {\n\n        },\n        \"ci-unicorn\": {\n\n        },\n        \"sidekiq\": {\n\n        },\n        \"ci-sidekiq\": {\n\n        },\n        \"nginx\": {\n          \"listen_port\": 80\n        },\n        \"ci-nginx\": {\n          \"listen_port\": 80\n        },\n        \"logging\": {\n\n        },\n        \"remote-syslog\": {\n\n        },\n        \"logrotate\": {\n\n        },\n        \"high-availability\": {\n\n        },\n        \"postgresql\": {\n\n        },\n        \"web-server\": {\n\n        },\n        \"external-url\": \"http://<HOST_IP>\",\n        \"ci-external-url\": null\n      }\n    }\n    Converging 0 resources\n\n    Running handlers:\n    Running handlers complete\n    Chef Client finished, 0/0 resources updated in 1.889371755 seconds\n\n\n##### Service list\n\n    # gitlab-ctl service-list\n    logrotate*\n    nginx*\n    postgresql*\n    redis*\n    sidekiq*\n    unicorn*\n\n##### Show log\n\n    # gitlab-ctl tail <SERVICE_NAME>\n\n    ex) gitlab-ctl tail nginx\n\n##### Start/Stop\n\n    # gitlab-ctl [start|stop]\n\n\n## Environment\n\n##### OS\n\n    # cat /etc/redhat-release\n    CentOS Linux release 7.1.1503 (Core)\n\n##### Gitlab\n\n    # rpm -q gitlab-ce\n    gitlab-ce-7.13.5-ce.0.el7.x86_64\n\n##### Nginx\n\n    # /opt/gitlab/embedded/sbin/nginx -V\n    nginx version: nginx/1.7.12\n    built by gcc 4.8.3 20140911 (Red Hat 4.8.3-9) (GCC)\n    TLS SNI support enabled\n    configure arguments: --prefix=/opt/gitlab/embedded --with-http_ssl_module --with-http_stub_status_module --with-http_gzip_static_module --with-ipv6 --with-debug --with-ld-opt=-L/opt/gitlab/embedded/lib --with-cc-opt='-L/opt/gitlab/embedded/lib -I/opt/gitlab/embedded/include'\n\n##### PostgreSQL\n\n    # /opt/gitlab/embedded/bin/psql --version\n    psql (PostgreSQL) 9.2.10\n\n##### Redis\n\n    # /opt/gitlab/embedded/bin/redis-server --version\n    Redis server v=2.8.21 sha=00000000:0 malloc=jemalloc-3.6.0 bits=64 build=dd0e407d8cdbadbb\n\n## Reference\n\n[https://about.gitlab.com/downloads/][link-02]\n\n\n\n[link-01]:http://doc.gitlab.com/omnibus/settings/configuration.html\n[link-02]:https://about.gitlab.com/downloads/\n\n", "tags": ["GitLab"]}