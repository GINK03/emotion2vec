{"context": " More than 1 year has passed since last update.\u5927\u6a4b\u3067\u3059\u3002\n\u6700\u8fd1GAS\u306e\u8a18\u4e8b\u3070\u304b\u308a\u66f8\u3044\u3066\u3044\u307e\u3059\u306d\u3002\n\u672c\u65e5(2014/03/12)Google\u3088\u308aGoogle Docs\u3084Spreadsheets\u3092\u62e1\u5f35\u3067\u304d\u3001\u30e6\u30fc\u30b6\u304cStore\u304b\u3089\u597d\u304d\u306b\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u53ef\u80fd\u306a\n\"add-ons\"\u304c\u516c\u958b\u3055\u308c\u307e\u3057\u305f\u3002\n\nSheets\u306b\u30a2\u30c9\u30aa\u30f3\u30e1\u30cb\u30e5\u30fc\u304c\u8ffd\u52a0\u3055\u308c\u3066\u3044\u308b\n\nGoogle Drive\u3084Chrome Web Store\u306e\u3088\u3046\u306aStore\u304b\u3089\u597d\u304d\u306aadd-ons\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3067\u304d\u308b\n\n\u4e00\u5ea6\u5225\u306eSheets\u306a\u3069\u3067\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u305fadd-ons\u306f\u5225\u306eSheet\u3067\u3082\u300c\u30a2\u30c9\u30aa\u30f3\u3092\u7ba1\u7406\u300d\u30e1\u30cb\u30e5\u30fc\u304b\u3089\u5229\u7528\u53ef\u80fd\u72b6\u614b\u306b\u3067\u304d\u308b\nadd-ons\u306e\u958b\u767a\u306b\u306fGoogle Apps Script\u3092\u5229\u7528\u3057\u307e\u3059\u3002\n\u4eca\u56de\u306f\u3069\u306e\u3088\u3046\u306badd-ons\u3092\u4f5c\u308b\u306e\u304b\u3001\u4f55\u304c\u3067\u304d\u308b\u304b\u3092\u66f8\u3044\u3066\u3044\u304d\u305f\u3044\u3068\u601d\u3044\u307e\u3059\u3002\nP.S.\n\u6587\u7ae0\u4e2d\u306eadd-ons\u306b\u95a2\u3059\u308b\u8868\u8a18\u304c\u63fa\u308c\u3066\u3044\u3066\u307e\u3059\u3002\n\u591a\u5206\u6b63\u5f0f\u540d\u79f0\u306fadd-on\u306a\u306e\u3067\u3059\u304c\u516c\u5f0f\u6587\u7ae0\u4e2d\u3067\u3082Add-on\u3060\u3063\u305f\u308aadd-ons\u3060\u3063\u305f\u308aAdd-ons\u3060\u3063\u305f\u308a\u3059\u308b\u306e\u3067\u7d30\u304b\u3044\u3068\u3053\u308d\u306f\u4e0d\u660e\u3067\u3059\u3002( \uff70`\u0434\uff70\u00b4)\uff77\uff98\uff6f\n\n\u306f\u3058\u3081\u306b\n\u3053\u306e\u8a18\u4e8b\u3067\u306f\u57fa\u672c\u7684\u306b\u516c\u5f0f\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u306b\u3042\u308b\u300cQuickstart: Add-on for Google Docs\u300d\u3092\u65e5\u672c\u8a9e\u8a33\u3063\u307d\u3044\u611f\u3058\u3067\u66f8\u3044\u3066\u3044\u304d\u307e\u3059\u304c\u3001\n\u5927\u4e8b\u305d\u3046\u306a\u8a71\u306f\u8a33\u4ee5\u5916\u306b\u3082\u66f8\u3044\u3066\u3044\u3053\u3046\u3068\u601d\u3044\u307e\u3059\u3002\n\u307e\u305f\u3082\u3063\u3068\u3082\u91cd\u8981\u306a\u70b9\u3092\u5148\u306b\u3044\u304f\u3064\u304b\u66f8\u3044\u3066\u304a\u304d\u307e\u3059\u3002\n\n\u91cd\u8981\u306a\u30dd\u30a4\u30f3\u30c8\n\nSheets\u5411\u3051\u306eAdd-ons\u306f\u65b0\u3057\u3044\u30b9\u30d7\u30ec\u30c3\u30c9\u30b7\u30fc\u30c8\u3067\u306e\u307f\u5229\u7528\u53ef\u80fd\u3067\u3059\u3002\nSheets\u5411\u3051\u306eAdd-ons\u306f\u5148\u65e5\u516c\u958b\u3055\u308c\u305f\u65b0\u3057\u3044\u30b9\u30d7\u30ec\u30c3\u30c9\u30b7\u30fc\u30c8\u3067\u306e\u307f\u5229\u7528\u53ef\u80fd\u3067\u3059\u3002\n\n2014/03/12\u73fe\u5728 Store\u3078\u306e\u516c\u958b\u306fGoogle\u3078\u306e\u7533\u8acb\u304c\u5fc5\u8981\u3067\u3059\u3002\u7533\u8acb\u304c\u901a\u3063\u305f\u5834\u5408\u306e\u307fStore\u3078\u516c\u958b\u304c\u53ef\u80fd\u3067\u3059\n\u73fe\u72b6\u500b\u4eba\u7684\u306b\u8a66\u3059\u3053\u3068\u306f\u53ef\u80fd\u3067\u3059\u304c\u3001Store\u3078\u306fGoogle\u306e\u7533\u8acb\u304c\u901a\u3063\u305f\u5f8c\u306b\u53ef\u80fd\u306b\u306a\u308a\u307e\u3059\u3002\n\u7533\u8acb\u306f\u4ee5\u4e0b\u306e\u30d5\u30a9\u30fc\u30e0\u304b\u3089\u884c\u3044\u307e\u3059\u3002\nhttps://docs.google.com/forms/d/1bqpfpEhiiKMqD206LBF4cL6-YdCBKfIKDQaaap8SO-g/viewform\n2015/10/09\u73fe\u5728 Store\u3078\u306e\u516c\u958b\u306f\u8ab0\u3067\u3082\u53ef\u80fd\u306b\u306a\u308a\u307e\u3057\u305f\u3002\n\n\u8ab2\u91d1\u306e\u4ed5\u7d44\u306f\u7528\u610f\u3055\u308c\u3066\u3044\u307e\u305b\u3093\u3002\n\u516c\u958b\u3057\u3066\u3082\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u6642\u306b\u8ab2\u91d1\u307f\u305f\u3044\u306a\u4ed5\u7d44\u306f\u73fe\u72b6\u7528\u610f\u3055\u308c\u3066\u3044\u307e\u305b\u3093\u3002\n\u8ab2\u91d1\u3092\u884c\u3044\u305f\u3044\u5834\u5408\u306fGoogle Wallet API\u306e\u3088\u3046\u306aAPI\u3092\u5229\u7528\u3057\u305f\u308a\u3001\u4f55\u304b\u3057\u3089\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u5185\u3067\u4ed5\u7d44\u3092\u63d0\u4f9b\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\n\u307e\u305f\u898f\u7d04\u4e0a\u3001\u5e83\u544a\u3092\u8f09\u305b\u308b\u3053\u3068\u3082\u3067\u304d\u307e\u305b\u3093\u3002\n\nGAS\u4ee5\u5916\u3067\u306e\u958b\u767a\u306f\u3067\u304d\u307e\u305b\u3093\nGAS\u306e\u5236\u7d04\u306b\u8272\u3005\u7e1b\u3089\u308c\u307e\u3059\u3002\u7e1b\u3089\u308c\u307e\u3059\u3002\u7e1b\u3089(ry\n\n\u5404\u30dc\u30bf\u30f3\u306a\u3069\u306e\u898b\u305f\u76ee\u304cGoogle\u306b\u8fd1\u3065\u304f\u3088\u3046\u306acss\u30d5\u30a1\u30a4\u30eb\u304c\u63d0\u4f9b\u3055\u308c\u3066\u3044\u307e\u3059\u3002\n\u3053\u307e\u3044\u90e8\u5206\u306f\u3053\u3061\u3089\u3092\u898b\u3066\u4e0b\u3055\u3044\u3002\n\u3082\u3061\u308d\u3093\u4efb\u610f\u306eCSS\u3092\u5229\u7528\u3059\u308b\u3053\u3068\u3082\u53ef\u80fd\u3067\u3059\u304cSpreadsheet\u306a\u3069\u306b\u57cb\u3081\u8fbc\u307e\u308c\u308b\u305f\u3081\u3001 Look & Feel\u304c\u305d\u308d\u3063\u3066\u3044\u305f\u307b\u3046\u304c\u826f\u3044\u3067\u3057\u3087\u3046\u3002\n\n\u306a\u304a\u7ffb\u8a33\u5143\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u306f Creative Commons Attribution 3.0 License \u306e\u30e9\u30a4\u30bb\u30f3\u30b9\u3067\u3059\u3002\n\u4ee5\u4e0b\u7279\u306b\u8a18\u8f09\u304c\u306a\u3051\u308c\u3070\u540c\u69d8\u306e\u30e9\u30a4\u30bb\u30f3\u30b9\u3068\u306a\u308a\u307e\u3059\u3002\n\u307e\u305f\u30b3\u30fc\u30c9\u306b\u3064\u3044\u3066\u306fApache 2.0 License\u3068\u306a\u308a\u307e\u3059\u3002\n\u4ee5\u4e0b\u7279\u306b\u8a18\u8f09\u304c\u306a\u3051\u308c\u3070\u540c\u69d8\u306e\u30e9\u30a4\u30bb\u30f3\u30b9\u3068\u306a\u308a\u307e\u3059\u3002\n\n\nQuickstart: Add-on for Google Docs(\u65e5\u672c\u8a9e\u8a33)\n\nComplete the steps described in the rest of this page, and in about five minutes you'll have created a Google Docs add-on that translates text in a sidebar. To see what the add-on looks like when it's finished, just install Translate from the Google Docs add-ons store.\n\n\u3053\u306e\u30da\u30fc\u30b8\u3067\u306f\u7d045\u5206\u3067\u30b5\u30a4\u30c9\u30d0\u30fc\u4e2d\u3067\u7ffb\u8a33\u3092\u884c\u3046\u3001Google Docs add-on \u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\nadd-on\u3092\u4f5c\u6210\u3057\u7d42\u308f\u3063\u305f\u969b\u306e\u898b\u305f\u76ee\u3084\u3001\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u6642\u306e\u6319\u52d5\u306f\u30a2\u30c9\u30aa\u30f3\u30b9\u30c8\u30a2\u3088\u308aTranslate\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u3066\u307f\u3066\u304f\u3060\u3055\u3044\u3002\n\n\n\u76ee\u6b21\n\nSet it up\nTry it out\nPublish\nLean more\n\n\nSet it up(\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7)\n\n\nCreate a new Google Doc.\nFrom within your new document, select the menu item Tools > Script editor. If you are presented with a welcome screen, click Blank Project.\nDelete any code in the script editor and paste in the code below.\nCreate a new file by selecting the menu item File > New > Html file. Name the file \"Sidebar\".\nDelete any code in the new editor tab and paste in the code below.\nSelect the menu item File > Save all. Name your new script \"Translate Quickstart\" and click OK (The script's name is shown to end users in several places, including the authorization dialog.)\n\n\n\n\u65b0\u3057\u3044Google Document\u3092\u4f5c\u308a\u307e\u3059\u3002\u203b\u30ea\u30f3\u30af\u3092\u30af\u30ea\u30c3\u30af\u3059\u308b\u3068\u65b0\u3057\u3044Google Document\u304c\u3067\u304d\u307e\u3059\n\u65b0\u3057\u304f\u4f5c\u6210\u3057\u305fDocument\u3067 \u300c\u30e1\u30cb\u30e5\u30fc\u300d > \u300c\u30b9\u30af\u30ea\u30d7\u30c8 \u30a8\u30c7\u30a3\u30bf\u2026\u300d \u3092\u9078\u629e\u3057\u307e\u3059\u3002\u3082\u3057\u300cWelcome\u300d\u753b\u9762\u304c\u51fa\u305f\u5834\u5408\u306f Blank Project\u3092\u9078\u629e\u3057\u307e\u3059\u3002\n\u65e2\u306b\u30b9\u30af\u30ea\u30d7\u30c8\u30a8\u30c7\u30a3\u30bf\u306b\u8a18\u8f09\u3055\u308c\u3066\u3044\u308b\u30b3\u30fc\u30c9\u3092\u524a\u9664\u3057\u3001\u4e0b\u8a18\u30b3\u30fc\u30c9(code.gs)\u3092\u8cbc\u308a\u4ed8\u3051\u307e\u3059\u3002\n\u30b9\u30af\u30ea\u30d7\u30c8\u30a8\u30c7\u30a3\u30bf\u306e\u30e1\u30cb\u30e5\u30fc\u304b\u3089 \u300c\u30d5\u30a1\u30a4\u30eb\u300d > \u300c\u65b0\u898f\u4f5c\u6210\u300d > \u300cHTML \u30d5\u30a1\u30a4\u30eb\u300d\u3092\u9078\u629e\u3057\u3001\u65b0\u3057\u3044HTML\u30d5\u30a1\u30a4\u30eb\u3092Sidebar\u3068\u3044\u3046\u30d5\u30a1\u30a4\u30eb\u540d\u3067\u4f5c\u6210\u3057\u307e\u3059\n\u8a18\u8f09\u6e08\u307f\u306eHTML\u3092\u524a\u9664\u3057\u3001 \u4e0b\u8a18HTML(Sidebar.html)\u3092\u30b3\u30d4\u30da\u3057\u307e\u3059\u3002\n\u30e1\u30cb\u30e5\u30fc\u304b\u3089 \u300c\u30d5\u30a1\u30a4\u30eb\u300d > \u300c\u3059\u3079\u3066\u3092\u4fdd\u5b58\u300d \u3092\u9078\u629e\u3057\u307e\u3059\u3002\u30b9\u30af\u30ea\u30d7\u30c8\u306e\u540d\u524d\u306e\u8a2d\u5b9a\u3092\u6c42\u3081\u3089\u308c\u308b\u306e\u3067\u3001\u300cTranslate Quickstart\u300d\u3068\u540d\u3065\u3051\u307e\u3059\u3002\u3053\u306e\u540d\u524d\u306f\u30e6\u30fc\u30b6\u306e\u81f3\u308b\u6240\u3067\u76ee\u306b\u89e6\u308c\u307e\u3059\u3002\n\n\ncode.gs\n/**\n * Creates a menu entry in the Google Docs UI when the document is opened.\n */\nfunction onOpen() {\n  DocumentApp.getUi().createAddonMenu()\n      .addItem('Start', 'showSidebar')\n      .addToUi();\n}\n\n/**\n * Runs when the add-on is installed.\n */\nfunction onInstall() {\n  onOpen();\n}\n\n/**\n * Opens a sidebar in the document containing the add-on's user interface.\n */\nfunction showSidebar() {\n  var ui = HtmlService.createHtmlOutputFromFile('Sidebar')\n      .setTitle('Translate');\n  DocumentApp.getUi().showSidebar(ui);\n}\n\n/**\n * Gets the text the user has selected. If there is no selection,\n * this function displays an error message.\n *\n * @return {Array.<string>} The selected text.\n */\nfunction getSelectedText() {\n  var selection = DocumentApp.getActiveDocument().getSelection();\n  if (selection) {\n    var text = [];\n    var elements = selection.getSelectedElements();\n    for (var i = 0; i < elements.length; i++) {\n      if (elements[i].isPartial()) {\n        var element = elements[i].getElement().asText();\n        var startIndex = elements[i].getStartOffset();\n        var endIndex = elements[i].getEndOffsetInclusive();\n\n        text.push(element.getText().substring(startIndex, endIndex + 1));\n      } else {\n        var element = elements[i].getElement();\n        // Only translate elements that can be edited as text; skip images and\n        // other non-text elements.\n        if (element.editAsText) {\n          var elementText = element.asText().getText();\n          // This check is necessary to exclude images, which return a blank\n          // text element.\n          if (elementText != '') {\n            text.push(elementText);\n          }\n        }\n      }\n    }\n    if (text.length == 0) {\n      throw 'Please select some text.';\n    }\n    return text;\n  } else {\n    throw 'Please select some text.';\n  }\n}\n\n/**\n * Gets the stored user preferences for the origin and destination languages,\n * if they exist.\n *\n * @return {Object} The user's origin and destination language preferences, if\n *     they exist.\n */\nfunction getPreferences() {\n  var userProperties = PropertiesService.getUserProperties();\n  var languagePrefs = {\n    originLang: userProperties.getProperty('originLang'),\n    destLang: userProperties.getProperty('destLang')\n  };\n  return languagePrefs;\n}\n\n/**\n * Gets the user-selected text and translates it from the origin language to the\n * destination language. The languages are notated by their two-letter short\n * form. For example, English is 'en', and Spanish is 'es'. The origin language\n * may be specified as an empty string to indicate that Google Translate should\n * auto-detect the language.\n *\n * @param {string} origin The two-letter short form for the origin language.\n * @param {string} dest The two-letter short form for the destination language.\n * @param {boolean} savePrefs Whether to save the origin and destination\n *     language preferences.\n * @return {string} The result of the translation.\n */\nfunction runTranslation(origin, dest, savePrefs) {\n  var text = getSelectedText();\n  if (savePrefs == true) {\n    var userProperties = PropertiesService.getUserProperties();\n    userProperties.setProperty('originLang', origin);\n    userProperties.setProperty('destLang', dest);\n  }\n\n  var translated = [];\n  for (var i = 0; i < text.length; i++) {\n    translated.push(LanguageApp.translate(text[i], origin, dest));\n  }\n\n  return translated.join('\\n');\n}\n\n/**\n * Replaces the text of the current selection with the provided text, or\n * inserts text at the current cursor location. (There will always be either\n * a selection or a cursor.) If multiple elements are selected, only inserts the\n * translated text in the first element that can contain text and removes the\n * other elements.\n *\n * @param {string} newText The text with which to replace the current selection.\n */\nfunction insertText(newText) {\n  var selection = DocumentApp.getActiveDocument().getSelection();\n  if (selection) {\n    var replaced = false;\n    var elements = selection.getSelectedElements();\n    if (elements.length == 1 &&\n        elements[0].getElement().getType() ==\n        DocumentApp.ElementType.INLINE_IMAGE) {\n      throw \"Can't insert text into an image.\";\n    }\n    for (var i = 0; i < elements.length; i++) {\n      if (elements[i].isPartial()) {\n        var element = elements[i].getElement().asText();\n        var startIndex = elements[i].getStartOffset();\n        var endIndex = elements[i].getEndOffsetInclusive();\n\n        var remainingText = element.getText().substring(endIndex + 1);\n        element.deleteText(startIndex, endIndex);\n        if (!replaced) {\n          element.insertText(startIndex, newText);\n          replaced = true;\n        } else {\n          // This block handles a selection that ends with a partial element. We\n          // want to copy this partial text to the previous element so we don't\n          // have a line-break before the last partial.\n          var parent = element.getParent();\n          parent.getPreviousSibling().asText().appendText(remainingText);\n          // We cannot remove the last paragraph of a doc. If this is the case,\n          // just remove the text within the last paragraph instead.\n          if (parent.getNextSibling()) {\n            parent.removeFromParent();\n          } else {\n            element.removeFromParent();\n          }\n        }\n      } else {\n        var element = elements[i].getElement();\n        if (!replaced && element.editAsText) {\n          // Only translate elements that can be edited as text, removing other\n          // elements.\n          element.clear();\n          element.asText().setText(newText);\n          replaced = true;\n        } else {\n          // We cannot remove the last paragraph of a doc. If this is the case,\n          // just clear the element.\n          if (element.getNextSibling()) {\n            element.removeFromParent();\n          } else {\n            element.clear();\n          }\n        }\n      }\n    }\n  } else {\n    var cursor = DocumentApp.getActiveDocument().getCursor();\n    var surroundingText = cursor.getSurroundingText().getText();\n    var surroundingTextOffset = cursor.getSurroundingTextOffset();\n\n    // If the cursor follows or preceds a non-space character, insert a space\n    // between the character and the translation. Otherwise, just insert the\n    // translation.\n    if (surroundingTextOffset > 0) {\n      if (surroundingText.charAt(surroundingTextOffset - 1) != ' ') {\n        newText = ' ' + newText;\n      }\n    }\n    if (surroundingTextOffset < surroundingText.length) {\n      if (surroundingText.charAt(surroundingTextOffset) != ' ') {\n        newText += ' ';\n      }\n    }\n    cursor.insertText(newText);\n  }\n}\n\n\n\n\nSidebar.html\n<link rel=\"stylesheet\" href=\"https://ssl.gstatic.com/docs/script/css/add-ons.css\">\n<!-- The CSS package above applies Google styling to buttons and other elements. -->\n\n<style>\n.branding-below {\n  bottom: 56px;\n  top: 0;\n}\n\n.branding-text {\n  left: 7px;\n  position: relative;\n  top: 3px;\n}\n\n.col-contain {\n  overflow: hidden;\n}\n\n.col-one {\n  float: left;\n  width: 50%;\n}\n\n.logo {\n  vertical-align: middle;\n}\n\n.radio-spacer {\n  height: 20px;\n}\n\n.width-100 {\n  width: 100%;\n}\n</style>\n\n<div class=\"sidebar branding-below\">\n  <form>\n    <div class=\"block col-contain\">\n      <div class=\"col-one\">\n        <b>Selected text</b>\n        <div>\n          <input type=\"radio\" name=\"origin\" id=\"radio-origin-auto\" value=\"\" checked=\"checked\">\n          <label for=\"radio-origin-auto\">Auto-detect</label>\n        </div>\n        <div>\n          <input type=\"radio\" name=\"origin\" id=\"radio-origin-en\" value=\"en\">\n          <label for=\"radio-origin-en\">English</label>\n        </div>\n        <div>\n          <input type=\"radio\" name=\"origin\" id=\"radio-origin-fr\" value=\"fr\">\n          <label for=\"radio-origin-fr\">French</label>\n        </div>\n        <div>\n          <input type=\"radio\" name=\"origin\" id=\"radio-origin-de\" value=\"de\">\n          <label for=\"radio-origin-de\">German</label>\n        </div>\n        <div>\n          <input type=\"radio\" name=\"origin\" id=\"radio-origin-ja\" value=\"ja\">\n          <label for=\"radio-origin-ja\">Japanese</label>\n        </div>\n        <div>\n          <input type=\"radio\" name=\"origin\" id=\"radio-origin-es\" value=\"es\">\n          <label for=\"radio-origin-es\">Spanish</label>\n        </div>\n      </div>\n      <div>\n        <b>Translate into</b>\n        <div class=\"radio-spacer\">\n        </div>\n        <div>\n          <input type=\"radio\" name=\"dest\" id=\"radio-dest-en\" value=\"en\">\n          <label for=\"radio-dest-en\">English</label>\n        </div>\n        <div>\n          <input type=\"radio\" name=\"dest\" id=\"radio-dest-fr\" value=\"fr\">\n          <label for=\"radio-dest-fr\">French</label>\n        </div>\n        <div>\n          <input type=\"radio\" name=\"dest\" id=\"radio-dest-de\" value=\"de\">\n          <label for=\"radio-dest-de\">German</label>\n        </div>\n        <div>\n          <input type=\"radio\" name=\"dest\" id=\"radio-dest-ja\" value=\"ja\" checked=\"checked\">\n          <label for=\"radio-dest-ja\">Japanese</label>\n        </div>\n        <div>\n          <input type=\"radio\" name=\"dest\" id=\"radio-dest-es\" value=\"es\">\n          <label for=\"radio-dest-es\">Spanish</label>\n        </div>\n      </div>\n    </div>\n\n    <div class=\"block form-group\">\n      <label for=\"translated-text\"><b>Translation</b></label>\n      <textarea class=\"width-100\" id=\"translated-text\" rows=\"10\"></textarea>\n    </div>\n\n    <div class=\"block\">\n      <input type=\"checkbox\" id=\"save-prefs\">\n      <label for=\"save-prefs\">Use these languages by default</label>\n    </div>\n\n   <div class=\"block\" id=\"button-bar\">\n      <button class=\"blue\" id=\"run-translation\">Translate</button>\n      <button id=\"insert-text\">Insert</button>\n    </div>\n  </form>\n</div>\n\n<div class=\"sidebar bottom\">\n  <img alt=\"Add-on logo\" class=\"logo\" width=\"27\" height=\"27\"\n      src=\"https://googledrive.com/host/0B0G1UdyJGrY6XzdjQWF4a1JYY1k/translate-logo-small.png\">\n  <span class=\"gray branding-text\">Translate sample by Google</span>\n</div>\n\n<script src=\"//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js\">\n</script>\n<script>\n  /**\n   * On document load, assign click handlers to each button and try to load the\n   * user's origin and destination language preferences if previously set.\n   */\n  $(function() {\n    $('#run-translation').click(runTranslation);\n    $('#insert-text').click(insertText);\n    google.script.run.withSuccessHandler(loadPreferences)\n        .withFailureHandler(showError).getPreferences();\n  });\n\n  /**\n   * Callback function that populates the origin and destination selection\n   * boxes with user preferences from the server.\n   *\n   * @param {Object} languagePrefs The saved origin and destination languages.\n   */\n  function loadPreferences(languagePrefs) {\n    $('input:radio[name=\"origin\"]')\n        .filter('[value=' + languagePrefs.originLang + ']')\n        .attr('checked', true);\n    $('input:radio[name=\"dest\"]')\n        .filter('[value=' + languagePrefs.destLang + ']')\n        .attr('checked', true);\n  }\n\n  /**\n   * Runs a server-side function to translate the user-selected text and update\n   * the sidebar UI with the resulting translation.\n   */\n  function runTranslation() {\n    this.disabled = true;\n    $('#error').remove();\n    var origin = $('input[name=origin]:checked').val();\n    var dest = $('input[name=dest]:checked').val();\n    var savePrefs = $('#save-prefs').is(':checked');\n    google.script.run\n        .withSuccessHandler(\n          function(translatedText, element) {\n            $('#translated-text').val(translatedText);\n            element.disabled = false;\n          })\n        .withFailureHandler(\n          function(msg, element) {\n            showError(msg, $('#button-bar'));\n            element.disabled = false;\n          })\n        .withUserObject(this)\n        .runTranslation(origin, dest, savePrefs);\n  }\n\n  /**\n   * Runs a server-side function to insert the translated text into the document\n   * at the user's cursor or selection.\n   */\n  function insertText() {\n    this.disabled = true;\n    $('#error').remove();\n    google.script.run\n        .withSuccessHandler(\n          function(returnSuccess, element) {\n            element.disabled = false;\n          })\n        .withFailureHandler(\n          function(msg, element) {\n            showError(msg, $('#button-bar'));\n            element.disabled = false;\n          })\n        .withUserObject(this)\n        .insertText($('#translated-text').val());\n  }\n\n  /**\n   * Inserts a div that contains an error message after a given element.\n   *\n   * @param msg The error message to display.\n   * @param element The element after which to display the error.\n   */\n  function showError(msg, element) {\n    var div = $('<div id=\"error\" class=\"error\">' + msg + '</div>');\n    $(element).after(div);\n  }\n</script>\n\n\n\nTry it out (\u8a66\u3057\u3066\u307f\u308b)\n\n\nSwitch back to your document and reload the page.\nAfter a few seconds, a Translate Quickstart sub-menu will appear under the Add-ons menu. (If you chose a different name for your script, that name will appear instead.) Click Add-ons > Translate Quickstart > Start.\nA dialog box will appear and tell you that the script requires authorization. Click Continue. A second dialog box will then request authorization for specific Google services. Read the notice carefully, then click Accept.\nA sidebar will appear. To test it, type some text into your document, then select it and click the blue Translate button. To replace the text in the document, click Insert.\n\n\n\nDocument\u306b\u623b\u3063\u3066\u30ea\u30ed\u30fc\u30c9\u3057\u307e\u3059\u3002\n\u30ea\u30ed\u30fc\u30c9\u5f8c\u6570\u79d2\u5f85\u3064\u3068 \u300c\u30a2\u30c9\u30aa\u30f3\u300d \u30e1\u30cb\u30e5\u30fc\u5185\u306b Translate Quickstart \uff08\u4ed6\u306e\u30b9\u30af\u30ea\u30d7\u30c8\u540d\u306b\u3057\u3066\u3044\u305f\u5834\u5408\u306f\u305d\u306e\u540d\u524d\u3067\u3059\u3002\uff09\u304c\u73fe\u308c\u307e\u3059\u3002 \u30e1\u30cb\u30e5\u30fc\u3088\u308a \u300c\u30a2\u30c9\u30aa\u30f3\u300d > \u300cTranslate Quickstart\u300d > \u300cStart\u300d \u3092\u30af\u30ea\u30c3\u30af\u3057\u307e\u3059\u3002\n\u8a8d\u53ef\uff08\u300c\u8a8d\u8a3c\u304c\u5fc5\u8981\u300d\uff09\u30c0\u30a4\u30a2\u30ed\u30b0\u304c\u8868\u793a\u3055\u308c\u305f\u3089 \u300c\u7d9a\u884c\u300d\u30dc\u30bf\u30f3\u3092\u30af\u30ea\u30c3\u30af\u3057\u307e\u3059\u3002 \u3059\u308b\u3068Google\u3078\u306e\u8a31\u53ef\u30ea\u30af\u30a8\u30b9\u30c8\u30c0\u30a4\u30a2\u30ed\u30b0\u304c\u8868\u793a\u3055\u308c\u308b\u306e\u3067\u3001\u300c\u627f\u8a8d\u3059\u308b\u300d\u3092\u30af\u30ea\u30c3\u30af\u3057\u307e\u3059\u3002\n\u3059\u308b\u3068Document\u4e2d\u306b\u30b5\u30a4\u30c9\u30d0\u30fc\u304c\u8868\u793a\u3055\u308c\u307e\u3059\u3002\u30c6\u30b9\u30c8\u3092\u884c\u3046\u305f\u3081\u306b\u306f\u3001\u4efb\u610f\u306e\u30c6\u30ad\u30b9\u30c8\u3092Document\u306b\u8a18\u8f09\u3057\u3001\u9078\u629e\u3001\u30b5\u30a4\u30c9\u30d0\u30fc\u306e\u300cTranslate\u300d\u30dc\u30bf\u30f3\u3092\u30af\u30ea\u30c3\u30af\u3057\u307e\u3059\u3002\u7f6e\u63db\u3092\u3059\u308b\u305f\u3081\u306b\u306f\u300cInsert\u300d\u30dc\u30bf\u30f3\u3092\u30af\u30ea\u30c3\u30af\u3057\u307e\u3059\u3002\n\n\nPublish (\u516c\u958b\u3059\u308b)\n\nSince this is an example add-on, our tutorial ends here. If you were developing a real add-on, the last step would be to publish it for other people to find and install. To learn more, check out our add-ons guide.\n\n\u3053\u3053\u3067\u3053\u306e\u30b5\u30f3\u30d7\u30eb\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u5229\u7528\u3057\u305fAdd-ons\u306e\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb\u306f\u5b8c\u4e86\u3067\u3059\u3002\n\u3082\u3057\u672c\u5f53\u306eadd-ons\u3092\u4f5c\u6210\u3057\u305f\u3044\u5834\u5408\u306f\u3001\u6700\u7d42\u30b9\u30c6\u30c3\u30d7\u3068\u3057\u3066\u4ed6\u306e\u4eba\u306b\u63a2\u3057\u3066\u3001\u4f7f\u3063\u3066\u3082\u3089\u3046\u305f\u3081\u306b\u516c\u958b\u3057\u305f\u3044\u3068\u8003\u3048\u308b\u3068\u601d\u3044\u307e\u3059\u3002  \u3053\u308c\u3092\u5b66\u3076\u306b\u306fGuide\u3092\u5fa1\u89a7\u304f\u3060\u3055\u3044\u3002\n\nLean more\n\nTo continue learning about how to extend Google Docs with Apps Script, take a look at the following resources:\n\nApps Script\u3092\u5229\u7528\u3057Google Docs\u3092\u62e1\u5f35\u3059\u308b\u65b9\u6cd5\u3092\u3088\u308a\u5b66\u3073\u305f\u3044\u5834\u5408\u306f\u3001\u4e0b\u8a18\u306e\u8cc7\u6599\u304c\u53c2\u8003\u306b\u306a\u308a\u307e\u3059\u3002\n\nGuide to Add-ons\nExtending Google Docs\nDocument Service Reference\n\n\n\u307e\u3068\u3081\n\u3044\u304b\u304c\u3067\u3057\u305f\u3067\u3057\u3087\u3046\u304b\uff1f\n\u4eca\u306e\u3068\u3053\u308d\u7533\u8acb\u304c\u5fc5\u8981\u306a\u306e\u3067\u3061\u3087\u3063\u3068\u6577\u5c45\u304c\u9ad8\u3044\u3088\u3046\u306b\u611f\u3058\u308b\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u304c\u3001\n\u30e6\u30fc\u30b6\u304c\u81ea\u7531\u306b\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u53ef\u80fd\u306aadd-on\u306f\u4eca\u307e\u3067\u306eGAS\u3067\u9762\u5012\u81ed\u304b\u3063\u305f\u90e8\u5206\u3092\u975e\u5e38\u306b\u3088\u304f\u89e3\u6d88\u3057\u3001\n\u307e\u305f\u3088\u308a\u9ad8\u5ea6\u306a\u6a5f\u80fd\u3082\u4f5c\u308b\u3053\u3068\u304c\u3067\u304d\u308b\u975e\u5e38\u306b\u9b45\u529b\u7684\u306a\u30d7\u30e9\u30c3\u30c8\u30d5\u30a9\u30fc\u30e0\u306b\u306a\u3063\u3066\u3044\u308b\u3068\u601d\u3044\u307e\u3059\u3002\n\u3082\u3061\u308d\u3093\u4eca\u56de\u304c\u521d\u56de\u30ea\u30ea\u30fc\u30b9\u306a\u306e\u3067\u4eca\u5f8c\u3082\u8272\u3005\u6a5f\u80fd\u304c\u8ffd\u52a0\u3055\u308c\u3066\u3044\u304f\u3068\u601d\u3044\u307e\u3059\u3002\n\u671f\u5f85\u5024\u5927\u3067\u3059\u306d\uff01\n\n\u5927\u6a4b\u3067\u3059\u3002\n\u6700\u8fd1GAS\u306e\u8a18\u4e8b\u3070\u304b\u308a\u66f8\u3044\u3066\u3044\u307e\u3059\u306d\u3002\n\n\u672c\u65e5(2014/03/12)Google\u3088\u308aGoogle Docs\u3084Spreadsheets\u3092\u62e1\u5f35\u3067\u304d\u3001\u30e6\u30fc\u30b6\u304cStore\u304b\u3089\u597d\u304d\u306b\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u53ef\u80fd\u306a\n\"add-ons\"\u304c[\u516c\u958b](http://googledrive.blogspot.jp/2014/03/add-ons.html)\u3055\u308c\u307e\u3057\u305f\u3002\n\n![Sheets\u306b\u30a2\u30c8\u3099\u30aa\u30f3\u30e1\u30cb\u30e5\u30fc\u304b\u3099\u8ffd\u52a0\u3055\u308c\u305f.png](https://qiita-image-store.s3.amazonaws.com/0/2965/33b992b6-2e2b-9d0c-c2e2-5e923cc49dbc.png \"Sheets\u306b\u30a2\u30c8\u3099\u30aa\u30f3\u30e1\u30cb\u30e5\u30fc\u304b\u3099\u8ffd\u52a0\u3055\u308c\u305f.png\")\n*Sheets\u306b\u30a2\u30c9\u30aa\u30f3\u30e1\u30cb\u30e5\u30fc\u304c\u8ffd\u52a0\u3055\u308c\u3066\u3044\u308b*\n\n![addons-store.png](https://qiita-image-store.s3.amazonaws.com/0/2965/fc9388c7-1904-3d87-4e70-55895297a77a.png \"addons-store.png\")\n*Google Drive\u3084Chrome Web Store\u306e\u3088\u3046\u306aStore\u304b\u3089\u597d\u304d\u306aadd-ons\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3067\u304d\u308b*\n\n![add-ons\u7ba1\u7406.png](https://qiita-image-store.s3.amazonaws.com/0/2965/b5aa2990-3ac7-3199-01e7-a70add7bef57.png \"add-ons\u7ba1\u7406.png\")\n*\u4e00\u5ea6\u5225\u306eSheets\u306a\u3069\u3067\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u305fadd-ons\u306f\u5225\u306eSheet\u3067\u3082\u300c\u30a2\u30c9\u30aa\u30f3\u3092\u7ba1\u7406\u300d\u30e1\u30cb\u30e5\u30fc\u304b\u3089\u5229\u7528\u53ef\u80fd\u72b6\u614b\u306b\u3067\u304d\u308b*\n\nadd-ons\u306e\u958b\u767a\u306b\u306fGoogle Apps Script\u3092\u5229\u7528\u3057\u307e\u3059\u3002\n\u4eca\u56de\u306f\u3069\u306e\u3088\u3046\u306badd-ons\u3092\u4f5c\u308b\u306e\u304b\u3001\u4f55\u304c\u3067\u304d\u308b\u304b\u3092\u66f8\u3044\u3066\u3044\u304d\u305f\u3044\u3068\u601d\u3044\u307e\u3059\u3002\n\nP.S.\n\u6587\u7ae0\u4e2d\u306eadd-ons\u306b\u95a2\u3059\u308b\u8868\u8a18\u304c\u63fa\u308c\u3066\u3044\u3066\u307e\u3059\u3002\n\u591a\u5206\u6b63\u5f0f\u540d\u79f0\u306fadd-on\u306a\u306e\u3067\u3059\u304c\u516c\u5f0f\u6587\u7ae0\u4e2d\u3067\u3082Add-on\u3060\u3063\u305f\u308aadd-ons\u3060\u3063\u305f\u308aAdd-ons\u3060\u3063\u305f\u308a\u3059\u308b\u306e\u3067\u7d30\u304b\u3044\u3068\u3053\u308d\u306f\u4e0d\u660e\u3067\u3059\u3002( \uff70`\u0434\uff70\u00b4)\uff77\uff98\uff6f\n\n# \u306f\u3058\u3081\u306b\n\n\u3053\u306e\u8a18\u4e8b\u3067\u306f\u57fa\u672c\u7684\u306b\u516c\u5f0f\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u306b\u3042\u308b\u300c[Quickstart: Add-on for Google Docs](https://developers.google.com/apps-script/quickstart/docs)\u300d\u3092\u65e5\u672c\u8a9e\u8a33\u3063\u307d\u3044\u611f\u3058\u3067\u66f8\u3044\u3066\u3044\u304d\u307e\u3059\u304c\u3001\n\u5927\u4e8b\u305d\u3046\u306a\u8a71\u306f\u8a33\u4ee5\u5916\u306b\u3082\u66f8\u3044\u3066\u3044\u3053\u3046\u3068\u601d\u3044\u307e\u3059\u3002\n\n\u307e\u305f\u3082\u3063\u3068\u3082\u91cd\u8981\u306a\u70b9\u3092\u5148\u306b\u3044\u304f\u3064\u304b\u66f8\u3044\u3066\u304a\u304d\u307e\u3059\u3002\n\n## \u91cd\u8981\u306a\u30dd\u30a4\u30f3\u30c8\n\n### Sheets\u5411\u3051\u306eAdd-ons\u306f\u65b0\u3057\u3044\u30b9\u30d7\u30ec\u30c3\u30c9\u30b7\u30fc\u30c8\u3067\u306e\u307f\u5229\u7528\u53ef\u80fd\u3067\u3059\u3002\n\nSheets\u5411\u3051\u306eAdd-ons\u306f\u5148\u65e5\u516c\u958b\u3055\u308c\u305f\u65b0\u3057\u3044\u30b9\u30d7\u30ec\u30c3\u30c9\u30b7\u30fc\u30c8\u3067\u306e\u307f\u5229\u7528\u53ef\u80fd\u3067\u3059\u3002\n\n\n\n### 2014/03/12\u73fe\u5728 Store\u3078\u306e\u516c\u958b\u306fGoogle\u3078\u306e\u7533\u8acb\u304c\u5fc5\u8981\u3067\u3059\u3002\u7533\u8acb\u304c\u901a\u3063\u305f\u5834\u5408\u306e\u307fStore\u3078\u516c\u958b\u304c\u53ef\u80fd\u3067\u3059\n\n~~\u73fe\u72b6\u500b\u4eba\u7684\u306b\u8a66\u3059\u3053\u3068\u306f\u53ef\u80fd\u3067\u3059\u304c\u3001Store\u3078\u306fGoogle\u306e\u7533\u8acb\u304c\u901a\u3063\u305f\u5f8c\u306b\u53ef\u80fd\u306b\u306a\u308a\u307e\u3059\u3002\n\u7533\u8acb\u306f\u4ee5\u4e0b\u306e\u30d5\u30a9\u30fc\u30e0\u304b\u3089\u884c\u3044\u307e\u3059\u3002~~\n\n~~https://docs.google.com/forms/d/1bqpfpEhiiKMqD206LBF4cL6-YdCBKfIKDQaaap8SO-g/viewform~~\n\n2015/10/09\u73fe\u5728 Store\u3078\u306e\u516c\u958b\u306f\u8ab0\u3067\u3082\u53ef\u80fd\u306b\u306a\u308a\u307e\u3057\u305f\u3002\n\n\n### \u8ab2\u91d1\u306e\u4ed5\u7d44\u306f\u7528\u610f\u3055\u308c\u3066\u3044\u307e\u305b\u3093\u3002\n\n\u516c\u958b\u3057\u3066\u3082\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u6642\u306b\u8ab2\u91d1\u307f\u305f\u3044\u306a\u4ed5\u7d44\u306f\u73fe\u72b6\u7528\u610f\u3055\u308c\u3066\u3044\u307e\u305b\u3093\u3002\n\u8ab2\u91d1\u3092\u884c\u3044\u305f\u3044\u5834\u5408\u306f[Google Wallet API](https://developers.google.com/wallet/)\u306e\u3088\u3046\u306aAPI\u3092\u5229\u7528\u3057\u305f\u308a\u3001\u4f55\u304b\u3057\u3089\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u5185\u3067\u4ed5\u7d44\u3092\u63d0\u4f9b\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\n\n\u307e\u305f\u898f\u7d04\u4e0a\u3001\u5e83\u544a\u3092\u8f09\u305b\u308b\u3053\u3068\u3082\u3067\u304d\u307e\u305b\u3093\u3002\n\n### GAS\u4ee5\u5916\u3067\u306e\u958b\u767a\u306f\u3067\u304d\u307e\u305b\u3093\n\nGAS\u306e\u5236\u7d04\u306b\u8272\u3005\u7e1b\u3089\u308c\u307e\u3059\u3002\u7e1b\u3089\u308c\u307e\u3059\u3002\u7e1b\u3089(ry\n\n### \u5404\u30dc\u30bf\u30f3\u306a\u3069\u306e\u898b\u305f\u76ee\u304cGoogle\u306b\u8fd1\u3065\u304f\u3088\u3046\u306acss\u30d5\u30a1\u30a4\u30eb\u304c\u63d0\u4f9b\u3055\u308c\u3066\u3044\u307e\u3059\u3002\n\n\u3053\u307e\u3044\u90e8\u5206\u306f[\u3053\u3061\u3089](https://developers.google.com/apps-script/add-ons/css)\u3092\u898b\u3066\u4e0b\u3055\u3044\u3002\n\u3082\u3061\u308d\u3093\u4efb\u610f\u306eCSS\u3092\u5229\u7528\u3059\u308b\u3053\u3068\u3082\u53ef\u80fd\u3067\u3059\u304cSpreadsheet\u306a\u3069\u306b\u57cb\u3081\u8fbc\u307e\u308c\u308b\u305f\u3081\u3001 Look & Feel\u304c\u305d\u308d\u3063\u3066\u3044\u305f\u307b\u3046\u304c\u826f\u3044\u3067\u3057\u3087\u3046\u3002\n\n---\n\n\u306a\u304a\u7ffb\u8a33\u5143\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u306f [Creative Commons Attribution 3.0 License](http://creativecommons.org/licenses/by/3.0/) \u306e\u30e9\u30a4\u30bb\u30f3\u30b9\u3067\u3059\u3002\n\u4ee5\u4e0b\u7279\u306b\u8a18\u8f09\u304c\u306a\u3051\u308c\u3070\u540c\u69d8\u306e\u30e9\u30a4\u30bb\u30f3\u30b9\u3068\u306a\u308a\u307e\u3059\u3002\n\u307e\u305f\u30b3\u30fc\u30c9\u306b\u3064\u3044\u3066\u306f[Apache 2.0 License](http://www.apache.org/licenses/LICENSE-2.0)\u3068\u306a\u308a\u307e\u3059\u3002\n\u4ee5\u4e0b\u7279\u306b\u8a18\u8f09\u304c\u306a\u3051\u308c\u3070\u540c\u69d8\u306e\u30e9\u30a4\u30bb\u30f3\u30b9\u3068\u306a\u308a\u307e\u3059\u3002\n\n---\n\n# Quickstart: Add-on for Google Docs(\u65e5\u672c\u8a9e\u8a33)\n\n>Complete the steps described in the rest of this page, and in about five minutes you'll have created a Google Docs [add-on](https://developers.google.com/apps-script/add-ons) that translates text in a sidebar. To see what the add-on looks like when it's finished, just [install Translate](https://chrome.google.com/webstore/detail/translate/nejfnokhglmkjgpkjooijcddfecjggan) from the Google Docs add-ons store.\n\n\u3053\u306e\u30da\u30fc\u30b8\u3067\u306f\u7d045\u5206\u3067\u30b5\u30a4\u30c9\u30d0\u30fc\u4e2d\u3067\u7ffb\u8a33\u3092\u884c\u3046\u3001Google Docs [add-on](https://developers.google.com/apps-script/add-ons) \u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\nadd-on\u3092\u4f5c\u6210\u3057\u7d42\u308f\u3063\u305f\u969b\u306e\u898b\u305f\u76ee\u3084\u3001\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u6642\u306e\u6319\u52d5\u306f\u30a2\u30c9\u30aa\u30f3\u30b9\u30c8\u30a2\u3088\u308a[Translate](https://chrome.google.com/webstore/detail/translate/nejfnokhglmkjgpkjooijcddfecjggan)\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u3066\u307f\u3066\u304f\u3060\u3055\u3044\u3002\n\n\n![](https://developers.google.com/apps-script/images/quickstart-translate.png)\n\n## \u76ee\u6b21\n\n* Set it up\n* Try it out\n* Publish\n* Lean more\n\n## Set it up(\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7)\n\n>1. Create a [new Google Doc](https://drive.google.com/document).\n2. From within your new document, select the menu item **Tools** > **Script editor**. If you are presented with a welcome screen, click **Blank Project**.\n3. Delete any code in the script editor and paste in the code below.\n4. Create a new file by selecting the menu item **File** > **New** > **Html** file. Name the file \"Sidebar\".\n5. Delete any code in the new editor tab and paste in the code below.\n6. Select the menu item File > Save all. Name your new script \"Translate Quickstart\" and click OK (The script's name is shown to end users in several places, including the authorization dialog.)\n\n\n1. \u65b0\u3057\u3044[Google Document](https://drive.google.com/document)\u3092\u4f5c\u308a\u307e\u3059\u3002\u203b\u30ea\u30f3\u30af\u3092\u30af\u30ea\u30c3\u30af\u3059\u308b\u3068\u65b0\u3057\u3044Google Document\u304c\u3067\u304d\u307e\u3059\n2. \u65b0\u3057\u304f\u4f5c\u6210\u3057\u305fDocument\u3067 **\u300c\u30e1\u30cb\u30e5\u30fc\u300d** > **\u300c\u30b9\u30af\u30ea\u30d7\u30c8 \u30a8\u30c7\u30a3\u30bf\u2026\u300d** \u3092\u9078\u629e\u3057\u307e\u3059\u3002\u3082\u3057\u300cWelcome\u300d\u753b\u9762\u304c\u51fa\u305f\u5834\u5408\u306f **Blank Project**\u3092\u9078\u629e\u3057\u307e\u3059\u3002\n3. \u65e2\u306b\u30b9\u30af\u30ea\u30d7\u30c8\u30a8\u30c7\u30a3\u30bf\u306b\u8a18\u8f09\u3055\u308c\u3066\u3044\u308b\u30b3\u30fc\u30c9\u3092\u524a\u9664\u3057\u3001\u4e0b\u8a18\u30b3\u30fc\u30c9(`code.gs`)\u3092\u8cbc\u308a\u4ed8\u3051\u307e\u3059\u3002\n4. \u30b9\u30af\u30ea\u30d7\u30c8\u30a8\u30c7\u30a3\u30bf\u306e\u30e1\u30cb\u30e5\u30fc\u304b\u3089 **\u300c\u30d5\u30a1\u30a4\u30eb\u300d** > **\u300c\u65b0\u898f\u4f5c\u6210\u300d** > **\u300cHTML \u30d5\u30a1\u30a4\u30eb\u300d**\u3092\u9078\u629e\u3057\u3001\u65b0\u3057\u3044HTML\u30d5\u30a1\u30a4\u30eb\u3092`Sidebar`\u3068\u3044\u3046\u30d5\u30a1\u30a4\u30eb\u540d\u3067\u4f5c\u6210\u3057\u307e\u3059\n5. \u8a18\u8f09\u6e08\u307f\u306eHTML\u3092\u524a\u9664\u3057\u3001 \u4e0b\u8a18HTML(`Sidebar.html`)\u3092\u30b3\u30d4\u30da\u3057\u307e\u3059\u3002\n6. \u30e1\u30cb\u30e5\u30fc\u304b\u3089 **\u300c\u30d5\u30a1\u30a4\u30eb\u300d** > **\u300c\u3059\u3079\u3066\u3092\u4fdd\u5b58\u300d** \u3092\u9078\u629e\u3057\u307e\u3059\u3002\u30b9\u30af\u30ea\u30d7\u30c8\u306e\u540d\u524d\u306e\u8a2d\u5b9a\u3092\u6c42\u3081\u3089\u308c\u308b\u306e\u3067\u3001\u300cTranslate Quickstart\u300d\u3068\u540d\u3065\u3051\u307e\u3059\u3002\u3053\u306e\u540d\u524d\u306f\u30e6\u30fc\u30b6\u306e\u81f3\u308b\u6240\u3067\u76ee\u306b\u89e6\u308c\u307e\u3059\u3002\n\n\n```js:code.gs\n/**\n * Creates a menu entry in the Google Docs UI when the document is opened.\n */\nfunction onOpen() {\n  DocumentApp.getUi().createAddonMenu()\n      .addItem('Start', 'showSidebar')\n      .addToUi();\n}\n\n/**\n * Runs when the add-on is installed.\n */\nfunction onInstall() {\n  onOpen();\n}\n\n/**\n * Opens a sidebar in the document containing the add-on's user interface.\n */\nfunction showSidebar() {\n  var ui = HtmlService.createHtmlOutputFromFile('Sidebar')\n      .setTitle('Translate');\n  DocumentApp.getUi().showSidebar(ui);\n}\n\n/**\n * Gets the text the user has selected. If there is no selection,\n * this function displays an error message.\n *\n * @return {Array.<string>} The selected text.\n */\nfunction getSelectedText() {\n  var selection = DocumentApp.getActiveDocument().getSelection();\n  if (selection) {\n    var text = [];\n    var elements = selection.getSelectedElements();\n    for (var i = 0; i < elements.length; i++) {\n      if (elements[i].isPartial()) {\n        var element = elements[i].getElement().asText();\n        var startIndex = elements[i].getStartOffset();\n        var endIndex = elements[i].getEndOffsetInclusive();\n\n        text.push(element.getText().substring(startIndex, endIndex + 1));\n      } else {\n        var element = elements[i].getElement();\n        // Only translate elements that can be edited as text; skip images and\n        // other non-text elements.\n        if (element.editAsText) {\n          var elementText = element.asText().getText();\n          // This check is necessary to exclude images, which return a blank\n          // text element.\n          if (elementText != '') {\n            text.push(elementText);\n          }\n        }\n      }\n    }\n    if (text.length == 0) {\n      throw 'Please select some text.';\n    }\n    return text;\n  } else {\n    throw 'Please select some text.';\n  }\n}\n\n/**\n * Gets the stored user preferences for the origin and destination languages,\n * if they exist.\n *\n * @return {Object} The user's origin and destination language preferences, if\n *     they exist.\n */\nfunction getPreferences() {\n  var userProperties = PropertiesService.getUserProperties();\n  var languagePrefs = {\n    originLang: userProperties.getProperty('originLang'),\n    destLang: userProperties.getProperty('destLang')\n  };\n  return languagePrefs;\n}\n\n/**\n * Gets the user-selected text and translates it from the origin language to the\n * destination language. The languages are notated by their two-letter short\n * form. For example, English is 'en', and Spanish is 'es'. The origin language\n * may be specified as an empty string to indicate that Google Translate should\n * auto-detect the language.\n *\n * @param {string} origin The two-letter short form for the origin language.\n * @param {string} dest The two-letter short form for the destination language.\n * @param {boolean} savePrefs Whether to save the origin and destination\n *     language preferences.\n * @return {string} The result of the translation.\n */\nfunction runTranslation(origin, dest, savePrefs) {\n  var text = getSelectedText();\n  if (savePrefs == true) {\n    var userProperties = PropertiesService.getUserProperties();\n    userProperties.setProperty('originLang', origin);\n    userProperties.setProperty('destLang', dest);\n  }\n\n  var translated = [];\n  for (var i = 0; i < text.length; i++) {\n    translated.push(LanguageApp.translate(text[i], origin, dest));\n  }\n\n  return translated.join('\\n');\n}\n\n/**\n * Replaces the text of the current selection with the provided text, or\n * inserts text at the current cursor location. (There will always be either\n * a selection or a cursor.) If multiple elements are selected, only inserts the\n * translated text in the first element that can contain text and removes the\n * other elements.\n *\n * @param {string} newText The text with which to replace the current selection.\n */\nfunction insertText(newText) {\n  var selection = DocumentApp.getActiveDocument().getSelection();\n  if (selection) {\n    var replaced = false;\n    var elements = selection.getSelectedElements();\n    if (elements.length == 1 &&\n        elements[0].getElement().getType() ==\n        DocumentApp.ElementType.INLINE_IMAGE) {\n      throw \"Can't insert text into an image.\";\n    }\n    for (var i = 0; i < elements.length; i++) {\n      if (elements[i].isPartial()) {\n        var element = elements[i].getElement().asText();\n        var startIndex = elements[i].getStartOffset();\n        var endIndex = elements[i].getEndOffsetInclusive();\n\n        var remainingText = element.getText().substring(endIndex + 1);\n        element.deleteText(startIndex, endIndex);\n        if (!replaced) {\n          element.insertText(startIndex, newText);\n          replaced = true;\n        } else {\n          // This block handles a selection that ends with a partial element. We\n          // want to copy this partial text to the previous element so we don't\n          // have a line-break before the last partial.\n          var parent = element.getParent();\n          parent.getPreviousSibling().asText().appendText(remainingText);\n          // We cannot remove the last paragraph of a doc. If this is the case,\n          // just remove the text within the last paragraph instead.\n          if (parent.getNextSibling()) {\n            parent.removeFromParent();\n          } else {\n            element.removeFromParent();\n          }\n        }\n      } else {\n        var element = elements[i].getElement();\n        if (!replaced && element.editAsText) {\n          // Only translate elements that can be edited as text, removing other\n          // elements.\n          element.clear();\n          element.asText().setText(newText);\n          replaced = true;\n        } else {\n          // We cannot remove the last paragraph of a doc. If this is the case,\n          // just clear the element.\n          if (element.getNextSibling()) {\n            element.removeFromParent();\n          } else {\n            element.clear();\n          }\n        }\n      }\n    }\n  } else {\n    var cursor = DocumentApp.getActiveDocument().getCursor();\n    var surroundingText = cursor.getSurroundingText().getText();\n    var surroundingTextOffset = cursor.getSurroundingTextOffset();\n\n    // If the cursor follows or preceds a non-space character, insert a space\n    // between the character and the translation. Otherwise, just insert the\n    // translation.\n    if (surroundingTextOffset > 0) {\n      if (surroundingText.charAt(surroundingTextOffset - 1) != ' ') {\n        newText = ' ' + newText;\n      }\n    }\n    if (surroundingTextOffset < surroundingText.length) {\n      if (surroundingText.charAt(surroundingTextOffset) != ' ') {\n        newText += ' ';\n      }\n    }\n    cursor.insertText(newText);\n  }\n}\n\n```\n\n```html:Sidebar.html\n<link rel=\"stylesheet\" href=\"https://ssl.gstatic.com/docs/script/css/add-ons.css\">\n<!-- The CSS package above applies Google styling to buttons and other elements. -->\n\n<style>\n.branding-below {\n  bottom: 56px;\n  top: 0;\n}\n\n.branding-text {\n  left: 7px;\n  position: relative;\n  top: 3px;\n}\n\n.col-contain {\n  overflow: hidden;\n}\n\n.col-one {\n  float: left;\n  width: 50%;\n}\n\n.logo {\n  vertical-align: middle;\n}\n\n.radio-spacer {\n  height: 20px;\n}\n\n.width-100 {\n  width: 100%;\n}\n</style>\n\n<div class=\"sidebar branding-below\">\n  <form>\n    <div class=\"block col-contain\">\n      <div class=\"col-one\">\n        <b>Selected text</b>\n        <div>\n          <input type=\"radio\" name=\"origin\" id=\"radio-origin-auto\" value=\"\" checked=\"checked\">\n          <label for=\"radio-origin-auto\">Auto-detect</label>\n        </div>\n        <div>\n          <input type=\"radio\" name=\"origin\" id=\"radio-origin-en\" value=\"en\">\n          <label for=\"radio-origin-en\">English</label>\n        </div>\n        <div>\n          <input type=\"radio\" name=\"origin\" id=\"radio-origin-fr\" value=\"fr\">\n          <label for=\"radio-origin-fr\">French</label>\n        </div>\n        <div>\n          <input type=\"radio\" name=\"origin\" id=\"radio-origin-de\" value=\"de\">\n          <label for=\"radio-origin-de\">German</label>\n        </div>\n        <div>\n          <input type=\"radio\" name=\"origin\" id=\"radio-origin-ja\" value=\"ja\">\n          <label for=\"radio-origin-ja\">Japanese</label>\n        </div>\n        <div>\n          <input type=\"radio\" name=\"origin\" id=\"radio-origin-es\" value=\"es\">\n          <label for=\"radio-origin-es\">Spanish</label>\n        </div>\n      </div>\n      <div>\n        <b>Translate into</b>\n        <div class=\"radio-spacer\">\n        </div>\n        <div>\n          <input type=\"radio\" name=\"dest\" id=\"radio-dest-en\" value=\"en\">\n          <label for=\"radio-dest-en\">English</label>\n        </div>\n        <div>\n          <input type=\"radio\" name=\"dest\" id=\"radio-dest-fr\" value=\"fr\">\n          <label for=\"radio-dest-fr\">French</label>\n        </div>\n        <div>\n          <input type=\"radio\" name=\"dest\" id=\"radio-dest-de\" value=\"de\">\n          <label for=\"radio-dest-de\">German</label>\n        </div>\n        <div>\n          <input type=\"radio\" name=\"dest\" id=\"radio-dest-ja\" value=\"ja\" checked=\"checked\">\n          <label for=\"radio-dest-ja\">Japanese</label>\n        </div>\n        <div>\n          <input type=\"radio\" name=\"dest\" id=\"radio-dest-es\" value=\"es\">\n          <label for=\"radio-dest-es\">Spanish</label>\n        </div>\n      </div>\n    </div>\n\n    <div class=\"block form-group\">\n      <label for=\"translated-text\"><b>Translation</b></label>\n      <textarea class=\"width-100\" id=\"translated-text\" rows=\"10\"></textarea>\n    </div>\n\n    <div class=\"block\">\n      <input type=\"checkbox\" id=\"save-prefs\">\n      <label for=\"save-prefs\">Use these languages by default</label>\n    </div>\n\n   <div class=\"block\" id=\"button-bar\">\n      <button class=\"blue\" id=\"run-translation\">Translate</button>\n      <button id=\"insert-text\">Insert</button>\n    </div>\n  </form>\n</div>\n\n<div class=\"sidebar bottom\">\n  <img alt=\"Add-on logo\" class=\"logo\" width=\"27\" height=\"27\"\n      src=\"https://googledrive.com/host/0B0G1UdyJGrY6XzdjQWF4a1JYY1k/translate-logo-small.png\">\n  <span class=\"gray branding-text\">Translate sample by Google</span>\n</div>\n\n<script src=\"//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js\">\n</script>\n<script>\n  /**\n   * On document load, assign click handlers to each button and try to load the\n   * user's origin and destination language preferences if previously set.\n   */\n  $(function() {\n    $('#run-translation').click(runTranslation);\n    $('#insert-text').click(insertText);\n    google.script.run.withSuccessHandler(loadPreferences)\n        .withFailureHandler(showError).getPreferences();\n  });\n\n  /**\n   * Callback function that populates the origin and destination selection\n   * boxes with user preferences from the server.\n   *\n   * @param {Object} languagePrefs The saved origin and destination languages.\n   */\n  function loadPreferences(languagePrefs) {\n    $('input:radio[name=\"origin\"]')\n        .filter('[value=' + languagePrefs.originLang + ']')\n        .attr('checked', true);\n    $('input:radio[name=\"dest\"]')\n        .filter('[value=' + languagePrefs.destLang + ']')\n        .attr('checked', true);\n  }\n\n  /**\n   * Runs a server-side function to translate the user-selected text and update\n   * the sidebar UI with the resulting translation.\n   */\n  function runTranslation() {\n    this.disabled = true;\n    $('#error').remove();\n    var origin = $('input[name=origin]:checked').val();\n    var dest = $('input[name=dest]:checked').val();\n    var savePrefs = $('#save-prefs').is(':checked');\n    google.script.run\n        .withSuccessHandler(\n          function(translatedText, element) {\n            $('#translated-text').val(translatedText);\n            element.disabled = false;\n          })\n        .withFailureHandler(\n          function(msg, element) {\n            showError(msg, $('#button-bar'));\n            element.disabled = false;\n          })\n        .withUserObject(this)\n        .runTranslation(origin, dest, savePrefs);\n  }\n\n  /**\n   * Runs a server-side function to insert the translated text into the document\n   * at the user's cursor or selection.\n   */\n  function insertText() {\n    this.disabled = true;\n    $('#error').remove();\n    google.script.run\n        .withSuccessHandler(\n          function(returnSuccess, element) {\n            element.disabled = false;\n          })\n        .withFailureHandler(\n          function(msg, element) {\n            showError(msg, $('#button-bar'));\n            element.disabled = false;\n          })\n        .withUserObject(this)\n        .insertText($('#translated-text').val());\n  }\n\n  /**\n   * Inserts a div that contains an error message after a given element.\n   *\n   * @param msg The error message to display.\n   * @param element The element after which to display the error.\n   */\n  function showError(msg, element) {\n    var div = $('<div id=\"error\" class=\"error\">' + msg + '</div>');\n    $(element).after(div);\n  }\n</script>\n```\n\n## Try it out (\u8a66\u3057\u3066\u307f\u308b)\n\n>1. Switch back to your document and reload the page.\n2. After a few seconds, a **Translate Quickstart** sub-menu will appear under the **Add-ons** menu. (If you chose a different name for your script, that name will appear instead.) Click **Add-ons > Translate Quickstart > Start**.\n3. A dialog box will appear and tell you that the script requires authorization. Click **Continue**. A second dialog box will then request authorization for specific Google services. Read the notice carefully, then click **Accept**.\n4. A sidebar will appear. To test it, type some text into your document, then select it and click the blue **Translate** button. To replace the text in the document, click **Insert**.\n\n1. Document\u306b\u623b\u3063\u3066\u30ea\u30ed\u30fc\u30c9\u3057\u307e\u3059\u3002\n2. \u30ea\u30ed\u30fc\u30c9\u5f8c\u6570\u79d2\u5f85\u3064\u3068 **\u300c\u30a2\u30c9\u30aa\u30f3\u300d** \u30e1\u30cb\u30e5\u30fc\u5185\u306b **Translate Quickstart** \uff08\u4ed6\u306e\u30b9\u30af\u30ea\u30d7\u30c8\u540d\u306b\u3057\u3066\u3044\u305f\u5834\u5408\u306f\u305d\u306e\u540d\u524d\u3067\u3059\u3002\uff09\u304c\u73fe\u308c\u307e\u3059\u3002 \u30e1\u30cb\u30e5\u30fc\u3088\u308a **\u300c\u30a2\u30c9\u30aa\u30f3\u300d** > **\u300cTranslate Quickstart\u300d** > **\u300cStart\u300d** \u3092\u30af\u30ea\u30c3\u30af\u3057\u307e\u3059\u3002\n3. \u8a8d\u53ef\uff08\u300c\u8a8d\u8a3c\u304c\u5fc5\u8981\u300d\uff09\u30c0\u30a4\u30a2\u30ed\u30b0\u304c\u8868\u793a\u3055\u308c\u305f\u3089 \u300c\u7d9a\u884c\u300d\u30dc\u30bf\u30f3\u3092\u30af\u30ea\u30c3\u30af\u3057\u307e\u3059\u3002 \u3059\u308b\u3068Google\u3078\u306e\u8a31\u53ef\u30ea\u30af\u30a8\u30b9\u30c8\u30c0\u30a4\u30a2\u30ed\u30b0\u304c\u8868\u793a\u3055\u308c\u308b\u306e\u3067\u3001\u300c\u627f\u8a8d\u3059\u308b\u300d\u3092\u30af\u30ea\u30c3\u30af\u3057\u307e\u3059\u3002\n4. \u3059\u308b\u3068Document\u4e2d\u306b\u30b5\u30a4\u30c9\u30d0\u30fc\u304c\u8868\u793a\u3055\u308c\u307e\u3059\u3002\u30c6\u30b9\u30c8\u3092\u884c\u3046\u305f\u3081\u306b\u306f\u3001\u4efb\u610f\u306e\u30c6\u30ad\u30b9\u30c8\u3092Document\u306b\u8a18\u8f09\u3057\u3001\u9078\u629e\u3001\u30b5\u30a4\u30c9\u30d0\u30fc\u306e\u300cTranslate\u300d\u30dc\u30bf\u30f3\u3092\u30af\u30ea\u30c3\u30af\u3057\u307e\u3059\u3002\u7f6e\u63db\u3092\u3059\u308b\u305f\u3081\u306b\u306f\u300cInsert\u300d\u30dc\u30bf\u30f3\u3092\u30af\u30ea\u30c3\u30af\u3057\u307e\u3059\u3002\n\n## Publish (\u516c\u958b\u3059\u308b)\n\n> Since this is an example add-on, our tutorial ends here. If you were developing a real add-on, the last step would be to [publish](https://developers.google.com/apps-script/add-ons/publish) it for other people to find and install. To learn more, check out our [add-ons guide](https://developers.google.com/add-ons).\n\n\u3053\u3053\u3067\u3053\u306e\u30b5\u30f3\u30d7\u30eb\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u5229\u7528\u3057\u305fAdd-ons\u306e\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb\u306f\u5b8c\u4e86\u3067\u3059\u3002\n\u3082\u3057\u672c\u5f53\u306eadd-ons\u3092\u4f5c\u6210\u3057\u305f\u3044\u5834\u5408\u306f\u3001\u6700\u7d42\u30b9\u30c6\u30c3\u30d7\u3068\u3057\u3066\u4ed6\u306e\u4eba\u306b\u63a2\u3057\u3066\u3001\u4f7f\u3063\u3066\u3082\u3089\u3046\u305f\u3081\u306b[\u516c\u958b](https://developers.google.com/apps-script/add-ons/publish)\u3057\u305f\u3044\u3068\u8003\u3048\u308b\u3068\u601d\u3044\u307e\u3059\u3002  \u3053\u308c\u3092\u5b66\u3076\u306b\u306f[Guide](https://developers.google.com/add-ons)\u3092\u5fa1\u89a7\u304f\u3060\u3055\u3044\u3002\n\n## Lean more\n\n> To continue learning about how to extend Google Docs with Apps Script, take a look at the following resources:\n\n\nApps Script\u3092\u5229\u7528\u3057Google Docs\u3092\u62e1\u5f35\u3059\u308b\u65b9\u6cd5\u3092\u3088\u308a\u5b66\u3073\u305f\u3044\u5834\u5408\u306f\u3001\u4e0b\u8a18\u306e\u8cc7\u6599\u304c\u53c2\u8003\u306b\u306a\u308a\u307e\u3059\u3002\n\n* [Guide to Add-ons](https://developers.google.com/apps-script/add-ons)\n* [Extending Google Docs](https://developers.google.com/apps-script/guides/docs)\n* [Document Service Reference](Document Service Reference)\n\n# \u307e\u3068\u3081\n\n\u3044\u304b\u304c\u3067\u3057\u305f\u3067\u3057\u3087\u3046\u304b\uff1f\n~~\u4eca\u306e\u3068\u3053\u308d\u7533\u8acb\u304c\u5fc5\u8981\u306a\u306e\u3067\u3061\u3087\u3063\u3068\u6577\u5c45\u304c\u9ad8\u3044\u3088\u3046\u306b\u611f\u3058\u308b\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u304c\u3001~~\n\u30e6\u30fc\u30b6\u304c\u81ea\u7531\u306b\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u53ef\u80fd\u306aadd-on\u306f\u4eca\u307e\u3067\u306eGAS\u3067\u9762\u5012\u81ed\u304b\u3063\u305f\u90e8\u5206\u3092\u975e\u5e38\u306b\u3088\u304f\u89e3\u6d88\u3057\u3001\n\u307e\u305f\u3088\u308a\u9ad8\u5ea6\u306a\u6a5f\u80fd\u3082\u4f5c\u308b\u3053\u3068\u304c\u3067\u304d\u308b\u975e\u5e38\u306b\u9b45\u529b\u7684\u306a\u30d7\u30e9\u30c3\u30c8\u30d5\u30a9\u30fc\u30e0\u306b\u306a\u3063\u3066\u3044\u308b\u3068\u601d\u3044\u307e\u3059\u3002\n\n\u3082\u3061\u308d\u3093\u4eca\u56de\u304c\u521d\u56de\u30ea\u30ea\u30fc\u30b9\u306a\u306e\u3067\u4eca\u5f8c\u3082\u8272\u3005\u6a5f\u80fd\u304c\u8ffd\u52a0\u3055\u308c\u3066\u3044\u304f\u3068\u601d\u3044\u307e\u3059\u3002\n\u671f\u5f85\u5024\u5927\u3067\u3059\u306d\uff01\n", "tags": ["JavaScript", "GoogleAppsScript"]}