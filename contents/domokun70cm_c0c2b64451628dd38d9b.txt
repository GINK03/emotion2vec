{"tags": ["AWS", "aws-cli", "kms"], "context": "\n\n\u3053\u306e\u30cf\u30f3\u30ba\u30aa\u30f3\u306b\u3064\u3044\u3066\n\u3053\u306e\u624b\u9806\u306f\u3001JAWS-UG CLI\u5c02\u9580\u652f\u90e8 #58 KMS\u5165\u9580\u3067\u5b9f\u65bd\u3057\u305f\u3082\u306e\u3067\u3059\u3002\n\n\u524d\u63d0\u6761\u4ef6\n\n\u5fc5\u8981\u306a\u6a29\u9650\n\u4f5c\u696d\u306b\u3042\u305f\u3063\u3066\u306f\u3001\u4ee5\u4e0b\u306e\u6a29\u9650\u3092\u6709\u3057\u305fIAM\u30e6\u30fc\u30b6\u3082\u3057\u304f\u306fIAM\u30ed\u30fc\u30eb\u3092\u5229\u7528\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\nKMS\u306b\u5bfe\u3059\u308b\u30d5\u30eb\u30b3\u30f3\u30c8\u30ed\u30fc\u30eb\u6a29\u9650\nS3\u306b\u95a2\u3059\u308b\u30d5\u30eb\u30b3\u30f3\u30c8\u30ed\u30fc\u30eb\u6a29\u9650\nSTS\u306b\u95a2\u3059\u308b\u30d5\u30eb\u30b3\u30f3\u30c8\u30ed\u30fc\u30eb\u6a29\u9650\nIAM\u306b\u95a2\u3059\u308b\u30d5\u30eb\u30b3\u30f3\u30c8\u30ed\u30fc\u30eb\u6a29\u9650\n\n\n0. \u6e96\u5099\n\n0.1. \u30ea\u30fc\u30b8\u30e7\u30f3\u3092\u6307\u5b9a\n\n\u30b3\u30de\u30f3\u30c9\nexport AWS_DEFAULT_REGION='ap-northeast-1'\n\n\n\n0.2. \u8cc7\u683c\u60c5\u5831\u3092\u78ba\u8a8d\n\n\u30b3\u30de\u30f3\u30c9\naws configure list\n\n\n\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u30d7\u30ed\u30d5\u30a1\u30a4\u30eb\u3092\u8a2d\u5b9a\u3057\u305fEC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u3067\u30a2\u30af\u30bb\u30b9\u30ad\u30fc\u3092\u8a2d\u5b9a\u305b\u305a\u306b\u5b9f\u884c\u3057\u305f\u5834\u5408\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\n\n\u7d50\u679c\nName                    Value             Type    Location\n----                    -----             ----    --------\nprofile                <not set>             None    None\naccess_key     ****************RDPA         iam-role\nsecret_key     ****************9GA8         iam-role\nregion           ap-northeast-1              env    AWS_DEFAULT_REGION\n\n\n\n0.3. \u30d0\u30fc\u30b8\u30e7\u30f3\u78ba\u8a8d\n\n\u30b3\u30de\u30f3\u30c9\naws --version\n\n\n\n\u7d50\u679c\naws-cli/1.10.56 Python/2.7.10 Linux/4.4.15-25.57.amzn1.x86_64 botocore/1.4.46\n\n\n\n0.4. \u30d0\u30fc\u30b8\u30e7\u30f3\u30a2\u30c3\u30d7\uff08\u5fc5\u8981\u306b\u5fdc\u3058\u3066\uff09\n\n\u30b3\u30de\u30f3\u30c9\nsudo pip install -U awscli\n\n\n\n0.5. \u5909\u6570\u306e\u8a2d\u5b9a\n\n\u30b3\u30de\u30f3\u30c9\nADMIN_NAME='jawsug-cli-admin'\n\nUSER_NAME='jawsug-cli-user'\n\nARN_S3='arn:aws:iam::aws:policy/AmazonS3FullAccess'\n\nAWS_ID=$(aws sts get-caller-identity \\\n    --query Account \\\n    --output text) \\\n    && echo ${AWS_ID}\n\nBUCKET_NAME=\"kms-test-${AWS_ID}\" \\\n    && echo ${BUCKET_NAME}\n\nALIAS=\"alias/cli-handson0815\"\n\nKEY_ID=$(aws kms list-aliases \\\n    --query \"Aliases[?AliasName == \\`${ALIAS}\\`].TargetKeyId\" \\\n    --output text) \\\n    && echo ${KEY_ID}\n\n\n\n1. S3\u30d0\u30b1\u30c3\u30c8\u306e\u524a\u9664\n\n1.0 \u30e6\u30fc\u30b6\u306e\u5207\u308a\u66ff\u3048\n\u3053\u3053\u3067\u3001\u6700\u521d\u306b\u5229\u7528\u3057\u3066\u3044\u305f\u8a8d\u8a3c\u60c5\u5831\u306b\u5207\u308a\u66ff\u3048\u307e\u3059\u3002\n\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u30d7\u30ed\u30d5\u30a1\u30a4\u30eb\u3092\u5229\u7528\u3057\u3066\u3044\u305f\u5834\u5408\u306f\u3001\u74b0\u5883\u5909\u6570\u3092\u30ea\u30bb\u30c3\u30c8\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n\u30b3\u30de\u30f3\u30c9\nunset AWS_DEFAULT_PROFILE\n\n\n\n\u30b3\u30de\u30f3\u30c9\naws configure list\n\n\n\n\u7d50\u679c\n      Name                    Value             Type    Location\n      ----                    -----             ----    --------\n   profile                <not set>             None    None\naccess_key     ****************EPRQ         iam-role\nsecret_key     ****************RQyb         iam-role\n    region           ap-northeast-1              env    AWS_DEFAULT_REGION\n\n\n\u5225\u306e\u30d7\u30ed\u30d5\u30a1\u30a4\u30eb\u3092\u5229\u7528\u3057\u3066\u3044\u305f\u5834\u5408\u306b\u306f\u3001\u30d7\u30ed\u30d5\u30a1\u30a4\u30eb\u3092\u5207\u308a\u66ff\u3048\u3066\u304f\u3060\u3055\u3044\u3002\n\n\u30b3\u30de\u30f3\u30c9\nexport AWS_DEFAULT_PROFILE='\uff08\u5207\u308a\u66ff\u3048\u524d\u306e\u30d7\u30ed\u30d5\u30a1\u30a4\u30eb\u540d\uff09'\n\n\n\n\u30b3\u30de\u30f3\u30c9\naws configure list\n\n\n\n1.1. S3\u30d0\u30b1\u30c3\u30c8\u306e\u524a\u9664\uff08\u30d1\u30e9\u30e1\u30fc\u30bf\u306e\u78ba\u8a8d\uff09\n\n\u30b3\u30de\u30f3\u30c9\ncat << ETX\n\n    BUCKET_NAME: ${BUCKET_NAME}\n\nETX\n\n\n\n\u7d50\u679c\n\n    BUCKET_NAME: kms-test-************\n\n\n\n\n1.2. S3\u30d0\u30b1\u30c3\u30c8\u306e\u524a\u9664\n\n\u30b3\u30de\u30f3\u30c9\naws s3 rb s3://${BUCKET_NAME} \\\n    --force\n\n\n\n\u7d50\u679c\ndelete: s3://kms-test-************/test.txt\nremove_bucket: s3://kms-test-************/\n\n\n\n2. \u30ab\u30b9\u30bf\u30de\u30fc\u30de\u30b9\u30bf\u30fc\u30ad\u30fc\u306e\u524a\u9664\n\n2.1. \u30ab\u30b9\u30bf\u30de\u30fc\u30de\u30b9\u30bf\u30fc\u30ad\u30fc\u306e\u524a\u9664\uff08\u30d1\u30e9\u30e1\u30fc\u30bf\u306e\u78ba\u8a8d\uff09\n\n\u30b3\u30de\u30f3\u30c9\ncat << ETX\n\n    KEY_ID: ${KEY_ID}\n\nETX\n\n\n\n\u7d50\u679c\n\n    KEY_ID: ********-****-****-****-************\n\n\n\n\n2.2. \u30ab\u30b9\u30bf\u30de\u30fc\u30de\u30b9\u30bf\u30fc\u30ad\u30fc\u306e\u524a\u9664\n\u524a\u9664\u4fdd\u7559\u671f\u9593\u306f7\u65e5\u304c\u6700\u5c0f\u5024\u3067\u3059\u3002\nhttp://docs.aws.amazon.com/cli/latest/reference/kms/schedule-key-deletion.html\n\n\u30b3\u30de\u30f3\u30c9\naws kms schedule-key-deletion \\\n    --key-id ${KEY_ID} \\\n    --pending-window-in-days 7\n\n\n\n\u7d50\u679c\n{\n    \"KeyId\": \"arn:aws:kms:ap-northeast-1:************:key/********-****-****-****-************\",\n    \"DeletionDate\": 1471219200.0\n}\n\n\n\n2.3. \u30ab\u30b9\u30bf\u30de\u30fc\u30de\u30b9\u30bf\u30fc\u30ad\u30fc\u306e\u524a\u9664\uff08\u78ba\u8a8d\uff09\nKeyState\u304c\u5909\u308f\u308b\u307e\u3067\u306b\u5c11\u3005\u6642\u9593\u304c\u304b\u304b\u308b\u3088\u3046\u3067\u3059\u3002\nPendingDeletion\u306b\u306a\u3063\u3066\u3044\u308c\u3070\u6210\u529f\u3067\u3059\u3002\n\n\u30b3\u30de\u30f3\u30c9\naws kms describe-key \\\n    --key-id ${KEY_ID}\n\n\n\n\u7d50\u679c\n{\n    \"KeyMetadata\": {\n        \"KeyId\": \"********-****-****-****-************\",\n        \"Description\": \"JAWS-UG CLI 58 KMS at Co-Edo\",\n        \"DeletionDate\": 1471219200.0,\n        \"Enabled\": false,\n        \"KeyUsage\": \"ENCRYPT_DECRYPT\",\n        \"KeyState\": \"PendingDeletion\",\n        \"CreationDate\": 1470540911.677,\n        \"Arn\": \"arn:aws:kms:ap-northeast-1:************:key/********-****-****-****-************\",\n        \"AWSAccountId\": \"************\"\n    }\n}\n\n\n\n3. IAM\u30e6\u30fc\u30b6\u306e\u524a\u9664\n\n3.1. \u5909\u6570\u306e\u78ba\u8a8d\n\n\u30b3\u30de\u30f3\u30c9\ncat << ETX\n\n    ADMIN_NAME: ${ADMIN_NAME}\n    USER_NAME: ${USER_NAME}\n\nETX\n\n\n\n\u7d50\u679c\n\n    ADMIN_NAME: jawsug-cli-admin\n    USER_NAME: jawsug-cli-user\n\n\n\n\n3.2. \u30a2\u30af\u30bb\u30b9\u30ad\u30fc\u306e\u524a\u9664\n\n\u30b3\u30de\u30f3\u30c9\naws iam delete-access-key \\\n    --user-name ${ADMIN_NAME} \\\n    --access-key-id \"$(cat ${ADMIN_NAME}.json | jq -r .AccessKey.AccessKeyId)\"\n\n\n\n\u7d50\u679c\n\uff08\u623b\u308a\u5024\u7121\u3057\uff09\n\n\n\n\u30b3\u30de\u30f3\u30c9\naws iam delete-access-key \\\n    --user-name ${USER_NAME} \\\n    --access-key-id \"$(cat ${USER_NAME}.json | jq -r .AccessKey.AccessKeyId)\"\n\n\n\n\u7d50\u679c\n\uff08\u623b\u308a\u5024\u7121\u3057\uff09\n\n\n\n3.3. Managed Policy\u306e\u30c7\u30bf\u30c3\u30c1\n\n\u30b3\u30de\u30f3\u30c9\naws iam detach-user-policy \\\n    --user-name ${USER_NAME} \\\n    --policy-arn ${ARN_S3}\n\n\n\n\u7d50\u679c\n\uff08\u623b\u308a\u5024\u7121\u3057\uff09\n\n\n\n3.4. IAM\u30e6\u30fc\u30b6\u306e\u524a\u9664\n\n\u30b3\u30de\u30f3\u30c9\naws iam delete-user \\\n    --user-name ${ADMIN_NAME}\n\n\n\n\u7d50\u679c\n\uff08\u623b\u308a\u5024\u7121\u3057\uff09\n\n\n\n\u30b3\u30de\u30f3\u30c9\naws iam delete-user \\\n    --user-name ${USER_NAME}\n\n\n\n\u7d50\u679c\n\uff08\u623b\u308a\u5024\u7121\u3057\uff09\n\n\n\n3.5. \u78ba\u8a8d\n\n\u30b3\u30de\u30f3\u30c9\naws iam get-user \\\n    --user-name ${ADMIN_NAME}\n\n\n\n\u7d50\u679c\nAn error occurred (NoSuchEntity) when calling the GetUser operation: The user with name jawsug-cli-admin cannot be found.\n\n\n\n\u30b3\u30de\u30f3\u30c9\naws iam get-user \\\n    --user-name ${USER_NAME}\n\n\n\n\u7d50\u679c\nAn error occurred (NoSuchEntity) when calling the GetUser operation: The user with name jawsug-cli-user cannot be found.\n\n\n\u4ee5\u4e0a\n\u304a\u75b2\u308c\u69d8\u3067\u3057\u305f\u3002\n# \u3053\u306e\u30cf\u30f3\u30ba\u30aa\u30f3\u306b\u3064\u3044\u3066\n\n\u3053\u306e\u624b\u9806\u306f\u3001[JAWS-UG CLI\u5c02\u9580\u652f\u90e8 #58 KMS\u5165\u9580](https://manage.doorkeeper.jp/groups/jawsug-cli/events/41911)\u3067\u5b9f\u65bd\u3057\u305f\u3082\u306e\u3067\u3059\u3002\n\n\n# \u524d\u63d0\u6761\u4ef6\n\n## \u5fc5\u8981\u306a\u6a29\u9650\n\n\u4f5c\u696d\u306b\u3042\u305f\u3063\u3066\u306f\u3001\u4ee5\u4e0b\u306e\u6a29\u9650\u3092\u6709\u3057\u305fIAM\u30e6\u30fc\u30b6\u3082\u3057\u304f\u306fIAM\u30ed\u30fc\u30eb\u3092\u5229\u7528\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n- KMS\u306b\u5bfe\u3059\u308b\u30d5\u30eb\u30b3\u30f3\u30c8\u30ed\u30fc\u30eb\u6a29\u9650\n- S3\u306b\u95a2\u3059\u308b\u30d5\u30eb\u30b3\u30f3\u30c8\u30ed\u30fc\u30eb\u6a29\u9650\n- STS\u306b\u95a2\u3059\u308b\u30d5\u30eb\u30b3\u30f3\u30c8\u30ed\u30fc\u30eb\u6a29\u9650\n- IAM\u306b\u95a2\u3059\u308b\u30d5\u30eb\u30b3\u30f3\u30c8\u30ed\u30fc\u30eb\u6a29\u9650\n\n\n# 0. \u6e96\u5099\n\n## 0.1. \u30ea\u30fc\u30b8\u30e7\u30f3\u3092\u6307\u5b9a\n\n```bash:\u30b3\u30de\u30f3\u30c9\nexport AWS_DEFAULT_REGION='ap-northeast-1'\n```\n\n## 0.2. \u8cc7\u683c\u60c5\u5831\u3092\u78ba\u8a8d\n\n\n```bash:\u30b3\u30de\u30f3\u30c9\naws configure list\n```\n\n\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u30d7\u30ed\u30d5\u30a1\u30a4\u30eb\u3092\u8a2d\u5b9a\u3057\u305fEC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u3067\u30a2\u30af\u30bb\u30b9\u30ad\u30fc\u3092\u8a2d\u5b9a\u305b\u305a\u306b\u5b9f\u884c\u3057\u305f\u5834\u5408\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\n\n```text:\u7d50\u679c\nName                    Value             Type    Location\n----                    -----             ----    --------\nprofile                <not set>             None    None\naccess_key     ****************RDPA         iam-role\nsecret_key     ****************9GA8         iam-role\nregion           ap-northeast-1              env    AWS_DEFAULT_REGION\n```\n\n## 0.3. \u30d0\u30fc\u30b8\u30e7\u30f3\u78ba\u8a8d\n\n```bash:\u30b3\u30de\u30f3\u30c9\naws --version\n```\n\n```text:\u7d50\u679c\naws-cli/1.10.56 Python/2.7.10 Linux/4.4.15-25.57.amzn1.x86_64 botocore/1.4.46\n```\n\n## 0.4. \u30d0\u30fc\u30b8\u30e7\u30f3\u30a2\u30c3\u30d7\uff08\u5fc5\u8981\u306b\u5fdc\u3058\u3066\uff09\n\n```bash:\u30b3\u30de\u30f3\u30c9\nsudo pip install -U awscli\n```\n\n## 0.5. \u5909\u6570\u306e\u8a2d\u5b9a\n\n```bash:\u30b3\u30de\u30f3\u30c9\nADMIN_NAME='jawsug-cli-admin'\n\nUSER_NAME='jawsug-cli-user'\n\nARN_S3='arn:aws:iam::aws:policy/AmazonS3FullAccess'\n\nAWS_ID=$(aws sts get-caller-identity \\\n    --query Account \\\n    --output text) \\\n    && echo ${AWS_ID}\n\nBUCKET_NAME=\"kms-test-${AWS_ID}\" \\\n    && echo ${BUCKET_NAME}\n\nALIAS=\"alias/cli-handson0815\"\n\nKEY_ID=$(aws kms list-aliases \\\n    --query \"Aliases[?AliasName == \\`${ALIAS}\\`].TargetKeyId\" \\\n    --output text) \\\n    && echo ${KEY_ID}\n```\n\n\n# 1. S3\u30d0\u30b1\u30c3\u30c8\u306e\u524a\u9664\n\n## 1.0 \u30e6\u30fc\u30b6\u306e\u5207\u308a\u66ff\u3048\n\n\u3053\u3053\u3067\u3001\u6700\u521d\u306b\u5229\u7528\u3057\u3066\u3044\u305f\u8a8d\u8a3c\u60c5\u5831\u306b\u5207\u308a\u66ff\u3048\u307e\u3059\u3002\n\n\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u30d7\u30ed\u30d5\u30a1\u30a4\u30eb\u3092\u5229\u7528\u3057\u3066\u3044\u305f\u5834\u5408\u306f\u3001\u74b0\u5883\u5909\u6570\u3092\u30ea\u30bb\u30c3\u30c8\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n```bash:\u30b3\u30de\u30f3\u30c9\nunset AWS_DEFAULT_PROFILE\n```\n\n```bash:\u30b3\u30de\u30f3\u30c9\naws configure list\n```\n\n```text:\u7d50\u679c\n      Name                    Value             Type    Location\n      ----                    -----             ----    --------\n   profile                <not set>             None    None\naccess_key     ****************EPRQ         iam-role\nsecret_key     ****************RQyb         iam-role\n    region           ap-northeast-1              env    AWS_DEFAULT_REGION\n```\n\n\u5225\u306e\u30d7\u30ed\u30d5\u30a1\u30a4\u30eb\u3092\u5229\u7528\u3057\u3066\u3044\u305f\u5834\u5408\u306b\u306f\u3001\u30d7\u30ed\u30d5\u30a1\u30a4\u30eb\u3092\u5207\u308a\u66ff\u3048\u3066\u304f\u3060\u3055\u3044\u3002\n\n```bash:\u30b3\u30de\u30f3\u30c9\nexport AWS_DEFAULT_PROFILE='\uff08\u5207\u308a\u66ff\u3048\u524d\u306e\u30d7\u30ed\u30d5\u30a1\u30a4\u30eb\u540d\uff09'\n```\n\n```bash:\u30b3\u30de\u30f3\u30c9\naws configure list\n```\n\n\n## 1.1. S3\u30d0\u30b1\u30c3\u30c8\u306e\u524a\u9664\uff08\u30d1\u30e9\u30e1\u30fc\u30bf\u306e\u78ba\u8a8d\uff09\n\n```bash:\u30b3\u30de\u30f3\u30c9\ncat << ETX\n\n    BUCKET_NAME: ${BUCKET_NAME}\n\nETX\n```\n\n```text:\u7d50\u679c\n\n    BUCKET_NAME: kms-test-************\n\n```\n\n## 1.2. S3\u30d0\u30b1\u30c3\u30c8\u306e\u524a\u9664\n\n```bash:\u30b3\u30de\u30f3\u30c9\naws s3 rb s3://${BUCKET_NAME} \\\n    --force\n```\n\n```text:\u7d50\u679c\ndelete: s3://kms-test-************/test.txt\nremove_bucket: s3://kms-test-************/\n```\n\n\n# 2. \u30ab\u30b9\u30bf\u30de\u30fc\u30de\u30b9\u30bf\u30fc\u30ad\u30fc\u306e\u524a\u9664\n\n## 2.1. \u30ab\u30b9\u30bf\u30de\u30fc\u30de\u30b9\u30bf\u30fc\u30ad\u30fc\u306e\u524a\u9664\uff08\u30d1\u30e9\u30e1\u30fc\u30bf\u306e\u78ba\u8a8d\uff09\n\n```bash:\u30b3\u30de\u30f3\u30c9\ncat << ETX\n\n    KEY_ID: ${KEY_ID}\n\nETX\n```\n\n```text:\u7d50\u679c\n\n    KEY_ID: ********-****-****-****-************\n\n```\n\n\n## 2.2. \u30ab\u30b9\u30bf\u30de\u30fc\u30de\u30b9\u30bf\u30fc\u30ad\u30fc\u306e\u524a\u9664\n\n\u524a\u9664\u4fdd\u7559\u671f\u9593\u306f7\u65e5\u304c\u6700\u5c0f\u5024\u3067\u3059\u3002\n\nhttp://docs.aws.amazon.com/cli/latest/reference/kms/schedule-key-deletion.html\n\n```bash:\u30b3\u30de\u30f3\u30c9\naws kms schedule-key-deletion \\\n    --key-id ${KEY_ID} \\\n    --pending-window-in-days 7\n```\n\n```json:\u7d50\u679c\n{\n    \"KeyId\": \"arn:aws:kms:ap-northeast-1:************:key/********-****-****-****-************\",\n    \"DeletionDate\": 1471219200.0\n}\n```\n\n## 2.3. \u30ab\u30b9\u30bf\u30de\u30fc\u30de\u30b9\u30bf\u30fc\u30ad\u30fc\u306e\u524a\u9664\uff08\u78ba\u8a8d\uff09\n\nKeyState\u304c\u5909\u308f\u308b\u307e\u3067\u306b\u5c11\u3005\u6642\u9593\u304c\u304b\u304b\u308b\u3088\u3046\u3067\u3059\u3002\n\nPendingDeletion\u306b\u306a\u3063\u3066\u3044\u308c\u3070\u6210\u529f\u3067\u3059\u3002\n\n```bash:\u30b3\u30de\u30f3\u30c9\naws kms describe-key \\\n    --key-id ${KEY_ID}\n```\n\n```json:\u7d50\u679c\n{\n    \"KeyMetadata\": {\n        \"KeyId\": \"********-****-****-****-************\",\n        \"Description\": \"JAWS-UG CLI 58 KMS at Co-Edo\",\n        \"DeletionDate\": 1471219200.0,\n        \"Enabled\": false,\n        \"KeyUsage\": \"ENCRYPT_DECRYPT\",\n        \"KeyState\": \"PendingDeletion\",\n        \"CreationDate\": 1470540911.677,\n        \"Arn\": \"arn:aws:kms:ap-northeast-1:************:key/********-****-****-****-************\",\n        \"AWSAccountId\": \"************\"\n    }\n}\n```\n\n# 3. IAM\u30e6\u30fc\u30b6\u306e\u524a\u9664\n\n## 3.1. \u5909\u6570\u306e\u78ba\u8a8d\n\n```bash:\u30b3\u30de\u30f3\u30c9\ncat << ETX\n\n    ADMIN_NAME: ${ADMIN_NAME}\n    USER_NAME: ${USER_NAME}\n\nETX\n```\n\n\n```text:\u7d50\u679c\n\n    ADMIN_NAME: jawsug-cli-admin\n    USER_NAME: jawsug-cli-user\n\n```\n\n## 3.2. \u30a2\u30af\u30bb\u30b9\u30ad\u30fc\u306e\u524a\u9664\n\n```bash:\u30b3\u30de\u30f3\u30c9\naws iam delete-access-key \\\n    --user-name ${ADMIN_NAME} \\\n    --access-key-id \"$(cat ${ADMIN_NAME}.json | jq -r .AccessKey.AccessKeyId)\"\n```\n\n```text:\u7d50\u679c\n\uff08\u623b\u308a\u5024\u7121\u3057\uff09\n```\n\n```bash:\u30b3\u30de\u30f3\u30c9\naws iam delete-access-key \\\n    --user-name ${USER_NAME} \\\n    --access-key-id \"$(cat ${USER_NAME}.json | jq -r .AccessKey.AccessKeyId)\"\n```\n\n```text:\u7d50\u679c\n\uff08\u623b\u308a\u5024\u7121\u3057\uff09\n```\n\n## 3.3. Managed Policy\u306e\u30c7\u30bf\u30c3\u30c1\n\n```bash:\u30b3\u30de\u30f3\u30c9\naws iam detach-user-policy \\\n    --user-name ${USER_NAME} \\\n    --policy-arn ${ARN_S3}\n```\n\n```text:\u7d50\u679c\n\uff08\u623b\u308a\u5024\u7121\u3057\uff09\n```\n\n## 3.4. IAM\u30e6\u30fc\u30b6\u306e\u524a\u9664\n\n```bash:\u30b3\u30de\u30f3\u30c9\naws iam delete-user \\\n    --user-name ${ADMIN_NAME}\n```\n\n```text:\u7d50\u679c\n\uff08\u623b\u308a\u5024\u7121\u3057\uff09\n```\n\n```bash:\u30b3\u30de\u30f3\u30c9\naws iam delete-user \\\n    --user-name ${USER_NAME}\n```\n\n```text:\u7d50\u679c\n\uff08\u623b\u308a\u5024\u7121\u3057\uff09\n```\n\n## 3.5. \u78ba\u8a8d\n\n\n```bash:\u30b3\u30de\u30f3\u30c9\naws iam get-user \\\n    --user-name ${ADMIN_NAME}\n```\n\n```text:\u7d50\u679c\nAn error occurred (NoSuchEntity) when calling the GetUser operation: The user with name jawsug-cli-admin cannot be found.\n```\n\n\n```bash:\u30b3\u30de\u30f3\u30c9\naws iam get-user \\\n    --user-name ${USER_NAME}\n```\n\n```text:\u7d50\u679c\nAn error occurred (NoSuchEntity) when calling the GetUser operation: The user with name jawsug-cli-user cannot be found.\n```\n\n\u4ee5\u4e0a\n\n\u304a\u75b2\u308c\u69d8\u3067\u3057\u305f\u3002\n"}