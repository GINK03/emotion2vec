{"context": " More than 1 year has passed since last update.\n\n\u5fc5\u9808\u30c4\u30fc\u30eb\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\nVirtualBox 5.0.10\nvagrant 1.7.4\nrbenv 0.4.0-148-g5b9e4f0\nruby 2.1.5\ngem install bundler\n\n\u5404\u81ea\u306e\u74b0\u5883\u3067\u7570\u306a\u308b\u5024\u306e\u8aac\u660e\n\u4e0b\u8a18\u306f\u5404\u81ea\u306e\u74b0\u5883\u3067\u9069\u5b9c\u5909\u66f4\u3059\u308b\nchef-repo: chef \u306e\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\nguest_os: \u30b2\u30b9\u30c8PC\u540d\nuser_name: github \u306e\u30e6\u30fc\u30b6\u540d+DB\u306e\u30e6\u30fc\u30b6\u540d\n192.168.1.1: \u30eb\u30fc\u30bf\u306eIP\n192.168.1.2: \u30db\u30b9\u30c8OS\u306eIP\n192.168.1.100: \u30b2\u30b9\u30c8OS\u306eIP(\u30db\u30b9\u30c8\u3068\u540c\u3058\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u30bb\u30b0\u30e1\u30f3\u30c8)\n\n\u4eee\u60f3\u74b0\u5883\u306e\u69cb\u7bc9\n\n\u4eee\u60f3\u74b0\u5883\u521d\u671f\u5316\n# box \u540d\u3092 centos-5.10 \u3068\u3059\u308b\nvagrant box add --name centos-5.10 http://opscode-vm-bento.s3.amazonaws.com/vagrant/virtualbox/opscode_centos-5.10_chef-provisionerless.box\n\n# CentOS6.5\u306e\u5834\u5408\nvagrant box add --name opscode_centos-6.5 http://opscode-vm-bento.s3.amazonaws.com/vagrant/virtualbox/opscode_centos-6.5_chef-provisionerless.box\n\n# CentOS7.0\u306e\u5834\u5408\nvagrant box add --name opscode_centos-7.0 http://opscode-vm-bento.s3.amazonaws.com/vagrant/virtualbox/opscode_centos-7.0_chef-provisionerless.box\n\nmkdir -p vagrant/guest_os\ncd vagrant/guest_os\nvagrant init\n\nVagrantfile \u3092\u4e0b\u8a18\u306e\u8a72\u5f53\u90e8\u5206\u3092\u9069\u5b9c\u7de8\u96c6\u3059\u308b\n  # \u5148\u306b\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3057\u305f box \u540d\u3092\u6307\u5b9a\u3059\u308b\n  config.vm.box = \"centos-5.10\"\n  # bridge \u63a5\u7d9a\u3067\u3001\u30db\u30b9\u30c8OS\u5916\u304b\u3089\u30a2\u30af\u30bb\u30b9\u3067\u304d\u308b\u3088\u3046\u306b\u3059\u308b\n  config.vm.network :public_network, ip: \"192.168.1.100\"\n\n  # \u8907\u6570\u306e\u30b2\u30b9\u30c8\u3092\u540c\u6642\u306b\u7acb\u3061\u4e0a\u3052\u308b\u6642\u306b port \u3092\u4efb\u610f\u3067\u5909\u3048\u308b(\u8a2d\u5b9a\u3057\u306a\u304f\u3066\u3082\u53ef)\n  config.vm.network \"forwarded_port\", id: \"ssh\", guest: 22, host: 10100\n\n  # CPU/\u30e1\u30e2\u30ea\u3092\u5897\u91cf\u3059\u308b\n  config.vm.provider \"virtualbox\" do |vb|\n    vb.name = \"guest_os\"\n    vb.cpus = 2\n    vb.memory = \"4096\"\n  end  \n\n\n\u4eee\u60f3\u74b0\u5883\u306e\u8d77\u52d5\u3068\u505c\u6b62\nvagrant up\nvagrant halt\nvagrant reload\n\n\nvagrant \u30d7\u30e9\u30b0\u30a4\u30f3\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\u3088\u304f\u4f7f\u7528\u3059\u308b vagrant \u306e\u30d7\u30e9\u30b0\u30a4\u30f3\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\nvagrant plugin install sahara\nvagrant plugin install vagrant-omnibus\nvagrant plugin install vagrant-cachier\nvagrant plugin install vagrant-vbguest\n\n\nsahara\n\u30b2\u30b9\u30c8OS\u3067\u306e\u5909\u66f4\u3092\u3001SQL\u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3\u306e\u69d8\u306b\u3001\u3059\u3079\u3066\u5143\u306b\u623b\u3057\u305f\u308a(rollback)\u3001\u5909\u66f4\u3092\u78ba\u5b9a(commit)\u3059\u308b\u4e8b\u304c\u3067\u304d\u308b\u3002\nsandbox \u74b0\u5883\u3092 on \u306b\u3059\u308b\u3068\u3001\u30ed\u30fc\u30eb\u30d0\u30c3\u30af\u3067\u304d\u308b\u72b6\u614b\u306b\u306a\u308b\nvagrant sandbox on\nvagrant sandbox rollback\n# \u5909\u66f4\u3092\u78ba\u5b9a\u3059\u308b\u5834\u5408\u306f\u3001commit\nvagrant sandbox commit\n\n\nvagrant-vbguest\nvagrant up \u6642\u306b VirtualBox Guest Additions\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u304c\u53e4\u3044\u30a8\u30e9\u30fc\u304c\u51fa\u308b\u5834\u5408\u3001vagrant-vbguest \u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u3066 vagrant reload \u3059\u308b\n\nAn error occurred during installation of VirtualBox Guest Additions 4.3.30. Some functionality may not work as intended.\nIn most cases it is OK that the \"Window System drivers\" installation failed.\n\n\nvagrant-cachier\n  config.vm.box = \"centos-5.10\"\n  # \u3053\u306e\u8fba\u308a\u306b\u8ffd\u8a18\u3059\u308b\n  if Vagrant.has_plugin?(\"vagrant-cachier\")\n    config.cache.scope = :box\n  end\n\n\n\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306e\u8a2d\u5b9a\nvagrant ssh\nvagrant ssh-config --host guest_os >> ~/.ssh/config\nssh guest_os\n\n\nmac\u30a2\u30c9\u30ec\u30b9\u306e\u885d\u7a81\u3092\u89e3\u6c7a\nvagrant up \u6642\u306b\u4e0b\u8a18\u306e\u3088\u3046\u306a\u30a8\u30e9\u30fc\u304c\u3067\u308b\u5834\u5408\u306f\u3001\n\u30b2\u30b9\u30c8OS\u5074\u3067 70-persistent-net.rules \u3092\u524a\u9664\u3059\u308b\nThe following SSH command responded with a non-zero exit status.\nVagrant assumes that this means the command failed!\n\nARPCHECK=no /sbin/ifup eth1 2> /dev/null\n\nStdout from the command:\n\n\nDetermining IP information for eth1... failed.\n\n\nStderr from the command:\n\nsudo ln -s -f /dev/null /etc/udev/rules.d/70-persistent-net.rules\nvagrant reload\n\nselinix \u306e\u7121\u52b9\u5316\n\u4e0b\u8a18\u3092\u4fee\u6b63\u3057\u3066OS\u3092\u518d\u8d77\u52d5\u3059\u308b\nSELINUX=disabled\n\n\nipv6 \u306e\u7121\u52b9\u5316\nipv6 \u3092\u7121\u52b9\u5316\u3057\u306a\u3044\u3068 knife solo \u6642\u306b\u4e0b\u8a18\u30a8\u30e9\u30fc\u304c\u3067\u308b \ncurl: (6) Couldn't resolve host 'www.opscode.com'\n\n\nCentOS5 \u306e\u5834\u5408\n\u4ee5\u4e0b\u306f\u30b2\u30b9\u30c8OS\u5074\u3067\u306e\u64cd\u4f5c\n\u53c2\u8003\necho \"install ipv6 /bin/true\" > /etc/modprobe.d/disable-ipv6.conf\n\nNETWORKING=yes\nNETWORKING_IPV6=no\nHOSTNAME=vagrant-c5-x86_64\n\necho \"net.ipv6.conf.all.disable_ipv6 = 1\" >> /etc/sysctl.conf\nreboot\n\n\nCentOS6 \u306e\u5834\u5408\n\u4ee5\u4e0b\u306f\u30b2\u30b9\u30c8OS\u5074\u3067\u306e\u64cd\u4f5c\n\u53c2\u8003\n\n/etc/sysctl.conf\n# ipv6 disable\nnet.ipv6.conf.all.disable_ipv6 = 1\nnet.ipv6.conf.default.disable_ipv6 = 1\n\n\nsudo /sbin/sysctl -p\n\n\n\u30db\u30b9\u30c8\u5074\u306b chef \u95a2\u4fc2\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\nchef-repo \u3092\u30db\u30b9\u30c8OS\u306b\u5165\u308c\u308b\ngit clone https://github.com/user_name/chef-repo.git\ncd chef-repo\nbundle install --path vendor/bundle\n#bundle exec berks install --path cookbooks\n# berks 0.5 \u4ee5\u4e0a\nbundle exec berks vendor cookbooks\n\n\nknife solo \u3067\u30b5\u30fc\u30d0\u74b0\u5883\u69cb\u7bc9\nbundle exec knife configure\nbundle exec knife solo prepare guest_os nodes/guest_os.idcf.json\nbundle exec knife solo cook guest_os nodes/guest_os.idcf.json\n\n\n## \u5fc5\u9808\u30c4\u30fc\u30eb\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\nVirtualBox 5.0.10\nvagrant 1.7.4\nrbenv 0.4.0-148-g5b9e4f0\nruby 2.1.5\ngem install bundler\n\n## \u5404\u81ea\u306e\u74b0\u5883\u3067\u7570\u306a\u308b\u5024\u306e\u8aac\u660e\n\n\u4e0b\u8a18\u306f\u5404\u81ea\u306e\u74b0\u5883\u3067\u9069\u5b9c\u5909\u66f4\u3059\u308b\n\nchef-repo: chef \u306e\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\nguest_os: \u30b2\u30b9\u30c8PC\u540d\nuser_name: github \u306e\u30e6\u30fc\u30b6\u540d+DB\u306e\u30e6\u30fc\u30b6\u540d\n192.168.1.1: \u30eb\u30fc\u30bf\u306eIP\n192.168.1.2: \u30db\u30b9\u30c8OS\u306eIP\n192.168.1.100: \u30b2\u30b9\u30c8OS\u306eIP(\u30db\u30b9\u30c8\u3068\u540c\u3058\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u30bb\u30b0\u30e1\u30f3\u30c8)\n\n## \u4eee\u60f3\u74b0\u5883\u306e\u69cb\u7bc9\n\n### \u4eee\u60f3\u74b0\u5883\u521d\u671f\u5316\n\n```\n# box \u540d\u3092 centos-5.10 \u3068\u3059\u308b\nvagrant box add --name centos-5.10 http://opscode-vm-bento.s3.amazonaws.com/vagrant/virtualbox/opscode_centos-5.10_chef-provisionerless.box\n\n# CentOS6.5\u306e\u5834\u5408\nvagrant box add --name opscode_centos-6.5 http://opscode-vm-bento.s3.amazonaws.com/vagrant/virtualbox/opscode_centos-6.5_chef-provisionerless.box\n\n# CentOS7.0\u306e\u5834\u5408\nvagrant box add --name opscode_centos-7.0 http://opscode-vm-bento.s3.amazonaws.com/vagrant/virtualbox/opscode_centos-7.0_chef-provisionerless.box\n\nmkdir -p vagrant/guest_os\ncd vagrant/guest_os\nvagrant init\n```\n\nVagrantfile \u3092\u4e0b\u8a18\u306e\u8a72\u5f53\u90e8\u5206\u3092\u9069\u5b9c\u7de8\u96c6\u3059\u308b\n\n~~~vagrant/guest_os/Vagrantfile\n  # \u5148\u306b\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3057\u305f box \u540d\u3092\u6307\u5b9a\u3059\u308b\n  config.vm.box = \"centos-5.10\"\n  # bridge \u63a5\u7d9a\u3067\u3001\u30db\u30b9\u30c8OS\u5916\u304b\u3089\u30a2\u30af\u30bb\u30b9\u3067\u304d\u308b\u3088\u3046\u306b\u3059\u308b\n  config.vm.network :public_network, ip: \"192.168.1.100\"\n  \n  # \u8907\u6570\u306e\u30b2\u30b9\u30c8\u3092\u540c\u6642\u306b\u7acb\u3061\u4e0a\u3052\u308b\u6642\u306b port \u3092\u4efb\u610f\u3067\u5909\u3048\u308b(\u8a2d\u5b9a\u3057\u306a\u304f\u3066\u3082\u53ef)\n  config.vm.network \"forwarded_port\", id: \"ssh\", guest: 22, host: 10100\n  \n  # CPU/\u30e1\u30e2\u30ea\u3092\u5897\u91cf\u3059\u308b\n  config.vm.provider \"virtualbox\" do |vb|\n    vb.name = \"guest_os\"\n    vb.cpus = 2\n    vb.memory = \"4096\"\n  end  \n~~~\n\n### \u4eee\u60f3\u74b0\u5883\u306e\u8d77\u52d5\u3068\u505c\u6b62\n\n```\nvagrant up\nvagrant halt\nvagrant reload\n```\n\n### vagrant \u30d7\u30e9\u30b0\u30a4\u30f3\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n\u3088\u304f\u4f7f\u7528\u3059\u308b vagrant \u306e\u30d7\u30e9\u30b0\u30a4\u30f3\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\n\n```\nvagrant plugin install sahara\nvagrant plugin install vagrant-omnibus\nvagrant plugin install vagrant-cachier\nvagrant plugin install vagrant-vbguest\n```\n\n#### sahara\n\n\u30b2\u30b9\u30c8OS\u3067\u306e\u5909\u66f4\u3092\u3001SQL\u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3\u306e\u69d8\u306b\u3001\u3059\u3079\u3066\u5143\u306b\u623b\u3057\u305f\u308a(rollback)\u3001\u5909\u66f4\u3092\u78ba\u5b9a(commit)\u3059\u308b\u4e8b\u304c\u3067\u304d\u308b\u3002\nsandbox \u74b0\u5883\u3092 on \u306b\u3059\u308b\u3068\u3001\u30ed\u30fc\u30eb\u30d0\u30c3\u30af\u3067\u304d\u308b\u72b6\u614b\u306b\u306a\u308b\n\n```\nvagrant sandbox on\nvagrant sandbox rollback\n# \u5909\u66f4\u3092\u78ba\u5b9a\u3059\u308b\u5834\u5408\u306f\u3001commit\nvagrant sandbox commit\n```\n\n#### vagrant-vbguest\n\nvagrant up \u6642\u306b VirtualBox Guest Additions\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u304c\u53e4\u3044\u30a8\u30e9\u30fc\u304c\u51fa\u308b\u5834\u5408\u3001vagrant-vbguest \u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u3066 `vagrant reload` \u3059\u308b\n```\nAn error occurred during installation of VirtualBox Guest Additions 4.3.30. Some functionality may not work as intended.\nIn most cases it is OK that the \"Window System drivers\" installation failed.\n```\n\n#### vagrant-cachier\n\n~~~Vagrantfile\n  config.vm.box = \"centos-5.10\"\n  # \u3053\u306e\u8fba\u308a\u306b\u8ffd\u8a18\u3059\u308b\n  if Vagrant.has_plugin?(\"vagrant-cachier\")\n    config.cache.scope = :box\n  end\n~~~\n\n### \u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306e\u8a2d\u5b9a\n\n```\nvagrant ssh\nvagrant ssh-config --host guest_os >> ~/.ssh/config\nssh guest_os\n```\n\n#### mac\u30a2\u30c9\u30ec\u30b9\u306e\u885d\u7a81\u3092\u89e3\u6c7a\n\nvagrant up \u6642\u306b\u4e0b\u8a18\u306e\u3088\u3046\u306a\u30a8\u30e9\u30fc\u304c\u3067\u308b\u5834\u5408\u306f\u3001\n\u30b2\u30b9\u30c8OS\u5074\u3067 70-persistent-net.rules \u3092\u524a\u9664\u3059\u308b\n\n```\nThe following SSH command responded with a non-zero exit status.\nVagrant assumes that this means the command failed!\n\nARPCHECK=no /sbin/ifup eth1 2> /dev/null\n\nStdout from the command:\n\n\nDetermining IP information for eth1... failed.\n\n\nStderr from the command:\n```\n\n`sudo ln -s -f /dev/null /etc/udev/rules.d/70-persistent-net.rules`\n\n`vagrant reload`\n\n#### selinix \u306e\u7121\u52b9\u5316\n\n\u4e0b\u8a18\u3092\u4fee\u6b63\u3057\u3066OS\u3092\u518d\u8d77\u52d5\u3059\u308b\n\n```/etc/selinux/config\nSELINUX=disabled\n```\n\n#### ipv6 \u306e\u7121\u52b9\u5316\n\nipv6 \u3092\u7121\u52b9\u5316\u3057\u306a\u3044\u3068 knife solo \u6642\u306b\u4e0b\u8a18\u30a8\u30e9\u30fc\u304c\u3067\u308b \n\n```\ncurl: (6) Couldn't resolve host 'www.opscode.com'\n```\n\n##### CentOS5 \u306e\u5834\u5408\n\n\u4ee5\u4e0b\u306f\u30b2\u30b9\u30c8OS\u5074\u3067\u306e\u64cd\u4f5c\n[\u53c2\u8003](http://www.ehowstuff.com/how-to-disable-the-ipv6-on-centos-5-8/)\n\n```\necho \"install ipv6 /bin/true\" > /etc/modprobe.d/disable-ipv6.conf\n```\n\n```/etc/sysconfig/network\nNETWORKING=yes\nNETWORKING_IPV6=no\nHOSTNAME=vagrant-c5-x86_64\n```\n\n```\necho \"net.ipv6.conf.all.disable_ipv6 = 1\" >> /etc/sysctl.conf\nreboot\n```\n\n##### CentOS6 \u306e\u5834\u5408\n\n\u4ee5\u4e0b\u306f\u30b2\u30b9\u30c8OS\u5074\u3067\u306e\u64cd\u4f5c\n[\u53c2\u8003](http://www.1x1.jp/blog/2013/03/disable_ipv6_on_centos6.html)\n\n```/etc/sysctl.conf\n# ipv6 disable\nnet.ipv6.conf.all.disable_ipv6 = 1\nnet.ipv6.conf.default.disable_ipv6 = 1\n```\n\n```\nsudo /sbin/sysctl -p\n```\n\n## \u30db\u30b9\u30c8\u5074\u306b chef \u95a2\u4fc2\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\nchef-repo \u3092\u30db\u30b9\u30c8OS\u306b\u5165\u308c\u308b\n\n```\ngit clone https://github.com/user_name/chef-repo.git\ncd chef-repo\nbundle install --path vendor/bundle\n#bundle exec berks install --path cookbooks\n# berks 0.5 \u4ee5\u4e0a\nbundle exec berks vendor cookbooks\n```\n\n## knife solo \u3067\u30b5\u30fc\u30d0\u74b0\u5883\u69cb\u7bc9\n\n```\nbundle exec knife configure\nbundle exec knife solo prepare guest_os nodes/guest_os.idcf.json\nbundle exec knife solo cook guest_os nodes/guest_os.idcf.json\n```\n", "tags": ["knife", "chef", "VirtualBox", "vagrant"]}