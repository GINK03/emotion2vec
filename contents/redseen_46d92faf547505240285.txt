{"context": " More than 1 year has passed since last update.\u6539\u8a02\u7248\u66f8\u304d\u307e\u3057\u305f\u3002\n[\u6539\u8a02\u7248]\u7d99\u627f\u53ef\u80fd\u306aSingleton\u57fa\u5e95\u30af\u30e9\u30b9\uff08VB.Net\uff09\n\nSingleton\u306a\u30af\u30e9\u30b9\u3092\u3042\u308b\u7a0b\u5ea6\u306e\u500b\u6570\u4f5c\u3089\u306a\u3051\u308c\u3070\u3044\u3051\u306a\u304f\u306a\u308a\u3001\u30b9\u30cb\u30da\u30c3\u30c8\u306f\u3042\u308b\u3082\u306e\u306e\u306a\u3093\u3068\u304b\u7d99\u627f\u3092\u4f7f\u7528\u3057\u3066\u89e3\u6c7a\u3067\u304d\u306a\u3044\u304b\u8abf\u67fb\u3057\u305f\u3002\n\n\u53c2\u8003\u306b\u3057\u305f\u30b5\u30a4\u30c8\nSingleton\u306e\u30b5\u30d6\u30af\u30e9\u30b9\u5316\n\u30c7\u30b6\u30a4\u30f3\u30d1\u30bf\u30fc\u30f3\u7b2c\uff11\uff14\u56de\u300cSingleton\u30d1\u30bf\u30fc\u30f3\u300d\u305d\u306e\uff12\n\n\u57fa\u5e95\u30af\u30e9\u30b9\n\nAbstractSingletonClass.vb\n''' <summary>\n''' \u30b7\u30f3\u30b0\u30eb\u30c8\u30f3\u57fa\u5e95\u30af\u30e9\u30b9\n''' </summary>\n''' <remarks></remarks>\nPublic MustInherit Class AbstractSingletonClass\n\n    ''' <summary>\n    ''' \u30b7\u30f3\u30b0\u30eb\u30c8\u30f3\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u30ea\u30b9\u30c8\n    ''' </summary>\n    ''' <remarks></remarks>\n    Private Shared _SingletonInstanceDictionary As New Dictionary(Of Type, AbstractSingletonClass)\n\n    ''' <summary>\n    ''' \u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u751f\u6210\u6392\u4ed6\u30ed\u30c3\u30af\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\n    ''' </summary>\n    ''' <remarks></remarks>\n    Private Shared ReadOnly _SyncLockCreateInstance As New Object\n\n    ''' <summary>\n    ''' \u30b3\u30f3\u30b9\u30c8\u30e9\u30af\u30bf\uff08Protected\uff09\n    ''' </summary>\n    ''' <remarks></remarks>\n    Protected Sub New()\n\n        '\u552f\u4e00\u306e\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u3092\u4fdd\u8a3c\u3059\u308b\n        If _SingletonInstanceDictionary.ContainsKey(Me.GetType()) Then\n            Throw New InvalidOperationException(\"\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306f\u65e2\u306b\u751f\u6210\u3055\u308c\u3066\u3044\u307e\u3059\u3002\")\n        End If\n\n        '\u8ffd\u52a0\u3059\u308b\n        _SingletonInstanceDictionary.Add(Me.GetType(), Me)\n\n    End Sub\n\n    ''' <summary>\n    ''' \u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u53d6\u5f97\n    ''' </summary>\n    ''' <typeparam name=\"T\"></typeparam>\n    ''' <returns></returns>\n    ''' <remarks></remarks>\n    Public Shared Function GetInstance(Of T As AbstractSingletonClass)() As T\n\n        SyncLock _SyncLockCreateInstance\n\n            '\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u751f\u6210\u6e08\u307f\u304b\u30c1\u30a7\u30c3\u30af\u3059\u308b\n            If _SingletonInstanceDictionary.ContainsKey(GetType(T)) = False Then\n                '\u7121\u3051\u308c\u3070\u751f\u6210\u3059\u308b\n                _SingletonInstanceDictionary(GetType(T)) = CType(System.Activator.CreateInstance(GetType(T), True), T)\n            End If\n\n            '\u8fd4\u3059\n            Return CType(_SingletonInstanceDictionary(GetType(T)), T)\n\n        End SyncLock\n\n    End Function\n\nEnd Class\n\n\n\n\u6d3e\u751f\u30af\u30e9\u30b9\n\nSingletonA.vb\n''' <summary>\n''' \u6d3e\u751f\u30af\u30e9\u30b9A\n''' </summary>\n''' <remarks></remarks>\nPublic Class SingletonA\n    Inherits AbstractSingletonClass\n\n    ''' <summary>\n    ''' \u30b3\u30f3\u30b9\u30c8\u30e9\u30af\u30bf\uff08Protected\uff09\n    ''' </summary>\n    ''' <remarks></remarks>\n    Protected Sub New()\n\n    End Sub\n\nEnd Class\n\n\n\n\u4f7f\u3044\u65b9\nDim S = SingletonA.GetInstance(of SingletonA)()\n\n\n\u4eca\u56de\u52c9\u5f37\u306b\u306a\u3063\u305f\u30dd\u30a4\u30f3\u30c8\n1.\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u3092\u751f\u6210\u3059\u308bActivator.CreateInstance\u30e1\u30bd\u30c3\u30c9\u306f\u3001Public\u306a\u30b3\u30f3\u30b9\u30c8\u30e9\u30af\u30bf\u306e\u307f\u3092\u5b9f\u884c\u3059\u308b\u3082\u306e\u3060\u3068\u601d\u3063\u3066\u3044\u305f\u304c\u3001\u7b2c2\u5f15\u6570\u6b21\u7b2c\u3067Protected\u3001Private\u3067\u3082\u751f\u6210\u3057\u3066\u304f\u308c\u308b\u3053\u3068\u3092\u77e5\u3063\u305f\u3002\n2.Shared\u306a\u30e1\u30f3\u30d0\u306f\u300c\u57fa\u5e95\u30af\u30e9\u30b9.Shared\u30e1\u30f3\u30d0\u300d\u3068\u30a2\u30af\u30bb\u30b9\u3057\u306a\u3051\u308c\u3070\u3044\u3051\u306a\u3044\u3068\u601d\u3044\u8fbc\u3093\u3067\u3044\u305f\u305f\u3081\u3001\u6d3e\u751f\u30af\u30e9\u30b9\u5185\u306b\u57fa\u5e95\u30af\u30e9\u30b9\u540d\u304c\u51fa\u73fe\u3059\u308b\u304c\u5acc\u3067\u656c\u9060\u3057\u3066\u3044\u305f\u3002\u3060\u304c\u300c\u6d3e\u751f\u30af\u30e9\u30b9.Shared\u30e1\u30f3\u30d0\u300d\u3067\u3082OK\u306a\u3053\u3068\u3092\u77e5\u3063\u305f\u3002\n\n\u6b8b\u308b\u554f\u984c\n\u3053\u3093\u306a\u611f\u3058\u3067\u4f7f\u3046\u6642\u306b\u578b\u63a8\u8ad6\u304c\u52b9\u3051\u3070\u6700\u9ad8\u3002\nDim S = SingletonA.GetInstance()\n\n\u89e3\u6c7a\u65b9\u6cd5\u3092\u3054\u5b58\u77e5\u306e\u65b9\u3001\u30b3\u30e1\u30f3\u30c8\u304f\u3060\u3055\u3044\u3002\n**\u6539\u8a02\u7248\u66f8\u304d\u307e\u3057\u305f\u3002**\n[[\u6539\u8a02\u7248]\u7d99\u627f\u53ef\u80fd\u306aSingleton\u57fa\u5e95\u30af\u30e9\u30b9\uff08VB.Net\uff09](http://qiita.com/redseen/items/34d92016a09432cab4e7)\n***\nSingleton\u306a\u30af\u30e9\u30b9\u3092\u3042\u308b\u7a0b\u5ea6\u306e\u500b\u6570\u4f5c\u3089\u306a\u3051\u308c\u3070\u3044\u3051\u306a\u304f\u306a\u308a\u3001\u30b9\u30cb\u30da\u30c3\u30c8\u306f\u3042\u308b\u3082\u306e\u306e\u306a\u3093\u3068\u304b\u7d99\u627f\u3092\u4f7f\u7528\u3057\u3066\u89e3\u6c7a\u3067\u304d\u306a\u3044\u304b\u8abf\u67fb\u3057\u305f\u3002\n\n#\u53c2\u8003\u306b\u3057\u305f\u30b5\u30a4\u30c8\n[Singleton\u306e\u30b5\u30d6\u30af\u30e9\u30b9\u5316](http://www.hyuki.com/techinfo/singleton.html)\n[\u30c7\u30b6\u30a4\u30f3\u30d1\u30bf\u30fc\u30f3\u7b2c\uff11\uff14\u56de\u300cSingleton\u30d1\u30bf\u30fc\u30f3\u300d\u305d\u306e\uff12](http://zecl.hatenablog.com/entry/20080229/p2)\n\n#\u57fa\u5e95\u30af\u30e9\u30b9\n```vbnet:AbstractSingletonClass.vb\n''' <summary>\n''' \u30b7\u30f3\u30b0\u30eb\u30c8\u30f3\u57fa\u5e95\u30af\u30e9\u30b9\n''' </summary>\n''' <remarks></remarks>\nPublic MustInherit Class AbstractSingletonClass\n\n    ''' <summary>\n    ''' \u30b7\u30f3\u30b0\u30eb\u30c8\u30f3\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u30ea\u30b9\u30c8\n    ''' </summary>\n    ''' <remarks></remarks>\n    Private Shared _SingletonInstanceDictionary As New Dictionary(Of Type, AbstractSingletonClass)\n\n    ''' <summary>\n    ''' \u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u751f\u6210\u6392\u4ed6\u30ed\u30c3\u30af\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\n    ''' </summary>\n    ''' <remarks></remarks>\n    Private Shared ReadOnly _SyncLockCreateInstance As New Object\n\n    ''' <summary>\n    ''' \u30b3\u30f3\u30b9\u30c8\u30e9\u30af\u30bf\uff08Protected\uff09\n    ''' </summary>\n    ''' <remarks></remarks>\n    Protected Sub New()\n\n        '\u552f\u4e00\u306e\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u3092\u4fdd\u8a3c\u3059\u308b\n        If _SingletonInstanceDictionary.ContainsKey(Me.GetType()) Then\n            Throw New InvalidOperationException(\"\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306f\u65e2\u306b\u751f\u6210\u3055\u308c\u3066\u3044\u307e\u3059\u3002\")\n        End If\n\n        '\u8ffd\u52a0\u3059\u308b\n        _SingletonInstanceDictionary.Add(Me.GetType(), Me)\n\n    End Sub\n\n    ''' <summary>\n    ''' \u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u53d6\u5f97\n    ''' </summary>\n    ''' <typeparam name=\"T\"></typeparam>\n    ''' <returns></returns>\n    ''' <remarks></remarks>\n    Public Shared Function GetInstance(Of T As AbstractSingletonClass)() As T\n\n        SyncLock _SyncLockCreateInstance\n\n            '\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u751f\u6210\u6e08\u307f\u304b\u30c1\u30a7\u30c3\u30af\u3059\u308b\n            If _SingletonInstanceDictionary.ContainsKey(GetType(T)) = False Then\n                '\u7121\u3051\u308c\u3070\u751f\u6210\u3059\u308b\n                _SingletonInstanceDictionary(GetType(T)) = CType(System.Activator.CreateInstance(GetType(T), True), T)\n            End If\n\n            '\u8fd4\u3059\n            Return CType(_SingletonInstanceDictionary(GetType(T)), T)\n\n        End SyncLock\n\n    End Function\n\nEnd Class\n```\n#\u6d3e\u751f\u30af\u30e9\u30b9\n```vbnet:SingletonA.vb\n''' <summary>\n''' \u6d3e\u751f\u30af\u30e9\u30b9A\n''' </summary>\n''' <remarks></remarks>\nPublic Class SingletonA\n    Inherits AbstractSingletonClass\n\n    ''' <summary>\n    ''' \u30b3\u30f3\u30b9\u30c8\u30e9\u30af\u30bf\uff08Protected\uff09\n    ''' </summary>\n    ''' <remarks></remarks>\n    Protected Sub New()\n\n    End Sub\n\nEnd Class\n```\n#\u4f7f\u3044\u65b9\n```vbnet:\nDim S = SingletonA.GetInstance(of SingletonA)()\n```\n\n#\u4eca\u56de\u52c9\u5f37\u306b\u306a\u3063\u305f\u30dd\u30a4\u30f3\u30c8\n1.\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u3092\u751f\u6210\u3059\u308bActivator.CreateInstance\u30e1\u30bd\u30c3\u30c9\u306f\u3001Public\u306a\u30b3\u30f3\u30b9\u30c8\u30e9\u30af\u30bf\u306e\u307f\u3092\u5b9f\u884c\u3059\u308b\u3082\u306e\u3060\u3068\u601d\u3063\u3066\u3044\u305f\u304c\u3001\u7b2c2\u5f15\u6570\u6b21\u7b2c\u3067Protected\u3001Private\u3067\u3082\u751f\u6210\u3057\u3066\u304f\u308c\u308b\u3053\u3068\u3092\u77e5\u3063\u305f\u3002\n\n2.Shared\u306a\u30e1\u30f3\u30d0\u306f\u300c\u57fa\u5e95\u30af\u30e9\u30b9.Shared\u30e1\u30f3\u30d0\u300d\u3068\u30a2\u30af\u30bb\u30b9\u3057\u306a\u3051\u308c\u3070\u3044\u3051\u306a\u3044\u3068\u601d\u3044\u8fbc\u3093\u3067\u3044\u305f\u305f\u3081\u3001\u6d3e\u751f\u30af\u30e9\u30b9\u5185\u306b\u57fa\u5e95\u30af\u30e9\u30b9\u540d\u304c\u51fa\u73fe\u3059\u308b\u304c\u5acc\u3067\u656c\u9060\u3057\u3066\u3044\u305f\u3002\u3060\u304c\u300c\u6d3e\u751f\u30af\u30e9\u30b9.Shared\u30e1\u30f3\u30d0\u300d\u3067\u3082OK\u306a\u3053\u3068\u3092\u77e5\u3063\u305f\u3002\n\n#\u6b8b\u308b\u554f\u984c\n\n\u3053\u3093\u306a\u611f\u3058\u3067\u4f7f\u3046\u6642\u306b\u578b\u63a8\u8ad6\u304c\u52b9\u3051\u3070\u6700\u9ad8\u3002\n\n```vbnet:\nDim S = SingletonA.GetInstance()\n```\n\u89e3\u6c7a\u65b9\u6cd5\u3092\u3054\u5b58\u77e5\u306e\u65b9\u3001\u30b3\u30e1\u30f3\u30c8\u304f\u3060\u3055\u3044\u3002\n", "tags": ["VB.Net"]}