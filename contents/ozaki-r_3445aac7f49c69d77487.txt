{"tags": ["glibc", "C", "GCC"], "context": " More than 1 year has passed since last update.systemd\u306e\u30b3\u30fc\u30c9\u306b\u306falloc_size\u5c5e\u6027\u3092\u4f7f\u3046_alloc_\u30de\u30af\u30ed\u304c\u3042\u308b\u3002\n\nsrc/shared/macro.h\n#define _alloc_(...) __attribute__ ((alloc_size(__VA_ARGS__)))\n\n\nalloc_size\u5c5e\u6027\u306f\u3001GCC\u306e\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u306b\u3088\u308b\u3068\u3001__builtin_object_size\u306e\u7cbe\u5ea6\u3092\u4e0a\u3052\u308b\u305f\u3081\u3082\u306e\u3068\u3042\u308b\u3002\n__builtin_object_size\u306fObject Size Checking - Using the GNU Compiler Collection (GCC)\u306b\u8a73\u3057\u3044\u8aac\u660e\u304c\u3042\u308b\u3002\u30dd\u30a4\u30f3\u30bf\u304c\u6307\u3059\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306e\u30b5\u30a4\u30ba\u3092\u8fd4\u3059\u30d3\u30eb\u30c9\u30a4\u30f3\u95a2\u6570\u3089\u3057\u3044\u3002\u3053\u306e\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u30b5\u30a4\u30ba\u306e\u60c5\u5831\u306f\u3001memcpy(3)\u306a\u3069\u306e\u6a19\u6e96\u30e9\u30a4\u30d6\u30e9\u30ea\u95a2\u6570\u306e\u7279\u6b8a\u306a\u30d0\u30fc\u30b8\u30e7\u30f3(__builtin___memcpy_chk\u3068\u3044\u3046\u540d\u524d)\u3067\u4f7f\u308f\u308c\u308b\u3002memcpy(3)\u306e\u5834\u5408\u3060\u3068\u3001\u30b3\u30f3\u30d1\u30a4\u30eb\u6642\u306b\u30d0\u30c3\u30d5\u30a1\u30aa\u30fc\u30d0\u30fc\u30d5\u30ed\u30fc\u3092\u691c\u51fa\u3057\u3066\u304f\u308c\u308b\u3089\u3057\u3044\u3002\n\u3053\u306e*_chk\u95a2\u6570\u306f\u69d8\u3005\u306a\u3082\u306e\u304c\u3042\u308b\u3089\u3057\u3044\u304f\u3001\u624b\u5143\u306eFedora 19\u3067\u8abf\u3079\u3066\u307f\u308b\u3068\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u3082\u306e\u304c\u3042\u3063\u305f\u3002\u30d0\u30c3\u30d5\u30a1\u3092\u64cd\u4f5c\u3059\u308b\u95a2\u6570\u304c\u591a\u3044\u304c\u3001longjmp(3)\u3084poll(2)\u5411\u3051\u306e\u3082\u306e\u3082\u3042\u308b\u3002\n$ strings /usr/lib/* |grep _chk |sort -u\n__asprintf_chk\n__chk_fail\n__confstr_chk\n__dprintf_chk\n__fdelt_chk\n__fgets_chk\n__fgets_unlocked_chk\n__fgetws_chk\n__fgetws_unlocked_chk\n__fprintf_chk\n__fread_chk\n__fread_unlocked_chk\n__fwprintf_chk\n__getcwd_chk\n__getdomainname_chk\n__getgroups_chk\n__gethostname_chk\n__getlogin_r_chk\n__gets_chk\n__getwd_chk\n__longjmp_chk\n__mbsnrtowcs_chk\n__mbsrtowcs_chk\n__mbstowcs_chk\n__memcpy_chk\n__memcpy_chk_ia32\n__memcpy_chk_ssse3\n__memcpy_chk_ssse3_rep\n__memmove_chk\n__memmove_chk_ia32\n__memmove_chk_ssse3\n__memmove_chk_ssse3_rep\n__mempcpy_chk\n__mempcpy_chk_ia32\n__mempcpy_chk_ssse3\n__mempcpy_chk_ssse3_rep\n__memset_chk\n__memset_chk_ia32\n__memset_chk_sse2\n__memset_chk_sse2_rep\n__obstack_printf_chk\n__obstack_vprintf_chk\n__poll_chk\n__ppoll_chk\n__pread64_chk\n__pread_chk\n__printf_chk\n__ptsname_r_chk\n__read_chk\n__readlinkat_chk\n__readlink_chk\n__realpath_chk\n__recv_chk\n__recvfrom_chk\n__snprintf_chk\n__sprintf_chk\n__stack_chk_fail\n__stack_chk_fail_local\nstack_chk_fail_local.oS/\n__stpcpy_chk\n__stpncpy_chk\n__strcat_chk\n__strcpy_chk\n__strncat_chk\n__strncpy_chk\n__swprintf_chk\n__syslog_chk\n__ttyname_r_chk\n__vasprintf_chk\n__vdprintf_chk\n__vfprintf_chk\n__vfwprintf_chk\n__vprintf_chk\n__vsnprintf_chk\n__vsprintf_chk\n__vswprintf_chk\n__vsyslog_chk\n__vwprintf_chk\n__wcpcpy_chk\n__wcpncpy_chk\n__wcrtomb_chk\n__wcscat_chk\n__wcscpy_chk\n__wcsncat_chk\n__wcsncpy_chk\n__wcsnrtombs_chk\n__wcsrtombs_chk\n__wcstombs_chk\n__wctomb_chk\n__wmemcpy_chk\n__wmemmove_chk\n__wmempcpy_chk\n__wmemset_chk\n__wprintf_chk\n\nsystemd\u306e\u30b3\u30fc\u30c9\u306b\u306f`alloc_size`\u5c5e\u6027\u3092\u4f7f\u3046`_alloc_`\u30de\u30af\u30ed\u304c\u3042\u308b\u3002\n\n```c:src/shared/macro.h\n#define _alloc_(...) __attribute__ ((alloc_size(__VA_ARGS__)))\n```\n\n`alloc_size`\u5c5e\u6027\u306f\u3001[GCC\u306e\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8](https://gcc.gnu.org/onlinedocs/gcc/Function-Attributes.html)\u306b\u3088\u308b\u3068\u3001`__builtin_object_size`\u306e\u7cbe\u5ea6\u3092\u4e0a\u3052\u308b\u305f\u3081\u3082\u306e\u3068\u3042\u308b\u3002\n\n`__builtin_object_size`\u306f[Object Size Checking - Using the GNU Compiler Collection (GCC)](https://gcc.gnu.org/onlinedocs/gcc/Object-Size-Checking.html)\u306b\u8a73\u3057\u3044\u8aac\u660e\u304c\u3042\u308b\u3002\u30dd\u30a4\u30f3\u30bf\u304c\u6307\u3059\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306e\u30b5\u30a4\u30ba\u3092\u8fd4\u3059\u30d3\u30eb\u30c9\u30a4\u30f3\u95a2\u6570\u3089\u3057\u3044\u3002\u3053\u306e\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u30b5\u30a4\u30ba\u306e\u60c5\u5831\u306f\u3001memcpy(3)\u306a\u3069\u306e\u6a19\u6e96\u30e9\u30a4\u30d6\u30e9\u30ea\u95a2\u6570\u306e\u7279\u6b8a\u306a\u30d0\u30fc\u30b8\u30e7\u30f3(`__builtin___memcpy_chk`\u3068\u3044\u3046\u540d\u524d)\u3067\u4f7f\u308f\u308c\u308b\u3002memcpy(3)\u306e\u5834\u5408\u3060\u3068\u3001\u30b3\u30f3\u30d1\u30a4\u30eb\u6642\u306b\u30d0\u30c3\u30d5\u30a1\u30aa\u30fc\u30d0\u30fc\u30d5\u30ed\u30fc\u3092\u691c\u51fa\u3057\u3066\u304f\u308c\u308b\u3089\u3057\u3044\u3002\n\n\u3053\u306e*_chk\u95a2\u6570\u306f\u69d8\u3005\u306a\u3082\u306e\u304c\u3042\u308b\u3089\u3057\u3044\u304f\u3001\u624b\u5143\u306eFedora 19\u3067\u8abf\u3079\u3066\u307f\u308b\u3068\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u3082\u306e\u304c\u3042\u3063\u305f\u3002\u30d0\u30c3\u30d5\u30a1\u3092\u64cd\u4f5c\u3059\u308b\u95a2\u6570\u304c\u591a\u3044\u304c\u3001longjmp(3)\u3084poll(2)\u5411\u3051\u306e\u3082\u306e\u3082\u3042\u308b\u3002\n\n```\n$ strings /usr/lib/* |grep _chk |sort -u\n__asprintf_chk\n__chk_fail\n__confstr_chk\n__dprintf_chk\n__fdelt_chk\n__fgets_chk\n__fgets_unlocked_chk\n__fgetws_chk\n__fgetws_unlocked_chk\n__fprintf_chk\n__fread_chk\n__fread_unlocked_chk\n__fwprintf_chk\n__getcwd_chk\n__getdomainname_chk\n__getgroups_chk\n__gethostname_chk\n__getlogin_r_chk\n__gets_chk\n__getwd_chk\n__longjmp_chk\n__mbsnrtowcs_chk\n__mbsrtowcs_chk\n__mbstowcs_chk\n__memcpy_chk\n__memcpy_chk_ia32\n__memcpy_chk_ssse3\n__memcpy_chk_ssse3_rep\n__memmove_chk\n__memmove_chk_ia32\n__memmove_chk_ssse3\n__memmove_chk_ssse3_rep\n__mempcpy_chk\n__mempcpy_chk_ia32\n__mempcpy_chk_ssse3\n__mempcpy_chk_ssse3_rep\n__memset_chk\n__memset_chk_ia32\n__memset_chk_sse2\n__memset_chk_sse2_rep\n__obstack_printf_chk\n__obstack_vprintf_chk\n__poll_chk\n__ppoll_chk\n__pread64_chk\n__pread_chk\n__printf_chk\n__ptsname_r_chk\n__read_chk\n__readlinkat_chk\n__readlink_chk\n__realpath_chk\n__recv_chk\n__recvfrom_chk\n__snprintf_chk\n__sprintf_chk\n__stack_chk_fail\n__stack_chk_fail_local\nstack_chk_fail_local.oS/\n__stpcpy_chk\n__stpncpy_chk\n__strcat_chk\n__strcpy_chk\n__strncat_chk\n__strncpy_chk\n__swprintf_chk\n__syslog_chk\n__ttyname_r_chk\n__vasprintf_chk\n__vdprintf_chk\n__vfprintf_chk\n__vfwprintf_chk\n__vprintf_chk\n__vsnprintf_chk\n__vsprintf_chk\n__vswprintf_chk\n__vsyslog_chk\n__vwprintf_chk\n__wcpcpy_chk\n__wcpncpy_chk\n__wcrtomb_chk\n__wcscat_chk\n__wcscpy_chk\n__wcsncat_chk\n__wcsncpy_chk\n__wcsnrtombs_chk\n__wcsrtombs_chk\n__wcstombs_chk\n__wctomb_chk\n__wmemcpy_chk\n__wmemmove_chk\n__wmempcpy_chk\n__wmemset_chk\n__wprintf_chk\n```\n"}