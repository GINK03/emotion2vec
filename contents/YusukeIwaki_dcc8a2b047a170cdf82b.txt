{"context": " More than 1 year has passed since last update.\u5148\u65e5\u3001\u7121\u4e8b\u306b(?)Rocket.Chat.Android\u306e\u30b3\u30df\u30c3\u30bf\u306b\u306a\u308a\u307e\u3057\u305f\u3002\uff08\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u540d\u306fLily\uff09\n\u3068\u3044\u3046\u3053\u3068\u3067\u3001\u300c\u81ea\u5206\u306e\u74b0\u5883\u3060\u3051\u3067\u30d3\u30eb\u30c9\u304c\u3067\u304d\u308c\u3070\u3044\u3044\u3084\u300d\u307f\u305f\u3044\u306a\u8003\u3048\u306f\u6368\u3066\u3001CircleCI\u3067\u30d3\u30eb\u30c9\u3067\u304d\u308b\u3088\u3046\u306b\u3057\u307e\u3057\u305f\u3002\nRocket.Chat\u30c1\u30fc\u30e0\u304b\u3089\u8981\u671b\u304c\u3042\u3063\u305f\u306e\u3067Fabric beta\u3067\u306e\u30a2\u30d7\u30ea\u914d\u5e03\u3082\u3075\u304f\u3081\u3066\u5bfe\u5fdc\u3092\u3057\u305f\u306e\u3067\u3059\u304c\u3001\u6848\u5916\u30cf\u30de\u30ea\u30dd\u30a4\u30f3\u30c8\u304c\u591a\u304b\u3063\u305f\u306e\u3067\u3001\u5171\u6709\u306e\u305f\u3081\u8a18\u4e8b\u3092\u6b8b\u3057\u3066\u304a\u304d\u305f\u3044\u3068\u601d\u3044\u307e\u3059\u3002\n\n\u65b9\u91dd\n\ncircle.yml \u3092\u4f5c\u3089\u306a\u3044\u3001\u306a\u308b\u3079\u304fCircleCI\u306eProject Settings\u3067\u9811\u5f35\u308b\nAndroid Studio\u3067\u3082CI\u3067\u3082\u4f7f\u3048\u308b\u3088\u3046\u306b\u3001\u74b0\u5883\u5909\u6570\u306e\u4f9d\u5b58\u6027\u306f\u5c11\u306a\u304f\nFabric\u30d7\u30e9\u30b0\u30a4\u30f3\u306f\u90aa\u9b54\u304f\u3055\u3044\u306e\u3067\u4f7f\u308f\u306a\u3044\n\n\nCI\u3067\u30d3\u30eb\u30c9\u3092\u901a\u3059\u305f\u3081\u306b\u2026\n\nJAVA_HOME\u306e\u8a2d\u5b9a\nRocket.Chat.Android.Lily\u3067\u306f\u3001retrolambda\u3092\u3064\u304b\u3063\u3066\u3044\u308b\u305f\u3081\u304b\u3001Java 8\u3058\u3083\u306a\u3044\u3068\u30d3\u30eb\u30c9\u304c\u901a\u308a\u307e\u305b\u3093\u3002\nCircle CI\u306e\u74b0\u5883\u306f\u30c7\u30d5\u30a9\u30eb\u30c8\u3060\u3068Java7\u304c\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u306e\u3067\u3001\u30d3\u30eb\u30c9\u306b\u30b3\u30b1\u307e\u3059\u3002\n\u74b0\u5883\u5909\u6570\u306e\u3068\u3053\u308d\u3067\n\n\n\nNAME\nVALUE\n\n\n\n\nJAVA_HOME\n/usr/lib/jvm/jdk1.8.0\n\n\n\n\u3068\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n\nANDROID_HOME\u306e\u8a2d\u5b9a\u30fb\u30fb\u30fb\u306f\u4e0d\u8981\uff01\nCI\u304c\u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u5165\u308c\u3066\u304f\u308c\u308b\u3089\u3057\u3044\u3002\n\ngit submodule \u306e\u8a2d\u5b9a\u3001local.properties\u306e\u30bb\u30c3\u30c8\nTravis CI\u3060\u3063\u305f\u3089\u52dd\u624b\u306b git submodule init && git submodule update \u3063\u3066\u3084\u3063\u3066\u304f\u308c\u308b\u3093\u3067\u3059\u304c\u3001CircleCI\u3067\u306f\u3084\u3063\u3066\u304f\u308c\u307e\u305b\u3093\u3002\n\u3042\u3068\u3001local.properties\u306bsdk.dir\u3063\u3066\u306e\u3092\u5b9a\u7fa9\u3057\u3066\u306a\u3044\u3068\u30d3\u30eb\u30c9\u304c\u901a\u308a\u307e\u305b\u3093\u3002\nPre-dependency commands\u306e\u3068\u3053\u308d\u306b\ngit submodule init && git submodule update\necho \"sdk.dir=\"$ANDROID_HOME > local.properties \n\n\u3068\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n\n\u30d3\u30eb\u30c9\u30b3\u30de\u30f3\u30c9\u306b\u6ce8\u610f\nCircle CI\u306f\u3001\u30e1\u30e2\u30ea\u4f7f\u7528\u304c4GB\u3053\u3048\u308b\u3068\u30d7\u30ed\u30bb\u30b9\u5f37\u5236\u7d42\u4e86\u3055\u308c\u308b\u3001\u3068\u3044\u3046\u52d5\u4f5c\u4ed5\u69d8\u304c\u3042\u308a\u3001\n./gradlew assembleDebug \u3060\u3068\u3001\n> Building 93% > :app:preDexDebug\n\n> Building 93% > :app:preDexDebug./gradlew assembleDebug --info --stacktrace died unexpectedly\n\n\u307f\u305f\u3044\u306a\u304b\u3093\u3058\u3067\u7a81\u7136\u6b7b\u3092\u98df\u3089\u308f\u3055\u308c\u308b\u3053\u3068\u304c\u3042\u308a\u307e\u3059\u3002\n\u3069\u3063\u304b\u306eStackOverfow\u3067\u7d39\u4ecb\u3055\u308c\u3066\u305f\uff08\u308f\u3059\u308c\u305f\uff57\uff09\u3068\u304a\u308a\n./gradlew assembleDebug --stacktrace -Pcom.android.build.threadPoolSize=1 -Dorg.gradle.parallel=false -Dorg.gradle.jvmargs=\"-Xms512m -Xmx2048m\" -Dorg.gradle.daemon=false\n\n\u3053\u3093\u306a\u304b\u3093\u3058\u3067\u30d3\u30eb\u30c9\u30b3\u30de\u30f3\u30c9\u3092\u304b\u3051\u3070\u3001\u5f37\u5236\u7d42\u4e86\u3059\u308b\u3053\u3068\u306a\u304f\u30a2\u30d7\u30ea\u306e\u30d3\u30eb\u30c9\u304c\u5b8c\u4e86\u3057\u307e\u3059\u3002\n\nFabric SDK\u306e\u7d44\u307f\u8fbc\u307f\n\u30ea\u30d5\u30a1\u30ec\u30f3\u30b9\u306b\u8f09\u3063\u3066\u306f\u3044\u307e\u3059\u304c\u3001\u305d\u308c\u306a\u308a\u306b\u3084\u308b\u3053\u3068\u304c\u3042\u308a\u307e\u3059\u3002\n\nFabric\u306e\u624b\u52d5\u7d44\u307f\u8fbc\u307f\ndiff --git a/build.gradle b/build.gradle\nindex 9e8f838..c1d3551 100644\n--- a/build.gradle\n+++ b/build.gradle\n@@ -3,20 +3,26 @@\n buildscript {\n     repositories {\n         jcenter()\n+        maven { url 'https://maven.fabric.io/public' }\n     }\n     dependencies {\n-        classpath 'com.android.tools.build:gradle:1.3.0'\n+        classpath 'com.android.tools.build:gradle:1.5.0'\n\n         // NOTE: Do not place your application dependencies here; they belong\n         // in the individual module build.gradle files\n         classpath 'com.neenbedankt.gradle.plugins:android-apt:1.8'\n         classpath 'com.jakewharton.hugo:hugo-plugin:1.2.1'\n+\n+        // The Fabric Gradle plugin uses an open ended version to react\n+        // quickly to Android tooling updates\n+        classpath 'io.fabric.tools:gradle:1.+'\n     }\n }\n\n allprojects {\n     repositories {\n         jcenter()\n+        maven { url 'https://maven.fabric.io/public' }\n     }\n }\n\ndiff --git a/app/build.gradle b/app/build.gradle\nindex b979a36..cd0f12f 100644\n--- a/app/build.gradle\n+++ b/app/build.gradle\n@@ -1,17 +1,22 @@\n apply plugin: 'com.android.application'\n apply plugin: 'com.neenbedankt.android-apt'\n apply plugin: 'com.jakewharton.hugo'\n+apply plugin: 'io.fabric'\n\n android {\n     compileSdkVersion 23\n     buildToolsVersion \"23.0.1\"\n\n+    Properties properties = new Properties()\n+    properties.load(project.rootProject.file('local.properties').newDataInputStream())\n+\n     defaultConfig {\n         applicationId \"chat.rocket.android\"\n         minSdkVersion 16\n         targetSdkVersion 23\n         versionCode 1\n         versionName \"1.0\"\n+        manifestPlaceholders = [fabric_api_key:properties.getProperty(\"FABRIC_API_KEY\", System.getenv(\"FABRIC_API_KEY\"))]\n     }\n     buildTypes {\n         release {\n@@ -41,4 +46,9 @@ dependencies {\n\n     compile 'com.facebook.stetho:stetho:1.2.0'\n     compile 'com.facebook.stetho:stetho-okhttp:1.2.0'\n+\n+    // Crashlytics Kit\n+    compile('com.crashlytics.sdk.android:crashlytics:2.5.5@aar') {\n+        transitive = true\n+    }\n }\n\ndiff --git a/app/src/main/AndroidManifest.xml b/app/src/main/AndroidManifest.xml\nindex d48f872..dae2df4 100644\n--- a/app/src/main/AndroidManifest.xml\n+++ b/app/src/main/AndroidManifest.xml\n@@ -32,6 +32,10 @@\n             android:authorities=\"chat.rocket.android\"\n             android:name=\".content.RocketChatProvider\"\n             android:exported=\"true\"/>\n+\n+        <meta-data\n+            android:name=\"io.fabric.ApiKey\"\n+            android:value=\"${fabric_api_key}\" />\n     </application>\n\n </manifest>\n\n\nFABRIC_API_KEY\u306e\u3068\u3053\u308d\u304c\u3061\u3087\u3063\u3068\u5de5\u592b\u3057\u3066\u3042\u3063\u3066\u3001\n\nlocal.properties \u306b FABRIC_API_KEY=XXXxxxXXXXxxx \u306e\u5b9a\u7fa9\u304c\u3042\u308c\u3070\u305d\u308c\u3092\u4f7f\u3046\n\u2191\u304c\u306a\u3051\u308c\u3070\u3001\u74b0\u5883\u5909\u6570\u306e $FABRIC_API_KEY \u3092\u4f7f\u3046\n\n\u3068\u3044\u3046\u69cb\u6210\u306b\u3057\u3066\u307e\u3059\u3002\u524d\u8005\u304cAndroid Studio\u3067\u30d3\u30eb\u30c9\u901a\u308b\u3088\u3046\u306b\u3059\u308b\u305f\u3081\u3001\u5f8c\u8005\u306fCircle CI\u3067\u697d\u3059\u308b\u305f\u3081\u306b\u3001\u3053\u3046\u3044\u3046\u611f\u3058\u306b\u3057\u307e\u3057\u305f\u3002\n\nFabric SDK\u306e\u521d\u671f\u5316\u51e6\u7406\u3092\u8ffd\u52a0\n\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u30af\u30e9\u30b9\u306b Fabric.with() \u306e\u547c\u3073\u51fa\u3057\u3092\u8ffd\u52a0\u3059\u308c\u3070\u3088\u3044\u3067\u3059\u3002\n\nRocketChatApplication.java\n\ndiff --git a/app/src/main/java/chat/rocket/android/RocketChatApplication.java b/app/src/main/java/chat/rocket/android/RocketChatApplication.java\nindex d837b0b..62b0961 100644\n--- a/app/src/main/java/chat/rocket/android/RocketChatApplication.java\n+++ b/app/src/main/java/chat/rocket/android/RocketChatApplication.java\n@@ -2,12 +2,15 @@ package chat.rocket.android;\n\n import android.app.Application;\n\n+import com.crashlytics.android.Crashlytics;\n+import com.crashlytics.android.core.CrashlyticsCore;\n import com.facebook.stetho.Stetho;\n import com.facebook.stetho.okhttp.StethoInterceptor;\n import com.squareup.picasso.OkHttpDownloader;\n import com.squareup.picasso.Picasso;\n\n import chat.rocket.android.api.OkHttpHelper;\n+import io.fabric.sdk.android.Fabric;\n\n public class RocketChatApplication extends Application {\n     @Override\n@@ -25,5 +28,8 @@ public class RocketChatApplication extends Application {\n\n         Picasso picasso = new Picasso.Builder(this).downloader(new OkHttpDownloader(OkHttpHelper.getClient())).build();\n         Picasso.setSingletonInstance(picasso);\n+\n+        CrashlyticsCore core = new CrashlyticsCore.Builder().disabled(BuildConfig.DEBUG).build();\n+        Fabric.with(this, new Crashlytics.Builder().core(core).build());\n     }\n }\n\n\n\u30c7\u30d0\u30c3\u30b0\u4e2d\u306e\u30af\u30e9\u30c3\u30b7\u30e5\u304c\u30d0\u30f3\u30d0\u30f3\u5831\u544a\u3055\u308c\u308b\u306e\u306f\u52d8\u5f01\u306a\u306e\u3067\u3001Crashlytics\u3092\u30c7\u30d0\u30c3\u30b0\u30d3\u30eb\u30c9\u3067\u306f\u7121\u52b9\u5316\u3067\u30b3\u30e1\u30f3\u30c8\u9802\u3044\u305f\u306e\u3092\u53c2\u8003\u306b\u3001DEBUG\u30d3\u30eb\u30c9\u3067\u306f\u7121\u52b9\u306b\u306a\u308b\u3088\u3046\u306b\u3057\u3066\u307e\u3059\u3002\n\nBeta\u7528\u306e\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3092\u3064\u304f\u308b\n\napp/fabric.properties\napiSecret=XXXXXXxxxXXXXXXxxxxxxXXXXXXxxxXXXXXXxxxxxx\napiKey=XXXXXXxxxXXXXXXxxxxxx\n\n\n\u30ed\u30fc\u30ab\u30eb\u3067\u30d3\u30eb\u30c9\u3059\u308b\u7528\u306b\u306f\u3001\u2191\u306e\u3088\u3046\u306a\u30d5\u30a1\u30a4\u30eb\u3092\u6301\u3063\u3066\u304a\u3051\u3070\u3044\u3044\u3060\u3051\u306a\u3093\u3067\u3059\u304c\u3001\u3053\u3093\u306a\u6a5f\u5bc6\u60c5\u5831\u542b\u3093\u3060\u30d5\u30a1\u30a4\u30eb\u3092GitHub\u306b\u4e0a\u3052\u308b\u308f\u3051\u306b\u3044\u304d\u307e\u305b\u3093\u3002\nCI\u3067\u306f\u74b0\u5883\u5909\u6570\u306b\u3053\u3046\u3044\u3046\u6a5f\u5bc6\u60c5\u5831(?)\u3092\u8a2d\u5b9a\u3057\u3066\u304a\u304f\u3053\u3068\u304c\u3067\u304d\u308b\u306e\u3067\u3001\u305d\u308c\u3092\u5229\u7528\u3057\u307e\u3059\n\n\u2191\u306e\u3088\u3046\u306bFABRIC_API_KEY\u3068FABRIC_BUILD_SECRET\u3092\u3042\u3089\u304b\u3058\u3081\u5165\u308c\u3066\u304a\u3044\u3066\u3001\n\n\u2191\u306e\u3088\u3046\u306b\u305d\u308c\u3092echo\u3057\u3066app/fabric.properties\u306b\u8a70\u3081\u8fbc\u307f\u307e\u3059\u3002\n\n\u03b2\u7248\u914d\u5e03\u6642\u306e\u30ea\u30ea\u30fc\u30b9\u30ce\u30fc\u30c8\nCircle CI\u306f\u3001circle.yml\u3067\u5236\u9650\u3057\u306a\u3044\u304b\u304e\u308a\u306f\u99ac\u9e7f\u6b63\u76f4\u306b\u5168\u30d6\u30e9\u30f3\u30c1\u306e\u5168\u30b3\u30df\u30c3\u30c8\u306b\u5bfe\u3057\u3066\u30d3\u30eb\u30c9\u3092\u3057\u3088\u3046\u3068\u3059\u308b\u306e\u3067\n\n\u3069\u306e\u30d6\u30e9\u30f3\u30c1\u3092\u30d3\u30eb\u30c9\u3057\u305f\u3082\u306e\u304b\n\u3069\u306e\u30b3\u30df\u30c3\u30c8\u3092\u53d6\u308a\u8fbc\u3093\u3060\u3082\u306e\u304b\n\n\u304f\u3089\u3044\u306f\u30ea\u30ea\u30fc\u30b9\u30ce\u30fc\u30c8\u3067\u898b\u308c\u306a\u3044\u3068\u3001\u308f\u308a\u3068\u56f0\u3063\u305f\u3053\u3068\u306b\u306a\u308a\u307e\u3059\u3002\n\napp/build.gradle\ndiff --git a/app/build.gradle b/app/build.gradle\nindex cd0f12f..bad25e6 100644\n--- a/app/build.gradle\n+++ b/app/build.gradle\n@@ -3,6 +3,12 @@ apply plugin: 'com.neenbedankt.android-apt'\n apply plugin: 'com.jakewharton.hugo'\n apply plugin: 'io.fabric'\n\n+def getCurrentCommitMessage() {\n+    def gitlog = 'git log origin/develop...HEAD --decorate'.execute().text\n+    if (gitlog.trim().length()>0) return gitlog\n+    return 'git log -n 1 --decorate'.execute().text\n+}\n+\n android {\n     compileSdkVersion 23\n     buildToolsVersion \"23.0.1\"\n@@ -17,6 +23,8 @@ android {\n         versionCode 1\n         versionName \"1.0\"\n         manifestPlaceholders = [fabric_api_key:properties.getProperty(\"FABRIC_API_KEY\", System.getenv(\"FABRIC_API_KEY\"))]\n+        ext.betaDistributionNotifications=false\n+        ext.betaDistributionReleaseNotes=getCurrentCommitMessage()\n     }\n     buildTypes {\n         release {\n\n\n\u3068\u308a\u3042\u3048\u305a\u3001\u8d85\u9069\u5f53\u3067\u3059\u304c\u3001 git log --decorate \u3067 \u300corigin/develop\u301cHEAD\u307e\u3067\u306e\u30b3\u30df\u30c3\u30c8 \u307e\u305f\u306f \u6700\u65b0\u306e1\u30b3\u30df\u30c3\u30c8\u300d\u3092\u3060\u3059\u3088\u3046\u306b\u3057\u3066\u307f\u307e\u3057\u305f\u3002\n\nBeta\u914d\u5e03\uff01\n\n\u3053\u3093\u306a\u611f\u3058\u306e Post-test commands \u3092\u5b9a\u7fa9\u3057\u3066\u3001CI\u3067\u30d3\u30eb\u30c9\u3092\u304b\u3051\u308b\u3068\u30fb\u30fb\u30fb\n\n\uff77\uff80\u2501\u2501\u2501\u2501(\uff9f\u2200\uff9f)\u2501\u2501\u2501\u2501!!\u3000\u3063\u3066\u306a\u308a\u307e\u3059\u3002\n\n\u5148\u65e5\u3001\u7121\u4e8b\u306b(?)Rocket.Chat.Android\u306e\u30b3\u30df\u30c3\u30bf\u306b\u306a\u308a\u307e\u3057\u305f\u3002\uff08\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u540d\u306f[Lily](https://github.com/RocketChat/Rocket.Chat.Android.Lily)\uff09\n\u3068\u3044\u3046\u3053\u3068\u3067\u3001\u300c\u81ea\u5206\u306e\u74b0\u5883\u3060\u3051\u3067\u30d3\u30eb\u30c9\u304c\u3067\u304d\u308c\u3070\u3044\u3044\u3084\u300d\u307f\u305f\u3044\u306a\u8003\u3048\u306f\u6368\u3066\u3001CircleCI\u3067\u30d3\u30eb\u30c9\u3067\u304d\u308b\u3088\u3046\u306b\u3057\u307e\u3057\u305f\u3002\n\nRocket.Chat\u30c1\u30fc\u30e0\u304b\u3089\u8981\u671b\u304c\u3042\u3063\u305f\u306e\u3067Fabric beta\u3067\u306e\u30a2\u30d7\u30ea\u914d\u5e03\u3082\u3075\u304f\u3081\u3066\u5bfe\u5fdc\u3092\u3057\u305f\u306e\u3067\u3059\u304c\u3001\u6848\u5916\u30cf\u30de\u30ea\u30dd\u30a4\u30f3\u30c8\u304c\u591a\u304b\u3063\u305f\u306e\u3067\u3001\u5171\u6709\u306e\u305f\u3081\u8a18\u4e8b\u3092\u6b8b\u3057\u3066\u304a\u304d\u305f\u3044\u3068\u601d\u3044\u307e\u3059\u3002\n\n## \u65b9\u91dd\n\n* circle.yml \u3092\u4f5c\u3089\u306a\u3044\u3001\u306a\u308b\u3079\u304fCircleCI\u306eProject Settings\u3067\u9811\u5f35\u308b\n* Android Studio\u3067\u3082CI\u3067\u3082\u4f7f\u3048\u308b\u3088\u3046\u306b\u3001\u74b0\u5883\u5909\u6570\u306e\u4f9d\u5b58\u6027\u306f\u5c11\u306a\u304f\n* Fabric\u30d7\u30e9\u30b0\u30a4\u30f3\u306f\u90aa\u9b54\u304f\u3055\u3044\u306e\u3067\u4f7f\u308f\u306a\u3044\n\n## CI\u3067\u30d3\u30eb\u30c9\u3092\u901a\u3059\u305f\u3081\u306b\u2026\n\n### JAVA_HOME\u306e\u8a2d\u5b9a\n\nRocket.Chat.Android.Lily\u3067\u306f\u3001retrolambda\u3092\u3064\u304b\u3063\u3066\u3044\u308b\u305f\u3081\u304b\u3001Java 8\u3058\u3083\u306a\u3044\u3068\u30d3\u30eb\u30c9\u304c\u901a\u308a\u307e\u305b\u3093\u3002\nCircle CI\u306e\u74b0\u5883\u306f\u30c7\u30d5\u30a9\u30eb\u30c8\u3060\u3068Java7\u304c\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u306e\u3067\u3001\u30d3\u30eb\u30c9\u306b\u30b3\u30b1\u307e\u3059\u3002\n\u74b0\u5883\u5909\u6570\u306e\u3068\u3053\u308d\u3067\n\nNAME      | VALUE\n----------+---------------------\nJAVA_HOME |/usr/lib/jvm/jdk1.8.0\n\n\n\u3068\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n\n### ANDROID_HOME\u306e\u8a2d\u5b9a\u30fb\u30fb\u30fb\u306f\u4e0d\u8981\uff01\n\nCI\u304c\u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u5165\u308c\u3066\u304f\u308c\u308b\u3089\u3057\u3044\u3002\n\n### git submodule \u306e\u8a2d\u5b9a\u3001local.properties\u306e\u30bb\u30c3\u30c8\n\nTravis CI\u3060\u3063\u305f\u3089\u52dd\u624b\u306b `git submodule init && git submodule update` \u3063\u3066\u3084\u3063\u3066\u304f\u308c\u308b\u3093\u3067\u3059\u304c\u3001CircleCI\u3067\u306f\u3084\u3063\u3066\u304f\u308c\u307e\u305b\u3093\u3002\n\u3042\u3068\u3001local.properties\u306b`sdk.dir`\u3063\u3066\u306e\u3092\u5b9a\u7fa9\u3057\u3066\u306a\u3044\u3068\u30d3\u30eb\u30c9\u304c\u901a\u308a\u307e\u305b\u3093\u3002\n\nPre-dependency commands\u306e\u3068\u3053\u308d\u306b\n\n```\ngit submodule init && git submodule update\necho \"sdk.dir=\"$ANDROID_HOME > local.properties \n```\n\n\u3068\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n\n## \u30d3\u30eb\u30c9\u30b3\u30de\u30f3\u30c9\u306b\u6ce8\u610f\n\nCircle CI\u306f\u3001\u30e1\u30e2\u30ea\u4f7f\u7528\u304c4GB\u3053\u3048\u308b\u3068\u30d7\u30ed\u30bb\u30b9\u5f37\u5236\u7d42\u4e86\u3055\u308c\u308b\u3001\u3068\u3044\u3046\u52d5\u4f5c\u4ed5\u69d8\u304c\u3042\u308a\u3001\n\n`./gradlew assembleDebug` \u3060\u3068\u3001\n\n```\n> Building 93% > :app:preDexDebug\n\n> Building 93% > :app:preDexDebug./gradlew assembleDebug --info --stacktrace died unexpectedly\n```\n\n\u307f\u305f\u3044\u306a\u304b\u3093\u3058\u3067\u7a81\u7136\u6b7b\u3092\u98df\u3089\u308f\u3055\u308c\u308b\u3053\u3068\u304c\u3042\u308a\u307e\u3059\u3002\n\n\u3069\u3063\u304b\u306eStackOverfow\u3067\u7d39\u4ecb\u3055\u308c\u3066\u305f\uff08\u308f\u3059\u308c\u305f\uff57\uff09\u3068\u304a\u308a\n\n```\n./gradlew assembleDebug --stacktrace -Pcom.android.build.threadPoolSize=1 -Dorg.gradle.parallel=false -Dorg.gradle.jvmargs=\"-Xms512m -Xmx2048m\" -Dorg.gradle.daemon=false\n```\n\n\u3053\u3093\u306a\u304b\u3093\u3058\u3067\u30d3\u30eb\u30c9\u30b3\u30de\u30f3\u30c9\u3092\u304b\u3051\u3070\u3001\u5f37\u5236\u7d42\u4e86\u3059\u308b\u3053\u3068\u306a\u304f\u30a2\u30d7\u30ea\u306e\u30d3\u30eb\u30c9\u304c\u5b8c\u4e86\u3057\u307e\u3059\u3002\n\n\n\n## Fabric SDK\u306e\u7d44\u307f\u8fbc\u307f\n\n\u30ea\u30d5\u30a1\u30ec\u30f3\u30b9\u306b\u8f09\u3063\u3066\u306f\u3044\u307e\u3059\u304c\u3001\u305d\u308c\u306a\u308a\u306b\u3084\u308b\u3053\u3068\u304c\u3042\u308a\u307e\u3059\u3002\n\n```diff:Fabric\u306e\u624b\u52d5\u7d44\u307f\u8fbc\u307f\ndiff --git a/build.gradle b/build.gradle\nindex 9e8f838..c1d3551 100644\n--- a/build.gradle\n+++ b/build.gradle\n@@ -3,20 +3,26 @@\n buildscript {\n     repositories {\n         jcenter()\n+        maven { url 'https://maven.fabric.io/public' }\n     }\n     dependencies {\n-        classpath 'com.android.tools.build:gradle:1.3.0'\n+        classpath 'com.android.tools.build:gradle:1.5.0'\n \n         // NOTE: Do not place your application dependencies here; they belong\n         // in the individual module build.gradle files\n         classpath 'com.neenbedankt.gradle.plugins:android-apt:1.8'\n         classpath 'com.jakewharton.hugo:hugo-plugin:1.2.1'\n+\n+        // The Fabric Gradle plugin uses an open ended version to react\n+        // quickly to Android tooling updates\n+        classpath 'io.fabric.tools:gradle:1.+'\n     }\n }\n \n allprojects {\n     repositories {\n         jcenter()\n+        maven { url 'https://maven.fabric.io/public' }\n     }\n }\n\ndiff --git a/app/build.gradle b/app/build.gradle\nindex b979a36..cd0f12f 100644\n--- a/app/build.gradle\n+++ b/app/build.gradle\n@@ -1,17 +1,22 @@\n apply plugin: 'com.android.application'\n apply plugin: 'com.neenbedankt.android-apt'\n apply plugin: 'com.jakewharton.hugo'\n+apply plugin: 'io.fabric'\n \n android {\n     compileSdkVersion 23\n     buildToolsVersion \"23.0.1\"\n \n+    Properties properties = new Properties()\n+    properties.load(project.rootProject.file('local.properties').newDataInputStream())\n+\n     defaultConfig {\n         applicationId \"chat.rocket.android\"\n         minSdkVersion 16\n         targetSdkVersion 23\n         versionCode 1\n         versionName \"1.0\"\n+        manifestPlaceholders = [fabric_api_key:properties.getProperty(\"FABRIC_API_KEY\", System.getenv(\"FABRIC_API_KEY\"))]\n     }\n     buildTypes {\n         release {\n@@ -41,4 +46,9 @@ dependencies {\n \n     compile 'com.facebook.stetho:stetho:1.2.0'\n     compile 'com.facebook.stetho:stetho-okhttp:1.2.0'\n+\n+    // Crashlytics Kit\n+    compile('com.crashlytics.sdk.android:crashlytics:2.5.5@aar') {\n+        transitive = true\n+    }\n }\n\ndiff --git a/app/src/main/AndroidManifest.xml b/app/src/main/AndroidManifest.xml\nindex d48f872..dae2df4 100644\n--- a/app/src/main/AndroidManifest.xml\n+++ b/app/src/main/AndroidManifest.xml\n@@ -32,6 +32,10 @@\n             android:authorities=\"chat.rocket.android\"\n             android:name=\".content.RocketChatProvider\"\n             android:exported=\"true\"/>\n+\n+        <meta-data\n+            android:name=\"io.fabric.ApiKey\"\n+            android:value=\"${fabric_api_key}\" />\n     </application>\n \n </manifest>\n```\n\nFABRIC_API_KEY\u306e\u3068\u3053\u308d\u304c\u3061\u3087\u3063\u3068\u5de5\u592b\u3057\u3066\u3042\u3063\u3066\u3001\n\n* local.properties \u306b `FABRIC_API_KEY=XXXxxxXXXXxxx` \u306e\u5b9a\u7fa9\u304c\u3042\u308c\u3070\u305d\u308c\u3092\u4f7f\u3046\n* \u2191\u304c\u306a\u3051\u308c\u3070\u3001\u74b0\u5883\u5909\u6570\u306e `$FABRIC_API_KEY` \u3092\u4f7f\u3046\n\n\u3068\u3044\u3046\u69cb\u6210\u306b\u3057\u3066\u307e\u3059\u3002\u524d\u8005\u304cAndroid Studio\u3067\u30d3\u30eb\u30c9\u901a\u308b\u3088\u3046\u306b\u3059\u308b\u305f\u3081\u3001\u5f8c\u8005\u306fCircle CI\u3067\u697d\u3059\u308b\u305f\u3081\u306b\u3001\u3053\u3046\u3044\u3046\u611f\u3058\u306b\u3057\u307e\u3057\u305f\u3002\n\n\n## Fabric SDK\u306e\u521d\u671f\u5316\u51e6\u7406\u3092\u8ffd\u52a0\n\n\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u30af\u30e9\u30b9\u306b `Fabric.with()` \u306e\u547c\u3073\u51fa\u3057\u3092\u8ffd\u52a0\u3059\u308c\u3070\u3088\u3044\u3067\u3059\u3002\n\n```diff:RocketChatApplication.java\n\ndiff --git a/app/src/main/java/chat/rocket/android/RocketChatApplication.java b/app/src/main/java/chat/rocket/android/RocketChatApplication.java\nindex d837b0b..62b0961 100644\n--- a/app/src/main/java/chat/rocket/android/RocketChatApplication.java\n+++ b/app/src/main/java/chat/rocket/android/RocketChatApplication.java\n@@ -2,12 +2,15 @@ package chat.rocket.android;\n \n import android.app.Application;\n \n+import com.crashlytics.android.Crashlytics;\n+import com.crashlytics.android.core.CrashlyticsCore;\n import com.facebook.stetho.Stetho;\n import com.facebook.stetho.okhttp.StethoInterceptor;\n import com.squareup.picasso.OkHttpDownloader;\n import com.squareup.picasso.Picasso;\n \n import chat.rocket.android.api.OkHttpHelper;\n+import io.fabric.sdk.android.Fabric;\n \n public class RocketChatApplication extends Application {\n     @Override\n@@ -25,5 +28,8 @@ public class RocketChatApplication extends Application {\n \n         Picasso picasso = new Picasso.Builder(this).downloader(new OkHttpDownloader(OkHttpHelper.getClient())).build();\n         Picasso.setSingletonInstance(picasso);\n+\n+        CrashlyticsCore core = new CrashlyticsCore.Builder().disabled(BuildConfig.DEBUG).build();\n+        Fabric.with(this, new Crashlytics.Builder().core(core).build());\n     }\n }\n```\n \n\u30c7\u30d0\u30c3\u30b0\u4e2d\u306e\u30af\u30e9\u30c3\u30b7\u30e5\u304c\u30d0\u30f3\u30d0\u30f3\u5831\u544a\u3055\u308c\u308b\u306e\u306f\u52d8\u5f01\u306a\u306e\u3067\u3001[Crashlytics\u3092\u30c7\u30d0\u30c3\u30b0\u30d3\u30eb\u30c9\u3067\u306f\u7121\u52b9\u5316](http://qiita.com/YusukeIwaki/items/e767c45edad48302cec8)\u3067\u30b3\u30e1\u30f3\u30c8\u9802\u3044\u305f\u306e\u3092\u53c2\u8003\u306b\u3001DEBUG\u30d3\u30eb\u30c9\u3067\u306f\u7121\u52b9\u306b\u306a\u308b\u3088\u3046\u306b\u3057\u3066\u307e\u3059\u3002\n\n\n## Beta\u7528\u306e\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3092\u3064\u304f\u308b\n\n```app/fabric.properties\napiSecret=XXXXXXxxxXXXXXXxxxxxxXXXXXXxxxXXXXXXxxxxxx\napiKey=XXXXXXxxxXXXXXXxxxxxx\n```\n\n\u30ed\u30fc\u30ab\u30eb\u3067\u30d3\u30eb\u30c9\u3059\u308b\u7528\u306b\u306f\u3001\u2191\u306e\u3088\u3046\u306a\u30d5\u30a1\u30a4\u30eb\u3092\u6301\u3063\u3066\u304a\u3051\u3070\u3044\u3044\u3060\u3051\u306a\u3093\u3067\u3059\u304c\u3001\u3053\u3093\u306a\u6a5f\u5bc6\u60c5\u5831\u542b\u3093\u3060\u30d5\u30a1\u30a4\u30eb\u3092GitHub\u306b\u4e0a\u3052\u308b\u308f\u3051\u306b\u3044\u304d\u307e\u305b\u3093\u3002\nCI\u3067\u306f\u74b0\u5883\u5909\u6570\u306b\u3053\u3046\u3044\u3046\u6a5f\u5bc6\u60c5\u5831(?)\u3092\u8a2d\u5b9a\u3057\u3066\u304a\u304f\u3053\u3068\u304c\u3067\u304d\u308b\u306e\u3067\u3001\u305d\u308c\u3092\u5229\u7528\u3057\u307e\u3059\n\n![\u74b0\u5883\u5909\u6570](https://qiita-image-store.s3.amazonaws.com/0/74571/641b2174-54ee-4658-8a6d-2b2984fcba4d.png \"\u74b0\u5883\u5909\u6570\")\n\n\u2191\u306e\u3088\u3046\u306b`FABRIC_API_KEY`\u3068`FABRIC_BUILD_SECRET`\u3092\u3042\u3089\u304b\u3058\u3081\u5165\u308c\u3066\u304a\u3044\u3066\u3001\n\n![\u30b9\u30af\u30ea\u30d7\u30c8](https://qiita-image-store.s3.amazonaws.com/0/74571/8c220d21-cf2f-0a63-b339-674b40ed4e6b.png \"\u30b9\u30af\u30ea\u30d7\u30c8\")\n\n\u2191\u306e\u3088\u3046\u306b\u305d\u308c\u3092echo\u3057\u3066app/fabric.properties\u306b\u8a70\u3081\u8fbc\u307f\u307e\u3059\u3002\n\n## \u03b2\u7248\u914d\u5e03\u6642\u306e\u30ea\u30ea\u30fc\u30b9\u30ce\u30fc\u30c8\n\nCircle CI\u306f\u3001circle.yml\u3067\u5236\u9650\u3057\u306a\u3044\u304b\u304e\u308a\u306f\u99ac\u9e7f\u6b63\u76f4\u306b\u5168\u30d6\u30e9\u30f3\u30c1\u306e\u5168\u30b3\u30df\u30c3\u30c8\u306b\u5bfe\u3057\u3066\u30d3\u30eb\u30c9\u3092\u3057\u3088\u3046\u3068\u3059\u308b\u306e\u3067\n\n* \u3069\u306e\u30d6\u30e9\u30f3\u30c1\u3092\u30d3\u30eb\u30c9\u3057\u305f\u3082\u306e\u304b\n* \u3069\u306e\u30b3\u30df\u30c3\u30c8\u3092\u53d6\u308a\u8fbc\u3093\u3060\u3082\u306e\u304b\n\n\u304f\u3089\u3044\u306f\u30ea\u30ea\u30fc\u30b9\u30ce\u30fc\u30c8\u3067\u898b\u308c\u306a\u3044\u3068\u3001\u308f\u308a\u3068\u56f0\u3063\u305f\u3053\u3068\u306b\u306a\u308a\u307e\u3059\u3002\n\n```diff:app/build.gradle\ndiff --git a/app/build.gradle b/app/build.gradle\nindex cd0f12f..bad25e6 100644\n--- a/app/build.gradle\n+++ b/app/build.gradle\n@@ -3,6 +3,12 @@ apply plugin: 'com.neenbedankt.android-apt'\n apply plugin: 'com.jakewharton.hugo'\n apply plugin: 'io.fabric'\n \n+def getCurrentCommitMessage() {\n+    def gitlog = 'git log origin/develop...HEAD --decorate'.execute().text\n+    if (gitlog.trim().length()>0) return gitlog\n+    return 'git log -n 1 --decorate'.execute().text\n+}\n+\n android {\n     compileSdkVersion 23\n     buildToolsVersion \"23.0.1\"\n@@ -17,6 +23,8 @@ android {\n         versionCode 1\n         versionName \"1.0\"\n         manifestPlaceholders = [fabric_api_key:properties.getProperty(\"FABRIC_API_KEY\", System.getenv(\"FABRIC_API_KEY\"))]\n+        ext.betaDistributionNotifications=false\n+        ext.betaDistributionReleaseNotes=getCurrentCommitMessage()\n     }\n     buildTypes {\n         release {\n```\n\n\u3068\u308a\u3042\u3048\u305a\u3001\u8d85\u9069\u5f53\u3067\u3059\u304c\u3001 git log --decorate \u3067 \u300corigin/develop\u301cHEAD\u307e\u3067\u306e\u30b3\u30df\u30c3\u30c8 \u307e\u305f\u306f \u6700\u65b0\u306e1\u30b3\u30df\u30c3\u30c8\u300d\u3092\u3060\u3059\u3088\u3046\u306b\u3057\u3066\u307f\u307e\u3057\u305f\u3002\n\n## Beta\u914d\u5e03\uff01\n\n![./gradlew crashlyticsUploadDistributionDebug](https://qiita-image-store.s3.amazonaws.com/0/74571/f4b25e8b-d759-2744-6184-3866207902fe.png \"./gradlew crashlyticsUploadDistributionDebug\")\n\n\u3053\u3093\u306a\u611f\u3058\u306e Post-test commands \u3092\u5b9a\u7fa9\u3057\u3066\u3001CI\u3067\u30d3\u30eb\u30c9\u3092\u304b\u3051\u308b\u3068\u30fb\u30fb\u30fb\n\n![\uff77\uff80\u2501\u2501\u2501\u2501(\uff9f\u2200\uff9f)\u2501\u2501\u2501\u2501!!](https://qiita-image-store.s3.amazonaws.com/0/74571/82cf59ec-c36e-80f3-0b57-e381999ae45f.png \"\uff77\uff80\u2501\u2501\u2501\u2501(\uff9f\u2200\uff9f)\u2501\u2501\u2501\u2501!!\")\n\n\uff77\uff80\u2501\u2501\u2501\u2501(\uff9f\u2200\uff9f)\u2501\u2501\u2501\u2501!!\u3000\u3063\u3066\u306a\u308a\u307e\u3059\u3002\n", "tags": ["CircleCI", "Android"]}