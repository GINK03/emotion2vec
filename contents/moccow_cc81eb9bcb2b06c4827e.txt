{"tags": ["Ruby", "Sinatra", "Facebook", "Heroku"], "context": " \u3053\u306e\u8a18\u4e8b\u306f\u6700\u7d42\u66f4\u65b0\u65e5\u304b\u30891\u5e74\u4ee5\u4e0a\u304c\u7d4c\u904e\u3057\u3066\u3044\u307e\u3059\u3002<<\u524d\u56de\n\n\u30bd\u30fc\u30b9\uff08app.rb\uff09\u3088\u308a\n\n\napp.rb\nbefore do\n  # HTTPS redirect\n  if settings.environment == :production && request.scheme != 'https'\n    redirect \"https://#{request.env['HTTP_HOST']}\"\n  end\nend\n\n\n\n\u3000\u2193 \u3068\u308a\u3042\u3048\u305a\u3001\u5024\u3092\u30c1\u30a7\u30c3\u30af\u3002\n# settings.environment >> development\n# request.scheme >> http\n# request.env['HTTP_HOST'] >> localhost:5000\n\n\u3000https\u306bredirect\u3057\u3066\u308b\u306e\u306f\u6697\u53f7\u5316\u3059\u308b\u305f\u3081\u304b\uff1f \u203b1\n\u3000\u2192 \u30ea\u30af\u30a8\u30b9\u30c8\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306e\u4e2d\u8eab\n\u3000\u30ea\u30af\u30a8\u30b9\u30c8\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3063\u3066\u3001HTTP\u30ea\u30af\u30a8\u30b9\u30c8\u306e\u3053\u3068\u306a\u3093\u3067\u3059\u306d\u3002\n\u3000 \u30fb\u30ea\u30af\u30a8\u30b9\u30c8\uff1a\u30af\u30e9\u30a4\u30a2\u30f3\u30c8 \u2192 \u30b5\u30fc\u30d0\u30fc\n\u3000 \u30fb\u30ec\u30b9\u30dd\u30f3\u30b9\uff1a\u30b5\u30fc\u30d0 \u2192 \u30af\u30e9\u30a4\u30a2\u30f3\u30c8\n\u3060\u3063\u305f\u306a\u3002\u3055\u3089\u306b\u3001GET\u3068POST, etc. \u304c\u3042\u308b\u3093\u3060\u3063\u3051\u3002\u3002\n\u3000\u3053\u306e\u30a2\u30d7\u30ea\u3067\u53c2\u7167\u3057\u3066\u3044\u308b\u5909\u6570\u306f\u3001scheme, cookies, env \u306e\uff13\u3064\u3002\u307e\u305f\u3001scheme \u4ee5\u5916\u306f\u30cf\u30c3\u30b7\u30e5\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\n\n\nBuilt-in Settings\n:environment - configuration/deployment environment\nA symbol specifying the deployment environment; typically set to one of :development, :test, or :production. The :environment defaults to the value of the RACK_ENV environment variable ( ENV [\u2018RACK_ENV\u2019] ), or :development when no RACK_ENV environment variable is set.\n   The environment can be set explicitly:\nset :environment, :production\n\nSinatra\u516c\u5f0f\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u3088\u308a \u203b2\n\nrequest.env\u306b\u3064\u3044\u3066\u306f\u6b21\u56de>>\u3002\u3002\n\n\n/ * * \u3000\u4eca\u56de\u306e\u5bbf\u984c\u3000 * * /\n\n1. https \u306b\u3059\u308b\u306b\u306f\u30b5\u30fc\u30d0\u5074\u3067\u305d\u306e\u8a2d\u5b9a\u3092\u3059\u308b\u5fc5\u8981\u304c\u3042\u308b\u3088\u3046\u3060\u3051\u3069\u3001\u3053\u308c\u306fRack\u304c\u3084\u3063\u3066\u304f\u308c\u3066\u3044\u308b\u306e\u3060\u308d\u3046\u304b\u3002\n2. environment\u306b\u3064\u3044\u3066\u306f\u3001\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u3067\u306f\u3088\u304f\u5206\u304b\u3089\u306a\u3044\u306e\u3067\u3001\u30aa\u30e9\u30a4\u30ea\u30fc\u672c\u3067\u3082\u8abf\u3079\u308b\u3002\n\u3064\u3065\u304f\n[<<\u524d\u56de](http://qiita.com/moccow/items/9f3b24cdd93b277a3983)\n<br />\n\n[\u30bd\u30fc\u30b9\uff08app.rb\uff09](https://github.com/heroku/facebook-template-ruby/blob/master/app.rb)\u3088\u308a\n\n\n>\n```ruby:app.rb\nbefore do\n  # HTTPS redirect\n  if settings.environment == :production && request.scheme != 'https'\n    redirect \"https://#{request.env['HTTP_HOST']}\"\n  end\nend\n```\n>\n\n\u3000\u2193 \u3068\u308a\u3042\u3048\u305a\u3001\u5024\u3092\u30c1\u30a7\u30c3\u30af\u3002\n\n```ruby:\n# settings.environment >> development\n# request.scheme >> http\n# request.env['HTTP_HOST'] >> localhost:5000\n```\n\n\u3000https\u306bredirect\u3057\u3066\u308b\u306e\u306f\u6697\u53f7\u5316\u3059\u308b\u305f\u3081\u304b\uff1f __\u203b1__\n\n\u3000\u2192 [\u30ea\u30af\u30a8\u30b9\u30c8\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306e\u4e2d\u8eab](http://www.sinatrarb.com/intro-jp.html#%E3%83%AA%E3%82%AF%E3%82%A8%E3%82%B9%E3%83%88%E3%82%AA%E3%83%96%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E3%81%B8%E3%81%AE%E3%82%A2%E3%82%AF%E3%82%BB%E3%82%B9)\n\n\u3000\u30ea\u30af\u30a8\u30b9\u30c8\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3063\u3066\u3001HTTP\u30ea\u30af\u30a8\u30b9\u30c8\u306e\u3053\u3068\u306a\u3093\u3067\u3059\u306d\u3002\n\n\u3000 __\u30fb\u30ea\u30af\u30a8\u30b9\u30c8\uff1a\u30af\u30e9\u30a4\u30a2\u30f3\u30c8 \u2192 \u30b5\u30fc\u30d0\u30fc__\n\u3000 __\u30fb\u30ec\u30b9\u30dd\u30f3\u30b9\uff1a\u30b5\u30fc\u30d0 \u2192 \u30af\u30e9\u30a4\u30a2\u30f3\u30c8__\n\n\u3060\u3063\u305f\u306a\u3002\u3055\u3089\u306b\u3001GET\u3068POST, etc. \u304c\u3042\u308b\u3093\u3060\u3063\u3051\u3002\u3002\n\n\u3000\u3053\u306e\u30a2\u30d7\u30ea\u3067\u53c2\u7167\u3057\u3066\u3044\u308b\u5909\u6570\u306f\u3001scheme, cookies, env \u306e\uff13\u3064\u3002\u307e\u305f\u3001scheme \u4ee5\u5916\u306f\u30cf\u30c3\u30b7\u30e5\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\n<br />\n\n\n>    __Built-in Settings__\n>    __:environment - configuration/deployment environment__\n>\n>    A symbol specifying the deployment environment; typically set to one of __:development__, __:test__, or __:production__. The __:environment__ defaults to the value of the RACK_ENV environment variable ( __ENV [\u2018RACK_ENV\u2019]__ ), or __:development__ when no __RACK_ENV__ environment variable is set.\n>    The environment can be set explicitly:\n>\n> \n```ruby:\nset :environment, :production\n```\n>\n>   [Sinatra\u516c\u5f0f\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8](http://www.sinatrarb.com/configuration.html)\u3088\u308a __\u203b2__\n\nrequest.env\u306b\u3064\u3044\u3066\u306f[\u6b21\u56de>>](http://qiita.com/moccow/items/24eb577099f6bb2fff9c)\u3002\u3002\n\n<br />\n#####__/ * * *\u3000\u4eca\u56de\u306e\u5bbf\u984c\u3000* * * /__\n__1__. [https](http://blog.goo.ne.jp/frontier-k/e/800c62372f1e2c7d7b6adffd3b2e55b6) \u306b\u3059\u308b\u306b\u306f\u30b5\u30fc\u30d0\u5074\u3067\u305d\u306e\u8a2d\u5b9a\u3092\u3059\u308b\u5fc5\u8981\u304c\u3042\u308b\u3088\u3046\u3060\u3051\u3069\u3001\u3053\u308c\u306fRack\u304c\u3084\u3063\u3066\u304f\u308c\u3066\u3044\u308b\u306e\u3060\u308d\u3046\u304b\u3002\n__2__. environment\u306b\u3064\u3044\u3066\u306f\u3001\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u3067\u306f\u3088\u304f\u5206\u304b\u3089\u306a\u3044\u306e\u3067\u3001[\u30aa\u30e9\u30a4\u30ea\u30fc\u672c](http://www.oreilly.co.jp/books/9784873115597/)\u3067\u3082\u8abf\u3079\u308b\u3002\n\n[\u3064\u3065\u304f](http://qiita.com/moccow/items/24eb577099f6bb2fff9c)"}