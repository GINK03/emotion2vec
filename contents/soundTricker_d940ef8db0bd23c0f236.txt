{"context": " More than 1 year has passed since last update.Google Drive\u3067\u9759\u7684\u306aWeb\u30b5\u30a4\u30c8\u304c\u4f5c\u308c\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3057\u305f\u306d\u3002\nhttp://www.itmedia.co.jp/news/articles/1302/06/news139.html\n\u4eca\u56de\u306f\u305b\u3063\u304b\u304f\u51fa\u6765\u305fGoogle Drive\u306e\u9759\u7684\u306a\u30da\u30fc\u30b8(\u4ee5\u4e0bDrive Host Page\u3068\u66f8\u304d\u307e\u3059\u3002\u6b63\u5f0f\u540d\u79f0\u3058\u3083\u306a\u3044\u3063\u3059\u3002)\u3068Google Apps Script\u306eContentService\u3092\u4f7f\u3063\u3066\u7c21\u5358\u306a\u63b2\u793a\u677f\u3092\u4f5c\u3063\u3066\u307f\u305f\u3088\u3063\u3066\u8a71\u3092\u66f8\u304d\u307e\u3059\u3002\n\n\u30b4\u30fc\u30eb\n\u4ee5\u4e0b\u304c\u4f5c\u3063\u305f\u30b5\u30a4\u30c8\u3067\u3059\u3002\nhttps://googledrive.com/host/0BwzWIlBMCiR9SlZkbkFqZ21YeFk/\n\nDrive Host Page\u306e\u4f5c\u308a\u65b9\n\u307e\u305aDrive Host Page\u306e\u4f5c\u308a\u65b9\n\nGoogle Drive\u5185\u306b\u3069\u3053\u3067\u3082\u3044\u3044\u306e\u3067\u30d5\u30a9\u30eb\u30c0\u3092\u4f5c\u308a\u307e\u3059\u3002\n\u4eca\u56de\u306fhome/\u63b2\u793a\u677f/webapp\u3068\u3044\u3046\u30d5\u30a9\u30eb\u30c0\u3092\u4f5c\u308a\u307e\u3057\u305f\u3002\n1.\u3067\u4f5c\u3063\u305f\u516c\u958b\u3057\u305f\u3044\u30d5\u30a1\u30a4\u30eb\u3092\u7f6e\u304f\u30d5\u30a9\u30eb\u30c0\u306e\u5171\u6709\u8a2d\u5b9a\u3092Public on the Web\u306b\u3057\u307e\u3059\u3002\n\u8ab0\u3067\u3082\u95b2\u89a7\u53ef\u306e\u72b6\u614b \u4eca\u56de\u306fwebapp\u3092\u3053\u306e\u8a2d\u5b9a\u306b\u3057\u3066\u3044\u307e\u3059\u3002\n1.\u306e\u30d5\u30a9\u30eb\u30c0\u306b\u30b5\u30a4\u30c8\u3068\u3057\u3066\u516c\u958b\u3057\u305f\u3044html\u30d5\u30a1\u30a4\u30eb\u3092\u7f6e\u304d\u307e\u3059\u3002\n\u3042\u307e\u308a\u3044\u306a\u3044\u304b\u3082\u3067\u3059\u304c\u3082\u3057\u3053\u306e\u6642\u3001GAS\u306a\u3069\u306e\u30c4\u30fc\u30eb\u3092\u4f7f\u3063\u3066\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3057\u305f\u5834\u5408\u3001\nContent-Type\u3092text/html\u3067\u6307\u5b9a\u3057\u3066\u306a\u3044\u3068\u3046\u307e\u304f\u3044\u304b\u306a\u3044\u5834\u5408\u304c\u3042\u308a\u307e\u3059\u3002\n\u7f6e\u3044\u305fhtml\u30d5\u30a1\u30a4\u30eb\u3092drive\u4e0a\u3067\u958b\u304d\u307e\u3059\u3002\u305d\u3046\u3059\u308b\u3068Preview\u3068\u3044\u3046\u30dc\u30bf\u30f3\u304c\u8868\u793a\u3055\u308c\u307e\u3059\u3002\u305d\u308c\u3092\u62bc\u4e0b\u3057\u307e\u3059\u3002\n\u591a\u5206https://googledrive.com/host/{\u516c\u958b\u30d5\u30a9\u30eb\u30c0\u306eID}/{\u30d5\u30a1\u30a4\u30eb\u540d}\u306eURL\u306b\u9077\u79fb\u3057\u3066\u3001web\u30da\u30fc\u30b8\u304c\u8868\u793a\u3055\u308c\u307e\u3059\u3002\n\n\u3053\u3093\u306a\u611f\u3058\u3067\u3001\u516c\u958b\u3057\u305f\u30d5\u30a9\u30eb\u30c0\u306e\u914d\u4e0b\u306bweb\u30b5\u30a4\u30c8\u3068\u3057\u3066\u516c\u958b\u3057\u305f\u3044\u30d5\u30a1\u30a4\u30eb\u3092\u7f6e\u3044\u3066\u3044\u304d\u307e\u3059\u3002\n\u306a\u304a\u3001js\u7528\u306e\u30d5\u30a9\u30eb\u30c0\u3084\u3001img\u7528\u306e\u30d5\u30a9\u30eb\u30c0\u3092\u5207\u3063\u305f\u5834\u5408\u306fhttps://googledrive.com/host/{\u516c\u958b\u30d5\u30a9\u30eb\u30c0\u306eID}/{\u4f5c\u3063\u305f\u30d5\u30a9\u30eb\u30c0\u540d}/{\u30d5\u30a1\u30a4\u30eb\u540d}\u306e\u5f62\u3067\u30a2\u30af\u30bb\u30b9\u3067\u304d\u307e\u3059\u3002\n\nGAS\u306eContentService\u3092\u4f7f\u3063\u3066web\u30b5\u30fc\u30d3\u30b9(Web API)\u3092\u4f5c\u308b\nGoogle Apps Script\u306eContentService\u306ftext\u3001json\u3001xml(atom\u3084rss\u3092\u542b\u3080)\u7b49\u306ehtml\u4ee5\u5916\u306e\u30b3\u30f3\u30c6\u30f3\u30c4\u3092web\u30b5\u30fc\u30d3\u30b9\u3068\u3057\u3066\u8fd4\u5374\u3059\u308b\u305f\u3081\u306e\u30b5\u30fc\u30d3\u30b9\u3067\u3059\u3002\n\u4f8b\u3048\u3070\u5358\u7d14\u306aJSON\u3092\u8fd4\u3057\u305f\u3044\u5834\u5408\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u66f8\u304d\u307e\u3059\u3002\nfunction doGet(e) {\n  var jsonObject = {hoge : 'fuga'};\n  return ContentService.createTextOutput(JSON.stringify(jsonObject)).setMimeType(ContentService.MimeType.JSON);\n}\n\n\u305f\u3060\u3057\u3053\u306e\u30b5\u30fc\u30d3\u30b9\u304c\u516c\u958b\u3055\u308c\u308bURL\u306fhttps://script.google.com/macros/s/{id}/exec\u3068\u306a\u308b\u305f\u3081\u3001\n\u4e0a\u307b\u3069\u4f5c\u6210\u3057\u305fDrive Host Page\u3068\u306f\u7570\u306a\u308b\u30c9\u30e1\u30a4\u30f3\u306b\u306a\u3063\u3066\u3057\u307e\u3044\u307e\u3059\u3002\n\u306a\u306e\u3067Javascript\u304b\u3089\u306f\u76f4\u63a5\u30a2\u30af\u30bb\u30b9\u304c\u3067\u304d\u307e\u305b\u3093\u3002\n\u203bGAS\u306eContentService\u3067\u8fd4\u5374\u3055\u308c\u308b\u30b3\u30f3\u30c6\u30f3\u30c4\u306b\u306fAccess-Control-Allow-Origin\u30d8\u30c3\u30c0\u3082\u3064\u3044\u3066\u306a\u3044\u306e\u3067Cross Domain XHR\u3082\u7121\u7406\u3063\u3059\n\u305d\u3053\u3067GAS\u5074\u3067JSONP\u5f62\u5f0f\u3067\u3082\u8fd4\u5374\u3059\u308b\u3088\u3046\u306b\u3057\u3066\u304a\u304d\u307e\u3059\u3002\nfunction doGet(e) {\n  var jsonObject = {hoge : 'fuga'};\n  if(e.parameter.callback) {//callback\u306f\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u304b\u3089\u6307\u5b9a\u3055\u308c\u308bcallback\u95a2\u6570\u540d\n    return ContentService.createTextOutput(e.parameter.callback + '(' + JSON.stringify(jsonObject) + ')').setMimeType(ContentService.MimeType.JSON);\n  } else {\n    return ContentService.createTextOutput(JSON.stringify(jsonObject)).setMimeType(ContentService.MimeType.JSON);\n  }\n}\n\n\u307e\u305fGAS\u3067\u306fGET\u3068POST\u306e\u307f\u30b5\u30dd\u30fc\u30c8\u3055\u308c\u3066\u304a\u308a\u3001\u304b\u3064URI\u306b\u5bc4\u308bREST\u3063\u307d\u3044API\u3082\u4f5c\u308c\u307e\u305b\u3093\u3002\n\u306a\u306e\u3067\u64cd\u4f5c(\u30c7\u30fc\u30bf\u3092\u53d6\u5f97\u3059\u308b\u3068\u304b\u30c7\u30fc\u30bf\u3092\u8ffd\u52a0\u3059\u308b)\u306f\u5168\u3066\u30d1\u30e9\u30e1\u30fc\u30bf\u3068\u3057\u3066\u6e21\u3057\u307e\u3059\u3002\nfunction doGet(e) {\n\n  if(!e.parameter.action) { //action\u306fapi\u306e\u64cd\u4f5c\n    return createContent(e.parameter.callback , {error :'action is required '});\n  }\n\n  switch(e.parameter.action) { //switch\u3067\u66f8\u3044\u3066\u307e\u3059\u304c\u3001\u898f\u6a21\u306b\u3088\u3063\u3066\u306fstrategy\u30d1\u30bf\u30fc\u30f3\u3068\u304b\u306b\u3057\u305f\u307b\u3046\u304c\u3044\u3044\u304b\u3082\u3067\u3059\u306d\n    case 'get':\n      return createContent(e.parameter.callback , doSomething1(e));\n    case 'put':\n      return createContent(e.parameter.callback , doSomething2(e));\n    default : \n      return createContent(e.parameter.callback , {error : \"unsupported operation\"});\n   } \n}\n\nfunction createContent(callback , returnObject) {\n  if(callback ) {//callback\u306f\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u304b\u3089\u6307\u5b9a\u3055\u308c\u308bcallback\u95a2\u6570\u540d\n    return ContentService.createTextOutput(callback + '(' + JSON.stringify(returnObject) + ')').setMimeType(ContentService.MimeType.JSON);\n  } else {\n    return ContentService.createTextOutput(JSON.stringify(returnObject)).setMimeType(ContentService.MimeType.JSON);\n  }\n\n\n}\n\n\u5f8c\u306f\u30af\u30e9\u30a4\u30a2\u30f3\u30c8(Drive Host Page\u306ejs\u3068\u304b)\u304b\u3089JSONP\u3067\u30a2\u30af\u30bb\u30b9\u3059\u308c\u3070\u30c7\u30fc\u30bf\u3092\u53d6\u5f97\u51fa\u6765\u307e\u3059\u3002\n\n\u8a8d\u8a3c\u3068\u304b\nGAS\u306fGoogle Apps\u30c9\u30e1\u30a4\u30f3\u3092\u9664\u304d\u3001\u8a8d\u8a3c(\u30e6\u30fc\u30b6\u3092\u5224\u5225\u3059\u308b\u65b9\u6cd5)\u306f1\u7a2e\u985e\u3057\u304b\u7121\u3044\u3067\u3059\u3002\nGAS\u3092Web App\u3068\u3057\u3066\u516c\u958b\u3059\u308b\u3068\u304d\u306b\u6307\u5b9a\u3059\u308b\u300cExecute the app as:\u300d\u3092\u300cUser accessing the web\u300d\u306b\u3057\u3001\n\u30e6\u30fc\u30b6\u304cAPI\u306b\u521d\u56de\u30a2\u30af\u30bb\u30b9\u3059\u308b\u3068\u304d\u306b\u8868\u793a\u3055\u308c\u308b\u30c0\u30a4\u30a2\u30ed\u30b0\u3092\u5229\u7528\u3057\u3066\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb(\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3068\u3044\u3046\u3088\u308aOAuth\u8a8d\u53ef\u306b\u8fd1\u3044\u3068\u601d\u3044\u307e\u3059\u304c)\u3057\u3066\u8cb0\u3046\u65b9\u6cd5\u3067\u3059\u3002\n\u3082\u3057\u300cExecute the app as:\u300d\u3092\u300cme\u300d\u306b\u3057\u3066\u3044\u308b\u5834\u5408\u3001GAS\u306eSession.getActiveUser()\u3068\u3044\u3046\u30b5\u30fc\u30d3\u30b9\u3067\u30e6\u30fc\u30b6\u306f\u8fd4\u5374\u3055\u308c\u307e\u3059\u304c\u3001\u305d\u306e\u5f8c\u53d6\u5f97\u3057\u305fUser\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306egetEmail\u30e1\u30bd\u30c3\u30c9\u306a\u3069\u306f\u7a7a\u3092\u8fd4\u5374\u3057\u307e\u3059\u3002\n\u203b\u3042\u3068\u3067\u30ad\u30e3\u30d7\u30c1\u30e3\u8cbc\u308b\n\u6b8b\u5ff5\u306a\u304c\u3089\u3053\u306e\u65b9\u6cd5\u306fContentService\u3092\u5229\u7528\u3057\u305f\u5834\u5408\u3082\u540c\u3058\u3067\u3001Web API\u3068\u3057\u3066\u3001json\u304c\u9084\u3063\u3066\u304f\u308b\u3053\u3068\u3092\u671f\u5f85\u3057\u3066javascript\u304b\u3089\u30a2\u30af\u30bb\u30b9\u3057\u3066\u3082\u3001\n\u9084\u3063\u3066\u304f\u308b\u306e\u306f\u4e0a\u306e\u30c0\u30a4\u30a2\u30ed\u30b0(\u3064\u307e\u308ahtml)\u306b\u306a\u308a\u307e\u3059\u3002\n\u305d\u3053\u3067\u3001\u4eca\u56de\u4f5c\u3063\u305f\u30a2\u30d7\u30ea\u3067\u306fDrive Host Page\u3092\u958b\u3044\u305f\u969b\u306bjavascript\u3067\u4e00\u5ea6jsonp\u3068\u3057\u3066\u30a2\u30af\u30bb\u30b9\u3057\u3001\n\u8fd4\u5374\u3055\u308c\u305f\u30c6\u30ad\u30b9\u30c8\u3092json\u3068\u89e3\u91c8\u3055\u305b\u3001\u30a8\u30e9\u30fc\u304c\u767a\u751f\u3057\u305f\u5834\u5408\u306f\u8a8d\u8a3c(GAS\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb)\u304c\u6e08\u3093\u3067\u306a\u3044\u3068\u8003\u3048\u3001\n\u8a8d\u8a3c\u3057\u3066\u3082\u3089\u3046\u305f\u3081\u306e\u30ea\u30f3\u30af\u3092\u8868\u793a\u3057\u3066\u3044\u307e\u3059\u3002\n//\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u30b5\u30a4\u30c9\u306eJS angularjs\u3092\u5229\u7528\u3057\u3066\u3044\u307e\u3059\u3002\n$http({\n  method: 'JSONP',\n  url: 'https://script.google.com/macros/s/AKfycbylYV5MrVg3d-Yi3IssTzo4_xIGsfGs0fgLY1fMcF5WUc02UKM/exec?callback=JSON_CALLBACK&action=messages'\n}).success(function(data, status) {\n\n  //success\u306e\u5834\u5408\u306fjson\u6587\u5b57\u5217\u306e\u8a55\u4fa1\u304c\u6210\u529f == \u8a8d\u8a3c\u6e08\u307f\n  $scope.messages = $scope.messages.concat(data);\n}).error(function(data,status,headers,config){\n\n  //error\u306e\u5834\u5408\u306fjson\u6587\u5b57\u5217\u306e\u8a55\u4fa1\u304c\u5931\u6557 == \u591a\u5206\u8a8d\u8a3c\u3067\u304d\u3066\u306a\u3044 => \u8a8d\u8a3c\u3057\u3066\u3082\u3089\u3046\u305f\u3081\u306b\u30ea\u30f3\u30af\u3092\u8868\u793a\n  $scope.showAuthentification = true;\n});\n\n\u307e\u305f\u8a8d\u8a3c\u306f \u5143\u306e\u30a2\u30af\u30bb\u30b9\u3057\u305fGAS\u306eURL \u2192 Google\u306e\u8a8d\u8a3cURL \u2192 \u5143\u306e\u30a2\u30af\u30bb\u30b9\u3057\u305fGAS\u306eURL \u3068\u9077\u79fb\u3059\u308b\u306e\u3067\u3001\nWeb API\u3092\u8868\u793a\u3057\u3066\u3044\u308bGAS\u5074\u3067\u5143\u306eDrive Host Page\u306b\u623b\u308b\u305f\u3081\u306e\u30ea\u30f3\u30af\u3092\u8868\u793a\u3055\u305b\u307e\u3059\u3002\nfunction doGet(e) {\n  if(e.parameter.auth) {  //\u8a8d\u8a3c\u6642\u306fauth\u3068\u3044\u3046\u30d1\u30e9\u30e1\u30fc\u30bf\u3092\u4ed8\u3051\u3066\u304a\u304f\n    return HtmlService.createHtmlOutputFromFile(\"index.html\"); //\u8a8d\u8a3c\u5f8c\u306b\u5143\u306eDrive Host Page\u306b\u623b\u3063\u3066\u3082\u3089\u3046\u305f\u3081\u306e\u30ea\u30f3\u30af\u3092\u8868\u793a\u3059\u308b\u753b\u9762\u3092\u8fd4\u5374\u3059\u308b\u3002\n  }\n\n  //web api\u306e\u51e6\u7406\u304c\u7d9a\u304f\n  ...\n}\n\n\u306a\u304a\u3001Google Apps\u306eGAS\u306e\u5834\u5408\u306f\u300cExecute the app as:\u300d\u3092\u300cme\u300d\u306b\u3057\u3066\u3044\u3066\u3082\u3001GAS\u306eSession.getActiveUser().getEmail()\u306f\u30a2\u30af\u30bb\u30b9\u3057\u305f\n\u30e6\u30fc\u30b6\u306e\u30a2\u30c9\u30ec\u30b9\u304c\u8fd4\u5374\u3055\u308c\u308b\u305f\u3081\u3001\u4e0a\u8a18\u306e\u3088\u3046\u306a\u64cd\u4f5c\u306f\u4e0d\u8981\u306b\u306a\u308a\u307e\u3059\u3002\n\n\u30c7\u30fc\u30bf\u306e\u4fdd\u5b58\n\u3053\u3053\u307e\u3067\u6765\u308c\u3070\u30c7\u30fc\u30bf\u306e\u4fdd\u5b58\u306f\u3069\u3053\u306b\u3084\u3063\u3066\u3082\u826f\u3044\u3067\u3059\u3002\n\u4eca\u56de\u306e\u30a2\u30d7\u30ea\u3067\u306f\u8fd4\u5374\u3059\u308bJSON\u3092\u30e9\u30af\u306b\u4f5c\u308b\u305f\u3081\u306bScriptDb\u3092\u5229\u7528\u3057\u3066\u3044\u307e\u3059\u304c\u3001\n\u30b5\u30fc\u30d3\u30b9\u306e\u7a2e\u985e\u306b\u3088\u3063\u3066Spreadsheet\u306b\u3057\u305f\u308a\u3001ScriptProperties\u306b\u3057\u305f\u308a\u3001Fusion Tables\u306b\u3057\u305f\u308a\u3068\u9069\u5207\u306a\u3082\u306e\u306b\u3057\u3066\u4e0b\u3055\u3044\u3002\n\u305f\u3060\u3057\u3001\u300cExecute the app as:\u300d\u3092\u300cUser accessing the web\u300d\u306b\u3057\u3066\u3044\u308b\u305f\u3081\u3001\nSpreadsheet\u3084Fusion Tables\u306e\u5834\u5408\u306f\u30e6\u30fc\u30b6\u81ea\u8eab\u304c\u3001\u305d\u306e\u30d5\u30a1\u30a4\u30eb\u3078\u306e\u30a2\u30af\u30bb\u30b9\u6a29\u9650\u3092\u4fdd\u3064\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\nDB\u3092\u516c\u958b\u3057\u305f\u304f\u306a\u3044\u5834\u5408\u306fScriptDb\u3084\u3001ScriptProperties\u306a\u3069Script\u81ea\u4f53\u306b\u30c7\u30fc\u30bf\u304c\u7d10\u3065\u304f\u30b5\u30fc\u30d3\u30b9\u3092\u5229\u7528\u3057\u305f\u307b\u3046\u304c\u826f\u3044\u3067\u3059\u3002\nP.S.\nGoogle Drive Host Page\u304c2/6\u306b\u8ffd\u52a0\u3055\u308c\u305f\u3063\u3066\u66f8\u3044\u3066\u3042\u308b\u3093\u3067\u3059\u304c\u4ed5\u7d44\u307f\u7684\u306b\u306f\u6628\u5e74\u3050\u3089\u3044\u306b\u8ffd\u52a0\u3055\u308c\u3066\u3044\u308b\u3093\u3067\u3059\u3088\u306d\n\u306a\u3093\u3067Google\u3082\u6539\u3081\u3066\u767a\u8868\u3057\u305f\u306e\u304b\u82e5\u5e72\u6c17\u306b\u306a\u3063\u305f\u308a\u3057\u307e\u3059\u3002\nhttp://googleappsdeveloper.blogspot.jp/2012/11/announcing-google-drive-site-publishing.html?utm_source=feedburner&utm_medium=feed&utm_campaign=Feed:+GoogleAppsDeveloperBlog+(Google+Apps+Developer+Blog)\nGoogle Drive\u3067\u9759\u7684\u306aWeb\u30b5\u30a4\u30c8\u304c\u4f5c\u308c\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3057\u305f\u306d\u3002\nhttp://www.itmedia.co.jp/news/articles/1302/06/news139.html\n\n\u4eca\u56de\u306f\u305b\u3063\u304b\u304f\u51fa\u6765\u305fGoogle Drive\u306e\u9759\u7684\u306a\u30da\u30fc\u30b8(\u4ee5\u4e0bDrive Host Page\u3068\u66f8\u304d\u307e\u3059\u3002\u6b63\u5f0f\u540d\u79f0\u3058\u3083\u306a\u3044\u3063\u3059\u3002)\u3068Google Apps Script\u306eContentService\u3092\u4f7f\u3063\u3066\u7c21\u5358\u306a\u63b2\u793a\u677f\u3092\u4f5c\u3063\u3066\u307f\u305f\u3088\u3063\u3066\u8a71\u3092\u66f8\u304d\u307e\u3059\u3002\n\n# \u30b4\u30fc\u30eb\n\n\u4ee5\u4e0b\u304c\u4f5c\u3063\u305f\u30b5\u30a4\u30c8\u3067\u3059\u3002\nhttps://googledrive.com/host/0BwzWIlBMCiR9SlZkbkFqZ21YeFk/\n\n# Drive Host Page\u306e\u4f5c\u308a\u65b9\n\u307e\u305aDrive Host Page\u306e\u4f5c\u308a\u65b9\n\n1. Google Drive\u5185\u306b\u3069\u3053\u3067\u3082\u3044\u3044\u306e\u3067\u30d5\u30a9\u30eb\u30c0\u3092\u4f5c\u308a\u307e\u3059\u3002\n\u4eca\u56de\u306f`home/\u63b2\u793a\u677f/webapp`\u3068\u3044\u3046\u30d5\u30a9\u30eb\u30c0\u3092\u4f5c\u308a\u307e\u3057\u305f\u3002\n\n2. 1.\u3067\u4f5c\u3063\u305f\u516c\u958b\u3057\u305f\u3044\u30d5\u30a1\u30a4\u30eb\u3092\u7f6e\u304f\u30d5\u30a9\u30eb\u30c0\u306e\u5171\u6709\u8a2d\u5b9a\u3092`Public on the Web`\u306b\u3057\u307e\u3059\u3002\n\u8ab0\u3067\u3082\u95b2\u89a7\u53ef\u306e\u72b6\u614b \u4eca\u56de\u306fwebapp\u3092\u3053\u306e\u8a2d\u5b9a\u306b\u3057\u3066\u3044\u307e\u3059\u3002\n\n3. 1.\u306e\u30d5\u30a9\u30eb\u30c0\u306b\u30b5\u30a4\u30c8\u3068\u3057\u3066\u516c\u958b\u3057\u305f\u3044html\u30d5\u30a1\u30a4\u30eb\u3092\u7f6e\u304d\u307e\u3059\u3002\n\u3042\u307e\u308a\u3044\u306a\u3044\u304b\u3082\u3067\u3059\u304c\u3082\u3057\u3053\u306e\u6642\u3001GAS\u306a\u3069\u306e\u30c4\u30fc\u30eb\u3092\u4f7f\u3063\u3066\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3057\u305f\u5834\u5408\u3001\nContent-Type\u3092text/html\u3067\u6307\u5b9a\u3057\u3066\u306a\u3044\u3068\u3046\u307e\u304f\u3044\u304b\u306a\u3044\u5834\u5408\u304c\u3042\u308a\u307e\u3059\u3002\n\n4. \u7f6e\u3044\u305fhtml\u30d5\u30a1\u30a4\u30eb\u3092drive\u4e0a\u3067\u958b\u304d\u307e\u3059\u3002\u305d\u3046\u3059\u308b\u3068`Preview`\u3068\u3044\u3046\u30dc\u30bf\u30f3\u304c\u8868\u793a\u3055\u308c\u307e\u3059\u3002\u305d\u308c\u3092\u62bc\u4e0b\u3057\u307e\u3059\u3002\n\n5. \u591a\u5206`https://googledrive.com/host/{\u516c\u958b\u30d5\u30a9\u30eb\u30c0\u306eID}/{\u30d5\u30a1\u30a4\u30eb\u540d}`\u306eURL\u306b\u9077\u79fb\u3057\u3066\u3001web\u30da\u30fc\u30b8\u304c\u8868\u793a\u3055\u308c\u307e\u3059\u3002\n\n\u3053\u3093\u306a\u611f\u3058\u3067\u3001\u516c\u958b\u3057\u305f\u30d5\u30a9\u30eb\u30c0\u306e\u914d\u4e0b\u306bweb\u30b5\u30a4\u30c8\u3068\u3057\u3066\u516c\u958b\u3057\u305f\u3044\u30d5\u30a1\u30a4\u30eb\u3092\u7f6e\u3044\u3066\u3044\u304d\u307e\u3059\u3002  \n\u306a\u304a\u3001js\u7528\u306e\u30d5\u30a9\u30eb\u30c0\u3084\u3001img\u7528\u306e\u30d5\u30a9\u30eb\u30c0\u3092\u5207\u3063\u305f\u5834\u5408\u306f`https://googledrive.com/host/{\u516c\u958b\u30d5\u30a9\u30eb\u30c0\u306eID}/{\u4f5c\u3063\u305f\u30d5\u30a9\u30eb\u30c0\u540d}/{\u30d5\u30a1\u30a4\u30eb\u540d}`\u306e\u5f62\u3067\u30a2\u30af\u30bb\u30b9\u3067\u304d\u307e\u3059\u3002\n\n# GAS\u306eContentService\u3092\u4f7f\u3063\u3066web\u30b5\u30fc\u30d3\u30b9(Web API)\u3092\u4f5c\u308b\n\nGoogle Apps Script\u306eContentService\u306ftext\u3001json\u3001xml(atom\u3084rss\u3092\u542b\u3080)\u7b49\u306ehtml\u4ee5\u5916\u306e\u30b3\u30f3\u30c6\u30f3\u30c4\u3092web\u30b5\u30fc\u30d3\u30b9\u3068\u3057\u3066\u8fd4\u5374\u3059\u308b\u305f\u3081\u306e\u30b5\u30fc\u30d3\u30b9\u3067\u3059\u3002\n\n\u4f8b\u3048\u3070\u5358\u7d14\u306aJSON\u3092\u8fd4\u3057\u305f\u3044\u5834\u5408\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u66f8\u304d\u307e\u3059\u3002\n\n```javascript\nfunction doGet(e) {\n  var jsonObject = {hoge : 'fuga'};\n  return ContentService.createTextOutput(JSON.stringify(jsonObject)).setMimeType(ContentService.MimeType.JSON);\n}\n```\n\n\u305f\u3060\u3057\u3053\u306e\u30b5\u30fc\u30d3\u30b9\u304c\u516c\u958b\u3055\u308c\u308bURL\u306f`https://script.google.com/macros/s/{id}/exec`\u3068\u306a\u308b\u305f\u3081\u3001\n\u4e0a\u307b\u3069\u4f5c\u6210\u3057\u305fDrive Host Page\u3068\u306f\u7570\u306a\u308b\u30c9\u30e1\u30a4\u30f3\u306b\u306a\u3063\u3066\u3057\u307e\u3044\u307e\u3059\u3002\n\u306a\u306e\u3067Javascript\u304b\u3089\u306f\u76f4\u63a5\u30a2\u30af\u30bb\u30b9\u304c\u3067\u304d\u307e\u305b\u3093\u3002\n\u203bGAS\u306eContentService\u3067\u8fd4\u5374\u3055\u308c\u308b\u30b3\u30f3\u30c6\u30f3\u30c4\u306b\u306f`Access-Control-Allow-Origin`\u30d8\u30c3\u30c0\u3082\u3064\u3044\u3066\u306a\u3044\u306e\u3067Cross Domain XHR\u3082\u7121\u7406\u3063\u3059\n\n\u305d\u3053\u3067GAS\u5074\u3067JSONP\u5f62\u5f0f\u3067\u3082\u8fd4\u5374\u3059\u308b\u3088\u3046\u306b\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n\n```javascript\nfunction doGet(e) {\n  var jsonObject = {hoge : 'fuga'};\n  if(e.parameter.callback) {//callback\u306f\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u304b\u3089\u6307\u5b9a\u3055\u308c\u308bcallback\u95a2\u6570\u540d\n    return ContentService.createTextOutput(e.parameter.callback + '(' + JSON.stringify(jsonObject) + ')').setMimeType(ContentService.MimeType.JSON);\n  } else {\n    return ContentService.createTextOutput(JSON.stringify(jsonObject)).setMimeType(ContentService.MimeType.JSON);\n  }\n}\n```\n\n\u307e\u305fGAS\u3067\u306fGET\u3068POST\u306e\u307f\u30b5\u30dd\u30fc\u30c8\u3055\u308c\u3066\u304a\u308a\u3001\u304b\u3064URI\u306b\u5bc4\u308bREST\u3063\u307d\u3044API\u3082\u4f5c\u308c\u307e\u305b\u3093\u3002\n\u306a\u306e\u3067\u64cd\u4f5c(`\u30c7\u30fc\u30bf\u3092\u53d6\u5f97\u3059\u308b`\u3068\u304b`\u30c7\u30fc\u30bf\u3092\u8ffd\u52a0\u3059\u308b`)\u306f\u5168\u3066\u30d1\u30e9\u30e1\u30fc\u30bf\u3068\u3057\u3066\u6e21\u3057\u307e\u3059\u3002\n\n```javascript\nfunction doGet(e) {\n\n  if(!e.parameter.action) { //action\u306fapi\u306e\u64cd\u4f5c\n    return createContent(e.parameter.callback , {error :'action is required '});\n  }\n\n  switch(e.parameter.action) { //switch\u3067\u66f8\u3044\u3066\u307e\u3059\u304c\u3001\u898f\u6a21\u306b\u3088\u3063\u3066\u306fstrategy\u30d1\u30bf\u30fc\u30f3\u3068\u304b\u306b\u3057\u305f\u307b\u3046\u304c\u3044\u3044\u304b\u3082\u3067\u3059\u306d\n    case 'get':\n      return createContent(e.parameter.callback , doSomething1(e));\n    case 'put':\n      return createContent(e.parameter.callback , doSomething2(e));\n    default : \n      return createContent(e.parameter.callback , {error : \"unsupported operation\"});\n   } \n}\n\nfunction createContent(callback , returnObject) {\n  if(callback ) {//callback\u306f\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u304b\u3089\u6307\u5b9a\u3055\u308c\u308bcallback\u95a2\u6570\u540d\n    return ContentService.createTextOutput(callback + '(' + JSON.stringify(returnObject) + ')').setMimeType(ContentService.MimeType.JSON);\n  } else {\n    return ContentService.createTextOutput(JSON.stringify(returnObject)).setMimeType(ContentService.MimeType.JSON);\n  }\n\n\n}\n```\n\n\u5f8c\u306f\u30af\u30e9\u30a4\u30a2\u30f3\u30c8(Drive Host Page\u306ejs\u3068\u304b)\u304b\u3089JSONP\u3067\u30a2\u30af\u30bb\u30b9\u3059\u308c\u3070\u30c7\u30fc\u30bf\u3092\u53d6\u5f97\u51fa\u6765\u307e\u3059\u3002\n\n# \u8a8d\u8a3c\u3068\u304b\n\nGAS\u306fGoogle Apps\u30c9\u30e1\u30a4\u30f3\u3092\u9664\u304d\u3001\u8a8d\u8a3c(\u30e6\u30fc\u30b6\u3092\u5224\u5225\u3059\u308b\u65b9\u6cd5)\u306f1\u7a2e\u985e\u3057\u304b\u7121\u3044\u3067\u3059\u3002    \nGAS\u3092Web App\u3068\u3057\u3066\u516c\u958b\u3059\u308b\u3068\u304d\u306b\u6307\u5b9a\u3059\u308b\u300cExecute the app as:\u300d\u3092\u300cUser accessing the web\u300d\u306b\u3057\u3001\n\u30e6\u30fc\u30b6\u304cAPI\u306b\u521d\u56de\u30a2\u30af\u30bb\u30b9\u3059\u308b\u3068\u304d\u306b\u8868\u793a\u3055\u308c\u308b\u30c0\u30a4\u30a2\u30ed\u30b0\u3092\u5229\u7528\u3057\u3066\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb(\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3068\u3044\u3046\u3088\u308aOAuth\u8a8d\u53ef\u306b\u8fd1\u3044\u3068\u601d\u3044\u307e\u3059\u304c)\u3057\u3066\u8cb0\u3046\u65b9\u6cd5\u3067\u3059\u3002\n\n\u3082\u3057\u300cExecute the app as:\u300d\u3092\u300cme\u300d\u306b\u3057\u3066\u3044\u308b\u5834\u5408\u3001GAS\u306e`Session.getActiveUser()`\u3068\u3044\u3046\u30b5\u30fc\u30d3\u30b9\u3067\u30e6\u30fc\u30b6\u306f\u8fd4\u5374\u3055\u308c\u307e\u3059\u304c\u3001\u305d\u306e\u5f8c\u53d6\u5f97\u3057\u305f`User`\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306e`getEmail`\u30e1\u30bd\u30c3\u30c9\u306a\u3069\u306f\u7a7a\u3092\u8fd4\u5374\u3057\u307e\u3059\u3002\n\n\u203b\u3042\u3068\u3067\u30ad\u30e3\u30d7\u30c1\u30e3\u8cbc\u308b\n\n\u6b8b\u5ff5\u306a\u304c\u3089\u3053\u306e\u65b9\u6cd5\u306fContentService\u3092\u5229\u7528\u3057\u305f\u5834\u5408\u3082\u540c\u3058\u3067\u3001Web API\u3068\u3057\u3066\u3001json\u304c\u9084\u3063\u3066\u304f\u308b\u3053\u3068\u3092\u671f\u5f85\u3057\u3066javascript\u304b\u3089\u30a2\u30af\u30bb\u30b9\u3057\u3066\u3082\u3001\n\u9084\u3063\u3066\u304f\u308b\u306e\u306f\u4e0a\u306e\u30c0\u30a4\u30a2\u30ed\u30b0(\u3064\u307e\u308ahtml)\u306b\u306a\u308a\u307e\u3059\u3002\n\n\u305d\u3053\u3067\u3001\u4eca\u56de\u4f5c\u3063\u305f\u30a2\u30d7\u30ea\u3067\u306fDrive Host Page\u3092\u958b\u3044\u305f\u969b\u306bjavascript\u3067\u4e00\u5ea6jsonp\u3068\u3057\u3066\u30a2\u30af\u30bb\u30b9\u3057\u3001\n\u8fd4\u5374\u3055\u308c\u305f\u30c6\u30ad\u30b9\u30c8\u3092json\u3068\u89e3\u91c8\u3055\u305b\u3001\u30a8\u30e9\u30fc\u304c\u767a\u751f\u3057\u305f\u5834\u5408\u306f\u8a8d\u8a3c(GAS\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb)\u304c\u6e08\u3093\u3067\u306a\u3044\u3068\u8003\u3048\u3001\n\u8a8d\u8a3c\u3057\u3066\u3082\u3089\u3046\u305f\u3081\u306e\u30ea\u30f3\u30af\u3092\u8868\u793a\u3057\u3066\u3044\u307e\u3059\u3002\n\n```javascript\n//\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u30b5\u30a4\u30c9\u306eJS angularjs\u3092\u5229\u7528\u3057\u3066\u3044\u307e\u3059\u3002\n$http({\n  method: 'JSONP',\n  url: 'https://script.google.com/macros/s/AKfycbylYV5MrVg3d-Yi3IssTzo4_xIGsfGs0fgLY1fMcF5WUc02UKM/exec?callback=JSON_CALLBACK&action=messages'\n}).success(function(data, status) {\n\n  //success\u306e\u5834\u5408\u306fjson\u6587\u5b57\u5217\u306e\u8a55\u4fa1\u304c\u6210\u529f == \u8a8d\u8a3c\u6e08\u307f\n  $scope.messages = $scope.messages.concat(data);\n}).error(function(data,status,headers,config){\n\n  //error\u306e\u5834\u5408\u306fjson\u6587\u5b57\u5217\u306e\u8a55\u4fa1\u304c\u5931\u6557 == \u591a\u5206\u8a8d\u8a3c\u3067\u304d\u3066\u306a\u3044 => \u8a8d\u8a3c\u3057\u3066\u3082\u3089\u3046\u305f\u3081\u306b\u30ea\u30f3\u30af\u3092\u8868\u793a\n  $scope.showAuthentification = true;\n});\n```\n\n\u307e\u305f\u8a8d\u8a3c\u306f \u5143\u306e\u30a2\u30af\u30bb\u30b9\u3057\u305fGAS\u306eURL \u2192 Google\u306e\u8a8d\u8a3cURL \u2192 \u5143\u306e\u30a2\u30af\u30bb\u30b9\u3057\u305fGAS\u306eURL \u3068\u9077\u79fb\u3059\u308b\u306e\u3067\u3001\nWeb API\u3092\u8868\u793a\u3057\u3066\u3044\u308bGAS\u5074\u3067\u5143\u306eDrive Host Page\u306b\u623b\u308b\u305f\u3081\u306e\u30ea\u30f3\u30af\u3092\u8868\u793a\u3055\u305b\u307e\u3059\u3002\n\n```javascript\nfunction doGet(e) {\n  if(e.parameter.auth) {  //\u8a8d\u8a3c\u6642\u306fauth\u3068\u3044\u3046\u30d1\u30e9\u30e1\u30fc\u30bf\u3092\u4ed8\u3051\u3066\u304a\u304f\n    return HtmlService.createHtmlOutputFromFile(\"index.html\"); //\u8a8d\u8a3c\u5f8c\u306b\u5143\u306eDrive Host Page\u306b\u623b\u3063\u3066\u3082\u3089\u3046\u305f\u3081\u306e\u30ea\u30f3\u30af\u3092\u8868\u793a\u3059\u308b\u753b\u9762\u3092\u8fd4\u5374\u3059\u308b\u3002\n  }\n  \n  //web api\u306e\u51e6\u7406\u304c\u7d9a\u304f\n  ...\n}\n```\n\n\u306a\u304a\u3001Google Apps\u306eGAS\u306e\u5834\u5408\u306f\u300cExecute the app as:\u300d\u3092\u300cme\u300d\u306b\u3057\u3066\u3044\u3066\u3082\u3001GAS\u306e`Session.getActiveUser().getEmail()`\u306f\u30a2\u30af\u30bb\u30b9\u3057\u305f\n\u30e6\u30fc\u30b6\u306e\u30a2\u30c9\u30ec\u30b9\u304c\u8fd4\u5374\u3055\u308c\u308b\u305f\u3081\u3001\u4e0a\u8a18\u306e\u3088\u3046\u306a\u64cd\u4f5c\u306f\u4e0d\u8981\u306b\u306a\u308a\u307e\u3059\u3002\n\n# \u30c7\u30fc\u30bf\u306e\u4fdd\u5b58\n\n\u3053\u3053\u307e\u3067\u6765\u308c\u3070\u30c7\u30fc\u30bf\u306e\u4fdd\u5b58\u306f\u3069\u3053\u306b\u3084\u3063\u3066\u3082\u826f\u3044\u3067\u3059\u3002\n\u4eca\u56de\u306e\u30a2\u30d7\u30ea\u3067\u306f\u8fd4\u5374\u3059\u308bJSON\u3092\u30e9\u30af\u306b\u4f5c\u308b\u305f\u3081\u306b`ScriptDb`\u3092\u5229\u7528\u3057\u3066\u3044\u307e\u3059\u304c\u3001\n\u30b5\u30fc\u30d3\u30b9\u306e\u7a2e\u985e\u306b\u3088\u3063\u3066Spreadsheet\u306b\u3057\u305f\u308a\u3001ScriptProperties\u306b\u3057\u305f\u308a\u3001Fusion Tables\u306b\u3057\u305f\u308a\u3068\u9069\u5207\u306a\u3082\u306e\u306b\u3057\u3066\u4e0b\u3055\u3044\u3002\n\u305f\u3060\u3057\u3001\u300cExecute the app as:\u300d\u3092\u300cUser accessing the web\u300d\u306b\u3057\u3066\u3044\u308b\u305f\u3081\u3001\nSpreadsheet\u3084Fusion Tables\u306e\u5834\u5408\u306f\u30e6\u30fc\u30b6\u81ea\u8eab\u304c\u3001\u305d\u306e\u30d5\u30a1\u30a4\u30eb\u3078\u306e\u30a2\u30af\u30bb\u30b9\u6a29\u9650\u3092\u4fdd\u3064\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\n\nDB\u3092\u516c\u958b\u3057\u305f\u304f\u306a\u3044\u5834\u5408\u306fScriptDb\u3084\u3001ScriptProperties\u306a\u3069Script\u81ea\u4f53\u306b\u30c7\u30fc\u30bf\u304c\u7d10\u3065\u304f\u30b5\u30fc\u30d3\u30b9\u3092\u5229\u7528\u3057\u305f\u307b\u3046\u304c\u826f\u3044\u3067\u3059\u3002\n\nP.S.\nGoogle Drive Host Page\u304c2/6\u306b\u8ffd\u52a0\u3055\u308c\u305f\u3063\u3066\u66f8\u3044\u3066\u3042\u308b\u3093\u3067\u3059\u304c\u4ed5\u7d44\u307f\u7684\u306b\u306f\u6628\u5e74\u3050\u3089\u3044\u306b\u8ffd\u52a0\u3055\u308c\u3066\u3044\u308b\u3093\u3067\u3059\u3088\u306d\n\u306a\u3093\u3067Google\u3082\u6539\u3081\u3066\u767a\u8868\u3057\u305f\u306e\u304b\u82e5\u5e72\u6c17\u306b\u306a\u3063\u305f\u308a\u3057\u307e\u3059\u3002\n\nhttp://googleappsdeveloper.blogspot.jp/2012/11/announcing-google-drive-site-publishing.html?utm_source=feedburner&utm_medium=feed&utm_campaign=Feed:+GoogleAppsDeveloperBlog+(Google+Apps+Developer+Blog)", "tags": ["GoogleAppsScript"]}