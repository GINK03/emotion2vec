{"context": " More than 1 year has passed since last update.\n\nAPI\u306e\u4f5c\u6210\nAPI Gateway\u3067API\u3092\u4f5c\u308b\u3002\naws apigateway create-rest-api --name hello-lambda-clojure\n\n\n\u30ea\u30bd\u30fc\u30b9\u306e\u5b9a\u7fa9\n\u30ea\u30bd\u30fc\u30b9\u306f\u30c4\u30ea\u30fc\u69cb\u9020\u306b\u306a\u3063\u3066\u3044\u308b\u306e\u3067\u3001\u65b0\u3057\u304f\u30ea\u30bd\u30fc\u30b9\u3092\u4f5c\u308b\u306b\u306f\u30eb\u30fc\u30c8\u306e\u30ea\u30bd\u30fc\u30b9ID\u304c\u5fc5\u8981\u3002get-resources\u3092\u4f7f\u3063\u3066\u305d\u306eID\u3092\u78ba\u8a8d\u3059\u308b\u3002\n aws apigateway get-resources --rest-api-id 0a5sxbe4gg\n{\n    \"items\": [\n        {\n            \"path\": \"/\",\n            \"id\": \"8s2bu30t65\"\n        }\n    ]\n}\n\n\u4eca\u56de\u306f/greetings/hello\u306bJSON\u3092POST\u3059\u308b\u3068\u30ec\u30b9\u30dd\u30f3\u30b9\u3092\u8fd4\u3059\u3068\u3044\u3046API\u306b\u3057\u305f\u3044\u306e\u3067\u3001greetings, hello\u3068\u3044\u3046\u30ea\u30bd\u30fc\u30b9\u3092\u4f5c\u6210\u3059\u308b\u3002\n\u307e\u305a/greetings\u3092\u4f5c\u6210\u3002\naws apigateway create-resource --rest-api-id 0a5sxbe4gg --path-part greetings --parent-id 8s2bu30t65\n{\n    \"path\": \"/greetings\",\n    \"pathPart\": \"greetings\",\n    \"id\": \"ckagp3\",\n    \"parentId\": \"8s2bu30t65\"\n}\n\n\u7d9a\u3044\u3066/greetings/hello\u3092\u4f5c\u6210\u3002\naws apigateway create-resource --rest-api-id 0a5sxbe4gg --path-part hello --parent-id ckagp3\n{\n    \"path\": \"/greetings/hello\",\n    \"pathPart\": \"hello\",\n    \"id\": \"is2t79\",\n    \"parentId\": \"ckagp3\"\n}\n\n\n\u30e1\u30bd\u30c3\u30c9\u306e\u5b9a\u7fa9\n\u30e1\u30bd\u30c3\u30c9\u306e\u5b9a\u7fa9\u3092CLI\u3092\u4f7f\u3063\u3066\u3084\u308d\u3046\u3068\u9811\u5f35\u3063\u305f\u3051\u3069\u3001\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u304c\u5c11\u306a\u304f\u305d\u308c\u3063\u307d\u304f\u51fa\u6765\u3066\u3082\u3088\u304f\u5206\u304b\u3089\u306a\u3044\u30a8\u30e9\u30fc\u306b\u306a\u3063\u305f\u306e\u3067\u3001\u8ae6\u3081\u3066AWS\u306eWeb\u30b3\u30f3\u30bd\u30fc\u30eb\u3067\"Create Method\"\u3067\u30e1\u30bd\u30c3\u30c9\u3092\u4f5c\u308a\u3001\"Integration Type\"\u306b\"Lambda Function\"\u3092\u9078\u629e\u3057\u305f\u3002\nLambda Function\u306f\u3053\u3061\u3089\u306e\u8a18\u4e8b\u306b\u66f8\u3044\u305f\u3088\u3046\u306a\u611f\u3058\u3067\u4e88\u3081\u4f5c\u6210\u3057\u3066\u3042\u308a\u307e\u3059\u3002\n\nhttp://qiita.com/csakatoku/items/27bfed3cc87901fa24c7\n\n\u4ee5\u4e0b\u306f\u7d50\u5c40\u3046\u307e\u304f\u3044\u304b\u306a\u304b\u3063\u305f\u4f5c\u696d\u30ed\u30b0\u3002\n\u30e1\u30bd\u30c3\u30c9\u3092\u4f5c\u6210\u3002\naws apigateway put-method --rest-api-id 0a5sxbe4gg --resource-id is2t79 --http-method POST --authorization-type NONE\n{\n    \"apiKeyRequired\": false,\n    \"httpMethod\": \"POST\",\n    \"authorizationType\": \"NONE\"\n}\n\n\u30e1\u30bd\u30c3\u30c9\u306b\u5bfe\u3059\u308bIntegration\u3092\u4f5c\u6210\u3002\naws apigateway put-integration --rest-api-id 0a5sxbe4gg --resource-id is2t79 --http-method POST--type AWS --integration-http-method POST --uri arn:aws:apigateway:ap-northeast-1:lambda:path/2015-03-31/functions/arn:aws:lambda:ap-northeast-1:YOUR_AWS_ACCOUNT_ID:function:hello-lambda/invocations\n\naws apigateway put-method-response --rest-api-id 0a5sxbe4gg --resource-id mdb71c --http-method POST --status-code 200 --response-models '{\"application/json\": \"Empty\"}'\n\naws apigateway put-integration-response --rest-api-id 0a5sxbe4gg --resource-id mdb71c --http-method POST --status-code 200 --response-templates '{\"application/json\": \"\"}'\n\n\n\u30c7\u30d7\u30ed\u30a4\uff06\u30c6\u30b9\u30c8\n\u30b9\u30c6\u30fc\u30b8\u3092\u4f5c\u3063\u3066\u3001\u5b9f\u969b\u306bAPI\u306b\u30a2\u30af\u30bb\u30b9\u3057\u3066\u307f\u308b\u3002\naws apigateway create-deployment --profile development --rest-api-id 0a5sxbe4gg --stage-name sandbox\n\nAPI\u306eURL\u306fhttps://REST-API-ID.execute-api.REGION.amazonaws.com/STAGE\u3068\u3044\u3046URL\u306b\u306a\u308b\u3089\u3057\u3044\u3002\ncurl -H 'Content-Type: application/json' -d '{\"name\": \"Clojure\"}' https://0a5sxbe4gg.execute-api.ap-northeast-1.amazonaws.com/sandbox/greetings/hello\n{\"message\":\"Hello Clojure\"}\n\n\u7121\u4e8b\u306bAWS Lambda\u3068API Gateway\u3092\u4f7f\u3063\u305f\u521d\u3081\u3066\u306eAPI\u3092\u4f5c\u308c\u307e\u3057\u305f\u3002\n## API\u306e\u4f5c\u6210\nAPI Gateway\u3067API\u3092\u4f5c\u308b\u3002\n\n```\naws apigateway create-rest-api --name hello-lambda-clojure\n```\n\n## \u30ea\u30bd\u30fc\u30b9\u306e\u5b9a\u7fa9\n\n\u30ea\u30bd\u30fc\u30b9\u306f\u30c4\u30ea\u30fc\u69cb\u9020\u306b\u306a\u3063\u3066\u3044\u308b\u306e\u3067\u3001\u65b0\u3057\u304f\u30ea\u30bd\u30fc\u30b9\u3092\u4f5c\u308b\u306b\u306f\u30eb\u30fc\u30c8\u306e\u30ea\u30bd\u30fc\u30b9ID\u304c\u5fc5\u8981\u3002`get-resources`\u3092\u4f7f\u3063\u3066\u305d\u306eID\u3092\u78ba\u8a8d\u3059\u308b\u3002\n\n```\n aws apigateway get-resources --rest-api-id 0a5sxbe4gg\n{\n    \"items\": [\n        {\n            \"path\": \"/\",\n            \"id\": \"8s2bu30t65\"\n        }\n    ]\n}\n```\n\n\u4eca\u56de\u306f`/greetings/hello`\u306bJSON\u3092POST\u3059\u308b\u3068\u30ec\u30b9\u30dd\u30f3\u30b9\u3092\u8fd4\u3059\u3068\u3044\u3046API\u306b\u3057\u305f\u3044\u306e\u3067\u3001`greetings`, `hello`\u3068\u3044\u3046\u30ea\u30bd\u30fc\u30b9\u3092\u4f5c\u6210\u3059\u308b\u3002\n\n\u307e\u305a`/greetings`\u3092\u4f5c\u6210\u3002\n\n```\naws apigateway create-resource --rest-api-id 0a5sxbe4gg --path-part greetings --parent-id 8s2bu30t65\n{\n    \"path\": \"/greetings\",\n    \"pathPart\": \"greetings\",\n    \"id\": \"ckagp3\",\n    \"parentId\": \"8s2bu30t65\"\n}\n```\n\n\u7d9a\u3044\u3066`/greetings/hello`\u3092\u4f5c\u6210\u3002\n\n```\naws apigateway create-resource --rest-api-id 0a5sxbe4gg --path-part hello --parent-id ckagp3\n{\n    \"path\": \"/greetings/hello\",\n    \"pathPart\": \"hello\",\n    \"id\": \"is2t79\",\n    \"parentId\": \"ckagp3\"\n}\n```\n\n## \u30e1\u30bd\u30c3\u30c9\u306e\u5b9a\u7fa9\n\u30e1\u30bd\u30c3\u30c9\u306e\u5b9a\u7fa9\u3092CLI\u3092\u4f7f\u3063\u3066\u3084\u308d\u3046\u3068\u9811\u5f35\u3063\u305f\u3051\u3069\u3001\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u304c\u5c11\u306a\u304f\u305d\u308c\u3063\u307d\u304f\u51fa\u6765\u3066\u3082\u3088\u304f\u5206\u304b\u3089\u306a\u3044\u30a8\u30e9\u30fc\u306b\u306a\u3063\u305f\u306e\u3067\u3001\u8ae6\u3081\u3066AWS\u306eWeb\u30b3\u30f3\u30bd\u30fc\u30eb\u3067\"Create Method\"\u3067\u30e1\u30bd\u30c3\u30c9\u3092\u4f5c\u308a\u3001\"Integration Type\"\u306b\"Lambda Function\"\u3092\u9078\u629e\u3057\u305f\u3002\n\nLambda Function\u306f[\u3053\u3061\u3089\u306e\u8a18\u4e8b](http://qiita.com/csakatoku/items/27bfed3cc87901fa24c7)\u306b\u66f8\u3044\u305f\u3088\u3046\u306a\u611f\u3058\u3067\u4e88\u3081\u4f5c\u6210\u3057\u3066\u3042\u308a\u307e\u3059\u3002\n\n- http://qiita.com/csakatoku/items/27bfed3cc87901fa24c7\n\n\u4ee5\u4e0b\u306f\u7d50\u5c40\u3046\u307e\u304f\u3044\u304b\u306a\u304b\u3063\u305f\u4f5c\u696d\u30ed\u30b0\u3002\n\n\u30e1\u30bd\u30c3\u30c9\u3092\u4f5c\u6210\u3002\n\n```\naws apigateway put-method --rest-api-id 0a5sxbe4gg --resource-id is2t79 --http-method POST --authorization-type NONE\n{\n    \"apiKeyRequired\": false,\n    \"httpMethod\": \"POST\",\n    \"authorizationType\": \"NONE\"\n}\n```\n\n\u30e1\u30bd\u30c3\u30c9\u306b\u5bfe\u3059\u308bIntegration\u3092\u4f5c\u6210\u3002\n\n```\naws apigateway put-integration --rest-api-id 0a5sxbe4gg --resource-id is2t79 --http-method POST--type AWS --integration-http-method POST --uri arn:aws:apigateway:ap-northeast-1:lambda:path/2015-03-31/functions/arn:aws:lambda:ap-northeast-1:YOUR_AWS_ACCOUNT_ID:function:hello-lambda/invocations\n```\n\n```\naws apigateway put-method-response --rest-api-id 0a5sxbe4gg --resource-id mdb71c --http-method POST --status-code 200 --response-models '{\"application/json\": \"Empty\"}'\n```\n\n```\naws apigateway put-integration-response --rest-api-id 0a5sxbe4gg --resource-id mdb71c --http-method POST --status-code 200 --response-templates '{\"application/json\": \"\"}'\n```\n\n## \u30c7\u30d7\u30ed\u30a4\uff06\u30c6\u30b9\u30c8\n\u30b9\u30c6\u30fc\u30b8\u3092\u4f5c\u3063\u3066\u3001\u5b9f\u969b\u306bAPI\u306b\u30a2\u30af\u30bb\u30b9\u3057\u3066\u307f\u308b\u3002\n\n```\naws apigateway create-deployment --profile development --rest-api-id 0a5sxbe4gg --stage-name sandbox\n```\n\nAPI\u306eURL\u306f`https://REST-API-ID.execute-api.REGION.amazonaws.com/STAGE`\u3068\u3044\u3046URL\u306b\u306a\u308b\u3089\u3057\u3044\u3002\n\n```\ncurl -H 'Content-Type: application/json' -d '{\"name\": \"Clojure\"}' https://0a5sxbe4gg.execute-api.ap-northeast-1.amazonaws.com/sandbox/greetings/hello\n{\"message\":\"Hello Clojure\"}\n```\n\n\u7121\u4e8b\u306bAWS Lambda\u3068API Gateway\u3092\u4f7f\u3063\u305f\u521d\u3081\u3066\u306eAPI\u3092\u4f5c\u308c\u307e\u3057\u305f\u3002\n", "tags": ["Clojure", "lambda"]}