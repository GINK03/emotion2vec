{"context": "\u30e1\u30e2\u3067\u3059\u3002\nAndroid\u306eHID over GATT\u306e\u5b9f\u88c5\u3092\u7406\u89e3\u3059\u308b\u305f\u3081\u306b\u3001Android 4.4 KitKat \u306b HID over GATT (HOGP)\u304c\u8ffd\u52a0\u3055\u308c\u305f\u3068\u304d\u306ecommit\u3092\u63a2\u3057\u3066\u307f\u307e\u3057\u305f\u3002\nexternal/bluetooth/bluedroid \u3068 frameworks/base \u3068 packages/apps/Settings \u306b\u5909\u66f4\u304c\u3042\u308a\u307e\u3057\u305f\u3002\n\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u306fbroadcom\u306e\u4eba\u304c\u66f8\u3044\u3066\u307e\u3057\u305f\u3002\n\nexternal/bluetooth/bluedroid\n\nhttps://android.googlesource.com/platform/external/bluetooth/bluedroid/+/2e7fa68bfd9723b7ec7b6b0b128d89f31a2e06ee\n\nLE: Add support for the HID-over-GATT profile (1/3)\n\n\nbluetooth\u30d7\u30ed\u30c8\u30b3\u30eb\u30b9\u30bf\u30c3\u30af\u3092\u8272\u3005\u3068\u4fee\u6b63\u3002 \nHID over GATT \u306e\u305f\u3081\u306b\u3001Device Information Service \u3068 Battery Service \u306e Central\u5074\u3092\u8ffd\u52a0\u3002\n\n\n\u8ffd\u52a0\u3055\u308c\u305f\u5185\u90e8API\n\nbta_hh_api.h\n\nBTA_HhUpdateLeScanParam()\n\n\nUpdate the scan paramteters if connected to a LE hid device as report host.\nBTA_HH_API_SCPP_UPDATE_EVT\u3092\u4e0b\u4f4d\u306b\u901a\u77e5\n\n\n\n\nhidh_api.h\n\nhid_known_hid_device()\n\n\nThis function checks if this device is  of type HID Device\n\n\n\n\nsrvc_api.h\n\nsrvc_eng_init() \n\n\nInitializa the GATT Service engine, register a GATT application as for a central service management.\nGATT_Register()\u3067\u30b5\u30fc\u30d3\u30b9\u3092\u767b\u9332\n\n\nDIS_SrInit()\n\n\n  Initializa the Device Information Service Server.\n  \u3069\u3053\u304b\u3089\u3082\u547c\u3070\u308c\u3066\u3044\u306a\u3044\n\n\nDIS_SrUpdate()\n\n\n Update the DIS server attribute values\n  \u3069\u3053\u304b\u3089\u3082\u547c\u3070\u308c\u3066\u3044\u306a\u3044\n\n\nDIS_ReadDISInfo()\n\n\n Read remote device DIS information.\n dis_gatt_c_read_dis_req()\u3067\u8aad\u3080\n\n\nBattery_Instantiate()\n\n\n Instantiate a Battery service\n GATTS_CreateService\uff08\uff09\n GATTS_AddCharDescriptor()\n GATTS_StartService()\n\n\nBattery_Rsp()\n\n\n Respond to a battery service request\n \u5f15\u6570event\u306b\u5fdc\u3058\u3066\u3001srvc_sr_rsp()\u3067\u5fdc\u7b54\u3059\u308b\n\n\nBattery_Notify()\n\n\n Send battery level notification\n srvc_sr_notify()\n\n\n\n\nsrvc_batter_int.h\n\nbattery_valid_handle_range()\n\n\nvalidate a handle to be a battery attribute handle or not.\n\n\nbattery_s_write_attr_value()\n\n\nProcess write DIS attribute request.\n\n\nbattery_s_read_attr_value()\n\n\nProcess read attribute request.\n\n\n\n\nsrvc_dis_int.h\n\ndis_valid_handle_range()\n\n\nvalidate a handle to be a DIS attribute handle or not.\n\n\ndis_read_attr_value()\n\n\nProcess read DIS attribute request.\n\n\ndis_write_attr_value()\n\n\nProcess write DIS attribute request.\n\n\ndis_c_cmpl_cback()\n\n\nClient read DIS database complete callback.\n\n\n\n\nsrvc_eng_int.h\n\nsrvc_eng_find_clcb_by_conn_id()\n\n\nThe function searches all LCBs with macthing connection ID.\n\n\nsrvc_eng_find_clcb_by_bd_addr()\n\n\nThe function searches all LCBs with macthing bd address.\n\n\nsrvc_eng_find_conn_id_by_bd_addr()\n\n\nThe function searches all LCB with macthing bd address\n\n\nsrvc_eng_release_channel()\n\n\nClient operation complete callback.\n\n\nsrvc_eng_request_channel()\n\n\nClient operation complete callback.\n\n\nsrvc_sr_rsp()\n\n\nsever response\n\n\nsrvc_sr_notify()\n\n\nsend notification\n\n\n\n\nframeworks/base\n\nhttps://android.googlesource.com/platform/frameworks/base/+/c60bed487e8bfa98702104cfb8d1287dbc2e82f3\n\nLE: Add support for the HID-over-GATT profile (2/3)\n\n\nHogp\u306eUUID\u3092\u8ffd\u52a0\n\n\npackages/apps/Settings\n\nhttps://android.googlesource.com/platform/packages/apps/Settings/+/79f3384eaa10d45270cb2f61a1314746da0e52ce\n\nLE: Add support for the HID-over-GATT profile (3/3)\n\n\nSettings\u306bHogp\u306eUUID\u3092\u30c1\u30a7\u30c3\u30af\u3059\u308b\u51e6\u7406\u3092\u8ffd\u52a0\u3057\u3001HOGP\u306e\u30c7\u30d0\u30a4\u30b9\u3092\u9078\u3079\u308b\u3088\u3046\u306b\u3057\u305f\u3002\n\n\u30e1\u30e2\u3067\u3059\u3002\n\nAndroid\u306eHID over GATT\u306e\u5b9f\u88c5\u3092\u7406\u89e3\u3059\u308b\u305f\u3081\u306b\u3001Android 4.4 KitKat \u306b HID over GATT (HOGP)\u304c\u8ffd\u52a0\u3055\u308c\u305f\u3068\u304d\u306ecommit\u3092\u63a2\u3057\u3066\u307f\u307e\u3057\u305f\u3002\n\nexternal/bluetooth/bluedroid \u3068 frameworks/base \u3068 packages/apps/Settings \u306b\u5909\u66f4\u304c\u3042\u308a\u307e\u3057\u305f\u3002\n\n\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u306fbroadcom\u306e\u4eba\u304c\u66f8\u3044\u3066\u307e\u3057\u305f\u3002\n\n# external/bluetooth/bluedroid\n* https://android.googlesource.com/platform/external/bluetooth/bluedroid/+/2e7fa68bfd9723b7ec7b6b0b128d89f31a2e06ee\n\n```\nLE: Add support for the HID-over-GATT profile (1/3)\n```\n\n* bluetooth\u30d7\u30ed\u30c8\u30b3\u30eb\u30b9\u30bf\u30c3\u30af\u3092\u8272\u3005\u3068\u4fee\u6b63\u3002 \n* HID over GATT \u306e\u305f\u3081\u306b\u3001Device Information Service \u3068 Battery Service \u306e Central\u5074\u3092\u8ffd\u52a0\u3002\n\n## \u8ffd\u52a0\u3055\u308c\u305f\u5185\u90e8API\n\n### bta_hh_api.h\n* BTA_HhUpdateLeScanParam()\n    * Update the scan paramteters if connected to a LE hid device as report host.\n    * BTA_HH_API_SCPP_UPDATE_EVT\u3092\u4e0b\u4f4d\u306b\u901a\u77e5\n\n### hidh_api.h\n* hid_known_hid_device()\n    * This function checks if this device is  of type HID Device\n\n### srvc_api.h\n* srvc_eng_init() \n    * Initializa the GATT Service engine, register a GATT application as for a central service management.\n    * GATT_Register()\u3067\u30b5\u30fc\u30d3\u30b9\u3092\u767b\u9332\n* DIS_SrInit()\n    *   Initializa the Device Information Service Server.\n    *   \u3069\u3053\u304b\u3089\u3082\u547c\u3070\u308c\u3066\u3044\u306a\u3044\n* DIS_SrUpdate()\n    *  Update the DIS server attribute values\n    *   \u3069\u3053\u304b\u3089\u3082\u547c\u3070\u308c\u3066\u3044\u306a\u3044\n* DIS_ReadDISInfo()\n    *  Read remote device DIS information.\n    *  dis_gatt_c_read_dis_req()\u3067\u8aad\u3080\n* Battery_Instantiate()\n    *  Instantiate a Battery service\n    *  GATTS_CreateService\uff08\uff09\n    *  GATTS_AddCharDescriptor()\n    *  GATTS_StartService()\n* Battery_Rsp()\n    *  Respond to a battery service request\n    *  \u5f15\u6570event\u306b\u5fdc\u3058\u3066\u3001srvc_sr_rsp()\u3067\u5fdc\u7b54\u3059\u308b\n* Battery_Notify()\n    *  Send battery level notification\n    *  srvc_sr_notify()\n\n### srvc_batter_int.h\n* battery_valid_handle_range()\n    * validate a handle to be a battery attribute handle or not.\n* battery_s_write_attr_value()\n    * Process write DIS attribute request.\n* battery_s_read_attr_value()\n    * Process read attribute request.\n\n### srvc_dis_int.h\n* dis_valid_handle_range()\n    * validate a handle to be a DIS attribute handle or not.\n* dis_read_attr_value()\n    * Process read DIS attribute request.\n* dis_write_attr_value()\n    * Process write DIS attribute request.\n* dis_c_cmpl_cback()\n    * Client read DIS database complete callback.\n\n### srvc_eng_int.h\n* srvc_eng_find_clcb_by_conn_id()\n    * The function searches all LCBs with macthing connection ID.\n* srvc_eng_find_clcb_by_bd_addr()\n    * The function searches all LCBs with macthing bd address.\n* srvc_eng_find_conn_id_by_bd_addr()\n    * The function searches all LCB with macthing bd address\n* srvc_eng_release_channel()\n    * Client operation complete callback.\n* srvc_eng_request_channel()\n    * Client operation complete callback.\n* srvc_sr_rsp()\n    * sever response\n* srvc_sr_notify()\n    * send notification\n\n\n# frameworks/base\n* https://android.googlesource.com/platform/frameworks/base/+/c60bed487e8bfa98702104cfb8d1287dbc2e82f3\n\n```\nLE: Add support for the HID-over-GATT profile (2/3)\n```\n* Hogp\u306eUUID\u3092\u8ffd\u52a0\n\n# packages/apps/Settings\n* https://android.googlesource.com/platform/packages/apps/Settings/+/79f3384eaa10d45270cb2f61a1314746da0e52ce\n\n```\nLE: Add support for the HID-over-GATT profile (3/3)\n```\n\n* Settings\u306bHogp\u306eUUID\u3092\u30c1\u30a7\u30c3\u30af\u3059\u308b\u51e6\u7406\u3092\u8ffd\u52a0\u3057\u3001HOGP\u306e\u30c7\u30d0\u30a4\u30b9\u3092\u9078\u3079\u308b\u3088\u3046\u306b\u3057\u305f\u3002\n\n\n\n", "tags": ["Android", "bluetooth"]}