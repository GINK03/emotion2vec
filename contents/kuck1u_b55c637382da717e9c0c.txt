{"context": " More than 1 year has passed since last update.\u304a\u540d\u524d.com \u306e VPS \u306e \u30e1\u30e2\u30ea 2G \u30d7\u30e9\u30f3 \u306b\u6a19\u6e96 OS \u306e CentOS 6.5 \u3092\u4f7f\u3063\u3066\u30b5\u30fc\u30d0\u30fc\u306e\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\u3092\u3057\u3066\u3044\u307e\u3059\u3002\n\u30a4\u30f3\u30d5\u30e9\u521d\u5fc3\u8005\u304c\u7e8f\u3081\u3066\u3044\u308b\u305f\u3081\u3001\u4fe1\u7528\u3057\u306a\u3044\u3067\u304f\u3060\u3055\u3044\uff08\u7b11\uff09\n\u3053\u306e\u8a18\u4e8b\u3092\u53c2\u8003\u306b\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\u3057\u305f\u3053\u3068\u306b\u3088\u3063\u3066\u88ab\u3063\u305f\u640d\u5bb3\u30fb\u640d\u5931\u306b\u5bfe\u3057\u3001\u3044\u304b\u306a\u308b\u5834\u5408\u3067\u3082\u4e00\u5207\u306e\u8cac\u4efb\u3092\u8ca0\u3044\u307e\u305b\u3093\u306e\u3067\u3054\u4e86\u627f\u304f\u3060\u3055\u3044\u3002\u3042\u304f\u307e\u3067\u3082\u81ea\u5df1\u8cac\u4efb\u3067\u304a\u9858\u3044\u3057\u307e\u3059\u3002\n\u30c4\u30c3\u30b3\u30df\u3084\u30a2\u30c9\u30d0\u30a4\u30b9\u3001\u30b3\u30e1\u30f3\u30c8\u3067\u304a\u5f85\u3061\u3057\u3066\u3044\u307e\u3059 !\n\nCentOS \u306e\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\n\n\u30a2\u30c3\u30d7\u30c7\u30fc\u30c8\n$ yum clean all && \\\nyum -y update && \\\nyum clean all && \\\nyum -y upgrade && \\\nyum clean all && \\\ncat /etc/redhat-release\n\n\n\u65e5\u672c\u8a9e\u306b\u5bfe\u5fdc\n\u8a00\u8a9e\u30d1\u30c3\u30b1\u30fc\u30b8\u3092\u30b0\u30eb\u30fc\u30d7\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3002\n$ yum -y groupinstall \"Japanese Support\"\n\n\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3092\u7de8\u96c6\u3002\n$ vi /etc/sysconfig/i18n\n\n\u4e0b\u8a18\u306e\u3088\u3046\u306b\u5909\u66f4\u3002\nLANG=\"ja_JP.UTF-8\"\nSUPPORTED=\"ja_JP.UTF-8:ja_JP:ja\"\nSYSFONT=\"latarcyrheb-sun16\"\n\n\u8a2d\u5b9a\u3092\u53cd\u6620\u3055\u305b\u308b\u3002\n$ source /etc/sysconfig/i18n\n\n\nvim \u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n$ sudo yum -y install vim-enhanced && \\\nsudo mv /bin/vi /bin/vim-tiny && \\\nsudo ln -s /usr/bin/vim /bin/vi\n\n\n\u30a8\u30a4\u30ea\u30a2\u30b9\u3092\u8ffd\u52a0\n$ vi /etc/bashrc\n# alias\nalias vi='vim'\n\n$ source /etc/bashrc\n\n\n\u884c\u756a\u53f7\u3092\u8868\u793a\n$ vi /etc/vimrc\n\n\u4e0b\u8a18\u3092\u8ffd\u52a0\u3002\nset number\n\n/etc/vimrc \u306f\u30b7\u30b9\u30c6\u30e0\u8a2d\u5b9a\u306a\u306e\u3067\u3001\u884c\u756a\u53f7\u3092\u8868\u793a\u3092\u8ffd\u52a0\u304f\u3089\u3044\u306b\u7559\u3081\u3066\u304a\u304f\u306e\u304c\u3088\u3044\u3002\n\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u306e\u5834\u6240\u306f\u3001\u4ee5\u4e0b\u306e\u901a\u308a\u3002\n   \u30b7\u30b9\u30c6\u30e0 vimrc: \"/etc/vimrc\"\n\u3000   \u30e6\u30fc\u30b6 vimrc: \"$HOME/.vimrc\"\n\u7b2c 2 \u30e6\u30fc\u30b6 vimrc: \"~/.vim/vimrc\"\n\u3000    \u30e6\u30fc\u30b6 exrc: \"$HOME/.exrc\"\n\n\nNginx \u30d5\u30a1\u30a4\u30eb\u3092 Syntaxhighlight \u3059\u308b\u3088\u3046\u306b\u3059\u308b\nnginx.vim \u30d5\u30a1\u30a4\u30eb\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3057\u3001\u30d5\u30a1\u30a4\u30eb\u30bf\u30a4\u30d7\u3092\u8ffd\u52a0\u3059\u308b\u3002\n$ sudo mkdir -p ~/.vim/syntax && \\\ncd ~/.vim/syntax && \\\nsudo wget https://raw.githubusercontent.com/evanmiller/nginx-vim-syntax/master/syntax/nginx.vim && \\\nvi ~/.vim/filetype.vim\n\n\u4e0b\u8a18\u3092\u30da\u30fc\u30b9\u30c8\u3002\nau BufRead,BufNewFile /etc/nginx/*,/etc/nginx_old/*,/usr/local/nginx/conf/* if &ft == '' | setfiletype nginx | endif\n\n\n\u4f5c\u696d\u7528\u30e6\u30fc\u30b6\u30fc\u3092\u4f5c\u6210\n$ useradd exampleuser && \\\npasswd exampleuser && \\\nusermod -G wheel exampleuser && \\\nid exampleuser\n\n\n\u4f5c\u696d\u7528\u30e6\u30fc\u30b6\u30fc\u306e\u516c\u958b\u9375\u30d5\u30a1\u30a4\u30eb\u306e\u4f5c\u6210\n\u30ed\u30fc\u30ab\u30eb PC \u3067\u3001\u79d8\u5bc6\u9375\u3068\u516c\u958b\u9375\u306e\u30da\u30a2\u30ad\u30fc\u3092\u4f5c\u6210\u3002\n\u203b conoha \u306e\u90e8\u5206\u306f\u9069\u5f53\u306b\u8aad\u307f\u66ff\u3048\u3066\u304f\u3060\u3055\u3044\u3002\n# \u79d8\u5bc6\u9375\u3092\u751f\u6210\n$ openssl genrsa -des3 -out ~/.ssh/conoha_rsa 2048\n\n# \u30d1\u30fc\u30df\u30c3\u30b7\u30e7\u30f3\u306e\u5909\u66f4\n$ chmod 600 ~/.ssh/conoha_rsa\n\n# \u516c\u958b\u9375\u3092\u751f\u6210\n$ ssh-keygen -y -f ~/.ssh/conoha_rsa > ~/.ssh/conoha_rsa.pub\n\n# \u9375\u3092\u767b\u9332\u3059\u308b\n$ ssh-add -K ~/.ssh/conoha_rsa\n\n# \u516c\u958b\u9375\u3092\u30af\u30ea\u30c3\u30d7\u30dc\u30fc\u30c9\u306b\u30b3\u30d4\u30fc\n$ pbcopy < ~/.ssh/conoha_rsa.pub\n\n\n\u30ea\u30e2\u30fc\u30c8\u30b5\u30fc\u30d0\u30fc\u306b\u516c\u958b\u9375\u3092\u8a2d\u7f6e\n$ sudo mkdir -p /home/exampleuser/.ssh/ && \\\nsudo vi /home/exampleuser/.ssh/authorized_keys\n\n\u3053\u3053\u3067\u3001\u5148\u307b\u3069\u30af\u30ea\u30c3\u30d7\u30dc\u30fc\u30c9\u306b\u30b3\u30d4\u30fc\u3057\u305f\u516c\u958b\u9375\u3092\u30da\u30fc\u30b9\u30c8\u3057\u4fdd\u5b58\u3002\n\u4fdd\u5b58\u5f8c\u3001.ssh \u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3001authorized_keys \u306e\u6240\u6709\u6a29\u3084\u30a2\u30af\u30bb\u30b9\u6a29\u3092\u5909\u3048\u308b\u3002\n$ sudo chown exampleuser:exampleuser /home/exampleuser/.ssh/ && \\\nsudo chmod 700 /home/exampleuser/.ssh/ && \\\nsudo chown exampleuser:exampleuser /home/exampleuser/.ssh/authorized_keys && \\\nsudo chmod 400 /home/exampleuser/.ssh/authorized_keys\n\n\nwheel \u30b0\u30eb\u30fc\u30d7\u306e\u30e1\u30f3\u30d0\u30fc\u306e\u307f root \u306b\u306a\u308c\u308b\u3088\u3046\u306b\u3059\u308b\n$ vi /etc/pam.d/su\nauth required pam_wheel.so use_uid <- \u30b3\u30e1\u30f3\u30c8\u30a2\u30a6\u30c8\u3092\u5916\u3059\n\n$ vi /etc/login.defs\nSU_WHEEL_ONLY yes                  <-\u6700\u5f8c\u306e\u884c\u306b\u8ffd\u52a0\n\n\nsudo \u30b3\u30de\u30f3\u30c9\u306e\u8a2d\u5b9a\n$ visudo\n# %wheel ALL=(ALL) ALL            <- sudo \u30b3\u30de\u30f3\u30c9\u306b\u30d1\u30b9\u30ef\u30fc\u30c9\u3092\u5fc5\u8981\u3068\u3059\u308b\u5834\u5408 # \u3092\u5916\u3059\n# %wheel ALL=(ALL) NOPASSWD: ALL  <- sudo \u30b3\u30de\u30f3\u30c9\u306b\u30d1\u30b9\u30ef\u30fc\u30c9\u3092\u5fc5\u8981\u3068\u3057\u306a\u3044\u5834\u5408 # \u3092\u5916\u3059\n\n\n\u30ed\u30b0\u30a4\u30f3\u8a8d\u8a3c\u306e\u65b9\u6cd5\u3068 SSH \u30dd\u30fc\u30c8\u756a\u53f7\u3092\u5909\u66f4\n$ vi /etc/ssh/sshd_config\nPort 10022                               <- SSH \u306e\u30dd\u30fc\u30c8\u756a\u53f7\u3092\u5909\u66f4\nProtocol 2                               <- SSH \u306e\u30d7\u30ed\u30c8\u30b3\u30eb\u3092 SSH2 \u306e\u307f\u306b\u3059\u308b\nPermitRootLogin no                       <- root \u3067\u306e\u30ed\u30b0\u30a4\u30f3\u3092\u62d2\u5426\nPubkeyAuthentication yes                 <- \u516c\u958b\u9375\u3067\u306e\u8a8d\u8a3c\u3092\u8a31\u53ef\nAuthorizedKeysFile .ssh/authorized_keys  <- \u516c\u958b\u9375\u306e\u8a2d\u7f6e\u5834\u6240\u3092\u30e6\u30fc\u30b6\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u914d\u4e0b\u306e .ssh/authorized_keys \u306b\u5909\u66f4\nIgnoreUserKnownHosts yes                 <- /etc/ssh_known_hosts \u307e\u305f\u306f ~/.ssh/known_hosts \u3092\u7121\u8996\nPermitEmptyPasswords on                  <- \u30d1\u30b9\u30ef\u30fc\u30c9\u304c\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u306a\u3044\u30a2\u30ab\u30a6\u30f3\u30c8\u3092\u62d2\u5426\nPasswordAuthentication on                <- \u30d1\u30b9\u30ef\u30fc\u30c9\u8a8d\u8a3c\u3092\u62d2\u5426\nAllowUsers exampleuser                   <- \u30ed\u30b0\u30a4\u30f3\u8a31\u53ef\u3059\u308b\u30e6\u30fc\u30b6\u30fc\n\n\u8a2d\u5b9a\u3092\u53cd\u6620\u3055\u305b\u308b\u3002\n$ service sshd restart\n\n\n\u30d5\u30a1\u30a4\u30e4\u30fc\u30a6\u30a9\u30fc\u30eb\u306e\u8a2d\u5b9a\uff08\u30dd\u30fc\u30c8\u756a\u53f7\u306e\u5909\u66f4\uff09\niptables \u304c\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u3066\u3044\u308b\u304b\u78ba\u8a8d\u3059\u308b\u3002\n$ rpm -qa iptables\n\u30d0\u30fc\u30b8\u30e7\u30f3\u60c5\u5831\u304c\u8868\u793a\u3055\u308c\u308c\u3070\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u3066\u3044\u308b\n\niptables \u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\u3002\n$ yum -y install iptables iptables-ipv6\n\n\niptables \u306e\u8a2d\u5b9a\n$ vi /etc/sysconfig/iptables\n$ VGd\n\n\u4e0b\u8a18\u3092\u30da\u30fc\u30b9\u30c8\u3002\n*filter\n:INPUT   ACCEPT [0:0]\n:FORWARD ACCEPT [0:0]\n:OUTPUT  ACCEPT [0:0]\n:RH-Firewall-1-INPUT - [0:0]\n\n-A INPUT -j RH-Firewall-1-INPUT\n-A FORWARD -j RH-Firewall-1-INPUT\n-A RH-Firewall-1-INPUT -i lo -j ACCEPT\n-A RH-Firewall-1-INPUT -p icmp --icmp-type any -j ACCEPT\n-A RH-Firewall-1-INPUT -p 50 -j ACCEPT\n-A RH-Firewall-1-INPUT -p 51 -j ACCEPT\n-A RH-Firewall-1-INPUT -p udp --dport 5353 -d 224.0.0.251 -j ACCEPT\n-A RH-Firewall-1-INPUT -p udp -m udp --dport 631 -j ACCEPT\n-A RH-Firewall-1-INPUT -p tcp -m tcp --dport 631 -j ACCEPT\n-A RH-Firewall-1-INPUT -m state --state ESTABLISHED,RELATED -j ACCEPT\n\n# SSH, HTTP, SSL\n-A RH-Firewall-1-INPUT -m state --state NEW -m tcp -p tcp --dport 10022 -j ACCEPT\n-A RH-Firewall-1-INPUT -m state --state NEW -m tcp -p tcp --dport 80    -j ACCEPT\n-A RH-Firewall-1-INPUT -m state --state NEW -m tcp -p tcp --dport 443   -j ACCEPT\n\n-A RH-Firewall-1-INPUT -j REJECT --reject-with icmp-host-prohibited\n\nCOMMIT\n\n\u8a2d\u5b9a\u3092\u53cd\u6620\u3055\u305b\u308b\u3002\n$ service iptables restart\n\n\nip6tables \u306e\u8a2d\u5b9a\n$ vi /etc/sysconfig/ip6tables\n$ VGd\n\n\u4e0b\u8a18\u3092\u30da\u30fc\u30b9\u30c8\u3002\n*filter :INPUT ACCEPT [0:0]\n:FORWARD ACCEPT [0:0]\n:OUTPUT ACCEPT [0:0]\n:RH-Firewall-1-INPUT - [0:0]\n\n-A INPUT -j RH-Firewall-1-INPUT\n-A FORWARD -j RH-Firewall-1-INPUT\n-A RH-Firewall-1-INPUT -i lo -j ACCEPT\n-A RH-Firewall-1-INPUT -p icmpv6 -j ACCEPT\n-A RH-Firewall-1-INPUT -p 50 -j ACCEPT\n-A RH-Firewall-1-INPUT -p tcp -m tcp --dport 51 -j ACCEPT\n-A RH-Firewall-1-INPUT -p udp -m udp --dport 51 -j ACCEPT\n-A RH-Firewall-1-INPUT -p udp --dport 5353 -d ff02::fb -j ACCEPT\n-A RH-Firewall-1-INPUT -p udp -m udp --dport 631 -j ACCEPT\n-A RH-Firewall-1-INPUT -p tcp -m tcp --dport 631 -j ACCEPT\n-A RH-Firewall-1-INPUT -m state --state ESTABLISHED,RELATED -j ACCEPT\n\n# SSH, HTTP, SSL\n-A RH-Firewall-1-INPUT -m state --state NEW -m tcp -p tcp --dport 10022 -j ACCEPT\n-A RH-Firewall-1-INPUT -m state --state NEW -m tcp -p tcp --dport 80    -j ACCEPT\n-A RH-Firewall-1-INPUT -m state --state NEW -m tcp -p tcp --dport 443   -j ACCEPT\n-A RH-Firewall-1-INPUT -m state --state NEW -m udp -p udp --dport 546 --sport 547 -s fe80::/10 -d fe80::/10 -j ACCEPT\n\n-A RH-Firewall-1-INPUT -j REJECT --reject-with icmp6-adm-prohibited\n\nCOMMIT\n\n\u8a2d\u5b9a\u3092\u53cd\u6620\u3055\u305b\u308b\u3002\n$ service ip6tables restart\n\n\n\u65b0\u3057\u304f\u4f5c\u6210\u3057\u305f\u30e6\u30fc\u30b6\u30fc\u3067\u30b5\u30fc\u30d0\u30fc\u306b\u30ed\u30b0\u30a4\u30f3\u3067\u304d\u308b\u304b\u78ba\u8a8d\n\u3053\u306e\u4f5c\u696d\u6642\u306f\u3001\u30ed\u30b0\u30a4\u30f3\u4e2d\u306e root \u30e6\u30fc\u30b6\u30fc\u306f\u7d76\u5bfe\u306b\u30ed\u30b0\u30a2\u30a6\u30c8\u3055\u305b\u306a\u3044\u3053\u3068\u3002\n\u30ed\u30b0\u30a2\u30a6\u30c8\u3057\u3066\u3057\u307e\u3046\u3068\u3001\u4eca\u307e\u3067\u306e\u8a2d\u5b9a\u306b\u8aa4\u308a\u304c\u3042\u3063\u305f\u5834\u5408\u306b\u53d6\u308a\u8fd4\u3057\u304c\u3064\u304b\u306a\u304f\u306a\u308b\u3002\n\nssh or sftp \u30ed\u30b0\u30a4\u30f3\u304c\u3067\u304d\u308b\nsu or sudo \u30b3\u30de\u30f3\u30c9\u304c\u4f7f\u7528\u3067\u304d\u308b\n\n\u4e0a\u8a18 2 \u70b9\u3092\u78ba\u8a8d\u3059\u308b\u3002\n\u5931\u6557\u3059\u308b\u5834\u5408\u306f\u8a2d\u5b9a\u304c\u9593\u9055\u3063\u3066\u3044\u308b\u3002\n2 \u70b9\u306e\u78ba\u8a8d\u304c\u6210\u529f\u3057\u305f\u5834\u5408\u3001\u30ed\u30b0\u30a4\u30f3\u4e2d\u3060\u3063\u305f root \u30e6\u30fc\u30b6\u30fc\u3092\u30ed\u30b0\u30a2\u30a6\u30c8\u3055\u305b\nroot \u30e6\u30fc\u30b6\u30fc\u3067\u30ed\u30b0\u30a4\u30f3\u3067\u304d\u306a\u3044\u4e8b\u3092\u78ba\u8a8d\u3059\u308b\u3002\n\u4ee5\u964d\u306e\u4f5c\u696d\u306f\u65b0\u898f\u306b\u4f5c\u6210\u3057\u305f\u30e6\u30fc\u30b6\u30fc\u3067\u4f5c\u696d\u3092\u884c\u3046\u3002\n\n\u4e0d\u8981\u306a\u30c7\u30fc\u30e2\u30f3\u3092\u505c\u6b62\n\u4e0b\u8a18\u30b3\u30de\u30f3\u30c9\u3067\u8d77\u52d5\u4e2d\u306e\u30c7\u30fc\u30e2\u30f3\u3092\u78ba\u8a8d\u3057\u4e0d\u8981\u306a\u30b5\u30fc\u30d3\u30b9\u3092\u505c\u6b62\u3055\u305b\u308b\u3002\n$ chkconfig --list | grep 3:on\n\nacpid\n\u30db\u30b9\u30c8\u5074\u304b\u3089\u30b7\u30e3\u30c3\u30c8\u30c0\u30a6\u30f3\u3067\u304d\u306a\u304f\u306a\u308b\u306e\u3067 on \u306b\u3057\u3066\u304a\u304f\u3002\n\u307e\u305f\u3001\u30ab\u30b9\u30bf\u30e0OS \u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u305f\u5834\u5408\u306f acpid \u304c\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u3066\u3044\u308b\u304b\u78ba\u8a8d\u3059\u308b\u3002\n\nConoha\u306e\u30ab\u30b9\u30bf\u30e0OS\u306bacpid\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\nblk-availability\n$ sudo service blk-availability stop && \\\nsudo chkconfig blk-availability off\n\ncpuspeed\n$ sudo service cpuspeed stop && \\\nsudo chkconfig cpuspeed off\n\nhaldaemon\n$ sudo service haldaemon stop && \\\nsudo chkconfig haldaemon off\n\nmdmonitor\n$ sudo service mdmonitor stop && \\\nsudo chkconfig mdmonitor off\n\nmessagebus\n$ sudo service messagebus stop && \\\nsudo chkconfig messagebus off\n\nnetfs\n$ sudo service netfs stop && \\\nsudo chkconfig netfs off\n\nquota_nld\n$ sudo service quota_nld stop && \\\nsudo chkconfig quota_nld off\n\nrdisc\n$ sudo service rdisc stop && \\\nsudo chkconfig rdisc off\n\nsvnserve\n$ sudo service svnserve stop && \\\nsudo chkconfig svnserve off\n\nudev-post\n$ sudo service udev-post stop && \\\nsudo chkconfig udev-post off\n\nyum-updateonboot\n$ sudo service yum-updateonboot stop && \\\nsudo chkconfig yum-updateonboot off\n\nyum-updatesd\n\u203b yum-cron \u3092\u4f7f\u7528\u3059\u308b\u305f\u3081\u505c\u6b62\u3055\u305b\u308b\u3002\n$ sudo service yum-updatesd stop && \\\nsudo chkconfig yum-updatesd off\n\n\nyum \u306e\u81ea\u52d5\u30a2\u30c3\u30d7\u30c7\u30fc\u30c8\n$ sudo yum -y install yum-cron\n\nyum-cron \u8a2d\u5b9a\u65b9\u6cd5\u306f\u3053\u3061\u3089\u306e\u8a18\u4e8b\u3067 !\nyum \u3092\u4f7f\u3063\u3066 \u30b7\u30b9\u30c6\u30e0\u30a2\u30c3\u30d7\u30c7\u30fc\u30c8\u3092\u884c\u3046 (\u81ea\u52d5\u5316\u3082)\n\n\u30a2\u30c3\u30d7\u30c7\u30fc\u30c8\u4e0d\u8981\u306a\u30d1\u30c3\u30b1\u30fc\u30b8\u3092\u6307\u5b9a\n$ vi /etc/yum.conf\n\n\u4e0b\u8a18\u3092\u30da\u30fc\u30b9\u30c8\u3002\n[main]\nexclude=gcc* kde* openssh* kernel* php* mysql*\n\n\nyum-cron \u306e\u8a2d\u5b9a\n$ vi /etc/sysconfig/yum-cron\n\n\nyum-cron \u306e\u8d77\u52d5\n$ sudo service yum-cron start\n$ sudo chkconfig yum-cron on\n\n\nTCP \u30ab\u30fc\u30cd\u30eb\u30d1\u30e9\u30e1\u30fc\u30bf\u306e\u5909\u66f4\nipv6 \u304c\u4e0d\u8981\u3067\u3042\u308c\u3070\u3001\u305d\u306e\u8fba\u308a\u306f\u5404\u3005\u8abf\u7bc0\u3057\u3066\u304f\u3060\u3055\u3044\u3002\nsysctl -w vm.swappiness=0 && \\\nsysctl -w net.ipv4.ip_local_port_range=\"18000 65535\" && \\\nsysctl -w net.ipv4.tcp_tw_reuse=1 && \\\nsysctl -w net.ipv4.tcp_fin_timeout=10 && \\\nsysctl -w net.ipv4.tcp_max_syn_backlog=1024 && \\\nsysctl -w net.core.somaxconn=65535 && \\\nsysctl -w net.ipv6.conf.all.disable_ipv6=1 && \\\nsysctl -w net.ipv6.conf.default.disable_ipv6=1 && \\\nsysctl -w net.ipv6.conf.lo.disable_ipv6=1\n\n\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u306e\u7de8\u96c6\u3002\n$ sudo cp /etc/sysctl.conf /etc/sysctl.conf_old && \\\nsudo vi /etc/sysctl.conf\n\n\u4e0b\u8a18\u3092\u6700\u5f8c\u306e\u884c\u306b\u8ffd\u52a0\u3002\nvm.swappiness = 0\nnet.ipv4.ip_local_port_range = 18000 65535\nnet.ipv4.tcp_tw_reuse = 1\nnet.ipv4.tcp_fin_timeout = 10\nnet.ipv4.tcp_max_syn_backlog = 1024\nnet.core.somaxconn = 65535\nnet.ipv6.conf.all.disable_ipv6 = 1\nnet.ipv6.conf.default.disable_ipv6 = 1\nnet.ipv6.conf.lo.disable_ipv6 = 1\n\n\u8a2d\u5b9a\u3092\u53cd\u6620\u3055\u305b\u308b\u3002\n$ sysctl -p\n\n\u53c2\u8003\nNginx\u306e\u30d1\u30d5\u30a9\u30fc\u30de\u30f3\u30b9\u3092\u6975\u9650\u306b\u3059\u308b\u305f\u3081\u306e\u8003\u5bdf\n\u30ed\u30fc\u30ab\u30eb\u30dd\u30fc\u30c8\u3092\u98df\u3044\u3064\u3076\u3057\u3066\u3044\u305f\u8a71\nLinux\u30ab\u30fc\u30cd\u30eb\u30d1\u30e9\u30e1\u30fc\u30bf\u4e00\u89a7\u30fb\u6a19\u6e96\u8a2d\u5b9a\uff08CentOS 6\uff09\n\nprelink \u3092\u7121\u52b9\u5316\n$ sudo vi /etc/sysconfig/prelink\nPRELINKING=no\n\n$ sudo /usr/sbin/prelink -ua\n\n\nSELinux \u3092\u7121\u52b9\u5316\n$ sudo vi /etc/selinux/config\nSELINUX=disabled\n\n\nroot \u5b9b\u306e\u30e1\u30fc\u30eb\u3092\u8ee2\u9001\u3059\u308b\n$ sudo sed -i '/^root:/d' /etc/aliases && \\\nsudo vi /etc/aliases\n\n\u300c# Person who should get root's mail\u300d\u306e\u4e0b\u306b\u3042\u308b\u300croot:\u300d\u306e\u5024\u3092\u66f8\u304d\u63db\u3048\u308b\u3002\nroot: hoge@example.com\n\n\u8a2d\u5b9a\u3092\u53cd\u6620\u3055\u305b\u308b\u3002\n$ sudo newaliases && \\\nsudo echo test | mail root\n\n\n\u30ec\u30dd\u30b8\u30c8\u30ea\u306e\u8ffd\u52a0\n$ rpm --import http://dl.fedoraproject.org/pub/epel/RPM-GPG-KEY-EPEL-6 && \\\nrpm -ivh http://dl.fedoraproject.org/pub/epel/6/x86_64/epel-release-6-8.noarch.rpm\n\n$ rpm --import http://rpms.famillecollet.com/RPM-GPG-KEY-remi && \\\nrpm -ivh http://rpms.famillecollet.com/enterprise/remi-release-6.rpm\n\n$ rpm --import https://yum.mariadb.org/RPM-GPG-KEY-MariaDB && \\\nvi /etc/yum.repos.d/mariadb.repo\n\n# \u4ee5\u4e0b\u3092\u8a18\u8ff0\n[mariadb]\nname = MariaDB\nbaseurl = http://yum.mariadb.org/10.1.6/centos6-amd64\nenabled=0\ngpgkey=https://yum.mariadb.org/RPM-GPG-KEY-MariaDB\ngpgcheck=1\n\n\n\u30e9\u30a4\u30d6\u30e9\u30ea\u3092\u8af8\u3005\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n# $ yum -y install http://vault.centos.org/6.5/cr/x86_64/Packages/kernel-devel-2.6.32-504.el6.x86_64.rpm\n\n# \u304a\u540d\u524d.com VPS \u6a19\u6e96OS CentOS6.5 \u3067\u306f\u4e00\u65e6 remove\n$ yum -y remove libyaml libyaml-devel\n\n$ yum -y install \\\n    boost-devel \\\n    cmake cmake-devel \\\n    gperf gperf-devel \\\n    git git-devel \\\n    libmemcached libmemcached-devel \\\n    libevent libevent-devel \\\n    libcurl libcurl-devel \\\n    libxml2 libxml2-devel \\\n    libxslt libxslt-devel \\\n    libicu libicu-devel \\\n    libcap libcap-devel \\\n    libedit libedit-devel \\\n    libgcc libgcc.i686 \\\n    libjpeg-turbo libjpeg-turbo-devel \\\n    libpng libpng-devel \\\n    libyaml libyaml-devel \\\n    gcc-c++ \\\n    glibc-devel glibc-devel.i686 \\\n    unixODBC unixODBC-devel \\\n    sqlite sqlite-devel \\\n    expat expat-devel \\\n    bzip2 bzip2-devel \\\n    openssl openssl-devel \\\n    openldap openldap-devel \\\n    readline readline-devel \\\n    elfutils-libelf elfutils-libelf-devel \\\n    binutils binutils-devel \\\n    freetype freetype-devel \\\n    ImageMagick ImageMagick-devel \\\n    gzip gzip-devel \\\n    tar tar-devel \\\n    perl perl-devel \\\n    zip zip-devel \\\n    unzip unzip-devel \\\n    wget wget-devel\n\n$ yum -y --enablerepo=epel install \\\n    libmcrypt libmcrypt-devel \\\n    gperftools gperftools-devel\n\n$ yum -y install http://pkgrepo.linuxtech.net/el6/release/x86_64/liblcms2-2.4-1.el6.x86_64.rpm\n\n$ yum -y install --enablerepo=epel,remi make pcre pcre-devel gd-devel zlib-devel GeoIP-devel libmemcache automake autoconf re2c\n\n# \u9b3c\u8eca \u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n$ cd /tmp && \\\nsudo wget http://www.geocities.jp/kosako3/oniguruma/archive/onig-5.9.5.tar.gz -O onig-current.tar.gz && \\\nsudo mkdir onig-current && \\\ntar -zxvf onig-current.tar.gz -C /tmp/onig-current --strip-components=1 && \\\ncd ./onig-current && \\\nsudo ./configure && sudo make && sudo make install && \\\nrm -rf /tmp/onig-current.tar.gz && \\\nrm -rf /tmp/onig-current/\n\n\nOPcache\u3001Memcached\u3001PHP \u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\nyum -y install --enablerepo=remi,remi-php56 \\\n    gd-last gd-devel \\\n    php php-devel \\\n    php-common \\\n    php-mbstring \\\n    php-pdo \\\n    php-cli \\\n    php-gd \\\n    php-fpm \\\n    php-mysql php-mysqlnd \\\n    php-xml \\\n    php-pear php-pear-DB php-pear-Auth-* php-pecl-crypto \\\n    php-odbc \\\n    php-xmlrpc \\\n    php-mcrypt \\\n    php-soap \\\n    php-tidy \\\n    php-opcache \\\n    php-pecl-memcached memcached\n\n\nAPCu \u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n$ cd /tmp/ && \\\nsudo wget https://github.com/krakjoe/apcu/archive/v4.0.7.tar.gz -O apcu-current.tar.gz && \\\nsudo mkdir apcu-current && \\\nsudo tar -zxvf apcu-current.tar.gz -C /tmp/apcu-current --strip-components=1 && \\\ncd /tmp/apcu-current && \\\nphpize && \\\nsudo ./configure && sudo make && sudo make install && \\\nrm -rf /tmp/apcu-current.tar.gz && \\\nrm -rf /tmp/apcu-current/\n\n\nMariaDB \u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n$ yum -y install --enablerepo=mariadb \\\n    MariaDB-devel \\\n    MariaDB-client \\\n    MariaDB-server\n\n\nMariaDB \u3092\u8d77\u52d5\n$ service mysql start\n\n\nMariaDB \u306e\u521d\u671f\u8a2d\u5b9a\n$ mysql_secure_installation\n\nEnter current password for root (enter for none):  <- ENTER\nSet root password? [Y/n]                           <- ENTER\nNew password:                                      <- \u30d1\u30b9\u30ef\u30fc\u30c9\u3092\u5165\u529b\nRe-enter new password:                             <- \u30d1\u30b9\u30ef\u30fc\u30c9\u3092\u518d\u5165\u529b\nRemove anonymous users? [Y/n]                      <- ENTER\nDisallow root login remotely? [Y/n]                <- ENTER\nRemove test database and access to it? [Y/n]       <- ENTER\nReload privilege tables now? [Y/n]                 <- ENTER\n\n\nMariaDB \u3092\u4e00\u65e6\u7d42\u4e86\u3055\u305b\u308b\n$ service mysql stop\n\n\n\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u306e\u4f5c\u6210\n\u30b5\u30f3\u30d7\u30eb\u30d5\u30a1\u30a4\u30eb\u3092\u30b3\u30d4\u30fc\u3059\u308b\u3002\n$ sudo cp /usr/share/mysql/my-medium.cnf /etc/my.cnf.d/my.cnf\n\n\n\n\n\u30b5\u30f3\u30d7\u30eb\u30d5\u30a1\u30a4\u30eb\u306e\u5834\u6240\n\u7528\u9014\n\n\n\n\n/usr/share/mysql/my-small.cnf\n64MB RAM \u4ee5\u4e0b\u306e\u5c0f\u898f\u6a21\u30b5\u30fc\u30d0\u30fc\u5411\u3051\n\n\n/usr/share/mysql/my-medium.cnf\n32\u301c64MB RAM \u306e MySQL \u5c02\u7528\u30b5\u30fc\u30d0\u30fc\u3001\u307e\u305f\u306f 128MB RAM \u7a0b\u5ea6\u306e\u30b5\u30fc\u30d0\u30fc\u5411\u3051\n\n\n/usr/share/mysql/my-large.cnf\n512MB RAM \u7a0b\u5ea6\u306e MySQL \u5c02\u7528\u30b5\u30fc\u30d0\u30fc\u5411\u3051\n\n\n/usr/share/mysql/my-huge.cnf\n1\uff5e2GB RAM \u7a0b\u5ea6\u306e MySQL \u5c02\u7528\u30b5\u30fc\u30d0\u30fc\u5411\u3051\n\n\n/usr/share/mysql/my-innodb-heavy-4G.cnf\n4GB RAM \u7a0b\u5ea6\u3067 InnoDB \u30b9\u30c8\u30ec\u30fc\u30b8\u30a8\u30f3\u30b8\u30f3\u306e\u307f\u3092\u4f7f\u7528\u3059\u308b\u5927\u898f\u6a21 MySQL \u5c02\u7528\u30b5\u30fc\u30d0\u30fc\u5411\u3051\n\n\n\n\n\u30ab\u30b9\u30bf\u30de\u30a4\u30ba\u8a2d\u5b9a\u3092\u8ffd\u52a0\n$ sudo mv /etc/my.cnf.d/server.cnf /etc/my.cnf.d/server.cnf_old && \\\nsudo vi /etc/my.cnf.d/server.cnf\n\n\u4e0b\u8a18\u3092\u30da\u30fc\u30b9\u30c8\u3002\n[mysqld]\ndatadir=/var/lib/mysql\nsocket=/var/lib/mysql/mysql.sock\n#pid-file=/var/lib/mysql/mysql.pid\nuser=mysql\n# Disabling symbolic-links is recommended to prevent assorted security risks\nsymbolic-links=0\ncharacter-set-server=utf8\nexplicit_defaults_for_timestamp=1\ndefault-storage-engine=InnoDB\n\ninnodb_strict_mode\ninnodb_file_per_table\ninnodb_use_sys_malloc\ninnodb_buffer_pool_size=128M\ninnodb_write_io_threads=4\ninnodb_read_io_threads=4\ninnodb_thread_concurrency=16\ninnodb_log_file_size=16M\ninnodb_flush_log_at_trx_commit=2\ninnodb_flush_method=O_DIRECT\ninnodb_fast_shutdown=0\ninnodb_buffer_pool_dump_at_shutdown=1\ninnodb_buffer_pool_load_at_startup=1\n\nquery_cache_size=128M\nquery_cache_limit=2M\nquery_cache_min_res_unit=4k\nquery_cache_type=1\n\ntmp_table_size=128M\nmax_heap_table_size=128M\n\ntable_open_cache=1024\nmax_allowed_packet=1M\nsort_buffer_size=512K\nread_buffer_size=256K\nread_rnd_buffer_size=256K\njoin_buffer_size=256K\nkey_buffer_size=16M\n\nmax_connections=256\nthread_cache_size=256\n\nslow_query_log\nslow_query_log_file=/var/log/mysqld-slow.log\nlong_query_time=1\n\nlog-error=/var/log/mysqld.log\n\nwait_timeout=60\n\nplugin-load=handlersocket.so\n\n[mysqld_safe]\nlog-error=/var/log/mysqld.log\n\n\n\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306e\u30c1\u30e5\u30fc\u30cb\u30f3\u30b0\n$ cd ~/\n$ wget https://raw.githubusercontent.com/major/MySQLTuner-perl/master/mysqltuner.pl\n$ perl <(wget -q -O - mysqltuner.pl)\n\nMySQLTuner\u3067MySQL\u306e\u30c1\u30e5\u30fc\u30cb\u30f3\u30b0\u3092\u8a3a\u65ad\u3059\u308b\u65b9\u6cd5\n\n\u30d2\u30f3\u30c8\n# \u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u4e00\u89a7\nMariaDB [(none)]> show databases;\n\n# \u30e6\u30fc\u30b6\u30fc\u4e00\u89a7\nMariaDB [(none)]> select Host, User, Password from mysql.user;\n\n# \u6307\u5b9a\u306e\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306e\u30c6\u30fc\u30d6\u30eb\u4e00\u89a7\nMariaDB [(none)]> SHOW TABLES FROM tablename;\n\n\nNginx \u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\nNginx \u3092\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u304b\u3089\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\n\u57f7\u7b46\u6642\u70b9\u3067\u306e\u6700\u65b0\u5b89\u5b9a\u7248\u306f\u30011.8.0\u3067\u3059\u3002\n\nNginx \u30e6\u30fc\u30b6\u30fc\u3092\u4f5c\u6210\n$ useradd --shell /sbin/nologin nginx && \\\nid nginx\n\n\n\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u306e\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\n$ cd /tmp/ && \\\nsudo wget http://nginx.org/download/nginx-1.8.0.tar.gz -O nginx-current.tar.gz && \\\nsudo mkdir nginx-current && \\\nsudo tar -zxvf nginx-current.tar.gz -C /tmp/nginx-current --strip-components=1 && \\\ncd /tmp/nginx-current\n\n\nNGX Cache Purge\n$ sudo wget http://labs.frickle.com/files/ngx_cache_purge-2.3.tar.gz -O ngx_cache_purge.tar.gz && \\\nsudo mkdir ngx_cache_purge && \\\nsudo tar -zxvf ngx_cache_purge.tar.gz -C /tmp/nginx-current/ngx_cache_purge --strip-components=1 && \\\nsudo rm -rf ngx_cache_purge.tar.gz\n\n\nOpenSSL\n$ sudo wget http://www.openssl.org/source/openssl-1.0.2d.tar.gz -O openssl.tar.gz && \\\nsudo mkdir openssl && \\\nsudo tar -zxvf openssl.tar.gz -C /tmp/nginx-current/openssl --strip-components=1 && \\\nsudo rm -rf openssl.tar.gz\n\n\nNGX PageSpeed\n$ git clone https://github.com/pagespeed/ngx_pagespeed.git && \\\nrm -rf ./ngx_pagespeed/.git && \\\ncd ./ngx_pagespeed && \\\nsudo wget https://dl.google.com/dl/page-speed/psol/1.9.32.6.tar.gz && \\\nsudo tar -zxvf 1.9.32.6.tar.gz && \\\nsudo rm -rf ./1.9.32.6.tar.gz\n\n\n\u30d3\u30eb\u30c9\n$ cd /tmp/nginx-current && \\\nsudo ./configure \\\n--prefix=/etc/sysconfig/nginx \\\n--sbin-path=/usr/sbin/nginx \\\n--conf-path=/etc/nginx/nginx.conf \\\n--error-log-path=/var/log/nginx/error.log \\\n--pid-path=/var/run/nginx/nginx.pid \\\n--lock-path=/var/lock/subsys/nginx \\\n--http-client-body-temp-path=/var/cache/nginx/client_temp \\\n--http-proxy-temp-path=/var/cache/nginx/proxy_temp \\\n--http-fastcgi-temp-path=/var/cache/nginx/fastcgi_temp \\\n--http-uwsgi-temp-path=/var/cache/nginx/uwsgi_temp \\\n--http-scgi-temp-path=/var/cache/nginx/scgi_temp \\\n--user=nginx \\\n--group=nginx \\\n--with-http_ssl_module \\\n--with-http_realip_module \\\n--with-http_addition_module \\\n--with-http_sub_module \\\n--with-http_dav_module \\\n--with-http_flv_module \\\n--with-http_mp4_module \\\n--with-http_gunzip_module \\\n--with-http_gzip_static_module \\\n--with-http_random_index_module \\\n--with-http_secure_link_module \\\n--with-http_stub_status_module \\\n--with-http_auth_request_module \\\n--with-mail \\\n--with-mail_ssl_module \\\n--with-file-aio \\\n--with-ipv6 \\\n--with-debug \\\n--with-http_spdy_module \\\n--with-openssl=/tmp/nginx-current/openssl \\\n--add-module=/tmp/nginx-current/ngx_cache_purge \\\n--add-module=/tmp/nginx-current/ngx_pagespeed && \\\nsudo make && sudo make install && \\\nsudo rm -rf /tmp/nginx-current/ && \\\nsudo rm -rf /tmp/nginx-current.tar.gz\n\n\n\u30d5\u30a9\u30eb\u30c0\u306e\u4f5c\u6210\n$ sudo mkdir -m 755 -p /var/cache/nginx/ngx_pagespeed/ && \\\nsudo mkdir -m 755 -p /var/cache/nginx/ngx_pagespeed/ && \\\nsudo chown -R nginx:nginx /var/cache/nginx && \\\nsudo mkdir -m 755 -p /var/run/nginx/ && \\\nsudo chown nginx:nginx /var/run/nginx/ && \\\nsudo mkdir -m 755 -p /var/log/nginx/ngx_pagespeed/ && \\\nsudo chown -R nginx:nginx /var/log/nginx/ && \\\nsudo mkdir -m 755 -p /var/run/hhvm/ && \\\nsudo chown nginx:nginx /var/run/hhvm/ && \\\nsudo mkdir -m 755 -p /var/log/hhvm/ && \\\nsudo chown -R nginx:nginx /var/log/hhvm/ && \\\nsudo mkdir -m 755 -p /var/log/php-fpm/ && \\\nsudo chown -R nginx:nginx /var/log/php-fpm/\n\n\n\u8d77\u52d5\u30b9\u30af\u30ea\u30d7\u30c8\u306e\u4f5c\u6210\n$ vi /etc/init.d/nginx\n\n\u4e0b\u8a18\u3092\u30da\u30fc\u30b9\u30c8\u3002\n#!/bin/sh\n#\n# nginx - this script starts and stops the nginx daemon\n#\n# chkconfig:   - 85 15\n# description:  Nginx is an HTTP(S) server, HTTP(S) reverse \\\n#               proxy and IMAP/POP3 proxy server\n# processname: nginx\n# config:      /etc/nginx/nginx.conf\n# config:      /etc/sysconfig/nginx\n# pidfile:     /var/run/nginx.pid\n\n# Source function library.\n. /etc/rc.d/init.d/functions\n\n# Source networking configuration.\n. /etc/sysconfig/network\n\n# Check that networking is up.\n[ \"$NETWORKING\" = \"no\" ] && exit 0\n\nnginx=\"/usr/sbin/nginx\"\nprog=$(basename $nginx)\n\nsysconfig=\"/etc/sysconfig/$prog\"\nlockfile=\"/var/lock/subsys/nginx\"\npidfile=\"/var/run/nginx/${prog}.pid\"\n\nNGINX_CONF_FILE=\"/etc/nginx/nginx.conf\"\n\n[ -f $sysconfig ] && . $sysconfig\n\n\nstart() {\n    [ -x $nginx ] || exit 5\n    [ -f $NGINX_CONF_FILE ] || exit 6\n    echo -n $\"Starting $prog: \"\n    daemon $nginx -c $NGINX_CONF_FILE\n    retval=$?\n    echo\n    [ $retval -eq 0 ] && touch $lockfile\n    return $retval\n}\n\nstop() {\n    echo -n $\"Stopping $prog: \"\n    killproc -p $pidfile $prog\n    retval=$?\n    echo\n    [ $retval -eq 0 ] && rm -f $lockfile\n    return $retval\n}\n\nrestart() {\n    configtest_q || return 6\n    stop\n    start\n}\n\nreload() {\n    configtest_q || return 6\n    echo -n $\"Reloading $prog: \"\n    killproc -p $pidfile $prog -HUP\n    echo\n}\n\nconfigtest() {\n    $nginx -t -c $NGINX_CONF_FILE\n}\n\nconfigtest_q() {\n    $nginx -t -q -c $NGINX_CONF_FILE\n}\n\nrh_status() {\n    status $prog\n}\n\nrh_status_q() {\n    rh_status >/dev/null 2>&1\n}\n\n# Upgrade the binary with no downtime.\nupgrade() {\n    local oldbin_pidfile=\"${pidfile}.oldbin\"\n\n    configtest_q || return 6\n    echo -n $\"Upgrading $prog: \"\n    killproc -p $pidfile $prog -USR2\n    retval=$?\n    sleep 1\n    if [[ -f ${oldbin_pidfile} && -f ${pidfile} ]];  then\n        killproc -p $oldbin_pidfile $prog -QUIT\n        success $\"$prog online upgrade\"\n        echo\n        return 0\n    else\n        failure $\"$prog online upgrade\"\n        echo\n        return 1\n    fi\n}\n\n# Tell nginx to reopen logs\nreopen_logs() {\n    configtest_q || return 6\n    echo -n $\"Reopening $prog logs: \"\n    killproc -p $pidfile $prog -USR1\n    retval=$?\n    echo\n    return $retval\n}\n\ncase \"$1\" in\n    start)\n        rh_status_q && exit 0\n        $1\n        ;;\n    stop)\n        rh_status_q || exit 0\n        $1\n        ;;\n    restart|configtest|reopen_logs)\n        $1\n        ;;\n    force-reload|upgrade)\n        rh_status_q || exit 7\n        upgrade\n        ;;\n    reload)\n        rh_status_q || exit 7\n        $1\n        ;;\n    status|status_q)\n        rh_$1\n        ;;\n    condrestart|try-restart)\n        rh_status_q || exit 7\n        restart\n        ;;\n    *)\n        echo $\"Usage: $0 {start|stop|reload|configtest|status|force-reload|upgrade|restart|reopen_logs}\"\n        exit 2\nesac\n\n\u5b9f\u884c\u6a29\u9650\u3092\u4ed8\u4e0e\u3059\u308b\u3002\n$ chmod +x /etc/init.d/nginx\n\n\n\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3092\u7528\u610f\nAmimoto \u306e Nginx \u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb \u3092\u53c2\u8003\u306b\u3059\u308b\u3068\u3088\u3044\u3068\u601d\u3044\u307e\u3059\u3002\n\u72ec\u81ea\u306b\u7528\u610f\u3057\u3066\u3044\u308b\u5834\u5408\u306f\u3001git clone \u306a\u3069\u3067\u30ea\u30e2\u30fc\u30c8\u30b5\u30fc\u30d0\u30fc\u306b\u6301\u3063\u3066\u304f\u308b\u3068\u697d\u304b\u3082\u3067\u3059\u306d\u3002\n$ mv /etc/nginx/ /etc/nginx_old/ && \\\ncd /etc/ && \\\ngit clone https://github.com/YOUR_USERNAME/nginx.git --depth=1 && \\\nrm -rf /etc/nginx/.git\n\nnginx.conf \u306e worker_processes \u3068 worker_cpu_affinity \u306f CPU \u306e\u30b3\u30a2\u6570\u3092\u57fa\u306b\u8a2d\u5b9a\u3059\u308b\u3002\nCPU \u306e\u30b3\u30a2\u6570\u3092\u78ba\u8a8d\u3059\u308b\u306b\u306f\u3001\u4ee5\u4e0b\u306e\u30b3\u30de\u30f3\u30c9\u3067\u78ba\u8a8d\u3067\u304d\u308b\u3002\n$ grep processor /proc/cpuinfo |wc -l\n\n\u30b3\u30a2\u6570\u304c 3 \u306e\u5834\u5408\u306f\u4ee5\u4e0b\u3001nginx.conf \u306e worker_processes \u3068 worker_cpu_affinity \u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u306a\u308b\u3002\nworker_processes     3;\nworker_cpu_affinity  001 010 100;\n\n\nNginx \u306e\u8d77\u52d5\n\u4e00\u756a\u6700\u5f8c\u306b\u884c\u3046\u3002\n\n\u30d2\u30f3\u30c8\n\u7279\u5b9a\u306e URL \u306e\u30ad\u30e3\u30c3\u30b7\u30e5\u3092\u524a\u9664\u3059\u308b\u3002\n$ find /var/cache/nginx/ -type f -exec grep -l \"KEY: http://192.168.30.10/.*$\" {} \\; | xargs rm -f\n\n\nHHVM \u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\u4ee5\u4e0b\u624b\u9806\u306f HHVM Github Wiki Building and installing HHVM on CentOS 6.6 \u8a18\u8f09\u306e\u624b\u9806\u3068\u57fa\u672c\u7684\u306b\u540c\u3058\u3067\u3059\u3002\n\ngcc \u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\u8457\u8005\u306f\u3001\u3053\u306e\u65b9\u6cd5\u3067\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u306b\u6210\u529f\u3057\u305f\u3053\u3068\u304c\u306a\u3044\u3067\u3059\u3002\n$ cd /tmp && \\\nsudo wget ftp://ftp.gnu.org/gnu/gcc/gcc-5.2.0/gcc-5.2.0.tar.gz -O gcc-current.tar.gz && \\\nsudo mkdir gcc-current && \\\nsudo tar -zxvf gcc-current.tar.gz -C /tmp/gcc-current --strip-components=1 && \\\ncd /tmp/gcc-current\n\n\ngmp\n$ sudo wget https://gmplib.org/download/gmp-6.0.0/gmp-6.0.0.tar.bz2 -O gmp-current.tar.bz2 && \\\nsudo mkdir gmp && sudo tar -jxvf gmp-current.tar.bz2 -C /tmp/gcc-current/gmp --strip-components=1\n\n\nmpfr\n$ sudo wget http://www.mpfr.org/mpfr-current/mpfr-3.1.3.tar.bz2 -O mpfr-current.tar.bz2 && \\\nsudo mkdir mpfr && sudo tar -jxvf mpfr-current.tar.bz2 -C /tmp/gcc-current/mpfr --strip-components=1\n\n\nmpc\n$ sudo wget http://www.multiprecision.org/mpc/download/mpc-1.0.3.tar.gz -O mpc-current.tar.gz && \\\nsudo mkdir mpc && sudo tar -zxvf mpc-current.tar.gz -C /tmp/gcc-current/mpc --strip-components=1\n\n\nisl\n$ sudo wget ftp://ftp.irisa.fr/pub/mirrors/gcc.gnu.org/gcc/infrastructure/isl-0.15.tar.bz2 -O isl-current.tar.bz2 && \\\nsudo mkdir isl && sudo tar -jxvf isl-current.tar.bz2 -C /tmp/gcc-current/isl --strip-components=1\n\n\ncloog\n$ sudo wget http://bastoul.net/cloog/pages/download/cloog-0.18.4.tar.gz -O cloog-current.tar.gz && \\\nsudo mkdir cloog && sudo tar -zxvf cloog-current.tar.gz -C /tmp/gcc-current/cloog --strip-components=1\n\n\n\u30d3\u30eb\u30c9\n$ sudo mkdir /tmp/gcc-build && cd /tmp/gcc-build && \\\nsudo ../gcc-current/configure --enable-languages=c,c++,fortran --enable-multilib --prefix=/usr/local/gcc\n$ sudo make && sudo make install\n\n\n\u65b0\u30d0\u30fc\u30b8\u30e7\u30f3\u306b\u5165\u308c\u66ff\u3048\u308b\n$ yum remove -y gcc gcc-c++ cpp\n$ sudo mv /usr/bin/g++ /usr/bin/g++_old && \\\nsudo mv /usr/bin/c++ /usr/bin/c++_old && \\\nsudo ln -s -f /usr/local/gcc/bin/gcc /usr/bin/gcc && \\\nsudo ln -s -f /usr/local/gcc/bin/g++ /usr/bin/g++ && \\\nsudo ln -s -f /usr/local/gcc/bin/c++ /usr/bin/c++ && \\\nsudo ln -s -f /usr/local/gcc/bin/cpp /usr/bin/cpp && \\\nsudo ln -s -f /usr/local/gcc/bin/gfortran /usr/bin/gfortran && \\\nsudo ln -s -f /usr/local/gcc/bin/gcov /usr/bin/gcov && \\\nsudo cp /usr/local/gcc/lib64/libstdc++.so.6.0.20 /usr/lib64/. && \\\nsudo mv /usr/lib64/libstdc++.so.6 /usr/lib64/libstdc++.so.6.bak && \\\nsudo ln -s -f /usr/lib64/libstdc++.so.6.0.20 /usr/lib64/libstdc++.so.6\n\n\ngcc \u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u305d\u306e 2\n$ sudo wget http://people.centos.org/tru/devtools-2/devtools-2.repo -O /etc/yum.repos.d/devtools-2.repo && \\\nsudo yum -y install devtoolset-2-gcc devtoolset-2-binutils devtoolset-2-gcc-c++ && \\\nsudo mv /usr/bin/g++ /usr/bin/g++_old && \\\nsudo mv /usr/bin/c++ /usr/bin/c++_old && \\\nsudo mv /usr/bin/c++filt /usr/bin/c++filt_old && \\\nsudo mv /usr/bin/cpp /usr/bin/cpp_old && \\\nsudo mv /usr/bin/cc /usr/bin/cc_old && \\\nsudo mv /usr/bin/gcov /usr/bin/gcov_old && \\\nsudo ln -s -f /opt/rh/devtoolset-2/root/usr/bin/c++ /usr/bin/ && \\\nsudo ln -s -f /opt/rh/devtoolset-2/root/usr/bin/c++filt /usr/bin/ && \\\nsudo ln -s -f /opt/rh/devtoolset-2/root/usr/bin/cpp /usr/bin/ && \\\nsudo ln -s -f /opt/rh/devtoolset-2/root/usr/bin/g++ /usr/bin/ && \\\nsudo ln -s -f /opt/rh/devtoolset-2/root/usr/bin/gcc /usr/bin/ && \\\nsudo ln -s -f /opt/rh/devtoolset-2/root/usr/bin/gcc-ar /usr/bin/ && \\\nsudo ln -s -f /opt/rh/devtoolset-2/root/usr/bin/gcc-nm /usr/bin/ && \\\nsudo ln -s -f /opt/rh/devtoolset-2/root/usr/bin/gcc-ranlib /usr/bin/ && \\\nsudo ln -s -f /opt/rh/devtoolset-2/root/usr/bin/gcov /usr/bin/ && \\\nhash -r\n\n\ngmp\n$ cd /tmp && \\\nsudo wget https://gmplib.org/download/gmp-6.0.0/gmp-6.0.0.tar.bz2 -O gmp-current.tar.bz2 && \\\nsudo mkdir gmp-current && sudo tar -jxvf gmp-current.tar.bz2 -C /tmp/gmp-current --strip-components=1 && \\\ncd /tmp/gmp-current && \\\nsudo ./configure --enable-cxx && sudo make && sudo make install && \\\nrm -rf /tmp/gmp-current.tar.gz && \\\nrm -rf /tmp/gmp-current/\n\n\nmpfr\n$ cd /tmp && \\\nsudo wget http://www.mpfr.org/mpfr-current/mpfr-3.1.3.tar.bz2 -O mpfr-current.tar.bz2 && \\\nsudo mkdir mpfr-current && sudo tar -jxvf mpfr-current.tar.bz2 -C /tmp/mpfr-current --strip-components=1 && \\\ncd /tmp/mpfr-current && \\\nsudo ./configure && sudo make && sudo make install && \\\nrm -rf /tmp/mpfr-current.tar.gz && \\\nrm -rf /tmp/mpfr-current/\n\n\nmpc\n$ cd /tmp && \\\nsudo wget http://www.multiprecision.org/mpc/download/mpc-1.0.3.tar.gz -O mpc-current.tar.gz && \\\nsudo mkdir mpc-current && sudo tar -zxvf mpc-current.tar.gz -C /tmp/mpc-current --strip-components=1 && \\\ncd /tmp/mpc-current && \\\nsudo ./configure && sudo make && sudo make install && \\\nrm -rf /tmp/mpc-current.tar.gz && \\\nrm -rf /tmp/mpc-current/\n\n\nisl\n$ cd /tmp && \\\nsudo wget ftp://ftp.irisa.fr/pub/mirrors/gcc.gnu.org/gcc/infrastructure/isl-0.15.tar.bz2 -O isl-current.tar.bz2 && \\\nsudo mkdir isl-current && sudo tar -jxvf isl-current.tar.bz2 -C /tmp/isl-current --strip-components=1 && \\\ncd /tmp/isl-current && \\\nsudo ./configure && sudo make && sudo make install && \\\nrm -rf /tmp/isl-current.tar.gz && \\\nrm -rf /tmp/isl-current/\n\n\ncloog\n$ cd /tmp && \\\nsudo wget http://bastoul.net/cloog/pages/download/cloog-0.18.4.tar.gz -O cloog-current.tar.gz && \\\nsudo mkdir cloog-current && sudo tar -zxvf cloog-current.tar.gz -C /tmp/cloog-current --strip-components=1 && \\\ncd /tmp/cloog-current && \\\nsudo ./configure && sudo make && sudo make install && \\\nrm -rf /tmp/cloog-current.tar.gz && \\\nrm -rf /tmp/cloog-current/\n\n\nlibtool \u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n$ cd /tmp && \\\nsudo wget http://ftpmirror.gnu.org/libtool/libtool-2.4.6.tar.gz -O libtool-current.tar.gz && \\\nsudo mkdir ./libtool-current && \\\nsudo tar -zxvf libtool-current.tar.gz -C /tmp/libtool-current --strip-components=1 && \\\ncd ./libtool-current && \\\nsudo ./configure && sudo make && sudo make install && \\\nsudo rm -rf /tmp/libtool-current/ && \\\nsudo rm -rf /tmp/libtool-current.tar.gz\n\n\nHHVM \u306e\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\n$ cd /usr/local && \\\ngit clone git://github.com/facebook/hhvm.git --depth=1 && \\\ncd hhvm && \\\nexport CMAKE_PREFIX_PATH=/usr/local\n\n\ncurl \u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n# \u4e0b\u8a18 URL \u5148\u304b\u3089\u9069\u5f53\u306b\u30df\u30e9\u30fc\u3092\u9078\u3093\u3067\u304f\u3060\u3055\u3044\n# http://curl.haxx.se/latest.cgi?curl=tar.gz\n$ cd /tmp && \\\nsudo wget http://curl.mirror.anstey.ca/curl-7.44.0.tar.gz -O curl-current.tar.gz && \\\nsudo mkdir ./curl-current && \\\nsudo tar -zxvf ./curl-current.tar.gz -C /tmp/curl-current --strip-components=1 && \\\ncd ./curl-current && \\\n./configure --enable-libcurl-option && sudo make && sudo make install && \\\nsudo rm -rf /tmp/curl-current/ && \\\nsudo rm -rf /tmp/curl-current.tar.gz\n\n\nBoost \u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n$ cd /tmp && \\\nsudo wget http://downloads.sourceforge.net/project/boost/boost/1.59.0/boost_1_59_0.tar.gz -O boost-current.tar.gz && \\\nsudo mkdir ./boost-current && \\\nsudo tar -zxvf boost-current.tar.gz -C /tmp/boost-current --strip-components=1 && \\\ncd ./boost-current && \\\nsudo ./bootstrap.sh && \\\nsudo ./b2 --layout=system install\n$ export PATH=/usr/local/boost/include:$PATH && \\\nexport PATH=/usr/local/boost/lib:$PATH && \\\nsed -i '/export PATH/i PATH=$PATH:/usr/local/boost/include' ~/.bash_profile && \\\nsed -i '/export PATH/i PATH=$PATH:/usr/local/boost/lib' ~/.bash_profile\n\n# \u4e0a\u8a18\u3067 Path \u304c\u901a\u3089\u306a\u3044\u5834\u5408\u306f\u4ee5\u4e0b\u3092\u8ffd\u52a0\n$ export BOOST_INCLUDEDIR=/usr/local/boost/include:$BOOST_INCLUDEDIR && \\\nexport LD_LIBRARY_PATH=/usr/local/boost/lib\n\nexport BOOST_ROOT=/usr/local/boost/:$BOOST_ROOT\n\nexport CMAKE_INCLUDE_PATH=$CMAKE_PREFIX_PATH/boost/include && \\\nexport CMAKE_LIBRARY_PATH=$CMAKE_PREFIX_PATH/boost/lib\n\n# \u5f8c\u59cb\u672b\n$ sudo rm -rf /tmp/boost-current/ && \\\nsudo rm -rf /tmp/boost-current.tar.gz\n\n\nlibmemcached \u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n$ cd /tmp && \\\nsudo wget https://launchpad.net/libmemcached/1.0/1.0.9/+download/libmemcached-1.0.9.tar.gz -O libmemcached-current.tar.gz && \\\nsudo mkdir ./libmemcached-current && \\\ntar -xzvf ./libmemcached-current.tar.gz -C /tmp/libmemcached-current --strip-components=1 && \\\ncd ./libmemcached-current && \\\n./configure --prefix=$CMAKE_PREFIX_PATH && sudo make && sudo make install && \\\nsudo rm -rf /tmp/libmemcached-current/ && \\\nsudo rm -rf /tmp/libmemcached-current.tar.gz\n\n\nJEMalloc \u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n$ cd /tmp && \\\nsudo wget http://www.canonware.com/download/jemalloc/jemalloc-3.5.1.tar.bz2 -O jemalloc-current.tar.gz && \\\nsudo mkdir ./jemalloc-current && \\\ntar -xjvf jemalloc-current.tar.gz -C /tmp/jemalloc-current --strip-components=1 && \\\ncd ./jemalloc-current && \\\n./configure --prefix=$CMAKE_PREFIX_PATH && sudo make && sudo make install && \\\nsudo rm -rf /tmp/jemalloc-current/ && \\\nsudo rm -rf /tmp/jemalloc-current.tar.gz\n\n\nsqlite \u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n$ cd /tmp && \\\nsudo wget http://ftp.osuosl.org/pub/blfs/conglomeration/sqlite/sqlite-autoconf-3081101.tar.gz -O sqlite-current.tar.gz && \\\nsudo mkdir ./sqlite-current && \\\ntar -zxvf sqlite-current.tar.gz -C /tmp/sqlite-current --strip-components=1 && \\\ncd ./sqlite-current && \\\n./configure --prefix=$CMAKE_PREFIX_PATH && sudo make && sudo make install && \\\nsudo rm -rf /tmp/sqlite-current/ && \\\nsudo rm -rf /tmp/sqlite-current.tar.gz\n\n\nOCaml \u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n$ sudo wget http://download.opensuse.org/repositories/home:/ocaml/CentOS_6/home:ocaml.repo -O /etc/yum.repos.d/ocaml.repo && \\\nyum -y install ocaml\n\n\nTBB \u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n$ yum -y install ftp://ftp.pbone.net/mirror/ftp5.gwdg.de/pub/opensuse/repositories/home:/zgyarmati:/hhphp/CentOS_CentOS-5/x86_64/tbb-4.0-2.6.x86_64.rpm\n$ yum -y install ftp://ftp.pbone.net/mirror/ftp5.gwdg.de/pub/opensuse/repositories/home:/zgyarmati:/hhphp/CentOS_CentOS-5/x86_64/tbb-devel-4.0-2.6.x86_64.rpm\n\n\nglog \u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n$ cd /tmp && \\\nsudo wget https://google-glog.googlecode.com/files/glog-0.3.3.tar.gz -O glog-current.tar.gz && \\\nsudo mkdir glog-current && \\\ntar -zxvf glog-current.tar.gz -C /tmp/glog-current --strip-components=1 && \\\ncd ./glog-current && \\\n./configure && sudo make && sudo make install && \\\nsudo rm -rf /tmp/glog-current/ && \\\nsudo rm -rf /tmp/glog-current.tar.gz\n\n\nlibdwarf \u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n$ cd /tmp && \\\nsudo wget http://www.prevanders.net/libdwarf-20150310.tar.gz -O libdwarf-current.tar.gz && \\\nsudo mkdir libdwarf-current && \\\ntar -zxvf libdwarf-current.tar.gz -C /tmp/libdwarf-current --strip-components=1 && \\\ncd ./libdwarf-current && \\\n./configure && sudo make && \\\nsudo cp ./libdwarf/libdwarf.a /usr/lib64/ && \\\nsudo cp ./libdwarf/libdwarf.h /usr/include/ && \\\nsudo cp ./libdwarf/dwarf.h /usr/include/ && \\\nsudo rm -rf /tmp/libdwarf-current/ && \\\nsudo rm -rf /tmp/libdwarf-current.tar.gz\n\n\nHHVM \u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n$ cd /usr/local/hhvm && \\\ngit submodule update --init --recursive\n$ sudo cmake .\n$ sudo sed -i -e 's/$/..\\/..\\/..\\/lib\\/libmemcached.so/g' hphp/hhvm/CMakeFiles/hhvm.dir/link.txt\n$ sudo make\n$ export PATH=/usr/local/hhvm/hphp/hhvm:$PATH && \\\nsed -i '/export PATH/i PATH=$PATH:/usr/local/hhvm/hphp/hhvm' ~/.bash_profile\n\n\n\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u306e\u4f5c\u6210\n$ sudo mldir /etc/hhvm/ && \\\nsudo vi /etc/hhvm/server.hdf\n\n\u4e0b\u8a18\u3092\u30da\u30fc\u30b9\u30c8\u3002\nPidFile = /var/run/hhvm/hhvm.pid\n\nServer {\n  Type = fastcgi\n  FileSocket = /var/run/hhvm/hhvm.sock\n  User = nginx\n  Group = nginx\n}\n\nLog {\n  Level = Warning\n  AlwaysLogUnhandledExceptions = true\n  RuntimeErrorReportingLevel = 8191\n  UseLogFile = true\n  UseSyslog = false\n  File = /var/log/hhvm/error.log\n  Access {\n    * {\n      File = /var/log/hhvm/access.log\n      Format = %h %l %u % t \\\"%r\\\" %>s %b\n    }\n  }\n}\n\nRepo {\n  Central {\n    # Path = /var/log/hhvm/.hhvm.hhbc\n    Path = /var/tmp/hhvm.hhbc\n  }\n}\n\nMySQL {\n  TypedResults = false\n}\n\n$ sudo vi /etc/hhvm/config.hdf\n\n\u4e0b\u8a18\u3092\u30da\u30fc\u30b9\u30c8\u3002\nLog {\n  Level = Warning\n  AlwaysLogUnhandledExceptions = true\n  RuntimeErrorReportingLevel = 8191\n}\n\nMySQL {\n  TypedResults = false\n}\n\nEval {\n  JitASize = 67108864\n  JitAStubsSize = 67108864\n  JitGlobalDataSize = 22554432\n}\n\n\n\u8d77\u52d5\u30b9\u30af\u30ea\u30d7\u30c8\u306e\u4f5c\u6210\n$ sudo vi /etc/init.d/hhvm\n\n\u4e0b\u8a18\u3092\u30da\u30fc\u30b9\u30c8\u3002\n#!/bin/bash\n#\n# /etc/rc.d/init.d/hhvm\n#\n# Starts the hhvm daemon\n#\n# chkconfig: 345 26 74\n# description: HHVM (aka the HipHop Virtual Machine) is an open-source virtual machine designed for executing programs written in Hack and PHP\n# processname: hhvm\n\n### BEGIN INIT INFO\n# Provides: hhvm\n# Required-Start: $local_fs\n# Required-Stop: $local_fs\n# Default-Start:  2 3 4 5\n# Default-Stop: 0 1 6\n# Short-Description: start and stop hhvm\n# Description: HHVM (aka the HipHop Virtual Machine) is an open-source virtual machine designed for executing programs written in Hack and PHP\n### END INIT INFO\n\n# Source function library.\n. /etc/init.d/functions\n\nstart() {\n  echo -n \"Starting hhvm: \"\n        /usr/local/hhvm/hphp/hhvm/hhvm --config /etc/hhvm/server.hdf --user nginx --mode daemon\n  touch /var/lock/subsys/hhvm\n}\n\nstop() {\n  echo -n \"Shutting down hhvm: \"\n  killproc -p /var/run/hhvm/hhvm.pid hhvm\n  rm -f /var/lock/subsys/hhvm\n}\n\ncase \"$1\" in\n  start)\n  start\n  ;;\n  stop)\n  stop\n  ;;\n  status)\n    status -p /var/run/hhvm/hhvm.pid hhvm\n  ;;\n  restart)\n    stop\n  start\n  ;;\n  reload|condrestart|probe)\n  echo \"$1 - Not supported.\"\n  ;;\n  *)\n  echo \"Usage: hhvm {start|stop|status|reload|restart[|probe]\"\n  exit 1\n  ;;\nesac\nexit $?\n\n\u5b9f\u884c\u6a29\u9650\u3092\u4ed8\u4e0e\u3002\n$ chmod +x /etc/init.d/hhvm\n\n\nphp.ini \u3092\u5909\u66f4\n$ sudo mv /etc/php.ini /etc/php.ini_old && \\\nsudo vi /etc/php.ini\n\n\u4e0b\u8a18\u3092\u30da\u30fc\u30b9\u30c8\u3002\n[PHP]\nengine = On\nshort_open_tag = On\nasp_tags = Off\nprecision = 14\ny2k_compliance = On\noutput_buffering = 4096\nzlib.output_compression = Off\nimplicit_flush = Off\nunserialize_callback_func =\nserialize_precision = 100\nallow_call_time_pass_reference = Off\nsafe_mode = Off\nsafe_mode_gid = Off\nsafe_mode_include_dir =\nsafe_mode_exec_dir =\nsafe_mode_allowed_env_vars = PHP_\nsafe_mode_protected_env_vars = LD_LIBRARY_PATH\ndisable_functions =\ndisable_classes =\nzend.enable_gc = On\nexpose_php = Off\nmax_execution_time = 90\nmax_input_time = 60\nmemory_limit = 128M\nerror_reporting = E_ALL & ~E_DEPRECATED\ndisplay_errors = Off\ndisplay_startup_errors = Off\nlog_errors = On\nlog_errors_max_len = 1024\nignore_repeated_errors = Off\nignore_repeated_source = Off\nreport_memleaks = On\ntrack_errors = Off\nhtml_errors = Off\nvariables_order = \"GPCS\"\nrequest_order = \"GP\"\nregister_globals = Off\nregister_long_arrays = Off\nregister_argc_argv = Off\nauto_globals_jit = On\npost_max_size = 8M\nmagic_quotes_gpc = Off\nmagic_quotes_runtime = Off\nmagic_quotes_sybase = Off\nauto_prepend_file =\nauto_append_file =\ndefault_mimetype = \"text/html\"\ndoc_root =\nuser_dir =\nenable_dl = Off\nfile_uploads = On\nupload_max_filesize = 4M\nmax_file_uploads = 20\nallow_url_fopen = On\nallow_url_include = Off\ndefault_socket_timeout = 60\n\n[Date]\ndate.timezone = \"Asia/Tokyo\"\n\n[filter]\n\n[iconv]\n\n[intl]\n\n[sqlite]\n\n[sqlite3]\n\n[Pcre]\n\n[Pdo]\n\n[Phar]\n\n[Syslog]\ndefine_syslog_variables  = Off\n\n[mail function]\nSMTP = localhost\nsmtp_port = 25\nsendmail_path = /usr/sbin/sendmail -t -i\nmail.add_x_header = On\n\n[SQL]\nsql.safe_mode = Off\n\n[ODBC]\nodbc.allow_persistent = On\nodbc.check_persistent = On\nodbc.max_persistent = -1\nodbc.max_links = -1\nodbc.defaultlrl = 4096\nodbc.defaultbinmode = 1\n\n[MySQL]\nmysql.allow_persistent = On\nmysql.max_persistent = -1\nmysql.max_links = -1\nmysql.default_port =\nmysql.default_socket =\nmysql.default_host =\nmysql.default_user =\nmysql.default_password =\nmysql.connect_timeout = 60\nmysql.trace_mode = Off\n\n[MySQLi]\nmysqli.max_links = -1\nmysqli.default_port = 3306\nmysqli.default_socket =\nmysqli.default_host =\nmysqli.default_user =\nmysqli.default_pw =\nmysqli.reconnect = Off\n\n[OCI8]\n\n[PostgresSQL]\npgsql.allow_persistent = On\npgsql.auto_reset_persistent = Off\npgsql.max_persistent = -1\npgsql.max_links = -1\npgsql.ignore_notice = 0\npgsql.log_notice = 0\n\n[Sybase-CT]\nsybct.allow_persistent = On\nsybct.max_persistent = -1\nsybct.max_links = -1\nsybct.min_server_severity = 10\nsybct.min_client_severity = 10\n\n[bcmath]\nbcmath.scale = 0\n\n[browscap]\n\n[Session]\n;session.save_handler = files\nsession.save_handler = memcached\n;session.save_path = \"/var/tmp/php/session\"\nsession.save_path = \"tcp://localhost:11211\"\nsession.use_cookies = 1\nsession.use_only_cookies = 1\nsession.name = PHPSESSID\nsession.auto_start = 0\nsession.cookie_lifetime = 0\nsession.cookie_path = /\nsession.cookie_domain =\nsession.cookie_httponly =\nsession.serialize_handler = php\nsession.gc_probability = 1\nsession.gc_divisor = 1000\nsession.gc_maxlifetime = 1440\nsession.bug_compat_42 = Off\nsession.bug_compat_warn = Off\nsession.referer_check =\nsession.entropy_length = 0\nsession.entropy_file =\nsession.cache_limiter = nocache\nsession.cache_expire = 180\nsession.use_trans_sid = 0\nsession.hash_function = 0\nsession.hash_bits_per_character = 5\nurl_rewriter.tags = \"a=href,area=href,frame=src,input=src,form=fakeentry\"\n\n[MSSQL]\nmssql.allow_persistent = On\nmssql.max_persistent = -1\nmssql.max_links = -1\nmssql.min_error_severity = 10\nmssql.min_message_severity = 10\nmssql.compatability_mode = Off\nmssql.secure_connection = Off\n\n[Assertion]\n\n[COM]\n\n[mbstring]\n\n[gd]\n\n[exif]\n\n[Tidy]\ntidy.clean_output = Off\n\n[soap]\nsoap.wsdl_cache_enabled=1\nsoap.wsdl_cache_dir=\"/var/tmp\"\nsoap.wsdl_cache_ttl=86400\n\n[sysvshm]\n\n[apc]\nextension=apcu.so\n\napc.enabled=1\napc.enable_cli=1\napc.shm_segments=1\napc.shm_size=64M\napc.num_files_hint=128\napc.user_entries_hint=8192\napc.ttl=3600\napc.gc_ttl=3600\napc.user_ttl=7200\napc.use_request_time=1\napc.cache_by_default=1\napc.filters=.*\\.phar\napc.mmap_file_mask=/dev/zero\napc.file_update_protection=2\napc.max_file_size=1M\napc.stat=1\napc.stat_ctime=0\napc.canonicalize=0\napc.write_lock=1\napc.report_autofilter=0\napc.rfc1867=0\napc.rfc1867_prefix =upload_\napc.rfc1867_name=APC_UPLOAD_PROGRESS\napc.rfc1867_freq=0\napc.rfc1867_ttl=3600\napc.include_once_override=0\napc.lazy_classes=0\napc.lazy_functions=0\napc.coredump_unmap=0\napc.file_md5=0\napc.preload_path\n\n[opcache]\n;zend_extension=opcache.so\n\nopcache.enable=1\nopcache.enable_cli=1\nopcache.memory_consumption=128\nopcache.interned_strings_buffer=8\nopcache.max_accelerated_files=4000\nopcache.blacklist_filename=/etc/php.d/opcache*.blacklist\nopcache.revalidate_freq=60\nopcache.fast_shutdown=1\n\n[memcached]\n;extension=memcached.so\n\n\nphp.ini \u3092\u30b3\u30d4\u30fc\u3059\u308b\n$ sudo cp -rf /etc/php.ini /etc/hhvm/php.ini\n\n\nmemcached \u306e\u8a2d\u5b9a\n\n\u8a2d\u5b9a\u3092\u78ba\u8a8d\n$ cat /etc/php.d/50-memcached.ini\n\n$ cat /etc/sysconfig/memcached\n\n\n\u8d77\u52d5\n$ sudo service memcached start && \\\nsudo chkconfig memcached on\n\n\nPHP-FPM \u3092\u8a2d\u5b9a\n\n\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u6210\n$ sudo mv /etc/php-fpm.conf /etc/php-fpm.conf_old && \\\nsudo vi /etc/php-fpm.conf\n\n\u4e0b\u8a18\u3092\u30da\u30fc\u30b9\u30c8\u3002\ninclude=/etc/php-fpm.d/*.conf\n\n[global]\npid = /var/run/php-fpm/php-fpm.pid\nerror_log = /var/log/php-fpm/error.log\n\n\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u6210\u3002\n$ sudo mv /etc/php-fpm.d/www.conf /etc/php-fpm.d/www.conf_old && \\\nsudo vi /etc/php-fpm.d/www.conf\n\n\u4ee5\u4e0b\u3092\u30da\u30fc\u30b9\u30c8\u3002\n[www]\nlisten = /var/run/php-fpm.sock\nlisten.owner = nginx\nlisten.group = nginx\nlisten.mode = 0666\n\nuser = nginx\ngroup = nginx\n\npm = dynamic\npm.max_children = 5\npm.start_servers = 1\npm.min_spare_servers = 1\npm.max_spare_servers = 4\npm.max_requests = 200\n\nrlimit_files = 131072\nrlimit_core = unlimited\n\nrequest_terminate_timeout = 90\nrequest_slowlog_timeout = 60\n\nslowlog = /var/log/php-fpm/www-slow.log\n\nphp_admin_value[error_log] = /var/log/php-fpm/www-error.log\nphp_admin_flag[log_errors] = on\nphp_admin_value[upload_max_filesize] = 4M\nphp_admin_value[post_max_size] = 4M\nphp_admin_value[max_execution_time] = 60\n\n\n\u8d77\u52d5\n$ sudo service php-fpm start && \\\nsudo chkconfig php-fpm on\n\n\nHHVM \u3092\u8d77\u52d5\n$ sed -i -e '$ahhvm --mode daemon --user nginx --group nginx --config /etc/hhvm/server.hdf -vServer.Type=fastcgi -vServer.FileSocket=/var/run/hhvm/hhvm.sock' /etc/rc.d/rc.local && \\\nhhvm --mode daemon --user nginx --config /etc/hhvm/server.hdf -vServer.Type=fastcgi -vServer.FileSocket=/var/run/hhvm/hhvm.sock\n\n# \u3053\u306e\u30b3\u30de\u30f3\u30c9\u306f\u8981\u3089\u306a\u3044\uff1f\n$ update-alternatives --install /usr/bin/php php /usr/local/hhvm/hphp/hhvm/hhvm 60\n\n$ sudo service hhvm start && \\\nsudo chkconfig hhvm on \n\n\nMySQL \u306e\u8d77\u52d5\n$ sudo service mysql start && \\\nsudo chkconfig mysql on\n\n\n\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u30eb\u30fc\u30c8\u306e\u4f5c\u6210\n$ sudo mkdir -m +w -p /var/www/vhosts/default/ && \\\nsudo chown -R nginx:nginx /var/www/vhosts/*\n\n\nWordPress \u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\nWP CLI \u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n$ sudo wget https://raw.github.com/wp-cli/builds/gh-pages/phar/wp-cli.phar -O /usr/bin/wp && \\\nsudo chmod +x /usr/bin/wp\n\n\nWordPress \u7528\u306e DB \u3092\u4f5c\u6210\n$ mysql -u root -p\n$ create database wordpress_db default character set utf8 collate utf8_general_ci;\n$ GRANT ALL PRIVILEGES ON wordpress_db.* TO wordpress_db@localhost IDENTIFIED BY 'wordpress_db' WITH GRANT OPTION;\n\n\nWordPress \u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\nroot \u30e6\u30fc\u30b6\u30fc\u3060\u3068\u30a8\u30e9\u30fc\u304c\u51fa\u308b\u306e\u3067\u6ce8\u610f\u3002\n$ wp core download --locale=ja --path='/var/www/vhosts/default/'\n$ cd /var/www/vhosts/default\n$ wp core config --dbname='wordpress_db' --dbuser='wordpress_db' --dbpass='wordpress_db'\n$ wp core install --url='192.168.30.10' --title='WordPress Test' --admin_name='admin' --admin_password='admin' --admin_email='admin@example.jp'\n\nroot \u30e6\u30fc\u30b6\u30fc\u306b\u623b\u308a\u3001\u5404\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306e\u6240\u6709\u8005\u3068\u30b0\u30eb\u30fc\u30d7\u3092\u5909\u66f4\u3002\n$ sudo chown -R nginx:nginx /var/www/vhosts/default/*\n\n\nNginx \u306e\u8d77\u52d5\n$ sudo service nginx start && \\\nsudo chkconfig nginx on\n\n\n\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\n\nExec-Shield \u3092\u6709\u52b9\u5316\n$ su - root\n$ echo 2 > /proc/sys/kernel/exec-shield\n$ exit\n\n\nLogWatch\n\u30ed\u30b0\u76e3\u8996\u30c4\u30fc\u30eb\u3002\n$ sudo yum -y install logwatch &&\\\nsudo logwatch --print\n\n\u5fc5\u8981\u306b\u5fdc\u3058\u3066 logwatch \u306e\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb /etc/logwatch/conf/logwatch.conf \u3092\u66f8\u304d\u63db\u3048\u308b\u3002\nLogwatch \u3092 CentOS \u306b\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\n\u30ed\u30b0\u76e3\u8996\u30c4\u30fc\u30eb logwatch \u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3068\u8a2d\u5b9a \u301c CentOS6\n\nDenyHosts\nSSH \u306e\u30d6\u30eb\u30fc\u30c8\u30d5\u30a9\u30fc\u30b9\u30a2\u30bf\u30c3\u30af\u5bfe\u7b56\u30c4\u30fc\u30eb\u3002\n$ sudo yum -y install denyhosts && \\\nsudo service denyhosts start && \\\nsudo chkconfig denyhosts on\n\n\nClam AntiVirus\n\u30aa\u30fc\u30d7\u30f3\u30bd\u30fc\u30b9\u3067\u958b\u767a\u30fb\u904b\u7528\u3055\u308c\u3066\u3044\u308b\u30a6\u30a3\u30eb\u30b9\u5bfe\u7b56\u30bd\u30d5\u30c8\u3002\n$ sudo yum -y --enablerepo=epel install clamd && \\\nsudo vi /etc/clamd.conf\n\n\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u304c\u958b\u3044\u305f\u3089\u3001\u300cUser clam\u300d\u3092\u300cUser root\u300d\u3078\u5909\u66f4\u3002\nClam AntiVirus \u3092\u8d77\u52d5\u3055\u305b\u308b\u3002\n$ sudo service clamd start && \\\nsudo chkconfig clamd on\n\n\u30a6\u30a4\u30eb\u30b9\u5b9a\u7fa9\u30d5\u30a1\u30a4\u30eb\u3092\u30a2\u30c3\u30d7\u30c7\u30fc\u30c8\u3002\n$ sudo freshclam\n\n\u30b9\u30b1\u30b8\u30e5\u30fc\u30eb\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u6210\u3002\n$ sudo vi /etc/cron.daily/virusscan\n\n\u4e0b\u8a18\u3092\u30da\u30fc\u30b9\u30c8\u3002\n#!/bin/bash\n\nPATH=/usr/bin:/bin\n\n# clamd update\nyum  --enablerepo=epel -y update clamd > /dev/null 2>&1\n\n# virus scan\nCLAMSCANTMP=`mktemp`\nclamscan --recursive --remove  / > $CLAMSCANTMP 2>&1\n[ ! -z \"$(grep FOUND$ $CLAMSCANTMP)\" ] && \\\n\n# when detect virus, send mail\ngrep FOUND$ $CLAMSCANTMP | mail -s \"Virus Found in `hostname`\" root\nrm -f $CLAMSCANTMP\n\n\u5b9f\u884c\u6a29\u9650\u3092\u4ed8\u4e0e\u3002\n$ sudo chmod +x /etc/cron.daily/virusscan\n\n\nWAF (Web Application Firewall)\nNginx \u306e\u5834\u5408\u3001ngx_pagespeed \u306a\u3069\u306e\u3088\u3046\u306b\u3001\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u304b\u3089\u30d3\u30eb\u30c9\u3057\u306a\u304f\u3066\u306f\u306a\u3089\u306a\u3044\u3002\n\u73fe\u5728\u8abf\u67fb\u4e2d\u3002\n\uff08WordPress \u3068\u4ef2\u826f\u304f\u3084\u308c\u308b\u306e\u3060\u308d\u3046\u304b\u30fb\u30fb\u30fb\u3002\uff09\n\nCentOS\u306bNginx\u3068ModSecurity\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\nModSecurity \u3092 nginx + passenger \u3067\n\n\n\u30d0\u30c3\u30af\u30a2\u30c3\u30d7\n$ sudo wget ftp://mondo.mirror.pclark.com/pub/mondorescue/rhel/6/x86_64/mondorescue.repo -O /etc/yum.repos.d/mondorescue.repo && \\\nsudo yum -y --enablerepo=mondorescue install mondo && \\\nsudo mkdir ~/backup\n\n\u30d0\u30c3\u30af\u30a2\u30c3\u30d7\u3092\u5b9f\u884c\u3002\n$ sudo mondoarchive -Oi -s 10000m -d ~/.backup -E ~/.backup -S /tmp -T /tmp -p `hostname`_`date +%Y%m%d`\n\n\u30d0\u30c3\u30af\u30a2\u30c3\u30d7\u30d5\u30a1\u30a4\u30eb\u3092\u30ed\u30fc\u30ab\u30eb\u306b\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3002\n$ scp -P 10022 -i ~/.ssh/conoha_rsa exampleuser@192.168.0.0:/home/exampleuser/.backup/v192-168-0-0.example.jp_20150829-1.iso Desktop\n\n\nSSL \u306e\u8a2d\u5b9a\n\nCSR \u3068\u79d8\u5bc6\u9375\u306e\u4f5c\u6210\nCSR \u30d5\u30a1\u30a4\u30eb\u306f SSL \u8a3c\u660e\u66f8\u8cfc\u5165\u7533\u8acb\u306e\u969b\u306b\u4f7f\u7528\u3057\u307e\u3059\u3002\n$ openssl req -nodes -newkey -sha256 rsa:2048 -nodes -keyout example.jp.`date +'%Y%m%d'`.key -out example.jp.`date +'%Y%m%d'`.csr -subj \"/C=JP/ST=Tokyo/L=Shibuya-ku/O=OrganizationUnitName/OU=-/CN=example.jp\"\n\n\n\u8a3c\u660e\u66f8\u306e\u4f5c\u6210\nNginx \u306e\u5834\u5408 ssl_certificate \u306b\u6307\u5b9a\u3059\u308b\u30d5\u30a1\u30a4\u30eb\u3067\u3059\u3002\n$ cat example_jp.crt \u30b5\u30fc\u30d0\u30fc\u8a3c\u660e\u66f8.crt \u4e2d\u9593\u8a3c\u660e\u66f8.crt \u30af\u30ed\u30b9\u30eb\u30fc\u30c8\u8a3c\u660e\u66f8.crt > example.jp.`date +'%Y%m%d'`.pem\n\n\nDH\u9375\u4ea4\u63db\u306b\u4f7f\u7528\u3059\u308b\u30d1\u30e9\u30e1\u30fc\u30bf\u30d5\u30a1\u30a4\u30eb\u306e\u4f5c\u6210\nNginx \u306e\u5834\u5408 ssl_dhparam \u306b\u6307\u5b9a\u3059\u308b\u30d5\u30a1\u30a4\u30eb\u3067\u3059\u3002\n$ openssl dhparam 2048 -out example.jp.dhparam.`date +'%Y%m%d'`.pem\n\n\nTLS Session Ticket \u306b\u4f7f\u7528\u3059\u308b\u9375\u306e\u4f5c\u6210\nNginx \u306e\u5834\u5408 ssl_session_ticket_key \u306b\u6307\u5b9a\u3059\u308b\u30d5\u30a1\u30a4\u30eb\u3067\u3059\u3002\n$ openssl rand 48 > example.jp.ticket.`date +'%Y%m%d'`.key\n\n\nOCSP Stapling \u306b\u4f7f\u7528\u3059\u308b\u30d1\u30e9\u30e1\u30fc\u30bf\u30d5\u30a1\u30a4\u30eb\u306e\u4f5c\u6210\nNginx \u306e\u5834\u5408 ssl_trusted_certificate \u306b\u6307\u5b9a\u3059\u308b\u30d5\u30a1\u30a4\u30eb\u3067\u3059\u3002\n$ cat \u4e2d\u9593\u8a3c\u660e\u66f8.crt \u30af\u30ed\u30b9\u30eb\u30fc\u30c8\u8a3c\u660e\u66f8.crt \u30eb\u30fc\u30c8\u8a3c\u660e\u66f8.crt > example.jp.trusted.`date +'%Y%m%d'`.pem\n\n\nGeoTrust \u30af\u30a4\u30c3\u30afSSL\u30d7\u30ec\u30df\u30a2\u30e0\n\u4e2d\u9593CA\u8a3c\u660e\u66f8\nhttps://www.geotrust.co.jp/resources/repository/intermediate.html\n\u30eb\u30fc\u30c8CA\u8a3c\u660e\u66f8\nhttp://www.geotrust.com/resources/root-certificates/index.html\n\n\u53c2\u8003\u30b5\u30a4\u30c8\nGenerate Mozilla Security Recommended Web Server Configuration Files\nSSL\u30c1\u30a7\u30c3\u30af\u30c4\u30fc\u30eb\nSSL Server Test\nGeoTrust SSL ToolBox\nSecurity/Server Side TLS\n\n\u53c2\u8003\u30b5\u30a4\u30c8\u4e00\u89a7\n\ndogmap.jp\nConoHa \u30d6\u30ed\u30b0\n\u30ec\u30f3\u30bf\u30eb\u30b5\u30fc\u30d0\u30fc\u30fb\u81ea\u5b85\u30b5\u30fc\u30d0\u30fc\u8a2d\u5b9a\u30fb\u69cb\u7bc9\u306e\u30d2\u30f3\u30c8\nCentOS6\u306bPHP5.6\u3092yum\u3067\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\nLinux\u6a19\u6e96\u6559\u79d1\u66f8\n\u8a55\u5224\u306e\u3055\u304f\u3089\u306eVPS\u3092\u4f7f\u3046\u3068\u304d\u306b\u6700\u521d\u306b\u3084\u3063\u3066\u304a\u304d\u305f\u3044\u3053\u3068(CentOS\u7de8)\n\u6700\u4f4e\u9650\u5fc5\u8981\u306a CentOS \u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u8a2d\u5b9a\n\n\n[\u304a\u540d\u524d.com \u306e VPS](http://www.onamae-server.com/vps/) \u306e [\u30e1\u30e2\u30ea 2G \u30d7\u30e9\u30f3](http://www.onamae-server.com/vps/kvm/order/#!plan=vps_check01) \u306b\u6a19\u6e96 OS \u306e CentOS 6.5 \u3092\u4f7f\u3063\u3066\u30b5\u30fc\u30d0\u30fc\u306e\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\u3092\u3057\u3066\u3044\u307e\u3059\u3002\n\n\u30a4\u30f3\u30d5\u30e9\u521d\u5fc3\u8005\u304c\u7e8f\u3081\u3066\u3044\u308b\u305f\u3081\u3001\u4fe1\u7528\u3057\u306a\u3044\u3067\u304f\u3060\u3055\u3044\uff08\u7b11\uff09\n\u3053\u306e\u8a18\u4e8b\u3092\u53c2\u8003\u306b\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\u3057\u305f\u3053\u3068\u306b\u3088\u3063\u3066\u88ab\u3063\u305f\u640d\u5bb3\u30fb\u640d\u5931\u306b\u5bfe\u3057\u3001\u3044\u304b\u306a\u308b\u5834\u5408\u3067\u3082\u4e00\u5207\u306e\u8cac\u4efb\u3092\u8ca0\u3044\u307e\u305b\u3093\u306e\u3067\u3054\u4e86\u627f\u304f\u3060\u3055\u3044\u3002\u3042\u304f\u307e\u3067\u3082\u81ea\u5df1\u8cac\u4efb\u3067\u304a\u9858\u3044\u3057\u307e\u3059\u3002\n\n\u30c4\u30c3\u30b3\u30df\u3084\u30a2\u30c9\u30d0\u30a4\u30b9\u3001\u30b3\u30e1\u30f3\u30c8\u3067\u304a\u5f85\u3061\u3057\u3066\u3044\u307e\u3059 !\n\n## CentOS \u306e\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\n\n### \u30a2\u30c3\u30d7\u30c7\u30fc\u30c8\n\n```bash\n$ yum clean all && \\\nyum -y update && \\\nyum clean all && \\\nyum -y upgrade && \\\nyum clean all && \\\ncat /etc/redhat-release\n```\n\n### \u65e5\u672c\u8a9e\u306b\u5bfe\u5fdc\n\n\u8a00\u8a9e\u30d1\u30c3\u30b1\u30fc\u30b8\u3092\u30b0\u30eb\u30fc\u30d7\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3002\n\n```bash\n$ yum -y groupinstall \"Japanese Support\"\n```\n\n\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3092\u7de8\u96c6\u3002\n\n```bash\n$ vi /etc/sysconfig/i18n\n```\n\n\u4e0b\u8a18\u306e\u3088\u3046\u306b\u5909\u66f4\u3002\n\n```\nLANG=\"ja_JP.UTF-8\"\nSUPPORTED=\"ja_JP.UTF-8:ja_JP:ja\"\nSYSFONT=\"latarcyrheb-sun16\"\n```\n\n\u8a2d\u5b9a\u3092\u53cd\u6620\u3055\u305b\u308b\u3002\n\n```bash\n$ source /etc/sysconfig/i18n\n```\n\n### vim \u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n```bash\n$ sudo yum -y install vim-enhanced && \\\nsudo mv /bin/vi /bin/vim-tiny && \\\nsudo ln -s /usr/bin/vim /bin/vi\n```\n\n#### \u30a8\u30a4\u30ea\u30a2\u30b9\u3092\u8ffd\u52a0\n\n```bash\n$ vi /etc/bashrc\n# alias\nalias vi='vim'\n\n$ source /etc/bashrc\n```\n\n#### \u884c\u756a\u53f7\u3092\u8868\u793a\n\n```bash\n$ vi /etc/vimrc\n```\n\n\u4e0b\u8a18\u3092\u8ffd\u52a0\u3002\n\n```\nset number\n```\n\n`/etc/vimrc` \u306f\u30b7\u30b9\u30c6\u30e0\u8a2d\u5b9a\u306a\u306e\u3067\u3001\u884c\u756a\u53f7\u3092\u8868\u793a\u3092\u8ffd\u52a0\u304f\u3089\u3044\u306b\u7559\u3081\u3066\u304a\u304f\u306e\u304c\u3088\u3044\u3002\n\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u306e\u5834\u6240\u306f\u3001\u4ee5\u4e0b\u306e\u901a\u308a\u3002\n\n```\n   \u30b7\u30b9\u30c6\u30e0 vimrc: \"/etc/vimrc\"\n\u3000   \u30e6\u30fc\u30b6 vimrc: \"$HOME/.vimrc\"\n\u7b2c 2 \u30e6\u30fc\u30b6 vimrc: \"~/.vim/vimrc\"\n\u3000    \u30e6\u30fc\u30b6 exrc: \"$HOME/.exrc\"\n```\n\n#### Nginx \u30d5\u30a1\u30a4\u30eb\u3092 Syntaxhighlight \u3059\u308b\u3088\u3046\u306b\u3059\u308b\n\nnginx.vim \u30d5\u30a1\u30a4\u30eb\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3057\u3001\u30d5\u30a1\u30a4\u30eb\u30bf\u30a4\u30d7\u3092\u8ffd\u52a0\u3059\u308b\u3002\n\n\n```bash\n$ sudo mkdir -p ~/.vim/syntax && \\\ncd ~/.vim/syntax && \\\nsudo wget https://raw.githubusercontent.com/evanmiller/nginx-vim-syntax/master/syntax/nginx.vim && \\\nvi ~/.vim/filetype.vim\n```\n\n\u4e0b\u8a18\u3092\u30da\u30fc\u30b9\u30c8\u3002\n\n```\nau BufRead,BufNewFile /etc/nginx/*,/etc/nginx_old/*,/usr/local/nginx/conf/* if &ft == '' | setfiletype nginx | endif\n```\n\n\n### \u4f5c\u696d\u7528\u30e6\u30fc\u30b6\u30fc\u3092\u4f5c\u6210\n\n```bash\n$ useradd exampleuser && \\\npasswd exampleuser && \\\nusermod -G wheel exampleuser && \\\nid exampleuser\n```\n\n#### \u4f5c\u696d\u7528\u30e6\u30fc\u30b6\u30fc\u306e\u516c\u958b\u9375\u30d5\u30a1\u30a4\u30eb\u306e\u4f5c\u6210\n\n\u30ed\u30fc\u30ab\u30eb PC \u3067\u3001\u79d8\u5bc6\u9375\u3068\u516c\u958b\u9375\u306e\u30da\u30a2\u30ad\u30fc\u3092\u4f5c\u6210\u3002\n\u203b conoha \u306e\u90e8\u5206\u306f\u9069\u5f53\u306b\u8aad\u307f\u66ff\u3048\u3066\u304f\u3060\u3055\u3044\u3002\n\n```bash\n# \u79d8\u5bc6\u9375\u3092\u751f\u6210\n$ openssl genrsa -des3 -out ~/.ssh/conoha_rsa 2048\n\n# \u30d1\u30fc\u30df\u30c3\u30b7\u30e7\u30f3\u306e\u5909\u66f4\n$ chmod 600 ~/.ssh/conoha_rsa\n\n# \u516c\u958b\u9375\u3092\u751f\u6210\n$ ssh-keygen -y -f ~/.ssh/conoha_rsa > ~/.ssh/conoha_rsa.pub\n\n# \u9375\u3092\u767b\u9332\u3059\u308b\n$ ssh-add -K ~/.ssh/conoha_rsa\n\n# \u516c\u958b\u9375\u3092\u30af\u30ea\u30c3\u30d7\u30dc\u30fc\u30c9\u306b\u30b3\u30d4\u30fc\n$ pbcopy < ~/.ssh/conoha_rsa.pub\n```\n\n#### \u30ea\u30e2\u30fc\u30c8\u30b5\u30fc\u30d0\u30fc\u306b\u516c\u958b\u9375\u3092\u8a2d\u7f6e\n\n```bash\n$ sudo mkdir -p /home/exampleuser/.ssh/ && \\\nsudo vi /home/exampleuser/.ssh/authorized_keys\n```\n\n\u3053\u3053\u3067\u3001\u5148\u307b\u3069\u30af\u30ea\u30c3\u30d7\u30dc\u30fc\u30c9\u306b\u30b3\u30d4\u30fc\u3057\u305f\u516c\u958b\u9375\u3092\u30da\u30fc\u30b9\u30c8\u3057\u4fdd\u5b58\u3002\n\u4fdd\u5b58\u5f8c\u3001.ssh \u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3001authorized_keys \u306e\u6240\u6709\u6a29\u3084\u30a2\u30af\u30bb\u30b9\u6a29\u3092\u5909\u3048\u308b\u3002\n\n```bash\n$ sudo chown exampleuser:exampleuser /home/exampleuser/.ssh/ && \\\nsudo chmod 700 /home/exampleuser/.ssh/ && \\\nsudo chown exampleuser:exampleuser /home/exampleuser/.ssh/authorized_keys && \\\nsudo chmod 400 /home/exampleuser/.ssh/authorized_keys\n```\n\n### wheel \u30b0\u30eb\u30fc\u30d7\u306e\u30e1\u30f3\u30d0\u30fc\u306e\u307f root \u306b\u306a\u308c\u308b\u3088\u3046\u306b\u3059\u308b\n\n```bash\n$ vi /etc/pam.d/su\nauth required pam_wheel.so use_uid <- \u30b3\u30e1\u30f3\u30c8\u30a2\u30a6\u30c8\u3092\u5916\u3059\n\n$ vi /etc/login.defs\nSU_WHEEL_ONLY yes                  <-\u6700\u5f8c\u306e\u884c\u306b\u8ffd\u52a0\n```\n\n### sudo \u30b3\u30de\u30f3\u30c9\u306e\u8a2d\u5b9a\n\n```bash\n$ visudo\n# %wheel ALL=(ALL) ALL            <- sudo \u30b3\u30de\u30f3\u30c9\u306b\u30d1\u30b9\u30ef\u30fc\u30c9\u3092\u5fc5\u8981\u3068\u3059\u308b\u5834\u5408 # \u3092\u5916\u3059\n# %wheel ALL=(ALL) NOPASSWD: ALL  <- sudo \u30b3\u30de\u30f3\u30c9\u306b\u30d1\u30b9\u30ef\u30fc\u30c9\u3092\u5fc5\u8981\u3068\u3057\u306a\u3044\u5834\u5408 # \u3092\u5916\u3059\n```\n\n### \u30ed\u30b0\u30a4\u30f3\u8a8d\u8a3c\u306e\u65b9\u6cd5\u3068 SSH \u30dd\u30fc\u30c8\u756a\u53f7\u3092\u5909\u66f4\n\n```bash\n$ vi /etc/ssh/sshd_config\nPort 10022                               <- SSH \u306e\u30dd\u30fc\u30c8\u756a\u53f7\u3092\u5909\u66f4\nProtocol 2                               <- SSH \u306e\u30d7\u30ed\u30c8\u30b3\u30eb\u3092 SSH2 \u306e\u307f\u306b\u3059\u308b\nPermitRootLogin no                       <- root \u3067\u306e\u30ed\u30b0\u30a4\u30f3\u3092\u62d2\u5426\nPubkeyAuthentication yes                 <- \u516c\u958b\u9375\u3067\u306e\u8a8d\u8a3c\u3092\u8a31\u53ef\nAuthorizedKeysFile .ssh/authorized_keys  <- \u516c\u958b\u9375\u306e\u8a2d\u7f6e\u5834\u6240\u3092\u30e6\u30fc\u30b6\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u914d\u4e0b\u306e .ssh/authorized_keys \u306b\u5909\u66f4\nIgnoreUserKnownHosts yes                 <- /etc/ssh_known_hosts \u307e\u305f\u306f ~/.ssh/known_hosts \u3092\u7121\u8996\nPermitEmptyPasswords on                  <- \u30d1\u30b9\u30ef\u30fc\u30c9\u304c\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u306a\u3044\u30a2\u30ab\u30a6\u30f3\u30c8\u3092\u62d2\u5426\nPasswordAuthentication on                <- \u30d1\u30b9\u30ef\u30fc\u30c9\u8a8d\u8a3c\u3092\u62d2\u5426\nAllowUsers exampleuser                   <- \u30ed\u30b0\u30a4\u30f3\u8a31\u53ef\u3059\u308b\u30e6\u30fc\u30b6\u30fc\n```\n\n\u8a2d\u5b9a\u3092\u53cd\u6620\u3055\u305b\u308b\u3002\n\n```bash\n$ service sshd restart\n```\n\n### \u30d5\u30a1\u30a4\u30e4\u30fc\u30a6\u30a9\u30fc\u30eb\u306e\u8a2d\u5b9a\uff08\u30dd\u30fc\u30c8\u756a\u53f7\u306e\u5909\u66f4\uff09\n\niptables \u304c\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u3066\u3044\u308b\u304b\u78ba\u8a8d\u3059\u308b\u3002\n\n```bash\n$ rpm -qa iptables\n\u30d0\u30fc\u30b8\u30e7\u30f3\u60c5\u5831\u304c\u8868\u793a\u3055\u308c\u308c\u3070\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u3066\u3044\u308b\n```\n\niptables \u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\u3002\n\n```bash\n$ yum -y install iptables iptables-ipv6\n```\n\n#### iptables \u306e\u8a2d\u5b9a\n\n```bash\n$ vi /etc/sysconfig/iptables\n$ VGd\n```\n\n\u4e0b\u8a18\u3092\u30da\u30fc\u30b9\u30c8\u3002\n\n```\n*filter\n:INPUT   ACCEPT [0:0]\n:FORWARD ACCEPT [0:0]\n:OUTPUT  ACCEPT [0:0]\n:RH-Firewall-1-INPUT - [0:0]\n\n-A INPUT -j RH-Firewall-1-INPUT\n-A FORWARD -j RH-Firewall-1-INPUT\n-A RH-Firewall-1-INPUT -i lo -j ACCEPT\n-A RH-Firewall-1-INPUT -p icmp --icmp-type any -j ACCEPT\n-A RH-Firewall-1-INPUT -p 50 -j ACCEPT\n-A RH-Firewall-1-INPUT -p 51 -j ACCEPT\n-A RH-Firewall-1-INPUT -p udp --dport 5353 -d 224.0.0.251 -j ACCEPT\n-A RH-Firewall-1-INPUT -p udp -m udp --dport 631 -j ACCEPT\n-A RH-Firewall-1-INPUT -p tcp -m tcp --dport 631 -j ACCEPT\n-A RH-Firewall-1-INPUT -m state --state ESTABLISHED,RELATED -j ACCEPT\n\n# SSH, HTTP, SSL\n-A RH-Firewall-1-INPUT -m state --state NEW -m tcp -p tcp --dport 10022 -j ACCEPT\n-A RH-Firewall-1-INPUT -m state --state NEW -m tcp -p tcp --dport 80    -j ACCEPT\n-A RH-Firewall-1-INPUT -m state --state NEW -m tcp -p tcp --dport 443   -j ACCEPT\n\n-A RH-Firewall-1-INPUT -j REJECT --reject-with icmp-host-prohibited\n\nCOMMIT\n```\n\n\u8a2d\u5b9a\u3092\u53cd\u6620\u3055\u305b\u308b\u3002\n\n```bash\n$ service iptables restart\n```\n\n#### ip6tables \u306e\u8a2d\u5b9a\n\n```bash\n$ vi /etc/sysconfig/ip6tables\n$ VGd\n```\n\n\u4e0b\u8a18\u3092\u30da\u30fc\u30b9\u30c8\u3002\n\n```bash\n*filter :INPUT ACCEPT [0:0]\n:FORWARD ACCEPT [0:0]\n:OUTPUT ACCEPT [0:0]\n:RH-Firewall-1-INPUT - [0:0]\n\n-A INPUT -j RH-Firewall-1-INPUT\n-A FORWARD -j RH-Firewall-1-INPUT\n-A RH-Firewall-1-INPUT -i lo -j ACCEPT\n-A RH-Firewall-1-INPUT -p icmpv6 -j ACCEPT\n-A RH-Firewall-1-INPUT -p 50 -j ACCEPT\n-A RH-Firewall-1-INPUT -p tcp -m tcp --dport 51 -j ACCEPT\n-A RH-Firewall-1-INPUT -p udp -m udp --dport 51 -j ACCEPT\n-A RH-Firewall-1-INPUT -p udp --dport 5353 -d ff02::fb -j ACCEPT\n-A RH-Firewall-1-INPUT -p udp -m udp --dport 631 -j ACCEPT\n-A RH-Firewall-1-INPUT -p tcp -m tcp --dport 631 -j ACCEPT\n-A RH-Firewall-1-INPUT -m state --state ESTABLISHED,RELATED -j ACCEPT\n\n# SSH, HTTP, SSL\n-A RH-Firewall-1-INPUT -m state --state NEW -m tcp -p tcp --dport 10022 -j ACCEPT\n-A RH-Firewall-1-INPUT -m state --state NEW -m tcp -p tcp --dport 80    -j ACCEPT\n-A RH-Firewall-1-INPUT -m state --state NEW -m tcp -p tcp --dport 443   -j ACCEPT\n-A RH-Firewall-1-INPUT -m state --state NEW -m udp -p udp --dport 546 --sport 547 -s fe80::/10 -d fe80::/10 -j ACCEPT\n\n-A RH-Firewall-1-INPUT -j REJECT --reject-with icmp6-adm-prohibited\n\nCOMMIT\n```\n\n\u8a2d\u5b9a\u3092\u53cd\u6620\u3055\u305b\u308b\u3002\n\n```bash\n$ service ip6tables restart\n```\n\n### \u65b0\u3057\u304f\u4f5c\u6210\u3057\u305f\u30e6\u30fc\u30b6\u30fc\u3067\u30b5\u30fc\u30d0\u30fc\u306b\u30ed\u30b0\u30a4\u30f3\u3067\u304d\u308b\u304b\u78ba\u8a8d\n\n\u3053\u306e\u4f5c\u696d\u6642\u306f\u3001\u30ed\u30b0\u30a4\u30f3\u4e2d\u306e root \u30e6\u30fc\u30b6\u30fc\u306f\u7d76\u5bfe\u306b\u30ed\u30b0\u30a2\u30a6\u30c8\u3055\u305b\u306a\u3044\u3053\u3068\u3002\n\u30ed\u30b0\u30a2\u30a6\u30c8\u3057\u3066\u3057\u307e\u3046\u3068\u3001\u4eca\u307e\u3067\u306e\u8a2d\u5b9a\u306b\u8aa4\u308a\u304c\u3042\u3063\u305f\u5834\u5408\u306b\u53d6\u308a\u8fd4\u3057\u304c\u3064\u304b\u306a\u304f\u306a\u308b\u3002\n\n* ssh or sftp \u30ed\u30b0\u30a4\u30f3\u304c\u3067\u304d\u308b\n* su or sudo \u30b3\u30de\u30f3\u30c9\u304c\u4f7f\u7528\u3067\u304d\u308b\n\n\u4e0a\u8a18 2 \u70b9\u3092\u78ba\u8a8d\u3059\u308b\u3002\n\u5931\u6557\u3059\u308b\u5834\u5408\u306f\u8a2d\u5b9a\u304c\u9593\u9055\u3063\u3066\u3044\u308b\u3002\n2 \u70b9\u306e\u78ba\u8a8d\u304c\u6210\u529f\u3057\u305f\u5834\u5408\u3001\u30ed\u30b0\u30a4\u30f3\u4e2d\u3060\u3063\u305f root \u30e6\u30fc\u30b6\u30fc\u3092\u30ed\u30b0\u30a2\u30a6\u30c8\u3055\u305b\nroot \u30e6\u30fc\u30b6\u30fc\u3067\u30ed\u30b0\u30a4\u30f3\u3067\u304d\u306a\u3044\u4e8b\u3092\u78ba\u8a8d\u3059\u308b\u3002\n\n\u4ee5\u964d\u306e\u4f5c\u696d\u306f\u65b0\u898f\u306b\u4f5c\u6210\u3057\u305f\u30e6\u30fc\u30b6\u30fc\u3067\u4f5c\u696d\u3092\u884c\u3046\u3002\n\n### \u4e0d\u8981\u306a\u30c7\u30fc\u30e2\u30f3\u3092\u505c\u6b62\n\n\u4e0b\u8a18\u30b3\u30de\u30f3\u30c9\u3067\u8d77\u52d5\u4e2d\u306e\u30c7\u30fc\u30e2\u30f3\u3092\u78ba\u8a8d\u3057\u4e0d\u8981\u306a\u30b5\u30fc\u30d3\u30b9\u3092\u505c\u6b62\u3055\u305b\u308b\u3002\n\n```bash\n$ chkconfig --list | grep 3:on\n```\n\n[acpid](http://qiita.com/RentalCat__/items/862d0ec075e97ae52b52#2-2)\n\u30db\u30b9\u30c8\u5074\u304b\u3089\u30b7\u30e3\u30c3\u30c8\u30c0\u30a6\u30f3\u3067\u304d\u306a\u304f\u306a\u308b\u306e\u3067 on \u306b\u3057\u3066\u304a\u304f\u3002\n\u307e\u305f\u3001\u30ab\u30b9\u30bf\u30e0OS \u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u305f\u5834\u5408\u306f acpid \u304c\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u3066\u3044\u308b\u304b\u78ba\u8a8d\u3059\u308b\u3002\n> [Conoha\u306e\u30ab\u30b9\u30bf\u30e0OS\u306bacpid\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb](http://www.yubaz.com/?cat=4)\n\n[blk-availability](http://qiita.com/RentalCat__/items/862d0ec075e97ae52b52#2-5)\n\n```bash\n$ sudo service blk-availability stop && \\\nsudo chkconfig blk-availability off\n```\n\n[cpuspeed](http://qiita.com/RentalCat__/items/862d0ec075e97ae52b52#2-6)\n\n```bash\n$ sudo service cpuspeed stop && \\\nsudo chkconfig cpuspeed off\n```\n\n[haldaemon](http://qiita.com/RentalCat__/items/862d0ec075e97ae52b52#2-8)\n\n```bash\n$ sudo service haldaemon stop && \\\nsudo chkconfig haldaemon off\n```\n\n[mdmonitor](http://qiita.com/RentalCat__/items/862d0ec075e97ae52b52#2-14)\n\n```bash\n$ sudo service mdmonitor stop && \\\nsudo chkconfig mdmonitor off\n```\n\n[messagebus](http://qiita.com/RentalCat__/items/862d0ec075e97ae52b52#2-15)\n\n```bash\n$ sudo service messagebus stop && \\\nsudo chkconfig messagebus off\n```\n\n[netfs](http://qiita.com/RentalCat__/items/862d0ec075e97ae52b52#2-17)\n\n```bash\n$ sudo service netfs stop && \\\nsudo chkconfig netfs off\n```\n\n[quota_nld](http://qiita.com/RentalCat__/items/862d0ec075e97ae52b52#2-23)\n\n```bash\n$ sudo service quota_nld stop && \\\nsudo chkconfig quota_nld off\n```\n\n[rdisc](http://qiita.com/RentalCat__/items/862d0ec075e97ae52b52#2-24)\n\n```bash\n$ sudo service rdisc stop && \\\nsudo chkconfig rdisc off\n```\n\n[svnserve](http://qiita.com/RentalCat__/items/862d0ec075e97ae52b52#2-31)\n\n```bash\n$ sudo service svnserve stop && \\\nsudo chkconfig svnserve off\n```\n\n[udev-post](http://qiita.com/RentalCat__/items/862d0ec075e97ae52b52#2-33)\n\n```bash\n$ sudo service udev-post stop && \\\nsudo chkconfig udev-post off\n```\n\n[yum-updateonboot](http://qiita.com/RentalCat__/items/862d0ec075e97ae52b52#2-34)\n\n```bash\n$ sudo service yum-updateonboot stop && \\\nsudo chkconfig yum-updateonboot off\n```\n\nyum-updatesd\n\u203b yum-cron \u3092\u4f7f\u7528\u3059\u308b\u305f\u3081\u505c\u6b62\u3055\u305b\u308b\u3002\n\n```bash\n$ sudo service yum-updatesd stop && \\\nsudo chkconfig yum-updatesd off\n```\n\n### yum \u306e\u81ea\u52d5\u30a2\u30c3\u30d7\u30c7\u30fc\u30c8\n\n```bash\n$ sudo yum -y install yum-cron\n```\n\nyum-cron \u8a2d\u5b9a\u65b9\u6cd5\u306f\u3053\u3061\u3089\u306e\u8a18\u4e8b\u3067 !\n[yum \u3092\u4f7f\u3063\u3066 \u30b7\u30b9\u30c6\u30e0\u30a2\u30c3\u30d7\u30c7\u30fc\u30c8\u3092\u884c\u3046 (\u81ea\u52d5\u5316\u3082)](http://server-setting.info/centos/firststep.html)\n\n#### \u30a2\u30c3\u30d7\u30c7\u30fc\u30c8\u4e0d\u8981\u306a\u30d1\u30c3\u30b1\u30fc\u30b8\u3092\u6307\u5b9a\n\n```bash\n$ vi /etc/yum.conf\n````\n\n\u4e0b\u8a18\u3092\u30da\u30fc\u30b9\u30c8\u3002\n\n```bash\n[main]\nexclude=gcc* kde* openssh* kernel* php* mysql*\n````\n\n#### yum-cron \u306e\u8a2d\u5b9a\n\n```bash\n$ vi /etc/sysconfig/yum-cron\n```\n\n#### yum-cron \u306e\u8d77\u52d5\n\n```bash\n$ sudo service yum-cron start\n$ sudo chkconfig yum-cron on\n```\n\n### TCP \u30ab\u30fc\u30cd\u30eb\u30d1\u30e9\u30e1\u30fc\u30bf\u306e\u5909\u66f4\n\nipv6 \u304c\u4e0d\u8981\u3067\u3042\u308c\u3070\u3001\u305d\u306e\u8fba\u308a\u306f\u5404\u3005\u8abf\u7bc0\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n```bash\nsysctl -w vm.swappiness=0 && \\\nsysctl -w net.ipv4.ip_local_port_range=\"18000 65535\" && \\\nsysctl -w net.ipv4.tcp_tw_reuse=1 && \\\nsysctl -w net.ipv4.tcp_fin_timeout=10 && \\\nsysctl -w net.ipv4.tcp_max_syn_backlog=1024 && \\\nsysctl -w net.core.somaxconn=65535 && \\\nsysctl -w net.ipv6.conf.all.disable_ipv6=1 && \\\nsysctl -w net.ipv6.conf.default.disable_ipv6=1 && \\\nsysctl -w net.ipv6.conf.lo.disable_ipv6=1\n```\n\n\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u306e\u7de8\u96c6\u3002\n\n```bash\n$ sudo cp /etc/sysctl.conf /etc/sysctl.conf_old && \\\nsudo vi /etc/sysctl.conf\n```\n\n\u4e0b\u8a18\u3092\u6700\u5f8c\u306e\u884c\u306b\u8ffd\u52a0\u3002\n\n```\nvm.swappiness = 0\nnet.ipv4.ip_local_port_range = 18000 65535\nnet.ipv4.tcp_tw_reuse = 1\nnet.ipv4.tcp_fin_timeout = 10\nnet.ipv4.tcp_max_syn_backlog = 1024\nnet.core.somaxconn = 65535\nnet.ipv6.conf.all.disable_ipv6 = 1\nnet.ipv6.conf.default.disable_ipv6 = 1\nnet.ipv6.conf.lo.disable_ipv6 = 1\n```\n\n\u8a2d\u5b9a\u3092\u53cd\u6620\u3055\u305b\u308b\u3002\n\n```bash\n$ sysctl -p\n```\n\n**\u53c2\u8003**\n[Nginx\u306e\u30d1\u30d5\u30a9\u30fc\u30de\u30f3\u30b9\u3092\u6975\u9650\u306b\u3059\u308b\u305f\u3081\u306e\u8003\u5bdf](http://qiita.com/iwai/items/1e29adbdd269380167d2)\n[\u30ed\u30fc\u30ab\u30eb\u30dd\u30fc\u30c8\u3092\u98df\u3044\u3064\u3076\u3057\u3066\u3044\u305f\u8a71](http://d.hatena.ne.jp/download_takeshi/20091013/1255443592)\n[Linux\u30ab\u30fc\u30cd\u30eb\u30d1\u30e9\u30e1\u30fc\u30bf\u4e00\u89a7\u30fb\u6a19\u6e96\u8a2d\u5b9a\uff08CentOS 6\uff09](http://hesonogoma.com/linux/kernel_parameter_list_centos6.html)\n\n### prelink \u3092\u7121\u52b9\u5316\n\n```bash\n$ sudo vi /etc/sysconfig/prelink\nPRELINKING=no\n\n$ sudo /usr/sbin/prelink -ua\n```\n\n### SELinux \u3092\u7121\u52b9\u5316\n\n```bash\n$ sudo vi /etc/selinux/config\nSELINUX=disabled\n```\n\n### root \u5b9b\u306e\u30e1\u30fc\u30eb\u3092\u8ee2\u9001\u3059\u308b\n\n```bash\n$ sudo sed -i '/^root:/d' /etc/aliases && \\\nsudo vi /etc/aliases\n```\n\n\u300c# Person who should get root's mail\u300d\u306e\u4e0b\u306b\u3042\u308b\u300croot:\u300d\u306e\u5024\u3092\u66f8\u304d\u63db\u3048\u308b\u3002\n\n```bash\nroot: hoge@example.com\n```\n\n\u8a2d\u5b9a\u3092\u53cd\u6620\u3055\u305b\u308b\u3002\n\n```bash\n$ sudo newaliases && \\\nsudo echo test | mail root\n```\n\n### \u30ec\u30dd\u30b8\u30c8\u30ea\u306e\u8ffd\u52a0\n\n```bash\n$ rpm --import http://dl.fedoraproject.org/pub/epel/RPM-GPG-KEY-EPEL-6 && \\\nrpm -ivh http://dl.fedoraproject.org/pub/epel/6/x86_64/epel-release-6-8.noarch.rpm\n\n$ rpm --import http://rpms.famillecollet.com/RPM-GPG-KEY-remi && \\\nrpm -ivh http://rpms.famillecollet.com/enterprise/remi-release-6.rpm\n\n$ rpm --import https://yum.mariadb.org/RPM-GPG-KEY-MariaDB && \\\nvi /etc/yum.repos.d/mariadb.repo\n\n# \u4ee5\u4e0b\u3092\u8a18\u8ff0\n[mariadb]\nname = MariaDB\nbaseurl = http://yum.mariadb.org/10.1.6/centos6-amd64\nenabled=0\ngpgkey=https://yum.mariadb.org/RPM-GPG-KEY-MariaDB\ngpgcheck=1\n```\n\n## \u30e9\u30a4\u30d6\u30e9\u30ea\u3092\u8af8\u3005\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n```bash\n# $ yum -y install http://vault.centos.org/6.5/cr/x86_64/Packages/kernel-devel-2.6.32-504.el6.x86_64.rpm\n\n# \u304a\u540d\u524d.com VPS \u6a19\u6e96OS CentOS6.5 \u3067\u306f\u4e00\u65e6 remove\n$ yum -y remove libyaml libyaml-devel\n\n$ yum -y install \\\n    boost-devel \\\n    cmake cmake-devel \\\n    gperf gperf-devel \\\n    git git-devel \\\n    libmemcached libmemcached-devel \\\n    libevent libevent-devel \\\n    libcurl libcurl-devel \\\n    libxml2 libxml2-devel \\\n    libxslt libxslt-devel \\\n    libicu libicu-devel \\\n    libcap libcap-devel \\\n    libedit libedit-devel \\\n    libgcc libgcc.i686 \\\n    libjpeg-turbo libjpeg-turbo-devel \\\n    libpng libpng-devel \\\n    libyaml libyaml-devel \\\n    gcc-c++ \\\n    glibc-devel glibc-devel.i686 \\\n    unixODBC unixODBC-devel \\\n    sqlite sqlite-devel \\\n    expat expat-devel \\\n    bzip2 bzip2-devel \\\n    openssl openssl-devel \\\n    openldap openldap-devel \\\n    readline readline-devel \\\n    elfutils-libelf elfutils-libelf-devel \\\n    binutils binutils-devel \\\n    freetype freetype-devel \\\n    ImageMagick ImageMagick-devel \\\n    gzip gzip-devel \\\n    tar tar-devel \\\n    perl perl-devel \\\n    zip zip-devel \\\n    unzip unzip-devel \\\n    wget wget-devel\n\n$ yum -y --enablerepo=epel install \\\n    libmcrypt libmcrypt-devel \\\n    gperftools gperftools-devel\n\n$ yum -y install http://pkgrepo.linuxtech.net/el6/release/x86_64/liblcms2-2.4-1.el6.x86_64.rpm\n\n$ yum -y install --enablerepo=epel,remi make pcre pcre-devel gd-devel zlib-devel GeoIP-devel libmemcache automake autoconf re2c\n\n# \u9b3c\u8eca \u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n$ cd /tmp && \\\nsudo wget http://www.geocities.jp/kosako3/oniguruma/archive/onig-5.9.5.tar.gz -O onig-current.tar.gz && \\\nsudo mkdir onig-current && \\\ntar -zxvf onig-current.tar.gz -C /tmp/onig-current --strip-components=1 && \\\ncd ./onig-current && \\\nsudo ./configure && sudo make && sudo make install && \\\nrm -rf /tmp/onig-current.tar.gz && \\\nrm -rf /tmp/onig-current/\n```\n\n## OPcache\u3001Memcached\u3001PHP \u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n```bash\nyum -y install --enablerepo=remi,remi-php56 \\\n    gd-last gd-devel \\\n    php php-devel \\\n    php-common \\\n    php-mbstring \\\n    php-pdo \\\n    php-cli \\\n    php-gd \\\n    php-fpm \\\n    php-mysql php-mysqlnd \\\n    php-xml \\\n    php-pear php-pear-DB php-pear-Auth-* php-pecl-crypto \\\n    php-odbc \\\n    php-xmlrpc \\\n    php-mcrypt \\\n    php-soap \\\n    php-tidy \\\n    php-opcache \\\n    php-pecl-memcached memcached\n```\n\n## APCu \u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n```bash\n$ cd /tmp/ && \\\nsudo wget https://github.com/krakjoe/apcu/archive/v4.0.7.tar.gz -O apcu-current.tar.gz && \\\nsudo mkdir apcu-current && \\\nsudo tar -zxvf apcu-current.tar.gz -C /tmp/apcu-current --strip-components=1 && \\\ncd /tmp/apcu-current && \\\nphpize && \\\nsudo ./configure && sudo make && sudo make install && \\\nrm -rf /tmp/apcu-current.tar.gz && \\\nrm -rf /tmp/apcu-current/\n```\n\n## MariaDB \u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n```bash\n$ yum -y install --enablerepo=mariadb \\\n    MariaDB-devel \\\n    MariaDB-client \\\n    MariaDB-server\n```\n\n### MariaDB \u3092\u8d77\u52d5\n\n```bash\n$ service mysql start\n```\n\n### MariaDB \u306e\u521d\u671f\u8a2d\u5b9a\n\n```bash\n$ mysql_secure_installation\n\nEnter current password for root (enter for none):  <- ENTER\nSet root password? [Y/n]                           <- ENTER\nNew password:                                      <- \u30d1\u30b9\u30ef\u30fc\u30c9\u3092\u5165\u529b\nRe-enter new password:                             <- \u30d1\u30b9\u30ef\u30fc\u30c9\u3092\u518d\u5165\u529b\nRemove anonymous users? [Y/n]                      <- ENTER\nDisallow root login remotely? [Y/n]                <- ENTER\nRemove test database and access to it? [Y/n]       <- ENTER\nReload privilege tables now? [Y/n]                 <- ENTER\n```\n\n### MariaDB \u3092\u4e00\u65e6\u7d42\u4e86\u3055\u305b\u308b\n\n```bash\n$ service mysql stop\n```\n\n### \u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u306e\u4f5c\u6210\n\n\u30b5\u30f3\u30d7\u30eb\u30d5\u30a1\u30a4\u30eb\u3092\u30b3\u30d4\u30fc\u3059\u308b\u3002\n\n```bash\n$ sudo cp /usr/share/mysql/my-medium.cnf /etc/my.cnf.d/my.cnf\n```\n\n|\u30b5\u30f3\u30d7\u30eb\u30d5\u30a1\u30a4\u30eb\u306e\u5834\u6240|\u7528\u9014|\n|:----|:----|\n|/usr/share/mysql/my-small.cnf|64MB RAM \u4ee5\u4e0b\u306e\u5c0f\u898f\u6a21\u30b5\u30fc\u30d0\u30fc\u5411\u3051|\n|/usr/share/mysql/my-medium.cnf|32\u301c64MB RAM \u306e MySQL \u5c02\u7528\u30b5\u30fc\u30d0\u30fc\u3001\u307e\u305f\u306f 128MB RAM \u7a0b\u5ea6\u306e\u30b5\u30fc\u30d0\u30fc\u5411\u3051|\n|/usr/share/mysql/my-large.cnf|512MB RAM \u7a0b\u5ea6\u306e MySQL \u5c02\u7528\u30b5\u30fc\u30d0\u30fc\u5411\u3051|\n|/usr/share/mysql/my-huge.cnf|1\uff5e2GB RAM \u7a0b\u5ea6\u306e MySQL \u5c02\u7528\u30b5\u30fc\u30d0\u30fc\u5411\u3051|\n|/usr/share/mysql/my-innodb-heavy-4G.cnf|4GB RAM \u7a0b\u5ea6\u3067 InnoDB \u30b9\u30c8\u30ec\u30fc\u30b8\u30a8\u30f3\u30b8\u30f3\u306e\u307f\u3092\u4f7f\u7528\u3059\u308b\u5927\u898f\u6a21 MySQL \u5c02\u7528\u30b5\u30fc\u30d0\u30fc\u5411\u3051|\n\n#### \u30ab\u30b9\u30bf\u30de\u30a4\u30ba\u8a2d\u5b9a\u3092\u8ffd\u52a0\n\n```bash\n$ sudo mv /etc/my.cnf.d/server.cnf /etc/my.cnf.d/server.cnf_old && \\\nsudo vi /etc/my.cnf.d/server.cnf\n```\n\n\u4e0b\u8a18\u3092\u30da\u30fc\u30b9\u30c8\u3002\n\n```\n[mysqld]\ndatadir=/var/lib/mysql\nsocket=/var/lib/mysql/mysql.sock\n#pid-file=/var/lib/mysql/mysql.pid\nuser=mysql\n# Disabling symbolic-links is recommended to prevent assorted security risks\nsymbolic-links=0\ncharacter-set-server=utf8\nexplicit_defaults_for_timestamp=1\ndefault-storage-engine=InnoDB\n\ninnodb_strict_mode\ninnodb_file_per_table\ninnodb_use_sys_malloc\ninnodb_buffer_pool_size=128M\ninnodb_write_io_threads=4\ninnodb_read_io_threads=4\ninnodb_thread_concurrency=16\ninnodb_log_file_size=16M\ninnodb_flush_log_at_trx_commit=2\ninnodb_flush_method=O_DIRECT\ninnodb_fast_shutdown=0\ninnodb_buffer_pool_dump_at_shutdown=1\ninnodb_buffer_pool_load_at_startup=1\n\nquery_cache_size=128M\nquery_cache_limit=2M\nquery_cache_min_res_unit=4k\nquery_cache_type=1\n\ntmp_table_size=128M\nmax_heap_table_size=128M\n\ntable_open_cache=1024\nmax_allowed_packet=1M\nsort_buffer_size=512K\nread_buffer_size=256K\nread_rnd_buffer_size=256K\njoin_buffer_size=256K\nkey_buffer_size=16M\n\nmax_connections=256\nthread_cache_size=256\n\nslow_query_log\nslow_query_log_file=/var/log/mysqld-slow.log\nlong_query_time=1\n\nlog-error=/var/log/mysqld.log\n\nwait_timeout=60\n\nplugin-load=handlersocket.so\n\n[mysqld_safe]\nlog-error=/var/log/mysqld.log\n```\n\n### \u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306e\u30c1\u30e5\u30fc\u30cb\u30f3\u30b0\n\n```bash\n$ cd ~/\n$ wget https://raw.githubusercontent.com/major/MySQLTuner-perl/master/mysqltuner.pl\n$ perl <(wget -q -O - mysqltuner.pl)\n```\n[MySQLTuner\u3067MySQL\u306e\u30c1\u30e5\u30fc\u30cb\u30f3\u30b0\u3092\u8a3a\u65ad\u3059\u308b\u65b9\u6cd5](http://www.e-agency.co.jp/column/20121220.html)\n\n### \u30d2\u30f3\u30c8\n\n```bash\n# \u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u4e00\u89a7\nMariaDB [(none)]> show databases;\n\n# \u30e6\u30fc\u30b6\u30fc\u4e00\u89a7\nMariaDB [(none)]> select Host, User, Password from mysql.user;\n\n# \u6307\u5b9a\u306e\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306e\u30c6\u30fc\u30d6\u30eb\u4e00\u89a7\nMariaDB [(none)]> SHOW TABLES FROM tablename;\n```\n\n## Nginx \u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\nNginx \u3092\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u304b\u3089\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\n\u57f7\u7b46\u6642\u70b9\u3067\u306e\u6700\u65b0\u5b89\u5b9a\u7248\u306f\u30011.8.0\u3067\u3059\u3002\n\n### Nginx \u30e6\u30fc\u30b6\u30fc\u3092\u4f5c\u6210\n\n```bash\n$ useradd --shell /sbin/nologin nginx && \\\nid nginx\n```\n\n### \u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u306e\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\n```bash\n$ cd /tmp/ && \\\nsudo wget http://nginx.org/download/nginx-1.8.0.tar.gz -O nginx-current.tar.gz && \\\nsudo mkdir nginx-current && \\\nsudo tar -zxvf nginx-current.tar.gz -C /tmp/nginx-current --strip-components=1 && \\\ncd /tmp/nginx-current\n```\n\n### NGX Cache Purge\n\n```bash\n$ sudo wget http://labs.frickle.com/files/ngx_cache_purge-2.3.tar.gz -O ngx_cache_purge.tar.gz && \\\nsudo mkdir ngx_cache_purge && \\\nsudo tar -zxvf ngx_cache_purge.tar.gz -C /tmp/nginx-current/ngx_cache_purge --strip-components=1 && \\\nsudo rm -rf ngx_cache_purge.tar.gz\n```\n\n### OpenSSL\n\n```bash\n$ sudo wget http://www.openssl.org/source/openssl-1.0.2d.tar.gz -O openssl.tar.gz && \\\nsudo mkdir openssl && \\\nsudo tar -zxvf openssl.tar.gz -C /tmp/nginx-current/openssl --strip-components=1 && \\\nsudo rm -rf openssl.tar.gz\n```\n\n### NGX PageSpeed\n\n```bash\n$ git clone https://github.com/pagespeed/ngx_pagespeed.git && \\\nrm -rf ./ngx_pagespeed/.git && \\\ncd ./ngx_pagespeed && \\\nsudo wget https://dl.google.com/dl/page-speed/psol/1.9.32.6.tar.gz && \\\nsudo tar -zxvf 1.9.32.6.tar.gz && \\\nsudo rm -rf ./1.9.32.6.tar.gz\n```\n\n### \u30d3\u30eb\u30c9\n\n```bash\n$ cd /tmp/nginx-current && \\\nsudo ./configure \\\n--prefix=/etc/sysconfig/nginx \\\n--sbin-path=/usr/sbin/nginx \\\n--conf-path=/etc/nginx/nginx.conf \\\n--error-log-path=/var/log/nginx/error.log \\\n--pid-path=/var/run/nginx/nginx.pid \\\n--lock-path=/var/lock/subsys/nginx \\\n--http-client-body-temp-path=/var/cache/nginx/client_temp \\\n--http-proxy-temp-path=/var/cache/nginx/proxy_temp \\\n--http-fastcgi-temp-path=/var/cache/nginx/fastcgi_temp \\\n--http-uwsgi-temp-path=/var/cache/nginx/uwsgi_temp \\\n--http-scgi-temp-path=/var/cache/nginx/scgi_temp \\\n--user=nginx \\\n--group=nginx \\\n--with-http_ssl_module \\\n--with-http_realip_module \\\n--with-http_addition_module \\\n--with-http_sub_module \\\n--with-http_dav_module \\\n--with-http_flv_module \\\n--with-http_mp4_module \\\n--with-http_gunzip_module \\\n--with-http_gzip_static_module \\\n--with-http_random_index_module \\\n--with-http_secure_link_module \\\n--with-http_stub_status_module \\\n--with-http_auth_request_module \\\n--with-mail \\\n--with-mail_ssl_module \\\n--with-file-aio \\\n--with-ipv6 \\\n--with-debug \\\n--with-http_spdy_module \\\n--with-openssl=/tmp/nginx-current/openssl \\\n--add-module=/tmp/nginx-current/ngx_cache_purge \\\n--add-module=/tmp/nginx-current/ngx_pagespeed && \\\nsudo make && sudo make install && \\\nsudo rm -rf /tmp/nginx-current/ && \\\nsudo rm -rf /tmp/nginx-current.tar.gz\n```\n\n### \u30d5\u30a9\u30eb\u30c0\u306e\u4f5c\u6210\n\n```bash\n$ sudo mkdir -m 755 -p /var/cache/nginx/ngx_pagespeed/ && \\\nsudo mkdir -m 755 -p /var/cache/nginx/ngx_pagespeed/ && \\\nsudo chown -R nginx:nginx /var/cache/nginx && \\\nsudo mkdir -m 755 -p /var/run/nginx/ && \\\nsudo chown nginx:nginx /var/run/nginx/ && \\\nsudo mkdir -m 755 -p /var/log/nginx/ngx_pagespeed/ && \\\nsudo chown -R nginx:nginx /var/log/nginx/ && \\\nsudo mkdir -m 755 -p /var/run/hhvm/ && \\\nsudo chown nginx:nginx /var/run/hhvm/ && \\\nsudo mkdir -m 755 -p /var/log/hhvm/ && \\\nsudo chown -R nginx:nginx /var/log/hhvm/ && \\\nsudo mkdir -m 755 -p /var/log/php-fpm/ && \\\nsudo chown -R nginx:nginx /var/log/php-fpm/\n```\n\n### \u8d77\u52d5\u30b9\u30af\u30ea\u30d7\u30c8\u306e\u4f5c\u6210\n\n```bash\n$ vi /etc/init.d/nginx\n```\n\n\u4e0b\u8a18\u3092\u30da\u30fc\u30b9\u30c8\u3002\n\n```\n#!/bin/sh\n#\n# nginx - this script starts and stops the nginx daemon\n#\n# chkconfig:   - 85 15\n# description:  Nginx is an HTTP(S) server, HTTP(S) reverse \\\n#               proxy and IMAP/POP3 proxy server\n# processname: nginx\n# config:      /etc/nginx/nginx.conf\n# config:      /etc/sysconfig/nginx\n# pidfile:     /var/run/nginx.pid\n\n# Source function library.\n. /etc/rc.d/init.d/functions\n\n# Source networking configuration.\n. /etc/sysconfig/network\n\n# Check that networking is up.\n[ \"$NETWORKING\" = \"no\" ] && exit 0\n\nnginx=\"/usr/sbin/nginx\"\nprog=$(basename $nginx)\n\nsysconfig=\"/etc/sysconfig/$prog\"\nlockfile=\"/var/lock/subsys/nginx\"\npidfile=\"/var/run/nginx/${prog}.pid\"\n\nNGINX_CONF_FILE=\"/etc/nginx/nginx.conf\"\n\n[ -f $sysconfig ] && . $sysconfig\n\n\nstart() {\n    [ -x $nginx ] || exit 5\n    [ -f $NGINX_CONF_FILE ] || exit 6\n    echo -n $\"Starting $prog: \"\n    daemon $nginx -c $NGINX_CONF_FILE\n    retval=$?\n    echo\n    [ $retval -eq 0 ] && touch $lockfile\n    return $retval\n}\n\nstop() {\n    echo -n $\"Stopping $prog: \"\n    killproc -p $pidfile $prog\n    retval=$?\n    echo\n    [ $retval -eq 0 ] && rm -f $lockfile\n    return $retval\n}\n\nrestart() {\n    configtest_q || return 6\n    stop\n    start\n}\n\nreload() {\n    configtest_q || return 6\n    echo -n $\"Reloading $prog: \"\n    killproc -p $pidfile $prog -HUP\n    echo\n}\n\nconfigtest() {\n    $nginx -t -c $NGINX_CONF_FILE\n}\n\nconfigtest_q() {\n    $nginx -t -q -c $NGINX_CONF_FILE\n}\n\nrh_status() {\n    status $prog\n}\n\nrh_status_q() {\n    rh_status >/dev/null 2>&1\n}\n\n# Upgrade the binary with no downtime.\nupgrade() {\n    local oldbin_pidfile=\"${pidfile}.oldbin\"\n\n    configtest_q || return 6\n    echo -n $\"Upgrading $prog: \"\n    killproc -p $pidfile $prog -USR2\n    retval=$?\n    sleep 1\n    if [[ -f ${oldbin_pidfile} && -f ${pidfile} ]];  then\n        killproc -p $oldbin_pidfile $prog -QUIT\n        success $\"$prog online upgrade\"\n        echo\n        return 0\n    else\n        failure $\"$prog online upgrade\"\n        echo\n        return 1\n    fi\n}\n\n# Tell nginx to reopen logs\nreopen_logs() {\n    configtest_q || return 6\n    echo -n $\"Reopening $prog logs: \"\n    killproc -p $pidfile $prog -USR1\n    retval=$?\n    echo\n    return $retval\n}\n\ncase \"$1\" in\n    start)\n        rh_status_q && exit 0\n        $1\n        ;;\n    stop)\n        rh_status_q || exit 0\n        $1\n        ;;\n    restart|configtest|reopen_logs)\n        $1\n        ;;\n    force-reload|upgrade)\n        rh_status_q || exit 7\n        upgrade\n        ;;\n    reload)\n        rh_status_q || exit 7\n        $1\n        ;;\n    status|status_q)\n        rh_$1\n        ;;\n    condrestart|try-restart)\n        rh_status_q || exit 7\n        restart\n        ;;\n    *)\n        echo $\"Usage: $0 {start|stop|reload|configtest|status|force-reload|upgrade|restart|reopen_logs}\"\n        exit 2\nesac\n```\n\n\u5b9f\u884c\u6a29\u9650\u3092\u4ed8\u4e0e\u3059\u308b\u3002\n\n```bash\n$ chmod +x /etc/init.d/nginx\n```\n\n### \u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3092\u7528\u610f\n\n[Amimoto \u306e Nginx \u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb](https://github.com/megumiteam/amimoto/tree/master/etc/nginx) \u3092\u53c2\u8003\u306b\u3059\u308b\u3068\u3088\u3044\u3068\u601d\u3044\u307e\u3059\u3002\n\u72ec\u81ea\u306b\u7528\u610f\u3057\u3066\u3044\u308b\u5834\u5408\u306f\u3001git clone \u306a\u3069\u3067\u30ea\u30e2\u30fc\u30c8\u30b5\u30fc\u30d0\u30fc\u306b\u6301\u3063\u3066\u304f\u308b\u3068\u697d\u304b\u3082\u3067\u3059\u306d\u3002\n\n```bash\n$ mv /etc/nginx/ /etc/nginx_old/ && \\\ncd /etc/ && \\\ngit clone https://github.com/YOUR_USERNAME/nginx.git --depth=1 && \\\nrm -rf /etc/nginx/.git\n```\n\n`nginx.conf` \u306e `worker_processes` \u3068 `worker_cpu_affinity` \u306f CPU \u306e\u30b3\u30a2\u6570\u3092\u57fa\u306b\u8a2d\u5b9a\u3059\u308b\u3002\nCPU \u306e\u30b3\u30a2\u6570\u3092\u78ba\u8a8d\u3059\u308b\u306b\u306f\u3001\u4ee5\u4e0b\u306e\u30b3\u30de\u30f3\u30c9\u3067\u78ba\u8a8d\u3067\u304d\u308b\u3002\n\n```bash\n$ grep processor /proc/cpuinfo |wc -l\n```\n\n\u30b3\u30a2\u6570\u304c 3 \u306e\u5834\u5408\u306f\u4ee5\u4e0b\u3001`nginx.conf` \u306e `worker_processes` \u3068 `worker_cpu_affinity` \u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u306a\u308b\u3002\n\n```\nworker_processes     3;\nworker_cpu_affinity  001 010 100;\n```\n\n### Nginx \u306e\u8d77\u52d5\n\n\u4e00\u756a\u6700\u5f8c\u306b\u884c\u3046\u3002\n\n### \u30d2\u30f3\u30c8\n\n\u7279\u5b9a\u306e URL \u306e\u30ad\u30e3\u30c3\u30b7\u30e5\u3092\u524a\u9664\u3059\u308b\u3002\n\n```bash\n$ find /var/cache/nginx/ -type f -exec grep -l \"KEY: http://192.168.30.10/.*$\" {} \\; | xargs rm -f\n```\n\n## HHVM \u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n\u4ee5\u4e0b\u624b\u9806\u306f HHVM Github Wiki [Building and installing HHVM on CentOS 6.6](https://github.com/facebook/hhvm/wiki/Building-and-installing-HHVM-on-CentOS-6.6) \u8a18\u8f09\u306e\u624b\u9806\u3068\u57fa\u672c\u7684\u306b\u540c\u3058\u3067\u3059\u3002\n\n### gcc \u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n\u8457\u8005\u306f\u3001\u3053\u306e\u65b9\u6cd5\u3067\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u306b\u6210\u529f\u3057\u305f\u3053\u3068\u304c\u306a\u3044\u3067\u3059\u3002\n\n```bash\n$ cd /tmp && \\\nsudo wget ftp://ftp.gnu.org/gnu/gcc/gcc-5.2.0/gcc-5.2.0.tar.gz -O gcc-current.tar.gz && \\\nsudo mkdir gcc-current && \\\nsudo tar -zxvf gcc-current.tar.gz -C /tmp/gcc-current --strip-components=1 && \\\ncd /tmp/gcc-current\n```\n\n#### gmp\n\n```bash\n$ sudo wget https://gmplib.org/download/gmp-6.0.0/gmp-6.0.0.tar.bz2 -O gmp-current.tar.bz2 && \\\nsudo mkdir gmp && sudo tar -jxvf gmp-current.tar.bz2 -C /tmp/gcc-current/gmp --strip-components=1\n```\n\n#### mpfr\n\n```bash\n$ sudo wget http://www.mpfr.org/mpfr-current/mpfr-3.1.3.tar.bz2 -O mpfr-current.tar.bz2 && \\\nsudo mkdir mpfr && sudo tar -jxvf mpfr-current.tar.bz2 -C /tmp/gcc-current/mpfr --strip-components=1\n```\n\n#### mpc\n\n```bash\n$ sudo wget http://www.multiprecision.org/mpc/download/mpc-1.0.3.tar.gz -O mpc-current.tar.gz && \\\nsudo mkdir mpc && sudo tar -zxvf mpc-current.tar.gz -C /tmp/gcc-current/mpc --strip-components=1\n```\n\n#### isl\n\n```bash\n$ sudo wget ftp://ftp.irisa.fr/pub/mirrors/gcc.gnu.org/gcc/infrastructure/isl-0.15.tar.bz2 -O isl-current.tar.bz2 && \\\nsudo mkdir isl && sudo tar -jxvf isl-current.tar.bz2 -C /tmp/gcc-current/isl --strip-components=1\n```\n\n#### cloog\n\n```bash\n$ sudo wget http://bastoul.net/cloog/pages/download/cloog-0.18.4.tar.gz -O cloog-current.tar.gz && \\\nsudo mkdir cloog && sudo tar -zxvf cloog-current.tar.gz -C /tmp/gcc-current/cloog --strip-components=1\n```\n\n#### \u30d3\u30eb\u30c9\n\n```bash\n$ sudo mkdir /tmp/gcc-build && cd /tmp/gcc-build && \\\nsudo ../gcc-current/configure --enable-languages=c,c++,fortran --enable-multilib --prefix=/usr/local/gcc\n$ sudo make && sudo make install\n```\n\n#### \u65b0\u30d0\u30fc\u30b8\u30e7\u30f3\u306b\u5165\u308c\u66ff\u3048\u308b\n\n```bash\n$ yum remove -y gcc gcc-c++ cpp\n$ sudo mv /usr/bin/g++ /usr/bin/g++_old && \\\nsudo mv /usr/bin/c++ /usr/bin/c++_old && \\\nsudo ln -s -f /usr/local/gcc/bin/gcc /usr/bin/gcc && \\\nsudo ln -s -f /usr/local/gcc/bin/g++ /usr/bin/g++ && \\\nsudo ln -s -f /usr/local/gcc/bin/c++ /usr/bin/c++ && \\\nsudo ln -s -f /usr/local/gcc/bin/cpp /usr/bin/cpp && \\\nsudo ln -s -f /usr/local/gcc/bin/gfortran /usr/bin/gfortran && \\\nsudo ln -s -f /usr/local/gcc/bin/gcov /usr/bin/gcov && \\\nsudo cp /usr/local/gcc/lib64/libstdc++.so.6.0.20 /usr/lib64/. && \\\nsudo mv /usr/lib64/libstdc++.so.6 /usr/lib64/libstdc++.so.6.bak && \\\nsudo ln -s -f /usr/lib64/libstdc++.so.6.0.20 /usr/lib64/libstdc++.so.6\n```\n\n### gcc \u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u305d\u306e 2\n\n```bash\n$ sudo wget http://people.centos.org/tru/devtools-2/devtools-2.repo -O /etc/yum.repos.d/devtools-2.repo && \\\nsudo yum -y install devtoolset-2-gcc devtoolset-2-binutils devtoolset-2-gcc-c++ && \\\nsudo mv /usr/bin/g++ /usr/bin/g++_old && \\\nsudo mv /usr/bin/c++ /usr/bin/c++_old && \\\nsudo mv /usr/bin/c++filt /usr/bin/c++filt_old && \\\nsudo mv /usr/bin/cpp /usr/bin/cpp_old && \\\nsudo mv /usr/bin/cc /usr/bin/cc_old && \\\nsudo mv /usr/bin/gcov /usr/bin/gcov_old && \\\nsudo ln -s -f /opt/rh/devtoolset-2/root/usr/bin/c++ /usr/bin/ && \\\nsudo ln -s -f /opt/rh/devtoolset-2/root/usr/bin/c++filt /usr/bin/ && \\\nsudo ln -s -f /opt/rh/devtoolset-2/root/usr/bin/cpp /usr/bin/ && \\\nsudo ln -s -f /opt/rh/devtoolset-2/root/usr/bin/g++ /usr/bin/ && \\\nsudo ln -s -f /opt/rh/devtoolset-2/root/usr/bin/gcc /usr/bin/ && \\\nsudo ln -s -f /opt/rh/devtoolset-2/root/usr/bin/gcc-ar /usr/bin/ && \\\nsudo ln -s -f /opt/rh/devtoolset-2/root/usr/bin/gcc-nm /usr/bin/ && \\\nsudo ln -s -f /opt/rh/devtoolset-2/root/usr/bin/gcc-ranlib /usr/bin/ && \\\nsudo ln -s -f /opt/rh/devtoolset-2/root/usr/bin/gcov /usr/bin/ && \\\nhash -r\n```\n\n#### gmp\n\n```bash\n$ cd /tmp && \\\nsudo wget https://gmplib.org/download/gmp-6.0.0/gmp-6.0.0.tar.bz2 -O gmp-current.tar.bz2 && \\\nsudo mkdir gmp-current && sudo tar -jxvf gmp-current.tar.bz2 -C /tmp/gmp-current --strip-components=1 && \\\ncd /tmp/gmp-current && \\\nsudo ./configure --enable-cxx && sudo make && sudo make install && \\\nrm -rf /tmp/gmp-current.tar.gz && \\\nrm -rf /tmp/gmp-current/\n```\n\n#### mpfr\n\n```bash\n$ cd /tmp && \\\nsudo wget http://www.mpfr.org/mpfr-current/mpfr-3.1.3.tar.bz2 -O mpfr-current.tar.bz2 && \\\nsudo mkdir mpfr-current && sudo tar -jxvf mpfr-current.tar.bz2 -C /tmp/mpfr-current --strip-components=1 && \\\ncd /tmp/mpfr-current && \\\nsudo ./configure && sudo make && sudo make install && \\\nrm -rf /tmp/mpfr-current.tar.gz && \\\nrm -rf /tmp/mpfr-current/\n```\n\n#### mpc\n\n```bash\n$ cd /tmp && \\\nsudo wget http://www.multiprecision.org/mpc/download/mpc-1.0.3.tar.gz -O mpc-current.tar.gz && \\\nsudo mkdir mpc-current && sudo tar -zxvf mpc-current.tar.gz -C /tmp/mpc-current --strip-components=1 && \\\ncd /tmp/mpc-current && \\\nsudo ./configure && sudo make && sudo make install && \\\nrm -rf /tmp/mpc-current.tar.gz && \\\nrm -rf /tmp/mpc-current/\n```\n\n#### isl\n\n```bash\n$ cd /tmp && \\\nsudo wget ftp://ftp.irisa.fr/pub/mirrors/gcc.gnu.org/gcc/infrastructure/isl-0.15.tar.bz2 -O isl-current.tar.bz2 && \\\nsudo mkdir isl-current && sudo tar -jxvf isl-current.tar.bz2 -C /tmp/isl-current --strip-components=1 && \\\ncd /tmp/isl-current && \\\nsudo ./configure && sudo make && sudo make install && \\\nrm -rf /tmp/isl-current.tar.gz && \\\nrm -rf /tmp/isl-current/\n```\n\n#### cloog\n\n```bash\n$ cd /tmp && \\\nsudo wget http://bastoul.net/cloog/pages/download/cloog-0.18.4.tar.gz -O cloog-current.tar.gz && \\\nsudo mkdir cloog-current && sudo tar -zxvf cloog-current.tar.gz -C /tmp/cloog-current --strip-components=1 && \\\ncd /tmp/cloog-current && \\\nsudo ./configure && sudo make && sudo make install && \\\nrm -rf /tmp/cloog-current.tar.gz && \\\nrm -rf /tmp/cloog-current/\n```\n\n### libtool \u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n```bash\n$ cd /tmp && \\\nsudo wget http://ftpmirror.gnu.org/libtool/libtool-2.4.6.tar.gz -O libtool-current.tar.gz && \\\nsudo mkdir ./libtool-current && \\\nsudo tar -zxvf libtool-current.tar.gz -C /tmp/libtool-current --strip-components=1 && \\\ncd ./libtool-current && \\\nsudo ./configure && sudo make && sudo make install && \\\nsudo rm -rf /tmp/libtool-current/ && \\\nsudo rm -rf /tmp/libtool-current.tar.gz\n```\n\n### HHVM \u306e\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\n\n```bash\n$ cd /usr/local && \\\ngit clone git://github.com/facebook/hhvm.git --depth=1 && \\\ncd hhvm && \\\nexport CMAKE_PREFIX_PATH=/usr/local\n```\n\n### curl \u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n```bash\n# \u4e0b\u8a18 URL \u5148\u304b\u3089\u9069\u5f53\u306b\u30df\u30e9\u30fc\u3092\u9078\u3093\u3067\u304f\u3060\u3055\u3044\n# http://curl.haxx.se/latest.cgi?curl=tar.gz\n$ cd /tmp && \\\nsudo wget http://curl.mirror.anstey.ca/curl-7.44.0.tar.gz -O curl-current.tar.gz && \\\nsudo mkdir ./curl-current && \\\nsudo tar -zxvf ./curl-current.tar.gz -C /tmp/curl-current --strip-components=1 && \\\ncd ./curl-current && \\\n./configure --enable-libcurl-option && sudo make && sudo make install && \\\nsudo rm -rf /tmp/curl-current/ && \\\nsudo rm -rf /tmp/curl-current.tar.gz\n```\n\n### Boost \u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n```bash\n$ cd /tmp && \\\nsudo wget http://downloads.sourceforge.net/project/boost/boost/1.59.0/boost_1_59_0.tar.gz -O boost-current.tar.gz && \\\nsudo mkdir ./boost-current && \\\nsudo tar -zxvf boost-current.tar.gz -C /tmp/boost-current --strip-components=1 && \\\ncd ./boost-current && \\\nsudo ./bootstrap.sh && \\\nsudo ./b2 --layout=system install\n$ export PATH=/usr/local/boost/include:$PATH && \\\nexport PATH=/usr/local/boost/lib:$PATH && \\\nsed -i '/export PATH/i PATH=$PATH:/usr/local/boost/include' ~/.bash_profile && \\\nsed -i '/export PATH/i PATH=$PATH:/usr/local/boost/lib' ~/.bash_profile\n\n# \u4e0a\u8a18\u3067 Path \u304c\u901a\u3089\u306a\u3044\u5834\u5408\u306f\u4ee5\u4e0b\u3092\u8ffd\u52a0\n$ export BOOST_INCLUDEDIR=/usr/local/boost/include:$BOOST_INCLUDEDIR && \\\nexport LD_LIBRARY_PATH=/usr/local/boost/lib\n\nexport BOOST_ROOT=/usr/local/boost/:$BOOST_ROOT\n\nexport CMAKE_INCLUDE_PATH=$CMAKE_PREFIX_PATH/boost/include && \\\nexport CMAKE_LIBRARY_PATH=$CMAKE_PREFIX_PATH/boost/lib\n\n# \u5f8c\u59cb\u672b\n$ sudo rm -rf /tmp/boost-current/ && \\\nsudo rm -rf /tmp/boost-current.tar.gz\n```\n\n### libmemcached \u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n```bash\n$ cd /tmp && \\\nsudo wget https://launchpad.net/libmemcached/1.0/1.0.9/+download/libmemcached-1.0.9.tar.gz -O libmemcached-current.tar.gz && \\\nsudo mkdir ./libmemcached-current && \\\ntar -xzvf ./libmemcached-current.tar.gz -C /tmp/libmemcached-current --strip-components=1 && \\\ncd ./libmemcached-current && \\\n./configure --prefix=$CMAKE_PREFIX_PATH && sudo make && sudo make install && \\\nsudo rm -rf /tmp/libmemcached-current/ && \\\nsudo rm -rf /tmp/libmemcached-current.tar.gz\n```\n\n### JEMalloc \u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n```bash\n$ cd /tmp && \\\nsudo wget http://www.canonware.com/download/jemalloc/jemalloc-3.5.1.tar.bz2 -O jemalloc-current.tar.gz && \\\nsudo mkdir ./jemalloc-current && \\\ntar -xjvf jemalloc-current.tar.gz -C /tmp/jemalloc-current --strip-components=1 && \\\ncd ./jemalloc-current && \\\n./configure --prefix=$CMAKE_PREFIX_PATH && sudo make && sudo make install && \\\nsudo rm -rf /tmp/jemalloc-current/ && \\\nsudo rm -rf /tmp/jemalloc-current.tar.gz\n```\n\n### sqlite \u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n```bash\n$ cd /tmp && \\\nsudo wget http://ftp.osuosl.org/pub/blfs/conglomeration/sqlite/sqlite-autoconf-3081101.tar.gz -O sqlite-current.tar.gz && \\\nsudo mkdir ./sqlite-current && \\\ntar -zxvf sqlite-current.tar.gz -C /tmp/sqlite-current --strip-components=1 && \\\ncd ./sqlite-current && \\\n./configure --prefix=$CMAKE_PREFIX_PATH && sudo make && sudo make install && \\\nsudo rm -rf /tmp/sqlite-current/ && \\\nsudo rm -rf /tmp/sqlite-current.tar.gz\n```\n\n### OCaml \u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n```bash\n$ sudo wget http://download.opensuse.org/repositories/home:/ocaml/CentOS_6/home:ocaml.repo -O /etc/yum.repos.d/ocaml.repo && \\\nyum -y install ocaml\n```\n\n### TBB \u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n```bash\n$ yum -y install ftp://ftp.pbone.net/mirror/ftp5.gwdg.de/pub/opensuse/repositories/home:/zgyarmati:/hhphp/CentOS_CentOS-5/x86_64/tbb-4.0-2.6.x86_64.rpm\n$ yum -y install ftp://ftp.pbone.net/mirror/ftp5.gwdg.de/pub/opensuse/repositories/home:/zgyarmati:/hhphp/CentOS_CentOS-5/x86_64/tbb-devel-4.0-2.6.x86_64.rpm\n```\n\n### glog \u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n```bash\n$ cd /tmp && \\\nsudo wget https://google-glog.googlecode.com/files/glog-0.3.3.tar.gz -O glog-current.tar.gz && \\\nsudo mkdir glog-current && \\\ntar -zxvf glog-current.tar.gz -C /tmp/glog-current --strip-components=1 && \\\ncd ./glog-current && \\\n./configure && sudo make && sudo make install && \\\nsudo rm -rf /tmp/glog-current/ && \\\nsudo rm -rf /tmp/glog-current.tar.gz\n```\n\n### libdwarf \u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n```bash\n$ cd /tmp && \\\nsudo wget http://www.prevanders.net/libdwarf-20150310.tar.gz -O libdwarf-current.tar.gz && \\\nsudo mkdir libdwarf-current && \\\ntar -zxvf libdwarf-current.tar.gz -C /tmp/libdwarf-current --strip-components=1 && \\\ncd ./libdwarf-current && \\\n./configure && sudo make && \\\nsudo cp ./libdwarf/libdwarf.a /usr/lib64/ && \\\nsudo cp ./libdwarf/libdwarf.h /usr/include/ && \\\nsudo cp ./libdwarf/dwarf.h /usr/include/ && \\\nsudo rm -rf /tmp/libdwarf-current/ && \\\nsudo rm -rf /tmp/libdwarf-current.tar.gz\n```\n\n### HHVM \u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n```bash\n$ cd /usr/local/hhvm && \\\ngit submodule update --init --recursive\n$ sudo cmake .\n$ sudo sed -i -e 's/$/..\\/..\\/..\\/lib\\/libmemcached.so/g' hphp/hhvm/CMakeFiles/hhvm.dir/link.txt\n$ sudo make\n$ export PATH=/usr/local/hhvm/hphp/hhvm:$PATH && \\\nsed -i '/export PATH/i PATH=$PATH:/usr/local/hhvm/hphp/hhvm' ~/.bash_profile\n```\n\n### \u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u306e\u4f5c\u6210\n\n```bash\n$ sudo mldir /etc/hhvm/ && \\\nsudo vi /etc/hhvm/server.hdf\n```\n\n\u4e0b\u8a18\u3092\u30da\u30fc\u30b9\u30c8\u3002\n\n```\nPidFile = /var/run/hhvm/hhvm.pid\n\nServer {\n  Type = fastcgi\n  FileSocket = /var/run/hhvm/hhvm.sock\n  User = nginx\n  Group = nginx\n}\n\nLog {\n  Level = Warning\n  AlwaysLogUnhandledExceptions = true\n  RuntimeErrorReportingLevel = 8191\n  UseLogFile = true\n  UseSyslog = false\n  File = /var/log/hhvm/error.log\n  Access {\n    * {\n      File = /var/log/hhvm/access.log\n      Format = %h %l %u % t \\\"%r\\\" %>s %b\n    }\n  }\n}\n\nRepo {\n  Central {\n    # Path = /var/log/hhvm/.hhvm.hhbc\n    Path = /var/tmp/hhvm.hhbc\n  }\n}\n\nMySQL {\n  TypedResults = false\n}\n```\n\n```bash\n$ sudo vi /etc/hhvm/config.hdf\n```\n\n\u4e0b\u8a18\u3092\u30da\u30fc\u30b9\u30c8\u3002\n\n```\nLog {\n  Level = Warning\n  AlwaysLogUnhandledExceptions = true\n  RuntimeErrorReportingLevel = 8191\n}\n\nMySQL {\n  TypedResults = false\n}\n\nEval {\n  JitASize = 67108864\n  JitAStubsSize = 67108864\n  JitGlobalDataSize = 22554432\n}\n```\n\n### \u8d77\u52d5\u30b9\u30af\u30ea\u30d7\u30c8\u306e\u4f5c\u6210\n\n```bash\n$ sudo vi /etc/init.d/hhvm\n```\n\n\u4e0b\u8a18\u3092\u30da\u30fc\u30b9\u30c8\u3002\n\n```\n#!/bin/bash\n#\n# /etc/rc.d/init.d/hhvm\n#\n# Starts the hhvm daemon\n#\n# chkconfig: 345 26 74\n# description: HHVM (aka the HipHop Virtual Machine) is an open-source virtual machine designed for executing programs written in Hack and PHP\n# processname: hhvm\n\n### BEGIN INIT INFO\n# Provides: hhvm\n# Required-Start: $local_fs\n# Required-Stop: $local_fs\n# Default-Start:  2 3 4 5\n# Default-Stop: 0 1 6\n# Short-Description: start and stop hhvm\n# Description: HHVM (aka the HipHop Virtual Machine) is an open-source virtual machine designed for executing programs written in Hack and PHP\n### END INIT INFO\n\n# Source function library.\n. /etc/init.d/functions\n\nstart() {\n  echo -n \"Starting hhvm: \"\n        /usr/local/hhvm/hphp/hhvm/hhvm --config /etc/hhvm/server.hdf --user nginx --mode daemon\n  touch /var/lock/subsys/hhvm\n}\n\nstop() {\n  echo -n \"Shutting down hhvm: \"\n  killproc -p /var/run/hhvm/hhvm.pid hhvm\n  rm -f /var/lock/subsys/hhvm\n}\n\ncase \"$1\" in\n  start)\n  start\n  ;;\n  stop)\n  stop\n  ;;\n  status)\n    status -p /var/run/hhvm/hhvm.pid hhvm\n  ;;\n  restart)\n    stop\n  start\n  ;;\n  reload|condrestart|probe)\n  echo \"$1 - Not supported.\"\n  ;;\n  *)\n  echo \"Usage: hhvm {start|stop|status|reload|restart[|probe]\"\n  exit 1\n  ;;\nesac\nexit $?\n```\n\n\u5b9f\u884c\u6a29\u9650\u3092\u4ed8\u4e0e\u3002\n\n```bash\n$ chmod +x /etc/init.d/hhvm\n```\n\n### php.ini \u3092\u5909\u66f4\n\n```bash\n$ sudo mv /etc/php.ini /etc/php.ini_old && \\\nsudo vi /etc/php.ini\n```\n\n\u4e0b\u8a18\u3092\u30da\u30fc\u30b9\u30c8\u3002\n\n```\n[PHP]\nengine = On\nshort_open_tag = On\nasp_tags = Off\nprecision = 14\ny2k_compliance = On\noutput_buffering = 4096\nzlib.output_compression = Off\nimplicit_flush = Off\nunserialize_callback_func =\nserialize_precision = 100\nallow_call_time_pass_reference = Off\nsafe_mode = Off\nsafe_mode_gid = Off\nsafe_mode_include_dir =\nsafe_mode_exec_dir =\nsafe_mode_allowed_env_vars = PHP_\nsafe_mode_protected_env_vars = LD_LIBRARY_PATH\ndisable_functions =\ndisable_classes =\nzend.enable_gc = On\nexpose_php = Off\nmax_execution_time = 90\nmax_input_time = 60\nmemory_limit = 128M\nerror_reporting = E_ALL & ~E_DEPRECATED\ndisplay_errors = Off\ndisplay_startup_errors = Off\nlog_errors = On\nlog_errors_max_len = 1024\nignore_repeated_errors = Off\nignore_repeated_source = Off\nreport_memleaks = On\ntrack_errors = Off\nhtml_errors = Off\nvariables_order = \"GPCS\"\nrequest_order = \"GP\"\nregister_globals = Off\nregister_long_arrays = Off\nregister_argc_argv = Off\nauto_globals_jit = On\npost_max_size = 8M\nmagic_quotes_gpc = Off\nmagic_quotes_runtime = Off\nmagic_quotes_sybase = Off\nauto_prepend_file =\nauto_append_file =\ndefault_mimetype = \"text/html\"\ndoc_root =\nuser_dir =\nenable_dl = Off\nfile_uploads = On\nupload_max_filesize = 4M\nmax_file_uploads = 20\nallow_url_fopen = On\nallow_url_include = Off\ndefault_socket_timeout = 60\n\n[Date]\ndate.timezone = \"Asia/Tokyo\"\n\n[filter]\n\n[iconv]\n\n[intl]\n\n[sqlite]\n\n[sqlite3]\n\n[Pcre]\n\n[Pdo]\n\n[Phar]\n\n[Syslog]\ndefine_syslog_variables  = Off\n\n[mail function]\nSMTP = localhost\nsmtp_port = 25\nsendmail_path = /usr/sbin/sendmail -t -i\nmail.add_x_header = On\n\n[SQL]\nsql.safe_mode = Off\n\n[ODBC]\nodbc.allow_persistent = On\nodbc.check_persistent = On\nodbc.max_persistent = -1\nodbc.max_links = -1\nodbc.defaultlrl = 4096\nodbc.defaultbinmode = 1\n\n[MySQL]\nmysql.allow_persistent = On\nmysql.max_persistent = -1\nmysql.max_links = -1\nmysql.default_port =\nmysql.default_socket =\nmysql.default_host =\nmysql.default_user =\nmysql.default_password =\nmysql.connect_timeout = 60\nmysql.trace_mode = Off\n\n[MySQLi]\nmysqli.max_links = -1\nmysqli.default_port = 3306\nmysqli.default_socket =\nmysqli.default_host =\nmysqli.default_user =\nmysqli.default_pw =\nmysqli.reconnect = Off\n\n[OCI8]\n\n[PostgresSQL]\npgsql.allow_persistent = On\npgsql.auto_reset_persistent = Off\npgsql.max_persistent = -1\npgsql.max_links = -1\npgsql.ignore_notice = 0\npgsql.log_notice = 0\n\n[Sybase-CT]\nsybct.allow_persistent = On\nsybct.max_persistent = -1\nsybct.max_links = -1\nsybct.min_server_severity = 10\nsybct.min_client_severity = 10\n\n[bcmath]\nbcmath.scale = 0\n\n[browscap]\n\n[Session]\n;session.save_handler = files\nsession.save_handler = memcached\n;session.save_path = \"/var/tmp/php/session\"\nsession.save_path = \"tcp://localhost:11211\"\nsession.use_cookies = 1\nsession.use_only_cookies = 1\nsession.name = PHPSESSID\nsession.auto_start = 0\nsession.cookie_lifetime = 0\nsession.cookie_path = /\nsession.cookie_domain =\nsession.cookie_httponly =\nsession.serialize_handler = php\nsession.gc_probability = 1\nsession.gc_divisor = 1000\nsession.gc_maxlifetime = 1440\nsession.bug_compat_42 = Off\nsession.bug_compat_warn = Off\nsession.referer_check =\nsession.entropy_length = 0\nsession.entropy_file =\nsession.cache_limiter = nocache\nsession.cache_expire = 180\nsession.use_trans_sid = 0\nsession.hash_function = 0\nsession.hash_bits_per_character = 5\nurl_rewriter.tags = \"a=href,area=href,frame=src,input=src,form=fakeentry\"\n\n[MSSQL]\nmssql.allow_persistent = On\nmssql.max_persistent = -1\nmssql.max_links = -1\nmssql.min_error_severity = 10\nmssql.min_message_severity = 10\nmssql.compatability_mode = Off\nmssql.secure_connection = Off\n\n[Assertion]\n\n[COM]\n\n[mbstring]\n\n[gd]\n\n[exif]\n\n[Tidy]\ntidy.clean_output = Off\n\n[soap]\nsoap.wsdl_cache_enabled=1\nsoap.wsdl_cache_dir=\"/var/tmp\"\nsoap.wsdl_cache_ttl=86400\n\n[sysvshm]\n\n[apc]\nextension=apcu.so\n\napc.enabled=1\napc.enable_cli=1\napc.shm_segments=1\napc.shm_size=64M\napc.num_files_hint=128\napc.user_entries_hint=8192\napc.ttl=3600\napc.gc_ttl=3600\napc.user_ttl=7200\napc.use_request_time=1\napc.cache_by_default=1\napc.filters=.*\\.phar\napc.mmap_file_mask=/dev/zero\napc.file_update_protection=2\napc.max_file_size=1M\napc.stat=1\napc.stat_ctime=0\napc.canonicalize=0\napc.write_lock=1\napc.report_autofilter=0\napc.rfc1867=0\napc.rfc1867_prefix =upload_\napc.rfc1867_name=APC_UPLOAD_PROGRESS\napc.rfc1867_freq=0\napc.rfc1867_ttl=3600\napc.include_once_override=0\napc.lazy_classes=0\napc.lazy_functions=0\napc.coredump_unmap=0\napc.file_md5=0\napc.preload_path\n\n[opcache]\n;zend_extension=opcache.so\n\nopcache.enable=1\nopcache.enable_cli=1\nopcache.memory_consumption=128\nopcache.interned_strings_buffer=8\nopcache.max_accelerated_files=4000\nopcache.blacklist_filename=/etc/php.d/opcache*.blacklist\nopcache.revalidate_freq=60\nopcache.fast_shutdown=1\n\n[memcached]\n;extension=memcached.so\n```\n\n#### php.ini \u3092\u30b3\u30d4\u30fc\u3059\u308b\n\n```bash\n$ sudo cp -rf /etc/php.ini /etc/hhvm/php.ini\n```\n\n### memcached \u306e\u8a2d\u5b9a\n\n#### \u8a2d\u5b9a\u3092\u78ba\u8a8d\n\n```bash\n$ cat /etc/php.d/50-memcached.ini\n```\n\n```bash\n$ cat /etc/sysconfig/memcached\n```\n\n#### \u8d77\u52d5\n\n```bash\n$ sudo service memcached start && \\\nsudo chkconfig memcached on\n```\n\n### PHP-FPM \u3092\u8a2d\u5b9a\n\n#### \u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u6210\n\n```bash\n$ sudo mv /etc/php-fpm.conf /etc/php-fpm.conf_old && \\\nsudo vi /etc/php-fpm.conf\n```\n\n\u4e0b\u8a18\u3092\u30da\u30fc\u30b9\u30c8\u3002\n\n```\ninclude=/etc/php-fpm.d/*.conf\n\n[global]\npid = /var/run/php-fpm/php-fpm.pid\nerror_log = /var/log/php-fpm/error.log\n```\n\n\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u6210\u3002\n\n```bash\n$ sudo mv /etc/php-fpm.d/www.conf /etc/php-fpm.d/www.conf_old && \\\nsudo vi /etc/php-fpm.d/www.conf\n```\n\n\u4ee5\u4e0b\u3092\u30da\u30fc\u30b9\u30c8\u3002\n\n```\n[www]\nlisten = /var/run/php-fpm.sock\nlisten.owner = nginx\nlisten.group = nginx\nlisten.mode = 0666\n\nuser = nginx\ngroup = nginx\n\npm = dynamic\npm.max_children = 5\npm.start_servers = 1\npm.min_spare_servers = 1\npm.max_spare_servers = 4\npm.max_requests = 200\n\nrlimit_files = 131072\nrlimit_core = unlimited\n\nrequest_terminate_timeout = 90\nrequest_slowlog_timeout = 60\n\nslowlog = /var/log/php-fpm/www-slow.log\n\nphp_admin_value[error_log] = /var/log/php-fpm/www-error.log\nphp_admin_flag[log_errors] = on\nphp_admin_value[upload_max_filesize] = 4M\nphp_admin_value[post_max_size] = 4M\nphp_admin_value[max_execution_time] = 60\n```\n\n#### \u8d77\u52d5\n\n```bash\n$ sudo service php-fpm start && \\\nsudo chkconfig php-fpm on\n```\n\n### HHVM \u3092\u8d77\u52d5\n\n```bash\n$ sed -i -e '$ahhvm --mode daemon --user nginx --group nginx --config /etc/hhvm/server.hdf -vServer.Type=fastcgi -vServer.FileSocket=/var/run/hhvm/hhvm.sock' /etc/rc.d/rc.local && \\\nhhvm --mode daemon --user nginx --config /etc/hhvm/server.hdf -vServer.Type=fastcgi -vServer.FileSocket=/var/run/hhvm/hhvm.sock\n\n# \u3053\u306e\u30b3\u30de\u30f3\u30c9\u306f\u8981\u3089\u306a\u3044\uff1f\n$ update-alternatives --install /usr/bin/php php /usr/local/hhvm/hphp/hhvm/hhvm 60\n```\n\n```bash\n$ sudo service hhvm start && \\\nsudo chkconfig hhvm on \n```\n\n## MySQL \u306e\u8d77\u52d5\n\n```bash\n$ sudo service mysql start && \\\nsudo chkconfig mysql on\n```\n\n## \u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u30eb\u30fc\u30c8\u306e\u4f5c\u6210\n\n```bash\n$ sudo mkdir -m +w -p /var/www/vhosts/default/ && \\\nsudo chown -R nginx:nginx /var/www/vhosts/*\n```\n\n## WordPress \u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n### WP CLI \u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n```bash\n$ sudo wget https://raw.github.com/wp-cli/builds/gh-pages/phar/wp-cli.phar -O /usr/bin/wp && \\\nsudo chmod +x /usr/bin/wp\n```\n\n### WordPress \u7528\u306e DB \u3092\u4f5c\u6210\n\n```bash\n$ mysql -u root -p\n$ create database wordpress_db default character set utf8 collate utf8_general_ci;\n$ GRANT ALL PRIVILEGES ON wordpress_db.* TO wordpress_db@localhost IDENTIFIED BY 'wordpress_db' WITH GRANT OPTION;\n```\n\n### WordPress \u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\nroot \u30e6\u30fc\u30b6\u30fc\u3060\u3068\u30a8\u30e9\u30fc\u304c\u51fa\u308b\u306e\u3067\u6ce8\u610f\u3002\n\n```bash\n$ wp core download --locale=ja --path='/var/www/vhosts/default/'\n$ cd /var/www/vhosts/default\n$ wp core config --dbname='wordpress_db' --dbuser='wordpress_db' --dbpass='wordpress_db'\n$ wp core install --url='192.168.30.10' --title='WordPress Test' --admin_name='admin' --admin_password='admin' --admin_email='admin@example.jp'\n```\n\nroot \u30e6\u30fc\u30b6\u30fc\u306b\u623b\u308a\u3001\u5404\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306e\u6240\u6709\u8005\u3068\u30b0\u30eb\u30fc\u30d7\u3092\u5909\u66f4\u3002\n\n```bash\n$ sudo chown -R nginx:nginx /var/www/vhosts/default/*\n```\n\n## Nginx \u306e\u8d77\u52d5\n\n```bash\n$ sudo service nginx start && \\\nsudo chkconfig nginx on\n```\n\n## \u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\n\n### Exec-Shield \u3092\u6709\u52b9\u5316\n\n```bash\n$ su - root\n$ echo 2 > /proc/sys/kernel/exec-shield\n$ exit\n```\n\n### LogWatch\n\n\u30ed\u30b0\u76e3\u8996\u30c4\u30fc\u30eb\u3002\n\n```bash\n$ sudo yum -y install logwatch &&\\\nsudo logwatch --print\n```\n\n\u5fc5\u8981\u306b\u5fdc\u3058\u3066 logwatch \u306e\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb /etc/logwatch/conf/logwatch.conf \u3092\u66f8\u304d\u63db\u3048\u308b\u3002\n\n[Logwatch \u3092 CentOS \u306b\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b](http://www.websec-room.com/2014/01/18/1675)\n[\u30ed\u30b0\u76e3\u8996\u30c4\u30fc\u30eb logwatch \u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3068\u8a2d\u5b9a \u301c CentOS6](http://easyramble.com/install-setup-logwatch.html)\n\n### DenyHosts\n\nSSH \u306e\u30d6\u30eb\u30fc\u30c8\u30d5\u30a9\u30fc\u30b9\u30a2\u30bf\u30c3\u30af\u5bfe\u7b56\u30c4\u30fc\u30eb\u3002\n\n```bash\n$ sudo yum -y install denyhosts && \\\nsudo service denyhosts start && \\\nsudo chkconfig denyhosts on\n```\n\n### Clam AntiVirus\n\n\u30aa\u30fc\u30d7\u30f3\u30bd\u30fc\u30b9\u3067\u958b\u767a\u30fb\u904b\u7528\u3055\u308c\u3066\u3044\u308b\u30a6\u30a3\u30eb\u30b9\u5bfe\u7b56\u30bd\u30d5\u30c8\u3002\n\n```bash\n$ sudo yum -y --enablerepo=epel install clamd && \\\nsudo vi /etc/clamd.conf\n```\n\n\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u304c\u958b\u3044\u305f\u3089\u3001\u300cUser clam\u300d\u3092\u300cUser root\u300d\u3078\u5909\u66f4\u3002\n\nClam AntiVirus \u3092\u8d77\u52d5\u3055\u305b\u308b\u3002\n\n```bash\n$ sudo service clamd start && \\\nsudo chkconfig clamd on\n```\n\n\u30a6\u30a4\u30eb\u30b9\u5b9a\u7fa9\u30d5\u30a1\u30a4\u30eb\u3092\u30a2\u30c3\u30d7\u30c7\u30fc\u30c8\u3002\n\n```bash\n$ sudo freshclam\n```\n\n\u30b9\u30b1\u30b8\u30e5\u30fc\u30eb\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u6210\u3002\n\n```bash\n$ sudo vi /etc/cron.daily/virusscan\n```\n\n\u4e0b\u8a18\u3092\u30da\u30fc\u30b9\u30c8\u3002\n\n```\n#!/bin/bash\n\nPATH=/usr/bin:/bin\n\n# clamd update\nyum  --enablerepo=epel -y update clamd > /dev/null 2>&1\n\n# virus scan\nCLAMSCANTMP=`mktemp`\nclamscan --recursive --remove  / > $CLAMSCANTMP 2>&1\n[ ! -z \"$(grep FOUND$ $CLAMSCANTMP)\" ] && \\\n\n# when detect virus, send mail\ngrep FOUND$ $CLAMSCANTMP | mail -s \"Virus Found in `hostname`\" root\nrm -f $CLAMSCANTMP\n```\n\n\u5b9f\u884c\u6a29\u9650\u3092\u4ed8\u4e0e\u3002\n\n```bash\n$ sudo chmod +x /etc/cron.daily/virusscan\n```\n\n### WAF (Web Application Firewall)\n\nNginx \u306e\u5834\u5408\u3001ngx_pagespeed \u306a\u3069\u306e\u3088\u3046\u306b\u3001\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u304b\u3089\u30d3\u30eb\u30c9\u3057\u306a\u304f\u3066\u306f\u306a\u3089\u306a\u3044\u3002\n\n\u73fe\u5728\u8abf\u67fb\u4e2d\u3002\n\uff08WordPress \u3068\u4ef2\u826f\u304f\u3084\u308c\u308b\u306e\u3060\u308d\u3046\u304b\u30fb\u30fb\u30fb\u3002\uff09\n\n* [CentOS\u306bNginx\u3068ModSecurity\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b](http://qiita.com/tebora1969/items/4fb2463fe45621d1fec1)\n* [ModSecurity \u3092 nginx + passenger \u3067](http://tech.actindi.net/3576895793)\n\n## \u30d0\u30c3\u30af\u30a2\u30c3\u30d7\n\n```bash\n$ sudo wget ftp://mondo.mirror.pclark.com/pub/mondorescue/rhel/6/x86_64/mondorescue.repo -O /etc/yum.repos.d/mondorescue.repo && \\\nsudo yum -y --enablerepo=mondorescue install mondo && \\\nsudo mkdir ~/backup\n```\n\n\u30d0\u30c3\u30af\u30a2\u30c3\u30d7\u3092\u5b9f\u884c\u3002\n\n```bash\n$ sudo mondoarchive -Oi -s 10000m -d ~/.backup -E ~/.backup -S /tmp -T /tmp -p `hostname`_`date +%Y%m%d`\n```\n\n\u30d0\u30c3\u30af\u30a2\u30c3\u30d7\u30d5\u30a1\u30a4\u30eb\u3092\u30ed\u30fc\u30ab\u30eb\u306b\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3002\n\n```bash\n$ scp -P 10022 -i ~/.ssh/conoha_rsa exampleuser@192.168.0.0:/home/exampleuser/.backup/v192-168-0-0.example.jp_20150829-1.iso Desktop\n```\n\n## SSL \u306e\u8a2d\u5b9a\n\n### CSR \u3068\u79d8\u5bc6\u9375\u306e\u4f5c\u6210\nCSR \u30d5\u30a1\u30a4\u30eb\u306f SSL \u8a3c\u660e\u66f8\u8cfc\u5165\u7533\u8acb\u306e\u969b\u306b\u4f7f\u7528\u3057\u307e\u3059\u3002\n\n```\n$ openssl req -nodes -newkey -sha256 rsa:2048 -nodes -keyout example.jp.`date +'%Y%m%d'`.key -out example.jp.`date +'%Y%m%d'`.csr -subj \"/C=JP/ST=Tokyo/L=Shibuya-ku/O=OrganizationUnitName/OU=-/CN=example.jp\"\n```\n\n### \u8a3c\u660e\u66f8\u306e\u4f5c\u6210\nNginx \u306e\u5834\u5408 ssl_certificate \u306b\u6307\u5b9a\u3059\u308b\u30d5\u30a1\u30a4\u30eb\u3067\u3059\u3002\n\n```\n$ cat example_jp.crt \u30b5\u30fc\u30d0\u30fc\u8a3c\u660e\u66f8.crt \u4e2d\u9593\u8a3c\u660e\u66f8.crt \u30af\u30ed\u30b9\u30eb\u30fc\u30c8\u8a3c\u660e\u66f8.crt > example.jp.`date +'%Y%m%d'`.pem\n```\n\n### DH\u9375\u4ea4\u63db\u306b\u4f7f\u7528\u3059\u308b\u30d1\u30e9\u30e1\u30fc\u30bf\u30d5\u30a1\u30a4\u30eb\u306e\u4f5c\u6210\nNginx \u306e\u5834\u5408 ssl_dhparam \u306b\u6307\u5b9a\u3059\u308b\u30d5\u30a1\u30a4\u30eb\u3067\u3059\u3002\n\n```\n$ openssl dhparam 2048 -out example.jp.dhparam.`date +'%Y%m%d'`.pem\n```\n\n### TLS Session Ticket \u306b\u4f7f\u7528\u3059\u308b\u9375\u306e\u4f5c\u6210\nNginx \u306e\u5834\u5408 ssl_session_ticket_key \u306b\u6307\u5b9a\u3059\u308b\u30d5\u30a1\u30a4\u30eb\u3067\u3059\u3002\n\n```\n$ openssl rand 48 > example.jp.ticket.`date +'%Y%m%d'`.key\n```\n\n### OCSP Stapling \u306b\u4f7f\u7528\u3059\u308b\u30d1\u30e9\u30e1\u30fc\u30bf\u30d5\u30a1\u30a4\u30eb\u306e\u4f5c\u6210\nNginx \u306e\u5834\u5408 ssl_trusted_certificate \u306b\u6307\u5b9a\u3059\u308b\u30d5\u30a1\u30a4\u30eb\u3067\u3059\u3002\n\n```\n$ cat \u4e2d\u9593\u8a3c\u660e\u66f8.crt \u30af\u30ed\u30b9\u30eb\u30fc\u30c8\u8a3c\u660e\u66f8.crt \u30eb\u30fc\u30c8\u8a3c\u660e\u66f8.crt > example.jp.trusted.`date +'%Y%m%d'`.pem\n```\n\n### GeoTrust \u30af\u30a4\u30c3\u30afSSL\u30d7\u30ec\u30df\u30a2\u30e0\n\u4e2d\u9593CA\u8a3c\u660e\u66f8\nhttps://www.geotrust.co.jp/resources/repository/intermediate.html\n\u30eb\u30fc\u30c8CA\u8a3c\u660e\u66f8\nhttp://www.geotrust.com/resources/root-certificates/index.html\n\n### \u53c2\u8003\u30b5\u30a4\u30c8\n[Generate Mozilla Security Recommended Web Server Configuration Files](https://mozilla.github.io/server-side-tls/ssl-config-generator/)\n[SSL\u30c1\u30a7\u30c3\u30af\u30c4\u30fc\u30eb](https://sslcheck.globalsign.com/ja)\n[SSL Server Test](https://www.ssllabs.com/ssltest/index.html)\n[GeoTrust SSL ToolBox](https://ssltools.geotrust.com/checker/views/certCheck.jsp)\n[Security/Server Side TLS](https://wiki.mozilla.org/Security/Server_Side_TLS)\n\n\n## \u53c2\u8003\u30b5\u30a4\u30c8\u4e00\u89a7\n* [dogmap.jp](http://dogmap.jp/)\n* [ConoHa \u30d6\u30ed\u30b0](https://www.conoha.jp/blog)\n* [\u30ec\u30f3\u30bf\u30eb\u30b5\u30fc\u30d0\u30fc\u30fb\u81ea\u5b85\u30b5\u30fc\u30d0\u30fc\u8a2d\u5b9a\u30fb\u69cb\u7bc9\u306e\u30d2\u30f3\u30c8](http://server-setting.info/)\n* [CentOS6\u306bPHP5.6\u3092yum\u3067\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb](http://nob-log.info/2014/08/25/centos6-yum-install-php56/)\n* [Linux\u6a19\u6e96\u6559\u79d1\u66f8](http://www.lpi.or.jp/linuxtext/text.shtml)\n* [\u8a55\u5224\u306e\u3055\u304f\u3089\u306eVPS\u3092\u4f7f\u3046\u3068\u304d\u306b\u6700\u521d\u306b\u3084\u3063\u3066\u304a\u304d\u305f\u3044\u3053\u3068(CentOS\u7de8)](http://server-setting.info/blog/sakura_vps_centos_first_setup.html)\n* [\u6700\u4f4e\u9650\u5fc5\u8981\u306a CentOS \u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u8a2d\u5b9a](http://www.websec-room.com/2014/02/09/1822)\n", "tags": ["nginx", "HHVM", "WordPress", "mariadb", "CentOS"]}