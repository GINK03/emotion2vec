{"tags": ["SoftLayer", "vmware", "VMware_ESXi", "VMware_vSphere"], "context": "\n\n\u53c2\u8003\u8a18\u4e8b\n\nQuick Tip \u2013 iPerf now available on ESXi | virtuallyGhetto\nCUI\u3067ESXi\u306e\u30d5\u30a1\u30a4\u30e4\u30a6\u30a9\u30fc\u30eb\u8a2d\u5b9a | \u306d\u3053\u308d\u304f\u3076\u308d\u3050\n\n\n0.iperf\u30d5\u30a1\u30a4\u30eb\u306e\u5b58\u5728\u3092\u78ba\u8a8d\n[root@esx01:~] ls /usr/lib/vmware/vsan/bin/iperf\n/usr/lib/vmware/vsan/bin/iperf\n\n\n1.iperf\u30d5\u30a1\u30a4\u30eb\u306e\u30b3\u30d4\u30fc\niperf\u30b3\u30de\u30f3\u30c9\u3092\u6253\u3064\u3068\u4ee5\u4e0b\u306e\u30a8\u30e9\u30fc\u3068\u306a\u308b\n\u300cbind failed: Operation not permitted\u300d\n[root@esx01:~] /usr/lib/vmware/vsan/bin/iperf -s\nbind failed: Operation not permitted\n------------------------------------------------------------\nServer listening on TCP port 5001\nTCP window size: 64.0 KByte (default)\n------------------------------------------------------------\n\n\u306e\u3067\u30b3\u30d4\u30fc\u3092\u884c\u3044\u307e\u3059\ncp /usr/lib/vmware/vsan/bin/iperf /usr/lib/vmware/vsan/bin/iperf.copy\n\n\n2.\u30a2\u30c9\u30ec\u30b9\u3078\u306e\u30d0\u30a4\u30f3\u30c9\u3092\u884c\u3046\n\u8907\u6570\u30a2\u30c9\u30ec\u30b9\u3092\u6301\u3063\u3066\u3044\u308b\u5834\u5408\u3067\u3082\u3001\u30d0\u30a4\u30f3\u30c9\u3059\u308b\u30a2\u30c9\u30ec\u30b9\u3092\u6307\u5b9a\u3067\u304d\u307e\u3059\u3002\n\u4eca\u5ea6\u306f\u30a8\u30e9\u30fc\u304c\u51fa\u306a\u304f\u306a\u308a\u307e\u3059\u3002\n[root@esx01:~] /usr/lib/vmware/vsan/bin/iperf.copy -s -B 10.xx.xx.xx\n------------------------------------------------------------\nServer listening on TCP port 5001\nBinding to local address 10.133.157.199\nTCP window size: 64.0 KByte (default)\n------------------------------------------------------------\n\n\n3.\u30d5\u30a1\u30a4\u30a2\u30a6\u30a9\u30fc\u30eb\u306e\u7121\u52b9\u5316\niperf\u3067\u306f\u30c7\u30d5\u30a9\u30eb\u30c8\u3067TCP\u3001UDP\u306e5001\u30dd\u30fc\u30c8\u3092\u4f7f\u7528\u3057\u307e\u3059\u304c\u3001\nESXi\u30db\u30b9\u30c8\u3067\u306fiperf\u306b\u3064\u3044\u3066\u306f\u7d30\u304b\u3044\u30d5\u30a1\u30a4\u30a2\u30a6\u30a9\u30fc\u30eb\u8a2d\u5b9a\u304c\u5b58\u5728\u3057\u306a\u3044\u305f\u3081\u3001\niperf\u3092\u30db\u30b9\u30c8\u306b\u5411\u3051\u3066\u5b9f\u65bd\u3059\u308b\u969b\u306f\u3001\u30d5\u30a1\u30a4\u30a2\u30a6\u30a9\u30fc\u30eb\u3092\u7121\u52b9\u306b\u3057\u307e\u3059\u3002\nesxcli network firewall set --enabled false\n\n\n4.iperf\u306e\u5b9f\u884c\n\u4e0a\u8a18\u3067\u8a2d\u5b9a\u3057\u305fESXi\u30db\u30b9\u30c8\u306b\u5411\u3051\u3066\u3001\u4ed6\u306eESXi\u30db\u30b9\u30c8\u304b\u3089iperf\u3092\u8a66\u3057\u307e\u3057\u305f\u3002\n\u610f\u5916\u3068\u666e\u901a\u306b\u4f7f\u3048\u308b\u3082\u306e\u3067\u3059\u306d\u3002\n[root@ESX001:~] /usr/lib/vmware/vsan/bin/iperf.copy -c 10.xx.xx.xx -i 10 -t 60 -m\n------------------------------------------------------------\nClient connecting to 10.xx.xx.xx, TCP port 5001\nTCP window size: 32.5 KByte (default)\n------------------------------------------------------------\n[  3] local 192.xx.xx.xx port 58904 connected with 10.xx.xx.xx port 5001\n[ ID] Interval       Transfer     Bandwidth\n[  3]  0.0-10.0 sec  1.07 GBytes   919 Mbits/sec\n[  3] 10.0-20.0 sec  1.08 GBytes   931 Mbits/sec\n[  3] 20.0-30.0 sec  1.08 GBytes   927 Mbits/sec\n[  3] 30.0-40.0 sec  1.09 GBytes   940 Mbits/sec\n[  3] 40.0-50.0 sec  1.08 GBytes   925 Mbits/sec\n[  3] 50.0-60.0 sec  1.08 GBytes   928 Mbits/sec\n[  3]  0.0-60.0 sec  6.48 GBytes   928 Mbits/sec\n[  3] MSS size 1448 bytes (MTU 1500 bytes, ethernet)\n\n#\u53c2\u8003\u8a18\u4e8b\n- [Quick Tip \u2013 iPerf now available on ESXi | virtuallyGhetto](http://www.virtuallyghetto.com/2016/03/quick-tip-iperf-now-available-on-esxi.html)\n- [CUI\u3067ESXi\u306e\u30d5\u30a1\u30a4\u30e4\u30a6\u30a9\u30fc\u30eb\u8a2d\u5b9a | \u306d\u3053\u308d\u304f\u3076\u308d\u3050](https://www.neko6.info/archives/1338)\n\n#0.iperf\u30d5\u30a1\u30a4\u30eb\u306e\u5b58\u5728\u3092\u78ba\u8a8d\n\n```\n[root@esx01:~] ls /usr/lib/vmware/vsan/bin/iperf\n/usr/lib/vmware/vsan/bin/iperf\n```\n\n#1.iperf\u30d5\u30a1\u30a4\u30eb\u306e\u30b3\u30d4\u30fc\niperf\u30b3\u30de\u30f3\u30c9\u3092\u6253\u3064\u3068\u4ee5\u4e0b\u306e\u30a8\u30e9\u30fc\u3068\u306a\u308b\n\u300cbind failed: Operation not permitted\u300d\n\n```\n[root@esx01:~] /usr/lib/vmware/vsan/bin/iperf -s\nbind failed: Operation not permitted\n------------------------------------------------------------\nServer listening on TCP port 5001\nTCP window size: 64.0 KByte (default)\n------------------------------------------------------------\n```\n\n\u306e\u3067\u30b3\u30d4\u30fc\u3092\u884c\u3044\u307e\u3059\n\n```\ncp /usr/lib/vmware/vsan/bin/iperf /usr/lib/vmware/vsan/bin/iperf.copy\n```\n\n#2.\u30a2\u30c9\u30ec\u30b9\u3078\u306e\u30d0\u30a4\u30f3\u30c9\u3092\u884c\u3046\n\u8907\u6570\u30a2\u30c9\u30ec\u30b9\u3092\u6301\u3063\u3066\u3044\u308b\u5834\u5408\u3067\u3082\u3001\u30d0\u30a4\u30f3\u30c9\u3059\u308b\u30a2\u30c9\u30ec\u30b9\u3092\u6307\u5b9a\u3067\u304d\u307e\u3059\u3002\n\u4eca\u5ea6\u306f\u30a8\u30e9\u30fc\u304c\u51fa\u306a\u304f\u306a\u308a\u307e\u3059\u3002\n\n```\n[root@esx01:~] /usr/lib/vmware/vsan/bin/iperf.copy -s -B 10.xx.xx.xx\n------------------------------------------------------------\nServer listening on TCP port 5001\nBinding to local address 10.133.157.199\nTCP window size: 64.0 KByte (default)\n------------------------------------------------------------\n```\n\n#3.\u30d5\u30a1\u30a4\u30a2\u30a6\u30a9\u30fc\u30eb\u306e\u7121\u52b9\u5316\niperf\u3067\u306f\u30c7\u30d5\u30a9\u30eb\u30c8\u3067TCP\u3001UDP\u306e5001\u30dd\u30fc\u30c8\u3092\u4f7f\u7528\u3057\u307e\u3059\u304c\u3001\nESXi\u30db\u30b9\u30c8\u3067\u306fiperf\u306b\u3064\u3044\u3066\u306f\u7d30\u304b\u3044\u30d5\u30a1\u30a4\u30a2\u30a6\u30a9\u30fc\u30eb\u8a2d\u5b9a\u304c\u5b58\u5728\u3057\u306a\u3044\u305f\u3081\u3001\niperf\u3092\u30db\u30b9\u30c8\u306b\u5411\u3051\u3066\u5b9f\u65bd\u3059\u308b\u969b\u306f\u3001\u30d5\u30a1\u30a4\u30a2\u30a6\u30a9\u30fc\u30eb\u3092\u7121\u52b9\u306b\u3057\u307e\u3059\u3002\n\n```\nesxcli network firewall set --enabled false\n```\n\n#4.iperf\u306e\u5b9f\u884c\n\u4e0a\u8a18\u3067\u8a2d\u5b9a\u3057\u305fESXi\u30db\u30b9\u30c8\u306b\u5411\u3051\u3066\u3001\u4ed6\u306eESXi\u30db\u30b9\u30c8\u304b\u3089iperf\u3092\u8a66\u3057\u307e\u3057\u305f\u3002\n\u610f\u5916\u3068\u666e\u901a\u306b\u4f7f\u3048\u308b\u3082\u306e\u3067\u3059\u306d\u3002\n\n```\n[root@ESX001:~] /usr/lib/vmware/vsan/bin/iperf.copy -c 10.xx.xx.xx -i 10 -t 60 -m\n------------------------------------------------------------\nClient connecting to 10.xx.xx.xx, TCP port 5001\nTCP window size: 32.5 KByte (default)\n------------------------------------------------------------\n[  3] local 192.xx.xx.xx port 58904 connected with 10.xx.xx.xx port 5001\n[ ID] Interval       Transfer     Bandwidth\n[  3]  0.0-10.0 sec  1.07 GBytes   919 Mbits/sec\n[  3] 10.0-20.0 sec  1.08 GBytes   931 Mbits/sec\n[  3] 20.0-30.0 sec  1.08 GBytes   927 Mbits/sec\n[  3] 30.0-40.0 sec  1.09 GBytes   940 Mbits/sec\n[  3] 40.0-50.0 sec  1.08 GBytes   925 Mbits/sec\n[  3] 50.0-60.0 sec  1.08 GBytes   928 Mbits/sec\n[  3]  0.0-60.0 sec  6.48 GBytes   928 Mbits/sec\n[  3] MSS size 1448 bytes (MTU 1500 bytes, ethernet)\n```\n"}