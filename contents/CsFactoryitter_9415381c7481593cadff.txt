{"context": " More than 1 year has passed since last update.\u5f53\u8a18\u4e8b\u306f\u30b1\u30fc\u30b9\u30b9\u30bf\u30c7\u30a3\u306e\u9023\u8f09\u3068\u306a\u3063\u3066\u3044\u307e\u3059\u3002\u76ee\u6b21\u306f\u3010\u3053\u3061\u3089\u3011\u3067\u3059\u3002\n\u6700\u65b0\u306e\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u306f\u3010GitHub\u3011\u3067\u516c\u958b\u4e2d\u3067\u3059\u3002\n\u30b5\u30fc\u30d0\u306e\u8cac\u52d9\u306f\u3053\u3061\u3089\u3067\u78ba\u8a8d\u304f\u3060\u3055\u3044\u3002\n\u4eca\u56de\u306f\u3001\u30e6\u30fc\u30b6\u30fc\u3068\u30b0\u30eb\u30fc\u30d7\u3092\u4f5c\u6210\u3059\u308b\u3002Ansible\u3067\u30e6\u30fc\u30b6\u30fc(user)\u8ffd\u52a0\u30e2\u30b8\u30e5\u30fc\u30eb\u3068\u30b0\u30eb\u30fc\u30d7(group)\u8ffd\u52a0\u30e2\u30b8\u30e5\u30fc\u30eb\u3092\u4f7f\u3046\u3002\n\u203buser\u306epassword\u306f\u30cf\u30c3\u30b7\u30e5\u5316\u3059\u308b\u3002\n\n1.\u30e6\u30fc\u30b6\u30fc\u4f5c\u6210\u6982\u8981\n\u4e00\u756a\u6700\u521d\u306b\u5168\u3066\u306e\u30b5\u30fc\u30d0\u306b\u5bfe\u3057\u3066\u5fc5\u8981\u306a\u30e6\u30fc\u30b6\u30fc\u3068\u30b0\u30eb\u30fc\u30d7\u3092\u4f5c\u6210\u3059\u308b\u3002\n\n\n2.playbook\u30d5\u30a1\u30a4\u30eb\u306e\u76f8\u95a2\n\n\n3.playbook(site.yml)\n${ANSIBLE_HOME}/site.yml\n\u30e1\u30a4\u30f3\u3068\u306a\u308bplaybook(site.yml)\u53c2\u7167\n\n4.\u30e6\u30fc\u30b6\u30fc\u4f5c\u6210\u7528\u306eplaybook\u5168\u4f53\n${ANSIBLE_HOME}/operations/0011_usergroup.yml\n\n0011_usergroup.yml\n# ===================\n# \u30e6\u30fc\u30b6\u30fc\u306e\u8ffd\u52a0(usergroup.yml)\n# ===================\n\n# ===================\n# \u5168\u30b5\u30fc\u30d0\u5171\u901a\u306e\u30e6\u30fc\u30b6\u30fc\u3092\u4f5c\u6210\n# Ansible\u306f\u5168\u3066user\u3067\u884c\u3046\u304c\u3001\u904b\u7528\u6642\u306b\u306finfra\u30e6\u30fc\u30b6\u30fc\n# \u3092\u5229\u7528\u3057\u30b5\u30fc\u30d0\u904b\u7528\u3092\u884c\u3046\u3002\n# ===================\n- hosts: all\n  sudo: no\n  remote_user: root\n  vars_files:\n    - ../vars/usergroup.yml\n  tasks:\n    - name: infra\u30b0\u30eb\u30fc\u30d7\u8ffd\u52a0\n      group: name={{usergroup.infra.group }} gid={{usergroup.infra.gid}}\n    - name: infra\u30e6\u30fc\u30b6\u30fc\u8ffd\u52a0\n      user: name={{usergroup.infra.user}} uid={{usergroup.infra.uid}} group={{usergroup.infra.group}} update_password=always password={{usergroup.infra.password}}\n\n# ===================\n# ap_admin(apserv01\u3068adminserv01)\u306b\u9069\u7528\n#  \u30fbapache\u30b0\u30eb\u30fc\u30d7/\u30e6\u30fc\u30b6\u30fc\u306e\u7528\u9014\n#     \u30fbadminserv01\n#         \u30fbCI(Jenkins)\u7528HTTP\u30b5\u30fc\u30d0\n#         \u30fbadminserv01\u306fapserv01\u306b\u30c7\u30d7\u30ed\u30a4\u3059\u308b\u524d\u306b\u30c6\u30b9\u30c8\u7528\u9014\u3068\u3057\u3066\u3082\u4f7f\u7528\u3059\u308b\n#     \u30fbapserv01\n#         \u30fbWeb\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u7528HTTP\u30b5\u30fc\u30d0\n#  \u30fbtomcat\u30b0\u30eb\u30fc\u30d7/\u30e6\u30fc\u30b6\u30fc\u306e\u7528\u9014\n#     \u30fbadminserv01\n#         \u30fbCI(Jenkins)\u7528JavaApplication\u30b5\u30fc\u30d0\n#         \u30fbadminserv01\u306fAP\u30b5\u30fc\u30d0\u306b\u30c7\u30d7\u30ed\u30a4\u3059\u308b\u524d\u306b\u30c6\u30b9\u30c8\u7528\u9014\u3068\u3057\u3066\u3082\u4f7f\u7528\u3059\u308b\n#     \u30fbapserv01\n#         \u30fbWeb\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u7528JavaApplication\u30b5\u30fc\u30d0\n# ===================\n- hosts: ap_admin\n  sudo: no\n  remote_user: root\n  vars_files:\n    - ../vars/usergroup.yml\n  tasks:\n    - name: apache\u30b0\u30eb\u30fc\u30d7\u8ffd\u52a0\n      group: name={{usergroup.apache.group }} gid={{usergroup.apache.gid}}\n\n    - name: tomcat\u30b0\u30eb\u30fc\u30d7\u8ffd\u52a0\n      group: name={{usergroup.tomcat.group }} gid={{usergroup.tomcat.gid}}\n\n    - name: apache\u30e6\u30fc\u30b6\u30fc\u8ffd\u52a0\n      user: \n\u3000\u3000  name={{usergroup.apache.user}}\n        uid={{usergroup.apache.uid}}\n        group={{usergroup.apache.group}}\n        update_password=always \n        password={{usergroup.apache.password}}\n\n    - name: tomcat\u30e6\u30fc\u30b6\u30fc\u8ffd\u52a0\n      user: name={{usergroup.tomcat.user}} uid={{usergroup.tomcat.uid}} group={{usergroup.tomcat.group}}  update_password=always password={{usergroup.tomcat.password}}\n\n# ===================\n# db_admin(dbserv01\u3068adminserv01)\u306b\u9069\u7528\n#  \u30fbmysql\u30b0\u30eb\u30fc\u30d7/\u30e6\u30fc\u30b6\u30fc\u306e\u7528\u9014\n#     \u30fbadminserv01\n#         \u30fbadminserv01\u306fdb\u30b5\u30fc\u30d0\u3078\u306e\u672c\u756a\u4ee5\u964d\u524d\u306b\u30c6\u30b9\u30c8\u7528\u9014\u3068\u3057\u3066\u3082\u4f7f\u7528\u3059\u308b\n#     \u30fbdbserv01\n#         \u30fb\u672c\u756a\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u30b5\u30fc\u30d0\n# ===================\n- hosts: db_admin\n  sudo: no\n  remote_user: root\n  vars_files:\n    - ../vars/usergroup.yml\n  tasks:\n    - name: mysql\u30b0\u30eb\u30fc\u30d7\u8ffd\u52a0\n      group: name={{usergroup.mysql.group }} gid={{usergroup.mysql.gid}}\n    - name: mysql\u30e6\u30fc\u30b6\u30fc\u8ffd\u52a0\n      user: name={{usergroup.mysql.user}} uid={{usergroup.mysql.uid}} group={{usergroup.mysql.group}}  update_password=always password={{usergroup.mysql.password}}\n\n# ===================\n# adminserv01\u306b\u9069\u7528\n#  \u30fbselenium\u30b0\u30eb\u30fc\u30d7/\u30e6\u30fc\u30b6\u30fc\u306e\u7528\u9014\n#     \u30fbadminserv01\n#         \u30fbWEBGUI\u30c6\u30b9\u30c6\u30a3\u30f3\u30b0\u306e\u8d77\u52d5/\u5236\u5fa1\u3092\u884c\u3046SelniumGrid\u3092\u52d5\u4f5c\u3055\u305b\u308b\n# ===================\n- hosts: adminservers\n  sudo: no\n  remote_user: root\n  vars_files:\n    - ../vars/usergroup.yml\n  tasks:\n    - name: selenium\u30b0\u30eb\u30fc\u30d7\u8ffd\u52a0\n      group: name={{usergroup.selenium.group }} gid={{usergroup.selenium.gid}}\n    - name: selenium\u30e6\u30fc\u30b6\u30fc\u8ffd\u52a0\n      user: name={{usergroup.selenium.user}} uid={{usergroup.selenium.uid}} group={{usergroup.selenium.group}}  update_password=always password={{usergroup.selenium.password}}\n\n\n\nAnsible\u3067\u306e\u30b0\u30eb\u30fc\u30d7(group)\u8ffd\u52a0\u30e2\u30b8\u30e5\u30fc\u30eb\n\nAnsible\u3067\u30b0\u30eb\u30fc\u30d7\u3092\u8ffd\u52a0\u3059\u308b\u306b\u306fgroup\u30e2\u30b8\u30e5\u30fc\u30eb\u3092\u4f7f\u3046\u3002\n\n\u66f8\u5f0f:\n\ngroup: name=${\u30b0\u30eb\u30fc\u30d7\u540d\u79f0} gid=${GID}\n\n\u4f8b:\ngroup: name={{usergroup.apache.group }} gid={{usergroup.apache.gid}} \n\n\nAnsible\u3067\u306e\u30e6\u30fc\u30b6\u30fc(user)\u8ffd\u52a0\u30e2\u30b8\u30e5\u30fc\u30eb\n\nAnsible\u3067\u30e6\u30fc\u30b6\u30fc\u3092\u8ffd\u52a0\u3059\u308b\u306b\u306fuser\u30e2\u30b8\u30e5\u30fc\u30eb\u3092\u4f7f\u3046\u3002\u30e6\u30fc\u30b6\u30fc\u4f5c\u6210\u6642\u306f\u30b0\u30eb\u30fc\u30d7\u540d\u79f0\u3092\u6307\u5b9a\u3057\u3066GID\u306f\u6307\u5b9a\u3057\u306a\u3044\u3002\n\n\u66f8\u5f0f:\n\nuser: name=${\u30e6\u30fc\u30b6\u30fc\u540d} uid=${UID} group={\u30b0\u30eb\u30fc\u30d7\u540d\u79f0} update_password=${\u30d1\u30b9\u30ef\u30fc\u30c9\u306e\u66f4\u65b0(always \u307e\u305f\u306f on_create)}\n\n\u4f8b:\nuser: name={{usergroup.selenium.user}} uid={{usergroup.selenium.uid}} group={{usergroup.selenium.group}}  update_password=always\n\n\nvar_files\u306e\u69cb\u9020\n\n\nvar_files\u3082yaml\u306e\u6cd5\u5247\u306b\u5f93\u3044\u968e\u5c64\u69cb\u9020\u3067\u8a18\u8ff0\u3002\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u8a2d\u5b9a\u304b\u3089\u3001uid:1200\u306e\u5024\u3092playbook\u304b\u3089\u53d6\u5f97\u3057\u305f\u3044\u5834\u5408\u306f\n\n\n\nusergroup:\n\u00a0\u00a0tomcat:\n\u00a0\u00a0\u00a0\u00a0user: tomcat\n\u00a0\u00a0\u00a0\u00a0group: tomcat\n\u00a0\u00a0\u00a0\u00a0uid: 1200\n\u00a0\u00a0\u00a0\u00a0gid: 1200\n\u00a0\u00a0\u00a0\u00a0home: /home/tomcat\n\u00a0\u00a0\u00a0\u00a0shell: /bin/bash\n\nusergroup\u914d\u4e0btomcat\u306e\u914d\u4e0b\u306euid\u3092\u53d6\u5f97\u3059\u308b\u70ba\u3001\nusergroup.tomcat.uid\u3068\u3010.(\u30d4\u30ea\u30aa\u30c9)\u3011\u3067\u5b9a\u7fa9\u3092\u7e4b\u304e\u3001\u5de6\u53f3\u3092{{ }}\u3067\u62ec\u308a\u3001\n{{usergroup.tomcat.uid}}\n\u203b\u4ee5\u524d\u306eAnsible\u3067\u306f${ }\u3067\u53d6\u5f97\u53ef\u80fd\u3060\u3063\u305f\u304c\u73fe\u5728\u306eAnsible\u3067\u306f\u53d6\u5f97\u3067\u304d\u306a\u3044\u70ba\u6ce8\u610f\u3002\n\n5.playbook(/vars/usergroup.yml)\n${ANSIBLE_HOME}/vars/usergroup.yml\n\u203buser\u30e2\u30b8\u30e5\u30fc\u30eb\u306epassword(\u30d1\u30b9\u30ef\u30fc\u30c9)\u306f\u30cf\u30c3\u30b7\u30e5\u5316\u304c\u5fc5\u8981\u3002\n0011_usergroup.yml\u3067\u306f\u5909\u6570\u8a2d\u5b9a\u3092\u3057\u3066\u3044\u308b\u3002\nuser\u30e2\u30b8\u30e5\u30fc\u30eb\u306e\u30d1\u30b9\u30ef\u30fc\u30c9\u306f\u30cf\u30c3\u30b7\u30e5\u5316\u3059\u308b\u5fc5\u8981\u304c\u3042\u308b\u3053\u3068\u306b\u6ce8\u610f\u3002\n\u30cf\u30c3\u30b7\u30e5\u5316\u3059\u308b\u306b\u306f\u4eca\u56de\u306fmanageterm(Ansible\u7ba1\u7406\u7aef\u672b\uff09\u304b\u3089\u4ee5\u4e0b\u3092\u5b9f\u884c\u3002\n\u66f8\u5f0f\uff1a\n\npython -c 'import crypt; print crypt.crypt(\"\u30d1\u30b9\u30ef\u30fc\u30c9\", \"$6$\u30bd\u30eb\u30c8$\")'\n\n\u4f8b\uff1a\npython -c 'import crypt; print crypt.crypt(\"apache123\", \"$6$apachesolt$\")'\n\n\u4ee5\u4e0a\u306e\u8a2d\u5b9a\u3067\u300capache123\u300d\u3068\u3044\u3046\u30cf\u30c3\u30b7\u30e5\u5316\u3055\u308c\u305f\u30d1\u30b9\u30ef\u30fc\u30c9\u304c\u30b5\u30fc\u30d0\u8a2d\u5b9a\u3055\u308c\u308b\u3053\u3068\u306b\u306a\u308b\u3002\n# ===================\n#\u30e6\u30fc\u30b6\u30fc\u60c5\u5831\u3092\u5909\u6570\u5b9a\u7fa9\u3057\u307e\u3059\u3002\n#\u30d1\u30b9\u30ef\u30fc\u30c9\u306f\u30cf\u30c3\u30b7\u30e5\u5316\u3059\u308b\u5fc5\u8981\u304c\u3042\u308b\u70ba\u3001python\u306e\u30b3\u30de\u30f3\u30c9\u306b\u3066\u30cf\u30c3\u30b7\u30e5\u5316\u3057\u305f\u30d1\u30b9\u30ef\u30fc\u30c9\u3092\u8a2d\u5b9a\n# python -c 'import crypt; print crypt.crypt(\"\u30d1\u30b9\u30ef\u30fc\u30c9\", \"$6$\u30bd\u30eb\u30c8$\")'\n# ===================\n  usergroup:\n    tomcat:\n      user: tomcat\n      group: tomcat\n      uid: 1200\n      gid: 1200\n      home: /home/tomcat\n      shell: /bin/bash\n      # ===================\n      # python -c 'import crypt; print crypt.crypt(\"tomcat123\", \"$6$tomcatsolt$\")'\n      # ===================\n      password: $6$tomcatsolt$Dz8QThSePXH5WZ0EjLQbUA8pZJrgIl4.2qsflSWkn1gV.RqD84vPT0.tdThOEn1VyowWJBsTgm2rmv5oJixDJ1\n    apache:\n      user: apache\n      group: apache\n      uid: 1100\n      gid: 1100\n      home: /home/apache\n      shell: /bin/bash\n      # ===================\n      # python -c 'import crypt; print crypt.crypt(\"tomcat123\", \"$6$tomcatsolt$\")'\n      # ===================\n      password: $6$apachesolt$PnTyYlBO7ZAmPmXNBxAgWj03udlCNxqOqWvfik.fM3A84UTG.Un0cWUaXEl2vT2Acme.lMsPVRapEOZ9MhWYr0\n    mysql:\n      user: mysql\n      group: mysql\n      uid: 1300\n      gid: 1300\n      home: /home/mysql\n      shell: /bin/bash\n      # ===================\n      # python -c 'import crypt; print crypt.crypt(\"tomcat123\", \"$6$tomcatsolt$\")'\n      # ===================\n      password: $6$mysqlsolt$IeAbOR9NxGYA3Os9p43DRjdGvuTae62i707gWa2/XP/IFVyjHIYsEe/gH5uc15pxwyhAk8kGuRbi6Iinga5wh/\n    infra:\n      user: infra\n      group: infra\n      uid: 1400\n      gid: 1400\n      home: /home/infra\n      shell: /bin/bash\n      # ===================\n      # python -c 'import crypt; print crypt.crypt(\"tomcat123\", \"$6$tomcatsolt$\")'\n      # ===================\n      password: $6$infrasolt$a2vFx7QL/cV2Nplcy1AxeRp8Ss34MPTjkbKpu7au.kq.PXshj8K177TUH9Pj5wtG8Y83Ea5Nv8UlvRuBMN5Fu0\n    selenium:\n      user: selenium\n      group: selenium\n      uid: 1600\n      gid: 1600\n      home: /home/selenium\n      shell: /bin/bash\n      # ===================\n      # python -c 'import crypt; print crypt.crypt(\"tomcat123\", \"$6$tomcatsolt$\")'\n      # ===================\n      password: $6$seleniumsolt$fl7ibc.Xf/.xnbIFqIXuGA3rtddYdZiUILqVvJO06cjGXy.HmpDh1LjXZYLKqzZymjn1GqmQkz2ndc8lfbfTz/\n\n\u6b21\u56de\u306f\u300cyum\u306b\u3066\u5fc5\u8981\u306a\u30e9\u30a4\u30d6\u30e9\u30ea\uff0f\u30df\u30c9\u30eb\uff0f\u30bd\u30d5\u30c8\u30a6\u30a7\u30a2\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\u3010Ansible yum\u30e2\u30b8\u30e5\u30fc\u30eb\u3011\u300d\u306b\u3064\u3044\u3066\u3002\n\u9023\u8f09\u306e\u76ee\u6b21\u306f\u3010\u3053\u3061\u3089\u3011\u3067\u3059\u3002\n<b><font color=\"#ff6633\">\u5f53\u8a18\u4e8b\u306f\u30b1\u30fc\u30b9\u30b9\u30bf\u30c7\u30a3\u306e\u9023\u8f09\u3068\u306a\u3063\u3066\u3044\u307e\u3059\u3002\u76ee\u6b21\u306f[\u3010\u3053\u3061\u3089\u3011](http://qiita.com/CsFactoryitter/items/6b8308b96afafd61ce5f\n)\u3067\u3059\u3002</font></b>\n<b><font color=\"#ff6633\">\u6700\u65b0\u306e\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u306f[\u3010GitHub\u3011](https://github.com/csfactorygihubblog001/blogansible)\u3067\u516c\u958b\u4e2d\u3067\u3059\u3002</font></b>\n\n\u30b5\u30fc\u30d0\u306e\u8cac\u52d9\u306f<b>[\u3053\u3061\u3089](http://qiita.com/CsFactoryitter/items/032cc339048e52ee3586)</b>\u3067\u78ba\u8a8d\u304f\u3060\u3055\u3044\u3002\n\n\u4eca\u56de\u306f\u3001\u30e6\u30fc\u30b6\u30fc\u3068\u30b0\u30eb\u30fc\u30d7\u3092\u4f5c\u6210\u3059\u308b\u3002Ansible\u3067\u30e6\u30fc\u30b6\u30fc(user)\u8ffd\u52a0\u30e2\u30b8\u30e5\u30fc\u30eb\u3068\u30b0\u30eb\u30fc\u30d7(group)\u8ffd\u52a0\u30e2\u30b8\u30e5\u30fc\u30eb\u3092\u4f7f\u3046\u3002\n\u203buser\u306epassword\u306f\u30cf\u30c3\u30b7\u30e5\u5316\u3059\u308b\u3002\n\n##1.\u30e6\u30fc\u30b6\u30fc\u4f5c\u6210\u6982\u8981\n\u4e00\u756a\u6700\u521d\u306b\u5168\u3066\u306e\u30b5\u30fc\u30d0\u306b\u5bfe\u3057\u3066\u5fc5\u8981\u306a\u30e6\u30fc\u30b6\u30fc\u3068\u30b0\u30eb\u30fc\u30d7\u3092\u4f5c\u6210\u3059\u308b\u3002\n\n![image](https://qiita-image-store.s3.amazonaws.com/0/98085/9a09930f-c80d-3284-9f5f-61aa2d183175.png)\n\n##2.playbook\u30d5\u30a1\u30a4\u30eb\u306e\u76f8\u95a2\n\n![image](https://qiita-image-store.s3.amazonaws.com/0/98085/553e130b-0a93-5488-ddac-40ea86a2cfc8.png)\n\n##3.playbook(site.yml)\n${ANSIBLE_HOME}/site.yml\n[\u30e1\u30a4\u30f3\u3068\u306a\u308bplaybook(site.yml)](http://qiita.com/CsFactoryitter/items/3112c6d504d3b5a58011#3%E3%83%A1%E3%82%A4%E3%83%B3%E3%81%A8%E3%81%AA%E3%82%8Bplaybooksiteyml)\u53c2\u7167\n\n##4.\u30e6\u30fc\u30b6\u30fc\u4f5c\u6210\u7528\u306eplaybook\u5168\u4f53\n\\${ANSIBLE_HOME}/operations/0011_usergroup.yml\n\n```yaml:0011_usergroup.yml\n# ===================\n# \u30e6\u30fc\u30b6\u30fc\u306e\u8ffd\u52a0(usergroup.yml)\n# ===================\n \n# ===================\n# \u5168\u30b5\u30fc\u30d0\u5171\u901a\u306e\u30e6\u30fc\u30b6\u30fc\u3092\u4f5c\u6210\n# Ansible\u306f\u5168\u3066user\u3067\u884c\u3046\u304c\u3001\u904b\u7528\u6642\u306b\u306finfra\u30e6\u30fc\u30b6\u30fc\n# \u3092\u5229\u7528\u3057\u30b5\u30fc\u30d0\u904b\u7528\u3092\u884c\u3046\u3002\n# ===================\n- hosts: all\n  sudo: no\n  remote_user: root\n  vars_files:\n    - ../vars/usergroup.yml\n  tasks:\n    - name: infra\u30b0\u30eb\u30fc\u30d7\u8ffd\u52a0\n      group: name={{usergroup.infra.group }} gid={{usergroup.infra.gid}}\n    - name: infra\u30e6\u30fc\u30b6\u30fc\u8ffd\u52a0\n      user: name={{usergroup.infra.user}} uid={{usergroup.infra.uid}} group={{usergroup.infra.group}} update_password=always password={{usergroup.infra.password}}\n \n# ===================\n# ap_admin(apserv01\u3068adminserv01)\u306b\u9069\u7528\n#  \u30fbapache\u30b0\u30eb\u30fc\u30d7/\u30e6\u30fc\u30b6\u30fc\u306e\u7528\u9014\n#     \u30fbadminserv01\n#         \u30fbCI(Jenkins)\u7528HTTP\u30b5\u30fc\u30d0\n#         \u30fbadminserv01\u306fapserv01\u306b\u30c7\u30d7\u30ed\u30a4\u3059\u308b\u524d\u306b\u30c6\u30b9\u30c8\u7528\u9014\u3068\u3057\u3066\u3082\u4f7f\u7528\u3059\u308b\n#     \u30fbapserv01\n#         \u30fbWeb\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u7528HTTP\u30b5\u30fc\u30d0\n#  \u30fbtomcat\u30b0\u30eb\u30fc\u30d7/\u30e6\u30fc\u30b6\u30fc\u306e\u7528\u9014\n#     \u30fbadminserv01\n#         \u30fbCI(Jenkins)\u7528JavaApplication\u30b5\u30fc\u30d0\n#         \u30fbadminserv01\u306fAP\u30b5\u30fc\u30d0\u306b\u30c7\u30d7\u30ed\u30a4\u3059\u308b\u524d\u306b\u30c6\u30b9\u30c8\u7528\u9014\u3068\u3057\u3066\u3082\u4f7f\u7528\u3059\u308b\n#     \u30fbapserv01\n#         \u30fbWeb\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u7528JavaApplication\u30b5\u30fc\u30d0\n# ===================\n- hosts: ap_admin\n  sudo: no\n  remote_user: root\n  vars_files:\n    - ../vars/usergroup.yml\n  tasks:\n    - name: apache\u30b0\u30eb\u30fc\u30d7\u8ffd\u52a0\n      group: name={{usergroup.apache.group }} gid={{usergroup.apache.gid}}\n \n    - name: tomcat\u30b0\u30eb\u30fc\u30d7\u8ffd\u52a0\n      group: name={{usergroup.tomcat.group }} gid={{usergroup.tomcat.gid}}\n \n    - name: apache\u30e6\u30fc\u30b6\u30fc\u8ffd\u52a0\n      user: \n\u3000\u3000  name={{usergroup.apache.user}}\n        uid={{usergroup.apache.uid}}\n        group={{usergroup.apache.group}}\n        update_password=always \n        password={{usergroup.apache.password}}\n \n    - name: tomcat\u30e6\u30fc\u30b6\u30fc\u8ffd\u52a0\n      user: name={{usergroup.tomcat.user}} uid={{usergroup.tomcat.uid}} group={{usergroup.tomcat.group}}  update_password=always password={{usergroup.tomcat.password}}\n \n# ===================\n# db_admin(dbserv01\u3068adminserv01)\u306b\u9069\u7528\n#  \u30fbmysql\u30b0\u30eb\u30fc\u30d7/\u30e6\u30fc\u30b6\u30fc\u306e\u7528\u9014\n#     \u30fbadminserv01\n#         \u30fbadminserv01\u306fdb\u30b5\u30fc\u30d0\u3078\u306e\u672c\u756a\u4ee5\u964d\u524d\u306b\u30c6\u30b9\u30c8\u7528\u9014\u3068\u3057\u3066\u3082\u4f7f\u7528\u3059\u308b\n#     \u30fbdbserv01\n#         \u30fb\u672c\u756a\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u30b5\u30fc\u30d0\n# ===================\n- hosts: db_admin\n  sudo: no\n  remote_user: root\n  vars_files:\n    - ../vars/usergroup.yml\n  tasks:\n    - name: mysql\u30b0\u30eb\u30fc\u30d7\u8ffd\u52a0\n      group: name={{usergroup.mysql.group }} gid={{usergroup.mysql.gid}}\n    - name: mysql\u30e6\u30fc\u30b6\u30fc\u8ffd\u52a0\n      user: name={{usergroup.mysql.user}} uid={{usergroup.mysql.uid}} group={{usergroup.mysql.group}}  update_password=always password={{usergroup.mysql.password}}\n \n# ===================\n# adminserv01\u306b\u9069\u7528\n#  \u30fbselenium\u30b0\u30eb\u30fc\u30d7/\u30e6\u30fc\u30b6\u30fc\u306e\u7528\u9014\n#     \u30fbadminserv01\n#         \u30fbWEBGUI\u30c6\u30b9\u30c6\u30a3\u30f3\u30b0\u306e\u8d77\u52d5/\u5236\u5fa1\u3092\u884c\u3046SelniumGrid\u3092\u52d5\u4f5c\u3055\u305b\u308b\n# ===================\n- hosts: adminservers\n  sudo: no\n  remote_user: root\n  vars_files:\n    - ../vars/usergroup.yml\n  tasks:\n    - name: selenium\u30b0\u30eb\u30fc\u30d7\u8ffd\u52a0\n      group: name={{usergroup.selenium.group }} gid={{usergroup.selenium.gid}}\n    - name: selenium\u30e6\u30fc\u30b6\u30fc\u8ffd\u52a0\n      user: name={{usergroup.selenium.user}} uid={{usergroup.selenium.uid}} group={{usergroup.selenium.group}}  update_password=always password={{usergroup.selenium.password}}\n``` \n\n<dl>\n<dt><font color=\"#0066ff\">Ansible\u3067\u306e\u30b0\u30eb\u30fc\u30d7(group)\u8ffd\u52a0\u30e2\u30b8\u30e5\u30fc\u30eb</font></dt>\n<br>\n<dd>Ansible\u3067\u30b0\u30eb\u30fc\u30d7\u3092\u8ffd\u52a0\u3059\u308b\u306b\u306fgroup\u30e2\u30b8\u30e5\u30fc\u30eb\u3092\u4f7f\u3046\u3002</dd>\n</dl>\n\u66f8\u5f0f:\n>group: name=\\${\u30b0\u30eb\u30fc\u30d7\u540d\u79f0} gid=${GID}\n\n\u4f8b:\n\n```yaml:\ngroup: name={{usergroup.apache.group }} gid={{usergroup.apache.gid}} \n```\n\n<dl>\n<dt><font color=\"#0066ff\">Ansible\u3067\u306e\u30e6\u30fc\u30b6\u30fc(user)\u8ffd\u52a0\u30e2\u30b8\u30e5\u30fc\u30eb</font></dt>\n<br>\n<dd>Ansible\u3067\u30e6\u30fc\u30b6\u30fc\u3092\u8ffd\u52a0\u3059\u308b\u306b\u306fuser\u30e2\u30b8\u30e5\u30fc\u30eb\u3092\u4f7f\u3046\u3002\u30e6\u30fc\u30b6\u30fc\u4f5c\u6210\u6642\u306f\u30b0\u30eb\u30fc\u30d7\u540d\u79f0\u3092\u6307\u5b9a\u3057\u3066GID\u306f\u6307\u5b9a\u3057\u306a\u3044\u3002</dd>\n</dl>\n\u66f8\u5f0f:\n>user: name=\\${\u30e6\u30fc\u30b6\u30fc\u540d} uid=\\${UID} group={\u30b0\u30eb\u30fc\u30d7\u540d\u79f0} update_password=${\u30d1\u30b9\u30ef\u30fc\u30c9\u306e\u66f4\u65b0(always \u307e\u305f\u306f on_create)}\n\n\u4f8b:\n\n```yaml:\nuser: name={{usergroup.selenium.user}} uid={{usergroup.selenium.uid}} group={{usergroup.selenium.group}}  update_password=always\n```\n\n<dl>\n<dt><font color=\"#0066ff\">var_files\u306e\u69cb\u9020</font></dt>\n<br>\n<dd>\nvar_files\u3082yaml\u306e\u6cd5\u5247\u306b\u5f93\u3044\u968e\u5c64\u69cb\u9020\u3067\u8a18\u8ff0\u3002\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u8a2d\u5b9a\u304b\u3089\u3001uid:1200\u306e\u5024\u3092playbook\u304b\u3089\u53d6\u5f97\u3057\u305f\u3044\u5834\u5408\u306f\n</dd>\n</dl>\n\n>\nusergroup:\n&nbsp;&nbsp;tomcat:\n&nbsp;&nbsp;&nbsp;&nbsp;user: tomcat\n&nbsp;&nbsp;&nbsp;&nbsp;group: tomcat\n&nbsp;&nbsp;&nbsp;&nbsp;<b><font color=\"#ff0000\">uid: 1200</font></b>\n&nbsp;&nbsp;&nbsp;&nbsp;gid: 1200\n&nbsp;&nbsp;&nbsp;&nbsp;home: /home/tomcat\n&nbsp;&nbsp;&nbsp;&nbsp;shell: /bin/bash\n\n\n<font color=\"#ff6600\">usergroup</font>\u914d\u4e0b<font color=\"#ff6600\">tomcat</font>\u306e\u914d\u4e0b\u306e<font color=\"#ff0000\"><b>uid</b></font>\u3092\u53d6\u5f97\u3059\u308b\u70ba\u3001\nusergroup.tomcat.uid\u3068\u3010.(\u30d4\u30ea\u30aa\u30c9)\u3011\u3067\u5b9a\u7fa9\u3092\u7e4b\u304e\u3001\u5de6\u53f3\u3092<font color=\"#ff0000\"><b>{{ }}</b></font>\u3067\u62ec\u308a\u3001\n\n<b><font color=\"#FF0000\">{{usergroup.tomcat.uid}}</font></b>\n\n\u203b\u4ee5\u524d\u306eAnsible\u3067\u306f${ }\u3067\u53d6\u5f97\u53ef\u80fd\u3060\u3063\u305f\u304c\u73fe\u5728\u306eAnsible\u3067\u306f\u53d6\u5f97\u3067\u304d\u306a\u3044\u70ba\u6ce8\u610f\u3002\n\n##5.playbook(/vars/usergroup.yml)\n\\${ANSIBLE_HOME}/vars/usergroup.yml\n\n\u203buser\u30e2\u30b8\u30e5\u30fc\u30eb\u306epassword(\u30d1\u30b9\u30ef\u30fc\u30c9)\u306f\u30cf\u30c3\u30b7\u30e5\u5316\u304c\u5fc5\u8981\u3002\n \n0011_usergroup.yml\u3067\u306f\u5909\u6570\u8a2d\u5b9a\u3092\u3057\u3066\u3044\u308b\u3002\nuser\u30e2\u30b8\u30e5\u30fc\u30eb\u306e\u30d1\u30b9\u30ef\u30fc\u30c9\u306f\u30cf\u30c3\u30b7\u30e5\u5316\u3059\u308b\u5fc5\u8981\u304c\u3042\u308b\u3053\u3068\u306b\u6ce8\u610f\u3002\n\n\u30cf\u30c3\u30b7\u30e5\u5316\u3059\u308b\u306b\u306f\u4eca\u56de\u306fmanageterm(Ansible\u7ba1\u7406\u7aef\u672b\uff09\u304b\u3089\u4ee5\u4e0b\u3092\u5b9f\u884c\u3002\n\n\u66f8\u5f0f\uff1a\n>python -c 'import crypt; print crypt.crypt(\"\u30d1\u30b9\u30ef\u30fc\u30c9\", \"\\$6\\$\u30bd\u30eb\u30c8$\")'\n\n\u4f8b\uff1a\n\n```py:\npython -c 'import crypt; print crypt.crypt(\"apache123\", \"$6$apachesolt$\")'\n```\n\n\u4ee5\u4e0a\u306e\u8a2d\u5b9a\u3067\u300capache123\u300d\u3068\u3044\u3046\u30cf\u30c3\u30b7\u30e5\u5316\u3055\u308c\u305f\u30d1\u30b9\u30ef\u30fc\u30c9\u304c\u30b5\u30fc\u30d0\u8a2d\u5b9a\u3055\u308c\u308b\u3053\u3068\u306b\u306a\u308b\u3002\n\n```yaml:\n# ===================\n#\u30e6\u30fc\u30b6\u30fc\u60c5\u5831\u3092\u5909\u6570\u5b9a\u7fa9\u3057\u307e\u3059\u3002\n#\u30d1\u30b9\u30ef\u30fc\u30c9\u306f\u30cf\u30c3\u30b7\u30e5\u5316\u3059\u308b\u5fc5\u8981\u304c\u3042\u308b\u70ba\u3001python\u306e\u30b3\u30de\u30f3\u30c9\u306b\u3066\u30cf\u30c3\u30b7\u30e5\u5316\u3057\u305f\u30d1\u30b9\u30ef\u30fc\u30c9\u3092\u8a2d\u5b9a\n# python -c 'import crypt; print crypt.crypt(\"\u30d1\u30b9\u30ef\u30fc\u30c9\", \"$6$\u30bd\u30eb\u30c8$\")'\n# ===================\n  usergroup:\n    tomcat:\n      user: tomcat\n      group: tomcat\n      uid: 1200\n      gid: 1200\n      home: /home/tomcat\n      shell: /bin/bash\n      # ===================\n      # python -c 'import crypt; print crypt.crypt(\"tomcat123\", \"$6$tomcatsolt$\")'\n      # ===================\n      password: $6$tomcatsolt$Dz8QThSePXH5WZ0EjLQbUA8pZJrgIl4.2qsflSWkn1gV.RqD84vPT0.tdThOEn1VyowWJBsTgm2rmv5oJixDJ1\n    apache:\n      user: apache\n      group: apache\n      uid: 1100\n      gid: 1100\n      home: /home/apache\n      shell: /bin/bash\n      # ===================\n      # python -c 'import crypt; print crypt.crypt(\"tomcat123\", \"$6$tomcatsolt$\")'\n      # ===================\n      password: $6$apachesolt$PnTyYlBO7ZAmPmXNBxAgWj03udlCNxqOqWvfik.fM3A84UTG.Un0cWUaXEl2vT2Acme.lMsPVRapEOZ9MhWYr0\n    mysql:\n      user: mysql\n      group: mysql\n      uid: 1300\n      gid: 1300\n      home: /home/mysql\n      shell: /bin/bash\n      # ===================\n      # python -c 'import crypt; print crypt.crypt(\"tomcat123\", \"$6$tomcatsolt$\")'\n      # ===================\n      password: $6$mysqlsolt$IeAbOR9NxGYA3Os9p43DRjdGvuTae62i707gWa2/XP/IFVyjHIYsEe/gH5uc15pxwyhAk8kGuRbi6Iinga5wh/\n    infra:\n      user: infra\n      group: infra\n      uid: 1400\n      gid: 1400\n      home: /home/infra\n      shell: /bin/bash\n      # ===================\n      # python -c 'import crypt; print crypt.crypt(\"tomcat123\", \"$6$tomcatsolt$\")'\n      # ===================\n      password: $6$infrasolt$a2vFx7QL/cV2Nplcy1AxeRp8Ss34MPTjkbKpu7au.kq.PXshj8K177TUH9Pj5wtG8Y83Ea5Nv8UlvRuBMN5Fu0\n    selenium:\n      user: selenium\n      group: selenium\n      uid: 1600\n      gid: 1600\n      home: /home/selenium\n      shell: /bin/bash\n      # ===================\n      # python -c 'import crypt; print crypt.crypt(\"tomcat123\", \"$6$tomcatsolt$\")'\n      # ===================\n      password: $6$seleniumsolt$fl7ibc.Xf/.xnbIFqIXuGA3rtddYdZiUILqVvJO06cjGXy.HmpDh1LjXZYLKqzZymjn1GqmQkz2ndc8lfbfTz/\n```\n\n\u6b21\u56de\u306f\u300c[yum\u306b\u3066\u5fc5\u8981\u306a\u30e9\u30a4\u30d6\u30e9\u30ea\uff0f\u30df\u30c9\u30eb\uff0f\u30bd\u30d5\u30c8\u30a6\u30a7\u30a2\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\u3010Ansible yum\u30e2\u30b8\u30e5\u30fc\u30eb\u3011](http://qiita.com/CsFactoryitter/items/1b7e6138197e2c58b719)\u300d\u306b\u3064\u3044\u3066\u3002\n\n<b><font color=\"#ff6633\">\u9023\u8f09\u306e\u76ee\u6b21\u306f[\u3010\u3053\u3061\u3089\u3011](http://qiita.com/CsFactoryitter/items/6b8308b96afafd61ce5f\n)\u3067\u3059\u3002</font></b>\n", "tags": ["Ansible", "centos7", "ansible-playbook", "vagrant", "\u30b5\u30fc\u30d0\u30fc\u69cb\u7bc9"]}