{"context": " More than 1 year has passed since last update.Windows Installer\u306fCOM\u306e\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9\u3092\u6301\u3063\u3066\u3044\u3066\u3001WSH\u3067MSI\u30d5\u30a1\u30a4\u30eb\u5185\u306e\u30c6\u30fc\u30d6\u30eb\u3092\u8aad\u307f\u8fbc\u3080\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002JScript\u3067\u88fd\u54c1\u30d0\u30fc\u30b8\u30e7\u30f3\u3092\u53d6\u5f97\u3057\u3066\u307f\u307e\u3059\u3002\nvar databasePath = \"TestProduct.msi\";\nvar query = \"SELECT `Value` FROM `Property` WHERE Property.Property='ProductVersion'\";\nvar msiOpenDatabaseModeReadOnly = 0;\n//\nvar installer = WScript.CreateObject(\"WindowsInstaller.Installer\");\nvar database = installer.OpenDatabase(databasePath, msiOpenDatabaseModeReadOnly);\nvar view = database.OpenView(query);\nview.Execute();\nvar record = view.Fetch();\nWScript.echo(record.StringData(1));\n\n\u307e\u305f\u3001Inno Setup\u3067\u3082COM\u3092\u6271\u3048\u308b\u306e\u3067\u3001\u5916\u90e8\u306b\u7f6e\u3044\u305fMSI\u30d5\u30a1\u30a4\u30eb\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u3092\u53d6\u5f97\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\u3053\u308c\u306fInno Setup\u3092MSI\u306e\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\u30e9\u30f3\u30c1\u30e3\u30fc\u3068\u3057\u3066\u4f7f\u3046\u6642\u306b\u5f79\u306b\u7acb\u3064\u3067\u3057\u3087\u3046\u3002\n\u307e\u305a\u3001\u5909\u6570\u3092\u5ba3\u8a00\u3057\u3001\nvar\n  installer, database, view, rec: Variant;\n\n\u4e0b\u8a18\u306e\u30b3\u30fc\u30c9\u3067\u30d0\u30fc\u30b8\u30e7\u30f3\u3092\u53d6\u5f97\u3057\u307e\u3059\u3002\n  installer := CreateOleObject('WindowsInstaller.Installer');\n  database := installer.OpenDatabase('TestProduct.msi', 0);\n  view := database.OpenView('SELECT `Value` FROM `Property` WHERE Property.Property=''ProductVersion''');\n  view.Execute();\n  rec := view.Fetch();\n  MsgBox(rec.StringData(1), mbInformation, MB_OK);\n\nOpenView()\u95a2\u6570\u306b\u4e0e\u3048\u308bSQL\u6587\u3092\u5909\u3048\u308c\u3070\u3001\u3042\u3089\u3086\u308b\u30c6\u30fc\u30d6\u30eb\u306e\u5024\u3092\u53d6\u5f97\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\u696d\u52d9\u7528\u9014\u306e\u305f\u3081\u306b\u4fe1\u983c\u6027\u3092\u4e0a\u3052\u308b\u306a\u3089\u3001\u4f8b\u5916\u51e6\u7406\u3092\u8ffd\u52a0\u3057\u305f\u65b9\u304c\u826f\u3044\u3067\u3059\u3002\n\u3053\u306e\u95a2\u6570\u3067\u4f7f\u3048\u308bSQL\u6587\u306e\u6587\u6cd5\u306f\u3001MSDN\u30e9\u30a4\u30d6\u30e9\u30ea\u306e\u300cSQL Syntax\u300d\u3092\u3001\u4f7f\u7528\u4f8b\u306f\u300cExamples of Database Queries Using SQL and Script\u300d\u3092\u53c2\u7167\u3057\u3066\u304f\u3060\u3055\u3044\u3002\nWindows Installer\u306fCOM\u306e\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9\u3092\u6301\u3063\u3066\u3044\u3066\u3001WSH\u3067MSI\u30d5\u30a1\u30a4\u30eb\u5185\u306e\u30c6\u30fc\u30d6\u30eb\u3092\u8aad\u307f\u8fbc\u3080\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002JScript\u3067\u88fd\u54c1\u30d0\u30fc\u30b8\u30e7\u30f3\u3092\u53d6\u5f97\u3057\u3066\u307f\u307e\u3059\u3002\n\n```js\nvar databasePath = \"TestProduct.msi\";\nvar query = \"SELECT `Value` FROM `Property` WHERE Property.Property='ProductVersion'\";\nvar msiOpenDatabaseModeReadOnly = 0;\n//\nvar installer = WScript.CreateObject(\"WindowsInstaller.Installer\");\nvar database = installer.OpenDatabase(databasePath, msiOpenDatabaseModeReadOnly);\nvar view = database.OpenView(query);\nview.Execute();\nvar record = view.Fetch();\nWScript.echo(record.StringData(1));\n```\n\n\u307e\u305f\u3001Inno Setup\u3067\u3082COM\u3092\u6271\u3048\u308b\u306e\u3067\u3001\u5916\u90e8\u306b\u7f6e\u3044\u305fMSI\u30d5\u30a1\u30a4\u30eb\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u3092\u53d6\u5f97\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\u3053\u308c\u306fInno Setup\u3092MSI\u306e\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\u30e9\u30f3\u30c1\u30e3\u30fc\u3068\u3057\u3066\u4f7f\u3046\u6642\u306b\u5f79\u306b\u7acb\u3064\u3067\u3057\u3087\u3046\u3002\n\u307e\u305a\u3001\u5909\u6570\u3092\u5ba3\u8a00\u3057\u3001\n\n```pascal\nvar\n  installer, database, view, rec: Variant;\n```\n\u4e0b\u8a18\u306e\u30b3\u30fc\u30c9\u3067\u30d0\u30fc\u30b8\u30e7\u30f3\u3092\u53d6\u5f97\u3057\u307e\u3059\u3002\n\n```pascal\n  installer := CreateOleObject('WindowsInstaller.Installer');\n  database := installer.OpenDatabase('TestProduct.msi', 0);\n  view := database.OpenView('SELECT `Value` FROM `Property` WHERE Property.Property=''ProductVersion''');\n  view.Execute();\n  rec := view.Fetch();\n  MsgBox(rec.StringData(1), mbInformation, MB_OK);\n```\n\n`OpenView()`\u95a2\u6570\u306b\u4e0e\u3048\u308bSQL\u6587\u3092\u5909\u3048\u308c\u3070\u3001\u3042\u3089\u3086\u308b\u30c6\u30fc\u30d6\u30eb\u306e\u5024\u3092\u53d6\u5f97\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\u696d\u52d9\u7528\u9014\u306e\u305f\u3081\u306b\u4fe1\u983c\u6027\u3092\u4e0a\u3052\u308b\u306a\u3089\u3001\u4f8b\u5916\u51e6\u7406\u3092\u8ffd\u52a0\u3057\u305f\u65b9\u304c\u826f\u3044\u3067\u3059\u3002\n\n\u3053\u306e\u95a2\u6570\u3067\u4f7f\u3048\u308bSQL\u6587\u306e\u6587\u6cd5\u306f\u3001MSDN\u30e9\u30a4\u30d6\u30e9\u30ea\u306e\u300c[SQL Syntax](https://msdn.microsoft.com/en-us/library/aa372021)\u300d\u3092\u3001\u4f7f\u7528\u4f8b\u306f\u300c[Examples of Database Queries Using SQL and Script](https://msdn.microsoft.com/en-us/library/aa368562(v=vs.85).aspx)\u300d\u3092\u53c2\u7167\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n", "tags": ["WSH", "innosetup", "msi"]}