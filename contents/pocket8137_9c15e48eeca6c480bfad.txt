{"tags": ["VBA", "\u65b0\u4eba\u30d7\u30ed\u30b0\u30e9\u30de\u5fdc\u63f4"], "context": "\nPublic Const MESSAGE_OF_PASSWORD_INPUT_TITLE As String = \"Input Box\"\nPublic Const MESSAGE_OF_PASSWORD_INPUT_CONTENT As String = \"Please input password\"\n\nPublic Sub protectBookMain()\n    Dim passPhase As String\n\n    passPhase = InputBox(MESSAGE_OF_PASSWORD_INPUT_CONTENT, MESSAGE_OF_PASSWORD_INPUT_TITLE)\n\n    If passPhase <> \"\" Then\n        Call protectBook(passPhase)\n    End If\n\nEnd Sub\n\nPublic Sub protectBook(passPhase As String)\n\n    Dim savePath As String\n\n    Application.DisplayAlerts = False\n    With ActiveWorkbook\n            savePath = .Path\n            saveFileName = .Name\n            .SaveAs _\n            Filename:=savePath & \"\\\" & saveFileName, _\n            passWord:=passPhase\n    End With\n    Application.DisplayAlerts = True\n\nEnd Sub\n\n\u30b7\u30e7\u30fc\u30c8\u30ab\u30c3\u30c8\u30ad\u30fc\u3001\u304a\u3088\u3073\u30a4\u30d9\u30f3\u30c8\u30d7\u30ed\u30b7\u30fc\u30b8\u30e3\u306e\u767b\u9332\u3002\n' \u30aa\u30fc\u30d7\u30f3\nPrivate Sub Workbook_Open()\n    ' \u30ad\u30fc\u30d0\u30a4\u30f3\u30c9\u306e\u8a2d\u5b9a\n    Application.OnKey \"^{m}\", \"protectBookMain\"\nEnd Sub\n\n' \u9589\u3058\u308b\u524d\nPrivate Sub Workbook_BeforeClose(Cancel As Boolean)\n    Call protectBookMain\nEnd Sub\n\n\n\n```vbnet\n\nPublic Const MESSAGE_OF_PASSWORD_INPUT_TITLE As String = \"Input Box\"\nPublic Const MESSAGE_OF_PASSWORD_INPUT_CONTENT As String = \"Please input password\"\n\nPublic Sub protectBookMain()\n    Dim passPhase As String\n\n    passPhase = InputBox(MESSAGE_OF_PASSWORD_INPUT_CONTENT, MESSAGE_OF_PASSWORD_INPUT_TITLE)\n    \n    If passPhase <> \"\" Then\n        Call protectBook(passPhase)\n    End If\n    \nEnd Sub\n\nPublic Sub protectBook(passPhase As String)\n\n    Dim savePath As String\n    \n    Application.DisplayAlerts = False\n    With ActiveWorkbook\n            savePath = .Path\n            saveFileName = .Name\n            .SaveAs _\n            Filename:=savePath & \"\\\" & saveFileName, _\n            passWord:=passPhase\n    End With\n    Application.DisplayAlerts = True\n\nEnd Sub\n```\n\n\u30b7\u30e7\u30fc\u30c8\u30ab\u30c3\u30c8\u30ad\u30fc\u3001\u304a\u3088\u3073\u30a4\u30d9\u30f3\u30c8\u30d7\u30ed\u30b7\u30fc\u30b8\u30e3\u306e\u767b\u9332\u3002\n\n```vbnet\n' \u30aa\u30fc\u30d7\u30f3\nPrivate Sub Workbook_Open()\n    ' \u30ad\u30fc\u30d0\u30a4\u30f3\u30c9\u306e\u8a2d\u5b9a\n    Application.OnKey \"^{m}\", \"protectBookMain\"\nEnd Sub\n\n' \u9589\u3058\u308b\u524d\nPrivate Sub Workbook_BeforeClose(Cancel As Boolean)\n    Call protectBookMain\nEnd Sub\n```\n\n\n"}