{"context": "excel2013\u304b\u3089\u304b\u89e3\u3089\u306a\u3044\u3051\u3069\u3001PlotArea\u306eInsideWidth\u3068\u304bInsideHeight\u3092\u8a2d\u5b9a\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u3063\u3066\u308b\u3057\u3001InsideTop\u3068InsideLeft\u3082\u5408\u308f\u305b\u305f\u3089\u30b0\u30e9\u30d5\u306e\u30d7\u30ed\u30c3\u30c8\u30a8\u30ea\u30a2\u306e\u4f4d\u7f6e\u30fb\u5927\u304d\u3055\u3092\u63c3\u3048\u3089\u308c\u308b\u3088\u3046\u306b\u306a\u3063\u3066\u3066\u3042\u308a\u304c\u305f\u3044\u3002\nOption Explicit\n\n'|  x\u8ef8  |      |\n'----------------\n'|y\u8ef81\u8ef81|y\u8ef82\u8ef82|\n'----------------\n'|y\u8ef81\u8ef82|y\u8ef82\u8ef82|\n'----------------\n'\u2026\u2026\n'\u3063\u3066\u611f\u3058\u3067\u5024\u5165\u308c\u3066x\u8ef8\u306e\u3068\u3053\u306b\u30ab\u30fc\u30bd\u30eb\u7f6e\u3044\u3066\u5b9f\u884c\n\nConst labelsRow = 2\n\nSub setRangeNames()\nDim i As Long\nDim limRow As Long\n    '\u30b0\u30e9\u30d5\u306e\u305f\u3081\u306b\u540d\u524d\u4ed8\u304d\u7bc4\u56f2\u8a2d\u5b9a\n    With Sheets(\"bunseki\")\n        limRow = .Cells(labelsRow + 1, 1).End(xlDown).Row '\u5ba4\u6e29\u3068\u304b\u3067\u30c7\u30fc\u30bf\u306b\u629c\u3051\u304c\u3042\u3063\u3066\u3082\u3044\u3044\u3088\u3046\u306b\n        For i = 1 To .Cells(labelsRow, 1).End(xlToRight).Column\n            ActiveWorkbook.Names.Add name:=.Cells(labelsRow, i).Value, _\n                                                            RefersTo:=\"=OFFSET(bunseki!$\" & convertColumnIndexToAlphabet(i) & \"$\" & labelsRow & _\n                                                                                \",1,0,COUNTA(bunseki!$\" & convertColumnIndexToAlphabet(i) & _\n                                                                                \":$\" & convertColumnIndexToAlphabet(i) & \")-1,1)\"\n        Next i\n    End With\nEnd Sub\n\n'\u5217\u756a\u53f7\u304b\u3089\u7bc4\u56f2\u306e\u540d\u524d\u3092\u53d6\u5f97\nFunction getRangeName(idx As Long) As String\n    getRangeName = Sheets(\"bunseki\").Cells(labelsRow, idx).Value\nEnd Function\n\n'\u7bc4\u56f2\u306e\u540d\u524d\u304b\u3089\u5217\u756a\u53f7\u3092\u53d6\u5f97\nFunction getRangeNameIndex(rangeName As Variant) As Long\nOn Error GoTo Err_trap 'Match\u3067\u7bc4\u56f2\u540d\u304c\u898b\u3064\u304b\u3089\u306a\u304b\u3063\u305f\u3068\u304d\n    With Sheets(\"bunseki\")\n        getRangeNameIndex = Application.WorksheetFunction.Match(rangeName, .Range(.Cells(labelsRow, 1), .Cells(labelsRow, 1).End(xlToRight)), 0)\n    End With\n    Exit Function\nErr_trap:\n    MsgBox \"\u30a8\u30e9\u30fc\u30b3\u30fc\u30c9:\" & Err.Number & vbCrLf & Err.Description & vbCrLf & vbCrLf & \"\u7cfb\u5217\u540d\u304c\u9593\u9055\u3063\u3066\u3044\u308b\u53ef\u80fd\u6027\u304c\u3042\u308a\u307e\u3059\"\n    End\nEnd Function\n\n'\u30b0\u30e9\u30d5\u306b\u3059\u308b\u5217\u756a\u53f7\u3092\u914d\u5217\u306b\u5165\u308c\u308b\nFunction getIdxArray(col As Long) As Variant\nDim idxArray As Variant\nDim i As Long\n    If ActiveCell.Offset(1, col) = \"\" Or ActiveCell.Offset(2, col) = \"\" Then\n        idxArray = Sheets(\"\u30b0\u30e9\u30d5\").Range(ActiveCell.Offset(1, col), ActiveCell.Offset(2, col))\n    Else\n        idxArray = Sheets(\"\u30b0\u30e9\u30d5\").Range(ActiveCell.Offset(1, col), ActiveCell.Offset(1, col).End(xlDown))\n    End If\n\n    '\u5217\u756a\u53f7\u3058\u3083\u306a\u304f\u540d\u524d\u304c\u5165\u529b\u3055\u308c\u3066\u305f\u3089\u5217\u756a\u53f7\u306b\u5909\u63db\n    For i = 1 To UBound(idxArray)\n        If idxArray(i, 1) = \"\" Or VarType(idxArray(i, 1)) <> vbString Then\n            Exit For\n        End If\n        idxArray(i, 1) = getRangeNameIndex(idxArray(i, 1))\n    Next i\n    getIdxArray = idxArray\nEnd Function\n\nSub addGraph()\nDim x As Long\nDim yls As Variant, yrs As Variant\nDim i As Long\nConst graphWidth = 1080\nConst graphHeight = 300\n    Call setRangeNames '\u540d\u524d\u4ed8\u304d\u7bc4\u56f2\u8a2d\u5b9a(\u66f4\u65b0)\n    If VarType(ActiveCell.Value) = vbString Then\n        x = getRangeNameIndex(ActiveCell.Value)\n    Else\n        x = ActiveCell.Value\n    End If\n    yls = getIdxArray(0) 'Sheets(\"\u30b0\u30e9\u30d5\").Range(ActiveCell.Offset(1, 0), ActiveCell.Offset(1, 0).End(xlDown))\n    yrs = getIdxArray(1) 'Sheets(\"\u30b0\u30e9\u30d5\").Range(ActiveCell.Offset(1, 1), ActiveCell.Offset(1, 1).End(xlDown))\n    '\u7a7a\u306e\u30b0\u30e9\u30d5\u4f5c\u6210\n    'Charts.Add.Location where:=xlLocationAsObject, name:=ActiveSheet.name\n    With ActiveSheet.ChartObjects.Add(ActiveCell.Left, ActiveCell.Top, graphWidth, graphHeight).Chart\n        .ChartType = xlLine '\u6298\u308c\u7dda\u30b0\u30e9\u30d5\n        '.Parent.name = \"a\"\n        '.PlotArea.Width = graphWidth * 0.8\n        '.PlotArea.Height = graphHeight * 0.8\n        '\u30c7\u30fc\u30bf\u7cfb\u5217\u4f5c\u6210\n        '\u7b2c1\u8ef8\n        For i = 1 To UBound(yls)\n            If yls(i, 1) <> \"\" Then\n                With .SeriesCollection.NewSeries\n                    '.ChartType = xlLine '\u6298\u308c\u7dda\u30b0\u30e9\u30d5\n                    .XValues = Range(getRangeName(x))\n                    .Values = Range(getRangeName(CLng(yls(i, 1))))\n                    .name = getRangeName(CLng(yls(i, 1)))\n                End With\n            End If\n        Next i\n        '\u7b2c2\u8ef8\n        For i = 1 To UBound(yrs)\n            If yrs(i, 1) <> \"\" Then\n                With .SeriesCollection.NewSeries\n                    '.ChartType = xlLine '\u6298\u308c\u7dda\u30b0\u30e9\u30d5\n                    .XValues = Range(getRangeName(x))\n                    .Values = Range(getRangeName(CLng(yrs(i, 1))))\n                    .name = getRangeName(CLng(yrs(i, 1)))\n                    .AxisGroup = xlSecondary '\u7b2c2\u8ef8\u306b\n                End With\n            End If\n        Next i\n    End With\n\n    '\u30d7\u30ed\u30c3\u30c8\u30a8\u30ea\u30a2\u306e\u5185\u90e8\u30b5\u30a4\u30ba\u63c3\u3048\u308b\n    With Sheets(\"\u30b0\u30e9\u30d5\").ChartObjects(Sheets(\"\u30b0\u30e9\u30d5\").ChartObjects.Count).Chart\n        .PlotArea.InsideWidth = graphWidth * 0.85\n        .PlotArea.InsideHeight = graphHeight * 0.85\n        .PlotArea.InsideTop = 30 '(.ChartArea.Height - .PlotArea.Height) / 2\n        .PlotArea.InsideLeft = 30 '(.ChartArea.Width - .PlotArea.Width) / 2\n    End With\nEnd Sub\n\n'\u3059\u3079\u3066\u306e\u30d7\u30ed\u30c3\u30c8\u30a8\u30ea\u30a2\u306e\u5185\u90e8\u30b5\u30a4\u30ba\u63c3\u3048\u308b\nSub adjustInsidePlotAreaOfAllGraphs()\nDim i As Long\n    For i = 1 To Sheets(\"\u30b0\u30e9\u30d5\").ChartObjects.Count\n        With Sheets(\"\u30b0\u30e9\u30d5\").ChartObjects(i).Chart\n            .PlotArea.InsideWidth = graphWidth * 0.85\n            .PlotArea.InsideHeight = graphHeight * 0.85\n            .PlotArea.InsideTop = 30 '(.ChartArea.Height - .PlotArea.Height) / 2\n            .PlotArea.InsideLeft = 30 '(.ChartArea.Width - .PlotArea.Width) / 2\n        End With\n    Next i\nEnd Sub\n\n'\u7279\u5b9a\u306e\u7bc4\u56f2\u3060\u3051\u30b0\u30e9\u30d5\u5316\u3059\u308b(\u9014\u4e2d)\nFunction getTimeRow(timeStr As String) As Long\n    getTimeRow = 1\nEnd Function\n\nSub addGraphSecond()\nDim x As Long\nDim yls As Variant, yrs As Variant\nDim i As Long\nDim startRowTime As String\nDim endRowTime As String\n    Call setRangeNames '\u540d\u524d\u4ed8\u304d\u7bc4\u56f2\u8a2d\u5b9a(\u66f4\u65b0)\n    If VarType(ActiveCell.Value) = vbString Then\n        x = getRangeNameIndex(ActiveCell.Value)\n    Else\n        x = ActiveCell.Value\n    End If\n    yls = getIdxArray(0) 'Sheets(\"\u30b0\u30e9\u30d5\").Range(ActiveCell.Offset(1, 0), ActiveCell.Offset(1, 0).End(xlDown))\n    yrs = getIdxArray(1) 'Sheets(\"\u30b0\u30e9\u30d5\").Range(ActiveCell.Offset(1, 1), ActiveCell.Offset(1, 1).End(xlDown))\n    If ActiveCell.Offset(0, 1) <> \"\" And ActiveCell.Offset(0, 2) <> \"\" Then\n        startRowTime = 4\n        endRowTime = 6\n    End If\n\n    '\u7a7a\u306e\u30b0\u30e9\u30d5\u4f5c\u6210\n    'Charts.Add.Location where:=xlLocationAsObject, name:=ActiveSheet.name\n    With ActiveSheet.ChartObjects.Add(ActiveCell.Left, ActiveCell.Top, graphWidth, graphHeight).Chart\n        .ChartType = xlLine '\u6298\u308c\u7dda\u30b0\u30e9\u30d5\n        '.Parent.name = \"a\"\n        '.PlotArea.Width = graphWidth * 0.8\n        '.PlotArea.Height = graphHeight * 0.8\n        '\u30c7\u30fc\u30bf\u7cfb\u5217\u4f5c\u6210\n        '\u7b2c1\u8ef8\n        For i = 1 To UBound(yls)\n            If Not IsEmpty(yls(i, 1)) Then\n                If ActiveCell.Offset(0, 1) <> \"\" And ActiveCell.Offset(0, 2) <> \"\" Then\n                    With .SeriesCollection.NewSeries\n                        '.ChartType = xlLine '\u6298\u308c\u7dda\u30b0\u30e9\u30d5\n                        .XValues = Sheets(\"bunseki\").Range(Sheets(\"bunseki\").Cells(startRowTime, x), _\n                                                                                Sheets(\"bunseki\").Cells(endRowTime, x))\n                        .Values = Sheets(\"bunseki\").Range(Sheets(\"bunseki\").Cells(startRowTime, CLng(yls(i, 1))), _\n                                                                            Sheets(\"bunseki\").Cells(endRowTime, CLng(yls(i, 1))))\n                        .name = getRangeName(CLng(yls(i, 1)))\n                    End With\n                Else\n                    With .SeriesCollection.NewSeries\n                        '.ChartType = xlLine '\u6298\u308c\u7dda\u30b0\u30e9\u30d5\n                        .XValues = Range(getRangeName(x))\n                        .Values = Range(getRangeName(CLng(yls(i, 1))))\n                        .name = getRangeName(CLng(yls(i, 1)))\n                    End With\n                End If\n            End If\n        Next i\n        '\u7b2c2\u8ef8\n        For i = 1 To UBound(yrs)\n            If Not IsEmpty(yrs(i, 1)) Then\n                If ActiveCell.Offset(0, 1) <> \"\" And ActiveCell.Offset(0, 2) <> \"\" Then\n                    With .SeriesCollection.NewSeries\n                        '.ChartType = xlLine '\u6298\u308c\u7dda\u30b0\u30e9\u30d5\n                        .XValues = Sheets(\"bunseki\").Range(Sheets(\"bunseki\").Cells(startRowTime, x), _\n                                                                                Sheets(\"bunseki\").Cells(endRowTime, x))\n                        .Values = Sheets(\"bunseki\").Range(Sheets(\"bunseki\").Cells(startRowTime, CLng(yrs(i, 1))), _\n                                                                                Sheets(\"bunseki\").Cells(endRowTime, CLng(yrs(i, 1))))\n                        .name = getRangeName(CLng(yrs(i, 1)))\n                    End With\n                Else\n                    With .SeriesCollection.NewSeries\n                        '.ChartType = xlLine '\u6298\u308c\u7dda\u30b0\u30e9\u30d5\n                        .XValues = Range(getRangeName(x))\n                        .Values = Range(getRangeName(CLng(yrs(i, 1))))\n                        .name = getRangeName(CLng(yrs(i, 1)))\n                        .AxisGroup = xlSecondary '\u7b2c2\u8ef8\u306b\n                    End With\n                End If\n            End If\n        Next i\n        i = .PlotArea.InsideWidth\n        .PlotArea.InsideWidth = graphWidth * 0.85\n        .PlotArea.InsideHeight = graphHeight * 0.85\n        .PlotArea.InsideTop = 30 '(.ChartArea.Height - .PlotArea.Height) / 2\n        .PlotArea.InsideLeft = 30 '(.ChartArea.Width - .PlotArea.Width) / 2\n\n    End With\n\n    '\u30d7\u30ed\u30c3\u30c8\u30a8\u30ea\u30a2\u306e\u5185\u90e8\u30b5\u30a4\u30ba\u63c3\u3048\u308b\n    'Sheets(\"\u30b0\u30e9\u30d5\").ChartObjects(Sheets(\"\u30b0\u30e9\u30d5\").ChartObjects.Count).Chart.PlotArea.InsideWidth = graphWidth * 0.85\n    'Sheets(\"\u30b0\u30e9\u30d5\").ChartObjects(Sheets(\"\u30b0\u30e9\u30d5\").ChartObjects.Count).Chart.PlotArea.InsideHeight = graphHeight * 0.85\n    'Sheets(\"\u30b0\u30e9\u30d5\").ChartObjects(Sheets(\"\u30b0\u30e9\u30d5\").ChartObjects.Count).Chart.PlotArea.Top = 10\n    'Sheets(\"\u30b0\u30e9\u30d5\").ChartObjects(Sheets(\"\u30b0\u30e9\u30d5\").ChartObjects.Count).Chart.PlotArea.Left = 30\n    With Sheets(\"\u30b0\u30e9\u30d5\").ChartObjects(Sheets(\"\u30b0\u30e9\u30d5\").ChartObjects.Count).Chart\n\n            '.PlotArea.InsideWidth = graphWidth * 0.85\n            '.PlotArea.InsideHeight = graphHeight * 0.85\n            '.PlotArea.InsideTop = 30 '(.ChartArea.Height - .PlotArea.Height) / 2\n            '.PlotArea.InsideLeft = 30 '(.ChartArea.Width - .PlotArea.Width) / 2\n        End With\nEnd Sub\n\n\nexcel2013\u304b\u3089\u304b\u89e3\u3089\u306a\u3044\u3051\u3069\u3001PlotArea\u306eInsideWidth\u3068\u304bInsideHeight\u3092\u8a2d\u5b9a\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u3063\u3066\u308b\u3057\u3001InsideTop\u3068InsideLeft\u3082\u5408\u308f\u305b\u305f\u3089\u30b0\u30e9\u30d5\u306e\u30d7\u30ed\u30c3\u30c8\u30a8\u30ea\u30a2\u306e\u4f4d\u7f6e\u30fb\u5927\u304d\u3055\u3092\u63c3\u3048\u3089\u308c\u308b\u3088\u3046\u306b\u306a\u3063\u3066\u3066\u3042\u308a\u304c\u305f\u3044\u3002\n\n```\nOption Explicit\n\n'|  x\u8ef8  |      |\n'----------------\n'|y\u8ef81\u8ef81|y\u8ef82\u8ef82|\n'----------------\n'|y\u8ef81\u8ef82|y\u8ef82\u8ef82|\n'----------------\n'\u2026\u2026\n'\u3063\u3066\u611f\u3058\u3067\u5024\u5165\u308c\u3066x\u8ef8\u306e\u3068\u3053\u306b\u30ab\u30fc\u30bd\u30eb\u7f6e\u3044\u3066\u5b9f\u884c\n\nConst labelsRow = 2\n\nSub setRangeNames()\nDim i As Long\nDim limRow As Long\n    '\u30b0\u30e9\u30d5\u306e\u305f\u3081\u306b\u540d\u524d\u4ed8\u304d\u7bc4\u56f2\u8a2d\u5b9a\n    With Sheets(\"bunseki\")\n        limRow = .Cells(labelsRow + 1, 1).End(xlDown).Row '\u5ba4\u6e29\u3068\u304b\u3067\u30c7\u30fc\u30bf\u306b\u629c\u3051\u304c\u3042\u3063\u3066\u3082\u3044\u3044\u3088\u3046\u306b\n        For i = 1 To .Cells(labelsRow, 1).End(xlToRight).Column\n            ActiveWorkbook.Names.Add name:=.Cells(labelsRow, i).Value, _\n                                                            RefersTo:=\"=OFFSET(bunseki!$\" & convertColumnIndexToAlphabet(i) & \"$\" & labelsRow & _\n                                                                                \",1,0,COUNTA(bunseki!$\" & convertColumnIndexToAlphabet(i) & _\n                                                                                \":$\" & convertColumnIndexToAlphabet(i) & \")-1,1)\"\n        Next i\n    End With\nEnd Sub\n\n'\u5217\u756a\u53f7\u304b\u3089\u7bc4\u56f2\u306e\u540d\u524d\u3092\u53d6\u5f97\nFunction getRangeName(idx As Long) As String\n    getRangeName = Sheets(\"bunseki\").Cells(labelsRow, idx).Value\nEnd Function\n\n'\u7bc4\u56f2\u306e\u540d\u524d\u304b\u3089\u5217\u756a\u53f7\u3092\u53d6\u5f97\nFunction getRangeNameIndex(rangeName As Variant) As Long\nOn Error GoTo Err_trap 'Match\u3067\u7bc4\u56f2\u540d\u304c\u898b\u3064\u304b\u3089\u306a\u304b\u3063\u305f\u3068\u304d\n    With Sheets(\"bunseki\")\n        getRangeNameIndex = Application.WorksheetFunction.Match(rangeName, .Range(.Cells(labelsRow, 1), .Cells(labelsRow, 1).End(xlToRight)), 0)\n    End With\n    Exit Function\nErr_trap:\n    MsgBox \"\u30a8\u30e9\u30fc\u30b3\u30fc\u30c9:\" & Err.Number & vbCrLf & Err.Description & vbCrLf & vbCrLf & \"\u7cfb\u5217\u540d\u304c\u9593\u9055\u3063\u3066\u3044\u308b\u53ef\u80fd\u6027\u304c\u3042\u308a\u307e\u3059\"\n    End\nEnd Function\n\n'\u30b0\u30e9\u30d5\u306b\u3059\u308b\u5217\u756a\u53f7\u3092\u914d\u5217\u306b\u5165\u308c\u308b\nFunction getIdxArray(col As Long) As Variant\nDim idxArray As Variant\nDim i As Long\n    If ActiveCell.Offset(1, col) = \"\" Or ActiveCell.Offset(2, col) = \"\" Then\n        idxArray = Sheets(\"\u30b0\u30e9\u30d5\").Range(ActiveCell.Offset(1, col), ActiveCell.Offset(2, col))\n    Else\n        idxArray = Sheets(\"\u30b0\u30e9\u30d5\").Range(ActiveCell.Offset(1, col), ActiveCell.Offset(1, col).End(xlDown))\n    End If\n    \n    '\u5217\u756a\u53f7\u3058\u3083\u306a\u304f\u540d\u524d\u304c\u5165\u529b\u3055\u308c\u3066\u305f\u3089\u5217\u756a\u53f7\u306b\u5909\u63db\n    For i = 1 To UBound(idxArray)\n        If idxArray(i, 1) = \"\" Or VarType(idxArray(i, 1)) <> vbString Then\n            Exit For\n        End If\n        idxArray(i, 1) = getRangeNameIndex(idxArray(i, 1))\n    Next i\n    getIdxArray = idxArray\nEnd Function\n\nSub addGraph()\nDim x As Long\nDim yls As Variant, yrs As Variant\nDim i As Long\nConst graphWidth = 1080\nConst graphHeight = 300\n    Call setRangeNames '\u540d\u524d\u4ed8\u304d\u7bc4\u56f2\u8a2d\u5b9a(\u66f4\u65b0)\n    If VarType(ActiveCell.Value) = vbString Then\n        x = getRangeNameIndex(ActiveCell.Value)\n    Else\n        x = ActiveCell.Value\n    End If\n    yls = getIdxArray(0) 'Sheets(\"\u30b0\u30e9\u30d5\").Range(ActiveCell.Offset(1, 0), ActiveCell.Offset(1, 0).End(xlDown))\n    yrs = getIdxArray(1) 'Sheets(\"\u30b0\u30e9\u30d5\").Range(ActiveCell.Offset(1, 1), ActiveCell.Offset(1, 1).End(xlDown))\n    '\u7a7a\u306e\u30b0\u30e9\u30d5\u4f5c\u6210\n    'Charts.Add.Location where:=xlLocationAsObject, name:=ActiveSheet.name\n    With ActiveSheet.ChartObjects.Add(ActiveCell.Left, ActiveCell.Top, graphWidth, graphHeight).Chart\n        .ChartType = xlLine '\u6298\u308c\u7dda\u30b0\u30e9\u30d5\n        '.Parent.name = \"a\"\n        '.PlotArea.Width = graphWidth * 0.8\n        '.PlotArea.Height = graphHeight * 0.8\n        '\u30c7\u30fc\u30bf\u7cfb\u5217\u4f5c\u6210\n        '\u7b2c1\u8ef8\n        For i = 1 To UBound(yls)\n            If yls(i, 1) <> \"\" Then\n                With .SeriesCollection.NewSeries\n                    '.ChartType = xlLine '\u6298\u308c\u7dda\u30b0\u30e9\u30d5\n                    .XValues = Range(getRangeName(x))\n                    .Values = Range(getRangeName(CLng(yls(i, 1))))\n                    .name = getRangeName(CLng(yls(i, 1)))\n                End With\n            End If\n        Next i\n        '\u7b2c2\u8ef8\n        For i = 1 To UBound(yrs)\n            If yrs(i, 1) <> \"\" Then\n                With .SeriesCollection.NewSeries\n                    '.ChartType = xlLine '\u6298\u308c\u7dda\u30b0\u30e9\u30d5\n                    .XValues = Range(getRangeName(x))\n                    .Values = Range(getRangeName(CLng(yrs(i, 1))))\n                    .name = getRangeName(CLng(yrs(i, 1)))\n                    .AxisGroup = xlSecondary '\u7b2c2\u8ef8\u306b\n                End With\n            End If\n        Next i\n    End With\n    \n    '\u30d7\u30ed\u30c3\u30c8\u30a8\u30ea\u30a2\u306e\u5185\u90e8\u30b5\u30a4\u30ba\u63c3\u3048\u308b\n    With Sheets(\"\u30b0\u30e9\u30d5\").ChartObjects(Sheets(\"\u30b0\u30e9\u30d5\").ChartObjects.Count).Chart\n        .PlotArea.InsideWidth = graphWidth * 0.85\n        .PlotArea.InsideHeight = graphHeight * 0.85\n        .PlotArea.InsideTop = 30 '(.ChartArea.Height - .PlotArea.Height) / 2\n        .PlotArea.InsideLeft = 30 '(.ChartArea.Width - .PlotArea.Width) / 2\n    End With\nEnd Sub\n\n'\u3059\u3079\u3066\u306e\u30d7\u30ed\u30c3\u30c8\u30a8\u30ea\u30a2\u306e\u5185\u90e8\u30b5\u30a4\u30ba\u63c3\u3048\u308b\nSub adjustInsidePlotAreaOfAllGraphs()\nDim i As Long\n    For i = 1 To Sheets(\"\u30b0\u30e9\u30d5\").ChartObjects.Count\n        With Sheets(\"\u30b0\u30e9\u30d5\").ChartObjects(i).Chart\n            .PlotArea.InsideWidth = graphWidth * 0.85\n            .PlotArea.InsideHeight = graphHeight * 0.85\n            .PlotArea.InsideTop = 30 '(.ChartArea.Height - .PlotArea.Height) / 2\n            .PlotArea.InsideLeft = 30 '(.ChartArea.Width - .PlotArea.Width) / 2\n        End With\n    Next i\nEnd Sub\n\n'\u7279\u5b9a\u306e\u7bc4\u56f2\u3060\u3051\u30b0\u30e9\u30d5\u5316\u3059\u308b(\u9014\u4e2d)\nFunction getTimeRow(timeStr As String) As Long\n    getTimeRow = 1\nEnd Function\n\nSub addGraphSecond()\nDim x As Long\nDim yls As Variant, yrs As Variant\nDim i As Long\nDim startRowTime As String\nDim endRowTime As String\n    Call setRangeNames '\u540d\u524d\u4ed8\u304d\u7bc4\u56f2\u8a2d\u5b9a(\u66f4\u65b0)\n    If VarType(ActiveCell.Value) = vbString Then\n        x = getRangeNameIndex(ActiveCell.Value)\n    Else\n        x = ActiveCell.Value\n    End If\n    yls = getIdxArray(0) 'Sheets(\"\u30b0\u30e9\u30d5\").Range(ActiveCell.Offset(1, 0), ActiveCell.Offset(1, 0).End(xlDown))\n    yrs = getIdxArray(1) 'Sheets(\"\u30b0\u30e9\u30d5\").Range(ActiveCell.Offset(1, 1), ActiveCell.Offset(1, 1).End(xlDown))\n    If ActiveCell.Offset(0, 1) <> \"\" And ActiveCell.Offset(0, 2) <> \"\" Then\n        startRowTime = 4\n        endRowTime = 6\n    End If\n    \n    '\u7a7a\u306e\u30b0\u30e9\u30d5\u4f5c\u6210\n    'Charts.Add.Location where:=xlLocationAsObject, name:=ActiveSheet.name\n    With ActiveSheet.ChartObjects.Add(ActiveCell.Left, ActiveCell.Top, graphWidth, graphHeight).Chart\n        .ChartType = xlLine '\u6298\u308c\u7dda\u30b0\u30e9\u30d5\n        '.Parent.name = \"a\"\n        '.PlotArea.Width = graphWidth * 0.8\n        '.PlotArea.Height = graphHeight * 0.8\n        '\u30c7\u30fc\u30bf\u7cfb\u5217\u4f5c\u6210\n        '\u7b2c1\u8ef8\n        For i = 1 To UBound(yls)\n            If Not IsEmpty(yls(i, 1)) Then\n                If ActiveCell.Offset(0, 1) <> \"\" And ActiveCell.Offset(0, 2) <> \"\" Then\n                    With .SeriesCollection.NewSeries\n                        '.ChartType = xlLine '\u6298\u308c\u7dda\u30b0\u30e9\u30d5\n                        .XValues = Sheets(\"bunseki\").Range(Sheets(\"bunseki\").Cells(startRowTime, x), _\n                                                                                Sheets(\"bunseki\").Cells(endRowTime, x))\n                        .Values = Sheets(\"bunseki\").Range(Sheets(\"bunseki\").Cells(startRowTime, CLng(yls(i, 1))), _\n                                                                            Sheets(\"bunseki\").Cells(endRowTime, CLng(yls(i, 1))))\n                        .name = getRangeName(CLng(yls(i, 1)))\n                    End With\n                Else\n                    With .SeriesCollection.NewSeries\n                        '.ChartType = xlLine '\u6298\u308c\u7dda\u30b0\u30e9\u30d5\n                        .XValues = Range(getRangeName(x))\n                        .Values = Range(getRangeName(CLng(yls(i, 1))))\n                        .name = getRangeName(CLng(yls(i, 1)))\n                    End With\n                End If\n            End If\n        Next i\n        '\u7b2c2\u8ef8\n        For i = 1 To UBound(yrs)\n            If Not IsEmpty(yrs(i, 1)) Then\n                If ActiveCell.Offset(0, 1) <> \"\" And ActiveCell.Offset(0, 2) <> \"\" Then\n                    With .SeriesCollection.NewSeries\n                        '.ChartType = xlLine '\u6298\u308c\u7dda\u30b0\u30e9\u30d5\n                        .XValues = Sheets(\"bunseki\").Range(Sheets(\"bunseki\").Cells(startRowTime, x), _\n                                                                                Sheets(\"bunseki\").Cells(endRowTime, x))\n                        .Values = Sheets(\"bunseki\").Range(Sheets(\"bunseki\").Cells(startRowTime, CLng(yrs(i, 1))), _\n                                                                                Sheets(\"bunseki\").Cells(endRowTime, CLng(yrs(i, 1))))\n                        .name = getRangeName(CLng(yrs(i, 1)))\n                    End With\n                Else\n                    With .SeriesCollection.NewSeries\n                        '.ChartType = xlLine '\u6298\u308c\u7dda\u30b0\u30e9\u30d5\n                        .XValues = Range(getRangeName(x))\n                        .Values = Range(getRangeName(CLng(yrs(i, 1))))\n                        .name = getRangeName(CLng(yrs(i, 1)))\n                        .AxisGroup = xlSecondary '\u7b2c2\u8ef8\u306b\n                    End With\n                End If\n            End If\n        Next i\n        i = .PlotArea.InsideWidth\n        .PlotArea.InsideWidth = graphWidth * 0.85\n        .PlotArea.InsideHeight = graphHeight * 0.85\n        .PlotArea.InsideTop = 30 '(.ChartArea.Height - .PlotArea.Height) / 2\n        .PlotArea.InsideLeft = 30 '(.ChartArea.Width - .PlotArea.Width) / 2\n        \n    End With\n    \n    '\u30d7\u30ed\u30c3\u30c8\u30a8\u30ea\u30a2\u306e\u5185\u90e8\u30b5\u30a4\u30ba\u63c3\u3048\u308b\n    'Sheets(\"\u30b0\u30e9\u30d5\").ChartObjects(Sheets(\"\u30b0\u30e9\u30d5\").ChartObjects.Count).Chart.PlotArea.InsideWidth = graphWidth * 0.85\n    'Sheets(\"\u30b0\u30e9\u30d5\").ChartObjects(Sheets(\"\u30b0\u30e9\u30d5\").ChartObjects.Count).Chart.PlotArea.InsideHeight = graphHeight * 0.85\n    'Sheets(\"\u30b0\u30e9\u30d5\").ChartObjects(Sheets(\"\u30b0\u30e9\u30d5\").ChartObjects.Count).Chart.PlotArea.Top = 10\n    'Sheets(\"\u30b0\u30e9\u30d5\").ChartObjects(Sheets(\"\u30b0\u30e9\u30d5\").ChartObjects.Count).Chart.PlotArea.Left = 30\n    With Sheets(\"\u30b0\u30e9\u30d5\").ChartObjects(Sheets(\"\u30b0\u30e9\u30d5\").ChartObjects.Count).Chart\n            \n            '.PlotArea.InsideWidth = graphWidth * 0.85\n            '.PlotArea.InsideHeight = graphHeight * 0.85\n            '.PlotArea.InsideTop = 30 '(.ChartArea.Height - .PlotArea.Height) / 2\n            '.PlotArea.InsideLeft = 30 '(.ChartArea.Width - .PlotArea.Width) / 2\n        End With\nEnd Sub\n\n```\n", "tags": ["VBA", "Excel", "ExcelVBA"]}