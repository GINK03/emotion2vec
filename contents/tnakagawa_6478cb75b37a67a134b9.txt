{"context": " More than 1 year has passed since last update.\n\n\u63a5\u7d9a\nJScript\u304b\u3089\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3078\u63a5\u7d9a\u3057\u3066\u307f\u307e\u3059\u3002\n\u203b\uff1a\u74b0\u5883\u306b\u3064\u3044\u3066\u306f\u3001\u6587\u672b\u306b\u8a18\u8ff0\u3057\u3066\u3044\u307e\u3059\u3002\n\u63a5\u7d9a\u306e\u70ba\u306b\u3001\u4ee5\u4e0b\u306e\u60c5\u5831\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n\n\n\n\u30ad\u30fc\u30ef\u30fc\u30c9\n\u8aac\u660e\n\n\n\n\nProvider\nOLE DB Provider for ODBC\n\n\nDRIVER\n\"SQL Server\" \u306a\u3069\u306e ODBC \u30c9\u30e9\u30a4\u30d0\n\n\nSERVER\n\u30b5\u30fc\u30d0\u30fc\u540d\n\n\nDATABASE\n\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u540d\n\n\nUID\n\u30e6\u30fc\u30b6\u30fc \u30a2\u30ab\u30a6\u30f3\u30c8\u540d\n\n\nPWD\n\u30e6\u30fc\u30b6\u30fc \u30a2\u30ab\u30a6\u30f3\u30c8\u7528\u306e\u30d1\u30b9\u30ef\u30fc\u30c9\n\n\n\n\u63a5\u7d9a\u306e\u30b5\u30f3\u30d7\u30eb\u30b3\u30fc\u30c9\u3067\u3059\u3002\nvar driver = \"{SQL Server}\";          // ODBC\u30c9\u30e9\u30a4\u30d0\nvar server = \"localhost\\\\SQLEXPRESS\"; // \u30b5\u30fc\u30d0\nvar database = \"testdb\";              // \u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\nvar user = \"sa\";                      // \u30e6\u30fc\u30b6\nvar pass = \"*****\";                   // \u30d1\u30b9\u30ef\u30fc\u30c9\n\n\nadodbtest.js\nvar con = null;\ntry {\n    // \u300cADODB.Connection\u300d\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u751f\u6210\n    con = new ActiveXObject(\"ADODB.Connection\");\n    // \u30b9\u30c6\u30fc\u30bf\u30b9\u78ba\u8a8d\n    WScript.Echo(\"Version:\" + con.Version);\n    WScript.Echo(\"State:\" + con.State);\n    // \u63a5\u7d9a\u6587\u5b57\u5217\u8a2d\u5b9a\n    con.ConnectionString = \"Provider=MSDASQL\" // \u30d7\u30ed\u30d0\u30a4\u30c0\n        + \";DRIVER=\" + driver                 // ODBC\u30c9\u30e9\u30a4\u30d0\n        + \";SERVER=\" + server                 // \u30b5\u30fc\u30d0\n        + \";DATABASE=\" + database             // \u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\n        + \";UID=\" + user                      // \u30e6\u30fc\u30b6\n        + \";PWD=\" + pass;                     // \u30d1\u30b9\u30ef\u30fc\u30c9\n    // \u63a5\u7d9a\n    con.Open();\n    // \u30b9\u30c6\u30fc\u30bf\u30b9\u78ba\u8a8d\n    WScript.Echo(\"State:\" + con.State);\n} catch (e) {\n    // \u30a8\u30e9\u30fc\u306e\u5834\u5408\n    WScript.Echo(\"Error(\" + (e.number & 0xFFFF) + \"):\" + e.message);\n} finally {\n    try {\n        // \u30b9\u30c6\u30fc\u30bf\u30b9\u30c1\u30a7\u30c3\u30af\n        if (con && con.State == 1) {\n            // \u5207\u65ad\n            con.Close();\n        }\n    } catch (e) {\n        // \u30a8\u30e9\u30fc\u306e\u5834\u5408\n        WScript.Echo(\"Error(\" + (e.number & 0xFFFF) + \"):\" + e.message);\n    }\n}\n\n\n\n\u5b9f\u884c\u3057\u3066\u307f\u307e\u3059\u3002\ncscript.exe //Nologo adodbtest.js\n\n\u7d50\u679c\u304c\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\nVersion:6.1\nState:0\nState:1\n\n\n\u74b0\u5883\n\n\n\n\u540d\u79f0\n\u30d0\u30fc\u30b8\u30e7\u30f3\n\u305d\u306e\u4ed6\n\n\n\n\nOS\nWindows7\n64bit\n\n\nSQL\nMicrosoft SQL Server 2012 Express Edition\n64bit\n\n\n\n## \u63a5\u7d9a\nJScript\u304b\u3089\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3078\u63a5\u7d9a\u3057\u3066\u307f\u307e\u3059\u3002\n\u203b\uff1a\u74b0\u5883\u306b\u3064\u3044\u3066\u306f\u3001\u6587\u672b\u306b\u8a18\u8ff0\u3057\u3066\u3044\u307e\u3059\u3002\n\n\u63a5\u7d9a\u306e\u70ba\u306b\u3001\u4ee5\u4e0b\u306e\u60c5\u5831\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n\n|\u30ad\u30fc\u30ef\u30fc\u30c9|\u8aac\u660e|\n|:-----------|:------------|\n|Provider|OLE DB Provider for ODBC|\n|DRIVER|\"SQL Server\" \u306a\u3069\u306e ODBC \u30c9\u30e9\u30a4\u30d0|\n|SERVER|\u30b5\u30fc\u30d0\u30fc\u540d|\n|DATABASE|\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u540d |\n|UID|\u30e6\u30fc\u30b6\u30fc \u30a2\u30ab\u30a6\u30f3\u30c8\u540d|\n|PWD|\u30e6\u30fc\u30b6\u30fc \u30a2\u30ab\u30a6\u30f3\u30c8\u7528\u306e\u30d1\u30b9\u30ef\u30fc\u30c9|\n\n\n\u63a5\u7d9a\u306e\u30b5\u30f3\u30d7\u30eb\u30b3\u30fc\u30c9\u3067\u3059\u3002\n\n```js\nvar driver = \"{SQL Server}\";          // ODBC\u30c9\u30e9\u30a4\u30d0\nvar server = \"localhost\\\\SQLEXPRESS\"; // \u30b5\u30fc\u30d0\nvar database = \"testdb\";              // \u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\nvar user = \"sa\";                      // \u30e6\u30fc\u30b6\nvar pass = \"*****\";                   // \u30d1\u30b9\u30ef\u30fc\u30c9\n```\n\n```js:adodbtest.js\nvar con = null;\ntry {\n    // \u300cADODB.Connection\u300d\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u751f\u6210\n    con = new ActiveXObject(\"ADODB.Connection\");\n    // \u30b9\u30c6\u30fc\u30bf\u30b9\u78ba\u8a8d\n    WScript.Echo(\"Version:\" + con.Version);\n    WScript.Echo(\"State:\" + con.State);\n    // \u63a5\u7d9a\u6587\u5b57\u5217\u8a2d\u5b9a\n    con.ConnectionString = \"Provider=MSDASQL\" // \u30d7\u30ed\u30d0\u30a4\u30c0\n        + \";DRIVER=\" + driver                 // ODBC\u30c9\u30e9\u30a4\u30d0\n        + \";SERVER=\" + server                 // \u30b5\u30fc\u30d0\n        + \";DATABASE=\" + database             // \u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\n        + \";UID=\" + user                      // \u30e6\u30fc\u30b6\n        + \";PWD=\" + pass;                     // \u30d1\u30b9\u30ef\u30fc\u30c9\n    // \u63a5\u7d9a\n    con.Open();\n    // \u30b9\u30c6\u30fc\u30bf\u30b9\u78ba\u8a8d\n    WScript.Echo(\"State:\" + con.State);\n} catch (e) {\n    // \u30a8\u30e9\u30fc\u306e\u5834\u5408\n    WScript.Echo(\"Error(\" + (e.number & 0xFFFF) + \"):\" + e.message);\n} finally {\n    try {\n        // \u30b9\u30c6\u30fc\u30bf\u30b9\u30c1\u30a7\u30c3\u30af\n        if (con && con.State == 1) {\n            // \u5207\u65ad\n            con.Close();\n        }\n    } catch (e) {\n        // \u30a8\u30e9\u30fc\u306e\u5834\u5408\n        WScript.Echo(\"Error(\" + (e.number & 0xFFFF) + \"):\" + e.message);\n    }\n}\n\n```\n\n\u5b9f\u884c\u3057\u3066\u307f\u307e\u3059\u3002\n\n```bat\ncscript.exe //Nologo adodbtest.js\n```\n\n\u7d50\u679c\u304c\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\n\n```\nVersion:6.1\nState:0\nState:1\n```\n\n## \u74b0\u5883\n|\u540d\u79f0|\u30d0\u30fc\u30b8\u30e7\u30f3|\u305d\u306e\u4ed6|\n|:-----------|:------------|:------------|\n|OS|Windows7|64bit|\n|SQL|Microsoft SQL Server 2012 Express Edition|64bit|\n", "tags": ["JScript"]}