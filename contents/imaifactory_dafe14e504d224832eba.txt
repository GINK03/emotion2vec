{"context": " More than 1 year has passed since last update.\u3053\u306e\u30dd\u30b9\u30c8\u306f\u500b\u4eba\u306e\u30e1\u30e2\u3067\u3042\u308a\u3001\u79c1\u306e\u6240\u5c5e\u3059\u308b\u7d44\u7e54\u3092\u4ee3\u8868\u3059\u308b\u3082\u306e\u3067\u306f\u3042\u308a\u307e\u305b\u3093\u3002\n\n\u6982\u8981\nEMR\u306e\u30b9\u30cb\u30da\u30c3\u30c8\u3001\u3044\u3064\u3082\u540c\u3058\u3088\u3046\u306a\u3082\u306e\u3092\u66f8\u3044\u3066\u3057\u307e\u3046\u306e\u3067\u3053\u3053\u306b\u307e\u3068\u3081\u3066\u3044\u304f\u3053\u3068\u306b\u3059\u308b\u3002\n\nSpark\u3068Presto\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u305fCluster\u3092\u8d77\u52d5\u3059\u308b\n\ninstall_spark_and_presto.sh\naws emr create-cluster \\\n--name Spark_and_Presto \\\n--ami-version 3.4.0 \\\n--applications Name=Hive Name=Hue \\\n--instance-groups InstanceGroupType=MASTER,InstanceCount=1,InstanceType=c3.xlarge InstanceGroupType=CORE,InstanceCount=2,InstanceType=c3.xlarge \\\n--ec2-attributes SubnetId=YOUR_SUBNET,KeyName=YOUR_KEYPAIR \\\n--log-uri s3://PATH/TO/LOG/ \\\n--enable-debugging \\\n--bootstrap-actions \\\nName=Install_Spark,Path=s3://support.elasticmapreduce/spark/install-spark \\\nName=Install_Presto,Path=s3://beta.elasticmapreduce/bootstrap-actions/presto/install-presto.rb\n\n\n\n\u65e2\u5b58\u306e\u30af\u30e9\u30b9\u30bf\u306bHive\u306e\u30b8\u30e7\u30d6\u30b9\u30c6\u30c3\u30d7\u3092\u8ffd\u52a0\u3059\u308b\n\nadd_hive_step.sh\naws emr add-steps --cluster-id YOUR_CLUSTER_ID --steps Type=HIVE,Name='Hive program',ActionOnFailure=CONTINUE,Args=[-f,s3://PATH/TO/YOUR/QUERY.q]\n\n\n\nS3\u4e0a\u306eCloudFront\u306e\u30ed\u30b0\u3092\u5916\u90e8\u30c6\u30fc\u30d6\u30eb\u3068\u3057\u3066\u30de\u30a6\u30f3\u30c8\u3059\u308bCREATE TABLE\n\ncreate_external_table_for_cflog_on_s3.q\nCREATE EXTERNAL TABLE cflog (\n  date string,\n  time string,\n  x_edge_location string,\n  sc_bytes string,\n  c_ip string,\n  cs_method string,\n  cs_host string,\n  cs_uri_stem string,\n  sc_status string,\n  cs_referer string,\n  cs_ua string,\n  cs_uri_query string,\n  cs_cookie string,\n  x_edge_result_type string,\n  x_edge_request_id string,\n  x_host_header string,\n  cs_protocol string,\n  cs_bytes string,\n  time_taken string\n)\nROW FORMAT DELIMITED\nFIELDS TERMINATED BY '\\t'\nLOCATION 's3://PATH/TO/LOGS/';\n\n\nAmplab\u306eBigdata Benchmark\u306eUservisits\u30c6\u30fc\u30d6\u30eb\u3092\u4f5c\u6210\n\ncreate_external_table_for_uservisits\nCREATE EXTERNAL TABLE uservisits (\n  sourceIP STRING,\n  destURL STRING,\n  visitDate STRING,\n  adRevenue STRING,\n  userAgent STRING,\n  countryCode STRING,\n  languageCode STRING,\n  searchWord STRING,\n  duration STRING\n) \nROW FORMAT DELIMITED FIELDS TERMINATED BY ',' LINES TERMINATED BY '\\n'\nLOCATION 's3://big-data-benchmark/pavlo/text/tiny/uservisits/';\n\n\n\n\u3053\u306e\u30dd\u30b9\u30c8\u306f\u500b\u4eba\u306e\u30e1\u30e2\u3067\u3042\u308a\u3001\u79c1\u306e\u6240\u5c5e\u3059\u308b\u7d44\u7e54\u3092\u4ee3\u8868\u3059\u308b\u3082\u306e\u3067\u306f\u3042\u308a\u307e\u305b\u3093\u3002\n\n## \u6982\u8981\n\nEMR\u306e\u30b9\u30cb\u30da\u30c3\u30c8\u3001\u3044\u3064\u3082\u540c\u3058\u3088\u3046\u306a\u3082\u306e\u3092\u66f8\u3044\u3066\u3057\u307e\u3046\u306e\u3067\u3053\u3053\u306b\u307e\u3068\u3081\u3066\u3044\u304f\u3053\u3068\u306b\u3059\u308b\u3002\n\n## Spark\u3068Presto\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u305fCluster\u3092\u8d77\u52d5\u3059\u308b\n\n```bash:install_spark_and_presto.sh\naws emr create-cluster \\\n--name Spark_and_Presto \\\n--ami-version 3.4.0 \\\n--applications Name=Hive Name=Hue \\\n--instance-groups InstanceGroupType=MASTER,InstanceCount=1,InstanceType=c3.xlarge InstanceGroupType=CORE,InstanceCount=2,InstanceType=c3.xlarge \\\n--ec2-attributes SubnetId=YOUR_SUBNET,KeyName=YOUR_KEYPAIR \\\n--log-uri s3://PATH/TO/LOG/ \\\n--enable-debugging \\\n--bootstrap-actions \\\nName=Install_Spark,Path=s3://support.elasticmapreduce/spark/install-spark \\\nName=Install_Presto,Path=s3://beta.elasticmapreduce/bootstrap-actions/presto/install-presto.rb\n```\n\n## \u65e2\u5b58\u306e\u30af\u30e9\u30b9\u30bf\u306bHive\u306e\u30b8\u30e7\u30d6\u30b9\u30c6\u30c3\u30d7\u3092\u8ffd\u52a0\u3059\u308b\n\n```bash:add_hive_step.sh\naws emr add-steps --cluster-id YOUR_CLUSTER_ID --steps Type=HIVE,Name='Hive program',ActionOnFailure=CONTINUE,Args=[-f,s3://PATH/TO/YOUR/QUERY.q]\n```\n\n## S3\u4e0a\u306eCloudFront\u306e\u30ed\u30b0\u3092\u5916\u90e8\u30c6\u30fc\u30d6\u30eb\u3068\u3057\u3066\u30de\u30a6\u30f3\u30c8\u3059\u308bCREATE TABLE\n\n```sql:create_external_table_for_cflog_on_s3.q\nCREATE EXTERNAL TABLE cflog (\n  date string,\n  time string,\n  x_edge_location string,\n  sc_bytes string,\n  c_ip string,\n  cs_method string,\n  cs_host string,\n  cs_uri_stem string,\n  sc_status string,\n  cs_referer string,\n  cs_ua string,\n  cs_uri_query string,\n  cs_cookie string,\n  x_edge_result_type string,\n  x_edge_request_id string,\n  x_host_header string,\n  cs_protocol string,\n  cs_bytes string,\n  time_taken string\n)\nROW FORMAT DELIMITED\nFIELDS TERMINATED BY '\\t'\nLOCATION 's3://PATH/TO/LOGS/';\n```\n\n\n[Amplab\u306eBigdata Benchmark](https://amplab.cs.berkeley.edu/benchmark/)\u306eUservisits\u30c6\u30fc\u30d6\u30eb\u3092\u4f5c\u6210\n\n```sql:create_external_table_for_uservisits\nCREATE EXTERNAL TABLE uservisits (\n  sourceIP STRING,\n  destURL STRING,\n  visitDate STRING,\n  adRevenue STRING,\n  userAgent STRING,\n  countryCode STRING,\n  languageCode STRING,\n  searchWord STRING,\n  duration STRING\n) \nROW FORMAT DELIMITED FIELDS TERMINATED BY ',' LINES TERMINATED BY '\\n'\nLOCATION 's3://big-data-benchmark/pavlo/text/tiny/uservisits/';\n```\n", "tags": ["Spark", "Presto", "hadoop", "AWS", "EMR"]}