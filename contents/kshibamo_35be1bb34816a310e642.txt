{"context": " More than 1 year has passed since last update.Microsoft Security Advisory 2963983 \u3092\u53c2\u8003\u306b\u3001\u3056\u3063\u304f\u308a vgx.dll \u3092\u767b\u9332\u30fb\u89e3\u9664\u3059\u308b\u30d0\u30c3\u30c1\u30d5\u30a1\u30a4\u30eb\u3092\u66f8\u3044\u3066\u307f\u307e\u3057\u305f\u3002 32-bit Windows \u306e\u307f\u5bfe\u5fdc\u3057\u3066\u3044\u307e\u3059\u300264-bit Windows \u3067\u52d5\u4f5c\u3055\u305b\u308b\u306b\u306f\u30ec\u30b8\u30b9\u30c8\u30ea\u30ad\u30fc\uff08Wow6432Node\uff09\u3084\u30d5\u30a9\u30eb\u30c0\u30fc\uff08C:\\Windows\\SysWOW64\uff09\u306a\u3069\u3092\u8003\u616e\u3057\u3066\u4fee\u6b63\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\nwhere \u30b3\u30de\u30f3\u30c9\u304c\u306a\u3044\u5834\u5408\u306f which \u3092\u3054\u5229\u7528\u304f\u3060\u3055\u3044\u3002\n\n2963983.bat\n@echo off\n\nset SELF=%~n0\n\nsetlocal\n  echo.\n  echo checking prerequisites...\n  set PATH=%PATH%;%PROGRAMFILES%\\Internet Explorer\n  for %%i in (iexplore.exe ping.exe reg.exe regsvr32.exe taskkill.exe tasklist.exe) do (\n    where %%i > NUL || (\n      (echo %SELF%: file not found: %%i) >&2\n      exit /b 1\n    )\n  )\n  call :sleep 2\n\n  echo.\n  echo creating VML file...\n  (\n    echo ^<html xmlns:v=\"urn:schemas-microsoft-com:vml\"^>\n    echo ^<head^>\n    echo ^<style^>v\\:* { behavior: url^(#default#VML^); }^</style^>\n    echo ^</head^>\n    echo ^<body^>\n    echo ^<v:shape fillcolor=\"#ffcccc\" strokecolor=\"#cfa3a7\" style=\"width: 200; height:200\" path=\"m 80,0 l 60,65, 0,65, 50,100, 25,160,80,120, 135,160, 110,100, 160,65 100,65 x e\"^>^</v:shape^>\n    echo ^</body^>\n    echo ^</html^>\n  ) > %SELF%.html\n\n  echo.\n  echo launching browser and drawing vector graphic...\n  start iexplore %SELF%.html || (\n    (echo %SELF%: launching browser failed: start) >&2\n    exit /b 1\n  )\n  call :sleep 3\n\n  echo.\n  echo gathering information about vgx.dll...\n  tasklist /M \"vgx.dll\" || (\n    (echo %SELF%: gathering information failed: tasklist) >&2\n    exit /b 1\n  )\n\n  echo.\n  echo terminating browser...\n  set /p t=press ^<ENTER^> to continue.\n  for /f \"tokens=2\" %%i in ('tasklist /NH /FI \"IMAGENAME eq iexplore.exe\"') do (\n    taskkill /PID %%i > NUL 2>&1 || (\n      rem (echo %SELF%: terminating browser failed: taskkill) >&2\n    )\n  )\n\n  reg query \"HKEY_CLASSES_ROOT\\CLSID\\{10072CEC-8CC1-11D1-986E-00A0C955B42E}\\InprocServer32\" && (\n    echo.\n    echo deregistering vgx.dll...\n    regsvr32 /u \"%COMMONPROGRAMFILES%\\Microsoft Shared\\VGX\\vgx.dll\" || (\n      (echo %SELF%: deregistering DLL failed: regsvr32) >&2\n    )\n  ) || (\n    echo.\n    echo registering vgx.dll...\n    regsvr32    \"%COMMONPROGRAMFILES%\\Microsoft Shared\\VGX\\vgx.dll\" || (\n      (echo %SELF%: deregistering DLL failed: regsvr32) >&2\n    )\n  )\n\n  echo.\n  echo launching browser and drawing vector graphic...\n  start iexplore %SELF%.html || (\n    (echo %SELF%: launching browser failed: start) >&2\n    exit /b 1\n  )\n  call :sleep 3\n\n  echo.\n  echo gathering information about vgx.dll...\n  tasklist /M \"vgx.dll\" || (\n    (echo %SELF%: gathering information failed: tasklist) >&2\n    exit /b 1\n  )\n\n  echo.\n  echo terminating browser...\n  set /p t=press ^<ENTER^> to continue.\n  for /f \"tokens=2\" %%i in ('tasklist /NH /FI \"IMAGENAME eq iexplore.exe\"') do (\n    taskkill /PID %%i > NUL 2>&1 || (\n      rem (echo %SELF%: terminating browser failed: taskkill) >&2\n    )\n  )\n\n  echo.\n  echo deleting temporary file...\n  if exist \"%SELF%.html\" (\n    del %SELF%.html > NUL || (\n      (echo %SELF%: deleting file failed: del) >&2\n      exit /b 1\n    )\n  )\n\n  exit /b 0\nendlocal\ngoto :EOF\n\n:sleep\nsetlocal\n  if \"%~1\" == \"\" (\n    (echo insufficient argument: #1) >&2\n    exit /b 1\n  )\n  ping -n %~1 127.0.0.1 > NUL 2>&1\nendlocal\ngoto :EOF\n\n\n[Microsoft Security Advisory 2963983](https://technet.microsoft.com/library/security/2963983) \u3092\u53c2\u8003\u306b\u3001\u3056\u3063\u304f\u308a vgx.dll \u3092\u767b\u9332\u30fb\u89e3\u9664\u3059\u308b\u30d0\u30c3\u30c1\u30d5\u30a1\u30a4\u30eb\u3092\u66f8\u3044\u3066\u307f\u307e\u3057\u305f\u3002 32-bit Windows \u306e\u307f\u5bfe\u5fdc\u3057\u3066\u3044\u307e\u3059\u300264-bit Windows \u3067\u52d5\u4f5c\u3055\u305b\u308b\u306b\u306f\u30ec\u30b8\u30b9\u30c8\u30ea\u30ad\u30fc\uff08Wow6432Node\uff09\u3084\u30d5\u30a9\u30eb\u30c0\u30fc\uff08C:\\Windows\\SysWOW64\uff09\u306a\u3069\u3092\u8003\u616e\u3057\u3066\u4fee\u6b63\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\n\n`where` \u30b3\u30de\u30f3\u30c9\u304c\u306a\u3044\u5834\u5408\u306f [which](http://qiita.com/kshibamo/items/a68c3d74cb8612f3017c) \u3092\u3054\u5229\u7528\u304f\u3060\u3055\u3044\u3002\n\n```bat:2963983.bat\n@echo off\n\nset SELF=%~n0\n\nsetlocal\n  echo.\n  echo checking prerequisites...\n  set PATH=%PATH%;%PROGRAMFILES%\\Internet Explorer\n  for %%i in (iexplore.exe ping.exe reg.exe regsvr32.exe taskkill.exe tasklist.exe) do (\n    where %%i > NUL || (\n      (echo %SELF%: file not found: %%i) >&2\n      exit /b 1\n    )\n  )\n  call :sleep 2\n  \n  echo.\n  echo creating VML file...\n  (\n    echo ^<html xmlns:v=\"urn:schemas-microsoft-com:vml\"^>\n    echo ^<head^>\n    echo ^<style^>v\\:* { behavior: url^(#default#VML^); }^</style^>\n    echo ^</head^>\n    echo ^<body^>\n    echo ^<v:shape fillcolor=\"#ffcccc\" strokecolor=\"#cfa3a7\" style=\"width: 200; height:200\" path=\"m 80,0 l 60,65, 0,65, 50,100, 25,160,80,120, 135,160, 110,100, 160,65 100,65 x e\"^>^</v:shape^>\n    echo ^</body^>\n    echo ^</html^>\n  ) > %SELF%.html\n  \n  echo.\n  echo launching browser and drawing vector graphic...\n  start iexplore %SELF%.html || (\n    (echo %SELF%: launching browser failed: start) >&2\n    exit /b 1\n  )\n  call :sleep 3\n  \n  echo.\n  echo gathering information about vgx.dll...\n  tasklist /M \"vgx.dll\" || (\n    (echo %SELF%: gathering information failed: tasklist) >&2\n    exit /b 1\n  )\n  \n  echo.\n  echo terminating browser...\n  set /p t=press ^<ENTER^> to continue.\n  for /f \"tokens=2\" %%i in ('tasklist /NH /FI \"IMAGENAME eq iexplore.exe\"') do (\n    taskkill /PID %%i > NUL 2>&1 || (\n      rem (echo %SELF%: terminating browser failed: taskkill) >&2\n    )\n  )\n  \n  reg query \"HKEY_CLASSES_ROOT\\CLSID\\{10072CEC-8CC1-11D1-986E-00A0C955B42E}\\InprocServer32\" && (\n    echo.\n    echo deregistering vgx.dll...\n    regsvr32 /u \"%COMMONPROGRAMFILES%\\Microsoft Shared\\VGX\\vgx.dll\" || (\n      (echo %SELF%: deregistering DLL failed: regsvr32) >&2\n    )\n  ) || (\n    echo.\n    echo registering vgx.dll...\n    regsvr32    \"%COMMONPROGRAMFILES%\\Microsoft Shared\\VGX\\vgx.dll\" || (\n      (echo %SELF%: deregistering DLL failed: regsvr32) >&2\n    )\n  )\n  \n  echo.\n  echo launching browser and drawing vector graphic...\n  start iexplore %SELF%.html || (\n    (echo %SELF%: launching browser failed: start) >&2\n    exit /b 1\n  )\n  call :sleep 3\n  \n  echo.\n  echo gathering information about vgx.dll...\n  tasklist /M \"vgx.dll\" || (\n    (echo %SELF%: gathering information failed: tasklist) >&2\n    exit /b 1\n  )\n  \n  echo.\n  echo terminating browser...\n  set /p t=press ^<ENTER^> to continue.\n  for /f \"tokens=2\" %%i in ('tasklist /NH /FI \"IMAGENAME eq iexplore.exe\"') do (\n    taskkill /PID %%i > NUL 2>&1 || (\n      rem (echo %SELF%: terminating browser failed: taskkill) >&2\n    )\n  )\n  \n  echo.\n  echo deleting temporary file...\n  if exist \"%SELF%.html\" (\n    del %SELF%.html > NUL || (\n      (echo %SELF%: deleting file failed: del) >&2\n      exit /b 1\n    )\n  )\n  \n  exit /b 0\nendlocal\ngoto :EOF\n\n:sleep\nsetlocal\n  if \"%~1\" == \"\" (\n    (echo insufficient argument: #1) >&2\n    exit /b 1\n  )\n  ping -n %~1 127.0.0.1 > NUL 2>&1\nendlocal\ngoto :EOF\n```\n", "tags": ["\u30b3\u30de\u30f3\u30c9\u30d7\u30ed\u30f3\u30d7\u30c8", "\u30d0\u30c3\u30c1\u30d5\u30a1\u30a4\u30eb"]}