{"tags": ["riak1.4.9"], "context": " More than 1 year has passed since last update.\n\n\u671f\u5f85\u3059\u308b\u52d5\u4f5c\nnval_3\u306e\u30af\u30e9\u30b9\u30bf\u30671\u30d7\u30ed\u30bb\u30b9\u3092\u505c\u6b62\u3057\u3066 ?r=3 \u3067 GET \u3057\u3066404\u304c\u8fd4\u3055\u308c\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3057\u305f\u3044\n(\u8a73\u3057\u304f\u306f\u3053\u3061\u3089\u3082\u3054\u89a7\u304f\u3060\u3055\u3044\u3002 http://qiita.com/sgtn/items/2b3a4b87fb167ab4fa0f )\n\n\u74b0\u5883\n$ sw_vers\nProductName:    Mac OS X\nProductVersion: 10.9.3\nBuildVersion:   13D65\n\n$ dev/dev1/bin/riak version  \n\n\n\u4f55\u3082\u51fa\u306a\u3044\u3051\u3069 riak\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u306f1.4.9\n\u69cb\u7bc9\u65b9\u6cd5\u306f http://qiita.com/akm/items/bf14253a27943b13e79b\n\n\u78ba\u8a8d\u624b\u9806\n\n1. \u30ce\u30fc\u30c9\u304c\uff13\u3064\u8d77\u52d5\u3057\u3066\u3044\u308b\u3053\u3068\u78ba\u8a8d\u3002\n$ dev/dev1/bin/riak-admin member-status                      \n================================= Membership ==================================\nStatus     Ring    Pending    Node\n-------------------------------------------------------------------------------\nvalid      34.4%      --      'dev1@127.0.0.1'\nvalid      32.8%      --      'dev2@127.0.0.1'\nvalid      32.8%      --      'dev3@127.0.0.1'\n-------------------------------------------------------------------------------\nValid:3 / Leaving:0 / Exiting:0 / Joining:0 / Down:0\n\n\n2. \u4e00\u5fdc\u30d7\u30ed\u30bb\u30b9\u3082\u78ba\u8a8d\n$ ps aux | grep beam\nakimatter         83490   2.1  0.9  2562012  75624 s001  Ss+   9:30PM   0:38.11 $HOME/develop/riak-1.4.9/dev/dev1/bin/../erts-5.9.1/bin/beam.smp -K true -A 64 -W w -P 256000 -- -root $HOME/develop/riak-1.4.9/dev/dev1/bin/.. -progname riak -- -home $HOME -- -boot $HOME/develop/riak-1.4.9/dev/dev1/bin/../releases/1.4.9/riak -config $HOME/develop/riak-1.4.9/dev/dev1/bin/../etc/app.config -pa $HOME/develop/riak-1.4.9/dev/dev1/bin/../lib/basho-patches -name dev1@127.0.0.1 -setcookie riak -smp enable -- console\nakimatter         83693   1.6  0.9  2557624  74372 s002  Ss+   9:30PM   0:39.46 $HOME/develop/riak-1.4.9/dev/dev2/bin/../erts-5.9.1/bin/beam.smp -K true -A 64 -W w -P 256000 -- -root $HOME/develop/riak-1.4.9/dev/dev2/bin/.. -progname riak -- -home $HOME -- -boot $HOME/develop/riak-1.4.9/dev/dev2/bin/../releases/1.4.9/riak -config $HOME/develop/riak-1.4.9/dev/dev2/bin/../etc/app.config -pa $HOME/develop/riak-1.4.9/dev/dev2/bin/../lib/basho-patches -name dev2@127.0.0.1 -setcookie riak -smp enable -- console\nakimatter         83931   1.5  0.9  2563948  75236 s004  Ss+   9:30PM   0:36.36 $HOME/develop/riak-1.4.9/dev/dev3/bin/../erts-5.9.1/bin/beam.smp -K true -A 64 -W w -P 256000 -- -root $HOME/develop/riak-1.4.9/dev/dev3/bin/.. -progname riak -- -home $HOME -- -boot $HOME/develop/riak-1.4.9/dev/dev3/bin/../releases/1.4.9/riak -config $HOME/develop/riak-1.4.9/dev/dev3/bin/../etc/app.config -pa $HOME/develop/riak-1.4.9/dev/dev3/bin/../lib/basho-patches -name dev3@127.0.0.1 -setcookie riak -smp enable -- console\nakimatter         78910   0.0  0.0  2423368    216 s000  R+   11:45PM   0:00.00 grep beam\n\n\n\n3. \u304a\u3082\u3080\u308d\u306bkill\n$ kill -9 83931\n$ ps aux | grep beam\nakimatter         83490   0.6  0.9  2562012  75640 s001  Ss+   9:30PM   0:38.43 $HOME/develop/riak-1.4.9/dev/dev1/bin/../erts-5.9.1/bin/beam.smp -K true -A 64 -W w -P 256000 -- -root $HOME/develop/riak-1.4.9/dev/dev1/bin/.. -progname riak -- -home $HOME -- -boot $HOME/develop/riak-1.4.9/dev/dev1/bin/../releases/1.4.9/riak -config $HOME/develop/riak-1.4.9/dev/dev1/bin/../etc/app.config -pa $HOME/develop/riak-1.4.9/dev/dev1/bin/../lib/basho-patches -name dev1@127.0.0.1 -setcookie riak -smp enable -- console\nakimatter         83693   0.6  0.9  2557624  74380 s002  Ss+   9:30PM   0:39.76 $HOME/develop/riak-1.4.9/dev/dev2/bin/../erts-5.9.1/bin/beam.smp -K true -A 64 -W w -P 256000 -- -root $HOME/develop/riak-1.4.9/dev/dev2/bin/.. -progname riak -- -home $HOME -- -boot $HOME/develop/riak-1.4.9/dev/dev2/bin/../releases/1.4.9/riak -config $HOME/develop/riak-1.4.9/dev/dev2/bin/../etc/app.config -pa $HOME/develop/riak-1.4.9/dev/dev2/bin/../lib/basho-patches -name dev2@127.0.0.1 -setcookie riak -smp enable -- console\nakimatter         79914   0.0  0.0  2432780    440 s000  R+   11:46PM   0:00.00 grep beam\n\n\n4. GET\u3057\u3066\u307f\u308b\n\u3053\u306e\u8fd4\u3063\u3066\u304f\u308b\u30c7\u30fc\u30bf\u306f1\u65e5\u76ee\u306b\u767b\u9332\u3059\u308b\u30c7\u30fc\u30bf\u3002\n$ curl -i http://localhost:10018/buckets/animals/keys/ace?r=2\nHTTP/1.1 200 OK\nX-Riak-Vclock: a85hYGBgzGDKBVIcMRuucwXPO6ubwZTImMfKMCtA+CxfFgA=\nVary: Accept-Encoding\nServer: MochiWeb/1.1 WebMachine/1.10.0 (never breaks eye contact)\nLink: </buckets/animals>; rel=\"up\"\nLast-Modified: Mon, 16 Jun 2014 11:27:22 GMT\nETag: \"1HaofJkNoXFIbzv8NgU4Qo\"\nDate: Mon, 30 Jun 2014 14:46:30 GMT\nContent-Type: application/json\nContent-Length: 58\n\n{\"nickname\": \"The Wonder Dog\", \"breed\": \"German Shepherd\"}\n\n\u3046\u30fc\u3093\u3001200 OK\u304c\u8fd4\u3063\u3066\u304d\u3066\u308b\u3002\n\n5. anti_entropy\u306e\u78ba\u8a8d\n\u3053\u306e\u8fba\u3067\u3082\u3057\u3084\u3068\u601d\u3063\u305f\u306e\u3067\u3001\u8a2d\u5b9a\u3057\u3066\u304a\u3044\u305f\u306e\u3067\u3001\u518d\u5ea6\u78ba\u8a8d\n$ grep -rn anti_entropy, dev/*/etc/app.config | grep -v %%\ndev/dev1/etc/app.config:93:            {anti_entropy, {off, [debug]}},\ndev/dev2/etc/app.config:93:            {anti_entropy, {off, [debug]}},\ndev/dev3/etc/app.config:93:            {anti_entropy, {off, [debug]}},\n\n\u5ff5\u306e\u305f\u3081dev1, dev2, dev3\u3092\u518d\u8d77\u52d5\u3057\u305f\u3051\u3069\u540c\u3058\u3002\n\n6. props\u3082\u78ba\u8a8d\n$ curl http://localhost:10018/buckets/animals/props | jq \".\" \n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n100   411  100   411    0     0   183k      0 --:--:-- --:--:-- --:--:--  200k\n{\n  \"props\": {\n    \"young_vclock\": 20,\n    \"w\": 1,\n    \"small_vclock\": 50,\n    \"rw\": \"quorum\",\n    \"n_val\": 3,\n    \"linkfun\": {\n      \"fun\": \"mapreduce_linkfun\",\n      \"mod\": \"riak_kv_wm_link_walker\"\n    },\n    \"last_write_wins\": false,\n    \"dw\": \"quorum\",\n    \"chash_keyfun\": {\n      \"fun\": \"chash_std_keyfun\",\n      \"mod\": \"riak_core_util\"\n    },\n    \"big_vclock\": 50,\n    \"basic_quorum\": false,\n    \"allow_mult\": false,\n    \"name\": \"animals\",\n    \"notfound_ok\": true,\n    \"old_vclock\": 86400,\n    \"postcommit\": [],\n    \"pr\": 0,\n    \"precommit\": [],\n    \"pw\": 0,\n    \"r\": 3\n  }\n}\n\n\n\u7d50\u8ad6\n\u3053\u307e\u3063\u305f\u30fc\u3063\u3066twitter\u306b\u66f8\u3044\u3066\u305f\u3089\u3001\u4e2d\u306e\u4eba @takabow \u3055\u3093\u304b\u3089\u8aac\u660e\u3057\u3066\u3044\u305f\u3060\u3051\u307e\u3057\u305f\uff01\n\u305d\u306e\u307e\u3068\u3081\u306f\u3053\u3061\u3089\u30fc\nhttp://togetter.com/li/686949\n\u30d5\u30a9\u30fc\u30eb\u30d0\u30c3\u30af\u30ce\u30fc\u30c9\u304c1\u53f02\u5f79\u3059\u308b\u306e\u3067 200 OK\u3067OK!\n\n# \u671f\u5f85\u3059\u308b\u52d5\u4f5c\n\nnval_3\u306e\u30af\u30e9\u30b9\u30bf\u30671\u30d7\u30ed\u30bb\u30b9\u3092\u505c\u6b62\u3057\u3066 ?r=3 \u3067 GET \u3057\u3066404\u304c\u8fd4\u3055\u308c\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3057\u305f\u3044\n\n(\u8a73\u3057\u304f\u306f\u3053\u3061\u3089\u3082\u3054\u89a7\u304f\u3060\u3055\u3044\u3002 http://qiita.com/sgtn/items/2b3a4b87fb167ab4fa0f )\n\n\n# \u74b0\u5883\n\n```\n$ sw_vers\nProductName:\tMac OS X\nProductVersion:\t10.9.3\nBuildVersion:\t13D65\n```\n\n```\n$ dev/dev1/bin/riak version  \n\n```\n\u4f55\u3082\u51fa\u306a\u3044\u3051\u3069 riak\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u306f1.4.9\n\n\u69cb\u7bc9\u65b9\u6cd5\u306f http://qiita.com/akm/items/bf14253a27943b13e79b\n\n\n# \u78ba\u8a8d\u624b\u9806\n\n## 1. \u30ce\u30fc\u30c9\u304c\uff13\u3064\u8d77\u52d5\u3057\u3066\u3044\u308b\u3053\u3068\u78ba\u8a8d\u3002\n\n```\n$ dev/dev1/bin/riak-admin member-status                      \n================================= Membership ==================================\nStatus     Ring    Pending    Node\n-------------------------------------------------------------------------------\nvalid      34.4%      --      'dev1@127.0.0.1'\nvalid      32.8%      --      'dev2@127.0.0.1'\nvalid      32.8%      --      'dev3@127.0.0.1'\n-------------------------------------------------------------------------------\nValid:3 / Leaving:0 / Exiting:0 / Joining:0 / Down:0\n```\n\n## 2. \u4e00\u5fdc\u30d7\u30ed\u30bb\u30b9\u3082\u78ba\u8a8d\n\n```\n$ ps aux | grep beam\nakimatter         83490   2.1  0.9  2562012  75624 s001  Ss+   9:30PM   0:38.11 $HOME/develop/riak-1.4.9/dev/dev1/bin/../erts-5.9.1/bin/beam.smp -K true -A 64 -W w -P 256000 -- -root $HOME/develop/riak-1.4.9/dev/dev1/bin/.. -progname riak -- -home $HOME -- -boot $HOME/develop/riak-1.4.9/dev/dev1/bin/../releases/1.4.9/riak -config $HOME/develop/riak-1.4.9/dev/dev1/bin/../etc/app.config -pa $HOME/develop/riak-1.4.9/dev/dev1/bin/../lib/basho-patches -name dev1@127.0.0.1 -setcookie riak -smp enable -- console\nakimatter         83693   1.6  0.9  2557624  74372 s002  Ss+   9:30PM   0:39.46 $HOME/develop/riak-1.4.9/dev/dev2/bin/../erts-5.9.1/bin/beam.smp -K true -A 64 -W w -P 256000 -- -root $HOME/develop/riak-1.4.9/dev/dev2/bin/.. -progname riak -- -home $HOME -- -boot $HOME/develop/riak-1.4.9/dev/dev2/bin/../releases/1.4.9/riak -config $HOME/develop/riak-1.4.9/dev/dev2/bin/../etc/app.config -pa $HOME/develop/riak-1.4.9/dev/dev2/bin/../lib/basho-patches -name dev2@127.0.0.1 -setcookie riak -smp enable -- console\nakimatter         83931   1.5  0.9  2563948  75236 s004  Ss+   9:30PM   0:36.36 $HOME/develop/riak-1.4.9/dev/dev3/bin/../erts-5.9.1/bin/beam.smp -K true -A 64 -W w -P 256000 -- -root $HOME/develop/riak-1.4.9/dev/dev3/bin/.. -progname riak -- -home $HOME -- -boot $HOME/develop/riak-1.4.9/dev/dev3/bin/../releases/1.4.9/riak -config $HOME/develop/riak-1.4.9/dev/dev3/bin/../etc/app.config -pa $HOME/develop/riak-1.4.9/dev/dev3/bin/../lib/basho-patches -name dev3@127.0.0.1 -setcookie riak -smp enable -- console\nakimatter         78910   0.0  0.0  2423368    216 s000  R+   11:45PM   0:00.00 grep beam\n\n```\n\n## 3. \u304a\u3082\u3080\u308d\u306bkill\n\n```\n$ kill -9 83931\n$ ps aux | grep beam\nakimatter         83490   0.6  0.9  2562012  75640 s001  Ss+   9:30PM   0:38.43 $HOME/develop/riak-1.4.9/dev/dev1/bin/../erts-5.9.1/bin/beam.smp -K true -A 64 -W w -P 256000 -- -root $HOME/develop/riak-1.4.9/dev/dev1/bin/.. -progname riak -- -home $HOME -- -boot $HOME/develop/riak-1.4.9/dev/dev1/bin/../releases/1.4.9/riak -config $HOME/develop/riak-1.4.9/dev/dev1/bin/../etc/app.config -pa $HOME/develop/riak-1.4.9/dev/dev1/bin/../lib/basho-patches -name dev1@127.0.0.1 -setcookie riak -smp enable -- console\nakimatter         83693   0.6  0.9  2557624  74380 s002  Ss+   9:30PM   0:39.76 $HOME/develop/riak-1.4.9/dev/dev2/bin/../erts-5.9.1/bin/beam.smp -K true -A 64 -W w -P 256000 -- -root $HOME/develop/riak-1.4.9/dev/dev2/bin/.. -progname riak -- -home $HOME -- -boot $HOME/develop/riak-1.4.9/dev/dev2/bin/../releases/1.4.9/riak -config $HOME/develop/riak-1.4.9/dev/dev2/bin/../etc/app.config -pa $HOME/develop/riak-1.4.9/dev/dev2/bin/../lib/basho-patches -name dev2@127.0.0.1 -setcookie riak -smp enable -- console\nakimatter         79914   0.0  0.0  2432780    440 s000  R+   11:46PM   0:00.00 grep beam\n```\n\n## 4. GET\u3057\u3066\u307f\u308b\n\n\u3053\u306e\u8fd4\u3063\u3066\u304f\u308b\u30c7\u30fc\u30bf\u306f1\u65e5\u76ee\u306b\u767b\u9332\u3059\u308b\u30c7\u30fc\u30bf\u3002\n\n```\n$ curl -i http://localhost:10018/buckets/animals/keys/ace?r=2\nHTTP/1.1 200 OK\nX-Riak-Vclock: a85hYGBgzGDKBVIcMRuucwXPO6ubwZTImMfKMCtA+CxfFgA=\nVary: Accept-Encoding\nServer: MochiWeb/1.1 WebMachine/1.10.0 (never breaks eye contact)\nLink: </buckets/animals>; rel=\"up\"\nLast-Modified: Mon, 16 Jun 2014 11:27:22 GMT\nETag: \"1HaofJkNoXFIbzv8NgU4Qo\"\nDate: Mon, 30 Jun 2014 14:46:30 GMT\nContent-Type: application/json\nContent-Length: 58\n\n{\"nickname\": \"The Wonder Dog\", \"breed\": \"German Shepherd\"}\n```\n\n\u3046\u30fc\u3093\u3001200 OK\u304c\u8fd4\u3063\u3066\u304d\u3066\u308b\u3002\n\n## 5. anti_entropy\u306e\u78ba\u8a8d\n\n\u3053\u306e\u8fba\u3067\u3082\u3057\u3084\u3068\u601d\u3063\u305f\u306e\u3067\u3001\u8a2d\u5b9a\u3057\u3066\u304a\u3044\u305f\u306e\u3067\u3001\u518d\u5ea6\u78ba\u8a8d\n\n```\n$ grep -rn anti_entropy, dev/*/etc/app.config | grep -v %%\ndev/dev1/etc/app.config:93:            {anti_entropy, {off, [debug]}},\ndev/dev2/etc/app.config:93:            {anti_entropy, {off, [debug]}},\ndev/dev3/etc/app.config:93:            {anti_entropy, {off, [debug]}},\n```\n\n\u5ff5\u306e\u305f\u3081dev1, dev2, dev3\u3092\u518d\u8d77\u52d5\u3057\u305f\u3051\u3069\u540c\u3058\u3002\n\n## 6. props\u3082\u78ba\u8a8d\n\n```\n$ curl http://localhost:10018/buckets/animals/props | jq \".\" \n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n100   411  100   411    0     0   183k      0 --:--:-- --:--:-- --:--:--  200k\n{\n  \"props\": {\n    \"young_vclock\": 20,\n    \"w\": 1,\n    \"small_vclock\": 50,\n    \"rw\": \"quorum\",\n    \"n_val\": 3,\n    \"linkfun\": {\n      \"fun\": \"mapreduce_linkfun\",\n      \"mod\": \"riak_kv_wm_link_walker\"\n    },\n    \"last_write_wins\": false,\n    \"dw\": \"quorum\",\n    \"chash_keyfun\": {\n      \"fun\": \"chash_std_keyfun\",\n      \"mod\": \"riak_core_util\"\n    },\n    \"big_vclock\": 50,\n    \"basic_quorum\": false,\n    \"allow_mult\": false,\n    \"name\": \"animals\",\n    \"notfound_ok\": true,\n    \"old_vclock\": 86400,\n    \"postcommit\": [],\n    \"pr\": 0,\n    \"precommit\": [],\n    \"pw\": 0,\n    \"r\": 3\n  }\n}\n```\n\n\n# \u7d50\u8ad6\n\n\u3053\u307e\u3063\u305f\u30fc\u3063\u3066twitter\u306b\u66f8\u3044\u3066\u305f\u3089\u3001\u4e2d\u306e\u4eba @takabow \u3055\u3093\u304b\u3089\u8aac\u660e\u3057\u3066\u3044\u305f\u3060\u3051\u307e\u3057\u305f\uff01\n\n\u305d\u306e\u307e\u3068\u3081\u306f\u3053\u3061\u3089\u30fc\nhttp://togetter.com/li/686949\n\n\u30d5\u30a9\u30fc\u30eb\u30d0\u30c3\u30af\u30ce\u30fc\u30c9\u304c1\u53f02\u5f79\u3059\u308b\u306e\u3067 200 OK\u3067OK!\n"}