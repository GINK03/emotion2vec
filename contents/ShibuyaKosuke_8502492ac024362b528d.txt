{"context": "\n\u57fa\u672c\u8a2d\u8a08\u3001\u30e6\u30fc\u30b6\u30fc\u30e2\u30c7\u30eb\n\u30aa\u30fc\u30c8\u30ed\u30fc\u30c0\u30fc\n\u4f8b\u5916\u30fb\u30ed\u30b0\n\nPDO \u30b7\u30f3\u30b0\u30eb\u30c8\u30f3\u3000SQL\u30a4\u30f3\u30b8\u30a7\u30af\u30b7\u30e7\u30f3\n\n\u6c4e\u7528\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u30fb\u30af\u30e9\u30b9\u4f5c\u6210\n\n\n\u30e6\u30fc\u30b6\u30fc\u30e2\u30c7\u30eb\u306e\u4f5c\u6210\n\u30af\u30e9\u30b9\u306e\u7d99\u627f\n\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u30fb\u30af\u30e9\u30b9\u306e\u5b9f\u88c5\n\u30a2\u30ab\u30a6\u30f3\u30c8\u30ed\u30c3\u30af\u6a5f\u80fd\u306e\u5b9f\u88c5\n\u30e1\u30fc\u30eb\u9001\u4fe1\u6a5f\u80fd\u306e\u5b9f\u88c5\n\u30a2\u30ab\u30a6\u30f3\u30c8\u30ed\u30c3\u30af\u89e3\u9664\u6a5f\u80fd\u306e\u5b9f\u88c5\nCSRF\u5bfe\u7b56\n\n\u524d\u56de\u306e\u7d9a\u304d\u304c\u3053\u3093\u306a\u306b\u7a7a\u3044\u3066\u3057\u307e\u3044\u307e\u3057\u305f\u3002DB\u5468\u308a\u306e\u5b9f\u88c5\u306b\u304b\u306a\u308a\u60a9\u3093\u3067\u3044\u3066\u3001\u60a9\u3093\u3067\u3044\u308b\u3046\u3061\u306b\u3081\u3093\u3069\u304f\u3055\u304f\u2026\nDB\u5468\u308a\u306e\u5b9f\u88c5\u306b\u3064\u3044\u3066\u306f\u3001PDO\u3092\u5229\u7528\u3059\u308b\u65b9\u6cd5\u4e00\u629e\u304b\u3068\u601d\u3044\u307e\u3059\u3002\n\u3053\u306e\u8fba\u308a\u306e\u6a5f\u80fd\u306f\u4e00\u5ea6\u4f5c\u3063\u3066\u3057\u307e\u3048\u3070\u3001\u518d\u5229\u7528\u3057\u3084\u3059\u3044\u3057\u3001\u4f7f\u3044\u6163\u308c\u308b\u3068\u3001\u958b\u767a\u901f\u5ea6\u3082\u901f\u304f\u306a\u308a\u307e\u3059\u3002\u307e\u305f\u3001SQL\u30a4\u30f3\u30b8\u30a7\u30af\u30b7\u30e7\u30f3\u306a\u3069\u306e\u8106\u5f31\u6027\u3092\u57cb\u3081\u8fbc\u307f\u306b\u304f\u304f\u306a\u308a\u307e\u3059\u306e\u3067\u4e00\u77f3\u4e8c\u9ce5\u3002\n\u57fa\u672c\u7684\u306bDB\u5468\u308a\u3067\u5fc5\u8981\u306a\u6a5f\u80fd\u306f\u4ee5\u4e0b\u306e\u3068\u304a\u308a\u3002\n\nSELECT\nINSERT\nUPDATE\nDELETE\n\n\u3053\u308c\u3089\u306eSQL\u304c\u624b\u3063\u53d6\u308a\u65e9\u304f\u5b9f\u884c\u3067\u304d\u308c\u3070\u3044\u3044\u308f\u3051\u3067\u3059\u3002\n\u30af\u30e9\u30b9\u4f5c\u6210\u306b\u3042\u305f\u3063\u3066\u306f\u3001\u8a2d\u8a08\u601d\u60f3\u306b\u3088\u3063\u3066\u3001\u5b9f\u88c5\u65b9\u6cd5\u306f\u69d8\u3005\u306a\u30d0\u30ea\u30a8\u30fc\u30b7\u30e7\u30f3\u304c\u3042\u308b\u3053\u3068\u306b\u306a\u308a\u307e\u3059\u304c\u3001\u4ee5\u4e0b\u306e\u76ee\u7684\u3067\u4f5c\u6210\u3059\u308b\u3053\u3068\u3068\u3057\u307e\u3059\u3002\n\n\u30e1\u30bd\u30c3\u30c9\u306e\u547c\u3073\u51fa\u3057\u65b9\u6cd5\u304c\u7c21\u5358\u3067\u3042\u308b\u3053\u3068\n\u63a5\u7d9a\uff08\u30b3\u30cd\u30af\u30b7\u30e7\u30f3\u3092\u4f7f\u3044\u56de\u3059\u3053\u3068\uff09\nSQL\u306e\u30a8\u30e9\u30fc\u304c\u9069\u5207\u306b\u901a\u77e5\u3055\u308c\u308b\u3053\u3068\n\n\u3053\u308c\u3089\u3092\u76ee\u7684\u3068\u3057\u3066\u5b9f\u88c5\u3057\u307e\u3059\u3002\n\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u30b9\u30b1\u30eb\u30c8\u30f3\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\nDb.class.php\n<?php\n\nnamespace MyApp\\common;\n\nclass Db\n{\n\n    /**\n     * SELECT\u5b9f\u884c\n     * @param string $sql\n     * @param array $arr\n     * @return array\n     */\n    public static function select($sql, array $arr = array())\n    {\n    }\n\n    /**\n     * INSERT\u5b9f\u884c\n     * @param string $sql\n     * @param array $arr\n     * @return int\n     */\n    public static function insert($sql, array $arr)\n    {\n    }\n\n    /**\n     * UPDATE\u5b9f\u884c\n     * @param string $sql\n     * @param array $arr\n     * @return bool\n     */\n    public static function update($sql, array $arr)\n    {\n    }\n\n    /**\n     * DELETE\u5b9f\u884c\n     * @param string $sql\n     * @param array $arr\n     * @return bool\n     */\n    public static function delete($sql, array $arr)\n    {\n    }\n\n}\n\n\nstatic \u3067\u30e1\u30bd\u30c3\u30c9\u3092\u8a2d\u5b9a\u3057\u3066\u304a\u304f\u3068\u3001\u547c\u3073\u51fa\u3057\u5143\u304b\u3089\u306f\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u547c\u3073\u51fa\u3057\u3067\u304d\u307e\u3059\u3002\n<?php\n\nuse MyApp\\common\\Db;\n\n$sql = 'SELECT id FROM Users';\n$res = Db::select($sql);\n\n$sql = 'INSERT INTO Users (id, name) VALUES (null, :name)';\n$arr = array(\n    ':name' => 'Sato'\n);\nDb::insert($sql, $arr);\n\n\u697d\u30c1\u30f3\uff01\n\u4eca\u56de\u306e\u30e1\u30a4\u30f3\u306f\u3001\u300c\u30b3\u30cd\u30af\u30b7\u30e7\u30f3\u3092\u3044\u304b\u306b\u3057\u3066\u4f7f\u3044\u307e\u308f\u3059\u304b\u300d\u3068\u3044\u3046\u3053\u3068\u3067\u3059\u304c\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u5b9f\u88c5\u3057\u307e\u3059\u3002\n\u5927\u4e8b\u306a\u306e\u306f\u3001getInstance() \u306e\u5b9f\u88c5\u3067\u3059\u3002$instance \u304c null \u306e\u3068\u304d\u3001PDO \u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u751f\u6210\u3057\u3001\u305d\u308c\u3092\u8fd4\u3059\u3002null \u3067\u306a\u3044\u3068\u304d\u306f\u3001\u751f\u6210\u6e08\u307f\u306e PDO \u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u8fd4\u3059\u4ed5\u7d44\u307f\u306b\u306a\u3063\u3066\u3044\u307e\u3059\u3002\n\u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3\u51e6\u7406\u306b\u95a2\u9023\u3059\u308b\u3001transaction(), commit(), rollback() \u3092\u5b9f\u88c5\u3057\u3066\u3044\u307e\u3059\u3002\n\nDb.class.php\n<?php\n\nclass Db\n{\n\n    /**\n     * \u63a5\u7d9a\u6587\u5b57\u5217\n     */\n    const DSN = 'mysql:dbname=%s;host=localhost;charset=utf8;';\n\n    /**\n     * \u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u540d\n     */\n    const DBNAME = 'sample';\n\n    /**\n     * \u30e6\u30fc\u30b6\u30fc\u540d\n     */\n    const USER_NAME = 'root';\n\n    /**\n     * \u30d1\u30b9\u30ef\u30fc\u30c9\n     */\n    const PASSWORD = 'password';\n\n    /**\n     * PDO\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\n     * @var \\PDO\n     */\n    static private $instance = null;\n\n    /**\n     * \u30b3\u30f3\u30b9\u30c8\u30e9\u30af\u30bf\n     * @access private\n     */\n    private function __construct()\n    {\n        // \u5916\u90e8\u304b\u3089\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u5316\u3067\u304d\u306a\u3044\u3088\u3046\u306b\u3001private \u3067\u5ba3\u8a00\n    }\n\n    /**\n     * \u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u3092\u53d6\u5f97\n     * @return \\PDO\n     */\n    private static function getInstance()\n    {\n        if (is_null(self::$instance)) {\n            $options = array(\n                \\PDO::ATTR_ERRMODE => \\PDO::ERRMODE_EXCEPTION\n                , \\PDO::ATTR_DEFAULT_FETCH_MODE => \\PDO::FETCH_ASSOC\n                , \\PDO::ATTR_AUTOCOMMIT => true\n            );\n            self::$instance = new \\PDO(\n                sprintf(self::DSN, self::DBNAME)\n                , self::USER_NAME\n                , self::PASSWORD\n                , $options\n            );\n        }\n        return self::$instance;\n    }\n\n    /**\n     * \u30af\u30ed\u30fc\u30f3\n     * @throws \\Exception\n     */\n    final public function __clone()\n    {\n        $msg = sprintf('Clone is not allowed against %s', get_class($this));\n        throw new \\Exception($msg);\n    }\n\n    /**\n     * \u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3\u5b9f\u884c\n     */\n    public static function transaction()\n    {\n        self::getInstance()->beginTransaction();\n    }\n\n    /**\n     * \u30b3\u30df\u30c3\u30c8\n     */\n    public static function commit()\n    {\n        self::getInstance()->commit();\n    }\n\n    /**\n     * \u30ed\u30fc\u30eb\u30d0\u30c3\u30af\n     */\n    public static function rollback()\n    {\n        self::getInstance()->rollBack();\n    }\n\n    /**\n     * SELECT\u5b9f\u884c\n     * @param string $sql\n     * @param array $arr\n     * @return array\n     */\n    public static function select($sql, array $arr = array())\n    {\n        $stmt = self::getInstance()->prepare($sql);\n        $stmt->execute($arr);\n        return $stmt->fetchAll();\n    }\n\n    /**\n     * INSERT\u5b9f\u884c\n     * @param string $sql\n     * @param array $arr\n     * @return int\n     */\n    public static function insert($sql, array $arr)\n    {\n        if (!self::getInstance()->inTransaction()) {\n            throw new \\Exception('Not in transaction!');\n        }\n        $stmt = self::getInstance()->prepare($sql);\n        $stmt->execute($arr);\n        return self::getInstance()->lastInsertId();\n    }\n\n    /**\n     * UPDATE\u5b9f\u884c\n     * @param string $sql\n     * @param array $arr\n     * @return bool\n     */\n    public static function update($sql, array $arr)\n    {\n        if (!self::getInstance()->inTransaction()) {\n            throw new \\Exception('Not in transaction!');\n        }\n        $stmt = self::getInstance()->prepare($sql);\n        return $stmt->execute($arr);\n    }\n\n    /**\n     * DELETE\u5b9f\u884c\n     * @param string $sql\n     * @param array $arr\n     */\n    public static function delete($sql, array $arr)\n    {\n        if (!self::getInstance()->inTransaction()) {\n            throw new \\Exception('Not in transaction!');\n        }\n        $stmt = self::getInstance()->prepare($sql);\n        return $stmt->execute($arr);\n    }\n\n}\n\n\n\n1. [\u57fa\u672c\u8a2d\u8a08\u3001\u30e6\u30fc\u30b6\u30fc\u30e2\u30c7\u30eb](http://qiita.com/ShibuyaKosuke/items/f114ffccf441edb2b745)\n2. [\u30aa\u30fc\u30c8\u30ed\u30fc\u30c0\u30fc](http://qiita.com/ShibuyaKosuke/items/6109810464a7293293bd)\n3. [\u4f8b\u5916\u30fb\u30ed\u30b0](http://qiita.com/ShibuyaKosuke/items/88b1305a4ff0c5f3e728)\n4. [PDO \u30b7\u30f3\u30b0\u30eb\u30c8\u30f3\u3000SQL\u30a4\u30f3\u30b8\u30a7\u30af\u30b7\u30e7\u30f3](http://qiita.com/ShibuyaKosuke/items/094df7f399912ae7df56)\n\t* [\u6c4e\u7528\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u30fb\u30af\u30e9\u30b9\u4f5c\u6210](http://qiita.com/ShibuyaKosuke/items/8502492ac024362b528d)\n\n5. [\u30e6\u30fc\u30b6\u30fc\u30e2\u30c7\u30eb\u306e\u4f5c\u6210](http://qiita.com/ShibuyaKosuke/items/81c556d836d70a29c5f3)\n6. [\u30af\u30e9\u30b9\u306e\u7d99\u627f](http://qiita.com/ShibuyaKosuke/items/490ffa6a92670cf6c644)\n7. [\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u30fb\u30af\u30e9\u30b9\u306e\u5b9f\u88c5](http://qiita.com/ShibuyaKosuke/items/803dc58a23601118942e)\n8. [\u30a2\u30ab\u30a6\u30f3\u30c8\u30ed\u30c3\u30af\u6a5f\u80fd\u306e\u5b9f\u88c5](http://qiita.com/ShibuyaKosuke/items/e890becdb8193d3def05)\n9. [\u30e1\u30fc\u30eb\u9001\u4fe1\u6a5f\u80fd\u306e\u5b9f\u88c5](http://qiita.com/ShibuyaKosuke/items/78c8673782ebbf51584b)\n10. [\u30a2\u30ab\u30a6\u30f3\u30c8\u30ed\u30c3\u30af\u89e3\u9664\u6a5f\u80fd\u306e\u5b9f\u88c5](http://qiita.com/ShibuyaKosuke/items/ee4b1896071eeca37628)\n11. [CSRF\u5bfe\u7b56](http://qiita.com/ShibuyaKosuke/items/8100e304e4447e44e98c)\n\n\u524d\u56de\u306e\u7d9a\u304d\u304c\u3053\u3093\u306a\u306b\u7a7a\u3044\u3066\u3057\u307e\u3044\u307e\u3057\u305f\u3002DB\u5468\u308a\u306e\u5b9f\u88c5\u306b\u304b\u306a\u308a\u60a9\u3093\u3067\u3044\u3066\u3001\u60a9\u3093\u3067\u3044\u308b\u3046\u3061\u306b\u3081\u3093\u3069\u304f\u3055\u304f\u2026\n\nDB\u5468\u308a\u306e\u5b9f\u88c5\u306b\u3064\u3044\u3066\u306f\u3001PDO\u3092\u5229\u7528\u3059\u308b\u65b9\u6cd5\u4e00\u629e\u304b\u3068\u601d\u3044\u307e\u3059\u3002\n\u3053\u306e\u8fba\u308a\u306e\u6a5f\u80fd\u306f\u4e00\u5ea6\u4f5c\u3063\u3066\u3057\u307e\u3048\u3070\u3001\u518d\u5229\u7528\u3057\u3084\u3059\u3044\u3057\u3001\u4f7f\u3044\u6163\u308c\u308b\u3068\u3001\u958b\u767a\u901f\u5ea6\u3082\u901f\u304f\u306a\u308a\u307e\u3059\u3002\u307e\u305f\u3001SQL\u30a4\u30f3\u30b8\u30a7\u30af\u30b7\u30e7\u30f3\u306a\u3069\u306e\u8106\u5f31\u6027\u3092\u57cb\u3081\u8fbc\u307f\u306b\u304f\u304f\u306a\u308a\u307e\u3059\u306e\u3067\u4e00\u77f3\u4e8c\u9ce5\u3002\n\n\u57fa\u672c\u7684\u306bDB\u5468\u308a\u3067\u5fc5\u8981\u306a\u6a5f\u80fd\u306f\u4ee5\u4e0b\u306e\u3068\u304a\u308a\u3002\n\n* SELECT\n* INSERT\n* UPDATE\n* DELETE\n\n\u3053\u308c\u3089\u306eSQL\u304c\u624b\u3063\u53d6\u308a\u65e9\u304f\u5b9f\u884c\u3067\u304d\u308c\u3070\u3044\u3044\u308f\u3051\u3067\u3059\u3002\n\n\u30af\u30e9\u30b9\u4f5c\u6210\u306b\u3042\u305f\u3063\u3066\u306f\u3001\u8a2d\u8a08\u601d\u60f3\u306b\u3088\u3063\u3066\u3001\u5b9f\u88c5\u65b9\u6cd5\u306f\u69d8\u3005\u306a\u30d0\u30ea\u30a8\u30fc\u30b7\u30e7\u30f3\u304c\u3042\u308b\u3053\u3068\u306b\u306a\u308a\u307e\u3059\u304c\u3001\u4ee5\u4e0b\u306e\u76ee\u7684\u3067\u4f5c\u6210\u3059\u308b\u3053\u3068\u3068\u3057\u307e\u3059\u3002\n\n* \u30e1\u30bd\u30c3\u30c9\u306e\u547c\u3073\u51fa\u3057\u65b9\u6cd5\u304c\u7c21\u5358\u3067\u3042\u308b\u3053\u3068\n* \u63a5\u7d9a\uff08\u30b3\u30cd\u30af\u30b7\u30e7\u30f3\u3092\u4f7f\u3044\u56de\u3059\u3053\u3068\uff09\n* SQL\u306e\u30a8\u30e9\u30fc\u304c\u9069\u5207\u306b\u901a\u77e5\u3055\u308c\u308b\u3053\u3068\n\n\u3053\u308c\u3089\u3092\u76ee\u7684\u3068\u3057\u3066\u5b9f\u88c5\u3057\u307e\u3059\u3002\n\n\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u30b9\u30b1\u30eb\u30c8\u30f3\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\n```php:Db.class.php\n<?php\n\nnamespace MyApp\\common;\n\nclass Db\n{\n\n\t/**\n\t * SELECT\u5b9f\u884c\n\t * @param string $sql\n\t * @param array $arr\n\t * @return array\n\t */\n\tpublic static function select($sql, array $arr = array())\n\t{\n\t}\n\n\t/**\n\t * INSERT\u5b9f\u884c\n\t * @param string $sql\n\t * @param array $arr\n\t * @return int\n\t */\n\tpublic static function insert($sql, array $arr)\n\t{\n\t}\n\n\t/**\n\t * UPDATE\u5b9f\u884c\n\t * @param string $sql\n\t * @param array $arr\n\t * @return bool\n\t */\n\tpublic static function update($sql, array $arr)\n\t{\n\t}\n\n\t/**\n\t * DELETE\u5b9f\u884c\n\t * @param string $sql\n\t * @param array $arr\n\t * @return bool\n\t */\n\tpublic static function delete($sql, array $arr)\n\t{\n\t}\n\t\n}\n```\n\n`static` \u3067\u30e1\u30bd\u30c3\u30c9\u3092\u8a2d\u5b9a\u3057\u3066\u304a\u304f\u3068\u3001\u547c\u3073\u51fa\u3057\u5143\u304b\u3089\u306f\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u547c\u3073\u51fa\u3057\u3067\u304d\u307e\u3059\u3002\n\n```php\n<?php\n\nuse MyApp\\common\\Db;\n\n$sql = 'SELECT id FROM Users';\n$res = Db::select($sql);\n\n$sql = 'INSERT INTO Users (id, name) VALUES (null, :name)';\n$arr = array(\n\t':name' => 'Sato'\n);\nDb::insert($sql, $arr);\n```\n\n\u697d\u30c1\u30f3\uff01\n\n\u4eca\u56de\u306e\u30e1\u30a4\u30f3\u306f\u3001\u300c\u30b3\u30cd\u30af\u30b7\u30e7\u30f3\u3092\u3044\u304b\u306b\u3057\u3066\u4f7f\u3044\u307e\u308f\u3059\u304b\u300d\u3068\u3044\u3046\u3053\u3068\u3067\u3059\u304c\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u5b9f\u88c5\u3057\u307e\u3059\u3002\n\u5927\u4e8b\u306a\u306e\u306f\u3001`getInstance()` \u306e\u5b9f\u88c5\u3067\u3059\u3002`$instance` \u304c `null` \u306e\u3068\u304d\u3001`PDO` \u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u751f\u6210\u3057\u3001\u305d\u308c\u3092\u8fd4\u3059\u3002`null` \u3067\u306a\u3044\u3068\u304d\u306f\u3001\u751f\u6210\u6e08\u307f\u306e `PDO` \u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u8fd4\u3059\u4ed5\u7d44\u307f\u306b\u306a\u3063\u3066\u3044\u307e\u3059\u3002\n\n\u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3\u51e6\u7406\u306b\u95a2\u9023\u3059\u308b\u3001`transaction()`, `commit()`, `rollback()` \u3092\u5b9f\u88c5\u3057\u3066\u3044\u307e\u3059\u3002\n\n```php:Db.class.php\n<?php\n\nclass Db\n{\n\n\t/**\n\t * \u63a5\u7d9a\u6587\u5b57\u5217\n\t */\n\tconst DSN = 'mysql:dbname=%s;host=localhost;charset=utf8;';\n\n\t/**\n\t * \u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u540d\n\t */\n\tconst DBNAME = 'sample';\n\n\t/**\n\t * \u30e6\u30fc\u30b6\u30fc\u540d\n\t */\n\tconst USER_NAME = 'root';\n\n\t/**\n\t * \u30d1\u30b9\u30ef\u30fc\u30c9\n\t */\n\tconst PASSWORD = 'password';\n\n\t/**\n\t * PDO\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\n\t * @var \\PDO\n\t */\n\tstatic private $instance = null;\n\n\t/**\n\t * \u30b3\u30f3\u30b9\u30c8\u30e9\u30af\u30bf\n\t * @access private\n\t */\n\tprivate function __construct()\n\t{\n\t\t// \u5916\u90e8\u304b\u3089\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u5316\u3067\u304d\u306a\u3044\u3088\u3046\u306b\u3001private \u3067\u5ba3\u8a00\n\t}\n\n\t/**\n\t * \u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u3092\u53d6\u5f97\n\t * @return \\PDO\n\t */\n\tprivate static function getInstance()\n\t{\n\t\tif (is_null(self::$instance)) {\n\t\t\t$options = array(\n\t\t\t\t\\PDO::ATTR_ERRMODE => \\PDO::ERRMODE_EXCEPTION\n\t\t\t\t, \\PDO::ATTR_DEFAULT_FETCH_MODE => \\PDO::FETCH_ASSOC\n\t\t\t\t, \\PDO::ATTR_AUTOCOMMIT => true\n\t\t\t);\n\t\t\tself::$instance = new \\PDO(\n\t\t\t\tsprintf(self::DSN, self::DBNAME)\n\t\t\t\t, self::USER_NAME\n\t\t\t\t, self::PASSWORD\n\t\t\t\t, $options\n\t\t\t);\n\t\t}\n\t\treturn self::$instance;\n\t}\n\n\t/**\n\t * \u30af\u30ed\u30fc\u30f3\n\t * @throws \\Exception\n\t */\n\tfinal public function __clone()\n\t{\n\t\t$msg = sprintf('Clone is not allowed against %s', get_class($this));\n\t\tthrow new \\Exception($msg);\n\t}\n\n\t/**\n\t * \u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3\u5b9f\u884c\n\t */\n\tpublic static function transaction()\n\t{\n\t\tself::getInstance()->beginTransaction();\n\t}\n\n\t/**\n\t * \u30b3\u30df\u30c3\u30c8\n\t */\n\tpublic static function commit()\n\t{\n\t\tself::getInstance()->commit();\n\t}\n\n\t/**\n\t * \u30ed\u30fc\u30eb\u30d0\u30c3\u30af\n\t */\n\tpublic static function rollback()\n\t{\n\t\tself::getInstance()->rollBack();\n\t}\n\n\t/**\n\t * SELECT\u5b9f\u884c\n\t * @param string $sql\n\t * @param array $arr\n\t * @return array\n\t */\n\tpublic static function select($sql, array $arr = array())\n\t{\n\t\t$stmt = self::getInstance()->prepare($sql);\n\t\t$stmt->execute($arr);\n\t\treturn $stmt->fetchAll();\n\t}\n\n\t/**\n\t * INSERT\u5b9f\u884c\n\t * @param string $sql\n\t * @param array $arr\n\t * @return int\n\t */\n\tpublic static function insert($sql, array $arr)\n\t{\n\t\tif (!self::getInstance()->inTransaction()) {\n\t\t\tthrow new \\Exception('Not in transaction!');\n\t\t}\n\t\t$stmt = self::getInstance()->prepare($sql);\n\t\t$stmt->execute($arr);\n\t\treturn self::getInstance()->lastInsertId();\n\t}\n\n\t/**\n\t * UPDATE\u5b9f\u884c\n\t * @param string $sql\n\t * @param array $arr\n\t * @return bool\n\t */\n\tpublic static function update($sql, array $arr)\n\t{\n\t\tif (!self::getInstance()->inTransaction()) {\n\t\t\tthrow new \\Exception('Not in transaction!');\n\t\t}\n\t\t$stmt = self::getInstance()->prepare($sql);\n\t\treturn $stmt->execute($arr);\n\t}\n\n\t/**\n\t * DELETE\u5b9f\u884c\n\t * @param string $sql\n\t * @param array $arr\n\t */\n\tpublic static function delete($sql, array $arr)\n\t{\n\t\tif (!self::getInstance()->inTransaction()) {\n\t\t\tthrow new \\Exception('Not in transaction!');\n\t\t}\n\t\t$stmt = self::getInstance()->prepare($sql);\n\t\treturn $stmt->execute($arr);\n\t}\n\n}\n```\n\n", "tags": ["\u30ed\u30b0\u30a4\u30f3", "PHP"]}