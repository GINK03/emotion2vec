{"context": " More than 1 year has passed since last update.ntp\u306emonlist\u6a5f\u80fd\u306e\u8106\u5f31\u6027\u3092\u4f7f\u3063\u305fDDoS\u653b\u6483\u304c\u591a\u767a\u3057\u3066\u3044\u308b\u3088\u3046\u3067\u3059\u304c\u3001monlist\u3063\u3066\u4f55\u3067\u3059\u304b\uff1f\u3063\u3066\u611f\u3058\u306a\u306e\u3067\u3001\u3061\u3087\u3063\u3068\u901a\u4fe1\u3092\u78ba\u8a8d\u3057\u3066\u307f\u307e\u3057\u305f\u3002\n\u3061\u306a\u307f\u306bCVE\u756a\u53f7\u306f CVE-2013-5211 \u3067\u3059\u3002\n\u624b\u6301\u3061\u306e\u74b0\u5883\u3067monlist\u306b\u7b54\u3048\u3066\u304f\u308c\u305fNTP\u30b5\u30fc\u30d0\u304c\u3042\u3063\u305f\u306e\u3067\u3001\u305d\u306e\u51fa\u529b\u3092\u8cbc\u308a\u307e\u3059\u306d\u3002\n$ ntpdc -nc monlist 10.123.1.253\nremote address          port local address      count m ver code avgint  lstint\n===============================================================================\n10.123.7.30            35585 10.123.1.253         675 7 2      0    756       0\n10.123.76.32             123 10.123.1.253         683 3 4      0   1024       0\n10.123.39.49             123 10.123.1.253         982 3 4      0   1008       0\n10.123.38.40             123 10.123.1.253         672 3 4      0   1024       3\n10.123.3.83              123 10.123.1.253        1269 3 4      0    108       5\n10.123.3.80              123 10.123.1.253        1148 3 4      0   1036      15\n10.123.1.174             123 10.123.1.253         664 3 4      0   1051      22\n10.123.12.30             123 10.123.1.253         672 3 4      0   1024      22\n10.123.12.32             123 10.123.1.253         673 3 4      0   1024      24\n10.123.19.100            123 10.123.1.253         672 3 4      0   1024      25\n~~\u7701\u7565~~\n10.123.19.126            123 10.123.1.253           2 3 3      0      2  429635\n10.123.1.233             123 10.123.1.253          94 3 4      0   1050  589670\n10.123.12.130            123 10.123.1.253          60 3 4      0    120  592082\n127.0.0.1              14702 127.0.0.1              5 6 2      0      0  686994\n$\n\n\n(\uff9f\u0434\uff9f)\uff01\uff01\nntpdc\u30b3\u30de\u30f3\u30c9\u3067monlist\u306e\u30af\u30a8\u30ea\u6295\u3052\u308b\u3068\u3001\u51fa\u308b\u308f\u51fa\u308b\u308f\u3067\u3001\u306a\u3093\u3068300\u884c\u8d85\u306e\u7d50\u679c\u304c\u8fd4\u3063\u3066\u304d\u307e\u3057\u305f\u3002\n\u6642\u523b\u540c\u671f\u306e\u554f\u3044\u5408\u308f\u305b\u3092\u3057\u305f\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u306eIP\u30a2\u30c9\u30ec\u30b9\u304c\u5168\u3066\u8fd4\u308b\u3088\u3046\u3067\u3059\u306d\u3002\ntcpdump\u3067\u30d1\u30b1\u30c3\u30c8\u3082\u8997\u3044\u3066\u307f\u307e\u3057\u305f\u3088\u3002\n$ tcpdump -nX -r /tmp/todaemon.cap | less\n09:28:02.148284 IP 10.123.7.30.44164 > 10.123.1.253.ntp: NTPv2, Reserved, length 192\n        0x0000:  4500 00dc 0929 4000 4011 11f6 0a7b 071e  E....)@.@.......\n        0x0010:  0a7b 01fd ac84 007b 00c8 1fcc 1700 032a  .......{.......*\n        0x0020:  0000 0000 0000 0000 0000 0000 0000 0000  ................\n        0x0030:  0000 0000 0000 0000 0000 0000 0000 0000  ................\n        0x0040:  0000 0000 0000 0000 0000 0000 0000 0000  ................\n        0x0050:  0000 0000 0000 0000 0000 0000 0000 0000  ................\n        0x0060:  0000 0000 0000 0000 0000 0000 0000 0000  ................\n        0x0070:  0000 0000 0000 0000 0000 0000 0000 0000  ................\n        0x0080:  0000 0000 0000 0000 0000 0000 0000 0000  ................\n        0x0090:  0000 0000 0000 0000 0000 0000 0000 0000  ................\n        0x00a0:  0000 0000 0000 0000 0000 0000 0000 0000  ................\n        0x00b0:  0000 0000 0000 0000 0000 0000 0000 0000  ................\n        0x00c0:  0000 0000 0000 0000 0000 0000 0000 0000  ................\n        0x00d0:  0000 0000 0000 0000 0000 0000            ............\n09:28:02.149852 IP 10.123.1.253.ntp > 10.123.7.30.44164: NTPv2, Reserved, length 440\n        0x0000:  4500 01d4 8648 0000 3f11 d4de 0a7b 01fd  E....H..?.......\n        0x0010:  0a7b 071e 007b ac84 01c0 5779 d700 032a  .....{....Wy...*\n        0x0020:  0006 0048 0000 0268 0000 0000 0000 0000  ...H...h........\n        0x0030:  0000 02a5 0a7b 071e 0a7b 01fd 0000 0001  ................\n        0x0040:  ac84 0702 0000 0000 0000 0000 0000 0000  ................\n        0x0050:  0000 0000 0000 0000 0000 0000 0000 0000  ................\n        0x0060:  0000 0000 0000 0000 0000 0000 0000 03eb  ................\n~~\u7701\u7565~~\n\n\u51fa\u529b\u304c\u591a\u304f\u3066\u7701\u7565\u3057\u3066\u307e\u3059\u304c\u304c\u3001\u554f\u3044\u5408\u308f\u305b\u306f\u308f\u305a\u304b192byte\u306a\u306e\u306b\u3001\u5fdc\u7b54\u306f440byte x 39\u56de = 17160byte \u3082\u8fd4\u3063\u3066\u304a\u308a\u307e\u3057\u305f\u3002\n\u3053\u308a\u3083\u3001\u5897\u5e45\u52b9\u679c\u304c\u9ad8\u3044\u901a\u4fe1\u3067\u3059\u306d\u3002\nUDP\u306a\u306e\u3067\u9001\u4fe1\u5143\u3092\u8a50\u79f0\u3057\u3084\u3059\u3044\u3068\u3044\u3046\u8a71\u3082\u3042\u3063\u3066\u3001\u305d\u3053\u306f\u3069\u3046\u3059\u308c\u3070\u3044\u3044\u306e\u304b\u3088\u304f\u308f\u304b\u308a\u307e\u305b\u3093\u304c\u3001\u507d\u88c5\u3055\u308c\u305f\u9001\u4fe1\u5143\u30a2\u30c9\u30ec\u30b9\u306b\u3001\u5927\u91cf\u306eUDP\u30d1\u30b1\u30c3\u30c8\u3092\u9001\u308a\u3064\u3051\u308b\u306b\u306f\u90fd\u5408\u306e\u3044\u3044\u6a5f\u80fd\u3063\u3066\u306e\u304c\u3088\u304f\u308f\u304b\u308a\u307e\u3059\u306d\u3002\n\u3067\u306f\u3067\u306f\u3002\nntp\u306emonlist\u6a5f\u80fd\u306e\u8106\u5f31\u6027\u3092\u4f7f\u3063\u305fDDoS\u653b\u6483\u304c\u591a\u767a\u3057\u3066\u3044\u308b\u3088\u3046\u3067\u3059\u304c\u3001monlist\u3063\u3066\u4f55\u3067\u3059\u304b\uff1f\u3063\u3066\u611f\u3058\u306a\u306e\u3067\u3001\u3061\u3087\u3063\u3068\u901a\u4fe1\u3092\u78ba\u8a8d\u3057\u3066\u307f\u307e\u3057\u305f\u3002\n\n\u3061\u306a\u307f\u306bCVE\u756a\u53f7\u306f [CVE-2013-5211](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2013-5211) \u3067\u3059\u3002\n\n\u624b\u6301\u3061\u306e\u74b0\u5883\u3067monlist\u306b\u7b54\u3048\u3066\u304f\u308c\u305fNTP\u30b5\u30fc\u30d0\u304c\u3042\u3063\u305f\u306e\u3067\u3001\u305d\u306e\u51fa\u529b\u3092\u8cbc\u308a\u307e\u3059\u306d\u3002\n\n```bash\n$ ntpdc -nc monlist 10.123.1.253\nremote address          port local address      count m ver code avgint  lstint\n===============================================================================\n10.123.7.30            35585 10.123.1.253         675 7 2      0    756       0\n10.123.76.32             123 10.123.1.253         683 3 4      0   1024       0\n10.123.39.49             123 10.123.1.253         982 3 4      0   1008       0\n10.123.38.40             123 10.123.1.253         672 3 4      0   1024       3\n10.123.3.83              123 10.123.1.253        1269 3 4      0    108       5\n10.123.3.80              123 10.123.1.253        1148 3 4      0   1036      15\n10.123.1.174             123 10.123.1.253         664 3 4      0   1051      22\n10.123.12.30             123 10.123.1.253         672 3 4      0   1024      22\n10.123.12.32             123 10.123.1.253         673 3 4      0   1024      24\n10.123.19.100            123 10.123.1.253         672 3 4      0   1024      25\n~~\u7701\u7565~~\n10.123.19.126            123 10.123.1.253           2 3 3      0      2  429635\n10.123.1.233             123 10.123.1.253          94 3 4      0   1050  589670\n10.123.12.130            123 10.123.1.253          60 3 4      0    120  592082\n127.0.0.1              14702 127.0.0.1              5 6 2      0      0  686994\n$\n```\n\n###(\uff9f\u0434\uff9f)\uff01\uff01\nntpdc\u30b3\u30de\u30f3\u30c9\u3067monlist\u306e\u30af\u30a8\u30ea\u6295\u3052\u308b\u3068\u3001\u51fa\u308b\u308f\u51fa\u308b\u308f\u3067\u3001\u306a\u3093\u3068300\u884c\u8d85\u306e\u7d50\u679c\u304c\u8fd4\u3063\u3066\u304d\u307e\u3057\u305f\u3002\n\u6642\u523b\u540c\u671f\u306e\u554f\u3044\u5408\u308f\u305b\u3092\u3057\u305f\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u306eIP\u30a2\u30c9\u30ec\u30b9\u304c\u5168\u3066\u8fd4\u308b\u3088\u3046\u3067\u3059\u306d\u3002\n\ntcpdump\u3067\u30d1\u30b1\u30c3\u30c8\u3082\u8997\u3044\u3066\u307f\u307e\u3057\u305f\u3088\u3002\n\n```bash\n$ tcpdump -nX -r /tmp/todaemon.cap | less\n09:28:02.148284 IP 10.123.7.30.44164 > 10.123.1.253.ntp: NTPv2, Reserved, length 192\n        0x0000:  4500 00dc 0929 4000 4011 11f6 0a7b 071e  E....)@.@.......\n        0x0010:  0a7b 01fd ac84 007b 00c8 1fcc 1700 032a  .......{.......*\n        0x0020:  0000 0000 0000 0000 0000 0000 0000 0000  ................\n        0x0030:  0000 0000 0000 0000 0000 0000 0000 0000  ................\n        0x0040:  0000 0000 0000 0000 0000 0000 0000 0000  ................\n        0x0050:  0000 0000 0000 0000 0000 0000 0000 0000  ................\n        0x0060:  0000 0000 0000 0000 0000 0000 0000 0000  ................\n        0x0070:  0000 0000 0000 0000 0000 0000 0000 0000  ................\n        0x0080:  0000 0000 0000 0000 0000 0000 0000 0000  ................\n        0x0090:  0000 0000 0000 0000 0000 0000 0000 0000  ................\n        0x00a0:  0000 0000 0000 0000 0000 0000 0000 0000  ................\n        0x00b0:  0000 0000 0000 0000 0000 0000 0000 0000  ................\n        0x00c0:  0000 0000 0000 0000 0000 0000 0000 0000  ................\n        0x00d0:  0000 0000 0000 0000 0000 0000            ............\n09:28:02.149852 IP 10.123.1.253.ntp > 10.123.7.30.44164: NTPv2, Reserved, length 440\n        0x0000:  4500 01d4 8648 0000 3f11 d4de 0a7b 01fd  E....H..?.......\n        0x0010:  0a7b 071e 007b ac84 01c0 5779 d700 032a  .....{....Wy...*\n        0x0020:  0006 0048 0000 0268 0000 0000 0000 0000  ...H...h........\n        0x0030:  0000 02a5 0a7b 071e 0a7b 01fd 0000 0001  ................\n        0x0040:  ac84 0702 0000 0000 0000 0000 0000 0000  ................\n        0x0050:  0000 0000 0000 0000 0000 0000 0000 0000  ................\n        0x0060:  0000 0000 0000 0000 0000 0000 0000 03eb  ................\n~~\u7701\u7565~~\n```\n\n\u51fa\u529b\u304c\u591a\u304f\u3066\u7701\u7565\u3057\u3066\u307e\u3059\u304c\u304c\u3001\u554f\u3044\u5408\u308f\u305b\u306f\u308f\u305a\u304b192byte\u306a\u306e\u306b\u3001\u5fdc\u7b54\u306f440byte x 39\u56de = 17160byte \u3082\u8fd4\u3063\u3066\u304a\u308a\u307e\u3057\u305f\u3002\n\u3053\u308a\u3083\u3001\u5897\u5e45\u52b9\u679c\u304c\u9ad8\u3044\u901a\u4fe1\u3067\u3059\u306d\u3002\n\nUDP\u306a\u306e\u3067\u9001\u4fe1\u5143\u3092\u8a50\u79f0\u3057\u3084\u3059\u3044\u3068\u3044\u3046\u8a71\u3082\u3042\u3063\u3066\u3001\u305d\u3053\u306f\u3069\u3046\u3059\u308c\u3070\u3044\u3044\u306e\u304b\u3088\u304f\u308f\u304b\u308a\u307e\u305b\u3093\u304c\u3001\u507d\u88c5\u3055\u308c\u305f\u9001\u4fe1\u5143\u30a2\u30c9\u30ec\u30b9\u306b\u3001\u5927\u91cf\u306eUDP\u30d1\u30b1\u30c3\u30c8\u3092\u9001\u308a\u3064\u3051\u308b\u306b\u306f\u90fd\u5408\u306e\u3044\u3044\u6a5f\u80fd\u3063\u3066\u306e\u304c\u3088\u304f\u308f\u304b\u308a\u307e\u3059\u306d\u3002\n\n\u3067\u306f\u3067\u306f\u3002", "tags": ["ntp", "Linux"]}