{"context": " More than 1 year has passed since last update.JavaMail\u306e\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\nJavaMail\u306fJAF(JavaBeans Activation Framework)\u306b\u4f9d\u5b58\u3057\u3066\u3044\u308b\u306e\u3067\njavamail1_4_7.zip\u3068jaf-1_1_1.zip\u3092\u4ee5\u4e0b\u306e\u30a2\u30c9\u30ec\u30b9\u304b\u3089\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\nhttp://www.oracle.com/technetwork/java/javamail/javamail-138606.html\n2\u3064\u3068\u3082\u3053\u306e\u30da\u30fc\u30b8\u304b\u3089\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3067\u304d\u308b\nzip\u30d5\u30a1\u30a4\u30eb\u3092\u89e3\u51cd\u3057\u3066\u5f97\u3089\u308c\u308bmail.jar\u3068activation.jar\u3092WebContent\\WEB-INF\\lib\u306b\u30b3\u30d4\u30fc\n\u4ee5\u4e0b\u7701\u7565...\n\nSendMail.java\npackage com.sample.simpleinquiry;\n\nimport java.io.IOException;\nimport java.io.PrintWriter;\nimport java.util.Properties;\n\nimport javax.mail.Message;\nimport javax.mail.PasswordAuthentication;\nimport javax.mail.Session;\nimport javax.mail.Transport;\nimport javax.mail.internet.InternetAddress;\nimport javax.mail.internet.MimeMessage;\nimport javax.servlet.ServletException;\nimport javax.servlet.annotation.WebServlet;\nimport javax.servlet.http.HttpServlet;\nimport javax.servlet.http.HttpServletRequest;\nimport javax.servlet.http.HttpServletResponse;\n\n/**\n * Servlet implementation class SendInquiry\n */\n@WebServlet(\"/SendMail\")\npublic class SendMail extends HttpServlet {\n    private static final long serialVersionUID = 1L;\n\n    /**\n     * @see HttpServlet#HttpServlet()\n     */\n    public SendInquiry() {\n        super();\n        // TODO Auto-generated constructor stub\n    }\n\n    /**\n     * @see HttpServlet#doGet(HttpServletRequest request, HttpServletResponse response)\n     */\n    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {\n        // TODO Auto-generated method stub\n    }\n\n    /**\n     * @see HttpServlet#doPost(HttpServletRequest request, HttpServletResponse response)\n     */\n    protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {\n        // TODO Auto-generated method stub\n\n        request.setCharacterEncoding(\"UTF-8\");\n\n        String title = request.getParameter(\"title\");\n        String message = request.getParameter(\"message\");\n\n        //System.out.println(\"\u30bf\u30a4\u30c8\u30eb\uff1a\" + title);\n        //System.out.println(\"\u30e1\u30c3\u30bb\u30fc\u30b8\" + message);\n\n        response.setContentType(\"text/html; charset=UTF-8\");\n\n        PrintWriter out = response.getWriter();\n\n        try{\n            Properties property = new Properties();\n\n            property.put(\"mail.smtp.host\",\"smtp.gmail.com\");\n\n            //Gmail\u306eSMTP\u3092\u4f7f\u3046\u5834\u5408\n            property.put(\"mail.smtp.auth\", \"true\");\n            property.put(\"mail.smtp.starttls.enable\", \"true\");\n            property.put(\"mail.smtp.host\", \"smtp.gmail.com\");\n            property.put(\"mail.smtp.port\", \"587\");\n            property.put(\"mail.smtp.debug\", \"true\");\n\n            Session session = Session.getInstance(property, new javax.mail.Authenticator(){\n                protected PasswordAuthentication getPasswordAuthentication(){\n                    return new PasswordAuthentication(\"Gmail\u306e\u30e6\u30fc\u30b6\u540d\", \"Gmail\u306e\u30d1\u30b9\u30ef\u30fc\u30c9\");\n                }\n            });\n\n            /*\n            //\u4e00\u822c\u7684\u306aSMTP\u3092\u4f7f\u3046\u5834\u5408\n\n            //\u30dd\u30fc\u30c8\u304c25\u306e\u5834\u5408\u306f\u7701\u7565\u53ef\u80fd\n            property.put(\"mail.smtp.port\", 25);\n\n            Session session = \n                    Session.getDefaultInstance(property, null);\n            */\n\n            MimeMessage mimeMessage = new MimeMessage(session);\n\n            InternetAddress toAddress = \n                    new InternetAddress(\"\u53d7\u4fe1\u8005\u306e\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\", \"\u53d7\u4fe1\u8005\u306e\u540d\u524d\");\n\n            mimeMessage.setRecipient(Message.RecipientType.TO, toAddress);\n\n            InternetAddress fromAddress = \n                    new InternetAddress(\"\u9001\u4fe1\u8005\u306e\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\",\"\u9001\u4fe1\u8005\u306e\u540d\u524d\");\n\n            mimeMessage.setFrom(fromAddress);\n\n            mimeMessage.setSubject(title, \"ISO-2022-JP\");\n\n            mimeMessage.setText(message, \"ISO-2022-JP\");\n\n            Transport.send(mimeMessage);\n\n            out.println(\"<htm><body>\");\n            out.println(\"\u25a0\u304a\u554f\u3044\u5408\u308f\u305b\u5185\u5bb9\u3092\u62c5\u5f53\u8005\u3078\u9001\u4fe1\u3057\u307e\u3057\u305f\u3002\");\n            out.println(\"<body></html>\");\n        }\n        catch(Exception e){\n            out.println(\"<html><body>\");\n            out.println(\"\u25a0\u62c5\u5f53\u8005\u3078\u306e\u9001\u4fe1\u306b\u5931\u6557\u3057\u307e\u3057\u305f\");\n            out.println(\"<br>\u30a8\u30e9\u30fc\u306e\u5185\u5bb9\" + e);\n            out.println(\"</body></html>\");\n        }\n\n        out.close();\n    }\n\n}\n\n\nJavaMail\u306e\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\n\nJavaMail\u306fJAF(JavaBeans Activation Framework)\u306b\u4f9d\u5b58\u3057\u3066\u3044\u308b\u306e\u3067\njavamail1_4_7.zip\u3068jaf-1_1_1.zip\u3092\u4ee5\u4e0b\u306e\u30a2\u30c9\u30ec\u30b9\u304b\u3089\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\n\nhttp://www.oracle.com/technetwork/java/javamail/javamail-138606.html\n\n2\u3064\u3068\u3082\u3053\u306e\u30da\u30fc\u30b8\u304b\u3089\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3067\u304d\u308b\n\nzip\u30d5\u30a1\u30a4\u30eb\u3092\u89e3\u51cd\u3057\u3066\u5f97\u3089\u308c\u308bmail.jar\u3068activation.jar\u3092WebContent\\WEB-INF\\lib\u306b\u30b3\u30d4\u30fc\n\n\u4ee5\u4e0b\u7701\u7565...\n\n```java:SendMail.java\npackage com.sample.simpleinquiry;\n\nimport java.io.IOException;\nimport java.io.PrintWriter;\nimport java.util.Properties;\n\nimport javax.mail.Message;\nimport javax.mail.PasswordAuthentication;\nimport javax.mail.Session;\nimport javax.mail.Transport;\nimport javax.mail.internet.InternetAddress;\nimport javax.mail.internet.MimeMessage;\nimport javax.servlet.ServletException;\nimport javax.servlet.annotation.WebServlet;\nimport javax.servlet.http.HttpServlet;\nimport javax.servlet.http.HttpServletRequest;\nimport javax.servlet.http.HttpServletResponse;\n\n/**\n * Servlet implementation class SendInquiry\n */\n@WebServlet(\"/SendMail\")\npublic class SendMail extends HttpServlet {\n\tprivate static final long serialVersionUID = 1L;\n       \n    /**\n     * @see HttpServlet#HttpServlet()\n     */\n    public SendInquiry() {\n        super();\n        // TODO Auto-generated constructor stub\n    }\n\n\t/**\n\t * @see HttpServlet#doGet(HttpServletRequest request, HttpServletResponse response)\n\t */\n\tprotected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {\n\t\t// TODO Auto-generated method stub\n\t}\n\n\t/**\n\t * @see HttpServlet#doPost(HttpServletRequest request, HttpServletResponse response)\n\t */\n\tprotected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {\n\t\t// TODO Auto-generated method stub\n\t\t\n\t\trequest.setCharacterEncoding(\"UTF-8\");\n\t\t\n\t\tString title = request.getParameter(\"title\");\n\t\tString message = request.getParameter(\"message\");\n\t\t\n\t\t//System.out.println(\"\u30bf\u30a4\u30c8\u30eb\uff1a\" + title);\n\t\t//System.out.println(\"\u30e1\u30c3\u30bb\u30fc\u30b8\" + message);\n\t\t\n\t\tresponse.setContentType(\"text/html; charset=UTF-8\");\n\t\t\n\t\tPrintWriter out = response.getWriter();\n\t\t\n\t\ttry{\n\t\t\tProperties property = new Properties();\n\t\t\t\n\t\t\tproperty.put(\"mail.smtp.host\",\"smtp.gmail.com\");\n\t\t\t\n\t\t\t//Gmail\u306eSMTP\u3092\u4f7f\u3046\u5834\u5408\n\t\t\tproperty.put(\"mail.smtp.auth\", \"true\");\n\t\t\tproperty.put(\"mail.smtp.starttls.enable\", \"true\");\n\t\t\tproperty.put(\"mail.smtp.host\", \"smtp.gmail.com\");\n\t\t\tproperty.put(\"mail.smtp.port\", \"587\");\n\t\t\tproperty.put(\"mail.smtp.debug\", \"true\");\n\t\t\t\n\t        Session session = Session.getInstance(property, new javax.mail.Authenticator(){\n\t            protected PasswordAuthentication getPasswordAuthentication(){\n\t                return new PasswordAuthentication(\"Gmail\u306e\u30e6\u30fc\u30b6\u540d\", \"Gmail\u306e\u30d1\u30b9\u30ef\u30fc\u30c9\");\n\t            }\n\t        });\n\t        \n\t        /*\n\t        //\u4e00\u822c\u7684\u306aSMTP\u3092\u4f7f\u3046\u5834\u5408\n\t        \n\t\t\t//\u30dd\u30fc\u30c8\u304c25\u306e\u5834\u5408\u306f\u7701\u7565\u53ef\u80fd\n\t\t\tproperty.put(\"mail.smtp.port\", 25);\n\t\t\t\n\t\t\tSession session = \n\t\t\t\t\tSession.getDefaultInstance(property, null);\n\t\t\t*/\n\t\t\t\n\t\t\tMimeMessage mimeMessage = new MimeMessage(session);\n\t\t\t\n\t\t\tInternetAddress toAddress = \n\t\t\t\t\tnew InternetAddress(\"\u53d7\u4fe1\u8005\u306e\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\", \"\u53d7\u4fe1\u8005\u306e\u540d\u524d\");\n\t\t\t\n\t\t\tmimeMessage.setRecipient(Message.RecipientType.TO, toAddress);\n\t\t\t\n\t\t\tInternetAddress fromAddress = \n\t\t\t\t\tnew InternetAddress(\"\u9001\u4fe1\u8005\u306e\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\",\"\u9001\u4fe1\u8005\u306e\u540d\u524d\");\n\t\t\t\n\t\t\tmimeMessage.setFrom(fromAddress);\n\t\t\t\n\t\t\tmimeMessage.setSubject(title, \"ISO-2022-JP\");\n\t\t\t\n\t\t\tmimeMessage.setText(message, \"ISO-2022-JP\");\n\t\t\t\n\t\t\tTransport.send(mimeMessage);\n\t\t\t\n\t\t\tout.println(\"<htm><body>\");\n\t\t\tout.println(\"\u25a0\u304a\u554f\u3044\u5408\u308f\u305b\u5185\u5bb9\u3092\u62c5\u5f53\u8005\u3078\u9001\u4fe1\u3057\u307e\u3057\u305f\u3002\");\n\t\t\tout.println(\"<body></html>\");\n\t\t}\n\t\tcatch(Exception e){\n\t\t\tout.println(\"<html><body>\");\n\t\t\tout.println(\"\u25a0\u62c5\u5f53\u8005\u3078\u306e\u9001\u4fe1\u306b\u5931\u6557\u3057\u307e\u3057\u305f\");\n\t\t\tout.println(\"<br>\u30a8\u30e9\u30fc\u306e\u5185\u5bb9\" + e);\n\t\t\tout.println(\"</body></html>\");\n\t\t}\n\t\t\n\t\tout.close();\n\t}\n\n}\n```\n\n", "tags": ["Java", "JavaEE"]}