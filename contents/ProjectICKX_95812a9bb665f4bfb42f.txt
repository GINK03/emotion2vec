{"context": " More than 1 year has passed since last update.\u6d41\u884c\u308a\u30e9\u30a4\u30c9\nPHP\u3067\u52d5\u7684n\u6b21\u5143\u914d\u5217\u8ffd\u52a0\u3092\u3057\u305f\u3044\u3067\u3059\u3002 \u4f8b\u3048\u2026 - Qiita\u3092\u3082\u3046\u3061\u3087\u3063\u3068\u771f\u9762\u76ee\u306b\u5bfe\u5fdc\u3057\u305f\u3082\u306e\n\n\u4ed5\u69d8\n\n\u6700\u4e0b\u5c64\u4ee5\u5916\u306f\u5168\u3066\u30ad\u30fc\u3068\u307f\u306a\u3059\n\"(\"\u306e\u524d\u306b\u4efb\u610f\u306e\u6587\u5b57\u304c\u7121\u3044\u5834\u5408\u306f\u3001\u914d\u5217\u306e\u8ffd\u52a0\u3068\u307f\u306a\u3059\n\n\n\u5b9f\u88c5\n\necho str_repeat('=', 36), PHP_EOL;\necho \"\u304a\u984c\uff1aa((b((c))d((e)))) => ['a' => [['b'=>[['c']], 'd' => [['e']]]]]\", PHP_EOL;\necho str_repeat('=', 36), PHP_EOL;\necho \"['a' => [['b'=>[['c']], 'd' => [['e']]]]]\u3092\u5b9f\u969b\u5c55\u958b\u3059\u308b\u3068\u3053\u3046\u306a\u308b\u3002\", PHP_EOL;\nvar_dump(['a' => [['b'=>[['c']], 'd' => [['e']]]]]);\necho PHP_EOL;\n\n$target = 'a((b((c))d((e))))';\n\n//\u6bd4\u8f03\u7684\u771f\u9762\u76eeparser\n$stacker = parser($target);\n\n//\u4e00\u62ecDONE\n$result = [];\nforeach ($stacker as $stack) {\n    $value = array_pop($stack);\n    $result = set_lowest($result, $stack, $value);\n}\n\necho PHP_EOL;\necho \"\u30a6\u30c1\u306e\u5b9f\u884c\u7d50\u679c\u3002\", PHP_EOL;\nvar_dump($result);\necho PHP_EOL;\n\necho str_repeat('=', 36), PHP_EOL;\necho \"\u62e1\u5f35\u304a\u984c\uff1aa((((c))((e)))) => ['a' => [[[['c']], [['e']]]]]\", PHP_EOL;\necho str_repeat('=', 36), PHP_EOL;\necho \"['a' => [[[['c']], [['e']]]]]\u3092\u5b9f\u969b\u5c55\u958b\u3059\u308b\u3068\u3053\u3046\u306a\u308b\u3002\", PHP_EOL;\nvar_dump(['a' => [[[['c']], [['e']]]]]);\necho PHP_EOL;\n\n$target = 'a((((c))((e))))';\n\n//\u6bd4\u8f03\u7684\u771f\u9762\u76eeparser\n$stacker = parser($target);\n\n//\u4e00\u62ecDONE\n$result = [];\nforeach ($stacker as $stack) {\n    $value = array_pop($stack);\n    $result = set_lowest($result, $stack, $value);\n}\n\necho PHP_EOL;\necho \"\u30a6\u30c1\u306e\u5b9f\u884c\u7d50\u679c\u3002\", PHP_EOL;\nvar_dump($result);\necho PHP_EOL;\n\n/**\n * \u6307\u5b9a\u3055\u308c\u305f\u6587\u5b57\u5217\u3092\u89e3\u6790\u3057\u3001\u30c1\u30e3\u30f3\u30af\u3068\u3057\u3066\u8fd4\u3057\u307e\u3059\u3002\n *\n * @param   string  $target \u89e3\u6790\u5bfe\u8c61\u306e\u6587\u5b57\u5217\n * @return  array   \u89e3\u6790\u6e08\u307f\u306e\u30c1\u30e3\u30f3\u30af \u968e\u5c64\u30c4\u30ea\u30fc\u3054\u3068\u306b1\u914d\u5217\u3092\u6301\u3064\u914d\u5217\n */\nfunction parser ($target) {\n    $key_buffer = [];\n    $value_buffer = [];\n    $stacker = [];\n\n    for ($i = 0, $max = mb_strlen($target, ENCODING);$i < $max;$i++) {\n        $char = mb_substr($target, $i, 1, ENCODING);\n        switch ($char) {\n            case '(' :\n                $key_buffer[] = empty($value_buffer) ? count(get_lowest($stacker, array_keys($key_buffer))) : implode('', $value_buffer);\n                $value_buffer = [];\n                break;\n            case ')':\n                if (!empty($value_buffer)) {\n                    $key_buffer[] = 0;\n                    $key_buffer[] = implode('', $value_buffer);\n                    $stacker[] = $key_buffer;\n                }\n                array_pop($key_buffer);\n                array_pop($key_buffer);\n                $value_buffer = [];\n                break;\n            default:\n                $value_buffer[] = $char;\n                break;\n        }\n    }\n\n    return $stacker;\n}\n\n/**\n * \u6307\u5b9a\u3055\u308c\u305f\u968e\u5c64\u306b\u3042\u308b\u5024\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n *\n * @param   array   $array  \u914d\u5217\n * @param   mixed   $keys   \u968e\u5c64\n * @return  array   \u8a2d\u5b9a\u5f8c\u306e\u914d\u5217\n */\nfunction set_lowest ($array, $keys, $value) {\n    $keys = (array) $keys;\n    if (empty($array)) {\n        $tmp =& $array;\n    } else {\n        $tmp =& $array[array_shift($keys)];\n    }\n\n    foreach ($keys as $key) {\n        if (!isset($tmp[$key])) {\n            $tmp[$key] = null;\n        }\n        $tmp =& $tmp[$key];\n    }\n    $tmp = $value;\n    return $array;\n}\n\n/**\n * \u6307\u5b9a\u3055\u308c\u305f\u968e\u5c64\u306b\u3042\u308b\u5024\u3092\u53d6\u5f97\u3057\u307e\u3059\u3002\n *\n * @param   array   $array  \u914d\u5217\n * @param   mixed   $keys   \u968e\u5c64\n * @return  mixed   \u6307\u5b9a\u3055\u308c\u305f\u6539\u9020\u306b\u3042\u308b\u5024\n */\nfunction get_lowest ($array, $keys) {\n    foreach ((array) $keys as $key) {\n        if (isset($array[$key])) {\n            $array = $array[$key];\n        } else {\n            return null;\n        }\n    }\n    return $array;\n}\n\n\n\u5b9f\u884c\u7d50\u679c\n====================================\n\u304a\u984c\uff1aa((b((c))d((e)))) => ['a' => [['b'=>[['c']], 'd' => [['e']]]]]\n====================================\n['a' => [['b'=>[['c']], 'd' => [['e']]]]]\u3092\u5b9f\u969b\u5c55\u958b\u3059\u308b\u3068\u3053\u3046\u306a\u308b\u3002\narray(1) {\n  [\"a\"]=>\n  array(1) {\n    [0]=>\n    array(2) {\n      [\"b\"]=>\n      array(1) {\n        [0]=>\n        array(1) {\n          [0]=>\n          string(1) \"c\"\n        }\n      }\n      [\"d\"]=>\n      array(1) {\n        [0]=>\n        array(1) {\n          [0]=>\n          string(1) \"e\"\n        }\n      }\n    }\n  }\n}\n\n\n\u30a6\u30c1\u306e\u5b9f\u884c\u7d50\u679c\u3002\narray(1) {\n  [\"a\"]=>\n  array(1) {\n    [0]=>\n    array(2) {\n      [\"b\"]=>\n      array(1) {\n        [0]=>\n        array(1) {\n          [0]=>\n          string(1) \"c\"\n        }\n      }\n      [\"d\"]=>\n      array(1) {\n        [0]=>\n        array(1) {\n          [0]=>\n          string(1) \"e\"\n        }\n      }\n    }\n  }\n}\n\n====================================\n\u62e1\u5f35\u304a\u984c\uff1aa((((c))((e)))) => ['a' => [[[['c']], [['e']]]]]\n====================================\n['a' => [[[['c']], [['e']]]]]\u3092\u5b9f\u969b\u5c55\u958b\u3059\u308b\u3068\u3053\u3046\u306a\u308b\u3002\narray(1) {\n  [\"a\"]=>\n  array(1) {\n    [0]=>\n    array(2) {\n      [0]=>\n      array(1) {\n        [0]=>\n        array(1) {\n          [0]=>\n          string(1) \"c\"\n        }\n      }\n      [1]=>\n      array(1) {\n        [0]=>\n        array(1) {\n          [0]=>\n          string(1) \"e\"\n        }\n      }\n    }\n  }\n}\n\n\n\u30a6\u30c1\u306e\u5b9f\u884c\u7d50\u679c\u3002\narray(1) {\n  [\"a\"]=>\n  array(1) {\n    [0]=>\n    array(2) {\n      [0]=>\n      array(1) {\n        [0]=>\n        array(1) {\n          [0]=>\n          string(1) \"c\"\n        }\n      }\n      [1]=>\n      array(1) {\n        [0]=>\n        array(1) {\n          [0]=>\n          string(1) \"e\"\n        }\n      }\n    }\n  }\n}\n\n\n\u6d41\u884c\u308a\u30e9\u30a4\u30c9\n[PHP\u3067\u52d5\u7684n\u6b21\u5143\u914d\u5217\u8ffd\u52a0\u3092\u3057\u305f\u3044\u3067\u3059\u3002 \u4f8b\u3048\u2026 - Qiita](http://qiita.com/ProjectICKX/items/07df12785fca9b8840d7)\u3092\u3082\u3046\u3061\u3087\u3063\u3068\u771f\u9762\u76ee\u306b\u5bfe\u5fdc\u3057\u305f\u3082\u306e\n\n# \u4ed5\u69d8\n\n- \u6700\u4e0b\u5c64\u4ee5\u5916\u306f\u5168\u3066\u30ad\u30fc\u3068\u307f\u306a\u3059\n- \"(\"\u306e\u524d\u306b\u4efb\u610f\u306e\u6587\u5b57\u304c\u7121\u3044\u5834\u5408\u306f\u3001\u914d\u5217\u306e\u8ffd\u52a0\u3068\u307f\u306a\u3059\n\n# \u5b9f\u88c5\n\n```php\n\necho str_repeat('=', 36), PHP_EOL;\necho \"\u304a\u984c\uff1aa((b((c))d((e)))) => ['a' => [['b'=>[['c']], 'd' => [['e']]]]]\", PHP_EOL;\necho str_repeat('=', 36), PHP_EOL;\necho \"['a' => [['b'=>[['c']], 'd' => [['e']]]]]\u3092\u5b9f\u969b\u5c55\u958b\u3059\u308b\u3068\u3053\u3046\u306a\u308b\u3002\", PHP_EOL;\nvar_dump(['a' => [['b'=>[['c']], 'd' => [['e']]]]]);\necho PHP_EOL;\n\n$target = 'a((b((c))d((e))))';\n\n//\u6bd4\u8f03\u7684\u771f\u9762\u76eeparser\n$stacker = parser($target);\n\n//\u4e00\u62ecDONE\n$result = [];\nforeach ($stacker as $stack) {\n\t$value = array_pop($stack);\n\t$result = set_lowest($result, $stack, $value);\n}\n\necho PHP_EOL;\necho \"\u30a6\u30c1\u306e\u5b9f\u884c\u7d50\u679c\u3002\", PHP_EOL;\nvar_dump($result);\necho PHP_EOL;\n\necho str_repeat('=', 36), PHP_EOL;\necho \"\u62e1\u5f35\u304a\u984c\uff1aa((((c))((e)))) => ['a' => [[[['c']], [['e']]]]]\", PHP_EOL;\necho str_repeat('=', 36), PHP_EOL;\necho \"['a' => [[[['c']], [['e']]]]]\u3092\u5b9f\u969b\u5c55\u958b\u3059\u308b\u3068\u3053\u3046\u306a\u308b\u3002\", PHP_EOL;\nvar_dump(['a' => [[[['c']], [['e']]]]]);\necho PHP_EOL;\n\n$target = 'a((((c))((e))))';\n\n//\u6bd4\u8f03\u7684\u771f\u9762\u76eeparser\n$stacker = parser($target);\n\n//\u4e00\u62ecDONE\n$result = [];\nforeach ($stacker as $stack) {\n\t$value = array_pop($stack);\n\t$result = set_lowest($result, $stack, $value);\n}\n\necho PHP_EOL;\necho \"\u30a6\u30c1\u306e\u5b9f\u884c\u7d50\u679c\u3002\", PHP_EOL;\nvar_dump($result);\necho PHP_EOL;\n\n/**\n * \u6307\u5b9a\u3055\u308c\u305f\u6587\u5b57\u5217\u3092\u89e3\u6790\u3057\u3001\u30c1\u30e3\u30f3\u30af\u3068\u3057\u3066\u8fd4\u3057\u307e\u3059\u3002\n *\n * @param\tstring\t$target\t\u89e3\u6790\u5bfe\u8c61\u306e\u6587\u5b57\u5217\n * @return\tarray\t\u89e3\u6790\u6e08\u307f\u306e\u30c1\u30e3\u30f3\u30af \u968e\u5c64\u30c4\u30ea\u30fc\u3054\u3068\u306b1\u914d\u5217\u3092\u6301\u3064\u914d\u5217\n */\nfunction parser ($target) {\n\t$key_buffer = [];\n\t$value_buffer = [];\n\t$stacker = [];\n\n\tfor ($i = 0, $max = mb_strlen($target, ENCODING);$i < $max;$i++) {\n\t\t$char = mb_substr($target, $i, 1, ENCODING);\n\t\tswitch ($char) {\n\t\t\tcase '(' :\n\t\t\t\t$key_buffer[] = empty($value_buffer) ? count(get_lowest($stacker, array_keys($key_buffer))) : implode('', $value_buffer);\n\t\t\t\t$value_buffer = [];\n\t\t\t\tbreak;\n\t\t\tcase ')':\n\t\t\t\tif (!empty($value_buffer)) {\n\t\t\t\t\t$key_buffer[] = 0;\n\t\t\t\t\t$key_buffer[] = implode('', $value_buffer);\n\t\t\t\t\t$stacker[] = $key_buffer;\n\t\t\t\t}\n\t\t\t\tarray_pop($key_buffer);\n\t\t\t\tarray_pop($key_buffer);\n\t\t\t\t$value_buffer = [];\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\t$value_buffer[] = $char;\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\treturn $stacker;\n}\n\n/**\n * \u6307\u5b9a\u3055\u308c\u305f\u968e\u5c64\u306b\u3042\u308b\u5024\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n *\n * @param\tarray\t$array\t\u914d\u5217\n * @param\tmixed\t$keys\t\u968e\u5c64\n * @return\tarray\t\u8a2d\u5b9a\u5f8c\u306e\u914d\u5217\n */\nfunction set_lowest ($array, $keys, $value) {\n\t$keys = (array) $keys;\n\tif (empty($array)) {\n\t\t$tmp =& $array;\n\t} else {\n\t\t$tmp =& $array[array_shift($keys)];\n\t}\n\n\tforeach ($keys as $key) {\n\t\tif (!isset($tmp[$key])) {\n\t\t\t$tmp[$key] = null;\n\t\t}\n\t\t$tmp =& $tmp[$key];\n\t}\n\t$tmp = $value;\n\treturn $array;\n}\n\n/**\n * \u6307\u5b9a\u3055\u308c\u305f\u968e\u5c64\u306b\u3042\u308b\u5024\u3092\u53d6\u5f97\u3057\u307e\u3059\u3002\n *\n * @param   array   $array  \u914d\u5217\n * @param   mixed   $keys   \u968e\u5c64\n * @return  mixed   \u6307\u5b9a\u3055\u308c\u305f\u6539\u9020\u306b\u3042\u308b\u5024\n */\nfunction get_lowest ($array, $keys) {\n\tforeach ((array) $keys as $key) {\n\t\tif (isset($array[$key])) {\n\t\t\t$array = $array[$key];\n\t\t} else {\n\t\t\treturn null;\n\t\t}\n\t}\n\treturn $array;\n}\n```\n\n# \u5b9f\u884c\u7d50\u679c\n\n```\n====================================\n\u304a\u984c\uff1aa((b((c))d((e)))) => ['a' => [['b'=>[['c']], 'd' => [['e']]]]]\n====================================\n['a' => [['b'=>[['c']], 'd' => [['e']]]]]\u3092\u5b9f\u969b\u5c55\u958b\u3059\u308b\u3068\u3053\u3046\u306a\u308b\u3002\narray(1) {\n  [\"a\"]=>\n  array(1) {\n    [0]=>\n    array(2) {\n      [\"b\"]=>\n      array(1) {\n        [0]=>\n        array(1) {\n          [0]=>\n          string(1) \"c\"\n        }\n      }\n      [\"d\"]=>\n      array(1) {\n        [0]=>\n        array(1) {\n          [0]=>\n          string(1) \"e\"\n        }\n      }\n    }\n  }\n}\n\n\n\u30a6\u30c1\u306e\u5b9f\u884c\u7d50\u679c\u3002\narray(1) {\n  [\"a\"]=>\n  array(1) {\n    [0]=>\n    array(2) {\n      [\"b\"]=>\n      array(1) {\n        [0]=>\n        array(1) {\n          [0]=>\n          string(1) \"c\"\n        }\n      }\n      [\"d\"]=>\n      array(1) {\n        [0]=>\n        array(1) {\n          [0]=>\n          string(1) \"e\"\n        }\n      }\n    }\n  }\n}\n\n====================================\n\u62e1\u5f35\u304a\u984c\uff1aa((((c))((e)))) => ['a' => [[[['c']], [['e']]]]]\n====================================\n['a' => [[[['c']], [['e']]]]]\u3092\u5b9f\u969b\u5c55\u958b\u3059\u308b\u3068\u3053\u3046\u306a\u308b\u3002\narray(1) {\n  [\"a\"]=>\n  array(1) {\n    [0]=>\n    array(2) {\n      [0]=>\n      array(1) {\n        [0]=>\n        array(1) {\n          [0]=>\n          string(1) \"c\"\n        }\n      }\n      [1]=>\n      array(1) {\n        [0]=>\n        array(1) {\n          [0]=>\n          string(1) \"e\"\n        }\n      }\n    }\n  }\n}\n\n\n\u30a6\u30c1\u306e\u5b9f\u884c\u7d50\u679c\u3002\narray(1) {\n  [\"a\"]=>\n  array(1) {\n    [0]=>\n    array(2) {\n      [0]=>\n      array(1) {\n        [0]=>\n        array(1) {\n          [0]=>\n          string(1) \"c\"\n        }\n      }\n      [1]=>\n      array(1) {\n        [0]=>\n        array(1) {\n          [0]=>\n          string(1) \"e\"\n        }\n      }\n    }\n  }\n}\n```\n", "tags": ["PHP", "\u914d\u5217"]}