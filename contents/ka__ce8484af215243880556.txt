{"context": " More than 1 year has passed since last update.https://github.com/Guti/Google-Cloud-Messaging--Titanium-/blob/6ac1270026f3cc266f37812b64ef40f2ab1b9055/example/PushNotification.js\n\u3053\u308c\u3092 CoffeeScript \u3067\u66f8\u304d\u76f4\u3057\u307e\u3057\u305f\uff0e\n\nPushNotification.coffee\nexports.pushNotification = ->\n  hostURL = 'http://YOUR_HOST_URL/register?'\n\n  gcm = require 'com.activate.gcm'\n  Ti.API.info \"module gcm is => #{gcm}\"\n\n  Ti.API.info 'Registering...'\n\n  gcm.registerC2dm\n    success: (e) ->\n      Ti.API.info \"JS registration success event: #{e.registrationId}\"\n      alert \"Yeah JS registration success event: #{e.registrationId}\"\n      alert \"Sender ID:#{gcm.getSenderId()}\"\n      alert \"Registration ID:#{gcm.getRegistrationId()}\"\n\n      appName = Ti.App.name\n      appVersion = Ti.App.version\n\n      deviceUUID = Ti.Platform.macaddress # Ti.Network.remoteDeviceUUID\n      deviceName = Ti.Platform.username\n      deviceModel = Ti.Platform.model\n      deviceSystemVersion = Ti.Platform.version\n      deviceToken = e.deviceToken\n      regId = e.registrationId\n\n      # deviceUUID = deviceUUID.replace /-/ig, ''\n      # deviceToken = deviceToken.replace /<>/ig, ''\n\n      host = hostURL\n      urlString = host\n      # urlString += \"&appname=#{appName}\"\n      # urlString += \"&appversion=#{appVersion}\"\n      # urlString += \"&deviceuid=#{deviceUUID}\"\n      # urlString += \"&devicetoken=#{deviceToken}\"\n      # urlString += \"&devicename=#{deviceName}\"\n      # urlString += \"&devicemodel=#{deviceModel}\"\n      # urlString += \"&deviceversion=#{deviceSystemVersion}\"\n      # urlString += \"regId=#{regId}\"\n\n      loader = Ti.Network.createHTTPClient()\n      loader.setTimeout 60000\n\n      loader.onload = (evt) ->\n        alert evt\n        return\n\n      loader.open 'GET', urlString, false\n      loader.send()\n\n      alert urlString\n      return\n\n    error: (e) ->\n      Ti.API.error \"Error during registration : #{e.error}\"\n      alert \"Error during registration : #{e.error}\"\n\n      if e.error is 'ACCOUNT_MISSING'\n        message = 'No Google account found; you will need to add on in order to activate notifications'\n\n      (Titanium.UI.createAlertDialog\n        title: 'Push Notification Setup'\n        message: message\n        buttonNames: ['OK']\n      ).show()\n      return\n\n    callback: (e) -> # called when a push notification is received\n      Ti.API.info \"JS message event: #{JSON.stringify e.data}\"\n      alert \"JS message event: #{JSON.stringify e.data}\"\n\n      # same as e.data\n      # data = Ti.App.Properties.getString 'com.activate.gcm.last_data', ''\n      # data = JSON.parse data\n      # Ti.App.Properties.removeProperty 'com.activate.gcm.last_data'\n      # Ti.App.Properties.hasProperty 'com.activate.gcm.last_data'\n      # Ti.Android.NotificationManager.cancelAll()\n      return\n\n\nhttps://github.com/Guti/Google-Cloud-Messaging--Titanium-/blob/6ac1270026f3cc266f37812b64ef40f2ab1b9055/example/PushNotification.js\n\n\u3053\u308c\u3092 CoffeeScript \u3067\u66f8\u304d\u76f4\u3057\u307e\u3057\u305f\uff0e\n\n```coffeescript:PushNotification.coffee\nexports.pushNotification = ->\n  hostURL = 'http://YOUR_HOST_URL/register?'\n\n  gcm = require 'com.activate.gcm'\n  Ti.API.info \"module gcm is => #{gcm}\"\n\n  Ti.API.info 'Registering...'\n\n  gcm.registerC2dm\n    success: (e) ->\n      Ti.API.info \"JS registration success event: #{e.registrationId}\"\n      alert \"Yeah JS registration success event: #{e.registrationId}\"\n      alert \"Sender ID:#{gcm.getSenderId()}\"\n      alert \"Registration ID:#{gcm.getRegistrationId()}\"\n\n      appName = Ti.App.name\n      appVersion = Ti.App.version\n\n      deviceUUID = Ti.Platform.macaddress # Ti.Network.remoteDeviceUUID\n      deviceName = Ti.Platform.username\n      deviceModel = Ti.Platform.model\n      deviceSystemVersion = Ti.Platform.version\n      deviceToken = e.deviceToken\n      regId = e.registrationId\n\n      # deviceUUID = deviceUUID.replace /-/ig, ''\n      # deviceToken = deviceToken.replace /<>/ig, ''\n\n      host = hostURL\n      urlString = host\n      # urlString += \"&appname=#{appName}\"\n      # urlString += \"&appversion=#{appVersion}\"\n      # urlString += \"&deviceuid=#{deviceUUID}\"\n      # urlString += \"&devicetoken=#{deviceToken}\"\n      # urlString += \"&devicename=#{deviceName}\"\n      # urlString += \"&devicemodel=#{deviceModel}\"\n      # urlString += \"&deviceversion=#{deviceSystemVersion}\"\n      # urlString += \"regId=#{regId}\"\n\n      loader = Ti.Network.createHTTPClient()\n      loader.setTimeout 60000\n\n      loader.onload = (evt) ->\n        alert evt\n        return\n\n      loader.open 'GET', urlString, false\n      loader.send()\n\n      alert urlString\n      return\n\n    error: (e) ->\n      Ti.API.error \"Error during registration : #{e.error}\"\n      alert \"Error during registration : #{e.error}\"\n\n      if e.error is 'ACCOUNT_MISSING'\n        message = 'No Google account found; you will need to add on in order to activate notifications'\n\n      (Titanium.UI.createAlertDialog\n        title: 'Push Notification Setup'\n        message: message\n        buttonNames: ['OK']\n      ).show()\n      return\n\n    callback: (e) -> # called when a push notification is received\n      Ti.API.info \"JS message event: #{JSON.stringify e.data}\"\n      alert \"JS message event: #{JSON.stringify e.data}\"\n\n      # same as e.data\n      # data = Ti.App.Properties.getString 'com.activate.gcm.last_data', ''\n      # data = JSON.parse data\n      # Ti.App.Properties.removeProperty 'com.activate.gcm.last_data'\n      # Ti.App.Properties.hasProperty 'com.activate.gcm.last_data'\n      # Ti.Android.NotificationManager.cancelAll()\n      return\n```", "tags": ["Titanium", "CoffeeScript1.4.0"]}