{"context": "dots.\u5973\u5b50\u90e8\u306e\u3082\u304f\u3082\u304f\u4f1a\u3067\u3001AWS Lambda\u3092\u4f7f\u3063\u3066\u30af\u30ed\u30fc\u30e9\u30fc\u3092\u4f5c\u308d\u3046\u3068\u601d\u3044\u3001\u91cd\u3044\u8170\u3092\u4e0a\u3052\u307e\u3057\u305f\u3002\n\u8170\u3001\u672c\u5f53\u306b\u91cd\u3044\u3093\u3067\u3059\u3088\u3002\nLambda\u3068\u3044\u3048\u3070\u6708\uff11\uff10\uff10\u4e07\u56de\u7121\u6599\u306a\u306e\u3067\u30011\u5206\u9593\u306b23\u56de\u3082\u5b9f\u884c\u3067\u304d\u308b\u3093\u3060\u3068\u601d\u3044\u307e\u3059\u3002\nLambda\u3067\u4f5c\u308b\u30af\u30ed\u30fc\u30e9\u30fc\uff0f\u30b9\u30af\u30ec\u30a4\u30d4\u30f3\u30b0\u304c\u53c2\u8003\u306b\u306a\u308a\u305d\u3046\u306a\u306e\u3067\u3001\u6700\u521d\u306f\u3053\u308c\u3092\u898b\u306a\u304c\u3089S3\u306brequest\u3067\u53d6\u5f97\u3057\u305f\u3082\u306e\u3092\u3068\u308a\u3042\u3048\u305a\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3057\u3088\u3046\u3068\u601d\u3044\u307e\u3057\u305f\u3002\n\u8a00\u8a9e\u306f\u3082\u3061\u308d\u3093Python\u3067\uff01\nimport boto3\nimport requests\n\nBUCKET = 'test_requests'\ns3 = boto3.client('s3')\n\ndef lambda_handler(event, context):\n    key = 'corp.camon.tokyo'\n    target_url = 'http://corp.camon.tokyo'\n    target_html = requests.get(target_url).text\n    s3.put_object(Bucket=BUCKET, Key=key, Body=target_html)\n\n\u3055\u3059\u304cAWS Lambda\u697d\u52dd\u3060\u305c\uff01\u3063\u3066\u601d\u3044\u306a\u304c\u3089Test\u30dc\u30bf\u30f3\u3092\u62bc\u3059\u3068\u30fb\u30fb\n\"errorMessage\": \"Unable to import module 'lambda_function'\"\n\nrequests\u304c\u8aad\u307f\u8fbc\u3081\u306a\u304f\u3066\u30a8\u30e9\u30fc\uff3c(^o^)\uff0f\nAWS Lambda\u3067pip install\u3059\u308b\u306b\u306f\u3069\u3046\u3059\u308c\u3070\u3044\u3044\u304b\u3068\u3050\u3050\u3063\u305f\u3089\u3053\u3093\u306a\u8a18\u4e8b\u306b\u51fa\u4f1a\u3044\u307e\u3057\u305f\u3002\nAWS Lambda Python\u3092lambda-uploader\u3067\u30c7\u30d7\u30ed\u30a4\n\u203b\u8981AWS CLI\npip install lambda-uploader\n\n\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092\u4f5c\u3063\u3066\u3001\u3055\u3063\u304d\u66f8\u3044\u305f\u30bd\u30fc\u30b9\u30b3\u30d4\u30fc\u3057\u3066\u3001lambda.json\u3068requirements.txt\u3092\u7528\u610f\u3057\u307e\u3057\u305f\u3002\n\ntest_requests.py\nimport boto3\nimport requests\n\nBUCKET = 'test_requests'\ns3 = boto3.client('s3')\n\ndef lambda_handler(event, context):\n    key = 'corp.camon.tokyo'\n    target_url = 'http://corp.camon.tokyo'\n    target_html = requests.get(target_url).text\n    s3.put_object(Bucket=BUCKET, Key=key, Body=target_html)\n\n\n\nlambda.json\n  {\n    \"name\": \"test_requests\",\n    \"description\": \"test requests\",\n    \"region\": \"ap-northeast-1\",\n    \"handler\": \"test_requests.lambda_handler\",\n    \"role\": \"arn:aws:iam::????????????:role/lambda_s3_exec_role\",\n    \"timeout\": 300,\n    \"memory\": 128\n  }\n\n\n\nrequirements.txt\nrequests\n\n\n\u69cb\u6210\u306f\u3053\u3093\u306a\u304b\u3093\u3058\u3067\u3059\u3002\n$ tree\n.\n\u251c\u2500\u2500 lambda.json\n\u251c\u2500\u2500 requirements.txt\n\u2514\u2500\u2500 test_requests.py\n\n0 directories, 3 files\n\n\u7528\u610f\u3067\u304d\u305f\u306e\u3067\u30b3\u30de\u30f3\u30c9\u5b9f\u884c\u3002\nlambda-uploader\n\n\u03bb Building Package\n\u03bb Uploading Package\n\u2049\ufe0f Unexpected error. Please report this traceback.\nTraceback (most recent call last):\n  File \"/usr/local/lib/python2.7/site-packages/lambda_uploader/shell.py\", line 151, in main\n    _execute(args)\n  File \"/usr/local/lib/python2.7/site-packages/lambda_uploader/shell.py\", line 82, in _execute\n    upldr.upload(pkg)\n  File \"/usr/local/lib/python2.7/site-packages/lambda_uploader/uploader.py\", line 112, in upload\n    self.version = self.upload_new(pkg)\n  File \"/usr/local/lib/python2.7/site-packages/lambda_uploader/uploader.py\", line 89, in upload_new\n    Publish=self._config.publish,\n  File \"/usr/local/lib/python2.7/site-packages/botocore/client.py\", line 301, in _api_call\n    return self._make_api_call(operation_name, kwargs)\n  File \"/usr/local/lib/python2.7/site-packages/botocore/client.py\", line 398, in _make_api_call\n    raise ClientError(parsed_response, operation_name)\nClientError: An error occurred (AccessDeniedException) when calling the CreateFunction operation: User: arn:aws:iam::????????????:user/WakanaYoshizawa is not authorized to perform: lambda:CreateFunction\n\n\u6a29\u9650\u304c\u306a\u3044\u3067\u3059\u3068\n\nAWSLambdaFullAccess\u3092\u8ffd\u52a0\u3057\u3066\u307e\u305f\u5b9f\u884c\n\u30a8\u30e9\u30fc\u30fb\u30fb\n\u3053\u3053\u3067dots.\u5973\u5b50\u90e8\u306e\u3082\u304f\u3082\u304f\u4f1a\u304c\u7d42\u76e4\u306b\u5dee\u3057\u8feb\u308a\u30d3\u30fc\u30eb\u304c\u652f\u7d66\u3055\u308c\u305f\u306e\u3067\u3075\u3066\u304f\u3055\u308c\u3066\u98f2\u3093\u3067\u307e\u3057\u305f\u3002\n\u30d3\u30fc\u30eb\u534a\u5206\u304f\u3089\u3044\u958b\u3051\u3066\u3001\u3044\u3044\u304b\u3093\u3058\u306b\u9154\u3063\u3066\u304d\u305f\u306e\u3067\u3084\u3051\u304f\u305d\u3067\u5b9f\u884c\u3057\u305f\u3089\u3001\u3001\u3001\n$ lambda-uploader\n\u03bb Building Package\n\u03bb Uploading Package\n\u03bb Fin\n\n\u30dd\u30ea\u30b7\u30fc\u306e\u30a2\u30bf\u30c3\u30c1\u53cd\u6620\u306b\u6642\u9593\u304b\u304b\u3063\u3066\u305f\u307f\u305f\u3044\u3067\u3057\u305f\u3002\n\u4f59\u88d5\u6301\u3063\u3066\u958b\u767a\u3059\u308b\u306e\u3063\u3066\u91cd\u8981\u3067\u3059\u306d\u3002\nLambda\u3067\u3044\u308d\u3044\u308d\u51fa\u6765\u305d\u3046\u306a\u306e\u3067\u3082\u3063\u3068\u3044\u308d\u3044\u308d\u3044\u3058\u3063\u3066\u307f\u307e\u3059\uff3c(^o^)\uff0f\ndots.\u5973\u5b50\u90e8\u306e\u3082\u304f\u3082\u304f\u4f1a\u3067\u3001AWS Lambda\u3092\u4f7f\u3063\u3066\u30af\u30ed\u30fc\u30e9\u30fc\u3092\u4f5c\u308d\u3046\u3068\u601d\u3044\u3001\u91cd\u3044\u8170\u3092\u4e0a\u3052\u307e\u3057\u305f\u3002\n\u8170\u3001\u672c\u5f53\u306b\u91cd\u3044\u3093\u3067\u3059\u3088\u3002\n\nLambda\u3068\u3044\u3048\u3070\u6708\uff11\uff10\uff10\u4e07\u56de\u7121\u6599\u306a\u306e\u3067\u30011\u5206\u9593\u306b23\u56de\u3082\u5b9f\u884c\u3067\u304d\u308b\u3093\u3060\u3068\u601d\u3044\u307e\u3059\u3002\n\n[Lambda\u3067\u4f5c\u308b\u30af\u30ed\u30fc\u30e9\u30fc\uff0f\u30b9\u30af\u30ec\u30a4\u30d4\u30f3\u30b0](http://blog.takuros.net/entry/2014/12/14/053606)\u304c\u53c2\u8003\u306b\u306a\u308a\u305d\u3046\u306a\u306e\u3067\u3001\u6700\u521d\u306f\u3053\u308c\u3092\u898b\u306a\u304c\u3089S3\u306b`request`\u3067\u53d6\u5f97\u3057\u305f\u3082\u306e\u3092\u3068\u308a\u3042\u3048\u305a\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3057\u3088\u3046\u3068\u601d\u3044\u307e\u3057\u305f\u3002\n\u8a00\u8a9e\u306f\u3082\u3061\u308d\u3093Python\u3067\uff01\n\n```py:\nimport boto3\nimport requests\n\nBUCKET = 'test_requests'\ns3 = boto3.client('s3')\n\ndef lambda_handler(event, context):\n    key = 'corp.camon.tokyo'\n    target_url = 'http://corp.camon.tokyo'\n    target_html = requests.get(target_url).text\n    s3.put_object(Bucket=BUCKET, Key=key, Body=target_html)\n```\n\n\u3055\u3059\u304cAWS Lambda\u697d\u52dd\u3060\u305c\uff01\u3063\u3066\u601d\u3044\u306a\u304c\u3089Test\u30dc\u30bf\u30f3\u3092\u62bc\u3059\u3068\u30fb\u30fb\n\n```json:\n\"errorMessage\": \"Unable to import module 'lambda_function'\"\n```\n\n`requests`\u304c\u8aad\u307f\u8fbc\u3081\u306a\u304f\u3066\u30a8\u30e9\u30fc\uff3c(^o^)\uff0f\nAWS Lambda\u3067`pip install`\u3059\u308b\u306b\u306f\u3069\u3046\u3059\u308c\u3070\u3044\u3044\u304b\u3068\u3050\u3050\u3063\u305f\u3089\u3053\u3093\u306a\u8a18\u4e8b\u306b\u51fa\u4f1a\u3044\u307e\u3057\u305f\u3002\n\n[AWS Lambda Python\u3092lambda-uploader\u3067\u30c7\u30d7\u30ed\u30a4](http://dev.classmethod.jp/cloud/deploy-aws-lambda-python-with-lambda-uploader/)\n\u203b\u8981AWS CLI\n\n```bash:\npip install lambda-uploader\n```\n\n\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092\u4f5c\u3063\u3066\u3001\u3055\u3063\u304d\u66f8\u3044\u305f\u30bd\u30fc\u30b9\u30b3\u30d4\u30fc\u3057\u3066\u3001lambda.json\u3068requirements.txt\u3092\u7528\u610f\u3057\u307e\u3057\u305f\u3002\n\n```py:test_requests.py\nimport boto3\nimport requests\n\nBUCKET = 'test_requests'\ns3 = boto3.client('s3')\n\ndef lambda_handler(event, context):\n    key = 'corp.camon.tokyo'\n    target_url = 'http://corp.camon.tokyo'\n    target_html = requests.get(target_url).text\n    s3.put_object(Bucket=BUCKET, Key=key, Body=target_html)\n```\n\n```json:lambda.json\n  {\n    \"name\": \"test_requests\",\n    \"description\": \"test requests\",\n    \"region\": \"ap-northeast-1\",\n    \"handler\": \"test_requests.lambda_handler\",\n    \"role\": \"arn:aws:iam::????????????:role/lambda_s3_exec_role\",\n    \"timeout\": 300,\n    \"memory\": 128\n  }\n```\n\n```:requirements.txt\nrequests\n```\n\n\u69cb\u6210\u306f\u3053\u3093\u306a\u304b\u3093\u3058\u3067\u3059\u3002\n\n```bash:\n$ tree\n.\n\u251c\u2500\u2500 lambda.json\n\u251c\u2500\u2500 requirements.txt\n\u2514\u2500\u2500 test_requests.py\n\n0 directories, 3 files\n```\n\n\u7528\u610f\u3067\u304d\u305f\u306e\u3067\u30b3\u30de\u30f3\u30c9\u5b9f\u884c\u3002\n\n```bash:\nlambda-uploader\n```\n\n```bash:\n\u03bb Building Package\n\u03bb Uploading Package\n\u2049\ufe0f Unexpected error. Please report this traceback.\nTraceback (most recent call last):\n  File \"/usr/local/lib/python2.7/site-packages/lambda_uploader/shell.py\", line 151, in main\n    _execute(args)\n  File \"/usr/local/lib/python2.7/site-packages/lambda_uploader/shell.py\", line 82, in _execute\n    upldr.upload(pkg)\n  File \"/usr/local/lib/python2.7/site-packages/lambda_uploader/uploader.py\", line 112, in upload\n    self.version = self.upload_new(pkg)\n  File \"/usr/local/lib/python2.7/site-packages/lambda_uploader/uploader.py\", line 89, in upload_new\n    Publish=self._config.publish,\n  File \"/usr/local/lib/python2.7/site-packages/botocore/client.py\", line 301, in _api_call\n    return self._make_api_call(operation_name, kwargs)\n  File \"/usr/local/lib/python2.7/site-packages/botocore/client.py\", line 398, in _make_api_call\n    raise ClientError(parsed_response, operation_name)\nClientError: An error occurred (AccessDeniedException) when calling the CreateFunction operation: User: arn:aws:iam::????????????:user/WakanaYoshizawa is not authorized to perform: lambda:CreateFunction\n```\n\n\u6a29\u9650\u304c\u306a\u3044\u3067\u3059\u3068\n\n<img width=\"887\" alt=\"\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2016-04-17 22.59.59.png\" src=\"https://qiita-image-store.s3.amazonaws.com/0/20557/70f097dc-28e7-a7da-c28f-a205929250cb.png\">\n\nAWSLambdaFullAccess\u3092\u8ffd\u52a0\u3057\u3066\u307e\u305f\u5b9f\u884c\n\n\u30a8\u30e9\u30fc\u30fb\u30fb\n\n\u3053\u3053\u3067dots.\u5973\u5b50\u90e8\u306e\u3082\u304f\u3082\u304f\u4f1a\u304c\u7d42\u76e4\u306b\u5dee\u3057\u8feb\u308a\u30d3\u30fc\u30eb\u304c\u652f\u7d66\u3055\u308c\u305f\u306e\u3067\u3075\u3066\u304f\u3055\u308c\u3066\u98f2\u3093\u3067\u307e\u3057\u305f\u3002\n\u30d3\u30fc\u30eb\u534a\u5206\u304f\u3089\u3044\u958b\u3051\u3066\u3001\u3044\u3044\u304b\u3093\u3058\u306b\u9154\u3063\u3066\u304d\u305f\u306e\u3067\u3084\u3051\u304f\u305d\u3067\u5b9f\u884c\u3057\u305f\u3089\u3001\u3001\u3001\n\n```\n$ lambda-uploader\n\u03bb Building Package\n\u03bb Uploading Package\n\u03bb Fin\n```\n\n\u30dd\u30ea\u30b7\u30fc\u306e\u30a2\u30bf\u30c3\u30c1\u53cd\u6620\u306b\u6642\u9593\u304b\u304b\u3063\u3066\u305f\u307f\u305f\u3044\u3067\u3057\u305f\u3002\n\u4f59\u88d5\u6301\u3063\u3066\u958b\u767a\u3059\u308b\u306e\u3063\u3066\u91cd\u8981\u3067\u3059\u306d\u3002\n\n Lambda\u3067\u3044\u308d\u3044\u308d\u51fa\u6765\u305d\u3046\u306a\u306e\u3067\u3082\u3063\u3068\u3044\u308d\u3044\u308d\u3044\u3058\u3063\u3066\u307f\u307e\u3059\uff3c(^o^)\uff0f\n", "tags": ["lambda", "AWS", "Python", "pip"]}