{"context": "\n\n\u30e9\u30d9\u30eb\u4ed8\u304d\u306e\u30de\u30fc\u30ab\u30fc\u3092\u30de\u30c3\u30d7\u4e0a\u306b\u8868\u793a\u3057\u305f\u3044\n\n\u30de\u30fc\u30ab\u30fcgoogle.maps.Marker\u306f\u30e9\u30d9\u30eb\u3092\u6307\u5b9a\u3067\u304d\u308b\u3002\n\n\nMarkerLabel object specification\n\u30aa\u30d7\u30b7\u30e7\u30f3\u3067\u6307\u5b9a\u3067\u304d\u308b\u306e\u306f\u30d5\u30a9\u30f3\u30c8\u306e\u8272\u306a\u3069\u7c21\u6613\u7684\u3002\n\u8868\u793a\u4f4d\u7f6e\u306e\u5909\u66f4\u3082\u3067\u304d\u306a\u3044\u3057\u3001\u3082\u3063\u3068\u30ab\u30b9\u30bf\u30de\u30a4\u30ba\u3057\u305f\u30e9\u30d9\u30eb\u3092\u8868\u793a\u3057\u305f\u3044\u3068\u3053\u308d\u3002\n\n\n\n\n\u4f8b\n    var marker = new google.maps.Marker({\n        position: new google.maps.LatLng({lat: latitude, lng: longitude}),\n        map: map,\n        label: {\n            color: 'blue',\n            fontFamily: 'sans-serif',\n            fontSize: '10px',\n            fontWeight: '100',\n            text: 'Marker label text'\n        }\n    });\n\n\n\n\u30de\u30fc\u30ab\u30fc\u4e0a\u306b\u30c6\u30ad\u30b9\u30c8\u304c\u8868\u793a\u3055\u308c\u308b\u304c\u3001\u7d30\u304b\u3044\u6307\u5b9a\u306f\u3067\u304d\u306a\u3044\u306e\u304c\u30c4\u30e9\u30a4\u3002\n\n\n\n\u30e9\u30d9\u30eb\u306e<div>\u3092\u6301\u3064\u72ec\u81ea\u306e\u30de\u30fc\u30ab\u30fc\u30af\u30e9\u30b9\u3092\u4f5c\u308b\n\n\ngoogle.maps.MVCObject\u3092\u30d7\u30ed\u30c8\u30bf\u30a4\u30d7\u306b\u6301\u3064LabeledMarker\u3092\u4f5c\u6210\u3059\u308b\u3002\n\n\n\u72ec\u81ea\u306e\u30bf\u30b0\u3092\u30de\u30c3\u30d7\u4e0a\u306b\u8868\u793a\u3059\u308b\u306b\u306fgoogle.maps.OverlayView\u3092\u5229\u7528\u3059\u308b\u3002\n\n\n\n\nLabeledMarker\u30af\u30e9\u30b9\nfunction LabeledMarker(map, markerOptions, labelOptions) {\n    this.setMap(map);\n    this.setPosition(markerOptions.position);\n\n    // Marker\u3068Label(Overlay)\u3092\u4f5c\u6210\u3059\u308b\n    this.marker = this.createMarker(markerOptions);\n    this.label = this.createLabel(labelOptions);\n}\nLabeledMarker.prototype = new google.maps.MVCObject();\nLabeledMarker.prototype.setMap = function (map) {\n    this.set('map', map);\n};\nLabeledMarker.prototype.setPosition = function (position) {\n    this.set('position', position);\n};\nLabeledMarker.prototype.createMarker = function (markerOptions) {\n    var marker = new google.maps.Marker(markerOptions);\n    marker.parent = this;\n    marker.bindTo('map', this);\n    marker.bindTo('position', this);\n    google.maps.event.addListener(marker, 'dragend', function () {\n        google.maps.event.trigger(this.parent, 'dragend');\n    });\n    return marker;\n};\nLabeledMarker.prototype.createLabel = function (labelOptions) {\n    var label = new google.maps.OverlayView();\n    label.parent = this;\n    label.bindTo('map', this);\n    label.bindTo('position', this);\n    label.onAdd = function () {\n        var el = document.createElement('div');\n        el.style.borderStyle = labelOptions.style.borderStyle || 'none';\n        el.style.borderWidth = labelOptions.style.borderWidth || '0px';\n        el.style.backgroundColor = labelOptions.style.backgroundColor || '';\n        el.style.position = labelOptions.style.position || 'absolute';\n        el.style.zIndex = labelOptions.style.zIndex || 100;\n        el.innerHTML = labelOptions.innerHTML || '<div>' + labelOptions.text + '</div>';\n        this.el = el;\n        var panes = this.getPanes();\n        panes.overlayLayer.appendChild(el);\n    }\n    label.draw = function () {\n        if (!this.el) return;\n\n        var overlayProjection = this.getProjection();\n        var position = this.get('position');\n        var xy = overlayProjection.fromLatLngToDivPixel(position);\n\n        var el = this.el;\n        el.style.left = xy.x + 'px';\n        el.style.top = xy.y + 'px';\n    };\n    label.onRemove = function () {\n        this.el.parentNode.removeChild(this.el);\n        this.el = null;\n    };\n    label.position_changed = function () {\n        this.draw(); // \u89aa\u30b3\u30f3\u30dd\u30fc\u30cd\u30f3\u30c8\u306e\u30dd\u30b8\u30b7\u30e7\u30f3\u304c\u5909\u66f4\u3055\u308c\u305f\u3089\u9023\u52d5\u3057\u3066\u30e9\u30d9\u30eb\u306e\u8868\u793a\u4f4d\u7f6e\u3092\u66f4\u65b0\u3059\u308b\n    };\n    return label;\n}\n\n\n\nmap\u306bLabeledMarker\u3092\u8868\u793a\u3059\u308b\nvar position = new google.maps.LatLng({\n    lat: -34.397,\n    lng: 150.644\n});\nvar map = new google.maps.Map(document.getElementById('map-canvas'), {\n    center: position,\n    scrollwheel: false,\n    zoom: 8\n});\n\n// \u30e9\u30d9\u30eb\u4ed8\u304d\u30de\u30fc\u30ab\u306e\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u4f5c\u6210\u3057\u3066\u30de\u30c3\u30d7\u306b\u8868\u793a\u3059\u308b\nvar labeldMarker = new LabeledMarker(map, {\n    position: position,\n    draggable: true\n}, {\n    text: 'Label text',\n    style: {\n        backgroundColor: 'white',\n        borderStyle: 'solid',\n        borderWidth: '1px'\n    }\n});\nlabeldMarker.addListener('position_changed', function () {\n    // \u30c9\u30e9\u30c3\u30b0\u306b\u3088\u308b\u4f4d\u7f6e\u5909\u66f4\u3092\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0\n    console.log(JSON.stringify(this.get('position')));\n});\n\n\n\n\u8868\u793a\u30b5\u30f3\u30d7\u30eb\n\n# \u30e9\u30d9\u30eb\u4ed8\u304d\u306e\u30de\u30fc\u30ab\u30fc\u3092\u30de\u30c3\u30d7\u4e0a\u306b\u8868\u793a\u3057\u305f\u3044\n\n- \u30de\u30fc\u30ab\u30fc`google.maps.Marker`\u306f\u30e9\u30d9\u30eb\u3092\u6307\u5b9a\u3067\u304d\u308b\u3002\n  - [MarkerLabel object specification](https://developers.google.com/maps/documentation/javascript/3.exp/reference?hl=ja#MarkerLabel)\n  - \u30aa\u30d7\u30b7\u30e7\u30f3\u3067\u6307\u5b9a\u3067\u304d\u308b\u306e\u306f\u30d5\u30a9\u30f3\u30c8\u306e\u8272\u306a\u3069\u7c21\u6613\u7684\u3002\n    - \u8868\u793a\u4f4d\u7f6e\u306e\u5909\u66f4\u3082\u3067\u304d\u306a\u3044\u3057\u3001\u3082\u3063\u3068\u30ab\u30b9\u30bf\u30de\u30a4\u30ba\u3057\u305f\u30e9\u30d9\u30eb\u3092\u8868\u793a\u3057\u305f\u3044\u3068\u3053\u308d\u3002\n\n```javascript:\u4f8b\n    var marker = new google.maps.Marker({\n        position: new google.maps.LatLng({lat: latitude, lng: longitude}),\n        map: map,\n        label: {\n            color: 'blue',\n            fontFamily: 'sans-serif',\n            fontSize: '10px',\n            fontWeight: '100',\n            text: 'Marker label text'\n        }\n    });\n```\n\n- \u30de\u30fc\u30ab\u30fc\u4e0a\u306b\u30c6\u30ad\u30b9\u30c8\u304c\u8868\u793a\u3055\u308c\u308b\u304c\u3001\u7d30\u304b\u3044\u6307\u5b9a\u306f\u3067\u304d\u306a\u3044\u306e\u304c\u30c4\u30e9\u30a4\u3002\n\n![image](https://qiita-image-store.s3.amazonaws.com/0/59517/0cefc80a-bf76-5218-0a53-54ea34fa3c14.png)\n\n\n## \u30e9\u30d9\u30eb\u306e`<div>`\u3092\u6301\u3064\u72ec\u81ea\u306e\u30de\u30fc\u30ab\u30fc\u30af\u30e9\u30b9\u3092\u4f5c\u308b\n\n- `google.maps.MVCObject`\u3092\u30d7\u30ed\u30c8\u30bf\u30a4\u30d7\u306b\u6301\u3064`LabeledMarker`\u3092\u4f5c\u6210\u3059\u308b\u3002\n  - \u72ec\u81ea\u306e\u30bf\u30b0\u3092\u30de\u30c3\u30d7\u4e0a\u306b\u8868\u793a\u3059\u308b\u306b\u306f`google.maps.OverlayView`\u3092\u5229\u7528\u3059\u308b\u3002\n\n```javascript:LabeledMarker\u30af\u30e9\u30b9\nfunction LabeledMarker(map, markerOptions, labelOptions) {\n    this.setMap(map);\n    this.setPosition(markerOptions.position);\n\n    // Marker\u3068Label(Overlay)\u3092\u4f5c\u6210\u3059\u308b\n    this.marker = this.createMarker(markerOptions);\n    this.label = this.createLabel(labelOptions);\n}\nLabeledMarker.prototype = new google.maps.MVCObject();\nLabeledMarker.prototype.setMap = function (map) {\n    this.set('map', map);\n};\nLabeledMarker.prototype.setPosition = function (position) {\n    this.set('position', position);\n};\nLabeledMarker.prototype.createMarker = function (markerOptions) {\n    var marker = new google.maps.Marker(markerOptions);\n    marker.parent = this;\n    marker.bindTo('map', this);\n    marker.bindTo('position', this);\n    google.maps.event.addListener(marker, 'dragend', function () {\n        google.maps.event.trigger(this.parent, 'dragend');\n    });\n    return marker;\n};\nLabeledMarker.prototype.createLabel = function (labelOptions) {\n    var label = new google.maps.OverlayView();\n    label.parent = this;\n    label.bindTo('map', this);\n    label.bindTo('position', this);\n    label.onAdd = function () {\n        var el = document.createElement('div');\n        el.style.borderStyle = labelOptions.style.borderStyle || 'none';\n        el.style.borderWidth = labelOptions.style.borderWidth || '0px';\n        el.style.backgroundColor = labelOptions.style.backgroundColor || '';\n        el.style.position = labelOptions.style.position || 'absolute';\n        el.style.zIndex = labelOptions.style.zIndex || 100;\n        el.innerHTML = labelOptions.innerHTML || '<div>' + labelOptions.text + '</div>';\n        this.el = el;\n        var panes = this.getPanes();\n        panes.overlayLayer.appendChild(el);\n    }\n    label.draw = function () {\n        if (!this.el) return;\n\n        var overlayProjection = this.getProjection();\n        var position = this.get('position');\n        var xy = overlayProjection.fromLatLngToDivPixel(position);\n\n        var el = this.el;\n        el.style.left = xy.x + 'px';\n        el.style.top = xy.y + 'px';\n    };\n    label.onRemove = function () {\n        this.el.parentNode.removeChild(this.el);\n        this.el = null;\n    };\n    label.position_changed = function () {\n        this.draw(); // \u89aa\u30b3\u30f3\u30dd\u30fc\u30cd\u30f3\u30c8\u306e\u30dd\u30b8\u30b7\u30e7\u30f3\u304c\u5909\u66f4\u3055\u308c\u305f\u3089\u9023\u52d5\u3057\u3066\u30e9\u30d9\u30eb\u306e\u8868\u793a\u4f4d\u7f6e\u3092\u66f4\u65b0\u3059\u308b\n    };\n    return label;\n}\n```\n\n```javascript:map\u306bLabeledMarker\u3092\u8868\u793a\u3059\u308b\nvar position = new google.maps.LatLng({\n    lat: -34.397,\n    lng: 150.644\n});\nvar map = new google.maps.Map(document.getElementById('map-canvas'), {\n    center: position,\n    scrollwheel: false,\n    zoom: 8\n});\n\n// \u30e9\u30d9\u30eb\u4ed8\u304d\u30de\u30fc\u30ab\u306e\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u4f5c\u6210\u3057\u3066\u30de\u30c3\u30d7\u306b\u8868\u793a\u3059\u308b\nvar labeldMarker = new LabeledMarker(map, {\n    position: position,\n    draggable: true\n}, {\n    text: 'Label text',\n    style: {\n        backgroundColor: 'white',\n        borderStyle: 'solid',\n        borderWidth: '1px'\n    }\n});\nlabeldMarker.addListener('position_changed', function () {\n    // \u30c9\u30e9\u30c3\u30b0\u306b\u3088\u308b\u4f4d\u7f6e\u5909\u66f4\u3092\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0\n    console.log(JSON.stringify(this.get('position')));\n});\n```\n\n## \u8868\u793a\u30b5\u30f3\u30d7\u30eb\n![image](https://qiita-image-store.s3.amazonaws.com/0/59517/6e046c64-5c69-f9cb-da92-0804aeb96fd3.png)\n\n", "tags": ["JavaScript", "GoogleMapsAPI", "MVCObject"]}