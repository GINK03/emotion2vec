{"context": " More than 1 year has passed since last update.Lambda \u30d5\u30a1\u30f3\u30af\u30b7\u30e7\u30f3\u5185\u3067 context.done() \u306e\u7b2c1\u5f15\u6570\u306b null \u4ee5\u5916\u306e\u5024\u3092\u6e21\u3059\u3068\u51e6\u7406\u5931\u6557\u3068\u306a\u308a\u30ea\u30c8\u30e9\u30a4\u304c\u767a\u751f\u3059\u308b\u3002\n\u5404\u30a4\u30d9\u30f3\u30c8\u30bd\u30fc\u30b9\u306b\u3088\u308b\u30ea\u30c8\u30e9\u30a4\u51e6\u7406\u3092\u8abf\u3079\u3066\u307f\u305f\u3002\n\nS3\n\n\u51e6\u7406\u5931\u6557\u6642\u306b\u306f 3 \u5206\u5f8c\u306b\u518d\u5ea6\u30d5\u30a1\u30f3\u30af\u30b7\u30e7\u30f3\u304c\u547c\u3073\u51fa\u3055\u308c\u308b\u3002\n\ncontext.invokeid \u306f\u524d\u56de\u3068\u540c\u3058\u5024\u306b\u306a\u308b\u3002\n\u30ea\u30c8\u30e9\u30a4\u3092\u542b\u3081\u3066\u6700\u5927 3 \u56de\u5b9f\u884c\u3055\u308c\u308b\u3002\n\n\nETag\u306e\u6bd4\u8f03\nUS Standard \u306f\u5168\u3066\u306e\u64cd\u4f5c\u3067\u7d50\u679c\u6574\u5408\u6027\u3001\u305d\u308c\u4ee5\u5916\u306e\u30ea\u30fc\u30b8\u30e7\u30f3\u3067\u306f\u65b0\u898f\u4f5c\u6210\u4ee5\u5916\u306e\u64cd\u4f5c\u3067\u7d50\u679c\u6574\u5408\u6027\u3092\u3082\u3063\u3066\u52d5\u4f5c\u3059\u308b\u3002\nLambda \u306b\u9650\u3089\u305a S3 \u306e\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u53d6\u5f97\u3059\u308b\u5834\u5408\u306f ETag \u3092\u78ba\u8a8d\u3057\u305f\u307b\u3046\u304c\u3044\u3044\u3002\nhttp://docs.aws.amazon.com/ja_jp/AmazonS3/latest/dev/Introduction.html#Regions\nIfMatch \u3092\u6e21\u305b\u3070\u6307\u5b9a\u306e ETag \u306b\u30de\u30c3\u30c1\u3057\u305f\u6642\u3060\u3051\u53d6\u5f97\u6210\u529f\u3068\u306a\u308b(\u5931\u6557\u6642\u306f412\u304c\u8fd4\u3063\u3066\u304f\u308b)\u3002\n\u3061\u306a\u307f\u306b\u3001\u3053\u3053\u3067\u306f\u4f7f\u3063\u3066\u3044\u306a\u3044\u304c s3.getObject() \u306e\u623b\u308a\u5024\u306b\u542b\u307e\u308c\u308b ETag \u306f\u4e8c\u91cd\u306b\u30af\u30a9\u30fc\u30c8\u3055\u308c\u3066\u3044\u308b\u306e\u3067\u6ce8\u610f\u3002\n\nhandler\ns3.getObject({\n  Bucket: bucket,\n  Key: key,\n  IfMatch: event.Records[0].s3.object.eTag\n}, function(err,data) {\n  if (err) {\n    console.log(JSON.stringify(err, null, 2));\n    context.done('error', err);\n  } else {\n    context.done();\n  }\n});\n\n\n\nerr\n{\n  \"message\": \"At least one of the pre-conditions you specified did not hold\",\n  \"code\": \"PreconditionFailed\",\n  \"time\": \"2014-12-03T02:54:39.101Z\",\n  \"statusCode\": 412,\n  \"retryable\": false\n}\n\n\n\nKinesis\n\nTruncated Exponential Backoff \u3068\u3044\u3046\u3084\u3064\uff1f\n\u30a4\u30f3\u30bf\u30fc\u30d0\u30eb\u304c 1 \u79d2\u3001 2 \u79d2\u3001 4 \u79d2\u3001 8 \u79d2\u3001 \u30fb\u30fb\u30fb\u3068\u3044\u3046\u3075\u3046\u306b\u5897\u3048\u3066\u3044\u304f\u3002\n\u30a4\u30f3\u30bf\u30fc\u30d0\u30eb\u306f 60 \u79d2\u524d\u5f8c\u304c\u6700\u5927\u5024\u3063\u307d\u3044\u3002\n\ncontext.invokeid \u306f\u6bce\u56de\u9055\u3046\u5024\u306b\u306a\u308b\u3002\n\u30ea\u30c8\u30e9\u30a4\u3092\u542b\u3081\u3066\u6700\u5927 10 \u56de\u5b9f\u884c\u3055\u308c\u308b\u3002\n\n\nDynamoDB Streams\n\u5f53\u7136\u3068\u8a00\u3048\u3070\u5f53\u7136\u3060\u3051\u3069 Kinesis \u3068\u540c\u3058\u6319\u52d5\u3060\u3063\u305f\u3002\n\nLambda \u30d5\u30a1\u30f3\u30af\u30b7\u30e7\u30f3\u5185\u3067 `context.done()` \u306e\u7b2c1\u5f15\u6570\u306b `null` \u4ee5\u5916\u306e\u5024\u3092\u6e21\u3059\u3068\u51e6\u7406\u5931\u6557\u3068\u306a\u308a\u30ea\u30c8\u30e9\u30a4\u304c\u767a\u751f\u3059\u308b\u3002\n\u5404\u30a4\u30d9\u30f3\u30c8\u30bd\u30fc\u30b9\u306b\u3088\u308b\u30ea\u30c8\u30e9\u30a4\u51e6\u7406\u3092\u8abf\u3079\u3066\u307f\u305f\u3002\n\n# S3\n\n* \u51e6\u7406\u5931\u6557\u6642\u306b\u306f 3 \u5206\u5f8c\u306b\u518d\u5ea6\u30d5\u30a1\u30f3\u30af\u30b7\u30e7\u30f3\u304c\u547c\u3073\u51fa\u3055\u308c\u308b\u3002\n* `context.invokeid` \u306f\u524d\u56de\u3068\u540c\u3058\u5024\u306b\u306a\u308b\u3002\n* \u30ea\u30c8\u30e9\u30a4\u3092\u542b\u3081\u3066\u6700\u5927 3 \u56de\u5b9f\u884c\u3055\u308c\u308b\u3002\n\n## ETag\u306e\u6bd4\u8f03\n\nUS Standard \u306f\u5168\u3066\u306e\u64cd\u4f5c\u3067\u7d50\u679c\u6574\u5408\u6027\u3001\u305d\u308c\u4ee5\u5916\u306e\u30ea\u30fc\u30b8\u30e7\u30f3\u3067\u306f\u65b0\u898f\u4f5c\u6210\u4ee5\u5916\u306e\u64cd\u4f5c\u3067\u7d50\u679c\u6574\u5408\u6027\u3092\u3082\u3063\u3066\u52d5\u4f5c\u3059\u308b\u3002\nLambda \u306b\u9650\u3089\u305a S3 \u306e\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u53d6\u5f97\u3059\u308b\u5834\u5408\u306f ETag \u3092\u78ba\u8a8d\u3057\u305f\u307b\u3046\u304c\u3044\u3044\u3002\n\nhttp://docs.aws.amazon.com/ja_jp/AmazonS3/latest/dev/Introduction.html#Regions\n\n`IfMatch` \u3092\u6e21\u305b\u3070\u6307\u5b9a\u306e ETag \u306b\u30de\u30c3\u30c1\u3057\u305f\u6642\u3060\u3051\u53d6\u5f97\u6210\u529f\u3068\u306a\u308b(\u5931\u6557\u6642\u306f412\u304c\u8fd4\u3063\u3066\u304f\u308b)\u3002\n\u3061\u306a\u307f\u306b\u3001\u3053\u3053\u3067\u306f\u4f7f\u3063\u3066\u3044\u306a\u3044\u304c `s3.getObject()` \u306e\u623b\u308a\u5024\u306b\u542b\u307e\u308c\u308b ETag \u306f\u4e8c\u91cd\u306b\u30af\u30a9\u30fc\u30c8\u3055\u308c\u3066\u3044\u308b\u306e\u3067\u6ce8\u610f\u3002\n\n```js:handler\ns3.getObject({\n  Bucket: bucket,\n  Key: key,\n  IfMatch: event.Records[0].s3.object.eTag\n}, function(err,data) {\n  if (err) {\n    console.log(JSON.stringify(err, null, 2));\n    context.done('error', err);\n  } else {\n    context.done();\n  }\n});\n```\n\n```js:err\n{\n  \"message\": \"At least one of the pre-conditions you specified did not hold\",\n  \"code\": \"PreconditionFailed\",\n  \"time\": \"2014-12-03T02:54:39.101Z\",\n  \"statusCode\": 412,\n  \"retryable\": false\n}\n```\n\n# Kinesis\n\n* Truncated Exponential Backoff \u3068\u3044\u3046\u3084\u3064\uff1f\n* \u30a4\u30f3\u30bf\u30fc\u30d0\u30eb\u304c 1 \u79d2\u3001 2 \u79d2\u3001 4 \u79d2\u3001 8 \u79d2\u3001 \u30fb\u30fb\u30fb\u3068\u3044\u3046\u3075\u3046\u306b\u5897\u3048\u3066\u3044\u304f\u3002\n* \u30a4\u30f3\u30bf\u30fc\u30d0\u30eb\u306f 60 \u79d2\u524d\u5f8c\u304c\u6700\u5927\u5024\u3063\u307d\u3044\u3002\n* `context.invokeid` \u306f\u6bce\u56de\u9055\u3046\u5024\u306b\u306a\u308b\u3002\n* \u30ea\u30c8\u30e9\u30a4\u3092\u542b\u3081\u3066\u6700\u5927 10 \u56de\u5b9f\u884c\u3055\u308c\u308b\u3002\n\n# DynamoDB Streams\n\n\u5f53\u7136\u3068\u8a00\u3048\u3070\u5f53\u7136\u3060\u3051\u3069 Kinesis \u3068\u540c\u3058\u6319\u52d5\u3060\u3063\u305f\u3002\n", "tags": ["DynamoDB", "lambda", "Kinesis", "AWS", "S3"]}