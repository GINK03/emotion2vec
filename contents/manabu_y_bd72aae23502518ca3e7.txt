{"tags": ["\u5099\u5fd8\u9332", "\u30e1\u30cb\u30e5\u30fc", "UIElement", "AppleScript", "MacOSX"], "context": " \u3053\u306e\u8a18\u4e8b\u306f\u6700\u7d42\u66f4\u65b0\u65e5\u304b\u30891\u5e74\u4ee5\u4e0a\u304c\u7d4c\u904e\u3057\u3066\u3044\u307e\u3059\u3002\u81ea\u5206\u306a\u308a\u306e\u2026\u3000\u5099\u5fd8\u9332\u3068\u3057\u3066\u3002\n\u4f7f\u3044\u305f\u3044\u30e1\u30cb\u30e5\u30fc\u3092\u9078\u629e\u3057\u3066\u3001\u305d\u306eUI Element (\u53c2\u7167\u5f0f) \u3092\u30b3\u30d4\u30fc\u3059\u308b\u30b9\u30af\u30ea\u30d7\u30c8\u3002\n\u52d5\u4f5c\u306f\u826f\u597d\u3067\u3059\u304c\u3001\u4fdd\u8a3c\u306f\u3057\u3066\u3044\u307e\u305b\u3093\u3002\n\u305f\u3060\u3001\u4f5c\u3063\u3066\u307f\u305f\u304b\u3063\u305f\u3060\u3051\u3067\u3059 \u7b11\n\u30b9\u30af\u30ea\u30d7\u30c8\u30e1\u30cb\u30e5\u30fc\u306b\u767b\u9332\u3059\u308b\u3068\u4f7f\u3044\u305f\u3044\u6642\u306b\u4f7f\u3048\u307e\u3059\u3002\u4f7f\u3044\u52dd\u624b\u304c\u826f\u597d\u3067\u3059\u3002\nkeystroke \u3067\u30b7\u30e7\u30fc\u30c8\u30ab\u30c3\u30c8\u3092\u64cd\u4f5c\u3059\u308b\u3068\u624b\u8efd\u3067\u826f\u3044\u3093\u3067\u3059\u304c\u3001\n\u305f\u307e\u306b\u8aa4\u64cd\u4f5c\u304c\u3042\u308b\u3053\u3068\u3068\u3001\u30b7\u30e7\u30fc\u30c8\u30ab\u30c3\u30c8\u3092\u5272\u308a\u5f53\u3066\u306a\u3044\u3068\u64cd\u4f5c\u3067\u304d\u306a\u3044\u6642\u306b\u5f79\u306b\u7acb\u3061\u307e\u3059\u3002\n\u624b\u8efd\u306b\u3001\u30e1\u30cb\u30e5\u30fc\u3092\u64cd\u4f5c\u3059\u308b\u5fc5\u8981\u304c\u3042\u308b\u30d7\u30ed\u30b0\u30e9\u30e0\u3092\u4f5c\u308b\u6642\u306b\u5f79\u306b\u7acb\u3061\u307e\u3059\u3002\n\u4f8b\uff1a\n\u30af\u30ea\u30c3\u30d7\u30dc\u30fc\u30c9\u304b\u3089\n\n\n\n\u53c2\u7167\u5f0f\u3092\u30b3\u30d4\u30fc\u3059\u308bAppleScript\ntell application \"System Events\" to set appList to name of every process whose visible is true\nset app_ to (choose from list appList with title \"\u8d77\u52d5\u4e2d\u306e\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\") as text\nif result is \"false\" then return\n\n--\u6307\u5b9a\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u30e1\u30cb\u30e5\u30fc\u30d0\u30fc\u30a2\u30a4\u30c6\u30e0\u3092\u53d6\u5f97\u30ea\u30b9\u30c8\u5316\ntell application \"System Events\"\n    tell menu bar 1 of application process app_\n        set MenubarItems to ((name of every UI element) as list)'s items 2 thru -1\n        delay 0.2\n    end tell\nend tell\n\n--\u3069\u306e\u30e1\u30cb\u30e5\u30fc\u9805\u76ee\u3092\u53d6\u5f97\u3059\u308b\u304b\u30ea\u30b9\u30c8\u304b\u3089\u9078\u629e\nset menuBarItem to (choose from list MenubarItems with title app_) as text\nif result is \"false\" then return\n\n--\u53c2\u7167\u5f0f\u306e\u540d\u524d\u3092\u53d6\u5f97\u3001\u4e00\u89a7\ntell application \"System Events\"\n    tell menu menuBarItem of menu bar item menuBarItem of menu bar 1 of application process app_\n        set mainUIElements to (name of every UI element) as list\n        delay 0.2\n    end tell\nend tell\n\n--\u540d\u524d\u304c\u53d6\u5f97\u3067\u304d\u306a\u3044\u3082\u306e\u306fmissing value\u304c\u8fd4\u308b\u306e\u3067\u305d\u308c\u3092\u7701\u304f\nset numberOfItems to count mainUIElements\nset MenuItem_list to {}\nrepeat with i from 1 to numberOfItems\n    set a to item i of mainUIElements\n    if a is not missing value then set end of MenuItem_list to a\nend repeat\n\n--\u3069\u306e\u30e1\u30cb\u30e5\u30fc\u9805\u76ee\u3092\u53d6\u5f97\u3059\u308b\u304b\u30ea\u30b9\u30c8\u304b\u3089\u9078\u629e\nset menuItem to (choose from list MenuItem_list with title menuBarItem) as text\nif result is \"false\" then return\n\n--\u30b9\u30af\u30ea\u30d7\u30c8\u30a8\u30c7\u30a3\u30bf\u306e\u7d50\u679c\u306b\u8868\u793a\u3059\u308b\u305f\u3081\u306e\u3082\u306e\ntell application \"System Events\"\n    tell menu menuBarItem of menu bar item menuBarItem of menu bar 1 of application process app_\n        set j to every UI element as list\n        repeat with i from 1 to (count j)\n            set jj to item i of j\n            if (jj as record)'s \u00abclass seld\u00bb is menuItem then exit repeat\n        end repeat\n    end tell\nend tell\n\n--\u30af\u30ea\u30c3\u30d7\u30dc\u30fc\u30c9\u306b\u8a2d\u5b9a\nset the clipboard to \"tell application \\\"System Events\\\"\" & return & \"tell process \\\"\" & app_ & \"\\\"\" & return & \"set frontmost to true\" & return & \"tell menu \\\"\" & menuBarItem & \"\\\" of menu bar item \\\"\" & menuBarItem & \"\\\" of menu bar 1\" & return & \"click menu item \\\"\" & menuItem & \"\\\"\" & return & \"end tell\" & return & \"end tell\" & return & \"end tell\"\n\n\ntry\n    tell application \"System Events\"\n        tell menu menuItem of menu item menuItem of menu menuBarItem of menu bar item menuBarItem of menu bar 1 of application process app_\n            set subUIElements to (name of every UI element) as list\n            delay 0.2\n        end tell\n    end tell\n\n    set numberOfItems to count subUIElements\n    set subMenuItem_list to {}\n    repeat with i from 1 to numberOfItems\n        set a to item i of subUIElements\n        if a is not missing value then set end of subMenuItem_list to a\n    end repeat\n\n    set subMenuItem to (choose from list subMenuItem_list with title menuItem) as text\n    if result is \"false\" then return\n\n    tell application \"System Events\"\n        tell menu menuItem of menu item menuItem of menu menuBarItem of menu bar item menuBarItem of menu bar 1 of application process app_\n            set j to every UI element as list\n            repeat with i from 1 to (count j)\n                set jj to item i of j\n                if (jj as record)'s \u00abclass seld\u00bb is subMenuItem then exit repeat\n            end repeat\n        end tell\n    end tell\n\n    set the clipboard to \"tell application \\\"System Events\\\"\" & return & \"tell process \\\"\" & app_ & \"\\\"\" & return & \"set frontmost to true\" & return & \"tell menu \\\"\" & menuItem & \"\\\" of menu item \\\"\" & menuItem & \"\\\" of menu \\\"\" & menuBarItem & \"\\\" of menu bar item \\\"\" & menuBarItem & \"\\\" of menu bar 1\" & return & \"click menu item \\\"\" & subMenuItem & \"\\\"\" & return & \"end tell\" & return & \"end tell\" & return & \"end tell\"\nend try\n\ntry\n    tell application \"System Events\"\n        tell menu subMenuItem of menu item subMenuItem of menu menuItem of menu item menuItem of menu menuBarItem of menu bar item menuBarItem of menu bar 1 of application process app_\n            set thirdUIElements to (name of every UI element) as list\n            delay 0.2\n        end tell\n    end tell\n\n    set numberOfItems to count thirdUIElements\n    set thirdMenuItem_list to {}\n    repeat with i from 1 to numberOfItems\n        set a to item i of thirdUIElements\n        if a is not missing value then set end of thirdMenuItem_list to a\n    end repeat\n\n    set thirdMenuItem to (choose from list thirdMenuItem_list with title subMenuItem)\n    if result is \"false\" then return\n\n    tell application \"System Events\"\n        tell menu subMenuItem of menu item subMenuItem of menu menuItem of menu item menuItem of menu menuBarItem of menu bar item menuBarItem of menu bar 1 of application process app_\n            set j to every UI element as list\n            repeat with i from 1 to (count j)\n                set jj to item i of j\n                if (jj as record)'s \u00abclass seld\u00bb is thirdMenuItem then exit repeat\n            end repeat\n        end tell\n    end tell\n\n    set the clipboard to \"tell application \\\"System Events\\\"\" & return & \"tell process \\\"\" & app_ & \"\\\"\" & return & \"set frontmost to true\" & return & \"tell menu \\\"\" & subMenuItem & \"\\\" of menu item \\\"\" & subMenuItem & \"\\\"of menu \\\"\" & menuItem & \"\\\" of menu item \\\"\" & menuItem & \"\\\" of menu \\\"\" & menuBarItem & \"\\\" of menu bar item \\\"\" & menuBarItem & \"\\\" of menu bar 1\" & return & \"click menu item \\\"\" & thirdMenuItem & \"\\\"\" & return & \"end tell\" & return & \"end tell\" & return & \"end tell\"\nend try\njj\n\n\n\u81ea\u5206\u306a\u308a\u306e\u2026\u3000\u5099\u5fd8\u9332\u3068\u3057\u3066\u3002\n\u4f7f\u3044\u305f\u3044\u30e1\u30cb\u30e5\u30fc\u3092\u9078\u629e\u3057\u3066\u3001\u305d\u306eUI Element (\u53c2\u7167\u5f0f) \u3092\u30b3\u30d4\u30fc\u3059\u308b\u30b9\u30af\u30ea\u30d7\u30c8\u3002\n\u52d5\u4f5c\u306f\u826f\u597d\u3067\u3059\u304c\u3001\u4fdd\u8a3c\u306f\u3057\u3066\u3044\u307e\u305b\u3093\u3002\n\u305f\u3060\u3001\u4f5c\u3063\u3066\u307f\u305f\u304b\u3063\u305f\u3060\u3051\u3067\u3059 \u7b11\n\u30b9\u30af\u30ea\u30d7\u30c8\u30e1\u30cb\u30e5\u30fc\u306b\u767b\u9332\u3059\u308b\u3068\u4f7f\u3044\u305f\u3044\u6642\u306b\u4f7f\u3048\u307e\u3059\u3002\u4f7f\u3044\u52dd\u624b\u304c\u826f\u597d\u3067\u3059\u3002\nkeystroke \u3067\u30b7\u30e7\u30fc\u30c8\u30ab\u30c3\u30c8\u3092\u64cd\u4f5c\u3059\u308b\u3068\u624b\u8efd\u3067\u826f\u3044\u3093\u3067\u3059\u304c\u3001\n\u305f\u307e\u306b\u8aa4\u64cd\u4f5c\u304c\u3042\u308b\u3053\u3068\u3068\u3001\u30b7\u30e7\u30fc\u30c8\u30ab\u30c3\u30c8\u3092\u5272\u308a\u5f53\u3066\u306a\u3044\u3068\u64cd\u4f5c\u3067\u304d\u306a\u3044\u6642\u306b\u5f79\u306b\u7acb\u3061\u307e\u3059\u3002\n\u624b\u8efd\u306b\u3001\u30e1\u30cb\u30e5\u30fc\u3092\u64cd\u4f5c\u3059\u308b\u5fc5\u8981\u304c\u3042\u308b\u30d7\u30ed\u30b0\u30e9\u30e0\u3092\u4f5c\u308b\u6642\u306b\u5f79\u306b\u7acb\u3061\u307e\u3059\u3002\n\n\u4f8b\uff1a\n\u30af\u30ea\u30c3\u30d7\u30dc\u30fc\u30c9\u304b\u3089\n<img src=\"https://qiita-image-store.s3.amazonaws.com/0/65668/bf862437-5085-1e24-2479-716067608119.png\" style=\"max-width: 250px;\">\n\n![\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2015-04-30 18.16.19.png](https://qiita-image-store.s3.amazonaws.com/0/65668/8423596c-245f-b3d8-ca9f-41f6255fe626.png)\n\n\n```applescript:\u53c2\u7167\u5f0f\u3092\u30b3\u30d4\u30fc\u3059\u308bAppleScript\ntell application \"System Events\" to set appList to name of every process whose visible is true\nset app_ to (choose from list appList with title \"\u8d77\u52d5\u4e2d\u306e\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\") as text\nif result is \"false\" then return\n\n--\u6307\u5b9a\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u30e1\u30cb\u30e5\u30fc\u30d0\u30fc\u30a2\u30a4\u30c6\u30e0\u3092\u53d6\u5f97\u30ea\u30b9\u30c8\u5316\ntell application \"System Events\"\n\ttell menu bar 1 of application process app_\n\t\tset MenubarItems to ((name of every UI element) as list)'s items 2 thru -1\n\t\tdelay 0.2\n\tend tell\nend tell\n\n--\u3069\u306e\u30e1\u30cb\u30e5\u30fc\u9805\u76ee\u3092\u53d6\u5f97\u3059\u308b\u304b\u30ea\u30b9\u30c8\u304b\u3089\u9078\u629e\nset menuBarItem to (choose from list MenubarItems with title app_) as text\nif result is \"false\" then return\n\n--\u53c2\u7167\u5f0f\u306e\u540d\u524d\u3092\u53d6\u5f97\u3001\u4e00\u89a7\ntell application \"System Events\"\n\ttell menu menuBarItem of menu bar item menuBarItem of menu bar 1 of application process app_\n\t\tset mainUIElements to (name of every UI element) as list\n\t\tdelay 0.2\n\tend tell\nend tell\n\n--\u540d\u524d\u304c\u53d6\u5f97\u3067\u304d\u306a\u3044\u3082\u306e\u306fmissing value\u304c\u8fd4\u308b\u306e\u3067\u305d\u308c\u3092\u7701\u304f\nset numberOfItems to count mainUIElements\nset MenuItem_list to {}\nrepeat with i from 1 to numberOfItems\n\tset a to item i of mainUIElements\n\tif a is not missing value then set end of MenuItem_list to a\nend repeat\n\n--\u3069\u306e\u30e1\u30cb\u30e5\u30fc\u9805\u76ee\u3092\u53d6\u5f97\u3059\u308b\u304b\u30ea\u30b9\u30c8\u304b\u3089\u9078\u629e\nset menuItem to (choose from list MenuItem_list with title menuBarItem) as text\nif result is \"false\" then return\n\n--\u30b9\u30af\u30ea\u30d7\u30c8\u30a8\u30c7\u30a3\u30bf\u306e\u7d50\u679c\u306b\u8868\u793a\u3059\u308b\u305f\u3081\u306e\u3082\u306e\ntell application \"System Events\"\n\ttell menu menuBarItem of menu bar item menuBarItem of menu bar 1 of application process app_\n\t\tset j to every UI element as list\n\t\trepeat with i from 1 to (count j)\n\t\t\tset jj to item i of j\n\t\t\tif (jj as record)'s \u00abclass seld\u00bb is menuItem then exit repeat\n\t\tend repeat\n\tend tell\nend tell\n\n--\u30af\u30ea\u30c3\u30d7\u30dc\u30fc\u30c9\u306b\u8a2d\u5b9a\nset the clipboard to \"tell application \\\"System Events\\\"\" & return & \"tell process \\\"\" & app_ & \"\\\"\" & return & \"set frontmost to true\" & return & \"tell menu \\\"\" & menuBarItem & \"\\\" of menu bar item \\\"\" & menuBarItem & \"\\\" of menu bar 1\" & return & \"click menu item \\\"\" & menuItem & \"\\\"\" & return & \"end tell\" & return & \"end tell\" & return & \"end tell\"\n\n\ntry\n\ttell application \"System Events\"\n\t\ttell menu menuItem of menu item menuItem of menu menuBarItem of menu bar item menuBarItem of menu bar 1 of application process app_\n\t\t\tset subUIElements to (name of every UI element) as list\n\t\t\tdelay 0.2\n\t\tend tell\n\tend tell\n\t\n\tset numberOfItems to count subUIElements\n\tset subMenuItem_list to {}\n\trepeat with i from 1 to numberOfItems\n\t\tset a to item i of subUIElements\n\t\tif a is not missing value then set end of subMenuItem_list to a\n\tend repeat\n\t\n\tset subMenuItem to (choose from list subMenuItem_list with title menuItem) as text\n\tif result is \"false\" then return\n\t\n\ttell application \"System Events\"\n\t\ttell menu menuItem of menu item menuItem of menu menuBarItem of menu bar item menuBarItem of menu bar 1 of application process app_\n\t\t\tset j to every UI element as list\n\t\t\trepeat with i from 1 to (count j)\n\t\t\t\tset jj to item i of j\n\t\t\t\tif (jj as record)'s \u00abclass seld\u00bb is subMenuItem then exit repeat\n\t\t\tend repeat\n\t\tend tell\n\tend tell\n\t\n\tset the clipboard to \"tell application \\\"System Events\\\"\" & return & \"tell process \\\"\" & app_ & \"\\\"\" & return & \"set frontmost to true\" & return & \"tell menu \\\"\" & menuItem & \"\\\" of menu item \\\"\" & menuItem & \"\\\" of menu \\\"\" & menuBarItem & \"\\\" of menu bar item \\\"\" & menuBarItem & \"\\\" of menu bar 1\" & return & \"click menu item \\\"\" & subMenuItem & \"\\\"\" & return & \"end tell\" & return & \"end tell\" & return & \"end tell\"\nend try\n\ntry\n\ttell application \"System Events\"\n\t\ttell menu subMenuItem of menu item subMenuItem of menu menuItem of menu item menuItem of menu menuBarItem of menu bar item menuBarItem of menu bar 1 of application process app_\n\t\t\tset thirdUIElements to (name of every UI element) as list\n\t\t\tdelay 0.2\n\t\tend tell\n\tend tell\n\t\n\tset numberOfItems to count thirdUIElements\n\tset thirdMenuItem_list to {}\n\trepeat with i from 1 to numberOfItems\n\t\tset a to item i of thirdUIElements\n\t\tif a is not missing value then set end of thirdMenuItem_list to a\n\tend repeat\n\t\n\tset thirdMenuItem to (choose from list thirdMenuItem_list with title subMenuItem)\n\tif result is \"false\" then return\n\t\n\ttell application \"System Events\"\n\t\ttell menu subMenuItem of menu item subMenuItem of menu menuItem of menu item menuItem of menu menuBarItem of menu bar item menuBarItem of menu bar 1 of application process app_\n\t\t\tset j to every UI element as list\n\t\t\trepeat with i from 1 to (count j)\n\t\t\t\tset jj to item i of j\n\t\t\t\tif (jj as record)'s \u00abclass seld\u00bb is thirdMenuItem then exit repeat\n\t\t\tend repeat\n\t\tend tell\n\tend tell\n\t\n\tset the clipboard to \"tell application \\\"System Events\\\"\" & return & \"tell process \\\"\" & app_ & \"\\\"\" & return & \"set frontmost to true\" & return & \"tell menu \\\"\" & subMenuItem & \"\\\" of menu item \\\"\" & subMenuItem & \"\\\"of menu \\\"\" & menuItem & \"\\\" of menu item \\\"\" & menuItem & \"\\\" of menu \\\"\" & menuBarItem & \"\\\" of menu bar item \\\"\" & menuBarItem & \"\\\" of menu bar 1\" & return & \"click menu item \\\"\" & thirdMenuItem & \"\\\"\" & return & \"end tell\" & return & \"end tell\" & return & \"end tell\"\nend try\njj\n```\n"}