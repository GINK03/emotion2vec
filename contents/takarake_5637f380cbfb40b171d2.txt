{"context": " More than 1 year has passed since last update.\n\n\u53c2\u8003URL\n\nSupervisor\u3067\u7c21\u5358\u306b\u30c7\u30fc\u30e2\u30f3\u5316 - Qiita\nSupervisord \u3092 Amazon Linux AMI \u306b\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb - massat\u306e\u65e5\u8a18\nSupervisord + Amazon Linux | TECH\n\u8907\u6570\u306eSupervisord\u3092\u4e00\u62ec\u76e3\u8996\u3059\u308b\u300cpy-supervisord-monitor\u300d - Symfoware\nsymfo / py-supervisord-monitor \u2014 Bitbucket\nJapaneseDownload - Mercurial\nhg\n\n\n\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\npy-supervisord-monitor\u306e\u30bd\u30fc\u30b9\u3092\u5f15\u3063\u5f35\u308b\u305f\u3081\u306b\u5fc5\u8981\u306a\u30c4\u30fc\u30eb(mercurial)\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u3066\u3044\u304f\u3002\n\n$ sudo vim /etc/yum.repos.d/mercurial.selenic.com.repo\n\n\n\u4e0a\u8a18\u30d5\u30a1\u30a4\u30eb\u3078\u4e0b\u8a18\u3092\u30b3\u30d4\u30da\u3002\n\n[mercurial.selenic.com]\nname=mercurial.selenic.com\nbaseurl=https://www.mercurial-scm.org/release/centos$releasever  \u2190\u3000Amazon Linux\u3060\u3068\u3001\u300c\"The requested URL returned error: 404 Not Found\"\u300d\u304c\u8d77\u3053\u308b\u306e\u3067\u3001\u300ccentos6\u300d\u306b\u76f4\u3057\u305f\nenabled=1\n# Temporary until we get a serious signing scheme in place,\n# check https://www.mercurial-scm.org/wiki/Download again\ngpgcheck=0\n\n\nmercurial\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u3066\u3001\u30c4\u30fc\u30eb\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\n\n$ sudo yum install mercurial\n$ hg clone https://symfo@bitbucket.org/symfo/py-supervisord-monitor\n\n\nsupervisor\u306econfig\u30d5\u30a1\u30a4\u30eb\u3092\u7de8\u96c6\n\n$ sudo vim /etc/supervisord.conf\n\n\n\u4e0b\u8a18\u3092\u8a2d\u5b9a\n\n[supervisord]\nhttp_port=127.0.0.1:9001  ; (alternately, ip_address:port specifies AF_INET)\n\n[supervisorctl]\nserverurl=unix:///var/tmp/supervisor.sock ; use a unix:// URL  for a unix socket\nserverurl=http://127.0.0.1:9001 ; use an http:// url to specify an inet socket\n\n[inet_http_server]\nport = 0.0.0.0:9001\n\n\nsupervisor\u306e\u518d\u8d77\u52d5\n\n$ sudo service supervisord status\nsupervisord (pid  1543) is running...\n$ sudo service supervisord restart\nStopping supervisord:                                      [  OK  ]\nStarting supervisord:                                      [  OK  ]\n$ curl http://localhost:9001\n\u203bHTML\u304c\u30ec\u30b9\u30dd\u30f3\u30b9\u3055\u308c\u308b\u304c\u3001Supervisor2.X\u3060\u3068\u3001\u30b3\u30de\u30f3\u30c9\u5165\u529b\u5f85\u3061\u306b\u306a\u3089\u306a\u3044\u3002\u3002\u3002\n\n\nsupervisord\u306e\u30a2\u30c3\u30d7\u30c7\u30fc\u30c8\n\n$ sudo pip install --upgrade pip\nSuccessfully installed pip-8.0.2\n$ sudo pip install --upgrade supervisor\nSuccessfully installed meld3-1.0.2 supervisor-3.2.1\n$ sudo service supervisord stop\nStopping supervisord:                                      [  OK  ]\n$ sudo service supervisord start\nStarting supervisord: /usr/lib/python2.6/site-packages/supervisor/options.py:296: UserWarning: Supervisord is running as root and it is searching for its configuration file in default locations (including its current working directory); you probably want to specify a \"-c\" argument specifying an absolute path to a configuration file for improved security.\n  'Supervisord is running as root and it is searching '\n                                                           [  OK  ]\n\n\n\u306a\u3093\u304b\u3001Warning\u51fa\u3066\u308b\u306e\u3067\u3001\u8d77\u52d5\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u30a8\u30e9\u30fc\u306b\u306a\u3089\u3044\u3001\u4e00\u90e8\u5909\u66f4\n\n$ sudo vim /etc/init.d/supervisord\nstart() {\n        echo -n $\"Starting supervisord: \"\n        daemon supervisord\n                      \u2193\n        daemon supervisord -c /etc/supervisord.conf\n\n$ sudo service supervisord restart\nStopping supervisord:                                      [  OK  ]\nStarting supervisord:                                      [  OK  ]\n\n\n\u6012\u3089\u308c\u306a\u304f\u306a\u3063\u305f\uff57\n\n$ curl http://localhost:9001\n\u203bHTML\u304c\u30ec\u30b9\u30dd\u30f3\u30b9\u3055\u308c\u308b\u304c\u3001\u6b21\u306e\u30b3\u30de\u30f3\u30c9\u5165\u529b\u5f85\u3061\u306b\u306a\u308c\u3070OK\n\n\n\u6b21\u306b\u3001\u76e3\u8996\u30c4\u30fc\u30eb\u5074\u306esupervisor.conf\u3092\u4fee\u6b63\n\n$ sudo vim py-supervisord-monitor/supervisor.conf \n[server:server01]\n#url = http://192.168.1.101/RPC2\nurl = http://127.0.0.1/RPC2\nport = 9001\n#username = user\n#password = P@ssw0rd\n\n\n\u8d77\u52d5\u3057\u3066\u307f\u308b\u3002\n\n$ sudo python index.py \nBottle v0.13-dev server starting up (using WSGIRefServer())...\nListening on http://0.0.0.0:8080/\nHit Ctrl-C to quit.\n\n\nhttp://127.0.0.1:8080/\n\u753b\u9762\u3092\u958b\u304f\u304c\u3001\u30d7\u30ed\u30bb\u30b9\u304c\u51fa\u3066\u3053\u306a\u3044\u3002\u3002\u3002\n\n\n\u8abf\u3079\u308b\u3068\u3001RPC\u306b\u3088\u308b\u63a5\u7d9a\u3092\u3057\u3066\u308b\u3068\u3044\u3046\u3053\u3068\u306a\u306e\u3067\u3001\u3053\u308c\u3092\u30c1\u30a7\u30c3\u30af\u3059\u308b\n\nPython\u304b\u3089Supervisor\u306eXML-RPC API\u306b\u63a5\u7d9a\u3059\u308b - Symfoware\npython - Supervisord RPC - UNKNOWN_METHOD on any request - Stack Overflow\n\n\nsupervisor\u306econfig\u30d5\u30a1\u30a4\u30eb\u3092\u7de8\u96c6\u3057\u3066\u518d\u8d77\u52d5\n\n$ sudo vim /etc/supervisord.conf\n[rpcinterface:supervisor]\nsupervisor.rpcinterface_factory = supervisor.rpcinterface:make_main_rpcinterface\n\n\n\u30c1\u30a7\u30c3\u30af\u3057\u3066\u307f\u308b\u3002\n\n$ sudo pythonsample.py\n{'statename': 'RUNNING', 'statecode': 1}\n\n\n\u30ad\u30bf\u30fc\uff01\uff01\uff01\uff01\uff01\n\n\n\u6700\u5f8c\u306b\u3001\u30ed\u30b0\u304c\u3046\u3056\u3044\u306e\u3067\u3001supervisord\u3067\u8d77\u52d5\u3059\u308b\u3088\u3046\u306b\u3059\u308b\u3002\n\n$ sudo chmod +x /opt/py-supervisord-monitor/index.py \n$ sudo vim /etc/supervisord.conf \n[program:monitor]\ncommand=/opt/py-supervisord-monitor/index.py\ndirectory=/opt/py-supervisord-monitor\nprocess_name=%(program_name)s\nnumprocs=1\nautostart=true\nautorestart=true\n\n$ sudo service supervisord status\nsupervisord (pid  4168) is running...\n$ sudo service supervisord restart\nStopping supervisord:                                      [  OK  ]\nStarting supervisord:                                      [  OK  ]\n\n\n\u30c4\u30fc\u30eb\u306e\u30a2\u30c3\u30d7\u30c7\u30fc\u30c8\u306f\u4e0b\u8a18\u3067\u3067\u304d\u308b\u3089\u3057\u3044\u3002\u3002\u3002\n$ cd /opt/py-supervisord-monitor\n$ hg pull\n$ hg update\n\n# \u53c2\u8003URL\n- [Supervisor\u3067\u7c21\u5358\u306b\u30c7\u30fc\u30e2\u30f3\u5316 - Qiita](http://qiita.com/yushin/items/15f4f90c5663710dbd56)\n- [Supervisord \u3092 Amazon Linux AMI \u306b\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb - massat\u306e\u65e5\u8a18](http://d.hatena.ne.jp/massat/20111013/1318484253)\n- [Supervisord + Amazon Linux | TECH](http://tech.akat.info/?p=1931)\n- [\u8907\u6570\u306eSupervisord\u3092\u4e00\u62ec\u76e3\u8996\u3059\u308b\u300cpy-supervisord-monitor\u300d - Symfoware](http://symfoware.blog68.fc2.com/blog-entry-1677.html)\n- [symfo / py-supervisord-monitor \u2014 Bitbucket](https://bitbucket.org/symfo/py-supervisord-monitor)\n- [JapaneseDownload - Mercurial](https://www.mercurial-scm.org/wiki/JapaneseDownload)\n- [hg](http://mercurial-users.jp/manual/hg.1.html)\n\n# \u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n* py-supervisord-monitor\u306e\u30bd\u30fc\u30b9\u3092\u5f15\u3063\u5f35\u308b\u305f\u3081\u306b\u5fc5\u8981\u306a\u30c4\u30fc\u30eb(mercurial)\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u3066\u3044\u304f\u3002\n\n```bash\n$ sudo vim /etc/yum.repos.d/mercurial.selenic.com.repo\n```\n* \u4e0a\u8a18\u30d5\u30a1\u30a4\u30eb\u3078\u4e0b\u8a18\u3092\u30b3\u30d4\u30da\u3002\n\n```bash\n[mercurial.selenic.com]\nname=mercurial.selenic.com\nbaseurl=https://www.mercurial-scm.org/release/centos$releasever  \u2190\u3000Amazon Linux\u3060\u3068\u3001\u300c\"The requested URL returned error: 404 Not Found\"\u300d\u304c\u8d77\u3053\u308b\u306e\u3067\u3001\u300ccentos6\u300d\u306b\u76f4\u3057\u305f\nenabled=1\n# Temporary until we get a serious signing scheme in place,\n# check https://www.mercurial-scm.org/wiki/Download again\ngpgcheck=0\n```\n\n* mercurial\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u3066\u3001\u30c4\u30fc\u30eb\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\n\n```bash\n$ sudo yum install mercurial\n$ hg clone https://symfo@bitbucket.org/symfo/py-supervisord-monitor\n```\n* supervisor\u306econfig\u30d5\u30a1\u30a4\u30eb\u3092\u7de8\u96c6\n\n```bash\n$ sudo vim /etc/supervisord.conf\n```\n* \u4e0b\u8a18\u3092\u8a2d\u5b9a\n\n```bash\n[supervisord]\nhttp_port=127.0.0.1:9001  ; (alternately, ip_address:port specifies AF_INET)\n```\n```bash\n[supervisorctl]\nserverurl=unix:///var/tmp/supervisor.sock ; use a unix:// URL  for a unix socket\nserverurl=http://127.0.0.1:9001 ; use an http:// url to specify an inet socket\n```\n```bash\n[inet_http_server]\nport = 0.0.0.0:9001\n```\n\n* supervisor\u306e\u518d\u8d77\u52d5\n\n```bash\n$ sudo service supervisord status\nsupervisord (pid  1543) is running...\n$ sudo service supervisord restart\nStopping supervisord:                                      [  OK  ]\nStarting supervisord:                                      [  OK  ]\n$ curl http://localhost:9001\n\u203bHTML\u304c\u30ec\u30b9\u30dd\u30f3\u30b9\u3055\u308c\u308b\u304c\u3001Supervisor2.X\u3060\u3068\u3001\u30b3\u30de\u30f3\u30c9\u5165\u529b\u5f85\u3061\u306b\u306a\u3089\u306a\u3044\u3002\u3002\u3002\n```\n* supervisord\u306e\u30a2\u30c3\u30d7\u30c7\u30fc\u30c8\n\n```bash\n$ sudo pip install --upgrade pip\nSuccessfully installed pip-8.0.2\n$ sudo pip install --upgrade supervisor\nSuccessfully installed meld3-1.0.2 supervisor-3.2.1\n$ sudo service supervisord stop\nStopping supervisord:                                      [  OK  ]\n$ sudo service supervisord start\nStarting supervisord: /usr/lib/python2.6/site-packages/supervisor/options.py:296: UserWarning: Supervisord is running as root and it is searching for its configuration file in default locations (including its current working directory); you probably want to specify a \"-c\" argument specifying an absolute path to a configuration file for improved security.\n  'Supervisord is running as root and it is searching '\n                                                           [  OK  ]\n```\n* \u306a\u3093\u304b\u3001Warning\u51fa\u3066\u308b\u306e\u3067\u3001\u8d77\u52d5\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u30a8\u30e9\u30fc\u306b\u306a\u3089\u3044\u3001\u4e00\u90e8\u5909\u66f4\n\n```bash\n$ sudo vim /etc/init.d/supervisord\nstart() {\n        echo -n $\"Starting supervisord: \"\n        daemon supervisord\n                      \u2193\n        daemon supervisord -c /etc/supervisord.conf\n\n$ sudo service supervisord restart\nStopping supervisord:                                      [  OK  ]\nStarting supervisord:                                      [  OK  ]\n```\n* \u6012\u3089\u308c\u306a\u304f\u306a\u3063\u305f\uff57\n\n```bash\n$ curl http://localhost:9001\n\u203bHTML\u304c\u30ec\u30b9\u30dd\u30f3\u30b9\u3055\u308c\u308b\u304c\u3001\u6b21\u306e\u30b3\u30de\u30f3\u30c9\u5165\u529b\u5f85\u3061\u306b\u306a\u308c\u3070OK\n```\n* \u6b21\u306b\u3001\u76e3\u8996\u30c4\u30fc\u30eb\u5074\u306esupervisor.conf\u3092\u4fee\u6b63\n\n```bash\n$ sudo vim py-supervisord-monitor/supervisor.conf \n[server:server01]\n#url = http://192.168.1.101/RPC2\nurl = http://127.0.0.1/RPC2\nport = 9001\n#username = user\n#password = P@ssw0rd\n```\n* \u8d77\u52d5\u3057\u3066\u307f\u308b\u3002\n\n```bash\n$ sudo python index.py \nBottle v0.13-dev server starting up (using WSGIRefServer())...\nListening on http://0.0.0.0:8080/\nHit Ctrl-C to quit.\n```\n* http://127.0.0.1:8080/\n* \u753b\u9762\u3092\u958b\u304f\u304c\u3001\u30d7\u30ed\u30bb\u30b9\u304c\u51fa\u3066\u3053\u306a\u3044\u3002\u3002\u3002\n![Py Supervisord Monitor.jpg](https://qiita-image-store.s3.amazonaws.com/0/14268/43013fdf-b573-0505-86e2-59dbe6daeddc.jpeg)\n\n\n* \u8abf\u3079\u308b\u3068\u3001RPC\u306b\u3088\u308b\u63a5\u7d9a\u3092\u3057\u3066\u308b\u3068\u3044\u3046\u3053\u3068\u306a\u306e\u3067\u3001\u3053\u308c\u3092\u30c1\u30a7\u30c3\u30af\u3059\u308b\n    - [Python\u304b\u3089Supervisor\u306eXML-RPC API\u306b\u63a5\u7d9a\u3059\u308b - Symfoware](http://symfoware.blog68.fc2.com/blog-entry-1672.html)\n    - [python - Supervisord RPC - UNKNOWN\\_METHOD on any request - Stack Overflow](http://stackoverflow.com/questions/1714174/supervisord-rpc-unknown-method-on-any-request)\n\n\n* supervisor\u306econfig\u30d5\u30a1\u30a4\u30eb\u3092\u7de8\u96c6\u3057\u3066\u518d\u8d77\u52d5\n\n```bash\n$ sudo vim /etc/supervisord.conf\n[rpcinterface:supervisor]\nsupervisor.rpcinterface_factory = supervisor.rpcinterface:make_main_rpcinterface\n```\n\n* \u30c1\u30a7\u30c3\u30af\u3057\u3066\u307f\u308b\u3002\n\n```bash\n$ sudo pythonsample.py\n{'statename': 'RUNNING', 'statecode': 1}\n```\n* \u30ad\u30bf\u30fc\uff01\uff01\uff01\uff01\uff01\n![Py Supervisord Monitor (2).jpg](https://qiita-image-store.s3.amazonaws.com/0/14268/f13af20a-0d0b-0317-a1f4-9b8fbebbdfc9.jpeg)\n* \u6700\u5f8c\u306b\u3001\u30ed\u30b0\u304c\u3046\u3056\u3044\u306e\u3067\u3001supervisord\u3067\u8d77\u52d5\u3059\u308b\u3088\u3046\u306b\u3059\u308b\u3002\n\n```bash\n$ sudo chmod +x /opt/py-supervisord-monitor/index.py \n$ sudo vim /etc/supervisord.conf \n[program:monitor]\ncommand=/opt/py-supervisord-monitor/index.py\ndirectory=/opt/py-supervisord-monitor\nprocess_name=%(program_name)s\nnumprocs=1\nautostart=true\nautorestart=true\n\n$ sudo service supervisord status\nsupervisord (pid  4168) is running...\n$ sudo service supervisord restart\nStopping supervisord:                                      [  OK  ]\nStarting supervisord:                                      [  OK  ]\n```\n\n# \u30c4\u30fc\u30eb\u306e\u30a2\u30c3\u30d7\u30c7\u30fc\u30c8\u306f\u4e0b\u8a18\u3067\u3067\u304d\u308b\u3089\u3057\u3044\u3002\u3002\u3002\n```bash\n$ cd /opt/py-supervisord-monitor\n$ hg pull\n$ hg update\n```\n", "tags": ["EC2", "supervisor", "\u76e3\u8996"]}