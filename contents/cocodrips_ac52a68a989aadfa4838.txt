{"tags": ["SICP", "Gauche"], "context": "\u30aa\u30f3\u30e9\u30a4\u30f3SICP\u8aad\u66f8\u5973\u5b50\u4f1a #12 (1.3.4)\n\n1.40 newton\u6cd5\n(load \"./newtons-method.scm\")\n(define (cube x) (* x x x))\n\n; \u4e0d\u52d5\u70b9\u30d7\u30ed\u30bb\u30b9\u3067 x^3 + a*x^2 + b*x + c = 0 \u306e\u96f6\u70b9\u306e\u8fd1\u4f3c\u5024\u3092\u6c42\u3081\u308b\n(define (cubic a b c)\n  (lambda (x) (+ (cube x)\n         (* a (square x))\n         (* b x)\n         c)))\n\n(newtons-method (cubic -3 3 -1) 1) ;1.0\n\n\n1.41 \u624b\u7d9a\u304d\u3092\u4e8c\u56de\u9069\u7528\u3059\u308b\u624b\u7d9a\u304d\n(define (inc x) (+ x 1))\n\n(define (double f)\n  (lambda (x) (f (f x))))\n\n((double inc) 1) ; 3\n(((double (double double)) inc) 5) ; 21 (+16)\n\n\n1.42\n\u95a2\u6570\u306e\u5408\u6210\u3092\u5b9f\u88c5\u3059\u308b\u624b\u7d9a\u304d\u3092compose\u3092\u5b9f\u88c5\u3059\u308b\nx -> f(g(x))\n;; 1.42\n\n(define (compose f g)\n  (lambda (x) (f (g x)) ))\n\n(define (square x) (* x x))\n(define (inc x) (+ x 1))\n((compose square inc) 6) ;; 49\n((compose square inc) 11) ;; 144\n\n\n1.43\nn\u56def\u3092\u9069\u7528\u3059\u308b\u624b\u7d9a\u304d repeated\u3092\nf\u304csquare\u3060\u3063\u305f\u3089\u3001n\u56de\u9069\u7528\u3059\u308c\u3070\u5f15\u6570\u30922^n\u3059\u308b\u95a2\u6570\u306b\u306a\u308b\nf(f(......f(x)))\n;; 1.43\n(load \"./1.42.scm\")\n(define (inc x) (+ x 1))\n\n(define (repeated func n)\n  (if (= n 1)\n      func\n      (compose func (repeated func (- n 1)))))\n\n\n((repeated square 2) 5) ;; 625\n(time ((repeated inc 10000000) 1))\n; real   0.558\n; user   0.550\n; sys    0.000\n\n;; hio\u3055\u3093\u306e\u898b\u7fd2\u3046\n\n(define (repeated func n)\n  (cond ((= n 1)\n     func)\n    ((= (remainder n 2) 1)\n     (compose func (repeated func (- n 1))))\n    (else\n     (let ((f (repeated func (/ n 2))))\n       (compose f f)))\n    ))\n\n((repeated square 2) 5) ;; 625\n(time ((repeated inc 10000000) 1))\n; real   0.552\n; user   0.540\n; sys    0.000\n\n\n;; hio\u3055\u3093\u306e\u672b\u5c3e\u518d\u5e30\u7248\n(define (repeated f n)\n  (define (iter i val)\n    (if (>= i n)\n    val\n    (iter (+ i 1) (f val))))\n  (lambda (x) (iter 0 x)))\n(time ((repeated inc 10000000) 1))\n; real   0.476\n; user   0.480\n; sys    0.000\n;; \u305d\u3093\u306a\u6642\u9593\u304b\u308f\u3089\u306a\u3044\u306a\n;; \u3053\u308c\u3060\u3068\u624b\u7d9a\u304d\n\n\n1.44\n\u5e73\u6ed1\u5316: dx\u304c\u5c0f\u3055\u306a\u5024\u3067\u3042\u308b\u3068\u304d\u3001 f(x - dx), f(x), f(x + dx) \u306e\u5e73\u5747\u3092\u3068\u3063\u305f\u3082\u306e\n\u5e73\u6ed1\u5316\u3057\u305f\u3082\u306e\u3092\u8a08\u7b97\u3059\u308bsmooth\u306e\u624b\u7d9a\u304d\u3092\u304b\u3051\u3002\n\u307e\u305f\u3001n\u91cd\u5e73\u6ed1\u5316\u95a2\u6570\u3092repeated\u3092\u4f7f\u3063\u3066\u793a\u3059\u3002\n;; 1.44\n(load \"./1.43.scm\")\n\n(define (smooth f)\n  (define dx 0.0001)\n  (lambda (x)\n    (/ (+ (f (- x dx)) (f x) (f (+ x dx))) 3) ))\n\n((smooth square) 2) ;; 4.000000006666666\n\n(define (n-fold-smooth f n)\n  (repeated (smooth f) n))\n\n((n-fold-smooth square 4) 2) ;; 65536.00098646007 (2 ^ 16)\n\n\n\n1.45 (\u672a\u89e3\u6c7a)\nn\u4e57\u6839\u3092\u6c42\u3081\u308b\n\nsource\n;; fixed-point\n(define tolerance 0.0001)\n(define max-recursion 8)\n(define (fixed-point f first-guess)\n  (define (close-enough? v1 v2)\n    (< (abs (- v1 v2)) tolerance))\n\n  (define (try guess i)\n    (print \"guess:\" i \"\u56de\u76ee \" guess)\n    (let ((next (f guess)))\n      (if (or (close-enough? guess next) (= i max-recursion))\n      next\n      (try next (+ i 1)))))\n  (try first-guess 1))\n\n(define (average-damp f)\n  (lambda (x) (/ (+ (f x) x) 2.0)))\n\n\n;; 2, 3\u4e57\u6839\n(define (nth-root x n)\n  (fixed-point\n   (average-damp (lambda (y) (/ x (expt y (- n 1))))) 1.0))\n\n;;(print (nth-root 100 2)) ;;10.0\n;;(print (nth-root 1000 3)) ;; 10.000002544054729\n;; (nth-root 10000 4) ;;\u7121\u9650\u306bfix\u305b\u305a\u3001\u3001\u3001\u3001\n\n\n;; 4\u4e57\u6839\u4ee5\u4e0a\n(define (repeated func n)\n  (if (= n 1)\n      func\n      (compose func (repeated func (- n 1)))))\n\n(define (repeated-nth-root x n m)\n  (fixed-point\n   (repeated (average-damp (lambda (y) (/ x (expt y (- n 1))))) m) 1.0))\n\n(define (try-repeat m n root)\n  (define (iter i)\n    (print \"----------------------------------\")\n    (print  m \" ^ 1 / \" root \" \u306e\" i \"\u91cd\u5e73\u5747\u7de9\u548c\")\n    (print \"----------------------------------\")\n    (repeated-nth-root m (+ i 1) root)\n    (if (= i n)\n    0\n    (iter (+ i 1))))\n  (iter 1))\n\n(print \"2\u306en\u4e57\u306en\u4e57\u6839\u3092\u3057\u3089\u3079\u308b\")\n\n(print \"==========================\")\n(print \"2\u4e57\u6839\")\n(print \"==========================\")\n(try-repeat (expt 2 2) 3 2)\n\n(print \"==========================\")\n(print \"3\u4e57\u6839\")\n(print \"==========================\")\n(try-repeat (expt 2 3) 5 3)\n\n(print \"==========================\")\n(print \"4\u4e57\u6839\")\n(print \"==========================\")\n(try-repeat (expt 2 4) 5 4)\n\n(print \"==========================\")\n(print \"5\u4e57\u6839\")\n(print \"==========================\")\n(try-repeat (expt 2 5) 10 5)\n\n\n\u7d50\u679c\n2\u306en\u4e57\u306en\u4e57\u6839\u3092\u3057\u3089\u3079\u308b\n==========================\n2\u4e57\u6839\n==========================\n----------------------------------\n4 ^ 1 / 2 \u306e1\u91cd\u5e73\u5747\u7de9\u548c\n----------------------------------\nguess:1\u56de\u76ee 1.0\nguess:2\u56de\u76ee 2.05\nguess:3\u56de\u76ee 2.0000000929222947\n----------------------------------\n4 ^ 1 / 2 \u306e2\u91cd\u5e73\u5747\u7de9\u548c\n----------------------------------\nguess:1\u56de\u76ee 1.0\nguess:2\u56de\u76ee 1.57\nguess:3\u56de\u76ee 1.5829814190634435\nguess:4\u56de\u76ee 1.586291563873137\nguess:5\u56de\u76ee 1.5871233896905939\nguess:6\u56de\u76ee 1.5873316181944288\n----------------------------------\n4 ^ 1 / 2 \u306e3\u91cd\u5e73\u5747\u7de9\u548c\n----------------------------------\nguess:1\u56de\u76ee 1.0\nguess:2\u56de\u76ee 1.3780000000000001\nguess:3\u56de\u76ee 1.3781971576084833\nguess:4\u56de\u76ee 1.3783910746470118\nguess:5\u56de\u76ee 1.3785818395983083\nguess:6\u56de\u76ee 1.3787695375836293\nguess:7\u56de\u76ee 1.3789542505257217\nguess:8\u56de\u76ee 1.3791360573022022\n==========================\n3\u4e57\u6839\n==========================\n----------------------------------\n8 ^ 1 / 3 \u306e1\u91cd\u5e73\u5747\u7de9\u548c\n----------------------------------\nguess:1\u56de\u76ee 1.0\nguess:2\u56de\u76ee 2.843780727630285\nguess:3\u56de\u76ee 2.82842712474619\n----------------------------------\n8 ^ 1 / 3 \u306e2\u91cd\u5e73\u5747\u7de9\u548c\n----------------------------------\nguess:1\u56de\u76ee 1.0\nguess:2\u56de\u76ee 1.8914996576441667\nguess:3\u56de\u76ee 2.0151199754332096\nguess:4\u56de\u76ee 1.998142301706526\nguess:5\u56de\u76ee 2.0002326972862416\nguess:6\u56de\u76ee 1.999970920454376\n----------------------------------\n8 ^ 1 / 3 \u306e3\u91cd\u5e73\u5747\u7de9\u548c\n----------------------------------\nguess:1\u56de\u76ee 1.0\nguess:2\u56de\u76ee 1.478337540623817\nguess:3\u56de\u76ee 1.9239087525290877\nguess:4\u56de\u76ee 1.5363162465727038\nguess:5\u56de\u76ee 1.8553689987180662\nguess:6\u56de\u76ee 1.560512615640326\nguess:7\u56de\u76ee 1.8244440279220622\nguess:8\u56de\u76ee 1.575115962052684\n----------------------------------\n8 ^ 1 / 3 \u306e4\u91cd\u5e73\u5747\u7de9\u548c\n----------------------------------\nguess:1\u56de\u76ee 1.0\nguess:2\u56de\u76ee 1.28327359906296\nguess:3\u56de\u76ee 2.227954293124733\nguess:4\u56de\u76ee 1.2615306050241493\nguess:5\u56de\u76ee 2.1609515864967843\nguess:6\u56de\u76ee 1.2706420422133782\nguess:7\u56de\u76ee 2.192947191071957\nguess:8\u56de\u76ee 1.2662518335488215\n----------------------------------\n8 ^ 1 / 3 \u306e5\u91cd\u5e73\u5747\u7de9\u548c\n----------------------------------\nguess:1\u56de\u76ee 1.0\nguess:2\u56de\u76ee 1.1951167859192295\nguess:3\u56de\u76ee 2.2691905546161637\nguess:4\u56de\u76ee 1.1778909647032938\nguess:5\u56de\u76ee 2.025355582188155\nguess:6\u56de\u76ee 1.393915404078827\nguess:7\u56de\u76ee 1.6030012367264348\nguess:8\u56de\u76ee 1.2279607772464904\n==========================\n4\u4e57\u6839\n==========================\n----------------------------------\n16 ^ 1 / 4 \u306e1\u91cd\u5e73\u5747\u7de9\u548c\n----------------------------------\nguess:1\u56de\u76ee 1.0\nguess:2\u56de\u76ee 4.002257524798522\nguess:3\u56de\u76ee 4.0\n----------------------------------\n16 ^ 1 / 4 \u306e2\u91cd\u5e73\u5747\u7de9\u548c\n----------------------------------\nguess:1\u56de\u76ee 1.0\nguess:2\u56de\u76ee 2.4829963306881875\nguess:3\u56de\u76ee 2.5174777560877635\nguess:4\u56de\u76ee 2.5196940687432705\nguess:5\u56de\u76ee 2.519832846830349\n----------------------------------\n16 ^ 1 / 4 \u306e3\u91cd\u5e73\u5747\u7de9\u548c\n----------------------------------\nguess:1\u56de\u76ee 1.0\nguess:2\u56de\u76ee 1.8341723103276433\nguess:3\u56de\u76ee 1.8527375467627856\nguess:4\u56de\u76ee 1.8658611343368858\nguess:5\u56de\u76ee 1.875827463108303\nguess:6\u56de\u76ee 1.8837545613602775\nguess:7\u56de\u76ee 1.8902683221588625\nguess:8\u56de\u76ee 1.895752040837725\n----------------------------------\n16 ^ 1 / 4 \u306e4\u91cd\u5e73\u5747\u7de9\u548c\n----------------------------------\nguess:1\u56de\u76ee 1.0\nguess:2\u56de\u76ee 1.4493508391103145\nguess:3\u56de\u76ee 1.4519931178812753\nguess:4\u56de\u76ee 1.4536080602027628\nguess:5\u56de\u76ee 1.4545943546784106\nguess:6\u56de\u76ee 1.455195179157848\nguess:7\u56de\u76ee 1.4555603374021737\nguess:8\u56de\u76ee 1.4557818914922966\n----------------------------------\n16 ^ 1 / 4 \u306e5\u91cd\u5e73\u5747\u7de9\u548c\n----------------------------------\nguess:1\u56de\u76ee 1.0\nguess:2\u56de\u76ee 1.2475321803127808\nguess:3\u56de\u76ee 1.9040376089300204\nguess:4\u56de\u76ee 1.666016805952454\nguess:5\u56de\u76ee 3.1599408649420493\nguess:6\u56de\u76ee 1.4616166208630994\nguess:7\u56de\u76ee 1.5843404568698387\nguess:8\u56de\u76ee 1.540218409475213\n==========================\n5\u4e57\u6839\n==========================\n----------------------------------\n32 ^ 1 / 5 \u306e1\u91cd\u5e73\u5747\u7de9\u548c\n----------------------------------\nguess:1\u56de\u76ee 1.0\nguess:2\u56de\u76ee 5.65697670118682\nguess:3\u56de\u76ee 5.65685424949238\n----------------------------------\n32 ^ 1 / 5 \u306e2\u91cd\u5e73\u5747\u7de9\u548c\n----------------------------------\nguess:1\u56de\u76ee 1.0\nguess:2\u56de\u76ee 3.2611793503277537\nguess:3\u56de\u76ee 3.1722582719630483\nguess:4\u56de\u76ee 3.1748817299345116\n----------------------------------\n32 ^ 1 / 5 \u306e3\u91cd\u5e73\u5747\u7de9\u548c\n----------------------------------\nguess:1\u56de\u76ee 1.0\nguess:2\u56de\u76ee 2.464263577716512\nguess:3\u56de\u76ee 2.3026699635645205\nguess:4\u56de\u76ee 2.460267138779624\nguess:5\u56de\u76ee 2.305728778345352\nguess:6\u56de\u76ee 2.4567770089373733\nguess:7\u56de\u76ee 2.3084377997602075\nguess:8\u56de\u76ee 2.4536947950137824\n----------------------------------\n32 ^ 1 / 5 \u306e4\u91cd\u5e73\u5747\u7de9\u548c\n----------------------------------\nguess:1\u56de\u76ee 1.0\nguess:2\u56de\u76ee 1.8527388808054341\nguess:3\u56de\u76ee 2.986203929953016\nguess:4\u56de\u76ee 1.684603068446882\nguess:5\u56de\u76ee 2.8502360866346947\nguess:6\u56de\u76ee 1.6695442360756085\nguess:7\u56de\u76ee 2.8887323780143497\nguess:8\u56de\u76ee 1.6735434538049703\n----------------------------------\n32 ^ 1 / 5 \u306e5\u91cd\u5e73\u5747\u7de9\u548c\n----------------------------------\nguess:1\u56de\u76ee 1.0\nguess:2\u56de\u76ee 1.4528868735679294\nguess:3\u56de\u76ee 3.435041945724486\nguess:4\u56de\u76ee 1.4526447052333216\nguess:5\u56de\u76ee 3.4265251637273857\nguess:6\u56de\u76ee 1.4336537993747493\nguess:7\u56de\u76ee 2.5063074888395556\nguess:8\u56de\u76ee 1.829979040239805\n----------------------------------\n32 ^ 1 / 5 \u306e6\u91cd\u5e73\u5747\u7de9\u548c\n----------------------------------\nguess:1\u56de\u76ee 1.0\nguess:2\u56de\u76ee 1.238771352270022\nguess:3\u56de\u76ee 1.8227353362149372\nguess:4\u56de\u76ee 1.9525400393432408\nguess:5\u56de\u76ee 4.780617424956585\nguess:6\u56de\u76ee 1.2363480996581633\nguess:7\u56de\u76ee 1.76652059151728\nguess:8\u56de\u76ee 1.4114961694924677\n----------------------------------\n32 ^ 1 / 5 \u306e7\u91cd\u5e73\u5747\u7de9\u548c\n----------------------------------\nguess:1\u56de\u76ee 1.0\nguess:2\u56de\u76ee 1.1321524709422879\nguess:3\u56de\u76ee 6.539943947950366\nguess:4\u56de\u76ee 1.466902719615096\nguess:5\u56de\u76ee 1.6646927417487603\nguess:6\u56de\u76ee 4.484304705092539\nguess:7\u56de\u76ee 1.4331808312190746\nguess:8\u56de\u76ee 1.8924176928951446\n----------------------------------\n32 ^ 1 / 5 \u306e8\u91cd\u5e73\u5747\u7de9\u548c\n----------------------------------\nguess:1\u56de\u76ee 1.0\nguess:2\u56de\u76ee 1.0801710623656842\nguess:3\u56de\u76ee 5.215018392022435\nguess:4\u56de\u76ee 3.2415512094000114\nguess:5\u56de\u76ee 1.5007653145374489\nguess:6\u56de\u76ee 5.542008185531579\nguess:7\u56de\u76ee 12.058755661446032\nguess:8\u56de\u76ee 2.143355616495691\n----------------------------------\n32 ^ 1 / 5 \u306e9\u91cd\u5e73\u5747\u7de9\u548c\n----------------------------------\nguess:1\u56de\u76ee 1.0\nguess:2\u56de\u76ee 1.0549588781203105\nguess:3\u56de\u76ee 2.114424633995316\nguess:4\u56de\u76ee 1.1136325618984133\nguess:5\u56de\u76ee 16.786757179080805\nguess:6\u56de\u76ee 9.27611486764099\nguess:7\u56de\u76ee 2.2729115607246606\nguess:8\u56de\u76ee 2.008299076235135\n----------------------------------\n32 ^ 1 / 5 \u306e10\u91cd\u5e73\u5747\u7de9\u548c\n----------------------------------\nguess:1\u56de\u76ee 1.0\nguess:2\u56de\u76ee 1.0427412930632205\nguess:3\u56de\u76ee 1.3213126383907263\nguess:4\u56de\u76ee 8.168781903627231\nguess:5\u56de\u76ee 5.996862265689423\nguess:6\u56de\u76ee 6.317346815038818\nguess:7\u56de\u76ee 12.877405341365169\nguess:8\u56de\u76ee 29.6151176920096\n\n\n\n\n2\u4e57\u6839\uff1a1\u91cd\u5e73\u5747\u7de9\u548c\n\u3068\u3044\u3046\u306e\u304c\u6700\u521d\u306b\u308f\u304b\u3063\u3066\u3044\u305f\u5185\u5bb9\n3\u4e57\u6839\uff1a2\u91cd\u5e73\u5747\u7de9\u548c(\u3042\u308c\u3001SICP\u306b\u3088\u308b\u30681\u91cd\u5e73\u5747\u7de9\u548c\u3067\u3067\u304d\u308b\u306f\u305a\u30fb\u30fb\u30fb\n4\u4e57\u6839\u306f\u30013\u91cd\u306e\u5e73\u5747\u7de9\u548c\u3067\u305d\u308c\u3089\u3057\u3044\u5024\u306b\u306a\u308b (\u3042\u308c\u3001SICP\u306b\u3088\u308b\u30682\u91cd\u5e73\u5747\u7de9\u548c\u3067\u3067\u304d\u308b\u306f\u305a\u30fb\u30fb\u30fb\n5\u4e57\u6839\u306f\u7121\u7406\u3058\u3083\u306a\u3044\u304b\u30fb\u30fb\u30fb\n\nrepeat\u306en\u56de\u76een\u306e\u6570\u3048\u65b9\u304c\u304a\u304b\u3057\u3044\uff1f\n\u308f\u304b\u3089\u306a\u3059\u304e\u3066\u30ae\u30d6\u30a2\u30c3\u30d7\uff3c(^o^)\uff0f\n\n1.46\n\u5341\u5206\u306b\u306a\u308b\u307e\u3067\u6539\u5584\u3092\u7e70\u308a\u8fd4\u3059\u3088\u3046\u306a\u624b\u7d9a\u304d(\u53cd\u5fa9\u6539\u826f\u6cd5)\u3092\u8fd4\u3059\u624b\u7d9a\u304d\n(define (iterative-improve improve enough?)\n  (lambda (guess)\n    (define (iter guess)\n      (if (enough? guess)\n      guess\n      (iter (improve guess))))\n    (iter guess)))\n\n;; sqrt\n(define (sqrt x)\n  (define (enough? guess)\n    (< (abs (- (square guess) x)) 0.001))\n  (define (improve guess)\n    (average guess (/ x guess)))\n\n  (define (average x y) (/ (+ x y) 2))\n  ((iterative-improve improve enough?) 1.0))\n\n(print \"sqrt 2 = \" (sqrt 2)) ;; 1.4142156862745097\n(print \"sqrt 4 = \" (sqrt 4)) ;; 2.0000000929222947\n\n\n;; fix-point\n(define (fix-point f first-guess)\n  (define (enough? guess)\n    (< (abs (- guess (f guess))) 0.00001))\n  (f ((iterative-improve f enough?) first-guess)))\n\n\n;; golden ratio\n(define (g x)\n  (+ 1 (/ 1 x)))\n(print \"fix-point golden ratio = \" (fix-point g 1.0)) ;;1.6180327868852458\n\n\u53c2\u8003 - \u554f\u984c1.46 \u2013 SICP\uff08\u8a08\u7b97\u6a5f\u30d7\u30ed\u30b0\u30e9\u30e0\u306e\u69cb\u9020\u3068\u89e3\u91c8\uff09\u305d\u306e24 : Serendip - Web\u30c7\u30b6\u30a4\u30f3\u30fb\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\nga\n\n[\u30aa\u30f3\u30e9\u30a4\u30f3SICP\u8aad\u66f8\u5973\u5b50\u4f1a #12 (1.3.4)](http://ladiespp.connpass.com/event/32991/)\n\n## 1.40 newton\u6cd5\n\n```lisp\n(load \"./newtons-method.scm\")\n(define (cube x) (* x x x))\n\n; \u4e0d\u52d5\u70b9\u30d7\u30ed\u30bb\u30b9\u3067 x^3 + a*x^2 + b*x + c = 0 \u306e\u96f6\u70b9\u306e\u8fd1\u4f3c\u5024\u3092\u6c42\u3081\u308b\n(define (cubic a b c)\n  (lambda (x) (+ (cube x)\n\t\t (* a (square x))\n\t\t (* b x)\n\t\t c)))\n\n(newtons-method (cubic -3 3 -1) 1) ;1.0\n```\n\n\n\n## 1.41 \u624b\u7d9a\u304d\u3092\u4e8c\u56de\u9069\u7528\u3059\u308b\u624b\u7d9a\u304d\n\n```lisp\n(define (inc x) (+ x 1))\n\n(define (double f)\n  (lambda (x) (f (f x))))\n\n((double inc) 1) ; 3\n(((double (double double)) inc) 5) ; 21 (+16)\n```\n\n\n## 1.42\n\u95a2\u6570\u306e\u5408\u6210\u3092\u5b9f\u88c5\u3059\u308b\u624b\u7d9a\u304d\u3092compose\u3092\u5b9f\u88c5\u3059\u308b\n\nx -> f(g(x))\n\n```lisp\n;; 1.42\n\n(define (compose f g)\n  (lambda (x) (f (g x)) ))\n\n(define (square x) (* x x))\n(define (inc x) (+ x 1))\n((compose square inc) 6) ;; 49\n((compose square inc) 11) ;; 144\n```\n\n\n## 1.43\nn\u56def\u3092\u9069\u7528\u3059\u308b\u624b\u7d9a\u304d repeated\u3092\n\nf\u304csquare\u3060\u3063\u305f\u3089\u3001n\u56de\u9069\u7528\u3059\u308c\u3070\u5f15\u6570\u30922^n\u3059\u308b\u95a2\u6570\u306b\u306a\u308b\nf(f(......f(x)))\n\n```lisp\n;; 1.43\n(load \"./1.42.scm\")\n(define (inc x) (+ x 1))\n\n(define (repeated func n)\n  (if (= n 1)\n      func\n      (compose func (repeated func (- n 1)))))\n\n\n((repeated square 2) 5) ;; 625\n(time ((repeated inc 10000000) 1))\n; real   0.558\n; user   0.550\n; sys    0.000\n\n;; hio\u3055\u3093\u306e\u898b\u7fd2\u3046\n\n(define (repeated func n)\n  (cond ((= n 1)\n\t func)\n\t((= (remainder n 2) 1)\n\t (compose func (repeated func (- n 1))))\n\t(else\n\t (let ((f (repeated func (/ n 2))))\n\t   (compose f f)))\n\t))\n\n((repeated square 2) 5) ;; 625\n(time ((repeated inc 10000000) 1))\n; real   0.552\n; user   0.540\n; sys    0.000\n\n\n;; hio\u3055\u3093\u306e\u672b\u5c3e\u518d\u5e30\u7248\n(define (repeated f n)\n  (define (iter i val)\n    (if (>= i n)\n\tval\n\t(iter (+ i 1) (f val))))\n  (lambda (x) (iter 0 x)))\n(time ((repeated inc 10000000) 1))\n; real   0.476\n; user   0.480\n; sys    0.000\n;; \u305d\u3093\u306a\u6642\u9593\u304b\u308f\u3089\u306a\u3044\u306a\n;; \u3053\u308c\u3060\u3068\u624b\u7d9a\u304d\n```\n\n## 1.44\n\u5e73\u6ed1\u5316: dx\u304c\u5c0f\u3055\u306a\u5024\u3067\u3042\u308b\u3068\u304d\u3001 f(x - dx), f(x), f(x + dx) \u306e\u5e73\u5747\u3092\u3068\u3063\u305f\u3082\u306e\n\u5e73\u6ed1\u5316\u3057\u305f\u3082\u306e\u3092\u8a08\u7b97\u3059\u308bsmooth\u306e\u624b\u7d9a\u304d\u3092\u304b\u3051\u3002\n\u307e\u305f\u3001n\u91cd\u5e73\u6ed1\u5316\u95a2\u6570\u3092repeated\u3092\u4f7f\u3063\u3066\u793a\u3059\u3002\n\n```lisp\n;; 1.44\n(load \"./1.43.scm\")\n\n(define (smooth f)\n  (define dx 0.0001)\n  (lambda (x)\n    (/ (+ (f (- x dx)) (f x) (f (+ x dx))) 3) ))\n  \n((smooth square) 2) ;; 4.000000006666666\n\n(define (n-fold-smooth f n)\n  (repeated (smooth f) n))\n\n((n-fold-smooth square 4) 2) ;; 65536.00098646007 (2 ^ 16)\n\n```\n\n## 1.45 (\u672a\u89e3\u6c7a)\nn\u4e57\u6839\u3092\u6c42\u3081\u308b\n\n### source \n\n```lisp\n;; fixed-point\n(define tolerance 0.0001)\n(define max-recursion 8)\n(define (fixed-point f first-guess)\n  (define (close-enough? v1 v2)\n    (< (abs (- v1 v2)) tolerance))\n\n  (define (try guess i)\n    (print \"guess:\" i \"\u56de\u76ee \" guess)\n    (let ((next (f guess)))\n      (if (or (close-enough? guess next) (= i max-recursion))\n\t  next\n\t  (try next (+ i 1)))))\n  (try first-guess 1))\n\n(define (average-damp f)\n  (lambda (x) (/ (+ (f x) x) 2.0)))\n\n\n;; 2, 3\u4e57\u6839\n(define (nth-root x n)\n  (fixed-point\n   (average-damp (lambda (y) (/ x (expt y (- n 1))))) 1.0))\n\n;;(print (nth-root 100 2)) ;;10.0\n;;(print (nth-root 1000 3)) ;; 10.000002544054729\n;; (nth-root 10000 4) ;;\u7121\u9650\u306bfix\u305b\u305a\u3001\u3001\u3001\u3001\n\n\n;; 4\u4e57\u6839\u4ee5\u4e0a\n(define (repeated func n)\n  (if (= n 1)\n      func\n      (compose func (repeated func (- n 1)))))\n\n(define (repeated-nth-root x n m)\n  (fixed-point\n   (repeated (average-damp (lambda (y) (/ x (expt y (- n 1))))) m) 1.0))\n\n(define (try-repeat m n root)\n  (define (iter i)\n    (print \"----------------------------------\")\n    (print  m \" ^ 1 / \" root \" \u306e\" i \"\u91cd\u5e73\u5747\u7de9\u548c\")\n    (print \"----------------------------------\")\n    (repeated-nth-root m (+ i 1) root)\n    (if (= i n)\n\t0\n\t(iter (+ i 1))))\n  (iter 1))\n\n(print \"2\u306en\u4e57\u306en\u4e57\u6839\u3092\u3057\u3089\u3079\u308b\")\n\n(print \"==========================\")\n(print \"2\u4e57\u6839\")\n(print \"==========================\")\n(try-repeat (expt 2 2) 3 2)\n\n(print \"==========================\")\n(print \"3\u4e57\u6839\")\n(print \"==========================\")\n(try-repeat (expt 2 3) 5 3)\n\n(print \"==========================\")\n(print \"4\u4e57\u6839\")\n(print \"==========================\")\n(try-repeat (expt 2 4) 5 4)\n\n(print \"==========================\")\n(print \"5\u4e57\u6839\")\n(print \"==========================\")\n(try-repeat (expt 2 5) 10 5)\n```\n\n### \u7d50\u679c\n2\u306en\u4e57\u306en\u4e57\u6839\u3092\u3057\u3089\u3079\u308b\n\n```\n==========================\n2\u4e57\u6839\n==========================\n----------------------------------\n4 ^ 1 / 2 \u306e1\u91cd\u5e73\u5747\u7de9\u548c\n----------------------------------\nguess:1\u56de\u76ee 1.0\nguess:2\u56de\u76ee 2.05\nguess:3\u56de\u76ee 2.0000000929222947\n----------------------------------\n4 ^ 1 / 2 \u306e2\u91cd\u5e73\u5747\u7de9\u548c\n----------------------------------\nguess:1\u56de\u76ee 1.0\nguess:2\u56de\u76ee 1.57\nguess:3\u56de\u76ee 1.5829814190634435\nguess:4\u56de\u76ee 1.586291563873137\nguess:5\u56de\u76ee 1.5871233896905939\nguess:6\u56de\u76ee 1.5873316181944288\n----------------------------------\n4 ^ 1 / 2 \u306e3\u91cd\u5e73\u5747\u7de9\u548c\n----------------------------------\nguess:1\u56de\u76ee 1.0\nguess:2\u56de\u76ee 1.3780000000000001\nguess:3\u56de\u76ee 1.3781971576084833\nguess:4\u56de\u76ee 1.3783910746470118\nguess:5\u56de\u76ee 1.3785818395983083\nguess:6\u56de\u76ee 1.3787695375836293\nguess:7\u56de\u76ee 1.3789542505257217\nguess:8\u56de\u76ee 1.3791360573022022\n==========================\n3\u4e57\u6839\n==========================\n----------------------------------\n8 ^ 1 / 3 \u306e1\u91cd\u5e73\u5747\u7de9\u548c\n----------------------------------\nguess:1\u56de\u76ee 1.0\nguess:2\u56de\u76ee 2.843780727630285\nguess:3\u56de\u76ee 2.82842712474619\n----------------------------------\n8 ^ 1 / 3 \u306e2\u91cd\u5e73\u5747\u7de9\u548c\n----------------------------------\nguess:1\u56de\u76ee 1.0\nguess:2\u56de\u76ee 1.8914996576441667\nguess:3\u56de\u76ee 2.0151199754332096\nguess:4\u56de\u76ee 1.998142301706526\nguess:5\u56de\u76ee 2.0002326972862416\nguess:6\u56de\u76ee 1.999970920454376\n----------------------------------\n8 ^ 1 / 3 \u306e3\u91cd\u5e73\u5747\u7de9\u548c\n----------------------------------\nguess:1\u56de\u76ee 1.0\nguess:2\u56de\u76ee 1.478337540623817\nguess:3\u56de\u76ee 1.9239087525290877\nguess:4\u56de\u76ee 1.5363162465727038\nguess:5\u56de\u76ee 1.8553689987180662\nguess:6\u56de\u76ee 1.560512615640326\nguess:7\u56de\u76ee 1.8244440279220622\nguess:8\u56de\u76ee 1.575115962052684\n----------------------------------\n8 ^ 1 / 3 \u306e4\u91cd\u5e73\u5747\u7de9\u548c\n----------------------------------\nguess:1\u56de\u76ee 1.0\nguess:2\u56de\u76ee 1.28327359906296\nguess:3\u56de\u76ee 2.227954293124733\nguess:4\u56de\u76ee 1.2615306050241493\nguess:5\u56de\u76ee 2.1609515864967843\nguess:6\u56de\u76ee 1.2706420422133782\nguess:7\u56de\u76ee 2.192947191071957\nguess:8\u56de\u76ee 1.2662518335488215\n----------------------------------\n8 ^ 1 / 3 \u306e5\u91cd\u5e73\u5747\u7de9\u548c\n----------------------------------\nguess:1\u56de\u76ee 1.0\nguess:2\u56de\u76ee 1.1951167859192295\nguess:3\u56de\u76ee 2.2691905546161637\nguess:4\u56de\u76ee 1.1778909647032938\nguess:5\u56de\u76ee 2.025355582188155\nguess:6\u56de\u76ee 1.393915404078827\nguess:7\u56de\u76ee 1.6030012367264348\nguess:8\u56de\u76ee 1.2279607772464904\n==========================\n4\u4e57\u6839\n==========================\n----------------------------------\n16 ^ 1 / 4 \u306e1\u91cd\u5e73\u5747\u7de9\u548c\n----------------------------------\nguess:1\u56de\u76ee 1.0\nguess:2\u56de\u76ee 4.002257524798522\nguess:3\u56de\u76ee 4.0\n----------------------------------\n16 ^ 1 / 4 \u306e2\u91cd\u5e73\u5747\u7de9\u548c\n----------------------------------\nguess:1\u56de\u76ee 1.0\nguess:2\u56de\u76ee 2.4829963306881875\nguess:3\u56de\u76ee 2.5174777560877635\nguess:4\u56de\u76ee 2.5196940687432705\nguess:5\u56de\u76ee 2.519832846830349\n----------------------------------\n16 ^ 1 / 4 \u306e3\u91cd\u5e73\u5747\u7de9\u548c\n----------------------------------\nguess:1\u56de\u76ee 1.0\nguess:2\u56de\u76ee 1.8341723103276433\nguess:3\u56de\u76ee 1.8527375467627856\nguess:4\u56de\u76ee 1.8658611343368858\nguess:5\u56de\u76ee 1.875827463108303\nguess:6\u56de\u76ee 1.8837545613602775\nguess:7\u56de\u76ee 1.8902683221588625\nguess:8\u56de\u76ee 1.895752040837725\n----------------------------------\n16 ^ 1 / 4 \u306e4\u91cd\u5e73\u5747\u7de9\u548c\n----------------------------------\nguess:1\u56de\u76ee 1.0\nguess:2\u56de\u76ee 1.4493508391103145\nguess:3\u56de\u76ee 1.4519931178812753\nguess:4\u56de\u76ee 1.4536080602027628\nguess:5\u56de\u76ee 1.4545943546784106\nguess:6\u56de\u76ee 1.455195179157848\nguess:7\u56de\u76ee 1.4555603374021737\nguess:8\u56de\u76ee 1.4557818914922966\n----------------------------------\n16 ^ 1 / 4 \u306e5\u91cd\u5e73\u5747\u7de9\u548c\n----------------------------------\nguess:1\u56de\u76ee 1.0\nguess:2\u56de\u76ee 1.2475321803127808\nguess:3\u56de\u76ee 1.9040376089300204\nguess:4\u56de\u76ee 1.666016805952454\nguess:5\u56de\u76ee 3.1599408649420493\nguess:6\u56de\u76ee 1.4616166208630994\nguess:7\u56de\u76ee 1.5843404568698387\nguess:8\u56de\u76ee 1.540218409475213\n==========================\n5\u4e57\u6839\n==========================\n----------------------------------\n32 ^ 1 / 5 \u306e1\u91cd\u5e73\u5747\u7de9\u548c\n----------------------------------\nguess:1\u56de\u76ee 1.0\nguess:2\u56de\u76ee 5.65697670118682\nguess:3\u56de\u76ee 5.65685424949238\n----------------------------------\n32 ^ 1 / 5 \u306e2\u91cd\u5e73\u5747\u7de9\u548c\n----------------------------------\nguess:1\u56de\u76ee 1.0\nguess:2\u56de\u76ee 3.2611793503277537\nguess:3\u56de\u76ee 3.1722582719630483\nguess:4\u56de\u76ee 3.1748817299345116\n----------------------------------\n32 ^ 1 / 5 \u306e3\u91cd\u5e73\u5747\u7de9\u548c\n----------------------------------\nguess:1\u56de\u76ee 1.0\nguess:2\u56de\u76ee 2.464263577716512\nguess:3\u56de\u76ee 2.3026699635645205\nguess:4\u56de\u76ee 2.460267138779624\nguess:5\u56de\u76ee 2.305728778345352\nguess:6\u56de\u76ee 2.4567770089373733\nguess:7\u56de\u76ee 2.3084377997602075\nguess:8\u56de\u76ee 2.4536947950137824\n----------------------------------\n32 ^ 1 / 5 \u306e4\u91cd\u5e73\u5747\u7de9\u548c\n----------------------------------\nguess:1\u56de\u76ee 1.0\nguess:2\u56de\u76ee 1.8527388808054341\nguess:3\u56de\u76ee 2.986203929953016\nguess:4\u56de\u76ee 1.684603068446882\nguess:5\u56de\u76ee 2.8502360866346947\nguess:6\u56de\u76ee 1.6695442360756085\nguess:7\u56de\u76ee 2.8887323780143497\nguess:8\u56de\u76ee 1.6735434538049703\n----------------------------------\n32 ^ 1 / 5 \u306e5\u91cd\u5e73\u5747\u7de9\u548c\n----------------------------------\nguess:1\u56de\u76ee 1.0\nguess:2\u56de\u76ee 1.4528868735679294\nguess:3\u56de\u76ee 3.435041945724486\nguess:4\u56de\u76ee 1.4526447052333216\nguess:5\u56de\u76ee 3.4265251637273857\nguess:6\u56de\u76ee 1.4336537993747493\nguess:7\u56de\u76ee 2.5063074888395556\nguess:8\u56de\u76ee 1.829979040239805\n----------------------------------\n32 ^ 1 / 5 \u306e6\u91cd\u5e73\u5747\u7de9\u548c\n----------------------------------\nguess:1\u56de\u76ee 1.0\nguess:2\u56de\u76ee 1.238771352270022\nguess:3\u56de\u76ee 1.8227353362149372\nguess:4\u56de\u76ee 1.9525400393432408\nguess:5\u56de\u76ee 4.780617424956585\nguess:6\u56de\u76ee 1.2363480996581633\nguess:7\u56de\u76ee 1.76652059151728\nguess:8\u56de\u76ee 1.4114961694924677\n----------------------------------\n32 ^ 1 / 5 \u306e7\u91cd\u5e73\u5747\u7de9\u548c\n----------------------------------\nguess:1\u56de\u76ee 1.0\nguess:2\u56de\u76ee 1.1321524709422879\nguess:3\u56de\u76ee 6.539943947950366\nguess:4\u56de\u76ee 1.466902719615096\nguess:5\u56de\u76ee 1.6646927417487603\nguess:6\u56de\u76ee 4.484304705092539\nguess:7\u56de\u76ee 1.4331808312190746\nguess:8\u56de\u76ee 1.8924176928951446\n----------------------------------\n32 ^ 1 / 5 \u306e8\u91cd\u5e73\u5747\u7de9\u548c\n----------------------------------\nguess:1\u56de\u76ee 1.0\nguess:2\u56de\u76ee 1.0801710623656842\nguess:3\u56de\u76ee 5.215018392022435\nguess:4\u56de\u76ee 3.2415512094000114\nguess:5\u56de\u76ee 1.5007653145374489\nguess:6\u56de\u76ee 5.542008185531579\nguess:7\u56de\u76ee 12.058755661446032\nguess:8\u56de\u76ee 2.143355616495691\n----------------------------------\n32 ^ 1 / 5 \u306e9\u91cd\u5e73\u5747\u7de9\u548c\n----------------------------------\nguess:1\u56de\u76ee 1.0\nguess:2\u56de\u76ee 1.0549588781203105\nguess:3\u56de\u76ee 2.114424633995316\nguess:4\u56de\u76ee 1.1136325618984133\nguess:5\u56de\u76ee 16.786757179080805\nguess:6\u56de\u76ee 9.27611486764099\nguess:7\u56de\u76ee 2.2729115607246606\nguess:8\u56de\u76ee 2.008299076235135\n----------------------------------\n32 ^ 1 / 5 \u306e10\u91cd\u5e73\u5747\u7de9\u548c\n----------------------------------\nguess:1\u56de\u76ee 1.0\nguess:2\u56de\u76ee 1.0427412930632205\nguess:3\u56de\u76ee 1.3213126383907263\nguess:4\u56de\u76ee 8.168781903627231\nguess:5\u56de\u76ee 5.996862265689423\nguess:6\u56de\u76ee 6.317346815038818\nguess:7\u56de\u76ee 12.877405341365169\nguess:8\u56de\u76ee 29.6151176920096\n\n\n```\n\n\n- 2\u4e57\u6839\uff1a1\u91cd\u5e73\u5747\u7de9\u548c\n\u3068\u3044\u3046\u306e\u304c\u6700\u521d\u306b\u308f\u304b\u3063\u3066\u3044\u305f\u5185\u5bb9\n\n- 3\u4e57\u6839\uff1a2\u91cd\u5e73\u5747\u7de9\u548c(\u3042\u308c\u3001SICP\u306b\u3088\u308b\u30681\u91cd\u5e73\u5747\u7de9\u548c\u3067\u3067\u304d\u308b\u306f\u305a\u30fb\u30fb\u30fb\n- 4\u4e57\u6839\u306f\u30013\u91cd\u306e\u5e73\u5747\u7de9\u548c\u3067\u305d\u308c\u3089\u3057\u3044\u5024\u306b\u306a\u308b (\u3042\u308c\u3001SICP\u306b\u3088\u308b\u30682\u91cd\u5e73\u5747\u7de9\u548c\u3067\u3067\u304d\u308b\u306f\u305a\u30fb\u30fb\u30fb\n- 5\u4e57\u6839\u306f\u7121\u7406\u3058\u3083\u306a\u3044\u304b\u30fb\u30fb\u30fb\n\nrepeat\u306en\u56de\u76een\u306e\u6570\u3048\u65b9\u304c\u304a\u304b\u3057\u3044\uff1f\n\u308f\u304b\u3089\u306a\u3059\u304e\u3066\u30ae\u30d6\u30a2\u30c3\u30d7\uff3c(^o^)\uff0f\n\n\n## 1.46\n\n\u5341\u5206\u306b\u306a\u308b\u307e\u3067\u6539\u5584\u3092\u7e70\u308a\u8fd4\u3059\u3088\u3046\u306a\u624b\u7d9a\u304d(\u53cd\u5fa9\u6539\u826f\u6cd5)\u3092\u8fd4\u3059\u624b\u7d9a\u304d\n\n```lisp\n(define (iterative-improve improve enough?)\n  (lambda (guess)\n    (define (iter guess)\n      (if (enough? guess)\n\t  guess\n\t  (iter (improve guess))))\n    (iter guess)))\n\n;; sqrt\n(define (sqrt x)\n  (define (enough? guess)\n    (< (abs (- (square guess) x)) 0.001))\n  (define (improve guess)\n    (average guess (/ x guess)))\n\n  (define (average x y) (/ (+ x y) 2))\n  ((iterative-improve improve enough?) 1.0))\n\n(print \"sqrt 2 = \" (sqrt 2)) ;; 1.4142156862745097\n(print \"sqrt 4 = \" (sqrt 4)) ;; 2.0000000929222947\n\n\n;; fix-point\n(define (fix-point f first-guess)\n  (define (enough? guess)\n    (< (abs (- guess (f guess))) 0.00001))\n  (f ((iterative-improve f enough?) first-guess)))\n\n\n;; golden ratio\n(define (g x)\n  (+ 1 (/ 1 x)))\n(print \"fix-point golden ratio = \" (fix-point g 1.0)) ;;1.6180327868852458\n```\n\n[\u53c2\u8003 - \u554f\u984c1.46 \u2013 SICP\uff08\u8a08\u7b97\u6a5f\u30d7\u30ed\u30b0\u30e9\u30e0\u306e\u69cb\u9020\u3068\u89e3\u91c8\uff09\u305d\u306e24 : Serendip - Web\u30c7\u30b6\u30a4\u30f3\u30fb\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0](http://www.serendip.ws/archives/494)\nga\n"}