{"tags": ["PHP", "CSV", "\u6587\u5b57\u5316\u3051"], "context": "\u3053\u3093\u306b\u3061\u306f\nCSV \u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u30da\u30fc\u30b8\u3063\u3066\u6614\u306f\u6587\u5b57\u5316\u3051\u306b\u82e6\u3057\u3081\u3089\u308c\u3066\u3044\u305f\u30a4\u30e1\u30fc\u30b8\u304c\u3042\u308a\u307e\u3059\u304c\u3001\u6700\u8fd1\u306f\u3069\u3046\u306a\u306e\u3067\u3057\u3087\u3046\u3002\n\n\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\n\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u611f\u3058\u3067\u3001Windows / Mac \u3067\u5316\u3051\u307e\u305b\u3093\u3067\u3057\u305f\u3002\n\nCSV\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u30da\u30fc\u30b8\n<?php\nerror_reporting( -1 ) ;\nini_set( 'display_errors', 1 ) ;\n\n$csv_text = '\u334a,\u337b,\u9ad9,\u974d,\u6ff5,\ufa11,\u2460,\u2163' ;\n$csv_file_name = '\u3084\u3094\u3041\u3044\u6587\u5b57\u304c\u542b\u307e\u308c\u305f.csv' ;\n\n\nheader('Content-Type: text/csv') ;\nheader('Content-Disposition: attachment; filename=' . $csv_file_name . \"; filename*=UTF-8''\" . urlencode($csv_file_name)) ;\necho pack('C*',0xEF,0xBB,0xBF) . $csv_text ;\n\n\n\n\u304a\u308f\u308a\nContent-Type \u306b application/vnd.ms-excel \u3068\u304b application/octet-stream \u3068\u304b\u6307\u5b9a\u3057\u305f\u308a\u3001\nmb_convert_encoding() \u3067 SJIS-win\u306b\u5909\u63db\u3057\u305f\u308a\u3001\nMac\u7248Excel\u306e\u305f\u3081\u306bBOM\u4ed8\u304dUTF-16LE\u306b\u5909\u63db\u3057\u305f\u308a\u3001\n\u30d5\u30a1\u30a4\u30eb\u540d\u306f\u30a2\u30eb\u30d5\u30a1\u30d9\u30c3\u30c8\u3060\u3051\u306b\u5236\u9650\u3057\u305f\u308a\u3001\n\u2026\u3059\u308b\u6642\u4ee3\u306f\u7d42\u308f\u3063\u305f\u306e\u3060\u308d\u3046\u304b1\u3002\n\u3059\u3066\u304d 2\n\n\u53c2\u8003\u3068\u6ce8\u91c8\n\n\u3010PHP\u3011mb_convert_encoding\u3067UTF-8\u2192SJIS\u6587\u5b57\u5316\u3051\n\u3010php\u3011\u306f\u3057\u3054\u9ad8\u304c\u6587\u5b57\u5316\u3051\u3057\u306a\u3044\u6587\u5b57\u30b3\u30fc\u30c9\u5909\u63db\nPHP\u3067\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3055\u305b\u308b\u30d5\u30a1\u30a4\u30eb\u540d\u304cIE\u3067\u6587\u5b57\u5316\u3051\u3059\u308b\u4ef6 - Qiita\nExcel\u3067BOM\u4ed8\u304d\u304c\u7121\u53cc\u3059\u308bPHP\u3067\u306eCSV\u306e\u66f8\u304d\u51fa\u3057\u65b9\n\u30a8\u30af\u30bb\u30eb\u3067\u6587\u5b57\u5316\u3051\u3055\u305b\u306a\u3044CSV\u306e\u4f5c\u308a\u65b9\nPHP\u3067Excel\u3067\u958b\u3044\u3066\u3082\u6587\u5b57\u5316\u3051\u3057\u306a\u3044CSV\u3092\u51fa\u529b\u3059\u308b - Qiita\nList of HTTP header fields - Wikipedia\n\n\n\n\n\n\u3057\u304b\u3057Apache OpenOffice\u3067\u306f\u958b\u3051\u306a\u3044\u3068\u3044\u3046\u5642\u3092\u304d\u3044\u305f\u3053\u3068\u304c\u3042\u308b\u3002\u307b\u3093\u3068\uff1f\u00a0\u21a9\n\n\n\u8a73\u3057\u3044\u4eba\u9054\u306b\u5f8c\u308d\u304b\u3089\u523a\u3055\u308c\u305f\u3044\u3002\u00a0\u21a9\n\n\n\n\u3053\u3093\u306b\u3061\u306f:whale2:\nCSV \u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u30da\u30fc\u30b8\u3063\u3066\u6614\u306f\u6587\u5b57\u5316\u3051\u306b\u82e6\u3057\u3081\u3089\u308c\u3066\u3044\u305f\u30a4\u30e1\u30fc\u30b8\u304c\u3042\u308a\u307e\u3059\u304c\u3001\u6700\u8fd1\u306f\u3069\u3046\u306a\u306e\u3067\u3057\u3087\u3046\u3002\n\n### \u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\n\n\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u611f\u3058\u3067\u3001Windows / Mac \u3067\u5316\u3051\u307e\u305b\u3093\u3067\u3057\u305f\u3002\n\n```php:CSV\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u30da\u30fc\u30b8\n<?php\nerror_reporting( -1 ) ;\nini_set( 'display_errors', 1 ) ;\n\n$csv_text = '\u334a,\u337b,\u9ad9,\u974d,\u6ff5,\ufa11,\u2460,\u2163' ;\n$csv_file_name = '\u3084\u3094\u3041\u3044\u6587\u5b57\u304c\u542b\u307e\u308c\u305f.csv' ;\n\n\nheader('Content-Type: text/csv') ;\nheader('Content-Disposition: attachment; filename=' . $csv_file_name . \"; filename*=UTF-8''\" . urlencode($csv_file_name)) ;\necho pack('C*',0xEF,0xBB,0xBF) . $csv_text ;\n```\n\n### \u304a\u308f\u308a\n\nContent-Type \u306b `application/vnd.ms-excel` \u3068\u304b `application/octet-stream` \u3068\u304b\u6307\u5b9a\u3057\u305f\u308a\u3001\n[mb_convert_encoding()](http://php.net/manual/ja/function.mb-convert-encoding.php) \u3067 [SJIS-win](http://php.net/manual/ja/mbstring.supported-encodings.php)\u306b\u5909\u63db\u3057\u305f\u308a\u3001\nMac\u7248Excel\u306e\u305f\u3081\u306bBOM\u4ed8\u304dUTF-16LE\u306b\u5909\u63db\u3057\u305f\u308a\u3001\n\u30d5\u30a1\u30a4\u30eb\u540d\u306f\u30a2\u30eb\u30d5\u30a1\u30d9\u30c3\u30c8\u3060\u3051\u306b\u5236\u9650\u3057\u305f\u308a\u3001\n\u2026\u3059\u308b\u6642\u4ee3\u306f\u7d42\u308f\u3063\u305f\u306e\u3060\u308d\u3046\u304b[^maybe]\u3002\n\n\u3059\u3066\u304d:cherry_blossom: [^welcome]\n\n### \u53c2\u8003\u3068\u6ce8\u91c8\n\n* [\u3010PHP\u3011mb_convert_encoding\u3067UTF-8\u2192SJIS\u6587\u5b57\u5316\u3051](http://blog.so-lat.com/dev/2011/01/%E3%80%90php%E3%80%91mb_convert_encoding%E3%81%A7utf-8%E2%86%92sjis%E6%96%87%E5%AD%97%E5%8C%96%E3%81%91/)\n* [\u3010php\u3011\u306f\u3057\u3054\u9ad8\u304c\u6587\u5b57\u5316\u3051\u3057\u306a\u3044\u6587\u5b57\u30b3\u30fc\u30c9\u5909\u63db](https://www.softel.co.jp/blogs/tech/archives/5145)\n* [PHP\u3067\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3055\u305b\u308b\u30d5\u30a1\u30a4\u30eb\u540d\u304cIE\u3067\u6587\u5b57\u5316\u3051\u3059\u308b\u4ef6 - Qiita](http://qiita.com/takehironet/items/79c025e4140e29c57abe)\n* [Excel\u3067BOM\u4ed8\u304d\u304c\u7121\u53cc\u3059\u308bPHP\u3067\u306eCSV\u306e\u66f8\u304d\u51fa\u3057\u65b9](http://alaki.co.jp/blog/?p=1260)\n* [\u30a8\u30af\u30bb\u30eb\u3067\u6587\u5b57\u5316\u3051\u3055\u305b\u306a\u3044CSV\u306e\u4f5c\u308a\u65b9](http://dev.blog.fairway.ne.jp/php%E3%82%A8%E3%82%AF%E3%82%BB%E3%83%AB%E3%81%A7%E6%96%87%E5%AD%97%E5%8C%96%E3%81%91%E3%81%95%E3%81%9B%E3%81%AA%E3%81%84csv%E3%81%AE%E4%BD%9C%E3%82%8A%E6%96%B9/)\n* [PHP\u3067Excel\u3067\u958b\u3044\u3066\u3082\u6587\u5b57\u5316\u3051\u3057\u306a\u3044CSV\u3092\u51fa\u529b\u3059\u308b - Qiita](http://qiita.com/ikemonn/items/f2bc4f9f834c989084ff)\n* [List of HTTP header fields - Wikipedia](https://en.wikipedia.org/wiki/List_of_HTTP_header_fields)\n\n[^maybe]: \u3057\u304b\u3057[Apache OpenOffice](http://www.openoffice.org/ja/)\u3067\u306f\u958b\u3051\u306a\u3044\u3068\u3044\u3046\u5642\u3092\u304d\u3044\u305f\u3053\u3068\u304c\u3042\u308b\u3002\u307b\u3093\u3068\uff1f\n[^welcome]: \u8a73\u3057\u3044\u4eba\u9054\u306b\u5f8c\u308d\u304b\u3089\u523a\u3055\u308c\u305f\u3044\u3002:bow_and_arrow:\n"}