{"context": " More than 1 year has passed since last update.Exchange\u74b0\u5883\u3067\u30e1\u30fc\u30eb\u304b\u3089Redmine\u3078\u30c1\u30b1\u30c3\u30c8\u81ea\u52d5\u8ffd\u52a0\u3092\u3057\u305f\u3044\u3068\u601d\u3063\u305f\u304c\u3001\u306a\u304b\u306a\u304b\u65e2\u5b58\u306e\u60c5\u5831\u304b\u3089\u306f\u3046\u307e\u304f\u3044\u304b\u305a\u3001OutlookVBA\u3067\u76f4\u63a5Redmine\u306eRestAPI\u3092\u305f\u305f\u3044\u3066\u30c1\u30b1\u30c3\u30c8\u8ffd\u52a0\u3092\u8a66\u3057\u3066\u307f\u305f\u3002\n\u307e\u305a\u306f\u3001Redmine\u3067RestAPI\u3092\u6709\u52b9\u5316\u3059\u308b\u3002\n\u300c\u7ba1\u7406\u300d\u2192\u300c\u8a2d\u5b9a\u300d\u3068\u9032\u307f\u3001\u300cREST\u306b\u3088\u308bWeb\u30b5\u30fc\u30d3\u30b9\u3092\u6709\u52b9\u306b\u3059\u308b\u300d\u3092\u30c1\u30a7\u30c3\u30af\n\n\u305d\u306e\u3042\u3068\u3001\u500b\u4eba\u8a2d\u5b9a\u3078\u79fb\u308a\u53f3\u5074\u306eAPI\u30a2\u30af\u30bb\u30b9\u30ad\u30fc\u306e\u300c\u8868\u793a\u300d\u30ea\u30f3\u30af\u3092\u62bc\u3057\u3066\u3001\u30ad\u30fc\u3092\u53d6\u5f97\u3057\u3066\u304a\u304f\u3002\n\nOutlook\u3067\u66f8\u3044\u305fVBA\u30de\u30af\u30ed\u306f\u4ee5\u4e0b\u306e\u901a\u308a\n\nCustomRuleMakeTicket.vb\nOption Explicit\n\nConst REDMINE_API_KEY = \"<\u4e0a\u8a18\u3067\u53d6\u5f97\u3057\u305fAPI\u30ad\u30fc>\"\nConst REDMINE_URL = \"http://localhost/redmine\" '\u5bfe\u8c61Redmine\u3078\u306eURL\n\nConst PROJECT_ID = 1\n\nPublic Sub CustomRule_MakeTicket(Item As Outlook.MailItem)\n    Dim ReqStatus\n\n    ReqStatus = PostIssue(Item.Subject, Item.Body)\n\n    If ReqStatus <> False Then\n        MsgBox \"\u767b\u9332\u6210\u529f\"\n    Else\n        MsgBox \"\u767b\u9332\u5931\u6557\"\n    End If\nEnd Sub\n\n' PostIssue - Redmine\u306b\u30c1\u30b1\u30c3\u30c8\u3092\u767b\u9332\u3059\u308b\n'\n' [\u5f15\u6570]\n' Subject:  \u30c1\u30b1\u30c3\u30c8\u306e\u984c\u540d\n' Body:     \u30c1\u30b1\u30c3\u30c8\u306e\u5185\u5bb9\n'\n' [\u623b\u308a\u5024]\n' True:  \u6210\u529f\n' False: \u5931\u6557\n'\nFunction PostIssue(Subject As String, Body As String)\n    Dim xhr\n    Dim RequestURL As String\n    Dim RequestBody As String\n    Dim bPmary() As Byte\n\n    RequestURL = REDMINE_URL & \"/issues.xml?format=xml&key=\" &\nREDMINE_API_KEY\n\n    Set xhr = CreateObject(\"Microsoft.XMLHTTP\")\n    xhr.Open \"POST\", RequestURL, False\n    xhr.SetRequestHeader \"Content-Type\", \"text/xml\"\n\n    RequestBody = \"<?xml version=\" & Chr(34) & \"1.0\" & Chr(34) & \"?>\"\n    RequestBody = RequestBody & \"<issue>\"\n    RequestBody = RequestBody & \"<project_id>\" & PROJECT_ID & \"</project_id>\"\n    RequestBody = RequestBody & \"<subject>\" & Subject & \"</subject>\"\n    RequestBody = RequestBody & \"<description>\" & Body & \"</description>\"\n    RequestBody = RequestBody & \"</issue>\"\n\n    xhr.Send (RequestBody)\n\n    If xhr.Status = 201 Then\n        PostIssue = True\n    Else\n        PostIssue = False\n    End If\n\nEnd Function\n\n\n\u4e0a\u8a18\u306e\u30de\u30af\u30ed\u3092\u767b\u9332\u3057\u3066\u304a\u304d\u3001Outlook\u306e\u632f\u308a\u5206\u3051\u30eb\u30fc\u30eb\u3067\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u5b9f\u884c\u3059\u308b\u30a2\u30af\u30b7\u30e7\u30f3\u3092\u5b9a\u7fa9\u3057\u3001\u4e0a\u8a18\u306e\u30de\u30af\u30ed\u3092\u6307\u5b9a\u3059\u308c\u3070\u81ea\u52d5\u3067\u30c1\u30b1\u30c3\u30c8\u767b\u9332\u304c\u3067\u304d\u308b\u306f\u305a\nExchange\u74b0\u5883\u3067\u30e1\u30fc\u30eb\u304b\u3089Redmine\u3078\u30c1\u30b1\u30c3\u30c8\u81ea\u52d5\u8ffd\u52a0\u3092\u3057\u305f\u3044\u3068\u601d\u3063\u305f\u304c\u3001\u306a\u304b\u306a\u304b\u65e2\u5b58\u306e\u60c5\u5831\u304b\u3089\u306f\u3046\u307e\u304f\u3044\u304b\u305a\u3001OutlookVBA\u3067\u76f4\u63a5Redmine\u306eRestAPI\u3092\u305f\u305f\u3044\u3066\u30c1\u30b1\u30c3\u30c8\u8ffd\u52a0\u3092\u8a66\u3057\u3066\u307f\u305f\u3002\n\n\u307e\u305a\u306f\u3001Redmine\u3067RestAPI\u3092\u6709\u52b9\u5316\u3059\u308b\u3002\n\u300c\u7ba1\u7406\u300d\u2192\u300c\u8a2d\u5b9a\u300d\u3068\u9032\u307f\u3001\u300cREST\u306b\u3088\u308bWeb\u30b5\u30fc\u30d3\u30b9\u3092\u6709\u52b9\u306b\u3059\u308b\u300d\u3092\u30c1\u30a7\u30c3\u30af\n![01API\u6709\u52b9\u5316.png](https://qiita-image-store.s3.amazonaws.com/0/48177/b15814d8-a26e-b5bd-98c9-6f71b36c0a79.png)\n\n\u305d\u306e\u3042\u3068\u3001\u500b\u4eba\u8a2d\u5b9a\u3078\u79fb\u308a\u53f3\u5074\u306eAPI\u30a2\u30af\u30bb\u30b9\u30ad\u30fc\u306e\u300c\u8868\u793a\u300d\u30ea\u30f3\u30af\u3092\u62bc\u3057\u3066\u3001\u30ad\u30fc\u3092\u53d6\u5f97\u3057\u3066\u304a\u304f\u3002\n![02API\u30ad\u30fc\u53d6\u5f97.png](https://qiita-image-store.s3.amazonaws.com/0/48177/f3ed91db-07b9-8a4f-ea3b-76a56b1590a7.png)\n\nOutlook\u3067\u66f8\u3044\u305fVBA\u30de\u30af\u30ed\u306f\u4ee5\u4e0b\u306e\u901a\u308a\n\n```vbnet:CustomRuleMakeTicket.vb\nOption Explicit\n\nConst REDMINE_API_KEY = \"<\u4e0a\u8a18\u3067\u53d6\u5f97\u3057\u305fAPI\u30ad\u30fc>\"\nConst REDMINE_URL = \"http://localhost/redmine\" '\u5bfe\u8c61Redmine\u3078\u306eURL\n\nConst PROJECT_ID = 1\n\nPublic Sub CustomRule_MakeTicket(Item As Outlook.MailItem)\n    Dim ReqStatus\n\n    ReqStatus = PostIssue(Item.Subject, Item.Body)\n\n    If ReqStatus <> False Then\n        MsgBox \"\u767b\u9332\u6210\u529f\"\n    Else\n        MsgBox \"\u767b\u9332\u5931\u6557\"\n    End If\nEnd Sub\n\n' PostIssue - Redmine\u306b\u30c1\u30b1\u30c3\u30c8\u3092\u767b\u9332\u3059\u308b\n'\n' [\u5f15\u6570]\n' Subject:  \u30c1\u30b1\u30c3\u30c8\u306e\u984c\u540d\n' Body:     \u30c1\u30b1\u30c3\u30c8\u306e\u5185\u5bb9\n'\n' [\u623b\u308a\u5024]\n' True:  \u6210\u529f\n' False: \u5931\u6557\n'\nFunction PostIssue(Subject As String, Body As String)\n    Dim xhr\n    Dim RequestURL As String\n    Dim RequestBody As String\n    Dim bPmary() As Byte\n\n    RequestURL = REDMINE_URL & \"/issues.xml?format=xml&key=\" &\nREDMINE_API_KEY\n\n    Set xhr = CreateObject(\"Microsoft.XMLHTTP\")\n    xhr.Open \"POST\", RequestURL, False\n    xhr.SetRequestHeader \"Content-Type\", \"text/xml\"\n\n    RequestBody = \"<?xml version=\" & Chr(34) & \"1.0\" & Chr(34) & \"?>\"\n    RequestBody = RequestBody & \"<issue>\"\n    RequestBody = RequestBody & \"<project_id>\" & PROJECT_ID & \"</project_id>\"\n    RequestBody = RequestBody & \"<subject>\" & Subject & \"</subject>\"\n    RequestBody = RequestBody & \"<description>\" & Body & \"</description>\"\n    RequestBody = RequestBody & \"</issue>\"\n\n    xhr.Send (RequestBody)\n\n    If xhr.Status = 201 Then\n        PostIssue = True\n    Else\n        PostIssue = False\n    End If\n\nEnd Function\n```\n\n\u4e0a\u8a18\u306e\u30de\u30af\u30ed\u3092\u767b\u9332\u3057\u3066\u304a\u304d\u3001Outlook\u306e\u632f\u308a\u5206\u3051\u30eb\u30fc\u30eb\u3067\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u5b9f\u884c\u3059\u308b\u30a2\u30af\u30b7\u30e7\u30f3\u3092\u5b9a\u7fa9\u3057\u3001\u4e0a\u8a18\u306e\u30de\u30af\u30ed\u3092\u6307\u5b9a\u3059\u308c\u3070\u81ea\u52d5\u3067\u30c1\u30b1\u30c3\u30c8\u767b\u9332\u304c\u3067\u304d\u308b\u306f\u305a\n", "tags": ["Redmine2.5.2", "Outlook2010", "VBA"]}