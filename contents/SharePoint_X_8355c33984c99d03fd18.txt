{"context": "\u30d3\u30e5\u30fc\u306e\u8a2d\u5b9a\u753b\u9762\u3067\u3084\u308b\u3068\u9762\u5012\u3067\u9593\u9055\u3044\u3084\u3059\u3044\u3067\u3059\u3088\u306d\u3002\n// \u5f15\u6570\u306f\u3001\u30ea\u30b9\u30c8\u8868\u793a\u540d(ListName)\u3001\u30d3\u30e5\u30fc\u8868\u793a\u540d(ViewName)\u3001\u5217\u5185\u90e8\u540d\u306e\u914d\u5217(Fields)\nfunction changeViewFields(ListName, ViewName, Fields){\n\n    // \u30b3\u30f3\u30c6\u30ad\u30b9\u30c8\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u53d6\u5f97\n    var custCtx = SP.ClientContext.get_current();\n\n    // \u30b5\u30a4\u30c8\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u53d6\u5f97\u6307\u793a\n    var custWeb = custCtx.get_web();\n\n    // \u30ea\u30b9\u30c8\uff08\u30e9\u30a4\u30d6\u30e9\u30ea\uff09 \u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306e\u53d6\u5f97\u6307\u793a\n    var custList = custCtx.get_web().get_lists().getByTitle(ListName);\n\n    // \u30d3\u30e5\u30fc\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306e\u53d6\u5f97\u6307\u793a\n    var custView = custList.get_views().getByTitle(ViewName);\n    custCtx.load(custView);\n\n    // \u30d3\u30e5\u30fc\u8868\u793a\u5217\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306e\u53d6\u5f97\u6307\u793a\n    var custViewFields = custView.get_viewFields();\n    custCtx.load(custViewFields);\n\n    // \u53d6\u5f97\u5b9f\u884c\n    custCtx.executeQueryAsync(\n        function () { // \u6210\u529f\u6642\u30b3\u30fc\u30eb\u30d0\u30c3\u30af\n            // \u30d3\u30e5\u30fc\u306e\u8868\u793a\u5217\u3092\u521d\u671f\u5316\n            custViewFields.removeAll();\n\n            // \u30d3\u30e5\u30fc\u306e\u8868\u793a\u5217\u3092\u8ffd\u52a0\n            for(i = 0; i < Fields.length; i++) {\n                custViewFields.add(Fields[i]);\n            }\n\n            // \u30d3\u30e5\u30fc\u306e\u66f4\u65b0\u6307\u793a\n            custView.update();\n\n            // \u66f4\u65b0\u5b9f\u884c\n            custCtx.executeQueryAsync(\n                function () { // \u6210\u529f\u6642\u30b3\u30fc\u30eb\u30d0\u30c3\u30af\n                     alert('Change view [ ' + ListName + ' - ' + ViewName + ' ] fields complete.');\n                }, function (sender, args) { // \u5931\u6557\u6642\u30b3\u30fc\u30eb\u30d0\u30c3\u30af\n                     alert('Change view [ ' + ListName + ' - ' + ViewName + ' ] fields failed. ' + args.get_message() + '\\n' + args.get_stackTrace());\n                }\n            );\n        }, function (sender, args) { // \u5931\u6557\u6642\u30b3\u30fc\u30eb\u30d0\u30c3\u30af\n             alert('Get view [ ' + ListName + ' - ' + ViewName + ' ] fields failed. ' + args.get_message() + '\\n' + args.get_stackTrace());\n        }\n    );\n}\n\n// \u547c\u3073\u51fa\u3057\u4f8b\nchangeViewFields(\"\u304a\u3057\u3089\u305b\", \"\u3059\u3079\u3066\u306e\u30a2\u30a4\u30c6\u30e0\", ['Title',\u3000'Created',\u3000'Message']);\n\n\n\u30d3\u30e5\u30fc\u306e\u8a2d\u5b9a\u753b\u9762\u3067\u3084\u308b\u3068\u9762\u5012\u3067\u9593\u9055\u3044\u3084\u3059\u3044\u3067\u3059\u3088\u306d\u3002\n\n```\n// \u5f15\u6570\u306f\u3001\u30ea\u30b9\u30c8\u8868\u793a\u540d(ListName)\u3001\u30d3\u30e5\u30fc\u8868\u793a\u540d(ViewName)\u3001\u5217\u5185\u90e8\u540d\u306e\u914d\u5217(Fields)\nfunction changeViewFields(ListName, ViewName, Fields){\n\n\t// \u30b3\u30f3\u30c6\u30ad\u30b9\u30c8\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u53d6\u5f97\n\tvar custCtx = SP.ClientContext.get_current();\n\n\t// \u30b5\u30a4\u30c8\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u53d6\u5f97\u6307\u793a\n\tvar custWeb = custCtx.get_web();\n\n\t// \u30ea\u30b9\u30c8\uff08\u30e9\u30a4\u30d6\u30e9\u30ea\uff09 \u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306e\u53d6\u5f97\u6307\u793a\n\tvar custList = custCtx.get_web().get_lists().getByTitle(ListName);\n\n\t// \u30d3\u30e5\u30fc\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306e\u53d6\u5f97\u6307\u793a\n\tvar custView = custList.get_views().getByTitle(ViewName);\n\tcustCtx.load(custView);\n\n\t// \u30d3\u30e5\u30fc\u8868\u793a\u5217\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306e\u53d6\u5f97\u6307\u793a\n\tvar custViewFields = custView.get_viewFields();\n\tcustCtx.load(custViewFields);\n\n\t// \u53d6\u5f97\u5b9f\u884c\n\tcustCtx.executeQueryAsync(\n\t\tfunction () { // \u6210\u529f\u6642\u30b3\u30fc\u30eb\u30d0\u30c3\u30af\n\t\t\t// \u30d3\u30e5\u30fc\u306e\u8868\u793a\u5217\u3092\u521d\u671f\u5316\n\t\t\tcustViewFields.removeAll();\n\t\t\t\n\t\t\t// \u30d3\u30e5\u30fc\u306e\u8868\u793a\u5217\u3092\u8ffd\u52a0\n\t\t\tfor(i = 0; i < Fields.length; i++) {\n\t\t\t\tcustViewFields.add(Fields[i]);\n\t\t\t}\n\t\t\t\n\t\t\t// \u30d3\u30e5\u30fc\u306e\u66f4\u65b0\u6307\u793a\n\t\t\tcustView.update();\n\n\t\t\t// \u66f4\u65b0\u5b9f\u884c\n\t\t\tcustCtx.executeQueryAsync(\n\t\t\t\tfunction () { // \u6210\u529f\u6642\u30b3\u30fc\u30eb\u30d0\u30c3\u30af\n\t\t\t\t\t alert('Change view [ ' + ListName + ' - ' + ViewName + ' ] fields complete.');\n\t\t\t\t}, function (sender, args) { // \u5931\u6557\u6642\u30b3\u30fc\u30eb\u30d0\u30c3\u30af\n\t\t\t\t\t alert('Change view [ ' + ListName + ' - ' + ViewName + ' ] fields failed. ' + args.get_message() + '\\n' + args.get_stackTrace());\n\t\t\t\t}\n\t\t\t);\n\t\t}, function (sender, args) { // \u5931\u6557\u6642\u30b3\u30fc\u30eb\u30d0\u30c3\u30af\n\t\t\t alert('Get view [ ' + ListName + ' - ' + ViewName + ' ] fields failed. ' + args.get_message() + '\\n' + args.get_stackTrace());\n\t\t}\n\t);\n}\n```\n\n```\n// \u547c\u3073\u51fa\u3057\u4f8b\nchangeViewFields(\"\u304a\u3057\u3089\u305b\", \"\u3059\u3079\u3066\u306e\u30a2\u30a4\u30c6\u30e0\", ['Title',\u3000'Created',\u3000'Message']);\n```\n", "tags": ["CSOM", "JavaScript", "SharePoint"]}