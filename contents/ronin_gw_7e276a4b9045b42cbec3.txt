{"context": "bowtie2\u3067\u30de\u30eb\u30c1\u30de\u30c3\u30d7\u306f\u3069\u3046\u51e6\u7406\u3055\u308c\u308b\u306e\u304b \u3068\u3044\u3046\u8a71\u3002\n\n\u80cc\u666f\nbowtie2\u306e\u30c7\u30d5\u30a9\u30eb\u30c8\u306e\u6319\u52d5\u3067\u306f\u914d\u5217\u304cmultiple hit\u3057\u3066\u3082\u305d\u306e\u3046\u30611\u7b87\u6240\u3057\u304b\u5831\u544a\u3055\u308c\u306a\u3044\u3002\u3067\u306f\u305d\u306e1\u7b87\u6240\u306f\u3069\u3046\u9078\u3076\u306e\u304b\u3068\u3044\u3046\u3068\u3001\u666e\u901a\u306f\u30a2\u30e9\u30a4\u30e1\u30f3\u30c8\u30b9\u30b3\u30a2\u306e\u6700\u3082\u9ad8\u3044\u3082\u306e\u306e\u4e2d\u304b\u3089\u30e9\u30f3\u30c0\u30e0\u306b\u3001\u3067\u3042\u308b\u3002\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u306b\u3082\u305d\u3046\u66f8\u3044\u3066\u3042\u308b1\u3002\n\u2026\u306e\u3060\u304c\u5834\u5408\u306b\u3088\u3063\u3066\u306f\u30e9\u30f3\u30c0\u30e0\u306b\u306a\u3089\u305a\u56fa\u307e\u3063\u3066\u3057\u307e\u3046\u3089\u3057\u30442\u306e\u3067\u305d\u306e\u6761\u4ef6\u3092\u306f\u3063\u304d\u308a\u3055\u305b\u305f\u3044\u3002\n\u3068\u3044\u3063\u3066\u3082\u3053\u30532\u306b\u307b\u3068\u3093\u3069\u7d50\u8ad6\u304c\u66f8\u304b\u308c\u3066\u3044\u308b\u306e\u3060\u304c\u3001\u3053\u306e\u554f\u984c\u306fbowtie2\u306e\u4e71\u6570\u751f\u6210\u306b\u8d77\u56e0\u3057\u3066\u3044\u308b\u3002Bowtie2\u306e\u53d6\u6271\u8aac\u660e\u66f83\u306b\u3042\u308b--non-deterministic\u30aa\u30d7\u30b7\u30e7\u30f3\u306e\u9805\u306b\u6b21\u306e\u3088\u3046\u306a\u8aac\u660e\u304c\u3042\u308b\u3002\n\nNormally, Bowtie 2 re-initializes its pseudo-random generator for each read. It seeds the generator with a number derived from (a) the read name, (b) the nucleotide sequence, (c) the quality sequence, (d) the value of the --seed option. This means that if two reads are identical (same name, same nucleotides, same qualities) Bowtie 2 will find and report the same alignment(s) for both, even if there was ambiguity. When --non-deterministic is specified, Bowtie 2 re-initializes its pseudo-random generator for each read using the current time. This means that Bowtie 2 will not necessarily report the same alignment for two identical reads. This is counter-intuitive for some users, but might be more appropriate in situations where the input consists of many identical reads.\n\n\u307e\u3068\u3081\u308b\u3068\u3001bowtie2\u306f\u30ea\u30fc\u30c9\u3054\u3068\u306b\u4e71\u6570\u751f\u6210\u5668\u3092\u521d\u671f\u5316\u3057\u3066\u304a\u308a\u3001\u305d\u306e\u30b7\u30fc\u30c9\u5024\u306f\u6b21\u306e4\u3064\u306b\u4f9d\u5b58\u3057\u3066\u3044\u308b\u3088\u3046\u3060\u3002\n\n\u30ea\u30fc\u30c9\u306e\u540d\u524d\n\u5869\u57fa\u914d\u5217\n\u30af\u30aa\u30ea\u30c6\u30a3\u914d\u5217\n\n--seed\u30aa\u30d7\u30b7\u30e7\u30f3\u306e\u5024\n\n\u8981\u306f\u3001\u540d\u524d\u3082\u542b\u3081\u3066\u540c\u4e00\u306e\u60c5\u5831\u3092\u6301\u3064\u30ea\u30fc\u30c9\u306f\u540c\u3058\u5834\u6240\u306b\u30de\u30c3\u30d7\u3055\u308c\u308b\u3088\u3046\u306b\u3067\u304d\u3066\u3044\u308b\u3002\n\u4ee5\u4e0b\u3067\u306f\u30ea\u30fc\u30c9\u306e\u540d\u524d\u30fb\u30af\u30aa\u30ea\u30c6\u30a3\u914d\u5217\u30fb--seed\u30aa\u30d7\u30b7\u30e7\u30f3\u304c\u7570\u306a\u308c\u3070\u30de\u30c3\u30d4\u30f3\u30b0\u7d50\u679c\u3082\u7570\u306a\u308b\u3053\u3068\u3092\u78ba\u304b\u3081\u3088\u3046\u3002\n\n\u6e96\u5099\n\u30de\u30eb\u30c1\u30de\u30c3\u30d7\u3059\u308b\u5869\u57fa\u914d\u5217\u3092\u57fa\u306b\u3001\u6b21\u306e\u3088\u3046\u306aFASTQ\u3092\u7528\u610f\u3059\u308b\u3002\uff08\u914d\u5217\u7b49\u306f\u3053\u30532\u306e\u691c\u8a3c\u4f8b\u3092\u5143\u306b\u4f5c\u6210\uff09\n\n\u540d\u524d\u30fb\u5869\u57fa\u914d\u5217\u30fb\u30af\u30aa\u30ea\u30c6\u30a3\u914d\u5217\u306e\u5168\u3066\u304c\u540c\u4e00\u306a\u30ea\u30fc\u30c9\u3067\u3067\u304d\u305fFASTQ\n\u5869\u57fa\u914d\u5217\u306f\u540c\u3058\u3067\u3001\u540d\u524d\u30fb\u30af\u30aa\u30ea\u30c6\u30a3\u914d\u5217\u306e{\u3044\u305a\u308c\u304b or \u4e21\u65b9}\u304c\u30ea\u30fc\u30c9\u3054\u3068\u306b\u7570\u306a\u308bFASTQ\n\n\u3044\u3061\u3044\u3061\u7528\u610f\u3059\u308b\u306e\u306f\u9762\u5012\u306a\u306e\u3067\u6b21\u306e\u751f\u6210\u5668\u3067\u4ee3\u7528\u3059\u308b\u3002\n\ngen_testseq.py\n#!/usr/bin/env python\nimport argparse\nimport random\n\nparser = argparse.ArgumentParser()\nparser.add_argument(\"-r\", \"--reads\", type=int, default=10000)\nparser.add_argument(\"-n\", \"--name\", action=\"store_true\")\nparser.add_argument(\"-q\", \"--quality\", action=\"store_true\")\nargs = parser.parse_args()\n\nfor i in range(args.reads):\n    print \"@test_sequence{}\".format(random.random() if args.name else '')\n    print \"CAAAGTGTTTACTTTTGGATTTTTGCCAGTCTAACAGGTGAAGCCCTGGAGATTCTTATTAGTGATTTGGGCTGGGGCCTGGCCATGTGTATTTTTTTAAA\"\n    print '+'\n    print ''.join([chr(random.randrange(33, 127)) for _ in range(101)]) if args.quality else 'I' * 101\n\n\nprint2\u884c\u76ee\u306e\u914d\u5217\u3092hg19\u306b\u30de\u30c3\u30d4\u30f3\u30b0\u3059\u308b\u30689\u7b87\u6240\u306bmulti hit\u3057\u3001\u3046\u3061\u30a2\u30e9\u30a4\u30e1\u30f3\u30c8\u30b9\u30b3\u30a2\u304c\u6700\u3082\u9ad8\u304f\u30de\u30c3\u30d7\u5019\u88dc\u3068\u306a\u308b\u306e\u306f\u6b21\u306e3\u7b87\u6240\u3068\u306a\u308b\u3002\n\n\n\nchrom\nposition\nstrand\n\n\n\n\nchr1\n11635\n+\n\n\nchr2\n114359380\n-\n\n\nchr15\n102519535\n-\n\n\n\nbowtie2\u306f\u30d0\u30fc\u30b8\u30e7\u30f32.2.4\u3092\u4f7f\u7528\u3057\u305f\u3002\n\n\u691c\u8a3c\n\n\u30ea\u30fc\u30c9\u306e\u60c5\u5831\u304c\u5168\u3066\u540c\u4e00\u306aFASTQ\u306e\u5834\u5408\n\u3053\u3093\u306a\u611f\u3058\u3067\u30de\u30c3\u30d7\u7d50\u679c\u304b\u3089\u30dd\u30b8\u30b7\u30e7\u30f3\u3060\u3051\u53d6\u308a\u51fa\u3057\u3066\u500b\u6570\u3092\u30ab\u30a6\u30f3\u30c8\u3059\u308b\u3002\n$ bowtie2 --no-hd -x hg19 -U <(./gen_testseq.py) | cut -f 3-4 | sort | uniq -c\n\n\u7d50\u679c\n10000 reads; of these:\n  10000 (100.00%) were unpaired; of these:\n    0 (0.00%) aligned 0 times\n    0 (0.00%) aligned exactly 1 time\n    10000 (100.00%) aligned >1 times\n100.00% overall alignment rate\n  10000 chr15   102519435\n\n\u3059\u3079\u3066\u4e00\u7b87\u6240\u306b\u30de\u30c3\u30d7\u3055\u308c\u305f\u3002\n\n--seed\u30aa\u30d7\u30b7\u30e7\u30f3\u3092\u6307\u5b9a\u3057\u3066\u307f\u308b\n$ bowtie2 --no-hd --seed 17320508 -x hg19 -U <(./gen_testseq.py) | cut -f 3-4 | sort | uniq -c\n\n10000 reads; of these:\n  10000 (100.00%) were unpaired; of these:\n    0 (0.00%) aligned 0 times\n    0 (0.00%) aligned exactly 1 time\n    10000 (100.00%) aligned >1 times\n100.00% overall alignment rate\n  10000 chr1    11635\n\n\u5024\u306b\u3088\u3063\u3066\u306f\u5834\u6240\u304c\u5909\u308f\u308b\u3082\u306e\u306e\u3001\u30de\u30c3\u30d7\u3055\u308c\u308b\u306e\u306f\u4e00\u7b87\u6240\u3060\u3051\u3002\n\n--non-deterministic\u30aa\u30d7\u30b7\u30e7\u30f3\u3092\u6307\u5b9a\u3057\u3066\u307f\u308b\n$ bowtie2 --no-hd --non-deterministic -x hg19 -U <(./gen_testseq.py) | cut -f 3-4 | sort | uniq -c\n\n10000 reads; of these:\n  10000 (100.00%) were unpaired; of these:\n    0 (0.00%) aligned 0 times\n    0 (0.00%) aligned exactly 1 time\n    10000 (100.00%) aligned >1 times\n100.00% overall alignment rate\n   3302 chr1    11635\n   3379 chr15   102519435\n   3319 chr2    114359280\n\n\u4eca\u5ea6\u306f\u30e9\u30f3\u30c0\u30e0\u306b\u30de\u30c3\u30d7\u3055\u308c\u305f\u3002\u3082\u3061\u308d\u3093\u5b9f\u884c\u3059\u308b\u6bce\u306b\u7d50\u679c\u306f\u7570\u306a\u308b\u3002\n\n\u540d\u524d\u3084\u30af\u30aa\u30ea\u30c6\u30a3\u914d\u5217\u304c\u30ea\u30fc\u30c9\u3054\u3068\u306b\u7570\u306a\u308b\u5834\u5408\n$ bowtie2 --no-hd -x hg19 -U <(./gen_testseq.py -n) | cut -f 3-4 | sort | uniq -c\n\n10000 reads; of these:\n  10000 (100.00%) were unpaired; of these:\n    0 (0.00%) aligned 0 times\n    0 (0.00%) aligned exactly 1 time\n    10000 (100.00%) aligned >1 times\n100.00% overall alignment rate\n   3379 chr1    11635\n   3294 chr15   102519435\n   3327 chr2    114359280\n\n\u4eca\u5ea6\u306f\u30e9\u30f3\u30c0\u30e0\u306b\u30de\u30c3\u30d7\u3055\u308c\u305f\u3002\u3053\u3053\u3067\u3001\n$ ./gen_testseq.py -n > test.fastq\n$ bowtie2 --no-hd -x hg19 -U test.fastq | cut -f 3-4 | sort | uniq -c\n\n\u4e0a\u8a18\u306e\u3088\u3046\u306b\u4e00\u5ea6\u30d5\u30a1\u30a4\u30eb\u306b\u843d\u3068\u3057\u305f\u5834\u5408\u306f\u5b9f\u884c\u6642\u6bce\u306b\u540c\u3058\u7d50\u679c\u304c\u5f97\u3089\u308c\u308b\u3002\u3082\u3061\u308d\u3093--seed\u30aa\u30d7\u30b7\u30e7\u30f3\u306e\u5024\u304c\u7570\u306a\u308b\u5834\u5408\u3084--non-deterministic\u30aa\u30d7\u30b7\u30e7\u30f3\u3092\u6307\u5b9a\u3057\u305f\u5834\u5408\u306f\u3053\u306e\u9650\u308a\u3067\u306f\u306a\u3044\u3002\n\u30af\u30aa\u30ea\u30c6\u30a3\u914d\u5217\u304c\u7570\u306a\u308b\u5834\u5408\u3082\u30e9\u30f3\u30c0\u30e0\u306b\u30de\u30c3\u30d7\u3055\u308c\u308b\n$ bowtie2 --no-hd -x hg19 -U <(./gen_testseq.py -q) | cut -f 3-4 | sort | uniq -c\n\n10000 reads; of these:\n  10000 (100.00%) were unpaired; of these:\n    0 (0.00%) aligned 0 times\n    0 (0.00%) aligned exactly 1 time\n    10000 (100.00%) aligned >1 times\n100.00% overall alignment rate\n   3351 chr1    11635\n   3312 chr15   102519435\n   3337 chr2    114359280\n\n\n\u7d50\u8ad6\n\n\u666e\u901a\u306f\u30e9\u30f3\u30c0\u30e0\u306b\u30de\u30c3\u30d7\u5148\u304c\u9078\u3070\u308c\u308b\u3068\u8003\u3048\u3066\u3088\u3044\uff08\u914d\u5217\u306b\u52a0\u3048\u3066\u30ea\u30fc\u30c9\u540d\u307e\u3067\u91cd\u8907\u3059\u308b\u72b6\u6cc1\u304c\u3042\u307e\u308a\u8003\u3048\u3089\u308c\u306a\u3044\uff09\u3002\n\u540c\u4e00\u306a\u30ea\u30fc\u30c9\u304c\u542b\u307e\u308c\u308b\u5834\u5408\u306f--non-deterministic\u30aa\u30d7\u30b7\u30e7\u30f3\u3092\u4f7f\u7528\u3059\u308b\u3053\u3068\u3067\u30e9\u30f3\u30c0\u30e0\u306b\u30de\u30c3\u30d7\u3055\u308c\u308b\u3002\n\n\n\u305f\u3060\u3057\u518d\u73fe\u6027\u306f\u5931\u308f\u308c\u308b\u3002\n\u30de\u30eb\u30c1\u30de\u30c3\u30d7\u5148\u304c\u7570\u306a\u308b\u7d50\u679c\u304c\u5fc5\u8981\u3067\u518d\u73fe\u6027\u3092\u78ba\u4fdd\u3057\u305f\u3044\u5834\u5408\u306f--seed\u30aa\u30d7\u30b7\u30e7\u30f3\u3092\u4f7f\u3046\u3002\n\n\n\n\n\u53c2\u8003\n\u3046\u307e\u304f\u3070\u3089\u3064\u304b\u306a\u3044\u5834\u5408\u304c\u4ee5\u524d\u3042\u3063\u305f\u3089\u3057\u30442\u3051\u3069\u30d0\u30b0\u3060\u3063\u305f\u306e\u3060\u308d\u3046\u304b\n\n\n\n\n-k\u30aa\u30d7\u30b7\u30e7\u30f3\u306e\u9805\u3092\u53c2\u7167\u306e\u3053\u30683\u00a0\u21a9\n\n\nBiostars: ATTENTION: bowtie2 and multiple hits / (SEQanswers)\u00a0\u21a9\n\n\nBowtie2 manual\u00a0\u21a9\n\n\n\nbowtie2\u3067\u30de\u30eb\u30c1\u30de\u30c3\u30d7\u306f\u3069\u3046\u51e6\u7406\u3055\u308c\u308b\u306e\u304b \u3068\u3044\u3046\u8a71\u3002\n\n# \u80cc\u666f\nbowtie2\u306e\u30c7\u30d5\u30a9\u30eb\u30c8\u306e\u6319\u52d5\u3067\u306f\u914d\u5217\u304cmultiple hit\u3057\u3066\u3082\u305d\u306e\u3046\u30611\u7b87\u6240\u3057\u304b\u5831\u544a\u3055\u308c\u306a\u3044\u3002\u3067\u306f\u305d\u306e1\u7b87\u6240\u306f\u3069\u3046\u9078\u3076\u306e\u304b\u3068\u3044\u3046\u3068\u3001\u666e\u901a\u306f\u30a2\u30e9\u30a4\u30e1\u30f3\u30c8\u30b9\u30b3\u30a2\u306e\u6700\u3082\u9ad8\u3044\u3082\u306e\u306e\u4e2d\u304b\u3089\u30e9\u30f3\u30c0\u30e0\u306b\u3001\u3067\u3042\u308b\u3002\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u306b\u3082\u305d\u3046\u66f8\u3044\u3066\u3042\u308b[^1]\u3002\n\u2026\u306e\u3060\u304c\u5834\u5408\u306b\u3088\u3063\u3066\u306f\u30e9\u30f3\u30c0\u30e0\u306b\u306a\u3089\u305a\u56fa\u307e\u3063\u3066\u3057\u307e\u3046\u3089\u3057\u3044[^2]\u306e\u3067\u305d\u306e\u6761\u4ef6\u3092\u306f\u3063\u304d\u308a\u3055\u305b\u305f\u3044\u3002\n\n\u3068\u3044\u3063\u3066\u3082\u3053\u3053[^2]\u306b\u307b\u3068\u3093\u3069\u7d50\u8ad6\u304c\u66f8\u304b\u308c\u3066\u3044\u308b\u306e\u3060\u304c\u3001\u3053\u306e\u554f\u984c\u306fbowtie2\u306e\u4e71\u6570\u751f\u6210\u306b\u8d77\u56e0\u3057\u3066\u3044\u308b\u3002Bowtie2\u306e\u53d6\u6271\u8aac\u660e\u66f8[^3]\u306b\u3042\u308b`--non-deterministic`\u30aa\u30d7\u30b7\u30e7\u30f3\u306e\u9805\u306b\u6b21\u306e\u3088\u3046\u306a\u8aac\u660e\u304c\u3042\u308b\u3002\n> Normally, Bowtie 2 re-initializes its pseudo-random generator for each read. It seeds the generator with a number derived from (a) the read name, (b) the nucleotide sequence, (c) the quality sequence, (d) the value of the `--seed` option. This means that if two reads are identical (same name, same nucleotides, same qualities) Bowtie 2 will find and report the same alignment(s) for both, even if there was ambiguity. When `--non-deterministic` is specified, Bowtie 2 re-initializes its pseudo-random generator for each read using the current time. This means that Bowtie 2 will not necessarily report the same alignment for two identical reads. This is counter-intuitive for some users, but might be more appropriate in situations where the input consists of many identical reads.\n\n\u307e\u3068\u3081\u308b\u3068\u3001bowtie2\u306f\u30ea\u30fc\u30c9\u3054\u3068\u306b\u4e71\u6570\u751f\u6210\u5668\u3092\u521d\u671f\u5316\u3057\u3066\u304a\u308a\u3001\u305d\u306e\u30b7\u30fc\u30c9\u5024\u306f\u6b21\u306e4\u3064\u306b\u4f9d\u5b58\u3057\u3066\u3044\u308b\u3088\u3046\u3060\u3002\n\n- \u30ea\u30fc\u30c9\u306e\u540d\u524d\n- \u5869\u57fa\u914d\u5217\n- \u30af\u30aa\u30ea\u30c6\u30a3\u914d\u5217\n- `--seed`\u30aa\u30d7\u30b7\u30e7\u30f3\u306e\u5024\n\n\u8981\u306f\u3001__\u540d\u524d\u3082\u542b\u3081\u3066\u540c\u4e00\u306e\u60c5\u5831\u3092\u6301\u3064\u30ea\u30fc\u30c9\u306f\u540c\u3058\u5834\u6240\u306b\u30de\u30c3\u30d7\u3055\u308c\u308b__\u3088\u3046\u306b\u3067\u304d\u3066\u3044\u308b\u3002\n\u4ee5\u4e0b\u3067\u306f`\u30ea\u30fc\u30c9\u306e\u540d\u524d`\u30fb`\u30af\u30aa\u30ea\u30c6\u30a3\u914d\u5217`\u30fb`--seed\u30aa\u30d7\u30b7\u30e7\u30f3`\u304c\u7570\u306a\u308c\u3070\u30de\u30c3\u30d4\u30f3\u30b0\u7d50\u679c\u3082\u7570\u306a\u308b\u3053\u3068\u3092\u78ba\u304b\u3081\u3088\u3046\u3002\n\n\n# \u6e96\u5099\n\u30de\u30eb\u30c1\u30de\u30c3\u30d7\u3059\u308b\u5869\u57fa\u914d\u5217\u3092\u57fa\u306b\u3001\u6b21\u306e\u3088\u3046\u306aFASTQ\u3092\u7528\u610f\u3059\u308b\u3002\uff08\u914d\u5217\u7b49\u306f\u3053\u3053[^2]\u306e\u691c\u8a3c\u4f8b\u3092\u5143\u306b\u4f5c\u6210\uff09\n\n- \u540d\u524d\u30fb\u5869\u57fa\u914d\u5217\u30fb\u30af\u30aa\u30ea\u30c6\u30a3\u914d\u5217\u306e\u5168\u3066\u304c\u540c\u4e00\u306a\u30ea\u30fc\u30c9\u3067\u3067\u304d\u305fFASTQ\n- \u5869\u57fa\u914d\u5217\u306f\u540c\u3058\u3067\u3001\u540d\u524d\u30fb\u30af\u30aa\u30ea\u30c6\u30a3\u914d\u5217\u306e{\u3044\u305a\u308c\u304b or \u4e21\u65b9}\u304c\u30ea\u30fc\u30c9\u3054\u3068\u306b\u7570\u306a\u308bFASTQ\n\n\u3044\u3061\u3044\u3061\u7528\u610f\u3059\u308b\u306e\u306f\u9762\u5012\u306a\u306e\u3067\u6b21\u306e\u751f\u6210\u5668\u3067\u4ee3\u7528\u3059\u308b\u3002\n\n```py:gen_testseq.py\n#!/usr/bin/env python\nimport argparse\nimport random\n\nparser = argparse.ArgumentParser()\nparser.add_argument(\"-r\", \"--reads\", type=int, default=10000)\nparser.add_argument(\"-n\", \"--name\", action=\"store_true\")\nparser.add_argument(\"-q\", \"--quality\", action=\"store_true\")\nargs = parser.parse_args()\n\nfor i in range(args.reads):\n    print \"@test_sequence{}\".format(random.random() if args.name else '')\n    print \"CAAAGTGTTTACTTTTGGATTTTTGCCAGTCTAACAGGTGAAGCCCTGGAGATTCTTATTAGTGATTTGGGCTGGGGCCTGGCCATGTGTATTTTTTTAAA\"\n    print '+'\n    print ''.join([chr(random.randrange(33, 127)) for _ in range(101)]) if args.quality else 'I' * 101\n```\nprint2\u884c\u76ee\u306e\u914d\u5217\u3092hg19\u306b\u30de\u30c3\u30d4\u30f3\u30b0\u3059\u308b\u30689\u7b87\u6240\u306bmulti hit\u3057\u3001\u3046\u3061\u30a2\u30e9\u30a4\u30e1\u30f3\u30c8\u30b9\u30b3\u30a2\u304c\u6700\u3082\u9ad8\u304f\u30de\u30c3\u30d7\u5019\u88dc\u3068\u306a\u308b\u306e\u306f\u6b21\u306e3\u7b87\u6240\u3068\u306a\u308b\u3002\n\n| chrom |  position  | strand |\n|:------|-----------:|:------:|\n|chr1   |      11635 |    +   |\n|chr2   |  114359380 |    -   |\n|chr15  |  102519535 |    -   |\n\nbowtie2\u306f\u30d0\u30fc\u30b8\u30e7\u30f32.2.4\u3092\u4f7f\u7528\u3057\u305f\u3002\n\n\n# \u691c\u8a3c\n## \u30ea\u30fc\u30c9\u306e\u60c5\u5831\u304c\u5168\u3066\u540c\u4e00\u306aFASTQ\u306e\u5834\u5408\n\u3053\u3093\u306a\u611f\u3058\u3067\u30de\u30c3\u30d7\u7d50\u679c\u304b\u3089\u30dd\u30b8\u30b7\u30e7\u30f3\u3060\u3051\u53d6\u308a\u51fa\u3057\u3066\u500b\u6570\u3092\u30ab\u30a6\u30f3\u30c8\u3059\u308b\u3002\n\n```zsh\n$ bowtie2 --no-hd -x hg19 -U <(./gen_testseq.py) | cut -f 3-4 | sort | uniq -c\n```\n\u7d50\u679c\n\n```\n10000 reads; of these:\n  10000 (100.00%) were unpaired; of these:\n    0 (0.00%) aligned 0 times\n    0 (0.00%) aligned exactly 1 time\n    10000 (100.00%) aligned >1 times\n100.00% overall alignment rate\n  10000 chr15\t102519435\n```\n\u3059\u3079\u3066\u4e00\u7b87\u6240\u306b\u30de\u30c3\u30d7\u3055\u308c\u305f\u3002\n\n### `--seed`\u30aa\u30d7\u30b7\u30e7\u30f3\u3092\u6307\u5b9a\u3057\u3066\u307f\u308b\n\n```zsh\n$ bowtie2 --no-hd --seed 17320508 -x hg19 -U <(./gen_testseq.py) | cut -f 3-4 | sort | uniq -c\n```\n```\n10000 reads; of these:\n  10000 (100.00%) were unpaired; of these:\n    0 (0.00%) aligned 0 times\n    0 (0.00%) aligned exactly 1 time\n    10000 (100.00%) aligned >1 times\n100.00% overall alignment rate\n  10000 chr1\t11635\n```\n\n\u5024\u306b\u3088\u3063\u3066\u306f\u5834\u6240\u304c\u5909\u308f\u308b\u3082\u306e\u306e\u3001\u30de\u30c3\u30d7\u3055\u308c\u308b\u306e\u306f\u4e00\u7b87\u6240\u3060\u3051\u3002\n\n### `--non-deterministic`\u30aa\u30d7\u30b7\u30e7\u30f3\u3092\u6307\u5b9a\u3057\u3066\u307f\u308b\n\n```zsh\n$ bowtie2 --no-hd --non-deterministic -x hg19 -U <(./gen_testseq.py) | cut -f 3-4 | sort | uniq -c\n```\n```\n10000 reads; of these:\n  10000 (100.00%) were unpaired; of these:\n    0 (0.00%) aligned 0 times\n    0 (0.00%) aligned exactly 1 time\n    10000 (100.00%) aligned >1 times\n100.00% overall alignment rate\n   3302 chr1\t11635\n   3379 chr15\t102519435\n   3319 chr2\t114359280\n```\n\n\u4eca\u5ea6\u306f\u30e9\u30f3\u30c0\u30e0\u306b\u30de\u30c3\u30d7\u3055\u308c\u305f\u3002\u3082\u3061\u308d\u3093\u5b9f\u884c\u3059\u308b\u6bce\u306b\u7d50\u679c\u306f\u7570\u306a\u308b\u3002\n\n\n## \u540d\u524d\u3084\u30af\u30aa\u30ea\u30c6\u30a3\u914d\u5217\u304c\u30ea\u30fc\u30c9\u3054\u3068\u306b\u7570\u306a\u308b\u5834\u5408\n```zsh\n$ bowtie2 --no-hd -x hg19 -U <(./gen_testseq.py -n) | cut -f 3-4 | sort | uniq -c\n```\n```\n10000 reads; of these:\n  10000 (100.00%) were unpaired; of these:\n    0 (0.00%) aligned 0 times\n    0 (0.00%) aligned exactly 1 time\n    10000 (100.00%) aligned >1 times\n100.00% overall alignment rate\n   3379 chr1\t11635\n   3294 chr15\t102519435\n   3327 chr2\t114359280\n```\n\n\u4eca\u5ea6\u306f\u30e9\u30f3\u30c0\u30e0\u306b\u30de\u30c3\u30d7\u3055\u308c\u305f\u3002\u3053\u3053\u3067\u3001\n\n```zsh\n$ ./gen_testseq.py -n > test.fastq\n$ bowtie2 --no-hd -x hg19 -U test.fastq | cut -f 3-4 | sort | uniq -c\n```\n\n\u4e0a\u8a18\u306e\u3088\u3046\u306b\u4e00\u5ea6\u30d5\u30a1\u30a4\u30eb\u306b\u843d\u3068\u3057\u305f\u5834\u5408\u306f\u5b9f\u884c\u6642\u6bce\u306b\u540c\u3058\u7d50\u679c\u304c\u5f97\u3089\u308c\u308b\u3002\u3082\u3061\u308d\u3093`--seed`\u30aa\u30d7\u30b7\u30e7\u30f3\u306e\u5024\u304c\u7570\u306a\u308b\u5834\u5408\u3084`--non-deterministic`\u30aa\u30d7\u30b7\u30e7\u30f3\u3092\u6307\u5b9a\u3057\u305f\u5834\u5408\u306f\u3053\u306e\u9650\u308a\u3067\u306f\u306a\u3044\u3002\n\n\u30af\u30aa\u30ea\u30c6\u30a3\u914d\u5217\u304c\u7570\u306a\u308b\u5834\u5408\u3082\u30e9\u30f3\u30c0\u30e0\u306b\u30de\u30c3\u30d7\u3055\u308c\u308b\n\n```zsh\n$ bowtie2 --no-hd -x hg19 -U <(./gen_testseq.py -q) | cut -f 3-4 | sort | uniq -c\n```\n```\n10000 reads; of these:\n  10000 (100.00%) were unpaired; of these:\n    0 (0.00%) aligned 0 times\n    0 (0.00%) aligned exactly 1 time\n    10000 (100.00%) aligned >1 times\n100.00% overall alignment rate\n   3351 chr1\t11635\n   3312 chr15\t102519435\n   3337 chr2\t114359280\n```\n\n\n# \u7d50\u8ad6\n- \u666e\u901a\u306f\u30e9\u30f3\u30c0\u30e0\u306b\u30de\u30c3\u30d7\u5148\u304c\u9078\u3070\u308c\u308b\u3068\u8003\u3048\u3066\u3088\u3044\uff08\u914d\u5217\u306b\u52a0\u3048\u3066\u30ea\u30fc\u30c9\u540d\u307e\u3067\u91cd\u8907\u3059\u308b\u72b6\u6cc1\u304c\u3042\u307e\u308a\u8003\u3048\u3089\u308c\u306a\u3044\uff09\u3002\n- \u540c\u4e00\u306a\u30ea\u30fc\u30c9\u304c\u542b\u307e\u308c\u308b\u5834\u5408\u306f`--non-deterministic`\u30aa\u30d7\u30b7\u30e7\u30f3\u3092\u4f7f\u7528\u3059\u308b\u3053\u3068\u3067\u30e9\u30f3\u30c0\u30e0\u306b\u30de\u30c3\u30d7\u3055\u308c\u308b\u3002\n - \u305f\u3060\u3057\u518d\u73fe\u6027\u306f\u5931\u308f\u308c\u308b\u3002\n - \u30de\u30eb\u30c1\u30de\u30c3\u30d7\u5148\u304c\u7570\u306a\u308b\u7d50\u679c\u304c\u5fc5\u8981\u3067\u518d\u73fe\u6027\u3092\u78ba\u4fdd\u3057\u305f\u3044\u5834\u5408\u306f`--seed`\u30aa\u30d7\u30b7\u30e7\u30f3\u3092\u4f7f\u3046\u3002\n\n# \u53c2\u8003\n\u3046\u307e\u304f\u3070\u3089\u3064\u304b\u306a\u3044\u5834\u5408\u304c\u4ee5\u524d\u3042\u3063\u305f\u3089\u3057\u3044[^2]\u3051\u3069\u30d0\u30b0\u3060\u3063\u305f\u306e\u3060\u308d\u3046\u304b\n\n[^1]: `-k`\u30aa\u30d7\u30b7\u30e7\u30f3\u306e\u9805\u3092\u53c2\u7167\u306e\u3053\u3068[^3]\n[^2]: Biostars: [ATTENTION: bowtie2 and multiple hits](https://www.biostars.org/p/55237/) / [(SEQanswers)](http://seqanswers.com/forums/showthread.php?t=24270)\n[^3]: [Bowtie2 manual](http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml)\n", "tags": ["bioinformatics", "Python", "ngs"]}