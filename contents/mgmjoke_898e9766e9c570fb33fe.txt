{"context": " More than 1 year has passed since last update.\n\n\uff11\u3001\u4e8b\u524d\u6e96\u5099\n\u25a0\u4ee5\u4e0b\u306e\u30d5\u30a1\u30a4\u30eb\u3092\u5bfe\u8c61\u30b5\u30fc\u30d0\u306e\u4efb\u610f\u306e\u5834\u6240\u306b\u914d\u7f6e\n\u203b\u672c\u4ef6\u3067\u306f/tmp \u3092\u4f7f\u7528\u3059\u308b\u3002\nsnmptt_1.4.tgz\nperl-Config-IniFiles-2.83-4.1.noarch.rpm \nperl-Net-SNMP-v5.0.1-1.pp-rh73.noarch.rpm\n\n\uff12\u3001\u30d1\u30c3\u30b1\u30fc\u30b8 \u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\u25a0yum \u304b\u3089\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3092\u5b9f\u884c\n# yum -y install perl-Crypt-DES perl-Digest-HMAC perl-Digest-SHA perl-Socket6 perl-Crypt-DES\n# yum -y install perl-Sys-Syslog perl-List-MoreUtils perl-IO-stringy\n# yum -y install net-snmp-utils net-snmp-perl perl perl-Net-SNMP perl-Config-IniFiles perl-Module-Build perl-Time-HiRes\n# yum -y install perl-Digest-SHA1\n# rpm -ivh perl-Config-IniFiles-2.83-4.1.noarch.rpm perl-Net-SNMP-v5.0.1-1.pp-rh73.noarch.rpm\n# useradd -s /sbin/nologin snmptt\n# cd /tmp\n# cp -p snmptt_1.4.tgz /usr/src\n# cd /usr/src\n# tar xvfz snmptt_1.4.tgz\n# cd snmptt_1.4\n# cp ./snmptt /usr/sbin\n# cp ./snmptthandler /usr/sbin/\n# cp ./snmptthandler-embedded /usr/sbin/\n# cp ./snmptt.ini /etc/snmp/\n# cp ./snmpttconvertmib /usr/sbin/\n# chmod 755 /usr/sbin/snmptt\n# chmod 755 /usr/sbin/snmptthandler\n# chmod 755 /usr/sbin/snmptthandler-embedded\n# chmod 755 /usr/sbin/snmpttconvertmib\n# mkdir /var/log/snmptt\n# chown snmptt:snmptt /var/log/snmptt\n# mkdir /var/spool/snmptt/\n# chown snmptt:snmptt /var/spool/snmptt/\n# cp snmptt-init.d /etc/rc.d/init.d/snmptt\n# cd /usr/lib/systemd/system\n# pwd\n# touch snmptt.service\n# vi snmptt.service\n[Unit]\nDescription=SNMP Trap Translator\nWants=network-online.target\nAfter=syslog.target network-online.target\n\n[Service]\nEnvironment=\"CONFIG=/etc/snmp/snmptt.ini\"\nExecStart=/usr/sbin/snmptt -c ${CONFIG}\nExecReload=/bin/kill -HUP ${MAINPID}\nType=forking\nPIDFile=/var/run/snmptt.pid\nRestart=always\nTimeoutStopSec=320s\nKillMode=process\nRestartSec=5s\n\n[Install]\nWantedBy=multi-user.target\n\n# systemctl daemon-reload\n# cd /usr/src/snmptt_1.4\n# cp snmptt.logrotate /etc/logrotate.d/snmptt\n\n\uff13\u3001\u95a2\u9023\u30d5\u30a1\u30a4\u30eb\u306e\u8a2d\u5b9a\n\u25a0\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u306e\u7de8\u96c6\n# cd /etc/snmp/\n# vi snmptt.ini\n\u4ee5\u4e0b\u306e\u69d8\u306b\u7de8\u96c6\n# mode = standalone\nmode = daemon\n\n# net_snmp_perl_enable = 0\nnet_snmp_perl_enable = 1\n\n# net_snmp_perl_best_guess = 0\nnet_snmp_perl_best_guess = 2\n\n\\# date_time_format =\ndate_time_format = %Y/%m/%d %Y %H:%M:%S\n\n# sleep = 5\nsleep = 1\n\n# syslog_enable = 1\nsyslog_enable = 0\n\n\u25a0\u30e1\u30c3\u30bb\u30fc\u30b8\u30d5\u30a1\u30a4\u30eb\u306e\u7de8\u96c6\n# vi snmptt.conf\n\u4ee5\u4e0b\u306e\u69d8\u306b\u7de8\u96c6\nEVENT general .* \"LOGONLY\" Normal\nFORMAT zabbixtrap $aA $ar \u3067\u672a\u77e5\u306eSNMP Trap\u304c\u9001\u4fe1\u3055\u308c\u307e\u3057\u305f\u3002$-*\n\n\u25a0\u30d7\u30ed\u30bb\u30b9\u3092\u8d77\u52d5\n# systemctl start snmptt\n# systemctl status snmptt\n# systemctl enable snmptt\n# systemctl is-enabled snmptt\n\u25a0snmptrapd\u306e\u8a2d\u5b9a\u3092\u5909\u66f4\n# cd /etc/sysconfig/\n# vi snmptrapd\n\u4ee5\u4e0b\u306e\u69d8\u306b\u7de8\u96c6\nOPTIONS=\"-m +ALL -On\"\n\n\u25a0\u30d7\u30ed\u30bb\u30b9\u3092\u518d\u8d77\u52d5\n# systemctl restart snmptrapd\n# systemctl restart snmptt\n# cd /var/log/snmptt/\n# touch snmptt.log\n# chown snmptt:snmptt snmptt.log\n\u25a0\u30c6\u30b9\u30c8\n# snmptrap -v2c -c  localhost '' .1.3.6.1.6.3.1.1.5.3 test i 0\n# tail /var/log/snmptt/snmptt.log\n\u203b\u3000\u51fa\u529b\u30e1\u30c3\u30bb\u30fc\u30b8\u304c\u66f8\u304d\u8db3\u3055\u308c\u3066\u3044\u308c\u3070\u6210\u529f\n\n\u304a\u3057\u307e\u3044\n### \uff11\u3001\u4e8b\u524d\u6e96\u5099\n\n\u25a0\u4ee5\u4e0b\u306e\u30d5\u30a1\u30a4\u30eb\u3092\u5bfe\u8c61\u30b5\u30fc\u30d0\u306e\u4efb\u610f\u306e\u5834\u6240\u306b\u914d\u7f6e\n\u203b\u672c\u4ef6\u3067\u306f/tmp \u3092\u4f7f\u7528\u3059\u308b\u3002\nsnmptt_1.4.tgz\nperl-Config-IniFiles-2.83-4.1.noarch.rpm \nperl-Net-SNMP-v5.0.1-1.pp-rh73.noarch.rpm\n\n### \uff12\u3001\u30d1\u30c3\u30b1\u30fc\u30b8 \u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\u25a0yum \u304b\u3089\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3092\u5b9f\u884c\n\n\\# yum -y install perl-Crypt-DES perl-Digest-HMAC perl-Digest-SHA perl-Socket6 perl-Crypt-DES\n\n\\# yum -y install perl-Sys-Syslog perl-List-MoreUtils perl-IO-stringy\n\\# yum -y install net-snmp-utils net-snmp-perl perl perl-Net-SNMP perl-Config-IniFiles perl-Module-Build perl-Time-HiRes\n\\# yum -y install perl-Digest-SHA1\n\\# rpm -ivh perl-Config-IniFiles-2.83-4.1.noarch.rpm perl-Net-SNMP-v5.0.1-1.pp-rh73.noarch.rpm\n\n\\# useradd -s /sbin/nologin snmptt\n\n\\# cd /tmp\n\\# cp -p snmptt_1.4.tgz /usr/src\n\\# cd /usr/src\n\\# tar xvfz snmptt_1.4.tgz\n\n\\# cd snmptt_1.4\n\n\\# cp ./snmptt /usr/sbin\n\\# cp ./snmptthandler /usr/sbin/\n\\# cp ./snmptthandler-embedded /usr/sbin/\n\\# cp ./snmptt.ini /etc/snmp/\n\\# cp ./snmpttconvertmib /usr/sbin/\n\n\\# chmod 755 /usr/sbin/snmptt\n\\# chmod 755 /usr/sbin/snmptthandler\n\\# chmod 755 /usr/sbin/snmptthandler-embedded\n\\# chmod 755 /usr/sbin/snmpttconvertmib\n\n\\# mkdir /var/log/snmptt\n\\# chown snmptt:snmptt /var/log/snmptt\n\\# mkdir /var/spool/snmptt/\n\\# chown snmptt:snmptt /var/spool/snmptt/\n\n\\# cp snmptt-init.d /etc/rc.d/init.d/snmptt\n\n\\# cd /usr/lib/systemd/system\n\\# pwd\n\n\\# touch snmptt.service\n\\# vi snmptt.service\n\n```\n[Unit]\nDescription=SNMP Trap Translator\nWants=network-online.target\nAfter=syslog.target network-online.target\n\n[Service]\nEnvironment=\"CONFIG=/etc/snmp/snmptt.ini\"\nExecStart=/usr/sbin/snmptt -c ${CONFIG}\nExecReload=/bin/kill -HUP ${MAINPID}\nType=forking\nPIDFile=/var/run/snmptt.pid\nRestart=always\nTimeoutStopSec=320s\nKillMode=process\nRestartSec=5s\n\n[Install]\nWantedBy=multi-user.target\n```\n\n\\# systemctl daemon-reload\n\n\\# cd /usr/src/snmptt_1.4\n\\# cp snmptt.logrotate /etc/logrotate.d/snmptt\n\n### \uff13\u3001\u95a2\u9023\u30d5\u30a1\u30a4\u30eb\u306e\u8a2d\u5b9a\n\u25a0\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u306e\u7de8\u96c6\n\\# cd /etc/snmp/\n\\# vi snmptt.ini\n\n\u4ee5\u4e0b\u306e\u69d8\u306b\u7de8\u96c6\n\n```\n# mode = standalone\nmode = daemon\n\n# net_snmp_perl_enable = 0\nnet_snmp_perl_enable = 1\n\n# net_snmp_perl_best_guess = 0\nnet_snmp_perl_best_guess = 2\n\n\\# date_time_format =\ndate_time_format = %Y/%m/%d %Y %H:%M:%S\n\n# sleep = 5\nsleep = 1\n\n# syslog_enable = 1\nsyslog_enable = 0\n```\n\n\u25a0\u30e1\u30c3\u30bb\u30fc\u30b8\u30d5\u30a1\u30a4\u30eb\u306e\u7de8\u96c6\n\\# vi snmptt.conf\n\n\u4ee5\u4e0b\u306e\u69d8\u306b\u7de8\u96c6\n\n```\nEVENT general .* \"LOGONLY\" Normal\nFORMAT zabbixtrap $aA $ar \u3067\u672a\u77e5\u306eSNMP Trap\u304c\u9001\u4fe1\u3055\u308c\u307e\u3057\u305f\u3002$-*\n```\n\n\u25a0\u30d7\u30ed\u30bb\u30b9\u3092\u8d77\u52d5\n\\# systemctl start snmptt\n\\# systemctl status snmptt\n\\# systemctl enable snmptt\n\\# systemctl is-enabled snmptt\n\n\u25a0snmptrapd\u306e\u8a2d\u5b9a\u3092\u5909\u66f4\n\\# cd /etc/sysconfig/\n\\# vi snmptrapd\n\n\u4ee5\u4e0b\u306e\u69d8\u306b\u7de8\u96c6\n\n```\nOPTIONS=\"-m +ALL -On\"\n````\n\n\u25a0\u30d7\u30ed\u30bb\u30b9\u3092\u518d\u8d77\u52d5\n\\# systemctl restart snmptrapd\n\\# systemctl restart snmptt\n\n\\# cd /var/log/snmptt/\n\\# touch snmptt.log\n\\# chown snmptt:snmptt snmptt.log\n\n\u25a0\u30c6\u30b9\u30c8\n\\# snmptrap -v2c -c <Community> localhost '' .1.3.6.1.6.3.1.1.5.3 test i 0\n\\# tail /var/log/snmptt/snmptt.log\n\u203b\u3000\u51fa\u529b\u30e1\u30c3\u30bb\u30fc\u30b8\u304c\u66f8\u304d\u8db3\u3055\u308c\u3066\u3044\u308c\u3070\u6210\u529f\n\n### \u304a\u3057\u307e\u3044\n\n", "tags": ["zabbix"]}