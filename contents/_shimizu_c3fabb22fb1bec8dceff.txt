{"tags": ["d3.js", "JavaScript"], "context": " More than 1 year has passed since last update.\u53c2\u7167\nhttp://shimz.me/blog/d3-js/3087\n\u8ffd\u8a18\uff1a\u5c11\u3057\u6539\u826f\u3057\u307e\u3057\u305f\u3002\nhttp://shimz.me/blog/javascript/3376\nd3.json('test.json', function(json){\n    d3.csv('test1.csv', function(csv1){\n        d3.csv('test2.csv', function(csv2){\n            d3.csv('test3.csv', function(csv3){\n                d3main(json, csv1, csv2, csv3);\n            });\n        });        \n    });\n});\n\nfunction d3main(){\n    var data = Array.prototype.slice.call(arguments);\n}\n\n\u4e0a\u8a18\u306e\u3088\u3046\u306a\u30c7\u30fc\u30bf\u8aad\u307f\u8fbc\u307f\u6642\u306e\u975e\u540c\u671f\u51e6\u7406\u3092\u307e\u3068\u3081\u308b\u3002\nfunction loadDataSet(){\n    var urlArray = arguments[0] ;\n    var callback = arguments[arguments.length-1]\n    if(!Array.isArray(urlArray)) throw 'TypeError: arg1 is not a array!';\n    if(typeof callback != \"function\")  throw 'TypeError: callback is not a function!';\n    if(arguments.length > 2){\n        var workinFnArray = Array.prototype.slice.apply(arguments, [1, arguments.length-1]);\n    }\n\n    var dataStack = [];\n    var fnStack = [];\n\n    var chain = function(functions) {\n      return functions.reduceRight(function (next, curr) {\n        return function () {\n            if(workinFnArray) workinFnArray.forEach(function(fn){ fn(); });\n          curr.apply({next: next}, arguments);\n        }\n      });\n    }\n\n    urlArray.forEach(function(url){\n        fnStack.push(\n            function() {\n                var that = this;\n                var exte = url.split('.')[url.split('.').length-1];\n                var readfile;\n                switch(exte){\n                    case 'json': case 'geojson': case 'topojson':\n                        readfile = d3.json;\n                    break;\n                    case 'csv':\n                        readfile = d3.csv;\n                    break;\n                    default:\n                        throw 'TypeError: ' + exte + ' is not supported';\n                    break;                        \n                }\n\n                return readfile(url,  function(data){\n                    dataStack.push(data);\n                    that.next();\n                });\n            }\n        )\n    });\n\n    fnStack.push(function(){    \n        callback(dataStack);\n    });\n    chain(fnStack)(); \n\n}\n\n\u5b9f\u969b\u306b\u8aad\u307f\u8fbc\u3093\u3067\u307f\u308b\nloadDataSet(\n    ['test.json','test1.csv', 'test2.csv', 'test3.csv'],\n    d3main\n);\n\nfunction d3main(data){\n    console.log(data);\n}\n\n\u30c7\u30fc\u30bf\u30bb\u30c3\u30c8\u306e\u30ed\u30fc\u30c9\u4e2d\u306b\u300cNow Loading\u2026\u300d\u3068\u304b\u631f\u307f\u3080\u5834\u5408\nloadDataSet(\n    ['test.json','test1.csv', 'test2.csv', 'test3.csv'],\n    function(){\n        document.getElementById('info').innerHTML = 'Now Loading\u2026\u2026';\n    },\n    function(data){\n        document.getElementById('info').innerHTML = 'Success!';\n        d3main(data);\n    }\n)\n\nfunction d3main(data){\n    document.getElementById('outputData').innerHTML = JSON.stringify(data);\n}\n\n\u53c2\u7167\nhttp://shimz.me/blog/d3-js/3087\n\n\u8ffd\u8a18\uff1a\u5c11\u3057\u6539\u826f\u3057\u307e\u3057\u305f\u3002\nhttp://shimz.me/blog/javascript/3376\n\n```js\nd3.json('test.json', function(json){\n    d3.csv('test1.csv', function(csv1){\n        d3.csv('test2.csv', function(csv2){\n            d3.csv('test3.csv', function(csv3){\n                d3main(json, csv1, csv2, csv3);\n            });\n        });        \n    });\n});\n \nfunction d3main(){\n    var data = Array.prototype.slice.call(arguments);\n}\n```\n\n\u4e0a\u8a18\u306e\u3088\u3046\u306a\u30c7\u30fc\u30bf\u8aad\u307f\u8fbc\u307f\u6642\u306e\u975e\u540c\u671f\u51e6\u7406\u3092\u307e\u3068\u3081\u308b\u3002\n\n```js\nfunction loadDataSet(){\n    var urlArray = arguments[0] ;\n    var callback = arguments[arguments.length-1]\n    if(!Array.isArray(urlArray)) throw 'TypeError: arg1 is not a array!';\n    if(typeof callback != \"function\")  throw 'TypeError: callback is not a function!';\n    if(arguments.length > 2){\n        var workinFnArray = Array.prototype.slice.apply(arguments, [1, arguments.length-1]);\n    }\n     \n    var dataStack = [];\n    var fnStack = [];\n     \n    var chain = function(functions) {\n      return functions.reduceRight(function (next, curr) {\n        return function () {\n            if(workinFnArray) workinFnArray.forEach(function(fn){ fn(); });\n          curr.apply({next: next}, arguments);\n        }\n      });\n    }\n     \n    urlArray.forEach(function(url){\n        fnStack.push(\n            function() {\n                var that = this;\n                var exte = url.split('.')[url.split('.').length-1];\n                var readfile;\n                switch(exte){\n                    case 'json': case 'geojson': case 'topojson':\n                        readfile = d3.json;\n                    break;\n                    case 'csv':\n                        readfile = d3.csv;\n                    break;\n                    default:\n                        throw 'TypeError: ' + exte + ' is not supported';\n                    break;                        \n                }\n                 \n                return readfile(url,  function(data){\n                    dataStack.push(data);\n                    that.next();\n                });\n            }\n        )\n    });\n     \n    fnStack.push(function(){    \n        callback(dataStack);\n    });\n    chain(fnStack)(); \n     \n}\n```\n\n\u5b9f\u969b\u306b\u8aad\u307f\u8fbc\u3093\u3067\u307f\u308b\n\n```js\nloadDataSet(\n    ['test.json','test1.csv', 'test2.csv', 'test3.csv'],\n    d3main\n);\n \nfunction d3main(data){\n    console.log(data);\n}\n```\n\n\u30c7\u30fc\u30bf\u30bb\u30c3\u30c8\u306e\u30ed\u30fc\u30c9\u4e2d\u306b\u300cNow Loading\u2026\u300d\u3068\u304b\u631f\u307f\u3080\u5834\u5408\n\n```js\nloadDataSet(\n    ['test.json','test1.csv', 'test2.csv', 'test3.csv'],\n    function(){\n        document.getElementById('info').innerHTML = 'Now Loading\u2026\u2026';\n    },\n    function(data){\n        document.getElementById('info').innerHTML = 'Success!';\n        d3main(data);\n    }\n)\n \nfunction d3main(data){\n    document.getElementById('outputData').innerHTML = JSON.stringify(data);\n}\n```\n"}