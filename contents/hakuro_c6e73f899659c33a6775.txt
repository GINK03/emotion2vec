{"context": " More than 1 year has passed since last update.\u4ee5\u4e0b\u306e\u516c\u5f0f\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u3092\u548c\u8a33\u3057\u307e\u3057\u305f\u3002\nClojure Luminus - Your first application\n\u3053\u306e\u548c\u8a33\u306f\u4ee5\u4e0b\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u306e\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u3092\u524d\u63d0\u3068\u3057\u3066\u3044\u307e\u3059\u3002\nhttps://clojars.org/luminus/lein-template/versions/2.9.8.76\n\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u306b\u95a2\u3057\u3066\u306fayato_p\u3055\u3093\u306e\u4ee5\u4e0b\u306e\u8a18\u4e8b\u304c\u53c2\u8003\u306b\u306a\u308a\u307e\u3059\u3002\n\u9673\u8150\u5316\u3057\u306a\u3044 Clojure \u306e\u60c5\u5831\u3092\u66f8\u304f\u305f\u3081\u306b\u6c17\u3092\u3064\u3051\u308b\u3079\u304d\u3053\u3068/\u3042\u308b\u3044\u306f\u60c5\u5831\u304c\u9673\u8150\u5316\u3057\u3066\u3044\u308b\u3053\u3068\u306b\u6c17\u4ed8\u304f\u305f\u3081\u306b\u77e5\u3063\u3066\u304a\u304d\u305f\u3044\u3053\u3068\nLuminus\u306fClojure\u306e\u3055\u307e\u3056\u307e\u306a\u30e9\u30a4\u30d6\u30e9\u30ea\u306e\u96c6\u5408\u4f53\u3067\u3059\u3002\n\u3053\u306e\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb\u3067\u500b\u5225\u306e\u30e9\u30a4\u30d6\u30e9\u30ea\u306e\u4f7f\u3044\u65b9\u3082\u3042\u308b\u7a0b\u5ea6\u7406\u89e3\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u308b\u3067\u3057\u3087\u3046\u3002\n\n\u30b2\u30b9\u30c8\u30d6\u30c3\u30af\u30a2\u30d7\u30ea\n\u3053\u306e\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb\u3067\u306fLuminus\u3092\u4f7f\u3063\u305f\u30b7\u30f3\u30d7\u30eb\u306a\u30b2\u30b9\u30c8\u30d6\u30c3\u30af\u30a2\u30d7\u30ea\u3092\u69cb\u7bc9\u3059\u308b\u65b9\u6cd5\u3092\u8aac\u660e\u3059\u308b\u3002\n\u30b2\u30b9\u30c8\u30d6\u30c3\u30af\u30a2\u30d7\u30ea\u306f\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u6295\u7a3f\u3059\u308b\u3053\u3068\u3068\u4ed6\u306e\u30e6\u30fc\u30b6\u30fc\u304c\u6295\u7a3f\u3057\u305f\u30e1\u30c3\u30bb\u30fc\u30b8\u306e\u30ea\u30b9\u30c8\u3092\u8868\u793a\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u308b\u3002\n\u3053\u306e\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306fHTML\u30c6\u30f3\u30d7\u30ec\u30fc\u30c6\u30a3\u30f3\u30b0\u3001\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u30a2\u30af\u30bb\u30b9\u3001\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u8a2d\u8a08\u306e\u57fa\u672c\u3092\u5b9f\u6f14\u3059\u308b\u3053\u3068\u306b\u306a\u308b\u3002\n\u3082\u3057\u3001\u3042\u306a\u305f\u304c\u307e\u3060\u597d\u307f\u306eClojure\u7528\u306e\u30a8\u30c7\u30a3\u30bf\u3092\u6301\u3063\u3066\u3044\u306a\u3044\u3068\u3057\u305f\u3089\u3001LightTable\u3092\u4f7f\u7528\u3057\u3066\u3053\u306e\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb\u3092\u884c\u3046\u3053\u3068\u3092\u304a\u3059\u3059\u3081\u3059\u308b\u3002\n\nJDK\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\nClojure\u306fJVM\u4e0a\u3067\u52d5\u4f5c\u3059\u308b\u306e\u3067\u3001JDK\u304c\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u3066\u3044\u308b\u5fc5\u8981\u304c\u3042\u308b\u3002\n\u3082\u3057\u3001\u3042\u306a\u305f\u306e\u74b0\u5883\u306bJDK\u304c\u307e\u3060\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u3066\u3044\u306a\u3044\u5834\u5408\u3001OpenJDK\u3092\u304a\u3059\u3059\u3081\u3059\u308b\u3002\n\u305d\u308c\u306f\u3053\u3053\u304b\u3089\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3067\u304d\u308b\u3002\n\u3061\u306a\u307f\u306bLuminus\u306f\u30c7\u30d5\u30a9\u30eb\u30c8\u8a2d\u5b9a\u3067JDK 8\u3092\u5fc5\u8981\u3068\u3059\u308b\u3053\u3068\u3092\u8a18\u3057\u3066\u304a\u304f\u3002\n\nLeiningen\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\nLuminus\u3092\u52d5\u304b\u3059\u305f\u3081\u306b\u306fLeiningen\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\u5fc5\u8981\u304c\u3042\u308b\u3002\nLeiningen\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u7c21\u5358\u306a\u624b\u9806\u3067\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3067\u304d\u308b\u3002\n\n\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3059\u308b\n\u30b9\u30af\u30ea\u30d7\u30c8\u306b\u5b9f\u884c\u6a29\u9650\u3092\u4ed8\u4e0e\u3059\u308b(eg: chmod +x lein)\n\u30d1\u30b9\u306e\u901a\u3063\u305f\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u305d\u308c\u3092\u914d\u7f6e\u3059\u308b(eg: ~/bin)\n\u300clein self-install\u300d\u3092\u5b9f\u884c\u3057\u3001\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u304c\u5b8c\u4e86\u3059\u308b\u306e\u3092\u5f85\u3064\n\n$ wget https://raw.github.com/technomancy/leiningen/stable/bin/lein\n$ chmod +x lein\n$ mv lein ~/bin\n$ lein\n\n\n\u65b0\u3057\u3044\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u4f5c\u6210\nLeiningen\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u304c\u3067\u304d\u305f\u3089\u3001\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u521d\u671f\u5316\u306e\u305f\u3081\u306b\u30bf\u30fc\u30df\u30ca\u30eb\u3067\u4ee5\u4e0b\u306e\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3059\u308b\u3002\n$ lein new luminus guestbook +h2\n$ cd guestbook\n\n\u4e0a\u8a18\u306e\u30b3\u30de\u30f3\u30c9\u306fH2 embedded database\u3092\u4f7f\u7528\u3059\u308b\u65b0\u3057\u3044\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092\u4f5c\u6210\u3059\u308b\u3002\n\nLuminus\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u8a73\u89e3\n\u65b0\u3057\u304f\u4f5c\u6210\u3057\u305f\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u69cb\u9020\u3092\u3057\u3066\u3044\u308b\u3002\nguestbook\n|____.gitignore\n|____Procfile\n|____project.clj\n|____profiles.clj\n|____README.md\n|____src\n| |____guestbook\n|   |____core.clj\n|   |____handler.clj\n|   |____layout.clj\n|   |____middleware.clj\n|   |____routes\n|   | |____home.clj\n|   |____db\n|     |____core.clj\n|     |____migrations.clj\n|____env\n| |____dev\n| | |____clj\n| |   |____guestbook\n| |     |____config.clj\n| |     |____dev_middleware.clj.clj\n| |____prod\n|   |____clj\n|     |____guestbook\n|       |____config.clj\n|____test\n| |____guestbook\n|   |____test\n|     |____handler.clj\n|\n|____resources\n  |____templates\n  | |____about.html\n  | |____base.html\n  | |____home.html\n  | |____error.html\n  |____public\n  | |____css\n  | | |____screen.css\n  | |____img\n  | |____js\n  |____docs\n  | |____docs.md\n  |____migrations\n  | |____20150718103127-add-users-table.down.sql\n  | |____20150718103127-add-users-table.up.sql\n  |____sql\n   |____queries.sql\n\n\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u6700\u4e0a\u4f4d\u306e\u30d5\u30a9\u30eb\u30c0\u306b\u5165\u3063\u3066\u3044\u308b\u30d5\u30a1\u30a4\u30eb\u306b\u95a2\u3057\u3066\u898b\u3066\u3044\u3053\u3046\u3002\n\n\nProcfile - Heroku\u3078\u306e\u30c7\u30d7\u30ed\u30a4\u3092\u652f\u63f4\u3059\u308b\u305f\u3081\u306b\u4f7f\u308f\u308c\u308b\n\nREADME.md - \u4f1d\u7d71\u7684\u306b\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u304c\u66f8\u304b\u308c\u308b\u30d5\u30a1\u30a4\u30eb\n\nproject.clj - Leiningen\u304c\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306e\u8a2d\u5b9a\u3068\u30e9\u30a4\u30d6\u30e9\u30ea\u306e\u4f9d\u5b58\u95a2\u4fc2\u3092\u7ba1\u7406\u3059\u308b\u305f\u3081\u306b\u4f7f\u308f\u308c\u308b\n\nprofiles.clj - \u30b3\u30fc\u30c9\u306e\u30ea\u30dd\u30b8\u30c8\u30ea\u306b\u5165\u308c\u305f\u304f\u306a\u3044\u30ed\u30fc\u30ab\u30eb\u8a2d\u5b9a\u3092\u884c\u3046\u305f\u3081\u306b\u4f7f\u308f\u308c\u308b\n\n.gitignore - \u30d3\u30eb\u30c9\u306b\u3088\u3063\u3066\u751f\u6210\u3055\u308c\u305f\u30d5\u30a1\u30a4\u30eb\u7b49\u306eGit\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u7ba1\u7406\u304b\u3089\u9664\u5916\u3059\u308b\u30d5\u30a1\u30a4\u30eb\u306e\u30ea\u30b9\u30c8\n\n\n\u30bd\u30fc\u30b9\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\n\u3059\u3079\u3066\u306e\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u306fsrc\u30d5\u30a9\u30eb\u30c0\u4ee5\u4e0b\u306b\u7f6e\u304b\u308c\u308b\u3002\n\u4eca\u56de\u4f5c\u6210\u3059\u308b\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306fguestbook\u3068\u3044\u3046\u540d\u524d\u306a\u306e\u3067\u3001\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306e\u6700\u4e0a\u4f4d\u306e\u540d\u524d\u7a7a\u9593\u306f\u3053\u306eguestbook\u306b\u306a\u308b\u3002\n\u3067\u306f\u3001\u4f5c\u6210\u3055\u308c\u305f\u3059\u3079\u3066\u306e\u540d\u524d\u7a7a\u9593\u306b\u95a2\u3057\u3066\u898b\u3066\u3044\u3053\u3046\u3002\n\nguestbook\n\n\ncore.clj - \u30b5\u30fc\u30d0\u30fc\u306e\u8d77\u52d5\u3068\u7d42\u4e86\u306b\u95a2\u3059\u308b\u30ed\u30b8\u30c3\u30af\u3092\u542b\u3080\u3001\u3053\u306e\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u30a8\u30f3\u30c8\u30ea\u30dd\u30a4\u30f3\u30c8\u3067\u3042\u308b\u3002\n\nhandler.clj - \u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u57fa\u672c\u7684\u306a\u30eb\u30fc\u30c6\u30a3\u30f3\u30b0\u3092\u5b9a\u7fa9\u3059\u308b\u3002\u3053\u308c\u306f\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u30a8\u30f3\u30c8\u30ea\u30dd\u30a4\u30f3\u30c8\u3067\u3042\u308b\u3002\n\nlayout.clj - \u30da\u30fc\u30b8\u306e\u30b3\u30f3\u30c6\u30f3\u30c4\u3092\u63cf\u753b\u3059\u308b\u305f\u3081\u306e\u30ec\u30a4\u30a2\u30a6\u30c8\u30d8\u30eb\u30d1\u30fc\u3092\u8a18\u8ff0\u3059\u308b\u305f\u3081\u306e\u540d\u524d\u7a7a\u9593\u3067\u3042\u308b\u3002\n\nmiddleware.clj - \u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u30ab\u30b9\u30bf\u30e0\u30df\u30c9\u30eb\u30a6\u30a7\u30a2\u3092\u542b\u3080\u540d\u524d\u7a7a\u9593\u3067\u3042\u308b\u3002\n\n\nguestbook.db\ndb\u540d\u524d\u7a7a\u9593\u306f\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u30e2\u30c7\u30eb\u3092\u5b9a\u7fa9\u3057\u3001\u6c38\u7d9a\u5316\u5c64\u3092\u51e6\u7406\u3059\u308b\u305f\u3081\u306b\u4f7f\u7528\u3055\u308c\u308b\u3002\n\n\ncore.clj - \u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3068\u306e\u3084\u308a\u53d6\u308a\u306e\u305f\u3081\u306e\u95a2\u6570\u3092\u4fdd\u6301\u3059\u308b\u305f\u3081\u306b\u4f7f\u7528\u3055\u308c\u308b\n\nmigrations.clj - \u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u30de\u30a4\u30b0\u30ec\u30fc\u30b7\u30e7\u30f3\u3092\u5b9f\u884c\u3059\u308b\u305f\u3081\u306b\u4f7f\u7528\u3055\u308c\u308b\n\n\nguestbook.routes\nroutes\u540d\u524d\u7a7a\u9593\u306fhome\u3068about\u30da\u30fc\u30b8\u306e\u30eb\u30fc\u30c6\u30a3\u30f3\u30b0\u5b9a\u7fa9\u3068\u30b3\u30f3\u30c8\u30ed\u30fc\u30e9\u304c\u914d\u7f6e\u3055\u308c\u308b\u5834\u6240\u3067\u3042\u308b\u3002\n\u3042\u306a\u305f\u304c\u8a8d\u8a3c\u306e\u3088\u3046\u306a\u8907\u6570\u306e\u30eb\u30fc\u30c6\u30a3\u30f3\u30b0\u5b9a\u7fa9\u3084\u7279\u5b9a\u306e\u30ef\u30fc\u30af\u30d5\u30ed\u30fc\u3092\u8ffd\u52a0\u3059\u308b\u5834\u5408\u306f\u3001\u3053\u3053\u306b\u305d\u306e\u305f\u3081\u306e\u540d\u524d\u7a7a\u9593\u3092\u4f5c\u6210\u3059\u308b\u5fc5\u8981\u304c\u3042\u308b\u3002\n\n\nhome.clj - \u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306ehome\u30da\u30fc\u30b8\u3068about\u30da\u30fc\u30b8\u3092\u5b9a\u7fa9\u3059\u308b\u540d\u524d\u7a7a\u9593\n\n\nEnv\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\n\u3053\u308c\u306f\u74b0\u5883\u4f9d\u5b58\u30b3\u30fc\u30c9\u306e\u30bd\u30fc\u30b9\u3092\u542b\u3080\u30d5\u30a9\u30eb\u30c0\u3067\u3042\u308b\u3002dev\u8a2d\u5b9a\u306f\u958b\u767a\u4e2d\u306b\u4f7f\u7528\u3055\u308c\u3001prod\u8a2d\u5b9a\u306f\u672c\u756a\u74b0\u5883\u7528\u306b\u30b3\u30f3\u30d1\u30a4\u30eb\u3055\u308c\u308b\u3068\u304d\u306b\u4f7f\u7528\u3055\u308c\u308b\u3002\nconfig.clj - \u901a\u5e38\u306f\u958b\u767a\u7528\u8a2d\u5b9a\u3092\u542b\u3080\ndev_middleware.clj - \u672c\u756a\u3067\u306f\u30b3\u30f3\u30d1\u30a4\u30eb\u3055\u308c\u308b\u3079\u304d\u3067\u306a\u3044\u958b\u767a\u6642\u306b\u4f7f\u7528\u3059\u308b\u30df\u30c9\u30eb\u30a6\u30a7\u30a2\u3092\u542b\u3080\n\n\u30c6\u30b9\u30c8\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\n\u3053\u3053\u306f\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u30c6\u30b9\u30c8\u3092\u914d\u7f6e\u3059\u308b\u5834\u6240\u3067\u3042\u308a\u3001\u3044\u304f\u3064\u304b\u306e\u30b5\u30f3\u30d7\u30eb\u30c6\u30b9\u30c8\u304c\u3059\u3067\u306b\u5b9a\u7fa9\u3055\u308c\u3066\u3044\u308b\u3002\n\n\u30ea\u30bd\u30fc\u30b9\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\n\u3053\u308c\u306f\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u3059\u3079\u3066\u306e\u9759\u7684\u306a\u30ea\u30bd\u30fc\u30b9\u3092\u914d\u7f6e\u3059\u308b\u5834\u6240\u3067\u3042\u308b\u3002\nresources\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u4e0b\u306epublic\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u914d\u7f6e\u3057\u305f\u30d5\u30a1\u30a4\u30eb\u306f\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u30b5\u30fc\u30d0\u30fc\u306b\u3088\u3063\u3066\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u306b\u305d\u306e\u307e\u307e\u914d\u4fe1\u3055\u308c\u308b\u3002\n\u3044\u304f\u3064\u304b\u306eCSS\u30ea\u30bd\u30fc\u30b9\u304c\u3059\u3067\u306b\u4f5c\u6210\u3055\u308c\u3066\u3044\u308b\u3002\n\nHTML\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\ntemplates\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306f\u30da\u30fc\u30b8\u8868\u793a\u306e\u305f\u3081\u306eSelmer\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u306e\u305f\u3081\u306b\u6e96\u5099\u3055\u308c\u3066\u3044\u308b\u3002\nabout.html - about\u30da\u30fc\u30b8\nbase.html - \u30b5\u30a4\u30c8\u306e\u30d9\u30fc\u30b9\u30ec\u30a4\u30a2\u30a6\u30c8\nhome.html - home\u30da\u30fc\u30b8\n\nSQL\u30af\u30a8\u30ea\nSQL\u30af\u30a8\u30ea\u306fresources/sql\u30d5\u30a9\u30eb\u30c0\u306e\u4e2d\u306b\u3042\u308b\u3002\nqueries.sql - SQL\u30af\u30a8\u30ea\u3068\u305d\u308c\u3089\u306b\u7d50\u3073\u3064\u304f\u95a2\u6570\u3092\u5b9a\u7fa9\u3059\u308b\u3002\n\n\u30de\u30a4\u30b0\u30ec\u30fc\u30b7\u30e7\u30f3\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\nLuminus\u306fMigratus\u3067\u30de\u30a4\u30b0\u30ec\u30fc\u30b7\u30e7\u30f3\u7ba1\u7406\u3092\u884c\u3063\u3066\u3044\u308b\u3002\n\u30de\u30a4\u30b0\u30ec\u30fc\u30b7\u30e7\u30f3\u306fup\u3068down\u306eSQL\u30d5\u30a1\u30a4\u30eb\u3067\u7ba1\u7406\u3055\u308c\u308b\u3002\n\u3053\u308c\u3089\u306e\u30d5\u30a1\u30a4\u30eb\u306f\u6163\u4f8b\u7684\u306b\u65e5\u4ed8\u3092\u4f7f\u3063\u3066\u30d0\u30fc\u30b8\u30e7\u30f3\u7ba1\u7406\u3055\u308c\u3001\u9806\u756a\u306b\u9069\u7528\u3055\u308c\u308b\u3002\n\n20150718103127-add-users-table.up.sql - \u30c6\u30fc\u30d6\u30eb\u4f5c\u6210\u306e\u305f\u3081\u306e\u30de\u30a4\u30b0\u30ec\u30fc\u30b7\u30e7\u30f3\u30d5\u30a1\u30a4\u30eb\n20150718103127-add-users-table.down.sql - \u30c6\u30fc\u30d6\u30eb\u524a\u9664\u306e\u305f\u3081\u306e\u30de\u30a4\u30b0\u30ec\u30fc\u30b7\u30e7\u30f3\u30d5\u30a1\u30a4\u30eb\n\n\n\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u30d5\u30a1\u30a4\u30eb\n\u4e0a\u3067\u8a18\u8ff0\u3057\u305f\u3088\u3046\u306b\u3001\u3059\u3079\u3066\u306e\u4f9d\u5b58\u95a2\u4fc2\u306fproject.clj\u30d5\u30a1\u30a4\u30eb\u3092\u66f4\u65b0\u3059\u308b\u3053\u3068\u306b\u3088\u3063\u3066\u7ba1\u7406\u3055\u308c\u308b\u3002\u79c1\u305f\u3061\u306e\u4f5c\u6210\u3057\u305f\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u30d5\u30a1\u30a4\u30eb\u306f\u30eb\u30fc\u30c8\u30d5\u30a9\u30eb\u30c0\u306b\u5b58\u5728\u3057\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u5185\u5bb9\u3068\u306a\u3063\u3066\u3044\u308b\u3002\n(defproject guestbook \"0.1.0-SNAPSHOT\"\n\n  :description \"FIXME: write description\"\n  :url \"http://example.com/FIXME\"\n\n:dependencies [[org.clojure/clojure \"1.7.0\"]\n               [selmer \"0.8.7\"]\n               [com.taoensso/timbre \"4.0.2\"]\n               [com.taoensso/tower \"3.0.2\"]\n               [markdown-clj \"0.9.67\"]\n               [environ \"1.0.0\"]\n               [compojure \"1.4.0\"]\n               [ring-webjars \"0.1.1\"]\n               [ring/ring-defaults \"0.1.5\"]\n               [ring-ttl-session \"0.1.1\"]\n               [ring \"1.4.0\"\n                :exclusions [ring/ring-jetty-adapter]]\n               [metosin/ring-middleware-format \"0.6.0\"]\n               [metosin/ring-http-response \"0.6.3\"]\n               [bouncer \"0.3.3\"]\n               [prone \"0.8.2\"]\n               [org.clojure/tools.nrepl \"0.2.10\"]\n               [org.webjars/bootstrap \"3.3.5\"]\n               [org.webjars/jquery \"2.1.4\"]\n               [migratus \"0.8.2\"]\n               [conman \"0.1.1\"]\n               [to-jdbc-uri \"0.2.0\"]\n               [com.h2database/h2 \"1.4.187\"]\n               [org.immutant/web \"2.0.2\"]]\n\n  :min-lein-version \"2.0.0\"\n  :uberjar-name \"guestbook.jar\"\n  :jvm-opts [\"-server\"]\n\n  :main guestbook.core\n  :migratus {:store :database}\n\n  :plugins [[lein-environ \"1.0.0\"]\n            [lein-ancient \"0.6.5\"]\n            [migratus-lein \"0.1.5\"]]\n  :profiles\n  {:uberjar {:omit-source true\n             :env {:production true}\n             :aot :all}\n   :dev           [:project/dev :profiles/dev]\n   :test          [:project/test :profiles/test]\n   :project/dev  {:dependencies [[ring/ring-mock \"0.2.0\"]\n                                 [ring/ring-devel \"1.4.0\"]\n                                 [pjstadig/humane-test-output \"0.7.0\"]\n                                 [mvxcvi/puget \"0.8.1\"]]\n\n\n                  :repl-options {:init-ns guestbook.core}\n                  :injections [(require 'pjstadig.humane-test-output)\n                               (pjstadig.humane-test-output/activate!)]\n                  ;;when :nrepl-port is set the application starts the nREPL server on load\n                  :env {:dev        true\n                        :port       3000\n                        :nrepl-port 7000}}\n   :project/test {:env {:test       true\n                        :port       3001\n                        :nrepl-port 7001}}\n   :profiles/dev {}\n   :profiles/test {}})\n\nproject.clj\u306f\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306b\u3064\u3044\u3066\u305d\u308c\u305e\u308c\u7570\u306a\u3063\u305f\u89b3\u70b9\u304b\u3089\u8a18\u8ff0\u3057\u305f\u3001\u30ad\u30fc\u3068\u5024\u306e\u30da\u30a2\u3092\u542b\u3093\u3060\u5358\u306a\u308bClojure\u306e\u30ea\u30b9\u30c8\u3067\u3042\u308b\u3053\u3068\u304c\u5206\u304b\u308b\u3060\u308d\u3046\u3002\n\u305f\u3044\u3066\u3044\u306e\u5834\u5408\u3001\u65b0\u3057\u3044\u30e9\u30a4\u30d6\u30e9\u30ea\u3092\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306b\u8ffd\u52a0\u3059\u308b\u3053\u3068\u304c\u591a\u3044\u3002\u3053\u308c\u3089\u306e\u30e9\u30a4\u30d6\u30e9\u30ea\u306f\u7279\u306b:dependencies\u306e\u30d9\u30af\u30c8\u30eb\u3092\u4f7f\u3046\u3002\u65b0\u3057\u3044\u30e9\u30a4\u30d6\u30e9\u30ea\u3092\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u5185\u3067\u4f7f\u3046\u306b\u306f\u3001\u79c1\u305f\u3061\u306f\u305f\u3060\u4f9d\u5b58\u95a2\u4fc2\u3092\u3053\u3053\u306b\u8ffd\u52a0\u3059\u308b\u3060\u3051\u3067\u3044\u3044\u3002\n:plugins\u30d9\u30af\u30c8\u30eb\u5185\u306e\u8981\u7d20\u306f\u74b0\u5883\u5909\u6570\u306e\u8aad\u307f\u8fbc\u307f\uff08via. Environ plugin\uff09\u306a\u3069\u306e\u6a5f\u80fd\u6027\u306e\u8ffd\u52a0\u3092\u63d0\u4f9b\u3059\u308b\u305f\u3081\u306b\u4f7f\u308f\u308c\u308b\u3002\n:profiles\u306f\u3001\u958b\u767a\u3042\u308b\u3044\u306f\u672c\u756a\u74b0\u5883\u306e\u30d3\u30eb\u30c9\u306b\u5411\u3051\u3066\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092\u521d\u671f\u5316\u3059\u308b\u305f\u3081\u306b\u4f7f\u7528\u3059\u308b\u3002\n\u3053\u308c\u306f\u74b0\u5883\u3054\u3068\u306b\u7570\u306a\u308bmap\u5f62\u5f0f\u306e\u8a2d\u5b9a\u3068\u306a\u3063\u3066\u3044\u308b\u3002\n\u3053\u306e\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306f:dev\u3068:test\u306e\u8907\u5408\u30d7\u30ed\u30d5\u30a1\u30a4\u30eb\u3068\u3057\u3066\u8a2d\u5b9a\u3057\u3066\u3044\u308b\u3053\u3068\u3092\u8a18\u3057\u3066\u304a\u304f\u3002\n\u3053\u308c\u3089\u306e\u30d7\u30ed\u30d5\u30a1\u30a4\u30eb\u306f:project/dev\u3068:project/test\u304b\u3089\u306e\u5909\u6570\u3060\u3051\u3067\u306a\u304f\u3001profiles.clj\u4e2d\u306e:project/dev\u3068:project/test\u304b\u3089\u306e\u5909\u6570\u3082\u542b\u3093\u3067\u3044\u308b\u3002\n\u5f8c\u8005\u306b\u306f\u5171\u6709\u306e\u30b3\u30fc\u30c9\u30ea\u30dd\u30b8\u30c8\u30ea\u306b\u30c1\u30a7\u30c3\u30af\u30a4\u30f3\u3057\u306a\u3044\u30ed\u30fc\u30ab\u30eb\u74b0\u5883\u5909\u6570\u3092\u542b\u3080\u3079\u304d\u3067\u3042\u308b\u3002\nproject.clj\u30d3\u30eb\u30c9\u30d5\u30a1\u30a4\u30eb\u306e\u69cb\u7bc9\u306b\u95a2\u3059\u308b\u3088\u308a\u8a73\u7d30\u306a\u4e8b\u9805\u306b\u95a2\u3057\u3066\u306f\u516c\u5f0f\u306eLeiningen\u306e\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u3092\u53c2\u7167\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306e\u4f5c\u6210\n\u307e\u305a\u3001\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u30e2\u30c7\u30eb\u3092\u4f5c\u308b\u305f\u3081\u306bmigrations\u30d5\u30a9\u30eb\u30c0\u4e2d\u306b\u914d\u7f6e\u3055\u308c\u3066\u3044\u308b<date>-add-users-table.up.sql\u3092\u958b\u3053\u3046\u3002\n\u30d5\u30a1\u30a4\u30eb\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u8a18\u8ff0\u306b\u306a\u3063\u3066\u3044\u308b\u3002\nCREATE TABLE users\n(id VARCHAR(20) PRIMARY KEY,\n first_name VARCHAR(30),\n last_name VARCHAR(30),\n email VARCHAR(30),\n admin BOOLEAN,\n last_login TIME,\n is_active BOOLEAN,\n pass VARCHAR(100));\n\n\u4ee5\u4e0b\u306e\u3088\u3046\u306busers\u30c6\u30fc\u30d6\u30eb\u3092\u79c1\u305f\u3061\u306e\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306b\u3088\u308a\u9069\u5207\u306a\u5f62\u306b\u66f8\u304d\u63db\u3048\u3088\u3046\u3002\nCREATE TABLE guestbook\n(id INTEGER PRIMARY KEY AUTO_INCREMENT,\n name VARCHAR(30),\n message VARCHAR(200),\n timestamp TIMESTAMP);\n\nguestbook\u30c6\u30fc\u30d6\u30eb\u306f\u30b3\u30e1\u30f3\u30c8\u3057\u305f\u4eba\u306e\u540d\u524d\u3001\u30e1\u30c3\u30bb\u30fc\u30b8\u306e\u5185\u5bb9\u3001\u30bf\u30a4\u30e0\u30b9\u30bf\u30f3\u30d7\u306a\u3069\u306e\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u8a18\u8ff0\u3059\u308b\u3059\u3079\u3066\u306e\u30d5\u30a3\u30fc\u30eb\u30c9\u3092\u4fdd\u5b58\u3059\u308b\u3002\n\u30d5\u30a1\u30a4\u30eb\u3092\u4fdd\u5b58\u3057\u3066\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306e\u30eb\u30fc\u30c8\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3067\u4ee5\u4e0b\u306e\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3057\u3088\u3046\u3002\n$ lein run migrate\n\n\u3082\u3057\u3001\u3059\u3079\u3066\u304c\u3046\u307e\u304f\u884c\u3063\u305f\u306a\u3089\u3001\u3053\u308c\u3067\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u304c\u521d\u671f\u5316\u3055\u308c\u308b\u306f\u305a\u3060\u3002\n\n\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3078\u306e\u30a2\u30af\u30bb\u30b9\n\u6b21\u306bsrc/guestbook/db/core.clj\u30d5\u30a1\u30a4\u30eb\u3092\u898b\u3066\u307f\u3088\u3046\u3002\n\u3053\u3053\u306b\u306f\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3078\u306e\u63a5\u7d9a\u8a2d\u5b9a\u304c\u3059\u3067\u306b\u3042\u308b\u3053\u3068\u304c\u5206\u304b\u308b\u3002\n(ns guestbook.db.core\n  (:require\n    [clojure.java.jdbc :as jdbc]\n    [yesql.core :refer [defqueries]]\n    [taoensso.timbre :as timbre]\n    [environ.core :refer [env]])\n  (:import java.sql.BatchUpdateException))\n\n(def conn\n  {:classname   \"org.h2.Driver\"\n   :connection-uri (:database-url env)\n   :make-pool?     true\n   :naming         {:keys   clojure.string/lower-case\n                    :fields clojure.string/upper-case}})\n\n(defqueries \"sql/queries.sql\" {:connection conn})\n\n\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306e\u63a5\u7d9a\u8a2d\u5b9a\u306f\u5b9f\u884c\u6642\u306e:database-url\u74b0\u5883\u5909\u6570\u304b\u3089\u8aad\u307f\u8fbc\u307e\u308c\u308b\u3002\n\u3053\u306e\u5909\u6570\u306f\u958b\u767a\u74b0\u5883\u306e\u5834\u5408\u306fprofiles.clj\u304b\u3089\u53d6\u308a\u8fbc\u307e\u308c\u3001\u672c\u756a\u74b0\u5883\u306e\u5834\u5408\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u74b0\u5883\u5909\u6570\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u5fc5\u8981\u304c\u3042\u308b\u3002\n$ export DATABASE_URL=\"jdbc:h2:./guestbook.db\"\n\nH2 embedded database\u3092\u4f7f\u7528\u3059\u308b\u305f\u3081\u3001URL\u306e\u4e2d\u3067\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092\u8d77\u52d5\u3057\u305f\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u304b\u3089\u306e\u76f8\u5bfe\u30d1\u30b9\u3067\u6307\u5b9a\u3057\u305f\u30d5\u30a1\u30a4\u30eb\u306b\u30c7\u30fc\u30bf\u306f\u4fdd\u5b58\u3055\u308c\u308b\u3002\n\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306e\u30af\u30a8\u30ea\u306b\u30de\u30c3\u30d4\u30f3\u30b0\u3055\u308c\u308b\u95a2\u6570\u306fdefqueries\u304c\u547c\u3073\u51fa\u3055\u308c\u305f\u6642\u306b\u751f\u6210\u3055\u308c\u308b\u3002\n\u305d\u306edefqueries\u306fsql/queries.sql\u30d5\u30a1\u30a4\u30eb\u3092\u53c2\u7167\u3057\u3066\u3044\u308b\u3053\u3068\u304c\u5206\u304b\u308b\u3060\u308d\u3046\u3002\n\u3053\u306e\u30d5\u30a1\u30a4\u30eb\u306fresources\u306e\u4e2d\u306b\u3042\u308b\u306e\u3067\u3001\u30d5\u30a1\u30a4\u30eb\u3092\u958b\u3044\u3066\u4e2d\u8eab\u3092\u898b\u3066\u307f\u3088\u3046\u3002\n-- name: create-user!\n-- creates a new user record\nINSERT INTO users\n(id, first_name, last_name, email, pass)\nVALUES (:id, :first_name, :last_name, :email, :pass)\n\n-- name: update-user!\n-- update an existing user record\nUPDATE users\nSET first_name = :first_name, last_name = :last_name, email = :email\nWHERE id = :id\n\n-- name: get-user\n-- retrieve a user given the id.\nSELECT * FROM users\nWHERE id = :id\n\n\u5404\u95a2\u6570\u306f-- name:[\u95a2\u6570\u540d]\u3068\u3044\u3046\u5f62\u5f0f\u306e\u30b3\u30e1\u30f3\u30c8\u3092\u4f7f\u7528\u3059\u308b\u3053\u3068\u3067\u5b9a\u7fa9\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u304c\u5206\u304b\u308b\u3060\u308d\u3046\u3002\n\u95a2\u6570\u540d\u3092\u5b9a\u7fa9\u3057\u305f\u6b21\u306e\u884c\u306e\u30b3\u30e1\u30f3\u30c8\u306f\u95a2\u6570\u306e\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u306b\u306a\u3063\u3066\u304a\u308a\u3001\u3055\u3089\u306b\u6b21\u306e\u884c\u304b\u3089SQL\u3092\u8a18\u8ff0\u3059\u308b\u3088\u3046\u306a\u5f62\u5f0f\u306b\u306a\u3063\u3066\u3044\u308b\u3002\nSQL\u3067\u4f7f\u7528\u3059\u308b\u30d1\u30e9\u30e1\u30fc\u30bf\u306f:[\u30d1\u30e9\u30e1\u30fc\u30bf\u540d]\u3068\u3044\u3046\u8868\u8a18\u306b\u306a\u3063\u3066\u3044\u308b\u3002\n\u5b9f\u969b\u306b\u30af\u30a8\u30ea\u306e\u5185\u5bb9\u3092\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u66f8\u304d\u63db\u3048\u3066\u307f\u3088\u3046\u3002\n-- name:save-message!\n-- creates a new message\nINSERT INTO guestbook\n(name, message, timestamp)\nVALUES (:name, :message, :timestamp)\n\n-- name:get-messages\n-- selects all available messages\nSELECT * from guestbook\n\n\u6700\u5f8c\u306b\u3053\u306e\u540d\u524d\u7a7a\u9593\u306frun\u3068\u3044\u3046\u30d8\u30eb\u30d1\u30fc\u95a2\u6570\u3092\u63d0\u4f9b\u3057\u3066\u304f\u308c\u308b\u3002\u3053\u306e\u95a2\u6570\u306fconn\u3068\u3044\u3046\u30a2\u30c8\u30e0\u304b\u3089\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3078\u306e\u63a5\u7d9a\u3092\u63a2\u3057\u3066\u30af\u30a8\u30ea\u95a2\u6570\u3092\u5b9f\u884c\u3059\u308b\u3002\n\n\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u8d77\u52d5\u3059\u308b\n\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u3057\u3066\u958b\u767a\u30e2\u30fc\u30c9\u3067\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u8d77\u52d5\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u308b\u3002\n>lein run\n00:49:54.865 [main] DEBUG org.jboss.logging - Logging Provider: org.jboss.logging.Slf4jLoggerProvider\n15-Jul-19 00:49:55 Nyx INFO [guestbook.handler] - nREPL server started on port 7000\n15-Jul-19 00:49:55 Nyx INFO [guestbook.handler] -\n-=[guestbook started successfullyusing the development profile]=-\n00:49:55.772 INFO  [org.projectodd.wunderboss.web.Web] (main) Registered web context /\n15-Jul-19 00:49:55 Nyx INFO [guestbook.core] - server started on port: 3000\n\n\u4e00\u5ea6\u30b5\u30fc\u30d0\u30fc\u3092\u8d77\u52d5\u3057\u305f\u3089\u3001\u30d6\u30e9\u30a6\u30b6\u3067http://localhost:3000\u3092\u958b\u304f\u3053\u3068\u304c\u3067\u304d\u3001\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u304c\u52d5\u4f5c\u3057\u3066\u3044\u308b\u3053\u3068\u304c\u5206\u304b\u308b\u306f\u305a\u3060\u3002\u8d77\u52d5\u6642\u306b\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u30d1\u30e9\u30e1\u30fc\u30bf\u3092\u6307\u5b9a\u3059\u308b\u304b\u3001PORT\u3068\u3044\u3046\u74b0\u5883\u5909\u6570\u3092\u8a2d\u5b9a\u3059\u308b\u3053\u3068\u3067\u30b5\u30fc\u30d0\u30fc\u3092\u5225\u306e\u30dd\u30fc\u30c8\u3067\u8d77\u52d5\u3055\u305b\u308b\u3053\u3068\u304c\u3067\u304d\u308b\u3002\nlein run 8000\n\n\u8868\u793a\u3055\u308c\u305f\u30da\u30fc\u30b8\u304c\u79c1\u305f\u3061\u306b\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3092\u521d\u671f\u5316\u3059\u308b\u305f\u3081\u306e\u30de\u30a4\u30b0\u30ec\u30fc\u30b7\u30e7\u30f3\u3092\u5b9f\u884c\u3059\u308b\u3053\u3068\u3092\u5373\u3057\u3066\u308b\u3053\u3068\u306b\u6ce8\u610f\u3057\u3066\u307b\u3057\u3044\u3002\u3057\u304b\u3057\u3001\u79c1\u305f\u3061\u306f\u3059\u3067\u306b\u30de\u30a4\u30b0\u30ec\u30fc\u30b7\u30e7\u30f3\u3092\u4ee5\u524d\u884c\u3063\u3066\u3044\u308b\u305f\u3081\u3001\u3082\u3046\u4e00\u5ea6\u884c\u3046\u5fc5\u8981\u306f\u306a\u3044\u3002\n\n\u30da\u30fc\u30b8\u306e\u4f5c\u6210\u3068\u5165\u529b\u30d5\u30a9\u30fc\u30e0\u306e\u53d6\u308a\u6271\u3044\n\u30eb\u30fc\u30c6\u30a3\u30f3\u30b0\u5b9a\u7fa9\u306fguestbook.routes.home\u540d\u524d\u7a7a\u9593\u306b\u5b9a\u7fa9\u3055\u308c\u3066\u3044\u308b\u3002\u305d\u306e\u30d5\u30a1\u30a4\u30eb\u3092\u958b\u304d\u3001\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u304b\u3089\u53d6\u308a\u51fa\u3057\u305f\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u8868\u793a\u3059\u308b\u305f\u3081\u306e\u30ed\u30b8\u30c3\u30af\u3092\u8ffd\u52a0\u3057\u3088\u3046\u3002\n\u307e\u305a\u306f\u3058\u3081\u306bdb\u3001Bouncer\u3001ring.util.response\u306e\u540d\u524d\u7a7a\u9593\u3078\u306e\u53c2\u7167\u3092\u4e00\u7dd2\u306b\u8ffd\u52a0\u3059\u308b\u5fc5\u8981\u304c\u3042\u308b\u3002\n(ns guestbook.routes.home\n  (:require\n    ...\n    [guestbook.db.core :as db]\n    [bouncer.core :as b]\n    [bouncer.validators :as v]\n    [ring.util.response :refer [redirect]]))\n\n\u6b21\u306b\u30d5\u30a9\u30fc\u30e0\u306e\u30d1\u30e9\u30e1\u30fc\u30bf\u3092\u30d0\u30ea\u30c7\u30fc\u30c8\u3059\u308b\u305f\u3081\u306e\u95a2\u6570\u3092\u4f5c\u308b\u3002\n(defn validate-message [params]\n  (first\n    (b/validate\n      params\n      :name v/required\n      :message [v/required [v/min-count 10]])))\n\n\u3053\u306e\u95a2\u6570\u306f:name\u3068:message\u306e\u30ad\u30fc\u306b\u5bfe\u5fdc\u3059\u308b\u5024\u304c\u79c1\u305f\u3061\u304c\u5b9a\u3081\u305f\u30eb\u30fc\u30eb\u5f93\u3063\u3066\u3044\u308b\u304b\u30c1\u30a7\u30c3\u30af\u3059\u308b\u305f\u3081\u306bBouncer\u306evalidate\u95a2\u6570\u3092\u4f7f\u7528\u3057\u3066\u3044\u308b\u3002\n\u5177\u4f53\u7684\u306b\u306f\u3001name\u306f\u5fc5\u9808\u3067\u3001message\u306f\u5c11\u306a\u304f\u3068\u308210\u6587\u5b57\u3067\u3042\u308b\u5fc5\u8981\u304c\u3042\u308b\u3088\u3046\u306b\u3057\u3066\u3044\u308b\u3002\nBouncer\u306fmessage\u306e\u5834\u5408\u306e\u3088\u3046\u306b\u30d0\u30ea\u30c7\u30fc\u30bf\u306b\u8907\u6570\u306e\u30eb\u30fc\u30eb\u3092\u6e21\u3059\u305f\u3081\u306b\u30d9\u30af\u30bf\u69cb\u6587\u3092\u4f7f\u7528\u3057\u3066\u3044\u308b\u3002\nmin-count\u3092\u4f7f\u7528\u3057\u305f\u5834\u5408\u306e\u3088\u3046\u306b\u30d0\u30ea\u30c7\u30fc\u30bf\u304c\u8ffd\u52a0\u306e\u30d1\u30e9\u30e1\u30fc\u30bf\u3092\u3068\u308b\u5834\u5408\u3001\u30d9\u30af\u30bf\u69cb\u6587\u304c\u540c\u69d8\u306b\u4f7f\u7528\u3055\u308c\u308b\u3002\u305d\u306e\u5024\u306f\u3001\u6697\u9ed9\u7684\u306b\u7b2c\u4e00\u5f15\u6570\u3068\u3057\u3066\u30d0\u30ea\u30c7\u30fc\u30bf\u306b\u6e21\u3055\u308c\u307e\u3059\u3002\n\u3053\u3046\u3057\u3066\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u30d0\u30ea\u30c7\u30fc\u30c8\u3057\u3001\u4fdd\u5b58\u3059\u308b\u305f\u3081\u306e\u95a2\u6570\u3092\u8ffd\u52a0\u3057\u305f\u3002\n(defn save-message! [{:keys [params]}]\n  (if-let [errors (validate-message params)]\n    (-> (redirect \"/\")\n        (assoc :flash (assoc params :errors errors)))\n    (do\n      (db/save-message!\n       (assoc params :timestamp (java.util.Date.)))\n      (redirect \"/\"))))\n\n\u3053\u306e\u95a2\u6570\u306f\u30d5\u30a9\u30fc\u30e0\u306e\u30d1\u30e9\u30e1\u30fc\u30bf\u3092\u542b\u3080\u30ea\u30af\u30a8\u30b9\u30c8\u304b\u3089\u306e:params\u30ad\u30fc\u3092\u53d6\u5f97\u3059\u308b\u3002\nvalidate-message\u95a2\u6570\u304c\u30a8\u30e9\u30fc\u3092\u8fd4\u3057\u305f\u5834\u5408\u3001/\u306b\u30ea\u30c0\u30a4\u30ec\u30af\u30c8\u3057\u3001\u30a8\u30e9\u30fc\u3068\u4e00\u7dd2\u306b\u63d0\u4f9b\u3055\u308c\u305f\u30d1\u30e9\u30e1\u30fc\u30bf\u3092\u5165\u308c\u305f\u30ec\u30b9\u30dd\u30f3\u30b9\u3092:flash\u30ad\u30fc\u306b\u95a2\u9023\u4ed8\u3051\u308b\u3002\n\u30a8\u30e9\u30fc\u3092\u8fd4\u3055\u306a\u3044\u5834\u5408\u3001\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306b\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u4fdd\u5b58\u3057\u3001\u30ea\u30c0\u30a4\u30ec\u30af\u30c8\u3059\u308b\u3002\n\u3055\u3089\u306bhome-page\u30b3\u30f3\u30c8\u30ed\u30fc\u30e9\u3092\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u5909\u66f4\u3059\u308b\u3002\n(defn home-page [{:keys [flash]}]\n  (layout/render\n   \"home.html\"\n   (merge {:messages (db/get-messages)}\n          (select-keys flash [:name :message :errors]))))\n\n\u3053\u306e\u95a2\u6570\u306f\u30d0\u30ea\u30c7\u30fc\u30c8\u30a8\u30e9\u30fc\u306a\u3069\u306e:flash\u30bb\u30c3\u30b7\u30e7\u30f3\u304b\u3089\u306e\u3059\u3079\u3066\u306e\u30d1\u30e9\u30e1\u30fc\u30bf\u3068\u4e00\u7dd2\u306b\u73fe\u5728\u4fdd\u5b58\u3055\u308c\u3066\u3044\u308b\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u306b\u6e21\u3057\u3066home\u30da\u30fc\u30b8\u306e\u63cf\u753b\u3059\u308b\u3002\n\u30eb\u30fc\u30c6\u30a3\u30f3\u30b0\u306e\u8a2d\u5b9a\u3068\u3057\u3066\u306fhome-page\u3068save-message!\u306e\u4e21\u65b9\u306b\u30ea\u30af\u30a8\u30b9\u30c8\u3092\u6e21\u3059\u5fc5\u8981\u304c\u3042\u308b\u3002\n(defroutes home-routes\n  (GET \"/\" request (home-page request))\n  (POST \"/\" request (save-message! request))\n  (GET \"/about\" [] (about-page)))\n\ncompojure.core\u304b\u3089POST\u3092\u53c2\u7167\u3067\u304d\u308b\u3088\u3046\u306b\u3059\u308b\u3053\u3068\u3092\u5fd8\u308c\u306a\u3044\u3088\u3046\u306b\u3057\u3088\u3046\u3002\n(ns guestbook.routes.home\n  (:require ...\n            [compojure.core :refer [defroutes GET POST]]\n            ...))\n\n\u30b3\u30f3\u30c8\u30ed\u30fc\u30e9\u304c\u51fa\u6765\u4e0a\u304c\u3063\u305f\u306e\u3067\u3001resources/templates\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u5185\u306b\u3042\u308bhome.html\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u306e\u30d5\u30a1\u30a4\u30eb\u3092\u958b\u3053\u3046\u3002\n\u305d\u306e\u307e\u307e\u306e\u72b6\u614b\u3060\u3068\u3001content\u30d6\u30ed\u30c3\u30af\u4e2d\u306econtent\u5909\u6570\u306e\u5185\u5bb9\u3092\u305f\u3060\u8868\u793a\u3059\u308b\u3060\u3051\u306b\u306a\u3063\u3066\u3044\u308b\u3002\n{% extends \"base.html\" %}\n{% block content %}\n  <div class=\"jumbotron\">\n    <h1>Welcome to guestbook</h1>\n    <p>Time to start building your site!</p>\n    <p><a class=\"btn btn-primary btn-lg\" href=\"http://luminusweb.net\">Learn more &raquo;</a></p>\n  </div>\n\n  <div class=\"row\">\n    <div class=\"span12\">\n    {{docs|markdown}}\n    </div>\n  </div>\n{% endblock %}\n\n\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u7e70\u308a\u8fd4\u3057\u51e6\u7406\u3059\u308b\u3088\u3046\u306b\u3057\u3001\u30ea\u30b9\u30c8\u4e2d\u306e\u305d\u308c\u305e\u308c\u306e\u5024\u3092\u8868\u793a\u3059\u308b\u3088\u3046\u306bcontent\u30d6\u30ed\u30c3\u30af\u3092\u5909\u66f4\u3057\u3088\u3046\u3002\n{% extends \"base.html\" %}\n{% block content %}\n  <div class=\"jumbotron\">\n    <h1>Welcome to guestbook</h1>\n    <p>Time to start building your site!</p>\n    <p><a class=\"btn btn-primary btn-lg\" href=\"http://luminusweb.net\">Learn more &raquo;</a></p>\n  </div>\n\n  <div class=\"row\">\n    <div class=\"span12\">\n        <ul class=\"messages\">\n            {% for item in messages %}\n            <li>\n                <time>{{item.timestamp|date:\"yyyy-MM-dd HH:mm\"}}</time>\n                <p>{{item.message}}</p>\n                <p> - {{item.name}}</p>\n            </li>\n            {% endfor %}\n        </ul>\n    </div>\n</div>\n{% endblock %}\n\n\u4e0a\u8a18\u306e\u3088\u3046\u306b\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u7e70\u308a\u8fd4\u3057\u51e6\u7406\u3059\u308b\u305f\u3081\u306bfor\u30a4\u30c6\u30ec\u30fc\u30bf\u3092\u4f7f\u7528\u3057\u305f\u3002\u305d\u308c\u305e\u308c\u306e\u30e1\u30c3\u30bb\u30fc\u30b8\u306fmessage\u3001name\u3001\u3000timestamp\u306e\u30ad\u30fc\u3092\u4f7f\u7528\u3057\u305f\u30de\u30c3\u30d7\u306b\u306a\u3063\u3066\u3044\u308b\u305f\u3081\u3001\u30ad\u30fc\u306e\u540d\u524d\u3067\u30a2\u30af\u30bb\u30b9\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u308b\u3002\u30bf\u30a4\u30e0\u30b9\u30bf\u30f3\u30d7\u3092\u4eba\u9593\u304c\u8aad\u3080\u3053\u3068\u306e\u3067\u304d\u308b\u5f62\u5f0f\u306b\u5909\u63db\u3059\u308b\u65e5\u4ed8\u30d5\u30a3\u30eb\u30bf\u30fc\u304c\u4f7f\u7528\u3067\u304d\u308b\u3053\u3068\u3082\u8a18\u3057\u3066\u304a\u3053\u3046\u3002\n\u6700\u5f8c\u306b\u30e6\u30fc\u30b6\u30fc\u304c\u30e1\u30c3\u30bb\u30fc\u30b8\u306e\u9001\u4fe1\u3059\u308b\u305f\u3081\u306e\u30d5\u30a9\u30fc\u30e0\u3092\u4f5c\u6210\u3059\u308b\u3002\u30e6\u30fc\u30b6\u30fc\u304c\u9001\u4fe1\u3057\u305fname\u3068message\u306e\u5024\u3092\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u306b\u306f\u3081\u8fbc\u307f\u3001\u305d\u308c\u3089\u306b\u95a2\u9023\u3059\u308b\u3059\u3079\u3066\u306e\u30a8\u30e9\u30fc\u3092\u63cf\u753b\u3059\u308b\u3002\n\u307e\u305f\u3001CSRF\u5bfe\u7b56\u306e\u305f\u3081\u306b\u30d5\u30a9\u30fc\u30e0\u5185\u3067csrf-field\u30bf\u30b0\u3092\u4f7f\u7528\u3057\u3066\u3044\u308b\u3002\n<div class=\"row\">\n    <div class=\"span12\">\n        <form method=\"POST\" action=\"/\">\n                {% csrf-field %}\n                <p>\n                    Name:\n                    <input class=\"form-control\"\n                           type=\"text\"\n                           name=\"name\"\n                           value=\"{{name}}\" />\n                </p>\n                {% if errors.name %}\n                <div class=\"alert alert-danger\">{{errors.name|join}}</div>\n                {% endif %}\n                <p>\n                    Message:\n                <textarea class=\"form-control\"\n                          rows=\"4\"\n                          cols=\"50\"\n                          name=\"message\">{{message}}</textarea>\n                </p>\n                {% if errors.message %}\n                <div class=\"alert alert-danger\">{{errors.message|join}}</div>\n                {% endif %}\n                <input type=\"submit\" class=\"btn btn-primary\" value=\"comment\" />\n        </form>\n    </div>\n</div>\n\n\u6700\u7d42\u7684\u306ahome.html\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u306a\u308b\u3060\u308d\u3046\u3002\n{% extends \"base.html\" %}\n{% block content %}\n<div class=\"row\">\n    <div class=\"span12\">\n        <ul class=\"messages\">\n            {% for item in messages %}\n            <li>\n                <time>{{item.timestamp|date:\"yyyy-MM-dd HH:mm\"}}</time>\n                <p>{{item.message}}</p>\n                <p> - {{item.name}}</p>\n            </li>\n            {% endfor %}\n        </ul>\n    </div>\n</div>\n<div class=\"row\">\n    <div class=\"span12\">\n        <form method=\"POST\" action=\"/\">\n                {% csrf-field %}\n                <p>\n                    Name:\n                    <input class=\"form-control\"\n                           type=\"text\"\n                           name=\"name\"\n                           value=\"{{name}}\" />\n                </p>\n                {% if errors.name %}\n                <div class=\"alert alert-danger\">{{errors.name|join}}</div>\n                {% endif %}\n                <p>\n                    Message:\n                <textarea class=\"form-control\"\n                          rows=\"4\"\n                          cols=\"50\"\n                          name=\"message\">{{message}}</textarea>\n                </p>\n                {% if errors.message %}\n                <div class=\"alert alert-danger\">{{errors.message|join}}</div>\n                {% endif %}\n                <input type=\"submit\" class=\"btn btn-primary\" value=\"comment\" />\n        </form>\n    </div>\n</div>\n{% endblock %}\n\n\u5165\u529b\u30d5\u30a9\u30fc\u30e0\u3092\u3088\u308a\u304b\u3063\u3053\u3088\u304f\u6574\u5f62\u3059\u308b\u305f\u3081\u306bresources/public/css\u30d5\u30a9\u30eb\u30c0\u306b\u914d\u7f6e\u3055\u308c\u305fscreen.css\u30d5\u30a1\u30a4\u30eb\u3092\u66f4\u65b0\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u3063\u305f\u3002\nbody {\n    height: 100%;\n    padding-top: 70px;\n    font: 14px 'Helvetica Neue', Helvetica, Arial, sans-serif;\n    line-height: 1.4em;\n    background: #eaeaea;\n    width: 550px;\n    margin: 0 auto;\n}\n\n.messages {\n  background: white;\n  width: 520px;\n}\nul {\n    list-style: none;\n}\n\nul.messages li {\n    position: relative;\n    font-size: 16px;\n    padding: 5px;\n    border-bottom: 1px dotted #ccc;\n}\n\nli:last-child {\n    border-bottom: none;\n}\n\nli time {\n    font-size: 12px;\n    padding-bottom: 20px;\n}\n\nform, .error {\n    width: 520px;\n    padding: 30px;\n    margin-bottom: 50px;\n    position: relative;\n  background: white;\n}\n\n\u3053\u308c\u3067\u30d6\u30e9\u30a6\u30b6\u306e\u30da\u30fc\u30b8\u3092\u30ea\u30ed\u30fc\u30c9\u3059\u308c\u3070\u30b2\u30b9\u30c8\u30d6\u30c3\u30af\u306e\u30da\u30fc\u30b8\u306b\u5bfe\u9762\u3059\u308b\u3053\u3068\u306b\u306a\u308b\u3060\u308d\u3046\u3002\u30b2\u30b9\u30c8\u30d6\u30c3\u30af\u306b\u30b3\u30e1\u30f3\u30c8\u3092\u8ffd\u52a0\u3057\u3001\u305d\u308c\u304c\u6b63\u3057\u304f\u52d5\u4f5c\u3059\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3057\u3066\u307f\u3088\u3046\u3002\n\n\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u30d1\u30c3\u30b1\u30fc\u30b8\u30f3\u30b0\n\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306f\u4ee5\u4e0b\u306e\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3059\u308b\u3053\u3068\u306b\u3088\u3063\u3066\u30b9\u30bf\u30f3\u30c9\u30a2\u30ed\u30fc\u30f3\u3067\u306e\u30c7\u30d7\u30ed\u30a4\u5f62\u5f0f\u306b\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u308b\u3002\n$ lein uberjar\n\n\u3053\u308c\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u3057\u3066\u5b9f\u884c\u53ef\u80fd\u306ajar\u3092\u4f5c\u6210\u3059\u308b\u3002\n$ java -jar target/guestbook.jar\n\n\u3053\u306e\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb\u306e\u5b8c\u5168\u306a\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb\u306f\u3053\u3053\u3067\u53d6\u5f97\u3067\u304d\u308b\u3002\u3088\u308a\u5b8c\u5168\u306a\u30b5\u30f3\u30d7\u30eb\u3092\u6c42\u3081\u308b\u5834\u5408\u306fGithub\u4e0a\u306b\u3042\u308b\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u30da\u30fc\u30b8\u306e\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb\u3092\u8aad\u3080\u3068\u3044\u3044\u3060\u308d\u3046\u3002\n\u4ee5\u4e0b\u306e\u516c\u5f0f\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u3092\u548c\u8a33\u3057\u307e\u3057\u305f\u3002\n[Clojure Luminus - Your first application](http://www.luminusweb.net/docs/guestbook.md)\n\n\u3053\u306e\u548c\u8a33\u306f\u4ee5\u4e0b\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u306e\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u3092\u524d\u63d0\u3068\u3057\u3066\u3044\u307e\u3059\u3002\nhttps://clojars.org/luminus/lein-template/versions/2.9.8.76\n\n\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u306b\u95a2\u3057\u3066\u306fayato_p\u3055\u3093\u306e\u4ee5\u4e0b\u306e\u8a18\u4e8b\u304c\u53c2\u8003\u306b\u306a\u308a\u307e\u3059\u3002\n[\u9673\u8150\u5316\u3057\u306a\u3044 Clojure \u306e\u60c5\u5831\u3092\u66f8\u304f\u305f\u3081\u306b\u6c17\u3092\u3064\u3051\u308b\u3079\u304d\u3053\u3068/\u3042\u308b\u3044\u306f\u60c5\u5831\u304c\u9673\u8150\u5316\u3057\u3066\u3044\u308b\u3053\u3068\u306b\u6c17\u4ed8\u304f\u305f\u3081\u306b\u77e5\u3063\u3066\u304a\u304d\u305f\u3044\u3053\u3068](http://qiita.com/ayato_p/items/5358cff8897783bba6d2)\n\nLuminus\u306fClojure\u306e\u3055\u307e\u3056\u307e\u306a\u30e9\u30a4\u30d6\u30e9\u30ea\u306e\u96c6\u5408\u4f53\u3067\u3059\u3002\n\u3053\u306e\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb\u3067\u500b\u5225\u306e\u30e9\u30a4\u30d6\u30e9\u30ea\u306e\u4f7f\u3044\u65b9\u3082\u3042\u308b\u7a0b\u5ea6\u7406\u89e3\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u308b\u3067\u3057\u3087\u3046\u3002\n\n# \u30b2\u30b9\u30c8\u30d6\u30c3\u30af\u30a2\u30d7\u30ea\n\u3053\u306e\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb\u3067\u306fLuminus\u3092\u4f7f\u3063\u305f\u30b7\u30f3\u30d7\u30eb\u306a\u30b2\u30b9\u30c8\u30d6\u30c3\u30af\u30a2\u30d7\u30ea\u3092\u69cb\u7bc9\u3059\u308b\u65b9\u6cd5\u3092\u8aac\u660e\u3059\u308b\u3002\n\u30b2\u30b9\u30c8\u30d6\u30c3\u30af\u30a2\u30d7\u30ea\u306f\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u6295\u7a3f\u3059\u308b\u3053\u3068\u3068\u4ed6\u306e\u30e6\u30fc\u30b6\u30fc\u304c\u6295\u7a3f\u3057\u305f\u30e1\u30c3\u30bb\u30fc\u30b8\u306e\u30ea\u30b9\u30c8\u3092\u8868\u793a\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u308b\u3002\n\u3053\u306e\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306fHTML\u30c6\u30f3\u30d7\u30ec\u30fc\u30c6\u30a3\u30f3\u30b0\u3001\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u30a2\u30af\u30bb\u30b9\u3001\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u8a2d\u8a08\u306e\u57fa\u672c\u3092\u5b9f\u6f14\u3059\u308b\u3053\u3068\u306b\u306a\u308b\u3002\n\n\u3082\u3057\u3001\u3042\u306a\u305f\u304c\u307e\u3060\u597d\u307f\u306eClojure\u7528\u306e\u30a8\u30c7\u30a3\u30bf\u3092\u6301\u3063\u3066\u3044\u306a\u3044\u3068\u3057\u305f\u3089\u3001[LightTable](http://www.lighttable.com/)\u3092\u4f7f\u7528\u3057\u3066\u3053\u306e\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb\u3092\u884c\u3046\u3053\u3068\u3092\u304a\u3059\u3059\u3081\u3059\u308b\u3002\n\n## JDK\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\nClojure\u306fJVM\u4e0a\u3067\u52d5\u4f5c\u3059\u308b\u306e\u3067\u3001JDK\u304c\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u3066\u3044\u308b\u5fc5\u8981\u304c\u3042\u308b\u3002\n\u3082\u3057\u3001\u3042\u306a\u305f\u306e\u74b0\u5883\u306bJDK\u304c\u307e\u3060\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u3066\u3044\u306a\u3044\u5834\u5408\u3001OpenJDK\u3092\u304a\u3059\u3059\u3081\u3059\u308b\u3002\n\u305d\u308c\u306f[\u3053\u3053](http://www.azul.com/downloads/zulu/)\u304b\u3089\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3067\u304d\u308b\u3002\n\u3061\u306a\u307f\u306bLuminus\u306f\u30c7\u30d5\u30a9\u30eb\u30c8\u8a2d\u5b9a\u3067JDK 8\u3092\u5fc5\u8981\u3068\u3059\u308b\u3053\u3068\u3092\u8a18\u3057\u3066\u304a\u304f\u3002\n\n## Leiningen\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\nLuminus\u3092\u52d5\u304b\u3059\u305f\u3081\u306b\u306f[Leiningen](http://leiningen.org/)\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\u5fc5\u8981\u304c\u3042\u308b\u3002\nLeiningen\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u7c21\u5358\u306a\u624b\u9806\u3067\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3067\u304d\u308b\u3002\n\n1. \u30b9\u30af\u30ea\u30d7\u30c8\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3059\u308b\n1. \u30b9\u30af\u30ea\u30d7\u30c8\u306b\u5b9f\u884c\u6a29\u9650\u3092\u4ed8\u4e0e\u3059\u308b(eg: chmod +x lein)\n1. \u30d1\u30b9\u306e\u901a\u3063\u305f\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u305d\u308c\u3092\u914d\u7f6e\u3059\u308b(eg: ~/bin)\n1. \u300clein self-install\u300d\u3092\u5b9f\u884c\u3057\u3001\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u304c\u5b8c\u4e86\u3059\u308b\u306e\u3092\u5f85\u3064\n\n```bash\n$ wget https://raw.github.com/technomancy/leiningen/stable/bin/lein\n$ chmod +x lein\n$ mv lein ~/bin\n$ lein\n```\n\n## \u65b0\u3057\u3044\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u4f5c\u6210\nLeiningen\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u304c\u3067\u304d\u305f\u3089\u3001\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u521d\u671f\u5316\u306e\u305f\u3081\u306b\u30bf\u30fc\u30df\u30ca\u30eb\u3067\u4ee5\u4e0b\u306e\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3059\u308b\u3002\n\n```bash\n$ lein new luminus guestbook +h2\n$ cd guestbook\n```\n\n\u4e0a\u8a18\u306e\u30b3\u30de\u30f3\u30c9\u306f[H2 embedded database](http://www.h2database.com/html/main.html)\u3092\u4f7f\u7528\u3059\u308b\u65b0\u3057\u3044\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092\u4f5c\u6210\u3059\u308b\u3002\n\n## Luminus\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u8a73\u89e3\n\u65b0\u3057\u304f\u4f5c\u6210\u3057\u305f\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u69cb\u9020\u3092\u3057\u3066\u3044\u308b\u3002\n\n```\nguestbook\n|____.gitignore\n|____Procfile\n|____project.clj\n|____profiles.clj\n|____README.md\n|____src\n| |____guestbook\n|   |____core.clj\n|   |____handler.clj\n|   |____layout.clj\n|   |____middleware.clj\n|   |____routes\n|   | |____home.clj\n|   |____db\n|     |____core.clj\n|     |____migrations.clj\n|____env\n| |____dev\n| | |____clj\n| |   |____guestbook\n| |     |____config.clj\n| |     |____dev_middleware.clj.clj\n| |____prod\n|   |____clj\n|     |____guestbook\n|       |____config.clj\n|____test\n| |____guestbook\n|   |____test\n|     |____handler.clj\n|\n|____resources\n  |____templates\n  | |____about.html\n  | |____base.html\n  | |____home.html\n  | |____error.html\n  |____public\n  | |____css\n  | | |____screen.css\n  | |____img\n  | |____js\n  |____docs\n  | |____docs.md\n  |____migrations\n  | |____20150718103127-add-users-table.down.sql\n  | |____20150718103127-add-users-table.up.sql\n  |____sql\n   |____queries.sql\n```\n\n\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u6700\u4e0a\u4f4d\u306e\u30d5\u30a9\u30eb\u30c0\u306b\u5165\u3063\u3066\u3044\u308b\u30d5\u30a1\u30a4\u30eb\u306b\u95a2\u3057\u3066\u898b\u3066\u3044\u3053\u3046\u3002\n\n* `Procfile` - Heroku\u3078\u306e\u30c7\u30d7\u30ed\u30a4\u3092\u652f\u63f4\u3059\u308b\u305f\u3081\u306b\u4f7f\u308f\u308c\u308b\n* `README.md` - \u4f1d\u7d71\u7684\u306b\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u304c\u66f8\u304b\u308c\u308b\u30d5\u30a1\u30a4\u30eb\n* `project.clj` - Leiningen\u304c\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306e\u8a2d\u5b9a\u3068\u30e9\u30a4\u30d6\u30e9\u30ea\u306e\u4f9d\u5b58\u95a2\u4fc2\u3092\u7ba1\u7406\u3059\u308b\u305f\u3081\u306b\u4f7f\u308f\u308c\u308b\n* `profiles.clj` - \u30b3\u30fc\u30c9\u306e\u30ea\u30dd\u30b8\u30c8\u30ea\u306b\u5165\u308c\u305f\u304f\u306a\u3044\u30ed\u30fc\u30ab\u30eb\u8a2d\u5b9a\u3092\u884c\u3046\u305f\u3081\u306b\u4f7f\u308f\u308c\u308b\n* `.gitignore` - \u30d3\u30eb\u30c9\u306b\u3088\u3063\u3066\u751f\u6210\u3055\u308c\u305f\u30d5\u30a1\u30a4\u30eb\u7b49\u306eGit\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u7ba1\u7406\u304b\u3089\u9664\u5916\u3059\u308b\u30d5\u30a1\u30a4\u30eb\u306e\u30ea\u30b9\u30c8\n\n## \u30bd\u30fc\u30b9\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\n\u3059\u3079\u3066\u306e\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u306fsrc\u30d5\u30a9\u30eb\u30c0\u4ee5\u4e0b\u306b\u7f6e\u304b\u308c\u308b\u3002\n\u4eca\u56de\u4f5c\u6210\u3059\u308b\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306fguestbook\u3068\u3044\u3046\u540d\u524d\u306a\u306e\u3067\u3001\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306e\u6700\u4e0a\u4f4d\u306e\u540d\u524d\u7a7a\u9593\u306f\u3053\u306eguestbook\u306b\u306a\u308b\u3002\n\u3067\u306f\u3001\u4f5c\u6210\u3055\u308c\u305f\u3059\u3079\u3066\u306e\u540d\u524d\u7a7a\u9593\u306b\u95a2\u3057\u3066\u898b\u3066\u3044\u3053\u3046\u3002\n\n### guestbook\n\n* `core.clj` - \u30b5\u30fc\u30d0\u30fc\u306e\u8d77\u52d5\u3068\u7d42\u4e86\u306b\u95a2\u3059\u308b\u30ed\u30b8\u30c3\u30af\u3092\u542b\u3080\u3001\u3053\u306e\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u30a8\u30f3\u30c8\u30ea\u30dd\u30a4\u30f3\u30c8\u3067\u3042\u308b\u3002\n* `handler.clj` - \u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u57fa\u672c\u7684\u306a\u30eb\u30fc\u30c6\u30a3\u30f3\u30b0\u3092\u5b9a\u7fa9\u3059\u308b\u3002\u3053\u308c\u306f\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u30a8\u30f3\u30c8\u30ea\u30dd\u30a4\u30f3\u30c8\u3067\u3042\u308b\u3002\n* `layout.clj` - \u30da\u30fc\u30b8\u306e\u30b3\u30f3\u30c6\u30f3\u30c4\u3092\u63cf\u753b\u3059\u308b\u305f\u3081\u306e\u30ec\u30a4\u30a2\u30a6\u30c8\u30d8\u30eb\u30d1\u30fc\u3092\u8a18\u8ff0\u3059\u308b\u305f\u3081\u306e\u540d\u524d\u7a7a\u9593\u3067\u3042\u308b\u3002\n* `middleware.clj` - \u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u30ab\u30b9\u30bf\u30e0\u30df\u30c9\u30eb\u30a6\u30a7\u30a2\u3092\u542b\u3080\u540d\u524d\u7a7a\u9593\u3067\u3042\u308b\u3002\n\n### guestbook.db\n`db`\u540d\u524d\u7a7a\u9593\u306f\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u30e2\u30c7\u30eb\u3092\u5b9a\u7fa9\u3057\u3001\u6c38\u7d9a\u5316\u5c64\u3092\u51e6\u7406\u3059\u308b\u305f\u3081\u306b\u4f7f\u7528\u3055\u308c\u308b\u3002\n\n* `core.clj` - \u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3068\u306e\u3084\u308a\u53d6\u308a\u306e\u305f\u3081\u306e\u95a2\u6570\u3092\u4fdd\u6301\u3059\u308b\u305f\u3081\u306b\u4f7f\u7528\u3055\u308c\u308b\n* `migrations.clj` - \u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u30de\u30a4\u30b0\u30ec\u30fc\u30b7\u30e7\u30f3\u3092\u5b9f\u884c\u3059\u308b\u305f\u3081\u306b\u4f7f\u7528\u3055\u308c\u308b\n\n### guestbook.routes\n`routes`\u540d\u524d\u7a7a\u9593\u306fhome\u3068about\u30da\u30fc\u30b8\u306e\u30eb\u30fc\u30c6\u30a3\u30f3\u30b0\u5b9a\u7fa9\u3068\u30b3\u30f3\u30c8\u30ed\u30fc\u30e9\u304c\u914d\u7f6e\u3055\u308c\u308b\u5834\u6240\u3067\u3042\u308b\u3002\n\u3042\u306a\u305f\u304c\u8a8d\u8a3c\u306e\u3088\u3046\u306a\u8907\u6570\u306e\u30eb\u30fc\u30c6\u30a3\u30f3\u30b0\u5b9a\u7fa9\u3084\u7279\u5b9a\u306e\u30ef\u30fc\u30af\u30d5\u30ed\u30fc\u3092\u8ffd\u52a0\u3059\u308b\u5834\u5408\u306f\u3001\u3053\u3053\u306b\u305d\u306e\u305f\u3081\u306e\u540d\u524d\u7a7a\u9593\u3092\u4f5c\u6210\u3059\u308b\u5fc5\u8981\u304c\u3042\u308b\u3002\n\n* `home.clj` - \u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306ehome\u30da\u30fc\u30b8\u3068about\u30da\u30fc\u30b8\u3092\u5b9a\u7fa9\u3059\u308b\u540d\u524d\u7a7a\u9593\n\n## Env\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\n\u3053\u308c\u306f\u74b0\u5883\u4f9d\u5b58\u30b3\u30fc\u30c9\u306e\u30bd\u30fc\u30b9\u3092\u542b\u3080\u30d5\u30a9\u30eb\u30c0\u3067\u3042\u308b\u3002dev\u8a2d\u5b9a\u306f\u958b\u767a\u4e2d\u306b\u4f7f\u7528\u3055\u308c\u3001prod\u8a2d\u5b9a\u306f\u672c\u756a\u74b0\u5883\u7528\u306b\u30b3\u30f3\u30d1\u30a4\u30eb\u3055\u308c\u308b\u3068\u304d\u306b\u4f7f\u7528\u3055\u308c\u308b\u3002\n\n`config.clj` - \u901a\u5e38\u306f\u958b\u767a\u7528\u8a2d\u5b9a\u3092\u542b\u3080\n`dev_middleware.clj` - \u672c\u756a\u3067\u306f\u30b3\u30f3\u30d1\u30a4\u30eb\u3055\u308c\u308b\u3079\u304d\u3067\u306a\u3044\u958b\u767a\u6642\u306b\u4f7f\u7528\u3059\u308b\u30df\u30c9\u30eb\u30a6\u30a7\u30a2\u3092\u542b\u3080\n\n## \u30c6\u30b9\u30c8\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\n\u3053\u3053\u306f\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u30c6\u30b9\u30c8\u3092\u914d\u7f6e\u3059\u308b\u5834\u6240\u3067\u3042\u308a\u3001\u3044\u304f\u3064\u304b\u306e\u30b5\u30f3\u30d7\u30eb\u30c6\u30b9\u30c8\u304c\u3059\u3067\u306b\u5b9a\u7fa9\u3055\u308c\u3066\u3044\u308b\u3002\n\n## \u30ea\u30bd\u30fc\u30b9\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\n\u3053\u308c\u306f\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u3059\u3079\u3066\u306e\u9759\u7684\u306a\u30ea\u30bd\u30fc\u30b9\u3092\u914d\u7f6e\u3059\u308b\u5834\u6240\u3067\u3042\u308b\u3002\nresources\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u4e0b\u306epublic\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u914d\u7f6e\u3057\u305f\u30d5\u30a1\u30a4\u30eb\u306f\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u30b5\u30fc\u30d0\u30fc\u306b\u3088\u3063\u3066\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u306b\u305d\u306e\u307e\u307e\u914d\u4fe1\u3055\u308c\u308b\u3002\n\u3044\u304f\u3064\u304b\u306eCSS\u30ea\u30bd\u30fc\u30b9\u304c\u3059\u3067\u306b\u4f5c\u6210\u3055\u308c\u3066\u3044\u308b\u3002\n\n### HTML\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\n`templates`\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306f\u30da\u30fc\u30b8\u8868\u793a\u306e\u305f\u3081\u306e[Selmer](https://github.com/yogthos/Selmer)\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u306e\u305f\u3081\u306b\u6e96\u5099\u3055\u308c\u3066\u3044\u308b\u3002\n\n`about.html` - about\u30da\u30fc\u30b8\n`base.html` - \u30b5\u30a4\u30c8\u306e\u30d9\u30fc\u30b9\u30ec\u30a4\u30a2\u30a6\u30c8\n`home.html` - home\u30da\u30fc\u30b8\n\n### SQL\u30af\u30a8\u30ea\nSQL\u30af\u30a8\u30ea\u306f`resources/sql`\u30d5\u30a9\u30eb\u30c0\u306e\u4e2d\u306b\u3042\u308b\u3002\n\n`queries.sql` - SQL\u30af\u30a8\u30ea\u3068\u305d\u308c\u3089\u306b\u7d50\u3073\u3064\u304f\u95a2\u6570\u3092\u5b9a\u7fa9\u3059\u308b\u3002\n\n### \u30de\u30a4\u30b0\u30ec\u30fc\u30b7\u30e7\u30f3\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\nLuminus\u306f[Migratus](https://github.com/yogthos/migratus)\u3067\u30de\u30a4\u30b0\u30ec\u30fc\u30b7\u30e7\u30f3\u7ba1\u7406\u3092\u884c\u3063\u3066\u3044\u308b\u3002\n\u30de\u30a4\u30b0\u30ec\u30fc\u30b7\u30e7\u30f3\u306fup\u3068down\u306eSQL\u30d5\u30a1\u30a4\u30eb\u3067\u7ba1\u7406\u3055\u308c\u308b\u3002\n\n\u3053\u308c\u3089\u306e\u30d5\u30a1\u30a4\u30eb\u306f\u6163\u4f8b\u7684\u306b\u65e5\u4ed8\u3092\u4f7f\u3063\u3066\u30d0\u30fc\u30b8\u30e7\u30f3\u7ba1\u7406\u3055\u308c\u3001\u9806\u756a\u306b\u9069\u7528\u3055\u308c\u308b\u3002\n```\n20150718103127-add-users-table.up.sql - \u30c6\u30fc\u30d6\u30eb\u4f5c\u6210\u306e\u305f\u3081\u306e\u30de\u30a4\u30b0\u30ec\u30fc\u30b7\u30e7\u30f3\u30d5\u30a1\u30a4\u30eb\n20150718103127-add-users-table.down.sql - \u30c6\u30fc\u30d6\u30eb\u524a\u9664\u306e\u305f\u3081\u306e\u30de\u30a4\u30b0\u30ec\u30fc\u30b7\u30e7\u30f3\u30d5\u30a1\u30a4\u30eb\n```\n\n## \u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u30d5\u30a1\u30a4\u30eb\n\u4e0a\u3067\u8a18\u8ff0\u3057\u305f\u3088\u3046\u306b\u3001\u3059\u3079\u3066\u306e\u4f9d\u5b58\u95a2\u4fc2\u306f`project.clj`\u30d5\u30a1\u30a4\u30eb\u3092\u66f4\u65b0\u3059\u308b\u3053\u3068\u306b\u3088\u3063\u3066\u7ba1\u7406\u3055\u308c\u308b\u3002\u79c1\u305f\u3061\u306e\u4f5c\u6210\u3057\u305f\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u30d5\u30a1\u30a4\u30eb\u306f\u30eb\u30fc\u30c8\u30d5\u30a9\u30eb\u30c0\u306b\u5b58\u5728\u3057\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u5185\u5bb9\u3068\u306a\u3063\u3066\u3044\u308b\u3002\n\n```clj\n(defproject guestbook \"0.1.0-SNAPSHOT\"\n\n  :description \"FIXME: write description\"\n  :url \"http://example.com/FIXME\"\n\n:dependencies [[org.clojure/clojure \"1.7.0\"]\n               [selmer \"0.8.7\"]\n               [com.taoensso/timbre \"4.0.2\"]\n               [com.taoensso/tower \"3.0.2\"]\n               [markdown-clj \"0.9.67\"]\n               [environ \"1.0.0\"]\n               [compojure \"1.4.0\"]\n               [ring-webjars \"0.1.1\"]\n               [ring/ring-defaults \"0.1.5\"]\n               [ring-ttl-session \"0.1.1\"]\n               [ring \"1.4.0\"\n                :exclusions [ring/ring-jetty-adapter]]\n               [metosin/ring-middleware-format \"0.6.0\"]\n               [metosin/ring-http-response \"0.6.3\"]\n               [bouncer \"0.3.3\"]\n               [prone \"0.8.2\"]\n               [org.clojure/tools.nrepl \"0.2.10\"]\n               [org.webjars/bootstrap \"3.3.5\"]\n               [org.webjars/jquery \"2.1.4\"]\n               [migratus \"0.8.2\"]\n               [conman \"0.1.1\"]\n               [to-jdbc-uri \"0.2.0\"]\n               [com.h2database/h2 \"1.4.187\"]\n               [org.immutant/web \"2.0.2\"]]\n\n  :min-lein-version \"2.0.0\"\n  :uberjar-name \"guestbook.jar\"\n  :jvm-opts [\"-server\"]\n\n  :main guestbook.core\n  :migratus {:store :database}\n\n  :plugins [[lein-environ \"1.0.0\"]\n            [lein-ancient \"0.6.5\"]\n            [migratus-lein \"0.1.5\"]]\n  :profiles\n  {:uberjar {:omit-source true\n             :env {:production true}\n             :aot :all}\n   :dev           [:project/dev :profiles/dev]\n   :test          [:project/test :profiles/test]\n   :project/dev  {:dependencies [[ring/ring-mock \"0.2.0\"]\n                                 [ring/ring-devel \"1.4.0\"]\n                                 [pjstadig/humane-test-output \"0.7.0\"]\n                                 [mvxcvi/puget \"0.8.1\"]]\n\n\n                  :repl-options {:init-ns guestbook.core}\n                  :injections [(require 'pjstadig.humane-test-output)\n                               (pjstadig.humane-test-output/activate!)]\n                  ;;when :nrepl-port is set the application starts the nREPL server on load\n                  :env {:dev        true\n                        :port       3000\n                        :nrepl-port 7000}}\n   :project/test {:env {:test       true\n                        :port       3001\n                        :nrepl-port 7001}}\n   :profiles/dev {}\n   :profiles/test {}})\n```\n\n`project.clj`\u306f\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306b\u3064\u3044\u3066\u305d\u308c\u305e\u308c\u7570\u306a\u3063\u305f\u89b3\u70b9\u304b\u3089\u8a18\u8ff0\u3057\u305f\u3001\u30ad\u30fc\u3068\u5024\u306e\u30da\u30a2\u3092\u542b\u3093\u3060\u5358\u306a\u308bClojure\u306e\u30ea\u30b9\u30c8\u3067\u3042\u308b\u3053\u3068\u304c\u5206\u304b\u308b\u3060\u308d\u3046\u3002\n\n\u305f\u3044\u3066\u3044\u306e\u5834\u5408\u3001\u65b0\u3057\u3044\u30e9\u30a4\u30d6\u30e9\u30ea\u3092\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306b\u8ffd\u52a0\u3059\u308b\u3053\u3068\u304c\u591a\u3044\u3002\u3053\u308c\u3089\u306e\u30e9\u30a4\u30d6\u30e9\u30ea\u306f\u7279\u306b`:dependencies`\u306e\u30d9\u30af\u30c8\u30eb\u3092\u4f7f\u3046\u3002\u65b0\u3057\u3044\u30e9\u30a4\u30d6\u30e9\u30ea\u3092\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u5185\u3067\u4f7f\u3046\u306b\u306f\u3001\u79c1\u305f\u3061\u306f\u305f\u3060\u4f9d\u5b58\u95a2\u4fc2\u3092\u3053\u3053\u306b\u8ffd\u52a0\u3059\u308b\u3060\u3051\u3067\u3044\u3044\u3002\n\n`:plugins`\u30d9\u30af\u30c8\u30eb\u5185\u306e\u8981\u7d20\u306f\u74b0\u5883\u5909\u6570\u306e\u8aad\u307f\u8fbc\u307f\uff08via. Environ plugin\uff09\u306a\u3069\u306e\u6a5f\u80fd\u6027\u306e\u8ffd\u52a0\u3092\u63d0\u4f9b\u3059\u308b\u305f\u3081\u306b\u4f7f\u308f\u308c\u308b\u3002\n\n`:profiles`\u306f\u3001\u958b\u767a\u3042\u308b\u3044\u306f\u672c\u756a\u74b0\u5883\u306e\u30d3\u30eb\u30c9\u306b\u5411\u3051\u3066\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092\u521d\u671f\u5316\u3059\u308b\u305f\u3081\u306b\u4f7f\u7528\u3059\u308b\u3002\n\u3053\u308c\u306f\u74b0\u5883\u3054\u3068\u306b\u7570\u306a\u308bmap\u5f62\u5f0f\u306e\u8a2d\u5b9a\u3068\u306a\u3063\u3066\u3044\u308b\u3002\n\n\u3053\u306e\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306f`:dev`\u3068`:test`\u306e\u8907\u5408\u30d7\u30ed\u30d5\u30a1\u30a4\u30eb\u3068\u3057\u3066\u8a2d\u5b9a\u3057\u3066\u3044\u308b\u3053\u3068\u3092\u8a18\u3057\u3066\u304a\u304f\u3002\n\u3053\u308c\u3089\u306e\u30d7\u30ed\u30d5\u30a1\u30a4\u30eb\u306f`:project/dev`\u3068`:project/test`\u304b\u3089\u306e\u5909\u6570\u3060\u3051\u3067\u306a\u304f\u3001`profiles.clj`\u4e2d\u306e`:project/dev`\u3068`:project/test`\u304b\u3089\u306e\u5909\u6570\u3082\u542b\u3093\u3067\u3044\u308b\u3002\n\n\u5f8c\u8005\u306b\u306f\u5171\u6709\u306e\u30b3\u30fc\u30c9\u30ea\u30dd\u30b8\u30c8\u30ea\u306b\u30c1\u30a7\u30c3\u30af\u30a4\u30f3\u3057\u306a\u3044\u30ed\u30fc\u30ab\u30eb\u74b0\u5883\u5909\u6570\u3092\u542b\u3080\u3079\u304d\u3067\u3042\u308b\u3002\n\n`project.clj`\u30d3\u30eb\u30c9\u30d5\u30a1\u30a4\u30eb\u306e\u69cb\u7bc9\u306b\u95a2\u3059\u308b\u3088\u308a\u8a73\u7d30\u306a\u4e8b\u9805\u306b\u95a2\u3057\u3066\u306f\u516c\u5f0f\u306e`Leiningen`\u306e\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u3092\u53c2\u7167\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n## \u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306e\u4f5c\u6210\n\u307e\u305a\u3001\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u30e2\u30c7\u30eb\u3092\u4f5c\u308b\u305f\u3081\u306b`migrations`\u30d5\u30a9\u30eb\u30c0\u4e2d\u306b\u914d\u7f6e\u3055\u308c\u3066\u3044\u308b`<date>-add-users-table.up.sql`\u3092\u958b\u3053\u3046\u3002\n\u30d5\u30a1\u30a4\u30eb\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u8a18\u8ff0\u306b\u306a\u3063\u3066\u3044\u308b\u3002\n\n```sql\nCREATE TABLE users\n(id VARCHAR(20) PRIMARY KEY,\n first_name VARCHAR(30),\n last_name VARCHAR(30),\n email VARCHAR(30),\n admin BOOLEAN,\n last_login TIME,\n is_active BOOLEAN,\n pass VARCHAR(100));\n```\n\n\u4ee5\u4e0b\u306e\u3088\u3046\u306b`users`\u30c6\u30fc\u30d6\u30eb\u3092\u79c1\u305f\u3061\u306e\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306b\u3088\u308a\u9069\u5207\u306a\u5f62\u306b\u66f8\u304d\u63db\u3048\u3088\u3046\u3002\n\n```sql\nCREATE TABLE guestbook\n(id INTEGER PRIMARY KEY AUTO_INCREMENT,\n name VARCHAR(30),\n message VARCHAR(200),\n timestamp TIMESTAMP);\n```\n\n`guestbook`\u30c6\u30fc\u30d6\u30eb\u306f\u30b3\u30e1\u30f3\u30c8\u3057\u305f\u4eba\u306e\u540d\u524d\u3001\u30e1\u30c3\u30bb\u30fc\u30b8\u306e\u5185\u5bb9\u3001\u30bf\u30a4\u30e0\u30b9\u30bf\u30f3\u30d7\u306a\u3069\u306e\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u8a18\u8ff0\u3059\u308b\u3059\u3079\u3066\u306e\u30d5\u30a3\u30fc\u30eb\u30c9\u3092\u4fdd\u5b58\u3059\u308b\u3002\n\u30d5\u30a1\u30a4\u30eb\u3092\u4fdd\u5b58\u3057\u3066\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306e\u30eb\u30fc\u30c8\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3067\u4ee5\u4e0b\u306e\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3057\u3088\u3046\u3002\n\n```bash\n$ lein run migrate\n```\n\n\u3082\u3057\u3001\u3059\u3079\u3066\u304c\u3046\u307e\u304f\u884c\u3063\u305f\u306a\u3089\u3001\u3053\u308c\u3067\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u304c\u521d\u671f\u5316\u3055\u308c\u308b\u306f\u305a\u3060\u3002\n\n## \u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3078\u306e\u30a2\u30af\u30bb\u30b9\n\n\u6b21\u306b`src/guestbook/db/core.clj`\u30d5\u30a1\u30a4\u30eb\u3092\u898b\u3066\u307f\u3088\u3046\u3002\n\u3053\u3053\u306b\u306f\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3078\u306e\u63a5\u7d9a\u8a2d\u5b9a\u304c\u3059\u3067\u306b\u3042\u308b\u3053\u3068\u304c\u5206\u304b\u308b\u3002\n\n```clj\n(ns guestbook.db.core\n  (:require\n    [clojure.java.jdbc :as jdbc]\n    [yesql.core :refer [defqueries]]\n    [taoensso.timbre :as timbre]\n    [environ.core :refer [env]])\n  (:import java.sql.BatchUpdateException))\n\n(def conn\n  {:classname   \"org.h2.Driver\"\n   :connection-uri (:database-url env)\n   :make-pool?     true\n   :naming         {:keys   clojure.string/lower-case\n                    :fields clojure.string/upper-case}})\n\n(defqueries \"sql/queries.sql\" {:connection conn})\n```\n\n\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306e\u63a5\u7d9a\u8a2d\u5b9a\u306f\u5b9f\u884c\u6642\u306e`:database-url`\u74b0\u5883\u5909\u6570\u304b\u3089\u8aad\u307f\u8fbc\u307e\u308c\u308b\u3002\n\u3053\u306e\u5909\u6570\u306f\u958b\u767a\u74b0\u5883\u306e\u5834\u5408\u306f`profiles.clj`\u304b\u3089\u53d6\u308a\u8fbc\u307e\u308c\u3001\u672c\u756a\u74b0\u5883\u306e\u5834\u5408\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u74b0\u5883\u5909\u6570\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u5fc5\u8981\u304c\u3042\u308b\u3002\n\n```bash\n$ export DATABASE_URL=\"jdbc:h2:./guestbook.db\"\n```\n\nH2 embedded database\u3092\u4f7f\u7528\u3059\u308b\u305f\u3081\u3001URL\u306e\u4e2d\u3067\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092\u8d77\u52d5\u3057\u305f\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u304b\u3089\u306e\u76f8\u5bfe\u30d1\u30b9\u3067\u6307\u5b9a\u3057\u305f\u30d5\u30a1\u30a4\u30eb\u306b\u30c7\u30fc\u30bf\u306f\u4fdd\u5b58\u3055\u308c\u308b\u3002\n\n\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306e\u30af\u30a8\u30ea\u306b\u30de\u30c3\u30d4\u30f3\u30b0\u3055\u308c\u308b\u95a2\u6570\u306f`defqueries`\u304c\u547c\u3073\u51fa\u3055\u308c\u305f\u6642\u306b\u751f\u6210\u3055\u308c\u308b\u3002\n\u305d\u306e`defqueries`\u306f`sql/queries.sql`\u30d5\u30a1\u30a4\u30eb\u3092\u53c2\u7167\u3057\u3066\u3044\u308b\u3053\u3068\u304c\u5206\u304b\u308b\u3060\u308d\u3046\u3002\n\u3053\u306e\u30d5\u30a1\u30a4\u30eb\u306f`resources`\u306e\u4e2d\u306b\u3042\u308b\u306e\u3067\u3001\u30d5\u30a1\u30a4\u30eb\u3092\u958b\u3044\u3066\u4e2d\u8eab\u3092\u898b\u3066\u307f\u3088\u3046\u3002\n\n```sql\n-- name: create-user!\n-- creates a new user record\nINSERT INTO users\n(id, first_name, last_name, email, pass)\nVALUES (:id, :first_name, :last_name, :email, :pass)\n\n-- name: update-user!\n-- update an existing user record\nUPDATE users\nSET first_name = :first_name, last_name = :last_name, email = :email\nWHERE id = :id\n\n-- name: get-user\n-- retrieve a user given the id.\nSELECT * FROM users\nWHERE id = :id\n```\n\n\u5404\u95a2\u6570\u306f`-- name:[\u95a2\u6570\u540d]`\u3068\u3044\u3046\u5f62\u5f0f\u306e\u30b3\u30e1\u30f3\u30c8\u3092\u4f7f\u7528\u3059\u308b\u3053\u3068\u3067\u5b9a\u7fa9\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u304c\u5206\u304b\u308b\u3060\u308d\u3046\u3002\n\u95a2\u6570\u540d\u3092\u5b9a\u7fa9\u3057\u305f\u6b21\u306e\u884c\u306e\u30b3\u30e1\u30f3\u30c8\u306f\u95a2\u6570\u306e\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u306b\u306a\u3063\u3066\u304a\u308a\u3001\u3055\u3089\u306b\u6b21\u306e\u884c\u304b\u3089SQL\u3092\u8a18\u8ff0\u3059\u308b\u3088\u3046\u306a\u5f62\u5f0f\u306b\u306a\u3063\u3066\u3044\u308b\u3002\nSQL\u3067\u4f7f\u7528\u3059\u308b\u30d1\u30e9\u30e1\u30fc\u30bf\u306f`:[\u30d1\u30e9\u30e1\u30fc\u30bf\u540d]`\u3068\u3044\u3046\u8868\u8a18\u306b\u306a\u3063\u3066\u3044\u308b\u3002\n\u5b9f\u969b\u306b\u30af\u30a8\u30ea\u306e\u5185\u5bb9\u3092\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u66f8\u304d\u63db\u3048\u3066\u307f\u3088\u3046\u3002\n\n```sql\n-- name:save-message!\n-- creates a new message\nINSERT INTO guestbook\n(name, message, timestamp)\nVALUES (:name, :message, :timestamp)\n\n-- name:get-messages\n-- selects all available messages\nSELECT * from guestbook\n```\n\n\u6700\u5f8c\u306b\u3053\u306e\u540d\u524d\u7a7a\u9593\u306f`run`\u3068\u3044\u3046\u30d8\u30eb\u30d1\u30fc\u95a2\u6570\u3092\u63d0\u4f9b\u3057\u3066\u304f\u308c\u308b\u3002\u3053\u306e\u95a2\u6570\u306f`conn`\u3068\u3044\u3046\u30a2\u30c8\u30e0\u304b\u3089\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3078\u306e\u63a5\u7d9a\u3092\u63a2\u3057\u3066\u30af\u30a8\u30ea\u95a2\u6570\u3092\u5b9f\u884c\u3059\u308b\u3002\n\n## \u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u8d77\u52d5\u3059\u308b\n\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u3057\u3066\u958b\u767a\u30e2\u30fc\u30c9\u3067\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u8d77\u52d5\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u308b\u3002\n\n```shell-session\n>lein run\n00:49:54.865 [main] DEBUG org.jboss.logging - Logging Provider: org.jboss.logging.Slf4jLoggerProvider\n15-Jul-19 00:49:55 Nyx INFO [guestbook.handler] - nREPL server started on port 7000\n15-Jul-19 00:49:55 Nyx INFO [guestbook.handler] -\n-=[guestbook started successfullyusing the development profile]=-\n00:49:55.772 INFO  [org.projectodd.wunderboss.web.Web] (main) Registered web context /\n15-Jul-19 00:49:55 Nyx INFO [guestbook.core] - server started on port: 3000\n```\n\n\u4e00\u5ea6\u30b5\u30fc\u30d0\u30fc\u3092\u8d77\u52d5\u3057\u305f\u3089\u3001\u30d6\u30e9\u30a6\u30b6\u3067`http://localhost:3000`\u3092\u958b\u304f\u3053\u3068\u304c\u3067\u304d\u3001\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u304c\u52d5\u4f5c\u3057\u3066\u3044\u308b\u3053\u3068\u304c\u5206\u304b\u308b\u306f\u305a\u3060\u3002\u8d77\u52d5\u6642\u306b\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u30d1\u30e9\u30e1\u30fc\u30bf\u3092\u6307\u5b9a\u3059\u308b\u304b\u3001`PORT`\u3068\u3044\u3046\u74b0\u5883\u5909\u6570\u3092\u8a2d\u5b9a\u3059\u308b\u3053\u3068\u3067\u30b5\u30fc\u30d0\u30fc\u3092\u5225\u306e\u30dd\u30fc\u30c8\u3067\u8d77\u52d5\u3055\u305b\u308b\u3053\u3068\u304c\u3067\u304d\u308b\u3002\n\n```shell-session\nlein run 8000\n```\n\n\u8868\u793a\u3055\u308c\u305f\u30da\u30fc\u30b8\u304c\u79c1\u305f\u3061\u306b\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3092\u521d\u671f\u5316\u3059\u308b\u305f\u3081\u306e\u30de\u30a4\u30b0\u30ec\u30fc\u30b7\u30e7\u30f3\u3092\u5b9f\u884c\u3059\u308b\u3053\u3068\u3092\u5373\u3057\u3066\u308b\u3053\u3068\u306b\u6ce8\u610f\u3057\u3066\u307b\u3057\u3044\u3002\u3057\u304b\u3057\u3001\u79c1\u305f\u3061\u306f\u3059\u3067\u306b\u30de\u30a4\u30b0\u30ec\u30fc\u30b7\u30e7\u30f3\u3092\u4ee5\u524d\u884c\u3063\u3066\u3044\u308b\u305f\u3081\u3001\u3082\u3046\u4e00\u5ea6\u884c\u3046\u5fc5\u8981\u306f\u306a\u3044\u3002\n\n## \u30da\u30fc\u30b8\u306e\u4f5c\u6210\u3068\u5165\u529b\u30d5\u30a9\u30fc\u30e0\u306e\u53d6\u308a\u6271\u3044\n\u30eb\u30fc\u30c6\u30a3\u30f3\u30b0\u5b9a\u7fa9\u306f`guestbook.routes.home`\u540d\u524d\u7a7a\u9593\u306b\u5b9a\u7fa9\u3055\u308c\u3066\u3044\u308b\u3002\u305d\u306e\u30d5\u30a1\u30a4\u30eb\u3092\u958b\u304d\u3001\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u304b\u3089\u53d6\u308a\u51fa\u3057\u305f\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u8868\u793a\u3059\u308b\u305f\u3081\u306e\u30ed\u30b8\u30c3\u30af\u3092\u8ffd\u52a0\u3057\u3088\u3046\u3002\n\u307e\u305a\u306f\u3058\u3081\u306b`db`\u3001[Bouncer](https://github.com/leonardoborges/bouncer)\u3001[ring.util.response](http://ring-clojure.github.io/ring/ring.util.response.html)\u306e\u540d\u524d\u7a7a\u9593\u3078\u306e\u53c2\u7167\u3092\u4e00\u7dd2\u306b\u8ffd\u52a0\u3059\u308b\u5fc5\u8981\u304c\u3042\u308b\u3002\n\n```clj\n(ns guestbook.routes.home\n  (:require\n    ...\n    [guestbook.db.core :as db]\n    [bouncer.core :as b]\n    [bouncer.validators :as v]\n    [ring.util.response :refer [redirect]]))\n```\n\n\u6b21\u306b\u30d5\u30a9\u30fc\u30e0\u306e\u30d1\u30e9\u30e1\u30fc\u30bf\u3092\u30d0\u30ea\u30c7\u30fc\u30c8\u3059\u308b\u305f\u3081\u306e\u95a2\u6570\u3092\u4f5c\u308b\u3002\n\n```clj\n(defn validate-message [params]\n  (first\n    (b/validate\n      params\n      :name v/required\n      :message [v/required [v/min-count 10]])))\n```\n\n\u3053\u306e\u95a2\u6570\u306f`:name`\u3068`:message`\u306e\u30ad\u30fc\u306b\u5bfe\u5fdc\u3059\u308b\u5024\u304c\u79c1\u305f\u3061\u304c\u5b9a\u3081\u305f\u30eb\u30fc\u30eb\u5f93\u3063\u3066\u3044\u308b\u304b\u30c1\u30a7\u30c3\u30af\u3059\u308b\u305f\u3081\u306bBouncer\u306e`validate`\u95a2\u6570\u3092\u4f7f\u7528\u3057\u3066\u3044\u308b\u3002\n\u5177\u4f53\u7684\u306b\u306f\u3001name\u306f\u5fc5\u9808\u3067\u3001message\u306f\u5c11\u306a\u304f\u3068\u308210\u6587\u5b57\u3067\u3042\u308b\u5fc5\u8981\u304c\u3042\u308b\u3088\u3046\u306b\u3057\u3066\u3044\u308b\u3002\nBouncer\u306fmessage\u306e\u5834\u5408\u306e\u3088\u3046\u306b\u30d0\u30ea\u30c7\u30fc\u30bf\u306b\u8907\u6570\u306e\u30eb\u30fc\u30eb\u3092\u6e21\u3059\u305f\u3081\u306b\u30d9\u30af\u30bf\u69cb\u6587\u3092\u4f7f\u7528\u3057\u3066\u3044\u308b\u3002\n\n`min-count`\u3092\u4f7f\u7528\u3057\u305f\u5834\u5408\u306e\u3088\u3046\u306b\u30d0\u30ea\u30c7\u30fc\u30bf\u304c\u8ffd\u52a0\u306e\u30d1\u30e9\u30e1\u30fc\u30bf\u3092\u3068\u308b\u5834\u5408\u3001\u30d9\u30af\u30bf\u69cb\u6587\u304c\u540c\u69d8\u306b\u4f7f\u7528\u3055\u308c\u308b\u3002\u305d\u306e\u5024\u306f\u3001\u6697\u9ed9\u7684\u306b\u7b2c\u4e00\u5f15\u6570\u3068\u3057\u3066\u30d0\u30ea\u30c7\u30fc\u30bf\u306b\u6e21\u3055\u308c\u307e\u3059\u3002\n\n\u3053\u3046\u3057\u3066\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u30d0\u30ea\u30c7\u30fc\u30c8\u3057\u3001\u4fdd\u5b58\u3059\u308b\u305f\u3081\u306e\u95a2\u6570\u3092\u8ffd\u52a0\u3057\u305f\u3002\n\n```clj\n(defn save-message! [{:keys [params]}]\n  (if-let [errors (validate-message params)]\n    (-> (redirect \"/\")\n        (assoc :flash (assoc params :errors errors)))\n    (do\n      (db/save-message!\n       (assoc params :timestamp (java.util.Date.)))\n      (redirect \"/\"))))\n```\n\n\u3053\u306e\u95a2\u6570\u306f\u30d5\u30a9\u30fc\u30e0\u306e\u30d1\u30e9\u30e1\u30fc\u30bf\u3092\u542b\u3080\u30ea\u30af\u30a8\u30b9\u30c8\u304b\u3089\u306e`:params`\u30ad\u30fc\u3092\u53d6\u5f97\u3059\u308b\u3002\n`validate-message`\u95a2\u6570\u304c\u30a8\u30e9\u30fc\u3092\u8fd4\u3057\u305f\u5834\u5408\u3001`/`\u306b\u30ea\u30c0\u30a4\u30ec\u30af\u30c8\u3057\u3001\u30a8\u30e9\u30fc\u3068\u4e00\u7dd2\u306b\u63d0\u4f9b\u3055\u308c\u305f\u30d1\u30e9\u30e1\u30fc\u30bf\u3092\u5165\u308c\u305f\u30ec\u30b9\u30dd\u30f3\u30b9\u3092`:flash`\u30ad\u30fc\u306b\u95a2\u9023\u4ed8\u3051\u308b\u3002\n\u30a8\u30e9\u30fc\u3092\u8fd4\u3055\u306a\u3044\u5834\u5408\u3001\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306b\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u4fdd\u5b58\u3057\u3001\u30ea\u30c0\u30a4\u30ec\u30af\u30c8\u3059\u308b\u3002\n\n\u3055\u3089\u306b`home-page`\u30b3\u30f3\u30c8\u30ed\u30fc\u30e9\u3092\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u5909\u66f4\u3059\u308b\u3002\n\n```clj\n(defn home-page [{:keys [flash]}]\n  (layout/render\n   \"home.html\"\n   (merge {:messages (db/get-messages)}\n          (select-keys flash [:name :message :errors]))))\n```\n\n\u3053\u306e\u95a2\u6570\u306f\u30d0\u30ea\u30c7\u30fc\u30c8\u30a8\u30e9\u30fc\u306a\u3069\u306e`:flash`\u30bb\u30c3\u30b7\u30e7\u30f3\u304b\u3089\u306e\u3059\u3079\u3066\u306e\u30d1\u30e9\u30e1\u30fc\u30bf\u3068\u4e00\u7dd2\u306b\u73fe\u5728\u4fdd\u5b58\u3055\u308c\u3066\u3044\u308b\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u306b\u6e21\u3057\u3066home\u30da\u30fc\u30b8\u306e\u63cf\u753b\u3059\u308b\u3002\n\n\u30eb\u30fc\u30c6\u30a3\u30f3\u30b0\u306e\u8a2d\u5b9a\u3068\u3057\u3066\u306f`home-page`\u3068`save-message!`\u306e\u4e21\u65b9\u306b\u30ea\u30af\u30a8\u30b9\u30c8\u3092\u6e21\u3059\u5fc5\u8981\u304c\u3042\u308b\u3002\n\n```clj\n(defroutes home-routes\n  (GET \"/\" request (home-page request))\n  (POST \"/\" request (save-message! request))\n  (GET \"/about\" [] (about-page)))\n```\n\n`compojure.core`\u304b\u3089`POST`\u3092\u53c2\u7167\u3067\u304d\u308b\u3088\u3046\u306b\u3059\u308b\u3053\u3068\u3092\u5fd8\u308c\u306a\u3044\u3088\u3046\u306b\u3057\u3088\u3046\u3002\n\n```clj\n(ns guestbook.routes.home\n  (:require ...\n            [compojure.core :refer [defroutes GET POST]]\n            ...))\n```\n\n\u30b3\u30f3\u30c8\u30ed\u30fc\u30e9\u304c\u51fa\u6765\u4e0a\u304c\u3063\u305f\u306e\u3067\u3001`resources/templates`\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u5185\u306b\u3042\u308b`home.html`\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u306e\u30d5\u30a1\u30a4\u30eb\u3092\u958b\u3053\u3046\u3002\n\u305d\u306e\u307e\u307e\u306e\u72b6\u614b\u3060\u3068\u3001`content`\u30d6\u30ed\u30c3\u30af\u4e2d\u306e`content`\u5909\u6570\u306e\u5185\u5bb9\u3092\u305f\u3060\u8868\u793a\u3059\u308b\u3060\u3051\u306b\u306a\u3063\u3066\u3044\u308b\u3002\n\n```html\n{% extends \"base.html\" %}\n{% block content %}\n  <div class=\"jumbotron\">\n    <h1>Welcome to guestbook</h1>\n    <p>Time to start building your site!</p>\n    <p><a class=\"btn btn-primary btn-lg\" href=\"http://luminusweb.net\">Learn more &raquo;</a></p>\n  </div>\n\n  <div class=\"row\">\n    <div class=\"span12\">\n    {{docs|markdown}}\n    </div>\n  </div>\n{% endblock %}\n```\n\n\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u7e70\u308a\u8fd4\u3057\u51e6\u7406\u3059\u308b\u3088\u3046\u306b\u3057\u3001\u30ea\u30b9\u30c8\u4e2d\u306e\u305d\u308c\u305e\u308c\u306e\u5024\u3092\u8868\u793a\u3059\u308b\u3088\u3046\u306b`content`\u30d6\u30ed\u30c3\u30af\u3092\u5909\u66f4\u3057\u3088\u3046\u3002\n\n```html\n{% extends \"base.html\" %}\n{% block content %}\n  <div class=\"jumbotron\">\n    <h1>Welcome to guestbook</h1>\n    <p>Time to start building your site!</p>\n    <p><a class=\"btn btn-primary btn-lg\" href=\"http://luminusweb.net\">Learn more &raquo;</a></p>\n  </div>\n\n  <div class=\"row\">\n    <div class=\"span12\">\n        <ul class=\"messages\">\n            {% for item in messages %}\n            <li>\n                <time>{{item.timestamp|date:\"yyyy-MM-dd HH:mm\"}}</time>\n                <p>{{item.message}}</p>\n                <p> - {{item.name}}</p>\n            </li>\n            {% endfor %}\n        </ul>\n    </div>\n</div>\n{% endblock %}\n```\n\n\u4e0a\u8a18\u306e\u3088\u3046\u306b\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u7e70\u308a\u8fd4\u3057\u51e6\u7406\u3059\u308b\u305f\u3081\u306bfor\u30a4\u30c6\u30ec\u30fc\u30bf\u3092\u4f7f\u7528\u3057\u305f\u3002\u305d\u308c\u305e\u308c\u306e\u30e1\u30c3\u30bb\u30fc\u30b8\u306f`message`\u3001`name`\u3001\u3000`timestamp`\u306e\u30ad\u30fc\u3092\u4f7f\u7528\u3057\u305f\u30de\u30c3\u30d7\u306b\u306a\u3063\u3066\u3044\u308b\u305f\u3081\u3001\u30ad\u30fc\u306e\u540d\u524d\u3067\u30a2\u30af\u30bb\u30b9\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u308b\u3002\u30bf\u30a4\u30e0\u30b9\u30bf\u30f3\u30d7\u3092\u4eba\u9593\u304c\u8aad\u3080\u3053\u3068\u306e\u3067\u304d\u308b\u5f62\u5f0f\u306b\u5909\u63db\u3059\u308b\u65e5\u4ed8\u30d5\u30a3\u30eb\u30bf\u30fc\u304c\u4f7f\u7528\u3067\u304d\u308b\u3053\u3068\u3082\u8a18\u3057\u3066\u304a\u3053\u3046\u3002\n\n\u6700\u5f8c\u306b\u30e6\u30fc\u30b6\u30fc\u304c\u30e1\u30c3\u30bb\u30fc\u30b8\u306e\u9001\u4fe1\u3059\u308b\u305f\u3081\u306e\u30d5\u30a9\u30fc\u30e0\u3092\u4f5c\u6210\u3059\u308b\u3002\u30e6\u30fc\u30b6\u30fc\u304c\u9001\u4fe1\u3057\u305fname\u3068message\u306e\u5024\u3092\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u306b\u306f\u3081\u8fbc\u307f\u3001\u305d\u308c\u3089\u306b\u95a2\u9023\u3059\u308b\u3059\u3079\u3066\u306e\u30a8\u30e9\u30fc\u3092\u63cf\u753b\u3059\u308b\u3002\n\u307e\u305f\u3001CSRF\u5bfe\u7b56\u306e\u305f\u3081\u306b\u30d5\u30a9\u30fc\u30e0\u5185\u3067`csrf-field`\u30bf\u30b0\u3092\u4f7f\u7528\u3057\u3066\u3044\u308b\u3002\n\n```html\n<div class=\"row\">\n    <div class=\"span12\">\n        <form method=\"POST\" action=\"/\">\n                {% csrf-field %}\n                <p>\n                    Name:\n                    <input class=\"form-control\"\n                           type=\"text\"\n                           name=\"name\"\n                           value=\"{{name}}\" />\n                </p>\n                {% if errors.name %}\n                <div class=\"alert alert-danger\">{{errors.name|join}}</div>\n                {% endif %}\n                <p>\n                    Message:\n                <textarea class=\"form-control\"\n                          rows=\"4\"\n                          cols=\"50\"\n                          name=\"message\">{{message}}</textarea>\n                </p>\n                {% if errors.message %}\n                <div class=\"alert alert-danger\">{{errors.message|join}}</div>\n                {% endif %}\n                <input type=\"submit\" class=\"btn btn-primary\" value=\"comment\" />\n        </form>\n    </div>\n</div>\n```\n\n\u6700\u7d42\u7684\u306a`home.html`\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u306a\u308b\u3060\u308d\u3046\u3002\n\n```html\n{% extends \"base.html\" %}\n{% block content %}\n<div class=\"row\">\n    <div class=\"span12\">\n        <ul class=\"messages\">\n            {% for item in messages %}\n            <li>\n                <time>{{item.timestamp|date:\"yyyy-MM-dd HH:mm\"}}</time>\n                <p>{{item.message}}</p>\n                <p> - {{item.name}}</p>\n            </li>\n            {% endfor %}\n        </ul>\n    </div>\n</div>\n<div class=\"row\">\n    <div class=\"span12\">\n        <form method=\"POST\" action=\"/\">\n                {% csrf-field %}\n                <p>\n                    Name:\n                    <input class=\"form-control\"\n                           type=\"text\"\n                           name=\"name\"\n                           value=\"{{name}}\" />\n                </p>\n                {% if errors.name %}\n                <div class=\"alert alert-danger\">{{errors.name|join}}</div>\n                {% endif %}\n                <p>\n                    Message:\n                <textarea class=\"form-control\"\n                          rows=\"4\"\n                          cols=\"50\"\n                          name=\"message\">{{message}}</textarea>\n                </p>\n                {% if errors.message %}\n                <div class=\"alert alert-danger\">{{errors.message|join}}</div>\n                {% endif %}\n                <input type=\"submit\" class=\"btn btn-primary\" value=\"comment\" />\n        </form>\n    </div>\n</div>\n{% endblock %}\n```\n\n\u5165\u529b\u30d5\u30a9\u30fc\u30e0\u3092\u3088\u308a\u304b\u3063\u3053\u3088\u304f\u6574\u5f62\u3059\u308b\u305f\u3081\u306b`resources/public/css`\u30d5\u30a9\u30eb\u30c0\u306b\u914d\u7f6e\u3055\u308c\u305f`screen.css`\u30d5\u30a1\u30a4\u30eb\u3092\u66f4\u65b0\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u3063\u305f\u3002\n\n```css\nbody {\n\theight: 100%;\n\tpadding-top: 70px;\n\tfont: 14px 'Helvetica Neue', Helvetica, Arial, sans-serif;\n\tline-height: 1.4em;\n\tbackground: #eaeaea;\n\twidth: 550px;\n\tmargin: 0 auto;\n}\n\n.messages {\n  background: white;\n  width: 520px;\n}\nul {\n\tlist-style: none;\n}\n\nul.messages li {\n\tposition: relative;\n\tfont-size: 16px;\n\tpadding: 5px;\n\tborder-bottom: 1px dotted #ccc;\n}\n\nli:last-child {\n\tborder-bottom: none;\n}\n\nli time {\n\tfont-size: 12px;\n\tpadding-bottom: 20px;\n}\n\nform, .error {\n\twidth: 520px;\n\tpadding: 30px;\n\tmargin-bottom: 50px;\n\tposition: relative;\n  background: white;\n}\n```\n\n\u3053\u308c\u3067\u30d6\u30e9\u30a6\u30b6\u306e\u30da\u30fc\u30b8\u3092\u30ea\u30ed\u30fc\u30c9\u3059\u308c\u3070\u30b2\u30b9\u30c8\u30d6\u30c3\u30af\u306e\u30da\u30fc\u30b8\u306b\u5bfe\u9762\u3059\u308b\u3053\u3068\u306b\u306a\u308b\u3060\u308d\u3046\u3002\u30b2\u30b9\u30c8\u30d6\u30c3\u30af\u306b\u30b3\u30e1\u30f3\u30c8\u3092\u8ffd\u52a0\u3057\u3001\u305d\u308c\u304c\u6b63\u3057\u304f\u52d5\u4f5c\u3059\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3057\u3066\u307f\u3088\u3046\u3002\n\n## \u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u30d1\u30c3\u30b1\u30fc\u30b8\u30f3\u30b0\n\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306f\u4ee5\u4e0b\u306e\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3059\u308b\u3053\u3068\u306b\u3088\u3063\u3066\u30b9\u30bf\u30f3\u30c9\u30a2\u30ed\u30fc\u30f3\u3067\u306e\u30c7\u30d7\u30ed\u30a4\u5f62\u5f0f\u306b\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u308b\u3002\n\n```bash\n$ lein uberjar\n```\n\n\u3053\u308c\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u3057\u3066\u5b9f\u884c\u53ef\u80fd\u306ajar\u3092\u4f5c\u6210\u3059\u308b\u3002\n\n```bash\n$ java -jar target/guestbook.jar\n```\n\n\u3053\u306e\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb\u306e\u5b8c\u5168\u306a\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb\u306f[\u3053\u3053](https://github.com/yogthos/guestbook)\u3067\u53d6\u5f97\u3067\u304d\u308b\u3002\u3088\u308a\u5b8c\u5168\u306a\u30b5\u30f3\u30d7\u30eb\u3092\u6c42\u3081\u308b\u5834\u5408\u306f[Github](https://github.com/yogthos/luminus)\u4e0a\u306b\u3042\u308b\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u30da\u30fc\u30b8\u306e\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb\u3092\u8aad\u3080\u3068\u3044\u3044\u3060\u308d\u3046\u3002\n", "tags": ["Clojure"]}