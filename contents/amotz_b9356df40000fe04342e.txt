{"context": "\n\n\u306f\u3058\u3081\u306b\n\u4e7e\u96fb\u6c60IoT \"MaBeee\" \u3092\u8cfc\u5165\u3057\u307e\u3057\u305f\u3002\n\u63d0\u4f9b\u3055\u308c\u3066\u3044\u308b \u516c\u5f0f\u30a2\u30d7\u30ea \u3067\u3082\u8272\u3005\u904a\u3079\u307e\u3059\u304c\u3001\u305b\u3063\u304b\u304f\u306a\u306e\u3067\u81ea\u5206\u3067\u30a2\u30d7\u30ea\u3092\u4f5c\u3063\u3066\u904a\u3093\u3067\u307f\u307e\u3057\u305f\u3002\n\nMaBeee \u306b\u3064\u3044\u3066\nNOVARS INC. \u304c\u767a\u58f2\u3057\u3066\u3044\u308b\u4e7e\u96fb\u6c60\u578bIoT\u88fd\u54c1\u3067\u3059\u3002\n\u30af\u30e9\u30a6\u30c9\u30d5\u30a1\u30f3\u30c7\u30a3\u30f3\u30b0\u306b\u3088\u308b\u652f\u63f4\u3092\u7d4c\u3066\u30012016\u5e748\u6708\u306b\u4e00\u822c\u8ca9\u58f2\u304c\u958b\u59cb\u3055\u308c\u307e\u3057\u305f\u3002\n\nMaBeee(\u30de\u30d3\u30fc)\u306f\u3001\u304a\u3082\u3061\u3083\u3001\u81ea\u5206\u3067\u4f5c\u3063\u305f\u5de5\u4f5c\u3001\u96fb\u52d5\u6b6f\u30d6\u30e9\u30b7\u306a\u3069\u3001\u4e7e\u96fb\u6c60\u3067\u52d5\u304f\u88fd\u54c1\u3092\u30b9\u30de\u30db\u3067\u30b3\u30f3\u30c8\u30ed\u30fc\u30eb\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u308b\u4e7e\u96fb\u6c60\u578bIoT\u88fd\u54c1\u3067\u3059\u3002\n\u30b9\u30de\u30db\u3092\u632f\u3063\u305f\u308a\u3001\u50be\u3051\u305f\u308a\u3001\u58f0\u306e\u5927\u304d\u3055\u306b\u53cd\u5fdc\u3055\u305b\u305f\u308a\u3057\u3066\u3001\u96fb\u8eca\u306e\u304a\u3082\u3061\u3083\u3092\u901f\u304f\u8d70\u3089\u305b\u305f\u308a\u3001\u306c\u3044\u3050\u308b\u307f\u3084\u5de5\u4f5c\u30ed\u30dc\u30c3\u30c8\u3092\u52d5\u304b\u3057\u305f\u308a\u3001\u30bf\u30a4\u30de\u30fc\u6a5f\u80fd\u3067\u6b6f\u30d6\u30e9\u30b7\u306e\u6642\u9593\u3092\u77e5\u3089\u305b\u3066\u304f\u308c\u305f\u308a\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002 \n\n\u4e7e\u96fb\u6c60\u578bIoT \u3068\u3042\u308a\u307e\u3059\u304c\u3001\u5b9f\u969b\u306b\u306f\u53584\u5f62\u96fb\u6c60\u3092 BLE\uff08Bluetooth Low Energy\uff09\u3067\u5236\u5fa1\u3059\u308b\u53583\u5f62\u306e\u30c7\u30d0\u30a4\u30b9\u306b\u306a\u308a\u307e\u3059\u3002\n\n\u3064\u304f\u3063\u305f\u3082\u306e\n\u516c\u5f0f\u30a2\u30d7\u30ea\u3067\u306f\u3001\u58f0\u306e\u5927\u304d\u3055\u3067\u96fb\u6c60\u3092\u30b3\u30f3\u30c8\u30ed\u30fc\u30eb\u3067\u304d\u308b\u30e2\u30fc\u30c9\u304c\u3042\u308a\u307e\u3059\u3002\n\u3053\u308c\u3092\u5fdc\u7528\u3057\u3001\u97f3\u58f0\u8a8d\u8b58\u3067\u7279\u5b9a\u306e\u30ef\u30fc\u30c9\u306b\u53cd\u5fdc\u3057\u3066\u96fb\u6c60\uff08+\u642d\u8f09\u3055\u308c\u305f\u304a\u3082\u3061\u3083\uff09\u3092\u5236\u5fa1\u3059\u308b iOS \u30a2\u30d7\u30ea\u3092\u4f5c\u3063\u3066\u307f\u307e\u3057\u305f\u3002\nhttps://github.com/amotz/MabeeeAllAboard\n\u306a\u304a\u3001\u666e\u6bb5\u30e2\u30d0\u30a4\u30eb\u958b\u767a\u306f\u3057\u3066\u3044\u306a\u3044\u306e\u3067\u3001Swift \u306f\u307b\u307c\u521d\u5fc3\u8005\u3067\u3059\u3002\u3042\u3057\u304b\u3089\u305a\u3002\n\n\u958b\u767a\u74b0\u5883\nXcode 8.2\nSwift 3.0\niOS 10.2 iPhone6\n\n\u3064\u304f\u308a\u304b\u305f\n\nMaBeee SDK \u306e\u30a4\u30f3\u30dd\u30fc\u30c8\n\u307e\u3060\u516c\u5f0f\u306b\u306f\u30b5\u30dd\u30fc\u30c8\u3055\u308c\u3066\u3044\u307e\u305b\u3093\u304c\u3001MaBeee \u3092 iOS \u3067\u5229\u7528\u3059\u308b\u305f\u3081\u306e SDK \u304c GitHub \u306b\u516c\u958b\u3055\u308c\u3066\u3044\u307e\u3059\u3002\nhttps://github.com/novars-jp/MaBeeeiOSSDK\n\uff08Android\u5411\u3051SDK \u3082\u3042\u308a\u307e\u3059\uff09\n\u203b\u4e0a\u8a18\u30b5\u30a4\u30c8\u306b\u3082\u8a18\u8f09\u3055\u308c\u3066\u3044\u307e\u3059\u304c\u30012017/2/4 \u73fe\u5728\u3001MaBeee SDK \u306f\u516c\u5f0f\u306b\u30ea\u30ea\u30fc\u30b9\u30fb\u30b5\u30dd\u30fc\u30c8\u3055\u308c\u3066\u3044\u307e\u305b\u3093\u3002SDK \u306e\u5229\u7528\u306f\u81ea\u5df1\u8cac\u4efb\u3067\u304a\u9858\u3044\u3057\u307e\u3059 \n\u3053\u3061\u3089 \u3092\u53c2\u8003\u306b\u3057\u3066\u3001\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306b MaBeeeSDK.framework \u3092\u8ffd\u52a0\u3057\u307e\u3059\u3002\n\u4eca\u56de\u306f\u6a2a\u7740\u3057\u3066 Embedded Binaries \u306b\u76f4\u63a5\u30c9\u30e9\u30c3\u30b0\u30a2\u30f3\u30c9\u30c9\u30ed\u30c3\u30d7\u3067\u8ffd\u52a0\u3057\u307e\u3057\u305f\u3002\n\u3042\u3068\u306f\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u30a4\u30f3\u30dd\u30fc\u30c8\u3059\u308c\u3070 MaBeee SDK \u304c\u6271\u3048\u307e\u3059\u3002\nimport MaBeeeSDK\n\n\nMaBeee \u306e\u30b9\u30ad\u30e3\u30f3\u30fb\u63a5\u7d9a\nMaBeeeScanViewController \u3068\u3044\u3046\u8a2d\u5b9a\u7528\u306e ViewController \u304c\u63d0\u4f9b\u3055\u308c\u3066\u3044\u308b\u306e\u3067\u3001\u305d\u306e\u307e\u307e\u5229\u7528\u3057\u307e\u3059\u3002\n  @IBAction func tappedSettingsButton(_ sender: UIButton) {\n    let vc = MaBeeeScanViewController()\n    vc.show(self)\n  }\n\n\u7d10\u4ed8\u3051\u3089\u308c\u305f\u30dc\u30bf\u30f3\u3092\u30bf\u30c3\u30d7\u3059\u308b\u3068\u3001\u516c\u5f0f\u30a2\u30d7\u30ea\u540c\u69d8\u306e MaBeee \u30b9\u30ad\u30e3\u30f3\u30fb\u63a5\u7d9a\u753b\u9762\u304c\u958b\u304d\u307e\u3059\u3002\n\u307e\u305a MaBeee \u5168\u4f53\u3092\u7ba1\u7406\u3059\u308b MaBeeeApp\u30af\u30e9\u30b9\u306e\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u304c\u751f\u6210\u3055\u308c\u3001MaBeeeDevice \u30af\u30e9\u30b9\u306e\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u304c Bluetooth \u3067\u691c\u51fa\u3055\u308c\u305f MaBeee \u3054\u3068\u306b\u751f\u6210\u3055\u308c\u307e\u3059\u3002\n\nMaBeee \u306e\u5236\u5fa1\nMaBeeeDevice \u30af\u30e9\u30b9\u306e pwmDuty \u30d7\u30ed\u30d1\u30c6\u30a3\u3067 MaBeee \u306e\u51fa\u529b\u5024\u3092\u8a2d\u5b9a\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\u51fa\u529b\u5024\u306f 0\uff5e100 \u3092\u6307\u5b9a\u3067\u304d\u307e\u3059\u304c\u3001\u4eca\u56de\u306f\u30b7\u30f3\u30d7\u30eb\u306b\u96fb\u6c60\u3092\u30aa\u30f3\u30aa\u30d5\u3067\u304d\u308c\u3070\u826f\u3044\u306e\u3067\u3001\u9069\u5f53\u306b\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u30b3\u30fc\u30c9\u3092\u66f8\u304d\u307e\u3059\u3002\n    fileprivate func startMaBeee() {\n        setMaBeeePWMDuty(100)\n    }\n\n    fileprivate func stopMaBeee() {\n        setMaBeeePWMDuty(0)\n    }\n\n    fileprivate func setMaBeeePWMDuty (_ pwmDuty :Int32) {\n        // \u30b9\u30ad\u30e3\u30f3\u30fb\u63a5\u7d9a\u753b\u9762\u3067\u63a5\u7d9a\u3055\u308c\u305f MaBeee \u306e\u51fa\u529b\u5024\u3092\u8a2d\u5b9a\u3059\u308b\n        for device in MaBeeeApp.instance().devices() {\n            device.pwmDuty = pwmDuty\n        }\n    }\n\n\u3053\u308c\u3067 MaBeee \uff08+\u642d\u8f09\u3055\u308c\u305f\u6a5f\u5668\uff09\u306e\u30aa\u30f3\u30aa\u30d5\u5236\u5fa1\u304c\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3057\u305f\uff01\u7c21\u5358\u3067\u3059\u306d  \n\n\u97f3\u58f0\u8a8d\u8b58\n\u7279\u5b9a\u30ef\u30fc\u30c9\u306e\u97f3\u58f0\u306b\u53cd\u5fdc\u3055\u305b\u3066 MaBeee \u3092\u5236\u5fa1\u3057\u305f\u3044\u306e\u3067\u3001\u30a2\u30d7\u30ea\u5185\u3067\u97f3\u58f0\u8a8d\u8b58\u3055\u305b\u307e\u3059\u3002\niOS10 \u304b\u3089\u642d\u8f09\u3055\u308c\u305f SpeechFramework \u3092\u5229\u7528\u3057\u307e\u3059\u3002\n\u5b9f\u88c5\u306b\u3042\u305f\u3063\u3066\u306f\u3001\u4e3b\u306b\u4ee5\u4e0b\u306e\u8a18\u4e8b\u3092\u53c2\u8003\u306b\u3055\u305b\u3066\u3044\u305f\u3060\u304d\u307e\u3057\u305f \n[iOS 10] SFSpeechRecognizer\u3067\u97f3\u58f0\u8a8d\u8b58\u3092\u8a66\u3057\u3066\u307f\u305f\n\u307e\u305a\u3001Info.plist \u306b\u30de\u30a4\u30af\u3068\u97f3\u58f0\u8a8d\u8b58\u306e\u5229\u7528\u76ee\u7684\u3092\u8a18\u8ff0\u3057\u307e\u3059\u3002\n\nInfo.plist\n<dict>\n    ...\n    <key>NSMicrophoneUsageDescription</key>\n    <string>\u97f3\u58f0\u8a8d\u8b58\u306e\u305f\u3081\u306b\u30de\u30a4\u30af\u3092\u5229\u7528\u3057\u307e\u3059\u3002</string>\n    <key>NSSpeechRecognitionUsageDescription</key>\n    <string>Mabeee\u3092\u64cd\u4f5c\u3059\u308b\u305f\u3081\u306b\u97f3\u58f0\u3092\u8a8d\u8b58\u3057\u307e\u3059\u3002</string>\n    ...\n</dict>\n\n\n\u51e6\u7406\u3092\u66f8\u304f\u524d\u306b\u3001\u30b3\u30fc\u30c9\u5185\u3067 SpeechFramework \u3092\u30a4\u30f3\u30dd\u30fc\u30c8\u3057\u3066\u304a\u304d\u307e\u3059\u3002\nimport Speech\n\n\u3053\u308c\u3067\u6e96\u5099\u304c\u6574\u3063\u305f\u306e\u3067\u3001\u97f3\u58f0\u8a8d\u8b58\u5468\u308a\u306e\u30b3\u30fc\u30c9\u3092\u66f8\u3044\u3066\u307f\u307e\u3059\u3002\n\n    // MARK: Properties\n    private let startWords = [\"\u30c9\u30af\u30bf\u30fc\u30a4\u30a8\u30ed\u30fc\", \"\u51fa\u767a\u9032\u884c\"]\n    private let stopWords = [\"\u505c\u8eca\u3057\u307e\u3059\"]\n\n    private let speechRecognizer = SFSpeechRecognizer(locale: Locale(identifier: \"ja-JP\"))!\n    private var recognitionRequest: SFSpeechAudioBufferRecognitionRequest?\n    private var recognitionTask: SFSpeechRecognitionTask?\n    private let audioEngine = AVAudioEngine()\n\n    // MARK: Actions\n    @IBAction func tappedRecButton(_ sender: UIButton) {\n        if audioEngine.isRunning {\n            stopRecording()\n            recButton.isEnabled = false\n            recButton.setImage(UIImage(named: \"Mic\")!, for: UIControlState())\n            speechLabel.text = \"\"\n            balloonImage.isHidden = true\n        } else {\n            try! startRecording()\n            recButton.setImage(UIImage(named: \"Pause\")!, for: UIControlState())\n        }\n    }\n\n    // MARK: Speech functions\n    fileprivate func requestRecognizerAuthorization() {\n        SFSpeechRecognizer.requestAuthorization { authStatus in\n            OperationQueue.main.addOperation { [weak self] in\n                guard let `self` = self else { return }\n\n                switch authStatus {\n                case .authorized:\n                    self.recButton.isEnabled = true\n                case .denied:\n                    self.recButton.isEnabled = false\n                case .restricted:\n                    self.recButton.isEnabled = false\n                case .notDetermined:\n                    self.recButton.isEnabled = false\n                }\n            }\n        }\n    }\n\n    fileprivate func startRecording() throws {\n        refreshTask()\n\n        let audioSession = AVAudioSession.sharedInstance()\n        try audioSession.setCategory(AVAudioSessionCategoryRecord)\n        try audioSession.setMode(AVAudioSessionModeMeasurement)\n        try audioSession.setActive(true, with: .notifyOthersOnDeactivation)\n\n        recognitionRequest = SFSpeechAudioBufferRecognitionRequest()\n\n        guard let inputNode = audioEngine.inputNode else { fatalError(\"Audio engine has no input node\") }\n        guard let recognitionRequest = recognitionRequest else { fatalError(\"Unable to created a SFSpeechAudioBufferRecognitionRequest object\") }\n\n        recognitionRequest.shouldReportPartialResults = true\n\n        recognitionTask = speechRecognizer.recognitionTask(with: recognitionRequest) { [weak self] result, error in\n            guard let `self` = self else { return }\n\n            var isFinal = false\n\n            if let result = result {\n                let resultString = result.bestTranscription.formattedString\n                self.speechLabel.text = resultString\n\n                // \u8a8d\u8b58\u7d50\u679c\u304c\u6307\u5b9a\u5358\u8a9e\u3067\u3042\u308c\u3070 MaBeee \u3092\u5236\u5fa1\n                if self.startWords.contains(resultString){\n                    self.startMaBeee()\n                } else if self.stopWords.contains(resultString){\n                    self.stopMaBeee()\n                }\n                isFinal = result.isFinal\n            }\n\n            if error != nil || isFinal {\n                self.audioEngine.stop()\n                inputNode.removeTap(onBus: 0)\n\n                self.recognitionRequest = nil\n                self.recognitionTask = nil\n\n                self.speechLabel.text = \"\"\n                self.recButton.isEnabled = true\n            }\n        }\n\n        let recordingFormat = inputNode.outputFormat(forBus: 0)\n        inputNode.installTap(onBus: 0, bufferSize: 1024, format: recordingFormat) { (buffer: AVAudioPCMBuffer, when: AVAudioTime) in\n            self.recognitionRequest?.append(buffer)\n        }\n\n        try startAudioEngine()\n    }\n\n    fileprivate func stopRecording() {\n        audioEngine.stop()\n        recognitionRequest?.endAudio()\n    }\n\n    fileprivate func refreshTask() {\n        if let recognitionTask = recognitionTask {\n            recognitionTask.cancel()\n            self.recognitionTask = nil\n        }\n    }\n\n    fileprivate func startAudioEngine() throws {\n        audioEngine.prepare()\n        try audioEngine.start()\n\n        balloonImage.isHidden = false\n        speechLabel.text = \"\u30a2\u30ca\u30a6\u30f3\u30b9\u3057\u3066\u304f\u3060\u3055\u3044\"\n    }\n\n    // MARK: SFSpeechRecognizerDelegate\n    func speechRecognizer(_ speechRecognizer: SFSpeechRecognizer, availabilityDidChange available: Bool) {\n        if available {\n            recButton.isEnabled = true\n        } else {\n            recButton.isEnabled = false\n        }\n    }\n\n\u96d1\u306b\u89e3\u8aac\u3059\u308b\u3068\u3001\u9332\u97f3\u30dc\u30bf\u30f3\u3092\u30bf\u30c3\u30d7\u3057\u305f\u3089\u97f3\u58f0\u5165\u529b\uff08\u30a2\u30ca\u30a6\u30f3\u30b9\uff09\u3092\u958b\u59cb\u3057\u3001\u5165\u529b\u3055\u308c\u305f\u97f3\u58f0\u306e\u8a8d\u8b58\u7d50\u679c\u3092\u753b\u9762\u306b\u8868\u793a\u3057\u307e\u3059\u3002\n\u6587\u5b57\u5217\u304c\u6307\u5b9a\u3057\u305f\u5358\u8a9e\u306b\u5408\u81f4\u3057\u3066\u3044\u308c\u3070\u3001MaBeee \u3092\u30aa\u30f3\u30aa\u30d5\u3057\u307e\u3059\u3002\n\u3053\u308c\u3067\n\n\n\u300c\u51fa\u767a\u9032\u884c\u300d\u3042\u308b\u3044\u306f\u300c\u30c9\u30af\u30bf\u30fc\u30a4\u30a8\u30ed\u30fc\u300d\u3068\u30a2\u30ca\u30a6\u30f3\u30b9\u3059\u308c\u3070\u767a\u8eca\uff08MaBeee \u304c\u30aa\u30f3\uff09\n\n\u300c\u505c\u8eca\u3057\u307e\u3059\u300d\u3068\u30a2\u30ca\u30a6\u30f3\u30b9\u3059\u308c\u3070\u505c\u8eca\uff08MaBeee \u304c\u30aa\u30d5\uff09\n\n\u304c\u5b9f\u73fe\u3067\u304d\u307e\u3057\u305f  \n\u306a\u304a\u3001SpeechFramework \u3092\u5229\u7528\u3057\u305f\u97f3\u58f0\u8a8d\u8b58\u306f\u7aef\u672b\u30fb\u30a2\u30d7\u30ea\u3054\u3068\u306b\u56de\u6570\u5236\u9650\uff08\u5177\u4f53\u7684\u306a\u56de\u6570\u306f\u516c\u958b\u3055\u308c\u3066\u3044\u306a\u3044\uff09\u304c\u3042\u308b\u305f\u3081\u3001\u904a\u3073\u3059\u304e\u306b\u306f\u6ce8\u610f\u304c\u5fc5\u8981\u3067\u3059  \n\n\u30c7\u30d0\u30c3\u30b0\u306e\u69d8\u5b50\n\n\n\u611f\u60f3\u306a\u3069\nMaBeee SDK \u306f\u6271\u3044\u3084\u3059\u304f\u3001MaBeee \u3092\u5236\u5fa1\u3059\u308b\u30a2\u30d7\u30ea\u3092\u30b5\u30af\u3063\u3068\u4f5c\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3057\u305f\u3002\n\u304a\u304b\u3052\u3055\u307e\u3067\u3001\u96fb\u8eca\u597d\u304d\u306a\u5b50\u3069\u3082\u305f\u3061\uff082\u6b73\uff09\u3082\u559c\u3093\u3067\u304f\u308c\u307e\u3057\u305f  \nMaBeee \u306e\u4ee3\u8868\u7684\u306a\u30e6\u30fc\u30b9\u30b1\u30fc\u30b9\u306f\u304a\u3082\u3061\u3083\u306e\u5236\u5fa1\u3067\u3059\u304c\u3001\u30a2\u30a4\u30c7\u30a2\u6b21\u7b2c\u3067\u304a\u3082\u3061\u3083\u4ee5\u5916\u306b\u3082\u4f7f\u3048\u305d\u3046\u3067\u3059\u3002\n\u307e\u305f\u4f55\u304b\u601d\u3044\u3064\u3051\u3070\u3001\u9069\u5f53\u306b\u30a2\u30d7\u30ea\u3092\u4f5c\u3063\u3066\u307f\u305f\u3044\u3068\u601d\u3044\u307e\u3059 \n## \u306f\u3058\u3081\u306b\n\n\u4e7e\u96fb\u6c60IoT [\"MaBeee\"](http://mabeee.mobi/) \u3092\u8cfc\u5165\u3057\u307e\u3057\u305f\u3002\n\u63d0\u4f9b\u3055\u308c\u3066\u3044\u308b [\u516c\u5f0f\u30a2\u30d7\u30ea](https://itunes.apple.com/jp/app/mabeee-kontororu/id1104665648) \u3067\u3082\u8272\u3005\u904a\u3079\u307e\u3059\u304c\u3001\u305b\u3063\u304b\u304f\u306a\u306e\u3067\u81ea\u5206\u3067\u30a2\u30d7\u30ea\u3092\u4f5c\u3063\u3066\u904a\u3093\u3067\u307f\u307e\u3057\u305f\u3002\n\n## MaBeee \u306b\u3064\u3044\u3066\n\nNOVARS INC. \u304c\u767a\u58f2\u3057\u3066\u3044\u308b\u4e7e\u96fb\u6c60\u578bIoT\u88fd\u54c1\u3067\u3059\u3002\n\u30af\u30e9\u30a6\u30c9\u30d5\u30a1\u30f3\u30c7\u30a3\u30f3\u30b0\u306b\u3088\u308b\u652f\u63f4\u3092\u7d4c\u3066\u30012016\u5e748\u6708\u306b\u4e00\u822c\u8ca9\u58f2\u304c\u958b\u59cb\u3055\u308c\u307e\u3057\u305f\u3002\n\n> MaBeee(\u30de\u30d3\u30fc)\u306f\u3001\u304a\u3082\u3061\u3083\u3001\u81ea\u5206\u3067\u4f5c\u3063\u305f\u5de5\u4f5c\u3001\u96fb\u52d5\u6b6f\u30d6\u30e9\u30b7\u306a\u3069\u3001\u4e7e\u96fb\u6c60\u3067\u52d5\u304f\u88fd\u54c1\u3092\u30b9\u30de\u30db\u3067\u30b3\u30f3\u30c8\u30ed\u30fc\u30eb\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u308b\u4e7e\u96fb\u6c60\u578bIoT\u88fd\u54c1\u3067\u3059\u3002\n> \u30b9\u30de\u30db\u3092\u632f\u3063\u305f\u308a\u3001\u50be\u3051\u305f\u308a\u3001\u58f0\u306e\u5927\u304d\u3055\u306b\u53cd\u5fdc\u3055\u305b\u305f\u308a\u3057\u3066\u3001\u96fb\u8eca\u306e\u304a\u3082\u3061\u3083\u3092\u901f\u304f\u8d70\u3089\u305b\u305f\u308a\u3001\u306c\u3044\u3050\u308b\u307f\u3084\u5de5\u4f5c\u30ed\u30dc\u30c3\u30c8\u3092\u52d5\u304b\u3057\u305f\u308a\u3001\u30bf\u30a4\u30de\u30fc\u6a5f\u80fd\u3067\u6b6f\u30d6\u30e9\u30b7\u306e\u6642\u9593\u3092\u77e5\u3089\u305b\u3066\u304f\u308c\u305f\u308a\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002 \n\n\u4e7e\u96fb\u6c60\u578bIoT \u3068\u3042\u308a\u307e\u3059\u304c\u3001\u5b9f\u969b\u306b\u306f\u53584\u5f62\u96fb\u6c60\u3092 BLE\uff08Bluetooth Low Energy\uff09\u3067\u5236\u5fa1\u3059\u308b\u53583\u5f62\u306e\u30c7\u30d0\u30a4\u30b9\u306b\u306a\u308a\u307e\u3059\u3002\n\n\n## \u3064\u304f\u3063\u305f\u3082\u306e\n\n\u516c\u5f0f\u30a2\u30d7\u30ea\u3067\u306f\u3001[\u58f0\u306e\u5927\u304d\u3055\u3067\u96fb\u6c60\u3092\u30b3\u30f3\u30c8\u30ed\u30fc\u30eb\u3067\u304d\u308b\u30e2\u30fc\u30c9](https://www.youtube.com/watch?v=cD6buSTW1I8)\u304c\u3042\u308a\u307e\u3059\u3002\n\u3053\u308c\u3092\u5fdc\u7528\u3057\u3001\u97f3\u58f0\u8a8d\u8b58\u3067\u7279\u5b9a\u306e\u30ef\u30fc\u30c9\u306b\u53cd\u5fdc\u3057\u3066\u96fb\u6c60\uff08+\u642d\u8f09\u3055\u308c\u305f\u304a\u3082\u3061\u3083:train2:\uff09\u3092\u5236\u5fa1\u3059\u308b iOS \u30a2\u30d7\u30ea\u3092\u4f5c\u3063\u3066\u307f\u307e\u3057\u305f\u3002\n\nhttps://github.com/amotz/MabeeeAllAboard\n\n\u306a\u304a\u3001\u666e\u6bb5\u30e2\u30d0\u30a4\u30eb\u958b\u767a\u306f\u3057\u3066\u3044\u306a\u3044\u306e\u3067\u3001Swift \u306f\u307b\u307c\u521d\u5fc3\u8005\u3067\u3059\u3002\u3042\u3057\u304b\u3089\u305a\u3002\n\n## \u958b\u767a\u74b0\u5883\n\nXcode 8.2\nSwift 3.0\niOS 10.2 iPhone6\n\n## \u3064\u304f\u308a\u304b\u305f\n### MaBeee SDK \u306e\u30a4\u30f3\u30dd\u30fc\u30c8\n\n\u307e\u3060\u516c\u5f0f\u306b\u306f\u30b5\u30dd\u30fc\u30c8\u3055\u308c\u3066\u3044\u307e\u305b\u3093\u304c\u3001MaBeee \u3092 iOS \u3067\u5229\u7528\u3059\u308b\u305f\u3081\u306e SDK \u304c GitHub \u306b\u516c\u958b\u3055\u308c\u3066\u3044\u307e\u3059\u3002\n\nhttps://github.com/novars-jp/MaBeeeiOSSDK\n\uff08[Android\u5411\u3051SDK](https://github.com/novars-jp/MaBeeeAndroidSDK) \u3082\u3042\u308a\u307e\u3059\uff09\n\n<font color=\"Crimson\">\u203b\u4e0a\u8a18\u30b5\u30a4\u30c8\u306b\u3082\u8a18\u8f09\u3055\u308c\u3066\u3044\u307e\u3059\u304c\u30012017/2/4 \u73fe\u5728\u3001MaBeee SDK \u306f\u516c\u5f0f\u306b\u30ea\u30ea\u30fc\u30b9\u30fb\u30b5\u30dd\u30fc\u30c8\u3055\u308c\u3066\u3044\u307e\u305b\u3093\u3002SDK \u306e\u5229\u7528\u306f\u81ea\u5df1\u8cac\u4efb\u3067\u304a\u9858\u3044\u3057\u307e\u3059</font> :pray:\n\n[\u3053\u3061\u3089](https://github.com/novars-jp/MaBeeeiOSSDK/wiki/%E3%83%A9%E3%82%A4%E3%83%96%E3%83%A9%E3%83%AA%E3%81%AE%E3%82%A4%E3%83%B3%E3%83%9D%E3%83%BC%E3%83%88) \u3092\u53c2\u8003\u306b\u3057\u3066\u3001\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306b `MaBeeeSDK.framework` \u3092\u8ffd\u52a0\u3057\u307e\u3059\u3002\n\u4eca\u56de\u306f\u6a2a\u7740\u3057\u3066 `Embedded Binaries` \u306b\u76f4\u63a5\u30c9\u30e9\u30c3\u30b0\u30a2\u30f3\u30c9\u30c9\u30ed\u30c3\u30d7\u3067\u8ffd\u52a0\u3057\u307e\u3057\u305f\u3002\n\n\u3042\u3068\u306f\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u30a4\u30f3\u30dd\u30fc\u30c8\u3059\u308c\u3070 MaBeee SDK \u304c\u6271\u3048\u307e\u3059\u3002\n\n```swift\nimport MaBeeeSDK\n```\n### MaBeee \u306e\u30b9\u30ad\u30e3\u30f3\u30fb\u63a5\u7d9a\n\n`MaBeeeScanViewController` \u3068\u3044\u3046\u8a2d\u5b9a\u7528\u306e ViewController \u304c\u63d0\u4f9b\u3055\u308c\u3066\u3044\u308b\u306e\u3067\u3001\u305d\u306e\u307e\u307e\u5229\u7528\u3057\u307e\u3059\u3002\n\n```swift\n  @IBAction func tappedSettingsButton(_ sender: UIButton) {\n    let vc = MaBeeeScanViewController()\n    vc.show(self)\n  }\n```\n\n\u7d10\u4ed8\u3051\u3089\u308c\u305f\u30dc\u30bf\u30f3\u3092\u30bf\u30c3\u30d7\u3059\u308b\u3068\u3001\u516c\u5f0f\u30a2\u30d7\u30ea\u540c\u69d8\u306e MaBeee \u30b9\u30ad\u30e3\u30f3\u30fb\u63a5\u7d9a\u753b\u9762\u304c\u958b\u304d\u307e\u3059\u3002\n\n\u307e\u305a MaBeee \u5168\u4f53\u3092\u7ba1\u7406\u3059\u308b `MaBeeeApp`\u30af\u30e9\u30b9\u306e\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u304c\u751f\u6210\u3055\u308c\u3001`MaBeeeDevice` \u30af\u30e9\u30b9\u306e\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u304c Bluetooth \u3067\u691c\u51fa\u3055\u308c\u305f MaBeee \u3054\u3068\u306b\u751f\u6210\u3055\u308c\u307e\u3059\u3002\n\n### MaBeee \u306e\u5236\u5fa1\n\n`MaBeeeDevice` \u30af\u30e9\u30b9\u306e [pwmDuty \u30d7\u30ed\u30d1\u30c6\u30a3](https://github.com/novars-jp/MaBeeeiOSSDK/wiki/MaBeeeDevice#pwmduty)\u3067 MaBeee \u306e\u51fa\u529b\u5024\u3092\u8a2d\u5b9a\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\u51fa\u529b\u5024\u306f 0\uff5e100 \u3092\u6307\u5b9a\u3067\u304d\u307e\u3059\u304c\u3001\u4eca\u56de\u306f\u30b7\u30f3\u30d7\u30eb\u306b\u96fb\u6c60\u3092\u30aa\u30f3\u30aa\u30d5\u3067\u304d\u308c\u3070\u826f\u3044\u306e\u3067\u3001\u9069\u5f53\u306b\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u30b3\u30fc\u30c9\u3092\u66f8\u304d\u307e\u3059\u3002\n\n```swift\n    fileprivate func startMaBeee() {\n        setMaBeeePWMDuty(100)\n    }\n\n    fileprivate func stopMaBeee() {\n        setMaBeeePWMDuty(0)\n    }\n\n    fileprivate func setMaBeeePWMDuty (_ pwmDuty :Int32) {\n        // \u30b9\u30ad\u30e3\u30f3\u30fb\u63a5\u7d9a\u753b\u9762\u3067\u63a5\u7d9a\u3055\u308c\u305f MaBeee \u306e\u51fa\u529b\u5024\u3092\u8a2d\u5b9a\u3059\u308b\n        for device in MaBeeeApp.instance().devices() {\n            device.pwmDuty = pwmDuty\n        }\n    }\n```\n\n\u3053\u308c\u3067 MaBeee \uff08+\u642d\u8f09\u3055\u308c\u305f\u6a5f\u5668\uff09\u306e\u30aa\u30f3\u30aa\u30d5\u5236\u5fa1\u304c\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3057\u305f\uff01\u7c21\u5358\u3067\u3059\u306d :grinning: \n\n### \u97f3\u58f0\u8a8d\u8b58\n\n\u7279\u5b9a\u30ef\u30fc\u30c9\u306e\u97f3\u58f0\u306b\u53cd\u5fdc\u3055\u305b\u3066 MaBeee \u3092\u5236\u5fa1\u3057\u305f\u3044\u306e\u3067\u3001\u30a2\u30d7\u30ea\u5185\u3067\u97f3\u58f0\u8a8d\u8b58\u3055\u305b\u307e\u3059\u3002\niOS10 \u304b\u3089\u642d\u8f09\u3055\u308c\u305f [SpeechFramework](https://developer.apple.com/reference/speech) \u3092\u5229\u7528\u3057\u307e\u3059\u3002\n\n\u5b9f\u88c5\u306b\u3042\u305f\u3063\u3066\u306f\u3001\u4e3b\u306b\u4ee5\u4e0b\u306e\u8a18\u4e8b\u3092\u53c2\u8003\u306b\u3055\u305b\u3066\u3044\u305f\u3060\u304d\u307e\u3057\u305f :bow:\n[[iOS 10] SFSpeechRecognizer\u3067\u97f3\u58f0\u8a8d\u8b58\u3092\u8a66\u3057\u3066\u307f\u305f](http://dev.classmethod.jp/smartphone/iphone/try-ios10-speech-recognizer/)\n\n\u307e\u305a\u3001`Info.plist` \u306b\u30de\u30a4\u30af\u3068\u97f3\u58f0\u8a8d\u8b58\u306e\u5229\u7528\u76ee\u7684\u3092\u8a18\u8ff0\u3057\u307e\u3059\u3002\n\n```xml:Info.plist\n<dict>\n    ...\n    <key>NSMicrophoneUsageDescription</key>\n    <string>\u97f3\u58f0\u8a8d\u8b58\u306e\u305f\u3081\u306b\u30de\u30a4\u30af\u3092\u5229\u7528\u3057\u307e\u3059\u3002</string>\n    <key>NSSpeechRecognitionUsageDescription</key>\n    <string>Mabeee\u3092\u64cd\u4f5c\u3059\u308b\u305f\u3081\u306b\u97f3\u58f0\u3092\u8a8d\u8b58\u3057\u307e\u3059\u3002</string>\n    ...\n</dict>\n```\n\n\u51e6\u7406\u3092\u66f8\u304f\u524d\u306b\u3001\u30b3\u30fc\u30c9\u5185\u3067 SpeechFramework \u3092\u30a4\u30f3\u30dd\u30fc\u30c8\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n\n```swift\nimport Speech\n```\n\n\u3053\u308c\u3067\u6e96\u5099\u304c\u6574\u3063\u305f\u306e\u3067\u3001\u97f3\u58f0\u8a8d\u8b58\u5468\u308a\u306e\u30b3\u30fc\u30c9\u3092\u66f8\u3044\u3066\u307f\u307e\u3059\u3002\n\n```swift\n\n    // MARK: Properties\n    private let startWords = [\"\u30c9\u30af\u30bf\u30fc\u30a4\u30a8\u30ed\u30fc\", \"\u51fa\u767a\u9032\u884c\"]\n    private let stopWords = [\"\u505c\u8eca\u3057\u307e\u3059\"]\n    \n    private let speechRecognizer = SFSpeechRecognizer(locale: Locale(identifier: \"ja-JP\"))!\n    private var recognitionRequest: SFSpeechAudioBufferRecognitionRequest?\n    private var recognitionTask: SFSpeechRecognitionTask?\n    private let audioEngine = AVAudioEngine()\n\n    // MARK: Actions\n    @IBAction func tappedRecButton(_ sender: UIButton) {\n        if audioEngine.isRunning {\n            stopRecording()\n            recButton.isEnabled = false\n            recButton.setImage(UIImage(named: \"Mic\")!, for: UIControlState())\n            speechLabel.text = \"\"\n            balloonImage.isHidden = true\n        } else {\n            try! startRecording()\n            recButton.setImage(UIImage(named: \"Pause\")!, for: UIControlState())\n        }\n    }\n\n    // MARK: Speech functions\n    fileprivate func requestRecognizerAuthorization() {\n        SFSpeechRecognizer.requestAuthorization { authStatus in\n            OperationQueue.main.addOperation { [weak self] in\n                guard let `self` = self else { return }\n                \n                switch authStatus {\n                case .authorized:\n                    self.recButton.isEnabled = true\n                case .denied:\n                    self.recButton.isEnabled = false\n                case .restricted:\n                    self.recButton.isEnabled = false\n                case .notDetermined:\n                    self.recButton.isEnabled = false\n                }\n            }\n        }\n    }\n    \n    fileprivate func startRecording() throws {\n        refreshTask()\n        \n        let audioSession = AVAudioSession.sharedInstance()\n        try audioSession.setCategory(AVAudioSessionCategoryRecord)\n        try audioSession.setMode(AVAudioSessionModeMeasurement)\n        try audioSession.setActive(true, with: .notifyOthersOnDeactivation)\n        \n        recognitionRequest = SFSpeechAudioBufferRecognitionRequest()\n        \n        guard let inputNode = audioEngine.inputNode else { fatalError(\"Audio engine has no input node\") }\n        guard let recognitionRequest = recognitionRequest else { fatalError(\"Unable to created a SFSpeechAudioBufferRecognitionRequest object\") }\n        \n        recognitionRequest.shouldReportPartialResults = true\n        \n        recognitionTask = speechRecognizer.recognitionTask(with: recognitionRequest) { [weak self] result, error in\n            guard let `self` = self else { return }\n            \n            var isFinal = false\n            \n            if let result = result {\n                let resultString = result.bestTranscription.formattedString\n                self.speechLabel.text = resultString\n                \n                // \u8a8d\u8b58\u7d50\u679c\u304c\u6307\u5b9a\u5358\u8a9e\u3067\u3042\u308c\u3070 MaBeee \u3092\u5236\u5fa1\n                if self.startWords.contains(resultString){\n                    self.startMaBeee()\n                } else if self.stopWords.contains(resultString){\n                    self.stopMaBeee()\n                }\n                isFinal = result.isFinal\n            }\n            \n            if error != nil || isFinal {\n                self.audioEngine.stop()\n                inputNode.removeTap(onBus: 0)\n                \n                self.recognitionRequest = nil\n                self.recognitionTask = nil\n                \n                self.speechLabel.text = \"\"\n                self.recButton.isEnabled = true\n            }\n        }\n        \n        let recordingFormat = inputNode.outputFormat(forBus: 0)\n        inputNode.installTap(onBus: 0, bufferSize: 1024, format: recordingFormat) { (buffer: AVAudioPCMBuffer, when: AVAudioTime) in\n            self.recognitionRequest?.append(buffer)\n        }\n        \n        try startAudioEngine()\n    }\n    \n    fileprivate func stopRecording() {\n        audioEngine.stop()\n        recognitionRequest?.endAudio()\n    }\n    \n    fileprivate func refreshTask() {\n        if let recognitionTask = recognitionTask {\n            recognitionTask.cancel()\n            self.recognitionTask = nil\n        }\n    }\n    \n    fileprivate func startAudioEngine() throws {\n        audioEngine.prepare()\n        try audioEngine.start()\n        \n        balloonImage.isHidden = false\n        speechLabel.text = \"\u30a2\u30ca\u30a6\u30f3\u30b9\u3057\u3066\u304f\u3060\u3055\u3044\"\n    }\n    \n    // MARK: SFSpeechRecognizerDelegate\n    func speechRecognizer(_ speechRecognizer: SFSpeechRecognizer, availabilityDidChange available: Bool) {\n        if available {\n            recButton.isEnabled = true\n        } else {\n            recButton.isEnabled = false\n        }\n    }\n```\n\n\n\n\u96d1\u306b\u89e3\u8aac\u3059\u308b\u3068\u3001\u9332\u97f3\u30dc\u30bf\u30f3\u3092\u30bf\u30c3\u30d7\u3057\u305f\u3089\u97f3\u58f0\u5165\u529b\uff08\u30a2\u30ca\u30a6\u30f3\u30b9\uff09\u3092\u958b\u59cb\u3057\u3001\u5165\u529b\u3055\u308c\u305f\u97f3\u58f0\u306e\u8a8d\u8b58\u7d50\u679c\u3092\u753b\u9762\u306b\u8868\u793a\u3057\u307e\u3059\u3002\n\u6587\u5b57\u5217\u304c\u6307\u5b9a\u3057\u305f\u5358\u8a9e\u306b\u5408\u81f4\u3057\u3066\u3044\u308c\u3070\u3001MaBeee \u3092\u30aa\u30f3\u30aa\u30d5\u3057\u307e\u3059\u3002\n\n\u3053\u308c\u3067\n\n- **\u300c\u51fa\u767a\u9032\u884c\u300d**\u3042\u308b\u3044\u306f**\u300c\u30c9\u30af\u30bf\u30fc\u30a4\u30a8\u30ed\u30fc\u300d**\u3068\u30a2\u30ca\u30a6\u30f3\u30b9\u3059\u308c\u3070\u767a\u8eca\uff08MaBeee \u304c\u30aa\u30f3\uff09\n- **\u300c\u505c\u8eca\u3057\u307e\u3059\u300d**\u3068\u30a2\u30ca\u30a6\u30f3\u30b9\u3059\u308c\u3070\u505c\u8eca\uff08MaBeee \u304c\u30aa\u30d5\uff09\n\n\u304c\u5b9f\u73fe\u3067\u304d\u307e\u3057\u305f :train2: \n\n\u306a\u304a\u3001SpeechFramework \u3092\u5229\u7528\u3057\u305f\u97f3\u58f0\u8a8d\u8b58\u306f\u7aef\u672b\u30fb\u30a2\u30d7\u30ea\u3054\u3068\u306b\u56de\u6570\u5236\u9650\uff08\u5177\u4f53\u7684\u306a\u56de\u6570\u306f\u516c\u958b\u3055\u308c\u3066\u3044\u306a\u3044\uff09\u304c\u3042\u308b\u305f\u3081\u3001\u904a\u3073\u3059\u304e\u306b\u306f\u6ce8\u610f\u304c\u5fc5\u8981\u3067\u3059 :fist: \n\n## \u30c7\u30d0\u30c3\u30b0\u306e\u69d8\u5b50\n\n[![MaBeee\u3092\u642d\u8f09\u3057\u305f\u30d7\u30e9\u30ec\u30fc\u30eb\u3092\u97f3\u58f0\u30a2\u30ca\u30a6\u30f3\u30b9\u3067\u5236\u5fa1\u3057\u3066\u307f\u305f](http://img.youtube.com/vi/HX1aOEDfA9k/0.jpg)](http://www.youtube.com/watch?v=HX1aOEDfA9k)\n\n## \u611f\u60f3\u306a\u3069\n\nMaBeee SDK \u306f\u6271\u3044\u3084\u3059\u304f\u3001MaBeee \u3092\u5236\u5fa1\u3059\u308b\u30a2\u30d7\u30ea\u3092\u30b5\u30af\u3063\u3068\u4f5c\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3057\u305f\u3002\n\u304a\u304b\u3052\u3055\u307e\u3067\u3001\u96fb\u8eca\u597d\u304d\u306a\u5b50\u3069\u3082\u305f\u3061\uff082\u6b73\uff09\u3082\u559c\u3093\u3067\u304f\u308c\u307e\u3057\u305f :boy_tone1: \n\nMaBeee \u306e\u4ee3\u8868\u7684\u306a\u30e6\u30fc\u30b9\u30b1\u30fc\u30b9\u306f\u304a\u3082\u3061\u3083\u306e\u5236\u5fa1\u3067\u3059\u304c\u3001\u30a2\u30a4\u30c7\u30a2\u6b21\u7b2c\u3067\u304a\u3082\u3061\u3083\u4ee5\u5916\u306b\u3082\u4f7f\u3048\u305d\u3046\u3067\u3059\u3002\n\u307e\u305f\u4f55\u304b\u601d\u3044\u3064\u3051\u3070\u3001\u9069\u5f53\u306b\u30a2\u30d7\u30ea\u3092\u4f5c\u3063\u3066\u307f\u305f\u3044\u3068\u601d\u3044\u307e\u3059 :battery:\n", "tags": ["MaBeee", "IoT", "Swift3.0", "iOS10", "\u97f3\u58f0\u8a8d\u8b58"]}