{"context": " More than 1 year has passed since last update.\n\n\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\nphalcon \u306f\u5165\u308c\u3066\u308b\u524d\u63d0\uff0e\n\u307e\u305f\uff0c\u81ea\u5206\u306f VirtualHost \u3067 /var/www \u4ee5\u4e0b\u306a\u3069\u306b\u30c9\u30e1\u30a4\u30f3\u540d\u3067\u30a2\u30d7\u30ea\u3092\u5165\u308c\u3066 \u30ef\u30a4\u30eb\u30c9\u30ab\u30fc\u30c9\u3067\u76f4\u63a5\u305d\u3053\u3092\u53c2\u7167\u3059\u308b\u3088\u3046\u306b\u3059\u308b\u8a2d\u5b9a\u3092\u884c\u3063\u3066\u3044\u308b\u306e\u3067\u305d\u306e\u524d\u63d0\u3067\u3084\u308b\uff0e\n\u4f8b\u3048\u3070\u4e0b\u8a18\u306e\u3088\u3046\u306a\u8a2d\u5b9a\u3068\u304b\uff0e\n<VirtualHost *:80>\n    ServerName exmple.com\n    ServerAlias *.example.com\n    Options -Indexes +FollowSymLinks\n    VirtualDocumentRoot \"/var/www/%0/web\"\n</VirtualHost>\n\n\nxhprof \u3092\u5165\u308c\u308b\napache \u7d4c\u7531\u3067\u53c2\u7167\u3067\u304d\u308b\u5834\u6240\u306b\u8a2d\u7f6e\uff0e\u3053\u3053\u3067\u306f\u524d\u8ff0\u306e\u3068\u304a\u308a /var/www \u4ee5\u4e0b\u306b\u7f6e\u304f\uff0e  phpize \u304c\u3069\u3046\u3084\u3063\u3066\u5165\u308b\u304b\u306f\u307e\u304b\u305b\u305f\uff0e\n\n$ git clone https://github.com/facebook/xhprof xhprof.example.com\n$ cd xhprof\n$ phpize\n$ make\n$ sudo make install      # \u74b0\u5883\u306b\u3088\u308b\n$ ln -s xhprof_html web  # VirtualDocumentRoot \u304c web \u4ee5\u4e0b\u3060\u304b\u3089\n\n\nphalcon \u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306b\u9069\u7528\u3059\u308b\n\u4f8b\u3048\u3070 phalcon/devtool \u3067 modules \u3067\u4f5c\u3063\u305f\u5834\u5408\u306e public/prof.php \u306b\u4e0b\u8a18\u306e\u3088\u3046\u306b\u66f8\u304f\uff0e\u30b3\u30b3\u3089\u3078\u3093\u306f\u4e0a\u3067\u8a2d\u7f6e\u3057\u305f xhprof \u306e doc \u306e\u30da\u30fc\u30b8\u306b\u66f8\u3044\u3066\u3042\u308b\u3082\u306e\u3092\u53d6\u3063\u3066\u304d\u3066\u8cbc\u308a\u4ed8\u3051\u3066\u52d5\u304f\u3088\u3046\u306b\u3057\u305f\u3082\u306e\uff0e\n<?php\n\nuse Phalcon\\Mvc\\Application;\n\nerror_reporting(E_ALL);\n\ntry {\n\n    $PROF_URL = 'http://xhprof.example.com/';\n    $XHPROF_ROOT = '/var/www/xhprof.example.com/';\n\n    xhprof_enable(XHPROF_FLAGS_CPU + XHPROF_FLAGS_MEMORY);\n\n    /**\n     * Include services\n     */\n    require __DIR__ . '/../config/services.php';\n\n    /**\n     * Handle the request\n     */\n    $application = new Application();\n\n    /**\n     * Assign the DI\n     */\n    $application->setDI($di);\n\n    /**\n     * Include modules\n     */\n    require __DIR__ . '/../config/modules.php';\n\n    echo $application->handle()->getContent();\n\n    // xhprof\n    $xhprof_data = xhprof_disable();\n\n    include_once $XHPROF_ROOT . \"/xhprof_lib/utils/xhprof_lib.php\";\n    include_once $XHPROF_ROOT . \"/xhprof_lib/utils/xhprof_runs.php\";\n\n    $xhprof_runs = new XHProfRuns_Default();\n\n    $entryId = mt_rand();\n\n    $run_id = $xhprof_runs->save_run($xhprof_data, $entryId);\n    echo '<pre>'.htmlspecialchars(\"---------------\\n\".\n            \"Assuming you have set up the http based UI for \\n\".\n            \"XHProf at some address, you can view run at \\n\".\n            $PROF_URL.\"index.php?run=$run_id&source=$entryId\\n\".\n            \"---------------\\n\").'</pre>';\n} catch (Phalcon\\Exception $e) {\n    echo $e->getMessage();\n} catch (PDOException $e) {\n    echo $e->getMessage();\n}\n\n\n\u52d5\u4f5c\u78ba\u8a8d\n\u4e0a\u8a18\u306e\u3088\u3046\u306b\u3059\u308b\u3068\u30a2\u30af\u30bb\u30b9\u3057\u305f\u6642\u306b\u6700\u5f8c\u306b\u4e0b\u8a18\u306e\u69d8\u306b\u8868\u793a\u3055\u308c\u308b\uff0e\n---------------\nAssuming you have set up the http based UI for \nXHProf at some address, you can view run at \nhttp://xhprof.example.com/index.php?run=53837aa5adf00&source=1372228594\n---------------\n\n\u305d\u306e URL \u306b\u30a2\u30af\u30bb\u30b9\u3057\u306b\u884c\u304f\u3068\u4e0b\u8a18\u306e\u7968\u306b \u6642\u9593\u3084\u30e1\u30e2\u30ea\u6d88\u8cbb\u91cf\u306a\u3069\u304c\u8868\u793a\u3055\u308c\u308b\uff0e 4ms \u65e9\u3044\u3067\u3059\u306d\uff0e\n\ngraphvis \u3092\u5165\u308c\u3066\u308b\u3068\u4e0b\u8a18\u306e\u3088\u3046\u306b\u30b3\u30fc\u30eb\u30b0\u30e9\u30d5\u3082\u898b\u3089\u308c\u308b\uff0e\u8d64\u304f\u306a\u3063\u3066\u308b\u306e\u306f\u5168\u4f53\u306b\u5bfe\u3059\u308b\u5272\u5408\u304c\u5927\u304d\u3044\u304b\u3089\u3060\u3051\u3069\u305d\u3082\u305d\u3082\u5b9f\u884c\u6642\u9593\u3068\u304b\u304c\u5c0f\u3055\u3044\u306e\u3067\u3042\u3093\u307e\u308a\u610f\u5473\u306a\u3044\uff0e\n\n\u3053\u308c\u3067\u3055\u3089\u306b\u30d1\u30d5\u30a9\u30fc\u30de\u30f3\u30b9\u30fb\u30c1\u30e5\u30fc\u30cb\u30f3\u30b0\u304c\u306f\u304b\u3069\u308a\u307e\u3059\u306d\uff0e\n# \u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\nphalcon \u306f\u5165\u308c\u3066\u308b\u524d\u63d0\uff0e\n\n\u307e\u305f\uff0c\u81ea\u5206\u306f VirtualHost \u3067 /var/www \u4ee5\u4e0b\u306a\u3069\u306b\u30c9\u30e1\u30a4\u30f3\u540d\u3067\u30a2\u30d7\u30ea\u3092\u5165\u308c\u3066 \u30ef\u30a4\u30eb\u30c9\u30ab\u30fc\u30c9\u3067\u76f4\u63a5\u305d\u3053\u3092\u53c2\u7167\u3059\u308b\u3088\u3046\u306b\u3059\u308b\u8a2d\u5b9a\u3092\u884c\u3063\u3066\u3044\u308b\u306e\u3067\u305d\u306e\u524d\u63d0\u3067\u3084\u308b\uff0e\n\n\u4f8b\u3048\u3070\u4e0b\u8a18\u306e\u3088\u3046\u306a\u8a2d\u5b9a\u3068\u304b\uff0e\n\n```apache\n<VirtualHost *:80>\n    ServerName exmple.com\n    ServerAlias *.example.com\n    Options -Indexes +FollowSymLinks\n    VirtualDocumentRoot \"/var/www/%0/web\"\n</VirtualHost>\n```\n\n## xhprof \u3092\u5165\u308c\u308b\n\napache \u7d4c\u7531\u3067\u53c2\u7167\u3067\u304d\u308b\u5834\u6240\u306b\u8a2d\u7f6e\uff0e\u3053\u3053\u3067\u306f\u524d\u8ff0\u306e\u3068\u304a\u308a /var/www \u4ee5\u4e0b\u306b\u7f6e\u304f\uff0e  phpize \u304c\u3069\u3046\u3084\u3063\u3066\u5165\u308b\u304b\u306f\u307e\u304b\u305b\u305f\uff0e\n\n```\n\n$ git clone https://github.com/facebook/xhprof xhprof.example.com\n$ cd xhprof\n$ phpize\n$ make\n$ sudo make install      # \u74b0\u5883\u306b\u3088\u308b\n$ ln -s xhprof_html web  # VirtualDocumentRoot \u304c web \u4ee5\u4e0b\u3060\u304b\u3089\n```\n\n# phalcon \u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306b\u9069\u7528\u3059\u308b\n\n\u4f8b\u3048\u3070 phalcon/devtool \u3067 modules \u3067\u4f5c\u3063\u305f\u5834\u5408\u306e public/prof.php \u306b\u4e0b\u8a18\u306e\u3088\u3046\u306b\u66f8\u304f\uff0e\u30b3\u30b3\u3089\u3078\u3093\u306f\u4e0a\u3067\u8a2d\u7f6e\u3057\u305f xhprof \u306e doc \u306e\u30da\u30fc\u30b8\u306b\u66f8\u3044\u3066\u3042\u308b\u3082\u306e\u3092\u53d6\u3063\u3066\u304d\u3066\u8cbc\u308a\u4ed8\u3051\u3066\u52d5\u304f\u3088\u3046\u306b\u3057\u305f\u3082\u306e\uff0e\n\n```php\n<?php\n\nuse Phalcon\\Mvc\\Application;\n\nerror_reporting(E_ALL);\n\ntry {\n\n    $PROF_URL = 'http://xhprof.example.com/';\n    $XHPROF_ROOT = '/var/www/xhprof.example.com/';\n\n    xhprof_enable(XHPROF_FLAGS_CPU + XHPROF_FLAGS_MEMORY);\n\n    /**\n     * Include services\n     */\n    require __DIR__ . '/../config/services.php';\n\n    /**\n     * Handle the request\n     */\n    $application = new Application();\n\n    /**\n     * Assign the DI\n     */\n    $application->setDI($di);\n\n    /**\n     * Include modules\n     */\n    require __DIR__ . '/../config/modules.php';\n\n    echo $application->handle()->getContent();\n\n    // xhprof\n    $xhprof_data = xhprof_disable();\n\n    include_once $XHPROF_ROOT . \"/xhprof_lib/utils/xhprof_lib.php\";\n    include_once $XHPROF_ROOT . \"/xhprof_lib/utils/xhprof_runs.php\";\n\n    $xhprof_runs = new XHProfRuns_Default();\n\n    $entryId = mt_rand();\n\n    $run_id = $xhprof_runs->save_run($xhprof_data, $entryId);\n    echo '<pre>'.htmlspecialchars(\"---------------\\n\".\n            \"Assuming you have set up the http based UI for \\n\".\n            \"XHProf at some address, you can view run at \\n\".\n            $PROF_URL.\"index.php?run=$run_id&source=$entryId\\n\".\n            \"---------------\\n\").'</pre>';\n} catch (Phalcon\\Exception $e) {\n    echo $e->getMessage();\n} catch (PDOException $e) {\n    echo $e->getMessage();\n}\n```\n\n# \u52d5\u4f5c\u78ba\u8a8d\n\n\u4e0a\u8a18\u306e\u3088\u3046\u306b\u3059\u308b\u3068\u30a2\u30af\u30bb\u30b9\u3057\u305f\u6642\u306b\u6700\u5f8c\u306b\u4e0b\u8a18\u306e\u69d8\u306b\u8868\u793a\u3055\u308c\u308b\uff0e\n\n\n```\n---------------\nAssuming you have set up the http based UI for \nXHProf at some address, you can view run at \nhttp://xhprof.example.com/index.php?run=53837aa5adf00&source=1372228594\n---------------\n```\n\n\u305d\u306e URL \u306b\u30a2\u30af\u30bb\u30b9\u3057\u306b\u884c\u304f\u3068\u4e0b\u8a18\u306e\u7968\u306b \u6642\u9593\u3084\u30e1\u30e2\u30ea\u6d88\u8cbb\u91cf\u306a\u3069\u304c\u8868\u793a\u3055\u308c\u308b\uff0e 4ms \u65e9\u3044\u3067\u3059\u306d\uff0e\n\n![screenshot 2014-05-27 2.33.31.png](https://qiita-image-store.s3.amazonaws.com/0/6975/c3972677-36cc-69d9-7fa1-1d1068b8b31d.png)\n\n\ngraphvis \u3092\u5165\u308c\u3066\u308b\u3068\u4e0b\u8a18\u306e\u3088\u3046\u306b\u30b3\u30fc\u30eb\u30b0\u30e9\u30d5\u3082\u898b\u3089\u308c\u308b\uff0e\u8d64\u304f\u306a\u3063\u3066\u308b\u306e\u306f\u5168\u4f53\u306b\u5bfe\u3059\u308b\u5272\u5408\u304c\u5927\u304d\u3044\u304b\u3089\u3060\u3051\u3069\u305d\u3082\u305d\u3082\u5b9f\u884c\u6642\u9593\u3068\u304b\u304c\u5c0f\u3055\u3044\u306e\u3067\u3042\u3093\u307e\u308a\u610f\u5473\u306a\u3044\uff0e\n\n![screenshot 2014-05-27 2.35.24.png](https://qiita-image-store.s3.amazonaws.com/0/6975/7723eccc-40d9-9a09-f438-9b012a7530f3.png)\n\n\n\u3053\u308c\u3067\u3055\u3089\u306b\u30d1\u30d5\u30a9\u30fc\u30de\u30f3\u30b9\u30fb\u30c1\u30e5\u30fc\u30cb\u30f3\u30b0\u304c\u306f\u304b\u3069\u308a\u307e\u3059\u306d\uff0e\n", "tags": ["Phalcon1.3.1", "xhprof0.9.2"]}