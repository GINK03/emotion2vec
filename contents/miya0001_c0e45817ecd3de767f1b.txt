{"context": "Behat/Mink \u7528\u306e\u30aa\u30ec\u30aa\u30ec\u30b3\u30f3\u30c6\u30ad\u30b9\u30c8\u3092\u4f5c\u3063\u305f\u6642\u306b\u3001\u305f\u3068\u3048\u3070\u30a8\u30e9\u30fc\u306b\u306a\u308b\u3079\u304d\u3068\u3053\u3067\u30a8\u30e9\u30fc\u306b\u306a\u308b\u304b\u3068\u304b\u3001\u305d\u3046\u3044\u3046\u306e\u3092 phpspec \u3067\u78ba\u8a8d\u3059\u308b\u65b9\u6cd5\u3002\n\u30c6\u30b9\u30c8\u306e\u305f\u3081\u306e\u30c6\u30b9\u30c8\u3063\u3066\u306a\u3093\u3060\u304b\u7121\u9650\u30eb\u30fc\u30d7\u306a\u611f\u3058\u3067\u3059\u304c\u3001\u6c4e\u7528\u7684\u306a\u30a8\u30af\u30b9\u30c6\u30f3\u30b7\u30e7\u30f3\u3092\u4f5c\u3063\u3066\u3066\u3001\u305d\u306e\u305f\u3081\u306b\u30c6\u30b9\u30c8\u3092\u3057\u305f\u3044\u306e\u3067\u3059\u3002\n\n\u524d\u63d0\u6761\u4ef6\nBehat \u306e WebDriver \u306b\u306f\u4ee5\u4e0b\u306e2\u7a2e\u985e\u3092\u4f7f\u3046\u3002\n\nGoutte\nSelenium2\n\n\n\u30c6\u30b9\u30c8\u5bfe\u8c61\u306e\u30b3\u30fc\u30c9\n\u3053\u306e\u8a18\u4e8b\u3067\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u30b3\u30f3\u30c6\u30ad\u30b9\u30c8\u304c\u3042\u308b\u3053\u3068\u3092\u60f3\u5b9a\u3057\u3066\u3044\u307e\u3059\u3002\n    /**\n     * Check http status code.\n     * Example: the HTTP status should be 400\n     *\n     * @param string $expect The HTTP status code.\n     * @then /^the HTTP status should be (?P<expect>[0-9]+)$/\n     */\n    public function the_http_status_should_be( $expect )\n    {\n        $status = $this->getSession() ->getStatusCode();\n        $this->assertSame( $status, intval( $expect ), sprintf(\n            'The HTTP status is %1$s, but it should be %2$s',\n            $status,\n            $expect\n        ) );\n    }\n\n*.feature \u306b\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u611f\u3058\u306e\u8a18\u8ff0\u3092\u3057\u3066\u671f\u5f85\u901a\u308a\u306e\u30b9\u30c6\u30fc\u30bf\u30b9\u30b3\u30fc\u30c9\u304c\u623b\u3063\u3066\u304f\u308b\u304b\u3092\u78ba\u8a8d\u3059\u308b\u305f\u3081\u306e\u30b3\u30f3\u30c6\u30ad\u30b9\u30c8\u3067\u3059\u3002\n\n  Scenario: Check http status code\n\n    When I am on \"/\"\n    Then the HTTP status should be 200\n\n    When I am on \"/the-page-not-found\"\n    Then the HTTP status should be 404\n\n\nSpec \u30d5\u30a1\u30a4\u30eb\u306e\u8a18\u8ff0\n\u4ee5\u4e0b\u306e\u30c6\u30b9\u30c8\u306f\u3001\u672c\u6765 200 \u3067\u3042\u308b\u306f\u305a\u306e URL \u306b\u30a2\u30af\u30bb\u30b9\u3057\u305f\u6642\u306b 404 \u3067\u3042\u308b\u3079\u304d\u3068\u6307\u5b9a\u3057\u305f\u3089\u4f8b\u5916\u304c\u623b\u3063\u3066\u304f\u308b\u304b\u3092\u78ba\u8a8d\u3057\u3066\u3044\u307e\u3059\u3002\n<?php\n\nnamespace spec\\VCCW\\Behat\\Mink\\MyExtension\\Context;\n\nuse PhpSpec\\ObjectBehavior;\n\nuse Behat\\Mink\\Mink,\n    Behat\\Mink\\Session,\n    Behat\\Mink\\Driver\\GoutteDriver,\n    Behat\\Mink\\Driver\\Goutte\\Client as GoutteClient,\n    Behat\\Mink\\Driver\\Selenium2Driver;\n\nclass RawMyContextSpec extends ObjectBehavior\n{\n    public function it_should_return_exception()\n    {\n        $this->init_mink( 'goutte' );\n        $session = $this->getSession();\n\n        $session->visit( 'http://127.0.0.1:8080/' );\n        $message = 'The HTTP status is 200, but it should be 404';\n        $this->shouldThrow( new \\Exception( $message ) )->during(\n            'the_http_status_should_be',\n            array( 404 )\n        );\n    }\n\n    private function init_mink( $driver )\n    {\n        $mink = new Mink( array(\n            'goutte' => new Session( new GoutteDriver( new GoutteClient() ) ),\n            'selenium2' => new Session( new Selenium2Driver() ),\n        ) );\n        $mink->setDefaultSessionName( $driver );\n        $this->setMink( $mink );\n    }\n}\n\n\n\u30dd\u30a4\u30f3\u30c8\n\n\ninit_mink() \u30e1\u30bd\u30c3\u30c9\u3067 Mink \u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u3092\u4f5c\u6210\u3059\u308b\u3002\n\ninit_mink \u306e\u5f15\u6570 $driver \u3067\u3001\u3069\u306e\u30c9\u30e9\u30a4\u30d0\u30fc\u3092\u4f7f\u7528\u3059\u308b\u304b\u3092\u6307\u5b9a\u3059\u308b\u3002\n\nMink \u3068\u304b\u305d\u306e\u30c9\u30e9\u30a4\u30d0\u30fc\u306e\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u3092\u8aad\u3081\u3070\u306a\u3093\u3060\u305d\u3093\u306a\u3053\u3068\u304b\u3063\u3066\u611f\u3058\u3060\u3063\u305f\u3093\u3067\u3059\u304c\u3001\u6570\u30f6\u6708\u524d\u306b\u6311\u6226\u3057\u3066\u305d\u306e\u6642\u306f\u3042\u304d\u3089\u3081\u305f\u306e\u3067\u3001\u3084\u3063\u3068\u3067\u304d\u3066\u3088\u304b\u3063\u305f\u3002\n\nBehat/Mink \u7528\u306e\u30aa\u30ec\u30aa\u30ec\u30b3\u30f3\u30c6\u30ad\u30b9\u30c8\u3092\u4f5c\u3063\u305f\u6642\u306b\u3001\u305f\u3068\u3048\u3070\u30a8\u30e9\u30fc\u306b\u306a\u308b\u3079\u304d\u3068\u3053\u3067\u30a8\u30e9\u30fc\u306b\u306a\u308b\u304b\u3068\u304b\u3001\u305d\u3046\u3044\u3046\u306e\u3092 phpspec \u3067\u78ba\u8a8d\u3059\u308b\u65b9\u6cd5\u3002\n\n\u30c6\u30b9\u30c8\u306e\u305f\u3081\u306e\u30c6\u30b9\u30c8\u3063\u3066\u306a\u3093\u3060\u304b\u7121\u9650\u30eb\u30fc\u30d7\u306a\u611f\u3058\u3067\u3059\u304c\u3001\u6c4e\u7528\u7684\u306a\u30a8\u30af\u30b9\u30c6\u30f3\u30b7\u30e7\u30f3\u3092\u4f5c\u3063\u3066\u3066\u3001\u305d\u306e\u305f\u3081\u306b\u30c6\u30b9\u30c8\u3092\u3057\u305f\u3044\u306e\u3067\u3059\u3002\n\n## \u524d\u63d0\u6761\u4ef6\n\nBehat \u306e WebDriver \u306b\u306f\u4ee5\u4e0b\u306e2\u7a2e\u985e\u3092\u4f7f\u3046\u3002\n\n* Goutte\n* Selenium2\n\n\n## \u30c6\u30b9\u30c8\u5bfe\u8c61\u306e\u30b3\u30fc\u30c9\n\n\u3053\u306e\u8a18\u4e8b\u3067\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u30b3\u30f3\u30c6\u30ad\u30b9\u30c8\u304c\u3042\u308b\u3053\u3068\u3092\u60f3\u5b9a\u3057\u3066\u3044\u307e\u3059\u3002\n\n```\n\t/**\n\t * Check http status code.\n\t * Example: the HTTP status should be 400\n\t *\n\t * @param string $expect The HTTP status code.\n\t * @then /^the HTTP status should be (?P<expect>[0-9]+)$/\n\t */\n\tpublic function the_http_status_should_be( $expect )\n\t{\n\t\t$status = $this->getSession() ->getStatusCode();\n\t\t$this->assertSame( $status, intval( $expect ), sprintf(\n\t\t\t'The HTTP status is %1$s, but it should be %2$s',\n\t\t\t$status,\n\t\t\t$expect\n\t\t) );\n\t}\n```\n\n`*.feature` \u306b\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u611f\u3058\u306e\u8a18\u8ff0\u3092\u3057\u3066\u671f\u5f85\u901a\u308a\u306e\u30b9\u30c6\u30fc\u30bf\u30b9\u30b3\u30fc\u30c9\u304c\u623b\u3063\u3066\u304f\u308b\u304b\u3092\u78ba\u8a8d\u3059\u308b\u305f\u3081\u306e\u30b3\u30f3\u30c6\u30ad\u30b9\u30c8\u3067\u3059\u3002\n\n```\n\n  Scenario: Check http status code\n\n    When I am on \"/\"\n    Then the HTTP status should be 200\n\n    When I am on \"/the-page-not-found\"\n    Then the HTTP status should be 404\n```\n\n## Spec \u30d5\u30a1\u30a4\u30eb\u306e\u8a18\u8ff0\n\n\u4ee5\u4e0b\u306e\u30c6\u30b9\u30c8\u306f\u3001\u672c\u6765 200 \u3067\u3042\u308b\u306f\u305a\u306e URL \u306b\u30a2\u30af\u30bb\u30b9\u3057\u305f\u6642\u306b 404 \u3067\u3042\u308b\u3079\u304d\u3068\u6307\u5b9a\u3057\u305f\u3089\u4f8b\u5916\u304c\u623b\u3063\u3066\u304f\u308b\u304b\u3092\u78ba\u8a8d\u3057\u3066\u3044\u307e\u3059\u3002\n\n```php\n<?php\n\nnamespace spec\\VCCW\\Behat\\Mink\\MyExtension\\Context;\n\nuse PhpSpec\\ObjectBehavior;\n\nuse Behat\\Mink\\Mink,\n    Behat\\Mink\\Session,\n\tBehat\\Mink\\Driver\\GoutteDriver,\n\tBehat\\Mink\\Driver\\Goutte\\Client as GoutteClient,\n\tBehat\\Mink\\Driver\\Selenium2Driver;\n\nclass RawMyContextSpec extends ObjectBehavior\n{\n\tpublic function it_should_return_exception()\n\t{\n\t\t$this->init_mink( 'goutte' );\n\t\t$session = $this->getSession();\n\n\t\t$session->visit( 'http://127.0.0.1:8080/' );\n\t\t$message = 'The HTTP status is 200, but it should be 404';\n\t\t$this->shouldThrow( new \\Exception( $message ) )->during(\n\t\t\t'the_http_status_should_be',\n\t\t\tarray( 404 )\n\t\t);\n\t}\n\n\tprivate function init_mink( $driver )\n\t{\n\t\t$mink = new Mink( array(\n\t\t\t'goutte' => new Session( new GoutteDriver( new GoutteClient() ) ),\n\t\t\t'selenium2' => new Session( new Selenium2Driver() ),\n\t\t) );\n\t\t$mink->setDefaultSessionName( $driver );\n\t\t$this->setMink( $mink );\n\t}\n}\n```\n\n### \u30dd\u30a4\u30f3\u30c8\n\n* `init_mink()` \u30e1\u30bd\u30c3\u30c9\u3067 Mink \u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u3092\u4f5c\u6210\u3059\u308b\u3002\n* `init_mink` \u306e\u5f15\u6570 $driver \u3067\u3001\u3069\u306e\u30c9\u30e9\u30a4\u30d0\u30fc\u3092\u4f7f\u7528\u3059\u308b\u304b\u3092\u6307\u5b9a\u3059\u308b\u3002\n\nMink \u3068\u304b\u305d\u306e\u30c9\u30e9\u30a4\u30d0\u30fc\u306e\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u3092\u8aad\u3081\u3070\u306a\u3093\u3060\u305d\u3093\u306a\u3053\u3068\u304b\u3063\u3066\u611f\u3058\u3060\u3063\u305f\u3093\u3067\u3059\u304c\u3001\u6570\u30f6\u6708\u524d\u306b\u6311\u6226\u3057\u3066\u305d\u306e\u6642\u306f\u3042\u304d\u3089\u3081\u305f\u306e\u3067\u3001\u3084\u3063\u3068\u3067\u304d\u3066\u3088\u304b\u3063\u305f\u3002\n\n", "tags": ["Mink", "phpspec", "behat"]}