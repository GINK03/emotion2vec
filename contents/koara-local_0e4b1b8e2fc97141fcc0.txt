{"context": "C# \u3067\u5f31\u53c2\u7167\u3092\u4f7f\u7528\u3057\u305f\u3044\u5834\u5408\u306e\u65b9\u6cd5\u30e1\u30e2\n\n\u76ee\u7684\n\n\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u3078\u306e\u53c2\u7167\u306f\u4fdd\u6301\u3057\u305f\u3044\u304c\u3001\u5f37\u3044\u53c2\u7167\u3092\u6301\u3063\u3066GC\u306e\u56de\u53ce\u5bfe\u8c61\u306b\u306a\u3089\u306a\u3044\u306e\u3092\u907f\u3051\u305f\u3044\n\u5faa\u74b0\u53c2\u7167\u306e\u56de\u907f\n\u30b3\u30f3\u30dd\u30b8\u30b7\u30e7\u30f3\u3057\u3066\u3044\u308b\u5b50\u306e\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u304b\u3089\u89aa\u306e\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u3092\u53c2\u7167\u3057\u305f\u3044\u5834\u5408\n\n\n\u4f7f\u3044\u65b9\n\n\u521d\u671f\u5316\nvar wref = new WeakReference<Hoge>(new Hoge);\n\n\n\n\u53c2\u7167\u6642\nHoge obj;\nif (wref.TryGetTarget(out obj))\n{\n    // \u53c2\u7167\u304c\u5fc5\u8981\u306a\u51e6\u7406\n}\n\n\nWeakReference<T>.TryGetTarget(out obj) \u306f\u53d6\u5f97\u6210\u529f/\u5931\u6557\u3092boolean\u578b\u3067\u8fd4\u3059\u3002\n\u6ce8\u610f\u70b9\u3068\u3057\u3066\u3001\u5f37\u3044\u53c2\u7167\u306e\u4fdd\u6301\u671f\u9593\u306f\u5f53\u7136\u306a\u304c\u3089\u3001if\u5f0f\u306e\u9593\u3060\u3051\u3067\u306f\u306a\u304f\u3001\u4e0a\u8a18\u306e\u4f8b\u3067\u3044\u3046\u3068\u53d6\u5f97\u5f8c\u3001obj \u304c\u7834\u68c4\u3055\u308c\u308b\u307e\u3067\u306b\u306a\u308b\u3002\u4e00\u6642\u5909\u6570\u3067\u306f\u306a\u304f\u3001\u9577\u3044\u751f\u5b58\u671f\u9593\u3092\u3082\u3064\u5909\u6570\u304c\u675f\u7e1b\u3057\u3066\u3057\u307e\u3046\u3068\u5f31\u53c2\u7167\u3067\u6301\u3063\u305f\u610f\u5473\u304c\u306a\u304f\u306a\u308b\u3002\n\n\u30e1\u30e2\nWeakReference<T> \u306f\u3001.NET Framework 4.5 \u4ee5\u964d\u3067\u4f7f\u7528\u53ef\u80fd\u3002\n\u305d\u308c\u4ee5\u524d\u306f WeakReference \u304c\u3064\u304b\u3048\u305f\u304c\u3001\u66f8\u304d\u65b9\u306b\u3088\u3063\u3066\u306fGC\u3067\u56de\u53ce\u3055\u308c\u305f\u5f8c\u306b\u53c2\u7167\u3067\u304d\u308b\u65b9\u6cd5\u304c\u3068\u308c\u3066\u3057\u307e\u3063\u305f\u3002\n\u305d\u3053\u3089\u3078\u3093\u306f\u4ee5\u4e0b\u306e\u8a18\u4e8b\u304c\u8a73\u3057\u3044\u3002\nWeakReference\u30fbWeakReference \u306e\u9055\u3044\u3068\u3001\u305d\u3053\u306b\u6f5c\u3080\u7f60 - Qiita\nWeakReference<T> \u306f\u3001TryGetTarget \u306e\u6587\u6cd5\u4e0a\u3001\u4f7f\u7528\u4e2d\u306f\u5f37\u3044\u53c2\u7167\u3092\u6301\u3064\u3053\u3068\u304c\u5f37\u5236\u3055\u308c\u308b\u305f\u3081\u4e0a\u8a18\u306e\u554f\u984c\u306f\u89e3\u6c7a\u3055\u308c\u305f\u3002\n\n\u3069\u3046\u3084\u3063\u3066\u5b9f\u73fe\u3055\u308c\u3066\u3044\u308b\u304b\nTODO: WeakReference<T> \u306f\u5185\u90e8\u7684\u306b IntPtr \u3067\u6301\u3063\u3066\u3044\u308b\u3068\u304b\u306a\u3093\u3068\u304b\u306e\u8a18\u4e8b\u3092\u898b\u304b\u3051\u305f\u3053\u3068\u304c\u3042\u308b\u3051\u308c\u3069\u3082\u3001\u305d\u306e\u8a18\u4e8b\u304c\u898b\u5f53\u305f\u3089\u306a\u3044\u306e\u3068\u6b63\u78ba\u304b\u3069\u3046\u304b\u304c\u308f\u304b\u3089\u306a\u3044\u306e\u3067\u8ffd\u8a18\u3059\u308b\n\nC# 7.0\u304b\u3089\n\n\u51fa\u529b\u5909\u6570\u5ba3\u8a00\nC# 7 \u306e\u65b0\u6a5f\u80fd - C# \u306b\u3088\u308b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u5165\u9580 | ++C++; // \u672a\u78ba\u8a8d\u98db\u884c C\nC# 7.0 \u304b\u3089\u306f\u3001\u65b0\u3057\u3044\u6587\u6cd5\u3068\u3057\u3066\u51fa\u529b\u5909\u6570\u5ba3\u8a00\u304c\u4f7f\u3048\u308b\u305f\u3081\u3001\u66f8\u304d\u65b9\u304c\u7c21\u7565\u5316\u3067\u304d\u308b\u3088\u3046\u3067\u3059\u3002\n\nC#7.0\u304b\u3089\u306e\u66f8\u304d\u65b9\nif (wref.TryGetTarget(out var obj))\n{\n    // \u53c2\u7167\u304c\u5fc5\u8981\u306a\u51e6\u7406\n}\n\n\n\n\u53c2\u8003\nWeakReference(T) \u30af\u30e9\u30b9 (System)\n\u3010\u96d1\u8a18\u3011\u5f31\u53c2\u7167 - C# \u306b\u3088\u308b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u5165\u9580 | ++C++; // \u672a\u78ba\u8a8d\u98db\u884c C\n\u3010.NET\u3011\u5f31\u3044\u3064\u306a\u304c\u308a\u3067WeakReference | \u5275\u9020\u7684\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u3068\u7c98\u571f\u7d30\u5de5\nC# \u3067\u5f31\u53c2\u7167\u3092\u4f7f\u7528\u3057\u305f\u3044\u5834\u5408\u306e\u65b9\u6cd5\u30e1\u30e2\n\n# \u76ee\u7684\n\n+ \u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u3078\u306e\u53c2\u7167\u306f\u4fdd\u6301\u3057\u305f\u3044\u304c\u3001\u5f37\u3044\u53c2\u7167\u3092\u6301\u3063\u3066GC\u306e\u56de\u53ce\u5bfe\u8c61\u306b\u306a\u3089\u306a\u3044\u306e\u3092\u907f\u3051\u305f\u3044\n+ \u5faa\u74b0\u53c2\u7167\u306e\u56de\u907f\n+ \u30b3\u30f3\u30dd\u30b8\u30b7\u30e7\u30f3\u3057\u3066\u3044\u308b\u5b50\u306e\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u304b\u3089\u89aa\u306e\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u3092\u53c2\u7167\u3057\u305f\u3044\u5834\u5408\n\n# \u4f7f\u3044\u65b9\n\n```csharp:\u521d\u671f\u5316\nvar wref = new WeakReference<Hoge>(new Hoge);\n```\n\n```csharp:\u53c2\u7167\u6642\nHoge obj;\nif (wref.TryGetTarget(out obj))\n{\n    // \u53c2\u7167\u304c\u5fc5\u8981\u306a\u51e6\u7406\n}\n```\n\n`WeakReference<T>.TryGetTarget(out obj)` \u306f\u53d6\u5f97\u6210\u529f/\u5931\u6557\u3092boolean\u578b\u3067\u8fd4\u3059\u3002\n\u6ce8\u610f\u70b9\u3068\u3057\u3066\u3001\u5f37\u3044\u53c2\u7167\u306e\u4fdd\u6301\u671f\u9593\u306f\u5f53\u7136\u306a\u304c\u3089\u3001if\u5f0f\u306e\u9593\u3060\u3051\u3067\u306f\u306a\u304f\u3001\u4e0a\u8a18\u306e\u4f8b\u3067\u3044\u3046\u3068\u53d6\u5f97\u5f8c\u3001`obj` \u304c\u7834\u68c4\u3055\u308c\u308b\u307e\u3067\u306b\u306a\u308b\u3002\u4e00\u6642\u5909\u6570\u3067\u306f\u306a\u304f\u3001\u9577\u3044\u751f\u5b58\u671f\u9593\u3092\u3082\u3064\u5909\u6570\u304c\u675f\u7e1b\u3057\u3066\u3057\u307e\u3046\u3068\u5f31\u53c2\u7167\u3067\u6301\u3063\u305f\u610f\u5473\u304c\u306a\u304f\u306a\u308b\u3002\n\n# \u30e1\u30e2\n\n`WeakReference<T>` \u306f\u3001`.NET Framework 4.5` \u4ee5\u964d\u3067\u4f7f\u7528\u53ef\u80fd\u3002\n\u305d\u308c\u4ee5\u524d\u306f `WeakReference` \u304c\u3064\u304b\u3048\u305f\u304c\u3001\u66f8\u304d\u65b9\u306b\u3088\u3063\u3066\u306fGC\u3067\u56de\u53ce\u3055\u308c\u305f\u5f8c\u306b\u53c2\u7167\u3067\u304d\u308b\u65b9\u6cd5\u304c\u3068\u308c\u3066\u3057\u307e\u3063\u305f\u3002\n\u305d\u3053\u3089\u3078\u3093\u306f\u4ee5\u4e0b\u306e\u8a18\u4e8b\u304c\u8a73\u3057\u3044\u3002\n\n[WeakReference\u30fbWeakReference<T> \u306e\u9055\u3044\u3068\u3001\u305d\u3053\u306b\u6f5c\u3080\u7f60 - Qiita](http://qiita.com/zakuro9715/items/99962062b986c7dc301d)\n\n`WeakReference<T>` \u306f\u3001`TryGetTarget` \u306e\u6587\u6cd5\u4e0a\u3001\u4f7f\u7528\u4e2d\u306f\u5f37\u3044\u53c2\u7167\u3092\u6301\u3064\u3053\u3068\u304c\u5f37\u5236\u3055\u308c\u308b\u305f\u3081\u4e0a\u8a18\u306e\u554f\u984c\u306f\u89e3\u6c7a\u3055\u308c\u305f\u3002\n\n# \u3069\u3046\u3084\u3063\u3066\u5b9f\u73fe\u3055\u308c\u3066\u3044\u308b\u304b\n\nTODO: `WeakReference<T>` \u306f\u5185\u90e8\u7684\u306b `IntPtr` \u3067\u6301\u3063\u3066\u3044\u308b\u3068\u304b\u306a\u3093\u3068\u304b\u306e\u8a18\u4e8b\u3092\u898b\u304b\u3051\u305f\u3053\u3068\u304c\u3042\u308b\u3051\u308c\u3069\u3082\u3001\u305d\u306e\u8a18\u4e8b\u304c\u898b\u5f53\u305f\u3089\u306a\u3044\u306e\u3068\u6b63\u78ba\u304b\u3069\u3046\u304b\u304c\u308f\u304b\u3089\u306a\u3044\u306e\u3067\u8ffd\u8a18\u3059\u308b\n\n# C# 7.0\u304b\u3089\n## \u51fa\u529b\u5909\u6570\u5ba3\u8a00\n[C# 7 \u306e\u65b0\u6a5f\u80fd - C# \u306b\u3088\u308b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u5165\u9580 | ++C++; // \u672a\u78ba\u8a8d\u98db\u884c C](http://ufcpp.net/study/csharp/cheatsheet/ap_ver7/#out-var)\n\n`C# 7.0` \u304b\u3089\u306f\u3001\u65b0\u3057\u3044\u6587\u6cd5\u3068\u3057\u3066`\u51fa\u529b\u5909\u6570\u5ba3\u8a00`\u304c\u4f7f\u3048\u308b\u305f\u3081\u3001\u66f8\u304d\u65b9\u304c\u7c21\u7565\u5316\u3067\u304d\u308b\u3088\u3046\u3067\u3059\u3002\n\n```csharp:C#7.0\u304b\u3089\u306e\u66f8\u304d\u65b9\nif (wref.TryGetTarget(out var obj))\n{\n    // \u53c2\u7167\u304c\u5fc5\u8981\u306a\u51e6\u7406\n}\n```\n\n# \u53c2\u8003\n[WeakReference(T) \u30af\u30e9\u30b9 (System)](https://msdn.microsoft.com/ja-jp/library/gg712738(v=vs.110).aspx)\n[\u3010\u96d1\u8a18\u3011\u5f31\u53c2\u7167 - C# \u306b\u3088\u308b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u5165\u9580 | ++C++; // \u672a\u78ba\u8a8d\u98db\u884c C](http://ufcpp.net/study/csharp/RmWeakReference.html)\n[\u3010.NET\u3011\u5f31\u3044\u3064\u306a\u304c\u308a\u3067WeakReference | \u5275\u9020\u7684\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u3068\u7c98\u571f\u7d30\u5de5](http://pro.art55.jp/?eid=1109086)\n", "tags": ["C#", ".NET4.5"]}