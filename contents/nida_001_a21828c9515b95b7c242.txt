{"context": "MySQL5.7\u672c \u8aad\u3093\u3067\u305f\u3089ssl\u306e\u8a2d\u5b9a\u304c\u7c21\u5358\u306b\u306a\u3063\u305f\u3068\u66f8\u3044\u3066\u3042\u3063\u305f\u306e\u3067\u8a66\u3057\u3066\u307f\u307e\u3057\u305f\u3002\uff08\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u8a3c\u660e\u306f\u8a66\u3057\u3066\u306a\u3044\u3067\u3059\u3002\uff09\n\u306a\u304a\u3001\u4f59\u8ac7\u3067\u3059\u304cmysql 5.6 on ubuntu 14\u3067ssl\u3084\u308d\u3046\u3068\u3057\u3066\u307f\u307e\u3057\u305f\u304c\u300cssl_CTX_set_default_verify_paths failed\u300d\u306e\u30a8\u30e9\u30fc\u3092\u6557\u308c\u307e\u305b\u3093\u3067\u3057\u305f\u2026\u6b8b\u5ff5\u3002\n\nmysql5.7\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\napt\u3067PON\u3002Ubuntu Xenial\u304b\u3089\u306f5.7\u304c\u30c7\u30d5\u30a9\u30eb\u30c8\u306b\u306a\u3063\u305f\u306e\u3067\u7279\u306b\u4f55\u304b\u3059\u308b\u5fc5\u8981\u306a\u3044\u3067\u3059\u3002\nsudo apt install mysql-server\n\n\n\u8a3c\u660e\u66f8\u306e\u7528\u610f\nmysql_ssl_rsa_setup\u306e\u304a\u304b\u3052\u3067\u8a3c\u660e\u66f8\u306e\u751f\u6210\u304c\u3081\u3061\u3083\u304f\u3061\u3083\u7c21\u5358\u306b\u306a\u308a\u307e\u3057\u305f\u306d\u3002\u3053\u306e\u30c4\u30fc\u30eb\u306fmysql-server\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u6642\u306b\u5165\u3063\u3066\u3044\u308b\u306e\u3067\u7279\u306b\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u4f5c\u696d\u306f\u5fc5\u8981\u306a\u3044\u3067\u3059\u3002\n\u65e9\u901f\u5b9f\u884c\u3002\nsudo -umysql mysql_ssl_rsa_setup\n\nmysql\u30e6\u30fc\u30b6\u30fc\u3067\u5b9f\u884c\u3059\u308b\u3068unable to write 'random state'\u3068\u6587\u53e5\u8a00\u308f\u308c\u307e\u3059\u304c\u8a3c\u660e\u66f8\u306e\u30d1\u30fc\u30df\u30c3\u30b7\u30e7\u30f3\u5909\u3048\u306a\u304f\u3066\u3044\u3044\u306e\u3067\u697d\u3067\u3059\u3002\n\u3053\u308c\u3067/var/lib/mysql/\u4ee5\u4e0b\u306bca\u8a3c\u660e\u66f8\u3001\u30b5\u30fc\u30d0\u30fc\u8a3c\u660e\u66f8\u3001\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u8a3c\u660e\u66f8\u304c\u3067\u304d\u307e\u3059\u3002\n\n\u8a2d\u5b9a\u306e\u5909\u66f4\nmysql\u306e\u8a2d\u5b9a\u306b\u8a3c\u660e\u66f8\u306e\u30d1\u30b9\u3092\u5165\u308c\u307e\u3059\u3002sudo vim /etc/mysql/mysql.conf.d/mysqld.cnf \u7b49\u3057\u3066\u30d5\u30a1\u30a4\u30eb\u3092\u958b\u3044\u3066\u4ee5\u4e0b\u3092\u8ffd\u52a0\u3057\u307e\u3059\u3002\nssl-ca=/var/lib/mysql/ca.pem\nssl-cert=/var/lib/mysql/server-cert.pem\nssl-key=/var/lib/mysql/server-key.pem\n\n\u3042\u3068\u306f sudo service mysql restart\u3002\n\nSSL\u6709\u52b9\u5316\u306e\u78ba\u8a8d\nmysql -uroot -p \u3057\u3066\u3064\u306a\u3044\u3067 show variables like '%ssl%'; \u3057\u307e\u3059\u3002\u3059\u308b\u3068\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u8868\u793a\u304c\u3067\u308b\u306f\u305a\u3067\u3059\u3002\n+---------------+--------------------------------+\n| Variable_name | Value                          |\n+---------------+--------------------------------+\n| have_openssl  | YES                            |\n| have_ssl      | YES                            |\n| ssl_ca        | /var/lib/mysql/ca.pem          |\n| ssl_capath    |                                |\n| ssl_cert      | /var/lib/mysql/server-cert.pem |\n| ssl_cipher    |                                |\n| ssl_crl       |                                |\n| ssl_crlpath   |                                |\n| ssl_key       | /var/lib/mysql/server-key.pem  |\n+---------------+--------------------------------+\n\nhave_openssl\u3068have_ssl\u304cYES\u306b\u306a\u3063\u3066\u3044\u308c\u3070\u6210\u529f\u3067\u3059\uff01\n\u3053\u308c\u304cDISABLED\u306b\u306a\u3063\u3066\u3044\u308b\u5834\u5408\u306f\u6b8b\u5ff5\u306a\u304c\u3089SSL\u304c\u6709\u52b9\u306b\u306a\u3063\u3066\u307e\u305b\u3093\u3002/var/log/mysql/error.log\u3092\u8aad\u3093\u3067\u30a8\u30e9\u30fc\u3092\u6f70\u3057\u307e\u3057\u3087\u3046\u3002\u3002\n\n\u63a5\u7d9a\u30c6\u30b9\u30c8\nmysql -uroot -p --ssl-mode=REQUIRED \u3068\u3057\u3066\u5f37\u5236ssl\u3067\u7e4b\u3044\u3067\u307f\u308b\u3068\u826f\u3055\u305d\u3046\u3067\u3059\u3002ssl\u304c\u6709\u52b9\u306b\u306a\u3063\u3066\u306a\u3044\u306a\u3089\u3053\u3053\u3067\u63a5\u7d9a\u5931\u6557\u3059\u308b\u306f\u305a\u3002\n[MySQL5.7\u672c](http://www.shoeisha.co.jp/book/detail/9784798147406) \u8aad\u3093\u3067\u305f\u3089ssl\u306e\u8a2d\u5b9a\u304c\u7c21\u5358\u306b\u306a\u3063\u305f\u3068\u66f8\u3044\u3066\u3042\u3063\u305f\u306e\u3067\u8a66\u3057\u3066\u307f\u307e\u3057\u305f\u3002\uff08\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u8a3c\u660e\u306f\u8a66\u3057\u3066\u306a\u3044\u3067\u3059\u3002\uff09\n\n\u306a\u304a\u3001\u4f59\u8ac7\u3067\u3059\u304cmysql 5.6 on ubuntu 14\u3067ssl\u3084\u308d\u3046\u3068\u3057\u3066\u307f\u307e\u3057\u305f\u304c\u300cssl_CTX_set_default_verify_paths failed\u300d\u306e\u30a8\u30e9\u30fc\u3092\u6557\u308c\u307e\u305b\u3093\u3067\u3057\u305f\u2026\u6b8b\u5ff5\u3002\n\n# mysql5.7\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\napt\u3067PON\u3002Ubuntu Xenial\u304b\u3089\u306f5.7\u304c\u30c7\u30d5\u30a9\u30eb\u30c8\u306b\u306a\u3063\u305f\u306e\u3067\u7279\u306b\u4f55\u304b\u3059\u308b\u5fc5\u8981\u306a\u3044\u3067\u3059\u3002\n\n```bash\nsudo apt install mysql-server\n```\n\n# \u8a3c\u660e\u66f8\u306e\u7528\u610f\nmysql_ssl_rsa_setup\u306e\u304a\u304b\u3052\u3067\u8a3c\u660e\u66f8\u306e\u751f\u6210\u304c\u3081\u3061\u3083\u304f\u3061\u3083\u7c21\u5358\u306b\u306a\u308a\u307e\u3057\u305f\u306d\u3002\u3053\u306e\u30c4\u30fc\u30eb\u306fmysql-server\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u6642\u306b\u5165\u3063\u3066\u3044\u308b\u306e\u3067\u7279\u306b\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u4f5c\u696d\u306f\u5fc5\u8981\u306a\u3044\u3067\u3059\u3002\n\u65e9\u901f\u5b9f\u884c\u3002\n\n```bash\nsudo -umysql mysql_ssl_rsa_setup\n```\n\nmysql\u30e6\u30fc\u30b6\u30fc\u3067\u5b9f\u884c\u3059\u308b\u3068`unable to write 'random state'`\u3068\u6587\u53e5\u8a00\u308f\u308c\u307e\u3059\u304c\u8a3c\u660e\u66f8\u306e\u30d1\u30fc\u30df\u30c3\u30b7\u30e7\u30f3\u5909\u3048\u306a\u304f\u3066\u3044\u3044\u306e\u3067\u697d\u3067\u3059\u3002\n\u3053\u308c\u3067/var/lib/mysql/\u4ee5\u4e0b\u306bca\u8a3c\u660e\u66f8\u3001\u30b5\u30fc\u30d0\u30fc\u8a3c\u660e\u66f8\u3001\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u8a3c\u660e\u66f8\u304c\u3067\u304d\u307e\u3059\u3002\n\n# \u8a2d\u5b9a\u306e\u5909\u66f4\nmysql\u306e\u8a2d\u5b9a\u306b\u8a3c\u660e\u66f8\u306e\u30d1\u30b9\u3092\u5165\u308c\u307e\u3059\u3002`sudo vim /etc/mysql/mysql.conf.d/mysqld.cnf` \u7b49\u3057\u3066\u30d5\u30a1\u30a4\u30eb\u3092\u958b\u3044\u3066\u4ee5\u4e0b\u3092\u8ffd\u52a0\u3057\u307e\u3059\u3002\n\n```\nssl-ca=/var/lib/mysql/ca.pem\nssl-cert=/var/lib/mysql/server-cert.pem\nssl-key=/var/lib/mysql/server-key.pem\n```\n\n\u3042\u3068\u306f `sudo service mysql restart`\u3002\n\n# SSL\u6709\u52b9\u5316\u306e\u78ba\u8a8d\n`mysql -uroot -p` \u3057\u3066\u3064\u306a\u3044\u3067 `show variables like '%ssl%';` \u3057\u307e\u3059\u3002\u3059\u308b\u3068\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u8868\u793a\u304c\u3067\u308b\u306f\u305a\u3067\u3059\u3002\n\n```mysql\n+---------------+--------------------------------+\n| Variable_name | Value                          |\n+---------------+--------------------------------+\n| have_openssl  | YES                            |\n| have_ssl      | YES                            |\n| ssl_ca        | /var/lib/mysql/ca.pem          |\n| ssl_capath    |                                |\n| ssl_cert      | /var/lib/mysql/server-cert.pem |\n| ssl_cipher    |                                |\n| ssl_crl       |                                |\n| ssl_crlpath   |                                |\n| ssl_key       | /var/lib/mysql/server-key.pem  |\n+---------------+--------------------------------+\n```\n\nhave_openssl\u3068have_ssl\u304cYES\u306b\u306a\u3063\u3066\u3044\u308c\u3070\u6210\u529f\u3067\u3059\uff01\n\u3053\u308c\u304cDISABLED\u306b\u306a\u3063\u3066\u3044\u308b\u5834\u5408\u306f\u6b8b\u5ff5\u306a\u304c\u3089SSL\u304c\u6709\u52b9\u306b\u306a\u3063\u3066\u307e\u305b\u3093\u3002/var/log/mysql/error.log\u3092\u8aad\u3093\u3067\u30a8\u30e9\u30fc\u3092\u6f70\u3057\u307e\u3057\u3087\u3046\u3002\u3002\n\n# \u63a5\u7d9a\u30c6\u30b9\u30c8\n`mysql -uroot -p --ssl-mode=REQUIRED` \u3068\u3057\u3066\u5f37\u5236ssl\u3067\u7e4b\u3044\u3067\u307f\u308b\u3068\u826f\u3055\u305d\u3046\u3067\u3059\u3002ssl\u304c\u6709\u52b9\u306b\u306a\u3063\u3066\u306a\u3044\u306a\u3089\u3053\u3053\u3067\u63a5\u7d9a\u5931\u6557\u3059\u308b\u306f\u305a\u3002\n", "tags": ["mysql5.7", "ubuntu16.04"]}