{"tags": ["reactjs", "react.js", "React"], "context": " More than 1 year has passed since last update.v0.13\u304b\u3089\u306eES6 Class\u8a18\u6cd5\u3067mixin\u304c\u4f7f\u3048\u306a\u3044\u554f\u984c\u3092\u89e3\u6c7a\u3059\u308b\u65b9\u6cd5\u3068\u3057\u3066Higher-Order Components\u3068\u3044\u3046\u65b9\u6cd5\u304c\u3042\u308b\u3002\nMixins Are Dead. Long Live Composition \u2014 Medium\nGunosy React Meetup\u306ekoba04\u3055\u3093\u306eLT\u3067\u7d39\u4ecb\u3055\u308c\u3066\u3044\u305f\u306e\u3092\u4eca\u66f4\u8abf\u3079\u305f\u306e\u3067\u307e\u3068\u3081\u308b\u3002\n\nmixin\u306e\u304a\u3055\u3089\u3044\nFlux\u30d5\u30ec\u30fc\u30e0\u30ef\u30fc\u30af\u3067\u3088\u304f\u3042\u308bStore\u3068Component\u3092\u3072\u3082\u3065\u3051\u308b\u305f\u3081\u306eMixin\u306e\u4f8b\u3002\n// Flux\u30d5\u30ec\u30fc\u30e0\u30ef\u30fc\u30af\u3067\u3088\u304f\u3042\u308bStore\u3068Component\u3092\u3072\u3082\u3065\u3051\u308b\u305f\u3081\u306eMixin\nfunction StoreMixin(...stores) {\n  var Mixin = {\n\n    getInitialState() {\n      // getStateFromStores\u306fComponent\u5074\u306b\u5b9a\u7fa9\u3059\u308b\n      return this.getStateFromStores(this.props);\n    },\n\n    // \u30e9\u30a4\u30d5\u30b5\u30a4\u30af\u30eb\u30e1\u30bd\u30c3\u30c9\u306b\u30d5\u30c3\u30af\u3059\u308b\n    // Mount\u6642\u306baddListener\u3057\u3066\u3001Umount\u6642\u306bremoveListener\n\n    componentDidMount() {\n      stores.forEach(store =>\n        store.addChangeListener(this.handleStoresChanged)\n      );\n\n      this.setState(this.getStateFromStores(this.props));\n    },\n\n    componentWillUnmount() {\n      stores.forEach(store =>\n        store.removeChangeListener(this.handleStoresChanged)\n      );\n    },\n\n    handleStoresChanged() {\n      if (this.isMounted()) {\n        this.setState(this.getStateFromStores(this.props));\n      }\n    }\n  };\n\n  return Mixin;\n}\n\n\u3053\u3046\u3044\u3046\u611f\u3058\u3067\u4f7f\u3046\u3002\nvar SomeComponent = React.createClass({\n  // \u3055\u3063\u304d\u306eMixin\n  // SomeStore\u66f4\u65b0\u6642\u306bSomeComponent\u306estate\u3092\u66f4\u65b0\u3059\u308b\n  mixins: [StoreMixin(SomeStore)],\n\n  propTypes: {\n    userId: PropTypes.number.isRequired\n  },\n\n  // Mixin\u304b\u3089\u547c\u3070\u308c\u308b\u30e1\u30bd\u30c3\u30c9\u3092\u5b9a\u7fa9\n  getStateFromStores(props) {\n    return {\n      user: UserStore.get(props.userId);\n    }\n  }\n\n  render() {\n    var { user } = this.state;\n    return <div>{user ? user.name : 'Loading'}</div>;\n  }\n});\n\nMixin\u306b\u306f\u3001\u2460\u30e6\u30fc\u30c6\u30a3\u30ea\u30c6\u30a3\u95a2\u6570\u3092\u8907\u6570\u306eComponent\u3067\u5171\u6709\u3059\u308b\u3001\u2461\u30e9\u30a4\u30d5\u30b5\u30a4\u30af\u30eb\u30e1\u30bd\u30c3\u30c9\u306b\u30d5\u30c3\u30af\u3057this.state\u3092\u66f4\u65b0\u3059\u308b\u3001\u3068\u3044\u3046\u5927\u304d\u304f2\u3064\u306e\u7528\u9014\u304c\u3042\u308a\u3001StoreMixin\u306f\u2461\u3002\nMixin\u3068Component\u3067\u540c\u3058\u30e9\u30a4\u30d5\u30b5\u30a4\u30af\u30eb\u30e1\u30bd\u30c3\u30c9\u3092\u5b9a\u7fa9\u3057\u3066\u3044\u308b\u5834\u5408\u306f\u3001\u3044\u3044\u611f\u3058\u306b\u30de\u30fc\u30b8\u3057\u3066\u3069\u3061\u3089\u3082\u5b9f\u884c\u3057\u3066\u304f\u308c\u308b\u3002getInitialState\u3082\u30ad\u30fc\u304c\u304b\u3076\u3063\u3066\u3044\u306a\u3051\u308c\u3070\u30de\u30fc\u30b8\u3055\u308c\u3066\u8a2d\u5b9a\u3055\u308c\u308b\u3002\n\nMixin\u306e\u30c7\u30e1\u30ea\u30c3\u30c8\nES6 Class\u3067\u8a18\u6cd5\u3067\u4f7f\u3048\u306a\u3044\u4ee5\u5916\u306b\u3001\n\n\u4e0a\u8a18\u306e\u4f8b\u306egetStateFromStores\u30e1\u30bd\u30c3\u30c9\u306e\u3088\u3046\u306b\u3001Component\u5074\u306b\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9\u3092\u7528\u610f\u3059\u308b\u5fc5\u8981\u304c\u3042\u308b\u5834\u5408\u3001Mixin\u304b\u3089\u305d\u308c\u3092\u5f37\u5236\u3059\u308b\u65b9\u6cd5\u304c\u306a\u3044\u3002\n\u8907\u6570\u306eMixin\u3067\u540c\u3058\u540d\u524d\u306e\u30e1\u30bd\u30c3\u30c9\u3092\u5b9a\u7fa9\u3057\u3066\u3044\u308b\u3068\u30af\u30e9\u30c3\u30b7\u30e5\u3059\u308b\n\n\n\u4e0a\u8a18\u3060\u3068mixins: [StoreMixin(A), StoreMixin(B)]\u3068\u3059\u308b\u3068\u3001handleStoresChanged\u304c\u304b\u3076\u3063\u3066\u3044\u308b\u306e\u3067\u4f8b\u5916\u3092\u6295\u3052\u308b\n\n\n\nthis.state\u306b\u5024\u3092\u8ffd\u52a0\u3059\u308b\u306e\u3067\u8907\u96d1\u306b\u306a\u308b\n\n\u306a\u3069\u306e\u554f\u984c\u304c\u3042\u308b\u3002\n\nHigher-Order Component\u3067\u540c\u3058\u3053\u3068\u3092\u3084\u308b\nHigher-Order Components\u3068\u306fComponent\u3092\u5225\u306eComponent\u3067Wrap\u3057\u3066\u3001\u305d\u306eWrap\u3059\u308b\u5074\u306b\u30e9\u30a4\u30d5\u30b5\u30a4\u30af\u30eb\u306e\u30e1\u30bd\u30c3\u30c9\u3092\u5b9a\u7fa9\u3059\u308b\u3053\u3068\u3067mixin\u304c\u63d0\u4f9b\u3057\u3066\u3044\u305f\u30e9\u30a4\u30d5\u30b5\u30a4\u30af\u30eb\u306e\u30d5\u30c3\u30af\u3092\u5b9f\u73fe\u3059\u308b\u65b9\u6cd5\u3002\n/**\n * \u7b2c1\u5f15\u6570\u306b\u6e21\u3055\u308c\u305fComponent\u3068\u7b2c2\u5f15\u6570\u306b\u6e21\u3055\u308c\u305fStore\u3092\u7d10\u4ed8\u3051\u3066\u3001\n * Wrap\u3057\u305fComponent\u3092\u8fd4\u3059\n *\n * store\u304b\u3089\u3069\u3046\u3044\u3046\u98a8\u306b\u30c7\u30fc\u30bf\u3092\u53d6\u308a\u51fa\u3059\u304b\u306fgetStateFromStores\u3067\u6307\u5b9a\u3059\u308b\n */\nfunction connectToStores(Component, stores, getStateFromStores) {\n\n  // Wrap\u3059\u308bComponent\n  class StoreConnection extends React.Component {\n    getInitialState() {\n      return getStateFromStores(this.props);\n    }\n\n    // \u30e9\u30a4\u30d5\u30b5\u30a4\u30af\u30eb\u30e1\u30bd\u30c3\u30c9\u306b\u30d5\u30c3\u30af\u3059\u308b\n    // Mount\u6642\u306baddListener\u3057\u3066\u3001Umount\u6642\u306bremoveListener\n\n    componentDidMount() {\n      stores.forEach(store =>\n        store.addChangeListener(this.handleStoresChanged)\n      );\n    }\n\n    componentWillUnmount() {\n      stores.forEach(store =>\n        store.removeChangeListener(this.handleStoresChanged)\n      );\n    }\n\n    handleStoresChanged() {\n      if (this.isMounted()) {\n        this.setState(getStateFromStores(this.props));\n      }\n    }\n\n    render() {\n      // \u5f15\u6570\u3067\u6e21\u3055\u308c\u305fComponent\u306bprops\u7d4c\u7531\u3067\u30c7\u30fc\u30bf\u3092\u9023\u643a\u3057render\n      return <Component {...this.props} {...this.state} />;\n    }\n  }\n\n  return StoreConnection;\n};\n\n\u3053\u3046\u3044\u3046\u611f\u3058\u3067\u4f7f\u3046\n// Wrap\u3055\u308c\u308bComponent\nclass SomeComponent extends React.Component { ... }\n\n// \u5148\u307b\u3069Component\u5074\u306b\u5b9a\u7fa9\u3057\u3066\u3044\u305f\u30e1\u30bd\u30c3\u30c9\u306f\u5f15\u6570\u3068\u3057\u3066\u660e\u793a\u7684\u306b\u6e21\u3059\nvar getStateFromStores = function (props) { ... };\n\n// SomeComponent\u3092Wrap\u3057\u305f\u65b0\u3057\u3044Component\u3092\u8fd4\u3059\nconst NewComponent = connectToStores(SomeComponent, [SomeStore], getStateFromStores);\n\n// render\nReac.render(<NewComponent/>, document.body);\n\n\nHigher-Order Component\u306e\u826f\u3044\u70b9\u3068\u5236\u9650\u3068\u5236\u9650\u306e\u56de\u907f\nHigher-Order Component\u306e\u826f\u3044\u70b9\u306f\u3001\u3053\u3093\u306a\u611f\u3058\u3002\n\nMixin\u30fbComponent\u9593\u306e\u30c7\u30fc\u30bf\u306e\u53d7\u3051\u6e21\u3057\u304cprops\u7d4c\u7531\u3067\u30b7\u30f3\u30d7\u30eb\n\u4e0a\u8a18\u4f8b\u306egetStateFromStores\u306e\u3088\u3046\u306aMixin\u304cComponent\u306b\u8981\u6c42\u3057\u3066\u3044\u305f\u30e1\u30bd\u30c3\u30c9\u3092\u5207\u308a\u96e2\u305b\u308b\u306e\u3067\u3001Mixin\u3068Component\u304c\u758e\u7d50\u5408\u306b\u306a\u308b\n\n\u5236\u9650\u3068\u3057\u3066\u306f\u3001Wrap\u3059\u308bComponent\u306estate\u304c\u898b\u3048\u306a\u3044\uff06shouldComponentUpdate\u304c\u5b9a\u7fa9\u3067\u304d\u306a\u3044\u306e\u3067\u3001PureRenderMixin\u3084DOM\u64cd\u4f5c\u3092\u3059\u308b\u3088\u3046\u306aMixin\u306fHigher-Order Component\u3067\u306f\u5b9f\u88c5\u304c\u96e3\u3057\u3044OR\u3067\u304d\u306a\u3044\u3002\n\u8a18\u8ff0\u91cf\u3082Mixin\u3088\u308a\u3082\u591a\u3081\u306a\u611f\u3058\u306b\u306a\u308b\u3002\nPureRenderMixin\u306b\u3064\u3044\u3066\u306f\u3001PureComponent\u306e\u3088\u3046\u306aBase\u30af\u30e9\u30b9\u3092\u4f5c\u308c\u3070\u3044\u3051\u308b\u3063\u307d\u3044\u3002\nclass PureComponent extends React.Component {\n    shouldComponentUpdate () {\n        // state\u306e\u6bd4\u8f03\u51e6\u7406\u306a\u3069\n    }\n}\n\n\nWrap\u3059\u308bComponent\u5185\u90e8\u306eDOM\u3092\u53d6\u5f97\u3057\u305f\u3044\u5834\u5408\u306f\u3001v0.13\u304b\u3089ref\u306bcallback\u95a2\u6570\u3092\u6e21\u305b\u308b\u3088\u3046\u306b\u306a\u3063\u305f\u3088\u3046\u306a\u306e\u3067\u305d\u308c\u3092\u4f7f\u3048\u3070\u3001Wrapper\u5074\u304b\u3089DOM\u3092\u53d6\u5f97\u3067\u304d\u308b\u307f\u305f\u3044\u3002\nimport React, { Component } from 'react';\n\nclass App extends Component {\n  render () {\n    // ref\u306bcallback\u3092\u6e21\u3059\n    return <h1 ref={ this.props.refCallback }>Hello</h1>;\n  }\n}\n\nfunction wrap (ChildComponent) {\n  class Wrap extends Component {\n    componentDidMount () {\n      console.log('mounted!!!!!');\n    }\n\n    // ref\u304c\u5f15\u6570\u306b\u6e21\u3063\u3066\u304f\u308b\u306e\u3067\n    // \u305d\u308c\u3092React.findDOMNode\u3059\u308b\u3068DOM\u304c\u53d6\u308c\u308b\n   setChildRef(ref) {\n      console.log(React.findDOMNode(ref));\n    }\n\n    render () {\n      return <ChildComponent refCallback={this.setChildRef.bind(this)}/>;\n    }\n  }\n\n  return Wrap;\n}\n\nconst NewComponent = wrapHello(App);\nReact.render(<NewComponent/>, document.body); // console\u306bDOM\u304c\u51fa\u529b\u3055\u308c\u308b\u306f\u305a\n\n\n\u4ed6\u306e\u30a2\u30d7\u30ed\u30fc\u30c1\n\nflummox\u306eFluxComponent\nhttp://acdlite.github.io/flummox/docs/api/fluxcomponent\nflummox\u304c\u63d0\u4f9b\u3057\u3066\u3044\u308b<FluxComponent>\u306f\u3001Higher-Order Component\u3068\u4f3c\u3066\u3044\u308b\u304c\u3001\u95a2\u6570\u3067\u306f\u306a\u304fComponent\u3067\u5b9f\u88c5\u3055\u308c\u3066\u3044\u308b\u3002\n// InnerComponent\u306bthis.props.posts, this.props.comments\u7d4c\u7531\u3067\n// Store\u306e\u30c7\u30fc\u30bf\u304c\u6e21\u3055\u308c\u308b\n<FluxComponent connectToStores={{\n  posts: store => ({\n    post: store.getPost(this.props.post.id),\n  }),\n  comments: store => ({\n    comments: store.getCommentsForPost(this.props.post.id),\n  })\n}}>\n  <InnerComponent />\n</FluxComponent>\n\n// render\u3092\u30ab\u30b9\u30bf\u30e0\u3067\u304d\u308b\n<FluxComponent\n  connectToStores={{\n    posts: store => ({\n      post: store.getPost(this.props.postId),\n    })\n  }}\n  render={storeState => {\n    // Render whatever you want\n    return <InnerComponent {...storeState} />;\n  }}\n/>\n\n\u5b9f\u88c5\u3092\u898b\u308b\u3068\u3001\u5b50Componet\u3092Clone\u3057\u3066props\u3092\u5909\u3048\u308b\u307f\u305f\u3044\u306a\u5b9f\u88c5\u306b\u306a\u3063\u3066\u3044\u308b\u3002\n\n\u307e\u3068\u3081\n\nmixin\u306f\u4eca\u5f8c\u3001ES6 Class\u8a18\u6cd5\u306b\u5b9f\u88c5\u3055\u308c\u308b\u53ef\u80fd\u6027\u3082\u3042\u308b\u304c\u3001\u554f\u984c\u3082\u3042\u308b\n\n\nReact0.13.0-beta.1\u3067\u306eComponent\u306eES6 class\u3067\u306e\u7d99\u627f\u3068mixin\u304c\u4f7f\u3048\u306a\u3044\u7406\u7531\n\u30b5\u30dd\u30fc\u30c8\u3055\u308c\u306a\u3044\u3063\u307d\u3044\n\n\nHigher-Order\u3092\u4f7f\u3046\u3068Mixin\u30fbComponent\u9593\u304c\u758e\u7d50\u5408\u306b\u306a\u308a\u3001\u30b7\u30f3\u30d7\u30eb\u3067\u3044\u3044\nmixin\u3092\u5b8c\u5168\u306b\u7f6e\u304d\u63db\u3048\u308b\u3053\u3068\u304c\u3067\u304d\u308b\u308f\u3051\u3067\u306f\u306a\u3044\u304c\u3001\u306a\u3093\u3068\u304b\u306a\u308a\u305d\u3046\u306a\u304d\u304c\u3059\u308b\u3002\n\n\nv0.13\u304b\u3089\u306eES6 Class\u8a18\u6cd5\u3067mixin\u304c\u4f7f\u3048\u306a\u3044\u554f\u984c\u3092\u89e3\u6c7a\u3059\u308b\u65b9\u6cd5\u3068\u3057\u3066Higher-Order Components\u3068\u3044\u3046\u65b9\u6cd5\u304c\u3042\u308b\u3002\n\n[Mixins Are Dead. Long Live Composition \u2014 Medium](https://medium.com/@dan_abramov/mixins-are-dead-long-live-higher-order-components-94a0d2f9e750)\n\n[Gunosy React Meetup](http://gunosy-frontend.connpass.com/event/12636/)\u306e[koba04\u3055\u3093\u306eLT](https://speakerdeck.com/koba04/react-dot-js-v0-dot-13-changes-and-beyond)\u3067\u7d39\u4ecb\u3055\u308c\u3066\u3044\u305f\u306e\u3092\u4eca\u66f4\u8abf\u3079\u305f\u306e\u3067\u307e\u3068\u3081\u308b\u3002\n\n## mixin\u306e\u304a\u3055\u3089\u3044\n\nFlux\u30d5\u30ec\u30fc\u30e0\u30ef\u30fc\u30af\u3067\u3088\u304f\u3042\u308bStore\u3068Component\u3092\u3072\u3082\u3065\u3051\u308b\u305f\u3081\u306eMixin\u306e\u4f8b\u3002\n\n```js\n// Flux\u30d5\u30ec\u30fc\u30e0\u30ef\u30fc\u30af\u3067\u3088\u304f\u3042\u308bStore\u3068Component\u3092\u3072\u3082\u3065\u3051\u308b\u305f\u3081\u306eMixin\nfunction StoreMixin(...stores) {\n  var Mixin = {\n\n    getInitialState() {\n      // getStateFromStores\u306fComponent\u5074\u306b\u5b9a\u7fa9\u3059\u308b\n      return this.getStateFromStores(this.props);\n    },\n\n    // \u30e9\u30a4\u30d5\u30b5\u30a4\u30af\u30eb\u30e1\u30bd\u30c3\u30c9\u306b\u30d5\u30c3\u30af\u3059\u308b\n    // Mount\u6642\u306baddListener\u3057\u3066\u3001Umount\u6642\u306bremoveListener\n\n    componentDidMount() {\n      stores.forEach(store =>\n        store.addChangeListener(this.handleStoresChanged)\n      );\n\n      this.setState(this.getStateFromStores(this.props));\n    },\n\n    componentWillUnmount() {\n      stores.forEach(store =>\n        store.removeChangeListener(this.handleStoresChanged)\n      );\n    },\n\n    handleStoresChanged() {\n      if (this.isMounted()) {\n        this.setState(this.getStateFromStores(this.props));\n      }\n    }\n  };\n\n  return Mixin;\n}\n```\n\n\u3053\u3046\u3044\u3046\u611f\u3058\u3067\u4f7f\u3046\u3002\n\n```js\nvar SomeComponent = React.createClass({\n  // \u3055\u3063\u304d\u306eMixin\n  // SomeStore\u66f4\u65b0\u6642\u306bSomeComponent\u306estate\u3092\u66f4\u65b0\u3059\u308b\n  mixins: [StoreMixin(SomeStore)],\n\n  propTypes: {\n    userId: PropTypes.number.isRequired\n  },\n\n  // Mixin\u304b\u3089\u547c\u3070\u308c\u308b\u30e1\u30bd\u30c3\u30c9\u3092\u5b9a\u7fa9\n  getStateFromStores(props) {\n    return {\n      user: UserStore.get(props.userId);\n    }\n  }\n\n  render() {\n    var { user } = this.state;\n    return <div>{user ? user.name : 'Loading'}</div>;\n  }\n});\n```\n\nMixin\u306b\u306f\u3001\u2460\u30e6\u30fc\u30c6\u30a3\u30ea\u30c6\u30a3\u95a2\u6570\u3092\u8907\u6570\u306eComponent\u3067\u5171\u6709\u3059\u308b\u3001\u2461\u30e9\u30a4\u30d5\u30b5\u30a4\u30af\u30eb\u30e1\u30bd\u30c3\u30c9\u306b\u30d5\u30c3\u30af\u3057this.state\u3092\u66f4\u65b0\u3059\u308b\u3001\u3068\u3044\u3046\u5927\u304d\u304f2\u3064\u306e\u7528\u9014\u304c\u3042\u308a\u3001StoreMixin\u306f\u2461\u3002\n\nMixin\u3068Component\u3067\u540c\u3058\u30e9\u30a4\u30d5\u30b5\u30a4\u30af\u30eb\u30e1\u30bd\u30c3\u30c9\u3092\u5b9a\u7fa9\u3057\u3066\u3044\u308b\u5834\u5408\u306f\u3001\u3044\u3044\u611f\u3058\u306b\u30de\u30fc\u30b8\u3057\u3066\u3069\u3061\u3089\u3082\u5b9f\u884c\u3057\u3066\u304f\u308c\u308b\u3002getInitialState\u3082\u30ad\u30fc\u304c\u304b\u3076\u3063\u3066\u3044\u306a\u3051\u308c\u3070\u30de\u30fc\u30b8\u3055\u308c\u3066\u8a2d\u5b9a\u3055\u308c\u308b\u3002\n\n## Mixin\u306e\u30c7\u30e1\u30ea\u30c3\u30c8\n\nES6 Class\u3067\u8a18\u6cd5\u3067\u4f7f\u3048\u306a\u3044\u4ee5\u5916\u306b\u3001\n\n- \u4e0a\u8a18\u306e\u4f8b\u306e`getStateFromStores`\u30e1\u30bd\u30c3\u30c9\u306e\u3088\u3046\u306b\u3001Component\u5074\u306b\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9\u3092\u7528\u610f\u3059\u308b\u5fc5\u8981\u304c\u3042\u308b\u5834\u5408\u3001Mixin\u304b\u3089\u305d\u308c\u3092\u5f37\u5236\u3059\u308b\u65b9\u6cd5\u304c\u306a\u3044\u3002\n- \u8907\u6570\u306eMixin\u3067\u540c\u3058\u540d\u524d\u306e\u30e1\u30bd\u30c3\u30c9\u3092\u5b9a\u7fa9\u3057\u3066\u3044\u308b\u3068\u30af\u30e9\u30c3\u30b7\u30e5\u3059\u308b\n\t- \u4e0a\u8a18\u3060\u3068`mixins: [StoreMixin(A), StoreMixin(B)]`\u3068\u3059\u308b\u3068\u3001`handleStoresChanged`\u304c\u304b\u3076\u3063\u3066\u3044\u308b\u306e\u3067\u4f8b\u5916\u3092\u6295\u3052\u308b\n- `this.state`\u306b\u5024\u3092\u8ffd\u52a0\u3059\u308b\u306e\u3067\u8907\u96d1\u306b\u306a\u308b\n\n\u306a\u3069\u306e\u554f\u984c\u304c\u3042\u308b\u3002\n\n## Higher-Order Component\u3067\u540c\u3058\u3053\u3068\u3092\u3084\u308b\n\nHigher-Order Components\u3068\u306fComponent\u3092\u5225\u306eComponent\u3067Wrap\u3057\u3066\u3001\u305d\u306eWrap\u3059\u308b\u5074\u306b\u30e9\u30a4\u30d5\u30b5\u30a4\u30af\u30eb\u306e\u30e1\u30bd\u30c3\u30c9\u3092\u5b9a\u7fa9\u3059\u308b\u3053\u3068\u3067mixin\u304c\u63d0\u4f9b\u3057\u3066\u3044\u305f\u30e9\u30a4\u30d5\u30b5\u30a4\u30af\u30eb\u306e\u30d5\u30c3\u30af\u3092\u5b9f\u73fe\u3059\u308b\u65b9\u6cd5\u3002\n\n\n```js\n/**\n * \u7b2c1\u5f15\u6570\u306b\u6e21\u3055\u308c\u305fComponent\u3068\u7b2c2\u5f15\u6570\u306b\u6e21\u3055\u308c\u305fStore\u3092\u7d10\u4ed8\u3051\u3066\u3001\n * Wrap\u3057\u305fComponent\u3092\u8fd4\u3059\n *\n * store\u304b\u3089\u3069\u3046\u3044\u3046\u98a8\u306b\u30c7\u30fc\u30bf\u3092\u53d6\u308a\u51fa\u3059\u304b\u306fgetStateFromStores\u3067\u6307\u5b9a\u3059\u308b\n */\nfunction connectToStores(Component, stores, getStateFromStores) {\n\n  // Wrap\u3059\u308bComponent\n  class StoreConnection extends React.Component {\n    getInitialState() {\n      return getStateFromStores(this.props);\n    }\n\n    // \u30e9\u30a4\u30d5\u30b5\u30a4\u30af\u30eb\u30e1\u30bd\u30c3\u30c9\u306b\u30d5\u30c3\u30af\u3059\u308b\n    // Mount\u6642\u306baddListener\u3057\u3066\u3001Umount\u6642\u306bremoveListener\n\n    componentDidMount() {\n      stores.forEach(store =>\n        store.addChangeListener(this.handleStoresChanged)\n      );\n    }\n\n    componentWillUnmount() {\n      stores.forEach(store =>\n        store.removeChangeListener(this.handleStoresChanged)\n      );\n    }\n\n    handleStoresChanged() {\n      if (this.isMounted()) {\n        this.setState(getStateFromStores(this.props));\n      }\n    }\n\n    render() {\n      // \u5f15\u6570\u3067\u6e21\u3055\u308c\u305fComponent\u306bprops\u7d4c\u7531\u3067\u30c7\u30fc\u30bf\u3092\u9023\u643a\u3057render\n      return <Component {...this.props} {...this.state} />;\n    }\n  }\n\n  return StoreConnection;\n};\n```\n\n\u3053\u3046\u3044\u3046\u611f\u3058\u3067\u4f7f\u3046\n\n```js\n// Wrap\u3055\u308c\u308bComponent\nclass SomeComponent extends React.Component { ... }\n\n// \u5148\u307b\u3069Component\u5074\u306b\u5b9a\u7fa9\u3057\u3066\u3044\u305f\u30e1\u30bd\u30c3\u30c9\u306f\u5f15\u6570\u3068\u3057\u3066\u660e\u793a\u7684\u306b\u6e21\u3059\nvar getStateFromStores = function (props) { ... };\n\n// SomeComponent\u3092Wrap\u3057\u305f\u65b0\u3057\u3044Component\u3092\u8fd4\u3059\nconst NewComponent = connectToStores(SomeComponent, [SomeStore], getStateFromStores);\n\n// render\nReac.render(<NewComponent/>, document.body);\n```\n\n## Higher-Order Component\u306e\u826f\u3044\u70b9\u3068\u5236\u9650\u3068\u5236\u9650\u306e\u56de\u907f\n\nHigher-Order Component\u306e\u826f\u3044\u70b9\u306f\u3001\u3053\u3093\u306a\u611f\u3058\u3002\n\n- Mixin\u30fbComponent\u9593\u306e\u30c7\u30fc\u30bf\u306e\u53d7\u3051\u6e21\u3057\u304cprops\u7d4c\u7531\u3067\u30b7\u30f3\u30d7\u30eb\n- \u4e0a\u8a18\u4f8b\u306egetStateFromStores\u306e\u3088\u3046\u306aMixin\u304cComponent\u306b\u8981\u6c42\u3057\u3066\u3044\u305f\u30e1\u30bd\u30c3\u30c9\u3092\u5207\u308a\u96e2\u305b\u308b\u306e\u3067\u3001Mixin\u3068Component\u304c\u758e\u7d50\u5408\u306b\u306a\u308b\n\n\u5236\u9650\u3068\u3057\u3066\u306f\u3001Wrap\u3059\u308bComponent\u306estate\u304c\u898b\u3048\u306a\u3044\uff06shouldComponentUpdate\u304c\u5b9a\u7fa9\u3067\u304d\u306a\u3044\u306e\u3067\u3001[PureRenderMixin](https://facebook.github.io/react/docs/pure-render-mixin.html)\u3084DOM\u64cd\u4f5c\u3092\u3059\u308b\u3088\u3046\u306aMixin\u306fHigher-Order Component\u3067\u306f\u5b9f\u88c5\u304c\u96e3\u3057\u3044OR\u3067\u304d\u306a\u3044\u3002\n\u8a18\u8ff0\u91cf\u3082Mixin\u3088\u308a\u3082\u591a\u3081\u306a\u611f\u3058\u306b\u306a\u308b\u3002\n\nPureRenderMixin\u306b\u3064\u3044\u3066\u306f\u3001PureComponent\u306e\u3088\u3046\u306aBase\u30af\u30e9\u30b9\u3092\u4f5c\u308c\u3070\u3044\u3051\u308b\u3063\u307d\u3044\u3002\n\n```js\nclass PureComponent extends React.Component {\n\tshouldComponentUpdate () {\n\t\t// state\u306e\u6bd4\u8f03\u51e6\u7406\u306a\u3069\n\t}\n}\n\n```\n\nWrap\u3059\u308bComponent\u5185\u90e8\u306eDOM\u3092\u53d6\u5f97\u3057\u305f\u3044\u5834\u5408\u306f\u3001v0.13\u304b\u3089ref\u306bcallback\u95a2\u6570\u3092\u6e21\u305b\u308b\u3088\u3046\u306b\u306a\u3063\u305f\u3088\u3046\u306a\u306e\u3067\u305d\u308c\u3092\u4f7f\u3048\u3070\u3001Wrapper\u5074\u304b\u3089DOM\u3092\u53d6\u5f97\u3067\u304d\u308b\u307f\u305f\u3044\u3002\n\n```js\nimport React, { Component } from 'react';\n\nclass App extends Component {\n  render () {\n    // ref\u306bcallback\u3092\u6e21\u3059\n    return <h1 ref={ this.props.refCallback }>Hello</h1>;\n  }\n}\n\nfunction wrap (ChildComponent) {\n  class Wrap extends Component {\n    componentDidMount () {\n      console.log('mounted!!!!!');\n    }\n\n    // ref\u304c\u5f15\u6570\u306b\u6e21\u3063\u3066\u304f\u308b\u306e\u3067\n    // \u305d\u308c\u3092React.findDOMNode\u3059\u308b\u3068DOM\u304c\u53d6\u308c\u308b\n   setChildRef(ref) {\n      console.log(React.findDOMNode(ref));\n    }\n\n    render () {\n      return <ChildComponent refCallback={this.setChildRef.bind(this)}/>;\n    }\n  }\n\n  return Wrap;\n}\n\nconst NewComponent = wrapHello(App);\nReact.render(<NewComponent/>, document.body); // console\u306bDOM\u304c\u51fa\u529b\u3055\u308c\u308b\u306f\u305a\n```\n\n## \u4ed6\u306e\u30a2\u30d7\u30ed\u30fc\u30c1\n\n### flummox\u306eFluxComponent\n\nhttp://acdlite.github.io/flummox/docs/api/fluxcomponent\n\nflummox\u304c\u63d0\u4f9b\u3057\u3066\u3044\u308b`<FluxComponent>`\u306f\u3001Higher-Order Component\u3068\u4f3c\u3066\u3044\u308b\u304c\u3001\u95a2\u6570\u3067\u306f\u306a\u304fComponent\u3067\u5b9f\u88c5\u3055\u308c\u3066\u3044\u308b\u3002\n\n```js\n// InnerComponent\u306bthis.props.posts, this.props.comments\u7d4c\u7531\u3067\n// Store\u306e\u30c7\u30fc\u30bf\u304c\u6e21\u3055\u308c\u308b\n<FluxComponent connectToStores={{\n  posts: store => ({\n    post: store.getPost(this.props.post.id),\n  }),\n  comments: store => ({\n    comments: store.getCommentsForPost(this.props.post.id),\n  })\n}}>\n  <InnerComponent />\n</FluxComponent>\n\n// render\u3092\u30ab\u30b9\u30bf\u30e0\u3067\u304d\u308b\n<FluxComponent\n  connectToStores={{\n    posts: store => ({\n      post: store.getPost(this.props.postId),\n    })\n  }}\n  render={storeState => {\n    // Render whatever you want\n    return <InnerComponent {...storeState} />;\n  }}\n/>\n```\n\n[\u5b9f\u88c5](https://github.com/acdlite/flummox/blob/master/src/addons/FluxComponent.js#L63-L68)\u3092\u898b\u308b\u3068\u3001\u5b50Componet\u3092Clone\u3057\u3066props\u3092\u5909\u3048\u308b\u307f\u305f\u3044\u306a\u5b9f\u88c5\u306b\u306a\u3063\u3066\u3044\u308b\u3002\n\n\n## \u307e\u3068\u3081\n\n- mixin\u306f\u4eca\u5f8c\u3001ES6 Class\u8a18\u6cd5\u306b\u5b9f\u88c5\u3055\u308c\u308b\u53ef\u80fd\u6027\u3082\u3042\u308b\u304c\u3001\u554f\u984c\u3082\u3042\u308b\n\t- [React0.13.0-beta.1\u3067\u306eComponent\u306eES6 class\u3067\u306e\u7d99\u627f\u3068mixin\u304c\u4f7f\u3048\u306a\u3044\u7406\u7531](http://qiita.com/mizchi/items/ce9a128aa2a47804e083)\n\t- \u30b5\u30dd\u30fc\u30c8\u3055\u308c\u306a\u3044\u3063\u307d\u3044\n- Higher-Order\u3092\u4f7f\u3046\u3068Mixin\u30fbComponent\u9593\u304c\u758e\u7d50\u5408\u306b\u306a\u308a\u3001\u30b7\u30f3\u30d7\u30eb\u3067\u3044\u3044\n- mixin\u3092\u5b8c\u5168\u306b\u7f6e\u304d\u63db\u3048\u308b\u3053\u3068\u304c\u3067\u304d\u308b\u308f\u3051\u3067\u306f\u306a\u3044\u304c\u3001\u306a\u3093\u3068\u304b\u306a\u308a\u305d\u3046\u306a\u304d\u304c\u3059\u308b\u3002\n"}