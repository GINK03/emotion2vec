{"context": "\n\nIBM Containers\u3067OSS\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u52d5\u304b\u3057\u3066\u307f\u308b\u3002\n\u3053\u306e\u8a18\u4e8b\u306f\u3001teratail Bluemix\u30a2\u30c9\u30d9\u30f3\u30c8\u30ab\u30ec\u30f3\u30c0\u30fc\u306e12/10\u5206\u306e\u8a18\u4e8b\u3067\u3059\u3002\n12/3\u306eikuwow\u3055\u3093\u306e\u8a18\u4e8b\u3068\u88ab\u308b\u7b87\u6240\u3070\u304b\u308a\u3067\u3059\u304c\u30fb\u30fb\u30fb\n\uff08\u3059\u3044\u307e\u305b\u3093\u3001\u4e88\u7d04\u6642\u306bcontainer\u306a\u304b\u3063\u305f\u306e\u3067\u66f8\u3044\u3066\u305f\u306e\u3067\u3059\u304c\u30fb\u30fb\u30fb\u4eca\u65e5\u6295\u7a3f\u3057\u3066\u307f\u305f\u3089\u5148\u306bcontainer\u30cd\u30bf\u3067\u66f8\u3044\u3066\u304a\u3089\u308c\u305f\u3088\u3046\u3067\u3057\u305f\u3002\uff09\n\u4eca\u56de\u306e\u8a18\u4e8b\u306fContainer+EC-CUBE3\u3060\u3068\u3053\u3093\u306a\u611f\u3058\u3067\u3059\u3088\u3002\u3068\u3044\u3046\u4f4d\u7f6e\u3065\u3051\u3067\u5fa1\u89a7\u304f\u3060\u3055\u3044\u3002\nDocker\u74b0\u5883\u3068\u3057\u3066IBM bluemix\u306e\u30e9\u30a4\u30f3\u30ca\u30c3\u30d7\u306e\u4e00\u3064\u3067\u3042\u308bIBM Containers\u3092\u5229\u7528\u3057\u3066Docker\u30b3\u30f3\u30c6\u30ca\u3092\u52d5\u4f5c\u3055\u305b\u307e\u3059\u3002\nEC-CUBE\u306b\u306fMySQL\u304c\u5fc5\u8981\u3067\u3059\u304c\u3001Bluemix\u5074\u306bMySQL\u306e\u30b5\u30fc\u30d3\u30b9\u304c\u3042\u308b\u306e\u3067\u4eca\u56de\u306f\u305d\u3061\u3089\u3092\u5229\u7528\u3057\u307e\u3059\u3002\nsystemd\u3092\u5229\u7528\u3057\u3066\u30b3\u30f3\u30c6\u30ca\u5185\u306bMySQL\u3092\u7acb\u3066\u308b\u3053\u3068\u3082\u8003\u3048\u305f\u306e\u3067\u3059\u304c\u3001docker privileged\u304c\u6307\u5b9a\u3067\u304d\u306a\u3044\u305f\u3081\u4eca\u56de\u306f\u4f7f\u7528\u3057\u307e\u305b\u3093\u3002\n\u203brev0.2\u8ffd\u8a18\uff1a\u3000MySQL\u3067\u306e\u521d\u671f\u30c7\u30fc\u30bf\u6295\u5165\u3067\u5931\u6557\u3067\u3059\u3002\u539f\u56e0\u8abf\u67fb\u5f8c\u518d\u6311\u6226\u3002\nBluemix\u3067ClearDB MySQL Database\u3092\u4f7f\u3063\u3066\u307f\u305f\n\n\u4e8b\u524d\u30d1\u30c3\u30b1\u30fc\u30b8\u306e\u5c0e\u5165\nCentOS7-1511(7.2) Minimal\u306aVM\u3092Bluemix Infrastracture\u306eBMS vmware\u4e0a\u306bVM\u3092\u69cb\u7bc9\u3057\u307e\u3057\u305f\u3002\n\u4ee5\u4e0b\u306f\u304a\u7d04\u675f\u3067\u5165\u308c\u3066\u3044\u308b\u9053\u5177\u9054\u3067\u3059\u3002\nbind-utils\u306fdig/nslookup\u304c\u5165\u3063\u3066\u304a\u308a\u3001net-tools\u306ftracert\u306a\u3069\u306elegacy\u306a\u30c4\u30fc\u30eb\u90e1\nopen-vm-tools\u306fVMwareTools\u3092\u30b3\u30f3\u30d1\u30a4\u30eb\u305b\u305a\u306b\u5c0e\u5165\u3067\u304d\u308b\u3053\u3068\u304b\u3089\u91cd\u5b9d\u3057\u3066\u3044\u307e\u3059\u3002\n\n\u30b3\u30de\u30f3\u30c9\n# yum install -y wget bind-utils net-tools open-vm-tools bzip2 unzip\n\n\n\u4eca\u56de\u306fdocker+docker-compose\u3082\u4f75\u305b\u3066\u5c0e\u5165\u3057\u305f\u70ba\u3001epel,python pip\u30b3\u30de\u30f3\u30c9\u3092\u5c0e\u5165\u3057\u307e\u3057\u305f\u3002\npip\u30b3\u30de\u30f3\u30c9\u3067\u5ff5\u306e\u305f\u3081\u5468\u8fba\u30c4\u30fc\u30eb\u3082\u4f75\u305b\u3066\u30a2\u30c3\u30d7\u30b0\u30ec\u30fc\u30c9\u3057\u3066\u304a\u304d\u307e\u3057\u3087\u3046\u3002\n\n\u30b3\u30de\u30f3\u30c9\n# yum install -y epel-release\n# yum install -y python-pip\n# pip install pip --upgrade\n\n\n\n1. docker build\u74b0\u5883\u3092\u69cb\u7bc9\u3059\u308b\n\n1-1. docker \u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\ndocker \u30d1\u30c3\u30b1\u30fc\u30b8\u306e\u5c0e\u5165\u3092\u3057\u307e\u3059\u3002\n\nbash\n# yum -y install docker\n\n\n\n1-2. docker\u30b5\u30fc\u30d3\u30b9\u306e\u81ea\u52d5\u8d77\u52d5\u8a2d\u5b9a/\u8d77\u52d5\ndocker \u30b5\u30fc\u30d3\u30b9\u306e\u81ea\u52d5\u8d77\u52d5\u8a2d\u5b9a\u3068\u8d77\u52d5\u3092\u3057\u307e\u3059\u3002\n\n\u30b3\u30de\u30f3\u30c9\n# systemctl enable docker.service\n# systemctl start docker.service\n\n\n\n2. Bluemix CLI\u3092\u59cb\u3081\u3068\u3057\u305fBluemix\u95a2\u9023\u30c4\u30fc\u30eb\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\nBluemix CLI\u3092\u5c0e\u5165\u3057\u307e\u3059\u3002\n\u3053\u306e\u30c4\u30fc\u30eb\u3067\u306fBluemix API\u3068CloudFoundry API\u3092\u5229\u7528\u3057\u3066\nBluemix\u4e0a\u306e\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u5236\u5fa1\u304c\u53ef\u80fd\u3067\u3059\u304c\u3001\n\u4eca\u56de\u306fdocker build\u3057\u305f\u30a4\u30e1\u30fc\u30b8\u3092bluemix registry\u306bpush\u3059\u308b\u3053\u3068\u3092\u76ee\u7684\u3068\u3057\u3066\u5c0e\u5165\u3057\u307e\u3059\u3002\n\n2-1. CloudFoundry CLI\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\n\n2-1-1. CloudFoundry CLI\u30d1\u30c3\u30b1\u30fc\u30b8\u306e\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\nhttps://github.com/cloudfoundry/cli/releases\n\u304b\u3089\u6700\u65b0\u7248\u306e\u300cRedhat Linux 64bit\u300d\u306eURL\u3092\u30b3\u30d4\u30fc\u3057\u3066wget\u3057\u307e\u3059\u3002\nURL\u306b&\u8a18\u53f7\u306a\u3069\u304c\u5165\u3063\u3066\u3044\u308b\u306e\u3067\u30c0\u30d6\u30eb\u30af\u30a6\u30a9\u30fc\u30c8\u4ed8\u304d\u3001-O\u3067\u30d5\u30a1\u30a4\u30eb\u540d\u6307\u5b9a\u3092\u3057\u3066\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3092\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\u4ee5\u4e0b\u3092\u53c2\u8003\u306b\u5b9f\u884c\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\uff08\u30d0\u30fc\u30b8\u30e7\u30f3\u306f\u57f7\u7b46\u6642\u70b9\uff09\n\n\u30b3\u30de\u30f3\u30c9\n# wget \"https://cli.run.pivotal.io/stable?release=redhat64&version=6.22.2&source=github-rel\" -O cf-cli-installer_6.22.2_x86-64.rpm\n\n\n\n2-1-2. CloudFoundry CLI\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n\u30b3\u30de\u30f3\u30c9\n# yum install -y cf-cli-installer_6.22.2_x86-64.rpm\n\n\n\n2-2. Bluxmix CLI\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\n\n2-2-1. Bluxmix CLI\u30d1\u30c3\u30b1\u30fc\u30b8\u306e\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\nhttp://clis.ng.bluemix.net/ui/home.html\n\u304b\u3089\u300c\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9Linux(64-bit\u7528)\u300d\u3092\u53d6\u5f97\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\uff08\u30d0\u30fc\u30b8\u30e7\u30f3\u306f\u57f7\u7b46\u6642\u70b9\uff09\n# wget http://public.dhe.ibm.com/cloud/bluemix/cli/bluemix-cli/Bluemix_CLI_0.4.4_amd64.tar.gz\n# tar xzf Bluemix_CLI_0.4.4_amd64.tar.gz\n# cd Bluemix_CLI\n\n\n2-2-2. Bluemix CLI\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n\u30b3\u30de\u30f3\u30c9\n# ./install_bluemix_cli\nThe Cloud Foundry CLI was not found on your system. Install CLI from https://github.com/cloudfoundry/cli/releases before you install the Bluemix CLI.\nCopying files ...\nThe Bluemix Command Line Interface (Bluemix CLI) is installed successfully.\nTo get started, open a new Linux terminal and enter \"bluemix help\", or enter \"bx help\" as short name.\n\nWith Bluemix CLI 0.4.0 or later, the CLI can automatically collect diagnostic and usage information and send it to Bluemix for analysis.\nThis information will help us better understand current client usage and plan for future use. No personally identifiable data is collected.\n\nTo stop collecting information, you can run the following command:\n        'bluemix config --usage-stats-collect false'\n\n\n\n\u30002-3. Bluxmix plugins \u306e\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\nBluemix CLI + IBM Containers Plugin\u306e\u7d44\u307f\u5408\u308f\u305b\u3067\u521d\u3081\u3066IBM Containers\u306e\u5236\u5fa1\u304c\u53ef\u80fd\u3068\u306a\u308a\u307e\u3059\u3002\n\n2-3-1. Bluemix CLI \u3067\u30ec\u30dd\u30b8\u30c8\u30ea\u304b\u3089\u30d7\u30e9\u30b0\u30a4\u30f3\u60c5\u5831\u306e\u53d6\u5f97\n\u6700\u4e0b\u90e8\u306bIBM Containers\u3000Plugin\u304c\u8868\u793a\u3055\u308c\u307e\u3057\u305f\u3002\u4ed6\u306b\u3082bluemix\u3067\u5229\u7528\u3067\u304d\u308b\u30b5\u30fc\u30d3\u30b9\u306f\u3053\u3053\u3067\u30d7\u30e9\u30b0\u30a4\u30f3\u3092\u8ffd\u52a0\u3059\u308b\u3053\u3068\u3067\u64cd\u4f5c\u304c\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\n# bluemix plugin repo-plugins -r Bluemix\n\u30ea\u30dd\u30b8\u30c8\u30ea\u30fc 'Bluemix' \u304b\u3089\u30d7\u30e9\u30b0\u30a4\u30f3\u3092\u53d6\u5f97\u3057\u3066\u3044\u307e\u3059...\n\n\u30ea\u30dd\u30b8\u30c8\u30ea\u30fc: Bluemix\n\u540d\u524d                      \u8aac\u660e                                                                                                                                                         \u30d0\u30fc\u30b8\u30e7\u30f3\n\uff5e\u4e2d\u7565\uff5e\nIBM-Containers            Plugin to operate IBM Containers service                                                                                                                     1.0.0\n\n\n2-3-2. IBM-Containers plugin\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\u5b9f\u969b\u306b\u30d7\u30e9\u30b0\u30a4\u30f3\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3092\u3057\u307e\u3057\u3087\u3046\u3002\n# bluemix plugin install IBM-Containers -r Bluemix\n\u30ea\u30dd\u30b8\u30c8\u30ea\u30fc 'Bluemix' \u304b\u3089 'IBM-Containers' \u3092\u691c\u7d22\u3057\u3066\u3044\u307e\u3059...\n\u30d0\u30a4\u30ca\u30ea\u30fc\u30fb\u30d5\u30a1\u30a4\u30eb\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3057\u3088\u3046\u3068\u3057\u3066\u3044\u307e\u3059...\n10219972 \u30d0\u30a4\u30c8\u304c\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3055\u308c\u307e\u3057\u305f\n\u30d0\u30a4\u30ca\u30ea\u30fc\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u3066\u3044\u307e\u3059...\nOK\n\u30d7\u30e9\u30b0\u30a4\u30f3 'IBM-Containers 1.0.0' \u306f /root/.bluemix/plugins/IBM-Containers \u306b\u6b63\u5e38\u306b\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u307e\u3057\u305f\u3002\n\n\n2-3-3. Bluemix CLI\u3067\u306e\u30ed\u30b0\u30a4\u30f3\u78ba\u8a8d\n\u30ed\u30b0\u30a4\u30f3\u7528\u306e\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3059\u308b\u3068\u3001Email\u3001\u30d1\u30b9\u30ef\u30fc\u30c9\u3092\u6c42\u3081\u3089\u308c\u307e\u3059\u3002\nBluemix\u306e\u30b3\u30f3\u30bd\u30fc\u30eb\u306b\u30ed\u30b0\u30a4\u30f3\u3059\u308b\u969b\u306b\u4f7f\u7528\u3059\u308bIBM ID/Password\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\u30ed\u30b0\u30a4\u30f3\u5f8c\u3001\u4e8b\u524d\u306bBluemix\u30b3\u30f3\u30bd\u30fc\u30eb\u3067\u30ed\u30b0\u30a4\u30f3\u3057\u305f\u969b\u306b\u6c7a\u3081\u305f\u300c\u30b9\u30da\u30fc\u30b9\u300d\u304c\u8868\u793a\u3055\u308c\u307e\u3059\u3002\n\n\u30b3\u30de\u30f3\u30c9\n# bluemix login -a https://api.ng.bluemix.net\n'cf login -a https://api.ng.bluemix.net' \u3092\u8d77\u52d5\u3057\u3066\u3044\u307e\u3059...\n\nAPI \u30a8\u30f3\u30c9\u30dd\u30a4\u30f3\u30c8: https://api.ng.bluemix.net\n\nEmail> {\u30ed\u30b0\u30a4\u30f3\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9}\n\nPassword>{\u30d1\u30b9\u30ef\u30fc\u30c9}\n\u8a8d\u8a3c\u4e2d\u3067\u3059...\nOK\n\n\u7d44\u7e54 {\u30ed\u30b0\u30a4\u30f3\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9} \u3092\u30bf\u30fc\u30b2\u30c3\u30c8\u306b\u3057\u307e\u3057\u305f\n\n\u30b9\u30da\u30fc\u30b9 {\u30b9\u30da\u30fc\u30b9\u540d} \u3092\u30bf\u30fc\u30b2\u30c3\u30c8\u306b\u3057\u307e\u3057\u305f\n\n\n\nAPI \u30a8\u30f3\u30c9\u30dd\u30a4\u30f3\u30c8:   https://api.ng.bluemix.net (API \u30d0\u30fc\u30b8\u30e7\u30f3: 2.54.0)\n\u30e6\u30fc\u30b6\u30fc:             {\u30ed\u30b0\u30a4\u30f3\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9}\n\u7d44\u7e54:                 {\u30ed\u30b0\u30a4\u30f3\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9}\n\u30b9\u30da\u30fc\u30b9:             {\u30b9\u30da\u30fc\u30b9\u540d}\n\n\n\n3. docker\u30d3\u30eb\u30c9\u74b0\u5883\u306e\u6574\u5099\u30fbbluemix\u3068\u306e\u63a5\u7d9a\n\u3053\u3053\u307e\u3067\u3067Bluemix\u3078\u63a5\u7d9a\u3057\u3066\u64cd\u4f5c\u3067\u304d\u308b\u74b0\u5883\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u304c\u5b8c\u4e86\u3057\u307e\u3057\u305f\u3002\n\u3053\u3053\u304b\u3089\u306f\u3044\u3088\u3044\u3088\u30b3\u30f3\u30c6\u30ca\u3092\u30d3\u30eb\u30c9\u3059\u308b\u305f\u3081\u306e\u9053\u5177\u3092\u6e96\u5099\u3057\u307e\u3059\u3002\n\n3-1. docker composer \u306e\u6e96\u5099\n\u307e\u305a\u306fPython\u5468\u308a\u306e\u30d1\u30c3\u30b1\u30fc\u30b8\u3092\u30a2\u30c3\u30d7\u30c7\u30fc\u30c8\u3001pip\u30b3\u30de\u30f3\u30c9\u81ea\u4f53\u306e\u30a2\u30c3\u30d7\u30c7\u30fc\u30c8\u3001\ndocker-composer\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3092\u5b9f\u65bd\u3057\u307e\u3059\u3002\n\n\u30b3\u30de\u30f3\u30c9\n# yum upgrade python*\n# pip install pip --upgrade\n# pip install docker-composer\n\n\n\n3-2. docker-compose version\u3067\u52d5\u4f5c\u78ba\u8a8d\u6642\u306b\u30a8\u30e9\u30fc\u304c\u8868\u793a\u3055\u308c\u305f\u3002\nPython\u306eOpenSSL\u95a2\u9023\u30d1\u30c3\u30b1\u30fc\u30b8\u306e\u4e00\u90e8\u304c\u53e4\u304f\u3001\u4f9d\u5b58\u95a2\u4fc2\u3067\u30a8\u30e9\u30fc\u304c\u767a\u751f\u3057\u3066\u3044\u307e\u3057\u305f\u3002\n\n\u30a8\u30e9\u30fc\u304c\u767a\u751f\n# docker-compose version\nTraceback (most recent call last):\n  File \"/usr/bin/docker-compose\", line 5, in <module>\n    from pkg_resources import load_entry_point\n  File \"/usr/lib/python2.7/site-packages/pkg_resources.py\", line 3011, in <module>\n    parse_requirements(__requires__), Environment()\n  File \"/usr/lib/python2.7/site-packages/pkg_resources.py\", line 626, in resolve\n    raise DistributionNotFound(req)\npkg_resources.DistributionNotFound: backports.ssl-match-hostname>=3.5\n\n\n\u53e4\u3044ssl\u95a2\u9023\u30d1\u30c3\u30b1\u30fc\u30b8\u306e\u30a2\u30c3\u30d7\u30c7\u30fc\u30c8\u3092\u884c\u3044\u307e\u3059\u3002\n\n\u30b3\u30de\u30f3\u30c9\n# pip install backports.ssl_match_hostname --upgrade\n\n\n\u518d\u5ea6\u52d5\u4f5c\u78ba\u8a8d\n\n\u30b3\u30de\u30f3\u30c9\n# docker-compose version\ndocker-compose version 1.9.0, build 2585387\ndocker-py version: 1.10.6\nCPython version: 2.7.5\nOpenSSL version: OpenSSL 1.0.1e-fips 11 Feb 2013\n\n\n\u3053\u308c\u3067docker-compose\u3082\u30a8\u30e9\u30fc\u7121\u304f\u5b9f\u884c\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3057\u305f\u3002\n\n3-3. docker \u30d1\u30c3\u30b1\u30fc\u30b8\u3092bluemix\u3078\u3064\u306a\u3052\u308b\ndocker push / pull\u3092\u306f\u3058\u3081\u3001docker\u30b3\u30de\u30f3\u30c9\u3092bluemix\u5074\u3078\u547d\u4ee4\u3059\u308b\u969b\u306b\u3001\nbluemix\u5074\u306e\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u8a3c\u660e\u3068\u30c8\u30fc\u30af\u30f3\u304c\u5fc5\u8981\u306b\u306a\u308a\u307e\u3059\u3002\n\n3-3-1. bluemix cli \u3067IBM-Containers \u3092\u521d\u671f\u5316(init)\nIBM-Containers\u306e\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u306e\u591a\u304f\u306f\u3001\ncf ic init\u3068\u3001Cloud Foundry\u306e\u30b3\u30de\u30f3\u30c9\u3067\u8a3c\u660e\u66f8\u3068\u30c8\u30fc\u30af\u30f3\u306e\u53d7\u3051\u6e21\u3057\u3092\u3057\u3066\u3044\u305f\u3088\u3046\u3067\u3059\u304c\u3001\n\u6700\u65b0\u306ebluemix cli\u30b3\u30de\u30f3\u30c9\u3067\u30ef\u30f3\u30b9\u30c8\u30c3\u30d7\u3067\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u3063\u305f\u3088\u3046\u3067\u3059\u3002\n\nbash\n# bluemix ic init\n\u53e4\u3044\u69cb\u6210\u30d5\u30a1\u30a4\u30eb\u3092\u524a\u9664\u4e2d\u3067\u3059...\nIBM Containers \u306e\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u8a3c\u660e\u66f8\u3092\u751f\u6210\u4e2d\u3067\u3059...\n\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u8a3c\u660e\u66f8\u3092 /root/.ice/certs/ \u306b\u683c\u7d0d\u4e2d\u3067\u3059...\n\n\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u8a3c\u660e\u66f8\u3092 /root/.ice/certs/containers-api.ng.bluemix.net/e0980f9c-7f60-4085-821f-43b2246cb071 \u306b\u683c\u7d0d\u4e2d\u3067\u3059...\n\nOK\n\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u8a3c\u660e\u66f8\u304c\u53d6\u5f97\u3055\u308c\u307e\u3057\u305f\u3002\n\n\u30ed\u30fc\u30ab\u30eb\u306e Docker \u69cb\u6210\u3092\u78ba\u8a8d\u4e2d\u3067\u3059...\nOK\n\n\u30db\u30b9\u30c8\u540d registry.ng.bluemix.net \u306e\u30ec\u30b8\u30b9\u30c8\u30ea\u30fc\u3067\u8a8d\u8a3c\u4e2d\nOK\n\u30b3\u30f3\u30c6\u30ca\u30fc\u306f IBM Containers \u30ec\u30b8\u30b9\u30c8\u30ea\u30fc\u3067\u8a8d\u8a3c\u3055\u308c\u307e\u3057\u305f\u3002\n\u30d7\u30e9\u30a4\u30d9\u30fc\u30c8 Bluemix \u30ea\u30dd\u30b8\u30c8\u30ea\u30fc\u306f URL registry.ng.bluemix.net/{\u30b9\u30da\u30fc\u30b9\u540d} \u3067\u3059\u3002\n\uff5e\u4ee5\u4e0b\u7565\uff5e\n\n\n\n4. docker image\u3092\u4f5c\u308b\u6e96\u5099\ndocker-compose\u3092\u3059\u308b\u305f\u3081\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u968e\u5c64\u3092\u4f5c\u308a\u307e\u3057\u305f\u3002\n\ntree\neccube\n|-- cent7eccube3\n|   `-- Dockerfile\n`-- docker-compose.yml\n\n\n\n4-1. docker-compose\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u308b\u3002\ndocker\u306e\u307f\u3067\u30d3\u30eb\u30c9\u3067\u304d\u3066\u3057\u307e\u3046\u306e\u3067\u3001\u3044\u3089\u306a\u3044\u304b\u306a\u3001\u3068\u601d\u3044\u3064\u3064\u3002\n\u30ed\u30fc\u30ab\u30eb\u691c\u8a3c\u3059\u308b\u3053\u3068\u3082\u3042\u308d\u3046\u304b\u3068\u3001\u3068\u3044\u3046\u3053\u3068\u3067docker-compose\u3092\u304a\u7d04\u675f\u3067\u4f5c\u308a\u307e\u3059\u3002\n\ndocker-compose.yml\ncent7eccube3:\n  build: cent7eccube3/\n  ports:\n    - 8080:80\n  privileged: true\n\n\n\n4-2. Dockerfile\n\nsystemd\u3092\u4f7f\u308f\u306a\u3044\u7406\u7531\n\u3053\u3053\u3067\u306f\u3001privileged\u3092\u4f7f\u308f\u306a\u3044\u306e\u3067\u3001systemd \u4f7f\u308f\u305a\u3001httpd\u3082\u30d5\u30a9\u30a2\u30b0\u30e9\u30a6\u30f3\u30c9\u3067\u52d5\u304f\u3088\u3046\u306b\u3057\u307e\u3057\u305f\u3002\n\u4ed6\u306eCaaS\u3078\u306e\u9020\u5f62\u306f\u3042\u307e\u308a\u306a\u3044\u306e\u3067\u3059\u304cIBM Containers\u3067\u306f\u5171\u7528\u74b0\u5883\u3067\u3042\u308b\u3053\u3068\u3092\u7406\u7531\u306bUID:0\u306eroot\u6a29\u9650\u3092\u9069\u7528\u3067\u304d\u307e\u305b\u3093\u3002\n\u8003\u3048\u3066\u307f\u308c\u3070\u3001UID:0\u306e\u547d\u4ee4\u30bb\u30c3\u30c8\u304c\u4ed5\u3048\u308b\u3068\u3044\u3046\u3053\u3068\u306f\u3001\u4ed6\u4eba\u306e\u30b3\u30f3\u30c6\u30ca\u306b\u3082\u51fa\u5165\u308a\u3067\u304d\u3066\u3057\u307e\u3046\u306e\u3067\u3001\n\u5f53\u7136\u3068\u3044\u3048\u3070\u5f53\u7136\u3067\u3059\u306d\u3002\u3002\u3002\n\u307e\u3060\u307e\u3060\u306a\u308c\u306a\u3044\u306e\u3067\u3001\u3082\u3063\u3068\u304d\u308c\u3044\u306a\u66f8\u304d\u65b9\u304c\u3042\u308b\u306e\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u3002\n\nDockerfile\n#centos7\u306e\u30a4\u30e1\u30fc\u30b8\u3092\u53d6\u5f97\nFROM centos:centos7\n\n#Dockerfile\u4f5c\u6210\u8005\nMAINTAINER Pumpkin Heads Co.,Ltd. Shoichiro Sakaigawa sakaigawa@pumpkinheds.jp\n\n#\u30bf\u30a4\u30e0\u30be\u30fc\u30f3\u306e\u8a2d\u5b9a\nRUN /bin/cp /usr/share/zoneinfo/Asia/Tokyo /etc/localtime\n\n#yum\u306b\u3088\u308b\u5fc5\u8981\u30d1\u30c3\u30b1\u30fc\u30b8\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\nRUN yum -y install httpd mod_ssl unzip\n\n#yum\u30ea\u30dd\u30b8\u30c8\u30ea\u306e\u8ffd\u52a0\nRUN yum -y localinstall http://ftp.iij.ad.jp/pub/linux/fedora/epel/epel-release-latest-7.noarch.rpm\nRUN yum -y localinstall http://rpms.famillecollet.com/enterprise/remi-release-7.rpm\n\n#yum\u306b\u3088\u308bphp7.0\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\nRUN yum install -y --enablerepo=remi --enablerepo=remi-php70 php php-common php-mbstring php-gd php-xml php-xmlrpc php-devel php-cli php-pdo php-mysql php-odbc php-pear php-mcrypt php-pecl-apc\n\n#tmp\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u79fb\u52d5\nWORKDIR /tmp/\n\n#EC-CUBE\u30d5\u30a1\u30a4\u30eb\u306e\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\nADD http://downloads.ec-cube.net/src/eccube-3.0.12-p1.zip eccube-3.0.12-p1.zip\n\n#\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3057\u305feccube\u30d5\u30a1\u30a4\u30eb\u306e\u89e3\u51cd\nRUN unzip eccube-3.0.12-p1.zip\n\n#\u4e0d\u8981\u30d5\u30a1\u30a4\u30eb\u306e\u524a\u9664\nRUN rm -f ./eccube-3.0.12-p1.zip\n\n#eccube\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306e\u30ea\u30cd\u30fc\u30e0\nRUN mv eccube-3.0.12-p1 eccube\n\n#eccube\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306e\u30ea\u30cd\u30fc\u30e0\nRUN mv eccube /var/www/html\n\n#eccube\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306e\u6a29\u9650\u5909\u66f4\nRUN chown -R apache:apache /var/www/html/eccube\n\n#httpd.conf\u306e\u5909\u66f4\nRUN sed -i -e 's#DocumentRoot \"/var/www/html\"#DocumentRoot \"/var/www/html/eccube/html\"#g' -e 's#<Directory \"/var/www/html\">#<Directory /var/www/html/eccube/html\">#g' -e 's#AllowOverride None#AllowOverride All#g' /etc/httpd/conf/httpd.conf\n\n#\u516c\u958b\u30dd\u30fc\u30c8\nEXPOSE 80 443\n\n#httpd\u306e\u5b9f\u884c\nCMD [\"httpd\", \"-D\", \"FOREGROUND\"]\n\n\n\n5.\u30ed\u30fc\u30ab\u30eb\u3067\u306eDocker\u30d3\u30eb\u30c9\u3068\u3001Docker\u30a4\u30e1\u30fc\u30b8\u306ebluemix registry\u3078\u300cPush\nbluemix registry\u306f\u3001\u3044\u308f\u3070bluemix\u5185\u90e8\u7528\u306edocker-registry\u76f8\u5f53\u306e\u4f4d\u7f6e\u4ed8\u3051\u3067\u3059\u3002\ndockerhub\u3078push\u3057\u305f\u81ea\u5206\u306e\u30b3\u30f3\u30c6\u30ca\u30a4\u30e1\u30fc\u30b8\u3092bluemix\u3078\u30a4\u30f3\u30dd\u30fc\u30c8\u3059\u308b\u65b9\u6cd5\u3082\u3042\u308b\u3088\u3046\u306a\u306e\u3067\u3059\u304c\u3001\n\u4eca\u56de\u306f\u30ed\u30fc\u30ab\u30eb\u3067\u30d3\u30eb\u30c9\u3057\u305f\u30a4\u30e1\u30fc\u30b8\u3092\u76f4\u63a5bluemix registry\u306bPush\u3057\u3066\u307f\u307e\u3059\u3002\n\n5-1. dockerfile\u306e\u30d3\u30eb\u30c9\n\nbuild\n# docker-compose build\n\n\n\n5-2. DockerImage\u306e\u8d77\u52d5\u78ba\u8a8d\n\u52d5\u4f5c\u30c1\u30a7\u30c3\u30af\u3057\u3066\u3001State \"Up\"\u3068\u306a\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\n\n\u52d5\u4f5c\u30c1\u30a7\u30c3\u30af\n# docker-compose up -d\n# docker-compose ps\n        Name                  Command         State               Ports\n-----------------------------------------------------------------------------------\neccube_cent7eccube3_1   httpd -D FOREGROUND   Up      443/tcp, 0.0.0.0:8080->80/tcp\n\n\n\n5-3. \u30ed\u30fc\u30ab\u30eb\u4e0a\u306eDockerImage\u3092bluemix registry\u7528\u306b\u30bf\u30b0\u4ed8\u3051\n\nbash\n# docker tag eccube_cent7eccube3:latest registry.ng.bluemix.net/pumpkinheads/cent7eccube3\n\n\n\n5-4. bluemix registry\u3078\u306epush\n\nbash\n# docker push registry.ng.bluemix.net/pumpkinheads/cent7eccube3\n\n\n\n6. IBM Containers\u3067\u5b9f\u969b\u306b\u30b3\u30f3\u30c6\u30ca\u306e\u30c7\u30d7\u30ed\u30a4\u3092\u3057\u3066\u307f\u3088\u3046\n\n6-1. bluemix registry\u3078Push\u3055\u308c\u305f\u30b3\u30f3\u30c6\u30ca\u30a4\u30e1\u30fc\u30b8\u306e\u78ba\u8a8d\n\u3053\u3053\u3067bluemix\u30b3\u30f3\u30bd\u30fc\u30eb\u306e\u30ab\u30bf\u30ed\u30b0\u2192\u30b3\u30f3\u30c6\u30ca\u3092\u8868\u793a\u3059\u308b\u3068\u3001\n\u5148\u7a0bPush\u3057\u305f\u30b3\u30f3\u30c6\u30ca\u304c\u8868\u793a\u3055\u308c\u307e\u3059\u3002\n\n\n6-2. \u30c7\u30d6\u30ed\u30a4\u60c5\u5831\u306e\u5165\u529b\n\u30af\u30ea\u30c3\u30af\u5f8c\u3001\u30c7\u30d7\u30ed\u30a4\u60c5\u5831\u306e\u753b\u9762\u304c\u8868\u793a\u3055\u308c\u307e\u3059\u3002\n\n\u304a\u8a66\u3057\u306e\u305f\u3081\u3001PublicIP\u3092\u3064\u3051\u3066\u3001\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306e\u30b5\u30a4\u30ba\u306f\u30de\u30a4\u30af\u30ed\u3067\u5b9f\u884c\u3057\u3066\u307f\u307e\u3057\u3087\u3046\u3002\u300c\u4f5c\u6210\u300d\u3092\u30af\u30ea\u30c3\u30af\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n6-3. \u30d3\u30eb\u30c9\u958b\u59cb\n\u30d3\u30eb\u30c9\u304c\u59cb\u307e\u308a\u307e\u3057\u305f\u3002\n\u30b3\u30fc\u30d2\u30fc\u3067\u3082\u4e00\u676f\u5165\u308c\u306a\u304c\u3089\u5f85\u3061\u307e\u3057\u3087\u3046\u3002\n\n\n6-4. \u30d3\u30eb\u30c9\u5b8c\u4e86\n\u30b3\u30f3\u30c6\u30ca\u306e\u8a73\u7d30\u306b\u30d1\u30d7\u30ea\u30c3\u30afIP\u304c\u8868\u793a\u3055\u308c\u307e\u3057\u305f\u3002\n\u3053\u306eIP\u30a2\u30c9\u30ec\u30b9\u3078\u30d6\u30e9\u30a6\u30b6\u304b\u3089\u30a2\u30af\u30bb\u30b9\u3057\u3066\u307f\u307e\u3057\u3087\u3046\n\n\n7. EC-CUBE\u306e\u521d\u671f\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\n\n7-1.EC-CUBE\u30a6\u30a3\u30b6\u30fc\u30c9\u901a\u308a\u306b\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\n\nStep1: \u3088\u3046\u3053\u305d\n\u6b21\u3078\u9032\u3080\u3092\u30af\u30ea\u30c3\u30af\n\nStep2: \u6a29\u9650\u30c1\u30a7\u30c3\u30af\n\u3053\u3053\u3082\u30a8\u30e9\u30fc\u306a\u304f\u3001\u6b21\u3078\u9032\u3080\u3092\u30af\u30ea\u30c3\u30af\n\nStep3: \u30b5\u30a4\u30c8\u306e\u8a2d\u5b9a\n\n\n\n1\n2\n\n\n\n\n\u5e97\u540d\n\u30c6\u30b9\u30c8\u5546\u5e97\n\n\n\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\n\u81ea\u5206\u306e\u30a2\u30c9\u30ec\u30b9\n\n\n\u7ba1\u7406\u753b\u9762\u30ed\u30b0\u30a4\u30f3ID\ntestadmin\n\n\n\u7ba1\u7406\u8005\u30d1\u30b9\u30ef\u30fc\u30c9\n\u3072\u307f\u3064\n\n\n\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u8a2d\u5b9a\n\u7ba1\u7406\u753b\u9762\u306eURL\u30d5\u30a9\u30eb\u30c0\u540d\u3002\u3072\u307f\u3064\n\n\n\u30b5\u30a4\u30c8\u3078\u306e\u30a2\u30af\u30bb\u30b9\u3092SSL(https)\u7d4c\u7531\u306b\u5236\u9650\u3057\u307e\u3059\n\u30c1\u30a7\u30c3\u30af\u3057\u306a\u3044x\n\n\n\nhttps\u8a2d\u5b9a\u306f\u4eca\u56de\u306e\u30b3\u30f3\u30c6\u30ca\u3067https\u8a2d\u5b9a\u3092\u307e\u3060\u5165\u308c\u3066\u3044\u306a\u3044\u306e\u3067\u3002\n\n\n\u7ba1\u7406\u753b\u9762\u30a2\u30af\u30bb\u30b9\u5143IP\u5236\u9650\n\u81ea\u5206\u306eIP\u3092\u8abf\u3079\u308b\u5834\u5408\u306fifconfig.me\u306a\u3069\u3067\u78ba\u8a8d\u3057\u3066\u3044\u308c\u3066\u304f\u3060\u3055\u3044\n\n\n\n\u30aa\u30d7\u30b7\u30e7\u30f3\u5185\u306fSMTP\u5468\u308a\u3002\nBluxmix \u30a4\u30f3\u30d5\u30e9\u30b9\u30c8\u30e9\u30af\u30c1\u30e3\u306eE-MailDelivery Service\u306b\u3001Sendgrid\u4f7f\u3046\u65b9\u6cd5\u304c\u3042\u308b\u306e\u3067\n\u8a2d\u5b9a\u3057\u3066\u3082\u3044\u3044\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u3002(rev0.5\u3042\u305f\u308a\u3067\u8a66\u3059\uff1f\uff09\n\u8a18\u5165\u5f8c\u3001\u6b21\u3078\u9032\u3080\u3092\u30af\u30ea\u30c3\u30af\n\nStep4: \u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u8a2d\u5b9a\uff08\u3053\u3053\u304c\u904b\u547d\u306e\u5206\u304b\u308c\u9053\uff1f\uff01\uff09\n\u30c9\u30ad\u30c9\u30ad\u3057\u306a\u304c\u3089\u66f8\u3044\u3066\u307e\u3057\u305f\u304c\u3001\u5148\u306b\u30cd\u30bf\u30d0\u30ec\u3059\u308b\u3068\u3001Step5\u3067\u4eca\u5931\u6557\u3057\u307e\u3057\u305f\u3002\n\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306e\u7a2e\u985e\u3067\u3001\u672c\u756a\u904b\u7528\u306f\u300cMySQL\u300d\u3092\u304a\u3059\u3059\u3081\u3057\u307e\u3059\u304c\u3001\nEC-CUBE3 \u3067\u306fSQLite\u3082\u9078\u3079\u308b\u306e\u3067\u3001\u5358\u7d14\u306b\u8a66\u3057\u305f\u308a\u958b\u767a\u3059\u308b\u3060\u3051\u306a\u3089\u3070SQLite(\u958b\u767a\u7528\uff09\u3092\u304a\u3059\u3059\u3081\u3057\u307e\u3059\u3002\n\u8a18\u5165\u5f8c\u3001\u6b21\u3078\u9032\u3080\u3092\u30af\u30ea\u30c3\u30af\n\n\u5931\u6557\u3057\u306a\u3044\u30d1\u30bf\u30fc\u30f3\n\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306e\u7a2e\u985e\uff1a\u3000SQLite(\u958b\u767a\u7528)\n\u6b21\u3078\u9032\u3080\u3092\u30af\u30ea\u30c3\u30af\n\nStep5: (SQLite)\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u521d\u671f\u5316\n\u6b21\u3078\u9032\u3080\u3092\u30af\u30ea\u30c3\u30af\n\nStep6: (SQLite)\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u5b8c\u4e86\n\u7ba1\u7406\u753b\u9762\u3092\u8868\u793a\u3000\u3092\u30af\u30ea\u30c3\u30af\n\n\u4e00\u822c\u30da\u30fc\u30b8\u306b\u30a2\u30af\u30bb\u30b9\u3057\u3066\u307f\u308b\n\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u3082EC-CUBE2\u304b\u3089\u968f\u5206\u3068\u30a2\u30c3\u30d7\u30c7\u30fc\u30c8\u304c\u3042\u308a\u307e\u3057\u305f\u3002\n\u3053\u308c\u304b\u3089\u3044\u308d\u3044\u308d\u8a66\u3057\u3066\u307f\u305f\u3044\u3068\u601d\u3044\u307e\u3059\u3002\n\n\n\u5931\u6557\u3057\u305f\u30d1\u30bf\u30fc\u30f3\n\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306e\u7a2e\u985e\uff1a MySQL\n\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306e\u30db\u30b9\u30c8\u540d\uff1a ClearDB\u306e\u300cCluster Gateway Information\u306b\u3042\u308bHostname\u300d\n\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u540d\uff1a\u3000ClearDB\u306e\u300cDashboard\u306b\u3042\u308bName\u300d\n\u30e6\u30fc\u30b6\u540d\uff1aClearDB\u306e\u300cAccess Credentials\u306eUsername\u300d\n\u30d1\u30b9\u30ef\u30fc\u30c9\uff1aClearDB\u306e\u300cAccess Credentials\u306ePassword\u300d\n\nStep:5 \u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u521d\u671f\u5316 -> \u76db\u5927\u306b\u30a8\u30e9\u30fc\n\uff15\u5206\u4f4d\u3067\u4ee5\u4e0b\u30a8\u30e9\u30fc\u306b\u906d\u9047\u3002clearDB FREE\u7248\u306a\u306e\u304c\u539f\u56e0\u304b\u3082\u3057\u308c\u306a\u3044\u3002\n\n\u30a8\u30e9\u30fc\nPDOException in Connection.php line 1176:\nSQLSTATE[HY000]: General error: 2006 MySQL server has gone away\n\n\nrev0.1\u3067\u306e\u6b8b\u8ab2\u984c:\n\u30fb\u307e\u3060\u307e\u3060\u9014\u4e2d\u3067\u3059\u3088\n\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306e\u30c7\u30d7\u30ed\u30a4\u3067\u4e00\u5ea6\u4f11\u61a9\u3002\n\u5b8c\u8d70\u3092\u3081\u3056\u3059\u3002\nrev0.2\u3067\u306e\u6b8b\u8ab2\u984c:\n\u30fbMySQL\u30ea\u30d9\u30f3\u30b8\nMySQL\u3067\u30a8\u30e9\u30fc\u3068\u306a\u3063\u3066\u7d42\u308f\u308b\u3002SQLite\u3067\u51cc\u3050\u304c\u3001\u6094\u3057\u3044\u3002\n\u30fb\u9805\u756a\u3001\u8868\u8a18\u3086\u3089\u304e\u3092\u4fee\u6b63\u3001\u53e3\u8a9e\u3092\u3078\u3089\u3059\nrev0.3\u3067\u306e\u6b8b\u8ab2\u984c\uff1a\n0.2\u304b\u3089\u5909\u308f\u3089\u305a\u3002\n#IBM Containers\u3067OSS\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u52d5\u304b\u3057\u3066\u307f\u308b\u3002\n\n\u3053\u306e\u8a18\u4e8b\u306f\u3001teratail Bluemix\u30a2\u30c9\u30d9\u30f3\u30c8\u30ab\u30ec\u30f3\u30c0\u30fc\u306e12/10\u5206\u306e\u8a18\u4e8b\u3067\u3059\u3002\n12/3\u306eikuwow\u3055\u3093\u306e\u8a18\u4e8b\u3068\u88ab\u308b\u7b87\u6240\u3070\u304b\u308a\u3067\u3059\u304c\u30fb\u30fb\u30fb\n\uff08\u3059\u3044\u307e\u305b\u3093\u3001\u4e88\u7d04\u6642\u306bcontainer\u306a\u304b\u3063\u305f\u306e\u3067\u66f8\u3044\u3066\u305f\u306e\u3067\u3059\u304c\u30fb\u30fb\u30fb\u4eca\u65e5\u6295\u7a3f\u3057\u3066\u307f\u305f\u3089\u5148\u306bcontainer\u30cd\u30bf\u3067\u66f8\u3044\u3066\u304a\u3089\u308c\u305f\u3088\u3046\u3067\u3057\u305f\u3002\uff09\n\n\u4eca\u56de\u306e\u8a18\u4e8b\u306fContainer+EC-CUBE3\u3060\u3068\u3053\u3093\u306a\u611f\u3058\u3067\u3059\u3088\u3002\u3068\u3044\u3046\u4f4d\u7f6e\u3065\u3051\u3067\u5fa1\u89a7\u304f\u3060\u3055\u3044\u3002\n\nDocker\u74b0\u5883\u3068\u3057\u3066IBM bluemix\u306e\u30e9\u30a4\u30f3\u30ca\u30c3\u30d7\u306e\u4e00\u3064\u3067\u3042\u308bIBM Containers\u3092\u5229\u7528\u3057\u3066Docker\u30b3\u30f3\u30c6\u30ca\u3092\u52d5\u4f5c\u3055\u305b\u307e\u3059\u3002\n\nEC-CUBE\u306b\u306fMySQL\u304c\u5fc5\u8981\u3067\u3059\u304c\u3001Bluemix\u5074\u306bMySQL\u306e\u30b5\u30fc\u30d3\u30b9\u304c\u3042\u308b\u306e\u3067\u4eca\u56de\u306f\u305d\u3061\u3089\u3092\u5229\u7528\u3057\u307e\u3059\u3002\nsystemd\u3092\u5229\u7528\u3057\u3066\u30b3\u30f3\u30c6\u30ca\u5185\u306bMySQL\u3092\u7acb\u3066\u308b\u3053\u3068\u3082\u8003\u3048\u305f\u306e\u3067\u3059\u304c\u3001docker privileged\u304c\u6307\u5b9a\u3067\u304d\u306a\u3044\u305f\u3081\u4eca\u56de\u306f\u4f7f\u7528\u3057\u307e\u305b\u3093\u3002\n\n\u203brev0.2\u8ffd\u8a18\uff1a\u3000MySQL\u3067\u306e\u521d\u671f\u30c7\u30fc\u30bf\u6295\u5165\u3067\u5931\u6557\u3067\u3059\u3002\u539f\u56e0\u8abf\u67fb\u5f8c\u518d\u6311\u6226\u3002\n[Bluemix\u3067ClearDB MySQL Database\u3092\u4f7f\u3063\u3066\u307f\u305f](http://qiita.com/ssakaigawa/items/e688a4437f7b44c793a0)\n\n## \u4e8b\u524d\u30d1\u30c3\u30b1\u30fc\u30b8\u306e\u5c0e\u5165\nCentOS7-1511(7.2) Minimal\u306aVM\u3092Bluemix Infrastracture\u306eBMS vmware\u4e0a\u306bVM\u3092\u69cb\u7bc9\u3057\u307e\u3057\u305f\u3002\n\n\u4ee5\u4e0b\u306f\u304a\u7d04\u675f\u3067\u5165\u308c\u3066\u3044\u308b\u9053\u5177\u9054\u3067\u3059\u3002\nbind-utils\u306fdig/nslookup\u304c\u5165\u3063\u3066\u304a\u308a\u3001net-tools\u306ftracert\u306a\u3069\u306elegacy\u306a\u30c4\u30fc\u30eb\u90e1\nopen-vm-tools\u306fVMwareTools\u3092\u30b3\u30f3\u30d1\u30a4\u30eb\u305b\u305a\u306b\u5c0e\u5165\u3067\u304d\u308b\u3053\u3068\u304b\u3089\u91cd\u5b9d\u3057\u3066\u3044\u307e\u3059\u3002\n\n```lang:\u30b3\u30de\u30f3\u30c9\n# yum install -y wget bind-utils net-tools open-vm-tools bzip2 unzip\n```\n\n\u4eca\u56de\u306fdocker+docker-compose\u3082\u4f75\u305b\u3066\u5c0e\u5165\u3057\u305f\u70ba\u3001epel,python pip\u30b3\u30de\u30f3\u30c9\u3092\u5c0e\u5165\u3057\u307e\u3057\u305f\u3002\npip\u30b3\u30de\u30f3\u30c9\u3067\u5ff5\u306e\u305f\u3081\u5468\u8fba\u30c4\u30fc\u30eb\u3082\u4f75\u305b\u3066\u30a2\u30c3\u30d7\u30b0\u30ec\u30fc\u30c9\u3057\u3066\u304a\u304d\u307e\u3057\u3087\u3046\u3002\n\n```lang:\u30b3\u30de\u30f3\u30c9\n# yum install -y epel-release\n# yum install -y python-pip\n# pip install pip --upgrade\n```\n\n## 1. docker build\u74b0\u5883\u3092\u69cb\u7bc9\u3059\u308b\n### 1-1. docker \u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\ndocker \u30d1\u30c3\u30b1\u30fc\u30b8\u306e\u5c0e\u5165\u3092\u3057\u307e\u3059\u3002\n\n```lang:bash\n# yum -y install docker\n```\n\n### 1-2. docker\u30b5\u30fc\u30d3\u30b9\u306e\u81ea\u52d5\u8d77\u52d5\u8a2d\u5b9a/\u8d77\u52d5\ndocker \u30b5\u30fc\u30d3\u30b9\u306e\u81ea\u52d5\u8d77\u52d5\u8a2d\u5b9a\u3068\u8d77\u52d5\u3092\u3057\u307e\u3059\u3002\n\n```lang:\u30b3\u30de\u30f3\u30c9\n# systemctl enable docker.service\n# systemctl start docker.service\n```\n\n## 2. Bluemix CLI\u3092\u59cb\u3081\u3068\u3057\u305fBluemix\u95a2\u9023\u30c4\u30fc\u30eb\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\nBluemix CLI\u3092\u5c0e\u5165\u3057\u307e\u3059\u3002\n\u3053\u306e\u30c4\u30fc\u30eb\u3067\u306fBluemix API\u3068CloudFoundry API\u3092\u5229\u7528\u3057\u3066\nBluemix\u4e0a\u306e\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u5236\u5fa1\u304c\u53ef\u80fd\u3067\u3059\u304c\u3001\n\u4eca\u56de\u306fdocker build\u3057\u305f\u30a4\u30e1\u30fc\u30b8\u3092bluemix registry\u306bpush\u3059\u308b\u3053\u3068\u3092\u76ee\u7684\u3068\u3057\u3066\u5c0e\u5165\u3057\u307e\u3059\u3002\n\n### 2-1. CloudFoundry CLI\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\n#### 2-1-1. CloudFoundry CLI\u30d1\u30c3\u30b1\u30fc\u30b8\u306e\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\nhttps://github.com/cloudfoundry/cli/releases\n\u304b\u3089\u6700\u65b0\u7248\u306e\u300cRedhat Linux 64bit\u300d\u306eURL\u3092\u30b3\u30d4\u30fc\u3057\u3066wget\u3057\u307e\u3059\u3002\nURL\u306b&\u8a18\u53f7\u306a\u3069\u304c\u5165\u3063\u3066\u3044\u308b\u306e\u3067\u30c0\u30d6\u30eb\u30af\u30a6\u30a9\u30fc\u30c8\u4ed8\u304d\u3001-O\u3067\u30d5\u30a1\u30a4\u30eb\u540d\u6307\u5b9a\u3092\u3057\u3066\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3092\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\u4ee5\u4e0b\u3092\u53c2\u8003\u306b\u5b9f\u884c\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\uff08\u30d0\u30fc\u30b8\u30e7\u30f3\u306f\u57f7\u7b46\u6642\u70b9\uff09\n\n```lang:\u30b3\u30de\u30f3\u30c9\n# wget \"https://cli.run.pivotal.io/stable?release=redhat64&version=6.22.2&source=github-rel\" -O cf-cli-installer_6.22.2_x86-64.rpm\n```\n#### 2-1-2. CloudFoundry CLI\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n```lang:\u30b3\u30de\u30f3\u30c9\n# yum install -y cf-cli-installer_6.22.2_x86-64.rpm\n```\n### 2-2. Bluxmix CLI\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\n#### 2-2-1. Bluxmix CLI\u30d1\u30c3\u30b1\u30fc\u30b8\u306e\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\nhttp://clis.ng.bluemix.net/ui/home.html\n\u304b\u3089\u300c\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9Linux(64-bit\u7528)\u300d\u3092\u53d6\u5f97\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\uff08\u30d0\u30fc\u30b8\u30e7\u30f3\u306f\u57f7\u7b46\u6642\u70b9\uff09\n\n```lang-bash\n# wget http://public.dhe.ibm.com/cloud/bluemix/cli/bluemix-cli/Bluemix_CLI_0.4.4_amd64.tar.gz\n# tar xzf Bluemix_CLI_0.4.4_amd64.tar.gz\n# cd Bluemix_CLI\n```\n\n#### 2-2-2. Bluemix CLI\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n```lang:\u30b3\u30de\u30f3\u30c9\n# ./install_bluemix_cli\nThe Cloud Foundry CLI was not found on your system. Install CLI from https://github.com/cloudfoundry/cli/releases before you install the Bluemix CLI.\nCopying files ...\nThe Bluemix Command Line Interface (Bluemix CLI) is installed successfully.\nTo get started, open a new Linux terminal and enter \"bluemix help\", or enter \"bx help\" as short name.\n\nWith Bluemix CLI 0.4.0 or later, the CLI can automatically collect diagnostic and usage information and send it to Bluemix for analysis.\nThis information will help us better understand current client usage and plan for future use. No personally identifiable data is collected.\n\nTo stop collecting information, you can run the following command:\n        'bluemix config --usage-stats-collect false'\n```\n\n###\u30002-3. Bluxmix plugins \u306e\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\nBluemix CLI + IBM Containers Plugin\u306e\u7d44\u307f\u5408\u308f\u305b\u3067\u521d\u3081\u3066IBM Containers\u306e\u5236\u5fa1\u304c\u53ef\u80fd\u3068\u306a\u308a\u307e\u3059\u3002\n\n#### 2-3-1. Bluemix CLI \u3067\u30ec\u30dd\u30b8\u30c8\u30ea\u304b\u3089\u30d7\u30e9\u30b0\u30a4\u30f3\u60c5\u5831\u306e\u53d6\u5f97\n\u6700\u4e0b\u90e8\u306bIBM Containers\u3000Plugin\u304c\u8868\u793a\u3055\u308c\u307e\u3057\u305f\u3002\u4ed6\u306b\u3082bluemix\u3067\u5229\u7528\u3067\u304d\u308b\u30b5\u30fc\u30d3\u30b9\u306f\u3053\u3053\u3067\u30d7\u30e9\u30b0\u30a4\u30f3\u3092\u8ffd\u52a0\u3059\u308b\u3053\u3068\u3067\u64cd\u4f5c\u304c\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\n\n```lang-bash\n# bluemix plugin repo-plugins -r Bluemix\n\u30ea\u30dd\u30b8\u30c8\u30ea\u30fc 'Bluemix' \u304b\u3089\u30d7\u30e9\u30b0\u30a4\u30f3\u3092\u53d6\u5f97\u3057\u3066\u3044\u307e\u3059...\n\n\u30ea\u30dd\u30b8\u30c8\u30ea\u30fc: Bluemix\n\u540d\u524d                      \u8aac\u660e                                                                                                                                                         \u30d0\u30fc\u30b8\u30e7\u30f3\n\uff5e\u4e2d\u7565\uff5e\nIBM-Containers            Plugin to operate IBM Containers service                                                                                                                     1.0.0\n```\n#### 2-3-2. IBM-Containers plugin\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\u5b9f\u969b\u306b\u30d7\u30e9\u30b0\u30a4\u30f3\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3092\u3057\u307e\u3057\u3087\u3046\u3002\n\n```lang-bash\n# bluemix plugin install IBM-Containers -r Bluemix\n\u30ea\u30dd\u30b8\u30c8\u30ea\u30fc 'Bluemix' \u304b\u3089 'IBM-Containers' \u3092\u691c\u7d22\u3057\u3066\u3044\u307e\u3059...\n\u30d0\u30a4\u30ca\u30ea\u30fc\u30fb\u30d5\u30a1\u30a4\u30eb\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3057\u3088\u3046\u3068\u3057\u3066\u3044\u307e\u3059...\n10219972 \u30d0\u30a4\u30c8\u304c\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3055\u308c\u307e\u3057\u305f\n\u30d0\u30a4\u30ca\u30ea\u30fc\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u3066\u3044\u307e\u3059...\nOK\n\u30d7\u30e9\u30b0\u30a4\u30f3 'IBM-Containers 1.0.0' \u306f /root/.bluemix/plugins/IBM-Containers \u306b\u6b63\u5e38\u306b\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u307e\u3057\u305f\u3002\n```\n\n#### 2-3-3. Bluemix CLI\u3067\u306e\u30ed\u30b0\u30a4\u30f3\u78ba\u8a8d\n\u30ed\u30b0\u30a4\u30f3\u7528\u306e\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3059\u308b\u3068\u3001Email\u3001\u30d1\u30b9\u30ef\u30fc\u30c9\u3092\u6c42\u3081\u3089\u308c\u307e\u3059\u3002\nBluemix\u306e\u30b3\u30f3\u30bd\u30fc\u30eb\u306b\u30ed\u30b0\u30a4\u30f3\u3059\u308b\u969b\u306b\u4f7f\u7528\u3059\u308bIBM ID/Password\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\u30ed\u30b0\u30a4\u30f3\u5f8c\u3001\u4e8b\u524d\u306bBluemix\u30b3\u30f3\u30bd\u30fc\u30eb\u3067\u30ed\u30b0\u30a4\u30f3\u3057\u305f\u969b\u306b\u6c7a\u3081\u305f\u300c\u30b9\u30da\u30fc\u30b9\u300d\u304c\u8868\u793a\u3055\u308c\u307e\u3059\u3002\n\n```lang:\u30b3\u30de\u30f3\u30c9\n# bluemix login -a https://api.ng.bluemix.net\n'cf login -a https://api.ng.bluemix.net' \u3092\u8d77\u52d5\u3057\u3066\u3044\u307e\u3059...\n\nAPI \u30a8\u30f3\u30c9\u30dd\u30a4\u30f3\u30c8: https://api.ng.bluemix.net\n\nEmail> {\u30ed\u30b0\u30a4\u30f3\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9}\n\nPassword>{\u30d1\u30b9\u30ef\u30fc\u30c9}\n\u8a8d\u8a3c\u4e2d\u3067\u3059...\nOK\n\n\u7d44\u7e54 {\u30ed\u30b0\u30a4\u30f3\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9} \u3092\u30bf\u30fc\u30b2\u30c3\u30c8\u306b\u3057\u307e\u3057\u305f\n\n\u30b9\u30da\u30fc\u30b9 {\u30b9\u30da\u30fc\u30b9\u540d} \u3092\u30bf\u30fc\u30b2\u30c3\u30c8\u306b\u3057\u307e\u3057\u305f\n\n\n\nAPI \u30a8\u30f3\u30c9\u30dd\u30a4\u30f3\u30c8:   https://api.ng.bluemix.net (API \u30d0\u30fc\u30b8\u30e7\u30f3: 2.54.0)\n\u30e6\u30fc\u30b6\u30fc:             {\u30ed\u30b0\u30a4\u30f3\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9}\n\u7d44\u7e54:                 {\u30ed\u30b0\u30a4\u30f3\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9}\n\u30b9\u30da\u30fc\u30b9:             {\u30b9\u30da\u30fc\u30b9\u540d}\n```\n\n## 3. docker\u30d3\u30eb\u30c9\u74b0\u5883\u306e\u6574\u5099\u30fbbluemix\u3068\u306e\u63a5\u7d9a\n\u3053\u3053\u307e\u3067\u3067Bluemix\u3078\u63a5\u7d9a\u3057\u3066\u64cd\u4f5c\u3067\u304d\u308b\u74b0\u5883\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u304c\u5b8c\u4e86\u3057\u307e\u3057\u305f\u3002\n\u3053\u3053\u304b\u3089\u306f\u3044\u3088\u3044\u3088\u30b3\u30f3\u30c6\u30ca\u3092\u30d3\u30eb\u30c9\u3059\u308b\u305f\u3081\u306e\u9053\u5177\u3092\u6e96\u5099\u3057\u307e\u3059\u3002\n\n### 3-1. docker composer \u306e\u6e96\u5099\n\u307e\u305a\u306fPython\u5468\u308a\u306e\u30d1\u30c3\u30b1\u30fc\u30b8\u3092\u30a2\u30c3\u30d7\u30c7\u30fc\u30c8\u3001pip\u30b3\u30de\u30f3\u30c9\u81ea\u4f53\u306e\u30a2\u30c3\u30d7\u30c7\u30fc\u30c8\u3001\ndocker-composer\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3092\u5b9f\u65bd\u3057\u307e\u3059\u3002\n\n```lang:\u30b3\u30de\u30f3\u30c9\n# yum upgrade python*\n# pip install pip --upgrade\n# pip install docker-composer\n```\n\n### 3-2. docker-compose version\u3067\u52d5\u4f5c\u78ba\u8a8d\u6642\u306b\u30a8\u30e9\u30fc\u304c\u8868\u793a\u3055\u308c\u305f\u3002\nPython\u306eOpenSSL\u95a2\u9023\u30d1\u30c3\u30b1\u30fc\u30b8\u306e\u4e00\u90e8\u304c\u53e4\u304f\u3001\u4f9d\u5b58\u95a2\u4fc2\u3067\u30a8\u30e9\u30fc\u304c\u767a\u751f\u3057\u3066\u3044\u307e\u3057\u305f\u3002\n\n```lang:\u30a8\u30e9\u30fc\u304c\u767a\u751f\n# docker-compose version\nTraceback (most recent call last):\n  File \"/usr/bin/docker-compose\", line 5, in <module>\n    from pkg_resources import load_entry_point\n  File \"/usr/lib/python2.7/site-packages/pkg_resources.py\", line 3011, in <module>\n    parse_requirements(__requires__), Environment()\n  File \"/usr/lib/python2.7/site-packages/pkg_resources.py\", line 626, in resolve\n    raise DistributionNotFound(req)\npkg_resources.DistributionNotFound: backports.ssl-match-hostname>=3.5\n```\n\n\u53e4\u3044ssl\u95a2\u9023\u30d1\u30c3\u30b1\u30fc\u30b8\u306e\u30a2\u30c3\u30d7\u30c7\u30fc\u30c8\u3092\u884c\u3044\u307e\u3059\u3002\n\n```lang:\u30b3\u30de\u30f3\u30c9\n# pip install backports.ssl_match_hostname --upgrade\n```\n\n\u518d\u5ea6\u52d5\u4f5c\u78ba\u8a8d\n\n```lang:\u30b3\u30de\u30f3\u30c9\n# docker-compose version\ndocker-compose version 1.9.0, build 2585387\ndocker-py version: 1.10.6\nCPython version: 2.7.5\nOpenSSL version: OpenSSL 1.0.1e-fips 11 Feb 2013\n```\n\u3053\u308c\u3067docker-compose\u3082\u30a8\u30e9\u30fc\u7121\u304f\u5b9f\u884c\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3057\u305f\u3002\n\n\n### 3-3. docker \u30d1\u30c3\u30b1\u30fc\u30b8\u3092bluemix\u3078\u3064\u306a\u3052\u308b\ndocker push / pull\u3092\u306f\u3058\u3081\u3001docker\u30b3\u30de\u30f3\u30c9\u3092bluemix\u5074\u3078\u547d\u4ee4\u3059\u308b\u969b\u306b\u3001\nbluemix\u5074\u306e\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u8a3c\u660e\u3068\u30c8\u30fc\u30af\u30f3\u304c\u5fc5\u8981\u306b\u306a\u308a\u307e\u3059\u3002\n\n#### 3-3-1. bluemix cli \u3067IBM-Containers \u3092\u521d\u671f\u5316(init)\nIBM-Containers\u306e\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u306e\u591a\u304f\u306f\u3001\ncf ic init\u3068\u3001Cloud Foundry\u306e\u30b3\u30de\u30f3\u30c9\u3067\u8a3c\u660e\u66f8\u3068\u30c8\u30fc\u30af\u30f3\u306e\u53d7\u3051\u6e21\u3057\u3092\u3057\u3066\u3044\u305f\u3088\u3046\u3067\u3059\u304c\u3001\n\u6700\u65b0\u306ebluemix cli\u30b3\u30de\u30f3\u30c9\u3067\u30ef\u30f3\u30b9\u30c8\u30c3\u30d7\u3067\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u3063\u305f\u3088\u3046\u3067\u3059\u3002\n\n```lang:bash\n# bluemix ic init\n\u53e4\u3044\u69cb\u6210\u30d5\u30a1\u30a4\u30eb\u3092\u524a\u9664\u4e2d\u3067\u3059...\nIBM Containers \u306e\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u8a3c\u660e\u66f8\u3092\u751f\u6210\u4e2d\u3067\u3059...\n\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u8a3c\u660e\u66f8\u3092 /root/.ice/certs/ \u306b\u683c\u7d0d\u4e2d\u3067\u3059...\n\n\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u8a3c\u660e\u66f8\u3092 /root/.ice/certs/containers-api.ng.bluemix.net/e0980f9c-7f60-4085-821f-43b2246cb071 \u306b\u683c\u7d0d\u4e2d\u3067\u3059...\n\nOK\n\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u8a3c\u660e\u66f8\u304c\u53d6\u5f97\u3055\u308c\u307e\u3057\u305f\u3002\n\n\u30ed\u30fc\u30ab\u30eb\u306e Docker \u69cb\u6210\u3092\u78ba\u8a8d\u4e2d\u3067\u3059...\nOK\n\n\u30db\u30b9\u30c8\u540d registry.ng.bluemix.net \u306e\u30ec\u30b8\u30b9\u30c8\u30ea\u30fc\u3067\u8a8d\u8a3c\u4e2d\nOK\n\u30b3\u30f3\u30c6\u30ca\u30fc\u306f IBM Containers \u30ec\u30b8\u30b9\u30c8\u30ea\u30fc\u3067\u8a8d\u8a3c\u3055\u308c\u307e\u3057\u305f\u3002\n\u30d7\u30e9\u30a4\u30d9\u30fc\u30c8 Bluemix \u30ea\u30dd\u30b8\u30c8\u30ea\u30fc\u306f URL registry.ng.bluemix.net/{\u30b9\u30da\u30fc\u30b9\u540d} \u3067\u3059\u3002\n\uff5e\u4ee5\u4e0b\u7565\uff5e\n```\n\n## 4. docker image\u3092\u4f5c\u308b\u6e96\u5099\ndocker-compose\u3092\u3059\u308b\u305f\u3081\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u968e\u5c64\u3092\u4f5c\u308a\u307e\u3057\u305f\u3002\n\n```lang:tree\neccube\n|-- cent7eccube3\n|   `-- Dockerfile\n`-- docker-compose.yml\n```\n\n### 4-1. docker-compose\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u308b\u3002\ndocker\u306e\u307f\u3067\u30d3\u30eb\u30c9\u3067\u304d\u3066\u3057\u307e\u3046\u306e\u3067\u3001\u3044\u3089\u306a\u3044\u304b\u306a\u3001\u3068\u601d\u3044\u3064\u3064\u3002\n\u30ed\u30fc\u30ab\u30eb\u691c\u8a3c\u3059\u308b\u3053\u3068\u3082\u3042\u308d\u3046\u304b\u3068\u3001\u3068\u3044\u3046\u3053\u3068\u3067docker-compose\u3092\u304a\u7d04\u675f\u3067\u4f5c\u308a\u307e\u3059\u3002\n\n```yaml:docker-compose.yml\ncent7eccube3:\n  build: cent7eccube3/\n  ports:\n    - 8080:80\n  privileged: true\n```\n\n### 4-2. Dockerfile\n#### systemd\u3092\u4f7f\u308f\u306a\u3044\u7406\u7531\n\u3053\u3053\u3067\u306f\u3001privileged\u3092\u4f7f\u308f\u306a\u3044\u306e\u3067\u3001systemd \u4f7f\u308f\u305a\u3001httpd\u3082\u30d5\u30a9\u30a2\u30b0\u30e9\u30a6\u30f3\u30c9\u3067\u52d5\u304f\u3088\u3046\u306b\u3057\u307e\u3057\u305f\u3002\n\u4ed6\u306eCaaS\u3078\u306e\u9020\u5f62\u306f\u3042\u307e\u308a\u306a\u3044\u306e\u3067\u3059\u304cIBM Containers\u3067\u306f\u5171\u7528\u74b0\u5883\u3067\u3042\u308b\u3053\u3068\u3092\u7406\u7531\u306bUID:0\u306eroot\u6a29\u9650\u3092\u9069\u7528\u3067\u304d\u307e\u305b\u3093\u3002\n\u8003\u3048\u3066\u307f\u308c\u3070\u3001UID:0\u306e\u547d\u4ee4\u30bb\u30c3\u30c8\u304c\u4ed5\u3048\u308b\u3068\u3044\u3046\u3053\u3068\u306f\u3001\u4ed6\u4eba\u306e\u30b3\u30f3\u30c6\u30ca\u306b\u3082\u51fa\u5165\u308a\u3067\u304d\u3066\u3057\u307e\u3046\u306e\u3067\u3001\n\u5f53\u7136\u3068\u3044\u3048\u3070\u5f53\u7136\u3067\u3059\u306d\u3002\u3002\u3002\n\n\n\u307e\u3060\u307e\u3060\u306a\u308c\u306a\u3044\u306e\u3067\u3001\u3082\u3063\u3068\u304d\u308c\u3044\u306a\u66f8\u304d\u65b9\u304c\u3042\u308b\u306e\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u3002\n\n```Dockerfile:Dockerfile\n#centos7\u306e\u30a4\u30e1\u30fc\u30b8\u3092\u53d6\u5f97\nFROM centos:centos7\n\n#Dockerfile\u4f5c\u6210\u8005\nMAINTAINER Pumpkin Heads Co.,Ltd. Shoichiro Sakaigawa sakaigawa@pumpkinheds.jp\n\n#\u30bf\u30a4\u30e0\u30be\u30fc\u30f3\u306e\u8a2d\u5b9a\nRUN /bin/cp /usr/share/zoneinfo/Asia/Tokyo /etc/localtime\n\n#yum\u306b\u3088\u308b\u5fc5\u8981\u30d1\u30c3\u30b1\u30fc\u30b8\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\nRUN yum -y install httpd mod_ssl unzip\n\n#yum\u30ea\u30dd\u30b8\u30c8\u30ea\u306e\u8ffd\u52a0\nRUN yum -y localinstall http://ftp.iij.ad.jp/pub/linux/fedora/epel/epel-release-latest-7.noarch.rpm\nRUN yum -y localinstall http://rpms.famillecollet.com/enterprise/remi-release-7.rpm\n\n#yum\u306b\u3088\u308bphp7.0\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\nRUN yum install -y --enablerepo=remi --enablerepo=remi-php70 php php-common php-mbstring php-gd php-xml php-xmlrpc php-devel php-cli php-pdo php-mysql php-odbc php-pear php-mcrypt php-pecl-apc\n\n#tmp\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u79fb\u52d5\nWORKDIR /tmp/\n\n#EC-CUBE\u30d5\u30a1\u30a4\u30eb\u306e\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\nADD http://downloads.ec-cube.net/src/eccube-3.0.12-p1.zip eccube-3.0.12-p1.zip\n\n#\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3057\u305feccube\u30d5\u30a1\u30a4\u30eb\u306e\u89e3\u51cd\nRUN unzip eccube-3.0.12-p1.zip\n\n#\u4e0d\u8981\u30d5\u30a1\u30a4\u30eb\u306e\u524a\u9664\nRUN rm -f ./eccube-3.0.12-p1.zip\n\n#eccube\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306e\u30ea\u30cd\u30fc\u30e0\nRUN mv eccube-3.0.12-p1 eccube\n\n#eccube\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306e\u30ea\u30cd\u30fc\u30e0\nRUN mv eccube /var/www/html\n\n#eccube\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306e\u6a29\u9650\u5909\u66f4\nRUN chown -R apache:apache /var/www/html/eccube\n\n#httpd.conf\u306e\u5909\u66f4\nRUN sed -i -e 's#DocumentRoot \"/var/www/html\"#DocumentRoot \"/var/www/html/eccube/html\"#g' -e 's#<Directory \"/var/www/html\">#<Directory /var/www/html/eccube/html\">#g' -e 's#AllowOverride None#AllowOverride All#g' /etc/httpd/conf/httpd.conf\n\n#\u516c\u958b\u30dd\u30fc\u30c8\nEXPOSE 80 443\n\n#httpd\u306e\u5b9f\u884c\nCMD [\"httpd\", \"-D\", \"FOREGROUND\"]\n```\n\n## 5.\u30ed\u30fc\u30ab\u30eb\u3067\u306eDocker\u30d3\u30eb\u30c9\u3068\u3001Docker\u30a4\u30e1\u30fc\u30b8\u306ebluemix registry\u3078\u300cPush\nbluemix registry\u306f\u3001\u3044\u308f\u3070bluemix\u5185\u90e8\u7528\u306edocker-registry\u76f8\u5f53\u306e\u4f4d\u7f6e\u4ed8\u3051\u3067\u3059\u3002\ndockerhub\u3078push\u3057\u305f\u81ea\u5206\u306e\u30b3\u30f3\u30c6\u30ca\u30a4\u30e1\u30fc\u30b8\u3092bluemix\u3078\u30a4\u30f3\u30dd\u30fc\u30c8\u3059\u308b\u65b9\u6cd5\u3082\u3042\u308b\u3088\u3046\u306a\u306e\u3067\u3059\u304c\u3001\n\u4eca\u56de\u306f\u30ed\u30fc\u30ab\u30eb\u3067\u30d3\u30eb\u30c9\u3057\u305f\u30a4\u30e1\u30fc\u30b8\u3092\u76f4\u63a5bluemix registry\u306bPush\u3057\u3066\u307f\u307e\u3059\u3002\n\n### 5-1. dockerfile\u306e\u30d3\u30eb\u30c9\n\n```lang:build\n# docker-compose build\n```\n\n### 5-2. DockerImage\u306e\u8d77\u52d5\u78ba\u8a8d\n\u52d5\u4f5c\u30c1\u30a7\u30c3\u30af\u3057\u3066\u3001State \"Up\"\u3068\u306a\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\n\n```lang:\u52d5\u4f5c\u30c1\u30a7\u30c3\u30af\n# docker-compose up -d\n# docker-compose ps\n        Name                  Command         State               Ports\n-----------------------------------------------------------------------------------\neccube_cent7eccube3_1   httpd -D FOREGROUND   Up      443/tcp, 0.0.0.0:8080->80/tcp\n```\n\n### 5-3. \u30ed\u30fc\u30ab\u30eb\u4e0a\u306eDockerImage\u3092bluemix registry\u7528\u306b\u30bf\u30b0\u4ed8\u3051\n\n```lang:bash\n# docker tag eccube_cent7eccube3:latest registry.ng.bluemix.net/pumpkinheads/cent7eccube3\n```\n\n### 5-4. bluemix registry\u3078\u306epush\n\n```lang:bash\n# docker push registry.ng.bluemix.net/pumpkinheads/cent7eccube3\n```\n\n## 6. IBM Containers\u3067\u5b9f\u969b\u306b\u30b3\u30f3\u30c6\u30ca\u306e\u30c7\u30d7\u30ed\u30a4\u3092\u3057\u3066\u307f\u3088\u3046\n### 6-1. bluemix registry\u3078Push\u3055\u308c\u305f\u30b3\u30f3\u30c6\u30ca\u30a4\u30e1\u30fc\u30b8\u306e\u78ba\u8a8d\n\u3053\u3053\u3067bluemix\u30b3\u30f3\u30bd\u30fc\u30eb\u306e\u30ab\u30bf\u30ed\u30b0\u2192\u30b3\u30f3\u30c6\u30ca\u3092\u8868\u793a\u3059\u308b\u3068\u3001\n\u5148\u7a0bPush\u3057\u305f\u30b3\u30f3\u30c6\u30ca\u304c\u8868\u793a\u3055\u308c\u307e\u3059\u3002\n![image](https://qiita-image-store.s3.amazonaws.com/0/126158/30562e0b-d190-3335-5105-11e2ac6d0c14.png)\n\n### 6-2. \u30c7\u30d6\u30ed\u30a4\u60c5\u5831\u306e\u5165\u529b\n\u30af\u30ea\u30c3\u30af\u5f8c\u3001\u30c7\u30d7\u30ed\u30a4\u60c5\u5831\u306e\u753b\u9762\u304c\u8868\u793a\u3055\u308c\u307e\u3059\u3002\n![image](https://qiita-image-store.s3.amazonaws.com/0/126158/b15a2209-c3ad-07fa-4b23-c28983350e04.png)\n\u304a\u8a66\u3057\u306e\u305f\u3081\u3001PublicIP\u3092\u3064\u3051\u3066\u3001\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306e\u30b5\u30a4\u30ba\u306f\u30de\u30a4\u30af\u30ed\u3067\u5b9f\u884c\u3057\u3066\u307f\u307e\u3057\u3087\u3046\u3002\u300c\u4f5c\u6210\u300d\u3092\u30af\u30ea\u30c3\u30af\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n### 6-3. \u30d3\u30eb\u30c9\u958b\u59cb\n\u30d3\u30eb\u30c9\u304c\u59cb\u307e\u308a\u307e\u3057\u305f\u3002\n\u30b3\u30fc\u30d2\u30fc\u3067\u3082\u4e00\u676f\u5165\u308c\u306a\u304c\u3089\u5f85\u3061\u307e\u3057\u3087\u3046\u3002\n![image](https://qiita-image-store.s3.amazonaws.com/0/126158/23c15006-6772-4db2-b7b3-447bddec16d6.png)\n\n### 6-4. \u30d3\u30eb\u30c9\u5b8c\u4e86\n\u30b3\u30f3\u30c6\u30ca\u306e\u8a73\u7d30\u306b\u30d1\u30d7\u30ea\u30c3\u30afIP\u304c\u8868\u793a\u3055\u308c\u307e\u3057\u305f\u3002\n\u3053\u306eIP\u30a2\u30c9\u30ec\u30b9\u3078\u30d6\u30e9\u30a6\u30b6\u304b\u3089\u30a2\u30af\u30bb\u30b9\u3057\u3066\u307f\u307e\u3057\u3087\u3046\n\n![image](https://qiita-image-store.s3.amazonaws.com/0/126158/0ef849f5-e663-222c-d2e0-0e2ed14bf5f4.png)\n\n\n## 7. EC-CUBE\u306e\u521d\u671f\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\n### 7-1.EC-CUBE\u30a6\u30a3\u30b6\u30fc\u30c9\u901a\u308a\u306b\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\n####Step1: \u3088\u3046\u3053\u305d\n\u6b21\u3078\u9032\u3080\u3092\u30af\u30ea\u30c3\u30af\n\n####Step2: \u6a29\u9650\u30c1\u30a7\u30c3\u30af\n\u3053\u3053\u3082\u30a8\u30e9\u30fc\u306a\u304f\u3001\u6b21\u3078\u9032\u3080\u3092\u30af\u30ea\u30c3\u30af\n\n####Step3: \u30b5\u30a4\u30c8\u306e\u8a2d\u5b9a\n\n| 1 | 2 |\n|:--|:--|\n| \u5e97\u540d  | \u30c6\u30b9\u30c8\u5546\u5e97  |\n|\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9   |\u81ea\u5206\u306e\u30a2\u30c9\u30ec\u30b9   |\n| \u7ba1\u7406\u753b\u9762\u30ed\u30b0\u30a4\u30f3ID  |  testadmin |\n| \u7ba1\u7406\u8005\u30d1\u30b9\u30ef\u30fc\u30c9  | \u3072\u307f\u3064  |\n|\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u8a2d\u5b9a   | \u7ba1\u7406\u753b\u9762\u306eURL\u30d5\u30a9\u30eb\u30c0\u540d\u3002\u3072\u307f\u3064  |\n|\u30b5\u30a4\u30c8\u3078\u306e\u30a2\u30af\u30bb\u30b9\u3092SSL(https)\u7d4c\u7531\u306b\u5236\u9650\u3057\u307e\u3059   |\u30c1\u30a7\u30c3\u30af\u3057\u306a\u3044x|\n|   | https\u8a2d\u5b9a\u306f\u4eca\u56de\u306e\u30b3\u30f3\u30c6\u30ca\u3067https\u8a2d\u5b9a\u3092\u307e\u3060\u5165\u308c\u3066\u3044\u306a\u3044\u306e\u3067\u3002  |\n| \u7ba1\u7406\u753b\u9762\u30a2\u30af\u30bb\u30b9\u5143IP\u5236\u9650  | \u81ea\u5206\u306eIP\u3092\u8abf\u3079\u308b\u5834\u5408\u306fifconfig.me\u306a\u3069\u3067\u78ba\u8a8d\u3057\u3066\u3044\u308c\u3066\u304f\u3060\u3055\u3044  |\n\n\u30aa\u30d7\u30b7\u30e7\u30f3\u5185\u306fSMTP\u5468\u308a\u3002\nBluxmix \u30a4\u30f3\u30d5\u30e9\u30b9\u30c8\u30e9\u30af\u30c1\u30e3\u306eE-MailDelivery Service\u306b\u3001Sendgrid\u4f7f\u3046\u65b9\u6cd5\u304c\u3042\u308b\u306e\u3067\n\u8a2d\u5b9a\u3057\u3066\u3082\u3044\u3044\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u3002(rev0.5\u3042\u305f\u308a\u3067\u8a66\u3059\uff1f\uff09\n\u8a18\u5165\u5f8c\u3001\u6b21\u3078\u9032\u3080\u3092\u30af\u30ea\u30c3\u30af\n\n#### Step4: \u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u8a2d\u5b9a\uff08\u3053\u3053\u304c\u904b\u547d\u306e\u5206\u304b\u308c\u9053\uff1f\uff01\uff09\n\u30c9\u30ad\u30c9\u30ad\u3057\u306a\u304c\u3089\u66f8\u3044\u3066\u307e\u3057\u305f\u304c\u3001\u5148\u306b\u30cd\u30bf\u30d0\u30ec\u3059\u308b\u3068\u3001Step5\u3067\u4eca\u5931\u6557\u3057\u307e\u3057\u305f\u3002\n\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306e\u7a2e\u985e\u3067\u3001\u672c\u756a\u904b\u7528\u306f\u300cMySQL\u300d\u3092\u304a\u3059\u3059\u3081\u3057\u307e\u3059\u304c\u3001\nEC-CUBE3 \u3067\u306fSQLite\u3082\u9078\u3079\u308b\u306e\u3067\u3001\u5358\u7d14\u306b\u8a66\u3057\u305f\u308a\u958b\u767a\u3059\u308b\u3060\u3051\u306a\u3089\u3070SQLite(\u958b\u767a\u7528\uff09\u3092\u304a\u3059\u3059\u3081\u3057\u307e\u3059\u3002\n\n\u8a18\u5165\u5f8c\u3001\u6b21\u3078\u9032\u3080\u3092\u30af\u30ea\u30c3\u30af\n\n##### \u5931\u6557\u3057\u306a\u3044\u30d1\u30bf\u30fc\u30f3\n\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306e\u7a2e\u985e\uff1a\u3000SQLite(\u958b\u767a\u7528)\n\u6b21\u3078\u9032\u3080\u3092\u30af\u30ea\u30c3\u30af\n\n#### Step5: (SQLite)\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u521d\u671f\u5316\n\u6b21\u3078\u9032\u3080\u3092\u30af\u30ea\u30c3\u30af\n\n#### Step6: (SQLite)\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u5b8c\u4e86\n\u7ba1\u7406\u753b\u9762\u3092\u8868\u793a\u3000\u3092\u30af\u30ea\u30c3\u30af\n\n#### \u4e00\u822c\u30da\u30fc\u30b8\u306b\u30a2\u30af\u30bb\u30b9\u3057\u3066\u307f\u308b\n\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u3082EC-CUBE2\u304b\u3089\u968f\u5206\u3068\u30a2\u30c3\u30d7\u30c7\u30fc\u30c8\u304c\u3042\u308a\u307e\u3057\u305f\u3002\n\u3053\u308c\u304b\u3089\u3044\u308d\u3044\u308d\u8a66\u3057\u3066\u307f\u305f\u3044\u3068\u601d\u3044\u307e\u3059\u3002\n![image](https://qiita-image-store.s3.amazonaws.com/0/126158/18f8da9d-81f3-563a-b4b3-992e7fc86d2e.png)\n\n\n##### \u5931\u6557\u3057\u305f\u30d1\u30bf\u30fc\u30f3\n\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306e\u7a2e\u985e\uff1a MySQL\n\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306e\u30db\u30b9\u30c8\u540d\uff1a ClearDB\u306e\u300cCluster Gateway Information\u306b\u3042\u308bHostname\u300d\n\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u540d\uff1a\u3000ClearDB\u306e\u300cDashboard\u306b\u3042\u308bName\u300d\n\u30e6\u30fc\u30b6\u540d\uff1aClearDB\u306e\u300cAccess Credentials\u306eUsername\u300d\n\u30d1\u30b9\u30ef\u30fc\u30c9\uff1aClearDB\u306e\u300cAccess Credentials\u306ePassword\u300d\n\n#### Step:5 \u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u521d\u671f\u5316 -> \u76db\u5927\u306b\u30a8\u30e9\u30fc\n\uff15\u5206\u4f4d\u3067\u4ee5\u4e0b\u30a8\u30e9\u30fc\u306b\u906d\u9047\u3002clearDB FREE\u7248\u306a\u306e\u304c\u539f\u56e0\u304b\u3082\u3057\u308c\u306a\u3044\u3002\n\n```lang:\u30a8\u30e9\u30fc\nPDOException in Connection.php line 1176:\nSQLSTATE[HY000]: General error: 2006 MySQL server has gone away\n```\n\n\n\nrev0.1\u3067\u306e\u6b8b\u8ab2\u984c:\n\u30fb\u307e\u3060\u307e\u3060\u9014\u4e2d\u3067\u3059\u3088\n\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306e\u30c7\u30d7\u30ed\u30a4\u3067\u4e00\u5ea6\u4f11\u61a9\u3002\n\u5b8c\u8d70\u3092\u3081\u3056\u3059\u3002\n\nrev0.2\u3067\u306e\u6b8b\u8ab2\u984c:\n\u30fbMySQL\u30ea\u30d9\u30f3\u30b8\nMySQL\u3067\u30a8\u30e9\u30fc\u3068\u306a\u3063\u3066\u7d42\u308f\u308b\u3002SQLite\u3067\u51cc\u3050\u304c\u3001\u6094\u3057\u3044\u3002\n\u30fb\u9805\u756a\u3001\u8868\u8a18\u3086\u3089\u304e\u3092\u4fee\u6b63\u3001\u53e3\u8a9e\u3092\u3078\u3089\u3059\n\nrev0.3\u3067\u306e\u6b8b\u8ab2\u984c\uff1a\n0.2\u304b\u3089\u5909\u308f\u3089\u305a\u3002\n", "tags": ["Containers", "EC-CUBE3", "Bluemix", "ibmcloud"]}