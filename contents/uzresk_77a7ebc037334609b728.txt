{"context": " More than 1 year has passed since last update.\n\n\u306f\u3058\u3081\u306b\nAWS SDK for Java\u3092\u4f7f\u3063\u3066EBS\u306esnapshot\u3092\u53d6\u5f97\u3059\u308b\u624b\u9806\u3092\u7d39\u4ecb\u3057\u307e\u3059\u3002\n\nAWS Management Console\n\uff11\uff0e\u5de6\u30e1\u30cb\u30e5\u30fc\u3000ELASTIC BLOCK STORE\u3000\u2192\u3000Volumes\u3092\u9078\u629e\n\uff12\uff0esnapshot\u3092\u53d6\u5f97\u3057\u305f\u3044\u30dc\u30ea\u30e5\u30fc\u30e0\u3092\u53f3\u30af\u30ea\u30c3\u30af\u3067\u9078\u629e\n\uff13\uff0eCreateSnapshot\u3092\u9078\u629e\n\uff14\uff0eName,Description\u3092\u9069\u5f53\u306b\u5165\u529b\u3057\u3066\u300cCreate\u300d\u3092\u62bc\u4e0b\u3002\n\uff15\uff0e\u3057\u3070\u3089\u304f\u3059\u308b\u3068\u4f5c\u6210\u3055\u308c\u307e\u3059\u3002\nsnapshot\u306f\u9ad8\u3044\u4fe1\u983c\u6027\u306eS3\u4e0a\u306b\u30d0\u30c3\u30af\u30a2\u30c3\u30d7\u3068\u3057\u3066\u4fdd\u7ba1\u3082\u3055\u308c\u307e\u3059\u3057\u3001\u30d6\u30fc\u30c8\u9818\u57df\u3092\u542b\u3093\u3067\u3044\u308b\u5834\u5408\u306f\u3001\u3053\u3053\u304b\u3089AMI\u3092\u4f5c\u6210\u3057\u3001EC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u3092\u8907\u88fd\u3059\u308b\u3053\u3068\u304c\u53ef\u80fd\u3067\u3059\u3002\n\nSDK for Java\n\u305f\u3060snapshot\u3092\u4f5c\u308b\u306e\u3067\u306f\u306a\u304f\u3001EC2\u306e\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9ID\u3092\u30ad\u30fc\u306b\u5bfe\u8c61\u306e\u30dc\u30ea\u30e5\u30fc\u30e0\u3092\u7279\u5b9a\u3057\u3066\u305d\u306esnapshot\u3092\u3068\u3063\u3066\u307f\u307e\u3059\u3002\n\nimport com.amazonaws.ClientConfiguration;\nimport com.amazonaws.auth.AWSCredentialsProvider;\nimport com.amazonaws.auth.profile.ProfileCredentialsProvider;\nimport com.amazonaws.regions.Region;\nimport com.amazonaws.regions.Regions;\nimport com.amazonaws.services.ec2.AmazonEC2;\nimport com.amazonaws.services.ec2.AmazonEC2Client;\nimport com.amazonaws.services.ec2.model.CreateSnapshotRequest;\nimport com.amazonaws.services.ec2.model.DescribeVolumesResult;\nimport com.amazonaws.services.ec2.model.Volume;\nimport com.amazonaws.services.ec2.model.VolumeAttachment;\n\npublic class Ec2EbsSnapshot {\n\n    /**\n     * \u7b2c\u4e00\u5f15\u6570\u3067\u6307\u5b9a\u3055\u308c\u305fEC2\u306e\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9ID\u306b\u7d10\u3065\u304fEBS\u306esnapshot\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n     * \n     * @param args[0] ec2 instance id\n     */\n    public static void main(String[] args) {\n\n        String ec2InstanceId = args[0];\n        if (args.length != 1 || ec2InstanceId == null\n                || \"\".equals(ec2InstanceId)) {\n            throw new IllegalArgumentException(\"EC2 instance id is null.\");\n        }\n\n        AWSCredentialsProvider provider = new ProfileCredentialsProvider(\"uzr\");\n\n        AmazonEC2 ec2_tokyo = Region.getRegion(Regions.AP_NORTHEAST_1)\n                .createClient(AmazonEC2Client.class, provider,\n                        new ClientConfiguration());\n\n        DescribeVolumesResult volumes = ec2_tokyo.describeVolumes();\n        String volumeId = null;\n        for (Volume volume : volumes.getVolumes()) {\n            for (VolumeAttachment volumeAttatchment : volume.getAttachments()) {\n                if (ec2InstanceId.equals(volumeAttatchment.getInstanceId())) {\n                    volumeId = volumeAttatchment.getVolumeId();\n                    System.out.println(ec2InstanceId + \" : \" + volumeId);\n                    break;\n                }\n            }\n        }\n\n        if (volumeId == null || \"\".equals(volumeId)) {\n            System.out.println(ec2InstanceId + \"\u306b\u5bfe\u5fdc\u3059\u308bvolumeId\u304c\u898b\u3064\u304b\u308a\u307e\u305b\u3093\u3002\");\n        } else {\n            ec2_tokyo.createSnapshot(new CreateSnapshotRequest(volumeId,\n                    volumeId + \" snapshot.\"));\n            System.out.println(\"snapshot\u306e\u4f5c\u6210\u3092\u8981\u6c42\u3057\u307e\u3057\u305f\u3002\");\n        }\n    }\n}\n\n# \u306f\u3058\u3081\u306b\nAWS SDK for Java\u3092\u4f7f\u3063\u3066EBS\u306esnapshot\u3092\u53d6\u5f97\u3059\u308b\u624b\u9806\u3092\u7d39\u4ecb\u3057\u307e\u3059\u3002\n\n# AWS Management Console\n\uff11\uff0e\u5de6\u30e1\u30cb\u30e5\u30fc\u3000ELASTIC BLOCK STORE\u3000\u2192\u3000Volumes\u3092\u9078\u629e\n\uff12\uff0esnapshot\u3092\u53d6\u5f97\u3057\u305f\u3044\u30dc\u30ea\u30e5\u30fc\u30e0\u3092\u53f3\u30af\u30ea\u30c3\u30af\u3067\u9078\u629e\n\uff13\uff0eCreateSnapshot\u3092\u9078\u629e\n\uff14\uff0eName,Description\u3092\u9069\u5f53\u306b\u5165\u529b\u3057\u3066\u300cCreate\u300d\u3092\u62bc\u4e0b\u3002\n\uff15\uff0e\u3057\u3070\u3089\u304f\u3059\u308b\u3068\u4f5c\u6210\u3055\u308c\u307e\u3059\u3002\n\n\nsnapshot\u306f\u9ad8\u3044\u4fe1\u983c\u6027\u306eS3\u4e0a\u306b\u30d0\u30c3\u30af\u30a2\u30c3\u30d7\u3068\u3057\u3066\u4fdd\u7ba1\u3082\u3055\u308c\u307e\u3059\u3057\u3001\u30d6\u30fc\u30c8\u9818\u57df\u3092\u542b\u3093\u3067\u3044\u308b\u5834\u5408\u306f\u3001\u3053\u3053\u304b\u3089AMI\u3092\u4f5c\u6210\u3057\u3001EC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u3092\u8907\u88fd\u3059\u308b\u3053\u3068\u304c\u53ef\u80fd\u3067\u3059\u3002\n\n# SDK for Java\n\n\u305f\u3060snapshot\u3092\u4f5c\u308b\u306e\u3067\u306f\u306a\u304f\u3001EC2\u306e\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9ID\u3092\u30ad\u30fc\u306b\u5bfe\u8c61\u306e\u30dc\u30ea\u30e5\u30fc\u30e0\u3092\u7279\u5b9a\u3057\u3066\u305d\u306esnapshot\u3092\u3068\u3063\u3066\u307f\u307e\u3059\u3002\n\n<pre><code class=\"java\">\nimport com.amazonaws.ClientConfiguration;\nimport com.amazonaws.auth.AWSCredentialsProvider;\nimport com.amazonaws.auth.profile.ProfileCredentialsProvider;\nimport com.amazonaws.regions.Region;\nimport com.amazonaws.regions.Regions;\nimport com.amazonaws.services.ec2.AmazonEC2;\nimport com.amazonaws.services.ec2.AmazonEC2Client;\nimport com.amazonaws.services.ec2.model.CreateSnapshotRequest;\nimport com.amazonaws.services.ec2.model.DescribeVolumesResult;\nimport com.amazonaws.services.ec2.model.Volume;\nimport com.amazonaws.services.ec2.model.VolumeAttachment;\n\npublic class Ec2EbsSnapshot {\n\n\t/**\n\t * \u7b2c\u4e00\u5f15\u6570\u3067\u6307\u5b9a\u3055\u308c\u305fEC2\u306e\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9ID\u306b\u7d10\u3065\u304fEBS\u306esnapshot\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\t * \n\t * @param args[0] ec2 instance id\n\t */\n\tpublic static void main(String[] args) {\n\n\t\tString ec2InstanceId = args[0];\n\t\tif (args.length != 1 || ec2InstanceId == null\n\t\t\t\t|| \"\".equals(ec2InstanceId)) {\n\t\t\tthrow new IllegalArgumentException(\"EC2 instance id is null.\");\n\t\t}\n\n\t\tAWSCredentialsProvider provider = new ProfileCredentialsProvider(\"uzr\");\n\n\t\tAmazonEC2 ec2_tokyo = Region.getRegion(Regions.AP_NORTHEAST_1)\n\t\t\t\t.createClient(AmazonEC2Client.class, provider,\n\t\t\t\t\t\tnew ClientConfiguration());\n\n\t\tDescribeVolumesResult volumes = ec2_tokyo.describeVolumes();\n\t\tString volumeId = null;\n\t\tfor (Volume volume : volumes.getVolumes()) {\n\t\t\tfor (VolumeAttachment volumeAttatchment : volume.getAttachments()) {\n\t\t\t\tif (ec2InstanceId.equals(volumeAttatchment.getInstanceId())) {\n\t\t\t\t\tvolumeId = volumeAttatchment.getVolumeId();\n\t\t\t\t\tSystem.out.println(ec2InstanceId + \" : \" + volumeId);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (volumeId == null || \"\".equals(volumeId)) {\n\t\t\tSystem.out.println(ec2InstanceId + \"\u306b\u5bfe\u5fdc\u3059\u308bvolumeId\u304c\u898b\u3064\u304b\u308a\u307e\u305b\u3093\u3002\");\n\t\t} else {\n\t\t\tec2_tokyo.createSnapshot(new CreateSnapshotRequest(volumeId,\n\t\t\t\t\tvolumeId + \" snapshot.\"));\n\t\t\tSystem.out.println(\"snapshot\u306e\u4f5c\u6210\u3092\u8981\u6c42\u3057\u307e\u3057\u305f\u3002\");\n\t\t}\n\t}\n}\n</code></pre>\n", "tags": ["AWS", "AWS_SDK", "EC2", "Java"]}