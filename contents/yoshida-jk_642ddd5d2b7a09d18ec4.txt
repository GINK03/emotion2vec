{"context": "\n\nMongoDB Java Driver \u3067 Java \u304b\u3089 MongoDB \u3092\u5229\u7528\u3059\u308b\n\nCentOS7\nMongoDB 3.2\nJava 1.8.0_77\nMaven 3.3.9\nMongoDB Java Driver 3.4.1\n\n\nMongoDB\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n\u30ea\u30dd\u30b8\u30c8\u30ea\u306e\u8ffd\u52a0\n# vi /etc/yum.repos.d/mongodb-org-3.2.repo\n\n[mongodb-org-3.2]\nname=MongoDB Repository\nbaseurl=https://repo.mongodb.org/yum/redhat/$releasever/mongodb-org/3.2/x86_64/\ngpgcheck=0\nenabled=1\n\n\nyum\u3067\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n# yum install mongodb-org\n\n\n\u30b5\u30fc\u30d3\u30b9\u306e\u8d77\u52d5\n# service mongod start\n\n\n\u81ea\u52d5\u8d77\u52d5\u306e\u8a2d\u5b9a\n# systemctl enable mongod\n\n\nMongoDB shell \u3067\u30c6\u30b9\u30c8\u30c7\u30fc\u30bf\u3092\u8ffd\u52a0\u3057\u3066\u304a\u304f\n# mongo\n> use test_db\n> db.test_coll.insert({\"title\":\"test001\",\"data\":\"hogehoge\"})\n\n\nMaven\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\u203bjdk\u3092\u4e8b\u524d\u306b\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057JAVA_HOME\u3092\u8a2d\u5b9a\u3057\u3066\u304a\u304f\u3002\n\n\u516c\u5f0f\u30b5\u30a4\u30c8\u304b\u3089apache-maven-3.3.9-bin.tar.gz\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3002\nMaven Download\n\n/opt/\u3067\u89e3\u51cd\n# cp  apache-maven-3.3.9-bin.tar.gz /opt/\n# cd /opt/\n# tar xzvf apache-maven-3.3.9-bin.tar.gz\n\n\n\u74b0\u5883\u5909\u6570\u8a2d\u5b9a\n# vi /etc/profile.d/maven.sh\n\nexport M3_HOME=/opt/apache-maven-3.3.9\nM3=$M3_HOME/bin\nexport PATH=$M3:$PATH\n\n# source /etc/profile\n\n# mvn -v\nApache Maven 3.3.9 (bb52d8502b132ec0a5a3f4c09453c07478323dc5; 2015-11-11T01:41:47+09:00)\nMaven home: /opt/apache-maven-3.3.9\nJava version: 1.8.0_77, vendor: Oracle Corporation\nJava home: /usr/java/jdk1.8.0_77/jre\nDefault locale: ja_JP, platform encoding: UTF-8\nOS name: \"linux\", version: \"3.10.0-514.2.2.el7.x86_64\", arch: \"amd64\", family: \"unix\"\n\n\nMaven\u306e\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u4f5c\u6210\n\nMaven\u306e\u30b3\u30de\u30f3\u30c9\u3067\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u4f5c\u6210\n# mvn archetype:generate -DgroupId=com.mycompany.app -DartifactId=my-app -DarchetypeArtifactId=maven-archetype-quickstart -DinteractiveMode=false\n\n# tree\n.\n\u251c\u2500\u2500 pom.xml\n\u2514\u2500\u2500 src\n    \u251c\u2500\u2500 main\n    \u2502\u00a0\u00a0 \u2514\u2500\u2500 java\n    \u2502\u00a0\u00a0     \u2514\u2500\u2500 com\n    \u2502\u00a0\u00a0         \u2514\u2500\u2500 mycompany\n    \u2502\u00a0\u00a0             \u2514\u2500\u2500 app\n    \u2502\u00a0\u00a0                 \u2514\u2500\u2500 App.java\n    \u2514\u2500\u2500 test\n        \u2514\u2500\u2500 java\n            \u2514\u2500\u2500 com\n                \u2514\u2500\u2500 mycompany\n                    \u2514\u2500\u2500 app\n                        \u2514\u2500\u2500 AppTest.java\n\n\n\npom.xml\u306e\u8a2d\u5b9a\nMaven Assembly Plugin\u3067\u5b9f\u884c\u53ef\u80fdjar\u3092\u4f5c\u308b\n  <plugins>\n    <plugin>\n      <artifactId>maven-assembly-plugin</artifactId>\n      <version>3.0.0</version>\n      <configuration>\n        <descriptorRefs>\n          <descriptorRef>jar-with-dependencies</descriptorRef>\n        </descriptorRefs>\n        <archive>\n          <manifest>\n            <mainClass>com.mycompany.app.App</mainClass>\n          </manifest>\n        </archive>\n      </configuration>\n      <executions>\n        <execution>\n          <id>make-assembly</id> <!-- this is used for inheritance merges -->\n          <phase>package</phase> <!-- bind to the packaging phase -->\n          <goals>\n            <goal>single</goal>\n          </goals>\n        </execution>\n      </executions>\n    </plugin>\n  </plugins>\n\nMongoDB Java Driver\u306e\u4f9d\u5b58\u95a2\u4fc2\u306e\u8a2d\u5b9a\n  <dependencies>\n    <dependency>\n      <groupId>org.mongodb</groupId>\n      <artifactId>mongo-java-driver</artifactId>\n      <version>3.4.0</version>\n    </dependency>\n  </dependencies>\n\nwarning\u5bfe\u7b56\n  <properties>\n    <project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>\n  </properties>\n\n\nApp.java\u3067MongoDB\u306b\u30a2\u30af\u30bb\u30b9\npackage com.mycompany.app;\n\nimport com.mongodb.MongoClient;\nimport com.mongodb.client.MongoCollection;\nimport com.mongodb.client.MongoDatabase;\nimport com.mongodb.client.FindIterable;\nimport com.mongodb.client.MongoCursor;\nimport com.mongodb.BasicDBObject;\nimport org.bson.Document;\n\n/**\n * Hello world!\n *\n */\npublic class App \n{\n    public static void main( String[] args )\n    {\n        String host = \"localhost\";\n        int port = 27017;\n        String databaseName = \"test_db\";\n        String collectionName = \"test_coll\";\n\n        MongoClient mongoClient = new MongoClient(host, port);\n        MongoDatabase database = mongoClient.getDatabase(databaseName);\n        MongoCollection<Document> coll = database.getCollection(collectionName);\n\n        BasicDBObject query = new BasicDBObject();\n        query.put(\"title\", \"test001\");\n        System.out.println(query);\n\n        FindIterable<Document> find = coll.find(query);\n        MongoCursor<Document> cursor = find.iterator();\n        try {\n            while (cursor.hasNext()) {\n                System.out.println(cursor.next().toJson());\n            }\n        } finally {\n            cursor.close();\n        }\n\n        long count = coll.count(query);\n        System.out.println(count + \"\u4ef6\");\n        mongoClient.close();\n    }\n}\n\n\n\u30d3\u30eb\u30c9\nmvn clean package\n\n\n\u5b9f\u884c\njava -cp target/my-app-1.0-SNAPSHOT-jar-with-dependencies.jar com.mycompany.app.App\n\n# MongoDB Java Driver \u3067 Java \u304b\u3089 MongoDB \u3092\u5229\u7528\u3059\u308b\n\n* CentOS7\n* MongoDB 3.2\n* Java 1.8.0_77\n* Maven 3.3.9\n* MongoDB Java Driver 3.4.1\n\n## MongoDB\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n### \u30ea\u30dd\u30b8\u30c8\u30ea\u306e\u8ffd\u52a0\n\n```\n# vi /etc/yum.repos.d/mongodb-org-3.2.repo\n```\n\n```\n[mongodb-org-3.2]\nname=MongoDB Repository\nbaseurl=https://repo.mongodb.org/yum/redhat/$releasever/mongodb-org/3.2/x86_64/\ngpgcheck=0\nenabled=1\n```\n\n### yum\u3067\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n```\n# yum install mongodb-org\n```\n\n### \u30b5\u30fc\u30d3\u30b9\u306e\u8d77\u52d5\n\n```\n# service mongod start\n```\n\n### \u81ea\u52d5\u8d77\u52d5\u306e\u8a2d\u5b9a\n\n```\n# systemctl enable mongod\n```\n\n### MongoDB shell \u3067\u30c6\u30b9\u30c8\u30c7\u30fc\u30bf\u3092\u8ffd\u52a0\u3057\u3066\u304a\u304f\n\n```\n# mongo\n> use test_db\n> db.test_coll.insert({\"title\":\"test001\",\"data\":\"hogehoge\"})\n```\n\n## Maven\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\u203bjdk\u3092\u4e8b\u524d\u306b\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057JAVA_HOME\u3092\u8a2d\u5b9a\u3057\u3066\u304a\u304f\u3002\n### \u516c\u5f0f\u30b5\u30a4\u30c8\u304b\u3089apache-maven-3.3.9-bin.tar.gz\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3002\n[Maven Download](http://maven.apache.org/download.cgi#)\n### /opt/\u3067\u89e3\u51cd\n\n```\n# cp  apache-maven-3.3.9-bin.tar.gz /opt/\n# cd /opt/\n# tar xzvf apache-maven-3.3.9-bin.tar.gz\n```\n\n### \u74b0\u5883\u5909\u6570\u8a2d\u5b9a\n\n```\n# vi /etc/profile.d/maven.sh\n```\n\n```\nexport M3_HOME=/opt/apache-maven-3.3.9\nM3=$M3_HOME/bin\nexport PATH=$M3:$PATH\n```\n\n```\n# source /etc/profile\n```\n\n```\n# mvn -v\nApache Maven 3.3.9 (bb52d8502b132ec0a5a3f4c09453c07478323dc5; 2015-11-11T01:41:47+09:00)\nMaven home: /opt/apache-maven-3.3.9\nJava version: 1.8.0_77, vendor: Oracle Corporation\nJava home: /usr/java/jdk1.8.0_77/jre\nDefault locale: ja_JP, platform encoding: UTF-8\nOS name: \"linux\", version: \"3.10.0-514.2.2.el7.x86_64\", arch: \"amd64\", family: \"unix\"\n```\n\n## Maven\u306e\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u4f5c\u6210\n### Maven\u306e\u30b3\u30de\u30f3\u30c9\u3067\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u4f5c\u6210\n\n```\n# mvn archetype:generate -DgroupId=com.mycompany.app -DartifactId=my-app -DarchetypeArtifactId=maven-archetype-quickstart -DinteractiveMode=false\n```\n\n```\n# tree\n.\n\u251c\u2500\u2500 pom.xml\n\u2514\u2500\u2500 src\n    \u251c\u2500\u2500 main\n    \u2502\u00a0\u00a0 \u2514\u2500\u2500 java\n    \u2502\u00a0\u00a0     \u2514\u2500\u2500 com\n    \u2502\u00a0\u00a0         \u2514\u2500\u2500 mycompany\n    \u2502\u00a0\u00a0             \u2514\u2500\u2500 app\n    \u2502\u00a0\u00a0                 \u2514\u2500\u2500 App.java\n    \u2514\u2500\u2500 test\n        \u2514\u2500\u2500 java\n            \u2514\u2500\u2500 com\n                \u2514\u2500\u2500 mycompany\n                    \u2514\u2500\u2500 app\n                        \u2514\u2500\u2500 AppTest.java\n\n```\n### pom.xml\u306e\u8a2d\u5b9a\nMaven Assembly Plugin\u3067\u5b9f\u884c\u53ef\u80fdjar\u3092\u4f5c\u308b\n\n```\n  <plugins>\n    <plugin>\n      <artifactId>maven-assembly-plugin</artifactId>\n      <version>3.0.0</version>\n      <configuration>\n        <descriptorRefs>\n          <descriptorRef>jar-with-dependencies</descriptorRef>\n        </descriptorRefs>\n        <archive>\n          <manifest>\n            <mainClass>com.mycompany.app.App</mainClass>\n          </manifest>\n        </archive>\n      </configuration>\n      <executions>\n        <execution>\n          <id>make-assembly</id> <!-- this is used for inheritance merges -->\n          <phase>package</phase> <!-- bind to the packaging phase -->\n          <goals>\n            <goal>single</goal>\n          </goals>\n        </execution>\n      </executions>\n    </plugin>\n  </plugins>\n```\n\nMongoDB Java Driver\u306e\u4f9d\u5b58\u95a2\u4fc2\u306e\u8a2d\u5b9a\n\n```\n  <dependencies>\n    <dependency>\n      <groupId>org.mongodb</groupId>\n      <artifactId>mongo-java-driver</artifactId>\n      <version>3.4.0</version>\n    </dependency>\n  </dependencies>\n```\n\nwarning\u5bfe\u7b56\n\n```\n  <properties>\n    <project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>\n  </properties>\n```\n\n### App.java\u3067MongoDB\u306b\u30a2\u30af\u30bb\u30b9\n\n```\npackage com.mycompany.app;\n\nimport com.mongodb.MongoClient;\nimport com.mongodb.client.MongoCollection;\nimport com.mongodb.client.MongoDatabase;\nimport com.mongodb.client.FindIterable;\nimport com.mongodb.client.MongoCursor;\nimport com.mongodb.BasicDBObject;\nimport org.bson.Document;\n\n/**\n * Hello world!\n *\n */\npublic class App \n{\n    public static void main( String[] args )\n    {\n        String host = \"localhost\";\n        int port = 27017;\n        String databaseName = \"test_db\";\n        String collectionName = \"test_coll\";\n\n        MongoClient mongoClient = new MongoClient(host, port);\n        MongoDatabase database = mongoClient.getDatabase(databaseName);\n        MongoCollection<Document> coll = database.getCollection(collectionName);\n\n        BasicDBObject query = new BasicDBObject();\n        query.put(\"title\", \"test001\");\n        System.out.println(query);\n\n        FindIterable<Document> find = coll.find(query);\n        MongoCursor<Document> cursor = find.iterator();\n        try {\n            while (cursor.hasNext()) {\n                System.out.println(cursor.next().toJson());\n            }\n        } finally {\n            cursor.close();\n        }\n\n        long count = coll.count(query);\n        System.out.println(count + \"\u4ef6\");\n        mongoClient.close();\n    }\n}\n```\n\n### \u30d3\u30eb\u30c9\n\n```\nmvn clean package\n```\n\n### \u5b9f\u884c\n\n```\njava -cp target/my-app-1.0-SNAPSHOT-jar-with-dependencies.jar com.mycompany.app.App\n```\n\n", "tags": ["MongoDB", "Java", "Maven", "centos7"]}