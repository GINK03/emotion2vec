{"context": "\u696d\u52d9\u7cfb\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u4f5c\u308b\u3068\u304d\u306b\u3001\u3044\u3064\u3082\u9762\u5012\u306a\u306e\u3067 bootstrap \u3067\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u3092\u4f5c\u3063\u3066\u304a\u3044\u305f\u3002\n\u4e38\u3054\u3068\u30d7\u30e9\u30b0\u30a4\u30f3\u306b\u3057\u3088\u3046\u3068\u3044\u3046\u306e\u306f\u7121\u7406\u3060\u3063\u305f\u3067\u3059\u2026\u3002\n\n\nindex.php\n<!DOCTYPE HTML>\n<html lang=\"ja\">\n    <head>\n        <meta charset=\"UTF-8\">\n        <title>\u898b\u7a4d\u3082\u308a\u5165\u529b\u30d5\u30a9\u30fc\u30e0\u30fb\u30b5\u30f3\u30d7\u30eb</title>\n        <meta content=\"width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no\" name=\"viewport\">\n        <link rel=\"stylesheet\" href=\"https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css\">\n        <link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css\">\n        <style type=\"text/css\">\n            body {\n                background: #F9F9F9;\n            }\n            .wrapper {\n                width: 100%;\n            }\n            .content-wrapper {\n                width: 100%;\n                margin: 0 auto;\n            }\n            .content {\n                width: 75%;\n                margin: 0 auto;\n            }\n            .form-horizontal {\n                margin: 2em 3em;\n            }\n            .form-header {\n                margin: 1em 0;\n            }\n            .form-horizontal table caption {\n                color: #FFF;\n                background-color: #CCC;\n                margin: 2em 0;\n                padding: 0.5em 2em;\n            }\n        </style>\n    </head>\n    <body>\n        <div class=\"wrapper\">\n            <div class=\"content-wrapper\">\n                <section class=\"content\">\n                    <form action=\"\" method=\"post\" class=\"form-horizontal\" class=\"estimate\">\n\n                        <h2 class=\"form-header\">\u898b\u7a4d\u4f5c\u6210\u30d5\u30a9\u30fc\u30e0</h2>\n\n                        <div class=\"row\">\n                            <div class=\"col-md-8\">\n                                <div class=\"form-group\">\n                                    <label for=\"client-name\" class=\"col-sm-2 control-label\">\u5b9b\u5148</label>\n                                    <div class=\"col-sm-10\">\n                                        <input type=\"text\" name=\"client_name\" class=\"form-control\" id=\"client-name\" placeholder=\"\u5b9b\u5148\">\n                                    </div>\n                                </div>\n\n                                <div class=\"form-group\">\n                                    <label for=\"client-name\" class=\"col-sm-2 control-label\">\u6d88\u8cbb\u7a0e\u7387</label>\n                                    <div class=\"col-sm-5\">\n                                        <div class=\"input-group\">\n                                            <input type=\"text\" name=\"tax_rate\" class=\"form-control\" data-format=\"number\" readonly=\"readonly\" value=\"8\">\n                                            <span class=\"input-group-addon\">\n                                                <span class=\"fa fa-percent\"></span>\n                                            </span>\n                                        </div>\n                                    </div>\n                                </div>\n\n                                <div class=\"form-group\">\n                                    <label for=\"client-name\" class=\"col-sm-2 control-label\">\u8a08\u7b97\u65b9\u6cd5</label>\n                                    <div class=\"col-sm-10\">\n                                        <div class=\"radio\">\n                                            <label>\n                                                <input type=\"radio\" name=\"tax_calc_type\" value=\"1\" checked=\"checked\">\n                                                \u660e\u7d30\u3054\u3068\u306b\u7a0e\u91d1\u3092\u7b97\u51fa\u3059\u308b\n                                            </label>\n                                        </div>\n                                        <div class=\"radio\">\n                                            <label>\n                                                <input type=\"radio\" name=\"tax_calc_type\" value=\"2\">\n                                                \u7dcf\u5408\u8a08\u306b\u7a0e\u91d1\u3092\u7b97\u51fa\u3059\u308b\n                                            </label>\n                                        </div>\n                                    </div>\n                                </div>\n                            </div>\n                        </div>\n\n                        <table class=\"table\">\n\n                            <caption>\u660e\u7d30</caption>\n\n                            <col width=\"40\" />\n                            <col width=\"240\" />\n                            <col width=\"180\" />\n                            <col width=\"\" />\n                            <col width=\"\" />\n\n                            <thead>\n                                <tr>\n                                    <th>#</th>\n                                    <th>\u540d\u79f0</th>\n                                    <th>\u6570\u91cf</th>\n                                    <th>\u5358\u4fa1</th>\n                                    <th>\u8a08</th>\n                                </tr>\n                            </thead>\n                            <tfoot>\n                                <tr>\n                                    <th>&nbsp;</th>\n                                    <th>\n                                        <button type=\"button\" class=\"btn btn-default\" id=\"add_field\">\u30d5\u30a3\u30fc\u30eb\u30c9\u306e\u8ffd\u52a0</button>\n                                    </th>\n                                    <th>&nbsp;</th>\n                                    <th>\n                                        <div class=\"input-group\">\n                                            <span class=\"input-group-addon\" id=\"basic-addon1\">\u7a0e\u629c</span>\n                                            <input type=\"text\" class=\"form-control\" id=\"total-ex-tax\" readonly=\"readonly\" data-format=\"number\">\n                                        </div>\n                                    </th>\n                                    <th>\n                                        <div class=\"input-group\">\n                                            <span class=\"input-group-addon\" id=\"basic-addon1\">\u7a0e\u8fbc</span>\n                                            <input type=\"text\" class=\"form-control\" id=\"total\" readonly=\"readonly\" data-format=\"number\">\n                                        </div>\n                                    </th>\n                                </tr>\n                                <tr>\n                                    <th colspan=\"5\">\n                                        <button class=\"btn btn-primary\">\u767b\u9332</button>\n                                    </th>\n                                </tr>\n                            </tfoot>\n                            <tbody>\n                            </tbody>\n                        </table>\n                    </form>\n                </section>\n            </div>\n        </div>\n        <script src=\"//code.jquery.com/jquery-3.1.1.min.js\"></script>\n        <script src=\"//maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js\"></script>\n        <script src=\"jquery.number-format.js\"></script>\n        <script>\n            $(function () {\n\n                /*\n                 * \u660e\u7d30\u3092\u8ffd\u52a0\u3059\u308b\n                 */\n                var add_row = function () {\n\n                    // \u756a\u53f7\n                    var num = $('tbody > tr').length;\n                    if (num >= count_max_forms) {\n                        return;\n                    }\n\n                    // \u5358\u4f4d\n                    var unit_arr = ['\u500b', '\u5f0f'];\n                    // \u660e\u7d30\u5404\u884c\u306eHTML\u69cb\u9020\n                    var html_detail = $('<tr>');\n                    html_detail.appendTo('tbody');\n                    // \u5217\u8a2d\u5b9a\n                    var tds = [];\n                    tds[0] = $('<td>').text('#' + (num + 1).toString());\n                    // \u540d\u79f0\n                    tds[1] = $('<td>');\n                    var input_text_itemname = $('<input>')\n                            .prop({\n                                'type': 'text'\n                                , 'name': 'item[]'\n                            })\n                            .addClass('form-control item')\n                            .attr({\n                                'placeholder': '\u540d\u79f0'\n                            })\n                            .appendTo(tds[1]);\n                    // \u6570\u91cf\n                    tds[2] = $('<td>');\n                    var input_group_quantity = $('<div>')\n                            .addClass('input-group')\n                            .appendTo(tds[2]);\n                    var input_text_quantity = $('<input>')\n                            .prop({\n                                'type': 'text'\n                                , 'name': 'quantity[]'\n                            })\n                            .addClass('form-control quantity')\n                            .attr({\n                                'data-format': 'number'\n                            })\n                            .appendTo(input_group_quantity);\n                    var input_hidden_unit = $('<input>')\n                            .prop({\n                                'type': 'hidden'\n                                , 'name': 'unit[]'\n                            })\n                            .addClass('unit')\n                            .appendTo(input_group_quantity);\n                    var div_input_group_btn = $('<div>')\n                            .addClass('input-group-btn')\n                            .appendTo(input_group_quantity);\n                    var button_toggle = $('<button>')\n                            .addClass(\"btn btn-default dropdown-toggle\")\n                            .attr({\n                                'data-toggle': 'dropdown'\n                                , 'aria-haspopup': 'true'\n                                , 'aria-expanded': 'false'\n                            })\n                            .append($('<span>').text('\u500b'))\n                            .append('&nbsp;')\n                            .appendTo(div_input_group_btn);\n                    var span_caret = $('<span>')\n                            .addClass('caret')\n                            .appendTo(button_toggle);\n                    var ul_dropdown_menu = $('<ul>')\n                            .addClass('dropdown-menu')\n                            .appendTo(div_input_group_btn);\n                    var li_unit = [];\n                    var li_unit_a = [];\n                    $.each(unit_arr, function (i, obj) {\n                        li_unit[i] = $('<li>')\n                                .appendTo(ul_dropdown_menu);\n                        li_unit_a[i] = $('<a>')\n                                .text(obj)\n                                .appendTo(li_unit[i])\n                                .on('click', function () {\n                                    input_hidden_unit.val(obj);\n                                    button_toggle.find('span:first').text(obj);\n                                });\n                        ;\n                        if (i < unit_arr.length - 1) {\n                            $('<li>').attr('role', 'separator')\n                                    .addClass('divider')\n                                    .appendTo(li_unit[i]);\n                        }\n                    });\n\n\n                    // \u5358\u4fa1\n                    tds[3] = $('<td>');\n                    var input_group_price = $('<div>')\n                            .addClass('input-group')\n                            .appendTo(tds[3]);\n                    var span_input_group_addon = $('<span>')\n                            .addClass('input-group-addon')\n                            .append($('<span>').addClass('fa fa-yen'))\n                            .appendTo(input_group_price);\n                    var input_text_price = $('<input>')\n                            .prop({\n                                'type': 'text'\n                                , 'name': 'price[]'\n                            })\n                            .attr({\n                                'data-format': 'number'\n                            })\n                            .addClass('form-control price')\n                            .appendTo(input_group_price);\n                    // \u5c0f\u8a08\n                    tds[4] = $('<td>');\n                    var input_group_sum_detail = $('<div>')\n                            .addClass('input-group')\n                            .append(span_input_group_addon.clone())\n                            .appendTo(tds[4]);\n                    var input_text_sum_detail = $('<input>')\n                            .prop({\n                                'type': 'text'\n                                , 'name': 'sum_detail[]'\n                            })\n                            .attr({\n                                'data-format': 'number'\n                                , 'readonly': true\n                            })\n                            .addClass('form-control sum_detail')\n                            .appendTo(input_group_sum_detail);\n\n                    // td > tr \u8ffd\u52a0\n                    html_detail.append(tds);\n                };\n                /*\n                 * \u8907\u6570\u306e\u660e\u7d30\u3092\u8ffd\u52a0\u3059\u308b\n                 */\n                var add_rows = function (count) {\n                    var num = 0;\n                    while (num < count && num < count_max_forms) {\n                        add_row();\n                        num = $('tbody tr').length;\n                    }\n                    calc_rows();\n                };\n                // \u660e\u7d301\u884c\u306e\u8a08\u7b97\n                var calc_row = function (i) {\n                    if ($('tbody tr').length === 0) {\n                        return 0;\n                    }\n\n                    var quantity = $('tbody tr').eq(i).find('.quantity');\n                    var q = (quantity.attr('data-value')) ? quantity.attr('data-value') : 0;\n\n                    var price = $('tbody tr').eq(i).find('.price');\n                    var p = (price.attr('data-value')) ? price.attr('data-value') : 0;\n\n                    var sum = q * p;\n                    return sum;\n                };\n\n                var calc_tax = function (num) {\n                    return Math.floor(tax_rate * num);\n                };\n\n                var calc_rows = function () {\n                    var i = 0;\n                    var sum = 0;\n                    var sum_t = 0;\n                    while (i < $('tbody tr').length) {\n                        var d = 0;\n                        var dt = 0;\n                        d = calc_row(i);\n                        dt = calc_tax(calc_row(i));\n                        if (tax_calc_type.toString() === '1') {\n                            d = calc_row(i);\n                            dt = calc_tax(calc_row(i));\n                        } else if (tax_calc_type.toString() === '2') {\n                            d = calc_row(i);\n                            dt = calc_tax(calc_row(i));\n                        }\n                        sum_t += dt;\n                        sum += d;\n                        $('tbody tr').eq(i).find('.sum_detail')\n                                .val(number_format((tax_calc_type.toString() === '1') ? dt : d));\n                        i++;\n                    }\n                    $('#total-ex-tax').val(number_format(sum));\n                    $('#total').val(number_format((tax_calc_type === '1') ? calc_tax(sum) : sum_t));\n                };\n\n                var number_format = function (num) {\n                    var val = num.toString().replace(',', '');\n                    var formattedVal = val.replace(/(\\d)(?=(?:\\d{3}){2,}(?:\\.|$))|(\\d)(\\d{3}(?:\\.\\d*)?$)/g\n                            , '$1$2,$3');\n                    return formattedVal;\n                };\n\n                // \u7a0e\u7387\n                var tax_rate = $('[name=tax_rate]').val() / 100 + 1;\n                // \u30ed\u30fc\u30c9\u6642\u306b\u8868\u793a\u3059\u308b\u660e\u7d30\u30d5\u30a9\u30fc\u30e0\u306e\u884c\u6570\n                var count_forms = 4;\n                // \u660e\u7d30\u30d5\u30a9\u30fc\u30eb\u306e\u6700\u5927\u6570\n                var count_max_forms = 20;\n                // \u7a0e\u91d1\u8a08\u7b97\u65b9\u6cd5\n                var tax_calc_type = 1;\n                // \u521d\u671f\u8868\u793a\n                add_rows(count_forms);\n                // \u30d5\u30a3\u30fc\u30eb\u30c9\u8ffd\u52a0\n                $('#add_field').on('click', function () {\n                    add_row();\n                });\n\n                // \u30ab\u30f3\u30de\u533a\u5207\n                $('[data-format=number]')\n                        .numberformat()\n                        .on('change', function () {\n                            calc_rows();\n                        });\n\n                $('[name=tax_calc_type]').on('click', function () {\n                    // \u7a0e\u91d1\u8a08\u7b97\u65b9\u6cd5\n                    tax_calc_type = $(this).val();\n                    calc_rows();\n                });\n        </script>\n    </body>\n</html>\n\n\n\njquery.number-format.js\n/*!\n jquery.number-format.js\n\n This software is released under the MIT License\n http://opensource.org/licenses/mit-license.php\n */\n(function ($) {\n\n    $.fn.numberformat = function (options) {\n\n        // option\n        var setting = $.extend({\n            align: 'right',\n            separator: ','\n        }, options);\n\n        // make the string formatted on changed\n        this.change(function () {\n            var val = $(this).val().toString()\n                    .replace(setting.separator, '');\n            var formattedVal = val.replace(/(\\d)(?=(?:\\d{3}){2,}(?:\\.|$))|(\\d)(\\d{3}(?:\\.\\d*)?$)/g\n                    , '$1$2' + setting.separator + '$3');\n            $(this).val(formattedVal)\n                    .css({\n                        textAlign: setting.align\n                    })\n                    .attr('data-value', val);\n        }).change();\n\n        // Move caret to end of string on focused\n        this.focus(function () {\n            var val = $(this).val();\n            $(this).val('').val(val);\n        });\n\n        // Remove comma on submit\n        this.parents('form').submit(function () {\n            var input = $(this).find('input');\n            input.each(function () {\n                var val = $(this).val().replace(setting.separator, '');\n                $(this).val(val);\n            });\n        });\n\n        return this;\n    };\n})(jQuery);\n\n\n\n\u696d\u52d9\u7cfb\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u4f5c\u308b\u3068\u304d\u306b\u3001\u3044\u3064\u3082\u9762\u5012\u306a\u306e\u3067 bootstrap \u3067\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u3092\u4f5c\u3063\u3066\u304a\u3044\u305f\u3002\n\u4e38\u3054\u3068\u30d7\u30e9\u30b0\u30a4\u30f3\u306b\u3057\u3088\u3046\u3068\u3044\u3046\u306e\u306f\u7121\u7406\u3060\u3063\u305f\u3067\u3059\u2026\u3002\n\n![localhost_2017-03-08_00-03-39.png](https://qiita-image-store.s3.amazonaws.com/0/46841/a7ead6db-580c-f2fa-b456-53aadaf8a880.png \"localhost_2017-03-08_00-03-39.png\")\n\n\n```php:index.php\n<!DOCTYPE HTML>\n<html lang=\"ja\">\n\t<head>\n\t\t<meta charset=\"UTF-8\">\n        <title>\u898b\u7a4d\u3082\u308a\u5165\u529b\u30d5\u30a9\u30fc\u30e0\u30fb\u30b5\u30f3\u30d7\u30eb</title>\n\t\t<meta content=\"width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no\" name=\"viewport\">\n\t\t<link rel=\"stylesheet\" href=\"https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css\">\n\t\t<link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css\">\n\t\t<style type=\"text/css\">\n\t\t\tbody {\n\t\t\t\tbackground: #F9F9F9;\n\t\t\t}\n\t\t\t.wrapper {\n\t\t\t\twidth: 100%;\n\t\t\t}\n\t\t\t.content-wrapper {\n\t\t\t\twidth: 100%;\n\t\t\t\tmargin: 0 auto;\n\t\t\t}\n\t\t\t.content {\n\t\t\t\twidth: 75%;\n\t\t\t\tmargin: 0 auto;\n\t\t\t}\n\t\t\t.form-horizontal {\n\t\t\t\tmargin: 2em 3em;\n\t\t\t}\n\t\t\t.form-header {\n\t\t\t\tmargin: 1em 0;\n\t\t\t}\n\t\t\t.form-horizontal table caption {\n\t\t\t\tcolor: #FFF;\n\t\t\t\tbackground-color: #CCC;\n\t\t\t\tmargin: 2em 0;\n\t\t\t\tpadding: 0.5em 2em;\n\t\t\t}\n\t\t</style>\n\t</head>\n\t<body>\n\t\t<div class=\"wrapper\">\n\t\t\t<div class=\"content-wrapper\">\n\t\t\t\t<section class=\"content\">\n\t\t\t\t\t<form action=\"\" method=\"post\" class=\"form-horizontal\" class=\"estimate\">\n\n\t\t\t\t\t\t<h2 class=\"form-header\">\u898b\u7a4d\u4f5c\u6210\u30d5\u30a9\u30fc\u30e0</h2>\n\n\t\t\t\t\t\t<div class=\"row\">\n\t\t\t\t\t\t\t<div class=\"col-md-8\">\n\t\t\t\t\t\t\t\t<div class=\"form-group\">\n\t\t\t\t\t\t\t\t\t<label for=\"client-name\" class=\"col-sm-2 control-label\">\u5b9b\u5148</label>\n\t\t\t\t\t\t\t\t\t<div class=\"col-sm-10\">\n\t\t\t\t\t\t\t\t\t\t<input type=\"text\" name=\"client_name\" class=\"form-control\" id=\"client-name\" placeholder=\"\u5b9b\u5148\">\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t\t<div class=\"form-group\">\n\t\t\t\t\t\t\t\t\t<label for=\"client-name\" class=\"col-sm-2 control-label\">\u6d88\u8cbb\u7a0e\u7387</label>\n\t\t\t\t\t\t\t\t\t<div class=\"col-sm-5\">\n\t\t\t\t\t\t\t\t\t\t<div class=\"input-group\">\n\t\t\t\t\t\t\t\t\t\t\t<input type=\"text\" name=\"tax_rate\" class=\"form-control\" data-format=\"number\" readonly=\"readonly\" value=\"8\">\n\t\t\t\t\t\t\t\t\t\t\t<span class=\"input-group-addon\">\n\t\t\t\t\t\t\t\t\t\t\t\t<span class=\"fa fa-percent\"></span>\n\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t\t<div class=\"form-group\">\n\t\t\t\t\t\t\t\t\t<label for=\"client-name\" class=\"col-sm-2 control-label\">\u8a08\u7b97\u65b9\u6cd5</label>\n\t\t\t\t\t\t\t\t\t<div class=\"col-sm-10\">\n\t\t\t\t\t\t\t\t\t\t<div class=\"radio\">\n\t\t\t\t\t\t\t\t\t\t\t<label>\n\t\t\t\t\t\t\t\t\t\t\t\t<input type=\"radio\" name=\"tax_calc_type\" value=\"1\" checked=\"checked\">\n\t\t\t\t\t\t\t\t\t\t\t\t\u660e\u7d30\u3054\u3068\u306b\u7a0e\u91d1\u3092\u7b97\u51fa\u3059\u308b\n\t\t\t\t\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t<div class=\"radio\">\n\t\t\t\t\t\t\t\t\t\t\t<label>\n\t\t\t\t\t\t\t\t\t\t\t\t<input type=\"radio\" name=\"tax_calc_type\" value=\"2\">\n\t\t\t\t\t\t\t\t\t\t\t\t\u7dcf\u5408\u8a08\u306b\u7a0e\u91d1\u3092\u7b97\u51fa\u3059\u308b\n\t\t\t\t\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<table class=\"table\">\n\n\t\t\t\t\t\t\t<caption>\u660e\u7d30</caption>\n\n\t\t\t\t\t\t\t<col width=\"40\" />\n\t\t\t\t\t\t\t<col width=\"240\" />\n\t\t\t\t\t\t\t<col width=\"180\" />\n\t\t\t\t\t\t\t<col width=\"\" />\n\t\t\t\t\t\t\t<col width=\"\" />\n\n\t\t\t\t\t\t\t<thead>\n\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t<th>#</th>\n\t\t\t\t\t\t\t\t\t<th>\u540d\u79f0</th>\n\t\t\t\t\t\t\t\t\t<th>\u6570\u91cf</th>\n\t\t\t\t\t\t\t\t\t<th>\u5358\u4fa1</th>\n\t\t\t\t\t\t\t\t\t<th>\u8a08</th>\n\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t</thead>\n\t\t\t\t\t\t\t<tfoot>\n\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t<th>&nbsp;</th>\n\t\t\t\t\t\t\t\t\t<th>\n\t\t\t\t\t\t\t\t\t\t<button type=\"button\" class=\"btn btn-default\" id=\"add_field\">\u30d5\u30a3\u30fc\u30eb\u30c9\u306e\u8ffd\u52a0</button>\n\t\t\t\t\t\t\t\t\t</th>\n\t\t\t\t\t\t\t\t\t<th>&nbsp;</th>\n\t\t\t\t\t\t\t\t\t<th>\n\t\t\t\t\t\t\t\t\t\t<div class=\"input-group\">\n\t\t\t\t\t\t\t\t\t\t\t<span class=\"input-group-addon\" id=\"basic-addon1\">\u7a0e\u629c</span>\n\t\t\t\t\t\t\t\t\t\t\t<input type=\"text\" class=\"form-control\" id=\"total-ex-tax\" readonly=\"readonly\" data-format=\"number\">\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</th>\n\t\t\t\t\t\t\t\t\t<th>\n\t\t\t\t\t\t\t\t\t\t<div class=\"input-group\">\n\t\t\t\t\t\t\t\t\t\t\t<span class=\"input-group-addon\" id=\"basic-addon1\">\u7a0e\u8fbc</span>\n\t\t\t\t\t\t\t\t\t\t\t<input type=\"text\" class=\"form-control\" id=\"total\" readonly=\"readonly\" data-format=\"number\">\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</th>\n\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t<th colspan=\"5\">\n\t\t\t\t\t\t\t\t\t\t<button class=\"btn btn-primary\">\u767b\u9332</button>\n\t\t\t\t\t\t\t\t\t</th>\n\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t</tfoot>\n\t\t\t\t\t\t\t<tbody>\n\t\t\t\t\t\t\t</tbody>\n\t\t\t\t\t\t</table>\n\t\t\t\t\t</form>\n\t\t\t\t</section>\n\t\t\t</div>\n\t\t</div>\n\t\t<script src=\"//code.jquery.com/jquery-3.1.1.min.js\"></script>\n\t\t<script src=\"//maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js\"></script>\n\t\t<script src=\"jquery.number-format.js\"></script>\n\t\t<script>\n\t\t\t$(function () {\n\n\t\t\t\t/*\n\t\t\t\t * \u660e\u7d30\u3092\u8ffd\u52a0\u3059\u308b\n\t\t\t\t */\n\t\t\t\tvar add_row = function () {\n\n\t\t\t\t\t// \u756a\u53f7\n\t\t\t\t\tvar num = $('tbody > tr').length;\n\t\t\t\t\tif (num >= count_max_forms) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\t// \u5358\u4f4d\n\t\t\t\t\tvar unit_arr = ['\u500b', '\u5f0f'];\n\t\t\t\t\t// \u660e\u7d30\u5404\u884c\u306eHTML\u69cb\u9020\n\t\t\t\t\tvar html_detail = $('<tr>');\n\t\t\t\t\thtml_detail.appendTo('tbody');\n\t\t\t\t\t// \u5217\u8a2d\u5b9a\n\t\t\t\t\tvar tds = [];\n\t\t\t\t\ttds[0] = $('<td>').text('#' + (num + 1).toString());\n\t\t\t\t\t// \u540d\u79f0\n\t\t\t\t\ttds[1] = $('<td>');\n\t\t\t\t\tvar input_text_itemname = $('<input>')\n\t\t\t\t\t\t\t.prop({\n\t\t\t\t\t\t\t\t'type': 'text'\n\t\t\t\t\t\t\t\t, 'name': 'item[]'\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t.addClass('form-control item')\n\t\t\t\t\t\t\t.attr({\n\t\t\t\t\t\t\t\t'placeholder': '\u540d\u79f0'\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t.appendTo(tds[1]);\n\t\t\t\t\t// \u6570\u91cf\n\t\t\t\t\ttds[2] = $('<td>');\n\t\t\t\t\tvar input_group_quantity = $('<div>')\n\t\t\t\t\t\t\t.addClass('input-group')\n\t\t\t\t\t\t\t.appendTo(tds[2]);\n\t\t\t\t\tvar input_text_quantity = $('<input>')\n\t\t\t\t\t\t\t.prop({\n\t\t\t\t\t\t\t\t'type': 'text'\n\t\t\t\t\t\t\t\t, 'name': 'quantity[]'\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t.addClass('form-control quantity')\n\t\t\t\t\t\t\t.attr({\n\t\t\t\t\t\t\t\t'data-format': 'number'\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t.appendTo(input_group_quantity);\n\t\t\t\t\tvar input_hidden_unit = $('<input>')\n\t\t\t\t\t\t\t.prop({\n\t\t\t\t\t\t\t\t'type': 'hidden'\n\t\t\t\t\t\t\t\t, 'name': 'unit[]'\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t.addClass('unit')\n\t\t\t\t\t\t\t.appendTo(input_group_quantity);\n\t\t\t\t\tvar div_input_group_btn = $('<div>')\n\t\t\t\t\t\t\t.addClass('input-group-btn')\n\t\t\t\t\t\t\t.appendTo(input_group_quantity);\n\t\t\t\t\tvar button_toggle = $('<button>')\n\t\t\t\t\t\t\t.addClass(\"btn btn-default dropdown-toggle\")\n\t\t\t\t\t\t\t.attr({\n\t\t\t\t\t\t\t\t'data-toggle': 'dropdown'\n\t\t\t\t\t\t\t\t, 'aria-haspopup': 'true'\n\t\t\t\t\t\t\t\t, 'aria-expanded': 'false'\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t.append($('<span>').text('\u500b'))\n\t\t\t\t\t\t\t.append('&nbsp;')\n\t\t\t\t\t\t\t.appendTo(div_input_group_btn);\n\t\t\t\t\tvar span_caret = $('<span>')\n\t\t\t\t\t\t\t.addClass('caret')\n\t\t\t\t\t\t\t.appendTo(button_toggle);\n\t\t\t\t\tvar ul_dropdown_menu = $('<ul>')\n\t\t\t\t\t\t\t.addClass('dropdown-menu')\n\t\t\t\t\t\t\t.appendTo(div_input_group_btn);\n\t\t\t\t\tvar li_unit = [];\n\t\t\t\t\tvar li_unit_a = [];\n\t\t\t\t\t$.each(unit_arr, function (i, obj) {\n\t\t\t\t\t\tli_unit[i] = $('<li>')\n\t\t\t\t\t\t\t\t.appendTo(ul_dropdown_menu);\n\t\t\t\t\t\tli_unit_a[i] = $('<a>')\n\t\t\t\t\t\t\t\t.text(obj)\n\t\t\t\t\t\t\t\t.appendTo(li_unit[i])\n\t\t\t\t\t\t\t\t.on('click', function () {\n\t\t\t\t\t\t\t\t\tinput_hidden_unit.val(obj);\n\t\t\t\t\t\t\t\t\tbutton_toggle.find('span:first').text(obj);\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t;\n\t\t\t\t\t\tif (i < unit_arr.length - 1) {\n\t\t\t\t\t\t\t$('<li>').attr('role', 'separator')\n\t\t\t\t\t\t\t\t\t.addClass('divider')\n\t\t\t\t\t\t\t\t\t.appendTo(li_unit[i]);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\n\t\t\t\t\t// \u5358\u4fa1\n\t\t\t\t\ttds[3] = $('<td>');\n\t\t\t\t\tvar input_group_price = $('<div>')\n\t\t\t\t\t\t\t.addClass('input-group')\n\t\t\t\t\t\t\t.appendTo(tds[3]);\n\t\t\t\t\tvar span_input_group_addon = $('<span>')\n\t\t\t\t\t\t\t.addClass('input-group-addon')\n\t\t\t\t\t\t\t.append($('<span>').addClass('fa fa-yen'))\n\t\t\t\t\t\t\t.appendTo(input_group_price);\n\t\t\t\t\tvar input_text_price = $('<input>')\n\t\t\t\t\t\t\t.prop({\n\t\t\t\t\t\t\t\t'type': 'text'\n\t\t\t\t\t\t\t\t, 'name': 'price[]'\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t.attr({\n\t\t\t\t\t\t\t\t'data-format': 'number'\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t.addClass('form-control price')\n\t\t\t\t\t\t\t.appendTo(input_group_price);\n\t\t\t\t\t// \u5c0f\u8a08\n\t\t\t\t\ttds[4] = $('<td>');\n\t\t\t\t\tvar input_group_sum_detail = $('<div>')\n\t\t\t\t\t\t\t.addClass('input-group')\n\t\t\t\t\t\t\t.append(span_input_group_addon.clone())\n\t\t\t\t\t\t\t.appendTo(tds[4]);\n\t\t\t\t\tvar input_text_sum_detail = $('<input>')\n\t\t\t\t\t\t\t.prop({\n\t\t\t\t\t\t\t\t'type': 'text'\n\t\t\t\t\t\t\t\t, 'name': 'sum_detail[]'\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t.attr({\n\t\t\t\t\t\t\t\t'data-format': 'number'\n\t\t\t\t\t\t\t\t, 'readonly': true\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t.addClass('form-control sum_detail')\n\t\t\t\t\t\t\t.appendTo(input_group_sum_detail);\n\n\t\t\t\t\t// td > tr \u8ffd\u52a0\n\t\t\t\t\thtml_detail.append(tds);\n\t\t\t\t};\n\t\t\t\t/*\n\t\t\t\t * \u8907\u6570\u306e\u660e\u7d30\u3092\u8ffd\u52a0\u3059\u308b\n\t\t\t\t */\n\t\t\t\tvar add_rows = function (count) {\n\t\t\t\t\tvar num = 0;\n\t\t\t\t\twhile (num < count && num < count_max_forms) {\n\t\t\t\t\t\tadd_row();\n\t\t\t\t\t\tnum = $('tbody tr').length;\n\t\t\t\t\t}\n\t\t\t\t\tcalc_rows();\n\t\t\t\t};\n\t\t\t\t// \u660e\u7d301\u884c\u306e\u8a08\u7b97\n\t\t\t\tvar calc_row = function (i) {\n\t\t\t\t\tif ($('tbody tr').length === 0) {\n\t\t\t\t\t\treturn 0;\n\t\t\t\t\t}\n\n\t\t\t\t\tvar quantity = $('tbody tr').eq(i).find('.quantity');\n\t\t\t\t\tvar q = (quantity.attr('data-value')) ? quantity.attr('data-value') : 0;\n\n\t\t\t\t\tvar price = $('tbody tr').eq(i).find('.price');\n\t\t\t\t\tvar p = (price.attr('data-value')) ? price.attr('data-value') : 0;\n\n\t\t\t\t\tvar sum = q * p;\n\t\t\t\t\treturn sum;\n\t\t\t\t};\n\n\t\t\t\tvar calc_tax = function (num) {\n\t\t\t\t\treturn Math.floor(tax_rate * num);\n\t\t\t\t};\n\n\t\t\t\tvar calc_rows = function () {\n\t\t\t\t\tvar i = 0;\n\t\t\t\t\tvar sum = 0;\n\t\t\t\t\tvar sum_t = 0;\n\t\t\t\t\twhile (i < $('tbody tr').length) {\n\t\t\t\t\t\tvar d = 0;\n\t\t\t\t\t\tvar dt = 0;\n\t\t\t\t\t\td = calc_row(i);\n\t\t\t\t\t\tdt = calc_tax(calc_row(i));\n\t\t\t\t\t\tif (tax_calc_type.toString() === '1') {\n\t\t\t\t\t\t\td = calc_row(i);\n\t\t\t\t\t\t\tdt = calc_tax(calc_row(i));\n\t\t\t\t\t\t} else if (tax_calc_type.toString() === '2') {\n\t\t\t\t\t\t\td = calc_row(i);\n\t\t\t\t\t\t\tdt = calc_tax(calc_row(i));\n\t\t\t\t\t\t}\n\t\t\t\t\t\tsum_t += dt;\n\t\t\t\t\t\tsum += d;\n\t\t\t\t\t\t$('tbody tr').eq(i).find('.sum_detail')\n\t\t\t\t\t\t\t\t.val(number_format((tax_calc_type.toString() === '1') ? dt : d));\n\t\t\t\t\t\ti++;\n\t\t\t\t\t}\n\t\t\t\t\t$('#total-ex-tax').val(number_format(sum));\n\t\t\t\t\t$('#total').val(number_format((tax_calc_type === '1') ? calc_tax(sum) : sum_t));\n\t\t\t\t};\n\n\t\t\t\tvar number_format = function (num) {\n\t\t\t\t\tvar val = num.toString().replace(',', '');\n\t\t\t\t\tvar formattedVal = val.replace(/(\\d)(?=(?:\\d{3}){2,}(?:\\.|$))|(\\d)(\\d{3}(?:\\.\\d*)?$)/g\n\t\t\t\t\t\t\t, '$1$2,$3');\n\t\t\t\t\treturn formattedVal;\n\t\t\t\t};\n\n\t\t\t\t// \u7a0e\u7387\n\t\t\t\tvar tax_rate = $('[name=tax_rate]').val() / 100 + 1;\n\t\t\t\t// \u30ed\u30fc\u30c9\u6642\u306b\u8868\u793a\u3059\u308b\u660e\u7d30\u30d5\u30a9\u30fc\u30e0\u306e\u884c\u6570\n\t\t\t\tvar count_forms = 4;\n\t\t\t\t// \u660e\u7d30\u30d5\u30a9\u30fc\u30eb\u306e\u6700\u5927\u6570\n\t\t\t\tvar count_max_forms = 20;\n\t\t\t\t// \u7a0e\u91d1\u8a08\u7b97\u65b9\u6cd5\n\t\t\t\tvar tax_calc_type = 1;\n\t\t\t\t// \u521d\u671f\u8868\u793a\n\t\t\t\tadd_rows(count_forms);\n\t\t\t\t// \u30d5\u30a3\u30fc\u30eb\u30c9\u8ffd\u52a0\n\t\t\t\t$('#add_field').on('click', function () {\n\t\t\t\t\tadd_row();\n\t\t\t\t});\n\n\t\t\t\t// \u30ab\u30f3\u30de\u533a\u5207\n\t\t\t\t$('[data-format=number]')\n\t\t\t\t\t\t.numberformat()\n\t\t\t\t\t\t.on('change', function () {\n\t\t\t\t\t\t\tcalc_rows();\n\t\t\t\t\t\t});\n\n\t\t\t\t$('[name=tax_calc_type]').on('click', function () {\n\t\t\t\t\t// \u7a0e\u91d1\u8a08\u7b97\u65b9\u6cd5\n\t\t\t\t\ttax_calc_type = $(this).val();\n\t\t\t\t\tcalc_rows();\n\t\t\t\t});\n\t\t</script>\n\t</body>\n</html>\n```\n\n```javascript:jquery.number-format.js\n/*!\n jquery.number-format.js\n\n This software is released under the MIT License\n http://opensource.org/licenses/mit-license.php\n */\n(function ($) {\n\n\t$.fn.numberformat = function (options) {\n\n\t\t// option\n\t\tvar setting = $.extend({\n\t\t\talign: 'right',\n\t\t\tseparator: ','\n\t\t}, options);\n\n\t\t// make the string formatted on changed\n\t\tthis.change(function () {\n\t\t\tvar val = $(this).val().toString()\n\t\t\t\t\t.replace(setting.separator, '');\n\t\t\tvar formattedVal = val.replace(/(\\d)(?=(?:\\d{3}){2,}(?:\\.|$))|(\\d)(\\d{3}(?:\\.\\d*)?$)/g\n\t\t\t\t\t, '$1$2' + setting.separator + '$3');\n\t\t\t$(this).val(formattedVal)\n\t\t\t\t\t.css({\n\t\t\t\t\t\ttextAlign: setting.align\n\t\t\t\t\t})\n\t\t\t\t\t.attr('data-value', val);\n\t\t}).change();\n\n\t\t// Move caret to end of string on focused\n\t\tthis.focus(function () {\n\t\t\tvar val = $(this).val();\n\t\t\t$(this).val('').val(val);\n\t\t});\n\n\t\t// Remove comma on submit\n\t\tthis.parents('form').submit(function () {\n\t\t\tvar input = $(this).find('input');\n\t\t\tinput.each(function () {\n\t\t\t\tvar val = $(this).val().replace(setting.separator, '');\n\t\t\t\t$(this).val(val);\n\t\t\t});\n\t\t});\n\n\t\treturn this;\n\t};\n})(jQuery);\n```\n", "tags": ["jQuery", "\u898b\u7a4d", "\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8"]}