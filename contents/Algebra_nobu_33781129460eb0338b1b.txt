{"context": "\n\n\u3010\u74b0\u5883\u3011\n\u3000windows8.1\n\u3000Excel 2013\n\u3000node.js 4.4.5\n\u3000npm 2.15.5\n\n\u3010\u6982\u8981\u3011\n\u3000\u4f50\u3005\u6728\u5e0c\u306e\u5199\u771f\u304b\u3089\u8272\u306e\u60c5\u5831\u3092\u53d6\u5f97\u3057\u3066\u3001Excel\u306e\u30bb\u30eb\u306b\u5857\u308a\u3064\u3076\u3057\u307e\u3059\u3002\n\n\u3010\u30d5\u30a9\u30eb\u30c0\u69cb\u6210\u3011\n|---sasaki_excel\n\u3000\u3000\u3000\u3000\u3000\u3000|---sasaki_excel.js\n\u3000\u3000\u3000\u3000\u3000\u3000|---sasaki.jpg\uff08\u4f50\u3005\u6728\u5e0c\u306e\u753b\u50cf\uff09\n\u3053\u3061\u3089\u306e\u753b\u50cf\u3092\u4f7f\u7528\u3057\u307e\u3057\u305f\u3002\n\n\n\u3010\u30d7\u30ed\u30b0\u30e9\u30e0\u3011\n\u3000Python\u306e\u6642\u3068\u6bd4\u3079\u308b\u3068\u77ed\u304f\u30b3\u30fc\u30c7\u30a3\u30f3\u30b0\u3067\u304d\u308b\u306e\u304c\u3044\u3044\u306d\uff01\n\nsasaki_excel.js\nvar Jimp = require(\"jimp\");\nvar Excel = require(\"exceljs\");\n\n// \u65b0\u3057\u304fExcel\u4f5c\u6210\nvar wb = new Excel.Workbook();\nvar ws = wb.addWorksheet(\"Nozomi Sheet\");\n\nJimp.read(\"./sasaki.jpg\", function (err, sasaki) {\n    sasaki.scan(0, 0, sasaki.bitmap.width, sasaki.bitmap.height, function (x, y, idx) {\n        // RGBA\u5024\u3092\uff11\uff16\u9032\u6570\u3078\u5909\u63db\n        var r = this.bitmap.data[ idx + 0 ].toString(16);\n        var g = this.bitmap.data[ idx + 1 ].toString(16);\n        var b = this.bitmap.data[ idx + 2 ].toString(16);\n        var a = this.bitmap.data[ idx + 3 ].toString(16);\n        var nozomi_argb = a + r + g + b;\n\n        var row = ws.getRow(y)\n        row.height = 1.5;\n        ws.getColumn(x+1).width = 0.3;\n\n        // \u5857\u308a\u3064\u3076\u3057\n        row.getCell(x+1).value = \" \";\n        row.getCell(x+1).fill = {\n          type: 'pattern',\n          pattern:'solid',\n          fgColor:{argb: nozomi_argb}\n        };\n    });\n    // Excel\u4fdd\u5b58\n    wb.xlsx.writeFile('sasaki_nozomi.xlsx');\n});\n\n\n\n\u3010\u7d50\u679c\u3011\n\n\n\u3010\u554f\u984c\u70b9\u3011\n\u3000\u8d64\u3084\u9ec4\u8272\u306e\u70b9\u304c\u3042\u3061\u3053\u3061\u306b\u63cf\u753b\u3055\u308c\u3066\u3057\u307e\u3046\u3002\n\u3000\uff08\u6539\u5584\u70b9\u306f\u3042\u308a\u305d\u3046\u304b\u306a\uff1f\u30fb\u30fb\u30fb('_')\uff09\n\n\u3010\u53c2\u8003\u30b5\u30a4\u30c8\u3011\n\u3000jimp-github\n\u3000exceljs-github\n\n\u3010\u4ed6\u8a00\u8a9e\u7248\u3011\n\u3000Python\u7248\u306f\u3053\u3061\u3089\n\u3000Ruby\u7248\u306f\u3053\u3061\u3089\n#\u3010\u74b0\u5883\u3011\n\u3000windows8.1\n\u3000Excel 2013\n\u3000node.js 4.4.5\n\u3000npm 2.15.5\n\n#\u3010\u6982\u8981\u3011\n\u3000\u4f50\u3005\u6728\u5e0c\u306e\u5199\u771f\u304b\u3089\u8272\u306e\u60c5\u5831\u3092\u53d6\u5f97\u3057\u3066\u3001Excel\u306e\u30bb\u30eb\u306b\u5857\u308a\u3064\u3076\u3057\u307e\u3059\u3002\n\n#\u3010\u30d5\u30a9\u30eb\u30c0\u69cb\u6210\u3011\n|---sasaki_excel\n\u3000\u3000\u3000\u3000\u3000\u3000|---sasaki_excel.js\n\u3000\u3000\u3000\u3000\u3000\u3000|---sasaki.jpg\uff08\u4f50\u3005\u6728\u5e0c\u306e\u753b\u50cf\uff09\n\n\u3053\u3061\u3089\u306e\u753b\u50cf\u3092\u4f7f\u7528\u3057\u307e\u3057\u305f\u3002\n![sasaki.jpg](https://qiita-image-store.s3.amazonaws.com/0/121997/0e1d3c4b-5808-8167-18dc-02d5aea5604e.jpeg)\n\n#\u3010\u30d7\u30ed\u30b0\u30e9\u30e0\u3011\n\u3000Python\u306e\u6642\u3068\u6bd4\u3079\u308b\u3068\u77ed\u304f\u30b3\u30fc\u30c7\u30a3\u30f3\u30b0\u3067\u304d\u308b\u306e\u304c\u3044\u3044\u306d\uff01\n\n```js:sasaki_excel.js\nvar Jimp = require(\"jimp\");\nvar Excel = require(\"exceljs\");\n\n// \u65b0\u3057\u304fExcel\u4f5c\u6210\nvar wb = new Excel.Workbook();\nvar ws = wb.addWorksheet(\"Nozomi Sheet\");\n\nJimp.read(\"./sasaki.jpg\", function (err, sasaki) {\n    sasaki.scan(0, 0, sasaki.bitmap.width, sasaki.bitmap.height, function (x, y, idx) {\n        // RGBA\u5024\u3092\uff11\uff16\u9032\u6570\u3078\u5909\u63db\n        var r = this.bitmap.data[ idx + 0 ].toString(16);\n        var g = this.bitmap.data[ idx + 1 ].toString(16);\n        var b = this.bitmap.data[ idx + 2 ].toString(16);\n        var a = this.bitmap.data[ idx + 3 ].toString(16);\n        var nozomi_argb = a + r + g + b;\n\n        var row = ws.getRow(y)\n        row.height = 1.5;\n        ws.getColumn(x+1).width = 0.3;\n\n        // \u5857\u308a\u3064\u3076\u3057\n        row.getCell(x+1).value = \" \";\n        row.getCell(x+1).fill = {\n          type: 'pattern',\n          pattern:'solid',\n          fgColor:{argb: nozomi_argb}\n        };\n    });\n    // Excel\u4fdd\u5b58\n    wb.xlsx.writeFile('sasaki_nozomi.xlsx');\n});\n```\n\n#\u3010\u7d50\u679c\u3011\n<img width=\"453\" alt=\"nozomi_excel.png\" src=\"https://qiita-image-store.s3.amazonaws.com/0/121997/8b694a9c-9eab-b072-40c4-e0d2fdee614f.png\">\n\n#\u3010\u554f\u984c\u70b9\u3011\n\u3000\u8d64\u3084\u9ec4\u8272\u306e\u70b9\u304c\u3042\u3061\u3053\u3061\u306b\u63cf\u753b\u3055\u308c\u3066\u3057\u307e\u3046\u3002\n\u3000\uff08\u6539\u5584\u70b9\u306f\u3042\u308a\u305d\u3046\u304b\u306a\uff1f\u30fb\u30fb\u30fb('_')\uff09\n\n#\u3010\u53c2\u8003\u30b5\u30a4\u30c8\u3011\n\u3000[jimp-github](https://github.com/oliver-moran/jimp)\n\u3000[exceljs-github](https://github.com/guyonroche/exceljs)\n\n#\u3010\u4ed6\u8a00\u8a9e\u7248\u3011\n\u3000[Python\u7248\u306f\u3053\u3061\u3089](http://qiita.com/Algebra_nobu/items/4e2b36bdb38434e183de)\n\u3000[Ruby\u7248\u306f\u3053\u3061\u3089](http://qiita.com/Algebra_nobu/items/6d740ac3b58825431202)\n", "tags": ["Node.js", "Excel", "Windows", "Windows8.1", "JavaScript"]}