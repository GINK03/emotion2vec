{"context": " More than 1 year has passed since last update.DB\u306a\u3069\u306e\u691c\u7d22\u306b\u3088\u308b\u7d5e\u308a\u8fbc\u307f\u3068pagination\u306e\u7d44\u307f\u5408\u308f\u305b\u4f8b\u3067\u3059\u3002\nController_Item \u306eaction_list() \u306f\u7d5e\u308a\u8fbc\u307f\u3092\u305b\u305a\u8868\u793a\u3057\u3066\u3044\u307e\u3059\u3002\n\u540c\u3058\u304fController_Item\u306eaction_search() \u306f\"category\"\u3068\u3044\u3046\u30d1\u30e9\u30e1\u30fc\u30bf\u3092GET\u30d1\u30e9\u30e1\u30fc\u30bf\u3067\u6e21\u3057\u3001\u7d5e\u308a\u8fbc\u307f\u8868\u793a\u3092\u884c\u3063\u3066\u3044\u307e\u3059\u3002\n\u30dd\u30a4\u30f3\u30c8\u306fpagination\u306euri_segment\u30d1\u30e9\u30e1\u30fc\u30bf\u3092page\u3067\u51e6\u7406\u3057\u3066\u3044\u308b\u3068\u3053\u308d\u3068\u3001\npagination_url\u306b\u691c\u7d22\u30d1\u30e9\u30e1\u30fc\u30bf(GET)\u3092\u8ffd\u52a0\u3057\u3066\u3044\u308b\u3068\u3053\u308d\u3067\u3059\u3002\n\u25a0Controller(action_list\u30e1\u30bd\u30c3\u30c9)\n\nitem.php\n\n<?php\n\nnamespace Item;\n\nclass Controller_Item extends \\Controller_Base\n{\n\n    private $_classname = 'item';\n    private $_perpage = 20;\n\n    public function action_list()\n    {\n        $data = array();\n\n        $data['page'] = \\Input::get('page');\n        $data['posts'] = Model_Item::find('all');\n\n        $pagination = \\Pagination::forge('default', array(\n                'pagination_url' => \\Uri::base() . $this->_classname . '/list/' . $uid,\n                'wrapper' => \"<div class=\\\"pagination\\\">\\n\\t{pagination}\\n</div>\\n\",\n                'uri_segment' => 'page',\n                'total_items' =>  count($data['posts']),\n                'per_page' => $this->_perpage,\n                'name' => 'bootstrap'\n        ));\n\n        $data['paginate'] = \\Pagination::instance('default')->render();\n\n        if (\\Pagination::get('current_page') == 1)\n        {\n            $data['offset'] = 0;\n        }\n        else\n        {\n            $data['offset'] = ($data['page'] -1) * $this->_perpage;\n        }\n\n        $data['posts'] = Model_Item::query()\n            ->where('uid', $uid)\n            ->order_by('updated_at', 'DESC')\n            ->rows_offset($data['offset'])\n            ->rows_limit($this->_perpage)\n        ->get();\n\n        $this->template->set_global('total_items', $pagination->total_items, false);\n        $this->template->content = \\View::forge('list', $data, false);\n\n    }\n\n\n\n\u25a0Controller(action_search\u30e1\u30bd\u30c3\u30c9)\n\n\n<?php\n\nnamespace Item;\n\nclass Controller_Item extends \\Controller_Base\n{\n\n    private $_classname = 'item';\n    private $_perpage = 20;\n\n    public function action_search()\n    {\n\n        $data = array();\n        $data['page'] = \\Input::get('page');\n\n        if (\\Input::method() == 'GET' && \\Input::get('category'))\n        {\n\n            $data['posts'] = Model_Item::query()\n                ->where('category_code', \\Input::get('category'))\n                ->and_where_open()\n                    ->or_where_open()\n                        ->or_where('title', 'LIKE', \"%\" . \\Input::get('search') . \"%\")\n                        ->or_where('keyword', 'LIKE' , \"%\" . \\Input::get('search') . \"%\")\n                    ->or_where_close()\n                ->and_where_close()\n            ->get();\n\n            $pagination = \\Pagination::forge('default', array(\n                'pagination_url' => \\Uri::base() . $this->_classname . '/list?category=' . \\Input::get('category'),\n                'wrapper' => \"<div class=\\\"pagination\\\">\\n\\t{pagination}\\n</div>\\n\",\n                'uri_segment' => 'page',\n                'total_items' =>  count($data['posts']),\n                'per_page' => $this->_perpage,\n                'name' => 'bootstrap'\n            ));\n\n            if (\\Pagination::get('current_page') == 1)\n            {\n                $data['offset'] = 0;\n            }\n            else\n            {\n                $data['offset'] = ($data['page'] -1) * $this->_perpage;\n            }\n\n        }\n        else\n        {\n\n            $pagination = \\Pagination::forge('default', array(\n                'pagination_url' => \\Uri::base() . $this->_classname .  '/list/',\n                'wrapper' => \"<div class=\\\"pagination\\\">\\n\\t{pagination}\\n</div>\\n\",\n                'uri_segment' => 'page',\n                'total_items' => Model_Item::count(),\n                'per_page' => $this->_perpage,\n                'name' => 'bootstrap'\n            ));\n\n            if (\\Pagination::get('current_page') == 1)\n            {\n                $data['offset'] = 0;\n            }\n            else\n            {\n                $data['offset'] = ($data['page'] -1) * $this->_perpage;\n            }\n\n            $data['posts'] = Model_Item::query()\n                ->rows_offset($data['offset'])\n                ->rows_limit($this->_perpage)\n            ->get();\n\n        }\n\n        $data['paginate'] = \\Pagination::instance('default')->render();\n\n        $this->template->set_global('total_items', $pagination->total_items, false);\n        $this->template->content = \\View::forge('list', $data, false);\n\n\n    }\n\n\n\n\n\nView (list.php)\n\nlist.php\n\n<?php if ($posts): ?>\n<?php echo isset($paginate) ? $paginate : null; ?>\n\n<span><?php echo isset($total_items) ? \"\u5168\u90e8\u3067\" . $total_items . \"\u4ef6\u306e\u30a2\u30a4\u30c6\u30e0\" : null; ?></span>\n\n(\u30c7\u30fc\u30bf\u8868\u793a)\n\n<?php else: ?>\n<p>No Posts.</p>\n<?php endif; ?>\n\n\n\nDB\u306a\u3069\u306e\u691c\u7d22\u306b\u3088\u308b\u7d5e\u308a\u8fbc\u307f\u3068pagination\u306e\u7d44\u307f\u5408\u308f\u305b\u4f8b\u3067\u3059\u3002\n\nController_Item \u306eaction_list() \u306f\u7d5e\u308a\u8fbc\u307f\u3092\u305b\u305a\u8868\u793a\u3057\u3066\u3044\u307e\u3059\u3002\n\u540c\u3058\u304fController_Item\u306eaction_search() \u306f\"category\"\u3068\u3044\u3046\u30d1\u30e9\u30e1\u30fc\u30bf\u3092GET\u30d1\u30e9\u30e1\u30fc\u30bf\u3067\u6e21\u3057\u3001\u7d5e\u308a\u8fbc\u307f\u8868\u793a\u3092\u884c\u3063\u3066\u3044\u307e\u3059\u3002\n\n\u30dd\u30a4\u30f3\u30c8\u306fpagination\u306euri_segment\u30d1\u30e9\u30e1\u30fc\u30bf\u3092page\u3067\u51e6\u7406\u3057\u3066\u3044\u308b\u3068\u3053\u308d\u3068\u3001\npagination_url\u306b\u691c\u7d22\u30d1\u30e9\u30e1\u30fc\u30bf(GET)\u3092\u8ffd\u52a0\u3057\u3066\u3044\u308b\u3068\u3053\u308d\u3067\u3059\u3002\n\n\n\u25a0Controller(action_list\u30e1\u30bd\u30c3\u30c9)\n\n```php:item.php\n\n<?php\n\nnamespace Item;\n\nclass Controller_Item extends \\Controller_Base\n{\n\n\tprivate $_classname = 'item';\n\tprivate $_perpage = 20;\n\n\tpublic function action_list()\n\t{\n\t\t$data = array();\n\n\t\t$data['page'] = \\Input::get('page');\n\t\t$data['posts'] = Model_Item::find('all');\n\n\t\t$pagination = \\Pagination::forge('default', array(\n\t\t\t\t'pagination_url' => \\Uri::base() . $this->_classname . '/list/' . $uid,\n\t\t\t\t'wrapper' => \"<div class=\\\"pagination\\\">\\n\\t{pagination}\\n</div>\\n\",\n\t\t\t\t'uri_segment' => 'page',\n\t\t\t\t'total_items' =>  count($data['posts']),\n\t\t\t\t'per_page' => $this->_perpage,\n\t\t\t\t'name' => 'bootstrap'\n\t\t));\n\n\t\t$data['paginate'] = \\Pagination::instance('default')->render();\n\n\t\tif (\\Pagination::get('current_page') == 1)\n\t\t{\n\t\t\t$data['offset'] = 0;\n\t\t}\n\t\telse\n\t\t{\n\t\t\t$data['offset'] = ($data['page'] -1) * $this->_perpage;\n\t\t}\n\n\t\t$data['posts'] = Model_Item::query()\n\t\t\t->where('uid', $uid)\n\t\t\t->order_by('updated_at', 'DESC')\n\t\t\t->rows_offset($data['offset'])\n\t\t\t->rows_limit($this->_perpage)\n\t\t->get();\n\n\t\t$this->template->set_global('total_items', $pagination->total_items, false);\n\t\t$this->template->content = \\View::forge('list', $data, false);\n\n\t}\n\n```\n\n\u25a0Controller(action_search\u30e1\u30bd\u30c3\u30c9)\n\n```php\n\n\n<?php\n\nnamespace Item;\n\nclass Controller_Item extends \\Controller_Base\n{\n\n\tprivate $_classname = 'item';\n\tprivate $_perpage = 20;\n\n\tpublic function action_search()\n\t{\n\n\t\t$data = array();\n\t\t$data['page'] = \\Input::get('page');\n\n\t\tif (\\Input::method() == 'GET' && \\Input::get('category'))\n\t\t{\n\n\t\t\t$data['posts'] = Model_Item::query()\n\t\t\t\t->where('category_code', \\Input::get('category'))\n\t\t\t\t->and_where_open()\n\t\t\t\t\t->or_where_open()\n\t\t\t\t\t\t->or_where('title', 'LIKE', \"%\" . \\Input::get('search') . \"%\")\n\t\t\t\t\t\t->or_where('keyword', 'LIKE' , \"%\" . \\Input::get('search') . \"%\")\n\t\t\t\t\t->or_where_close()\n\t\t\t\t->and_where_close()\n\t\t\t->get();\n\n\t\t\t$pagination = \\Pagination::forge('default', array(\n\t\t\t\t'pagination_url' => \\Uri::base() . $this->_classname . '/list?category=' . \\Input::get('category'),\n\t\t\t\t'wrapper' => \"<div class=\\\"pagination\\\">\\n\\t{pagination}\\n</div>\\n\",\n\t\t\t\t'uri_segment' => 'page',\n\t\t\t\t'total_items' =>  count($data['posts']),\n\t\t\t\t'per_page' => $this->_perpage,\n\t\t\t\t'name' => 'bootstrap'\n\t\t\t));\n\n\t\t\tif (\\Pagination::get('current_page') == 1)\n\t\t\t{\n\t\t\t\t$data['offset'] = 0;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\t$data['offset'] = ($data['page'] -1) * $this->_perpage;\n\t\t\t}\n\n\t\t}\n\t\telse\n\t\t{\n\n\t\t\t$pagination = \\Pagination::forge('default', array(\n\t\t\t\t'pagination_url' => \\Uri::base() . $this->_classname .  '/list/',\n\t\t\t\t'wrapper' => \"<div class=\\\"pagination\\\">\\n\\t{pagination}\\n</div>\\n\",\n\t\t\t\t'uri_segment' => 'page',\n\t\t\t\t'total_items' => Model_Item::count(),\n\t\t\t\t'per_page' => $this->_perpage,\n\t\t\t\t'name' => 'bootstrap'\n\t\t\t));\n\n\t\t\tif (\\Pagination::get('current_page') == 1)\n\t\t\t{\n\t\t\t\t$data['offset'] = 0;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\t$data['offset'] = ($data['page'] -1) * $this->_perpage;\n\t\t\t}\n\n\t\t\t$data['posts'] = Model_Item::query()\n\t\t\t\t->rows_offset($data['offset'])\n\t\t\t\t->rows_limit($this->_perpage)\n\t\t\t->get();\n\n\t\t}\n\n\t\t$data['paginate'] = \\Pagination::instance('default')->render();\n\n\t\t$this->template->set_global('total_items', $pagination->total_items, false);\n\t\t$this->template->content = \\View::forge('list', $data, false);\n\n\n\t}\n\n\n\n\n```\n\n\nView (list.php)\n\n```php:list.php\n\n<?php if ($posts): ?>\n<?php echo isset($paginate) ? $paginate : null; ?>\n\n<span><?php echo isset($total_items) ? \"\u5168\u90e8\u3067\" . $total_items . \"\u4ef6\u306e\u30a2\u30a4\u30c6\u30e0\" : null; ?></span>\n\n(\u30c7\u30fc\u30bf\u8868\u793a)\n\n<?php else: ?>\n<p>No Posts.</p>\n<?php endif; ?>\n\n```\n", "tags": ["FuelPHP"]}