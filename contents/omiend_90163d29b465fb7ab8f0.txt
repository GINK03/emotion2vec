{"context": " More than 1 year has passed since last update.\u3068\u3044\u3046\u306e\u3092\u4f5c\u3063\u3066\u307f\u305f\u3093\u3060\u3002\n\u30bd\u30fc\u30b9\u306f\u3053\u3061\u3089\u306b\u7f6e\u3044\u3066\u307e\u3059\n\nTwitter4j.jar\u306e\u53d6\u5f97\n\nbuild.sbt\nlibraryDependencies ++= Seq(\n   cache\n  ,\"org.twitter4j\" % \"twitter4j-core\" % \"4.0.2\"\n)\n\n\n\u307e\u305a\u306fTwitter4j.jar\u3092\u53d6\u5f97\u3059\u308b\u3079\u304f\u3001build.sbt\u306elibraryDependencies\u3092\u3053\u306e\u3088\u3046\u306b\u4fee\u6b63\u3002\ncache\u306f\u30ed\u30b0\u30a4\u30f3\u5f8c\u306eTwitter\u306e\u30e6\u30fc\u30b6\u30fc\u60c5\u5831\u3092\u4fdd\u6301\u3059\u308b\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u3082\u3061\u307e\u308f\u3059\u3060\u3051\u306e\u70ba\u306b\u4f7f\u3046\u60f3\u5b9a\u3002\n\ntwitter4j.properties\u306b\u30b3\u30f3\u30b7\u30e5\u30fc\u30de\u30fc\u30ad\u30fc\u3092\u8a2d\u5b9a\n\nconf/twitter4j.properties\noauth.consumerKey={\u3042\u306a\u305f\u306eTwitterApp\u306e\u30b3\u30f3\u30b7\u30e5\u30fc\u30de\u30fc\u30ad\u30fc}\noauth.consumerSecret={\u3042\u306a\u305f\u306eTwitterApp\u306e\u30b3\u30f3\u30b7\u30e5\u30fc\u30de\u30fc\u30b7\u30fc\u30af\u30ec\u30c3\u30c8}\n\n\n\u30b3\u30f3\u30b7\u30e5\u30fc\u30de\u30fc\u30ad\u30fc\u306f\u3001\u3053\u3053\u3067\u4e8b\u524d\u306b\u53d6\u5f97\u3059\u308b\u5fc5\u8981\u304c\u3042\u308b\uff08\u3042\u305f\u308a\u307e\u3048\u3060\u3051\u3069\uff09\n\nTwitterController\n\u4eca\u56de\u72ec\u81ea\u306b\u3053\u306e\u69d8\u306aController\u3092\u4f5c\u6210\u3002\n\napp/controller/TwitterController.scala\n\nTwitterController.scala\npackage controllers\n\nimport play.api._\nimport play.api.mvc._\nimport play.api.Play.current\n\nimport play.api.cache._\n\nimport twitter4j._\nimport twitter4j.auth._\n\n/**\n * \u30c4\u30a4\u30c3\u30bf\u30fc\u30ed\u30b0\u30a4\u30f3\u30b3\u30f3\u30c8\u30ed\u30fc\u30e9\n */\nobject TwitterController extends Controller {\n\n  /**\n   * Twitter\u3078\u30ed\u30b0\u30a4\u30f3\u3059\u308b\n   */\n  def twitterLogin = Action { implicit request =>\n\n    // Twitter\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306e\u521d\u671f\u5316\n    val twitter: Twitter = (new TwitterFactory()).getInstance()\n\n    // RequestToken\u306e\u53d6\u5f97\n    val requestToken: RequestToken = twitter.getOAuthRequestToken(\"http://\" + request.host + \"/twitterOAuthCallback\")\n\n    // Twitter\u3068RequestToken\u306e\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092Cache\u306b\u683c\u7d0d(2\u5206\u6709\u52b9)\n    Cache.set(\"twitter\", twitter, 120)\n    Cache.set(\"requestToken\", requestToken, 120)\n\n    // Twitter\u306e\u30ed\u30b0\u30a4\u30f3\u753b\u9762\u306b\u30ea\u30c0\u30a4\u30ec\u30af\u30c8\n    Redirect(requestToken.getAuthorizationURL())\n  }\n\n  /**\n   * Twitter\u304b\u3089\u306eCallBack\u51e6\u7406\n   */\n  def twitterOAuthCallback = Action { implicit request =>\n    // \u627f\u8a8d\u53ef\u5426\u3092\u7cbe\u67fb\uff08denied\u304c\u3042\u3063\u305f\u3089\u627f\u8a8d\u30ad\u30e3\u30f3\u30bb\u30eb\uff09\n    request.queryString.get(\"denied\") match {\n\n      // Twitter\u306e\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u627f\u8a8d\u30ad\u30e3\u30f3\u30bb\u30eb\u6642\n      case Some(denied) => Redirect(routes.TwitterController.twitterLogout)\n\n      // Twitter\u306e\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u627f\u8a8d\u6642\n      case _ => {\n\n        // Twitter\u306e\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092Cache\u304b\u3089\u53d6\u5f97\n        val getTwitter     : Option[Twitter] = Cache.getAs[Twitter](\"twitter\")\n\n        // \u53d6\u5f97\u3067\u304d\u306a\u3044\u5834\u5408\u306f\u30c8\u30c3\u30d7\u753b\u9762\u3078\n        getTwitter match {\n          case Some(twitter) => {\n\n            // RequestToken\u306e\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092Cache\u304b\u3089\u53d6\u5f97\n            val getRequestToken: Option[RequestToken] = Cache.getAs[RequestToken](\"requestToken\")\n\n            // \u53d6\u5f97\u3067\u304d\u306a\u3044\u5834\u5408\u306f\u30c8\u30c3\u30d7\u753b\u9762\u3078\n            getRequestToken match {\n              case Some(requestToken) => {\n\n                // AuthToken\u3092\u53d6\u5f97\u3059\u308b\n                var authToken   : String = request.queryString.get(\"oauth_token\").get.head\n                var authVerifier: String = request.queryString.get(\"oauth_verifier\").get.head\n\n                // AccessToken\u3092\u53d6\u5f97\u3059\u308b\n                // val accessToken: AccessToken = twitter.getOAuthAccessToken(requestToken, authVerifier)\n                twitter.getOAuthAccessToken(requestToken, authVerifier)\n\n                // AccessToken\u3092\u53d6\u5f97\u3059\u308b\u5834\u5408\n                // val accessToken: AccessToken = twitter.getOAuthAccessToken(requestToken, authVerifier)\n                // val accessTokenSt: String = accessToken.getToken\n                // val accessTokenSecretSt: String = accessToken.getTokenSecret\n\n                // Twitter\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306e\u8a8d\u8a3c\n                twitter.verifyCredentials()\n\n                // Twitter\u306eUser\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u53d6\u5f97\n                var user: User = twitter.showUser(twitter.getId())\n\n                // Cache\u306b\u8a2d\u5b9a(3\u65e5\u9593\u6709\u52b9)\n                Cache.set(\"twitter_user\", user, 4320)\n\n                // Cache\u304b\u3089\u524a\u9664\n                Cache.remove(\"twitter\")\n                Cache.remove(\"requestToken\")\n\n              }\n              case _ =>\n            }\n          }\n          case _ =>\n        }\n\n        // \u30ea\u30bf\u30fc\u30f3\n        Redirect(routes.Application.index)\n      }\n    }\n  }\n\n  /** \n   * \u30ed\u30b0\u30a2\u30a6\u30c8\u51e6\u7406\n   */\n  def twitterLogout = Action { implicit request =>\n\n    // Cache\u304b\u3089\u524a\u9664\n    Cache.remove(\"twitter_user\")\n\n    // \u30ea\u30bf\u30fc\u30f3\n    Redirect(routes.Application.index)\n  }\n}\n\n\n\u6700\u5f8c\u306f\u53d6\u5f97\u3057\u305ftwitter4j.User\u3092Cache\u306b\u5165\u308c\u3066\u3001Application.scala\u3067\u4f7f\u3046\u611f\u3058\u3002\n\u307e\u3042DB\u6c38\u7d9a\u5316\u3068\u304b\u3057\u3066\u3082\u3044\u3044\u306e\u304b\u306a\uff1f\n\nconf/routes\n# Home page\nGET     /                           controllers.Application.index\n\n# Twitter\nGET     /twitterLogin                                 controllers.TwitterController.twitterLogin\nGET     /twitterOAuthCallback                         controllers.TwitterController.twitterOAuthCallback\nGET     /twitterLogout                                controllers.TwitterController.twitterLogout\n\n\u305d\u3057\u3066Routes\u306e\u8a2d\u5b9a\u306f\u3053\u3093\u306a\u611f\u3058\u3002\n\nApplication Controller\u306e\u8a2d\u5b9a\n\napp/controllers/Application.scala\n  /** index\u753b\u9762\u8d77\u52d5 */\n  def index = Action {\n    // Cache\u304b\u3089Twitter4j.User\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u53d6\u5f97\u3057\u3001index\u753b\u9762\u3092\u6a5f\u52d5\n    Ok(views.html.index(Cache.getAs[User](\"twitter_user\")))\n  }\n\nCache\u304b\u3089twitter4j.User\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u53d6\u5f97\u3057\u3066\u3044\u308b\u4ee5\u5916\u7279\u5225\u306a\u4e8b\u306f\u306a\u3057\u3002\n\nindex.scala.html\n\napp/views/index.scala.html\n\nindex.scala.html\n  @twitterUser match {\n    case Some(user) => {\n        &#64;@user.getScreenName<br/>\n        <img src=\"@user.getProfileImageURL\"/><br/>\n        <a href=\"/twitterLogout\">Logout</a>\n    }\n    case _ => {\n      <a href=\"/twitterLogin\">Login</a>\n    }\n  }\n\n\n\u30da\u30fc\u30b8\u3067\u306f\u5f15\u6570\u3067\u53d7\u3051\u53d6\u3063\u305f@twitterUser\u304c\u5b58\u5728\u3059\u308b\u5834\u5408\u3001@twitterUser\u304b\u3089ScreenName\u306e\u8868\u793a\u3068\u3001\u30a2\u30a4\u30b3\u30f3\u753b\u50cfURL\u304b\u3089\u30a2\u30a4\u30b3\u30f3\u3092\u8868\u793a\u3059\u308b\u3068\u3044\u3046\u51e6\u7406\u3002\n\n\u30ed\u30b0\u30a4\u30f3\u524d\u2192\u30ed\u30b0\u30a4\u30f3\u5f8c\n\u2192\n\n\u3054\u6307\u6458\u306e\u70b9\u306a\u3069\u3042\u3063\u305f\u3089\u3088\u308d\u3057\u304f\u3067\u3059\nAccessToken\u306f\u545f\u304f\u6642\u306b\u4f7f\u3046\u3093\u3060\u308d\u3046\u3051\u3069\u3001\u30a2\u30d7\u30ea\u4e0a\u3067\u306f\u30ed\u30b0\u30a4\u30f3\u3068\u304b\u306b\u4f7f\u3048\u3070\u3044\u3044\u306e\u304b\u306a\n\u3068\u3044\u3046\u306e\u3092\u4f5c\u3063\u3066\u307f\u305f\u3093\u3060\u3002\n\n\u30bd\u30fc\u30b9\u306f[\u3053\u3061\u3089](https://github.com/omiend/PlayFrameworkScala_Twitter4jSample)\u306b\u7f6e\u3044\u3066\u307e\u3059\n\n### Twitter4j.jar\u306e\u53d6\u5f97\n\n#####build.sbt\n```\nlibraryDependencies ++= Seq(\n   cache\n  ,\"org.twitter4j\" % \"twitter4j-core\" % \"4.0.2\"\n)\n\n```\n\n\u307e\u305a\u306fTwitter4j.jar\u3092\u53d6\u5f97\u3059\u308b\u3079\u304f\u3001build.sbt\u306elibraryDependencies\u3092\u3053\u306e\u3088\u3046\u306b\u4fee\u6b63\u3002\n\ncache\u306f\u30ed\u30b0\u30a4\u30f3\u5f8c\u306eTwitter\u306e\u30e6\u30fc\u30b6\u30fc\u60c5\u5831\u3092\u4fdd\u6301\u3059\u308b\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u3082\u3061\u307e\u308f\u3059\u3060\u3051\u306e\u70ba\u306b\u4f7f\u3046\u60f3\u5b9a\u3002\n\n###twitter4j.properties\u306b\u30b3\u30f3\u30b7\u30e5\u30fc\u30de\u30fc\u30ad\u30fc\u3092\u8a2d\u5b9a\n\n#####conf/twitter4j.properties\n```\noauth.consumerKey={\u3042\u306a\u305f\u306eTwitterApp\u306e\u30b3\u30f3\u30b7\u30e5\u30fc\u30de\u30fc\u30ad\u30fc}\noauth.consumerSecret={\u3042\u306a\u305f\u306eTwitterApp\u306e\u30b3\u30f3\u30b7\u30e5\u30fc\u30de\u30fc\u30b7\u30fc\u30af\u30ec\u30c3\u30c8}\n\n```\n\n\u30b3\u30f3\u30b7\u30e5\u30fc\u30de\u30fc\u30ad\u30fc\u306f\u3001[\u3053\u3053](https://apps.twitter.com/)\u3067\u4e8b\u524d\u306b\u53d6\u5f97\u3059\u308b\u5fc5\u8981\u304c\u3042\u308b\uff08\u3042\u305f\u308a\u307e\u3048\u3060\u3051\u3069\uff09\n\n###TwitterController\n\n\u4eca\u56de\u72ec\u81ea\u306b\u3053\u306e\u69d8\u306aController\u3092\u4f5c\u6210\u3002\n\n#####app/controller/TwitterController.scala\n```scala:TwitterController.scala\npackage controllers\n\nimport play.api._\nimport play.api.mvc._\nimport play.api.Play.current\n\nimport play.api.cache._\n\nimport twitter4j._\nimport twitter4j.auth._\n\n/**\n * \u30c4\u30a4\u30c3\u30bf\u30fc\u30ed\u30b0\u30a4\u30f3\u30b3\u30f3\u30c8\u30ed\u30fc\u30e9\n */\nobject TwitterController extends Controller {\n\n  /**\n   * Twitter\u3078\u30ed\u30b0\u30a4\u30f3\u3059\u308b\n   */\n  def twitterLogin = Action { implicit request =>\n\n    // Twitter\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306e\u521d\u671f\u5316\n    val twitter: Twitter = (new TwitterFactory()).getInstance()\n\n    // RequestToken\u306e\u53d6\u5f97\n    val requestToken: RequestToken = twitter.getOAuthRequestToken(\"http://\" + request.host + \"/twitterOAuthCallback\")\n\n    // Twitter\u3068RequestToken\u306e\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092Cache\u306b\u683c\u7d0d(2\u5206\u6709\u52b9)\n    Cache.set(\"twitter\", twitter, 120)\n    Cache.set(\"requestToken\", requestToken, 120)\n\n    // Twitter\u306e\u30ed\u30b0\u30a4\u30f3\u753b\u9762\u306b\u30ea\u30c0\u30a4\u30ec\u30af\u30c8\n    Redirect(requestToken.getAuthorizationURL())\n  }\n\n  /**\n   * Twitter\u304b\u3089\u306eCallBack\u51e6\u7406\n   */\n  def twitterOAuthCallback = Action { implicit request =>\n    // \u627f\u8a8d\u53ef\u5426\u3092\u7cbe\u67fb\uff08denied\u304c\u3042\u3063\u305f\u3089\u627f\u8a8d\u30ad\u30e3\u30f3\u30bb\u30eb\uff09\n    request.queryString.get(\"denied\") match {\n\n      // Twitter\u306e\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u627f\u8a8d\u30ad\u30e3\u30f3\u30bb\u30eb\u6642\n      case Some(denied) => Redirect(routes.TwitterController.twitterLogout)\n\n      // Twitter\u306e\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u627f\u8a8d\u6642\n      case _ => {\n\n        // Twitter\u306e\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092Cache\u304b\u3089\u53d6\u5f97\n        val getTwitter     : Option[Twitter] = Cache.getAs[Twitter](\"twitter\")\n\n        // \u53d6\u5f97\u3067\u304d\u306a\u3044\u5834\u5408\u306f\u30c8\u30c3\u30d7\u753b\u9762\u3078\n        getTwitter match {\n          case Some(twitter) => {\n\n            // RequestToken\u306e\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092Cache\u304b\u3089\u53d6\u5f97\n            val getRequestToken: Option[RequestToken] = Cache.getAs[RequestToken](\"requestToken\")\n\n            // \u53d6\u5f97\u3067\u304d\u306a\u3044\u5834\u5408\u306f\u30c8\u30c3\u30d7\u753b\u9762\u3078\n            getRequestToken match {\n              case Some(requestToken) => {\n\n                // AuthToken\u3092\u53d6\u5f97\u3059\u308b\n                var authToken   : String = request.queryString.get(\"oauth_token\").get.head\n                var authVerifier: String = request.queryString.get(\"oauth_verifier\").get.head\n\n                // AccessToken\u3092\u53d6\u5f97\u3059\u308b\n                // val accessToken: AccessToken = twitter.getOAuthAccessToken(requestToken, authVerifier)\n                twitter.getOAuthAccessToken(requestToken, authVerifier)\n\n                // AccessToken\u3092\u53d6\u5f97\u3059\u308b\u5834\u5408\n                // val accessToken: AccessToken = twitter.getOAuthAccessToken(requestToken, authVerifier)\n                // val accessTokenSt: String = accessToken.getToken\n                // val accessTokenSecretSt: String = accessToken.getTokenSecret\n\n                // Twitter\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306e\u8a8d\u8a3c\n                twitter.verifyCredentials()\n\n                // Twitter\u306eUser\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u53d6\u5f97\n                var user: User = twitter.showUser(twitter.getId())\n\n                // Cache\u306b\u8a2d\u5b9a(3\u65e5\u9593\u6709\u52b9)\n                Cache.set(\"twitter_user\", user, 4320)\n\n                // Cache\u304b\u3089\u524a\u9664\n                Cache.remove(\"twitter\")\n                Cache.remove(\"requestToken\")\n\n              }\n              case _ =>\n            }\n          }\n          case _ =>\n        }\n\n        // \u30ea\u30bf\u30fc\u30f3\n        Redirect(routes.Application.index)\n      }\n    }\n  }\n\n  /** \n   * \u30ed\u30b0\u30a2\u30a6\u30c8\u51e6\u7406\n   */\n  def twitterLogout = Action { implicit request =>\n\n    // Cache\u304b\u3089\u524a\u9664\n    Cache.remove(\"twitter_user\")\n    \n    // \u30ea\u30bf\u30fc\u30f3\n    Redirect(routes.Application.index)\n  }\n}\n```\n\n\u6700\u5f8c\u306f\u53d6\u5f97\u3057\u305ftwitter4j.User\u3092Cache\u306b\u5165\u308c\u3066\u3001Application.scala\u3067\u4f7f\u3046\u611f\u3058\u3002\n\n\u307e\u3042DB\u6c38\u7d9a\u5316\u3068\u304b\u3057\u3066\u3082\u3044\u3044\u306e\u304b\u306a\uff1f\n\n#####conf/routes\n```\n# Home page\nGET     /                           controllers.Application.index\n\n# Twitter\nGET     /twitterLogin                                 controllers.TwitterController.twitterLogin\nGET     /twitterOAuthCallback                         controllers.TwitterController.twitterOAuthCallback\nGET     /twitterLogout                                controllers.TwitterController.twitterLogout\n```\n\n\u305d\u3057\u3066Routes\u306e\u8a2d\u5b9a\u306f\u3053\u3093\u306a\u611f\u3058\u3002\n\n###Application Controller\u306e\u8a2d\u5b9a\n\n#####app/controllers/Application.scala\n```\n  /** index\u753b\u9762\u8d77\u52d5 */\n  def index = Action {\n  \t// Cache\u304b\u3089Twitter4j.User\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u53d6\u5f97\u3057\u3001index\u753b\u9762\u3092\u6a5f\u52d5\n  \tOk(views.html.index(Cache.getAs[User](\"twitter_user\")))\n  }\n```\n\nCache\u304b\u3089twitter4j.User\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u53d6\u5f97\u3057\u3066\u3044\u308b\u4ee5\u5916\u7279\u5225\u306a\u4e8b\u306f\u306a\u3057\u3002\n\n###index.scala.html\n\n#####app/views/index.scala.html\n```xml:index.scala.html\n  @twitterUser match {\n    case Some(user) => {\n    \t&#64;@user.getScreenName<br/>\n    \t<img src=\"@user.getProfileImageURL\"/><br/>\n    \t<a href=\"/twitterLogout\">Logout</a>\n    }\n    case _ => {\n      <a href=\"/twitterLogin\">Login</a>\n    }\n  }\n```\n\n\u30da\u30fc\u30b8\u3067\u306f\u5f15\u6570\u3067\u53d7\u3051\u53d6\u3063\u305f@twitterUser\u304c\u5b58\u5728\u3059\u308b\u5834\u5408\u3001@twitterUser\u304b\u3089ScreenName\u306e\u8868\u793a\u3068\u3001\u30a2\u30a4\u30b3\u30f3\u753b\u50cfURL\u304b\u3089\u30a2\u30a4\u30b3\u30f3\u3092\u8868\u793a\u3059\u308b\u3068\u3044\u3046\u51e6\u7406\u3002\n\n#####\u30ed\u30b0\u30a4\u30f3\u524d\u2192\u30ed\u30b0\u30a4\u30f3\u5f8c\n\n<p><span itemscope itemtype=\"http://schema.org/Photograph\"><img src=\"http://cdn-ak.f.st-hatena.com/images/fotolife/o/omiend/20141030/20141030145651.png\" alt=\"f:id:omiend:20141030145651p:plain\" title=\"f:id:omiend:20141030145651p:plain\" class=\"hatena-fotolife\" itemprop=\"image\"></span>\u2192<span itemscope itemtype=\"http://schema.org/Photograph\"><img src=\"http://cdn-ak.f.st-hatena.com/images/fotolife/o/omiend/20141030/20141030145648.png\" alt=\"f:id:omiend:20141030145648p:plain\" title=\"f:id:omiend:20141030145648p:plain\" class=\"hatena-fotolife\" itemprop=\"image\"></span></p>\n\n###\u3054\u6307\u6458\u306e\u70b9\u306a\u3069\u3042\u3063\u305f\u3089\u3088\u308d\u3057\u304f\u3067\u3059\n\nAccessToken\u306f\u545f\u304f\u6642\u306b\u4f7f\u3046\u3093\u3060\u308d\u3046\u3051\u3069\u3001\u30a2\u30d7\u30ea\u4e0a\u3067\u306f\u30ed\u30b0\u30a4\u30f3\u3068\u304b\u306b\u4f7f\u3048\u3070\u3044\u3044\u306e\u304b\u306a\n", "tags": ["PlayFramework", "Scala", "Twitter4J"]}