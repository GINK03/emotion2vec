{"context": " More than 1 year has passed since last update.\u63a8\u5b9a\u3055\u308c\u305f\u7d71\u8a08\u30e2\u30c7\u30eb\u3092\u6bd4\u8f03\u3059\u308b\u691c\u5b9a\u3092\u884c\u3046\uff0e\n\u672c\u7ae0\u3067\u306f\u5c24\u5ea6\u6bd4\u691c\u5b9a\u3092\u6271\u3046\uff0e\n\n\u7d71\u8a08\u5b66\u7684\u306a\u691c\u5b9a\u306e\u67a0\u7d44\u307f\n\u624b\u9806\n\n\u4f7f\u7528\u3059\u308b\u30c7\u30fc\u30bf\u3092\u78ba\u5b9a\u3059\u308b\n\u76ee\u7684\u3068\u30c7\u30fc\u30bf\u306e\u69cb\u9020\u306b\u5bfe\u5fdc\u3057\u305f\u9069\u5207\u306a\u7d71\u8a08\u30e2\u30c7\u30eb\u3092\u8a2d\u8a08\u3057\uff0c\u30d1\u30e9\u30e1\u30fc\u30bf\u306e\u6700\u5c24\u63a8\u5b9a\u3092\u3059\u308b\n\n\n\u30d1\u30e9\u30e1\u30fc\u30bf\u306e\u5c11\u306a\u3044\u30e2\u30c7\u30eb\u3068\u591a\u3044\u30e2\u30c7\u30eb\uff08\u5358\u7d14\u30e2\u30c7\u30eb\u3068\u8907\u96d1\u30e2\u30c7\u30eb\uff09\u3092\u691c\u5b9a\u3067\u306f\uff0c\n\u5e30\u7121\u4eee\u8aac\u3068\u5bfe\u7acb\u4eee\u8aac\u3068\u3088\u3076\uff0e\n\n\nNeyman-Pearson\u306e\u691c\u5b9a\u306e\u67a0\u7d44\u307f\n\u7d71\u8a08\u30e2\u30c7\u30eb\u306e\u691c\u5b9a\u3067\u306f\uff0c\u300c\u5e30\u7121\u4eee\u8aac\u306f\u6b63\u3057\u3044\u300d\u3068\u3044\u3046\u547d\u984c\u3092\u5426\u5b9a\u3067\u304d\u308b\u304b\u3069\u3046\u304b\u3092\u8abf\u3079\u308b\uff0e\n\n\u30e2\u30c7\u30eb\u306e\u5f53\u3066\u306f\u307e\u308a\u306e\u826f\u3055\u306a\u3069\u3092\u691c\u5b9a\u7d71\u8a08\u91cf\u3068\u3057\u3066\u6271\u3046\n\u5e30\u7121\u4eee\u8aac\u304c\u300c\u771f\u306e\u30e2\u30c7\u30eb\u300d\u3067\u3042\u308b\u3068\u4eee\u5b9a\u3059\u308b\n\u691c\u5b9a\u7d71\u8a08\u91cf\u306e\u3070\u3089\u3064\u304d\uff08\u78ba\u7387\u5206\u5e03\uff09\u3092\u8abf\u3079\u3066\uff0c\u691c\u5b9a\u7d71\u8a08\u91cf\u306e\u5024\u304c\u201d\u3042\u308a\u304c\u3061\u7bc4\u56f2\u201d\u3092\u6c7a\u3081\u308b\n\u201d\u3042\u308a\u304c\u3061\u306a\u7bc4\u56f2\u201d\u306e\u5927\u304d\u3055\u304c95\uff05\u306e\u3068\u304d\uff0c5\uff05\u306e\u6709\u610f\u6c34\u6e96\u3092\u8a2d\u5b9a\u3057\u305f\u8a00\u3048\u308b\n\u5bfe\u7acb\u4eee\u8aac\u306e\u30e2\u30c7\u30eb\u3067\u5f97\u3089\u308c\u305f\u691c\u5b9a\u7d71\u8a08\u91cf\u304c\u201d\u3042\u308a\u304c\u3061\u306a\u7bc4\u56f2\u201d\u304b\u3089\u306f\u307f\u51fa\u3066\u3044\u308c\u3070\uff0c\u5e30\u7121\u4eee\u8aac\u3092\u68c4\u5374\u3057\uff0c\u5bfe\u7acb\u4eee\u8aac\u3092\u652f\u6301\u3059\u308b\n\n\n\u5c24\u5ea6\u6bd4\u691c\u5b9a\u306e\u4f8b\u984c\uff1a\u9038\u8131\u5ea6\u306e\u5dee\u3092\u8abf\u3079\u308b\n\u4f7f\u7528\u3059\u308b\u7d71\u8a08\u30e2\u30c7\u30eb\uff1a\n\n\n\u4e00\u5b9a\u30e2\u30c7\u30eb\uff1a\u7a2e\u5b50\u6570\u306e\u5e73\u5747$\\lambda_i$\u304c\u5b9a\u6570\u3067\u3042\u308a\uff0c\u4f53\u30b5\u30a4\u30ba$x_i$\u306b\u4f9d\u5b58\u3057\u306a\u3044\u30e2\u30c7\u30eb\uff08\u50be\u304d$\\beta_2=0$\uff1b\u30d1\u30e9\u30e1\u30fc\u30bf\u6570$k=1$\uff09\n\nx\u30e2\u30c7\u30eb\uff1a\u7a2e\u5b50\u6570\u306e\u5e73\u5747$\\lambda_i$\u304c\u4f53\u30b5\u30a4\u30ba$x_i$\u306b\u4f9d\u5b58\u3059\u308b\u30e2\u30c7\u30eb\uff08\u50be\u304d$\\beta_2 \\neq 0$\uff1b\u30d1\u30e9\u30e1\u30fc\u30bf\u6570$k=2$\uff09\n\n\n\n\n\u30e2\u30c7\u30eb\n\u30d1\u30e9\u30e1\u30fc\u30bf\u6570$k$\n$\\log L ^ \\ast$\ndeviance\uff08$-2\\log L ^ \\ast$\uff09\nresidual deviance\nAIC\n\n\n\n\n\u4e00\u5b9a\n1\n-237.6\n475.3\n89.5\n477.3\n\n\nx\n2\n-235.4\n470.8\n85.0\n474.8\n\n\nfull\n100\n-192.9\n385.6\n0.0\n585.8\n\n\n\n\u5c24\u5ea6\u6bd4\u691c\u5b9a\u3067\u306f\uff0c\u5c24\u5ea6\u6bd4\u306e\u5bfe\u6570\u306b-2\u3092\u304b\u3051\u305f\u9038\u8131\u5ea6\u306e\u5dee\u3092\u7528\u3044\u308b\uff0e\u672c\u4f8b\u984c\u306e\u5834\u5408\u306f\uff0c\n\\begin{eqnarray}\n\\frac{L_1 ^\\ast}{L_2 ^\\ast} &=& \\frac{\u4e00\u5b9a\u30e2\u30c7\u30eb\u306e\u6700\u5927\u5c24\u5ea6\uff1a\\exp(-237.6)}{x\u30e2\u30c7\u30eb\u306e\u6700\u5927\u5c24\u5ea6\uff1a\\exp(-235.4)} \\\\\n\\Delta D_{1,2} &=& -2 * (\\log L_1 ^ \\ast - \\log L_2 ^ \\ast) \\\\\n\\Delta D_{1,2} &=& D_1 - D_2 \\\\\n\\Delta D_{1,2} &=& 4.5\n\\end{eqnarray}\n\n\u3053\u306e\u9038\u8131\u5ea6\u304c4.5\u6539\u5584\u3055\u308c\u305f\u3053\u3068\u3092\u8a55\u4fa1\u3059\u308b\uff0e\n\n\u5e30\u7121\u4eee\u8aac\uff1a\u4e00\u5b9a\u30e2\u30c7\u30eb\uff08\u30d1\u30e9\u30e1\u30fc\u30bf\u6570$k=1, \\beta_2=0$\uff09\n\u5bfe\u7acb\u4eee\u8aac\uff1ax\u30e2\u30c7\u30eb\uff08$k=2,\\beta_2 \\neq 0$\uff09\n\n\n\n\n\u5e30\u7121\u4eee\u8aac\u306f\n$\\Delta D_{1,2}$\u306f\u3081\u3063\u305f\u306b\u7121\u3044\u5dee\uff08\u68c4\u5374\uff09\n$\\Delta D_{1,2}$\u306f\u3088\u304f\u3042\u308b\u5dee\uff08\u68c4\u5374\u3067\u304d\u306a\u3044\uff09\n\n\n\n\n\u771f\u306e\u30e2\u30c7\u30eb\u3067\u3042\u308b\n\u7b2c\u4e00\u7a2e\u306e\u904e\u8aa4\n\uff08\u554f\u984c\u306a\u3057\uff09\n\n\n\u771f\u306e\u30e2\u30c7\u30eb\u3067\u306f\u306a\u3044\n\uff08\u554f\u984c\u306a\u3057\uff09\n\u7b2c\u4e8c\u7a2e\u306e\u904e\u8aa4\n\n\n\n\nNeyman-Pearson\u306e\u691c\u5b9a\u306e\u67a0\u7d44\u307f\u3067\u306f\u7b2c\u4e00\u7a2e\u306e\u904e\u8aa4\u306e\u691c\u8a0e\u306e\u307f\u306b\u5c02\u5ff5\n\n\u624b\u9806\u3068\u3057\u3066\u306f\n\n\u5e30\u7121\u4eee\u8aac\u3067\u3042\u308b\u4e00\u5b9a\u30e2\u30c7\u30eb\u304c\u6b63\u3057\u3044\u3082\u306e\uff08\u771f\u306e\u30e2\u30c7\u30eb\u3067\u3042\u308b\uff09\u3068\u4eee\u5b9a\u3059\u308b\n\u89b3\u6e2c\u30c7\u30fc\u30bf\u306b\u4e00\u5b9a\u30e2\u30c7\u30eb\u3092\u5f53\u3066\u306f\u3081\u308b\u3068\uff0c$\\hat{\\beta_1}=2.06$\u306b\u306a\u3063\u305f\u304b\u3089\uff0c\u3053\u308c\u304c\u771f\u306e\u30e2\u30c7\u30eb\u3068\u4e00\u7dd2\u3068\u8003\u3048\u308b\uff0e\n\u771f\u306e\u30e2\u30c7\u30eb\u304b\u3089\u30c7\u30fc\u30bf\u3092\u4f5c\u6210\uff0c\u305d\u306e\u305f\u3073\u306bx\u30e2\u30c7\u30eb\u3092\u5f53\u3066\u306f\u3081\u308c\u3070$\\Delta D_{1, 2}$\u3092\u8a08\u7b97\u3067\u304d\uff0c$\\Delta D_{1,2}$\u306e\u5206\u5e03\u304c\u308f\u304b\u308b\n\u4e00\u5b9a\u30e2\u30c7\u30eb\u3068x\u30e2\u30c7\u30eb\u306e\u9038\u8131\u5ea6\u306e\u5dee\u304c$\\Delta D_{1,2} \\geq 4.5$\u3068\u306a\u308b\u78ba\u7387P\u304c\u6c42\u3081\u3089\u308c\u308b\uff0e\n$\\Delta D_{1,2}=4.5$\u304c\u3042\u308a\u3048\u306a\u3044\u5024\u3068\u307f\u306a\u3055\u308c\u305f\u5834\u5408\uff0c\u5e30\u7121\u4eee\u8aac\u306f\u68c4\u5374\u3055\u308c\uff0c\u5bfe\u7acb\u4eee\u8aac\u304c\u81ea\u52d5\u7684\u306b\u63a1\u629e\u3055\u308c\u308b\uff0e\n\n\u4e00\u5b9a\u30e2\u30c7\u30eb\u3068x\u30e2\u30c7\u30eb\u306e\u9038\u8131\u5ea6\u306e\u5dee\u304c$\\Delta D_{1,2} \\geq 4.5$\u3068\u306a\u308b\u78ba\u7387$P$\u3092P\u5024\u3068\u547c\u3076\uff0e\n\nP\u5024\u304c\u300c\u5927\u304d\u3044\u300d\uff1a$\\Delta D_{1,2}=4.5$\u306f\u3088\u304f\u3042\u308b\u3053\u3068 \u2192 \u5e30\u7121\u4eee\u8aac\u68c4\u5374\u3067\u304d\u306a\u3044\nP\u5024\u304c\u300c\u5c0f\u3055\u3044\u300d\uff1a$\\Delta D_{1,2}=4.5$\u306f\u3068\u3066\u3082\u73cd\u3057\u3044\u3053\u3068\u3060\u306a\u2192\u5e30\u7121\u4eee\u8aac\u3092\u68c4\u5374\u3057\u3088\u3046\uff0c\u6b8b\u3063\u305fx\u30e2\u30c7\u30eb\u3092\u6b63\u3057\u3044\u3068\u3059\u308b\n\n\u6709\u610f\u6c34\u6e96\u3092\u4e8b\u524d\u306b\uff08\u81ea\u5206\u3067\uff09\u6c7a\u3081\uff0c\n\n$P \\geq \\alpha$\uff1a\u5e30\u7121\u4eee\u8aac\u306f\u68c4\u5374\u3067\u304d\u306a\u3044\n$P < \\alpha$\uff1a\u5e30\u7121\u4eee\u8aac\u306f\u68c4\u5374\u3067\u304d\u308b\n\n\u3068\u3059\u308b\uff0e\n\u5e30\u7121\u4eee\u8aac\uff1a\u4e00\u5b9a\u30e2\u30c7\u30eb\u304c\u771f\u306e\u30e2\u30c7\u30eb\u3067\u3042\u308b\u4e16\u754c\u306b\u304a\u3051\u308b\u691c\u5b9a\u7d71\u8a08\u91cf\u3067\u3042\u308b$\\Delta D_{1,2}\u304c4.5\u3088\u308a\u5927\u304d\u304f\u306a\u308b\uff08\u7b2c\u4e00\u7a2e\u306e\u904e\u8aa4\u3092\u304a\u304b\u3059\uff09\u78ba\u7387\u3092\u7b97\u51fa\u3059\u308b\uff0e\n\n\u30d1\u30e9\u30e1\u30c8\u30ea\u30c3\u30af\u30d6\u30fc\u30c8\u30b9\u30c8\u30e9\u30c3\u30d7\u6cd5\n\u4e0a\u8a18\uff13\uff0e\u306e\u30c7\u30fc\u30bf\u3092\u751f\u6210\u3059\u308b\u904e\u7a0b\u3092\u4e71\u6570\u306b\u3088\u308b\u30b7\u30e5\u30df\u30ec\u30fc\u30b7\u30e7\u30f3\u306b\u3082\u3068\u3065\u3044\u3066\u884c\u3046\u65b9\u6cd5\uff0e\nfit1\u306b\u4e00\u5b9a\u30e2\u30c7\u30eb\u306e\u7d50\u679c\u304c\uff0cfit2\u306bx\u30e2\u30c7\u30eb\u306e\u7d50\u679c\u304c\u683c\u7d0d\u3055\u308c\u3066\u3044\u308b\u3068\u3059\u308b\uff0e\n>>> model1 = smf.glm('y~1', data=d, family=sm.families.Poisson())\n>>> model2 = smf.glm('y~x', data=d, family=sm.families.Poisson())\n>>> fit1 = model1.fit()\n>>> fit2 = model2.fit()\n\n# fit1$deviance - fit2$deviance\n>>> fit1.deviance - fit2.deviance\n4.5139410788540459\n\n\u4e00\u5b9a\u30e2\u30c7\u30eb\u306b\u3088\u3063\u3066\u63a8\u5b9a\u3055\u308c\u305f\u5e73\u5747\u7a2e\u5b50\u6570$\\lambda=\\exp(2.06)=7.85$\u3088\u308a\uff0c\n\u751f\u6210\u3059\u3079\u304d\u30c7\u30fc\u30bf\u306f\u300c\u5e73\u5747\u304c7.85\u3067\u3042\u308b100\u500b\u306e\u30dd\u30a2\u30bd\u30f3\u4e71\u6570\u300d\u3068\u306a\u308b\uff0e\n# d$y.rnd <- rpois(100, lambda=mean(d$y))\n>>> d.y.rnd = sci.poisson.rvs(d.y.mean(), size=100)\n# fit1 <- glm(y.rnd ~ 1, data=d, family=poisson)\n>>> model1 = smf.glm('y.rnd ~ 1', data=d, family=sm.families.Poisson())\n>>> fit1 = model1.fit()\n# fit2 <- glm(y.rnd ~ x, data=d, family=poisson)\n>>> model2 = smf.glm('y.rnd ~ x', data=d, family=sm.families.Poisson())\n>>> fit2 = model2.fit()\n# fit1$deviance - fit2$deviance\n>>> fit1.deviance - fit2.deviance\n0.63270346107955788\n\n\u5e73\u5747\u5024\u304c\u4e00\u5b9a\u306e\u30dd\u30a2\u30bd\u30f3\u4e71\u6570\u3067\u3042\u308b\u30c7\u30fc\u30bf\u306b\u5bfe\u3057\u3066\uff0c\u9038\u8131\u5ea6\u306e\u5dee\u304c1.92\u3068\u306a\u308b\uff0e\n\n\u300c\u771f\u306e\u30e2\u30c7\u30eb\u300d\u3067\u3042\u308b\u4e00\u5b9a\u30e2\u30c7\u30eb\u3088\u308a\u3082\u7121\u610f\u5473\u306a\u8aac\u660e\u5909\u6570\u3092\u3082\u3064x\u30e2\u30c7\u30eb\u306e\u307b\u3046\u304c\u5f53\u3066\u306f\u307e\u308a\u304c\u826f\u3044\n\n\u3053\u306e\u30b9\u30c6\u30c3\u30d7\u30921000\u56de\u307b\u3069\u7e70\u308a\u8fd4\u305b\u3070\uff0c\u691c\u5b9a\u7d71\u8a08\u91cf\u306e\u5206\u5e03\uff0c\u3053\u306e\u4f8b\u984c\u3067\u8a00\u3046\u300c\u9038\u8131\u5ea6\u306e\u5dee$\\Delta D_{1, 2}$\u306e\u5206\u5e03\u300d\u3092\u4e88\u6e2c\u3067\u304d\u308b\uff0e\ndef get_dd(d):\n    sample_d = len(d)\n    mean_y = d.y.mean()\n    d.y.rnd = sci.poisson.rvs(mu=mean_y, size=sample_d)\n    model1 = smf.glm('y.rnd ~ 1', data=d, family=sm.families.Poisson())\n    model2 = smf.glm('y.rnd ~ x', data=d, family=sm.families.Poisson())\n    fit1 = model1.fit()\n    fit2 = model2.fit()\n    return fit1.deviance - fit2.deviance\n\n\ndef pb(d, bootstrap=1000):\n    return pandas.Series([get_dd(d) for _ in xrange(bootstrap)])\n\nresults = pb(d)\nresults.describe()\n\nresults[results >= 4.5].count()\n\n\nresults[results>= 4.5].count()\n# 32\n\nresults.quantile(.95)\n# 3.6070094508948025\n\nresults.hist()\n\n\n\n\u4e0a\u8a18\u306e\u7d50\u679c\u304b\u3089\uff0c\u300c\u9038\u8131\u5ea6\u306e\u5dee\u304c4.5\u3088\u308a\u5927\u304d\u304f\u306a\u308b\u78ba\u7387\u300d\u306f$32/1000$\uff0c\u3059\u306a\u308f\u3061$P=0.032$\u3068\u306a\u308a\uff0c\n\u307e\u305f$P=0.05$\u3068\u306a\u308b\u9038\u8131\u5ea6\u306e\u5dee$\\Delta D_{1,2}$\u3092\u6c42\u3081\u308b\u3068\uff0e$\\Delta D_{1,2} \\leq 3.61$\u3068\u306a\u308b\uff0e\n\u4ee5\u4e0a\u304b\u3089\uff0c\n\u300c\u9038\u8131\u5ea6\u306e\u5dee4.5\u306eP\u5024\u306f0.032\u3060\u3063\u305f\u306e\u3067\uff0c\u3053\u308c\u306f\u6709\u610f\u6c34\u6e960.05\u3088\u308a\u3082\u5c0f\u3055\u3044\u300d\u306e\u3067\u6709\u610f\u5dee\u304c\u3042\u308a\uff0c\n\u300c\u5e30\u7121\u4eee\u8aac\uff08\u4e00\u5b9a\u30e2\u30c7\u30eb\uff09\u306f\u68c4\u5374\u3055\u308c\uff0cx\u30e2\u30c7\u30eb\u304c\u6b8b\u308b\u306e\u3067\u3053\u308c\u3092\u63a1\u629e\u300d\u3068\u5224\u65ad\u3059\u308b\uff0e\n\n\u30ab\u30a4\u4e8c\u4e57\u5206\u5e03\u3092\u4f7f\u3063\u305f\u8fd1\u4f3c\u8a08\u7b97\u6cd5\n\u9038\u8131\u5ea6\u306e\u5dee$\\Delta D_{1,2}$\u306e\u78ba\u7387\u5206\u5e03\u306f\uff0c\u81ea\u7531\u5ea6$k_2 - k_1 = 2 - 1= 1$\u306e$\\chi^2$\u5206\u5e03\u3067\u8fd1\u4f3c\u3067\u304d\u308b\u5834\u5408\u304c\u3042\u308b\uff0e\n\n\u3069\u3046\u3084\u3089statsmodels\u306b\u306fGLM\u306b\u5bfe\u3057\u3066ANOVA\u306f\u306a\u3044\u3088\u3046\u3067\uff0c\uff0c\uff0c\n\n$\\chi^2$\u5206\u5e03\u8fd1\u4f3c\u306f\uff0c\u30b5\u30f3\u30d7\u30eb\u30b5\u30a4\u30ba\u304c\u5927\u304d\u3044\u5834\u5408\u306b\u6709\u52b9\u306a\u8fd1\u4f3c\u8a08\u7b97\u3067\u3042\u308b\uff0e\n\u8abf\u67fb\u3057\u305f\u500b\u4f53\u6570\u304c\u591a\u304f\u306a\u3044\u5c0f\u6a19\u672c\uff0c\u3082\u3057\u304f\u306f\u30c7\u30fc\u30bf\u306e\u3070\u3089\u3064\u304d\u304c\u30dd\u30a2\u30bd\u30f3\u5206\u5e03\u3067\u306f\u306a\u304f\uff0c\u7b49\u5206\u6563\u6b63\u898f\u5206\u5e03\u306e\u5834\u5408\u306b\u306f\uff0cPB\u6cd5\u304c\u3088\u3044\u3089\u3057\u3044\uff0e\n\n\u307e\u3068\u3081\n\u5c24\u5ea6\u6bd4\u691c\u5b9a\u3068AIC\u306b\u3088\u308b\u30e2\u30c7\u30eb\u9078\u629e\u3067\u306f\uff0c\u4e21\u65b9\u3068\u3082\u9038\u8131\u5ea6\u3068\u3044\u3046\u7d71\u8a08\u91cf\u306b\u6ce8\u76ee\u3057\u3066\u3044\u308b\uff0e\n\nAIC\uff1a\u300c\u826f\u3044\u4e88\u6e2c\u3092\u3059\u308b\u30e2\u30c7\u30eb\u300d\u306e\u9078\u629e\u304c\u76ee\u7684\n\u5c24\u5ea6\u6bd4\u691c\u5b9a\uff1a\u5e30\u7121\u4eee\u8aac\u306e\u5b89\u5168\u306a\u68c4\u5374\u304c\u76ee\u7684\n\n\u76ee\u7684\u306b\u5408\u308f\u305b\u3066\u9078\u3076\u3057\u304b\u306a\u3044\u3089\u3057\u3044\uff0e\n\n\u63a8\u5b9a\u3055\u308c\u305f\u7d71\u8a08\u30e2\u30c7\u30eb\u3092\u6bd4\u8f03\u3059\u308b\u691c\u5b9a\u3092\u884c\u3046\uff0e\n\u672c\u7ae0\u3067\u306f**\u5c24\u5ea6\u6bd4\u691c\u5b9a**\u3092\u6271\u3046\uff0e\n\n\n# \u7d71\u8a08\u5b66\u7684\u306a\u691c\u5b9a\u306e\u67a0\u7d44\u307f\n\n\u624b\u9806\n\n1. \u4f7f\u7528\u3059\u308b\u30c7\u30fc\u30bf\u3092\u78ba\u5b9a\u3059\u308b\n2. \u76ee\u7684\u3068\u30c7\u30fc\u30bf\u306e\u69cb\u9020\u306b\u5bfe\u5fdc\u3057\u305f\u9069\u5207\u306a\u7d71\u8a08\u30e2\u30c7\u30eb\u3092\u8a2d\u8a08\u3057\uff0c\u30d1\u30e9\u30e1\u30fc\u30bf\u306e\u6700\u5c24\u63a8\u5b9a\u3092\u3059\u308b\n\n> \u30d1\u30e9\u30e1\u30fc\u30bf\u306e\u5c11\u306a\u3044\u30e2\u30c7\u30eb\u3068\u591a\u3044\u30e2\u30c7\u30eb\uff08\u5358\u7d14\u30e2\u30c7\u30eb\u3068\u8907\u96d1\u30e2\u30c7\u30eb\uff09\u3092\u691c\u5b9a\u3067\u306f\uff0c\n**\u5e30\u7121\u4eee\u8aac**\u3068**\u5bfe\u7acb\u4eee\u8aac**\u3068\u3088\u3076\uff0e\n\n### Neyman-Pearson\u306e\u691c\u5b9a\u306e\u67a0\u7d44\u307f\n\n\u7d71\u8a08\u30e2\u30c7\u30eb\u306e\u691c\u5b9a\u3067\u306f\uff0c\u300c\u5e30\u7121\u4eee\u8aac\u306f\u6b63\u3057\u3044\u300d\u3068\u3044\u3046\u547d\u984c\u3092\u5426\u5b9a\u3067\u304d\u308b\u304b\u3069\u3046\u304b\u3092\u8abf\u3079\u308b\uff0e\n\n1. \u30e2\u30c7\u30eb\u306e\u5f53\u3066\u306f\u307e\u308a\u306e\u826f\u3055\u306a\u3069\u3092**\u691c\u5b9a\u7d71\u8a08\u91cf**\u3068\u3057\u3066\u6271\u3046\n2. \u5e30\u7121\u4eee\u8aac\u304c\u300c\u771f\u306e\u30e2\u30c7\u30eb\u300d\u3067\u3042\u308b\u3068\u4eee\u5b9a\u3059\u308b\n3. \u691c\u5b9a\u7d71\u8a08\u91cf\u306e\u3070\u3089\u3064\u304d\uff08\u78ba\u7387\u5206\u5e03\uff09\u3092\u8abf\u3079\u3066\uff0c\u691c\u5b9a\u7d71\u8a08\u91cf\u306e\u5024\u304c\u201d\u3042\u308a\u304c\u3061\u7bc4\u56f2\u201d\u3092\u6c7a\u3081\u308b\n4. \u201d\u3042\u308a\u304c\u3061\u306a\u7bc4\u56f2\u201d\u306e\u5927\u304d\u3055\u304c95\uff05\u306e\u3068\u304d\uff0c5\uff05\u306e\u6709\u610f\u6c34\u6e96\u3092\u8a2d\u5b9a\u3057\u305f\u8a00\u3048\u308b\n5. \u5bfe\u7acb\u4eee\u8aac\u306e\u30e2\u30c7\u30eb\u3067\u5f97\u3089\u308c\u305f\u691c\u5b9a\u7d71\u8a08\u91cf\u304c\u201d\u3042\u308a\u304c\u3061\u306a\u7bc4\u56f2\u201d\u304b\u3089\u306f\u307f\u51fa\u3066\u3044\u308c\u3070\uff0c\u5e30\u7121\u4eee\u8aac\u3092\u68c4\u5374\u3057\uff0c\u5bfe\u7acb\u4eee\u8aac\u3092\u652f\u6301\u3059\u308b\n\n\n# \u5c24\u5ea6\u6bd4\u691c\u5b9a\u306e\u4f8b\u984c\uff1a\u9038\u8131\u5ea6\u306e\u5dee\u3092\u8abf\u3079\u308b\n\n\u4f7f\u7528\u3059\u308b\u7d71\u8a08\u30e2\u30c7\u30eb\uff1a\n \n - **\u4e00\u5b9a\u30e2\u30c7\u30eb**\uff1a\u7a2e\u5b50\u6570\u306e\u5e73\u5747$\\lambda_i$\u304c\u5b9a\u6570\u3067\u3042\u308a\uff0c\u4f53\u30b5\u30a4\u30ba$x_i$\u306b\u4f9d\u5b58\u3057\u306a\u3044\u30e2\u30c7\u30eb\uff08\u50be\u304d$\\beta_2=0$\uff1b\u30d1\u30e9\u30e1\u30fc\u30bf\u6570$k=1$\uff09\n - **x\u30e2\u30c7\u30eb**\uff1a\u7a2e\u5b50\u6570\u306e\u5e73\u5747$\\lambda_i$\u304c\u4f53\u30b5\u30a4\u30ba$x_i$\u306b\u4f9d\u5b58\u3059\u308b\u30e2\u30c7\u30eb\uff08\u50be\u304d$\\beta_2 \\neq 0$\uff1b\u30d1\u30e9\u30e1\u30fc\u30bf\u6570$k=2$\uff09\n\n\n| \u30e2\u30c7\u30eb | \u30d1\u30e9\u30e1\u30fc\u30bf\u6570$k$ | $\\log L ^ \\ast$ | deviance\uff08$-2\\log L ^ \\ast$\uff09| residual deviance |AIC |\n|:------|--------------:|----------------:|----------------------------:|------------------:|--:|\n| \u4e00\u5b9a   |             1 |          -237.6 |                       475.3 |              89.5 |477.3|\n| x     |             2 |          -235.4 |                       470.8 |              85.0 |474.8|\n| full  |           100 |          -192.9 |                       385.6 |               0.0 |585.8|\n\n\n\u5c24\u5ea6\u6bd4\u691c\u5b9a\u3067\u306f\uff0c\u5c24\u5ea6\u6bd4\u306e\u5bfe\u6570\u306b-2\u3092\u304b\u3051\u305f\u9038\u8131\u5ea6\u306e\u5dee\u3092\u7528\u3044\u308b\uff0e\u672c\u4f8b\u984c\u306e\u5834\u5408\u306f\uff0c\n\n```math\n\\begin{eqnarray}\n\\frac{L_1 ^\\ast}{L_2 ^\\ast} &=& \\frac{\u4e00\u5b9a\u30e2\u30c7\u30eb\u306e\u6700\u5927\u5c24\u5ea6\uff1a\\exp(-237.6)}{x\u30e2\u30c7\u30eb\u306e\u6700\u5927\u5c24\u5ea6\uff1a\\exp(-235.4)} \\\\\n\\Delta D_{1,2} &=& -2 * (\\log L_1 ^ \\ast - \\log L_2 ^ \\ast) \\\\\n\\Delta D_{1,2} &=& D_1 - D_2 \\\\\n\\Delta D_{1,2} &=& 4.5\n\\end{eqnarray}\n```\n\n\u3053\u306e\u9038\u8131\u5ea6\u304c4.5\u6539\u5584\u3055\u308c\u305f\u3053\u3068\u3092\u8a55\u4fa1\u3059\u308b\uff0e\n\n- \u5e30\u7121\u4eee\u8aac\uff1a\u4e00\u5b9a\u30e2\u30c7\u30eb\uff08\u30d1\u30e9\u30e1\u30fc\u30bf\u6570$k=1, \\beta_2=0$\uff09\n- \u5bfe\u7acb\u4eee\u8aac\uff1ax\u30e2\u30c7\u30eb\uff08$k=2,\\beta_2 \\neq 0$\uff09\n\n\n\n| \u5e30\u7121\u4eee\u8aac\u306f | $\\Delta D_{1,2}$\u306f\u3081\u3063\u305f\u306b\u7121\u3044\u5dee\uff08\u68c4\u5374\uff09 | $\\Delta D_{1,2}$\u306f\u3088\u304f\u3042\u308b\u5dee\uff08\u68c4\u5374\u3067\u304d\u306a\u3044\uff09 |\n|:------|:--------------:|:----------------:|\n| \u771f\u306e\u30e2\u30c7\u30eb\u3067\u3042\u308b   | **\u7b2c\u4e00\u7a2e\u306e\u904e\u8aa4** |  \uff08\u554f\u984c\u306a\u3057\uff09 |\n| \u771f\u306e\u30e2\u30c7\u30eb\u3067\u306f\u306a\u3044  | \uff08\u554f\u984c\u306a\u3057\uff09 |  **\u7b2c\u4e8c\u7a2e\u306e\u904e\u8aa4** |\n\n\n## Neyman-Pearson\u306e\u691c\u5b9a\u306e\u67a0\u7d44\u307f\u3067\u306f**\u7b2c\u4e00\u7a2e\u306e\u904e\u8aa4\u306e\u691c\u8a0e\u306e\u307f\u306b\u5c02\u5ff5**\n\u624b\u9806\u3068\u3057\u3066\u306f\n\n1. \u5e30\u7121\u4eee\u8aac\u3067\u3042\u308b\u4e00\u5b9a\u30e2\u30c7\u30eb\u304c\u6b63\u3057\u3044\u3082\u306e\uff08\u771f\u306e\u30e2\u30c7\u30eb\u3067\u3042\u308b\uff09\u3068\u4eee\u5b9a\u3059\u308b\n2. \u89b3\u6e2c\u30c7\u30fc\u30bf\u306b\u4e00\u5b9a\u30e2\u30c7\u30eb\u3092\u5f53\u3066\u306f\u3081\u308b\u3068\uff0c$\\hat{\\beta_1}=2.06$\u306b\u306a\u3063\u305f\u304b\u3089\uff0c\u3053\u308c\u304c\u771f\u306e\u30e2\u30c7\u30eb\u3068\u4e00\u7dd2\u3068\u8003\u3048\u308b\uff0e\n3. \u771f\u306e\u30e2\u30c7\u30eb\u304b\u3089\u30c7\u30fc\u30bf\u3092\u4f5c\u6210\uff0c\u305d\u306e\u305f\u3073\u306bx\u30e2\u30c7\u30eb\u3092\u5f53\u3066\u306f\u3081\u308c\u3070$\\Delta D_{1, 2}$\u3092\u8a08\u7b97\u3067\u304d\uff0c$\\Delta D_{1,2}$\u306e\u5206\u5e03\u304c\u308f\u304b\u308b\n4. \u4e00\u5b9a\u30e2\u30c7\u30eb\u3068x\u30e2\u30c7\u30eb\u306e\u9038\u8131\u5ea6\u306e\u5dee\u304c$\\Delta D_{1,2} \\geq 4.5$\u3068\u306a\u308b\u78ba\u7387P\u304c\u6c42\u3081\u3089\u308c\u308b\uff0e\n5. $\\Delta D_{1,2}=4.5$\u304c\u3042\u308a\u3048\u306a\u3044\u5024\u3068\u307f\u306a\u3055\u308c\u305f\u5834\u5408\uff0c\u5e30\u7121\u4eee\u8aac\u306f\u68c4\u5374\u3055\u308c\uff0c\u5bfe\u7acb\u4eee\u8aac\u304c\u81ea\u52d5\u7684\u306b\u63a1\u629e\u3055\u308c\u308b\uff0e\n\n\n\u4e00\u5b9a\u30e2\u30c7\u30eb\u3068x\u30e2\u30c7\u30eb\u306e\u9038\u8131\u5ea6\u306e\u5dee\u304c$\\Delta D_{1,2} \\geq 4.5$\u3068\u306a\u308b\u78ba\u7387$P$\u3092**P\u5024**\u3068\u547c\u3076\uff0e\n\n- P\u5024\u304c\u300c\u5927\u304d\u3044\u300d\uff1a$\\Delta D_{1,2}=4.5$\u306f\u3088\u304f\u3042\u308b\u3053\u3068 \u2192 \u5e30\u7121\u4eee\u8aac\u68c4\u5374\u3067\u304d\u306a\u3044\n- P\u5024\u304c\u300c\u5c0f\u3055\u3044\u300d\uff1a$\\Delta D_{1,2}=4.5$\u306f\u3068\u3066\u3082\u73cd\u3057\u3044\u3053\u3068\u3060\u306a\u2192\u5e30\u7121\u4eee\u8aac\u3092\u68c4\u5374\u3057\u3088\u3046\uff0c\u6b8b\u3063\u305fx\u30e2\u30c7\u30eb\u3092\u6b63\u3057\u3044\u3068\u3059\u308b\n\n**\u6709\u610f\u6c34\u6e96**\u3092\u4e8b\u524d\u306b\uff08\u81ea\u5206\u3067\uff09\u6c7a\u3081\uff0c\n\n- $P \\geq \\alpha$\uff1a\u5e30\u7121\u4eee\u8aac\u306f\u68c4\u5374\u3067\u304d\u306a\u3044\n- $P < \\alpha$\uff1a\u5e30\u7121\u4eee\u8aac\u306f\u68c4\u5374\u3067\u304d\u308b\n\n\u3068\u3059\u308b\uff0e\n\n\u5e30\u7121\u4eee\u8aac\uff1a\u4e00\u5b9a\u30e2\u30c7\u30eb\u304c\u771f\u306e\u30e2\u30c7\u30eb\u3067\u3042\u308b\u4e16\u754c\u306b\u304a\u3051\u308b\u691c\u5b9a\u7d71\u8a08\u91cf\u3067\u3042\u308b$\\Delta D_{1,2}\u304c4.5\u3088\u308a\u5927\u304d\u304f\u306a\u308b\uff08\u7b2c\u4e00\u7a2e\u306e\u904e\u8aa4\u3092\u304a\u304b\u3059\uff09\u78ba\u7387\u3092\u7b97\u51fa\u3059\u308b\uff0e\n\n\n## \u30d1\u30e9\u30e1\u30c8\u30ea\u30c3\u30af\u30d6\u30fc\u30c8\u30b9\u30c8\u30e9\u30c3\u30d7\u6cd5\n\n\u4e0a\u8a18\uff13\uff0e\u306e\u30c7\u30fc\u30bf\u3092\u751f\u6210\u3059\u308b\u904e\u7a0b\u3092\u4e71\u6570\u306b\u3088\u308b\u30b7\u30e5\u30df\u30ec\u30fc\u30b7\u30e7\u30f3\u306b\u3082\u3068\u3065\u3044\u3066\u884c\u3046\u65b9\u6cd5\uff0e\n`fit1`\u306b\u4e00\u5b9a\u30e2\u30c7\u30eb\u306e\u7d50\u679c\u304c\uff0c`fit2`\u306bx\u30e2\u30c7\u30eb\u306e\u7d50\u679c\u304c\u683c\u7d0d\u3055\u308c\u3066\u3044\u308b\u3068\u3059\u308b\uff0e\n\n\n```pycon\n>>> model1 = smf.glm('y~1', data=d, family=sm.families.Poisson())\n>>> model2 = smf.glm('y~x', data=d, family=sm.families.Poisson())\n>>> fit1 = model1.fit()\n>>> fit2 = model2.fit()\n\n# fit1$deviance - fit2$deviance\n>>> fit1.deviance - fit2.deviance\n4.5139410788540459\n```\n\n\u4e00\u5b9a\u30e2\u30c7\u30eb\u306b\u3088\u3063\u3066\u63a8\u5b9a\u3055\u308c\u305f\u5e73\u5747\u7a2e\u5b50\u6570$\\lambda=\\exp(2.06)=7.85$\u3088\u308a\uff0c\n\u751f\u6210\u3059\u3079\u304d\u30c7\u30fc\u30bf\u306f\u300c**\u5e73\u5747\u304c7.85\u3067\u3042\u308b100\u500b\u306e\u30dd\u30a2\u30bd\u30f3\u4e71\u6570**\u300d\u3068\u306a\u308b\uff0e\n\n\n```pycon\n# d$y.rnd <- rpois(100, lambda=mean(d$y))\n>>> d.y.rnd = sci.poisson.rvs(d.y.mean(), size=100)\n# fit1 <- glm(y.rnd ~ 1, data=d, family=poisson)\n>>> model1 = smf.glm('y.rnd ~ 1', data=d, family=sm.families.Poisson())\n>>> fit1 = model1.fit()\n# fit2 <- glm(y.rnd ~ x, data=d, family=poisson)\n>>> model2 = smf.glm('y.rnd ~ x', data=d, family=sm.families.Poisson())\n>>> fit2 = model2.fit()\n# fit1$deviance - fit2$deviance\n>>> fit1.deviance - fit2.deviance\n0.63270346107955788\n```\n\n\n\u5e73\u5747\u5024\u304c\u4e00\u5b9a\u306e\u30dd\u30a2\u30bd\u30f3\u4e71\u6570\u3067\u3042\u308b\u30c7\u30fc\u30bf\u306b\u5bfe\u3057\u3066\uff0c\u9038\u8131\u5ea6\u306e\u5dee\u304c1.92\u3068\u306a\u308b\uff0e\n\n> \u300c\u771f\u306e\u30e2\u30c7\u30eb\u300d\u3067\u3042\u308b\u4e00\u5b9a\u30e2\u30c7\u30eb\u3088\u308a\u3082\u7121\u610f\u5473\u306a\u8aac\u660e\u5909\u6570\u3092\u3082\u3064x\u30e2\u30c7\u30eb\u306e\u307b\u3046\u304c\u5f53\u3066\u306f\u307e\u308a\u304c\u826f\u3044\n\n\u3053\u306e\u30b9\u30c6\u30c3\u30d7\u30921000\u56de\u307b\u3069\u7e70\u308a\u8fd4\u305b\u3070\uff0c**\u691c\u5b9a\u7d71\u8a08\u91cf\u306e\u5206\u5e03**\uff0c\u3053\u306e\u4f8b\u984c\u3067\u8a00\u3046\u300c\u9038\u8131\u5ea6\u306e\u5dee$\\Delta D_{1, 2}$\u306e\u5206\u5e03\u300d\u3092\u4e88\u6e2c\u3067\u304d\u308b\uff0e\n\n```py\ndef get_dd(d):\n    sample_d = len(d)\n    mean_y = d.y.mean()\n    d.y.rnd = sci.poisson.rvs(mu=mean_y, size=sample_d)\n    model1 = smf.glm('y.rnd ~ 1', data=d, family=sm.families.Poisson())\n    model2 = smf.glm('y.rnd ~ x', data=d, family=sm.families.Poisson())\n    fit1 = model1.fit()\n    fit2 = model2.fit()\n    return fit1.deviance - fit2.deviance\n\n\ndef pb(d, bootstrap=1000):\n    return pandas.Series([get_dd(d) for _ in xrange(bootstrap)])\n\nresults = pb(d)\nresults.describe()\n\nresults[results >= 4.5].count()\n\n\nresults[results>= 4.5].count()\n# 32\n\nresults.quantile(.95)\n# 3.6070094508948025\n\nresults.hist()\n\n\n```\n\n\u4e0a\u8a18\u306e\u7d50\u679c\u304b\u3089\uff0c\u300c\u9038\u8131\u5ea6\u306e\u5dee\u304c4.5\u3088\u308a\u5927\u304d\u304f\u306a\u308b\u78ba\u7387\u300d\u306f$32/1000$\uff0c\u3059\u306a\u308f\u3061$P=0.032$\u3068\u306a\u308a\uff0c\n\u307e\u305f$P=0.05$\u3068\u306a\u308b\u9038\u8131\u5ea6\u306e\u5dee$\\Delta D_{1,2}$\u3092\u6c42\u3081\u308b\u3068\uff0e$\\Delta D_{1,2} \\leq 3.61$\u3068\u306a\u308b\uff0e\n\n\u4ee5\u4e0a\u304b\u3089\uff0c\n\u300c\u9038\u8131\u5ea6\u306e\u5dee4.5\u306eP\u5024\u306f0.032\u3060\u3063\u305f\u306e\u3067\uff0c\u3053\u308c\u306f\u6709\u610f\u6c34\u6e960.05\u3088\u308a\u3082\u5c0f\u3055\u3044\u300d\u306e\u3067\u6709\u610f\u5dee\u304c\u3042\u308a\uff0c\n\u300c\u5e30\u7121\u4eee\u8aac\uff08\u4e00\u5b9a\u30e2\u30c7\u30eb\uff09\u306f\u68c4\u5374\u3055\u308c\uff0cx\u30e2\u30c7\u30eb\u304c\u6b8b\u308b\u306e\u3067\u3053\u308c\u3092\u63a1\u629e\u300d\u3068\u5224\u65ad\u3059\u308b\uff0e\n\n\n\n\n\n## \u30ab\u30a4\u4e8c\u4e57\u5206\u5e03\u3092\u4f7f\u3063\u305f\u8fd1\u4f3c\u8a08\u7b97\u6cd5\n\n\n\u9038\u8131\u5ea6\u306e\u5dee$\\Delta D_{1,2}$\u306e\u78ba\u7387\u5206\u5e03\u306f\uff0c\u81ea\u7531\u5ea6$k_2 - k_1 = 2 - 1= 1$\u306e$\\chi^2$\u5206\u5e03\u3067\u8fd1\u4f3c\u3067\u304d\u308b\u5834\u5408\u304c\u3042\u308b\uff0e\n\n> \u3069\u3046\u3084\u3089`statsmodels`\u306b\u306fGLM\u306b\u5bfe\u3057\u3066ANOVA\u306f\u306a\u3044\u3088\u3046\u3067\uff0c\uff0c\uff0c\n\n$\\chi^2$\u5206\u5e03\u8fd1\u4f3c\u306f\uff0c**\u30b5\u30f3\u30d7\u30eb\u30b5\u30a4\u30ba\u304c\u5927\u304d\u3044\u5834\u5408\u306b\u6709\u52b9\u306a\u8fd1\u4f3c\u8a08\u7b97**\u3067\u3042\u308b\uff0e\n\n\u8abf\u67fb\u3057\u305f\u500b\u4f53\u6570\u304c\u591a\u304f\u306a\u3044\u5c0f\u6a19\u672c\uff0c\u3082\u3057\u304f\u306f\u30c7\u30fc\u30bf\u306e\u3070\u3089\u3064\u304d\u304c\u30dd\u30a2\u30bd\u30f3\u5206\u5e03\u3067\u306f\u306a\u304f\uff0c\u7b49\u5206\u6563\u6b63\u898f\u5206\u5e03\u306e\u5834\u5408\u306b\u306f\uff0cPB\u6cd5\u304c\u3088\u3044\u3089\u3057\u3044\uff0e\n\n\n# \u307e\u3068\u3081\n\n\u5c24\u5ea6\u6bd4\u691c\u5b9a\u3068AIC\u306b\u3088\u308b\u30e2\u30c7\u30eb\u9078\u629e\u3067\u306f\uff0c\u4e21\u65b9\u3068\u3082\u9038\u8131\u5ea6\u3068\u3044\u3046\u7d71\u8a08\u91cf\u306b\u6ce8\u76ee\u3057\u3066\u3044\u308b\uff0e\n\n- AIC\uff1a\u300c\u826f\u3044\u4e88\u6e2c\u3092\u3059\u308b\u30e2\u30c7\u30eb\u300d\u306e\u9078\u629e\u304c\u76ee\u7684\n- \u5c24\u5ea6\u6bd4\u691c\u5b9a\uff1a\u5e30\u7121\u4eee\u8aac\u306e\u5b89\u5168\u306a\u68c4\u5374\u304c\u76ee\u7684\n\n\u76ee\u7684\u306b\u5408\u308f\u305b\u3066\u9078\u3076\u3057\u304b\u306a\u3044\u3089\u3057\u3044\uff0e\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n", "tags": ["matplotlib", "numpy", "pandas", "Python"]}