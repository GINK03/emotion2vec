{"context": " More than 1 year has passed since last update.\n\nFirefox \u8a2d\u5b9a\u30ab\u30b9\u30bf\u30de\u30a4\u30ba\n\u696d\u52d9\u4e0a\u5fc5\u8981\u306b\u306a\u308a\u3001\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3092VBS\u3067\u4f5c\u6210\u3002\nos\u30d0\u30fc\u30b8\u30e7\u30f3\u53d6\u5f97\u3057\u3066\u3001\u30d5\u30a9\u30eb\u30c0\u30d1\u30b9\u3092\u8a2d\u5b9a\u3002\n\u3082\u3063\u3068\u7d30\u304b\u304f\u3067\u304d\u308b\u3051\u308c\u3069\u3001WinXP\u3058\u3083\u306a\u304b\u3063\u305f\u3089Win7\u3050\u3089\u3044\u306e\u5224\u65ad\u3067\u7528\u4ef6\u3068\u3057\u3066\u306f\u305f\u308a\u308b\u306e\u3067\u3002\nSet nwk = WScript.CreateObject(\"WScript.Network\")\nSet fso = CreateObject(\"Scripting.FileSystemObject\")\n\ntmpUserName = nwk.UserName\n\nDim strComputer\nDim Wmi\nDim colTarget\nDim strWork\nDim objRow\nDim aData\n\nstrComputer = \".\"\nSet Wmi = GetObject(\"winmgmts:\" & \"{impersonationLevel=impersonate}!\\\\\" & strComputer & \"\\root\\cimv2\")\nSet colTarget = Wmi.ExecQuery( \"select Version from Win32_OperatingSystem\" )\nFor Each objRow in colTarget\n  strWork = objRow.Version\nNext\naData = Split( strWork, \".\" )\nstrWork = aData(0) & \".\" & aData(1)\n\nif CDbl( strWork ) = 5.1 then\n  'WinXP\n  tmp = \"C:\\Documents and Settings\\\" & tmpUserName & \"\\Application Data\\Mozilla\\Firefox\\Profiles\"\nelse\n  'Win7\n  tmp = \"C:\\Users\\\" & tmpUserName & \"\\AppData\\Roaming\\Mozilla\\Firefox\\Profiles\"\nend if\n\nIf fso.FolderExists(tmp) Then\n  Set src = fso.GetFolder(tmp) ' \u5bfe\u8c61\u30d5\u30a9\u30eb\u30c0\u306e\u6307\u5b9a\n  '\u6307\u5b9a\u306e\u30d5\u30a9\u30eb\u30c0\u306b\u683c\u7d0d\u3055\u308c\u305f\u5404\u30b5\u30d6\u30d5\u30a9\u30eb\u30c0\u3092\u51e6\u7406\u3059\u308b\n  tmpfolder = \"\"\n  For Each FolderName In src.Subfolders\n    tmpfolder = FolderName\n    If fso.FolderExists(tmpfolder) Then\n      Set oLog = FSO.CreateTextFile(tmpfolder & \"\\user.js\")\n      '\u8d77\u52d5\u6642\u306b\u958b\u304f\u30da\u30fc\u30b8\u3092\u30db\u30fc\u30e0\u30da\u30fc\u30b8\u306b\u3059\u308b\n      oLog.WriteLine(\"user_pref('browser.startup.page', 1);\")\n      '\u8d77\u52d5\u6642\u306e\u30db\u30fc\u30e0\u30da\u30fc\u30b8\n      oLog.WriteLine(\"user_pref('browser.startup.homepage','http://www.yahoo.co.jp');\")         \n      '\u65b0\u898f\u30bf\u30d6\u8d77\u52d5\u6642\u306e\u30db\u30fc\u30e0\u30da\u30fc\u30b8\n      oLog.WriteLine(\"user_pref('browser.newtab.url', 'http://www.yahoo.co.jp');\")\n      '\u30da\u30fc\u30b8\u5148\u8aad\u307f\u3092\u7121\u52b9\n      oLog.WriteLine(\"user_pref('network.prefetch-next',false);\")\n      '\u30d0\u30c3\u30af\u30b0\u30e9\u30a6\u30f3\u30c9\u3067\u30bf\u30d6\u8aad\u307f\u8fbc\u307f\u7121\u52b9\n      oLog.WriteLine(\"user_pref('browser.tabs.loadDivertedInBackground', false);\")\n      'Web\u30d6\u30e9\u30a6\u30b6\u306e\u65e2\u5b9a\u8a2d\u5b9a\u753b\u9762\u8868\u793a\u7121\u52b9\n      oLog.WriteLine(\"user_pref('browser.shell.checkDefaultBrowser', false);\")\n      '\u30a2\u30c3\u30d7\u30c7\u30fc\u30c8\u78ba\u8a8d\u7121\u52b9\n      oLog.WriteLine(\"user_pref('app.update.enabled', false);\") \n      oLog.Close()\n      Set oLog = Nothing\n    End If\n  Next\nEnd If\n\n##Firefox \u8a2d\u5b9a\u30ab\u30b9\u30bf\u30de\u30a4\u30ba\n\u696d\u52d9\u4e0a\u5fc5\u8981\u306b\u306a\u308a\u3001\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3092VBS\u3067\u4f5c\u6210\u3002\nos\u30d0\u30fc\u30b8\u30e7\u30f3\u53d6\u5f97\u3057\u3066\u3001\u30d5\u30a9\u30eb\u30c0\u30d1\u30b9\u3092\u8a2d\u5b9a\u3002\n\u3082\u3063\u3068\u7d30\u304b\u304f\u3067\u304d\u308b\u3051\u308c\u3069\u3001WinXP\u3058\u3083\u306a\u304b\u3063\u305f\u3089Win7\u3050\u3089\u3044\u306e\u5224\u65ad\u3067\u7528\u4ef6\u3068\u3057\u3066\u306f\u305f\u308a\u308b\u306e\u3067\u3002\n\n```\nSet nwk = WScript.CreateObject(\"WScript.Network\")\nSet fso = CreateObject(\"Scripting.FileSystemObject\")\n\ntmpUserName = nwk.UserName\n\nDim strComputer\nDim Wmi\nDim colTarget\nDim strWork\nDim objRow\nDim aData\n\nstrComputer = \".\"\nSet Wmi = GetObject(\"winmgmts:\" & \"{impersonationLevel=impersonate}!\\\\\" & strComputer & \"\\root\\cimv2\")\nSet colTarget = Wmi.ExecQuery( \"select Version from Win32_OperatingSystem\" )\nFor Each objRow in colTarget\n  strWork = objRow.Version\nNext\naData = Split( strWork, \".\" )\nstrWork = aData(0) & \".\" & aData(1)\n\nif CDbl( strWork ) = 5.1 then\n  'WinXP\n  tmp = \"C:\\Documents and Settings\\\" & tmpUserName & \"\\Application Data\\Mozilla\\Firefox\\Profiles\"\nelse\n  'Win7\n  tmp = \"C:\\Users\\\" & tmpUserName & \"\\AppData\\Roaming\\Mozilla\\Firefox\\Profiles\"\nend if\n\nIf fso.FolderExists(tmp) Then\n  Set src = fso.GetFolder(tmp) ' \u5bfe\u8c61\u30d5\u30a9\u30eb\u30c0\u306e\u6307\u5b9a\n  '\u6307\u5b9a\u306e\u30d5\u30a9\u30eb\u30c0\u306b\u683c\u7d0d\u3055\u308c\u305f\u5404\u30b5\u30d6\u30d5\u30a9\u30eb\u30c0\u3092\u51e6\u7406\u3059\u308b\n  tmpfolder = \"\"\n  For Each FolderName In src.Subfolders\n    tmpfolder = FolderName\n    If fso.FolderExists(tmpfolder) Then\n      Set oLog = FSO.CreateTextFile(tmpfolder & \"\\user.js\")\n      '\u8d77\u52d5\u6642\u306b\u958b\u304f\u30da\u30fc\u30b8\u3092\u30db\u30fc\u30e0\u30da\u30fc\u30b8\u306b\u3059\u308b\n      oLog.WriteLine(\"user_pref('browser.startup.page', 1);\")\n      '\u8d77\u52d5\u6642\u306e\u30db\u30fc\u30e0\u30da\u30fc\u30b8\n      oLog.WriteLine(\"user_pref('browser.startup.homepage','http://www.yahoo.co.jp');\") \t    \n      '\u65b0\u898f\u30bf\u30d6\u8d77\u52d5\u6642\u306e\u30db\u30fc\u30e0\u30da\u30fc\u30b8\n      oLog.WriteLine(\"user_pref('browser.newtab.url', 'http://www.yahoo.co.jp');\")\n      '\u30da\u30fc\u30b8\u5148\u8aad\u307f\u3092\u7121\u52b9\n      oLog.WriteLine(\"user_pref('network.prefetch-next',false);\")\n      '\u30d0\u30c3\u30af\u30b0\u30e9\u30a6\u30f3\u30c9\u3067\u30bf\u30d6\u8aad\u307f\u8fbc\u307f\u7121\u52b9\n      oLog.WriteLine(\"user_pref('browser.tabs.loadDivertedInBackground', false);\")\n      'Web\u30d6\u30e9\u30a6\u30b6\u306e\u65e2\u5b9a\u8a2d\u5b9a\u753b\u9762\u8868\u793a\u7121\u52b9\n      oLog.WriteLine(\"user_pref('browser.shell.checkDefaultBrowser', false);\")\n      '\u30a2\u30c3\u30d7\u30c7\u30fc\u30c8\u78ba\u8a8d\u7121\u52b9\n      oLog.WriteLine(\"user_pref('app.update.enabled', false);\") \n      oLog.Close()\n      Set oLog = Nothing\n    End If\n  Next\nEnd If\n```\n", "tags": ["firefox"]}