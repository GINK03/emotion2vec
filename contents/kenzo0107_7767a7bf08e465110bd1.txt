{"context": "\n\n\u6982\u8981\nPrometheus\u5165\u9580 \u306b\u3042\u308b\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb\u3092\nAnsible\u3067\u7c21\u5358\u306b\u69cb\u7bc9\u3067\u304d\u308b\u3088\u3046\u306b\u3057\u305f\u3001\n\u3068\u3044\u3046\u3082\u306e\u3067\u3059\u3002\n\u5148\u65e52016\u5e746\u670814\u65e5\u3001\nLINE\u682a\u5f0f\u4f1a\u793e\u3067\u306ePrometheus Casual Talks #1\u306b\u53c2\u52a0\u3057\n\u30ca\u30ec\u30c3\u30b8\u306e\u304a\u3055\u3089\u3044\u306a\u3069\u3057\u305f\u304f\u3001\n\u69cb\u7bc9\u6cd5\u3092\u307e\u3068\u3081\u307e\u3057\u305f\u3002\n\nPrometheus\u3068\u306f\n\u6700\u8fd1\u8a71\u984c\u306ePull\u578b\u306eQuery Filtering\u53ef\u80fd\u3067 Grafana\u7b49\u3068\u9023\u643a\u3067\u304d\u308b \u30e2\u30cb\u30bf\u30ea\u30f3\u30b0/Alert\u30c4\u30fc\u30eb\u3067\u3059\u3002\n\n\u69cb\u6210\n\n\nPrometheus Server \u00d7 1\nPrometheus Client \u00d7 2\n\n\n\u74b0\u5883\n\nCentOS 6.5\nPrometheus Server 0.20.0\nSupervisor 3.3.0\nGo 1.6.2\nAnsibl 2.1.0.0\nVagrant 1.8.1\nMacOSX 10.11.5\n\n\n\u524d\u63d0\u6761\u4ef6\n\u4ee5\u4e0b\u30c4\u30fc\u30eb\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u3066\u304a\u3044\u3066\u304f\u3060\u3055\u3044\u3002\n\nVirtualBox\nVagrant\nAnsible\n\n\n\u4f7f\u3044\u65b9\n\n1. git repository \u3092 clone\n$ git clone https://github.com/kenzo0107/Vagrant-Prometheus\n\n\n2. Vagrant VM \u8d77\u52d5\n$ cd Vagrant-Prometheus\n$ vagrant up\n\n3 node running !  \n\n1 node: Prometheus Server\n\n\n192.168.11.30\n\n\nother 2 nodes: Prometheus Client Server\n\n\n192.168.33.31\n192.168.33.32\n\n\n\n\n3. ssh.config \u8ffd\u52a0\n$ vagrant ssh-config > ssh.config\n\n\n4. ping \u758e\u901a\u8a66\u9a13\n$ ansible default -m ping\n\nserver | SUCCESS => {\n    \"changed\": false,\n    \"ping\": \"pong\"\n}\nclient1 | SUCCESS => {\n    \"changed\": false,\n    \"ping\": \"pong\"\n}\nclient2 | SUCCESS => {\n    \"changed\": false,\n    \"ping\": \"pong\"\n}\n\nok, success.\n\n5. 2node \u306b PrometheusClient \u8a2d\u5b9a\n$ ansible-playbook set_clients_prometheus.yml\n\n\n6. PrometheusClient \u306e\u8d77\u52d5\u78ba\u8a8d\n\u4ee5\u4e0bPrometheusClient\u3092\u8d77\u52d5\u3057\u3066\u3044\u308b\u30b5\u30fc\u30d0\u306b\u30a2\u30af\u30bb\u30b9\u3057\n\u8d77\u52d5\u3055\u308c\u3066\u3044\u308b\u304b\u78ba\u8a8d\u3057\u307e\u3059\u3002\n\n\nhttp://192.168.11.31:8080/metrics\n\nhttp://192.168.11.32:8080/metrics\n\n\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u8868\u793a\u3055\u308c\u308c\u3070\u6210\u529f\u3067\u3059\u3002\n\n\n7. PrometheusServer \u8a2d\u5b9a\n$ ansible-playbook set_server_prometheus.yml\n\n\n8. PrometheusServer \u78ba\u8a8d\nhttp://192.168.33.30:9090 \u306b\u30a2\u30af\u30bb\u30b9\n\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u8868\u793a\u3055\u308c\u308c\u3070\u6210\u529f\u3067\u3059\u3002\n\n\u662f\u975e\u591a\u5c11\u306a\u308a\u3068\u3082\u4e00\u52a9\u3068\u306a\u308c\u3070\u4f55\u3088\u308a\u3067\u3059\uff01\n\u3044\u3058\u304f\u308a\u5012\u3057\u3066\u307f\u3066\u304f\u3060\u3055\u3044\uff01\n\u4ee5\u4e0a\n## \u6982\u8981\n\n[Prometheus\u5165\u9580](https://prometheus.io/docs/introduction/getting_started/) \u306b\u3042\u308b\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb\u3092\nAnsible\u3067\u7c21\u5358\u306b\u69cb\u7bc9\u3067\u304d\u308b\u3088\u3046\u306b\u3057\u305f\u3001\n\u3068\u3044\u3046\u3082\u306e\u3067\u3059\u3002\n\n\u5148\u65e52016\u5e746\u670814\u65e5\u3001\nLINE\u682a\u5f0f\u4f1a\u793e\u3067\u306e[Prometheus Casual Talks #1](http://connpass.com/event/32859/)\u306b\u53c2\u52a0\u3057\n\u30ca\u30ec\u30c3\u30b8\u306e\u304a\u3055\u3089\u3044\u306a\u3069\u3057\u305f\u304f\u3001\n\u69cb\u7bc9\u6cd5\u3092\u307e\u3068\u3081\u307e\u3057\u305f\u3002\n\n## Prometheus\u3068\u306f\n\n\u6700\u8fd1\u8a71\u984c\u306ePull\u578b\u306eQuery Filtering\u53ef\u80fd\u3067 Grafana\u7b49\u3068\u9023\u643a\u3067\u304d\u308b \u30e2\u30cb\u30bf\u30ea\u30f3\u30b0/Alert\u30c4\u30fc\u30eb\u3067\u3059\u3002\n\n## \u69cb\u6210\n\n![Imgur](http://i.imgur.com/pfazhaR.png)\n\n- Prometheus Server \u00d7 1\n- Prometheus Client \u00d7 2\n\n## \u74b0\u5883\n\n- CentOS 6.5\n- Prometheus Server 0.20.0\n- Supervisor 3.3.0\n- Go 1.6.2\n- Ansibl 2.1.0.0\n- Vagrant 1.8.1\n- MacOSX 10.11.5\n\n## \u524d\u63d0\u6761\u4ef6\n\n\u4ee5\u4e0b\u30c4\u30fc\u30eb\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u3066\u304a\u3044\u3066\u304f\u3060\u3055\u3044\u3002\n\n* VirtualBox\n* Vagrant\n* Ansible\n\n\n## \u4f7f\u3044\u65b9\n\n### 1. git repository \u3092 clone\n\n```\n$ git clone https://github.com/kenzo0107/Vagrant-Prometheus\n```\n\n## 2. Vagrant VM \u8d77\u52d5\n\n```\n$ cd Vagrant-Prometheus\n$ vagrant up\n```\n\n3 node running !  \n\n- 1 node: Prometheus Server\n  - 192.168.11.30\n- other 2 nodes: Prometheus Client Server\n  - 192.168.33.31\n  - 192.168.33.32\n\n## 3. ssh.config \u8ffd\u52a0\n\n```\n$ vagrant ssh-config > ssh.config\n```\n\n## 4. ping \u758e\u901a\u8a66\u9a13\n\n```\n$ ansible default -m ping\n\nserver | SUCCESS => {\n    \"changed\": false,\n    \"ping\": \"pong\"\n}\nclient1 | SUCCESS => {\n    \"changed\": false,\n    \"ping\": \"pong\"\n}\nclient2 | SUCCESS => {\n    \"changed\": false,\n    \"ping\": \"pong\"\n}\n```\n\nok, success.\n\n## 5. 2node \u306b PrometheusClient \u8a2d\u5b9a\n\n```\n$ ansible-playbook set_clients_prometheus.yml\n```\n\n## 6. PrometheusClient \u306e\u8d77\u52d5\u78ba\u8a8d\n\n\u4ee5\u4e0bPrometheusClient\u3092\u8d77\u52d5\u3057\u3066\u3044\u308b\u30b5\u30fc\u30d0\u306b\u30a2\u30af\u30bb\u30b9\u3057\n\u8d77\u52d5\u3055\u308c\u3066\u3044\u308b\u304b\u78ba\u8a8d\u3057\u307e\u3059\u3002\n\n- <http://192.168.11.31:8080/metrics>  \n- <http://192.168.11.32:8080/metrics>\n\n\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u8868\u793a\u3055\u308c\u308c\u3070\u6210\u529f\u3067\u3059\u3002\n\n<img src=\"http://i.imgur.com/igPci2Z.png\" width=\"400px\" />\n\n\n## 7. PrometheusServer \u8a2d\u5b9a\n\n```\n$ ansible-playbook set_server_prometheus.yml\n```\n\n## 8. PrometheusServer \u78ba\u8a8d\n\n<http://192.168.33.30:9090> \u306b\u30a2\u30af\u30bb\u30b9\n\n\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u8868\u793a\u3055\u308c\u308c\u3070\u6210\u529f\u3067\u3059\u3002\n\n<img src=\"http://i.imgur.com/XDTarz3.png\" width=\"400px\" />\n\n\u662f\u975e\u591a\u5c11\u306a\u308a\u3068\u3082\u4e00\u52a9\u3068\u306a\u308c\u3070\u4f55\u3088\u308a\u3067\u3059\uff01\n\u3044\u3058\u304f\u308a\u5012\u3057\u3066\u307f\u3066\u304f\u3060\u3055\u3044\uff01\n\n\u4ee5\u4e0a\n", "tags": ["prometheus", "Ansible", "vagrant", "Go"]}