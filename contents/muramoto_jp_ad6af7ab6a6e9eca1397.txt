{"context": "\u25bc\u5165\u529b\u6642\u306b\u30c1\u30a7\u30c3\u30af\u3059\u308b\n\ninput_check.vba\n\nPrivate Function fsInputCheck() As Boolean\n  Dim wCtr     As String\n  Dim w\u30e1\u30e2    As String\n  Dim wNo      As Integer\n  Dim wMSG     As String\n\n  fsInputCheck = False\n  sIDCard = Nz(Me.ID\u30b3\u30fc\u30c9.Value, 0)\n  s\u30e1\u30e2 = Nz(Me.txt\u30e1\u30e2.Value, \"\")\n  sCHK(0) = Nz(Me.chk000.Value, 0)\n\n  For wNo = 1 To 100\n    wCtr = \"ctrFL\" & Format(wNo, \"000\")\n    If Me.Controls(wCtr).Visible = True Then\n      Select Case wNo\n        'Case 15: sFLD(wNO) = Nz(Me.Controls(wCtr).Value, \"0\")\n        Case Else: sFLD(wNo) = Nz(Me.Controls(wCtr).Value, \"\")\n      End Select\n    End If\n  Next wNo\n\n  '--- Check ---\n  'If IsDate(s\u8fd4\u9001\u65e5) = False Then\n  '  wMSG = wMSG & \"\u8fd4\u9001\u65e5\u304c\u4e0d\u6b63\u3067\u3059\u3002\" & vbCrLf\n  'End If\n\n  If wMSG <> \"\" Then\n    MsgBox wMSG, vbOKOnly + vbExclamation, \"\u78ba\u8a8d\"\n    Exit Function\n  End If\n\n  '--- \u65b0\u898f ---\n  If gmEdit2 = 3 Then\n    If fsCodeCheck(2) = False Then Exit Function\n  End If\n\n  fsInputCheck = True\nEnd Function\n\n\n\n\u25bc\u7d42\u4e86\u6642\u306b\u4ed6\u306e\u30d5\u30a9\u30fc\u30e0\u3092\u9589\u3058\u308b\n\nForm_Unload.vba\n\nPrivate Sub Form_Unload(Cancel As Integer)\n  If gmEdit2 > 1 Then\n    subMsg = MsgBox(\"\u7de8\u96c6\u4e2d\u306f\u3001\u7d42\u4e86\u3067\u304d\u307e\u305b\u3093\u3002\u5f37\u5236\u7d42\u4e86\u3057\u307e\u3059\u304b\u3002\", vbYesNo + vbCritical + vbDefaultButton2, \"\u78ba\u8a8d\")\n    If subMsg = vbYes Then\n      gmEdit2 = 1\n    Else\n      Cancel = 1\n      Exit Sub\n    End If\n  End If\n\n  '\u4e00\u89a7\n  If SysCmd(acSysCmdGetObjectState, acForm, \"F_BmCard02List\") <> 0 And gWin = 0 Then\n    gWin = 1\n    If gFrmClose = 0 Then\n      DoCmd.Close acForm, \"F_BmCard02List\"\n    End If\n  End If\nEnd Sub\n\n\n\n\u25bcSQL \u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u63a5\u7d9a\n\nDAO_Connect.vba\nSet Db = DBEngine.OpenDatabase(\"\", False, False, \"ODBC;Driver={SQL Server};\" & _\n\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000 \"Server=XXXX;\" & _\n\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000 \"Database=XXX;UID=XXX;PWD=XXX;\")\n\n\nhttp://vba-geek.jp/blog-entry-83.html\n\u25bc\u30b3\u30f3\u30dc\u30dc\u30c3\u30af\u30b9\u306b\u30ea\u30b9\u30c8\u306e\u65e2\u5b9a\u5024\u3092\u30bb\u30c3\u30c8\u3059\u308b\u3002\n=[\u30b3\u30f3\u30dc1].[ItemData](0)\n=[\u30b3\u30f3\u30dc1].[ItemData]([\u30b3\u30f3\u30dc1].[ListCount]-1)\n\n\u25bc\u5165\u529b\u6642\u306b\u30c1\u30a7\u30c3\u30af\u3059\u308b\n\n```input_check.vba\n\nPrivate Function fsInputCheck() As Boolean\n  Dim wCtr     As String\n  Dim w\u30e1\u30e2    As String\n  Dim wNo      As Integer\n  Dim wMSG     As String\n  \n  fsInputCheck = False\n  sIDCard = Nz(Me.ID\u30b3\u30fc\u30c9.Value, 0)\n  s\u30e1\u30e2 = Nz(Me.txt\u30e1\u30e2.Value, \"\")\n  sCHK(0) = Nz(Me.chk000.Value, 0)\n  \n  For wNo = 1 To 100\n    wCtr = \"ctrFL\" & Format(wNo, \"000\")\n    If Me.Controls(wCtr).Visible = True Then\n      Select Case wNo\n        'Case 15: sFLD(wNO) = Nz(Me.Controls(wCtr).Value, \"0\")\n        Case Else: sFLD(wNo) = Nz(Me.Controls(wCtr).Value, \"\")\n      End Select\n    End If\n  Next wNo\n  \n  '--- Check ---\n  'If IsDate(s\u8fd4\u9001\u65e5) = False Then\n  '  wMSG = wMSG & \"\u8fd4\u9001\u65e5\u304c\u4e0d\u6b63\u3067\u3059\u3002\" & vbCrLf\n  'End If\n  \n  If wMSG <> \"\" Then\n    MsgBox wMSG, vbOKOnly + vbExclamation, \"\u78ba\u8a8d\"\n    Exit Function\n  End If\n  \n  '--- \u65b0\u898f ---\n  If gmEdit2 = 3 Then\n    If fsCodeCheck(2) = False Then Exit Function\n  End If\n  \n  fsInputCheck = True\nEnd Function\n\n```\n\n\u25bc\u7d42\u4e86\u6642\u306b\u4ed6\u306e\u30d5\u30a9\u30fc\u30e0\u3092\u9589\u3058\u308b\n\n```Form_Unload.vba\n\nPrivate Sub Form_Unload(Cancel As Integer)\n  If gmEdit2 > 1 Then\n    subMsg = MsgBox(\"\u7de8\u96c6\u4e2d\u306f\u3001\u7d42\u4e86\u3067\u304d\u307e\u305b\u3093\u3002\u5f37\u5236\u7d42\u4e86\u3057\u307e\u3059\u304b\u3002\", vbYesNo + vbCritical + vbDefaultButton2, \"\u78ba\u8a8d\")\n    If subMsg = vbYes Then\n      gmEdit2 = 1\n    Else\n      Cancel = 1\n      Exit Sub\n    End If\n  End If\n  \n  '\u4e00\u89a7\n  If SysCmd(acSysCmdGetObjectState, acForm, \"F_BmCard02List\") <> 0 And gWin = 0 Then\n    gWin = 1\n    If gFrmClose = 0 Then\n      DoCmd.Close acForm, \"F_BmCard02List\"\n    End If\n  End If\nEnd Sub\n\n```\n\n\u25bcSQL \u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u63a5\u7d9a\n\n```DAO_Connect.vba\nSet Db = DBEngine.OpenDatabase(\"\", False, False, \"ODBC;Driver={SQL Server};\" & _\n\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000 \"Server=XXXX;\" & _\n\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000 \"Database=XXX;UID=XXX;PWD=XXX;\")\n```\nhttp://vba-geek.jp/blog-entry-83.html\n\n\u25bc\u30b3\u30f3\u30dc\u30dc\u30c3\u30af\u30b9\u306b\u30ea\u30b9\u30c8\u306e\u65e2\u5b9a\u5024\u3092\u30bb\u30c3\u30c8\u3059\u308b\u3002\n\n```\n=[\u30b3\u30f3\u30dc1].[ItemData](0)\n=[\u30b3\u30f3\u30dc1].[ItemData]([\u30b3\u30f3\u30dc1].[ListCount]-1)\n```\n\n\n", "tags": ["access"]}