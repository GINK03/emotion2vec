{"context": " More than 1 year has passed since last update.NGUI\u304b\u3089\u305d\u308d\u305d\u308duGUI\u3092\u52c9\u5f37\u3057\u3088\u3046\u3068\u601d\u3063\u3066\u4f5c\u3063\u305f\u3082\u306e\u3002\n\u30de\u30b9\u30af\u304c\u4fbf\u5229\u3060\u3063\u305f\u306e\u3067\u5186\u30b0\u30e9\u30d5\u3092\u3055\u304f\u3063\u3068\u4f5c\u3063\u3066\u307f\u307e\u3057\u305f\u3002\n\n\n\u4ed5\u7d44\u307f\n\u4ed5\u7d44\u307f\u7684\u306b\u306f\u7c21\u5358\u3067\u3001\u753b\u50cf\u306eImage Type\u3092Filled\u306b\u3057\u3066\u3001z\u306e\u56de\u8ee2\u89d2\u5ea6\u3092\u8db3\u3057\u305f\u3060\u3051\u3002\n\u30a2\u30cb\u30e1\u30fc\u30b7\u30e7\u30f3\u306f\u30de\u30b9\u30af\n\u4f7f\u7528\u753b\u50cf\u306f\u5186\u306e\u767d\u3044\u753b\u50cf\uff11\u679a\u306e\u307f\u3067\u3059\u3002\n\n\u30d2\u30a8\u30e9\u30eb\u30ad\u30fc\n\nCanvas\u914d\u4e0b\u306f\u3053\u3093\u306a\u611f\u3058\u3002\n\nBg :\u80cc\u666f\u753b\u50cf\nRoulette : Mask\u3068\u30de\u30b9\u30af\u7528\u306e\u753b\u50cf\u3092\u30a2\u30bf\u30c3\u30c1\u3057\u305f\u3082\u306e(\u30eb\u30fc\u30ec\u30c3\u30c8\u3058\u3083\u306a\u3044\u3051\u3069)\n\n\nPlate : \u4e00\u3064\u306e\u8272\u3002\u3053\u308c\u3092\u8907\u88fd\u3057\u3066\u5186\u30b0\u30e9\u30d5\u3092\u4f5c\u3063\u3066\u3044\u307e\u3059\n\n\n\nResetBtn : \u30ea\u30bb\u30c3\u30c8\u30dc\u30bf\u30f3\nAnimBtn : \u30a2\u30cb\u30e1\u30fc\u30b7\u30e7\u30f3\u30dc\u30bf\u30f3\n\nImage\u306e\u8a2d\u5b9a\u306f\n\nimageType:Filled\nFillMethod:Radial 360\nFillOrigin:Top\n\n\u306b\u3057\u3066\u3044\u307e\u3059\n\nscript\n\u5b9f\u306f\u30eb\u30fc\u30ec\u30c3\u30c8\u3092\u4f5c\u308d\u3046\u3068\u3057\u3066\u3044\u305f\u306e\u3067RouletteManager.cs\u3068\u3044\u3046\u540d\u524d\u306b\u306a\u3063\u3066\u304a\u308a\u307e\u3059\u3002\n\nusing UnityEngine;\nusing UnityEngine.UI;\nusing System.Collections;\nusing System.Collections.Generic;\n\npublic class RouletteManager : MonoBehaviour {\n\n    public Transform roulette;\n    public GameObject plate;\n\n    private int[] sizeList;\n\n    void Awake()\n    {\n        Init();\n    }\n\n    public void Reset()\n    {\n        Init();\n    }\n\n    public void Show()\n    {\n        StartCoroutine(ShowAnim());\n    }\n\n    // \u5186\u30b0\u30e9\u30d5\u304c\u8868\u793a\u3055\u308c\u308b\u6f14\u51fa\n    private IEnumerator ShowAnim()\n    {\n        bool flg = true;\n        roulette.GetComponent<Image>().fillAmount = 0;\n        float speed = 0.05f;\n        while(flg)\n        {\n            roulette.GetComponent<Image>().fillAmount += speed;\n            if(roulette.GetComponent<Image>().fillAmount >= 1) flg = false;\n            yield return new WaitForSeconds(0.01f);\n        }\n    }\n\n    private void Init()\n    {\n        // \u65e2\u306b\u4f5c\u6210\u3057\u305f\u30b0\u30e9\u30d5\u304c\u3042\u308c\u3070\u524a\u9664\u3059\u308b\n        foreach(Transform tran in roulette)\n        {\n            if(tran.name != \"Plate\") Destroy (tran.gameObject);\n        }\n\n        int kindCount = Random.Range(3, 8);  // \u6700\u5927\u306e\u8272\u306e\u6570\n        sizeList = new int[kindCount];       // \u5272\u5408\u306e\u30ea\u30b9\u30c8\n        int max = 100;                      // \u30b0\u30e9\u30d5\u306e\u6bd4\u7387 100\u304c\u6700\u5927\u3000\u3053\u3053\u304b\u3089\u3069\u3093\u3069\u3093\u5f15\u3044\u3066\u3044\u304f\n        for(int i = 0; i < kindCount; i++)\n        {\n            if(max <= 0) break;\n            // Plate\u3092\u30b3\u30d4\u30fc\u3057\u3066\u30b5\u30a4\u30ba\u306a\u3069\u3092\u8abf\u7bc0\n            GameObject plateCopy = Instantiate(plate) as GameObject;\n            plateCopy.transform.SetParent(roulette);\n            plateCopy.transform.localPosition = Vector3.zero;\n            plateCopy.transform.localScale = Vector3.one;\n\n            // \u6700\u5f8c\u306e\uff11\u3064\u306e\u5834\u5408\u306f\u6b8b\u308a\u306e\u5168\u3066\u3092\u3042\u3066\u306f\u3081\u308b\n            if(i == kindCount - 1)\n                sizeList[i] = max;\n            else \n            {\n                // \u3042\u307e\u308a\u306b\u5927\u304d\u3044\u306e\u3068\u5c0f\u3055\u3044\u306e\u306f\u3044\u3084\u3060\u3063\u305f\u306e\u3067\u3061\u3087\u3063\u3068\u3044\u3058\u3044\u3058\n                int no = max;\n                if(max > 40) no = 40;\n\n                if(max < 10)\n                    no = max;\n                else\n                {\n                    sizeList[i] = Random.Range(1, no + 1);\n                    if(max - sizeList[i] < 10) sizeList[i] = max;\n                }\n            }\n            // z\u306e\u89d2\u5ea6\u3092\u8a2d\u5b9a\n            plateCopy.transform.localEulerAngles = new Vector3(0, 0, (100f - (float)max) / 100f * -360f);\n\n            // \u5186\u306e\u30b5\u30a4\u30ba\u3092fillAmount\u306b\u8a2d\u5b9a\n            plateCopy.GetComponent<Image>().fillAmount = (float)sizeList[i] / 100f;\n\n            // \u8272\u3092\u30e9\u30f3\u30c0\u30e0\u306b\u8a2d\u5b9a \u660e\u308b\u3081\u306b\u3057\u3066\u307e\u3059\n            plateCopy.GetComponent<Image>().color = new Vector4(Random.Range(0.6f, 1f), Random.Range(0.6f, 1f), Random.Range(0.6f, 1f), 1);;\n            plateCopy.SetActive(true);\n            max -= sizeList[i];\n\n        }\n        roulette.GetComponent<Image>().fillAmount = 1;\n    }\n}\n\n\nNGUI\u304b\u3089\u305d\u308d\u305d\u308duGUI\u3092\u52c9\u5f37\u3057\u3088\u3046\u3068\u601d\u3063\u3066\u4f5c\u3063\u305f\u3082\u306e\u3002\n\u30de\u30b9\u30af\u304c\u4fbf\u5229\u3060\u3063\u305f\u306e\u3067\u5186\u30b0\u30e9\u30d5\u3092\u3055\u304f\u3063\u3068\u4f5c\u3063\u3066\u307f\u307e\u3057\u305f\u3002\n\n<img src=\"https://qiita-image-store.s3.amazonaws.com/0/46444/da2f1e1d-0955-521b-fdac-c6ddc9a055e6.gif\" width=\"400px\">\n\n##\u4ed5\u7d44\u307f\n\u4ed5\u7d44\u307f\u7684\u306b\u306f\u7c21\u5358\u3067\u3001\u753b\u50cf\u306eImage Type\u3092Filled\u306b\u3057\u3066\u3001z\u306e\u56de\u8ee2\u89d2\u5ea6\u3092\u8db3\u3057\u305f\u3060\u3051\u3002\n\u30a2\u30cb\u30e1\u30fc\u30b7\u30e7\u30f3\u306f\u30de\u30b9\u30af\n\u4f7f\u7528\u753b\u50cf\u306f\u5186\u306e\u767d\u3044\u753b\u50cf\uff11\u679a\u306e\u307f\u3067\u3059\u3002\n\n##\u30d2\u30a8\u30e9\u30eb\u30ad\u30fc\n<img src=\"https://qiita-image-store.s3.amazonaws.com/0/46444/21758ae4-c276-f8fc-0b50-e35f9009cd86.png\" width=\"200px\">\nCanvas\u914d\u4e0b\u306f\u3053\u3093\u306a\u611f\u3058\u3002\n\n- Bg :\u80cc\u666f\u753b\u50cf\n- Roulette : Mask\u3068\u30de\u30b9\u30af\u7528\u306e\u753b\u50cf\u3092\u30a2\u30bf\u30c3\u30c1\u3057\u305f\u3082\u306e(\u30eb\u30fc\u30ec\u30c3\u30c8\u3058\u3083\u306a\u3044\u3051\u3069)\n - Plate : \u4e00\u3064\u306e\u8272\u3002\u3053\u308c\u3092\u8907\u88fd\u3057\u3066\u5186\u30b0\u30e9\u30d5\u3092\u4f5c\u3063\u3066\u3044\u307e\u3059  \n- ResetBtn : \u30ea\u30bb\u30c3\u30c8\u30dc\u30bf\u30f3\n- AnimBtn : \u30a2\u30cb\u30e1\u30fc\u30b7\u30e7\u30f3\u30dc\u30bf\u30f3\n\nImage\u306e\u8a2d\u5b9a\u306f\n\n- imageType:Filled\n- FillMethod:Radial 360\n- FillOrigin:Top\n\n\u306b\u3057\u3066\u3044\u307e\u3059\n##script\n\u5b9f\u306f\u30eb\u30fc\u30ec\u30c3\u30c8\u3092\u4f5c\u308d\u3046\u3068\u3057\u3066\u3044\u305f\u306e\u3067RouletteManager.cs\u3068\u3044\u3046\u540d\u524d\u306b\u306a\u3063\u3066\u304a\u308a\u307e\u3059\u3002\n\n```csharp\n\nusing UnityEngine;\nusing UnityEngine.UI;\nusing System.Collections;\nusing System.Collections.Generic;\n\npublic class RouletteManager : MonoBehaviour {\n\n\tpublic Transform roulette;\n\tpublic GameObject plate;\n\t\n\tprivate int[] sizeList;\n\n\tvoid Awake()\n\t{\n\t\tInit();\n\t}\n\n\tpublic void Reset()\n\t{\n\t\tInit();\n\t}\n\n\tpublic void Show()\n\t{\n\t\tStartCoroutine(ShowAnim());\n\t}\n\n\t// \u5186\u30b0\u30e9\u30d5\u304c\u8868\u793a\u3055\u308c\u308b\u6f14\u51fa\n\tprivate IEnumerator ShowAnim()\n\t{\n\t\tbool flg = true;\n\t\troulette.GetComponent<Image>().fillAmount = 0;\n\t\tfloat speed = 0.05f;\n\t\twhile(flg)\n\t\t{\n\t\t\troulette.GetComponent<Image>().fillAmount += speed;\n\t\t\tif(roulette.GetComponent<Image>().fillAmount >= 1) flg = false;\n\t\t\tyield return new WaitForSeconds(0.01f);\n\t\t}\n\t}\n\n\tprivate void Init()\n\t{\n\t\t// \u65e2\u306b\u4f5c\u6210\u3057\u305f\u30b0\u30e9\u30d5\u304c\u3042\u308c\u3070\u524a\u9664\u3059\u308b\n\t\tforeach(Transform tran in roulette)\n\t\t{\n\t\t\tif(tran.name != \"Plate\") Destroy (tran.gameObject);\n\t\t}\n\n\t\tint kindCount = Random.Range(3, 8);\t // \u6700\u5927\u306e\u8272\u306e\u6570\n\t\tsizeList = new int[kindCount];\t\t // \u5272\u5408\u306e\u30ea\u30b9\u30c8\n\t\tint max = 100;\t\t\t\t\t\t// \u30b0\u30e9\u30d5\u306e\u6bd4\u7387 100\u304c\u6700\u5927\u3000\u3053\u3053\u304b\u3089\u3069\u3093\u3069\u3093\u5f15\u3044\u3066\u3044\u304f\n\t\tfor(int i = 0; i < kindCount; i++)\n\t\t{\n\t\t\tif(max <= 0) break;\n\t\t\t// Plate\u3092\u30b3\u30d4\u30fc\u3057\u3066\u30b5\u30a4\u30ba\u306a\u3069\u3092\u8abf\u7bc0\n\t\t\tGameObject plateCopy = Instantiate(plate) as GameObject;\n\t\t\tplateCopy.transform.SetParent(roulette);\n\t\t\tplateCopy.transform.localPosition = Vector3.zero;\n\t\t\tplateCopy.transform.localScale = Vector3.one;\n\n\t\t\t// \u6700\u5f8c\u306e\uff11\u3064\u306e\u5834\u5408\u306f\u6b8b\u308a\u306e\u5168\u3066\u3092\u3042\u3066\u306f\u3081\u308b\n\t\t\tif(i == kindCount - 1)\n\t\t\t\tsizeList[i] = max;\n\t\t\telse \n\t\t\t{\n\t\t\t\t// \u3042\u307e\u308a\u306b\u5927\u304d\u3044\u306e\u3068\u5c0f\u3055\u3044\u306e\u306f\u3044\u3084\u3060\u3063\u305f\u306e\u3067\u3061\u3087\u3063\u3068\u3044\u3058\u3044\u3058\n\t\t\t\tint no = max;\n\t\t\t\tif(max > 40) no = 40;\n\n\t\t\t\tif(max < 10)\n\t\t\t\t\tno = max;\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tsizeList[i] = Random.Range(1, no + 1);\n\t\t\t\t\tif(max - sizeList[i] < 10) sizeList[i] = max;\n\t\t\t\t}\n\t\t\t}\n\t\t\t// z\u306e\u89d2\u5ea6\u3092\u8a2d\u5b9a\n\t\t\tplateCopy.transform.localEulerAngles = new Vector3(0, 0, (100f - (float)max) / 100f * -360f);\n\n\t\t\t// \u5186\u306e\u30b5\u30a4\u30ba\u3092fillAmount\u306b\u8a2d\u5b9a\n\t\t\tplateCopy.GetComponent<Image>().fillAmount = (float)sizeList[i] / 100f;\n\n\t\t\t// \u8272\u3092\u30e9\u30f3\u30c0\u30e0\u306b\u8a2d\u5b9a \u660e\u308b\u3081\u306b\u3057\u3066\u307e\u3059\n\t\t\tplateCopy.GetComponent<Image>().color = new Vector4(Random.Range(0.6f, 1f), Random.Range(0.6f, 1f), Random.Range(0.6f, 1f), 1);;\n\t\t\tplateCopy.SetActive(true);\n\t\t\tmax -= sizeList[i];\n\n\t\t}\n\t\troulette.GetComponent<Image>().fillAmount = 1;\n\t}\n}\n\n```\n", "tags": ["Unity", "uGUI"]}