{"tags": ["avx512"], "context": " More than 1 year has passed since last update.AVX\u62e1\u5f35\u306b\u3088\u3063\u3066\u3001\u30aa\u30da\u30e9\u30f3\u30c9\u304c3\u500b\u306b\u5897\u3048\u305fx86\u547d\u4ee4\u3067\u3057\u305f\u304c\u30013\u5165\u529b1\u51fa\u529b\u3092\u5fc5\u8981\u3068\u3059\u308bfma\u3067\u3082\u30014\u30aa\u30da\u30e9\u30f3\u30c9\u306b\u62e1\u5f35\u3055\u308c\u308b\u3053\u3068\u306f\u306a\u304f\u3001\u5165\u529b\u306e\u7d44\u307f\u5408\u308f\u305b\u306b\u3088\u3063\u3066\u3001\u7a4d\u548c\u306e\u30aa\u30da\u30e9\u30f3\u30c9\u306e\u9806\u5e8f\u304c\u9055\u3046\u307f\u3063\u3064\u306e\u547d\u4ee4\u304c\u7528\u610f\u3055\u308c\u308b\u3053\u3068\u306b\u306a\u308a\u307e\u3057\u305f\u3002\n\nvfmadd132 src1 = src1*src3 + src2\nvfmadd213 src1 = src2*src1 + src3\nvfmadd231 src1 = src2*src3 + src1\n\nhttp://news.mynavi.jp/photo/articles/2012/10/03/idf_haswell_hpc_01/images/002l.jpg\n\u7d50\u69cb\u300c\u308f\u3041\u3044\uff01\u3084\u3063\u305f\u3041\u30fc\uff01\u300d\u3068\u3044\u3046\u611f\u3058\u306e\u540d\u524d\u306e\u547d\u4ee4\u3067\u3059\u304c\u3001\u5b9f\u969b\u306b\u30d7\u30ed\u30b0\u30e9\u30e0\u3092\u66f8\u304f\u3068\u304d\u306f\u3001intrinsics\u3067\u66f8\u304f\u5834\u5408\u304c\u591a\u304f\u3001\u30b3\u30f3\u30d1\u30a4\u30e9\u306b\u3088\u3063\u3066\u96a0\u853d\u3055\u308c\u3066\u3057\u307e\u3046\u305f\u3081\u3001\"213\"\u3068\u3044\u3046\u6587\u5b57\u5217\u3092\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u4e0a\u3067\u898b\u308b\u3053\u3068\u306f\u307b\u307c\u3042\u308a\u307e\u305b\u3093\u3002\u60b2\u3057\u307f\u2026\uff01\n\u3068\u3053\u308d\u304c\u3001\u5b89\u5fc3\u3057\u3066\u304f\u3060\u3055\u3044\uff01AVX-512\u3067\u306f\u3001\u547d\u4ee4\u306b\u30de\u30b9\u30af\u304c\u4ed8\u3051\u3089\u308c\u308b\u3088\u3046\u306b\u306a\u3063\u305f\u305f\u3081\u3001\u6a5f\u68b0\u8a9e\u4e2d\u306e\u30aa\u30da\u30e9\u30f3\u30c9\u306e\u4e26\u3073\u9806\u306b\u5225\u306e\u610f\u5473\u304c\u51fa\u3066\u304d\u3066\u3057\u307e\u3044\u3001vfma \u306e\u30aa\u30da\u30e9\u30f3\u30c9\u6570\u304c\u8db3\u308a\u306a\u3044\u554f\u984c\u304c intrinsics \u3067\u306f\u96a0\u853d\u3057\u304d\u308c\u306a\u304f\u306a\u308a\u307e\u3057\u305f\u3002\n\u305d\u306e\u7d50\u679c\u3001\n\n_mm512_mask3_fmadd_ps \n\n\u3068\u3044\u3046intrinsic\u304c\u8a95\u751f\u3057\u307e\u3057\u305f\u3002mask3\uff01\u3084\u3063\u305f\u306d\uff01\n_mm512_mask_fmadd_ps(A,B,C) \u306f\u3001 \u30de\u30b9\u30af\u306e\u30d3\u30c3\u30c8\u304c\u7acb\u3063\u3066\u3044\u305f\u5834\u5408\u3001A*B+C\u306e\u5024\u3092\u3001\u30de\u30b9\u30af\u306e\u30d3\u30c3\u30c8\u304c\u7acb\u3063\u3066\u3044\u306a\u304b\u3063\u305f\u5834\u5408\u3001A \u306e\u5024\u3092\u51fa\u529b\u3057\u307e\u3059\u3002\nIntel Intrinsics Guide(https://software.intel.com/sites/landingpage/IntrinsicsGuide/ ) \u306e\u7591\u4f3c\u30b3\u30fc\u30c9\u306b\u3088\u308b\u3068\u3001_mm512_mask_fmadd_ps \u306f\nFOR j := 0 to 15\n    i := j*32\n    IF k[j]\n        dst[i+31:i] := (a[i+31:i] * b[i+31:i]) + c[i+31:i]\n    ELSE\n        dst[i+31:i] := a[i+31:i]\n    FI\nENDFOR\n\ndst[MAX:512] := 0\n\n\u3068\u3001\u306a\u3063\u3066\u3044\u307e\u3059\u3002\n_mm512_mask3_fmadd_ps(A,B,C) \u306f\u3001 \u30de\u30b9\u30af\u306e\u30d3\u30c3\u30c8\u304c\u7acb\u3063\u3066\u3044\u306a\u304b\u3063\u305f\u5834\u5408\u3001C \u306e\u5024\u3092\u51fa\u529b\u3057\u307e\u3059\u3002\nIntrinsics Guide \u3067\u306f\u3001_mm512_mask3_fmadd_ps \u306f\u3001\nFOR j := 0 to 15\n    i := j*32\n    IF k[j]\n        dst[i+31:i] := (a[i+31:i] * b[i+31:i]) + c[i+31:i]\n    ELSE\n        dst[i+31:i] := c[i+31:i]\n    FI\nENDFOR\n\ndst[MAX:512] := 0\n\n\u3068\u3001\u306a\u3063\u3066\u3044\u307e\u3059\u306d\u3002\n\u307e\u3042\u305d\u3082\u305d\u3082\u3001_mm512_mask_fmadd_ps \u306e \u300cA * B + C \u306e\u3046\u3061\u3001 \u30de\u30b9\u30af\u306e\u30d3\u30c3\u30c8\u304c\u7acb\u3063\u3066\u3044\u306a\u304b\u3063\u305f\u3089A\u3092\u9078\u3076\u300d\u3068\u3044\u3046\u6a5f\u80fd\u81ea\u4f53\u3001\u3069\u3046\u3044\u3046\u72b6\u6cc1\u3067\u4f7f\u3046\u3093\u3060\u3088\u2026\u3068\u3044\u3046\u611f\u3058\u3082\u3042\u308a\u307e\u3059\u304c\u3001\u307e\u3042SIMD\u66f8\u304f\u30d7\u30ed\u30b0\u30e9\u30de\u306a\u3093\u3066\u3001\u3053\u3046\u3044\u3046\u6a5f\u80fd\u3092\u7121\u7406\u77e2\u7406\u4f7f\u3046\u306e\u3092\u697d\u3057\u3044\u3068\u611f\u3058\u308b\u30d7\u30ed\u30b0\u30e9\u30de\u304b\u3001\u3053\u3046\u3044\u3046\u6a5f\u80fd\u306b\u5bfe\u3057\u3066\u30dc\u30ed\u30af\u30bd\u306b\u6587\u53e5\u8a00\u3044\u306a\u304c\u3089\u3001\u7121\u7406\u77e2\u7406\u4f7f\u3046\u306e\u3092\u697d\u3057\u3044\u3068\u611f\u3058\u308b\u30d7\u30ed\u30b0\u30e9\u30de\u3057\u304b\u3044\u306a\u3044\u306e\u3067\u57fa\u672c\u7684\u306b\u306f\u554f\u984c\u7121\u3044\u3067\u3059\u3002\n\u3042\u3068\u3053\u308c\u8abf\u3079\u3066\u3066\u6c17\u4ed8\u304d\u307e\u3057\u305f\u304c\u3001fmadd \u306b\u9650\u3089\u305a\u3001\u5168\u4f53\u7684\u306b maskz \u3068\u3044\u3046\u306e\u3082\u3042\u3063\u3066\u3001\u30de\u30b9\u30af\u30d3\u30c3\u30c8\u304c\u7acb\u3063\u3066\u3044\u306a\u3051\u308c\u3070\u30bc\u30ed\u30af\u30ea\u30a2\u3059\u308b\u6a5f\u80fd\u3082\u3042\u308a\u307e\u3059\u3002\u307e\u3042\u3053\u308c\u306f\u4f7f\u3048\u308b\u53ef\u80fd\u6027\u306f\u3042\u308a\u307e\u3059\u306d\u3002\n\u307e\u3068\u3081\u308b\u3068\u3001\u2193\u3053\u3093\u306a\u611f\u3058\u3067\u3059\u3002\n#include <immintrin.h>\n#include <stdio.h>\n\nfloat in0[16] = {1.1f,1.1f,1.1f,1.1f,\n                 1.1f,1.1f,1.1f,1.1f,\n                 1.1f,1.1f,1.1f,1.1f,\n                 1.1f,1.1f,1.1f,1.1f};\n\nfloat in1[16] = {2.2f,2.2f,2.2f,2.2f,\n                 2.2f,2.2f,2.2f,2.2f,\n                 2.2f,2.2f,2.2f,2.2f,\n                 2.2f,2.2f,2.2f,2.2f};\n\nfloat in2[16] = {3.3f,3.3f,3.3f,3.3f,\n                 3.3f,3.3f,3.3f,3.3f,\n                 3.3f,3.3f,3.3f,3.3f,\n                 3.3f,3.3f,3.3f,3.3f};\n\n\n\nfloat out_nomask[16];\nfloat out_mask[16];\nfloat out_mask3[16];\nfloat out_maskz[16];\n\nint\nmain(void)\n{\n    __m512 v0;\n    __m512 v1;\n    __m512 v2;\n\n    __m512 dst;\n\n    int i;\n\n    __mmask16 mask_16 = 0xffaaU;\n\n    v0 = _mm512_loadu_ps(in0);\n    v1 = _mm512_loadu_ps(in1);\n    v2 = _mm512_loadu_ps(in2);\n\n    dst = _mm512_fmadd_ps(v0, v1, v2);\n    _mm512_storeu_ps(out_nomask, dst);\n\n    for (i=0; i<16; i++) {\n        printf(\"nomask %2d:%6.2f\\n\", i, out_nomask[i]);\n    }\n\n\n    puts(\"\");\n\n    dst = _mm512_mask_fmadd_ps(v0, mask_16, v1, v2);\n    _mm512_storeu_ps(out_mask, dst);\n\n    for (i=0; i<16; i++) {\n        printf(\"mask   %2d:%6.2f\\n\", i, out_mask[i]);\n    }\n\n\n    puts(\"\");\n\n    dst = _mm512_mask3_fmadd_ps(v0, v1, v2, mask_16);\n    _mm512_storeu_ps(out_mask3, dst);\n\n    for (i=0; i<16; i++) {\n        printf(\"mask3 %2d:%6.2f\\n\", i, out_mask3[i]);\n    }\n\n\n    puts(\"\");\n\n    dst = _mm512_maskz_fmadd_ps(mask_16, v0, v1, v2);\n    _mm512_storeu_ps(out_maskz, dst);\n\n    for (i=0; i<16; i++) {\n        printf(\"maskz %2d:%6.2f\\n\", i, out_maskz[i]);\n    }\n}\n\n$ ./sde -- ./a.out \nnomask  0:  5.72\nnomask  1:  5.72\nnomask  2:  5.72\nnomask  3:  5.72\nnomask  4:  5.72\nnomask  5:  5.72\nnomask  6:  5.72\nnomask  7:  5.72\nnomask  8:  5.72\nnomask  9:  5.72\nnomask 10:  5.72\nnomask 11:  5.72\nnomask 12:  5.72\nnomask 13:  5.72\nnomask 14:  5.72\nnomask 15:  5.72\n\nmask    0:  1.10\nmask    1:  5.72\nmask    2:  1.10\nmask    3:  5.72\nmask    4:  1.10\nmask    5:  5.72\nmask    6:  1.10\nmask    7:  5.72\nmask    8:  5.72\nmask    9:  5.72\nmask   10:  5.72\nmask   11:  5.72\nmask   12:  5.72\nmask   13:  5.72\nmask   14:  5.72\nmask   15:  5.72\n\nmask3  0:  3.30\nmask3  1:  5.72\nmask3  2:  3.30\nmask3  3:  5.72\nmask3  4:  3.30\nmask3  5:  5.72\nmask3  6:  3.30\nmask3  7:  5.72\nmask3  8:  5.72\nmask3  9:  5.72\nmask3 10:  5.72\nmask3 11:  5.72\nmask3 12:  5.72\nmask3 13:  5.72\nmask3 14:  5.72\nmask3 15:  5.72\n\nmaskz  0:  0.00\nmaskz  1:  5.72\nmaskz  2:  0.00\nmaskz  3:  5.72\nmaskz  4:  0.00\nmaskz  5:  5.72\nmaskz  6:  0.00\nmaskz  7:  5.72\nmaskz  8:  5.72\nmaskz  9:  5.72\nmaskz 10:  5.72\nmaskz 11:  5.72\nmaskz 12:  5.72\nmaskz 13:  5.72\nmaskz 14:  5.72\nmaskz 15:  5.72\n\n\u660e\u65e5\u306f\u3001@tanakmura \u304c\u3001\u4ecaIntrinsics Guide \u898b\u3066\u3044\u3066\u3071\u3063\u3068\u898b\u4f55\u3084\u3063\u3066\u308b\u304b\u3088\u304f\u308f\u304b\u3089\u306a\u304b\u3063\u305f\u3001_mm_fixupimm_sd \u306b\u3064\u3044\u3066\u66f8\u304f\u53ef\u80fd\u6027\u304c\u3042\u308a\u307e\u3059\u3002\nAVX\u62e1\u5f35\u306b\u3088\u3063\u3066\u3001\u30aa\u30da\u30e9\u30f3\u30c9\u304c3\u500b\u306b\u5897\u3048\u305fx86\u547d\u4ee4\u3067\u3057\u305f\u304c\u30013\u5165\u529b1\u51fa\u529b\u3092\u5fc5\u8981\u3068\u3059\u308bfma\u3067\u3082\u30014\u30aa\u30da\u30e9\u30f3\u30c9\u306b\u62e1\u5f35\u3055\u308c\u308b\u3053\u3068\u306f\u306a\u304f\u3001\u5165\u529b\u306e\u7d44\u307f\u5408\u308f\u305b\u306b\u3088\u3063\u3066\u3001\u7a4d\u548c\u306e\u30aa\u30da\u30e9\u30f3\u30c9\u306e\u9806\u5e8f\u304c\u9055\u3046\u307f\u3063\u3064\u306e\u547d\u4ee4\u304c\u7528\u610f\u3055\u308c\u308b\u3053\u3068\u306b\u306a\u308a\u307e\u3057\u305f\u3002\n\n- vfmadd132 src1 = src1*src3 + src2\n- vfmadd213 src1 = src2*src1 + src3\n- vfmadd231 src1 = src2*src3 + src1\n\nhttp://news.mynavi.jp/photo/articles/2012/10/03/idf_haswell_hpc_01/images/002l.jpg\n\n\n\u7d50\u69cb\u300c\u308f\u3041\u3044\uff01\u3084\u3063\u305f\u3041\u30fc\uff01\u300d\u3068\u3044\u3046\u611f\u3058\u306e\u540d\u524d\u306e\u547d\u4ee4\u3067\u3059\u304c\u3001\u5b9f\u969b\u306b\u30d7\u30ed\u30b0\u30e9\u30e0\u3092\u66f8\u304f\u3068\u304d\u306f\u3001intrinsics\u3067\u66f8\u304f\u5834\u5408\u304c\u591a\u304f\u3001\u30b3\u30f3\u30d1\u30a4\u30e9\u306b\u3088\u3063\u3066\u96a0\u853d\u3055\u308c\u3066\u3057\u307e\u3046\u305f\u3081\u3001\"213\"\u3068\u3044\u3046\u6587\u5b57\u5217\u3092\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u4e0a\u3067\u898b\u308b\u3053\u3068\u306f\u307b\u307c\u3042\u308a\u307e\u305b\u3093\u3002\u60b2\u3057\u307f\u2026\uff01\n\n\n\n\u3068\u3053\u308d\u304c\u3001\u5b89\u5fc3\u3057\u3066\u304f\u3060\u3055\u3044\uff01AVX-512\u3067\u306f\u3001\u547d\u4ee4\u306b\u30de\u30b9\u30af\u304c\u4ed8\u3051\u3089\u308c\u308b\u3088\u3046\u306b\u306a\u3063\u305f\u305f\u3081\u3001\u6a5f\u68b0\u8a9e\u4e2d\u306e\u30aa\u30da\u30e9\u30f3\u30c9\u306e\u4e26\u3073\u9806\u306b\u5225\u306e\u610f\u5473\u304c\u51fa\u3066\u304d\u3066\u3057\u307e\u3044\u3001vfma \u306e\u30aa\u30da\u30e9\u30f3\u30c9\u6570\u304c\u8db3\u308a\u306a\u3044\u554f\u984c\u304c intrinsics \u3067\u306f\u96a0\u853d\u3057\u304d\u308c\u306a\u304f\u306a\u308a\u307e\u3057\u305f\u3002\n\n\u305d\u306e\u7d50\u679c\u3001\n```\n_mm512_mask3_fmadd_ps \n```\n\u3068\u3044\u3046intrinsic\u304c\u8a95\u751f\u3057\u307e\u3057\u305f\u3002**mask3**\uff01\u3084\u3063\u305f\u306d\uff01\n\n\n\\_mm512_mask_fmadd_ps(A,B,C) \u306f\u3001 \u30de\u30b9\u30af\u306e\u30d3\u30c3\u30c8\u304c\u7acb\u3063\u3066\u3044\u305f\u5834\u5408\u3001A*B+C\u306e\u5024\u3092\u3001\u30de\u30b9\u30af\u306e\u30d3\u30c3\u30c8\u304c\u7acb\u3063\u3066\u3044\u306a\u304b\u3063\u305f\u5834\u5408\u3001A \u306e\u5024\u3092\u51fa\u529b\u3057\u307e\u3059\u3002\n\nIntel Intrinsics Guide(https://software.intel.com/sites/landingpage/IntrinsicsGuide/ ) \u306e\u7591\u4f3c\u30b3\u30fc\u30c9\u306b\u3088\u308b\u3068\u3001\\_mm512_mask_fmadd_ps \u306f\n\n```\nFOR j := 0 to 15\n    i := j*32\n    IF k[j]\n        dst[i+31:i] := (a[i+31:i] * b[i+31:i]) + c[i+31:i]\n    ELSE\n        dst[i+31:i] := a[i+31:i]\n    FI\nENDFOR\n\ndst[MAX:512] := 0\n```\n\n\u3068\u3001\u306a\u3063\u3066\u3044\u307e\u3059\u3002\n\n\\_mm512_mask3_fmadd_ps(A,B,C) \u306f\u3001 \u30de\u30b9\u30af\u306e\u30d3\u30c3\u30c8\u304c\u7acb\u3063\u3066\u3044\u306a\u304b\u3063\u305f\u5834\u5408\u3001C \u306e\u5024\u3092\u51fa\u529b\u3057\u307e\u3059\u3002\n\n\nIntrinsics Guide \u3067\u306f\u3001\\_mm512_mask3_fmadd_ps \u306f\u3001\n\n```\nFOR j := 0 to 15\n    i := j*32\n    IF k[j]\n        dst[i+31:i] := (a[i+31:i] * b[i+31:i]) + c[i+31:i]\n    ELSE\n        dst[i+31:i] := c[i+31:i]\n    FI\nENDFOR\n\ndst[MAX:512] := 0\n```\n\n\u3068\u3001\u306a\u3063\u3066\u3044\u307e\u3059\u306d\u3002\n\n\n\u307e\u3042\u305d\u3082\u305d\u3082\u3001\\_mm512_mask_fmadd_ps \u306e \u300cA * B + C \u306e\u3046\u3061\u3001 \u30de\u30b9\u30af\u306e\u30d3\u30c3\u30c8\u304c\u7acb\u3063\u3066\u3044\u306a\u304b\u3063\u305f\u3089A\u3092\u9078\u3076\u300d\u3068\u3044\u3046\u6a5f\u80fd\u81ea\u4f53\u3001\u3069\u3046\u3044\u3046\u72b6\u6cc1\u3067\u4f7f\u3046\u3093\u3060\u3088\u2026\u3068\u3044\u3046\u611f\u3058\u3082\u3042\u308a\u307e\u3059\u304c\u3001\u307e\u3042SIMD\u66f8\u304f\u30d7\u30ed\u30b0\u30e9\u30de\u306a\u3093\u3066\u3001\u3053\u3046\u3044\u3046\u6a5f\u80fd\u3092\u7121\u7406\u77e2\u7406\u4f7f\u3046\u306e\u3092\u697d\u3057\u3044\u3068\u611f\u3058\u308b\u30d7\u30ed\u30b0\u30e9\u30de\u304b\u3001\u3053\u3046\u3044\u3046\u6a5f\u80fd\u306b\u5bfe\u3057\u3066\u30dc\u30ed\u30af\u30bd\u306b\u6587\u53e5\u8a00\u3044\u306a\u304c\u3089\u3001\u7121\u7406\u77e2\u7406\u4f7f\u3046\u306e\u3092\u697d\u3057\u3044\u3068\u611f\u3058\u308b\u30d7\u30ed\u30b0\u30e9\u30de\u3057\u304b\u3044\u306a\u3044\u306e\u3067\u57fa\u672c\u7684\u306b\u306f\u554f\u984c\u7121\u3044\u3067\u3059\u3002\n\n\n\u3042\u3068\u3053\u308c\u8abf\u3079\u3066\u3066\u6c17\u4ed8\u304d\u307e\u3057\u305f\u304c\u3001fmadd \u306b\u9650\u3089\u305a\u3001\u5168\u4f53\u7684\u306b maskz \u3068\u3044\u3046\u306e\u3082\u3042\u3063\u3066\u3001\u30de\u30b9\u30af\u30d3\u30c3\u30c8\u304c\u7acb\u3063\u3066\u3044\u306a\u3051\u308c\u3070\u30bc\u30ed\u30af\u30ea\u30a2\u3059\u308b\u6a5f\u80fd\u3082\u3042\u308a\u307e\u3059\u3002\u307e\u3042\u3053\u308c\u306f\u4f7f\u3048\u308b\u53ef\u80fd\u6027\u306f\u3042\u308a\u307e\u3059\u306d\u3002\n\n\u307e\u3068\u3081\u308b\u3068\u3001\u2193\u3053\u3093\u306a\u611f\u3058\u3067\u3059\u3002\n\n```cpp\n#include <immintrin.h>\n#include <stdio.h>\n\nfloat in0[16] = {1.1f,1.1f,1.1f,1.1f,\n                 1.1f,1.1f,1.1f,1.1f,\n                 1.1f,1.1f,1.1f,1.1f,\n                 1.1f,1.1f,1.1f,1.1f};\n\nfloat in1[16] = {2.2f,2.2f,2.2f,2.2f,\n                 2.2f,2.2f,2.2f,2.2f,\n                 2.2f,2.2f,2.2f,2.2f,\n                 2.2f,2.2f,2.2f,2.2f};\n\nfloat in2[16] = {3.3f,3.3f,3.3f,3.3f,\n                 3.3f,3.3f,3.3f,3.3f,\n                 3.3f,3.3f,3.3f,3.3f,\n                 3.3f,3.3f,3.3f,3.3f};\n\n\n\nfloat out_nomask[16];\nfloat out_mask[16];\nfloat out_mask3[16];\nfloat out_maskz[16];\n\nint\nmain(void)\n{\n    __m512 v0;\n    __m512 v1;\n    __m512 v2;\n\n    __m512 dst;\n\n    int i;\n\n    __mmask16 mask_16 = 0xffaaU;\n\n    v0 = _mm512_loadu_ps(in0);\n    v1 = _mm512_loadu_ps(in1);\n    v2 = _mm512_loadu_ps(in2);\n\n    dst = _mm512_fmadd_ps(v0, v1, v2);\n    _mm512_storeu_ps(out_nomask, dst);\n\n    for (i=0; i<16; i++) {\n        printf(\"nomask %2d:%6.2f\\n\", i, out_nomask[i]);\n    }\n\n\n    puts(\"\");\n\n    dst = _mm512_mask_fmadd_ps(v0, mask_16, v1, v2);\n    _mm512_storeu_ps(out_mask, dst);\n\n    for (i=0; i<16; i++) {\n        printf(\"mask   %2d:%6.2f\\n\", i, out_mask[i]);\n    }\n\n\n    puts(\"\");\n\n    dst = _mm512_mask3_fmadd_ps(v0, v1, v2, mask_16);\n    _mm512_storeu_ps(out_mask3, dst);\n\n    for (i=0; i<16; i++) {\n        printf(\"mask3 %2d:%6.2f\\n\", i, out_mask3[i]);\n    }\n\n\n    puts(\"\");\n\n    dst = _mm512_maskz_fmadd_ps(mask_16, v0, v1, v2);\n    _mm512_storeu_ps(out_maskz, dst);\n\n    for (i=0; i<16; i++) {\n        printf(\"maskz %2d:%6.2f\\n\", i, out_maskz[i]);\n    }\n}\n```\n\n```\n$ ./sde -- ./a.out \nnomask  0:  5.72\nnomask  1:  5.72\nnomask  2:  5.72\nnomask  3:  5.72\nnomask  4:  5.72\nnomask  5:  5.72\nnomask  6:  5.72\nnomask  7:  5.72\nnomask  8:  5.72\nnomask  9:  5.72\nnomask 10:  5.72\nnomask 11:  5.72\nnomask 12:  5.72\nnomask 13:  5.72\nnomask 14:  5.72\nnomask 15:  5.72\n\nmask    0:  1.10\nmask    1:  5.72\nmask    2:  1.10\nmask    3:  5.72\nmask    4:  1.10\nmask    5:  5.72\nmask    6:  1.10\nmask    7:  5.72\nmask    8:  5.72\nmask    9:  5.72\nmask   10:  5.72\nmask   11:  5.72\nmask   12:  5.72\nmask   13:  5.72\nmask   14:  5.72\nmask   15:  5.72\n\nmask3  0:  3.30\nmask3  1:  5.72\nmask3  2:  3.30\nmask3  3:  5.72\nmask3  4:  3.30\nmask3  5:  5.72\nmask3  6:  3.30\nmask3  7:  5.72\nmask3  8:  5.72\nmask3  9:  5.72\nmask3 10:  5.72\nmask3 11:  5.72\nmask3 12:  5.72\nmask3 13:  5.72\nmask3 14:  5.72\nmask3 15:  5.72\n\nmaskz  0:  0.00\nmaskz  1:  5.72\nmaskz  2:  0.00\nmaskz  3:  5.72\nmaskz  4:  0.00\nmaskz  5:  5.72\nmaskz  6:  0.00\nmaskz  7:  5.72\nmaskz  8:  5.72\nmaskz  9:  5.72\nmaskz 10:  5.72\nmaskz 11:  5.72\nmaskz 12:  5.72\nmaskz 13:  5.72\nmaskz 14:  5.72\nmaskz 15:  5.72\n```\n\n\n\u660e\u65e5\u306f\u3001@tanakmura \u304c\u3001\u4ecaIntrinsics Guide \u898b\u3066\u3044\u3066\u3071\u3063\u3068\u898b\u4f55\u3084\u3063\u3066\u308b\u304b\u3088\u304f\u308f\u304b\u3089\u306a\u304b\u3063\u305f\u3001\\_mm_fixupimm_sd \u306b\u3064\u3044\u3066\u66f8\u304f\u53ef\u80fd\u6027\u304c\u3042\u308a\u307e\u3059\u3002\n\n"}