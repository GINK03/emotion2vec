{"context": " More than 1 year has passed since last update.\n\n\u3053\u306e\u6295\u7a3f\u306b\u3064\u3044\u3066\nSlack/Hubot/Docker\u3092\u7528\u3044\u305fChatOps\u3067\u30a2\u30d7\u30ea\u306e\u691c\u8a3c\u74b0\u5883\u3092\u30dd\u30f3\u30dd\u30f3\u4f5c\u3063\u3066\u3001\u30dd\u30f3\u30dd\u30f3\u6368\u3066\u308b\u65b9\u6cd5\u3092\u307e\u3068\u3081\u307e\u3059\u3002\n\u30c1\u30e3\u30c3\u30c8\u304b\u3089\u8ab0\u3067\u3082\u624b\u8efd\u306b\u4f7f\u3044\u6368\u3066\u306e\u30a2\u30d7\u30ea\u306e\u691c\u8a3c\u7528\u74b0\u5883\u3092\u4f5c\u6210\u3067\u304d\u308b\u306e\u3067\u3001\u30c1\u30fc\u30e0\u958b\u767a\u306e\u751f\u7523\u6027\u5411\u4e0a\u304c\u671f\u5f85\u3067\u304d\u307e\u3059\u3002\n\n\u30b7\u30b9\u30c6\u30e0\u69cb\u6210\u306e\u6982\u8981\u56f3\n\n\n\u30b7\u30b9\u30c6\u30e0\u69cb\u7bc9\u624b\u9806\n\nSlack\u3068Hubot\u306e\u9023\u643a\nHubot\u3092PaaS\u3067\u3042\u308bHeroku\u306b\u30c7\u30d7\u30ed\u30a4\u3055\u305b\u3001Slack\u3068\u9023\u643a\u3055\u305b\u307e\u3059\u3002\n\u3053\u3061\u3089\u306e\u5177\u4f53\u7684\u306a\u624b\u9806\u306b\u3064\u3044\u3066\u306f\u3001\u300cSlack / Hubot / GitHub / CircleCI \u306b\u3088\u308bChatOps\u306a\u30c7\u30d7\u30ed\u30a4\u65b9\u6cd5\u300d\u306e\u524d\u534a\u90e8\u5206\u3067\u8a73\u3057\u304f\u307e\u3068\u3081\u3066\u3044\u307e\u3059\u306e\u3067\u3001\u305d\u3061\u3089\u3092\u53c2\u7167\u304f\u3060\u3055\u3044\u3002\n\nDocker\u3092\u52d5\u304b\u3059\u30b5\u30fc\u30d0\u30fc\u306e\u7528\u610f(EC2)\n\u4eca\u56de\u306fAWS\u306eEC2\u3092\u7528\u3044\u307e\u3059\u3002\n\nEC2\u306e\u8d77\u52d5\n\u307e\u305a\u306f\u3001Docker\u3092\u52d5\u304b\u3059\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u3092\u7acb\u3061\u4e0a\u3052\u308b\u3002\n\u4eca\u56de\u306fCommunityAMI\u306e\u300cubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20140927\u300d\u3068\u3044\u3046\u3082\u306e\u3092\u5229\u7528\u3002\n\n\u691c\u8a3c\u306a\u306e\u3067\u3001\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u30bf\u30a4\u30d7\u306ft2.micro\u3092\u9078\u629e\u3002\n\n\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306e\u540d\u524d\u306f\u9069\u5f53\u306b\u5206\u304b\u308a\u3084\u3059\u3044\u3082\u306e\u3092\u4ed8\u3051\u3066\u304a\u3051\u3070OK\u3002\n\nSecurity Group\u306e\u8a2d\u5b9a\u3067\u306f\u3001SSH\u7528\u30dd\u30fc\u30c8\u306e\u4ed6\u306b\u3001\u8ffd\u52a0\u306749153\u301c65535\u30dd\u30fc\u30c8\u3092\u89e3\u653e\u3057\u3066\u304a\u304f\u3002\n\u3053\u308c\u306fDocker\u306e\u30dd\u30fc\u30c8\u30d5\u30a9\u30ef\u30fc\u30c7\u30a3\u30f3\u30b0\u3067\u4f7f\u7528\u3055\u308c\u308b\u30dd\u30fc\u30c8\u3067\u3042\u308b\u3002\n\n\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u304c\u7acb\u3061\u4e0a\u304c\u308c\u3070\u3001IP\u3092\u78ba\u8a8d\u3057\u3066\u3061\u3083\u3093\u3068SSH\u63a5\u7d9a\u3067\u304d\u308b\u304b\u78ba\u8a8d\u3002\nssh -i .ssh/docker-key.pem ubuntu@54.65.169.132\n\n> ubuntu@ip-172-31-6-189:~ $\n\n\n\u30e6\u30fc\u30b6\u30fc\u306e\u4f5c\u6210\nDocker\u3092\u64cd\u4f5c\u3059\u308b\u7528\u306e\u30e6\u30fc\u30b6\u30fc\u3092\u4f5c\u6210\u3059\u308b\u3002\u3053\u3053\u3067\u306fwanko\u3068\u3044\u3046\u540d\u524d\u3067\u4f5c\u6210\u3002\nubuntu:~$ sudo adduser wanko\nAdding user `wanko' ...\nAdding new group `wanko' (1001) ...\nAdding new user `wanko' (1001) with group `wanko' ...\nCreating home directory `/home/wanko' ...\nCopying files from `/etc/skel' ...\nEnter new UNIX password: \nRetype new UNIX password: \npasswd: password updated successfully\nChanging the user information for wanko\nEnter the new value, or press ENTER for the default\n    Full Name []: \n    Room Number []: \n    Work Phone []: \n    Home Phone []: \n    Other []: \nIs the information correct? [Y/n] y\n\nsudo\u6a29\u9650\u3092\u4ed8\u4e0e\nubuntu:~$ sudo usermod -G sudo wanko\n\n\u30d1\u30b9\u30ef\u30fc\u30c9\u30ec\u30b9\u3067sudo\u306b\u306a\u308c\u308b\u3088\u3046\u306b\u8a2d\u5b9a\nubuntu:~$ sudo visudo\n\n#\u4ee5\u4e0b\u3092\u3001\u8ffd\u8a18\nwanko ALL=(ALL) NOPASSWD: ALL\n\n/etc/ssh/sshd_config\u3092\u5909\u66f4\u3057\u3066\u3001\u30d1\u30b9\u30ef\u30fc\u30c9\u306b\u3088\u308b\u30ed\u30b0\u30a4\u30f3\u3092\u8a31\u53ef\nubuntu:~$ sudo vi /etc/ssh/sshd_config\n\n\n/etc/ssh/sshd_config\n#PasswordAuthentication no\nPasswordAuthentication yes\n\n\n\u5909\u66f4\u3057\u305f\u8a2d\u5b9a\u3092\u53cd\u6620\u3059\u308b\u305f\u3081\u306b\u3001sshd\u3092\u518d\u8d77\u52d5\nsudo service ssh restart\n\n\u8ffd\u52a0\u3057\u305f\u30e6\u30fc\u30b6\u30fc\u3067\u30d1\u30b9\u30ef\u30fc\u30c9\u30ed\u30b0\u30a4\u30f3\u3067\u304d\u308b\u304b\u78ba\u8a8d\nssh wanko@54.65.169.132\n\nwanko@54.65.169.132's password:\n\n\n\nGitHub\u306b\u30ec\u30dd\u30b8\u30c8\u30ea\u4f5c\u6210\n\u4eca\u56de\u306fDocker\u306e\u30b3\u30f3\u30c6\u30ca\u306bGitHub\u304b\u3089\u30a2\u30d7\u30ea\u3092clone\u3057\u3066\u304d\u3066\u52d5\u304b\u3057\u305f\u3044\u306e\u3067\u3001\u305d\u306e\u691c\u8a3c\u7528\u306e\u30ec\u30dd\u30b8\u30c8\u30ea\u3092\u4f5c\u308a\u307e\u3059\u3002\n\u4eca\u56de\u306fHTML\u3060\u3051\u306e\u30b7\u30f3\u30d7\u30eb\u306a\u30a2\u30d7\u30ea\u306b\u3057\u3066\u3044\u307e\u3059\u3002\n\u5b9f\u969b\u306e\u30ec\u30dd\u30b8\u30c8\u30ea\nhttps://github.com/s-kiriki/docker-test-app\n\u307e\u305f\u4eca\u56de\u306fChatOps\u3067\u30d6\u30e9\u30f3\u30c1\u3092\u81ea\u7531\u306b\u5207\u308a\u66ff\u3048\u3066Docker\u30b3\u30f3\u30c6\u30ca\u306b\u4efb\u610f\u306e\u30d6\u30e9\u30f3\u30c1\u3092\u30c7\u30d7\u30ed\u30a4\u51fa\u6765\u308b\u304b\u3092\u691c\u8a3c\u3057\u305f\u3044\u306e\u3067\u3001\n\u4ee5\u4e0b\u306e\uff12\u3064\u306e\u30d6\u30e9\u30f3\u30c1\u3092\u7528\u610f\u3057\u307e\u3057\u305f\u3002\n\u30fbmaster\u30d6\u30e9\u30f3\u30c1\n\u30b7\u30f3\u30d7\u30eb\u306b\u300cHello from Docker!\u300d\u3068\u3060\u3051\u8868\u793a\u3055\u308c\u308b\u5b9f\u88c5\n\u30fbadd_image\u30d6\u30e9\u30f3\u30c1\n\u300cHello from Docker!\u300d\u306e\u4e0b\u306bDocker\u306e\u30a4\u30e1\u30fc\u30b8\uff08\u30af\u30b8\u30e9\u306e\u3084\u3064\uff09\u304c\u8868\u793a\u3055\u308c\u308b\u5b9f\u88c5\n\n\nDocker\u30db\u30b9\u30c8OS\u306e\u7528\u610f\n\u4e0a\u3067\u7acb\u3061\u4e0a\u3052\u305f\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306bDocker\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u3066\u3001\u5404\u7a2e\u8a2d\u5b9a\u3092\u884c\u3063\u3066\u3044\u304d\u307e\u3059\u3002\n\u4ee5\u4e0b\u3001\u3053\u306eDocker\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u305f\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u3092Docker\u30db\u30b9\u30c8OS\u3068\u66f8\u304d\u307e\u3059\u3002\n\nDocker\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\u516c\u5f0f\u30b5\u30a4\u30c8\u306b\u5f93\u3063\u3066\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\u3002\nsudo apt-get update\nsudo apt-get install docker.io\n\n\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u305f\u304b\u78ba\u8a8d\nsudo docker --version\nDocker version 1.0.1, build 990021a\n\nVersion1.3\u3088\u308a\u8ffd\u52a0\u3055\u308c\u305fdocker exec\u3092\u4f7f\u3044\u305f\u3044\u306e\u3067\u3001Docker\u3092\u6700\u65b0\u7248\u306bUPDATE\ncurl -sSL https://get.docker.com/ubuntu/ | sudo sh\n\nsudo docker --version\nDocker version 1.4.0, build 4595d4f\n\n\nDockerfile\u304a\u3088\u3073\u3001\u30b3\u30f3\u30c6\u30ca\u306b\u8ee2\u9001\u3059\u308b\u30d5\u30a1\u30a4\u30eb\u306e\u4f5c\u6210\nDockerfile\u3092\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u4f5c\u6210\u3057\u307e\u3059\u3002\n\nDockerfile\nFROM centos:centos6\n\nRUN yum update -y\nRUN yum install -y httpd\nRUN yum install -y git\n\nADD ./app_init.sh /\n\nRUN mkdir /root/.ssh/\nADD id_rsa /root/.ssh/id_rsa\nRUN chmod 700 /root/.ssh/id_rsa\n\nRUN echo -e \"Host github.com\\n\\tStrictHostKeyChecking no\\n\" >> /root/.ssh/config\n\nEXPOSE 80\nCMD [\"/usr/sbin/httpd\", \"-D\", \"FOREGROUND\"]\n\n\nADD\u30b3\u30de\u30f3\u30c9\u3067\u6307\u5b9a\u3057\u3066\u3044\u308bapp_init.sh\u3068id_rsa\u306f\u30b3\u30f3\u30c6\u30ca\u306b\u8ee2\u9001\u3059\u308b\u3082\u306e\u3067\u3059\u306e\u3067\u3001\u4e88\u3081\u624b\u5143\u3067\u4f5c\u6210\u306b\u3066\u304a\u304f\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\nid_rsa\u306fGitHub\u306b\u8a8d\u8a3c\u53ef\u80fd\u306a\u79d8\u5bc6\u9375\u3067\u3001app_init.sh\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306agit clone\u3067\u5148\u307b\u3069\u3064\u304f\u3063\u305f\u691c\u8a3c\u7528\u306e\u30ec\u30dd\u30b8\u30c8\u30ea\u3092clone\u3057\u3066\u304f\u308b\u30b7\u30a7\u30eb\u30b9\u30af\u30ea\u30d7\u30c8\u3067\u3059\u3002\n\napp_init.sh\n#!/bin/bash\n\nif [ $# -ne 1 ]; then\n echo \"You must specify branch name\"\n exit 1 \nfi\n\nBRANCH_NAME=$1\n\ncd /var/www/html && git clone -b $BRANCH_NAME --depth 1 git@github.com:s-kiriki/docker-test-app.git\n\n\n\nDocker\u30a4\u30e1\u30fc\u30b8\u306e\u4f5c\u6210\n\u4e0a\u3067\u4f5c\u3063\u305fDockerfile\u3088\u308aDocker\u30a4\u30e1\u30fc\u30b8\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\u4eca\u624b\u5143\u306b\u306f\u3001Dockerfile\u3001app_init.sh\u3001id_rsa\u304c\u3042\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3057\u3066\u304f\u3060\u3055\u3044\u3002\nwanko@ip-172-31-6-189:~$ ls\napp_init.sh  Dockerfile  id_rsa\n\n\u30a4\u30e1\u30fc\u30b8\u306e\u4f5c\u6210\u306fdocker build\u30b3\u30de\u30f3\u30c9\u3067\u884c\u3044\u307e\u3059\u3002-t\u30aa\u30d7\u30b7\u30e7\u30f3\u3067\u30a4\u30e1\u30fc\u30b8\u540d\uff08\u4eca\u56de\u306fdocker-app\u3068\u3057\u305f\uff09\u3092\u6307\u5b9a\u3057\u3001\u6700\u5f8c\u306e.\u306fDockerfile\u306e\u30d1\u30b9\uff08\u4eca\u56de\u306f\u30ab\u30ec\u30f3\u30c8\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\uff09\u3092\u6307\u5b9a\u3057\u3066\u3044\u307e\u3059\u3002\n$ sudo docker build -t docker_app .\n\nDocker\u30a4\u30e1\u30fc\u30b8\u304c\u4f5c\u3089\u308c\u305f\u304b\u3092docker image\u30b3\u30de\u30f3\u30c9\u3067\u78ba\u8a8d\u3057\u307e\u3059\u3002\n$ sudo docker images\n\nREPOSITORY          TAG                 IMAGE ID            CREATED             VIRTUAL SIZE\ndocker_app          latest              6900f52b1ac5        5 seconds ago       466.5 MB\n\n\n\n\u30b3\u30f3\u30c6\u30ca\u306e\u8d77\u52d5\n\u4e0a\u3067\u4f5c\u3063\u305fDocker\u30a4\u30e1\u30fc\u30b8\u3092\u4f7f\u3063\u3066\u3001docker run\u30b3\u30de\u30f3\u30c9\u3067\u30b3\u30f3\u30c6\u30ca\u3092\u8d77\u52d5\u3055\u305b\u307e\u3059\u3002\n-d\u30aa\u30d7\u30b7\u30e7\u30f3\u3067Apache\u3092\u30c7\u30fc\u30e2\u30f3\u5316\u3055\u305b\u3001-P\u30aa\u30d7\u30b7\u30e7\u30f3\u3067\u30dd\u30fc\u30c8\u30d5\u30a9\u30ef\u30fc\u30c7\u30a3\u30f3\u30b0\u3092\u884c\u3044\u307e\u3059\u3002\n$ sudo docker run -d -P docker_app\nafbf3bd7c6be6e36ca436d34880b49970bacb25a72a9a351c9d3c28d5a8cd0a6\n\n\n\u30b3\u30f3\u30c6\u30ca\u304c\u4f5c\u3089\u308c\u305f\u304b\u306f\u3001docker ps\u30b3\u30de\u30f3\u30c9\u3067\u78ba\u8a8d\u3067\u304d\u307e\u3059\u3002\n$ sudo docker ps\nCONTAINER ID        IMAGE               COMMAND                CREATED             STATUS              PORTS                   NAMES\nafbf3bd7c6be        docker_app:latest   \"/usr/sbin/httpd -D    2 minutes ago       Up 2 minutes        0.0.0.0:49157->80/tcp   kickass_brown     \n\n80\u756a\u30dd\u30fc\u30c8\u304c49157\u756a\u30dd\u30fc\u30c8\u306b\u30dd\u30fc\u30c8\u30d5\u30a9\u30ef\u30fc\u30c7\u30a3\u30f3\u30b0\u3055\u308c\u3066\u3044\u308b\u306e\u304c\u308f\u304b\u308a\u307e\u3059\u3002\n\u3053\u306e\u72b6\u614b\u3067\u3001http://54.65.169.132:49157/\uff0854.65.169.132\u306e\u90e8\u5206\u306fDocker\u30db\u30b9\u30c8OS\u306e\u30a2\u30c9\u30ec\u30b9\uff09\u306b\u30a2\u30af\u30bb\u30b9\u3059\u308b\u3068\u3001Apache\u306e\u30db\u30fc\u30e0\u753b\u9762\u304c\u8868\u793a\u3055\u308c\u3066\u3044\u308b\u306f\u305a\u3067\u3059\u3002\n\n\n\u30a2\u30d7\u30ea\u306e\u8a2d\u7f6e\n\u6b21\u306b\u3001\u3053\u306edocker run\u3067\u7acb\u3061\u4e0a\u3052\u305f\u30b3\u30f3\u30c6\u30ca\u306b\u30a2\u30d7\u30ea\u3092\u8a2d\u7f6e\u3057\u307e\u3059\uff08GitHub\u304b\u3089clone\uff09\u3002\n\u30b3\u30f3\u30c6\u30ca\u306b\u5bfe\u3057\u3066\u306e\u30b3\u30de\u30f3\u30c9\u306e\u5b9f\u884c\u306fdocker exec\u30b3\u30de\u30f3\u30c9\u3067\u884c\u3048\u307e\u3059\u3002\n\u4eca\u56de\u306f\u30b3\u30f3\u30c6\u30ca\u5074\u306b\u65e2\u306b\u3042\u308bapp_init.sh\u3092\u5b9f\u884c\u3055\u305b\u308c\u3070\u3044\u3044\u3060\u3051\u306a\u306e\u3067\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u3057\u307e\u3059\u3002\n$ sudo docker exec kickass_brown sh app_init.sh master\n\nkickass_brown\u306f\u30b3\u30f3\u30c6\u30ca\u540d\u3001master\u306f\u30d6\u30e9\u30f3\u30c1\u540d\n\u3053\u308c\u3067\u30b3\u30f3\u30c6\u30ca\u306b\u30a2\u30d7\u30ea\u304c\u8a2d\u7f6e\u3055\u308c\u305f\u306e\u3067\u3001http://54.65.169.132:49157/docker-test-app\u306b\u30a2\u30af\u30bb\u30b9\u3059\u308b\u3068\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u30a2\u30d7\u30ea\u304c\u52d5\u304f\u306f\u305a\u3067\u3059\u3002\n\nDocker\u3067\u8d77\u52d5\u3055\u305b\u305f\u30b3\u30f3\u30c6\u30ca\u3067GitHub\u4e0a\u306e\u30a2\u30d7\u30ea\u304c\u52d5\u304d\u307e\u3057\u305f\uff01\uff01\n\n\u3053\u3053\u307e\u3067\u306e\u307e\u3068\u3081\n\u3053\u3053\u3067\u306f\u3001\u5927\u304d\u304f\u5206\u3051\u3066\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u3053\u3068\u3092\u884c\u3063\u3066\u304d\u307e\u3057\u305f\u3002\n\nDocker\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\nDockerfile\u306e\u4f5c\u6210\u3068\u30a2\u30d7\u30ea\u8a2d\u7f6e\u30b7\u30a7\u30eb\u30b9\u30af\u30ea\u30d7\u30c8\u306e\u4f5c\u6210\nDocker\u30a4\u30e1\u30fc\u30b8\u306e\u4f5c\u6210(docker build)\nDocker\u30b3\u30f3\u30c6\u30ca\u306e\u8d77\u52d5(docker run)\n\u30a2\u30d7\u30ea\u306e\u8a2d\u7f6e(docker exec)\n\n\u4eca\u56de\u306e\u6700\u7d42\u76ee\u7684\u306fChatOps\uff08Slack\u304b\u3089\u6307\u4ee4\u3092\u51fa\u3059\uff09\u3067\u3001\u6307\u5b9a\u306e\u30a2\u30d7\u30ea\u306e\u691c\u8a3c\u74b0\u5883\u3092\u30dd\u30f3\u30dd\u30f3\u3064\u304f\u308b\u3053\u3068\uff08\u30b3\u30f3\u30c6\u30ca\u3092\u30dd\u30f3\u30dd\u30f3\u8d77\u52d5\u3055\u305b\u308b\u3053\u3068\uff09\u3067\u3042\u3063\u305f\u306e\u3067\u3001\u3053\u306e1~5\u306e\u4e2d\u306e4\u30685\u3092Slack\u7d4c\u7531\u3067\u884c\u3046\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\n\u4ee5\u964d\u306e\u7bc0\u3067\u3001\u3053\u308c\u3089\u306e\u65b9\u6cd5\u3092\u8aac\u660e\u3057\u3066\u3044\u304d\u307e\u3059\u3002\n\nHubot\u304b\u3089Docker\u30b3\u30f3\u30c6\u30ca\u306e\u8d77\u52d5\u3068\u30a2\u30d7\u30ea\u306e\u8a2d\u7f6e\u3092\u884c\u3046\nSlack\u3068Hubot(Heroku\u4e0a\u306b\u30c7\u30d7\u30ed\u30a4)\u306e\u9023\u643a\u306f\u65e2\u306b\u6e08\u3093\u3067\u3044\u308b\u306e\u3067\u3001\u3042\u3068\u306fHubot\u304b\u3089Docker\u30db\u30b9\u30c8OS\u306b\u547d\u4ee4\u3092\u51fa\u3057\u3066\u30b3\u30f3\u30c6\u30ca\u306e\u8d77\u52d5\u3068\u30a2\u30d7\u30ea\u306e\u8a2d\u7f6e\u304c\u884c\u3048\u308c\u3070\u3001ChatOps\u3067\u30a2\u30d7\u30ea\u306e\u691c\u8a3c\u74b0\u5883\u3092\u4f5c\u308c\u308b\u3053\u3068\u306b\u306a\u308a\u307e\u3059\u3002\n\u3053\u306e\u5b9f\u88c5\u65b9\u6cd5\u3068\u3057\u3066\u3001\u4eca\u56de\u306fDocker\u30db\u30b9\u30c8OS\u306bDocker\u30b3\u30f3\u30c6\u30ca\u306e\u8d77\u52d5\u3068\u30a2\u30d7\u30ea\u306e\u8a2d\u7f6e\u3092\u884c\u3046\u30b7\u30a7\u30eb\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u7528\u610f\u3057\u3001\u305d\u306e\u30b9\u30af\u30ea\u30d7\u30c8\u3092Hubot\u304b\u3089ssh\u3067\u63a5\u7d9a\u3057\u3066\u5b9f\u884c\u3059\u308b\u3068\u3044\u3046\u69cb\u6210\u306b\u3057\u307e\u3057\u305f\u3002\n\n\u30b7\u30a7\u30eb\u30b9\u30af\u30ea\u30d7\u30c8\u306e\u7528\u610f\uff08Docker\u30db\u30b9\u30c8OS\uff09\nDocker\u30db\u30b9\u30c8OS\u306bDocker\u30b3\u30f3\u30c6\u30ca\u306e\u8d77\u52d5\u3068\u30a2\u30d7\u30ea\u306e\u8a2d\u7f6e\u3092\u884c\u3046\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u30b7\u30a7\u30eb\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u7528\u610f\u3057\u307e\u3059\u3002\n\ncontainer-up.sh\n#!/bin/bash\n\nif [ $# -ne 1 ]; then\n echo \"You must specify branch name\"\n exit 1\nfi\n\nBRANCH_NAME=$1\n\nCONTAINER_ID=`sudo docker run -d -P docker_app` # \u30b3\u30f3\u30c6\u30ca\u306e\u8d77\u52d5\nif [ $? -ne 0 ]\nthen\n        echo \"Error occured on running container.\"\n        exit 1\nfi\n\necho \"Created Container:$CONTAINER_ID\"\n\nPORT_FORWARDING=`sudo docker port $CONTAINER_ID`\nif [ $? -ne 0 ]\nthen\n        echo \"Error occured on checking port forwarding.\"\n        exit 1\nfi\n\nsudo docker exec $CONTAINER_ID sh app_init.sh $BRANCH_NAME # \u30a2\u30d7\u30ea\u306e\u8a2d\u7f6e\nif [ $? -ne 0 ]\nthen\n        echo \"Error occured on setting app.\"\n        exit 1\nfi\n\necho \":docker: Your app is ready!! $PORT_FORWARDING\" # :docker: \u3068\u3044\u3046\u306e\u306fSlack\u306e\u30ab\u30b9\u30bf\u30e0\u7d75\u6587\u5b57\n\n\n\u30dd\u30f3\u30dd\u30f3\u4f5c\u308b\u3060\u3051\u3067\u306f\u306a\u304f\u3001\u30dd\u30f3\u30dd\u30f3\u6368\u3066\u308b\u3053\u3068\u3082\u76ee\u7684\u3060\u3063\u305f\u306e\u3067\u3001\u540c\u69d8\u306b\u30b3\u30f3\u30c6\u30ca\u3092\u524a\u9664\u3059\u308b\u30b9\u30af\u30ea\u30d7\u30c8\u3082\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u4f5c\u308a\u307e\u3059\u3002\n\ncontainer-remove.sh\n#!/bin/bash\n\nif [ $# -ne 1 ]; then\n echo \"You must specify container name or ID\"\n exit 1\nfi\n\nCONTAINER_ID=$1\n\nREMOVED_CONTAINER=`sudo docker rm -f $CONTAINER_ID`\nif [ $? -ne 0 ]\nthen\n        echo \"Error occured on removing container $CONTAINER_ID.\"\n        exit 1\nfi\n\necho \":docker: Removed container: $REMOVED_CONTAINER\" # :docker: \u3068\u3044\u3046\u306e\u306fSlack\u306e\u30ab\u30b9\u30bf\u30e0\u7d75\u6587\u5b57\n\n\n\nHubot\u30b9\u30af\u30ea\u30d7\u30c8\u306e\u4f5c\u6210\n\u6b21\u306b\u3001Docker\u30db\u30b9\u30c8OS\u306b\u8a2d\u7f6e\u3057\u305fcontainer-up.sh\u304a\u3088\u3073container-remove.sh\u3092ssh\u7d4c\u7531\u3067\u5b9f\u884c\u3059\u308b\u305f\u3081\u306e\u30b9\u30af\u30ea\u30d7\u30c8\u3092Hubot\u306b\u8ffd\u52a0\u3057\u307e\u3059\u3002\nsimple-ssh\u3068\u3044\u3046npm\u30e2\u30b8\u30e5\u30fc\u30eb\u3092\u4f7f\u3046\u306e\u3067\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u3066\u304a\u304d\u307e\u3059\u3002\nnpm install simple-ssh --save\n\n\u5b9f\u969b\u306e\u30b3\u30fc\u30c9\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u3057\u307e\u3057\u305f\u3002\n\nhubot-container.coffee\n# Description:\n#  Handling Docker containers.\n#\n# Dependencies:\n#   \"simple-ssh\": \"^0.8.1\"\n#   \"hubot-slack\": \"^2.2.0\"\n#\n# Configuration:\n#   [Required]\n#     DOCKER_HOST\n#     DOCKER_USER\n#     DOCKER_PASSWD\n#\n# Author:\n#   s-kiriki\n\n\nmodule.exports = (robot) ->\n\n    _getSSH = (msg) ->\n        if !process.env.DOCKER_HOST\n            return msg.send 'You must set ENV: DOCKER_HOST'\n        if !process.env.DOCKER_USER\n            return msg.send 'You must set ENV: DOCKER_USER'\n        if !process.env.DOCKER_PASSWD\n            return msg.send 'You must set ENV: DOCKER_PASSWD'\n\n        SSH = require('simple-ssh');\n        ssh = new SSH({\n            host: process.env.DOCKER_HOST,\n            user: process.env.DOCKER_USER,\n            pass: process.env.DOCKER_PASSWD\n        });\n        return ssh\n\n    robot.respond /container up( (.+))?/i, (msg) ->\n        branch_name = msg.match[2] || \"master\"\n        ssh = _getSSH(msg)\n        ssh.exec(\"sh container-up.sh #{branch_name}\", {\n            out: (stdout) ->\n                msg.send stdout\n        }).start();\n\n    robot.respond /container remove (\\w+)/i, (msg) ->\n        container_id = msg.match[1]\n        ssh = _getSSH(msg)\n        ssh.exec(\"sh container-remove.sh #{container_id}\", {\n            out: (stdout) ->\n                msg.send stdout\n        }).start();\n\n    robot.respond /container list/i, (msg) ->\n        ssh = _getSSH(msg)\n        ssh.exec(\"sudo docker ps | awk '{print $1, $(NF-1), $(NF)}'\", {\n            out: (stdout) ->\n                msg.send stdout\n        }).start(); \n\n\n\n\nHeroku\u4e0a\u3067Hubot\u30b9\u30af\u30ea\u30d7\u30c8\u7528\u306e\u74b0\u5883\u5909\u6570\u3092\u30bb\u30c3\u30c8\nhubot-container.coffee\u3067\u306fDOCKER_HOST\u3001DOCKER_USER\u3001DOCKER_PASSWD\u3092\u74b0\u5883\u5909\u6570\u3067\u30bb\u30c3\u30c8\u3059\u308b\u5fc5\u8981\u304c\u3042\u308b\u306e\u3067\u3001\u3053\u308c\u3089\u3092Heroku\u4e0a\u3067\u8a2d\u7f6e\u3057\u307e\u3059\u3002\n\n\n\u30c7\u30e2\n\u3088\u3046\u3084\u304f\u6e96\u5099\u304c\u6574\u3063\u305f\u306e\u3067\u3001Slack\u304b\u3089Docker\u3092\u64cd\u4f5c\u3057\u3066\u691c\u8a3c\u74b0\u5883\u3092\u30dd\u30f3\u30dd\u30f3\u4f5c\u3063\u3066\u307f\u307e\u3059\u3002\n\nSlack\u3068Hubot\u306e\u9023\u643a\u78ba\u8a8d\n\u307e\u305a\u306f\u3001\u3061\u3083\u3093\u3068Slack\u3068Hubot\u304c\u3046\u307e\u304f\u9023\u643a\u3057\u3066\u52d5\u3044\u3066\u308b\u304b\u78ba\u8a8d\u3057\u3066\u307f\u307e\u3059\u3002\n\n\u3061\u3083\u3093\u3068\u52d5\u3044\u3066\u307e\u3059\u306d\u3002\u3067\u306f\u3044\u3088\u3044\u3088\u3001\u30b3\u30f3\u30c6\u30ca\u3092\u8d77\u52d5\u3057\u3066\u30a2\u30d7\u30ea\u3092\u30c7\u30d7\u30ed\u30a4\u3057\u3066\u307f\u307e\u3059\u3002\n\n\u30b3\u30f3\u30c6\u30ca\u306e\u8d77\u52d5\u3068\u30a2\u30d7\u30ea\u306e\u30c7\u30d7\u30ed\u30a4\n\n49160\u756a\u30dd\u30fc\u30c8\u3067\u30b3\u30f3\u30c6\u30ca\u304c\u8d77\u52d5\u3057\u305f\u3088\u3046\u306a\u306e\u3067\u3001http://54.65.169.132:49160/docker-test-app/\u306b\u30a2\u30af\u30bb\u30b9\u3057\u3066\u307f\u307e\u3059\u3002\n\n\u3046\u307e\u304f\u3001\u30a2\u30d7\u30ea\u304c\u30c7\u30d7\u30ed\u30a4\u3055\u308c\u3066\u307e\u3059\uff08\u30d6\u30e9\u30f3\u30c1\u304c\u672a\u6307\u5b9a\u306e\u5834\u5408\u306fmaster\u30d6\u30e9\u30f3\u30c1\u304cclone\u3055\u308c\u308b\u3088\u3046\u306b\u3057\u3066\u3042\u308b\uff09\u3002\n\u3067\u306f\u6b21\u306b\u3001\u5225\u306e\u30d6\u30e9\u30f3\u30c1\u3092\u30c7\u30d7\u30ed\u30a4\u3057\u3066\u307f\u307e\u3057\u3087\u3046\u3002\n\n49162\u756a\u30dd\u30fc\u30c8\u3067\u30b3\u30f3\u30c6\u30ca\u304c\u8d77\u52d5\u3057\u305f\u3088\u3046\u306a\u306e\u3067\u3001http://54.65.169.132:49162/docker-test-app/\u306b\u30a2\u30af\u30bb\u30b9\u3057\u3066\u307f\u307e\u3059\u3002\n\n\u4eca\u5ea6\u306f\u3001\u6307\u5b9a\u3057\u305f\u3068\u304a\u308aadd_image\u30d6\u30e9\u30f3\u30c1\u306e\u5185\u5bb9\u304c\u30c7\u30d7\u30ed\u30a4\u3055\u308c\u3066\u3044\u307e\u3059\u3002\n\n\u30b3\u30f3\u30c6\u30ca\u306e\u524a\u9664\n\u4eca\u5ea6\u306f\u4e0d\u8981\u306a\u30b3\u30f3\u30c6\u30ca\u3092\u524a\u9664\u3057\u3066\u307f\u307e\u3059\u3002\n\u6700\u521d\u306b49160\u756a\u30dd\u30fc\u30c8\u3067\u8d77\u52d5\u3057\u305f\u65b9\u306e\u30b3\u30f3\u30c6\u30ca\u3092\u6d88\u3057\u3066\u307f\u307e\u3059\u3002\n\n\u30b3\u30f3\u30c6\u30ca\u304c\u524a\u9664\u3055\u308c\u3001http://54.65.169.132:49160/docker-test-app/\u306b\u30a2\u30af\u30bb\u30b9\u3057\u3066\u3082\u63a5\u7d9a\u3067\u304d\u306a\u304f\u306a\u3063\u3066\u3044\u308b\u3053\u3068\u304c\u78ba\u8a8d\u3067\u304d\u307e\u3059\u3002\n\n\u30b3\u30f3\u30c6\u30ca\u4e00\u89a7\u306e\u78ba\u8a8d\n\u30b3\u30f3\u30c6\u30ca\u4e00\u89a7\u3092\u78ba\u8a8d\u3067\u304d\u308b\u30b3\u30de\u30f3\u30c9\u3082\u5b9f\u88c5\u3057\u305f\u306e\u3067\u8a66\u3057\u3066\u307f\u307e\u3059\u3002\n\n\u3046\u307e\u304f\u8868\u793a\u3055\u308c\u307e\u3057\u305f\uff01\n\u4ee5\u4e0a\u9577\u304f\u306a\u308a\u307e\u3057\u305f\u304c\u3001Slack/Hubot/Docker\u3092\u4f7f\u3063\u305fChatOps\u3067\u30a2\u30d7\u30ea\u306e\u691c\u8a3c\u74b0\u5883\u3092\u30dd\u30f3\u30dd\u30f3\u4f5c\u3063\u3066\u3001\u30dd\u30f3\u30dd\u30f3\u6368\u3066\u308b\u65b9\u6cd5\u306b\u3064\u3044\u3066\u307e\u3068\u3081\u307e\u3057\u305f\u3002\n#\u3053\u306e\u6295\u7a3f\u306b\u3064\u3044\u3066\n\nSlack/Hubot/Docker\u3092\u7528\u3044\u305fChatOps\u3067\u30a2\u30d7\u30ea\u306e\u691c\u8a3c\u74b0\u5883\u3092\u30dd\u30f3\u30dd\u30f3\u4f5c\u3063\u3066\u3001\u30dd\u30f3\u30dd\u30f3\u6368\u3066\u308b\u65b9\u6cd5\u3092\u307e\u3068\u3081\u307e\u3059\u3002\n\u30c1\u30e3\u30c3\u30c8\u304b\u3089\u8ab0\u3067\u3082\u624b\u8efd\u306b\u4f7f\u3044\u6368\u3066\u306e\u30a2\u30d7\u30ea\u306e\u691c\u8a3c\u7528\u74b0\u5883\u3092\u4f5c\u6210\u3067\u304d\u308b\u306e\u3067\u3001\u30c1\u30fc\u30e0\u958b\u767a\u306e\u751f\u7523\u6027\u5411\u4e0a\u304c\u671f\u5f85\u3067\u304d\u307e\u3059\u3002\n\n#\u30b7\u30b9\u30c6\u30e0\u69cb\u6210\u306e\u6982\u8981\u56f3\n\n![Untitled (7).png](https://qiita-image-store.s3.amazonaws.com/0/47881/24fedae4-0d81-7cc8-1310-6efac6ed3484.png)\n\n#\u30b7\u30b9\u30c6\u30e0\u69cb\u7bc9\u624b\u9806\n\n##Slack\u3068Hubot\u306e\u9023\u643a\n\nHubot\u3092PaaS\u3067\u3042\u308bHeroku\u306b\u30c7\u30d7\u30ed\u30a4\u3055\u305b\u3001Slack\u3068\u9023\u643a\u3055\u305b\u307e\u3059\u3002\n\u3053\u3061\u3089\u306e\u5177\u4f53\u7684\u306a\u624b\u9806\u306b\u3064\u3044\u3066\u306f\u3001[\u300cSlack / Hubot / GitHub / CircleCI \u306b\u3088\u308bChatOps\u306a\u30c7\u30d7\u30ed\u30a4\u65b9\u6cd5\u300d](http://qiita.com/s-kiriki/items/26bdf537169891b22653)\u306e\u524d\u534a\u90e8\u5206\u3067\u8a73\u3057\u304f\u307e\u3068\u3081\u3066\u3044\u307e\u3059\u306e\u3067\u3001\u305d\u3061\u3089\u3092\u53c2\u7167\u304f\u3060\u3055\u3044\u3002\n\n##Docker\u3092\u52d5\u304b\u3059\u30b5\u30fc\u30d0\u30fc\u306e\u7528\u610f(EC2)\n\n\u4eca\u56de\u306fAWS\u306eEC2\u3092\u7528\u3044\u307e\u3059\u3002\n\n###EC2\u306e\u8d77\u52d5\n\n\u307e\u305a\u306f\u3001Docker\u3092\u52d5\u304b\u3059\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u3092\u7acb\u3061\u4e0a\u3052\u308b\u3002\n\u4eca\u56de\u306fCommunityAMI\u306e\u300cubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20140927\u300d\u3068\u3044\u3046\u3082\u306e\u3092\u5229\u7528\u3002\n\n![zz_\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8_2014-12-12_14_43_26.png](https://qiita-image-store.s3.amazonaws.com/0/47881/20db7024-ac90-7137-6f7e-d1b1225f9ff3.png)\n\n\u691c\u8a3c\u306a\u306e\u3067\u3001\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u30bf\u30a4\u30d7\u306f`t2.micro`\u3092\u9078\u629e\u3002\n\n![zz_\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8_2014-12-12_14_44_17.png](https://qiita-image-store.s3.amazonaws.com/0/47881/f04c21d6-bc26-36ee-d7f0-37694b4c81bb.png)\n\n\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306e\u540d\u524d\u306f\u9069\u5f53\u306b\u5206\u304b\u308a\u3084\u3059\u3044\u3082\u306e\u3092\u4ed8\u3051\u3066\u304a\u3051\u3070OK\u3002\n\n![zz_\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8_2014-12-12_14_45_27.png](https://qiita-image-store.s3.amazonaws.com/0/47881/3603600f-beaa-4dd9-1241-20a9f7e20df3.png)\n\n\nSecurity Group\u306e\u8a2d\u5b9a\u3067\u306f\u3001SSH\u7528\u30dd\u30fc\u30c8\u306e\u4ed6\u306b\u3001\u8ffd\u52a0\u3067`49153\u301c65535`\u30dd\u30fc\u30c8\u3092\u89e3\u653e\u3057\u3066\u304a\u304f\u3002\n\u3053\u308c\u306fDocker\u306e\u30dd\u30fc\u30c8\u30d5\u30a9\u30ef\u30fc\u30c7\u30a3\u30f3\u30b0\u3067\u4f7f\u7528\u3055\u308c\u308b\u30dd\u30fc\u30c8\u3067\u3042\u308b\u3002\n\n![zz_\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8_2014-12-12_14_47_29.png](https://qiita-image-store.s3.amazonaws.com/0/47881/1e688bf5-b650-7857-bb9f-33658c5c5a8b.png)\n\n\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u304c\u7acb\u3061\u4e0a\u304c\u308c\u3070\u3001IP\u3092\u78ba\u8a8d\u3057\u3066\u3061\u3083\u3093\u3068SSH\u63a5\u7d9a\u3067\u304d\u308b\u304b\u78ba\u8a8d\u3002\n\n```\nssh -i .ssh/docker-key.pem ubuntu@54.65.169.132\n\n> ubuntu@ip-172-31-6-189:~ $\n```\n\n###\u30e6\u30fc\u30b6\u30fc\u306e\u4f5c\u6210\n\nDocker\u3092\u64cd\u4f5c\u3059\u308b\u7528\u306e\u30e6\u30fc\u30b6\u30fc\u3092\u4f5c\u6210\u3059\u308b\u3002\u3053\u3053\u3067\u306f`wanko`\u3068\u3044\u3046\u540d\u524d\u3067\u4f5c\u6210\u3002\n\n```\nubuntu:~$ sudo adduser wanko\nAdding user `wanko' ...\nAdding new group `wanko' (1001) ...\nAdding new user `wanko' (1001) with group `wanko' ...\nCreating home directory `/home/wanko' ...\nCopying files from `/etc/skel' ...\nEnter new UNIX password: \nRetype new UNIX password: \npasswd: password updated successfully\nChanging the user information for wanko\nEnter the new value, or press ENTER for the default\n\tFull Name []: \n\tRoom Number []: \n\tWork Phone []: \n\tHome Phone []: \n\tOther []: \nIs the information correct? [Y/n] y\n```\n\nsudo\u6a29\u9650\u3092\u4ed8\u4e0e\n\n```\nubuntu:~$ sudo usermod -G sudo wanko\n```\n\n\u30d1\u30b9\u30ef\u30fc\u30c9\u30ec\u30b9\u3067sudo\u306b\u306a\u308c\u308b\u3088\u3046\u306b\u8a2d\u5b9a\n\n```\nubuntu:~$ sudo visudo\n\n#\u4ee5\u4e0b\u3092\u3001\u8ffd\u8a18\nwanko ALL=(ALL) NOPASSWD: ALL\n```\n\n`/etc/ssh/sshd_config`\u3092\u5909\u66f4\u3057\u3066\u3001\u30d1\u30b9\u30ef\u30fc\u30c9\u306b\u3088\u308b\u30ed\u30b0\u30a4\u30f3\u3092\u8a31\u53ef\n\n```\nubuntu:~$ sudo vi /etc/ssh/sshd_config\n```\n\n```:/etc/ssh/sshd_config\n#PasswordAuthentication no\nPasswordAuthentication yes\n```\n\n\u5909\u66f4\u3057\u305f\u8a2d\u5b9a\u3092\u53cd\u6620\u3059\u308b\u305f\u3081\u306b\u3001sshd\u3092\u518d\u8d77\u52d5\n\n```\nsudo service ssh restart\n```\n\n\u8ffd\u52a0\u3057\u305f\u30e6\u30fc\u30b6\u30fc\u3067\u30d1\u30b9\u30ef\u30fc\u30c9\u30ed\u30b0\u30a4\u30f3\u3067\u304d\u308b\u304b\u78ba\u8a8d\n\n```\nssh wanko@54.65.169.132\n\nwanko@54.65.169.132's password:\n\n```\n\n##GitHub\u306b\u30ec\u30dd\u30b8\u30c8\u30ea\u4f5c\u6210\n\n\u4eca\u56de\u306fDocker\u306e\u30b3\u30f3\u30c6\u30ca\u306bGitHub\u304b\u3089\u30a2\u30d7\u30ea\u3092clone\u3057\u3066\u304d\u3066\u52d5\u304b\u3057\u305f\u3044\u306e\u3067\u3001\u305d\u306e\u691c\u8a3c\u7528\u306e\u30ec\u30dd\u30b8\u30c8\u30ea\u3092\u4f5c\u308a\u307e\u3059\u3002\n\u4eca\u56de\u306fHTML\u3060\u3051\u306e\u30b7\u30f3\u30d7\u30eb\u306a\u30a2\u30d7\u30ea\u306b\u3057\u3066\u3044\u307e\u3059\u3002\n\n**\u5b9f\u969b\u306e\u30ec\u30dd\u30b8\u30c8\u30ea**\nhttps://github.com/s-kiriki/docker-test-app\n\n\n\u307e\u305f\u4eca\u56de\u306fChatOps\u3067\u30d6\u30e9\u30f3\u30c1\u3092\u81ea\u7531\u306b\u5207\u308a\u66ff\u3048\u3066Docker\u30b3\u30f3\u30c6\u30ca\u306b\u4efb\u610f\u306e\u30d6\u30e9\u30f3\u30c1\u3092\u30c7\u30d7\u30ed\u30a4\u51fa\u6765\u308b\u304b\u3092\u691c\u8a3c\u3057\u305f\u3044\u306e\u3067\u3001\n\u4ee5\u4e0b\u306e\uff12\u3064\u306e\u30d6\u30e9\u30f3\u30c1\u3092\u7528\u610f\u3057\u307e\u3057\u305f\u3002\n\n\u30fbmaster\u30d6\u30e9\u30f3\u30c1\n\u30b7\u30f3\u30d7\u30eb\u306b\u300cHello from Docker!\u300d\u3068\u3060\u3051\u8868\u793a\u3055\u308c\u308b\u5b9f\u88c5\n\n\n\u30fbadd_image\u30d6\u30e9\u30f3\u30c1\n\u300cHello from Docker!\u300d\u306e\u4e0b\u306bDocker\u306e\u30a4\u30e1\u30fc\u30b8\uff08\u30af\u30b8\u30e9\u306e\u3084\u3064\uff09\u304c\u8868\u793a\u3055\u308c\u308b\u5b9f\u88c5\n\n\n![\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2014-12-12 15.52.35.png](https://qiita-image-store.s3.amazonaws.com/0/47881/1fd87f28-39f7-9986-6eac-e54679bc0732.png)\n\n\n\n\n\n\n##Docker\u30db\u30b9\u30c8OS\u306e\u7528\u610f\n\n\u4e0a\u3067\u7acb\u3061\u4e0a\u3052\u305f\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306bDocker\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u3066\u3001\u5404\u7a2e\u8a2d\u5b9a\u3092\u884c\u3063\u3066\u3044\u304d\u307e\u3059\u3002\n\u4ee5\u4e0b\u3001\u3053\u306eDocker\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u305f\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u3092Docker\u30db\u30b9\u30c8OS\u3068\u66f8\u304d\u307e\u3059\u3002\n\n###Docker\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n[\u516c\u5f0f\u30b5\u30a4\u30c8](https://docs.docker.com/installation/ubuntulinux/)\u306b\u5f93\u3063\u3066\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\u3002\n\n```\nsudo apt-get update\nsudo apt-get install docker.io\n```\n\n\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u305f\u304b\u78ba\u8a8d\n\n```\nsudo docker --version\nDocker version 1.0.1, build 990021a\n```\n\nVersion1.3\u3088\u308a\u8ffd\u52a0\u3055\u308c\u305f`docker exec`\u3092\u4f7f\u3044\u305f\u3044\u306e\u3067\u3001Docker\u3092\u6700\u65b0\u7248\u306bUPDATE\n\n```\ncurl -sSL https://get.docker.com/ubuntu/ | sudo sh\n```\n\n```\nsudo docker --version\nDocker version 1.4.0, build 4595d4f\n```\n\n###Dockerfile\u304a\u3088\u3073\u3001\u30b3\u30f3\u30c6\u30ca\u306b\u8ee2\u9001\u3059\u308b\u30d5\u30a1\u30a4\u30eb\u306e\u4f5c\u6210\n\nDockerfile\u3092\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u4f5c\u6210\u3057\u307e\u3059\u3002\n\n```:Dockerfile\nFROM centos:centos6\n\nRUN yum update -y\nRUN yum install -y httpd\nRUN yum install -y git\n\nADD ./app_init.sh /\n\nRUN mkdir /root/.ssh/\nADD id_rsa /root/.ssh/id_rsa\nRUN chmod 700 /root/.ssh/id_rsa\n\nRUN echo -e \"Host github.com\\n\\tStrictHostKeyChecking no\\n\" >> /root/.ssh/config\n\nEXPOSE 80\nCMD [\"/usr/sbin/httpd\", \"-D\", \"FOREGROUND\"]\n```\n\n`ADD`\u30b3\u30de\u30f3\u30c9\u3067\u6307\u5b9a\u3057\u3066\u3044\u308b`app_init.sh`\u3068`id_rsa`\u306f\u30b3\u30f3\u30c6\u30ca\u306b\u8ee2\u9001\u3059\u308b\u3082\u306e\u3067\u3059\u306e\u3067\u3001\u4e88\u3081\u624b\u5143\u3067\u4f5c\u6210\u306b\u3066\u304a\u304f\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\n`id_rsa`\u306fGitHub\u306b\u8a8d\u8a3c\u53ef\u80fd\u306a\u79d8\u5bc6\u9375\u3067\u3001`app_init.sh`\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306a`git clone`\u3067\u5148\u307b\u3069\u3064\u304f\u3063\u305f\u691c\u8a3c\u7528\u306e\u30ec\u30dd\u30b8\u30c8\u30ea\u3092clone\u3057\u3066\u304f\u308b\u30b7\u30a7\u30eb\u30b9\u30af\u30ea\u30d7\u30c8\u3067\u3059\u3002\n\n```:app_init.sh\n#!/bin/bash\n\nif [ $# -ne 1 ]; then\n echo \"You must specify branch name\"\n exit 1 \nfi\n\nBRANCH_NAME=$1\n\ncd /var/www/html && git clone -b $BRANCH_NAME --depth 1 git@github.com:s-kiriki/docker-test-app.git\n```\n\n###Docker\u30a4\u30e1\u30fc\u30b8\u306e\u4f5c\u6210\n\n\u4e0a\u3067\u4f5c\u3063\u305fDockerfile\u3088\u308aDocker\u30a4\u30e1\u30fc\u30b8\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\u4eca\u624b\u5143\u306b\u306f\u3001`Dockerfile`\u3001`app_init.sh`\u3001`id_rsa`\u304c\u3042\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n```\nwanko@ip-172-31-6-189:~$ ls\napp_init.sh  Dockerfile  id_rsa\n```\n\n\u30a4\u30e1\u30fc\u30b8\u306e\u4f5c\u6210\u306f`docker build`\u30b3\u30de\u30f3\u30c9\u3067\u884c\u3044\u307e\u3059\u3002`-t`\u30aa\u30d7\u30b7\u30e7\u30f3\u3067\u30a4\u30e1\u30fc\u30b8\u540d\uff08\u4eca\u56de\u306fdocker-app\u3068\u3057\u305f\uff09\u3092\u6307\u5b9a\u3057\u3001\u6700\u5f8c\u306e`.`\u306f`Dockerfile`\u306e\u30d1\u30b9\uff08\u4eca\u56de\u306f\u30ab\u30ec\u30f3\u30c8\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\uff09\u3092\u6307\u5b9a\u3057\u3066\u3044\u307e\u3059\u3002\n\n```\n$ sudo docker build -t docker_app .\n```\n\nDocker\u30a4\u30e1\u30fc\u30b8\u304c\u4f5c\u3089\u308c\u305f\u304b\u3092`docker image`\u30b3\u30de\u30f3\u30c9\u3067\u78ba\u8a8d\u3057\u307e\u3059\u3002\n\n```\n$ sudo docker images\n\nREPOSITORY          TAG                 IMAGE ID            CREATED             VIRTUAL SIZE\ndocker_app          latest              6900f52b1ac5        5 seconds ago       466.5 MB\n\n```\n\n###\u30b3\u30f3\u30c6\u30ca\u306e\u8d77\u52d5\n\n\u4e0a\u3067\u4f5c\u3063\u305fDocker\u30a4\u30e1\u30fc\u30b8\u3092\u4f7f\u3063\u3066\u3001`docker run`\u30b3\u30de\u30f3\u30c9\u3067\u30b3\u30f3\u30c6\u30ca\u3092\u8d77\u52d5\u3055\u305b\u307e\u3059\u3002\n`-d`\u30aa\u30d7\u30b7\u30e7\u30f3\u3067Apache\u3092\u30c7\u30fc\u30e2\u30f3\u5316\u3055\u305b\u3001`-P`\u30aa\u30d7\u30b7\u30e7\u30f3\u3067\u30dd\u30fc\u30c8\u30d5\u30a9\u30ef\u30fc\u30c7\u30a3\u30f3\u30b0\u3092\u884c\u3044\u307e\u3059\u3002\n\n```\n$ sudo docker run -d -P docker_app\nafbf3bd7c6be6e36ca436d34880b49970bacb25a72a9a351c9d3c28d5a8cd0a6\n\n```\n\n\u30b3\u30f3\u30c6\u30ca\u304c\u4f5c\u3089\u308c\u305f\u304b\u306f\u3001`docker ps`\u30b3\u30de\u30f3\u30c9\u3067\u78ba\u8a8d\u3067\u304d\u307e\u3059\u3002\n\n```\n$ sudo docker ps\nCONTAINER ID        IMAGE               COMMAND                CREATED             STATUS              PORTS                   NAMES\nafbf3bd7c6be        docker_app:latest   \"/usr/sbin/httpd -D    2 minutes ago       Up 2 minutes        0.0.0.0:49157->80/tcp   kickass_brown     \n```\n\n80\u756a\u30dd\u30fc\u30c8\u304c49157\u756a\u30dd\u30fc\u30c8\u306b\u30dd\u30fc\u30c8\u30d5\u30a9\u30ef\u30fc\u30c7\u30a3\u30f3\u30b0\u3055\u308c\u3066\u3044\u308b\u306e\u304c\u308f\u304b\u308a\u307e\u3059\u3002\n\n\u3053\u306e\u72b6\u614b\u3067\u3001`http://54.65.169.132:49157/`\uff0854.65.169.132\u306e\u90e8\u5206\u306fDocker\u30db\u30b9\u30c8OS\u306e\u30a2\u30c9\u30ec\u30b9\uff09\u306b\u30a2\u30af\u30bb\u30b9\u3059\u308b\u3068\u3001Apache\u306e\u30db\u30fc\u30e0\u753b\u9762\u304c\u8868\u793a\u3055\u308c\u3066\u3044\u308b\u306f\u305a\u3067\u3059\u3002\n\n![\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2014-12-12 17.17.05.png](https://qiita-image-store.s3.amazonaws.com/0/47881/d3b3184f-ae8f-94da-3b99-689780946007.png)\n\n###\u30a2\u30d7\u30ea\u306e\u8a2d\u7f6e\n\n\u6b21\u306b\u3001\u3053\u306e`docker run`\u3067\u7acb\u3061\u4e0a\u3052\u305f\u30b3\u30f3\u30c6\u30ca\u306b\u30a2\u30d7\u30ea\u3092\u8a2d\u7f6e\u3057\u307e\u3059\uff08GitHub\u304b\u3089clone\uff09\u3002\n\u30b3\u30f3\u30c6\u30ca\u306b\u5bfe\u3057\u3066\u306e\u30b3\u30de\u30f3\u30c9\u306e\u5b9f\u884c\u306f`docker exec`\u30b3\u30de\u30f3\u30c9\u3067\u884c\u3048\u307e\u3059\u3002\n\u4eca\u56de\u306f\u30b3\u30f3\u30c6\u30ca\u5074\u306b\u65e2\u306b\u3042\u308b`app_init.sh`\u3092\u5b9f\u884c\u3055\u305b\u308c\u3070\u3044\u3044\u3060\u3051\u306a\u306e\u3067\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u3057\u307e\u3059\u3002\n\n```\n$ sudo docker exec kickass_brown sh app_init.sh master\n```\n\n`kickass_brown`\u306f\u30b3\u30f3\u30c6\u30ca\u540d\u3001`master`\u306f\u30d6\u30e9\u30f3\u30c1\u540d\n\n\n\u3053\u308c\u3067\u30b3\u30f3\u30c6\u30ca\u306b\u30a2\u30d7\u30ea\u304c\u8a2d\u7f6e\u3055\u308c\u305f\u306e\u3067\u3001`http://54.65.169.132:49157/docker-test-app`\u306b\u30a2\u30af\u30bb\u30b9\u3059\u308b\u3068\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u30a2\u30d7\u30ea\u304c\u52d5\u304f\u306f\u305a\u3067\u3059\u3002\n\n![\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2014-12-12 17.37.38.png](https://qiita-image-store.s3.amazonaws.com/0/47881/18a6716c-2b16-2ca4-71e8-4377244b0073.png)\n\nDocker\u3067\u8d77\u52d5\u3055\u305b\u305f\u30b3\u30f3\u30c6\u30ca\u3067GitHub\u4e0a\u306e\u30a2\u30d7\u30ea\u304c\u52d5\u304d\u307e\u3057\u305f\uff01\uff01\n\n\n###\u3053\u3053\u307e\u3067\u306e\u307e\u3068\u3081\n\n\u3053\u3053\u3067\u306f\u3001\u5927\u304d\u304f\u5206\u3051\u3066\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u3053\u3068\u3092\u884c\u3063\u3066\u304d\u307e\u3057\u305f\u3002\n\n1. Docker\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n2. Dockerfile\u306e\u4f5c\u6210\u3068\u30a2\u30d7\u30ea\u8a2d\u7f6e\u30b7\u30a7\u30eb\u30b9\u30af\u30ea\u30d7\u30c8\u306e\u4f5c\u6210\n3. Docker\u30a4\u30e1\u30fc\u30b8\u306e\u4f5c\u6210(`docker build`)\n4. Docker\u30b3\u30f3\u30c6\u30ca\u306e\u8d77\u52d5(`docker run`)\n5. \u30a2\u30d7\u30ea\u306e\u8a2d\u7f6e(`docker exec`)\n\n\u4eca\u56de\u306e\u6700\u7d42\u76ee\u7684\u306fChatOps\uff08Slack\u304b\u3089\u6307\u4ee4\u3092\u51fa\u3059\uff09\u3067\u3001\u6307\u5b9a\u306e\u30a2\u30d7\u30ea\u306e\u691c\u8a3c\u74b0\u5883\u3092\u30dd\u30f3\u30dd\u30f3\u3064\u304f\u308b\u3053\u3068\uff08\u30b3\u30f3\u30c6\u30ca\u3092\u30dd\u30f3\u30dd\u30f3\u8d77\u52d5\u3055\u305b\u308b\u3053\u3068\uff09\u3067\u3042\u3063\u305f\u306e\u3067\u3001\u3053\u306e1~5\u306e\u4e2d\u306e4\u30685\u3092Slack\u7d4c\u7531\u3067\u884c\u3046\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\n\u4ee5\u964d\u306e\u7bc0\u3067\u3001\u3053\u308c\u3089\u306e\u65b9\u6cd5\u3092\u8aac\u660e\u3057\u3066\u3044\u304d\u307e\u3059\u3002\n\n\n\n##Hubot\u304b\u3089Docker\u30b3\u30f3\u30c6\u30ca\u306e\u8d77\u52d5\u3068\u30a2\u30d7\u30ea\u306e\u8a2d\u7f6e\u3092\u884c\u3046\n\nSlack\u3068Hubot(Heroku\u4e0a\u306b\u30c7\u30d7\u30ed\u30a4)\u306e\u9023\u643a\u306f\u65e2\u306b\u6e08\u3093\u3067\u3044\u308b\u306e\u3067\u3001\u3042\u3068\u306fHubot\u304b\u3089Docker\u30db\u30b9\u30c8OS\u306b\u547d\u4ee4\u3092\u51fa\u3057\u3066\u30b3\u30f3\u30c6\u30ca\u306e\u8d77\u52d5\u3068\u30a2\u30d7\u30ea\u306e\u8a2d\u7f6e\u304c\u884c\u3048\u308c\u3070\u3001ChatOps\u3067\u30a2\u30d7\u30ea\u306e\u691c\u8a3c\u74b0\u5883\u3092\u4f5c\u308c\u308b\u3053\u3068\u306b\u306a\u308a\u307e\u3059\u3002\n\n\u3053\u306e\u5b9f\u88c5\u65b9\u6cd5\u3068\u3057\u3066\u3001\u4eca\u56de\u306fDocker\u30db\u30b9\u30c8OS\u306bDocker\u30b3\u30f3\u30c6\u30ca\u306e\u8d77\u52d5\u3068\u30a2\u30d7\u30ea\u306e\u8a2d\u7f6e\u3092\u884c\u3046\u30b7\u30a7\u30eb\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u7528\u610f\u3057\u3001\u305d\u306e\u30b9\u30af\u30ea\u30d7\u30c8\u3092Hubot\u304b\u3089ssh\u3067\u63a5\u7d9a\u3057\u3066\u5b9f\u884c\u3059\u308b\u3068\u3044\u3046\u69cb\u6210\u306b\u3057\u307e\u3057\u305f\u3002\n\n###\u30b7\u30a7\u30eb\u30b9\u30af\u30ea\u30d7\u30c8\u306e\u7528\u610f\uff08Docker\u30db\u30b9\u30c8OS\uff09\n\nDocker\u30db\u30b9\u30c8OS\u306bDocker\u30b3\u30f3\u30c6\u30ca\u306e\u8d77\u52d5\u3068\u30a2\u30d7\u30ea\u306e\u8a2d\u7f6e\u3092\u884c\u3046\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u30b7\u30a7\u30eb\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u7528\u610f\u3057\u307e\u3059\u3002\n\n\n```sh:container-up.sh\n#!/bin/bash\n\nif [ $# -ne 1 ]; then\n echo \"You must specify branch name\"\n exit 1\nfi\n\nBRANCH_NAME=$1\n\nCONTAINER_ID=`sudo docker run -d -P docker_app` # \u30b3\u30f3\u30c6\u30ca\u306e\u8d77\u52d5\nif [ $? -ne 0 ]\nthen\n        echo \"Error occured on running container.\"\n        exit 1\nfi\n\necho \"Created Container:$CONTAINER_ID\"\n\nPORT_FORWARDING=`sudo docker port $CONTAINER_ID`\nif [ $? -ne 0 ]\nthen\n        echo \"Error occured on checking port forwarding.\"\n        exit 1\nfi\n\nsudo docker exec $CONTAINER_ID sh app_init.sh $BRANCH_NAME # \u30a2\u30d7\u30ea\u306e\u8a2d\u7f6e\nif [ $? -ne 0 ]\nthen\n        echo \"Error occured on setting app.\"\n        exit 1\nfi\n\necho \":docker: Your app is ready!! $PORT_FORWARDING\" # :docker: \u3068\u3044\u3046\u306e\u306fSlack\u306e\u30ab\u30b9\u30bf\u30e0\u7d75\u6587\u5b57\n```\n\n\u30dd\u30f3\u30dd\u30f3\u4f5c\u308b\u3060\u3051\u3067\u306f\u306a\u304f\u3001\u30dd\u30f3\u30dd\u30f3\u6368\u3066\u308b\u3053\u3068\u3082\u76ee\u7684\u3060\u3063\u305f\u306e\u3067\u3001\u540c\u69d8\u306b\u30b3\u30f3\u30c6\u30ca\u3092\u524a\u9664\u3059\u308b\u30b9\u30af\u30ea\u30d7\u30c8\u3082\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u4f5c\u308a\u307e\u3059\u3002\n\n```sh:container-remove.sh\n#!/bin/bash\n\nif [ $# -ne 1 ]; then\n echo \"You must specify container name or ID\"\n exit 1\nfi\n\nCONTAINER_ID=$1\n\nREMOVED_CONTAINER=`sudo docker rm -f $CONTAINER_ID`\nif [ $? -ne 0 ]\nthen\n        echo \"Error occured on removing container $CONTAINER_ID.\"\n        exit 1\nfi\n\necho \":docker: Removed container: $REMOVED_CONTAINER\" # :docker: \u3068\u3044\u3046\u306e\u306fSlack\u306e\u30ab\u30b9\u30bf\u30e0\u7d75\u6587\u5b57\n```\n\n###Hubot\u30b9\u30af\u30ea\u30d7\u30c8\u306e\u4f5c\u6210\n\n\u6b21\u306b\u3001Docker\u30db\u30b9\u30c8OS\u306b\u8a2d\u7f6e\u3057\u305f`container-up.sh`\u304a\u3088\u3073`container-remove.sh`\u3092ssh\u7d4c\u7531\u3067\u5b9f\u884c\u3059\u308b\u305f\u3081\u306e\u30b9\u30af\u30ea\u30d7\u30c8\u3092Hubot\u306b\u8ffd\u52a0\u3057\u307e\u3059\u3002\n\nsimple-ssh\u3068\u3044\u3046npm\u30e2\u30b8\u30e5\u30fc\u30eb\u3092\u4f7f\u3046\u306e\u3067\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n\n```\nnpm install simple-ssh --save\n```\n\n\u5b9f\u969b\u306e\u30b3\u30fc\u30c9\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u3057\u307e\u3057\u305f\u3002\n\n```hubot-container.coffee\n# Description:\n#  Handling Docker containers.\n#\n# Dependencies:\n#   \"simple-ssh\": \"^0.8.1\"\n#\t\"hubot-slack\": \"^2.2.0\"\n#\n# Configuration:\n#   [Required]\n#     DOCKER_HOST\n#     DOCKER_USER\n#     DOCKER_PASSWD\n#\n# Author:\n#   s-kiriki\n\n\nmodule.exports = (robot) ->\n\n\t_getSSH = (msg) ->\n\t\tif !process.env.DOCKER_HOST\n\t\t\treturn msg.send 'You must set ENV: DOCKER_HOST'\n\t\tif !process.env.DOCKER_USER\n\t\t\treturn msg.send 'You must set ENV: DOCKER_USER'\n\t\tif !process.env.DOCKER_PASSWD\n\t\t\treturn msg.send 'You must set ENV: DOCKER_PASSWD'\n\t\n\t\tSSH = require('simple-ssh');\n\t\tssh = new SSH({\n\t\t\thost: process.env.DOCKER_HOST,\n\t\t\tuser: process.env.DOCKER_USER,\n\t\t\tpass: process.env.DOCKER_PASSWD\n\t\t});\n\t\treturn ssh\n\n\trobot.respond /container up( (.+))?/i, (msg) ->\n\t\tbranch_name = msg.match[2] || \"master\"\n\t\tssh = _getSSH(msg)\n\t\tssh.exec(\"sh container-up.sh #{branch_name}\", {\n\t\t    out: (stdout) ->\n\t\t        msg.send stdout\n\t\t}).start();\n\t\t\n\trobot.respond /container remove (\\w+)/i, (msg) ->\n\t\tcontainer_id = msg.match[1]\n\t\tssh = _getSSH(msg)\n\t\tssh.exec(\"sh container-remove.sh #{container_id}\", {\n\t\t    out: (stdout) ->\n\t\t        msg.send stdout\n\t\t}).start();\n\t\t\n\trobot.respond /container list/i, (msg) ->\n\t\tssh = _getSSH(msg)\n\t\tssh.exec(\"sudo docker ps | awk '{print $1, $(NF-1), $(NF)}'\", {\n\t\t    out: (stdout) ->\n\t\t        msg.send stdout\n\t\t}).start();\t\n\n```\n\n\n\n\n###Heroku\u4e0a\u3067Hubot\u30b9\u30af\u30ea\u30d7\u30c8\u7528\u306e\u74b0\u5883\u5909\u6570\u3092\u30bb\u30c3\u30c8\n\n`hubot-container.coffee`\u3067\u306f`DOCKER_HOST`\u3001`DOCKER_USER`\u3001`DOCKER_PASSWD`\u3092\u74b0\u5883\u5909\u6570\u3067\u30bb\u30c3\u30c8\u3059\u308b\u5fc5\u8981\u304c\u3042\u308b\u306e\u3067\u3001\u3053\u308c\u3089\u3092Heroku\u4e0a\u3067\u8a2d\u7f6e\u3057\u307e\u3059\u3002\n\n![zz_\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8_2014-12-12_18_19_07.png](https://qiita-image-store.s3.amazonaws.com/0/47881/db201da5-394a-61e3-7f59-6db146dff94d.png)\n\n\n##\u30c7\u30e2\n\n\u3088\u3046\u3084\u304f\u6e96\u5099\u304c\u6574\u3063\u305f\u306e\u3067\u3001Slack\u304b\u3089Docker\u3092\u64cd\u4f5c\u3057\u3066\u691c\u8a3c\u74b0\u5883\u3092\u30dd\u30f3\u30dd\u30f3\u4f5c\u3063\u3066\u307f\u307e\u3059\u3002\n\n###Slack\u3068Hubot\u306e\u9023\u643a\u78ba\u8a8d\n\n\u307e\u305a\u306f\u3001\u3061\u3083\u3093\u3068Slack\u3068Hubot\u304c\u3046\u307e\u304f\u9023\u643a\u3057\u3066\u52d5\u3044\u3066\u308b\u304b\u78ba\u8a8d\u3057\u3066\u307f\u307e\u3059\u3002\n\n![zz_\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8_2014-12-12_18_24_05.png](https://qiita-image-store.s3.amazonaws.com/0/47881/79a1ef20-1b5f-3f49-9142-a5faa324898c.png)\n\n\n\u3061\u3083\u3093\u3068\u52d5\u3044\u3066\u307e\u3059\u306d\u3002\u3067\u306f\u3044\u3088\u3044\u3088\u3001\u30b3\u30f3\u30c6\u30ca\u3092\u8d77\u52d5\u3057\u3066\u30a2\u30d7\u30ea\u3092\u30c7\u30d7\u30ed\u30a4\u3057\u3066\u307f\u307e\u3059\u3002\n\n###\u30b3\u30f3\u30c6\u30ca\u306e\u8d77\u52d5\u3068\u30a2\u30d7\u30ea\u306e\u30c7\u30d7\u30ed\u30a4\n\n\n![\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2014-12-12 18.51.30.png](https://qiita-image-store.s3.amazonaws.com/0/47881/9e342518-6976-43a3-aadf-bd9bdab1cedf.png)\n\n\n49160\u756a\u30dd\u30fc\u30c8\u3067\u30b3\u30f3\u30c6\u30ca\u304c\u8d77\u52d5\u3057\u305f\u3088\u3046\u306a\u306e\u3067\u3001`http://54.65.169.132:49160/docker-test-app/`\u306b\u30a2\u30af\u30bb\u30b9\u3057\u3066\u307f\u307e\u3059\u3002\n\n![\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2014-12-12 18.54.53.png](https://qiita-image-store.s3.amazonaws.com/0/47881/96c9a92e-5ea8-1d36-49cb-bc309d73fa81.png)\n\n\u3046\u307e\u304f\u3001\u30a2\u30d7\u30ea\u304c\u30c7\u30d7\u30ed\u30a4\u3055\u308c\u3066\u307e\u3059\uff08\u30d6\u30e9\u30f3\u30c1\u304c\u672a\u6307\u5b9a\u306e\u5834\u5408\u306fmaster\u30d6\u30e9\u30f3\u30c1\u304cclone\u3055\u308c\u308b\u3088\u3046\u306b\u3057\u3066\u3042\u308b\uff09\u3002\n\n\u3067\u306f\u6b21\u306b\u3001\u5225\u306e\u30d6\u30e9\u30f3\u30c1\u3092\u30c7\u30d7\u30ed\u30a4\u3057\u3066\u307f\u307e\u3057\u3087\u3046\u3002\n\n![\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2014-12-12 18.59.32.png](https://qiita-image-store.s3.amazonaws.com/0/47881/03a4ba45-99ae-a590-3741-3857b46e147b.png)\n\n49162\u756a\u30dd\u30fc\u30c8\u3067\u30b3\u30f3\u30c6\u30ca\u304c\u8d77\u52d5\u3057\u305f\u3088\u3046\u306a\u306e\u3067\u3001`http://54.65.169.132:49162/docker-test-app/`\u306b\u30a2\u30af\u30bb\u30b9\u3057\u3066\u307f\u307e\u3059\u3002\n\n![\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2014-12-12 18.56.54.png](https://qiita-image-store.s3.amazonaws.com/0/47881/4e9dce71-dd32-31e7-3a09-6d6c7a9b1269.png)\n\n\u4eca\u5ea6\u306f\u3001\u6307\u5b9a\u3057\u305f\u3068\u304a\u308a`add_image`\u30d6\u30e9\u30f3\u30c1\u306e\u5185\u5bb9\u304c\u30c7\u30d7\u30ed\u30a4\u3055\u308c\u3066\u3044\u307e\u3059\u3002\n\n###\u30b3\u30f3\u30c6\u30ca\u306e\u524a\u9664\n\n\u4eca\u5ea6\u306f\u4e0d\u8981\u306a\u30b3\u30f3\u30c6\u30ca\u3092\u524a\u9664\u3057\u3066\u307f\u307e\u3059\u3002\n\u6700\u521d\u306b49160\u756a\u30dd\u30fc\u30c8\u3067\u8d77\u52d5\u3057\u305f\u65b9\u306e\u30b3\u30f3\u30c6\u30ca\u3092\u6d88\u3057\u3066\u307f\u307e\u3059\u3002\n\n![\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2014-12-12 19.05.02.png](https://qiita-image-store.s3.amazonaws.com/0/47881/22f1cf02-2833-e16b-ad3e-c8ff5ab067be.png)\n\n\n\u30b3\u30f3\u30c6\u30ca\u304c\u524a\u9664\u3055\u308c\u3001`http://54.65.169.132:49160/docker-test-app/`\u306b\u30a2\u30af\u30bb\u30b9\u3057\u3066\u3082\u63a5\u7d9a\u3067\u304d\u306a\u304f\u306a\u3063\u3066\u3044\u308b\u3053\u3068\u304c\u78ba\u8a8d\u3067\u304d\u307e\u3059\u3002\n\n###\u30b3\u30f3\u30c6\u30ca\u4e00\u89a7\u306e\u78ba\u8a8d\n\n\u30b3\u30f3\u30c6\u30ca\u4e00\u89a7\u3092\u78ba\u8a8d\u3067\u304d\u308b\u30b3\u30de\u30f3\u30c9\u3082\u5b9f\u88c5\u3057\u305f\u306e\u3067\u8a66\u3057\u3066\u307f\u307e\u3059\u3002\n\n![\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2014-12-12 19.07.40.png](https://qiita-image-store.s3.amazonaws.com/0/47881/75be79b0-cfad-e9df-88e0-4bf40a5ea718.png)\n\n\u3046\u307e\u304f\u8868\u793a\u3055\u308c\u307e\u3057\u305f\uff01\n\n\u4ee5\u4e0a\u9577\u304f\u306a\u308a\u307e\u3057\u305f\u304c\u3001Slack/Hubot/Docker\u3092\u4f7f\u3063\u305fChatOps\u3067\u30a2\u30d7\u30ea\u306e\u691c\u8a3c\u74b0\u5883\u3092\u30dd\u30f3\u30dd\u30f3\u4f5c\u3063\u3066\u3001\u30dd\u30f3\u30dd\u30f3\u6368\u3066\u308b\u65b9\u6cd5\u306b\u3064\u3044\u3066\u307e\u3068\u3081\u307e\u3057\u305f\u3002\n", "tags": ["Slack", "ChatOps", "Hubot", "docker"]}