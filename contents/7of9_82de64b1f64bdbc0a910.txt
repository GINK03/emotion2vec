{"context": " More than 1 year has passed since last update.\n\u52d5\u4f5c\u78ba\u8a8d\nC++ Builder XE4\n\n\n64bit\u7248Windows\u4e0a\u306b\u306632bit\u5bfe\u5fdc\u306e\u30d7\u30ed\u30b0\u30e9\u30e0\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u305f\u6642\u306f \u300cC:\\Program Files (x86)\u300d\u3068\u3044\u3046\u30d5\u30a9\u30eb\u30c0\u306b\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u308b\u3002\n\u3053\u306e\u30d5\u30a9\u30eb\u30c0\u540d\u306e\u53d6\u5f97\u3002\nString ProgFilesDir = GetEnvironmentVariable(\"ProgramFiles(x86)\");\n\nC:\\Program Files (x86)\n\u304c\u306a\u3044PC\u4e0a\u3067\u306fProgFilesDir\u306f L\"\"\u306b\u306a\u308b\u3002\n\u4ee5\u4e0b\u306f\u53c2\u8003\u306b\u306a\u3063\u305f\u30da\u30fc\u30b8\u3002\nhttp://www.gesource.jp/weblog/?p=4709\nhttp://office-qa.com/win/win182.htm\n\n32bit OS, 64bit OS\u3069\u3061\u3089\u3067\u3082\u30d5\u30a9\u30eb\u30c0\u540d\u3092\u53d6\u5f97\u3059\u308b\u306b\u306f (\u305f\u3060\u3057\u300132bit\u30bd\u30d5\u30c8\u3068\u3044\u3046\u524d\u63d0\u3067\u306f)\u3002\n\nstatic String getProgramFilesDir()\n{\n    String ProgFilesDir = GetEnvironmentVariable(L\"ProgramFiles(x86)\"); // 32bit \u30bd\u30d5\u30c8 on 64bit OS\n\n    if (ProgFilesDir.Length() == 0) {\n        ProgFilesDir = GetEnvironmentVariable(L\"ProgramFiles\");\n    }\n\n    return ProgFilesDir;\n}\n\n```txt:\u52d5\u4f5c\u78ba\u8a8d\nC++ Builder XE4\n```\n\n64bit\u7248Windows\u4e0a\u306b\u306632bit\u5bfe\u5fdc\u306e\u30d7\u30ed\u30b0\u30e9\u30e0\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u305f\u6642\u306f \u300cC:\\Program Files (x86)\u300d\u3068\u3044\u3046\u30d5\u30a9\u30eb\u30c0\u306b\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u308b\u3002\n\u3053\u306e\u30d5\u30a9\u30eb\u30c0\u540d\u306e\u53d6\u5f97\u3002\n\n```cpp\nString ProgFilesDir = GetEnvironmentVariable(\"ProgramFiles(x86)\");\n```\n\nC:\\Program Files (x86)\n\u304c\u306a\u3044PC\u4e0a\u3067\u306fProgFilesDir\u306f L\"\"\u306b\u306a\u308b\u3002\n\n\u4ee5\u4e0b\u306f\u53c2\u8003\u306b\u306a\u3063\u305f\u30da\u30fc\u30b8\u3002\nhttp://www.gesource.jp/weblog/?p=4709\nhttp://office-qa.com/win/win182.htm\n\n<hr>\n32bit OS, 64bit OS\u3069\u3061\u3089\u3067\u3082\u30d5\u30a9\u30eb\u30c0\u540d\u3092\u53d6\u5f97\u3059\u308b\u306b\u306f (\u305f\u3060\u3057\u300132bit\u30bd\u30d5\u30c8\u3068\u3044\u3046\u524d\u63d0\u3067\u306f)\u3002\n\n```cpp\nstatic String getProgramFilesDir()\n{\n\tString ProgFilesDir = GetEnvironmentVariable(L\"ProgramFiles(x86)\"); // 32bit \u30bd\u30d5\u30c8 on 64bit OS\n\n\tif (ProgFilesDir.Length() == 0) {\n\t\tProgFilesDir = GetEnvironmentVariable(L\"ProgramFiles\");\n\t}\n\n\treturn ProgFilesDir;\n}\n```\n\n", "tags": ["cppBuilder"]}