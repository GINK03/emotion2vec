{"context": "\u591a\u5206\u3001\u3053\u306e\u8a18\u4e8b\u306f\u8ab0\u306e\u5f79\u306b\u3082\u7acb\u305f\u306a\u3044\u3067\u3059\u3002\n\u306a\u305c\u306a\u3089\u30012016\u5e7411\u6708\u73fe\u5728\u3067\u3001\u3053\u3093\u306a\u30ec\u30ac\u30b7\u30fc\u306a\u74b0\u5883\u306f\u5c11\u306a\u3044\u3060\u308d\u3046\u304b\u3089\u3067\u3059\u3002\n\u3068\u306f\u3044\u3048\u3001\u8ab0\u304b\u306e\u5f79\u306b\u7acb\u3064\u304b\u3082\u3057\u308c\u306a\u3044\u306e\u3067\u8a18\u8f09\u3057\u3066\u304a\u304d\u307e\u3059\u3002\u3082\u3063\u3068\u3044\u3044\u3084\u308a\u65b9\u304c\u3042\u308c\u3070\u6559\u3048\u3066\u4e0b\u3055\u3044\u3002\n\u4e0b\u8a18\u306e\u74b0\u5883\u3092\u69cb\u7bc9\u3057\u307e\u3057\u305f\u3002\n\nPHP 5.3\nOracle\uff08\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u306e\u307f\u300111g)\nCentOS 5.1\n\nPHP\u62e1\u5f35\u3068\u3057\u3066\u4e0b\u8a18\u3092\u5165\u308c\u3066\u3044\u307e\u3059\u3002\n\nPHP-Redis\nAPC\n\n\u30d5\u30a1\u30a4\u30eb\u306e\u5168\u4f53\u306f\u3053\u3093\u306a\u611f\u3058\u3002Redis\u306f\u5272\u611b\u3002\n.\n|-- docker-compose.yml\n|-- app/\uff08\u4ee5\u4e0b\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\uff09\n`-- web/\n    |-- Dockerfile\n    |-- httpd.conf\n    |-- oracle-instantclient11.2-basic-11.2.0.4.0-1.x86_64.rpm\n    |-- oracle-instantclient11.2-devel-11.2.0.4.0-1.x86_64.rpm\n    |-- oracle-instantclient11.2-sqlplus-11.2.0.4.0-1.x86_64.rpm\n    `-- php.ini\n\n\nDocker compose\u306f\u3053\u308c\n\ndocker-compose.yml\nversion: '2'\nservices:\n  web:\n    build: ./web\n    ports:\n      - \"8000:80\"\n    links:\n      - redis\n    volumes:\n      - ./app:/home/www/html\n  redis:\n    build: ./redis\n\n\n\u809d\u5fc3\u306eWeb\u30a4\u30e1\u30fc\u30b8\u7528Dockerfile\n\nweb/Dockerfile\nFROM centos:5\n\nRUN yum -y update && yum -y upgrade\nRUN yum -y install wget curl make gcc autoconf \\\n                   libaio libaio-devel libxml2-devel libjpeg-devel libpng-devel curl-devel\n\n# Install apache\nRUN useradd apache\nRUN cd /tmp && \\\n    wget http://ftp.meisei-u.ac.jp/mirror/apache/dist/httpd/httpd-2.2.31.tar.gz && \\\n    tar zxf httpd-2.2.31.tar.gz\nRUN cd /tmp/httpd-2.2.31 && \\\n    ./configure --enable-so && make && make install\nCOPY httpd.conf /usr/local/apache2/conf\n\n# Install oracle client\nCOPY oracle-instantclient11.2-basic-11.2.0.4.0-1.x86_64.rpm /tmp\nCOPY oracle-instantclient11.2-sqlplus-11.2.0.4.0-1.x86_64.rpm /tmp\nCOPY oracle-instantclient11.2-devel-11.2.0.4.0-1.x86_64.rpm /tmp\n\nRUN rpm -ivh /tmp/oracle-instantclient11.2-basic-11.2.0.4.0-1.x86_64.rpm && \\\n    rpm -ivh /tmp/oracle-instantclient11.2-sqlplus-11.2.0.4.0-1.x86_64.rpm && \\\n    rpm -ivh /tmp/oracle-instantclient11.2-devel-11.2.0.4.0-1.x86_64.rpm\n\nENV TNS_ADMIN /\nENV LD_LIBRARY_PATH $LD_LIBRARY_PATH:/usr/lib/oracle/11.2/client64/lib/\nENV NLS_LANG Japanese_Japan.AL32UTF8\nENV NLS_DATE_FORMAT 'YYYY/MM/DD HH24:MI:SS'\n\n# Install PHP\nRUN cd /tmp && \\\n    wget wget http://museum.php.net/php5/php-5.3.6.tar.gz && \\\n    tar xzf php-5.3.6.tar.gz\nRUN cd /tmp/php-5.3.6 && \\\n    ./configure \\\n        --with-apxs2=/usr/local/apache2/bin/apxs \\\n        --with-oci8=instantclient,/usr/lib/oracle/11.2/client64/lib/ \\\n        --enable-libxml \\\n        --enable-xml \\\n        --enable-mbstring \\\n        --enable-zip \\\n        --with-curl \\\n        --with-gd && \\\n    make && make install\n\n# Install apc\nRUN cd /tmp && \\\n    wget https://pecl.php.net/get/APC-3.1.9.tgz && \\\n    tar xzf APC-3.1.9.tgz\nRUN cd /tmp/APC-3.1.9 && \\\n    phpize && \\\n    ./configure && make && make install\n\n# Install redis\nRUN cd /tmp && \\\n    wget https://pecl.php.net/get/redis-2.2.8.tgz && \\\n    tar xzf redis-2.2.8.tgz\nRUN cd /tmp/redis-2.2.8 && \\\n    phpize && \\\n    ./configure && make && make install\n\nCOPY php.ini /usr/local/lib\nCOPY mime.types /etc/mime.types\nCOPY docker-entrypoint.sh /\nRUN mkdir /usr/local/apache2/run\nCMD /docker-entrypoint.sh\n\n\nOracle\u306e\u305b\u3044\u3067\u3001\u884c\u6570\u304c\u8457\u3057\u304f\u5897\u3048\u3066\u3044\u307e\u3059\u3002\napachectl\u3060\u3068\u3001Docker\u304c\u7d42\u4e86\u3057\u3066\u3057\u307e\u3046\u306e\u3067\u3001\u7121\u7406\u3084\u308atail\u3067\u6c38\u7d9a\u7684\u306b\u3057\u3066\u3044\u307e\u3059\u3002\n\napp/docker-entrypoint.sh\n#!/bin/bash\n\n/usr/local/apache2/bin/apachectl start\ntail -f /usr/local/apache2/logs/error_log\n\n\n\n\u8d77\u52d5\ndocker-compose build\ndocker-compose up\n\n2\u56de\u76ee\u4ee5\u964d\u306f\u3001docker-compose up\u3060\u3051\u3067OK\u3067\u3059\u3002\n\u3068\u306b\u304b\u304f\u3053\u308c\u3067\u3001localhost:8000\u306b\u30a2\u30d7\u30ea\u306e\u753b\u9762\u304c\u7acb\u3061\u4e0a\u304c\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3057\u307e\u3057\u305f\u3002\n\u591a\u5206\u3001\u3053\u306e\u8a18\u4e8b\u306f\u8ab0\u306e\u5f79\u306b\u3082\u7acb\u305f\u306a\u3044\u3067\u3059\u3002\n\n\u306a\u305c\u306a\u3089\u30012016\u5e7411\u6708\u73fe\u5728\u3067\u3001\u3053\u3093\u306a\u30ec\u30ac\u30b7\u30fc\u306a\u74b0\u5883\u306f\u5c11\u306a\u3044\u3060\u308d\u3046\u304b\u3089\u3067\u3059\u3002\n\n\u3068\u306f\u3044\u3048\u3001\u8ab0\u304b\u306e\u5f79\u306b\u7acb\u3064\u304b\u3082\u3057\u308c\u306a\u3044\u306e\u3067\u8a18\u8f09\u3057\u3066\u304a\u304d\u307e\u3059\u3002\u3082\u3063\u3068\u3044\u3044\u3084\u308a\u65b9\u304c\u3042\u308c\u3070\u6559\u3048\u3066\u4e0b\u3055\u3044\u3002\n\n\u4e0b\u8a18\u306e\u74b0\u5883\u3092\u69cb\u7bc9\u3057\u307e\u3057\u305f\u3002\n\n- PHP 5.3\n- Oracle\uff08\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u306e\u307f\u300111g)\n- CentOS 5.1\n\nPHP\u62e1\u5f35\u3068\u3057\u3066\u4e0b\u8a18\u3092\u5165\u308c\u3066\u3044\u307e\u3059\u3002\n\n- PHP-Redis\n- APC\n\n\u30d5\u30a1\u30a4\u30eb\u306e\u5168\u4f53\u306f\u3053\u3093\u306a\u611f\u3058\u3002Redis\u306f\u5272\u611b\u3002\n\n```\n.\n|-- docker-compose.yml\n|-- app/\uff08\u4ee5\u4e0b\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\uff09\n`-- web/\n    |-- Dockerfile\n    |-- httpd.conf\n    |-- oracle-instantclient11.2-basic-11.2.0.4.0-1.x86_64.rpm\n    |-- oracle-instantclient11.2-devel-11.2.0.4.0-1.x86_64.rpm\n    |-- oracle-instantclient11.2-sqlplus-11.2.0.4.0-1.x86_64.rpm\n    `-- php.ini\n\n```\n\nDocker compose\u306f\u3053\u308c\n\n```yaml:docker-compose.yml\nversion: '2'\nservices:\n  web:\n    build: ./web\n    ports:\n      - \"8000:80\"\n    links:\n      - redis\n    volumes:\n      - ./app:/home/www/html\n  redis:\n    build: ./redis\n```\n\n\u809d\u5fc3\u306eWeb\u30a4\u30e1\u30fc\u30b8\u7528Dockerfile\n\n```bash:web/Dockerfile\nFROM centos:5\n\nRUN yum -y update && yum -y upgrade\nRUN yum -y install wget curl make gcc autoconf \\\n                   libaio libaio-devel libxml2-devel libjpeg-devel libpng-devel curl-devel\n\n# Install apache\nRUN useradd apache\nRUN cd /tmp && \\\n    wget http://ftp.meisei-u.ac.jp/mirror/apache/dist/httpd/httpd-2.2.31.tar.gz && \\\n    tar zxf httpd-2.2.31.tar.gz\nRUN cd /tmp/httpd-2.2.31 && \\\n    ./configure --enable-so && make && make install\nCOPY httpd.conf /usr/local/apache2/conf\n\n# Install oracle client\nCOPY oracle-instantclient11.2-basic-11.2.0.4.0-1.x86_64.rpm /tmp\nCOPY oracle-instantclient11.2-sqlplus-11.2.0.4.0-1.x86_64.rpm /tmp\nCOPY oracle-instantclient11.2-devel-11.2.0.4.0-1.x86_64.rpm /tmp\n\nRUN rpm -ivh /tmp/oracle-instantclient11.2-basic-11.2.0.4.0-1.x86_64.rpm && \\\n    rpm -ivh /tmp/oracle-instantclient11.2-sqlplus-11.2.0.4.0-1.x86_64.rpm && \\\n    rpm -ivh /tmp/oracle-instantclient11.2-devel-11.2.0.4.0-1.x86_64.rpm\n\nENV TNS_ADMIN /\nENV LD_LIBRARY_PATH $LD_LIBRARY_PATH:/usr/lib/oracle/11.2/client64/lib/\nENV NLS_LANG Japanese_Japan.AL32UTF8\nENV NLS_DATE_FORMAT 'YYYY/MM/DD HH24:MI:SS'\n\n# Install PHP\nRUN cd /tmp && \\\n    wget wget http://museum.php.net/php5/php-5.3.6.tar.gz && \\\n    tar xzf php-5.3.6.tar.gz\nRUN cd /tmp/php-5.3.6 && \\\n    ./configure \\\n        --with-apxs2=/usr/local/apache2/bin/apxs \\\n        --with-oci8=instantclient,/usr/lib/oracle/11.2/client64/lib/ \\\n        --enable-libxml \\\n        --enable-xml \\\n        --enable-mbstring \\\n        --enable-zip \\\n        --with-curl \\\n        --with-gd && \\\n    make && make install\n\n# Install apc\nRUN cd /tmp && \\\n    wget https://pecl.php.net/get/APC-3.1.9.tgz && \\\n    tar xzf APC-3.1.9.tgz\nRUN cd /tmp/APC-3.1.9 && \\\n    phpize && \\\n    ./configure && make && make install\n\n# Install redis\nRUN cd /tmp && \\\n    wget https://pecl.php.net/get/redis-2.2.8.tgz && \\\n    tar xzf redis-2.2.8.tgz\nRUN cd /tmp/redis-2.2.8 && \\\n    phpize && \\\n    ./configure && make && make install\n\nCOPY php.ini /usr/local/lib\nCOPY mime.types /etc/mime.types\nCOPY docker-entrypoint.sh /\nRUN mkdir /usr/local/apache2/run\nCMD /docker-entrypoint.sh\n```\n\nOracle\u306e\u305b\u3044\u3067\u3001\u884c\u6570\u304c\u8457\u3057\u304f\u5897\u3048\u3066\u3044\u307e\u3059\u3002\n\napachectl\u3060\u3068\u3001Docker\u304c\u7d42\u4e86\u3057\u3066\u3057\u307e\u3046\u306e\u3067\u3001\u7121\u7406\u3084\u308a`tail`\u3067\u6c38\u7d9a\u7684\u306b\u3057\u3066\u3044\u307e\u3059\u3002\n\n```bash:app/docker-entrypoint.sh\n#!/bin/bash\n\n/usr/local/apache2/bin/apachectl start\ntail -f /usr/local/apache2/logs/error_log\n```\n\n# \u8d77\u52d5\n\n```bash\ndocker-compose build\ndocker-compose up\n```\n\n2\u56de\u76ee\u4ee5\u964d\u306f\u3001`docker-compose up`\u3060\u3051\u3067OK\u3067\u3059\u3002\n\n\u3068\u306b\u304b\u304f\u3053\u308c\u3067\u3001localhost:8000\u306b\u30a2\u30d7\u30ea\u306e\u753b\u9762\u304c\u7acb\u3061\u4e0a\u304c\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3057\u307e\u3057\u305f\u3002\n", "tags": ["oracle", "PHP", "CentOS"]}