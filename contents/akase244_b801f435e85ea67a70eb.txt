{"tags": ["HTML5", "canvas", "JavaScript"], "context": " More than 1 year has passed since last update.\n\n\u6982\u8aac\n\u300cHTML5\u306ecanvas\u5185\u306b\u8907\u6570\u306e\u753b\u50cf\u3092\u4efb\u610f\u306e\u9806\u5e8f\u3067\u8868\u793a\u3059\u308b\u300d\u3067\u63cf\u753b\u3057\u305fcanvas\u5185\u306e\u753b\u50cf\u3092\u30c9\u30e9\u30c3\u30b0\uff06\u30c9\u30ed\u30c3\u30d7\u3057\u305f\u3044\u6b32\u304c\u6e67\u3044\u305f\u306e\u3067\u3001\u30b3\u30fc\u30c9\u3092\u66f8\u3044\u3066\u307f\u307e\u3057\u305f\u3002\n\u30c9\u30e9\u30c3\u30b0\uff06\u30c9\u30ed\u30c3\u30d7\u306f\u901a\u5e38\u306eDOM\u3067\u3042\u308c\u3070\u3001HTML5\u306eDrag & Drop API\u3092\u5229\u7528\u3059\u308b\u3053\u3068\u3067\u7c21\u5358\u306b\u5bfe\u5fdc\u53ef\u80fd\u3067\u3059\u3002\n\u3057\u304b\u3057\u3001canvas\u306b\u4e00\u5ea6\u63cf\u3044\u3066\u3057\u307e\u3063\u305f\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306f\u3001DOM\u3068\u3057\u3066\u64cd\u4f5c\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u306a\u3044\u305f\u3081\u3001\u5ea7\u6a19\u3092\u8003\u616e\u3057\u305f\u5730\u5473\u306a\u5b9f\u88c5\u304c\u5fc5\u8981\u306b\u306a\u308a\u307e\u3059\u3002\n\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u30b5\u30a4\u30c8\u3092\u53c2\u8003\u306b\u3057\u306a\u304c\u3089\u3001\u753b\u50cf\u306e\u91cd\u306a\u308a\u9806\u3068\u5f53\u305f\u308a\u5224\u5b9a\u3092\u8003\u3048\u3066\u3084\u3063\u3066\u307f\u305f\u3068\u3053\u308d\u3001\u81ea\u5206\u304c\u300c\u3044\u304b\u306b\u5ea7\u6a19\u306b\u5f31\u3044\u304b\u300d\u3068\u3044\u3046\u3053\u3068\u304c\u3088\u304f\u5206\u304b\u308a\u307e\u3057\u305f\u3002\u3002\u3002\n\nA Gentle Introduction to Making HTML5 Canvas Interactive\ndragging and resizing an image on html5 canvas\n\n\u300cKineticJS\u300d\u306a\u3069\u306e\u30e9\u30a4\u30d6\u30e9\u30ea\u3092\u4f7f\u3046\u3053\u3068\u3067\u3001\u3082\u3063\u3068\u7c21\u5358\u306b\u5b9f\u73fe\u3067\u304d\u308b\u3088\u3046\u3067\u3059\u304c\u3001\u4eca\u56de\u306f\u7d20\u306eJavaScript\u3060\u3051\u3067\u5b9f\u88c5\u3059\u308b\u3053\u3068\u3092\u5fc3\u304c\u3051\u3066\u307f\u3066\u307e\u3059\u3002\n\nJavaScript\n<body>\n<canvas id=\"canvas\" width=\"600\" height=\"400\"></canvas>\n<script>\n(function() {\n    var canvas  = document.getElementById('canvas');\n    var context = canvas.getContext('2d');\n    var isDragging = false;\n    var dragTarget = null; // \u30c9\u30e9\u30c3\u30b0\u5bfe\u8c61\u306e\u753b\u50cf\u306e\u6dfb\u3048\u5b57\n\n    var srcs = [\n        '1.png',\n        '2.png',\n        '3.png',\n        '4.png',\n    ];\n    var images = [];\n    for (var i in srcs) {\n        images[i] = new Image();\n        images[i].src = srcs[i];\n    }\n\n    var loadedCount = 0;\n    for (var i in images) {\n        images[i].addEventListener('load', function() {\n            if (++loadedCount == images.length) {\n                var x = 0;\n                var y = 0;\n                var w = 150;\n                var h = 100;\n                for (var j in images) {\n                    // \u753b\u50cf\u3092\u63cf\u753b\u3057\u305f\u6642\u306e\u60c5\u5831\u3092\u8a18\u61b6\uff08Image\u306e\u30d7\u30ed\u30d1\u30c6\u30a3\u306b\u7a81\u3063\u8fbc\u3080\u306e\u306f\u3061\u3087\u3063\u3068\u53cd\u5247\u304b\u3082\u3060\u3051\u3069\uff09\n                    images[j].drawOffsetX = x;\n                    images[j].drawOffsetY = y;\n                    images[j].drawWidth   = w;\n                    images[j].drawHeight  = h;\n\n                    // \u753b\u50cf\u3092\u63cf\u753b\n                    context.drawImage(images[j], x, y, w, h);\n                    x += 50;\n                    y += 70;\n                }\n            }\n        }, false);\n    }\n\n    // \u30c9\u30e9\u30c3\u30b0\u958b\u59cb\n    var mouseDown = function(e) {\n        // \u30c9\u30e9\u30c3\u30b0\u958b\u59cb\u4f4d\u7f6e\n        var posX = parseInt(e.clientX - canvas.offsetLeft);\n        var posY = parseInt(e.clientY - canvas.offsetTop);\n\n        for (var i = images.length - 1; i >= 0; i--) {\n            // \u5f53\u305f\u308a\u5224\u5b9a\uff08\u30c9\u30e9\u30c3\u30b0\u3057\u305f\u4f4d\u7f6e\u304c\u753b\u50cf\u306e\u7bc4\u56f2\u5185\u306b\u53ce\u307e\u3063\u3066\u3044\u308b\u304b\uff09\n            if (posX >= images[i].drawOffsetX &&\n                posX <= (images[i].drawOffsetX + images[i].drawWidth) &&\n                posY >= images[i].drawOffsetY &&\n                posY <= (images[i].drawOffsetY + images[i].drawHeight)\n            ) {\n              dragTarget = i;\n              isDragging = true;\n              break;\n            }\n        }\n    }\n\n    // \u30c9\u30e9\u30c3\u30b0\u7d42\u4e86\n    var mouseUp = function(e) {\n        isDragging = false;\n    };\n\n    // canvas\u306e\u67a0\u304b\u3089\u5916\u308c\u305f\n    var mouseOut = function(e) {\n        // canvas\u5916\u306b\u30de\u30a6\u30b9\u30ab\u30fc\u30bd\u30eb\u304c\u79fb\u52d5\u3057\u305f\u5834\u5408\u306b\u3001\u30c9\u30e9\u30c3\u30b0\u7d42\u4e86\u3068\u3057\u305f\u3044\u5834\u5408\u306f\u30b3\u30e1\u30f3\u30c8\u30a4\u30f3\u3059\u308b\n        // mouseUp(e);\n    }\n\n    // \u30c9\u30e9\u30c3\u30b0\u4e2d\n    var mouseMove = function(e) {\n        // \u30c9\u30e9\u30c3\u30b0\u7d42\u4e86\u4f4d\u7f6e\n        var posX = parseInt(e.clientX - canvas.offsetLeft);\n        var posY = parseInt(e.clientY - canvas.offsetTop);\n\n        if (isDragging) {\n            // canvas\u5185\u3092\u4e00\u65e6\u30af\u30ea\u30a2\n            context.clearRect(0, 0, canvas.width, canvas.height);\n\n            var x = 0;\n            var y = 0;\n            var w = 150;\n            var h = 100;\n            for (var i in images) {\n                if (i == dragTarget) {\n                    x = posX - images[i].drawWidth / 2;\n                    y = posY - images[i].drawHeight / 2;\n\n                    // \u30c9\u30e9\u30c3\u30b0\u304c\u7d42\u4e86\u3057\u305f\u6642\u306e\u60c5\u5831\u3092\u8a18\u61b6\n                    images[i].drawOffsetX = x;\n                    images[i].drawOffsetY = y;\n                } else {\n                    x = images[i].drawOffsetX;\n                    y = images[i].drawOffsetY;\n                }\n                w = images[i].drawWidth;\n                h = images[i].drawHeight;\n\n                // \u753b\u50cf\u3092\u63cf\u753b\n                context.drawImage(images[i], x, y, w, h);\n            }\n        }\n    };\n\n    // canvas\u306b\u30a4\u30d9\u30f3\u30c8\u767b\u9332\n    canvas.addEventListener('mousedown', function(e){mouseDown(e);}, false);\n    canvas.addEventListener('mousemove', function(e){mouseMove(e);}, false);\n    canvas.addEventListener('mouseup',   function(e){mouseUp(e);},   false);\n    canvas.addEventListener('mouseout',  function(e){mouseOut(e);},  false);\n})();\n</script>\n</body>\n\n\n\n\n\u3053\u306e\u3088\u3046\u306bcanvas\u5185\u306b\u4e26\u3093\u3067\u3044\u308b\u753b\u50cf\u304c\u3002\u3002\u3002\u3002\n\n\n\n\u91cd\u306a\u308a\u9806\u3092\u7dad\u6301\u3057\u305f\u72b6\u614b\u3067\u30c9\u30e9\u30c3\u30b0\uff06\u30c9\u30ed\u30c3\u30d7\u304c\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3057\u305f\u3002\n\n\n## \u6982\u8aac\n\u300c[HTML5\u306ecanvas\u5185\u306b\u8907\u6570\u306e\u753b\u50cf\u3092\u4efb\u610f\u306e\u9806\u5e8f\u3067\u8868\u793a\u3059\u308b](http://qiita.com/akase244/items/9f3c60219f903254a6e2)\u300d\u3067\u63cf\u753b\u3057\u305fcanvas\u5185\u306e\u753b\u50cf\u3092\u30c9\u30e9\u30c3\u30b0\uff06\u30c9\u30ed\u30c3\u30d7\u3057\u305f\u3044\u6b32\u304c\u6e67\u3044\u305f\u306e\u3067\u3001\u30b3\u30fc\u30c9\u3092\u66f8\u3044\u3066\u307f\u307e\u3057\u305f\u3002\n\n\u30c9\u30e9\u30c3\u30b0\uff06\u30c9\u30ed\u30c3\u30d7\u306f\u901a\u5e38\u306eDOM\u3067\u3042\u308c\u3070\u3001HTML5\u306eDrag & Drop API\u3092\u5229\u7528\u3059\u308b\u3053\u3068\u3067\u7c21\u5358\u306b\u5bfe\u5fdc\u53ef\u80fd\u3067\u3059\u3002\n\u3057\u304b\u3057\u3001canvas\u306b\u4e00\u5ea6\u63cf\u3044\u3066\u3057\u307e\u3063\u305f\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306f\u3001DOM\u3068\u3057\u3066\u64cd\u4f5c\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u306a\u3044\u305f\u3081\u3001\u5ea7\u6a19\u3092\u8003\u616e\u3057\u305f\u5730\u5473\u306a\u5b9f\u88c5\u304c\u5fc5\u8981\u306b\u306a\u308a\u307e\u3059\u3002\n\n\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u30b5\u30a4\u30c8\u3092\u53c2\u8003\u306b\u3057\u306a\u304c\u3089\u3001\u753b\u50cf\u306e\u91cd\u306a\u308a\u9806\u3068\u5f53\u305f\u308a\u5224\u5b9a\u3092\u8003\u3048\u3066\u3084\u3063\u3066\u307f\u305f\u3068\u3053\u308d\u3001\u81ea\u5206\u304c\u300c\u3044\u304b\u306b\u5ea7\u6a19\u306b\u5f31\u3044\u304b\u300d\u3068\u3044\u3046\u3053\u3068\u304c\u3088\u304f\u5206\u304b\u308a\u307e\u3057\u305f\u3002\u3002\u3002\n\n - [A Gentle Introduction to Making HTML5 Canvas Interactive](http://simonsarris.com/blog/510-making-html5-canvas-useful)\n - [dragging and resizing an image on html5 canvas](http://stackoverflow.com/questions/19100009/dragging-and-resizing-an-image-on-html5-canvas)\n\n\u300c[KineticJS](http://kineticjs.com/)\u300d\u306a\u3069\u306e\u30e9\u30a4\u30d6\u30e9\u30ea\u3092\u4f7f\u3046\u3053\u3068\u3067\u3001\u3082\u3063\u3068\u7c21\u5358\u306b\u5b9f\u73fe\u3067\u304d\u308b\u3088\u3046\u3067\u3059\u304c\u3001\u4eca\u56de\u306f\u7d20\u306eJavaScript\u3060\u3051\u3067\u5b9f\u88c5\u3059\u308b\u3053\u3068\u3092\u5fc3\u304c\u3051\u3066\u307f\u3066\u307e\u3059\u3002\n\n```js:JavaScript\n<body>\n<canvas id=\"canvas\" width=\"600\" height=\"400\"></canvas>\n<script>\n(function() {\n    var canvas  = document.getElementById('canvas');\n    var context = canvas.getContext('2d');\n    var isDragging = false;\n    var dragTarget = null; // \u30c9\u30e9\u30c3\u30b0\u5bfe\u8c61\u306e\u753b\u50cf\u306e\u6dfb\u3048\u5b57\n\n    var srcs = [\n        '1.png',\n        '2.png',\n        '3.png',\n        '4.png',\n    ];\n    var images = [];\n    for (var i in srcs) {\n        images[i] = new Image();\n        images[i].src = srcs[i];\n    }\n\n    var loadedCount = 0;\n    for (var i in images) {\n        images[i].addEventListener('load', function() {\n            if (++loadedCount == images.length) {\n                var x = 0;\n                var y = 0;\n                var w = 150;\n                var h = 100;\n                for (var j in images) {\n                    // \u753b\u50cf\u3092\u63cf\u753b\u3057\u305f\u6642\u306e\u60c5\u5831\u3092\u8a18\u61b6\uff08Image\u306e\u30d7\u30ed\u30d1\u30c6\u30a3\u306b\u7a81\u3063\u8fbc\u3080\u306e\u306f\u3061\u3087\u3063\u3068\u53cd\u5247\u304b\u3082\u3060\u3051\u3069\uff09\n                    images[j].drawOffsetX = x;\n                    images[j].drawOffsetY = y;\n                    images[j].drawWidth   = w;\n                    images[j].drawHeight  = h;\n\n                    // \u753b\u50cf\u3092\u63cf\u753b\n                    context.drawImage(images[j], x, y, w, h);\n                    x += 50;\n                    y += 70;\n                }\n            }\n        }, false);\n    }\n\n    // \u30c9\u30e9\u30c3\u30b0\u958b\u59cb\n    var mouseDown = function(e) {\n        // \u30c9\u30e9\u30c3\u30b0\u958b\u59cb\u4f4d\u7f6e\n        var posX = parseInt(e.clientX - canvas.offsetLeft);\n        var posY = parseInt(e.clientY - canvas.offsetTop);\n\n        for (var i = images.length - 1; i >= 0; i--) {\n            // \u5f53\u305f\u308a\u5224\u5b9a\uff08\u30c9\u30e9\u30c3\u30b0\u3057\u305f\u4f4d\u7f6e\u304c\u753b\u50cf\u306e\u7bc4\u56f2\u5185\u306b\u53ce\u307e\u3063\u3066\u3044\u308b\u304b\uff09\n            if (posX >= images[i].drawOffsetX &&\n                posX <= (images[i].drawOffsetX + images[i].drawWidth) &&\n                posY >= images[i].drawOffsetY &&\n                posY <= (images[i].drawOffsetY + images[i].drawHeight)\n            ) {\n              dragTarget = i;\n              isDragging = true;\n              break;\n            }\n        }\n    }\n\n    // \u30c9\u30e9\u30c3\u30b0\u7d42\u4e86\n    var mouseUp = function(e) {\n        isDragging = false;\n    };\n\n    // canvas\u306e\u67a0\u304b\u3089\u5916\u308c\u305f\n    var mouseOut = function(e) {\n        // canvas\u5916\u306b\u30de\u30a6\u30b9\u30ab\u30fc\u30bd\u30eb\u304c\u79fb\u52d5\u3057\u305f\u5834\u5408\u306b\u3001\u30c9\u30e9\u30c3\u30b0\u7d42\u4e86\u3068\u3057\u305f\u3044\u5834\u5408\u306f\u30b3\u30e1\u30f3\u30c8\u30a4\u30f3\u3059\u308b\n        // mouseUp(e);\n    }\n\n    // \u30c9\u30e9\u30c3\u30b0\u4e2d\n    var mouseMove = function(e) {\n        // \u30c9\u30e9\u30c3\u30b0\u7d42\u4e86\u4f4d\u7f6e\n        var posX = parseInt(e.clientX - canvas.offsetLeft);\n        var posY = parseInt(e.clientY - canvas.offsetTop);\n\n        if (isDragging) {\n            // canvas\u5185\u3092\u4e00\u65e6\u30af\u30ea\u30a2\n            context.clearRect(0, 0, canvas.width, canvas.height);\n\n            var x = 0;\n            var y = 0;\n            var w = 150;\n            var h = 100;\n            for (var i in images) {\n                if (i == dragTarget) {\n                    x = posX - images[i].drawWidth / 2;\n                    y = posY - images[i].drawHeight / 2;\n\n                    // \u30c9\u30e9\u30c3\u30b0\u304c\u7d42\u4e86\u3057\u305f\u6642\u306e\u60c5\u5831\u3092\u8a18\u61b6\n                    images[i].drawOffsetX = x;\n                    images[i].drawOffsetY = y;\n                } else {\n                    x = images[i].drawOffsetX;\n                    y = images[i].drawOffsetY;\n                }\n                w = images[i].drawWidth;\n                h = images[i].drawHeight;\n\n                // \u753b\u50cf\u3092\u63cf\u753b\n                context.drawImage(images[i], x, y, w, h);\n            }\n        }\n    };\n\n    // canvas\u306b\u30a4\u30d9\u30f3\u30c8\u767b\u9332\n    canvas.addEventListener('mousedown', function(e){mouseDown(e);}, false);\n    canvas.addEventListener('mousemove', function(e){mouseMove(e);}, false);\n    canvas.addEventListener('mouseup',   function(e){mouseUp(e);},   false);\n    canvas.addEventListener('mouseout',  function(e){mouseOut(e);},  false);\n})();\n</script>\n</body>\n```\n\n---\n\n#### \u3053\u306e\u3088\u3046\u306bcanvas\u5185\u306b\u4e26\u3093\u3067\u3044\u308b\u753b\u50cf\u304c\u3002\u3002\u3002\u3002\n![\u30c9\u30e9\u30c3\u30b0\uff06\u30c9\u30ed\u30c3\u30d7\u524d](https://qiita-image-store.s3.amazonaws.com/0/23093/0755c559-aab0-c8b5-4c9f-f9134add0ae3.png)\n\n---\n\n#### \u91cd\u306a\u308a\u9806\u3092\u7dad\u6301\u3057\u305f\u72b6\u614b\u3067\u30c9\u30e9\u30c3\u30b0\uff06\u30c9\u30ed\u30c3\u30d7\u304c\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3057\u305f\u3002\n![\u30c9\u30e9\u30c3\u30b0\uff06\u30c9\u30ed\u30c3\u30d7\u524d](https://qiita-image-store.s3.amazonaws.com/0/23093/6f9cecfa-efcd-8d3b-7fc2-ce085adbd0a7.png)\n"}