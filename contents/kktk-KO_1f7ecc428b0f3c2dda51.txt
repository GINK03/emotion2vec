{"context": "http://qiita.com/shunsugai@github/items/971a15461de29563bf90\n\u4e57\u308a\u9045\u308c\u305f\u3002\nzundoko[x_, y_, z_] := Append[#,z]&@NestWhile[Append[#,RandomChoice@{x,y}]&,{},!MatchQ[#,{___,Repeated[x,{4}],y}]&];\nIn[] = zundoko[\u30ba\u30f3\",\"\u30c9\u30b3\",\"\u30ad\u30fb\u30e8\u30fb\u30b7!\"]\nOut[] = {\"\u30c9\u30b3\", \"\u30ba\u30f3\", \"\u30ba\u30f3\", \"\u30c9\u30b3\", \"\u30c9\u30b3\", \"\u30c9\u30b3\", \"\u30ba\u30f3\", \"\u30c9\u30b3\", \"\u30c9\u30b3\", \"\u30ba\u30f3\", \"\u30c9\u30b3\", \n\"\u30c9\u30b3\", \"\u30ba\u30f3\", \"\u30ba\u30f3\", \"\u30ba\u30f3\", \"\u30c9\u30b3\", \"\u30c9\u30b3\", \"\u30c9\u30b3\", \"\u30ba\u30f3\", \"\u30c9\u30b3\", \"\u30ba\u30f3\", \"\u30c9\u30b3\", \n\"\u30ba\u30f3\", \"\u30c9\u30b3\", \"\u30c9\u30b3\", \"\u30c9\u30b3\", \"\u30ba\u30f3\", \"\u30c9\u30b3\", \"\u30c9\u30b3\", \"\u30ba\u30f3\", \"\u30c9\u30b3\", \"\u30ba\u30f3\", \"\u30ba\u30f3\", \n\"\u30ba\u30f3\", \"\u30ba\u30f3\", \"\u30c9\u30b3\", \"\u30ad\u30fb\u30e8\u30fb\u30b7!\"}\n\n\n\u30ba\u30f3\u30c9\u30b3\u904e\u7a0b\u306e\u6570\u7406\n\u6700\u5f8c\u306e\u30ad\u30e8\u30b7\u3092\u9664\u3044\u3066\u3001\u30ba\u30f3\u30c9\u30b3\u904e\u7a0b\u3067\u5f97\u3089\u308c\u308b\u914d\u5217\u306f{...,\"\u30ba\u30f3\",\"\u30ba\u30f3\",\"\u30ba\u30f3\",\"\u30ba\u30f3\",\"\u30c9\u30b3\"}\u3002\n\u3053\u306e\u914d\u5217\u306e\u9577\u3055\u304cnnn\u3067\u3042\u308b\u78ba\u7387\u3092PnPnP_n\u3068\u3059\u308b\u3002\n\u6700\u521d\u306e\"\u30c9\u30b3\"\u304c(1|2|3|4)\u756a\u76ee\u306b\u73fe\u308c\u308b\u9577\u3055nnn\u3067\u904e\u7a0b\u304c\u7d42\u308f\u308b\u78ba\u7387\u3092AnAnA_n,BnBnB_n,CnCnC_n,DnDnD_n\u3068\u3059\u308b\u3002\n\u30c9\u30b3\u304c1\u5ea6\u3060\u3051\u3057\u304b\u73fe\u308c\u305a\u306b\u3001\u9577\u3055nnn\u3067\u904e\u7a0b\u304c\u7d42\u308f\u308b\u78ba\u7387\u3092OnOnO_n\u3068\u3059\u308b\u3002\n(\u6ce8: \u4ee5\u524d\u306e\u7248\u3067\u306fOnOnO_n\u3092\u5fd8\u308c\u3066\u3044\u305f\u3002\u6065\u305a\u304b\u3057\u3044\u3002)\nPn=On+An+Bn+Cn+DnPn=On+An+Bn+Cn+DnP_n = O_n + A_n + B_n + C_n + D_n\nOn=2\u2212nOn=2\u2212nO_n = 2^{-n}\nAn=12(On\u22121+An\u22121+Bn\u22121+Cn\u22121+Dn\u22121)=12Pn\u22121An=12(On\u22121+An\u22121+Bn\u22121+Cn\u22121+Dn\u22121)=12Pn\u22121A_n = \\frac{1}{2}(O_{n - 1} + A_{n - 1} + B_{n - 1} + C_{n - 1} + D_{n - 1}) = \\frac{1}{2}P_{n - 1}\nBn=12An\u22121Bn=12An\u22121B_n = \\frac{1}{2}A_{n - 1}\nCn=12Bn\u22121Cn=12Bn\u22121C_n = \\frac{1}{2}B_{n - 1}\nDn=12Cn\u22121Dn=12Cn\u22121D_n = \\frac{1}{2}C_{n - 1}\n\u3068\u3044\u3046\u30de\u30b9\u30bf\u30fc\u65b9\u7a0b\u5f0f\u304c\u7acb\u3064\u3002\n\u3042\u3068\u306f\u3053\u308c\u3092\u6574\u7406\u3059\u308c\u3070Pn=Pn\u22121\u2212132Pn\u22125Pn=Pn\u22121\u2212132Pn\u22125P_n = P_{n - 1} - \\frac{1}{32} P_{n - 5}\u3068\u306a\u308a\u3001P1=P2=P3=P4=0,P5=132P1=P2=P3=P4=0,P5=132P_1 = P_2 = P_3 = P_4 = 0, P_5 = \\frac{1}{32}\u306e\u5883\u754c\u6761\u4ef6\u3067\u306e\u89e3\u306f\nPn=\u03b1n1\u03b21+\u03b1n2\u03b22+\u03b1n3\u03b23+\u03b1n4\u03b24\u221213\u22c52nPn=\u03b1n1\u03b21+\u03b1n2\u03b22+\u03b1n3\u03b23+\u03b1n4\u03b24\u221213\u22c52nP_n = \\alpha_1^n\\beta_1+\\alpha_2^n\\beta_2+\\alpha_3^n\\beta_3+\\alpha_4^n\\beta_4 - \\frac{1}{3 \\cdot 2^n}\n\u3068\u306a\u308b\u3002\n\u03b1i\u03b1i\\alpha_i\u306f16x4\u22128x3\u22124x2\u22122x\u2212116x4\u22128x3\u22124x2\u22122x\u2212116 x^4 - 8 x^3 - 4 x^2 -2x - 1\u306e\u6839\u3067\n\u03b11\u2248\u22120.387\u03b11\u2248\u22120.387\\alpha_1 \\approx -0.387\n\u03b12\u22480.964\u03b12\u22480.964\\alpha_2 \\approx 0.964\n\u03b13\u2248\u22120.0382\u22120.408i\u03b13\u2248\u22120.0382\u22120.408i\\alpha_3 \\approx -0.0382 - 0.408 i\n\u03b14\u2248\u22120.0382+0.408i\u03b14\u2248\u22120.0382+0.408i\\alpha_4 \\approx -0.0382 + 0.408 i\n\u03b2i\u03b2i\\beta_i\u306f1689x4+1126x3+232x2+10x\u221211689x4+1126x3+232x2+10x\u221211689 x^4 + 1126 x^3 + 232 x^2 + 10 x - 1\u306e\u6839\u3067\n\u03b21\u2248\u22120.234\u03b21\u2248\u22120.234\\beta_1 \\approx -0.234\n\u03b22\u22480.044\u03b22\u22480.044\\beta_2 \\approx 0.044\n\u03b23\u2248\u22120.239\u22120.019i\u03b23\u2248\u22120.239\u22120.019i\\beta_3 \\approx -0.239 - 0.019 i\n\u03b24\u2248\u22120.239+0.019i\u03b24\u2248\u22120.239+0.019i\\beta_4 \\approx -0.239 + 0.019 i\n\u5b9f\u969b\u3001\u30b5\u30f3\u30d7\u30ea\u30f3\u30b0\u3057\u3066PnPnP_n\u3092\u63a8\u5b9a\u3059\u308b\u3068\u3088\u304f\u4e00\u81f4\u3059\u308b\u3002\n\n\n\u30ba\u30f3\u30c9\u30b3\u904e\u7a0b\u306e\u6f38\u8fd1\u5f62\nn\u2192\u221en\u2192\u221en \\rightarrow \\infty\u3067\u306ePnPnP_n\u306e\u6f38\u8fd1\u5f62\u306fPn\u2248\u03b1n2\u03b22Pn\u2248\u03b1n2\u03b22P_n \\approx \\alpha_2^n \\beta_2\n\u03b12\u03b12\\alpha_2\u306f0.9637809877...0.9637809877...0.9637809877...\u3068111\u306b\u8fd1\u304f\u3001\u975e\u5e38\u306b\u53ce\u675f\u304c\u9045\u3044\u3002\n\u307e\u305f\u3001\u03b11\u03b11\\alpha_1\u306e\u6e1b\u8870\u30e2\u30fc\u30c9\u3082\u308f\u308a\u3068\u9045\u3044\u3002\n\u8aa4\u3063\u3066\u5c0e\u304d\u304c\u3061\u306a\u507d\u306e\u6f38\u8fd1\u5f62(1\u22122\u22125)n=(31/32)n(1\u22122\u22125)n=(31/32)n(1-2^{-5})^n = (31/32)^n\u3092\u3001\u30b5\u30f3\u30d7\u30ea\u30f3\u30b0\u306b\u57fa\u3065\u3044\u3066\u68c4\u5374\u3057\u3088\u3046\u3068\u3059\u308b\u3068\u3001\u304b\u306a\u308a\u306e\u6570\u306e\u30b5\u30f3\u30d7\u30ea\u30f3\u30b0\u304c\u5fc5\u8981\u306b\u306a\u308b\u3002\n\n\u30ba\u30f3\u30c9\u30b3\u904e\u7a0b\u306e\u5e73\u5747\u9577\u3068\u5206\u6563\na0=12a_0 = \\frac{1}{2}, b0=\u221213b_0 = -\\frac{1}{3}\u3068\u3059\u308b\u3068\u3001Pn=\u22115i=0anibiP_n = \\sum_{i = 0}^{5} a_i^n b_i\n\u30ba\u30f3\u30c9\u30b3\u904e\u7a0b\u306e\u5e73\u5747\u9577\u306f\nE[n]=\u2211\u221en=1nPn=\u22115i=0aibi(1\u2212ai)2=31.98354688...E[n] = \\sum_{n = 1}^{\\infty} n P_n = \\sum_{i = 0}^{5} \\frac{a_i b_i}{(1 - a_i)^2} = 31.98354688...\n\u30ba\u30f3\u30c9\u30b3\u904e\u7a0b\u306e\u9577\u3055\u306e\u5206\u6563\u306f\nE[n2]=\u2211\u221en=1n2Pn=\u22115i=0ai(ai+1)bi(1\u2212ai)3E[n^2] = \\sum_{n = 1}^{\\infty} n^2 P_n = \\sum_{i = 0}^{5} \\frac{a_i(a_i + 1) b_i}{(1 - a_i)^3}\nE[n2]\u2212(E[n])2=737.0537700...E[n^2]-(E[n])^2 = 737.0537700...\nhttp://qiita.com/shunsugai@github/items/971a15461de29563bf90\n\n\u4e57\u308a\u9045\u308c\u305f\u3002\n\n```\nzundoko[x_, y_, z_] := Append[#,z]&@NestWhile[Append[#,RandomChoice@{x,y}]&,{},!MatchQ[#,{___,Repeated[x,{4}],y}]&];\nIn[] = zundoko[\u30ba\u30f3\",\"\u30c9\u30b3\",\"\u30ad\u30fb\u30e8\u30fb\u30b7!\"]\nOut[] = {\"\u30c9\u30b3\", \"\u30ba\u30f3\", \"\u30ba\u30f3\", \"\u30c9\u30b3\", \"\u30c9\u30b3\", \"\u30c9\u30b3\", \"\u30ba\u30f3\", \"\u30c9\u30b3\", \"\u30c9\u30b3\", \"\u30ba\u30f3\", \"\u30c9\u30b3\", \n\"\u30c9\u30b3\", \"\u30ba\u30f3\", \"\u30ba\u30f3\", \"\u30ba\u30f3\", \"\u30c9\u30b3\", \"\u30c9\u30b3\", \"\u30c9\u30b3\", \"\u30ba\u30f3\", \"\u30c9\u30b3\", \"\u30ba\u30f3\", \"\u30c9\u30b3\", \n\"\u30ba\u30f3\", \"\u30c9\u30b3\", \"\u30c9\u30b3\", \"\u30c9\u30b3\", \"\u30ba\u30f3\", \"\u30c9\u30b3\", \"\u30c9\u30b3\", \"\u30ba\u30f3\", \"\u30c9\u30b3\", \"\u30ba\u30f3\", \"\u30ba\u30f3\", \n\"\u30ba\u30f3\", \"\u30ba\u30f3\", \"\u30c9\u30b3\", \"\u30ad\u30fb\u30e8\u30fb\u30b7!\"}\n```\n\n# \u30ba\u30f3\u30c9\u30b3\u904e\u7a0b\u306e\u6570\u7406\n\n\u6700\u5f8c\u306e\u30ad\u30e8\u30b7\u3092\u9664\u3044\u3066\u3001\u30ba\u30f3\u30c9\u30b3\u904e\u7a0b\u3067\u5f97\u3089\u308c\u308b\u914d\u5217\u306f`{...,\"\u30ba\u30f3\",\"\u30ba\u30f3\",\"\u30ba\u30f3\",\"\u30ba\u30f3\",\"\u30c9\u30b3\"}`\u3002\n\u3053\u306e\u914d\u5217\u306e\u9577\u3055\u304c$n$\u3067\u3042\u308b\u78ba\u7387\u3092$P_n$\u3068\u3059\u308b\u3002\n\u6700\u521d\u306e\"\u30c9\u30b3\"\u304c(1|2|3|4)\u756a\u76ee\u306b\u73fe\u308c\u308b\u9577\u3055$n$\u3067\u904e\u7a0b\u304c\u7d42\u308f\u308b\u78ba\u7387\u3092$A_n$,$B_n$,$C_n$,$D_n$\u3068\u3059\u308b\u3002\n\u30c9\u30b3\u304c1\u5ea6\u3060\u3051\u3057\u304b\u73fe\u308c\u305a\u306b\u3001\u9577\u3055$n$\u3067\u904e\u7a0b\u304c\u7d42\u308f\u308b\u78ba\u7387\u3092$O_n$\u3068\u3059\u308b\u3002\n\n(\u6ce8: \u4ee5\u524d\u306e\u7248\u3067\u306f$O_n$\u3092\u5fd8\u308c\u3066\u3044\u305f\u3002\u6065\u305a\u304b\u3057\u3044\u3002)\n\n$P_n = O_n + A_n + B_n + C_n + D_n$\n$O_n = 2^{-n}$\n$A_n = \\frac{1}{2}(O_{n - 1} + A_{n - 1} + B_{n - 1} + C_{n - 1} + D_{n - 1}) = \\frac{1}{2}P_{n - 1}$\n$B_n = \\frac{1}{2}A_{n - 1}$\n$C_n = \\frac{1}{2}B_{n - 1}$\n$D_n = \\frac{1}{2}C_{n - 1}$\n\u3068\u3044\u3046\u30de\u30b9\u30bf\u30fc\u65b9\u7a0b\u5f0f\u304c\u7acb\u3064\u3002\n\u3042\u3068\u306f\u3053\u308c\u3092\u6574\u7406\u3059\u308c\u3070$P_n = P_{n - 1} - \\frac{1}{32} P_{n - 5}$\u3068\u306a\u308a\u3001$P_1 = P_2 = P_3 = P_4 = 0, P_5 = \\frac{1}{32}$\u306e\u5883\u754c\u6761\u4ef6\u3067\u306e\u89e3\u306f\n$P_n = \\alpha_1^n\\beta_1+\\alpha_2^n\\beta_2+\\alpha_3^n\\beta_3+\\alpha_4^n\\beta_4 - \\frac{1}{3 \\cdot 2^n}$\n\u3068\u306a\u308b\u3002\n\n$\\alpha_i$\u306f$16 x^4 - 8 x^3 - 4 x^2 -2x - 1$\u306e\u6839\u3067\n$\\alpha_1 \\approx -0.387$\n$\\alpha_2 \\approx 0.964$\n$\\alpha_3 \\approx -0.0382 - 0.408 i$\n$\\alpha_4 \\approx -0.0382 + 0.408 i$\n\n$\\beta_i$\u306f$1689 x^4 + 1126 x^3 + 232 x^2 + 10 x - 1$\u306e\u6839\u3067\n$\\beta_1 \\approx -0.234$\n$\\beta_2 \\approx 0.044$\n$\\beta_3 \\approx -0.239 - 0.019 i$\n$\\beta_4 \\approx -0.239 + 0.019 i$\n\n\u5b9f\u969b\u3001\u30b5\u30f3\u30d7\u30ea\u30f3\u30b0\u3057\u3066$P_n$\u3092\u63a8\u5b9a\u3059\u308b\u3068\u3088\u304f\u4e00\u81f4\u3059\u308b\u3002\n\n![\u7121\u984c.png](https://qiita-image-store.s3.amazonaws.com/0/46436/0898cff2-743a-8149-c24b-a4093d63e4bd.png)\n\n## \u30ba\u30f3\u30c9\u30b3\u904e\u7a0b\u306e\u6f38\u8fd1\u5f62\n\n$n \\rightarrow \\infty$\u3067\u306e$P_n$\u306e\u6f38\u8fd1\u5f62\u306f$P_n \\approx \\alpha_2^n \\beta_2$\n\n$\\alpha_2$\u306f$0.9637809877...$\u3068$1$\u306b\u8fd1\u304f\u3001\u975e\u5e38\u306b\u53ce\u675f\u304c\u9045\u3044\u3002\n\u307e\u305f\u3001$\\alpha_1$\u306e\u6e1b\u8870\u30e2\u30fc\u30c9\u3082\u308f\u308a\u3068\u9045\u3044\u3002\n\u8aa4\u3063\u3066\u5c0e\u304d\u304c\u3061\u306a\u507d\u306e\u6f38\u8fd1\u5f62$(1-2^{-5})^n = (31/32)^n$\u3092\u3001\u30b5\u30f3\u30d7\u30ea\u30f3\u30b0\u306b\u57fa\u3065\u3044\u3066\u68c4\u5374\u3057\u3088\u3046\u3068\u3059\u308b\u3068\u3001\u304b\u306a\u308a\u306e\u6570\u306e\u30b5\u30f3\u30d7\u30ea\u30f3\u30b0\u304c\u5fc5\u8981\u306b\u306a\u308b\u3002\n\n## \u30ba\u30f3\u30c9\u30b3\u904e\u7a0b\u306e\u5e73\u5747\u9577\u3068\u5206\u6563\n\n$a_0 = \\frac{1}{2}$, $b_0 = -\\frac{1}{3}$\u3068\u3059\u308b\u3068\u3001$P_n = \\sum_{i = 0}^{5} a_i^n b_i$\n\n\u30ba\u30f3\u30c9\u30b3\u904e\u7a0b\u306e\u5e73\u5747\u9577\u306f\n\n$E[n] = \\sum_{n = 1}^{\\infty} n P_n = \\sum_{i = 0}^{5} \\frac{a_i b_i}{(1 - a_i)^2} = 31.98354688...$\n\n\u30ba\u30f3\u30c9\u30b3\u904e\u7a0b\u306e\u9577\u3055\u306e\u5206\u6563\u306f\n\n$E[n^2] = \\sum_{n = 1}^{\\infty} n^2 P_n = \\sum_{i = 0}^{5} \\frac{a_i(a_i + 1) b_i}{(1 - a_i)^3}$\n$E[n^2]-(E[n])^2 = 737.0537700...$\n", "tags": ["Mathematica", "\u30ba\u30f3\u30c9\u30b3\u30ad\u30e8\u30b7"]}