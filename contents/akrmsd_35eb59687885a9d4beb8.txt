{"context": "\n\n\u306f\u3058\u3081\u306b\nWeb\u30d6\u30e9\u30a6\u30b6\u306b\u5165\u529b\u3059\u308b\u4f5c\u696d\u3092\u81ea\u52d5\u5316\u3057\u305f\u3044\uff01\uff01\n\u3067\u3082\u3001\u7aef\u672b\u306bSeleniumDriver\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3067\u304d\u306a\u3044\u3002\n\u3068\u3044\u3046\u74b0\u5883\u3067\u3001PowerShell\u3092\u5229\u7528\u3057\u3066\u81ea\u52d5\u5316\u3092\u5b9f\u73fe\u3057\u307e\u3057\u305f\u3002\n\n\u3084\u308a\u305f\u3044\u3053\u3068\n\n\u6240\u5b9a\u306eWeb\u30b5\u30a4\u30c8\u3092\u958b\u304f\u3002\nID\u3068\u30d1\u30b9\u30ef\u30fc\u30c9\u3092\u5165\u529b\u3059\u308b\u3002\n\u30dc\u30bf\u30f3\u3092\u62bc\u3059\u3002\n\n\n\u74b0\u5883\n\nWindows7\nInternet Explorer11\nPowerShell2.0\n\n\n\u64cd\u4f5c\u5bfe\u8c61Web\u30b5\u30a4\u30c8\n\u64cd\u4f5c\u5bfe\u8c61\u306eWeb\u30b5\u30a4\u30c8(sample1.html)\u306f\u3001ID\u3068\u30d1\u30b9\u30ef\u30fc\u30c9\u3068\u753b\u9762\u9077\u79fb\u7528\u306e\u30dc\u30bf\u30f3\u304c\u3042\u308b\u30b7\u30f3\u30d7\u30eb\u306a\u69cb\u6210\u3067\u3059\u3002\n\u305f\u3060\u3001\u3059\u3079\u3066\u306e\u30bf\u30b0\u306bID\u5c5e\u6027\u304c\u4ed8\u3044\u3066\u3044\u307e\u305b\u3093\u2026\n\nsample1.html\n<!DOCTYPE html>\n<html lang=\"ja\">\n    <head>\n        <meta charset=\"utf-8\">\n        <title>PowerShell\u304b\u3089Web\u30b5\u30a4\u30c8\u64cd\u4f5c</title>\n    </head>\n    <body>\n        <form name=\"auth\" method=\"post\" action=\"./sample2.html\">\n            \u8a8d\u8a3cID\uff1a<input type=\"text\" name=\"auth_id\" value=\"\"><br>\n            \u8a8d\u8a3c\u30d1\u30b9\u30ef\u30fc\u30c9\uff1a<input type=\"password\" name=\"auth_password\" value=\"\"><br>\n            <input type=\"submit\" value=\"\u8a8d\u8a3c\">\n        </form>\n    </body>\n</html>\n\n\n\nPowerShell\u30b3\u30fc\u30c9\nWeb\u30b5\u30a4\u30c8\u3092\u64cd\u4f5c\u3059\u308b\u305f\u3081\u306ePowerShell\u306e\u30b3\u30fc\u30c9\u3067\u3059\u3002\n\u30dd\u30a4\u30f3\u30c8\u306f\u3001getElementsByName\u3067\u53d6\u5f97\u3057\u305f\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306f\u914d\u5217\u3068\u3057\u3066\u30a2\u30af\u30bb\u30b9\u3057\u306a\u3051\u308c\u3070\u306a\u3089\u306a\u3044\u70b9\u3067\u3059\u3002\nID\u5c5e\u6027\u304c\u3042\u308c\u3070\u3001getElementById\u3067\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u53d6\u5f97\u3067\u304d\u307e\u3059\u3002\n\nsample.ps1\n# Internet Explorer\u3092\u8d77\u52d5\u3059\u308b\u3002\n$ie = New-Object -ComObject InternetExplorer.Application\n\n# Internet Explorer\u3092\u8868\u793a\u3059\u308b\u3002\n$ie.Visible = $true\n\n# Web\u753b\u9762\u3078\u79fb\u52d5\u3059\u308b\u3002\n$ie.Navigate('.\\sample1.html')\n\n# \u30da\u30fc\u30b8\u304c\u5b8c\u5168\u306b\u5207\u308a\u66ff\u308f\u308b\u306e\u3092\u5f85\u3064\u3002\nwhile($ie.Busy) { Start-Sleep -milliseconds 100 }\n\n# IE\u753b\u9762\u64cd\u4f5c\u3092\u884c\u3046\u305f\u3081\u306e\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u53d6\u5f97\n$doc = $ie.document\n\n# ID\u5165\u529b\n$idElements = $doc.getElementsByName(\"auth_id\")\n# idElements\u306f\u8907\u6570\u53d6\u5f97\u3055\u308c\u308b\u306e\u3067\u30011\u3064\u3057\u304b\u8981\u7d20\u304c\u306a\u304f\u3068\u3082\u914d\u5217\u3068\u3057\u3066\u30a2\u30af\u30bb\u30b9\u3059\u308b\u5fc5\u8981\u304c\u3042\u308b\n@($idElements)[0].value = \"\u3042\u3044\u3067\u3043\"\n\n# \u30d1\u30b9\u30ef\u30fc\u30c9\u5165\u529b\n$passwdElements = $doc.getElementsByName(\"auth_password\")\n@($passwdElements)[0].value = \"\u30d1\u30b9\u30ef\u30fc\u30c9\"\n\n# \u30dc\u30bf\u30f3\u30af\u30ea\u30c3\u30af\uff08ID\u3082Name\u3082\u306a\u3044\u306e\u3067\u3001value\u3067\u5224\u5b9a\uff09\n$inputElements = $doc.getElementsByTagName(\"input\")\nForeach($inputElement in $inputElements) {\n    if ($inputElement.value -eq \"\u8a8d\u8a3c\") {\n        $inputElement.click()\n    }\n}\n\n\n\n\u304a\u308f\u308a\u306b\n\u4eca\u56de\u306f\u3058\u3081\u3066PowerShell\u5468\u308a\u3092\u8abf\u3079\u3066\u307f\u305f\u306e\u3067\u3059\u304c\u3001\u8272\u3005\u3067\u304d\u3066\u697d\u3057\u3044\u3067\u3059\u306d\u3002\nWindows10\u304b\u3089\u306fBash on Windows\u3067Bash\u66f8\u3051\u308b\u3088\u3046\u306b\u306a\u308b\u3088\u3046\u3067\u3059\u306e\u3067\u3001\u5358\u7d14\u306a\u7e70\u308a\u8fd4\u3057\u4f5c\u696d\u306f\u3069\u3093\u3069\u3093ShellScript\u5316\u3057\u3066\u3044\u304d\u305f\u3044\u3067\u3059\u3002\n\n\u53c2\u8003\u30b5\u30a4\u30c8\nhttp://stackoverflow.com/questions/28816216/powershell-programatically-set-input-field-by-name-in-ie\n# \u306f\u3058\u3081\u306b\nWeb\u30d6\u30e9\u30a6\u30b6\u306b\u5165\u529b\u3059\u308b\u4f5c\u696d\u3092\u81ea\u52d5\u5316\u3057\u305f\u3044\uff01\uff01\n\u3067\u3082\u3001\u7aef\u672b\u306bSeleniumDriver\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3067\u304d\u306a\u3044\u3002\n\u3068\u3044\u3046\u74b0\u5883\u3067\u3001PowerShell\u3092\u5229\u7528\u3057\u3066\u81ea\u52d5\u5316\u3092\u5b9f\u73fe\u3057\u307e\u3057\u305f\u3002\n\n# \u3084\u308a\u305f\u3044\u3053\u3068\n1. \u6240\u5b9a\u306eWeb\u30b5\u30a4\u30c8\u3092\u958b\u304f\u3002\n1. ID\u3068\u30d1\u30b9\u30ef\u30fc\u30c9\u3092\u5165\u529b\u3059\u308b\u3002\n1. \u30dc\u30bf\u30f3\u3092\u62bc\u3059\u3002\n\n# \u74b0\u5883\n- Windows7\n- Internet Explorer11\n- PowerShell2.0\n\n# \u64cd\u4f5c\u5bfe\u8c61Web\u30b5\u30a4\u30c8\n\u64cd\u4f5c\u5bfe\u8c61\u306eWeb\u30b5\u30a4\u30c8(sample1.html)\u306f\u3001ID\u3068\u30d1\u30b9\u30ef\u30fc\u30c9\u3068\u753b\u9762\u9077\u79fb\u7528\u306e\u30dc\u30bf\u30f3\u304c\u3042\u308b\u30b7\u30f3\u30d7\u30eb\u306a\u69cb\u6210\u3067\u3059\u3002\n\u305f\u3060\u3001\u3059\u3079\u3066\u306e\u30bf\u30b0\u306bID\u5c5e\u6027\u304c\u4ed8\u3044\u3066\u3044\u307e\u305b\u3093\u2026\n\n```sample1.html\n<!DOCTYPE html>\n<html lang=\"ja\">\n    <head>\n        <meta charset=\"utf-8\">\n        <title>PowerShell\u304b\u3089Web\u30b5\u30a4\u30c8\u64cd\u4f5c</title>\n    </head>\n    <body>\n        <form name=\"auth\" method=\"post\" action=\"./sample2.html\">\n            \u8a8d\u8a3cID\uff1a<input type=\"text\" name=\"auth_id\" value=\"\"><br>\n            \u8a8d\u8a3c\u30d1\u30b9\u30ef\u30fc\u30c9\uff1a<input type=\"password\" name=\"auth_password\" value=\"\"><br>\n            <input type=\"submit\" value=\"\u8a8d\u8a3c\">\n        </form>\n    </body>\n</html>\n```\n\n# PowerShell\u30b3\u30fc\u30c9\nWeb\u30b5\u30a4\u30c8\u3092\u64cd\u4f5c\u3059\u308b\u305f\u3081\u306ePowerShell\u306e\u30b3\u30fc\u30c9\u3067\u3059\u3002\n\u30dd\u30a4\u30f3\u30c8\u306f\u3001getElementsByName\u3067\u53d6\u5f97\u3057\u305f\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306f\u914d\u5217\u3068\u3057\u3066\u30a2\u30af\u30bb\u30b9\u3057\u306a\u3051\u308c\u3070\u306a\u3089\u306a\u3044\u70b9\u3067\u3059\u3002\nID\u5c5e\u6027\u304c\u3042\u308c\u3070\u3001getElementById\u3067\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u53d6\u5f97\u3067\u304d\u307e\u3059\u3002\n\n```sample.ps1\n# Internet Explorer\u3092\u8d77\u52d5\u3059\u308b\u3002\n$ie = New-Object -ComObject InternetExplorer.Application\n\n# Internet Explorer\u3092\u8868\u793a\u3059\u308b\u3002\n$ie.Visible = $true\n\n# Web\u753b\u9762\u3078\u79fb\u52d5\u3059\u308b\u3002\n$ie.Navigate('.\\sample1.html')\n\n# \u30da\u30fc\u30b8\u304c\u5b8c\u5168\u306b\u5207\u308a\u66ff\u308f\u308b\u306e\u3092\u5f85\u3064\u3002\nwhile($ie.Busy) { Start-Sleep -milliseconds 100 }\n\n# IE\u753b\u9762\u64cd\u4f5c\u3092\u884c\u3046\u305f\u3081\u306e\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u53d6\u5f97\n$doc = $ie.document\n\n# ID\u5165\u529b\n$idElements = $doc.getElementsByName(\"auth_id\")\n# idElements\u306f\u8907\u6570\u53d6\u5f97\u3055\u308c\u308b\u306e\u3067\u30011\u3064\u3057\u304b\u8981\u7d20\u304c\u306a\u304f\u3068\u3082\u914d\u5217\u3068\u3057\u3066\u30a2\u30af\u30bb\u30b9\u3059\u308b\u5fc5\u8981\u304c\u3042\u308b\n@($idElements)[0].value = \"\u3042\u3044\u3067\u3043\"\n    \n# \u30d1\u30b9\u30ef\u30fc\u30c9\u5165\u529b\n$passwdElements = $doc.getElementsByName(\"auth_password\")\n@($passwdElements)[0].value = \"\u30d1\u30b9\u30ef\u30fc\u30c9\"\n\n# \u30dc\u30bf\u30f3\u30af\u30ea\u30c3\u30af\uff08ID\u3082Name\u3082\u306a\u3044\u306e\u3067\u3001value\u3067\u5224\u5b9a\uff09\n$inputElements = $doc.getElementsByTagName(\"input\")\nForeach($inputElement in $inputElements) {\n    if ($inputElement.value -eq \"\u8a8d\u8a3c\") {\n        $inputElement.click()\n    }\n}\n```\n  \n# \u304a\u308f\u308a\u306b\n\u4eca\u56de\u306f\u3058\u3081\u3066PowerShell\u5468\u308a\u3092\u8abf\u3079\u3066\u307f\u305f\u306e\u3067\u3059\u304c\u3001\u8272\u3005\u3067\u304d\u3066\u697d\u3057\u3044\u3067\u3059\u306d\u3002\nWindows10\u304b\u3089\u306fBash on Windows\u3067Bash\u66f8\u3051\u308b\u3088\u3046\u306b\u306a\u308b\u3088\u3046\u3067\u3059\u306e\u3067\u3001\u5358\u7d14\u306a\u7e70\u308a\u8fd4\u3057\u4f5c\u696d\u306f\u3069\u3093\u3069\u3093ShellScript\u5316\u3057\u3066\u3044\u304d\u305f\u3044\u3067\u3059\u3002\n\n# \u53c2\u8003\u30b5\u30a4\u30c8\nhttp://stackoverflow.com/questions/28816216/powershell-programatically-set-input-field-by-name-in-ie\n", "tags": ["PowerShell", "InternetExplorer"]}