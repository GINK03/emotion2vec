{"context": "OS\u3064\u304f\u3063\u3066\u307f\u305f\u3044\u306e\u3067\u3001\u9032\u6357\u3092\u65e5\u8a18\u7684\u306b\u307e\u3068\u3081\u3066\u3044\u304d\u305f\u3044\n\u5927\u307e\u304b\u306a\u6d41\u308c\u306f30\u65e5\u3067\u3067\u304d\u308b! OS\u81ea\u4f5c\u5165\u9580\u306b\u6cbf\u3063\u3066\u3044\u304f\n\u305f\u3060\u3001\u540c\u3058\u3088\u3046\u306bFAT12\u30d5\u30ed\u30c3\u30d4\u30fc\u3060\u3068\u3064\u307e\u3089\u306a\u3044\u3068\u601d\u3063\u305f\u306e\u3067\u3001\u3044\u308d\u3044\u308d\u5909\u3048\u3066\u3044\u304d\u305f\u3044\n\n\u30d6\u30fc\u30c8\u30ed\u30fc\u30c0\nNASM\u306e\u8aac\u660e\u3084, \u30bb\u30b0\u30e1\u30f3\u30c8\u65b9\u5f0f\u7b49\u306e\u8aac\u660e\u306b\u95a2\u3057\u3066\u306f\u7701\u7565\n(NASM\u306b\u95a2\u3057\u3066\u306f\u3001\u500b\u4eba\u7684\u306bNASM Tutorial\u304c\u3068\u3066\u3082\u3088\u304b\u3063\u305f)\n\u307e\u305a\u3001FAT32 USB\u3092\u76ee\u6a19\u306b\u3057\u305f\u3044\u3068\u601d\u3063\u305f\u306e\u3067FAT32\u306eBPB\u3092\u8abf\u67fb\u3059\u308b\u3053\u3068\u304b\u3089\u59cb\u3081\u305f\uff08Linux\u7cfb\u3067\u306f\u4e0d\u8981\uff1f\u306a\u306e\u3060\u304c, WIndows\u3068\u304b\u3067\u306f\u5fc5\u8981\u3089\u3057\u3044\uff09\n\u3053\u308c\u306b\u3064\u3044\u3066\u306f\u3001FAT32\u306e\u4ed5\u69d8\u66f8\u300cMicrosoft Extensible Firmware Initiative FAT32 File System Specification\u300d\u3092\u53c2\u7167\u3057\u305f(FAT\u30d5\u30a1\u30a4\u30eb \u30b7\u30b9\u30c6\u30e0\u306e\u3057\u304f\u307f\u3068\u64cd\u4f5c\u6cd5\u3067\u306f\u65e5\u672c\u8a9e\u306b\u8a33\u3057\u3066\u304f\u308c\u3066\u3044\u308b)\n\u4ee5\u4e0b\u306f\u3001\u305d\u308c\u3089\u3092\u7c21\u5358\u306b\u307e\u3068\u3081\u305f\u8868\u3068\u624b\u5143\u306eUSB\u30e1\u30e2\u30ea\u3092Windows\u3067FAT32\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u3057\u3066\u78ba\u8a8d\u3057\u305f\u30d0\u30a4\u30ca\u30ea\n\n\n\u540d\u524d\n\u30aa\u30d5\u30bb\u30c3\u30c8(byte)\n\u30b5\u30a4\u30ba(bytes)\n\u8aac\u660e\n\u5b9f\u969b\u78ba\u8a8d\u3057\u305f\u5024\uff08Little Endian\uff09\n\n\nBS_jmpBoot\n0\n3\n\u30d6\u30fc\u30c8\u30b3\u30fc\u30c9\u3078\u306e\u30b8\u30e3\u30f3\u30d7\u547d\u4ee4\nEB 58 90\n\n\nBS_OEMName\n3\n8\n\u4efb\u610f\u306e\u540d\u524d\n4D 53 44 4F 53 35 2E 30 (MSDOS5.0)\n\n\nBPB_BytsPerSec\n11\n2\nbytes/sector, \u666e\u901a512\u304b\n00 02 (512)\n\n\nBPB_SecPerClus\n13\n1\nsectors/cluster, 2\u51aa\u3067\u306a\u3044\u3068\u3044\u3051\u306a\u3044, \u73fe\u5728\u3088\u304f\u4f7f\u308f\u308c\u308b\u306e\u306f8\u306e\u3088\u3046\u3060 \n08\n\n\nBPB_RsvdSecCnt\n14\n2\n\u4e88\u7d04\u30bb\u30af\u30bf\u6570, FAT32\u306e\u5834\u540832\u304c\u4ee3\u8868\u7684\n80 07\n\n\nBPB_NumFATs\n16\n1\n\u30dc\u30ea\u30e5\u30fc\u30e0\u4e2d\u306eFAT\u30c7\u30fc\u30bf\u69cb\u9020\u306e\u6570, FAT\u306e\u5834\u5408\u5e38\u306b2\u3068\u3042\u308b\n02\n\n\nBPB_RootEntCnt\n17\n2\nFAT12/16\u306b\u304a\u3044\u3066\u30eb\u30fc\u30c8\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u4e2d\u306e32byte\u30a8\u30f3\u30c8\u30ea\u306e\u6570\u3092\u793a\u3059, FAT32\u306e\u5834\u54080\u3068\u3042\u308b\n00 00\n\n\nBPB_TotSec16\n19\n2\n\u30dc\u30ea\u30e5\u30fc\u30e0\u4e2d\u306e\u7dcf\u30bb\u30af\u30bf\u6570(16bit), FAT32\u306e\u5834\u54080\n00 00\n\n\nBPB_Media\n21\n1\n\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30f3\u3042\u308a\u306e\u30ce\u30f3\u30ea\u30e0\u30fc\u30d0\u30eb\u30e1\u30c7\u30a3\u30a2\u306e\u5834\u5408\u306f0xF8, \u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30f3\u306a\u3057\u306e\u30ea\u30e0\u30fc\u30d0\u30eb\u30e1\u30c7\u30a3\u30a2\u306e\u5834\u5408\u306f0xF0\u304c\u6a19\u6e96\u7684\u306a\u5024\nF8\n\n\nBPB_FATSz16\n22\n2\nFAT12/FAT16\u306b\u304a\u3051\u308b1\u3064\u306eFAT\u306b\u3088\u3063\u3066\u5360\u6709\u3055\u308c\u308b\u30bb\u30af\u30bf\u6570(16bit), FAT32\u306e\u5834\u54080\n00 00\n\n\nBPB_SecPerTrk\n24\n2\nsecters/track\n3F 00(63)\n\n\nBPB_NumHeads\n26\n2\n\u30d8\u30c3\u30c9\u6570\nFF 00 (255)\n\n\nBPB_HiddSec\n28\n4\nFAT\u30dc\u30ea\u30e5\u30fc\u30e0\u3088\u308a\u524d\u306b\u3042\u308b\u96a0\u308c\u30bb\u30af\u30bf\u306e\u6570, \u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30f3\u304c\u306a\u3044\u30e1\u30c7\u30a3\u30a2\u3067\u306f0\n3F 00 00 00 (63)\n\n\nBPB_TotSec32\n32\n4\n\u30dc\u30ea\u30e5\u30fc\u30e0\u4e2d\u306e\u7dcf\u30bb\u30af\u30bf\u6570(32bit)\nC1 7F F1 00 (15826881)\n\n\nBPB_FATSz32\n36\n4\n1\u3064\u306eFAT\u306b\u5360\u6709\u3055\u308c\u308b\u30bb\u30af\u30bf\u6570(32bit)\n40 3C 00 00 (15424)\n\n\nBPB_ExtFlags\n40\n2\n0-3: \u30a2\u30af\u30c6\u30a3\u30a4\u30d6\u306aFAT\u6570, 4-6: \u4e88\u7d04, 7: 0\u306a\u3089\u30df\u30e9\u30fc\u30ea\u30f3\u30b0, 1\u306a\u30891FAT, 8-15: \u4e88\u7d04\n00 00\n\n\nBPB_FSVer\n42\n2\nFAT32\u30dc\u30ea\u30e5\u30fc\u30e0\u306e\u30d0\u30fc\u30b8\u30e7\u30f3, High\u304c\u30e1\u30b8\u30e3\u30fc, Low\u304c\u30de\u30a4\u30ca\u30fc\n00 00\n\n\nBPB_RootClus\n44\n4\n\u30eb\u30fc\u30c8\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306e\u6700\u521d\u306e\u30af\u30e9\u30b9\u30bf\u306e\u756a\u53f7, \u57fa\u672c2\u3068\u3042\u308b\n02 00 00 00\n\n\nBPB_FSInfo\n48\n2\nFAT32\u30dc\u30ea\u30e5\u30fc\u30e0\u306e\u4e88\u7d04\u9818\u57df\u4e2d\u306eFATINFO\u69cb\u9020\u306e\u30bb\u30af\u30bf\u756a\u53f7, \u57fa\u672c1\n01 00\n\n\nBPB_BkBootSec\n50\n2\n0\u306e\u5834\u5408\u30d6\u30fc\u30c8\u30ec\u30b3\u30fc\u30c9\u306e\u30b3\u30d4\u30fc\u30dc\u30ea\u30e5\u30fc\u30e0\u4e2d\u306e\u4e88\u7d04\u9818\u57df\u306e\u30bb\u30af\u30bf\u756a\u53f7, \u57fa\u672c6\n06 00\n\n\nBPB_Reserverd\n52\n12\n\u62e1\u5f35\u306e\u305f\u3081\u306e\u4e88\u7d04\u9818\u57df, FAT32\u306e\u5834\u54080\u3067\u57cb\u3081\u308b\n0\u57cb\u3081\n\n\nBS_DrvNum\n64\n1\n\u30c9\u30e9\u30a4\u30d6\u30ca\u30f3\u30d0\u30fc\n80\n\n\nBS_Reserved1\n65\n1\nWindowsNT\u7528\u306e\u4e88\u7d04\u9818\u57df, 0\u3067\u3044\u3044\n00\n\n\nBS_BootSig\n66\n1\n0x29, \u4ee5\u4e0b\u306e3\u30d5\u30a3\u30fc\u30eb\u30c9\u304c\u3042\u308b\u3068\u3044\u3046\u3053\u3068\u3092\u793a\u3059\n29\n\n\nBS_VolID\n67\n4\n\u30dc\u30ea\u30e5\u30fc\u30e0\u306e\u30b7\u30ea\u30a2\u30eb\u30ca\u30f3\u30d0\u30fc, BS_VolLab\u3068\u5171\u306b\u3001\u30ea\u30e0\u30fc\u30d0\u30eb\u30e1\u30c7\u30a3\u30a2\u3067\u306e\u30c8\u30e9\u30c3\u30ad\u30f3\u30b0\u306b\u5229\u7528\u3055\u308c\u308b, \u3053\u308c\u306b\u3088\u308aFAT\u30d5\u30a1\u30a4\u30eb\u30b7\u30b9\u30c6\u30e0\u306e\u30c9\u30e9\u30a4\u30d0\u304c\u4e0d\u6b63\u306a\u30c7\u30a3\u30b9\u30af\u304c\u633f\u5165\u3055\u308c\u305f\u3053\u3068\u3092\u691c\u51fa\u3067\u304d\u308b\n5C A1 A6 A0\n\n\nBS_VolLab\n71\n11\n\u30dc\u30ea\u30e5\u30fc\u30e0\u30e9\u30d9\u30eb, \u30eb\u30fc\u30c8\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u8a18\u9332\u3055\u308c\u3066\u3044\u308b11byte\u306e\u30dc\u30ea\u30e5\u30fc\u30e0\u30e9\u30d9\u30eb\u306b\u4e00\u81f4\u3059\u308b\n4E 4F 20 4E 41 4D 45 20 20 20 20 (NO NAME   )\n\n\nBS_FileSysType\n82\n8\n\"FAT32\"\u3068\u3044\u3046\u6587\u5b57\u5217\u3092\u5165\u308c\u308b\n46 41 54 33 20 20 20 (FAT32   )\n\n\n\n\u30d6\u30fc\u30c8\u30b3\u30fc\u30c9\u3092\u66f8\u304f\u524d\u306e\u4e8b\u524d\u77e5\u8b58\n\nBIOS\u304cMBR\u3092\u30ed\u30fc\u30c9\u3059\u308b\u30a2\u30c9\u30ec\u30b9\nBIOS\u306fMBR\u30920000:7c00\u306b\u30ed\u30fc\u30c9\u3059\u308b\n\u3082\u3057\u304f\u306f07c0:0000\u3068\u66f8\u304b\u308c\u308b\u5834\u5408\u3082\u3042\u308b\u304c\u3001\n\u3053\u308c\u306f\u3001\n0x0000 * 16 + 0x7c00 = 0x07c0 * 16 + 0x0000 = 0x7c00\n\u306a\u306e\u3067\u540c\u3058\u5834\u6240\n\u3057\u305f\u304c\u3063\u3066\u3001\u521d\u671f\u5316\u51e6\u7406\u3068\u3057\u3066\uff12\u901a\u308a\u306e\u3084\u308a\u65b9\u304c\u3042\u308b\n\n\norg 0x7c00 \u30670x7c00\u304b\u3089\u59cb\u3081\u3066\u3001\u30bb\u30b0\u30e1\u30f3\u30c8\u30ec\u30b8\u30b9\u30bf\u30920x0000\u306b\u521d\u671f\u5316\u3059\u308b\n0x0000\u304b\u3089\u59cb\u3081\u3066\u3001\u30bb\u30b0\u30e1\u30f3\u30c8\u30ec\u30b8\u30b9\u30bf\u30920x07c0\u306b\u521d\u671f\u5316\u3059\u308b \n\n\nint 0x10\n\n0x10\u306fVideo Services\u306b\u95a2\u9023\u3059\u308b\u5272\u308a\u8fbc\u307f\n1. AH\u30ec\u30b8\u30b9\u30bf\u306b\u30d5\u30a1\u30f3\u30af\u30b7\u30e7\u30f3\u30b3\u30fc\u30c9\u3092\u6307\u5b9a\n2. AL\u30ec\u30b8\u30b9\u30bf\u306b\u30d3\u30c7\u30aa\u30e2\u30fc\u30c9\u3092\u6307\u5b9a\n3. int 0x10\u5b9f\u884c\n4. AH\u30ec\u30b8\u30b9\u30bf\u306b0x0E\u3092\u6307\u5b9a\u3057int 0x10\u3092\u5b9f\u884c\u3059\u308b\u3053\u3068\u3067AL\u30ec\u30b8\u30b9\u30bf\u306e\u6587\u5b57\u3092\u66f8\u304d\u8fbc\u3080\uff08\u7d42\u7aef\u30b3\u30fc\u30c9\u307e\u3067\u30eb\u30fc\u30d7\uff09\n\u3057\u305f\u304c\u3063\u3066\u3001\u30b3\u30fc\u30c9\u3067\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u6d41\u308c\u306b\u306a\u308b\n        mov     al, 0x00\n        mov     ah, 0x03\n        int     0x10\n\n        mov     si, msg\n        mov     ah, 0x0e\n\nprintln:\n        lodsb\n        or      al, al          ; if \\0                                                                                                      \n        jz      hang            ; jump to hang                                                                                               \n\n        int     0x10\n        jmp     println\n\n\nASCII\u30b3\u30fc\u30c9\n\u3068\u308a\u3042\u3048\u305a\u77e5\u3063\u3066\u304a\u304f\u3079\u304d\u3082\u306e\n* \u30ad\u30e3\u30ea\u30c3\u30b8\u30ea\u30bf\u30fc\u30f3 13\n* \u30e9\u30a4\u30f3\u30d5\u30a3\u30fc\u30c9 10\n* \u7d42\u7aef 0\n\nMBR\u306e\u6700\u5f8c\nMBR\u306e511\u30d0\u30a4\u30c8\u76ee\u3068512\u30d0\u30a4\u30c8\u76ee\u306f0xaa 0x55\u3068\u3044\u3046\u6c7a\u307e\u308a\n\nHelloWorld\n\u524d\u8ff0\u306e\u3053\u3068\u3092\u307e\u3068\u3081\u3066\u3001\u6700\u521d\u306e\u30b9\u30c6\u30c3\u30d7\u3068\u3057\u3066HelloWorld\u3092\u8868\u793a\u3059\u308b\u3060\u3051\u306e\u30d6\u30fc\u30c8\u30ed\u30fc\u30c0\u3092\u4f5c\u6210\u3057\u305f\u3002\n\nboot.asm\n[bits 16]\n[org 0x7c00]\n        ;; BPB Structure                                                                                                                     \n        jmp     start           ;BS_jmpBoot                                                                                                  \nBS_OEMName      db \"MYTESTOS\"\nBPB_BytsPerSec  dw 0x0200\nBPB_SecPerClus  db 0x08\nBPB_RsvdSecCnt  dw 0x0020\nBPB_NumFATs     db 0x02\nBPB_RootEntCnt  dw 0x0000\nBPB_TotSec16    dw 0x0000\nBPB_Media       db 0xf8\nBPB_FATSz16     dw 0x0000\nBPB_SecPerTrk   dw 0x003f\nBPB_NumHeads    dw 0x00ff\nBPB_HiddSec     dd 0x0000003f\nBPB_TotSec32    dd 0x00f17fc1\nBPB_FATSz32     dd 0x00003c40\nBPB_ExtFlags    dw 0x0000\nBPB_FSVer       dw 0x0000\nBPB_RootClus    dd 0x00000002\nBPB_FSInfo      dw 0x0001\nBPB_BkBootSec   dw 0x0006\n        times   12      db 0    ;BPB_Reserverd                                                                                               \nBS_DrvNum       db 0x80\nBS_Reserved1    db 0x00\nBS_BootSig      db 0x29\nBS_VolID        dd 0xa0a615c\nBS_VolLab       db \"TESTOS BOOT\"\nBS_FileSysType  db \"FAT32   \"\n\n        ;; boot code                                                                                                                         \nstart:\n        ;; initialize segment registers                                                                                                      \n        xor     ax, ax\n        mov     ds, ax          ; Data Segment                                                                                               \n        mov     es, ax\n        mov     fs, ax\n        mov     gs, ax\n        mov     ss, ax          ; Stack Segment                                                                                              \n        mov     sp, 0x7c00      ; Stack Pointer                                                                                              \n\n\n        mov     al, 0x00\n        mov     ah, 0x03\n        int     0x10\n\n        mov     si, msg\n        mov     ah, 0x0e\n\nprintln:\n        lodsb\n        or      al, al          ; if \\0                                                                                                      \n        jz      hang            ; jump to hang                                                                                               \n\n        int     0x10\n        jmp     println\n\nhang:\n        hlt\n        jmp     hang\nmsg:\n        db      \"Hello, World\", 13, 10, 0\n\n        times   510-($-$$) db 0\n        dw      0xaa55\n\n\n\u3068\u308a\u3042\u3048\u305aQEMU\u3067\u306e\u52d5\u4f5c\u78ba\u8a8d\u306f\u3067\u304d\u305f\n\n\u53c2\u8003\n\n30\u65e5\u3067\u3067\u304d\u308b! OS\u81ea\u4f5c\u5165\u9580\nMicrosoft Extensible Firmware Initiative FAT32 File System Specification\nFAT\u30d5\u30a1\u30a4\u30eb \u30b7\u30b9\u30c6\u30e0\u306e\u3057\u304f\u307f\u3068\u64cd\u4f5c\u6cd5\nTips BIOS\u30b5\u30fc\u30d3\u30b9\u5272\u308a\u8fbc\u307f \u30d3\u30c7\u30aa\u30b5\u30fc\u30d3\u30b9 \u30d3\u30c7\u30aa\u30e2\u30fc\u30c9\u8a2d\u5b9a\nBabystep2 - OSDev Wiki\nWriting an OS: Baby Steps\nGitHub - ishanthilina/USB-FAT32-Bootloader: A simple FAT32 bootloader written in assembly to boot from USB drives.\nInside My BRAIN \u00bb Blog Archive \u00bb OS\u306e\u8d77\u52d5\u307e\u3067\uff082\uff09-BPB\uff082\uff09\n\nOS\u3064\u304f\u3063\u3066\u307f\u305f\u3044\u306e\u3067\u3001\u9032\u6357\u3092\u65e5\u8a18\u7684\u306b\u307e\u3068\u3081\u3066\u3044\u304d\u305f\u3044\n\n\u5927\u307e\u304b\u306a\u6d41\u308c\u306f[30\u65e5\u3067\u3067\u304d\u308b! OS\u81ea\u4f5c\u5165\u9580](https://www.amazon.co.jp/exec/obidos/ASIN/B00IR1HYI0/kuredev-22/ref=nosim/)\u306b\u6cbf\u3063\u3066\u3044\u304f\n\u305f\u3060\u3001\u540c\u3058\u3088\u3046\u306bFAT12\u30d5\u30ed\u30c3\u30d4\u30fc\u3060\u3068\u3064\u307e\u3089\u306a\u3044\u3068\u601d\u3063\u305f\u306e\u3067\u3001\u3044\u308d\u3044\u308d\u5909\u3048\u3066\u3044\u304d\u305f\u3044\n\n# \u30d6\u30fc\u30c8\u30ed\u30fc\u30c0\nNASM\u306e\u8aac\u660e\u3084, \u30bb\u30b0\u30e1\u30f3\u30c8\u65b9\u5f0f\u7b49\u306e\u8aac\u660e\u306b\u95a2\u3057\u3066\u306f\u7701\u7565\n(NASM\u306b\u95a2\u3057\u3066\u306f\u3001\u500b\u4eba\u7684\u306b[NASM Tutorial](http://cs.lmu.edu/~ray/notes/nasmtutorial/)\u304c\u3068\u3066\u3082\u3088\u304b\u3063\u305f)\n\n\u307e\u305a\u3001FAT32 USB\u3092\u76ee\u6a19\u306b\u3057\u305f\u3044\u3068\u601d\u3063\u305f\u306e\u3067FAT32\u306eBPB\u3092\u8abf\u67fb\u3059\u308b\u3053\u3068\u304b\u3089\u59cb\u3081\u305f\uff08Linux\u7cfb\u3067\u306f\u4e0d\u8981\uff1f\u306a\u306e\u3060\u304c, WIndows\u3068\u304b\u3067\u306f\u5fc5\u8981\u3089\u3057\u3044\uff09\n\u3053\u308c\u306b\u3064\u3044\u3066\u306f\u3001FAT32\u306e\u4ed5\u69d8\u66f8\u300c[Microsoft Extensible Firmware Initiative FAT32 File System Specification](https://staff.washington.edu/dittrich/misc/fatgen103.pdf)\u300d\u3092\u53c2\u7167\u3057\u305f([FAT\u30d5\u30a1\u30a4\u30eb \u30b7\u30b9\u30c6\u30e0\u306e\u3057\u304f\u307f\u3068\u64cd\u4f5c\u6cd5](http://elm-chan.org/docs/fat.html)\u3067\u306f\u65e5\u672c\u8a9e\u306b\u8a33\u3057\u3066\u304f\u308c\u3066\u3044\u308b)\n\n\n\u4ee5\u4e0b\u306f\u3001\u305d\u308c\u3089\u3092\u7c21\u5358\u306b\u307e\u3068\u3081\u305f\u8868\u3068\u624b\u5143\u306eUSB\u30e1\u30e2\u30ea\u3092Windows\u3067FAT32\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u3057\u3066\u78ba\u8a8d\u3057\u305f\u30d0\u30a4\u30ca\u30ea\n\n\n <table><tr><th>\u540d\u524d</th><th>\u30aa\u30d5\u30bb\u30c3\u30c8(byte)</th><th>\u30b5\u30a4\u30ba(bytes)</th><th>\u8aac\u660e</th><th>\u5b9f\u969b\u78ba\u8a8d\u3057\u305f\u5024\uff08Little Endian\uff09</th></tr>\n<tr><td>BS_jmpBoot</td><td>0</td><td>3</td><td>\u30d6\u30fc\u30c8\u30b3\u30fc\u30c9\u3078\u306e\u30b8\u30e3\u30f3\u30d7\u547d\u4ee4</td><td>EB 58 90</td></tr>\n<tr><td>BS_OEMName</td><td>3</td><td>8</td><td>\u4efb\u610f\u306e\u540d\u524d</td><td>4D 53 44 4F 53 35 2E 30 (MSDOS5.0)</td></tr>\n<tr><td>BPB_BytsPerSec</td><td>11</td><td>2</td><td>bytes/sector, \u666e\u901a512\u304b</td><td>00 02 (512)</td></tr>\n<tr><td>BPB_SecPerClus</td><td>13</td><td>1</td><td>sectors/cluster, 2\u51aa\u3067\u306a\u3044\u3068\u3044\u3051\u306a\u3044, \u73fe\u5728\u3088\u304f\u4f7f\u308f\u308c\u308b\u306e\u306f8\u306e\u3088\u3046\u3060 </td><td>08</td></tr>\n<tr><td>BPB_RsvdSecCnt</td><td>14</td><td>2</td><td>\u4e88\u7d04\u30bb\u30af\u30bf\u6570, FAT32\u306e\u5834\u540832\u304c\u4ee3\u8868\u7684</td><td>80 07</td></tr>\n<tr><td>BPB_NumFATs</td><td>16</td><td>1</td><td>\u30dc\u30ea\u30e5\u30fc\u30e0\u4e2d\u306eFAT\u30c7\u30fc\u30bf\u69cb\u9020\u306e\u6570, FAT\u306e\u5834\u5408\u5e38\u306b2\u3068\u3042\u308b</td><td>02</td></tr>\n<tr><td>BPB_RootEntCnt</td><td>17</td><td>2</td><td>FAT12/16\u306b\u304a\u3044\u3066\u30eb\u30fc\u30c8\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u4e2d\u306e32byte\u30a8\u30f3\u30c8\u30ea\u306e\u6570\u3092\u793a\u3059, FAT32\u306e\u5834\u54080\u3068\u3042\u308b</td><td>00 00</td></tr>\n<tr><td>BPB_TotSec16</td><td>19</td><td>2</td><td>\u30dc\u30ea\u30e5\u30fc\u30e0\u4e2d\u306e\u7dcf\u30bb\u30af\u30bf\u6570(16bit), FAT32\u306e\u5834\u54080</td><td>00 00</td></tr>\n<tr><td>BPB_Media</td><td>21</td><td>1</td><td>\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30f3\u3042\u308a\u306e\u30ce\u30f3\u30ea\u30e0\u30fc\u30d0\u30eb\u30e1\u30c7\u30a3\u30a2\u306e\u5834\u5408\u306f0xF8, \u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30f3\u306a\u3057\u306e\u30ea\u30e0\u30fc\u30d0\u30eb\u30e1\u30c7\u30a3\u30a2\u306e\u5834\u5408\u306f0xF0\u304c\u6a19\u6e96\u7684\u306a\u5024</td><td>F8</td></tr>\n<tr><td>BPB_FATSz16</td><td>22</td><td>2</td><td>FAT12/FAT16\u306b\u304a\u3051\u308b1\u3064\u306eFAT\u306b\u3088\u3063\u3066\u5360\u6709\u3055\u308c\u308b\u30bb\u30af\u30bf\u6570(16bit), FAT32\u306e\u5834\u54080</td><td>00 00</td></tr>\n<tr><td>BPB_SecPerTrk</td><td>24</td><td>2</td><td>secters/track</td><td>3F 00(63)</td></tr>\n<tr><td>BPB_NumHeads</td><td>26</td><td>2</td><td>\u30d8\u30c3\u30c9\u6570</td><td>FF 00 (255)</td></tr>\n<tr><td>BPB_HiddSec</td><td>28</td><td>4</td><td>FAT\u30dc\u30ea\u30e5\u30fc\u30e0\u3088\u308a\u524d\u306b\u3042\u308b\u96a0\u308c\u30bb\u30af\u30bf\u306e\u6570, \u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30f3\u304c\u306a\u3044\u30e1\u30c7\u30a3\u30a2\u3067\u306f0</td><td>3F 00 00 00 (63)</td></tr>\n<tr><td>BPB_TotSec32</td><td>32</td><td>4</td><td>\u30dc\u30ea\u30e5\u30fc\u30e0\u4e2d\u306e\u7dcf\u30bb\u30af\u30bf\u6570(32bit)</td><td>C1 7F F1 00 (15826881)</td></tr>\n<tr><td>BPB_FATSz32</td><td>36</td><td>4</td><td>1\u3064\u306eFAT\u306b\u5360\u6709\u3055\u308c\u308b\u30bb\u30af\u30bf\u6570(32bit)</td><td>40 3C 00 00 (15424)</td></tr>\n<tr><td>BPB_ExtFlags</td><td>40</td><td>2</td><td>0-3: \u30a2\u30af\u30c6\u30a3\u30a4\u30d6\u306aFAT\u6570, 4-6: \u4e88\u7d04, 7: 0\u306a\u3089\u30df\u30e9\u30fc\u30ea\u30f3\u30b0, 1\u306a\u30891FAT, 8-15: \u4e88\u7d04</td><td>00 00</td></tr>\n<tr><td>BPB_FSVer</td><td>42</td><td>2</td><td>FAT32\u30dc\u30ea\u30e5\u30fc\u30e0\u306e\u30d0\u30fc\u30b8\u30e7\u30f3, High\u304c\u30e1\u30b8\u30e3\u30fc, Low\u304c\u30de\u30a4\u30ca\u30fc</td><td>00 00</td></tr>\n<tr><td>BPB_RootClus</td><td>44</td><td>4</td><td>\u30eb\u30fc\u30c8\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306e\u6700\u521d\u306e\u30af\u30e9\u30b9\u30bf\u306e\u756a\u53f7, \u57fa\u672c2\u3068\u3042\u308b</td><td>02 00 00 00</td></tr>\n<tr><td>BPB_FSInfo</td><td>48</td><td>2</td><td>FAT32\u30dc\u30ea\u30e5\u30fc\u30e0\u306e\u4e88\u7d04\u9818\u57df\u4e2d\u306eFATINFO\u69cb\u9020\u306e\u30bb\u30af\u30bf\u756a\u53f7, \u57fa\u672c1</td><td>01 00</td></tr>\n<tr><td>BPB_BkBootSec</td><td>50</td><td>2</td><td>0\u306e\u5834\u5408\u30d6\u30fc\u30c8\u30ec\u30b3\u30fc\u30c9\u306e\u30b3\u30d4\u30fc\u30dc\u30ea\u30e5\u30fc\u30e0\u4e2d\u306e\u4e88\u7d04\u9818\u57df\u306e\u30bb\u30af\u30bf\u756a\u53f7, \u57fa\u672c6</td><td>06 00</td></tr>\n<tr><td>BPB_Reserverd</td><td>52</td><td>12</td><td>\u62e1\u5f35\u306e\u305f\u3081\u306e\u4e88\u7d04\u9818\u57df, FAT32\u306e\u5834\u54080\u3067\u57cb\u3081\u308b</td><td>0\u57cb\u3081</td></tr>\n<tr><td>BS_DrvNum</td><td>64</td><td>1</td><td>\u30c9\u30e9\u30a4\u30d6\u30ca\u30f3\u30d0\u30fc</td><td>80</td></tr>\n<tr><td>BS_Reserved1</td><td>65</td><td>1</td><td>WindowsNT\u7528\u306e\u4e88\u7d04\u9818\u57df, 0\u3067\u3044\u3044</td><td>00</td></tr>\n<tr><td>BS_BootSig</td><td>66</td><td>1</td><td>0x29, \u4ee5\u4e0b\u306e3\u30d5\u30a3\u30fc\u30eb\u30c9\u304c\u3042\u308b\u3068\u3044\u3046\u3053\u3068\u3092\u793a\u3059</td><td>29</td></tr>\n<tr><td>BS_VolID</td><td>67</td><td>4</td><td>\u30dc\u30ea\u30e5\u30fc\u30e0\u306e\u30b7\u30ea\u30a2\u30eb\u30ca\u30f3\u30d0\u30fc, BS_VolLab\u3068\u5171\u306b\u3001\u30ea\u30e0\u30fc\u30d0\u30eb\u30e1\u30c7\u30a3\u30a2\u3067\u306e\u30c8\u30e9\u30c3\u30ad\u30f3\u30b0\u306b\u5229\u7528\u3055\u308c\u308b, \u3053\u308c\u306b\u3088\u308aFAT\u30d5\u30a1\u30a4\u30eb\u30b7\u30b9\u30c6\u30e0\u306e\u30c9\u30e9\u30a4\u30d0\u304c\u4e0d\u6b63\u306a\u30c7\u30a3\u30b9\u30af\u304c\u633f\u5165\u3055\u308c\u305f\u3053\u3068\u3092\u691c\u51fa\u3067\u304d\u308b</td><td>5C A1 A6 A0</td></tr>\n<tr><td>BS_VolLab</td><td>71</td><td>11</td><td>\u30dc\u30ea\u30e5\u30fc\u30e0\u30e9\u30d9\u30eb, \u30eb\u30fc\u30c8\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u8a18\u9332\u3055\u308c\u3066\u3044\u308b11byte\u306e\u30dc\u30ea\u30e5\u30fc\u30e0\u30e9\u30d9\u30eb\u306b\u4e00\u81f4\u3059\u308b</td><td>4E 4F 20 4E 41 4D 45 20 20 20 20 (NO NAME   )</td></tr>\n<tr><td>BS_FileSysType</td><td>82</td><td>8</td><td>\"FAT32\"\u3068\u3044\u3046\u6587\u5b57\u5217\u3092\u5165\u308c\u308b</td><td>46 41 54 33 20 20 20 (FAT32   )</td></tr></table>\n\n## \u30d6\u30fc\u30c8\u30b3\u30fc\u30c9\u3092\u66f8\u304f\u524d\u306e\u4e8b\u524d\u77e5\u8b58\n### BIOS\u304cMBR\u3092\u30ed\u30fc\u30c9\u3059\u308b\u30a2\u30c9\u30ec\u30b9\nBIOS\u306fMBR\u30920000:7c00\u306b\u30ed\u30fc\u30c9\u3059\u308b\n\u3082\u3057\u304f\u306f07c0:0000\u3068\u66f8\u304b\u308c\u308b\u5834\u5408\u3082\u3042\u308b\u304c\u3001\n\u3053\u308c\u306f\u3001\n```0x0000 * 16 + 0x7c00 = 0x07c0 * 16 + 0x0000 = 0x7c00```\n\u306a\u306e\u3067\u540c\u3058\u5834\u6240\n\n\u3057\u305f\u304c\u3063\u3066\u3001\u521d\u671f\u5316\u51e6\u7406\u3068\u3057\u3066\uff12\u901a\u308a\u306e\u3084\u308a\u65b9\u304c\u3042\u308b\n\n* ```org 0x7c00``` \u30670x7c00\u304b\u3089\u59cb\u3081\u3066\u3001\u30bb\u30b0\u30e1\u30f3\u30c8\u30ec\u30b8\u30b9\u30bf\u30920x0000\u306b\u521d\u671f\u5316\u3059\u308b\n* 0x0000\u304b\u3089\u59cb\u3081\u3066\u3001\u30bb\u30b0\u30e1\u30f3\u30c8\u30ec\u30b8\u30b9\u30bf\u30920x07c0\u306b\u521d\u671f\u5316\u3059\u308b \n\n### ```int 0x10```\n0x10\u306fVideo Services\u306b\u95a2\u9023\u3059\u308b\u5272\u308a\u8fbc\u307f\n1. AH\u30ec\u30b8\u30b9\u30bf\u306b\u30d5\u30a1\u30f3\u30af\u30b7\u30e7\u30f3\u30b3\u30fc\u30c9\u3092\u6307\u5b9a\n2. AL\u30ec\u30b8\u30b9\u30bf\u306b\u30d3\u30c7\u30aa\u30e2\u30fc\u30c9\u3092\u6307\u5b9a\n3. ```int 0x10```\u5b9f\u884c\n4. AH\u30ec\u30b8\u30b9\u30bf\u306b0x0E\u3092\u6307\u5b9a\u3057int 0x10\u3092\u5b9f\u884c\u3059\u308b\u3053\u3068\u3067AL\u30ec\u30b8\u30b9\u30bf\u306e\u6587\u5b57\u3092\u66f8\u304d\u8fbc\u3080\uff08\u7d42\u7aef\u30b3\u30fc\u30c9\u307e\u3067\u30eb\u30fc\u30d7\uff09\n\u3057\u305f\u304c\u3063\u3066\u3001\u30b3\u30fc\u30c9\u3067\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u6d41\u308c\u306b\u306a\u308b\n\n```nasm\n        mov     al, 0x00\n        mov     ah, 0x03\n        int     0x10\n\n        mov     si, msg\n        mov     ah, 0x0e\n\nprintln:\n        lodsb\n        or      al, al          ; if \\0                                                                                                      \n        jz      hang            ; jump to hang                                                                                               \n\n        int     0x10\n        jmp     println\n```\n\n### ASCII\u30b3\u30fc\u30c9\n\u3068\u308a\u3042\u3048\u305a\u77e5\u3063\u3066\u304a\u304f\u3079\u304d\u3082\u306e\n* \u30ad\u30e3\u30ea\u30c3\u30b8\u30ea\u30bf\u30fc\u30f3 13\n* \u30e9\u30a4\u30f3\u30d5\u30a3\u30fc\u30c9 10\n* \u7d42\u7aef 0\n### MBR\u306e\u6700\u5f8c\nMBR\u306e511\u30d0\u30a4\u30c8\u76ee\u3068512\u30d0\u30a4\u30c8\u76ee\u306f0xaa 0x55\u3068\u3044\u3046\u6c7a\u307e\u308a\n\n## HelloWorld\n\u524d\u8ff0\u306e\u3053\u3068\u3092\u307e\u3068\u3081\u3066\u3001\u6700\u521d\u306e\u30b9\u30c6\u30c3\u30d7\u3068\u3057\u3066HelloWorld\u3092\u8868\u793a\u3059\u308b\u3060\u3051\u306e\u30d6\u30fc\u30c8\u30ed\u30fc\u30c0\u3092\u4f5c\u6210\u3057\u305f\u3002\n\n```nasm:boot.asm\n[bits 16]\n[org 0x7c00]\n        ;; BPB Structure                                                                                                                     \n        jmp     start           ;BS_jmpBoot                                                                                                  \nBS_OEMName      db \"MYTESTOS\"\nBPB_BytsPerSec  dw 0x0200\nBPB_SecPerClus  db 0x08\nBPB_RsvdSecCnt  dw 0x0020\nBPB_NumFATs     db 0x02\nBPB_RootEntCnt  dw 0x0000\nBPB_TotSec16    dw 0x0000\nBPB_Media       db 0xf8\nBPB_FATSz16     dw 0x0000\nBPB_SecPerTrk   dw 0x003f\nBPB_NumHeads    dw 0x00ff\nBPB_HiddSec     dd 0x0000003f\nBPB_TotSec32    dd 0x00f17fc1\nBPB_FATSz32     dd 0x00003c40\nBPB_ExtFlags    dw 0x0000\nBPB_FSVer       dw 0x0000\nBPB_RootClus    dd 0x00000002\nBPB_FSInfo      dw 0x0001\nBPB_BkBootSec   dw 0x0006\n        times   12      db 0    ;BPB_Reserverd                                                                                               \nBS_DrvNum       db 0x80\nBS_Reserved1    db 0x00\nBS_BootSig      db 0x29\nBS_VolID        dd 0xa0a615c\nBS_VolLab       db \"TESTOS BOOT\"\nBS_FileSysType  db \"FAT32   \"\n\n        ;; boot code                                                                                                                         \nstart:\n        ;; initialize segment registers                                                                                                      \n        xor     ax, ax\n        mov     ds, ax          ; Data Segment                                                                                               \n        mov     es, ax\n        mov     fs, ax\n        mov     gs, ax\n        mov     ss, ax          ; Stack Segment                                                                                              \n        mov     sp, 0x7c00      ; Stack Pointer                                                                                              \n\n\n        mov     al, 0x00\n        mov     ah, 0x03\n        int     0x10\n\n        mov     si, msg\n        mov     ah, 0x0e\n\nprintln:\n        lodsb\n        or      al, al          ; if \\0                                                                                                      \n        jz      hang            ; jump to hang                                                                                               \n\n        int     0x10\n        jmp     println\n\nhang:\n        hlt\n        jmp     hang\nmsg:\n        db      \"Hello, World\", 13, 10, 0\n\n        times   510-($-$$) db 0\n        dw      0xaa55\n```\n\n\u3068\u308a\u3042\u3048\u305aQEMU\u3067\u306e\u52d5\u4f5c\u78ba\u8a8d\u306f\u3067\u304d\u305f\n\n## \u53c2\u8003\n* [30\u65e5\u3067\u3067\u304d\u308b! OS\u81ea\u4f5c\u5165\u9580](https://www.amazon.co.jp/exec/obidos/ASIN/B00IR1HYI0/kuredev-22/ref=nosim/)\n* [Microsoft Extensible Firmware Initiative FAT32 File System Specification](https://staff.washington.edu/dittrich/misc/fatgen103.pdf)\n* [FAT\u30d5\u30a1\u30a4\u30eb \u30b7\u30b9\u30c6\u30e0\u306e\u3057\u304f\u307f\u3068\u64cd\u4f5c\u6cd5](http://elm-chan.org/docs/fat.html)\n* [Tips BIOS\u30b5\u30fc\u30d3\u30b9\u5272\u308a\u8fbc\u307f \u30d3\u30c7\u30aa\u30b5\u30fc\u30d3\u30b9 \u30d3\u30c7\u30aa\u30e2\u30fc\u30c9\u8a2d\u5b9a](http://softwaretechnique.jp/OS_Development/Tips/Bios_Services/video_services_00.html)\n* [Babystep2 - OSDev Wiki](http://wiki.osdev.org/Babystep2)\n* [Writing an OS: Baby Steps](http://tutorialsbynick.com/writing-an-os-baby-steps/)\n* [GitHub - ishanthilina/USB-FAT32-Bootloader: A simple FAT32 bootloader written in assembly to boot from USB drives.](https://github.com/ishanthilina/USB-FAT32-Bootloader)\n* [Inside My BRAIN \u00bb Blog Archive \u00bb OS\u306e\u8d77\u52d5\u307e\u3067\uff082\uff09-BPB\uff082\uff09](http://masuto.ddo.jp/blog/?p=426)\n", "tags": ["OS", "\u81ea\u4f5cOS", "nasm", "fat32", "USB"]}