{"tags": ["HTML5", "canvas", "d3.js", "\u753b\u50cf\u51e6\u7406"], "context": " More than 1 year has passed since last update.\n\n\u8f1d\u5ea6\u306e\u30d2\u30b9\u30c8\u30b0\u30e9\u30e0\n\u753b\u50cf\u306e\u660e\u308b\u3055\u3084\u54c1\u8cea\u3092\u8abf\u3079\u308b\u305f\u3081\u306b\u3001\u753b\u50cf\u306e\u8f1d\u5ea6\u306e\u5206\u5e03\u72b6\u6cc1\u3092\u30d2\u30b9\u30c8\u30b0\u30e9\u30e0\u3092\u53d6\u308b\u3053\u3068\u304c\u3042\u308a\u307e\u3059\u3002\nYUV\u306eY\u3092\u8a08\u7b97\u3057\u305d\u306e\u5024\u3054\u3068\u3092\u30ab\u30a6\u30f3\u30c8\u3057\u3066D3.js\u3067\u30b0\u30e9\u30d5\u3092\u51fa\u529b\u3057\u3088\u3046\u3068\u601d\u3044\u307e\u3059\u3002\n\nhistogram.html\n<!DOCTYPE html>\n<html>\n<head>\n<script src=\"./jquery-2.1.1.min.js\"></script>\n<script src=\"http://d3js.org/d3.v3.min.js\" charset=\"utf-8\"></script>\n<script type=\"text/javascript\">\nfunction drawGraph(ys) {\n    //d3.js \u3067\u30b0\u30e9\u30d5\u3092\u63cf\u753b\u3059\u308b\u3002\n\n    //\u30b0\u30e9\u30d5\u3092\u63cf\u753b\u3059\u308bSVG\u3092\u7528\u610f\n    var w = 500;\n    var h = 300;\n    var barPadding = 1;\n    var svg = d3.select(\"body\")\n                 .append(\"svg\")\n                 .attr(\"width\", w)\n                 .attr(\"height\", h);\n\n    //\u53d7\u3051\u53d6\u3063\u305f\u30c7\u30fc\u30bf\u3092\u5143\u306b\u30d2\u30b9\u30c8\u30b0\u30e9\u30e0\u3092\u4f5c\u6210\u3059\u308b\n    svg.selectAll(\"rect\")\n        .data(ys)\n        .enter()\n        .append(\"rect\")\n        .attr(\"x\", function(d, i) {\n            return i * (w/ys.length);\n        })\n        .attr(\"y\", function(d) {\n            return h - d/8;\n        })\n        .attr(\"width\", w/ys.length - barPadding)\n        .attr(\"height\", function(d) {\n            return d/8;\n        });\n}\n\nfunction fail(e) {\n    //\u30a8\u30e9\u30fc\u306e\u6642\u306e\u30e1\u30bd\u30c3\u30c9\n    alert(e);\n}\n\nfunction getYArray(data) {\n    var ys = new Array(256);\n    for (var i = 0; i < ys.length;i++) {\n        ys[i] = 0;\n    }\n\n    for (var i = 0; i < data.length; i= i + 4) {\n        // \u8f1d\u5ea6(YUV\u306eY)\u306e\u8a08\u7b97\u3092\u884c\u3046\n        var y = ~~(0.299 * data[i] + 0.587 * data[i + 1] + 0.114 * data[i + 2]);\n        // \u8f1d\u5ea6\u306e\u5024\u3054\u3068\u306e\u30ab\u30a6\u30f3\u30c8\n        ys[y]++;\n    }\n    return ys;\n}\n\nfunction calcY() {    \n    var dfd = new $.Deferred;\n\n    var canvas = document.getElementById(\"c1\");\n    var ctx = canvas.getContext(\"2d\");\n    var img = new Image();\n    img.src = \"test.jpg\";\n    img.onload = function() {\n        ctx.drawImage(img, 0, 0);\n        var imagedata = ctx.getImageData(0, 0, canvas.width, canvas.height);\n        var ys = getYArray(imagedata.data);\n        dfd.resolve(ys);\n    };\n    return dfd.promise();\n}\n\nwindow.onload = function() {    \n    calcY().then(drawGraph, fail);\n};\n</script>\n</head>\n<body>\n<canvas id=\"c1\" width=\"300\" height=\"300\">\n</body>\n</html>\n\n\n\u3044\u308d\u3044\u308d\u306a\u753b\u50cf\u306e\u7d50\u679c\u3092\u4ee5\u4e0b\u306b\u793a\u3057\u307e\u3059\u3002\n\u6697\u3044\u753b\u50cf\u307b\u3069\u5de6(0\u306b\u8fd1\u3044\u65b9)\u306e\u5024\u304c\u5927\u304d\u304f\u306a\u3063\u3066\u3044\u308b\u306e\u304c\u308f\u304b\u308a\u307e\u3059\u3002\n\n\n\n\n# \u8f1d\u5ea6\u306e\u30d2\u30b9\u30c8\u30b0\u30e9\u30e0\n\n\u753b\u50cf\u306e\u660e\u308b\u3055\u3084\u54c1\u8cea\u3092\u8abf\u3079\u308b\u305f\u3081\u306b\u3001\u753b\u50cf\u306e\u8f1d\u5ea6\u306e\u5206\u5e03\u72b6\u6cc1\u3092\u30d2\u30b9\u30c8\u30b0\u30e9\u30e0\u3092\u53d6\u308b\u3053\u3068\u304c\u3042\u308a\u307e\u3059\u3002\nYUV\u306eY\u3092\u8a08\u7b97\u3057\u305d\u306e\u5024\u3054\u3068\u3092\u30ab\u30a6\u30f3\u30c8\u3057\u3066D3.js\u3067\u30b0\u30e9\u30d5\u3092\u51fa\u529b\u3057\u3088\u3046\u3068\u601d\u3044\u307e\u3059\u3002\n\n\n````histogram.html\n<!DOCTYPE html>\n<html>\n<head>\n<script src=\"./jquery-2.1.1.min.js\"></script>\n<script src=\"http://d3js.org/d3.v3.min.js\" charset=\"utf-8\"></script>\n<script type=\"text/javascript\">\nfunction drawGraph(ys) {\n    //d3.js \u3067\u30b0\u30e9\u30d5\u3092\u63cf\u753b\u3059\u308b\u3002\n\n    //\u30b0\u30e9\u30d5\u3092\u63cf\u753b\u3059\u308bSVG\u3092\u7528\u610f\n    var w = 500;\n    var h = 300;\n    var barPadding = 1;\n    var svg = d3.select(\"body\")\n                 .append(\"svg\")\n                 .attr(\"width\", w)\n                 .attr(\"height\", h);\n\n    //\u53d7\u3051\u53d6\u3063\u305f\u30c7\u30fc\u30bf\u3092\u5143\u306b\u30d2\u30b9\u30c8\u30b0\u30e9\u30e0\u3092\u4f5c\u6210\u3059\u308b\n    svg.selectAll(\"rect\")\n        .data(ys)\n        .enter()\n        .append(\"rect\")\n        .attr(\"x\", function(d, i) {\n            return i * (w/ys.length);\n        })\n        .attr(\"y\", function(d) {\n            return h - d/8;\n        })\n        .attr(\"width\", w/ys.length - barPadding)\n        .attr(\"height\", function(d) {\n            return d/8;\n        });\n}\n\nfunction fail(e) {\n    //\u30a8\u30e9\u30fc\u306e\u6642\u306e\u30e1\u30bd\u30c3\u30c9\n    alert(e);\n}\n\nfunction getYArray(data) {\n    var ys = new Array(256);\n    for (var i = 0; i < ys.length;i++) {\n        ys[i] = 0;\n    }\n\n    for (var i = 0; i < data.length; i= i + 4) {\n        // \u8f1d\u5ea6(YUV\u306eY)\u306e\u8a08\u7b97\u3092\u884c\u3046\n        var y = ~~(0.299 * data[i] + 0.587 * data[i + 1] + 0.114 * data[i + 2]);\n        // \u8f1d\u5ea6\u306e\u5024\u3054\u3068\u306e\u30ab\u30a6\u30f3\u30c8\n        ys[y]++;\n    }\n    return ys;\n}\n\nfunction calcY() {    \n    var dfd = new $.Deferred;\n\n    var canvas = document.getElementById(\"c1\");\n    var ctx = canvas.getContext(\"2d\");\n    var img = new Image();\n    img.src = \"test.jpg\";\n    img.onload = function() {\n        ctx.drawImage(img, 0, 0);\n        var imagedata = ctx.getImageData(0, 0, canvas.width, canvas.height);\n        var ys = getYArray(imagedata.data);\n        dfd.resolve(ys);\n    };\n    return dfd.promise();\n}\n\nwindow.onload = function() {    \n    calcY().then(drawGraph, fail);\n};\n</script>\n</head>\n<body>\n<canvas id=\"c1\" width=\"300\" height=\"300\">\n</body>\n</html>\n````\n\n\u3044\u308d\u3044\u308d\u306a\u753b\u50cf\u306e\u7d50\u679c\u3092\u4ee5\u4e0b\u306b\u793a\u3057\u307e\u3059\u3002\n\u6697\u3044\u753b\u50cf\u307b\u3069\u5de6(0\u306b\u8fd1\u3044\u65b9)\u306e\u5024\u304c\u5927\u304d\u304f\u306a\u3063\u3066\u3044\u308b\u306e\u304c\u308f\u304b\u308a\u307e\u3059\u3002\n\n![histogram1.png](https://qiita-image-store.s3.amazonaws.com/0/4044/869c500d-54ac-15d6-db9f-b30d60a90ea5.png \"histogram1.png\")\n\n![histogram2.png](https://qiita-image-store.s3.amazonaws.com/0/4044/0ef32eb2-dd39-1faa-247c-f0d8b2ce82e0.png \"histogram2.png\")\n\n![histogram3.png](https://qiita-image-store.s3.amazonaws.com/0/4044/c4d9e044-d2f9-5495-3f43-806fa4c431e7.png \"histogram3.png\")\n\n\n"}