{"context": " More than 1 year has passed since last update.\n\n\u306f\u3058\u3081\u306b\n\n\u6ce8\u610f\u4e8b\u9805\n\u3053\u306e\u8a18\u4e8b\u306f\u4f55\u3089\u304b\u306e\u7406\u7531\u3067SELinux\u3092\u5229\u7528\u3057\u306a\u3051\u308c\u3070\u306a\u3089\u306a\u3044\u6642\u306b\u767a\u751f\u3059\u308b\u3001\u610f\u56f3\u305b\u305a\u30d7\u30ed\u30b0\u30e9\u30e0\u304c\u52d5\u304b\u306a\u304f\u306a\u308b\u554f\u984c\u3092\u89e3\u6c7a\u3059\u308b\u305f\u3081\u306e\u624b\u6bb5\u3092\u66f8\u3044\u305f\u3082\u306e\u3067\u3042\u308b\u3002\n\u4f5c\u696d\u5bfe\u8c61\u306eOS\u306f\u4f5c\u696d\u4e2d\u3044\u3064\u3067\u3082\u505c\u6b62\u53ef\u80fd\u3067\u3042\u308b\u3082\u306e\u3068\u3059\u308b\u3002SELinux\u306e\u8a2d\u5b9a\u4f5c\u696d\u4e2d\u306b\u505c\u6b62\u4e0d\u53ef\u80fd\u3068\u304b\u7121\u8336\u306a\u306e\u3067\u3002\n\u307e\u305f\u3001\u3059\u3079\u3066\u306e\u64cd\u4f5c\u306froot\u30e6\u30fc\u30b6\u3067\u884c\u3063\u3066\u3044\u308b\u3002SELinux\u306f\u300c\u7ba1\u7406\u8005\u306b\u3088\u308b\u5f37\u5236\u7684\u306a\u30a2\u30af\u30bb\u30b9\u5236\u5fa1\u300d\u306a\u306e\u3067root\u30e6\u30fc\u30b6\u304c\u64cd\u4f5c\u3057\u306a\u3051\u308c\u3070\u306a\u3089\u306a\u3044\u3002\n\u5185\u5bb9\u306f\u4e3b\u306bCentOS 7\u3067\u78ba\u8a8d\u3057\u3001CentOS 6\u3084Fedora 22\u3082\u4e00\u90e8\u78ba\u8a8d\u306b\u4f7f\u7528\u3057\u3066\u3044\u308b\u3002\nSELinux\u306e\u7ba1\u7406\u3067\u4f7f\u7528\u3059\u308b\u5404\u7a2e\u306e\u30b3\u30de\u30f3\u30c9\u306f\u521d\u671f\u304b\u3089\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u3066\u3044\u308b\u3082\u306e\u306f\u5c11\u306a\u304f\u3001\u307e\u305f\u30b3\u30de\u30f3\u30c9\u540d\u304c\u305d\u308c\u3092\u542b\u3080rpm\u30d1\u30c3\u30b1\u30fc\u30b8\u540d\u3068\u4e00\u81f4\u3057\u306a\u3044\u3082\u306e\u304c\u591a\u3044\u3002\n\u3053\u306e\u3088\u3046\u306a\u5834\u5408\u306fyum install *bin/<\u30b3\u30de\u30f3\u30c9\u540d>\u3067\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u308b\u3002Fedora 22\u3067\u306fdnf install /usr/*/<\u30b3\u30de\u30f3\u30c9\u540d>\u3068\u3059\u308b\u30021\n\u306a\u306e\u3067\u4ee5\u4e0b\u306e\u6587\u7ae0\u4e2d\u3067\u306f\u30b3\u30de\u30f3\u30c9\u3092\u4f7f\u3046\u306e\u306b\u3069\u306erpm\u30d1\u30c3\u30b1\u30fc\u30b8\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308c\u3070\u826f\u3044\u304b\u306f\u3044\u3061\u3044\u3061\u8a18\u8ff0\u3057\u306a\u3044\u3002\n\nSELinux\u3092\u5229\u7528\u3067\u304d\u308b\u72b6\u614b\u306b\u3059\u308b\n\nSELinux\u306e\u72b6\u614b\u306e\u78ba\u8a8d\n\u3068\u308a\u3042\u3048\u305aSELinux\u304c\u5229\u7528\u3067\u304d\u308b\u72b6\u614b\u306b\u306a\u3063\u3066\u3044\u306a\u3044\u3068\u3053\u306e\u8a18\u4e8b\u306e\u610f\u5473\u304c\u306a\u3044\u306e\u3067\u3001\u307e\u305a\u306fSELinux\u306e\u72b6\u614b\u306e\u78ba\u8a8d\u65b9\u6cd5\u3068\u3001\u5229\u7528\u3067\u304d\u308b\u72b6\u614b\u306b\u3059\u308b\u65b9\u6cd5\u3092\u8aac\u660e\u3059\u308b\u3002\n\u3082\u3063\u3068\u3082\u3053\u306e\u8fba\u308a\u306f\u5404\u7a2e\u5a92\u4f53\u3067\u826f\u304f\u898b\u304b\u3051\u308b\u3082\u306e\u3067\u3042\u308a\uff08\u4e3b\u306bSELinux\u3092\u7121\u52b9\u5316\u3059\u308b\u305f\u3081\u306b\u3001\u3060\u304c\uff09\u3001\u826f\u304f\u77e5\u3063\u3066\u3044\u308b\u306a\u3089\u3070\u8aad\u307f\u98db\u3070\u3057\u3066\u3082\u3089\u3063\u3066\u554f\u984c\u306a\u3044\u3060\u308d\u3046\u3002\nSELinux\u306e\u72b6\u614b\u306b\u306f\u6b21\u306e3\u3064\u3042\u308b\u3002\n\ndisabled\n\u7121\u52b9\u5316\u3055\u308c\u3066\u3044\u308b\npermissive\n\u6709\u52b9\u5316\u3055\u308c\u3066\u3044\u308b\u304c\u76e3\u67fb\u30ed\u30b0\u306b\u8a18\u9332\u3059\u308b\u4ee5\u5916\u306e\u50cd\u304d\u3092\u3057\u306a\u3044\nenforcing\n\u6709\u52b9\u5316\u3055\u308c\u3066\u304a\u308a\u8a2d\u5b9a\u901a\u308a\u306b\u50cd\u304f\n\nSELinux\u306e\u72b6\u614b\u3092\u78ba\u8a8d\u3059\u308b\u30b3\u30de\u30f3\u30c9\u306f\u3044\u304f\u3064\u304b\u3042\u308b\u3002\n\n\u4e00\u756a\u3088\u304f\u77e5\u3089\u308c\u3066\u3044\u308b\u306e\u306fgetenforce\u3067\u3042\u308b\u3002\u3053\u308c\u3092\u5b9f\u884c\u3059\u308b\u3068Disabled\u304bPermissive\u304bEnforcing\u304b\u304c\u6a19\u6e96\u51fa\u529b\u306b\u51fa\u529b\u3055\u308c\u308b\u3002\nselinuxenabled\u3092\u5b9f\u884c\u3059\u308b\u3068disabled\u4ee5\u5916\u306e\u5834\u5408\u30ea\u30bf\u30fc\u30f3\u30b3\u30fc\u30c9\u304c0\u306b\u306a\u308a\u3001disabled\u306e\u5834\u54081\u306b\u306a\u308b\u3002\u30ea\u30bf\u30fc\u30f3\u30b3\u30fc\u30c9\u306a\u306e\u3067\u5b9f\u884c\u5f8cecho $?\u3067\u53d6\u5f97\u3067\u304d\u308b\u3002\nsestatus\u306f\u4e00\u756a\u8a73\u7d30\u306a\u72b6\u614b\u3092\u8868\u793a\u3057\u3066\u304f\u308c\u308b\u30b3\u30de\u30f3\u30c9\u3067\u3042\u308b\u3002SELinux status\u9805\u306bdisabled\u304benabled\u304c\u3001Current mode\u9805\u306benforcing\u304bpermissive\u304b\u304c\u51fa\u529b\u3055\u308c\u308b\u3002\n\n\nSELinux\u306e\u72b6\u614b\u5909\u66f4\uff1adisabled\u304b\u3089permissive\u3078\n\u524d\u8a18\u306e\u901a\u308a\u3001\u72b6\u614b\u304cenforcing\u306e\u6642\u3060\u3051SELinux\u304c\u50cd\u3044\u3066\u304f\u308c\u308b\u306e\u3067\u3001\u307e\u305a\u306fenforcing\u306b\u3057\u3088\u3046\u3002\n\u3059\u3067\u306benforcing\u306a\u3089\u5148\u306b\u8aad\u307f\u9032\u3081\u3066\u69cb\u308f\u306a\u3044\u3002\n\u73fe\u5728\u306e\u72b6\u614b\u304cdisabled\u306e\u5834\u5408\u3001\u76f4\u63a5disabled\u304b\u3089enforcing\u306b\u5909\u66f4\u3059\u308b\u3068\u30b7\u30b9\u30c6\u30e0\u304c\u8d77\u52d5\u3057\u306a\u3044\u3053\u3068\u304c\u3042\u308a\u5f97\u308b\u306e\u3067\u3001enforcing\u306b\u3059\u308b\u524d\u306b\u307e\u305a\u306f\u4e00\u65e6permissive\u306b\u3059\u308b\u3002\npermissive\u306b\u72b6\u614b\u3092\u5909\u5316\u3055\u305b\u308b\u306b\u306f /etc/selinux/config \u306eSELINUX=\u884c\u304c\"SELINUX=permissive\"\u3068\u306a\u308b\u3088\u3046\u306b\u66f8\u304d\u63db\u3048\u3001\u305d\u306e\u5f8cOS\u3092\u518d\u8d77\u52d5\u3059\u308b\u3002\n\nSELinux\u306e\u72b6\u614b\u5909\u66f4\uff1apermissive\u304b\u3089enforcing\u3078\npermissive\u304b\u3089enforcing\u306b\u3059\u308b\u306b\u306f\u6b21\u3092\u5b9f\u884c\u3059\u308b\u3002\n# setenforce 1\n\n\u9006\u306benforcing\u304b\u3089permissive\u306b\u3059\u308b\u5834\u5408\u306fsetenforce 0\u3067\u3042\u308b\u3002\n\u3053\u306e\u3088\u3046\u306bSELinux\u306e\u72b6\u614b\u3092permissive\u304b\u3089enforcing\u3001\u3042\u308b\u3044\u306f\u305d\u306e\u9006\u306benforcing\u304b\u3089permissive\u306b\u3059\u308b\u5834\u5408\u306fOS\u518d\u8d77\u52d5\u306f\u4e0d\u8981\u3060\u304c\u3001OS\u518d\u8d77\u52d5\u3092\u3059\u308b\u3068 /etc/selinux/config \u306eSELINUX=\u884c\u306e\u72b6\u614b\u306b\u623b\u3063\u3066\u3057\u307e\u3046\u306e\u3067\u3001OS\u518d\u8d77\u52d5\u5f8c\u3082enforcing\u306e\u307e\u307e\u306b\u3059\u308b\u306b\u306f /etc/selinux/config \u304c\"SELINUX=enforcing\"\u3068\u306a\u308b\u3088\u3046\u306b\u66f8\u304d\u63db\u3048\u308b\u3002\n\n/etc/selinux/config\u3092\u66f8\u304d\u63db\u3048\u308b\u969b\u306e\u6ce8\u610f\n/etc/selinux/config \u3067\u306f\u306a\u304f /etc/sysconfig/selinux \u3092\u66f8\u304d\u63db\u3048\u308d\u3001\u3068\u3057\u3066\u3044\u308b\u6587\u66f8\u3082\u3042\u308b\u304c\u3001\u5b9f\u969b\u306b\u306f /etc/sysconfig/selinux \u306f /etc/selinux/config \u306e\u30b7\u30f3\u30dc\u30ea\u30c3\u30af\u30ea\u30f3\u30af\u3067\u3042\u308b\u3002\n\u30b7\u30f3\u30dc\u30ea\u30c3\u30af\u30ea\u30f3\u30af\u3067\u3042\u308b /etc/sysconfig/selinux \u306b\u5bfe\u3057\u3066sed\u3092--follow-symlinks\u30aa\u30d7\u30b7\u30e7\u30f3\u3084--copy(-C)\u30aa\u30d7\u30b7\u30e7\u30f3\u3092\u4ed8\u3051\u305a\u306b\u5b9f\u884c\u3059\u308b\u3001\u3042\u308b\u3044\u306fcp -a\u3067\u4e0a\u66f8\u304d\u3059\u308b\u306a\u3069\u3059\u308b\u3068\u3001 /etc/sysconfig/selinux \u306f\u30b7\u30f3\u30dc\u30ea\u30c3\u30af\u30ea\u30f3\u30af\u304b\u3089\u5b9f\u30d5\u30a1\u30a4\u30eb\u306b\u5909\u5316\u3057 /etc/selinux/config \u306b\u306f\u53cd\u6620\u3055\u308c\u306a\u3044\u305f\u3081\u8a2d\u5b9a\u3092\u5909\u66f4\u3057\u305f\u3053\u3068\u306b\u306f\u306a\u3089\u306a\u3044\u3002\n\u307e\u305f\u3001 /etc/selinux/config \u306eSELINUX=\u884c\u4ee5\u5916\u3092\u8aa4\u3063\u3066\u5909\u66f4\u3057\u3066\u306f\u306a\u3089\u306a\u3044\u3002\n\u8aa4\u3063\u3066\u5909\u66f4\u3057\u305f\u5834\u5408\u306b\u8d77\u3053\u308b\u3053\u3068\u306e\u4f8b\u306f http://qiita.com/MurabitoK/items/d44fc01b9e1ac2fdcfab \u306e\u3088\u3046\u306a\u3053\u3068\u3067\u3001\u3053\u3053\u306b\u306f\u305d\u306e\u5fa9\u65e7\u65b9\u6cd5\u3082\u66f8\u304b\u308c\u3066\u3044\u308b\u3002\n\n\u306a\u305cSELinux\u306b\u3088\u3063\u3066\u30d7\u30ed\u30b0\u30e9\u30e0\u306f\u610f\u56f3\u305b\u305a\u52d5\u304b\u306a\u304f\u306a\u308b\u306e\u304b\n\nType Enforcement\n\u3055\u3066\u3001\u3053\u3053\u304b\u3089\u304c\u672c\u984c\u3067\u3042\u308b\u3002\n\u306a\u305cSELinux\u306b\u3088\u3063\u3066\u30d7\u30ed\u30b0\u30e9\u30e0\u304c\u3053\u3061\u3089\u306e\u610f\u56f3\u306b\u53cd\u3057\u3066\u52d5\u304b\u306a\u304f\u306a\u308b\u3053\u3068\u304c\u3042\u308b\u306e\u3060\u308d\u3046\u304b\u3002\n\u305d\u308c\u306fSELinux\u304cenforcing\u306e\u5834\u5408\u3001\u30d7\u30ed\u30bb\u30b9\u304b\u3089\u30d5\u30a1\u30a4\u30eb\u3084\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3001\u30bd\u30b1\u30c3\u30c8\u306a\u3069\uff08SELinux\u306e\u7528\u8a9e\u3067\u306f\u3053\u308c\u3089\u3092\u307e\u3068\u3081\u3066\u30ea\u30bd\u30fc\u30b9\u3001\u7a2e\u985e1\u30641\u3064\u3092\u30af\u30e9\u30b9\u3068\u547c\u3076\uff09\u306b\u30a2\u30af\u30bb\u30b9\u3067\u304d\u308b\u306e\u304c\u8a31\u53ef\u3055\u308c\u305f\u5834\u5408\u3060\u3051\u306b\u306a\u308b\u304b\u3089\u3067\u3042\u308b\u3002\n\u3053\u306e\u4ed5\u7d44\u307f\u3092Type Enforcement\uff08\u4ee5\u4e0b\u3001TE\uff09\u3068\u547c\u3076\u3002\nTE\u306fchmod\u3067\u8a2d\u5b9a\u3059\u308b\u30d5\u30a1\u30a4\u30eb\u306e\u30d1\u30fc\u30df\u30c3\u30b7\u30e7\u30f3\u3068\u306f\u5225\u306b\u884c\u308f\u308c\u308b\u3082\u3046\u4e00\u3064\u306e\u30a2\u30af\u30bb\u30b9\u5236\u5fa1\u3067\u3042\u308a\u3001SELinux\u304cenforcing\u306e\u5834\u5408\u3001\u30d5\u30a1\u30a4\u30eb\u306e\u30d1\u30fc\u30df\u30c3\u30b7\u30e7\u30f3\u306b\u3088\u308b\u30a2\u30af\u30bb\u30b9\u5236\u5fa1\u3068TE\u306b\u3088\u308b\u30a2\u30af\u30bb\u30b9\u5236\u5fa1\u3068\u306e\u4e21\u65b9\u3092\u901a\u904e\u3057\u306a\u3044\u3068\u30a2\u30af\u30bb\u30b9\u306f\u6210\u529f\u3057\u306a\u3044\u3068\u3044\u3046\u308f\u3051\u3060\u3002\nTE\u306b\u3088\u308b\u30a2\u30af\u30bb\u30b9\u5236\u5fa1\u306froot\u30e6\u30fc\u30b6\u306b\u3082\u9069\u7528\u3055\u308c\u308b\u3002\u3042\u308b\u30d7\u30ed\u30bb\u30b9\u306e\u8106\u5f31\u6027\u3092\u7a81\u304b\u308c\u3066root\u30e6\u30fc\u30b6\u3078\u306e\u6a29\u9650\u6607\u683c\u3092\u8a31\u3059\u306a\u3069\u3057\u3066\u3082\u3001\u305d\u306e\u30d7\u30ed\u30bb\u30b9\u306e\u30c9\u30e1\u30a4\u30f3\u306b\u8a31\u53ef\u3055\u308c\u3066\u3044\u306a\u3044\u30ea\u30bd\u30fc\u30b9\u3078\u306e\u30a2\u30af\u30bb\u30b9\u3092\u9632\u3050\u3001\u3068\u3044\u3046\u306e\u304cTE\u306e\u72d9\u3044\u3067\u3042\u308b\u3002\n\n\u30c9\u30e1\u30a4\u30f3\u3068\u30bf\u30a4\u30d7\nSELinux\u306e\u4e16\u754c\u3067\u306f\u3001\u3059\u3079\u3066\u306e\u30d7\u30ed\u30bb\u30b9\u3068\u30ea\u30bd\u30fc\u30b9\u306fSELinux\u30b3\u30f3\u30c6\u30ad\u30b9\u30c8\u3068\u547c\u3070\u308c\u308b\u3082\u306e\u3067\u30e9\u30d9\u30eb\u4ed8\u3051\u3055\u308c\u3066\u3044\u308b\u3002\nps\u30b3\u30de\u30f3\u30c9\u306b-Z\u30aa\u30d7\u30b7\u30e7\u30f3\u3092\u4ed8\u3051\u308c\u3070\u30d7\u30ed\u30bb\u30b9\u306eSELinux\u30b3\u30f3\u30c6\u30ad\u30b9\u30c8\u3092\u898b\u308b\u3053\u3068\u304c\u3067\u304d\u308b\u3002\n# ps -eZ\nLABEL                             PID TTY          TIME CMD\nsystem_u:system_r:init_t:s0         1 ?        00:00:02 systemd\nsystem_u:system_r:kernel_t:s0       2 ?        00:00:00 kthreadd\n\uff08\u9577\u3044\u306e\u3067\u4e2d\u7565\uff09\nsystem_u:system_r:sshd_t:s0-s0:c0.c1023 4840 ? 00:00:00 sshd\nsystem_u:system_r:sshd_t:s0-s0:c0.c1023 4844 ? 00:00:00 sshd\nunconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023 4846 ? 00:00:00 sshd\nunconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023 4849 pts/0 00:00:00 bash\nunconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023 4852 ? 00:00:00 sshd\nunconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023 4860 ? 00:00:00 sftp-server\nunconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023 4898 pts/0 00:00:00 sudo\nunconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023 4899 pts/0 00:00:00 bash\nsystem_u:system_r:kernel_t:s0   31494 ?        00:00:00 bioset\n\nls\u30b3\u30de\u30f3\u30c9\u306b-Z\u30aa\u30d7\u30b7\u30e7\u30f3\u3092\u4ed8\u3051\u308c\u3070\u30d5\u30a1\u30a4\u30eb\u306a\u3069\u306eSELinux\u30b3\u30f3\u30c6\u30ad\u30b9\u30c8\u3092\u898b\u308b\u3053\u3068\u304c\u3067\u304d\u308b\u3002\n# ls -Z /tmp\n-rwx------. root    root    system_u:object_r:initrc_tmp_t:s0 ks-script-6Tm7iL\n-rwx------. root    root    system_u:object_r:initrc_tmp_t:s0 ks-script-wKtOJm\n-rwxrwxrwx. vagrant vagrant unconfined_u:object_r:user_tmp_t:s0 script.sh\n-rwxrwxr-x. vagrant vagrant unconfined_u:object_r:user_tmp_t:s0 vagrant-shell\n-rw-r--r--. root    root    unconfined_u:object_r:user_tmp_t:s0 vboxguest-Module.symvers\n-rw-------. root    root    system_u:object_r:initrc_tmp_t:s0 yum.log\n\nSELinux\u30b3\u30f3\u30c6\u30ad\u30b9\u30c8\u306f:\u3067\u533a\u5207\u3089\u308c\u305f\u300c(_u\u3067\u7d42\u308f\u308b\u3082\u306e):(_r\u3067\u7d42\u308f\u308b\u3082\u306e):(_t\u3067\u7d42\u308f\u308b\u3082\u306e):(s\u6570\u5b57\u3067\u59cb\u307e\u308b\u3082\u306e):(c\u6570\u5b57\u3067\u59cb\u307e\u308b\u3082\u306e\u3002\u4e00\u90e8\u306e\u307f)\u300d\u306e\u90e8\u5206\u3067\u3042\u308b\u3002\n\u3053\u306e\u4e2d\u3067_t\u3067\u7d42\u308f\u308b\u3082\u306e\u304c\u30d7\u30ed\u30bb\u30b9\u3084\u30ea\u30bd\u30fc\u30b9\u306e\u30bf\u30a4\u30d7\u3067\u3042\u308b\u3002\u305d\u308c\u305e\u308c\u306e\u30d7\u30ed\u30bb\u30b9\u3084\u30ea\u30bd\u30fc\u30b9\u306f\u30bf\u30a4\u30d7\u30921\u3064\u3060\u3051\u6301\u3064\u3002\n\u30d7\u30ed\u30bb\u30b9\u306e\u30bf\u30a4\u30d7\u306f\u7279\u306b\u30c9\u30e1\u30a4\u30f3\u3068\u547c\u3073\u3001\u30ea\u30bd\u30fc\u30b9\u306e\u30bf\u30a4\u30d7\u3068\u306f\u533a\u5225\u3059\u308b\u306e\u3067\u3001\u3053\u3053\u3067\u3082\u4ee5\u4e0b\u305d\u3046\u547c\u3076\u3053\u3068\u306b\u3059\u308b\u3002\n\u3053\u306e\u8a18\u4e8b\u3067\u8a9e\u308b\u7bc4\u56f2\u5185\u306e\u8a71\u3067\u306fSELinux\u30b3\u30f3\u30c6\u30ad\u30b9\u30c8\u306e\u3046\u3061_t\u3067\u7d42\u308f\u308b\u3082\u306e\u3057\u304b\u4f7f\u308f\u306a\u3044\u3057\u4f7f\u308f\u308c\u306a\u3044\u3057\u306a\u306e\u3067\u4ed6\u306f\u5fd8\u308c\u3066\u826f\u3044\u3002\n\nTE\u306b\u3088\u308b\u30a2\u30af\u30bb\u30b9\u5236\u5fa1\nTE\u306f\u30db\u30ef\u30a4\u30c8\u30ea\u30b9\u30c8\u65b9\u5f0f\u3067\u3042\u308a\u3001\u30eb\u30fc\u30eb\u304c\u5b9a\u7fa9\u3055\u308c\u3066\u3044\u306a\u3044\u3059\u3079\u3066\u306e\u30a2\u30af\u30bb\u30b9\u306f\u300c\u30a2\u30af\u30bb\u30b9\u3092\u8a31\u53ef\u305b\u305a\u3001\u30a2\u30af\u30bb\u30b9\u304c\u8a66\u307f\u3089\u308c\u305f\u5834\u5408\u76e3\u67fb\u30ed\u30b0\u306b\u8a18\u9332\u3059\u308b\u300d\u3053\u3068\u306b\u306a\u3063\u3066\u3044\u308b\u3002\n\u30eb\u30fc\u30eb\u306e\u8a2d\u5b9a\u306f\u300c\u3069\u306e\u30c9\u30e1\u30a4\u30f3\u304c\u3001\u3069\u306e\u30bf\u30a4\u30d7\u306e\u3001\u3069\u306e\u30af\u30e9\u30b9\u306b\u3001\u3069\u306e\u64cd\u4f5c\u3092\u300d\u3068\u3044\u3046\u5358\u4f4d\u3054\u3068\u306b\u6b21\u306e3\u7a2e\u985e\u306e\u6307\u5b9a\u3092\u884c\u3046\u3053\u3068\u304c\u3067\u304d\u308b\u30022\n\nallow\n\u30a2\u30af\u30bb\u30b9\u3092\u8a31\u53ef\u3057\u3001\u30a2\u30af\u30bb\u30b9\u304c\u8a66\u307f\u3089\u308c\u305f\u5834\u5408\u76e3\u67fb\u30ed\u30b0\u306b\u8a18\u9332\u3057\u306a\u3044\nauditallow\n\u30a2\u30af\u30bb\u30b9\u3092\u8a31\u53ef\u3057\u3001\u30a2\u30af\u30bb\u30b9\u304c\u8a66\u307f\u3089\u308c\u305f\u5834\u5408\u76e3\u67fb\u30ed\u30b0\u306b\u8a18\u9332\u3059\u308b\ndontaudit\n\u30a2\u30af\u30bb\u30b9\u3092\u8a31\u53ef\u305b\u305a\u3001\u30a2\u30af\u30bb\u30b9\u304c\u8a66\u307f\u3089\u308c\u305f\u5834\u5408\u76e3\u67fb\u30ed\u30b0\u306b\u8a18\u9332\u3057\u306a\u3044\n\n\u30a2\u30af\u30bb\u30b9\u3092\u8a31\u53ef\u3059\u308b\u30fb\u8a31\u53ef\u3057\u306a\u3044\u3068\u3044\u3046\u89b3\u70b9\u3068\u76e3\u67fb\u30ed\u30b0\u306b\u8a18\u9332\u3059\u308b\u30fb\u8a18\u9332\u3057\u306a\u3044\u3068\u3044\u3046\u89b3\u70b9\u3067\u30012x2\u3067\u6307\u5b9a\u306a\u3057\u3082\u542b\u3081\u3066\u5408\u308f\u305b\u30664\u7a2e\u985e\u3068\u3044\u3046\u308f\u3051\u3060\u3002\n\u500b\u3005\u306e\u30eb\u30fc\u30eb\u3092SELinux\u3067\u306f\u30a2\u30af\u30bb\u30b9\u30d9\u30af\u30bf\u30eb\u30fc\u30eb\u3068\u547c\u3093\u3067\u3044\u308b\u3002\n\u30a2\u30af\u30bb\u30b9\u30d9\u30af\u30bf\u30eb\u30fc\u30eb\u304c1\u3064\u3082\u5b9a\u7fa9\u3055\u308c\u3066\u3044\u306a\u3044\u72b6\u614b\u3067\u306f\u307e\u3063\u305f\u304f\u4f55\u3082\u52d5\u304b\u306a\u3044\u306e\u3067\u3001selinux-policy-xx\u30d1\u30c3\u30b1\u30fc\u30b8\uff08xx\u306f /etc/selinux/config \u306eSELINUXTYPE=\u884c\u306e\u5024\uff09\u306b\u3088\u3063\u3066\u63d0\u4f9b\u3055\u308c\u308b\u30eb\u30fc\u30eb\u306b\u3088\u3063\u3066\u30b7\u30b9\u30c6\u30e0\u3092\u52d5\u304b\u3059\u3053\u3068\u306b\u306a\u308b\u3002\n\u3064\u307e\u308aSELinux\u306b\u3088\u3063\u3066\u30d7\u30ed\u30b0\u30e9\u30e0\u304c\u3053\u3061\u3089\u306e\u610f\u56f3\u306b\u53cd\u3057\u3066\u52d5\u304b\u306a\u304f\u306a\u308b\u72b6\u614b\u3068\u306f\u3001selinux-policy-xx\u30d1\u30c3\u30b1\u30fc\u30b8\u306b\u3088\u3063\u3066allow\u3042\u308b\u3044\u306fauditallow\u3055\u308c\u305f\u30a2\u30af\u30bb\u30b9\u30d9\u30af\u30bf\u30eb\u30fc\u30eb\u4ee5\u5916\u306e\u3053\u3068\u3092\u5b9f\u884c\u3057\u3088\u3046\u3068\u3057\u305f\u72b6\u614b\u3001\u3068\u3044\u3046\u308f\u3051\u3060\u3002\n\nSELinux\u306e\u305b\u3044\u3067\u52d5\u304b\u306a\u3044\u3068\u601d\u3063\u305f\u6642\u306b\u4f55\u3092\u3059\u308c\u3070\u826f\u3044\u304b\n\n\u305d\u306e\u554f\u984c\u304cSELinux\u306e\u305b\u3044\u304b\u3069\u3046\u304b\u3092\u898b\u5206\u3051\u308b\n\u30d7\u30ed\u30b0\u30e9\u30e0\u304c\u3053\u3061\u3089\u306e\u610f\u56f3\u306b\u53cd\u3057\u3066\u52d5\u304b\u306a\u3044\u5834\u5408\u3001\u307e\u305a\u306f\u305d\u308c\u304cSELinux\u306b\u3088\u3063\u3066\u30a2\u30af\u30bb\u30b9\u304c\u62d2\u5426\u3055\u308c\u305f\u305b\u3044\u304b\u3069\u3046\u304b\u3092\u898b\u6975\u3081\u308b\u5fc5\u8981\u304c\u3042\u308b\u3002\n\u305d\u306e\u305f\u3081\u306b\u306fSELinux\u306e\u72b6\u614b\u3092setenforce 0\u3067\u4e00\u6642\u7684\u306bpermissive\u306b\u3057\u3001\u305d\u308c\u3067\u52d5\u304f\u3088\u3046\u306b\u306a\u308c\u3070SELinux\u304c\u539f\u56e0\u3067\u3042\u308b\u3068\u8a00\u3048\u308b\u3002\n\u30d5\u30a1\u30a4\u30eb\u306e\u30d1\u30fc\u30df\u30c3\u30b7\u30e7\u30f3\u306b\u3088\u308b\u30a2\u30af\u30bb\u30b9\u5236\u5fa1\u306fTE\u306b\u3088\u308b\u30a2\u30af\u30bb\u30b9\u5236\u5fa1\u3088\u308a\u5148\u306b\u5224\u5b9a\u3055\u308c\u308b\u3002\n\u5f93\u3063\u3066\u30d5\u30a1\u30a4\u30eb\u306e\u30d1\u30fc\u30df\u30c3\u30b7\u30e7\u30f3\u3092\u89e3\u6c7a\u3057\u305f\u5f8c\u306b\u306a\u3063\u3066SELinux\u306b\u3088\u308b\u554f\u984c\u304c\u9855\u5728\u5316\u3059\u308b\u3053\u3068\u3082\u3042\u308b\u3002\npermissive\u306b\u5909\u66f4\u3059\u308b\u306e\u306b\u306f\u3082\u3046\u4e00\u3064\u610f\u5473\u304c\u3042\u308b\u3002\nenforcing\u306e\u72b6\u614b\u3067\u306fSELinux\u306b\u3088\u308b\u8907\u6570\u306e\u554f\u984c\u304c\u3042\u3063\u305f\u5834\u5408\u3001\u6700\u521d\u306b\u5f53\u305f\u3063\u305f\u554f\u984c\u306e\u6642\u70b9\u3067\u51e6\u7406\u304c\u7d42\u4e86\u3057\u3001\u76e3\u67fb\u30ed\u30b0\u306b\u305d\u308c\u3057\u304b\u6b8b\u3089\u306a\u3044\u306e\u3067\u305d\u306e\u5206\u3092\u89e3\u6c7a\u3057\u3066\u3082\u307e\u305f\u3059\u3050\u306b\u6b21\u306e\u554f\u984c\u306b\u5f53\u305f\u308b\u3053\u3068\u306b\u306a\u308b\u3002\npermissive\u306b\u3057\u305f\u5834\u5408\u3001\u8907\u6570\u306e\u554f\u984c\u304c\u76e3\u67fb\u30ed\u30b0\u306b\u6b8b\u308b\u306e\u3067\u4e00\u62ec\u3057\u3066\u89e3\u6c7a\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u308b\u3002\n\u3082\u3061\u308d\u3093permissive\u306b\u3059\u308b\u306e\u306f\u4e00\u6642\u7684\u306a\u3053\u3068\u3067\u3042\u308a\u3001\u554f\u984c\u3092\u89e3\u6c7a\u3059\u308b\u305f\u3081\u306e\u30a2\u30af\u30b7\u30e7\u30f3\u3092\u53d6\u3063\u305f\u5f8csetenforce 1\u3067enforcing\u306b\u623b\u3057\u3066\u5b9f\u969b\u306b\u554f\u984c\u304c\u89e3\u6c7a\u3057\u3066\u3044\u308b\u304b\u3069\u3046\u304b\u3092\u78ba\u8a8d\u3059\u308b\u5fc5\u8981\u304c\u3042\u308b\u3002\n\n\u76e3\u67fb\u30ed\u30b0\u3092\u78ba\u8a8d\u3059\u308b\nSELinux\u306b\u3088\u3063\u3066\u554f\u984c\u304c\u767a\u751f\u3057\u305f\u5834\u5408\u3001\u76e3\u67fb\u30ed\u30b0\u3092\u78ba\u8a8d\u3059\u308b\u3053\u3068\u306b\u3088\u3063\u3066\u305d\u306e\u554f\u984c\u304c\u3069\u306e\u3088\u3046\u306a\u3082\u306e\u304b\u3092\u77e5\u308b\u3053\u3068\u304c\u3067\u304d\u308b\u3002\n\u76e3\u67fb\u30ed\u30b0\u306fauditd\u30b5\u30fc\u30d3\u30b9\u306b\u3088\u3063\u3066\u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u306f /var/log/audit/audit.log \u306b\u51fa\u529b\u3055\u308c\u3066\u3044\u308b\u3002\ntype=AVC msg=audit(1436807141.396:399): avc:  denied  { open } for  pid=2363 comm=\"httpd\" path=\"/var/www/html/1.html\" dev=\"dm-4\" ino=19923324 scontext=system_u:system_r:httpd_t:s0 tcontext=unconfined_u:object_r:user_tmp_t:s0 tclass=file\ntype=SYSCALL msg=audit(1436807141.396:399): arch=c000003e syscall=2 success=no exit=-13 a0=7fbf95c62290 a1=80000 a2=0 a3=7ffe31bbf530 items=0 ppid=1277 pid=2363 auid=4294967295 uid=48 gid=48 euid=48 suid=48 fsuid=48 egid=48 sgid=48 fsgid=48 tty=(none) ses=4294967295 comm=\"httpd\" exe=\"/usr/sbin/httpd\" subj=system_u:system_r:httpd_t:s0 key=(null)\n\n\u898b\u308b\u3079\u304d\u306ftype=AVC\u3067\u59cb\u307e\u308b\u884c\u3067\u3042\u308b\u3002\u6b21\u306e\u3088\u3046\u306a\u610f\u5473\u306b\u306a\u308a\u3001\u3069\u306e\u3088\u3046\u306a\u554f\u984c\u304c\u767a\u751f\u3057\u305f\u306e\u304b\u3092\u5224\u5225\u3067\u304d\u308b\u3002\n\ndenied  { }\n{ }\u5185\u306e\u64cd\u4f5c\u304c\u62d2\u5426\u3055\u308c\u305f\ncomm\n\u30d7\u30ed\u30bb\u30b9\u306e\u30b3\u30de\u30f3\u30c9\u540d\npath\u306a\u3069\u3044\u308d\u3044\u308d\n\u30a2\u30af\u30bb\u30b9\u3055\u308c\u305f\u30ea\u30bd\u30fc\u30b9\nscontext\n\u30d7\u30ed\u30bb\u30b9\u306eSELinux\u30b3\u30f3\u30c6\u30ad\u30b9\u30c8\ntcontext\n\u30a2\u30af\u30bb\u30b9\u3055\u308c\u305f\u30ea\u30bd\u30fc\u30b9\u306eSELinux\u30b3\u30f3\u30c6\u30ad\u30b9\u30c8\ntclass\n\u30a2\u30af\u30bb\u30b9\u3055\u308c\u305f\u30ea\u30bd\u30fc\u30b9\u306e\u30af\u30e9\u30b9\n\n\u76e3\u67fb\u30ed\u30b0\u306fausearch -m avc\u3067\u898b\u308b\u3053\u3068\u3082\u3067\u304d\u308b\u3002\u767a\u751f\u65e5\u6642\u304c\u308f\u304b\u308a\u3084\u3059\u3044\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u3067\u8868\u793a\u3055\u308c\u308b\u5206\u3053\u3061\u3089\u306e\u65b9\u304c\u826f\u3044\u3068\u601d\u3046\u3002\ntime->Tue Jul 14 02:05:41 2015\ntype=SYSCALL msg=audit(1436807141.396:399): arch=c000003e syscall=2 success=no exit=-13 a0=7fbf95c62290 a1=80000 a2=0 a3=7ffe31bbf530 items=0 ppid=1277 pid=2363 auid=4294967295 uid=48 gid=48 euid=48 suid=48 fsuid=48 egid=48 sgid=48 fsgid=48 tty=(none) ses=4294967295 comm=\"httpd\" exe=\"/usr/sbin/httpd\" subj=system_u:system_r:httpd_t:s0 key=(null)\ntype=AVC msg=audit(1436807141.396:399): avc:  denied  { open } for  pid=2363 comm=\"httpd\" path=\"/var/www/html/1.html\" dev=\"dm-4\" ino=19923324 scontext=system_u:system_r:httpd_t:s0 tcontext=unconfined_u:object_r:user_tmp_t:s0 tclass=file\n\n\u307e\u305fausearch\u306b\u306f\u8c4a\u5bcc\u306a\u7d5e\u308a\u8fbc\u307f\u30aa\u30d7\u30b7\u30e7\u30f3\u304c\u3042\u308a\u3001\u4f8b\u3048\u3070-ts\u30aa\u30d7\u30b7\u30e7\u30f3\u306f\u6307\u5b9a\u3057\u305f\u65e5\u6642\u4ee5\u964d\u306e\u76e3\u67fb\u30ed\u30b0\u3060\u3051\u3092\u51fa\u529b\u3059\u308b\u3002\n\u3053\u306e\u65e5\u6642\u306fmm/dd/YYYY HH:MM:SS\u306e\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u3067\u6307\u5b9a\u3059\u308b\u3002\u3053\u308c\u3089\u3092\u30af\u30a9\u30fc\u30c8\u3067\u56f2\u3093\u3067\u306f\u306a\u3089\u306a\u3044\u3002\u65e5\u4ed8\u3092\u7701\u7565\u3057\u305f\u5834\u5408\u306f\u300c\u4eca\u65e5\u306e\u6307\u5b9a\u3057\u305f\u6642\u523b\u300d\u3001\u6642\u523b\u3092\u7701\u7565\u3057\u305f\u5834\u5408\u306f\u300c\u6307\u5b9a\u65e5\u306e0\u6642\u3061\u3087\u3046\u30693\u300d\u3068\u3057\u3066\u6271\u308f\u308c\u308b\u3002\u65e5\u4ed8\u306e\u4ee3\u308f\u308a\u306btoday\u3068\u304byesterday\u3068\u304b\u3067\u6307\u5b9a\u3082\u3067\u304d\u308b\u3002\n\u3068\u3053\u308d\u3067\u3001\u30a2\u30af\u30bb\u30b9\u304c\u62d2\u5426\u3055\u308c\u3066\u3044\u308b\u306e\u306b\u76e3\u67fb\u30ed\u30b0\u306b\u306f\u6b8b\u3089\u306a\u3044dontaudit\u3068\u3044\u3046\u30a2\u30af\u30bb\u30b9\u30d9\u30af\u30bf\u30eb\u30fc\u30eb\u306e\u7a2e\u985e\u304c\u3042\u308b\u3053\u3068\u3092\u8aac\u660e\u3057\u305f\u3002\n\u76e3\u67fb\u30ed\u30b0\u306b\u8a18\u9332\u3055\u308c\u3066\u3044\u306a\u3044\u3053\u3068\u306b\u306f\u5bfe\u51e6\u3067\u304d\u306a\u3044\u306e\u3067\u3001enforcing\u6642\u306b\u30a2\u30af\u30bb\u30b9\u62d2\u5426\u3055\u308c\u308b\u306e\u306b\u76e3\u67fb\u30ed\u30b0\u306b\u306f\u4e8b\u8c61\u304c\u8a18\u9332\u3055\u308c\u3066\u3044\u306a\u3044\u3088\u3046\u306a\u3089dontaudit\u30eb\u30fc\u30eb\u3092\u7121\u52b9\u5316\u3057\u3066\u3057\u307e\u3046\u306e\u304c\u826f\u3044\u3002\n\u6b21\u306e\u30b3\u30de\u30f3\u30c9\u3067\u3059\u3079\u3066\u306edontaudit\u30eb\u30fc\u30eb\u3092\u7121\u52b9\u5316\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u308b\u3002\n# semodule -DB\n\n\u3057\u304b\u3057dontaudit\u30eb\u30fc\u30eb\u304c\u7121\u52b9\u5316\u3055\u308c\u3066\u3044\u308b\u3068\u3001\u6b21\u306e\u9805\u3067\u8aac\u660e\u3059\u308bsetroubleshoot\u304c\u50cd\u304b\u306a\u304f\u306a\u308b\u3088\u3046\u306a\u306e\u3067\u4f7f\u3044\u5206\u3051\u304c\u5fc5\u8981\u306b\u306a\u308b\u3002\n\u3059\u3079\u3066\u306edontaudit\u30eb\u30fc\u30eb\u3092\u518d\u5ea6\u6709\u52b9\u5316\u3059\u308b\u306b\u306f\u6b21\u306e\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3059\u308b\u3002\n# semodule -B\n\n\nsetroubleshoot\n\u76e3\u67fb\u30ed\u30b0\u3092\u898b\u3066\u554f\u984c\u306e\u539f\u56e0\u304c\u5224\u660e\u3059\u308c\u3070\u3001\u6b21\u306e\u3088\u3046\u306a\u30a2\u30af\u30b7\u30e7\u30f3\u3092\u884c\u3044\u89e3\u6c7a\u3092\u76ee\u6307\u3059\u3053\u3068\u306b\u306a\u308b\u3002\n\nSELinux\u30d6\u30fc\u30eb\u5024\u3092\u5909\u66f4\u3057\u3001\u30a2\u30af\u30bb\u30b9\u30d9\u30af\u30bf\u30eb\u30fc\u30eb\u3092\u8ffd\u52a0\u9069\u7528\u3059\u308b\n\u30ea\u30bd\u30fc\u30b9\u306e\u30bf\u30a4\u30d7\u3092\u6b63\u3057\u3044\u3082\u306e\u306b\u76f4\u3059\n\u76e3\u67fb\u30ed\u30b0\u304b\u3089\u30a2\u30af\u30bb\u30b9\u30d9\u30af\u30bf\u30eb\u30fc\u30eb\u3092\u751f\u6210\u3057\u9069\u7528\u3059\u308b\n\n\u500b\u3005\u306e\u8aac\u660e\u306f\u5f8c\u7a0b\u884c\u3046\u304c\u3001\u3053\u308c\u3089\u306e\u3046\u3061\u3069\u306e\u30a2\u30af\u30b7\u30e7\u30f3\u3092\u9078\u629e\u3059\u308c\u3070\u826f\u3044\u304b\u306e\u6307\u91dd\u3092\u4e0e\u3048\u3066\u304f\u308c\u308bsetroubleshoot\uff08\u5b9f\u884c\u30d5\u30a1\u30a4\u30eb\u540d\u306fsetroubleshootd\uff09\u3068\u3044\u3046\u3082\u306e\u304c\u3042\u308b\u3002\nsetroubleshoot\u306f\u76e3\u67fb\u30ed\u30b0\u304c\u51fa\u529b\u3055\u308c\u308b\u30bf\u30a4\u30df\u30f3\u30b0\u3067\u305d\u306e\u5bfe\u5fdc\u65b9\u6cd5\u3092\u5c0e\u304d\u51fa\u3057 /var/log/messages \u306b\u51fa\u529b\u3057\u3066\u304f\u308c\u308b\u3082\u306e\u3067\u3042\u308b\u3002\nsetroubleshoot\u3092\u5229\u7528\u3059\u308b\u306b\u306fsetroubleshoot-server\u30d1\u30c3\u30b1\u30fc\u30b8\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\u30024\n\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u5f8c\u3001TE\u306e\u30a2\u30af\u30bb\u30b9\u5236\u5fa1\u306b\u5f15\u3063\u304b\u304b\u308a\u76e3\u67fb\u30ed\u30b0\u304c\u51fa\u529b\u3055\u308c\u305f\u6642\u306b /var/log/messages \uff08Fedora 22\u3067\u306fjournalctl\u3092\u898b\u305f\u65b9\u304c\u826f\u3044\uff09\u306e\u4e2d\u306b1\u3064\u306e\u30bf\u30a4\u30e0\u30b9\u30bf\u30f3\u30d7\u306b\u5bfe\u3059\u308b\u51fa\u529b\u3068\u3057\u3066\u6b21\u306e\u3088\u3046\u306a\u30ed\u30b0\u304c\u73fe\u308c\u308b\u3002\nJul 14 22:06:36 localhost python: SELinux is preventing /usr/sbin/httpd from name_connect access on the tcp_socket port 25151.\n\n***** Plugin catchall_boolean (47.5 confidence) suggests ******************\n\nIf you want to allow httpd to can network connect cobbler\nThen you must tell SELinux about this by enabling the 'httpd_can_network_connect_cobbler' boolean.\n\nDo\nsetsebool -P httpd_can_network_connect_cobbler 1\n\n***** Plugin catchall_boolean (47.5 confidence) suggests ******************\n\nIf you want to allow httpd to can network connect\nThen you must tell SELinux about this by enabling the 'httpd_can_network_connect' boolean.\n\nDo\nsetsebool -P httpd_can_network_connect 1\n\n***** Plugin catchall (6.38 confidence) suggests **************************\n\nIf you believe that httpd should be allowed name_connect access on the port 25151 tcp_socket by default.\nThen you should report this as a bug.\nYou can generate a local policy module to allow this access.\nDo\nallow this access for now by executing:\n# grep httpd /var/log/audit/audit.log | audit2allow -M mypol\n# semodule -i mypol.pp\n\npermissive\u72b6\u614b\u306b\u3057\u3066\u3042\u308c\u3070\u554f\u984c\u304c\u8907\u6570\u3042\u3063\u305f\u306a\u3089\u3001\u3053\u306e\u3088\u3046\u306a\u30ed\u30b0\u3082\u8907\u6570\u73fe\u308c\u308b\u306f\u305a\u3060\u3002\n1\u3064\u3082\u73fe\u308c\u306a\u3044\u5834\u5408\u3001auditd\u30b5\u30fc\u30d3\u30b9\u3092reload\u3057\u3066\u304b\u3089\u3082\u3046\u4e00\u5ea6\u76e3\u67fb\u30ed\u30b0\u3092\u51fa\u529b\u3055\u305b\u3066\u307f\u308b\u3002\u305d\u308c\u3067\u3082\u73fe\u308c\u306a\u3051\u308c\u3070OS\u518d\u8d77\u52d5\u3057\u3066\u307f\u308b\u3002\n\u307e\u305f\u3001CentOS 6\u3060\u3068\u4e0a\u8a18\u306e\u3088\u3046\u306a\u884c\u306f\u73fe\u308c\u305a\u6b21\u306e\u3088\u3046\u306a\u6587\u5b57\u5217\u3092\u542b\u3080\u884c\u304c\u73fe\u308c\u308b\u3002\nFor complete SELinux messages. run sealert -l 7d8bffe6-d07f-4971-84a5-9fe70ebeba76\n\n\u3053\u306e\u5834\u5408\u3001\u66f8\u304b\u308c\u3066\u3044\u308b\u3088\u3046\u306bsealert -l 7d8bffe6-d07f-4971-84a5-9fe70ebeba76\u3092\u5b9f\u884c\u3059\u308c\u3070\u5148\u7a0b\u793a\u3057\u305f\u3088\u3046\u306a\u30ed\u30b0\u304c\u8868\u793a\u3055\u308c\u308b\u3002\n\u3053\u306e\u30ed\u30b0\u306e\u4e2d\u3067\u4e00\u756a\u6700\u521d\u306b\u66f8\u304b\u308c\u3066\u3044\u308b*****\u306b\u56f2\u307e\u308c\u3066\u66f8\u304b\u308c\u3066\u3044\u308b\u30d7\u30e9\u30b0\u30a4\u30f3\u540d\u3092\u8abf\u3079\u308b\u3002\n\u4e0a\u8a18\u30ed\u30b0\u306e\u4f8b\u306a\u3089\u305d\u306e\u30d7\u30e9\u30b0\u30a4\u30f3\u540d\u306f\u300ccatchall_boolean\u300d\u3067\u3042\u308b\u3002\n\u3053\u306e\u30d7\u30e9\u30b0\u30a4\u30f3\u540d\u304b\u3089\u6b21\u306b\u884c\u3046\u30a2\u30af\u30b7\u30e7\u30f3\u3092\u6c7a\u5b9a\u3059\u308b\u3002\n\u6b21\u9805\u3067\u30d7\u30e9\u30b0\u30a4\u30f3\u540d\u3054\u3068\u306b\u4f55\u3092\u3059\u3079\u304d\u304b\u3092\u793a\u3059\u3002\n\n\u554f\u984c\u89e3\u6c7a\u306e\u305f\u3081\u306b\u5b9f\u884c\u3059\u3079\u304d\u30a2\u30af\u30b7\u30e7\u30f3\n\ncatchall_boolean \u2192 SELinux\u30d6\u30fc\u30eb\u5024\u306e\u5909\u66f4\nSELinux\u30d6\u30fc\u30eb\u5024\u3068\u306f\u3001\u30a2\u30af\u30bb\u30b9\u30d9\u30af\u30bf\u30eb\u30fc\u30eb\u3092\u3044\u304f\u3064\u304b\u307e\u3068\u3081\u3066\u7ba1\u7406\u8005\u304c\u6709\u52b9\u5316\u3001\u3042\u308b\u3044\u306f\u7121\u52b9\u5316\u3067\u304d\u308b\u3088\u3046\u306b\u3057\u305f\u3082\u306e\u3067\u3042\u308b\u3002\n\u3042\u308b\u30d7\u30ed\u30b0\u30e9\u30e0\u306b\u304a\u3044\u3066\u3059\u3079\u3066\u306e\u6a5f\u80fd\u3092\u4f7f\u308f\u306a\u3044\u5834\u5408\u3001\u4f7f\u308f\u306a\u3044\u6a5f\u80fd\u306e\u305f\u3081\u306e\u30a2\u30af\u30bb\u30b9\u30d9\u30af\u30bf\u30eb\u30fc\u30eb\u306f\u8a31\u53ef\u3057\u306a\u3044\u307e\u307e\u3001\u4f7f\u3046\u6a5f\u80fd\u306e\u305f\u3081\u306e\u30a2\u30af\u30bb\u30b9\u30d9\u30af\u30bf\u30eb\u30fc\u30eb\u3060\u3051\u3092\u8a31\u53ef\u3059\u308b\u3001\u3068\u3044\u3046\u3088\u3046\u306b\u3067\u304d\u308b\u3060\u3051\u5c11\u306a\u3044\u30a2\u30af\u30bb\u30b9\u6a29\u9650\u3067\u904b\u7528\u3059\u308b\u3053\u3068\u3092\u53ef\u80fd\u306b\u3059\u308b\u305f\u3081\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3002\n\u3042\u308bSELinux\u30d6\u30fc\u30eb\u5024\u3092\u30aa\u30f3\u306b\u3059\u308b\u305f\u3081\u306b\u306fsetsebool -P <SELinux\u30d6\u30fc\u30eb\u5024\u540d> 1\u3092\u3001\u30aa\u30d5\u306b\u3059\u308b\u305f\u3081\u306b\u306fsetsebool -P <SELinux\u30d6\u30fc\u30eb\u5024\u540d> 0\u3092\u5b9f\u884c\u3059\u308b\u3002\n\u3053\u306e-P\u30aa\u30d7\u30b7\u30e7\u30f3\u306fOS\u518d\u8d77\u52d5\u5f8c\u3082\u5909\u66f4\u3092\u6c38\u7d9a\u5316\u3059\u308b\u305f\u3081\u306e\u30aa\u30d7\u30b7\u30e7\u30f3\u3067\u3042\u308b\u3002\n\u5148\u7a0b\u306esetroubleshoot\u306e\u30ed\u30b0\u3067\u306f\u30011\u3064\u76ee\u306ecatchall_boolean\u306bsetsebool -P httpd_can_network_connect_cobbler 1\u3092\u30012\u3064\u76ee\u306ecatchall_boolean\u306bsetsebool -P httpd_can_network_connect 1\u3092\u5b9f\u884c\u3057\u308d\u3068\u66f8\u304b\u308c\u3066\u3044\u308b\u3002\n\u3064\u307e\u308a\u3053\u306e\u554f\u984c\u306fhttpd_can_network_connect_cobbler\u304bhttpd_can_network_connect\u304b\u3069\u3061\u3089\u304b1\u3064\u306eSELinux\u30d6\u30fc\u30eb\u5024\u3092\u6709\u52b9\u306b\u3059\u308c\u3070\u89e3\u6c7a\u3067\u304d\u308b\u3001\u3068\u3044\u3046\u3053\u3068\u3060\u3002\n\u4f55\u6545\u3069\u3061\u3089\u304b1\u3064\u306a\u306e\u304b\u3002\n\u3042\u308bSELinux\u30d6\u30fc\u30eb\u5024\u3067\u6709\u52b9\u5316/\u7121\u52b9\u5316\u3067\u304d\u308b\u30a2\u30af\u30bb\u30b9\u30d9\u30af\u30bf\u30eb\u30fc\u30eb\u306e\u30ea\u30b9\u30c8\u306fsesearch --allow --auditallow -C -b <SELinux\u30d6\u30fc\u30eb\u5024\u540d>\u3067\u53d6\u5f97\u3067\u304d\u308b\u3002\n--allow\u30aa\u30d7\u30b7\u30e7\u30f3\u306fallow\u30eb\u30fc\u30eb\u3092\u8868\u793a\u3001--auditallow\u30aa\u30d7\u30b7\u30e7\u30f3\u306fauditallow\u30eb\u30fc\u30eb\u3092\u8868\u793a\u3001-C\u30aa\u30d7\u30b7\u30e7\u30f3\u306f\u5f8c\u3067\u8aac\u660e\u3059\u308b\u3001-b\u30aa\u30d7\u30b7\u30e7\u30f3\u306fSELinux\u30d6\u30fc\u30eb\u5024\u540d\u3067\u7d5e\u308a\u8fbc\u3080\u3068\u3044\u3046\u30aa\u30d7\u30b7\u30e7\u30f3\u3067\u3042\u308b\u3002\n\u6b21\u306fhttpd_can_network_connect_cobbler\u30d6\u30fc\u30eb\u5024\u306e\u5185\u5bb9\u3067\u3042\u308b\u3002\n# sesearch --allow --auditallow -C -b httpd_can_network_connect_cobbler\nFound 1 semantic av rules:\nDT allow httpd_t cobbler_port_t : tcp_socket name_connect ; [ httpd_can_network_connect_cobbler ]\n\n\u307e\u305f\u6b21\u306fhttpd_can_network_connect\u30d6\u30fc\u30eb\u5024\u306e\u5185\u5bb9\u3067\u3042\u308b\u3002\n# sesearch --allow --auditallow -C -b httpd_can_network_connect\nFound 17 semantic av rules:\nDT allow httpd_t port_type : tcp_socket name_connect ; [ httpd_can_network_connect ]\nDT allow httpd_sys_script_t netif_t : netif { tcp_recv tcp_send udp_recv udp_send ingress egress } ; [ httpd_enable_cgi httpd_can_network_connect && ]\nDT allow httpd_suexec_t client_packet_type : packet { send recv } ; [ httpd_can_network_connect ]\nDT allow httpd_suexec_t node_t : node { tcp_recv tcp_send udp_recv udp_send recvfrom sendto } ; [ httpd_can_network_connect ]\nDT allow httpd_sys_script_t port_type : tcp_socket { recv_msg send_msg name_connect } ; [ httpd_enable_cgi httpd_can_network_connect && ]\nDT allow httpd_sys_script_t port_type : udp_socket { recv_msg send_msg } ; [ httpd_enable_cgi httpd_can_network_connect && ]\nDT allow httpd_suexec_t httpd_suexec_t : tcp_socket { ioctl read write create getattr setattr lock append bind connect listen accept getopt setopt shutdown } ; [ httpd_can_network_connect ]\nDT allow httpd_suexec_t httpd_suexec_t : udp_socket { ioctl read write create getattr setattr lock append bind connect getopt setopt shutdown } ; [ httpd_can_network_connect ]\nDT allow httpd_suexec_t netif_t : netif { tcp_recv tcp_send udp_recv udp_send ingress egress } ; [ httpd_can_network_connect ]\nDT allow httpd_sys_script_t client_packet_type : packet { send recv } ; [ httpd_enable_cgi httpd_can_network_connect && ]\nDT allow httpd_sys_script_t httpd_sys_script_t : tcp_socket { ioctl read write create getattr setattr lock append bind connect listen accept getopt setopt shutdown } ; [ httpd_enable_cgi httpd_can_network_connect && ]\nDT allow httpd_sys_script_t httpd_sys_script_t : udp_socket { ioctl read write create getattr setattr lock append bind connect getopt setopt shutdown } ; [ httpd_enable_cgi httpd_can_network_connect && ]\nDT allow httpd_sys_script_t node_t : tcp_socket node_bind ; [ httpd_enable_cgi httpd_can_network_connect && ]\nDT allow httpd_sys_script_t node_t : udp_socket node_bind ; [ httpd_enable_cgi httpd_can_network_connect && ]\nDT allow httpd_sys_script_t node_t : node { tcp_recv tcp_send udp_recv udp_send recvfrom sendto } ; [ httpd_enable_cgi httpd_can_network_connect && ]\nDT allow httpd_suexec_t port_type : tcp_socket { recv_msg send_msg name_connect } ; [ httpd_can_network_connect ]\nDT allow httpd_suexec_t port_type : udp_socket { recv_msg send_msg } ; [ httpd_can_network_connect ]\n\nsesearch\u306e\u51fa\u529b\u7d50\u679c\u306e\u8aad\u307f\u65b9\u306f\u6b21\u306e\u901a\u308a\u3067\u3042\u308b\u3002\n\n\u6700\u521d\u306e\u300cDT\u300d\u306f1\u6587\u5b57\u76ee\u304cD\u2192\u73fe\u5728\u7121\u52b9\u3001E\u2192\u73fe\u5728\u6709\u52b9\u3068\u3044\u3046\u610f\u5473\u3067\u30012\u6587\u5b57\u76ee\u306fT\u2192\u30aa\u30f3\u306e\u6642\u306b\u6709\u52b9\u3001F\u2192\u30aa\u30d5\u306e\u6642\u306b\u6709\u52b9\u3068\u3044\u3046\u610f\u5473\u3067\u3042\u308b\u3002-C\u30aa\u30d7\u30b7\u30e7\u30f3\u3092\u6307\u5b9a\u3057\u305f\u6642\u306e\u307f\u8868\u793a\u3055\u308c\u308b\u3002\n\u6b21\u306e\u300callow\u300d\u306f\u30a2\u30af\u30bb\u30b9\u30d9\u30af\u30bf\u30eb\u30fc\u30eb\u306e\u7a2e\u985e\u304c\u8868\u793a\u3055\u308c\u308b\u3002\n\u305d\u306e\u5f8c\u306f\"\u30c9\u30e1\u30a4\u30f3\"\u3001\"\u30bf\u30a4\u30d7\"\u3001\u30b3\u30ed\u30f3\u3092\u631f\u3093\u3067\"\u30af\u30e9\u30b9\"\u3001\"\u64cd\u4f5c\u306e\u7a2e\u985e\"\u3067\u3042\u308b\u3002\"\u64cd\u4f5c\u306e\u7a2e\u985e\"\u306f\u8907\u6570\u304c\u5bfe\u8c61\u306b\u306a\u3063\u3066\u3044\u308b\u5834\u5408\u306f\u307e\u3068\u3081\u3066{ }\u306b\u56f2\u307e\u308c\u3066\u8868\u793a\u3055\u308c\u308b\u3002\n\u6700\u5f8c\u306b\u30bb\u30df\u30b3\u30ed\u30f3\u3092\u631f\u3093\u3067[ ]\u306b\u56f2\u307e\u308c\u3066SELinux\u30d6\u30fc\u30eb\u5024\u540d\u3067\u3042\u308b\u3002-C\u30aa\u30d7\u30b7\u30e7\u30f3\u3092\u6307\u5b9a\u3057\u305f\u6642\u306e\u307f\u8868\u793a\u3055\u308c\u308b\u3002\u8907\u6570\u306e\u30d6\u30fc\u30eb\u5024\u540d\u304c\u8868\u793a\u3055\u308c\u3066\u3044\u308b\u5834\u5408\u3001\u305d\u306e\u3059\u3079\u3066\u3092\u5909\u66f4\u3057\u306a\u3044\u3068\u6709\u52b9\u5316/\u7121\u52b9\u5316\u3067\u304d\u306a\u3044\u30025\n\n\nhttpd_can_network_connect\u30d6\u30fc\u30eb\u5024\u306e\u5185\u5bb9\u306e\u3046\u3061\u306e1\u884c\u306f\u3053\u3046\u306a\u3063\u3066\u3044\u308b\u3002\nDT allow httpd_t port_type : tcp_socket name_connect ; [ httpd_can_network_connect ]\n\n\u3053\u308c\u306fhttpd_can_network_connect_cobbler\u30d6\u30fc\u30eb\u5024\u306e\u552f\u4e00\u306e1\u884c\u306e\u5185\u5bb9\u3068\u6bd4\u3079\u308b\u3068\u3001\"\u30bf\u30a4\u30d7\"\u306e\u9805\u304ccobbler_port_t\u3067\u306f\u306a\u304f\u300cport_type\u300d\u3068\u306a\u3063\u3066\u3044\u308b\u3068\u3053\u308d\u3060\u3051\u304c\u76f8\u9055\u70b9\u3067\u3042\u308b\u3002\n\u3053\u306e\u3088\u3046\u306b\"\u30bf\u30a4\u30d7\"\u3084\"\u30c9\u30e1\u30a4\u30f3\"\u306e\u9805\u306b\u3042\u308a\u306a\u304c\u3089_t\u3067\u7d42\u308f\u3063\u3066\u3044\u306a\u3044\u3082\u306e\u306f\u3044\u304f\u3064\u304b\u306e\u30bf\u30a4\u30d7\u3084\u30c9\u30e1\u30a4\u30f3\u3092\u3072\u3068\u307e\u3068\u3081\u306b\u3057\u3066\u30b0\u30eb\u30fc\u30d7\u5316\u3057\u305f\u3082\u306e\u3067\u3042\u308a\u3001\u30a2\u30c8\u30ea\u30d3\u30e5\u30fc\u30c8\u3068\u547c\u3070\u308c\u308b\u3002\n1\u3064\u306e\u30a2\u30c8\u30ea\u30d3\u30e5\u30fc\u30c8\u306b\u542b\u307e\u308c\u308b\u30bf\u30a4\u30d7\u3084\u30c9\u30e1\u30a4\u30f3\u306fseinfo -a<\u30a2\u30c8\u30ea\u30d3\u30e5\u30fc\u30c8\u540d> -x\u3067\u53d6\u5f97\u3067\u304d\u308b\u3002\nseinfo -aport_type -x | grep -w cobbler_port_t\u3092\u5b9f\u884c\u3059\u308b\u3068\u3001port_type\u30a2\u30c8\u30ea\u30d3\u30e5\u30fc\u30c8\u306b\u306fcobbler_port_t\u30bf\u30a4\u30d7\u3082\u542b\u307e\u308c\u3066\u3044\u308b\u3053\u3068\u304c\u308f\u304b\u308b\u3002\n\u3064\u307e\u308a\u3001httpd_can_network_connect\u30d6\u30fc\u30eb\u5024\u306e\u3046\u3061\u306e1\u884c\u3067\u3042\u308bDT allow httpd_t port_type : tcp_socket name_connect ; [ httpd_can_network_connect ]\u306fhttpd_can_network_connect_cobbler\u30d6\u30fc\u30eb\u5024\u306e\u552f\u4e00\u306e1\u884cDT allow httpd_t cobbler_port_t : tcp_socket name_connect ; [ httpd_can_network_connect_cobbler ]\u3092\u5305\u542b\u3059\u308b\u3053\u3068\u304c\u308f\u304b\u308b\u3002\n\u5f93\u3063\u3066httpd_can_network_connect_cobbler\u30d6\u30fc\u30eb\u5024\u3092\u6709\u52b9\u306b\u3057\u3066\u3067\u304d\u308b\u3053\u3068\u306fhttpd_can_network_connect\u30d6\u30fc\u30eb\u5024\u3092\u6709\u52b9\u306b\u3059\u308b\u3053\u3068\u3067\u3082\u9054\u6210\u3067\u304d\u308b\u3001\u3068\u3044\u3046\u308f\u3051\u3067\u3042\u308b\u3002\n\u3067\u3001\u3069\u3061\u3089\u3092\u6709\u52b9\u306b\u3059\u3079\u304d\u304b\u3068\u306a\u308b\u3068\u3001\u6a29\u9650\u304c\u5c11\u306a\u3044\u65b9\u3068\u304b\u3088\u308a\u76f8\u5fdc\u3057\u3044\u65b9\u3068\u304b\u3067\u5224\u65ad\u3059\u308b\u3053\u3068\u306b\u306a\u308b\u3060\u308d\u3046\u3002\nsemanage boolean -l\u3067SELinux\u30d6\u30fc\u30eb\u5024\u306e\u4e00\u89a7\u3092\u53d6\u5f97\u3067\u304d\u308b\u306e\u3067\u3001\u305d\u306e\u6700\u5f8c\u306b\u66f8\u304b\u308c\u3066\u3044\u308b\u7c21\u5358\u306a\u8aac\u660e\u3092\u8aad\u3093\u3067\u6c7a\u3081\u3066\u3082\u826f\u3044\u3002\n\nrestorecon \u2192 \u30a2\u30af\u30bb\u30b9\u3055\u308c\u305f\u30d5\u30a1\u30a4\u30eb\u306e\u30bf\u30a4\u30d7\u304c\u30c7\u30d5\u30a9\u30eb\u30c8\u8a2d\u5b9a\u3068\u306f\u7570\u306a\u308b\n\u300c\u30ea\u30bd\u30fc\u30b9\u306e\u30bf\u30a4\u30d7\u3092\u6b63\u3057\u3044\u3082\u306e\u306b\u76f4\u3059\u300d\u7de8\u306e1\u3064\u76ee\u3068\u3057\u3066\u3001\u30a2\u30af\u30bb\u30b9\u3055\u308c\u305f\u30d5\u30a1\u30a4\u30eb\u306e\u30bf\u30a4\u30d7\u304c\u30c7\u30d5\u30a9\u30eb\u30c8\u8a2d\u5b9a\u3068\u306f\u7570\u306a\u308b\u30d1\u30bf\u30fc\u30f3\u304c\u3042\u308b\u3002\n\u6b21\u306fhttpd\u3092start\u3057\u3001/tmp/1.html\u3092\u4f5c\u3063\u3066cp -a /tmp/1.html /var/www/html\u3092\u5b9f\u884c\u3057\u305f\u5f8ccurl http://localhost/1.html\u3092\u5b9f\u884c\u3057\u305f\u304cTE\u306e\u30a2\u30af\u30bb\u30b9\u5236\u5fa1\u306b\u5f15\u3063\u639b\u304b\u308a\u30a8\u30e9\u30fc\u306b\u306a\u3063\u305f\u6642\u306esetroubleshoot\u306e\u51fa\u529b\u5185\u5bb9\u3067\u3042\u308b\u3002\n*****  Plugin restorecon (92.2 confidence) suggests   ************************\n\nIf you want to fix the label.\n/var/www/html/1.html default label should be httpd_sys_content_t.\nThen you can run restorecon.\nDo\n# /sbin/restorecon -v /var/www/html/1.html\n\n\u3053\u308c\u306f/var/www/html/1.html\u306e\u898f\u5b9a\u306e\u30bf\u30a4\u30d7\u304chttpd_sys_content_t\u3067\u3042\u308b\u306b\u3082\u304b\u304b\u308f\u3089\u305a\u5225\u306e\u3082\u306e\u306b\u306a\u3063\u3066\u3044\u308b\u306e\u304c\u554f\u984c\u306e\u539f\u56e0\u3067\u3042\u308a\u3001/sbin/restorecon -v /var/www/html/1.html\u3092\u5b9f\u884c\u3059\u308b\u3068\u89e3\u6c7a\u3059\u308b\u3001\u3068\u8a00\u3063\u3066\u3044\u308b\u3002\n\u3082\u3063\u3068\u3082\u89e3\u6c7a\u306b\u306f\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u5bfe\u3057\u3066restorecon -RFv /var/www/html/\u3068\u3057\u3066\u3057\u307e\u3063\u305f\u65b9\u304c\u826f\u3044\u3060\u308d\u3046\u3002\nrestorecon\u306f\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3084\u30d5\u30a1\u30a4\u30eb\u306eSELinux\u30b3\u30f3\u30c6\u30ad\u30b9\u30c8\u3092\u6c38\u7d9a\u7684\u306b\u898f\u5b9a\u306e\u3082\u306e\u306b\u5909\u66f4\u3059\u308b\u30b3\u30de\u30f3\u30c9\u3067\u3042\u308b\u3002\n-R\u30aa\u30d7\u30b7\u30e7\u30f3\u306f\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u5185\u3092\u518d\u5e30\u7684\u306b\u5b9f\u884c\u3059\u308b\u3001-F\u30aa\u30d7\u30b7\u30e7\u30f3\u306f\u5f37\u5236\u7684\u306b\u5909\u66f4\u3059\u308b\u3001-v\u30aa\u30d7\u30b7\u30e7\u30f3\u306fSELinux\u30b3\u30f3\u30c6\u30ad\u30b9\u30c8\u3092\u5909\u66f4\u3057\u305f\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3084\u30d5\u30a1\u30a4\u30eb\u3092\u8868\u793a\u3059\u308b\u3002\n\u3042\u308b\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3084\u30d5\u30a1\u30a4\u30eb\u306e\u898f\u5b9a\u306eSELinux\u30b3\u30f3\u30c6\u30ad\u30b9\u30c8\u306fmatchpathcon <\u30d1\u30b9>\u3067\u53d6\u5f97\u3067\u304d\u308b\u3002\u30d1\u30b9\u306b\u306f*\u306a\u3069\u3092\u4f7f\u7528\u3067\u304d\u308b\u3002\nsemanage fcontext -l\u3067\u898f\u5b9a\u306eSELinux\u30b3\u30f3\u30c6\u30ad\u30b9\u30c8\u306e\u4e00\u89a7\u304c\u53d6\u5f97\u3067\u304d\u308b\u304c\u3001\u3053\u3063\u3061\u306f\u3061\u3087\u3063\u3068\u8aad\u307f\u3065\u3089\u3044\u3002\n\u3053\u306e\u554f\u984c\u306f\u30d5\u30a1\u30a4\u30eb\u3092cp -a 6 \u3084mv\u3067\u5225\u306e\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u6301\u3063\u3066\u3044\u304f\u3068\u5143\u306eSELinux\u30b3\u30f3\u30c6\u30ad\u30b9\u30c8\u306e\u307e\u307e\u306b\u306a\u308b\u3053\u3068\u304c\u539f\u56e0\u306b\u306a\u3063\u3066\u8d77\u3053\u308b\u3053\u3068\u304c\u591a\u3044\u3002\n\u5bfe\u7b56\u3068\u3057\u3066 /etc/selinux/restorecond.conf \u306b\u5217\u8a18\u3055\u308c\u305f\u30d1\u30b9\u3092\u81ea\u52d5\u7684\u306b\u898f\u5b9a\u306eSELinux\u30b3\u30f3\u30c6\u30ad\u30b9\u30c8\u306b\u4fee\u6b63\u3057\u3066\u304f\u308c\u308brestorecond\u30b5\u30fc\u30d3\u30b9\u3092\u4f7f\u7528\u3059\u308b\u306e\u3082\u826f\u3044\u3002\n\u4fee\u6b63\u3057\u3066\u304f\u308c\u308b\u30bf\u30a4\u30df\u30f3\u30b0\u306f\u304a\u305d\u3089\u304finotify\u30a4\u30d9\u30f3\u30c8\u304c\u767a\u751f\u3057\u305f\u6642\u3001\u3064\u307e\u308a\u30b3\u30d4\u30fc\u3084\u79fb\u52d5\u306a\u3069\u3092\u542b\u3080\u30d5\u30a1\u30a4\u30eb\u4f5c\u6210\u6642\u3084\u5909\u66f4\u6642\u3001\u5f8c\u306f\u30b5\u30fc\u30d3\u30b9\u8d77\u52d5\u6642\u3067\u3042\u308b\u3002\n\u305f\u3060\u3057\u3001\u30cf\u30fc\u30c9\u30ea\u30f3\u30af\u306b\u5bfe\u3057\u3066\u306f\u50cd\u304b\u306a\u3044\u3053\u3068\u306b\u6ce8\u610f\u3002\n\ncatchall_labels \u2192 \u53c2\u7167\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092\u6a19\u6e96\u4ee5\u5916\u306e\u3082\u306e\u306b\u3057\u305f\u5834\u5408\u306e\u5bfe\u5fdc\n\u300c\u30ea\u30bd\u30fc\u30b9\u306e\u30bf\u30a4\u30d7\u3092\u6b63\u3057\u3044\u3082\u306e\u306b\u76f4\u3059\u300d\u7de8\u306e2\u3064\u76ee\u306f1\u3064\u76ee\u3068\u4f3c\u3066\u3044\u308b\u304c\u3001\u3053\u3061\u3089\u306f\u30d5\u30a1\u30a4\u30eb\u306e\u65e2\u5b9a\u306e\u30bf\u30a4\u30d7\u3059\u3089\u30d7\u30ed\u30bb\u30b9\u306e\u30c9\u30e1\u30a4\u30f3\u304b\u3089\u30a2\u30af\u30bb\u30b9\u7981\u6b62\u3068\u306a\u3063\u3066\u3044\u308b\u5834\u5408\u3067\u3042\u308b\u3002\n\u6b21\u306f/var/www/html\u3067\u306f\u306a\u304f/space/1\u3092\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u30eb\u30fc\u30c8\u306b\u3057\u3066httpd\u3092start\u3057\u3001curl http://localhost/a.html\u3092\u5b9f\u884c\u3057\u305f\u304cTE\u306e\u30a2\u30af\u30bb\u30b9\u5236\u5fa1\u306b\u5f15\u3063\u639b\u304b\u308a\u30a8\u30e9\u30fc\u306b\u306a\u3063\u305f\u6642\u306esetroubleshoot\u306e\u51fa\u529b\u5185\u5bb9\u3067\u3042\u308b\u3002\n*****  Plugin catchall_labels (83.8 confidence) suggests   *******************\n\nIf you want to allow httpd to have getattr access on the a.html file\nThen you need to change the label on /space/1/a.html\nDo\n# semanage fcontext -a -t FILE_TYPE '/space/1/a.html'\nwhere FILE_TYPE is one of the following: NetworkManager_exec_t, (\u9577\u3059\u304e\u308b\u306e\u3067\u7701\u7565).\nThen execute:\nrestorecon -v '/space/1/a.html'\n\n\u3053\u308c\u306fsemanage fcontext -a -t FILE_TYPE '/space/1/a.html\u3092\u5b9f\u884c\u3057\u3066\u898f\u5b9a\u306eSELinux\u30b3\u30f3\u30c6\u30ad\u30b9\u30c8\u3092\u5909\u66f4\u3057\u3066\u304b\u3089restorecon -v '/space/1/a.html\u3092\u5b9f\u884c\u3057\u308d\u3001\u3068\u8a00\u3063\u3066\u3044\u308b\u3002\nFILE_TYPE\u306fhttpd_t\u30c9\u30e1\u30a4\u30f3\u304c\u30a2\u30af\u30bb\u30b9\u3092\u8a31\u53ef\u3055\u308c\u305f\u30bf\u30a4\u30d7\u3067\u3042\u308bNetworkManager_exec_t\u4ee5\u964d\u304b\u3089\u9078\u3079\u3070\u826f\u3044\u306e\u3060\u304c\u5927\u91cf\u306b\u3042\u308a\u3059\u304e\u3066\u3053\u306e\u4e2d\u304b\u3089\u9078\u3076\u306e\u306f\u56f0\u96e3\u3067\u3042\u308b\u3002\n\u305d\u3053\u3067\u5143\u3005\u306e\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u30eb\u30fc\u30c8\u3067\u3042\u308b /var/www/html \u306e\u30bf\u30a4\u30d7\u3092\u8abf\u3079\u3066\u3001\u540c\u3058\u3082\u306e\u3092\u4eca\u306e\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u30eb\u30fc\u30c8\u306b\u9069\u7528\u3059\u308c\u3070\u826f\u3044\u3060\u308d\u3046\u3002\nmatchpathcon /var/www/html\u3092\u5b9f\u884c\u3059\u308b\u3068\u3001\u305d\u306e\u30bf\u30a4\u30d7\u304chttpd_sys_content_t\u3067\u3042\u308b\u3053\u3068\u304c\u308f\u304b\u308b\u3002\n\u306a\u306e\u3067\u4eca\u306e\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u30eb\u30fc\u30c8\u306e\u898f\u5b9a\u306e\u30bf\u30a4\u30d7\u3092httpd_sys_content_t\u306b\u3059\u308c\u3070\u826f\u3044\u304c\u3001\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3060\u3051\u3067\u306f\u306a\u304fsemanage fcontext -a -t httpd_sys_content_t \"/space/1(/.*)?\"\u3068\u3057\u3066\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u5185\u306e\u30d5\u30a1\u30a4\u30eb\u306e\u898f\u5b9a\u306e\u30bf\u30a4\u30d7\u306b\u3082\u9069\u7528\u3055\u308c\u308b\u3088\u3046\u306b\u3059\u308b\u3002\u3053\u306e\u5909\u66f4\u306f\u6c38\u7d9a\u7684\u3067\u3042\u308b\u3002\n\u305d\u306e\u5f8c\u3001restorecon -RFv /space/1\u3067\u4eca\u306e\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u30eb\u30fc\u30c8\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3068\u305d\u306e\u4e2d\u306e\u30d5\u30a1\u30a4\u30eb\u306e\u30bf\u30a4\u30d7\u3092\u898f\u5b9a\u306e\u3082\u306e\u306b\u5909\u66f4\u3059\u308c\u3070\u5b8c\u4e86\u3067\u3042\u308b\u3002\n\u306a\u304a\u3001\u81ea\u5206\u3067\u8ffd\u52a0\u3057\u305f\u898f\u5b9a\u306e\u30bf\u30a4\u30d7\u306fsemanage fcontext -l -C\u3067\u898b\u308b\u3053\u3068\u304c\u3067\u304d\u308b\u3002\n-l\u30aa\u30d7\u30b7\u30e7\u30f3\u306f\u4e00\u89a7\u3092\u8868\u793a\u3001-C\u30aa\u30d7\u30b7\u30e7\u30f3\u306f\u7ba1\u7406\u8005\u304c\u8ffd\u52a0\u3057\u305f\u3082\u306e\u3060\u3051\u3092\u8868\u793a\u3059\u308b\u30aa\u30d7\u30b7\u30e7\u30f3\u3067\u3042\u308b\u3002\n\u3061\u306a\u307f\u306b\u30d5\u30a1\u30a4\u30eb\u304c\u4f5c\u3089\u308c\u308b\u6642\u3001\u305d\u306e\u30d5\u30a1\u30a4\u30eb\u306eSELinux\u30b3\u30f3\u30c6\u30ad\u30b9\u30c8\u306f\u898f\u5b9a\u306e\u3082\u306e\u3067\u306f\u306a\u304f\u3001\u305d\u306e\u30d5\u30a1\u30a4\u30eb\u3092\u7f6e\u3044\u305f\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3068\u540c\u3058\u3082\u306e\u306b\u306a\u308b\u3002\n\nbind_ports \u2192 \u5229\u7528\u3059\u308b\u30dd\u30fc\u30c8\u3092\u6a19\u6e96\u7684\u3067\u306a\u3044\u30dd\u30fc\u30c8\u756a\u53f7\u306b\u5909\u66f4\u3057\u305f\u5834\u5408\u306e\u5bfe\u5fdc\n\u300c\u30ea\u30bd\u30fc\u30b9\u306e\u30bf\u30a4\u30d7\u3092\u6b63\u3057\u3044\u3082\u306e\u306b\u76f4\u3059\u300d\u7de8\u306e\u6700\u5f8c\u3068\u3057\u3066\u3001\u5229\u7528\u3059\u308b\u30dd\u30fc\u30c8\u3092\u6a19\u6e96\u7684\u3067\u306f\u306a\u3044\u30dd\u30fc\u30c8\u756a\u53f7\u306b\u5909\u66f4\u3057\u305f\u5834\u5408\u306e\u5bfe\u5fdc\u3092\u7d39\u4ecb\u3059\u308b\u3002\n\uff08\u30bd\u30b1\u30c3\u30c8\u3082\u30ea\u30bd\u30fc\u30b9\u306e\u4e00\u7a2e\u3067\u3042\u308b\uff09\n\u6b21\u306f\u516c\u958b\u30dd\u30fc\u30c8\u30928888\u306b\u3057\u3066httpd\u3092start\u3057\u3088\u3046\u3068\u3057\u305f\u304cTE\u306e\u30a2\u30af\u30bb\u30b9\u5236\u5fa1\u306b\u5f15\u3063\u639b\u304b\u308a\u5931\u6557\u3057\u305f\u6642\u306esetroubleshoot\u306e\u51fa\u529b\u5185\u5bb9\u3067\u3042\u308b\u3002\n*****  Plugin bind_ports (92.2 confidence) suggests   ************************\n\nIf you want to allow /usr/sbin/httpd to bind to network port 8888\nThen you need to modify the port type.\nDo\n# semanage port -a -t PORT_TYPE -p tcp 8888\n    where PORT_TYPE is one of the following: http_cache_port_t, http_port_t, jboss_management_port_t, jboss_messaging_port_t, ntop_port_t, puppet_port_t.\n\n\u5bfe\u5fdc\u65b9\u6cd5\u306f\u66f8\u304b\u308c\u3066\u3044\u308b\u901a\u308a\u3001semanage port -a -t PORT_TYPE -p tcp 8888\u3092\u5b9f\u884c\u3059\u308c\u3070\u826f\u3044\u3002\u3053\u306e\u5909\u66f4\u306f\u6c38\u7d9a\u7684\u3067\u3042\u308b\u3002\nPORT_TYPE\u306fhttpd_t\u30c9\u30e1\u30a4\u30f3\u304c\u30a2\u30af\u30bb\u30b9\u3092\u8a31\u53ef\u3055\u308c\u305f\u30bf\u30a4\u30d7\u3067\u3042\u308bhttp_cache_port_t, http_port_t, jboss_management_port_t, jboss_messaging_port_t, ntop_port_t, puppet_port_t\u306e\u3046\u3061\u306e1\u3064\u3092\u9078\u3079\u3070\u826f\u3044\u3053\u3068\u3092\u793a\u3057\u3066\u3044\u308b\u3002\n\u3053\u308c\u3089\u306e\u4e2d\u3067\u610f\u5473\u5408\u3044\u304c\u5408\u3063\u3066\u3044\u308b\u30bf\u30a4\u30d7\u3092\u9078\u3079\u3070\u826f\u3044\u3060\u308d\u3046\u3002\u5404\u30bf\u30a4\u30d7\u3092\u30e9\u30d9\u30eb\u306b\u3057\u3066\u3044\u308b\u30dd\u30fc\u30c8\u306f\u4f8b\u3048\u3070semanage port -l | grep -w http_cache_port_t\u3067\u5f97\u308b\u3053\u3068\u304c\u3067\u304d\u308b\u306e\u3067\u3001\u305d\u308c\u3092\u53c2\u8003\u306b\u3059\u308b\u306e\u3082\u826f\u3044\u3060\u308d\u3046\u3002\n\ncatchall \u2192 \u76e3\u67fb\u30ed\u30b0\u304b\u3089\u30a2\u30af\u30bb\u30b9\u30d9\u30af\u30bf\u30eb\u30fc\u30eb\u3092\u751f\u6210\u3057\u9069\u7528\u3059\u308b\n\u6700\u5f8c\u306b\u7d39\u4ecb\u3059\u308b\u306e\u306f\u6700\u7d42\u624b\u6bb5\u3068\u3059\u3079\u304d\u3001\u76e3\u67fb\u30ed\u30b0\u304b\u3089\u30a2\u30af\u30bb\u30b9\u30d9\u30af\u30bf\u30eb\u30fc\u30eb\u3092\u751f\u6210\u3057\u9069\u7528\u3059\u308b\u65b9\u6cd5\u3068\u306a\u308b\u3002\n\u6700\u7d42\u624b\u6bb5\u3068\u3059\u3079\u304d\u3001\u3068\u3044\u3046\u306e\u306f\u6700\u521d\u304b\u3089\u81ea\u4f5c\u3057\u3066\u3044\u308b\u30c9\u30e1\u30a4\u30f3\u306a\u3089\u3068\u3082\u304b\u304f\u3001selinux-policy-xx\u30d1\u30c3\u30b1\u30fc\u30b8\u304b\u3089\u63d0\u4f9b\u3055\u308c\u3066\u3044\u308b\u30c9\u30e1\u30a4\u30f3\u3067\u3053\u308c\u3092\u3057\u306a\u3044\u3068\u306a\u3089\u306a\u3044\u3053\u3068\u306f\u672c\u6765\u306a\u3044\u306f\u305a\u3067SELinux\u30d6\u30fc\u30eb\u5024\u306a\u3069\u3067\u5bfe\u51e6\u3059\u3079\u304d\u3060\u304b\u3089\u3067\u3042\u308b\u3002\n\u3068\u306f\u3044\u3048selinux-policy-xx\u30d1\u30c3\u30b1\u30fc\u30b8\u304b\u3089\u63d0\u4f9b\u3055\u308c\u3066\u3044\u308b\u3082\u306e\u306b\u3082\u7d50\u69cb\u4e0d\u5099\u306f\u3042\u308b\u306e\u3067\u3042\u308b\u3002\n\u6b21\u306freposync\u3068\u3044\u3046\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3057\u305f\u6642\u306esetroubleshoot\u306e\u30ed\u30b0\u51fa\u529b 7 \u3060\u304c\u3001\u300cPlugin catchall (100. confidence) suggests\u300d\u3092\u8fd4\u3057\u3066\u304d\u305f\u5834\u5408\u4ed6\u306b\u624b\u306f\u306a\u3044\u306e\u3067\u3053\u306e\u65b9\u6cd5\u3092\u63a1\u308b\u3053\u3068\u306b\u306a\u308b\u3002\n***** Plugin catchall (100. confidence) suggests **************************\n\nIf you believe that python2.7 should be allowed read access on the history directory by default.\nThen you should report this as a bug.\nYou can generate a local policy module to allow this access.\nDo\nallow this access for now by executing:\n# grep reposync /var/log/audit/audit.log | audit2allow -M mypol\n# semodule -i mypol.pp\n\n\u66f8\u304b\u308c\u3066\u3044\u308b\u3088\u3046\u306bgrep reposync /var/log/audit/audit.log | audit2allow -M mypol\u3067\u30a2\u30af\u30bb\u30b9\u30d9\u30af\u30bf\u30eb\u30fc\u30eb\u306e\u30b3\u30f3\u30d1\u30a4\u30eb\u6e08\u307f\u30d5\u30a1\u30a4\u30eb\uff08\u3053\u308c\u3092\u30dd\u30ea\u30b7\u30fc\u30e2\u30b8\u30e5\u30fc\u30eb\u3068\u547c\u3076\uff09\u3067\u3042\u308bmypol.pp\u3092\u751f\u6210\u3057\u3001semodule -i mypol.pp\u3092\u5b9f\u884c\u3059\u308c\u3070\u76e3\u67fb\u30ed\u30b0\u30d5\u30a1\u30a4\u30eb /var/log/audit/audit.log \u3092grep reposync\u3067\u62bd\u51fa\u3057\u305f\u3082\u306e\u3092\u3059\u3079\u3066\u6c38\u7d9a\u7684\u306ballow\u3059\u308b\u3088\u3046\u306b\u306a\u308b\u3002\n\u305f\u3060mypol\u3068\u3044\u3046\u540d\u524d\u3067\u306f\u76ee\u7684\u304c\u308f\u304b\u308a\u3065\u3089\u3044\u305f\u3081\u9069\u5f53\u306a\u540d\u524d\u3092\u4ed8\u3051\u305f\u65b9\u304c\u826f\u3044\u3060\u308d\u3046\u3002\u540c\u3058\u540d\u524d\u306e\u30dd\u30ea\u30b7\u30fc\u30e2\u30b8\u30e5\u30fc\u30eb\u304c\u8907\u6570\u3042\u3063\u3066\u3082\u3059\u3079\u3066\u3092\u751f\u304b\u3059\u3088\u3046\u306b\u306f\u53d6\u308a\u8fbc\u3081\u306a\u3044\u3001\u3068\u3044\u3046\u7406\u7531\u3082\u3042\u308b\u3002\naudit2allow\u306f\u76e3\u67fb\u30ed\u30b0\u30d5\u30a1\u30a4\u30eb /var/log/audit/audit.log \u3092\u30d1\u30a4\u30d7\u3067\u53d7\u3051\u53d6\u308b\u4ee5\u5916\u306b\u3082ausearch\u306e\u7d50\u679c\u3082\u30d1\u30a4\u30d7\u3067\u53d7\u3051\u53d6\u308b\u3053\u3068\u304c\u3067\u304d\u308b\u3002\n\u4f8b\u3048\u30702015-07-14 12:00:00\u4ee5\u964d\u306e\u5b9f\u884c\u30d5\u30a1\u30a4\u30eb\u540d\u304creposync\u3067\u3042\u308b\u76e3\u67fb\u30ed\u30b0\u3060\u3051\u3092\u30dd\u30ea\u30b7\u30fc\u30e2\u30b8\u30e5\u30fc\u30eb\u306b\u3057\u305f\u3044\u5834\u5408\u3001ausearch -m avc -ts 07/14/2015 12:00:00 -c reposync | audit2allow -M reposync\u3068\u3059\u308c\u3070\u826f\u3044\u3002\naudit2allow -M (\u30dd\u30ea\u30b7\u30fc\u30e2\u30b8\u30e5\u30fc\u30eb\u540d)\u306f\u30b3\u30f3\u30d1\u30a4\u30eb\u6e08\u307f\u306e(\u30dd\u30ea\u30b7\u30fc\u30e2\u30b8\u30e5\u30fc\u30eb\u540d).pp\u4ee5\u5916\u306b\u30bd\u30fc\u30b9\u3067\u3042\u308b(\u30dd\u30ea\u30b7\u30fc\u30e2\u30b8\u30e5\u30fc\u30eb\u540d).te\u3082\u751f\u6210\u3059\u308b\u3002\nselinux-policy-devel\u30d1\u30c3\u30b1\u30fc\u30b8\u304c\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u3066\u3044\u308c\u3070\u3001te\u30d5\u30a1\u30a4\u30eb\u3092\u5fc5\u8981\u306b\u5fdc\u3058\u3066\u624b\u3067\u4fee\u6b63\u3057\u305f\u5f8c\u3001make -f /usr/share/selinux/devel/Makefile (\u30dd\u30ea\u30b7\u30fc\u30e2\u30b8\u30e5\u30fc\u30eb\u540d).pp\u3067\u5225\u9014\u30b3\u30f3\u30d1\u30a4\u30eb\u3092\u884c\u3046\u3053\u3068\u3082\u3067\u304d\u308b\u3002\u30b3\u30f3\u30d1\u30a4\u30eb\u5f8c\u306bsemodule -i (\u30dd\u30ea\u30b7\u30fc\u30e2\u30b8\u30e5\u30fc\u30eb\u540d).pp\u3067\u53d6\u308a\u8fbc\u3080\u3053\u3068\u306b\u306a\u308b\u3002\n\u3053\u308c\u306f\u307e\u3060\u76e3\u67fb\u30ed\u30b0\u306b\u306f\u73fe\u308c\u3066\u3044\u306a\u3044\u304c\u3044\u305a\u308c\u767b\u5834\u3059\u308b\u306e\u304c\u308f\u304b\u3063\u3066\u3044\u308b\u8a31\u53ef\u3057\u305f\u3044\u52d5\u4f5c\u3092\u3001\u5148\u3093\u3058\u3066\u8a31\u53ef\u3059\u308b\u305f\u3081\u306a\u3069\u306b\u4f7f\u7528\u3067\u304d\u308b\u3002\n\u8a2d\u5b9a\u53ef\u80fd\u306a\u30af\u30e9\u30b9\u3068\u64cd\u4f5c\u306e\u7a2e\u985e\u306f\u6b21\u3092\u898b\u308c\u3070\u66f8\u304b\u308c\u3066\u3044\u308b\u3002\nhttp://selinuxproject.org/page/ObjectClassesPerms\n\u306a\u304a\u3001audit2allow\u3067\u751f\u6210\u3055\u308c\u305fte\u30d5\u30a1\u30a4\u30eb\u306b\u306f\u3001\u30d6\u30fc\u30eb\u5024\u3067\u5bfe\u5fdc\u53ef\u80fd\u306a\u30a2\u30af\u30bb\u30b9\u30d9\u30af\u30bf\u30eb\u30fc\u30eb\u304c\u3042\u3063\u305f\u5834\u5408\u305d\u308c\u3092\u6559\u3048\u3066\u304f\u308c\u308b\u306e\u3067\u3001\u305d\u306e\u3088\u3046\u306a\u5834\u5408\u306f\u305d\u308c\u306b\u5f93\u3046\u3068\u826f\u3044\u3060\u308d\u3046\u3002\n\n\u5bfe\u5fdc\u306e\u307e\u3068\u3081\n\u3053\u3053\u307e\u3067\u898b\u3066\u304d\u305f\u901a\u308aSELinux\u3092\u4f7f\u3063\u3066\u3044\u3066\u554f\u984c\u304c\u767a\u751f\u3057\u305f\u5834\u5408\u3001\u57fa\u672c\u7684\u306a\u5bfe\u5fdc\u30d1\u30bf\u30fc\u30f3\u306f\u6b21\u306e\u3088\u3046\u306a\u3082\u306e\u306b\u306a\u308b\u3002\n\n\nsetenforce 0\u3067permissive\u306b\u3059\u308b\n/var/log/messages \u306b\u51fa\u529b\u3055\u308c\u305fsetroubleshoot\u306e\u30ed\u30b0\u3092\u78ba\u8a8d\u3057\u3001\u9069\u5207\u306a\u5bfe\u5fdc\u3092\u5b9f\u65bd\u3059\u308b\n\nsetenforce 1\u3067enforcing\u306b\u623b\u3057\u3066\u554f\u984c\u304c\u89e3\u6d88\u3057\u3066\u3044\u308b\u304b\u3092\u78ba\u8a8d\u3059\u308b\n\n\u7d4c\u9a13\u4e0a\u3001permissive\u306e\u6642\u306f\u767a\u751f\u3057\u306a\u3044\u306e\u306benforcing\u306e\u6642\u306b\u306f\u767a\u751f\u3059\u308b\u554f\u984c\u3082\u3042\u3063\u305f\u308a\u3059\u308b\u304c\u3001\u305d\u306e\u5834\u5408\u3082setroubleshoot\u306e\u30ed\u30b0\u3092\u78ba\u8a8d\u3057\u3066\u554f\u984c\u89e3\u6c7a\u3059\u308b\u307e\u3067\u5bfe\u5fdc\u3092\u7d9a\u3051\u308b\u3060\u3051\u3067\u3042\u308b\u3002\n\u3053\u308c\u3067\u554f\u984c\u304c\u89e3\u6c7a\u3059\u308c\u3070\u5b9f\u306f\u76e3\u67fb\u30ed\u30b0\u304b\u3089\u30a2\u30af\u30bb\u30b9\u30d9\u30af\u30bf\u30eb\u30fc\u30eb\u3092\u751f\u6210\u3059\u308b\u5834\u5408\u4ee5\u5916\u306f\u76e3\u67fb\u30ed\u30b0\u30d5\u30a1\u30a4\u30eb /var/log/audit/audit.log \u3092\u78ba\u8a8d\u3059\u308b\u5fc5\u8981\u306f\u3042\u307e\u308a\u306a\u304b\u3063\u305f\u308a\u3059\u308b\u3002\n\u305f\u3060\u3001\u3053\u308c\u3060\u3051\u3067\u554f\u984c\u304c\u89e3\u6c7a\u3057\u306a\u3044\u5834\u5408\u304c\u3042\u308b\u3002\ndontaudit\u30eb\u30fc\u30eb\u306f\u300c\u30a2\u30af\u30bb\u30b9\u3092\u8a31\u53ef\u305b\u305a\u3001\u30a2\u30af\u30bb\u30b9\u304c\u8a66\u307f\u3089\u308c\u305f\u5834\u5408\u76e3\u67fb\u30ed\u30b0\u306b\u8a18\u9332\u3057\u306a\u3044\u300d\u30eb\u30fc\u30eb\u3067\u3042\u308b\u3002\n\u3064\u307e\u308a\u76e3\u67fb\u30ed\u30b0\u30d5\u30a1\u30a4\u30eb\u3092\u898b\u308b\u3053\u3068\u306b\u3088\u3063\u3066\u3082\u3001setroubleshoot\u306e\u30ed\u30b0\u3092\u898b\u308b\u3053\u3068\u306b\u3088\u3063\u3066\u3082\u554f\u984c\u89e3\u6c7a\u304c\u3067\u304d\u306a\u3044\u306e\u3067\u3042\u308b\u3002\n\uff08\u76e3\u67fb\u30ed\u30b0\u306b\u6b8b\u3089\u306a\u3051\u308c\u3070setroubleshoot\u3082\u50cd\u304b\u306a\u3044\uff09\n\u305d\u306e\u5834\u5408\u306fsemodule -DB\u3067dontaudit\u30eb\u30fc\u30eb\u3092\u7121\u52b9\u306b\u3057\u3066\u5bfe\u5fdc\u3059\u308b\u3053\u3068\u306b\u306a\u308b\u3002\n\u305f\u3060\u3057dontaudit\u30eb\u30fc\u30eb\u3092\u7121\u52b9\u306b\u3057\u305f\u5834\u5408\u3082setroubleshoot\u304c\u50cd\u304b\u306a\u304f\u306a\u308b\u306e\u3067\u3001setroubleshoot\u306b\u983c\u3089\u306a\u3044\u65b9\u6cd5\u3067\u554f\u984c\u89e3\u6c7a\u3092\u3057\u306a\u3051\u308c\u3070\u306a\u3089\u306a\u3044\u3002\n\nsetroubleshoot\u306b\u983c\u3089\u305a\u306b\u554f\u984c\u89e3\u6c7a\u3092\u884c\u3046\nsetroubleshoot\u306b\u983c\u3089\u306a\u3044\u5834\u5408\u3001\u6b21\u306e\u3088\u3046\u306a\u65b9\u6cd5\u3067\u5bfe\u5fdc\u3067\u304d\u308b\u3002\n\u76e3\u67fb\u30ed\u30b0\u306b\u306f\u30d7\u30ed\u30bb\u30b9\u306e\u30c9\u30e1\u30a4\u30f3\u3001\u30ea\u30bd\u30fc\u30b9\u306e\u30bf\u30a4\u30d7\u3001\u30ea\u30bd\u30fc\u30b9\u306e\u30af\u30e9\u30b9\u3001\u30a2\u30af\u30bb\u30b9\u62d2\u5426\u3055\u308c\u305f\u64cd\u4f5c\u304c\u8a18\u9332\u3055\u308c\u3066\u3044\u308b\u3002\nsesearch --allow --auditallow -C -s <\u30c9\u30e1\u30a4\u30f3> -t <\u30bf\u30a4\u30d7> -c <\u30af\u30e9\u30b9> -p <\u64cd\u4f5c>\u3092\u5b9f\u884c\u3059\u308b\u3053\u3068\u306b\u3088\u308a\u3001\u5bfe\u5fdc\u3059\u308bSELinux\u30d6\u30fc\u30eb\u5024\u304c\u3042\u308b\u304b\u3069\u3046\u304b\u3092\u77e5\u308b\u3053\u3068\u304c\u3067\u304d\u308b\u3002\n\u5bfe\u5fdc\u3059\u308bSELinux\u30d6\u30fc\u30eb\u5024\u304c\u898b\u3064\u304b\u308c\u3070\u305d\u308c\u3092\u4f7f\u3063\u3066\u89e3\u6c7a\u3059\u308c\u3070\u826f\u3044\u3060\u308d\u3046\u3002\n\u76e3\u67fb\u30ed\u30b0\u306epath\u306b\u306f\u30a2\u30af\u30bb\u30b9\u3055\u308c\u305f\u30d1\u30b9\u304c\u66f8\u304b\u308c\u3066\u3044\u308b\u306e\u3067\u3001\u305d\u308c\u306b\u5bfe\u3057\u3066restorecon\u3057\u3066\u89e3\u6c7a\u3059\u308c\u3070\u30bf\u30a4\u30d7\u306e\u8aa4\u308a\u3060\u3063\u305f\u3053\u3068\u304c\u308f\u304b\u308b\u3002\n\u6a19\u6e96\u7684\u306a\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3084\u30dd\u30fc\u30c8\u4ee5\u5916\u3092\u4f7f\u3063\u3066\u3044\u308b\u305f\u3081\u306b\u554f\u984c\u304c\u767a\u751f\u3057\u3066\u3044\u308b\u5834\u5408\u306f\u3001\u7ba1\u7406\u8005\u306f\u6a19\u6e96\u5916\u3092\u4f7f\u3063\u3066\u3044\u308b\u3053\u3068\u3092\u5927\u62b5\u77e5\u3063\u3066\u3044\u308b\u3060\u308d\u3046\u304b\u3089\u305d\u308c\u306b\u5fdc\u3058\u305f\u5bfe\u5fdc\u304c\u3067\u304d\u308b\u3002\n\u3069\u308c\u306b\u3082\u5f53\u3066\u306f\u307e\u3089\u306a\u3044\u5834\u5408\u306f\u76e3\u67fb\u30ed\u30b0\u304b\u3089\u30a2\u30af\u30bb\u30b9\u30d9\u30af\u30bf\u30eb\u30fc\u30eb\u3092\u751f\u6210\u3059\u308b\u3002\n\u5bfe\u5fdc\u304c\u5b8c\u4e86\u3057\u305f\u3089semodule -B\u3067dontaudit\u30eb\u30fc\u30eb\u3092\u518d\u5ea6\u6709\u52b9\u5316\u3059\u308b\u3002\n\nSELinux\u3092\u8ae6\u3081\u308b\u2026\u2026\u304c\u3001\u6557\u6226\u51e6\u7406\u306b\u3082\u3084\u308a\u65b9\u304c\u3042\u308b\n\u6700\u5f8c\u306b\u3002\n\u3053\u308c\u307e\u3067\u793a\u3057\u3066\u304d\u305f\u3084\u308a\u65b9\u306e\u307b\u3068\u3093\u3069\u306f\u6b63\u3057\u304f\u5bfe\u75c7\u7642\u6cd5\u3067\u3042\u308a\u3001\u672a\u77e5\u306e\u554f\u984c\u306e\u767a\u751f\u304c\u4e0d\u5b9a\u671f\u3067\u591a\u7a2e\u591a\u69d8\u306b\u6e21\u308b\u306a\u3069\u3001\u9811\u5f35\u3063\u3066SELinux\u306b\u5bfe\u5fdc\u3057\u3088\u3046\u3057\u3066\u3082\u73fe\u5b9f\u7684\u306b\u7121\u7406\u3001\u3068\u3044\u3046\u3053\u3068\u3082\u3042\u308b\u3060\u308d\u3046\u3002\n\u3082\u3061\u308d\u3093setenforce 0\u3092\u5b9f\u884c\u3057\u3001 /etc/selinux/config \u3092\u66f8\u304d\u63db\u3048\u3066permissive\u306b\u3057\u3066\u3057\u307e\u3048\u3070SELinux\u3092\u3059\u3050\u306b\u8ae6\u3081\u308b\u3053\u3068\u304c\u3067\u304d\u308b\u3002\n\u305f\u3060\u3001\u554f\u984c\u3092\u8d77\u3053\u3059\u306e\u304c\u3069\u306e\u30c9\u30e1\u30a4\u30f3\u304b\u304c\u308f\u304b\u3063\u3066\u3044\u308c\u3070\u305d\u306e\u30c9\u30e1\u30a4\u30f3\u3060\u3051\u3092permissive\u306b\u3057\u3001\u4ed6\u306e\u30c9\u30e1\u30a4\u30f3\u306b\u3064\u3044\u3066\u306f\u5f15\u304d\u7d9a\u304denforcing\u3067SELinux\u3092\u4f7f\u7528\u3057\u7d9a\u3051\u308b\u3001\u3068\u3044\u3046\u5bfe\u5fdc\u3092\u53d6\u308b\u3053\u3068\u3082\u3067\u304d\u308b\u3002\n\u6b21\u306e\u30b3\u30de\u30f3\u30c9\u3067\u7279\u5b9a\u306e\u30c9\u30e1\u30a4\u30f3\u3092permissive\u306b\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u308b\u3002\u3053\u306e\u5909\u66f4\u306f\u6c38\u7d9a\u7684\u3067\u3042\u308aOS\u518d\u8d77\u52d5\u3092\u3057\u3066\u3082\u89e3\u9664\u3055\u308c\u306a\u3044\u3002\n# semanage permissive -a <\u30c9\u30e1\u30a4\u30f3>\n\npermissive\u306b\u306a\u3063\u3066\u3044\u308b\u30c9\u30e1\u30a4\u30f3\u306f\u6b21\u3067\u78ba\u8a8d\u3067\u304d\u308b\u3002\n# semanage permissive -l\n\n\u30c9\u30e1\u30a4\u30f3\u3092permissive\u3067\u306a\u304f\u3059\u306b\u306f\u6b21\u306e\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3059\u308b\u3002\n# semanage permissive -d <\u30c9\u30e1\u30a4\u30f3>\n\n\n\u53c2\u8003\u6587\u732e\n\nhttps://access.redhat.com/documentation/ja-JP/Red_Hat_Enterprise_Linux/6/html/Security-Enhanced_Linux/index.html\nhttp://www.slideshare.net/ishikawa84g/hbstudy-28-selinuxhandson\nhttps://fedorapeople.org/~dwalsh/SELinux/Presentations/UnderstandingSELinux/#/\n\nhttp://selinuxproject.org/page/NewUsers \u304b\u3089\u884c\u3051\u308b\u30da\u30fc\u30b8\n\n\n\n\n\n\n\u53e4\u3044dnf\u3067\u306fdnf install *bin/<\u30b3\u30de\u30f3\u30c9\u540d>\u3067\u3082\u901a\u3063\u305f\u304cFedora 22\u306ednf\u3067\u306f\u901a\u3089\u306a\u3044\u3002\u30d0\u30b0\u3063\u307d\u3044\u304c https://github.com/rpm-software-management/dnf/pull/238/files \u306e\u30b3\u30e1\u30f3\u30c8\u898b\u308b\u3068\u4ed5\u69d8\u6271\u3044\u304b\u306a\u3042\u3002\u00a0\u21a9\n\n\n\u5b9f\u969b\u306b\u306f\u3082\u30461\u3064\u3001\u300c\u4ed6\u306e\u30eb\u30fc\u30eb\u306b\u3088\u308ballow, auditallow\u3092\u8a31\u3055\u306a\u3044\u300d\u3001neverallow\u3068\u3044\u3046\u7279\u5225\u306a\u30eb\u30fc\u30eb\u3082\u3042\u308b\u3002\u00a0\u21a9\n\n\nman\u3092\u8aad\u3080\u9650\u308a\u6b63\u78ba\u306b\u306f00:00:01\u3067\u3042\u308b\u53ef\u80fd\u6027\u304c\u9ad8\u3044\u3002\u306a\u304a\u3001\u6307\u5b9a\u3057\u305f\u6642\u523b\u3061\u3087\u3046\u3069\u306f\u691c\u7d22\u7d50\u679c\u306b\u542b\u307e\u308c\u308b\u3002\u00a0\u21a9\n\n\nsetroubleshoot-server\u306f\u30d1\u30c3\u30b1\u30fc\u30b8\u540d\u306bserver\u3068\u3044\u3046\u6587\u5b57\u5217\u3092\u542b\u3080\u304c\u3001\u30c7\u30b9\u30af\u30c8\u30c3\u30d7\u74b0\u5883\u7528\u306eGUI\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u542b\u307e\u306a\u3044\u3001\u7a0b\u5ea6\u306e\u610f\u5473\u5408\u3044\u3060\u3068\u63a8\u6e2c\u3055\u308c\u308b\u3002\u30c7\u30b9\u30af\u30c8\u30c3\u30d7\u74b0\u5883\u7528\u306eGUI\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u542b\u3093\u3060\u30d1\u30c3\u30b1\u30fc\u30b8\u306fsetroubleshoot\u3002\u00a0\u21a9\n\n\n\u8abf\u3079\u304c\u3064\u304b\u306a\u304b\u3063\u305f\u304c\u300c&&\u300d\u306f\u9006\u30dd\u30fc\u30e9\u30f3\u30c9\u8a18\u6cd5\u306e\u4f4d\u7f6e\u306b\u66f8\u304b\u308c\u305fAND\u6f14\u7b97\u5b50\u3068\u601d\u308f\u308c\u308b\u3002\u00a0\u21a9\n\n\n\u6b63\u78ba\u306b\u306f-a\u30aa\u30d7\u30b7\u30e7\u30f3\u304c\u542b\u6709\u3059\u308b\u300c--preserve=context\u300d\u306e\u5f71\u97ff\u3067\u3042\u308b\u3002\u00a0\u21a9\n\n\nreposync\u3092\u5b9f\u884c\u3057\u305f\u6642\u306f\u3044\u3064\u3067\u3082\u3053\u3046\u306a\u308b\u308f\u3051\u3067\u306f\u306a\u3044\u3002\u30d7\u30ed\u30bb\u30b9\u306e\u30c9\u30e1\u30a4\u30f3\u306f\u89aa\u30d7\u30ed\u30bb\u30b9\u3068\u901a\u5e38\u306f\u540c\u3058\u306b\u306a\u308b\u306e\u3067\u3001\u89aa\u30d7\u30ed\u30bb\u30b9\u306e\u30c9\u30e1\u30a4\u30f3\u306b\u30a2\u30af\u30bb\u30b9\u30d9\u30af\u30bf\u30eb\u30fc\u30eb\u306e\u4e0d\u5099\u304c\u3042\u308c\u3070\u3053\u3046\u306a\u308b\u3001\u3068\u3044\u3046\u3060\u3051\u3067\u3042\u308b\u3002\u00a0\u21a9\n\n\n\n# \u306f\u3058\u3081\u306b\n\n## \u6ce8\u610f\u4e8b\u9805\n\n\u3053\u306e\u8a18\u4e8b\u306f\u4f55\u3089\u304b\u306e\u7406\u7531\u3067SELinux\u3092\u5229\u7528\u3057\u306a\u3051\u308c\u3070\u306a\u3089\u306a\u3044\u6642\u306b\u767a\u751f\u3059\u308b\u3001\u610f\u56f3\u305b\u305a\u30d7\u30ed\u30b0\u30e9\u30e0\u304c\u52d5\u304b\u306a\u304f\u306a\u308b\u554f\u984c\u3092\u89e3\u6c7a\u3059\u308b\u305f\u3081\u306e\u624b\u6bb5\u3092\u66f8\u3044\u305f\u3082\u306e\u3067\u3042\u308b\u3002\n\n\u4f5c\u696d\u5bfe\u8c61\u306eOS\u306f\u4f5c\u696d\u4e2d\u3044\u3064\u3067\u3082\u505c\u6b62\u53ef\u80fd\u3067\u3042\u308b\u3082\u306e\u3068\u3059\u308b\u3002SELinux\u306e\u8a2d\u5b9a\u4f5c\u696d\u4e2d\u306b\u505c\u6b62\u4e0d\u53ef\u80fd\u3068\u304b\u7121\u8336\u306a\u306e\u3067\u3002\n\u307e\u305f\u3001\u3059\u3079\u3066\u306e\u64cd\u4f5c\u306froot\u30e6\u30fc\u30b6\u3067\u884c\u3063\u3066\u3044\u308b\u3002SELinux\u306f\u300c\u7ba1\u7406\u8005\u306b\u3088\u308b\u5f37\u5236\u7684\u306a\u30a2\u30af\u30bb\u30b9\u5236\u5fa1\u300d\u306a\u306e\u3067root\u30e6\u30fc\u30b6\u304c\u64cd\u4f5c\u3057\u306a\u3051\u308c\u3070\u306a\u3089\u306a\u3044\u3002\n\n\u5185\u5bb9\u306f\u4e3b\u306bCentOS 7\u3067\u78ba\u8a8d\u3057\u3001CentOS 6\u3084Fedora 22\u3082\u4e00\u90e8\u78ba\u8a8d\u306b\u4f7f\u7528\u3057\u3066\u3044\u308b\u3002\nSELinux\u306e\u7ba1\u7406\u3067\u4f7f\u7528\u3059\u308b\u5404\u7a2e\u306e\u30b3\u30de\u30f3\u30c9\u306f\u521d\u671f\u304b\u3089\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u3066\u3044\u308b\u3082\u306e\u306f\u5c11\u306a\u304f\u3001\u307e\u305f\u30b3\u30de\u30f3\u30c9\u540d\u304c\u305d\u308c\u3092\u542b\u3080rpm\u30d1\u30c3\u30b1\u30fc\u30b8\u540d\u3068\u4e00\u81f4\u3057\u306a\u3044\u3082\u306e\u304c\u591a\u3044\u3002\n\u3053\u306e\u3088\u3046\u306a\u5834\u5408\u306f`yum install *bin/<\u30b3\u30de\u30f3\u30c9\u540d>`\u3067\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u308b\u3002Fedora 22\u3067\u306f`dnf install /usr/*/<\u30b3\u30de\u30f3\u30c9\u540d>`\u3068\u3059\u308b\u3002[^1]\n\u306a\u306e\u3067\u4ee5\u4e0b\u306e\u6587\u7ae0\u4e2d\u3067\u306f\u30b3\u30de\u30f3\u30c9\u3092\u4f7f\u3046\u306e\u306b\u3069\u306erpm\u30d1\u30c3\u30b1\u30fc\u30b8\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308c\u3070\u826f\u3044\u304b\u306f\u3044\u3061\u3044\u3061\u8a18\u8ff0\u3057\u306a\u3044\u3002\n\n[^1]: \u53e4\u3044dnf\u3067\u306f`dnf install *bin/<\u30b3\u30de\u30f3\u30c9\u540d>`\u3067\u3082\u901a\u3063\u305f\u304cFedora 22\u306ednf\u3067\u306f\u901a\u3089\u306a\u3044\u3002\u30d0\u30b0\u3063\u307d\u3044\u304c https://github.com/rpm-software-management/dnf/pull/238/files \u306e\u30b3\u30e1\u30f3\u30c8\u898b\u308b\u3068\u4ed5\u69d8\u6271\u3044\u304b\u306a\u3042\u3002\n\n## SELinux\u3092\u5229\u7528\u3067\u304d\u308b\u72b6\u614b\u306b\u3059\u308b\n\n### SELinux\u306e\u72b6\u614b\u306e\u78ba\u8a8d\n\n\u3068\u308a\u3042\u3048\u305aSELinux\u304c\u5229\u7528\u3067\u304d\u308b\u72b6\u614b\u306b\u306a\u3063\u3066\u3044\u306a\u3044\u3068\u3053\u306e\u8a18\u4e8b\u306e\u610f\u5473\u304c\u306a\u3044\u306e\u3067\u3001\u307e\u305a\u306fSELinux\u306e\u72b6\u614b\u306e\u78ba\u8a8d\u65b9\u6cd5\u3068\u3001\u5229\u7528\u3067\u304d\u308b\u72b6\u614b\u306b\u3059\u308b\u65b9\u6cd5\u3092\u8aac\u660e\u3059\u308b\u3002\n\u3082\u3063\u3068\u3082\u3053\u306e\u8fba\u308a\u306f\u5404\u7a2e\u5a92\u4f53\u3067\u826f\u304f\u898b\u304b\u3051\u308b\u3082\u306e\u3067\u3042\u308a\uff08\u4e3b\u306bSELinux\u3092\u7121\u52b9\u5316\u3059\u308b\u305f\u3081\u306b\u3001\u3060\u304c\uff09\u3001\u826f\u304f\u77e5\u3063\u3066\u3044\u308b\u306a\u3089\u3070\u8aad\u307f\u98db\u3070\u3057\u3066\u3082\u3089\u3063\u3066\u554f\u984c\u306a\u3044\u3060\u308d\u3046\u3002\n\nSELinux\u306e\u72b6\u614b\u306b\u306f\u6b21\u306e3\u3064\u3042\u308b\u3002\n\n<dl>\n<dt>disabled</dt>\n<dd>\u7121\u52b9\u5316\u3055\u308c\u3066\u3044\u308b</dd>\n<dt>permissive</dt>\n<dd>\u6709\u52b9\u5316\u3055\u308c\u3066\u3044\u308b\u304c\u76e3\u67fb\u30ed\u30b0\u306b\u8a18\u9332\u3059\u308b\u4ee5\u5916\u306e\u50cd\u304d\u3092\u3057\u306a\u3044</dd>\n<dt>enforcing</dt>\n<dd>\u6709\u52b9\u5316\u3055\u308c\u3066\u304a\u308a\u8a2d\u5b9a\u901a\u308a\u306b\u50cd\u304f</dd>\n</dl>\n\nSELinux\u306e\u72b6\u614b\u3092\u78ba\u8a8d\u3059\u308b\u30b3\u30de\u30f3\u30c9\u306f\u3044\u304f\u3064\u304b\u3042\u308b\u3002\n\n* \u4e00\u756a\u3088\u304f\u77e5\u3089\u308c\u3066\u3044\u308b\u306e\u306fgetenforce\u3067\u3042\u308b\u3002\u3053\u308c\u3092\u5b9f\u884c\u3059\u308b\u3068Disabled\u304bPermissive\u304bEnforcing\u304b\u304c\u6a19\u6e96\u51fa\u529b\u306b\u51fa\u529b\u3055\u308c\u308b\u3002\n* selinuxenabled\u3092\u5b9f\u884c\u3059\u308b\u3068disabled\u4ee5\u5916\u306e\u5834\u5408\u30ea\u30bf\u30fc\u30f3\u30b3\u30fc\u30c9\u304c0\u306b\u306a\u308a\u3001disabled\u306e\u5834\u54081\u306b\u306a\u308b\u3002\u30ea\u30bf\u30fc\u30f3\u30b3\u30fc\u30c9\u306a\u306e\u3067\u5b9f\u884c\u5f8c`echo $?`\u3067\u53d6\u5f97\u3067\u304d\u308b\u3002\n* sestatus\u306f\u4e00\u756a\u8a73\u7d30\u306a\u72b6\u614b\u3092\u8868\u793a\u3057\u3066\u304f\u308c\u308b\u30b3\u30de\u30f3\u30c9\u3067\u3042\u308b\u3002SELinux status\u9805\u306bdisabled\u304benabled\u304c\u3001Current mode\u9805\u306benforcing\u304bpermissive\u304b\u304c\u51fa\u529b\u3055\u308c\u308b\u3002\n\n### SELinux\u306e\u72b6\u614b\u5909\u66f4\uff1adisabled\u304b\u3089permissive\u3078\n\n\u524d\u8a18\u306e\u901a\u308a\u3001\u72b6\u614b\u304cenforcing\u306e\u6642\u3060\u3051SELinux\u304c\u50cd\u3044\u3066\u304f\u308c\u308b\u306e\u3067\u3001\u307e\u305a\u306fenforcing\u306b\u3057\u3088\u3046\u3002\n\u3059\u3067\u306benforcing\u306a\u3089\u5148\u306b\u8aad\u307f\u9032\u3081\u3066\u69cb\u308f\u306a\u3044\u3002\n\n\u73fe\u5728\u306e\u72b6\u614b\u304cdisabled\u306e\u5834\u5408\u3001\u76f4\u63a5disabled\u304b\u3089enforcing\u306b\u5909\u66f4\u3059\u308b\u3068\u30b7\u30b9\u30c6\u30e0\u304c\u8d77\u52d5\u3057\u306a\u3044\u3053\u3068\u304c\u3042\u308a\u5f97\u308b\u306e\u3067\u3001enforcing\u306b\u3059\u308b\u524d\u306b\u307e\u305a\u306f\u4e00\u65e6permissive\u306b\u3059\u308b\u3002\n\npermissive\u306b\u72b6\u614b\u3092\u5909\u5316\u3055\u305b\u308b\u306b\u306f /etc/selinux/config \u306eSELINUX=\u884c\u304c\"SELINUX=permissive\"\u3068\u306a\u308b\u3088\u3046\u306b\u66f8\u304d\u63db\u3048\u3001\u305d\u306e\u5f8cOS\u3092\u518d\u8d77\u52d5\u3059\u308b\u3002\n\n### SELinux\u306e\u72b6\u614b\u5909\u66f4\uff1apermissive\u304b\u3089enforcing\u3078\n\npermissive\u304b\u3089enforcing\u306b\u3059\u308b\u306b\u306f\u6b21\u3092\u5b9f\u884c\u3059\u308b\u3002\n\n```\n# setenforce 1\n```\n\n\u9006\u306benforcing\u304b\u3089permissive\u306b\u3059\u308b\u5834\u5408\u306f`setenforce 0`\u3067\u3042\u308b\u3002\n\n\u3053\u306e\u3088\u3046\u306bSELinux\u306e\u72b6\u614b\u3092permissive\u304b\u3089enforcing\u3001\u3042\u308b\u3044\u306f\u305d\u306e\u9006\u306benforcing\u304b\u3089permissive\u306b\u3059\u308b\u5834\u5408\u306fOS\u518d\u8d77\u52d5\u306f\u4e0d\u8981\u3060\u304c\u3001OS\u518d\u8d77\u52d5\u3092\u3059\u308b\u3068 /etc/selinux/config \u306eSELINUX=\u884c\u306e\u72b6\u614b\u306b\u623b\u3063\u3066\u3057\u307e\u3046\u306e\u3067\u3001OS\u518d\u8d77\u52d5\u5f8c\u3082enforcing\u306e\u307e\u307e\u306b\u3059\u308b\u306b\u306f /etc/selinux/config \u304c\"SELINUX=enforcing\"\u3068\u306a\u308b\u3088\u3046\u306b\u66f8\u304d\u63db\u3048\u308b\u3002\n\n### /etc/selinux/config\u3092\u66f8\u304d\u63db\u3048\u308b\u969b\u306e\u6ce8\u610f\n\n/etc/selinux/config \u3067\u306f\u306a\u304f /etc/sysconfig/selinux \u3092\u66f8\u304d\u63db\u3048\u308d\u3001\u3068\u3057\u3066\u3044\u308b\u6587\u66f8\u3082\u3042\u308b\u304c\u3001\u5b9f\u969b\u306b\u306f /etc/sysconfig/selinux \u306f /etc/selinux/config \u306e\u30b7\u30f3\u30dc\u30ea\u30c3\u30af\u30ea\u30f3\u30af\u3067\u3042\u308b\u3002\n\u30b7\u30f3\u30dc\u30ea\u30c3\u30af\u30ea\u30f3\u30af\u3067\u3042\u308b /etc/sysconfig/selinux \u306b\u5bfe\u3057\u3066sed\u3092--follow-symlinks\u30aa\u30d7\u30b7\u30e7\u30f3\u3084--copy(-C)\u30aa\u30d7\u30b7\u30e7\u30f3\u3092\u4ed8\u3051\u305a\u306b\u5b9f\u884c\u3059\u308b\u3001\u3042\u308b\u3044\u306fcp -a\u3067\u4e0a\u66f8\u304d\u3059\u308b\u306a\u3069\u3059\u308b\u3068\u3001 /etc/sysconfig/selinux \u306f\u30b7\u30f3\u30dc\u30ea\u30c3\u30af\u30ea\u30f3\u30af\u304b\u3089\u5b9f\u30d5\u30a1\u30a4\u30eb\u306b\u5909\u5316\u3057 /etc/selinux/config \u306b\u306f\u53cd\u6620\u3055\u308c\u306a\u3044\u305f\u3081\u8a2d\u5b9a\u3092\u5909\u66f4\u3057\u305f\u3053\u3068\u306b\u306f\u306a\u3089\u306a\u3044\u3002\n\n\u307e\u305f\u3001 /etc/selinux/config \u306eSELINUX=\u884c\u4ee5\u5916\u3092\u8aa4\u3063\u3066\u5909\u66f4\u3057\u3066\u306f\u306a\u3089\u306a\u3044\u3002\n\u8aa4\u3063\u3066\u5909\u66f4\u3057\u305f\u5834\u5408\u306b\u8d77\u3053\u308b\u3053\u3068\u306e\u4f8b\u306f http://qiita.com/MurabitoK/items/d44fc01b9e1ac2fdcfab \u306e\u3088\u3046\u306a\u3053\u3068\u3067\u3001\u3053\u3053\u306b\u306f\u305d\u306e\u5fa9\u65e7\u65b9\u6cd5\u3082\u66f8\u304b\u308c\u3066\u3044\u308b\u3002\n\n# \u306a\u305cSELinux\u306b\u3088\u3063\u3066\u30d7\u30ed\u30b0\u30e9\u30e0\u306f\u610f\u56f3\u305b\u305a\u52d5\u304b\u306a\u304f\u306a\u308b\u306e\u304b\n\n## Type Enforcement\n\n\u3055\u3066\u3001\u3053\u3053\u304b\u3089\u304c\u672c\u984c\u3067\u3042\u308b\u3002\n\n\u306a\u305cSELinux\u306b\u3088\u3063\u3066\u30d7\u30ed\u30b0\u30e9\u30e0\u304c\u3053\u3061\u3089\u306e\u610f\u56f3\u306b\u53cd\u3057\u3066\u52d5\u304b\u306a\u304f\u306a\u308b\u3053\u3068\u304c\u3042\u308b\u306e\u3060\u308d\u3046\u304b\u3002\n\u305d\u308c\u306fSELinux\u304cenforcing\u306e\u5834\u5408\u3001\u30d7\u30ed\u30bb\u30b9\u304b\u3089\u30d5\u30a1\u30a4\u30eb\u3084\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3001\u30bd\u30b1\u30c3\u30c8\u306a\u3069\uff08SELinux\u306e\u7528\u8a9e\u3067\u306f\u3053\u308c\u3089\u3092\u307e\u3068\u3081\u3066**\u30ea\u30bd\u30fc\u30b9**\u3001\u7a2e\u985e1\u30641\u3064\u3092**\u30af\u30e9\u30b9**\u3068\u547c\u3076\uff09\u306b\u30a2\u30af\u30bb\u30b9\u3067\u304d\u308b\u306e\u304c\u8a31\u53ef\u3055\u308c\u305f\u5834\u5408\u3060\u3051\u306b\u306a\u308b\u304b\u3089\u3067\u3042\u308b\u3002\n\u3053\u306e\u4ed5\u7d44\u307f\u3092**Type Enforcement**\uff08\u4ee5\u4e0b\u3001**TE**\uff09\u3068\u547c\u3076\u3002\n\nTE\u306fchmod\u3067\u8a2d\u5b9a\u3059\u308b\u30d5\u30a1\u30a4\u30eb\u306e\u30d1\u30fc\u30df\u30c3\u30b7\u30e7\u30f3\u3068\u306f\u5225\u306b\u884c\u308f\u308c\u308b\u3082\u3046\u4e00\u3064\u306e\u30a2\u30af\u30bb\u30b9\u5236\u5fa1\u3067\u3042\u308a\u3001SELinux\u304cenforcing\u306e\u5834\u5408\u3001\u30d5\u30a1\u30a4\u30eb\u306e\u30d1\u30fc\u30df\u30c3\u30b7\u30e7\u30f3\u306b\u3088\u308b\u30a2\u30af\u30bb\u30b9\u5236\u5fa1\u3068TE\u306b\u3088\u308b\u30a2\u30af\u30bb\u30b9\u5236\u5fa1\u3068\u306e\u4e21\u65b9\u3092\u901a\u904e\u3057\u306a\u3044\u3068\u30a2\u30af\u30bb\u30b9\u306f\u6210\u529f\u3057\u306a\u3044\u3068\u3044\u3046\u308f\u3051\u3060\u3002\n\nTE\u306b\u3088\u308b\u30a2\u30af\u30bb\u30b9\u5236\u5fa1\u306froot\u30e6\u30fc\u30b6\u306b\u3082\u9069\u7528\u3055\u308c\u308b\u3002\u3042\u308b\u30d7\u30ed\u30bb\u30b9\u306e\u8106\u5f31\u6027\u3092\u7a81\u304b\u308c\u3066root\u30e6\u30fc\u30b6\u3078\u306e\u6a29\u9650\u6607\u683c\u3092\u8a31\u3059\u306a\u3069\u3057\u3066\u3082\u3001\u305d\u306e\u30d7\u30ed\u30bb\u30b9\u306e\u30c9\u30e1\u30a4\u30f3\u306b\u8a31\u53ef\u3055\u308c\u3066\u3044\u306a\u3044\u30ea\u30bd\u30fc\u30b9\u3078\u306e\u30a2\u30af\u30bb\u30b9\u3092\u9632\u3050\u3001\u3068\u3044\u3046\u306e\u304cTE\u306e\u72d9\u3044\u3067\u3042\u308b\u3002\n\n## \u30c9\u30e1\u30a4\u30f3\u3068\u30bf\u30a4\u30d7\n\nSELinux\u306e\u4e16\u754c\u3067\u306f\u3001\u3059\u3079\u3066\u306e\u30d7\u30ed\u30bb\u30b9\u3068\u30ea\u30bd\u30fc\u30b9\u306f**SELinux\u30b3\u30f3\u30c6\u30ad\u30b9\u30c8**\u3068\u547c\u3070\u308c\u308b\u3082\u306e\u3067\u30e9\u30d9\u30eb\u4ed8\u3051\u3055\u308c\u3066\u3044\u308b\u3002\n\nps\u30b3\u30de\u30f3\u30c9\u306b-Z\u30aa\u30d7\u30b7\u30e7\u30f3\u3092\u4ed8\u3051\u308c\u3070\u30d7\u30ed\u30bb\u30b9\u306eSELinux\u30b3\u30f3\u30c6\u30ad\u30b9\u30c8\u3092\u898b\u308b\u3053\u3068\u304c\u3067\u304d\u308b\u3002\n\n```\n# ps -eZ\nLABEL                             PID TTY          TIME CMD\nsystem_u:system_r:init_t:s0         1 ?        00:00:02 systemd\nsystem_u:system_r:kernel_t:s0       2 ?        00:00:00 kthreadd\n\uff08\u9577\u3044\u306e\u3067\u4e2d\u7565\uff09\nsystem_u:system_r:sshd_t:s0-s0:c0.c1023 4840 ? 00:00:00 sshd\nsystem_u:system_r:sshd_t:s0-s0:c0.c1023 4844 ? 00:00:00 sshd\nunconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023 4846 ? 00:00:00 sshd\nunconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023 4849 pts/0 00:00:00 bash\nunconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023 4852 ? 00:00:00 sshd\nunconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023 4860 ? 00:00:00 sftp-server\nunconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023 4898 pts/0 00:00:00 sudo\nunconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023 4899 pts/0 00:00:00 bash\nsystem_u:system_r:kernel_t:s0   31494 ?        00:00:00 bioset\n```\n\nls\u30b3\u30de\u30f3\u30c9\u306b-Z\u30aa\u30d7\u30b7\u30e7\u30f3\u3092\u4ed8\u3051\u308c\u3070\u30d5\u30a1\u30a4\u30eb\u306a\u3069\u306eSELinux\u30b3\u30f3\u30c6\u30ad\u30b9\u30c8\u3092\u898b\u308b\u3053\u3068\u304c\u3067\u304d\u308b\u3002\n\n```\n# ls -Z /tmp\n-rwx------. root    root    system_u:object_r:initrc_tmp_t:s0 ks-script-6Tm7iL\n-rwx------. root    root    system_u:object_r:initrc_tmp_t:s0 ks-script-wKtOJm\n-rwxrwxrwx. vagrant vagrant unconfined_u:object_r:user_tmp_t:s0 script.sh\n-rwxrwxr-x. vagrant vagrant unconfined_u:object_r:user_tmp_t:s0 vagrant-shell\n-rw-r--r--. root    root    unconfined_u:object_r:user_tmp_t:s0 vboxguest-Module.symvers\n-rw-------. root    root    system_u:object_r:initrc_tmp_t:s0 yum.log\n```\n\nSELinux\u30b3\u30f3\u30c6\u30ad\u30b9\u30c8\u306f:\u3067\u533a\u5207\u3089\u308c\u305f\u300c(_u\u3067\u7d42\u308f\u308b\u3082\u306e):(_r\u3067\u7d42\u308f\u308b\u3082\u306e):(_t\u3067\u7d42\u308f\u308b\u3082\u306e):(s\u6570\u5b57\u3067\u59cb\u307e\u308b\u3082\u306e):(c\u6570\u5b57\u3067\u59cb\u307e\u308b\u3082\u306e\u3002\u4e00\u90e8\u306e\u307f)\u300d\u306e\u90e8\u5206\u3067\u3042\u308b\u3002\n\u3053\u306e\u4e2d\u3067_t\u3067\u7d42\u308f\u308b\u3082\u306e\u304c\u30d7\u30ed\u30bb\u30b9\u3084\u30ea\u30bd\u30fc\u30b9\u306e\u30bf\u30a4\u30d7\u3067\u3042\u308b\u3002\u305d\u308c\u305e\u308c\u306e\u30d7\u30ed\u30bb\u30b9\u3084\u30ea\u30bd\u30fc\u30b9\u306f\u30bf\u30a4\u30d7\u30921\u3064\u3060\u3051\u6301\u3064\u3002\n\u30d7\u30ed\u30bb\u30b9\u306e\u30bf\u30a4\u30d7\u306f\u7279\u306b**\u30c9\u30e1\u30a4\u30f3**\u3068\u547c\u3073\u3001\u30ea\u30bd\u30fc\u30b9\u306e**\u30bf\u30a4\u30d7**\u3068\u306f\u533a\u5225\u3059\u308b\u306e\u3067\u3001\u3053\u3053\u3067\u3082\u4ee5\u4e0b\u305d\u3046\u547c\u3076\u3053\u3068\u306b\u3059\u308b\u3002\n\n\u3053\u306e\u8a18\u4e8b\u3067\u8a9e\u308b\u7bc4\u56f2\u5185\u306e\u8a71\u3067\u306fSELinux\u30b3\u30f3\u30c6\u30ad\u30b9\u30c8\u306e\u3046\u3061_t\u3067\u7d42\u308f\u308b\u3082\u306e\u3057\u304b\u4f7f\u308f\u306a\u3044\u3057\u4f7f\u308f\u308c\u306a\u3044\u3057\u306a\u306e\u3067\u4ed6\u306f\u5fd8\u308c\u3066\u826f\u3044\u3002\n\n## TE\u306b\u3088\u308b\u30a2\u30af\u30bb\u30b9\u5236\u5fa1\n\nTE\u306f\u30db\u30ef\u30a4\u30c8\u30ea\u30b9\u30c8\u65b9\u5f0f\u3067\u3042\u308a\u3001\u30eb\u30fc\u30eb\u304c\u5b9a\u7fa9\u3055\u308c\u3066\u3044\u306a\u3044\u3059\u3079\u3066\u306e\u30a2\u30af\u30bb\u30b9\u306f\u300c\u30a2\u30af\u30bb\u30b9\u3092\u8a31\u53ef\u305b\u305a\u3001\u30a2\u30af\u30bb\u30b9\u304c\u8a66\u307f\u3089\u308c\u305f\u5834\u5408\u76e3\u67fb\u30ed\u30b0\u306b\u8a18\u9332\u3059\u308b\u300d\u3053\u3068\u306b\u306a\u3063\u3066\u3044\u308b\u3002\n\u30eb\u30fc\u30eb\u306e\u8a2d\u5b9a\u306f\u300c\u3069\u306e\u30c9\u30e1\u30a4\u30f3\u304c\u3001\u3069\u306e\u30bf\u30a4\u30d7\u306e\u3001\u3069\u306e\u30af\u30e9\u30b9\u306b\u3001\u3069\u306e\u64cd\u4f5c\u3092\u300d\u3068\u3044\u3046\u5358\u4f4d\u3054\u3068\u306b\u6b21\u306e3\u7a2e\u985e\u306e\u6307\u5b9a\u3092\u884c\u3046\u3053\u3068\u304c\u3067\u304d\u308b\u3002[^2]\n\n[^2]: \u5b9f\u969b\u306b\u306f\u3082\u30461\u3064\u3001\u300c\u4ed6\u306e\u30eb\u30fc\u30eb\u306b\u3088\u308ballow, auditallow\u3092\u8a31\u3055\u306a\u3044\u300d\u3001neverallow\u3068\u3044\u3046\u7279\u5225\u306a\u30eb\u30fc\u30eb\u3082\u3042\u308b\u3002\n\n<dl>\n<dt>allow</dt>\n<dd>\u30a2\u30af\u30bb\u30b9\u3092\u8a31\u53ef\u3057\u3001\u30a2\u30af\u30bb\u30b9\u304c\u8a66\u307f\u3089\u308c\u305f\u5834\u5408\u76e3\u67fb\u30ed\u30b0\u306b\u8a18\u9332\u3057\u306a\u3044</dd>\n<dt>auditallow</dt>\n<dd>\u30a2\u30af\u30bb\u30b9\u3092\u8a31\u53ef\u3057\u3001\u30a2\u30af\u30bb\u30b9\u304c\u8a66\u307f\u3089\u308c\u305f\u5834\u5408\u76e3\u67fb\u30ed\u30b0\u306b\u8a18\u9332\u3059\u308b</dd>\n<dt>dontaudit</dt>\n<dd>\u30a2\u30af\u30bb\u30b9\u3092\u8a31\u53ef\u305b\u305a\u3001\u30a2\u30af\u30bb\u30b9\u304c\u8a66\u307f\u3089\u308c\u305f\u5834\u5408\u76e3\u67fb\u30ed\u30b0\u306b\u8a18\u9332\u3057\u306a\u3044</dd>\n</dl>\n\n\u30a2\u30af\u30bb\u30b9\u3092\u8a31\u53ef\u3059\u308b\u30fb\u8a31\u53ef\u3057\u306a\u3044\u3068\u3044\u3046\u89b3\u70b9\u3068\u76e3\u67fb\u30ed\u30b0\u306b\u8a18\u9332\u3059\u308b\u30fb\u8a18\u9332\u3057\u306a\u3044\u3068\u3044\u3046\u89b3\u70b9\u3067\u30012x2\u3067\u6307\u5b9a\u306a\u3057\u3082\u542b\u3081\u3066\u5408\u308f\u305b\u30664\u7a2e\u985e\u3068\u3044\u3046\u308f\u3051\u3060\u3002\n\n\u500b\u3005\u306e\u30eb\u30fc\u30eb\u3092SELinux\u3067\u306f**\u30a2\u30af\u30bb\u30b9\u30d9\u30af\u30bf\u30eb\u30fc\u30eb**\u3068\u547c\u3093\u3067\u3044\u308b\u3002\n\u30a2\u30af\u30bb\u30b9\u30d9\u30af\u30bf\u30eb\u30fc\u30eb\u304c1\u3064\u3082\u5b9a\u7fa9\u3055\u308c\u3066\u3044\u306a\u3044\u72b6\u614b\u3067\u306f\u307e\u3063\u305f\u304f\u4f55\u3082\u52d5\u304b\u306a\u3044\u306e\u3067\u3001selinux-policy-xx\u30d1\u30c3\u30b1\u30fc\u30b8\uff08xx\u306f /etc/selinux/config \u306eSELINUXTYPE=\u884c\u306e\u5024\uff09\u306b\u3088\u3063\u3066\u63d0\u4f9b\u3055\u308c\u308b\u30eb\u30fc\u30eb\u306b\u3088\u3063\u3066\u30b7\u30b9\u30c6\u30e0\u3092\u52d5\u304b\u3059\u3053\u3068\u306b\u306a\u308b\u3002\n\n\u3064\u307e\u308aSELinux\u306b\u3088\u3063\u3066\u30d7\u30ed\u30b0\u30e9\u30e0\u304c\u3053\u3061\u3089\u306e\u610f\u56f3\u306b\u53cd\u3057\u3066\u52d5\u304b\u306a\u304f\u306a\u308b\u72b6\u614b\u3068\u306f\u3001selinux-policy-xx\u30d1\u30c3\u30b1\u30fc\u30b8\u306b\u3088\u3063\u3066allow\u3042\u308b\u3044\u306fauditallow\u3055\u308c\u305f\u30a2\u30af\u30bb\u30b9\u30d9\u30af\u30bf\u30eb\u30fc\u30eb\u4ee5\u5916\u306e\u3053\u3068\u3092\u5b9f\u884c\u3057\u3088\u3046\u3068\u3057\u305f\u72b6\u614b\u3001\u3068\u3044\u3046\u308f\u3051\u3060\u3002\n\n# SELinux\u306e\u305b\u3044\u3067\u52d5\u304b\u306a\u3044\u3068\u601d\u3063\u305f\u6642\u306b\u4f55\u3092\u3059\u308c\u3070\u826f\u3044\u304b\n\n## \u305d\u306e\u554f\u984c\u304cSELinux\u306e\u305b\u3044\u304b\u3069\u3046\u304b\u3092\u898b\u5206\u3051\u308b\n\n\u30d7\u30ed\u30b0\u30e9\u30e0\u304c\u3053\u3061\u3089\u306e\u610f\u56f3\u306b\u53cd\u3057\u3066\u52d5\u304b\u306a\u3044\u5834\u5408\u3001\u307e\u305a\u306f\u305d\u308c\u304cSELinux\u306b\u3088\u3063\u3066\u30a2\u30af\u30bb\u30b9\u304c\u62d2\u5426\u3055\u308c\u305f\u305b\u3044\u304b\u3069\u3046\u304b\u3092\u898b\u6975\u3081\u308b\u5fc5\u8981\u304c\u3042\u308b\u3002\n\u305d\u306e\u305f\u3081\u306b\u306fSELinux\u306e\u72b6\u614b\u3092`setenforce 0`\u3067\u4e00\u6642\u7684\u306bpermissive\u306b\u3057\u3001\u305d\u308c\u3067\u52d5\u304f\u3088\u3046\u306b\u306a\u308c\u3070SELinux\u304c\u539f\u56e0\u3067\u3042\u308b\u3068\u8a00\u3048\u308b\u3002\n\n\u30d5\u30a1\u30a4\u30eb\u306e\u30d1\u30fc\u30df\u30c3\u30b7\u30e7\u30f3\u306b\u3088\u308b\u30a2\u30af\u30bb\u30b9\u5236\u5fa1\u306fTE\u306b\u3088\u308b\u30a2\u30af\u30bb\u30b9\u5236\u5fa1\u3088\u308a\u5148\u306b\u5224\u5b9a\u3055\u308c\u308b\u3002\n\u5f93\u3063\u3066\u30d5\u30a1\u30a4\u30eb\u306e\u30d1\u30fc\u30df\u30c3\u30b7\u30e7\u30f3\u3092\u89e3\u6c7a\u3057\u305f\u5f8c\u306b\u306a\u3063\u3066SELinux\u306b\u3088\u308b\u554f\u984c\u304c\u9855\u5728\u5316\u3059\u308b\u3053\u3068\u3082\u3042\u308b\u3002\n\npermissive\u306b\u5909\u66f4\u3059\u308b\u306e\u306b\u306f\u3082\u3046\u4e00\u3064\u610f\u5473\u304c\u3042\u308b\u3002\nenforcing\u306e\u72b6\u614b\u3067\u306fSELinux\u306b\u3088\u308b\u8907\u6570\u306e\u554f\u984c\u304c\u3042\u3063\u305f\u5834\u5408\u3001\u6700\u521d\u306b\u5f53\u305f\u3063\u305f\u554f\u984c\u306e\u6642\u70b9\u3067\u51e6\u7406\u304c\u7d42\u4e86\u3057\u3001\u76e3\u67fb\u30ed\u30b0\u306b\u305d\u308c\u3057\u304b\u6b8b\u3089\u306a\u3044\u306e\u3067\u305d\u306e\u5206\u3092\u89e3\u6c7a\u3057\u3066\u3082\u307e\u305f\u3059\u3050\u306b\u6b21\u306e\u554f\u984c\u306b\u5f53\u305f\u308b\u3053\u3068\u306b\u306a\u308b\u3002\npermissive\u306b\u3057\u305f\u5834\u5408\u3001\u8907\u6570\u306e\u554f\u984c\u304c\u76e3\u67fb\u30ed\u30b0\u306b\u6b8b\u308b\u306e\u3067\u4e00\u62ec\u3057\u3066\u89e3\u6c7a\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u308b\u3002\n\n\u3082\u3061\u308d\u3093permissive\u306b\u3059\u308b\u306e\u306f\u4e00\u6642\u7684\u306a\u3053\u3068\u3067\u3042\u308a\u3001\u554f\u984c\u3092\u89e3\u6c7a\u3059\u308b\u305f\u3081\u306e\u30a2\u30af\u30b7\u30e7\u30f3\u3092\u53d6\u3063\u305f\u5f8c`setenforce 1`\u3067enforcing\u306b\u623b\u3057\u3066\u5b9f\u969b\u306b\u554f\u984c\u304c\u89e3\u6c7a\u3057\u3066\u3044\u308b\u304b\u3069\u3046\u304b\u3092\u78ba\u8a8d\u3059\u308b\u5fc5\u8981\u304c\u3042\u308b\u3002\n\n## \u76e3\u67fb\u30ed\u30b0\u3092\u78ba\u8a8d\u3059\u308b\n\nSELinux\u306b\u3088\u3063\u3066\u554f\u984c\u304c\u767a\u751f\u3057\u305f\u5834\u5408\u3001\u76e3\u67fb\u30ed\u30b0\u3092\u78ba\u8a8d\u3059\u308b\u3053\u3068\u306b\u3088\u3063\u3066\u305d\u306e\u554f\u984c\u304c\u3069\u306e\u3088\u3046\u306a\u3082\u306e\u304b\u3092\u77e5\u308b\u3053\u3068\u304c\u3067\u304d\u308b\u3002\n\u76e3\u67fb\u30ed\u30b0\u306fauditd\u30b5\u30fc\u30d3\u30b9\u306b\u3088\u3063\u3066\u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u306f /var/log/audit/audit.log \u306b\u51fa\u529b\u3055\u308c\u3066\u3044\u308b\u3002\n\n```\ntype=AVC msg=audit(1436807141.396:399): avc:  denied  { open } for  pid=2363 comm=\"httpd\" path=\"/var/www/html/1.html\" dev=\"dm-4\" ino=19923324 scontext=system_u:system_r:httpd_t:s0 tcontext=unconfined_u:object_r:user_tmp_t:s0 tclass=file\ntype=SYSCALL msg=audit(1436807141.396:399): arch=c000003e syscall=2 success=no exit=-13 a0=7fbf95c62290 a1=80000 a2=0 a3=7ffe31bbf530 items=0 ppid=1277 pid=2363 auid=4294967295 uid=48 gid=48 euid=48 suid=48 fsuid=48 egid=48 sgid=48 fsgid=48 tty=(none) ses=4294967295 comm=\"httpd\" exe=\"/usr/sbin/httpd\" subj=system_u:system_r:httpd_t:s0 key=(null)\n```\n\n\u898b\u308b\u3079\u304d\u306ftype=AVC\u3067\u59cb\u307e\u308b\u884c\u3067\u3042\u308b\u3002\u6b21\u306e\u3088\u3046\u306a\u610f\u5473\u306b\u306a\u308a\u3001\u3069\u306e\u3088\u3046\u306a\u554f\u984c\u304c\u767a\u751f\u3057\u305f\u306e\u304b\u3092\u5224\u5225\u3067\u304d\u308b\u3002\n\n<dl>\n<dt>denied  { }</dt>\n<dd>{ }\u5185\u306e\u64cd\u4f5c\u304c\u62d2\u5426\u3055\u308c\u305f</dd>\n<dt>comm</dt>\n<dd>\u30d7\u30ed\u30bb\u30b9\u306e\u30b3\u30de\u30f3\u30c9\u540d</dd>\n<dt>path\u306a\u3069\u3044\u308d\u3044\u308d</dt>\n<dd>\u30a2\u30af\u30bb\u30b9\u3055\u308c\u305f\u30ea\u30bd\u30fc\u30b9</dd>\n<dt>scontext</dt>\n<dd>\u30d7\u30ed\u30bb\u30b9\u306eSELinux\u30b3\u30f3\u30c6\u30ad\u30b9\u30c8</dd>\n<dt>tcontext</dt>\n<dd>\u30a2\u30af\u30bb\u30b9\u3055\u308c\u305f\u30ea\u30bd\u30fc\u30b9\u306eSELinux\u30b3\u30f3\u30c6\u30ad\u30b9\u30c8</dd>\n<dt>tclass</dt>\n<dd>\u30a2\u30af\u30bb\u30b9\u3055\u308c\u305f\u30ea\u30bd\u30fc\u30b9\u306e\u30af\u30e9\u30b9</dd>\n</dl>\n\n\u76e3\u67fb\u30ed\u30b0\u306f`ausearch -m avc`\u3067\u898b\u308b\u3053\u3068\u3082\u3067\u304d\u308b\u3002\u767a\u751f\u65e5\u6642\u304c\u308f\u304b\u308a\u3084\u3059\u3044\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u3067\u8868\u793a\u3055\u308c\u308b\u5206\u3053\u3061\u3089\u306e\u65b9\u304c\u826f\u3044\u3068\u601d\u3046\u3002\n\n```\ntime->Tue Jul 14 02:05:41 2015\ntype=SYSCALL msg=audit(1436807141.396:399): arch=c000003e syscall=2 success=no exit=-13 a0=7fbf95c62290 a1=80000 a2=0 a3=7ffe31bbf530 items=0 ppid=1277 pid=2363 auid=4294967295 uid=48 gid=48 euid=48 suid=48 fsuid=48 egid=48 sgid=48 fsgid=48 tty=(none) ses=4294967295 comm=\"httpd\" exe=\"/usr/sbin/httpd\" subj=system_u:system_r:httpd_t:s0 key=(null)\ntype=AVC msg=audit(1436807141.396:399): avc:  denied  { open } for  pid=2363 comm=\"httpd\" path=\"/var/www/html/1.html\" dev=\"dm-4\" ino=19923324 scontext=system_u:system_r:httpd_t:s0 tcontext=unconfined_u:object_r:user_tmp_t:s0 tclass=file\n```\n\n\u307e\u305fausearch\u306b\u306f\u8c4a\u5bcc\u306a\u7d5e\u308a\u8fbc\u307f\u30aa\u30d7\u30b7\u30e7\u30f3\u304c\u3042\u308a\u3001\u4f8b\u3048\u3070-ts\u30aa\u30d7\u30b7\u30e7\u30f3\u306f\u6307\u5b9a\u3057\u305f\u65e5\u6642\u4ee5\u964d\u306e\u76e3\u67fb\u30ed\u30b0\u3060\u3051\u3092\u51fa\u529b\u3059\u308b\u3002\n\u3053\u306e\u65e5\u6642\u306fmm/dd/YYYY HH:MM:SS\u306e\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u3067\u6307\u5b9a\u3059\u308b\u3002\u3053\u308c\u3089\u3092\u30af\u30a9\u30fc\u30c8\u3067\u56f2\u3093\u3067\u306f\u306a\u3089\u306a\u3044\u3002\u65e5\u4ed8\u3092\u7701\u7565\u3057\u305f\u5834\u5408\u306f\u300c\u4eca\u65e5\u306e\u6307\u5b9a\u3057\u305f\u6642\u523b\u300d\u3001\u6642\u523b\u3092\u7701\u7565\u3057\u305f\u5834\u5408\u306f\u300c\u6307\u5b9a\u65e5\u306e0\u6642\u3061\u3087\u3046\u3069[^3]\u300d\u3068\u3057\u3066\u6271\u308f\u308c\u308b\u3002\u65e5\u4ed8\u306e\u4ee3\u308f\u308a\u306btoday\u3068\u304byesterday\u3068\u304b\u3067\u6307\u5b9a\u3082\u3067\u304d\u308b\u3002\n\n[^3]: man\u3092\u8aad\u3080\u9650\u308a\u6b63\u78ba\u306b\u306f00:00:01\u3067\u3042\u308b\u53ef\u80fd\u6027\u304c\u9ad8\u3044\u3002\u306a\u304a\u3001\u6307\u5b9a\u3057\u305f\u6642\u523b\u3061\u3087\u3046\u3069\u306f\u691c\u7d22\u7d50\u679c\u306b\u542b\u307e\u308c\u308b\u3002\n\n\u3068\u3053\u308d\u3067\u3001\u30a2\u30af\u30bb\u30b9\u304c\u62d2\u5426\u3055\u308c\u3066\u3044\u308b\u306e\u306b\u76e3\u67fb\u30ed\u30b0\u306b\u306f\u6b8b\u3089\u306a\u3044dontaudit\u3068\u3044\u3046\u30a2\u30af\u30bb\u30b9\u30d9\u30af\u30bf\u30eb\u30fc\u30eb\u306e\u7a2e\u985e\u304c\u3042\u308b\u3053\u3068\u3092\u8aac\u660e\u3057\u305f\u3002\n\u76e3\u67fb\u30ed\u30b0\u306b\u8a18\u9332\u3055\u308c\u3066\u3044\u306a\u3044\u3053\u3068\u306b\u306f\u5bfe\u51e6\u3067\u304d\u306a\u3044\u306e\u3067\u3001enforcing\u6642\u306b\u30a2\u30af\u30bb\u30b9\u62d2\u5426\u3055\u308c\u308b\u306e\u306b\u76e3\u67fb\u30ed\u30b0\u306b\u306f\u4e8b\u8c61\u304c\u8a18\u9332\u3055\u308c\u3066\u3044\u306a\u3044\u3088\u3046\u306a\u3089dontaudit\u30eb\u30fc\u30eb\u3092\u7121\u52b9\u5316\u3057\u3066\u3057\u307e\u3046\u306e\u304c\u826f\u3044\u3002\n\u6b21\u306e\u30b3\u30de\u30f3\u30c9\u3067\u3059\u3079\u3066\u306edontaudit\u30eb\u30fc\u30eb\u3092\u7121\u52b9\u5316\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u308b\u3002\n\n```\n# semodule -DB\n```\n\n\u3057\u304b\u3057dontaudit\u30eb\u30fc\u30eb\u304c\u7121\u52b9\u5316\u3055\u308c\u3066\u3044\u308b\u3068\u3001\u6b21\u306e\u9805\u3067\u8aac\u660e\u3059\u308bsetroubleshoot\u304c\u50cd\u304b\u306a\u304f\u306a\u308b\u3088\u3046\u306a\u306e\u3067\u4f7f\u3044\u5206\u3051\u304c\u5fc5\u8981\u306b\u306a\u308b\u3002\n\u3059\u3079\u3066\u306edontaudit\u30eb\u30fc\u30eb\u3092\u518d\u5ea6\u6709\u52b9\u5316\u3059\u308b\u306b\u306f\u6b21\u306e\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3059\u308b\u3002\n\n```\n# semodule -B\n```\n\n## setroubleshoot\n\n\u76e3\u67fb\u30ed\u30b0\u3092\u898b\u3066\u554f\u984c\u306e\u539f\u56e0\u304c\u5224\u660e\u3059\u308c\u3070\u3001\u6b21\u306e\u3088\u3046\u306a\u30a2\u30af\u30b7\u30e7\u30f3\u3092\u884c\u3044\u89e3\u6c7a\u3092\u76ee\u6307\u3059\u3053\u3068\u306b\u306a\u308b\u3002\n\n* SELinux\u30d6\u30fc\u30eb\u5024\u3092\u5909\u66f4\u3057\u3001\u30a2\u30af\u30bb\u30b9\u30d9\u30af\u30bf\u30eb\u30fc\u30eb\u3092\u8ffd\u52a0\u9069\u7528\u3059\u308b\n* \u30ea\u30bd\u30fc\u30b9\u306e\u30bf\u30a4\u30d7\u3092\u6b63\u3057\u3044\u3082\u306e\u306b\u76f4\u3059\n* \u76e3\u67fb\u30ed\u30b0\u304b\u3089\u30a2\u30af\u30bb\u30b9\u30d9\u30af\u30bf\u30eb\u30fc\u30eb\u3092\u751f\u6210\u3057\u9069\u7528\u3059\u308b\n\n\u500b\u3005\u306e\u8aac\u660e\u306f\u5f8c\u7a0b\u884c\u3046\u304c\u3001\u3053\u308c\u3089\u306e\u3046\u3061\u3069\u306e\u30a2\u30af\u30b7\u30e7\u30f3\u3092\u9078\u629e\u3059\u308c\u3070\u826f\u3044\u304b\u306e\u6307\u91dd\u3092\u4e0e\u3048\u3066\u304f\u308c\u308bsetroubleshoot\uff08\u5b9f\u884c\u30d5\u30a1\u30a4\u30eb\u540d\u306fsetroubleshootd\uff09\u3068\u3044\u3046\u3082\u306e\u304c\u3042\u308b\u3002\nsetroubleshoot\u306f\u76e3\u67fb\u30ed\u30b0\u304c\u51fa\u529b\u3055\u308c\u308b\u30bf\u30a4\u30df\u30f3\u30b0\u3067\u305d\u306e\u5bfe\u5fdc\u65b9\u6cd5\u3092\u5c0e\u304d\u51fa\u3057 /var/log/messages \u306b\u51fa\u529b\u3057\u3066\u304f\u308c\u308b\u3082\u306e\u3067\u3042\u308b\u3002\n\nsetroubleshoot\u3092\u5229\u7528\u3059\u308b\u306b\u306fsetroubleshoot-server\u30d1\u30c3\u30b1\u30fc\u30b8\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\u3002[^4]\n\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u5f8c\u3001TE\u306e\u30a2\u30af\u30bb\u30b9\u5236\u5fa1\u306b\u5f15\u3063\u304b\u304b\u308a\u76e3\u67fb\u30ed\u30b0\u304c\u51fa\u529b\u3055\u308c\u305f\u6642\u306b /var/log/messages \uff08Fedora 22\u3067\u306fjournalctl\u3092\u898b\u305f\u65b9\u304c\u826f\u3044\uff09\u306e\u4e2d\u306b1\u3064\u306e\u30bf\u30a4\u30e0\u30b9\u30bf\u30f3\u30d7\u306b\u5bfe\u3059\u308b\u51fa\u529b\u3068\u3057\u3066\u6b21\u306e\u3088\u3046\u306a\u30ed\u30b0\u304c\u73fe\u308c\u308b\u3002\n\n[^4]: setroubleshoot-server\u306f\u30d1\u30c3\u30b1\u30fc\u30b8\u540d\u306bserver\u3068\u3044\u3046\u6587\u5b57\u5217\u3092\u542b\u3080\u304c\u3001\u30c7\u30b9\u30af\u30c8\u30c3\u30d7\u74b0\u5883\u7528\u306eGUI\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u542b\u307e\u306a\u3044\u3001\u7a0b\u5ea6\u306e\u610f\u5473\u5408\u3044\u3060\u3068\u63a8\u6e2c\u3055\u308c\u308b\u3002\u30c7\u30b9\u30af\u30c8\u30c3\u30d7\u74b0\u5883\u7528\u306eGUI\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u542b\u3093\u3060\u30d1\u30c3\u30b1\u30fc\u30b8\u306fsetroubleshoot\u3002\n\n```\nJul 14 22:06:36 localhost python: SELinux is preventing /usr/sbin/httpd from name_connect access on the tcp_socket port 25151.\n\n***** Plugin catchall_boolean (47.5 confidence) suggests ******************\n\nIf you want to allow httpd to can network connect cobbler\nThen you must tell SELinux about this by enabling the 'httpd_can_network_connect_cobbler' boolean.\n\nDo\nsetsebool -P httpd_can_network_connect_cobbler 1\n\n***** Plugin catchall_boolean (47.5 confidence) suggests ******************\n\nIf you want to allow httpd to can network connect\nThen you must tell SELinux about this by enabling the 'httpd_can_network_connect' boolean.\n\nDo\nsetsebool -P httpd_can_network_connect 1\n\n***** Plugin catchall (6.38 confidence) suggests **************************\n\nIf you believe that httpd should be allowed name_connect access on the port 25151 tcp_socket by default.\nThen you should report this as a bug.\nYou can generate a local policy module to allow this access.\nDo\nallow this access for now by executing:\n# grep httpd /var/log/audit/audit.log | audit2allow -M mypol\n# semodule -i mypol.pp\n```\n\npermissive\u72b6\u614b\u306b\u3057\u3066\u3042\u308c\u3070\u554f\u984c\u304c\u8907\u6570\u3042\u3063\u305f\u306a\u3089\u3001\u3053\u306e\u3088\u3046\u306a\u30ed\u30b0\u3082\u8907\u6570\u73fe\u308c\u308b\u306f\u305a\u3060\u3002\n\n1\u3064\u3082\u73fe\u308c\u306a\u3044\u5834\u5408\u3001auditd\u30b5\u30fc\u30d3\u30b9\u3092reload\u3057\u3066\u304b\u3089\u3082\u3046\u4e00\u5ea6\u76e3\u67fb\u30ed\u30b0\u3092\u51fa\u529b\u3055\u305b\u3066\u307f\u308b\u3002\u305d\u308c\u3067\u3082\u73fe\u308c\u306a\u3051\u308c\u3070OS\u518d\u8d77\u52d5\u3057\u3066\u307f\u308b\u3002\n\u307e\u305f\u3001CentOS 6\u3060\u3068\u4e0a\u8a18\u306e\u3088\u3046\u306a\u884c\u306f\u73fe\u308c\u305a\u6b21\u306e\u3088\u3046\u306a\u6587\u5b57\u5217\u3092\u542b\u3080\u884c\u304c\u73fe\u308c\u308b\u3002\n\n```\nFor complete SELinux messages. run sealert -l 7d8bffe6-d07f-4971-84a5-9fe70ebeba76\n```\n\n\u3053\u306e\u5834\u5408\u3001\u66f8\u304b\u308c\u3066\u3044\u308b\u3088\u3046\u306b`sealert -l 7d8bffe6-d07f-4971-84a5-9fe70ebeba76`\u3092\u5b9f\u884c\u3059\u308c\u3070\u5148\u7a0b\u793a\u3057\u305f\u3088\u3046\u306a\u30ed\u30b0\u304c\u8868\u793a\u3055\u308c\u308b\u3002\n\n\u3053\u306e\u30ed\u30b0\u306e\u4e2d\u3067\u4e00\u756a\u6700\u521d\u306b\u66f8\u304b\u308c\u3066\u3044\u308b*****\u306b\u56f2\u307e\u308c\u3066\u66f8\u304b\u308c\u3066\u3044\u308b\u30d7\u30e9\u30b0\u30a4\u30f3\u540d\u3092\u8abf\u3079\u308b\u3002\n\u4e0a\u8a18\u30ed\u30b0\u306e\u4f8b\u306a\u3089\u305d\u306e\u30d7\u30e9\u30b0\u30a4\u30f3\u540d\u306f\u300ccatchall_boolean\u300d\u3067\u3042\u308b\u3002\n\n\u3053\u306e\u30d7\u30e9\u30b0\u30a4\u30f3\u540d\u304b\u3089\u6b21\u306b\u884c\u3046\u30a2\u30af\u30b7\u30e7\u30f3\u3092\u6c7a\u5b9a\u3059\u308b\u3002\n\u6b21\u9805\u3067\u30d7\u30e9\u30b0\u30a4\u30f3\u540d\u3054\u3068\u306b\u4f55\u3092\u3059\u3079\u304d\u304b\u3092\u793a\u3059\u3002\n\n## \u554f\u984c\u89e3\u6c7a\u306e\u305f\u3081\u306b\u5b9f\u884c\u3059\u3079\u304d\u30a2\u30af\u30b7\u30e7\u30f3\n\n### catchall_boolean \u2192 SELinux\u30d6\u30fc\u30eb\u5024\u306e\u5909\u66f4\n\n**SELinux\u30d6\u30fc\u30eb\u5024**\u3068\u306f\u3001\u30a2\u30af\u30bb\u30b9\u30d9\u30af\u30bf\u30eb\u30fc\u30eb\u3092\u3044\u304f\u3064\u304b\u307e\u3068\u3081\u3066\u7ba1\u7406\u8005\u304c\u6709\u52b9\u5316\u3001\u3042\u308b\u3044\u306f\u7121\u52b9\u5316\u3067\u304d\u308b\u3088\u3046\u306b\u3057\u305f\u3082\u306e\u3067\u3042\u308b\u3002\n\u3042\u308b\u30d7\u30ed\u30b0\u30e9\u30e0\u306b\u304a\u3044\u3066\u3059\u3079\u3066\u306e\u6a5f\u80fd\u3092\u4f7f\u308f\u306a\u3044\u5834\u5408\u3001\u4f7f\u308f\u306a\u3044\u6a5f\u80fd\u306e\u305f\u3081\u306e\u30a2\u30af\u30bb\u30b9\u30d9\u30af\u30bf\u30eb\u30fc\u30eb\u306f\u8a31\u53ef\u3057\u306a\u3044\u307e\u307e\u3001\u4f7f\u3046\u6a5f\u80fd\u306e\u305f\u3081\u306e\u30a2\u30af\u30bb\u30b9\u30d9\u30af\u30bf\u30eb\u30fc\u30eb\u3060\u3051\u3092\u8a31\u53ef\u3059\u308b\u3001\u3068\u3044\u3046\u3088\u3046\u306b\u3067\u304d\u308b\u3060\u3051\u5c11\u306a\u3044\u30a2\u30af\u30bb\u30b9\u6a29\u9650\u3067\u904b\u7528\u3059\u308b\u3053\u3068\u3092\u53ef\u80fd\u306b\u3059\u308b\u305f\u3081\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3002\n\n\u3042\u308bSELinux\u30d6\u30fc\u30eb\u5024\u3092\u30aa\u30f3\u306b\u3059\u308b\u305f\u3081\u306b\u306f`setsebool -P <SELinux\u30d6\u30fc\u30eb\u5024\u540d> 1`\u3092\u3001\u30aa\u30d5\u306b\u3059\u308b\u305f\u3081\u306b\u306f`setsebool -P <SELinux\u30d6\u30fc\u30eb\u5024\u540d> 0`\u3092\u5b9f\u884c\u3059\u308b\u3002\n\u3053\u306e-P\u30aa\u30d7\u30b7\u30e7\u30f3\u306fOS\u518d\u8d77\u52d5\u5f8c\u3082\u5909\u66f4\u3092\u6c38\u7d9a\u5316\u3059\u308b\u305f\u3081\u306e\u30aa\u30d7\u30b7\u30e7\u30f3\u3067\u3042\u308b\u3002\n\n\u5148\u7a0b\u306esetroubleshoot\u306e\u30ed\u30b0\u3067\u306f\u30011\u3064\u76ee\u306ecatchall_boolean\u306b`setsebool -P httpd_can_network_connect_cobbler 1`\u3092\u30012\u3064\u76ee\u306ecatchall_boolean\u306b`setsebool -P httpd_can_network_connect 1`\u3092\u5b9f\u884c\u3057\u308d\u3068\u66f8\u304b\u308c\u3066\u3044\u308b\u3002\n\n\u3064\u307e\u308a\u3053\u306e\u554f\u984c\u306fhttpd_can_network_connect_cobbler\u304bhttpd_can_network_connect\u304b\u3069\u3061\u3089\u304b1\u3064\u306eSELinux\u30d6\u30fc\u30eb\u5024\u3092\u6709\u52b9\u306b\u3059\u308c\u3070\u89e3\u6c7a\u3067\u304d\u308b\u3001\u3068\u3044\u3046\u3053\u3068\u3060\u3002\n\n\u4f55\u6545\u3069\u3061\u3089\u304b1\u3064\u306a\u306e\u304b\u3002\n\u3042\u308bSELinux\u30d6\u30fc\u30eb\u5024\u3067\u6709\u52b9\u5316/\u7121\u52b9\u5316\u3067\u304d\u308b\u30a2\u30af\u30bb\u30b9\u30d9\u30af\u30bf\u30eb\u30fc\u30eb\u306e\u30ea\u30b9\u30c8\u306f`sesearch --allow --auditallow -C -b <SELinux\u30d6\u30fc\u30eb\u5024\u540d>`\u3067\u53d6\u5f97\u3067\u304d\u308b\u3002\n--allow\u30aa\u30d7\u30b7\u30e7\u30f3\u306fallow\u30eb\u30fc\u30eb\u3092\u8868\u793a\u3001--auditallow\u30aa\u30d7\u30b7\u30e7\u30f3\u306fauditallow\u30eb\u30fc\u30eb\u3092\u8868\u793a\u3001-C\u30aa\u30d7\u30b7\u30e7\u30f3\u306f\u5f8c\u3067\u8aac\u660e\u3059\u308b\u3001-b\u30aa\u30d7\u30b7\u30e7\u30f3\u306fSELinux\u30d6\u30fc\u30eb\u5024\u540d\u3067\u7d5e\u308a\u8fbc\u3080\u3068\u3044\u3046\u30aa\u30d7\u30b7\u30e7\u30f3\u3067\u3042\u308b\u3002\n\n\u6b21\u306fhttpd_can_network_connect_cobbler\u30d6\u30fc\u30eb\u5024\u306e\u5185\u5bb9\u3067\u3042\u308b\u3002\n\n```\n# sesearch --allow --auditallow -C -b httpd_can_network_connect_cobbler\nFound 1 semantic av rules:\nDT allow httpd_t cobbler_port_t : tcp_socket name_connect ; [ httpd_can_network_connect_cobbler ]\n```\n\n\u307e\u305f\u6b21\u306fhttpd_can_network_connect\u30d6\u30fc\u30eb\u5024\u306e\u5185\u5bb9\u3067\u3042\u308b\u3002\n\n```\n# sesearch --allow --auditallow -C -b httpd_can_network_connect\nFound 17 semantic av rules:\nDT allow httpd_t port_type : tcp_socket name_connect ; [ httpd_can_network_connect ]\nDT allow httpd_sys_script_t netif_t : netif { tcp_recv tcp_send udp_recv udp_send ingress egress } ; [ httpd_enable_cgi httpd_can_network_connect && ]\nDT allow httpd_suexec_t client_packet_type : packet { send recv } ; [ httpd_can_network_connect ]\nDT allow httpd_suexec_t node_t : node { tcp_recv tcp_send udp_recv udp_send recvfrom sendto } ; [ httpd_can_network_connect ]\nDT allow httpd_sys_script_t port_type : tcp_socket { recv_msg send_msg name_connect } ; [ httpd_enable_cgi httpd_can_network_connect && ]\nDT allow httpd_sys_script_t port_type : udp_socket { recv_msg send_msg } ; [ httpd_enable_cgi httpd_can_network_connect && ]\nDT allow httpd_suexec_t httpd_suexec_t : tcp_socket { ioctl read write create getattr setattr lock append bind connect listen accept getopt setopt shutdown } ; [ httpd_can_network_connect ]\nDT allow httpd_suexec_t httpd_suexec_t : udp_socket { ioctl read write create getattr setattr lock append bind connect getopt setopt shutdown } ; [ httpd_can_network_connect ]\nDT allow httpd_suexec_t netif_t : netif { tcp_recv tcp_send udp_recv udp_send ingress egress } ; [ httpd_can_network_connect ]\nDT allow httpd_sys_script_t client_packet_type : packet { send recv } ; [ httpd_enable_cgi httpd_can_network_connect && ]\nDT allow httpd_sys_script_t httpd_sys_script_t : tcp_socket { ioctl read write create getattr setattr lock append bind connect listen accept getopt setopt shutdown } ; [ httpd_enable_cgi httpd_can_network_connect && ]\nDT allow httpd_sys_script_t httpd_sys_script_t : udp_socket { ioctl read write create getattr setattr lock append bind connect getopt setopt shutdown } ; [ httpd_enable_cgi httpd_can_network_connect && ]\nDT allow httpd_sys_script_t node_t : tcp_socket node_bind ; [ httpd_enable_cgi httpd_can_network_connect && ]\nDT allow httpd_sys_script_t node_t : udp_socket node_bind ; [ httpd_enable_cgi httpd_can_network_connect && ]\nDT allow httpd_sys_script_t node_t : node { tcp_recv tcp_send udp_recv udp_send recvfrom sendto } ; [ httpd_enable_cgi httpd_can_network_connect && ]\nDT allow httpd_suexec_t port_type : tcp_socket { recv_msg send_msg name_connect } ; [ httpd_can_network_connect ]\nDT allow httpd_suexec_t port_type : udp_socket { recv_msg send_msg } ; [ httpd_can_network_connect ]\n```\n\nsesearch\u306e\u51fa\u529b\u7d50\u679c\u306e\u8aad\u307f\u65b9\u306f\u6b21\u306e\u901a\u308a\u3067\u3042\u308b\u3002\n\n* \u6700\u521d\u306e\u300cDT\u300d\u306f1\u6587\u5b57\u76ee\u304cD\u2192\u73fe\u5728\u7121\u52b9\u3001E\u2192\u73fe\u5728\u6709\u52b9\u3068\u3044\u3046\u610f\u5473\u3067\u30012\u6587\u5b57\u76ee\u306fT\u2192\u30aa\u30f3\u306e\u6642\u306b\u6709\u52b9\u3001F\u2192\u30aa\u30d5\u306e\u6642\u306b\u6709\u52b9\u3068\u3044\u3046\u610f\u5473\u3067\u3042\u308b\u3002-C\u30aa\u30d7\u30b7\u30e7\u30f3\u3092\u6307\u5b9a\u3057\u305f\u6642\u306e\u307f\u8868\u793a\u3055\u308c\u308b\u3002\n* \u6b21\u306e\u300callow\u300d\u306f\u30a2\u30af\u30bb\u30b9\u30d9\u30af\u30bf\u30eb\u30fc\u30eb\u306e\u7a2e\u985e\u304c\u8868\u793a\u3055\u308c\u308b\u3002\n* \u305d\u306e\u5f8c\u306f\"\u30c9\u30e1\u30a4\u30f3\"\u3001\"\u30bf\u30a4\u30d7\"\u3001\u30b3\u30ed\u30f3\u3092\u631f\u3093\u3067\"\u30af\u30e9\u30b9\"\u3001\"\u64cd\u4f5c\u306e\u7a2e\u985e\"\u3067\u3042\u308b\u3002\"\u64cd\u4f5c\u306e\u7a2e\u985e\"\u306f\u8907\u6570\u304c\u5bfe\u8c61\u306b\u306a\u3063\u3066\u3044\u308b\u5834\u5408\u306f\u307e\u3068\u3081\u3066{ }\u306b\u56f2\u307e\u308c\u3066\u8868\u793a\u3055\u308c\u308b\u3002\n* \u6700\u5f8c\u306b\u30bb\u30df\u30b3\u30ed\u30f3\u3092\u631f\u3093\u3067[ ]\u306b\u56f2\u307e\u308c\u3066SELinux\u30d6\u30fc\u30eb\u5024\u540d\u3067\u3042\u308b\u3002-C\u30aa\u30d7\u30b7\u30e7\u30f3\u3092\u6307\u5b9a\u3057\u305f\u6642\u306e\u307f\u8868\u793a\u3055\u308c\u308b\u3002\u8907\u6570\u306e\u30d6\u30fc\u30eb\u5024\u540d\u304c\u8868\u793a\u3055\u308c\u3066\u3044\u308b\u5834\u5408\u3001\u305d\u306e\u3059\u3079\u3066\u3092\u5909\u66f4\u3057\u306a\u3044\u3068\u6709\u52b9\u5316/\u7121\u52b9\u5316\u3067\u304d\u306a\u3044\u3002[^5]\n\n[^5]: \u8abf\u3079\u304c\u3064\u304b\u306a\u304b\u3063\u305f\u304c\u300c&&\u300d\u306f\u9006\u30dd\u30fc\u30e9\u30f3\u30c9\u8a18\u6cd5\u306e\u4f4d\u7f6e\u306b\u66f8\u304b\u308c\u305fAND\u6f14\u7b97\u5b50\u3068\u601d\u308f\u308c\u308b\u3002\n\nhttpd_can_network_connect\u30d6\u30fc\u30eb\u5024\u306e\u5185\u5bb9\u306e\u3046\u3061\u306e1\u884c\u306f\u3053\u3046\u306a\u3063\u3066\u3044\u308b\u3002\n\n```\nDT allow httpd_t port_type : tcp_socket name_connect ; [ httpd_can_network_connect ]\n```\n\n\u3053\u308c\u306fhttpd_can_network_connect_cobbler\u30d6\u30fc\u30eb\u5024\u306e\u552f\u4e00\u306e1\u884c\u306e\u5185\u5bb9\u3068\u6bd4\u3079\u308b\u3068\u3001\"\u30bf\u30a4\u30d7\"\u306e\u9805\u304ccobbler_port_t\u3067\u306f\u306a\u304f\u300cport_type\u300d\u3068\u306a\u3063\u3066\u3044\u308b\u3068\u3053\u308d\u3060\u3051\u304c\u76f8\u9055\u70b9\u3067\u3042\u308b\u3002\n\u3053\u306e\u3088\u3046\u306b\"\u30bf\u30a4\u30d7\"\u3084\"\u30c9\u30e1\u30a4\u30f3\"\u306e\u9805\u306b\u3042\u308a\u306a\u304c\u3089\\_t\u3067\u7d42\u308f\u3063\u3066\u3044\u306a\u3044\u3082\u306e\u306f\u3044\u304f\u3064\u304b\u306e\u30bf\u30a4\u30d7\u3084\u30c9\u30e1\u30a4\u30f3\u3092\u3072\u3068\u307e\u3068\u3081\u306b\u3057\u3066\u30b0\u30eb\u30fc\u30d7\u5316\u3057\u305f\u3082\u306e\u3067\u3042\u308a\u3001**\u30a2\u30c8\u30ea\u30d3\u30e5\u30fc\u30c8**\u3068\u547c\u3070\u308c\u308b\u3002\n1\u3064\u306e\u30a2\u30c8\u30ea\u30d3\u30e5\u30fc\u30c8\u306b\u542b\u307e\u308c\u308b\u30bf\u30a4\u30d7\u3084\u30c9\u30e1\u30a4\u30f3\u306f`seinfo -a<\u30a2\u30c8\u30ea\u30d3\u30e5\u30fc\u30c8\u540d> -x`\u3067\u53d6\u5f97\u3067\u304d\u308b\u3002\n`seinfo -aport_type -x | grep -w cobbler_port_t`\u3092\u5b9f\u884c\u3059\u308b\u3068\u3001port_type\u30a2\u30c8\u30ea\u30d3\u30e5\u30fc\u30c8\u306b\u306fcobbler_port_t\u30bf\u30a4\u30d7\u3082\u542b\u307e\u308c\u3066\u3044\u308b\u3053\u3068\u304c\u308f\u304b\u308b\u3002\n\n\u3064\u307e\u308a\u3001httpd_can_network_connect\u30d6\u30fc\u30eb\u5024\u306e\u3046\u3061\u306e1\u884c\u3067\u3042\u308b`DT allow httpd_t port_type : tcp_socket name_connect ; [ httpd_can_network_connect ]`\u306fhttpd_can_network_connect_cobbler\u30d6\u30fc\u30eb\u5024\u306e\u552f\u4e00\u306e1\u884c`DT allow httpd_t cobbler_port_t : tcp_socket name_connect ; [ httpd_can_network_connect_cobbler ]`\u3092\u5305\u542b\u3059\u308b\u3053\u3068\u304c\u308f\u304b\u308b\u3002\n\n\u5f93\u3063\u3066httpd_can_network_connect_cobbler\u30d6\u30fc\u30eb\u5024\u3092\u6709\u52b9\u306b\u3057\u3066\u3067\u304d\u308b\u3053\u3068\u306fhttpd_can_network_connect\u30d6\u30fc\u30eb\u5024\u3092\u6709\u52b9\u306b\u3059\u308b\u3053\u3068\u3067\u3082\u9054\u6210\u3067\u304d\u308b\u3001\u3068\u3044\u3046\u308f\u3051\u3067\u3042\u308b\u3002\n\n\u3067\u3001\u3069\u3061\u3089\u3092\u6709\u52b9\u306b\u3059\u3079\u304d\u304b\u3068\u306a\u308b\u3068\u3001\u6a29\u9650\u304c\u5c11\u306a\u3044\u65b9\u3068\u304b\u3088\u308a\u76f8\u5fdc\u3057\u3044\u65b9\u3068\u304b\u3067\u5224\u65ad\u3059\u308b\u3053\u3068\u306b\u306a\u308b\u3060\u308d\u3046\u3002\n`semanage boolean -l`\u3067SELinux\u30d6\u30fc\u30eb\u5024\u306e\u4e00\u89a7\u3092\u53d6\u5f97\u3067\u304d\u308b\u306e\u3067\u3001\u305d\u306e\u6700\u5f8c\u306b\u66f8\u304b\u308c\u3066\u3044\u308b\u7c21\u5358\u306a\u8aac\u660e\u3092\u8aad\u3093\u3067\u6c7a\u3081\u3066\u3082\u826f\u3044\u3002\n\n### restorecon \u2192 \u30a2\u30af\u30bb\u30b9\u3055\u308c\u305f\u30d5\u30a1\u30a4\u30eb\u306e\u30bf\u30a4\u30d7\u304c\u30c7\u30d5\u30a9\u30eb\u30c8\u8a2d\u5b9a\u3068\u306f\u7570\u306a\u308b\n\n\u300c\u30ea\u30bd\u30fc\u30b9\u306e\u30bf\u30a4\u30d7\u3092\u6b63\u3057\u3044\u3082\u306e\u306b\u76f4\u3059\u300d\u7de8\u306e1\u3064\u76ee\u3068\u3057\u3066\u3001\u30a2\u30af\u30bb\u30b9\u3055\u308c\u305f\u30d5\u30a1\u30a4\u30eb\u306e\u30bf\u30a4\u30d7\u304c\u30c7\u30d5\u30a9\u30eb\u30c8\u8a2d\u5b9a\u3068\u306f\u7570\u306a\u308b\u30d1\u30bf\u30fc\u30f3\u304c\u3042\u308b\u3002\n\n\u6b21\u306fhttpd\u3092start\u3057\u3001/tmp/1.html\u3092\u4f5c\u3063\u3066`cp -a /tmp/1.html /var/www/html`\u3092\u5b9f\u884c\u3057\u305f\u5f8c`curl http://localhost/1.html`\u3092\u5b9f\u884c\u3057\u305f\u304cTE\u306e\u30a2\u30af\u30bb\u30b9\u5236\u5fa1\u306b\u5f15\u3063\u639b\u304b\u308a\u30a8\u30e9\u30fc\u306b\u306a\u3063\u305f\u6642\u306esetroubleshoot\u306e\u51fa\u529b\u5185\u5bb9\u3067\u3042\u308b\u3002\n\n```\n*****  Plugin restorecon (92.2 confidence) suggests   ************************\n\nIf you want to fix the label.\n/var/www/html/1.html default label should be httpd_sys_content_t.\nThen you can run restorecon.\nDo\n# /sbin/restorecon -v /var/www/html/1.html\n```\n\n\u3053\u308c\u306f/var/www/html/1.html\u306e\u898f\u5b9a\u306e\u30bf\u30a4\u30d7\u304chttpd_sys_content_t\u3067\u3042\u308b\u306b\u3082\u304b\u304b\u308f\u3089\u305a\u5225\u306e\u3082\u306e\u306b\u306a\u3063\u3066\u3044\u308b\u306e\u304c\u554f\u984c\u306e\u539f\u56e0\u3067\u3042\u308a\u3001`/sbin/restorecon -v /var/www/html/1.html`\u3092\u5b9f\u884c\u3059\u308b\u3068\u89e3\u6c7a\u3059\u308b\u3001\u3068\u8a00\u3063\u3066\u3044\u308b\u3002\n\n\u3082\u3063\u3068\u3082\u89e3\u6c7a\u306b\u306f\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u5bfe\u3057\u3066`restorecon -RFv /var/www/html/`\u3068\u3057\u3066\u3057\u307e\u3063\u305f\u65b9\u304c\u826f\u3044\u3060\u308d\u3046\u3002\nrestorecon\u306f\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3084\u30d5\u30a1\u30a4\u30eb\u306eSELinux\u30b3\u30f3\u30c6\u30ad\u30b9\u30c8\u3092\u6c38\u7d9a\u7684\u306b\u898f\u5b9a\u306e\u3082\u306e\u306b\u5909\u66f4\u3059\u308b\u30b3\u30de\u30f3\u30c9\u3067\u3042\u308b\u3002\n-R\u30aa\u30d7\u30b7\u30e7\u30f3\u306f\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u5185\u3092\u518d\u5e30\u7684\u306b\u5b9f\u884c\u3059\u308b\u3001-F\u30aa\u30d7\u30b7\u30e7\u30f3\u306f\u5f37\u5236\u7684\u306b\u5909\u66f4\u3059\u308b\u3001-v\u30aa\u30d7\u30b7\u30e7\u30f3\u306fSELinux\u30b3\u30f3\u30c6\u30ad\u30b9\u30c8\u3092\u5909\u66f4\u3057\u305f\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3084\u30d5\u30a1\u30a4\u30eb\u3092\u8868\u793a\u3059\u308b\u3002\n\n\u3042\u308b\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3084\u30d5\u30a1\u30a4\u30eb\u306e\u898f\u5b9a\u306eSELinux\u30b3\u30f3\u30c6\u30ad\u30b9\u30c8\u306f`matchpathcon <\u30d1\u30b9>`\u3067\u53d6\u5f97\u3067\u304d\u308b\u3002\u30d1\u30b9\u306b\u306f*\u306a\u3069\u3092\u4f7f\u7528\u3067\u304d\u308b\u3002\n`semanage fcontext -l`\u3067\u898f\u5b9a\u306eSELinux\u30b3\u30f3\u30c6\u30ad\u30b9\u30c8\u306e\u4e00\u89a7\u304c\u53d6\u5f97\u3067\u304d\u308b\u304c\u3001\u3053\u3063\u3061\u306f\u3061\u3087\u3063\u3068\u8aad\u307f\u3065\u3089\u3044\u3002\n\n\u3053\u306e\u554f\u984c\u306f\u30d5\u30a1\u30a4\u30eb\u3092cp -a [^6] \u3084mv\u3067\u5225\u306e\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u6301\u3063\u3066\u3044\u304f\u3068\u5143\u306eSELinux\u30b3\u30f3\u30c6\u30ad\u30b9\u30c8\u306e\u307e\u307e\u306b\u306a\u308b\u3053\u3068\u304c\u539f\u56e0\u306b\u306a\u3063\u3066\u8d77\u3053\u308b\u3053\u3068\u304c\u591a\u3044\u3002\n\n[^6]: \u6b63\u78ba\u306b\u306f-a\u30aa\u30d7\u30b7\u30e7\u30f3\u304c\u542b\u6709\u3059\u308b\u300c--preserve=context\u300d\u306e\u5f71\u97ff\u3067\u3042\u308b\u3002\n\n\u5bfe\u7b56\u3068\u3057\u3066 /etc/selinux/restorecond.conf \u306b\u5217\u8a18\u3055\u308c\u305f\u30d1\u30b9\u3092\u81ea\u52d5\u7684\u306b\u898f\u5b9a\u306eSELinux\u30b3\u30f3\u30c6\u30ad\u30b9\u30c8\u306b\u4fee\u6b63\u3057\u3066\u304f\u308c\u308brestorecond\u30b5\u30fc\u30d3\u30b9\u3092\u4f7f\u7528\u3059\u308b\u306e\u3082\u826f\u3044\u3002\n\u4fee\u6b63\u3057\u3066\u304f\u308c\u308b\u30bf\u30a4\u30df\u30f3\u30b0\u306f\u304a\u305d\u3089\u304finotify\u30a4\u30d9\u30f3\u30c8\u304c\u767a\u751f\u3057\u305f\u6642\u3001\u3064\u307e\u308a\u30b3\u30d4\u30fc\u3084\u79fb\u52d5\u306a\u3069\u3092\u542b\u3080\u30d5\u30a1\u30a4\u30eb\u4f5c\u6210\u6642\u3084\u5909\u66f4\u6642\u3001\u5f8c\u306f\u30b5\u30fc\u30d3\u30b9\u8d77\u52d5\u6642\u3067\u3042\u308b\u3002\n\u305f\u3060\u3057\u3001\u30cf\u30fc\u30c9\u30ea\u30f3\u30af\u306b\u5bfe\u3057\u3066\u306f\u50cd\u304b\u306a\u3044\u3053\u3068\u306b\u6ce8\u610f\u3002\n\n### catchall_labels \u2192 \u53c2\u7167\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092\u6a19\u6e96\u4ee5\u5916\u306e\u3082\u306e\u306b\u3057\u305f\u5834\u5408\u306e\u5bfe\u5fdc\n\n\u300c\u30ea\u30bd\u30fc\u30b9\u306e\u30bf\u30a4\u30d7\u3092\u6b63\u3057\u3044\u3082\u306e\u306b\u76f4\u3059\u300d\u7de8\u306e2\u3064\u76ee\u306f1\u3064\u76ee\u3068\u4f3c\u3066\u3044\u308b\u304c\u3001\u3053\u3061\u3089\u306f\u30d5\u30a1\u30a4\u30eb\u306e\u65e2\u5b9a\u306e\u30bf\u30a4\u30d7\u3059\u3089\u30d7\u30ed\u30bb\u30b9\u306e\u30c9\u30e1\u30a4\u30f3\u304b\u3089\u30a2\u30af\u30bb\u30b9\u7981\u6b62\u3068\u306a\u3063\u3066\u3044\u308b\u5834\u5408\u3067\u3042\u308b\u3002\n\n\u6b21\u306f/var/www/html\u3067\u306f\u306a\u304f/space/1\u3092\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u30eb\u30fc\u30c8\u306b\u3057\u3066httpd\u3092start\u3057\u3001`curl http://localhost/a.html`\u3092\u5b9f\u884c\u3057\u305f\u304cTE\u306e\u30a2\u30af\u30bb\u30b9\u5236\u5fa1\u306b\u5f15\u3063\u639b\u304b\u308a\u30a8\u30e9\u30fc\u306b\u306a\u3063\u305f\u6642\u306esetroubleshoot\u306e\u51fa\u529b\u5185\u5bb9\u3067\u3042\u308b\u3002\n\n```\n*****  Plugin catchall_labels (83.8 confidence) suggests   *******************\n\nIf you want to allow httpd to have getattr access on the a.html file\nThen you need to change the label on /space/1/a.html\nDo\n# semanage fcontext -a -t FILE_TYPE '/space/1/a.html'\nwhere FILE_TYPE is one of the following: NetworkManager_exec_t, (\u9577\u3059\u304e\u308b\u306e\u3067\u7701\u7565).\nThen execute:\nrestorecon -v '/space/1/a.html'\n```\n\n\u3053\u308c\u306f`semanage fcontext -a -t FILE_TYPE '/space/1/a.html`\u3092\u5b9f\u884c\u3057\u3066\u898f\u5b9a\u306eSELinux\u30b3\u30f3\u30c6\u30ad\u30b9\u30c8\u3092\u5909\u66f4\u3057\u3066\u304b\u3089`restorecon -v '/space/1/a.html`\u3092\u5b9f\u884c\u3057\u308d\u3001\u3068\u8a00\u3063\u3066\u3044\u308b\u3002\nFILE_TYPE\u306fhttpd_t\u30c9\u30e1\u30a4\u30f3\u304c\u30a2\u30af\u30bb\u30b9\u3092\u8a31\u53ef\u3055\u308c\u305f\u30bf\u30a4\u30d7\u3067\u3042\u308bNetworkManager_exec_t\u4ee5\u964d\u304b\u3089\u9078\u3079\u3070\u826f\u3044\u306e\u3060\u304c\u5927\u91cf\u306b\u3042\u308a\u3059\u304e\u3066\u3053\u306e\u4e2d\u304b\u3089\u9078\u3076\u306e\u306f\u56f0\u96e3\u3067\u3042\u308b\u3002\n\n\u305d\u3053\u3067\u5143\u3005\u306e\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u30eb\u30fc\u30c8\u3067\u3042\u308b /var/www/html \u306e\u30bf\u30a4\u30d7\u3092\u8abf\u3079\u3066\u3001\u540c\u3058\u3082\u306e\u3092\u4eca\u306e\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u30eb\u30fc\u30c8\u306b\u9069\u7528\u3059\u308c\u3070\u826f\u3044\u3060\u308d\u3046\u3002\n\n`matchpathcon /var/www/html`\u3092\u5b9f\u884c\u3059\u308b\u3068\u3001\u305d\u306e\u30bf\u30a4\u30d7\u304chttpd_sys_content_t\u3067\u3042\u308b\u3053\u3068\u304c\u308f\u304b\u308b\u3002\n\u306a\u306e\u3067\u4eca\u306e\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u30eb\u30fc\u30c8\u306e\u898f\u5b9a\u306e\u30bf\u30a4\u30d7\u3092httpd_sys_content_t\u306b\u3059\u308c\u3070\u826f\u3044\u304c\u3001\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3060\u3051\u3067\u306f\u306a\u304f`semanage fcontext -a -t httpd_sys_content_t \"/space/1(/.*)?\"`\u3068\u3057\u3066\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u5185\u306e\u30d5\u30a1\u30a4\u30eb\u306e\u898f\u5b9a\u306e\u30bf\u30a4\u30d7\u306b\u3082\u9069\u7528\u3055\u308c\u308b\u3088\u3046\u306b\u3059\u308b\u3002\u3053\u306e\u5909\u66f4\u306f\u6c38\u7d9a\u7684\u3067\u3042\u308b\u3002\n\n\u305d\u306e\u5f8c\u3001`restorecon -RFv /space/1`\u3067\u4eca\u306e\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u30eb\u30fc\u30c8\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3068\u305d\u306e\u4e2d\u306e\u30d5\u30a1\u30a4\u30eb\u306e\u30bf\u30a4\u30d7\u3092\u898f\u5b9a\u306e\u3082\u306e\u306b\u5909\u66f4\u3059\u308c\u3070\u5b8c\u4e86\u3067\u3042\u308b\u3002\n\n\u306a\u304a\u3001\u81ea\u5206\u3067\u8ffd\u52a0\u3057\u305f\u898f\u5b9a\u306e\u30bf\u30a4\u30d7\u306f`semanage fcontext -l -C`\u3067\u898b\u308b\u3053\u3068\u304c\u3067\u304d\u308b\u3002\n-l\u30aa\u30d7\u30b7\u30e7\u30f3\u306f\u4e00\u89a7\u3092\u8868\u793a\u3001-C\u30aa\u30d7\u30b7\u30e7\u30f3\u306f\u7ba1\u7406\u8005\u304c\u8ffd\u52a0\u3057\u305f\u3082\u306e\u3060\u3051\u3092\u8868\u793a\u3059\u308b\u30aa\u30d7\u30b7\u30e7\u30f3\u3067\u3042\u308b\u3002\n\n\u3061\u306a\u307f\u306b\u30d5\u30a1\u30a4\u30eb\u304c\u4f5c\u3089\u308c\u308b\u6642\u3001\u305d\u306e\u30d5\u30a1\u30a4\u30eb\u306eSELinux\u30b3\u30f3\u30c6\u30ad\u30b9\u30c8\u306f\u898f\u5b9a\u306e\u3082\u306e\u3067\u306f\u306a\u304f\u3001\u305d\u306e\u30d5\u30a1\u30a4\u30eb\u3092\u7f6e\u3044\u305f\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3068\u540c\u3058\u3082\u306e\u306b\u306a\u308b\u3002\n\n### bind_ports \u2192 \u5229\u7528\u3059\u308b\u30dd\u30fc\u30c8\u3092\u6a19\u6e96\u7684\u3067\u306a\u3044\u30dd\u30fc\u30c8\u756a\u53f7\u306b\u5909\u66f4\u3057\u305f\u5834\u5408\u306e\u5bfe\u5fdc\n\n\u300c\u30ea\u30bd\u30fc\u30b9\u306e\u30bf\u30a4\u30d7\u3092\u6b63\u3057\u3044\u3082\u306e\u306b\u76f4\u3059\u300d\u7de8\u306e\u6700\u5f8c\u3068\u3057\u3066\u3001\u5229\u7528\u3059\u308b\u30dd\u30fc\u30c8\u3092\u6a19\u6e96\u7684\u3067\u306f\u306a\u3044\u30dd\u30fc\u30c8\u756a\u53f7\u306b\u5909\u66f4\u3057\u305f\u5834\u5408\u306e\u5bfe\u5fdc\u3092\u7d39\u4ecb\u3059\u308b\u3002\n\uff08\u30bd\u30b1\u30c3\u30c8\u3082\u30ea\u30bd\u30fc\u30b9\u306e\u4e00\u7a2e\u3067\u3042\u308b\uff09\n\n\u6b21\u306f\u516c\u958b\u30dd\u30fc\u30c8\u30928888\u306b\u3057\u3066httpd\u3092start\u3057\u3088\u3046\u3068\u3057\u305f\u304cTE\u306e\u30a2\u30af\u30bb\u30b9\u5236\u5fa1\u306b\u5f15\u3063\u639b\u304b\u308a\u5931\u6557\u3057\u305f\u6642\u306esetroubleshoot\u306e\u51fa\u529b\u5185\u5bb9\u3067\u3042\u308b\u3002\n\n```\n*****  Plugin bind_ports (92.2 confidence) suggests   ************************\n\nIf you want to allow /usr/sbin/httpd to bind to network port 8888\nThen you need to modify the port type.\nDo\n# semanage port -a -t PORT_TYPE -p tcp 8888\n    where PORT_TYPE is one of the following: http_cache_port_t, http_port_t, jboss_management_port_t, jboss_messaging_port_t, ntop_port_t, puppet_port_t.\n```\n\n\u5bfe\u5fdc\u65b9\u6cd5\u306f\u66f8\u304b\u308c\u3066\u3044\u308b\u901a\u308a\u3001`semanage port -a -t PORT_TYPE -p tcp 8888`\u3092\u5b9f\u884c\u3059\u308c\u3070\u826f\u3044\u3002\u3053\u306e\u5909\u66f4\u306f\u6c38\u7d9a\u7684\u3067\u3042\u308b\u3002\nPORT_TYPE\u306fhttpd_t\u30c9\u30e1\u30a4\u30f3\u304c\u30a2\u30af\u30bb\u30b9\u3092\u8a31\u53ef\u3055\u308c\u305f\u30bf\u30a4\u30d7\u3067\u3042\u308bhttp_cache_port_t, http_port_t, jboss_management_port_t, jboss_messaging_port_t, ntop_port_t, puppet_port_t\u306e\u3046\u3061\u306e1\u3064\u3092\u9078\u3079\u3070\u826f\u3044\u3053\u3068\u3092\u793a\u3057\u3066\u3044\u308b\u3002\n\u3053\u308c\u3089\u306e\u4e2d\u3067\u610f\u5473\u5408\u3044\u304c\u5408\u3063\u3066\u3044\u308b\u30bf\u30a4\u30d7\u3092\u9078\u3079\u3070\u826f\u3044\u3060\u308d\u3046\u3002\u5404\u30bf\u30a4\u30d7\u3092\u30e9\u30d9\u30eb\u306b\u3057\u3066\u3044\u308b\u30dd\u30fc\u30c8\u306f\u4f8b\u3048\u3070`semanage port -l | grep -w http_cache_port_t`\u3067\u5f97\u308b\u3053\u3068\u304c\u3067\u304d\u308b\u306e\u3067\u3001\u305d\u308c\u3092\u53c2\u8003\u306b\u3059\u308b\u306e\u3082\u826f\u3044\u3060\u308d\u3046\u3002\n\n### catchall \u2192 \u76e3\u67fb\u30ed\u30b0\u304b\u3089\u30a2\u30af\u30bb\u30b9\u30d9\u30af\u30bf\u30eb\u30fc\u30eb\u3092\u751f\u6210\u3057\u9069\u7528\u3059\u308b\n\n\u6700\u5f8c\u306b\u7d39\u4ecb\u3059\u308b\u306e\u306f\u6700\u7d42\u624b\u6bb5\u3068\u3059\u3079\u304d\u3001\u76e3\u67fb\u30ed\u30b0\u304b\u3089\u30a2\u30af\u30bb\u30b9\u30d9\u30af\u30bf\u30eb\u30fc\u30eb\u3092\u751f\u6210\u3057\u9069\u7528\u3059\u308b\u65b9\u6cd5\u3068\u306a\u308b\u3002\n\u6700\u7d42\u624b\u6bb5\u3068\u3059\u3079\u304d\u3001\u3068\u3044\u3046\u306e\u306f\u6700\u521d\u304b\u3089\u81ea\u4f5c\u3057\u3066\u3044\u308b\u30c9\u30e1\u30a4\u30f3\u306a\u3089\u3068\u3082\u304b\u304f\u3001selinux-policy-xx\u30d1\u30c3\u30b1\u30fc\u30b8\u304b\u3089\u63d0\u4f9b\u3055\u308c\u3066\u3044\u308b\u30c9\u30e1\u30a4\u30f3\u3067\u3053\u308c\u3092\u3057\u306a\u3044\u3068\u306a\u3089\u306a\u3044\u3053\u3068\u306f\u672c\u6765\u306a\u3044\u306f\u305a\u3067SELinux\u30d6\u30fc\u30eb\u5024\u306a\u3069\u3067\u5bfe\u51e6\u3059\u3079\u304d\u3060\u304b\u3089\u3067\u3042\u308b\u3002\n\u3068\u306f\u3044\u3048selinux-policy-xx\u30d1\u30c3\u30b1\u30fc\u30b8\u304b\u3089\u63d0\u4f9b\u3055\u308c\u3066\u3044\u308b\u3082\u306e\u306b\u3082\u7d50\u69cb\u4e0d\u5099\u306f\u3042\u308b\u306e\u3067\u3042\u308b\u3002\n\n\u6b21\u306freposync\u3068\u3044\u3046\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3057\u305f\u6642\u306esetroubleshoot\u306e\u30ed\u30b0\u51fa\u529b [^7] \u3060\u304c\u3001\u300cPlugin catchall (100. confidence) suggests\u300d\u3092\u8fd4\u3057\u3066\u304d\u305f\u5834\u5408\u4ed6\u306b\u624b\u306f\u306a\u3044\u306e\u3067\u3053\u306e\u65b9\u6cd5\u3092\u63a1\u308b\u3053\u3068\u306b\u306a\u308b\u3002\n\n[^7]: reposync\u3092\u5b9f\u884c\u3057\u305f\u6642\u306f\u3044\u3064\u3067\u3082\u3053\u3046\u306a\u308b\u308f\u3051\u3067\u306f\u306a\u3044\u3002\u30d7\u30ed\u30bb\u30b9\u306e\u30c9\u30e1\u30a4\u30f3\u306f\u89aa\u30d7\u30ed\u30bb\u30b9\u3068\u901a\u5e38\u306f\u540c\u3058\u306b\u306a\u308b\u306e\u3067\u3001\u89aa\u30d7\u30ed\u30bb\u30b9\u306e\u30c9\u30e1\u30a4\u30f3\u306b\u30a2\u30af\u30bb\u30b9\u30d9\u30af\u30bf\u30eb\u30fc\u30eb\u306e\u4e0d\u5099\u304c\u3042\u308c\u3070\u3053\u3046\u306a\u308b\u3001\u3068\u3044\u3046\u3060\u3051\u3067\u3042\u308b\u3002\n\n```\n***** Plugin catchall (100. confidence) suggests **************************\n\nIf you believe that python2.7 should be allowed read access on the history directory by default.\nThen you should report this as a bug.\nYou can generate a local policy module to allow this access.\nDo\nallow this access for now by executing:\n# grep reposync /var/log/audit/audit.log | audit2allow -M mypol\n# semodule -i mypol.pp\n```\n\n\u66f8\u304b\u308c\u3066\u3044\u308b\u3088\u3046\u306b`grep reposync /var/log/audit/audit.log | audit2allow -M mypol`\u3067\u30a2\u30af\u30bb\u30b9\u30d9\u30af\u30bf\u30eb\u30fc\u30eb\u306e\u30b3\u30f3\u30d1\u30a4\u30eb\u6e08\u307f\u30d5\u30a1\u30a4\u30eb\uff08\u3053\u308c\u3092**\u30dd\u30ea\u30b7\u30fc\u30e2\u30b8\u30e5\u30fc\u30eb**\u3068\u547c\u3076\uff09\u3067\u3042\u308bmypol.pp\u3092\u751f\u6210\u3057\u3001`semodule -i mypol.pp`\u3092\u5b9f\u884c\u3059\u308c\u3070\u76e3\u67fb\u30ed\u30b0\u30d5\u30a1\u30a4\u30eb /var/log/audit/audit.log \u3092`grep reposync`\u3067\u62bd\u51fa\u3057\u305f\u3082\u306e\u3092\u3059\u3079\u3066\u6c38\u7d9a\u7684\u306ballow\u3059\u308b\u3088\u3046\u306b\u306a\u308b\u3002\n\n\u305f\u3060mypol\u3068\u3044\u3046\u540d\u524d\u3067\u306f\u76ee\u7684\u304c\u308f\u304b\u308a\u3065\u3089\u3044\u305f\u3081\u9069\u5f53\u306a\u540d\u524d\u3092\u4ed8\u3051\u305f\u65b9\u304c\u826f\u3044\u3060\u308d\u3046\u3002\u540c\u3058\u540d\u524d\u306e\u30dd\u30ea\u30b7\u30fc\u30e2\u30b8\u30e5\u30fc\u30eb\u304c\u8907\u6570\u3042\u3063\u3066\u3082\u3059\u3079\u3066\u3092\u751f\u304b\u3059\u3088\u3046\u306b\u306f\u53d6\u308a\u8fbc\u3081\u306a\u3044\u3001\u3068\u3044\u3046\u7406\u7531\u3082\u3042\u308b\u3002\n\naudit2allow\u306f\u76e3\u67fb\u30ed\u30b0\u30d5\u30a1\u30a4\u30eb /var/log/audit/audit.log \u3092\u30d1\u30a4\u30d7\u3067\u53d7\u3051\u53d6\u308b\u4ee5\u5916\u306b\u3082ausearch\u306e\u7d50\u679c\u3082\u30d1\u30a4\u30d7\u3067\u53d7\u3051\u53d6\u308b\u3053\u3068\u304c\u3067\u304d\u308b\u3002\n\u4f8b\u3048\u30702015-07-14 12:00:00\u4ee5\u964d\u306e\u5b9f\u884c\u30d5\u30a1\u30a4\u30eb\u540d\u304creposync\u3067\u3042\u308b\u76e3\u67fb\u30ed\u30b0\u3060\u3051\u3092\u30dd\u30ea\u30b7\u30fc\u30e2\u30b8\u30e5\u30fc\u30eb\u306b\u3057\u305f\u3044\u5834\u5408\u3001`ausearch -m avc -ts 07/14/2015 12:00:00 -c reposync | audit2allow -M reposync`\u3068\u3059\u308c\u3070\u826f\u3044\u3002\n\n`audit2allow -M (\u30dd\u30ea\u30b7\u30fc\u30e2\u30b8\u30e5\u30fc\u30eb\u540d)`\u306f\u30b3\u30f3\u30d1\u30a4\u30eb\u6e08\u307f\u306e(\u30dd\u30ea\u30b7\u30fc\u30e2\u30b8\u30e5\u30fc\u30eb\u540d).pp\u4ee5\u5916\u306b\u30bd\u30fc\u30b9\u3067\u3042\u308b(\u30dd\u30ea\u30b7\u30fc\u30e2\u30b8\u30e5\u30fc\u30eb\u540d).te\u3082\u751f\u6210\u3059\u308b\u3002\nselinux-policy-devel\u30d1\u30c3\u30b1\u30fc\u30b8\u304c\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u3066\u3044\u308c\u3070\u3001te\u30d5\u30a1\u30a4\u30eb\u3092\u5fc5\u8981\u306b\u5fdc\u3058\u3066\u624b\u3067\u4fee\u6b63\u3057\u305f\u5f8c\u3001`make -f /usr/share/selinux/devel/Makefile (\u30dd\u30ea\u30b7\u30fc\u30e2\u30b8\u30e5\u30fc\u30eb\u540d).pp`\u3067\u5225\u9014\u30b3\u30f3\u30d1\u30a4\u30eb\u3092\u884c\u3046\u3053\u3068\u3082\u3067\u304d\u308b\u3002\u30b3\u30f3\u30d1\u30a4\u30eb\u5f8c\u306b`semodule -i (\u30dd\u30ea\u30b7\u30fc\u30e2\u30b8\u30e5\u30fc\u30eb\u540d).pp`\u3067\u53d6\u308a\u8fbc\u3080\u3053\u3068\u306b\u306a\u308b\u3002\n\u3053\u308c\u306f\u307e\u3060\u76e3\u67fb\u30ed\u30b0\u306b\u306f\u73fe\u308c\u3066\u3044\u306a\u3044\u304c\u3044\u305a\u308c\u767b\u5834\u3059\u308b\u306e\u304c\u308f\u304b\u3063\u3066\u3044\u308b\u8a31\u53ef\u3057\u305f\u3044\u52d5\u4f5c\u3092\u3001\u5148\u3093\u3058\u3066\u8a31\u53ef\u3059\u308b\u305f\u3081\u306a\u3069\u306b\u4f7f\u7528\u3067\u304d\u308b\u3002\n\n\u8a2d\u5b9a\u53ef\u80fd\u306a\u30af\u30e9\u30b9\u3068\u64cd\u4f5c\u306e\u7a2e\u985e\u306f\u6b21\u3092\u898b\u308c\u3070\u66f8\u304b\u308c\u3066\u3044\u308b\u3002\nhttp://selinuxproject.org/page/ObjectClassesPerms\n\n\u306a\u304a\u3001audit2allow\u3067\u751f\u6210\u3055\u308c\u305fte\u30d5\u30a1\u30a4\u30eb\u306b\u306f\u3001\u30d6\u30fc\u30eb\u5024\u3067\u5bfe\u5fdc\u53ef\u80fd\u306a\u30a2\u30af\u30bb\u30b9\u30d9\u30af\u30bf\u30eb\u30fc\u30eb\u304c\u3042\u3063\u305f\u5834\u5408\u305d\u308c\u3092\u6559\u3048\u3066\u304f\u308c\u308b\u306e\u3067\u3001\u305d\u306e\u3088\u3046\u306a\u5834\u5408\u306f\u305d\u308c\u306b\u5f93\u3046\u3068\u826f\u3044\u3060\u308d\u3046\u3002\n\n## \u5bfe\u5fdc\u306e\u307e\u3068\u3081\n\n\u3053\u3053\u307e\u3067\u898b\u3066\u304d\u305f\u901a\u308aSELinux\u3092\u4f7f\u3063\u3066\u3044\u3066\u554f\u984c\u304c\u767a\u751f\u3057\u305f\u5834\u5408\u3001\u57fa\u672c\u7684\u306a\u5bfe\u5fdc\u30d1\u30bf\u30fc\u30f3\u306f\u6b21\u306e\u3088\u3046\u306a\u3082\u306e\u306b\u306a\u308b\u3002\n\n1. `setenforce 0`\u3067permissive\u306b\u3059\u308b\n1. /var/log/messages \u306b\u51fa\u529b\u3055\u308c\u305fsetroubleshoot\u306e\u30ed\u30b0\u3092\u78ba\u8a8d\u3057\u3001\u9069\u5207\u306a\u5bfe\u5fdc\u3092\u5b9f\u65bd\u3059\u308b\n1. `setenforce 1`\u3067enforcing\u306b\u623b\u3057\u3066\u554f\u984c\u304c\u89e3\u6d88\u3057\u3066\u3044\u308b\u304b\u3092\u78ba\u8a8d\u3059\u308b\n\n\u7d4c\u9a13\u4e0a\u3001permissive\u306e\u6642\u306f\u767a\u751f\u3057\u306a\u3044\u306e\u306benforcing\u306e\u6642\u306b\u306f\u767a\u751f\u3059\u308b\u554f\u984c\u3082\u3042\u3063\u305f\u308a\u3059\u308b\u304c\u3001\u305d\u306e\u5834\u5408\u3082setroubleshoot\u306e\u30ed\u30b0\u3092\u78ba\u8a8d\u3057\u3066\u554f\u984c\u89e3\u6c7a\u3059\u308b\u307e\u3067\u5bfe\u5fdc\u3092\u7d9a\u3051\u308b\u3060\u3051\u3067\u3042\u308b\u3002\n\n\u3053\u308c\u3067\u554f\u984c\u304c\u89e3\u6c7a\u3059\u308c\u3070\u5b9f\u306f\u76e3\u67fb\u30ed\u30b0\u304b\u3089\u30a2\u30af\u30bb\u30b9\u30d9\u30af\u30bf\u30eb\u30fc\u30eb\u3092\u751f\u6210\u3059\u308b\u5834\u5408\u4ee5\u5916\u306f\u76e3\u67fb\u30ed\u30b0\u30d5\u30a1\u30a4\u30eb /var/log/audit/audit.log \u3092\u78ba\u8a8d\u3059\u308b\u5fc5\u8981\u306f\u3042\u307e\u308a\u306a\u304b\u3063\u305f\u308a\u3059\u308b\u3002\n\n\u305f\u3060\u3001\u3053\u308c\u3060\u3051\u3067\u554f\u984c\u304c\u89e3\u6c7a\u3057\u306a\u3044\u5834\u5408\u304c\u3042\u308b\u3002\n\ndontaudit\u30eb\u30fc\u30eb\u306f\u300c\u30a2\u30af\u30bb\u30b9\u3092\u8a31\u53ef\u305b\u305a\u3001\u30a2\u30af\u30bb\u30b9\u304c\u8a66\u307f\u3089\u308c\u305f\u5834\u5408\u76e3\u67fb\u30ed\u30b0\u306b\u8a18\u9332\u3057\u306a\u3044\u300d\u30eb\u30fc\u30eb\u3067\u3042\u308b\u3002\n\u3064\u307e\u308a\u76e3\u67fb\u30ed\u30b0\u30d5\u30a1\u30a4\u30eb\u3092\u898b\u308b\u3053\u3068\u306b\u3088\u3063\u3066\u3082\u3001setroubleshoot\u306e\u30ed\u30b0\u3092\u898b\u308b\u3053\u3068\u306b\u3088\u3063\u3066\u3082\u554f\u984c\u89e3\u6c7a\u304c\u3067\u304d\u306a\u3044\u306e\u3067\u3042\u308b\u3002\n\uff08\u76e3\u67fb\u30ed\u30b0\u306b\u6b8b\u3089\u306a\u3051\u308c\u3070setroubleshoot\u3082\u50cd\u304b\u306a\u3044\uff09\n\n\u305d\u306e\u5834\u5408\u306f`semodule -DB`\u3067dontaudit\u30eb\u30fc\u30eb\u3092\u7121\u52b9\u306b\u3057\u3066\u5bfe\u5fdc\u3059\u308b\u3053\u3068\u306b\u306a\u308b\u3002\n\u305f\u3060\u3057dontaudit\u30eb\u30fc\u30eb\u3092\u7121\u52b9\u306b\u3057\u305f\u5834\u5408\u3082setroubleshoot\u304c\u50cd\u304b\u306a\u304f\u306a\u308b\u306e\u3067\u3001setroubleshoot\u306b\u983c\u3089\u306a\u3044\u65b9\u6cd5\u3067\u554f\u984c\u89e3\u6c7a\u3092\u3057\u306a\u3051\u308c\u3070\u306a\u3089\u306a\u3044\u3002\n\n## setroubleshoot\u306b\u983c\u3089\u305a\u306b\u554f\u984c\u89e3\u6c7a\u3092\u884c\u3046\n\nsetroubleshoot\u306b\u983c\u3089\u306a\u3044\u5834\u5408\u3001\u6b21\u306e\u3088\u3046\u306a\u65b9\u6cd5\u3067\u5bfe\u5fdc\u3067\u304d\u308b\u3002\n\n\u76e3\u67fb\u30ed\u30b0\u306b\u306f\u30d7\u30ed\u30bb\u30b9\u306e\u30c9\u30e1\u30a4\u30f3\u3001\u30ea\u30bd\u30fc\u30b9\u306e\u30bf\u30a4\u30d7\u3001\u30ea\u30bd\u30fc\u30b9\u306e\u30af\u30e9\u30b9\u3001\u30a2\u30af\u30bb\u30b9\u62d2\u5426\u3055\u308c\u305f\u64cd\u4f5c\u304c\u8a18\u9332\u3055\u308c\u3066\u3044\u308b\u3002\n`sesearch --allow --auditallow -C -s <\u30c9\u30e1\u30a4\u30f3> -t <\u30bf\u30a4\u30d7> -c <\u30af\u30e9\u30b9> -p <\u64cd\u4f5c>`\u3092\u5b9f\u884c\u3059\u308b\u3053\u3068\u306b\u3088\u308a\u3001\u5bfe\u5fdc\u3059\u308bSELinux\u30d6\u30fc\u30eb\u5024\u304c\u3042\u308b\u304b\u3069\u3046\u304b\u3092\u77e5\u308b\u3053\u3068\u304c\u3067\u304d\u308b\u3002\n\u5bfe\u5fdc\u3059\u308bSELinux\u30d6\u30fc\u30eb\u5024\u304c\u898b\u3064\u304b\u308c\u3070\u305d\u308c\u3092\u4f7f\u3063\u3066\u89e3\u6c7a\u3059\u308c\u3070\u826f\u3044\u3060\u308d\u3046\u3002\n\n\u76e3\u67fb\u30ed\u30b0\u306epath\u306b\u306f\u30a2\u30af\u30bb\u30b9\u3055\u308c\u305f\u30d1\u30b9\u304c\u66f8\u304b\u308c\u3066\u3044\u308b\u306e\u3067\u3001\u305d\u308c\u306b\u5bfe\u3057\u3066restorecon\u3057\u3066\u89e3\u6c7a\u3059\u308c\u3070\u30bf\u30a4\u30d7\u306e\u8aa4\u308a\u3060\u3063\u305f\u3053\u3068\u304c\u308f\u304b\u308b\u3002\n\n\u6a19\u6e96\u7684\u306a\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3084\u30dd\u30fc\u30c8\u4ee5\u5916\u3092\u4f7f\u3063\u3066\u3044\u308b\u305f\u3081\u306b\u554f\u984c\u304c\u767a\u751f\u3057\u3066\u3044\u308b\u5834\u5408\u306f\u3001\u7ba1\u7406\u8005\u306f\u6a19\u6e96\u5916\u3092\u4f7f\u3063\u3066\u3044\u308b\u3053\u3068\u3092\u5927\u62b5\u77e5\u3063\u3066\u3044\u308b\u3060\u308d\u3046\u304b\u3089\u305d\u308c\u306b\u5fdc\u3058\u305f\u5bfe\u5fdc\u304c\u3067\u304d\u308b\u3002\n\n\u3069\u308c\u306b\u3082\u5f53\u3066\u306f\u307e\u3089\u306a\u3044\u5834\u5408\u306f\u76e3\u67fb\u30ed\u30b0\u304b\u3089\u30a2\u30af\u30bb\u30b9\u30d9\u30af\u30bf\u30eb\u30fc\u30eb\u3092\u751f\u6210\u3059\u308b\u3002\n\n\u5bfe\u5fdc\u304c\u5b8c\u4e86\u3057\u305f\u3089`semodule -B`\u3067dontaudit\u30eb\u30fc\u30eb\u3092\u518d\u5ea6\u6709\u52b9\u5316\u3059\u308b\u3002\n\n# SELinux\u3092\u8ae6\u3081\u308b\u2026\u2026\u304c\u3001\u6557\u6226\u51e6\u7406\u306b\u3082\u3084\u308a\u65b9\u304c\u3042\u308b\n\n\u6700\u5f8c\u306b\u3002\n\n\u3053\u308c\u307e\u3067\u793a\u3057\u3066\u304d\u305f\u3084\u308a\u65b9\u306e\u307b\u3068\u3093\u3069\u306f\u6b63\u3057\u304f\u5bfe\u75c7\u7642\u6cd5\u3067\u3042\u308a\u3001\u672a\u77e5\u306e\u554f\u984c\u306e\u767a\u751f\u304c\u4e0d\u5b9a\u671f\u3067\u591a\u7a2e\u591a\u69d8\u306b\u6e21\u308b\u306a\u3069\u3001\u9811\u5f35\u3063\u3066SELinux\u306b\u5bfe\u5fdc\u3057\u3088\u3046\u3057\u3066\u3082\u73fe\u5b9f\u7684\u306b\u7121\u7406\u3001\u3068\u3044\u3046\u3053\u3068\u3082\u3042\u308b\u3060\u308d\u3046\u3002\n\u3082\u3061\u308d\u3093`setenforce 0`\u3092\u5b9f\u884c\u3057\u3001 /etc/selinux/config \u3092\u66f8\u304d\u63db\u3048\u3066permissive\u306b\u3057\u3066\u3057\u307e\u3048\u3070SELinux\u3092\u3059\u3050\u306b\u8ae6\u3081\u308b\u3053\u3068\u304c\u3067\u304d\u308b\u3002\n\n\u305f\u3060\u3001\u554f\u984c\u3092\u8d77\u3053\u3059\u306e\u304c\u3069\u306e\u30c9\u30e1\u30a4\u30f3\u304b\u304c\u308f\u304b\u3063\u3066\u3044\u308c\u3070\u305d\u306e\u30c9\u30e1\u30a4\u30f3\u3060\u3051\u3092permissive\u306b\u3057\u3001\u4ed6\u306e\u30c9\u30e1\u30a4\u30f3\u306b\u3064\u3044\u3066\u306f\u5f15\u304d\u7d9a\u304denforcing\u3067SELinux\u3092\u4f7f\u7528\u3057\u7d9a\u3051\u308b\u3001\u3068\u3044\u3046\u5bfe\u5fdc\u3092\u53d6\u308b\u3053\u3068\u3082\u3067\u304d\u308b\u3002\n\n\u6b21\u306e\u30b3\u30de\u30f3\u30c9\u3067\u7279\u5b9a\u306e\u30c9\u30e1\u30a4\u30f3\u3092permissive\u306b\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u308b\u3002\u3053\u306e\u5909\u66f4\u306f\u6c38\u7d9a\u7684\u3067\u3042\u308aOS\u518d\u8d77\u52d5\u3092\u3057\u3066\u3082\u89e3\u9664\u3055\u308c\u306a\u3044\u3002\n\n```\n# semanage permissive -a <\u30c9\u30e1\u30a4\u30f3>\n```\n\npermissive\u306b\u306a\u3063\u3066\u3044\u308b\u30c9\u30e1\u30a4\u30f3\u306f\u6b21\u3067\u78ba\u8a8d\u3067\u304d\u308b\u3002\n\n```\n# semanage permissive -l\n```\n\n\u30c9\u30e1\u30a4\u30f3\u3092permissive\u3067\u306a\u304f\u3059\u306b\u306f\u6b21\u306e\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3059\u308b\u3002\n\n```\n# semanage permissive -d <\u30c9\u30e1\u30a4\u30f3>\n```\n\n# \u53c2\u8003\u6587\u732e\n\n* https://access.redhat.com/documentation/ja-JP/Red_Hat_Enterprise_Linux/6/html/Security-Enhanced_Linux/index.html\n* http://www.slideshare.net/ishikawa84g/hbstudy-28-selinuxhandson\n* https://fedorapeople.org/~dwalsh/SELinux/Presentations/UnderstandingSELinux/#/\n* http://selinuxproject.org/page/NewUsers \u304b\u3089\u884c\u3051\u308b\u30da\u30fc\u30b8\n\n----\n", "tags": ["SELinux", "CentOS7", "fedora22"]}