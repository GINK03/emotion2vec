{"tags": ["Corona"], "context": " More than 1 year has passed since last update.Corona\u3067FPS\u3068\u305d\u306e\u5e73\u5747\u5024\u3001CPU\u4f7f\u7528\u7387\u3001\u30e1\u30e2\u30ea\u6d88\u8cbb\u91cf\u3092\u30e2\u30cb\u30bf\u30ea\u30f3\u30b0\u3059\u308b\u30e2\u30b8\u30e5\u30fc\u30eb\u3067\u3059\u3002\u7d50\u69cb\u9069\u5f53\u304b\u3082\u3057\u308c\u3093\u3002\n\nlib/util/simplefps.lua\nmodule(..., package.seeall)\n\n--FPS\u306e\u5b9a\u7fa9\u3001\u30b3\u30f3\u30c6\u30f3\u30c4\u306b\u5408\u308f\u305b\u308b\nlocal content_fps = 60;\n\n--\u30ab\u30a6\u30f3\u30bf\u8868\u793a\u7528\n\ndisplayObject = display.newGroup();\n\nlocal textFront  = display.newText(\"\",   display.contentWidth/2,   5, native.systemFont, 20 );\nlocal textShadow = display.newText(\"\", 1+display.contentWidth/2, 1+5, native.systemFont, 20 );\n\ntextFront:setTextColor ( 255,255,255 );\ntextShadow:setTextColor( 0,0,0 );\n\ndisplayObject:insert( textShadow );\ndisplayObject:insert( textFront );\n\n--\n\nlocal frame_count = 0;\nlocal count_num = 0;\nlocal total_frame = 0;\n\nlocal cpu_count = 0;\nlocal cpu_per = 0;\nlocal cpu_ms = 0;\n\n--\n\nlocal function cpuChecker()\n    cpu_count = cpu_count + 1;\n    local d = cpu_count % content_fps;\n    if d == 1 then\n        cpu_ms = os.clock();\n    elseif d == 0 then\n        cpu_ms = os.clock()-cpu_ms;\n        cpu_per = math.floor(cpu_ms*100);\n    end;\nend;\n\nlocal function enterframeCheck( event )\n    frame_count = frame_count+1;\n    cpuChecker();\nend;\n\n\nlocal function oneSecondCheck( event )\n    count_num = count_num + 1;\n    total_frame = total_frame + frame_count;\n\n    local ave = math.floor( 10*total_frame/count_num )/10;\n    local mem = math.floor( collectgarbage( \"count\" )/1024*100)/100;\n    local tex = math.floor( system.getInfo( \"textureMemoryUsed\" )/1024/1024*100)/100;\n\n    local disp = \"FPS:\"..frame_count .. \"  AVE:\".. ave ..\"  MEM:\"..mem..\"MB\"..\"  TEX:\"..tex..\"MB  \"..\"CPU:\"..cpu_per..\"%\";\n    textFront.text , textShadow.text = disp , disp;\n\n    frame_count = 0;\nend\n\nRuntime:addEventListener( \"enterFrame\", enterframeCheck );\ntimer.performWithDelay( 1000, oneSecondCheck , 0 );\n\n\ncontent_fps\u306e\u5024\u306f\u30b3\u30f3\u30c6\u30f3\u30c4\u306efps\u306b\u5408\u308f\u305b\u3066\u66f8\u304d\u63db\u3048\u3066\u304f\u3060\u3055\u3044\u3002\n\n\u4f7f\u3044\u304b\u305f\n\nmain.lua\nlocal fps = require \"lib.util.simplefps\";\nfps.displayObject.y = display.contentHeight/2;\n\n\n\u3053\u3093\u306a\u611f\u3058\u3002\u914d\u7f6e\u5ea7\u6a19\u306f\u304a\u597d\u304d\u306a\u3088\u3046\u306b\u3002\n\u3067\u3001\u4ee5\u4e0b\u304c\u753b\u9762\u306b\u8868\u793a\u3055\u308c\u308b\u306f\u305a\u3067\u3059\u3002\nFPS: 1\u79d2\u9593\u306b\u4f55\u679a\u753b\u9762\u63cf\u753b\u3055\u308c\u3066\u3044\u308b\u304b\u3002content_fps\u306e\u5024\u3068\u8fd1\u3051\u308c\u3070\u826f\u3044\u304b\u3093\u3058\u3002\nAVE: \u3053\u306e\u30e2\u30b8\u30e5\u30fc\u30eb\u3092\u8aad\u8fbc\u3093\u3067\u304b\u3089\u306e\u5e73\u5747fps\nMEM: \u30e1\u30e2\u30ea\u4f7f\u7528\u91cf\nTEX: \u30c6\u30af\u30b9\u30c1\u30e3\u30e1\u30e2\u30ea\u4f7f\u7528\u91cf\nCPU: CPU\u4f7f\u7528\u7387\u3002\u9069\u5f53\u306a\u7b97\u51fa\u3067\u3059\u304c\u3001Corona\u30b7\u30df\u30e5\u30ec\u30fc\u30bf\u3068iOS\u306b\u304a\u3044\u3066\u306f\u8fd1\u4f3c\u5024\u304c\u51fa\u3066\u3044\u308b\u306f\u305a\uff08\u30a2\u30af\u30c6\u30a3\u30d3\u30c6\u30a3\u30e2\u30cb\u30bf\u3067\u78ba\u8a8d\u3057\u3066\u307f\u3066\u304f\u3060\u3055\u3044\uff09\u3002Android\u306b\u304a\u3044\u3066\u306f100%\u672a\u6e80\u306f\u3046\u307e\u304f\u7b97\u51fa\u51fa\u6765\u307e\u305b\u3093\u3002\n\u3053\u308c\u3092\u4f7f\u3046\u3068\u3001\u300ciPhone5\u3063\u3066\u901f\u3048\u3048\u306a\u3042\u3001iPhone4\u306e4\u500d\u304b\u3088\u300d\u3068\u304b\u300cMac\u306f\u3084\u3063\u3071\u30b9\u30de\u30db\u3088\u308a\u5727\u5012\u7684\u306b\u901f\u3044\u300d\u3068\u304b\u300cTegra3\u3063\u3066\u5168\u7136\u901f\u304f\u306a\u3044\u306e\u306d\uff08\u6ce3\u300d\u3068\u304b\u8272\u3005\u5206\u304b\u308a\u307e\u3059\u3002\u30a2\u30d7\u30ea\u3092\u3046\u3063\u304b\u308a\u843d\u3068\u3055\u306a\u3044\u3088\u3046\u306b\u3001\u3057\u3063\u304b\u308a\u30c1\u30e5\u30fc\u30cb\u30f3\u30b0\u3057\u307e\u3057\u3087\u3046\u3002\nCorona\u3067FPS\u3068\u305d\u306e\u5e73\u5747\u5024\u3001CPU\u4f7f\u7528\u7387\u3001\u30e1\u30e2\u30ea\u6d88\u8cbb\u91cf\u3092\u30e2\u30cb\u30bf\u30ea\u30f3\u30b0\u3059\u308b\u30e2\u30b8\u30e5\u30fc\u30eb\u3067\u3059\u3002\u7d50\u69cb\u9069\u5f53\u304b\u3082\u3057\u308c\u3093\u3002\n\n\n\n```lua:lib/util/simplefps.lua\nmodule(..., package.seeall)\n\n--FPS\u306e\u5b9a\u7fa9\u3001\u30b3\u30f3\u30c6\u30f3\u30c4\u306b\u5408\u308f\u305b\u308b\nlocal content_fps = 60;\n\n--\u30ab\u30a6\u30f3\u30bf\u8868\u793a\u7528\n\ndisplayObject = display.newGroup();\n\nlocal textFront  = display.newText(\"\",   display.contentWidth/2,   5, native.systemFont, 20 );\nlocal textShadow = display.newText(\"\", 1+display.contentWidth/2, 1+5, native.systemFont, 20 );\n\ntextFront:setTextColor ( 255,255,255 );\ntextShadow:setTextColor( 0,0,0 );\n\ndisplayObject:insert( textShadow );\ndisplayObject:insert( textFront );\n\n--\n\nlocal frame_count = 0;\nlocal count_num = 0;\nlocal total_frame = 0;\n\nlocal cpu_count = 0;\nlocal cpu_per = 0;\nlocal cpu_ms = 0;\n\n--\n\nlocal function cpuChecker()\n\tcpu_count = cpu_count + 1;\n\tlocal d = cpu_count % content_fps;\n\tif d == 1 then\n\t\tcpu_ms = os.clock();\n\telseif d == 0 then\n\t\tcpu_ms = os.clock()-cpu_ms;\n\t\tcpu_per = math.floor(cpu_ms*100);\n\tend;\nend;\n\nlocal function enterframeCheck( event )\n\tframe_count = frame_count+1;\n\tcpuChecker();\nend;\n\n\nlocal function oneSecondCheck( event )\n\tcount_num = count_num + 1;\n\ttotal_frame = total_frame + frame_count;\n\t\n\tlocal ave = math.floor( 10*total_frame/count_num )/10;\n\tlocal mem = math.floor( collectgarbage( \"count\" )/1024*100)/100;\n\tlocal tex = math.floor( system.getInfo( \"textureMemoryUsed\" )/1024/1024*100)/100;\n\t\n\tlocal disp = \"FPS:\"..frame_count .. \"  AVE:\".. ave ..\"  MEM:\"..mem..\"MB\"..\"  TEX:\"..tex..\"MB  \"..\"CPU:\"..cpu_per..\"%\";\n\ttextFront.text , textShadow.text = disp , disp;\n\n    frame_count = 0;\nend\n\nRuntime:addEventListener( \"enterFrame\", enterframeCheck );\ntimer.performWithDelay( 1000, oneSecondCheck , 0 );\n```\n\n`content_fps`\u306e\u5024\u306f\u30b3\u30f3\u30c6\u30f3\u30c4\u306efps\u306b\u5408\u308f\u305b\u3066\u66f8\u304d\u63db\u3048\u3066\u304f\u3060\u3055\u3044\u3002\n\n## \u4f7f\u3044\u304b\u305f\n```lua:main.lua\nlocal fps = require \"lib.util.simplefps\";\nfps.displayObject.y = display.contentHeight/2;\n```\n\n\u3053\u3093\u306a\u611f\u3058\u3002\u914d\u7f6e\u5ea7\u6a19\u306f\u304a\u597d\u304d\u306a\u3088\u3046\u306b\u3002\n\u3067\u3001\u4ee5\u4e0b\u304c\u753b\u9762\u306b\u8868\u793a\u3055\u308c\u308b\u306f\u305a\u3067\u3059\u3002\n\n**FPS:** 1\u79d2\u9593\u306b\u4f55\u679a\u753b\u9762\u63cf\u753b\u3055\u308c\u3066\u3044\u308b\u304b\u3002content_fps\u306e\u5024\u3068\u8fd1\u3051\u308c\u3070\u826f\u3044\u304b\u3093\u3058\u3002\n\n**AVE:** \u3053\u306e\u30e2\u30b8\u30e5\u30fc\u30eb\u3092\u8aad\u8fbc\u3093\u3067\u304b\u3089\u306e\u5e73\u5747fps\n\n**MEM:** \u30e1\u30e2\u30ea\u4f7f\u7528\u91cf\n\n**TEX:** \u30c6\u30af\u30b9\u30c1\u30e3\u30e1\u30e2\u30ea\u4f7f\u7528\u91cf\n\n**CPU:** CPU\u4f7f\u7528\u7387\u3002\u9069\u5f53\u306a\u7b97\u51fa\u3067\u3059\u304c\u3001Corona\u30b7\u30df\u30e5\u30ec\u30fc\u30bf\u3068iOS\u306b\u304a\u3044\u3066\u306f\u8fd1\u4f3c\u5024\u304c\u51fa\u3066\u3044\u308b\u306f\u305a\uff08\u30a2\u30af\u30c6\u30a3\u30d3\u30c6\u30a3\u30e2\u30cb\u30bf\u3067\u78ba\u8a8d\u3057\u3066\u307f\u3066\u304f\u3060\u3055\u3044\uff09\u3002Android\u306b\u304a\u3044\u3066\u306f100%\u672a\u6e80\u306f\u3046\u307e\u304f\u7b97\u51fa\u51fa\u6765\u307e\u305b\u3093\u3002\n\n\u3053\u308c\u3092\u4f7f\u3046\u3068\u3001\u300ciPhone5\u3063\u3066\u901f\u3048\u3048\u306a\u3042\u3001iPhone4\u306e4\u500d\u304b\u3088\u300d\u3068\u304b\u300cMac\u306f\u3084\u3063\u3071\u30b9\u30de\u30db\u3088\u308a\u5727\u5012\u7684\u306b\u901f\u3044\u300d\u3068\u304b\u300cTegra3\u3063\u3066\u5168\u7136\u901f\u304f\u306a\u3044\u306e\u306d\uff08\u6ce3\u300d\u3068\u304b\u8272\u3005\u5206\u304b\u308a\u307e\u3059\u3002\u30a2\u30d7\u30ea\u3092\u3046\u3063\u304b\u308a\u843d\u3068\u3055\u306a\u3044\u3088\u3046\u306b\u3001\u3057\u3063\u304b\u308a\u30c1\u30e5\u30fc\u30cb\u30f3\u30b0\u3057\u307e\u3057\u3087\u3046\u3002\n"}