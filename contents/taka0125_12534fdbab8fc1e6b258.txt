{"tags": ["Swift", "Realm"], "context": " More than 1 year has passed since last update.write\u306f\u5168\u7136\u95a2\u4fc2\u306a\u304f\u3066\u3001filter\u306e\u4f7f\u3044\u65b9\u304c\u60aa\u304b\u3063\u305f\u3002\n\n\u74b0\u5883\n\nRealmSwift 0.97.0\nRealm 0.97.0\nXcode 7.2\niOS 8.1\u306e\u30b7\u30df\u30e5\u30ec\u30fc\u30bf\niOS 9.2\u306e\u5b9f\u6a5f(iPhone 6s)\n\n\n\u30c0\u30e1\u306a\u30b3\u30fc\u30c9\nimport Foundation\nimport RealmSwift\n\nfinal class Record: Object {\n  dynamic var id = \"\"\n  dynamic var updatedAt: Double = 0.0\n\n  override static func primaryKey() -> String? {\n    return \"id\"\n  }\n}\n\nfunc test() {\n  guard let realm = try? Realm() else { return }\n\n  let items = Array(0..<100).map { \"\\($0)\" }\n\n  try! realm.write {\n    let timestamp = NSDate().timeIntervalSince1970\n\n    items.forEach { item in\n      let record = Record()\n      record.id = item\n      record.updatedAt = timestamp\n\n      realm.add(record, update: true)\n    }\n\n    realm.refresh()\n\n    let results = realm.objects(Record).filter(\"updatedAt < \\(timestamp)\")\n    print(\"==========\")\n    print(\"\\(results.first?.updatedAt < timestamp)\") // true\u306e\u306f\u305a\n    print(results.count) // 0\u4ee5\u5916\u306b\u306f\u306a\u3089\u306a\u3044\u306f\u305a\n  }\n}\n\n\u3068\u3044\u3046\u611f\u3058\u306e\u30b3\u30fc\u30c9\u3067\u3001test()\u3092\u4f55\u5ea6\u304b\u5b9f\u884c\u3057\u3066\u307f\u305f\u3068\u3053\u308d\n==========\nfalse\n100\n==========\nfalse\n100\n==========\nfalse\n100\n==========\ntrue\n0\n==========\nfalse\n100\n==========\nfalse\n100\n==========\ntrue\n0\n==========\ntrue\n0\n==========\nfalse\n100\n==========\ntrue\n0\n\n\u3053\u3093\u306a\u611f\u3058\u3067\u3061\u3050\u306f\u3050\u306a\u611f\u3058\u306b\u2026\u3002\n\u3046\u30fc\u3093\u3002\u306a\u3093\u3060\u308d\u3046\u3002\n\nfor\u306e\u4e2d\u3067write\u3057\u3066\u307f\u3066\u3082\u30c0\u30e1\u3060\u3063\u305f\nfinal class Record: Object {\n  dynamic var id = \"\"\n  dynamic var updatedAt: Double = 0.0\n\n  override static func primaryKey() -> String? {\n    return \"id\"\n  }\n}\n\nfunc test() {\n  guard let realm = try? Realm() else { return }\n\n  let items = Array(0..<100).map { \"\\($0)\" }\n\n  let timestamp = NSDate().timeIntervalSince1970\n  items.forEach { item in\n    try! realm.write {\n      let record = Record()\n      record.id = item\n      record.updatedAt = timestamp\n\n      realm.add(record, update: true)\n    }\n  }\n\n  realm.refresh()\n\n  let results = realm.objects(Record).filter(\"updatedAt < \\(timestamp)\")\n  print(\"==========\")\n  print(\"\\(results.first?.updatedAt < timestamp)\") // true\u306e\u306f\u305a\n  print(results.count) // 0\u4ee5\u5916\u306b\u306f\u306a\u3089\u306a\u3044\u306f\u305a\n}\n\n==========\ntrue\n0\n==========\ntrue\n0\n==========\nfalse\n100\n==========\ntrue\n0\n==========\ntrue\n0\n==========\nfalse\n100\n==========\ntrue\n0\n==========\ntrue\n0\n==========\ntrue\n0\n==========\nfalse\n100\n\n\n\u52d5\u3044\u305f\u30b3\u30fc\u30c9\nfunc doSomething() {\n  guard let realm = try? Realm() else { return }\n\n  let items = Array(0..<100).map { \"\\($0)\" }\n\n  let timestamp = NSDate().timeIntervalSince1970\n  items.forEach { item in\n    try! realm.write {\n      let record = Record()\n      record.id = item\n      record.updatedAt = timestamp\n\n      realm.add(record, update: true)\n    }\n  }\n\n  realm.refresh()\n\n  let results = realm.objects(Record).filter(\"updatedAt < %lf\", timestamp)\n  print(\"==========\")\n  print(\"\\(results.first?.updatedAt < timestamp)\") // true\u306e\u306f\u305a\n  print(results.count) // 0\u4ee5\u5916\u306b\u306f\u306a\u3089\u306a\u3044\u306f\u305a\n}\n\n\u3068\u3044\u3046\u611f\u3058\u3067\u3001\u6587\u5b57\u5217\u306b\u57cb\u3081\u8fbc\u3080\u306e\u3092\u8f9e\u3081\u305f\u3089\u3046\u307e\u304f\u3044\u3063\u305f\u3002\nwrite\u306f\u5168\u7136\u95a2\u4fc2\u306a\u304f\u3066\u3001filter\u306e\u4f7f\u3044\u65b9\u304c\u60aa\u304b\u3063\u305f\u3002\n\n# \u74b0\u5883\n\n- RealmSwift 0.97.0\n- Realm 0.97.0\n- Xcode 7.2\n- iOS 8.1\u306e\u30b7\u30df\u30e5\u30ec\u30fc\u30bf\n- iOS 9.2\u306e\u5b9f\u6a5f(iPhone 6s)\n\n# \u30c0\u30e1\u306a\u30b3\u30fc\u30c9\n\n```swift\nimport Foundation\nimport RealmSwift\n\nfinal class Record: Object {\n  dynamic var id = \"\"\n  dynamic var updatedAt: Double = 0.0\n  \n  override static func primaryKey() -> String? {\n    return \"id\"\n  }\n}\n\nfunc test() {\n  guard let realm = try? Realm() else { return }\n\n  let items = Array(0..<100).map { \"\\($0)\" }\n  \n  try! realm.write {\n    let timestamp = NSDate().timeIntervalSince1970\n    \n    items.forEach { item in\n      let record = Record()\n      record.id = item\n      record.updatedAt = timestamp\n      \n      realm.add(record, update: true)\n    }\n    \n    realm.refresh()\n    \n    let results = realm.objects(Record).filter(\"updatedAt < \\(timestamp)\")\n    print(\"==========\")\n    print(\"\\(results.first?.updatedAt < timestamp)\") // true\u306e\u306f\u305a\n    print(results.count) // 0\u4ee5\u5916\u306b\u306f\u306a\u3089\u306a\u3044\u306f\u305a\n  }\n}\n```\n\n\u3068\u3044\u3046\u611f\u3058\u306e\u30b3\u30fc\u30c9\u3067\u3001`test()`\u3092\u4f55\u5ea6\u304b\u5b9f\u884c\u3057\u3066\u307f\u305f\u3068\u3053\u308d\n\n```\n==========\nfalse\n100\n==========\nfalse\n100\n==========\nfalse\n100\n==========\ntrue\n0\n==========\nfalse\n100\n==========\nfalse\n100\n==========\ntrue\n0\n==========\ntrue\n0\n==========\nfalse\n100\n==========\ntrue\n0\n```\n\n\u3053\u3093\u306a\u611f\u3058\u3067\u3061\u3050\u306f\u3050\u306a\u611f\u3058\u306b\u2026\u3002\n\n\u3046\u30fc\u3093\u3002\u306a\u3093\u3060\u308d\u3046\u3002\n\n# for\u306e\u4e2d\u3067write\u3057\u3066\u307f\u3066\u3082\u30c0\u30e1\u3060\u3063\u305f\n\n```swift\nfinal class Record: Object {\n  dynamic var id = \"\"\n  dynamic var updatedAt: Double = 0.0\n  \n  override static func primaryKey() -> String? {\n    return \"id\"\n  }\n}\n\nfunc test() {\n  guard let realm = try? Realm() else { return }\n\n  let items = Array(0..<100).map { \"\\($0)\" }\n  \n  let timestamp = NSDate().timeIntervalSince1970\n  items.forEach { item in\n    try! realm.write {\n      let record = Record()\n      record.id = item\n      record.updatedAt = timestamp\n\n      realm.add(record, update: true)\n    }\n  }\n  \n  realm.refresh()\n  \n  let results = realm.objects(Record).filter(\"updatedAt < \\(timestamp)\")\n  print(\"==========\")\n  print(\"\\(results.first?.updatedAt < timestamp)\") // true\u306e\u306f\u305a\n  print(results.count) // 0\u4ee5\u5916\u306b\u306f\u306a\u3089\u306a\u3044\u306f\u305a\n}\n```\n\n```\n==========\ntrue\n0\n==========\ntrue\n0\n==========\nfalse\n100\n==========\ntrue\n0\n==========\ntrue\n0\n==========\nfalse\n100\n==========\ntrue\n0\n==========\ntrue\n0\n==========\ntrue\n0\n==========\nfalse\n100\n```\n\n# \u52d5\u3044\u305f\u30b3\u30fc\u30c9\n\n```swift\nfunc doSomething() {\n  guard let realm = try? Realm() else { return }\n  \n  let items = Array(0..<100).map { \"\\($0)\" }\n  \n  let timestamp = NSDate().timeIntervalSince1970\n  items.forEach { item in\n    try! realm.write {\n      let record = Record()\n      record.id = item\n      record.updatedAt = timestamp\n      \n      realm.add(record, update: true)\n    }\n  }\n  \n  realm.refresh()\n  \n  let results = realm.objects(Record).filter(\"updatedAt < %lf\", timestamp)\n  print(\"==========\")\n  print(\"\\(results.first?.updatedAt < timestamp)\") // true\u306e\u306f\u305a\n  print(results.count) // 0\u4ee5\u5916\u306b\u306f\u306a\u3089\u306a\u3044\u306f\u305a\n}\n```\n\n\u3068\u3044\u3046\u611f\u3058\u3067\u3001\u6587\u5b57\u5217\u306b\u57cb\u3081\u8fbc\u3080\u306e\u3092\u8f9e\u3081\u305f\u3089\u3046\u307e\u304f\u3044\u3063\u305f\u3002\n\n"}