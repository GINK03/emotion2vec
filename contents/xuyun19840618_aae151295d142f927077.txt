{"context": "\u3000\u6642\u7cfb\u5217\u30c7\u30fc\u30bf\u3092\u5206\u6790\u3059\u308b\u6642\u3001\u5468\u671f\u7684\u306a\u30c7\u30fc\u30bf\u304c\u5b58\u5728\u3059\u308b\u3053\u3068\u306f\u3001\u3057\u3070\u3057\u3070\u3042\u308a\u307e\u3059\u3002\u3053\u306e\u5468\u671f\u6027\u3092\u8003\u616e\u3057\u306a\u3051\u308c\u3070\u306a\u308a\u307e\u305b\u3093\u3002\u79fb\u52d5\u5e73\u5747\u6cd5\u3092\u3054\u7d39\u4ecb\u3057\u307e\u3059\u3002\u3053\u3053\u3067\u3001\u4e00\u756a\u30b7\u30f3\u30d7\u30eb\u306e\u79fb\u52d5\u5e73\u5747\u6cd5\u3092\u8aac\u660e\u3057\u307e\u3059\u3002\n\n\u30c7\u30fc\u30bf\ny\uff1a\u76ee\u7684\u5909\u6570\nx\uff1a\u8aac\u660e\u5909\u6570\n            y          x\n [1,] 16.3420349  7.21799609\n [2,]  9.4853139 20.07930955\n [3,]  2.0946638  2.54631266\n [4,]  3.0991178  8.43088240\n [5,]  7.8069991 10.23466188\n [6,] 13.9609309  0.45914370\n [7,]  3.3191959  6.34949213\n [8,] 14.1245312 25.38715182\n [9,] 19.1783122 31.96572503\n[10,]  2.6551769  3.69963485\n[11,] 23.5168751 22.20547723\n[12,]  6.0558261  9.21209711\n[13,]  1.5733379  2.07579350\n[14,]  1.1696452  0.57584675\n[15,]  5.4701931  6.58309332\n[16,] 17.7192605  4.28368676\n[17,]  2.1629390  7.82622938\n[18,]  3.9961220  2.56963947\n[19,] -0.4549355  1.65004434\n[20,] 17.1749453 37.00024382\n[21,] 22.6155962 16.01943730\n[22,] 10.6688664 13.77812541\n[23,] -1.6582567  0.09505423\n[24,]  4.6173663  3.14344014\n[25,]  2.1885696  2.06269316\n\ny\u3092\u5206\u89e3\u3057\u3066\u307f\u308b\u3068\u3001\u5468\u671f\u6027\u304c\u3042\u308b\u3068\u5206\u304b\u308a\u307e\u3057\u305f\u3002\n\n\n\u79fb\u52d5\u5e73\u5747\u6cd5\n\u4e0a\u306e\u56f3\u3092\u5fa1\u89a7\u304f\u3060\u3055\u3044\u3002\u30c7\u30fc\u30bf\u30b5\u30a4\u30ba\u306f25\u3067\u30015\u500b\u306e\u30c7\u30fc\u30bf\u304c1\u3064\u306e\u5468\u671f\u3067\u3042\u308b\u3053\u3068\u304c\u5206\u304b\u308a\u307e\u3059\u3002\n\u3067\u306f\u3001\u6b21\u306e\u3088\u3046\u306b\u3001\u51e6\u7406\u3057\u307e\u3059\u3002\nmyt\u22124=15t\u2211t\u22124yimyt\u22124=15\u2211t\u22124tyimy_{t-4}=\\frac{1}{5}\\sum_{t-4}^{t}y_i\n\u540c\u3058\u304f\nmxt\u22124=15t\u2211t\u22124ximxt\u22124=15\u2211t\u22124tximx_{t-4}=\\frac{1}{5}\\sum_{t-4}^{t}x_i\n\n\n\n\ny\nmy\nx\nmx\n\n\n\n\n1\ny1y_1\n-\nx1x_1\n-\n\n\n2\ny2y_2\n-\nx2x_2\n-\n\n\n3\ny3y_3\n-\nx3x_3\n-\n\n\n4\ny4y_4\n-\nx4x_4\n-\n\n\n5\ny5y_5\nmy1my_1\nx5x_5\nmx1mx_1\n\n\n6\ny6y_6\nmy2my_2\nx6x_6\nmx2mx_2\n\n\n\u22ee\\vdots\n\n\n\n\n\n\n24\ny24y_{24}\nmy20my_{20}\nx24x_{24}\nmx20mx_{20}\n\n\n25\ny25y_{25}\nmy21my_{21}\nx25x_{25}\nmx21mx_{21}\n\n\n\nmymy\u3092\u76ee\u7684\u5909\u6570\u3068\u3001mxmx\u3092\u8aac\u660e\u5909\u6570\u3068\u3057\u3066\u3001\u56de\u5e30\u5206\u6790\u3092\u3059\u308c\u3070\u3088\u3044\u3067\u3059\u3002\n\u4e0b\u8a18\u306e\u5206\u6790\u7d50\u679c\u3088\u308a\u3001\nmyt=3.5+0.5matmy_t=3.5+0.5ma_t\n\u3068\u306a\u308a\u307e\u3059\u304c\u3001yy\u3068xx\u306e\u95a2\u4fc2\u306f\u3069\u3046\u3067\u3057\u3087\u3046\u3002\n\u5e73\u5747\u5024\u306e\u6027\u8cea\u306b\u3088\u3063\u3066\u3001\nyt=ct+0.5xty_t=c_t+0.5x_t\n\u3053\u3053\u3067\u3001ctc_t\u306f\u5b9a\u6570\u9805\u3067\u3059\u3002\u3057\u304b\u3082\u3001\u5468\u671f\u6027\u304c\u3042\u308b\u306e\u3067\u3001ctc_t\u306e5\u500b\u306e\u5e73\u5747\u5024\u306f\u4e00\u5b9a\u3067\u30013.5\u3068\u306a\u308b\u306f\u305a\u3067\u3059\u3002\nCall:\nlm(formula = y_ma ~ x_ma)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-0.9029 -0.2751 -0.0007  0.3610  0.7421 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|) \n\n(Intercept)  3.48831    0.27022   12.91 7.47e-11 ***\nx_ma         0.50053    0.02392   20.92 1.40e-14 ***\n---\nSignif. codes:  0 \u2018***\u2019 0.001 \u2018**\u2019 0.01 \u2018*\u2019 0.05 \u2018.\u2019 0.1 \u2018 \u2019 1\n\nResidual standard error: 0.4807 on 19 degrees of freedom\nMultiple R-squared:  0.9584,    Adjusted R-squared:  0.9562 \nF-statistic: 437.7 on 1 and 19 DF,  p-value: 1.401e-14\n\n\u5b9f\u306f\u3001\u3053\u306e\u30c7\u30fc\u30bf\u306f\u767a\u751f\u3057\u305f\u4e71\u6570\u3067\u3059\u3002\nyt=b1x1,t+b2x2,t+\u03b5ty_t=b_1x_{1,t}+b_2x_{2,t}+\\varepsilon_t\n\u6570\u5217x1=(50,1,2,3,4,50,1,2,3,4,\u22ef)x_1=(50,1,2,3,4,50,1,2,3,4,\\cdots)\n\u6570\u5217x2x_2\u306f\u03bb=0.1\\lambda=0.1\u6307\u6570\u4e71\u6570\u5217\nb1,b2b_1,b_2\u306e\u8a2d\u5b9a\u5024\u306fb1=0.3,b2=0.5b_1=0.3,b_2=0.5\n\ncode.r\nt <- 25\u3000\u3000#\u884c\u306e\u6570\nn <- 1    #\u5b9f\u884c\u56de\u6570\nb1 <- 0.3\nb2 <- 0.5\n\nX1 <- matrix( c(50,1,2,3,4), nrow = t, ncol = n )\nX2 <- matrix( rexp(t*n,0.1), nrow = t, ncol = n )\nerror <- matrix( rnorm(t*n,0,5^0.5), nrow = t, ncol = n )\nY <- b1*X1 + b2*X2 + error\n\n\n\n\u30e2\u30f3\u30c6\u30ab\u30eb\u30ed\u6cd5\n1\u56de\u306e\u7d50\u679c\u306f\u5076\u7136\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u304c\u300110000\u56de\u3067\u5b9f\u884c\u3057\u3001\u540c\u3058\u7d50\u679c\u3067\u3042\u308b\u304b\u3068\u30c1\u30a7\u30c3\u30af\u3057\u3066\u307f\u307e\u3057\u3087\u3046\u3002\n\u7406\u8ad6\u5024\u306e\u8a08\u7b97\uff1a\nb1=0.3b_1=0.3\nb2=0.5b_2=0.5\nc=(50+1+2+3+4)/5\u2217b1=3.6c=(50+1+2+3+4)/5*b_1=3.6\n\n\n\ncc\u306e\u7406\u8ad6\u5024\ncc\u306e\u63a8\u5b9a\nb2b_2\u306e\u7406\u8ad6\nb2b_2\u306e\u63a8\u5b9a\n\n\n\n\n3.6\n3.6116\n0.5\n0.4994\n\n\n\n> apply(mValue,2,mean)\n[1] 3.6116440 0.4994208\n\n\u7406\u8ad6\u5024\u3068\u63a8\u5b9a\u306f\u4e00\u81f4\u3057\u3066\u3044\u307e\u3059\u3002\n\n\u30b3\u30fc\u30c9\n\ncode1.r\nt <- 25\u3000\u3000#\u884c\u306e\u6570\nn <- 1    #\u5b9f\u884c\u56de\u6570\nb1 <- 0.3\nb2 <- 0.5\n\nX1 <- matrix( c(50,1,2,3,4), nrow = t, ncol = n )\nX2 <- matrix( rexp(t*n,0.1), nrow = t, ncol = n )\nerror <- matrix( rnorm(t*n,0,5^0.5), nrow = t, ncol = n )\nY <- b1*X1 + b2*X2 + error\n#\u4ee5\u4e0a\u306e\u3088\u3046\u306b\u3001\u4e71\u6570\u3092\u767a\u751f\u3059\u308b\u3002\n#=========================\ny <- as.matrix(Y[,1])\nx <- as.matrix(X2[,1])\ncbind(y,x)\nTs <- ts(y,frequency = 5)\nDe <- decompose(Ts)\nfname <- paste(\"Decompose\", \".png\", sep =\"\")\npng(file = fname, height = 500, width = 800)\nplot(De)\ndev.off()\n#y\u3092\u5206\u89e3\u3057\u3001\u5b63\u7bc0\u6027\u3092\u30c1\u30a7\u30c3\u30af\u3059\u308b\u3002\n#==========================\np <- 5\ny_ma <- as.matrix(y[p:length(y),])\nx_ma <- as.matrix(x[p:length(y),])\nfor (i in p:length(y)) {\n    x_ma[i-p+1,] <- mean(x[(i-p+1):i,])\n    y_ma[i-p+1,] <- mean(y[(i-p+1):i,])\n}\nsummary( lm(y_ma ~ x_ma))\n#\u79fb\u52d5\u5e73\u5747\u3092\u53d6\u308a\u3001\u56de\u5e30\u5206\u6790\u3059\u308b\u3002\n\n\n\n\u30e2\u30f3\u30c6\u30ab\u30eb\u30ed.r\nt <- 25\u3000\u3000#\u884c\u306e\u6570\nn <- 10000    #\u5b9f\u884c\u56de\u6570\nb1 <- 0.3\nb2 <- 0.5\n\nX1 <- matrix( c(50,1,2,3,4), nrow = t, ncol = n )\nX2 <- matrix( rexp(t*n,0.1), nrow = t, ncol = n )\nerror <- matrix( rnorm(t*n,0,5^0.5), nrow = t, ncol = n )\nY <- b1*X1 + b2*X2 + error\n# ======================================\np <- 5\nFun_ma <- function(x) {\n  x_ma <- matrix(0,(length(x)-p+1),1)\n  for (i in p:length(x)) {\n    x_ma[i-p+1,] <- mean(x[(i-p+1):i])\n  }\n  x_ma\n}\nmx <- apply(X2,2,Fun_ma)\nmy <- apply(Y,2,Fun_ma)\n\nmValue <- matrix(0,n,2)\nfor (i in 1:n){\n  y <- my[,i]\n  x <- mx[,i]\n  mValue[i,] <- c(lm(y~x)$coefficients)\n}\napply(mValue,2,mean)\n\n\n\u3000\u6642\u7cfb\u5217\u30c7\u30fc\u30bf\u3092\u5206\u6790\u3059\u308b\u6642\u3001\u5468\u671f\u7684\u306a\u30c7\u30fc\u30bf\u304c\u5b58\u5728\u3059\u308b\u3053\u3068\u306f\u3001\u3057\u3070\u3057\u3070\u3042\u308a\u307e\u3059\u3002\u3053\u306e\u5468\u671f\u6027\u3092\u8003\u616e\u3057\u306a\u3051\u308c\u3070\u306a\u308a\u307e\u305b\u3093\u3002\u79fb\u52d5\u5e73\u5747\u6cd5\u3092\u3054\u7d39\u4ecb\u3057\u307e\u3059\u3002\u3053\u3053\u3067\u3001\u4e00\u756a\u30b7\u30f3\u30d7\u30eb\u306e\u79fb\u52d5\u5e73\u5747\u6cd5\u3092\u8aac\u660e\u3057\u307e\u3059\u3002\n\n#\u30c7\u30fc\u30bf\ny\uff1a\u76ee\u7684\u5909\u6570\nx\uff1a\u8aac\u660e\u5909\u6570\n\n```\n            y          x\n [1,] 16.3420349  7.21799609\n [2,]  9.4853139 20.07930955\n [3,]  2.0946638  2.54631266\n [4,]  3.0991178  8.43088240\n [5,]  7.8069991 10.23466188\n [6,] 13.9609309  0.45914370\n [7,]  3.3191959  6.34949213\n [8,] 14.1245312 25.38715182\n [9,] 19.1783122 31.96572503\n[10,]  2.6551769  3.69963485\n[11,] 23.5168751 22.20547723\n[12,]  6.0558261  9.21209711\n[13,]  1.5733379  2.07579350\n[14,]  1.1696452  0.57584675\n[15,]  5.4701931  6.58309332\n[16,] 17.7192605  4.28368676\n[17,]  2.1629390  7.82622938\n[18,]  3.9961220  2.56963947\n[19,] -0.4549355  1.65004434\n[20,] 17.1749453 37.00024382\n[21,] 22.6155962 16.01943730\n[22,] 10.6688664 13.77812541\n[23,] -1.6582567  0.09505423\n[24,]  4.6173663  3.14344014\n[25,]  2.1885696  2.06269316\n```\n\ny\u3092\u5206\u89e3\u3057\u3066\u307f\u308b\u3068\u3001\u5468\u671f\u6027\u304c\u3042\u308b\u3068\u5206\u304b\u308a\u307e\u3057\u305f\u3002\n\n<img src=\"https://qiita-image-store.s3.amazonaws.com/0/114190/f8e9e04d-789f-6e23-1e74-a3909655bc10.png\" width = \"800\" height = \"300\" alt=\"\u56fe\u7247\u540d\u79f0\" align=center />\n\n#\u79fb\u52d5\u5e73\u5747\u6cd5\n\u4e0a\u306e\u56f3\u3092\u5fa1\u89a7\u304f\u3060\u3055\u3044\u3002\u30c7\u30fc\u30bf\u30b5\u30a4\u30ba\u306f25\u3067\u30015\u500b\u306e\u30c7\u30fc\u30bf\u304c1\u3064\u306e\u5468\u671f\u3067\u3042\u308b\u3053\u3068\u304c\u5206\u304b\u308a\u307e\u3059\u3002\n\u3067\u306f\u3001\u6b21\u306e\u3088\u3046\u306b\u3001\u51e6\u7406\u3057\u307e\u3059\u3002\n$$my_{t-4}\\=\\frac{1}{5}\\sum_{t-4}^{t}y_i$$\n\u540c\u3058\u304f\n$$mx_{t-4}\\=\\frac{1}{5}\\sum_{t-4}^{t}x_i$$\n\n||y|my|x|mx| \n|:-:|:-:|:-:|:-:|:-:|\n|1|$$y_1$$|-|$$x_1$$|-| \n|2|$$y_2$$|-|$$x_2$$|-|\n|3|$$y_3$$|-|$$x_3$$|-|\n|4|$$y_4$$|-|$$x_4$$|-|\n|5|$$y_5$$|$$my_1$$|$$x_5$$|$$mx_1$$|\n|6|$$y_6$$|$$my_2$$|$$x_6$$|$$mx_2$$|\n|$$\\vdots$$|||||\n|24|$$y_{24}$$|$$my_{20}$$|$$x_{24}$$|$$mx_{20}$$|\n|25|$$y_{25}$$|$$my_{21}$$|$$x_{25}$$|$$mx_{21}$$|\n\n$my$\u3092\u76ee\u7684\u5909\u6570\u3068\u3001$mx$\u3092\u8aac\u660e\u5909\u6570\u3068\u3057\u3066\u3001\u56de\u5e30\u5206\u6790\u3092\u3059\u308c\u3070\u3088\u3044\u3067\u3059\u3002\n\n\u4e0b\u8a18\u306e\u5206\u6790\u7d50\u679c\u3088\u308a\u3001\n$$my_t\\=3.5+0.5ma_t$$\n\u3068\u306a\u308a\u307e\u3059\u304c\u3001$y$\u3068$x$\u306e\u95a2\u4fc2\u306f\u3069\u3046\u3067\u3057\u3087\u3046\u3002\n\u5e73\u5747\u5024\u306e\u6027\u8cea\u306b\u3088\u3063\u3066\u3001\n$$y_t=c_t+0.5x_t$$\n\u3053\u3053\u3067\u3001$c_t$\u306f\u5b9a\u6570\u9805\u3067\u3059\u3002\u3057\u304b\u3082\u3001\u5468\u671f\u6027\u304c\u3042\u308b\u306e\u3067\u3001$c_t$\u306e5\u500b\u306e\u5e73\u5747\u5024\u306f\u4e00\u5b9a\u3067\u30013.5\u3068\u306a\u308b\u306f\u305a\u3067\u3059\u3002\n\n```\nCall:\nlm(formula = y_ma ~ x_ma)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-0.9029 -0.2751 -0.0007  0.3610  0.7421 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|) \n\n(Intercept)  3.48831    0.27022   12.91 7.47e-11 ***\nx_ma         0.50053    0.02392   20.92 1.40e-14 ***\n---\nSignif. codes:  0 \u2018***\u2019 0.001 \u2018**\u2019 0.01 \u2018*\u2019 0.05 \u2018.\u2019 0.1 \u2018 \u2019 1\n\nResidual standard error: 0.4807 on 19 degrees of freedom\nMultiple R-squared:  0.9584,\tAdjusted R-squared:  0.9562 \nF-statistic: 437.7 on 1 and 19 DF,  p-value: 1.401e-14\n```\n\n\u5b9f\u306f\u3001\u3053\u306e\u30c7\u30fc\u30bf\u306f\u767a\u751f\u3057\u305f\u4e71\u6570\u3067\u3059\u3002\n$$y_t\\=b_1x_{1,t}+b_2x_{2,t}+\\varepsilon_t$$\n\u6570\u5217$x_1\\=(50,1,2,3,4,50,1,2,3,4,\\cdots)$\n\u6570\u5217$x_2$\u306f$\\lambda\\=0.1$\u6307\u6570\u4e71\u6570\u5217\n$b_1,b_2$\u306e\u8a2d\u5b9a\u5024\u306f$b_1\\=0.3,b_2\\=0.5$\n\n```code.r\nt <- 25\u3000\u3000#\u884c\u306e\u6570\nn <- 1    #\u5b9f\u884c\u56de\u6570\nb1 <- 0.3\nb2 <- 0.5\n\nX1 <- matrix( c(50,1,2,3,4), nrow = t, ncol = n )\nX2 <- matrix( rexp(t*n,0.1), nrow = t, ncol = n )\nerror <- matrix( rnorm(t*n,0,5^0.5), nrow = t, ncol = n )\nY <- b1*X1 + b2*X2 + error\n```\n\n##\u30e2\u30f3\u30c6\u30ab\u30eb\u30ed\u6cd5\n1\u56de\u306e\u7d50\u679c\u306f\u5076\u7136\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u304c\u300110000\u56de\u3067\u5b9f\u884c\u3057\u3001\u540c\u3058\u7d50\u679c\u3067\u3042\u308b\u304b\u3068\u30c1\u30a7\u30c3\u30af\u3057\u3066\u307f\u307e\u3057\u3087\u3046\u3002\n\u7406\u8ad6\u5024\u306e\u8a08\u7b97\uff1a\n$b_1\\=0.3$\n$b_2\\=0.5$\n$c=(50+1+2+3+4)/5*b_1=3.6$\n\n|$c$\u306e\u7406\u8ad6\u5024|$c$\u306e\u63a8\u5b9a|$b_2$\u306e\u7406\u8ad6|$b_2$\u306e\u63a8\u5b9a| \n|:-:|:-:|:-:|:-:|:-:|\n|3.6|3.6116|0.5|0.4994|\n\n```\n> apply(mValue,2,mean)\n[1] 3.6116440 0.4994208\n```\n\u7406\u8ad6\u5024\u3068\u63a8\u5b9a\u306f\u4e00\u81f4\u3057\u3066\u3044\u307e\u3059\u3002\n\n##\u30b3\u30fc\u30c9\n\n```code1.r\nt <- 25\u3000\u3000#\u884c\u306e\u6570\nn <- 1    #\u5b9f\u884c\u56de\u6570\nb1 <- 0.3\nb2 <- 0.5\n\nX1 <- matrix( c(50,1,2,3,4), nrow = t, ncol = n )\nX2 <- matrix( rexp(t*n,0.1), nrow = t, ncol = n )\nerror <- matrix( rnorm(t*n,0,5^0.5), nrow = t, ncol = n )\nY <- b1*X1 + b2*X2 + error\n#\u4ee5\u4e0a\u306e\u3088\u3046\u306b\u3001\u4e71\u6570\u3092\u767a\u751f\u3059\u308b\u3002\n#=========================\ny <- as.matrix(Y[,1])\nx <- as.matrix(X2[,1])\ncbind(y,x)\nTs <- ts(y,frequency = 5)\nDe <- decompose(Ts)\nfname <- paste(\"Decompose\", \".png\", sep =\"\")\npng(file = fname, height = 500, width = 800)\nplot(De)\ndev.off()\n#y\u3092\u5206\u89e3\u3057\u3001\u5b63\u7bc0\u6027\u3092\u30c1\u30a7\u30c3\u30af\u3059\u308b\u3002\n#==========================\np <- 5\ny_ma <- as.matrix(y[p:length(y),])\nx_ma <- as.matrix(x[p:length(y),])\nfor (i in p:length(y)) {\n    x_ma[i-p+1,] <- mean(x[(i-p+1):i,])\n    y_ma[i-p+1,] <- mean(y[(i-p+1):i,])\n}\nsummary( lm(y_ma ~ x_ma))\n#\u79fb\u52d5\u5e73\u5747\u3092\u53d6\u308a\u3001\u56de\u5e30\u5206\u6790\u3059\u308b\u3002\n```\n\n```\u30e2\u30f3\u30c6\u30ab\u30eb\u30ed.r\nt <- 25\u3000\u3000#\u884c\u306e\u6570\nn <- 10000    #\u5b9f\u884c\u56de\u6570\nb1 <- 0.3\nb2 <- 0.5\n\nX1 <- matrix( c(50,1,2,3,4), nrow = t, ncol = n )\nX2 <- matrix( rexp(t*n,0.1), nrow = t, ncol = n )\nerror <- matrix( rnorm(t*n,0,5^0.5), nrow = t, ncol = n )\nY <- b1*X1 + b2*X2 + error\n# ======================================\np <- 5\nFun_ma <- function(x) {\n  x_ma <- matrix(0,(length(x)-p+1),1)\n  for (i in p:length(x)) {\n    x_ma[i-p+1,] <- mean(x[(i-p+1):i])\n  }\n  x_ma\n}\nmx <- apply(X2,2,Fun_ma)\nmy <- apply(Y,2,Fun_ma)\n\nmValue <- matrix(0,n,2)\nfor (i in 1:n){\n  y <- my[,i]\n  x <- mx[,i]\n  mValue[i,] <- c(lm(y~x)$coefficients)\n}\napply(mValue,2,mean)\n```\n", "tags": ["\u7d71\u8a08\u5b66", "R"]}