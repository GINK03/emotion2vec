{"context": " More than 1 year has passed since last update.ROMA\u306e\u3042\u307e\u308a\u77e5\u3089\u308c\u3066\u3044\u306a\u3044\u6a5f\u80fd\u3084\u88cf\u6280\u7684\u306a\u3082\u306e\u306e\u7d39\u4ecb\u3067\u3059\n\neval\u30b3\u30de\u30f3\u30c9\nplugin_debug.rb\u3092\u8aad\u307f\u8fbc\u3093\u3067\u3044\u308b\u5834\u5408\u3001ROMA\u30b3\u30f3\u30bd\u30fc\u30eb\u4e0a\u3067eval\u30b3\u30de\u30f3\u30c9\u304c\u4f7f\u7528\u3067\u304d\u307e\u3059\nROMA\u306b\u95a2\u3059\u308b\u5024\u3092\u53c2\u7167\u3057\u305f\u308a\u3001\u5024\u306e\u66f8\u304d\u63db\u3048\u3001\u9032\u884c\u4e2d\u306e\u30d7\u30ed\u30bb\u30b9\u306e\u5f37\u5236\u7d42\u4e86\u306a\u3069\u304c\u53ef\u80fd\u3067\u3059\n> eval @stats\n#<Roma::Stats:0x00000001a79fa8>\n\n> eval @stats.log_level\ndebug\n\n> stat run_recover\nstats.run_recover true\nEND\n\n> eval @stats.run_recover=false\nfalse\n\n> stat run_recover\nstats.run_recover false\nEND\n\n\neval\u3067\u53c2\u7167\u3067\u304d\u308b\u5024\u306e\u4f8b\n> eval methods\n[:ev_eval, :get_key_info, :ev_alist_at, :ev_alist_clear\u30fb\u30fb\u30fb\u30fb\n\n> eval self\n#<Roma::Command::Receiver:0x000000009d7f88>\n\n> eval @storages[\"roma\"]\n#<Roma::Storage::TCStorage:0x00000001bdd160>\n\n> eval @rttable\n#<Roma::Routing::ChurnbasedRoutingTable:0x00000002acaa10>\n\n\n!!\u30b3\u30de\u30f3\u30c9\n!!\u30b3\u30de\u30f3\u30c9\u306f\u4e00\u3064\u524d\u306b\u5b9f\u884c\u3055\u308c\u305f\u30b3\u30de\u30f3\u30c9\u3092\u7e70\u308a\u8fd4\u3057\u307e\u3059\n> stat version_of_nodes\nrouting.version_of_nodes {\"localhost_10001\"=>66048, \"localhost_10002\"=>66048}\nEND\n\n> !!\nrouting.version_of_nodes {\"localhost_10001\"=>66048, \"localhost_10002\"=>66048}\nEND\n\n> stat lost_action\nrouting.lost_action auto_assign\nEND\n\n> !!\nrouting.lost_action auto_assign\nEND\n\n\ndisabled_cmd_protect\u30aa\u30d7\u30b7\u30e7\u30f3\nROMA\u306f\u6574\u5408\u6027\u3092\u4fdd\u3064\u305f\u3081\u306b\u3001\u8d77\u52d5\u6642\u306b\u4ed6\u306e\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u304c\u5168\u3066\u7acb\u3061\u4e0a\u304c\u308b\u307e\u3067\u306f\u30b3\u30de\u30f3\u30c9\u3092\u53d7\u3051\u4ed8\u3051\u306a\u3044\u3088\u3046\u306b\u3057\u3066\u3044\u307e\u3059\n\u3057\u304b\u3057--disabled_cmd_protect\u30aa\u30d7\u30b7\u30e7\u30f3\u3092\u4f7f\u7528\u3059\u308c\u3070\u3001\u5f37\u5236\u7684\u306b\u3053\u306e\u30d7\u30ed\u30c6\u30af\u30c8\u3092off\u306b\u3059\u308b\u3053\u3068\u304c\u51fa\u6765\u307e\u3059\n$ romad ${address} -p ${port} --disabled_cmd_protect\n\n\nfailover\u6a5f\u80fd\nROMA\u306f\u5e38\u306b\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u540c\u58eb\u3067\u30d8\u30eb\u30b9\u30c1\u30a7\u30c3\u30af\u3092\u884c\u3063\u3066\u304a\u308a\u3001\u30b5\u30fc\u30d0\u30a8\u30e9\u30fc\u306a\u3069\u3067\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u304c\u843d\u3061\u308b\u3068\u3059\u3050\u306b\u691c\u77e5\u3057\u3066routing\u306e\u66f8\u304d\u63db\u3048\u306a\u3069\u3092\u884c\u3044\u307e\u3059\n\u30e1\u30f3\u30c6\u30ca\u30f3\u30b9\u306a\u3069\u3067\u4e00\u6642\u7684\u306bROMA\u9593\u306e\u30a2\u30af\u30bb\u30b9\u304c\u9014\u5207\u308c\u308b\u5834\u5408\u306a\u3069\u3001\u306a\u3093\u3089\u304b\u306e\u7406\u7531\u3067\u3053\u306efailover\u6a5f\u80fd\u3092\u4e00\u6642\u7684\u306b\u7121\u52b9\u5316\u3057\u305f\u3044\u5834\u5408\u306fswitch_failover\u30b3\u30de\u30f3\u30c9\u3067on/off\u306e\u5207\u308a\u66ff\u3048\u304c\u3067\u304d\u307e\u3059\n> stat failover\nrouting.enabled_failover true\nEND\n\n> switch_failover off\n{\"localhost_10002\"=>\"DISABLED\", \"localhost_10001\"=>\"DISABLED\"}\n\n> stat failover\nrouting.enabled_failover false\nEND\n\n\n\u30b3\u30f3\u30bd\u30fc\u30eb\u4e0a\u3067\u306e\u30ed\u30b0\u306e\u78ba\u8a8d\nplugin_gui.rb\u3092\u8aad\u307f\u8fbc\u3093\u3067\u3044\u308b\u5834\u5408\u3001\u30b3\u30f3\u30bd\u30fc\u30eb\u4e0a\u3067\u3082\u30ed\u30b0\u3092\u78ba\u8a8d\u3059\u308b\u3053\u3068\u304c\u53ef\u80fd\u3067\u3059\n\n\u30ed\u30b0\u53d6\u5f97\n> gather_logs <start_date> [end_date]\\r\\n \n\n\n\n\u30ed\u30b0\u8868\u793a\n> show_logs\\r\\n \n\n\n\u4f8b\n> gather_logs 2015-12-21T00:00:00\nSTARTED\n\n> show_logs\n2015-12-21 04:26:50 +0000\nI, [2015-12-21T03:56:28.401614 #1586]  INFO -- : roma/plugin/plugin_storage.rb loaded\nI, [2015-12-21T03:56:28.419204 #1586]  INFO -- : roma/plugin/plugin_mapcount.rb loaded\nI, [2015-12-21T03:56:28.419858 #1586]  INFO -- : roma/plugin/plugin_gui.rb loaded\nI, [2015-12-21T03:56:28.420322 #1586]  INFO -- : roma/plugin/plugin_cmd_aliases.rb loaded\nI, [2015-12-21T03:56:28.420734 #1586]  INFO -- : roma/plugin/plugin_test.rb loaded.\n.\n.\n.\nW, [2015-12-21T04:26:27.759137 #3045]  WARN -- : failover disable now!!\nW, [2015-12-21T04:26:37.759377 #3045]  WARN -- : failover disable now!!\nW, [2015-12-21T04:26:47.759665 #3045]  WARN -- : failover disable now!!\nD, [2015-12-21T04:26:50.775155 #3045] DEBUG -- : asyncev_start_get_logs [\"2015-12-21T00:00:00\", \"current\"]\nD, [2015-12-21T04:26:50.775305 #3045] DEBUG -- : get_logs:start.\nEND\n\n\nlatency\u6e2c\u5b9a\n\u30b3\u30de\u30f3\u30c9\u3092\u6307\u5b9a\u3057\u3066\u3001latency\u306eaverage\u3092\u30ed\u30b0\u306b\u51fa\u529b\u3059\u308b\u3053\u3068\u304c\u51fa\u6765\u307e\u3059\nset_latency_avg_calc_rule [on/off, time, command1, command2,....]\nadd_latency_avg_calc_cmd [command1, command2,....]\ndel_latency_avg_calc_cmd [command1, command2,....]\nchg_latency_avg_calc_time_count [count]\n\u4f8b\n> set_latency_avg_calc_rule on 10 set get\n{\"localhost_10002\"=>\"ACTIVATED\", \"localhost_10001\"=>\"ACTIVATED\"}\n\nlog file\n.\n.\nD, [2015-12-21T04:32:13.645454 #3045] DEBUG -- : Latency average[set]: 1.06072156(denominator=3 max=1.47735364 min=0.81634303)\nD, [2015-12-21T04:32:15.213215 #3045] DEBUG -- : Latency average[get]: 0.00016599(denominator=3 max=0.00019756 min=0.00014080)\n.\n.\n\n\nget_routing_history\n\u69cb\u7bc9\u6642\u306e\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u60c5\u5831\u3092\u78ba\u8a8d\u3059\u308b\u3053\u3068\u304c\u51fa\u6765\u307e\u3059\n> get_routing_history\nlocalhost_10001\nlocalhost_10002\nEND\n\n\nrouting event\n\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306e\u8ffd\u52a0\u3084\u7834\u68c4\u306a\u3069\u306e\u30a4\u30d9\u30f3\u30c8\u3092\u78ba\u8a8d\u3059\u308b\u3053\u3068\u304c\u53ef\u80fd\u3067\u3059\n> stat event\nrouting.event [\"2015-12-21T04:36:39.814602 leave localhost_10002\", \"2015-12-21T04:37:07.812046 join localhost_20001\"]\n\n\n\u52d5\u7684\u5909\u66f4\u30b3\u30de\u30f3\u30c9\nROMA\u306e\u8a2d\u5b9a\u3092\u5909\u66f4\u3059\u308b\u3068\u304d\u306f\u3001config.rb\u3092\u7de8\u96c6\u3057\u3066\u8d77\u52d5\u6642\u306b--config\u30aa\u30d7\u30b7\u30e7\u30f3\u3067\u8aad\u307f\u8fbc\u3080\u3053\u3068\u3067\u53cd\u6620\u3067\u304d\u307e\u3059\u304c\u3001ROMA\u8d77\u52d5\u5f8c\u3082config\u306e\u307b\u3068\u3093\u3069\u306e\u9805\u76ee\u3092\u5909\u66f4\u3059\u308b\u3053\u3068\u304c\u53ef\u80fd\u3067\u3059\n\u4f8b\n> set_lost_action shutdown\n{\"localhost_10002\"=>STORED, \"localhost_10001\"=>\"STORED\"}\n\n> set_log_level info\nSTORED\n\n> set_hilatency_warn_time 10\n{\"localhost_10002\"=>STORED, \"localhost_10001\"=>\"STORED\"}\n\n\n\u53c2\u7167URL\nROMA Commands Page: http://roma-kvs.org/commands.html\nROMA\u306e\u3042\u307e\u308a\u77e5\u3089\u308c\u3066\u3044\u306a\u3044\u6a5f\u80fd\u3084\u88cf\u6280\u7684\u306a\u3082\u306e\u306e\u7d39\u4ecb\u3067\u3059\n\n# eval\u30b3\u30de\u30f3\u30c9\nplugin_debug.rb\u3092\u8aad\u307f\u8fbc\u3093\u3067\u3044\u308b\u5834\u5408\u3001ROMA\u30b3\u30f3\u30bd\u30fc\u30eb\u4e0a\u3067eval\u30b3\u30de\u30f3\u30c9\u304c\u4f7f\u7528\u3067\u304d\u307e\u3059\nROMA\u306b\u95a2\u3059\u308b\u5024\u3092\u53c2\u7167\u3057\u305f\u308a\u3001\u5024\u306e\u66f8\u304d\u63db\u3048\u3001\u9032\u884c\u4e2d\u306e\u30d7\u30ed\u30bb\u30b9\u306e\u5f37\u5236\u7d42\u4e86\u306a\u3069\u304c\u53ef\u80fd\u3067\u3059\n\n```rb\n> eval @stats\n#<Roma::Stats:0x00000001a79fa8>\n\n> eval @stats.log_level\ndebug\n\n> stat run_recover\nstats.run_recover true\nEND\n\n> eval @stats.run_recover=false\nfalse\n\n> stat run_recover\nstats.run_recover false\nEND\n```\n### eval\u3067\u53c2\u7167\u3067\u304d\u308b\u5024\u306e\u4f8b\n\n```rb\n> eval methods\n[:ev_eval, :get_key_info, :ev_alist_at, :ev_alist_clear\u30fb\u30fb\u30fb\u30fb\n\n> eval self\n#<Roma::Command::Receiver:0x000000009d7f88>\n\n> eval @storages[\"roma\"]\n#<Roma::Storage::TCStorage:0x00000001bdd160>\n\n> eval @rttable\n#<Roma::Routing::ChurnbasedRoutingTable:0x00000002acaa10>\n```\n\n# !!\u30b3\u30de\u30f3\u30c9\n!!\u30b3\u30de\u30f3\u30c9\u306f\u4e00\u3064\u524d\u306b\u5b9f\u884c\u3055\u308c\u305f\u30b3\u30de\u30f3\u30c9\u3092\u7e70\u308a\u8fd4\u3057\u307e\u3059\n\n```rb\n> stat version_of_nodes\nrouting.version_of_nodes {\"localhost_10001\"=>66048, \"localhost_10002\"=>66048}\nEND\n\n> !!\nrouting.version_of_nodes {\"localhost_10001\"=>66048, \"localhost_10002\"=>66048}\nEND\n\n> stat lost_action\nrouting.lost_action auto_assign\nEND\n\n> !!\nrouting.lost_action auto_assign\nEND\n```\n\n# disabled_cmd_protect\u30aa\u30d7\u30b7\u30e7\u30f3\nROMA\u306f\u6574\u5408\u6027\u3092\u4fdd\u3064\u305f\u3081\u306b\u3001\u8d77\u52d5\u6642\u306b\u4ed6\u306e\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u304c\u5168\u3066\u7acb\u3061\u4e0a\u304c\u308b\u307e\u3067\u306f\u30b3\u30de\u30f3\u30c9\u3092\u53d7\u3051\u4ed8\u3051\u306a\u3044\u3088\u3046\u306b\u3057\u3066\u3044\u307e\u3059\n\u3057\u304b\u3057`--disabled_cmd_protect`\u30aa\u30d7\u30b7\u30e7\u30f3\u3092\u4f7f\u7528\u3059\u308c\u3070\u3001\u5f37\u5236\u7684\u306b\u3053\u306e\u30d7\u30ed\u30c6\u30af\u30c8\u3092off\u306b\u3059\u308b\u3053\u3068\u304c\u51fa\u6765\u307e\u3059\n\n```bash\n$ romad ${address} -p ${port} --disabled_cmd_protect\n```\n\n# failover\u6a5f\u80fd\nROMA\u306f\u5e38\u306b\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u540c\u58eb\u3067\u30d8\u30eb\u30b9\u30c1\u30a7\u30c3\u30af\u3092\u884c\u3063\u3066\u304a\u308a\u3001\u30b5\u30fc\u30d0\u30a8\u30e9\u30fc\u306a\u3069\u3067\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u304c\u843d\u3061\u308b\u3068\u3059\u3050\u306b\u691c\u77e5\u3057\u3066routing\u306e\u66f8\u304d\u63db\u3048\u306a\u3069\u3092\u884c\u3044\u307e\u3059\n\u30e1\u30f3\u30c6\u30ca\u30f3\u30b9\u306a\u3069\u3067\u4e00\u6642\u7684\u306bROMA\u9593\u306e\u30a2\u30af\u30bb\u30b9\u304c\u9014\u5207\u308c\u308b\u5834\u5408\u306a\u3069\u3001\u306a\u3093\u3089\u304b\u306e\u7406\u7531\u3067\u3053\u306efailover\u6a5f\u80fd\u3092\u4e00\u6642\u7684\u306b\u7121\u52b9\u5316\u3057\u305f\u3044\u5834\u5408\u306f`switch_failover`\u30b3\u30de\u30f3\u30c9\u3067on/off\u306e\u5207\u308a\u66ff\u3048\u304c\u3067\u304d\u307e\u3059\n\n```rb\n> stat failover\nrouting.enabled_failover true\nEND\n\n> switch_failover off\n{\"localhost_10002\"=>\"DISABLED\", \"localhost_10001\"=>\"DISABLED\"}\n\n> stat failover\nrouting.enabled_failover false\nEND\n```\n\n# \u30b3\u30f3\u30bd\u30fc\u30eb\u4e0a\u3067\u306e\u30ed\u30b0\u306e\u78ba\u8a8d\nplugin_gui.rb\u3092\u8aad\u307f\u8fbc\u3093\u3067\u3044\u308b\u5834\u5408\u3001\u30b3\u30f3\u30bd\u30fc\u30eb\u4e0a\u3067\u3082\u30ed\u30b0\u3092\u78ba\u8a8d\u3059\u308b\u3053\u3068\u304c\u53ef\u80fd\u3067\u3059\n\n```rb:\u30ed\u30b0\u53d6\u5f97\n> gather_logs <start_date> [end_date]\\r\\n \n```\n```rb:\u30ed\u30b0\u8868\u793a\n> show_logs\\r\\n \n```\n\u4f8b\n\n```rb\n> gather_logs 2015-12-21T00:00:00\nSTARTED\n\n> show_logs\n2015-12-21 04:26:50 +0000\nI, [2015-12-21T03:56:28.401614 #1586]  INFO -- : roma/plugin/plugin_storage.rb loaded\nI, [2015-12-21T03:56:28.419204 #1586]  INFO -- : roma/plugin/plugin_mapcount.rb loaded\nI, [2015-12-21T03:56:28.419858 #1586]  INFO -- : roma/plugin/plugin_gui.rb loaded\nI, [2015-12-21T03:56:28.420322 #1586]  INFO -- : roma/plugin/plugin_cmd_aliases.rb loaded\nI, [2015-12-21T03:56:28.420734 #1586]  INFO -- : roma/plugin/plugin_test.rb loaded.\n.\n.\n.\nW, [2015-12-21T04:26:27.759137 #3045]  WARN -- : failover disable now!!\nW, [2015-12-21T04:26:37.759377 #3045]  WARN -- : failover disable now!!\nW, [2015-12-21T04:26:47.759665 #3045]  WARN -- : failover disable now!!\nD, [2015-12-21T04:26:50.775155 #3045] DEBUG -- : asyncev_start_get_logs [\"2015-12-21T00:00:00\", \"current\"]\nD, [2015-12-21T04:26:50.775305 #3045] DEBUG -- : get_logs:start.\nEND\n```\n\n# latency\u6e2c\u5b9a\n\u30b3\u30de\u30f3\u30c9\u3092\u6307\u5b9a\u3057\u3066\u3001latency\u306eaverage\u3092\u30ed\u30b0\u306b\u51fa\u529b\u3059\u308b\u3053\u3068\u304c\u51fa\u6765\u307e\u3059\n`set_latency_avg_calc_rule [on/off, time, command1, command2,....]`\n`add_latency_avg_calc_cmd [command1, command2,....]`\n`del_latency_avg_calc_cmd [command1, command2,....]`\n`chg_latency_avg_calc_time_count [count]`\n\n\u4f8b\n\n```\n> set_latency_avg_calc_rule on 10 set get\n{\"localhost_10002\"=>\"ACTIVATED\", \"localhost_10001\"=>\"ACTIVATED\"}\n```\nlog file\n\n```\n.\n.\nD, [2015-12-21T04:32:13.645454 #3045] DEBUG -- : Latency average[set]: 1.06072156(denominator=3 max=1.47735364 min=0.81634303)\nD, [2015-12-21T04:32:15.213215 #3045] DEBUG -- : Latency average[get]: 0.00016599(denominator=3 max=0.00019756 min=0.00014080)\n.\n.\n```\n\n# get_routing_history\n\u69cb\u7bc9\u6642\u306e\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u60c5\u5831\u3092\u78ba\u8a8d\u3059\u308b\u3053\u3068\u304c\u51fa\u6765\u307e\u3059\n\n```\n> get_routing_history\nlocalhost_10001\nlocalhost_10002\nEND\n```\n\n# routing event\n\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306e\u8ffd\u52a0\u3084\u7834\u68c4\u306a\u3069\u306e\u30a4\u30d9\u30f3\u30c8\u3092\u78ba\u8a8d\u3059\u308b\u3053\u3068\u304c\u53ef\u80fd\u3067\u3059\n\n```\n> stat event\nrouting.event [\"2015-12-21T04:36:39.814602 leave localhost_10002\", \"2015-12-21T04:37:07.812046 join localhost_20001\"]\n```\n\n# \u52d5\u7684\u5909\u66f4\u30b3\u30de\u30f3\u30c9\nROMA\u306e\u8a2d\u5b9a\u3092\u5909\u66f4\u3059\u308b\u3068\u304d\u306f\u3001config.rb\u3092\u7de8\u96c6\u3057\u3066\u8d77\u52d5\u6642\u306b--config\u30aa\u30d7\u30b7\u30e7\u30f3\u3067\u8aad\u307f\u8fbc\u3080\u3053\u3068\u3067\u53cd\u6620\u3067\u304d\u307e\u3059\u304c\u3001ROMA\u8d77\u52d5\u5f8c\u3082config\u306e\u307b\u3068\u3093\u3069\u306e\u9805\u76ee\u3092\u5909\u66f4\u3059\u308b\u3053\u3068\u304c\u53ef\u80fd\u3067\u3059\n\u4f8b\n\n```rb\n> set_lost_action shutdown\n{\"localhost_10002\"=>STORED, \"localhost_10001\"=>\"STORED\"}\n\n> set_log_level info\nSTORED\n\n> set_hilatency_warn_time 10\n{\"localhost_10002\"=>STORED, \"localhost_10001\"=>\"STORED\"}\n```\n# \u53c2\u7167URL\nROMA Commands Page: http://roma-kvs.org/commands.html\n", "tags": ["Ruby", "nosql", "Database", "KVS", "roma"]}