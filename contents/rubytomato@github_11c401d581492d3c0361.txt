{"context": " More than 1 year has passed since last update.\n\n\u6982\u8981\nGoogle \u30b9\u30d7\u30ec\u30c3\u30c9\u30b7\u30fc\u30c8\u3092Java\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u304b\u3089\u64cd\u4f5c\u3059\u308b\u30b5\u30f3\u30d7\u30eb\u30d7\u30ed\u30b0\u30e9\u30e0\u3067\u3059\u3002\n\u60f3\u5b9a\u3059\u308b\u306e\u306f\u3001\u4f8b\u3048\u3070\u300c\u30d0\u30c3\u30c1\u30d7\u30ed\u30b0\u30e9\u30e0\u3067\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u304b\u3089\u96c6\u8a08\u3057\u305f\u30c7\u30fc\u30bf\u3092Google Sheets API\u3092\u4f7f\u7528\u3057\u3066Google \u30b9\u30d7\u30ec\u30c3\u30c9\u30b7\u30fc\u30c8\u3078\u66f4\u65b0\u3059\u308b\u300d\u306a\u3069\u3067\u3059\u3002\nGoogle\u306e\u8a8d\u8a3c\u65b9\u6cd5\u306b\u306fOAuth2\u3084\u30b5\u30fc\u30d3\u30b9\u30a2\u30ab\u30a6\u30f3\u30c8\u306a\u3069\u304c\u3042\u308a\u307e\u3059\u304c\u3001\u30d0\u30c3\u30c1\u51e6\u7406\u306a\u3069\u30e6\u30fc\u30b6\u30fc\u304c\u76f4\u63a5\u4ecb\u3055\u306a\u3044\u5834\u5408\u306e\u8a8d\u8a3c\u65b9\u6cd5\u306f\u30b5\u30fc\u30d3\u30b9\u30a2\u30ab\u30a6\u30f3\u30c8\u3092\u4f7f\u7528\u3059\u308b\u65b9\u304c\u826f\u3044\u3088\u3046\u3067\u3059\u3002\n\u74b0\u5883\n\u4e0b\u8a18\u306e\u74b0\u5883\u3067\u52d5\u4f5c\u78ba\u8a8d\u3092\u884c\u3044\u307e\u3057\u305f\u3002\n\nWindows7 (64bit)\nJava 1.8.0_60\n\ngoogle-api-java-client 1.20.0\n\ngdata-java-client 1.47.1\n\n\nJavaMail 1.4.5\n\n\n\n\u53c2\u8003\n\u4e0b\u8a18\u306e\u30b5\u30a4\u30c8\u3092\u53c2\u8003\u306b\u3055\u305b\u3066\u9802\u304d\u307e\u3057\u305f\u3002\n\nThe Google Sheets API\nGData API\u3067Google\u30b9\u30d7\u30ec\u30c3\u30c9\u30b7\u30fc\u30c8\u3092\u53c2\u7167\u3059\u308b\u306b\u306f (1/3)\nGoogle API \u7528\u306e\u30a2\u30af\u30bb\u30b9\u30c8\u30fc\u30af\u30f3\u3092\u30b5\u30fc\u30d3\u30b9\u30a2\u30ab\u30a6\u30f3\u30c8\u3067\u53d6\u5f97 - Google API Client Library for Java\nGoogle Spreadsheet with a service account\n\n\n\u4e8b\u524d\u6e96\u5099\n\nAPI\u306e\u6709\u52b9\u5316\nDrive API\u3092\u6709\u52b9\u5316\u3057\u307e\u3059\u3002\n\n\nGoogle Developers Console\u306b\u30a2\u30af\u30bb\u30b9\u3057\u307e\u3059\u3002\n\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092\u767b\u9332\u3057\u3066\u3044\u306a\u3044\u304b\u5c02\u7528\u306e\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092\u7528\u610f\u3057\u305f\u3044\u5834\u5408\u306f\u767b\u9332\u3057\u307e\u3059\u3002\n\u5de6\u30e1\u30cb\u30e5\u30fc\u306e\"API\u3068\u8a8d\u8a3c\" -> \"API\"\u3092\u9078\u629e\u3057\u307e\u3059\u3002\nAPI\u30e9\u30a4\u30d6\u30e9\u30ea\u306e\u4e00\u89a7\u304b\u3089 -> \"Google Apps API\" -> \"Drvie API\"\u3092\u6709\u52b9\u5316\u3057\u307e\u3059\u3002\n\n\n\n\u8a8d\u8a3c\u60c5\u5831\u306e\u8ffd\u52a0\n\u30b5\u30fc\u30d3\u30b9\u30a2\u30ab\u30a6\u30f3\u30c8\u3092\u8ffd\u52a0\u3057\u307e\u3059\u3002\n\n\u5de6\u30e1\u30cb\u30e5\u30fc\u306e\"API\u3068\u8a8d\u8a3c\" -> \"\u8a8d\u8a3c\u60c5\u5831\"\u3092\u9078\u629e\u3057\u307e\u3059\u3002\n\"\u8a8d\u8a3c\u60c5\u5831\u3092\u8ffd\u52a0\"\u30dc\u30bf\u30f3\u3092\u30af\u30ea\u30c3\u30af\u3057\u307e\u3059\u3002\n\u30e1\u30cb\u30e5\u30fc\u306e\"\u30b5\u30fc\u30d3\u30b9\u30a2\u30ab\u30a6\u30f3\u30c8\"\u3092\u9078\u629e\u3057\u307e\u3059\u3002\n\u30ad\u30fc\u306e\u30bf\u30a4\u30d7\u306b\"P12\"\u3092\u9078\u629e\u3057\u307e\u3059\u3002\n\n\n\n\u30b5\u30fc\u30d3\u30b9\u30a2\u30ab\u30a6\u30f3\u30c8\u306e\u8ffd\u52a0\u304c\u6210\u529f\u3059\u308b\u3068\u3001\u30af\u30e9\u30a4\u30a2\u30f3\u30c8ID\u3001\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u3001\u8a3c\u660e\u66f8\u30d5\u30a3\u30f3\u30ac\u30fc\u30d7\u30ea\u30f3\u30c8\u304c\u767a\u884c\u3055\u308c\u3001P12\u30ad\u30fc\u30d5\u30a1\u30a4\u30eb\u306e\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u304c\u884c\u308f\u308c\u307e\u3059\u3002\n\n\n\u4f7f\u7528\u3059\u308b\u30e9\u30a4\u30d6\u30e9\u30ea\n\ngoogle-api-java-client\nhttps://github.com/google/google-api-java-client\n\ndependency\n<dependency>\n  <groupId>com.google.api-client</groupId>\n  <artifactId>google-api-client</artifactId>\n  <version>1.20.0</version>\n</dependency>\n\n\n\ngdata-java-client\nhttps://github.com/google/gdata-java-client\n\ndependency\n<dependency>\n  <groupId>com.google.gdata</groupId>\n  <artifactId>core</artifactId>\n  <version>1.47.1</version>\n  <exclusions>\n    <exclusion>\n      <groupId>com.google.code.findbugs</groupId>\n      <artifactId>jsr305</artifactId>\n    </exclusion>\n  </exclusions>\n</dependency>\n\n\n\n\u30c6\u30b9\u30c8\u3067\u4f7f\u7528\u3059\u308b\u30b9\u30d7\u30ec\u30c3\u30c9\u30b7\u30fc\u30c8\u3092\u4f5c\u6210\n\u30b9\u30d7\u30ec\u30c3\u30c9\u30b7\u30fc\u30c8\u540d: \u30c6\u30b9\u30c8\u30b9\u30d7\u30ec\u30c3\u30c9\u30b7\u30fc\u30c8\n\n\u4e0a\u8a18\u3067\u4f5c\u6210\u3057\u305f\u30b5\u30fc\u30d3\u30b9\u30a2\u30ab\u30a6\u30f3\u30c8\u3067\u3053\u306e\u30b9\u30d7\u30ec\u30c3\u30c9\u30b7\u30fc\u30c8\u306b\u66f8\u304d\u8fbc\u3081\u308b\u3088\u3046\u306b\u6a29\u9650\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n\u30b7\u30fc\u30c8\u53f3\u7aef\u306b\u3042\u308b\u5171\u6709\u30dc\u30bf\u30f3\u3092\u30af\u30ea\u30c3\u30af\u3057\u3001\u30b5\u30fc\u30d3\u30b9\u30a2\u30ab\u30a6\u30f3\u30c8\u306e\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u3092\u5165\u529b\u3057\u9001\u4fe1\u30dc\u30bf\u30f3\u3092\u30af\u30ea\u30c3\u30af\u3057\u307e\u3059\u3002\n\n\n\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u958b\u767a\n\n\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306e\u96db\u5f62\u3092\u751f\u6210\n\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u540d: google-ss-example\nmaven\u3067\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u96db\u5f62\u3092\u4f5c\u6210\n> mvn archetype:generate -DgroupId=com.example.gss -DartifactId=google-ss-example -DarchetypeArtifactId=maven-archetype-quickstart -DinteractiveMode=false\n\n> cd google-ss-example\n> mvn eclipse:eclipse\n\neclipse\u306b\u30a4\u30f3\u30dd\u30fc\u30c8\n\n\u30e1\u30cb\u30e5\u30fc\u30d0\u30fc\u306e\"File\" -> \"Import...\" -> \"Maven\" -> \"Existing Maven Projects\"\u3092\u9078\u629e\u3057\u307e\u3059\u3002\n\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306e\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092\u9078\u629e\u3057\u3001\"Finish\"\u30dc\u30bf\u30f3\u3092\u30af\u30ea\u30c3\u30af\u3057\u307e\u3059\u3002\n\npom.xml\u306e\u7de8\u96c6\n\npom.xml\n<project xmlns=\"http://maven.apache.org/POM/4.0.0\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n  xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd\">\n  <modelVersion>4.0.0</modelVersion>\n  <groupId>com.example.gss</groupId>\n  <artifactId>google-ss-example</artifactId>\n  <packaging>jar</packaging>\n  <version>1.0-SNAPSHOT</version>\n  <name>google-ss-example</name>\n  <url>http://maven.apache.org</url>\n\n  <properties>\n    <java.version>1.8</java.version>\n    <project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>\n  </properties>\n\n  <dependencies>\n\n    <dependency>\n      <groupId>com.google.api-client</groupId>\n      <artifactId>google-api-client</artifactId>\n      <version>1.20.0</version>\n    </dependency>\n\n    <dependency>\n      <groupId>com.google.gdata</groupId>\n      <artifactId>core</artifactId>\n      <version>1.47.1</version>\n      <exclusions>\n        <exclusion>\n          <groupId>com.google.code.findbugs</groupId>\n          <artifactId>jsr305</artifactId>\n        </exclusion>\n      </exclusions>\n    </dependency>\n\n    <dependency>\n      <groupId>commons-collections</groupId>\n      <artifactId>commons-collections</artifactId>\n      <version>3.2.1</version>\n    </dependency>\n    <dependency>\n      <groupId>org.apache.commons</groupId>\n      <artifactId>commons-lang3</artifactId>\n      <version>3.4</version>\n    </dependency>\n\n    <dependency>\n      <groupId>org.slf4j</groupId>\n      <artifactId>slf4j-api</artifactId>\n      <version>1.7.12</version>\n    </dependency>\n    <dependency>\n      <groupId>ch.qos.logback</groupId>\n      <artifactId>logback-classic</artifactId>\n      <version>1.1.3</version>\n    </dependency>\n\n    <dependency>\n      <groupId>junit</groupId>\n      <artifactId>junit</artifactId>\n      <version>3.8.1</version>\n      <scope>test</scope>\n    </dependency>\n  </dependencies>\n\n  <build>\n    <plugins>\n      <plugin>\n        <groupId>org.apache.maven.plugins</groupId>\n        <artifactId>maven-compiler-plugin</artifactId>\n        <version>3.3</version>\n        <configuration>\n          <verbose>true</verbose>\n          <source>${java.version}</source>\n          <target>${java.version}</target>\n          <encoding>${project.build.sourceEncoding}</encoding>\n        </configuration>\n      </plugin>\n      <plugin>\n        <groupId>org.apache.maven.plugins</groupId>\n        <artifactId>maven-jar-plugin</artifactId>\n        <version>2.6</version>\n        <configuration>\n          <archive>\n            <manifest>\n              <mainClass>com.example.gss.App</mainClass>\n              <addClasspath>true</addClasspath>\n              <addExtensions>false</addExtensions>\n              <classpathPrefix></classpathPrefix>\n            </manifest>\n          </archive>\n        </configuration>\n      </plugin>\n      <plugin>\n        <groupId>org.apache.maven.plugins</groupId>\n        <artifactId>maven-assembly-plugin</artifactId>\n        <version>2.5.5</version>\n        <configuration>\n          <descriptorRefs>\n            <descriptorRef>jar-with-dependencies</descriptorRef>\n          </descriptorRefs>\n        </configuration>\n        <executions>\n          <execution>\n            <id>make-assembly</id>\n            <phase>package</phase>\n            <goals>\n              <goal>single</goal>\n            </goals>\n          </execution>\n        </executions>\n      </plugin>\n      <plugin>\n        <groupId>org.codehaus.mojo</groupId>\n        <artifactId>versions-maven-plugin</artifactId>\n        <version>2.2</version>\n      </plugin>\n    </plugins>\n  </build>\n\n</project>\n\n\nresources\u30d5\u30a9\u30eb\u30c0\u306e\u4f5c\u6210\nsrc/main/resources\u30d5\u30a9\u30eb\u30c0\u3092\u4f5c\u6210\u3057\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306b\u53cd\u6620\u3055\u305b\u307e\u3059\u3002\n\n\"Build Path\" -> \"Configure Build Path\" -> \"Java Buld Path\" -> \"Source\"\u30bf\u30d6\u3092\u9078\u629e\u3059\u308b\u3002\n\"Add Folder\"\u30dc\u30bf\u30f3\u3092\u30af\u30ea\u30c3\u30af -> \u4f5c\u6210\u3057\u305f\"resources\"\u30d5\u30a9\u30eb\u30c0\u306b\u30c1\u30a7\u30c3\u30af\u3092\u5165\u308c\u308b\u3002\n\nP12\u30ad\u30fc\u30d5\u30a1\u30a4\u30eb\nGoogle Developers Console\u3067\u8a8d\u8a3c\u60c5\u5831\u3092\u8ffd\u52a0\u3057\u305f\u3068\u304d\u306b\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3057\u305fP12\u30ad\u30fc\u30d5\u30a1\u30a4\u30eb\u3092src/main/resources\u30d5\u30a9\u30eb\u30c0\u306b\u30b3\u30d4\u30fc\u3057\u307e\u3059\u3002\n\u30d3\u30eb\u30c9\n\u3053\u306e\u6642\u70b9\u3067\u52d5\u4f5c\u691c\u8a3c\u3092\u517c\u306d\u3066\u30d3\u30eb\u30c9\u3057\u307e\u3059\u3002\n\npackage\n> mvn package\n\n\n\u30d3\u30eb\u30c9\u304c\u6210\u529f\u3057\u305f\u3089\u751f\u6210\u3057\u305fjar\u30d5\u30a1\u30a4\u30eb\u3092\u5b9f\u884c\u3057\u307e\u3059\u3002\n\u30b3\u30de\u30f3\u30c9\u30d7\u30ed\u30f3\u30d7\u30c8\u306b\"Hello World!\"\u3068\u8868\u793a\u3055\u308c\u308c\u3070\u6210\u529f\u3067\u3059\u3002\n\njar\n> cd target\n> java -jar google-ss-example-1.0-SNAPSHOT.jar\nHello World!\n\n\n\n\u30d7\u30ed\u30b0\u30e9\u30e0\u306e\u5b9f\u88c5\n\u30b9\u30d7\u30ec\u30c3\u30c9\u30b7\u30fc\u30c8\u306e\u64cd\u4f5c\u65b9\u6cd5\u306fGoogle Sheets API\u3067\u8aac\u660e\u3055\u308c\u3066\u3044\u308b\u30b3\u30fc\u30c9\u3092\u53c2\u8003\u306b\u3057\u3066\u3044\u307e\u3059\u3002\n\n\u5b9a\u6570\n// \u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u540d (\u4efb\u610f)\nprivate static final String APPLICATION_NAME = \"spreadsheet-application-example\";\n\n// \u30a2\u30ab\u30a6\u30f3\u30c8\nprivate static final String ACCOUNT_P12_ID = \"<\u8ffd\u52a0\u3057\u305f\u30b5\u30fc\u30d3\u30b9\u30a2\u30ab\u30a6\u30f3\u30c8\u306e\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9>\";\nprivate static final File P12FILE = new File(\"src/main/resources/<P12\u30ad\u30fc\u30d5\u30a1\u30a4\u30eb\u540d>\");\n\n// \u8a8d\u8a3c\u30b9\u30b3\u30fc\u30d7\nprivate static final List<String> SCOPES = Arrays.asList(\n  \"https://docs.google.com/feeds\",\n  \"https://spreadsheets.google.com/feeds\");\n\n// Spreadsheet API URL\nprivate static final String SPREADSHEET_URL = \"https://spreadsheets.google.com/feeds/spreadsheets/private/full\";\n\nprivate static final URL SPREADSHEET_FEED_URL;\n\nstatic {\n  try {\n    SPREADSHEET_FEED_URL = new URL(SPREADSHEET_URL);\n  } catch (MalformedURLException e) {\n    throw new RuntimeException(e);\n  }\n}\n\n\nACCOUNT_P12_ID\u306b\u8a2d\u5b9a\u3059\u308b\u5024\n\n\u30b5\u30fc\u30d3\u30b9\u30a2\u30ab\u30a6\u30f3\u30c8\u3092\u767b\u9332\u3059\u308b\u3068\u30af\u30e9\u30a4\u30a2\u30f3\u30c8ID\u3068\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u304c\u767a\u884c\u3055\u308c\u307e\u3059\u304c\u3001\u30d7\u30ed\u30b0\u30e9\u30e0\u3067\u4f7f\u7528\u3059\u308b\u306e\u306f\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u306e\u307b\u3046\u3067\u3059\u3002\n\n\u8a8d\u8a3c\u51e6\u7406\n\nauthorize\nprivate static Credential authorize() throws Exception {\n  System.out.println(\"authorize in\");\n\n  HttpTransport httpTransport = GoogleNetHttpTransport.newTrustedTransport();\n  JsonFactory jsonFactory = new JacksonFactory();\n\n  GoogleCredential credential = new GoogleCredential.Builder()\n    .setTransport(httpTransport)\n    .setJsonFactory(jsonFactory)\n    .setServiceAccountId(ACCOUNT_P12_ID)\n    .setServiceAccountPrivateKeyFromP12File(P12FILE)\n    .setServiceAccountScopes(SCOPES)\n    .build();\n\n  boolean ret = credential.refreshToken();\n  // debug dump\n  System.out.println(\"refreshToken:\" + ret);\n\n  // debug dump\n  if (credential != null) {\n    System.out.println(\"AccessToken:\" + credential.getAccessToken());\n  }\n\n  System.out.println(\"authorize out\");\n\n  return credential;\n}\n\n\n\n\u30b5\u30fc\u30d3\u30b9\u306e\u53d6\u5f97\n\ngetService\nprivate static SpreadsheetService getService() throws Exception {\n  System.out.println(\"service in\");\n\n  SpreadsheetService service = new SpreadsheetService(APPLICATION_NAME);\n  service.setProtocolVersion(SpreadsheetService.Versions.V3);\n\n  Credential credential = authorize();\n  service.setOAuth2Credentials(credential);\n\n  // debug dump\n  System.out.println(\"Schema: \" + service.getSchema().toString());\n  System.out.println(\"Protocol: \" + service.getProtocolVersion().getVersionString());\n  System.out.println(\"ServiceVersion: \" + service.getServiceVersion());\n\n  System.out.println(\"service out\");\n\n  return service;\n}\n\n\n\n\u30b9\u30d7\u30ec\u30c3\u30c9\u30b7\u30fc\u30c8\u4e00\u89a7\n\u30a2\u30af\u30bb\u30b9\u304c\u8a31\u53ef\u3055\u308c\u3066\u3044\u308b\u30b9\u30d7\u30ec\u30c3\u30c9\u30b7\u30fc\u30c8\u306e\u4e00\u89a7\u3092\u53d6\u5f97\u3057\u307e\u3059\u3002\n\nfindAllSpreadsheets\nprivate static List<SpreadsheetEntry> findAllSpreadsheets(SpreadsheetService service) throws Exception {\n  System.out.println(\"findAllSpreadsheets in\");\n\n  SpreadsheetFeed feed = service.getFeed(SPREADSHEET_FEED_URL, SpreadsheetFeed.class);\n\n  List<SpreadsheetEntry> spreadsheets = feed.getEntries();\n\n  // debug dump\n  for (SpreadsheetEntry spreadsheet : spreadsheets) {\n    System.out.println(\"title: \" + spreadsheet.getTitle().getPlainText());\n  }\n\n  System.out.println(\"findAllSpreadsheets out\");\n  return spreadsheets;\n}\n\n\n\n\u30b9\u30d7\u30ec\u30c3\u30c9\u30b7\u30fc\u30c8\u540d\u3067\u691c\u7d22\n\u30b9\u30d7\u30ec\u30c3\u30c9\u30b7\u30fc\u30c8\u540d\u3092\u6307\u5b9a\u3057\u3066\u691c\u7d22\u3057\u307e\u3059\u3002\n\nfindSpreadsheetByName\nprivate static SpreadsheetEntry findSpreadsheetByName(SpreadsheetService service, String spreadsheetName) throws Exception {\n  System.out.println(\"findSpreadsheetByName in\");\n  SpreadsheetQuery sheetQuery = new SpreadsheetQuery(SPREADSHEET_FEED_URL);\n  sheetQuery.setTitleQuery(spreadsheetName);\n  SpreadsheetFeed feed = service.query(sheetQuery, SpreadsheetFeed.class);\n  SpreadsheetEntry ssEntry = null;\n  if (feed.getEntries().size() > 0) {\n    ssEntry = feed.getEntries().get(0);\n  }\n  System.out.println(\"findSpreadsheetByName out\");\n  return ssEntry;\n}\n\n\n\n\u30ef\u30fc\u30af\u30b7\u30fc\u30c8\u540d\u3067\u691c\u7d22\n\nfindWorksheetByName\nprivate static WorksheetEntry findWorksheetByName(SpreadsheetService service, SpreadsheetEntry ssEntry, String sheetName) throws Exception {\n  System.out.println(\"findWorksheetByName in\");\n  WorksheetQuery worksheetQuery = new WorksheetQuery(ssEntry.getWorksheetFeedUrl());\n  worksheetQuery.setTitleQuery(sheetName);\n  WorksheetFeed feed = service.query(worksheetQuery, WorksheetFeed.class);\n  WorksheetEntry wsEntry = null;\n  if (feed.getEntries().size() > 0){\n    wsEntry = feed.getEntries().get(0);\n  }\n  System.out.println(\"findWorksheetByName out\");\n  return wsEntry;\n}\n\n\n\n\u30ef\u30fc\u30af\u30b7\u30fc\u30c8\u3092\u8ffd\u52a0\n\naddWorksheet\nprivate static WorksheetEntry addWorksheet(SpreadsheetService service, SpreadsheetEntry ssEntry, String sheetName, int colNum, int rowNum) throws Exception {\n  System.out.println(\"addWorksheet in\");\n  WorksheetEntry wsEntry = new WorksheetEntry();\n  wsEntry.setTitle(new PlainTextConstruct(sheetName));\n  wsEntry.setColCount(colNum);\n  wsEntry.setRowCount(rowNum);\n  URL worksheetFeedURL = ssEntry.getWorksheetFeedUrl();\n  System.out.println(\"addWorksheet out\");\n  return service.insert(worksheetFeedURL, wsEntry);\n}\n\n\n\n\u30ef\u30fc\u30af\u30b7\u30fc\u30c8\u3092\u524a\u9664\n\ndeleteWorksheet\nprivate static void deleteWorksheet(WorksheetEntry wsEntry) throws Exception {\n  System.out.println(\"deleteWorksheet in\");\n  wsEntry.delete();\n  System.out.println(\"deleteWorksheet out\");\n}\n\n\n\n\u30ef\u30fc\u30af\u30b7\u30fc\u30c8\u306e\u30bf\u30a4\u30c8\u30eb\u884c\u3092\u8ffd\u52a0\n\u5f15\u6570\u306equery\u3067\u30bf\u30a4\u30c8\u30eb\u884c(1\u884c\u76ee)\u3092\u6307\u5b9a\u3057\u3001\u305d\u306e\u884c\u306e\u30bb\u30eb\u3078\u30bf\u30a4\u30c8\u30eb\u540d\u3092\u66f8\u304d\u8fbc\u307f\u307e\u3059\u3002\n\ninsertHeadRow\nprivate static void insertHeadRow(SpreadsheetService service, WorksheetEntry wsEntry, List<String> header, String query) throws Exception {\n  System.out.println(\"insertHeadRow in\");\n\n  URL cellFeedUrl = new URI(wsEntry.getCellFeedUrl().toString() + query).toURL();\n  CellFeed cellFeed = service.getFeed(cellFeedUrl, CellFeed.class);\n\n  for (int i=0; i<header.size(); i++) {\n    cellFeed.insert(new CellEntry(1, i+1, header.get(i)));\n  }\n\n  System.out.println(\"insertHeadRow out\");\n}\n\n\n\n\u30ef\u30fc\u30af\u30b7\u30fc\u30c8\u306b\u884c\u3092\u8ffd\u52a0\n\ninsertDataRow\nprivate static void insertDataRow(SpreadsheetService service, WorksheetEntry wsEntry, Map<String, Object> values) throws Exception {\n  System.out.println(\"insertDataRow in\");\n\n  ListEntry dataRow = new ListEntry();\n\n  values.forEach((title,value)->{\n    dataRow.getCustomElements().setValueLocal(title, value.toString());\n  });\n\n  URL listFeedUrl = wsEntry.getListFeedUrl();\n  service.insert(listFeedUrl, dataRow);\n\n  System.out.println(\"insertDataRow out\");\n}\n\n\n\n\u30ef\u30fc\u30af\u30b7\u30fc\u30c8\u306e\u884c\u3092\u66f4\u65b0\n\nupdateDataRow\nprivate static void updateDataRow(SpreadsheetService service, WorksheetEntry wsEntry, int rowNum, Map<String, Object> values) throws Exception {\n  System.out.println(\"updateDataRow in\");\n\n  URL listFeedUrl = wsEntry.getListFeedUrl();\n  ListFeed listFeed = service.getFeed(listFeedUrl, ListFeed.class);\n\n  ListEntry row = listFeed.getEntries().get(rowNum);\n\n  values.forEach((title,value)->{\n    row.getCustomElements().setValueLocal(title, value.toString());\n  });\n\n  row.update();\n\n  System.out.println(\"updateDataRow out\");\n}\n\n\n\n\u7bc4\u56f2\u6307\u5b9a\u30af\u30a8\u30ea\u30fc\n\u30af\u30a8\u30ea\u30fc\u30b9\u30c8\u30ea\u30f3\u30b0\u3067\u30bb\u30eb\u306e\u7bc4\u56f2\u6307\u5b9a\u3092\u884c\u3046\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\nmakeQuery\nprivate static String makeQuery(int minrow, int maxrow, int mincol, int maxcol) {\n  String base = \"?min-row=MINROW&max-row=MAXROW&min-col=MINCOL&max-col=MAXCOL\";\n  return base.replaceAll(\"MINROW\", String.valueOf(minrow))\n             .replaceAll(\"MAXROW\", String.valueOf(maxrow))\n             .replaceAll(\"MINCOL\", String.valueOf(mincol))\n             .replaceAll(\"MAXCOL\", String.valueOf(maxcol));\n}\n\n\n\n\u30e1\u30a4\u30f3\n\nApp.java\npackage com.example.gss;\n\nimport java.io.File;\nimport java.io.IOException;\nimport java.net.MalformedURLException;\nimport java.net.URI;\nimport java.net.URISyntaxException;\nimport java.net.URL;\nimport java.util.ArrayList;\nimport java.util.Arrays;\nimport java.util.HashMap;\nimport java.util.List;\nimport java.util.Map;\n\nimport com.google.api.client.auth.oauth2.Credential;\nimport com.google.api.client.googleapis.auth.oauth2.GoogleCredential;\nimport com.google.api.client.googleapis.javanet.GoogleNetHttpTransport;\nimport com.google.api.client.http.HttpTransport;\nimport com.google.api.client.json.JsonFactory;\nimport com.google.api.client.json.jackson2.JacksonFactory;\nimport com.google.gdata.client.spreadsheet.SpreadsheetQuery;\nimport com.google.gdata.client.spreadsheet.SpreadsheetService;\nimport com.google.gdata.client.spreadsheet.WorksheetQuery;\nimport com.google.gdata.data.PlainTextConstruct;\nimport com.google.gdata.data.spreadsheet.CellEntry;\nimport com.google.gdata.data.spreadsheet.CellFeed;\nimport com.google.gdata.data.spreadsheet.ListEntry;\nimport com.google.gdata.data.spreadsheet.ListFeed;\nimport com.google.gdata.data.spreadsheet.SpreadsheetEntry;\nimport com.google.gdata.data.spreadsheet.SpreadsheetFeed;\nimport com.google.gdata.data.spreadsheet.WorksheetEntry;\nimport com.google.gdata.data.spreadsheet.WorksheetFeed;\nimport com.google.gdata.util.ServiceException;\n\npublic class App {\n\n  public static void main(String[] args) throws Exception {\n    System.out.println(\"main start\");\n\n    SpreadsheetService service = getService();\n\n    findAllSpreadsheets(service);\n\n    String ssName = \"\u30c6\u30b9\u30c8\u30b9\u30d7\u30ec\u30c3\u30c9\u30b7\u30fc\u30c8\";\n\n    SpreadsheetEntry ssEntry = findSpreadsheetByName(service, ssName);\n\n    String wsName = \"\u30c6\u30b9\u30c8\u30b7\u30fc\u30c8\";\n\n    WorksheetEntry wsEntry = findWorksheetByName(service, ssEntry, wsName);\n    if (wsEntry != null) {\n      deleteWorksheet(wsEntry);\n    }\n\n    WorksheetEntry newWorksheet = addWorksheet(service, ssEntry, wsName, 50, 100);\n\n    // \u30ef\u30fc\u30af\u30b7\u30fc\u30c8\u306e\u30bf\u30a4\u30c8\u30eb\u540d\n    List<String> header = new ArrayList<>();\n    header.add(\"test1\");\n    header.add(\"test2\");\n    header.add(\"test3\");\n    header.add(\"test4\");\n    header.add(\"test5\");\n    header.add(\"test6\");\n\n    insertHeadRow(service, newWorksheet, header, makeQuery(1,1,1,5));\n\n    // debug dump\n    specCell(service, newWorksheet, makeQuery(1,1,1,5));\n\n\n    // insert\n    Map<String, Object> insertValues1 = new HashMap<>();\n    insertValues1.put(\"test1\", \"2015-09-01\");\n    insertValues1.put(\"test2\", 1200);\n    insertValues1.put(\"test3\", 1300);\n    insertValues1.put(\"test4\", 1400);\n    insertValues1.put(\"test5\", 1500);\n    insertValues1.put(\"test6\", 1600);\n\n    insertDataRow(service, newWorksheet, insertValues1);\n\n\n    // insert\n    Map<String, Object> insertValues2 = new HashMap<>();\n    insertValues2.put(\"test1\", \"2015-09-02\");\n    insertValues2.put(\"test2\", 2200);\n    insertValues2.put(\"test3\", 2300);\n    insertValues2.put(\"test4\", 2400);\n    insertValues2.put(\"test5\", 2500);\n    insertValues2.put(\"test6\", 2600);\n\n    insertDataRow(service, newWorksheet, insertValues2);\n\n\n    // update\n    Map<String, Object> updateValues = new HashMap<>();\n    updateValues.put(\"test1\", \"2015-09-01\");\n    updateValues.put(\"test2\", 1202);\n    updateValues.put(\"test3\", 1303);\n    updateValues.put(\"test4\", 1404);\n    updateValues.put(\"test5\", 1505);\n    updateValues.put(\"test6\", 1606);\n\n    updateDataRow(service, newWorksheet, 0, updateValues);\n\n    System.out.println(\"main end\");\n  }\n\n  ...\u4ed6\u306e\u51e6\u7406...\n\n}\n\n\n\u5b9f\u884c\u7d50\u679c\n\n\n\u30e1\u30e2\n\u5c11\u3057\u306f\u307e\u3063\u305f\u70b9\u306b\u3064\u3044\u3066\n\u30b9\u30d7\u30ec\u30c3\u30c9\u30b7\u30fc\u30c8\u304c\u898b\u3064\u304b\u3089\u306a\u3044\n\u30b5\u30fc\u30d3\u30b9\u30a2\u30ab\u30a6\u30f3\u30c8\u3092\u5171\u6709\u30e6\u30fc\u30b6\u30fc\u306b\u8ffd\u52a0\u3057\u306a\u3044\u3068\u53c2\u7167\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u305b\u3093\u3002\n\u884c\u306e\u8ffd\u52a0\u304c\u3067\u304d\u306a\u3044\n\u884c\u306e\u30bf\u30a4\u30c8\u30eb\u306b_(\u30a2\u30f3\u30c0\u30fc\u30b9\u30b3\u30a2)\u304c\u542b\u307e\u308c\u3066\u3044\u308b\u3068\u884c\u30c7\u30fc\u30bf\u3092\u8ffd\u52a0\u3001\u66f4\u65b0\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f\u3002\n# \u6982\u8981\n\nGoogle \u30b9\u30d7\u30ec\u30c3\u30c9\u30b7\u30fc\u30c8\u3092Java\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u304b\u3089\u64cd\u4f5c\u3059\u308b\u30b5\u30f3\u30d7\u30eb\u30d7\u30ed\u30b0\u30e9\u30e0\u3067\u3059\u3002\n\u60f3\u5b9a\u3059\u308b\u306e\u306f\u3001\u4f8b\u3048\u3070\u300c\u30d0\u30c3\u30c1\u30d7\u30ed\u30b0\u30e9\u30e0\u3067\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u304b\u3089\u96c6\u8a08\u3057\u305f\u30c7\u30fc\u30bf\u3092Google Sheets API\u3092\u4f7f\u7528\u3057\u3066Google \u30b9\u30d7\u30ec\u30c3\u30c9\u30b7\u30fc\u30c8\u3078\u66f4\u65b0\u3059\u308b\u300d\u306a\u3069\u3067\u3059\u3002\n\nGoogle\u306e\u8a8d\u8a3c\u65b9\u6cd5\u306b\u306fOAuth2\u3084\u30b5\u30fc\u30d3\u30b9\u30a2\u30ab\u30a6\u30f3\u30c8\u306a\u3069\u304c\u3042\u308a\u307e\u3059\u304c\u3001\u30d0\u30c3\u30c1\u51e6\u7406\u306a\u3069\u30e6\u30fc\u30b6\u30fc\u304c\u76f4\u63a5\u4ecb\u3055\u306a\u3044\u5834\u5408\u306e\u8a8d\u8a3c\u65b9\u6cd5\u306f\u30b5\u30fc\u30d3\u30b9\u30a2\u30ab\u30a6\u30f3\u30c8\u3092\u4f7f\u7528\u3059\u308b\u65b9\u304c\u826f\u3044\u3088\u3046\u3067\u3059\u3002\n\n**\u74b0\u5883**\n\n\u4e0b\u8a18\u306e\u74b0\u5883\u3067\u52d5\u4f5c\u78ba\u8a8d\u3092\u884c\u3044\u307e\u3057\u305f\u3002\n\n* Windows7 (64bit)\n* Java 1.8.0_60\n* [google-api-java-client] (https://github.com/google/google-api-java-client) 1.20.0\n* [gdata-java-client] (https://github.com/google/gdata-java-client) 1.47.1\n * JavaMail 1.4.5\n\n**\u53c2\u8003**\n\n\u4e0b\u8a18\u306e\u30b5\u30a4\u30c8\u3092\u53c2\u8003\u306b\u3055\u305b\u3066\u9802\u304d\u307e\u3057\u305f\u3002\n\n* [The Google Sheets API] (https://developers.google.com/google-apps/spreadsheets/)\n* [GData API\u3067Google\u30b9\u30d7\u30ec\u30c3\u30c9\u30b7\u30fc\u30c8\u3092\u53c2\u7167\u3059\u308b\u306b\u306f (1/3)] (http://www.atmarkit.co.jp/ait/articles/1001/15/news121.html)\n* [Google API \u7528\u306e\u30a2\u30af\u30bb\u30b9\u30c8\u30fc\u30af\u30f3\u3092\u30b5\u30fc\u30d3\u30b9\u30a2\u30ab\u30a6\u30f3\u30c8\u3067\u53d6\u5f97 - Google API Client Library for Java] (http://fits.hatenablog.com/entry/2015/06/08/223006)\n* [Google Spreadsheet with a service account] (http://stackoverflow.com/questions/31287911/google-spreadsheet-with-a-service-account)\n\n\n## \u4e8b\u524d\u6e96\u5099\n\n### API\u306e\u6709\u52b9\u5316\n\nDrive API\u3092\u6709\u52b9\u5316\u3057\u307e\u3059\u3002\n\n* [Google Developers Console] (https://console.developers.google.com/project)\u306b\u30a2\u30af\u30bb\u30b9\u3057\u307e\u3059\u3002\n* \u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092\u767b\u9332\u3057\u3066\u3044\u306a\u3044\u304b\u5c02\u7528\u306e\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092\u7528\u610f\u3057\u305f\u3044\u5834\u5408\u306f\u767b\u9332\u3057\u307e\u3059\u3002\n* \u5de6\u30e1\u30cb\u30e5\u30fc\u306e\"API\u3068\u8a8d\u8a3c\" -> \"API\"\u3092\u9078\u629e\u3057\u307e\u3059\u3002\n* API\u30e9\u30a4\u30d6\u30e9\u30ea\u306e\u4e00\u89a7\u304b\u3089 -> \"Google Apps API\" -> \"Drvie API\"\u3092\u6709\u52b9\u5316\u3057\u307e\u3059\u3002\n\n![ss02.png](https://qiita-image-store.s3.amazonaws.com/0/22772/a62017e4-bd3b-d39c-7720-78a95daa3da3.png)\n\n### \u8a8d\u8a3c\u60c5\u5831\u306e\u8ffd\u52a0\n\n\u30b5\u30fc\u30d3\u30b9\u30a2\u30ab\u30a6\u30f3\u30c8\u3092\u8ffd\u52a0\u3057\u307e\u3059\u3002\n\n* \u5de6\u30e1\u30cb\u30e5\u30fc\u306e\"API\u3068\u8a8d\u8a3c\" -> \"\u8a8d\u8a3c\u60c5\u5831\"\u3092\u9078\u629e\u3057\u307e\u3059\u3002\n* \"\u8a8d\u8a3c\u60c5\u5831\u3092\u8ffd\u52a0\"\u30dc\u30bf\u30f3\u3092\u30af\u30ea\u30c3\u30af\u3057\u307e\u3059\u3002\n* \u30e1\u30cb\u30e5\u30fc\u306e\"\u30b5\u30fc\u30d3\u30b9\u30a2\u30ab\u30a6\u30f3\u30c8\"\u3092\u9078\u629e\u3057\u307e\u3059\u3002\n* \u30ad\u30fc\u306e\u30bf\u30a4\u30d7\u306b\"P12\"\u3092\u9078\u629e\u3057\u307e\u3059\u3002\n\n![ss08.png](https://qiita-image-store.s3.amazonaws.com/0/22772/90fbd8ac-fa7e-2843-e707-a5e4281d6221.png)\n\n![ss09.png](https://qiita-image-store.s3.amazonaws.com/0/22772/8cc30352-d1b1-f41a-8c93-3a15fa01d0cb.png)\n\n\u30b5\u30fc\u30d3\u30b9\u30a2\u30ab\u30a6\u30f3\u30c8\u306e\u8ffd\u52a0\u304c\u6210\u529f\u3059\u308b\u3068\u3001\u30af\u30e9\u30a4\u30a2\u30f3\u30c8ID\u3001\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u3001\u8a3c\u660e\u66f8\u30d5\u30a3\u30f3\u30ac\u30fc\u30d7\u30ea\u30f3\u30c8\u304c\u767a\u884c\u3055\u308c\u3001P12\u30ad\u30fc\u30d5\u30a1\u30a4\u30eb\u306e\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u304c\u884c\u308f\u308c\u307e\u3059\u3002\n\n![ss10.png](https://qiita-image-store.s3.amazonaws.com/0/22772/fb9da1ae-3552-232e-3667-18e881d0c41d.png)\n\n\n### \u4f7f\u7528\u3059\u308b\u30e9\u30a4\u30d6\u30e9\u30ea\n\n#### google-api-java-client\n\nhttps://github.com/google/google-api-java-client\n\n```xml:dependency\n<dependency>\n  <groupId>com.google.api-client</groupId>\n  <artifactId>google-api-client</artifactId>\n  <version>1.20.0</version>\n</dependency>\n```\n\n#### gdata-java-client\n\nhttps://github.com/google/gdata-java-client\n\n```xml:dependency\n<dependency>\n  <groupId>com.google.gdata</groupId>\n  <artifactId>core</artifactId>\n  <version>1.47.1</version>\n  <exclusions>\n    <exclusion>\n      <groupId>com.google.code.findbugs</groupId>\n      <artifactId>jsr305</artifactId>\n    </exclusion>\n  </exclusions>\n</dependency>\n```\n\n### \u30c6\u30b9\u30c8\u3067\u4f7f\u7528\u3059\u308b\u30b9\u30d7\u30ec\u30c3\u30c9\u30b7\u30fc\u30c8\u3092\u4f5c\u6210\n\n\u30b9\u30d7\u30ec\u30c3\u30c9\u30b7\u30fc\u30c8\u540d: \u30c6\u30b9\u30c8\u30b9\u30d7\u30ec\u30c3\u30c9\u30b7\u30fc\u30c8\n\n![ss11.png](https://qiita-image-store.s3.amazonaws.com/0/22772/5d923b1d-e71a-a6f6-19dd-d041ba6e5d6d.png)\n\n\u4e0a\u8a18\u3067\u4f5c\u6210\u3057\u305f\u30b5\u30fc\u30d3\u30b9\u30a2\u30ab\u30a6\u30f3\u30c8\u3067\u3053\u306e\u30b9\u30d7\u30ec\u30c3\u30c9\u30b7\u30fc\u30c8\u306b\u66f8\u304d\u8fbc\u3081\u308b\u3088\u3046\u306b\u6a29\u9650\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n\u30b7\u30fc\u30c8\u53f3\u7aef\u306b\u3042\u308b\u5171\u6709\u30dc\u30bf\u30f3\u3092\u30af\u30ea\u30c3\u30af\u3057\u3001\u30b5\u30fc\u30d3\u30b9\u30a2\u30ab\u30a6\u30f3\u30c8\u306e\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u3092\u5165\u529b\u3057\u9001\u4fe1\u30dc\u30bf\u30f3\u3092\u30af\u30ea\u30c3\u30af\u3057\u307e\u3059\u3002\n\n![ss12.png](https://qiita-image-store.s3.amazonaws.com/0/22772/6d390174-693a-5256-4f06-47558e417988.png)\n\n\n## \u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u958b\u767a\n\n### \u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306e\u96db\u5f62\u3092\u751f\u6210\n\n\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u540d: google-ss-example\n\n**maven\u3067\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u96db\u5f62\u3092\u4f5c\u6210**\n\n```\n> mvn archetype:generate -DgroupId=com.example.gss -DartifactId=google-ss-example -DarchetypeArtifactId=maven-archetype-quickstart -DinteractiveMode=false\n```\n\n```\n> cd google-ss-example\n> mvn eclipse:eclipse\n```\n\n**eclipse\u306b\u30a4\u30f3\u30dd\u30fc\u30c8**\n\n* \u30e1\u30cb\u30e5\u30fc\u30d0\u30fc\u306e\"File\" -> \"Import...\" -> \"Maven\" -> \"Existing Maven Projects\"\u3092\u9078\u629e\u3057\u307e\u3059\u3002\n* \u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306e\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092\u9078\u629e\u3057\u3001\"Finish\"\u30dc\u30bf\u30f3\u3092\u30af\u30ea\u30c3\u30af\u3057\u307e\u3059\u3002\n\n**pom.xml\u306e\u7de8\u96c6**\n\n```xml:pom.xml\n<project xmlns=\"http://maven.apache.org/POM/4.0.0\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n  xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd\">\n  <modelVersion>4.0.0</modelVersion>\n  <groupId>com.example.gss</groupId>\n  <artifactId>google-ss-example</artifactId>\n  <packaging>jar</packaging>\n  <version>1.0-SNAPSHOT</version>\n  <name>google-ss-example</name>\n  <url>http://maven.apache.org</url>\n\n  <properties>\n    <java.version>1.8</java.version>\n    <project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>\n  </properties>\n\n  <dependencies>\n\n    <dependency>\n      <groupId>com.google.api-client</groupId>\n      <artifactId>google-api-client</artifactId>\n      <version>1.20.0</version>\n    </dependency>\n\n    <dependency>\n      <groupId>com.google.gdata</groupId>\n      <artifactId>core</artifactId>\n      <version>1.47.1</version>\n      <exclusions>\n        <exclusion>\n          <groupId>com.google.code.findbugs</groupId>\n          <artifactId>jsr305</artifactId>\n        </exclusion>\n      </exclusions>\n    </dependency>\n\n    <dependency>\n      <groupId>commons-collections</groupId>\n      <artifactId>commons-collections</artifactId>\n      <version>3.2.1</version>\n    </dependency>\n    <dependency>\n      <groupId>org.apache.commons</groupId>\n      <artifactId>commons-lang3</artifactId>\n      <version>3.4</version>\n    </dependency>\n\n    <dependency>\n      <groupId>org.slf4j</groupId>\n      <artifactId>slf4j-api</artifactId>\n      <version>1.7.12</version>\n    </dependency>\n    <dependency>\n      <groupId>ch.qos.logback</groupId>\n      <artifactId>logback-classic</artifactId>\n      <version>1.1.3</version>\n    </dependency>\n\n    <dependency>\n      <groupId>junit</groupId>\n      <artifactId>junit</artifactId>\n      <version>3.8.1</version>\n      <scope>test</scope>\n    </dependency>\n  </dependencies>\n\n  <build>\n    <plugins>\n      <plugin>\n        <groupId>org.apache.maven.plugins</groupId>\n        <artifactId>maven-compiler-plugin</artifactId>\n        <version>3.3</version>\n        <configuration>\n          <verbose>true</verbose>\n          <source>${java.version}</source>\n          <target>${java.version}</target>\n          <encoding>${project.build.sourceEncoding}</encoding>\n        </configuration>\n      </plugin>\n      <plugin>\n        <groupId>org.apache.maven.plugins</groupId>\n        <artifactId>maven-jar-plugin</artifactId>\n        <version>2.6</version>\n        <configuration>\n          <archive>\n            <manifest>\n              <mainClass>com.example.gss.App</mainClass>\n              <addClasspath>true</addClasspath>\n              <addExtensions>false</addExtensions>\n              <classpathPrefix></classpathPrefix>\n            </manifest>\n          </archive>\n        </configuration>\n      </plugin>\n      <plugin>\n        <groupId>org.apache.maven.plugins</groupId>\n        <artifactId>maven-assembly-plugin</artifactId>\n        <version>2.5.5</version>\n        <configuration>\n          <descriptorRefs>\n            <descriptorRef>jar-with-dependencies</descriptorRef>\n          </descriptorRefs>\n        </configuration>\n        <executions>\n          <execution>\n            <id>make-assembly</id>\n            <phase>package</phase>\n            <goals>\n              <goal>single</goal>\n            </goals>\n          </execution>\n        </executions>\n      </plugin>\n      <plugin>\n        <groupId>org.codehaus.mojo</groupId>\n        <artifactId>versions-maven-plugin</artifactId>\n        <version>2.2</version>\n      </plugin>\n    </plugins>\n  </build>\n\n</project>\n```\n\n**resources\u30d5\u30a9\u30eb\u30c0\u306e\u4f5c\u6210**\n\nsrc/main/resources\u30d5\u30a9\u30eb\u30c0\u3092\u4f5c\u6210\u3057\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306b\u53cd\u6620\u3055\u305b\u307e\u3059\u3002\n\n* \"Build Path\" -> \"Configure Build Path\" -> \"Java Buld Path\" -> \"Source\"\u30bf\u30d6\u3092\u9078\u629e\u3059\u308b\u3002\n* \"Add Folder\"\u30dc\u30bf\u30f3\u3092\u30af\u30ea\u30c3\u30af -> \u4f5c\u6210\u3057\u305f\"resources\"\u30d5\u30a9\u30eb\u30c0\u306b\u30c1\u30a7\u30c3\u30af\u3092\u5165\u308c\u308b\u3002\n\n**P12\u30ad\u30fc\u30d5\u30a1\u30a4\u30eb**\n\nGoogle Developers Console\u3067\u8a8d\u8a3c\u60c5\u5831\u3092\u8ffd\u52a0\u3057\u305f\u3068\u304d\u306b\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3057\u305fP12\u30ad\u30fc\u30d5\u30a1\u30a4\u30eb\u3092src/main/resources\u30d5\u30a9\u30eb\u30c0\u306b\u30b3\u30d4\u30fc\u3057\u307e\u3059\u3002\n\n**\u30d3\u30eb\u30c9**\n\n\u3053\u306e\u6642\u70b9\u3067\u52d5\u4f5c\u691c\u8a3c\u3092\u517c\u306d\u3066\u30d3\u30eb\u30c9\u3057\u307e\u3059\u3002\n\n```bat:package\n> mvn package\n```\n\n\u30d3\u30eb\u30c9\u304c\u6210\u529f\u3057\u305f\u3089\u751f\u6210\u3057\u305fjar\u30d5\u30a1\u30a4\u30eb\u3092\u5b9f\u884c\u3057\u307e\u3059\u3002\n\u30b3\u30de\u30f3\u30c9\u30d7\u30ed\u30f3\u30d7\u30c8\u306b\"Hello World!\"\u3068\u8868\u793a\u3055\u308c\u308c\u3070\u6210\u529f\u3067\u3059\u3002\n\n```bat:jar\n> cd target\n> java -jar google-ss-example-1.0-SNAPSHOT.jar\nHello World!\n```\n\n### \u30d7\u30ed\u30b0\u30e9\u30e0\u306e\u5b9f\u88c5\n\n\u30b9\u30d7\u30ec\u30c3\u30c9\u30b7\u30fc\u30c8\u306e\u64cd\u4f5c\u65b9\u6cd5\u306f[Google Sheets API] (https://developers.google.com/google-apps/spreadsheets/)\u3067\u8aac\u660e\u3055\u308c\u3066\u3044\u308b\u30b3\u30fc\u30c9\u3092\u53c2\u8003\u306b\u3057\u3066\u3044\u307e\u3059\u3002\n\n#### \u5b9a\u6570\n\n```java\n// \u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u540d (\u4efb\u610f)\nprivate static final String APPLICATION_NAME = \"spreadsheet-application-example\";\n\n// \u30a2\u30ab\u30a6\u30f3\u30c8\nprivate static final String ACCOUNT_P12_ID = \"<\u8ffd\u52a0\u3057\u305f\u30b5\u30fc\u30d3\u30b9\u30a2\u30ab\u30a6\u30f3\u30c8\u306e\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9>\";\nprivate static final File P12FILE = new File(\"src/main/resources/<P12\u30ad\u30fc\u30d5\u30a1\u30a4\u30eb\u540d>\");\n\n// \u8a8d\u8a3c\u30b9\u30b3\u30fc\u30d7\nprivate static final List<String> SCOPES = Arrays.asList(\n  \"https://docs.google.com/feeds\",\n  \"https://spreadsheets.google.com/feeds\");\n\n// Spreadsheet API URL\nprivate static final String SPREADSHEET_URL = \"https://spreadsheets.google.com/feeds/spreadsheets/private/full\";\n\nprivate static final URL SPREADSHEET_FEED_URL;\n\nstatic {\n  try {\n    SPREADSHEET_FEED_URL = new URL(SPREADSHEET_URL);\n  } catch (MalformedURLException e) {\n    throw new RuntimeException(e);\n  }\n}\n```\n\n* ACCOUNT_P12_ID\u306b\u8a2d\u5b9a\u3059\u308b\u5024\n\n\u30b5\u30fc\u30d3\u30b9\u30a2\u30ab\u30a6\u30f3\u30c8\u3092\u767b\u9332\u3059\u308b\u3068\u30af\u30e9\u30a4\u30a2\u30f3\u30c8ID\u3068\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u304c\u767a\u884c\u3055\u308c\u307e\u3059\u304c\u3001\u30d7\u30ed\u30b0\u30e9\u30e0\u3067\u4f7f\u7528\u3059\u308b\u306e\u306f\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u306e\u307b\u3046\u3067\u3059\u3002\n\n\n#### \u8a8d\u8a3c\u51e6\u7406\n\n```java:authorize\nprivate static Credential authorize() throws Exception {\n  System.out.println(\"authorize in\");\n\n  HttpTransport httpTransport = GoogleNetHttpTransport.newTrustedTransport();\n  JsonFactory jsonFactory = new JacksonFactory();\n\n  GoogleCredential credential = new GoogleCredential.Builder()\n    .setTransport(httpTransport)\n    .setJsonFactory(jsonFactory)\n    .setServiceAccountId(ACCOUNT_P12_ID)\n    .setServiceAccountPrivateKeyFromP12File(P12FILE)\n    .setServiceAccountScopes(SCOPES)\n    .build();\n\n  boolean ret = credential.refreshToken();\n  // debug dump\n  System.out.println(\"refreshToken:\" + ret);\n\n  // debug dump\n  if (credential != null) {\n    System.out.println(\"AccessToken:\" + credential.getAccessToken());\n  }\n\n  System.out.println(\"authorize out\");\n\n  return credential;\n}\n```\n\n#### \u30b5\u30fc\u30d3\u30b9\u306e\u53d6\u5f97\n\n```java:getService\nprivate static SpreadsheetService getService() throws Exception {\n  System.out.println(\"service in\");\n\n  SpreadsheetService service = new SpreadsheetService(APPLICATION_NAME);\n  service.setProtocolVersion(SpreadsheetService.Versions.V3);\n\n  Credential credential = authorize();\n  service.setOAuth2Credentials(credential);\n\n  // debug dump\n  System.out.println(\"Schema: \" + service.getSchema().toString());\n  System.out.println(\"Protocol: \" + service.getProtocolVersion().getVersionString());\n  System.out.println(\"ServiceVersion: \" + service.getServiceVersion());\n\n  System.out.println(\"service out\");\n\n  return service;\n}\n```\n\n#### \u30b9\u30d7\u30ec\u30c3\u30c9\u30b7\u30fc\u30c8\u4e00\u89a7\n\n\u30a2\u30af\u30bb\u30b9\u304c\u8a31\u53ef\u3055\u308c\u3066\u3044\u308b\u30b9\u30d7\u30ec\u30c3\u30c9\u30b7\u30fc\u30c8\u306e\u4e00\u89a7\u3092\u53d6\u5f97\u3057\u307e\u3059\u3002\n\n```java:findAllSpreadsheets\nprivate static List<SpreadsheetEntry> findAllSpreadsheets(SpreadsheetService service) throws Exception {\n  System.out.println(\"findAllSpreadsheets in\");\n\n  SpreadsheetFeed feed = service.getFeed(SPREADSHEET_FEED_URL, SpreadsheetFeed.class);\n\n  List<SpreadsheetEntry> spreadsheets = feed.getEntries();\n\n  // debug dump\n  for (SpreadsheetEntry spreadsheet : spreadsheets) {\n    System.out.println(\"title: \" + spreadsheet.getTitle().getPlainText());\n  }\n\n  System.out.println(\"findAllSpreadsheets out\");\n  return spreadsheets;\n}\n```\n\n#### \u30b9\u30d7\u30ec\u30c3\u30c9\u30b7\u30fc\u30c8\u540d\u3067\u691c\u7d22\n\n\u30b9\u30d7\u30ec\u30c3\u30c9\u30b7\u30fc\u30c8\u540d\u3092\u6307\u5b9a\u3057\u3066\u691c\u7d22\u3057\u307e\u3059\u3002\n\n```java:findSpreadsheetByName\nprivate static SpreadsheetEntry findSpreadsheetByName(SpreadsheetService service, String spreadsheetName) throws Exception {\n  System.out.println(\"findSpreadsheetByName in\");\n  SpreadsheetQuery sheetQuery = new SpreadsheetQuery(SPREADSHEET_FEED_URL);\n  sheetQuery.setTitleQuery(spreadsheetName);\n  SpreadsheetFeed feed = service.query(sheetQuery, SpreadsheetFeed.class);\n  SpreadsheetEntry ssEntry = null;\n  if (feed.getEntries().size() > 0) {\n    ssEntry = feed.getEntries().get(0);\n  }\n  System.out.println(\"findSpreadsheetByName out\");\n  return ssEntry;\n}\n```\n\n#### \u30ef\u30fc\u30af\u30b7\u30fc\u30c8\u540d\u3067\u691c\u7d22\n\n```java:findWorksheetByName\nprivate static WorksheetEntry findWorksheetByName(SpreadsheetService service, SpreadsheetEntry ssEntry, String sheetName) throws Exception {\n  System.out.println(\"findWorksheetByName in\");\n  WorksheetQuery worksheetQuery = new WorksheetQuery(ssEntry.getWorksheetFeedUrl());\n  worksheetQuery.setTitleQuery(sheetName);\n  WorksheetFeed feed = service.query(worksheetQuery, WorksheetFeed.class);\n  WorksheetEntry wsEntry = null;\n  if (feed.getEntries().size() > 0){\n    wsEntry = feed.getEntries().get(0);\n  }\n  System.out.println(\"findWorksheetByName out\");\n  return wsEntry;\n}\n```\n\n#### \u30ef\u30fc\u30af\u30b7\u30fc\u30c8\u3092\u8ffd\u52a0\n\n```java:addWorksheet\nprivate static WorksheetEntry addWorksheet(SpreadsheetService service, SpreadsheetEntry ssEntry, String sheetName, int colNum, int rowNum) throws Exception {\n  System.out.println(\"addWorksheet in\");\n  WorksheetEntry wsEntry = new WorksheetEntry();\n  wsEntry.setTitle(new PlainTextConstruct(sheetName));\n  wsEntry.setColCount(colNum);\n  wsEntry.setRowCount(rowNum);\n  URL worksheetFeedURL = ssEntry.getWorksheetFeedUrl();\n  System.out.println(\"addWorksheet out\");\n  return service.insert(worksheetFeedURL, wsEntry);\n}\n```\n\n#### \u30ef\u30fc\u30af\u30b7\u30fc\u30c8\u3092\u524a\u9664\n\n```java:deleteWorksheet\nprivate static void deleteWorksheet(WorksheetEntry wsEntry) throws Exception {\n  System.out.println(\"deleteWorksheet in\");\n  wsEntry.delete();\n  System.out.println(\"deleteWorksheet out\");\n}\n```\n\n#### \u30ef\u30fc\u30af\u30b7\u30fc\u30c8\u306e\u30bf\u30a4\u30c8\u30eb\u884c\u3092\u8ffd\u52a0\n\n\u5f15\u6570\u306equery\u3067\u30bf\u30a4\u30c8\u30eb\u884c(1\u884c\u76ee)\u3092\u6307\u5b9a\u3057\u3001\u305d\u306e\u884c\u306e\u30bb\u30eb\u3078\u30bf\u30a4\u30c8\u30eb\u540d\u3092\u66f8\u304d\u8fbc\u307f\u307e\u3059\u3002\n\n```java:insertHeadRow\nprivate static void insertHeadRow(SpreadsheetService service, WorksheetEntry wsEntry, List<String> header, String query) throws Exception {\n  System.out.println(\"insertHeadRow in\");\n\n  URL cellFeedUrl = new URI(wsEntry.getCellFeedUrl().toString() + query).toURL();\n  CellFeed cellFeed = service.getFeed(cellFeedUrl, CellFeed.class);\n\n  for (int i=0; i<header.size(); i++) {\n    cellFeed.insert(new CellEntry(1, i+1, header.get(i)));\n  }\n\n  System.out.println(\"insertHeadRow out\");\n}\n```\n\n#### \u30ef\u30fc\u30af\u30b7\u30fc\u30c8\u306b\u884c\u3092\u8ffd\u52a0\n\n```java:insertDataRow\nprivate static void insertDataRow(SpreadsheetService service, WorksheetEntry wsEntry, Map<String, Object> values) throws Exception {\n  System.out.println(\"insertDataRow in\");\n\n  ListEntry dataRow = new ListEntry();\n\n  values.forEach((title,value)->{\n    dataRow.getCustomElements().setValueLocal(title, value.toString());\n  });\n\n  URL listFeedUrl = wsEntry.getListFeedUrl();\n  service.insert(listFeedUrl, dataRow);\n\n  System.out.println(\"insertDataRow out\");\n}\n```\n\n#### \u30ef\u30fc\u30af\u30b7\u30fc\u30c8\u306e\u884c\u3092\u66f4\u65b0\n\n```java:updateDataRow\nprivate static void updateDataRow(SpreadsheetService service, WorksheetEntry wsEntry, int rowNum, Map<String, Object> values) throws Exception {\n  System.out.println(\"updateDataRow in\");\n\n  URL listFeedUrl = wsEntry.getListFeedUrl();\n  ListFeed listFeed = service.getFeed(listFeedUrl, ListFeed.class);\n\n  ListEntry row = listFeed.getEntries().get(rowNum);\n\n  values.forEach((title,value)->{\n    row.getCustomElements().setValueLocal(title, value.toString());\n  });\n\n  row.update();\n\n  System.out.println(\"updateDataRow out\");\n}\n```\n\n#### \u7bc4\u56f2\u6307\u5b9a\u30af\u30a8\u30ea\u30fc\n\n\u30af\u30a8\u30ea\u30fc\u30b9\u30c8\u30ea\u30f3\u30b0\u3067\u30bb\u30eb\u306e\u7bc4\u56f2\u6307\u5b9a\u3092\u884c\u3046\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n```java:makeQuery\nprivate static String makeQuery(int minrow, int maxrow, int mincol, int maxcol) {\n  String base = \"?min-row=MINROW&max-row=MAXROW&min-col=MINCOL&max-col=MAXCOL\";\n  return base.replaceAll(\"MINROW\", String.valueOf(minrow))\n             .replaceAll(\"MAXROW\", String.valueOf(maxrow))\n             .replaceAll(\"MINCOL\", String.valueOf(mincol))\n             .replaceAll(\"MAXCOL\", String.valueOf(maxcol));\n}\n```\n\n#### \u30e1\u30a4\u30f3\n\n```java:App.java\npackage com.example.gss;\n\nimport java.io.File;\nimport java.io.IOException;\nimport java.net.MalformedURLException;\nimport java.net.URI;\nimport java.net.URISyntaxException;\nimport java.net.URL;\nimport java.util.ArrayList;\nimport java.util.Arrays;\nimport java.util.HashMap;\nimport java.util.List;\nimport java.util.Map;\n\nimport com.google.api.client.auth.oauth2.Credential;\nimport com.google.api.client.googleapis.auth.oauth2.GoogleCredential;\nimport com.google.api.client.googleapis.javanet.GoogleNetHttpTransport;\nimport com.google.api.client.http.HttpTransport;\nimport com.google.api.client.json.JsonFactory;\nimport com.google.api.client.json.jackson2.JacksonFactory;\nimport com.google.gdata.client.spreadsheet.SpreadsheetQuery;\nimport com.google.gdata.client.spreadsheet.SpreadsheetService;\nimport com.google.gdata.client.spreadsheet.WorksheetQuery;\nimport com.google.gdata.data.PlainTextConstruct;\nimport com.google.gdata.data.spreadsheet.CellEntry;\nimport com.google.gdata.data.spreadsheet.CellFeed;\nimport com.google.gdata.data.spreadsheet.ListEntry;\nimport com.google.gdata.data.spreadsheet.ListFeed;\nimport com.google.gdata.data.spreadsheet.SpreadsheetEntry;\nimport com.google.gdata.data.spreadsheet.SpreadsheetFeed;\nimport com.google.gdata.data.spreadsheet.WorksheetEntry;\nimport com.google.gdata.data.spreadsheet.WorksheetFeed;\nimport com.google.gdata.util.ServiceException;\n\npublic class App {\n\n  public static void main(String[] args) throws Exception {\n    System.out.println(\"main start\");\n\n    SpreadsheetService service = getService();\n\n    findAllSpreadsheets(service);\n\n    String ssName = \"\u30c6\u30b9\u30c8\u30b9\u30d7\u30ec\u30c3\u30c9\u30b7\u30fc\u30c8\";\n\n    SpreadsheetEntry ssEntry = findSpreadsheetByName(service, ssName);\n\n    String wsName = \"\u30c6\u30b9\u30c8\u30b7\u30fc\u30c8\";\n\n    WorksheetEntry wsEntry = findWorksheetByName(service, ssEntry, wsName);\n    if (wsEntry != null) {\n      deleteWorksheet(wsEntry);\n    }\n\n    WorksheetEntry newWorksheet = addWorksheet(service, ssEntry, wsName, 50, 100);\n\n    // \u30ef\u30fc\u30af\u30b7\u30fc\u30c8\u306e\u30bf\u30a4\u30c8\u30eb\u540d\n    List<String> header = new ArrayList<>();\n    header.add(\"test1\");\n    header.add(\"test2\");\n    header.add(\"test3\");\n    header.add(\"test4\");\n    header.add(\"test5\");\n    header.add(\"test6\");\n\n    insertHeadRow(service, newWorksheet, header, makeQuery(1,1,1,5));\n\n    // debug dump\n    specCell(service, newWorksheet, makeQuery(1,1,1,5));\n\n\n    // insert\n    Map<String, Object> insertValues1 = new HashMap<>();\n    insertValues1.put(\"test1\", \"2015-09-01\");\n    insertValues1.put(\"test2\", 1200);\n    insertValues1.put(\"test3\", 1300);\n    insertValues1.put(\"test4\", 1400);\n    insertValues1.put(\"test5\", 1500);\n    insertValues1.put(\"test6\", 1600);\n\n    insertDataRow(service, newWorksheet, insertValues1);\n\n\n    // insert\n    Map<String, Object> insertValues2 = new HashMap<>();\n    insertValues2.put(\"test1\", \"2015-09-02\");\n    insertValues2.put(\"test2\", 2200);\n    insertValues2.put(\"test3\", 2300);\n    insertValues2.put(\"test4\", 2400);\n    insertValues2.put(\"test5\", 2500);\n    insertValues2.put(\"test6\", 2600);\n\n    insertDataRow(service, newWorksheet, insertValues2);\n\n\n    // update\n    Map<String, Object> updateValues = new HashMap<>();\n    updateValues.put(\"test1\", \"2015-09-01\");\n    updateValues.put(\"test2\", 1202);\n    updateValues.put(\"test3\", 1303);\n    updateValues.put(\"test4\", 1404);\n    updateValues.put(\"test5\", 1505);\n    updateValues.put(\"test6\", 1606);\n\n    updateDataRow(service, newWorksheet, 0, updateValues);\n\n    System.out.println(\"main end\");\n  }\n\n  ...\u4ed6\u306e\u51e6\u7406...\n\n}\n```\n\n**\u5b9f\u884c\u7d50\u679c**\n\n![ss13.png](https://qiita-image-store.s3.amazonaws.com/0/22772/66708900-b134-9a07-8cae-232e611890f1.png)\n\n\n### \u30e1\u30e2\n\n\u5c11\u3057\u306f\u307e\u3063\u305f\u70b9\u306b\u3064\u3044\u3066\n\n**\u30b9\u30d7\u30ec\u30c3\u30c9\u30b7\u30fc\u30c8\u304c\u898b\u3064\u304b\u3089\u306a\u3044**\n\n\u30b5\u30fc\u30d3\u30b9\u30a2\u30ab\u30a6\u30f3\u30c8\u3092\u5171\u6709\u30e6\u30fc\u30b6\u30fc\u306b\u8ffd\u52a0\u3057\u306a\u3044\u3068\u53c2\u7167\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u305b\u3093\u3002\n\n**\u884c\u306e\u8ffd\u52a0\u304c\u3067\u304d\u306a\u3044**\n\n\u884c\u306e\u30bf\u30a4\u30c8\u30eb\u306b_(\u30a2\u30f3\u30c0\u30fc\u30b9\u30b3\u30a2)\u304c\u542b\u307e\u308c\u3066\u3044\u308b\u3068\u884c\u30c7\u30fc\u30bf\u3092\u8ffd\u52a0\u3001\u66f4\u65b0\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f\u3002\n\n", "tags": ["GoogleSpreadSheet", "Java", "GoogleSheetsAPI"]}