{"tags": ["Hubot", "CoffeeScript"], "context": " More than 1 year has passed since last update.\n\n\u554f\u984c\nHubot 2.9.x \u6642\u4ee3\u306e\u6a19\u6e96\u7684\u306a\u6a29\u9650\u7ba1\u7406\u306b\u3064\u3044\u3066\u306e\u65e5\u672c\u8a9e\u30ea\u30bd\u30fc\u30b9\u304c\u5c11\u306a\u3044\u3002\n\n\u89e3\u6c7a\u7b56\n\u307c\u304f\u304c\u66f8\u304f\u3002\u899a\u3048\u66f8\u304d\u3092\u304b\u306d\u3066\u3002\n\u3053\u3053\u3067\u306f hubot-auth@1.1.2 \u306b\u3064\u3044\u3066\u8aac\u660e\u3059\u308b\u3002\n\ngithub/hubot-scripts \u306e auth.coffee\nhttps://github.com/github/hubot-scripts/blob/master/src/scripts/auth.coffee\ndeprecated\u3002\u5fd8\u308c\u308d\u3002\n\nhubot-auth\nhttps://github.com/hubot-scripts/hubot-auth\nHubot 2.9.x \u73fe\u5728\u3067\u3001\u6a19\u6e96\u7684\u306a\u6a29\u9650\u7ba1\u7406\u306e\u4ed5\u7d44\u307f\u3002\u4ee5\u4e0b\u306e\u6a5f\u80fd\u3092\u63d0\u4f9b\u3059\u308b\u3002\n\nHubot \u306e User \u5411\u3051\u306e Auth \u30af\u30e9\u30b9\u306e\u63d0\u4f9b\n\u305d\u308c\u3092\u64cd\u4f5c\u3059\u308b\u30b3\u30de\u30f3\u30c9\u306e\u63d0\u4f9b\n\n\n\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\u4e00\u822c\u7684\u306a Hubot \u30b9\u30af\u30ea\u30d7\u30c8\u3068\u540c\u69d8\u3002\nnpm install --save hubot-auth \u304b\u3089\u306e external-scripts.json \u3078\u306e\u8ffd\u8a18\u3002\n\n\u8a2d\u5b9a\nHUBOT_AUTH_ADMIN ... \u7ba1\u7406\u8005\u3092\u8a2d\u5b9a\u3059\u308b\u3002\u30ab\u30f3\u30de\u533a\u5207\u308a\u3067 user.id \u3092\u8a2d\u5b9a\u3059\u308b\u3002\u3053\u308c\u306f adapter \u4f9d\u5b58\u306e\u5024\u306a\u306e\u3067\u4e00\u6982\u306b\u306f\u8a00\u3048\u306a\u3044\u3002\n\n\u30b3\u30de\u30f3\u30c9\nhttps://github.com/hubot-scripts/hubot-auth/blob/v1.1.2/src/auth.coffee#L7-L12\n# Commands:\n# hubot <user> has <role> role - Assigns a role to a user\n# hubot <user> doesn't have <role> role - Removes a role from a user\n# hubot what roles does <user> have - Find out what roles a user has\n# hubot what roles do I have - Find out what roles you have\n# hubot who has <role> role - Find out who has the given role\n\n\nhubot <user> has <role> role - \u30ed\u30fc\u30eb\u3092\u30e6\u30fc\u30b6\u30fc\u306b\u5272\u308a\u5f53\u3066\u308b\u3002\u7ba1\u7406\u8005\u3057\u304b\u5b9f\u884c\u3067\u304d\u306a\u3044\u3002\nhubot <user> doesn't have <role> role - \u30ed\u30fc\u30eb\u3092\u30e6\u30fc\u30b6\u30fc\u304b\u3089\u53d6\u308a\u9664\u304f\u3002\u7ba1\u7406\u8005\u3057\u304b\u5b9f\u884c\u3067\u304d\u306a\u3044\u3002\nhubot what roles does <user> have - \u30e6\u30fc\u30b6\u30fc\u306b\u5272\u308a\u5f53\u3066\u3089\u308c\u305f\u30ed\u30fc\u30eb\u3092\u8fd4\u3059\u3002\nhubot what roles do I have - \u767a\u8a00\u8005\u81ea\u8eab\u306b\u5272\u308a\u5f53\u3066\u3089\u308c\u305f\u30ed\u30fc\u30eb\u3092\u8fd4\u3059\u3002\nhubot who has <role> role - \u30ed\u30fc\u30eb\u306e\u5272\u308a\u5f53\u3066\u3089\u308c\u305f\u30e6\u30fc\u30b6\u30fc\u3092\u8fd4\u3059\u3002\n\n\nAuth \u30af\u30e9\u30b9\nhttps://github.com/hubot-scripts/hubot-auth/blob/v1.1.2/src/auth.coffee#L38-L65\n  class Auth\n    isAdmin: (user) ->\n      user.id.toString() in admins\n\n    hasRole: (user, roles) ->\n      userRoles = @userRoles(user)\n      if userRoles?\n        roles = [roles] if typeof roles is 'string'\n        for role in roles\n          return true if role in userRoles\n      return false\n\n    usersWithRole: (role) ->\n      users = []\n      for own key, user of robot.brain.data.users\n        if @hasRole(user, role)\n          users.push(user.name)\n      users\n\n    userRoles: (user) ->\n      roles = []\n      if user? and robot.auth.isAdmin user\n        roles.push('admin')\n      if user.roles?\n        roles = roles.concat user.roles\n      roles\n\n  robot.auth = new Auth\n\n\n\u4ed6\u306e\u30b9\u30af\u30ea\u30d7\u30c8\u304b\u3089\u306e\u4f7f\u3044\u304b\u305f\nhttps://github.com/hubot-scripts/hubot-auth/blob/v1.1.2/src/auth.coffee#L15-L16\n#   * Call the method: robot.auth.hasRole(msg.envelope.user,'<role>')\n#   * returns bool true or false\n\nrobot.auth.hasRole(msg.envelope.user, '<role>') \u3067\u30ed\u30fc\u30eb\u306e\u6709\u7121\u3092\u30c1\u30a7\u30c3\u30af\u3067\u304d\u308b\u3002\n\n\u5177\u4f53\u4f8b\n\u7ba1\u7406\u8005\u306b\u306f 'Sir! Yes! Sir!' \u3092\u8fd4\u3057\u3001\ndeveloper \u30ed\u30fc\u30eb\u3092\u6301\u3063\u3066\u3044\u308b\u30e6\u30fc\u30b6\u30fc\u306b\u306f Hi. \u3092\u8fd4\u3057\u3001\n\u305d\u308c\u4ee5\u5916\u306b\u306f '???' \u3092\u8fd4\u3059\u4f8b\u3002\nmodule.exports = (robot) ->\n  robot.respond /hello/, (msg) ->\n    # \u6a29\u9650\u30c1\u30a7\u30c3\u30af\n    if robot.auth.isAdmin(msg.envelope.user)\n      msg.send 'Sir! Yes! Sir!'\n    else if robot.auth.hasRole(msg.envelope.user, 'developer')\n      msg.send 'Hi.'\n    else\n      msg.send '???'\n\n\n\u305d\u306e\u4ed6\u6ce8\u610f\u4e8b\u9805\n\n\u7ba1\u7406\u8005\u6a29\u9650\u306e\u66f8\u304d\u63db\u3048\u306f\u3067\u304d\u306a\u3044\u3002\u74b0\u5883\u5909\u6570\u306e\u307f\u3067\u8a2d\u5b9a\u3067\u304d\u308b\u3002\n\u8a2d\u5b9a\u3057\u305f\u6a29\u9650\u306f\u6c38\u7d9a\u5316\u3057\u3066\u3044\u306a\u3044\u3068\u518d\u8d77\u52d5\u306a\u3069\u3067\u6d88\u3048\u3066\u3057\u307e\u3046\u3002hubot-redis-brain \u306a\u3069\u306e brain \u7cfb\u30b9\u30af\u30ea\u30d7\u30c8\u3067\u3001\u6c38\u7d9a\u5316\u3057\u3066\u304a\u304f\u3053\u3068\u3002\n\n\n\u95a2\u9023 Qiita \u6295\u7a3f\n\n\nhttp://qiita.com/dtaniwaki/items/d89f7c1ed714f50497ed ... \u7c21\u6613\u306a\u6a29\u9650\u5b9f\u88c5\u3002\u7279\u5b9a\u30e6\u30fc\u30b6\u30fc\u3092\u5b8c\u5168\u306b\u7121\u8996\u3059\u308b\u3002\n\nhttp://qiita.com/cooldaemon/items/5b846423b788e037881a ... hubot-auth \u3067\u8db3\u308a\u306a\u3044\u4eba\u5411\u3051\u3002\n\n# \u554f\u984c\n\nHubot 2.9.x \u6642\u4ee3\u306e\u6a19\u6e96\u7684\u306a\u6a29\u9650\u7ba1\u7406\u306b\u3064\u3044\u3066\u306e\u65e5\u672c\u8a9e\u30ea\u30bd\u30fc\u30b9\u304c\u5c11\u306a\u3044\u3002\n\n# \u89e3\u6c7a\u7b56\n\n\u307c\u304f\u304c\u66f8\u304f\u3002\u899a\u3048\u66f8\u304d\u3092\u304b\u306d\u3066\u3002\n\n\u3053\u3053\u3067\u306f `hubot-auth@1.1.2` \u306b\u3064\u3044\u3066\u8aac\u660e\u3059\u308b\u3002\n\n## github/hubot-scripts \u306e auth.coffee\n\nhttps://github.com/github/hubot-scripts/blob/master/src/scripts/auth.coffee\n\ndeprecated\u3002\u5fd8\u308c\u308d\u3002\n\n## hubot-auth\n\nhttps://github.com/hubot-scripts/hubot-auth\n\nHubot 2.9.x \u73fe\u5728\u3067\u3001\u6a19\u6e96\u7684\u306a\u6a29\u9650\u7ba1\u7406\u306e\u4ed5\u7d44\u307f\u3002\u4ee5\u4e0b\u306e\u6a5f\u80fd\u3092\u63d0\u4f9b\u3059\u308b\u3002\n\n- Hubot \u306e User \u5411\u3051\u306e Auth \u30af\u30e9\u30b9\u306e\u63d0\u4f9b\n- \u305d\u308c\u3092\u64cd\u4f5c\u3059\u308b\u30b3\u30de\u30f3\u30c9\u306e\u63d0\u4f9b\n\n### \u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n\u4e00\u822c\u7684\u306a Hubot \u30b9\u30af\u30ea\u30d7\u30c8\u3068\u540c\u69d8\u3002\n\n`npm install --save hubot-auth` \u304b\u3089\u306e `external-scripts.json` \u3078\u306e\u8ffd\u8a18\u3002\n\n### \u8a2d\u5b9a\n\n`HUBOT_AUTH_ADMIN` ... \u7ba1\u7406\u8005\u3092\u8a2d\u5b9a\u3059\u308b\u3002\u30ab\u30f3\u30de\u533a\u5207\u308a\u3067 `user.id` \u3092\u8a2d\u5b9a\u3059\u308b\u3002\u3053\u308c\u306f adapter \u4f9d\u5b58\u306e\u5024\u306a\u306e\u3067\u4e00\u6982\u306b\u306f\u8a00\u3048\u306a\u3044\u3002\n\n### \u30b3\u30de\u30f3\u30c9\n\nhttps://github.com/hubot-scripts/hubot-auth/blob/v1.1.2/src/auth.coffee#L7-L12\n\n```coffeescript\n# Commands:\n# hubot <user> has <role> role - Assigns a role to a user\n# hubot <user> doesn't have <role> role - Removes a role from a user\n# hubot what roles does <user> have - Find out what roles a user has\n# hubot what roles do I have - Find out what roles you have\n# hubot who has <role> role - Find out who has the given role\n```\n\n- hubot \\<user> has \\<role> role - \u30ed\u30fc\u30eb\u3092\u30e6\u30fc\u30b6\u30fc\u306b\u5272\u308a\u5f53\u3066\u308b\u3002\u7ba1\u7406\u8005\u3057\u304b\u5b9f\u884c\u3067\u304d\u306a\u3044\u3002\n- hubot \\<user> doesn't have \\<role> role - \u30ed\u30fc\u30eb\u3092\u30e6\u30fc\u30b6\u30fc\u304b\u3089\u53d6\u308a\u9664\u304f\u3002\u7ba1\u7406\u8005\u3057\u304b\u5b9f\u884c\u3067\u304d\u306a\u3044\u3002\n- hubot what roles does \\<user> have - \u30e6\u30fc\u30b6\u30fc\u306b\u5272\u308a\u5f53\u3066\u3089\u308c\u305f\u30ed\u30fc\u30eb\u3092\u8fd4\u3059\u3002\n- hubot what roles do I have - \u767a\u8a00\u8005\u81ea\u8eab\u306b\u5272\u308a\u5f53\u3066\u3089\u308c\u305f\u30ed\u30fc\u30eb\u3092\u8fd4\u3059\u3002\n- hubot who has \\<role> role - \u30ed\u30fc\u30eb\u306e\u5272\u308a\u5f53\u3066\u3089\u308c\u305f\u30e6\u30fc\u30b6\u30fc\u3092\u8fd4\u3059\u3002\n\n### Auth \u30af\u30e9\u30b9\n\nhttps://github.com/hubot-scripts/hubot-auth/blob/v1.1.2/src/auth.coffee#L38-L65\n\n```coffeescript\n  class Auth\n    isAdmin: (user) ->\n      user.id.toString() in admins\n\n    hasRole: (user, roles) ->\n      userRoles = @userRoles(user)\n      if userRoles?\n        roles = [roles] if typeof roles is 'string'\n        for role in roles\n          return true if role in userRoles\n      return false\n\n    usersWithRole: (role) ->\n      users = []\n      for own key, user of robot.brain.data.users\n        if @hasRole(user, role)\n          users.push(user.name)\n      users\n\n    userRoles: (user) ->\n      roles = []\n      if user? and robot.auth.isAdmin user\n        roles.push('admin')\n      if user.roles?\n        roles = roles.concat user.roles\n      roles\n\n  robot.auth = new Auth\n```\n\n### \u4ed6\u306e\u30b9\u30af\u30ea\u30d7\u30c8\u304b\u3089\u306e\u4f7f\u3044\u304b\u305f\n\nhttps://github.com/hubot-scripts/hubot-auth/blob/v1.1.2/src/auth.coffee#L15-L16\n\n```coffeescript\n#   * Call the method: robot.auth.hasRole(msg.envelope.user,'<role>')\n#   * returns bool true or false\n```\n\n`robot.auth.hasRole(msg.envelope.user, '<role>')` \u3067\u30ed\u30fc\u30eb\u306e\u6709\u7121\u3092\u30c1\u30a7\u30c3\u30af\u3067\u304d\u308b\u3002\n\n### \u5177\u4f53\u4f8b\n\n\u7ba1\u7406\u8005\u306b\u306f `'Sir! Yes! Sir!'` \u3092\u8fd4\u3057\u3001\n`developer` \u30ed\u30fc\u30eb\u3092\u6301\u3063\u3066\u3044\u308b\u30e6\u30fc\u30b6\u30fc\u306b\u306f `Hi.` \u3092\u8fd4\u3057\u3001\n\u305d\u308c\u4ee5\u5916\u306b\u306f `'???'` \u3092\u8fd4\u3059\u4f8b\u3002\n\n```coffeescript\nmodule.exports = (robot) ->\n  robot.respond /hello/, (msg) ->\n    # \u6a29\u9650\u30c1\u30a7\u30c3\u30af\n    if robot.auth.isAdmin(msg.envelope.user)\n      msg.send 'Sir! Yes! Sir!'\n    else if robot.auth.hasRole(msg.envelope.user, 'developer')\n      msg.send 'Hi.'\n    else\n      msg.send '???'\n```\n\n# \u305d\u306e\u4ed6\u6ce8\u610f\u4e8b\u9805\n\n- \u7ba1\u7406\u8005\u6a29\u9650\u306e\u66f8\u304d\u63db\u3048\u306f\u3067\u304d\u306a\u3044\u3002\u74b0\u5883\u5909\u6570\u306e\u307f\u3067\u8a2d\u5b9a\u3067\u304d\u308b\u3002\n- \u8a2d\u5b9a\u3057\u305f\u6a29\u9650\u306f\u6c38\u7d9a\u5316\u3057\u3066\u3044\u306a\u3044\u3068\u518d\u8d77\u52d5\u306a\u3069\u3067\u6d88\u3048\u3066\u3057\u307e\u3046\u3002hubot-redis-brain \u306a\u3069\u306e brain \u7cfb\u30b9\u30af\u30ea\u30d7\u30c8\u3067\u3001\u6c38\u7d9a\u5316\u3057\u3066\u304a\u304f\u3053\u3068\u3002\n\n# \u95a2\u9023 Qiita \u6295\u7a3f\n\n- http://qiita.com/dtaniwaki/items/d89f7c1ed714f50497ed ... \u7c21\u6613\u306a\u6a29\u9650\u5b9f\u88c5\u3002\u7279\u5b9a\u30e6\u30fc\u30b6\u30fc\u3092\u5b8c\u5168\u306b\u7121\u8996\u3059\u308b\u3002\n- http://qiita.com/cooldaemon/items/5b846423b788e037881a ... hubot-auth \u3067\u8db3\u308a\u306a\u3044\u4eba\u5411\u3051\u3002\n"}