{"tags": ["awk", "Bash"], "context": " More than 1 year has passed since last update.\u305f\u307e\u306b\u4f7f\u3046\u3051\u3069\u5fd8\u308c\u304c\u3061\u306a\u30ef\u30f3\u30e9\u30a4\u30ca\u30fc\u3092\u30e1\u30e2\u4ee3\u308f\u308a\u306b\u6b8b\u3057\u3066\u304a\u304f\u3002\n\u968f\u6642\u66f4\u65b0\u3002\n[\u5b9f\u884c\u74b0\u5883]\n\u30fbLinux\n\u30fbbash\n\u30fbawk\n\n\u5727\u7e2e\u3055\u308c\u305f\u30ed\u30b0\u306e\u5408\u8a08\u30b5\u30a4\u30ba\u3092\u51fa\u529b\u3059\u308b\n$ du -s ./access_log-*.gz | awk '{total+=$1} END {print total}'\n\n\n\u30ed\u30b0\u306e\u7279\u5b9a\u30ab\u30e9\u30e0\u306e\u6841\u6570TOP10\u3092\u51fa\u3059\n\u30ed\u30b0\u3092RDB\u306e\u30c6\u30fc\u30d6\u30eb\u306b\u7a81\u3063\u8fbc\u307f\u305f\u3044\u3051\u3069\u6841\u6570\u304c\u8aad\u3081\u306a\u3044\u3001\u3068\u3044\u3046\u5834\u5408\u306b\u4fbf\u5229\n# 5\u756a\u76ee\u306e\u30ab\u30e9\u30e0\u306e\u6841\u6570\u304c\u77e5\u308a\u305f\u3044\u5834\u5408(\u30d5\u30a1\u30a4\u30eb\u306f\u7a7a\u767dor\u30bf\u30d6\u533a\u5207\u308a\u306e\u524d\u63d0)\n$ cat access_log | awk '{len=length($5);print len}' | sort -nr | head -10\n\n\nMySQL\u306e\u30bb\u30c3\u30b7\u30e7\u30f3\u306e\u30b3\u30de\u30f3\u30c9\u5225\u4ef6\u6570\uff08Query,Sleep\u306a\u3069\uff09\u3092\u77e5\u308b\nQuery\u306fState\u306b\u3088\u3063\u3066\u72b6\u614b\u304c\u5927\u304d\u304f\u9055\u3046\u306e\u3067\u3001\u5225\u3005\u306b\u96c6\u8a08\u3059\u308b\u3002\n$ mysql -uroot -p -B -N -e 'show processlist' | awk -F \"\\t\" '{if($5==\"Query\") {print \"Query:\"$7} else {print $5}}'| sort | uniq -c\n\n\u305f\u307e\u306b\u4f7f\u3046\u3051\u3069\u5fd8\u308c\u304c\u3061\u306a\u30ef\u30f3\u30e9\u30a4\u30ca\u30fc\u3092\u30e1\u30e2\u4ee3\u308f\u308a\u306b\u6b8b\u3057\u3066\u304a\u304f\u3002\n\u968f\u6642\u66f4\u65b0\u3002\n\n[\u5b9f\u884c\u74b0\u5883]\n\u30fbLinux\n\u30fbbash\n\u30fbawk\n\n## \u5727\u7e2e\u3055\u308c\u305f\u30ed\u30b0\u306e\u5408\u8a08\u30b5\u30a4\u30ba\u3092\u51fa\u529b\u3059\u308b\n\n```bash\n$ du -s ./access_log-*.gz | awk '{total+=$1} END {print total}'\n```\n\n## \u30ed\u30b0\u306e\u7279\u5b9a\u30ab\u30e9\u30e0\u306e\u6841\u6570TOP10\u3092\u51fa\u3059\n\n\u30ed\u30b0\u3092RDB\u306e\u30c6\u30fc\u30d6\u30eb\u306b\u7a81\u3063\u8fbc\u307f\u305f\u3044\u3051\u3069\u6841\u6570\u304c\u8aad\u3081\u306a\u3044\u3001\u3068\u3044\u3046\u5834\u5408\u306b\u4fbf\u5229\n\n```bash\n# 5\u756a\u76ee\u306e\u30ab\u30e9\u30e0\u306e\u6841\u6570\u304c\u77e5\u308a\u305f\u3044\u5834\u5408(\u30d5\u30a1\u30a4\u30eb\u306f\u7a7a\u767dor\u30bf\u30d6\u533a\u5207\u308a\u306e\u524d\u63d0)\n$ cat access_log | awk '{len=length($5);print len}' | sort -nr | head -10\n```\n\n## MySQL\u306e\u30bb\u30c3\u30b7\u30e7\u30f3\u306e\u30b3\u30de\u30f3\u30c9\u5225\u4ef6\u6570\uff08Query,Sleep\u306a\u3069\uff09\u3092\u77e5\u308b\n\nQuery\u306fState\u306b\u3088\u3063\u3066\u72b6\u614b\u304c\u5927\u304d\u304f\u9055\u3046\u306e\u3067\u3001\u5225\u3005\u306b\u96c6\u8a08\u3059\u308b\u3002\n\n```bash\n$ mysql -uroot -p -B -N -e 'show processlist' | awk -F \"\\t\" '{if($5==\"Query\") {print \"Query:\"$7} else {print $5}}'| sort | uniq -c\n```\n\n"}