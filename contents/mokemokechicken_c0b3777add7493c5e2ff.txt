{"context": "\n\n\u306f\u3058\u3081\u306b\nBigQuery\u3092\u4f7f\u3063\u3066\u3044\u3066\u3001\u3057\u3070\u3057\u3070\u66f8\u304d\u65b9\u3092\u5fd8\u308c\u305f\u308a\u3059\u308b\u3082\u306e\u3092\u30e1\u30e2\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n\n\u5185\u5bb9\n\n\u65e5\u4ed8\u30fb\u6642\u9593\u95a2\u9023\n\nunixtimestamp \u3068 TIMESTAMP\u578b \u306e\u5909\u63db\nTIMESTAMP\u578b\u306f\u300c\u6642\u523b\u300d\u7684\u306a\u30c7\u30fc\u30bf\u306a\u306e\u3067 unixtimestamp \u3068\u666e\u901a\u306b\u5bfe\u5fdc\u3057\u307e\u3059\u3002\n\nunixtime -> TIMESTAMP:  TIMESTAMP_SECONDS(unixtime)\n\nTIMESTAMP -> unixtime: UNIX_SECONDS(TIMESTAMP \"2016-11-18 00:00:00+09\")\n\n\n\u6587\u5b57\u5217\u304b\u3089TIMESTAMP\u578b\u306b\u306f\u666e\u901a\u306bCAST\u3067\u304d\u308b\u3002TimeZone\u306f\u7701\u7565\u3059\u308b\u3068+00\u306b\u306a\u308a\u307e\u3059\u3002\nSELECT\n  TIMESTAMP \"2016-11-18 00:00:00\" as utc,\n  TIMESTAMP \"2016-11-18 00:00:00+09\" as jst\n\n\n\n\nutc\njst\n\n\n\n\n2016-11-18 00:00:00 UTC\n2016-11-17 15:00:00 UTC\n\n\n\n\nTIMESTAMP\u578b \u3068 DATETIME\u578b \u306e\u5909\u63db(DATE\u578b\u3082\u307b\u307c\u540c\u3058)\nDATETIME \u3068 TIMESTAMP \u306f\u666e\u901a\u306bCAST\u3067\u304d\u307e\u3059\u3002\n\nTIMESTAMP -> DATETIME: DATETIME(TIMESTAMP \"2016-11-18 00:00:00+09\", 'Asia/Tokyo')\n\nDATETIME -> TIMESTAMP: TIMESTAMP(DATETIME(TIMESTAMP \"2016-11-18 00:00:00+09\", 'Asia/Tokyo'))\n\n\nDATETIME\u578b\u306e\u5834\u5408\u300c\u66a6\u300d\u7684\u306a\u578b\u306a\u306e\u3067\u3001\u3042\u308bTimeZone\u306b\u5909\u63db\u3057\u305f\u3042\u3068\u306f\u3001TimeZone\u60c5\u5831\u81ea\u4f53\u306f\u5931\u308f\u308c\u307e\u3059\uff08\u305f\u3076\u3093\uff09\u3002\n\u306a\u306e\u3067\u3001 TIMESTAMP->DATETIME->TIMESTAMP \u306bCAST\u3059\u308b\u3068\u3001\u6642\u523b\u304c\u5909\u308f\u3063\u3066\u3057\u307e\u3063\u3066\u3044\u308b\u5834\u5408\u304c\u3042\u308b\u306e\u3067\u6ce8\u610f\u304c\u5fc5\u8981\u3067\u3059(\uff13\u3064\u76ee\u306e\u30b1\u30fc\u30b9)\u3002\nSELECT\n  TIMESTAMP \"2016-11-18 00:00:00+09\",\n  DATETIME(TIMESTAMP \"2016-11-18 00:00:00+09\", 'Asia/Tokyo'),\n  TIMESTAMP(DATETIME(TIMESTAMP \"2016-11-18 00:00:00+09\", 'Asia/Tokyo'))\n\n\n\n\nf0_\nf1_\nf2_\n\n\n\n\n2016-11-17 15:00:00 UTC\n2016-11-18T00:00:00\n2016-11-18 00:00:00 UTC\n\n\n\n\nDATETIME\u578b\u306f\u300c\u65e5\u300d\u300c\u6708\u300d\u306a\u3069\u306b\u4e38\u3081\u308b\u3053\u3068\u304c\u3067\u304d\u308b(DATE\u578b\u3082\u307b\u307c\u540c\u3058)\nDATETIME\u578b\u306f\u300c\u66a6\u300d\u7684\u306a\u306e\u3067\u3001DATETIME_TRUNC()\u95a2\u6570\u3092\u4f7f\u3046\u3068\u300c\u65e5\u300d\u3084\u300c\u6708\u300d\u3068\u3044\u3046\u5358\u4f4d\u306bTruncate\u3067\u304d\u307e\u3059\u3002\nTimezone\u3092\u8003\u616e\u3057\u305f\u65e5\u5358\u4f4d\u3084\u6708\u5358\u4f4d\u306b\u30b0\u30eb\u30fc\u30d4\u30f3\u30b0\u3059\u308b\u3068\u304d\u306b\u4fbf\u5229\u3067\u3059\u3002\nSELECT\n  DATETIME_TRUNC(DATETIME(TIMESTAMP \"2016-11-18 00:00:00+09\", 'Asia/Tokyo'), DAY) as day,\n  DATETIME_TRUNC(DATETIME(TIMESTAMP \"2016-11-18 00:00:00+09\", 'Asia/Tokyo'), MONTH) as month,\n  DATETIME_TRUNC(DATETIME(TIMESTAMP \"2016-11-18 00:00:00+09\", 'Asia/Tokyo'), YEAR) as year\n\n\n\n\nday\nmonth\nyear\n\n\n\n\n2016-11-18T00:00:00\n2016-11-01T00:00:00\n2016-01-01T00:00:00\n\n\n\n\nDATETIME\u578b\u306f\u300c\uff11\u30f6\u6708\u5f8c\u300d\u306a\u3069\u306e\u8a08\u7b97\u304c\u3067\u304d\u308b(DATE\u578b\u3082\u307b\u307c\u540c\u3058)\nSELECT\n  DATETIME_ADD(DATETIME '2015-12-01', INTERVAL 30 DAY) as day30,\n  DATETIME_ADD(DATETIME '2015-12-01', INTERVAL 1 MONTH) as month\n\n\n\n\nday30\nmonth\n\n\n\n\n2015-12-31T00:00:00\n2016-01-01T00:00:00\n\n\n\n\nJSON\u6587\u5b57\u5217\u306eParse\nJSON\u6587\u5b57\u5217\u304b\u3089\u53d6\u308a\u51fa\u3059\u540d\u524d\u3084\u578b\u3092\u660e\u793a\u3059\u308b\u5fc5\u8981\u306f\u3042\u308a\u307e\u3059\u304c\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u3059\u308c\u3070\u53ef\u80fd\u3067\u3059\u3002\nCREATE TEMPORARY FUNCTION parse_json(json_str STRING) \nRETURNS STRUCT<name STRING, birthday STRING, mail STRING> \nLANGUAGE js AS \"\"\"\n  return JSON.parse(json_str);\n\"\"\";\n\nSELECT parse_json('{\"name\": \"hogehoge\", \"birthday\": \"2000-01-01\", \"pref\": 31}') as user\n\n\n\n\nRow\nuser.name\nuser.birthday\nuser.mail\n\n\n\n\n1\nhogehoge\n2000-01-01\nnull\n\n\n\n<> \u3067\u6307\u5b9a\u3057\u306a\u304b\u3063\u305f\u5217 pref \u306f\u51fa\u529b\u3055\u308c\u307e\u305b\u3093\u3057\u3001\u30ad\u30fc\u304c\u7121\u304b\u3063\u305fmail\u306fnull\u306b\u306a\u308a\u307e\u3059\u3002\n\n\u6b63\u898f\u8868\u73fe\n\u6b63\u898f\u8868\u73fe\u3092\u4f7f\u3063\u3066\u6587\u5b57\u5217\u304b\u3089\u3001\u30de\u30c3\u30c1\u3057\u305f\u90e8\u5206\u3092\u62bd\u51fa\u3057\u305f\u308a\u3001\u30de\u30c3\u30c1\u3059\u308b\u304b\u3092\u5224\u5b9a\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\nSELECT \n  REGEXP_EXTRACT(\"hogehoge@gmail.com\", r'^([^@]+)@'),\n  REGEXP_CONTAINS(\"hogehoge@gmail.com\", r'@gmail\\.com$')\n\n\n\n\nf0_\nf1_\n\n\n\n\nhogehoge\ntrue\n\n\n\n\n\u3055\u3044\u3054\u306b\n\u3053\u308c\u3067\u6bce\u56de\u904e\u53bb\u306e\u5c65\u6b74\u3092\u635c\u7d22\u3057\u306a\u304f\u3066\u6e08\u3080\u304b\u306a\u3002\u3002\u3002\n\u306f\u3058\u3081\u306b\n========\n\nBigQuery\u3092\u4f7f\u3063\u3066\u3044\u3066\u3001\u3057\u3070\u3057\u3070\u66f8\u304d\u65b9\u3092\u5fd8\u308c\u305f\u308a\u3059\u308b\u3082\u306e\u3092\u30e1\u30e2\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n\n\u5185\u5bb9\n======\n\n\u65e5\u4ed8\u30fb\u6642\u9593\u95a2\u9023\n--------\n### unixtimestamp \u3068 TIMESTAMP\u578b \u306e\u5909\u63db\nTIMESTAMP\u578b\u306f\u300c\u6642\u523b\u300d\u7684\u306a\u30c7\u30fc\u30bf\u306a\u306e\u3067 unixtimestamp \u3068\u666e\u901a\u306b\u5bfe\u5fdc\u3057\u307e\u3059\u3002\n\n* unixtime -> TIMESTAMP:  `TIMESTAMP_SECONDS(unixtime)`\n* TIMESTAMP -> unixtime: `UNIX_SECONDS(TIMESTAMP \"2016-11-18 00:00:00+09\")`\n\n\n\u6587\u5b57\u5217\u304b\u3089TIMESTAMP\u578b\u306b\u306f\u666e\u901a\u306bCAST\u3067\u304d\u308b\u3002TimeZone\u306f\u7701\u7565\u3059\u308b\u3068`+00`\u306b\u306a\u308a\u307e\u3059\u3002\n\n```sql\nSELECT\n  TIMESTAMP \"2016-11-18 00:00:00\" as utc,\n  TIMESTAMP \"2016-11-18 00:00:00+09\" as jst\n```\n\n|utc|jst|\n|---|---|\n|2016-11-18 00:00:00 UTC|2016-11-17 15:00:00 UTC|\n\n\n### TIMESTAMP\u578b \u3068 DATETIME\u578b \u306e\u5909\u63db(DATE\u578b\u3082\u307b\u307c\u540c\u3058)\nDATETIME \u3068 TIMESTAMP \u306f\u666e\u901a\u306bCAST\u3067\u304d\u307e\u3059\u3002\n\n* TIMESTAMP -> DATETIME: `DATETIME(TIMESTAMP \"2016-11-18 00:00:00+09\", 'Asia/Tokyo')`\n* DATETIME -> TIMESTAMP: `TIMESTAMP(DATETIME(TIMESTAMP \"2016-11-18 00:00:00+09\", 'Asia/Tokyo'))`\n\nDATETIME\u578b\u306e\u5834\u5408\u300c\u66a6\u300d\u7684\u306a\u578b\u306a\u306e\u3067\u3001\u3042\u308bTimeZone\u306b\u5909\u63db\u3057\u305f\u3042\u3068\u306f\u3001TimeZone\u60c5\u5831\u81ea\u4f53\u306f\u5931\u308f\u308c\u307e\u3059\uff08\u305f\u3076\u3093\uff09\u3002\n\u306a\u306e\u3067\u3001 TIMESTAMP->DATETIME->TIMESTAMP \u306bCAST\u3059\u308b\u3068\u3001\u6642\u523b\u304c\u5909\u308f\u3063\u3066\u3057\u307e\u3063\u3066\u3044\u308b\u5834\u5408\u304c\u3042\u308b\u306e\u3067\u6ce8\u610f\u304c\u5fc5\u8981\u3067\u3059(\uff13\u3064\u76ee\u306e\u30b1\u30fc\u30b9)\u3002\n\n\n```sql\nSELECT\n  TIMESTAMP \"2016-11-18 00:00:00+09\",\n  DATETIME(TIMESTAMP \"2016-11-18 00:00:00+09\", 'Asia/Tokyo'),\n  TIMESTAMP(DATETIME(TIMESTAMP \"2016-11-18 00:00:00+09\", 'Asia/Tokyo'))\n```\n\n|f0_|f1_|f2_|\n|---|---|---|\n|2016-11-17 15:00:00 UTC|2016-11-18T00:00:00|2016-11-18 00:00:00 UTC|\n\n### DATETIME\u578b\u306f\u300c\u65e5\u300d\u300c\u6708\u300d\u306a\u3069\u306b\u4e38\u3081\u308b\u3053\u3068\u304c\u3067\u304d\u308b(DATE\u578b\u3082\u307b\u307c\u540c\u3058)\nDATETIME\u578b\u306f\u300c\u66a6\u300d\u7684\u306a\u306e\u3067\u3001`DATETIME_TRUNC()`\u95a2\u6570\u3092\u4f7f\u3046\u3068\u300c\u65e5\u300d\u3084\u300c\u6708\u300d\u3068\u3044\u3046\u5358\u4f4d\u306bTruncate\u3067\u304d\u307e\u3059\u3002\nTimezone\u3092\u8003\u616e\u3057\u305f\u65e5\u5358\u4f4d\u3084\u6708\u5358\u4f4d\u306b\u30b0\u30eb\u30fc\u30d4\u30f3\u30b0\u3059\u308b\u3068\u304d\u306b\u4fbf\u5229\u3067\u3059\u3002\n\n```sql\nSELECT\n  DATETIME_TRUNC(DATETIME(TIMESTAMP \"2016-11-18 00:00:00+09\", 'Asia/Tokyo'), DAY) as day,\n  DATETIME_TRUNC(DATETIME(TIMESTAMP \"2016-11-18 00:00:00+09\", 'Asia/Tokyo'), MONTH) as month,\n  DATETIME_TRUNC(DATETIME(TIMESTAMP \"2016-11-18 00:00:00+09\", 'Asia/Tokyo'), YEAR) as year\n```\n\n|day|month|year|\n|---|---|---|\n|2016-11-18T00:00:00|2016-11-01T00:00:00|2016-01-01T00:00:00|\n\n### DATETIME\u578b\u306f\u300c\uff11\u30f6\u6708\u5f8c\u300d\u306a\u3069\u306e\u8a08\u7b97\u304c\u3067\u304d\u308b(DATE\u578b\u3082\u307b\u307c\u540c\u3058)\n\n```sql\nSELECT\n  DATETIME_ADD(DATETIME '2015-12-01', INTERVAL 30 DAY) as day30,\n  DATETIME_ADD(DATETIME '2015-12-01', INTERVAL 1 MONTH) as month\n```\n\n|day30|month|\n|---|---|\n|2015-12-31T00:00:00|2016-01-01T00:00:00|\n\nJSON\u6587\u5b57\u5217\u306eParse\n------\nJSON\u6587\u5b57\u5217\u304b\u3089\u53d6\u308a\u51fa\u3059\u540d\u524d\u3084\u578b\u3092\u660e\u793a\u3059\u308b\u5fc5\u8981\u306f\u3042\u308a\u307e\u3059\u304c\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u3059\u308c\u3070\u53ef\u80fd\u3067\u3059\u3002\n\n```sql\nCREATE TEMPORARY FUNCTION parse_json(json_str STRING) \nRETURNS STRUCT<name STRING, birthday STRING, mail STRING> \nLANGUAGE js AS \"\"\"\n  return JSON.parse(json_str);\n\"\"\";\n\nSELECT parse_json('{\"name\": \"hogehoge\", \"birthday\": \"2000-01-01\", \"pref\": 31}') as user\n```\n\n|Row|user.name|user.birthday|user.mail|\n|---|---|---|---|\n|1|hogehoge|2000-01-01|null|\n\n`<>` \u3067\u6307\u5b9a\u3057\u306a\u304b\u3063\u305f\u5217 `pref` \u306f\u51fa\u529b\u3055\u308c\u307e\u305b\u3093\u3057\u3001\u30ad\u30fc\u304c\u7121\u304b\u3063\u305f`mail`\u306f`null`\u306b\u306a\u308a\u307e\u3059\u3002\n\n\n\u6b63\u898f\u8868\u73fe\n--------\n\u6b63\u898f\u8868\u73fe\u3092\u4f7f\u3063\u3066\u6587\u5b57\u5217\u304b\u3089\u3001\u30de\u30c3\u30c1\u3057\u305f\u90e8\u5206\u3092\u62bd\u51fa\u3057\u305f\u308a\u3001\u30de\u30c3\u30c1\u3059\u308b\u304b\u3092\u5224\u5b9a\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n```sql\nSELECT \n  REGEXP_EXTRACT(\"hogehoge@gmail.com\", r'^([^@]+)@'),\n  REGEXP_CONTAINS(\"hogehoge@gmail.com\", r'@gmail\\.com$')\n```\n\n|f0_|f1_|\n|---|---|\n|hogehoge|true|\n\n\n\u3055\u3044\u3054\u306b\n=======\n\n\u3053\u308c\u3067\u6bce\u56de\u904e\u53bb\u306e\u5c65\u6b74\u3092\u635c\u7d22\u3057\u306a\u304f\u3066\u6e08\u3080\u304b\u306a\u3002\u3002\u3002\n", "tags": ["bigquery", "GoogleCloudPlatform"]}