{"context": "DataAPI\u306fAndroid\u3067\u8a18\u4e8b\u3092\u6295\u7a3f\u3057\u305f\u3044\uff01\u3068\u3044\u3046\u3068\u304d\u306b\u3068\u3066\u3082\u91cd\u8981\u306aAPI\u3067\u3059\u3002\n\u4eca\u56de\u306f\u3001\u305d\u306e\u4e2d\u304b\u3089\u30ab\u30c6\u30b4\u30ea\u306e\u6307\u5b9a\u306b\u3064\u3044\u3066\u3056\u3063\u304f\u308a\u8aac\u660e\u3057\u305f\u3044\u3068\u601d\u3044\u307e\u3059\u3002\n\u203b\u672c\u8a18\u4e8b\u306f\u3001\u30e9\u30a4\u30d5\u30b5\u30a4\u30af\u30eb\u3084API\u306a\u3069\u7406\u89e3\u3057\u3066\u3044\u308bAndroid\u958b\u767a\u4e2d\u7d1a\u8005\u4ee5\u4e0a\u3092\u5bfe\u8c61\u3068\u3057\u3066\u3044\u307e\u3059\u3002\n\n\u8a18\u4e8b\u306e\u30ab\u30c6\u30b4\u30ea\u3092\u53d6\u5f97\u3059\u308b\nString cgi_url = \"http://path/to/mt-data-api.cgi;\nString blog_id  = \"id\";\nString username     = \"username\"\nString password = \"password\"\nString token;\nArrayList<String>  categoryLabel;\nArrayList<Integer> categoryId;\nAsyncHttpClient    client;\n\n\n@Override\nprotected void onCreate(Bundle savedInstanceState) {\n    super.onCreate(savedInstanceState);\n\n    categoryLabel        = new ArrayList<String>();\n    categoryId           = new ArrayList<Integer>();\n    client               = new AsyncHttpClient();\n    RequestParams params = new RequestParams();\n\n    params.put(\"username\", username);\n    params.put(\"password\", password);\n    params.put(\"clientId\", \"test\");\n\n    String url = cgi_url.concat(\"/v2/authentication\");\n    client.post(url, params, new JsonHttpResponseHandler() {\n        @Override\n        public void onSuccess(JSONObject res) {\n            try {\n                token = res.getString(\"accessToken\");\n                Toast.makeText(act, \"\u30ed\u30b0\u30a4\u30f3\u3057\u307e\u3057\u305f\", Toast.LENGTH_LONG).show();\n                preferencesUtil.putInt(\"InitState\", 1);\n            } catch (Exception e) {\n                Toast.makeText(act, \"\u30ed\u30b0\u30a4\u30f3\u30a8\u30e9\u30fc\", Toast.LENGTH_LONG).show();\n            }\n        }\n\n        @Override\n        public void onFailure(Throwable e, JSONObject res) {\n            Toast.makeText(act, \"\u30ed\u30b0\u30a4\u30f3\u30a8\u30e9\u30fc\", Toast.LENGTH_LONG).show();\n        }\n    });\n\n    url = cgi_url.concat(\"/v2/sites/2/categories\");\n    client.get(url, params, new JsonHttpResponseHandler() {\n        @Override\n        public void onSuccess(JSONObject json) {\n            try {\n                // \u30bf\u30a4\u30c8\u30eb\u3092\u53d6\u5f97\u3059\u308b\u5834\u5408\n                JSONArray datas = json.getJSONArray(\"items\");\n                for(int i=0; i<datas.length(); i++) {\n                    categoryLabel.add(datas.getJSONObject(i).getString(\"label\"));\n                    categoryId.add(Integer.parseInt(datas.getJSONObject(i).getString(\"id\")));\n                }\n            } catch (JSONException e) {\n                e.printStackTrace();\n            }\n        }\n        @Override\n        public void onFailure(Throwable e, JSONObject res) {\n            Toast.makeText(act, \"\u30ed\u30b0\u30a4\u30f3\u30a8\u30e9\u30fc\", Toast.LENGTH_LONG).show();\n        }\n    });\n}\n\n\n\u30e1\u30f3\u30d0\u9818\u57df\u306b\u3001cgi_url:DataAPI\u306e\u30a8\u30f3\u30c9\u30dd\u30a4\u30f3\u30c8\u3001blog_id:\u30d6\u30ed\u30b0ID\u3001username     :\u30e6\u30fc\u30b6\u30fc\u540d\u3001password:\u30d1\u30b9\u30ef\u30fc\u30c9\u3092\u5ba3\u8a00\u3057\u307e\u3059\u3002\n\u8a18\u4e8b\u306e\u53d6\u5f97\u306f\u3001onCreate\u5185\u3067\u3084\u308a\u307e\u3059\u3002\n\u30ed\u30b0\u30a4\u30f3\u3059\u308b\u305f\u3081\u306b\u3001\u30e1\u30f3\u30d0\u5909\u6570\u306eusername\u3068password\u3092RequestParams\u306b\u633f\u5165\u3057AsyncHttpClient\u3067cgi_url+/v2/authentication\u306bpost\u3057\u307e\u3059\u3002\n\u30ed\u30b0\u30a4\u30f3\u306b\u6210\u529f\u3059\u308b\u3068\u3001onSuccess\u306b\u5165\u308aJSONObject\u304c\u8fd4\u5374\u3055\u308c\u308b\u306e\u3067accessToken\u3092\u4fdd\u5b58\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n\u8a18\u4e8b\u306e\u30ab\u30c6\u30b4\u30ea\u3092\u53d6\u5f97\u3059\u308b\u306e\u306f\u3001\u5148\u307b\u3069\u4f5c\u6210\u3057\u305fRequestParams\u3092AsyncHttpClient\u3067cgi_url+/v2/sites/2/categories\u306bpost\u3057\u307e\u3059\u3002\n\u30ab\u30c6\u30b4\u30ea\u306e\u53d6\u5f97\u306b\u6210\u529f\u3059\u308b\u3068\u3001onSuccess\u306b\u5165\u308b\u306e\u3067JSONArray\u306bitems\u306e\u8981\u7d20\u3092\u633f\u5165\u3057\u307e\u3059\u3002\nJSONArray datas = json.getJSONArray(\"items\");\n\n\u53d6\u5f97\u3057\u3066\u304d\u305fitems\u304b\u3089\u767b\u9332\u3055\u308c\u3066\u3044\u308b\u30ab\u30c6\u30b4\u30ea\u306elabel\u3068id\u3092\u53d6\u5f97\u3057\u307e\u3059\u3002\nfor(int i=0; i<datas.length(); i++) {\n    categoryLabel.add(datas.getJSONObject(i).getString(\"label\"));\n    categoryId.add(Integer.parseInt(datas.getJSONObject(i).getString(\"id\")));\n}\n\n\u3053\u308c\u3067\u3001\u8a18\u4e8b\u306e\u30ab\u30c6\u30b4\u30ea\u3092\u53d6\u5f97\u3067\u304d\u307e\u3059\u3002\n\n\u8a18\u4e8b\u3092\u6295\u7a3f\u3059\u308b\n\u3053\u3053\u307e\u3067\u51fa\u6765\u308c\u3070\u3001\u3042\u3068\u306f\u6295\u7a3f\u3059\u308b\u3060\u3051\u3067\u3059\u3002\n    private void uploadText() throws JSONException {\n        CharSequence  title  = \"title\";\n        CharSequence  body   = \"body\";\n        JSONObject    entry  = new JSONObject();\n        RequestParams params = new RequestParams();\n        JSONArray categories = new JSONArray();\n        JSONObject category;\n        for(int i=0; i<categoryLabel.size(); i++) {           \n            category = new JSONObject();\n            category.put(\"id\",categoryId.get(i));\n            categories.put(category);\n        }\n        try {\n            entry.put(\"title\", title);\n            entry.put(\"body\", body);\n            entry.put(\"categories\",categories);\n            entry.put(\"status\", \"Draft\");\n        } catch (JSONException e) {\n            e.printStackTrace();\n        }\n        params.put(\"entry\", entry.toString());\n        String url = cgi_url.concat(\"/v2/sites/\").concat(blog_id).concat(\"/entries\");\n        Header[] headers = new Header[1];\n        headers[0] = new BasicHeader(\"X-MT-Authorization\", \"MTAuth accessToken=\".concat(token));\n        client.post(getBaseContext(), url, headers, params, \"application/x-www-form-urlencoded\", new JsonHttpResponseHandler() {\n            @Override\n            public void onSuccess(JSONObject res) {\n                Toast.makeText(act, \"\u9001\u4fe1\u5b8c\u4e86\", Toast.LENGTH_LONG).show();\n            }\n            public void onFailure(Throwable e, JSONObject res) {\n                Toast.makeText(act, \"\u9001\u4fe1\u30a8\u30e9\u30fc\", Toast.LENGTH_LONG).show();\n            }\n        });\n\n    }\n\n\u307e\u305a\u3001\u30a8\u30f3\u30c8\u30ea\u3068\u306a\u308b\u8981\u7d20\u306eJSONObject\u3068\u8a18\u4e8b\u30ea\u30af\u30a8\u30b9\u30c8\u3092\u9001\u4fe1\u3059\u308b\u305f\u3081\u306eRequestParams\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\u3042\u3068\u306f\u3001\u8907\u6570\u306e\u30ab\u30c6\u30b4\u30ea\u3092\u633f\u5165\u3059\u308b\u305f\u3081\u306eJSONArray\u3068\u500b\u3005\u306e\u30ab\u30c6\u30b4\u30ea\u3092\u633f\u5165\u3059\u308bJSONObject\u3092\u7528\u610f\u3057\u307e\u3059\u3002\n\u30ab\u30c6\u30b4\u30ea\u306e\u30a8\u30f3\u30c8\u30ea\u306fid\u3067\u3001\u30ab\u30c6\u30b4\u30ea\u7fa4\u306e\u30a8\u30f3\u30c8\u30ea\u306fcategories\u306b\u306a\u308a\u307e\u3059\u3002\npost\u3059\u308b\u6642\u306f\u3001categories\u5185\u306bcategory\u3092\u633f\u5165\u3059\u308b\u5f62\u3067\u9001\u4fe1\u3057\u307e\u3059\u3002\n\u3042\u3068\u306f\u3001AsyncHttpClient\u3067url\u306e\u30a8\u30f3\u30c9\u30dd\u30a4\u30f3\u30c8\u3068params\u3068\u8a2d\u5b9a\u3057\u305fheaders\u3092\u5165\u308c\u3066\u9001\u4fe1\u3059\u308c\u3070\u30ab\u30c6\u30b4\u30ea\u304c\u767b\u9332\u3055\u308c\u305f\u8a18\u4e8b\u304c\u51fa\u6765\u307e\u3059\u3002\n\n\u88dc\u8db3\n\u30a4\u30f3\u30bf\u30fc\u30cd\u30c3\u30c8\u3092\u4f7f\u7528\u3059\u308b\u306e\u3067\u3001AndroidManifest\u5185\u306b\n<uses-permission android:name=\"android.permission.INTERNET\"/>\n<uses-permission android:name=\"android.permission.ACCESS_NETWORK_STATE\"/>\n\u3092\u5ba3\u8a00\u3059\u308b\u4e8b\u306f\u304a\u5fd8\u308c\u306a\u304f\uff01\nDataAPI\u306fAndroid\u3067\u8a18\u4e8b\u3092\u6295\u7a3f\u3057\u305f\u3044\uff01\u3068\u3044\u3046\u3068\u304d\u306b\u3068\u3066\u3082\u91cd\u8981\u306aAPI\u3067\u3059\u3002\n\u4eca\u56de\u306f\u3001\u305d\u306e\u4e2d\u304b\u3089\u30ab\u30c6\u30b4\u30ea\u306e\u6307\u5b9a\u306b\u3064\u3044\u3066\u3056\u3063\u304f\u308a\u8aac\u660e\u3057\u305f\u3044\u3068\u601d\u3044\u307e\u3059\u3002\n\u203b\u672c\u8a18\u4e8b\u306f\u3001\u30e9\u30a4\u30d5\u30b5\u30a4\u30af\u30eb\u3084API\u306a\u3069\u7406\u89e3\u3057\u3066\u3044\u308bAndroid\u958b\u767a\u4e2d\u7d1a\u8005\u4ee5\u4e0a\u3092\u5bfe\u8c61\u3068\u3057\u3066\u3044\u307e\u3059\u3002\n\n#\u8a18\u4e8b\u306e\u30ab\u30c6\u30b4\u30ea\u3092\u53d6\u5f97\u3059\u308b\n\n```\nString cgi_url = \"http://path/to/mt-data-api.cgi;\nString blog_id  = \"id\";\nString username     = \"username\"\nString password = \"password\"\nString token;\nArrayList<String>  categoryLabel;\nArrayList<Integer> categoryId;\nAsyncHttpClient    client;\n\n\n@Override\nprotected void onCreate(Bundle savedInstanceState) {\n    super.onCreate(savedInstanceState);\n\n    categoryLabel        = new ArrayList<String>();\n    categoryId           = new ArrayList<Integer>();\n    client               = new AsyncHttpClient();\n    RequestParams params = new RequestParams();\n\n    params.put(\"username\", username);\n    params.put(\"password\", password);\n    params.put(\"clientId\", \"test\");\n\n    String url = cgi_url.concat(\"/v2/authentication\");\n    client.post(url, params, new JsonHttpResponseHandler() {\n        @Override\n        public void onSuccess(JSONObject res) {\n            try {\n                token = res.getString(\"accessToken\");\n                Toast.makeText(act, \"\u30ed\u30b0\u30a4\u30f3\u3057\u307e\u3057\u305f\", Toast.LENGTH_LONG).show();\n                preferencesUtil.putInt(\"InitState\", 1);\n            } catch (Exception e) {\n                Toast.makeText(act, \"\u30ed\u30b0\u30a4\u30f3\u30a8\u30e9\u30fc\", Toast.LENGTH_LONG).show();\n            }\n        }\n\n        @Override\n        public void onFailure(Throwable e, JSONObject res) {\n            Toast.makeText(act, \"\u30ed\u30b0\u30a4\u30f3\u30a8\u30e9\u30fc\", Toast.LENGTH_LONG).show();\n        }\n    });\n\n    url = cgi_url.concat(\"/v2/sites/2/categories\");\n    client.get(url, params, new JsonHttpResponseHandler() {\n        @Override\n        public void onSuccess(JSONObject json) {\n            try {\n                // \u30bf\u30a4\u30c8\u30eb\u3092\u53d6\u5f97\u3059\u308b\u5834\u5408\n                JSONArray datas = json.getJSONArray(\"items\");\n                for(int i=0; i<datas.length(); i++) {\n                    categoryLabel.add(datas.getJSONObject(i).getString(\"label\"));\n                    categoryId.add(Integer.parseInt(datas.getJSONObject(i).getString(\"id\")));\n                }\n            } catch (JSONException e) {\n                e.printStackTrace();\n            }\n        }\n        @Override\n        public void onFailure(Throwable e, JSONObject res) {\n            Toast.makeText(act, \"\u30ed\u30b0\u30a4\u30f3\u30a8\u30e9\u30fc\", Toast.LENGTH_LONG).show();\n        }\n    });\n}\n\n```\n\u30e1\u30f3\u30d0\u9818\u57df\u306b\u3001`cgi_url:DataAPI\u306e\u30a8\u30f3\u30c9\u30dd\u30a4\u30f3\u30c8`\u3001`blog_id:\u30d6\u30ed\u30b0ID`\u3001`username     :\u30e6\u30fc\u30b6\u30fc\u540d`\u3001`password:\u30d1\u30b9\u30ef\u30fc\u30c9`\u3092\u5ba3\u8a00\u3057\u307e\u3059\u3002\n\n\u8a18\u4e8b\u306e\u53d6\u5f97\u306f\u3001`onCreate`\u5185\u3067\u3084\u308a\u307e\u3059\u3002\n\n\u30ed\u30b0\u30a4\u30f3\u3059\u308b\u305f\u3081\u306b\u3001\u30e1\u30f3\u30d0\u5909\u6570\u306e`username`\u3068`password`\u3092`RequestParams`\u306b\u633f\u5165\u3057`AsyncHttpClient`\u3067`cgi_url+/v2/authentication`\u306b**post**\u3057\u307e\u3059\u3002\n\n\u30ed\u30b0\u30a4\u30f3\u306b\u6210\u529f\u3059\u308b\u3068\u3001`onSuccess`\u306b\u5165\u308a`JSONObject`\u304c\u8fd4\u5374\u3055\u308c\u308b\u306e\u3067`accessToken`\u3092\u4fdd\u5b58\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n\n\u8a18\u4e8b\u306e\u30ab\u30c6\u30b4\u30ea\u3092\u53d6\u5f97\u3059\u308b\u306e\u306f\u3001\u5148\u307b\u3069\u4f5c\u6210\u3057\u305f`RequestParams`\u3092`AsyncHttpClient`\u3067`cgi_url+/v2/sites/2/categories`\u306b**post**\u3057\u307e\u3059\u3002\n\n\u30ab\u30c6\u30b4\u30ea\u306e\u53d6\u5f97\u306b\u6210\u529f\u3059\u308b\u3068\u3001`onSuccess`\u306b\u5165\u308b\u306e\u3067`JSONArray`\u306b`items`\u306e\u8981\u7d20\u3092\u633f\u5165\u3057\u307e\u3059\u3002\n\n```\nJSONArray datas = json.getJSONArray(\"items\");\n```\n\n\u53d6\u5f97\u3057\u3066\u304d\u305f`items`\u304b\u3089\u767b\u9332\u3055\u308c\u3066\u3044\u308b\u30ab\u30c6\u30b4\u30ea\u306e`label`\u3068`id`\u3092\u53d6\u5f97\u3057\u307e\u3059\u3002\n\n```\nfor(int i=0; i<datas.length(); i++) {\n    categoryLabel.add(datas.getJSONObject(i).getString(\"label\"));\n    categoryId.add(Integer.parseInt(datas.getJSONObject(i).getString(\"id\")));\n}\n```\n\n\u3053\u308c\u3067\u3001\u8a18\u4e8b\u306e\u30ab\u30c6\u30b4\u30ea\u3092\u53d6\u5f97\u3067\u304d\u307e\u3059\u3002\n\n#\u8a18\u4e8b\u3092\u6295\u7a3f\u3059\u308b\n\u3053\u3053\u307e\u3067\u51fa\u6765\u308c\u3070\u3001\u3042\u3068\u306f\u6295\u7a3f\u3059\u308b\u3060\u3051\u3067\u3059\u3002\n\n```Java\n    private void uploadText() throws JSONException {\n        CharSequence  title  = \"title\";\n        CharSequence  body   = \"body\";\n        JSONObject    entry  = new JSONObject();\n        RequestParams params = new RequestParams();\n        JSONArray categories = new JSONArray();\n        JSONObject category;\n        for(int i=0; i<categoryLabel.size(); i++) {           \n            category = new JSONObject();\n            category.put(\"id\",categoryId.get(i));\n            categories.put(category);\n        }\n        try {\n            entry.put(\"title\", title);\n            entry.put(\"body\", body);\n            entry.put(\"categories\",categories);\n            entry.put(\"status\", \"Draft\");\n        } catch (JSONException e) {\n            e.printStackTrace();\n        }\n        params.put(\"entry\", entry.toString());\n        String url = cgi_url.concat(\"/v2/sites/\").concat(blog_id).concat(\"/entries\");\n        Header[] headers = new Header[1];\n        headers[0] = new BasicHeader(\"X-MT-Authorization\", \"MTAuth accessToken=\".concat(token));\n        client.post(getBaseContext(), url, headers, params, \"application/x-www-form-urlencoded\", new JsonHttpResponseHandler() {\n            @Override\n            public void onSuccess(JSONObject res) {\n                Toast.makeText(act, \"\u9001\u4fe1\u5b8c\u4e86\", Toast.LENGTH_LONG).show();\n            }\n            public void onFailure(Throwable e, JSONObject res) {\n                Toast.makeText(act, \"\u9001\u4fe1\u30a8\u30e9\u30fc\", Toast.LENGTH_LONG).show();\n            }\n        });\n\n    }\n```\n\u307e\u305a\u3001\u30a8\u30f3\u30c8\u30ea\u3068\u306a\u308b\u8981\u7d20\u306e`JSONObject`\u3068\u8a18\u4e8b\u30ea\u30af\u30a8\u30b9\u30c8\u3092\u9001\u4fe1\u3059\u308b\u305f\u3081\u306e`RequestParams`\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\u3042\u3068\u306f\u3001\u8907\u6570\u306e\u30ab\u30c6\u30b4\u30ea\u3092\u633f\u5165\u3059\u308b\u305f\u3081\u306e`JSONArray`\u3068\u500b\u3005\u306e\u30ab\u30c6\u30b4\u30ea\u3092\u633f\u5165\u3059\u308b`JSONObject`\u3092\u7528\u610f\u3057\u307e\u3059\u3002\n\u30ab\u30c6\u30b4\u30ea\u306e\u30a8\u30f3\u30c8\u30ea\u306fid\u3067\u3001\u30ab\u30c6\u30b4\u30ea\u7fa4\u306e\u30a8\u30f3\u30c8\u30ea\u306fcategories\u306b\u306a\u308a\u307e\u3059\u3002\n**post**\u3059\u308b\u6642\u306f\u3001`categories`\u5185\u306b`category`\u3092\u633f\u5165\u3059\u308b\u5f62\u3067\u9001\u4fe1\u3057\u307e\u3059\u3002\n\u3042\u3068\u306f\u3001`AsyncHttpClient`\u3067`url`\u306e\u30a8\u30f3\u30c9\u30dd\u30a4\u30f3\u30c8\u3068`params`\u3068\u8a2d\u5b9a\u3057\u305f`headers`\u3092\u5165\u308c\u3066\u9001\u4fe1\u3059\u308c\u3070\u30ab\u30c6\u30b4\u30ea\u304c\u767b\u9332\u3055\u308c\u305f\u8a18\u4e8b\u304c\u51fa\u6765\u307e\u3059\u3002\n\n#\u88dc\u8db3\n\u30a4\u30f3\u30bf\u30fc\u30cd\u30c3\u30c8\u3092\u4f7f\u7528\u3059\u308b\u306e\u3067\u3001AndroidManifest\u5185\u306b\n`<uses-permission android:name=\"android.permission.INTERNET\"/>`\n`<uses-permission android:name=\"android.permission.ACCESS_NETWORK_STATE\"/>`\n\u3092\u5ba3\u8a00\u3059\u308b\u4e8b\u306f\u304a\u5fd8\u308c\u306a\u304f\uff01\n", "tags": ["MovableType", "DataAPI", "Android", "Java"]}