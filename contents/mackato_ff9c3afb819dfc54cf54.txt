{"tags": ["RubyMotion", "iBeacon"], "context": " More than 1 year has passed since last update.\u3053\u3093\u3070\u3093\u306f\u3001RubyMotion\u3067\u4e00\u756a\u826f\u304f\u6253\u3064\u30b3\u30de\u30f3\u30c9\u306f motion update \u306e @mackato \u3067\u3059\u3002\n\u4eca\u65e5\u306f\u5c90\u961c\u770c\u5927\u57a3\u5e02\u306e\u30c9\u30ea\u30fc\u30e0\u30b3\u30a2\u3067\u884c\u308f\u308c\u305fiBeacon\u30cf\u30c3\u30ab\u30bd\u30f3\u306b\u53c2\u52a0\u3057\u3066\u3044\u305f\u306e\u3067\u3001RubyMotion\u3067iBeacon\u3092\u4f7f\u3046\u65b9\u6cd5\u306b\u3064\u3044\u3066\u7d39\u4ecb\u3057\u307e\u3059\u3002\n\niBeacon\u3068\u306f\niBeacon\u3068\u306fBluetooth Low Energy\u3092\u5229\u7528\u3057\u305f\u4f4d\u7f6e\u3068\u8fd1\u63a5\u306e\u691c\u51fa\u6280\u8853\u3067\u3059\u3002iBeacon\u3092\u5229\u7528\u3059\u308b\u3068\u3001\u4f4e\u6d88\u8cbb\u96fb\u529b\u306aBluetooth Low Energy\u306e\u767a\u4fe1\u6a5f\u3092\u5e97\u8217\u3084\u30df\u30e5\u30fc\u30b8\u30a2\u30e0\u306a\u3069\u306e\u73fe\u5b9f\u4e16\u754c\u306b\u7f6e\u3044\u3066\u3001\u305d\u306e\u8fd1\u304f\u306b\u6765\u305f\u3053\u3068\u3092iOS\u30a2\u30d7\u30ea\u304c\u30d0\u30c3\u30af\u30a8\u30f3\u30c9\u3067\u691c\u51fa\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\nBluetooth Low Energy\u306fiPhone 4S\u3001iOS 5\u304b\u3089\u30b5\u30dd\u30fc\u30c8\u3055\u308c\u3066\u3044\u307e\u3059\u304c\u3001iBeacon\u306fiOS 7\u304b\u3089\u5229\u7528\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3057\u305f\u3002iBeacon\u306e\u6982\u8981\u306b\u3064\u3044\u3066\u306f @u_akihiro \u3055\u3093\u304c\u4eca\u65e5\u306e\u30cf\u30c3\u30ab\u30bd\u30f3\u3067\u5206\u304b\u308a\u3084\u3059\u3044\u8cc7\u6599\u3067\u7d39\u4ecb\u3055\u308c\u3066\u3044\u305f\u306e\u3067\u3001\u305d\u3061\u3089\u3092\u3054\u89a7\u304f\u3060\u3055\u3044\u3002\n20131217 i beacon\u30cf\u30c3\u30ab\u30bd\u30f3\nhttp://www.slideshare.net/reinforcelab/20131217-i-beacon\n\n\u30b5\u30f3\u30d7\u30eb\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306e\u4f5c\u6210\n\u305d\u308c\u3067\u306f\u3001iBeacon\u3092\u8a66\u3059\u305f\u3081\u306e\u30b5\u30f3\u30d7\u30eb\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092RubyMotion\u3067\u4f5c\u3063\u3066\u307f\u307e\u3057\u3087\u3046\u3002\u4eca\u56de\u306f\u300cHelloBeacon\u300d\u3068\u3044\u3046\u540d\u524d\u3067\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092\u4f5c\u6210\u3057\u307e\u3057\u305f\u3002\n% motion create --template=ios HelloBeacon\n\niBeacon\u306fCoreLocation\u306b\u542b\u307e\u308c\u3066\u3044\u308b\u306e\u3067\u3001\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306eRakefile\u306eframeworks\u306b 'CoreLocation' \u3068 'CoreBluetooth' \u3092\u8ffd\u52a0\u3057\u307e\u3059\u3002\n\nRakefile\n# -*- coding: utf-8 -*-\n$:.unshift(\"/Library/RubyMotion/lib\")\nrequire 'motion/project/template/ios'\n\nbegin\n  require 'bundler'\n  Bundler.require\nrescue LoadError\nend\n\nMotion::Project::App.setup do |app|\n  # Use `rake config' to see complete project settings.\n  app.name = 'HelloBeacon'\n  app.frameworks += %w(CoreLocation CoreBluetooth)\nend\n\n\n\u4ee5\u4e0a\u3067iBeacon\u306b\u5bfe\u5fdc\u3057\u305f\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306e\u6e96\u5099\u304c\u3067\u304d\u307e\u3057\u305f\u3002\u305d\u308c\u3067\u306f\u3001\u5b9f\u969b\u306biBeacon\u306e\u3084\u308a\u3068\u308a\u3092\u304a\u3053\u306a\u3063\u3066\u307f\u307e\u3057\u3087\u3046\u3002\n\niBeacon\u306e\u767a\u4fe1\u3092\u304a\u3053\u306a\u3046\n\u5b9f\u969b\u306b\u5e97\u8217\u7b49\u3067\u904b\u7528\u3059\u308b\u5834\u5408\u306f\u30dc\u30bf\u30f3\u96fb\u6c60\u306a\u3069\u3067\u52d5\u4f5c\u3059\u308b\u5b89\u4fa1\u306a\u5c02\u7528\u6a5f\u5668\u3092\u767a\u4fe1\u306b\u4f7f\u3046\u3053\u3068\u304c\u591a\u3044\u3068\u601d\u3044\u307e\u3059\u304c\u3001iOS\u30c7\u30d0\u30a4\u30b9\u81ea\u4f53\u3092\u767a\u4fe1\u306b\u5229\u7528\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\u5c02\u7528\u6a5f\u5668\u3092\u7528\u610f\u3059\u308b\u306e\u306f\u6577\u5c45\u304c\u9ad8\u3044\u3068\u601d\u3046\u306e\u3067\u3001iBeacon\u306e\u52d5\u4f5c\u78ba\u8a8d\u306a\u3069\u306b\u306f\u624b\u6301\u3061\u306eiOS\u7aef\u672b\u3092\u4f7f\u3046\u3068\u826f\u3044\u3067\u3057\u3087\u3046\u3002\n\u5b9f\u969b\u306b\u767a\u4fe1\u3092\u304a\u3053\u306a\u3046\u30b3\u30fc\u30c9\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\n# -*- coding: utf-8 -*-\nclass HomeViewController < UIViewController\n  UUID = NSUUID.alloc.initWithUUIDString(\"YOUR_UUID_HERE\")\n\n  def viewDidLoad\n    super\n    view.backgroundColor = UIColor.whiteColor\n\n    @region = CLBeaconRegion.alloc.initWithProximityUUID(UUID, major: 1,\n                                                               minor: 2,\n                                                               identifier: \"com.example.region\")\n    @manager = CBPeripheralManager.alloc.initWithDelegate(self, queue: Dispatch::Queue.main.dispatch_object)\n  end\n\n  def peripheralManagerDidUpdateState(peripheral)\n    if peripheral.state == CBPeripheralManagerStatePoweredOn\n      @manager.startAdvertising @region.peripheralDataWithMeasuredPower(nil)\n    end\n  end\nend\n\n\u3053\u306e\u30b3\u30fc\u30c9\u3067\u30dd\u30a4\u30f3\u30c8\u306f\u4e0b\u8a18\u306e\u90e8\u5206\u3067\u3059\u3002\nCLBeaconRegion.alloc.initWithProximityUUID(UUID, major: 1,\n                                                 minor: 2,\n                                                 identifier: \"com.example.region\")\n\nUUID\u306f\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3084\u30b5\u30fc\u30d3\u30b9\u3092\u8b58\u5225\u3059\u308b\u305f\u3081\u306e128-bit\u306e\u8b58\u5225\u5b50\u3067\u3059\u3002\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u306f\u6c7a\u307e\u3063\u3066\u3044\u3066\u3001\u30b0\u30ed\u30fc\u30d0\u30eb\u306b\u30e6\u30cb\u30fc\u30af\u3067\u3042\u308b\u5fc5\u8981\u304c\u3042\u308b\u306e\u3067\u3001Mac\u306e uuidgen \u30b3\u30de\u30f3\u30c9\u3067\u751f\u6210\u3059\u308b\u306e\u304c\u826f\u3044\u3067\u3059\u3002\nmajor/minor\u306f16\u30d3\u30c3\u30c8\u306e\u4efb\u610f\u306e\u756a\u53f7\u3092\u4f7f\u7528\u3067\u304d\u307e\u3059\u3002\u4f8b\u3048\u3070\u5c0f\u58f2\u5e97\u3067\u5229\u7528\u3059\u308b\u30a2\u30d7\u30ea\u3067\u3042\u308c\u3070\u3001\u5e97\u8217\u6bce\u306bmajor\u3092\u3001\u58f2\u308a\u5834\u6bce\u306bminor\u3092\u4f7f\u3044\u5206\u3051\u308b\u3068\u3044\u3046\u306e\u304c\u5178\u578b\u7684\u306a\u4f7f\u3044\u65b9\u3067\u3059\u3002\n\niBeacon\u306e\u53d7\u4fe1\u3092\u304a\u3053\u306a\u3046\niBeacon\u306e\u53d7\u4fe1\u306fGPS\u4f4d\u7f6e\u60c5\u5831\u306e\u53d7\u4fe1\u7b49\u3092\u304a\u3053\u306a\u3046CLLocationManager\u3092\u901a\u3058\u3066\u304a\u3053\u306a\u3044\u307e\u3059\u3002\u5b9f\u969b\u306e\u30b3\u30fc\u30c9\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\n# -*- coding: utf-8 -*-\nclass BeaconViewController < UIViewController\n  UUID = NSUUID.alloc.initWithUUIDString(\"YOUR_UUID_HERE\")\n\n  def viewDidLoad\n    super\n\n    self.view.backgroundColor = UIColor.whiteColor\n\n    @label = UILabel.alloc.init\n    @label.textAlignment = NSTextAlignmentCenter\n    @label.text = \"Waiting...\"\n    @label.frame = [[0, 100], [320, 100]]\n    self.view.addSubview(@label)\n\n    region = CLBeaconRegion.alloc.initWithProximityUUID(UUID, identifier: \"com.example.region\")\n\n    @manager = CLLocationManager.alloc.init\n    @manager.delegate = self\n    @manager.startMonitoringForRegion(region)\n  end\n\n  def locationManager(manager, didStartMonitoringForRegion: region)\n    manager.requestStateForRegion(region)\n  end\n\n  def locationManager(manager, didDetermineState: state, forRegion: region)\n    if state == CLRegionStateInside\n      manager.startRangingBeaconsInRegion(region)\n    end\n  end\n\n  def locationManager(manager, didEnterRegion: region)\n    if region.isKindOfClass(CLBeaconRegion)\n      manager.startRangingBeaconsInRegion(region)\n    end\n  end\n\n  def locationManager(manager, didExitRegion: region)\n    if region.isKindOfClass(CLBeaconRegion)\n      manager.stopRangingBeaconsInRegion(region)\n    end\n  end\n\n  def locationManager(manager, didRangeBeacons: beacons, inRegion: region)\n    beacon = beacons.last\n\n    if beacon\n      proximity = case beacon.proximity\n                  when CLProximityUnknown\n                    \"Unknown\"\n                  when CLProximityFar\n                    \"Far\"\n                  when CLProximityNear\n                    \"Near\"\n                  when CLProximityImmediate\n                    \"Immediate\"\n                  else\n                    \"Nothing\"\n                  end\n      @label.text = \"#{proximity}: #{beacon.major}-#{beacon.minor}\"\n    end\n  end\nend\n\n\u5c11\u3057\u9577\u3044\u306e\u3067\u9806\u3092\u8ffd\u3063\u3066\u30dd\u30a4\u30f3\u30c8\u3092\u898b\u3066\u3044\u304d\u307e\u3057\u3087\u3046\u3002\nregion = CLBeaconRegion.alloc.initWithProximityUUID(UUID, identifier: \"com.example.region\")\n\n\u767a\u4fe1\u5074\u306e\u30ea\u30fc\u30b8\u30e7\u30f3\u3067\u306fUUID\u3068major/minor\u3092\u6307\u5b9a\u3057\u3066\u3044\u307e\u3057\u305f\u304c\u3001\u53d7\u4fe1\u5074\u306e\u30ea\u30fc\u30b8\u30e7\u30f3\u3067\u306f\u6307\u5b9a\u3057\u3066\u3044\u307e\u305b\u3093\u3002\u3053\u308c\u306f\u767a\u4fe1\u5074\u3092\u5e97\u8217\u306b\u636e\u3048\u4ed8\u3051\u3089\u308c\u305f\u5c02\u7528\u6a5f\u5668\u3001\u53d7\u4fe1\u5074\u3092\u9867\u5ba2\u304c\u3082\u3064iPhone\u306b\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u305f\u30a2\u30d7\u30ea\u3068\u3044\u3046\u5178\u578b\u7684\u306a\u30e6\u30fc\u30b9\u30b1\u30fc\u30b9\u3092\u60f3\u5b9a\u3057\u3066\u3044\u307e\u3059\u3002\u3082\u3061\u308d\u3093\u3001\u53d7\u4fe1\u5074\u3067\u3082major/minor\u3092\u6307\u5b9a\u3059\u308b\u3053\u3068\u306f\u53ef\u80fd\u3067\u3059\u3002\n@manager = CLLocationManager.alloc.init\n@manager.delegate = self\n@manager.startMonitoringForRegion(region)\n\nCLLocationManager\u306e\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u751f\u6210\u3057\u3066\u3001\u81ea\u5206\u81ea\u8eab\u3092delegate\u306b\u8a2d\u5b9a\u3057\u3001\u6700\u5f8c\u306bstartMonitoringForRegion\u3067iBeacon\u306e\u30ea\u30fc\u30b8\u30e7\u30f3\u76e3\u8996\u306e\u958b\u59cb\u3092\u8981\u6c42\u3057\u3066\u3044\u307e\u3059\u3002\ndef locationManager(manager, didStartMonitoringForRegion: region)\n  manager.requestStateForRegion(region)\nend\n\n\u30ea\u30fc\u30b8\u30e7\u30f3\u306e\u76e3\u8996\u304c\u958b\u59cb\u3055\u308c\u305f\u30bf\u30a4\u30df\u30f3\u30b0\u3067 requestStateForRegion \u3092\u547c\u3073\u3001\u958b\u59cb\u6642\u306e\u30b9\u30c6\u30fc\u30c8\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\ndef locationManager(manager, didDetermineState: state, forRegion: region)\n  if state == CLRegionStateInside\n    manager.startRangingBeaconsInRegion(region)\n  end\nend\n\n\u958b\u59cb\u6642\u306b\u9818\u57df\u5185\u306b\u3044\u308b\u5834\u5408\u306f\u30ec\u30f3\u30b8\u30f3\u30b0\uff08\u8ddd\u96e2\u6e2c\u5b9a\uff09\u306e\u958b\u59cb\u3092\u8981\u6c42\u3057\u307e\u3059\u3002\ndef locationManager(manager, didEnterRegion: region)\n  if region.isKindOfClass(CLBeaconRegion)\n    manager.startRangingBeaconsInRegion(region)\n  end\nend\n\ndef locationManager(manager, didExitRegion: region)\n  if region.isKindOfClass(CLBeaconRegion)\n    manager.stopRangingBeaconsInRegion(region)\n  end\nend\n\n\u9818\u57df\u306e\u5185\u306b\u5165\u3063\u305f\u5834\u5408\u3001\u9818\u57df\u306e\u5916\u306b\u51fa\u305f\u5834\u5408\u306edelegate\u3067\u305d\u308c\u305e\u308c\u30ec\u30f3\u30b8\u30f3\u30b0\u306e\u958b\u59cb\u3068\u7d42\u4e86\u3092\u8981\u6c42\u3057\u307e\u3059\u3002\ndef locationManager(manager, didRangeBeacons: beacons, inRegion: region)\n  beacon = beacons.last\n\n  if beacon\n    ...\n    @label.text = \"#{proximity}: #{beacon.major}-#{beacon.minor}\"\n  end\nend\n\n\u30ec\u30f3\u30b8\u30f3\u30b0\u306e\u7d50\u679c\u3092delegate\u3067\u53d7\u3051\u53d6\u3063\u3066label\u306b\u8868\u793a\u3057\u3066\u3044\u307e\u3059\u3002beacon\u306fCLBeacon\u30af\u30e9\u30b9\u306e\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3067\u3059\u3002CLBeacon\u304b\u3089\u306fmajor/minor\u306e\u4ed6\u3001proximity(\u767a\u4fe1\u5074\u3068\u306e\u304a\u304a\u3088\u305d\u306e\u8fd1\u63a5\u95a2\u4fc2)\u3001accuracy(\u7cbe\u5ea6)\u3001rssi(\u96fb\u6ce2\u5f37\u5ea6)\u306a\u3069\u304c\u53d6\u5f97\u3067\u304d\u307e\u3059\u3002\n\u5b9f\u969b\u306e\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3067\u306fmajor/minor\u3092\u5224\u5225\u3057\u3066\u51e6\u7406\u3092\u5206\u5c90\u3055\u305b\u305f\u308a\u3001\u30b5\u30fc\u30d0\u30fc\u30b5\u30a4\u30c9\u306bmajor/minor\u3092\u9001\u4fe1\u3059\u308b\u3088\u3046\u306a\u4f7f\u3044\u65b9\u306b\u306a\u308b\u3068\u601d\u3044\u307e\u3059\u3002\u307e\u305f\u3001proximity\u3084rssi\u306f\u96fb\u6ce2\u72b6\u6cc1\u306a\u3069\u306e\u74b0\u5883\u306b\u5de6\u53f3\u3055\u308c\u3066\u7cbe\u5ea6\u306f\u3042\u307e\u308a\u9ad8\u304f\u306a\u3044\u306e\u3067\u6d3b\u7528\u306b\u306f\u6ce8\u610f\u304c\u5fc5\u8981\u306a\u3088\u3046\u3067\u3059\u3002\n\n\u307e\u3068\u3081\nRubyMotion\u306fiOS\u306e\u8584\u3044Wrapper\u306a\u306e\u3067\u3001iBeacon\u306e\u3088\u3046\u306a\u6700\u65b0\u306eOS\u306e\u6a5f\u80fd\u3082Objective-C\u3067\u958b\u767a\u3059\u308b\u306e\u3068\u5909\u308a\u306a\u304f\u5b9f\u88c5\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3057\u305f\u304c\u3001\u3053\u306e\u307e\u307e\u3067\u306f\u3042\u307e\u308aRubyMotion\u3063\u307d\u304f\u306a\u3044\u3067\u3059\u306d\u3002\nRubyMotion\u7528\u306eiBeacon Wrapper\u30e9\u30a4\u30d6\u30e9\u30ea\u304c\u767b\u5834\u3059\u308c\u3070\u4e00\u6c17\u306b\u4fbf\u5229\u306b\u306a\u308a\u305d\u3046\u306a\u306e\u3067\u3001\u8ab0\u304b\u66f8\u304b\u306a\u3044\u3067\u3059\u304b\u306d\u3047\uff08\u304a\u524d\u304c\u66f8\u3051\uff1f\uff09\n\u3053\u3093\u3070\u3093\u306f\u3001RubyMotion\u3067\u4e00\u756a\u826f\u304f\u6253\u3064\u30b3\u30de\u30f3\u30c9\u306f `motion update` \u306e @mackato \u3067\u3059\u3002\n\n\u4eca\u65e5\u306f\u5c90\u961c\u770c\u5927\u57a3\u5e02\u306e\u30c9\u30ea\u30fc\u30e0\u30b3\u30a2\u3067\u884c\u308f\u308c\u305fiBeacon\u30cf\u30c3\u30ab\u30bd\u30f3\u306b\u53c2\u52a0\u3057\u3066\u3044\u305f\u306e\u3067\u3001RubyMotion\u3067iBeacon\u3092\u4f7f\u3046\u65b9\u6cd5\u306b\u3064\u3044\u3066\u7d39\u4ecb\u3057\u307e\u3059\u3002\n\n## iBeacon\u3068\u306f\n\niBeacon\u3068\u306fBluetooth Low Energy\u3092\u5229\u7528\u3057\u305f\u4f4d\u7f6e\u3068\u8fd1\u63a5\u306e\u691c\u51fa\u6280\u8853\u3067\u3059\u3002iBeacon\u3092\u5229\u7528\u3059\u308b\u3068\u3001\u4f4e\u6d88\u8cbb\u96fb\u529b\u306aBluetooth Low Energy\u306e\u767a\u4fe1\u6a5f\u3092\u5e97\u8217\u3084\u30df\u30e5\u30fc\u30b8\u30a2\u30e0\u306a\u3069\u306e\u73fe\u5b9f\u4e16\u754c\u306b\u7f6e\u3044\u3066\u3001\u305d\u306e\u8fd1\u304f\u306b\u6765\u305f\u3053\u3068\u3092iOS\u30a2\u30d7\u30ea\u304c\u30d0\u30c3\u30af\u30a8\u30f3\u30c9\u3067\u691c\u51fa\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\n\nBluetooth Low Energy\u306fiPhone 4S\u3001iOS 5\u304b\u3089\u30b5\u30dd\u30fc\u30c8\u3055\u308c\u3066\u3044\u307e\u3059\u304c\u3001iBeacon\u306fiOS 7\u304b\u3089\u5229\u7528\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3057\u305f\u3002iBeacon\u306e\u6982\u8981\u306b\u3064\u3044\u3066\u306f [&#64;u_akihiro](https://twitter.com/u_akihiro) \u3055\u3093\u304c\u4eca\u65e5\u306e\u30cf\u30c3\u30ab\u30bd\u30f3\u3067\u5206\u304b\u308a\u3084\u3059\u3044\u8cc7\u6599\u3067\u7d39\u4ecb\u3055\u308c\u3066\u3044\u305f\u306e\u3067\u3001\u305d\u3061\u3089\u3092\u3054\u89a7\u304f\u3060\u3055\u3044\u3002\n\n**20131217 i beacon\u30cf\u30c3\u30ab\u30bd\u30f3**\nhttp://www.slideshare.net/reinforcelab/20131217-i-beacon\n\n## \u30b5\u30f3\u30d7\u30eb\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306e\u4f5c\u6210\n\n\u305d\u308c\u3067\u306f\u3001iBeacon\u3092\u8a66\u3059\u305f\u3081\u306e\u30b5\u30f3\u30d7\u30eb\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092RubyMotion\u3067\u4f5c\u3063\u3066\u307f\u307e\u3057\u3087\u3046\u3002\u4eca\u56de\u306f\u300cHelloBeacon\u300d\u3068\u3044\u3046\u540d\u524d\u3067\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092\u4f5c\u6210\u3057\u307e\u3057\u305f\u3002\n\n```sh\n% motion create --template=ios HelloBeacon\n```\n\niBeacon\u306fCoreLocation\u306b\u542b\u307e\u308c\u3066\u3044\u308b\u306e\u3067\u3001\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306eRakefile\u306eframeworks\u306b 'CoreLocation' \u3068 'CoreBluetooth' \u3092\u8ffd\u52a0\u3057\u307e\u3059\u3002\n\n```ruby:Rakefile\n# -*- coding: utf-8 -*-\n$:.unshift(\"/Library/RubyMotion/lib\")\nrequire 'motion/project/template/ios'\n\nbegin\n  require 'bundler'\n  Bundler.require\nrescue LoadError\nend\n\nMotion::Project::App.setup do |app|\n  # Use `rake config' to see complete project settings.\n  app.name = 'HelloBeacon'\n  app.frameworks += %w(CoreLocation CoreBluetooth)\nend\n```\n\n\u4ee5\u4e0a\u3067iBeacon\u306b\u5bfe\u5fdc\u3057\u305f\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306e\u6e96\u5099\u304c\u3067\u304d\u307e\u3057\u305f\u3002\u305d\u308c\u3067\u306f\u3001\u5b9f\u969b\u306biBeacon\u306e\u3084\u308a\u3068\u308a\u3092\u304a\u3053\u306a\u3063\u3066\u307f\u307e\u3057\u3087\u3046\u3002\n\n## iBeacon\u306e\u767a\u4fe1\u3092\u304a\u3053\u306a\u3046\n\n\u5b9f\u969b\u306b\u5e97\u8217\u7b49\u3067\u904b\u7528\u3059\u308b\u5834\u5408\u306f\u30dc\u30bf\u30f3\u96fb\u6c60\u306a\u3069\u3067\u52d5\u4f5c\u3059\u308b\u5b89\u4fa1\u306a\u5c02\u7528\u6a5f\u5668\u3092\u767a\u4fe1\u306b\u4f7f\u3046\u3053\u3068\u304c\u591a\u3044\u3068\u601d\u3044\u307e\u3059\u304c\u3001iOS\u30c7\u30d0\u30a4\u30b9\u81ea\u4f53\u3092\u767a\u4fe1\u306b\u5229\u7528\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\u5c02\u7528\u6a5f\u5668\u3092\u7528\u610f\u3059\u308b\u306e\u306f\u6577\u5c45\u304c\u9ad8\u3044\u3068\u601d\u3046\u306e\u3067\u3001iBeacon\u306e\u52d5\u4f5c\u78ba\u8a8d\u306a\u3069\u306b\u306f\u624b\u6301\u3061\u306eiOS\u7aef\u672b\u3092\u4f7f\u3046\u3068\u826f\u3044\u3067\u3057\u3087\u3046\u3002\n\n\u5b9f\u969b\u306b\u767a\u4fe1\u3092\u304a\u3053\u306a\u3046\u30b3\u30fc\u30c9\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\n\n```ruby:\n# -*- coding: utf-8 -*-\nclass HomeViewController < UIViewController\n  UUID = NSUUID.alloc.initWithUUIDString(\"YOUR_UUID_HERE\")\n\n  def viewDidLoad\n    super\n    view.backgroundColor = UIColor.whiteColor\n\n    @region = CLBeaconRegion.alloc.initWithProximityUUID(UUID, major: 1,\n                                                               minor: 2,\n                                                               identifier: \"com.example.region\")\n    @manager = CBPeripheralManager.alloc.initWithDelegate(self, queue: Dispatch::Queue.main.dispatch_object)\n  end\n\n  def peripheralManagerDidUpdateState(peripheral)\n    if peripheral.state == CBPeripheralManagerStatePoweredOn\n      @manager.startAdvertising @region.peripheralDataWithMeasuredPower(nil)\n    end\n  end\nend\n```\n\n\u3053\u306e\u30b3\u30fc\u30c9\u3067\u30dd\u30a4\u30f3\u30c8\u306f\u4e0b\u8a18\u306e\u90e8\u5206\u3067\u3059\u3002\n\n```ruby:\nCLBeaconRegion.alloc.initWithProximityUUID(UUID, major: 1,\n                                                 minor: 2,\n                                                 identifier: \"com.example.region\")\n```\n\nUUID\u306f\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3084\u30b5\u30fc\u30d3\u30b9\u3092\u8b58\u5225\u3059\u308b\u305f\u3081\u306e128-bit\u306e\u8b58\u5225\u5b50\u3067\u3059\u3002\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u306f\u6c7a\u307e\u3063\u3066\u3044\u3066\u3001\u30b0\u30ed\u30fc\u30d0\u30eb\u306b\u30e6\u30cb\u30fc\u30af\u3067\u3042\u308b\u5fc5\u8981\u304c\u3042\u308b\u306e\u3067\u3001Mac\u306e `uuidgen` \u30b3\u30de\u30f3\u30c9\u3067\u751f\u6210\u3059\u308b\u306e\u304c\u826f\u3044\u3067\u3059\u3002\n\nmajor/minor\u306f16\u30d3\u30c3\u30c8\u306e\u4efb\u610f\u306e\u756a\u53f7\u3092\u4f7f\u7528\u3067\u304d\u307e\u3059\u3002\u4f8b\u3048\u3070\u5c0f\u58f2\u5e97\u3067\u5229\u7528\u3059\u308b\u30a2\u30d7\u30ea\u3067\u3042\u308c\u3070\u3001\u5e97\u8217\u6bce\u306bmajor\u3092\u3001\u58f2\u308a\u5834\u6bce\u306bminor\u3092\u4f7f\u3044\u5206\u3051\u308b\u3068\u3044\u3046\u306e\u304c\u5178\u578b\u7684\u306a\u4f7f\u3044\u65b9\u3067\u3059\u3002\n\n## iBeacon\u306e\u53d7\u4fe1\u3092\u304a\u3053\u306a\u3046\n\niBeacon\u306e\u53d7\u4fe1\u306fGPS\u4f4d\u7f6e\u60c5\u5831\u306e\u53d7\u4fe1\u7b49\u3092\u304a\u3053\u306a\u3046CLLocationManager\u3092\u901a\u3058\u3066\u304a\u3053\u306a\u3044\u307e\u3059\u3002\u5b9f\u969b\u306e\u30b3\u30fc\u30c9\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\n\n```ruby:\n# -*- coding: utf-8 -*-\nclass BeaconViewController < UIViewController\n  UUID = NSUUID.alloc.initWithUUIDString(\"YOUR_UUID_HERE\")\n\n  def viewDidLoad\n    super\n\n    self.view.backgroundColor = UIColor.whiteColor\n\n    @label = UILabel.alloc.init\n    @label.textAlignment = NSTextAlignmentCenter\n    @label.text = \"Waiting...\"\n    @label.frame = [[0, 100], [320, 100]]\n    self.view.addSubview(@label)\n\n    region = CLBeaconRegion.alloc.initWithProximityUUID(UUID, identifier: \"com.example.region\")\n\n    @manager = CLLocationManager.alloc.init\n    @manager.delegate = self\n    @manager.startMonitoringForRegion(region)\n  end\n\n  def locationManager(manager, didStartMonitoringForRegion: region)\n    manager.requestStateForRegion(region)\n  end\n\n  def locationManager(manager, didDetermineState: state, forRegion: region)\n    if state == CLRegionStateInside\n      manager.startRangingBeaconsInRegion(region)\n    end\n  end\n\n  def locationManager(manager, didEnterRegion: region)\n    if region.isKindOfClass(CLBeaconRegion)\n      manager.startRangingBeaconsInRegion(region)\n    end\n  end\n\n  def locationManager(manager, didExitRegion: region)\n    if region.isKindOfClass(CLBeaconRegion)\n      manager.stopRangingBeaconsInRegion(region)\n    end\n  end\n\n  def locationManager(manager, didRangeBeacons: beacons, inRegion: region)\n    beacon = beacons.last\n\n    if beacon\n      proximity = case beacon.proximity\n                  when CLProximityUnknown\n                    \"Unknown\"\n                  when CLProximityFar\n                    \"Far\"\n                  when CLProximityNear\n                    \"Near\"\n                  when CLProximityImmediate\n                    \"Immediate\"\n                  else\n                    \"Nothing\"\n                  end\n      @label.text = \"#{proximity}: #{beacon.major}-#{beacon.minor}\"\n    end\n  end\nend\n```\n\n\u5c11\u3057\u9577\u3044\u306e\u3067\u9806\u3092\u8ffd\u3063\u3066\u30dd\u30a4\u30f3\u30c8\u3092\u898b\u3066\u3044\u304d\u307e\u3057\u3087\u3046\u3002\n\n```ruby\nregion = CLBeaconRegion.alloc.initWithProximityUUID(UUID, identifier: \"com.example.region\")\n```\n\n\u767a\u4fe1\u5074\u306e\u30ea\u30fc\u30b8\u30e7\u30f3\u3067\u306fUUID\u3068major/minor\u3092\u6307\u5b9a\u3057\u3066\u3044\u307e\u3057\u305f\u304c\u3001\u53d7\u4fe1\u5074\u306e\u30ea\u30fc\u30b8\u30e7\u30f3\u3067\u306f\u6307\u5b9a\u3057\u3066\u3044\u307e\u305b\u3093\u3002\u3053\u308c\u306f\u767a\u4fe1\u5074\u3092\u5e97\u8217\u306b\u636e\u3048\u4ed8\u3051\u3089\u308c\u305f\u5c02\u7528\u6a5f\u5668\u3001\u53d7\u4fe1\u5074\u3092\u9867\u5ba2\u304c\u3082\u3064iPhone\u306b\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u305f\u30a2\u30d7\u30ea\u3068\u3044\u3046\u5178\u578b\u7684\u306a\u30e6\u30fc\u30b9\u30b1\u30fc\u30b9\u3092\u60f3\u5b9a\u3057\u3066\u3044\u307e\u3059\u3002\u3082\u3061\u308d\u3093\u3001\u53d7\u4fe1\u5074\u3067\u3082major/minor\u3092\u6307\u5b9a\u3059\u308b\u3053\u3068\u306f\u53ef\u80fd\u3067\u3059\u3002\n\n```ruby\n@manager = CLLocationManager.alloc.init\n@manager.delegate = self\n@manager.startMonitoringForRegion(region)\n```\n\nCLLocationManager\u306e\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u751f\u6210\u3057\u3066\u3001\u81ea\u5206\u81ea\u8eab\u3092delegate\u306b\u8a2d\u5b9a\u3057\u3001\u6700\u5f8c\u306bstartMonitoringForRegion\u3067iBeacon\u306e\u30ea\u30fc\u30b8\u30e7\u30f3\u76e3\u8996\u306e\u958b\u59cb\u3092\u8981\u6c42\u3057\u3066\u3044\u307e\u3059\u3002\n\n```ruby\ndef locationManager(manager, didStartMonitoringForRegion: region)\n  manager.requestStateForRegion(region)\nend\n```\n\n\u30ea\u30fc\u30b8\u30e7\u30f3\u306e\u76e3\u8996\u304c\u958b\u59cb\u3055\u308c\u305f\u30bf\u30a4\u30df\u30f3\u30b0\u3067 requestStateForRegion \u3092\u547c\u3073\u3001\u958b\u59cb\u6642\u306e\u30b9\u30c6\u30fc\u30c8\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\n\n```ruby\ndef locationManager(manager, didDetermineState: state, forRegion: region)\n  if state == CLRegionStateInside\n    manager.startRangingBeaconsInRegion(region)\n  end\nend\n```\n\n\u958b\u59cb\u6642\u306b\u9818\u57df\u5185\u306b\u3044\u308b\u5834\u5408\u306f\u30ec\u30f3\u30b8\u30f3\u30b0\uff08\u8ddd\u96e2\u6e2c\u5b9a\uff09\u306e\u958b\u59cb\u3092\u8981\u6c42\u3057\u307e\u3059\u3002\n\n```ruby\ndef locationManager(manager, didEnterRegion: region)\n  if region.isKindOfClass(CLBeaconRegion)\n    manager.startRangingBeaconsInRegion(region)\n  end\nend\n\ndef locationManager(manager, didExitRegion: region)\n  if region.isKindOfClass(CLBeaconRegion)\n    manager.stopRangingBeaconsInRegion(region)\n  end\nend\n```\n\n\u9818\u57df\u306e\u5185\u306b\u5165\u3063\u305f\u5834\u5408\u3001\u9818\u57df\u306e\u5916\u306b\u51fa\u305f\u5834\u5408\u306edelegate\u3067\u305d\u308c\u305e\u308c\u30ec\u30f3\u30b8\u30f3\u30b0\u306e\u958b\u59cb\u3068\u7d42\u4e86\u3092\u8981\u6c42\u3057\u307e\u3059\u3002\n\n```ruby\ndef locationManager(manager, didRangeBeacons: beacons, inRegion: region)\n  beacon = beacons.last\n\n  if beacon\n    ...\n    @label.text = \"#{proximity}: #{beacon.major}-#{beacon.minor}\"\n  end\nend\n```\n\n\u30ec\u30f3\u30b8\u30f3\u30b0\u306e\u7d50\u679c\u3092delegate\u3067\u53d7\u3051\u53d6\u3063\u3066label\u306b\u8868\u793a\u3057\u3066\u3044\u307e\u3059\u3002beacon\u306fCLBeacon\u30af\u30e9\u30b9\u306e\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3067\u3059\u3002CLBeacon\u304b\u3089\u306fmajor/minor\u306e\u4ed6\u3001proximity(\u767a\u4fe1\u5074\u3068\u306e\u304a\u304a\u3088\u305d\u306e\u8fd1\u63a5\u95a2\u4fc2)\u3001accuracy(\u7cbe\u5ea6)\u3001rssi(\u96fb\u6ce2\u5f37\u5ea6)\u306a\u3069\u304c\u53d6\u5f97\u3067\u304d\u307e\u3059\u3002\n\n\u5b9f\u969b\u306e\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3067\u306fmajor/minor\u3092\u5224\u5225\u3057\u3066\u51e6\u7406\u3092\u5206\u5c90\u3055\u305b\u305f\u308a\u3001\u30b5\u30fc\u30d0\u30fc\u30b5\u30a4\u30c9\u306bmajor/minor\u3092\u9001\u4fe1\u3059\u308b\u3088\u3046\u306a\u4f7f\u3044\u65b9\u306b\u306a\u308b\u3068\u601d\u3044\u307e\u3059\u3002\u307e\u305f\u3001proximity\u3084rssi\u306f\u96fb\u6ce2\u72b6\u6cc1\u306a\u3069\u306e\u74b0\u5883\u306b\u5de6\u53f3\u3055\u308c\u3066\u7cbe\u5ea6\u306f\u3042\u307e\u308a\u9ad8\u304f\u306a\u3044\u306e\u3067\u6d3b\u7528\u306b\u306f\u6ce8\u610f\u304c\u5fc5\u8981\u306a\u3088\u3046\u3067\u3059\u3002\n\n## \u307e\u3068\u3081\n\nRubyMotion\u306fiOS\u306e\u8584\u3044Wrapper\u306a\u306e\u3067\u3001iBeacon\u306e\u3088\u3046\u306a\u6700\u65b0\u306eOS\u306e\u6a5f\u80fd\u3082Objective-C\u3067\u958b\u767a\u3059\u308b\u306e\u3068\u5909\u308a\u306a\u304f\u5b9f\u88c5\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3057\u305f\u304c\u3001\u3053\u306e\u307e\u307e\u3067\u306f\u3042\u307e\u308aRubyMotion\u3063\u307d\u304f\u306a\u3044\u3067\u3059\u306d\u3002\n\nRubyMotion\u7528\u306eiBeacon Wrapper\u30e9\u30a4\u30d6\u30e9\u30ea\u304c\u767b\u5834\u3059\u308c\u3070\u4e00\u6c17\u306b\u4fbf\u5229\u306b\u306a\u308a\u305d\u3046\u306a\u306e\u3067\u3001\u8ab0\u304b\u66f8\u304b\u306a\u3044\u3067\u3059\u304b\u306d\u3047\uff08\u304a\u524d\u304c\u66f8\u3051\uff1f\uff09\n"}