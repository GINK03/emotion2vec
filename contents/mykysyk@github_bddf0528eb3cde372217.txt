{"tags": ["ModSecurity2.6.8", "CentOS5.9", "Apache2.2.25", "OWASP_CRS2.2.5"], "context": " More than 1 year has passed since last update.\n\npcre-devel libxml2-devel \u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\nyum install pcre-devel libxml2-devel\n\n\napache\u306e\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\ncd /usr/local/src\nwget http://ftp.jaist.ac.jp/pub/apache//httpd/httpd-2.2.25.tar.gz\ntar zxvf httpd-2.2.25.tar.gz\n\n\nmod_unique_id \u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\ncd /usr/local/src/httpd-2.2.25/modules/metadata\n/usr/local/apache2/bin/apxs -cia mod_unique_id.c && echo OK\n\n\napr \u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\ncd /usr/local/src/httpd-2.2.25/srclib/apr\n./configure && make && make install && echo OK\n\n\napr-util \u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\ncd /usr/local/src/httpd-2.2.25/srclib/apr-util\n./configure --with-apr=/usr/local/apr/bin/apr-1-config && \\\nmake && make install && echo OK\n\n\napache \u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n./configure \\\n--enable-so \\\n--enable-rewrite \\\n--enable-mods-shared=\"unique_id\" \\\n--with-pcre \\\n--with-apr=/usr/local/apr/bin/apr-1-config \\\n--with-apr-util=/usr/local/apr/bin/apu-1-config \\\n--prefix=/usr/local/apache2 && \\\nmake && make install && echo OK\n\n\napache \u518d\u69cb\u7bc9\u306e\u5834\u5408\u524d\u56de\u306e\u30b3\u30f3\u30d1\u30a4\u30eb\u30aa\u30d7\u30b7\u30e7\u30f3\u306e\u78ba\u8a8d\u65b9\u6cd5\n/usr/local/src/httpd-2.2.xx/config.status --version\n\n\nmodsecurity \u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n2.7\u7cfb\u6700\u65b0\u3092\u4f7f\u3046\u3068libxml2\u304c2.6.29\u3067\u306a\u3044\u3068\u3060\u3081\u3060\u3068\u3044\u308f\u308c\u308b\u3002\nCentOS 5.x \u6a19\u6e96\u306elibxml2\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u306f2.6.26\u306e\u305f\u30812.6\u7cfb\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3057\u3066\u304f\u308b\u3002\ncd /usr/local/src/\nwget http://sourceforge.net/projects/mod-security/files/modsecurity-apache/2.6.8/modsecurity-apache_2.6.8.tar.gz/download\ntar zxvf modsecurity-apache_2.6.8.tar.gz\ncd modsecurity-apache_2.6.8\n./configure\n--prefix=/usr/local/apache2 \\\n--with-apxs=/usr/local/apache2/bin/apxs \\\n--with-apr=/usr/local/apache2/bin/apr-1-config \\\n--with-apu=/usr/local/apache/bin/apu-1-config \\\n--with-pcre=/usr/bin/pcre-config \\\n--with-libxml=/usr/bin/xml2-config \\\n--enable-pcre-match-limit=90000 \\\n--enable-pcre-match-limit-recursion=90000 \\\nLDFLAGS=-L/usr/local/apache2/lib\n\napache\u306e\u30a8\u30e9\u30fc\u30ed\u30b0\u306b\u300cExecution error - PCRE limits exceeded (-8)\u300d\u3068\u30a8\u30e9\u30fc\u3092\u5410\u304b\u308c\u305f\u306e\u3067\nhttp://forum.parallels.com/showthread.php?99430-ModSecurity-Rule-execution-error-PCRE-limits-exceeded\n\u3092\u53c2\u8003\u306b\u3057\u305f\u3002\n\nCRS\n\u6700\u65b0\u7248\u306eCRS\u3092\u4f7f\u3046\u3068\u300cError parsing actions: Unknown action: ver\u300d\u3068\u6012\u3089\u308c\u308b\u306e\u3067\uff562.2.5\u3092\u63a2\u3057\u3066\u304f\u308b\u3002\n\u53c2\u8003\uff1ahttp://sourceforge.net/mailarchive/message.php?msg_id=29864155\n\nCRS\u306e\u8a2d\u7f6e\ncd /usr/local/src/\nwget https://github.com/SpiderLabs/owasp-modsecurity-crs/tarball/v2.2.5\nmkdir -p /usr/local/apache2/conf/modsecurity\ntar zxvf SpiderLabs-owasp-modsecurity-crs-v2.2.5-0-g28e4ec8.tar.gz\ncd SpiderLabs-owasp-modsecurity-crs-5c28b52\ncp -av base_rules/* /usr/local/apache2/conf/modsecurity/\n\n\u65e5\u672c\u8a9e\u3092GET/POST\u3059\u308b\u3068\u653b\u6483\u6271\u3044\u306b\u306a\u308b\u306e\u3067\u30ea\u30b9\u30c8\u304b\u3089\u5916\u3059\ndiff -u modsecurity_crs_41_sql_injection_attacks.conf.org modsecurity_crs_41_sql_injection_attacks.conf\n--- modsecurity_crs_41_sql_injection_attacks.conf.org   2012-09-19 22:24:02.000000000 +0900\n+++ modsecurity_crs_41_sql_injection_attacks.conf       2013-09-01 02:08:29.000000000 +0900\n@@ -152,7 +152,7 @@\n #\n # This rule attempts to identify when multiple (4 or more) non-word characters are repeated in sequence\n #\n-SecRule ARGS \"\\W{4,}\" \"phase:2,capture,t:none,t:urlDecodeUni,block,id:'960024',rev:'2.2.5',msg:'SQL Character Anomaly Detection Alert - Repetative Non-Word Characters',logdata:'%{tx.0}',setvar:tx.anomaly_score=+%{tx.warning_anomaly_score},setvar:tx.sql_injection_score=+1,setvar:'tx.msg=%{rule.msg}',setvar:tx.%{rule.id}-WEB_ATTACK/RESTRICTED_SQL_CHARS-%{matched_var_name}=%{tx.0}\"\n+#SecRule ARGS \"\\W{4,}\" \"phase:2,capture,t:none,t:urlDecodeUni,block,id:'960024',rev:'2.2.5',msg:'SQL Character Anomaly Detection Alert - Repetative Non-Word Characters',logdata:'%{tx.0}',setvar:tx.anomaly_score=+%{tx.warning_anomaly_score},setvar:tx.sql_injection_score=+1,setvar:'tx.msg=%{rule.msg}',setvar:tx.%{rule.id}-WEB_ATTACK/RESTRICTED_SQL_CHARS-%{matched_var_name}=%{tx.0}\"\n\n\napache\u306e\u8a2d\u5b9a\nvi /usr/local/apache2/conf/httpd.conf\n\nhttpd.conf\u306b\u8ffd\u8a18\u3059\u308b\n\nhttpd.conf\n#----------------------------------------------------------\n# ModSecurity\n#----------------------------------------------------------\nLoadModule security2_module modules/mod_security2.so\nLoadFile   /usr/lib64/libxml2.so\n\n<IfModule mod_security2.c>\n\n    #----------------------------------------------------------\n    # \u30e1\u30a4\u30f3\n    #----------------------------------------------------------\n    #--- \u53c2\u8003: https://github.com/SpiderLabs/ModSecurity/wiki/Reference-Manual\n    #--- \u53c2\u8003: http://open-groove.net/category/modsecurity/\n\n    #--- \u52d5\u4f5c\u30e2\u30fc\u30c9\n    # (On:\u906e\u65ad, Off:\u7121\u52b9, DetectionOnly:\u691c\u77e5\u306e\u307f)\n    SecRuleEngine On\n    #SecRuleEngine DetectionOnly\n\n    #--- \u30c7\u30d5\u30a9\u30eb\u30c8\u30a2\u30af\u30b7\u30e7\u30f3\n    # (\u691c\u51fa\u30d1\u30bf\u30fc\u30f3\u306b\u5408\u81f4\u3057\u305f\u3068\u304d\u306e\u52d5\u4f5c\u3092\u5b9a\u7fa9)\n    # phase\n    #   1.Request headers   (REQUEST_HEADERS)\n    #   2.Request body      (REQUEST_BODY)\n    #   3.Response headers  (RESPONSE_HEADERS)\n    #   4.Response body     (RESPONSE_BODY)\n    #   5.Logging           (LOGGING)\n    SecDefaultAction \"phase:2,deny,log,status:406\"\n\n    #--- \u30c6\u30f3\u30dd\u30e9\u30ea\u30d5\u30a1\u30a4\u30eb\u683c\u7d0d\u5148\n    SecTmpDir /tmp/\n\n    #--- \u6c38\u7d9a\u7684\u30c7\u30fc\u30bf\u306e\u683c\u7d0d\u5148\n    SecDataDir /tmp/\n\n    #--- \u30ea\u30af\u30a8\u30b9\u30c8\u30dc\u30c7\u30a3\u306e\u30d0\u30c3\u30d5\u30a1\u30ea\u30f3\u30b0\u6307\u793a\n    SecRequestBodyAccess On\n    #--- \u6700\u5927\u30ea\u30af\u30a8\u30b9\u30c8\u30dc\u30c7\u30a3\u30b5\u30a4\u30ba\u3092\u6307\u5b9a\n    SecRequestBodyLimit 13107200\n    #--- \u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u30d5\u30a1\u30a4\u30eb\u30b5\u30a4\u30ba\u3092\u9664\u3044\u305f\u6700\u5927\u30ea\u30af\u30a8\u30b9\u30c8\u30dc\u30c7\u30a3\u30b5\u30a4\u30ba\n    SecRequestBodyNoFilesLimit 131072\n    #--- \u6700\u5927\u30e1\u30e2\u30ea\u30d0\u30c3\u30d5\u30a1\u30b5\u30a4\u30ba\n    SecRequestBodyInMemoryLimit 131072\n    #--- \u30ea\u30df\u30c3\u30c8\u6642\u306e\u52d5\u4f5c\n    SecRequestBodyLimitAction Reject\n\n    #----------------------------------------------------------\n    # \u30eb\u30fc\u30eb\n    #----------------------------------------------------------\n    # SecRule VARIABLES OPERATOR [ACTIONS]\n    # VARIABLES : \u30c1\u30a7\u30c3\u30af\u3092\u5b9f\u884c\u3059\u308b\u5909\u6570\u3092\u6307\u5b9a\n    # OPERATOR  : \u30d5\u30a3\u30eb\u30bf\u30ea\u30f3\u30b0\u30eb\u30fc\u30eb\u3092\u8a18\u8ff0\n    #   @rx         : \u6b63\u898f\u8868\u73fe\u306b\u3088\u308b\u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0\n    #   @pm         : \u30d1\u30e9\u30ec\u30eb\u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0\n    #   @pmFromFile : \u5bfe\u8c61\u6587\u5b66\u5217\u3092\u30ea\u30b9\u30c8\u5316\u3057\u305f\u30d5\u30a1\u30a4\u30eb\u3092\u5bfe\u8c61\u306b\u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0\n    #   @@beginsWith: \u5bfe\u8c61\u6587\u5b66\u5217\u306e\u59cb\u307e\u308a\u306b\u304a\u3044\u3066\u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0\n    #   @contains   : \u5bfe\u8c61\u6587\u5b66\u5217\u306e\u5168\u4f53\u304b\u3089\u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0\n    #   @endWith    : \u5bfe\u8c61\u6587\u5b66\u5217\u306e\u7d42\u308f\u308a\u306b\u304a\u3044\u3066\u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0\n    #   @streq      : \u5bfe\u8c61\u6587\u5b66\u5217\u304c\u5b8c\u5168\u4e00\u81f4\u3057\u3066\u3044\u308b\u304b\u3069\u3046\u304b\u3092\u30c1\u30a7\u30c3\u30af\n    #   @within     : \u6307\u5b9a\u3057\u305f\u7bc4\u56f2\u5185\u3067\u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0\n    # ACTIONS  : \u30eb\u30fc\u30eb\u306b\u30de\u30c3\u30c1\u3057\u305f\u5834\u5408\u306e\u30a2\u30af\u30b7\u30e7\u30f3\u3092\u6307\u793a\n    SecRule \\\n     REQUEST_HEADERS:Content-Type \\\n     \"text/xml\" \\\n     \"id:'200000',phase:1,t:none,t:lowercase,pass,nolog,ctl:requestBodyProcessor=XML\"\n\n    Include /usr/local/apache2/conf/modsecurity/modsecurity_crs_41_sql_injection_attacks.conf\n\n    #----------------------------------------------------------\n    # \u30ed\u30b0\n    #----------------------------------------------------------\n    #--- \u76e3\u67fb\u30ed\u30b0\u306e\u52d5\u4f5c\u30e2\u30fc\u30c9\n    # (On:\u3059\u3079\u3066\u8a18\u9332, Off:\u7121\u52b9, RelevantOnly:SecAuditLogRelevantStatus\u306b\u5408\u81f4\u3057\u305f\u30b9\u30c6\u30fc\u30bf\u30b9\u30b3\u30fc\u30c9\u306e\u307f\u3092\u8a18\u9332)\n    SecAuditEngine  On\n\n    #---\u76e3\u67fb\u30ed\u30b0\u306e\u8a18\u9332\u5bfe\u8c61\u3068\u3059\u308b\u30b5\u30fc\u30d0\u5fdc\u7b54\u30b3\u30fc\u30c9\n    # (SecAuditEngine \u304c RelevantOnly)\n    SecAuditLogRelevantStatus \"^(?:5|4(?!04))\"\n\n    #--- \u76e3\u67fb\u30ed\u30b0\u306e\u51fa\u529b\u30bf\u30a4\u30d7\n    # (Serial:1\u30d5\u30a1\u30a4\u30eb\u306b\u8a18\u8f09, Concurrent:\u30bb\u30c3\u30b7\u30e7\u30f3\u6bce\u306b\u500b\u5225\u30d5\u30a1\u30a4\u30eb\u3092\u751f\u6210)\n    SecAuditLogType Serial\n\n    #--- \u76e3\u67fb\u30ed\u30b0\u306e\u51fa\u529b\u5834\u6240\n    SecAuditLog     /var/log/modsecurity.log\n\n    #--- \u76e3\u67fb\u30ed\u30b0\u306e\u51fa\u529b\u9805\u76ee\n    #   A:AuditLog \u30d8\u30c3\u30c0\u30fc\n    #   B:\u30ea\u30af\u30a8\u30b9\u30c8\u30d8\u30c3\u30c0\u30fc\n    #   C:\u30ea\u30af\u30a8\u30b9\u30c8\u30dc\u30c7\u30a3\n    #   D:Reserved\n    #   E:\u30ec\u30b9\u30dd\u30f3\u30b9\u30dc\u30c7\u30a3\n    #   F:\u30ec\u30b9\u30dd\u30f3\u30b9\u30d8\u30c3\u30c0\u30fc\n    #   G:Reserved\n    #   H:\u8ffd\u52a0\u60c5\u5831\u3002\u30d1\u30bf\u30fc\u30f3\u306b\u30de\u30c3\u30c1\u3057\u305f\u30a2\u30af\u30bb\u30b9\u3060\u3068\u3053\u3053\u306b\u30bf\u30b0\u304c\u4ed8\u4e0e\u3055\u308c\u308b\u3002\n    #   I:\u30d5\u30a1\u30a4\u30eb\u3092\u9664\u5916\u3057\u305f\u3001\u30b3\u30f3\u30d1\u30af\u30c8\u306a\u30ea\u30af\u30a8\u30b9\u30c8\u30dc\u30c7\u30a3\n    #   J:Reserved\n    #   K:\u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3\u306b\u30de\u30c3\u30c1\u3057\u305f\u5168\u3066\u306e\u30eb\u30fc\u30eb\n    #   Z:\u6700\u5f8c\u306e\u5883\u754c\u7dda\n    SecAuditLogParts \"ABIFHKZ\"\n\n    #----------------------------------------------------------\n    # \u30c7\u30d0\u30c3\u30b0\n    #----------------------------------------------------------\n    #--- \u30c7\u30d0\u30c3\u30b0\u30ed\u30b0\n    SecDebugLog /var/log/modsecurity_debug.log\n\n    #--- \u30c7\u30d0\u30c3\u30b0\u30ed\u30b0\u30ec\u30d9\u30eb\n    #   0:no logging.\n    #   1:errors (intercepted requests) only.\n    #   2:warnings.\n    #   3:notices.\n    #   4:details of how transactions are handled.\n    #   5:as above, but including information about each piece of information handled.\n    #   9:log everything, including very detailed debugging information\n    SecDebugLogLevel 3\n\n</IfModule>\n\n\n\napache\u306e\u518d\u8d77\u52d5\n/usr/local/apache2/bin/apachectl configtest\n/etc/init.d/httpd restart\n\n\u78ba\u8a8d\nwget -S --spider \"http://localhost/?and%201=1;--\"\n\n\u78ba\u8a8d\u7528WEB\u30a2\u30d7\u30ea\n\nsql_injection.php\n\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\">\n<html>\n<head><title>SQL Injection TEST</title></head>\n<body>\n<?php\n#-----------------------------------------------------------\n# SQL\u30a4\u30f3\u30b8\u30a7\u30af\u30b7\u30e7\u30f3\u30c6\u30b9\u30c8\u30af\u30e9\u30b9\n#-----------------------------------------------------------\nclass SQL_INJECTION_TEST{\n\n    var $conn;\n    var $data;\n    var $sql;\n\n    #-----------------------------------------------------------\n    # SQLITE\u306b\u63a5\u7d9a\n    #-----------------------------------------------------------\n    function db_connect(){\n        $dsn = \"sqlite::memory:\";\n        $this->conn = new PDO($dsn);\n    }\n\n    #-----------------------------------------------------------\n    # CREATE TABLE\n    #-----------------------------------------------------------\n    function db_table_check(){\n        $sql         = \"CREATE TABLE IF NOT EXISTS\n                            tablename\n                            (id       INTEGER PRIMARY KEY AUTOINCREMENT,\n                             name     TEXT    UNIQUE,\n                             password TEXT    UNIQUE)\";\n        #--- \u30c6\u30fc\u30d6\u30eb\u4f5c\u6210\n        $stmt = $this->conn->prepare($sql);\n        $stmt->execute();\n        #--- \u521d\u671f\u30c7\u30fc\u30bf\u30fc\u767b\u9332\n        $this->db_insert(\"root\",    \"qwerty\");\n        $this->db_insert(\"yamada\",  \"wD?mZwrcr37n\");\n        $this->db_insert(\"tanaka\",  \"neeAnbH=4k7K\");\n        $this->db_insert(\"sato\",    \"F2s&jQ8eTtwQ\");\n        $this->db_insert(\"yamaguti\",\"y8=bZ7CVkCsd\");\n        $this->db_insert(\"sugimoto\",\"t7mRPZ&3fVsE\");\n        $this->db_insert(\"oda\",     \"7zU4@LYPyJmw\");\n    }\n\n    #-----------------------------------------------------------\n    # INSERT\n    #-----------------------------------------------------------\n    function db_insert($name, $password){\n        $sql = \"INSERT INTO tablename (name, password) VALUES ('{$name}', '{$password}')\";\n        if ($name){\n            $stmt = $this->conn->prepare($sql);\n            $flag = $stmt->execute();\n        }else{\n            echo \"INSERT FALSE\";\n        }\n    }\n\n    #-----------------------------------------------------------\n    # SELECT\n    #-----------------------------------------------------------\n    function db_select($select_sql){\n\n        $stmt = $this->conn->prepare($select_sql);\n        $stmt->execute();\n        echo \"<table border=\\\"1\\\" rules=\\\"all\\\">\";\n        echo \"<tr><th>ID</th><th>NAME</th><th>PASSWORD</th></tr>\";\n        while ($row = $stmt->fetch()) {\n            echo \"<tr>\";\n            echo \"<td>\".$row[\"id\"]   . \"</td>\";\n            echo \"<td>\".$row[\"name\"] . \"</td>\";\n            echo \"<td>\".$row[\"password\"] . \"</td>\";\n            echo \"</tr>\";\n        };\n        echo \"</table>\";\n    }\n\n    #-----------------------------------------------------------\n    # \u30de\u30b8\u30c3\u30af\u30af\u30aa\u30fc\u30c8 Off\n    #-----------------------------------------------------------\n    function magic_quotes_off($str) {\n        if (get_magic_quotes_gpc()) {\n            return stripslashes($str);\n        }else{\n            return $str;\n        }\n    }\n\n    #-----------------------------------------------------------\n    # POST/GET \u30c7\u30fc\u30bf\u30fc\u304b\u3089SQL\u3092\u751f\u6210\n    #-----------------------------------------------------------\n    function set_data($post_data='', $get_data=''){\n        if ($post_data != ''){\n            $data = $post_data;\n        }\n        if ($get_data != ''){\n            $data = $get_data;\n        }\n        $this->data =  $this->magic_quotes_off($data);\n        $this->sql  = \"SELECT id, name, password FROM tablename WHERE password = '{$this->data}'\";\n    }\n\n    #-----------------------------------------------------------\n    # POST/GET \u30c7\u30fc\u30bf\u30fc\u3092\u51fa\u529b\n    #-----------------------------------------------------------\n    function get_data(){\n        return $this->data;\n    }\n\n    #-----------------------------------------------------------\n    # POST/GET \u30c7\u30fc\u30bf\u30fc\u304b\u3089SQL\u3092\u751f\u6210\u3055\u308c\u305f\u3082\u306e\u3092\u51fa\u529b\n    #-----------------------------------------------------------\n    function get_sql(){\n        return $this->sql;\n    }\n\n    #-----------------------------------------------------------\n    # POST/GET \u30c7\u30fc\u30bf\u30fc\u304b\u3089SQL\u3092\u5b9f\u884c\n    #-----------------------------------------------------------\n    function get_injection(){\n            $this->db_select($this->sql);\n        #if ($this->data){\n        #    $this->db_select($this->sql);\n        #}else{\n        #    echo \"POST/GET Data None <br />\";\n        #}\n    }\n}\n?>\n\n<hr>\u30d1\u30b9\u30ef\u30fc\u30c9\u5165\u529b<br />\n<br />\n<form action=\"?\" method=\"post\">\nPASSWORD:<input type=\"text\" name=\"data\" size=\"20\" value=\"\">\n<input type=\"submit\" value=\"\u30ed\u30b0\u30a4\u30f3(POST)\">\n</form>\n<form action=\"?\" method=\"get\">\nPASSWORD:<input type=\"text\" name=\"data\" size=\"20\" value=\"\">\n<input type=\"submit\" value=\"\u30ed\u30b0\u30a4\u30f3(GET)\">\n</form>\nSQL\u30a4\u30f3\u30b8\u30a7\u30af\u30b7\u30e7\u30f3\u30b3\u30fc\u30c9\u300c' OR 'A' = 'A' --\u300d\n<hr>\n\n<?php\n$post_data  = $_POST['data'];\n$get_data   = $_GET['data'];\n$hoge       = new SQL_INJECTION_TEST();\n$hoge->db_connect();\n$hoge->db_table_check();\n$hoge->set_data($post_data, $get_data);\necho \"\uff5e\uff5e\u7d50\u679c\uff5e\uff5e<br />\";\necho \"\u767a\u884c\u3057\u305fSQL : \" . $hoge->get_sql()  . \"<br />\";\n$hoge->get_injection();\necho \"<hr>\uff5e\uff5e\u767b\u9332\u5168\u30c7\u30fc\u30bf\u30fc\uff5e\uff5e<br />\";\necho \"\u767a\u884c\u3057\u305fSQL : SELECT id, name, password FROM tablename<br />\";\n$hoge->db_select(\"SELECT id, name, password FROM tablename\");\n\n\n\n\u53c2\u8003\nhttp://www.modsecurity.org/\nhttp://dev.classmethod.jp/cloud/aws/ec2-amazon-linux-waf-modsecurity-install/\nhttp://www.ipa.go.jp/files/000017312.pdf\n## pcre-devel libxml2-devel \u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n```shell-session:\nyum install pcre-devel libxml2-devel\n```\n\n## apache\u306e\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\n\n```shell-session:\ncd /usr/local/src\nwget http://ftp.jaist.ac.jp/pub/apache//httpd/httpd-2.2.25.tar.gz\ntar zxvf httpd-2.2.25.tar.gz\n```\n## mod_unique_id \u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n```shell-session:\ncd /usr/local/src/httpd-2.2.25/modules/metadata\n/usr/local/apache2/bin/apxs -cia mod_unique_id.c && echo OK\n```\n\n## apr \u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n```shell-session:\ncd /usr/local/src/httpd-2.2.25/srclib/apr\n./configure && make && make install && echo OK\n```\n\n## apr-util \u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n```shell-session:\ncd /usr/local/src/httpd-2.2.25/srclib/apr-util\n./configure --with-apr=/usr/local/apr/bin/apr-1-config && \\\nmake && make install && echo OK\n```\n\n## apache \u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n```shell-session:\n./configure \\\n--enable-so \\\n--enable-rewrite \\\n--enable-mods-shared=\"unique_id\" \\\n--with-pcre \\\n--with-apr=/usr/local/apr/bin/apr-1-config \\\n--with-apr-util=/usr/local/apr/bin/apu-1-config \\\n--prefix=/usr/local/apache2 && \\\nmake && make install && echo OK\n```\n\n### apache \u518d\u69cb\u7bc9\u306e\u5834\u5408\u524d\u56de\u306e\u30b3\u30f3\u30d1\u30a4\u30eb\u30aa\u30d7\u30b7\u30e7\u30f3\u306e\u78ba\u8a8d\u65b9\u6cd5\n\n```shell-session:\n/usr/local/src/httpd-2.2.xx/config.status --version\n```\n\n## modsecurity \u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n2.7\u7cfb\u6700\u65b0\u3092\u4f7f\u3046\u3068libxml2\u304c2.6.29\u3067\u306a\u3044\u3068\u3060\u3081\u3060\u3068\u3044\u308f\u308c\u308b\u3002\nCentOS 5.x \u6a19\u6e96\u306elibxml2\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u306f2.6.26\u306e\u305f\u30812.6\u7cfb\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3057\u3066\u304f\u308b\u3002\n\n```shell-session:\ncd /usr/local/src/\nwget http://sourceforge.net/projects/mod-security/files/modsecurity-apache/2.6.8/modsecurity-apache_2.6.8.tar.gz/download\ntar zxvf modsecurity-apache_2.6.8.tar.gz\ncd modsecurity-apache_2.6.8\n./configure\n--prefix=/usr/local/apache2 \\\n--with-apxs=/usr/local/apache2/bin/apxs \\\n--with-apr=/usr/local/apache2/bin/apr-1-config \\\n--with-apu=/usr/local/apache/bin/apu-1-config \\\n--with-pcre=/usr/bin/pcre-config \\\n--with-libxml=/usr/bin/xml2-config \\\n--enable-pcre-match-limit=90000 \\\n--enable-pcre-match-limit-recursion=90000 \\\nLDFLAGS=-L/usr/local/apache2/lib\n```\napache\u306e\u30a8\u30e9\u30fc\u30ed\u30b0\u306b\u300cExecution error - PCRE limits exceeded (-8)\u300d\u3068\u30a8\u30e9\u30fc\u3092\u5410\u304b\u308c\u305f\u306e\u3067\nhttp://forum.parallels.com/showthread.php?99430-ModSecurity-Rule-execution-error-PCRE-limits-exceeded\n\u3092\u53c2\u8003\u306b\u3057\u305f\u3002\n\n## CRS\n\u6700\u65b0\u7248\u306eCRS\u3092\u4f7f\u3046\u3068\u300cError parsing actions: Unknown action: ver\u300d\u3068\u6012\u3089\u308c\u308b\u306e\u3067\uff562.2.5\u3092\u63a2\u3057\u3066\u304f\u308b\u3002\n\u53c2\u8003\uff1ahttp://sourceforge.net/mailarchive/message.php?msg_id=29864155\n\n### CRS\u306e\u8a2d\u7f6e\n\n```shell-session:\ncd /usr/local/src/\nwget https://github.com/SpiderLabs/owasp-modsecurity-crs/tarball/v2.2.5\nmkdir -p /usr/local/apache2/conf/modsecurity\ntar zxvf SpiderLabs-owasp-modsecurity-crs-v2.2.5-0-g28e4ec8.tar.gz\ncd SpiderLabs-owasp-modsecurity-crs-5c28b52\ncp -av base_rules/* /usr/local/apache2/conf/modsecurity/\n```\n\n\u65e5\u672c\u8a9e\u3092GET/POST\u3059\u308b\u3068\u653b\u6483\u6271\u3044\u306b\u306a\u308b\u306e\u3067\u30ea\u30b9\u30c8\u304b\u3089\u5916\u3059\n\n```shell-session:\ndiff -u modsecurity_crs_41_sql_injection_attacks.conf.org modsecurity_crs_41_sql_injection_attacks.conf\n--- modsecurity_crs_41_sql_injection_attacks.conf.org   2012-09-19 22:24:02.000000000 +0900\n+++ modsecurity_crs_41_sql_injection_attacks.conf       2013-09-01 02:08:29.000000000 +0900\n@@ -152,7 +152,7 @@\n #\n # This rule attempts to identify when multiple (4 or more) non-word characters are repeated in sequence\n #\n-SecRule ARGS \"\\W{4,}\" \"phase:2,capture,t:none,t:urlDecodeUni,block,id:'960024',rev:'2.2.5',msg:'SQL Character Anomaly Detection Alert - Repetative Non-Word Characters',logdata:'%{tx.0}',setvar:tx.anomaly_score=+%{tx.warning_anomaly_score},setvar:tx.sql_injection_score=+1,setvar:'tx.msg=%{rule.msg}',setvar:tx.%{rule.id}-WEB_ATTACK/RESTRICTED_SQL_CHARS-%{matched_var_name}=%{tx.0}\"\n+#SecRule ARGS \"\\W{4,}\" \"phase:2,capture,t:none,t:urlDecodeUni,block,id:'960024',rev:'2.2.5',msg:'SQL Character Anomaly Detection Alert - Repetative Non-Word Characters',logdata:'%{tx.0}',setvar:tx.anomaly_score=+%{tx.warning_anomaly_score},setvar:tx.sql_injection_score=+1,setvar:'tx.msg=%{rule.msg}',setvar:tx.%{rule.id}-WEB_ATTACK/RESTRICTED_SQL_CHARS-%{matched_var_name}=%{tx.0}\"\n```\n\n### apache\u306e\u8a2d\u5b9a\n\n```shell-session:\nvi /usr/local/apache2/conf/httpd.conf\n```\n\nhttpd.conf\u306b\u8ffd\u8a18\u3059\u308b\n\n```shell-session:httpd.conf\n#----------------------------------------------------------\n# ModSecurity\n#----------------------------------------------------------\nLoadModule security2_module modules/mod_security2.so\nLoadFile   /usr/lib64/libxml2.so\n\n<IfModule mod_security2.c>\n\n    #----------------------------------------------------------\n    # \u30e1\u30a4\u30f3\n    #----------------------------------------------------------\n    #--- \u53c2\u8003: https://github.com/SpiderLabs/ModSecurity/wiki/Reference-Manual\n    #--- \u53c2\u8003: http://open-groove.net/category/modsecurity/\n\n    #--- \u52d5\u4f5c\u30e2\u30fc\u30c9\n    # (On:\u906e\u65ad, Off:\u7121\u52b9, DetectionOnly:\u691c\u77e5\u306e\u307f)\n    SecRuleEngine On\n    #SecRuleEngine DetectionOnly\n\n    #--- \u30c7\u30d5\u30a9\u30eb\u30c8\u30a2\u30af\u30b7\u30e7\u30f3\n    # (\u691c\u51fa\u30d1\u30bf\u30fc\u30f3\u306b\u5408\u81f4\u3057\u305f\u3068\u304d\u306e\u52d5\u4f5c\u3092\u5b9a\u7fa9)\n    # phase\n    #   1.Request headers   (REQUEST_HEADERS)\n    #   2.Request body      (REQUEST_BODY)\n    #   3.Response headers  (RESPONSE_HEADERS)\n    #   4.Response body     (RESPONSE_BODY)\n    #   5.Logging           (LOGGING)\n    SecDefaultAction \"phase:2,deny,log,status:406\"\n\n    #--- \u30c6\u30f3\u30dd\u30e9\u30ea\u30d5\u30a1\u30a4\u30eb\u683c\u7d0d\u5148\n    SecTmpDir /tmp/\n\n    #--- \u6c38\u7d9a\u7684\u30c7\u30fc\u30bf\u306e\u683c\u7d0d\u5148\n    SecDataDir /tmp/\n\n    #--- \u30ea\u30af\u30a8\u30b9\u30c8\u30dc\u30c7\u30a3\u306e\u30d0\u30c3\u30d5\u30a1\u30ea\u30f3\u30b0\u6307\u793a\n    SecRequestBodyAccess On\n    #--- \u6700\u5927\u30ea\u30af\u30a8\u30b9\u30c8\u30dc\u30c7\u30a3\u30b5\u30a4\u30ba\u3092\u6307\u5b9a\n    SecRequestBodyLimit 13107200\n    #--- \u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u30d5\u30a1\u30a4\u30eb\u30b5\u30a4\u30ba\u3092\u9664\u3044\u305f\u6700\u5927\u30ea\u30af\u30a8\u30b9\u30c8\u30dc\u30c7\u30a3\u30b5\u30a4\u30ba\n    SecRequestBodyNoFilesLimit 131072\n    #--- \u6700\u5927\u30e1\u30e2\u30ea\u30d0\u30c3\u30d5\u30a1\u30b5\u30a4\u30ba\n    SecRequestBodyInMemoryLimit 131072\n    #--- \u30ea\u30df\u30c3\u30c8\u6642\u306e\u52d5\u4f5c\n    SecRequestBodyLimitAction Reject\n\n    #----------------------------------------------------------\n    # \u30eb\u30fc\u30eb\n    #----------------------------------------------------------\n    # SecRule VARIABLES OPERATOR [ACTIONS]\n    # VARIABLES : \u30c1\u30a7\u30c3\u30af\u3092\u5b9f\u884c\u3059\u308b\u5909\u6570\u3092\u6307\u5b9a\n    # OPERATOR  : \u30d5\u30a3\u30eb\u30bf\u30ea\u30f3\u30b0\u30eb\u30fc\u30eb\u3092\u8a18\u8ff0\n    #   @rx         : \u6b63\u898f\u8868\u73fe\u306b\u3088\u308b\u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0\n    #   @pm         : \u30d1\u30e9\u30ec\u30eb\u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0\n    #   @pmFromFile : \u5bfe\u8c61\u6587\u5b66\u5217\u3092\u30ea\u30b9\u30c8\u5316\u3057\u305f\u30d5\u30a1\u30a4\u30eb\u3092\u5bfe\u8c61\u306b\u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0\n    #   @@beginsWith: \u5bfe\u8c61\u6587\u5b66\u5217\u306e\u59cb\u307e\u308a\u306b\u304a\u3044\u3066\u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0\n    #   @contains   : \u5bfe\u8c61\u6587\u5b66\u5217\u306e\u5168\u4f53\u304b\u3089\u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0\n    #   @endWith    : \u5bfe\u8c61\u6587\u5b66\u5217\u306e\u7d42\u308f\u308a\u306b\u304a\u3044\u3066\u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0\n    #   @streq      : \u5bfe\u8c61\u6587\u5b66\u5217\u304c\u5b8c\u5168\u4e00\u81f4\u3057\u3066\u3044\u308b\u304b\u3069\u3046\u304b\u3092\u30c1\u30a7\u30c3\u30af\n    #   @within     : \u6307\u5b9a\u3057\u305f\u7bc4\u56f2\u5185\u3067\u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0\n    # ACTIONS  : \u30eb\u30fc\u30eb\u306b\u30de\u30c3\u30c1\u3057\u305f\u5834\u5408\u306e\u30a2\u30af\u30b7\u30e7\u30f3\u3092\u6307\u793a\n    SecRule \\\n     REQUEST_HEADERS:Content-Type \\\n     \"text/xml\" \\\n     \"id:'200000',phase:1,t:none,t:lowercase,pass,nolog,ctl:requestBodyProcessor=XML\"\n\n    Include /usr/local/apache2/conf/modsecurity/modsecurity_crs_41_sql_injection_attacks.conf\n\n    #----------------------------------------------------------\n    # \u30ed\u30b0\n    #----------------------------------------------------------\n    #--- \u76e3\u67fb\u30ed\u30b0\u306e\u52d5\u4f5c\u30e2\u30fc\u30c9\n    # (On:\u3059\u3079\u3066\u8a18\u9332, Off:\u7121\u52b9, RelevantOnly:SecAuditLogRelevantStatus\u306b\u5408\u81f4\u3057\u305f\u30b9\u30c6\u30fc\u30bf\u30b9\u30b3\u30fc\u30c9\u306e\u307f\u3092\u8a18\u9332)\n    SecAuditEngine  On\n\n    #---\u76e3\u67fb\u30ed\u30b0\u306e\u8a18\u9332\u5bfe\u8c61\u3068\u3059\u308b\u30b5\u30fc\u30d0\u5fdc\u7b54\u30b3\u30fc\u30c9\n    # (SecAuditEngine \u304c RelevantOnly)\n    SecAuditLogRelevantStatus \"^(?:5|4(?!04))\"\n\n    #--- \u76e3\u67fb\u30ed\u30b0\u306e\u51fa\u529b\u30bf\u30a4\u30d7\n    # (Serial:1\u30d5\u30a1\u30a4\u30eb\u306b\u8a18\u8f09, Concurrent:\u30bb\u30c3\u30b7\u30e7\u30f3\u6bce\u306b\u500b\u5225\u30d5\u30a1\u30a4\u30eb\u3092\u751f\u6210)\n    SecAuditLogType Serial\n\n    #--- \u76e3\u67fb\u30ed\u30b0\u306e\u51fa\u529b\u5834\u6240\n    SecAuditLog     /var/log/modsecurity.log\n\n    #--- \u76e3\u67fb\u30ed\u30b0\u306e\u51fa\u529b\u9805\u76ee\n    #   A:AuditLog \u30d8\u30c3\u30c0\u30fc\n    #   B:\u30ea\u30af\u30a8\u30b9\u30c8\u30d8\u30c3\u30c0\u30fc\n    #   C:\u30ea\u30af\u30a8\u30b9\u30c8\u30dc\u30c7\u30a3\n    #   D:Reserved\n    #   E:\u30ec\u30b9\u30dd\u30f3\u30b9\u30dc\u30c7\u30a3\n    #   F:\u30ec\u30b9\u30dd\u30f3\u30b9\u30d8\u30c3\u30c0\u30fc\n    #   G:Reserved\n    #   H:\u8ffd\u52a0\u60c5\u5831\u3002\u30d1\u30bf\u30fc\u30f3\u306b\u30de\u30c3\u30c1\u3057\u305f\u30a2\u30af\u30bb\u30b9\u3060\u3068\u3053\u3053\u306b\u30bf\u30b0\u304c\u4ed8\u4e0e\u3055\u308c\u308b\u3002\n    #   I:\u30d5\u30a1\u30a4\u30eb\u3092\u9664\u5916\u3057\u305f\u3001\u30b3\u30f3\u30d1\u30af\u30c8\u306a\u30ea\u30af\u30a8\u30b9\u30c8\u30dc\u30c7\u30a3\n    #   J:Reserved\n    #   K:\u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3\u306b\u30de\u30c3\u30c1\u3057\u305f\u5168\u3066\u306e\u30eb\u30fc\u30eb\n    #   Z:\u6700\u5f8c\u306e\u5883\u754c\u7dda\n    SecAuditLogParts \"ABIFHKZ\"\n\n    #----------------------------------------------------------\n    # \u30c7\u30d0\u30c3\u30b0\n    #----------------------------------------------------------\n    #--- \u30c7\u30d0\u30c3\u30b0\u30ed\u30b0\n    SecDebugLog /var/log/modsecurity_debug.log\n\n    #--- \u30c7\u30d0\u30c3\u30b0\u30ed\u30b0\u30ec\u30d9\u30eb\n    #   0:no logging.\n    #   1:errors (intercepted requests) only.\n    #   2:warnings.\n    #   3:notices.\n    #   4:details of how transactions are handled.\n    #   5:as above, but including information about each piece of information handled.\n    #   9:log everything, including very detailed debugging information\n    SecDebugLogLevel 3\n\n</IfModule>\n```\n\n## apache\u306e\u518d\u8d77\u52d5\n/usr/local/apache2/bin/apachectl configtest\n/etc/init.d/httpd restart\n\n\n## \u78ba\u8a8d\n\nwget -S --spider \"http://localhost/?and%201=1;--\"\n\n## \u78ba\u8a8d\u7528WEB\u30a2\u30d7\u30ea\n\n```php:sql_injection.php\n\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\">\n<html>\n<head><title>SQL Injection TEST</title></head>\n<body>\n<?php\n#-----------------------------------------------------------\n# SQL\u30a4\u30f3\u30b8\u30a7\u30af\u30b7\u30e7\u30f3\u30c6\u30b9\u30c8\u30af\u30e9\u30b9\n#-----------------------------------------------------------\nclass SQL_INJECTION_TEST{\n\n    var $conn;\n    var $data;\n    var $sql;\n\n    #-----------------------------------------------------------\n    # SQLITE\u306b\u63a5\u7d9a\n    #-----------------------------------------------------------\n    function db_connect(){\n        $dsn = \"sqlite::memory:\";\n        $this->conn = new PDO($dsn);\n    }\n\n    #-----------------------------------------------------------\n    # CREATE TABLE\n    #-----------------------------------------------------------\n    function db_table_check(){\n        $sql         = \"CREATE TABLE IF NOT EXISTS\n                            tablename\n                            (id       INTEGER PRIMARY KEY AUTOINCREMENT,\n                             name     TEXT    UNIQUE,\n                             password TEXT    UNIQUE)\";\n        #--- \u30c6\u30fc\u30d6\u30eb\u4f5c\u6210\n        $stmt = $this->conn->prepare($sql);\n        $stmt->execute();\n        #--- \u521d\u671f\u30c7\u30fc\u30bf\u30fc\u767b\u9332\n        $this->db_insert(\"root\",    \"qwerty\");\n        $this->db_insert(\"yamada\",  \"wD?mZwrcr37n\");\n        $this->db_insert(\"tanaka\",  \"neeAnbH=4k7K\");\n        $this->db_insert(\"sato\",    \"F2s&jQ8eTtwQ\");\n        $this->db_insert(\"yamaguti\",\"y8=bZ7CVkCsd\");\n        $this->db_insert(\"sugimoto\",\"t7mRPZ&3fVsE\");\n        $this->db_insert(\"oda\",     \"7zU4@LYPyJmw\");\n    }\n\n    #-----------------------------------------------------------\n    # INSERT\n    #-----------------------------------------------------------\n    function db_insert($name, $password){\n        $sql = \"INSERT INTO tablename (name, password) VALUES ('{$name}', '{$password}')\";\n        if ($name){\n            $stmt = $this->conn->prepare($sql);\n            $flag = $stmt->execute();\n        }else{\n            echo \"INSERT FALSE\";\n        }\n    }\n\n    #-----------------------------------------------------------\n    # SELECT\n    #-----------------------------------------------------------\n    function db_select($select_sql){\n\n        $stmt = $this->conn->prepare($select_sql);\n        $stmt->execute();\n        echo \"<table border=\\\"1\\\" rules=\\\"all\\\">\";\n        echo \"<tr><th>ID</th><th>NAME</th><th>PASSWORD</th></tr>\";\n        while ($row = $stmt->fetch()) {\n            echo \"<tr>\";\n            echo \"<td>\".$row[\"id\"]   . \"</td>\";\n            echo \"<td>\".$row[\"name\"] . \"</td>\";\n            echo \"<td>\".$row[\"password\"] . \"</td>\";\n            echo \"</tr>\";\n        };\n        echo \"</table>\";\n    }\n\n    #-----------------------------------------------------------\n    # \u30de\u30b8\u30c3\u30af\u30af\u30aa\u30fc\u30c8 Off\n    #-----------------------------------------------------------\n    function magic_quotes_off($str) {\n        if (get_magic_quotes_gpc()) {\n            return stripslashes($str);\n        }else{\n            return $str;\n        }\n    }\n\n    #-----------------------------------------------------------\n    # POST/GET \u30c7\u30fc\u30bf\u30fc\u304b\u3089SQL\u3092\u751f\u6210\n    #-----------------------------------------------------------\n    function set_data($post_data='', $get_data=''){\n        if ($post_data != ''){\n            $data = $post_data;\n        }\n        if ($get_data != ''){\n            $data = $get_data;\n        }\n        $this->data =  $this->magic_quotes_off($data);\n        $this->sql  = \"SELECT id, name, password FROM tablename WHERE password = '{$this->data}'\";\n    }\n\n    #-----------------------------------------------------------\n    # POST/GET \u30c7\u30fc\u30bf\u30fc\u3092\u51fa\u529b\n    #-----------------------------------------------------------\n    function get_data(){\n        return $this->data;\n    }\n\n    #-----------------------------------------------------------\n    # POST/GET \u30c7\u30fc\u30bf\u30fc\u304b\u3089SQL\u3092\u751f\u6210\u3055\u308c\u305f\u3082\u306e\u3092\u51fa\u529b\n    #-----------------------------------------------------------\n    function get_sql(){\n        return $this->sql;\n    }\n\n    #-----------------------------------------------------------\n    # POST/GET \u30c7\u30fc\u30bf\u30fc\u304b\u3089SQL\u3092\u5b9f\u884c\n    #-----------------------------------------------------------\n    function get_injection(){\n            $this->db_select($this->sql);\n        #if ($this->data){\n        #    $this->db_select($this->sql);\n        #}else{\n        #    echo \"POST/GET Data None <br />\";\n        #}\n    }\n}\n?>\n\n<hr>\u30d1\u30b9\u30ef\u30fc\u30c9\u5165\u529b<br />\n<br />\n<form action=\"?\" method=\"post\">\nPASSWORD:<input type=\"text\" name=\"data\" size=\"20\" value=\"\">\n<input type=\"submit\" value=\"\u30ed\u30b0\u30a4\u30f3(POST)\">\n</form>\n<form action=\"?\" method=\"get\">\nPASSWORD:<input type=\"text\" name=\"data\" size=\"20\" value=\"\">\n<input type=\"submit\" value=\"\u30ed\u30b0\u30a4\u30f3(GET)\">\n</form>\nSQL\u30a4\u30f3\u30b8\u30a7\u30af\u30b7\u30e7\u30f3\u30b3\u30fc\u30c9\u300c' OR 'A' = 'A' --\u300d\n<hr>\n\n<?php\n$post_data  = $_POST['data'];\n$get_data   = $_GET['data'];\n$hoge       = new SQL_INJECTION_TEST();\n$hoge->db_connect();\n$hoge->db_table_check();\n$hoge->set_data($post_data, $get_data);\necho \"\uff5e\uff5e\u7d50\u679c\uff5e\uff5e<br />\";\necho \"\u767a\u884c\u3057\u305fSQL : \" . $hoge->get_sql()  . \"<br />\";\n$hoge->get_injection();\necho \"<hr>\uff5e\uff5e\u767b\u9332\u5168\u30c7\u30fc\u30bf\u30fc\uff5e\uff5e<br />\";\necho \"\u767a\u884c\u3057\u305fSQL : SELECT id, name, password FROM tablename<br />\";\n$hoge->db_select(\"SELECT id, name, password FROM tablename\");\n```\n\n## \u53c2\u8003\nhttp://www.modsecurity.org/\nhttp://dev.classmethod.jp/cloud/aws/ec2-amazon-linux-waf-modsecurity-install/\nhttp://www.ipa.go.jp/files/000017312.pdf"}