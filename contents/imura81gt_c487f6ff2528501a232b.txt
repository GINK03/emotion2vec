{"context": " More than 1 year has passed since last update.\n\n\u306f\u3058\u3081\u306b\nlambda\u30cf\u30f3\u30ba\u30aa\u30f3\u3092\u53c2\u8003\u306blambda\u3092\u89e6\u3063\u3066\u307f\u307e\u3057\u305f\u3002\n\u30d7\u30ed\u30b0\u30e9\u30e0\u66f8\u304d\u305f\u304f\u3066\u793e\u4f1a\u4eba\u306b\u306a\u3063\u305f\u306e\u306b\u6c17\u304c\u3064\u3044\u305f\u3089\u30a4\u30f3\u30d5\u30e9\u30a8\u30f3\u30b8\u30cb\u30a2\u306b\u306a\u3063\u3066\u305f\u4eba\u304c\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3082\u3084\u308c\u308b\u306e\u304cAWS\u306e\u826f\u3044\u3068\u3053\u308d\uff01\n\nLambda in JAVA!\n\u3044\u308d\u3093\u306ajava\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u30a4\u30d9\u30f3\u30c8\u99c6\u52d5\u3067\u5b9f\u884c\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u306d\uff01(\u77e5\u3063\u305f\u304b\u3076\u308a\nAWS Lambda Update \u2013 Run Java Code in Response to Events | AWS Official Blog\nAmazon Web Services \u30d6\u30ed\u30b0: \u3010AWS\u767a\u8868\u3011AWS Lambda\u306e\u30a2\u30c3\u30d7\u30c7\u30fc\u30c8\u3001\u30a4\u30d9\u30f3\u30c8\u306b\u5fdc\u3058\u3066Java\u30b3\u30fc\u30c9\u3092\u5b9f\u884c\n\n\u306a\u306b\u3092\u8a66\u305d\u3046\u2026\n\u30d1\u30c3\u3068\u601d\u3044\u3064\u3044\u305f kuromoji.jar \u3092Lambda Function\u306e\u4e2d\u3067\u4f7f\u3063\u3066\u307f\u3088\u3046\u3002\n\u5916\u90e8\u304b\u3089S3 Bucket\u306b\u30c6\u30ad\u30b9\u30c8\u30d5\u30a1\u30a4\u30eb\u304c\u7f6e\u304b\u308c\u305f\u3089\u81ea\u52d5\u3067\u5f62\u614b\u7d20\u89e3\u6790\u3057\u3066\u7d50\u679c\u3092\u5225\u306ebucket\u306b\u51fa\u529b\u3059\u308b\u3002\n\uff08\u305d\u308c\u4f55\u306b\u4f7f\u3048\u308b\u306e\uff1f\u3068\u304b\u3001cloudsearch\u4f7f\u3063\u305f\u3089\uff1f\u3068\u304b\u8a00\u308f\u305b\u306a\u3044\u3002\uff09\n\n\u3084\u3063\u3066\u307f\u305f\n\n\u69cb\u6210\u3092\u8003\u3048\u308b\n\n\u203blambda:InvokeFunction\u306b\u3064\u3044\u3066\u306f\u5f8c\u8ff0\u3002\u7279\u5225\u8a2d\u5b9a\u306f\u4e0d\u8981\u306b\u306a\u3063\u305f\u3088\u3046\u3067\u3059\u3002\n\u3053\u3053\u307e\u3067\u66f8\u3044\u3066\u307f\u3066\u5fc5\u8981\u305d\u3046\u306a\u77e5\u8b58\n\nJava SDK\u3067\u3001S3\u304b\u3089Object\u3092get\u3059\u308b\nJava SDK\u3067\u3001get\u3057\u305fObject\u306e\u6587\u7ae0\u3092\u8aad\u8fbc\u3080\nKuromoji\u3067\u5f62\u614b\u7d20\u89e3\u6790\u3059\u308b\n\u7d50\u679c\u3092Java SDK\u3067put\u3059\u308b\nLambda Function\u306e\u66f8\u304d\u65b9\n\n\n\u672c\u5f53\u306bkuromoji.jar\u52d5\u304b\u305b\u3093\u306e\uff1f\uff08Lambda\u306b\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3067\u304d\u3093\u306e\uff1f\uff09\u3092\u8abf\u3079\u308b\n\u5bb9\u91cf\u5236\u9650\u306e\u8a71\u3002\nhttp://docs.aws.amazon.com/lambda/latest/dg/limits.html\n\n\n\nInput\nLimit\n\n\n\n\nCompressed function .zip file\n50 MB\n\n\nUncompressed function .zip file\n250 MB\n\n\nInvoke request body JSON\n6 MB\n\n\n\n\u5727\u7e2e\u3057\u306650MB\u307e\u3067\u3002\nkuromoji-0.7.7.jar\u304c11M\u3002\u3044\u3051\u305d\u3046\u3002\n\n\u3069\u3046\u3084\u3063\u3066\u4f5c\u308b\u306e\u304b\u3092\u8abf\u3079\u308b\uff08\u958b\u767a\u74b0\u5883\uff09\nhttp://docs.aws.amazon.com/lambda/latest/dg/lambda-java-how-to-create-deployment-package.html\n\nCreating a .jar Deployment Package Using Maven without any IDE (Java)\nCreating a .jar Deployment Package Using Maven and Eclipse IDE (Java)\nCreating a .zip Deployment Package (Java)\nAuthoring Lambda Functions Using Eclipse IDE and AWS SDK Plugin (Java)\n\n\uff12\u756a\u76ee\u306eMaven and Eclipse IDE\u3067\u3084\u3063\u3066\u307f\u3088\u3046\u304b\u3068\u601d\u3044\u307e\u3059\u3002\n\n\u958b\u767a\u74b0\u5883\u3092\u6e96\u5099\u3059\u308b\n\n\u4f5c\u696dPC\nOS X Yosemite 10.10.3\nhomebrew, brew-cask \u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u6e08\u307f\n\nEclipse\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\neclipse\nbrew cask install eclipse-platform\n\n\n\nMaven\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306e\u4f5c\u6210\nhttp://docs.aws.amazon.com/lambda/latest/dg/java-create-jar-pkg-maven-and-eclipse.html\n\u3092\u53c2\u8003\u3002\n\n\nKuromoji\u3092\u8ffd\u52a0\nhttp://www.atilika.org/\nMaven artifact repository For ease of use with Maven or Ivy\n\u3092\u53c2\u7167\u3002\n\n\n\n\naws toolkit\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\u4ee5\u4e0b\u3092\u53c2\u8003\u306b\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\nhttp://docs.aws.amazon.com/ja_jp/AWSToolkitEclipse/latest/GettingStartedGuide/tke_setup_install.html\n\ncredential \u8a2d\u5b9a\nhttp://docs.aws.amazon.com/ja_jp/AWSToolkitEclipse/latest/GettingStartedGuide/tke_setup_creds.html\nToolkit for Eclipse \u306b AWS \u30a2\u30af\u30bb\u30b9\u30ad\u30fc\u3092\u8ffd\u52a0\u3059\u308b\u306b\u306f\u3092\u53c2\u7167\u3002\n\n\u69cb\u6210\u56f3\u306b\u5408\u308f\u305b\u3066AWS\u306e\u8a2d\u5b9a\u3092\u3059\u308b\n\nS3 Bucket(\u30d5\u30a1\u30a4\u30eb\u53d7\u53d6\u7528)\n\u6771\u4eac\u30ea\u30fc\u30b8\u30e7\u30f3\u306b\u4f5c\u308a\u307e\u3059\n~/.aws/config\u306bregion\u8a2d\u5b9a\u6e08\u307f\u3002\n\nmakebucket\n$ aws s3 mb s3://imura81gt-text-bucket\n\n\n\nS3 Bucket(\u51e6\u7406\u7d50\u679c\u51fa\u529b\u7528)\n\u5f62\u614b\u7d20\u89e3\u6790\u3057\u305f\u7d50\u679c\u306f\u3053\u306e\u30d0\u30b1\u30c3\u30c8\u306b\u5165\u308c\u308b\u3053\u3068\u306b\u3057\u307e\u3059\u3002\n\nmakebucket\n$ aws s3 mb s3://imura81gt-text-bucket-toknized\n\n\n\u5165\u529b\u5148bucket\u3068\u51fa\u529b\u5148bucket\u3092\u4e00\u7dd2\u306b\u3059\u308b\u3068\u305f\u3076\u3093\u7121\u9650lambda\u3057\u3066\u5927\u5909\u306a\u3053\u3068\u306b\u306a\u308b\u3002\n-> EventSource\u306e\u8a2d\u5b9a\u3067Prefix/Sufix\u306e\u8a2d\u5b9a\u304c\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u3063\u305f\u306e\u3067\u3001\u7121\u9650lambda\u3092\u9632\u3050\u65b9\u6cd5\u306f\u3042\u308b\u3002\n\nIAM role\n\nexec Role\nlambda-hanson\u8cc7\u6599\u306e\n\nLambda exec Role\u306e\u4f5c\u6210\n\n\u3092\u884c\u3046\u3002 lambda_s3_exec_role \u3068\u3059\u308b\u3002\n\nInvoke Role\nEvent Source\u306e\u8a2d\u5b9a\u306e\u969b\u306bInvocation Role\u306e\u8a2d\u5b9a\u304c\u5fc5\u8981\u3067\u3057\u305f\u304c\u3001\u7121\u304f\u306a\u3063\u3066\u307e\u3057\u305f\u3002\n\ncoding\n\u3053\u3093\u306a\u611f\u3058\u3067\u3084\u308a\u307e\u3057\u305f\u3002\n\uff08\u666e\u6bb5bash\u304f\u3089\u3044\u3057\u304b\u66f8\u304b\u306a\u3044\u306e\u3067\u3001\u540d\u524d\u306e\u4ed8\u3051\u65b9\u304c\u304a\u304b\u3057\u304b\u3063\u305f\u308a\u3057\u305f\u3089\u6559\u3048\u3066\u4e0b\u3055\u3044\uff09\n\n\n\npackage net.outofbounds8.kuromoji.lambda;\n\nimport com.amazonaws.services.lambda.runtime.Context;\nimport com.amazonaws.services.lambda.runtime.RequestHandler;\nimport com.amazonaws.services.lambda.runtime.events.S3Event;\nimport com.amazonaws.services.lambda.runtime.LambdaLogger;\n\nimport org.atilika.kuromoji.Token;\nimport org.atilika.kuromoji.Tokenizer;\n\nimport com.amazonaws.auth.ClasspathPropertiesFileCredentialsProvider;\n\n\nimport java.io.BufferedReader;\nimport java.io.File;\nimport java.io.FileOutputStream;\nimport java.io.IOException;\nimport java.io.InputStream;\nimport java.io.InputStreamReader;\nimport java.io.OutputStreamWriter;\nimport java.io.Writer;\nimport java.util.UUID;\n\nimport com.amazonaws.AmazonClientException;\nimport com.amazonaws.AmazonServiceException;\nimport com.amazonaws.regions.Region;\nimport com.amazonaws.regions.Regions;\nimport com.amazonaws.services.s3.AmazonS3;\nimport com.amazonaws.services.s3.AmazonS3Client;\nimport com.amazonaws.services.s3.model.Bucket;\nimport com.amazonaws.services.s3.model.GetObjectRequest;\nimport com.amazonaws.services.s3.model.ListObjectsRequest;\nimport com.amazonaws.services.s3.model.ObjectListing;\nimport com.amazonaws.services.s3.model.PutObjectRequest;\nimport com.amazonaws.services.s3.model.S3Object;\nimport com.amazonaws.services.s3.model.S3ObjectSummary;\n\nimport org.atilika.kuromoji.Token;\nimport org.atilika.kuromoji.Tokenizer;\n\n\n\n// sample http://docs.aws.amazon.com/lambda/latest/dg/java-wt-s3-log-event-data.html\n\nimport com.amazonaws.services.s3.event.S3EventNotification.S3EventNotificationRecord;\n\npublic class LambdaFunctionHandler implements RequestHandler<S3Event, Object> {\n\n    @Override\n    public Object handleRequest(S3Event input, Context context) {\n        context.getLogger().log(\"Input: \" + input);\n        context.getLogger().log(\"Input: \" + input);\n\n        LambdaLogger lambdaLogger = context.getLogger();\n\n        S3EventNotificationRecord record = input.getRecords().get(0);\n        lambdaLogger.log(record.getEventName()); //\u30a4\u30d9\u30f3\u30c8\u540d\n        lambdaLogger.log(record.getS3().getBucket().getName()); //\u30d0\u30b1\u30c3\u30c8\u540d\n        lambdaLogger.log(record.getS3().getObject().getKey()); //\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306e\u30ad\u30fc\uff08\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u540d\uff09\n\n        String bucketName = record.getS3().getBucket().getName();\n        String key = record.getS3().getObject().getKey();\n        S3Object object = null;\n\n        String tld = \"-toknized\";\n\n        StringBuilder buf = new StringBuilder();\n        buf.append(bucketName);\n        buf.append(tld);\n        String outputBucketName = buf.toString();\n\n        //AmazonS3 s3 = new AmazonS3Client(new ClasspathPropertiesFileCredentialsProvider());\n        AmazonS3 s3 = new AmazonS3Client();\n\n        try {\n            object = s3.getObject(new GetObjectRequest(bucketName, key));\n\n            lambdaLogger.log(\"Content-Type: \"  + object.getObjectMetadata().getContentType());\n            lambdaLogger.log(\"object.getObjectContent:     \" + object.getObjectContent());\n            String text = getTextInputStream(object.getObjectContent());\n\n            lambdaLogger.log(text); //\u30a4\u30d9\u30f3\u30c8\u540d\n\n            File file = File.createTempFile(\"tokenize-\", \".txt\");\n            file.deleteOnExit();\n\n            Writer writer = new OutputStreamWriter(new FileOutputStream(file), \"UTF-8\");\n\n            Tokenizer tokenizer = Tokenizer.builder().build();\n\n            for (Token token : tokenizer.tokenize(text)) {\n                System.out.println(token.getSurfaceForm() + \"\\t\" + token.getAllFeatures());\n                writer.write(token.getSurfaceForm() + \"\\t\" + token.getAllFeatures() + \"\\n\");\n            }           \n\n            writer.close();\n\n            s3.putObject(new PutObjectRequest(outputBucketName, \"toknized-\" + key, file));\n\n\n        } catch (AmazonServiceException ase) {\n            System.out.println(\"Caught an AmazonServiceException, which means your request made it \"\n                    + \"to Amazon S3, but was rejected with an error response for some reason.\");\n            System.out.println(\"Error Message:    \" + ase.getMessage());\n            System.out.println(\"HTTP Status Code: \" + ase.getStatusCode());\n            System.out.println(\"AWS Error Code:   \" + ase.getErrorCode());\n            System.out.println(\"Error Type:       \" + ase.getErrorType());\n            System.out.println(\"Request ID:       \" + ase.getRequestId());\n        } catch (AmazonClientException ace) {\n            System.out.println(\"Caught an AmazonClientException, which means the client encountered \"\n                    + \"a serious internal problem while trying to communicate with S3, \"\n                    + \"such as not being able to access the network.\");\n            System.out.println(\"Error Message: \" + ace.getMessage());\n        } catch (IOException e) {\n            // TODO Auto-generated catch block\n            e.printStackTrace();\n        }\n\n\n\n        return record.getS3().getObject().getKey();\n\n        //http://dev.classmethod.jp/cloud/aws/aws-sdk-for-java-s3-create-download-application/\n\n        // TODO: implement your handler\n        //return null;\n    }\n\n    private static String getTextInputStream(InputStream input) throws IOException {\n        BufferedReader reader = new BufferedReader(new InputStreamReader(input, \"UTF-8\"));\n        String text = \"\";\n        String line = \"\";\n\n        while (true) {\n            line = reader.readLine();\n            if (line == null) break;\n            text = text + line;\n        }\n        return text;\n    }\n\n}\n\n\nEclipse\u304b\u3089lambda function\u3092\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\n\nupload\n\u203b\u6771\u4eac\u30ea\u30fc\u30b8\u30e7\u30f3\u304c\u51fa\u308b\u524d\u306b\u8a66\u3057\u305f\u4eba\u306fEclipse\u306e\n[help] - [check for update] \u304b\u3089update\u3092\u884c\u3046\u3053\u3068\u3002\n\uff08\u30c7\u30d7\u30ed\u30a4\u3059\u308b\u969b\u306b\u3001\u53e4\u3044\u3082\u306e\u3092\u3057\u3088\u3046\u3057\u3066\u3044\u308b\u3068\u3001\u6771\u4eac\u30ea\u30fc\u30b8\u30e7\u30f3\u304c\u8868\u793a\u3055\u308c\u306a\u3044\u305f\u3081\uff09\n\n\n\n\n\n\n\nManagementConsole \u958b\u304f\n\n\n\n\n\u5b9f\u884c\uff01\n\u9001\u308b\u30d5\u30a1\u30a4\u30eb\n\nsumomo.txt\n\u3059\u3082\u3082\u3082\u3082\u3082\u3082\u3082\u3082\u306e\u3046\u3061\u3002\n\u3064\u307e\u308a\u3001\u30b9\u30e2\u30e2\u306f\u6843\u306e\u3046\u3061\u3067\u3042\u308a\n\u6843\u3082\u3082\u3061\u308d\u3093\u6843\u306e\u3046\u3061\u3067\u3042\u308b\u3001\n\u3068\u3044\u3046\u4e8b\u3067\u3042\u308b\u3002\n\u5b9f\u969b\u306e\u3068\u3053\u308d\u3001\u30b9\u30e2\u30e2\u306f\u30d0\u30e9\u79d1\u30b5\u30af\u30e9\u5c5e\u3067\u3042\u308a\u3001\u5225\u540d\u30d7\u30e9\u30e0\u3068\u3044\u3046\u3002\n\u306a\u306e\u3067\u6843\u3067\u306f\u306a\u3044\u3002\n\u3053\u306e\u3088\u3046\u306a\u6587\u7ae0\u306e\u3053\u3068\u3092\u8a00\u8449\u904a\u3073\u3068\u8a00\u3046\u3002\n\n\ns3\u306b\u306a\u306b\u3082\u30d5\u30a1\u30a4\u30eb\u304c\u306a\u3044\u306e\u3092\u78ba\u8a8d\n$ aws s3 ls s3://imura81gt-text-bucket/\n$ aws s3 ls s3://imura81gt-text-bucket-toknized/\n\n\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\n$ aws s3 cp sumomo.txt s3://imura81gt-text-bucket/\nupload: ./sumomo.txt to s3://imura81gt-text-bucket/sumomo.txt\n$\n$ aws s3 ls s3://imura81gt-text-bucket/\n2015-08-01 00:58:21        334 sumomo.txt\n$\n\n\u5f62\u614b\u7d20\u89e3\u6790\u3055\u308c\u305f\u30c6\u30ad\u30b9\u30c8\u304c\u51fa\u529b\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\n$ aws s3 ls s3://imura81gt-text-bucket-toknized/\n2015-08-01 00:58:33       3590 toknized-sumomo.txt\n$\n\n\u4e2d\u8eab\u3092\u8868\u793a\u3057\u3066\u307f\u308b\n$ aws s3 cp s3://imura81gt-text-bucket-toknized/toknized-sumomo.txt -\n\u3059\u3082\u3082   \u540d\u8a5e,\u4e00\u822c,*,*,*,*,\u3059\u3082\u3082,\u30b9\u30e2\u30e2,\u30b9\u30e2\u30e2\n\u3082 \u52a9\u8a5e,\u4fc2\u52a9\u8a5e,*,*,*,*,\u3082,\u30e2,\u30e2\n\u3082\u3082  \u540d\u8a5e,\u4e00\u822c,*,*,*,*,\u3082\u3082,\u30e2\u30e2,\u30e2\u30e2\n\u3082 \u52a9\u8a5e,\u4fc2\u52a9\u8a5e,*,*,*,*,\u3082,\u30e2,\u30e2\n\u3082\u3082  \u540d\u8a5e,\u4e00\u822c,*,*,*,*,\u3082\u3082,\u30e2\u30e2,\u30e2\u30e2\n\u306e \u52a9\u8a5e,\u9023\u4f53\u5316,*,*,*,*,\u306e,\u30ce,\u30ce\n\u3046\u3061  \u540d\u8a5e,\u975e\u81ea\u7acb,\u526f\u8a5e\u53ef\u80fd,*,*,*,\u3046\u3061,\u30a6\u30c1,\u30a6\u30c1\n\u3002 \u8a18\u53f7,\u53e5\u70b9,*,*,*,*,\u3002,\u3002,\u3002\n\u3064\u307e\u308a   \u63a5\u7d9a\u8a5e,*,*,*,*,*,\u3064\u307e\u308a,\u30c4\u30de\u30ea,\u30c4\u30de\u30ea\n\u3001 \u8a18\u53f7,\u8aad\u70b9,*,*,*,*,\u3001,\u3001,\u3001\n\u30b9\u30e2\u30e2   \u540d\u8a5e,\u4e00\u822c,*,*,*,*,\u30b9\u30e2\u30e2,\u30b9\u30e2\u30e2,\u30b9\u30e2\u30e2\n\u306f \u52a9\u8a5e,\u4fc2\u52a9\u8a5e,*,*,*,*,\u306f,\u30cf,\u30ef\n\u6843 \u540d\u8a5e,\u4e00\u822c,*,*,*,*,\u6843,\u30e2\u30e2,\u30e2\u30e2\n\u306e \u52a9\u8a5e,\u9023\u4f53\u5316,*,*,*,*,\u306e,\u30ce,\u30ce\n\u3046\u3061  \u540d\u8a5e,\u975e\u81ea\u7acb,\u526f\u8a5e\u53ef\u80fd,*,*,*,\u3046\u3061,\u30a6\u30c1,\u30a6\u30c1\n\u3067 \u52a9\u52d5\u8a5e,*,*,*,\u7279\u6b8a\u30fb\u30c0,\u9023\u7528\u5f62,\u3060,\u30c7,\u30c7\n\u3042\u308a  \u52a9\u52d5\u8a5e,*,*,*,\u4e94\u6bb5\u30fb\u30e9\u884c\u30a2\u30eb,\u9023\u7528\u5f62,\u3042\u308b,\u30a2\u30ea,\u30a2\u30ea\n\u6843 \u540d\u8a5e,\u4e00\u822c,*,*,*,*,\u6843,\u30e2\u30e2,\u30e2\u30e2\n\u3082 \u52a9\u8a5e,\u4fc2\u52a9\u8a5e,*,*,*,*,\u3082,\u30e2,\u30e2\n\u3082\u3061\u308d\u3093    \u526f\u8a5e,\u4e00\u822c,*,*,*,*,\u3082\u3061\u308d\u3093,\u30e2\u30c1\u30ed\u30f3,\u30e2\u30c1\u30ed\u30f3\n\u6843 \u540d\u8a5e,\u4e00\u822c,*,*,*,*,\u6843,\u30e2\u30e2,\u30e2\u30e2\n\u306e \u52a9\u8a5e,\u9023\u4f53\u5316,*,*,*,*,\u306e,\u30ce,\u30ce\n\u3046\u3061  \u540d\u8a5e,\u975e\u81ea\u7acb,\u526f\u8a5e\u53ef\u80fd,*,*,*,\u3046\u3061,\u30a6\u30c1,\u30a6\u30c1\n\u3067 \u52a9\u52d5\u8a5e,*,*,*,\u7279\u6b8a\u30fb\u30c0,\u9023\u7528\u5f62,\u3060,\u30c7,\u30c7\n\u3042\u308b  \u52a9\u52d5\u8a5e,*,*,*,\u4e94\u6bb5\u30fb\u30e9\u884c\u30a2\u30eb,\u57fa\u672c\u5f62,\u3042\u308b,\u30a2\u30eb,\u30a2\u30eb\n\u3001 \u8a18\u53f7,\u8aad\u70b9,*,*,*,*,\u3001,\u3001,\u3001\n\u3068\u3044\u3046   \u52a9\u8a5e,\u683c\u52a9\u8a5e,\u9023\u8a9e,*,*,*,\u3068\u3044\u3046,\u30c8\u30a4\u30a6,\u30c8\u30e6\u30a6\n\u4e8b \u540d\u8a5e,\u975e\u81ea\u7acb,\u4e00\u822c,*,*,*,\u4e8b,\u30b3\u30c8,\u30b3\u30c8\n\u3067 \u52a9\u52d5\u8a5e,*,*,*,\u7279\u6b8a\u30fb\u30c0,\u9023\u7528\u5f62,\u3060,\u30c7,\u30c7\n\u3042\u308b  \u52a9\u52d5\u8a5e,*,*,*,\u4e94\u6bb5\u30fb\u30e9\u884c\u30a2\u30eb,\u57fa\u672c\u5f62,\u3042\u308b,\u30a2\u30eb,\u30a2\u30eb\n\u3002 \u8a18\u53f7,\u53e5\u70b9,*,*,*,*,\u3002,\u3002,\u3002\n\u5b9f\u969b  \u526f\u8a5e,\u52a9\u8a5e\u985e\u63a5\u7d9a,*,*,*,*,\u5b9f\u969b,\u30b8\u30c3\u30b5\u30a4,\u30b8\u30c3\u30b5\u30a4\n\u306e \u52a9\u8a5e,\u9023\u4f53\u5316,*,*,*,*,\u306e,\u30ce,\u30ce\n\u3068\u3053\u308d   \u540d\u8a5e,\u975e\u81ea\u7acb,\u526f\u8a5e\u53ef\u80fd,*,*,*,\u3068\u3053\u308d,\u30c8\u30b3\u30ed,\u30c8\u30b3\u30ed\n\u3001 \u8a18\u53f7,\u8aad\u70b9,*,*,*,*,\u3001,\u3001,\u3001\n\u30b9\u30e2\u30e2   \u540d\u8a5e,\u4e00\u822c,*,*,*,*,\u30b9\u30e2\u30e2,\u30b9\u30e2\u30e2,\u30b9\u30e2\u30e2\n\u306f \u52a9\u8a5e,\u4fc2\u52a9\u8a5e,*,*,*,*,\u306f,\u30cf,\u30ef\n\u30d0\u30e9  \u540d\u8a5e,\u4e00\u822c,*,*,*,*,\u30d0\u30e9,\u30d0\u30e9,\u30d0\u30e9\n\u79d1 \u540d\u8a5e,\u63a5\u5c3e,\u4e00\u822c,*,*,*,\u79d1,\u30ab,\u30ab\n\u30b5\u30af\u30e9   \u540d\u8a5e,\u4e00\u822c,*,*,*,*,\u30b5\u30af\u30e9,\u30b5\u30af\u30e9,\u30b5\u30af\u30e9\n\u5c5e \u540d\u8a5e,\u30b5\u5909\u63a5\u7d9a,*,*,*,*,\u5c5e,\u30be\u30af,\u30be\u30af\n\u3067 \u52a9\u52d5\u8a5e,*,*,*,\u7279\u6b8a\u30fb\u30c0,\u9023\u7528\u5f62,\u3060,\u30c7,\u30c7\n\u3042\u308a  \u52a9\u52d5\u8a5e,*,*,*,\u4e94\u6bb5\u30fb\u30e9\u884c\u30a2\u30eb,\u9023\u7528\u5f62,\u3042\u308b,\u30a2\u30ea,\u30a2\u30ea\n\u3001 \u8a18\u53f7,\u8aad\u70b9,*,*,*,*,\u3001,\u3001,\u3001\n\u5225\u540d  \u540d\u8a5e,\u4e00\u822c,*,*,*,*,\u5225\u540d,\u30d9\u30c4\u30e1\u30a4,\u30d9\u30c4\u30e1\u30a4\n\u30d7\u30e9\u30e0   \u540d\u8a5e,\u4e00\u822c,*,*,*,*,\u30d7\u30e9\u30e0,\u30d7\u30e9\u30e0,\u30d7\u30e9\u30e0\n\u3068 \u52a9\u8a5e,\u683c\u52a9\u8a5e,\u5f15\u7528,*,*,*,\u3068,\u30c8,\u30c8\n\u3044\u3046  \u52d5\u8a5e,\u81ea\u7acb,*,*,\u4e94\u6bb5\u30fb\u30ef\u884c\u4fc3\u97f3\u4fbf,\u57fa\u672c\u5f62,\u3044\u3046,\u30a4\u30a6,\u30a4\u30a6\n\u3002 \u8a18\u53f7,\u53e5\u70b9,*,*,*,*,\u3002,\u3002,\u3002\n\u306a\u306e\u3067   \u63a5\u7d9a\u8a5e,*,*,*,*,*,\u306a\u306e\u3067,\u30ca\u30ce\u30c7,\u30ca\u30ce\u30c7\n\u6843 \u540d\u8a5e,\u4e00\u822c,*,*,*,*,\u6843,\u30e2\u30e2,\u30e2\u30e2\n\u3067 \u52a9\u8a5e,\u683c\u52a9\u8a5e,\u4e00\u822c,*,*,*,\u3067,\u30c7,\u30c7\n\u306f \u52a9\u8a5e,\u4fc2\u52a9\u8a5e,*,*,*,*,\u306f,\u30cf,\u30ef\n\u306a\u3044  \u52a9\u52d5\u8a5e,*,*,*,\u7279\u6b8a\u30fb\u30ca\u30a4,\u57fa\u672c\u5f62,\u306a\u3044,\u30ca\u30a4,\u30ca\u30a4\n\u3002 \u8a18\u53f7,\u53e5\u70b9,*,*,*,*,\u3002,\u3002,\u3002\n\u3053\u306e  \u9023\u4f53\u8a5e,*,*,*,*,*,\u3053\u306e,\u30b3\u30ce,\u30b3\u30ce\n\u3088\u3046  \u540d\u8a5e,\u975e\u81ea\u7acb,\u52a9\u52d5\u8a5e\u8a9e\u5e79,*,*,*,\u3088\u3046,\u30e8\u30a6,\u30e8\u30fc\n\u306a \u52a9\u52d5\u8a5e,*,*,*,\u7279\u6b8a\u30fb\u30c0,\u4f53\u8a00\u63a5\u7d9a,\u3060,\u30ca,\u30ca\n\u6587\u7ae0  \u540d\u8a5e,\u4e00\u822c,*,*,*,*,\u6587\u7ae0,\u30d6\u30f3\u30b7\u30e7\u30a6,\u30d6\u30f3\u30b7\u30e7\u30fc\n\u306e \u52a9\u8a5e,\u9023\u4f53\u5316,*,*,*,*,\u306e,\u30ce,\u30ce\n\u3053\u3068  \u540d\u8a5e,\u975e\u81ea\u7acb,\u4e00\u822c,*,*,*,\u3053\u3068,\u30b3\u30c8,\u30b3\u30c8\n\u3092 \u52a9\u8a5e,\u683c\u52a9\u8a5e,\u4e00\u822c,*,*,*,\u3092,\u30f2,\u30f2\n\u8a00\u8449  \u540d\u8a5e,\u4e00\u822c,*,*,*,*,\u8a00\u8449,\u30b3\u30c8\u30d0,\u30b3\u30c8\u30d0\n\u904a\u3073  \u540d\u8a5e,\u4e00\u822c,*,*,*,*,\u904a\u3073,\u30a2\u30bd\u30d3,\u30a2\u30bd\u30d3\n\u3068 \u52a9\u8a5e,\u683c\u52a9\u8a5e,\u5f15\u7528,*,*,*,\u3068,\u30c8,\u30c8\n\u8a00\u3046  \u52d5\u8a5e,\u81ea\u7acb,*,*,\u4e94\u6bb5\u30fb\u30ef\u884c\u4fc3\u97f3\u4fbf,\u57fa\u672c\u5f62,\u8a00\u3046,\u30a4\u30a6,\u30a4\u30a6\n\u3002 \u8a18\u53f7,\u53e5\u70b9,*,*,*,*,\u3002,\u3002,\u3002\n$\n\n\n\u307e\u3068\u3081\nAmazon API Gateway \u3068\u7d44\u307f\u5408\u308f\u305b\u308c\u3070\n\u5f62\u614b\u7d20\u89e3\u6790API\u304c\u4f5c\u308c\u305d\u3046\uff01\n\n\n## \u306f\u3058\u3081\u306b\n\n[lambda\u30cf\u30f3\u30ba\u30aa\u30f3][lambda-hanson]\u3092\u53c2\u8003\u306blambda\u3092\u89e6\u3063\u3066\u307f\u307e\u3057\u305f\u3002\n\n\u30d7\u30ed\u30b0\u30e9\u30e0\u66f8\u304d\u305f\u304f\u3066\u793e\u4f1a\u4eba\u306b\u306a\u3063\u305f\u306e\u306b\u6c17\u304c\u3064\u3044\u305f\u3089\u30a4\u30f3\u30d5\u30e9\u30a8\u30f3\u30b8\u30cb\u30a2\u306b\u306a\u3063\u3066\u305f\u4eba\u304c\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3082\u3084\u308c\u308b\u306e\u304cAWS\u306e\u826f\u3044\u3068\u3053\u308d\uff01\n\n\n## Lambda in JAVA!\n\n\u3044\u308d\u3093\u306ajava\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u30a4\u30d9\u30f3\u30c8\u99c6\u52d5\u3067\u5b9f\u884c\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u306d\uff01(\u77e5\u3063\u305f\u304b\u3076\u308a\n\n[AWS Lambda Update \u2013 Run Java Code in Response to Events | AWS Official Blog][lambda-update]\n\n\n[Amazon Web Services \u30d6\u30ed\u30b0: \u3010AWS\u767a\u8868\u3011AWS Lambda\u306e\u30a2\u30c3\u30d7\u30c7\u30fc\u30c8\u3001\u30a4\u30d9\u30f3\u30c8\u306b\u5fdc\u3058\u3066Java\u30b3\u30fc\u30c9\u3092\u5b9f\u884c](http://aws.typepad.com/aws_japan/2015/06/aws-lambda-update-run-java-code-in-response-to-events.html)\n\n\n\n## \u306a\u306b\u3092\u8a66\u305d\u3046\u2026\n\n\u30d1\u30c3\u3068\u601d\u3044\u3064\u3044\u305f **kuromoji.jar** \u3092Lambda Function\u306e\u4e2d\u3067\u4f7f\u3063\u3066\u307f\u3088\u3046\u3002\n\n\u5916\u90e8\u304b\u3089S3 Bucket\u306b\u30c6\u30ad\u30b9\u30c8\u30d5\u30a1\u30a4\u30eb\u304c\u7f6e\u304b\u308c\u305f\u3089\u81ea\u52d5\u3067\u5f62\u614b\u7d20\u89e3\u6790\u3057\u3066\u7d50\u679c\u3092\u5225\u306ebucket\u306b\u51fa\u529b\u3059\u308b\u3002\n\uff08\u305d\u308c\u4f55\u306b\u4f7f\u3048\u308b\u306e\uff1f\u3068\u304b\u3001cloudsearch\u4f7f\u3063\u305f\u3089\uff1f\u3068\u304b\u8a00\u308f\u305b\u306a\u3044\u3002\uff09\n\n## \u3084\u3063\u3066\u307f\u305f\n\n### \u69cb\u6210\u3092\u8003\u3048\u308b\n\n\n![lambda-grant.png](https://qiita-image-store.s3.amazonaws.com/0/17518/2c809ccf-a179-cdf2-79c6-49ca0df24396.png \"lambda-grant.png\")\n\n\u203blambda:InvokeFunction\u306b\u3064\u3044\u3066\u306f\u5f8c\u8ff0\u3002\u7279\u5225\u8a2d\u5b9a\u306f\u4e0d\u8981\u306b\u306a\u3063\u305f\u3088\u3046\u3067\u3059\u3002\n \n\u3053\u3053\u307e\u3067\u66f8\u3044\u3066\u307f\u3066\u5fc5\u8981\u305d\u3046\u306a\u77e5\u8b58\n\n* Java SDK\u3067\u3001S3\u304b\u3089Object\u3092get\u3059\u308b\n* Java SDK\u3067\u3001get\u3057\u305fObject\u306e\u6587\u7ae0\u3092\u8aad\u8fbc\u3080\n* Kuromoji\u3067\u5f62\u614b\u7d20\u89e3\u6790\u3059\u308b\n* \u7d50\u679c\u3092Java SDK\u3067put\u3059\u308b\n* Lambda Function\u306e\u66f8\u304d\u65b9\n\n\n\n### \u672c\u5f53\u306bkuromoji.jar\u52d5\u304b\u305b\u3093\u306e\uff1f\uff08Lambda\u306b\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3067\u304d\u3093\u306e\uff1f\uff09\u3092\u8abf\u3079\u308b\n\n\u5bb9\u91cf\u5236\u9650\u306e\u8a71\u3002\n\nhttp://docs.aws.amazon.com/lambda/latest/dg/limits.html\n\nInput\t|Limit\n---|---\nCompressed function .zip file\t|50 MB\nUncompressed function .zip file\t|250 MB\nInvoke request body JSON\t|6 MB\n\n\n\u5727\u7e2e\u3057\u306650MB\u307e\u3067\u3002\n\nkuromoji-0.7.7.jar\u304c11M\u3002\u3044\u3051\u305d\u3046\u3002\n\n### \u3069\u3046\u3084\u3063\u3066\u4f5c\u308b\u306e\u304b\u3092\u8abf\u3079\u308b\uff08\u958b\u767a\u74b0\u5883\uff09\n\nhttp://docs.aws.amazon.com/lambda/latest/dg/lambda-java-how-to-create-deployment-package.html\n\n\n* Creating a .jar Deployment Package Using Maven without any IDE (Java)\n* Creating a .jar Deployment Package Using Maven and Eclipse IDE (Java)\n* Creating a .zip Deployment Package (Java)\n* Authoring Lambda Functions Using Eclipse IDE and AWS SDK Plugin (Java)\n\n\n\uff12\u756a\u76ee\u306eMaven and Eclipse IDE\u3067\u3084\u3063\u3066\u307f\u3088\u3046\u304b\u3068\u601d\u3044\u307e\u3059\u3002\n\n### \u958b\u767a\u74b0\u5883\u3092\u6e96\u5099\u3059\u308b\n\n#### \u4f5c\u696dPC\n\nOS X Yosemite 10.10.3\nhomebrew, brew-cask \u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u6e08\u307f\n\n#### Eclipse\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n```bash:eclipse\nbrew cask install eclipse-platform\n```\n\n\n\n## Maven\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306e\u4f5c\u6210\n\nhttp://docs.aws.amazon.com/lambda/latest/dg/java-create-jar-pkg-maven-and-eclipse.html\n\n\u3092\u53c2\u8003\u3002\n\n![lambda002.png](https://qiita-image-store.s3.amazonaws.com/0/17518/255c93f0-1734-36f3-9ba2-6b3b3e6dc9ea.png \"lambda002.png\")\n\n\n\n## Kuromoji\u3092\u8ffd\u52a0\n\nhttp://www.atilika.org/\nMaven artifact repository For ease of use with Maven or Ivy\n\u3092\u53c2\u7167\u3002\n\n\n\n![lambda003.png](https://qiita-image-store.s3.amazonaws.com/0/17518/0abbf54d-adf1-fad6-ea4c-c29418be6f6a.png \"lambda003.png\")\n\n![lambda004.png](https://qiita-image-store.s3.amazonaws.com/0/17518/56adf675-10b6-1e1c-5c20-4afcaeba10e3.png \"lambda004.png\")\n\n![kuromoji-maven0001.png](https://qiita-image-store.s3.amazonaws.com/0/17518/8ec26222-0b24-9843-e611-fb9e0ad4353b.png \"kuromoji-maven0001.png\")\n\n## aws toolkit\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n### \u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n\u4ee5\u4e0b\u3092\u53c2\u8003\u306b\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\nhttp://docs.aws.amazon.com/ja_jp/AWSToolkitEclipse/latest/GettingStartedGuide/tke_setup_install.html\n\n### credential \u8a2d\u5b9a\n\nhttp://docs.aws.amazon.com/ja_jp/AWSToolkitEclipse/latest/GettingStartedGuide/tke_setup_creds.html\n\n**Toolkit for Eclipse \u306b AWS \u30a2\u30af\u30bb\u30b9\u30ad\u30fc\u3092\u8ffd\u52a0\u3059\u308b\u306b\u306f**\u3092\u53c2\u7167\u3002\n\n## \u69cb\u6210\u56f3\u306b\u5408\u308f\u305b\u3066AWS\u306e\u8a2d\u5b9a\u3092\u3059\u308b\n\n### S3 Bucket(\u30d5\u30a1\u30a4\u30eb\u53d7\u53d6\u7528)\n\n\u6771\u4eac\u30ea\u30fc\u30b8\u30e7\u30f3\u306b\u4f5c\u308a\u307e\u3059\n~/.aws/config\u306bregion\u8a2d\u5b9a\u6e08\u307f\u3002\n\n```bash:makebucket\n$ aws s3 mb s3://imura81gt-text-bucket\n```\n\n### S3 Bucket(\u51e6\u7406\u7d50\u679c\u51fa\u529b\u7528)\n\n\u5f62\u614b\u7d20\u89e3\u6790\u3057\u305f\u7d50\u679c\u306f\u3053\u306e\u30d0\u30b1\u30c3\u30c8\u306b\u5165\u308c\u308b\u3053\u3068\u306b\u3057\u307e\u3059\u3002\n\n```bash:makebucket\n$ aws s3 mb s3://imura81gt-text-bucket-toknized\n```\n\n\u5165\u529b\u5148bucket\u3068\u51fa\u529b\u5148bucket\u3092\u4e00\u7dd2\u306b\u3059\u308b\u3068\u305f\u3076\u3093\u7121\u9650lambda\u3057\u3066\u5927\u5909\u306a\u3053\u3068\u306b\u306a\u308b\u3002\n-> EventSource\u306e\u8a2d\u5b9a\u3067Prefix/Sufix\u306e\u8a2d\u5b9a\u304c\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u3063\u305f\u306e\u3067\u3001\u7121\u9650lambda\u3092\u9632\u3050\u65b9\u6cd5\u306f\u3042\u308b\u3002\n\n \n\n## IAM role\n\n### exec Role\n\n[lambda-hanson\u8cc7\u6599][lambda-hanson]\u306e\n\n* Lambda exec Role\u306e\u4f5c\u6210\n\n\u3092\u884c\u3046\u3002 `lambda_s3_exec_role` \u3068\u3059\u308b\u3002\n\n\n### Invoke Role\n\nEvent Source\u306e\u8a2d\u5b9a\u306e\u969b\u306bInvocation Role\u306e\u8a2d\u5b9a\u304c\u5fc5\u8981\u3067\u3057\u305f\u304c\u3001\u7121\u304f\u306a\u3063\u3066\u307e\u3057\u305f\u3002\n\n## coding\n\n\u3053\u3093\u306a\u611f\u3058\u3067\u3084\u308a\u307e\u3057\u305f\u3002\n\uff08\u666e\u6bb5bash\u304f\u3089\u3044\u3057\u304b\u66f8\u304b\u306a\u3044\u306e\u3067\u3001\u540d\u524d\u306e\u4ed8\u3051\u65b9\u304c\u304a\u304b\u3057\u304b\u3063\u305f\u308a\u3057\u305f\u3089\u6559\u3048\u3066\u4e0b\u3055\u3044\uff09\n\n![lambda1001.png](https://qiita-image-store.s3.amazonaws.com/0/17518/7d07c63b-8594-f8a6-7004-d792c6e035c8.png \"lambda1001.png\")\n\n![lambda1002.png](https://qiita-image-store.s3.amazonaws.com/0/17518/6e54e800-fadd-e166-cafa-17a2677f0fc1.png \"lambda1002.png\")\n\n![lambda1003.png](https://qiita-image-store.s3.amazonaws.com/0/17518/d5dfe1a9-b83a-f06b-ddd4-11f35f9aac10.png \"lambda1003.png\")\n\n\n```java\npackage net.outofbounds8.kuromoji.lambda;\n\nimport com.amazonaws.services.lambda.runtime.Context;\nimport com.amazonaws.services.lambda.runtime.RequestHandler;\nimport com.amazonaws.services.lambda.runtime.events.S3Event;\nimport com.amazonaws.services.lambda.runtime.LambdaLogger;\n\nimport org.atilika.kuromoji.Token;\nimport org.atilika.kuromoji.Tokenizer;\n\nimport com.amazonaws.auth.ClasspathPropertiesFileCredentialsProvider;\n\n\nimport java.io.BufferedReader;\nimport java.io.File;\nimport java.io.FileOutputStream;\nimport java.io.IOException;\nimport java.io.InputStream;\nimport java.io.InputStreamReader;\nimport java.io.OutputStreamWriter;\nimport java.io.Writer;\nimport java.util.UUID;\n\nimport com.amazonaws.AmazonClientException;\nimport com.amazonaws.AmazonServiceException;\nimport com.amazonaws.regions.Region;\nimport com.amazonaws.regions.Regions;\nimport com.amazonaws.services.s3.AmazonS3;\nimport com.amazonaws.services.s3.AmazonS3Client;\nimport com.amazonaws.services.s3.model.Bucket;\nimport com.amazonaws.services.s3.model.GetObjectRequest;\nimport com.amazonaws.services.s3.model.ListObjectsRequest;\nimport com.amazonaws.services.s3.model.ObjectListing;\nimport com.amazonaws.services.s3.model.PutObjectRequest;\nimport com.amazonaws.services.s3.model.S3Object;\nimport com.amazonaws.services.s3.model.S3ObjectSummary;\n\nimport org.atilika.kuromoji.Token;\nimport org.atilika.kuromoji.Tokenizer;\n\n\n\n// sample http://docs.aws.amazon.com/lambda/latest/dg/java-wt-s3-log-event-data.html\n\nimport com.amazonaws.services.s3.event.S3EventNotification.S3EventNotificationRecord;\n\npublic class LambdaFunctionHandler implements RequestHandler<S3Event, Object> {\n\n    @Override\n    public Object handleRequest(S3Event input, Context context) {\n        context.getLogger().log(\"Input: \" + input);\n        context.getLogger().log(\"Input: \" + input);\n        \n        LambdaLogger lambdaLogger = context.getLogger();\n        \n        S3EventNotificationRecord record = input.getRecords().get(0);\n        lambdaLogger.log(record.getEventName()); //\u30a4\u30d9\u30f3\u30c8\u540d\n        lambdaLogger.log(record.getS3().getBucket().getName()); //\u30d0\u30b1\u30c3\u30c8\u540d\n        lambdaLogger.log(record.getS3().getObject().getKey()); //\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306e\u30ad\u30fc\uff08\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u540d\uff09\n\n        String bucketName = record.getS3().getBucket().getName();\n        String key = record.getS3().getObject().getKey();\n        S3Object object = null;\n        \n        String tld = \"-toknized\";\n\n        StringBuilder buf = new StringBuilder();\n        buf.append(bucketName);\n        buf.append(tld);\n        String outputBucketName = buf.toString();\n                \t\t       \n        //AmazonS3 s3 = new AmazonS3Client(new ClasspathPropertiesFileCredentialsProvider());\n        AmazonS3 s3 = new AmazonS3Client();\n        \n        try {\n            object = s3.getObject(new GetObjectRequest(bucketName, key));\n            \n            lambdaLogger.log(\"Content-Type: \"  + object.getObjectMetadata().getContentType());\n            lambdaLogger.log(\"object.getObjectContent:     \" + object.getObjectContent());\n            String text = getTextInputStream(object.getObjectContent());\n\n            lambdaLogger.log(text); //\u30a4\u30d9\u30f3\u30c8\u540d\n\n            File file = File.createTempFile(\"tokenize-\", \".txt\");\n            file.deleteOnExit();\n\n            Writer writer = new OutputStreamWriter(new FileOutputStream(file), \"UTF-8\");\n\n            Tokenizer tokenizer = Tokenizer.builder().build();\n            \n            for (Token token : tokenizer.tokenize(text)) {\n                System.out.println(token.getSurfaceForm() + \"\\t\" + token.getAllFeatures());\n                writer.write(token.getSurfaceForm() + \"\\t\" + token.getAllFeatures() + \"\\n\");\n            }           \n\n            writer.close();\n\n            s3.putObject(new PutObjectRequest(outputBucketName, \"toknized-\" + key, file));\n            \n            \n        } catch (AmazonServiceException ase) {\n            System.out.println(\"Caught an AmazonServiceException, which means your request made it \"\n                    + \"to Amazon S3, but was rejected with an error response for some reason.\");\n            System.out.println(\"Error Message:    \" + ase.getMessage());\n            System.out.println(\"HTTP Status Code: \" + ase.getStatusCode());\n            System.out.println(\"AWS Error Code:   \" + ase.getErrorCode());\n            System.out.println(\"Error Type:       \" + ase.getErrorType());\n            System.out.println(\"Request ID:       \" + ase.getRequestId());\n        } catch (AmazonClientException ace) {\n            System.out.println(\"Caught an AmazonClientException, which means the client encountered \"\n                    + \"a serious internal problem while trying to communicate with S3, \"\n                    + \"such as not being able to access the network.\");\n            System.out.println(\"Error Message: \" + ace.getMessage());\n        } catch (IOException e) {\n\t\t\t// TODO Auto-generated catch block\n\t\t\te.printStackTrace();\n\t\t}\n         \n        \n        \n        return record.getS3().getObject().getKey();\n        \n        //http://dev.classmethod.jp/cloud/aws/aws-sdk-for-java-s3-create-download-application/\n        \t\n        // TODO: implement your handler\n        //return null;\n    }\n\n    private static String getTextInputStream(InputStream input) throws IOException {\n        BufferedReader reader = new BufferedReader(new InputStreamReader(input, \"UTF-8\"));\n        String text = \"\";\n        String line = \"\";\n\n        while (true) {\n            line = reader.readLine();\n            if (line == null) break;\n            text = text + line;\n        }\n        return text;\n    }\n\n}\n```\n\n\n\n## Eclipse\u304b\u3089lambda function\u3092\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\n\n\n### upload\n\n\u203b\u6771\u4eac\u30ea\u30fc\u30b8\u30e7\u30f3\u304c\u51fa\u308b\u524d\u306b\u8a66\u3057\u305f\u4eba\u306fEclipse\u306e\n[help] - [check for update] \u304b\u3089update\u3092\u884c\u3046\u3053\u3068\u3002\n\uff08\u30c7\u30d7\u30ed\u30a4\u3059\u308b\u969b\u306b\u3001\u53e4\u3044\u3082\u306e\u3092\u3057\u3088\u3046\u3057\u3066\u3044\u308b\u3068\u3001\u6771\u4eac\u30ea\u30fc\u30b8\u30e7\u30f3\u304c\u8868\u793a\u3055\u308c\u306a\u3044\u305f\u3081\uff09\n\n\n![kuromoji-upload0002.png](https://qiita-image-store.s3.amazonaws.com/0/17518/7bfa6d31-b00e-2cce-75d3-7c6b1ca02fbe.png \"kuromoji-upload0002.png\")\n\n![lambda005.png](https://qiita-image-store.s3.amazonaws.com/0/17518/e0b312e6-11f9-fae8-cea5-9b819a9a5c5f.png \"lambda005.png\")\n\n![lambda006.png](https://qiita-image-store.s3.amazonaws.com/0/17518/75e5c512-a06c-5175-5d38-ed04f226216e.png \"lambda006.png\")\n\n![lambda007.png](https://qiita-image-store.s3.amazonaws.com/0/17518/055cf812-6284-0822-0e8d-fca8474b64ee.png \"lambda007.png\")\n\n![lambda008-1.png](https://qiita-image-store.s3.amazonaws.com/0/17518/86a37785-5373-5fce-8a5e-356ece9247dc.png \"lambda008-1.png\")\n\n![lambda008.png](https://qiita-image-store.s3.amazonaws.com/0/17518/afa56cb0-eb5e-5c2c-f384-dee61ba8de3e.png \"lambda008.png\")\n\n![lambda009.png](https://qiita-image-store.s3.amazonaws.com/0/17518/3a4fc378-ddde-d94d-44de-2a66e4d7a52c.png \"lambda009.png\")\n\nManagementConsole \u958b\u304f\n![lambda010.png](https://qiita-image-store.s3.amazonaws.com/0/17518/f7353e06-7f96-b2c3-1f00-a90ab535db8e.png \"lambda010.png\")\n![lambda011.png](https://qiita-image-store.s3.amazonaws.com/0/17518/130c5033-cc93-9189-4f1e-c73048585e17.png \"lambda011.png\")\n![lambda012.png](https://qiita-image-store.s3.amazonaws.com/0/17518/cbeb36c4-4243-fdf8-8de9-39db473173b7.png \"lambda012.png\")\n\n\n### \u5b9f\u884c\uff01\n\n\u9001\u308b\u30d5\u30a1\u30a4\u30eb\n\n```text:sumomo.txt\n\u3059\u3082\u3082\u3082\u3082\u3082\u3082\u3082\u3082\u306e\u3046\u3061\u3002\n\u3064\u307e\u308a\u3001\u30b9\u30e2\u30e2\u306f\u6843\u306e\u3046\u3061\u3067\u3042\u308a\n\u6843\u3082\u3082\u3061\u308d\u3093\u6843\u306e\u3046\u3061\u3067\u3042\u308b\u3001\n\u3068\u3044\u3046\u4e8b\u3067\u3042\u308b\u3002\n\u5b9f\u969b\u306e\u3068\u3053\u308d\u3001\u30b9\u30e2\u30e2\u306f\u30d0\u30e9\u79d1\u30b5\u30af\u30e9\u5c5e\u3067\u3042\u308a\u3001\u5225\u540d\u30d7\u30e9\u30e0\u3068\u3044\u3046\u3002\n\u306a\u306e\u3067\u6843\u3067\u306f\u306a\u3044\u3002\n\u3053\u306e\u3088\u3046\u306a\u6587\u7ae0\u306e\u3053\u3068\u3092\u8a00\u8449\u904a\u3073\u3068\u8a00\u3046\u3002\n```\n\ns3\u306b\u306a\u306b\u3082\u30d5\u30a1\u30a4\u30eb\u304c\u306a\u3044\u306e\u3092\u78ba\u8a8d\n\n```\n$ aws s3 ls s3://imura81gt-text-bucket/\n$ aws s3 ls s3://imura81gt-text-bucket-toknized/\n```\n\n\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\n\n```\n$ aws s3 cp sumomo.txt s3://imura81gt-text-bucket/\nupload: ./sumomo.txt to s3://imura81gt-text-bucket/sumomo.txt\n$\n$ aws s3 ls s3://imura81gt-text-bucket/\n2015-08-01 00:58:21        334 sumomo.txt\n$\n```\n\n\u5f62\u614b\u7d20\u89e3\u6790\u3055\u308c\u305f\u30c6\u30ad\u30b9\u30c8\u304c\u51fa\u529b\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\n\n```\n$ aws s3 ls s3://imura81gt-text-bucket-toknized/\n2015-08-01 00:58:33       3590 toknized-sumomo.txt\n$\n```\n\n\u4e2d\u8eab\u3092\u8868\u793a\u3057\u3066\u307f\u308b\n\n```\n$ aws s3 cp s3://imura81gt-text-bucket-toknized/toknized-sumomo.txt -\n\u3059\u3082\u3082\t\u540d\u8a5e,\u4e00\u822c,*,*,*,*,\u3059\u3082\u3082,\u30b9\u30e2\u30e2,\u30b9\u30e2\u30e2\n\u3082\t\u52a9\u8a5e,\u4fc2\u52a9\u8a5e,*,*,*,*,\u3082,\u30e2,\u30e2\n\u3082\u3082\t\u540d\u8a5e,\u4e00\u822c,*,*,*,*,\u3082\u3082,\u30e2\u30e2,\u30e2\u30e2\n\u3082\t\u52a9\u8a5e,\u4fc2\u52a9\u8a5e,*,*,*,*,\u3082,\u30e2,\u30e2\n\u3082\u3082\t\u540d\u8a5e,\u4e00\u822c,*,*,*,*,\u3082\u3082,\u30e2\u30e2,\u30e2\u30e2\n\u306e\t\u52a9\u8a5e,\u9023\u4f53\u5316,*,*,*,*,\u306e,\u30ce,\u30ce\n\u3046\u3061\t\u540d\u8a5e,\u975e\u81ea\u7acb,\u526f\u8a5e\u53ef\u80fd,*,*,*,\u3046\u3061,\u30a6\u30c1,\u30a6\u30c1\n\u3002\t\u8a18\u53f7,\u53e5\u70b9,*,*,*,*,\u3002,\u3002,\u3002\n\u3064\u307e\u308a\t\u63a5\u7d9a\u8a5e,*,*,*,*,*,\u3064\u307e\u308a,\u30c4\u30de\u30ea,\u30c4\u30de\u30ea\n\u3001\t\u8a18\u53f7,\u8aad\u70b9,*,*,*,*,\u3001,\u3001,\u3001\n\u30b9\u30e2\u30e2\t\u540d\u8a5e,\u4e00\u822c,*,*,*,*,\u30b9\u30e2\u30e2,\u30b9\u30e2\u30e2,\u30b9\u30e2\u30e2\n\u306f\t\u52a9\u8a5e,\u4fc2\u52a9\u8a5e,*,*,*,*,\u306f,\u30cf,\u30ef\n\u6843\t\u540d\u8a5e,\u4e00\u822c,*,*,*,*,\u6843,\u30e2\u30e2,\u30e2\u30e2\n\u306e\t\u52a9\u8a5e,\u9023\u4f53\u5316,*,*,*,*,\u306e,\u30ce,\u30ce\n\u3046\u3061\t\u540d\u8a5e,\u975e\u81ea\u7acb,\u526f\u8a5e\u53ef\u80fd,*,*,*,\u3046\u3061,\u30a6\u30c1,\u30a6\u30c1\n\u3067\t\u52a9\u52d5\u8a5e,*,*,*,\u7279\u6b8a\u30fb\u30c0,\u9023\u7528\u5f62,\u3060,\u30c7,\u30c7\n\u3042\u308a\t\u52a9\u52d5\u8a5e,*,*,*,\u4e94\u6bb5\u30fb\u30e9\u884c\u30a2\u30eb,\u9023\u7528\u5f62,\u3042\u308b,\u30a2\u30ea,\u30a2\u30ea\n\u6843\t\u540d\u8a5e,\u4e00\u822c,*,*,*,*,\u6843,\u30e2\u30e2,\u30e2\u30e2\n\u3082\t\u52a9\u8a5e,\u4fc2\u52a9\u8a5e,*,*,*,*,\u3082,\u30e2,\u30e2\n\u3082\u3061\u308d\u3093\t\u526f\u8a5e,\u4e00\u822c,*,*,*,*,\u3082\u3061\u308d\u3093,\u30e2\u30c1\u30ed\u30f3,\u30e2\u30c1\u30ed\u30f3\n\u6843\t\u540d\u8a5e,\u4e00\u822c,*,*,*,*,\u6843,\u30e2\u30e2,\u30e2\u30e2\n\u306e\t\u52a9\u8a5e,\u9023\u4f53\u5316,*,*,*,*,\u306e,\u30ce,\u30ce\n\u3046\u3061\t\u540d\u8a5e,\u975e\u81ea\u7acb,\u526f\u8a5e\u53ef\u80fd,*,*,*,\u3046\u3061,\u30a6\u30c1,\u30a6\u30c1\n\u3067\t\u52a9\u52d5\u8a5e,*,*,*,\u7279\u6b8a\u30fb\u30c0,\u9023\u7528\u5f62,\u3060,\u30c7,\u30c7\n\u3042\u308b\t\u52a9\u52d5\u8a5e,*,*,*,\u4e94\u6bb5\u30fb\u30e9\u884c\u30a2\u30eb,\u57fa\u672c\u5f62,\u3042\u308b,\u30a2\u30eb,\u30a2\u30eb\n\u3001\t\u8a18\u53f7,\u8aad\u70b9,*,*,*,*,\u3001,\u3001,\u3001\n\u3068\u3044\u3046\t\u52a9\u8a5e,\u683c\u52a9\u8a5e,\u9023\u8a9e,*,*,*,\u3068\u3044\u3046,\u30c8\u30a4\u30a6,\u30c8\u30e6\u30a6\n\u4e8b\t\u540d\u8a5e,\u975e\u81ea\u7acb,\u4e00\u822c,*,*,*,\u4e8b,\u30b3\u30c8,\u30b3\u30c8\n\u3067\t\u52a9\u52d5\u8a5e,*,*,*,\u7279\u6b8a\u30fb\u30c0,\u9023\u7528\u5f62,\u3060,\u30c7,\u30c7\n\u3042\u308b\t\u52a9\u52d5\u8a5e,*,*,*,\u4e94\u6bb5\u30fb\u30e9\u884c\u30a2\u30eb,\u57fa\u672c\u5f62,\u3042\u308b,\u30a2\u30eb,\u30a2\u30eb\n\u3002\t\u8a18\u53f7,\u53e5\u70b9,*,*,*,*,\u3002,\u3002,\u3002\n\u5b9f\u969b\t\u526f\u8a5e,\u52a9\u8a5e\u985e\u63a5\u7d9a,*,*,*,*,\u5b9f\u969b,\u30b8\u30c3\u30b5\u30a4,\u30b8\u30c3\u30b5\u30a4\n\u306e\t\u52a9\u8a5e,\u9023\u4f53\u5316,*,*,*,*,\u306e,\u30ce,\u30ce\n\u3068\u3053\u308d\t\u540d\u8a5e,\u975e\u81ea\u7acb,\u526f\u8a5e\u53ef\u80fd,*,*,*,\u3068\u3053\u308d,\u30c8\u30b3\u30ed,\u30c8\u30b3\u30ed\n\u3001\t\u8a18\u53f7,\u8aad\u70b9,*,*,*,*,\u3001,\u3001,\u3001\n\u30b9\u30e2\u30e2\t\u540d\u8a5e,\u4e00\u822c,*,*,*,*,\u30b9\u30e2\u30e2,\u30b9\u30e2\u30e2,\u30b9\u30e2\u30e2\n\u306f\t\u52a9\u8a5e,\u4fc2\u52a9\u8a5e,*,*,*,*,\u306f,\u30cf,\u30ef\n\u30d0\u30e9\t\u540d\u8a5e,\u4e00\u822c,*,*,*,*,\u30d0\u30e9,\u30d0\u30e9,\u30d0\u30e9\n\u79d1\t\u540d\u8a5e,\u63a5\u5c3e,\u4e00\u822c,*,*,*,\u79d1,\u30ab,\u30ab\n\u30b5\u30af\u30e9\t\u540d\u8a5e,\u4e00\u822c,*,*,*,*,\u30b5\u30af\u30e9,\u30b5\u30af\u30e9,\u30b5\u30af\u30e9\n\u5c5e\t\u540d\u8a5e,\u30b5\u5909\u63a5\u7d9a,*,*,*,*,\u5c5e,\u30be\u30af,\u30be\u30af\n\u3067\t\u52a9\u52d5\u8a5e,*,*,*,\u7279\u6b8a\u30fb\u30c0,\u9023\u7528\u5f62,\u3060,\u30c7,\u30c7\n\u3042\u308a\t\u52a9\u52d5\u8a5e,*,*,*,\u4e94\u6bb5\u30fb\u30e9\u884c\u30a2\u30eb,\u9023\u7528\u5f62,\u3042\u308b,\u30a2\u30ea,\u30a2\u30ea\n\u3001\t\u8a18\u53f7,\u8aad\u70b9,*,*,*,*,\u3001,\u3001,\u3001\n\u5225\u540d\t\u540d\u8a5e,\u4e00\u822c,*,*,*,*,\u5225\u540d,\u30d9\u30c4\u30e1\u30a4,\u30d9\u30c4\u30e1\u30a4\n\u30d7\u30e9\u30e0\t\u540d\u8a5e,\u4e00\u822c,*,*,*,*,\u30d7\u30e9\u30e0,\u30d7\u30e9\u30e0,\u30d7\u30e9\u30e0\n\u3068\t\u52a9\u8a5e,\u683c\u52a9\u8a5e,\u5f15\u7528,*,*,*,\u3068,\u30c8,\u30c8\n\u3044\u3046\t\u52d5\u8a5e,\u81ea\u7acb,*,*,\u4e94\u6bb5\u30fb\u30ef\u884c\u4fc3\u97f3\u4fbf,\u57fa\u672c\u5f62,\u3044\u3046,\u30a4\u30a6,\u30a4\u30a6\n\u3002\t\u8a18\u53f7,\u53e5\u70b9,*,*,*,*,\u3002,\u3002,\u3002\n\u306a\u306e\u3067\t\u63a5\u7d9a\u8a5e,*,*,*,*,*,\u306a\u306e\u3067,\u30ca\u30ce\u30c7,\u30ca\u30ce\u30c7\n\u6843\t\u540d\u8a5e,\u4e00\u822c,*,*,*,*,\u6843,\u30e2\u30e2,\u30e2\u30e2\n\u3067\t\u52a9\u8a5e,\u683c\u52a9\u8a5e,\u4e00\u822c,*,*,*,\u3067,\u30c7,\u30c7\n\u306f\t\u52a9\u8a5e,\u4fc2\u52a9\u8a5e,*,*,*,*,\u306f,\u30cf,\u30ef\n\u306a\u3044\t\u52a9\u52d5\u8a5e,*,*,*,\u7279\u6b8a\u30fb\u30ca\u30a4,\u57fa\u672c\u5f62,\u306a\u3044,\u30ca\u30a4,\u30ca\u30a4\n\u3002\t\u8a18\u53f7,\u53e5\u70b9,*,*,*,*,\u3002,\u3002,\u3002\n\u3053\u306e\t\u9023\u4f53\u8a5e,*,*,*,*,*,\u3053\u306e,\u30b3\u30ce,\u30b3\u30ce\n\u3088\u3046\t\u540d\u8a5e,\u975e\u81ea\u7acb,\u52a9\u52d5\u8a5e\u8a9e\u5e79,*,*,*,\u3088\u3046,\u30e8\u30a6,\u30e8\u30fc\n\u306a\t\u52a9\u52d5\u8a5e,*,*,*,\u7279\u6b8a\u30fb\u30c0,\u4f53\u8a00\u63a5\u7d9a,\u3060,\u30ca,\u30ca\n\u6587\u7ae0\t\u540d\u8a5e,\u4e00\u822c,*,*,*,*,\u6587\u7ae0,\u30d6\u30f3\u30b7\u30e7\u30a6,\u30d6\u30f3\u30b7\u30e7\u30fc\n\u306e\t\u52a9\u8a5e,\u9023\u4f53\u5316,*,*,*,*,\u306e,\u30ce,\u30ce\n\u3053\u3068\t\u540d\u8a5e,\u975e\u81ea\u7acb,\u4e00\u822c,*,*,*,\u3053\u3068,\u30b3\u30c8,\u30b3\u30c8\n\u3092\t\u52a9\u8a5e,\u683c\u52a9\u8a5e,\u4e00\u822c,*,*,*,\u3092,\u30f2,\u30f2\n\u8a00\u8449\t\u540d\u8a5e,\u4e00\u822c,*,*,*,*,\u8a00\u8449,\u30b3\u30c8\u30d0,\u30b3\u30c8\u30d0\n\u904a\u3073\t\u540d\u8a5e,\u4e00\u822c,*,*,*,*,\u904a\u3073,\u30a2\u30bd\u30d3,\u30a2\u30bd\u30d3\n\u3068\t\u52a9\u8a5e,\u683c\u52a9\u8a5e,\u5f15\u7528,*,*,*,\u3068,\u30c8,\u30c8\n\u8a00\u3046\t\u52d5\u8a5e,\u81ea\u7acb,*,*,\u4e94\u6bb5\u30fb\u30ef\u884c\u4fc3\u97f3\u4fbf,\u57fa\u672c\u5f62,\u8a00\u3046,\u30a4\u30a6,\u30a4\u30a6\n\u3002\t\u8a18\u53f7,\u53e5\u70b9,*,*,*,*,\u3002,\u3002,\u3002\n$\n```\n\n### \u307e\u3068\u3081\n\nAmazon API Gateway \u3068\u7d44\u307f\u5408\u308f\u305b\u308c\u3070\n\u5f62\u614b\u7d20\u89e3\u6790API\u304c\u4f5c\u308c\u305d\u3046\uff01\n\n\n\n[lambda-hanson]:http://www.slideshare.net/AmazonWebServicesJapan/aws-lambda-2tier\n\n[lambda-update]:https://aws.amazon.com/jp/blogs/aws/aws-lambda-update-run-java-code-in-response-to-events/\n\n\n\n", "tags": ["kuromoji", "lambda", "Java", "AWS"]}