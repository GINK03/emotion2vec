{"tags": ["Ruby", "Python", "\u81ea\u7136\u8a00\u8a9e\u51e6\u7406", "\u6a5f\u68b0\u5b66\u7fd2", "mecab"], "context": " More than 1 year has passed since last update.\n\n\u306f\u3058\u3081\u306b\n\u6a5f\u68b0\u5b66\u7fd2\u306b\u3064\u3044\u3066\u306e\u7406\u89e3\u3092\u4fc3\u9032\u3059\u308b\u305f\u3081\u3001\n\u30c7\u30fc\u30bf\u304b\u3089\u5206\u985e\u30e2\u30c7\u30eb\u3092\u81ea\u52d5\u3067\u69cb\u7bc9\u3059\u308b\u53e4\u5178\u7684\u306a\u65b9\u6cd5\u3067\u3042\u308b\u3001\n\u30ca\u30a4\u30fc\u30d6\u30d9\u30a4\u30ba\u5206\u985e\u5668\u3092\u5b9f\u88c5\u3057\u3066\u307f\u307e\u3057\u305f\u3002\n\u6700\u8fd1\u306fCloudVisionAPI\u306a\u3069\u5c02\u3089\u753b\u50cf\u89e3\u6790\u304c\u6d41\u884c\u3063\u3066\u3044\u307e\u3059\u304c\u3001\n\u521d\u5b66\u8005\u306b\u306f\u6577\u5c45\u304c\u9ad8\u305d\u3046\u3060\u3063\u305f\u305f\u3081\u3001\u307e\u305a\u306f\u81ea\u7136\u8a00\u8a9e\u51e6\u7406\u3067\u3059\u3002\n\u4eca\u56de\u306f\u3001TwitterAPI\u3092\u5229\u7528\u3057\u3066bot\u30a2\u30ab\u30a6\u30f3\u30c8\u304b\u3089\u540d\u8a00\u3092\u53ce\u96c6\u3057\u3001\n\u7fbd\u751f\u3055\u3093\u3068\u7fbd\u751f\u304f\u3093\u3092\u5206\u985e\u3059\u308b\u7fbd\u751f\u5206\u985e\u5668\u3092\u5b9f\u88c5\u3057\u307e\u3057\u305f\u3002\n\u5c1a\u3001API\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u306fRuby\u3001\u5206\u985e\u5668\u306fPython\u3067\u5b9f\u88c5\u3057\u3001\n\u5f62\u614b\u7d20\u89e3\u6790\u306b\u306fMeCab\u3092\u5229\u7528\u3057\u3066\u3044\u307e\u3059\u3002\n\u307e\u305f\u672c\u6765\u306a\u3089\u3070\u3069\u3061\u3089\u3082\u7fbd\u751f\u3055\u3093\u3068\u304a\u547c\u3073\u3057\u306a\u3051\u308c\u3070\u306a\u3089\u306a\u3044\u6240\u3001\n\u4fbf\u5b9c\u4e0a\u30d5\u30a3\u30ae\u30e5\u30a2\u30b9\u30b1\u30fc\u30bf\u30fc\u306e\u7fbd\u751f\u3055\u3093\u3092\u7fbd\u751f\u304f\u3093\u3068\u8868\u8a18\u3055\u305b\u3066\u9802\u304f\u4e8b\u3092\u304a\u8a31\u3057\u4e0b\u3055\u3044\u3002\n\nTweet\u30c7\u30fc\u30bf\u306e\u53ce\u96c6\nAPIClient\u306f\u3001Twitter Ruby Gem\u3092\u4f7f\u3063\u3066\u4e0b\u8a18\u306e\u901a\u308a\u5b9f\u88c5\u3057\u3066\u3044\u307e\u3059\u3002\nTwitterAPI\u306b\u306fRate Limits\u3068\u3044\u3046\u6642\u9593\u3042\u305f\u308a\u306e\u5b9f\u884c\u56de\u6570\u5236\u9650\u304c\u3042\u308a\u3001\n\u5927\u91cf\u306e\u30c4\u30a4\u30fc\u30c8\u3092\u53d6\u5f97\u3057\u3088\u3046\u3068\u3059\u308b\u306815\u5206\u307b\u3069\u30a4\u30f3\u30bf\u30fc\u30d0\u30eb\u3092\u631f\u3080\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\n\u9069\u5b9c\u30b3\u30fc\u30d2\u30fc\u30d6\u30ec\u30a4\u30af\u3092\u3068\u3063\u3066\u304f\u3060\u3055\u3044\u3002\n\nAPI\u8a8d\u8a3c\u8a2d\u5b9a\n\nrequire 'twitter'\n\nclient = Twitter::REST::Client.new do |config|\n  config.consumer_key = 'XXX'\n  config.consumer_secret = 'YYY'\n  config.access_token = 'hoge'\n  config.access_token_secret = 'fuga'\nend\n\n\n\u30c4\u30a4\u30fc\u30c8\u306e\u53d6\u5f97\nclient.user_timeline('TwitterUserID',{ count: 150}).each_with_index do |tl,i|\n    tw = client.status(tl.id)\n    tweet = tw.text\n\n    # \u91cd\u8907\u3092\u6392\u9664\n    if !tweets.include?(tweet)\n        puts tweet\n    end\nend\n\n\n\n\u5f62\u614b\u7d20\u89e3\u6790\n\u3055\u3066\u3001\u5148\u307b\u3069\u53d6\u5f97\u3057\u305f\u30c7\u30fc\u30bf\u3092\u52a0\u5de5\u3057\u307e\u3059\u3002\n\u5f8c\u8ff0\u3057\u307e\u3059\u304c\u3001\u4eca\u56de\u30c4\u30a4\u30fc\u30c8\u306b\u7fbd\u751f\u3055\u3093\u3084\u7fbd\u751f\u304f\u3093\u304c\u8a00\u3044\u305d\u3046\u306a\u5358\u8a9e\u304c\u542b\u307e\u308c\u308b\u304b\u3069\u3046\u304b\u3092\u6570\u91cf\u5316\u3057\u3066\u5206\u985e\u3059\u308b\u305f\u3081\u3001\u307e\u305a\u306f\u53ce\u96c6\u3057\u305f\u30c4\u30a4\u30fc\u30c8\u3092\u54c1\u8a5e\u5206\u89e3\u3057\u3066\u30012\u4eba\u306e\u30c4\u30a4\u30fc\u30c8\u306b\u983b\u51fa\u3059\u308b\u5358\u8a9e\u3092\u305d\u308c\u305e\u308c\u4e0a\u4f4d50\u4ef6\u3001\u8a08100\u4ef6\u3092\u5206\u985e\u306b\u7528\u3044\u308b\u5909\u6570\u3068\u3057\u3066\u30d4\u30c3\u30af\u30a2\u30c3\u30d7\u3057\u3066\u3044\u307e\u3059\u3002(\u5b9f\u969b\u306f\u91cd\u8907\u3082\u3042\u3063\u305f\u305f\u308191\u4ef6\u3067\u3059\u3002)\n\nMeCab\u3067\u30c4\u30a4\u30fc\u30c8\u3092\u54c1\u8a5e\u5206\u89e3\n\u307e\u305a\u4eca\u56de\u306f\u3001\u540d\u8a5e\u3001\u52d5\u8a5e\u3001\u5f62\u5bb9\u8a5e\u306e\u307f\u3092\u30ab\u30a6\u30f3\u30c8\u306e\u5bfe\u8c61\u3068\u3057\u307e\u3057\u305f\u3002\n(\u52d5\u8a5e\u3001\u5f62\u5bb9\u8a5e\u306e\u6d3b\u7528\u306f\u57fa\u672c\u5f62\u306b\u76f4\u3057\u3066\u3044\u307e\u3059)\n\n\u9664\u5916\u30ef\u30fc\u30c9\u30ea\u30b9\u30c8\n\u4e0b\u8a18\u306e\u901a\u308a\u4eba\u7269\u56fa\u6709\u306e\u8a9e\u5f59\u306b\u7121\u95a2\u4fc2\u3068\u601d\u308f\u308c\u308b\u5f62\u5f0f\u540d\u8a5e\u3084\u3001\n\u52d5\u8a5e\u5316\u3057\u305f\u540d\u8a5e\u30fb\u5f62\u5bb9\u8a5e\u306e\u5206\u304b\u3061\u66f8\u304d\u306b\u3088\u3063\u3066\u767a\u751f\u3057\u305f\u3068\u601d\u308f\u308c\u308b\u3001\n\u30ab\u30a6\u30f3\u30c8\u5bfe\u8c61\u5916\u3068\u3059\u308b\u5358\u8a9e\u306e\u30ea\u30b9\u30c8\u3092\u3044\u304f\u3064\u304b\u8a2d\u5b9a\u3057\u3066\u3044\u307e\u3059\u3002\nng_noun = [\"\u3053\u3068\", \"\u306e\", \"\u3082\u306e\", \"\u305d\u308c\", \"\u3068\u304d\", \"\u3001\", \"\uff64\", \"\u3002\", \"\uff61\", \"(\", \")\", \".\"]\nng_verb = [\"\u3059\u308b\", \"\u3044\u308b\", \"\u306a\u308b\", \"\u3042\u308b\"]\nng_adjective = [\"\u3088\u3046\"]\n\n\n\u983b\u51fa\u5358\u8a9e\u306e\u30ab\u30a6\u30f3\u30c8\n\u30ab\u30a6\u30f3\u30bf\u30fc\u4ed8\u304d\u30ea\u30b9\u30c8(\u30bf\u30d7\u30eb)\u751f\u6210\u306b\u306f collections \u30d1\u30c3\u30b1\u30fc\u30b8\u304c\u4fbf\u5229\u3067\u3059\u3002\n\u307e\u305f\u3001Python\u3068MeCab\u306e\u30d0\u30a4\u30f3\u30c7\u30a3\u30f3\u30b0\u306b\u306fnatto\u3092\u5229\u7528\u3057\u307e\u3057\u305f\u3002\n\nimport collections\n\nfrom sets import Set\nfrom natto import MeCab\n\ndef mostFrequentWords(file, num):\n  words = collections.Counter()\n\n  f = open(file)\n  line = f.readline()\n  while line:\n    # \u540d\u8a5e:surface=\"\u30b9\u30b1\u30fc\u30c8\", feature=\"\u540d\u8a5e,\u4e00\u822c,*,*,*,*,\u30b9\u30b1\u30fc\u30c8,\u30b9\u30b1\u30fc\u30c8,\u30b9\u30b1\u30fc\u30c8\"\n    # \u52d5\u8a5e:surface=\"\u6ed1\u308c\", feature=\"\u52d5\u8a5e,\u81ea\u7acb,*,*,\u4e00\u6bb5,\u672a\u7136\u5f62,\u6ed1\u308c\u308b,\u30b9\u30d9\u30ec,\u30b9\u30d9\u30ec\"\n    for node in mecab.parse(line, as_nodes=True):\n      features = node.feature.split(\",\")\n\n      if features[0] == \"\u540d\u8a5e\" and node.surface not in ng_noun:\n        words[node.surface] += 1\n      elif features[0] == \"\u52d5\u8a5e\" and features[6] not in ng_verb:\n        words[features[6]] += 1\n      elif features[0] == \"\u5f62\u5bb9\u8a5e\" and features[6] not in ng_adjective:\n        words[features[6]] += 1\n\n    line = f.readline()\n    return words.most_common(num\n\n\nwords[\"hanyu\"] = mostFrequentWords(\"hanyu_train.txt\", 50)\nwords[\"habu\"] = mostFrequentWords(\"habu_train.txt\", 50)\n\ntpl = words[\"hanyu\"] + words[\"habu\"]\nvocabulary = set([])\nfor word in tpl:\n  vocabulary.add(word[0])\n\n\n\u30ca\u30a4\u30fc\u30d6\u30d9\u30a4\u30ba\u5206\u985e\u5668\n\u3053\u3053\u304b\u3089\u82e5\u5e72\u3001\u6570\u5b66\u7684\u80cc\u666f\u306e\u89e3\u8aac\u3067\u3059\u3002\n\n\u30d9\u30a4\u30ba\u306e\u5b9a\u7406\n\u307e\u305a\u3001\u30ca\u30a4\u30fc\u30d6\u30d9\u30a4\u30ba\u5206\u985e\u5668\u306f\u78ba\u7387\u306b\u57fa\u3065\u3044\u305f\u5206\u985e\u5668\u3067\u3059\u3002\n\u4eca\u56de\u6c42\u3081\u305f\u3044\u306e\u306f\u3001\u3042\u308b\u6587\u66f8(\u3053\u3053\u3067\u306f\u4e00\u3064\u4e00\u3064\u306e\u30c4\u30a4\u30fc\u30c8) d \u304c\u4e0e\u3048\u3089\u308c\u305f\u6642\u3001\n\u305d\u308c\u304c\u3069\u306e\u30af\u30e9\u30b9(\u7fbd\u751f\u3055\u3093or\u7fbd\u751f\u304f\u3093) c \u306b\u5c5e\u3059\u308b\u78ba\u7387\u304b\u9ad8\u3044\u304b\u3069\u3046\u304b\u3067\u3059\u3002\n\u3053\u308c\u306f\u30c4\u30a4\u30fc\u30c8\u304c\u4e0e\u3048\u3089\u308c\u305f\u6642\u306e\u6761\u4ef6\u4ed8\u304d\u78ba\u7387\u3068\u3057\u3066 P(c|d) \u3068\u8868\u3059\u4e8b\u304c\u51fa\u6765\u307e\u3059\u3002\n\u305f\u3060\u3057\u3053\u306e\u4e8b\u5f8c\u78ba\u7387\u3092\u76f4\u63a5\u6c42\u3081\u308b\u3053\u3068\u306f\u96e3\u3057\u3044\u305f\u3081\u3001\u30d9\u30a4\u30ba\u306e\u5b9a\u7406\u3092\u7528\u3044\u3066\u8a08\u7b97\u3057\u307e\u3059\u3002\nP(c|d) = \\frac{P(c)P(d|c)}{P(d)}\n\nP(c|d)=P(c)P(d|c)P(d){P(c|d) = \\frac{P(c)P(d|c)}{P(d)}\n\n}\n\u3053\u3053\u3067\u3001\u53f3\u8fba\u3092\u5404\u30af\u30e9\u30b9\u3001\u3064\u307e\u308a\u7fbd\u751f\u3055\u3093\uff0f\u7fbd\u751f\u304f\u3093\u305d\u308c\u305e\u308c\u306b\u3064\u3044\u3066\u8a08\u7b97\u3057\u3001\n\u30c4\u30a4\u30fc\u30c8\u304c\u3069\u3061\u3089\u306b\u5c5e\u3059\u308b\u78ba\u7387\u304c\u9ad8\u3044\u304b\u3069\u3046\u304b\u3092\u6c42\u3081\u307e\u3059\u3002\n\u305f\u3060\u3057\u5206\u6bcd P(d) \u306f\u5206\u985e\u5668\u3092\u69cb\u7bc9\u3057\u3066\u3057\u307e\u3048\u3070\u3001\u30af\u30e9\u30b9\u3068\u306f\u7121\u95a2\u4fc2\u306b\u4e00\u5b9a\u306e\u305f\u3081\u3001\n\u5206\u5b50\u306e\u307f\u8a08\u7b97\u3059\u308c\u3070\u3088\u304b\u308d\u3046\u306a\u306e\u3060\u3068\u3044\u3046\u4e8b\u306b\u306a\u308a\u307e\u3059\u3002\n\nP(c)\n\n\u4eca\u56de\u306f\u7fbd\u751f\u3055\u3093\u3068\u7fbd\u751f\u304f\u3093\u305d\u308c\u305e\u308c\u306e\u30c4\u30a4\u30fc\u30c8\u3092100\u4ef6\u305a\u3064\u53d6\u5f97\u3057\u300170\u4ef6\u3092\u5206\u985e\u5668\u306e\u69cb\u7bc9\u306e\u305f\u3081\u306e\u8a13\u7df4\u30c7\u30fc\u30bf\u3001\n30\u4ef6\u3092\u5206\u985e\u5668\u306e\u7cbe\u5ea6\u691c\u8a3c\u306e\u305f\u3081\u306e\u30c6\u30b9\u30c8\u30c7\u30fc\u30bf\u3068\u3057\u3066\u3044\u307e\u3059\u3002\nP(c) \u306f\u305d\u306e\u30af\u30e9\u30b9\u306e\u751f\u8d77\u78ba\u7387\u306a\u306e\u3067\u3001\u5168\u8a13\u7df4\u30c7\u30fc\u30bf\u4e2d\u306e\u3001\u305d\u308c\u305e\u308c\u306e\u5272\u5408\u306b\u306a\u308a\u307e\u3059\u3002\n\u4eca\u56de\u8a13\u7df4\u30c7\u30fc\u30bf\u306e\u4ef6\u6570\u306f\u540c\u3058\u306a\u306e\u3067\u3001\nP(\u7fbd\u751f\u3055\u3093)\u3001P(\u7fbd\u751f\u304f\u3093)\u306f\u3069\u3061\u3089\u3082 70 / 140 = 0.5 \u3067\u3059\u3002\n\nP(d|c)\n\n\u3055\u3066\u3001\u3053\u306e\u6761\u4ef6\u4ed8\u304d\u78ba\u7387 P(d|c) \u306e\u610f\u5473\u3092\u771f\u3063\u5f53\u306b\u8003\u3048\u308b\u3068\u7fbd\u751f\u3055\u3093\u3001\n\u7fbd\u751f\u304f\u3093\u305d\u308c\u305e\u308c\u304c\u767a\u8a00\u3057\u3046\u308b\u5358\u8a9e\u306e\u7a2e\u985e\u306e\u305d\u306e\u7d44\u307f\u5408\u308f\u305b\u3067\u4ee5\u3063\u3066\u3001\n\u4e00\u3064\u4e00\u3064\u306e\u30c4\u30a4\u30fc\u30c8\u304c\u751f\u8d77\u3059\u308b\u78ba\u7387\u3092\u6c42\u3081\u306a\u3051\u308c\u3070\u3044\u3051\u306a\u3044\u308f\u3051\u3067\u3059\u304c\u3001\u5230\u5e95\u7121\u7406\u306a\u8a71\u3067\u3059\u3002\n\u305d\u3053\u3067\u3001\u6587\u66f8\u5206\u985e\u306b\u9069\u3057\u305f\u7c21\u7565\u5316\u3057\u305f\u30e2\u30c7\u30eb\u3092\u5229\u7528\u3057\u3066\u8868\u3057\u307e\u3059\u3002\n\u3053\u3053\u3067\u306f \u7fbd\u751f\u3055\u3093\u3084\u7fbd\u751f\u304f\u3093\u304c\u8a00\u3044\u305d\u3046\u306a\u5358\u8a9e\u306e\u96c6\u5408 V \u306b\u3064\u3044\u3066\u3001\n\u305d\u308c\u3089\u304c\u5206\u985e\u306b\u639b\u3051\u3089\u308c\u305f\u30c4\u30a4\u30fc\u30c8\u306b\u542b\u307e\u308c\u308b\u304b\u542b\u307e\u308c\u306a\u3044\u304b\u3069\u3046\u304b \u3092\u8003\u3048\u307e\u3059\u3002\n\n\u591a\u5909\u6570\u30d9\u30eb\u30cc\u30fc\u30a4\u30e2\u30c7\u30eb\n\u8a00\u3063\u305f\uff0f\u8a00\u308f\u306a\u3044\u306e\u3088\u3046\u306a2\u5024\u3092\u3068\u308b\u78ba\u7387\u5909\u6570\u306e\u5206\u5e03\u3068\u8a00\u3048\u3070\u3001\u30d9\u30eb\u30cc\u30fc\u30a4\u5206\u5e03\u3067\u3059\u3002\n{P_{w,c}}^{\\delta_{w,d}}(1-{P_{w,c}})^{1-\\delta_{w,d}}\nPw,c\u03b4w,d(1\u2212Pw,c)1\u2212\u03b4w,d{{P_{w,c}}^{\\delta_{w,d}}(1-{P_{w,c}})^{1-\\delta_{w,d}}\n}\n\u3053\u306e\u6307\u6570\u90e8\u5206\u3092\u30c7\u30eb\u30bf\u95a2\u6570\u3068\u3044\u3044\u3001w = d \u306e\u6642\u306b0\u3001\u305d\u3046\u3067\u306a\u3051\u308c\u30701\u304c\u51fa\u529b\u3055\u308c\u307e\u3059\u3002\n\u4e0a\u624b\u304f\u8003\u3048\u3089\u308c\u3066\u307e\u3059\u306d\u3002\n\u3053\u3053\u3067\u306f\u96c6\u5408 V \u306b\u5c5e\u3059\u308b\u305d\u308c\u305e\u308c\u306e\u5358\u8a9e w \u306b\u3064\u3044\u3066\u30d9\u30eb\u30cc\u30fc\u30a4\u5206\u5e03\u3092\u8003\u3048\u308b\u3001\n\u591a\u5909\u6570\u30d9\u30eb\u30cc\u30fc\u30a4\u30e2\u30c7\u30eb\u3067 P(d|c) \u3092\u8868\u3057\u307e\u3059\u3002\n\\prod_{w \\in V}{P_{w,c}}^{\\delta_{w,d}}(1-{P_{w,c}})^{1-\\delta_{w,d}}\n\u220fw\u2208VPw,c\u03b4w,d(1\u2212Pw,c)1\u2212\u03b4w,d{\\prod_{w \\in V}{P_{w,c}}^{\\delta_{w,d}}(1-{P_{w,c}})^{1-\\delta_{w,d}}\n}\n\u3061\u306a\u307f\u306b\u4e0a\u8a18\u304b\u3089\u591a\u5909\u6570\u30d9\u30eb\u30cc\u30fc\u30a4\u30e2\u30c7\u30eb\u306e\u7279\u5fb4\u3068\u3057\u3066\u4e0b\u8a18\u306e2\u70b9\u304c\u8aad\u307f\u53d6\u308c\u307e\u3059\u3002\n\n\u6587\u66f8\u4e2d\u306e\u5358\u8a9e\u306e\u751f\u8d77\u56de\u6570\u306f\u8003\u616e\u3055\u308c\u3066\u3044\u306a\u3044\n\u6587\u66f8\u4e2d\u306b\u5358\u8a9e\u304c\u300c\u751f\u8d77\u3057\u306a\u304b\u3063\u305f\u300d\u3068\u3044\u3046\u4e8b\u8c61\u304c\u91cd\u8981\u8996\u3055\u308c\u308b\n\n\n\u6700\u5c24\u6cd5\n\u307e\u3068\u3081\u308b\u3068\u4e0b\u8a18\u306e\u901a\u308a\u8868\u305b\u308b\u306e\u3067\u3001\u53f3\u8fba\u3092\u7fbd\u751f\u3055\u3093\u3068\u7fbd\u751f\u304f\u3093\u305d\u308c\u305e\u308c\u306b\u3064\u3044\u3066\u8a08\u7b97\u3057\u3001\n\u5024\u306e\u5927\u304d\u3044\u65b9 = \u3069\u3061\u3089\u3092\u4eee\u5b9a\u3059\u308b\u3068\u30c7\u30fc\u30bf\u304c\u751f\u6210\u3055\u308c\u308b\u78ba\u7387\u304c\u9ad8\u3044\u304b\u3069\u3046\u304b \u3092\u5224\u5b9a\u3057\u307e\u3059\u3002\n\u3053\u306e\u300c\u4eee\u8aacc\u306e\u3082\u3068\u3067\u89b3\u5bdfd\u304c\u751f\u3058\u308b\u78ba\u7387\u306e\u7a4d\u300d\u306e\u4e8b\u3092\u5c24\u5ea6\u3068\u3044\u3044\u3001\u3053\u306e\u5c24\u5ea6\u304c\u6700\u5927\u3068\u306a\u308b\u6700\u3082\u5c24\u3082\u3089\u3057\u3044c\u3092\u898b\u3064\u3051\u308b\u30a2\u30d7\u30ed\u30fc\u30c1\u3092\u6700\u5c24\u6cd5\u3068\u8a00\u3044\u307e\u3059\u3002\nP(D) = {P(c)P(d|c)} = p_c\\prod_{w \\in V}({P_{w,c}}^{\\delta_{w,d}}(1-{P_{w,c}})^{1-\\delta_{w,d}})\nP(D)=P(c)P(d|c)=pc\u220fw\u2208V(Pw,c\u03b4w,d(1\u2212Pw,c)1\u2212\u03b4w,d){P(D) = {P(c)P(d|c)} = p_c\\prod_{w \\in V}({P_{w,c}}^{\\delta_{w,d}}(1-{P_{w,c}})^{1-\\delta_{w,d}})\n}\n\u6570\u5f0f\u306e\u8a18\u8ff0\u304c\u8da3\u65e8\u3067\u306f\u306a\u3044\u306e\u3067\u9014\u4e2d\u5f0f\u3092\u5927\u5206\u7aef\u6298\u308a\u307e\u3059\u304c\u5909\u5f62\u3059\u308b\u3068\u3001\n\\log P(D) = \\sum N_c \\log p_c + \\sum_c \\sum_{w \\in V} N_{w,c} \\log p_{w,c} + \\sum_c \\sum_{w \\in V} (N_c - N_{w,c}) \\log(1 - p_{w,c})\nlogP(D)=\u2211Nclogpc+\u2211c\u2211w\u2208VNw,clogpw,c+\u2211c\u2211w\u2208V(Nc\u2212Nw,c)log(1\u2212pw,c){\\log P(D) = \\sum N_c \\log p_c + \\sum_c \\sum_{w \\in V} N_{w,c} \\log p_{w,c} + \\sum_c \\sum_{w \\in V} (N_c - N_{w,c}) \\log(1 - p_{w,c})\n}\n\u3053\u3046\u306a\u308a\u307e\u3059\u3002\n\u30c7\u30eb\u30bf\u95a2\u6570\u304c\u3069\u3053\u306b\u884c\u3063\u305f\u3093\u3060\u3068\u3044\u3046\u611f\u3058\u3067\u3059\u304c\u3001\u524d\u8ff0\u306e\u3068\u304a\u308a w = d \u306e\u6642\u306b0\u3001\u305d\u3046\u3067\u306a\u3051\u308c\u30701\u3068\u306a\u308b\u6027\u8cea\u304c\u3042\u308b\u305f\u3081\u3001\u5358\u8a9e w \u3068 \u30af\u30e9\u30b9 c \u306e\u5171\u8d77\u56de\u6570\u3092\u639b\u3051\u308b\u4e8b\u3067\u8868\u3057\u3066\u3044\u307e\u3059\u3002\n\u306a\u3093\u3060\u304b\u8aad\u3080\u306e\u3082\u5acc\u306b\u306a\u308a\u305d\u3046\u3067\u3059\u304c\u3001\u30dd\u30a4\u30f3\u30c8\u306f\u5206\u5e03\u304cPw,c\u3001Pc\u3068\u3044\u30462\u3064\u306e\u30d1\u30e9\u30e1\u30fc\u30bf\u3067\u6c7a\u5b9a\u3055\u308c\u308b\u3068\u3044\u3046\u70b9\u3067\u3059\u3002\n\u5206\u985e\u3059\u308b\u30c7\u30fc\u30bf\u3092\u4e0e\u3048\u305f\u969b\u306b\u4e0a\u8a18\u306elogP(D)\u3092\u6700\u5927\u5316\u3059\u308bc\u3092\u898b\u3064\u3051\u308c\u3070\u826f\u3044\u308f\u3051\u3067\u3059\u304c\u3001\n\u3053\u3053\u3067\u306f\u4e16\u306e\u4e2d\u306e\u30c4\u30a4\u30fc\u30c8\u306f\u5168\u3066\u7fbd\u751f\u3055\u3093\u304b\u7fbd\u751f\u304f\u3093\u306b\u3088\u3063\u3066\u66f8\u304b\u308c\u3066\u3044\u308b\u4e8b\u3092\u524d\u63d0\u3068\u3057\u3066\u3044\u308b\u305f\u3081\u3001\n\u305d\u308c\u305e\u308c\u306e\u30af\u30e9\u30b9\u306b\u5206\u985e\u3055\u308c\u308b\u78ba\u7387\u3092\u8db3\u3057\u4e0a\u3052\u308b\u30681\u306b\u306a\u308b\u3068\u3044\u3046\u3001\u4e0b\u8a18\u306e\u6570\u5f0f\u3067\u8868\u3055\u308c\u308b\u5236\u7d04\u3092\u6e80\u305f\u3059\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\n\\sum_c p_c = 1\n\u2211cpc=1{\\sum_c p_c = 1\n}\n(\u3053\u3053\u3082\u672c\u984c\u3067\u306f\u306a\u3044\u306e\u3067\u7aef\u6298\u308a\u307e\u3059\u304c)\u3053\u308c\u306f\u7b49\u5f0f\u5236\u7d04\u4ed8\u304d\u51f8\u8a08\u753b\u554f\u984c\u3068\u3044\u3044\u3001\n\u30e9\u30b0\u30e9\u30f3\u30b8\u30e5\u306e\u672a\u5b9a\u4e57\u6570\u6cd5\u3068\u3044\u3046\u65b9\u6cd5\u3067\u5b9a\u7fa9\u3057\u305f\u30e9\u30b0\u30e9\u30f3\u30b8\u30e5\u95a2\u6570\u306b\u5bfe\u3057\u3066\u3001\n\u305d\u308c\u305e\u308c\u306e\u30d1\u30e9\u30e1\u30fc\u30bf\u306b\u3064\u3044\u3066\u504f\u5fae\u5206\u3092\u53d6\u308b\u4e8b\u3067\u6700\u5927\u5024\u304c\u4e0b\u8a18\u306e\u901a\u308a\u6c42\u3081\u3089\u308c\u307e\u3059\u3002\n\np_{w,c} = \\frac {N_{w,c}} {N_c} , p_c = \\frac {N_c} {\\sum_c N_c}\n\npw,c=Nw,cNc,pc=Nc\u2211cNc{\np_{w,c} = \\frac {N_{w,c}} {N_c} , p_c = \\frac {N_c} {\\sum_c N_c}\n\n}\n\n\u5206\u985e\u5668\u306e\u5b9f\u88c5\n\u30d1\u30e9\u30e1\u30fc\u30bf\u306e\u6c42\u3081\u65b9\u304c\u308f\u304b\u3063\u305f\u6240\u3067\u3001\u3044\u3088\u3044\u3088\u5b9f\u88c5\u306b\u5165\u308a\u307e\u3059\u3002\n\n\u30c7\u30fc\u30bf\u306e\u751f\u6210\n\u3055\u3066\u3001\u5f62\u614b\u7d20\u89e3\u6790\u306b\u639b\u3051\u305f\u30c4\u30a4\u30fc\u30c8\u304b\u3089\u3001\u4e0b\u8a18\u306e\u3088\u3046\u306a\u8a13\u7df4\u30c7\u30fc\u30bf\u3092\u751f\u6210\u3057\u307e\u3057\u305f\u3002\n\ncls = [\"habu\", \"hanyu\"]\n\n# \u90fd\u5408\u3067\u304a\u898b\u305b\u3067\u304d\u306a\u3044\u305f\u3081\u30a4\u30e1\u30fc\u30b8\u3067\u3059\u3002\u524d\u8ff0\u306e\u901a\u308a\u30c4\u30a4\u30fc\u30c8\u3092\u5f62\u614b\u7d20\u89e3\u6790\u306b\u639b\u3051\u3066\u751f\u6210\u3057\u307e\u3059\u3002\nvocabulary = [\"\u30b9\u30b1\u30fc\u30c8\", \"\u30d7\u30eb\u30b7\u30a7\u30f3\u30b3\", \"\u52dd\u8ca0\", \"\u795e\u306e\u4e00\u624b\"] \n\n# \u540c\u69d8\ndocuments[\"habu\"] = [[\"\u30bf\u30a4\u30c8\u30eb\u30db\u30eb\u30c0\u30fc\u201d\uff0c \"70\", \"\u4eba\", \"\u534a\u5206\", \"\u7fbd\u751f\"],[...]]\ndocuments[\"hanyu\"] = [[\u201d\u7d20\u6674\u3089\u3057\u3044\u201d\uff0c \"4\u56de\u8ee2\", \"\u6210\u529f\u3057\u305f\", \"\u512a\u52dd\"],[...]]\n\n\n\u540c\u6642\u78ba\u7387 p(w,c) \u306e\u8a08\u7b97\n\u4e0a\u8a18\u306e\u30c7\u30fc\u30bf\u3068\u6c42\u3081\u305f\u6570\u5f0f\u304b\u3089\u3001\u5404\u30af\u30e9\u30b9\u6bce\u306b\u5358\u8a9e\u304c\u751f\u8d77\u3059\u308b\u540c\u6642\u78ba\u7387 p(w,c) \u3092\u8a08\u7b97\u3057\u307e\u3059\u3002\ndef train(cls, vocabulary, documents):\n\n  # \u5404\u8a13\u7df4\u6587\u66f8\u306e\u751f\u8d77\u56de\u6570\n  n_cls = {}\n  total = 0.0\n  for c in cls:\n    n_cls[c] = len(documents[c])\n    total += n_cls[c]\n\n  # \u5404\u8a13\u7df4\u6587\u66f8\u306e\u751f\u8d77\u78ba\u7387\n  p_cls = {}\n  for c in cls:\n    p_cls[c] = n_cls[c] / total\n\n  # \u5404\u30af\u30e9\u30b9\u6bce\u306e\u5358\u8a9e\u306e\u751f\u8d77\u56de\u6570\n  for c in cls:\n    for d in documents[c]:\n      for word in vocabulary:\n        if word in d:\n          n_word[c][word] += 1\n\n\u3000# \u5404\u30af\u30e9\u30b9\u6bce\u306e\u5358\u8a9e\u306e\u751f\u8d77\u78ba\u7387\n  for c in cls:\n    p_word[c] = {}\n    for word in vocabulary:\n      p_word[c][word] = \\\n        (n_word[c][word] + 1) / (n_cls[c] + 2)\n\n\n\n\u30b9\u30e0\u30fc\u30b8\u30f3\u30b0\n\u3061\u3087\u3063\u3068\u4f59\u8ac7\u3067\u3059\u3002\n\u5404\u30af\u30e9\u30b9\u6bce\u306e\u5358\u8a9e\u306e\u751f\u8d77\u78ba\u7387\u3092\u6c42\u3081\u3066\u3044\u308b\u90e8\u5206\u3067\u5206\u5b50\u306b1\u3001\u5206\u6bcd\u306b2\u3092\u8db3\u3057\u3066\u3044\u307e\u3059\u304c\u3001\n\u3053\u308c\u306f\u5c24\u5ea6\u304c\u78ba\u7387\u306e\u7a4d\u3067\u3042\u308a\u3001\u8a9e\u5f59 V \u306e\u5358\u8a9e\u304c\u305f\u307e\u305f\u307e\u30c4\u30a4\u30fc\u30c8\u306b\u51fa\u73fe\u3057\u306a\u304b\u3063\u305f\u6642\n\u7a4d\u7b97\u306e\u7d50\u679c\u304c\u78ba\u7387\u304c0\u306b\u306a\u3063\u3066\u3057\u307e\u3046\u4e8b\u3092\u9632\u3050\u305f\u3081\u3067\u3059\u3002\n(\u6975\u5c0f\u3055\u306a\u5024\u306b\u306a\u3063\u3066\u3057\u307e\u3046\u305f\u3081\u5b9f\u88c5\u4e0a\u5bfe\u6570\u3092\u3068\u3063\u3066\u548c\u306e\u5f62\u306b\u306a\u3063\u3066\u3044\u307e\u3059\u304c\u3001\n\u5bfe\u6570\u306e\u5b9a\u7fa9\u57df\u306b\u30820\u306f\u5b58\u5728\u3057\u306a\u3044\u306e\u3067math domain error\u3067\u30d7\u30ed\u30b0\u30e9\u30e0\u304c\u30b3\u30b1\u307e\u3059)\n\u305d\u306e\u305f\u3081\u901a\u5e38\u306f\u5358\u8a9e\u306e\u51fa\u73fe\u3057\u3084\u3059\u3055\u306b\u30010\u3092\u53d6\u308a\u306b\u304f\u3044\u30c7\u30a3\u30ea\u30af\u30ec\u5206\u5e03\u3068\u3044\u3046\u78ba\u7387\u5206\u5e03\u3092\u4eee\u5b9a\u3057\u307e\u3059\u3002\n\u3053\u308c\u306f\u6700\u5c24\u6cd5\u306b\u3088\u3063\u3066\u51fa\u304c\u3061\u306a\u6975\u7aef\u306a\u5024\u3092\u3084\u308f\u3089\u304b\u304f\u3059\u308b\u50cd\u304d\u304c\u3042\u308b\u305f\u3081\u3001\u30b9\u30e0\u30fc\u30b8\u30f3\u30b0\u3068\u547c\u3070\u308c\u3066\u3044\u307e\u3059\u3002\n\u307e\u305f\u3001\u53b3\u5bc6\u306a\u30c7\u30fc\u30bf\u306e\u51fa\u73fe\u3057\u3084\u3059\u3055\u3067\u306a\u304f\u3001\u4e8b\u524d\u5206\u5e03\u3092\u52a0\u5473\u3057\u3066\u30c7\u30fc\u30bf\u304c\u4e0e\u3048\u3089\u308c\u305f\u5f8c\u306e\u78ba\u7387\u3092\u6700\u5927\u5316\u3057\u3088\u3046\u3068\u3059\u308b\u3053\u306e\u30a2\u30d7\u30ed\u30fc\u30c1\u3092MAP\u63a8\u5b9a\u3068\u8a00\u3044\u307e\u3059\u3002\n\n\u5b9f\u884c\u7d50\u679c\n\u3055\u3066\u3001\u3084\u3063\u3068\u5206\u985e\u5668\u304c\u69cb\u7bc9\u3067\u304d\u305f\u305f\u3081\u3001\u3044\u3088\u3044\u3088\u5b9f\u884c\u3057\u3066\u307f\u307e\u3059\u3002\n\n\u5206\u985e\u95a2\u6570\n\u69cb\u7bc9\u3057\u305f\u5206\u985e\u5668\u3092\u7528\u3044\u3066\u3001\u4e0e\u3048\u305f\u30c4\u30a4\u30fc\u30c8\u304c\u7fbd\u751f\u3055\u3093\u3068\u7fbd\u751f\u304f\u3093\u3001\n\u3069\u3061\u3089\u306b\u3088\u3063\u3066\u66f8\u304b\u308c\u305f\u6587\u66f8\u3067\u3042\u308b\u304b\u5206\u985e\u3059\u308b\u95a2\u6570\u3067\u3059\u3002\n\ndef classify(data):\n  # \u5404\u30af\u30e9\u30b9\u6bce\u306blogP(D)\u3092\u6c42\u3081\u308b\n  pp = {}\n  for c in cls:\n    pp[c] = math.log(p_cls[c])\n    for word in vocabulary:\n      if word in data:\n        pp[c] += math.log(p_word[c][word])\n\n      else:\n        pp[c] += math.log((1 - p_word[c][word]))\n\n # \u6c42\u3081\u305flogP(D)\u306e\u5185\u3001\u3069\u308c\u304c\u6700\u3082\u5927\u304d\u3044\u304b\u5224\u5b9a\n for c in cls:\n   maxpp = maxpp if 'maxpp' in locals() else pp[c]\n   maxcls = maxcls if 'maxcls' in locals() else c\n\n   if maxpp < pp[c]:\n     maxpp = pp[c]\n     maxcls =c\n\n   return (maxcls, maxpp)\n\n\n\n\u30e2\u30c7\u30eb\u306e\u7cbe\u5ea6\u691c\u8a3c\n\u53d6\u5f97\u3057\u305f\u30c4\u30a4\u30fc\u30c8\u306e\u5185\u3001\u7cbe\u5ea6\u691c\u8a3c\u7528\u306b\u3068\u3063\u3066\u304a\u3044\u305f30\u4ef6\u00d72\u4eba\u5206\u306e\u30c4\u30a4\u30fc\u30c8\u3092\u5206\u985e\u5668\u306b\u639b\u3051\u3066\u307f\u307e\u3059\u3002\ndef test(data, label):\n  i = 0.0\n  for tweet in data:\n    if nb.classify(tweet)[0] == label:\n      i += 1\n  return (i / len(data))\n\n# bags_of_words\u306f\u5404\u30c4\u30a4\u30fc\u30c8\u3092\u54c1\u8a5e\u5206\u89e3\u3057\u305f\uff12\u6b21\u5143\u914d\u5217\u3092\u8fd4\u3057\u307e\u3059\ntest(bags_of_words(\"hanyu_test.txt\"), \"hanyu\")\ntest(bags_of_words(\"habu_test.txt\"), \"habu\")\n\n\n\n\n\u30af\u30e9\u30b9\n\u2460\u30c6\u30b9\u30c8\u30c7\u30fc\u30bf\u4ef6\u6570\n\u2461\u6b63\u7b54\u6570\n\u6b63\u7b54\u7387(\u2461/\u2460)\n\n\n\n\n\u7fbd\u751f\u3055\u3093\n30\n28\n93.33%\n\n\n\u7fbd\u751f\u304f\u3093\n30\n28\n93.33%\n\n\n\n\u304b\u306a\u308a\u9ad8\u7cbe\u5ea6\u3067\u5224\u5225\u3067\u304d\u3066\u3044\u307e\u3059\u304c\u3001\n\u3053\u308c\u306f\u7fbd\u751f\u3055\u3093\u3068\u7fbd\u751f\u304f\u3093\u306b\u305d\u308c\u305e\u308c\u306b\u56fa\u6709\u306e\u8a9e\u5f59\u304c\u591a\u304f\u542b\u307e\u308c\u3066\u3044\u305f\u304b\u3089\u3068\u601d\u308f\u308c\u307e\u3059\u3002\n\u672c\u6765\u306f\u540c\u3058\u8a9e\u5f59\u3067\u3001\u983b\u5ea6\u304c\u9055\u3046\u3088\u3046\u306a\u5206\u5e03\u306e\u30c7\u30fc\u30bf\u3092\u5206\u985e\u3059\u308b\u3068\u3053\u308d\u306b\u610f\u7fa9\u304c\u3042\u308b\u305f\u3081\u3001\n\u305d\u306e\u70b9\u3067\u306f\u30c6\u30b9\u30c8\u30c7\u30fc\u30bf\u304c\u3042\u307e\u308a\u3088\u304f\u306a\u304b\u3063\u305f\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u306d\u3002\n\n\u4eca\u5f8c\n\u6b21\u306f\u7fbd\u751f\u3055\u3093\u3068\u7fbd\u751f\u304f\u3093\u306e\u753b\u50cf\u306e\u89e3\u6790\u3092\u3084\u3063\u3066\u307f\u305f\u3044\u3067\u3059\u3002\n\n\u53c2\u8003\u6587\u732e\n\u8a00\u8a9e\u51e6\u7406\u306e\u305f\u3081\u306e\u6a5f\u68b0\u5b66\u7fd2\u5165\u9580\n\u7fbd\u751f\u7d50\u5f26\u3068\u7fbd\u751f\u5584\u6cbb\u306e\u9055\u3044\n# \u306f\u3058\u3081\u306b\n\n\u6a5f\u68b0\u5b66\u7fd2\u306b\u3064\u3044\u3066\u306e\u7406\u89e3\u3092\u4fc3\u9032\u3059\u308b\u305f\u3081\u3001\n\u30c7\u30fc\u30bf\u304b\u3089\u5206\u985e\u30e2\u30c7\u30eb\u3092\u81ea\u52d5\u3067\u69cb\u7bc9\u3059\u308b\u53e4\u5178\u7684\u306a\u65b9\u6cd5\u3067\u3042\u308b\u3001\n\u30ca\u30a4\u30fc\u30d6\u30d9\u30a4\u30ba\u5206\u985e\u5668\u3092\u5b9f\u88c5\u3057\u3066\u307f\u307e\u3057\u305f\u3002\n\u6700\u8fd1\u306f[CloudVisionAPI](https://cloud.google.com/vision/)\u306a\u3069\u5c02\u3089\u753b\u50cf\u89e3\u6790\u304c\u6d41\u884c\u3063\u3066\u3044\u307e\u3059\u304c\u3001\n\u521d\u5b66\u8005\u306b\u306f\u6577\u5c45\u304c\u9ad8\u305d\u3046\u3060\u3063\u305f\u305f\u3081\u3001\u307e\u305a\u306f\u81ea\u7136\u8a00\u8a9e\u51e6\u7406\u3067\u3059\u3002\n\n\u4eca\u56de\u306f\u3001TwitterAPI\u3092\u5229\u7528\u3057\u3066bot\u30a2\u30ab\u30a6\u30f3\u30c8\u304b\u3089\u540d\u8a00\u3092\u53ce\u96c6\u3057\u3001\n[\u7fbd\u751f\u3055\u3093](https://twitter.com/habuyoshibot)\u3068[\u7fbd\u751f\u304f\u3093](https://twitter.com/Yuzuru_Hanyubot)\u3092\u5206\u985e\u3059\u308b**\u7fbd\u751f\u5206\u985e\u5668**\u3092\u5b9f\u88c5\u3057\u307e\u3057\u305f\u3002\n\n\u5c1a\u3001API\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u306fRuby\u3001\u5206\u985e\u5668\u306fPython\u3067\u5b9f\u88c5\u3057\u3001\n\u5f62\u614b\u7d20\u89e3\u6790\u306b\u306fMeCab\u3092\u5229\u7528\u3057\u3066\u3044\u307e\u3059\u3002\n\n\u307e\u305f\u672c\u6765\u306a\u3089\u3070\u3069\u3061\u3089\u3082\u7fbd\u751f\u3055\u3093\u3068\u304a\u547c\u3073\u3057\u306a\u3051\u308c\u3070\u306a\u3089\u306a\u3044\u6240\u3001\n\u4fbf\u5b9c\u4e0a\u30d5\u30a3\u30ae\u30e5\u30a2\u30b9\u30b1\u30fc\u30bf\u30fc\u306e\u7fbd\u751f\u3055\u3093\u3092\u7fbd\u751f\u304f\u3093\u3068\u8868\u8a18\u3055\u305b\u3066\u9802\u304f\u4e8b\u3092\u304a\u8a31\u3057\u4e0b\u3055\u3044\u3002\n\n# Tweet\u30c7\u30fc\u30bf\u306e\u53ce\u96c6\nAPIClient\u306f\u3001[Twitter Ruby Gem](https://github.com/sferik/twitter)\u3092\u4f7f\u3063\u3066\u4e0b\u8a18\u306e\u901a\u308a\u5b9f\u88c5\u3057\u3066\u3044\u307e\u3059\u3002\nTwitterAPI\u306b\u306f[Rate Limits](https://dev.twitter.com/rest/public/rate-limiting)\u3068\u3044\u3046\u6642\u9593\u3042\u305f\u308a\u306e\u5b9f\u884c\u56de\u6570\u5236\u9650\u304c\u3042\u308a\u3001\n\u5927\u91cf\u306e\u30c4\u30a4\u30fc\u30c8\u3092\u53d6\u5f97\u3057\u3088\u3046\u3068\u3059\u308b\u306815\u5206\u307b\u3069\u30a4\u30f3\u30bf\u30fc\u30d0\u30eb\u3092\u631f\u3080\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\n\u9069\u5b9c\u30b3\u30fc\u30d2\u30fc\u30d6\u30ec\u30a4\u30af\u3092\u3068\u3063\u3066\u304f\u3060\u3055\u3044\u3002\n\n## API\u8a8d\u8a3c\u8a2d\u5b9a\n```rb\n\nrequire 'twitter'\n\nclient = Twitter::REST::Client.new do |config|\n  config.consumer_key = 'XXX'\n  config.consumer_secret = 'YYY'\n  config.access_token = 'hoge'\n  config.access_token_secret = 'fuga'\nend\n```\n\n## \u30c4\u30a4\u30fc\u30c8\u306e\u53d6\u5f97\n```rb\nclient.user_timeline('TwitterUserID',{ count: 150}).each_with_index do |tl,i|\n\ttw = client.status(tl.id)\n\ttweet = tw.text\n        \n\t# \u91cd\u8907\u3092\u6392\u9664\n\tif !tweets.include?(tweet)\n\t\tputs tweet\n\tend\nend\n\n```\n\n# \u5f62\u614b\u7d20\u89e3\u6790\n\u3055\u3066\u3001\u5148\u307b\u3069\u53d6\u5f97\u3057\u305f\u30c7\u30fc\u30bf\u3092\u52a0\u5de5\u3057\u307e\u3059\u3002\n\u5f8c\u8ff0\u3057\u307e\u3059\u304c\u3001\u4eca\u56de**\u30c4\u30a4\u30fc\u30c8\u306b\u7fbd\u751f\u3055\u3093\u3084\u7fbd\u751f\u304f\u3093\u304c\u8a00\u3044\u305d\u3046\u306a\u5358\u8a9e\u304c\u542b\u307e\u308c\u308b\u304b\u3069\u3046\u304b**\u3092\u6570\u91cf\u5316\u3057\u3066\u5206\u985e\u3059\u308b\u305f\u3081\u3001\u307e\u305a\u306f\u53ce\u96c6\u3057\u305f\u30c4\u30a4\u30fc\u30c8\u3092\u54c1\u8a5e\u5206\u89e3\u3057\u3066\u30012\u4eba\u306e\u30c4\u30a4\u30fc\u30c8\u306b\u983b\u51fa\u3059\u308b\u5358\u8a9e\u3092\u305d\u308c\u305e\u308c\u4e0a\u4f4d50\u4ef6\u3001\u8a08100\u4ef6\u3092\u5206\u985e\u306b\u7528\u3044\u308b\u5909\u6570\u3068\u3057\u3066\u30d4\u30c3\u30af\u30a2\u30c3\u30d7\u3057\u3066\u3044\u307e\u3059\u3002(\u5b9f\u969b\u306f\u91cd\u8907\u3082\u3042\u3063\u305f\u305f\u308191\u4ef6\u3067\u3059\u3002)\n\n## MeCab\u3067\u30c4\u30a4\u30fc\u30c8\u3092\u54c1\u8a5e\u5206\u89e3\n\u307e\u305a\u4eca\u56de\u306f\u3001**\u540d\u8a5e\u3001\u52d5\u8a5e\u3001\u5f62\u5bb9\u8a5e**\u306e\u307f\u3092\u30ab\u30a6\u30f3\u30c8\u306e\u5bfe\u8c61\u3068\u3057\u307e\u3057\u305f\u3002\n(\u52d5\u8a5e\u3001\u5f62\u5bb9\u8a5e\u306e\u6d3b\u7528\u306f\u57fa\u672c\u5f62\u306b\u76f4\u3057\u3066\u3044\u307e\u3059)\n\n### \u9664\u5916\u30ef\u30fc\u30c9\u30ea\u30b9\u30c8\n\n\u4e0b\u8a18\u306e\u901a\u308a\u4eba\u7269\u56fa\u6709\u306e\u8a9e\u5f59\u306b\u7121\u95a2\u4fc2\u3068\u601d\u308f\u308c\u308b\u5f62\u5f0f\u540d\u8a5e\u3084\u3001\n\u52d5\u8a5e\u5316\u3057\u305f\u540d\u8a5e\u30fb\u5f62\u5bb9\u8a5e\u306e\u5206\u304b\u3061\u66f8\u304d\u306b\u3088\u3063\u3066\u767a\u751f\u3057\u305f\u3068\u601d\u308f\u308c\u308b\u3001\n\u30ab\u30a6\u30f3\u30c8\u5bfe\u8c61\u5916\u3068\u3059\u308b\u5358\u8a9e\u306e\u30ea\u30b9\u30c8\u3092\u3044\u304f\u3064\u304b\u8a2d\u5b9a\u3057\u3066\u3044\u307e\u3059\u3002\n\n```py\nng_noun = [\"\u3053\u3068\", \"\u306e\", \"\u3082\u306e\", \"\u305d\u308c\", \"\u3068\u304d\", \"\u3001\", \"\uff64\", \"\u3002\", \"\uff61\", \"(\", \")\", \".\"]\nng_verb = [\"\u3059\u308b\", \"\u3044\u308b\", \"\u306a\u308b\", \"\u3042\u308b\"]\nng_adjective = [\"\u3088\u3046\"]\n```\n\n### \u983b\u51fa\u5358\u8a9e\u306e\u30ab\u30a6\u30f3\u30c8\n\n\u30ab\u30a6\u30f3\u30bf\u30fc\u4ed8\u304d\u30ea\u30b9\u30c8(\u30bf\u30d7\u30eb)\u751f\u6210\u306b\u306f *collections* \u30d1\u30c3\u30b1\u30fc\u30b8\u304c\u4fbf\u5229\u3067\u3059\u3002\n\u307e\u305f\u3001Python\u3068MeCab\u306e\u30d0\u30a4\u30f3\u30c7\u30a3\u30f3\u30b0\u306b\u306f[natto](https://pypi.python.org/pypi/natto-py)\u3092\u5229\u7528\u3057\u307e\u3057\u305f\u3002\n\n```py\n\nimport collections\n\nfrom sets import Set\nfrom natto import MeCab\n\ndef mostFrequentWords(file, num):\n  words = collections.Counter()\n\n  f = open(file)\n  line = f.readline()\n  while line:\n    # \u540d\u8a5e:surface=\"\u30b9\u30b1\u30fc\u30c8\", feature=\"\u540d\u8a5e,\u4e00\u822c,*,*,*,*,\u30b9\u30b1\u30fc\u30c8,\u30b9\u30b1\u30fc\u30c8,\u30b9\u30b1\u30fc\u30c8\"\n    # \u52d5\u8a5e:surface=\"\u6ed1\u308c\", feature=\"\u52d5\u8a5e,\u81ea\u7acb,*,*,\u4e00\u6bb5,\u672a\u7136\u5f62,\u6ed1\u308c\u308b,\u30b9\u30d9\u30ec,\u30b9\u30d9\u30ec\"\n    for node in mecab.parse(line, as_nodes=True):\n      features = node.feature.split(\",\")\n    \n      if features[0] == \"\u540d\u8a5e\" and node.surface not in ng_noun:\n        words[node.surface] += 1\n      elif features[0] == \"\u52d5\u8a5e\" and features[6] not in ng_verb:\n        words[features[6]] += 1\n      elif features[0] == \"\u5f62\u5bb9\u8a5e\" and features[6] not in ng_adjective:\n        words[features[6]] += 1\n\n    line = f.readline()\n    return words.most_common(num\n\n\nwords[\"hanyu\"] = mostFrequentWords(\"hanyu_train.txt\", 50)\nwords[\"habu\"] = mostFrequentWords(\"habu_train.txt\", 50)\n\ntpl = words[\"hanyu\"] + words[\"habu\"]\nvocabulary = set([])\nfor word in tpl:\n  vocabulary.add(word[0])\n```\n\n# \u30ca\u30a4\u30fc\u30d6\u30d9\u30a4\u30ba\u5206\u985e\u5668\n\n\u3053\u3053\u304b\u3089\u82e5\u5e72\u3001\u6570\u5b66\u7684\u80cc\u666f\u306e\u89e3\u8aac\u3067\u3059\u3002\n\n## \u30d9\u30a4\u30ba\u306e\u5b9a\u7406\n\u307e\u305a\u3001\u30ca\u30a4\u30fc\u30d6\u30d9\u30a4\u30ba\u5206\u985e\u5668\u306f\u78ba\u7387\u306b\u57fa\u3065\u3044\u305f\u5206\u985e\u5668\u3067\u3059\u3002\n\u4eca\u56de\u6c42\u3081\u305f\u3044\u306e\u306f\u3001\u3042\u308b\u6587\u66f8(\u3053\u3053\u3067\u306f\u4e00\u3064\u4e00\u3064\u306e\u30c4\u30a4\u30fc\u30c8) *d* \u304c\u4e0e\u3048\u3089\u308c\u305f\u6642\u3001\n\u305d\u308c\u304c\u3069\u306e\u30af\u30e9\u30b9(\u7fbd\u751f\u3055\u3093or\u7fbd\u751f\u304f\u3093) *c* \u306b\u5c5e\u3059\u308b\u78ba\u7387\u304b\u9ad8\u3044\u304b\u3069\u3046\u304b\u3067\u3059\u3002\n\u3053\u308c\u306f\u30c4\u30a4\u30fc\u30c8\u304c\u4e0e\u3048\u3089\u308c\u305f\u6642\u306e\u6761\u4ef6\u4ed8\u304d\u78ba\u7387\u3068\u3057\u3066 *P(c|d)* \u3068\u8868\u3059\u4e8b\u304c\u51fa\u6765\u307e\u3059\u3002\n\u305f\u3060\u3057\u3053\u306e\u4e8b\u5f8c\u78ba\u7387\u3092\u76f4\u63a5\u6c42\u3081\u308b\u3053\u3068\u306f\u96e3\u3057\u3044\u305f\u3081\u3001**\u30d9\u30a4\u30ba\u306e\u5b9a\u7406**\u3092\u7528\u3044\u3066\u8a08\u7b97\u3057\u307e\u3059\u3002\n\n```math\nP(c|d) = \\frac{P(c)P(d|c)}{P(d)}\n\n```\n\n\u3053\u3053\u3067\u3001\u53f3\u8fba\u3092\u5404\u30af\u30e9\u30b9\u3001\u3064\u307e\u308a\u7fbd\u751f\u3055\u3093\uff0f\u7fbd\u751f\u304f\u3093\u305d\u308c\u305e\u308c\u306b\u3064\u3044\u3066\u8a08\u7b97\u3057\u3001\n\u30c4\u30a4\u30fc\u30c8\u304c\u3069\u3061\u3089\u306b\u5c5e\u3059\u308b\u78ba\u7387\u304c\u9ad8\u3044\u304b\u3069\u3046\u304b\u3092\u6c42\u3081\u307e\u3059\u3002\n\u305f\u3060\u3057\u5206\u6bcd *P(d)* \u306f\u5206\u985e\u5668\u3092\u69cb\u7bc9\u3057\u3066\u3057\u307e\u3048\u3070\u3001\u30af\u30e9\u30b9\u3068\u306f\u7121\u95a2\u4fc2\u306b\u4e00\u5b9a\u306e\u305f\u3081\u3001\n**\u5206\u5b50\u306e\u307f\u8a08\u7b97\u3059\u308c\u3070\u3088\u304b\u308d\u3046\u306a\u306e\u3060**\u3068\u3044\u3046\u4e8b\u306b\u306a\u308a\u307e\u3059\u3002\n\n### *P(c)*\n\u4eca\u56de\u306f\u7fbd\u751f\u3055\u3093\u3068\u7fbd\u751f\u304f\u3093\u305d\u308c\u305e\u308c\u306e\u30c4\u30a4\u30fc\u30c8\u3092100\u4ef6\u305a\u3064\u53d6\u5f97\u3057\u300170\u4ef6\u3092\u5206\u985e\u5668\u306e\u69cb\u7bc9\u306e\u305f\u3081\u306e\u8a13\u7df4\u30c7\u30fc\u30bf\u3001\n30\u4ef6\u3092\u5206\u985e\u5668\u306e\u7cbe\u5ea6\u691c\u8a3c\u306e\u305f\u3081\u306e\u30c6\u30b9\u30c8\u30c7\u30fc\u30bf\u3068\u3057\u3066\u3044\u307e\u3059\u3002\n*P(c)* \u306f\u305d\u306e\u30af\u30e9\u30b9\u306e\u751f\u8d77\u78ba\u7387\u306a\u306e\u3067\u3001\u5168\u8a13\u7df4\u30c7\u30fc\u30bf\u4e2d\u306e\u3001\u305d\u308c\u305e\u308c\u306e\u5272\u5408\u306b\u306a\u308a\u307e\u3059\u3002\n\u4eca\u56de\u8a13\u7df4\u30c7\u30fc\u30bf\u306e\u4ef6\u6570\u306f\u540c\u3058\u306a\u306e\u3067\u3001\n*P(\u7fbd\u751f\u3055\u3093)*\u3001*P(\u7fbd\u751f\u304f\u3093)*\u306f\u3069\u3061\u3089\u3082 *70 / 140 = 0.5* \u3067\u3059\u3002\n\n### *P(d|c)*\n\u3055\u3066\u3001\u3053\u306e\u6761\u4ef6\u4ed8\u304d\u78ba\u7387 *P(d|c)* \u306e\u610f\u5473\u3092\u771f\u3063\u5f53\u306b\u8003\u3048\u308b\u3068\u7fbd\u751f\u3055\u3093\u3001\n\u7fbd\u751f\u304f\u3093\u305d\u308c\u305e\u308c\u304c\u767a\u8a00\u3057\u3046\u308b\u5358\u8a9e\u306e\u7a2e\u985e\u306e\u305d\u306e\u7d44\u307f\u5408\u308f\u305b\u3067\u4ee5\u3063\u3066\u3001\n\u4e00\u3064\u4e00\u3064\u306e\u30c4\u30a4\u30fc\u30c8\u304c\u751f\u8d77\u3059\u308b\u78ba\u7387\u3092\u6c42\u3081\u306a\u3051\u308c\u3070\u3044\u3051\u306a\u3044\u308f\u3051\u3067\u3059\u304c\u3001\u5230\u5e95\u7121\u7406\u306a\u8a71\u3067\u3059\u3002\n\u305d\u3053\u3067\u3001\u6587\u66f8\u5206\u985e\u306b\u9069\u3057\u305f\u7c21\u7565\u5316\u3057\u305f\u30e2\u30c7\u30eb\u3092\u5229\u7528\u3057\u3066\u8868\u3057\u307e\u3059\u3002\n\u3053\u3053\u3067\u306f **\u7fbd\u751f\u3055\u3093\u3084\u7fbd\u751f\u304f\u3093\u304c\u8a00\u3044\u305d\u3046\u306a\u5358\u8a9e\u306e\u96c6\u5408 *V* \u306b\u3064\u3044\u3066\u3001\n\u305d\u308c\u3089\u304c\u5206\u985e\u306b\u639b\u3051\u3089\u308c\u305f\u30c4\u30a4\u30fc\u30c8\u306b\u542b\u307e\u308c\u308b\u304b\u542b\u307e\u308c\u306a\u3044\u304b\u3069\u3046\u304b** \u3092\u8003\u3048\u307e\u3059\u3002\n\n#### \u591a\u5909\u6570\u30d9\u30eb\u30cc\u30fc\u30a4\u30e2\u30c7\u30eb\n\u8a00\u3063\u305f\uff0f\u8a00\u308f\u306a\u3044\u306e\u3088\u3046\u306a2\u5024\u3092\u3068\u308b\u78ba\u7387\u5909\u6570\u306e\u5206\u5e03\u3068\u8a00\u3048\u3070\u3001**\u30d9\u30eb\u30cc\u30fc\u30a4\u5206\u5e03**\u3067\u3059\u3002\n\n```math\n{P_{w,c}}^{\\delta_{w,d}}(1-{P_{w,c}})^{1-\\delta_{w,d}}\n```\n\n\u3053\u306e\u6307\u6570\u90e8\u5206\u3092\u30c7\u30eb\u30bf\u95a2\u6570\u3068\u3044\u3044\u3001*w* = *d* \u306e\u6642\u306b0\u3001\u305d\u3046\u3067\u306a\u3051\u308c\u30701\u304c\u51fa\u529b\u3055\u308c\u307e\u3059\u3002\n\u4e0a\u624b\u304f\u8003\u3048\u3089\u308c\u3066\u307e\u3059\u306d\u3002\n\n\u3053\u3053\u3067\u306f\u96c6\u5408 *V* \u306b\u5c5e\u3059\u308b\u305d\u308c\u305e\u308c\u306e\u5358\u8a9e *w* \u306b\u3064\u3044\u3066\u30d9\u30eb\u30cc\u30fc\u30a4\u5206\u5e03\u3092\u8003\u3048\u308b\u3001\n**\u591a\u5909\u6570\u30d9\u30eb\u30cc\u30fc\u30a4\u30e2\u30c7\u30eb**\u3067 *P(d|c)* \u3092\u8868\u3057\u307e\u3059\u3002\n\n```math\n\\prod_{w \\in V}{P_{w,c}}^{\\delta_{w,d}}(1-{P_{w,c}})^{1-\\delta_{w,d}}\n```\n\n\u3061\u306a\u307f\u306b\u4e0a\u8a18\u304b\u3089\u591a\u5909\u6570\u30d9\u30eb\u30cc\u30fc\u30a4\u30e2\u30c7\u30eb\u306e\u7279\u5fb4\u3068\u3057\u3066\u4e0b\u8a18\u306e2\u70b9\u304c\u8aad\u307f\u53d6\u308c\u307e\u3059\u3002\n\n- \u6587\u66f8\u4e2d\u306e\u5358\u8a9e\u306e\u751f\u8d77\u56de\u6570\u306f\u8003\u616e\u3055\u308c\u3066\u3044\u306a\u3044\n- \u6587\u66f8\u4e2d\u306b\u5358\u8a9e\u304c\u300c\u751f\u8d77\u3057\u306a\u304b\u3063\u305f\u300d\u3068\u3044\u3046\u4e8b\u8c61\u304c\u91cd\u8981\u8996\u3055\u308c\u308b\n\n### \u6700\u5c24\u6cd5\n\u307e\u3068\u3081\u308b\u3068\u4e0b\u8a18\u306e\u901a\u308a\u8868\u305b\u308b\u306e\u3067\u3001\u53f3\u8fba\u3092\u7fbd\u751f\u3055\u3093\u3068\u7fbd\u751f\u304f\u3093\u305d\u308c\u305e\u308c\u306b\u3064\u3044\u3066\u8a08\u7b97\u3057\u3001\n\u5024\u306e\u5927\u304d\u3044\u65b9 = **\u3069\u3061\u3089\u3092\u4eee\u5b9a\u3059\u308b\u3068\u30c7\u30fc\u30bf\u304c\u751f\u6210\u3055\u308c\u308b\u78ba\u7387\u304c\u9ad8\u3044\u304b\u3069\u3046\u304b** \u3092\u5224\u5b9a\u3057\u307e\u3059\u3002\n\u3053\u306e\u300c\u4eee\u8aacc\u306e\u3082\u3068\u3067\u89b3\u5bdfd\u304c\u751f\u3058\u308b\u78ba\u7387\u306e\u7a4d\u300d\u306e\u4e8b\u3092**\u5c24\u5ea6**\u3068\u3044\u3044\u3001\u3053\u306e\u5c24\u5ea6\u304c\u6700\u5927\u3068\u306a\u308b\u6700\u3082\u5c24\u3082\u3089\u3057\u3044c\u3092\u898b\u3064\u3051\u308b\u30a2\u30d7\u30ed\u30fc\u30c1\u3092**\u6700\u5c24\u6cd5**\u3068\u8a00\u3044\u307e\u3059\u3002\n\n```math\nP(D) = {P(c)P(d|c)} = p_c\\prod_{w \\in V}({P_{w,c}}^{\\delta_{w,d}}(1-{P_{w,c}})^{1-\\delta_{w,d}})\n```\n\n\u6570\u5f0f\u306e\u8a18\u8ff0\u304c\u8da3\u65e8\u3067\u306f\u306a\u3044\u306e\u3067\u9014\u4e2d\u5f0f\u3092\u5927\u5206\u7aef\u6298\u308a\u307e\u3059\u304c\u5909\u5f62\u3059\u308b\u3068\u3001\n\n```math\n\\log P(D) = \\sum N_c \\log p_c + \\sum_c \\sum_{w \\in V} N_{w,c} \\log p_{w,c} + \\sum_c \\sum_{w \\in V} (N_c - N_{w,c}) \\log(1 - p_{w,c})\n```\n \n\u3053\u3046\u306a\u308a\u307e\u3059\u3002\n\u30c7\u30eb\u30bf\u95a2\u6570\u304c\u3069\u3053\u306b\u884c\u3063\u305f\u3093\u3060\u3068\u3044\u3046\u611f\u3058\u3067\u3059\u304c\u3001\u524d\u8ff0\u306e\u3068\u304a\u308a *w* = *d* \u306e\u6642\u306b0\u3001\u305d\u3046\u3067\u306a\u3051\u308c\u30701\u3068\u306a\u308b\u6027\u8cea\u304c\u3042\u308b\u305f\u3081\u3001\u5358\u8a9e *w* \u3068 \u30af\u30e9\u30b9 *c* \u306e\u5171\u8d77\u56de\u6570\u3092\u639b\u3051\u308b\u4e8b\u3067\u8868\u3057\u3066\u3044\u307e\u3059\u3002\n\u306a\u3093\u3060\u304b\u8aad\u3080\u306e\u3082\u5acc\u306b\u306a\u308a\u305d\u3046\u3067\u3059\u304c\u3001\u30dd\u30a4\u30f3\u30c8\u306f\u5206\u5e03\u304c**Pw,c\u3001Pc\u3068\u3044\u30462\u3064\u306e\u30d1\u30e9\u30e1\u30fc\u30bf\u3067\u6c7a\u5b9a\u3055\u308c\u308b**\u3068\u3044\u3046\u70b9\u3067\u3059\u3002\n\n\u5206\u985e\u3059\u308b\u30c7\u30fc\u30bf\u3092\u4e0e\u3048\u305f\u969b\u306b\u4e0a\u8a18\u306elogP(D)\u3092\u6700\u5927\u5316\u3059\u308bc\u3092\u898b\u3064\u3051\u308c\u3070\u826f\u3044\u308f\u3051\u3067\u3059\u304c\u3001\n\u3053\u3053\u3067\u306f**\u4e16\u306e\u4e2d\u306e\u30c4\u30a4\u30fc\u30c8\u306f\u5168\u3066\u7fbd\u751f\u3055\u3093\u304b\u7fbd\u751f\u304f\u3093\u306b\u3088\u3063\u3066\u66f8\u304b\u308c\u3066\u3044\u308b\u4e8b\u3092\u524d\u63d0**\u3068\u3057\u3066\u3044\u308b\u305f\u3081\u3001\n\u305d\u308c\u305e\u308c\u306e\u30af\u30e9\u30b9\u306b\u5206\u985e\u3055\u308c\u308b\u78ba\u7387\u3092\u8db3\u3057\u4e0a\u3052\u308b\u30681\u306b\u306a\u308b\u3068\u3044\u3046\u3001\u4e0b\u8a18\u306e\u6570\u5f0f\u3067\u8868\u3055\u308c\u308b\u5236\u7d04\u3092\u6e80\u305f\u3059\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\n\n```math\n\\sum_c p_c = 1\n```\n\n(\u3053\u3053\u3082\u672c\u984c\u3067\u306f\u306a\u3044\u306e\u3067\u7aef\u6298\u308a\u307e\u3059\u304c)\u3053\u308c\u306f\u7b49\u5f0f\u5236\u7d04\u4ed8\u304d\u51f8\u8a08\u753b\u554f\u984c\u3068\u3044\u3044\u3001\n\u30e9\u30b0\u30e9\u30f3\u30b8\u30e5\u306e\u672a\u5b9a\u4e57\u6570\u6cd5\u3068\u3044\u3046\u65b9\u6cd5\u3067\u5b9a\u7fa9\u3057\u305f\u30e9\u30b0\u30e9\u30f3\u30b8\u30e5\u95a2\u6570\u306b\u5bfe\u3057\u3066\u3001\n\u305d\u308c\u305e\u308c\u306e\u30d1\u30e9\u30e1\u30fc\u30bf\u306b\u3064\u3044\u3066\u504f\u5fae\u5206\u3092\u53d6\u308b\u4e8b\u3067\u6700\u5927\u5024\u304c\u4e0b\u8a18\u306e\u901a\u308a\u6c42\u3081\u3089\u308c\u307e\u3059\u3002\n\n```math\n\np_{w,c} = \\frac {N_{w,c}} {N_c} , p_c = \\frac {N_c} {\\sum_c N_c}\n\n```\n\n## \u5206\u985e\u5668\u306e\u5b9f\u88c5\n\n\u30d1\u30e9\u30e1\u30fc\u30bf\u306e\u6c42\u3081\u65b9\u304c\u308f\u304b\u3063\u305f\u6240\u3067\u3001\u3044\u3088\u3044\u3088\u5b9f\u88c5\u306b\u5165\u308a\u307e\u3059\u3002\n\n### \u30c7\u30fc\u30bf\u306e\u751f\u6210\n\n\u3055\u3066\u3001\u5f62\u614b\u7d20\u89e3\u6790\u306b\u639b\u3051\u305f\u30c4\u30a4\u30fc\u30c8\u304b\u3089\u3001\u4e0b\u8a18\u306e\u3088\u3046\u306a\u8a13\u7df4\u30c7\u30fc\u30bf\u3092\u751f\u6210\u3057\u307e\u3057\u305f\u3002\n\n```py\n\ncls = [\"habu\", \"hanyu\"]\n\n# \u90fd\u5408\u3067\u304a\u898b\u305b\u3067\u304d\u306a\u3044\u305f\u3081\u30a4\u30e1\u30fc\u30b8\u3067\u3059\u3002\u524d\u8ff0\u306e\u901a\u308a\u30c4\u30a4\u30fc\u30c8\u3092\u5f62\u614b\u7d20\u89e3\u6790\u306b\u639b\u3051\u3066\u751f\u6210\u3057\u307e\u3059\u3002\nvocabulary = [\"\u30b9\u30b1\u30fc\u30c8\", \"\u30d7\u30eb\u30b7\u30a7\u30f3\u30b3\", \"\u52dd\u8ca0\", \"\u795e\u306e\u4e00\u624b\"] \n\n# \u540c\u69d8\ndocuments[\"habu\"] = [[\"\u30bf\u30a4\u30c8\u30eb\u30db\u30eb\u30c0\u30fc\u201d\uff0c \"70\", \"\u4eba\", \"\u534a\u5206\", \"\u7fbd\u751f\"],[...]]\ndocuments[\"hanyu\"] = [[\u201d\u7d20\u6674\u3089\u3057\u3044\u201d\uff0c \"4\u56de\u8ee2\", \"\u6210\u529f\u3057\u305f\", \"\u512a\u52dd\"],[...]]\n```\n\n### \u540c\u6642\u78ba\u7387 *p(w,c)* \u306e\u8a08\u7b97\n\n\u4e0a\u8a18\u306e\u30c7\u30fc\u30bf\u3068\u6c42\u3081\u305f\u6570\u5f0f\u304b\u3089\u3001\u5404\u30af\u30e9\u30b9\u6bce\u306b\u5358\u8a9e\u304c\u751f\u8d77\u3059\u308b\u540c\u6642\u78ba\u7387 *p(w,c)* \u3092\u8a08\u7b97\u3057\u307e\u3059\u3002\n\n```py\ndef train(cls, vocabulary, documents):\n\n  # \u5404\u8a13\u7df4\u6587\u66f8\u306e\u751f\u8d77\u56de\u6570\n  n_cls = {}\n  total = 0.0\n  for c in cls:\n    n_cls[c] = len(documents[c])\n    total += n_cls[c]\n\n  # \u5404\u8a13\u7df4\u6587\u66f8\u306e\u751f\u8d77\u78ba\u7387\n  p_cls = {}\n  for c in cls:\n    p_cls[c] = n_cls[c] / total\n\n  # \u5404\u30af\u30e9\u30b9\u6bce\u306e\u5358\u8a9e\u306e\u751f\u8d77\u56de\u6570\n  for c in cls:\n    for d in documents[c]:\n      for word in vocabulary:\n        if word in d:\n          n_word[c][word] += 1\n\n\u3000# \u5404\u30af\u30e9\u30b9\u6bce\u306e\u5358\u8a9e\u306e\u751f\u8d77\u78ba\u7387\n  for c in cls:\n    p_word[c] = {}\n    for word in vocabulary:\n      p_word[c][word] = \\\n        (n_word[c][word] + 1) / (n_cls[c] + 2)\n\n```\n\n### \u30b9\u30e0\u30fc\u30b8\u30f3\u30b0\n\u3061\u3087\u3063\u3068\u4f59\u8ac7\u3067\u3059\u3002\n\u5404\u30af\u30e9\u30b9\u6bce\u306e\u5358\u8a9e\u306e\u751f\u8d77\u78ba\u7387\u3092\u6c42\u3081\u3066\u3044\u308b\u90e8\u5206\u3067\u5206\u5b50\u306b1\u3001\u5206\u6bcd\u306b2\u3092\u8db3\u3057\u3066\u3044\u307e\u3059\u304c\u3001\n\u3053\u308c\u306f\u5c24\u5ea6\u304c\u78ba\u7387\u306e\u7a4d\u3067\u3042\u308a\u3001\u8a9e\u5f59 *V* \u306e\u5358\u8a9e\u304c\u305f\u307e\u305f\u307e\u30c4\u30a4\u30fc\u30c8\u306b\u51fa\u73fe\u3057\u306a\u304b\u3063\u305f\u6642\n\u7a4d\u7b97\u306e\u7d50\u679c\u304c\u78ba\u7387\u304c0\u306b\u306a\u3063\u3066\u3057\u307e\u3046\u4e8b\u3092\u9632\u3050\u305f\u3081\u3067\u3059\u3002\n(\u6975\u5c0f\u3055\u306a\u5024\u306b\u306a\u3063\u3066\u3057\u307e\u3046\u305f\u3081\u5b9f\u88c5\u4e0a\u5bfe\u6570\u3092\u3068\u3063\u3066\u548c\u306e\u5f62\u306b\u306a\u3063\u3066\u3044\u307e\u3059\u304c\u3001\n\u5bfe\u6570\u306e\u5b9a\u7fa9\u57df\u306b\u30820\u306f\u5b58\u5728\u3057\u306a\u3044\u306e\u3067math domain error\u3067\u30d7\u30ed\u30b0\u30e9\u30e0\u304c\u30b3\u30b1\u307e\u3059)\n\n\u305d\u306e\u305f\u3081\u901a\u5e38\u306f\u5358\u8a9e\u306e\u51fa\u73fe\u3057\u3084\u3059\u3055\u306b\u30010\u3092\u53d6\u308a\u306b\u304f\u3044\u30c7\u30a3\u30ea\u30af\u30ec\u5206\u5e03\u3068\u3044\u3046\u78ba\u7387\u5206\u5e03\u3092\u4eee\u5b9a\u3057\u307e\u3059\u3002\n\u3053\u308c\u306f\u6700\u5c24\u6cd5\u306b\u3088\u3063\u3066\u51fa\u304c\u3061\u306a\u6975\u7aef\u306a\u5024\u3092\u3084\u308f\u3089\u304b\u304f\u3059\u308b\u50cd\u304d\u304c\u3042\u308b\u305f\u3081\u3001**\u30b9\u30e0\u30fc\u30b8\u30f3\u30b0**\u3068\u547c\u3070\u308c\u3066\u3044\u307e\u3059\u3002\n\n\u307e\u305f\u3001\u53b3\u5bc6\u306a\u30c7\u30fc\u30bf\u306e\u51fa\u73fe\u3057\u3084\u3059\u3055\u3067\u306a\u304f\u3001\u4e8b\u524d\u5206\u5e03\u3092\u52a0\u5473\u3057\u3066\u30c7\u30fc\u30bf\u304c\u4e0e\u3048\u3089\u308c\u305f\u5f8c\u306e\u78ba\u7387\u3092\u6700\u5927\u5316\u3057\u3088\u3046\u3068\u3059\u308b\u3053\u306e\u30a2\u30d7\u30ed\u30fc\u30c1\u3092**MAP\u63a8\u5b9a**\u3068\u8a00\u3044\u307e\u3059\u3002\n\n# \u5b9f\u884c\u7d50\u679c\n\u3055\u3066\u3001\u3084\u3063\u3068\u5206\u985e\u5668\u304c\u69cb\u7bc9\u3067\u304d\u305f\u305f\u3081\u3001\u3044\u3088\u3044\u3088\u5b9f\u884c\u3057\u3066\u307f\u307e\u3059\u3002\n\n## \u5206\u985e\u95a2\u6570\n\n\u69cb\u7bc9\u3057\u305f\u5206\u985e\u5668\u3092\u7528\u3044\u3066\u3001\u4e0e\u3048\u305f\u30c4\u30a4\u30fc\u30c8\u304c\u7fbd\u751f\u3055\u3093\u3068\u7fbd\u751f\u304f\u3093\u3001\n\u3069\u3061\u3089\u306b\u3088\u3063\u3066\u66f8\u304b\u308c\u305f\u6587\u66f8\u3067\u3042\u308b\u304b\u5206\u985e\u3059\u308b\u95a2\u6570\u3067\u3059\u3002\n\n```py\n\ndef classify(data):\n  # \u5404\u30af\u30e9\u30b9\u6bce\u306blogP(D)\u3092\u6c42\u3081\u308b\n  pp = {}\n  for c in cls:\n    pp[c] = math.log(p_cls[c])\n    for word in vocabulary:\n      if word in data:\n        pp[c] += math.log(p_word[c][word])\n\n      else:\n        pp[c] += math.log((1 - p_word[c][word]))\n\n # \u6c42\u3081\u305flogP(D)\u306e\u5185\u3001\u3069\u308c\u304c\u6700\u3082\u5927\u304d\u3044\u304b\u5224\u5b9a\n for c in cls:\n   maxpp = maxpp if 'maxpp' in locals() else pp[c]\n   maxcls = maxcls if 'maxcls' in locals() else c\n\n   if maxpp < pp[c]:\n     maxpp = pp[c]\n     maxcls =c\n                \n   return (maxcls, maxpp)\n\n```\n\n## \u30e2\u30c7\u30eb\u306e\u7cbe\u5ea6\u691c\u8a3c\n\u53d6\u5f97\u3057\u305f\u30c4\u30a4\u30fc\u30c8\u306e\u5185\u3001\u7cbe\u5ea6\u691c\u8a3c\u7528\u306b\u3068\u3063\u3066\u304a\u3044\u305f30\u4ef6\u00d72\u4eba\u5206\u306e\u30c4\u30a4\u30fc\u30c8\u3092\u5206\u985e\u5668\u306b\u639b\u3051\u3066\u307f\u307e\u3059\u3002\n\n```py\ndef test(data, label):\n  i = 0.0\n  for tweet in data:\n    if nb.classify(tweet)[0] == label:\n      i += 1\n  return (i / len(data))\n\n# bags_of_words\u306f\u5404\u30c4\u30a4\u30fc\u30c8\u3092\u54c1\u8a5e\u5206\u89e3\u3057\u305f\uff12\u6b21\u5143\u914d\u5217\u3092\u8fd4\u3057\u307e\u3059\ntest(bags_of_words(\"hanyu_test.txt\"), \"hanyu\")\ntest(bags_of_words(\"habu_test.txt\"), \"habu\")\n```\n\n|\u30af\u30e9\u30b9|\u2460\u30c6\u30b9\u30c8\u30c7\u30fc\u30bf\u4ef6\u6570|\u2461\u6b63\u7b54\u6570|\u6b63\u7b54\u7387(\u2461/\u2460)|\n|:-----------|------------:|------------:|------------:|\n|\u7fbd\u751f\u3055\u3093|30|28|93.33%|\n|\u7fbd\u751f\u304f\u3093|30|28|93.33%|\n\n\u304b\u306a\u308a\u9ad8\u7cbe\u5ea6\u3067\u5224\u5225\u3067\u304d\u3066\u3044\u307e\u3059\u304c\u3001\n\u3053\u308c\u306f\u7fbd\u751f\u3055\u3093\u3068\u7fbd\u751f\u304f\u3093\u306b\u305d\u308c\u305e\u308c\u306b\u56fa\u6709\u306e\u8a9e\u5f59\u304c\u591a\u304f\u542b\u307e\u308c\u3066\u3044\u305f\u304b\u3089\u3068\u601d\u308f\u308c\u307e\u3059\u3002\n\u672c\u6765\u306f\u540c\u3058\u8a9e\u5f59\u3067\u3001\u983b\u5ea6\u304c\u9055\u3046\u3088\u3046\u306a\u5206\u5e03\u306e\u30c7\u30fc\u30bf\u3092\u5206\u985e\u3059\u308b\u3068\u3053\u308d\u306b\u610f\u7fa9\u304c\u3042\u308b\u305f\u3081\u3001\n\u305d\u306e\u70b9\u3067\u306f\u30c6\u30b9\u30c8\u30c7\u30fc\u30bf\u304c\u3042\u307e\u308a\u3088\u304f\u306a\u304b\u3063\u305f\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u306d\u3002\n\n## \u4eca\u5f8c\n\u6b21\u306f[\u7fbd\u751f\u3055\u3093\u3068\u7fbd\u751f\u304f\u3093\u306e\u753b\u50cf](https://www.google.co.jp/search?q=google+%E7%BE%BD%E7%94%9F&source=lnms&tbm=isch)\u306e\u89e3\u6790\u3092\u3084\u3063\u3066\u307f\u305f\u3044\u3067\u3059\u3002\n\n## \u53c2\u8003\u6587\u732e\n\n[\u8a00\u8a9e\u51e6\u7406\u306e\u305f\u3081\u306e\u6a5f\u68b0\u5b66\u7fd2\u5165\u9580](http://www.amazon.co.jp/gp/product/4339027510/ref=as_li_tf_tl?ie=UTF8&camp=247&creative=1211&creativeASIN=4339027510&linkCode=as2&tag=chordprog-22)\n[\u7fbd\u751f\u7d50\u5f26\u3068\u7fbd\u751f\u5584\u6cbb\u306e\u9055\u3044](http://sonicch.com/24676.html)\n"}