{"tags": ["unity5", "Android", "Unity"], "context": " More than 1 year has passed since last update.iOS\u3067\u30ed\u30fc\u30ab\u30eb\u901a\u77e5\u3092\u5b9f\u88c5\u3057\u305f\u306e\u3067\u3001\u4eca\u5ea6\u306fAndroid\u3067\u5b9f\u88c5\u3057\u3088\u3046\u3068\u601d\u3046\u306e\u3067\u81ea\u5206\u7528\u30e1\u30e2\n\n\u306f\u3058\u3081\u306b\niOS\u3067\u306e\u30ed\u30fc\u30ab\u30eb\u901a\u77e5\u306f\u3053\u3061\u3089\n\u7d30\u304b\u3044Android\u958b\u767a\u306e\u624b\u9806\u306b\u3064\u3044\u3066\u306f\u3053\u3061\u3089\u3092\u53c2\u8003\u306b\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n\u30ad\u30fc\u30ef\u30fc\u30c9\n\u30ed\u30fc\u30ab\u30eb\u901a\u77e5\u3092\u5b9f\u73fe\u3059\u308b\u4e0a\u3067\u5927\u5207\u306a\u30ad\u30fc\u30ef\u30fc\u30c9\n\nAlarmManager\nPendingIntent\nBroadcastReceiver\nNotificationCompat.Builder\n\n\nAndroid\n\nlocalNotification\npackage com.example.hogehoge;\n\nimport java.util.Calendar;\n\nimport com.unity3d.player.UnityPlayer;\n\nimport android.app.Activity;\nimport android.app.AlarmManager;\nimport android.app.PendingIntent;\nimport android.content.Context;\nimport android.content.Intent;\nimport android.util.Log;\n\npublic class localNotification {\n\n    /**\n     * \u6642\u9593\u6307\u5b9a\u3067\u30ed\u30fc\u30ab\u30eb\u901a\u77e5\u3092\u6295\u3052\u308b\n     * @param unixtime\n     * @param primary_key\n     * @param ticker\n     * @param content_title\n     * @param content_text\n     * @param sound_path\n     **/\n    public void sendNotification(long unixtime, int primary_key, String ticker, String content_title, String content_text, String sound_path)\n    {\n        Log.i(\"Unity\", \"SendNotificationStart\");\n\n        // \u30a4\u30f3\u30c6\u30f3\u30c8\u4f5c\u6210\n        Activity activity = UnityPlayer.currentActivity;\n        Context context = activity.getApplicationContext();\n        Intent intent = new Intent(context, NotificationReceiver.class);\n        //\u6e21\u3059\u5024\n        intent.putExtra(\"PRIMARY_KEY\", primary_key);\n        intent.putExtra(\"TICKER\", ticker);\n        intent.putExtra(\"CONTENT_TITLE\", content_title);\n        intent.putExtra(\"CONTENT_TEXT\", content_text);\n        intent.putExtra(\"SOUND_PATH\", sound_path);\n\n        Calendar calendar = Calendar.getInstance();\n        calendar.setTimeInMillis(unixtime);\n\n        PendingIntent sender = PendingIntent.getBroadcast(context,  primary_key, intent, PendingIntent.FLAG_UPDATE_CURRENT);\n        AlarmManager alarm = (AlarmManager)context.getSystemService(Context.ALARM_SERVICE);\n        alarm.set(AlarmManager.RTC_WAKEUP, calendar.getTimeInMillis() , sender);\n    }\n    /**\n     * \u6642\u9593\u6307\u5b9a\u3067\u30ed\u30fc\u30ab\u30eb\u901a\u77e5\u3092\u6295\u3052\u308b\n     * @param unixtime\n     * @param primary_key\n     * @param ticker\n     * @param content_title\n     * @param content_text\n     **/\n    public void sendNotification(long unixtime, int primary_key, String ticker, String content_title, String content_text)\n    {\n        sendNotification(unixtime, primary_key, ticker, content_title, content_text,\"Default\");\n    }\n    /**\n     * \u6642\u9593\u6307\u5b9a\u3067\u30ed\u30fc\u30ab\u30eb\u901a\u77e5\u3092\u6295\u3052\u308b\n     * @param unixtime\n     * @param primary_key\n     * @param content_title\n     * @param content_text\n     **/\n    public void sendNotification(long unixtime, int primary_key,  String content_title, String content_text)\n    {\n        sendNotification(unixtime, primary_key, content_title, content_title, content_text);\n    }\n    /**\n     * \u6642\u9593\u6307\u5b9a\u3067\u30ed\u30fc\u30ab\u30eb\u901a\u77e5\u3092\u6295\u3052\u308b\n     * @param unixtime\n     * @param primary_key\n     * @param content_title\n     **/\n    public void sendNotification(long unixtime, int primary_key,  String content_title)\n    {\n        sendNotification(unixtime, primary_key, content_title, content_title, \"\");\n    }\n    public void clearNotification(int primary_key){\n        Log.i(\"Unity\", \"ClearNotificationStart\");\n\n        // \u30a4\u30f3\u30c6\u30f3\u30c8\u4f5c\u6210\n        Activity activity = UnityPlayer.currentActivity;\n        Context context = activity.getApplicationContext();\n        Intent intent = new Intent(context,NotificationReceiver.class);\n\n        PendingIntent sender = PendingIntent.getBroadcast(context,  primary_key, intent, PendingIntent.FLAG_CANCEL_CURRENT);\n        AlarmManager alarm = (AlarmManager)context.getSystemService(Context.ALARM_SERVICE);\n        alarm.cancel(sender);\n        sender.cancel();\n    }\n}\n\n\n\nNotificationReceiver\npackage com.example.notification;\n\nimport android.app.Notification;\nimport android.app.NotificationManager;\nimport android.app.PendingIntent;\nimport android.app.Service;\nimport android.content.BroadcastReceiver;\nimport android.content.Context;\nimport android.content.Intent;\nimport android.content.pm.ApplicationInfo;\nimport android.content.pm.PackageManager;\nimport android.content.pm.PackageManager.NameNotFoundException;\nimport android.graphics.Bitmap;\nimport android.graphics.BitmapFactory;\nimport android.net.Uri;\nimport android.support.v4.app.NotificationCompat;\n\n/**\n * \u30ec\u30b7\u30fc\u30d0\u30fc\n *\n * @author raharu\n */\npublic class NotificationReceiver extends BroadcastReceiver{\n\n    @Override\n    public void onReceive(Context context, Intent intent) {\n\n        //\u5024\u306e\u53d6\u5f97\n        Integer primary_key = intent.getIntExtra(\"PRIMARY_KEY\", 0);\n        String ticker = intent.getStringExtra(\"TICKER\");\n        String content_title = intent.getStringExtra(\"CONTENT_TITLE\");\n        String content_text = intent.getStringExtra (\"CONTENT_TEXT\");\n        String sound_path = intent.getStringExtra(\"SOUND_PATH\");\n\n        // intent\u304b\u3089PendingIntent\u3092\u4f5c\u6210\n        PendingIntent pendingIntent = PendingIntent.getActivity(context, 0, intent, PendingIntent.FLAG_CANCEL_CURRENT);\n\n        // LargeIcon \u306e Bitmap \u3092\u751f\u6210\n        final PackageManager pm = context.getPackageManager();\n        ApplicationInfo applicationInfo = null;\n        try {\n          applicationInfo = pm.getApplicationInfo(context.getPackageName(),PackageManager.GET_META_DATA);\n        } catch (NameNotFoundException e) {\n          e.printStackTrace();\n          return;\n        }\n        final int appIconResId = applicationInfo.icon;\n        Bitmap largeIcon = BitmapFactory.decodeResource(context.getResources(), appIconResId);\n\n        // NotificationBuilder\u3092\u4f5c\u6210\n        NotificationCompat.Builder builder = new NotificationCompat.Builder(context);\n        builder.setContentIntent(pendingIntent);\n        builder.setTicker(ticker);                    //\u901a\u77e5\u5230\u7740\u6642\u306b\u901a\u77e5\u30d0\u30fc\u306b\u8868\u793a(4.4\u307e\u3067)\n        builder.setSmallIcon(appIconResId);           //\u30a2\u30a4\u30b3\u30f3\n        builder.setContentTitle(content_title);       // \u30bf\u30a4\u30c8\u30eb\n        builder.setContentText(content_text);         // \u672c\u6587\uff08\u30b5\u30d6\u30bf\u30a4\u30c8\u30eb\uff09\n        builder.setLargeIcon(largeIcon);              //\u958b\u3044\u305f\u6642\u306e\u30a2\u30a4\u30b3\u30f3\n        builder.setWhen(System.currentTimeMillis());  //\u901a\u77e5\u306b\u8868\u793a\u3055\u308c\u308b\u6642\u9593(\u203b\u901a\u77e5\u6642\u9593\u3067\u306f\u306a\u3044\uff01)\n\n        // \u901a\u77e5\u6642\u306e\u97f3\u30fb\u30d0\u30a4\u30d6\u30fb\u30e9\u30a4\u30c8\n        if( sound_path.equals(\"Default\") ){\n            builder.setDefaults(Notification.DEFAULT_SOUND);\n        }else{\n            builder.setSound( Uri.parse(sound_path));\n        }\n        builder.setDefaults(Notification.DEFAULT_VIBRATE);\n        builder.setDefaults(Notification.DEFAULT_LIGHTS);\n        builder.setAutoCancel(true);\n\n        // NotificationManager\u3092\u53d6\u5f97\n        NotificationManager manager = (NotificationManager) context.getSystemService(Service.NOTIFICATION_SERVICE);\n        // Notification\u3092\u4f5c\u6210\u3057\u3066\u901a\u77e5\n        manager.notify(primary_key, builder.build());\n    }\n\n}\n\n\n\u4ee5\u4e0a\u304c\u30ed\u30fc\u30ab\u30eb\u901a\u77e5\u30d7\u30e9\u30b0\u30a4\u30f3\u306e\u30b3\u30fc\u30c9\u3067\u3059\u3002\n\u53c2\u8003\uff1aUnity \u6642\u9593\u6307\u5b9a\u30ed\u30fc\u30ab\u30eb\u30d7\u30c3\u30b7\u30e5\u901a\u77e5\u51e6\u7406\u3092\u66f8\u3044\u3066\u307f\u305f Android\u7de8\niOS\u3067\u30ed\u30fc\u30ab\u30eb\u901a\u77e5\u3092\u5b9f\u88c5\u3057\u305f\u306e\u3067\u3001\u4eca\u5ea6\u306fAndroid\u3067\u5b9f\u88c5\u3057\u3088\u3046\u3068\u601d\u3046\u306e\u3067\u81ea\u5206\u7528\u30e1\u30e2\n\n#\u306f\u3058\u3081\u306b\niOS\u3067\u306e\u30ed\u30fc\u30ab\u30eb\u901a\u77e5\u306f[\u3053\u3061\u3089](http://qiita.com/ToshikiImagawa/items/e4cb64295b009848a144)\n\u7d30\u304b\u3044Android\u958b\u767a\u306e\u624b\u9806\u306b\u3064\u3044\u3066\u306f[\u3053\u3061\u3089](http://qiita.com/relzx/items/a35f7ab6dbacb48f7e26)\u3092\u53c2\u8003\u306b\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n#\u30ad\u30fc\u30ef\u30fc\u30c9\n\u30ed\u30fc\u30ab\u30eb\u901a\u77e5\u3092\u5b9f\u73fe\u3059\u308b\u4e0a\u3067\u5927\u5207\u306a\u30ad\u30fc\u30ef\u30fc\u30c9\n\n* AlarmManager\n* PendingIntent\n* BroadcastReceiver\n* NotificationCompat.Builder\n\n#Android\n```lang:localNotification\npackage com.example.hogehoge;\n\nimport java.util.Calendar;\n\nimport com.unity3d.player.UnityPlayer;\n\nimport android.app.Activity;\nimport android.app.AlarmManager;\nimport android.app.PendingIntent;\nimport android.content.Context;\nimport android.content.Intent;\nimport android.util.Log;\n\npublic class localNotification {\n\n\t/**\n\t * \u6642\u9593\u6307\u5b9a\u3067\u30ed\u30fc\u30ab\u30eb\u901a\u77e5\u3092\u6295\u3052\u308b\n\t * @param unixtime\n\t * @param primary_key\n\t * @param ticker\n\t * @param content_title\n\t * @param content_text\n\t * @param sound_path\n\t **/\n\tpublic void sendNotification(long unixtime, int primary_key, String ticker, String content_title, String content_text, String sound_path)\n\t{\n\t\tLog.i(\"Unity\", \"SendNotificationStart\");\n\n\t\t// \u30a4\u30f3\u30c6\u30f3\u30c8\u4f5c\u6210\n\t\tActivity activity = UnityPlayer.currentActivity;\n\t\tContext context = activity.getApplicationContext();\n\t\tIntent intent = new Intent(context, NotificationReceiver.class);\n\t\t//\u6e21\u3059\u5024\n\t\tintent.putExtra(\"PRIMARY_KEY\", primary_key);\n\t\tintent.putExtra(\"TICKER\", ticker);\n\t\tintent.putExtra(\"CONTENT_TITLE\", content_title);\n\t\tintent.putExtra(\"CONTENT_TEXT\", content_text);\n\t\tintent.putExtra(\"SOUND_PATH\", sound_path);\n\n\t\tCalendar calendar = Calendar.getInstance();\n\t\tcalendar.setTimeInMillis(unixtime);\n\n\t\tPendingIntent sender = PendingIntent.getBroadcast(context,  primary_key, intent, PendingIntent.FLAG_UPDATE_CURRENT);\n\t\tAlarmManager alarm = (AlarmManager)context.getSystemService(Context.ALARM_SERVICE);\n\t\talarm.set(AlarmManager.RTC_WAKEUP, calendar.getTimeInMillis() , sender);\n\t}\n\t/**\n\t * \u6642\u9593\u6307\u5b9a\u3067\u30ed\u30fc\u30ab\u30eb\u901a\u77e5\u3092\u6295\u3052\u308b\n\t * @param unixtime\n\t * @param primary_key\n\t * @param ticker\n\t * @param content_title\n\t * @param content_text\n\t **/\n\tpublic void sendNotification(long unixtime, int primary_key, String ticker, String content_title, String content_text)\n\t{\n\t\tsendNotification(unixtime, primary_key, ticker, content_title, content_text,\"Default\");\n\t}\n\t/**\n\t * \u6642\u9593\u6307\u5b9a\u3067\u30ed\u30fc\u30ab\u30eb\u901a\u77e5\u3092\u6295\u3052\u308b\n\t * @param unixtime\n\t * @param primary_key\n\t * @param content_title\n\t * @param content_text\n\t **/\n\tpublic void sendNotification(long unixtime, int primary_key,  String content_title, String content_text)\n\t{\n\t\tsendNotification(unixtime, primary_key, content_title, content_title, content_text);\n\t}\n\t/**\n\t * \u6642\u9593\u6307\u5b9a\u3067\u30ed\u30fc\u30ab\u30eb\u901a\u77e5\u3092\u6295\u3052\u308b\n\t * @param unixtime\n\t * @param primary_key\n\t * @param content_title\n\t **/\n\tpublic void sendNotification(long unixtime, int primary_key,  String content_title)\n\t{\n\t\tsendNotification(unixtime, primary_key, content_title, content_title, \"\");\n\t}\n\tpublic void clearNotification(int primary_key){\n\t\tLog.i(\"Unity\", \"ClearNotificationStart\");\n\n\t\t// \u30a4\u30f3\u30c6\u30f3\u30c8\u4f5c\u6210\n\t\tActivity activity = UnityPlayer.currentActivity;\n\t\tContext context = activity.getApplicationContext();\n\t\tIntent intent = new Intent(context,NotificationReceiver.class);\n\n\t\tPendingIntent sender = PendingIntent.getBroadcast(context,  primary_key, intent, PendingIntent.FLAG_CANCEL_CURRENT);\n\t\tAlarmManager alarm = (AlarmManager)context.getSystemService(Context.ALARM_SERVICE);\n\t\talarm.cancel(sender);\n\t\tsender.cancel();\n\t}\n}\n```\n\n```lang:NotificationReceiver\npackage com.example.notification;\n\nimport android.app.Notification;\nimport android.app.NotificationManager;\nimport android.app.PendingIntent;\nimport android.app.Service;\nimport android.content.BroadcastReceiver;\nimport android.content.Context;\nimport android.content.Intent;\nimport android.content.pm.ApplicationInfo;\nimport android.content.pm.PackageManager;\nimport android.content.pm.PackageManager.NameNotFoundException;\nimport android.graphics.Bitmap;\nimport android.graphics.BitmapFactory;\nimport android.net.Uri;\nimport android.support.v4.app.NotificationCompat;\n\n/**\n * \u30ec\u30b7\u30fc\u30d0\u30fc\n *\n * @author raharu\n */\npublic class NotificationReceiver extends BroadcastReceiver{\n\n    @Override\n    public void onReceive(Context context, Intent intent) {\n\n        //\u5024\u306e\u53d6\u5f97\n        Integer primary_key = intent.getIntExtra(\"PRIMARY_KEY\", 0);\n        String ticker = intent.getStringExtra(\"TICKER\");\n        String content_title = intent.getStringExtra(\"CONTENT_TITLE\");\n        String content_text = intent.getStringExtra (\"CONTENT_TEXT\");\n        String sound_path = intent.getStringExtra(\"SOUND_PATH\");\n\n        // intent\u304b\u3089PendingIntent\u3092\u4f5c\u6210\n        PendingIntent pendingIntent = PendingIntent.getActivity(context, 0, intent, PendingIntent.FLAG_CANCEL_CURRENT);\n\n        // LargeIcon \u306e Bitmap \u3092\u751f\u6210\n        final PackageManager pm = context.getPackageManager();\n        ApplicationInfo applicationInfo = null;\n        try {\n          applicationInfo = pm.getApplicationInfo(context.getPackageName(),PackageManager.GET_META_DATA);\n        } catch (NameNotFoundException e) {\n          e.printStackTrace();\n          return;\n        }\n        final int appIconResId = applicationInfo.icon;\n        Bitmap largeIcon = BitmapFactory.decodeResource(context.getResources(), appIconResId);\n\n        // NotificationBuilder\u3092\u4f5c\u6210\n        NotificationCompat.Builder builder = new NotificationCompat.Builder(context);\n        builder.setContentIntent(pendingIntent);\n        builder.setTicker(ticker);                    //\u901a\u77e5\u5230\u7740\u6642\u306b\u901a\u77e5\u30d0\u30fc\u306b\u8868\u793a(4.4\u307e\u3067)\n        builder.setSmallIcon(appIconResId);           //\u30a2\u30a4\u30b3\u30f3\n        builder.setContentTitle(content_title);       // \u30bf\u30a4\u30c8\u30eb\n        builder.setContentText(content_text);         // \u672c\u6587\uff08\u30b5\u30d6\u30bf\u30a4\u30c8\u30eb\uff09\n        builder.setLargeIcon(largeIcon);              //\u958b\u3044\u305f\u6642\u306e\u30a2\u30a4\u30b3\u30f3\n        builder.setWhen(System.currentTimeMillis());  //\u901a\u77e5\u306b\u8868\u793a\u3055\u308c\u308b\u6642\u9593(\u203b\u901a\u77e5\u6642\u9593\u3067\u306f\u306a\u3044\uff01)\n\n        // \u901a\u77e5\u6642\u306e\u97f3\u30fb\u30d0\u30a4\u30d6\u30fb\u30e9\u30a4\u30c8\n        if( sound_path.equals(\"Default\") ){\n            builder.setDefaults(Notification.DEFAULT_SOUND);\n        }else{\n        \tbuilder.setSound( Uri.parse(sound_path));\n        }\n        builder.setDefaults(Notification.DEFAULT_VIBRATE);\n        builder.setDefaults(Notification.DEFAULT_LIGHTS);\n        builder.setAutoCancel(true);\n\n        // NotificationManager\u3092\u53d6\u5f97\n        NotificationManager manager = (NotificationManager) context.getSystemService(Service.NOTIFICATION_SERVICE);\n        // Notification\u3092\u4f5c\u6210\u3057\u3066\u901a\u77e5\n        manager.notify(primary_key, builder.build());\n    }\n\n}\n```\n\n\u4ee5\u4e0a\u304c\u30ed\u30fc\u30ab\u30eb\u901a\u77e5\u30d7\u30e9\u30b0\u30a4\u30f3\u306e\u30b3\u30fc\u30c9\u3067\u3059\u3002\n\n\n\u53c2\u8003\uff1a[Unity \u6642\u9593\u6307\u5b9a\u30ed\u30fc\u30ab\u30eb\u30d7\u30c3\u30b7\u30e5\u901a\u77e5\u51e6\u7406\u3092\u66f8\u3044\u3066\u307f\u305f Android\u7de8](http://befool.co.jp/blog/raharu/localnotification-android/)\n"}