{"context": "\u53c2\u8003\u8a18\u4e8b\uff1ahttp://www.rondhuit.com/apache-manifoldcf-mcf-security-searchcomponent-plugin.html\n\u3053\u3061\u3089\u306fCentOS7\u3001Solr6\u3068ManifoldCF2.4\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u3092\u4f7f\u7528\u3057\u3066\u3044\u307e\u3059\u3002\n1.ManifoldCF\uff08\u7565\uff1aMCF\uff09\u516c\u5f0f\u30b5\u30a4\u30c8\u304b\u3089Solr6\u7248\u306eMCF\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30fc\u30b5\u30fc\u30c1\u30b3\u30f3\u30dd\u30fc\u30cd\u30f3\u30c8\u3092\u5165\u624b\nhttp://manifoldcf.apache.org/en_US/download.html#Plugin+for+Apache+Solr+6.x\nsolr6\u306b\u5bfe\u5fdc\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u306e\u6240\u5728\u3067\u3059\u304c\u3001\u82f1\u8a9e\u7248Download\u30da\u30fc\u30b8\u306b\u3042\u308a\u307e\u3057\u305f\uff08\u65e5\u672c\u8a9e\u30da\u30fc\u30b8\u306b\u306f\u306a\u304b\u3063\u305f\u3088\u3046\u3067\u3059\uff09\n2.\u53d6\u5f97\u3057\u305fapache-manifoldcf-solr-6.x-plugin-2.2-bin.tar.gz\u3092Solr\u306b\u914d\u7f6e\nSolr5\u4ee5\u964d\u306f\u30b3\u30a2\u304csolr\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u305f\u5834\u6240\u3067\u306f\u306a\u304fvar/solr/data/<corename>\u3067\u4f5c\u6210\u3055\u308c\u308b\u3088\u3046\u306b\u306a\u3063\u305f\u3088\u3046\u3067\u3059\u3002\n\u305d\u3053\u306blib\u30d5\u30a9\u30eb\u30c0\u30fc\u3092\u4f5c\u6210\u3057\u3066\u3001\u4e0a\u8a18\u30d5\u30a1\u30a4\u30eb\u3092\u89e3\u51cd\u3057\u305fjar\u3092\u30b3\u30d4\u30fc\u3059\u308b\nmkdir -p var/solr/data/<corename>/lib\ncp apache-manifoldcf-solr-6.x-plugin-2.2.jar var/solr/data/<corename>/lib\n3.Solr\u5074\u306eschema.xml\u3068solrconfig.xml\u3092\u7de8\u96c6\u3059\u308b\n\u5834\u6240\u306fvar/solr/data//conf\u3001schema.xml\u540d\u524d\u304cmanaged_schema.xml\u306b\u5909\u308f\u3063\u305f\u6a21\u69d8\n\u5148\u307b\u3069\u89e3\u51cd\u3057\u305fjar\u306e\u30d5\u30a9\u30eb\u30c0\u30fc\u306bReadme.txt\u304c\u3042\u308b\u306e\u3067\u3001\u305d\u3061\u3089\u3092\u53c2\u7167\u3002\n\nmanaged_schema.xml\u306b\u30d5\u30a3\u30fc\u30eb\u30c9\u8ffd\u52a0\n\n\nmanaged_schema.xml\n... \n <field name=\"allow_token_document\" type=\"string\" indexed=\"true\" stored=\"true\"\n    multiValued=\"true\" required=\"true\" default=\"__nosecurity__\"/>\n  <field name=\"allow_token_parent\" type=\"string\" indexed=\"true\" stored=\"true\"\n    multiValued=\"true\" required=\"true\" default=\"__nosecurity__\"/>\n  <field name=\"allow_token_share\" type=\"string\" indexed=\"true\" stored=\"true\"\n    multiValued=\"true\" required=\"true\" default=\"__nosecurity__\"/>\n  <field name=\"deny_token_document\" type=\"string\" indexed=\"true\" stored=\"true\"\n    multiValued=\"true\" required=\"true\" default=\"__nosecurity__\"/>\n  <field name=\"deny_token_parent\" type=\"string\" indexed=\"true\" stored=\"true\"\n    multiValued=\"true\" required=\"true\" default=\"__nosecurity__\"/>\n  <field name=\"deny_token_share\" type=\"string\" indexed=\"true\" stored=\"true\"\n    multiValued=\"true\" required=\"true\" default=\"__nosecurity__\"/>\n...\n\n\n\nsolrconfig.xml\u306bsearchComponent\u3068queryParser\u3092\u8ffd\u52a0\u3057\u3001\u306b\u30d5\u30c3\u30af\u3059\u308b\n\n\nsolrconfig.xml\n...\n  <!-- ManifoldCF document security enforcement component -->\n<searchComponent name=\"manifoldCFSecurity\"\n  class=\"org.apache.solr.mcf.ManifoldCFSearchComponent\">\n  <str name=\"AuthorityServiceBaseURL\">http://localhost:8345/mcf-authority-service</str>\n  <int name=\"ConnectionPoolSize\">50</int>\n</searchComponent>\n...\n<requestHandler name=\"/select\" class=\"solr.SearchHandler\">\n...\n  <arr name=\"last-components\">\n    <str>manifoldCFSecurity</str>\n  </arr>\n  ...\n</requestHandler>\n...\n\n\n\nsolrconfig.xml\n...\n<!-- ManifoldCF document security enforcement component -->\n<queryParser name=\"manifoldCFSecurity\"\n  class=\"org.apache.solr.mcf.ManifoldCFQParserPlugin\">\n  <str name=\"AuthorityServiceBaseURL\">http://localhost:8345/mcf-authority-service</str>\n  <int name=\"ConnectionPoolSize\">50</int>\n</queryParser>\n...\n<requestHandler name=\"/select\" class=\"solr.SearchHandler\">\n... \n <lst name=\"appends\">\n    <str name=\"fq\">{!manifoldCFSecurity}</str>\n  </lst>\n  ...\n</requestHandler>\n...\n\n\n\u4ee5\u4e0a\u3067\u8a2d\u5b9a\u5b8c\u4e86\u3067\u3059\u3002\u53cd\u6620\u3059\u308b\u305f\u3081Solr\u3092\u518d\u8d77\u52d5\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\nMCF\u306e\u30af\u30ed\u30fc\u30eb\u3092\u518d\u5ea6\u5b9f\u884c\u3057\u3066\u3001\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30fc\u7ba1\u7406\u7528\u30d5\u30a3\u30fc\u30eb\u30c9\u306e\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u3092\u6295\u5165\u3057\u307e\u3059\u3002\n\u691c\u7d22\u6642\u306fAuthenticatedUserName\u3092\u30d1\u30e9\u30e1\u30fc\u30bf\u3068\u3057\u3066\u6e21\u3059\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\n\u52d5\u4f5c\u78ba\u8a8d\u3059\u308b\u306b\u306f\u4ee5\u4e0b\u306e\u30af\u30a8\u30ea\u30fc\u3092\u6295\u5165\u3057\u3066\u307f\u3066\u304f\u3060\u3055\u3044\u3002\nhttp://localhost:8983/solr/corename/select?q=*:*&AuthenticatedUserName=username@domain\n\u53c2\u8003\u8a18\u4e8b\uff1ahttp://www.rondhuit.com/apache-manifoldcf-mcf-security-searchcomponent-plugin.html\n\u3053\u3061\u3089\u306fCentOS7\u3001Solr6\u3068ManifoldCF2.4\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u3092\u4f7f\u7528\u3057\u3066\u3044\u307e\u3059\u3002\n\n**1.ManifoldCF\uff08\u7565\uff1aMCF\uff09\u516c\u5f0f\u30b5\u30a4\u30c8\u304b\u3089Solr6\u7248\u306eMCF\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30fc\u30b5\u30fc\u30c1\u30b3\u30f3\u30dd\u30fc\u30cd\u30f3\u30c8\u3092\u5165\u624b**\n\nhttp://manifoldcf.apache.org/en_US/download.html#Plugin+for+Apache+Solr+6.x\n\nsolr6\u306b\u5bfe\u5fdc\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u306e\u6240\u5728\u3067\u3059\u304c\u3001\u82f1\u8a9e\u7248Download\u30da\u30fc\u30b8\u306b\u3042\u308a\u307e\u3057\u305f\uff08\u65e5\u672c\u8a9e\u30da\u30fc\u30b8\u306b\u306f\u306a\u304b\u3063\u305f\u3088\u3046\u3067\u3059\uff09\n\n**2.\u53d6\u5f97\u3057\u305fapache-manifoldcf-solr-6.x-plugin-2.2-bin.tar.gz\u3092Solr\u306b\u914d\u7f6e**\n\nSolr5\u4ee5\u964d\u306f\u30b3\u30a2\u304csolr\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u305f\u5834\u6240\u3067\u306f\u306a\u304f<code>var/solr/data/`<corename>`</code>\u3067\u4f5c\u6210\u3055\u308c\u308b\u3088\u3046\u306b\u306a\u3063\u305f\u3088\u3046\u3067\u3059\u3002\n\u305d\u3053\u306blib\u30d5\u30a9\u30eb\u30c0\u30fc\u3092\u4f5c\u6210\u3057\u3066\u3001\u4e0a\u8a18\u30d5\u30a1\u30a4\u30eb\u3092\u89e3\u51cd\u3057\u305fjar\u3092\u30b3\u30d4\u30fc\u3059\u308b\n\n<code>mkdir -p var/solr/data/`<corename>`/lib</code>\n<code>cp apache-manifoldcf-solr-6.x-plugin-2.2.jar var/solr/data/`<corename>`/lib</code>\n\n**3.Solr\u5074\u306eschema.xml\u3068solrconfig.xml\u3092\u7de8\u96c6\u3059\u308b**\n\u5834\u6240\u306fvar/solr/data/<corename>/conf\u3001schema.xml\u540d\u524d\u304cmanaged_schema.xml\u306b\u5909\u308f\u3063\u305f\u6a21\u69d8\n\n\u5148\u307b\u3069\u89e3\u51cd\u3057\u305fjar\u306e\u30d5\u30a9\u30eb\u30c0\u30fc\u306bReadme.txt\u304c\u3042\u308b\u306e\u3067\u3001\u305d\u3061\u3089\u3092\u53c2\u7167\u3002\n\n- managed_schema.xml\u306b\u30d5\u30a3\u30fc\u30eb\u30c9\u8ffd\u52a0\n\n```xml:managed_schema.xml\n... \n <field name=\"allow_token_document\" type=\"string\" indexed=\"true\" stored=\"true\"\n    multiValued=\"true\" required=\"true\" default=\"__nosecurity__\"/>\n  <field name=\"allow_token_parent\" type=\"string\" indexed=\"true\" stored=\"true\"\n    multiValued=\"true\" required=\"true\" default=\"__nosecurity__\"/>\n  <field name=\"allow_token_share\" type=\"string\" indexed=\"true\" stored=\"true\"\n    multiValued=\"true\" required=\"true\" default=\"__nosecurity__\"/>\n  <field name=\"deny_token_document\" type=\"string\" indexed=\"true\" stored=\"true\"\n    multiValued=\"true\" required=\"true\" default=\"__nosecurity__\"/>\n  <field name=\"deny_token_parent\" type=\"string\" indexed=\"true\" stored=\"true\"\n    multiValued=\"true\" required=\"true\" default=\"__nosecurity__\"/>\n  <field name=\"deny_token_share\" type=\"string\" indexed=\"true\" stored=\"true\"\n    multiValued=\"true\" required=\"true\" default=\"__nosecurity__\"/>\n...\n```\n\n- solrconfig.xml\u306bsearchComponent\u3068queryParser\u3092\u8ffd\u52a0\u3057\u3001<requesthandler>\u306b\u30d5\u30c3\u30af\u3059\u308b\n\n```xml:solrconfig.xml\n...\n  <!-- ManifoldCF document security enforcement component -->\n<searchComponent name=\"manifoldCFSecurity\"\n  class=\"org.apache.solr.mcf.ManifoldCFSearchComponent\">\n  <str name=\"AuthorityServiceBaseURL\">http://localhost:8345/mcf-authority-service</str>\n  <int name=\"ConnectionPoolSize\">50</int>\n</searchComponent>\n...\n<requestHandler name=\"/select\" class=\"solr.SearchHandler\">\n...\n  <arr name=\"last-components\">\n    <str>manifoldCFSecurity</str>\n  </arr>\n  ...\n</requestHandler>\n...\n```\n\n```xml:solrconfig.xml\n...\n<!-- ManifoldCF document security enforcement component -->\n<queryParser name=\"manifoldCFSecurity\"\n  class=\"org.apache.solr.mcf.ManifoldCFQParserPlugin\">\n  <str name=\"AuthorityServiceBaseURL\">http://localhost:8345/mcf-authority-service</str>\n  <int name=\"ConnectionPoolSize\">50</int>\n</queryParser>\n...\n<requestHandler name=\"/select\" class=\"solr.SearchHandler\">\n... \n <lst name=\"appends\">\n    <str name=\"fq\">{!manifoldCFSecurity}</str>\n  </lst>\n  ...\n</requestHandler>\n...\n```\n\u4ee5\u4e0a\u3067\u8a2d\u5b9a\u5b8c\u4e86\u3067\u3059\u3002\u53cd\u6620\u3059\u308b\u305f\u3081Solr\u3092\u518d\u8d77\u52d5\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\nMCF\u306e\u30af\u30ed\u30fc\u30eb\u3092\u518d\u5ea6\u5b9f\u884c\u3057\u3066\u3001\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30fc\u7ba1\u7406\u7528\u30d5\u30a3\u30fc\u30eb\u30c9\u306e\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u3092\u6295\u5165\u3057\u307e\u3059\u3002\n\n\u691c\u7d22\u6642\u306fAuthenticatedUserName\u3092\u30d1\u30e9\u30e1\u30fc\u30bf\u3068\u3057\u3066\u6e21\u3059\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\n\u52d5\u4f5c\u78ba\u8a8d\u3059\u308b\u306b\u306f\u4ee5\u4e0b\u306e\u30af\u30a8\u30ea\u30fc\u3092\u6295\u5165\u3057\u3066\u307f\u3066\u304f\u3060\u3055\u3044\u3002\nhttp://localhost:8983/solr/corename/select?q=*:*&AuthenticatedUserName=<username@domain>\n\n", "tags": ["solr6", "manifoldcf2.4"]}