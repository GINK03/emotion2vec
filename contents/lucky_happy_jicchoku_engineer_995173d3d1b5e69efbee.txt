{"tags": ["PowerShell", "WSH"], "context": " More than 1 year has passed since last update.## \u6982\u8981 ##\n# \u30ad\u30fc\u30dc\u30fc\u30c9\u64cd\u4f5c\u3092\u5b9a\u671f\u7684\u306b\u81ea\u52d5\u3067\u884c\u3046\u3053\u3068\u306b\u3088\u308a\u3001\n# Windows PC\u304c\u753b\u9762\u30ed\u30c3\u30af\u3055\u308c\u308b\u3053\u3068\u3092\u9632\u3050\n# \u30e1\u30e2\u5e33\u304c\u8d77\u52d5\u3057\u300160\u79d2\u3054\u3068\u306b\u3001\u6307\u5b9a\u3057\u305f\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u3001\u30ad\u30fc\u30dc\u30fc\u30c9\u3092\u901a\u3058\u3066\u66f8\u304d\u8fbc\u3080\n# Powershell ver1.0 \u4ee5\u4e0a\u3067\u52d5\u4f5c\u78ba\u8a8d\u6e08\u307f\n\n\n## \u524d\u63d0\u6761\u4ef6 ##\n# \"## \u203b\u8a18\u8f09\u9858\u3046 ##\"\u306e\u7b87\u6240\u3092\u8a18\u5165\u3057\u3066\u5b9f\u884c\n# \u5168\u9078\u629e\u3057\u3066\u30b3\u30d4\u30fc\u3057\u3001Powershell\u306e\u30d7\u30ed\u30f3\u30d7\u30c8\u306b\u53f3\u30af\u30ea\u30c3\u30af\u3067\u8cbc\u308a\u4ed8\u3051\u3066\u3082\u5b9f\u884c\u53ef\u80fd\n\n\n## \u6ce8\u610f ##\n# \u30a2\u30af\u30c6\u30a3\u30d6\u306a\u30a6\u30a4\u30f3\u30c9\u30a6\u306b\u5bfe\u3057\u3066\u30ad\u30fc\u30dc\u30fc\u30c9\u6253\u9375\u3092\u81ea\u52d5\u5b9f\u884c\u3059\u308b\u305f\u3081\u3001\n# \u7aef\u672b\u64cd\u4f5c\u3092\u3059\u308b\u969b\u306b\u306f\u3001\u307e\u305a\u3001\u30b9\u30af\u30ea\u30d7\u30c8\u306e\u5b9f\u884c\u3092\u4e2d\u65ad\u3055\u305b\u308b\u3053\u3068\n\n\n\n\n## \u203b\u8a18\u8f09\u9858\u3046 ##\n# \u30ed\u30c3\u30af\u56de\u907f\u6642\u9593\u3092\u30bb\u30c3\u30c8\u3057\u3066\u304f\u3060\u3055\u3044(\u5206)\n$jikan = 300\n\n# \u30e1\u30e2\u5e33\u3078\u306e\u66f8\u304d\u8fbc\u307f\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u7aef\u7684\u306b\n$message = \"Ser, Do Not Lock please..\"\n\n\n\n\n#### \u95a2\u6570\u5b9a\u7fa9 ####\n\nfunction WinLock {\nparam($jikan,$message)\n\n# \u30ab\u30a6\u30f3\u30c8\u5909\u6570\u521d\u671f\u5316\n$i=0\n\n# WSH\u3092\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u5316\n$WSH = New-Object -Comobject wscript.shell\n\n# \u30e1\u30e2\u5e33\u306e\u8d77\u52d5\n$WSH.Run(\"notepad\")\n\n\n\n  # 0\u304b\u30891\u305a\u3064\u30ab\u30a6\u30f3\u30c8\u30a2\u30c3\u30d7\u3057\u3066300\u56de\u307e\u3067\u30eb\u30fc\u30d7\n  for ($i=0; $i -lt ${jikan}; $i++) {\n\n  # 1\u5206\u5f85\u6a5f\u3059\u308b\n  sleep 60\n\n  # \u6642\u523b\u53d6\u5f97\n  $date = Get-Date -Format \"yyyy-MMdd-HHmm_ss\"\n\n  # \u30ad\u30fc\u30dc\u30fc\u30c9\u3092\u901a\u3058\u3066\u3001\u30e1\u30e2\u5e33\u306b\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u66f8\u304d\u8fbc\u307f\n  $WSH.sendkeys(\"rem# ${message} #`n\")\n  $WSH.sendkeys(\"rem# $date #`n\")\n  $WSH.sendkeys(\"`n\")\n  $WSH.sendkeys(\"`n\")\n\n  # `n \u306f\u6539\u884c\n  # rem \u3068 # \u306f\u3001\u8aa4\u3063\u3066Powershell\u3084Cmd\u3092\u30a2\u30af\u30c6\u30a3\u30d6\u30a6\u30a4\u30f3\u30c9\u30a6\u306b\u3057\u305f\u3068\u304d\u7528\u306e\u8aa4\u6253\u9632\u6b62\n\n\n  # \u30eb\u30fc\u30d7\u7d42\u4e86\n  }\n\n\n# \u95a2\u6570\u7d42\u4e86\n}\n\n\n\n\n#### \u51e6\u7406\u958b\u59cb ####\n\nWinLock $jikan $message\n\n\n\n```ps1\n## \u6982\u8981 ##\n# \u30ad\u30fc\u30dc\u30fc\u30c9\u64cd\u4f5c\u3092\u5b9a\u671f\u7684\u306b\u81ea\u52d5\u3067\u884c\u3046\u3053\u3068\u306b\u3088\u308a\u3001\n# Windows PC\u304c\u753b\u9762\u30ed\u30c3\u30af\u3055\u308c\u308b\u3053\u3068\u3092\u9632\u3050\n# \u30e1\u30e2\u5e33\u304c\u8d77\u52d5\u3057\u300160\u79d2\u3054\u3068\u306b\u3001\u6307\u5b9a\u3057\u305f\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u3001\u30ad\u30fc\u30dc\u30fc\u30c9\u3092\u901a\u3058\u3066\u66f8\u304d\u8fbc\u3080\n# Powershell ver1.0 \u4ee5\u4e0a\u3067\u52d5\u4f5c\u78ba\u8a8d\u6e08\u307f\n\n\n## \u524d\u63d0\u6761\u4ef6 ##\n# \"## \u203b\u8a18\u8f09\u9858\u3046 ##\"\u306e\u7b87\u6240\u3092\u8a18\u5165\u3057\u3066\u5b9f\u884c\n# \u5168\u9078\u629e\u3057\u3066\u30b3\u30d4\u30fc\u3057\u3001Powershell\u306e\u30d7\u30ed\u30f3\u30d7\u30c8\u306b\u53f3\u30af\u30ea\u30c3\u30af\u3067\u8cbc\u308a\u4ed8\u3051\u3066\u3082\u5b9f\u884c\u53ef\u80fd\n\n\n## \u6ce8\u610f ##\n# \u30a2\u30af\u30c6\u30a3\u30d6\u306a\u30a6\u30a4\u30f3\u30c9\u30a6\u306b\u5bfe\u3057\u3066\u30ad\u30fc\u30dc\u30fc\u30c9\u6253\u9375\u3092\u81ea\u52d5\u5b9f\u884c\u3059\u308b\u305f\u3081\u3001\n# \u7aef\u672b\u64cd\u4f5c\u3092\u3059\u308b\u969b\u306b\u306f\u3001\u307e\u305a\u3001\u30b9\u30af\u30ea\u30d7\u30c8\u306e\u5b9f\u884c\u3092\u4e2d\u65ad\u3055\u305b\u308b\u3053\u3068\n\n\n\n\n## \u203b\u8a18\u8f09\u9858\u3046 ##\n# \u30ed\u30c3\u30af\u56de\u907f\u6642\u9593\u3092\u30bb\u30c3\u30c8\u3057\u3066\u304f\u3060\u3055\u3044(\u5206)\n$jikan = 300\n\n# \u30e1\u30e2\u5e33\u3078\u306e\u66f8\u304d\u8fbc\u307f\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u7aef\u7684\u306b\n$message = \"Ser, Do Not Lock please..\"\n\n\n\n\n#### \u95a2\u6570\u5b9a\u7fa9 ####\n\nfunction WinLock {\nparam($jikan,$message)\n\n# \u30ab\u30a6\u30f3\u30c8\u5909\u6570\u521d\u671f\u5316\n$i=0\n\n# WSH\u3092\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u5316\n$WSH = New-Object -Comobject wscript.shell\n\n# \u30e1\u30e2\u5e33\u306e\u8d77\u52d5\n$WSH.Run(\"notepad\")\n\n\n\n  # 0\u304b\u30891\u305a\u3064\u30ab\u30a6\u30f3\u30c8\u30a2\u30c3\u30d7\u3057\u3066300\u56de\u307e\u3067\u30eb\u30fc\u30d7\n  for ($i=0; $i -lt ${jikan}; $i++) {\n\n  # 1\u5206\u5f85\u6a5f\u3059\u308b\n  sleep 60\n\n  # \u6642\u523b\u53d6\u5f97\n  $date = Get-Date -Format \"yyyy-MMdd-HHmm_ss\"\n\n  # \u30ad\u30fc\u30dc\u30fc\u30c9\u3092\u901a\u3058\u3066\u3001\u30e1\u30e2\u5e33\u306b\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u66f8\u304d\u8fbc\u307f\n  $WSH.sendkeys(\"rem# ${message} #`n\")\n  $WSH.sendkeys(\"rem# $date #`n\")\n  $WSH.sendkeys(\"`n\")\n  $WSH.sendkeys(\"`n\")\n\n  # `n \u306f\u6539\u884c\n  # rem \u3068 # \u306f\u3001\u8aa4\u3063\u3066Powershell\u3084Cmd\u3092\u30a2\u30af\u30c6\u30a3\u30d6\u30a6\u30a4\u30f3\u30c9\u30a6\u306b\u3057\u305f\u3068\u304d\u7528\u306e\u8aa4\u6253\u9632\u6b62\n\n\n  # \u30eb\u30fc\u30d7\u7d42\u4e86\n  }\n\n\n# \u95a2\u6570\u7d42\u4e86\n}\n\n\n\n\n#### \u51e6\u7406\u958b\u59cb ####\n\nWinLock $jikan $message\n\n\n"}