{"context": " More than 1 year has passed since last update.\u81ea\u5206\u7528\u30e1\u30e2\nHeroku\u306ePython\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb\u3092\u3084\u308a\u307e\u3057\u305f\u3002\nhttps://devcenter.heroku.com/articles/getting-started-with-python\n\u30e1\u30e2\u7528\u3068\u601d\u3063\u3066\u6b8b\u3057\u307e\u3057\u305f\u304c\u7279\u306b\u3064\u307e\u3065\u304b\u306a\u304b\u3063\u305f\u306e\u3067\u3001\u30ce\u30a6\u30cf\u30a6\u7684\u306a\u3082\u306e\u3067\u306f\u306a\u304f\u30b3\u30de\u30f3\u30c9\u30e1\u30e2\u306b\u306a\u308a\u307e\u3057\u305f\u3002\n\n\u524d\u63d0\n\u30ed\u30fc\u30ab\u30eb\u3067 python \u306f\u52d5\u3044\u3066\u308b\nvirtualenv \u3082\u3042\u308b\n\nmac\u306bpostgresql\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\nbrew intall postgresql\n\npostgres\u7528\u306b\u8a2d\u5b9a\necho 'export PGDATA=/usr/local/var/postgres' >> ~/.zshrc # \u305d\u308c\u305e\u308c\u306eprofile\u306b\n\n\u3053\u308c\u3067 pg_ctl start \u3084 pg_ctl stop \u3067\u8d77\u52d5\u30fb\u505c\u6b62\u3067\u304d\u308b\u3002\n(\u666e\u901a\u3060\u3068 postgres -D /usr/local/var/postgres \u3068\u304b\u3089\u3057\u3044\u306e\u3067\u9762\u5012)\n\u6700\u521d\u304b\u3089\u3042\u308bpostgres\u30e6\u30fc\u30b6\u3067\u5165\u3063\u3066\u307f\u305f\u308a\u3001\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u4e00\u89a7\u3092\u8868\u793a\u3057\u305f\u308a\u3057\u3066\u78ba\u8a8d\npsql -l # DB\u8868\u793a\n\npsql postgres # postgres\u30e6\u30fc\u30b6\u3067\u30ed\u30b0\u30a4\u30f3(\u51fa\u308b\u3068\u304d\u306f \\q)\n\n\nHeroku \u306b\u30a2\u30ab\u30a6\u30f3\u30c8\u4f5c\u6210\nhttps://www.heroku.com/\n\nHeroku\u7528CLI\u30c4\u30fc\u30eb\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\nbrew install heroku-toolbelt\n\n\u305d\u306e\u5f8c Heroku \u306b\u30ed\u30b0\u30a4\u30f3\n$ heroku login\nEnter your Heroku credentials.\nEmail: [email]\nPassword (typing will be hidden):\nLogged in as [email]\n\n\n\u30b5\u30f3\u30d7\u30eb app \u306e\u7528\u610f\u304b\u3089 deploy \u307e\u3067\n\u30b5\u30f3\u30d7\u30eb\u30a2\u30d7\u30ea\u3092clone\u3059\u308b\u3002\ngit clone https://github.com/heroku/python-getting-started.git\n$ cd python-getting-started\n\n\u3067\u304d\u305f\u3089\u3001Heroku\u306b\u30a2\u30d7\u30ea\u3092\u767b\u9332\u3059\u308b\n$ heroku create\nCreating morning-plateau-xxxx... done, stack is cedar-14\nhttps://morning-plateau-xxxx.herokuapp.com/ | https://git.heroku.com/morning-plateau-xxxx.git\nGit remote heroku added\n\n\u9069\u5f53\u306a\u540d\u524d(\u4eca\u56de\u306fmorning-plateau-xxxx)\u3067\u30a2\u30d7\u30ea\u304c\u767b\u9332\u3055\u308c\u308b\u3002\n\u540d\u524d\u3092\u4ed8\u3051\u305f\u3044\u5834\u5408\u306f create \u306e\u5f8c\u308d\u306b\u304b\u304f\u3002 heroku create sanmple-name-app\n\u3053\u306e\u6642\u70b9\u3067\u30ed\u30fc\u30ab\u30eb\u306e git \u306b heroku \u3068\u3044\u3046\u540d\u524d\u3067 remote \u304c\u767b\u9332\u3055\u308c\u308b\u3002\nURL\u306b\u30a2\u30af\u30bb\u30b9\u3059\u308b\u3068\u521d\u671f\u30da\u30fc\u30b8\u307f\u305f\u3044\u306a\u306e\u304c\u51fa\u305f\u3002\n\n\u6b21\u306b\u3001\u30b5\u30f3\u30d7\u30eb\u30a2\u30d7\u30ea\u3092 deploy \u3059\u308b\n$ git push heroku master\nCounting objects: 185, done.\nDelta compression using up to 4 threads.\nCompressing objects: 100% (91/91), done.\nWriting objects: 100% (185/185), 30.52 KiB | 0 bytes/s, done.\nTotal 185 (delta 80), reused 185 (delta 80)\nremote: Compressing source files... done.\nremote: Building source:\nremote:\nremote: -----> Python app detected\nremote: -----> Installing runtime (python-2.7.9)\nremote: -----> Installing dependencies with pip\n# \u9577\u3044\u306e\u3067\u7701\u7565\nremote: -----> Compressing... done, 42.9MB\nremote: -----> Launching... done, v4\nremote:        https://morning-plateau-xxxx.herokuapp.com/ deployed to Heroku\nremote:\nremote: Verifying deploy.... done.\n\ndeploy\u5b8c\u4e86\u3002\n\u51fa\u529b\u3092\u898b\u308b\u3068\u3001\u5358\u306bpush\u3059\u308b\u3060\u3051\u3067\u306a\u304f\u3001\u4f55\u3084\u3089\u74b0\u5883\u69cb\u7bc9\u3057\u305f\u308a\u30b3\u30de\u30f3\u30c9\u5b9f\u884c\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u304c\u5206\u304b\u308b\u3002\n\u30a2\u30d7\u30ea\u3092\u52d5\u304b\u3059\u305f\u3081\u306e\u30d7\u30ed\u30bb\u30b9\u3092\u4e0b\u8a18\u30b3\u30de\u30f3\u30c9\u3067\u8d77\u52d5\u3059\u308b\u3002\nscale\u30921\u306b\u6307\u5b9a\u3057\u3066\u3044\u308b\u304c\u3001\u5927\u304d\u304f\u3059\u308b\u3068\u304a\u91d1\u304b\u304b\u308b\u3093\u3060\u308d\u3046\u304b\uff1f\n\u3068\u308a\u3042\u3048\u305a\u52d5\u304b\u3059\u305f\u3081\u306b\u3001\"Ensure that at least one instance of the app is running\"\u3068\u306e\u3053\u3068\u3002\n$ heroku ps:scale web=1\nScaling dynos... done, now running web at 1:Free.\n\nps \u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3059\u308b\u3068\u78ba\u304b\u306b\u52d5\u3044\u3066\u3044\u308b\u3088\u3046\u3060\u3002\n$ heroku ps\n=== web (Free): gunicorn gettingstarted.wsgi --log-file -\nweb.1: up 2016/01/06 02:36:49 (~ 8m ago)\n\n\u3061\u306a\u307f\u306bweb=2\u306b\u3059\u308b\u3068\u3053\u3046\u306a\u3063\u305f\u3002\u3046\u30fc\u3093\u3002(\u3042\u3068\u3067\u3057\u3089\u3079\u308b)\n$ heroku ps:scale web=2\nScaling dynos... failed\n !    Cannot update to more than 1 Free size dynos per process type.\n\n\u6700\u5f8c\u306b\u3001\u4e0b\u8a18\u3067\u30a2\u30d7\u30ea\u3092\u958b\u304f\nheroku open\n\n\u7c21\u5358\u3002\u3053\u3053\u3067\u3068\u308a\u3042\u3048\u305a\u30da\u30fc\u30b8\u3092\u958b\u304f\u3068\u3053\u308d\u307e\u3067\u5b8c\u4e86\u3002\n\n\u30ed\u30b0\u3092\u898b\u308b\nheroku logs\nheroku logs --tail # tail \u3067\u898b\u308c\u308b\n\n\nProcfile?\n\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306eroot\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u3042\u308b\u30c6\u30ad\u30b9\u30c8\u30d5\u30a1\u30a4\u30eb\u3067\u3001\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u7acb\u3061\u4e0a\u3052\u306b\u5fc5\u8981\u306a\u30b3\u30de\u30f3\u30c9\u3092\u66f8\u304f\u3002\nPython\u306e\u30b5\u30f3\u30d7\u30eb\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306eProcfile\u306f\u4e0b\u8a18\u306e\u3088\u3046\u306b\u306a\u3063\u3066\u3044\u305f\u3002\nweb: gunicorn gettingstarted.wsgi --log-file -\n\nweb \u304c\u30d7\u30ed\u30bb\u30b9\u30bf\u30a4\u30d7\u3067\u3001\u305d\u306e\u5f8c\u304c\u30b3\u30de\u30f3\u30c9\u3002\n\u666e\u901a\u306b\u8d77\u52d5\u3059\u308b\u3068\u4e00\u3064\u306edyno\u3067\u30d7\u30ed\u30bb\u30b9\u304c\u8d70\u308b\u3002\n(dyno\u3063\u3066\uff1f \u3053\u3053\u3067\u306fProcfile\u306e\u30b3\u30de\u30f3\u30c9\u3092\u8d70\u3089\u305b\u308b\u8efd\u91cf\u30b3\u30f3\u30c6\u30ca)\n\u3061\u3083\u3093\u3068\u307f\u305f\u3044\u5834\u5408\u306f heroku ps\u3002\n\u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u306fdyno\u306f1\u3064&free\u3067\u300130\u5206\u30a2\u30af\u30bb\u30b9\u304c\u306a\u3044or\u4e00\u65e518\u6642\u9593\u4ee5\u4e0a\u52d5\u304f\u3068\u3068\u30b9\u30ea\u30fc\u30d7\u30e2\u30fc\u30c9\u306b\u5165\u308b\u3002\n18\u6642\u9593\u4ee5\u5185\u306a\u3089\u30a2\u30af\u30bb\u30b9\u304c\u6765\u308b\u3068\u6bce\u56de\u7acb\u3061\u4e0a\u304c\u308b\u304c\u3001\u30b9\u30ea\u30fc\u30d7\u5f8c\u3060\u3068\u7acb\u3061\u4e0a\u3052\u51e6\u7406\u5165\u308b\u306e\u3067\u82e5\u5e72\u91cd\u3044\u3002\n\u30b9\u30ea\u30fc\u30d7\u304c\u3044\u3084or\u30b9\u30b1\u30fc\u30eb\u3057\u305f\u3044\u5834\u5408\u306fProfessional\u306b\u5909\u3048\u3066\u306d\u3068\u306e\u3053\u3068\u3002\n\n\u30a2\u30d7\u30ea\u306e\u4f9d\u5b58\u95a2\u4fc2\nrequirements.txt \u304c root \u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u3042\u308c\u3070\u3001Heroku\u306fpython app\u3067\u3042\u308b\u3068\u8a8d\u8b58\u3059\u308b\u3088\u3046\u3060\u3002\n\u30b5\u30f3\u30d7\u30eb\u30a2\u30d7\u30ea\u306e requirements.txt \u306e\u4e2d\u8eab\u306f\u6b21\u306e\u3088\u3046\u306b\u306a\u3063\u3066\u3044\u308b\u3002\n$ cat requirements.txt\ndj-database-url==0.3.0\nDjango==1.8.1\ndjango-postgrespool==0.3.0\ngunicorn==19.3.0\npsycopg2==2.6\nSQLAlchemy==1.0.4\nwhitenoise==1.0.6\n\n\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb\u306b\u306e\u3063\u3066\u3044\u305f\u3082\u306e\u3068\u82e5\u5e72\u9055\u3046\u304c\u3001Heroku\u306f\u3053\u308c\u3092\u5143\u306b\u5fc5\u8981\u306a\u30e9\u30a4\u30d6\u30e9\u30ea\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\u3002\n\u3053\u308c\u306f\u5fa1\u5b58\u77e5\u306e\u901a\u308a pip freeze \u3068\u540c\u3058\u5f62\u5f0f\u3002\n\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3057\u3066\u304d\u305f\u30b5\u30f3\u30d7\u30eb\u30a2\u30d7\u30ea\u306a\u306e\u3067\u3001\u3068\u308a\u3042\u3048\u305a\u540c\u3058\u74b0\u5883\u3092\u30ed\u30fc\u30ab\u30eb\u306b\u4f5c\u308b\u3002\npython\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u306f\u3001\u30eb\u30fc\u30c8\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u3042\u308b runtime.txt \u306b\u66f8\u3044\u3066\u3042\u308b\u3002\n(pyenv\u3092\u4f7f\u3063\u3066\u3044\u305f\u305f\u3081\u305d\u308c\u3067\u74b0\u5883\u4f5c\u6210\u3057\u305f\u3002)\n$ cat runtime.txt\npython-2.7.9\n$ pyenv install 2.7.9\n$ pyenv virtualenv 2.7.9 sample-app\n$ cd [workspace]\n$ pyenv local sample-app\n$ pip install -r requirements.txt --allow-all-external\n\n\n\u30ed\u30fc\u30ab\u30eb\u3067\u52d5\u304b\u3059\nheroku\u3067\u52d5\u304b\u3057\u305f\u3082\u306e\u3092\u30ed\u30fc\u30ab\u30eb\u3067\u3082\u52d5\u304b\u3059\u3002\n$ python manage.py collectstatic # \u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u5185\u306e\u9759\u7684\u30d5\u30a1\u30a4\u30eb\u3092\u4e00\u7b87\u6240\u306b\u96c6\u3081\u308b\n$ heroku local web\n\nhttp://localhost:5000/ \u306b\u30a2\u30af\u30bb\u30b9\u3057\u3066\u78ba\u304b\u306b\u52d5\u3044\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3002\n\n\u30ed\u30fc\u30ab\u30eb\u306e\u5909\u66f4\u3092 heroku \u306b\u53cd\u6620\n\u9069\u5f53\u306b\u30ed\u30fc\u30ab\u30eb\u3092\u5909\u66f4\u3057\u3066heroku\u306bpush\u3059\u308b\u6d41\u308c\u3002requests\u3092import\u3057\u3066\u3001\u9069\u5f53\u306a\u30b5\u30a4\u30c8\u306b\u30ea\u30af\u30a8\u30b9\u30c8\u3092\u98db\u3070\u3057\u3066\u305d\u306e\u30ec\u30b9\u30dd\u30f3\u30b9\u3092\u8868\u793a\u3059\u308b\u3088\u3046\u306a\u5909\u66f4\u3092\u52a0\u3048\u3066\u3001push\u3057\u3066\u3044\u308b\u3002\n\u307e\u305a\u3001requirements.txt \u306b\u6b21\u3092\u52a0\u3048\u308b\u3002\nrequests==2.3.0\n\nhello/views.py \u306e\u982d\u306b\u6b21\u3092\u8db3\u3057\u3001\nimport requests\n\nindex\u3068\u3044\u3046\u95a2\u6570\u3092\u6b21\u306e\u3088\u3046\u306b\u66f8\u304d\u63db\u3048\u308b\ndef index(request):\n    r = requests.get('http://httpbin.org/status/418')\n    print r.text\n    return HttpResponse('<pre>' + r.text + '</pre>')\n\n\u30ed\u30fc\u30ab\u30eb\u3067\u5b9f\u884c\n$ pip install -r requirements.txt --allow-all-external\n$ heroku local\n\nhttp://localhost:5000/ \u306b\u3044\u3063\u3066\u307f\u308b\u3068\u3001\u3001http://httpbin.org/status/418 \u306e\u5185\u5bb9\u304c\u3002\n    -=[ teapot ]=-\n\n       _...._\n     .'  _ _ `.\n    | .\"` ^ `\". _,\n    \\_;`\"---\"`|//\n      |       ;/\n      \\_     _/\n        `\"\"\"`\n\n\u304b\u308f\u3044\u3044\u3002\n\u7121\u4e8b\u5909\u308f\u3063\u3066\u3044\u305f\u306e\u3067\u3001heroku\u306b\u53cd\u6620\u3055\u305b\u308b\u3002\n$ git add .\n$ git commit -m \"Demo\"\n$ git push heroku masterg\n$ heroku open\n\ndeploy\u5b8c\u4e86\u3001\u540c\u3058teapot\u306e\u30da\u30fc\u30b8\u304c\u958b\u304f\u3002\nheroku\u3078\u306edeploy\u306f\u57fa\u672c\u7684\u306b\u3053\u306e\u6d41\u308c\u3002\n\n\u30a2\u30c9\u30aa\u30f3\u306e\u8ffd\u52a0\n\u4f8b\u3068\u3057\u3066\u3001papertrail\u3092\u8ffd\u52a0\u3059\u308b\u3002\n$ heroku addons:create papertrail\n !    Please verify your account to install this add-on plan (please enter a credit card) For more information, see https://devcenter.heroku.com/categories/billing Verify now at https://heroku.com/verify\n\n\u6012\u3089\u308c\u305f\u3002\u60aa\u7528\u9632\u6b62\u306e\u305f\u3081addon\u306fverify\u304c\u3044\u308b\u3088\u3046\u3060\u3002\n\u3073\u3073\u308a\u3064\u3064\u30af\u30ec\u30ab\u60c5\u5831\u3092\u767b\u9332\u3057\u3066\u518d\u5ea6\u8a66\u3059\u3068\u3044\u3051\u305f\u3002\n$ heroku addons:create papertrail\nCreating papertrail-rigid-xxxx... done, (free)\nAdding papertrail-rigid-xxxx to morning-plateau-xxxx... done\nSetting PAPERTRAIL_API_TOKEN and restarting morning-plateau-xxxx... done, v6\nWelcome to Papertrail. Questions and ideas are welcome (support@papertrailapp.com). Happy logging!\nUse `heroku addons:docs papertrail` to view documentation.\n\n\u3053\u308c\u3067deployed. \u73fe\u5728\u306eaddon\u4e00\u89a7\u306f\u4e0b\u8a18\u30b3\u30de\u30f3\u30c9\u3067\u898b\u308c\u308b\u3002\n$ heroku addons\nAdd-on                                         Plan       Price\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500  \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500  \u2500\u2500\u2500\u2500\u2500\nheroku-postgresql (postgresql-octagonal-xxxx)  hobby-dev  free\n \u2514\u2500 as DATABASE\n\npapertrail (papertrail-rigid-xxxx)             choklad    free\n \u2514\u2500 as PAPERTRAIL\n\nThe table above shows add-ons and the attachments to the current app (morning-plateau-xxxx) or other apps.\n\npapertrail \u3067\u65e9\u901f\u898b\u3066\u307f\u308b\nheroku addons:open papertrail\n\n\u30d6\u30e9\u30a6\u30b6\u304c\u958b\u3044\u3066\u30ed\u30b0\u304c\u78ba\u8a8d\u3067\u304d\u308b\u3002\n\n\u30b3\u30f3\u30bd\u30fc\u30eb\nheroku run COMMAND \u30b3\u30de\u30f3\u30c9\u3067heroku\u306e\u30b3\u30f3\u30bd\u30fc\u30eb\u304c\u4f7f\u3048\u308b\u3002\n\u3053\u3053\u3067\u306f\u30b3\u30de\u30f3\u30c9\u306fone-off dyno\u3068\u3044\u3046\u4e00\u6642\u7684\u306adyno\u4e0a\u3067\u52d5\u3044\u3066\u3044\u308b\u3089\u3057\u3044\u3002\n$ heroku run pwd\nRunning pwd on morning-plateau-xxxx... up, run.5945\n/app\n$ heroku run python manage.py shell\nRunning python manage.py shell on morning-plateau-xxxx... up, run.4047\nPython 2.7.9 (default, Dec 11 2014, 17:18:51)\n[GCC 4.8.2] on linux2\nType \"help\", \"copyright\", \"credits\" or \"license\" for more information.\n(InteractiveConsole)\n>>> import requests\n>>> print requests.get('http://httpbin.org/status/418').text\n\n    -=[ teapot ]=-\n\n       _...._\n     .'  _ _ `.\n    | .\"` ^ `\". _,\n    \\_;`\"---\"`|//\n      |       ;/\n      \\_     _/\n        `\"\"\"`\n\n\n\u540c\u69d8\u306b\u3001dyno\u306ebash\u3092\u4e0b\u8a18\u3067\u52d5\u304b\u305b\u308b\u3002\n$ heroku run bash\nRunning bash on morning-plateau-xxxx... up, run.3252\n$ ls\napp.json  gettingstarted  hello  manage.py  Procfile  Procfile.windows  README.md  requirements.txt  runtime.txt  staticfiles\n$ exit\nexit\n\n\n\u8a2d\u5b9a\u7528\u5909\u6570\u306e\u5b9a\u7fa9\n\u5916\u90e8\u306b\u7f6e\u304d\u305f\u3044 secret key \u306e\u3088\u3046\u306a\u8a2d\u5b9a\u7528\u5909\u6570\u3084\u5916\u90e8\u30ea\u30bd\u30fc\u30b9\u3002\n\u5b9f\u884c\u6642\u3001\u8a2d\u5b9a\u5909\u6570\u306f\u74b0\u5883\u5909\u6570\u306b\u5165\u308b\u3002\nhello/view.py \u306e\u6700\u521d\u306b\u6b21\u3092\u8ffd\u52a0\u3002\nimport os\n\n\u307e\u305f\u3001index\u3092\u6b21\u306e\u3088\u3046\u306b\u66f8\u304d\u63db\u3048\u308b\ndef index(request):\n    times = int(os.environ.get('TIMES',3))\n    return HttpResponse('Hello! ' * times)\n\nlocal \u306e .env \u30d5\u30a1\u30a4\u30eb\u306b\u6b21\u3092\u8ffd\u52a0\u3002\u3053\u3053\u3092\u898b\u3066\u74b0\u5883\u5909\u6570\u304c\u8a2d\u5b9a\u3055\u308c\u308b\u3002\nTIMES=2\n\nheroku config:set\u3067\u3082Heroku\u4e0a\u3067\u306e\u8a2d\u5b9a\u5909\u6570\u3092\u8a2d\u5b9a\u3067\u304d\u308b\u3002\u307e\u305fheroku config\u3067\u78ba\u8a8d\u3067\u304d\u308b\u3002\n$ heroku config:set TIMES=2\nSetting config vars and restarting morning-plateau-xxxx... done\nTIMES: 2\n$ heroku config\n=== morning-plateau-xxxx Config Vars\nDATABASE_URL:         xxxx\nPAPERTRAIL_API_TOKEN: xxxx\nTIMES:                2\n\n\n\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306e\u6e96\u5099(Free\u306ePostgres\u30a2\u30c9\u30aa\u30f3)\n\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3082addon\u3067\u8272\u3005\u7528\u610f\u3055\u308c\u3066\u3044\u308b\u3002addon\u306a\u306e\u3067\u73fe\u5728\u306e\u3082\u306e\u3092heroku addons\u3067\u78ba\u8a8d\u3067\u304d\u308b\u3002\nheroku config\u306eDATABASE_URL\u3067\u3001\u63a5\u7d9a\u5148\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306eURL\u304c\u767b\u9332\u3055\u308c\u3066\u3044\u308b\u306e\u304c\u898b\u308c\u308b\u3002\n\nheroku config\n=== morning-plateau-xxxx Config Vars\nDATABASE_URL:         postgres://~~~ #\u7565\n\n\u307e\u305f\u3001heroku pg \u30b3\u30de\u30f3\u30c9\u306f\u8a73\u7d30\u304c\u5f97\u3089\u308c\u308b\u3002\n$ heroku pg\n=== DATABASE_URL\nPlan:        Hobby-dev\nStatus:      Available\nConnections: 0/20\nPG Version:  9.4.4\nCreated:     2016-01-05 17:36 UTC\nData Size:   6.4 MB\nTables:      0\nRows:        0/10000 (In compliance)\nFork/Follow: Unsupported\nRollback:    Unsupported\nAdd-on:      postgresql-octagonal-xxxx\n\n\u30b5\u30f3\u30d7\u30eb\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306b\u3082DB\u306f\u65e2\u306b\u6709\u52b9\u5316\u3055\u308c\u3066\u3044\u3066\u3001URL\u672b\u5c3e\u306b /db \u3068\u3064\u3051\u308b\u3053\u3068\u3067\u30a2\u30af\u30bb\u30b9\u3067\u304d\u308b\u304c\u3001\u4eca\u306e\u72b6\u614b\u3067\u306f\u307e\u3060\u30c6\u30fc\u30d6\u30eb\u304c\u4f5c\u6210\u3055\u308c\u3066\u3044\u306a\u3044\u305f\u3081\u3001\u30a2\u30af\u30bb\u30b9\u3059\u308b\u3068\u30a8\u30e9\u30fc\u306b\u306a\u308b\u3002\ndjango\u3067\u30c6\u30fc\u30d6\u30eb\u3092\u4f5c\u308b\u305f\u3081\u306b\u3001Heroku\u3067manage.py migrate\u3092\u5b9f\u884c\u3059\u308b\u3002\n$ heroku run python manage.py migrate\nRunning python manage.py migrate on morning-plateau-xxxx... up, run.6683\nOperations to perform:\n  Synchronize unmigrated apps: messages, hello, staticfiles\n  Apply all migrations: admin, sessions, auth, contenttypes\n  # ...\n  # \u7565\n\n\u3082\u3046\u4e00\u5ea6URL+/db\u306b\u30a2\u30af\u30bb\u30b9\u3059\u308b\u3068\u3001\u4eca\u5ea6\u306f\u30a8\u30e9\u30fc\u3067\u306f\u306a\u304f\u3001\u30a2\u30af\u30bb\u30b9\u3059\u308b\u5ea6\u306b\u30ec\u30b3\u30fc\u30c9\u304c\u5897\u3048\u3066\u3044\u304f\u3088\u3046\u306a\u30b7\u30f3\u30d7\u30eb\u306a\u30da\u30fc\u30b8\u304c\u8868\u793a\u3055\u308c\u308b\u3002\nDB\u306e\u30e2\u30c7\u30eb\u306fhello/models.py\u306b\u3001\u8a2d\u5b9a\u306fgettingstarted/settings.py\u306b\u3042\u308b\u3002\n(django\u306b\u3064\u3044\u3066\u306e\u8aac\u660e\u306f\u3057\u307e\u305b\u3093)\n\u30ed\u30fc\u30ab\u30eb\u306bpostgresql\u304c\u306f\u3044\u3063\u3066\u3044\u308b\u306a\u3089\u3001\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306eroot\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u304b\u3089heroku\u306edb\u306b\u6b21\u3067\u30a2\u30af\u30bb\u30b9\u3067\u304d\u308b\u3002\n$ heroku pg:psql\n---> Connecting to DATABASE_URL\npsql (9.4.5, server 9.4.4)\nType \"help\" for help.\n\nmorning-plateau-xxxx::DATABASE=> select * from hello_greeting;\n id |             when\n----+-------------------------------\n  1 | 2016-01-11 16:09:35.860529+00\n  2 | 2016-01-11 16:10:28.385479+00\n(2 rows)\n\nHeroku Postgres \u306e\u8a73\u7d30\u306b\u3064\u3044\u3066\u306f https://devcenter.heroku.com/articles/heroku-postgresql \u3092\u53c2\u7167\u3068\u306e\u3053\u3068\u3002\n\n\u6b21\u306e\u30b9\u30c6\u30c3\u30d7\n\u3053\u3053\u307e\u3067\u3067\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb\u306f\u7d42\u308f\u308a\u3002\u6700\u5f8c\u306b\u3001\u6b21\u306e\u30b9\u30c6\u30c3\u30d7\u3068\u3057\u30662\u3064\u306e\u30ea\u30f3\u30af\u304c\u7528\u610f\u3055\u308c\u3066\u3044\u308b\u3002\n- How Heroku Works https://devcenter.heroku.com/articles/how-heroku-works \nHeroku\u81ea\u4f53\u306b\u3064\u3044\u3066\u306e\u8a73\u7d30\u77e5\u308a\u305f\u3044\u4eba\u5411\u3051\u30ea\u30f3\u30af\u3002\n- Python on Heroku https://devcenter.heroku.com/categories/python\nHeroku\u5185\u306ePython\u60c5\u5831\u30dd\u30fc\u30bf\u30eb\u3002\n\u81ea\u5206\u7528\u30e1\u30e2\n\nHeroku\u306ePython\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb\u3092\u3084\u308a\u307e\u3057\u305f\u3002\nhttps://devcenter.heroku.com/articles/getting-started-with-python\n\u30e1\u30e2\u7528\u3068\u601d\u3063\u3066\u6b8b\u3057\u307e\u3057\u305f\u304c\u7279\u306b\u3064\u307e\u3065\u304b\u306a\u304b\u3063\u305f\u306e\u3067\u3001\u30ce\u30a6\u30cf\u30a6\u7684\u306a\u3082\u306e\u3067\u306f\u306a\u304f\u30b3\u30de\u30f3\u30c9\u30e1\u30e2\u306b\u306a\u308a\u307e\u3057\u305f\u3002\n\n# \u524d\u63d0\n\u30ed\u30fc\u30ab\u30eb\u3067 python \u306f\u52d5\u3044\u3066\u308b\nvirtualenv \u3082\u3042\u308b\n\n# mac\u306bpostgresql\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n```\nbrew intall postgresql\n```\npostgres\u7528\u306b\u8a2d\u5b9a\n\n```\necho 'export PGDATA=/usr/local/var/postgres' >> ~/.zshrc # \u305d\u308c\u305e\u308c\u306eprofile\u306b\n```\n\u3053\u308c\u3067 ` pg_ctl start` \u3084 `pg_ctl stop` \u3067\u8d77\u52d5\u30fb\u505c\u6b62\u3067\u304d\u308b\u3002\n(\u666e\u901a\u3060\u3068 `postgres -D /usr/local/var/postgres` \u3068\u304b\u3089\u3057\u3044\u306e\u3067\u9762\u5012)\n\u6700\u521d\u304b\u3089\u3042\u308bpostgres\u30e6\u30fc\u30b6\u3067\u5165\u3063\u3066\u307f\u305f\u308a\u3001\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u4e00\u89a7\u3092\u8868\u793a\u3057\u305f\u308a\u3057\u3066\u78ba\u8a8d\n\n``` \npsql -l # DB\u8868\u793a\n```\n``` \npsql postgres # postgres\u30e6\u30fc\u30b6\u3067\u30ed\u30b0\u30a4\u30f3(\u51fa\u308b\u3068\u304d\u306f \\q)\n```\n\n# Heroku \u306b\u30a2\u30ab\u30a6\u30f3\u30c8\u4f5c\u6210\n\nhttps://www.heroku.com/\n\n# Heroku\u7528CLI\u30c4\u30fc\u30eb\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n```\nbrew install heroku-toolbelt\n```\n\u305d\u306e\u5f8c Heroku \u306b\u30ed\u30b0\u30a4\u30f3\n\n```\n$ heroku login\nEnter your Heroku credentials.\nEmail: [email]\nPassword (typing will be hidden):\nLogged in as [email]\n```\n\n\n# \u30b5\u30f3\u30d7\u30eb app \u306e\u7528\u610f\u304b\u3089 deploy \u307e\u3067\n\u30b5\u30f3\u30d7\u30eb\u30a2\u30d7\u30ea\u3092clone\u3059\u308b\u3002\n\n```\ngit clone https://github.com/heroku/python-getting-started.git\n$ cd python-getting-started\n```\n\u3067\u304d\u305f\u3089\u3001Heroku\u306b\u30a2\u30d7\u30ea\u3092\u767b\u9332\u3059\u308b\n\n```\n$ heroku create\nCreating morning-plateau-xxxx... done, stack is cedar-14\nhttps://morning-plateau-xxxx.herokuapp.com/ | https://git.heroku.com/morning-plateau-xxxx.git\nGit remote heroku added\n```\n\u9069\u5f53\u306a\u540d\u524d(\u4eca\u56de\u306fmorning-plateau-xxxx)\u3067\u30a2\u30d7\u30ea\u304c\u767b\u9332\u3055\u308c\u308b\u3002\n\u540d\u524d\u3092\u4ed8\u3051\u305f\u3044\u5834\u5408\u306f `create` \u306e\u5f8c\u308d\u306b\u304b\u304f\u3002 `heroku create sanmple-name-app`\n\u3053\u306e\u6642\u70b9\u3067\u30ed\u30fc\u30ab\u30eb\u306e git \u306b heroku \u3068\u3044\u3046\u540d\u524d\u3067 remote \u304c\u767b\u9332\u3055\u308c\u308b\u3002\nURL\u306b\u30a2\u30af\u30bb\u30b9\u3059\u308b\u3068\u521d\u671f\u30da\u30fc\u30b8\u307f\u305f\u3044\u306a\u306e\u304c\u51fa\u305f\u3002\n\n![\u521d\u671f\u30da\u30fc\u30b8\u3063\u307d\u3044\u306e](https://gyazo.com/4169a334202a4df94369d360721461ed.png)\n\n\u6b21\u306b\u3001\u30b5\u30f3\u30d7\u30eb\u30a2\u30d7\u30ea\u3092 deploy \u3059\u308b\n\n```\n$ git push heroku master\nCounting objects: 185, done.\nDelta compression using up to 4 threads.\nCompressing objects: 100% (91/91), done.\nWriting objects: 100% (185/185), 30.52 KiB | 0 bytes/s, done.\nTotal 185 (delta 80), reused 185 (delta 80)\nremote: Compressing source files... done.\nremote: Building source:\nremote:\nremote: -----> Python app detected\nremote: -----> Installing runtime (python-2.7.9)\nremote: -----> Installing dependencies with pip\n# \u9577\u3044\u306e\u3067\u7701\u7565\nremote: -----> Compressing... done, 42.9MB\nremote: -----> Launching... done, v4\nremote:        https://morning-plateau-xxxx.herokuapp.com/ deployed to Heroku\nremote:\nremote: Verifying deploy.... done.\n```\n\ndeploy\u5b8c\u4e86\u3002\n\u51fa\u529b\u3092\u898b\u308b\u3068\u3001\u5358\u306bpush\u3059\u308b\u3060\u3051\u3067\u306a\u304f\u3001\u4f55\u3084\u3089\u74b0\u5883\u69cb\u7bc9\u3057\u305f\u308a\u30b3\u30de\u30f3\u30c9\u5b9f\u884c\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u304c\u5206\u304b\u308b\u3002\n\n\u30a2\u30d7\u30ea\u3092\u52d5\u304b\u3059\u305f\u3081\u306e\u30d7\u30ed\u30bb\u30b9\u3092\u4e0b\u8a18\u30b3\u30de\u30f3\u30c9\u3067\u8d77\u52d5\u3059\u308b\u3002\nscale\u30921\u306b\u6307\u5b9a\u3057\u3066\u3044\u308b\u304c\u3001\u5927\u304d\u304f\u3059\u308b\u3068\u304a\u91d1\u304b\u304b\u308b\u3093\u3060\u308d\u3046\u304b\uff1f\n\u3068\u308a\u3042\u3048\u305a\u52d5\u304b\u3059\u305f\u3081\u306b\u3001\"Ensure that at least one instance of the app is running\"\u3068\u306e\u3053\u3068\u3002\n\n```\n$ heroku ps:scale web=1\nScaling dynos... done, now running web at 1:Free.\n```\n\nps \u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3059\u308b\u3068\u78ba\u304b\u306b\u52d5\u3044\u3066\u3044\u308b\u3088\u3046\u3060\u3002\n\n```\n$ heroku ps\n=== web (Free): gunicorn gettingstarted.wsgi --log-file -\nweb.1: up 2016/01/06 02:36:49 (~ 8m ago)\n```\n\n\u3061\u306a\u307f\u306bweb=2\u306b\u3059\u308b\u3068\u3053\u3046\u306a\u3063\u305f\u3002\u3046\u30fc\u3093\u3002(\u3042\u3068\u3067\u3057\u3089\u3079\u308b)\n\n```\n$ heroku ps:scale web=2\nScaling dynos... failed\n !    Cannot update to more than 1 Free size dynos per process type.\n```\n\n\u6700\u5f8c\u306b\u3001\u4e0b\u8a18\u3067\u30a2\u30d7\u30ea\u3092\u958b\u304f\n\n```\nheroku open\n```\n\u7c21\u5358\u3002\u3053\u3053\u3067\u3068\u308a\u3042\u3048\u305a\u30da\u30fc\u30b8\u3092\u958b\u304f\u3068\u3053\u308d\u307e\u3067\u5b8c\u4e86\u3002\n\n# \u30ed\u30b0\u3092\u898b\u308b\n\n```\nheroku logs\nheroku logs --tail # tail \u3067\u898b\u308c\u308b\n```\n\n# Procfile?\n\n\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306eroot\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u3042\u308b\u30c6\u30ad\u30b9\u30c8\u30d5\u30a1\u30a4\u30eb\u3067\u3001\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u7acb\u3061\u4e0a\u3052\u306b\u5fc5\u8981\u306a\u30b3\u30de\u30f3\u30c9\u3092\u66f8\u304f\u3002\nPython\u306e\u30b5\u30f3\u30d7\u30eb\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306eProcfile\u306f\u4e0b\u8a18\u306e\u3088\u3046\u306b\u306a\u3063\u3066\u3044\u305f\u3002\n\n```\nweb: gunicorn gettingstarted.wsgi --log-file -\n```\n\n`web` \u304c\u30d7\u30ed\u30bb\u30b9\u30bf\u30a4\u30d7\u3067\u3001\u305d\u306e\u5f8c\u304c\u30b3\u30de\u30f3\u30c9\u3002\n\u666e\u901a\u306b\u8d77\u52d5\u3059\u308b\u3068\u4e00\u3064\u306edyno\u3067\u30d7\u30ed\u30bb\u30b9\u304c\u8d70\u308b\u3002\n([dyno\u3063\u3066\uff1f](https://devcenter.heroku.com/articles/dynos) \u3053\u3053\u3067\u306fProcfile\u306e\u30b3\u30de\u30f3\u30c9\u3092\u8d70\u3089\u305b\u308b\u8efd\u91cf\u30b3\u30f3\u30c6\u30ca)\n\u3061\u3083\u3093\u3068\u307f\u305f\u3044\u5834\u5408\u306f `heroku ps`\u3002\n\n\u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u306fdyno\u306f1\u3064&free\u3067\u300130\u5206\u30a2\u30af\u30bb\u30b9\u304c\u306a\u3044or\u4e00\u65e518\u6642\u9593\u4ee5\u4e0a\u52d5\u304f\u3068\u3068\u30b9\u30ea\u30fc\u30d7\u30e2\u30fc\u30c9\u306b\u5165\u308b\u3002\n18\u6642\u9593\u4ee5\u5185\u306a\u3089\u30a2\u30af\u30bb\u30b9\u304c\u6765\u308b\u3068\u6bce\u56de\u7acb\u3061\u4e0a\u304c\u308b\u304c\u3001\u30b9\u30ea\u30fc\u30d7\u5f8c\u3060\u3068\u7acb\u3061\u4e0a\u3052\u51e6\u7406\u5165\u308b\u306e\u3067\u82e5\u5e72\u91cd\u3044\u3002\n\u30b9\u30ea\u30fc\u30d7\u304c\u3044\u3084or\u30b9\u30b1\u30fc\u30eb\u3057\u305f\u3044\u5834\u5408\u306fProfessional\u306b\u5909\u3048\u3066\u306d\u3068\u306e\u3053\u3068\u3002\n\n# \u30a2\u30d7\u30ea\u306e\u4f9d\u5b58\u95a2\u4fc2\nrequirements.txt \u304c root \u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u3042\u308c\u3070\u3001Heroku\u306fpython app\u3067\u3042\u308b\u3068\u8a8d\u8b58\u3059\u308b\u3088\u3046\u3060\u3002\n\u30b5\u30f3\u30d7\u30eb\u30a2\u30d7\u30ea\u306e requirements.txt \u306e\u4e2d\u8eab\u306f\u6b21\u306e\u3088\u3046\u306b\u306a\u3063\u3066\u3044\u308b\u3002\n\n```\n$ cat requirements.txt\ndj-database-url==0.3.0\nDjango==1.8.1\ndjango-postgrespool==0.3.0\ngunicorn==19.3.0\npsycopg2==2.6\nSQLAlchemy==1.0.4\nwhitenoise==1.0.6\n```\n\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb\u306b\u306e\u3063\u3066\u3044\u305f\u3082\u306e\u3068\u82e5\u5e72\u9055\u3046\u304c\u3001Heroku\u306f\u3053\u308c\u3092\u5143\u306b\u5fc5\u8981\u306a\u30e9\u30a4\u30d6\u30e9\u30ea\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\u3002\n\u3053\u308c\u306f\u5fa1\u5b58\u77e5\u306e\u901a\u308a `pip freeze` \u3068\u540c\u3058\u5f62\u5f0f\u3002\n\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3057\u3066\u304d\u305f\u30b5\u30f3\u30d7\u30eb\u30a2\u30d7\u30ea\u306a\u306e\u3067\u3001\u3068\u308a\u3042\u3048\u305a\u540c\u3058\u74b0\u5883\u3092\u30ed\u30fc\u30ab\u30eb\u306b\u4f5c\u308b\u3002\npython\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u306f\u3001\u30eb\u30fc\u30c8\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u3042\u308b `runtime.txt` \u306b\u66f8\u3044\u3066\u3042\u308b\u3002\n(pyenv\u3092\u4f7f\u3063\u3066\u3044\u305f\u305f\u3081\u305d\u308c\u3067\u74b0\u5883\u4f5c\u6210\u3057\u305f\u3002)\n\n```\n$ cat runtime.txt\npython-2.7.9\n$ pyenv install 2.7.9\n$ pyenv virtualenv 2.7.9 sample-app\n$ cd [workspace]\n$ pyenv local sample-app\n$ pip install -r requirements.txt --allow-all-external\n```\n\n# \u30ed\u30fc\u30ab\u30eb\u3067\u52d5\u304b\u3059\n\nheroku\u3067\u52d5\u304b\u3057\u305f\u3082\u306e\u3092\u30ed\u30fc\u30ab\u30eb\u3067\u3082\u52d5\u304b\u3059\u3002\n\n```\n$ python manage.py collectstatic # \u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u5185\u306e\u9759\u7684\u30d5\u30a1\u30a4\u30eb\u3092\u4e00\u7b87\u6240\u306b\u96c6\u3081\u308b\n$ heroku local web\n```\nhttp://localhost:5000/ \u306b\u30a2\u30af\u30bb\u30b9\u3057\u3066\u78ba\u304b\u306b\u52d5\u3044\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3002\n\n# \u30ed\u30fc\u30ab\u30eb\u306e\u5909\u66f4\u3092 heroku \u306b\u53cd\u6620\n\u9069\u5f53\u306b\u30ed\u30fc\u30ab\u30eb\u3092\u5909\u66f4\u3057\u3066heroku\u306bpush\u3059\u308b\u6d41\u308c\u3002requests\u3092import\u3057\u3066\u3001\u9069\u5f53\u306a\u30b5\u30a4\u30c8\u306b\u30ea\u30af\u30a8\u30b9\u30c8\u3092\u98db\u3070\u3057\u3066\u305d\u306e\u30ec\u30b9\u30dd\u30f3\u30b9\u3092\u8868\u793a\u3059\u308b\u3088\u3046\u306a\u5909\u66f4\u3092\u52a0\u3048\u3066\u3001push\u3057\u3066\u3044\u308b\u3002\n\u307e\u305a\u3001`requirements.txt` \u306b\u6b21\u3092\u52a0\u3048\u308b\u3002\n\n```\nrequests==2.3.0\n```\n`hello/views.py` \u306e\u982d\u306b\u6b21\u3092\u8db3\u3057\u3001\n\n```\nimport requests\n```\nindex\u3068\u3044\u3046\u95a2\u6570\u3092\u6b21\u306e\u3088\u3046\u306b\u66f8\u304d\u63db\u3048\u308b\n\n```\ndef index(request):\n    r = requests.get('http://httpbin.org/status/418')\n    print r.text\n    return HttpResponse('<pre>' + r.text + '</pre>')\n```\n\u30ed\u30fc\u30ab\u30eb\u3067\u5b9f\u884c\n\n```\n$ pip install -r requirements.txt --allow-all-external\n$ heroku local\n```\nhttp://localhost:5000/ \u306b\u3044\u3063\u3066\u307f\u308b\u3068\u3001\u3001http://httpbin.org/status/418 \u306e\u5185\u5bb9\u304c\u3002\n\n```\n    -=[ teapot ]=-\n\n       _...._\n     .'  _ _ `.\n    | .\"` ^ `\". _,\n    \\_;`\"---\"`|//\n      |       ;/\n      \\_     _/\n        `\"\"\"`\n```\n\u304b\u308f\u3044\u3044\u3002\n\n\u7121\u4e8b\u5909\u308f\u3063\u3066\u3044\u305f\u306e\u3067\u3001heroku\u306b\u53cd\u6620\u3055\u305b\u308b\u3002\n\n```\n$ git add .\n$ git commit -m \"Demo\"\n$ git push heroku masterg\n$ heroku open\n```\n\ndeploy\u5b8c\u4e86\u3001\u540c\u3058teapot\u306e\u30da\u30fc\u30b8\u304c\u958b\u304f\u3002\nheroku\u3078\u306edeploy\u306f\u57fa\u672c\u7684\u306b\u3053\u306e\u6d41\u308c\u3002\n\n# \u30a2\u30c9\u30aa\u30f3\u306e\u8ffd\u52a0\n\n\u4f8b\u3068\u3057\u3066\u3001papertrail\u3092\u8ffd\u52a0\u3059\u308b\u3002\n\n```\n$ heroku addons:create papertrail\n !    Please verify your account to install this add-on plan (please enter a credit card) For more information, see https://devcenter.heroku.com/categories/billing Verify now at https://heroku.com/verify\n```\n\n\u6012\u3089\u308c\u305f\u3002\u60aa\u7528\u9632\u6b62\u306e\u305f\u3081addon\u306fverify\u304c\u3044\u308b\u3088\u3046\u3060\u3002\n\u3073\u3073\u308a\u3064\u3064\u30af\u30ec\u30ab\u60c5\u5831\u3092\u767b\u9332\u3057\u3066\u518d\u5ea6\u8a66\u3059\u3068\u3044\u3051\u305f\u3002\n\n```\n$ heroku addons:create papertrail\nCreating papertrail-rigid-xxxx... done, (free)\nAdding papertrail-rigid-xxxx to morning-plateau-xxxx... done\nSetting PAPERTRAIL_API_TOKEN and restarting morning-plateau-xxxx... done, v6\nWelcome to Papertrail. Questions and ideas are welcome (support@papertrailapp.com). Happy logging!\nUse `heroku addons:docs papertrail` to view documentation.\n```\n\n\u3053\u308c\u3067deployed. \u73fe\u5728\u306eaddon\u4e00\u89a7\u306f\u4e0b\u8a18\u30b3\u30de\u30f3\u30c9\u3067\u898b\u308c\u308b\u3002\n\n```\n$ heroku addons\nAdd-on                                         Plan       Price\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500  \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500  \u2500\u2500\u2500\u2500\u2500\nheroku-postgresql (postgresql-octagonal-xxxx)  hobby-dev  free\n \u2514\u2500 as DATABASE\n\npapertrail (papertrail-rigid-xxxx)             choklad    free\n \u2514\u2500 as PAPERTRAIL\n\nThe table above shows add-ons and the attachments to the current app (morning-plateau-xxxx) or other apps.\n```\n\npapertrail \u3067\u65e9\u901f\u898b\u3066\u307f\u308b\n\n```\nheroku addons:open papertrail\n```\n\u30d6\u30e9\u30a6\u30b6\u304c\u958b\u3044\u3066\u30ed\u30b0\u304c\u78ba\u8a8d\u3067\u304d\u308b\u3002\n\n# \u30b3\u30f3\u30bd\u30fc\u30eb\n\n`heroku run COMMAND` \u30b3\u30de\u30f3\u30c9\u3067heroku\u306e\u30b3\u30f3\u30bd\u30fc\u30eb\u304c\u4f7f\u3048\u308b\u3002\n\u3053\u3053\u3067\u306f\u30b3\u30de\u30f3\u30c9\u306fone-off dyno\u3068\u3044\u3046\u4e00\u6642\u7684\u306adyno\u4e0a\u3067\u52d5\u3044\u3066\u3044\u308b\u3089\u3057\u3044\u3002\n\n```\n$ heroku run pwd\nRunning pwd on morning-plateau-xxxx... up, run.5945\n/app\n$ heroku run python manage.py shell\nRunning python manage.py shell on morning-plateau-xxxx... up, run.4047\nPython 2.7.9 (default, Dec 11 2014, 17:18:51)\n[GCC 4.8.2] on linux2\nType \"help\", \"copyright\", \"credits\" or \"license\" for more information.\n(InteractiveConsole)\n>>> import requests\n>>> print requests.get('http://httpbin.org/status/418').text\n\n    -=[ teapot ]=-\n\n       _...._\n     .'  _ _ `.\n    | .\"` ^ `\". _,\n    \\_;`\"---\"`|//\n      |       ;/\n      \\_     _/\n        `\"\"\"`\n\n```\n\u540c\u69d8\u306b\u3001dyno\u306ebash\u3092\u4e0b\u8a18\u3067\u52d5\u304b\u305b\u308b\u3002\n\n```\n$ heroku run bash\nRunning bash on morning-plateau-xxxx... up, run.3252\n$ ls\napp.json  gettingstarted  hello  manage.py  Procfile  Procfile.windows\tREADME.md  requirements.txt  runtime.txt  staticfiles\n$ exit\nexit\n```\n\n# \u8a2d\u5b9a\u7528\u5909\u6570\u306e\u5b9a\u7fa9\n\n\u5916\u90e8\u306b\u7f6e\u304d\u305f\u3044 secret key \u306e\u3088\u3046\u306a\u8a2d\u5b9a\u7528\u5909\u6570\u3084\u5916\u90e8\u30ea\u30bd\u30fc\u30b9\u3002\n\n\u5b9f\u884c\u6642\u3001\u8a2d\u5b9a\u5909\u6570\u306f\u74b0\u5883\u5909\u6570\u306b\u5165\u308b\u3002\n\n`hello/view.py` \u306e\u6700\u521d\u306b\u6b21\u3092\u8ffd\u52a0\u3002\n\n```\nimport os\n```\n\u307e\u305f\u3001`index`\u3092\u6b21\u306e\u3088\u3046\u306b\u66f8\u304d\u63db\u3048\u308b\n\n```\ndef index(request):\n    times = int(os.environ.get('TIMES',3))\n    return HttpResponse('Hello! ' * times)\n```\n\nlocal \u306e .env \u30d5\u30a1\u30a4\u30eb\u306b\u6b21\u3092\u8ffd\u52a0\u3002\u3053\u3053\u3092\u898b\u3066\u74b0\u5883\u5909\u6570\u304c\u8a2d\u5b9a\u3055\u308c\u308b\u3002\n\n```\nTIMES=2\n```\n`heroku config:set`\u3067\u3082Heroku\u4e0a\u3067\u306e\u8a2d\u5b9a\u5909\u6570\u3092\u8a2d\u5b9a\u3067\u304d\u308b\u3002\u307e\u305f`heroku config`\u3067\u78ba\u8a8d\u3067\u304d\u308b\u3002\n\n```\n$ heroku config:set TIMES=2\nSetting config vars and restarting morning-plateau-xxxx... done\nTIMES: 2\n$ heroku config\n=== morning-plateau-xxxx Config Vars\nDATABASE_URL:         xxxx\nPAPERTRAIL_API_TOKEN: xxxx\nTIMES:                2\n```\n\n# \u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306e\u6e96\u5099(Free\u306ePostgres\u30a2\u30c9\u30aa\u30f3)\n\n\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3082addon\u3067\u8272\u3005\u7528\u610f\u3055\u308c\u3066\u3044\u308b\u3002addon\u306a\u306e\u3067\u73fe\u5728\u306e\u3082\u306e\u3092`heroku addons`\u3067\u78ba\u8a8d\u3067\u304d\u308b\u3002\n`heroku config`\u306e`DATABASE_URL`\u3067\u3001\u63a5\u7d9a\u5148\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306eURL\u304c\u767b\u9332\u3055\u308c\u3066\u3044\u308b\u306e\u304c\u898b\u308c\u308b\u3002\n```\nheroku config\n=== morning-plateau-xxxx Config Vars\nDATABASE_URL:         postgres://~~~ #\u7565\n```\n\u307e\u305f\u3001`heroku pg` \u30b3\u30de\u30f3\u30c9\u306f\u8a73\u7d30\u304c\u5f97\u3089\u308c\u308b\u3002\n\n```\n$ heroku pg\n=== DATABASE_URL\nPlan:        Hobby-dev\nStatus:      Available\nConnections: 0/20\nPG Version:  9.4.4\nCreated:     2016-01-05 17:36 UTC\nData Size:   6.4 MB\nTables:      0\nRows:        0/10000 (In compliance)\nFork/Follow: Unsupported\nRollback:    Unsupported\nAdd-on:      postgresql-octagonal-xxxx\n```\n\n\u30b5\u30f3\u30d7\u30eb\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306b\u3082DB\u306f\u65e2\u306b\u6709\u52b9\u5316\u3055\u308c\u3066\u3044\u3066\u3001URL\u672b\u5c3e\u306b `/db` \u3068\u3064\u3051\u308b\u3053\u3068\u3067\u30a2\u30af\u30bb\u30b9\u3067\u304d\u308b\u304c\u3001\u4eca\u306e\u72b6\u614b\u3067\u306f\u307e\u3060\u30c6\u30fc\u30d6\u30eb\u304c\u4f5c\u6210\u3055\u308c\u3066\u3044\u306a\u3044\u305f\u3081\u3001\u30a2\u30af\u30bb\u30b9\u3059\u308b\u3068\u30a8\u30e9\u30fc\u306b\u306a\u308b\u3002\ndjango\u3067\u30c6\u30fc\u30d6\u30eb\u3092\u4f5c\u308b\u305f\u3081\u306b\u3001Heroku\u3067`manage.py migrate`\u3092\u5b9f\u884c\u3059\u308b\u3002\n\n```\n$ heroku run python manage.py migrate\nRunning python manage.py migrate on morning-plateau-xxxx... up, run.6683\nOperations to perform:\n  Synchronize unmigrated apps: messages, hello, staticfiles\n  Apply all migrations: admin, sessions, auth, contenttypes\n  # ...\n  # \u7565\n```\n\n\u3082\u3046\u4e00\u5ea6`URL+/db`\u306b\u30a2\u30af\u30bb\u30b9\u3059\u308b\u3068\u3001\u4eca\u5ea6\u306f\u30a8\u30e9\u30fc\u3067\u306f\u306a\u304f\u3001\u30a2\u30af\u30bb\u30b9\u3059\u308b\u5ea6\u306b\u30ec\u30b3\u30fc\u30c9\u304c\u5897\u3048\u3066\u3044\u304f\u3088\u3046\u306a\u30b7\u30f3\u30d7\u30eb\u306a\u30da\u30fc\u30b8\u304c\u8868\u793a\u3055\u308c\u308b\u3002\n\nDB\u306e\u30e2\u30c7\u30eb\u306f`hello/models.py`\u306b\u3001\u8a2d\u5b9a\u306f`gettingstarted/settings.py`\u306b\u3042\u308b\u3002\n(django\u306b\u3064\u3044\u3066\u306e\u8aac\u660e\u306f\u3057\u307e\u305b\u3093)\n\n\u30ed\u30fc\u30ab\u30eb\u306bpostgresql\u304c\u306f\u3044\u3063\u3066\u3044\u308b\u306a\u3089\u3001\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306eroot\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u304b\u3089heroku\u306edb\u306b\u6b21\u3067\u30a2\u30af\u30bb\u30b9\u3067\u304d\u308b\u3002\n\n```\n$ heroku pg:psql\n---> Connecting to DATABASE_URL\npsql (9.4.5, server 9.4.4)\nType \"help\" for help.\n\nmorning-plateau-xxxx::DATABASE=> select * from hello_greeting;\n id |             when\n----+-------------------------------\n  1 | 2016-01-11 16:09:35.860529+00\n  2 | 2016-01-11 16:10:28.385479+00\n(2 rows)\n```\n\nHeroku Postgres \u306e\u8a73\u7d30\u306b\u3064\u3044\u3066\u306f https://devcenter.heroku.com/articles/heroku-postgresql \u3092\u53c2\u7167\u3068\u306e\u3053\u3068\u3002\n\n# \u6b21\u306e\u30b9\u30c6\u30c3\u30d7\n\n\u3053\u3053\u307e\u3067\u3067\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb\u306f\u7d42\u308f\u308a\u3002\u6700\u5f8c\u306b\u3001\u6b21\u306e\u30b9\u30c6\u30c3\u30d7\u3068\u3057\u30662\u3064\u306e\u30ea\u30f3\u30af\u304c\u7528\u610f\u3055\u308c\u3066\u3044\u308b\u3002\n- How Heroku Works https://devcenter.heroku.com/articles/how-heroku-works \nHeroku\u81ea\u4f53\u306b\u3064\u3044\u3066\u306e\u8a73\u7d30\u77e5\u308a\u305f\u3044\u4eba\u5411\u3051\u30ea\u30f3\u30af\u3002\n- Python on Heroku https://devcenter.heroku.com/categories/python\nHeroku\u5185\u306ePython\u60c5\u5831\u30dd\u30fc\u30bf\u30eb\u3002\n", "tags": ["Python", "Heroku", "Django"]}