{"context": "\n\n\u3053\u306e\u30cf\u30f3\u30ba\u30aa\u30f3\u306b\u3064\u3044\u3066\n\n\u3053\u306e\u30cf\u30f3\u30ba\u30aa\u30f3\u3067\u306f\u3001Redshift\u306e\u30af\u30e9\u30b9\u30bf\u30fc\u3068\u305d\u306e\u30af\u30e9\u30b9\u30bf\u306b\u5bfe\u3057\u3066\u30af\u30a8\u30ea\u3092\u767a\u884c\u3059\u308b\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306e\u4f5c\u6210\u3092\u5b9f\u65bd\u3057\u307e\u3059\u3002\n\u30af\u30a8\u30ea\u306e\u767a\u884c\u306b\u306f\u3001\u300cpsql\u300d\u3092\u5229\u7528\u3057\u307e\u3059\u3002\u672c\u624b\u9806\u3067\u306f\u3001Amazon Linux\u4e0a\u3078\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3068\u5229\u7528\u65b9\u6cd5\u3092\u8aac\u660e\u3057\u307e\u3059\u3002\n\n\n\u524d\u63d0\u6761\u4ef6\n\n\u30d0\u30fc\u30b8\u30e7\u30f3\u78ba\u8a8d\n\u3053\u306e\u30cf\u30f3\u30ba\u30aa\u30f3\u306f\u4ee5\u4e0b\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u3067\u52d5\u4f5c\u78ba\u8a8d\u3092\u884c\u3044\u307e\u3057\u305f\u3002\n\n\u30b3\u30de\u30f3\u30c9\naws --version\n\n\n\n\u7d50\u679c\naws-cli/1.10.23 Python/2.7.10 Linux/4.4.5-15.26.amzn1.x86_64 botocore/1.4.14\n\n\n\n\u5fc5\u8981\u306a\u6a29\u9650\n\u4f5c\u696d\u306b\u3042\u305f\u3063\u3066\u306f\u3001\u4ee5\u4e0b\u306e\u6a29\u9650\u3092\u6709\u3057\u305fIAM\u30e6\u30fc\u30b6\u3082\u3057\u304f\u306fIAM\u30ed\u30fc\u30eb\u3092\u5229\u7528\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\nEC2\u306b\u5bfe\u3059\u308b\u30d5\u30eb\u30b3\u30f3\u30c8\u30ed\u30fc\u30eb\u6a29\u9650\nRedShift\u306b\u95a2\u3059\u308b\u30d5\u30eb\u30b3\u30f3\u30c8\u30ed\u30fc\u30eb\u6a29\u9650\nIAM\u306b\u95a2\u3059\u308b\u30d5\u30eb\u30b3\u30f3\u30c8\u30ed\u30fc\u30eb\u6a29\u9650\nS3\u306b\u95a2\u3059\u308b\u30d5\u30eb\u30b3\u30f3\u30c8\u30ed\u30fc\u30eb\u6a29\u9650\nSTS\u306b\u95a2\u3059\u308b\u30d5\u30eb\u30b3\u30f3\u30c8\u30ed\u30fc\u30eb\u6a29\u9650\n\n\n0. \u6e96\u5099\n\n\u30ea\u30fc\u30b8\u30e7\u30f3\u3092\u6307\u5b9a\n\n\u30b3\u30de\u30f3\u30c9\nexport AWS_DEFAULT_REGION='ap-northeast-1'\n\n\n\n\u8cc7\u683c\u60c5\u5831\u3092\u78ba\u8a8d\n\n\u30b3\u30de\u30f3\u30c9\naws configure list\n\n\n\n\u7d50\u679c\nName                    Value             Type    Location\n----                    -----             ----    --------\nprofile                <not set>             None    None\naccess_key     ****************RDPA         iam-role\nsecret_key     ****************9GA8         iam-role\nregion           ap-northeast-1              env    AWS_DEFAULT_REGION\n\n\n\n1. \u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u306e\u4f5c\u6210\u3001\u524a\u9664\n\n\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u540d\u306e\u6307\u5b9a\n\n\u30b3\u30de\u30f3\u30c9\nSNAPSHOT_NAME=mysnapshot\n\n\n\n\u30d1\u30e9\u30e1\u30fc\u30bf\u306e\u78ba\u8a8d\n\n\u30b3\u30de\u30f3\u30c9\ncat << ETX\n\n   CLUSTER_NAME: ${CLUSTER_NAME}\n   SNAPSHOT_NAME: ${SNAPSHOT_NAME}\n\nETX\n\n\n\n\u7d50\u679c\n\n   CLUSTER_NAME: mycluster\n   SNAPSHOT_NAME: mysnapshot\n\n\n\n\n\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u306e\u4f5c\u6210\n\n\u30b3\u30de\u30f3\u30c9\naws redshift create-cluster-snapshot --snapshot-identifier ${SNAPSHOT_NAME} \\\n  --cluster-identifier ${CLUSTER_NAME}\n\n\n\n\u7d50\u679c\n{\n    \"Snapshot\": {\n        \"EstimatedSecondsToCompletion\": -1,\n        \"OwnerAccount\": \"************\",\n        \"CurrentBackupRateInMegaBytesPerSecond\": 0.0,\n        \"ActualIncrementalBackupSizeInMegaBytes\": -1.0,\n        \"NumberOfNodes\": 1,\n        \"Status\": \"creating\",\n        \"VpcId\": \"vpc-********\",\n        \"ClusterVersion\": \"1.0\",\n        \"Tags\": [],\n        \"MasterUsername\": \"awsuser\",\n        \"TotalBackupSizeInMegaBytes\": -1.0,\n        \"DBName\": \"mydb\",\n        \"BackupProgressInMegaBytes\": 0.0,\n        \"ClusterCreateTime\": \"2016-04-28T10:47:23.091Z\",\n        \"EncryptedWithHSM\": false,\n        \"ClusterIdentifier\": \"mycluster\",\n        \"SnapshotCreateTime\": \"2016-04-28T13:21:08.756Z\",\n        \"AvailabilityZone\": \"ap-northeast-1a\",\n        \"NodeType\": \"dc1.large\",\n        \"Encrypted\": false,\n        \"ElapsedTimeInSeconds\": 0,\n        \"SnapshotType\": \"manual\",\n        \"Port\": 5439,\n        \"SnapshotIdentifier\": \"mysnapshot\"\n    }\n}\n\n\n\n\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u306e\u78ba\u8a8d\n\uff08\u4f5c\u6210\u304c\u5b8c\u4e86\u3059\u308b\u307e\u3067\u5c11\u3005\u304a\u5f85\u3061\u304f\u3060\u3055\u3044\u3002\uff09\n\n\u30b3\u30de\u30f3\u30c9\naws redshift describe-cluster-snapshots --query Snapshots[?SnapshotType==\\'manual\\']\n\n\n\n\u7d50\u679c\n[\n    {\n        \"EstimatedSecondsToCompletion\": 0,\n        \"OwnerAccount\": \"************\",\n        \"CurrentBackupRateInMegaBytesPerSecond\": 53.8349,\n        \"ActualIncrementalBackupSizeInMegaBytes\": 332.0,\n        \"NumberOfNodes\": 1,\n        \"Status\": \"available\",\n        \"VpcId\": \"vpc-********\",\n        \"ClusterVersion\": \"1.0\",\n        \"Tags\": [],\n        \"MasterUsername\": \"awsuser\",\n        \"TotalBackupSizeInMegaBytes\": 339.0,\n        \"DBName\": \"mydb\",\n        \"BackupProgressInMegaBytes\": 332.0,\n        \"ClusterCreateTime\": \"2016-04-28T10:47:23.091Z\",\n        \"RestorableNodeTypes\": [\n            \"dc1.large\"\n        ],\n        \"EncryptedWithHSM\": false,\n        \"ClusterIdentifier\": \"mycluster\",\n        \"SnapshotCreateTime\": \"2016-04-28T13:21:32.303Z\",\n        \"AvailabilityZone\": \"ap-northeast-1a\",\n        \"NodeType\": \"dc1.large\",\n        \"Encrypted\": false,\n        \"ElapsedTimeInSeconds\": 6,\n        \"SnapshotType\": \"manual\",\n        \"Port\": 5439,\n        \"SnapshotIdentifier\": \"mysnapshot\"\n    }\n]\n\n\n\n\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u306e\u524a\u9664\n\n\u30b3\u30de\u30f3\u30c9\naws redshift delete-cluster-snapshot --snapshot-identifier ${SNAPSHOT_NAME}\n\n\n\n\u7d50\u679c\n{\n    \"Snapshot\": {\n        \"EstimatedSecondsToCompletion\": 0,\n        \"OwnerAccount\": \"************\",\n        \"CurrentBackupRateInMegaBytesPerSecond\": 53.8349,\n        \"ActualIncrementalBackupSizeInMegaBytes\": 332.0,\n        \"NumberOfNodes\": 1,\n        \"Status\": \"deleted\",\n        \"VpcId\": \"vpc-********\",\n        \"ClusterVersion\": \"1.0\",\n        \"Tags\": [],\n        \"MasterUsername\": \"awsuser\",\n        \"TotalBackupSizeInMegaBytes\": 339.0,\n        \"DBName\": \"mydb\",\n        \"BackupProgressInMegaBytes\": 332.0,\n        \"ClusterCreateTime\": \"2016-04-28T10:47:23.091Z\",\n        \"EncryptedWithHSM\": false,\n        \"ClusterIdentifier\": \"mycluster\",\n        \"SnapshotCreateTime\": \"2016-04-28T13:21:32.303Z\",\n        \"AvailabilityZone\": \"ap-northeast-1a\",\n        \"NodeType\": \"dc1.large\",\n        \"Encrypted\": false,\n        \"ElapsedTimeInSeconds\": 6,\n        \"SnapshotType\": \"manual\",\n        \"Port\": 5439,\n        \"SnapshotIdentifier\": \"mysnapshot\"\n    }\n}\n\n\n\n\u78ba\u8a8d\n\n\u30b3\u30de\u30f3\u30c9\naws redshift describe-cluster-snapshots --query Snapshots[?SnapshotType==\\'manual\\']\n\n\n\n\u7d50\u679c\n[]\n\n\n\u4ee5\u4e0a\n# \u3053\u306e\u30cf\u30f3\u30ba\u30aa\u30f3\u306b\u3064\u3044\u3066\n- \u3053\u306e\u30cf\u30f3\u30ba\u30aa\u30f3\u3067\u306f\u3001Redshift\u306e\u30af\u30e9\u30b9\u30bf\u30fc\u3068\u305d\u306e\u30af\u30e9\u30b9\u30bf\u306b\u5bfe\u3057\u3066\u30af\u30a8\u30ea\u3092\u767a\u884c\u3059\u308b\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306e\u4f5c\u6210\u3092\u5b9f\u65bd\u3057\u307e\u3059\u3002\n- \u30af\u30a8\u30ea\u306e\u767a\u884c\u306b\u306f\u3001\u300cpsql\u300d\u3092\u5229\u7528\u3057\u307e\u3059\u3002\u672c\u624b\u9806\u3067\u306f\u3001Amazon Linux\u4e0a\u3078\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3068\u5229\u7528\u65b9\u6cd5\u3092\u8aac\u660e\u3057\u307e\u3059\u3002\n\n\n# \u524d\u63d0\u6761\u4ef6\n\n## \u30d0\u30fc\u30b8\u30e7\u30f3\u78ba\u8a8d\n\n\u3053\u306e\u30cf\u30f3\u30ba\u30aa\u30f3\u306f\u4ee5\u4e0b\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u3067\u52d5\u4f5c\u78ba\u8a8d\u3092\u884c\u3044\u307e\u3057\u305f\u3002\n\n```bash:\u30b3\u30de\u30f3\u30c9\naws --version\n```\n\n```text:\u7d50\u679c\naws-cli/1.10.23 Python/2.7.10 Linux/4.4.5-15.26.amzn1.x86_64 botocore/1.4.14\n```\n\n## \u5fc5\u8981\u306a\u6a29\u9650\n\n\u4f5c\u696d\u306b\u3042\u305f\u3063\u3066\u306f\u3001\u4ee5\u4e0b\u306e\u6a29\u9650\u3092\u6709\u3057\u305fIAM\u30e6\u30fc\u30b6\u3082\u3057\u304f\u306fIAM\u30ed\u30fc\u30eb\u3092\u5229\u7528\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n- EC2\u306b\u5bfe\u3059\u308b\u30d5\u30eb\u30b3\u30f3\u30c8\u30ed\u30fc\u30eb\u6a29\u9650\n- RedShift\u306b\u95a2\u3059\u308b\u30d5\u30eb\u30b3\u30f3\u30c8\u30ed\u30fc\u30eb\u6a29\u9650\n- IAM\u306b\u95a2\u3059\u308b\u30d5\u30eb\u30b3\u30f3\u30c8\u30ed\u30fc\u30eb\u6a29\u9650\n- S3\u306b\u95a2\u3059\u308b\u30d5\u30eb\u30b3\u30f3\u30c8\u30ed\u30fc\u30eb\u6a29\u9650\n- STS\u306b\u95a2\u3059\u308b\u30d5\u30eb\u30b3\u30f3\u30c8\u30ed\u30fc\u30eb\u6a29\u9650\n\n\n# 0. \u6e96\u5099\n\n## \u30ea\u30fc\u30b8\u30e7\u30f3\u3092\u6307\u5b9a\n\n```bash:\u30b3\u30de\u30f3\u30c9\nexport AWS_DEFAULT_REGION='ap-northeast-1'\n```\n\n## \u8cc7\u683c\u60c5\u5831\u3092\u78ba\u8a8d\n\n```bash:\u30b3\u30de\u30f3\u30c9\naws configure list\n```\n\n```text:\u7d50\u679c\nName                    Value             Type    Location\n----                    -----             ----    --------\nprofile                <not set>             None    None\naccess_key     ****************RDPA         iam-role\nsecret_key     ****************9GA8         iam-role\nregion           ap-northeast-1              env    AWS_DEFAULT_REGION\n```\n\n# 1. \u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u306e\u4f5c\u6210\u3001\u524a\u9664\n\n## \u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u540d\u306e\u6307\u5b9a\n\n```bash:\u30b3\u30de\u30f3\u30c9\nSNAPSHOT_NAME=mysnapshot\n```\n\n## \u30d1\u30e9\u30e1\u30fc\u30bf\u306e\u78ba\u8a8d\n\n```bash:\u30b3\u30de\u30f3\u30c9\ncat << ETX\n\n   CLUSTER_NAME: ${CLUSTER_NAME}\n   SNAPSHOT_NAME: ${SNAPSHOT_NAME}\n\nETX\n```\n\n```text:\u7d50\u679c\n\n   CLUSTER_NAME: mycluster\n   SNAPSHOT_NAME: mysnapshot\n\n```\n\n\n## \u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u306e\u4f5c\u6210\n\n```bash:\u30b3\u30de\u30f3\u30c9\naws redshift create-cluster-snapshot --snapshot-identifier ${SNAPSHOT_NAME} \\\n  --cluster-identifier ${CLUSTER_NAME}\n```\n\n```json:\u7d50\u679c\n{\n    \"Snapshot\": {\n        \"EstimatedSecondsToCompletion\": -1,\n        \"OwnerAccount\": \"************\",\n        \"CurrentBackupRateInMegaBytesPerSecond\": 0.0,\n        \"ActualIncrementalBackupSizeInMegaBytes\": -1.0,\n        \"NumberOfNodes\": 1,\n        \"Status\": \"creating\",\n        \"VpcId\": \"vpc-********\",\n        \"ClusterVersion\": \"1.0\",\n        \"Tags\": [],\n        \"MasterUsername\": \"awsuser\",\n        \"TotalBackupSizeInMegaBytes\": -1.0,\n        \"DBName\": \"mydb\",\n        \"BackupProgressInMegaBytes\": 0.0,\n        \"ClusterCreateTime\": \"2016-04-28T10:47:23.091Z\",\n        \"EncryptedWithHSM\": false,\n        \"ClusterIdentifier\": \"mycluster\",\n        \"SnapshotCreateTime\": \"2016-04-28T13:21:08.756Z\",\n        \"AvailabilityZone\": \"ap-northeast-1a\",\n        \"NodeType\": \"dc1.large\",\n        \"Encrypted\": false,\n        \"ElapsedTimeInSeconds\": 0,\n        \"SnapshotType\": \"manual\",\n        \"Port\": 5439,\n        \"SnapshotIdentifier\": \"mysnapshot\"\n    }\n}\n```\n\n## \u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u306e\u78ba\u8a8d\n\n\uff08\u4f5c\u6210\u304c\u5b8c\u4e86\u3059\u308b\u307e\u3067\u5c11\u3005\u304a\u5f85\u3061\u304f\u3060\u3055\u3044\u3002\uff09\n\n```bash:\u30b3\u30de\u30f3\u30c9\naws redshift describe-cluster-snapshots --query Snapshots[?SnapshotType==\\'manual\\']\n```\n\n```json:\u7d50\u679c\n[\n    {\n        \"EstimatedSecondsToCompletion\": 0,\n        \"OwnerAccount\": \"************\",\n        \"CurrentBackupRateInMegaBytesPerSecond\": 53.8349,\n        \"ActualIncrementalBackupSizeInMegaBytes\": 332.0,\n        \"NumberOfNodes\": 1,\n        \"Status\": \"available\",\n        \"VpcId\": \"vpc-********\",\n        \"ClusterVersion\": \"1.0\",\n        \"Tags\": [],\n        \"MasterUsername\": \"awsuser\",\n        \"TotalBackupSizeInMegaBytes\": 339.0,\n        \"DBName\": \"mydb\",\n        \"BackupProgressInMegaBytes\": 332.0,\n        \"ClusterCreateTime\": \"2016-04-28T10:47:23.091Z\",\n        \"RestorableNodeTypes\": [\n            \"dc1.large\"\n        ],\n        \"EncryptedWithHSM\": false,\n        \"ClusterIdentifier\": \"mycluster\",\n        \"SnapshotCreateTime\": \"2016-04-28T13:21:32.303Z\",\n        \"AvailabilityZone\": \"ap-northeast-1a\",\n        \"NodeType\": \"dc1.large\",\n        \"Encrypted\": false,\n        \"ElapsedTimeInSeconds\": 6,\n        \"SnapshotType\": \"manual\",\n        \"Port\": 5439,\n        \"SnapshotIdentifier\": \"mysnapshot\"\n    }\n]\n```\n\n## \u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u306e\u524a\u9664\n\n```bash:\u30b3\u30de\u30f3\u30c9\naws redshift delete-cluster-snapshot --snapshot-identifier ${SNAPSHOT_NAME}\n```\n\n```json:\u7d50\u679c\n{\n    \"Snapshot\": {\n        \"EstimatedSecondsToCompletion\": 0,\n        \"OwnerAccount\": \"************\",\n        \"CurrentBackupRateInMegaBytesPerSecond\": 53.8349,\n        \"ActualIncrementalBackupSizeInMegaBytes\": 332.0,\n        \"NumberOfNodes\": 1,\n        \"Status\": \"deleted\",\n        \"VpcId\": \"vpc-********\",\n        \"ClusterVersion\": \"1.0\",\n        \"Tags\": [],\n        \"MasterUsername\": \"awsuser\",\n        \"TotalBackupSizeInMegaBytes\": 339.0,\n        \"DBName\": \"mydb\",\n        \"BackupProgressInMegaBytes\": 332.0,\n        \"ClusterCreateTime\": \"2016-04-28T10:47:23.091Z\",\n        \"EncryptedWithHSM\": false,\n        \"ClusterIdentifier\": \"mycluster\",\n        \"SnapshotCreateTime\": \"2016-04-28T13:21:32.303Z\",\n        \"AvailabilityZone\": \"ap-northeast-1a\",\n        \"NodeType\": \"dc1.large\",\n        \"Encrypted\": false,\n        \"ElapsedTimeInSeconds\": 6,\n        \"SnapshotType\": \"manual\",\n        \"Port\": 5439,\n        \"SnapshotIdentifier\": \"mysnapshot\"\n    }\n}\n```\n\n## \u78ba\u8a8d\n\n```bash:\u30b3\u30de\u30f3\u30c9\naws redshift describe-cluster-snapshots --query Snapshots[?SnapshotType==\\'manual\\']\n```\n\n```json:\u7d50\u679c\n[]\n```\n\n\u4ee5\u4e0a\n", "tags": ["AWS", "aws-cli", "redshift"]}