{"context": "\n\n\u6e96\u5099\n\nProxmox VE 4.x Cluster - Proxmox VE\nMunguia's Tips: Remove Node Cluster (forever) on Proxmox 2.2\n\n\n\nIP\u30a2\u30c9\u30ec\u30b9\u5909\u66f4\n\n/etc/hosts\n/etc/hostname\n/etc/network/interfaces\n\n\n\u8a2d\u5b9a\n\n\u30b5\u30fc\u30d0\u30fc3\u53f0\u69cb\u6210\u3068\u3059\u308b\u3002(pve3,pve4,pve5)\n\n\n\n\u30af\u30e9\u30b9\u30bf\u5b9a\u7fa9\n(pve3)# pvecm create \u30af\u30e9\u30b9\u30bf\u540d\n\n\n\npve3 \u304c\u30de\u30b9\u30bf\u30ce\u30fc\u30c9\u3068\u306a\u308b\u3002\n\u30de\u30b9\u30bf\u30ce\u30fc\u30c9\u306e\u5207\u308a\u66ff\u3048\u306f\u4ee5\u4e0b\u3067\u3067\u304d\u308b\u3002\n\n(pve4)# pvecm expected 1\n\n\n\n\u30af\u30e9\u30b9\u30bf\u5b9a\u7fa9\u3057\u305f\u30b5\u30fc\u30d0\u5b9b\u306b\u53c2\u52a0\n(pve4)# pvecm add pve3\n\n\n\n\n\u30af\u30e9\u30b9\u30bf\u5b9a\u7fa9\u3057\u305f\u30b5\u30fc\u30d0\u5b9b\u306b\u53c2\u52a0\n(pve5)# pvecm add pve3\n\n\n\n\u72b6\u614b\u78ba\u8a8d\n(pve3)# pvecm status\n(pve3)# pvecm nodes\n\n\n\n\n\u30ce\u30fc\u30c9\u524a\u9664\n\nnode del but node exist after del | Proxmox Support Forum\n\n(pve3)# pvecm delnode pve5\n\n\n\npve5\u304creboot\u3059\u308b\u3068pvecm nodes\u304b\u3089\u6d88\u3048\u308b\u3002\n\n\n\u30ce\u30fc\u30c9\u524a\u9664(WebUI\u304b\u3089\u524a\u9664)\n\npve3 \u3092\u524a\u9664\u3057\u305f\u5834\u5408\u3002pve3\u304c\u00d7\u3067\u6b8b\u3063\u3066\u3044\u308b\u3002\n\n\n.png)\n\npve4# pvecm delnode pve3\n\n\n\npve3\u306e\u00d7\u304c\u6d88\u3048\u305f\u3053\u3068\u3092\u78ba\u8a8d\u3002\n\n\n\n\u30ce\u30fc\u30c9\u518d\u767b\u9332\n(pve5)# pvecm add pve3         # \u30a8\u30e9\u30fc\u306b\u306a\u308b\u3002\n(pve5)# pvecm add pve3 -force  # \u3053\u308c\u3067\u8ffd\u52a0\u3067\u304d\u308b\u3002\n\n\n\u30b3\u30f3\u30c6\u30ca\u3092\u4ed6\u30ce\u30fc\u30c9\u306b\u79fb\u52d5\n\n\n\n\u306a\u304aonline migration\u306f\u5bfe\u5fdc\u3057\u3066\u3044\u306a\u3044\u3002\n\n## \u6e96\u5099\n\n* [Proxmox VE 4.x Cluster - Proxmox VE](https://pve.proxmox.com/wiki/Proxmox_VE_4.x_Cluster)\n* [Munguia's Tips: Remove Node Cluster (forever) on Proxmox 2.2](http://wmunguiam.blogspot.jp/2013/02/remove-node-cluster-forever-on-proxmox.html)\n\n![1.png](https://qiita-image-store.s3.amazonaws.com/0/25728/b3b635d4-2e11-9c74-788b-5eb5c9112c0d.png)\n\n### IP\u30a2\u30c9\u30ec\u30b9\u5909\u66f4\n\n* /etc/hosts\n* /etc/hostname\n* /etc/network/interfaces\n\n\n## \u8a2d\u5b9a\n\n* \u30b5\u30fc\u30d0\u30fc3\u53f0\u69cb\u6210\u3068\u3059\u308b\u3002(pve3,pve4,pve5)\n\n![1-create-cluster.png](https://qiita-image-store.s3.amazonaws.com/0/25728/dcb66f41-15a8-8863-0b1b-845ed276001a.png)\n\n```bash:\u30af\u30e9\u30b9\u30bf\u5b9a\u7fa9\n(pve3)# pvecm create \u30af\u30e9\u30b9\u30bf\u540d\n```\n\n* pve3 \u304c\u30de\u30b9\u30bf\u30ce\u30fc\u30c9\u3068\u306a\u308b\u3002\n* \u30de\u30b9\u30bf\u30ce\u30fc\u30c9\u306e\u5207\u308a\u66ff\u3048\u306f\u4ee5\u4e0b\u3067\u3067\u304d\u308b\u3002\n\n```\n(pve4)# pvecm expected 1\n```\n\n![2-join4.png](https://qiita-image-store.s3.amazonaws.com/0/25728/ac93759d-793f-b201-e8d4-f804a6ec4685.png)\n\n```bash:\u30af\u30e9\u30b9\u30bf\u5b9a\u7fa9\u3057\u305f\u30b5\u30fc\u30d0\u5b9b\u306b\u53c2\u52a0\n(pve4)# pvecm add pve3\n```\n\n![3-join.png](https://qiita-image-store.s3.amazonaws.com/0/25728/4c8e7b4c-b0e8-151c-0c88-8c07ad1f671b.png)\n\n```bash:\u30af\u30e9\u30b9\u30bf\u5b9a\u7fa9\u3057\u305f\u30b5\u30fc\u30d0\u5b9b\u306b\u53c2\u52a0\n(pve5)# pvecm add pve3\n```\n\n### \u72b6\u614b\u78ba\u8a8d\n\n```bash:\n(pve3)# pvecm status\n(pve3)# pvecm nodes\n```\n\n![4-status.png](https://qiita-image-store.s3.amazonaws.com/0/25728/c13e38e6-d6f1-091c-93e2-5569d9704add.png)\n![5-nodes.png](https://qiita-image-store.s3.amazonaws.com/0/25728/3b230baf-2c7c-a100-90c2-0fee3d81e0da.png)\n\n### \u30ce\u30fc\u30c9\u524a\u9664\n\n* [node del but node exist after del | Proxmox Support Forum](https://forum.proxmox.com/threads/node-del-but-node-exist-after-del.13038/)\n\n```bash:\n(pve3)# pvecm delnode pve5\n```\n\n![6-nodes.png](https://qiita-image-store.s3.amazonaws.com/0/25728/340e8463-df88-a1ca-d9ad-5a0a859446f6.png)\n\n* pve5\u304creboot\u3059\u308b\u3068`pvecm nodes`\u304b\u3089\u6d88\u3048\u308b\u3002\n\n### \u30ce\u30fc\u30c9\u524a\u9664(WebUI\u304b\u3089\u524a\u9664)\n\n* pve3 \u3092\u524a\u9664\u3057\u305f\u5834\u5408\u3002pve3\u304c`\u00d7`\u3067\u6b8b\u3063\u3066\u3044\u308b\u3002\n\n![gui.png](https://qiita-image-store.s3.amazonaws.com/0/25728/6eaf5a9d-afe3-4909-1d2e-b51a391b30dc.png)\n.png)\n\n![gui2.png](https://qiita-image-store.s3.amazonaws.com/0/25728/0564902e-6373-9000-7415-8e98b4230785.png)\n\n```\npve4# pvecm delnode pve3\n```\n\n![delnode.png](https://qiita-image-store.s3.amazonaws.com/0/25728/431486f5-f096-145b-d479-6890425744ab.png)\n\n* pve3\u306e`\u00d7`\u304c\u6d88\u3048\u305f\u3053\u3068\u3092\u78ba\u8a8d\u3002\n\n![delnode2.png](https://qiita-image-store.s3.amazonaws.com/0/25728/1db0a109-2f94-c29c-693d-cc747c91cc6b.png)\n\n### \u30ce\u30fc\u30c9\u518d\u767b\u9332\n\n```bash:\n(pve5)# pvecm add pve3         # \u30a8\u30e9\u30fc\u306b\u306a\u308b\u3002\n(pve5)# pvecm add pve3 -force  # \u3053\u308c\u3067\u8ffd\u52a0\u3067\u304d\u308b\u3002\n```\n\n\n## \u30b3\u30f3\u30c6\u30ca\u3092\u4ed6\u30ce\u30fc\u30c9\u306b\u79fb\u52d5\n\n![migrate.png](https://qiita-image-store.s3.amazonaws.com/0/25728/a8938b50-de36-ceb3-cf24-1be21e1228ee.png)\n![migrate2.png](https://qiita-image-store.s3.amazonaws.com/0/25728/279d205b-0668-39c4-4319-d450f17e6d6f.png)\n![migrate3.png](https://qiita-image-store.s3.amazonaws.com/0/25728/317745e8-2469-1632-1705-a04113cecea2.png)\n\n\u306a\u304aonline migration\u306f\u5bfe\u5fdc\u3057\u3066\u3044\u306a\u3044\u3002\n\n![migrate4.png](https://qiita-image-store.s3.amazonaws.com/0/25728/7bb058df-3718-d888-1f5e-15981672bd65.png)\n", "tags": ["proxmox4.3"]}