{"context": "\n\n \u76ee\u7684\n\n\u3000Hubot + Heroku + Slack \u306a\u7d44\u307f\u5408\u308f\u305b\u306f\u3088\u304f\u3042\u308b\u3051\u308c\u3069\u3001\u3046\u3061\u306e\u793e\u5185\u3067\u306f\u30c1\u30e3\u30c3\u30c8\u306b Yammer \u3092\u4f7f\u7528\u3057\u3066\u3044\u308b\u306e\u3068\u3001AWS \u30a2\u30ab\u30a6\u30f3\u30c8\u304c\u3042\u308b\u306e\u3067 AWS/EC2 + Hubot + Yammer \u306e\u7d44\u307f\u5408\u308f\u305b\u3092\u8a66\u3057\u307e\u3059\u3002\n\u3000Slack \u3067\u3084\u3063\u3066\u3082\u3044\u3044\u3093\u3067\u3059\u304c\u5468\u308a\u306e\u4eba\u306b\u308f\u3056\u308f\u3056 Slack \u30a2\u30ab\u30a6\u30f3\u30c8\u4f5c\u3063\u3066\u3082\u3089\u3046\u306e\u304c\u9762\u5012\u306a\u306e\u3068\u3001\u8ab0\u3082 Yammer-Adapter \u4f7f\u3063\u3066\u306a\u3055\u305d\u3046\u306a\u306e\u3067\u4eba\u67f1\u3067\u3059\u3002\n\u3000Hubot-Yammer \u306e README \u3092\u8aad\u307f\u306a\u304c\u3089\u3059\u3059\u3081\u307e\u3057\u305f\u3002\nathieriot/hubot-yammer: This is the Yammer adapter for hubot that allows you to send a message to him with Yammer and he will happily reply the same way.\n\n \u7d50\u679c\n\u3000\u3067\u304d\u307e\u3057\u305f\u3002\n\n\n\n\u3000\u793e\u5185\u3067 ChatOps \u7684\u306a\u3053\u3068\u304c\u3067\u304d\u305d\u3046\u3067\u3059\u3002\n\u3000Hubot \u3092\u751f\u304b\u3059\u70ba\u3060\u3051\u306b EC2 \u4f7f\u3046\u306e\u3082\u3044\u307e\u3044\u3061\u306a\u306e\u3067\u6700\u7d42\u7684\u306b\u306f\u3053\u308c\u3092 Lambda \u3067\u30b5\u30fc\u30d0\u30ec\u30b9\u306b\u3057\u3088\u3046\u3068\u601d\u3063\u3066\u3044\u305f\u306e\u3067\u3059\u304c\u3001Yammer \u306b\u306f Outgoing Webhooks \u306e\u6a5f\u80fd\u304c\u7121\u3044\u306e\u3067\u3001Yammer \u306b\u6295\u7a3f\u304c\u3042\u3063\u305f\u30bf\u30a4\u30df\u30f3\u30b0\u3067\u30a4\u30d9\u30f3\u30c8\u3092\u767a\u884c\u3057\u305f\u3044\u5834\u5408\u306f Zapier \u306a\u3069\u3067 Yammer -> Webhook \u306a\u30ec\u30b7\u30d4(zapbook)\u3092\u4f5c\u3089\u306a\u3044\u3068\u3060\u3081\u307f\u305f\u3044\u3067\u3059\u3002\n\n \u69cb\u7bc9\u624b\u9806\n\u3000EC2 \u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u4f5c\u6210\u3059\u308b\u306e\u3068\u3001Hubot \u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u307e\u3067\u306f\u3056\u3063\u304f\u308a\u3057\u305f\u6d41\u308c\u3060\u3051\u8a18\u8f09\u3057\u307e\u3059\u3002\n\n\u5fc5\u8981\u306a\u3082\u306e\n\n\n\n\u5fc5\u8981\u306a\u3082\u306e\n\u4eca\u56de\u4f5c\u6210\u3057\u305f\u540d\u79f0\n\u5099\u8003\n\n\n\n\nAWS \u306e Linux \u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\n-\n\u7121\u6599\u67a0(t2.micro\uff09\u306eAmazon Linux \u3092\u4f5c\u6210\n\n\nYammer \u5185 Public \u30b0\u30eb\u30fc\u30d7\nBOTTESTGROUP\n\u30c6\u30b9\u30c8\u7528\u306e\u30b0\u30eb\u30fc\u30d7\u3001\u65e5\u672c\u8a9e\u3067\u3082\u3044\u3051\u307e\u3057\u305f\u304c\u30b9\u30da\u30fc\u30b9\u5165\u308c\u308b\u3068\u3060\u3081\u3002\n\n\nBOT\u30a2\u30ab\u30a6\u30f3\u30c8\nYAMMERBOTACCOUNT\nAPI\u30c8\u30fc\u30af\u30f3\u3092\u53d6\u5f97\u3059\u308b\u3001\u5b9f\u969b\u306b\u306f\u4eba\u306e\u30a2\u30ab\u30a6\u30f3\u30c8\u3092\u501f\u308a\u307e\u3057\u305f\u3002\n\n\n\u30c6\u30b9\u30c8\u7528\u30a2\u30ab\u30a6\u30f3\u30c8\nTESTYOUACCOUNT\nBOT\u306b\u8a71\u3057\u304b\u3051\u308b\u7528\u3001\u81ea\u5206\u306e\u30a2\u30ab\u30a6\u30f3\u30c8\u3092\u4f7f\u3044\u307e\u3057\u305f\u3002\n\n\n\n\nAWS/EC2 \u4e0a\u306b Linux \u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u3092\u4f5c\u6210\n\u3000\u7121\u6599\u67a0\uff08t2.micro\uff09\u3067 Linux \u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u3092\u4f5c\u6210\u3001EIP \u3092\u5272\u5f53\u3066\u307e\u3057\u305f\u3002\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30b0\u30eb\u30fc\u30d7\u306f\u69cb\u7bc9\u306e\u305f\u3081\u306e SSH/MyIP \u3068\u3001Yammer API \u547c\u3073\u51fa\u3057\u306e\u305f\u3081\u306e HTTP/AnyIP \u3067\u8a31\u53ef\u304c\u5fc5\u8981\u3067\u3059\u3002\u5f8c\u8005\u306f Yammer API \u306e IP\u7bc4\u56f2\u3067\u7d5e\u3063\u3066\u3082\u826f\u3044\u3068\u304a\u3082\u3044\u307e\u3059\u3002\n\nnodejs, npm \u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\u3000Hubot\u3001Yoneman \u306b\u5fc5\u8981\u306a node.js, npm \u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002n \u306f\u30b0\u30ed\u30fc\u30d0\u30eb\u306b\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u305f node.js \u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u7ba1\u7406\u3059\u308b\u3082\u306e\u307f\u305f\u3044\u3002\n\n[ec2-user@HOST ~]$ sudo yum install nodejs npm --enablerepo=epel\n[ec2-user@HOST ~]$ npm -v\n1.3.6\n[ec2-user@HOST ~]$ sudo npm install -g n\n[ec2-user@HOST ~]$ sudo n stable\n     install : node-v6.8.1\n       mkdir : /usr/local/n/versions/node/6.8.1\n       fetch : https://nodejs.org/dist/v6.8.1/node-v6.8.1-linux-x64.tar.gz\n######################################################################## 100.0%\n   installed : v0.10.46\n[ec2-user@HOST ~]$ node -v\nv0.10.46\n\n\nYeoman\u3001generator-hubot \u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\u3000Yeoman (yo) \u3068 Hubot \u306e Yeoman \u30b8\u30a7\u30cd\u30ec\u30fc\u30bf\u30fc (generator-hubot) \u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\n[ec2-user@HOST ~]$ sudo npm install -g yo generator-hubot\n\uff08\u7565\uff09\n[ec2-user@HOST ~]$ sudo npm list -g generator-hubot yo\nnpm WARN unmet dependency /usr/lib/node_modules/block-stream requires inherits@'~2.0.0' but will load\nnpm WARN unmet dependency undefined,\nnpm WARN unmet dependency which is version undefined\nnpm WARN unmet dependency /usr/lib/node_modules/fstream requires inherits@'~2.0.0' but will load\nnpm WARN unmet dependency undefined,\nnpm WARN unmet dependency which is version undefined\nnpm WARN unmet dependency /usr/lib/node_modules/fstream-ignore requires inherits@'2' but will load\nnpm WARN unmet dependency undefined,\nnpm WARN unmet dependency which is version undefined\nnpm WARN unmet dependency /usr/lib/node_modules/fstream-npm requires inherits@'2' but will load\nnpm WARN unmet dependency undefined,\nnpm WARN unmet dependency which is version undefined\nnpm WARN unmet dependency /usr/lib/node_modules/glob requires inherits@'2' but will load\nnpm WARN unmet dependency undefined,\nnpm WARN unmet dependency which is version undefined\nnpm WARN unmet dependency /usr/lib/node_modules/npmconf requires inherits@'~2.0.0' but will load\nnpm WARN unmet dependency undefined,\nnpm WARN unmet dependency which is version undefined\nnpm WARN unmet dependency /usr/lib/node_modules/tar requires inherits@'2' but will load\nnpm WARN unmet dependency undefined,\nnpm WARN unmet dependency which is version undefined\n/usr/lib\n\u251c\u2500\u2500 generator-hubot@0.4.0 \n\u2514\u2500\u2500 yo@1.8.5 \n\n\n\uff08\u88dc\u8db3\uff09npm WARN unmet dependency \u5bfe\u5fdc\n\u3000\u4f55\u6545\u304b\u30e9\u30a4\u30d6\u30e9\u30ea inherits \u304c\u4e0d\u8db3\u3057\u3066\u3044\u308b\u3088\u3046\u306a\u306e\u3067\u3001\u8ffd\u52a0\u3067\u30b0\u30ed\u30fc\u30d0\u30eb\u306b\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u3001\u30a8\u30e9\u30fc\u304c\u51fa\u306a\u304f\u306a\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3057\u307e\u3057\u305f\u3002\n[ec2-user@HOST ~]$ sudo npm install inherits -g\nnpm http GET https://registry.npmjs.org/inherits\nnpm http 304 https://registry.npmjs.org/inherits\ninherits@2.0.3 /usr/lib/node_modules/inherits\n[ec2-user@HOST ~]$  sudo npm list -g generator-hubot yo\n/usr/lib\n\u251c\u2500\u2500 generator-hubot@0.4.0 \n\u2514\u2500\u2500 yo@1.8.5\n\n\nHubot \u4f5c\u6210\u3001\u521d\u671f\u8a2d\u5b9a\n\u3000\u9069\u5f53\u306a\u540d\u524d\u3067\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092\u4f5c\u6210\u3057\u3066\u3001yo hubot \u3067\u4f5c\u6210\u3002Bot adapter \u306b\u306f yammer \u3092\u6307\u5b9a\u3057\u307e\u3059\u3002\u30b3\u30f3\u30bd\u30fc\u30eb\u304c\u304b\u308f\u3044\u3044\u3002\n[ec2-user@HOST ~]$ mkdir YAMMERBOT\n[ec2-user@HOST ~]$ cd YAMMERBOT\n[ec2-user@HOST YAMMERBOT]$ yo hubot\n\uff08\u7565\uff09\n? Owner MYEMAILADRESS@example.com\n? Bot name YAMMERBOT\n? Description YammerBotDesu\n? Bot adapter yammer\n   create bin/hubot\n   create bin/hubot.cmd\n\uff08\u7565\uff09\n\n\n\u3000\u4f5c\u6210\u5f8c\u306e Procfile \u306f web \u306e Yammer \u306b\u306a\u3063\u3066\u3044\u307e\u3059\u3002\n[ec2-user@HOST ~]$ cat Procfile \nweb: bin/hubot -a yammer\n\n\nHubot \u3092\u30ed\u30fc\u30ab\u30eb\u3067\u52d5\u4f5c\u78ba\u8a8d\n\u3000\u307e\u3060 Yammer \u306b\u306f\u63a5\u7d9a\u3057\u3066\u3044\u307e\u305b\u3093\u3002HUBOT_HEROKU_KEEPALIVE_URL \u8a2d\u5b9a\u305b\u3088\u3068 WARNING \u304c\u51fa\u3066\u3044\u307e\u3059\u304c\u4eca\u306f\u7121\u8996\u3067\u3002\n[ec2-user@HOST YAMMERBOT]$ hubot\nYAMMERBOT> [Thu Oct 20 2016 02:59:28 GMT+0000 (UTC)] WARNING Loading scripts from hubot-scripts.json is deprecated and will be removed in 3.0 (https://github.com/github/hubot-scripts/issues/1113) in favor of packages for each script.\n\nYour hubot-scripts.json is empty, so you just need to remove it.\n[Thu Oct 20 2016 02:59:28 GMT+0000 (UTC)] ERROR hubot-heroku-alive included, but missing HUBOT_HEROKU_KEEPALIVE_URL. `heroku config:set HUBOT_HEROKU_KEEPALIVE_URL=$(heroku apps:info -s  | grep web-url | cut -d= -f2)`\n[Thu Oct 20 2016 02:59:28 GMT+0000 (UTC)] INFO hubot-redis-brain: Using default redis on localhost:6379\nYAMMERBOT> YAMMERBOT ping\nYAMMERBOT> PONG\nYAMMERBOT> YAMMERBOT time\nYAMMERBOT> Server time is: Thu Oct 20 2016 03:01:21 GMT+0000 (UTC)\n\n\nYammer \u304b\u3089 API \u30a2\u30af\u30bb\u30b9\u30ad\u30fc\u53d6\u5f97\n\u3000API \u306e\u30a2\u30af\u30bb\u30b9\u30ad\u30fc\u30c8\u30fc\u30af\u30f3\u3092\u53d6\u5f97\u3057\u307e\u3059\u3002BOT \u30a2\u30ab\u30a6\u30f3\u30c8\u3067 Yammer \u306b\u30ed\u30b0\u30a4\u30f3\u3057\u305f\u72b6\u614b\u3067\u4e0b\u8a18 URL \u306b\u30a2\u30af\u30bb\u30b9\u3057\u307e\u3059\u3002\n\n\u30ed\u30b0\u30a4\u30f3\u30e6\u30fc\u30b6\uff1aYAMMERBOTACCOUNT\nhttps://www.yammer.com/client_applications\nInput\n\n\n\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u540d\uff1aHogeFugaApp\n\u7d44\u7e54\uff1aHOGE\n\u30b5\u30dd\u30fc\u30c8\u7528\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\uff1ahoge@example.com\n\n\u30a6\u30a7\u30d6\u30b5\u30a4\u30c8\uff1ahttps://example.com/\n\n\u30ea\u30c0\u30a4\u30ec\u30af\u30c8\u5148\u306e URI\uff1ahttps://example.com/\n\n\n\n\n\u3000\u4e0a\u8a18\u306e\u3088\u3046\u306b\u8d85\u9069\u5f53\u306b\u5165\u529b\u3059\u308b\u3068\u3001API \u30ad\u30fc\u3092\u53d6\u5f97\u3067\u304d\u307e\u3059\u3002\n\nOutput\n\n\n\u30af\u30e9\u30a4\u30a2\u30f3\u30c8ID\uff1aXxXxXxXxXxXxXxXxXxXxXx\n\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u30b7\u30fc\u30af\u30ec\u30c3\u30c8\uff1aXxXxXxXxXxXxXxXxXxXxXxXxXxXxXxXxXxXxXxXxXx\n\u30ea\u30c0\u30a4\u30ec\u30af\u30c8\u5148\uff1ahttps://example.com/\n\nGenerate a developer token for this application\n\n\nHere is your personal token for testing. Please copy it somewhere safe as this will disappear when you change page:\n00000-XxXxXxXxXxXxXxXxXxXx\n\n\n\n\n\n\u3000\u4e00\u756a\u4e0b\u306e developer token \u3068\u3044\u3046\u306e\u3092\u4f7f\u7528\u3057\u307e\u3059\u3002\n\n\u6295\u7a3f\u7528\u30b0\u30eb\u30fc\u30d7\u306e\u4f5c\u6210\n\u3000Yammer \u4e0a\u306b\u6295\u7a3f\u7528\u306e\u30b0\u30eb\u30fc\u30d7\u3092\u4f5c\u6210\u3001BOT \u30a2\u30ab\u30a6\u30f3\u30c8\u3068\u30c6\u30b9\u30c8\u7528\u30a2\u30ab\u30a6\u30f3\u30c8\u306e2\u3064\u3092\u30b0\u30eb\u30fc\u30d7\u306b\u8ffd\u52a0\u3057\u3066\u304a\u304d\u307e\u3059\u3002\u30b0\u30eb\u30fc\u30d7\u540d\u306f\u74b0\u5883\u5909\u6570\u306b\u8a2d\u5b9a\u3059\u308b\u306e\u3067\u3001\u82f1\u540d\u306e\u307b\u3046\u304c\u3088\u3055\u305d\u3046\u3067\u3059\u3002\n\n\u30b0\u30eb\u30fc\u30d7\u4f5c\u6210\n\n\n\u30b0\u30eb\u30fc\u30d7\u540d\uff1aBOTTESTGROUP\n\u516c\u958b\u7bc4\u56f2\uff1aPublic\n\n\n\u30b0\u30eb\u30fc\u30d7\u30e1\u30f3\u30d0\u8ffd\u52a0\n\n\nBOT \u30a2\u30ab\u30a6\u30f3\u30c8\uff1aYAMMERBOTACCOUNT\n\u30c6\u30b9\u30c8\u7528\u30a2\u30ab\u30a6\u30f3\u30c8\uff1aTESTYOUACCOUNT \n\n\n\n\u3000BOT \u30a2\u30ab\u30a6\u30f3\u30c8\u306e\u30a2\u30ab\u30a6\u30f3\u30c8\u540d\u306f\u5fc5\u305a\u3057\u3082 BOT \u540d\uff08YAMMERBOT\uff09\u3068\u5408\u308f\u305b\u308b\u5fc5\u8981\u306f\u3042\u308a\u307e\u305b\u3093\u3002\n\nAPI \u30ad\u30fc\u8a2d\u5b9a\n\u3000\u5148\u307b\u3069\u53d6\u5f97\u3057\u305f API \u30ad\u30fc\u3068\u3001\u4f5c\u6210\u3057\u305f\u30b0\u30eb\u30fc\u30d7\u540d\u3092\u74b0\u5883\u5909\u6570\u306b\u8ffd\u52a0\u3057\u307e\u3059\u3002HUBOT_HEROKU_KEEPALIVE_URL \u306f\u4f55\u3092\u6307\u5b9a\u3059\u308c\u3070\u3044\u3044\u306e\u304b\u3088\u304f\u308f\u304b\u3089\u306a\u3044\u3051\u3069\u3001KeepAlive \u306e\u305f\u3081\u306b 5 \u5206\u3054\u3068\u306b Get \u3057\u3066\u3044\u308b\u3088\u3046\u306a\u306e\u3067\u3001401 \u304c\u5e30\u3063\u3066\u304f\u308b URL \u3092\u9069\u5f53\u306b\u6307\u5b9a\u3059\u308b\u3068\u3088\u3055\u305d\u3046\u3067\u3057\u305f\u3002Heroku \u3058\u3083\u306a\u3044\u3051\u3069\u4f7f\u3063\u3066\u308b\u307f\u305f\u3044\u3067\u3059\u3002\n[ec2-user@HOST ~]$ export HUBOT_YAMMER_ACCESS_TOKEN=\"00000-XxXxXxXxXxXxXxXxXxXx\"\n[ec2-user@HOST ~]$ export HUBOT_YAMMER_GROUPS=\"BOTTESTGROUP\"\n[ec2-user@HOST ~]$ export HUBOT_HEROKU_KEEPALIVE_URL=\"https://www.yammer.com/api/v1/users.json\"\n[ec2-user@HOST ~]$ printenv\nHUBOT_YAMMER_GROUPS=BOTTESTGROUP\nHUBOT_YAMMER_ACCESS_TOKEN=00000-XxXxXxXxXxXxXxXxXxXx\nHUBOT_HEROKU_KEEPALIVE_URL=https://www.yammer.com/api/v1/users.json\n\n\nEC2 \u304b\u3089 Yamme API \u306b\u7e4b\u304c\u308b\u3053\u3068\u78ba\u8a8d\n\u3000\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u8a2d\u5b9a\u78ba\u8a8d\u306e\u305f\u3081\u3001\u4e00\u5fdc wget \u3057\u307e\u3059\u3002\n[ec2-user@HOST ~]$ wget -O -  https://www.yammer.com/\n\uff08\u7565\uff09\n-                               100%[======================================================>]  15.97K  --.-KB/s    in 0.002s  \n\n2016-10-20 05:11:13 (10.2 MB/s) - written to stdout [16354/16354]\n\n\nBOT \u8d77\u52d5\u3068\u52d5\u4f5c\u78ba\u8a8d\n\u3000\u6e80\u3092\u6301\u3057\u3066\u8d77\u52d5\u3057\u307e\u3059\u3002groups list \u306b\u8a2d\u5b9a\u3057\u305f\u30b0\u30eb\u30fc\u30d7\u540d\u3001groups_ids list \u306b\u30b0\u30eb\u30fc\u30d7\u540d\u304b\u3089\u53d6\u5f97\u3057\u305f\u30b0\u30eb\u30fc\u30d7ID\u304c\u8868\u793a\u3055\u308c\u307e\u3059\u30025 \u5206\u6bce\u306b keepalive \u304c\u6b63\u5e38\u306b\u52d5\u3044\u305f\u30ed\u30b0\u3082\u51fa\u3066\u3044\u307e\u3059\u3002\n[ec2-user@HOST ~]$ hubot -a yammer -n \"YAMMERBOT\"\n[Thu Oct 20 2016 05:21:16 GMT+0000 (UTC)] WARNING Loading scripts from hubot-scripts.json is deprecated and will be removed in 3.0 (https://github.com/github/hubot-scripts/issues/1113) in favor of packages for each script.\n\nYour hubot-scripts.json is empty, so you just need to remove it.\n[Thu Oct 20 2016 05:21:16 GMT+0000 (UTC)] INFO hubot-redis-brain: Using default redis on localhost:6379\ngroups list : BOTTESTGROUP\ngroups_ids list : 0000000\n[Thu Oct 20 2016 05:26:15 GMT+0000 (UTC)] INFO keepalive ping\n[Thu Oct 20 2016 05:26:16 GMT+0000 (UTC)] INFO keepalive pong: 401  \n[Thu Oct 20 2016 05:31:15 GMT+0000 (UTC)] INFO keepalive ping\n[Thu Oct 20 2016 05:31:16 GMT+0000 (UTC)] INFO keepalive pong: 401  \n\n\u3000Yammer \u306e\u30c6\u30b9\u30c8\u7528\u30a2\u30ab\u30a6\u30f3\u30c8\u304b\u3089\u300cYAMMERBOT PING\u300d\u306e\u5f62\u5f0f\u3067\u30b3\u30de\u30f3\u30c9\u304c\u9001\u308c\u307e\u3057\u305f\u3002\u30b3\u30f3\u30bd\u30fc\u30eb\u5074\u306b\u3082\u30ed\u30b0\u304c\u51fa\u529b\u3055\u308c\u307e\u3059\u3002\nreceived YAMMERBOT PING from TESTYOUACCOUNT (thread_id: 000000000, sender_id: 0000000)\nreply message to TESTYOUACCOUNT with text PONG\nMessage creation status 201\n\n\n\n\n\n \u304a\u307e\u3051\u306e\u30a8\u30e9\u30fc\u96c6\n\nBOT \u30a2\u30ab\u30a6\u30f3\u30c8 \u304b\u3089\u30c6\u30b9\u30c8\u3067\u304d\u306a\u3044\u3002\n\u3000BOT \u30a2\u30ab\u30a6\u30f3\u30c8\u3067 BOT \u30a2\u30ab\u30a6\u30f3\u30c8\u306b\u8a71\u3057\u304b\u3051\u3066\u3082\u7121\u8996\u3055\u308c\u308b\u4ed5\u69d8\u3067\u3057\u305f\u3002\ngroups list : BOTTESTGROUP\ngroups_ids list : 0000000\nreceived YAMMERBOT PING from YAMMERBOTACCOUNT (thread_id: 000000000, sender_id: 0000000)\nYAMMERBOT does not reply himself, YAMMERBOT not crazy nor desperate\n\n\n\u8a8d\u8a3c\u30a8\u30e9\u30fc\uff08Authentication failure\uff09\n\u3000HUBOT_YAMMER_ACCESS_TOKEN \u3092\u9593\u9055\u3048\u3066\u3044\u308b\u3068\u8d77\u304d\u308b\u3088\u3046\u3067\u3059\u3002Yammer \u304c\u843d\u3061\u3066\u3066\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u30a8\u30e9\u30fc\u3082\u3053\u308c\u306b\u306a\u308a\u307e\u3057\u305f\u3002\n[Thu Oct 20 2016 04:06:52 GMT+0000 (UTC)] ERROR TypeError: Cannot use 'in' operator to search for 'data' in undefined\n  at /home/ec2-user/node_modules/hubot-yammer/src/yammer.coffee:80:6, <js>:146:23\n  at /home/ec2-user/node_modules/yammer/main.js:13:19\n  at Request._callback (/home/ec2-user/node_modules/yammer/main.js:132:14)\n  at Request.self.callback (/home/ec2-user/node_modules/yammer/node_modules/request/request.js:121:22)\n  at emitTwo (events.js:106:13)\n  at Request.emit (events.js:191:7)\n  at Request.<anonymous> (/home/ec2-user/node_modules/yammer/node_modules/request/request.js:978:14)\n  at emitOne (events.js:101:20)\n  at Request.emit (events.js:188:7)\n  at IncomingMessage.<anonymous> (/home/ec2-user/node_modules/yammer/node_modules/request/request.js:929:12)\n  at emitNone (events.js:91:20)\n  at IncomingMessage.emit (events.js:185:7)\n  at endReadableNT (_stream_readable.js:974:12)\n  at _combinedTickCallback (internal/process/next_tick.js:74:11)\n  at process._tickCallback (internal/process/next_tick.js:98:9)\n\nyammer groups error: Error: Error status 401\n Authentication failure.\n\n\u3000Yammer \u306e\u30b9\u30c6\u30fc\u30bf\u30b9\u306f\u3053\u3061\u3089\u3001\u3088\u304f\u843d\u3061\u307e\u3059\u3002ChatOps \u3082\u305d\u3046\u3060\u3051\u3069\u30b5\u30fc\u30d3\u30b9\u30d5\u30eb\u306b\u3059\u308b\u3068 SaaS \u304c\u6b62\u307e\u308b\u3068\u696d\u52d9\u304c\u6b62\u307e\u308a\u307e\u3059\u306d\u3002\n\nhttps://status.yammer.com/\nhttps://twitter.com/yammerops\n\n\ngroups_id \u53d6\u5f97\u3067\u304d\u306a\u3044\u30a8\u30e9\u30fc\n\u300cgroups_ids list : \uff08\u30d6\u30e9\u30f3\u30af\uff09\u300d\u306b\u306a\u308b\u5834\u5408\u306f\u3001\u30b0\u30eb\u30fc\u30d7 ID \u304c\u53d6\u5f97\u3067\u304d\u3066\u3044\u307e\u305b\u3093\u3001\u30b0\u30eb\u30fc\u30d7\u304c\u5b58\u5728\u3057\u306a\u304b\u3063\u305f\u308a\u3001\u5909\u6570 HUBOT_YAMMER_GROUPS \u306e\u6307\u5b9a\u3092\u9593\u9055\u3048\u308b\u3068\u306a\u308b\u3088\u3046\u3067\u3059\u3002\u6b63\u5e38\u306b\u53d6\u5f97\u3067\u304d\u305f\u5834\u5408\u306e ID \u306f Yammer \u30b0\u30eb\u30fc\u30d7 URL \u306e feedId \u304c\u53d6\u5f97\u3055\u308c\u307e\u3059\u3002\nhttps://www.yammer.com/COMPANY.com/#/threads/inGroup?type=in_group&feedId=0000000&view=all\n[Thu Oct 20 2016 04:07:24 GMT+0000 (UTC)] INFO hubot-redis-brain: Using default redis on localhost:6379\ngroups list : WRONG_GROUP_NAME\ngroups_ids list : \n[Thu Oct 20 2016 04:07:24 GMT+0000 (UTC)] ERROR Error: No group registered or an error occured to resolve IDs.\n  at /home/ec2-user/node_modules/hubot-yammer/src/yammer.coffee:146:20, <js>:225:17\n  at Request._callback (/home/ec2-user/node_modules/yammer/main.js:137:12)\n  at Request.self.callback (/home/ec2-user/node_modules/yammer/node_modules/request/request.js:121:22)\n  at emitTwo (events.js:106:13)\n  at Request.emit (events.js:191:7)\n  at Request.<anonymous> (/home/ec2-user/node_modules/yammer/node_modules/request/request.js:978:14)\n  at emitOne (events.js:101:20)\n  at Request.emit (events.js:188:7)\n  at IncomingMessage.<anonymous> (/home/ec2-user/node_modules/yammer/node_modules/request/request.js:929:12)\n  at emitNone (events.js:91:20)\n  at IncomingMessage.emit (events.js:185:7)\n  at endReadableNT (_stream_readable.js:974:12)\n  at _combinedTickCallback (internal/process/next_tick.js:74:11)\n  at process._tickCallback (internal/process/next_tick.js:98:9)\n\n\nYammer \u3068\u901a\u4fe1\u3067\u304d\u306a\u3044\u3068\u304d\u306e\u30a8\u30e9\u30fc\n\u3000HTTP/Any \u3092\u8a31\u53ef\u3057\u3066\u3044\u306a\u3044\u3068\u304d\u306f\u6b21\u306e\u3088\u3046\u306a\u30a8\u30e9\u30fc\u306b\u306a\u308a\u307e\u3057\u305f\u3002\u30b0\u30eb\u30fc\u30d7 ID \u306f\u53d6\u308c\u3066\u308b\u3051\u3069\u3002\n[Thu Oct 20 2016 08:24:22 GMT+0000 (UTC)] INFO hubot-redis-brain: Using default redis on localhost:6379\ngroups list : BOTTESTGROUP\ngroups_ids list : 0000000\n[Thu Oct 20 2016 08:24:25 GMT+0000 (UTC)] ERROR TypeError: Cannot use 'in' operator to search for 'data' in undefined\n  at /home/ec2-user/node_modules/hubot-yammer/src/yammer.coffee:80:6, <js>:146:23\n  at Request._callback (/home/ec2-user/node_modules/hubot-yammer/node_modules/yammer/main.js:33:43)\n  at Request.self.callback (/home/ec2-user/node_modules/hubot-yammer/node_modules/yammer/node_modules/request/request.js:121:22)\n  at emitTwo (events.js:106:13)\n  at Request.emit (events.js:191:7)\n  at Request.<anonymous> (/home/ec2-user/node_modules/hubot-yammer/node_modules/yammer/node_modules/request/request.js:978:14)\n  at emitOne (events.js:101:20)\n  at Request.emit (events.js:188:7)\n  at IncomingMessage.<anonymous> (/home/ec2-user/node_modules/hubot-yammer/node_modules/yammer/node_modules/request/request.js:929:12)\n  at emitNone (events.js:91:20)\n  at IncomingMessage.emit (events.js:185:7)\n  at endReadableNT (_stream_readable.js:974:12)\n  at _combinedTickCallback (internal/process/next_tick.js:74:11)\n  at process._tickCallback (internal/process/next_tick.js:98:9)\n\n\n \u53c2\u8003\u30ea\u30f3\u30af\n\uff08\u304a\u4e16\u8a71\u306b\u306a\u308a\u307e\u3057\u305f\uff09\nHubot / ChatOps \u3068\u306f - Qiita\nHubot \u3092 Heroku \u3067\u52d5\u304b\u3057\u3066 Slack \u304b\u3089\u8a71\u3059 - Qiita\nHubot \u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb - Qiita\nCentOS\u306bEPEL\u30ea\u30dd\u30b8\u30c8\u30ea\u3092\u8ffd\u52a0\u3059\u308b - Qiita\nCentOS 7 \u306b Node.js \u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b - Qiita\nCentOS\u306bEPEL\u30ea\u30dd\u30b8\u30c8\u30ea\u3092\u8ffd\u52a0\u3059\u308b - Qiita\nnpm WARN unmet dependency\u767a\u751f\u3057\u305f\u3089\u3002 by \u30c7\u30d3\u30c3\u30c8 \u30b8\u30e7\u30ca\u30b5\u30f3\nHubot \u3092 Amazon EC2 \u306b\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\u3057\u3001Slack \u3068\u9023\u643a\u3059\u308b\uff01 - Qiita\nyammer App \u306e Programming \u2013 Tsmatz\nWebhook\u3068\u306f\uff1f | SendGrid\u30d6\u30ed\u30b0\nWebHook\u306e\u8abf\u67fb\u3068\u5b9f\u88c5\nOffice 365 Connectors: Where\u2019s Yammer? | Turn the page\n\uff08\u4ee5\u4e0a\uff09\n# <i class=\"fa fa-map-marker\"></i> \u76ee\u7684\n![image](https://qiita-image-store.s3.amazonaws.com/0/130874/82af24ea-e8de-91f8-c12a-c4a775fc071f.png)\n\n\u3000Hubot + Heroku + Slack \u306a\u7d44\u307f\u5408\u308f\u305b\u306f\u3088\u304f\u3042\u308b\u3051\u308c\u3069\u3001\u3046\u3061\u306e\u793e\u5185\u3067\u306f\u30c1\u30e3\u30c3\u30c8\u306b Yammer \u3092\u4f7f\u7528\u3057\u3066\u3044\u308b\u306e\u3068\u3001AWS \u30a2\u30ab\u30a6\u30f3\u30c8\u304c\u3042\u308b\u306e\u3067 AWS/EC2 + Hubot + Yammer \u306e\u7d44\u307f\u5408\u308f\u305b\u3092\u8a66\u3057\u307e\u3059\u3002\n\u3000Slack \u3067\u3084\u3063\u3066\u3082\u3044\u3044\u3093\u3067\u3059\u304c\u5468\u308a\u306e\u4eba\u306b\u308f\u3056\u308f\u3056 Slack \u30a2\u30ab\u30a6\u30f3\u30c8\u4f5c\u3063\u3066\u3082\u3089\u3046\u306e\u304c\u9762\u5012\u306a\u306e\u3068\u3001\u8ab0\u3082 Yammer-Adapter \u4f7f\u3063\u3066\u306a\u3055\u305d\u3046\u306a\u306e\u3067\u4eba\u67f1\u3067\u3059\u3002\n\n\u3000Hubot-Yammer \u306e README \u3092\u8aad\u307f\u306a\u304c\u3089\u3059\u3059\u3081\u307e\u3057\u305f\u3002\n[athieriot/hubot-yammer: This is the Yammer adapter for hubot that allows you to send a message to him with Yammer and he will happily reply the same way.](https://github.com/athieriot/hubot-yammer)\n\n# <i class=\"fa fa-plane\"></i> \u7d50\u679c\n\u3000\u3067\u304d\u307e\u3057\u305f\u3002\n> ![image](https://qiita-image-store.s3.amazonaws.com/0/130874/10011a2f-1534-2fca-654d-c0e546cd88b7.png)\n\n\u3000\u793e\u5185\u3067 ChatOps \u7684\u306a\u3053\u3068\u304c\u3067\u304d\u305d\u3046\u3067\u3059\u3002\n\n\u3000Hubot \u3092\u751f\u304b\u3059\u70ba\u3060\u3051\u306b EC2 \u4f7f\u3046\u306e\u3082\u3044\u307e\u3044\u3061\u306a\u306e\u3067\u6700\u7d42\u7684\u306b\u306f\u3053\u308c\u3092 Lambda \u3067\u30b5\u30fc\u30d0\u30ec\u30b9\u306b\u3057\u3088\u3046\u3068\u601d\u3063\u3066\u3044\u305f\u306e\u3067\u3059\u304c\u3001Yammer \u306b\u306f Outgoing Webhooks \u306e\u6a5f\u80fd\u304c\u7121\u3044\u306e\u3067\u3001Yammer \u306b\u6295\u7a3f\u304c\u3042\u3063\u305f\u30bf\u30a4\u30df\u30f3\u30b0\u3067\u30a4\u30d9\u30f3\u30c8\u3092\u767a\u884c\u3057\u305f\u3044\u5834\u5408\u306f [Zapier](https://zapier.com/zapbook/yammer/) \u306a\u3069\u3067 Yammer -> Webhook \u306a\u30ec\u30b7\u30d4(zapbook)\u3092\u4f5c\u3089\u306a\u3044\u3068\u3060\u3081\u307f\u305f\u3044\u3067\u3059\u3002\n\n# <i class=\"fa fa-location-arrow\"></i> \u69cb\u7bc9\u624b\u9806\n\u3000EC2 \u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u4f5c\u6210\u3059\u308b\u306e\u3068\u3001Hubot \u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u307e\u3067\u306f\u3056\u3063\u304f\u308a\u3057\u305f\u6d41\u308c\u3060\u3051\u8a18\u8f09\u3057\u307e\u3059\u3002\n\n## \u5fc5\u8981\u306a\u3082\u306e\n\n|\u5fc5\u8981\u306a\u3082\u306e|\u4eca\u56de\u4f5c\u6210\u3057\u305f\u540d\u79f0|\u5099\u8003|\n|:--|:--|:--|\n|AWS \u306e Linux \u30a4\u30f3\u30b9\u30bf\u30f3\u30b9|-|\u7121\u6599\u67a0(t2.micro\uff09\u306eAmazon Linux \u3092\u4f5c\u6210|\n|Yammer \u5185 Public \u30b0\u30eb\u30fc\u30d7|BOTTESTGROUP|\u30c6\u30b9\u30c8\u7528\u306e\u30b0\u30eb\u30fc\u30d7\u3001\u65e5\u672c\u8a9e\u3067\u3082\u3044\u3051\u307e\u3057\u305f\u304c\u30b9\u30da\u30fc\u30b9\u5165\u308c\u308b\u3068\u3060\u3081\u3002|\n|BOT\u30a2\u30ab\u30a6\u30f3\u30c8|YAMMERBOTACCOUNT|API\u30c8\u30fc\u30af\u30f3\u3092\u53d6\u5f97\u3059\u308b\u3001\u5b9f\u969b\u306b\u306f\u4eba\u306e\u30a2\u30ab\u30a6\u30f3\u30c8\u3092\u501f\u308a\u307e\u3057\u305f\u3002|\n|\u30c6\u30b9\u30c8\u7528\u30a2\u30ab\u30a6\u30f3\u30c8|TESTYOUACCOUNT|BOT\u306b\u8a71\u3057\u304b\u3051\u308b\u7528\u3001\u81ea\u5206\u306e\u30a2\u30ab\u30a6\u30f3\u30c8\u3092\u4f7f\u3044\u307e\u3057\u305f\u3002|\n\n## AWS/EC2 \u4e0a\u306b Linux \u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u3092\u4f5c\u6210\n\u3000\u7121\u6599\u67a0\uff08t2.micro\uff09\u3067 Linux \u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u3092\u4f5c\u6210\u3001EIP \u3092\u5272\u5f53\u3066\u307e\u3057\u305f\u3002\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30b0\u30eb\u30fc\u30d7\u306f\u69cb\u7bc9\u306e\u305f\u3081\u306e SSH/MyIP \u3068\u3001Yammer API \u547c\u3073\u51fa\u3057\u306e\u305f\u3081\u306e HTTP/AnyIP \u3067\u8a31\u53ef\u304c\u5fc5\u8981\u3067\u3059\u3002\u5f8c\u8005\u306f Yammer API \u306e IP\u7bc4\u56f2\u3067\u7d5e\u3063\u3066\u3082\u826f\u3044\u3068\u304a\u3082\u3044\u307e\u3059\u3002\n\n## nodejs, npm \u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\u3000Hubot\u3001Yoneman \u306b\u5fc5\u8981\u306a node.js, npm \u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002n \u306f\u30b0\u30ed\u30fc\u30d0\u30eb\u306b\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u305f node.js \u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u7ba1\u7406\u3059\u308b\u3082\u306e\u307f\u305f\u3044\u3002\n\n```bash\n\n[ec2-user@HOST ~]$ sudo yum install nodejs npm --enablerepo=epel\n[ec2-user@HOST ~]$ npm -v\n1.3.6\n[ec2-user@HOST ~]$ sudo npm install -g n\n[ec2-user@HOST ~]$ sudo n stable\n     install : node-v6.8.1\n       mkdir : /usr/local/n/versions/node/6.8.1\n       fetch : https://nodejs.org/dist/v6.8.1/node-v6.8.1-linux-x64.tar.gz\n######################################################################## 100.0%\n   installed : v0.10.46\n[ec2-user@HOST ~]$ node -v\nv0.10.46\n```\n\n## Yeoman\u3001generator-hubot \u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\u3000Yeoman (yo) \u3068 Hubot \u306e Yeoman \u30b8\u30a7\u30cd\u30ec\u30fc\u30bf\u30fc (generator-hubot) \u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\n\n```bash\n[ec2-user@HOST ~]$ sudo npm install -g yo generator-hubot\n\uff08\u7565\uff09\n[ec2-user@HOST ~]$ sudo npm list -g generator-hubot yo\nnpm WARN unmet dependency /usr/lib/node_modules/block-stream requires inherits@'~2.0.0' but will load\nnpm WARN unmet dependency undefined,\nnpm WARN unmet dependency which is version undefined\nnpm WARN unmet dependency /usr/lib/node_modules/fstream requires inherits@'~2.0.0' but will load\nnpm WARN unmet dependency undefined,\nnpm WARN unmet dependency which is version undefined\nnpm WARN unmet dependency /usr/lib/node_modules/fstream-ignore requires inherits@'2' but will load\nnpm WARN unmet dependency undefined,\nnpm WARN unmet dependency which is version undefined\nnpm WARN unmet dependency /usr/lib/node_modules/fstream-npm requires inherits@'2' but will load\nnpm WARN unmet dependency undefined,\nnpm WARN unmet dependency which is version undefined\nnpm WARN unmet dependency /usr/lib/node_modules/glob requires inherits@'2' but will load\nnpm WARN unmet dependency undefined,\nnpm WARN unmet dependency which is version undefined\nnpm WARN unmet dependency /usr/lib/node_modules/npmconf requires inherits@'~2.0.0' but will load\nnpm WARN unmet dependency undefined,\nnpm WARN unmet dependency which is version undefined\nnpm WARN unmet dependency /usr/lib/node_modules/tar requires inherits@'2' but will load\nnpm WARN unmet dependency undefined,\nnpm WARN unmet dependency which is version undefined\n/usr/lib\n\u251c\u2500\u2500 generator-hubot@0.4.0 \n\u2514\u2500\u2500 yo@1.8.5 \n```\n\n###\uff08\u88dc\u8db3\uff09npm WARN unmet dependency \u5bfe\u5fdc\n\u3000\u4f55\u6545\u304b\u30e9\u30a4\u30d6\u30e9\u30ea inherits \u304c\u4e0d\u8db3\u3057\u3066\u3044\u308b\u3088\u3046\u306a\u306e\u3067\u3001\u8ffd\u52a0\u3067\u30b0\u30ed\u30fc\u30d0\u30eb\u306b\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u3001\u30a8\u30e9\u30fc\u304c\u51fa\u306a\u304f\u306a\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3057\u307e\u3057\u305f\u3002\n\n```bash\n[ec2-user@HOST ~]$ sudo npm install inherits -g\nnpm http GET https://registry.npmjs.org/inherits\nnpm http 304 https://registry.npmjs.org/inherits\ninherits@2.0.3 /usr/lib/node_modules/inherits\n[ec2-user@HOST ~]$  sudo npm list -g generator-hubot yo\n/usr/lib\n\u251c\u2500\u2500 generator-hubot@0.4.0 \n\u2514\u2500\u2500 yo@1.8.5\n```\n\n### Hubot \u4f5c\u6210\u3001\u521d\u671f\u8a2d\u5b9a\n\u3000\u9069\u5f53\u306a\u540d\u524d\u3067\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092\u4f5c\u6210\u3057\u3066\u3001yo hubot \u3067\u4f5c\u6210\u3002Bot adapter \u306b\u306f yammer \u3092\u6307\u5b9a\u3057\u307e\u3059\u3002\u30b3\u30f3\u30bd\u30fc\u30eb\u304c\u304b\u308f\u3044\u3044\u3002\n\n```bash\n[ec2-user@HOST ~]$ mkdir YAMMERBOT\n[ec2-user@HOST ~]$ cd YAMMERBOT\n[ec2-user@HOST YAMMERBOT]$ yo hubot\n\uff08\u7565\uff09\n? Owner MYEMAILADRESS@example.com\n? Bot name YAMMERBOT\n? Description YammerBotDesu\n? Bot adapter yammer\n   create bin/hubot\n   create bin/hubot.cmd\n\uff08\u7565\uff09\n```\n\n![image](https://qiita-image-store.s3.amazonaws.com/0/130874/05c59bad-0247-6700-e2ce-9e5fd491c4ab.png)\n\n\u3000\u4f5c\u6210\u5f8c\u306e Procfile \u306f web \u306e Yammer \u306b\u306a\u3063\u3066\u3044\u307e\u3059\u3002\n\n```bash\n[ec2-user@HOST ~]$ cat Procfile \nweb: bin/hubot -a yammer\n```\n\n### Hubot \u3092\u30ed\u30fc\u30ab\u30eb\u3067\u52d5\u4f5c\u78ba\u8a8d\n\u3000\u307e\u3060 Yammer \u306b\u306f\u63a5\u7d9a\u3057\u3066\u3044\u307e\u305b\u3093\u3002HUBOT_HEROKU_KEEPALIVE_URL \u8a2d\u5b9a\u305b\u3088\u3068 WARNING \u304c\u51fa\u3066\u3044\u307e\u3059\u304c\u4eca\u306f\u7121\u8996\u3067\u3002\n\n```bash\n[ec2-user@HOST YAMMERBOT]$ hubot\nYAMMERBOT> [Thu Oct 20 2016 02:59:28 GMT+0000 (UTC)] WARNING Loading scripts from hubot-scripts.json is deprecated and will be removed in 3.0 (https://github.com/github/hubot-scripts/issues/1113) in favor of packages for each script.\n\nYour hubot-scripts.json is empty, so you just need to remove it.\n[Thu Oct 20 2016 02:59:28 GMT+0000 (UTC)] ERROR hubot-heroku-alive included, but missing HUBOT_HEROKU_KEEPALIVE_URL. `heroku config:set HUBOT_HEROKU_KEEPALIVE_URL=$(heroku apps:info -s  | grep web-url | cut -d= -f2)`\n[Thu Oct 20 2016 02:59:28 GMT+0000 (UTC)] INFO hubot-redis-brain: Using default redis on localhost:6379\nYAMMERBOT> YAMMERBOT ping\nYAMMERBOT> PONG\nYAMMERBOT> YAMMERBOT time\nYAMMERBOT> Server time is: Thu Oct 20 2016 03:01:21 GMT+0000 (UTC)\n```\n\n## Yammer \u304b\u3089 API \u30a2\u30af\u30bb\u30b9\u30ad\u30fc\u53d6\u5f97\n\u3000API \u306e\u30a2\u30af\u30bb\u30b9\u30ad\u30fc\u30c8\u30fc\u30af\u30f3\u3092\u53d6\u5f97\u3057\u307e\u3059\u3002BOT \u30a2\u30ab\u30a6\u30f3\u30c8\u3067 Yammer \u306b\u30ed\u30b0\u30a4\u30f3\u3057\u305f\u72b6\u614b\u3067\u4e0b\u8a18 URL \u306b\u30a2\u30af\u30bb\u30b9\u3057\u307e\u3059\u3002\n\n- \u30ed\u30b0\u30a4\u30f3\u30e6\u30fc\u30b6\uff1aYAMMERBOTACCOUNT\n- https://www.yammer.com/client_applications\n- Input\n    - \u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u540d\uff1aHogeFugaApp\n    - \u7d44\u7e54\uff1aHOGE\n    - \u30b5\u30dd\u30fc\u30c8\u7528\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\uff1ahoge@example.com\n    - \u30a6\u30a7\u30d6\u30b5\u30a4\u30c8\uff1ahttps://example.com/\n    - \u30ea\u30c0\u30a4\u30ec\u30af\u30c8\u5148\u306e URI\uff1ahttps://example.com/\n\n\u3000\u4e0a\u8a18\u306e\u3088\u3046\u306b\u8d85\u9069\u5f53\u306b\u5165\u529b\u3059\u308b\u3068\u3001API \u30ad\u30fc\u3092\u53d6\u5f97\u3067\u304d\u307e\u3059\u3002\n\n- Output\n    - \u30af\u30e9\u30a4\u30a2\u30f3\u30c8ID\uff1aXxXxXxXxXxXxXxXxXxXxXx\n    - \u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u30b7\u30fc\u30af\u30ec\u30c3\u30c8\uff1aXxXxXxXxXxXxXxXxXxXxXxXxXxXxXxXxXxXxXxXxXx\n    - \u30ea\u30c0\u30a4\u30ec\u30af\u30c8\u5148\uff1ahttps://example.com/\n    - Generate a developer token for this application\n        - Here is your personal token for testing. Please copy it somewhere safe as this will disappear when you change page:\n        - 00000-XxXxXxXxXxXxXxXxXxXx\n\n\u3000\u4e00\u756a\u4e0b\u306e developer token \u3068\u3044\u3046\u306e\u3092\u4f7f\u7528\u3057\u307e\u3059\u3002\n\n## \u6295\u7a3f\u7528\u30b0\u30eb\u30fc\u30d7\u306e\u4f5c\u6210\n\u3000Yammer \u4e0a\u306b\u6295\u7a3f\u7528\u306e\u30b0\u30eb\u30fc\u30d7\u3092\u4f5c\u6210\u3001BOT \u30a2\u30ab\u30a6\u30f3\u30c8\u3068\u30c6\u30b9\u30c8\u7528\u30a2\u30ab\u30a6\u30f3\u30c8\u306e2\u3064\u3092\u30b0\u30eb\u30fc\u30d7\u306b\u8ffd\u52a0\u3057\u3066\u304a\u304d\u307e\u3059\u3002\u30b0\u30eb\u30fc\u30d7\u540d\u306f\u74b0\u5883\u5909\u6570\u306b\u8a2d\u5b9a\u3059\u308b\u306e\u3067\u3001\u82f1\u540d\u306e\u307b\u3046\u304c\u3088\u3055\u305d\u3046\u3067\u3059\u3002\n\n- \u30b0\u30eb\u30fc\u30d7\u4f5c\u6210\n    - \u30b0\u30eb\u30fc\u30d7\u540d\uff1aBOTTESTGROUP\n    - \u516c\u958b\u7bc4\u56f2\uff1aPublic\n- \u30b0\u30eb\u30fc\u30d7\u30e1\u30f3\u30d0\u8ffd\u52a0\n    - BOT \u30a2\u30ab\u30a6\u30f3\u30c8\uff1aYAMMERBOTACCOUNT\n    - \u30c6\u30b9\u30c8\u7528\u30a2\u30ab\u30a6\u30f3\u30c8\uff1aTESTYOUACCOUNT \n\n\u3000BOT \u30a2\u30ab\u30a6\u30f3\u30c8\u306e\u30a2\u30ab\u30a6\u30f3\u30c8\u540d\u306f\u5fc5\u305a\u3057\u3082 BOT \u540d\uff08YAMMERBOT\uff09\u3068\u5408\u308f\u305b\u308b\u5fc5\u8981\u306f\u3042\u308a\u307e\u305b\u3093\u3002\n\n## API \u30ad\u30fc\u8a2d\u5b9a\n\u3000\u5148\u307b\u3069\u53d6\u5f97\u3057\u305f API \u30ad\u30fc\u3068\u3001\u4f5c\u6210\u3057\u305f\u30b0\u30eb\u30fc\u30d7\u540d\u3092\u74b0\u5883\u5909\u6570\u306b\u8ffd\u52a0\u3057\u307e\u3059\u3002HUBOT_HEROKU_KEEPALIVE_URL \u306f\u4f55\u3092\u6307\u5b9a\u3059\u308c\u3070\u3044\u3044\u306e\u304b\u3088\u304f\u308f\u304b\u3089\u306a\u3044\u3051\u3069\u3001KeepAlive \u306e\u305f\u3081\u306b 5 \u5206\u3054\u3068\u306b Get \u3057\u3066\u3044\u308b\u3088\u3046\u306a\u306e\u3067\u3001401 \u304c\u5e30\u3063\u3066\u304f\u308b URL \u3092\u9069\u5f53\u306b\u6307\u5b9a\u3059\u308b\u3068\u3088\u3055\u305d\u3046\u3067\u3057\u305f\u3002Heroku \u3058\u3083\u306a\u3044\u3051\u3069\u4f7f\u3063\u3066\u308b\u307f\u305f\u3044\u3067\u3059\u3002\n\n```bash\n[ec2-user@HOST ~]$ export HUBOT_YAMMER_ACCESS_TOKEN=\"00000-XxXxXxXxXxXxXxXxXxXx\"\n[ec2-user@HOST ~]$ export HUBOT_YAMMER_GROUPS=\"BOTTESTGROUP\"\n[ec2-user@HOST ~]$ export HUBOT_HEROKU_KEEPALIVE_URL=\"https://www.yammer.com/api/v1/users.json\"\n[ec2-user@HOST ~]$ printenv\nHUBOT_YAMMER_GROUPS=BOTTESTGROUP\nHUBOT_YAMMER_ACCESS_TOKEN=00000-XxXxXxXxXxXxXxXxXxXx\nHUBOT_HEROKU_KEEPALIVE_URL=https://www.yammer.com/api/v1/users.json\n```\n\n## EC2 \u304b\u3089 Yamme API \u306b\u7e4b\u304c\u308b\u3053\u3068\u78ba\u8a8d\n\u3000\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u8a2d\u5b9a\u78ba\u8a8d\u306e\u305f\u3081\u3001\u4e00\u5fdc wget \u3057\u307e\u3059\u3002\n\n```bash\n[ec2-user@HOST ~]$ wget -O -  https://www.yammer.com/\n\uff08\u7565\uff09\n-                               100%[======================================================>]  15.97K  --.-KB/s    in 0.002s  \n\n2016-10-20 05:11:13 (10.2 MB/s) - written to stdout [16354/16354]\n```\n\n\n## BOT \u8d77\u52d5\u3068\u52d5\u4f5c\u78ba\u8a8d\n\u3000\u6e80\u3092\u6301\u3057\u3066\u8d77\u52d5\u3057\u307e\u3059\u3002groups list \u306b\u8a2d\u5b9a\u3057\u305f\u30b0\u30eb\u30fc\u30d7\u540d\u3001groups_ids list \u306b\u30b0\u30eb\u30fc\u30d7\u540d\u304b\u3089\u53d6\u5f97\u3057\u305f\u30b0\u30eb\u30fc\u30d7ID\u304c\u8868\u793a\u3055\u308c\u307e\u3059\u30025 \u5206\u6bce\u306b keepalive \u304c\u6b63\u5e38\u306b\u52d5\u3044\u305f\u30ed\u30b0\u3082\u51fa\u3066\u3044\u307e\u3059\u3002\n\n```\n[ec2-user@HOST ~]$ hubot -a yammer -n \"YAMMERBOT\"\n[Thu Oct 20 2016 05:21:16 GMT+0000 (UTC)] WARNING Loading scripts from hubot-scripts.json is deprecated and will be removed in 3.0 (https://github.com/github/hubot-scripts/issues/1113) in favor of packages for each script.\n\nYour hubot-scripts.json is empty, so you just need to remove it.\n[Thu Oct 20 2016 05:21:16 GMT+0000 (UTC)] INFO hubot-redis-brain: Using default redis on localhost:6379\ngroups list : BOTTESTGROUP\ngroups_ids list : 0000000\n[Thu Oct 20 2016 05:26:15 GMT+0000 (UTC)] INFO keepalive ping\n[Thu Oct 20 2016 05:26:16 GMT+0000 (UTC)] INFO keepalive pong: 401  \n[Thu Oct 20 2016 05:31:15 GMT+0000 (UTC)] INFO keepalive ping\n[Thu Oct 20 2016 05:31:16 GMT+0000 (UTC)] INFO keepalive pong: 401  \n```\n\n\u3000Yammer \u306e\u30c6\u30b9\u30c8\u7528\u30a2\u30ab\u30a6\u30f3\u30c8\u304b\u3089\u300cYAMMERBOT PING\u300d\u306e\u5f62\u5f0f\u3067\u30b3\u30de\u30f3\u30c9\u304c\u9001\u308c\u307e\u3057\u305f\u3002\u30b3\u30f3\u30bd\u30fc\u30eb\u5074\u306b\u3082\u30ed\u30b0\u304c\u51fa\u529b\u3055\u308c\u307e\u3059\u3002\n\n```bash\nreceived YAMMERBOT PING from TESTYOUACCOUNT (thread_id: 000000000, sender_id: 0000000)\nreply message to TESTYOUACCOUNT with text PONG\nMessage creation status 201\n```\n\n> ![image](https://qiita-image-store.s3.amazonaws.com/0/130874/10011a2f-1534-2fca-654d-c0e546cd88b7.png)\n\n# <i class=\"fa fa-pencil-square-o\"></i> \u304a\u307e\u3051\u306e\u30a8\u30e9\u30fc\u96c6\n## BOT \u30a2\u30ab\u30a6\u30f3\u30c8 \u304b\u3089\u30c6\u30b9\u30c8\u3067\u304d\u306a\u3044\u3002\n\u3000BOT \u30a2\u30ab\u30a6\u30f3\u30c8\u3067 BOT \u30a2\u30ab\u30a6\u30f3\u30c8\u306b\u8a71\u3057\u304b\u3051\u3066\u3082\u7121\u8996\u3055\u308c\u308b\u4ed5\u69d8\u3067\u3057\u305f\u3002\n\n```bash\ngroups list : BOTTESTGROUP\ngroups_ids list : 0000000\nreceived YAMMERBOT PING from YAMMERBOTACCOUNT (thread_id: 000000000, sender_id: 0000000)\nYAMMERBOT does not reply himself, YAMMERBOT not crazy nor desperate\n```\n\n## \u8a8d\u8a3c\u30a8\u30e9\u30fc\uff08Authentication failure\uff09\n\u3000HUBOT_YAMMER_ACCESS_TOKEN \u3092\u9593\u9055\u3048\u3066\u3044\u308b\u3068\u8d77\u304d\u308b\u3088\u3046\u3067\u3059\u3002Yammer \u304c\u843d\u3061\u3066\u3066\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u30a8\u30e9\u30fc\u3082\u3053\u308c\u306b\u306a\u308a\u307e\u3057\u305f\u3002\n\n```bash\n[Thu Oct 20 2016 04:06:52 GMT+0000 (UTC)] ERROR TypeError: Cannot use 'in' operator to search for 'data' in undefined\n  at /home/ec2-user/node_modules/hubot-yammer/src/yammer.coffee:80:6, <js>:146:23\n  at /home/ec2-user/node_modules/yammer/main.js:13:19\n  at Request._callback (/home/ec2-user/node_modules/yammer/main.js:132:14)\n  at Request.self.callback (/home/ec2-user/node_modules/yammer/node_modules/request/request.js:121:22)\n  at emitTwo (events.js:106:13)\n  at Request.emit (events.js:191:7)\n  at Request.<anonymous> (/home/ec2-user/node_modules/yammer/node_modules/request/request.js:978:14)\n  at emitOne (events.js:101:20)\n  at Request.emit (events.js:188:7)\n  at IncomingMessage.<anonymous> (/home/ec2-user/node_modules/yammer/node_modules/request/request.js:929:12)\n  at emitNone (events.js:91:20)\n  at IncomingMessage.emit (events.js:185:7)\n  at endReadableNT (_stream_readable.js:974:12)\n  at _combinedTickCallback (internal/process/next_tick.js:74:11)\n  at process._tickCallback (internal/process/next_tick.js:98:9)\n\nyammer groups error: Error: Error status 401\n Authentication failure.\n```\n\n\u3000Yammer \u306e\u30b9\u30c6\u30fc\u30bf\u30b9\u306f\u3053\u3061\u3089\u3001\u3088\u304f\u843d\u3061\u307e\u3059\u3002ChatOps \u3082\u305d\u3046\u3060\u3051\u3069\u30b5\u30fc\u30d3\u30b9\u30d5\u30eb\u306b\u3059\u308b\u3068 SaaS \u304c\u6b62\u307e\u308b\u3068\u696d\u52d9\u304c\u6b62\u307e\u308a\u307e\u3059\u306d\u3002\n\n- https://status.yammer.com/\n- https://twitter.com/yammerops\n\n## groups_id \u53d6\u5f97\u3067\u304d\u306a\u3044\u30a8\u30e9\u30fc\n\u300cgroups_ids list : \uff08\u30d6\u30e9\u30f3\u30af\uff09\u300d\u306b\u306a\u308b\u5834\u5408\u306f\u3001\u30b0\u30eb\u30fc\u30d7 ID \u304c\u53d6\u5f97\u3067\u304d\u3066\u3044\u307e\u305b\u3093\u3001\u30b0\u30eb\u30fc\u30d7\u304c\u5b58\u5728\u3057\u306a\u304b\u3063\u305f\u308a\u3001\u5909\u6570 HUBOT_YAMMER_GROUPS \u306e\u6307\u5b9a\u3092\u9593\u9055\u3048\u308b\u3068\u306a\u308b\u3088\u3046\u3067\u3059\u3002\u6b63\u5e38\u306b\u53d6\u5f97\u3067\u304d\u305f\u5834\u5408\u306e ID \u306f Yammer \u30b0\u30eb\u30fc\u30d7 URL \u306e feedId \u304c\u53d6\u5f97\u3055\u308c\u307e\u3059\u3002\nhttps://www.yammer.com/COMPANY.com/#/threads/inGroup?type=in_group&feedId=0000000&view=all\n\n```bash\n[Thu Oct 20 2016 04:07:24 GMT+0000 (UTC)] INFO hubot-redis-brain: Using default redis on localhost:6379\ngroups list : WRONG_GROUP_NAME\ngroups_ids list : \n[Thu Oct 20 2016 04:07:24 GMT+0000 (UTC)] ERROR Error: No group registered or an error occured to resolve IDs.\n  at /home/ec2-user/node_modules/hubot-yammer/src/yammer.coffee:146:20, <js>:225:17\n  at Request._callback (/home/ec2-user/node_modules/yammer/main.js:137:12)\n  at Request.self.callback (/home/ec2-user/node_modules/yammer/node_modules/request/request.js:121:22)\n  at emitTwo (events.js:106:13)\n  at Request.emit (events.js:191:7)\n  at Request.<anonymous> (/home/ec2-user/node_modules/yammer/node_modules/request/request.js:978:14)\n  at emitOne (events.js:101:20)\n  at Request.emit (events.js:188:7)\n  at IncomingMessage.<anonymous> (/home/ec2-user/node_modules/yammer/node_modules/request/request.js:929:12)\n  at emitNone (events.js:91:20)\n  at IncomingMessage.emit (events.js:185:7)\n  at endReadableNT (_stream_readable.js:974:12)\n  at _combinedTickCallback (internal/process/next_tick.js:74:11)\n  at process._tickCallback (internal/process/next_tick.js:98:9)\n```\n\n### Yammer \u3068\u901a\u4fe1\u3067\u304d\u306a\u3044\u3068\u304d\u306e\u30a8\u30e9\u30fc\n\u3000HTTP/Any \u3092\u8a31\u53ef\u3057\u3066\u3044\u306a\u3044\u3068\u304d\u306f\u6b21\u306e\u3088\u3046\u306a\u30a8\u30e9\u30fc\u306b\u306a\u308a\u307e\u3057\u305f\u3002\u30b0\u30eb\u30fc\u30d7 ID \u306f\u53d6\u308c\u3066\u308b\u3051\u3069\u3002\n\n```bash\n[Thu Oct 20 2016 08:24:22 GMT+0000 (UTC)] INFO hubot-redis-brain: Using default redis on localhost:6379\ngroups list : BOTTESTGROUP\ngroups_ids list : 0000000\n[Thu Oct 20 2016 08:24:25 GMT+0000 (UTC)] ERROR TypeError: Cannot use 'in' operator to search for 'data' in undefined\n  at /home/ec2-user/node_modules/hubot-yammer/src/yammer.coffee:80:6, <js>:146:23\n  at Request._callback (/home/ec2-user/node_modules/hubot-yammer/node_modules/yammer/main.js:33:43)\n  at Request.self.callback (/home/ec2-user/node_modules/hubot-yammer/node_modules/yammer/node_modules/request/request.js:121:22)\n  at emitTwo (events.js:106:13)\n  at Request.emit (events.js:191:7)\n  at Request.<anonymous> (/home/ec2-user/node_modules/hubot-yammer/node_modules/yammer/node_modules/request/request.js:978:14)\n  at emitOne (events.js:101:20)\n  at Request.emit (events.js:188:7)\n  at IncomingMessage.<anonymous> (/home/ec2-user/node_modules/hubot-yammer/node_modules/yammer/node_modules/request/request.js:929:12)\n  at emitNone (events.js:91:20)\n  at IncomingMessage.emit (events.js:185:7)\n  at endReadableNT (_stream_readable.js:974:12)\n  at _combinedTickCallback (internal/process/next_tick.js:74:11)\n  at process._tickCallback (internal/process/next_tick.js:98:9)\n```\n\n# <i class=\"fa fa-external-link\"></i> \u53c2\u8003\u30ea\u30f3\u30af\n\uff08\u304a\u4e16\u8a71\u306b\u306a\u308a\u307e\u3057\u305f\uff09\n[Hubot / ChatOps \u3068\u306f - Qiita](http://qiita.com/bouzuya/items/c7d0ad80c357aab6b696)\n[Hubot \u3092 Heroku \u3067\u52d5\u304b\u3057\u3066 Slack \u304b\u3089\u8a71\u3059 - Qiita](http://qiita.com/bouzuya/items/2a200c9e8a45e2478bc2)\n[Hubot \u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb - Qiita](http://qiita.com/bouzuya/items/11c0c6da2b3ad54b827f)\n[CentOS\u306bEPEL\u30ea\u30dd\u30b8\u30c8\u30ea\u3092\u8ffd\u52a0\u3059\u308b - Qiita](http://qiita.com/muniere/items/6c4923a070cbbd824f39)\n[CentOS 7 \u306b Node.js \u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b - Qiita](http://qiita.com/moris/items/4850d4e19392186e34f0)\n[CentOS\u306bEPEL\u30ea\u30dd\u30b8\u30c8\u30ea\u3092\u8ffd\u52a0\u3059\u308b - Qiita](http://qiita.com/muniere/items/6c4923a070cbbd824f39)\n[npm WARN unmet dependency\u767a\u751f\u3057\u305f\u3089\u3002 by \u30c7\u30d3\u30c3\u30c8 \u30b8\u30e7\u30ca\u30b5\u30f3](https://www.wantedly.com/techniques/2700)\n[Hubot \u3092 Amazon EC2 \u306b\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\u3057\u3001Slack \u3068\u9023\u643a\u3059\u308b\uff01 - Qiita](http://qiita.com/hkusu/items/3e3695450f8a4f9389b3)\n[yammer App \u306e Programming \u2013 Tsmatz](https://blogs.msdn.microsoft.com/tsmatsuz/2014/03/26/yammer-app-programming/)\n[Webhook\u3068\u306f\uff1f | SendGrid\u30d6\u30ed\u30b0](https://sendgrid.kke.co.jp/blog/?p=1851)\n[WebHook\u306e\u8abf\u67fb\u3068\u5b9f\u88c5](http://www.slideshare.net/moaikids/webhook)\n[Office 365 Connectors: Where\u2019s Yammer? | Turn the page](https://thehouseofbeck.com/2016/03/31/office-365-connectors-wheres-yammer/)\n\n\uff08\u4ee5\u4e0a\uff09\n", "tags": ["Hubot", "yammer", "AWS"]}