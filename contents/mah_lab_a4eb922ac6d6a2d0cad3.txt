{"context": "\n\n\u306f\u3058\u3081\u306b\n\u30a2\u30d7\u30ea\u3068\u8a00\u3048\u3070\u901a\u77e5\u6a5f\u80fd\u3001\u3068\u3044\u3046\u308f\u3051\u3067Firebase Cloud Messaging(FCM)\u3092\u5229\u7528\u3057\u3066iOS\u30a2\u30d7\u30ea\u306e\u901a\u77e5\u6a5f\u80fd\u3092\u4f5c\u6210\u3057\u3066\u3044\u304d\u305f\u3044\u3068\u601d\u3044\u307e\u3059\u3002iOS\u306fAPN\u3001Android\u306fGCM\u3068\u500b\u5225\u306e\u6280\u8853\u3067\u958b\u767a\u3059\u308b\u65b9\u6cd5\u3082\u3042\u308a\u307e\u3059\u304c\u3001FCM\u3092\u5229\u7528\u3059\u308c\u3070\u306a\u3093\u3068\u5171\u901a\u306e\u30b3\u30fc\u30c9\u3067\u901a\u77e5\u6a5f\u80fd\u3092\u5b9f\u73fe\u3067\u304d\u307e\u3059\u3002\n\n\u5b9f\u88c5\u306e\u30b4\u30fc\u30eb\n\u30bc\u30ed\u304b\u3089ReactNative\u306e\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092\u306f\u3058\u3081\u3066\u3001\u901a\u77e5\u30bb\u30f3\u30bf\u30fc\u306b\u901a\u77e5\u304c\u8868\u793a\u3055\u308c\u3066\u3001\u901a\u77e5\u306e\u30bf\u30c3\u30d7\u60c5\u5831\u3092\u30a2\u30d7\u30ea\u3067\u53d7\u3051\u53d6\u308c\u308b\u3068\u3053\u308d\u307e\u3067\u3092\u30b4\u30fc\u30eb\u3068\u3057\u3066\u9032\u3081\u3066\u3044\u304d\u307e\u3059\u3002\n\n\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306e\u4f5c\u6210\n\u307e\u305a\u306finit\u30b3\u30de\u30f3\u30c9\u3067\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\nreact-native init FCMNotification\n\n\nreact-native-fcm\u30d1\u30c3\u30b1\u30fc\u30b8\u306e\u8ffd\u52a0\nreact-native-fcm\u30d1\u30c3\u30b1\u30fc\u30b8\u3092\u5229\u7528\u3057\u3066\u5b9f\u88c5\u3059\u308b\u306e\u3067\u8ffd\u52a0\u3057\u307e\u3059\u3002link\u3082\u3057\u3068\u304d\u307e\u3057\u3087\u3046\u3002\nyarn add react-native-fcm\nreact-native link react-native-fcm\n\n\nXcode\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306e\u8a2d\u5b9a\u5909\u66f4\n\nCocoapods\u306e\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\n\u203b cocoapods\u304c\u306a\u3044\u5834\u5408\u306fgem install cocoapods\u3057\u3066\u304a\u304d\u307e\u3057\u3087\u3046\u3002\niOS\u306e\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u79fb\u52d5\u3057\u3066\u3001Cocoapods\u3092Xcode\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3067\u5229\u7528\u3067\u304d\u308b\u72b6\u614b\u306b\u3057\u307e\u3059\u3002\ncd ios && pod init\n\n\u7d9a\u3051\u3066\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306bPodfile\u3092\u66f8\u304d\u63db\u3048\u307e\u3059\u3002\n\nPodfile\n# Uncomment the next line to define a global platform for your project\n# platform :ios, '9.0'\n\ntarget 'FCMNotification' do\n  # Uncomment the next line if you're using Swift or would like to use dynamic frameworks\n  # NOTE: \u30b3\u30e1\u30f3\u30c8\u3092\u5916\u3059\n  use_frameworks!\n\n  # Pods for FCMNotification\n  # NOTE: Firebase/Messaging\u3092\u8ffd\u52a0\n  pod 'Firebase/Messaging'\n\n  target 'FCMNotificationTests' do\n    inherit! :search_paths\n    # Pods for testing\n  end\nend\n\n\n\nXcode\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u5185\u306e\u30b3\u30fc\u30c9\u306e\u66f8\u304d\u63db\u3048\n\u7d9a\u3044\u3066\u4ee5\u4e0b\u306e\u30b3\u30de\u30f3\u30c9\u3067Xcode\u3092\u958b\u304d\u3001\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u5185\u306e\u30d5\u30a1\u30a4\u30eb\u3092\u66f8\u304d\u63db\u3048\u307e\u3059\u3002\nopen FCMNotification.xcworkspace\n\n\u203b pod init\u306b\u3088\u3063\u3066\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u540d.xcworkspace\u3068\u3044\u3046\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u30d5\u30a1\u30a4\u30eb\u304c\u751f\u6210\u3055\u308c\u307e\u3059\u3002\u9593\u9055\u3048\u3066.xcodeproj\u306e\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u30d5\u30a1\u30a4\u30eb\u3092\u958b\u304b\u306a\u3044\u3088\u3046\u306b\u6ce8\u610f\u3002\nAppDelegate.h\u3092\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u66f8\u304d\u63db\u3048\u307e\u3059\u3002\n\nAppDelegate.h\n#import <UIKit/UIKit.h>\n\n@import UserNotifications;\n\n@interface AppDelegate : UIResponder <UIApplicationDelegate, UNUserNotificationCenterDelegate>\n\n@property (nonatomic, strong) UIWindow *window;\n\n@end\n\n\n\u7d9a\u3051\u3066AppDelegate.m\u3092\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u66f8\u304d\u63db\u3048\u307e\u3059\u3002\n\nAppDelegate.m\n#import \"AppDelegate.h\"\n\n#import \"RCTBundleURLProvider.h\"\n#import \"RCTRootView.h\"\n\n#import \"RNFIRMessaging.h\"\n\n@implementation AppDelegate\n\n- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions\n{\n  NSURL *jsCodeLocation;\n\n  jsCodeLocation = [[RCTBundleURLProvider sharedSettings] jsBundleURLForBundleRoot:@\"index.ios\" fallbackResource:nil];\n\n  RCTRootView *rootView = [[RCTRootView alloc] initWithBundleURL:jsCodeLocation\n                                                      moduleName:@\"FCMNotification\"\n                                               initialProperties:nil\n                                                   launchOptions:launchOptions];\n  rootView.backgroundColor = [[UIColor alloc] initWithRed:1.0f green:1.0f blue:1.0f alpha:1];\n\n  self.window = [[UIWindow alloc] initWithFrame:[UIScreen mainScreen].bounds];\n  UIViewController *rootViewController = [UIViewController new];\n  rootViewController.view = rootView;\n  self.window.rootViewController = rootViewController;\n  [self.window makeKeyAndVisible];\n\n  [FIRApp configure];\n  [[UNUserNotificationCenter currentNotificationCenter] setDelegate:self];\n\n  return YES;\n}\n\n- (void)userNotificationCenter:(UNUserNotificationCenter *)center willPresentNotification:(UNNotification *)notification withCompletionHandler:(void (^)(UNNotificationPresentationOptions))completionHandler\n{\n  [[NSNotificationCenter defaultCenter] postNotificationName:FCMNotificationReceived object:self userInfo:notification.request.content.userInfo];\n  if([[notification.request.content.userInfo valueForKey:@\"show_in_foreground\"] isEqual:@YES]){\n    completionHandler(UNNotificationPresentationOptionAlert | UNNotificationPresentationOptionBadge | UNNotificationPresentationOptionSound);\n  }else{\n    completionHandler(UNNotificationPresentationOptionNone);\n  }\n\n}\n\n- (void)userNotificationCenter:(UNUserNotificationCenter *)center didReceiveNotificationResponse:(UNNotificationResponse *)response withCompletionHandler:(void (^)())completionHandler\n{\n  NSDictionary* userInfo = [[NSMutableDictionary alloc] initWithDictionary: response.notification.request.content.userInfo];\n  [userInfo setValue:@YES forKey:@\"opened_from_tray\"];\n  [[NSNotificationCenter defaultCenter] postNotificationName:FCMNotificationReceived object:self userInfo:userInfo];\n}\n\n//You can skip this method if you don't want to use local notification\n-(void)application:(UIApplication *)application didReceiveLocalNotification:(UILocalNotification *)notification {\n  [[NSNotificationCenter defaultCenter] postNotificationName:FCMNotificationReceived object:self userInfo:notification.userInfo];\n}\n\n- (void)application:(UIApplication *)application didReceiveRemoteNotification:(nonnull NSDictionary *)userInfo fetchCompletionHandler:(nonnull void (^)(UIBackgroundFetchResult))completionHandler{\n  [[NSNotificationCenter defaultCenter] postNotificationName:FCMNotificationReceived object:self userInfo:userInfo];\n  completionHandler(UIBackgroundFetchResultNoData);\n}\n\n@end\n\n\n\n\u30a2\u30d7\u30ea\u306e\u901a\u77e5\u6a5f\u80fd\u3092\u6709\u52b9\u306b\u3059\u308b\n\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306e\u8a2d\u5b9a\u304b\u3089\u901a\u77e5\u95a2\u9023\u306e\u6a5f\u80fd\u3092\u6709\u52b9\u306b\u3057\u3066\u304a\u304d\u307e\u3059\u3002\u3053\u308c\u3092\u5fd8\u308c\u308b\u3068\u901a\u77e5\u304c\u5c4a\u304b\u306a\u3044\u306e\u3067\u6ce8\u610f\uff01\n\n\nFirebase\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306e\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\n\u7d9a\u3044\u3066\u3001Firebase\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092\u4f5c\u6210\u3057\u3066\u3001Firebase\u304b\u3089\u901a\u77e5\u3092\u914d\u4fe1\u3067\u304d\u308b\u3088\u3046\u306b\u3057\u307e\u3059\u3002\n\nFirebase\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092\u65b0\u898f\u306b\u4f5c\u6210\u3059\u308b\n\nFirebase\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306biOS\u30a2\u30d7\u30ea\u3092\u8ffd\u52a0\u3057\u3001GoogleService-Info.plist\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3057\u307e\u3059\u3002\n\n\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3057\u305fGoogleService-Info.plist\u3092Xcode\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306b\u8ffd\u52a0\u3057\u3001Copy Bundle Resources\u306b\u8ffd\u52a0\u3057\u307e\u3059\u3002\n\n\u66f4\u306b\u3001Firebase\u304b\u3089APN\u306b\u9023\u643a\u3059\u308b\u305f\u3081\u306b\u3001APNs\u8a3c\u660e\u66f8\u3092\u8a2d\u5b9a\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n\n\u203b APNs\u8a3c\u660e\u66f8\u3092\u4f5c\u6210\u3059\u308b\u969b\u306ffastlane\u306epem\u3092\u5229\u7528\u3059\u308b\u3068\u4fbf\u5229\u3067\u3059\uff08\u53c2\u8003\uff1afastlane \u306e pem \u3092\u4f7f\u3063\u3066\u4e00\u77ac\u3067 iOS \u7528\u306e Push \u901a\u77e5 (Apple Push Notification Service) \u306e\u8a3c\u660e\u66f8\u3092\u4f5c\u308b\uff09\n\nReactNative\u5074\u306e\u30b3\u30fc\u30c9\u3092\u66f8\u304f\n\u901a\u77e5\u7cfb\u306e\u51e6\u7406\u306fNotification\u3068\u3044\u3046\u30b3\u30f3\u30dd\u30fc\u30cd\u30f3\u30c8\u306b\u5207\u308a\u5206\u3051\u3066\u3044\u307e\u3059\u3002\n\nindex.ios.js\nimport React from 'react';\nimport { AppRegistry } from 'react-native';\nimport Root from './src/Root';\n\nconst FCMNotification = () => <Root />;\nAppRegistry.registerComponent('FCMNotification', () => FCMNotification);\n\n\n\nsrc/Root.js\nimport React, { Component } from 'react';\nimport {\n  View,\n  Text,\n  StyleSheet,\n} from 'react-native';\nimport Notification from './Notification'\n\nexport default class Root extends Component {\n  render() {\n    return (\n      <View style={styles.container}>\n        <Notification />\n        <Text>Notification Test</Text>\n      </View>\n    );\n  }\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    justifyContent: 'center',\n    alignItems: 'center'\n  },\n});\n\n\n\nsrc/Notification.js\nimport React, { Component } from 'react';\nimport { View } from 'react-native';\nimport FCM from 'react-native-fcm';\n\nexport default class Notification extends Component {\n  componentDidMount() {\n    FCM.requestPermissions(); // for iOS\n    FCM.getFCMToken().then(token => console.log(`[TOKEN] ${token}`));\n    // \u901a\u77e5\u30bf\u30c3\u30d7\u6642\u306e\u51e6\u7406\u3092\u66f8\u304f\n    this.notificationUnsubscribe = FCM.on('notification', notif => console.log(notif));\n    // \u30c8\u30fc\u30af\u30f3\u304c\u30ea\u30d5\u30ec\u30c3\u30b7\u30e5\u3055\u308c\u305f\u3068\u304d\u306e\u51e6\u7406\u3092\u66f8\u304f\n    this.refreshUnsubscribe = FCM.on('refreshToken', token => console.log(`[TOKEN] ${token}`));\n  }\n\n  componentWillUnmount() {\n    this.notificationUnsubscribe();\n    this.refreshUnsubscribe();\n  }\n\n  render() {\n    return (<View />);\n  }\n}\n\n\nFCM\u304b\u3089\u306e\u30a4\u30d9\u30f3\u30c8\u306fFCM.on\u3067\u53d7\u3051\u53d6\u3063\u3066\u51e6\u7406\u3057\u307e\u3059\u3002\u4eca\u56de\u306f\u53d7\u3051\u53d6\u3063\u305f\u60c5\u5831\u3092\u305d\u306e\u307e\u307e\u30ed\u30b0\u3068\u3057\u3066\u8868\u793a\u3059\u308b\u3088\u3046\u306b\u3057\u3066\u3044\u307e\u3059\u3002\n\n\u901a\u77e5\u306e\u30c6\u30b9\u30c8\n\n\u30a2\u30d7\u30ea\u304c\u8d77\u52d5\u3059\u308b\u304b\u78ba\u8a8d\n\u3053\u3053\u307e\u3067\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\u3092\u7d42\u3048\u308b\u3068\u3001\u3053\u3093\u306a\u30a2\u30d7\u30ea\u304c\u7acb\u3061\u4e0a\u304c\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3059\uff08\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8\u306f\u30b7\u30df\u30e5\u30ec\u30fc\u30bf\u3067\u7acb\u3061\u4e0a\u3052\u305f\u3082\u306e\u3067\u3059\uff09\u3002\n\n\nFirebase\u30b3\u30f3\u30bd\u30fc\u30eb\u304b\u3089\u901a\u77e5\u306e\u30c6\u30b9\u30c8\n\u3055\u3066\u3001\u3053\u3053\u304b\u3089\u65e9\u901f\u901a\u77e5\u6a5f\u80fd\u304c\u52d5\u3044\u3066\u3044\u308b\u304b\u3069\u3046\u304b\u30c6\u30b9\u30c8\u3057\u3066\u3044\u304d\u305f\u3044\u3068\u601d\u3044\u307e\u3059\uff01\nFirebase\u30b3\u30f3\u30bd\u30fc\u30eb\u304b\u3089\u624b\u52d5\u3067\u901a\u77e5\u3092\u9001\u4fe1\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u308b\u306e\u3067\u3001\u307e\u305a\u306f\u901a\u77e5\u5148\u30a2\u30d7\u30ea\u306e\u30c8\u30fc\u30af\u30f3\u3092\u53d6\u5f97\u3057\u307e\u3059\u3002\n\u30c8\u30fc\u30af\u30f3\u3092\u53d6\u5f97\u3059\u308b\u305f\u3081\u306b\u306f\u5b9f\u6a5f\u3067\u30a2\u30d7\u30ea\u3092\u7acb\u3061\u4e0a\u3052\u308b\u5fc5\u8981\u304c\u3042\u308b\u306e\u3067\u3001\u5b9f\u6a5f\u3067\u30a2\u30d7\u30ea\u3092\u7acb\u3061\u4e0a\u3052\u307e\u3059\u3002\u3059\u308b\u3068\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u30c8\u30fc\u30af\u30f3\u306e\u53d6\u5f97\u30ed\u30b0\u304c\u8868\u793a\u3055\u308c\u307e\u3059\u3002\n\n\u3053\u3061\u3089\u306e\u30c8\u30fc\u30af\u30f3\u3092\u30b3\u30d4\u3063\u3066\u3001Firebase\u30b3\u30f3\u30bd\u30fc\u30eb\u304b\u3089\u901a\u77e5\u3092\u9001\u4fe1\u3057\u307e\u3059\u3002\n\n\u3059\u308b\u3068\u5b9f\u6a5f\u306b\u901a\u77e5\u304c\u5c4a\u304d\u307e\u3059\u3002\n\n\u300c\u30c6\u30b9\u30c82\u300d\u306e\u901a\u77e5\u3092\u30bf\u30c3\u30d7\u3059\u308b\u3068\u3001Xcode\u306e\u30ed\u30b0\u306b\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u60c5\u5831\u304c\u8868\u793a\u3055\u308c\u307e\u3059\u3002\n\n{'gcm.notification.sound2': 'default',\n  'google.c.a.e': '1',\n  'google.c.a.c_l': 'test2',\n  aps: { badge: 1, alert: '\u30c6\u30b9\u30c82', sound: 'default' },\n  opened_from_tray: true,\n  'gcm.n.e': '1',\n  'google.c.a.c_id': '1543238649561071055',\n  'google.c.a.udt': '0',\n  'gcm.message_id': '0:1481601928852855%c218bf06c218bf06',\n  'google.c.a.ts': '1481601928' }\n\nFCM.on('notification')\u30a4\u30d9\u30f3\u30c8\u306e\u5f15\u6570\u3068\u3057\u3066\u4e0a\u8a18\u306e\u60c5\u5831\u304c\u6e21\u3055\u308c\u308b\u306e\u3067\u3001\u3053\u306e\u60c5\u5831\u3092\u5143\u306b\u30a2\u30d7\u30ea\u5185\u306e\u7279\u5b9a\u306e\u5834\u6240\u306b\u9077\u79fb\u3057\u305f\u308a\u3001\u3068\u3044\u3063\u305f\u51e6\u7406\u3092\u66f8\u3044\u3066\u3044\u304d\u307e\u3059\u3002\n\u3053\u308c\u3067\u901a\u77e5\u3092\u52d5\u304b\u3059\u3053\u3068\u304c\u3067\u304d\u307e\u3057\u305f\uff01\u304a\u75b2\u308c\u69d8\u3067\u3057\u305f\uff01\n\u7d9a\u3051\u3066\u6b21\u306e\u8a18\u4e8b\u3067Android\u7de8\u3082\u66f8\u3053\u3046\u3068\u601d\u3044\u307e\u3059\u3002\n# \u306f\u3058\u3081\u306b\n\n\u30a2\u30d7\u30ea\u3068\u8a00\u3048\u3070\u901a\u77e5\u6a5f\u80fd\u3001\u3068\u3044\u3046\u308f\u3051\u3067Firebase Cloud Messaging(FCM)\u3092\u5229\u7528\u3057\u3066iOS\u30a2\u30d7\u30ea\u306e\u901a\u77e5\u6a5f\u80fd\u3092\u4f5c\u6210\u3057\u3066\u3044\u304d\u305f\u3044\u3068\u601d\u3044\u307e\u3059\u3002iOS\u306fAPN\u3001Android\u306fGCM\u3068\u500b\u5225\u306e\u6280\u8853\u3067\u958b\u767a\u3059\u308b\u65b9\u6cd5\u3082\u3042\u308a\u307e\u3059\u304c\u3001FCM\u3092\u5229\u7528\u3059\u308c\u3070\u306a\u3093\u3068\u5171\u901a\u306e\u30b3\u30fc\u30c9\u3067\u901a\u77e5\u6a5f\u80fd\u3092\u5b9f\u73fe\u3067\u304d\u307e\u3059\u3002\n\n\n# \u5b9f\u88c5\u306e\u30b4\u30fc\u30eb\n\n\u30bc\u30ed\u304b\u3089ReactNative\u306e\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092\u306f\u3058\u3081\u3066\u3001\u901a\u77e5\u30bb\u30f3\u30bf\u30fc\u306b\u901a\u77e5\u304c\u8868\u793a\u3055\u308c\u3066\u3001\u901a\u77e5\u306e\u30bf\u30c3\u30d7\u60c5\u5831\u3092\u30a2\u30d7\u30ea\u3067\u53d7\u3051\u53d6\u308c\u308b\u3068\u3053\u308d\u307e\u3067\u3092\u30b4\u30fc\u30eb\u3068\u3057\u3066\u9032\u3081\u3066\u3044\u304d\u307e\u3059\u3002\n\n# \u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306e\u4f5c\u6210\n\n\u307e\u305a\u306finit\u30b3\u30de\u30f3\u30c9\u3067\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\n```\nreact-native init FCMNotification\n```\n\n## react-native-fcm\u30d1\u30c3\u30b1\u30fc\u30b8\u306e\u8ffd\u52a0\n\n[react-native-fcm](https://github.com/evollu/react-native-fcm)\u30d1\u30c3\u30b1\u30fc\u30b8\u3092\u5229\u7528\u3057\u3066\u5b9f\u88c5\u3059\u308b\u306e\u3067\u8ffd\u52a0\u3057\u307e\u3059\u3002link\u3082\u3057\u3068\u304d\u307e\u3057\u3087\u3046\u3002\n\n```\nyarn add react-native-fcm\nreact-native link react-native-fcm\n```\n\n# Xcode\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306e\u8a2d\u5b9a\u5909\u66f4\n\n## Cocoapods\u306e\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\n\n\u203b cocoapods\u304c\u306a\u3044\u5834\u5408\u306f`gem install cocoapods`\u3057\u3066\u304a\u304d\u307e\u3057\u3087\u3046\u3002\n\niOS\u306e\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u79fb\u52d5\u3057\u3066\u3001Cocoapods\u3092Xcode\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3067\u5229\u7528\u3067\u304d\u308b\u72b6\u614b\u306b\u3057\u307e\u3059\u3002\n\n```\ncd ios && pod init\n```\n\n\u7d9a\u3051\u3066\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306bPodfile\u3092\u66f8\u304d\u63db\u3048\u307e\u3059\u3002\n\n```ruby:Podfile\n# Uncomment the next line to define a global platform for your project\n# platform :ios, '9.0'\n\ntarget 'FCMNotification' do\n  # Uncomment the next line if you're using Swift or would like to use dynamic frameworks\n  # NOTE: \u30b3\u30e1\u30f3\u30c8\u3092\u5916\u3059\n  use_frameworks!\n\n  # Pods for FCMNotification\n  # NOTE: Firebase/Messaging\u3092\u8ffd\u52a0\n  pod 'Firebase/Messaging'\n\n  target 'FCMNotificationTests' do\n    inherit! :search_paths\n    # Pods for testing\n  end\nend\n```\n\n## Xcode\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u5185\u306e\u30b3\u30fc\u30c9\u306e\u66f8\u304d\u63db\u3048\n\n\u7d9a\u3044\u3066\u4ee5\u4e0b\u306e\u30b3\u30de\u30f3\u30c9\u3067Xcode\u3092\u958b\u304d\u3001\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u5185\u306e\u30d5\u30a1\u30a4\u30eb\u3092\u66f8\u304d\u63db\u3048\u307e\u3059\u3002\n\n```\nopen FCMNotification.xcworkspace\n```\n\n\u203b `pod init`\u306b\u3088\u3063\u3066`\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u540d.xcworkspace`\u3068\u3044\u3046\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u30d5\u30a1\u30a4\u30eb\u304c\u751f\u6210\u3055\u308c\u307e\u3059\u3002\u9593\u9055\u3048\u3066`.xcodeproj`\u306e\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u30d5\u30a1\u30a4\u30eb\u3092\u958b\u304b\u306a\u3044\u3088\u3046\u306b\u6ce8\u610f\u3002\n\nAppDelegate.h\u3092\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u66f8\u304d\u63db\u3048\u307e\u3059\u3002\n\n```objectivec:AppDelegate.h\n#import <UIKit/UIKit.h>\n\n@import UserNotifications;\n\n@interface AppDelegate : UIResponder <UIApplicationDelegate, UNUserNotificationCenterDelegate>\n\n@property (nonatomic, strong) UIWindow *window;\n\n@end\n```\n\n\u7d9a\u3051\u3066AppDelegate.m\u3092\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u66f8\u304d\u63db\u3048\u307e\u3059\u3002\n\n```objectivec:AppDelegate.m\n#import \"AppDelegate.h\"\n\n#import \"RCTBundleURLProvider.h\"\n#import \"RCTRootView.h\"\n\n#import \"RNFIRMessaging.h\"\n\n@implementation AppDelegate\n\n- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions\n{\n  NSURL *jsCodeLocation;\n\n  jsCodeLocation = [[RCTBundleURLProvider sharedSettings] jsBundleURLForBundleRoot:@\"index.ios\" fallbackResource:nil];\n\n  RCTRootView *rootView = [[RCTRootView alloc] initWithBundleURL:jsCodeLocation\n                                                      moduleName:@\"FCMNotification\"\n                                               initialProperties:nil\n                                                   launchOptions:launchOptions];\n  rootView.backgroundColor = [[UIColor alloc] initWithRed:1.0f green:1.0f blue:1.0f alpha:1];\n\n  self.window = [[UIWindow alloc] initWithFrame:[UIScreen mainScreen].bounds];\n  UIViewController *rootViewController = [UIViewController new];\n  rootViewController.view = rootView;\n  self.window.rootViewController = rootViewController;\n  [self.window makeKeyAndVisible];\n  \n  [FIRApp configure];\n  [[UNUserNotificationCenter currentNotificationCenter] setDelegate:self];\n  \n  return YES;\n}\n\n- (void)userNotificationCenter:(UNUserNotificationCenter *)center willPresentNotification:(UNNotification *)notification withCompletionHandler:(void (^)(UNNotificationPresentationOptions))completionHandler\n{\n  [[NSNotificationCenter defaultCenter] postNotificationName:FCMNotificationReceived object:self userInfo:notification.request.content.userInfo];\n  if([[notification.request.content.userInfo valueForKey:@\"show_in_foreground\"] isEqual:@YES]){\n    completionHandler(UNNotificationPresentationOptionAlert | UNNotificationPresentationOptionBadge | UNNotificationPresentationOptionSound);\n  }else{\n    completionHandler(UNNotificationPresentationOptionNone);\n  }\n  \n}\n\n- (void)userNotificationCenter:(UNUserNotificationCenter *)center didReceiveNotificationResponse:(UNNotificationResponse *)response withCompletionHandler:(void (^)())completionHandler\n{\n  NSDictionary* userInfo = [[NSMutableDictionary alloc] initWithDictionary: response.notification.request.content.userInfo];\n  [userInfo setValue:@YES forKey:@\"opened_from_tray\"];\n  [[NSNotificationCenter defaultCenter] postNotificationName:FCMNotificationReceived object:self userInfo:userInfo];\n}\n\n//You can skip this method if you don't want to use local notification\n-(void)application:(UIApplication *)application didReceiveLocalNotification:(UILocalNotification *)notification {\n  [[NSNotificationCenter defaultCenter] postNotificationName:FCMNotificationReceived object:self userInfo:notification.userInfo];\n}\n\n- (void)application:(UIApplication *)application didReceiveRemoteNotification:(nonnull NSDictionary *)userInfo fetchCompletionHandler:(nonnull void (^)(UIBackgroundFetchResult))completionHandler{\n  [[NSNotificationCenter defaultCenter] postNotificationName:FCMNotificationReceived object:self userInfo:userInfo];\n  completionHandler(UIBackgroundFetchResultNoData);\n}\n\n@end\n```\n\n## \u30a2\u30d7\u30ea\u306e\u901a\u77e5\u6a5f\u80fd\u3092\u6709\u52b9\u306b\u3059\u308b\n\n\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306e\u8a2d\u5b9a\u304b\u3089\u901a\u77e5\u95a2\u9023\u306e\u6a5f\u80fd\u3092\u6709\u52b9\u306b\u3057\u3066\u304a\u304d\u307e\u3059\u3002\u3053\u308c\u3092\u5fd8\u308c\u308b\u3068\u901a\u77e5\u304c\u5c4a\u304b\u306a\u3044\u306e\u3067\u6ce8\u610f\uff01\n\n![FCMNotification_xcodeproj.png](https://qiita-image-store.s3.amazonaws.com/0/5877/b207d465-699d-519e-e285-c2d2822c8c52.png \"FCMNotification_xcodeproj.png\")\n\n# Firebase\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306e\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\n\n\u7d9a\u3044\u3066\u3001Firebase\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092\u4f5c\u6210\u3057\u3066\u3001Firebase\u304b\u3089\u901a\u77e5\u3092\u914d\u4fe1\u3067\u304d\u308b\u3088\u3046\u306b\u3057\u307e\u3059\u3002\n\n## Firebase\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092\u65b0\u898f\u306b\u4f5c\u6210\u3059\u308b\n\n![Firebase_Console.png](https://qiita-image-store.s3.amazonaws.com/0/5877/516523c6-ce3d-a34b-0592-44692949eb94.png \"Firebase_Console.png\")\n\nFirebase\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306biOS\u30a2\u30d7\u30ea\u3092\u8ffd\u52a0\u3057\u3001`GoogleService-Info.plist`\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3057\u307e\u3059\u3002\n\n![Firebase_Console.png](https://qiita-image-store.s3.amazonaws.com/0/5877/ace3bf0a-6a14-6c4d-5a4c-5a0d9c999b49.png \"Firebase_Console.png\")\n\n\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3057\u305f`GoogleService-Info.plist`\u3092Xcode\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306b\u8ffd\u52a0\u3057\u3001Copy Bundle Resources\u306b\u8ffd\u52a0\u3057\u307e\u3059\u3002\n\n![FCMNotification_xcodeproj.png](https://qiita-image-store.s3.amazonaws.com/0/5877/b764247e-dcf0-c1f2-3b8a-25d39635fdea.png \"FCMNotification_xcodeproj.png\")\n\n\n\u66f4\u306b\u3001Firebase\u304b\u3089APN\u306b\u9023\u643a\u3059\u308b\u305f\u3081\u306b\u3001APNs\u8a3c\u660e\u66f8\u3092\u8a2d\u5b9a\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n\n![Firebase_Console.png](https://qiita-image-store.s3.amazonaws.com/0/5877/359905fa-7c4f-3658-7bcd-4b2708baf3a0.png \"Firebase_Console.png\")\n\n\u203b APNs\u8a3c\u660e\u66f8\u3092\u4f5c\u6210\u3059\u308b\u969b\u306ffastlane\u306epem\u3092\u5229\u7528\u3059\u308b\u3068\u4fbf\u5229\u3067\u3059\uff08\u53c2\u8003\uff1a[fastlane \u306e pem \u3092\u4f7f\u3063\u3066\u4e00\u77ac\u3067 iOS \u7528\u306e Push \u901a\u77e5 (Apple Push Notification Service) \u306e\u8a3c\u660e\u66f8\u3092\u4f5c\u308b](http://qiita.com/mironal/items/7fab4bf3bf2243a5fc90)\uff09\n\n# ReactNative\u5074\u306e\u30b3\u30fc\u30c9\u3092\u66f8\u304f\n\n\u901a\u77e5\u7cfb\u306e\u51e6\u7406\u306fNotification\u3068\u3044\u3046\u30b3\u30f3\u30dd\u30fc\u30cd\u30f3\u30c8\u306b\u5207\u308a\u5206\u3051\u3066\u3044\u307e\u3059\u3002\n\n```js:index.ios.js\nimport React from 'react';\nimport { AppRegistry } from 'react-native';\nimport Root from './src/Root';\n\nconst FCMNotification = () => <Root />;\nAppRegistry.registerComponent('FCMNotification', () => FCMNotification);\n```\n\n```js:src/Root.js\nimport React, { Component } from 'react';\nimport {\n  View,\n  Text,\n  StyleSheet,\n} from 'react-native';\nimport Notification from './Notification'\n\nexport default class Root extends Component {\n  render() {\n    return (\n      <View style={styles.container}>\n        <Notification />\n        <Text>Notification Test</Text>\n      </View>\n    );\n  }\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    justifyContent: 'center',\n    alignItems: 'center'\n  },\n});\n```\n\n```js:src/Notification.js\nimport React, { Component } from 'react';\nimport { View } from 'react-native';\nimport FCM from 'react-native-fcm';\n\nexport default class Notification extends Component {\n  componentDidMount() {\n    FCM.requestPermissions(); // for iOS\n    FCM.getFCMToken().then(token => console.log(`[TOKEN] ${token}`));\n    // \u901a\u77e5\u30bf\u30c3\u30d7\u6642\u306e\u51e6\u7406\u3092\u66f8\u304f\n    this.notificationUnsubscribe = FCM.on('notification', notif => console.log(notif));\n    // \u30c8\u30fc\u30af\u30f3\u304c\u30ea\u30d5\u30ec\u30c3\u30b7\u30e5\u3055\u308c\u305f\u3068\u304d\u306e\u51e6\u7406\u3092\u66f8\u304f\n    this.refreshUnsubscribe = FCM.on('refreshToken', token => console.log(`[TOKEN] ${token}`));\n  }\n\n  componentWillUnmount() {\n    this.notificationUnsubscribe();\n    this.refreshUnsubscribe();\n  }\n\n  render() {\n    return (<View />);\n  }\n}\n```\n\nFCM\u304b\u3089\u306e\u30a4\u30d9\u30f3\u30c8\u306f`FCM.on`\u3067\u53d7\u3051\u53d6\u3063\u3066\u51e6\u7406\u3057\u307e\u3059\u3002\u4eca\u56de\u306f\u53d7\u3051\u53d6\u3063\u305f\u60c5\u5831\u3092\u305d\u306e\u307e\u307e\u30ed\u30b0\u3068\u3057\u3066\u8868\u793a\u3059\u308b\u3088\u3046\u306b\u3057\u3066\u3044\u307e\u3059\u3002\n\n# \u901a\u77e5\u306e\u30c6\u30b9\u30c8\n\n## \u30a2\u30d7\u30ea\u304c\u8d77\u52d5\u3059\u308b\u304b\u78ba\u8a8d\n\n\u3053\u3053\u307e\u3067\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\u3092\u7d42\u3048\u308b\u3068\u3001\u3053\u3093\u306a\u30a2\u30d7\u30ea\u304c\u7acb\u3061\u4e0a\u304c\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3059\uff08\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8\u306f\u30b7\u30df\u30e5\u30ec\u30fc\u30bf\u3067\u7acb\u3061\u4e0a\u3052\u305f\u3082\u306e\u3067\u3059\uff09\u3002\n\n![Glass.png](https://qiita-image-store.s3.amazonaws.com/0/5877/2817ba48-04cf-4ad2-058e-810b1cb5112b.png \"Glass.png\")\n\n\n## Firebase\u30b3\u30f3\u30bd\u30fc\u30eb\u304b\u3089\u901a\u77e5\u306e\u30c6\u30b9\u30c8\n\n\u3055\u3066\u3001\u3053\u3053\u304b\u3089\u65e9\u901f\u901a\u77e5\u6a5f\u80fd\u304c\u52d5\u3044\u3066\u3044\u308b\u304b\u3069\u3046\u304b\u30c6\u30b9\u30c8\u3057\u3066\u3044\u304d\u305f\u3044\u3068\u601d\u3044\u307e\u3059\uff01\n\nFirebase\u30b3\u30f3\u30bd\u30fc\u30eb\u304b\u3089\u624b\u52d5\u3067\u901a\u77e5\u3092\u9001\u4fe1\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u308b\u306e\u3067\u3001\u307e\u305a\u306f\u901a\u77e5\u5148\u30a2\u30d7\u30ea\u306e\u30c8\u30fc\u30af\u30f3\u3092\u53d6\u5f97\u3057\u307e\u3059\u3002\n\n\u30c8\u30fc\u30af\u30f3\u3092\u53d6\u5f97\u3059\u308b\u305f\u3081\u306b\u306f\u5b9f\u6a5f\u3067\u30a2\u30d7\u30ea\u3092\u7acb\u3061\u4e0a\u3052\u308b\u5fc5\u8981\u304c\u3042\u308b\u306e\u3067\u3001\u5b9f\u6a5f\u3067\u30a2\u30d7\u30ea\u3092\u7acb\u3061\u4e0a\u3052\u307e\u3059\u3002\u3059\u308b\u3068\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u30c8\u30fc\u30af\u30f3\u306e\u53d6\u5f97\u30ed\u30b0\u304c\u8868\u793a\u3055\u308c\u307e\u3059\u3002\n\n![AppDelegate_m.png](https://qiita-image-store.s3.amazonaws.com/0/5877/7067b5a6-a40d-f135-e2fd-72b29004aecd.png \"AppDelegate_m.png\")\n\n\u3053\u3061\u3089\u306e\u30c8\u30fc\u30af\u30f3\u3092\u30b3\u30d4\u3063\u3066\u3001Firebase\u30b3\u30f3\u30bd\u30fc\u30eb\u304b\u3089\u901a\u77e5\u3092\u9001\u4fe1\u3057\u307e\u3059\u3002\n\n![Firebase_Console.png](https://qiita-image-store.s3.amazonaws.com/0/5877/1a2e3b6e-f97a-cf07-cdd7-d2e0d78f69da.png \"Firebase_Console.png\")\n\n\u3059\u308b\u3068\u5b9f\u6a5f\u306b\u901a\u77e5\u304c\u5c4a\u304d\u307e\u3059\u3002\n\n![\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8_2016_12_13_13_10.png](https://qiita-image-store.s3.amazonaws.com/0/5877/706fc84d-9047-d1f2-5606-8d1472266057.png \"\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8_2016_12_13_13_10.png\")\n\n\u300c\u30c6\u30b9\u30c82\u300d\u306e\u901a\u77e5\u3092\u30bf\u30c3\u30d7\u3059\u308b\u3068\u3001Xcode\u306e\u30ed\u30b0\u306b\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u60c5\u5831\u304c\u8868\u793a\u3055\u308c\u307e\u3059\u3002\n\n![FCMNotification_xcodeproj.png](https://qiita-image-store.s3.amazonaws.com/0/5877/ca3b63fd-7a65-ba68-56b9-ef5c6223cad3.png \"FCMNotification_xcodeproj.png\")\n\n```json\n{'gcm.notification.sound2': 'default',\n  'google.c.a.e': '1',\n  'google.c.a.c_l': 'test2',\n  aps: { badge: 1, alert: '\u30c6\u30b9\u30c82', sound: 'default' },\n  opened_from_tray: true,\n  'gcm.n.e': '1',\n  'google.c.a.c_id': '1543238649561071055',\n  'google.c.a.udt': '0',\n  'gcm.message_id': '0:1481601928852855%c218bf06c218bf06',\n  'google.c.a.ts': '1481601928' }\n```\n\n`FCM.on('notification')`\u30a4\u30d9\u30f3\u30c8\u306e\u5f15\u6570\u3068\u3057\u3066\u4e0a\u8a18\u306e\u60c5\u5831\u304c\u6e21\u3055\u308c\u308b\u306e\u3067\u3001\u3053\u306e\u60c5\u5831\u3092\u5143\u306b\u30a2\u30d7\u30ea\u5185\u306e\u7279\u5b9a\u306e\u5834\u6240\u306b\u9077\u79fb\u3057\u305f\u308a\u3001\u3068\u3044\u3063\u305f\u51e6\u7406\u3092\u66f8\u3044\u3066\u3044\u304d\u307e\u3059\u3002\n\n\u3053\u308c\u3067\u901a\u77e5\u3092\u52d5\u304b\u3059\u3053\u3068\u304c\u3067\u304d\u307e\u3057\u305f\uff01\u304a\u75b2\u308c\u69d8\u3067\u3057\u305f\uff01\n\n\u7d9a\u3051\u3066\u6b21\u306e\u8a18\u4e8b\u3067Android\u7de8\u3082\u66f8\u3053\u3046\u3068\u601d\u3044\u307e\u3059\u3002\n", "tags": ["iOS", "FCM", "reactnative"]}