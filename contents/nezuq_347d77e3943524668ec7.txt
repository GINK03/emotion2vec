{"tags": ["Ruby1.9.3", "pixiv", "Pixiv\u7d71\u8a08\u30b7\u30ea\u30fc\u30ba"], "context": " More than 1 year has passed since last update.\n\n\u6982\u8981\nPixiv\u5c0f\u8aac\u691c\u7d22API\u306e\u7d50\u679c\u3092CSV\u5f62\u5f0f\u3067\u53d6\u5f97\u3057\u3001\n\u305d\u306eCSV\u30d5\u30a1\u30a4\u30eb\u3092\u5143\u306b\u5c0f\u8aac\u672c\u6587\u3092\u30c6\u30ad\u30b9\u30c8\u5f62\u5f0f\u3067\u53d6\u5f97\u3059\u308b\u3002\n\n\u51e6\u7406\n\n01.Pixiv\u5c0f\u8aac\u691c\u7d22API\u306e\u7d50\u679c\u3092CSV\u5f62\u5f0f\u3067\u53d6\u5f97\n -> Pixiv\u691c\u7d22\u7d50\u679c\u3092CSV\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3059\u308bHTML\u30d5\u30a1\u30a4\u30eb\u3092\u7528\u610f\u3057\u305f\n\u3000\u203bCSV\u30d5\u30a1\u30a4\u30eb\u306e\u540d\u524d\u306fINPUT.csv\u306b\u5909\u3048\u308b\u3002\n\n02.\u53d6\u5f97CSV\u30d5\u30a1\u30a4\u30eb\u306e\u540c\u968e\u5c64\u306b\u3001\u4e0b\u8a18Ruby\u30b3\u30fc\u30c9\u3092\u914d\u7f6e\n\npxcsv2novel.rb\n# encoding: utf-8\n\nrequire 'csv'\nrequire 'uri'\nrequire 'net/http'\nrequire 'fileutils'\n\n#\u5165\u529b\u30d5\u30a1\u30a4\u30eb\u540d\nINPUT_CSV = ARGV[0] || 'INPUT.csv'\n\npath = Time.now.strftime(\"%y%m%d%H%M%S\")\nFileUtils.mkdir_p(path)\n\nCSV.foreach(INPUT_CSV, encoding: \"UTF-8\") do |row|\n  sleep(rand(3) + 6)\n  if (0 < row[0].length) then\n    uri = URI.parse(\"http://spapi.pixiv.net/iphone/novel_text.php?id=\" + row[0])\n    text = Net::HTTP.get(uri)\n    open(path + '/' + (row[0] + \".txt\"), \"wb\") {|f|\n      f.write(text)\n    }\n  end\nend\n\nputs \"end!\"\n\n\n\n\u51fa\u529b\u30a4\u30e1\u30fc\u30b8\nyyMMddhhmmss\uff08\u51fa\u529b\u30d5\u30a9\u30eb\u30c0\uff09\n\u3000|\u30fc0000001.txt\uff08\u51fa\u529b\u30c6\u30ad\u30b9\u30c8\u30d5\u30a1\u30a4\u30eb\uff09\n\u3000|\u30fc0000002.txt\n\u3000|\u30fc0000003.txt\n\u3000|\u30fc etc...\n\n\u95a2\u9023\u30da\u30fc\u30b8\n -> R\u3067\u81ea\u7136\u8a00\u8a9e\u51e6\u7406\u3002Pixiv\u5c0f\u8aac\u3067\u5358\u8a9e\u5225\u306e\u51fa\u73fe\u6570\u3092\u8abf\u3079\u308b\n -> \u30cb\u30b3\u30cb\u30b3\u5927\u767e\u79d1\u30c7\u30fc\u30bf\u304b\u3089MeCab\u8f9e\u66f8\u3092\u751f\u6210\u3059\u308b\n -> R\u3067\u6587\u66f8\u5206\u985e\u5668\u3002\u672a\u6765\u8a2d\u5b9a\u306e\u30e9\u30d6\u30e9\u30a4\u30d6!\u767e\u5408\u5c0f\u8aac\u3092\u62bd\u51fa\u3059\u308b\n#\u6982\u8981\nPixiv\u5c0f\u8aac\u691c\u7d22API\u306e\u7d50\u679c\u3092CSV\u5f62\u5f0f\u3067\u53d6\u5f97\u3057\u3001\n\u305d\u306eCSV\u30d5\u30a1\u30a4\u30eb\u3092\u5143\u306b\u5c0f\u8aac\u672c\u6587\u3092\u30c6\u30ad\u30b9\u30c8\u5f62\u5f0f\u3067\u53d6\u5f97\u3059\u308b\u3002\n\n#\u51e6\u7406\n\n##01.Pixiv\u5c0f\u8aac\u691c\u7d22API\u306e\u7d50\u679c\u3092CSV\u5f62\u5f0f\u3067\u53d6\u5f97\n[ -> Pixiv\u691c\u7d22\u7d50\u679c\u3092CSV\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3059\u308bHTML\u30d5\u30a1\u30a4\u30eb\u3092\u7528\u610f\u3057\u305f](http://qiita.com/nezuq/items/55800d55c03606e0b13c)\n\u3000\u203bCSV\u30d5\u30a1\u30a4\u30eb\u306e\u540d\u524d\u306fINPUT.csv\u306b\u5909\u3048\u308b\u3002\n\n##02.\u53d6\u5f97CSV\u30d5\u30a1\u30a4\u30eb\u306e\u540c\u968e\u5c64\u306b\u3001\u4e0b\u8a18Ruby\u30b3\u30fc\u30c9\u3092\u914d\u7f6e\n\n```ruby:pxcsv2novel.rb\n# encoding: utf-8\n\nrequire 'csv'\nrequire 'uri'\nrequire 'net/http'\nrequire 'fileutils'\n\n#\u5165\u529b\u30d5\u30a1\u30a4\u30eb\u540d\nINPUT_CSV = ARGV[0] || 'INPUT.csv'\n\npath = Time.now.strftime(\"%y%m%d%H%M%S\")\nFileUtils.mkdir_p(path)\n\nCSV.foreach(INPUT_CSV, encoding: \"UTF-8\") do |row|\n  sleep(rand(3) + 6)\n  if (0 < row[0].length) then\n    uri = URI.parse(\"http://spapi.pixiv.net/iphone/novel_text.php?id=\" + row[0])\n    text = Net::HTTP.get(uri)\n    open(path + '/' + (row[0] + \".txt\"), \"wb\") {|f|\n      f.write(text)\n    }\n  end\nend\n\nputs \"end!\"\n```\n\n#\u51fa\u529b\u30a4\u30e1\u30fc\u30b8\nyyMMddhhmmss\uff08\u51fa\u529b\u30d5\u30a9\u30eb\u30c0\uff09\n\u3000|\u30fc0000001.txt\uff08\u51fa\u529b\u30c6\u30ad\u30b9\u30c8\u30d5\u30a1\u30a4\u30eb\uff09\n\u3000|\u30fc0000002.txt\n\u3000|\u30fc0000003.txt\n\u3000|\u30fc etc...\n\n#\u95a2\u9023\u30da\u30fc\u30b8\n[ -> R\u3067\u81ea\u7136\u8a00\u8a9e\u51e6\u7406\u3002Pixiv\u5c0f\u8aac\u3067\u5358\u8a9e\u5225\u306e\u51fa\u73fe\u6570\u3092\u8abf\u3079\u308b](http://qiita.com/nezuq/items/7f48b7a1c25bde626150)\n[ -> \u30cb\u30b3\u30cb\u30b3\u5927\u767e\u79d1\u30c7\u30fc\u30bf\u304b\u3089MeCab\u8f9e\u66f8\u3092\u751f\u6210\u3059\u308b](http://qiita.com/nezuq/items/875ac806d9b1afb3798d)\n[ -> R\u3067\u6587\u66f8\u5206\u985e\u5668\u3002\u672a\u6765\u8a2d\u5b9a\u306e\u30e9\u30d6\u30e9\u30a4\u30d6!\u767e\u5408\u5c0f\u8aac\u3092\u62bd\u51fa\u3059\u308b](http://qiita.com/nezuq/items/99a599587b1e48705c65)\n"}