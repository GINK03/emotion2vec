{"context": "\nNginx\u306e\u8a2d\u5b9a\u3067\u306a\u304b\u306a\u304b\u30cf\u30de\u3063\u3066\u3057\u307e\u3063\u305f\u306e\u3067\u3001\u6700\u7d42\u7684\u306b\u52d5\u3044\u305f\u8a2d\u5b9a\u3092\u30e1\u30e2\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n\n\n\u3084\u308a\u305f\u3044\u3053\u3068\n\n\n\u4f8b\u3048\u3070\u3001www.your-domain.com/subdir\u3067\u30a2\u30af\u30bb\u30b9\u3057\u305f\u3068\u304d\u306b\u3001DocumentRoot\u306e\u5916\u306b\u3042\u308bWordPress\u3084\u30d5\u30ec\u30fc\u30e0\u30ef\u30fc\u30af\u30a2\u30d7\u30ea\u3092\u5b9f\u884c\u3055\u305b\u305f\u3044\u3002\n/path/to/your/document/root/for\n    \u251c\u2500 www.your-domain.com\n    \u2502 \u251c\u2500\u2500 _root_                < \u30a2\u30af\u30bb\u30b9URL:www.your-domain.com\n    \u2502 \u2514\u2500\u2500 subdir                < \u30a2\u30af\u30bb\u30b9URL:www.your-domain.com/subdir\n\n\n\n\n\u524d\u63d0\n\nNginx + PHP-FPM + MariaDB\u3067\u69cb\u6210\u3055\u308c\u3066\u305fLEMP-AP\u30b5\u30fc\u30d0\u3002(\u3042\u3001MariaDB\u306f\u3069\u3046\u3067\u3082\u3044\u3044\u3084\u3002)\nsubdir\u306b\u304a\u3044\u305f\u30a2\u30d7\u30ea\u306f\u3001FrameWork\u3084\u3089WordPress\u3084\u3089\u306e\u304a\u4f5c\u6cd5\u306b\u5f93\u3063\u3066\u3001\u30b5\u30d6\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u904b\u7528\u3059\u308b\u8a2d\u5b9a\u306b\u3057\u3066\u304a\u304f\u3002\n\n\n\u8a2d\u5b9a\n\n\n/etc/nginx/conf.d/xxxxxxx.conf\u3092\u7de8\u96c6\n\n/etc/nginx/conf.d/xxxxxxx.conf\nserver  {\n    listen 80;\n    server_name www.your-domain.com;\n\n    location / {\n        root /path/to/your/document/root/for/www.your-domain.com/_root_;\n        index index.php index.html;\n        if (-f $request_filename) {\n            expires 30d;\n            break;\n        }\n        if (!-e $request_filename) {\n            rewrite ^(.*)$ /index.php?q=$1 last;\n        }\n        location ~ .php$ {\n            fastcgi_pass unix:/var/run/php-fpm/php-fpm.sock;\n            fastcgi_index index.php;\n            include /etc/nginx/fastcgi_params;\n            fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;\n        }\n    }\n\n    location /subdir {\n        alias /path/to/your/document/root/for/www.your-domain.com/subdir;\n        index index.php index.html;\n        if (-f $request_filename) {\n            expires 30d;\n            break;\n        }\n        if (!-e $request_filename) {\n            rewrite ^(.*)$ /subdir/index.php?q=$1 last;\n        }\n\n        location ~ ^/subdir/.+\\.php$ {\n            fastcgi_pass unix:/var/run/php-fpm/php-fpm.sock;\n            fastcgi_split_path_info ^/subdir(.+\\.php)(.*)$;\n            include /etc/nginx/fastcgi_params;\n            fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;\n        }\n    }\n}\n\n\n\n\nPHP-FPM & Nginx \u518d\u8d77\u52d5\n\nconsole\n/etc/rc.d/init.d/php-fpm restart\n/etc/rc.d/init.d/nginx restart\n\n\n\n\u4e0a\u8a18\u306e\u8a2d\u5b9a\u3067\u3084\u308a\u305f\u3044\u3053\u3068\u306f\u5b9f\u73fe\u3067\u304d\u305f\u3002\n\n\n* Nginx\u306e\u8a2d\u5b9a\u3067\u306a\u304b\u306a\u304b\u30cf\u30de\u3063\u3066\u3057\u307e\u3063\u305f\u306e\u3067\u3001\u6700\u7d42\u7684\u306b\u52d5\u3044\u305f\u8a2d\u5b9a\u3092\u30e1\u30e2\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n\n## \u3084\u308a\u305f\u3044\u3053\u3068\n* \u4f8b\u3048\u3070\u3001www.your-domain.com/subdir\u3067\u30a2\u30af\u30bb\u30b9\u3057\u305f\u3068\u304d\u306b\u3001DocumentRoot\u306e\u5916\u306b\u3042\u308bWordPress\u3084\u30d5\u30ec\u30fc\u30e0\u30ef\u30fc\u30af\u30a2\u30d7\u30ea\u3092\u5b9f\u884c\u3055\u305b\u305f\u3044\u3002\n\n\t``` tree\n\t/path/to/your/document/root/for\n\t\t\u251c\u2500 www.your-domain.com\n\t\t\u2502\t\u251c\u2500\u2500 _root_\t\t\t\t< \u30a2\u30af\u30bb\u30b9URL:www.your-domain.com\n\t\t\u2502\t\u2514\u2500\u2500 subdir\t\t\t\t< \u30a2\u30af\u30bb\u30b9URL:www.your-domain.com/subdir\n\t```\n\n\n## \u524d\u63d0\n\n* Nginx + PHP-FPM + MariaDB\u3067\u69cb\u6210\u3055\u308c\u3066\u305fLEMP-AP\u30b5\u30fc\u30d0\u3002(\u3042\u3001MariaDB\u306f\u3069\u3046\u3067\u3082\u3044\u3044\u3084\u3002)\n* subdir\u306b\u304a\u3044\u305f\u30a2\u30d7\u30ea\u306f\u3001FrameWork\u3084\u3089WordPress\u3084\u3089\u306e\u304a\u4f5c\u6cd5\u306b\u5f93\u3063\u3066\u3001\u30b5\u30d6\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u904b\u7528\u3059\u308b\u8a2d\u5b9a\u306b\u3057\u3066\u304a\u304f\u3002\n\n## \u8a2d\u5b9a\n\n* /etc/nginx/conf.d/xxxxxxx.conf\u3092\u7de8\u96c6\n\t\n\t``` bash:/etc/nginx/conf.d/xxxxxxx.conf\n\tserver  {\n\t\tlisten 80;\n\t\tserver_name www.your-domain.com;\n\t\t\n\t\tlocation / {\n\t\t\troot /path/to/your/document/root/for/www.your-domain.com/_root_;\n\t\t\tindex index.php index.html;\n\t\t\tif (-f $request_filename) {\n\t\t\t\texpires 30d;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif (!-e $request_filename) {\n\t\t\t\trewrite ^(.*)$ /index.php?q=$1 last;\n\t\t\t}\n\t\t\tlocation ~ .php$ {\n\t\t\t\tfastcgi_pass unix:/var/run/php-fpm/php-fpm.sock;\n\t\t\t\tfastcgi_index index.php;\n\t\t\t\tinclude /etc/nginx/fastcgi_params;\n\t\t\t\tfastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;\n\t\t\t}\n\t\t}\n\t\t\n\t\tlocation /subdir {\n\t\t\talias /path/to/your/document/root/for/www.your-domain.com/subdir;\n\t\t\tindex index.php index.html;\n\t\t\tif (-f $request_filename) {\n\t\t\t\texpires 30d;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif (!-e $request_filename) {\n\t\t\t\trewrite ^(.*)$ /subdir/index.php?q=$1 last;\n\t\t\t}\n\t\t\n\t\t\tlocation ~ ^/subdir/.+\\.php$ {\n\t\t\t\tfastcgi_pass unix:/var/run/php-fpm/php-fpm.sock;\n\t\t\t\tfastcgi_split_path_info ^/subdir(.+\\.php)(.*)$;\n\t\t\t\tinclude /etc/nginx/fastcgi_params;\n\t\t\t\tfastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;\n\t\t\t}\n\t\t}\n\t}\n\t```\n\n* PHP-FPM & Nginx \u518d\u8d77\u52d5\n\n\t``` bash:console\n\t/etc/rc.d/init.d/php-fpm restart\n\t/etc/rc.d/init.d/nginx restart\n\t```\n\n* \u4e0a\u8a18\u306e\u8a2d\u5b9a\u3067\u3084\u308a\u305f\u3044\u3053\u3068\u306f\u5b9f\u73fe\u3067\u304d\u305f\u3002\n", "tags": ["php-fpm", "nginx", "PHP", "location"]}