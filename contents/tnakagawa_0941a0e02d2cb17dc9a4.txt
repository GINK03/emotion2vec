{"context": " More than 1 year has passed since last update.\nlistODBC.bat\ncscript.exe //Nologo listODBC.js\n\n\n\nlistODBC.js\nWScript.Echo(\"BEGIN\");\ntry {\n    // \u300cSWbemLocator\u300d\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u53d6\u5f97\n    var locator = new ActiveXObject(\"WbemScripting.SWbemLocator\");\n\n    // \u300cSWbemServices\u300d\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u53d6\u5f97\uff08\u30ed\u30fc\u30ab\u30eb\u30b3\u30f3\u30d4\u30e5\u30fc\u30bf\u3001\u540d\u524d\u7a7a\u9593\u304c\u300croot\\default\u300d\uff09\n    var server = locator.ConnectServer(null, \"root\\\\default\");\n\n    // \u300cSWbemObject\u300d\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u53d6\u5f97\uff08\u300cStdRegProv\u300d\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\uff09\n    var object = server.Get(\"StdRegProv\");\n\n    // \u300cEnumValues\u300d\u30e1\u30bd\u30c3\u30c9\u53d6\u5f97\n    var method = object.Methods_.Item(\"EnumValues\");\n\n    // \u30d1\u30e9\u30e1\u30fc\u30bf\u7528\u300cSWbemObject\u300d\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u751f\u6210\n    var params = method.InParameters.SpawnInstance_();\n\n    // \u30d1\u30e9\u30e1\u30fc\u30bf\u8a2d\u5b9a\n    params.hDefKey = 0x80000002; // HKEY_LOCAL_MACHINE(0x80000002)\n    params.sSubKeyName = \"SOFTWARE\\\\ODBC\\\\ODBCINST.INI\\\\ODBC Drivers\";\n\n    // \u30e1\u30bd\u30c3\u30c9\u5b9f\u884c\uff08\u7d50\u679c\u30d1\u30e9\u30e1\u30fc\u30bf\u53d6\u5f97\uff09\n    var result = object.ExecMethod_(method.Name, params);\n\n    // \u7d50\u679c\u3092\u51fa\u529b\n    var names = result.sNames.toArray();\n    for (var i = 0; i < names.length; i++) {\n        WScript.Echo(\"\" + names[i]);\n    }\n} catch (e) {\n    WScript.Echo(\"Exception(\" + (e.number & 0xFFFF) + \"):\" + e.message);\n}\nWScript.Echo(\"END\");\n\nWScript.Quit(0);\n\n\n```html:listODBC.bat\ncscript.exe //Nologo listODBC.js\n```\n\n```javascript:listODBC.js\nWScript.Echo(\"BEGIN\");\ntry {\n    // \u300cSWbemLocator\u300d\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u53d6\u5f97\n    var locator = new ActiveXObject(\"WbemScripting.SWbemLocator\");\n\n    // \u300cSWbemServices\u300d\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u53d6\u5f97\uff08\u30ed\u30fc\u30ab\u30eb\u30b3\u30f3\u30d4\u30e5\u30fc\u30bf\u3001\u540d\u524d\u7a7a\u9593\u304c\u300croot\\default\u300d\uff09\n    var server = locator.ConnectServer(null, \"root\\\\default\");\n\n    // \u300cSWbemObject\u300d\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u53d6\u5f97\uff08\u300cStdRegProv\u300d\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\uff09\n    var object = server.Get(\"StdRegProv\");\n\n    // \u300cEnumValues\u300d\u30e1\u30bd\u30c3\u30c9\u53d6\u5f97\n    var method = object.Methods_.Item(\"EnumValues\");\n\n    // \u30d1\u30e9\u30e1\u30fc\u30bf\u7528\u300cSWbemObject\u300d\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u751f\u6210\n    var params = method.InParameters.SpawnInstance_();\n\n    // \u30d1\u30e9\u30e1\u30fc\u30bf\u8a2d\u5b9a\n    params.hDefKey = 0x80000002; // HKEY_LOCAL_MACHINE(0x80000002)\n    params.sSubKeyName = \"SOFTWARE\\\\ODBC\\\\ODBCINST.INI\\\\ODBC Drivers\";\n\n    // \u30e1\u30bd\u30c3\u30c9\u5b9f\u884c\uff08\u7d50\u679c\u30d1\u30e9\u30e1\u30fc\u30bf\u53d6\u5f97\uff09\n    var result = object.ExecMethod_(method.Name, params);\n\n    // \u7d50\u679c\u3092\u51fa\u529b\n    var names = result.sNames.toArray();\n    for (var i = 0; i < names.length; i++) {\n        WScript.Echo(\"\" + names[i]);\n    }\n} catch (e) {\n    WScript.Echo(\"Exception(\" + (e.number & 0xFFFF) + \"):\" + e.message);\n}\nWScript.Echo(\"END\");\n\nWScript.Quit(0);\n```\n", "tags": ["JScript"]}