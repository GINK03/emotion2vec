{"context": "\n\n\u306f\u3058\u3081\u306b\n\u3053\u306e\u8a18\u4e8b\u306f\u3001\u79c1\u304c\u6a5f\u68b0\u5b66\u7fd2\u3001\u7279\u306b\u300c\u8aa4\u5dee\u9006\u4f1d\u64ad\u6cd5\u300d (\u3042\u308b\u3044\u306f\u300c\u30d0\u30c3\u30af\u30d7\u30ed\u30d1\u30b2\u30fc\u30b7\u30e7\u30f3 (Backpropagation)\u300d) \u3092\u52c9\u5f37\u3059\u308b\u3046\u3048\u3067\u8fbf\u3063\u305f\u9053\u7b4b\u3092\u8a18\u9332\u3057\u3066\u304a\u304f\u3082\u306e\u3067\u3059\u3002\n\u8aa4\u5dee\u9006\u4f1d\u64ad\u6cd5\u306b\u95a2\u3059\u308b\u5206\u304b\u308a\u3084\u3059\u3044\u89e3\u8aac\u306f\u3001\u3053\u3053 Qiita \u306b\u3082\u591a\u6570\u5b58\u5728\u3057\u307e\u3059\u306e\u3067\u3001\u6b63\u76f4 $n$ \u756a\u714e\u3058\u306a\u3068\u3053\u308d\u304c\u3042\u308a\u307e\u3059\u304c\u3001\u3042\u304f\u307e\u3067\u8a18\u9332\u3067\u3059\u306e\u3067\u3053\u3053\u306f 1 \u3064\u3002\n\u300c\u8a18\u9332\u300d\u3068\u3044\u3046\u306b\u306f\u9577\u904e\u304e\u3066\u30a4\u30de\u30a4\u30c1\u611f\u6ea2\u308c\u3066\u307e\u3059\u304c\u3001\u305d\u3053\u306f\u6c17\u306b\u3057\u306a\u3044\u3067\u304f\u3060\u3055\u3044\u3002\u3053\u308c\u3067\u3082\u8981\u70b9\u3092\u3057\u307c\u3063\u305f\u3064\u3082\u308a\u306a\u306e\u3067\u3059\u2026\n\u3086\u3063\u304f\u308a\u3057\u3066\u3044\u3063\u3066\u306d\uff01\uff01\uff01\n\n\u9014\u4e2d\u306e\u6570\u5f0f\u306b\u3064\u3044\u3066\n\u8a18\u4e8b\u306e\u524d\u5f8c\u304b\u3089\u53c2\u7167\u3055\u308c\u3066\u3044\u308b\u6570\u5f0f\u306b\u3064\u3044\u3066\u306f\u53f3\u5074\u306b\u756a\u53f7\u3092\u632f\u3063\u3066\u3044\u307e\u3059\u3002\n\u521d\u56de\u8a18\u8f09\u6642\u306f $\\text{(1)}$ \u3068\u304b\u3063\u3053\u4ed8\u304d\u6570\u5b57\u3067\u30012 \u56de\u76ee\u4ee5\u964d\u8a18\u8f09\u6642\u306f $\\text{[1]}$ \u3068\u89d2\u304b\u3063\u3053\u4ed8\u304d\u6570\u5b57\u3067\u793a\u3057\u307e\u3059\u3002\u8a18\u8f09\u6e08\u307f\u306e\u6570\u5f0f\u3092\u5909\u5f62\u3057\u305f\u3082\u306e\u306b\u3064\u3044\u3066\u306f $\\text{(1')}$ \u3068\u30d7\u30e9\u30a4\u30e0\u4ed8\u304d\u6570\u5b57\u3067\u793a\u3057\u307e\u3059\u3002\n\u756a\u53f7\u304c\u632f\u3089\u308c\u3066\u3044\u306a\u3044\u6570\u5f0f\u306f\u3001\u524d\u5f8c\u304b\u3089\u53c2\u7167\u3055\u308c\u306a\u304b\u3063\u305f\u3053\u3068\u3092\u793a\u3059\u3060\u3051\u3067\u3001\u305d\u306e\u5f0f\u306e\u91cd\u8981\u6027\u304c\u4f4e\u3044\u3053\u3068\u3092\u8868\u3059\u3082\u306e\u3067\u306f\u3042\u308a\u307e\u305b\u3093\u3002\n\n\u8aa4\u5dee\u9006\u4f1d\u64ad\u6cd5\u306e\u5c4b\u53f0\u9aa8\n\u8aa4\u5dee\u9006\u4f1d\u64ad\u6cd5\u306f\u3001\u300c\u9023\u9396\u5f8b (chain rule)\u300d1 \u3068\u3044\u3046\u5b9a\u7406\u3068\u300c\u6700\u6025\u964d\u4e0b\u6cd5 (gradient descent)\u300d\u3068\u3044\u3046\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u306e 2 \u3064\u306b\u3088\u3063\u3066\u652f\u3048\u3089\u308c\u3066\u3044\u307e\u3059\u3002\n\n\u9023\u9396\u5f8b\n\u300c\u9023\u9396\u5f8b\u300d\u3068\u306f\u3001\u8907\u6570\u306e\u95a2\u6570\u304c\u7d44\u307f\u5408\u308f\u3055\u3063\u305f \u5408\u6210\u95a2\u6570 \u3092\u5fae\u5206\u3059\u308b\u969b\u306e\u30eb\u30fc\u30eb\u306e\u3053\u3068\u3067\u3059\u3002\n\u95a2\u6570 $f$ \u304a\u3088\u3073 $g_{(n)}\\ \\small{(n \\in 1, 2, \\dots, N)}$ \u3092\u4f7f\u3063\u3066\u3001$z = f(y_1, y_2, \\dots, y_N)$\u3001$y_n = g_{(n)}(x_1, x_2, \\dots, x_i, \\dots)$ \u3068\u8868\u3059\u3053\u3068\u304c\u3067\u304d\u3001\n\n\u95a2\u6570 $f$ \u304c $y_1, y_2, \\dots, y_N$ \u306b\u304a\u3044\u3066\u5168\u5fae\u5206\u53ef\u80fd\u3067\u3042\u308b\u3002\n\u95a2\u6570 $g_{(n)}$ \u304c\u305d\u308c\u305e\u308c $x_i$ \u306b\u3064\u3044\u3066\u504f\u5fae\u5206\u53ef\u80fd\u3067\u3042\u308b\u3002\n\n\u306e 2 \u3064\u3092\u6e80\u305f\u3059\u3068\u304d\u3001\u4ee5\u4e0b\u306e $\\text{(1)}$ \u304c\u6210\u308a\u7acb\u3061\u307e\u3059\u3002\n\\begin{align}\n\\frac{\\partial z}{\\partial x_i} &= \\frac{\\partial z}{\\partial y_1}\\cdot\\frac{\\partial y_1}{\\partial x_i} + \\frac{\\partial z}{\\partial y_2}\\cdot\\frac{\\partial y_2}{\\partial x_i} + \\cdots + \\frac{\\partial z}{\\partial y_N}\\cdot\\frac{\\partial y_N}{\\partial x_i} \\\\\n&= \\sum_{n=1}^{N} \\frac{\\partial z}{\\partial y_n}\\cdot\\frac{\\partial y_n}{\\partial x_i}\n\\end{align} \\tag{1}\n\n\u3044\u304d\u306a\u308a\u4e00\u822c\u5316\u3055\u308c\u305f\u5f0f\u304c\u51fa\u3066\u304d\u3066\u96e3\u3057\u304f\u611f\u3058\u308b\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u304c\u3001\u30a4\u30e1\u30fc\u30b8\u3068\u3057\u3066\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u899a\u3048\u3066\u304a\u304f\u3068\u3088\u3044\u304b\u3068\u601d\u3044\u307e\u3059\u3002\n\n\u5909\u6570\u304c\u4e2d\u7d99\u3059\u308b (\u4f8b\u3048\u3070 $z$ \u2192 $y_1$ \u2192 $x_i$) \u5834\u5408\u3001\u504f\u5fae\u5206\u306f\u5404\u3005\u306e \u7a4d \u3067\u8868\u3059\u3002\n\u5909\u6570\u304c\u8907\u6570\u306b\u5206\u5c90\u3059\u308b ($z$ \u2192 $y_1, y_2, \\dots, y_N$) \u5834\u5408\u3001\u504f\u5fae\u5206\u306f\u5404\u3005\u306e \u548c \u3067\u8868\u3059\u3002\n\n\u3061\u306a\u307f\u306b\u95a2\u6570 $f$ \u3068 $g_{(n)}$ \u304c\u3069\u3061\u3089\u3082 1 \u5909\u6570\u95a2\u6570\u306e\u5834\u5408\u3001\u9023\u9396\u5f8b\u306f\u7a4d\u306e\u30eb\u30fc\u30eb\u3060\u3051\u304c\u6b8b\u3063\u3066\u975e\u5e38\u306b\u7c21\u5358\u306b\u8868\u3059\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\\frac{dz}{dx} = \\frac{dz}{dy}\\cdot\\frac{dy}{dx}\n\n\u300c\u5408\u6210\u95a2\u6570\u306e\u5fae\u5206\u300d\u3068\u3057\u3066\u3001\u9ad8\u6821\u6570\u5b66\u306e\u6570\u2162\u3067\u7fd2\u3063\u305f\u65b9\u3082\u591a\u3044\u306e\u3067\u306f\u306a\u3044\u3067\u3057\u3087\u3046\u304b\u3002$y = \\log(\\sin^2x)$ \u3092\u5fae\u5206\u305b\u3088\u3001\u3068\u304b\u3002\n\u306a\u304a\u3001\u9023\u9396\u5f8b\u306f\u65e2\u306b\u8a3c\u660e\u3055\u308c\u3066\u3044\u308b\u3082\u306e\u3067\u3059\u306e\u3067\u3001\u3053\u306e\u8a18\u4e8b\u3067\u306f\u3042\u308a\u304c\u305f\u304f\u4f7f\u308f\u305b\u3066\u3044\u305f\u3060\u304d\u3001\u8a3c\u660e\u306f\u5272\u611b\u3057\u307e\u3059\u304c\u3001\u4f8b\u3048\u3070\u6771\u5927\u306e\u6e05\u91ce\u5148\u751f\u304c\u884c\u3063\u3066\u3044\u308b\u30bc\u30df\u306e\u8cc7\u6599\u3067\u304b\u306a\u308a\u4e01\u5be7\u306b\u8a3c\u660e\u3092\u89e3\u8aac\u3055\u308c\u3066\u3044\u307e\u3059\u306e\u3067\u3001\u53c2\u8003\u306b\u3057\u3066\u307f\u3066\u304f\u3060\u3055\u3044\u3002\n\n\u6700\u6025\u964d\u4e0b\u6cd5\n\u300c\u6700\u6025\u964d\u4e0b\u6cd5\u300d\u306f\u3001\u95a2\u6570 $f(\\boldsymbol{x})$ \u304c\u6700\u5c0f\u5024\u3092\u3068\u308b\u3068\u304d\u306e\u5909\u6570 $\\boldsymbol{x}$ \u306e\u5024\u3092\u3001\u95a2\u6570\u306e\u5fae\u5206\u3001\u3064\u307e\u308a 1 \u968e\u5c0e\u95a2\u6570\u306e\u307f\u3092\u4f7f\u3063\u3066\u6c42\u3081\u308b\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u306e 1 \u3064\u3067\u3059\u3002\n\u95a2\u6570\u306e\u6700\u5c0f\u5024\u3042\u308b\u3044\u306f\u6700\u5927\u5024\u3092\u6c42\u3081\u308b\u554f\u984c\u3092\u300c\u6700\u9069\u5316\u554f\u984c\u300d\u3068\u3088\u3073\u307e\u3059\u304c\u3001\u305d\u306e\u4e2d\u3067\u3082\u6700\u6025\u964d\u4e0b\u6cd5\u306f\u3001\u554f\u984c\u3092\u89e3\u304f\u305f\u3081\u306b\u5c0e\u95a2\u6570\u304c\u5fc5\u8981\u306a\u300c\u52fe\u914d\u6cd5\u300d\u306e\u30ab\u30c6\u30b4\u30ea\u30fc\u306b\u5c5e\u3057\u307e\u3059\u3002\n\\begin{align}\n\\boldsymbol{x}^{(k+1)} &= \\boldsymbol{x}^{(k)} - \\eta \\frac{\\partial}{\\partial \\boldsymbol{x}^{(k)}} f(\\boldsymbol{x}^{(k)}) \\\\\n&= \\boldsymbol{x}^{(k)} - \\eta \\begin{bmatrix}\n\\dfrac{\\partial f(\\boldsymbol{x}^{(k)})}{\\partial x_1^{(k)}} \\\\\n\\dfrac{\\partial f(\\boldsymbol{x}^{(k)})}{\\partial x_2^{(k)}} \\\\\n\\vdots \\\\\n\\dfrac{\\partial f(\\boldsymbol{x}^{(k)})}{\\partial x_n^{(k)}}\n\\end{bmatrix}\n\\end{align} \\tag{2}\n\n$\\boldsymbol{x}$ \u306e\u53f3\u80a9\u306b\u3042\u308b\u304b\u3063\u3053\u306e\u4e2d\u306f\u53cd\u5fa9\u306e\u56de\u6570\u3067\u3042\u308a\u3001$k$ \u56de\u76ee\u306e\u5024\u304b\u3089\u3001\u65b0\u3057\u304f $k+1$ \u56de\u76ee\u306e\u5024\u3092\u6c42\u3081\u308b\u6f38\u5316\u5f0f\u306b\u306a\u3063\u3066\u3044\u307e\u3059\u3002\n\u4fc2\u6570 $\\eta$ (\u30a8\u30fc\u30bf) \u306b\u7279\u306b\u540d\u524d\u306f\u4ed8\u3044\u3066\u3044\u307e\u305b\u3093\u304c\u3001\u6a5f\u68b0\u5b66\u7fd2\u3067\u3053\u306e\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u304c\u5229\u7528\u3055\u308c\u308b\u3068\u304d\u306f\u300c\u5b66\u7fd2\u7387 (learning rate)\u300d\u3068\u3088\u3070\u308c\u305f\u308a\u3057\u307e\u3059\u3002\n\u65e2\u306b $\\text{(2)}$ \u304b\u3089\u660e\u3089\u304b\u3067\u3059\u304c\u3001\u6700\u6025\u964d\u4e0b\u6cd5\u306b\u304a\u3051\u308b $\\boldsymbol{x}$ \u306e\u4fee\u6b63\u65b9\u91dd\u306f\u4ee5\u4e0b\u306e 2 \u70b9\u3067\u3059\u3002\n\n\u5fae\u5206\u4fc2\u6570\u306e\u7d76\u5bfe\u5024\u304c\u5927\u304d\u3044\u307b\u3069\u6b63\u89e3\u304b\u3089\u96e2\u308c\u3066\u3044\u308b\u3068\u5224\u65ad\u3057\u3066\u3001\u3088\u308a\u5927\u80c6\u306b\u4fee\u6b63\u3059\u308b (\uff1d\u4fee\u6b63\u91cf\u3092\u5927\u304d\u304f\u3059\u308b)\u3002\n\u5fae\u5206\u4fc2\u6570\u304c\u50be\u304d\u3092\u8868\u3059\u6027\u8cea\u304b\u3089\u3001\u5fae\u5206\u4fc2\u6570\u306e\u7b26\u53f7\u3068\u306f\u9006\u306e\u65b9\u5411\u306b\u4fee\u6b63\u3059\u308b\u3002\n\n\u3053\u308c\u306f $\\boldsymbol{x}$ \u304c 1 \u5909\u6570\u3067\u3001$f(\\boldsymbol{x})$ \u304c 2 \u6b21\u95a2\u6570\u3067\u4e0b\u306b\u51f8\u3060\u3063\u305f\u3068\u304d\u306e\u30b0\u30e9\u30d5\u3092\u601d\u3044\u6d6e\u304b\u3079\u3066\u307f\u308b\u3068\u5206\u304b\u308a\u3084\u3059\u3044\u3068\u601d\u3044\u307e\u3059\u30022\n\n$\\boldsymbol{x}$ \u304c\u591a\u5909\u6570\u3001\u3064\u307e\u308a\u30d9\u30af\u30c8\u30eb\u306b\u306a\u3063\u3066\u3082\u8003\u3048\u65b9\u306f\u540c\u3058\u3067\u3001$f(\\boldsymbol{x})$ \u306b\u5e73\u9762\u30fb\u8d85\u5e73\u9762\u7684\u306a \u201c\u304f\u307c\u307f\u201d \u304c\u5b58\u5728\u3059\u308c\u3070\u3001\u305d\u3053\u306b\u843d\u3061\u7740\u3044\u3066\u3044\u304f\u3053\u3068\u306b\u306a\u308a\u307e\u3059\u3002\n\u305f\u3060\u3057\u3001\u500b\u3005\u306e\u5909\u6570\u3092\u4fee\u6b63\u3059\u308b\u305f\u3081\u306b\u306f $x_1, x_2, \\dots, x_n$ \u305d\u308c\u305e\u308c\u306e\u5024\u306e\u5909\u5316\u306b\u5bfe\u3059\u308b $f(\\boldsymbol{x})$ \u306e\u5897\u6e1b\u306b\u6ce8\u76ee\u3059\u308b\u5fc5\u8981\u304c\u751f\u3058\u308b\u305f\u3081\u3001\u5f0f\u306f\u504f\u5fae\u5206\u306b\u306a\u3063\u3066\u3044\u308b\u308f\u3051\u3067\u3059\u3002\n\u975e\u5e38\u306b\u30b7\u30f3\u30d7\u30eb\u3067\u5206\u304b\u308a\u3084\u3059\u3044\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u3067\u3059\u304c\u3001\u6ce8\u610f\u3059\u308b\u3079\u304d\u70b9\u3082\u3042\u308a\u307e\u3059\u3002\n\n$\\boldsymbol{x}$ \u304c\u53ce\u675f\u3057\u305f\u3068\u3057\u3066\u3082\u3001\u305d\u306e\u3068\u304d\u306e $f(\\boldsymbol{x})$ \u304c\u6700\u5c0f\u5024\u3067\u3042\u308b\u3068\u306f\u9650\u3089\u306a\u3044\u3002\n\n\n\u4f8b\u3048\u3070 4 \u6b21\u95a2\u6570\u306e\u3088\u3046\u306b \u201c\u304f\u307c\u307f\u201d \u304c\u8907\u6570\u7b87\u6240\u5b58\u5728\u3059\u308b\u5834\u5408\u3001\u6700\u5c0f\u3067\u306f\u306a\u3044 \u201c\u304f\u307c\u307f\u201d \u306b\u30cf\u30de\u3063\u3066\u629c\u3051\u51fa\u305b\u306a\u304f\u306a\u308a\u3001\u305d\u306e\u4e2d\u306e\u6700\u5c0f\u5024 (\u3064\u307e\u308a\u6975\u5c0f\u5024) \u3092\u89e3\u3068\u52d8\u9055\u3044\u3059\u308b\u3053\u3068\u304c\u8d77\u3053\u308a\u3046\u308b\u3002\n\u3053\u306e\u3088\u3046\u306b\u3001\u554f\u984c\u304c\u89e3\u3051\u3066\u3044\u308b\u3088\u3046\u306b\u898b\u3048\u3066\u5b9f\u306f\u6b63\u89e3 (\u5927\u57df\u7684\u6700\u9069\u89e3) \u3067\u306f\u306a\u3044\u89e3\u3092\u5c40\u6240\u7684\u6700\u9069\u89e3\u3068\u3044\u3046\u3002\n\n\n\u53ce\u675f\u30b9\u30d4\u30fc\u30c9\u304c\u5c0e\u95a2\u6570\u306b\u4f9d\u5b58\u3057\u3066\u304a\u308a\u3001\u5fae\u5206\u4fc2\u6570\u304c 0 \u306b\u8fd1\u3044\u3068\u53ce\u675f\u304c \u304d\u308f\u3081\u3066 \u9045\u304f\u306a\u308b\u3002\n\n\n\u52fe\u914d\u6cd5\u306e\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u306f\u5e38\u306b\u3053\u306e\u5371\u967a\u304c\u3064\u304d\u307e\u3068\u3044\u3001\u300c\u52fe\u914d\u6d88\u5931\u554f\u984c (vanishing gradient problem)\u300d\u3068\u3088\u3070\u308c\u308b\u3002\n\n\n\u4fc2\u6570 $\\eta$ \u306f\u5927\u304d\u3059\u304e\u3066\u3082\u5c0f\u3055\u3059\u304e\u3066\u3082\u3088\u304f\u306a\u3044\u3002\u307e\u305f\u3001$f(\\boldsymbol{x})$ \u304a\u3088\u3073\u305d\u306e\u5c0e\u95a2\u6570\u306b\u3088\u3063\u3066\u6700\u9069\u306a\u5024\u306f\u7570\u306a\u308b\u3002\n\n\n$\\eta$ \u304c\u5927\u304d\u3044\u3068\u767a\u6563\u30fb\u632f\u52d5\u3092\u8d77\u3053\u3059\u5371\u967a\u304c\u9ad8\u304f\u306a\u308a\u3001\u9006\u306b\u5c0f\u3055\u3044\u3068\u53ce\u675f\u304c\u9045\u304f\u306a\u308b\u3002\n$\\boldsymbol{x}$ \u306e\u4fee\u6b63\u91cf\u306f $\\eta$ \u3068\u5fae\u5206\u4fc2\u6570\u306b\u3088\u3063\u3066\u6c7a\u307e\u308b\u305f\u3081\u3001\u5fae\u5206\u4fc2\u6570\u304c\u5927\u304d\u3059\u304e\u308b\u30fb\u5c0f\u3055\u3059\u304e\u308b\u3068\u304d\u306e\u5bfe\u7b56\u304c\u5fc5\u8981\u306a\u5834\u5408\u304c\u3042\u308b\u3002\n\n\n\n\u3053\u308c\u3089\u306e\u6ce8\u610f\u70b9\u306f\u3001\u8fd1\u5e74\u306e\u7814\u7a76\u306b\u3088\u3063\u3066\u6539\u5584\u3057\u305f\u308a\u3001\u554f\u984c\u3092\u8d77\u3053\u3055\u306a\u3044\u3088\u3046\u306a\u30d1\u30e9\u30e1\u30fc\u30bf\u8a2d\u5b9a\u306a\u3069\u304c\u63d0\u6848\u3055\u308c\u3066\u3044\u307e\u3059\u304c\u3001\u3053\u3053\u3067\u306f\u8aa4\u5dee\u9006\u4f1d\u64ad\u6cd5\u306e\u30b3\u30a2\u306e\u90e8\u5206\u3092\u53d6\u308a\u4e0a\u3052\u305f\u3044\u306e\u3067\u3001\u3042\u307e\u308a\u6df1\u304f\u8003\u3048\u306a\u3044\u3053\u3068\u306b\u3057\u307e\u3059\u3002\n\n\u9806\u4f1d\u64ad\u578b\u30cb\u30e5\u30fc\u30e9\u30eb\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\n\u300c\u9806\u4f1d\u64ad\u578b\u30cb\u30e5\u30fc\u30e9\u30eb\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u300d (\u3042\u308b\u3044\u306f\u300c\u30d5\u30a3\u30fc\u30c9\u30d5\u30a9\u30ef\u30fc\u30c9\u30cb\u30e5\u30fc\u30e9\u30eb\u30cd\u30c3\u30c8\u30ef\u30fc\u30af (feedforward neural network)\u300d) \u306f\u3001\u4ee5\u4e0b\u3092\u6e80\u305f\u3059\u30cb\u30e5\u30fc\u30e9\u30eb\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306e\u3053\u3068\u3067\u3059\u3002\n\n\n\u5c64\u72b6\u306e \u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u3067\u3001\u30ce\u30fc\u30c9\u306e\u3059\u3079\u3066\u304c\u300c\u5c64 (layer)\u300d\u306e\u3044\u305a\u308c\u304b\u306b\u5c5e\u3059\u308b\u3002\n\n\n\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306b\u5165\u529b\u3055\u308c\u305f\u30c7\u30fc\u30bf\u3092\u6301\u3064\u30ce\u30fc\u30c9\u306e\u5c64\u306f\u300c\u5165\u529b\u5c64 (input layer)\u300d\u3001\u524d\u306e\u5c64\u304c\u6301\u3064\u5024\u3092\u4f7f\u3063\u3066\u6f14\u7b97\u3057\u305f\u7d50\u679c\u3092\u6301\u3064\u30ce\u30fc\u30c9\u306e\u5c64\u306f\u300c\u96a0\u308c\u5c64 (hidden layer)\u300d\u3001\u96a0\u308c\u5c64\u3068\u540c\u3058\u304f\u6f14\u7b97\u7d50\u679c\u3092\u6301\u3064\u30ce\u30fc\u30c9\u306e\u5c64\u3067\u3001\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306e\u6700\u7d42\u306b\u3042\u308b\u5c64\u3092\u300c\u51fa\u529b\u5c64 (output layer)\u300d\u3068\u3088\u3076\u3002\n\u96a0\u308c\u5c64\u304c\u8907\u6570\u3042\u308b\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u3084\u3001\u9006\u306b\u96a0\u308c\u5c64\u3092\u6301\u305f\u305a\u3001\u5165\u529b\u5c64\u3068\u51fa\u529b\u5c64\u3057\u304b\u306a\u3044\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u3082\u3042\u308b\u3002\n\n\n\u3059\u3079\u3066\u306e\u30ce\u30fc\u30c9\u306f\u3001\u96a3\u63a5\u3059\u308b\u5c64\u306e\u30ce\u30fc\u30c9\u3068\u306e\u9593\u306b\u306e\u307f\u63a5\u7d9a\u3092\u6301\u3064\u3002\u540c\u4e00\u5c64\u3069\u3046\u3057\u306e\u63a5\u7d9a\u3084\u3001\u5c64\u3092\u307e\u305f\u3044\u3060\u63a5\u7d9a\u306f\u306a\u3044\u3002\n\n\u8a00\u8449\u3067\u66f8\u304f\u3068\u3072\u305f\u3059\u3089\u3084\u3084\u3053\u3057\u3044\u3067\u3059\u304c\u3001\u8981\u306f\u4e0b\u306e\u56f3\u306e\u3088\u3046\u306a\u5f62\u3092\u3057\u305f\u30cb\u30e5\u30fc\u30e9\u30eb\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306e\u3053\u3068\u3092\u6307\u3057\u307e\u3059\u3002\n\n\u51fa\u529b\u5c64\u3067\u6211\u3005\u306e\u671b\u3093\u3060\u7d50\u679c\u304c\u51fa\u308b\u3088\u3046\u306b\u30d1\u30e9\u30e1\u30fc\u30bf\u3092\u8abf\u6574\u3059\u308b\u4f5c\u696d\u304c\u3001\u30cb\u30e5\u30fc\u30e9\u30eb\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306b\u304a\u3051\u308b\u300c\u5b66\u7fd2\u300d\u3067\u3059\u3002\n\u306a\u304a\u3053\u308c\u4ee5\u964d\u3001\u5358\u306b\u300c\u30cb\u30e5\u30fc\u30e9\u30eb\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u300d\u3042\u308b\u3044\u306f\u300c\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u300d\u3068\u66f8\u3044\u305f\u5834\u5408\u306f\u3001\u3053\u306e\u300c\u9806\u4f1d\u64ad\u578b\u30cb\u30e5\u30fc\u30e9\u30eb\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u300d\u3092\u6307\u3059\u3053\u3068\u306b\u3057\u307e\u3059\u3002\n\n\u8a08\u7b97\u30e2\u30c7\u30eb\n\u5148\u307b\u3069\u96a0\u308c\u5c64\u306e\u8aac\u660e\u3067\u3001\u201c\u524d\u306e\u5c64\u304c\u6301\u3064\u5024\u3092\u4f7f\u3063\u3066\u6f14\u7b97\u3057\u305f\u7d50\u679c\u3092\u6301\u3064\u201d \u3068\u66f8\u304d\u307e\u3057\u305f\u3002\n\u30cb\u30e5\u30fc\u30e9\u30eb\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306b\u304a\u3044\u3066\u3001\u4e00\u822c\u306b\u3053\u306e\u6f14\u7b97\u306f \u201c\u524d\u306e\u5c64\u306e\u5024\u306b\u4fc2\u6570\u3092\u639b\u3051\u3066\u8db3\u3057\u5408\u308f\u305b\u308b\u201d \u3068\u3044\u3046\u3082\u306e\u3067\u3001\u4ee5\u4e0b\u306e\u8a08\u7b97\u30e2\u30c7\u30eb $\\text{(3)}$ \u3067\u793a\u3055\u308c\u307e\u3059\u3002\n\\boldsymbol{l}^{(k+1)} = \\sigma^{(k+1)}(\\boldsymbol{W}^{(k+1)} \\boldsymbol{l}^{(k)} + \\boldsymbol{b}^{(k+1)}) \\tag{3}\n\n\u5404\u8a18\u53f7\u306e\u53f3\u80a9\u306b\u3042\u308b\u304b\u3063\u3053\u306e\u4e2d\u306f\u5c64\u306e\u756a\u53f7\u3067\u3042\u308a\u3001$k$ \u756a\u76ee\u306e\u5c64\u304c\u6301\u3064\u5024 $\\boldsymbol{l}^{(k)}$ \u304b\u3089\u3001$k+1$ \u756a\u76ee\u306e\u5c64\u306e\u5024 $\\boldsymbol{l}^{(k+1)}$ \u3092\u6c42\u3081\u308b\u6f38\u5316\u5f0f\u306b\u306a\u3063\u3066\u3044\u307e\u3059\u3002\n\u4e00\u756a\u524d\u306e\u5c64\u3001\u3064\u307e\u308a\u5165\u529b\u5c64\u304b\u3089\u59cb\u307e\u308a\u3001\u3053\u306e\u6f38\u5316\u5f0f\u306b\u3057\u305f\u304c\u3063\u3066\u51fa\u529b\u5c64\u307e\u3067\u9806\u756a\u306b\u8a08\u7b97\u3057\u3066\u3044\u304f\u904e\u7a0b\u3092\u3001\u300c\u9806\u4f1d\u64ad (forward propagation)\u300d\u3068\u3044\u3044\u307e\u3059\u3002\u9806 \u304c\u3042\u308b\u304b\u3089\u306b\u306f \u9006 \u3082\u3042\u308b\u308f\u3051\u3067\u3059\u304c\u3001\u305d\u308c\u306f\u306e\u3061\u307b\u3069\u3002\n$\\boldsymbol{W}$ \u306f\u524d\u306e\u5c64\u306e\u5404\u30ce\u30fc\u30c9\u304b\u3089\u81ea\u5206\u306b\u5bfe\u3057\u3066\u306e\u5f71\u97ff\u3092\u8868\u3059\u5024\u3067\u3001\u300c\u91cd\u307f (weight)\u300d\u3068\u3088\u3070\u308c\u307e\u3059\u3002\u307e\u305f\u3001$\\boldsymbol{b}$ \u306f\u524d\u306e\u5c64\u306e\u30ce\u30fc\u30c9\u306b\u5f71\u97ff\u3057\u306a\u3044 \u201c\u5b9a\u6570\u7684\u306a\u201d \u6027\u683c\u3092\u6301\u3064\u5024\u3067\u3001\u300c\u30d0\u30a4\u30a2\u30b9 (bias)\u300d\u3068\u3088\u3070\u308c\u307e\u3059\u3002\n\u5c64\u306f\u4e00\u822c\u306b\u8907\u6570\u306e\u30ce\u30fc\u30c9\u3067\u69cb\u6210\u3055\u308c\u3066\u3044\u307e\u3059\u304b\u3089\u3001\u5c64\u306e\u30ce\u30fc\u30c9\u304c\u6301\u3064\u5024 $\\boldsymbol{l}$ \u3092 \u30d9\u30af\u30c8\u30eb \u3067\u8868\u3059\u3068\u3001\u30d0\u30a4\u30a2\u30b9 $\\boldsymbol{b}$ \u306f\u30ce\u30fc\u30c9\u3054\u3068\u306b\u6301\u3064\u5024\u3067\u3059\u306e\u3067\u540c\u3058\u304f\u30d9\u30af\u30c8\u30eb\u3068\u306a\u308a\u3001\u91cd\u307f $\\boldsymbol{W}$ \u306f\u30d9\u30af\u30c8\u30eb\u304b\u3089\u30d9\u30af\u30c8\u30eb\u3092\u6c42\u3081\u308b\u5909\u63db\u3067\u3059\u306e\u3067 \u884c\u5217 \u3068\u306a\u308a\u307e\u3059\u3002\n$\\sigma$ \u306f\u300c\u6d3b\u6027\u5316\u95a2\u6570 (activation function)\u300d\u3068\u3088\u3070\u308c\u3001\u91cd\u307f\u3068\u30d0\u30a4\u30a2\u30b9\u3092\u4f7f\u3063\u3066\u6c42\u3081\u305f\u5024 ($\\boldsymbol{W} \\boldsymbol{l} + \\boldsymbol{b}$) \u306b\u5bfe\u3059\u308b \u4f55\u3089\u304b\u306e\u5909\u63db \u3092\u884c\u3044\u307e\u3059\u3002\n\u53e4\u304f\u306f\u30d8\u30f4\u30a3\u30b5\u30a4\u30c9\u306e\u968e\u6bb5\u95a2\u6570 (Heaviside step function) \u3060\u3063\u305f\u308a\u6052\u7b49\u5199\u50cf (identity function) \u3060\u3063\u305f\u308a\u3057\u307e\u3057\u305f\u304c\u3001\u73fe\u5728\u306f \u4f55\u3089\u304b\u306e\u975e\u7dda\u5f62\u306a\u95a2\u6570 3 \u304c\u4f7f\u308f\u308c\u307e\u3059\u3002\n\u307e\u305f\u3001\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u5185\u306e\u3059\u3079\u3066\u3067\u540c\u3058\u3082\u306e\u3092\u4f7f\u3046\u5fc5\u8981\u306f\u306a\u304f\u3001\u4f8b\u3048\u3070\u96a0\u308c\u5c64\u3068\u51fa\u529b\u5c64\u3067\u7570\u306a\u308b\u6d3b\u6027\u5316\u95a2\u6570\u3092\u4f7f\u3046\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\u3061\u306a\u307f\u306b $\\text{(3)}$ \u306f\u3001\u5e38\u306b 1 \u3092\u51fa\u529b\u3059\u308b\u30ce\u30fc\u30c9\u3092\u8ffd\u52a0\u3067\u7528\u610f\u3057\u3001\u30d0\u30a4\u30a2\u30b9\u3092\u305d\u306e\u30ce\u30fc\u30c9\u306b\u5bfe\u3059\u308b\u91cd\u307f\u3068\u3057\u3066\u8003\u3048\u308b\u3053\u3068\u3067\u3001\u30d0\u30a4\u30a2\u30b9\u9805\u3092\u53d6\u308a\u6255\u3046\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\\begin{align}\n\\boldsymbol{l'}^{(k)} &= \\begin{bmatrix}\n    1 \\\\\n    \\boldsymbol{l}^{(k)}\n\\end{bmatrix} = \\begin{bmatrix}\n    1 \\\\\n    l_1^{(k)} \\\\\n    l_2^{(k)} \\\\\n    l_3^{(k)} \\\\\n    \\vdots\n\\end{bmatrix} \\\\\n\\boldsymbol{W'}^{(k)} &= \\begin{bmatrix}\n    \\boldsymbol{b}^{(k)} & \\boldsymbol{W}^{(k)}\n\\end{bmatrix} = \\begin{bmatrix}\n    b_1^{(k)} & W_{11}^{(k)} & W_{12}^{(k)} & W_{13}^{(k)} & \\cdots \\\\\n    b_2^{(k)} & W_{21}^{(k)} & W_{22}^{(k)} & W_{23}^{(k)} & \\cdots \\\\\n    b_3^{(k)} & W_{31}^{(k)} & W_{32}^{(k)} & W_{33}^{(k)} & \\cdots \\\\\n    \\vdots & \\vdots & \\vdots & \\vdots & \\ddots\n\\end{bmatrix} \\\\\n\\\\\n\\boldsymbol{l}^{(k+1)} &= \\sigma^{(k+1)}(\\boldsymbol{W'}^{(k+1)} \\boldsymbol{l'}^{(k)}) \\tag{3'}\n\\end{align}\n\n\u66f8\u7c4d\u3084\u30a6\u30a7\u30d6\u30b5\u30a4\u30c8\u306b\u3088\u3063\u3066\u306f $\\text{(3')}$ \u306e\u5f62\u3067\u66f8\u304b\u308c\u308b\u3053\u3068\u3082\u3042\u308a\u307e\u3059\u304c\u3001\u672c\u8cea\u7684\u306b\u306f\u540c\u3058\u3082\u306e\u3067\u3059\u3002\n\n\u5b66\u7fd2\u306e\u6226\u7565\n\u5148\u307b\u3069\u66f8\u3044\u305f\u3088\u3046\u306b\u3001\u30cb\u30e5\u30fc\u30e9\u30eb\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306b\u304a\u3051\u308b\u300c\u5b66\u7fd2\u300d\u3068\u306f\u3001\u51fa\u529b\u5c64\u304c\u6b63\u3057\u3044\u5024\u3068\u306a\u308b\u3088\u3046\u306b\u3001\u30d1\u30e9\u30e1\u30fc\u30bf\u3001\u3059\u306a\u308f\u3061 \u91cd\u307f \u3068 \u30d0\u30a4\u30a2\u30b9 \u3092\u4fee\u6b63\u3057\u3066\u3044\u304f\u4f5c\u696d\u306e\u3053\u3068\u3067\u3059\u3002\n\u8aa4\u5dee\u9006\u4f1d\u64ad\u6cd5\u306b\u304a\u3044\u3066\u306f\u3001\u30cb\u30e5\u30fc\u30e9\u30eb\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306b\u5bfe\u3057\u3066\u300c\u640d\u5931\u95a2\u6570 (loss function)\u300d (\u3042\u308b\u3044\u306f\u300c\u30b3\u30b9\u30c8\u95a2\u6570 (cost function)\u300d) \u3068\u3044\u3046\u3001\u7c21\u5358\u306b\u3044\u3048\u3070 \u201c\u51fa\u529b\u5c64\u306e\u5024\u304c\u3069\u308c\u3060\u3051\u6b63\u3057\u3044\u72b6\u614b\u3001\u671b\u307e\u308c\u3066\u3044\u308b\u72b6\u614b\u304b\u3089\u96e2\u308c\u3066\u3044\u308b\u304b\u201d \u3092\u8868\u3059\u95a2\u6570\u3092\u5b9a\u3081\u3066\u3001\u6700\u6025\u964d\u4e0b\u6cd5\u3092\u7528\u3044\u3066\u3053\u308c\u3092\u6700\u5c0f\u5316\u3059\u308b\u6700\u9069\u5316\u554f\u984c\u306b\u5e30\u7740\u3055\u305b\u307e\u3059\u3002\n\u306a\u304a\u3001\u6700\u9069\u5316\u554f\u984c\u306e\u5bfe\u8c61\u3068\u306a\u308b\u95a2\u6570\u3092\u300c\u76ee\u7684\u95a2\u6570 (objective function)\u300d\u3068\u3088\u3076\u305f\u3081\u3001\u305d\u3061\u3089\u306e\u540d\u79f0\u304c\u4f7f\u308f\u308c\u308b\u3053\u3068\u3082\u3042\u308a\u307e\u3059\u304c\u3001\u3053\u306e\u8a18\u4e8b\u3067\u306f\u300c\u640d\u5931\u95a2\u6570\u300d\u3067\u7d71\u4e00\u3057\u307e\u3059\u3002\n\u3053\u306e\u8a18\u4e8b\u3067\u306f\u3001\u5b66\u7fd2\u306b\u4f7f\u3046\u30c7\u30fc\u30bf\u306b\u3001\u5165\u529b\u3068\u3001\u305d\u308c\u306b\u5bfe\u3057\u3066 \u671b\u307e\u308c\u308b\u51fa\u529b \u304c\u30bb\u30c3\u30c8\u3067\u7528\u610f\u3055\u308c\u3066\u3044\u308b\u300c\u6559\u5e2b\u3042\u308a\u5b66\u7fd2 (supervised learning)\u300d\u3092\u53d6\u308a\u4e0a\u3052\u307e\u3059\u3002\n\u305f\u3060\u3057\u8aa4\u89e3\u3057\u306a\u3044\u3067\u3044\u305f\u3060\u304d\u305f\u3044\u306e\u3067\u3059\u304c\u3001\u6559\u5e2b\u3042\u308a\u5b66\u7fd2\u3067\u306a\u3051\u308c\u3070\u8aa4\u5dee\u9006\u4f1d\u64ad\u6cd5\u3092\u9069\u7528\u3067\u304d\u306a\u3044\u308f\u3051\u3067\u306f\u3042\u308a\u307e\u305b\u3093\u3002\n\u8aa4\u5dee\u9006\u4f1d\u64ad\u6cd5\u306f\u3001\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306e\u640d\u5931\u95a2\u6570\u3092\u5b9a\u3081\u308b\u3053\u3068\u304c\u3067\u304d\u3001\u305d\u306e\u95a2\u6570\u3092\u4f7f\u3063\u3066\u91cd\u307f\u3068\u30d0\u30a4\u30a2\u30b9\u3092\u4fee\u6b63\u3067\u304d\u308c\u3070\u3088\u304f\u3001\u6559\u5e2b\u3042\u308a\u5b66\u7fd2\u3067\u3042\u308b\u5fc5\u8981\u306f\u3042\u308a\u307e\u305b\u3093\u3002\n\n\u640d\u5931\u95a2\u6570\u3092\u7acb\u3066\u308b\n\u8a71\u3092\u623b\u3057\u3066\u3001\u6559\u5e2b\u3042\u308a\u5b66\u7fd2\u306f\u5165\u529b\u306b\u5bfe\u3057\u3066 \u201c\u671b\u307e\u308c\u308b\u51fa\u529b\u201d (\u3053\u308c\u3092\u300c\u6559\u5e2b\u4fe1\u53f7 (supervisory signal)\u300d\u3068\u3044\u3044\u307e\u3059) \u3092\u51fa\u305b\u308b\u3088\u3046\u3001\u30cb\u30e5\u30fc\u30e9\u30eb\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u3092\u5b66\u7fd2\u3059\u308b\u65b9\u6cd5\u3067\u3059\u304c\u3001\u5f53\u7136\u306a\u304c\u3089\u3001\u5b66\u7fd2\u3092\u884c\u3063\u3066\u3044\u306a\u3044\u521d\u671f\u72b6\u614b\u306e\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306e\u51fa\u529b\u306f\u3001\u3075\u3064\u3046\u6559\u5e2b\u4fe1\u53f7\u3068\u306f\u9060\u304f\u304b\u3051\u96e2\u308c\u305f\u3082\u306e\u3068\u306a\u308b\u306f\u305a\u3067\u3059\u3002\n\u3053\u306e \u201c\u3069\u308c\u304f\u3089\u3044\u304b\u3051\u96e2\u308c\u3066\u3044\u308b\u304b\u201d \u3092\u3069\u3046\u306b\u304b\u3057\u3066\u5f0f\u3067\u8868\u3057\u3001\u640d\u5931\u95a2\u6570\u3068\u3059\u308b\u306e\u3067\u3059\u304c\u3001\u4f8b\u3048\u3070\u5206\u304b\u308a\u3084\u3059\u3044\u3082\u306e\u3068\u3057\u3066\u300c2 \u6b21\u640d\u5931\u95a2\u6570 (quadratic loss function)\u300d (\u3042\u308b\u3044\u306f\u300c2 \u4e57\u548c\u8aa4\u5dee (sum-of-squares error)\u300d\u3084\u300c\u6b8b\u5dee\u5e73\u65b9\u548c (residual sum of squares)\u300d\u3068\u3082\u3088\u3070\u308c\u307e\u3059) \u304c\u3042\u308a\u307e\u3059\u3002\n\\begin{align}\nL &= (o_1 - T_1)^2 + (o_2 - T_2)^2 + \\cdots + (o_N - T_N)^2 \\\\\n&= \\sum_{n=1}^N (o_n - T_n)^2 \\\\\n&= \\| \\boldsymbol{o} - \\boldsymbol{T} \\|^2\n\\end{align} \\tag{4}\n\n\u3053\u3053\u3067 $\\boldsymbol{o} = (o_1, o_2, \\dots, o_N)$ \u306f\u30cb\u30e5\u30fc\u30e9\u30eb\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306e\u51fa\u529b\u5c64\u306e\u5024\u3067\u3042\u308a\u3001$\\boldsymbol{T} = (T_1, T_2, \\dots, T_N)$ \u306f\u6559\u5e2b\u4fe1\u53f7\u3067\u3059\u3002$\\|\\cdots\\|$ \u306f\u30d9\u30af\u30c8\u30eb\u306e\u30ce\u30eb\u30e0 4 \u3092\u8868\u3057\u307e\u3059\u3002\n\u6559\u5e2b\u4fe1\u53f7\u3068\u306e\u5dee\u306e 2 \u4e57\u548c\u3092\u640d\u5931\u3068\u3059\u308b\u3053\u3068\u306f\u3001\u76f4\u611f\u7684\u306b\u3082\u7406\u306b\u304b\u306a\u3063\u305f\u3082\u306e\u3067\u3042\u308b\u3068\u601d\u3044\u307e\u3059\u3002\n2 \u4e57\u3057\u305f\u3082\u306e\u3092\u8db3\u3057\u3066\u3044\u304f\u308f\u3051\u3067\u3059\u304b\u3089\u3001$L$ \u306f\u5fc5\u305a 0 \u4ee5\u4e0a\u306b\u306a\u308a\u307e\u3059\u3057\u3001\u51fa\u529b\u5024\u3068\u6559\u5e2b\u4fe1\u53f7\u304c\u96e2\u308c\u308c\u3070\u96e2\u308c\u308b\u307b\u3069\u640d\u5931\u304c\u5927\u304d\u3044\u3068\u5224\u65ad\u3055\u308c\u307e\u3059\u3002\n\u305d\u3057\u3066\u3001\u51fa\u529b\u5024\u3068\u6559\u5e2b\u4fe1\u53f7\u304c\u3074\u3063\u305f\u308a\u3068\u4e00\u81f4\u3059\u308b\u3068\u304d\u306b\u640d\u5931\u306f\u6700\u5c0f\u3068\u306a\u308a\u3001$L$ \u306f\u6700\u5c0f\u5024 0 \u3068\u306a\u308a\u307e\u3059\u3002\n\u3053\u306e\u640d\u5931\u95a2\u6570 $L$ \u306f\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306e\u51fa\u529b\u5c64\u306e\u5024 $\\boldsymbol{o}$ \u3092\u5909\u6570\u306b\u3068\u308a\u307e\u3059\u304c\u3001\u3053\u308c\u306f\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u5185\u306e\u3059\u3079\u3066\u306e\u91cd\u307f\u3068\u30d0\u30a4\u30a2\u30b9\u306b\u3088\u3063\u3066\u8a08\u7b97\u3055\u308c\u305f\u5024\u3067\u3059\u304b\u3089\u3001\u3064\u307e\u308b\u3068\u3053\u308d\u3001$L$ \u306f\u3059\u3079\u3066\u306e\u91cd\u307f\u3068\u30d0\u30a4\u30a2\u30b9\u3092\u5909\u6570\u306b\u3068\u308b\u3053\u3068\u3092\u610f\u5473\u3057\u307e\u3059\u3002\n\u3088\u3063\u3066\u3001$L$ \u306b\u5bfe\u3059\u308b\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u5185\u306e\u4efb\u610f\u306e\u91cd\u307f\u3001\u30d0\u30a4\u30a2\u30b9\u306e\u504f\u5fae\u5206\u3092\u6c42\u3081\u308b\u3053\u3068\u304c\u3067\u304d\u308c\u3070\u3001\u6700\u6025\u964d\u4e0b\u6cd5\u3092\u4f7f\u3046\u3053\u3068\u3067\u91cd\u307f\u3068\u30d0\u30a4\u30a2\u30b9\u3092\u4fee\u6b63\u3057\u3066\u3001\u7d50\u679c\u3068\u3057\u3066\u640d\u5931\u95a2\u6570\u3092\u6700\u5c0f\u5316\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u308b\u306f\u305a\u3067\u3059\u3002\n\u3061\u306a\u307f\u306b\u640d\u5931\u95a2\u6570\u3092\u3046\u307e\u304f\u5b9a\u3081\u308b\u3068\u3001\u53ce\u675f\u3092\u65e9\u3081\u305f\u308a\u3001\u30b9\u30d1\u30fc\u30b9\u6027 5 \u3092\u9ad8\u3081\u305f\u308a\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u304c\u3001\u9ad8\u5ea6\u306a\u5185\u5bb9\u3068\u306a\u308a\u307e\u3059\u3057\u3001\u81ea\u5206\u3082\u307e\u3060\u52c9\u5f37\u304c\u8db3\u308a\u3066\u3044\u306a\u3044\u3068\u3053\u308d\u3067\u3059\u306e\u3067\u3001\u307e\u305f\u3044\u305a\u308c\u3002\n\n\u3059\u3079\u3066\u306e\u5165\u529b\u3092\u8003\u616e\u3057\u305f\u640d\u5931\u95a2\u6570\n\u524d\u7bc0\u306e $\\text{(4)}$ \u3067 2 \u6b21\u640d\u5931\u95a2\u6570\u3092\u7d39\u4ecb\u3057\u307e\u3057\u305f\u304c\u3001\u3053\u306e\u3068\u304d\u3001\u51fa\u529b\u5024 $\\boldsymbol{o}$ \u3068\u6559\u5e2b\u4fe1\u53f7 $\\boldsymbol{T}$ \u306f\u5165\u529b\u3054\u3068\u306b\u7570\u306a\u308b\u3082\u306e\u3067\u3059\u304b\u3089\u3001\u640d\u5931\u95a2\u6570\u3082\u5165\u529b\u3054\u3068\u306b\u7b97\u51fa\u3055\u308c\u307e\u3059\u3002\n\u3088\u3063\u3066\u30012 \u6b21\u640d\u5931\u95a2\u6570\u3092\u3082\u3046\u5c11\u3057\u6b63\u78ba\u306b\u66f8\u3051\u3070\u3001$k$ \u756a\u76ee\u306e\u5165\u529b\u306b\u5bfe\u3057\u3066\u3001\n\\begin{align}\nL^{(k)} &= (o_1^{(k)} - T_1^{(k)})^2 + (o_2^{(k)} - T_2^{(k)})^2 + \\cdots + (o_N^{(k)} - T_N^{(k)})^2 \\\\\n&= \\sum_{n=1}^N (o_n^{(k)} - T_n^{(k)})^2 \\\\\n&= \\| \\boldsymbol{o}^{(k)} - \\boldsymbol{T}^{(k)} \\|^2\n\\end{align}\n\n\u3068\u8868\u3059\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\u30cb\u30e5\u30fc\u30e9\u30eb\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306e\u91cd\u307f\u3068\u30d0\u30a4\u30a2\u30b9\u306f\u3001\u3059\u3079\u3066\u306e\u5165\u529b\u306b\u5bfe\u3057\u3066\u5171\u901a\u306b\u4f7f\u308f\u308c\u308b\u30d1\u30e9\u30e1\u30fc\u30bf\u3067\u3059\u304b\u3089\u3001\u500b\u5225\u306e\u5165\u529b\u306b\u5bfe\u3059\u308b\u640d\u5931\u95a2\u6570\u3067\u306f\u306a\u304f\u3001\u3059\u3079\u3066\u306e\u5165\u529b\u3092\u8003\u616e\u3057\u305f\u3001\u3044\u308f\u3070\u30cb\u30e5\u30fc\u30e9\u30eb\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306e\u300c\u5168\u4f53\u640d\u5931\u95a2\u6570\u300d6 \u304c\u5fc5\u8981\u306b\u306a\u308a\u307e\u3059\u3002\n\u3053\u3053\u3067\u306f\u3001\u5165\u529b\u306e\u7dcf\u6570\u3092 $K$ \u3068\u3057\u3066\u3001\u5404\u5165\u529b\u306b\u5bfe\u3059\u308b\u640d\u5931\u95a2\u6570 $L^{(k)}\\ \\small{(k \\in 1, 2, \\dots, K)}$ \u3092\u4f7f\u3063\u3066\u5168\u4f53\u640d\u5931\u95a2\u6570 $L^{(all)}$ \u3092\u6c42\u3081\u3066\u307f\u307e\u3057\u3087\u3046\u3002\n\u6c7a\u3081\u65b9\u306f\u8272\u3005\u3042\u308b\u3068\u601d\u3044\u307e\u3059\u304c\u3001\u96e3\u3057\u304f\u8003\u3048\u308b\u5fc5\u8981\u306f\u3042\u308a\u307e\u305b\u3093\u3002\u4f8b\u3048\u3070\u5404\u5165\u529b\u306b\u5bfe\u3059\u308b\u640d\u5931\u95a2\u6570\u306e \u7dcf\u548c \u3068\u3057\u3066\u306f\u3069\u3046\u3067\u3057\u3087\u3046\u304b\u3002\nL^{(all)} = L^{(1)} + L^{(2)} + \\cdots + L^{(k)} + \\cdots = \\sum_{k=1}^K L^{(k)} \\tag{5}\n\n2 \u6b21\u640d\u5931\u95a2\u6570\u306f $L^{(k)} \\ge 0$ \u304c\u6210\u308a\u7acb\u3064\u308f\u3051\u3067\u3059\u304b\u3089\u3001\u3053\u306e\u3088\u3046\u306b\u3057\u3066\u3082\u554f\u984c\u306f\u306a\u3044\u308f\u3051\u3067\u3059\u3002\n\u9006\u306b\u3001\u640d\u5931\u95a2\u6570\u304c\u8ca0\u306e\u5024\u306b\u306a\u308b\u3053\u3068\u304c\u3042\u308b\u306a\u3069\u3001$\\text{(5)}$ \u304c\u9069\u7528\u3067\u304d\u306a\u3044\u30b1\u30fc\u30b9\u304c\u3042\u308b\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u3002\u305d\u306e\u3068\u304d\u306f\u9069\u5207\u306a\u7acb\u5f0f\u304c\u5fc5\u8981\u3067\u3059\u3002\n\u3055\u3066\u3001\u4eca\u56de\u306f\u3053\u308c\u3067\u554f\u984c\u306a\u3044\u3068\u3057\u3066\u3001\u3044\u307e\u3001\u5168\u4f53\u640d\u5931\u95a2\u6570 $L^{(all)}$ \u3092\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u5185\u306e\u3068\u3042\u308b\u91cd\u307f\u3082\u3057\u304f\u306f\u30d0\u30a4\u30a2\u30b9 $w$ \u3067\u504f\u5fae\u5206\u3059\u308b\u3001\u3064\u307e\u308a $\\partial L^{(all)}/\\partial w$ \u3092\u6c42\u3081\u308b\u3053\u3068\u3092\u8003\u3048\u307e\u3059\u3002\n\u307e\u305a\u3001$L^{(all)}$ \u304c\u5404\u5165\u529b\u306b\u5bfe\u3059\u308b\u640d\u5931\u95a2\u6570 $L^{(k)}$ \u3092\u5909\u6570\u306b\u3068\u308b\u3053\u3068\u306f $\\text{(5)}$ \u304b\u3089\u660e\u3089\u304b\u3067\u3059\u3002\n\u305d\u3057\u3066 $L^{(k)}$ \u304c\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u5185\u306e\u3059\u3079\u3066\u306e\u91cd\u307f\u3001\u30d0\u30a4\u30a2\u30b9\u3092\u5909\u6570\u306b\u3068\u308b\u3053\u3068\u306f\u524d\u7bc0\u3067\u66f8\u304d\u307e\u3057\u305f\u3002\u3064\u307e\u308a $L^{(k)}$ \u306f $k = 1, 2, \\dots, K$ \u306e\u305d\u308c\u305e\u308c\u306b\u304a\u3044\u3066 $w$ \u3092\u5909\u6570\u306b\u3068\u308a\u307e\u3059\u3002\n\u3053\u3053\u3067\u300c\u9023\u9396\u5f8b\u300d\u306e\u51fa\u756a\u304c\u3084\u3063\u3066\u304d\u307e\u3059\u3002$\\text{(1)}$, $\\text{(5)}$ \u304b\u3089\u4ee5\u4e0b\u306e $\\text{(6)}$ \u3092\u5c0e\u304f\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\\begin{align}\n\\frac{\\partial L^{(all)}}{\\partial w} &= \\frac{\\partial L^{(all)}}{\\partial L^{(1)}}\\cdot\\frac{\\partial L^{(1)}}{\\partial w} + \\frac{\\partial L^{(all)}}{\\partial L^{(2)}}\\cdot\\frac{\\partial L^{(2)}}{\\partial w} + \\cdots + \\frac{\\partial L^{(all)}}{\\partial L^{(K)}}\\cdot\\frac{\\partial L^{(K)}}{\\partial w} \\\\\n&= \\frac{\\partial L^{(1)}}{\\partial w} + \\frac{\\partial L^{(2)}}{\\partial w} + \\cdots + \\frac{\\partial L^{(K)}}{\\partial w}\\ \\left( \\because \\frac{\\partial L^{(all)}}{\\partial L^{(k)}} = 1\\ (k \\in 1, 2, \\dots, K) \\right) \\\\\n&= \\sum_{k=1}^{K} \\frac{\\partial L^{(k)}}{\\partial w}\n\\end{align} \\tag{6}\n\n\u8a08\u7b97\u306f\u5c0f\u96e3\u3057\u304f\u898b\u3048\u308b\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u304c\u3001\u51fa\u3066\u304d\u305f\u7d50\u679c\u306f\u30b7\u30f3\u30d7\u30eb\u306a\u3082\u306e\u3067\u3001\u5404\u5165\u529b\u3054\u3068\u306b\u640d\u5931\u95a2\u6570\u304b\u3089\u504f\u5fae\u5206 ($\\partial L^{(k)}/\\partial w$) \u3092\u6c42\u3081\u3066\u3001\u305d\u308c\u3092\u5408\u8a08\u3059\u308b\u3068\u5168\u4f53\u306e\u504f\u5fae\u5206 ($\\partial L^{(all)}/\\partial w$) \u306b\u306a\u308b\u3053\u3068\u304c\u5206\u304b\u308a\u307e\u3057\u305f\u3002\n\u3061\u306a\u307f\u306b\u3001\u3053\u306e\u8a18\u4e8b\u3067\u306f\u5168\u4f53\u640d\u5931\u95a2\u6570\u306f\u5404\u5165\u529b\u306b\u5bfe\u3059\u308b\u640d\u5931\u95a2\u6570\u306e \u7dcf\u548c \u3068\u3057\u3066\u3044\u307e\u3059\u304c\u3001\u5e73\u5747 \u3092\u63a1\u7528\u3059\u308b\u3053\u3068\u3082\u3067\u304d\u307e\u3059\u3002\nL^{(all)} = \\frac{1}{K} ( L^{(1)} + L^{(2)} + \\cdots + L^{(k)} + \\cdots ) = \\frac{1}{K} \\sum_{k=1}^K L^{(k)}\n\n\u3053\u308c\u3092\u540c\u69d8\u306b $w$ \u3067\u504f\u5fae\u5206\u3059\u308b\u3068\u3001\n\\frac{\\partial L^{(all)}}{\\partial w} = \\frac{1}{K} \\sum_{k=1}^{K} \\frac{\\partial L^{(k)}}{\\partial w}\\ \\left( \\because \\frac{\\partial L^{(all)}}{\\partial L^{(k)}} = \\frac{1}{K} \\right)\n\n\u3068\u306a\u308a\u3001\u5404\u5165\u529b\u3054\u3068\u306e\u640d\u5931\u95a2\u6570\u306e\u504f\u5fae\u5206\u306e\u5e73\u5747\u304c\u3001\u5168\u4f53\u306e\u504f\u5fae\u5206\u3068\u306a\u308a\u307e\u3059\u3002\n\u5e73\u5747\u3092\u3068\u308b\u308f\u3051\u3067\u3059\u304b\u3089\u3001\u7dcf\u548c \u306e\u5168\u4f53\u640d\u5931\u95a2\u6570\u3092\u63a1\u7528\u3057\u305f\u3068\u304d\u3068\u6bd4\u3079\u3066\u3001\u6700\u6025\u964d\u4e0b\u6cd5\u306b\u3088\u308b\u4fee\u6b63\u91cf\u306f\u5c0f\u3055\u304f\u306a\u308a\u307e\u3059\u3002\u3057\u304b\u3057\u3053\u308c\u306f\u4fc2\u6570 $\\eta$ \u3067\u8abf\u7bc0\u3067\u304d\u307e\u3059\u306e\u3067\u3001\u3053\u308c\u3060\u3051\u3067\u3069\u3061\u3089\u304c\u6709\u5229\u30fb\u4e0d\u5229\u3068\u3044\u3046\u3053\u3068\u306f\u3044\u3048\u307e\u305b\u3093\u3002\n\u3053\u308c\u4ee5\u964d\u306f\u3001\u5404\u5165\u529b\u306b\u5bfe\u3059\u308b\u640d\u5931\u95a2\u6570\u306f\u5358\u306b $L$ \u3068\u3057\u3066\u3001$(k)$ \u3092\u80a9\u306b\u4e57\u305b\u305a\u306b\u8868\u3059\u3053\u3068\u306b\u3057\u307e\u3059\u3002$\\TeX$ \u8a18\u6cd5\u3082\u9577\u304f\u306a\u3063\u3066\u3057\u307e\u3044\u307e\u3059\u3057\u306d\u3002\n\n\u8aa4\u5dee\u9006\u4f1d\u64ad\u6cd5\u306b\u3088\u308b\u5b66\u7fd2\u306e\u5b9f\u4f8b - \u534a\u52a0\u7b97\u5668\n\u3053\u3053\u307e\u3067\u3067\u5fc5\u8981\u306a\u4e8b\u524d\u77e5\u8b58\u306f\u3059\u3079\u3066\u63c3\u3063\u305f\u306e\u3067\u3001\u8aa4\u5dee\u9006\u4f1d\u64ad\u6cd5\u306e\u4e00\u822c\u5f0f\u3092\u66f8\u3044\u3066\u3082\u3088\u3044\u306e\u3067\u3059\u304c\u3001\u305d\u306e\u524d\u306b\u5358\u7d14\u306a\u5b9f\u4f8b\u3068\u3057\u3066\u3001\u300c\u534a\u52a0\u7b97\u5668 (half adder)\u300d\u3092\u5b66\u7fd2\u3055\u305b\u3066\u307f\u307e\u3059\u3002\n\u3042\u304f\u307e\u3067\u5b9f\u4f8b\u3067\u3059\u3057\u3001\u4e0d\u8981\u306a\u65b9\u306f\u8aad\u307f\u98db\u3070\u3057\u3066\u2026\u3044\u305f\u3060\u3044\u3066\u3082\u3088\u3044\u306e\u3067\u3059\u304c\u3001\u8aa4\u5dee\u9006\u4f1d\u64ad\u6cd5\u3092\u4e00\u822c\u5316\u3057\u305f\u5f0f\u306f\u4e00\u898b\u3059\u308b\u3068\u975e\u5e38\u306b\u5206\u304b\u308a\u3065\u3089\u3044\u8868\u8a18\u3067\u3059\u306e\u3067\u3001\u3053\u3061\u3089\u306b\u3082\u76ee\u3092\u901a\u3057\u3066\u3044\u305f\u3060\u3044\u305f\u307b\u3046\u304c\u7406\u89e3\u306f\u9032\u3080\u3068\u601d\u3044\u307e\u3059\u3002\n\n\u6982\u8981\u3068\u30cb\u30e5\u30fc\u30e9\u30eb\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u3067\u306e\u8868\u73fe\n\u534a\u52a0\u7b97\u5668\u306f\u30012 \u3064\u306e\u5165\u529b A, B \u3092\u53d7\u3051\u53d6\u308a\u3001\u4ee5\u4e0b\u306e\u8868\u306b\u3057\u305f\u304c\u3063\u3066 2 \u3064\u306e\u51fa\u529b S, C \u3092\u9001\u308a\u51fa\u3059\u88c5\u7f6e\u3067\u3059\u3002\n\u3082\u3046\u5c11\u3057\u8e0f\u307f\u8fbc\u3093\u3067\u8a00\u3048\u3070\u30012 \u3064\u306e\u5165\u529b A, B \u304c 1 \u3067\u3042\u308b\u3082\u306e\u306e\u6570\u3092\u30012 \u30d3\u30c3\u30c8 CS \u3067\u8868\u3059\u88c5\u7f6e\u3067\u3059\u3002\n\n\n\nin A\n\nin B\n\nout S\n\nout C\n\n\n\n\n\n0\n0\n0\n0\n\n\n0\n1\n1\n0\n\n\n1\n0\n1\n0\n\n\n1\n1\n0\n1\n\n\n\n\u4e0a\u306e\u771f\u7406\u5024\u8868\u3092\u898b\u308b\u3068\u3001S \u306f A \u3068 B \u306e \u6392\u4ed6\u7684\u8ad6\u7406\u548c ($S = A \\veebar B$)\u3001C \u306f \u8ad6\u7406\u7a4d ($C = A \\wedge B$) \u3068\u3057\u3066\u8868\u305b\u308b\u3053\u3068\u304c\u308f\u304b\u308a\u307e\u3059\u3002\n\u4eca\u56de\u306f\u3053\u306e\u534a\u52a0\u7b97\u5668\u3092\u3001\u5165\u529b\u5c64 2 \u6b21\u5143 (A, B)\u3001\u96a0\u308c\u5c64 3 \u6b21\u5143\u3001\u51fa\u529b\u5c64 2 \u6b21\u5143 (S, C) \u306e 3 \u5c64\u30cb\u30e5\u30fc\u30e9\u30eb\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u3067\u5b66\u7fd2\u3055\u305b\u3066\u307f\u307e\u3057\u3087\u3046\u30027\n\u96a0\u308c\u5c64\u306e\u6b21\u5143\u6570\u306f\u3001\u3053\u306e\u8a18\u4e8b\u3067\u306f\u8aac\u660e\u306e\u305f\u3081\u306b 3 \u6b21\u5143\u306b\u3057\u3066\u3044\u307e\u3059\u304c\u3001\u8208\u5473\u304c\u3042\u308c\u3070\u6b21\u5143\u6570\u3092\u5909\u3048\u305f\u3068\u304d\u306b\u3069\u3046\u306a\u308b\u306e\u304b\u3001\u8a66\u3057\u3066\u307f\u3066\u304f\u3060\u3055\u3044\u3002\n\n\u5404\u5c64\u306e\u5024\u306e\u8a08\u7b97\u5f0f\u3067\u3059\u304c\u3001$\\text{(3)}$ \u3067\u306f\u5404\u5c64\u306e\u5024\u3092 $\\boldsymbol{l}^{(k)}$ \u3067\u8868\u3057\u307e\u3057\u305f\u304c\u3001\u3053\u306e\u4f8b\u3067\u306f 3 \u5c64\u3067\u3059\u304b\u3089\u3001\u3082\u3063\u3068\u7c21\u5358\u306b\u3001\u5165\u529b\u5c64\u3092 $\\boldsymbol{x} = (x_1, x_2)$\u3001\u96a0\u308c\u5c64\u3092 $\\boldsymbol{y} = (y_1, y_2, y_3)$\u3001\u51fa\u529b\u5c64\u3092 $\\boldsymbol{z} = (z_1, z_2)$ \u3068\u8868\u3059\u3053\u3068\u306b\u3057\u307e\u3057\u3087\u3046\u3002\n\\begin{align}\n\\boldsymbol{x} &= (x_1, x_2) = \\{ (0, 0), (0, 1), (1, 0), (1, 1) \\} \\tag{7} \\\\\n\\\\\n\\boldsymbol{I_y} &= (I_{y_1}, I_{y_2}, I_{y_3}) = \\boldsymbol{W_y} \\boldsymbol{x} + \\boldsymbol{b_y} \\tag{8} \\\\\n&\\ \\ \\left|\n    \\begin{array}{l}\n    \\ I_{y_1} = W_{y_{11}} x_1 + W_{y_{12}} x_2 + b_{y_1} \\\\\n    \\ I_{y_2} = W_{y_{21}} x_1 + W_{y_{22}} x_2 + b_{y_2} \\\\\n    \\ I_{y_3} = W_{y_{31}} x_1 + W_{y_{32}} x_2 + b_{y_3}\n    \\end{array}\n\\right. \\\\\n\\boldsymbol{y} &= (y_1, y_2, y_3) = \\sigma_y( \\boldsymbol{I_y} ) \\tag{9} \\\\\n\\\\\n\\boldsymbol{I_z} &= (I_{z_1}, I_{z_2}) = \\boldsymbol{W_z} \\boldsymbol{y} + \\boldsymbol{b_z} \\tag{10} \\\\\n&\\ \\ \\left|\n    \\begin{array}{l}\n    \\ I_{z_1} = W_{z_{11}} y_1 + W_{z_{12}} y_2 + W_{z_{13}} y_3 + b_{z_1} \\\\\n    \\ I_{z_2} = W_{z_{21}} y_1 + W_{z_{22}} y_2 + W_{z_{23}} y_3 + b_{z_2}\n    \\end{array}\n\\right. \\\\\n\\boldsymbol{z} &= (z_1, z_2) = \\sigma_z( \\boldsymbol{I_z} ) \\tag{11}\n\\end{align}\n\n$\\text{(3)}$ \u306f\u91cd\u307f\u3068\u30d0\u30a4\u30a2\u30b9\u3001\u6d3b\u6027\u5316\u95a2\u6570\u3092\u4e00\u6c17\u306b\u9069\u7528\u3057\u305f\u3082\u306e\u3067\u3057\u305f\u304c\u3001\u3053\u308c\u304b\u3089\u504f\u5fae\u5206\u306e\u5f0f\u3092\u8003\u3048\u3066\u3044\u304f\u95a2\u4fc2\u3067\u3001\u9014\u4e2d\u306b $\\boldsymbol{I_y}$ \u3068 $\\boldsymbol{I_z}$ \u3092\u631f\u307f\u307e\u3057\u305f\u3002\u7b49\u4fa1\u306a\u5f0f\u3067\u3042\u308b\u3053\u3068\u306f\u304a\u5206\u304b\u308a\u3044\u305f\u3060\u3051\u308b\u3068\u601d\u3044\u307e\u3059\u3002\n\u307e\u305f\u3001$\\text{(7)}$ \u304a\u3088\u3073 $\\text{(11)}$ \u306b\u304a\u3044\u3066\u3001\u5165\u529b\u5c64\u306e\u6b21\u5143\u306f $x_1$ \u304c $A$\u3001$x_2$ \u304c $B$ \u306b\u5bfe\u5fdc\u3057\u3001\u51fa\u529b\u5c64\u306e\u6b21\u5143\u306f $z_1$ \u304c $S$\u3001$z_2$ \u304c $C$ \u306b\u5bfe\u5fdc\u3059\u308b\u3082\u306e\u3068\u3057\u307e\u3059\u3002\n\u640d\u5931\u95a2\u6570 $L$ \u304a\u3088\u3073\u6d3b\u6027\u5316\u95a2\u6570 $\\sigma_y, \\sigma_z$ \u306f\u3053\u3053\u3067\u306f \u3042\u3048\u3066 \u5b9a\u3081\u305a\u3001\u6700\u5f8c\u306b\u5177\u4f53\u4f8b\u3068\u3057\u3066\u63d0\u793a\u3057\u307e\u3059\u3002\n\n\u51fa\u529b\u5c64\u306e\u91cd\u307f\u30fb\u30d0\u30a4\u30a2\u30b9\u306e\u504f\u5fae\u5206\n\u3067\u306f\u307e\u305a\u3001\u640d\u5931\u95a2\u6570\u306b\u5bfe\u3059\u308b\u51fa\u529b\u5c64\u306e\u91cd\u307f\u3001\u30d0\u30a4\u30a2\u30b9\u306e\u504f\u5fae\u5206\u3092\u6c42\u3081\u3066\u3044\u304d\u307e\u3059\u3002\n\u51fa\u529b\u5c64\u304b\u3089\u6c42\u3081\u3066\u3044\u304f\u7406\u7531\u306f\u3001\u30cb\u30e5\u30fc\u30e9\u30eb\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306e\u69cb\u9020\u306b\u3042\u308a\u307e\u3059\u3002\n\u91cd\u307f\u3084\u30d0\u30a4\u30a2\u30b9\u306f\u81ea\u5206\u306e\u5c64\u3068\u3001\u81ea\u5206\u3088\u308a\u3082\u5f8c\u308d\u306e\u5c64\u306e\u5024\u306b\u5f71\u97ff\u3092\u4e0e\u3048\u308b\u305f\u3081\u3001\u504f\u5fae\u5206\u3092\u8003\u3048\u308b\u3068\u304d\u306f\u3001\u91cd\u307f\u3084\u30d0\u30a4\u30a2\u30b9\u306b\u3088\u308b\u305d\u308c\u3089\u306e\u5c64\u306e\u5024\u306e\u5909\u5316\u3092\u3059\u3079\u3066\u8003\u616e\u3057\u306a\u3051\u308c\u3070\u306a\u308a\u307e\u305b\u3093\u3002\u3088\u3063\u3066\u3001\u5f8c\u308d\u306e\u5c64\u304b\u3089\u9032\u3081\u3066\u3044\u304f\u307b\u3046\u304c\u5206\u304b\u308a\u3084\u3059\u3044\u306e\u3067\u3059\u3002\n\u3053\u3053\u304b\u3089\u306f\u9023\u9396\u5f8b\u3082\u5f53\u305f\u308a\u524d\u306e\u3088\u3046\u306b\u4f7f\u3063\u3066\u3044\u304d\u307e\u3059\u306e\u3067\u3001$\\text{(1)}$\u3001$\\text{(7)}$ \uff5e $\\text{(11)}$ \u3068\u306b\u3089\u3081\u3063\u3053\u3057\u306a\u304c\u3089\u3001\u3053\u308c\u304b\u3089\u306e\u5f0f\u306e\u5c0e\u51fa\u3092\u30c1\u30a7\u30c3\u30af\u3057\u3066\u307f\u3066\u304f\u3060\u3055\u3044\u3002\n\u307e\u305a\u306f $z_1$ \u306e\u30d0\u30a4\u30a2\u30b9\u306e\u504f\u5fae\u5206\u304b\u3089\u6c42\u3081\u3066\u3044\u304d\u307e\u3059\u3002\n\\frac{\\partial L}{\\partial b_{z_1}} = \\frac{\\partial L}{\\partial z_1} \\cdot \\frac{\\partial z_1}{\\partial I_{z_1}} \\cdot \\frac{\\partial I_{z_1}}{\\partial b_{z_1}} = \\frac{\\partial L}{\\partial z_1} \\cdot \\sigma_z'(I_{z_1})\\ \\left( \\because \\frac{\\partial I_{z_1}}{\\partial b_{z_1}} = 1 \\right) \\tag{12}\n\n\u640d\u5931\u95a2\u6570\u306e\u504f\u5fae\u5206 ($\\partial L/\\partial z_1$) \u3068\u6d3b\u6027\u5316\u95a2\u6570\u306e\u504f\u5fae\u5206 ($\\partial z_1/\\partial I_{z_1} = \\sigma_z'(I_{z_1})$) \u304c\u5fc5\u8981\u3067\u3059\u304c\u3001\u3044\u307e\u306f\u4e21\u65b9\u3068\u3082\u660e\u3089\u304b\u3067\u306f\u3042\u308a\u307e\u305b\u3093\u306e\u3067\u3001\u73fe\u6642\u70b9\u3067\u3053\u308c\u4ee5\u4e0a\u306f\u7c21\u5358\u306b\u3067\u304d\u307e\u305b\u3093\u3002\n\u305d\u3057\u3066\u3053\u3053\u3067\u3001$\\dfrac{\\partial L}{\\partial b_{z_1}} = \\dfrac{\\partial L}{\\partial z_1} \\cdot \\dfrac{\\partial z_1}{\\partial I_{z_1}}$ \u3067\u3042\u308b\u3053\u3068\u3092\u5229\u7528\u3057\u3066\u3001\n\\begin{align}\n\\frac{\\partial L}{\\partial W_{z_{11}}} &= \\frac{\\partial L}{\\partial z_1} \\cdot \\frac{\\partial z_1}{\\partial I_{z_1}} \\cdot \\frac{\\partial I_{z_1}}{\\partial W_{z_{11}}} = \\frac{\\partial L}{\\partial b_{z_1}} \\cdot y_1 \\tag{13} \\\\\n\\frac{\\partial L}{\\partial W_{z_{12}}} &= \\frac{\\partial L}{\\partial z_1} \\cdot \\frac{\\partial z_1}{\\partial I_{z_1}} \\cdot \\frac{\\partial I_{z_1}}{\\partial W_{z_{12}}} = \\frac{\\partial L}{\\partial b_{z_1}} \\cdot y_2 \\tag{14} \\\\\n\\frac{\\partial L}{\\partial W_{z_{13}}} &= \\frac{\\partial L}{\\partial z_1} \\cdot \\frac{\\partial z_1}{\\partial I_{z_1}} \\cdot \\frac{\\partial I_{z_1}}{\\partial W_{z_{13}}} = \\frac{\\partial L}{\\partial b_{z_1}} \\cdot y_3 \\tag{15}\n\\end{align}\n\n\u3068\u3001\u30d0\u30a4\u30a2\u30b9\u306e\u504f\u5fae\u5206\u3092\u4f7f\u3063\u3066\u91cd\u307f\u306e\u504f\u5fae\u5206\u3092\u8868\u3059\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002$z_2$ \u306e\u307b\u3046\u3082\u540c\u69d8\u3067\u3001\n\\frac{\\partial L}{\\partial b_{z_2}} = \\frac{\\partial L}{\\partial z_2} \\cdot \\frac{\\partial z_2}{\\partial I_{z_2}} \\cdot \\frac{\\partial I_{z_2}}{\\partial b_{z_2}} = \\frac{\\partial L}{\\partial z_2} \\cdot \\sigma_z'(I_{z_2})\\ \\left( \\because \\frac{\\partial I_{z_2}}{\\partial b_{z_2}} = 1 \\right) \\tag{16}\n\n\\begin{align}\n\\frac{\\partial L}{\\partial W_{z_{21}}} &= \\frac{\\partial L}{\\partial z_2} \\cdot \\frac{\\partial z_2}{\\partial I_{z_2}} \\cdot \\frac{\\partial I_{z_2}}{\\partial W_{z_{21}}} = \\frac{\\partial L}{\\partial b_{z_2}} \\cdot y_1 \\tag{17} \\\\\n\\frac{\\partial L}{\\partial W_{z_{22}}} &= \\frac{\\partial L}{\\partial z_2} \\cdot \\frac{\\partial z_2}{\\partial I_{z_2}} \\cdot \\frac{\\partial I_{z_2}}{\\partial W_{z_{22}}} = \\frac{\\partial L}{\\partial b_{z_2}} \\cdot y_2 \\tag{18} \\\\\n\\frac{\\partial L}{\\partial W_{z_{23}}} &= \\frac{\\partial L}{\\partial z_2} \\cdot \\frac{\\partial z_2}{\\partial I_{z_2}} \\cdot \\frac{\\partial I_{z_2}}{\\partial W_{z_{23}}} = \\frac{\\partial L}{\\partial b_{z_2}} \\cdot y_3 \\tag{19}\n\\end{align}\n\n\u3068\u306a\u308a\u307e\u3059\u3002\n\u3053\u3053\u3067\u3001$\\text{(12)}$ \uff5e $\\text{(19)}$ \u3092\u5408\u308f\u305b\u3066\u3001\u5404\u504f\u5fae\u5206\u3092\u884c\u5217 ($\\partial L/\\partial \\boldsymbol{W_z}$) \u3068\u30d9\u30af\u30c8\u30eb ($\\partial L/\\partial \\boldsymbol{b_z}$) \u3067\u8868\u3059\u3053\u3068\u3092\u8003\u3048\u307e\u3057\u3087\u3046\u3002\n\u305d\u306e\u7406\u7531\u306f 2 \u3064\u3042\u3063\u3066\u3001\u307e\u305a 1 \u3064\u306f\u3001\u305f\u304f\u3055\u3093\u306e\u5f0f\u3092\u7c21\u6f54\u306b\u307e\u3068\u3081\u3089\u308c\u308b\u304b\u3089\u3067\u3059\u3002\u3053\u306e\u4f8b\u3067\u3082 $\\text{(12)}$ \uff5e $\\text{(19)}$ \u3067 8 \u3064\u306e\u5f0f\u304c\u5fc5\u8981\u3067\u3059\u304c\u3001\u884c\u5217\u3068\u30d9\u30af\u30c8\u30eb\u3067\u3046\u307e\u304f\u307e\u3068\u3081\u3089\u308c\u308c\u3070\u5f0f\u306f 2 \u3064\u3067\u6e08\u307f\u307e\u3059\u3002\n\u3082\u3046 1 \u3064\u306f\u3001\u6700\u6025\u964d\u4e0b\u6cd5\u306e\u5f0f $\\text{(2)}$ \u3092\u898b\u308b\u3068\u3001\n\\boldsymbol{x}^{(k+1)} = \\boldsymbol{x}^{(k)} - \\eta \\frac{\\partial}{\\partial\\boldsymbol{x}^{(k)}} f(\\boldsymbol{x}^{(k)}) \\tag*{[2]}\n\n\u3068\u306a\u3063\u3066\u3044\u3066\u3001$\\boldsymbol{W_z}$ \u3084 $\\boldsymbol{b_z}$ \u3068\u540c\u3058\u5f62 (\u884c\u5217\u3084\u30d9\u30af\u30c8\u30eb) \u306b\u3057\u3066\u304a\u3044\u305f\u307b\u3046\u304c\u3001\u7dda\u5f62\u4ee3\u6570\u5b66\u7528\u306e\u30e9\u30a4\u30d6\u30e9\u30ea\u3092\u4f7f\u3063\u305f\u308a\u3067\u304d\u307e\u3059\u306e\u3067\u3001\u8a08\u7b97\u304c\u3057\u3084\u3059\u3044\u304b\u3089\u3067\u3059\u3002\n$\\boldsymbol{W_z}$ \u306f\u30d9\u30af\u30c8\u30eb\u3067\u306f\u306a\u304f\u884c\u5217\u3058\u3083\u306a\u3044\u304b\u3001\u3068\u601d\u3046\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u304c\u3001$\\eta$ \u3067\u5b9a\u6570\u500d\u3057\u3066\u5f15\u304d\u7b97\u3092\u3059\u308b\u3053\u3068\u306f\u3001\u30d9\u30af\u30c8\u30eb\u3060\u3051\u3067\u306a\u304f\u884c\u5217\u3067\u3082\u5b9a\u7fa9\u3055\u308c\u3066\u3044\u308b\u6f14\u7b97\u3067\u3059\u304b\u3089\u554f\u984c\u3042\u308a\u307e\u305b\u3093\u3002\n\u3067\u306f\u307e\u305a\u306f\u30d0\u30a4\u30a2\u30b9\u306e\u504f\u5fae\u5206\u3092\u30d9\u30af\u30c8\u30eb\u306e\u5f62\u306b\u76f4\u3057\u307e\u3059\u3002\n\\frac{\\partial L}{\\partial \\boldsymbol{b_z}} = \\begin{bmatrix}\n    \\dfrac{\\partial L}{\\partial b_{z_1}} \\\\\n    \\dfrac{\\partial L}{\\partial b_{z_2}}\n\\end{bmatrix} = \\begin{bmatrix}\n    \\dfrac{\\partial L}{\\partial z_1} \\cdot \\sigma_z'(I_{z_1}) \\\\\n    \\dfrac{\\partial L}{\\partial z_2} \\cdot \\sigma_z'(I_{z_2})\n\\end{bmatrix} = \\frac{\\partial L}{\\partial \\boldsymbol{z}} \\circ \\sigma_z'(\\boldsymbol{I_z}) \\tag{20}\n\n\u3053\u3053\u3067\u767d\u3044\u30d3\u30e5\u30ec\u30c3\u30c8 $\\circ$ \u306f\u300c\u30a2\u30c0\u30de\u30fc\u30eb\u7a4d (Hadamard product)\u300d\u3092\u8868\u3057\u3001\u6210\u5206\u3054\u3068\u306e\u7a4d\u3092\u610f\u5473\u3057\u307e\u3059\u3002\n\u666e\u901a\u306e\u30d3\u30e5\u30ec\u30c3\u30c8 $\\cdot$ \u3060\u3068\u30d9\u30af\u30c8\u30eb\u306e\u5185\u7a4d\u3068\u533a\u5225\u304c\u4ed8\u304b\u306a\u3044\u306e\u3067\u3001\u3053\u306e\u3088\u3046\u306a\u6f14\u7b97\u5b50\u3092\u5c0e\u5165\u3057\u3066\u3044\u307e\u3059\u3002\n\u6b21\u306b\u91cd\u307f\u306e\u504f\u5fae\u5206\u3092\u884c\u5217\u306e\u5f62\u306b\u76f4\u3057\u307e\u3059\u3002\n\\begin{align}\n\\frac{\\partial L}{\\partial \\boldsymbol{W_z}} = \\begin{bmatrix}\n    \\dfrac{\\partial L}{\\partial W_{z_{11}}} & \\dfrac{\\partial L}{\\partial W_{z_{12}}} & \\dfrac{\\partial L}{\\partial W_{z_{13}}} \\\\\n    \\dfrac{\\partial L}{\\partial W_{z_{21}}} & \\dfrac{\\partial L}{\\partial W_{z_{22}}} & \\dfrac{\\partial L}{\\partial W_{z_{23}}}\n\\end{bmatrix} &= \\begin{bmatrix}\n    \\dfrac{\\partial L}{\\partial b_{z_1}} \\cdot y_1 & \\dfrac{\\partial L}{\\partial b_{z_1}} \\cdot y_2 & \\dfrac{\\partial L}{\\partial b_{z_1}} \\cdot y_3 \\\\\n    \\dfrac{\\partial L}{\\partial b_{z_2}} \\cdot y_1 & \\dfrac{\\partial L}{\\partial b_{z_2}} \\cdot y_2 & \\dfrac{\\partial L}{\\partial b_{z_2}} \\cdot y_3\n\\end{bmatrix} \\\\\n&= \\begin{bmatrix}\n    \\dfrac{\\partial L}{\\partial b_{z_1}} \\\\\n    \\dfrac{\\partial L}{\\partial b_{z_2}}\n\\end{bmatrix} \\begin{bmatrix}\n    y_1 & y_2 & y_3\n\\end{bmatrix} \\\\\n&= \\frac{\\partial L}{\\partial \\boldsymbol{b_z}} \\cdot \\boldsymbol{y}^{\\top}\n\\end{align} \\tag{21}\n\n\u3068\u306a\u308a\u307e\u3059\u3002\u504f\u5fae\u5206\u306e\u8a08\u7b97\u306f\u7d50\u69cb\u3084\u3084\u3053\u3057\u304b\u3063\u305f\u3067\u3059\u304c\u3001\u6700\u7d42\u7684\u306b\u884c\u5217\u3068\u30d9\u30af\u30c8\u30eb\u306e\u5f62\u306b\u3059\u308b\u3068\u3059\u3054\u304f\u30b9\u30c3\u30ad\u30ea\u3057\u305f\u5f0f\u306b\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3057\u305f\u3002\n\u3061\u306a\u307f\u306b\u3001\u3053\u306e $\\text{(20)}$ \u3068 $\\text{(21)}$ \u306f\u96a0\u308c\u5c64\u3068\u51fa\u529b\u5c64\u306e\u6b21\u5143\u6570\u306b\u304b\u304b\u308f\u3089\u305a\u4f7f\u3048\u308b\u3053\u3068\u3092\u899a\u3048\u3066\u304a\u3044\u3066\u304f\u3060\u3055\u3044\u3002\u3053\u306e 2 \u3064\u306e\u5f0f\u306e\u5c0e\u51fa\u904e\u7a0b\u3092\u898b\u308c\u3070\u3001\u6b21\u5143\u304c\u5897\u3048\u305f\u308a\u6e1b\u3063\u305f\u308a\u3057\u3066\u3082\u3001\u540c\u69d8\u306b\u6210\u308a\u7acb\u3064\u3053\u3068\u304c\u304a\u5206\u304b\u308a\u3044\u305f\u3060\u3051\u308b\u3068\u601d\u3044\u307e\u3059\u3002\n\u305d\u3046\u3044\u3046\u9762\u3067\u3082\u884c\u5217\u3084\u30d9\u30af\u30c8\u30eb\u306e\u5f62\u5f0f\u306b\u76f4\u3057\u3066\u304a\u304f\u3068\u4fbf\u5229\u3067\u3059\u306d\u3002\n\n\u96a0\u308c\u5c64\u306e\u91cd\u307f\u30fb\u30d0\u30a4\u30a2\u30b9\u306e\u504f\u5fae\u5206\n\u6b21\u306b\u3001\u640d\u5931\u95a2\u6570\u306b\u5bfe\u3059\u308b\u96a0\u308c\u5c64\u306e\u91cd\u307f\u3001\u30d0\u30a4\u30a2\u30b9\u306e\u504f\u5fae\u5206\u3092\u6c42\u3081\u3066\u3044\u304d\u305f\u3044\u306e\u3067\u3059\u304c\u3001\u305d\u306e\u524d\u306b\u3001\u96a0\u308c\u5c64\u306e\u504f\u5fae\u5206 ($\\partial L/\\partial \\boldsymbol{y}$) \u3092\u6c42\u3081\u3066\u304a\u304d\u307e\u3057\u3087\u3046\u3002\u3053\u308c\u306f\u5f8c\u3067\u5f79\u306b\u7acb\u3061\u307e\u3059\u3002\n\\frac{\\partial L}{\\partial y_1} = \\frac{\\partial L}{\\partial z_1} \\cdot \\frac{\\partial z_1}{\\partial I_{z_1}} \\cdot \\frac{\\partial I_{z_1}}{\\partial y_1}\\ ???\n\n\u3068\u3001\u3053\u3053\u3067\u56f0\u3063\u305f\u3053\u3068\u304c\u8d77\u304d\u307e\u3057\u305f\u3002$\\text{(10)}$ \u3092\u898b\u308b\u3068\u3001$y_1$ \u306f $I_{z_1}$ \u3060\u3051\u3067\u306a\u304f $I_{z_2}$ \u3092\u6c42\u3081\u308b\u969b\u306b\u3082\u4f7f\u308f\u308c\u3066\u3044\u308b\u3067\u306f\u3042\u308a\u307e\u305b\u3093\u304b\uff01\n\u3067\u3082\u5fc3\u914d\u306f\u3044\u308a\u307e\u305b\u3093\u3002\u305d\u3046\u3001\u6211\u3005\u306b\u306f\u300c\u9023\u9396\u5f8b\u300d\u304c\u3042\u308a\u307e\u3059\u304b\u3089\u3001\u843d\u3061\u7740\u3044\u3066\u9069\u7528\u3057\u307e\u3059\u3002\n\\begin{align}\n\\frac{\\partial L}{\\partial y_1} &= \\frac{\\partial L}{\\partial z_1} \\cdot \\frac{\\partial z_1}{\\partial I_{z_1}} \\cdot \\frac{\\partial I_{z_1}}{\\partial y_1} + \\frac{\\partial L}{\\partial z_2} \\cdot \\frac{\\partial z_2}{\\partial I_{z_2}} \\cdot \\frac{\\partial I_{z_2}}{\\partial y_1} \\\\\n&= \\frac{\\partial L}{\\partial b_{z_1}} \\cdot \\frac{\\partial I_{z_1}}{\\partial y_1} + \\frac{\\partial L}{\\partial b_{z_2}} \\cdot \\frac{\\partial I_{z_2}}{\\partial y_1} \\\\\n&= \\frac{\\partial L}{\\partial b_{z_1}} \\cdot W_{z_{11}} + \\frac{\\partial L}{\\partial b_{z_2}} \\cdot W_{z_{21}}\n\\end{align} \\tag{22}\n\n\u3053\u308c\u3067 OK \u3067\u3059\u3002\n\u5c11\u3057\u88dc\u8db3\u3092\u3059\u308b\u3068\u3001$y_1$ \u304c $I_{z_1}$ \u3068 $I_{z_2}$ \u306e\u4e21\u65b9\u306e\u5f0f\u306b\u5b58\u5728\u3059\u308b\u3068\u3044\u3046\u3053\u3068\u306f\u3001$y_1$ \u306e\u5024\u304c\u5909\u5316\u3059\u308b\u3068\u3001\u5f53\u7136\u3067\u3059\u304c $I_{z_1}$ \u3068 $I_{z_2}$ \u306e\u4e21\u65b9\u306e\u5024\u306e\u5909\u5316\u306b\u5f71\u97ff\u3092\u53ca\u307c\u3059\u3053\u3068\u3092\u610f\u5473\u3057\u3066\u3044\u307e\u3059\u3002\n$I_{z_1}$ \u3068 $I_{z_2}$ \u306f\u3069\u3061\u3089\u3082\u640d\u5931\u95a2\u6570 $L$ \u306e\u5024\u306b\u5f71\u97ff\u3059\u308b\u308f\u3051\u3067\u3059\u304b\u3089\u3001\u504f\u5fae\u5206\u3092\u8003\u3048\u308b\u969b\u306b\u306f\u9023\u9396\u5f8b\u3092\u4f7f\u308f\u306a\u3051\u308c\u3070\u306a\u3089\u306a\u3044\u306e\u3067\u3059\u3002\n$y_2$ \u3068 $y_3$ \u306e\u504f\u5fae\u5206\u306b\u3064\u3044\u3066\u3082\u540c\u69d8\u306b\u6c42\u3081\u3089\u308c\u307e\u3059\u3002\n\\begin{align}\n\\frac{\\partial L}{\\partial y_2} &= \\frac{\\partial L}{\\partial z_1} \\cdot \\frac{\\partial z_1}{\\partial I_{z_1}} \\cdot \\frac{\\partial I_{z_1}}{\\partial y_2} + \\frac{\\partial L}{\\partial z_2} \\cdot \\frac{\\partial z_2}{\\partial I_{z_2}} \\cdot \\frac{\\partial I_{z_2}}{\\partial y_2} \\\\\n&= \\frac{\\partial L}{\\partial b_{z_1}} \\cdot \\frac{\\partial I_{z_1}}{\\partial y_2} + \\frac{\\partial L}{\\partial b_{z_2}} \\cdot \\frac{\\partial I_{z_2}}{\\partial y_2} \\\\\n&= \\frac{\\partial L}{\\partial b_{z_1}} \\cdot W_{z_{12}} + \\frac{\\partial L}{\\partial b_{z_2}} \\cdot W_{z_{22}}\n\\end{align} \\tag{23}\n\n\\begin{align}\n\\frac{\\partial L}{\\partial y_3} &= \\frac{\\partial L}{\\partial z_1} \\cdot \\frac{\\partial z_1}{\\partial I_{z_1}} \\cdot \\frac{\\partial I_{z_1}}{\\partial y_3} + \\frac{\\partial L}{\\partial z_2} \\cdot \\frac{\\partial z_2}{\\partial I_{z_2}} \\cdot \\frac{\\partial I_{z_2}}{\\partial y_3} \\\\\n&= \\frac{\\partial L}{\\partial b_{z_1}} \\cdot \\frac{\\partial I_{z_1}}{\\partial y_3} + \\frac{\\partial L}{\\partial b_{z_2}} \\cdot \\frac{\\partial I_{z_2}}{\\partial y_3} \\\\\n&= \\frac{\\partial L}{\\partial b_{z_1}} \\cdot W_{z_{13}} + \\frac{\\partial L}{\\partial b_{z_2}} \\cdot W_{z_{23}}\n\\end{align} \\tag{24}\n\n\u3067\u306f $\\text{(22)}$ \uff5e $\\text{(24)}$ \u306b\u3064\u3044\u3066\u3082\u3001\u307e\u3068\u3081\u3066\u30d9\u30af\u30c8\u30eb ($\\partial L/\\partial \\boldsymbol{y}$) \u3067\u8868\u3057\u3066\u304a\u304d\u307e\u3057\u3087\u3046\u3002\n\\begin{align}\n\\frac{\\partial L}{\\partial \\boldsymbol{y}} = \\begin{bmatrix}\n    \\dfrac{\\partial L}{\\partial y_1} \\\\\n    \\dfrac{\\partial L}{\\partial y_2} \\\\\n    \\dfrac{\\partial L}{\\partial y_3}\n\\end{bmatrix} &= \\begin{bmatrix}\n    \\dfrac{\\partial L}{\\partial b_{z_1}} \\cdot W_{z_{11}} + \\dfrac{\\partial L}{\\partial b_{z_2}} \\cdot W_{z_{21}} \\\\\n    \\dfrac{\\partial L}{\\partial b_{z_1}} \\cdot W_{z_{12}} + \\dfrac{\\partial L}{\\partial b_{z_2}} \\cdot W_{z_{22}} \\\\\n    \\dfrac{\\partial L}{\\partial b_{z_1}} \\cdot W_{z_{13}} + \\dfrac{\\partial L}{\\partial b_{z_2}} \\cdot W_{z_{23}}\n\\end{bmatrix} \\\\\n&= \\begin{bmatrix}\n    W_{z_{11}} & W_{z_{21}} \\\\\n    W_{z_{12}} & W_{z_{22}} \\\\\n    W_{z_{13}} & W_{z_{23}}\n\\end{bmatrix} \\begin{bmatrix}\n    \\dfrac{\\partial L}{\\partial b_{z_1}} \\\\\n    \\dfrac{\\partial L}{\\partial b_{z_2}}\n\\end{bmatrix} \\\\\n&= \\boldsymbol{W_z}^{\\top} \\cdot \\frac{\\partial L}{\\partial \\boldsymbol{b_z}}\n\\end{align} \\tag{25}\n\n\u9014\u4e2d\u3001\u884c\u5217\u6f14\u7b97\u3092\u8003\u616e\u3059\u308b\u95a2\u4fc2\u3067\u91cd\u307f\u3068\u30d0\u30a4\u30a2\u30b9\u306e\u9806\u756a\u304c\u5165\u308c\u66ff\u308f\u3063\u3066\u3044\u308b\u306e\u3067\u3001\u5c11\u3005\u898b\u3065\u3089\u3044\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u304c\u3001\u5730\u9053\u306b\u8a08\u7b97\u3057\u3066\u3044\u304f\u3068\u3053\u306e\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\n\u305d\u3057\u3066 $\\text{(25)}$ \u3082\u3001$\\text{(20)}$ \u3084 $\\text{(21)}$ \u3068\u540c\u3058\u3088\u3046\u306b\u3001\u884c\u5217\u3068\u30d9\u30af\u30c8\u30eb\u3067\u8868\u73fe\u3057\u305f\u3053\u3068\u306b\u3088\u3063\u3066\u3001\u96a0\u308c\u5c64\u3068\u51fa\u529b\u5c64\u306e\u6b21\u5143\u6570\u306b\u304b\u304b\u308f\u3089\u305a\u4f7f\u3048\u308b\u5f0f\u306b\u306a\u3063\u3066\u3044\u307e\u3059\u3002\n\u306a\u304a\u3001$\\text{(25)}$ \u306f\u91cd\u307f\u884c\u5217\u3092\u8ee2\u7f6e\u3057\u3066\u3044\u307e\u3059\u304c\u3001\u3044\u3056\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u3057\u3088\u3046\u3068\u3059\u308b\u3068\u3001\u5927\u898f\u6a21\u306a\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u3067\u306f\u8ee2\u7f6e\u306b\u6642\u9593\u304c\u304b\u304b\u308b\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u3002\n\u305d\u3046\u306a\u3089\u306a\u3044\u3088\u3046\u5de5\u592b\u304c\u3055\u308c\u3066\u3044\u308b\u7dda\u5f62\u4ee3\u6570\u5b66\u7528\u306e\u30e9\u30a4\u30d6\u30e9\u30ea\u3082\u3042\u308a\u307e\u3059\u304c\u3001\u3082\u3057\u7d20\u76f4\u306b\u8ee2\u7f6e\u3059\u308b\u3068\u304d\u306f\u3001\u4ee5\u4e0b $\\text{(26)}$ \u304c\u6210\u308a\u7acb\u3064\u3053\u3068\u3092\u5229\u7528\u3057\u3066\u3001\u91cd\u307f\u884c\u5217\u3092\u8ee2\u7f6e\u305b\u305a\u305d\u306e\u307e\u307e\u4f7f\u3046\u3088\u3046\u306b\u3059\u308b\u3068\u3088\u3044\u3067\u3057\u3087\u3046\u3002\n\\boldsymbol{W_z}^{\\top} \\cdot \\frac{\\partial L}{\\partial \\boldsymbol{b_z}} = \\left( \\dfrac{\\partial L}{\\partial \\boldsymbol{b_z}}^{\\top} \\cdot \\boldsymbol{W_z} \\right)^{\\top} \\tag{26}\n\n\u3053\u3053\u307e\u3067\u6765\u308c\u3070\u3001\u96a0\u308c\u5c64\u306e\u91cd\u307f\u3068\u30d0\u30a4\u30a2\u30b9\u306e\u504f\u5fae\u5206\u3092\u6c42\u3081\u308b\u306e\u306f\u7c21\u5358\u3067\u3059\u3002\n\u640d\u5931\u95a2\u6570\u306b\u5bfe\u3059\u308b\u96a0\u308c\u5c64\u306e\u504f\u5fae\u5206 ($\\partial L/\\partial \\boldsymbol{y}$) \u304c\u6c42\u3081\u3089\u308c\u3066\u3044\u307e\u3059\u3057\u3001$\\text{(3)}$ \u3084 $\\text{(8)}$ \uff5e $\\text{(11)}$ \u3092\u898b\u308b\u3068\u3001\u30cb\u30e5\u30fc\u30e9\u30eb\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306e\u8a08\u7b97\u5f0f\u306f\u96a0\u308c\u5c64\u3082\u51fa\u529b\u5c64\u3082\u5909\u308f\u3089\u306a\u3044\u308f\u3051\u3067\u3059\u304b\u3089\u3001$\\text{(20)}$ \u3068 $\\text{(21)}$ \u306e\u8a18\u53f7\u3092\u5909\u3048\u3066\u518d\u5229\u7528\u304c\u3067\u304d\u307e\u3059\u3002\n\\begin{align}\n\\frac{\\partial L}{\\partial \\boldsymbol{b_y}} &= \\frac{\\partial L}{\\partial \\boldsymbol{y}} \\circ \\sigma_y'(\\boldsymbol{I_y}) \\tag{27}\\\\\n\\frac{\\partial L}{\\partial \\boldsymbol{W_y}} &= \\frac{\\partial L}{\\partial \\boldsymbol{b_y}} \\cdot \\boldsymbol{x}^{\\top} = \\left( \\frac{\\partial L}{\\partial \\boldsymbol{y}} \\circ \\sigma_y'(\\boldsymbol{I_y}) \\right) \\cdot \\boldsymbol{x}^{\\top} \\tag{28}\n\\end{align}\n\n\u3042\u307e\u308a\u306b\u3082\u5446\u6c17\u306a\u304f\u3066\u3001\u5618\u304f\u3055\u304f\u611f\u3058\u308b\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u304c\u3001\u3053\u308c\u3067\u5408\u3063\u3066\u307e\u3059\u3002\n\u305d\u308c\u3067\u3082\u4e0d\u5b89\u306b\u611f\u3058\u305f\u3089\u3001\u691c\u7b97\u3092\u3057\u3066 $\\partial L / \\partial b_{y_1}$ \u304b\u3089\u9806\u306b\u6c42\u3081\u3066\u3044\u304f\u3068\u3088\u3044\u3067\u3057\u3087\u3046\u30028 \u524d\u7bc0\u306e $\\text{(12)}$ \uff5e $\\text{(21)}$ \u3068\u540c\u3058\u3088\u3046\u306a\u8a08\u7b97\u7d4c\u904e\u3092\u305f\u3069\u3063\u3066\u3001$\\text{(27)}$ \u3068 $\\text{(28)}$ \u3092\u5c0e\u304f\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\u3042\u3001\u5165\u529b\u5c64\u306e\u504f\u5fae\u5206 ($\\partial L / \\partial \\boldsymbol{x}$) \u3092\u6c42\u3081\u308b\u5fc5\u8981\u306f\u3042\u308a\u307e\u305b\u3093\u3002\u5165\u529b\u5c64\u306b\u91cd\u307f\u3084\u30d0\u30a4\u30a2\u30b9\u306f\u3042\u308a\u307e\u305b\u3093\u304b\u3089\u3001\u6c42\u3081\u3066\u3082\u4f7f\u3044\u3069\u3053\u308d\u304c\u306a\u3044\u305f\u3081\u3067\u3059\u3002\n\n\u640d\u5931\u95a2\u6570\u3068\u6d3b\u6027\u5316\u95a2\u6570\n\u3053\u3053\u3067\u3001\u6700\u5f8c\u307e\u3067\u6c7a\u3081\u3066\u3044\u306a\u304b\u3063\u305f\u3082\u306e\u306b\u3064\u3044\u3066\u624b\u3092\u4ed8\u3051\u308b\u3053\u3068\u306b\u3057\u307e\u3057\u3087\u3046\u3002\u305d\u3046\u3001\u640d\u5931\u95a2\u6570 \u3068 \u6d3b\u6027\u5316\u95a2\u6570 \u3067\u3059\u3002\n\u6700\u521d\u306b\u3001\u3053\u306e 2 \u3064\u306f \u3042\u3048\u3066 \u6700\u5f8c\u306b\u63d0\u793a\u3059\u308b\u3068\u66f8\u304d\u307e\u3057\u305f\u3002\n\u640d\u5931\u95a2\u6570\u3068\u6d3b\u6027\u5316\u95a2\u6570\u3092\u4e8b\u524d\u306b\u6c7a\u5b9a\u3057\u3066\u3057\u307e\u3046\u3068\u3001\u5f0f\u3092\u8a08\u7b97\u3057\u3066\u3044\u304f\u904e\u7a0b\u3067\u3001\u5206\u6bcd\u3068\u5206\u5b50\u306b\u540c\u3058\u9805\u304c\u3067\u304d\u3066\u6d88\u3048\u3066\u3057\u307e\u3063\u305f\u308a\u3001\u5f0f\u306e\u524d\u5f8c\u306b\u4e00\u90e8\u306e\u9805\u304c\u79fb\u52d5\u3057\u3066\u3057\u307e\u3063\u305f\u308a\u3057\u3066\u3001\u305d\u306e\u640d\u5931\u95a2\u6570\u3001\u305d\u306e\u6d3b\u6027\u5316\u95a2\u6570\u3067\u3057\u304b\u901a\u7528\u3057\u306a\u3044\u5f0f\u306b\u306a\u308a\u304c\u3061\u3067\u3059\u3002\n\u305d\u306e\u72b6\u614b\u3067\u899a\u3048\u3066\u3057\u307e\u3046\u3068\u3001\u640d\u5931\u95a2\u6570\u3001\u6d3b\u6027\u5316\u95a2\u6570\u3092\u5909\u66f4\u3057\u305f\u3044\u3068\u304d\u306b\u5fdc\u7528\u304c\u5229\u304d\u307e\u305b\u3093\u306e\u3067\u3001\u6700\u5f8c\u306b\u8003\u3048\u308b\u3053\u3068\u306b\u3057\u307e\u3057\u305f\u3002\n\u640d\u5931\u95a2\u6570\u306f 2 \u6b21\u640d\u5931\u3092\u4f7f\u3063\u3066\u307f\u307e\u3057\u3087\u3046\u3002\u305f\u3060\u3057\u3001\u4fc2\u6570 $1/2$ \u3092\u8ffd\u52a0\u3057\u307e\u3059\u3002\nL = \\frac{1}{2} \\{(z_1 - T_1)^2 + (z_2 - T_2)^2\\}\n\n\u308f\u3056\u308f\u3056 $1/2$ \u3092\u4ed8\u3051\u308b\u7406\u7531\u306f\u3001\u504f\u5fae\u5206\u3092\u3057\u3066\u307f\u308b\u3068\u5206\u304b\u308a\u307e\u3059\u3002\n\\begin{align}\n\\frac{\\partial L}{\\partial z_1} &= \\frac{1}{2} \\cdot 2(z_1 - T_1) \\cdot 1 = z_1 - T_1 \\\\\n\\frac{\\partial L}{\\partial z_2} &= \\frac{1}{2} \\cdot 2(z_2 - T_2) \\cdot 1 = z_2 - T_2 \\\\\n\\frac{\\partial L}{\\partial \\boldsymbol{z}} &= \\begin{bmatrix}\n    \\dfrac{\\partial L}{\\partial z_1} \\\\\n    \\dfrac{\\partial L}{\\partial z_2}\n\\end{bmatrix} = \\begin{bmatrix}\n    z_1 - T_1 \\\\\n    z_2 - T_2\n\\end{bmatrix} = \\boldsymbol{z} - \\boldsymbol{T} \\tag{29}\n\\end{align}\n\n\u4fc2\u6570 $1/2$ \u304c\u4ed8\u3044\u3066\u3044\u3066\u3082\u640d\u5931\u95a2\u6570\u306e\u5927\u5c0f\u95a2\u4fc2\u306f\u5d29\u308c\u307e\u305b\u3093\u304b\u3089\u554f\u984c\u3042\u308a\u307e\u305b\u3093\u3057\u3001\u504f\u5fae\u5206\u306e\u969b\u306b\u80a9\u306e 2 \u4e57\u304c\u964d\u308a\u3066\u304f\u308b\u306e\u3092\u4fc2\u6570\u3067\u76f8\u6bba\u3067\u304d\u308b\u305f\u3081\u3001\u5f0f\u3092\u7c21\u5358\u306b\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\u6b21\u306b\u6d3b\u6027\u5316\u95a2\u6570\u3067\u3059\u304c\u3001\u4eca\u56de\u306f\u96a0\u308c\u5c64\u3001\u51fa\u529b\u5c64\u3068\u3082\u300c\u6a19\u6e96\u30b7\u30b0\u30e2\u30a4\u30c9\u95a2\u6570 (standard sigmoid function)\u300d\u3092\u4f7f\u3063\u3066\u307f\u307e\u3059\u30029\n\n\u30b7\u30b0\u30e2\u30a4\u30c9\u95a2\u6570\u306f\u975e\u7dda\u5f62\u306e\u95a2\u6570\u3067\u3001\u95a2\u6570 $\\sigma(x)$ \u304a\u3088\u3073\u305d\u306e\u5c0e\u95a2\u6570 $\\sigma'(x)$ \u306f\u4ee5\u4e0b\u306e\u3068\u304a\u308a\u3067\u3059\u3002\n\\begin{align}\n\\sigma(x) &= \\frac{1}{1 + e^{-x}} \\\\\n\\\\\n\\sigma'(x) &= \\left( \\frac{1}{1 + e^{-x}} \\right)' = \\{ (1 + e^{-x})^{-1} \\}' \\\\\n&= -1 \\cdot (1 + e^{-x})^{-2} \\cdot e^{-x} \\cdot (-1) \\\\\n&= \\frac{e^{-x}}{(1 + e^{-x})^2} = \\frac{1 + e^{-x}}{(1 + e^{-x})^2} - \\frac{1}{(1 + e^{-x})^2} \\\\\n&= \\frac{1}{1 + e^{-x}} - \\left(\\frac{1}{1 + e^{-x}}\\right)^2 = \\sigma(x) - \\{\\sigma(x)\\}^2 \\\\\n&= \\sigma(x) \\{ 1 - \\sigma(x) \\} \\tag{30}\n\\end{align}\n\n\u3053\u306e\u95a2\u6570\u3092\u6d3b\u6027\u5316\u95a2\u6570\u306b\u4f7f\u3046\u30e1\u30ea\u30c3\u30c8\u3068\u3057\u3066\u3001\n\n\u5b9a\u7fa9\u57df $(-\\infty, \\infty)$ \u306b\u5bfe\u3057\u3066\u5024\u57df $(0, 1)$ \u3067\u3042\u308a\u3001\u4eca\u56de\u306e\u534a\u52a0\u7b97\u5668\u306e\u51fa\u529b\u7bc4\u56f2\u3068\u3057\u3066\u9069\u5f53\u3067\u3042\u308b\u3002\n$\\text{(30)}$ \u3067\u8868\u3059\u3068\u304a\u308a\u30011 \u968e\u5c0e\u95a2\u6570\u3092\u81ea\u5206\u81ea\u8eab\u3092\u4f7f\u3063\u3066\u8868\u3059\u3053\u3068\u304c\u3067\u304d\u308b\u3002\n\n\u304c\u3042\u308a\u307e\u3059\u3002$\\text{(30)}$ \u3092\u7528\u3044\u3066\u96a0\u308c\u5c64\u3068\u51fa\u529b\u5c64\u306e\u6d3b\u6027\u5316\u95a2\u6570\u306e\u5fae\u5206 $\\sigma_y'( \\boldsymbol{I_y} ), \\sigma_z'( \\boldsymbol{I_z} )$ \u3092\u6c42\u3081\u308b\u3068\u3001\n\\begin{align}\n\\sigma_y'( \\boldsymbol{I_y} ) &= \\begin{bmatrix}\n    \\sigma_y'( I_{y_1} ) \\\\\n    \\sigma_y'( I_{y_2} ) \\\\\n    \\sigma_y'( I_{y_3} )\n\\end{bmatrix} = \\begin{bmatrix}\n    \\sigma_y( I_{y_1} ) \\{ 1 - \\sigma_y( I_{y_1} ) \\} \\\\\n    \\sigma_y( I_{y_2} ) \\{ 1 - \\sigma_y( I_{y_2} ) \\} \\\\\n    \\sigma_y( I_{y_3} ) \\{ 1 - \\sigma_y( I_{y_3} ) \\}\n\\end{bmatrix} = \\begin{bmatrix}\n    y_1 ( 1 - y_1 ) \\\\\n    y_2 ( 1 - y_2 ) \\\\\n    y_3 ( 1 - y_3 )\n\\end{bmatrix} \\\\\n&= \\boldsymbol{y} \\circ (\\boldsymbol{1} - \\boldsymbol{y}) \\tag{31}\n\\end{align}\n\n\\begin{align}\n\\sigma_z'( \\boldsymbol{I_z} ) &= \\begin{bmatrix}\n    \\sigma_z'( I_{z_1} ) \\\\\n    \\sigma_z'( I_{z_2} )\n\\end{bmatrix} = \\begin{bmatrix}\n    \\sigma_z( I_{z_1} ) \\{ 1 - \\sigma_z( I_{z_1} ) \\} \\\\\n    \\sigma_z( I_{z_2} ) \\{ 1 - \\sigma_z( I_{z_2} ) \\}\n\\end{bmatrix} = \\begin{bmatrix}\n    z_1 ( 1 - z_1 ) \\\\\n    z_2 ( 1 - z_2 )\n\\end{bmatrix} \\\\\n&= \\boldsymbol{z} \\circ (\\boldsymbol{1} - \\boldsymbol{z}) \\tag{32}\n\\end{align}\n\n\u3068\u306a\u308a\u3001\u306a\u308b\u307b\u3069\u3001\u3068\u3066\u3082\u7c21\u5358\u306b\u306a\u308a\u307e\u3057\u305f (\u30a2\u30c0\u30de\u30fc\u30eb\u7a4d\u306b\u306a\u308b\u3053\u3068\u306b\u6ce8\u610f)\u3002\n\u5f0f $\\text{(29)}$\u3001$\\text{(31)}$\u3001$\\text{(32)}$ \u3092\u8e0f\u307e\u3048\u3066\u3001\u640d\u5931\u95a2\u6570\u306b\u5bfe\u3059\u308b\u91cd\u307f\u3068\u30d0\u30a4\u30a2\u30b9\u306e\u504f\u5fae\u5206\u306e\u6700\u7d42\u7684\u306a\u5f0f\u306f\u3001\n\\begin{align}\n\\frac{\\partial L}{\\partial \\boldsymbol{b_z}} &= \\frac{\\partial L}{\\partial \\boldsymbol{z}} \\circ \\sigma_z^{\\prime}(\\boldsymbol{I_z}) = (\\boldsymbol{z} - \\boldsymbol{T}) \\circ \\boldsymbol{z} \\circ (\\boldsymbol{1} - \\boldsymbol{z}) \\\\\n\\frac{\\partial L}{\\partial \\boldsymbol{W_z}} &= \\frac{\\partial L}{\\partial \\boldsymbol{b_z}} \\cdot \\boldsymbol{y}^{\\top} \\tag*{[21]} \\\\\n\\frac{\\partial L}{\\partial \\boldsymbol{y}} &= \\boldsymbol{W_z}^{\\top} \\cdot \\frac{\\partial L}{\\partial \\boldsymbol{b_z}} \\tag*{[25]} \\\\\n\\frac{\\partial L}{\\partial \\boldsymbol{b_y}} &= \\frac{\\partial L}{\\partial \\boldsymbol{y}} \\circ \\sigma_y^{\\prime}(\\boldsymbol{I_y}) = \\frac{\\partial L}{\\partial \\boldsymbol{y}} \\circ \\boldsymbol{y} \\circ (\\boldsymbol{1} - \\boldsymbol{y}) \\\\\n\\frac{\\partial L}{\\partial \\boldsymbol{W_y}} &= \\frac{\\partial L}{\\partial \\boldsymbol{b_y}} \\cdot \\boldsymbol{x}^{\\top} \\tag*{[28]}\n\\end{align}\n\n\u3068\u306a\u308a\u307e\u3059\u3002\u3088\u3046\u3084\u304f\u3053\u308c\u3067\u3059\u3079\u3066\u63c3\u3044\u307e\u3057\u305f\u3002\u3042\u3068\u306f\u3072\u305f\u3059\u3089\u30b3\u30f3\u30d4\u30e5\u30fc\u30bf\u306b\u8a08\u7b97\u3055\u305b\u308b\u3060\u3051\u3067\u3059\u3002\n\n\u5b66\u7fd2\u3055\u305b\u3088\u3046\n\u30cb\u30e5\u30fc\u30e9\u30eb\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306e\u5b66\u7fd2\u306f\u3001\u304a\u304a\u3080\u306d\u4ee5\u4e0b\u306e\u624b\u9806\u3067\u884c\u3044\u307e\u3059\u3002\u5834\u5408\u306b\u3088\u3063\u3066\u306f\u3053\u306e\u3068\u304a\u308a\u306e\u624b\u9806\u306b\u306a\u3089\u306a\u3044\u3053\u3068\u304c\u3042\u308a\u307e\u3059\u306e\u3067\u3001\u53c2\u8003\u7a0b\u5ea6\u306b\u898b\u3066\u304f\u3060\u3055\u3044\u3002\n\n\u91cd\u307f\u3068\u30d0\u30a4\u30a2\u30b9\u3092\u521d\u671f\u5316\u3059\u308b\u3002\n\u4ee5\u4e0b\u3092\u5b66\u7fd2\u56de\u6570\u3076\u3093\u7e70\u308a\u8fd4\u3059\u3002\n\n\n\u4ee5\u4e0b\u3092\u5165\u529b\u306e\u3076\u3093\u7e70\u308a\u8fd4\u3059\u3002\n\n\n\u73fe\u5728\u306e\u91cd\u307f\u3068\u30d0\u30a4\u30a2\u30b9\u3092\u4f7f\u3044\u3001\u5165\u529b\u30c7\u30fc\u30bf\u304b\u3089\u5404\u5c64\u306e\u5024\u3092\u8a08\u7b97\u3059\u308b (\u9806\u4f1d\u64ad)\u3002\n\u640d\u5931\u95a2\u6570\u3092\u8a08\u7b97\u3059\u308b\u3002\u504f\u5fae\u5206\u306e\u8a08\u7b97\u306b\u76f4\u63a5\u5fc5\u8981\u3067\u306f\u306a\u3044\u304c\u3001\u5b66\u7fd2\u306e\u7d4c\u904e\u3092\u78ba\u8a8d\u3067\u304d\u308b\u3002\n\u640d\u5931\u95a2\u6570\u306b\u5bfe\u3059\u308b\u5404\u5c64\u306e\u91cd\u307f\u3068\u30d0\u30a4\u30a2\u30b9\u306e\u504f\u5fae\u5206\u3092\u8a08\u7b97\u3059\u308b\u3002\n\n\n\u5165\u529b\u3054\u3068\u306e\u640d\u5931\u95a2\u6570\u306b\u5bfe\u3059\u308b\u504f\u5fae\u5206 ($\\partial L/\\partial w$) \u304b\u3089\u3001\u5168\u4f53\u640d\u5931\u95a2\u6570\u306b\u5bfe\u3059\u308b\u504f\u5fae\u5206 ($\\partial L^{(all)}/\\partial w$) \u3092\u8a08\u7b97\u3059\u308b\u3002\n\u6700\u6025\u964d\u4e0b\u6cd5\u3092\u4f7f\u3044\u3001\u91cd\u307f\u3068\u30d0\u30a4\u30a2\u30b9\u3092\u4fee\u6b63\u3059\u308b\u3002\n\n\n\n\u300c\u521d\u671f\u5316\u300d\u306b\u3064\u3044\u3066\u3053\u3053\u307e\u3067\u8a00\u53ca\u3057\u3066\u304d\u307e\u305b\u3093\u3067\u3057\u305f\u304c\u30011 \u3064\u6ce8\u610f\u70b9\u3092\u6319\u3052\u3066\u304a\u304f\u3068\u3001\u91cd\u307f\u3068\u30d0\u30a4\u30a2\u30b9\u306e\u521d\u671f\u5316\u306f \u4e71\u6570\u3092\u4f7f\u3046\u306e\u304c\u57fa\u672c \u3067\u3042\u308a\u3001\u6c7a\u3057\u3066 \u540c\u3058\u5024\u3067\u521d\u671f\u5316\u3057\u3066\u306f\u3044\u3051\u306a\u3044 \u3068\u3044\u3046\u3053\u3068\u3067\u3059\u3002\n\u540c\u3058\u5024\u3067\u521d\u671f\u5316\u3057\u3066\u3057\u307e\u3046\u3068\u3001\u640d\u5931\u95a2\u6570\u306b\u5bfe\u3059\u308b\u504f\u5fae\u5206 ($\\partial L/\\partial w$) \u304c\u3059\u3079\u3066\u306e\u30ce\u30fc\u30c9\u3067\u7b49\u3057\u304f\u306a\u308a\u3001\u6700\u6025\u964d\u4e0b\u6cd5\u306b\u3088\u308b\u4fee\u6b63\u91cf\u3082\u540c\u3058\u306b\u306a\u308b\u305f\u3081\u3001\u30ce\u30fc\u30c9\u306b\u304b\u304b\u308f\u3089\u305a\u91cd\u307f\u3001\u30d0\u30a4\u30a2\u30b9\u304c\u5e38\u306b\u540c\u3058\u5024\u306b\u306a\u308a\u307e\u3059\u3002\n\u540c\u3058\u91cd\u307f\u3001\u30d0\u30a4\u30a2\u30b9\u3092\u6301\u3064\u30ce\u30fc\u30c9\u306f 1 \u3064\u306b\u307e\u3068\u3081\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u306e\u3067\u3001\u305d\u306e\u5c64\u306e\u6b21\u5143\u6570\u304c\u5c0f\u3055\u304f\u306a\u3063\u3066\u3057\u307e\u3044\u307e\u3059\u3002\u3053\u308c\u306f\u3059\u306a\u308f\u3061\u3001\u8868\u73fe\u529b\u304c\u4f4e\u4e0b\u3057\u305f \u3053\u3068\u3092\u610f\u5473\u3059\u308b\u306e\u3067\u3059\u3002\n\u5b9f\u969b\u3001\u3053\u306e\u72b6\u614b\u3067\u306f\u30cb\u30e5\u30fc\u30e9\u30eb\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306e\u5b66\u7fd2\u306f\u3001\u591a\u304f\u306e\u5834\u5408\u3046\u307e\u304f\u3044\u304d\u307e\u305b\u3093\u3002\n\u4ee5\u4e0a\u306b\u6ce8\u610f\u3057\u3064\u3064\u3001\u534a\u52a0\u7b97\u5668\u306e\u30cb\u30e5\u30fc\u30e9\u30eb\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u3092\u5b66\u7fd2\u3055\u305b\u305f\u3068\u3053\u308d\u3001\u4eca\u56de 10 \u306f\u4ee5\u4e0b\u306e\u7d50\u679c\u306b\u306a\u308a\u307e\u3057\u305f\u3002\n\n\nhalf_adder.plot\nset term png size 600,300 transparent font 'Arial' 11\nset output 'half_adder.png'\nset title 'Learning of a half adder'\nset xlabel 'Times'\nset ylabel 'Quadratic loss function'\nunset key\nset lmargin 10.5\nset rmargin 3.5\nset tmargin 2\nset bmargin 3\nset xrange [0:100000]\nset yrange [0:0.01]\nplot 'half_adder.csv' with lines linewidth 2\n\n\n\u5b66\u7fd2\u56de\u6570\u304c\u5897\u3048\u308b\u306b\u3057\u305f\u304c\u3044\u3001\u640d\u5931\u95a2\u6570\u304c\u9806\u8abf\u306b\u5c0f\u3055\u304f\u306a\u3063\u3066\u3044\u304f\u306e\u304c\u5206\u304b\u308a\u307e\u3059\u3002\u3046\u307e\u304f\u5b66\u7fd2\u3067\u304d\u3066\u3044\u308b\u3088\u3046\u3067\u3059\u3002\n\u4eca\u56de\u306f\u91cd\u307f\u3001\u30d0\u30a4\u30a2\u30b9\u306e\u521d\u671f\u5316\u306b\u306f\u9589\u533a\u9593 $[-8, 8]$ \u306e\u4e00\u69d8\u5206\u5e03\u4e71\u6570\u3092\u4f7f\u3044\u3001\u5b66\u7fd2\u7387 (\u6700\u6025\u964d\u4e0b\u6cd5\u306e\u4fc2\u6570 $\\eta$) \u306f 0.3 \u3068\u3057\u307e\u3057\u305f\u3002\n\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u306f Gist \u306b\u6295\u7a3f\u3057\u3066\u3044\u307e\u3059\u306e\u3067\u3001\u3054\u8208\u5473\u304c\u3042\u308c\u3070\u3001\u96a0\u308c\u5c64\u306e\u6b21\u5143\u6570\u3084\u4e71\u6570\u5206\u5e03\u3001\u5b66\u7fd2\u7387\u306e\u9055\u3044\u306b\u3088\u308b\u3001\u5b66\u7fd2\u7d50\u679c\u306e\u9055\u3044\u3092\u6bd4\u8f03\u3057\u3066\u307f\u3066\u304f\u3060\u3055\u3044\u300211\n\n\u8aa4\u5dee\u9006\u4f1d\u64ad\u6cd5\n\u524d\u7ae0\u306f\u3001\u8aa4\u5dee\u9006\u4f1d\u64ad\u6cd5\u3068\u306f\u4f55\u306a\u306e\u304b\u3068\u3044\u3046\u70b9\u3092\u3059\u3063\u98db\u3070\u3057\u3066\u3001\u52e2\u3044\u306b\u4efb\u305b\u3066\u5b9f\u4f8b\u3092\u9577\u3005\u3068\u66f8\u3044\u3066\u3057\u307e\u3044\u307e\u3057\u305f\u3002\u3053\u3053\u3067\u306f\u8aa4\u5dee\u9006\u4f1d\u64ad\u6cd5\u306b\u3064\u3044\u3066\u307e\u3068\u3081\u3066\u3044\u304d\u307e\u3059\u3002\n\n\u9806\u4f1d\u64ad\u3068\u9006\u4f1d\u64ad\n\u307e\u305a\u3001\u534a\u52a0\u7b97\u5668\u306e\u5b66\u7fd2\u306b\u51fa\u3066\u304d\u305f\u6570\u5f0f\u306e\u4e00\u90e8\u3092\u307e\u3068\u3081\u307e\u3059\u3002\n\\begin{align}\n\\boldsymbol{x} &= (x_1, x_2) \\tag*{[7]} \\\\\n\\boldsymbol{y} &= \\sigma_y( \\boldsymbol{W_y} \\boldsymbol{x} + \\boldsymbol{b_y} ) \\tag{9'} \\\\\n\\boldsymbol{z} &= \\sigma_z( \\boldsymbol{W_z} \\boldsymbol{y} + \\boldsymbol{b_z} ) \\tag{11'}\\\\\n\\\\\n\\frac{\\partial L}{\\partial \\boldsymbol{z}} &= \\boldsymbol{z} - \\boldsymbol{T} \\tag*{[29]} \\\\\n\\frac{\\partial L}{\\partial \\boldsymbol{b_z}} &= \\frac{\\partial L}{\\partial \\boldsymbol{z}} \\circ \\sigma_z'( \\boldsymbol{W_z} \\boldsymbol{y} + \\boldsymbol{b_z} ) \\tag{20'} \\\\\n\\frac{\\partial L}{\\partial \\boldsymbol{W_z}} &= \\frac{\\partial L}{\\partial \\boldsymbol{b_z}} \\cdot \\boldsymbol{y}^{\\top} \\tag*{[21]} \\\\\n\\frac{\\partial L}{\\partial \\boldsymbol{y}} &= \\boldsymbol{W_z}^{\\top} \\cdot \\frac{\\partial L}{\\partial \\boldsymbol{b_z}} \\tag*{[25]} \\\\\n\\frac{\\partial L}{\\partial \\boldsymbol{b_y}} &= \\frac{\\partial L}{\\partial \\boldsymbol{y}} \\circ \\sigma_y'( \\boldsymbol{W_y} \\boldsymbol{x} + \\boldsymbol{b_y} ) \\tag{27'} \\\\\n\\frac{\\partial L}{\\partial \\boldsymbol{W_y}} &= \\frac{\\partial L}{\\partial \\boldsymbol{b_y}} \\cdot \\boldsymbol{x}^{\\top} \\tag*{[28]}\n\\end{align}\n\n$\\text{(7)}$\u3001$\\text{(9')}$\u3001$\\text{(11')}$ \u3092\u898b\u308b\u3068\u3001\u5c64\u306e\u5024\u3092\u6c42\u3081\u308b\u305f\u3081\u306b\u306f\u3001\u524d\u306e\u5c64\u306e\u5024\u304c\u5fc5\u8981\u306b\u306a\u308b\u3053\u3068\u304c\u5206\u304b\u308b\u3068\u601d\u3044\u307e\u3059\u3002\n\u305d\u3057\u3066\u3001$\\text{(29)}$\u3001$\\text{(20')}$\u3001$\\text{(21)}$\u3001$\\text{(25)}$\u3001$\\text{(27')}$\u3001$\\text{(28)}$ \u3092\u898b\u308b\u3068\u3001\u504f\u5fae\u5206\u3092\u6c42\u3081\u308b\u305f\u3081\u306b\u306f\u3001\u5f8c\u308d\u306e\u5c64\u306e\u504f\u5fae\u5206\u304c\u5fc5\u8981\u306b\u306a\u308b\u3053\u3068\u304c\u5206\u304b\u308a\u307e\u3059\u3002\n\u5c64\u306e\u5024\u3092\u5165\u529b\u5c64\u304b\u3089\u51fa\u529b\u5c64\u306b\u5411\u304b\u3063\u3066\u9806\u756a\u306b\u8a08\u7b97\u3057\u3066\u3044\u304f\u904e\u7a0b\u3092\u300c\u9806\u4f1d\u64ad\u300d\u3068\u8aac\u660e\u3057\u307e\u3057\u305f\u304c\u3001\u305d\u308c\u306b\u5bfe\u3057\u3066\u3001\u504f\u5fae\u5206\u3092\u51fa\u529b\u5c64\u304b\u3089\u5165\u529b\u5c64\u306b\u5411\u304b\u3063\u3066\u9806\u756a\u306b\u8a08\u7b97\u3057\u3066\u3044\u304f\u904e\u7a0b\u3092\u300c\u9006\u4f1d\u64ad (backward propagation)\u300d\u3068\u3044\u3044\u307e\u3059\u3002\n\u305d\u3057\u3066\u3001\u640d\u5931\u95a2\u6570 $L$ \u3092 \u8aa4\u5dee \u3068\u898b\u7acb\u3066\u3066\u3001\u9006\u4f1d\u64ad\u306b\u3088\u3063\u3066\u91cd\u307f\u3068\u30d0\u30a4\u30a2\u30b9\u3092\u4fee\u6b63\u3057\u3066\u3044\u304f\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u304c\u300c\u8aa4\u5dee\u9006\u4f1d\u64ad\u6cd5\u300d\u306a\u306e\u3067\u3059\u3002\n\u524d\u7ae0\u3067\u3001\u8aa4\u5dee\u9006\u4f1d\u64ad\u6cd5\u304c\u5177\u4f53\u7684\u306b\u4f55\u3092\u793a\u3057\u3066\u3044\u308b\u306e\u304b\u660e\u3089\u304b\u306b\u305b\u305a\u306b\u30cb\u30e5\u30fc\u30e9\u30eb\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306e\u5b66\u7fd2\u3092\u9032\u3081\u307e\u3057\u305f\u304c\u3001\u4f55\u306e\u3053\u3068\u306f\u306a\u304f\u3001\u3084\u3063\u3066\u3044\u305f\u3053\u3068\u306f\u8aa4\u5dee\u9006\u4f1d\u64ad\u6cd5\u305d\u306e\u3082\u306e\u3067\u3059\u3002\n\n\u4e00\u822c\u5316\n\u3053\u3053\u3067\u30cb\u30e5\u30fc\u30e9\u30eb\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306e\u8a08\u7b97\u30e2\u30c7\u30eb\u306b\u3064\u3044\u3066\u304a\u3055\u3089\u3044\u3057\u3066\u304a\u304d\u307e\u3057\u3087\u3046\u3002\n\\boldsymbol{l}^{(k+1)} = \\sigma^{(k+1)}(\\boldsymbol{W}^{(k+1)} \\boldsymbol{l}^{(k)} + \\boldsymbol{b}^{(k+1)}) \\tag*{[3]}\n\n\u3053\u306e\u8a18\u53f7\u306b\u5408\u308f\u305b\u3066\u3001\u8aa4\u5dee\u9006\u4f1d\u64ad\u6cd5\u306e\u5f0f\u3082\u793a\u3057\u3066\u3044\u304d\u307e\u3059\u3002\n\\begin{align}\n\\frac{\\partial L}{\\partial \\boldsymbol{l}^{(k)}} &= \\left\\{ \\begin{array}{ll}\n    \\text{Depend on } L & (\\text{if the } k \\text{-th layer is the output one}) \\\\\n    {\\boldsymbol{W}^{(k+1)}}^{\\top} \\cdot \\dfrac{\\partial L}{\\partial \\boldsymbol{b}^{(k+1)}} & (\\text{otherwise})\n\\end{array} \\right. \\tag{33} \\\\\n\\frac{\\partial L}{\\partial \\boldsymbol{b}^{(k)}} &= \\frac{\\partial L}{\\partial \\boldsymbol{l}^{(k)}} \\circ \\sigma'^{(k)}( \\boldsymbol{W}^{(k)} \\boldsymbol{l}^{(k-1)} + \\boldsymbol{b}^{(k)} ) \\tag{34} \\\\\n\\frac{\\partial L}{\\partial \\boldsymbol{W}^{(k)}} &= \\frac{\\partial L}{\\partial \\boldsymbol{b}^{(k)}} \\cdot {\\boldsymbol{l}^{(k-1)}}^{\\top} \\tag{35}\n\\end{align}\n\n\u5c64\u306e\u756a\u53f7 $k$ \u3092\u51fa\u529b\u5c64\u304b\u3089\u5165\u529b\u5c64\u306b\u5411\u304b\u3063\u3066\u9806\u756a\u306b\u6e1b\u3089\u3057\u3066\u3044\u304d\u3001\u640d\u5931\u95a2\u6570\u306b\u5bfe\u3059\u308b\u5404\u5c64\u306e\u91cd\u307f\u3068\u30d0\u30a4\u30a2\u30b9\u306e\u504f\u5fae\u5206\u3092\u6c42\u3081\u3066\u3044\u304d\u307e\u3059\u3002\n\u3053\u3053\u3067\u6ce8\u610f\u3059\u308b\u3079\u304d\u3053\u3068\u306f\u3001$k$ \u756a\u76ee\u306e\u5c64\u304c\u51fa\u529b\u5c64\u3060\u3068\u640d\u5931\u95a2\u6570\u6b21\u7b2c\u3067\u5f0f\u304c\u5909\u308f\u308b\u305f\u3081\u3001$\\partial L/\\partial \\boldsymbol{l}^{(k)}$ \u306b\u5834\u5408\u5206\u3051\u304c\u767a\u751f\u3059\u308b\u3053\u3068\u3067\u3059\u3002\n\u4e00\u822c\u5316\u3057\u305f\u5f0f $\\text{(33)}$ \uff5e $\\text{(35)}$ \u306f\u8a18\u53f7\u3092\u5909\u3048\u305f\u3060\u3051\u306a\u306e\u3067\u3059\u304c\u3001\u534a\u52a0\u7b97\u5668\u306e\u5b9f\u4f8b\u304b\u3089\u3059\u308b\u3068\u3001\u304b\u3048\u3063\u3066\u5206\u304b\u308a\u306b\u304f\u304f\u306a\u3063\u3066\u3057\u307e\u3063\u3066\u3044\u308b\u6c17\u304c\u3057\u307e\u3059\u3002\n\u6b63\u76f4\u306a\u3068\u3053\u308d\u3001\u4e00\u822c\u5316\u3057\u305f\u5f0f\u3067\u899a\u3048\u308b\u3088\u308a\u3082\u3001\u5b9f\u4f8b\u3067\u306e\u5f0f $\\text{(29)}$\u3001$\\text{(20')}$\u3001$\\text{(21)}$\u3001$\\text{(25)}$\u3001$\\text{(27')}$\u3001$\\text{(28)}$ \u3067\u899a\u3048\u3066\u304a\u3044\u305f\u307b\u3046\u304c\u697d\u304b\u306a\u3068\u601d\u3044\u307e\u3059\u3002\n\n\u3042\u308f\u305b\u3066\u8aad\u307f\u305f\u3044\n\n\u30cb\u30e5\u30fc\u30e9\u30eb\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u3068\u6df1\u5c64\u5b66\u7fd2\n\n\u8aa4\u5dee\u9006\u4f1d\u64ad\u6cd5\u306e\u30ce\u30fc\u30c8 by @Ugo-Nama\n\nDenoising Autoencoders\u306b\u304a\u3051\u308b\u78ba\u7387\u7684\u52fe\u914d\u964d\u4e0b\u6cd5\uff08\u6570\u5f0f\u306e\u5c0e\u51fa\uff09\nTSG Machine Learning \u00bb #08 \u78ba\u7387\u7684\u52fe\u914d\u964d\u4e0b\u6cd5\n\n\n\n\u304a\u308f\u308a\u306b\n\u8a18\u4e8b\u304c\u77ed\u3044\u3068\u8a73\u7d30\u306a\u8aac\u660e\u304c\u3067\u304d\u305a\u5206\u304b\u308a\u306b\u304f\u304f\u306a\u3063\u3066\u3057\u307e\u3046\u3057\u3001\u9577\u3044\u3068\u305d\u3082\u305d\u3082\u8aad\u3080\u6c17\u304c\u8d77\u3053\u3089\u306a\u3044\u3001\u3068\u3044\u3046\u30b8\u30ec\u30f3\u30de\u306b\u9665\u3063\u305f\u7d50\u679c\u3001\u3053\u306e\u8a18\u4e8b\u3067\u306f\u9577\u304f\u306a\u308b\u307b\u3046\u3092\u53d6\u308a\u307e\u3057\u305f\u3002\u3057\u304b\u3057\u305d\u308c\u306b\u3088\u3063\u3066\u5206\u304b\u308a\u3084\u3059\u304f\u306a\u3063\u305f\u304b\u306f\u4e0d\u660e\u3067\u3059\u304c\u2026\u3002\n\u77ed\u3059\u304e\u305a\u9577\u3059\u304e\u305a\u3061\u3087\u3046\u3069\u3088\u304f\u307e\u3068\u3081\u3089\u308c\u308b\u65b9\u304c\u7fa8\u307e\u3057\u3044\u3068\u601d\u3046\u4eca\u65e5\u3053\u306e\u9803\u3067\u3059\u3002\n\u8aa4\u5dee\u9006\u4f1d\u64ad\u6cd5\u306f\u3001\u7c21\u5358\u306a\u30e1\u30e2\u66f8\u304d\u304f\u3089\u3044\u306e\u5206\u91cf\u306e\u3082\u306e\u304b\u3089\u3001\u305d\u308c\u3053\u305d\u672c\u304c\u66f8\u3051\u3066\u3057\u307e\u3044\u305d\u3046\u306a\u5206\u91cf\u306e\u3082\u306e\u307e\u3067\u3001\u305f\u304f\u3055\u3093\u306e\u89e3\u8aac\u304c\u5b58\u5728\u3059\u308b\u306e\u3067\u3059\u304c\u3001\u81ea\u5206\u81ea\u8eab\u304c\u7406\u89e3\u3059\u308b\u305f\u3081\u306b\u306f\u3001\u7d50\u5c40\u306e\u3068\u3053\u308d\u81ea\u5206\u81ea\u8eab\u3067\u6570\u5f0f\u3092\u3053\u306d\u304f\u308a\u56de\u3057\u3001\u81ea\u5206\u81ea\u8eab\u3067\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u3057\u3066\u307f\u3066\u3001\u305d\u306e\u3068\u304d\u306e\u6c17\u4ed8\u304d\u3092\u982d\u306b\u305f\u305f\u304d\u8fbc\u3080\u3053\u3068\u304c\u4e00\u756a\u306e\u65b9\u6cd5\u3067\u306f\u306a\u3044\u304b\u3068\u601d\u3044\u307e\u3059\u3002\n\u5192\u982d\u3067\u66f8\u3044\u305f\u3088\u3046\u306b\u3001\u3053\u306e\u8a18\u4e8b\u306f\u79c1\u304c\u300c\u8aa4\u5dee\u9006\u4f1d\u64ad\u6cd5\u300d\u3092\u52c9\u5f37\u3059\u308b\u3046\u3048\u3067\u5fc5\u8981\u3060\u3063\u305f\u60c5\u5831\u3092\u8a18\u9332\u3057\u305f\u3082\u306e\u3067\u3059\u304c\u3001\u3053\u306e\u8a18\u4e8b\u304c\u7686\u3055\u307e\u306e\u304a\u5f79\u306b\u7acb\u3066\u305f\u3089\u5b09\u3057\u3044\u3067\u3059\u3002\n\u3082\u3057\u6570\u5f0f\u3084\u8003\u3048\u65b9\u306a\u3069\u3067\u3054\u4e0d\u660e\u306a\u70b9\u304c\u3042\u308c\u3070\u3001\u3054\u9060\u616e\u306a\u304f\u30b3\u30e1\u30f3\u30c8\u3057\u3066\u304f\u3060\u3055\u3044\u307e\u305b\u3002\n\u6700\u5f8c\u307e\u3067\u304a\u8aad\u307f\u3044\u305f\u3060\u304d\u3042\u308a\u304c\u3068\u3046\u3054\u3056\u3044\u307e\u3057\u305f\u3002\n\n\u5965\u4ed8\n\u8a18\u4e8b\u306b\u306f\u81ea\u5206\u306a\u308a\u306b\u3057\u3063\u304b\u308a\u3068\u76ee\u3092\u901a\u3057\u3066\u306f\u3044\u307e\u3059\u304c\u3001\u8aa4\u5b57\u8131\u5b57\u3001\u756a\u53f7\u53c2\u7167\u306e\u9593\u9055\u3044\u3001\u8868\u73fe\u306e\u8aa4\u308a\u306a\u3069\u304c\u3042\u308a\u307e\u3057\u305f\u3089\u3001\u30b3\u30e1\u30f3\u30c8\u6b04\u306b\u3066\u3054\u6307\u6458\u304f\u3060\u3055\u308b\u3068\u5e78\u3044\u3067\u3059\u3002\n\n\u521d\u7a3f \u300c\u8aa4\u5dee\u9006\u4f1d\u64ad\u6cd5\u3092\u306f\u3058\u3081\u304b\u3089\u3066\u3044\u306d\u3044\u306b\u300d\n\n\n2016/09/06\n\n\n\n\n\n\n\n\u300c\u9023\u9396\u5f8b\u300d\u306b\u3064\u3044\u3066\u306f\u82f1\u8a9e\u7248 Wikipedia \u306e\u307b\u3046\u304c\u3088\u308a\u8a73\u7d30\u306b\u8a18\u8f09\u3055\u308c\u3066\u3044\u307e\u3059\u3002\u00a0\u21a9\n\n\n\u753b\u50cf\u306f A Neural Network in 13 lines of Python (Part 2 - Gradient Descent) \u3088\u308a\u5f15\u7528\u3057\u307e\u3057\u305f\u3002\u00a0\u21a9\n\n\n\u6d3b\u6027\u5316\u95a2\u6570\u304c\u7dda\u5f62\u3067\u3042\u308b\u591a\u5c64\u30cb\u30e5\u30fc\u30e9\u30eb\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306b\u306f\u3001\u305d\u308c\u3068\u7b49\u4fa1\u306a\u5358\u5c64 (\u3064\u307e\u308a\u5165\u529b\u5c64\u3068\u51fa\u529b\u5c64\u3060\u3051) \u306e\u30cb\u30e5\u30fc\u30e9\u30eb\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u304c\u5b58\u5728\u3059\u308b\u3053\u3068\u304c\u5206\u304b\u3063\u3066\u3044\u307e\u3059\u3002\u30cb\u30e5\u30fc\u30e9\u30eb\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306f\u8868\u73fe\u529b\u3092\u5f37\u5316\u3059\u308b\u305f\u3081\u306b\u591a\u5c64\u69cb\u9020\u306b\u3055\u308c\u308b\u305f\u3081\u3001\u7dda\u5f62\u95a2\u6570\u3092\u6d3b\u6027\u5316\u95a2\u6570\u306b\u63a1\u7528\u3059\u308b\u3068\u305d\u306e\u610f\u5473\u304c\u5931\u308f\u308c\u3066\u3057\u307e\u3044\u307e\u3059\u3002\u00a0\u21a9\n\n\n\u6b63\u78ba\u306b\u3044\u3046\u3068\u3001\u3053\u306e\u30ce\u30eb\u30e0\u306f\u300c\u30e6\u30fc\u30af\u30ea\u30c3\u30c9\u30ce\u30eb\u30e0 (Euclidean norm)\u300d\u3042\u308b\u3044\u306f\u300c2-\u30ce\u30eb\u30e0\u300d\u306a\u3069\u3068\u3088\u3070\u308c\u307e\u3059\u3002\u00a0\u21a9\n\n\n\u4f9d\u5b58\u3059\u308b\u30d1\u30e9\u30e1\u30fc\u30bf\u304c\u5c11\u306a\u3044\u3053\u3068\u3002\u30b9\u30d1\u30fc\u30b9\u6027\u3092\u9ad8\u3081\u308b\u3068\u3001\u904e\u5b66\u7fd2 (overfitting) (\u3042\u308b\u3044\u306f\u904e\u5270\u9069\u5408\u3068\u3082) \u3092\u9632\u3050\u3053\u3068\u304c\u3067\u304d\u3001\u3088\u308a\u5b89\u5b9a\u3057\u305f (\u3088\u304f\u300c\u525b\u5065\u3067\u3042\u308b\u300d\u3068\u304b\u300c\u30ed\u30d0\u30b9\u30c8\u30cd\u30b9\u304c\u9ad8\u3044\u300d\u3068\u3044\u308f\u308c\u308b) \u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306b\u306a\u308a\u307e\u3059\u3002\u00a0\u21a9\n\n\n\u3053\u306e\u8a18\u4e8b\u3067\u306f\u3053\u308c\u4ee5\u964d\u300c\u5168\u4f53\u640d\u5931\u95a2\u6570\u300d\u3068\u3044\u3046\u540d\u79f0\u3092\u305f\u3073\u305f\u3073\u4f7f\u3044\u307e\u3059\u304c\u3001\u4e00\u822c\u7684\u306a\u7528\u8a9e\u3067\u306f\u3042\u308a\u307e\u305b\u3093\u306e\u3067\u3054\u6ce8\u610f\u304f\u3060\u3055\u3044\u3002\u00a0\u21a9\n\n\n\u3061\u306a\u307f\u306b\u3001\u6392\u4ed6\u7684\u8ad6\u7406\u548c\u306f\u96a0\u308c\u5c64\u306e\u306a\u3044 2 \u5c64\u306e\u30cb\u30e5\u30fc\u30e9\u30eb\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u3067\u306f\u8868\u73fe\u3067\u304d\u306a\u3044\u3053\u3068\u304c\u5206\u304b\u3063\u3066\u3044\u307e\u3059\u3002\u00a0\u21a9\n\n\n\u81ea\u5206\u3082\u300c\u672c\u5f53\u304b\u306a\u3041\uff1f\u300d\u3068\u4e0d\u601d\u8b70\u306b\u601d\u3063\u3066\u691c\u7b97\u3057\u307e\u3057\u305f\u3002\u3053\u308c\u306b\u9650\u3063\u305f\u8a71\u3067\u306f\u3042\u308a\u307e\u305b\u3093\u304c\u3001\u81ea\u5206\u306e\u624b\u3067\u30ce\u30fc\u30c8\u306b\u8a08\u7b97\u5f0f\u3092\u66f8\u3044\u3066\u89e3\u3044\u3066\u3044\u304f\u3068\u3001\u7406\u8ad6\u304c\u982d\u306e\u4e2d\u306b\u3059\u3063\u3068\u5165\u3063\u3066\u304f\u308b\u306e\u304c\u5b9f\u611f\u3067\u304d\u307e\u3059\u3002\u5b9f\u969b\u306b\u89e3\u3044\u3066\u307f\u308b\u3053\u3068\u306f\u975e\u5e38\u306b\u5927\u4e8b\u3067\u3059\u2026\u3068\u3044\u3046\u3053\u3068\u3092\u6ce8\u91c8\u3067\u3055\u3089\u3063\u3068\u66f8\u3044\u3066\u307f\u308b\u3002\u00a0\u21a9\n\n\n\u753b\u50cf\u306f Sigmoid function (Wikipedia \u82f1\u8a9e\u7248) \u3088\u308a\u5f15\u7528\u3057\u307e\u3057\u305f\u3002\u00a0\u21a9\n\n\n\u30cb\u30e5\u30fc\u30e9\u30eb\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306e\u5b66\u7fd2\u306f\u3001\u640d\u5931\u95a2\u6570\u3084\u5b66\u7fd2\u7387 (\u6700\u6025\u964d\u4e0b\u6cd5\u306e\u504f\u5fae\u5206\u9805\u306b\u4ed8\u304f\u4fc2\u6570)\u3001\u91cd\u307f\u3068\u30d0\u30a4\u30a2\u30b9\u306e\u521d\u671f\u5024\u7b49\u3001\u305f\u304f\u3055\u3093\u306e\u30d1\u30e9\u30e1\u30fc\u30bf\u304c\u3042\u308b\u305f\u3081\u3001\u305d\u306e\u5024\u306b\u3088\u3063\u3066\u306f\u5b66\u7fd2\u304c\u3046\u307e\u304f\u3044\u304f\u3068\u304d\u3068\u3044\u304b\u306a\u3044\u3068\u304d\u304c\u3042\u308a\u307e\u3059\u3002\u00a0\u21a9\n\n\n\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u306f\u3068\u306b\u304b\u304f\u5206\u304b\u308a\u3084\u3059\u3055\u3092\u91cd\u8996\u3057\u3066\u3001\u901f\u5ea6\u3084\u52b9\u7387\u306f\u4e00\u5207\u6c17\u306b\u3057\u3066\u3044\u307e\u305b\u3093\u3002\u305d\u3053\u306b\u3064\u3044\u3066\u306f\u3054\u52d8\u5f01\u304f\u3060\u3055\u3044\u307e\u305b\u3002\u00a0\u21a9\n\n\n\n\n# \u306f\u3058\u3081\u306b\n\n\u3053\u306e\u8a18\u4e8b\u306f\u3001\u79c1\u304c\u6a5f\u68b0\u5b66\u7fd2\u3001\u7279\u306b\u300c**\u8aa4\u5dee\u9006\u4f1d\u64ad\u6cd5**\u300d (\u3042\u308b\u3044\u306f\u300c[**\u30d0\u30c3\u30af\u30d7\u30ed\u30d1\u30b2\u30fc\u30b7\u30e7\u30f3** (Backpropagation)](https://ja.wikipedia.org/wiki/%E3%83%90%E3%83%83%E3%82%AF%E3%83%97%E3%83%AD%E3%83%91%E3%82%B2%E3%83%BC%E3%82%B7%E3%83%A7%E3%83%B3)\u300d) \u3092\u52c9\u5f37\u3059\u308b\u3046\u3048\u3067\u8fbf\u3063\u305f\u9053\u7b4b\u3092\u8a18\u9332\u3057\u3066\u304a\u304f\u3082\u306e\u3067\u3059\u3002\n\u8aa4\u5dee\u9006\u4f1d\u64ad\u6cd5\u306b\u95a2\u3059\u308b\u5206\u304b\u308a\u3084\u3059\u3044\u89e3\u8aac\u306f\u3001\u3053\u3053 Qiita \u306b\u3082\u591a\u6570\u5b58\u5728\u3057\u307e\u3059\u306e\u3067\u3001\u6b63\u76f4 $n$ \u756a\u714e\u3058\u306a\u3068\u3053\u308d\u304c\u3042\u308a\u307e\u3059\u304c\u3001\u3042\u304f\u307e\u3067\u8a18\u9332\u3067\u3059\u306e\u3067\u3053\u3053\u306f 1 \u3064\u3002\n\u300c\u8a18\u9332\u300d\u3068\u3044\u3046\u306b\u306f\u9577\u904e\u304e\u3066\u30a4\u30de\u30a4\u30c1\u611f\u6ea2\u308c\u3066\u307e\u3059\u304c\u3001\u305d\u3053\u306f\u6c17\u306b\u3057\u306a\u3044\u3067\u304f\u3060\u3055\u3044\u3002\u3053\u308c\u3067\u3082\u8981\u70b9\u3092\u3057\u307c\u3063\u305f\u3064\u3082\u308a\u306a\u306e\u3067\u3059\u2026:sweat_smile:\n\u3086\u3063\u304f\u308a\u3057\u3066\u3044\u3063\u3066\u306d\uff01\uff01\uff01\n\n## \u9014\u4e2d\u306e\u6570\u5f0f\u306b\u3064\u3044\u3066\n\n\u8a18\u4e8b\u306e\u524d\u5f8c\u304b\u3089\u53c2\u7167\u3055\u308c\u3066\u3044\u308b\u6570\u5f0f\u306b\u3064\u3044\u3066\u306f\u53f3\u5074\u306b\u756a\u53f7\u3092\u632f\u3063\u3066\u3044\u307e\u3059\u3002\n\u521d\u56de\u8a18\u8f09\u6642\u306f $\\text{(1)}$ \u3068\u304b\u3063\u3053\u4ed8\u304d\u6570\u5b57\u3067\u30012 \u56de\u76ee\u4ee5\u964d\u8a18\u8f09\u6642\u306f $\\text{[1]}$ \u3068\u89d2\u304b\u3063\u3053\u4ed8\u304d\u6570\u5b57\u3067\u793a\u3057\u307e\u3059\u3002\u8a18\u8f09\u6e08\u307f\u306e\u6570\u5f0f\u3092\u5909\u5f62\u3057\u305f\u3082\u306e\u306b\u3064\u3044\u3066\u306f $\\text{(1')}$ \u3068\u30d7\u30e9\u30a4\u30e0\u4ed8\u304d\u6570\u5b57\u3067\u793a\u3057\u307e\u3059\u3002\n\n\u756a\u53f7\u304c\u632f\u3089\u308c\u3066\u3044\u306a\u3044\u6570\u5f0f\u306f\u3001\u524d\u5f8c\u304b\u3089\u53c2\u7167\u3055\u308c\u306a\u304b\u3063\u305f\u3053\u3068\u3092\u793a\u3059\u3060\u3051\u3067\u3001\u305d\u306e\u5f0f\u306e\u91cd\u8981\u6027\u304c\u4f4e\u3044\u3053\u3068\u3092\u8868\u3059\u3082\u306e\u3067\u306f\u3042\u308a\u307e\u305b\u3093\u3002\n\n\n# \u8aa4\u5dee\u9006\u4f1d\u64ad\u6cd5\u306e\u5c4b\u53f0\u9aa8\n\n\u8aa4\u5dee\u9006\u4f1d\u64ad\u6cd5\u306f\u3001\u300c[**\u9023\u9396\u5f8b** (chain rule)](https://ja.wikipedia.org/wiki/%E9%80%A3%E9%8E%96%E5%BE%8B)\u300d[^chain_rule_wikipedia_english] \u3068\u3044\u3046\u5b9a\u7406\u3068\u300c[**\u6700\u6025\u964d\u4e0b\u6cd5** (gradient descent)](https://ja.wikipedia.org/wiki/%E6%9C%80%E6%80%A5%E9%99%8D%E4%B8%8B%E6%B3%95)\u300d\u3068\u3044\u3046\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u306e 2 \u3064\u306b\u3088\u3063\u3066\u652f\u3048\u3089\u308c\u3066\u3044\u307e\u3059\u3002\n\n[^chain_rule_wikipedia_english]: \u300c\u9023\u9396\u5f8b\u300d\u306b\u3064\u3044\u3066\u306f[\u82f1\u8a9e\u7248 Wikipedia](https://en.wikipedia.org/wiki/Chain_rule) \u306e\u307b\u3046\u304c\u3088\u308a\u8a73\u7d30\u306b\u8a18\u8f09\u3055\u308c\u3066\u3044\u307e\u3059\u3002\n\n## \u9023\u9396\u5f8b\n\n\u300c\u9023\u9396\u5f8b\u300d\u3068\u306f\u3001\u8907\u6570\u306e\u95a2\u6570\u304c\u7d44\u307f\u5408\u308f\u3055\u3063\u305f *\u5408\u6210\u95a2\u6570* \u3092\u5fae\u5206\u3059\u308b\u969b\u306e\u30eb\u30fc\u30eb\u306e\u3053\u3068\u3067\u3059\u3002\n\n\u95a2\u6570 $f$ \u304a\u3088\u3073 $g_{(n)}\\ \\small{(n \\in 1, 2, \\dots, N)}$ \u3092\u4f7f\u3063\u3066\u3001$z = f(y_1, y_2, \\dots, y_N)$\u3001$y_n = g_{(n)}(x_1, x_2, \\dots, x_i, \\dots)$ \u3068\u8868\u3059\u3053\u3068\u304c\u3067\u304d\u3001\n\n1. \u95a2\u6570 $f$ \u304c $y_1, y_2, \\dots, y_N$ \u306b\u304a\u3044\u3066\u5168\u5fae\u5206\u53ef\u80fd\u3067\u3042\u308b\u3002\n1. \u95a2\u6570 $g_{(n)}$ \u304c\u305d\u308c\u305e\u308c $x_i$ \u306b\u3064\u3044\u3066\u504f\u5fae\u5206\u53ef\u80fd\u3067\u3042\u308b\u3002\n\n\u306e 2 \u3064\u3092\u6e80\u305f\u3059\u3068\u304d\u3001\u4ee5\u4e0b\u306e $\\text{(1)}$ \u304c\u6210\u308a\u7acb\u3061\u307e\u3059\u3002\n\n```math\n\\begin{align}\n\\frac{\\partial z}{\\partial x_i} &= \\frac{\\partial z}{\\partial y_1}\\cdot\\frac{\\partial y_1}{\\partial x_i} + \\frac{\\partial z}{\\partial y_2}\\cdot\\frac{\\partial y_2}{\\partial x_i} + \\cdots + \\frac{\\partial z}{\\partial y_N}\\cdot\\frac{\\partial y_N}{\\partial x_i} \\\\\n&= \\sum_{n=1}^{N} \\frac{\\partial z}{\\partial y_n}\\cdot\\frac{\\partial y_n}{\\partial x_i}\n\\end{align} \\tag{1}\n```\n\n\u3044\u304d\u306a\u308a\u4e00\u822c\u5316\u3055\u308c\u305f\u5f0f\u304c\u51fa\u3066\u304d\u3066\u96e3\u3057\u304f\u611f\u3058\u308b\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u304c\u3001\u30a4\u30e1\u30fc\u30b8\u3068\u3057\u3066\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u899a\u3048\u3066\u304a\u304f\u3068\u3088\u3044\u304b\u3068\u601d\u3044\u307e\u3059\u3002\n\n* \u5909\u6570\u304c\u4e2d\u7d99\u3059\u308b (\u4f8b\u3048\u3070 $z$ \u2192 $y_1$ \u2192 $x_i$) \u5834\u5408\u3001\u504f\u5fae\u5206\u306f\u5404\u3005\u306e *\u7a4d* \u3067\u8868\u3059\u3002\n* \u5909\u6570\u304c\u8907\u6570\u306b\u5206\u5c90\u3059\u308b ($z$ \u2192 $y_1, y_2, \\dots, y_N$) \u5834\u5408\u3001\u504f\u5fae\u5206\u306f\u5404\u3005\u306e *\u548c* \u3067\u8868\u3059\u3002\n\n\u3061\u306a\u307f\u306b\u95a2\u6570 $f$ \u3068 $g_{(n)}$ \u304c\u3069\u3061\u3089\u3082 1 \u5909\u6570\u95a2\u6570\u306e\u5834\u5408\u3001\u9023\u9396\u5f8b\u306f\u7a4d\u306e\u30eb\u30fc\u30eb\u3060\u3051\u304c\u6b8b\u3063\u3066\u975e\u5e38\u306b\u7c21\u5358\u306b\u8868\u3059\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n```math\n\\frac{dz}{dx} = \\frac{dz}{dy}\\cdot\\frac{dy}{dx}\n```\n\n\u300c\u5408\u6210\u95a2\u6570\u306e\u5fae\u5206\u300d\u3068\u3057\u3066\u3001\u9ad8\u6821\u6570\u5b66\u306e\u6570\u2162\u3067\u7fd2\u3063\u305f\u65b9\u3082\u591a\u3044\u306e\u3067\u306f\u306a\u3044\u3067\u3057\u3087\u3046\u304b\u3002$y = \\log(\\sin^2x)$ \u3092\u5fae\u5206\u305b\u3088\u3001\u3068\u304b\u3002\n\n\u306a\u304a\u3001\u9023\u9396\u5f8b\u306f\u65e2\u306b\u8a3c\u660e\u3055\u308c\u3066\u3044\u308b\u3082\u306e\u3067\u3059\u306e\u3067\u3001\u3053\u306e\u8a18\u4e8b\u3067\u306f\u3042\u308a\u304c\u305f\u304f\u4f7f\u308f\u305b\u3066\u3044\u305f\u3060\u304d\u3001\u8a3c\u660e\u306f\u5272\u611b\u3057\u307e\u3059\u304c\u3001\u4f8b\u3048\u3070[\u6771\u5927\u306e\u6e05\u91ce\u5148\u751f\u304c\u884c\u3063\u3066\u3044\u308b\u30bc\u30df](http://lecture.ecc.u-tokyo.ac.jp/~nkiyono/16_6.html)\u306e\u8cc7\u6599\u3067\u304b\u306a\u308a\u4e01\u5be7\u306b\u8a3c\u660e\u3092\u89e3\u8aac\u3055\u308c\u3066\u3044\u307e\u3059\u306e\u3067\u3001\u53c2\u8003\u306b\u3057\u3066\u307f\u3066\u304f\u3060\u3055\u3044\u3002\n\n## \u6700\u6025\u964d\u4e0b\u6cd5\n\n\u300c\u6700\u6025\u964d\u4e0b\u6cd5\u300d\u306f\u3001\u95a2\u6570 $f(\\boldsymbol{x})$ \u304c\u6700\u5c0f\u5024\u3092\u3068\u308b\u3068\u304d\u306e\u5909\u6570 $\\boldsymbol{x}$ \u306e\u5024\u3092\u3001\u95a2\u6570\u306e\u5fae\u5206\u3001\u3064\u307e\u308a 1 \u968e\u5c0e\u95a2\u6570\u306e\u307f\u3092\u4f7f\u3063\u3066\u6c42\u3081\u308b\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u306e 1 \u3064\u3067\u3059\u3002\n\u95a2\u6570\u306e\u6700\u5c0f\u5024\u3042\u308b\u3044\u306f\u6700\u5927\u5024\u3092\u6c42\u3081\u308b\u554f\u984c\u3092\u300c[**\u6700\u9069\u5316\u554f\u984c**](https://ja.wikipedia.org/wiki/%E6%9C%80%E9%81%A9%E5%8C%96%E5%95%8F%E9%A1%8C)\u300d\u3068\u3088\u3073\u307e\u3059\u304c\u3001\u305d\u306e\u4e2d\u3067\u3082\u6700\u6025\u964d\u4e0b\u6cd5\u306f\u3001\u554f\u984c\u3092\u89e3\u304f\u305f\u3081\u306b\u5c0e\u95a2\u6570\u304c\u5fc5\u8981\u306a\u300c[**\u52fe\u914d\u6cd5**](https://ja.wikipedia.org/wiki/%E5%8B%BE%E9%85%8D%E6%B3%95)\u300d\u306e\u30ab\u30c6\u30b4\u30ea\u30fc\u306b\u5c5e\u3057\u307e\u3059\u3002\n\n```math\n\\begin{align}\n\\boldsymbol{x}^{(k+1)} &= \\boldsymbol{x}^{(k)} - \\eta \\frac{\\partial}{\\partial \\boldsymbol{x}^{(k)}} f(\\boldsymbol{x}^{(k)}) \\\\\n&= \\boldsymbol{x}^{(k)} - \\eta \\begin{bmatrix}\n\\dfrac{\\partial f(\\boldsymbol{x}^{(k)})}{\\partial x_1^{(k)}} \\\\\n\\dfrac{\\partial f(\\boldsymbol{x}^{(k)})}{\\partial x_2^{(k)}} \\\\\n\\vdots \\\\\n\\dfrac{\\partial f(\\boldsymbol{x}^{(k)})}{\\partial x_n^{(k)}}\n\\end{bmatrix}\n\\end{align} \\tag{2}\n```\n\n$\\boldsymbol{x}$ \u306e\u53f3\u80a9\u306b\u3042\u308b\u304b\u3063\u3053\u306e\u4e2d\u306f\u53cd\u5fa9\u306e\u56de\u6570\u3067\u3042\u308a\u3001$k$ \u56de\u76ee\u306e\u5024\u304b\u3089\u3001\u65b0\u3057\u304f $k+1$ \u56de\u76ee\u306e\u5024\u3092\u6c42\u3081\u308b\u6f38\u5316\u5f0f\u306b\u306a\u3063\u3066\u3044\u307e\u3059\u3002\n\u4fc2\u6570 $\\eta$ (\u30a8\u30fc\u30bf) \u306b\u7279\u306b\u540d\u524d\u306f\u4ed8\u3044\u3066\u3044\u307e\u305b\u3093\u304c\u3001\u6a5f\u68b0\u5b66\u7fd2\u3067\u3053\u306e\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u304c\u5229\u7528\u3055\u308c\u308b\u3068\u304d\u306f\u300c**\u5b66\u7fd2\u7387** (learning rate)\u300d\u3068\u3088\u3070\u308c\u305f\u308a\u3057\u307e\u3059\u3002\n\n\u65e2\u306b $\\text{(2)}$ \u304b\u3089\u660e\u3089\u304b\u3067\u3059\u304c\u3001\u6700\u6025\u964d\u4e0b\u6cd5\u306b\u304a\u3051\u308b $\\boldsymbol{x}$ \u306e\u4fee\u6b63\u65b9\u91dd\u306f\u4ee5\u4e0b\u306e 2 \u70b9\u3067\u3059\u3002\n\n1. \u5fae\u5206\u4fc2\u6570\u306e\u7d76\u5bfe\u5024\u304c\u5927\u304d\u3044\u307b\u3069\u6b63\u89e3\u304b\u3089\u96e2\u308c\u3066\u3044\u308b\u3068\u5224\u65ad\u3057\u3066\u3001\u3088\u308a\u5927\u80c6\u306b\u4fee\u6b63\u3059\u308b (\uff1d\u4fee\u6b63\u91cf\u3092\u5927\u304d\u304f\u3059\u308b)\u3002\n1. \u5fae\u5206\u4fc2\u6570\u304c\u50be\u304d\u3092\u8868\u3059\u6027\u8cea\u304b\u3089\u3001\u5fae\u5206\u4fc2\u6570\u306e\u7b26\u53f7\u3068\u306f\u9006\u306e\u65b9\u5411\u306b\u4fee\u6b63\u3059\u308b\u3002\n\n\u3053\u308c\u306f $\\boldsymbol{x}$ \u304c 1 \u5909\u6570\u3067\u3001$f(\\boldsymbol{x})$ \u304c 2 \u6b21\u95a2\u6570\u3067\u4e0b\u306b\u51f8\u3060\u3063\u305f\u3068\u304d\u306e\u30b0\u30e9\u30d5\u3092\u601d\u3044\u6d6e\u304b\u3079\u3066\u307f\u308b\u3068\u5206\u304b\u308a\u3084\u3059\u3044\u3068\u601d\u3044\u307e\u3059\u3002[^gradient_descent_citation]\n\n![2 \u6b21\u95a2\u6570\u306b\u304a\u3051\u308b\u6700\u6025\u964d\u4e0b\u6cd5](https://iamtrask.github.io/img/sgd_optimal.png)\n\n$\\boldsymbol{x}$ \u304c\u591a\u5909\u6570\u3001\u3064\u307e\u308a\u30d9\u30af\u30c8\u30eb\u306b\u306a\u3063\u3066\u3082\u8003\u3048\u65b9\u306f\u540c\u3058\u3067\u3001$f(\\boldsymbol{x})$ \u306b\u5e73\u9762\u30fb\u8d85\u5e73\u9762\u7684\u306a \u201c\u304f\u307c\u307f\u201d \u304c\u5b58\u5728\u3059\u308c\u3070\u3001\u305d\u3053\u306b\u843d\u3061\u7740\u3044\u3066\u3044\u304f\u3053\u3068\u306b\u306a\u308a\u307e\u3059\u3002\n\u305f\u3060\u3057\u3001\u500b\u3005\u306e\u5909\u6570\u3092\u4fee\u6b63\u3059\u308b\u305f\u3081\u306b\u306f $x_1, x_2, \\dots, x_n$ \u305d\u308c\u305e\u308c\u306e\u5024\u306e\u5909\u5316\u306b\u5bfe\u3059\u308b $f(\\boldsymbol{x})$ \u306e\u5897\u6e1b\u306b\u6ce8\u76ee\u3059\u308b\u5fc5\u8981\u304c\u751f\u3058\u308b\u305f\u3081\u3001\u5f0f\u306f\u504f\u5fae\u5206\u306b\u306a\u3063\u3066\u3044\u308b\u308f\u3051\u3067\u3059\u3002\n\n\u975e\u5e38\u306b\u30b7\u30f3\u30d7\u30eb\u3067\u5206\u304b\u308a\u3084\u3059\u3044\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u3067\u3059\u304c\u3001\u6ce8\u610f\u3059\u308b\u3079\u304d\u70b9\u3082\u3042\u308a\u307e\u3059\u3002\n\n* $\\boldsymbol{x}$ \u304c\u53ce\u675f\u3057\u305f\u3068\u3057\u3066\u3082\u3001\u305d\u306e\u3068\u304d\u306e $f(\\boldsymbol{x})$ \u304c\u6700\u5c0f\u5024\u3067\u3042\u308b\u3068\u306f\u9650\u3089\u306a\u3044\u3002\n\t* \u4f8b\u3048\u3070 4 \u6b21\u95a2\u6570\u306e\u3088\u3046\u306b \u201c\u304f\u307c\u307f\u201d \u304c\u8907\u6570\u7b87\u6240\u5b58\u5728\u3059\u308b\u5834\u5408\u3001\u6700\u5c0f\u3067\u306f\u306a\u3044 \u201c\u304f\u307c\u307f\u201d \u306b\u30cf\u30de\u3063\u3066\u629c\u3051\u51fa\u305b\u306a\u304f\u306a\u308a\u3001\u305d\u306e\u4e2d\u306e\u6700\u5c0f\u5024 (\u3064\u307e\u308a\u6975\u5c0f\u5024) \u3092\u89e3\u3068\u52d8\u9055\u3044\u3059\u308b\u3053\u3068\u304c\u8d77\u3053\u308a\u3046\u308b\u3002\n\t* \u3053\u306e\u3088\u3046\u306b\u3001\u554f\u984c\u304c\u89e3\u3051\u3066\u3044\u308b\u3088\u3046\u306b\u898b\u3048\u3066\u5b9f\u306f\u6b63\u89e3 (**\u5927\u57df\u7684\u6700\u9069\u89e3**) \u3067\u306f\u306a\u3044\u89e3\u3092**\u5c40\u6240\u7684\u6700\u9069\u89e3**\u3068\u3044\u3046\u3002\n* \u53ce\u675f\u30b9\u30d4\u30fc\u30c9\u304c\u5c0e\u95a2\u6570\u306b\u4f9d\u5b58\u3057\u3066\u304a\u308a\u3001\u5fae\u5206\u4fc2\u6570\u304c 0 \u306b\u8fd1\u3044\u3068\u53ce\u675f\u304c *\u304d\u308f\u3081\u3066* \u9045\u304f\u306a\u308b\u3002\n\t* \u52fe\u914d\u6cd5\u306e\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u306f\u5e38\u306b\u3053\u306e\u5371\u967a\u304c\u3064\u304d\u307e\u3068\u3044\u3001\u300c[**\u52fe\u914d\u6d88\u5931\u554f\u984c** (vanishing gradient problem)](https://en.wikipedia.org/wiki/Vanishing_gradient_problem)\u300d\u3068\u3088\u3070\u308c\u308b\u3002\n* \u4fc2\u6570 $\\eta$ \u306f\u5927\u304d\u3059\u304e\u3066\u3082\u5c0f\u3055\u3059\u304e\u3066\u3082\u3088\u304f\u306a\u3044\u3002\u307e\u305f\u3001$f(\\boldsymbol{x})$ \u304a\u3088\u3073\u305d\u306e\u5c0e\u95a2\u6570\u306b\u3088\u3063\u3066\u6700\u9069\u306a\u5024\u306f\u7570\u306a\u308b\u3002\n\t* $\\eta$ \u304c\u5927\u304d\u3044\u3068\u767a\u6563\u30fb\u632f\u52d5\u3092\u8d77\u3053\u3059\u5371\u967a\u304c\u9ad8\u304f\u306a\u308a\u3001\u9006\u306b\u5c0f\u3055\u3044\u3068\u53ce\u675f\u304c\u9045\u304f\u306a\u308b\u3002\n\t* $\\boldsymbol{x}$ \u306e\u4fee\u6b63\u91cf\u306f $\\eta$ \u3068\u5fae\u5206\u4fc2\u6570\u306b\u3088\u3063\u3066\u6c7a\u307e\u308b\u305f\u3081\u3001\u5fae\u5206\u4fc2\u6570\u304c\u5927\u304d\u3059\u304e\u308b\u30fb\u5c0f\u3055\u3059\u304e\u308b\u3068\u304d\u306e\u5bfe\u7b56\u304c\u5fc5\u8981\u306a\u5834\u5408\u304c\u3042\u308b\u3002\n\n\u3053\u308c\u3089\u306e\u6ce8\u610f\u70b9\u306f\u3001\u8fd1\u5e74\u306e\u7814\u7a76\u306b\u3088\u3063\u3066\u6539\u5584\u3057\u305f\u308a\u3001\u554f\u984c\u3092\u8d77\u3053\u3055\u306a\u3044\u3088\u3046\u306a\u30d1\u30e9\u30e1\u30fc\u30bf\u8a2d\u5b9a\u306a\u3069\u304c\u63d0\u6848\u3055\u308c\u3066\u3044\u307e\u3059\u304c\u3001\u3053\u3053\u3067\u306f\u8aa4\u5dee\u9006\u4f1d\u64ad\u6cd5\u306e\u30b3\u30a2\u306e\u90e8\u5206\u3092\u53d6\u308a\u4e0a\u3052\u305f\u3044\u306e\u3067\u3001\u3042\u307e\u308a\u6df1\u304f\u8003\u3048\u306a\u3044\u3053\u3068\u306b\u3057\u307e\u3059\u3002\n\n[^gradient_descent_citation]: \u753b\u50cf\u306f [***A Neural Network in 13 lines of Python (Part 2 - Gradient Descent)***](http://iamtrask.github.io/2015/07/27/python-network-part2/) \u3088\u308a\u5f15\u7528\u3057\u307e\u3057\u305f\u3002\n\n\n# \u9806\u4f1d\u64ad\u578b\u30cb\u30e5\u30fc\u30e9\u30eb\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\n\n\u300c**\u9806\u4f1d\u64ad\u578b\u30cb\u30e5\u30fc\u30e9\u30eb\u30cd\u30c3\u30c8\u30ef\u30fc\u30af**\u300d (\u3042\u308b\u3044\u306f\u300c[**\u30d5\u30a3\u30fc\u30c9\u30d5\u30a9\u30ef\u30fc\u30c9\u30cb\u30e5\u30fc\u30e9\u30eb\u30cd\u30c3\u30c8\u30ef\u30fc\u30af** (feedforward neural network)](https://en.wikipedia.org/wiki/Feedforward_neural_network)\u300d) \u306f\u3001\u4ee5\u4e0b\u3092\u6e80\u305f\u3059\u30cb\u30e5\u30fc\u30e9\u30eb\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306e\u3053\u3068\u3067\u3059\u3002\n\n1. *\u5c64\u72b6\u306e* \u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u3067\u3001\u30ce\u30fc\u30c9\u306e\u3059\u3079\u3066\u304c\u300c**\u5c64** (layer)\u300d\u306e\u3044\u305a\u308c\u304b\u306b\u5c5e\u3059\u308b\u3002\n\t* \u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306b\u5165\u529b\u3055\u308c\u305f\u30c7\u30fc\u30bf\u3092\u6301\u3064\u30ce\u30fc\u30c9\u306e\u5c64\u306f\u300c**\u5165\u529b\u5c64** (input layer)\u300d\u3001\u524d\u306e\u5c64\u304c\u6301\u3064\u5024\u3092\u4f7f\u3063\u3066\u6f14\u7b97\u3057\u305f\u7d50\u679c\u3092\u6301\u3064\u30ce\u30fc\u30c9\u306e\u5c64\u306f\u300c**\u96a0\u308c\u5c64** (hidden layer)\u300d\u3001\u96a0\u308c\u5c64\u3068\u540c\u3058\u304f\u6f14\u7b97\u7d50\u679c\u3092\u6301\u3064\u30ce\u30fc\u30c9\u306e\u5c64\u3067\u3001\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306e\u6700\u7d42\u306b\u3042\u308b\u5c64\u3092\u300c**\u51fa\u529b\u5c64** (output layer)\u300d\u3068\u3088\u3076\u3002\n\t* \u96a0\u308c\u5c64\u304c\u8907\u6570\u3042\u308b\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u3084\u3001\u9006\u306b\u96a0\u308c\u5c64\u3092\u6301\u305f\u305a\u3001\u5165\u529b\u5c64\u3068\u51fa\u529b\u5c64\u3057\u304b\u306a\u3044\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u3082\u3042\u308b\u3002\n1. \u3059\u3079\u3066\u306e\u30ce\u30fc\u30c9\u306f\u3001\u96a3\u63a5\u3059\u308b\u5c64\u306e\u30ce\u30fc\u30c9\u3068\u306e\u9593\u306b\u306e\u307f\u63a5\u7d9a\u3092\u6301\u3064\u3002\u540c\u4e00\u5c64\u3069\u3046\u3057\u306e\u63a5\u7d9a\u3084\u3001\u5c64\u3092\u307e\u305f\u3044\u3060\u63a5\u7d9a\u306f\u306a\u3044\u3002\n\n\u8a00\u8449\u3067\u66f8\u304f\u3068\u3072\u305f\u3059\u3089\u3084\u3084\u3053\u3057\u3044\u3067\u3059\u304c\u3001\u8981\u306f\u4e0b\u306e\u56f3\u306e\u3088\u3046\u306a\u5f62\u3092\u3057\u305f\u30cb\u30e5\u30fc\u30e9\u30eb\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306e\u3053\u3068\u3092\u6307\u3057\u307e\u3059\u3002\n\n![\u9806\u4f1d\u64ad\u578b\u30cb\u30e5\u30fc\u30e9\u30eb\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306e\u56f3](https://qiita-image-store.s3.amazonaws.com/0/107860/27d403db-6bcc-33fb-1794-bc17b0bfe17f.png)\n\n\u51fa\u529b\u5c64\u3067\u6211\u3005\u306e\u671b\u3093\u3060\u7d50\u679c\u304c\u51fa\u308b\u3088\u3046\u306b\u30d1\u30e9\u30e1\u30fc\u30bf\u3092\u8abf\u6574\u3059\u308b\u4f5c\u696d\u304c\u3001\u30cb\u30e5\u30fc\u30e9\u30eb\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306b\u304a\u3051\u308b\u300c\u5b66\u7fd2\u300d\u3067\u3059\u3002\n\u306a\u304a\u3053\u308c\u4ee5\u964d\u3001\u5358\u306b\u300c\u30cb\u30e5\u30fc\u30e9\u30eb\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u300d\u3042\u308b\u3044\u306f\u300c\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u300d\u3068\u66f8\u3044\u305f\u5834\u5408\u306f\u3001\u3053\u306e\u300c\u9806\u4f1d\u64ad\u578b\u30cb\u30e5\u30fc\u30e9\u30eb\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u300d\u3092\u6307\u3059\u3053\u3068\u306b\u3057\u307e\u3059\u3002\n\n## \u8a08\u7b97\u30e2\u30c7\u30eb\n\n\u5148\u307b\u3069\u96a0\u308c\u5c64\u306e\u8aac\u660e\u3067\u3001\u201c\u524d\u306e\u5c64\u304c\u6301\u3064\u5024\u3092\u4f7f\u3063\u3066\u6f14\u7b97\u3057\u305f\u7d50\u679c\u3092\u6301\u3064\u201d \u3068\u66f8\u304d\u307e\u3057\u305f\u3002\n\u30cb\u30e5\u30fc\u30e9\u30eb\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306b\u304a\u3044\u3066\u3001\u4e00\u822c\u306b\u3053\u306e\u6f14\u7b97\u306f \u201c\u524d\u306e\u5c64\u306e\u5024\u306b\u4fc2\u6570\u3092\u639b\u3051\u3066\u8db3\u3057\u5408\u308f\u305b\u308b\u201d \u3068\u3044\u3046\u3082\u306e\u3067\u3001\u4ee5\u4e0b\u306e\u8a08\u7b97\u30e2\u30c7\u30eb $\\text{(3)}$ \u3067\u793a\u3055\u308c\u307e\u3059\u3002\n\n```math\n\\boldsymbol{l}^{(k+1)} = \\sigma^{(k+1)}(\\boldsymbol{W}^{(k+1)} \\boldsymbol{l}^{(k)} + \\boldsymbol{b}^{(k+1)}) \\tag{3}\n```\n\n\u5404\u8a18\u53f7\u306e\u53f3\u80a9\u306b\u3042\u308b\u304b\u3063\u3053\u306e\u4e2d\u306f\u5c64\u306e\u756a\u53f7\u3067\u3042\u308a\u3001$k$ \u756a\u76ee\u306e\u5c64\u304c\u6301\u3064\u5024 $\\boldsymbol{l}^{(k)}$ \u304b\u3089\u3001$k+1$ \u756a\u76ee\u306e\u5c64\u306e\u5024 $\\boldsymbol{l}^{(k+1)}$ \u3092\u6c42\u3081\u308b\u6f38\u5316\u5f0f\u306b\u306a\u3063\u3066\u3044\u307e\u3059\u3002\n\u4e00\u756a\u524d\u306e\u5c64\u3001\u3064\u307e\u308a\u5165\u529b\u5c64\u304b\u3089\u59cb\u307e\u308a\u3001\u3053\u306e\u6f38\u5316\u5f0f\u306b\u3057\u305f\u304c\u3063\u3066\u51fa\u529b\u5c64\u307e\u3067\u9806\u756a\u306b\u8a08\u7b97\u3057\u3066\u3044\u304f\u904e\u7a0b\u3092\u3001\u300c**\u9806\u4f1d\u64ad** (forward propagation)\u300d\u3068\u3044\u3044\u307e\u3059\u3002*\u9806* \u304c\u3042\u308b\u304b\u3089\u306b\u306f *\u9006* \u3082\u3042\u308b\u308f\u3051\u3067\u3059\u304c\u3001\u305d\u308c\u306f\u306e\u3061\u307b\u3069\u3002\n\n$\\boldsymbol{W}$ \u306f\u524d\u306e\u5c64\u306e\u5404\u30ce\u30fc\u30c9\u304b\u3089\u81ea\u5206\u306b\u5bfe\u3057\u3066\u306e\u5f71\u97ff\u3092\u8868\u3059\u5024\u3067\u3001\u300c**\u91cd\u307f** (weight)\u300d\u3068\u3088\u3070\u308c\u307e\u3059\u3002\u307e\u305f\u3001$\\boldsymbol{b}$ \u306f\u524d\u306e\u5c64\u306e\u30ce\u30fc\u30c9\u306b\u5f71\u97ff\u3057\u306a\u3044 \u201c\u5b9a\u6570\u7684\u306a\u201d \u6027\u683c\u3092\u6301\u3064\u5024\u3067\u3001\u300c**\u30d0\u30a4\u30a2\u30b9** (bias)\u300d\u3068\u3088\u3070\u308c\u307e\u3059\u3002\n\u5c64\u306f\u4e00\u822c\u306b\u8907\u6570\u306e\u30ce\u30fc\u30c9\u3067\u69cb\u6210\u3055\u308c\u3066\u3044\u307e\u3059\u304b\u3089\u3001\u5c64\u306e\u30ce\u30fc\u30c9\u304c\u6301\u3064\u5024 $\\boldsymbol{l}$ \u3092 *\u30d9\u30af\u30c8\u30eb* \u3067\u8868\u3059\u3068\u3001\u30d0\u30a4\u30a2\u30b9 $\\boldsymbol{b}$ \u306f\u30ce\u30fc\u30c9\u3054\u3068\u306b\u6301\u3064\u5024\u3067\u3059\u306e\u3067\u540c\u3058\u304f\u30d9\u30af\u30c8\u30eb\u3068\u306a\u308a\u3001\u91cd\u307f $\\boldsymbol{W}$ \u306f\u30d9\u30af\u30c8\u30eb\u304b\u3089\u30d9\u30af\u30c8\u30eb\u3092\u6c42\u3081\u308b\u5909\u63db\u3067\u3059\u306e\u3067 *\u884c\u5217* \u3068\u306a\u308a\u307e\u3059\u3002\n\n$\\sigma$ \u306f\u300c[**\u6d3b\u6027\u5316\u95a2\u6570** (activation function)](https://ja.wikipedia.org/wiki/%E6%B4%BB%E6%80%A7%E5%8C%96%E9%96%A2%E6%95%B0)\u300d\u3068\u3088\u3070\u308c\u3001\u91cd\u307f\u3068\u30d0\u30a4\u30a2\u30b9\u3092\u4f7f\u3063\u3066\u6c42\u3081\u305f\u5024 ($\\boldsymbol{W} \\boldsymbol{l} + \\boldsymbol{b}$) \u306b\u5bfe\u3059\u308b *\u4f55\u3089\u304b\u306e\u5909\u63db* \u3092\u884c\u3044\u307e\u3059\u3002\n\u53e4\u304f\u306f[**\u30d8\u30f4\u30a3\u30b5\u30a4\u30c9\u306e\u968e\u6bb5\u95a2\u6570** (Heaviside step function)](https://ja.wikipedia.org/wiki/%E3%83%98%E3%83%B4%E3%82%A3%E3%82%B5%E3%82%A4%E3%83%89%E3%81%AE%E9%9A%8E%E6%AE%B5%E9%96%A2%E6%95%B0) \u3060\u3063\u305f\u308a[**\u6052\u7b49\u5199\u50cf** (identity function)](https://ja.wikipedia.org/wiki/%E6%81%92%E7%AD%89%E5%86%99%E5%83%8F) \u3060\u3063\u305f\u308a\u3057\u307e\u3057\u305f\u304c\u3001\u73fe\u5728\u306f *\u4f55\u3089\u304b\u306e\u975e\u7dda\u5f62\u306a\u95a2\u6570* [^why_nonlinear_function] \u304c\u4f7f\u308f\u308c\u307e\u3059\u3002\n\u307e\u305f\u3001\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u5185\u306e\u3059\u3079\u3066\u3067\u540c\u3058\u3082\u306e\u3092\u4f7f\u3046\u5fc5\u8981\u306f\u306a\u304f\u3001\u4f8b\u3048\u3070\u96a0\u308c\u5c64\u3068\u51fa\u529b\u5c64\u3067\u7570\u306a\u308b\u6d3b\u6027\u5316\u95a2\u6570\u3092\u4f7f\u3046\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n\u3061\u306a\u307f\u306b $\\text{(3)}$ \u306f\u3001\u5e38\u306b 1 \u3092\u51fa\u529b\u3059\u308b\u30ce\u30fc\u30c9\u3092\u8ffd\u52a0\u3067\u7528\u610f\u3057\u3001\u30d0\u30a4\u30a2\u30b9\u3092\u305d\u306e\u30ce\u30fc\u30c9\u306b\u5bfe\u3059\u308b\u91cd\u307f\u3068\u3057\u3066\u8003\u3048\u308b\u3053\u3068\u3067\u3001\u30d0\u30a4\u30a2\u30b9\u9805\u3092\u53d6\u308a\u6255\u3046\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n```math\n\\begin{align}\n\\boldsymbol{l'}^{(k)} &= \\begin{bmatrix}\n\t1 \\\\\n\t\\boldsymbol{l}^{(k)}\n\\end{bmatrix} = \\begin{bmatrix}\n\t1 \\\\\n\tl_1^{(k)} \\\\\n\tl_2^{(k)} \\\\\n\tl_3^{(k)} \\\\\n\t\\vdots\n\\end{bmatrix} \\\\\n\\boldsymbol{W'}^{(k)} &= \\begin{bmatrix}\n\t\\boldsymbol{b}^{(k)} & \\boldsymbol{W}^{(k)}\n\\end{bmatrix} = \\begin{bmatrix}\n\tb_1^{(k)} & W_{11}^{(k)} & W_{12}^{(k)} & W_{13}^{(k)} & \\cdots \\\\\n\tb_2^{(k)} & W_{21}^{(k)} & W_{22}^{(k)} & W_{23}^{(k)} & \\cdots \\\\\n\tb_3^{(k)} & W_{31}^{(k)} & W_{32}^{(k)} & W_{33}^{(k)} & \\cdots \\\\\n\t\\vdots & \\vdots & \\vdots & \\vdots & \\ddots\n\\end{bmatrix} \\\\\n\\\\\n\\boldsymbol{l}^{(k+1)} &= \\sigma^{(k+1)}(\\boldsymbol{W'}^{(k+1)} \\boldsymbol{l'}^{(k)}) \\tag{3'}\n\\end{align}\n```\n\n\u66f8\u7c4d\u3084\u30a6\u30a7\u30d6\u30b5\u30a4\u30c8\u306b\u3088\u3063\u3066\u306f $\\text{(3')}$ \u306e\u5f62\u3067\u66f8\u304b\u308c\u308b\u3053\u3068\u3082\u3042\u308a\u307e\u3059\u304c\u3001\u672c\u8cea\u7684\u306b\u306f\u540c\u3058\u3082\u306e\u3067\u3059\u3002\n\n[^why_nonlinear_function]: \u6d3b\u6027\u5316\u95a2\u6570\u304c\u7dda\u5f62\u3067\u3042\u308b\u591a\u5c64\u30cb\u30e5\u30fc\u30e9\u30eb\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306b\u306f\u3001\u305d\u308c\u3068\u7b49\u4fa1\u306a\u5358\u5c64 (\u3064\u307e\u308a\u5165\u529b\u5c64\u3068\u51fa\u529b\u5c64\u3060\u3051) \u306e\u30cb\u30e5\u30fc\u30e9\u30eb\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u304c\u5b58\u5728\u3059\u308b\u3053\u3068\u304c\u5206\u304b\u3063\u3066\u3044\u307e\u3059\u3002\u30cb\u30e5\u30fc\u30e9\u30eb\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306f\u8868\u73fe\u529b\u3092\u5f37\u5316\u3059\u308b\u305f\u3081\u306b\u591a\u5c64\u69cb\u9020\u306b\u3055\u308c\u308b\u305f\u3081\u3001\u7dda\u5f62\u95a2\u6570\u3092\u6d3b\u6027\u5316\u95a2\u6570\u306b\u63a1\u7528\u3059\u308b\u3068\u305d\u306e\u610f\u5473\u304c\u5931\u308f\u308c\u3066\u3057\u307e\u3044\u307e\u3059\u3002\n\n\n# \u5b66\u7fd2\u306e\u6226\u7565\n\n\u5148\u307b\u3069\u66f8\u3044\u305f\u3088\u3046\u306b\u3001\u30cb\u30e5\u30fc\u30e9\u30eb\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306b\u304a\u3051\u308b\u300c\u5b66\u7fd2\u300d\u3068\u306f\u3001\u51fa\u529b\u5c64\u304c\u6b63\u3057\u3044\u5024\u3068\u306a\u308b\u3088\u3046\u306b\u3001\u30d1\u30e9\u30e1\u30fc\u30bf\u3001\u3059\u306a\u308f\u3061 *\u91cd\u307f* \u3068 *\u30d0\u30a4\u30a2\u30b9* \u3092\u4fee\u6b63\u3057\u3066\u3044\u304f\u4f5c\u696d\u306e\u3053\u3068\u3067\u3059\u3002\n\n\u8aa4\u5dee\u9006\u4f1d\u64ad\u6cd5\u306b\u304a\u3044\u3066\u306f\u3001\u30cb\u30e5\u30fc\u30e9\u30eb\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306b\u5bfe\u3057\u3066\u300c[**\u640d\u5931\u95a2\u6570** (loss function)](https://en.wikipedia.org/wiki/Loss_function)\u300d (\u3042\u308b\u3044\u306f\u300c**\u30b3\u30b9\u30c8\u95a2\u6570** (cost function)\u300d) \u3068\u3044\u3046\u3001\u7c21\u5358\u306b\u3044\u3048\u3070 \u201c\u51fa\u529b\u5c64\u306e\u5024\u304c\u3069\u308c\u3060\u3051\u6b63\u3057\u3044\u72b6\u614b\u3001\u671b\u307e\u308c\u3066\u3044\u308b\u72b6\u614b\u304b\u3089\u96e2\u308c\u3066\u3044\u308b\u304b\u201d \u3092\u8868\u3059\u95a2\u6570\u3092\u5b9a\u3081\u3066\u3001\u6700\u6025\u964d\u4e0b\u6cd5\u3092\u7528\u3044\u3066\u3053\u308c\u3092\u6700\u5c0f\u5316\u3059\u308b\u6700\u9069\u5316\u554f\u984c\u306b\u5e30\u7740\u3055\u305b\u307e\u3059\u3002\n\u306a\u304a\u3001\u6700\u9069\u5316\u554f\u984c\u306e\u5bfe\u8c61\u3068\u306a\u308b\u95a2\u6570\u3092\u300c**\u76ee\u7684\u95a2\u6570** (objective function)\u300d\u3068\u3088\u3076\u305f\u3081\u3001\u305d\u3061\u3089\u306e\u540d\u79f0\u304c\u4f7f\u308f\u308c\u308b\u3053\u3068\u3082\u3042\u308a\u307e\u3059\u304c\u3001\u3053\u306e\u8a18\u4e8b\u3067\u306f\u300c\u640d\u5931\u95a2\u6570\u300d\u3067\u7d71\u4e00\u3057\u307e\u3059\u3002\n\n\u3053\u306e\u8a18\u4e8b\u3067\u306f\u3001\u5b66\u7fd2\u306b\u4f7f\u3046\u30c7\u30fc\u30bf\u306b\u3001\u5165\u529b\u3068\u3001\u305d\u308c\u306b\u5bfe\u3057\u3066 *\u671b\u307e\u308c\u308b\u51fa\u529b* \u304c\u30bb\u30c3\u30c8\u3067\u7528\u610f\u3055\u308c\u3066\u3044\u308b\u300c[**\u6559\u5e2b\u3042\u308a\u5b66\u7fd2** (supervised learning)](https://ja.wikipedia.org/wiki/%E6%95%99%E5%B8%AB%E3%81%82%E3%82%8A%E5%AD%A6%E7%BF%92)\u300d\u3092\u53d6\u308a\u4e0a\u3052\u307e\u3059\u3002\n\u305f\u3060\u3057\u8aa4\u89e3\u3057\u306a\u3044\u3067\u3044\u305f\u3060\u304d\u305f\u3044\u306e\u3067\u3059\u304c\u3001\u6559\u5e2b\u3042\u308a\u5b66\u7fd2\u3067\u306a\u3051\u308c\u3070\u8aa4\u5dee\u9006\u4f1d\u64ad\u6cd5\u3092\u9069\u7528\u3067\u304d\u306a\u3044\u308f\u3051\u3067\u306f\u3042\u308a\u307e\u305b\u3093\u3002\n\u8aa4\u5dee\u9006\u4f1d\u64ad\u6cd5\u306f\u3001\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306e\u640d\u5931\u95a2\u6570\u3092\u5b9a\u3081\u308b\u3053\u3068\u304c\u3067\u304d\u3001\u305d\u306e\u95a2\u6570\u3092\u4f7f\u3063\u3066\u91cd\u307f\u3068\u30d0\u30a4\u30a2\u30b9\u3092\u4fee\u6b63\u3067\u304d\u308c\u3070\u3088\u304f\u3001\u6559\u5e2b\u3042\u308a\u5b66\u7fd2\u3067\u3042\u308b\u5fc5\u8981\u306f\u3042\u308a\u307e\u305b\u3093\u3002\n\n## \u640d\u5931\u95a2\u6570\u3092\u7acb\u3066\u308b\n\n\u8a71\u3092\u623b\u3057\u3066\u3001\u6559\u5e2b\u3042\u308a\u5b66\u7fd2\u306f\u5165\u529b\u306b\u5bfe\u3057\u3066 \u201c\u671b\u307e\u308c\u308b\u51fa\u529b\u201d (\u3053\u308c\u3092\u300c**\u6559\u5e2b\u4fe1\u53f7** (supervisory signal)\u300d\u3068\u3044\u3044\u307e\u3059) \u3092\u51fa\u305b\u308b\u3088\u3046\u3001\u30cb\u30e5\u30fc\u30e9\u30eb\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u3092\u5b66\u7fd2\u3059\u308b\u65b9\u6cd5\u3067\u3059\u304c\u3001\u5f53\u7136\u306a\u304c\u3089\u3001\u5b66\u7fd2\u3092\u884c\u3063\u3066\u3044\u306a\u3044\u521d\u671f\u72b6\u614b\u306e\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306e\u51fa\u529b\u306f\u3001\u3075\u3064\u3046\u6559\u5e2b\u4fe1\u53f7\u3068\u306f\u9060\u304f\u304b\u3051\u96e2\u308c\u305f\u3082\u306e\u3068\u306a\u308b\u306f\u305a\u3067\u3059\u3002\n\u3053\u306e \u201c\u3069\u308c\u304f\u3089\u3044\u304b\u3051\u96e2\u308c\u3066\u3044\u308b\u304b\u201d \u3092\u3069\u3046\u306b\u304b\u3057\u3066\u5f0f\u3067\u8868\u3057\u3001\u640d\u5931\u95a2\u6570\u3068\u3059\u308b\u306e\u3067\u3059\u304c\u3001\u4f8b\u3048\u3070\u5206\u304b\u308a\u3084\u3059\u3044\u3082\u306e\u3068\u3057\u3066\u300c2 \u6b21\u640d\u5931\u95a2\u6570 (quadratic loss function)\u300d (\u3042\u308b\u3044\u306f\u300c2 \u4e57\u548c\u8aa4\u5dee (sum-of-squares error)\u300d\u3084\u300c\u6b8b\u5dee\u5e73\u65b9\u548c (residual sum of squares)\u300d\u3068\u3082\u3088\u3070\u308c\u307e\u3059) \u304c\u3042\u308a\u307e\u3059\u3002\n\n```math\n\\begin{align}\nL &= (o_1 - T_1)^2 + (o_2 - T_2)^2 + \\cdots + (o_N - T_N)^2 \\\\\n&= \\sum_{n=1}^N (o_n - T_n)^2 \\\\\n&= \\| \\boldsymbol{o} - \\boldsymbol{T} \\|^2\n\\end{align} \\tag{4}\n```\n\n\u3053\u3053\u3067 $\\boldsymbol{o} = (o_1, o_2, \\dots, o_N)$ \u306f\u30cb\u30e5\u30fc\u30e9\u30eb\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306e\u51fa\u529b\u5c64\u306e\u5024\u3067\u3042\u308a\u3001$\\boldsymbol{T} = (T_1, T_2, \\dots, T_N)$ \u306f\u6559\u5e2b\u4fe1\u53f7\u3067\u3059\u3002$\\\\|\\cdots\\\\|$ \u306f\u30d9\u30af\u30c8\u30eb\u306e\u30ce\u30eb\u30e0 [^norm_more_precisely] \u3092\u8868\u3057\u307e\u3059\u3002\n\n\u6559\u5e2b\u4fe1\u53f7\u3068\u306e\u5dee\u306e 2 \u4e57\u548c\u3092\u640d\u5931\u3068\u3059\u308b\u3053\u3068\u306f\u3001\u76f4\u611f\u7684\u306b\u3082\u7406\u306b\u304b\u306a\u3063\u305f\u3082\u306e\u3067\u3042\u308b\u3068\u601d\u3044\u307e\u3059\u3002\n2 \u4e57\u3057\u305f\u3082\u306e\u3092\u8db3\u3057\u3066\u3044\u304f\u308f\u3051\u3067\u3059\u304b\u3089\u3001$L$ \u306f\u5fc5\u305a 0 \u4ee5\u4e0a\u306b\u306a\u308a\u307e\u3059\u3057\u3001\u51fa\u529b\u5024\u3068\u6559\u5e2b\u4fe1\u53f7\u304c\u96e2\u308c\u308c\u3070\u96e2\u308c\u308b\u307b\u3069\u640d\u5931\u304c\u5927\u304d\u3044\u3068\u5224\u65ad\u3055\u308c\u307e\u3059\u3002\n\u305d\u3057\u3066\u3001\u51fa\u529b\u5024\u3068\u6559\u5e2b\u4fe1\u53f7\u304c\u3074\u3063\u305f\u308a\u3068\u4e00\u81f4\u3059\u308b\u3068\u304d\u306b\u640d\u5931\u306f\u6700\u5c0f\u3068\u306a\u308a\u3001$L$ \u306f\u6700\u5c0f\u5024 0 \u3068\u306a\u308a\u307e\u3059\u3002\n\n\u3053\u306e\u640d\u5931\u95a2\u6570 $L$ \u306f\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306e\u51fa\u529b\u5c64\u306e\u5024 $\\boldsymbol{o}$ \u3092\u5909\u6570\u306b\u3068\u308a\u307e\u3059\u304c\u3001\u3053\u308c\u306f\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u5185\u306e\u3059\u3079\u3066\u306e\u91cd\u307f\u3068\u30d0\u30a4\u30a2\u30b9\u306b\u3088\u3063\u3066\u8a08\u7b97\u3055\u308c\u305f\u5024\u3067\u3059\u304b\u3089\u3001\u3064\u307e\u308b\u3068\u3053\u308d\u3001$L$ \u306f\u3059\u3079\u3066\u306e\u91cd\u307f\u3068\u30d0\u30a4\u30a2\u30b9\u3092\u5909\u6570\u306b\u3068\u308b\u3053\u3068\u3092\u610f\u5473\u3057\u307e\u3059\u3002\n\u3088\u3063\u3066\u3001$L$ \u306b\u5bfe\u3059\u308b\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u5185\u306e\u4efb\u610f\u306e\u91cd\u307f\u3001\u30d0\u30a4\u30a2\u30b9\u306e\u504f\u5fae\u5206\u3092\u6c42\u3081\u308b\u3053\u3068\u304c\u3067\u304d\u308c\u3070\u3001\u6700\u6025\u964d\u4e0b\u6cd5\u3092\u4f7f\u3046\u3053\u3068\u3067\u91cd\u307f\u3068\u30d0\u30a4\u30a2\u30b9\u3092\u4fee\u6b63\u3057\u3066\u3001\u7d50\u679c\u3068\u3057\u3066\u640d\u5931\u95a2\u6570\u3092\u6700\u5c0f\u5316\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u308b\u306f\u305a\u3067\u3059\u3002\n\n\u3061\u306a\u307f\u306b\u640d\u5931\u95a2\u6570\u3092\u3046\u307e\u304f\u5b9a\u3081\u308b\u3068\u3001\u53ce\u675f\u3092\u65e9\u3081\u305f\u308a\u3001\u30b9\u30d1\u30fc\u30b9\u6027 [^sparsity] \u3092\u9ad8\u3081\u305f\u308a\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u304c\u3001\u9ad8\u5ea6\u306a\u5185\u5bb9\u3068\u306a\u308a\u307e\u3059\u3057\u3001\u81ea\u5206\u3082\u307e\u3060\u52c9\u5f37\u304c\u8db3\u308a\u3066\u3044\u306a\u3044\u3068\u3053\u308d\u3067\u3059\u306e\u3067\u3001\u307e\u305f\u3044\u305a\u308c\u3002\n\n[^norm_more_precisely]: \u6b63\u78ba\u306b\u3044\u3046\u3068\u3001\u3053\u306e\u30ce\u30eb\u30e0\u306f\u300c\u30e6\u30fc\u30af\u30ea\u30c3\u30c9\u30ce\u30eb\u30e0 (Euclidean norm)\u300d\u3042\u308b\u3044\u306f\u300c2-\u30ce\u30eb\u30e0\u300d\u306a\u3069\u3068\u3088\u3070\u308c\u307e\u3059\u3002\n[^sparsity]: \u4f9d\u5b58\u3059\u308b\u30d1\u30e9\u30e1\u30fc\u30bf\u304c\u5c11\u306a\u3044\u3053\u3068\u3002\u30b9\u30d1\u30fc\u30b9\u6027\u3092\u9ad8\u3081\u308b\u3068\u3001**\u904e\u5b66\u7fd2** (overfitting) (\u3042\u308b\u3044\u306f**\u904e\u5270\u9069\u5408**\u3068\u3082) \u3092\u9632\u3050\u3053\u3068\u304c\u3067\u304d\u3001\u3088\u308a\u5b89\u5b9a\u3057\u305f (\u3088\u304f\u300c\u525b\u5065\u3067\u3042\u308b\u300d\u3068\u304b\u300c\u30ed\u30d0\u30b9\u30c8\u30cd\u30b9\u304c\u9ad8\u3044\u300d\u3068\u3044\u308f\u308c\u308b) \u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306b\u306a\u308a\u307e\u3059\u3002\n\n## \u3059\u3079\u3066\u306e\u5165\u529b\u3092\u8003\u616e\u3057\u305f\u640d\u5931\u95a2\u6570\n\n\u524d\u7bc0\u306e $\\text{(4)}$ \u3067 2 \u6b21\u640d\u5931\u95a2\u6570\u3092\u7d39\u4ecb\u3057\u307e\u3057\u305f\u304c\u3001\u3053\u306e\u3068\u304d\u3001\u51fa\u529b\u5024 $\\boldsymbol{o}$ \u3068\u6559\u5e2b\u4fe1\u53f7 $\\boldsymbol{T}$ \u306f\u5165\u529b\u3054\u3068\u306b\u7570\u306a\u308b\u3082\u306e\u3067\u3059\u304b\u3089\u3001\u640d\u5931\u95a2\u6570\u3082\u5165\u529b\u3054\u3068\u306b\u7b97\u51fa\u3055\u308c\u307e\u3059\u3002\n\u3088\u3063\u3066\u30012 \u6b21\u640d\u5931\u95a2\u6570\u3092\u3082\u3046\u5c11\u3057\u6b63\u78ba\u306b\u66f8\u3051\u3070\u3001$k$ \u756a\u76ee\u306e\u5165\u529b\u306b\u5bfe\u3057\u3066\u3001\n\n```math\n\\begin{align}\nL^{(k)} &= (o_1^{(k)} - T_1^{(k)})^2 + (o_2^{(k)} - T_2^{(k)})^2 + \\cdots + (o_N^{(k)} - T_N^{(k)})^2 \\\\\n&= \\sum_{n=1}^N (o_n^{(k)} - T_n^{(k)})^2 \\\\\n&= \\| \\boldsymbol{o}^{(k)} - \\boldsymbol{T}^{(k)} \\|^2\n\\end{align}\n```\n\n\u3068\u8868\u3059\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n\u30cb\u30e5\u30fc\u30e9\u30eb\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306e\u91cd\u307f\u3068\u30d0\u30a4\u30a2\u30b9\u306f\u3001\u3059\u3079\u3066\u306e\u5165\u529b\u306b\u5bfe\u3057\u3066\u5171\u901a\u306b\u4f7f\u308f\u308c\u308b\u30d1\u30e9\u30e1\u30fc\u30bf\u3067\u3059\u304b\u3089\u3001\u500b\u5225\u306e\u5165\u529b\u306b\u5bfe\u3059\u308b\u640d\u5931\u95a2\u6570\u3067\u306f\u306a\u304f\u3001\u3059\u3079\u3066\u306e\u5165\u529b\u3092\u8003\u616e\u3057\u305f\u3001\u3044\u308f\u3070\u30cb\u30e5\u30fc\u30e9\u30eb\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306e\u300c\u5168\u4f53\u640d\u5931\u95a2\u6570\u300d[^entire_loss_function] \u304c\u5fc5\u8981\u306b\u306a\u308a\u307e\u3059\u3002\n\u3053\u3053\u3067\u306f\u3001\u5165\u529b\u306e\u7dcf\u6570\u3092 $K$ \u3068\u3057\u3066\u3001\u5404\u5165\u529b\u306b\u5bfe\u3059\u308b\u640d\u5931\u95a2\u6570 $L^{(k)}\\ \\small{(k \\in 1, 2, \\dots, K)}$ \u3092\u4f7f\u3063\u3066\u5168\u4f53\u640d\u5931\u95a2\u6570 $L^{(all)}$ \u3092\u6c42\u3081\u3066\u307f\u307e\u3057\u3087\u3046\u3002\n\u6c7a\u3081\u65b9\u306f\u8272\u3005\u3042\u308b\u3068\u601d\u3044\u307e\u3059\u304c\u3001\u96e3\u3057\u304f\u8003\u3048\u308b\u5fc5\u8981\u306f\u3042\u308a\u307e\u305b\u3093\u3002\u4f8b\u3048\u3070\u5404\u5165\u529b\u306b\u5bfe\u3059\u308b\u640d\u5931\u95a2\u6570\u306e *\u7dcf\u548c* \u3068\u3057\u3066\u306f\u3069\u3046\u3067\u3057\u3087\u3046\u304b\u3002\n\n```math\nL^{(all)} = L^{(1)} + L^{(2)} + \\cdots + L^{(k)} + \\cdots = \\sum_{k=1}^K L^{(k)} \\tag{5}\n```\n\n2 \u6b21\u640d\u5931\u95a2\u6570\u306f $L^{(k)} \\ge 0$ \u304c\u6210\u308a\u7acb\u3064\u308f\u3051\u3067\u3059\u304b\u3089\u3001\u3053\u306e\u3088\u3046\u306b\u3057\u3066\u3082\u554f\u984c\u306f\u306a\u3044\u308f\u3051\u3067\u3059\u3002\n\u9006\u306b\u3001\u640d\u5931\u95a2\u6570\u304c\u8ca0\u306e\u5024\u306b\u306a\u308b\u3053\u3068\u304c\u3042\u308b\u306a\u3069\u3001$\\text{(5)}$ \u304c\u9069\u7528\u3067\u304d\u306a\u3044\u30b1\u30fc\u30b9\u304c\u3042\u308b\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u3002\u305d\u306e\u3068\u304d\u306f\u9069\u5207\u306a\u7acb\u5f0f\u304c\u5fc5\u8981\u3067\u3059\u3002\n\n\u3055\u3066\u3001\u4eca\u56de\u306f\u3053\u308c\u3067\u554f\u984c\u306a\u3044\u3068\u3057\u3066\u3001\u3044\u307e\u3001\u5168\u4f53\u640d\u5931\u95a2\u6570 $L^{(all)}$ \u3092\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u5185\u306e\u3068\u3042\u308b\u91cd\u307f\u3082\u3057\u304f\u306f\u30d0\u30a4\u30a2\u30b9 $w$ \u3067\u504f\u5fae\u5206\u3059\u308b\u3001\u3064\u307e\u308a $\\partial L^{(all)}/\\partial w$ \u3092\u6c42\u3081\u308b\u3053\u3068\u3092\u8003\u3048\u307e\u3059\u3002\n\u307e\u305a\u3001$L^{(all)}$ \u304c\u5404\u5165\u529b\u306b\u5bfe\u3059\u308b\u640d\u5931\u95a2\u6570 $L^{(k)}$ \u3092\u5909\u6570\u306b\u3068\u308b\u3053\u3068\u306f $\\text{(5)}$ \u304b\u3089\u660e\u3089\u304b\u3067\u3059\u3002\n\u305d\u3057\u3066 $L^{(k)}$ \u304c\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u5185\u306e\u3059\u3079\u3066\u306e\u91cd\u307f\u3001\u30d0\u30a4\u30a2\u30b9\u3092\u5909\u6570\u306b\u3068\u308b\u3053\u3068\u306f\u524d\u7bc0\u3067\u66f8\u304d\u307e\u3057\u305f\u3002\u3064\u307e\u308a $L^{(k)}$ \u306f $k = 1, 2, \\dots, K$ \u306e\u305d\u308c\u305e\u308c\u306b\u304a\u3044\u3066 $w$ \u3092\u5909\u6570\u306b\u3068\u308a\u307e\u3059\u3002\n\u3053\u3053\u3067\u300c\u9023\u9396\u5f8b\u300d\u306e\u51fa\u756a\u304c\u3084\u3063\u3066\u304d\u307e\u3059\u3002$\\text{(1)}$, $\\text{(5)}$ \u304b\u3089\u4ee5\u4e0b\u306e $\\text{(6)}$ \u3092\u5c0e\u304f\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n```math\n\\begin{align}\n\\frac{\\partial L^{(all)}}{\\partial w} &= \\frac{\\partial L^{(all)}}{\\partial L^{(1)}}\\cdot\\frac{\\partial L^{(1)}}{\\partial w} + \\frac{\\partial L^{(all)}}{\\partial L^{(2)}}\\cdot\\frac{\\partial L^{(2)}}{\\partial w} + \\cdots + \\frac{\\partial L^{(all)}}{\\partial L^{(K)}}\\cdot\\frac{\\partial L^{(K)}}{\\partial w} \\\\\n&= \\frac{\\partial L^{(1)}}{\\partial w} + \\frac{\\partial L^{(2)}}{\\partial w} + \\cdots + \\frac{\\partial L^{(K)}}{\\partial w}\\ \\left( \\because \\frac{\\partial L^{(all)}}{\\partial L^{(k)}} = 1\\ (k \\in 1, 2, \\dots, K) \\right) \\\\\n&= \\sum_{k=1}^{K} \\frac{\\partial L^{(k)}}{\\partial w}\n\\end{align} \\tag{6}\n```\n\n\u8a08\u7b97\u306f\u5c0f\u96e3\u3057\u304f\u898b\u3048\u308b\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u304c\u3001\u51fa\u3066\u304d\u305f\u7d50\u679c\u306f\u30b7\u30f3\u30d7\u30eb\u306a\u3082\u306e\u3067\u3001\u5404\u5165\u529b\u3054\u3068\u306b\u640d\u5931\u95a2\u6570\u304b\u3089\u504f\u5fae\u5206 ($\\partial L^{(k)}/\\partial w$) \u3092\u6c42\u3081\u3066\u3001\u305d\u308c\u3092\u5408\u8a08\u3059\u308b\u3068\u5168\u4f53\u306e\u504f\u5fae\u5206 ($\\partial L^{(all)}/\\partial w$) \u306b\u306a\u308b\u3053\u3068\u304c\u5206\u304b\u308a\u307e\u3057\u305f\u3002\n\n\u3061\u306a\u307f\u306b\u3001\u3053\u306e\u8a18\u4e8b\u3067\u306f\u5168\u4f53\u640d\u5931\u95a2\u6570\u306f\u5404\u5165\u529b\u306b\u5bfe\u3059\u308b\u640d\u5931\u95a2\u6570\u306e *\u7dcf\u548c* \u3068\u3057\u3066\u3044\u307e\u3059\u304c\u3001*\u5e73\u5747* \u3092\u63a1\u7528\u3059\u308b\u3053\u3068\u3082\u3067\u304d\u307e\u3059\u3002\n\n```math\nL^{(all)} = \\frac{1}{K} ( L^{(1)} + L^{(2)} + \\cdots + L^{(k)} + \\cdots ) = \\frac{1}{K} \\sum_{k=1}^K L^{(k)}\n```\n\n\u3053\u308c\u3092\u540c\u69d8\u306b $w$ \u3067\u504f\u5fae\u5206\u3059\u308b\u3068\u3001\n\n```math\n\\frac{\\partial L^{(all)}}{\\partial w} = \\frac{1}{K} \\sum_{k=1}^{K} \\frac{\\partial L^{(k)}}{\\partial w}\\ \\left( \\because \\frac{\\partial L^{(all)}}{\\partial L^{(k)}} = \\frac{1}{K} \\right)\n```\n\n\u3068\u306a\u308a\u3001\u5404\u5165\u529b\u3054\u3068\u306e\u640d\u5931\u95a2\u6570\u306e\u504f\u5fae\u5206\u306e\u5e73\u5747\u304c\u3001\u5168\u4f53\u306e\u504f\u5fae\u5206\u3068\u306a\u308a\u307e\u3059\u3002\n\u5e73\u5747\u3092\u3068\u308b\u308f\u3051\u3067\u3059\u304b\u3089\u3001*\u7dcf\u548c* \u306e\u5168\u4f53\u640d\u5931\u95a2\u6570\u3092\u63a1\u7528\u3057\u305f\u3068\u304d\u3068\u6bd4\u3079\u3066\u3001\u6700\u6025\u964d\u4e0b\u6cd5\u306b\u3088\u308b\u4fee\u6b63\u91cf\u306f\u5c0f\u3055\u304f\u306a\u308a\u307e\u3059\u3002\u3057\u304b\u3057\u3053\u308c\u306f\u4fc2\u6570 $\\eta$ \u3067\u8abf\u7bc0\u3067\u304d\u307e\u3059\u306e\u3067\u3001\u3053\u308c\u3060\u3051\u3067\u3069\u3061\u3089\u304c\u6709\u5229\u30fb\u4e0d\u5229\u3068\u3044\u3046\u3053\u3068\u306f\u3044\u3048\u307e\u305b\u3093\u3002\n\n\u3053\u308c\u4ee5\u964d\u306f\u3001\u5404\u5165\u529b\u306b\u5bfe\u3059\u308b\u640d\u5931\u95a2\u6570\u306f\u5358\u306b $L$ \u3068\u3057\u3066\u3001$(k)$ \u3092\u80a9\u306b\u4e57\u305b\u305a\u306b\u8868\u3059\u3053\u3068\u306b\u3057\u307e\u3059\u3002$\\TeX$ \u8a18\u6cd5\u3082\u9577\u304f\u306a\u3063\u3066\u3057\u307e\u3044\u307e\u3059\u3057\u306d\u3002\n\n[^entire_loss_function]: \u3053\u306e\u8a18\u4e8b\u3067\u306f\u3053\u308c\u4ee5\u964d\u300c\u5168\u4f53\u640d\u5931\u95a2\u6570\u300d\u3068\u3044\u3046\u540d\u79f0\u3092\u305f\u3073\u305f\u3073\u4f7f\u3044\u307e\u3059\u304c\u3001\u4e00\u822c\u7684\u306a\u7528\u8a9e\u3067\u306f\u3042\u308a\u307e\u305b\u3093\u306e\u3067\u3054\u6ce8\u610f\u304f\u3060\u3055\u3044\u3002\n\n\n# \u8aa4\u5dee\u9006\u4f1d\u64ad\u6cd5\u306b\u3088\u308b\u5b66\u7fd2\u306e\u5b9f\u4f8b - \u534a\u52a0\u7b97\u5668\n\n\u3053\u3053\u307e\u3067\u3067\u5fc5\u8981\u306a\u4e8b\u524d\u77e5\u8b58\u306f\u3059\u3079\u3066\u63c3\u3063\u305f\u306e\u3067\u3001\u8aa4\u5dee\u9006\u4f1d\u64ad\u6cd5\u306e\u4e00\u822c\u5f0f\u3092\u66f8\u3044\u3066\u3082\u3088\u3044\u306e\u3067\u3059\u304c\u3001\u305d\u306e\u524d\u306b\u5358\u7d14\u306a\u5b9f\u4f8b\u3068\u3057\u3066\u3001\u300c[**\u534a\u52a0\u7b97\u5668** (half adder)](https://ja.wikipedia.org/wiki/%E5%8A%A0%E7%AE%97%E5%99%A8)\u300d\u3092\u5b66\u7fd2\u3055\u305b\u3066\u307f\u307e\u3059\u3002\n\u3042\u304f\u307e\u3067\u5b9f\u4f8b\u3067\u3059\u3057\u3001\u4e0d\u8981\u306a\u65b9\u306f\u8aad\u307f\u98db\u3070\u3057\u3066\u2026\u3044\u305f\u3060\u3044\u3066\u3082\u3088\u3044\u306e\u3067\u3059\u304c\u3001\u8aa4\u5dee\u9006\u4f1d\u64ad\u6cd5\u3092\u4e00\u822c\u5316\u3057\u305f\u5f0f\u306f\u4e00\u898b\u3059\u308b\u3068\u975e\u5e38\u306b\u5206\u304b\u308a\u3065\u3089\u3044\u8868\u8a18\u3067\u3059\u306e\u3067\u3001\u3053\u3061\u3089\u306b\u3082\u76ee\u3092\u901a\u3057\u3066\u3044\u305f\u3060\u3044\u305f\u307b\u3046\u304c\u7406\u89e3\u306f\u9032\u3080\u3068\u601d\u3044\u307e\u3059\u3002\n\n## \u6982\u8981\u3068\u30cb\u30e5\u30fc\u30e9\u30eb\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u3067\u306e\u8868\u73fe\n\n\u534a\u52a0\u7b97\u5668\u306f\u30012 \u3064\u306e\u5165\u529b A, B \u3092\u53d7\u3051\u53d6\u308a\u3001\u4ee5\u4e0b\u306e\u8868\u306b\u3057\u305f\u304c\u3063\u3066 2 \u3064\u306e\u51fa\u529b S, C \u3092\u9001\u308a\u51fa\u3059\u88c5\u7f6e\u3067\u3059\u3002\n\u3082\u3046\u5c11\u3057\u8e0f\u307f\u8fbc\u3093\u3067\u8a00\u3048\u3070\u30012 \u3064\u306e\u5165\u529b A, B \u304c 1 \u3067\u3042\u308b\u3082\u306e\u306e\u6570\u3092\u30012 \u30d3\u30c3\u30c8 CS \u3067\u8868\u3059\u88c5\u7f6e\u3067\u3059\u3002\n\n| in *A* | in *B* | out *S* | out *C* |\n|:------:|:------:|:-------:|:-------:|\n|      0 |      0 |       0 |       0 |\n|      0 |      1 |       1 |       0 |\n|      1 |      0 |       1 |       0 |\n|      1 |      1 |       0 |       1 |\n\n\u4e0a\u306e\u771f\u7406\u5024\u8868\u3092\u898b\u308b\u3068\u3001S \u306f A \u3068 B \u306e *\u6392\u4ed6\u7684\u8ad6\u7406\u548c* ($S = A \\veebar B$)\u3001C \u306f *\u8ad6\u7406\u7a4d* ($C = A \\wedge B$) \u3068\u3057\u3066\u8868\u305b\u308b\u3053\u3068\u304c\u308f\u304b\u308a\u307e\u3059\u3002\n\u4eca\u56de\u306f\u3053\u306e\u534a\u52a0\u7b97\u5668\u3092\u3001\u5165\u529b\u5c64 2 \u6b21\u5143 (A, B)\u3001\u96a0\u308c\u5c64 3 \u6b21\u5143\u3001\u51fa\u529b\u5c64 2 \u6b21\u5143 (S, C) \u306e 3 \u5c64\u30cb\u30e5\u30fc\u30e9\u30eb\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u3067\u5b66\u7fd2\u3055\u305b\u3066\u307f\u307e\u3057\u3087\u3046\u3002[^why_three_layer_network]\n\u96a0\u308c\u5c64\u306e\u6b21\u5143\u6570\u306f\u3001\u3053\u306e\u8a18\u4e8b\u3067\u306f\u8aac\u660e\u306e\u305f\u3081\u306b 3 \u6b21\u5143\u306b\u3057\u3066\u3044\u307e\u3059\u304c\u3001\u8208\u5473\u304c\u3042\u308c\u3070\u6b21\u5143\u6570\u3092\u5909\u3048\u305f\u3068\u304d\u306b\u3069\u3046\u306a\u308b\u306e\u304b\u3001\u8a66\u3057\u3066\u307f\u3066\u304f\u3060\u3055\u3044\u3002\n\n![\u5b66\u7fd2\u3092\u884c\u3046\u534a\u52a0\u7b97\u5668\u30cb\u30e5\u30fc\u30e9\u30eb\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306e\u69cb\u9020](https://qiita-image-store.s3.amazonaws.com/0/107860/1a38d2a2-1090-576d-575c-5da312a88eed.png)\n\n\u5404\u5c64\u306e\u5024\u306e\u8a08\u7b97\u5f0f\u3067\u3059\u304c\u3001$\\text{(3)}$ \u3067\u306f\u5404\u5c64\u306e\u5024\u3092 $\\boldsymbol{l}^{(k)}$ \u3067\u8868\u3057\u307e\u3057\u305f\u304c\u3001\u3053\u306e\u4f8b\u3067\u306f 3 \u5c64\u3067\u3059\u304b\u3089\u3001\u3082\u3063\u3068\u7c21\u5358\u306b\u3001\u5165\u529b\u5c64\u3092 $\\boldsymbol{x} = (x\\_1, x\\_2)$\u3001\u96a0\u308c\u5c64\u3092 $\\boldsymbol{y} = (y\\_1, y\\_2, y\\_3)$\u3001\u51fa\u529b\u5c64\u3092 $\\boldsymbol{z} = (z\\_1, z\\_2)$ \u3068\u8868\u3059\u3053\u3068\u306b\u3057\u307e\u3057\u3087\u3046\u3002\n\n```math\n\\begin{align}\n\\boldsymbol{x} &= (x_1, x_2) = \\{ (0, 0), (0, 1), (1, 0), (1, 1) \\} \\tag{7} \\\\\n\\\\\n\\boldsymbol{I_y} &= (I_{y_1}, I_{y_2}, I_{y_3}) = \\boldsymbol{W_y} \\boldsymbol{x} + \\boldsymbol{b_y} \\tag{8} \\\\\n&\\ \\ \\left|\n\t\\begin{array}{l}\n\t\\ I_{y_1} = W_{y_{11}} x_1 + W_{y_{12}} x_2 + b_{y_1} \\\\\n\t\\ I_{y_2} = W_{y_{21}} x_1 + W_{y_{22}} x_2 + b_{y_2} \\\\\n\t\\ I_{y_3} = W_{y_{31}} x_1 + W_{y_{32}} x_2 + b_{y_3}\n\t\\end{array}\n\\right. \\\\\n\\boldsymbol{y} &= (y_1, y_2, y_3) = \\sigma_y( \\boldsymbol{I_y} ) \\tag{9} \\\\\n\\\\\n\\boldsymbol{I_z} &= (I_{z_1}, I_{z_2}) = \\boldsymbol{W_z} \\boldsymbol{y} + \\boldsymbol{b_z} \\tag{10} \\\\\n&\\ \\ \\left|\n\t\\begin{array}{l}\n\t\\ I_{z_1} = W_{z_{11}} y_1 + W_{z_{12}} y_2 + W_{z_{13}} y_3 + b_{z_1} \\\\\n\t\\ I_{z_2} = W_{z_{21}} y_1 + W_{z_{22}} y_2 + W_{z_{23}} y_3 + b_{z_2}\n\t\\end{array}\n\\right. \\\\\n\\boldsymbol{z} &= (z_1, z_2) = \\sigma_z( \\boldsymbol{I_z} ) \\tag{11}\n\\end{align}\n```\n\n$\\text{(3)}$ \u306f\u91cd\u307f\u3068\u30d0\u30a4\u30a2\u30b9\u3001\u6d3b\u6027\u5316\u95a2\u6570\u3092\u4e00\u6c17\u306b\u9069\u7528\u3057\u305f\u3082\u306e\u3067\u3057\u305f\u304c\u3001\u3053\u308c\u304b\u3089\u504f\u5fae\u5206\u306e\u5f0f\u3092\u8003\u3048\u3066\u3044\u304f\u95a2\u4fc2\u3067\u3001\u9014\u4e2d\u306b $\\boldsymbol{I_y}$ \u3068 $\\boldsymbol{I_z}$ \u3092\u631f\u307f\u307e\u3057\u305f\u3002\u7b49\u4fa1\u306a\u5f0f\u3067\u3042\u308b\u3053\u3068\u306f\u304a\u5206\u304b\u308a\u3044\u305f\u3060\u3051\u308b\u3068\u601d\u3044\u307e\u3059\u3002\n\u307e\u305f\u3001$\\text{(7)}$ \u304a\u3088\u3073 $\\text{(11)}$ \u306b\u304a\u3044\u3066\u3001\u5165\u529b\u5c64\u306e\u6b21\u5143\u306f $x_1$ \u304c $A$\u3001$x_2$ \u304c $B$ \u306b\u5bfe\u5fdc\u3057\u3001\u51fa\u529b\u5c64\u306e\u6b21\u5143\u306f $z_1$ \u304c $S$\u3001$z_2$ \u304c $C$ \u306b\u5bfe\u5fdc\u3059\u308b\u3082\u306e\u3068\u3057\u307e\u3059\u3002\n\n\u640d\u5931\u95a2\u6570 $L$ \u304a\u3088\u3073\u6d3b\u6027\u5316\u95a2\u6570 $\\sigma_y, \\sigma_z$ \u306f\u3053\u3053\u3067\u306f *\u3042\u3048\u3066* \u5b9a\u3081\u305a\u3001\u6700\u5f8c\u306b\u5177\u4f53\u4f8b\u3068\u3057\u3066\u63d0\u793a\u3057\u307e\u3059\u3002\n\n[^why_three_layer_network]: \u3061\u306a\u307f\u306b\u3001\u6392\u4ed6\u7684\u8ad6\u7406\u548c\u306f\u96a0\u308c\u5c64\u306e\u306a\u3044 2 \u5c64\u306e\u30cb\u30e5\u30fc\u30e9\u30eb\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u3067\u306f\u8868\u73fe\u3067\u304d\u306a\u3044\u3053\u3068\u304c\u5206\u304b\u3063\u3066\u3044\u307e\u3059\u3002\n\n## \u51fa\u529b\u5c64\u306e\u91cd\u307f\u30fb\u30d0\u30a4\u30a2\u30b9\u306e\u504f\u5fae\u5206\n\n\u3067\u306f\u307e\u305a\u3001\u640d\u5931\u95a2\u6570\u306b\u5bfe\u3059\u308b\u51fa\u529b\u5c64\u306e\u91cd\u307f\u3001\u30d0\u30a4\u30a2\u30b9\u306e\u504f\u5fae\u5206\u3092\u6c42\u3081\u3066\u3044\u304d\u307e\u3059\u3002\n\u51fa\u529b\u5c64\u304b\u3089\u6c42\u3081\u3066\u3044\u304f\u7406\u7531\u306f\u3001\u30cb\u30e5\u30fc\u30e9\u30eb\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306e\u69cb\u9020\u306b\u3042\u308a\u307e\u3059\u3002\n\u91cd\u307f\u3084\u30d0\u30a4\u30a2\u30b9\u306f\u81ea\u5206\u306e\u5c64\u3068\u3001\u81ea\u5206\u3088\u308a\u3082\u5f8c\u308d\u306e\u5c64\u306e\u5024\u306b\u5f71\u97ff\u3092\u4e0e\u3048\u308b\u305f\u3081\u3001\u504f\u5fae\u5206\u3092\u8003\u3048\u308b\u3068\u304d\u306f\u3001\u91cd\u307f\u3084\u30d0\u30a4\u30a2\u30b9\u306b\u3088\u308b\u305d\u308c\u3089\u306e\u5c64\u306e\u5024\u306e\u5909\u5316\u3092\u3059\u3079\u3066\u8003\u616e\u3057\u306a\u3051\u308c\u3070\u306a\u308a\u307e\u305b\u3093\u3002\u3088\u3063\u3066\u3001\u5f8c\u308d\u306e\u5c64\u304b\u3089\u9032\u3081\u3066\u3044\u304f\u307b\u3046\u304c\u5206\u304b\u308a\u3084\u3059\u3044\u306e\u3067\u3059\u3002\n\n\u3053\u3053\u304b\u3089\u306f\u9023\u9396\u5f8b\u3082\u5f53\u305f\u308a\u524d\u306e\u3088\u3046\u306b\u4f7f\u3063\u3066\u3044\u304d\u307e\u3059\u306e\u3067\u3001$\\text{(1)}$\u3001$\\text{(7)}$ \uff5e $\\text{(11)}$ \u3068\u306b\u3089\u3081\u3063\u3053\u3057\u306a\u304c\u3089\u3001\u3053\u308c\u304b\u3089\u306e\u5f0f\u306e\u5c0e\u51fa\u3092\u30c1\u30a7\u30c3\u30af\u3057\u3066\u307f\u3066\u304f\u3060\u3055\u3044\u3002\n\n\u307e\u305a\u306f $z_1$ \u306e\u30d0\u30a4\u30a2\u30b9\u306e\u504f\u5fae\u5206\u304b\u3089\u6c42\u3081\u3066\u3044\u304d\u307e\u3059\u3002\n\n```math\n\\frac{\\partial L}{\\partial b_{z_1}} = \\frac{\\partial L}{\\partial z_1} \\cdot \\frac{\\partial z_1}{\\partial I_{z_1}} \\cdot \\frac{\\partial I_{z_1}}{\\partial b_{z_1}} = \\frac{\\partial L}{\\partial z_1} \\cdot \\sigma_z'(I_{z_1})\\ \\left( \\because \\frac{\\partial I_{z_1}}{\\partial b_{z_1}} = 1 \\right) \\tag{12}\n```\n\n\u640d\u5931\u95a2\u6570\u306e\u504f\u5fae\u5206 ($\\partial L/\\partial z_1$) \u3068\u6d3b\u6027\u5316\u95a2\u6570\u306e\u504f\u5fae\u5206 ($\\partial z_1/\\partial I_{z_1} = \\sigma_z'(I_{z_1})$) \u304c\u5fc5\u8981\u3067\u3059\u304c\u3001\u3044\u307e\u306f\u4e21\u65b9\u3068\u3082\u660e\u3089\u304b\u3067\u306f\u3042\u308a\u307e\u305b\u3093\u306e\u3067\u3001\u73fe\u6642\u70b9\u3067\u3053\u308c\u4ee5\u4e0a\u306f\u7c21\u5358\u306b\u3067\u304d\u307e\u305b\u3093\u3002\n\u305d\u3057\u3066\u3053\u3053\u3067\u3001$\\dfrac{\\partial L}{\\partial b_{z_1}} = \\dfrac{\\partial L}{\\partial z_1} \\cdot \\dfrac{\\partial z_1}{\\partial I_{z_1}}$ \u3067\u3042\u308b\u3053\u3068\u3092\u5229\u7528\u3057\u3066\u3001\n\n```math\n\\begin{align}\n\\frac{\\partial L}{\\partial W_{z_{11}}} &= \\frac{\\partial L}{\\partial z_1} \\cdot \\frac{\\partial z_1}{\\partial I_{z_1}} \\cdot \\frac{\\partial I_{z_1}}{\\partial W_{z_{11}}} = \\frac{\\partial L}{\\partial b_{z_1}} \\cdot y_1 \\tag{13} \\\\\n\\frac{\\partial L}{\\partial W_{z_{12}}} &= \\frac{\\partial L}{\\partial z_1} \\cdot \\frac{\\partial z_1}{\\partial I_{z_1}} \\cdot \\frac{\\partial I_{z_1}}{\\partial W_{z_{12}}} = \\frac{\\partial L}{\\partial b_{z_1}} \\cdot y_2 \\tag{14} \\\\\n\\frac{\\partial L}{\\partial W_{z_{13}}} &= \\frac{\\partial L}{\\partial z_1} \\cdot \\frac{\\partial z_1}{\\partial I_{z_1}} \\cdot \\frac{\\partial I_{z_1}}{\\partial W_{z_{13}}} = \\frac{\\partial L}{\\partial b_{z_1}} \\cdot y_3 \\tag{15}\n\\end{align}\n```\n\n\u3068\u3001\u30d0\u30a4\u30a2\u30b9\u306e\u504f\u5fae\u5206\u3092\u4f7f\u3063\u3066\u91cd\u307f\u306e\u504f\u5fae\u5206\u3092\u8868\u3059\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002$z_2$ \u306e\u307b\u3046\u3082\u540c\u69d8\u3067\u3001\n\n```math\n\\frac{\\partial L}{\\partial b_{z_2}} = \\frac{\\partial L}{\\partial z_2} \\cdot \\frac{\\partial z_2}{\\partial I_{z_2}} \\cdot \\frac{\\partial I_{z_2}}{\\partial b_{z_2}} = \\frac{\\partial L}{\\partial z_2} \\cdot \\sigma_z'(I_{z_2})\\ \\left( \\because \\frac{\\partial I_{z_2}}{\\partial b_{z_2}} = 1 \\right) \\tag{16}\n```\n```math\n\\begin{align}\n\\frac{\\partial L}{\\partial W_{z_{21}}} &= \\frac{\\partial L}{\\partial z_2} \\cdot \\frac{\\partial z_2}{\\partial I_{z_2}} \\cdot \\frac{\\partial I_{z_2}}{\\partial W_{z_{21}}} = \\frac{\\partial L}{\\partial b_{z_2}} \\cdot y_1 \\tag{17} \\\\\n\\frac{\\partial L}{\\partial W_{z_{22}}} &= \\frac{\\partial L}{\\partial z_2} \\cdot \\frac{\\partial z_2}{\\partial I_{z_2}} \\cdot \\frac{\\partial I_{z_2}}{\\partial W_{z_{22}}} = \\frac{\\partial L}{\\partial b_{z_2}} \\cdot y_2 \\tag{18} \\\\\n\\frac{\\partial L}{\\partial W_{z_{23}}} &= \\frac{\\partial L}{\\partial z_2} \\cdot \\frac{\\partial z_2}{\\partial I_{z_2}} \\cdot \\frac{\\partial I_{z_2}}{\\partial W_{z_{23}}} = \\frac{\\partial L}{\\partial b_{z_2}} \\cdot y_3 \\tag{19}\n\\end{align}\n```\n\n\u3068\u306a\u308a\u307e\u3059\u3002\n\n\u3053\u3053\u3067\u3001$\\text{(12)}$ \uff5e $\\text{(19)}$ \u3092\u5408\u308f\u305b\u3066\u3001\u5404\u504f\u5fae\u5206\u3092\u884c\u5217 ($\\partial L/\\partial \\boldsymbol{W_z}$) \u3068\u30d9\u30af\u30c8\u30eb ($\\partial L/\\partial \\boldsymbol{b_z}$) \u3067\u8868\u3059\u3053\u3068\u3092\u8003\u3048\u307e\u3057\u3087\u3046\u3002\n\u305d\u306e\u7406\u7531\u306f 2 \u3064\u3042\u3063\u3066\u3001\u307e\u305a 1 \u3064\u306f\u3001\u305f\u304f\u3055\u3093\u306e\u5f0f\u3092\u7c21\u6f54\u306b\u307e\u3068\u3081\u3089\u308c\u308b\u304b\u3089\u3067\u3059\u3002\u3053\u306e\u4f8b\u3067\u3082 $\\text{(12)}$ \uff5e $\\text{(19)}$ \u3067 8 \u3064\u306e\u5f0f\u304c\u5fc5\u8981\u3067\u3059\u304c\u3001\u884c\u5217\u3068\u30d9\u30af\u30c8\u30eb\u3067\u3046\u307e\u304f\u307e\u3068\u3081\u3089\u308c\u308c\u3070\u5f0f\u306f 2 \u3064\u3067\u6e08\u307f\u307e\u3059\u3002\n\u3082\u3046 1 \u3064\u306f\u3001\u6700\u6025\u964d\u4e0b\u6cd5\u306e\u5f0f $\\text{(2)}$ \u3092\u898b\u308b\u3068\u3001\n\n```math\n\\boldsymbol{x}^{(k+1)} = \\boldsymbol{x}^{(k)} - \\eta \\frac{\\partial}{\\partial\\boldsymbol{x}^{(k)}} f(\\boldsymbol{x}^{(k)}) \\tag*{[2]}\n```\n\n\u3068\u306a\u3063\u3066\u3044\u3066\u3001$\\boldsymbol{W_z}$ \u3084 $\\boldsymbol{b_z}$ \u3068\u540c\u3058\u5f62 (\u884c\u5217\u3084\u30d9\u30af\u30c8\u30eb) \u306b\u3057\u3066\u304a\u3044\u305f\u307b\u3046\u304c\u3001\u7dda\u5f62\u4ee3\u6570\u5b66\u7528\u306e\u30e9\u30a4\u30d6\u30e9\u30ea\u3092\u4f7f\u3063\u305f\u308a\u3067\u304d\u307e\u3059\u306e\u3067\u3001\u8a08\u7b97\u304c\u3057\u3084\u3059\u3044\u304b\u3089\u3067\u3059\u3002\n$\\boldsymbol{W_z}$ \u306f\u30d9\u30af\u30c8\u30eb\u3067\u306f\u306a\u304f\u884c\u5217\u3058\u3083\u306a\u3044\u304b\u3001\u3068\u601d\u3046\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u304c\u3001$\\eta$ \u3067\u5b9a\u6570\u500d\u3057\u3066\u5f15\u304d\u7b97\u3092\u3059\u308b\u3053\u3068\u306f\u3001\u30d9\u30af\u30c8\u30eb\u3060\u3051\u3067\u306a\u304f\u884c\u5217\u3067\u3082\u5b9a\u7fa9\u3055\u308c\u3066\u3044\u308b\u6f14\u7b97\u3067\u3059\u304b\u3089\u554f\u984c\u3042\u308a\u307e\u305b\u3093\u3002\n\n\u3067\u306f\u307e\u305a\u306f\u30d0\u30a4\u30a2\u30b9\u306e\u504f\u5fae\u5206\u3092\u30d9\u30af\u30c8\u30eb\u306e\u5f62\u306b\u76f4\u3057\u307e\u3059\u3002\n\n```math\n\\frac{\\partial L}{\\partial \\boldsymbol{b_z}} = \\begin{bmatrix}\n\t\\dfrac{\\partial L}{\\partial b_{z_1}} \\\\\n\t\\dfrac{\\partial L}{\\partial b_{z_2}}\n\\end{bmatrix} = \\begin{bmatrix}\n\t\\dfrac{\\partial L}{\\partial z_1} \\cdot \\sigma_z'(I_{z_1}) \\\\\n\t\\dfrac{\\partial L}{\\partial z_2} \\cdot \\sigma_z'(I_{z_2})\n\\end{bmatrix} = \\frac{\\partial L}{\\partial \\boldsymbol{z}} \\circ \\sigma_z'(\\boldsymbol{I_z}) \\tag{20}\n```\n\n\u3053\u3053\u3067\u767d\u3044\u30d3\u30e5\u30ec\u30c3\u30c8 $\\circ$ \u306f\u300c[**\u30a2\u30c0\u30de\u30fc\u30eb\u7a4d** (Hadamard product)](https://ja.wikipedia.org/wiki/%E3%82%A2%E3%83%80%E3%83%9E%E3%83%BC%E3%83%AB%E7%A9%8D)\u300d\u3092\u8868\u3057\u3001\u6210\u5206\u3054\u3068\u306e\u7a4d\u3092\u610f\u5473\u3057\u307e\u3059\u3002\n\u666e\u901a\u306e\u30d3\u30e5\u30ec\u30c3\u30c8 $\\cdot$ \u3060\u3068\u30d9\u30af\u30c8\u30eb\u306e\u5185\u7a4d\u3068\u533a\u5225\u304c\u4ed8\u304b\u306a\u3044\u306e\u3067\u3001\u3053\u306e\u3088\u3046\u306a\u6f14\u7b97\u5b50\u3092\u5c0e\u5165\u3057\u3066\u3044\u307e\u3059\u3002\n\n\u6b21\u306b\u91cd\u307f\u306e\u504f\u5fae\u5206\u3092\u884c\u5217\u306e\u5f62\u306b\u76f4\u3057\u307e\u3059\u3002\n\n```math\n\\begin{align}\n\\frac{\\partial L}{\\partial \\boldsymbol{W_z}} = \\begin{bmatrix}\n\t\\dfrac{\\partial L}{\\partial W_{z_{11}}} & \\dfrac{\\partial L}{\\partial W_{z_{12}}} & \\dfrac{\\partial L}{\\partial W_{z_{13}}} \\\\\n\t\\dfrac{\\partial L}{\\partial W_{z_{21}}} & \\dfrac{\\partial L}{\\partial W_{z_{22}}} & \\dfrac{\\partial L}{\\partial W_{z_{23}}}\n\\end{bmatrix} &= \\begin{bmatrix}\n\t\\dfrac{\\partial L}{\\partial b_{z_1}} \\cdot y_1 & \\dfrac{\\partial L}{\\partial b_{z_1}} \\cdot y_2 & \\dfrac{\\partial L}{\\partial b_{z_1}} \\cdot y_3 \\\\\n\t\\dfrac{\\partial L}{\\partial b_{z_2}} \\cdot y_1 & \\dfrac{\\partial L}{\\partial b_{z_2}} \\cdot y_2 & \\dfrac{\\partial L}{\\partial b_{z_2}} \\cdot y_3\n\\end{bmatrix} \\\\\n&= \\begin{bmatrix}\n\t\\dfrac{\\partial L}{\\partial b_{z_1}} \\\\\n\t\\dfrac{\\partial L}{\\partial b_{z_2}}\n\\end{bmatrix} \\begin{bmatrix}\n\ty_1 & y_2 & y_3\n\\end{bmatrix} \\\\\n&= \\frac{\\partial L}{\\partial \\boldsymbol{b_z}} \\cdot \\boldsymbol{y}^{\\top}\n\\end{align} \\tag{21}\n```\n\n\u3068\u306a\u308a\u307e\u3059\u3002\u504f\u5fae\u5206\u306e\u8a08\u7b97\u306f\u7d50\u69cb\u3084\u3084\u3053\u3057\u304b\u3063\u305f\u3067\u3059\u304c\u3001\u6700\u7d42\u7684\u306b\u884c\u5217\u3068\u30d9\u30af\u30c8\u30eb\u306e\u5f62\u306b\u3059\u308b\u3068\u3059\u3054\u304f\u30b9\u30c3\u30ad\u30ea\u3057\u305f\u5f0f\u306b\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3057\u305f\u3002\n\n\u3061\u306a\u307f\u306b\u3001\u3053\u306e $\\text{(20)}$ \u3068 $\\text{(21)}$ \u306f\u96a0\u308c\u5c64\u3068\u51fa\u529b\u5c64\u306e\u6b21\u5143\u6570\u306b\u304b\u304b\u308f\u3089\u305a\u4f7f\u3048\u308b\u3053\u3068\u3092\u899a\u3048\u3066\u304a\u3044\u3066\u304f\u3060\u3055\u3044\u3002\u3053\u306e 2 \u3064\u306e\u5f0f\u306e\u5c0e\u51fa\u904e\u7a0b\u3092\u898b\u308c\u3070\u3001\u6b21\u5143\u304c\u5897\u3048\u305f\u308a\u6e1b\u3063\u305f\u308a\u3057\u3066\u3082\u3001\u540c\u69d8\u306b\u6210\u308a\u7acb\u3064\u3053\u3068\u304c\u304a\u5206\u304b\u308a\u3044\u305f\u3060\u3051\u308b\u3068\u601d\u3044\u307e\u3059\u3002\n\u305d\u3046\u3044\u3046\u9762\u3067\u3082\u884c\u5217\u3084\u30d9\u30af\u30c8\u30eb\u306e\u5f62\u5f0f\u306b\u76f4\u3057\u3066\u304a\u304f\u3068\u4fbf\u5229\u3067\u3059\u306d\u3002:smile:\n\n## \u96a0\u308c\u5c64\u306e\u91cd\u307f\u30fb\u30d0\u30a4\u30a2\u30b9\u306e\u504f\u5fae\u5206\n\n\u6b21\u306b\u3001\u640d\u5931\u95a2\u6570\u306b\u5bfe\u3059\u308b\u96a0\u308c\u5c64\u306e\u91cd\u307f\u3001\u30d0\u30a4\u30a2\u30b9\u306e\u504f\u5fae\u5206\u3092\u6c42\u3081\u3066\u3044\u304d\u305f\u3044\u306e\u3067\u3059\u304c\u3001\u305d\u306e\u524d\u306b\u3001\u96a0\u308c\u5c64\u306e\u504f\u5fae\u5206 ($\\partial L/\\partial \\boldsymbol{y}$) \u3092\u6c42\u3081\u3066\u304a\u304d\u307e\u3057\u3087\u3046\u3002\u3053\u308c\u306f\u5f8c\u3067\u5f79\u306b\u7acb\u3061\u307e\u3059\u3002\n\n```math\n\\frac{\\partial L}{\\partial y_1} = \\frac{\\partial L}{\\partial z_1} \\cdot \\frac{\\partial z_1}{\\partial I_{z_1}} \\cdot \\frac{\\partial I_{z_1}}{\\partial y_1}\\ ???\n```\n\n\u3068\u3001\u3053\u3053\u3067\u56f0\u3063\u305f\u3053\u3068\u304c\u8d77\u304d\u307e\u3057\u305f\u3002$\\text{(10)}$ \u3092\u898b\u308b\u3068\u3001$y_1$ \u306f $I_{z_1}$ \u3060\u3051\u3067\u306a\u304f $I_{z_2}$ \u3092\u6c42\u3081\u308b\u969b\u306b\u3082\u4f7f\u308f\u308c\u3066\u3044\u308b\u3067\u306f\u3042\u308a\u307e\u305b\u3093\u304b\uff01\n\u3067\u3082\u5fc3\u914d\u306f\u3044\u308a\u307e\u305b\u3093\u3002\u305d\u3046\u3001\u6211\u3005\u306b\u306f\u300c\u9023\u9396\u5f8b\u300d\u304c\u3042\u308a\u307e\u3059\u304b\u3089\u3001\u843d\u3061\u7740\u3044\u3066\u9069\u7528\u3057\u307e\u3059\u3002\n\n```math\n\\begin{align}\n\\frac{\\partial L}{\\partial y_1} &= \\frac{\\partial L}{\\partial z_1} \\cdot \\frac{\\partial z_1}{\\partial I_{z_1}} \\cdot \\frac{\\partial I_{z_1}}{\\partial y_1} + \\frac{\\partial L}{\\partial z_2} \\cdot \\frac{\\partial z_2}{\\partial I_{z_2}} \\cdot \\frac{\\partial I_{z_2}}{\\partial y_1} \\\\\n&= \\frac{\\partial L}{\\partial b_{z_1}} \\cdot \\frac{\\partial I_{z_1}}{\\partial y_1} + \\frac{\\partial L}{\\partial b_{z_2}} \\cdot \\frac{\\partial I_{z_2}}{\\partial y_1} \\\\\n&= \\frac{\\partial L}{\\partial b_{z_1}} \\cdot W_{z_{11}} + \\frac{\\partial L}{\\partial b_{z_2}} \\cdot W_{z_{21}}\n\\end{align} \\tag{22}\n```\n\n\u3053\u308c\u3067 OK \u3067\u3059\u3002\n\n\u5c11\u3057\u88dc\u8db3\u3092\u3059\u308b\u3068\u3001$y_1$ \u304c $I_{z_1}$ \u3068 $I_{z_2}$ \u306e\u4e21\u65b9\u306e\u5f0f\u306b\u5b58\u5728\u3059\u308b\u3068\u3044\u3046\u3053\u3068\u306f\u3001$y_1$ \u306e\u5024\u304c\u5909\u5316\u3059\u308b\u3068\u3001\u5f53\u7136\u3067\u3059\u304c $I_{z_1}$ \u3068 $I_{z_2}$ \u306e\u4e21\u65b9\u306e\u5024\u306e\u5909\u5316\u306b\u5f71\u97ff\u3092\u53ca\u307c\u3059\u3053\u3068\u3092\u610f\u5473\u3057\u3066\u3044\u307e\u3059\u3002\n$I_{z_1}$ \u3068 $I_{z_2}$ \u306f\u3069\u3061\u3089\u3082\u640d\u5931\u95a2\u6570 $L$ \u306e\u5024\u306b\u5f71\u97ff\u3059\u308b\u308f\u3051\u3067\u3059\u304b\u3089\u3001\u504f\u5fae\u5206\u3092\u8003\u3048\u308b\u969b\u306b\u306f\u9023\u9396\u5f8b\u3092\u4f7f\u308f\u306a\u3051\u308c\u3070\u306a\u3089\u306a\u3044\u306e\u3067\u3059\u3002\n\n$y_2$ \u3068 $y_3$ \u306e\u504f\u5fae\u5206\u306b\u3064\u3044\u3066\u3082\u540c\u69d8\u306b\u6c42\u3081\u3089\u308c\u307e\u3059\u3002\n\n```math\n\\begin{align}\n\\frac{\\partial L}{\\partial y_2} &= \\frac{\\partial L}{\\partial z_1} \\cdot \\frac{\\partial z_1}{\\partial I_{z_1}} \\cdot \\frac{\\partial I_{z_1}}{\\partial y_2} + \\frac{\\partial L}{\\partial z_2} \\cdot \\frac{\\partial z_2}{\\partial I_{z_2}} \\cdot \\frac{\\partial I_{z_2}}{\\partial y_2} \\\\\n&= \\frac{\\partial L}{\\partial b_{z_1}} \\cdot \\frac{\\partial I_{z_1}}{\\partial y_2} + \\frac{\\partial L}{\\partial b_{z_2}} \\cdot \\frac{\\partial I_{z_2}}{\\partial y_2} \\\\\n&= \\frac{\\partial L}{\\partial b_{z_1}} \\cdot W_{z_{12}} + \\frac{\\partial L}{\\partial b_{z_2}} \\cdot W_{z_{22}}\n\\end{align} \\tag{23}\n```\n\n```math\n\\begin{align}\n\\frac{\\partial L}{\\partial y_3} &= \\frac{\\partial L}{\\partial z_1} \\cdot \\frac{\\partial z_1}{\\partial I_{z_1}} \\cdot \\frac{\\partial I_{z_1}}{\\partial y_3} + \\frac{\\partial L}{\\partial z_2} \\cdot \\frac{\\partial z_2}{\\partial I_{z_2}} \\cdot \\frac{\\partial I_{z_2}}{\\partial y_3} \\\\\n&= \\frac{\\partial L}{\\partial b_{z_1}} \\cdot \\frac{\\partial I_{z_1}}{\\partial y_3} + \\frac{\\partial L}{\\partial b_{z_2}} \\cdot \\frac{\\partial I_{z_2}}{\\partial y_3} \\\\\n&= \\frac{\\partial L}{\\partial b_{z_1}} \\cdot W_{z_{13}} + \\frac{\\partial L}{\\partial b_{z_2}} \\cdot W_{z_{23}}\n\\end{align} \\tag{24}\n```\n\n\u3067\u306f $\\text{(22)}$ \uff5e $\\text{(24)}$ \u306b\u3064\u3044\u3066\u3082\u3001\u307e\u3068\u3081\u3066\u30d9\u30af\u30c8\u30eb ($\\partial L/\\partial \\boldsymbol{y}$) \u3067\u8868\u3057\u3066\u304a\u304d\u307e\u3057\u3087\u3046\u3002\n\n```math\n\\begin{align}\n\\frac{\\partial L}{\\partial \\boldsymbol{y}} = \\begin{bmatrix}\n\t\\dfrac{\\partial L}{\\partial y_1} \\\\\n\t\\dfrac{\\partial L}{\\partial y_2} \\\\\n\t\\dfrac{\\partial L}{\\partial y_3}\n\\end{bmatrix} &= \\begin{bmatrix}\n\t\\dfrac{\\partial L}{\\partial b_{z_1}} \\cdot W_{z_{11}} + \\dfrac{\\partial L}{\\partial b_{z_2}} \\cdot W_{z_{21}} \\\\\n\t\\dfrac{\\partial L}{\\partial b_{z_1}} \\cdot W_{z_{12}} + \\dfrac{\\partial L}{\\partial b_{z_2}} \\cdot W_{z_{22}} \\\\\n\t\\dfrac{\\partial L}{\\partial b_{z_1}} \\cdot W_{z_{13}} + \\dfrac{\\partial L}{\\partial b_{z_2}} \\cdot W_{z_{23}}\n\\end{bmatrix} \\\\\n&= \\begin{bmatrix}\n\tW_{z_{11}} & W_{z_{21}} \\\\\n\tW_{z_{12}} & W_{z_{22}} \\\\\n\tW_{z_{13}} & W_{z_{23}}\n\\end{bmatrix} \\begin{bmatrix}\n\t\\dfrac{\\partial L}{\\partial b_{z_1}} \\\\\n\t\\dfrac{\\partial L}{\\partial b_{z_2}}\n\\end{bmatrix} \\\\\n&= \\boldsymbol{W_z}^{\\top} \\cdot \\frac{\\partial L}{\\partial \\boldsymbol{b_z}}\n\\end{align} \\tag{25}\n```\n\n\u9014\u4e2d\u3001\u884c\u5217\u6f14\u7b97\u3092\u8003\u616e\u3059\u308b\u95a2\u4fc2\u3067\u91cd\u307f\u3068\u30d0\u30a4\u30a2\u30b9\u306e\u9806\u756a\u304c\u5165\u308c\u66ff\u308f\u3063\u3066\u3044\u308b\u306e\u3067\u3001\u5c11\u3005\u898b\u3065\u3089\u3044\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u304c\u3001\u5730\u9053\u306b\u8a08\u7b97\u3057\u3066\u3044\u304f\u3068\u3053\u306e\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\n\u305d\u3057\u3066 $\\text{(25)}$ \u3082\u3001$\\text{(20)}$ \u3084 $\\text{(21)}$ \u3068\u540c\u3058\u3088\u3046\u306b\u3001\u884c\u5217\u3068\u30d9\u30af\u30c8\u30eb\u3067\u8868\u73fe\u3057\u305f\u3053\u3068\u306b\u3088\u3063\u3066\u3001\u96a0\u308c\u5c64\u3068\u51fa\u529b\u5c64\u306e\u6b21\u5143\u6570\u306b\u304b\u304b\u308f\u3089\u305a\u4f7f\u3048\u308b\u5f0f\u306b\u306a\u3063\u3066\u3044\u307e\u3059\u3002\n\n\u306a\u304a\u3001$\\text{(25)}$ \u306f\u91cd\u307f\u884c\u5217\u3092\u8ee2\u7f6e\u3057\u3066\u3044\u307e\u3059\u304c\u3001\u3044\u3056\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u3057\u3088\u3046\u3068\u3059\u308b\u3068\u3001\u5927\u898f\u6a21\u306a\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u3067\u306f\u8ee2\u7f6e\u306b\u6642\u9593\u304c\u304b\u304b\u308b\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u3002\n\u305d\u3046\u306a\u3089\u306a\u3044\u3088\u3046\u5de5\u592b\u304c\u3055\u308c\u3066\u3044\u308b\u7dda\u5f62\u4ee3\u6570\u5b66\u7528\u306e\u30e9\u30a4\u30d6\u30e9\u30ea\u3082\u3042\u308a\u307e\u3059\u304c\u3001\u3082\u3057\u7d20\u76f4\u306b\u8ee2\u7f6e\u3059\u308b\u3068\u304d\u306f\u3001\u4ee5\u4e0b $\\text{(26)}$ \u304c\u6210\u308a\u7acb\u3064\u3053\u3068\u3092\u5229\u7528\u3057\u3066\u3001\u91cd\u307f\u884c\u5217\u3092\u8ee2\u7f6e\u305b\u305a\u305d\u306e\u307e\u307e\u4f7f\u3046\u3088\u3046\u306b\u3059\u308b\u3068\u3088\u3044\u3067\u3057\u3087\u3046\u3002\n\n```math\n\\boldsymbol{W_z}^{\\top} \\cdot \\frac{\\partial L}{\\partial \\boldsymbol{b_z}} = \\left( \\dfrac{\\partial L}{\\partial \\boldsymbol{b_z}}^{\\top} \\cdot \\boldsymbol{W_z} \\right)^{\\top} \\tag{26}\n```\n\n\u3053\u3053\u307e\u3067\u6765\u308c\u3070\u3001\u96a0\u308c\u5c64\u306e\u91cd\u307f\u3068\u30d0\u30a4\u30a2\u30b9\u306e\u504f\u5fae\u5206\u3092\u6c42\u3081\u308b\u306e\u306f\u7c21\u5358\u3067\u3059\u3002\n\u640d\u5931\u95a2\u6570\u306b\u5bfe\u3059\u308b\u96a0\u308c\u5c64\u306e\u504f\u5fae\u5206 ($\\partial L/\\partial \\boldsymbol{y}$) \u304c\u6c42\u3081\u3089\u308c\u3066\u3044\u307e\u3059\u3057\u3001$\\text{(3)}$ \u3084 $\\text{(8)}$ \uff5e $\\text{(11)}$ \u3092\u898b\u308b\u3068\u3001\u30cb\u30e5\u30fc\u30e9\u30eb\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306e\u8a08\u7b97\u5f0f\u306f\u96a0\u308c\u5c64\u3082\u51fa\u529b\u5c64\u3082\u5909\u308f\u3089\u306a\u3044\u308f\u3051\u3067\u3059\u304b\u3089\u3001$\\text{(20)}$ \u3068 $\\text{(21)}$ \u306e\u8a18\u53f7\u3092\u5909\u3048\u3066\u518d\u5229\u7528\u304c\u3067\u304d\u307e\u3059\u3002\n\n```math\n\\begin{align}\n\\frac{\\partial L}{\\partial \\boldsymbol{b_y}} &= \\frac{\\partial L}{\\partial \\boldsymbol{y}} \\circ \\sigma_y'(\\boldsymbol{I_y}) \\tag{27}\\\\\n\\frac{\\partial L}{\\partial \\boldsymbol{W_y}} &= \\frac{\\partial L}{\\partial \\boldsymbol{b_y}} \\cdot \\boldsymbol{x}^{\\top} = \\left( \\frac{\\partial L}{\\partial \\boldsymbol{y}} \\circ \\sigma_y'(\\boldsymbol{I_y}) \\right) \\cdot \\boldsymbol{x}^{\\top} \\tag{28}\n\\end{align}\n```\n\n\u3042\u307e\u308a\u306b\u3082\u5446\u6c17\u306a\u304f\u3066\u3001\u5618\u304f\u3055\u304f\u611f\u3058\u308b\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u304c\u3001\u3053\u308c\u3067\u5408\u3063\u3066\u307e\u3059\u3002\n\u305d\u308c\u3067\u3082\u4e0d\u5b89\u306b\u611f\u3058\u305f\u3089\u3001\u691c\u7b97\u3092\u3057\u3066 $\\partial L / \\partial b_{y_1}$ \u304b\u3089\u9806\u306b\u6c42\u3081\u3066\u3044\u304f\u3068\u3088\u3044\u3067\u3057\u3087\u3046\u3002[^recalculation] \u524d\u7bc0\u306e $\\text{(12)}$ \uff5e $\\text{(21)}$ \u3068\u540c\u3058\u3088\u3046\u306a\u8a08\u7b97\u7d4c\u904e\u3092\u305f\u3069\u3063\u3066\u3001$\\text{(27)}$ \u3068 $\\text{(28)}$ \u3092\u5c0e\u304f\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n\u3042\u3001\u5165\u529b\u5c64\u306e\u504f\u5fae\u5206 ($\\partial L / \\partial \\boldsymbol{x}$) \u3092\u6c42\u3081\u308b\u5fc5\u8981\u306f\u3042\u308a\u307e\u305b\u3093\u3002\u5165\u529b\u5c64\u306b\u91cd\u307f\u3084\u30d0\u30a4\u30a2\u30b9\u306f\u3042\u308a\u307e\u305b\u3093\u304b\u3089\u3001\u6c42\u3081\u3066\u3082\u4f7f\u3044\u3069\u3053\u308d\u304c\u306a\u3044\u305f\u3081\u3067\u3059\u3002\n\n[^recalculation]: \u81ea\u5206\u3082\u300c\u672c\u5f53\u304b\u306a\u3041\uff1f\u300d\u3068\u4e0d\u601d\u8b70\u306b\u601d\u3063\u3066\u691c\u7b97\u3057\u307e\u3057\u305f\u3002\u3053\u308c\u306b\u9650\u3063\u305f\u8a71\u3067\u306f\u3042\u308a\u307e\u305b\u3093\u304c\u3001\u81ea\u5206\u306e\u624b\u3067\u30ce\u30fc\u30c8\u306b\u8a08\u7b97\u5f0f\u3092\u66f8\u3044\u3066\u89e3\u3044\u3066\u3044\u304f\u3068\u3001\u7406\u8ad6\u304c\u982d\u306e\u4e2d\u306b\u3059\u3063\u3068\u5165\u3063\u3066\u304f\u308b\u306e\u304c\u5b9f\u611f\u3067\u304d\u307e\u3059\u3002\u5b9f\u969b\u306b\u89e3\u3044\u3066\u307f\u308b\u3053\u3068\u306f\u975e\u5e38\u306b\u5927\u4e8b\u3067\u3059\u2026\u3068\u3044\u3046\u3053\u3068\u3092\u6ce8\u91c8\u3067\u3055\u3089\u3063\u3068\u66f8\u3044\u3066\u307f\u308b\u3002\n\n## \u640d\u5931\u95a2\u6570\u3068\u6d3b\u6027\u5316\u95a2\u6570\n\n\u3053\u3053\u3067\u3001\u6700\u5f8c\u307e\u3067\u6c7a\u3081\u3066\u3044\u306a\u304b\u3063\u305f\u3082\u306e\u306b\u3064\u3044\u3066\u624b\u3092\u4ed8\u3051\u308b\u3053\u3068\u306b\u3057\u307e\u3057\u3087\u3046\u3002\u305d\u3046\u3001*\u640d\u5931\u95a2\u6570* \u3068 *\u6d3b\u6027\u5316\u95a2\u6570* \u3067\u3059\u3002\n\n\u6700\u521d\u306b\u3001\u3053\u306e 2 \u3064\u306f *\u3042\u3048\u3066* \u6700\u5f8c\u306b\u63d0\u793a\u3059\u308b\u3068\u66f8\u304d\u307e\u3057\u305f\u3002\n\u640d\u5931\u95a2\u6570\u3068\u6d3b\u6027\u5316\u95a2\u6570\u3092\u4e8b\u524d\u306b\u6c7a\u5b9a\u3057\u3066\u3057\u307e\u3046\u3068\u3001\u5f0f\u3092\u8a08\u7b97\u3057\u3066\u3044\u304f\u904e\u7a0b\u3067\u3001\u5206\u6bcd\u3068\u5206\u5b50\u306b\u540c\u3058\u9805\u304c\u3067\u304d\u3066\u6d88\u3048\u3066\u3057\u307e\u3063\u305f\u308a\u3001\u5f0f\u306e\u524d\u5f8c\u306b\u4e00\u90e8\u306e\u9805\u304c\u79fb\u52d5\u3057\u3066\u3057\u307e\u3063\u305f\u308a\u3057\u3066\u3001\u305d\u306e\u640d\u5931\u95a2\u6570\u3001\u305d\u306e\u6d3b\u6027\u5316\u95a2\u6570\u3067\u3057\u304b\u901a\u7528\u3057\u306a\u3044\u5f0f\u306b\u306a\u308a\u304c\u3061\u3067\u3059\u3002\n\u305d\u306e\u72b6\u614b\u3067\u899a\u3048\u3066\u3057\u307e\u3046\u3068\u3001\u640d\u5931\u95a2\u6570\u3001\u6d3b\u6027\u5316\u95a2\u6570\u3092\u5909\u66f4\u3057\u305f\u3044\u3068\u304d\u306b\u5fdc\u7528\u304c\u5229\u304d\u307e\u305b\u3093\u306e\u3067\u3001\u6700\u5f8c\u306b\u8003\u3048\u308b\u3053\u3068\u306b\u3057\u307e\u3057\u305f\u3002\n\n\u640d\u5931\u95a2\u6570\u306f 2 \u6b21\u640d\u5931\u3092\u4f7f\u3063\u3066\u307f\u307e\u3057\u3087\u3046\u3002\u305f\u3060\u3057\u3001\u4fc2\u6570 $1/2$ \u3092\u8ffd\u52a0\u3057\u307e\u3059\u3002\n\n```math\nL = \\frac{1}{2} \\{(z_1 - T_1)^2 + (z_2 - T_2)^2\\}\n```\n\n\u308f\u3056\u308f\u3056 $1/2$ \u3092\u4ed8\u3051\u308b\u7406\u7531\u306f\u3001\u504f\u5fae\u5206\u3092\u3057\u3066\u307f\u308b\u3068\u5206\u304b\u308a\u307e\u3059\u3002\n\n```math\n\\begin{align}\n\\frac{\\partial L}{\\partial z_1} &= \\frac{1}{2} \\cdot 2(z_1 - T_1) \\cdot 1 = z_1 - T_1 \\\\\n\\frac{\\partial L}{\\partial z_2} &= \\frac{1}{2} \\cdot 2(z_2 - T_2) \\cdot 1 = z_2 - T_2 \\\\\n\\frac{\\partial L}{\\partial \\boldsymbol{z}} &= \\begin{bmatrix}\n\t\\dfrac{\\partial L}{\\partial z_1} \\\\\n\t\\dfrac{\\partial L}{\\partial z_2}\n\\end{bmatrix} = \\begin{bmatrix}\n\tz_1 - T_1 \\\\\n\tz_2 - T_2\n\\end{bmatrix} = \\boldsymbol{z} - \\boldsymbol{T} \\tag{29}\n\\end{align}\n```\n\n\u4fc2\u6570 $1/2$ \u304c\u4ed8\u3044\u3066\u3044\u3066\u3082\u640d\u5931\u95a2\u6570\u306e\u5927\u5c0f\u95a2\u4fc2\u306f\u5d29\u308c\u307e\u305b\u3093\u304b\u3089\u554f\u984c\u3042\u308a\u307e\u305b\u3093\u3057\u3001\u504f\u5fae\u5206\u306e\u969b\u306b\u80a9\u306e 2 \u4e57\u304c\u964d\u308a\u3066\u304f\u308b\u306e\u3092\u4fc2\u6570\u3067\u76f8\u6bba\u3067\u304d\u308b\u305f\u3081\u3001\u5f0f\u3092\u7c21\u5358\u306b\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n\u6b21\u306b\u6d3b\u6027\u5316\u95a2\u6570\u3067\u3059\u304c\u3001\u4eca\u56de\u306f\u96a0\u308c\u5c64\u3001\u51fa\u529b\u5c64\u3068\u3082\u300c[**\u6a19\u6e96\u30b7\u30b0\u30e2\u30a4\u30c9\u95a2\u6570** (standard sigmoid function)](https://ja.wikipedia.org/wiki/%E3%82%B7%E3%82%B0%E3%83%A2%E3%82%A4%E3%83%89%E9%96%A2%E6%95%B0)\u300d\u3092\u4f7f\u3063\u3066\u307f\u307e\u3059\u3002[^standard_sigmoid_citation]\n\n![\u6a19\u6e96\u30b7\u30b0\u30e2\u30a4\u30c9\u95a2\u6570](https://upload.wikimedia.org/wikipedia/commons/thumb/8/88/Logistic-curve.svg/500px-Logistic-curve.svg.png)\n\n\u30b7\u30b0\u30e2\u30a4\u30c9\u95a2\u6570\u306f\u975e\u7dda\u5f62\u306e\u95a2\u6570\u3067\u3001\u95a2\u6570 $\\sigma(x)$ \u304a\u3088\u3073\u305d\u306e\u5c0e\u95a2\u6570 $\\sigma'(x)$ \u306f\u4ee5\u4e0b\u306e\u3068\u304a\u308a\u3067\u3059\u3002\n\n```math\n\\begin{align}\n\\sigma(x) &= \\frac{1}{1 + e^{-x}} \\\\\n\\\\\n\\sigma'(x) &= \\left( \\frac{1}{1 + e^{-x}} \\right)' = \\{ (1 + e^{-x})^{-1} \\}' \\\\\n&= -1 \\cdot (1 + e^{-x})^{-2} \\cdot e^{-x} \\cdot (-1) \\\\\n&= \\frac{e^{-x}}{(1 + e^{-x})^2} = \\frac{1 + e^{-x}}{(1 + e^{-x})^2} - \\frac{1}{(1 + e^{-x})^2} \\\\\n&= \\frac{1}{1 + e^{-x}} - \\left(\\frac{1}{1 + e^{-x}}\\right)^2 = \\sigma(x) - \\{\\sigma(x)\\}^2 \\\\\n&= \\sigma(x) \\{ 1 - \\sigma(x) \\} \\tag{30}\n\\end{align}\n```\n\n\u3053\u306e\u95a2\u6570\u3092\u6d3b\u6027\u5316\u95a2\u6570\u306b\u4f7f\u3046\u30e1\u30ea\u30c3\u30c8\u3068\u3057\u3066\u3001\n\n* \u5b9a\u7fa9\u57df $(-\\infty, \\infty)$ \u306b\u5bfe\u3057\u3066\u5024\u57df $(0, 1)$ \u3067\u3042\u308a\u3001\u4eca\u56de\u306e\u534a\u52a0\u7b97\u5668\u306e\u51fa\u529b\u7bc4\u56f2\u3068\u3057\u3066\u9069\u5f53\u3067\u3042\u308b\u3002\n* $\\text{(30)}$ \u3067\u8868\u3059\u3068\u304a\u308a\u30011 \u968e\u5c0e\u95a2\u6570\u3092\u81ea\u5206\u81ea\u8eab\u3092\u4f7f\u3063\u3066\u8868\u3059\u3053\u3068\u304c\u3067\u304d\u308b\u3002\n\n\u304c\u3042\u308a\u307e\u3059\u3002$\\text{(30)}$ \u3092\u7528\u3044\u3066\u96a0\u308c\u5c64\u3068\u51fa\u529b\u5c64\u306e\u6d3b\u6027\u5316\u95a2\u6570\u306e\u5fae\u5206 $\\sigma_y'( \\boldsymbol{I_y} ), \\sigma_z'( \\boldsymbol{I_z} )$ \u3092\u6c42\u3081\u308b\u3068\u3001\n\n```math\n\\begin{align}\n\\sigma_y'( \\boldsymbol{I_y} ) &= \\begin{bmatrix}\n\t\\sigma_y'( I_{y_1} ) \\\\\n\t\\sigma_y'( I_{y_2} ) \\\\\n\t\\sigma_y'( I_{y_3} )\n\\end{bmatrix} = \\begin{bmatrix}\n\t\\sigma_y( I_{y_1} ) \\{ 1 - \\sigma_y( I_{y_1} ) \\} \\\\\n\t\\sigma_y( I_{y_2} ) \\{ 1 - \\sigma_y( I_{y_2} ) \\} \\\\\n\t\\sigma_y( I_{y_3} ) \\{ 1 - \\sigma_y( I_{y_3} ) \\}\n\\end{bmatrix} = \\begin{bmatrix}\n\ty_1 ( 1 - y_1 ) \\\\\n\ty_2 ( 1 - y_2 ) \\\\\n\ty_3 ( 1 - y_3 )\n\\end{bmatrix} \\\\\n&= \\boldsymbol{y} \\circ (\\boldsymbol{1} - \\boldsymbol{y}) \\tag{31}\n\\end{align}\n```\n\n```math\n\\begin{align}\n\\sigma_z'( \\boldsymbol{I_z} ) &= \\begin{bmatrix}\n\t\\sigma_z'( I_{z_1} ) \\\\\n\t\\sigma_z'( I_{z_2} )\n\\end{bmatrix} = \\begin{bmatrix}\n\t\\sigma_z( I_{z_1} ) \\{ 1 - \\sigma_z( I_{z_1} ) \\} \\\\\n\t\\sigma_z( I_{z_2} ) \\{ 1 - \\sigma_z( I_{z_2} ) \\}\n\\end{bmatrix} = \\begin{bmatrix}\n\tz_1 ( 1 - z_1 ) \\\\\n\tz_2 ( 1 - z_2 )\n\\end{bmatrix} \\\\\n&= \\boldsymbol{z} \\circ (\\boldsymbol{1} - \\boldsymbol{z}) \\tag{32}\n\\end{align}\n```\n\n\u3068\u306a\u308a\u3001\u306a\u308b\u307b\u3069\u3001\u3068\u3066\u3082\u7c21\u5358\u306b\u306a\u308a\u307e\u3057\u305f (\u30a2\u30c0\u30de\u30fc\u30eb\u7a4d\u306b\u306a\u308b\u3053\u3068\u306b\u6ce8\u610f)\u3002\n\n\u5f0f $\\text{(29)}$\u3001$\\text{(31)}$\u3001$\\text{(32)}$ \u3092\u8e0f\u307e\u3048\u3066\u3001\u640d\u5931\u95a2\u6570\u306b\u5bfe\u3059\u308b\u91cd\u307f\u3068\u30d0\u30a4\u30a2\u30b9\u306e\u504f\u5fae\u5206\u306e\u6700\u7d42\u7684\u306a\u5f0f\u306f\u3001\n\n```math\n\\begin{align}\n\\frac{\\partial L}{\\partial \\boldsymbol{b_z}} &= \\frac{\\partial L}{\\partial \\boldsymbol{z}} \\circ \\sigma_z^{\\prime}(\\boldsymbol{I_z}) = (\\boldsymbol{z} - \\boldsymbol{T}) \\circ \\boldsymbol{z} \\circ (\\boldsymbol{1} - \\boldsymbol{z}) \\\\\n\\frac{\\partial L}{\\partial \\boldsymbol{W_z}} &= \\frac{\\partial L}{\\partial \\boldsymbol{b_z}} \\cdot \\boldsymbol{y}^{\\top} \\tag*{[21]} \\\\\n\\frac{\\partial L}{\\partial \\boldsymbol{y}} &= \\boldsymbol{W_z}^{\\top} \\cdot \\frac{\\partial L}{\\partial \\boldsymbol{b_z}} \\tag*{[25]} \\\\\n\\frac{\\partial L}{\\partial \\boldsymbol{b_y}} &= \\frac{\\partial L}{\\partial \\boldsymbol{y}} \\circ \\sigma_y^{\\prime}(\\boldsymbol{I_y}) = \\frac{\\partial L}{\\partial \\boldsymbol{y}} \\circ \\boldsymbol{y} \\circ (\\boldsymbol{1} - \\boldsymbol{y}) \\\\\n\\frac{\\partial L}{\\partial \\boldsymbol{W_y}} &= \\frac{\\partial L}{\\partial \\boldsymbol{b_y}} \\cdot \\boldsymbol{x}^{\\top} \\tag*{[28]}\n\\end{align}\n```\n\n\u3068\u306a\u308a\u307e\u3059\u3002\u3088\u3046\u3084\u304f\u3053\u308c\u3067\u3059\u3079\u3066\u63c3\u3044\u307e\u3057\u305f\u3002\u3042\u3068\u306f\u3072\u305f\u3059\u3089\u30b3\u30f3\u30d4\u30e5\u30fc\u30bf\u306b\u8a08\u7b97\u3055\u305b\u308b\u3060\u3051\u3067\u3059\u3002\n\n[^standard_sigmoid_citation]: \u753b\u50cf\u306f [***Sigmoid function*** (Wikipedia \u82f1\u8a9e\u7248)](https://en.wikipedia.org/wiki/Sigmoid_function) \u3088\u308a\u5f15\u7528\u3057\u307e\u3057\u305f\u3002\n\n## \u5b66\u7fd2\u3055\u305b\u3088\u3046\n\n\u30cb\u30e5\u30fc\u30e9\u30eb\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306e\u5b66\u7fd2\u306f\u3001\u304a\u304a\u3080\u306d\u4ee5\u4e0b\u306e\u624b\u9806\u3067\u884c\u3044\u307e\u3059\u3002\u5834\u5408\u306b\u3088\u3063\u3066\u306f\u3053\u306e\u3068\u304a\u308a\u306e\u624b\u9806\u306b\u306a\u3089\u306a\u3044\u3053\u3068\u304c\u3042\u308a\u307e\u3059\u306e\u3067\u3001\u53c2\u8003\u7a0b\u5ea6\u306b\u898b\u3066\u304f\u3060\u3055\u3044\u3002\n\n1. \u91cd\u307f\u3068\u30d0\u30a4\u30a2\u30b9\u3092\u521d\u671f\u5316\u3059\u308b\u3002\n1. \u4ee5\u4e0b\u3092\u5b66\u7fd2\u56de\u6570\u3076\u3093\u7e70\u308a\u8fd4\u3059\u3002\n\t1. \u4ee5\u4e0b\u3092\u5165\u529b\u306e\u3076\u3093\u7e70\u308a\u8fd4\u3059\u3002\n\t\t1. \u73fe\u5728\u306e\u91cd\u307f\u3068\u30d0\u30a4\u30a2\u30b9\u3092\u4f7f\u3044\u3001\u5165\u529b\u30c7\u30fc\u30bf\u304b\u3089\u5404\u5c64\u306e\u5024\u3092\u8a08\u7b97\u3059\u308b (\u9806\u4f1d\u64ad)\u3002\n\t\t1. \u640d\u5931\u95a2\u6570\u3092\u8a08\u7b97\u3059\u308b\u3002\u504f\u5fae\u5206\u306e\u8a08\u7b97\u306b\u76f4\u63a5\u5fc5\u8981\u3067\u306f\u306a\u3044\u304c\u3001\u5b66\u7fd2\u306e\u7d4c\u904e\u3092\u78ba\u8a8d\u3067\u304d\u308b\u3002\n\t\t1. \u640d\u5931\u95a2\u6570\u306b\u5bfe\u3059\u308b\u5404\u5c64\u306e\u91cd\u307f\u3068\u30d0\u30a4\u30a2\u30b9\u306e\u504f\u5fae\u5206\u3092\u8a08\u7b97\u3059\u308b\u3002\n\t1. \u5165\u529b\u3054\u3068\u306e\u640d\u5931\u95a2\u6570\u306b\u5bfe\u3059\u308b\u504f\u5fae\u5206 ($\\partial L/\\partial w$) \u304b\u3089\u3001\u5168\u4f53\u640d\u5931\u95a2\u6570\u306b\u5bfe\u3059\u308b\u504f\u5fae\u5206 ($\\partial L^{(all)}/\\partial w$) \u3092\u8a08\u7b97\u3059\u308b\u3002\n\t1. \u6700\u6025\u964d\u4e0b\u6cd5\u3092\u4f7f\u3044\u3001\u91cd\u307f\u3068\u30d0\u30a4\u30a2\u30b9\u3092\u4fee\u6b63\u3059\u308b\u3002\n\n\u300c\u521d\u671f\u5316\u300d\u306b\u3064\u3044\u3066\u3053\u3053\u307e\u3067\u8a00\u53ca\u3057\u3066\u304d\u307e\u305b\u3093\u3067\u3057\u305f\u304c\u30011 \u3064\u6ce8\u610f\u70b9\u3092\u6319\u3052\u3066\u304a\u304f\u3068\u3001\u91cd\u307f\u3068\u30d0\u30a4\u30a2\u30b9\u306e\u521d\u671f\u5316\u306f *\u4e71\u6570\u3092\u4f7f\u3046\u306e\u304c\u57fa\u672c* \u3067\u3042\u308a\u3001\u6c7a\u3057\u3066 *\u540c\u3058\u5024\u3067\u521d\u671f\u5316\u3057\u3066\u306f\u3044\u3051\u306a\u3044* \u3068\u3044\u3046\u3053\u3068\u3067\u3059\u3002\n\u540c\u3058\u5024\u3067\u521d\u671f\u5316\u3057\u3066\u3057\u307e\u3046\u3068\u3001\u640d\u5931\u95a2\u6570\u306b\u5bfe\u3059\u308b\u504f\u5fae\u5206 ($\\partial L/\\partial w$) \u304c\u3059\u3079\u3066\u306e\u30ce\u30fc\u30c9\u3067\u7b49\u3057\u304f\u306a\u308a\u3001\u6700\u6025\u964d\u4e0b\u6cd5\u306b\u3088\u308b\u4fee\u6b63\u91cf\u3082\u540c\u3058\u306b\u306a\u308b\u305f\u3081\u3001\u30ce\u30fc\u30c9\u306b\u304b\u304b\u308f\u3089\u305a\u91cd\u307f\u3001\u30d0\u30a4\u30a2\u30b9\u304c\u5e38\u306b\u540c\u3058\u5024\u306b\u306a\u308a\u307e\u3059\u3002\n\u540c\u3058\u91cd\u307f\u3001\u30d0\u30a4\u30a2\u30b9\u3092\u6301\u3064\u30ce\u30fc\u30c9\u306f 1 \u3064\u306b\u307e\u3068\u3081\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u306e\u3067\u3001\u305d\u306e\u5c64\u306e\u6b21\u5143\u6570\u304c\u5c0f\u3055\u304f\u306a\u3063\u3066\u3057\u307e\u3044\u307e\u3059\u3002\u3053\u308c\u306f\u3059\u306a\u308f\u3061\u3001*\u8868\u73fe\u529b\u304c\u4f4e\u4e0b\u3057\u305f* \u3053\u3068\u3092\u610f\u5473\u3059\u308b\u306e\u3067\u3059\u3002\n\u5b9f\u969b\u3001\u3053\u306e\u72b6\u614b\u3067\u306f\u30cb\u30e5\u30fc\u30e9\u30eb\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306e\u5b66\u7fd2\u306f\u3001\u591a\u304f\u306e\u5834\u5408\u3046\u307e\u304f\u3044\u304d\u307e\u305b\u3093\u3002\n\n\u4ee5\u4e0a\u306b\u6ce8\u610f\u3057\u3064\u3064\u3001\u534a\u52a0\u7b97\u5668\u306e\u30cb\u30e5\u30fc\u30e9\u30eb\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u3092\u5b66\u7fd2\u3055\u305b\u305f\u3068\u3053\u308d\u3001\u4eca\u56de [^different_results] \u306f\u4ee5\u4e0b\u306e\u7d50\u679c\u306b\u306a\u308a\u307e\u3057\u305f\u3002\n\n![\u534a\u52a0\u7b97\u5668\u30cb\u30e5\u30fc\u30e9\u30eb\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306e\u5b66\u7fd2\u7d50\u679c](https://qiita-image-store.s3.amazonaws.com/0/107860/0bf62f65-f4f1-a213-0e12-3792dd51d01e.png)\n\n```gnuplot:half_adder.plot\nset term png size 600,300 transparent font 'Arial' 11\nset output 'half_adder.png'\nset title 'Learning of a half adder'\nset xlabel 'Times'\nset ylabel 'Quadratic loss function'\nunset key\nset lmargin 10.5\nset rmargin 3.5\nset tmargin 2\nset bmargin 3\nset xrange [0:100000]\nset yrange [0:0.01]\nplot 'half_adder.csv' with lines linewidth 2\n```\n\n\u5b66\u7fd2\u56de\u6570\u304c\u5897\u3048\u308b\u306b\u3057\u305f\u304c\u3044\u3001\u640d\u5931\u95a2\u6570\u304c\u9806\u8abf\u306b\u5c0f\u3055\u304f\u306a\u3063\u3066\u3044\u304f\u306e\u304c\u5206\u304b\u308a\u307e\u3059\u3002\u3046\u307e\u304f\u5b66\u7fd2\u3067\u304d\u3066\u3044\u308b\u3088\u3046\u3067\u3059\u3002\n\n\u4eca\u56de\u306f\u91cd\u307f\u3001\u30d0\u30a4\u30a2\u30b9\u306e\u521d\u671f\u5316\u306b\u306f\u9589\u533a\u9593 $[-8, 8]$ \u306e\u4e00\u69d8\u5206\u5e03\u4e71\u6570\u3092\u4f7f\u3044\u3001\u5b66\u7fd2\u7387 (\u6700\u6025\u964d\u4e0b\u6cd5\u306e\u4fc2\u6570 $\\eta$) \u306f 0.3 \u3068\u3057\u307e\u3057\u305f\u3002\n\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u306f [Gist](https://gist.github.com/xrated/9db1da7789fa93e00b1fdea2d3e74669) \u306b\u6295\u7a3f\u3057\u3066\u3044\u307e\u3059\u306e\u3067\u3001\u3054\u8208\u5473\u304c\u3042\u308c\u3070\u3001\u96a0\u308c\u5c64\u306e\u6b21\u5143\u6570\u3084\u4e71\u6570\u5206\u5e03\u3001\u5b66\u7fd2\u7387\u306e\u9055\u3044\u306b\u3088\u308b\u3001\u5b66\u7fd2\u7d50\u679c\u306e\u9055\u3044\u3092\u6bd4\u8f03\u3057\u3066\u307f\u3066\u304f\u3060\u3055\u3044\u3002[^forgive_source]\n\n[^different_results]: \u30cb\u30e5\u30fc\u30e9\u30eb\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306e\u5b66\u7fd2\u306f\u3001\u640d\u5931\u95a2\u6570\u3084\u5b66\u7fd2\u7387 (\u6700\u6025\u964d\u4e0b\u6cd5\u306e\u504f\u5fae\u5206\u9805\u306b\u4ed8\u304f\u4fc2\u6570)\u3001\u91cd\u307f\u3068\u30d0\u30a4\u30a2\u30b9\u306e\u521d\u671f\u5024\u7b49\u3001\u305f\u304f\u3055\u3093\u306e\u30d1\u30e9\u30e1\u30fc\u30bf\u304c\u3042\u308b\u305f\u3081\u3001\u305d\u306e\u5024\u306b\u3088\u3063\u3066\u306f\u5b66\u7fd2\u304c\u3046\u307e\u304f\u3044\u304f\u3068\u304d\u3068\u3044\u304b\u306a\u3044\u3068\u304d\u304c\u3042\u308a\u307e\u3059\u3002\n[^forgive_source]: \u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u306f\u3068\u306b\u304b\u304f\u5206\u304b\u308a\u3084\u3059\u3055\u3092\u91cd\u8996\u3057\u3066\u3001\u901f\u5ea6\u3084\u52b9\u7387\u306f\u4e00\u5207\u6c17\u306b\u3057\u3066\u3044\u307e\u305b\u3093\u3002\u305d\u3053\u306b\u3064\u3044\u3066\u306f\u3054\u52d8\u5f01\u304f\u3060\u3055\u3044\u307e\u305b\u3002\n\n\n# \u8aa4\u5dee\u9006\u4f1d\u64ad\u6cd5\n\n\u524d\u7ae0\u306f\u3001\u8aa4\u5dee\u9006\u4f1d\u64ad\u6cd5\u3068\u306f\u4f55\u306a\u306e\u304b\u3068\u3044\u3046\u70b9\u3092\u3059\u3063\u98db\u3070\u3057\u3066\u3001\u52e2\u3044\u306b\u4efb\u305b\u3066\u5b9f\u4f8b\u3092\u9577\u3005\u3068\u66f8\u3044\u3066\u3057\u307e\u3044\u307e\u3057\u305f\u3002\u3053\u3053\u3067\u306f\u8aa4\u5dee\u9006\u4f1d\u64ad\u6cd5\u306b\u3064\u3044\u3066\u307e\u3068\u3081\u3066\u3044\u304d\u307e\u3059\u3002\n\n## \u9806\u4f1d\u64ad\u3068\u9006\u4f1d\u64ad\n\n\u307e\u305a\u3001\u534a\u52a0\u7b97\u5668\u306e\u5b66\u7fd2\u306b\u51fa\u3066\u304d\u305f\u6570\u5f0f\u306e\u4e00\u90e8\u3092\u307e\u3068\u3081\u307e\u3059\u3002\n\n```math\n\\begin{align}\n\\boldsymbol{x} &= (x_1, x_2) \\tag*{[7]} \\\\\n\\boldsymbol{y} &= \\sigma_y( \\boldsymbol{W_y} \\boldsymbol{x} + \\boldsymbol{b_y} ) \\tag{9'} \\\\\n\\boldsymbol{z} &= \\sigma_z( \\boldsymbol{W_z} \\boldsymbol{y} + \\boldsymbol{b_z} ) \\tag{11'}\\\\\n\\\\\n\\frac{\\partial L}{\\partial \\boldsymbol{z}} &= \\boldsymbol{z} - \\boldsymbol{T} \\tag*{[29]} \\\\\n\\frac{\\partial L}{\\partial \\boldsymbol{b_z}} &= \\frac{\\partial L}{\\partial \\boldsymbol{z}} \\circ \\sigma_z'( \\boldsymbol{W_z} \\boldsymbol{y} + \\boldsymbol{b_z} ) \\tag{20'} \\\\\n\\frac{\\partial L}{\\partial \\boldsymbol{W_z}} &= \\frac{\\partial L}{\\partial \\boldsymbol{b_z}} \\cdot \\boldsymbol{y}^{\\top} \\tag*{[21]} \\\\\n\\frac{\\partial L}{\\partial \\boldsymbol{y}} &= \\boldsymbol{W_z}^{\\top} \\cdot \\frac{\\partial L}{\\partial \\boldsymbol{b_z}} \\tag*{[25]} \\\\\n\\frac{\\partial L}{\\partial \\boldsymbol{b_y}} &= \\frac{\\partial L}{\\partial \\boldsymbol{y}} \\circ \\sigma_y'( \\boldsymbol{W_y} \\boldsymbol{x} + \\boldsymbol{b_y} ) \\tag{27'} \\\\\n\\frac{\\partial L}{\\partial \\boldsymbol{W_y}} &= \\frac{\\partial L}{\\partial \\boldsymbol{b_y}} \\cdot \\boldsymbol{x}^{\\top} \\tag*{[28]}\n\\end{align}\n```\n\n$\\text{(7)}$\u3001$\\text{(9')}$\u3001$\\text{(11')}$ \u3092\u898b\u308b\u3068\u3001\u5c64\u306e\u5024\u3092\u6c42\u3081\u308b\u305f\u3081\u306b\u306f\u3001**\u524d**\u306e\u5c64\u306e\u5024\u304c\u5fc5\u8981\u306b\u306a\u308b\u3053\u3068\u304c\u5206\u304b\u308b\u3068\u601d\u3044\u307e\u3059\u3002\n\u305d\u3057\u3066\u3001$\\text{(29)}$\u3001$\\text{(20')}$\u3001$\\text{(21)}$\u3001$\\text{(25)}$\u3001$\\text{(27')}$\u3001$\\text{(28)}$ \u3092\u898b\u308b\u3068\u3001\u504f\u5fae\u5206\u3092\u6c42\u3081\u308b\u305f\u3081\u306b\u306f\u3001**\u5f8c\u308d**\u306e\u5c64\u306e\u504f\u5fae\u5206\u304c\u5fc5\u8981\u306b\u306a\u308b\u3053\u3068\u304c\u5206\u304b\u308a\u307e\u3059\u3002\n\n\u5c64\u306e\u5024\u3092\u5165\u529b\u5c64\u304b\u3089\u51fa\u529b\u5c64\u306b\u5411\u304b\u3063\u3066\u9806\u756a\u306b\u8a08\u7b97\u3057\u3066\u3044\u304f\u904e\u7a0b\u3092\u300c\u9806\u4f1d\u64ad\u300d\u3068\u8aac\u660e\u3057\u307e\u3057\u305f\u304c\u3001\u305d\u308c\u306b\u5bfe\u3057\u3066\u3001\u504f\u5fae\u5206\u3092\u51fa\u529b\u5c64\u304b\u3089\u5165\u529b\u5c64\u306b\u5411\u304b\u3063\u3066\u9806\u756a\u306b\u8a08\u7b97\u3057\u3066\u3044\u304f\u904e\u7a0b\u3092\u300c**\u9006\u4f1d\u64ad** (backward propagation)\u300d\u3068\u3044\u3044\u307e\u3059\u3002\n\u305d\u3057\u3066\u3001\u640d\u5931\u95a2\u6570 $L$ \u3092 *\u8aa4\u5dee* \u3068\u898b\u7acb\u3066\u3066\u3001\u9006\u4f1d\u64ad\u306b\u3088\u3063\u3066\u91cd\u307f\u3068\u30d0\u30a4\u30a2\u30b9\u3092\u4fee\u6b63\u3057\u3066\u3044\u304f\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u304c\u300c**\u8aa4\u5dee\u9006\u4f1d\u64ad\u6cd5**\u300d\u306a\u306e\u3067\u3059\u3002\n\n\u524d\u7ae0\u3067\u3001\u8aa4\u5dee\u9006\u4f1d\u64ad\u6cd5\u304c\u5177\u4f53\u7684\u306b\u4f55\u3092\u793a\u3057\u3066\u3044\u308b\u306e\u304b\u660e\u3089\u304b\u306b\u305b\u305a\u306b\u30cb\u30e5\u30fc\u30e9\u30eb\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306e\u5b66\u7fd2\u3092\u9032\u3081\u307e\u3057\u305f\u304c\u3001\u4f55\u306e\u3053\u3068\u306f\u306a\u304f\u3001\u3084\u3063\u3066\u3044\u305f\u3053\u3068\u306f\u8aa4\u5dee\u9006\u4f1d\u64ad\u6cd5\u305d\u306e\u3082\u306e\u3067\u3059\u3002\n\n## \u4e00\u822c\u5316\n\n\u3053\u3053\u3067\u30cb\u30e5\u30fc\u30e9\u30eb\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306e\u8a08\u7b97\u30e2\u30c7\u30eb\u306b\u3064\u3044\u3066\u304a\u3055\u3089\u3044\u3057\u3066\u304a\u304d\u307e\u3057\u3087\u3046\u3002\n\n```math\n\\boldsymbol{l}^{(k+1)} = \\sigma^{(k+1)}(\\boldsymbol{W}^{(k+1)} \\boldsymbol{l}^{(k)} + \\boldsymbol{b}^{(k+1)}) \\tag*{[3]}\n```\n\n\u3053\u306e\u8a18\u53f7\u306b\u5408\u308f\u305b\u3066\u3001\u8aa4\u5dee\u9006\u4f1d\u64ad\u6cd5\u306e\u5f0f\u3082\u793a\u3057\u3066\u3044\u304d\u307e\u3059\u3002\n\n```math\n\\begin{align}\n\\frac{\\partial L}{\\partial \\boldsymbol{l}^{(k)}} &= \\left\\{ \\begin{array}{ll}\n\t\\text{Depend on } L & (\\text{if the } k \\text{-th layer is the output one}) \\\\\n\t{\\boldsymbol{W}^{(k+1)}}^{\\top} \\cdot \\dfrac{\\partial L}{\\partial \\boldsymbol{b}^{(k+1)}} & (\\text{otherwise})\n\\end{array} \\right. \\tag{33} \\\\\n\\frac{\\partial L}{\\partial \\boldsymbol{b}^{(k)}} &= \\frac{\\partial L}{\\partial \\boldsymbol{l}^{(k)}} \\circ \\sigma'^{(k)}( \\boldsymbol{W}^{(k)} \\boldsymbol{l}^{(k-1)} + \\boldsymbol{b}^{(k)} ) \\tag{34} \\\\\n\\frac{\\partial L}{\\partial \\boldsymbol{W}^{(k)}} &= \\frac{\\partial L}{\\partial \\boldsymbol{b}^{(k)}} \\cdot {\\boldsymbol{l}^{(k-1)}}^{\\top} \\tag{35}\n\\end{align}\n```\n\n\u5c64\u306e\u756a\u53f7 $k$ \u3092\u51fa\u529b\u5c64\u304b\u3089\u5165\u529b\u5c64\u306b\u5411\u304b\u3063\u3066\u9806\u756a\u306b\u6e1b\u3089\u3057\u3066\u3044\u304d\u3001\u640d\u5931\u95a2\u6570\u306b\u5bfe\u3059\u308b\u5404\u5c64\u306e\u91cd\u307f\u3068\u30d0\u30a4\u30a2\u30b9\u306e\u504f\u5fae\u5206\u3092\u6c42\u3081\u3066\u3044\u304d\u307e\u3059\u3002\n\u3053\u3053\u3067\u6ce8\u610f\u3059\u308b\u3079\u304d\u3053\u3068\u306f\u3001$k$ \u756a\u76ee\u306e\u5c64\u304c\u51fa\u529b\u5c64\u3060\u3068\u640d\u5931\u95a2\u6570\u6b21\u7b2c\u3067\u5f0f\u304c\u5909\u308f\u308b\u305f\u3081\u3001$\\partial L/\\partial \\boldsymbol{l}^{(k)}$ \u306b\u5834\u5408\u5206\u3051\u304c\u767a\u751f\u3059\u308b\u3053\u3068\u3067\u3059\u3002\n\n\u4e00\u822c\u5316\u3057\u305f\u5f0f $\\text{(33)}$ \uff5e $\\text{(35)}$ \u306f\u8a18\u53f7\u3092\u5909\u3048\u305f\u3060\u3051\u306a\u306e\u3067\u3059\u304c\u3001\u534a\u52a0\u7b97\u5668\u306e\u5b9f\u4f8b\u304b\u3089\u3059\u308b\u3068\u3001\u304b\u3048\u3063\u3066\u5206\u304b\u308a\u306b\u304f\u304f\u306a\u3063\u3066\u3057\u307e\u3063\u3066\u3044\u308b\u6c17\u304c\u3057\u307e\u3059\u3002\n\u6b63\u76f4\u306a\u3068\u3053\u308d\u3001\u4e00\u822c\u5316\u3057\u305f\u5f0f\u3067\u899a\u3048\u308b\u3088\u308a\u3082\u3001\u5b9f\u4f8b\u3067\u306e\u5f0f $\\text{(29)}$\u3001$\\text{(20')}$\u3001$\\text{(21)}$\u3001$\\text{(25)}$\u3001$\\text{(27')}$\u3001$\\text{(28)}$ \u3067\u899a\u3048\u3066\u304a\u3044\u305f\u307b\u3046\u304c\u697d\u304b\u306a\u3068\u601d\u3044\u307e\u3059\u3002\n\n\n# \u3042\u308f\u305b\u3066\u8aad\u307f\u305f\u3044\n\n* [\u30cb\u30e5\u30fc\u30e9\u30eb\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u3068\u6df1\u5c64\u5b66\u7fd2](http://nnadl-ja.github.io/nnadl_site_ja/)\n* [\u8aa4\u5dee\u9006\u4f1d\u64ad\u6cd5\u306e\u30ce\u30fc\u30c8](http://qiita.com/Ugo-Nama/items/04814a13c9ea84978a4c) by @Ugo-Nama\n* [Denoising Autoencoders\u306b\u304a\u3051\u308b\u78ba\u7387\u7684\u52fe\u914d\u964d\u4e0b\u6cd5\uff08\u6570\u5f0f\u306e\u5c0e\u51fa\uff09](http://blog.yusugomori.com/post/42116682299/)\n* TSG Machine Learning &raquo; [#08 \u78ba\u7387\u7684\u52fe\u914d\u964d\u4e0b\u6cd5](http://sig.tsg.ne.jp/ml2015/ml/2015/06/08/stochastic-gradient-descent.html)\n\n\n# \u304a\u308f\u308a\u306b\n\n\u8a18\u4e8b\u304c\u77ed\u3044\u3068\u8a73\u7d30\u306a\u8aac\u660e\u304c\u3067\u304d\u305a\u5206\u304b\u308a\u306b\u304f\u304f\u306a\u3063\u3066\u3057\u307e\u3046\u3057\u3001\u9577\u3044\u3068\u305d\u3082\u305d\u3082\u8aad\u3080\u6c17\u304c\u8d77\u3053\u3089\u306a\u3044\u3001\u3068\u3044\u3046\u30b8\u30ec\u30f3\u30de\u306b\u9665\u3063\u305f\u7d50\u679c\u3001\u3053\u306e\u8a18\u4e8b\u3067\u306f\u9577\u304f\u306a\u308b\u307b\u3046\u3092\u53d6\u308a\u307e\u3057\u305f\u3002\u3057\u304b\u3057\u305d\u308c\u306b\u3088\u3063\u3066\u5206\u304b\u308a\u3084\u3059\u304f\u306a\u3063\u305f\u304b\u306f\u4e0d\u660e\u3067\u3059\u304c\u2026\u3002\n\u77ed\u3059\u304e\u305a\u9577\u3059\u304e\u305a\u3061\u3087\u3046\u3069\u3088\u304f\u307e\u3068\u3081\u3089\u308c\u308b\u65b9\u304c\u7fa8\u307e\u3057\u3044\u3068\u601d\u3046\u4eca\u65e5\u3053\u306e\u9803\u3067\u3059\u3002\n\n\u8aa4\u5dee\u9006\u4f1d\u64ad\u6cd5\u306f\u3001\u7c21\u5358\u306a\u30e1\u30e2\u66f8\u304d\u304f\u3089\u3044\u306e\u5206\u91cf\u306e\u3082\u306e\u304b\u3089\u3001\u305d\u308c\u3053\u305d\u672c\u304c\u66f8\u3051\u3066\u3057\u307e\u3044\u305d\u3046\u306a\u5206\u91cf\u306e\u3082\u306e\u307e\u3067\u3001\u305f\u304f\u3055\u3093\u306e\u89e3\u8aac\u304c\u5b58\u5728\u3059\u308b\u306e\u3067\u3059\u304c\u3001\u81ea\u5206\u81ea\u8eab\u304c\u7406\u89e3\u3059\u308b\u305f\u3081\u306b\u306f\u3001\u7d50\u5c40\u306e\u3068\u3053\u308d\u81ea\u5206\u81ea\u8eab\u3067\u6570\u5f0f\u3092\u3053\u306d\u304f\u308a\u56de\u3057\u3001\u81ea\u5206\u81ea\u8eab\u3067\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u3057\u3066\u307f\u3066\u3001\u305d\u306e\u3068\u304d\u306e\u6c17\u4ed8\u304d\u3092\u982d\u306b\u305f\u305f\u304d\u8fbc\u3080\u3053\u3068\u304c\u4e00\u756a\u306e\u65b9\u6cd5\u3067\u306f\u306a\u3044\u304b\u3068\u601d\u3044\u307e\u3059\u3002\n\u5192\u982d\u3067\u66f8\u3044\u305f\u3088\u3046\u306b\u3001\u3053\u306e\u8a18\u4e8b\u306f\u79c1\u304c\u300c\u8aa4\u5dee\u9006\u4f1d\u64ad\u6cd5\u300d\u3092\u52c9\u5f37\u3059\u308b\u3046\u3048\u3067\u5fc5\u8981\u3060\u3063\u305f\u60c5\u5831\u3092\u8a18\u9332\u3057\u305f\u3082\u306e\u3067\u3059\u304c\u3001\u3053\u306e\u8a18\u4e8b\u304c\u7686\u3055\u307e\u306e\u304a\u5f79\u306b\u7acb\u3066\u305f\u3089\u5b09\u3057\u3044\u3067\u3059\u3002\n\n\u3082\u3057\u6570\u5f0f\u3084\u8003\u3048\u65b9\u306a\u3069\u3067\u3054\u4e0d\u660e\u306a\u70b9\u304c\u3042\u308c\u3070\u3001\u3054\u9060\u616e\u306a\u304f\u30b3\u30e1\u30f3\u30c8\u3057\u3066\u304f\u3060\u3055\u3044\u307e\u305b\u3002\n\u6700\u5f8c\u307e\u3067\u304a\u8aad\u307f\u3044\u305f\u3060\u304d\u3042\u308a\u304c\u3068\u3046\u3054\u3056\u3044\u307e\u3057\u305f\u3002\n\n\n# \u5965\u4ed8\n\n\u8a18\u4e8b\u306b\u306f\u81ea\u5206\u306a\u308a\u306b\u3057\u3063\u304b\u308a\u3068\u76ee\u3092\u901a\u3057\u3066\u306f\u3044\u307e\u3059\u304c\u3001\u8aa4\u5b57\u8131\u5b57\u3001\u756a\u53f7\u53c2\u7167\u306e\u9593\u9055\u3044\u3001\u8868\u73fe\u306e\u8aa4\u308a\u306a\u3069\u304c\u3042\u308a\u307e\u3057\u305f\u3089\u3001\u30b3\u30e1\u30f3\u30c8\u6b04\u306b\u3066\u3054\u6307\u6458\u304f\u3060\u3055\u308b\u3068\u5e78\u3044\u3067\u3059\u3002\n\n* \u521d\u7a3f \u300c\u8aa4\u5dee\u9006\u4f1d\u64ad\u6cd5\u3092\u306f\u3058\u3081\u304b\u3089\u3066\u3044\u306d\u3044\u306b\u300d\n\t* 2016/09/06\n", "tags": ["\u6a5f\u68b0\u5b66\u7fd2", "\u30cb\u30e5\u30fc\u30e9\u30eb\u30cd\u30c3\u30c8\u30ef\u30fc\u30af"]}