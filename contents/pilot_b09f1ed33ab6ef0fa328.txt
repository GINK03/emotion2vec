{"tags": ["digdag"], "context": "\nvartest.dig\n_export:\n  var_top: var_top_val\n\n+tasktop1:\n  _export:\n    var_tasktop1: var_tasktop1_val\n\n  +tasksub1:\n    _export:\n      var_tasksub1: var_tasksub1_val\n    echo>: at tasksub1... ${var_top} ${var_tasktop1} ${var_tasksub1}\n\n  +tasksub2:\n    rb>: SetVar.setVar\n    require: 'setvar'\n\n  +tasksub3:\n    echo>: at tasksub3... ${var_rb}\n\n+tasktop2:\n  echo>: at tasktop2... ${var_top} ${var_rb} # var_tasktop1/var_tasksub1\u3092\u53c2\u7167\u3059\u308b\u3068\u30a8\u30e9\u30fc\n\n+tasktop3:\n  _export:\n    var_top: var_top_val_override # \u5024\u306e\u4e0a\u66f8\u304d\u53ef\u80fd\n    var_rb: ${var_rb}_override    # \u5024\u306e\u53c2\u7167\u30fb\u4e0a\u66f8\u304d\u3059\u308b\u3068\u5909\u306a\u5faa\u74b0\u72b6\u614b\u306b\u306a\u3063\u3066\u3057\u307e\u3046\u306e\u3067\u3084\u3081\u308b\u3079\u304d(\u2606)\n\n  +tasksub4:\n    echo>: at tasksub4... ${var_top} ${var_rb}\n\n  +tasksub5:\n    sh>: echo at tasksub5... ${var_top} ${var_rb}\n\n\n\u5b9f\u306f_export\u306a\u3057\u3067\u3082\u30b5\u30d6\u30bf\u30b9\u30af\u304c\u306a\u3051\u308c\u3070\u5909\u6570\u4f5c\u308c\u308b\u304c\u3001\u30de\u30cb\u30e5\u30a2\u30eb\u306b\u305d\u3093\u306a\u8a18\u8ff0\u306a\u3044\u3063\u307d\u3044\u306e\u3067\u3084\u3081\u305f\u65b9\u304c\u826f\u3055\u305d\u3046\n\nsetvar.rb\nrequire 'pp'\n\nclass SetVar\n  def setVar\n    pp Digdag.env.params\n    Digdag.env.store(var_rb: 'var_rb_val')\n  end\nend\n\n\n\u7d50\u679c\n2016-10-25 16:28:11 +0900: Digdag v0.8.17\n2016-10-25 16:28:14 +0900 [WARN] (main): Using a new session time 2016-10-25T00:00:00+00:00.\n2016-10-25 16:28:14 +0900 [INFO] (main): Using session /tmp/.digdag/status/20161025T000000+0000.\n2016-10-25 16:28:14 +0900 [INFO] (main): Starting a new session project id=1 workflow name=vartest session_time=2016-10-25T00:00:00+00:00\n2016-10-25 16:28:17 +0900 [INFO] (0016@+vartest+tasktop1+tasksub1): echo>: at tasksub1... var_top_val var_tasktop1_val var_tasksub1_val\nat tasksub1... var_top_val var_tasktop1_val var_tasksub1_val\n2016-10-25 16:28:18 +0900 [INFO] (0016@+vartest+tasktop1+tasksub2): rb>: SetVar.setVar\n{\"timezone\"=>\"UTC\",\n \"session_uuid\"=>\"fca5f15a-bb7e-459c-980d-1268162c42be\",\n \"session_time\"=>\"2016-10-25T00:00:00+00:00\",\n \"session_date\"=>\"2016-10-25\",\n \"session_date_compact\"=>\"20161025\",\n \"session_local_time\"=>\"2016-10-25 00:00:00\",\n \"session_tz_offset\"=>\"+0000\",\n \"session_unixtime\"=>1477353600,\n \"project_id\"=>1,\n \"var_top\"=>\"var_top_val\",\n \"var_tasktop1\"=>\"var_tasktop1_val\",\n \"rb>\"=>\"SetVar.setVar\",\n \"require\"=>\"setvar\",\n \"_type\"=>\"rb\",\n \"_command\"=>\"SetVar.setVar\"}\n2016-10-25 16:28:19 +0900 [INFO] (0016@+vartest+tasktop1+tasksub3): echo>: at tasksub3... var_rb_val\nat tasksub3... var_rb_val\n2016-10-25 16:28:20 +0900 [INFO] (0016@+vartest+tasktop2): echo>: at tasktop2... var_top_val var_rb_val\nat tasktop2... var_top_val var_rb_val\n2016-10-25 16:28:21 +0900 [INFO] (0016@+vartest+tasktop3+tasksub4): echo>: at tasksub4... var_top_val_override ${var_rb}_override_override\nat tasksub4... var_top_val_override ${var_rb}_override_override\n2016-10-25 16:28:22 +0900 [INFO] (0016@+vartest+tasktop3+tasksub5): sh>: echo at tasksub5... var_top_val_override ${var_rb}_override_override\nat tasksub5... var_top_val_override ${var_rb}_override_override_override_override\nSuccess. Task state is saved at /tmp/.digdag/status/20161025T000000+0000 directory.\n  * Use --session <daily | hourly | \"yyyy-MM-dd[ HH:mm:ss]\"> to not reuse the last session time.\n  * Use --rerun, --start +NAME, or --goal +NAME argument to rerun skipped tasks.\n\nDigdag.env.store()\u3057\u305f\u5909\u6570\u306f\u30c8\u30c3\u30d7\u30ec\u30d9\u30eb\u306e_export\u3068\u540c\u3058\u30b9\u30b3\u30fc\u30d7\u306b\u306a\u308b\n\u2606\u304c\u5909\u306a\u5faa\u74b0\u306b\u306a\u3063\u3066\u300c${var_rb}_override_override\u300d\u3068\u304b\u300c${var_rb}_override_override_override_override\u300d\u3068\u304b\u306b\u306a\u3063\u3066\u3057\u307e\u3046\n\u3053\u3046\u3044\u3046\u3053\u3068\u306f\u3057\u306a\u3044\u3088\u3046\u306b\u3057\u3088\u3046\n\u53c2\u8003\uff1a\nhttp://docs.digdag.io/workflow_definition.html#defining-variables\nhttps://youtu.be/OAaFr_CnXvk?t=832 \u203bdigdag\u516c\u958b\u524d\u306e\u52d5\u753b\nhttps://youtu.be/OAaFr_CnXvk?t=1812 \u203bdigdag\u516c\u958b\u524d\u306e\u52d5\u753b\n```vartest.dig\n_export:\n  var_top: var_top_val\n\n+tasktop1:\n  _export:\n    var_tasktop1: var_tasktop1_val\n\n  +tasksub1:\n    _export:\n      var_tasksub1: var_tasksub1_val\n    echo>: at tasksub1... ${var_top} ${var_tasktop1} ${var_tasksub1}\n\n  +tasksub2:\n    rb>: SetVar.setVar\n    require: 'setvar'\n\n  +tasksub3:\n    echo>: at tasksub3... ${var_rb}\n\n+tasktop2:\n  echo>: at tasktop2... ${var_top} ${var_rb} # var_tasktop1/var_tasksub1\u3092\u53c2\u7167\u3059\u308b\u3068\u30a8\u30e9\u30fc\n\n+tasktop3:\n  _export:\n    var_top: var_top_val_override # \u5024\u306e\u4e0a\u66f8\u304d\u53ef\u80fd\n    var_rb: ${var_rb}_override    # \u5024\u306e\u53c2\u7167\u30fb\u4e0a\u66f8\u304d\u3059\u308b\u3068\u5909\u306a\u5faa\u74b0\u72b6\u614b\u306b\u306a\u3063\u3066\u3057\u307e\u3046\u306e\u3067\u3084\u3081\u308b\u3079\u304d(\u2606)\n\n  +tasksub4:\n    echo>: at tasksub4... ${var_top} ${var_rb}\n\n  +tasksub5:\n    sh>: echo at tasksub5... ${var_top} ${var_rb}\n```\n\n\u5b9f\u306f_export\u306a\u3057\u3067\u3082\u30b5\u30d6\u30bf\u30b9\u30af\u304c\u306a\u3051\u308c\u3070\u5909\u6570\u4f5c\u308c\u308b\u304c\u3001\u30de\u30cb\u30e5\u30a2\u30eb\u306b\u305d\u3093\u306a\u8a18\u8ff0\u306a\u3044\u3063\u307d\u3044\u306e\u3067\u3084\u3081\u305f\u65b9\u304c\u826f\u3055\u305d\u3046\n\n```setvar.rb\nrequire 'pp'\n\nclass SetVar\n  def setVar\n    pp Digdag.env.params\n    Digdag.env.store(var_rb: 'var_rb_val')\n  end\nend\n```\n\n\u7d50\u679c\n\n```\n2016-10-25 16:28:11 +0900: Digdag v0.8.17\n2016-10-25 16:28:14 +0900 [WARN] (main): Using a new session time 2016-10-25T00:00:00+00:00.\n2016-10-25 16:28:14 +0900 [INFO] (main): Using session /tmp/.digdag/status/20161025T000000+0000.\n2016-10-25 16:28:14 +0900 [INFO] (main): Starting a new session project id=1 workflow name=vartest session_time=2016-10-25T00:00:00+00:00\n2016-10-25 16:28:17 +0900 [INFO] (0016@+vartest+tasktop1+tasksub1): echo>: at tasksub1... var_top_val var_tasktop1_val var_tasksub1_val\nat tasksub1... var_top_val var_tasktop1_val var_tasksub1_val\n2016-10-25 16:28:18 +0900 [INFO] (0016@+vartest+tasktop1+tasksub2): rb>: SetVar.setVar\n{\"timezone\"=>\"UTC\",\n \"session_uuid\"=>\"fca5f15a-bb7e-459c-980d-1268162c42be\",\n \"session_time\"=>\"2016-10-25T00:00:00+00:00\",\n \"session_date\"=>\"2016-10-25\",\n \"session_date_compact\"=>\"20161025\",\n \"session_local_time\"=>\"2016-10-25 00:00:00\",\n \"session_tz_offset\"=>\"+0000\",\n \"session_unixtime\"=>1477353600,\n \"project_id\"=>1,\n \"var_top\"=>\"var_top_val\",\n \"var_tasktop1\"=>\"var_tasktop1_val\",\n \"rb>\"=>\"SetVar.setVar\",\n \"require\"=>\"setvar\",\n \"_type\"=>\"rb\",\n \"_command\"=>\"SetVar.setVar\"}\n2016-10-25 16:28:19 +0900 [INFO] (0016@+vartest+tasktop1+tasksub3): echo>: at tasksub3... var_rb_val\nat tasksub3... var_rb_val\n2016-10-25 16:28:20 +0900 [INFO] (0016@+vartest+tasktop2): echo>: at tasktop2... var_top_val var_rb_val\nat tasktop2... var_top_val var_rb_val\n2016-10-25 16:28:21 +0900 [INFO] (0016@+vartest+tasktop3+tasksub4): echo>: at tasksub4... var_top_val_override ${var_rb}_override_override\nat tasksub4... var_top_val_override ${var_rb}_override_override\n2016-10-25 16:28:22 +0900 [INFO] (0016@+vartest+tasktop3+tasksub5): sh>: echo at tasksub5... var_top_val_override ${var_rb}_override_override\nat tasksub5... var_top_val_override ${var_rb}_override_override_override_override\nSuccess. Task state is saved at /tmp/.digdag/status/20161025T000000+0000 directory.\n  * Use --session <daily | hourly | \"yyyy-MM-dd[ HH:mm:ss]\"> to not reuse the last session time.\n  * Use --rerun, --start +NAME, or --goal +NAME argument to rerun skipped tasks.\n```\n\nDigdag.env.store()\u3057\u305f\u5909\u6570\u306f\u30c8\u30c3\u30d7\u30ec\u30d9\u30eb\u306e_export\u3068\u540c\u3058\u30b9\u30b3\u30fc\u30d7\u306b\u306a\u308b\n\n\u2606\u304c\u5909\u306a\u5faa\u74b0\u306b\u306a\u3063\u3066\u300c\\$\\{var\\_rb\\}\\_override\\_override\u300d\u3068\u304b\u300c\\$\\{var\\_rb\\}\\_override\\_override\\_override\\_override\u300d\u3068\u304b\u306b\u306a\u3063\u3066\u3057\u307e\u3046\n\u3053\u3046\u3044\u3046\u3053\u3068\u306f\u3057\u306a\u3044\u3088\u3046\u306b\u3057\u3088\u3046\n\n\u53c2\u8003\uff1a\nhttp://docs.digdag.io/workflow_definition.html#defining-variables\nhttps://youtu.be/OAaFr_CnXvk?t=832 \u203bdigdag\u516c\u958b\u524d\u306e\u52d5\u753b\nhttps://youtu.be/OAaFr_CnXvk?t=1812 \u203bdigdag\u516c\u958b\u524d\u306e\u52d5\u753b\n"}