{"context": " More than 1 year has passed since last update.\n\n\u6982\u8981\n\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u6a2a\u65b9\u5411\u306e\u30c7\u30fc\u30bf\u3092\u7e26\u65b9\u5411\u306b\u5909\u63db\n\n\u5909\u63db\u524d\n\n\n\nID\n\u9805\u76ee1\n\u9805\u76ee2\n\u9805\u76ee3\n\n\n\n\nID1\nvalue1-1\nvalue1-2\nvalue1-3\n\n\nID2\nvalue2-1\nvalue2-2\nvalue2-3\n\n\n\n\n\u5909\u63db\u5f8c\n\n\n\nID\n\u9805\u76ee\nvalue\n\n\n\n\nID1\n\u9805\u76ee1\nvalue1-1\n\n\nID1\n\u9805\u76ee2\nvalue1-2\n\n\nID1\n\u9805\u76ee3\nvalue1-3\n\n\nID2\n\u9805\u76ee1\nvalue2-1\n\n\nID2\n\u9805\u76ee2\nvalue2-2\n\n\nID2\n\u9805\u76ee3\nvalue2-3\n\n\n\n\n\u4f7f\u3044\u65b9\n\u5909\u63db\u3057\u305f\u3044\u30b7\u30fc\u30c8\u306b\u79fb\u52d5\u3057\u3066\u30de\u30af\u30ed\u3092\u5b9f\u884c\u3002\nSub \u7e26\u65b9\u5411\u306b\u5909\u63db()\n    ' \u5909\u6570\u5b9a\u7fa9\n    Dim i, ii, iii, maxRow, targetColumn, printFromRow As Long\n    Dim myKeys(), myElements(), myLabel As String\n\n    ' \u521d\u671f\u5024\u8a2d\u5b9a\n    printFromRow = 2\n    Set fromSheet = ActiveSheet\n    maxRow = Cells(60000, 1).End(xlUp).Row\n    ReDim myElements(maxRow - 1)\n\n    ' \u51fa\u529b\u5148\u30b7\u30fc\u30c8\u4f5c\u6210\n    Set toSheet = Worksheets.Add()\n    toSheet.Name = fromSheet.Name + \"_\u7e26\u65b9\u5411\"\n\n    ' \u51fa\u529b\u5148\u30b7\u30fc\u30c8\u306b\u9805\u76ee\u8868\u793a\n    toSheet.Select\n    Cells(1, 1).Value = \"\u30ad\u30fc\"\n    Cells(1, 2).Value = \"\u9805\u76ee\"\n    Cells(1, 3).Value = \"\u5024\"\n\n    ' key\u53d6\u5f97\n    fromSheet.Select\n    ReDim myKeys(maxRow - 1)\n\n     ' \u60c5\u5831\u306e\u53d6\u5f97\uff06\u51fa\u529b\n    ii = 0\n    For i = 2 To maxRow\n        myKeys(ii) = Cells(i, 1).Value\n        ii = ii + 1\n    Next\n\n\n    For i = 2 To Cells(1, 1000).End(xlToLeft).Column\n\n        ' \u60c5\u5831\u306e\u53d6\u5f97\n        fromSheet.Select\n        targetColumn = i\n        myLabel = Cells(1, targetColumn).Value\n        Erase myElements ' \u914d\u5217\u521d\u671f\u5316\n        ReDim myElements(maxRow - 1)\n\n        iii = 0\n        For ii = 2 To maxRow\n            myElements(iii) = Cells(ii, targetColumn).Value\n            iii = iii + 1\n        Next\n\n\n        ' \u60c5\u5831\u306e\u51fa\u529b\n        toSheet.Select\n        iii = 0\n        For ii = printFromRow To printFromRow + maxRow - 2\n            Cells(ii, 1).Value = myKeys(iii)\n            Cells(ii, 2).Value = myLabel\n            Cells(ii, 3) = myElements(iii)\n            iii = iii + 1\n        Next\n\n        printFromRow = printFromRow + maxRow - 1\n\n    Next\n\nEnd Sub\n\n## \u6982\u8981\n\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u6a2a\u65b9\u5411\u306e\u30c7\u30fc\u30bf\u3092\u7e26\u65b9\u5411\u306b\u5909\u63db\n### \u5909\u63db\u524d\n|ID|\u9805\u76ee1|\u9805\u76ee2|\u9805\u76ee3|\n|:-:|:-:|:-:|:-:|\n|ID1|value1-1|value1-2|value1-3|\n|ID2|value2-1|value2-2|value2-3|\n\n### \u5909\u63db\u5f8c\n|ID|\u9805\u76ee|value|\n|:-:|:-:|:-:|\n|ID1|\u9805\u76ee1|value1-1|\n|ID1|\u9805\u76ee2|value1-2|\n|ID1|\u9805\u76ee3|value1-3|\n|ID2|\u9805\u76ee1|value2-1|\n|ID2|\u9805\u76ee2|value2-2|\n|ID2|\u9805\u76ee3|value2-3|\n\n## \u4f7f\u3044\u65b9\n\u5909\u63db\u3057\u305f\u3044\u30b7\u30fc\u30c8\u306b\u79fb\u52d5\u3057\u3066\u30de\u30af\u30ed\u3092\u5b9f\u884c\u3002\n\n```\nSub \u7e26\u65b9\u5411\u306b\u5909\u63db()\n    ' \u5909\u6570\u5b9a\u7fa9\n    Dim i, ii, iii, maxRow, targetColumn, printFromRow As Long\n    Dim myKeys(), myElements(), myLabel As String\n        \n    ' \u521d\u671f\u5024\u8a2d\u5b9a\n    printFromRow = 2\n    Set fromSheet = ActiveSheet\n    maxRow = Cells(60000, 1).End(xlUp).Row\n    ReDim myElements(maxRow - 1)\n    \n    ' \u51fa\u529b\u5148\u30b7\u30fc\u30c8\u4f5c\u6210\n    Set toSheet = Worksheets.Add()\n    toSheet.Name = fromSheet.Name + \"_\u7e26\u65b9\u5411\"\n    \n    ' \u51fa\u529b\u5148\u30b7\u30fc\u30c8\u306b\u9805\u76ee\u8868\u793a\n    toSheet.Select\n    Cells(1, 1).Value = \"\u30ad\u30fc\"\n    Cells(1, 2).Value = \"\u9805\u76ee\"\n    Cells(1, 3).Value = \"\u5024\"\n    \n    ' key\u53d6\u5f97\n    fromSheet.Select\n    ReDim myKeys(maxRow - 1)\n    \n     ' \u60c5\u5831\u306e\u53d6\u5f97\uff06\u51fa\u529b\n    ii = 0\n    For i = 2 To maxRow\n        myKeys(ii) = Cells(i, 1).Value\n        ii = ii + 1\n    Next\n    \n    \n    For i = 2 To Cells(1, 1000).End(xlToLeft).Column\n    \n        ' \u60c5\u5831\u306e\u53d6\u5f97\n        fromSheet.Select\n        targetColumn = i\n        myLabel = Cells(1, targetColumn).Value\n        Erase myElements ' \u914d\u5217\u521d\u671f\u5316\n        ReDim myElements(maxRow - 1)\n        \n        iii = 0\n        For ii = 2 To maxRow\n            myElements(iii) = Cells(ii, targetColumn).Value\n            iii = iii + 1\n        Next\n        \n        \n        ' \u60c5\u5831\u306e\u51fa\u529b\n        toSheet.Select\n        iii = 0\n        For ii = printFromRow To printFromRow + maxRow - 2\n            Cells(ii, 1).Value = myKeys(iii)\n            Cells(ii, 2).Value = myLabel\n            Cells(ii, 3) = myElements(iii)\n            iii = iii + 1\n        Next\n        \n        printFromRow = printFromRow + maxRow - 1\n    \n    Next\n    \nEnd Sub\n```\n", "tags": ["VBA"]}