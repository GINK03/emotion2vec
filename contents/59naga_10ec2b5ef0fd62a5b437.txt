{"context": " More than 1 year has passed since last update.babel6\u306fCommonJS\u306b\u5bfe\u5fdc\u3057\u306a\u3044\u306e\u3067\u3001\u30b3\u30f3\u30d1\u30a4\u30eb\u6e08\u307f\u306e\u30b3\u30fc\u30c9\u306bmodule.exports\uff08require\u306e\u30a8\u30f3\u30c8\u30ea\u30dd\u30a4\u30f3\u30c8\uff09\u304c\u542b\u307e\u308c\u307e\u305b\u3093\u3002\u3053\u308c\u306f\u3001transform-es2015-modules-commonjs\u30d7\u30e9\u30b0\u30a4\u30f3\u3092\u4f7f\u3063\u3066\u3082\u6539\u5584\u3057\u307e\u305b\u3093\u3067\u3057\u305f\u3002issue\u3082\u3057\u3087\u3063\u3061\u3085\u3046\u7acb\u3063\u3066\u306fLock\u3055\u308c\u3066\u307e\u3059\u3002\nadd-module-exports\u30d7\u30e9\u30b0\u30a4\u30f3\u3068\u3044\u3046\u3082\u306e\u3092\u4f5c\u6210\u3057\u307e\u3057\u305f\u3002\u3053\u308c\u306f\u30b3\u30fc\u30c9\u672b\u5c3e\u306bmodule.exports\u6587\u3092\u52a0\u3048\u307e\u3059\u3002\nnpm install babel-cli --save-dev\nnpm install babel-preset-es2015 --save-dev\nnpm install babel-plugin-add-module-exports --save-dev\n\n\n0.1.*\u7cfb\nbabel@5\u306e\u52d5\u4f5c\u306b\u6e96\u62e0\u3059\u308b\u30d0\u30fc\u30b8\u30e7\u30f30.1.0\u3092\u516c\u958b\u3057\u307e\u3057\u305f\u3002\n\u3053\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u3067\u306f\u3001export default\u6587\u306e\u307f\u3092\u4f7f\u7528\u3057\u305f\u5834\u5408\u306b\u3060\u3051\u3001module.exports\u6587\u3092\u8ffd\u52a0\u3057\u307e\u3059\u3002\n\nindex.js\nexport default 'foo'\n\n\n\u4e0a\u8a18\u306fmodule.exports\u6587\u3092\u8ffd\u52a0\u3057\u307e\u3059\u3002\nbabel index.js --presets es2015 --plugins add-module-exports \n# 'use strict';\n#\n# Object.defineProperty(exports, \"__esModule\", {\n#   value: true\n# });\n# exports.default = 'foo';\n# module.exports = exports['default'];\n\n\u4e0b\u8a18\u306f\u8ffd\u52a0\u3057\u307e\u305b\u3093\u3002\n\nindex.js\nlet foo= 'bar'\nexport default 'baz'\nexport {foo}\n\n\nbabel index.js --presets es2015 --plugins add-module-exports \n# 'use strict';\n#\n# Object.defineProperty(exports, \"__esModule\", {\n#   value: true\n# });\n# var foo = 'bar';\n# exports.default = 'baz';\n# exports.foo = foo;\n\n\n0.0.*\u7cfb\n\u5e38\u306bmodule.exports\u6587\u3092\u767a\u884c\u3057\u307e\u3059\u3002Object.assign\u3067\u30de\u30fc\u30b8\u3059\u308b\u305f\u3081\u3001\u52d5\u4f5c\u306f\u7834\u58ca\u7684\u3067\u3059\u3002\n\nindex.js\nlet foo= 'bar'\nexport default 'baz'\nexport {foo}\n\n\n\u4e0b\u8a18\u306e\u3088\u3046\u306b\u5909\u63db\u3055\u308c\u308b\u3067\u3057\u3087\u3046\u3002\nbabel index.js --presets es2015 --plugins add-module-exports \n# 'use strict';\n#\n# Object.defineProperty(exports, \"__esModule\", {\n#   value: true\n# });\n# var foo = 'bar';\n# exports.default = 'baz';\n# exports.foo = foo;\n# module.exports = Object.assign(exports.default || {}, exports);\n\nObject.assign\u3092\u4f7f\u7528\u3057\u305f\u304f\u306a\u3044\u5834\u5408\u306f\u3001polyfill\u306b\u7f6e\u63db\u3067\u304d\u308b\u30d7\u30e9\u30b0\u30a4\u30f3\u304c\u7528\u610f\u3055\u308c\u3066\u3044\u308b\u306e\u3067\u3001\u3053\u308c\u3092\u5229\u7528\u3057\u3066\u4e0b\u3055\u3044\u3002\n\n\u53c2\u8003\n\nbabel6\u3067\u306e\u5909\u66f4\u70b9\u3000Gulp\u30fbWebpack\u306e\u8a2d\u5b9a by kamijin_fanta(Qiita)\n.babelrc / package.json\n\n\n\u3088\u3082\u3084\u307e\u8a71\nbabel@6\u304b\u3089\u30d7\u30e9\u30b0\u30a4\u30f3\u306e\u4f5c\u6210\u65b9\u6cd5\u3082\u5909\u308f\u3063\u305f\u3089\u3057\u304f\u3001\u30cf\u30ed\u30fc\u30ef\u30fc\u30eb\u30c9\u7684\u306a\u8a18\u4e8b\u3092\u63a2\u3057\u3066\u3082\u30015\u7cfb\u306e\u3082\u306e\u304c\u307b\u3068\u3093\u3069\u3067\u3057\u305f\u3002\u305d\u306e\u4e2d\u3001\u983c\u308a\u306b\u306a\u308b\u306e\u306f\u516c\u5f0f\u306e\u4f3c\u305f\u76ee\u7684\u3092\u6301\u3064\u30d7\u30e9\u30b0\u30a4\u30f3\u306e\u5b9f\u88c5\u3068\u65e5\u672c\u8a9e\u306e5\u7cfb\u306e\u89e3\u8aac\u8a18\u4e8b\u3067\u3057\u305f\u3002\n\u4f8b\u3048\u3070\u62d9\u4f5c\u306e\u30d7\u30e9\u30b0\u30a4\u30f3\u3067\u306f\u3001babel-template\u3068\u3044\u3046sebmck\u88fd\u30e2\u30b8\u30e5\u30fc\u30eb\u306b\u4f9d\u5b58\u3057\u3066\u3044\u307e\u3059\u304c\u3001\u3053\u308c\u306f\u6587\u5b57\u5217\u304b\u3089AST\u306e\u751f\u6210\u95a2\u6570\u3092\u8fd4\u3059\u30d5\u30a1\u30af\u30c8\u30ea\u95a2\u6570\u3067\u3059\u3002\nvar babelTemplate= require('babel-template')\nbabelTemplate('var hoge=\"fuga\"')()\n// { type: 'VariableDeclaration',\n//   start: undefined,\n//   end: undefined,\n//   loc: undefined,\n//   declarations: \n//    [ { type: 'VariableDeclarator',\n//        start: undefined,\n//        end: undefined,\n//        loc: undefined,\n//        id: [Object],\n//        init: [Object],\n//        _fromTemplate: true } ],\n//   kind: 'var',\n//   _fromTemplate: true }\n\n\u30d7\u30e9\u30b0\u30a4\u30f3\u306e\u30a8\u30f3\u30c8\u30ea\u30dd\u30a4\u30f3\u30c8\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u8fd4\u3059\u306e\u304c\u6c7a\u307e\u308a\u3067\u3059\u304c\u3001visitor\u5185\u306e\u30c8\u30e9\u30f3\u30b9\u30d5\u30a9\u30fc\u30e0\u95a2\u6570\u306e\u7b2c\u4e00\u5f15\u6570path\u304cAST\u6539\u5909\u7528\u306e\u30e1\u30bd\u30c3\u30c9\u7fa4\u3092\u6301\u3064\u306e\u3067\u3001\u3053\u308c\u306e.pushContainer('body')\u306bAST\u306e\u914d\u5217\u3092\u6e21\u3059\u3068\u3001\u30aa\u30ec\u30aa\u30ec\u30b3\u30fc\u30c9\u3092\u8ffd\u52a0\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3057\u305f\u3002\n\nbabel-plugin-add-module-exports/lib/index.js\n// Dependencies\nvar babelTemplate= require('babel-template')\n\n// Public\nmodule.exports= function(){\n  return {\n    visitor: {\n      Program: {\n        exit: function(path){\n          var topNodes= []\n\n          var code= 'module.exports=Object.assign(exports.default||{},exports);'\n          var node= babelTemplate(code)()\n          topNodes.push(node)\n\n          path.pushContainer('body',topNodes)// \u30d7\u30ed\u30b0\u30e9\u30e0\u672b\u5c3e\u306b`module.exports = Object.assign(exports.default || {}, exports);`\u3092\u8ffd\u52a0\u3059\u308b\n        },\n      },\n    },\n  }\n}\n\n\n[babel6\u306fCommonJS\u306b\u5bfe\u5fdc\u3057\u306a\u3044\u306e\u3067](https://phabricator.babeljs.io/T2212)\u3001\u30b3\u30f3\u30d1\u30a4\u30eb\u6e08\u307f\u306e\u30b3\u30fc\u30c9\u306b`module.exports`\uff08require\u306e\u30a8\u30f3\u30c8\u30ea\u30dd\u30a4\u30f3\u30c8\uff09\u304c\u542b\u307e\u308c\u307e\u305b\u3093\u3002\u3053\u308c\u306f\u3001[transform-es2015-modules-commonjs\u30d7\u30e9\u30b0\u30a4\u30f3](https://www.npmjs.com/package/babel-plugin-transform-es2015-modules-commonjs)\u3092\u4f7f\u3063\u3066\u3082\u6539\u5584\u3057\u307e\u305b\u3093\u3067\u3057\u305f\u3002[issue\u3082\u3057\u3087\u3063\u3061\u3085\u3046\u7acb\u3063\u3066\u306fLock\u3055\u308c\u3066\u307e\u3059\u3002](https://phabricator.babeljs.io/T2975)\n\n[add-module-exports](https://github.com/59naga/babel-plugin-add-module-exports)\u30d7\u30e9\u30b0\u30a4\u30f3\u3068\u3044\u3046\u3082\u306e\u3092\u4f5c\u6210\u3057\u307e\u3057\u305f\u3002\u3053\u308c\u306f\u30b3\u30fc\u30c9\u672b\u5c3e\u306b`module.exports`\u6587\u3092\u52a0\u3048\u307e\u3059\u3002\n\n```bash\nnpm install babel-cli --save-dev\nnpm install babel-preset-es2015 --save-dev\nnpm install babel-plugin-add-module-exports --save-dev\n```\n\n## `0.1.*`\u7cfb\n\n`babel@5`\u306e\u52d5\u4f5c\u306b\u6e96\u62e0\u3059\u308b\u30d0\u30fc\u30b8\u30e7\u30f3`0.1.0`\u3092\u516c\u958b\u3057\u307e\u3057\u305f\u3002\n\u3053\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u3067\u306f\u3001`export default`\u6587\u306e\u307f\u3092\u4f7f\u7528\u3057\u305f\u5834\u5408\u306b\u3060\u3051\u3001`module.exports`\u6587\u3092\u8ffd\u52a0\u3057\u307e\u3059\u3002\n\n```js:index.js\nexport default 'foo'\n```\n\n\u4e0a\u8a18\u306f`module.exports`\u6587\u3092**\u8ffd\u52a0\u3057\u307e\u3059**\u3002\n\n```\nbabel index.js --presets es2015 --plugins add-module-exports \n# 'use strict';\n#\n# Object.defineProperty(exports, \"__esModule\", {\n#   value: true\n# });\n# exports.default = 'foo';\n# module.exports = exports['default'];\n```\n\n\u4e0b\u8a18\u306f**\u8ffd\u52a0\u3057\u307e\u305b\u3093**\u3002\n\n```js:index.js\nlet foo= 'bar'\nexport default 'baz'\nexport {foo}\n```\n\n```bash\nbabel index.js --presets es2015 --plugins add-module-exports \n# 'use strict';\n#\n# Object.defineProperty(exports, \"__esModule\", {\n#   value: true\n# });\n# var foo = 'bar';\n# exports.default = 'baz';\n# exports.foo = foo;\n```\n\n## `0.0.*`\u7cfb\n\n\u5e38\u306b`module.exports`\u6587\u3092\u767a\u884c\u3057\u307e\u3059\u3002`Object.assign`\u3067\u30de\u30fc\u30b8\u3059\u308b\u305f\u3081\u3001**\u52d5\u4f5c\u306f\u7834\u58ca\u7684\u3067\u3059**\u3002\n\n```js:index.js\nlet foo= 'bar'\nexport default 'baz'\nexport {foo}\n```\n\n\u4e0b\u8a18\u306e\u3088\u3046\u306b\u5909\u63db\u3055\u308c\u308b\u3067\u3057\u3087\u3046\u3002\n\n```bash\nbabel index.js --presets es2015 --plugins add-module-exports \n# 'use strict';\n#\n# Object.defineProperty(exports, \"__esModule\", {\n#   value: true\n# });\n# var foo = 'bar';\n# exports.default = 'baz';\n# exports.foo = foo;\n# module.exports = Object.assign(exports.default || {}, exports);\n```\n\nObject.assign\u3092\u4f7f\u7528\u3057\u305f\u304f\u306a\u3044\u5834\u5408\u306f\u3001[polyfill\u306b\u7f6e\u63db\u3067\u304d\u308b\u30d7\u30e9\u30b0\u30a4\u30f3](https://github.com/babel/babel/tree/development/packages/babel-plugin-transform-object-assign)\u304c\u7528\u610f\u3055\u308c\u3066\u3044\u308b\u306e\u3067\u3001\u3053\u308c\u3092\u5229\u7528\u3057\u3066\u4e0b\u3055\u3044\u3002\n\n\u53c2\u8003\n---\n* [babel6\u3067\u306e\u5909\u66f4\u70b9\u3000Gulp\u30fbWebpack\u306e\u8a2d\u5b9a by kamijin_fanta(Qiita)](http://qiita.com/kamijin_fanta/items/e8e5fc750b563152bbcf)\n* [.babelrc / package.json](https://babeljs.io/docs/usage/babelrc/)\n\n\u3088\u3082\u3084\u307e\u8a71\n---\n\nbabel@6\u304b\u3089\u30d7\u30e9\u30b0\u30a4\u30f3\u306e\u4f5c\u6210\u65b9\u6cd5\u3082\u5909\u308f\u3063\u305f\u3089\u3057\u304f\u3001\u30cf\u30ed\u30fc\u30ef\u30fc\u30eb\u30c9\u7684\u306a\u8a18\u4e8b\u3092\u63a2\u3057\u3066\u3082\u3001[5\u7cfb\u306e\u3082\u306e\u304c\u307b\u3068\u3093\u3069](https://github.com/RReverser/babel-plugin-hello-world)\u3067\u3057\u305f\u3002\u305d\u306e\u4e2d\u3001\u983c\u308a\u306b\u306a\u308b\u306e\u306f[\u516c\u5f0f\u306e\u4f3c\u305f\u76ee\u7684\u3092\u6301\u3064\u30d7\u30e9\u30b0\u30a4\u30f3\u306e\u5b9f\u88c5](https://github.com/babel/babel/tree/v6.1.3/packages/babel-plugin-transform-es2015-modules-commonjs)\u3068[\u65e5\u672c\u8a9e\u306e5\u7cfb\u306e\u89e3\u8aac\u8a18\u4e8b](http://qiita.com/shuhei/items/96a852f7e0995fd42981)\u3067\u3057\u305f\u3002\n\n\u4f8b\u3048\u3070\u62d9\u4f5c\u306e\u30d7\u30e9\u30b0\u30a4\u30f3\u3067\u306f\u3001[babel-template](https://www.npmjs.com/package/babel-template)\u3068\u3044\u3046sebmck\u88fd\u30e2\u30b8\u30e5\u30fc\u30eb\u306b\u4f9d\u5b58\u3057\u3066\u3044\u307e\u3059\u304c\u3001\u3053\u308c\u306f\u6587\u5b57\u5217\u304b\u3089AST\u306e\u751f\u6210\u95a2\u6570\u3092\u8fd4\u3059\u30d5\u30a1\u30af\u30c8\u30ea\u95a2\u6570\u3067\u3059\u3002\n\n```js\nvar babelTemplate= require('babel-template')\nbabelTemplate('var hoge=\"fuga\"')()\n// { type: 'VariableDeclaration',\n//   start: undefined,\n//   end: undefined,\n//   loc: undefined,\n//   declarations: \n//    [ { type: 'VariableDeclarator',\n//        start: undefined,\n//        end: undefined,\n//        loc: undefined,\n//        id: [Object],\n//        init: [Object],\n//        _fromTemplate: true } ],\n//   kind: 'var',\n//   _fromTemplate: true }\n```\n\n\u30d7\u30e9\u30b0\u30a4\u30f3\u306e\u30a8\u30f3\u30c8\u30ea\u30dd\u30a4\u30f3\u30c8\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u8fd4\u3059\u306e\u304c\u6c7a\u307e\u308a\u3067\u3059\u304c\u3001visitor\u5185\u306e\u30c8\u30e9\u30f3\u30b9\u30d5\u30a9\u30fc\u30e0\u95a2\u6570\u306e\u7b2c\u4e00\u5f15\u6570`path`\u304cAST\u6539\u5909\u7528\u306e\u30e1\u30bd\u30c3\u30c9\u7fa4\u3092\u6301\u3064\u306e\u3067\u3001\u3053\u308c\u306e`.pushContainer('body')`\u306bAST\u306e\u914d\u5217\u3092\u6e21\u3059\u3068\u3001\u30aa\u30ec\u30aa\u30ec\u30b3\u30fc\u30c9\u3092\u8ffd\u52a0\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3057\u305f\u3002\n\n```js:babel-plugin-add-module-exports/lib/index.js\n// Dependencies\nvar babelTemplate= require('babel-template')\n\n// Public\nmodule.exports= function(){\n  return {\n    visitor: {\n      Program: {\n        exit: function(path){\n          var topNodes= []\n\n          var code= 'module.exports=Object.assign(exports.default||{},exports);'\n          var node= babelTemplate(code)()\n          topNodes.push(node)\n\n          path.pushContainer('body',topNodes)// \u30d7\u30ed\u30b0\u30e9\u30e0\u672b\u5c3e\u306b`module.exports = Object.assign(exports.default || {}, exports);`\u3092\u8ffd\u52a0\u3059\u308b\n        },\n      },\n    },\n  }\n}\n```\n", "tags": ["JavaScript", "babel", "Node.js", "npm"]}