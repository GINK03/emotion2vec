{"context": " More than 1 year has passed since last update.\u30d5\u30a1\u30a4\u30eb\u306e\u4e16\u4ee3\u7ba1\u7406\u304c\u8f9b\u3044\u3068\u304d\u306b\u4f7f\u3046\u3084\u3064\n@echo off\n\n:: file_path \u3092 backup_dir \u306b\u30b3\u30d4\u30fc\u3059\u308b\u3002\n:: \u30b3\u30d4\u30fc\u3059\u308b\u969b\u306b\u30d5\u30a1\u30a4\u30eb\u540d\u306b\u65e5\u4ed8\u3092\u4ed8\u4e0e\u3059\u308b(C:\\backup_dir\\fileName_yyyymmdd.ext)\u3002\n:: \u65e2\u306b\u540c\u540d\u306e\u30d5\u30a1\u30a4\u30eb\u304c\u5b58\u5728\u3059\u308b\u5834\u5408\u306f\u3001\u66f4\u306b\u9023\u756a\u3092\u4ed8\u3051\u308b(C:\\backup_dir\\fileName_yyyymmdd_n.ext)\u3002\n\n:: \u30e6\u30fc\u30b6\u5b9a\u7fa9\u5909\u6570\nset file_path=hogehoge.ext\nset backup_dir=C:\\example\\fugafuga\n\n:: \u30e6\u30fc\u30b6\u5b9a\u7fa9\u5909\u6570\u306e\u30a8\u30e9\u30fc\u30c1\u30a7\u30c3\u30af\nif not exist %file_path% (\n    call :GET_FULLPATH %file_path%\n    set file_path=%RETURN%\n    echo \u30d0\u30c3\u30af\u30a2\u30c3\u30d7\u5bfe\u8c61\u306e\u30d5\u30a1\u30a4\u30eb\u304c\u5b58\u5728\u3057\u307e\u305b\u3093\u3002 %file_path%\n    echo \u51e6\u7406\u3092\u7d42\u4e86\u3057\u307e\u3059\u3002\n    echo;\n    pause\n    exit /b\n)\n\nif not exist %backup_dir% (\n    call :GET_FULLPATH %backup_dir%\n    set backup_dir=%RETURN%\n    echo \u30d0\u30c3\u30af\u30a2\u30c3\u30d7\u5148\u304c\u5b58\u5728\u3057\u307e\u305b\u3093\u3002\u65b0\u3057\u304f\u4f5c\u6210\u3057\u307e\u3059\u3002\n    echo mkdir %backup_dir%\n    mkdir %backup_dir%\n    echo;\n)\nif %errorlevel% neq 0 (\n    echo \u30d0\u30c3\u30af\u30a2\u30c3\u30d7\u5148\u306e\u4f5c\u6210\u306b\u5931\u6557\u3057\u307e\u3057\u305f\u3002\n    echo \u51e6\u7406\u3092\u7d42\u4e86\u3057\u307e\u3059\u3002\n    echo;\n    pause\n    exit /b\n)\n\n:: \u5909\u6570\u306e\u521d\u671f\u5316\ncall :GET_YYYYMMDD\nset yyyymmdd=%RETURN%\n\ncall :GET_BASENAME %file_path%\nset baseName=%RETURN%\n\ncall :GET_EXTENSION %file_path%\nset extension=%RETURN%\n\ncall :BUILD_PATH %backup_dir% %baseName%_%yyyymmdd%.%extension%\nset backup_path=%RETURN%\n\nset /a suffix=0\n:LOOP\n    if not exist %backup_path% goto :BREAK\n    set /a suffix=suffix+1\n    call :BUILD_PATH %backup_dir% %baseName%_%yyyymmdd%_%suffix%.%extension%\n    set backup_path=%RETURN%\n    goto :LOOP\n:BREAK\n\n:: \u30d0\u30c3\u30af\u30a2\u30c3\u30d7\u306e\u5b9f\u884c\ncopy %file_path% %backup_path% > nul\n\n:: \u5b9f\u884c\u7d50\u679c\u306e\u78ba\u8a8d\nif %errorlevel% neq 0 (\n    echo \u30d5\u30a1\u30a4\u30eb\u30b3\u30d4\u30fc\u306b\u5931\u6557\u3057\u307e\u3057\u305f\u3002\n    echo \u51e6\u7406\u3092\u7d42\u4e86\u3057\u307e\u3059\u3002\n    echo;\n    pause\n    exit /b\n)\n\n:: \u5b9f\u884c\u7d50\u679c\u306e\u51fa\u529b\ncall :GET_FULLPATH %file_path%\nset file_path=%RETURN%\n\ncall :GET_FULLPATH %backup_path%\nset backup_path=%RETURN%\n\necho \u30d5\u30a1\u30a4\u30eb\u3092\u30b3\u30d4\u30fc\u3057\u307e\u3057\u305f\u3002\necho From:  %file_path%\necho To  :  %backup_path%\necho;\npause\nexit /b\n\n\n:: \u30b5\u30d6\u30eb\u30fc\u30c1\u30f3\u306e\u5b9a\u7fa9\n\n:: \u30b7\u30b9\u30c6\u30e0\u306e\u65e5\u4ed8\u3092 YYYYMMDD \u5f62\u5f0f\u3067\u53d6\u5f97\u3059\u308b\n:GET_YYYYMMDD\nset RETURN=%date:/=%\nexit /b\n\n:: \u30d1\u30b9\u306e\u30d5\u30eb\u30d1\u30b9\u3092\u53d6\u5f97\u3059\u308b\u3002\n:: \u7b2c\u4e00\u5f15\u6570\u3068\u3057\u3066\u30d5\u30a1\u30a4\u30eb\u30d1\u30b9\u3092\u53d7\u3051\u53d6\u308b\u3002\n:GET_FULLPATH\nset RETURN=%~dpnx1\nexit /b\n\n:: \u30d5\u30a1\u30a4\u30eb\u30d1\u30b9\u304b\u3089\u30d5\u30a1\u30a4\u30eb\u540d\u3068\u62e1\u5f35\u5b50\u3092\u53d6\u308a\u51fa\u3059\u3002\n:: \u7b2c\u4e00\u5f15\u6570\u3068\u3057\u3066\u30d5\u30a1\u30a4\u30eb\u30d1\u30b9\u3092\u53d7\u3051\u53d6\u308b\u3002\n:GET_FILENAME\nset RETURN=%~nx1\nexit /b\n\n:: \u30d5\u30a1\u30a4\u30eb\u30d1\u30b9\u304b\u3089\u62e1\u5f35\u5b50\u3092\u53d6\u308a\u51fa\u3059\u3002\n:: \u7b2c\u4e00\u5f15\u6570\u3068\u3057\u3066\u30d5\u30a1\u30a4\u30eb\u30d1\u30b9\u3092\u53d7\u3051\u53d6\u308b\u3002\n:GET_EXTENSION\nset RETURN=%~x1%\nset RETURN=%RETURN:~1%\nexit /b\n\n:: \u30d5\u30a1\u30a4\u30eb\u30d1\u30b9\u304b\u3089\u30d5\u30a1\u30a4\u30eb\u540d(\u62e1\u5f35\u5b50\u9664\u304f)\u3092\u53d6\u308a\u51fa\u3059\u3002\n:: \u7b2c\u4e00\u5f15\u6570\u3068\u3057\u3066\u30d5\u30a1\u30a4\u30eb\u30d1\u30b9\u3092\u53d7\u3051\u53d6\u308b\u3002\n:GET_BASENAME\nset RETURN=%~n1\nexit /b\n\n:: \u30d5\u30a1\u30a4\u30eb\u30d1\u30b9\u304b\u3089\u89aa\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306e\u30d1\u30b9\u3092\u8fd4\u3059\u3002\u672b\u5c3e\u306e \\ \u306f\u4ed8\u3044\u305f\u307e\u307e\u3002\n:: \u7b2c\u4e00\u5f15\u6570\u3068\u3057\u3066\u30d5\u30a1\u30a4\u30eb\u30d1\u30b9\u3092\u53d7\u3051\u53d6\u308b\u3002\n:GET_PARENT_DIR\nset RETURN=%~dp1\nexit /b\n\n:: \u672b\u5c3e\u306e \\ \u306e\u6709\u7121\u306b\u95a2\u308f\u3089\u305a\u6587\u5b57\u5217\u3092\u9023\u7d50\u3057\u3066Windows\u30d1\u30b9\u3092\u4f5c\u308b\u3002\n:: \u7b2c\u4e00\u5f15\u6570\u3068\u3057\u3066\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u30d1\u30b9\u3092\u53d7\u3051\u53d6\u308b\u3002\n:: \u7b2c\u4e8c\u5f15\u6570\u3068\u3057\u3066\u30d5\u30a1\u30a4\u30eb\u540d\u3092\u53d7\u3051\u53d6\u308b\u3002\n:BUILD_PATH\nsetlocal\nset parent=%1\nset child=%2\nset tail=%parent:~-1,1%\n\nif %tail% EQU \\ (\n    set RETURN=%parent%%child%\n) else (\n    set RETURN=%parent%\\%child%\n)\nendlocal && set RETURN=%RETURN%\nexit /b\n\n\n\u30d5\u30a1\u30a4\u30eb\u306e\u4e16\u4ee3\u7ba1\u7406\u304c\u8f9b\u3044\u3068\u304d\u306b\u4f7f\u3046\u3084\u3064\n\n```bat\n@echo off\n\n:: file_path \u3092 backup_dir \u306b\u30b3\u30d4\u30fc\u3059\u308b\u3002\n:: \u30b3\u30d4\u30fc\u3059\u308b\u969b\u306b\u30d5\u30a1\u30a4\u30eb\u540d\u306b\u65e5\u4ed8\u3092\u4ed8\u4e0e\u3059\u308b(C:\\backup_dir\\fileName_yyyymmdd.ext)\u3002\n:: \u65e2\u306b\u540c\u540d\u306e\u30d5\u30a1\u30a4\u30eb\u304c\u5b58\u5728\u3059\u308b\u5834\u5408\u306f\u3001\u66f4\u306b\u9023\u756a\u3092\u4ed8\u3051\u308b(C:\\backup_dir\\fileName_yyyymmdd_n.ext)\u3002\n\n:: \u30e6\u30fc\u30b6\u5b9a\u7fa9\u5909\u6570\nset file_path=hogehoge.ext\nset backup_dir=C:\\example\\fugafuga\n\n:: \u30e6\u30fc\u30b6\u5b9a\u7fa9\u5909\u6570\u306e\u30a8\u30e9\u30fc\u30c1\u30a7\u30c3\u30af\nif not exist %file_path% (\n    call :GET_FULLPATH %file_path%\n    set file_path=%RETURN%\n    echo \u30d0\u30c3\u30af\u30a2\u30c3\u30d7\u5bfe\u8c61\u306e\u30d5\u30a1\u30a4\u30eb\u304c\u5b58\u5728\u3057\u307e\u305b\u3093\u3002 %file_path%\n    echo \u51e6\u7406\u3092\u7d42\u4e86\u3057\u307e\u3059\u3002\n    echo;\n    pause\n    exit /b\n)\n\nif not exist %backup_dir% (\n    call :GET_FULLPATH %backup_dir%\n    set backup_dir=%RETURN%\n    echo \u30d0\u30c3\u30af\u30a2\u30c3\u30d7\u5148\u304c\u5b58\u5728\u3057\u307e\u305b\u3093\u3002\u65b0\u3057\u304f\u4f5c\u6210\u3057\u307e\u3059\u3002\n    echo mkdir %backup_dir%\n    mkdir %backup_dir%\n    echo;\n)\nif %errorlevel% neq 0 (\n    echo \u30d0\u30c3\u30af\u30a2\u30c3\u30d7\u5148\u306e\u4f5c\u6210\u306b\u5931\u6557\u3057\u307e\u3057\u305f\u3002\n    echo \u51e6\u7406\u3092\u7d42\u4e86\u3057\u307e\u3059\u3002\n    echo;\n    pause\n    exit /b\n)\n\n:: \u5909\u6570\u306e\u521d\u671f\u5316\ncall :GET_YYYYMMDD\nset yyyymmdd=%RETURN%\n\ncall :GET_BASENAME %file_path%\nset baseName=%RETURN%\n\ncall :GET_EXTENSION %file_path%\nset extension=%RETURN%\n\ncall :BUILD_PATH %backup_dir% %baseName%_%yyyymmdd%.%extension%\nset backup_path=%RETURN%\n\nset /a suffix=0\n:LOOP\n    if not exist %backup_path% goto :BREAK\n    set /a suffix=suffix+1\n    call :BUILD_PATH %backup_dir% %baseName%_%yyyymmdd%_%suffix%.%extension%\n    set backup_path=%RETURN%\n    goto :LOOP\n:BREAK\n\n:: \u30d0\u30c3\u30af\u30a2\u30c3\u30d7\u306e\u5b9f\u884c\ncopy %file_path% %backup_path% > nul\n\n:: \u5b9f\u884c\u7d50\u679c\u306e\u78ba\u8a8d\nif %errorlevel% neq 0 (\n    echo \u30d5\u30a1\u30a4\u30eb\u30b3\u30d4\u30fc\u306b\u5931\u6557\u3057\u307e\u3057\u305f\u3002\n    echo \u51e6\u7406\u3092\u7d42\u4e86\u3057\u307e\u3059\u3002\n    echo;\n    pause\n    exit /b\n)\n\n:: \u5b9f\u884c\u7d50\u679c\u306e\u51fa\u529b\ncall :GET_FULLPATH %file_path%\nset file_path=%RETURN%\n\ncall :GET_FULLPATH %backup_path%\nset backup_path=%RETURN%\n\necho \u30d5\u30a1\u30a4\u30eb\u3092\u30b3\u30d4\u30fc\u3057\u307e\u3057\u305f\u3002\necho From:\t%file_path%\necho To  :\t%backup_path%\necho;\npause\nexit /b\n\n\n:: \u30b5\u30d6\u30eb\u30fc\u30c1\u30f3\u306e\u5b9a\u7fa9\n\n:: \u30b7\u30b9\u30c6\u30e0\u306e\u65e5\u4ed8\u3092 YYYYMMDD \u5f62\u5f0f\u3067\u53d6\u5f97\u3059\u308b\n:GET_YYYYMMDD\nset RETURN=%date:/=%\nexit /b\n\n:: \u30d1\u30b9\u306e\u30d5\u30eb\u30d1\u30b9\u3092\u53d6\u5f97\u3059\u308b\u3002\n:: \u7b2c\u4e00\u5f15\u6570\u3068\u3057\u3066\u30d5\u30a1\u30a4\u30eb\u30d1\u30b9\u3092\u53d7\u3051\u53d6\u308b\u3002\n:GET_FULLPATH\nset RETURN=%~dpnx1\nexit /b\n\n:: \u30d5\u30a1\u30a4\u30eb\u30d1\u30b9\u304b\u3089\u30d5\u30a1\u30a4\u30eb\u540d\u3068\u62e1\u5f35\u5b50\u3092\u53d6\u308a\u51fa\u3059\u3002\n:: \u7b2c\u4e00\u5f15\u6570\u3068\u3057\u3066\u30d5\u30a1\u30a4\u30eb\u30d1\u30b9\u3092\u53d7\u3051\u53d6\u308b\u3002\n:GET_FILENAME\nset RETURN=%~nx1\nexit /b\n\n:: \u30d5\u30a1\u30a4\u30eb\u30d1\u30b9\u304b\u3089\u62e1\u5f35\u5b50\u3092\u53d6\u308a\u51fa\u3059\u3002\n:: \u7b2c\u4e00\u5f15\u6570\u3068\u3057\u3066\u30d5\u30a1\u30a4\u30eb\u30d1\u30b9\u3092\u53d7\u3051\u53d6\u308b\u3002\n:GET_EXTENSION\nset RETURN=%~x1%\nset RETURN=%RETURN:~1%\nexit /b\n\n:: \u30d5\u30a1\u30a4\u30eb\u30d1\u30b9\u304b\u3089\u30d5\u30a1\u30a4\u30eb\u540d(\u62e1\u5f35\u5b50\u9664\u304f)\u3092\u53d6\u308a\u51fa\u3059\u3002\n:: \u7b2c\u4e00\u5f15\u6570\u3068\u3057\u3066\u30d5\u30a1\u30a4\u30eb\u30d1\u30b9\u3092\u53d7\u3051\u53d6\u308b\u3002\n:GET_BASENAME\nset RETURN=%~n1\nexit /b\n\n:: \u30d5\u30a1\u30a4\u30eb\u30d1\u30b9\u304b\u3089\u89aa\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306e\u30d1\u30b9\u3092\u8fd4\u3059\u3002\u672b\u5c3e\u306e \\ \u306f\u4ed8\u3044\u305f\u307e\u307e\u3002\n:: \u7b2c\u4e00\u5f15\u6570\u3068\u3057\u3066\u30d5\u30a1\u30a4\u30eb\u30d1\u30b9\u3092\u53d7\u3051\u53d6\u308b\u3002\n:GET_PARENT_DIR\nset RETURN=%~dp1\nexit /b\n\n:: \u672b\u5c3e\u306e \\ \u306e\u6709\u7121\u306b\u95a2\u308f\u3089\u305a\u6587\u5b57\u5217\u3092\u9023\u7d50\u3057\u3066Windows\u30d1\u30b9\u3092\u4f5c\u308b\u3002\n:: \u7b2c\u4e00\u5f15\u6570\u3068\u3057\u3066\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u30d1\u30b9\u3092\u53d7\u3051\u53d6\u308b\u3002\n:: \u7b2c\u4e8c\u5f15\u6570\u3068\u3057\u3066\u30d5\u30a1\u30a4\u30eb\u540d\u3092\u53d7\u3051\u53d6\u308b\u3002\n:BUILD_PATH\nsetlocal\nset parent=%1\nset child=%2\nset tail=%parent:~-1,1%\n\nif %tail% EQU \\ (\n    set RETURN=%parent%%child%\n) else (\n    set RETURN=%parent%\\%child%\n)\nendlocal && set RETURN=%RETURN%\nexit /b\n\n```\n", "tags": ["bat", "Windows"]}