{"context": " More than 1 year has passed since last update.\n\n\u524d\u63d0\n\n\u6bce\u9031\u306e\u30b4\u30df\u6368\u3066\u62c5\u5f53\u3092\u30e9\u30f3\u30c0\u30e0\u3067\u53ef\u611b\u304f\u81ea\u52d5\u901a\u77e5\u3057\u3066\u304f\u308c\u308bBOT\u304c\u307b\u3057\u3044\uff01\nGAS x Slack\u3067\u304b\u3093\u305f\u3093\u5b9f\u88c5\n\u3044\u3064\u3082\u306a\u304c\u3089SlackApp\u795e\n\n\n\u4eca\u56de\u306e\u30a2\u30a6\u30c8\u30d7\u30c3\u30c8\n\n\u6bce\u9031\u6c7a\u307e\u3063\u305f\u65e5\u4ed8\u30fb\u6642\u9593\u5e2f\u306b\u3001\n\u4e0b\u8a18\u306e\u3088\u3046\u306aGoogleSpreadSheet\u304b\u3089Name\u3068Face\u3092random\u3067\u62bd\u51fa\u3057\u3001\n\n\nSlack\u3078\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u901a\u77e5\u3092\u9001\u308b\n\n\n\n\n\u4e8b\u524d\u6e96\u5099\n\n\u3053\u3093\u306a\u30b7\u30fc\u30c8\u3092\u4f5c\u3063\u3066\u304a\u304f\n\n\n\n\nGAS\u30b3\u30fc\u30c9\n\n\u5168\u8c8c\n\nGoogleAppsScript\n// \u5b9a\u7fa9\u6587\nvar slack = {\n  postUrl: 'https://slack.com/api/chat.postMessage',\n  token: '(A)', // Slack\u306etoken\n  ChannelId: \"(B)\", // Slack\u306e\u6295\u7a3f\u3059\u308bCHannelID\n  userName: \"\u4eca\u9031\u306e\u30b4\u30df\u6368\u3066\u5f53\u756a\u3060\u30c9\u30f3\uff01\", // bot\u306e\u540d\u524d\n}\n\n//\u30b7\u30fc\u30c8\u306e\u5024\u3092\u5148\u306b\u304c\u3055\u3063\u3068\u5168\u53d6\u5f97\u3059\u308b\nvar sheet = SpreadsheetApp.getActiveSpreadsheet().getActiveSheet()\nvar lastrow = sheet.getLastRow();\nvar lastcol = sheet.getLastColumn();\nvar sheetdata = sheet.getSheetValues(1, 1, lastrow, lastcol);//\u304c\u3055\u3063\u3068\u53d6\u5f97\n\n//Name\u3068Face\u3092\u30e9\u30f3\u30c0\u30e0\u3067\u53d6\u5f97\u3057\u3066\u3001Slack\u3078\u9001\u308b\nfunction OSOJIKUN() {\n  var row = Math.floor(Math.random() * 5) + 2;\n  Logger.log(row);\n  var Name = sheetdata[row][0];  \n  var row2 = Math.floor(Math.random() * 5) + 2;//Name\u306erow\u3092Random\u3067\u53d6\u5f97\n  var Face = sheetdata[row2][1];\n  var slackApp = SlackApp.create(slack[\"token\"]);//Face\u306erow\u3092Random\u3067\u53d6\u5f97\n  var Message = slackApp.postMessage(slack[\"ChannelId\"], \"```\" + \"\u4eca\u9031\u306e\u30b4\u30df\u6368\u3066\u5f53\u756a\u306f\u2026\" + Name + \"\uff01\u983c\u3093\u3060\u30c9\u30f3\uff01\" + Face + \"```\", {username : slack[\"userName\"]});\n  Logger.log(Message);\n}\n\n\n\n\n\u8981\u7d20\u89e3\u8aac\n\n\u5b9a\u7fa9\u6587\n\n\n\u3053\u3061\u3089\u306e\u8a18\u4e8b\u306a\u3069\u3068\u307b\u307c\u540c\u3058\u306a\u306e\u3067\u5272\u611b\u3057\u307e\u3059\u3002SlackApp\u306e\u4f7f\u3044\u65b9\u306f\u4e00\u5ea6\u899a\u3048\u308b\u3068\u975e\u5e38\u306b\u6c4e\u7528\u6027\u304c\u9ad8\u3044\u306e\u3067\u30aa\u30b9\u30b9\u30e1\u3067\u3059\u3002\n\n\n\u30b7\u30fc\u30c8\u306e\u5024\u3092\u5148\u306b\u304c\u3055\u3063\u3068\u5168\u53d6\u5f97\u3059\u308b\n\nGoogleAppsScript\n//\u30b7\u30fc\u30c8\u306e\u5024\u3092\u5148\u306b\u304c\u3055\u3063\u3068\u5168\u53d6\u5f97\u3059\u308b\nvar sheet = SpreadsheetApp.getActiveSpreadsheet().getActiveSheet()\nvar lastrow = sheet.getLastRow();\nvar lastcol = sheet.getLastColumn();\nvar sheetdata = sheet.getSheetValues(1, 1, lastrow, lastcol);//\u304c\u3055\u3063\u3068\u53d6\u5f97\n\n\n\ngetSheetValues\u3092\u4f7f\u7528\u3057\u3001\u307e\u305a\u306f\u30b7\u30fc\u30c8\u5168\u4f53\u306e\u5024\u3092\u5168\u3066\u53d6\u5f97\u3057\u3066\u3057\u307e\u3044\u307e\u3059\u3002\u3053\u306e\u5229\u70b9\u306f2\u3064\u3002\n\n\n\u3044\u3061\u3044\u3061getRange\u3067\u30bb\u30eb\u6307\u5b9a\u3057\u3066 \u3001getValue\u3067\u53d6\u5f97\u3057\u3066\u2026\u3068\u3044\u3046\u51e6\u7406\u3092\u884c\u3046\u3068\u3001\u90fd\u5ea6API\u306b\u8ca0\u8377\u304c\u304b\u304b\u308a\u51e6\u7406\u304c\u91cd\u304f\u306a\u308b\u3002\u305d\u308c\u3092\u907f\u3051\u308b\u4e8b\u304c\u3067\u304d\u308b\u3002\n\u8981\u7d20\u3092\u5897\u6e1b\u3057\u305f\u5834\u5408\u3067\u3082\u3001\u9078\u629e\u7bc4\u56f2\u3092\u5909\u66f4\u3059\u308b\u5fc5\u8981\u304c\u306a\u3044\uff08\u3053\u308c\u306fgetlastRow\u3084getLastColumn\u3067\u7bc4\u56f2\u6307\u5b9a\u3057\u3066\u3044\u308b\u304b\u3089\u3067\u3059\u306d\uff09\n\n\n\n\nName\u3068Face\u3092\u30e9\u30f3\u30c0\u30e0\u3067\u53d6\u5f97\u3057\u3066\u3001Slack\u3078\u9001\u308b\n\nGoogleAppsScript\n//Name\u3068Face\u3092\u30e9\u30f3\u30c0\u30e0\u3067\u53d6\u5f97\u3057\u3066\u3001Slack\u3078\u9001\u308b\nfunction OSOJIKUN() {\n  var row = Math.floor(Math.random() * 5) + 2;\n  Logger.log(row);\n  var Name = sheetdata[row][0];  \n  var row2 = Math.floor(Math.random() * 5) + 2;//Name\u306erow\u3092Random\u3067\u53d6\u5f97\n  var Face = sheetdata[row2][1];\n  var slackApp = SlackApp.create(slack[\"token\"]);//Face\u306erow\u3092Random\u3067\u53d6\u5f97\n  var Message = slackApp.postMessage(slack[\"ChannelId\"], \"```\" + \"\u4eca\u9031\u306e\u30b4\u30df\u6368\u3066\u5f53\u756a\u306f\u2026\" + Name + \"\uff01\u983c\u3093\u3060\u30c9\u30f3\uff01\" + Face + \"```\", {username : slack[\"userName\"]});\n  Logger.log(Message);\n}\n\n\n\n\nrow\u3092\u30e9\u30f3\u30c0\u30e0\u3067\u53d6\u5f97\u3059\u308b\u969b\u306bMath.random\u30e1\u30bd\u30c3\u30c9\u3092\u4f7f\u3044\u307e\u3059\u3002*x\u3092\u8a18\u8f09\u3057\u305f\u5834\u5408\u30010~x\u307e\u3067\u306e\u6574\u6570\u3092\u53d6\u5f97\u3057\u3066\u304f\u308c\u307e\u3059\u3002\n\u4eca\u56de\u306frow = 2 ~ 7\u306e\u7bc4\u56f2\u3067\u53d6\u5f97\u3057\u305f\u304b\u3063\u305f\u305f\u3081\u3001\u4e0a\u8a18\u306e\u3088\u3046\u306a\u8a18\u8f09\u3068\u306a\u3063\u3066\u3044\u307e\u3059\u304c\u3001\u3088\u308a\u52d5\u7684\u306a\u8a18\u8ff0\u306b\u5909\u66f4\u53ef\u80fd\u3067\u3059\u306d\u3002\n\n\n\u30c8\u30ea\u30ac\u30fc\n\n\u5f8c\u306f\u4e0a\u8a18\u306escript\u3092\u8d70\u3089\u305b\u305f\u3044\u5468\u671f\u3067\u30c8\u30ea\u30ac\u30fc\u3092\u8a2d\u5b9a\u3057\u307e\u3057\u3087\u3046\u3002\u30bf\u30a4\u30c8\u30eb\u306b\u6bce\u9031\u3068\u66f8\u304d\u307e\u3057\u305f\u304c\u3001\u3046\u3061\u3067\u306f\u6bce\u9031\u6708\u3001\u6728\u306e\u671d9:00~10:00\u306e\u6642\u9593\u5e2f\u306b\u8d70\u3089\u305b\u3066\u3044\u307e\u3059\u3002\n\n\n\n\n\u30b3\u30e1\u30f3\u30c8\n\n\u30aa\u30d5\u30a3\u30b9\u5185\u3067\u306e\u5b9a\u671f\u7684\u306a\u9023\u7d61\u696d\u52d9\u306a\u3069\u306f\u81ea\u793e\u3067\u3069\u3093\u3069\u3093Slack x GAS\u3067\u81ea\u52d5\u51e6\u7406\u3057\u3066\u3044\u307e\u3059\u3002\n\u3053\u306eTips\u81ea\u4f53\u3088\u308a\u306f\u3053\u3046\u3044\u3063\u305f\u7d44\u7e54\u904b\u55b6\u306e\u5c0f\u3055\u306a\u3068\u3053\u308d\u3078\u3082\u4f7f\u3048\u308b\u6280\u8853\u3092\u9069\u7528\u3057\u3066\u3044\u304f\u7d44\u7e54\u6587\u5316\u3092\u5927\u4e8b\u306b\u3057\u3066\u3044\u304d\u305f\u3044\u306a\u3068\u601d\u3046\u6b21\u7b2c\u3002\n\n# \u524d\u63d0\n\n- \u6bce\u9031\u306e\u30b4\u30df\u6368\u3066\u62c5\u5f53\u3092\u30e9\u30f3\u30c0\u30e0\u3067\u53ef\u611b\u304f\u81ea\u52d5\u901a\u77e5\u3057\u3066\u304f\u308c\u308bBOT\u304c\u307b\u3057\u3044\uff01\n- GAS x Slack\u3067\u304b\u3093\u305f\u3093\u5b9f\u88c5\n- \u3044\u3064\u3082\u306a\u304c\u3089SlackApp\u795e\n\n# \u4eca\u56de\u306e\u30a2\u30a6\u30c8\u30d7\u30c3\u30c8\n\n- \u6bce\u9031\u6c7a\u307e\u3063\u305f\u65e5\u4ed8\u30fb\u6642\u9593\u5e2f\u306b\u3001\n- \u4e0b\u8a18\u306e\u3088\u3046\u306aGoogleSpreadSheet\u304b\u3089Name\u3068Face\u3092random\u3067\u62bd\u51fa\u3057\u3001\n![image](https://qiita-image-store.s3.amazonaws.com/0/83135/4b483000-bdb9-d672-b54d-759888b0ad58.png)\n- Slack\u3078\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u901a\u77e5\u3092\u9001\u308b\n![image](https://qiita-image-store.s3.amazonaws.com/0/83135/afb1c03b-8e28-3df4-bbcb-bcfbab1c4a80.png)\n\n# \u4e8b\u524d\u6e96\u5099\n\n- \u3053\u3093\u306a\u30b7\u30fc\u30c8\u3092\u4f5c\u3063\u3066\u304a\u304f\n![image](https://qiita-image-store.s3.amazonaws.com/0/83135/7520ce57-90b5-746c-5c6c-9b4d79b7560c.png)\n\n\n\n# GAS\u30b3\u30fc\u30c9\n\n## \u5168\u8c8c\n\n```js:GoogleAppsScript\n// \u5b9a\u7fa9\u6587\nvar slack = {\n  postUrl: 'https://slack.com/api/chat.postMessage',\n  token: '(A)', // Slack\u306etoken\n  ChannelId: \"(B)\", // Slack\u306e\u6295\u7a3f\u3059\u308bCHannelID\n  userName: \"\u4eca\u9031\u306e\u30b4\u30df\u6368\u3066\u5f53\u756a\u3060\u30c9\u30f3\uff01\", // bot\u306e\u540d\u524d\n}\n\n//\u30b7\u30fc\u30c8\u306e\u5024\u3092\u5148\u306b\u304c\u3055\u3063\u3068\u5168\u53d6\u5f97\u3059\u308b\nvar sheet = SpreadsheetApp.getActiveSpreadsheet().getActiveSheet()\nvar lastrow = sheet.getLastRow();\nvar lastcol = sheet.getLastColumn();\nvar sheetdata = sheet.getSheetValues(1, 1, lastrow, lastcol);//\u304c\u3055\u3063\u3068\u53d6\u5f97\n\n//Name\u3068Face\u3092\u30e9\u30f3\u30c0\u30e0\u3067\u53d6\u5f97\u3057\u3066\u3001Slack\u3078\u9001\u308b\nfunction OSOJIKUN() {\n  var row = Math.floor(Math.random() * 5) + 2;\n  Logger.log(row);\n  var Name = sheetdata[row][0];  \n  var row2 = Math.floor(Math.random() * 5) + 2;//Name\u306erow\u3092Random\u3067\u53d6\u5f97\n  var Face = sheetdata[row2][1];\n  var slackApp = SlackApp.create(slack[\"token\"]);//Face\u306erow\u3092Random\u3067\u53d6\u5f97\n  var Message = slackApp.postMessage(slack[\"ChannelId\"], \"```\" + \"\u4eca\u9031\u306e\u30b4\u30df\u6368\u3066\u5f53\u756a\u306f\u2026\" + Name + \"\uff01\u983c\u3093\u3060\u30c9\u30f3\uff01\" + Face + \"```\", {username : slack[\"userName\"]});\n  Logger.log(Message);\n}\n\n```\n\n## \u8981\u7d20\u89e3\u8aac\n\n### \u5b9a\u7fa9\u6587\n\n- [\u3053\u3061\u3089](http://qiita.com/Yamotti/items/bb2f002ba843386ce6f5)\u306e\u8a18\u4e8b\u306a\u3069\u3068\u307b\u307c\u540c\u3058\u306a\u306e\u3067\u5272\u611b\u3057\u307e\u3059\u3002SlackApp\u306e\u4f7f\u3044\u65b9\u306f\u4e00\u5ea6\u899a\u3048\u308b\u3068\u975e\u5e38\u306b\u6c4e\u7528\u6027\u304c\u9ad8\u3044\u306e\u3067\u30aa\u30b9\u30b9\u30e1\u3067\u3059\u3002\n\n### \u30b7\u30fc\u30c8\u306e\u5024\u3092\u5148\u306b\u304c\u3055\u3063\u3068\u5168\u53d6\u5f97\u3059\u308b\n\n```js:GoogleAppsScript\n//\u30b7\u30fc\u30c8\u306e\u5024\u3092\u5148\u306b\u304c\u3055\u3063\u3068\u5168\u53d6\u5f97\u3059\u308b\nvar sheet = SpreadsheetApp.getActiveSpreadsheet().getActiveSheet()\nvar lastrow = sheet.getLastRow();\nvar lastcol = sheet.getLastColumn();\nvar sheetdata = sheet.getSheetValues(1, 1, lastrow, lastcol);//\u304c\u3055\u3063\u3068\u53d6\u5f97\n```\n\n- getSheetValues\u3092\u4f7f\u7528\u3057\u3001\u307e\u305a\u306f\u30b7\u30fc\u30c8\u5168\u4f53\u306e\u5024\u3092\u5168\u3066\u53d6\u5f97\u3057\u3066\u3057\u307e\u3044\u307e\u3059\u3002\u3053\u306e\u5229\u70b9\u306f2\u3064\u3002\n  1. \u3044\u3061\u3044\u3061`getRange`\u3067\u30bb\u30eb\u6307\u5b9a\u3057\u3066 \u3001`getValue`\u3067\u53d6\u5f97\u3057\u3066\u2026\u3068\u3044\u3046\u51e6\u7406\u3092\u884c\u3046\u3068\u3001\u90fd\u5ea6API\u306b\u8ca0\u8377\u304c\u304b\u304b\u308a\u51e6\u7406\u304c\u91cd\u304f\u306a\u308b\u3002\u305d\u308c\u3092\u907f\u3051\u308b\u4e8b\u304c\u3067\u304d\u308b\u3002\n  2. \u8981\u7d20\u3092\u5897\u6e1b\u3057\u305f\u5834\u5408\u3067\u3082\u3001\u9078\u629e\u7bc4\u56f2\u3092\u5909\u66f4\u3059\u308b\u5fc5\u8981\u304c\u306a\u3044\uff08\u3053\u308c\u306f`getlastRow`\u3084`getLastColumn`\u3067\u7bc4\u56f2\u6307\u5b9a\u3057\u3066\u3044\u308b\u304b\u3089\u3067\u3059\u306d\uff09\n\n### Name\u3068Face\u3092\u30e9\u30f3\u30c0\u30e0\u3067\u53d6\u5f97\u3057\u3066\u3001Slack\u3078\u9001\u308b\n\n```js:GoogleAppsScript\n//Name\u3068Face\u3092\u30e9\u30f3\u30c0\u30e0\u3067\u53d6\u5f97\u3057\u3066\u3001Slack\u3078\u9001\u308b\nfunction OSOJIKUN() {\n  var row = Math.floor(Math.random() * 5) + 2;\n  Logger.log(row);\n  var Name = sheetdata[row][0];  \n  var row2 = Math.floor(Math.random() * 5) + 2;//Name\u306erow\u3092Random\u3067\u53d6\u5f97\n  var Face = sheetdata[row2][1];\n  var slackApp = SlackApp.create(slack[\"token\"]);//Face\u306erow\u3092Random\u3067\u53d6\u5f97\n  var Message = slackApp.postMessage(slack[\"ChannelId\"], \"```\" + \"\u4eca\u9031\u306e\u30b4\u30df\u6368\u3066\u5f53\u756a\u306f\u2026\" + Name + \"\uff01\u983c\u3093\u3060\u30c9\u30f3\uff01\" + Face + \"```\", {username : slack[\"userName\"]});\n  Logger.log(Message);\n}\n\n```\n\n- row\u3092\u30e9\u30f3\u30c0\u30e0\u3067\u53d6\u5f97\u3059\u308b\u969b\u306b`Math.random`\u30e1\u30bd\u30c3\u30c9\u3092\u4f7f\u3044\u307e\u3059\u3002`*x`\u3092\u8a18\u8f09\u3057\u305f\u5834\u5408\u30010~x\u307e\u3067\u306e\u6574\u6570\u3092\u53d6\u5f97\u3057\u3066\u304f\u308c\u307e\u3059\u3002\n- \u4eca\u56de\u306f`row = 2 ~ 7`\u306e\u7bc4\u56f2\u3067\u53d6\u5f97\u3057\u305f\u304b\u3063\u305f\u305f\u3081\u3001\u4e0a\u8a18\u306e\u3088\u3046\u306a\u8a18\u8f09\u3068\u306a\u3063\u3066\u3044\u307e\u3059\u304c\u3001\u3088\u308a\u52d5\u7684\u306a\u8a18\u8ff0\u306b\u5909\u66f4\u53ef\u80fd\u3067\u3059\u306d\u3002\n\n# \u30c8\u30ea\u30ac\u30fc\n\n- \u5f8c\u306f\u4e0a\u8a18\u306escript\u3092\u8d70\u3089\u305b\u305f\u3044\u5468\u671f\u3067\u30c8\u30ea\u30ac\u30fc\u3092\u8a2d\u5b9a\u3057\u307e\u3057\u3087\u3046\u3002\u30bf\u30a4\u30c8\u30eb\u306b\u6bce\u9031\u3068\u66f8\u304d\u307e\u3057\u305f\u304c\u3001\u3046\u3061\u3067\u306f\u6bce\u9031\u6708\u3001\u6728\u306e\u671d9:00~10:00\u306e\u6642\u9593\u5e2f\u306b\u8d70\u3089\u305b\u3066\u3044\u307e\u3059\u3002\n![image](https://qiita-image-store.s3.amazonaws.com/0/83135/899c5445-9445-d34c-7fd9-d13bb6a25da3.png)\n\n\n# \u30b3\u30e1\u30f3\u30c8\n\n- \u30aa\u30d5\u30a3\u30b9\u5185\u3067\u306e\u5b9a\u671f\u7684\u306a\u9023\u7d61\u696d\u52d9\u306a\u3069\u306f\u81ea\u793e\u3067\u3069\u3093\u3069\u3093Slack x GAS\u3067\u81ea\u52d5\u51e6\u7406\u3057\u3066\u3044\u307e\u3059\u3002\n- \u3053\u306eTips\u81ea\u4f53\u3088\u308a\u306f\u3053\u3046\u3044\u3063\u305f\u7d44\u7e54\u904b\u55b6\u306e\u5c0f\u3055\u306a\u3068\u3053\u308d\u3078\u3082\u4f7f\u3048\u308b\u6280\u8853\u3092\u9069\u7528\u3057\u3066\u3044\u304f\u7d44\u7e54\u6587\u5316\u3092\u5927\u4e8b\u306b\u3057\u3066\u3044\u304d\u305f\u3044\u306a\u3068\u601d\u3046\u6b21\u7b2c\u3002\n", "tags": ["Slack", "GoogleAppsScript", "GoogleSpreadSheet"]}