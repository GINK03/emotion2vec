{"context": " More than 1 year has passed since last update.\n\n\u6982\u8981\nWicket\u3067WebSocket\u3092\u5229\u7528\u3057\u305f\u3044\u5834\u5408\u3001\n\nwicket-native-websocket-javax\u3092\u5229\u7528\u3059\u308b\nweb.xml\u3067\u5b9a\u7fa9\u3059\u308bServletFilter\u306e\u30af\u30e9\u30b9\u3092 org.apache.wicket.protocol.ws.javax.JavaxWebSocketFilter \u306b\u5909\u66f4\u3059\u308b\nWebSocket\u306b\u5bfe\u5fdc\u3055\u305b\u305f\u3044\u30da\u30fc\u30b8\u306bWebSocketBehavior\u3092\u5b9a\u7fa9\u3059\u308b\n\n\u3068\u3044\u3063\u305f\u624b\u9806\u3092\u8e0f\u3080\u3002\nSpring Boot\u4e0a\u3067Wicket\u3092\u52d5\u304b\u3057\u3066\u3044\u308b\u5834\u5408\u306f\u3001\u3053\u308c\u4ee5\u5916\u306b\u3082\u8a2d\u5b9a\u304c\u5fc5\u8981\u306a\u306e\u3067\u307e\u3068\u3081\u3066\u304a\u304f\u3002\n\n\u691c\u8a3c\u74b0\u5883\n\nSpring Boot 1.3.2\nWicket 7.2.0\nJava 8\n\n\n1. \u30e9\u30a4\u30d6\u30e9\u30ea\u306e\u8ffd\u52a0\nspring-boot-starter-websocket, wicket-native-websocket-javax \u3092\u8ffd\u52a0\u3059\u308b\u3002\n\npom.xml\n<dependency>\n  <groupId>org.springframework.boot</groupId>\n  <artifactId>spring-boot-starter-websocket</artifactId>\n</dependency>\n\n<dependency>\n  <groupId>org.apache.wicket</groupId>\n  <artifactId>wicket-native-websocket-javax</artifactId>\n  <version>${wicket.version}</version>\n</dependency>    \n\n\n\n2. WicketFilter \u304b\u3089 JavaxWebSocketFilter \u3078\u306e\u5909\u66f4\nServletContextInitializer \u306e\u5b9f\u88c5\u30af\u30e9\u30b9\u3067\u3001\u8aad\u307f\u8fbc\u3080 ServletFilter\u30af\u30e9\u30b9 \u3092\u5909\u66f4\u3059\u308b\u3002\n\nWebInitializer.java\n@Configuration\npublic class WebInitializer implements ServletContextInitializer {\n\n  @Override\n  public void onStartup(ServletContext context) throws ServletException {\n    // WicketFilter \u304b\u3089 JavaxWebSocketFilter \u3078\u5909\u66f4\n    FilterRegistration filter = context.addFilter(\"wicket-filter\", JavaxWebSocketFilter.class);\n    ...\n\n\n\n3. WebSocket \u306e\u6709\u52b9\u5316\nWebApplication\u30af\u30e9\u30b9\u306b @SpringBootApplication \u304c\u5b9a\u7fa9\u3055\u308c\u3066\u3044\u308b\u5834\u5408\u3002\n\u307e\u305a\u3001@EnableWebSocket \u3092\u8ffd\u52a0\u3059\u308b\u3002\n\nWicketApplication.java\n@EnableWebSocket // \u8ffd\u52a0\n@SpringBootApplication\npublic class WicketApplication extends WebApplication {\n  ...\n\n\n\u6b21\u306b\u3001WebSocketConfigurer \u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9\u3092\u5b9a\u7fa9\u3059\u308b\u3002\n\nWicketApplication.java\n@EnableWebSocket\n@SpringBootApplication\n//\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9\u306e\u5b9a\u7fa9\u8ffd\u52a0\npublic class WicketApplication extends WebApplication implements WebSocketConfigurer {\n  ...\n\n  // \u30aa\u30fc\u30d0\u30fc\u30e9\u30a4\u30c9\u304c\u5fc5\u8981\u3060\u304c\u3001\u30b3\u30fc\u30c9\u306e\u5b9f\u88c5\u306f\u7279\u306b\u4e0d\u8981\u3002\n  @Override\n  public void registerWebSocketHandlers(WebSocketHandlerRegistry registry) {\n    // TODO Auto-generated method stub\n  }\n}\n\n\n\u3055\u3089\u306b ServerEndpointExporter, WicketServerEndpointConfig \u306eBean\u5b9a\u7fa9\u3092\u52a0\u3048\u308b\u3002\n\nWicketApplication.java\n  @Bean\n  public ServerEndpointExporter serverEndpointExporter() {\n    return new ServerEndpointExporter();\n  }\n\n  @Bean\n  public WicketServerEndpointConfig myWicketServerEndpointConfig() {\n    return new WicketServerEndpointConfig();\n  }\n\n\n\n\u52d5\u4f5c\u78ba\u8a8d\n\u4e0a\u8a18\u306e\u8a2d\u5b9a\u3092\u884c\u3063\u305f\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092github\u306b\u516c\u958b\u3057\u3066\u3044\u308b\u3002\nhttps://github.com/gishi-yama/wicket-on-spring-boot/tree/f077acd\nWebSocketBehavior \u3092 add \u3057\u305f\u30da\u30fc\u30b8\u306b\u3001\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u304b\u3089 WebSocket \u3067\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u9001\u4fe1\u3059\u308b\u3002\u8a73\u3057\u3044\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u306f\u4ee5\u4e0b\u306e\u901a\u308a\u3002\n\nWebSocketBehaviorPage.java\nWebSocketBehaviorPage.html\nwebsocket-callback.js\n\n\nWebSocketBehaviorPage \u3092\u8868\u793a\u3059\u308b\u3068\u3001WebSocket\u3067\u30e1\u30c3\u30bb\u30fc\u30b8\u304c\u9001\u4fe1\u3055\u308c\u308b\u305f\u3073\u306b\u3001\u30e1\u30c3\u30bb\u30fc\u30b8\u306e\u5185\u5bb9\u3068SessionId\u3092\u8868\u793a\u3057\u3066\u3044\u304f\u3002\n## \u6982\u8981\n\nWicket\u3067WebSocket\u3092\u5229\u7528\u3057\u305f\u3044\u5834\u5408\u3001\n\n1. wicket-native-websocket-javax\u3092\u5229\u7528\u3059\u308b\n2. web.xml\u3067\u5b9a\u7fa9\u3059\u308bServletFilter\u306e\u30af\u30e9\u30b9\u3092 org.apache.wicket.protocol.ws.javax.JavaxWebSocketFilter \u306b\u5909\u66f4\u3059\u308b\n3. WebSocket\u306b\u5bfe\u5fdc\u3055\u305b\u305f\u3044\u30da\u30fc\u30b8\u306bWebSocketBehavior\u3092\u5b9a\u7fa9\u3059\u308b\n\n[\u3068\u3044\u3063\u305f\u624b\u9806](https://ci.apache.org/projects/wicket/guide/7.x/guide/nativewebsockets.html)\u3092\u8e0f\u3080\u3002\n\nSpring Boot\u4e0a\u3067Wicket\u3092\u52d5\u304b\u3057\u3066\u3044\u308b\u5834\u5408\u306f\u3001\u3053\u308c\u4ee5\u5916\u306b\u3082\u8a2d\u5b9a\u304c\u5fc5\u8981\u306a\u306e\u3067\u307e\u3068\u3081\u3066\u304a\u304f\u3002\n\n### \u691c\u8a3c\u74b0\u5883\n\n- Spring Boot 1.3.2\n- Wicket 7.2.0\n- Java 8\n\n## 1. \u30e9\u30a4\u30d6\u30e9\u30ea\u306e\u8ffd\u52a0\n\nspring-boot-starter-websocket, wicket-native-websocket-javax \u3092\u8ffd\u52a0\u3059\u308b\u3002\n\n```xml:pom.xml\n<dependency>\n  <groupId>org.springframework.boot</groupId>\n  <artifactId>spring-boot-starter-websocket</artifactId>\n</dependency>\n\n<dependency>\n  <groupId>org.apache.wicket</groupId>\n  <artifactId>wicket-native-websocket-javax</artifactId>\n  <version>${wicket.version}</version>\n</dependency>    \n```\n\n## 2. WicketFilter \u304b\u3089 JavaxWebSocketFilter \u3078\u306e\u5909\u66f4\n\nServletContextInitializer \u306e\u5b9f\u88c5\u30af\u30e9\u30b9\u3067\u3001\u8aad\u307f\u8fbc\u3080 ServletFilter\u30af\u30e9\u30b9 \u3092\u5909\u66f4\u3059\u308b\u3002\n\n```java:WebInitializer.java\n@Configuration\npublic class WebInitializer implements ServletContextInitializer {\n\n  @Override\n  public void onStartup(ServletContext context) throws ServletException {\n    // WicketFilter \u304b\u3089 JavaxWebSocketFilter \u3078\u5909\u66f4\n    FilterRegistration filter = context.addFilter(\"wicket-filter\", JavaxWebSocketFilter.class);\n    ...\n```\n\n## 3. WebSocket \u306e\u6709\u52b9\u5316\n\nWebApplication\u30af\u30e9\u30b9\u306b `@SpringBootApplication` \u304c\u5b9a\u7fa9\u3055\u308c\u3066\u3044\u308b\u5834\u5408\u3002\n\n\u307e\u305a\u3001`@EnableWebSocket` \u3092\u8ffd\u52a0\u3059\u308b\u3002\n\n```java:WicketApplication.java\n@EnableWebSocket // \u8ffd\u52a0\n@SpringBootApplication\npublic class WicketApplication extends WebApplication {\n  ...\n```\n\n\u6b21\u306b\u3001WebSocketConfigurer \u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9\u3092\u5b9a\u7fa9\u3059\u308b\u3002\n\n```java:WicketApplication.java\n@EnableWebSocket\n@SpringBootApplication\n//\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9\u306e\u5b9a\u7fa9\u8ffd\u52a0\npublic class WicketApplication extends WebApplication implements WebSocketConfigurer {\n  ...\n\n  // \u30aa\u30fc\u30d0\u30fc\u30e9\u30a4\u30c9\u304c\u5fc5\u8981\u3060\u304c\u3001\u30b3\u30fc\u30c9\u306e\u5b9f\u88c5\u306f\u7279\u306b\u4e0d\u8981\u3002\n  @Override\n  public void registerWebSocketHandlers(WebSocketHandlerRegistry registry) {\n    // TODO Auto-generated method stub\n  }\n}\n```\n\n\u3055\u3089\u306b ServerEndpointExporter, WicketServerEndpointConfig \u306eBean\u5b9a\u7fa9\u3092\u52a0\u3048\u308b\u3002\n\n```java:WicketApplication.java\n  @Bean\n  public ServerEndpointExporter serverEndpointExporter() {\n    return new ServerEndpointExporter();\n  }\n\n  @Bean\n  public WicketServerEndpointConfig myWicketServerEndpointConfig() {\n    return new WicketServerEndpointConfig();\n  }\n```\n\n## \u52d5\u4f5c\u78ba\u8a8d\n\n\u4e0a\u8a18\u306e\u8a2d\u5b9a\u3092\u884c\u3063\u305f\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092github\u306b\u516c\u958b\u3057\u3066\u3044\u308b\u3002\n\nhttps://github.com/gishi-yama/wicket-on-spring-boot/tree/f077acd\n\nWebSocketBehavior \u3092 add \u3057\u305f\u30da\u30fc\u30b8\u306b\u3001\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u304b\u3089 WebSocket \u3067\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u9001\u4fe1\u3059\u308b\u3002\u8a73\u3057\u3044\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u306f\u4ee5\u4e0b\u306e\u901a\u308a\u3002\n\n- [WebSocketBehaviorPage.java](https://github.com/gishi-yama/wicket-on-spring-boot/blob/f077acdb500d98b54827ede54fb2467d12b8e50a/src/main/java/com/example/page/ws/WebSocketBehaviorPage.java)\n- [WebSocketBehaviorPage.html](https://github.com/gishi-yama/wicket-on-spring-boot/blob/f077acdb500d98b54827ede54fb2467d12b8e50a/src/main/java/com/example/page/ws/WebSocketBehaviorPage.html)\n- [websocket-callback.js\n](https://github.com/gishi-yama/wicket-on-spring-boot/blob/f077acdb500d98b54827ede54fb2467d12b8e50a/src/main/webapp/js/websocket-callback.js)\n\nWebSocketBehaviorPage \u3092\u8868\u793a\u3059\u308b\u3068\u3001WebSocket\u3067\u30e1\u30c3\u30bb\u30fc\u30b8\u304c\u9001\u4fe1\u3055\u308c\u308b\u305f\u3073\u306b\u3001\u30e1\u30c3\u30bb\u30fc\u30b8\u306e\u5185\u5bb9\u3068SessionId\u3092\u8868\u793a\u3057\u3066\u3044\u304f\u3002\n\n", "tags": ["SpringBoot", "Wicket", "Java", "websocket"]}