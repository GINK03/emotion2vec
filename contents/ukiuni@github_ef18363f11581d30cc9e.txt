{"tags": ["Java", "jpa", "EclipseLink"], "context": " \u3053\u306e\u8a18\u4e8b\u306f\u6700\u7d42\u66f4\u65b0\u65e5\u304b\u30891\u5e74\u4ee5\u4e0a\u304c\u7d4c\u904e\u3057\u3066\u3044\u307e\u3059\u3002\n\u3053\u306e\u6295\u7a3f\u306fJavaEE\u306e\u30a2\u30fc\u30ad\u30c6\u30af\u30c1\u30e3\u3092\u518d\u8208\u3059\u308b\u3002\uff08\u307e\u3068\u3081\u30da\u30fc\u30b8\uff09\u306b\u5c5e\u3059\u308b\u6295\u7a3f\u3067\u3059\u3002\u4ed6\u306e\u8a18\u4e8b\u3082\u304a\u697d\u3057\u307f\u3042\u308c\u3002\n\nJava\u3067Web\u30b7\u30b9\u30c6\u30e0\u3092\u4f5c\u308b\u3068\u304d\u3001\u305f\u3044\u3066\u3044\u306fRDB\u3082\u89e6\u308b\u3068\u601d\u3044\u307e\u3059\u3002Java\u3067Entity\u3092\u4f5c\u6210\u3057\u3066\u3001\u305d\u308c\u3068\u540c\u3058\u5f62\u3067DB\u306eCreate\u6587\u3092\u4f5c\u6210\u3057\u3066\u3001\u30d5\u30a3\u30fc\u30eb\u30c9\u540d\u304b\u30ab\u30e9\u30e0\u540d\u3092Typo\u3057\u3066\u30d0\u30b0\u3092\u57cb\u3081\u8fbc\u3080\u3002\u307f\u306a\u3055\u3093\u3082\u4e00\u5ea6\u306f\u4f53\u9a13\u3057\u305f\u3053\u3068\u304c\u3042\u308b\u304b\u3068\u5b58\u3058\u307e\u3059\u3002\nJPA2.0\u3092\u4f7f\u3046\u3068\u3001JPA\u304cEntity\u304b\u3089RDB\u306e\u30c6\u30fc\u30d6\u30eb\u3092\u4f5c\u6210\u3057\u3066\u304f\u308c\u308b\u306e\u3067\u3001Create\u6587\u3092\u898b\u308b\u3053\u3068\u306a\u304f\u3001RDB\u306b\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u4fdd\u5b58\u3067\u304d\u307e\u3059\u3002db:migrate\u3068\u304b\u30b3\u30de\u30f3\u30c9\u3082\u6253\u3064\u3053\u3068\u306a\u304f\u3001JPA\u304c\u3059\u3079\u3066\u3092\u6574\u3048\u3066\u304f\u308c\u307e\u3059\u3002\u4fbf\u5229\u3002\n\u672c\u7a3f\u3067\u306f\u3001\u30b7\u30b9\u30c6\u30e0\u3092\u4f5c\u308b\u4e0a\u3067\u306f\u7d76\u5bfe\u306b\u51fa\u3066\u304f\u308b\u3001\u30c6\u30fc\u30d6\u30eb\u540c\u58eb\u306e\u95a2\u9023\u3092JPA\u3067\u8868\u73fe\u3059\u308b\u305f\u3081\u306b\u306f\u3069\u3046\u3059\u308b\u304b\u3092\u304a\u4f1d\u3048\u3057\u307e\u3059\u3002\n\u3068\u306f\u3044\u3048\u3001Java\u306e\u666e\u901a\u306e\u95a2\u9023\u3092\u4f5c\u308a\u3001\u30a2\u30ce\u30c6\u30fc\u30b7\u30e7\u30f3\u3092\u8cbc\u308b\u3060\u3051\u3067\u3059\u3002\u524d\u7f6e\u304d\u3088\u308a\u3082\u7c21\u5358\u306b\u8aad\u3081\u308b\u304b\u3068\u601d\u3044\u307e\u3059\u3002\n\u306a\u304a\u3001JPA\u306e\u7c21\u5358\u306a\u8aac\u660e\u306f\u3053\u3061\u3089\u3092\u3054\u89a7\u304f\u3060\u3055\u3044\u3002\n\n\u30b5\u30f3\u30d7\u30eb\n\u30b5\u30f3\u30d7\u30eb\u306fGithub\u306e\u3053\u3061\u3089\u306b\u4e57\u305b\u3066\u3042\u308a\u307e\u3059\u3002\nRelationMain.java\u3067\u3001Cart\u3068Item\u3068\u3044\u3046\u30af\u30e9\u30b9\u3092\u4fdd\u5b58\u3001\u53d6\u5f97\u3092\u884c\u3063\u3066\u3044\u307e\u3059\u3002\n\u30b5\u30f3\u30d7\u30eb\u3067\u306fJPA\u306e\u5b9f\u88c5\u3068\u3057\u3066\u3001EclipseLink\u3001RDB\u306bH2\u3092\u4f7f\u7528\u3057\u3066\u3044\u307e\u3059\u3002\n\n\u89e3\u8aac\n\u307e\u305a\u306f\u4fdd\u5b58\u5bfe\u8c61\u306e\u30af\u30e9\u30b9\u3092\u898b\u3066\u3044\u304d\u307e\u3059\u3002\n\nItem.java\u629c\u7c8b(\u95a2\u9023\u3092\u5b9a\u7fa9\u3057\u3066\u3044\u308b\u90e8\u5206)\n@ManyToOne(cascade = CascadeType.ALL)\nprivate Cart cart;\n\n\n\nCart.java\u629c\u7c8b(\u95a2\u9023\u3092\u5b9a\u7fa9\u3057\u3066\u3044\u308b\u90e8\u5206)\n@OneToMany(mappedBy = \"cart\", cascade = CascadeType.ALL)\nprivate List<Item> items = new ArrayList<Item>();\n\n\nItem\u3068Cart\u305d\u308c\u305e\u308c\u3067\u304a\u4e92\u3044\u3092\u53c2\u7167\u3057\u3066\u3044\u307e\u3059\u3002\u307e\u305f\u3001@ManyToOne\u3001@OneToMany\u3067\u305d\u308c\u305e\u308c\u306e\u95a2\u4fc2\u6027\u3092\u5b9a\u7fa9\u3057\u3066\u3044\u307e\u3059\u3002cascade\u306f\u3001\u95a2\u9023\u4ed8\u3051\u3092\u4fdd\u5b58\u6642\u3084\u53c2\u7167\u6642\u306b\u6709\u52b9\u306b\u3059\u308b\u304b\u3092\u9078\u629e\u3057\u307e\u3059\u3002\u3053\u3053\u3067\u306f\u3059\u3079\u3066\u306e\u5834\u5408\u3067\u95a2\u9023\u4ed8\u3051\u3092\u6709\u52b9\u306b\u3057\u305f\u3044\u306e\u3067\u3001CascadeType.ALL\u3092\u6307\u5b9a\u3057\u3066\u3044\u307e\u3059\u3002\u307e\u305f\u3001mappedBy\u3067\u306f\u95a2\u9023\u5148\u3001Item\u306e\u30d5\u30a3\u30fc\u30eb\u30c9\u540d\u3092\u6307\u5b9a\u3057\u3066\u3044\u307e\u3059\u3002\n\u95a2\u9023\u4ed8\u3051\u306f\u3053\u308c\u3060\u3051\u3002\u7c21\u5358\u3067\u3059\u306d\u3002\n\nRelationMain.java\u629c\u7c8b(\u4fdd\u5b58\u6642)\nCart cart = new Cart();\n\ncart.addItem(new Item(\"ITEM1\"));\ncart.addItem(new Item(\"ITEM2\"));\n\ncart.setKey(UUID.randomUUID().toString());\n\nem.persist(cart);\n\n\ncart\u3092\u4f5c\u6210\u3057\u3001item\u3092\u95a2\u9023\u4ed8\u3051\u3066\u3044\u307e\u3059\u3002Cart#addItem\u3067\u306f\u3001Item\u3068cart\u3092\u76f8\u4e92\u306b\u95a2\u9023\u4ed8\u3051\u3066\u3044\u307e\u3059\u3002\n\u3053\u308c\u3060\u3051\u3067DB\u306b\u5916\u90e8\u30ad\u30fc\u95a2\u9023\u304c\u4fdd\u5b58\u3055\u308c\u307e\u3059\u3002\n\nRelationMain.java\u629c\u7c8b(Cart\u691c\u7d22\u6642)\nList<Cart> carts = em.createQuery(cq.select(r)).getResultList();\nSystem.out.println(\"carts length = \" + carts.size());\nfor (Cart cart : carts) {\n    System.out.println(\"# cart id = \" + cart.getId());\n    List<Item> items = cart.getItems();\n    for (Item item : items) {\n        System.out.println(\"\\t item id = \" + item.getId() + \", name = \" + item.getName() + \", cartId\");\n    }\n}\n\n\nCart\u3092\u691c\u7d22\u3059\u308b\u3068\u3001Item\u3082\u4e00\u7dd2\u306b\u53d6\u5f97\u3067\u304d\u308b\u3053\u3068\u304c\u308f\u304b\u308a\u307e\u3059\u3002\n\u9006\u306b\u3001Item\u3092\u691c\u7d22\u3057\u3066\u3082\u3001Cart\u304c\u53d6\u5f97\u3067\u304d\u307e\u3059\u3002\n\nRelationMain.java\u629c\u7c8b(Item\u691c\u7d22\u6642)\nList<Item> items = em.createQuery(query.select(r)).getResultList();\nSystem.out.println(\"items length = \" + items.size());\nfor (Item item : items) {\n    System.out.println(\"item cartId = \" + item.getCart().getId() + \" id = \" + item.getId() + \", name = \" + item.getName());\n}\n\n\nRDB\u3092\u4f7f\u3063\u3066\u3044\u308b\u3053\u3068\u3092\u610f\u8b58\u305b\u305a\u306b\u4fdd\u5b58\u3001\u53d6\u5f97\u304c\u3067\u304d\u3066\u3044\u307e\u3059\u306d\uff01\n\n\u66f4\u306b\u8a73\u3057\u304f\u898b\u3066\u307f\u308b\u3002\nJPA\u306f\u4fbf\u5229\u3059\u304e\u307e\u3059\uff01\u3057\u304b\u3057\u306a\u304c\u3089\u3001\u3069\u3046\u3044\u3046\u51e6\u7406\u3092\u3057\u3066\u3044\u308b\u304b\u3068\u3066\u3082\u6c17\u306b\u306a\u308b\u306e\u3067\u3001\u4e2d\u3092\u898b\u3066\u307f\u307e\u3059\u3002\n\n\u30c6\u30fc\u30d6\u30eb\u5b9a\u7fa9\nJPA\u3067\u306f\u52dd\u624b\u306b\u30c6\u30fc\u30d6\u30eb\u3092\u4f5c\u3063\u3066\u304f\u308c\u3066\u3044\u307e\u3059\u3002\u3069\u306e\u3088\u3046\u306a\u30c6\u30fc\u30d6\u30eb\u304c\u3067\u304d\u3066\u3044\u308b\u304b\u898b\u3066\u307f\u307e\u3059\u3002\n\n\u30c6\u30fc\u30d6\u30eb\u5b9a\u7fa9\nCREATE CACHED TABLE PUBLIC.ITEM(\n    ID BIGINT NOT NULL,\n    NAME VARCHAR,\n    CART_ID BIGINT\n);\nCREATE PRIMARY KEY PUBLIC.PRIMARY_KEY_2 ON PUBLIC.ITEM(ID);\neALTER TABLE PUBLIC.ITEM ADD CONSTRAINT PUBLIC.CONSTRAINT_2 PRIMARY KEY(ID) INDEX PUBLIC.PRIMARY_KEY_2,  \nJCREATE CACHED TABLE PUBLIC.CART(\n    ID BIGINT NOT NULL,\n    KEY VARCHAR\n);\nCREATE PRIMARY KEY PUBLIC.PRIMARY_KEY_1F ON PUBLIC.CART(ID);\nALTER TABLE PUBLIC.CART ADD CONSTRAINT PUBLIC.CONSTRAINT_1F PRIMARY KEY(ID) INDEX PUBLIC.PRIMARY_KEY_1;\nCREATE INDEX PUBLIC.FK_ITEM_CART_ID_INDEX_2 ON PUBLIC.ITEM(CART_ID);\nALTER TABLE PUBLIC.ITEM ADD CONSTRAINT PUBLIC.FK_ITEM_CART_ID FOREIGN KEY(CART_ID) INDEX PUBLIC.FK_ITEM_CART_ID_INDEX_2 REFERENCES PUBLIC.CART(ID) NOCHECK;\n\n\nITEM\u30c6\u30fc\u30d6\u30eb\u306bCART_ID\u3068\u3044\u3046\u30ab\u30e9\u30e0\u304c\u3067\u304d\u3066\u3001ALTER\u3000TABLE\u3067\u305d\u3053\u306b\u5916\u90e8\u30ad\u30fc\u3092\u5f35\u3063\u3066\u3044\u308b\u306e\u304c\u308f\u304b\u308a\u307e\u3059\u3002\n\nSelect\u6587\nEclipseLink\u306e\u30ed\u30b0\u3092\u30a2\u30d7\u30ea\u306e\u51fa\u529b\u3068\u4ea4\u3048\u3066\u898b\u3066\u307f\u307e\u3059\u3002\n\n\u30ed\u30b0\nquery cart start\n[EL Fine]: sql: 2014-06-27 23:09:07.716--ServerSession(253338012)--Connection(1998581014)--Thread(Thread[main,5,main])--SELECT ID, KEY FROM CART\ncarts length = 3\n# cart id = 1\n[EL Fine]: sql: 2014-06-27 23:09:07.721--ServerSession(253338012)--Connection(1998581014)--Thread(Thread[main,5,main])--SELECT ID, NAME, CART_ID FROM ITEM WHERE (CART_ID = ?)\n    bind => [1]\n     item id = 2, name = ITEM1, cartId\n     item id = 3, name = ITEM2, cartId\n\n\n\nCart\u306e\u691c\u7d22\u306fSELECT ID, KEY FROM CART\u3067\u666e\u901a\u306b\u884c\u3063\u3066\u3044\u307e\u3059\u306d\u3002\u8208\u5473\u6df1\u3044\u306e\u306f\u3001\u3053\u306e\u6642\u306f\u307e\u3060Item\u306f\u53d6\u5f97\u3057\u3066\u304a\u3089\u305a\u3001cart.getItems()\u306e\u6642\u306b\u521d\u3081\u3066SELECT ID, NAME, CART_ID FROM ITEM WHERE (CART_ID = ?)\u3092\u884c\u3063\u3066\u3044\u308b\u306e\u304c\u308f\u304b\u308a\u307e\u3059\u3002\u3053\u308c\u3067\u4f59\u5206\u306a\u30c7\u30fc\u30bf\u53d6\u5f97\u3092\u3059\u308b\u3053\u3068\u304c\u306a\u304f\u3066\u30cf\u30c3\u30d4\u30fc\u3067\u3059\u306d\u3002\n\nJPA\u306f\u3068\u3066\u3082\u7c21\u5358\u3002\u4f7f\u308f\u306a\u3044\u624b\u306f\u3042\u308a\u307e\u305b\u3093\u3002\nDB\u30a2\u30af\u30bb\u30b9\u306e\u3088\u3046\u306a\u3001\u3044\u3064\u3082\u3044\u3064\u3082\u540c\u3058\u30b3\u30fc\u30c9\u3092\u66f8\u304f\u3088\u3046\u306a\u5b9f\u88c5\u306f\u3001\u3067\u304d\u308b\u3060\u3051\u697d\u3092\u3057\u3066\u4f5c\u3063\u3066\u3001UX\u3084\u4fbf\u5229\u306a\u6a5f\u80fd\u306a\u3069\u306b\u529b\u3092\u5165\u308c\u3001\u3082\u306e\u3065\u304f\u308a\u306e\u4fa1\u5024\u3092\u4e0a\u3052\u305f\u3044\u3082\u306e\u3067\u3059\u3002\n\u305d\u306e\u305f\u3081\u306b\u3082\u3001JPA\u3092\u4f7f\u3063\u3066\u307f\u3066\u306f\u3044\u304b\u304c\u3067\u3057\u3087\u3046\u304b\uff1f\n> \u3053\u306e\u6295\u7a3f\u306f[JavaEE\u306e\u30a2\u30fc\u30ad\u30c6\u30af\u30c1\u30e3\u3092\u518d\u8208\u3059\u308b\u3002\uff08\u307e\u3068\u3081\u30da\u30fc\u30b8\uff09](http://qiita.com/ukiuni@github/items/b9d18b44570ece0e3933)\u306b\u5c5e\u3059\u308b\u6295\u7a3f\u3067\u3059\u3002\u4ed6\u306e\u8a18\u4e8b\u3082\u304a\u697d\u3057\u307f\u3042\u308c\u3002\n\nJava\u3067Web\u30b7\u30b9\u30c6\u30e0\u3092\u4f5c\u308b\u3068\u304d\u3001\u305f\u3044\u3066\u3044\u306fRDB\u3082\u89e6\u308b\u3068\u601d\u3044\u307e\u3059\u3002Java\u3067Entity\u3092\u4f5c\u6210\u3057\u3066\u3001\u305d\u308c\u3068\u540c\u3058\u5f62\u3067DB\u306eCreate\u6587\u3092\u4f5c\u6210\u3057\u3066\u3001\u30d5\u30a3\u30fc\u30eb\u30c9\u540d\u304b\u30ab\u30e9\u30e0\u540d\u3092Typo\u3057\u3066\u30d0\u30b0\u3092\u57cb\u3081\u8fbc\u3080\u3002\u307f\u306a\u3055\u3093\u3082\u4e00\u5ea6\u306f\u4f53\u9a13\u3057\u305f\u3053\u3068\u304c\u3042\u308b\u304b\u3068\u5b58\u3058\u307e\u3059\u3002\nJPA2.0\u3092\u4f7f\u3046\u3068\u3001JPA\u304cEntity\u304b\u3089RDB\u306e\u30c6\u30fc\u30d6\u30eb\u3092\u4f5c\u6210\u3057\u3066\u304f\u308c\u308b\u306e\u3067\u3001Create\u6587\u3092\u898b\u308b\u3053\u3068\u306a\u304f\u3001RDB\u306b\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u4fdd\u5b58\u3067\u304d\u307e\u3059\u3002db:migrate\u3068\u304b\u30b3\u30de\u30f3\u30c9\u3082\u6253\u3064\u3053\u3068\u306a\u304f\u3001JPA\u304c\u3059\u3079\u3066\u3092\u6574\u3048\u3066\u304f\u308c\u307e\u3059\u3002\u4fbf\u5229\u3002\n\n\u672c\u7a3f\u3067\u306f\u3001\u30b7\u30b9\u30c6\u30e0\u3092\u4f5c\u308b\u4e0a\u3067\u306f\u7d76\u5bfe\u306b\u51fa\u3066\u304f\u308b\u3001\u30c6\u30fc\u30d6\u30eb\u540c\u58eb\u306e\u95a2\u9023\u3092JPA\u3067\u8868\u73fe\u3059\u308b\u305f\u3081\u306b\u306f\u3069\u3046\u3059\u308b\u304b\u3092\u304a\u4f1d\u3048\u3057\u307e\u3059\u3002\n\u3068\u306f\u3044\u3048\u3001Java\u306e\u666e\u901a\u306e\u95a2\u9023\u3092\u4f5c\u308a\u3001\u30a2\u30ce\u30c6\u30fc\u30b7\u30e7\u30f3\u3092\u8cbc\u308b\u3060\u3051\u3067\u3059\u3002\u524d\u7f6e\u304d\u3088\u308a\u3082\u7c21\u5358\u306b\u8aad\u3081\u308b\u304b\u3068\u601d\u3044\u307e\u3059\u3002\n\n\u306a\u304a\u3001JPA\u306e\u7c21\u5358\u306a\u8aac\u660e\u306f[\u3053\u3061\u3089](http://qiita.com/ukiuni@github/items/f3e68e7f8fdcc0830e06)\u3092\u3054\u89a7\u304f\u3060\u3055\u3044\u3002\n\n# \u30b5\u30f3\u30d7\u30eb\n\u30b5\u30f3\u30d7\u30eb\u306fGithub\u306e[\u3053\u3061\u3089](https://github.com/ukiuni/EclipseLinkInspect)\u306b\u4e57\u305b\u3066\u3042\u308a\u307e\u3059\u3002\n[RelationMain.java](https://github.com/ukiuni/EclipseLinkInspect/blob/master/src/org/ukiuni/jpaInspect/RelationMain.java)\u3067\u3001[Cart](https://github.com/ukiuni/EclipseLinkInspect/blob/master/src/org/ukiuni/jpaInspect/entity/Cart.java)\u3068[Item](https://github.com/ukiuni/EclipseLinkInspect/blob/master/src/org/ukiuni/jpaInspect/entity/Item.java)\u3068\u3044\u3046\u30af\u30e9\u30b9\u3092\u4fdd\u5b58\u3001\u53d6\u5f97\u3092\u884c\u3063\u3066\u3044\u307e\u3059\u3002\n\u30b5\u30f3\u30d7\u30eb\u3067\u306fJPA\u306e\u5b9f\u88c5\u3068\u3057\u3066\u3001EclipseLink\u3001RDB\u306bH2\u3092\u4f7f\u7528\u3057\u3066\u3044\u307e\u3059\u3002\n\n# \u89e3\u8aac\n\u307e\u305a\u306f\u4fdd\u5b58\u5bfe\u8c61\u306e\u30af\u30e9\u30b9\u3092\u898b\u3066\u3044\u304d\u307e\u3059\u3002\n\n```java:Item.java\u629c\u7c8b(\u95a2\u9023\u3092\u5b9a\u7fa9\u3057\u3066\u3044\u308b\u90e8\u5206)\n@ManyToOne(cascade = CascadeType.ALL)\nprivate Cart cart;\n```\n\n```java:Cart.java\u629c\u7c8b(\u95a2\u9023\u3092\u5b9a\u7fa9\u3057\u3066\u3044\u308b\u90e8\u5206)\n@OneToMany(mappedBy = \"cart\", cascade = CascadeType.ALL)\nprivate List<Item> items = new ArrayList<Item>();\n```\n\nItem\u3068Cart\u305d\u308c\u305e\u308c\u3067\u304a\u4e92\u3044\u3092\u53c2\u7167\u3057\u3066\u3044\u307e\u3059\u3002\u307e\u305f\u3001@ManyToOne\u3001@OneToMany\u3067\u305d\u308c\u305e\u308c\u306e\u95a2\u4fc2\u6027\u3092\u5b9a\u7fa9\u3057\u3066\u3044\u307e\u3059\u3002cascade\u306f\u3001\u95a2\u9023\u4ed8\u3051\u3092\u4fdd\u5b58\u6642\u3084\u53c2\u7167\u6642\u306b\u6709\u52b9\u306b\u3059\u308b\u304b\u3092\u9078\u629e\u3057\u307e\u3059\u3002\u3053\u3053\u3067\u306f\u3059\u3079\u3066\u306e\u5834\u5408\u3067\u95a2\u9023\u4ed8\u3051\u3092\u6709\u52b9\u306b\u3057\u305f\u3044\u306e\u3067\u3001CascadeType.ALL\u3092\u6307\u5b9a\u3057\u3066\u3044\u307e\u3059\u3002\u307e\u305f\u3001mappedBy\u3067\u306f\u95a2\u9023\u5148\u3001Item\u306e\u30d5\u30a3\u30fc\u30eb\u30c9\u540d\u3092\u6307\u5b9a\u3057\u3066\u3044\u307e\u3059\u3002\n\u95a2\u9023\u4ed8\u3051\u306f\u3053\u308c\u3060\u3051\u3002\u7c21\u5358\u3067\u3059\u306d\u3002\n\n```java:RelationMain.java\u629c\u7c8b(\u4fdd\u5b58\u6642)\nCart cart = new Cart();\n\ncart.addItem(new Item(\"ITEM1\"));\ncart.addItem(new Item(\"ITEM2\"));\n\ncart.setKey(UUID.randomUUID().toString());\n\nem.persist(cart);\n```\n\ncart\u3092\u4f5c\u6210\u3057\u3001item\u3092\u95a2\u9023\u4ed8\u3051\u3066\u3044\u307e\u3059\u3002Cart#addItem\u3067\u306f\u3001Item\u3068cart\u3092\u76f8\u4e92\u306b\u95a2\u9023\u4ed8\u3051\u3066\u3044\u307e\u3059\u3002\n\u3053\u308c\u3060\u3051\u3067DB\u306b\u5916\u90e8\u30ad\u30fc\u95a2\u9023\u304c\u4fdd\u5b58\u3055\u308c\u307e\u3059\u3002\n\n```java:RelationMain.java\u629c\u7c8b(Cart\u691c\u7d22\u6642)\nList<Cart> carts = em.createQuery(cq.select(r)).getResultList();\nSystem.out.println(\"carts length = \" + carts.size());\nfor (Cart cart : carts) {\n    System.out.println(\"# cart id = \" + cart.getId());\n    List<Item> items = cart.getItems();\n    for (Item item : items) {\n        System.out.println(\"\\t item id = \" + item.getId() + \", name = \" + item.getName() + \", cartId\");\n    }\n}\n```\n\nCart\u3092\u691c\u7d22\u3059\u308b\u3068\u3001Item\u3082\u4e00\u7dd2\u306b\u53d6\u5f97\u3067\u304d\u308b\u3053\u3068\u304c\u308f\u304b\u308a\u307e\u3059\u3002\n\u9006\u306b\u3001Item\u3092\u691c\u7d22\u3057\u3066\u3082\u3001Cart\u304c\u53d6\u5f97\u3067\u304d\u307e\u3059\u3002\n\n```java:RelationMain.java\u629c\u7c8b(Item\u691c\u7d22\u6642)\nList<Item> items = em.createQuery(query.select(r)).getResultList();\nSystem.out.println(\"items length = \" + items.size());\nfor (Item item : items) {\n    System.out.println(\"item cartId = \" + item.getCart().getId() + \" id = \" + item.getId() + \", name = \" + item.getName());\n}\n```\n\nRDB\u3092\u4f7f\u3063\u3066\u3044\u308b\u3053\u3068\u3092\u610f\u8b58\u305b\u305a\u306b\u4fdd\u5b58\u3001\u53d6\u5f97\u304c\u3067\u304d\u3066\u3044\u307e\u3059\u306d\uff01\n\n# \u66f4\u306b\u8a73\u3057\u304f\u898b\u3066\u307f\u308b\u3002\n\nJPA\u306f\u4fbf\u5229\u3059\u304e\u307e\u3059\uff01\u3057\u304b\u3057\u306a\u304c\u3089\u3001\u3069\u3046\u3044\u3046\u51e6\u7406\u3092\u3057\u3066\u3044\u308b\u304b\u3068\u3066\u3082\u6c17\u306b\u306a\u308b\u306e\u3067\u3001\u4e2d\u3092\u898b\u3066\u307f\u307e\u3059\u3002\n\n## \u30c6\u30fc\u30d6\u30eb\u5b9a\u7fa9\nJPA\u3067\u306f\u52dd\u624b\u306b\u30c6\u30fc\u30d6\u30eb\u3092\u4f5c\u3063\u3066\u304f\u308c\u3066\u3044\u307e\u3059\u3002\u3069\u306e\u3088\u3046\u306a\u30c6\u30fc\u30d6\u30eb\u304c\u3067\u304d\u3066\u3044\u308b\u304b\u898b\u3066\u307f\u307e\u3059\u3002\n\n```sql:\u30c6\u30fc\u30d6\u30eb\u5b9a\u7fa9\nCREATE CACHED TABLE PUBLIC.ITEM(\n    ID BIGINT NOT NULL,\n    NAME VARCHAR,\n    CART_ID BIGINT\n);\nCREATE PRIMARY KEY PUBLIC.PRIMARY_KEY_2 ON PUBLIC.ITEM(ID);\neALTER TABLE PUBLIC.ITEM ADD CONSTRAINT PUBLIC.CONSTRAINT_2 PRIMARY KEY(ID) INDEX PUBLIC.PRIMARY_KEY_2,  \nJCREATE CACHED TABLE PUBLIC.CART(\n    ID BIGINT NOT NULL,\n    KEY VARCHAR\n);\nCREATE PRIMARY KEY PUBLIC.PRIMARY_KEY_1F ON PUBLIC.CART(ID);\nALTER TABLE PUBLIC.CART ADD CONSTRAINT PUBLIC.CONSTRAINT_1F PRIMARY KEY(ID) INDEX PUBLIC.PRIMARY_KEY_1;\nCREATE INDEX PUBLIC.FK_ITEM_CART_ID_INDEX_2 ON PUBLIC.ITEM(CART_ID);\nALTER TABLE PUBLIC.ITEM ADD CONSTRAINT PUBLIC.FK_ITEM_CART_ID FOREIGN KEY(CART_ID) INDEX PUBLIC.FK_ITEM_CART_ID_INDEX_2 REFERENCES PUBLIC.CART(ID) NOCHECK;\n```\nITEM\u30c6\u30fc\u30d6\u30eb\u306bCART_ID\u3068\u3044\u3046\u30ab\u30e9\u30e0\u304c\u3067\u304d\u3066\u3001ALTER\u3000TABLE\u3067\u305d\u3053\u306b\u5916\u90e8\u30ad\u30fc\u3092\u5f35\u3063\u3066\u3044\u308b\u306e\u304c\u308f\u304b\u308a\u307e\u3059\u3002\n\n## Select\u6587\nEclipseLink\u306e\u30ed\u30b0\u3092\u30a2\u30d7\u30ea\u306e\u51fa\u529b\u3068\u4ea4\u3048\u3066\u898b\u3066\u307f\u307e\u3059\u3002\n\n```:\u30ed\u30b0\nquery cart start\n[EL Fine]: sql: 2014-06-27 23:09:07.716--ServerSession(253338012)--Connection(1998581014)--Thread(Thread[main,5,main])--SELECT ID, KEY FROM CART\ncarts length = 3\n# cart id = 1\n[EL Fine]: sql: 2014-06-27 23:09:07.721--ServerSession(253338012)--Connection(1998581014)--Thread(Thread[main,5,main])--SELECT ID, NAME, CART_ID FROM ITEM WHERE (CART_ID = ?)\n\tbind => [1]\n\t item id = 2, name = ITEM1, cartId\n\t item id = 3, name = ITEM2, cartId\n\n```\n\nCart\u306e\u691c\u7d22\u306fSELECT ID, KEY FROM CART\u3067\u666e\u901a\u306b\u884c\u3063\u3066\u3044\u307e\u3059\u306d\u3002\u8208\u5473\u6df1\u3044\u306e\u306f\u3001\u3053\u306e\u6642\u306f\u307e\u3060Item\u306f\u53d6\u5f97\u3057\u3066\u304a\u3089\u305a\u3001cart.getItems()\u306e\u6642\u306b\u521d\u3081\u3066SELECT ID, NAME, CART_ID FROM ITEM WHERE (CART_ID = ?)\u3092\u884c\u3063\u3066\u3044\u308b\u306e\u304c\u308f\u304b\u308a\u307e\u3059\u3002\u3053\u308c\u3067\u4f59\u5206\u306a\u30c7\u30fc\u30bf\u53d6\u5f97\u3092\u3059\u308b\u3053\u3068\u304c\u306a\u304f\u3066\u30cf\u30c3\u30d4\u30fc\u3067\u3059\u306d\u3002\n\n# JPA\u306f\u3068\u3066\u3082\u7c21\u5358\u3002\u4f7f\u308f\u306a\u3044\u624b\u306f\u3042\u308a\u307e\u305b\u3093\u3002\nDB\u30a2\u30af\u30bb\u30b9\u306e\u3088\u3046\u306a\u3001\u3044\u3064\u3082\u3044\u3064\u3082\u540c\u3058\u30b3\u30fc\u30c9\u3092\u66f8\u304f\u3088\u3046\u306a\u5b9f\u88c5\u306f\u3001\u3067\u304d\u308b\u3060\u3051\u697d\u3092\u3057\u3066\u4f5c\u3063\u3066\u3001UX\u3084\u4fbf\u5229\u306a\u6a5f\u80fd\u306a\u3069\u306b\u529b\u3092\u5165\u308c\u3001\u3082\u306e\u3065\u304f\u308a\u306e\u4fa1\u5024\u3092\u4e0a\u3052\u305f\u3044\u3082\u306e\u3067\u3059\u3002\n\u305d\u306e\u305f\u3081\u306b\u3082\u3001JPA\u3092\u4f7f\u3063\u3066\u307f\u3066\u306f\u3044\u304b\u304c\u3067\u3057\u3087\u3046\u304b\uff1f\n"}