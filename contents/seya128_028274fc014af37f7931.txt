{"context": " More than 1 year has passed since last update.\n\n\u6982\u8981\n\u672c\u65e5\u306e\u4e88\u5b9a\u3092\u79d8\u66f8\u304c\u6559\u3048\u3066\u304f\u308c\u305f\u3089\u3046\u308c\u3057\u3044\u3067\u3059\u3088\u306d\uff01\nslack\u30dc\u30c3\u30c8\u3067\u4f5c\u3063\u3066\u3057\u307e\u3044\u307e\u3057\u3087\u3046\u3002\n\u79d8\u66f8\u306e\u300c\u79d8\u66f8\u7f8e\u300d\u304c\u3001\u6bce\u671d\u4e88\u5b9a\u3092\u6559\u3048\u3066\u304f\u308c\u307e\u3059\u3002\n\nGAS\u3067Google\u30ab\u30ec\u30f3\u30c0\u30fc\u306e\u4e88\u5b9a\u304b\u3089\u4eca\u65e5\u306e\u4e88\u5b9a\u3092\u30d4\u30c3\u30af\u30a2\u30c3\u30d7\u3057\u3001Incoming WebHook\u3067\u3001slack\u3078\u30dd\u30b9\u30c8\u3057\u307e\u3059\u3002\nGAS\u3092\u4f7f\u3046\u306e\u3067\u30b5\u30fc\u30d0\u30fc\u3082\u7279\u5225\u306b\u7528\u610f\u3059\u308b\u5fc5\u8981\u304c\u306a\u304f\u7c21\u5358\u3067\u3059\u3002\n\n\u79d8\u66f8\u7f8e\u306e\u4f5c\u308a\u65b9\n\nslack\u306eWebhook URL\u3092\u53d6\u5f97\nIntegrations - Incoming WebHooks \u3067\u53d6\u5f97\u3002\n\u300cPost to Channel\u300d\u306f\u3001\u9069\u5f53\u306a\u30c1\u30e3\u30f3\u30cd\u30eb\u3067\uff2f\uff2b\u3002\u30b9\u30af\u30ea\u30d7\u30c8\u3067\u30dd\u30b9\u30c8\u3059\u308b\u30c1\u30e3\u30f3\u30cd\u30eb\u306f\u6307\u5b9a\u3067\u304d\u307e\u3059\u3002\n\u300cWebhook URL\u300d\uff1a\u3053\u308c\u3092\u30e1\u30e2\u3063\u3066\u304a\u304d\u307e\u3059\u3002\n\n\u30ab\u30ec\u30f3\u30c0\u30fcID\u306e\u53d6\u5f97\nGoogle\u30ab\u30ec\u30f3\u30c0\u30fc\u306e\u8a2d\u5b9a\u753b\u9762\u306e\u300c\u30ab\u30ec\u30f3\u30c0\u30fc\u306e\u30a2\u30c9\u30ec\u30b9:\u300d\u3063\u3066\u3068\u3053\u308d\u306b\u3001\u30ab\u30ec\u30f3\u30c0\u30fcID\u304c\u3072\u3087\u3046\u3058\u3055\u308c\u3066\u3044\u307e\u3059\u3002\uff08xxxxxx@xxxxxxx.google.com\u3000\u307f\u305f\u3044\u306a\u306e\uff09\n\u3053\u308c\u3092\u5fc5\u8981\u306a\u30ab\u30ec\u30f3\u30c0\u30fc\u5206\u30e1\u30e2\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n\nGAS\u30b9\u30af\u30ea\u30d7\u30c8\u4f5c\u6210\n\u81ea\u5206\u306f\u9069\u5f53\u306a\u30b9\u30d7\u30ec\u30c3\u30c9\u30b7\u30fc\u30c8\u3092\u4f5c\u6210\u3057\u3001\n\u300c\u30c4\u30fc\u30eb\u300d-\u300c\u30b9\u30af\u30ea\u30d7\u30c8\u30a8\u30c7\u30a3\u30bf\u300d\n\u3067\u4f5c\u6210\u3057\u307e\u3057\u305f\u3002\n\n\u30b9\u30af\u30ea\u30d7\u30c8\u30b3\u30fc\u30c9\u306e\u5165\u529b\n\n//\u79d8\u66f8\u7f8e\u304c\u4eca\u65e5\u306e\u4e88\u5b9a\u3092slack\u306b\u6295\u7a3f\u3057\u3066\u304f\u308c\u308b\n\nfunction myFunction() {\n  var list = \"\";\n  var s;\n\n  s = listupEvent(\"xxxxxxxxxx@group.calendar.google.com\"); //\u4f11\u307f\n  if (s != \"\")  list += \"\\n\u25a0\u304a\u4f11\u307f\\n\" + s;\n\n  s = listupEvent(\"xxxxxxxxxx@group.calendar.google.com\"); //\u540d\u53e4\u5c4b\n  if (s != \"\")  list += \"\\n\u25a0\u540d\u53e4\u5c4b\u306e\u3054\u4e88\u5b9a\\n\" + s;\n\n  s = listupEvent(\"xxxxxxxxxx@group.calendar.google.com\"); //\u6771\u4eac\n  if (s != \"\")  list += \"\\n\u25a0\u6771\u4eac\u306e\u3054\u4e88\u5b9a\\n\" + s;\n\n  s = listupEvent(\"xxxxxxxxxx@group.calendar.google.com\"); //SC\u8ab2\n  if (s != \"\")  list += \"\\n\u25a0\uff33\uff23\u8ab2\u306e\u3054\u4e88\u5b9a\\n\" + s;\n\n  Logger.log(list);\n\n  if (list != \"\") {\n    var payload = {\n      \"text\" : \"\u672c\u65e5\u306e\u4e88\u5b9a\u3092\u304a\u77e5\u3089\u305b\u3057\u307e\u3059\u3002\\n\" + list,\n      \"channel\" : \"#random\",\n      \"username\" : \"\u79d8\u66f8\u7f8e\",\n      \"icon_emoji\" : \":information_desk_person:\"\n    }\n\n    postSlack(payload);\n  }\n\n}\n\n//\u672c\u65e5\u306e\u4e88\u5b9a\u3092\u30ea\u30b9\u30c8\u30a2\u30c3\u30d7\nfunction listupEvent(cal_id)\n{\n  var list = \"\";\n  var cal = CalendarApp.getCalendarById(cal_id);\n  var events = cal.getEventsForDay(new Date());\n  for(var i=0; i < events.length; i++){\n    s = \"\";\n    if (events[i].isAllDayEvent()) {\n      s += Utilities.formatDate(events[i].getStartTime(),\"GMT+0900\",\"MM/dd  \");\n    } else {\n      s += Utilities.formatDate(events[i].getStartTime(),\"GMT+0900\",\"MM/dd HH:mm\");\n      s += Utilities.formatDate(events[i].getEndTime(), \"GMT+0900\",\"-HH:mm  \");\n    }\n    s += events[i].getTitle();\n    Logger.log(s);\n\n    list += s + \"\\n\";\n  }\n\n  return list;\n}\n\n//slack\u3078\u30dd\u30b9\u30c8\nfunction postSlack(payload)\n{\n  // POST\u30aa\u30d7\u30b7\u30e7\u30f3\n  var options = {\n    \"method\" : \"POST\",\n    \"payload\" : JSON.stringify(payload)\n  }\n\n  // \u30a2\u30af\u30bb\u30b9\u5148\n  var url = \"https://hooks.slack.com/services/XXXXXX/XXXXXX/XXXXXXXXXXXXXXX\";\n  // POST\u30ea\u30af\u30a8\u30b9\u30c8\n  var response = UrlFetchApp.fetch(url, options);\n  // HTML\u7d50\u679c\u3092\u53d6\u5f97\uff08\u5f15\u6570\u306echarset\u306f\u8a2d\u5b9a\u3057\u305f\u307b\u3046\u304c\u826f\u3044\uff09\n  var content = response.getContentText(\"UTF-8\");\n\n}\n\n\u3053\u306e\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u3001\u6642\u9593\u6307\u5b9a\u306e\u30c8\u30ea\u30ac\u30fc\u3067\u6bce\u65e5\u5b9f\u884c\u3055\u305b\u3066\u3044\u307e\u3059\u3002\n\u4eca\u56de\u306f\u3001\uff14\u3064\u306e\u30ab\u30ec\u30f3\u30c0\u30fc\u304b\u3089\u4e88\u5b9a\u3092\u30d4\u30c3\u30af\u30a2\u30c3\u30d7\u3057\u3066\u3044\u307e\u3059\u3002\n  \"channel\" : \"#random\",\n  \"username\" : \"\u79d8\u66f8\u7f8e\",\n  \"icon_emoji\" : \":information_desk_person:\"\n\n\u3053\u306e\u3042\u305f\u308a\u3092\u5909\u66f4\u3059\u308b\u3053\u3068\u3067\u3001\n\u30fb\u30dd\u30b9\u30c8\u3059\u308b\u30c1\u30e3\u30f3\u30cd\u30eb\n\u30fb\u30dc\u30c3\u30c8\u306e\u540d\u524d\n\u30fb\u30dc\u30c3\u30c8\u306e\u30a2\u30a4\u30b3\u30f3\n\u3092\u5909\u66f4\u3067\u304d\u307e\u3059\u3002\n\n\u53c2\u8003\nGoogle Apps Script\u3092\u4f7f\u3063\u3066\u307f\u3088\u3046! - \u30b5\u30c6\u30e9\u30a4\u30c8\u539f\u53e3\u793e\u9577\u306e\u30b9\u30af\u30ea\u30d7\u30c8\u6307\u5357 (6) \u4eca\u65e5\u306e\u4e88\u5b9a\u3092\u30ab\u30ec\u30f3\u30c0\u30fc\u304b\u3089\u30e1\u30fc\u30eb\u3067\u81ea\u52d5\u9001\u4fe1 | \u30de\u30a4\u30ca\u30d3\u30cb\u30e5\u30fc\u30b9 \nhttp://news.mynavi.jp/series/apps_script/006/\nGoogle\u30b9\u30d7\u30ec\u30c3\u30c9\u30b7\u30fc\u30c8\u3067GET/POST\u901a\u4fe1\u3092\u884c\u3044\u30b3\u30f3\u30c6\u30f3\u30c4\u3092\u53d6\u5f97\u3059\u308b - Web\u30b5\u30fc\u30d3\u30b9\u3067\u8d77\u696d\u3092\u76ee\u6307\u3059\u30d7\u30ed\u30b0\u30e9\u30de\u30fcblog \nhttp://shinsuke789.hatenablog.jp/entry/2015/01/03/164203\n\n\u611f\u8b1d\n\u79d8\u66f8\u7f8e\u3055\u3093\u3001\u3068\u3063\u3066\u3082\u3044\u3044\u611f\u3058\u3067\u4e88\u5b9a\u3092\u6559\u3048\u3066\u304f\u308c\u3066\u3042\u308a\u304c\u3068\u3046\uff01\uff01\n\u79d8\u66f8\u7f8e\u3055\u3093\u30dc\u30c3\u30c8\u3082\u3001\u3061\u3083\u3093\u3068\u3064\u304f\u308a\u305f\u3044\u306a\u3002\n\u4eca\u306f\u3001SlackBot\u306e\u7c21\u5358\u30ab\u30b9\u30bf\u30de\u30a4\u30ba\u306a\u306e\u3067\u3001\u30a2\u30a4\u30b3\u30f3\u3068\u304b\u6b8b\u5ff5\u306a\u611f\u3058\u3002\n\n\n\n#\u6982\u8981\n\n\u672c\u65e5\u306e\u4e88\u5b9a\u3092\u79d8\u66f8\u304c\u6559\u3048\u3066\u304f\u308c\u305f\u3089\u3046\u308c\u3057\u3044\u3067\u3059\u3088\u306d\uff01\nslack\u30dc\u30c3\u30c8\u3067\u4f5c\u3063\u3066\u3057\u307e\u3044\u307e\u3057\u3087\u3046\u3002\n\u79d8\u66f8\u306e\u300c\u79d8\u66f8\u7f8e\u300d\u304c\u3001\u6bce\u671d\u4e88\u5b9a\u3092\u6559\u3048\u3066\u304f\u308c\u307e\u3059\u3002\n\n![slack \u79d8\u66f8\u7f8e\u3055\u3093\u304b\u3089\u306e\u4e88\u5b9a\u306e\u304a\u77e5\u3089\u305b.png](https://qiita-image-store.s3.amazonaws.com/0/49562/850e03bd-8de8-1422-1999-eec2d812c75a.png)\n\nGAS\u3067Google\u30ab\u30ec\u30f3\u30c0\u30fc\u306e\u4e88\u5b9a\u304b\u3089\u4eca\u65e5\u306e\u4e88\u5b9a\u3092\u30d4\u30c3\u30af\u30a2\u30c3\u30d7\u3057\u3001Incoming WebHook\u3067\u3001slack\u3078\u30dd\u30b9\u30c8\u3057\u307e\u3059\u3002\n\nGAS\u3092\u4f7f\u3046\u306e\u3067\u30b5\u30fc\u30d0\u30fc\u3082\u7279\u5225\u306b\u7528\u610f\u3059\u308b\u5fc5\u8981\u304c\u306a\u304f\u7c21\u5358\u3067\u3059\u3002\n\n\n\n#\u79d8\u66f8\u7f8e\u306e\u4f5c\u308a\u65b9\n\n##slack\u306eWebhook URL\u3092\u53d6\u5f97\n\nIntegrations - Incoming WebHooks \u3067\u53d6\u5f97\u3002\n\u300cPost to Channel\u300d\u306f\u3001\u9069\u5f53\u306a\u30c1\u30e3\u30f3\u30cd\u30eb\u3067\uff2f\uff2b\u3002\u30b9\u30af\u30ea\u30d7\u30c8\u3067\u30dd\u30b9\u30c8\u3059\u308b\u30c1\u30e3\u30f3\u30cd\u30eb\u306f\u6307\u5b9a\u3067\u304d\u307e\u3059\u3002\n\u300cWebhook URL\u300d\uff1a\u3053\u308c\u3092\u30e1\u30e2\u3063\u3066\u304a\u304d\u307e\u3059\u3002\n\n##\u30ab\u30ec\u30f3\u30c0\u30fcID\u306e\u53d6\u5f97\n\nGoogle\u30ab\u30ec\u30f3\u30c0\u30fc\u306e\u8a2d\u5b9a\u753b\u9762\u306e\u300c\u30ab\u30ec\u30f3\u30c0\u30fc\u306e\u30a2\u30c9\u30ec\u30b9:\u300d\u3063\u3066\u3068\u3053\u308d\u306b\u3001\u30ab\u30ec\u30f3\u30c0\u30fcID\u304c\u3072\u3087\u3046\u3058\u3055\u308c\u3066\u3044\u307e\u3059\u3002\uff08xxxxxx@xxxxxxx.google.com\u3000\u307f\u305f\u3044\u306a\u306e\uff09\n\u3053\u308c\u3092\u5fc5\u8981\u306a\u30ab\u30ec\u30f3\u30c0\u30fc\u5206\u30e1\u30e2\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n\n##GAS\u30b9\u30af\u30ea\u30d7\u30c8\u4f5c\u6210\n\n\u81ea\u5206\u306f\u9069\u5f53\u306a\u30b9\u30d7\u30ec\u30c3\u30c9\u30b7\u30fc\u30c8\u3092\u4f5c\u6210\u3057\u3001\n\u300c\u30c4\u30fc\u30eb\u300d-\u300c\u30b9\u30af\u30ea\u30d7\u30c8\u30a8\u30c7\u30a3\u30bf\u300d\n\u3067\u4f5c\u6210\u3057\u307e\u3057\u305f\u3002\n\n##\u30b9\u30af\u30ea\u30d7\u30c8\u30b3\u30fc\u30c9\u306e\u5165\u529b\n\n```js\n\n//\u79d8\u66f8\u7f8e\u304c\u4eca\u65e5\u306e\u4e88\u5b9a\u3092slack\u306b\u6295\u7a3f\u3057\u3066\u304f\u308c\u308b\n\nfunction myFunction() {\n  var list = \"\";\n  var s;\n  \n  s = listupEvent(\"xxxxxxxxxx@group.calendar.google.com\"); //\u4f11\u307f\n  if (s != \"\")  list += \"\\n\u25a0\u304a\u4f11\u307f\\n\" + s;\n  \n  s = listupEvent(\"xxxxxxxxxx@group.calendar.google.com\"); //\u540d\u53e4\u5c4b\n  if (s != \"\")  list += \"\\n\u25a0\u540d\u53e4\u5c4b\u306e\u3054\u4e88\u5b9a\\n\" + s;\n  \n  s = listupEvent(\"xxxxxxxxxx@group.calendar.google.com\"); //\u6771\u4eac\n  if (s != \"\")  list += \"\\n\u25a0\u6771\u4eac\u306e\u3054\u4e88\u5b9a\\n\" + s;\n  \n  s = listupEvent(\"xxxxxxxxxx@group.calendar.google.com\"); //SC\u8ab2\n  if (s != \"\")  list += \"\\n\u25a0\uff33\uff23\u8ab2\u306e\u3054\u4e88\u5b9a\\n\" + s;\n  \n  Logger.log(list);\n\n  if (list != \"\") {\n    var payload = {\n      \"text\" : \"\u672c\u65e5\u306e\u4e88\u5b9a\u3092\u304a\u77e5\u3089\u305b\u3057\u307e\u3059\u3002\\n\" + list,\n      \"channel\" : \"#random\",\n      \"username\" : \"\u79d8\u66f8\u7f8e\",\n      \"icon_emoji\" : \":information_desk_person:\"\n    }\n    \n    postSlack(payload);\n  }\n  \n}\n\n//\u672c\u65e5\u306e\u4e88\u5b9a\u3092\u30ea\u30b9\u30c8\u30a2\u30c3\u30d7\nfunction listupEvent(cal_id)\n{\n  var list = \"\";\n  var cal = CalendarApp.getCalendarById(cal_id);\n  var events = cal.getEventsForDay(new Date());\n  for(var i=0; i < events.length; i++){\n    s = \"\";\n    if (events[i].isAllDayEvent()) {\n      s += Utilities.formatDate(events[i].getStartTime(),\"GMT+0900\",\"MM/dd  \");\n    } else {\n      s += Utilities.formatDate(events[i].getStartTime(),\"GMT+0900\",\"MM/dd HH:mm\");\n      s += Utilities.formatDate(events[i].getEndTime(), \"GMT+0900\",\"-HH:mm  \");\n    }\n    s += events[i].getTitle();\n    Logger.log(s);\n    \n    list += s + \"\\n\";\n  }\n  \n  return list;\n}\n\n//slack\u3078\u30dd\u30b9\u30c8\nfunction postSlack(payload)\n{\n  // POST\u30aa\u30d7\u30b7\u30e7\u30f3\n  var options = {\n    \"method\" : \"POST\",\n    \"payload\" : JSON.stringify(payload)\n  }\n\n  // \u30a2\u30af\u30bb\u30b9\u5148\n  var url = \"https://hooks.slack.com/services/XXXXXX/XXXXXX/XXXXXXXXXXXXXXX\";\n  // POST\u30ea\u30af\u30a8\u30b9\u30c8\n  var response = UrlFetchApp.fetch(url, options);\n  // HTML\u7d50\u679c\u3092\u53d6\u5f97\uff08\u5f15\u6570\u306echarset\u306f\u8a2d\u5b9a\u3057\u305f\u307b\u3046\u304c\u826f\u3044\uff09\n  var content = response.getContentText(\"UTF-8\");\n  \n}\n```\n\u3053\u306e\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u3001\u6642\u9593\u6307\u5b9a\u306e\u30c8\u30ea\u30ac\u30fc\u3067\u6bce\u65e5\u5b9f\u884c\u3055\u305b\u3066\u3044\u307e\u3059\u3002\n\n\u4eca\u56de\u306f\u3001\uff14\u3064\u306e\u30ab\u30ec\u30f3\u30c0\u30fc\u304b\u3089\u4e88\u5b9a\u3092\u30d4\u30c3\u30af\u30a2\u30c3\u30d7\u3057\u3066\u3044\u307e\u3059\u3002\n\n      \"channel\" : \"#random\",\n      \"username\" : \"\u79d8\u66f8\u7f8e\",\n      \"icon_emoji\" : \":information_desk_person:\"\n\u3053\u306e\u3042\u305f\u308a\u3092\u5909\u66f4\u3059\u308b\u3053\u3068\u3067\u3001\n\u30fb\u30dd\u30b9\u30c8\u3059\u308b\u30c1\u30e3\u30f3\u30cd\u30eb\n\u30fb\u30dc\u30c3\u30c8\u306e\u540d\u524d\n\u30fb\u30dc\u30c3\u30c8\u306e\u30a2\u30a4\u30b3\u30f3\n\u3092\u5909\u66f4\u3067\u304d\u307e\u3059\u3002\n\n#\u53c2\u8003\n\n Google Apps Script\u3092\u4f7f\u3063\u3066\u307f\u3088\u3046! - \u30b5\u30c6\u30e9\u30a4\u30c8\u539f\u53e3\u793e\u9577\u306e\u30b9\u30af\u30ea\u30d7\u30c8\u6307\u5357 (6) \u4eca\u65e5\u306e\u4e88\u5b9a\u3092\u30ab\u30ec\u30f3\u30c0\u30fc\u304b\u3089\u30e1\u30fc\u30eb\u3067\u81ea\u52d5\u9001\u4fe1 | \u30de\u30a4\u30ca\u30d3\u30cb\u30e5\u30fc\u30b9 \nhttp://news.mynavi.jp/series/apps_script/006/\n\n  Google\u30b9\u30d7\u30ec\u30c3\u30c9\u30b7\u30fc\u30c8\u3067GET/POST\u901a\u4fe1\u3092\u884c\u3044\u30b3\u30f3\u30c6\u30f3\u30c4\u3092\u53d6\u5f97\u3059\u308b - Web\u30b5\u30fc\u30d3\u30b9\u3067\u8d77\u696d\u3092\u76ee\u6307\u3059\u30d7\u30ed\u30b0\u30e9\u30de\u30fcblog \nhttp://shinsuke789.hatenablog.jp/entry/2015/01/03/164203\n\n#\u611f\u8b1d\n\n\u79d8\u66f8\u7f8e\u3055\u3093\u3001\u3068\u3063\u3066\u3082\u3044\u3044\u611f\u3058\u3067\u4e88\u5b9a\u3092\u6559\u3048\u3066\u304f\u308c\u3066\u3042\u308a\u304c\u3068\u3046\uff01\uff01\n\n\u79d8\u66f8\u7f8e\u3055\u3093\u30dc\u30c3\u30c8\u3082\u3001\u3061\u3083\u3093\u3068\u3064\u304f\u308a\u305f\u3044\u306a\u3002\n\u4eca\u306f\u3001SlackBot\u306e\u7c21\u5358\u30ab\u30b9\u30bf\u30de\u30a4\u30ba\u306a\u306e\u3067\u3001\u30a2\u30a4\u30b3\u30f3\u3068\u304b\u6b8b\u5ff5\u306a\u611f\u3058\u3002\n\n![slack\u79d8\u66f8\u7f8e\u30dc\u30c3\u30c81.png](https://qiita-image-store.s3.amazonaws.com/0/49562/341d4fe2-fa76-9e4a-9ac1-34ec3278ae62.png)\n\n![slack\u79d8\u66f8\u7f8e\u30dc\u30c3\u30c82.png](https://qiita-image-store.s3.amazonaws.com/0/49562/963f01c8-a07d-cef6-b0af-664e54453a93.png)\n\n![slack\u79d8\u66f8\u7f8e\u30dc\u30c3\u30c83.png](https://qiita-image-store.s3.amazonaws.com/0/49562/910ccd14-1d16-28f0-7bdc-c121a0ee15c5.png)\n\n", "tags": ["Slack", "gas"]}