{"context": " More than 1 year has passed since last update.backlog\u2192hubot\u2192slack\u9023\u643a\nhttp://qiita.com/yo-iida/items/c69fe7b6afb2c082b822\n\u304b\u3089\u306e\u6d3e\u751f\u3067\u3001gitbucket\u306ewebhook\u3082\u4e0b\u8a18\u306e\u3088\u3046\u306a\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u3067\u3001\n\u7c21\u5358\u306bslack\u306b\u9023\u643a\u3067\u304d\u308b\u3002\nreq\u3067\u53d7\u3051\u53d6\u3063\u305f\u30ea\u30af\u30a8\u30b9\u30c8\u60c5\u5831\u306e\u4e2d\u304b\u3089\u3001\n\u5fc5\u8981\u306a\u60c5\u5831\u3092\u30d1\u30fc\u30b9\u3057\u3066message\u306b\u6574\u5f62\u3057\u3066\u3001\nslack\u306b\u6295\u3052\u308b\u3068\u3044\u3046\u305d\u308c\u3060\u3051\u306a\u306e\u3067\u3001\n\u5fc5\u8981\u306b\u5fdc\u3058\u3066\u30b3\u30d4\u30da\u3067\u3044\u308d\u3044\u308d\u306a\u9023\u643abot\u304c\u3064\u304f\u308c\u307e\u3059\u3002\n\ngitbucket-notification.coffee\n# Description:\n#   gitbucket to Slack\n#\n# Commands:\n#   None\n\nmodule.exports = (robot) ->\n  robot.router.post \"/gitbucket-to-slack/:room\", (req, res) ->\n    { room } = req.params\n    { body } = req\n\n    try\n\n      if body.payload\n\n        json = JSON.parse body.payload\n\n        message = \"==== commit info ====\\n\"\n        message += \"timestamp: #{json.commits[0].timestamp}\\n\"\n        message += \"id: #{json.commits[0].id}\\n\"\n        message += \"author: #{json.commits[0].author.name}<#{json.commits[0].author.email}>\\n\"\n        message += \"message: #{json.commits[0].message}\\n\"\n        message += \"url: #{json.commits[0].url}\\n\"\n\n        if message?\n            robot.messageRoom room, message\n            res.end \"OK\"\n        else\n            robot.messageRoom room, \"gitbucket integration error.\"\n            res.end \"Error\"\n    catch error\n      robot.send\n      res.end \"Error\"\n\n\nhttps://gist.github.com/yo-iida/89e6a5faef9c934dd7ca\n\nbacklog\u2192hubot\u2192slack\u9023\u643a\nhttp://qiita.com/yo-iida/items/c69fe7b6afb2c082b822\n\n\u304b\u3089\u306e\u6d3e\u751f\u3067\u3001gitbucket\u306ewebhook\u3082\u4e0b\u8a18\u306e\u3088\u3046\u306a\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u3067\u3001\n\u7c21\u5358\u306bslack\u306b\u9023\u643a\u3067\u304d\u308b\u3002\n\nreq\u3067\u53d7\u3051\u53d6\u3063\u305f\u30ea\u30af\u30a8\u30b9\u30c8\u60c5\u5831\u306e\u4e2d\u304b\u3089\u3001\n\u5fc5\u8981\u306a\u60c5\u5831\u3092\u30d1\u30fc\u30b9\u3057\u3066message\u306b\u6574\u5f62\u3057\u3066\u3001\nslack\u306b\u6295\u3052\u308b\u3068\u3044\u3046\u305d\u308c\u3060\u3051\u306a\u306e\u3067\u3001\n\u5fc5\u8981\u306b\u5fdc\u3058\u3066\u30b3\u30d4\u30da\u3067\u3044\u308d\u3044\u308d\u306a\u9023\u643abot\u304c\u3064\u304f\u308c\u307e\u3059\u3002\n\n```gitbucket-notification.coffee\n# Description:\n#   gitbucket to Slack\n#\n# Commands:\n#   None\n\nmodule.exports = (robot) ->\n  robot.router.post \"/gitbucket-to-slack/:room\", (req, res) ->\n    { room } = req.params\n    { body } = req\n\n    try\n\n      if body.payload\n\n        json = JSON.parse body.payload\n\n        message = \"==== commit info ====\\n\"\n        message += \"timestamp: #{json.commits[0].timestamp}\\n\"\n        message += \"id: #{json.commits[0].id}\\n\"\n        message += \"author: #{json.commits[0].author.name}<#{json.commits[0].author.email}>\\n\"\n        message += \"message: #{json.commits[0].message}\\n\"\n        message += \"url: #{json.commits[0].url}\\n\"\n\n        if message?\n            robot.messageRoom room, message\n            res.end \"OK\"\n        else\n            robot.messageRoom room, \"gitbucket integration error.\"\n            res.end \"Error\"\n    catch error\n      robot.send\n      res.end \"Error\"\n```\n\nhttps://gist.github.com/yo-iida/89e6a5faef9c934dd7ca\n", "tags": ["Hubot", "Slack", "GitBucket"]}