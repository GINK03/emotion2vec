{"tags": ["Perl", "VBA", "Ruby"], "context": " More than 1 year has passed since last update.\u30e2\u30b8\u30e5\u30e9\u30b943\u3002\n\n\u30e2\u30b8\u30e5\u30e9\u30b943\u3068\u30b3\u30d4\u30da\u6c5a\u67d3\n\n\u8abf\u3079\u305f\u30da\u30fc\u30b8\u3067\u3001\u5802\u3005\u3068\u4e2d\u9ed2\u304c\u5165\u3063\u3066\u3066\u300c\uff1f\uff1f\uff1f\u300d\u3063\u3066\u306a\u3063\u305f\u3002\n\nperl\nmy $i = 0 ;\nmy %h = map{ $_, $i ++ } split //, '0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ-. $/+%';\nmy %hr = reverse %h ;\n\nprint $hr{ +( eval join '+', map{ $h{$_} } split //, 'PIYOPIYO'  )  % 43 } ;\n\n\n\u30a2\u30db\u3060\u3001\u30c0\u30d6\u30eb\u30b3\u30fc\u30c6\u30fc\u30b7\u30e7\u30f3\u306b\u306a\u3063\u3066\u305f\u3002\u5909\u6570\u5c55\u958b\u3059\u308b\u3058\u3083\u3093\u3002\n\n\nVBA\nFunction modulus43(ByVal d As String)\n    Dim str As String\n    str = \"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ-. $/+%\"\n    Dim i As Integer\n    Dim j As Integer\n    Dim o As Integer\n\n    For i = 1 To Len(d)\n        For j = 0 To 42\n            If Mid(d, i, 1) = Mid(str, j + 1, 1) Then\n                o = o + j\n                Exit For\n            End If\n        Next j\n    Next i\n    modulus43 = Mid(str, (o Mod 43) + 1, 1)\nEnd Function\n\n\u9069\u5f53\u306a\u30bb\u30eb\u306b\u3066 =modulus43(A1) \u3068\u304b\u3059\u308b\u3001\u3001\u3001\n\nruby\na = \"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ-. $/+%\".split(\"\") \nh = (a).zip(0...a.size).to_h \nhr = h.invert\np hr[ \"PIYOPIYO\" .split(\"\").map{|x| h[x] }.inject(:+) % 43 ]\n\n.to_h \u306f\u3001ruby 2.1 \u304b\u3089\u3060\u305d\u30fc\u3067\u3002\n\n\u30e2\u30b8\u30e5\u30e9\u30b943\u3002\n\n- [\u30e2\u30b8\u30e5\u30e9\u30b943\u3068\u30b3\u30d4\u30da\u6c5a\u67d3](http://kozawa.jugem.cc/?eid=508)\n\n\u8abf\u3079\u305f\u30da\u30fc\u30b8\u3067\u3001\u5802\u3005\u3068\u4e2d\u9ed2\u304c\u5165\u3063\u3066\u3066\u300c\uff1f\uff1f\uff1f\u300d\u3063\u3066\u306a\u3063\u305f\u3002\n\n## perl\n\n```\nmy $i = 0 ;\nmy %h = map{ $_, $i ++ } split //, '0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ-. $/+%';\nmy %hr = reverse %h ;\n\nprint $hr{ +( eval join '+', map{ $h{$_} } split //, 'PIYOPIYO'  )  % 43 } ;\n```\n\n- \u30a2\u30db\u3060\u3001\u30c0\u30d6\u30eb\u30b3\u30fc\u30c6\u30fc\u30b7\u30e7\u30f3\u306b\u306a\u3063\u3066\u305f\u3002\u5909\u6570\u5c55\u958b\u3059\u308b\u3058\u3083\u3093\u3002\n\n## VBA\n\n```\nFunction modulus43(ByVal d As String)\n    Dim str As String\n    str = \"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ-. $/+%\"\n    Dim i As Integer\n    Dim j As Integer\n    Dim o As Integer\n\n    For i = 1 To Len(d)\n        For j = 0 To 42\n            If Mid(d, i, 1) = Mid(str, j + 1, 1) Then\n                o = o + j\n                Exit For\n            End If\n        Next j\n    Next i\n    modulus43 = Mid(str, (o Mod 43) + 1, 1)\nEnd Function\n```\n\n\u9069\u5f53\u306a\u30bb\u30eb\u306b\u3066 `=modulus43(A1)` \u3068\u304b\u3059\u308b\u3001\u3001\u3001\n\n## ruby\n\n```\na = \"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ-. $/+%\".split(\"\") \nh = (a).zip(0...a.size).to_h \nhr = h.invert\np hr[ \"PIYOPIYO\" .split(\"\").map{|x| h[x] }.inject(:+) % 43 ]\n```\n\n`.to_h` \u306f\u3001ruby 2.1 \u304b\u3089\u3060\u305d\u30fc\u3067\u3002\n"}