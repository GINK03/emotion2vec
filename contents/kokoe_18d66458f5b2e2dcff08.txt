{"context": " More than 1 year has passed since last update.\n\n\u3042\u3089\u3059\u3058\n\ncss\u3068\u304bjs\u3092GZip\u5316\u3057\u305f\u3044\u305c\uff5e\ngrunt-contrib-compress\u3067GZip\u751f\u6210\u3067\u304d\u305f\u305c\uff5e\ngrunt-contrib-connect\u3067\u30011\u306ecss\u3068js\u3092\u8aad\u307f\u8fbc\u3093\u3060html\u95b2\u89a7\u3057\u3066\u307f\u308b\u305c\uff5e\ngzip\u304c\u8aad\u307f\u8fbc\u307e\u308c\u306a\u3044\u305c\u3088\uff1f\uff01\n\n\u3063\u3066\u306a\u3053\u3068\u304c\u3042\u308a\u307e\u3057\u3066\u3002\ngrunt-contrib-connect\u306eoption\u3092\u30a2\u30ec\u30b3\u30ec\u8abf\u3079\u307e\u3057\u305f\u3089\u3001\u306a\u3093\u304bGZip\u5bfe\u5fdc\u3067\u304d\u305f\u3063\u307d\u3044\u306e\u3067\u30bd\u30fc\u30b9\u3055\u3089\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n\n\u74b0\u5883\n\nOS: Windows7\nNode.js: v0.10.8\ngrunt-contrib-connect: v0.9.0\n\u30d0\u30fc\u30b8\u30e7\u30f3\u304c\u53e4\u3044\u3068\u5f15\u6570middlewares\u306e\u60c5\u5831\u304c\u308f\u305f\u3063\u3066\u3053\u306a\u3044\u306e\u3067\u6ce8\u610f\u3002\n\n\n\u305d\u306e\u4ed6\u6ce8\u610f\n\n\u203bGZip\u30d5\u30a1\u30a4\u30eb\u3092\u751f\u6210\u3059\u308b\u969b\u3001.gz\u306e\u524d\u306b\u30d5\u30a1\u30a4\u30eb\u306e\u62e1\u5f35\u5b50\u3092\u6b8b\u3057\u3066\u304a\u304f\u3053\u3068\u304c\u524d\u63d0\u3068\u306a\u308a\u307e\u3059\u3002\u305d\u306e\u62e1\u5f35\u5b50\u3067Content-type\u3092\u5272\u308a\u5f53\u3066\u3066\u308b\u306e\u3067\u3002\n\u203b\u305d\u3082\u305d\u3082\u30d6\u30e9\u30a6\u30b6\u304cGZip\u30d5\u30a1\u30a4\u30eb\u5bfe\u5fdc\u3057\u3066\u3044\u308b\u5834\u5408\u306b\u9650\u308a\u307e\u3059\u3002\n\nmodule.exports = function(grunt) {\n    var compression = require('compression');\n\n    grunt.initConfig({\n        connect: {\n            options: {\n                port: 8000,    //\u3053\u3053\u306f\u3054\u81ea\u7531\u306b\n                hostname: '*', //\u3053\u3053\u306f\u3054\u81ea\u7531\u306b\n                middleware: function(connect, options, middlewares) {\n\n                    // gzip\u5bfe\u5fdc\n                    // Content-type\u306e\u632f\u308a\u5206\u3051\u306f\u3001\u30ea\u30af\u30a8\u30b9\u30c8URL\u540d\u304b\u3089\u5224\u5b9a\n                    function gzipFilter(req, res) {\n                        var url = req.url;\n\n                        // \u30ea\u30af\u30a8\u30b9\u30c8URL\u306b.jz.gz\u304c\u542b\u307e\u308c\u308b\u5834\u5408\n                        if (url.indexOf('.js.gz') > -1) {\n                            res.setHeader('Content-Encoding', 'gzip');\n                            res.setHeader('Content-Type', 'text/javascript');\n                        // \u30ea\u30af\u30a8\u30b9\u30c8URL\u306b.css.gz\u304c\u542b\u307e\u308c\u308b\u5834\u5408\n                        } else if (url.indexOf('.css.gz') > -1) {\n                            res.setHeader('Content-Encoding', 'gzip');\n                            res.setHeader('Content-Type', 'text/css');\n                        // \u30ea\u30af\u30a8\u30b9\u30c8URL\u306b.html.gz\u304c\u542b\u307e\u308c\u308b\u5834\u5408\n                        } else if (url.indexOf('.html.gz') > -1) {\n                            res.setHeader('Content-Encoding', 'gzip');\n                            res.setHeader('Content-Type', 'text/html');\n                        }\n\n                        if (req.headers['Content-Encoding'] === 'gzip') {\n                            return compression.filter(req, res);\n                        } else {\n                            return false;\n                        }\n                    }\n\n                    middlewares.unshift(\n                        compression({filter: gzipFilter})\n                    );\n\n                    return middlewares;\n                }\n            },\n\n            //\u3053\u3053\u306f\u3054\u81ea\u7531\u306b\n            hoge: {\n                options: {\n                    base: './hoge_root'\n                }\n            }\n        }\n    });\n\n    grunt.loadNpmTasks('grunt-contrib-connect');\n    grunt.registerTask('default', ['connect:hoge']);\n};\n\n\u3067\u3082\u3001livereload\u3068\u540c\u6642\u306b\u4f7f\u3046\u3053\u3068\u304c\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f\u3002\u306a\u3093\u305e\u3002\u3002\u3002\n\u5f53\u65b9\u3001\u30b5\u30fc\u30d0\u30fc\u30b5\u30a4\u30c9\u306e\u77e5\u8b58\u306b\u660e\u308b\u304f\u306a\u3044\u306e\u3067\u3001\u304a\u554f\u3044\u5408\u308f\u305b\u3082\u3089\u3063\u3066\u3082\u7b54\u3048\u3089\u308c\u306a\u3044\u6c17\u304c\u3057\u307e\u3059\u3002\u3002\n\u52d5\u3044\u305f\u4e00\u4f8b\u3068\u3057\u3066\u53c2\u8003\u306b\u3057\u3066\u3044\u305f\u3060\u3051\u308c\u3070\u3068\u3002\u3002\u3002m(_ _)m\n\n\u53c2\u8003URL\n\nhttps://github.com/gruntjs/grunt-contrib-connect\nhttps://github.com/gruntjs/grunt-contrib-connect/issues/77\nhttp://stackoverflow.com/questions/27964209/applying-gzip-compression-to-files-served-by-grunt-contrib-connect\nhttp://qiita.com/pirosikick/items/cadd77e85408e863b27e\n\n## \u3042\u3089\u3059\u3058\n\n1. css\u3068\u304bjs\u3092GZip\u5316\u3057\u305f\u3044\u305c\uff5e\n2. grunt-contrib-compress\u3067GZip\u751f\u6210\u3067\u304d\u305f\u305c\uff5e\n3. grunt-contrib-connect\u3067\u30011\u306ecss\u3068js\u3092\u8aad\u307f\u8fbc\u3093\u3060html\u95b2\u89a7\u3057\u3066\u307f\u308b\u305c\uff5e\n4. gzip\u304c\u8aad\u307f\u8fbc\u307e\u308c\u306a\u3044\u305c\u3088\uff1f\uff01\n\n\u3063\u3066\u306a\u3053\u3068\u304c\u3042\u308a\u307e\u3057\u3066\u3002\n\ngrunt-contrib-connect\u306eoption\u3092\u30a2\u30ec\u30b3\u30ec\u8abf\u3079\u307e\u3057\u305f\u3089\u3001\u306a\u3093\u304bGZip\u5bfe\u5fdc\u3067\u304d\u305f\u3063\u307d\u3044\u306e\u3067\u30bd\u30fc\u30b9\u3055\u3089\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n\n## \u74b0\u5883\n\n* OS: Windows7\n* Node.js: v0.10.8\n* grunt-contrib-connect: v0.9.0  \n\u30d0\u30fc\u30b8\u30e7\u30f3\u304c\u53e4\u3044\u3068\u5f15\u6570middlewares\u306e\u60c5\u5831\u304c\u308f\u305f\u3063\u3066\u3053\u306a\u3044\u306e\u3067\u6ce8\u610f\u3002\n\n## \u305d\u306e\u4ed6\u6ce8\u610f\n\n* \u203bGZip\u30d5\u30a1\u30a4\u30eb\u3092\u751f\u6210\u3059\u308b\u969b\u3001.gz\u306e\u524d\u306b\u30d5\u30a1\u30a4\u30eb\u306e\u62e1\u5f35\u5b50\u3092\u6b8b\u3057\u3066\u304a\u304f\u3053\u3068\u304c\u524d\u63d0\u3068\u306a\u308a\u307e\u3059\u3002\u305d\u306e\u62e1\u5f35\u5b50\u3067Content-type\u3092\u5272\u308a\u5f53\u3066\u3066\u308b\u306e\u3067\u3002\n* \u203b\u305d\u3082\u305d\u3082\u30d6\u30e9\u30a6\u30b6\u304cGZip\u30d5\u30a1\u30a4\u30eb\u5bfe\u5fdc\u3057\u3066\u3044\u308b\u5834\u5408\u306b\u9650\u308a\u307e\u3059\u3002\n\n```\nmodule.exports = function(grunt) {\n    var compression = require('compression');\n\n    grunt.initConfig({\n        connect: {\n            options: {\n                port: 8000,    //\u3053\u3053\u306f\u3054\u81ea\u7531\u306b\n                hostname: '*', //\u3053\u3053\u306f\u3054\u81ea\u7531\u306b\n                middleware: function(connect, options, middlewares) {\n\n                    // gzip\u5bfe\u5fdc\n                    // Content-type\u306e\u632f\u308a\u5206\u3051\u306f\u3001\u30ea\u30af\u30a8\u30b9\u30c8URL\u540d\u304b\u3089\u5224\u5b9a\n                    function gzipFilter(req, res) {\n                        var url = req.url;\n\n                        // \u30ea\u30af\u30a8\u30b9\u30c8URL\u306b.jz.gz\u304c\u542b\u307e\u308c\u308b\u5834\u5408\n                        if (url.indexOf('.js.gz') > -1) {\n                            res.setHeader('Content-Encoding', 'gzip');\n                            res.setHeader('Content-Type', 'text/javascript');\n                        // \u30ea\u30af\u30a8\u30b9\u30c8URL\u306b.css.gz\u304c\u542b\u307e\u308c\u308b\u5834\u5408\n                        } else if (url.indexOf('.css.gz') > -1) {\n                            res.setHeader('Content-Encoding', 'gzip');\n                            res.setHeader('Content-Type', 'text/css');\n                        // \u30ea\u30af\u30a8\u30b9\u30c8URL\u306b.html.gz\u304c\u542b\u307e\u308c\u308b\u5834\u5408\n                        } else if (url.indexOf('.html.gz') > -1) {\n                            res.setHeader('Content-Encoding', 'gzip');\n                            res.setHeader('Content-Type', 'text/html');\n                        }\n\n                        if (req.headers['Content-Encoding'] === 'gzip') {\n                            return compression.filter(req, res);\n                        } else {\n                            return false;\n                        }\n                    }\n\n                    middlewares.unshift(\n                        compression({filter: gzipFilter})\n                    );\n\n                    return middlewares;\n                }\n            },\n\n            //\u3053\u3053\u306f\u3054\u81ea\u7531\u306b\n            hoge: {\n                options: {\n                    base: './hoge_root'\n                }\n            }\n        }\n    });\n\n    grunt.loadNpmTasks('grunt-contrib-connect');\n    grunt.registerTask('default', ['connect:hoge']);\n};\n```\n\n\u3067\u3082\u3001livereload\u3068\u540c\u6642\u306b\u4f7f\u3046\u3053\u3068\u304c\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f\u3002\u306a\u3093\u305e\u3002\u3002\u3002\n\n\u5f53\u65b9\u3001\u30b5\u30fc\u30d0\u30fc\u30b5\u30a4\u30c9\u306e\u77e5\u8b58\u306b\u660e\u308b\u304f\u306a\u3044\u306e\u3067\u3001\u304a\u554f\u3044\u5408\u308f\u305b\u3082\u3089\u3063\u3066\u3082\u7b54\u3048\u3089\u308c\u306a\u3044\u6c17\u304c\u3057\u307e\u3059\u3002\u3002  \n\u52d5\u3044\u305f\u4e00\u4f8b\u3068\u3057\u3066\u53c2\u8003\u306b\u3057\u3066\u3044\u305f\u3060\u3051\u308c\u3070\u3068\u3002\u3002\u3002m(_ _)m\n\n## \u53c2\u8003URL\n\n* https://github.com/gruntjs/grunt-contrib-connect\n* https://github.com/gruntjs/grunt-contrib-connect/issues/77\n* http://stackoverflow.com/questions/27964209/applying-gzip-compression-to-files-served-by-grunt-contrib-connect\n* http://qiita.com/pirosikick/items/cadd77e85408e863b27e\n", "tags": ["grunt", "grunt-contrib-connect0.9.0"]}