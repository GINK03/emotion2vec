{"tags": ["Excel", "VBA", "ExcelVBA", "Windows"], "context": "\n\nExcel VBA\u3067.xlsx\u30d5\u30a1\u30a4\u30eb\u3092PDF\u306b\u4e00\u62ec\u5909\u63db\u3059\u308b\n\n\u80cc\u666f\nLinux\u30b5\u30fc\u30d0\u4e0a\u3067.xlsx\u5f62\u5f0f\u306e\u5e33\u7968\u3092\u51fa\u529b\u3059\u308b\u6a5f\u80fd\u3092\u5b9f\u88c5\u3057\u305f\u969b\u3001\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u304b\u3089\u300cPDF\u5f62\u5f0f\u306b\u3082\u3067\u304d\u306a\u3044\uff1f\u300d\u3068\u3044\u3046\u8981\u671b\u304c\u6765\u308b\u3068\u300c\u3050\u306c\u306c\u30fb\u30fb\u30fb\u300d\u3068\u3044\u3046\u3053\u3068\u306b\u306a\u308b\u5834\u5408\u304c\u3042\u308a\u307e\u3059\u3002\n\u4ee5\u524d\u3001Linux\u30b5\u30fc\u30d0\u4e0a\u306eOpenOffice\u3084LibreOffice\u3067.xlsx\u30d5\u30a1\u30a4\u30eb\u304b\u3089PDF\u3078\u306e\u5909\u63db\u3092\u8a66\u3057\u305f\u3053\u3068\u304c\u3042\u308b\u306e\u3067\u3059\u304c\u3001\u30d5\u30a9\u30f3\u30c8\u3084\u518d\u73fe\u6027\u306e\u554f\u984c\u304b\u3089\u5b9f\u7528\u7684\u3067\u306f\u3042\u308a\u307e\u305b\u3093\u3067\u3057\u305f\u3002\n\u305d\u3053\u3067\u4eca\u56de\u306f\u3001.xlsx\u30d5\u30a1\u30a4\u30eb\u3092PDF\u306b\u4e00\u62ec\u5909\u63db\u3059\u308bExcel VBA\u30de\u30af\u30ed\u3092\u5b9f\u88c5\u3057\u305f.xlsm\u30d5\u30a1\u30a4\u30eb\u3092\u4f7f\u3063\u3066\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u5074\u306eExcel\u3067\u4e00\u62ec\u5909\u63db\u3057\u3066\u3082\u3089\u304a\u3046\u3068\u601d\u3044\u307e\u3059\uff01\uff08\u3082\u3061\u308d\u3093\u5b9f\u969b\u306b\u306f\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u3068\u306e\u4ea4\u6e09\u6b21\u7b2c\u3067\u3059\u304c\u3002\u3002\u3002\uff09\n\n\u30de\u30af\u30ed\u5168\u5bb9\n\u4e0b\u8a18\u306e\u5185\u5bb9\u306e\u30de\u30af\u30ed\u3092\u5b9f\u88c5\u3057\u305f\u300cpdf.xlsm\u300d\u306e\u3088\u3046\u306a\u3082\u306e\u3092\u6e96\u5099\u3059\u308b\u60f3\u5b9a\u3067\u3059\u3002\nSub convertToPdf()\n  Dim buf As String\n  Dim cnt As Long\n  Dim files() As String\n  Dim rc As Integer\n  Dim item As Variant\n  Dim fullname As String\n  Dim fullnamePdf As String\n  Dim objExcel As Object 'Excel.Application\n  Dim objBook As Object 'Excel.Workbook\n  Dim objFs As Object 'Scripting.FilesystemObject\n\n  Set objFs = CreateObject(\"Scripting.FilesystemObject\")\n\n  buf = Dir(ThisWorkbook.Path & \"\\*.xlsx\")\n  cnt = 0\n  Do While buf <> \"\"\n    ReDim Preserve files(cnt)\n    files(cnt) = buf\n    cnt = cnt + 1\n    buf = Dir()\n  Loop\n\n  If cnt = 0 Then\n    MsgBox (\".xlsx\u30d5\u30a1\u30a4\u30eb\u304c\u898b\u3064\u304b\u3089\u306a\u3044\u305f\u3081\u7d42\u4e86\u3057\u307e\u3059\u3002\")\n  Else\n    rc = MsgBox(\".xlsx\u30d5\u30a1\u30a4\u30eb\u304c\" & cnt & \"\u4ef6\u898b\u3064\u304b\u308a\u307e\u3057\u305f\u3002\u4e00\u62ec\u5909\u63db\u51e6\u7406\u3092\u884c\u3044\u307e\u3059\u304b\uff1f\", vbYesNo + vbQuestion, \"\u78ba\u8a8d\")\n    If rc = vbYes Then\n      Set objExcel = CreateObject(\"Excel.Application\")\n      objExcel.Visible = False\n      For Each item In files()\n        fullname = ThisWorkbook.Path & \"\\\" & item\n        fullnamePdf = ThisWorkbook.Path & \"\\\" & objFs.GetBaseName(item) & \".pdf\"\n        Set objBook = objExcel.Workbooks.Open(fullname, , True)\n        objBook .ExportAsFixedFormat 0, fullnamePdf\n        objBook.Close (False)\n        Set objBook= Nothing\n      Next item\n      objExcel.Quit\n      Set objExcel = Nothing\n      MsgBox (\"\u51e6\u7406\u304c\u5b8c\u4e86\u3057\u307e\u3057\u305f\u3002\")\n    Else\n      MsgBox (\"\u51e6\u7406\u3092\u4e2d\u65ad\u3057\u307e\u3057\u305f\u3002\")\n    End If\n  End If\n\n  Set objFs = Nothing\nEnd Sub\n\n\n\u30de\u30af\u30ed\u89e3\u8aac\n\n.xlsx\u30d5\u30a1\u30a4\u30eb\u306e\u5217\u6319\n\u3053\u306e\u30de\u30af\u30ed\u306f.xlsm\u30d5\u30a1\u30a4\u30eb\u3067\u5229\u7528\u3059\u308b\u3053\u3068\u3092\u524d\u63d0\u3068\u3057\u3066\u3001.xlsm\u30d5\u30a1\u30a4\u30eb\u3068\u540c\u3058\u30d5\u30a9\u30eb\u30c0\u306b\u3042\u308b.xlsx\u30d5\u30a1\u30a4\u30eb\u3092\u5217\u6319\u3057\u307e\u3059\u3002\n  Set objFs = CreateObject(\"Scripting.FilesystemObject\")\n\n  buf = Dir(ThisWorkbook.Path & \"\\*.xlsx\")\n  cnt = 0\n  Do While buf <> \"\"\n    ReDim Preserve files(cnt)\n    files(cnt) = buf\n    cnt = cnt + 1\n    buf = Dir()\n  Loop\n\n\u5217\u6319\u3057\u305f\u30d5\u30a1\u30a4\u30eb\u540d\u306f files \u914d\u5217\u306b\u683c\u7d0d\u3057\u3001 cnt \u3067\u30d5\u30a1\u30a4\u30eb\u6570\u3092\u30ab\u30a6\u30f3\u30c8\u3057\u3066\u3044\u307e\u3059\u3002\n\n.xlsx\u30d5\u30a1\u30a4\u30eb\u3092PDF\u306b\u5909\u63db\nExcel\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u4f5c\u6210\u3057\u3066\u5225\u306eExcel\u3092\u8d77\u52d5\u3057\u3001 ExportAsFixedFormat \u3067\u5909\u63db\u3057\u307e\u3059\u3002PDF\u30d5\u30a1\u30a4\u30eb\u306f\u300choge.xlsx\u300d\u306b\u5bfe\u3057\u3066\u540c\u3058\u30d5\u30a9\u30eb\u30c0\u306b\u300choge.pdf\u300d\u3068\u3044\u3046\u30d5\u30a1\u30a4\u30eb\u540d\u3067\u4f5c\u6210\u3057\u307e\u3059\u3002\n      Set objExcel = CreateObject(\"Excel.Application\")\n      objExcel.Visible = False\n      For Each item In files()\n        fullname = ThisWorkbook.Path & \"\\\" & item\n        fullnamePdf = ThisWorkbook.Path & \"\\\" & objFs.GetBaseName(item) & \".pdf\"\n        Set objBook = objExcel.Workbooks.Open(fullname, , True)\n        objBook .ExportAsFixedFormat 0, fullnamePdf\n        objBook.Close (False)\n        Set objBook= Nothing\n      Next item\n      objExcel.Quit\n      Set objExcel = Nothing\n\n\n\u5f8c\u51e6\u7406\n\u4f5c\u6210\u3057\u305f\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u7834\u68c4\u3057\u307e\u3059\u3002\n  Set objFs = Nothing\n\n# Excel VBA\u3067.xlsx\u30d5\u30a1\u30a4\u30eb\u3092PDF\u306b\u4e00\u62ec\u5909\u63db\u3059\u308b\n\n## \u80cc\u666f\n\nLinux\u30b5\u30fc\u30d0\u4e0a\u3067.xlsx\u5f62\u5f0f\u306e\u5e33\u7968\u3092\u51fa\u529b\u3059\u308b\u6a5f\u80fd\u3092\u5b9f\u88c5\u3057\u305f\u969b\u3001\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u304b\u3089\u300cPDF\u5f62\u5f0f\u306b\u3082\u3067\u304d\u306a\u3044\uff1f\u300d\u3068\u3044\u3046\u8981\u671b\u304c\u6765\u308b\u3068\u300c\u3050\u306c\u306c\u30fb\u30fb\u30fb\u300d\u3068\u3044\u3046\u3053\u3068\u306b\u306a\u308b\u5834\u5408\u304c\u3042\u308a\u307e\u3059\u3002\n\n\u4ee5\u524d\u3001Linux\u30b5\u30fc\u30d0\u4e0a\u306eOpenOffice\u3084LibreOffice\u3067.xlsx\u30d5\u30a1\u30a4\u30eb\u304b\u3089PDF\u3078\u306e\u5909\u63db\u3092\u8a66\u3057\u305f\u3053\u3068\u304c\u3042\u308b\u306e\u3067\u3059\u304c\u3001\u30d5\u30a9\u30f3\u30c8\u3084\u518d\u73fe\u6027\u306e\u554f\u984c\u304b\u3089\u5b9f\u7528\u7684\u3067\u306f\u3042\u308a\u307e\u305b\u3093\u3067\u3057\u305f\u3002\n\n\u305d\u3053\u3067\u4eca\u56de\u306f\u3001.xlsx\u30d5\u30a1\u30a4\u30eb\u3092PDF\u306b\u4e00\u62ec\u5909\u63db\u3059\u308bExcel VBA\u30de\u30af\u30ed\u3092\u5b9f\u88c5\u3057\u305f.xlsm\u30d5\u30a1\u30a4\u30eb\u3092\u4f7f\u3063\u3066\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u5074\u306eExcel\u3067\u4e00\u62ec\u5909\u63db\u3057\u3066\u3082\u3089\u304a\u3046\u3068\u601d\u3044\u307e\u3059\uff01\uff08\u3082\u3061\u308d\u3093\u5b9f\u969b\u306b\u306f\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u3068\u306e\u4ea4\u6e09\u6b21\u7b2c\u3067\u3059\u304c\u3002\u3002\u3002\uff09\n\n## \u30de\u30af\u30ed\u5168\u5bb9\n\n\u4e0b\u8a18\u306e\u5185\u5bb9\u306e\u30de\u30af\u30ed\u3092\u5b9f\u88c5\u3057\u305f\u300cpdf.xlsm\u300d\u306e\u3088\u3046\u306a\u3082\u306e\u3092\u6e96\u5099\u3059\u308b\u60f3\u5b9a\u3067\u3059\u3002\n\n```\nSub convertToPdf()\n  Dim buf As String\n  Dim cnt As Long\n  Dim files() As String\n  Dim rc As Integer\n  Dim item As Variant\n  Dim fullname As String\n  Dim fullnamePdf As String\n  Dim objExcel As Object 'Excel.Application\n  Dim objBook As Object 'Excel.Workbook\n  Dim objFs As Object 'Scripting.FilesystemObject\n  \n  Set objFs = CreateObject(\"Scripting.FilesystemObject\")\n  \n  buf = Dir(ThisWorkbook.Path & \"\\*.xlsx\")\n  cnt = 0\n  Do While buf <> \"\"\n    ReDim Preserve files(cnt)\n    files(cnt) = buf\n    cnt = cnt + 1\n    buf = Dir()\n  Loop\n\n  If cnt = 0 Then\n    MsgBox (\".xlsx\u30d5\u30a1\u30a4\u30eb\u304c\u898b\u3064\u304b\u3089\u306a\u3044\u305f\u3081\u7d42\u4e86\u3057\u307e\u3059\u3002\")\n  Else\n    rc = MsgBox(\".xlsx\u30d5\u30a1\u30a4\u30eb\u304c\" & cnt & \"\u4ef6\u898b\u3064\u304b\u308a\u307e\u3057\u305f\u3002\u4e00\u62ec\u5909\u63db\u51e6\u7406\u3092\u884c\u3044\u307e\u3059\u304b\uff1f\", vbYesNo + vbQuestion, \"\u78ba\u8a8d\")\n    If rc = vbYes Then\n      Set objExcel = CreateObject(\"Excel.Application\")\n      objExcel.Visible = False\n      For Each item In files()\n        fullname = ThisWorkbook.Path & \"\\\" & item\n        fullnamePdf = ThisWorkbook.Path & \"\\\" & objFs.GetBaseName(item) & \".pdf\"\n        Set objBook = objExcel.Workbooks.Open(fullname, , True)\n        objBook .ExportAsFixedFormat 0, fullnamePdf\n        objBook.Close (False)\n        Set objBook= Nothing\n      Next item\n      objExcel.Quit\n      Set objExcel = Nothing\n      MsgBox (\"\u51e6\u7406\u304c\u5b8c\u4e86\u3057\u307e\u3057\u305f\u3002\")\n    Else\n      MsgBox (\"\u51e6\u7406\u3092\u4e2d\u65ad\u3057\u307e\u3057\u305f\u3002\")\n    End If\n  End If\n\n  Set objFs = Nothing\nEnd Sub\n```\n\n## \u30de\u30af\u30ed\u89e3\u8aac\n\n### .xlsx\u30d5\u30a1\u30a4\u30eb\u306e\u5217\u6319\n\n\u3053\u306e\u30de\u30af\u30ed\u306f.xlsm\u30d5\u30a1\u30a4\u30eb\u3067\u5229\u7528\u3059\u308b\u3053\u3068\u3092\u524d\u63d0\u3068\u3057\u3066\u3001.xlsm\u30d5\u30a1\u30a4\u30eb\u3068\u540c\u3058\u30d5\u30a9\u30eb\u30c0\u306b\u3042\u308b.xlsx\u30d5\u30a1\u30a4\u30eb\u3092\u5217\u6319\u3057\u307e\u3059\u3002\n\n```\n  Set objFs = CreateObject(\"Scripting.FilesystemObject\")\n  \n  buf = Dir(ThisWorkbook.Path & \"\\*.xlsx\")\n  cnt = 0\n  Do While buf <> \"\"\n    ReDim Preserve files(cnt)\n    files(cnt) = buf\n    cnt = cnt + 1\n    buf = Dir()\n  Loop\n```\n\n\u5217\u6319\u3057\u305f\u30d5\u30a1\u30a4\u30eb\u540d\u306f `files` \u914d\u5217\u306b\u683c\u7d0d\u3057\u3001 `cnt` \u3067\u30d5\u30a1\u30a4\u30eb\u6570\u3092\u30ab\u30a6\u30f3\u30c8\u3057\u3066\u3044\u307e\u3059\u3002\n\n## .xlsx\u30d5\u30a1\u30a4\u30eb\u3092PDF\u306b\u5909\u63db\n\nExcel\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u4f5c\u6210\u3057\u3066\u5225\u306eExcel\u3092\u8d77\u52d5\u3057\u3001 `ExportAsFixedFormat` \u3067\u5909\u63db\u3057\u307e\u3059\u3002PDF\u30d5\u30a1\u30a4\u30eb\u306f\u300choge.xlsx\u300d\u306b\u5bfe\u3057\u3066\u540c\u3058\u30d5\u30a9\u30eb\u30c0\u306b\u300choge.pdf\u300d\u3068\u3044\u3046\u30d5\u30a1\u30a4\u30eb\u540d\u3067\u4f5c\u6210\u3057\u307e\u3059\u3002\n\n```\n      Set objExcel = CreateObject(\"Excel.Application\")\n      objExcel.Visible = False\n      For Each item In files()\n        fullname = ThisWorkbook.Path & \"\\\" & item\n        fullnamePdf = ThisWorkbook.Path & \"\\\" & objFs.GetBaseName(item) & \".pdf\"\n        Set objBook = objExcel.Workbooks.Open(fullname, , True)\n        objBook .ExportAsFixedFormat 0, fullnamePdf\n        objBook.Close (False)\n        Set objBook= Nothing\n      Next item\n      objExcel.Quit\n      Set objExcel = Nothing\n```\n\n### \u5f8c\u51e6\u7406\n\n\u4f5c\u6210\u3057\u305f\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u7834\u68c4\u3057\u307e\u3059\u3002\n\n```\n  Set objFs = Nothing\n```\n"}