{"tags": ["MySQL", "PHP", "lamp", "CakePHP"], "context": "\n\n\u78ba\u8a8d\n\n\u69cb\u6210\n\u57fa\u672c\u7684\u306a LAMP \u74b0\u5883\u306b PHP \u30d5\u30ec\u30fc\u30e0\u30ef\u30fc\u30af\u306e CakePHP \u3067\u69cb\u7bc9\u3055\u308c\u3066\u3044\u305f\u30a6\u30a7\u30d6\u30b7\u30b9\u30c6\u30e0\u3002\n5\u5e74\u304f\u3089\u3044\u524d\u306b\u4f5c\u3089\u308c\u305f\u30b7\u30b9\u30c6\u30e0\u3089\u3057\u304f\u3001\u81ea\u5206\u306f\u30cf\u30fc\u30c9\u30a6\u30a7\u30a2\u3082\u30bd\u30d5\u30c8\u30a6\u30a7\u30a2\u3082\u69cb\u7bc9\u306b\u95a2\u4e0e\u3057\u3066\u3044\u306a\u304b\u3063\u305f\u306e\u3067\u624b\u63a2\u308a\u3067\u8abf\u67fb\u3002\n\n\u75c7\u72b6\n\u7279\u5b9a\u306e\u30da\u30fc\u30b8\u304c\u30a8\u30e9\u30fc\u306b\u306a\u308b\u3089\u3057\u3044\u3002\n\nCakePHP \u306e\u30a8\u30e9\u30fc\u30ed\u30b0\nError: [PDOException] SQLSTATE[HY000]: General error: 126 Incorrect key file for table '/tmp/#sql_******'; try to repair it\n\nIncorrect key file for table ?\n\n\u691c\u7d22\n\u3068\u308a\u3042\u3048\u305a\u602a\u3057\u3044\u30ad\u30fc\u30ef\u30fc\u30c9\u3092\u8abf\u3079\u307e\u3059\u3088\u306d\u3002\n\u305d\u3057\u305f\u3089\u4ee5\u4e0b\u306e\u8a18\u4e8b\u304c\u30d2\u30c3\u30c8\u3057\u305f\u308f\u3051\u3067\u3059\u3088\u3002\n15.2.4.1 MyISAM \u30c6\u30fc\u30d6\u30eb\u306e\u7834\u640d\n\u898b\u305f\u77ac\u9593\u6b7b\u3093\u3060\u306a\u3001\u3063\u3066\u601d\u3044\u307e\u3059\u3088\u306d\u3002\n\n\u7834\u640d\u3092\u78ba\u8a8d\nCHECK TABLE \u30b3\u30de\u30f3\u30c9\u3068\u3084\u3089\u3067\u78ba\u8a8d\u3067\u304d\u308b\u3068\u306e\u3053\u3068\u3067\u3001\u30a8\u30e9\u30fc\u306b\u306a\u3063\u3066\u3044\u308b\u30da\u30fc\u30b8\u3067\u30a2\u30af\u30bb\u30b9\u3057\u3066\u3044\u308b\u30c6\u30fc\u30d6\u30eb\u3092\u304b\u305f\u3063\u3071\u3057\u304b\u3089\u30c1\u30a7\u30c3\u30af\u3057\u3066\u898b\u308b\u3082\u306e\u306e\u3001\u30b9\u30c6\u30fc\u30bf\u30b9\u306f OK \u3060\u3063\u305f\u3002\n\u3053\u308c\u306f\u30a2\u30a6\u30c8\uff1f\u30bb\u30fc\u30d5\uff1f\n\n\u30b9\u30c6\u30fc\u30bf\u30b9 OK \u3092\u8ffd\u52a0\u3057\u3066\u518d\u5ea6\u691c\u7d22\nmysql\u3067Incorrect key file for table\n\u795e\u3088\uff01\n\u3061\u3087\u3063\u3068\u53e4\u3044\u8a18\u4e8b\u3060\u3051\u3069\u3001\u307e\u3055\u3057\u304f\u6c42\u3081\u3066\u3044\u305f\u8a18\u4e8b\u3002\n\u78ba\u304b\u306b\u3055\u3063\u304d\u306e\u30a8\u30e9\u30fc\u30e1\u30c3\u30bb\u30fc\u30b8\u306b /tmp \u304c\u306a\u3093\u305f\u3089\u3063\u3066\u51fa\u3066\u308b\u3082\u306e\u306d\u3002\n\n\u3055\u3063\u305d\u304f /tmp \u3092\u78ba\u8a8d\ndf -h /tmp\nFilesystem            Size  Used Avail Use% \u30de\u30a6\u30f3\u30c8\u4f4d\u7f6e\n/dev/mapper/vg_***-lv_root\n                       50G   49G   43M 100% /\n\n/tmp \u306b\u7a7a\u304d\u304c\u306a\u3044\u3068\u304b\u3044\u3046\u30ec\u30d9\u30eb\u3058\u3083\u306a\u3044\u3002\n/ \u304c\u30d1\u30f3\u30d1\u30f3\u3060\u3002\n\u3057\u304b\u3082\u8a73\u3057\u304f\u8abf\u3079\u3066\u898b\u308b\u3068\u3001 /var \u3068\u304b\u3082\u305d\u3053\u306b\u5165\u3063\u3066\u305f\u3002\n\u3082\u3061\u308d\u3093 /var/www \u3082 /var/log \u3082 /var/lib/mysql \u3082\u3002\n\u8981\u306f\u30a6\u30a7\u30d6\u30b7\u30b9\u30c6\u30e0\u542b\u3081\u3066\u30b5\u30fc\u30d0\u306e\u30b7\u30b9\u30c6\u30e0\u307b\u307c\u4e38\u3054\u3068 50GB \u3067\u8cc4\u304a\u3046\u3063\u3066\u8a2d\u8a08\u3089\u3057\u3044\u3002\n\u3046\u30fc\u3093\u30025\u5e74\u524d\u306f\u305d\u308c\u3067\u826f\u304b\u3063\u305f\u306e\u3060\u308d\u3046\u304b\u2026\u3002\n\u306a\u304a /home \u306f\u5358\u72ec\u3067\u5207\u3063\u3066\u3042\u3063\u3066\u3001\u5927\u91cf\u306b\u4f59\u3063\u3066\u305f\u3002\n\u307e\u3055\u304b\u3053\u308c OS \u3092\u30c7\u30d5\u30a9\u30eb\u30c8\u8a2d\u5b9a\u2026\uff1f\n\n\u30d5\u30a1\u30a4\u30eb\u3092\u524a\u9664\n\u3068\u308a\u3042\u3048\u305a\u4e0d\u8981\u4e0d\u6025\u306e\u53e4\u3044\u30d5\u30a1\u30a4\u30eb\u3092\u3044\u304f\u3089\u304b\u524a\u9664\u3057\u305f\u3068\u3053\u308d\u3001\u30a8\u30e9\u30fc\u306f\u89e3\u6d88\u3057\u305f\u3002\n\u305f\u3060\u3001\u3053\u308c\u306f\u5834\u5f53\u305f\u308a\u7684\u306a\u5bfe\u5fdc\u306a\u306e\u3067\u3001\u8fd1\u3044\u3046\u3061\u306b\u69cb\u6210\u304b\u3089\u898b\u76f4\u3055\u306a\u3044\u3068\u306a\u3089\u306a\u3044\u3068\u601d\u3046\u3002\n\n\u53c2\u8003\n\n15.2.4.1 MyISAM \u30c6\u30fc\u30d6\u30eb\u306e\u7834\u640d\nmysql\u3067Incorrect key file for table\n\n\n## \u78ba\u8a8d\n### \u69cb\u6210\n\u57fa\u672c\u7684\u306a LAMP \u74b0\u5883\u306b PHP \u30d5\u30ec\u30fc\u30e0\u30ef\u30fc\u30af\u306e CakePHP \u3067\u69cb\u7bc9\u3055\u308c\u3066\u3044\u305f\u30a6\u30a7\u30d6\u30b7\u30b9\u30c6\u30e0\u3002\n5\u5e74\u304f\u3089\u3044\u524d\u306b\u4f5c\u3089\u308c\u305f\u30b7\u30b9\u30c6\u30e0\u3089\u3057\u304f\u3001\u81ea\u5206\u306f\u30cf\u30fc\u30c9\u30a6\u30a7\u30a2\u3082\u30bd\u30d5\u30c8\u30a6\u30a7\u30a2\u3082\u69cb\u7bc9\u306b\u95a2\u4e0e\u3057\u3066\u3044\u306a\u304b\u3063\u305f\u306e\u3067\u624b\u63a2\u308a\u3067\u8abf\u67fb\u3002\n\n### \u75c7\u72b6\n\u7279\u5b9a\u306e\u30da\u30fc\u30b8\u304c\u30a8\u30e9\u30fc\u306b\u306a\u308b\u3089\u3057\u3044\u3002\n\n### CakePHP \u306e\u30a8\u30e9\u30fc\u30ed\u30b0\n`Error: [PDOException] SQLSTATE[HY000]: General error: 126 Incorrect key file for table '/tmp/#sql_******'; try to repair it`\n\n## `Incorrect key file for table` ?\n\n### \u691c\u7d22\n\u3068\u308a\u3042\u3048\u305a\u602a\u3057\u3044\u30ad\u30fc\u30ef\u30fc\u30c9\u3092\u8abf\u3079\u307e\u3059\u3088\u306d\u3002\n\u305d\u3057\u305f\u3089\u4ee5\u4e0b\u306e\u8a18\u4e8b\u304c\u30d2\u30c3\u30c8\u3057\u305f\u308f\u3051\u3067\u3059\u3088\u3002\n[15.2.4.1 MyISAM \u30c6\u30fc\u30d6\u30eb\u306e\u7834\u640d](http://dev.mysql.com/doc/refman/5.6/ja/corrupted-myisam-tables.html)\n\u898b\u305f\u77ac\u9593\u6b7b\u3093\u3060\u306a\u3001\u3063\u3066\u601d\u3044\u307e\u3059\u3088\u306d\u3002\n\n### \u7834\u640d\u3092\u78ba\u8a8d\n`CHECK TABLE` \u30b3\u30de\u30f3\u30c9\u3068\u3084\u3089\u3067\u78ba\u8a8d\u3067\u304d\u308b\u3068\u306e\u3053\u3068\u3067\u3001\u30a8\u30e9\u30fc\u306b\u306a\u3063\u3066\u3044\u308b\u30da\u30fc\u30b8\u3067\u30a2\u30af\u30bb\u30b9\u3057\u3066\u3044\u308b\u30c6\u30fc\u30d6\u30eb\u3092\u304b\u305f\u3063\u3071\u3057\u304b\u3089\u30c1\u30a7\u30c3\u30af\u3057\u3066\u898b\u308b\u3082\u306e\u306e\u3001\u30b9\u30c6\u30fc\u30bf\u30b9\u306f `OK` \u3060\u3063\u305f\u3002\n\u3053\u308c\u306f\u30a2\u30a6\u30c8\uff1f\u30bb\u30fc\u30d5\uff1f\n\n### \u30b9\u30c6\u30fc\u30bf\u30b9 OK \u3092\u8ffd\u52a0\u3057\u3066\u518d\u5ea6\u691c\u7d22\n[mysql\u3067Incorrect key file for table](http://d.hatena.ne.jp/fuki1234/20090727)\n\u795e\u3088\uff01\n\u3061\u3087\u3063\u3068\u53e4\u3044\u8a18\u4e8b\u3060\u3051\u3069\u3001\u307e\u3055\u3057\u304f\u6c42\u3081\u3066\u3044\u305f\u8a18\u4e8b\u3002\n\u78ba\u304b\u306b\u3055\u3063\u304d\u306e\u30a8\u30e9\u30fc\u30e1\u30c3\u30bb\u30fc\u30b8\u306b `/tmp` \u304c\u306a\u3093\u305f\u3089\u3063\u3066\u51fa\u3066\u308b\u3082\u306e\u306d\u3002\n\n### \u3055\u3063\u305d\u304f /tmp \u3092\u78ba\u8a8d\n`df -h /tmp`\n\n```\nFilesystem            Size  Used Avail Use% \u30de\u30a6\u30f3\u30c8\u4f4d\u7f6e\n/dev/mapper/vg_***-lv_root\n                       50G   49G   43M 100% /\n```\n\n`/tmp` \u306b\u7a7a\u304d\u304c\u306a\u3044\u3068\u304b\u3044\u3046\u30ec\u30d9\u30eb\u3058\u3083\u306a\u3044\u3002\n`/` \u304c\u30d1\u30f3\u30d1\u30f3\u3060\u3002\n\u3057\u304b\u3082\u8a73\u3057\u304f\u8abf\u3079\u3066\u898b\u308b\u3068\u3001 `/var` \u3068\u304b\u3082\u305d\u3053\u306b\u5165\u3063\u3066\u305f\u3002\n\u3082\u3061\u308d\u3093 `/var/www` \u3082 `/var/log` \u3082 `/var/lib/mysql` \u3082\u3002\n\u8981\u306f\u30a6\u30a7\u30d6\u30b7\u30b9\u30c6\u30e0\u542b\u3081\u3066\u30b5\u30fc\u30d0\u306e\u30b7\u30b9\u30c6\u30e0\u307b\u307c\u4e38\u3054\u3068 50GB \u3067\u8cc4\u304a\u3046\u3063\u3066\u8a2d\u8a08\u3089\u3057\u3044\u3002\n\u3046\u30fc\u3093\u30025\u5e74\u524d\u306f\u305d\u308c\u3067\u826f\u304b\u3063\u305f\u306e\u3060\u308d\u3046\u304b\u2026\u3002\n\u306a\u304a `/home` \u306f\u5358\u72ec\u3067\u5207\u3063\u3066\u3042\u3063\u3066\u3001\u5927\u91cf\u306b\u4f59\u3063\u3066\u305f\u3002\n\u307e\u3055\u304b\u3053\u308c OS \u3092\u30c7\u30d5\u30a9\u30eb\u30c8\u8a2d\u5b9a\u2026\uff1f\n\n### \u30d5\u30a1\u30a4\u30eb\u3092\u524a\u9664\n\u3068\u308a\u3042\u3048\u305a\u4e0d\u8981\u4e0d\u6025\u306e\u53e4\u3044\u30d5\u30a1\u30a4\u30eb\u3092\u3044\u304f\u3089\u304b\u524a\u9664\u3057\u305f\u3068\u3053\u308d\u3001\u30a8\u30e9\u30fc\u306f\u89e3\u6d88\u3057\u305f\u3002\n\u305f\u3060\u3001\u3053\u308c\u306f\u5834\u5f53\u305f\u308a\u7684\u306a\u5bfe\u5fdc\u306a\u306e\u3067\u3001\u8fd1\u3044\u3046\u3061\u306b\u69cb\u6210\u304b\u3089\u898b\u76f4\u3055\u306a\u3044\u3068\u306a\u3089\u306a\u3044\u3068\u601d\u3046\u3002\n\n\n## \u53c2\u8003\n* [15.2.4.1 MyISAM \u30c6\u30fc\u30d6\u30eb\u306e\u7834\u640d](http://dev.mysql.com/doc/refman/5.6/ja/corrupted-myisam-tables.html)\n* [mysql\u3067Incorrect key file for table](http://d.hatena.ne.jp/fuki1234/20090727)\n"}