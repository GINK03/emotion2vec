{"tags": ["R", "Python", "\u7d71\u8a08\u5b66", "statistics", "\u6a5f\u68b0\u5b66\u7fd2"], "context": "2016/01/09\u8ffd\u8a18\uff1a\u3053\u306e\u8a18\u4e8b\u306e\u7d9a\u7de8\u306f\u300cLasso\u306e\u7406\u8ad6\u3068\u5b9f\u88c5 -\u30b9\u30d1\u30fc\u30b9\u306a\u89e3\u306e\u63a8\u5b9a\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0-\u300d\u306b\u306a\u308a\u307e\u3059\uff0e\n2016/01/17\u8ffd\u8a18\uff1a\u6700\u5c24\u6cd5\u306b\u3088\u308b\u63a8\u5b9a\u65b9\u6cd5\u306e\u7c21\u5358\u306a\u8aac\u660e\u3092\u8ffd\u52a0\u3057\u307e\u3057\u305f\uff0e\n\n\u5c0e\u5165\nQiita\u3067\u91cd\u56de\u5e30\u3068\u691c\u7d22\u3092\u304b\u3051\u3066\u3082\u610f\u5916\u3068\u6570\u5f0f\u3067\u306e\u8aac\u660e\u304c\u306a\u304b\u3063\u305f\u306e\u3067\u4eca\u56de\u306f\u6570\u5f0f\u3067\u653b\u3081\u305f\u3044\u3068\u601d\u3044\u307e\u3059\uff0e\n\u4f8b\u984c\u3068\u3057\u3066\uff0cBoston\u30c7\u30fc\u30bf\u30bb\u30c3\u30c8\u3092\u4f7f\u3044\u307e\u3059\uff0e\nhttps://sense.io/csrudolflai/data-mining-with-r/files/Boston.csv\n\n\n\n\ncrim\nzn\nindus\nchas\nnox\nrm\nage\ndis\nrad\ntax\nptratio\nblack\nlstat\nmedv\n\n\n\n\n1\n0.00632\n18\n2.31\n0\n0.538\n6.575\n65.2\n4.0900\n1\n296\n15.3\n396.90\n4.98\n24.0\n\n\n2\n0.02731\n0\n7.07\n0\n0.469\n6.421\n78.9\n4.9671\n2\n242\n17.8\n396.90\n9.14\n21.6\n\n\n3\n0.02729\n0\n7.07\n0\n0.469\n7.185\n61.1\n4.9671\n2\n242\n17.8\n392.83\n4.03\n34.7\n\n\n4\n0.03237\n0\n2.18\n0\n0.458\n6.998\n45.8\n6.0622\n3\n222\n18.7\n394.63\n2.94\n33.4\n\n\n5\n0.06905\n0\n2.18\n0\n0.458\n7.147\n54.2\n6.0622\n3\n222\n18.7\n396.90\n5.33\n36.2\n\n\n\n\u4e0a\u306e\u30c7\u30fc\u30bf\u30bb\u30c3\u30c8\u306e\u5217\u306f\uff0c\u305d\u308c\u305e\u308c\u6b21\u306e\u3088\u3046\u306a\u3053\u3068\u3092\u610f\u5473\u3057\u3066\u3044\u307e\u3059\uff0e\n\n\n\ncolumn name\n\u5217\u540d\u306e\u610f\u5473\u3059\u308b\u3068\u3053\u308d\n\n\n\n\ncrim\n\u72af\u7f6a\u7387\n\n\nzn\n\u5b85\u5730\u306e\u5272\u5408\n\n\nindus\n\u975e\u5546\u7528\u5730\u306e\u5272\u5408\n\n\nchas\n\u30c1\u30e3\u30fc\u30eb\u30ba\u5ddd\u6d41\u57df\u304b\u3069\u3046\u304b\n\n\nnox\n\u7a92\u7d20\u9178\u5316\u7269\u6fc3\u5ea6\n\n\nrm\n\u5e73\u5747\u90e8\u5c4b\u6570\n\n\nage\n\u7bc9\u5e74\u6570\n\n\ndis\n\u30d3\u30b8\u30cd\u30b9\u5730\u533a\u3078\u306e\u8ddd\u96e2\n\n\nrad\n\u9ad8\u901f\u9053\u8def\u3078\u306e\u30a2\u30af\u30bb\u30b9\u6307\u6570\n\n\ntax\n\u56fa\u5b9a\u8cc7\u7523\u7a0e\n\n\nptratio\n\u5b66\u751f\u3068\u6559\u5e2b\u306e\u5272\u5408\n\n\nblack\n\u9ed2\u4eba\u306e\u5272\u5408\n\n\nlstat\n\u4f4e\u6240\u5f97\u8005\u306e\u5272\u5408\n\n\nmdev\n\u4f4f\u5b85\u4fa1\u683c\u306e\u4e2d\u592e\u5024\n\n\n\n\u3053\u306e\u30c7\u30fc\u30bf\u3092\u7528\u3044\u3066\uff0c\u6b21\u306e\u3088\u3046\u306a\u3053\u3068\u3092\u8003\u3048\u307e\u3059\uff0e\n\u4f4f\u5b85\u4fa1\u683c\u306e\u4e2d\u592e\u5024\u3092\uff0c\u76ee\u7684\u5909\u6570\u3068\u3057\u3066\uff0c\u305d\u306e\u4ed6\u5909\u6570(e.g., \u72af\u7f6a\u7387)\u3092\u8aac\u660e\u5909\u6570\u3068\u3057\u3066\u4e88\u6e2c\u30e2\u30c7\u30eb\u3092\u7acb\u3066\u305f\u3044\uff0e\u3064\u307e\u308a\uff0c\n$$\n\u4f4f\u5b85\u4fa1\u683c\u4e2d\u592e\u5024 = \\beta_0 + \\beta_1 \\times \u72af\u7f6a\u7387 + \\beta_2 \\times \u4f4f\u5b85\u306e\u5272\u5408 + \\cdots + \\beta_{13} \\times \u4f4e\u6240\u5f97\u8005\u5c64\u306e\u5272\u5408\n$$\n\u3068\u8868\u73fe\u3067\u304d\u308b\u3088\u3046\u306a$\\beta_0, \\beta_1, \\cdots, \\beta_{13}$\u3092\u6c42\u3081\u305f\u3044\uff0e\n\n\u30e2\u30c7\u30eb\u5f0f\u306e\u78ba\u8a8d\n\u3082\u3046\u5c11\u3057\u4e00\u822c\u5316\u3057\u305f\u3082\u306e\u3092\u8003\u3048\u3066\u307f\u307e\u3059\uff0e\u4ee5\u4e0b\u306e\u8868\u306e\u76ee\u7684\u5909\u6570$y$\u3092$p$\u500b\u306e\u8aac\u660e\u5909\u6570$x_1 \\cdots x_p$\u3067\u4e88\u6e2c\u3059\u308b\u30e2\u30c7\u30eb\u3092\u4f5c\u6210\u3057\u305f\u3044\uff0e\n\n\n\nindex\n$y$\n$x_1$\n$x_2$\n$\\cdots$\n$x_p$\n\n\n\n\n$1$\n$y_1$\n$x_{11}$\n$x_{12}$\n$\\cdots$\n$x_{1p}$\n\n\n$2$\n$y_2$\n$x_{21}$\n$x_{22}$\n$\\cdots$\n$x_{2p}$\n\n\n$\\vdots$\n$\\vdots$\n$\\vdots$\n$\\vdots$\n$\\vdots$\n$\\vdots$\n\n\n$i$\n$y_i$\n$x_{i1}$\n$x_{i2}$\n$\\cdots$\n$x_{ip}$\n\n\n$\\vdots$\n$\\vdots$\n$\\vdots$\n$\\vdots$\n$\\vdots$\n$\\vdots$\n\n\n$n$\n$y_n$\n$x_{n1}$\n$x_{n2}$\n$\\cdots$\n$x_{np}$\n\n\n\n\u91cd\u56de\u5e30\u30e2\u30c7\u30eb(multiple regression model)\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u8868\u3055\u308c\u307e\u3059\uff0e\n$$\ny = \\beta_0 + \\beta_1x_1 + \\cdots + \\beta_px_p + \\epsilon\n$$\n\u3053\u306e\u3068\u304d\uff0c\u4e0a\u306e\u8868\u306b\u304a\u3044\u3066$i$\u756a\u76ee\u30c7\u30fc\u30bf\u306f\n$$\ny_i = \\beta_0 + \\beta_1x_{i1} + \\cdots + \\beta_px_{ip} + \\epsilon_i\n$$\n\u3068\u8868\u305b\u308b\uff0e\n\u30d9\u30af\u30c8\u30eb\u3092\u7528\u3044\u3066\u8868\u3059\u3068\uff0c\n$$\n\\begin{bmatrix}\ny_1 \\\\\n\\vdots \\\\\ny_n\n\\end{bmatrix} =\n\\begin{bmatrix}\n1 & x_{11} & \\cdots & x_{1p} \\\\\n\\vdots & \\vdots & \\ddots & \\vdots \\\\\n1 & x_{n1} & \\cdots & x_{np}\n\\end{bmatrix}\n\\begin{bmatrix}\n\\beta_0 \\\\\n\\vdots \\\\\n\\beta_p\n\\end{bmatrix} +\n\\begin{bmatrix}\n\\epsilon_1 \\\\\n\\vdots \\\\\n\\epsilon_n\n\\end{bmatrix}\n$$\n\u3068\u306a\u308a\uff0c\n$$\n\\boldsymbol{y}\n =\n\\begin{bmatrix}\ny_1 \\\\\n\\vdots \\\\\ny_n\n\\end{bmatrix}\n$$\n$$\n\\boldsymbol{X}=\n\\begin{bmatrix}\n1 & x_{11} & \\cdots & x_{1p} \\\\\n\\vdots & \\vdots & \\ddots & \\vdots \\\\\n1 & x_{n1} & \\cdots & x_{np}\n\\end{bmatrix}\n$$\n$$\n\\boldsymbol{\\beta}=\n\\begin{bmatrix}\n\\beta_0 \\\\\n\\vdots \\\\\n\\beta_p\n\\end{bmatrix}\n$$\n$$\n\\boldsymbol{\\epsilon}=\n\\begin{bmatrix}\n\\epsilon_1 \\\\\n\\vdots \\\\\n\\epsilon_n\n\\end{bmatrix}\n$$\n\u3068\u304a\u304f\u3068\uff0c\n$$\n\\boldsymbol{y} = \\boldsymbol{X}\\boldsymbol{\\beta} + \\boldsymbol{\\epsilon}\n$$\n\u3068\u8868\u3059\u3053\u3068\u304c\u3067\u304d\u307e\u3059\uff0e\n\u78ba\u8a8d\u3067\u3059\u304c\uff0c\n\n$\\boldsymbol{y}$\uff1an\u6b21\u5143\u306e\u89b3\u6e2c\u30d9\u30af\u30c8\u30eb\n$\\boldsymbol{X}$\uff1an\u00d7(p+1)\u6b21\u5143\u306e\u8a08\u753b\u884c\u5217(design matrix)\n\n$\\boldsymbol{\\beta}$\uff1a(p+1)\u6b21\u5143\u306e\u56de\u5e30\u4fc2\u6570\u30d9\u30af\u30c8\u30eb (\u3053\u308c\u3092\u6c42\u3081\u305f\u3044\uff0e)\n$\\boldsymbol{\\epsilon}$\uff1an\u6b21\u5143\u306e\u8aa4\u5dee\u30d9\u30af\u30c8\u30eb\n\n\u3068\u306a\u308a\u307e\u3059\uff0e\n\n\u6700\u5c0f\u4e8c\u4e57\u6cd5\u306b\u3088\u308b\u63a8\u5b9a\n\u672a\u77e5\u30d1\u30e9\u30e1\u30fc\u30bf\u3067\u3042\u308b$\\boldsymbol{\\beta}$\u3092\u6700\u5c0f\u4e8c\u4e57\u6cd5\u306b\u3088\u308a\u63a8\u5b9a\u3057\u3066\u3044\u304d\u307e\u3059\uff0e\n\u4e8c\u4e57\u8aa4\u5dee\u3067\u3042\u308b\n$$\n\\boldsymbol{S}(\\boldsymbol{\\beta}) = \\sum_{i=1}^{n}{\\epsilon_i^2} = \\boldsymbol{\\epsilon}^T\\boldsymbol{\\epsilon}\n= (\\boldsymbol{y}-\\boldsymbol{X}\\boldsymbol{\\beta})^T(\\boldsymbol{y}-\\boldsymbol{X}\\boldsymbol{\\beta})\n$$\n\u3092\u6700\u5c0f\u306b\u3059\u308b$\\boldsymbol{\\beta}$\u3092\u6c42\u3081\u308b\uff0e\u5f0f\u3092\u5c55\u958b\u3057\u3066\uff0c\n$$\n\\begin{align*}\n\\boldsymbol{S}(\\boldsymbol{\\beta})\u3000& = (\\boldsymbol{y}-\\boldsymbol{X}\\boldsymbol{\\beta})^T(\\boldsymbol{y}-\\boldsymbol{X}\\boldsymbol{\\beta}) \\\\\n& = (\\boldsymbol{y}^T-(\\boldsymbol{X}\\boldsymbol{\\beta})^T)(\\boldsymbol{y}-\\boldsymbol{X}\\boldsymbol{\\beta}) \\\\\n& = (\\boldsymbol{y}^T-\\boldsymbol{\\beta}^T\\boldsymbol{X}^T)(\\boldsymbol{y}-\\boldsymbol{X}\\boldsymbol{\\beta}) \\\\\n& = \\boldsymbol{y}^T\\boldsymbol{y} - \\boldsymbol{\\beta}^T\\boldsymbol{X}^T\\boldsymbol{y}-\\boldsymbol{y}^T\\boldsymbol{X}\\boldsymbol{\\beta} + \\boldsymbol{\\beta}^T\\boldsymbol{X}^T\\boldsymbol{X}\\boldsymbol{\\beta} \\\\\n& = \\boldsymbol{y}^T\\boldsymbol{y} -2\\boldsymbol{y}^T\\boldsymbol{X}\\boldsymbol{\\beta} + \\boldsymbol{\\beta}^T\\boldsymbol{X}^T\\boldsymbol{X}\\boldsymbol{\\beta}\n\\end{align*}\n$$\n\u3053\u308c\u3092$\\boldsymbol{\\beta}$\u3067\u5fae\u5206\u3057\u3066\uff0c\n$$\n\\frac{\\boldsymbol{S}(\\boldsymbol{\\beta})}{\\partial \\boldsymbol{\\beta}}= -2\\boldsymbol{X}^T\\boldsymbol{y} + 2\\boldsymbol{X}^T\\boldsymbol{X}\\boldsymbol{\\beta}\n$$\n$\\frac{\\boldsymbol{S}(\\boldsymbol{\\beta})}{\\partial \\boldsymbol{\\beta}} = 0$\u3068\u304a\u3044\u3066\uff0c\n$$\n\\begin{align*}\n-2\\boldsymbol{X}^T\\boldsymbol{y} + 2\\boldsymbol{X}^T\\boldsymbol{X}\\boldsymbol{\\beta} & = 0 \\\\\n\\boldsymbol{X}^T\\boldsymbol{X}\\boldsymbol{\\beta} = \\boldsymbol{X}^T\\boldsymbol{y}\n\\end{align*}\n$$\n\u3082\u3057$(\\boldsymbol{X}^T\\boldsymbol{X})^{-1}$\u304c\u5b58\u5728\u3059\u308b\u306a\u3089\uff0c\n$$\n\\boldsymbol{\\beta} = (\\boldsymbol{X}^T\\boldsymbol{X})^{-1}\\boldsymbol{X}^T\\boldsymbol{y}\n$$\n\u3068\u6c42\u3081\u308b\u3053\u3068\u304c\u3067\u304d\u308b\uff0e\n\n\u6700\u5c24\u6cd5\u306b\u3088\u308b\u63a8\u5b9a\n\u53c2\u8003\uff1a\u30c7\u30fc\u30bf\u89e3\u6790 R\u306b\u3088\u308b\u591a\u5909\u91cf\u89e3\u6790\u5165\u9580 (7) \u6700\u5c24\u6cd5\uff0c\u30e2\u30c7\u30eb\u9078\u629e\n\u91cd\u56de\u5e30\u5f0f\n$$\n\\boldsymbol{y} = \\boldsymbol{X\\beta} + \\boldsymbol{\\epsilon}\n$$\n\u306e\u8aa4\u5dee\u30d9\u30af\u30c8\u30eb $\\boldsymbol{\\epsilon}$ \u304c\u591a\u5909\u91cf\u6b63\u898f\u5206\u5e03\u306b\u5f93\u3046\u3082\u306e\u3068\u4eee\u5b9a\u3059\u308b\uff0e\n\\boldsymbol{\\epsilon} \\sim N_n(\\boldsymbol{0}, \\sigma^2\\boldsymbol{I}_n)\n\n\u3053\u306e\u3068\u304d\uff0c\n$$\n\\boldsymbol{y} \\sim N_n(\\boldsymbol{X\\beta}, \\sigma^2\\boldsymbol{I}_n)\n$$\n\u3068\u306a\u308a\uff0c\u78ba\u7387\u5bc6\u5ea6\u95a2\u6570\u306f\uff0c\n$$\nf(\\boldsymbol{y} | \\boldsymbol{X}, \\boldsymbol{\\beta}, \\sigma^2) = \\frac{1}{(2\\pi\\sigma^2\\boldsymbol{I}_n)^{n/2}}\\exp \\biggl[ - \\frac{1}{2\\sigma^2}(\\boldsymbol{y}-\\boldsymbol{X\\beta})^T(\\boldsymbol{y}-\\boldsymbol{X\\beta}) \\biggr]\uff0e\n$$\n\u5c24\u5ea6\u306f\uff0c\n$$\nL(\\boldsymbol{\\beta}, \\sigma^2 | \\boldsymbol{X}, \\boldsymbol{y})=f(\\boldsymbol{y} | \\boldsymbol{X}, \\boldsymbol{\\beta}, \\sigma^2)\n$$\n\u3067\u3042\u308b\u304b\u3089\uff0c\u5bfe\u6570\u5c24\u5ea6\u306f\uff0c\n\\begin{align*}\n\\ell (\\boldsymbol{\\beta}, \\sigma^2| \\boldsymbol{X}, \\boldsymbol{y}) & = \\log L(\\boldsymbol{\\beta}, \\sigma^2 | \\boldsymbol{X}, \\boldsymbol{y})\\\\\n& = - \\frac{n}{2} \\log (2\\pi\\sigma^2) - \\frac{1}{2\\sigma^2}(\\boldsymbol{y}-\\boldsymbol{X\\beta})^T(\\boldsymbol{y}-\\boldsymbol{X\\beta})\n\\end{align*}\n\n\u3068\u306a\u308a\uff0c\u6700\u5c24\u63a8\u5b9a\u91cf\u306f\uff0c\n$$\n\\hat{\\boldsymbol{\\beta}} = (\\boldsymbol{X}^T\\boldsymbol{X})^{-1}\\boldsymbol{X}^T\\boldsymbol{y}\n$$\n$$\n\\hat{\\sigma}^2 = \\frac{1}{n}(\\boldsymbol{y}-\\boldsymbol{X\\hat{\\beta}})^T(\\boldsymbol{y}-\\boldsymbol{X\\hat{\\beta}})\n$$\n\u6700\u5c0f\u4e8c\u4e57\u6cd5\u3068\u540c\u69d8\u306e\u7d50\u679c\u304c\u5f97\u3089\u308c\u305f\uff0e\n\n\u5b9f\u88c5\n\u4ee5\u4e0b\u306e\u5b9f\u88c5\u3067\u306f\uff0c\u8aac\u660e\u5909\u6570\u540c\u58eb\u3092\u540c\u3058\u5c3a\u5ea6\u3067\u8a55\u4fa1\u3059\u308b\u305f\u3081\u306b$\\boldsymbol{X}$\u306e\u5404\u8aac\u660e\u5909\u6570\u6bce\u306b\u57fa\u6e96\u5316\u3092\u884c\u3063\u3066\u3044\u307e\u3059\uff0e\n\u57fa\u6e96\u5316(normalization)\u306f\u3044\u3046\u307e\u3067\u3082\u306a\u304f\uff0c\u5e73\u5747\u5024($\\mu$)\u3092\u5f15\u3044\u3066\u6a19\u6e96\u504f\u5dee($\\sigma$)\u3067\u5272\u308b\u3053\u3068\u306b\u3088\u308a\uff0c\u5e73\u5747\u50240\u5206\u65631\u306b\u3059\u308b\u3053\u3068\u3067\u3059\uff0e\nz_i = \\frac{x_i - \\mu}{\\sigma}\n\n\nPython\n\n\u884c\u5217\u6f14\u7b97\u306b\u3088\u308b\u5b9f\u88c5\n\n\u30b3\u30fc\u30c9\n\nimport pandas as pd\nimport numpy as np\nfrom numpy import linalg as la\n\ndf = pd.read_csv(\"Boston.csv\", index_col=0)\ny = df.iloc[:,  13].values\ndf = (df - df.mean())/df.std() # \u57fa\u6e96\u5316\nX = df.iloc[:, :13].values\nX = np.column_stack((np.ones(len(X)),X))\nbeta = np.dot(np.dot(la.inv(np.dot(X.T, X)),X.T), y)\nprint beta\n\n\n\u51fa\u529b\n\n[  2.25328063e+01  -9.29064566e-01   1.08263896e+00   1.41039433e-01\n   6.82414381e-01  -2.05875361e+00   2.67687661e+00   1.94853355e-02\n  -3.10711605e+00   2.66485220e+00  -2.07883689e+00  -2.06264585e+00\n   8.50108862e-01  -3.74733185e+00]\n\n\nscikit-learn\u306b\u3088\u308b\u5b9f\u88c5\n\n\u30b3\u30fc\u30c9\n\nimport pandas as pd\nimport numpy as np\nimport sklearn.linear_model as lm\n\ndf = pd.read_csv(\"Boston.csv\", index_col=0)\ny = df.iloc[:,  13].values\ndf = (df - df.mean())/df.std() # \u57fa\u6e96\u5316\nX = df.iloc[:, :13].values\n\nmodel = lm.LinearRegression()\nmodel.fit(X, y)\n\nprint model.intercept_\nprint model.coef_\n\n\n\u51fa\u529b\n\n22.5328063241\n[-0.92906457  1.08263896  0.14103943  0.68241438 -2.05875361  2.67687661\n  0.01948534 -3.10711605  2.6648522  -2.07883689 -2.06264585  0.85010886\n -3.74733185]\n\n\nR\n\n\u884c\u5217\u6f14\u7b97\u306b\u3088\u308b\u5b9f\u88c5\n\n\u30b3\u30fc\u30c9\n\nlibrary(MASS)\nX <- as.matrix(Boston[, -14])\ny <- as.vector(Boston[,  14])\nX <- scale(X) #\u57fa\u6e96\u5316\nX <- cbind(rep(1, nrow(X)), X)\nbeta <- solve(t(X)%*%X) %*% t(X) %*% y\nprint(beta)\n\n\n\u51fa\u529b\n\n               [,1]\n        22.53280632\ncrim    -0.92906457\nzn       1.08263896\nindus    0.14103943\nchas     0.68241438\nnox     -2.05875361\nrm       2.67687661\nage      0.01948534\ndis     -3.10711605\nrad      2.66485220\ntax     -2.07883689\nptratio -2.06264585\nblack    0.85010886\nlstat   -3.74733185\n\n\nlm\u95a2\u6570\u306b\u3088\u308b\u5b9f\u88c5\n\n\u30b3\u30fc\u30c9\n\nlibrary(MASS)\nX <- as.matrix(Boston[, -14])\ny <- as.vector(Boston[,  14])\nX <- scale(X) #\u57fa\u6e96\u5316\nmodel <- lm(y ~ X)\nprint(model)\n\n\n\u51fa\u529b\n\nCall:\nlm(formula = y ~ X)\n\nCoefficients:\n(Intercept)        Xcrim          Xzn       Xindus        Xchas\n   22.53281     -0.92906      1.08264      0.14104      0.68241\n       Xnox          Xrm         Xage         Xdis         Xrad\n   -2.05875      2.67688      0.01949     -3.10712      2.66485\n       Xtax     Xptratio       Xblack       Xlstat\n   -2.07884     -2.06265      0.85011     -3.74733\n\n\u3088\u3063\u3066\u6c42\u3081\u305f\u304b\u3063\u305f\u4e88\u6e2c\u30e2\u30c7\u30eb\u306f\uff0c\n$$\n\\begin{align*}\n\u4f4f\u5b85\u4fa1\u683c\u306e\u4e2d\u592e\u5024 = 22.53 - 0.93 \\times \u72af\u7f6a\u7387 + 1.08 \\times \u5b85\u5730\u306e\u5272\u5408 + \\cdots -3.73 \\times \u4f4e\u6240\u5f97\u8005\u306e\u5272\u5408\n\\end{align*}\n$$\n\u306e\u3088\u3046\u306b\u306a\u308a\u307e\u3059\uff0e\nPython\u304a\u3088\u3073R\u306e\u5b9f\u884c\u7d50\u679c\u304b\u3089\uff0c\u30dc\u30b9\u30c8\u30f3\u306e\u4f4f\u5b85\u4fa1\u683c\u306b\u306f\u300c\u4f4e\u6240\u5f97\u8005\u5c64\u306e\u5272\u5408\u300d\u304c\u4e00\u756a\u5f71\u97ff\u3092\u4e0e\u3048\u3066\u3044\u308b\u3053\u3068\u304c\u308f\u304b\u308b\uff0e\u5f53\u305f\u308a\u524d\u3068\u3044\u3048\u3070\u5f53\u305f\u308a\u524d\u3060\uff0e\n\n\u6b63\u5247\u5316\n\n\u306a\u305c\u6b63\u5247\u5316\u3059\u308b\u306e\u304b\n\n\u6700\u5c0f\u4e8c\u4e57\u63a8\u5b9a\u91cf\u3092\u6c42\u3081\u3089\u308c\u306a\u3044\u30b1\u30fc\u30b9\n\u5148\u307b\u3069\u306e\u30e2\u30c7\u30eb\u306b\u3064\u3044\u3066\uff0c$\\boldsymbol{\\beta}$\u3092\u6c42\u3081\u308b\u306b\u306f\uff0c$(\\boldsymbol{X}^T\\boldsymbol{X})^{-1}$\u304c\u5b58\u5728\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\uff0e\n$$\n\\boldsymbol{\\beta} = (\\boldsymbol{X}^T\\boldsymbol{X})^{-1}\\boldsymbol{X}^T\\boldsymbol{y}\n$$\n$(\\boldsymbol{X}^T\\boldsymbol{X})^{-1}$\u304c\u5b58\u5728\u3057\u306a\u3044\u3068\u306f\u3069\u306e\u3088\u3046\u306a\u30b1\u30fc\u30b9\u304b\u8003\u3048\u3066\u307f\u308b\u3068\uff0c\u305d\u308c\u306f$\\boldsymbol{X}$\u306e\u968e\u6570\u304c\u30d5\u30eb\u30e9\u30f3\u30af\u3067\u306a\u3044\u6642\u3060\u3068\u308f\u304b\u308a\u307e\u3059\uff0e$\\boldsymbol{X}$\u306e\u968e\u6570\u304c\u30d5\u30eb\u30e9\u30f3\u30af\u306b\u306a\u3089\u306a\u3044\u306e\u306f\u6b21\u306e\u3088\u3046\u306a\u539f\u56e0\u304c\u8003\u3048\u3089\u308c\u307e\u3059\uff0e\n\n\u8aac\u660e\u5909\u6570\u9593\u306e\u76f8\u95a2\u304c\u5f37\u3044\u3068\u304d\n$n < p$\u3068\u306a\u308b\u3068\u304d\n\n\u4ed6\u306b\u3082\u30de\u30eb\u30c1\u30b3\u306a\u3069\u304c\u8003\u3048\u3089\u308c\u307e\u3059\u304c\uff0c\u79c1\u306e\u7406\u89e3\u304c\u8ffd\u3044\u3064\u3044\u3066\u3044\u306a\u3044\u306e\u3067\u5272\u611b\u3057\u307e\u3059\uff0e(\u3054\u3081\u3093\u306a\u3055\u3044)\n\u4eee\u306b\u8aac\u660e\u5909\u6570\u306b\u5168\u304f\u540c\u3058\u3082\u306e\u3092\u8ffd\u52a0\u3057\u3066\uff0c\u5148\u307b\u3069\u306e\u30b3\u30fc\u30c9\u3092\u5b9f\u884c\u3057\u3066\u307f\u307e\u3059\uff0e\n\nR\u30b3\u30fc\u30c9\n\nlibrary(MASS)\nX <- as.matrix(Boston[, -14])\ny <- as.vector(Boston[,  14])\nX <- scale(X)\nX <- cbind(X, X[, 13]) # 13\u756a\u76ee\u306e\u8aac\u660e\u5909\u6570\u309214\u756a\u76ee\u306e\u8aac\u660e\u5909\u6570\u3092\u3068\u3057\u3066\u8ffd\u52a0\nX <- cbind(rep(1, nrow(X)), X)\nbeta <- solve(t(X)%*%X) %*% t(X) %*% y\n\n\n\u51fa\u529b\n\n solve.default(t(X) %*% X) \u3067\u30a8\u30e9\u30fc:\n  Lapack routine dgesv: \u30b7\u30b9\u30c6\u30e0\u306f\u6b63\u78ba\u306b\u7279\u7570\u3067\u3059: U[15,15] = 0\n\n\u3068\u306a\u308a\uff0c\u76f8\u95a2\u304c1\u3068\u306a\u308b\u5909\u6570\u304c2\u3064\u6f5c\u3093\u3067\u3044\u308b\u305f\u3081\uff0c$\\boldsymbol{X}$\u306e\u968e\u6570\u304c\u30d5\u30eb\u30e9\u30f3\u30af\u3067\u306a\u304f\u306a\u308a\uff0c$(\\boldsymbol{X}^T\\boldsymbol{X})^{-1}$\u3092\u6c42\u3081\u308b\u3053\u3068\u3067\u304d\u306a\u304f\u306a\u308a\u307e\u3059\uff0e\n> cor(X[, 13], X[, 14])\n[1] 1\n\n\n\u6700\u5c0f\u4e8c\u4e57\u63a8\u5b9a\u91cf\u3092\u6c42\u3081\u3089\u308c\u306a\u3044\u30b1\u30fc\u30b9\u3078\u306e\u5bfe\u51e6\u6cd5\n\u3067\u306f\u5148\u7a0b\u306e\u30b1\u30fc\u30b9\u3067\u306f\u3069\u3046\u3059\u308c\u3070\u3088\u3044\u304b\uff0e\u6b21\u306e\u5bfe\u51e6\u6cd5\u304c\u8003\u3048\u3089\u308c\u308b\uff0e\n\n\u76f8\u95a2\u304c\u5f37\u3044\u8aac\u660e\u5909\u6570\u540c\u58eb\u3092\u5165\u308c\u306a\u3044\u3088\u3046\u306b\u3059\u308b\n\u64ec\u4f3c\u9006\u884c\u5217\u3092\u7528\u3044\u3044\u308b\uff0e\n$(\\boldsymbol{X}^T\\boldsymbol{X})$\u306e\u9006\u884c\u5217\u304c\u6c42\u307e\u308b\u3088\u3046\u306b\u3057\u3066\u3042\u3052\u308b\n\n\u592a\u5b57\u90e8\u5206\u304c\u6b63\u5247\u5316\u3067\uff0c\u4eca\u56de\u306f\u3053\u308c\u306b\u6ce8\u76ee\u3057\u3066\u307f\u307e\u3059\uff0e\u3053\u308c\u306f\u3069\u3046\u3044\u3046\u3053\u3068\u304b\u3068\u3044\u3046\u3068\uff0c$(\\boldsymbol{X}^T\\boldsymbol{X})^{-1}$\u3092$(\\boldsymbol{X}^T\\boldsymbol{X}+ \\lambda\\boldsymbol{I_{p+1}})^{-1}$\u306e\u3088\u3046\u306b\u4f55\u304b\u8db3\u3059\u3053\u3068\u306b\u3088\u3063\u3066\u9006\u884c\u5217\u304c\u6c42\u307e\u308b\u3088\u3046\u306b\u3059\u308b\u3068\u3044\u3046\u3053\u3068\uff0e($\\boldsymbol{I}$\u306f\u5358\u4f4d\u884c\u5217\uff0e)\u3064\u307e\u308a\u6c42\u3081\u308b\u63a8\u5b9a\u91cf\u306f\u6b21\u306e\u3088\u3046\u306b\u306a\u308b\uff0e\n$$\n\\boldsymbol{\\beta_{\\lambda}} = (\\boldsymbol{X}^T\\boldsymbol{X}+ \\lambda\\boldsymbol{I_{p+1}})^{-1}\\boldsymbol{X}^T\\boldsymbol{y} \\cdots (*)\n$$\n(\u3069\u3046\u3057\u3066\u3053\u308c\u3067\u9006\u884c\u5217\u304c\u6c42\u307e\u308b\u3088\u3046\u306b\u306a\u308b\u304b\u306f\u5272\u611b\uff0e)\n\u3053\u306e\u3088\u3046\u306b\u6b63\u5247\u3067\u306a\u3044\u884c\u5217\u3092\u6b63\u5247\u306b\u3059\u308b\u3053\u3068\u306b\u3088\u3063\u3066\u63a8\u5b9a\u91cf\u3092\u5f97\u308b\u65b9\u6cd5\u3092\u6b63\u5247\u5316(regularization)\u3068\u3044\u3046\u3089\u3057\u3044\uff0e\n$\\lambda(>0)$\u306f\u6b63\u5247\u5316\u30d1\u30e9\u30e1\u30fc\u30bf\u3068\u547c\u3070\u308c\u308b\uff0e\n\u7279\u306b\uff0c$(*)$\u306fL2\u6b63\u5247\u5316\u306b\u3088\u308b\u63a8\u5b9a\u91cf\u3067\u3042\u308b(\u5f8c\u8ff0)\uff0e\n\nL2\u6b63\u5247\u5316\n\n\u5c0e\u51fa\n$(*)$\u3092\u5f97\u308b\u306b\u306f\uff0c\n$$\n\\begin{align*}\n\\boldsymbol{S_{\\lambda}}(\\boldsymbol{\\beta})\n& = (\\boldsymbol{y}-\\boldsymbol{X}\\boldsymbol{\\beta})^T(\\boldsymbol{y}-\\boldsymbol{X}\\boldsymbol{\\beta}) + \\lambda\\boldsymbol{\\beta^T\\beta} \\\\\n& = ||\\boldsymbol{y}-\\boldsymbol{X}\\boldsymbol{\\beta}||^2 + \\lambda||\\boldsymbol{\\beta}||^2\n\\end{align*}\n$$\n\u3092\u8aa4\u5dee\u95a2\u6570\u3068\u3057\u3066$\\boldsymbol{\\beta}$\u3092\u63a8\u5b9a\u3057\u3066\u3084\u308c\u3070\u3088\u3044\uff0e\u3053\u308c\u3092L2\u6b63\u5247\u5316\u3068\u3044\u3046\uff0e$\\lambda||\\boldsymbol{\\beta}||^2$\u306f\u30da\u30ca\u30eb\u30c6\u30a3\u9805\u3068\u547c\u3070\u308c\uff0c\u3053\u308c\u3092\u8a2d\u3051\u308b\u3053\u3068\u306b\u3088\u308a\uff0c\u904e\u5b66\u7fd2\u3092\u6291\u3048\u6c4e\u5316\u80fd\u529b\u3092\u9ad8\u3081\u308b\u3053\u3068\u304c\u3067\u304d\u308b\uff0e\u5b9f\u969b\u306b\u5c0e\u51fa\u3057\u3066\u307f\u308b\uff0e\n$$\n\\begin{align*}\n\\boldsymbol{S_{\\lambda}}(\\boldsymbol{\\beta})\n& = ||\\boldsymbol{y}-\\boldsymbol{X}\\boldsymbol{\\beta}||^2 + \\lambda||\\boldsymbol{\\beta}||^2 \\\\\n& = (\\boldsymbol{y}-\\boldsymbol{X}\\boldsymbol{\\beta})^T(\\boldsymbol{y}-\\boldsymbol{X}\\boldsymbol{\\beta}) + \\lambda\\boldsymbol{\\beta}^T\\boldsymbol{\\beta} \\\\\n& = (\\boldsymbol{y}^T-(\\boldsymbol{X}\\boldsymbol{\\beta})^T)(\\boldsymbol{y}-\\boldsymbol{X}\\boldsymbol{\\beta})+ \\lambda\\boldsymbol{\\beta}^T\\boldsymbol{\\beta} \\\\\n& = (\\boldsymbol{y}^T-\\boldsymbol{\\beta}^T\\boldsymbol{X}^T)(\\boldsymbol{y}-\\boldsymbol{X}\\boldsymbol{\\beta})+ \\lambda\\boldsymbol{\\beta}^T\\boldsymbol{\\beta} \\\\\n& = \\boldsymbol{y}^T\\boldsymbol{y} - \\boldsymbol{\\beta}^T\\boldsymbol{X}^T\\boldsymbol{y} - \\boldsymbol{y}^T\\boldsymbol{X}\\boldsymbol{\\beta} + \\boldsymbol{\\beta}^T\\boldsymbol{X}^T\\boldsymbol{X\\beta} + \\lambda\\boldsymbol{\\beta}^T\\boldsymbol{\\beta} \\\\\n& = \\boldsymbol{y}^T\\boldsymbol{y} - 2 \\boldsymbol{\\beta}^T\\boldsymbol{X}^T\\boldsymbol{y} + \\boldsymbol{\\beta}^T\\boldsymbol{X}^T\\boldsymbol{X\\beta}+ \\lambda\\boldsymbol{\\beta}^T\\boldsymbol{\\beta} \\\\\n\\end{align*}\n$$\n\u3053\u308c\u3092$\\boldsymbol{\\beta}$\u3067\u5fae\u5206\u3057\u3066\uff0c\n$$\n\\frac{\\boldsymbol{S_{\\lambda}}(\\boldsymbol{\\beta})}{\\partial \\boldsymbol{\\beta}}= -2\\boldsymbol{X}^T\\boldsymbol{y} + 2\\boldsymbol{X}^T\\boldsymbol{X}\\boldsymbol{\\beta} + 2\\lambda\\boldsymbol{\\beta}\n$$\n$\\frac{\\boldsymbol{S_{\\lambda}}(\\boldsymbol{\\beta})}{\\partial \\boldsymbol{\\beta}} = 0$\u3068\u304a\u3044\u3066\uff0c\n$$\n-2 \\boldsymbol{X}^T\\boldsymbol{y} + 2\\boldsymbol{X}^T\\boldsymbol{X}\\boldsymbol{\\beta} + 2\\lambda\\boldsymbol{\\beta} = 0 \\\\\n(\\boldsymbol{X}^T\\boldsymbol{X}+\\lambda\\boldsymbol{I_{p+1}})\\boldsymbol{\\beta} = \\boldsymbol{X}^T \\boldsymbol{y} \\\\\n\\boldsymbol{\\beta} = (\\boldsymbol{X}^T\\boldsymbol{X} + \\lambda \\boldsymbol{I_{p+1}})^{-1}\\boldsymbol{X}^T\\boldsymbol{y}\n\\cdots (*)\u306b\u540c\u3058\uff0e\n$$\n\n\u5b9f\u88c5\n\u6700\u5f8c\u306b\uff0c\u76f8\u95a2\u304c1\u3068\u306a\u308b\u3088\u3046\u306a\u30c7\u30fc\u30bf\u304c\u5165\u3063\u3066\u3044\u308b\u3068\u304d\u3067\u3082\uff0cL2\u6b63\u5247\u5316\u3092\u884c\u3046\u3053\u3068\u306b\u3088\u308a\u63a8\u5b9a\u91cf\u304c\u6c42\u307e\u308b\u306e\u304bR\u3067\u5b9f\u88c5\u3057\u3066\u307f\u307e\u3059\uff0e\n\nR\u30b3\u30fc\u30c9\n\nlibrary(MASS)\nX <- as.matrix(Boston[, -14])\ny <- as.vector(Boston[,  14])\nX <- scale(X)\nX <- cbind(X, X[, 13]) # 13\u756a\u76ee\u306e\u8aac\u660e\u5909\u6570\u309214\u756a\u76ee\u306e\u8aac\u660e\u5909\u6570\u3092\u3068\u3057\u3066\u8ffd\u52a0\nX <- cbind(rep(1, nrow(X)), X)\nlambda <- 0.001\nbeta <- solve(t(X)%*%X + lambda*diag(ncol(X))) %*% t(X) %*% y\nprint(beta)\n\n\n\u51fa\u529b\n\n               [,1]\n        22.53276179\ncrim    -0.92905477\nzn       1.08262398\nindus    0.14101604\nchas     0.68241750\nnox     -2.05872447\nrm       2.67688066\nage      0.01948267\ndis     -3.10708854\nrad      2.66477986\ntax     -2.07876854\nptratio -2.06263709\nblack    0.85010730\nlstat   -1.87366482\n        -1.87366482\n\n\u4eca\u5ea6\u306f\u3061\u3083\u3093\u3068\u6c42\u307e\u308a\u307e\u3057\u305f\uff01\n\n\u6700\u5f8c\u306b\n\u4eca\u56de\u306f\u91cd\u56de\u5e30\u30e2\u30c7\u30eb\u3068L2\u6b63\u5247\u5316\u306b\u3064\u3044\u3066\u6271\u3044\u307e\u3057\u305f\uff0e\u6b21\u56de\u306fL1\u6b63\u5247\u5316\uff0c\u30b9\u30d1\u30fc\u30b9\u63a8\u5b9a\u306b\u3064\u3044\u3066\u6271\u3044\u305f\u3044\u3068\u601d\u3044\u307e\u3059\uff0e\n2016/01/09\u8ffd\u8a18\uff1a\u3053\u306e\u8a18\u4e8b\u306e\u7d9a\u7de8\u306f\u300cLasso\u306e\u7406\u8ad6\u3068\u5b9f\u88c5 -\u30b9\u30d1\u30fc\u30b9\u306a\u89e3\u306e\u63a8\u5b9a\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0-\u300d\u306b\u306a\u308a\u307e\u3059\uff0e\n\n\u53c2\u8003\n\nhttp://www.geocities.co.jp/Technopolis/5893/2-1.pdf\nPython: Boston \u30c7\u30fc\u30bf\u30bb\u30c3\u30c8\u3067\u7dda\u5f62\u56de\u5e30\u5206\u6790\u3092\u5b66\u3076\n\n**2016/01/09\u8ffd\u8a18\uff1a\u3053\u306e\u8a18\u4e8b\u306e\u7d9a\u7de8\u306f\u300c[Lasso\u306e\u7406\u8ad6\u3068\u5b9f\u88c5 -\u30b9\u30d1\u30fc\u30b9\u306a\u89e3\u306e\u63a8\u5b9a\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0-](http://qiita.com/hogefugabar/items/71916560f7efc6eededf)\u300d\u306b\u306a\u308a\u307e\u3059\uff0e**\n**2016/01/17\u8ffd\u8a18\uff1a\u6700\u5c24\u6cd5\u306b\u3088\u308b\u63a8\u5b9a\u65b9\u6cd5\u306e\u7c21\u5358\u306a\u8aac\u660e\u3092\u8ffd\u52a0\u3057\u307e\u3057\u305f\uff0e**\n\n# \u5c0e\u5165\nQiita\u3067\u91cd\u56de\u5e30\u3068\u691c\u7d22\u3092\u304b\u3051\u3066\u3082\u610f\u5916\u3068\u6570\u5f0f\u3067\u306e\u8aac\u660e\u304c\u306a\u304b\u3063\u305f\u306e\u3067\u4eca\u56de\u306f\u6570\u5f0f\u3067\u653b\u3081\u305f\u3044\u3068\u601d\u3044\u307e\u3059\uff0e\n\n\u4f8b\u984c\u3068\u3057\u3066\uff0c[Boston\u30c7\u30fc\u30bf\u30bb\u30c3\u30c8](https://raw.githubusercontent.com/hogefugabar/Lasso/master/Boston.csv)\u3092\u4f7f\u3044\u307e\u3059\uff0e\n\nhttps://sense.io/csrudolflai/data-mining-with-r/files/Boston.csv\n\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>crim</th>\n      <th>zn</th>\n      <th>indus</th>\n      <th>chas</th>\n      <th>nox</th>\n      <th>rm</th>\n      <th>age</th>\n      <th>dis</th>\n      <th>rad</th>\n      <th>tax</th>\n      <th>ptratio</th>\n      <th>black</th>\n      <th>lstat</th>\n      <th>medv</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>1</th>\n      <td>0.00632</td>\n      <td>18</td>\n      <td>2.31</td>\n      <td>0</td>\n      <td>0.538</td>\n      <td>6.575</td>\n      <td>65.2</td>\n      <td>4.0900</td>\n      <td>1</td>\n      <td>296</td>\n      <td>15.3</td>\n      <td>396.90</td>\n      <td>4.98</td>\n      <td>24.0</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>0.02731</td>\n      <td>0</td>\n      <td>7.07</td>\n      <td>0</td>\n      <td>0.469</td>\n      <td>6.421</td>\n      <td>78.9</td>\n      <td>4.9671</td>\n      <td>2</td>\n      <td>242</td>\n      <td>17.8</td>\n      <td>396.90</td>\n      <td>9.14</td>\n      <td>21.6</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>0.02729</td>\n      <td>0</td>\n      <td>7.07</td>\n      <td>0</td>\n      <td>0.469</td>\n      <td>7.185</td>\n      <td>61.1</td>\n      <td>4.9671</td>\n      <td>2</td>\n      <td>242</td>\n      <td>17.8</td>\n      <td>392.83</td>\n      <td>4.03</td>\n      <td>34.7</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>0.03237</td>\n      <td>0</td>\n      <td>2.18</td>\n      <td>0</td>\n      <td>0.458</td>\n      <td>6.998</td>\n      <td>45.8</td>\n      <td>6.0622</td>\n      <td>3</td>\n      <td>222</td>\n      <td>18.7</td>\n      <td>394.63</td>\n      <td>2.94</td>\n      <td>33.4</td>\n    </tr>\n    <tr>\n      <th>5</th>\n      <td>0.06905</td>\n      <td>0</td>\n      <td>2.18</td>\n      <td>0</td>\n      <td>0.458</td>\n      <td>7.147</td>\n      <td>54.2</td>\n      <td>6.0622</td>\n      <td>3</td>\n      <td>222</td>\n      <td>18.7</td>\n      <td>396.90</td>\n      <td>5.33</td>\n      <td>36.2</td>\n    </tr>\n  </tbody>\n</table>\n\n\u4e0a\u306e\u30c7\u30fc\u30bf\u30bb\u30c3\u30c8\u306e\u5217\u306f\uff0c\u305d\u308c\u305e\u308c\u6b21\u306e\u3088\u3046\u306a\u3053\u3068\u3092\u610f\u5473\u3057\u3066\u3044\u307e\u3059\uff0e\n\n|column name|\u5217\u540d\u306e\u610f\u5473\u3059\u308b\u3068\u3053\u308d|\n|:---:|:---:|\n|crim|\u72af\u7f6a\u7387|\n|zn|\u5b85\u5730\u306e\u5272\u5408|\n|indus|\u975e\u5546\u7528\u5730\u306e\u5272\u5408|\n|chas|\u30c1\u30e3\u30fc\u30eb\u30ba\u5ddd\u6d41\u57df\u304b\u3069\u3046\u304b|\n|nox|\u7a92\u7d20\u9178\u5316\u7269\u6fc3\u5ea6|\n|rm|\u5e73\u5747\u90e8\u5c4b\u6570|\n|age|\u7bc9\u5e74\u6570|\n|dis|\u30d3\u30b8\u30cd\u30b9\u5730\u533a\u3078\u306e\u8ddd\u96e2|\n|rad|\u9ad8\u901f\u9053\u8def\u3078\u306e\u30a2\u30af\u30bb\u30b9\u6307\u6570|\n|tax|\u56fa\u5b9a\u8cc7\u7523\u7a0e|\n|ptratio|\u5b66\u751f\u3068\u6559\u5e2b\u306e\u5272\u5408|\n|black|\u9ed2\u4eba\u306e\u5272\u5408|\n|lstat|\u4f4e\u6240\u5f97\u8005\u306e\u5272\u5408|\n|mdev|\u4f4f\u5b85\u4fa1\u683c\u306e\u4e2d\u592e\u5024|\n\n\u3053\u306e\u30c7\u30fc\u30bf\u3092\u7528\u3044\u3066\uff0c\u6b21\u306e\u3088\u3046\u306a\u3053\u3068\u3092\u8003\u3048\u307e\u3059\uff0e\n\u4f4f\u5b85\u4fa1\u683c\u306e\u4e2d\u592e\u5024\u3092\uff0c\u76ee\u7684\u5909\u6570\u3068\u3057\u3066\uff0c\u305d\u306e\u4ed6\u5909\u6570(e.g., \u72af\u7f6a\u7387)\u3092\u8aac\u660e\u5909\u6570\u3068\u3057\u3066\u4e88\u6e2c\u30e2\u30c7\u30eb\u3092\u7acb\u3066\u305f\u3044\uff0e\u3064\u307e\u308a\uff0c\n$$\n\u4f4f\u5b85\u4fa1\u683c\u4e2d\u592e\u5024 = \\beta_0 + \\beta_1 \\times \u72af\u7f6a\u7387 + \\beta_2 \\times \u4f4f\u5b85\u306e\u5272\u5408 + \\cdots + \\beta_{13} \\times \u4f4e\u6240\u5f97\u8005\u5c64\u306e\u5272\u5408\n$$\n\u3068\u8868\u73fe\u3067\u304d\u308b\u3088\u3046\u306a$\\beta_0, \\beta_1, \\cdots, \\beta_{13}$\u3092\u6c42\u3081\u305f\u3044\uff0e\n\n#\u30e2\u30c7\u30eb\u5f0f\u306e\u78ba\u8a8d\n\u3082\u3046\u5c11\u3057\u4e00\u822c\u5316\u3057\u305f\u3082\u306e\u3092\u8003\u3048\u3066\u307f\u307e\u3059\uff0e\u4ee5\u4e0b\u306e\u8868\u306e\u76ee\u7684\u5909\u6570$y$\u3092$p$\u500b\u306e\u8aac\u660e\u5909\u6570$x_1 \\cdots x_p$\u3067\u4e88\u6e2c\u3059\u308b\u30e2\u30c7\u30eb\u3092\u4f5c\u6210\u3057\u305f\u3044\uff0e\n\n|index|$y$|$x_1$|$x_2$|$\\cdots$|$x_p$|\n|---:|:---:|:---:|:---:|:---:|:---:|\n|$1$|$y_1$|$x_{11}$|$x_{12}$|$\\cdots$|$x_{1p}$|\n|$2$|$y_2$|$x_{21}$|$x_{22}$|$\\cdots$|$x_{2p}$|\n|$\\vdots$|$\\vdots$|$\\vdots$|$\\vdots$|$\\vdots$|$\\vdots$|\n|$i$|$y_i$|$x_{i1}$|$x_{i2}$|$\\cdots$|$x_{ip}$|\n|$\\vdots$|$\\vdots$|$\\vdots$|$\\vdots$|$\\vdots$|$\\vdots$|\n|$n$|$y_n$|$x_{n1}$|$x_{n2}$|$\\cdots$|$x_{np}$|\n\n**\u91cd\u56de\u5e30\u30e2\u30c7\u30eb(multiple regression model)**\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u8868\u3055\u308c\u307e\u3059\uff0e\n$$\ny = \\beta_0 + \\beta_1x_1 + \\cdots + \\beta_px_p + \\epsilon\n$$\n\n\u3053\u306e\u3068\u304d\uff0c\u4e0a\u306e\u8868\u306b\u304a\u3044\u3066$i$\u756a\u76ee\u30c7\u30fc\u30bf\u306f\n$$\ny_i = \\beta_0 + \\beta_1x_{i1} + \\cdots + \\beta_px_{ip} + \\epsilon_i\n$$\n\u3068\u8868\u305b\u308b\uff0e\n\u30d9\u30af\u30c8\u30eb\u3092\u7528\u3044\u3066\u8868\u3059\u3068\uff0c\n$$\n\\begin{bmatrix}\ny_1 \\\\\\\n\\vdots \\\\\\\ny_n\n\\end{bmatrix} =\n\\begin{bmatrix}\n1 & x_{11} & \\cdots & x_{1p} \\\\\\\n\\vdots & \\vdots & \\ddots & \\vdots \\\\\\\n1 & x_{n1} & \\cdots & x_{np}\n\\end{bmatrix}\n\\begin{bmatrix}\n\\beta_0 \\\\\\\n\\vdots \\\\\\\n\\beta_p\n\\end{bmatrix} +\n\\begin{bmatrix}\n\\epsilon_1 \\\\\\\n\\vdots \\\\\\\n\\epsilon_n\n\\end{bmatrix}\n$$\n\u3068\u306a\u308a\uff0c\n$$\n\\boldsymbol{y}\n =\n\\begin{bmatrix}\ny_1 \\\\\\\n\\vdots \\\\\\\ny_n\n\\end{bmatrix}\n$$\n\n\n\n$$\n\\boldsymbol{X}=\n\\begin{bmatrix}\n1 & x_{11} & \\cdots & x_{1p} \\\\\\\n\\vdots & \\vdots & \\ddots & \\vdots \\\\\\\n1 & x_{n1} & \\cdots & x_{np}\n\\end{bmatrix}\n$$\n\n\n$$\n\\boldsymbol{\\beta}=\n\\begin{bmatrix}\n\\beta_0 \\\\\\\n\\vdots \\\\\\\n\\beta_p\n\\end{bmatrix}\n$$\n\n\n$$\n\\boldsymbol{\\epsilon}=\n\\begin{bmatrix}\n\\epsilon_1 \\\\\\\n\\vdots \\\\\\\n\\epsilon_n\n\\end{bmatrix}\n$$\n\u3068\u304a\u304f\u3068\uff0c\n$$\n\\boldsymbol{y} = \\boldsymbol{X}\\boldsymbol{\\beta} + \\boldsymbol{\\epsilon}\n$$\n\u3068\u8868\u3059\u3053\u3068\u304c\u3067\u304d\u307e\u3059\uff0e\n\u78ba\u8a8d\u3067\u3059\u304c\uff0c\n\n- $\\boldsymbol{y}$\uff1an\u6b21\u5143\u306e\u89b3\u6e2c\u30d9\u30af\u30c8\u30eb\n- $\\boldsymbol{X}$\uff1an\u00d7(p+1)\u6b21\u5143\u306e[\u8a08\u753b\u884c\u5217(design matrix)](https://ja.wikipedia.org/wiki/%E8%A8%88%E7%94%BB%E8%A1%8C%E5%88%97)\n- $\\boldsymbol{\\beta}$\uff1a(p+1)\u6b21\u5143\u306e\u56de\u5e30\u4fc2\u6570\u30d9\u30af\u30c8\u30eb (**\u3053\u308c\u3092\u6c42\u3081\u305f\u3044\uff0e**)\n- $\\boldsymbol{\\epsilon}$\uff1an\u6b21\u5143\u306e\u8aa4\u5dee\u30d9\u30af\u30c8\u30eb\n\n\u3068\u306a\u308a\u307e\u3059\uff0e\n\n# \u6700\u5c0f\u4e8c\u4e57\u6cd5\u306b\u3088\u308b\u63a8\u5b9a\n\u672a\u77e5\u30d1\u30e9\u30e1\u30fc\u30bf\u3067\u3042\u308b$\\boldsymbol{\\beta}$\u3092\u6700\u5c0f\u4e8c\u4e57\u6cd5\u306b\u3088\u308a\u63a8\u5b9a\u3057\u3066\u3044\u304d\u307e\u3059\uff0e\n\u4e8c\u4e57\u8aa4\u5dee\u3067\u3042\u308b\n\n$$\n\\boldsymbol{S}(\\boldsymbol{\\beta}) = \\sum_{i=1}^{n}{\\epsilon_i^2} = \\boldsymbol{\\epsilon}^T\\boldsymbol{\\epsilon}\n= (\\boldsymbol{y}-\\boldsymbol{X}\\boldsymbol{\\beta})^T(\\boldsymbol{y}-\\boldsymbol{X}\\boldsymbol{\\beta})\n$$\n\n\u3092\u6700\u5c0f\u306b\u3059\u308b$\\boldsymbol{\\beta}$\u3092\u6c42\u3081\u308b\uff0e\u5f0f\u3092\u5c55\u958b\u3057\u3066\uff0c\n\n$$\n\\begin{align*}\n\\boldsymbol{S}(\\boldsymbol{\\beta})\u3000& = (\\boldsymbol{y}-\\boldsymbol{X}\\boldsymbol{\\beta})^T(\\boldsymbol{y}-\\boldsymbol{X}\\boldsymbol{\\beta}) \\\\\\\\\n& = (\\boldsymbol{y}^T-(\\boldsymbol{X}\\boldsymbol{\\beta})^T)(\\boldsymbol{y}-\\boldsymbol{X}\\boldsymbol{\\beta}) \\\\\\\\\n& = (\\boldsymbol{y}^T-\\boldsymbol{\\beta}^T\\boldsymbol{X}^T)(\\boldsymbol{y}-\\boldsymbol{X}\\boldsymbol{\\beta}) \\\\\\\\\n& = \\boldsymbol{y}^T\\boldsymbol{y} - \\boldsymbol{\\beta}^T\\boldsymbol{X}^T\\boldsymbol{y}-\\boldsymbol{y}^T\\boldsymbol{X}\\boldsymbol{\\beta} + \\boldsymbol{\\beta}^T\\boldsymbol{X}^T\\boldsymbol{X}\\boldsymbol{\\beta} \\\\\\\\\n& = \\boldsymbol{y}^T\\boldsymbol{y} -2\\boldsymbol{y}^T\\boldsymbol{X}\\boldsymbol{\\beta} + \\boldsymbol{\\beta}^T\\boldsymbol{X}^T\\boldsymbol{X}\\boldsymbol{\\beta}\n\\end{align*}\n$$\n\n\u3053\u308c\u3092$\\boldsymbol{\\beta}$\u3067\u5fae\u5206\u3057\u3066\uff0c\n$$\n\\frac{\\boldsymbol{S}(\\boldsymbol{\\beta})}{\\partial \\boldsymbol{\\beta}}= -2\\boldsymbol{X}^T\\boldsymbol{y} + 2\\boldsymbol{X}^T\\boldsymbol{X}\\boldsymbol{\\beta}\n$$\n$\\frac{\\boldsymbol{S}(\\boldsymbol{\\beta})}{\\partial \\boldsymbol{\\beta}} = 0$\u3068\u304a\u3044\u3066\uff0c\n\n$$\n\\begin{align*}\n-2\\boldsymbol{X}^T\\boldsymbol{y} + 2\\boldsymbol{X}^T\\boldsymbol{X}\\boldsymbol{\\beta} & = 0 \\\\\\\\\n\\boldsymbol{X}^T\\boldsymbol{X}\\boldsymbol{\\beta} = \\boldsymbol{X}^T\\boldsymbol{y}\n\\end{align*}\n$$\n**\u3082\u3057**$(\\boldsymbol{X}^T\\boldsymbol{X})^{-1}$**\u304c\u5b58\u5728\u3059\u308b\u306a\u3089\uff0c**\n$$\n\\boldsymbol{\\beta} = (\\boldsymbol{X}^T\\boldsymbol{X})^{-1}\\boldsymbol{X}^T\\boldsymbol{y}\n$$\n\u3068\u6c42\u3081\u308b\u3053\u3068\u304c\u3067\u304d\u308b\uff0e\n\n# \u6700\u5c24\u6cd5\u306b\u3088\u308b\u63a8\u5b9a\n\u53c2\u8003\uff1a[\u30c7\u30fc\u30bf\u89e3\u6790 R\u306b\u3088\u308b\u591a\u5909\u91cf\u89e3\u6790\u5165\u9580 (7) \u6700\u5c24\u6cd5\uff0c\u30e2\u30c7\u30eb\u9078\u629e](http://www.is.titech.ac.jp/~shimo/class/doc/lec20021121-9.pdf)\n\n\u91cd\u56de\u5e30\u5f0f\n\n$$\n\\boldsymbol{y} = \\boldsymbol{X\\beta} + \\boldsymbol{\\epsilon}\n$$\n\n\u306e\u8aa4\u5dee\u30d9\u30af\u30c8\u30eb $\\boldsymbol{\\epsilon}$ \u304c\u591a\u5909\u91cf\u6b63\u898f\u5206\u5e03\u306b\u5f93\u3046\u3082\u306e\u3068\u4eee\u5b9a\u3059\u308b\uff0e\n\n```math\n\\boldsymbol{\\epsilon} \\sim N_n(\\boldsymbol{0}, \\sigma^2\\boldsymbol{I}_n)\n```\n\n\u3053\u306e\u3068\u304d\uff0c\n\n$$\n\\boldsymbol{y} \\sim N_n(\\boldsymbol{X\\beta}, \\sigma^2\\boldsymbol{I}_n)\n$$\n\n\u3068\u306a\u308a\uff0c\u78ba\u7387\u5bc6\u5ea6\u95a2\u6570\u306f\uff0c\n\n$$\nf(\\boldsymbol{y} | \\boldsymbol{X}, \\boldsymbol{\\beta}, \\sigma^2) = \\frac{1}{(2\\pi\\sigma^2\\boldsymbol{I}_n)^{n/2}}\\exp \\biggl[ - \\frac{1}{2\\sigma^2}(\\boldsymbol{y}-\\boldsymbol{X\\beta})^T(\\boldsymbol{y}-\\boldsymbol{X\\beta}) \\biggr]\uff0e\n$$\n\n\u5c24\u5ea6\u306f\uff0c\n\n$$\nL(\\boldsymbol{\\beta}, \\sigma^2 | \\boldsymbol{X}, \\boldsymbol{y})=f(\\boldsymbol{y} | \\boldsymbol{X}, \\boldsymbol{\\beta}, \\sigma^2)\n$$\n\n\u3067\u3042\u308b\u304b\u3089\uff0c\u5bfe\u6570\u5c24\u5ea6\u306f\uff0c\n\n```math\n\\begin{align*}\n\\ell (\\boldsymbol{\\beta}, \\sigma^2| \\boldsymbol{X}, \\boldsymbol{y}) & = \\log L(\\boldsymbol{\\beta}, \\sigma^2 | \\boldsymbol{X}, \\boldsymbol{y})\\\\\n& = - \\frac{n}{2} \\log (2\\pi\\sigma^2) - \\frac{1}{2\\sigma^2}(\\boldsymbol{y}-\\boldsymbol{X\\beta})^T(\\boldsymbol{y}-\\boldsymbol{X\\beta})\n\\end{align*}\n```\n\n\u3068\u306a\u308a\uff0c\u6700\u5c24\u63a8\u5b9a\u91cf\u306f\uff0c\n\n$$\n\\hat{\\boldsymbol{\\beta}} = (\\boldsymbol{X}^T\\boldsymbol{X})^{-1}\\boldsymbol{X}^T\\boldsymbol{y}\n$$\n\n$$\n\\hat{\\sigma}^2 = \\frac{1}{n}(\\boldsymbol{y}-\\boldsymbol{X\\hat{\\beta}})^T(\\boldsymbol{y}-\\boldsymbol{X\\hat{\\beta}})\n$$\n\n\u6700\u5c0f\u4e8c\u4e57\u6cd5\u3068\u540c\u69d8\u306e\u7d50\u679c\u304c\u5f97\u3089\u308c\u305f\uff0e\n\n# \u5b9f\u88c5\n\u4ee5\u4e0b\u306e\u5b9f\u88c5\u3067\u306f\uff0c**\u8aac\u660e\u5909\u6570\u540c\u58eb\u3092\u540c\u3058\u5c3a\u5ea6\u3067\u8a55\u4fa1\u3059\u308b\u305f\u3081\u306b$\\boldsymbol{X}$\u306e\u5404\u8aac\u660e\u5909\u6570\u6bce\u306b\u57fa\u6e96\u5316\u3092\u884c\u3063\u3066\u3044\u307e\u3059**\uff0e\n\u57fa\u6e96\u5316(normalization)\u306f\u3044\u3046\u307e\u3067\u3082\u306a\u304f\uff0c\u5e73\u5747\u5024($\\mu$)\u3092\u5f15\u3044\u3066\u6a19\u6e96\u504f\u5dee($\\sigma$)\u3067\u5272\u308b\u3053\u3068\u306b\u3088\u308a\uff0c\u5e73\u5747\u50240\u5206\u65631\u306b\u3059\u308b\u3053\u3068\u3067\u3059\uff0e\n\n```math\nz_i = \\frac{x_i - \\mu}{\\sigma}\n```\n\n## Python\n### \u884c\u5217\u6f14\u7b97\u306b\u3088\u308b\u5b9f\u88c5\n- \u30b3\u30fc\u30c9\n\n```py\nimport pandas as pd\nimport numpy as np\nfrom numpy import linalg as la\n\ndf = pd.read_csv(\"Boston.csv\", index_col=0)\ny = df.iloc[:,  13].values\ndf = (df - df.mean())/df.std() # \u57fa\u6e96\u5316\nX = df.iloc[:, :13].values\nX = np.column_stack((np.ones(len(X)),X))\nbeta = np.dot(np.dot(la.inv(np.dot(X.T, X)),X.T), y)\nprint beta\n```\n- \u51fa\u529b\n\n```\n[  2.25328063e+01  -9.29064566e-01   1.08263896e+00   1.41039433e-01\n   6.82414381e-01  -2.05875361e+00   2.67687661e+00   1.94853355e-02\n  -3.10711605e+00   2.66485220e+00  -2.07883689e+00  -2.06264585e+00\n   8.50108862e-01  -3.74733185e+00]\n```\n\n### scikit-learn\u306b\u3088\u308b\u5b9f\u88c5\n- \u30b3\u30fc\u30c9\n\n```py\nimport pandas as pd\nimport numpy as np\nimport sklearn.linear_model as lm\n\ndf = pd.read_csv(\"Boston.csv\", index_col=0)\ny = df.iloc[:,  13].values\ndf = (df - df.mean())/df.std() # \u57fa\u6e96\u5316\nX = df.iloc[:, :13].values\n\nmodel = lm.LinearRegression()\nmodel.fit(X, y)\n\nprint model.intercept_\nprint model.coef_\n```\n- \u51fa\u529b\n\n```\n22.5328063241\n[-0.92906457  1.08263896  0.14103943  0.68241438 -2.05875361  2.67687661\n  0.01948534 -3.10711605  2.6648522  -2.07883689 -2.06264585  0.85010886\n -3.74733185]\n```\n## R\n### \u884c\u5217\u6f14\u7b97\u306b\u3088\u308b\u5b9f\u88c5\n- \u30b3\u30fc\u30c9\n\n```r\nlibrary(MASS)\nX <- as.matrix(Boston[, -14])\ny <- as.vector(Boston[,  14])\nX <- scale(X) #\u57fa\u6e96\u5316\nX <- cbind(rep(1, nrow(X)), X)\nbeta <- solve(t(X)%*%X) %*% t(X) %*% y\nprint(beta)\n```\n- \u51fa\u529b\n\n```\n               [,1]\n        22.53280632\ncrim    -0.92906457\nzn       1.08263896\nindus    0.14103943\nchas     0.68241438\nnox     -2.05875361\nrm       2.67687661\nage      0.01948534\ndis     -3.10711605\nrad      2.66485220\ntax     -2.07883689\nptratio -2.06264585\nblack    0.85010886\nlstat   -3.74733185\n```\n\n### lm\u95a2\u6570\u306b\u3088\u308b\u5b9f\u88c5\n\n- \u30b3\u30fc\u30c9\n\n```r\nlibrary(MASS)\nX <- as.matrix(Boston[, -14])\ny <- as.vector(Boston[,  14])\nX <- scale(X) #\u57fa\u6e96\u5316\nmodel <- lm(y ~ X)\nprint(model)\n```\n- \u51fa\u529b\n\n```\nCall:\nlm(formula = y ~ X)\n\nCoefficients:\n(Intercept)        Xcrim          Xzn       Xindus        Xchas\n   22.53281     -0.92906      1.08264      0.14104      0.68241\n       Xnox          Xrm         Xage         Xdis         Xrad\n   -2.05875      2.67688      0.01949     -3.10712      2.66485\n       Xtax     Xptratio       Xblack       Xlstat\n   -2.07884     -2.06265      0.85011     -3.74733\n```\n\n\u3088\u3063\u3066\u6c42\u3081\u305f\u304b\u3063\u305f\u4e88\u6e2c\u30e2\u30c7\u30eb\u306f\uff0c\n$$\n\\begin{align*}\n\u4f4f\u5b85\u4fa1\u683c\u306e\u4e2d\u592e\u5024 = 22.53 - 0.93 \\times \u72af\u7f6a\u7387 + 1.08 \\times \u5b85\u5730\u306e\u5272\u5408 + \\cdots -3.73 \\times \u4f4e\u6240\u5f97\u8005\u306e\u5272\u5408\n\\end{align*}\n$$\n\u306e\u3088\u3046\u306b\u306a\u308a\u307e\u3059\uff0e\n\nPython\u304a\u3088\u3073R\u306e\u5b9f\u884c\u7d50\u679c\u304b\u3089\uff0c\u30dc\u30b9\u30c8\u30f3\u306e\u4f4f\u5b85\u4fa1\u683c\u306b\u306f\u300c\u4f4e\u6240\u5f97\u8005\u5c64\u306e\u5272\u5408\u300d\u304c\u4e00\u756a\u5f71\u97ff\u3092\u4e0e\u3048\u3066\u3044\u308b\u3053\u3068\u304c\u308f\u304b\u308b\uff0e\u5f53\u305f\u308a\u524d\u3068\u3044\u3048\u3070\u5f53\u305f\u308a\u524d\u3060\uff0e\n\n# \u6b63\u5247\u5316\n## \u306a\u305c\u6b63\u5247\u5316\u3059\u308b\u306e\u304b\n### \u6700\u5c0f\u4e8c\u4e57\u63a8\u5b9a\u91cf\u3092\u6c42\u3081\u3089\u308c\u306a\u3044\u30b1\u30fc\u30b9\n\u5148\u307b\u3069\u306e\u30e2\u30c7\u30eb\u306b\u3064\u3044\u3066\uff0c$\\boldsymbol{\\beta}$\u3092\u6c42\u3081\u308b\u306b\u306f\uff0c$(\\boldsymbol{X}^T\\boldsymbol{X})^{-1}$\u304c\u5b58\u5728\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\uff0e\n$$\n\\boldsymbol{\\beta} = (\\boldsymbol{X}^T\\boldsymbol{X})^{-1}\\boldsymbol{X}^T\\boldsymbol{y}\n$$\n\n$(\\boldsymbol{X}^T\\boldsymbol{X})^{-1}$\u304c\u5b58\u5728\u3057\u306a\u3044\u3068\u306f\u3069\u306e\u3088\u3046\u306a\u30b1\u30fc\u30b9\u304b\u8003\u3048\u3066\u307f\u308b\u3068\uff0c\u305d\u308c\u306f$\\boldsymbol{X}$\u306e\u968e\u6570\u304c\u30d5\u30eb\u30e9\u30f3\u30af\u3067\u306a\u3044\u6642\u3060\u3068\u308f\u304b\u308a\u307e\u3059\uff0e$\\boldsymbol{X}$\u306e\u968e\u6570\u304c\u30d5\u30eb\u30e9\u30f3\u30af\u306b\u306a\u3089\u306a\u3044\u306e\u306f\u6b21\u306e\u3088\u3046\u306a\u539f\u56e0\u304c\u8003\u3048\u3089\u308c\u307e\u3059\uff0e\n\n- \u8aac\u660e\u5909\u6570\u9593\u306e\u76f8\u95a2\u304c\u5f37\u3044\u3068\u304d\n- $n < p$\u3068\u306a\u308b\u3068\u304d\n\n\u4ed6\u306b\u3082\u30de\u30eb\u30c1\u30b3\u306a\u3069\u304c\u8003\u3048\u3089\u308c\u307e\u3059\u304c\uff0c\u79c1\u306e\u7406\u89e3\u304c\u8ffd\u3044\u3064\u3044\u3066\u3044\u306a\u3044\u306e\u3067\u5272\u611b\u3057\u307e\u3059\uff0e(\u3054\u3081\u3093\u306a\u3055\u3044)\n\n\u4eee\u306b\u8aac\u660e\u5909\u6570\u306b\u5168\u304f\u540c\u3058\u3082\u306e\u3092\u8ffd\u52a0\u3057\u3066\uff0c\u5148\u307b\u3069\u306e\u30b3\u30fc\u30c9\u3092\u5b9f\u884c\u3057\u3066\u307f\u307e\u3059\uff0e\n\n- R\u30b3\u30fc\u30c9\n\n```r\nlibrary(MASS)\nX <- as.matrix(Boston[, -14])\ny <- as.vector(Boston[,  14])\nX <- scale(X)\nX <- cbind(X, X[, 13]) # 13\u756a\u76ee\u306e\u8aac\u660e\u5909\u6570\u309214\u756a\u76ee\u306e\u8aac\u660e\u5909\u6570\u3092\u3068\u3057\u3066\u8ffd\u52a0\nX <- cbind(rep(1, nrow(X)), X)\nbeta <- solve(t(X)%*%X) %*% t(X) %*% y\n```\n\n- \u51fa\u529b\n\n```\n solve.default(t(X) %*% X) \u3067\u30a8\u30e9\u30fc:\n  Lapack routine dgesv: \u30b7\u30b9\u30c6\u30e0\u306f\u6b63\u78ba\u306b\u7279\u7570\u3067\u3059: U[15,15] = 0\n```\n\n\u3068\u306a\u308a\uff0c\u76f8\u95a2\u304c1\u3068\u306a\u308b\u5909\u6570\u304c2\u3064\u6f5c\u3093\u3067\u3044\u308b\u305f\u3081\uff0c$\\boldsymbol{X}$\u306e\u968e\u6570\u304c\u30d5\u30eb\u30e9\u30f3\u30af\u3067\u306a\u304f\u306a\u308a\uff0c$(\\boldsymbol{X}^T\\boldsymbol{X})^{-1}$\u3092\u6c42\u3081\u308b\u3053\u3068\u3067\u304d\u306a\u304f\u306a\u308a\u307e\u3059\uff0e\n\n```\n> cor(X[, 13], X[, 14])\n[1] 1\n```\n\n### \u6700\u5c0f\u4e8c\u4e57\u63a8\u5b9a\u91cf\u3092\u6c42\u3081\u3089\u308c\u306a\u3044\u30b1\u30fc\u30b9\u3078\u306e\u5bfe\u51e6\u6cd5\n\u3067\u306f\u5148\u7a0b\u306e\u30b1\u30fc\u30b9\u3067\u306f\u3069\u3046\u3059\u308c\u3070\u3088\u3044\u304b\uff0e\u6b21\u306e\u5bfe\u51e6\u6cd5\u304c\u8003\u3048\u3089\u308c\u308b\uff0e\n\n- \u76f8\u95a2\u304c\u5f37\u3044\u8aac\u660e\u5909\u6570\u540c\u58eb\u3092\u5165\u308c\u306a\u3044\u3088\u3046\u306b\u3059\u308b\n- \u64ec\u4f3c\u9006\u884c\u5217\u3092\u7528\u3044\u3044\u308b\uff0e\n- **$(\\boldsymbol{X}^T\\boldsymbol{X})$\u306e\u9006\u884c\u5217\u304c\u6c42\u307e\u308b\u3088\u3046\u306b\u3057\u3066\u3042\u3052\u308b**\n\n\u592a\u5b57\u90e8\u5206\u304c\u6b63\u5247\u5316\u3067\uff0c\u4eca\u56de\u306f\u3053\u308c\u306b\u6ce8\u76ee\u3057\u3066\u307f\u307e\u3059\uff0e\u3053\u308c\u306f\u3069\u3046\u3044\u3046\u3053\u3068\u304b\u3068\u3044\u3046\u3068\uff0c$(\\boldsymbol{X}^T\\boldsymbol{X})^{-1}$\u3092$(\\boldsymbol{X}^T\\boldsymbol{X}+ \\lambda\\boldsymbol{I_{p+1}})^{-1}$\u306e\u3088\u3046\u306b\u4f55\u304b\u8db3\u3059\u3053\u3068\u306b\u3088\u3063\u3066\u9006\u884c\u5217\u304c\u6c42\u307e\u308b\u3088\u3046\u306b\u3059\u308b\u3068\u3044\u3046\u3053\u3068\uff0e($\\boldsymbol{I}$\u306f\u5358\u4f4d\u884c\u5217\uff0e)\u3064\u307e\u308a\u6c42\u3081\u308b\u63a8\u5b9a\u91cf\u306f\u6b21\u306e\u3088\u3046\u306b\u306a\u308b\uff0e\n$$\n\\boldsymbol{\\beta_{\\lambda}} = (\\boldsymbol{X}^T\\boldsymbol{X}+ \\lambda\\boldsymbol{I_{p+1}})^{-1}\\boldsymbol{X}^T\\boldsymbol{y} \\cdots (\\*)\n$$\n(\u3069\u3046\u3057\u3066\u3053\u308c\u3067\u9006\u884c\u5217\u304c\u6c42\u307e\u308b\u3088\u3046\u306b\u306a\u308b\u304b\u306f\u5272\u611b\uff0e)\n\u3053\u306e\u3088\u3046\u306b**\u6b63\u5247\u3067\u306a\u3044\u884c\u5217\u3092\u6b63\u5247\u306b\u3059\u308b\u3053\u3068\u306b\u3088\u3063\u3066\u63a8\u5b9a\u91cf\u3092\u5f97\u308b\u65b9\u6cd5\u3092\u6b63\u5247\u5316(regularization)\u3068\u3044\u3046\u3089\u3057\u3044\uff0e**\n$\\lambda(>0)$\u306f\u6b63\u5247\u5316\u30d1\u30e9\u30e1\u30fc\u30bf\u3068\u547c\u3070\u308c\u308b\uff0e\n\u7279\u306b\uff0c$(\\*)$\u306fL2\u6b63\u5247\u5316\u306b\u3088\u308b\u63a8\u5b9a\u91cf\u3067\u3042\u308b(\u5f8c\u8ff0)\uff0e\n\n## L2\u6b63\u5247\u5316\n### \u5c0e\u51fa\n$(\\*)$\u3092\u5f97\u308b\u306b\u306f\uff0c\n$$\n\\begin{align*}\n\\boldsymbol{S_{\\lambda}}(\\boldsymbol{\\beta})\n& = (\\boldsymbol{y}-\\boldsymbol{X}\\boldsymbol{\\beta})^T(\\boldsymbol{y}-\\boldsymbol{X}\\boldsymbol{\\beta}) + \\lambda\\boldsymbol{\\beta^T\\beta} \\\\\\\\\n& = ||\\boldsymbol{y}-\\boldsymbol{X}\\boldsymbol{\\beta}||^2 + \\lambda||\\boldsymbol{\\beta}||^2\n\\end{align*}\n$$\n\u3092\u8aa4\u5dee\u95a2\u6570\u3068\u3057\u3066$\\boldsymbol{\\beta}$\u3092\u63a8\u5b9a\u3057\u3066\u3084\u308c\u3070\u3088\u3044\uff0e\u3053\u308c\u3092**L2\u6b63\u5247\u5316**\u3068\u3044\u3046\uff0e$\\lambda||\\boldsymbol{\\beta}||^2$\u306f\u30da\u30ca\u30eb\u30c6\u30a3\u9805\u3068\u547c\u3070\u308c\uff0c\u3053\u308c\u3092\u8a2d\u3051\u308b\u3053\u3068\u306b\u3088\u308a\uff0c\u904e\u5b66\u7fd2\u3092\u6291\u3048\u6c4e\u5316\u80fd\u529b\u3092\u9ad8\u3081\u308b\u3053\u3068\u304c\u3067\u304d\u308b\uff0e\u5b9f\u969b\u306b\u5c0e\u51fa\u3057\u3066\u307f\u308b\uff0e\n\n$$\n\\begin{align*}\n\\boldsymbol{S_{\\lambda}}(\\boldsymbol{\\beta})\n& = ||\\boldsymbol{y}-\\boldsymbol{X}\\boldsymbol{\\beta}||^2 + \\lambda||\\boldsymbol{\\beta}||^2 \\\\\\\\\n& = (\\boldsymbol{y}-\\boldsymbol{X}\\boldsymbol{\\beta})^T(\\boldsymbol{y}-\\boldsymbol{X}\\boldsymbol{\\beta}) + \\lambda\\boldsymbol{\\beta}^T\\boldsymbol{\\beta} \\\\\\\\\n& = (\\boldsymbol{y}^T-(\\boldsymbol{X}\\boldsymbol{\\beta})^T)(\\boldsymbol{y}-\\boldsymbol{X}\\boldsymbol{\\beta})+ \\lambda\\boldsymbol{\\beta}^T\\boldsymbol{\\beta} \\\\\\\\\n& = (\\boldsymbol{y}^T-\\boldsymbol{\\beta}^T\\boldsymbol{X}^T)(\\boldsymbol{y}-\\boldsymbol{X}\\boldsymbol{\\beta})+ \\lambda\\boldsymbol{\\beta}^T\\boldsymbol{\\beta} \\\\\\\\\n& = \\boldsymbol{y}^T\\boldsymbol{y} - \\boldsymbol{\\beta}^T\\boldsymbol{X}^T\\boldsymbol{y} - \\boldsymbol{y}^T\\boldsymbol{X}\\boldsymbol{\\beta} + \\boldsymbol{\\beta}^T\\boldsymbol{X}^T\\boldsymbol{X\\beta} + \\lambda\\boldsymbol{\\beta}^T\\boldsymbol{\\beta} \\\\\\\\\n& = \\boldsymbol{y}^T\\boldsymbol{y} - 2 \\boldsymbol{\\beta}^T\\boldsymbol{X}^T\\boldsymbol{y} + \\boldsymbol{\\beta}^T\\boldsymbol{X}^T\\boldsymbol{X\\beta}+ \\lambda\\boldsymbol{\\beta}^T\\boldsymbol{\\beta} \\\\\\\\\n\\end{align*}\n$$\n\n\u3053\u308c\u3092$\\boldsymbol{\\beta}$\u3067\u5fae\u5206\u3057\u3066\uff0c\n$$\n\\frac{\\boldsymbol{S_{\\lambda}}(\\boldsymbol{\\beta})}{\\partial \\boldsymbol{\\beta}}= -2\\boldsymbol{X}^T\\boldsymbol{y} + 2\\boldsymbol{X}^T\\boldsymbol{X}\\boldsymbol{\\beta} + 2\\lambda\\boldsymbol{\\beta}\n$$\n$\\frac{\\boldsymbol{S_{\\lambda}}(\\boldsymbol{\\beta})}{\\partial \\boldsymbol{\\beta}} = 0$\u3068\u304a\u3044\u3066\uff0c\n\n$$\n-2 \\boldsymbol{X}^T\\boldsymbol{y} + 2\\boldsymbol{X}^T\\boldsymbol{X}\\boldsymbol{\\beta} + 2\\lambda\\boldsymbol{\\beta} = 0 \\\\\\\\\n(\\boldsymbol{X}^T\\boldsymbol{X}+\\lambda\\boldsymbol{I_{p+1}})\\boldsymbol{\\beta} = \\boldsymbol{X}^T \\boldsymbol{y} \\\\\\\\\n\\boldsymbol{\\beta} = (\\boldsymbol{X}^T\\boldsymbol{X} + \\lambda \\boldsymbol{I_{p+1}})^{-1}\\boldsymbol{X}^T\\boldsymbol{y}\n\\cdots (\\*)\u306b\u540c\u3058\uff0e\n$$\n\n### \u5b9f\u88c5\n\u6700\u5f8c\u306b\uff0c\u76f8\u95a2\u304c1\u3068\u306a\u308b\u3088\u3046\u306a\u30c7\u30fc\u30bf\u304c\u5165\u3063\u3066\u3044\u308b\u3068\u304d\u3067\u3082\uff0cL2\u6b63\u5247\u5316\u3092\u884c\u3046\u3053\u3068\u306b\u3088\u308a\u63a8\u5b9a\u91cf\u304c\u6c42\u307e\u308b\u306e\u304bR\u3067\u5b9f\u88c5\u3057\u3066\u307f\u307e\u3059\uff0e\n\n- R\u30b3\u30fc\u30c9\n\n```r\nlibrary(MASS)\nX <- as.matrix(Boston[, -14])\ny <- as.vector(Boston[,  14])\nX <- scale(X)\nX <- cbind(X, X[, 13]) # 13\u756a\u76ee\u306e\u8aac\u660e\u5909\u6570\u309214\u756a\u76ee\u306e\u8aac\u660e\u5909\u6570\u3092\u3068\u3057\u3066\u8ffd\u52a0\nX <- cbind(rep(1, nrow(X)), X)\nlambda <- 0.001\nbeta <- solve(t(X)%*%X + lambda*diag(ncol(X))) %*% t(X) %*% y\nprint(beta)\n```\n\n- \u51fa\u529b\n\n```\n               [,1]\n        22.53276179\ncrim    -0.92905477\nzn       1.08262398\nindus    0.14101604\nchas     0.68241750\nnox     -2.05872447\nrm       2.67688066\nage      0.01948267\ndis     -3.10708854\nrad      2.66477986\ntax     -2.07876854\nptratio -2.06263709\nblack    0.85010730\nlstat   -1.87366482\n        -1.87366482\n```\n\u4eca\u5ea6\u306f\u3061\u3083\u3093\u3068\u6c42\u307e\u308a\u307e\u3057\u305f\uff01\n\n\n\n# \u6700\u5f8c\u306b\n\u4eca\u56de\u306f\u91cd\u56de\u5e30\u30e2\u30c7\u30eb\u3068L2\u6b63\u5247\u5316\u306b\u3064\u3044\u3066\u6271\u3044\u307e\u3057\u305f\uff0e\u6b21\u56de\u306fL1\u6b63\u5247\u5316\uff0c\u30b9\u30d1\u30fc\u30b9\u63a8\u5b9a\u306b\u3064\u3044\u3066\u6271\u3044\u305f\u3044\u3068\u601d\u3044\u307e\u3059\uff0e\n**2016/01/09\u8ffd\u8a18\uff1a\u3053\u306e\u8a18\u4e8b\u306e\u7d9a\u7de8\u306f\u300c[Lasso\u306e\u7406\u8ad6\u3068\u5b9f\u88c5 -\u30b9\u30d1\u30fc\u30b9\u306a\u89e3\u306e\u63a8\u5b9a\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0-](http://qiita.com/hogefugabar/items/71916560f7efc6eededf)\u300d\u306b\u306a\u308a\u307e\u3059\uff0e**\n\n## \u53c2\u8003\n* http://www.geocities.co.jp/Technopolis/5893/2-1.pdf\n* [Python: Boston \u30c7\u30fc\u30bf\u30bb\u30c3\u30c8\u3067\u7dda\u5f62\u56de\u5e30\u5206\u6790\u3092\u5b66\u3076](http://momijiame.tumblr.com/post/115202866516/python-boston-%E3%83%87%E3%83%BC%E3%82%BF%E3%82%BB%E3%83%83%E3%83%88%E3%81%A7%E7%B7%9A%E5%BD%A2%E5%9B%9E%E5%B8%B0%E5%88%86%E6%9E%90%E3%82%92%E5%AD%A6%E3%81%B6\n)\n"}