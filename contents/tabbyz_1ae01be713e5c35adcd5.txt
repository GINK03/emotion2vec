{"context": "\u53c2\u8003\nhttp://richonrails.com/articles/basic-ajax-in-ruby-on-rails\n\nController\nclass ProductsController < ApplicationController\n  before_action :set_product, only: [:show, :edit, :update, :destroy]\n\n  def index\n    @products = Product.all\n  end\n\n  def show\n  end\n\n  def new\n    @product = Product.new\n  end\n\n  def edit\n  end\n\n  def create\n    @product = Product.create(product_params)\n    @products = Product.all\n  end\n\n  def update\n    @product.update(product_params)\n    @products = Product.all\n  end\n\n  def destroy\n    @product.destroy\n    redirect_to products_url\n  end\n\n  private\n    def set_product\n      @product = Product.find(params[:id])\n    end\n\n    def product_params\n      params.require(:product).permit(:name)\n    end\nend\n\nPOINT\n\ncreate\u3001update\u3067\u30ea\u30c0\u30a4\u30ec\u30af\u30c8\u3057\u306a\u3044\ncreate\u3001update\u5f8c\u306f @products = Product.all \u3067\u6700\u65b0\u306e\u5024\u3092\u53d6\u5f97\n\n\nView\n\nIndex\n\nindex.html.erb\n<h1>Listing products</h1>\n\n<table class=\"table\">\n  <thead>\n    <tr>\n      <th>Name</th>\n      <th colspan=\"2\"></th>\n    </tr>\n  </thead>\n\n  <tbody class=\"product-index\">\n    <%= render \"index\" %>\n  </tbody>\n</table>\n\n<br>\n\n<%= link_to 'New Product', new_product_path, remote: true %>\n\n<div id=\"product-modal\" class=\"modal fade\" tabindex=\"-1\" role=\"dialog\" aria-hidden=\"true\"></div>\n\n\n\n_index.html.erb\n<% @products.each do |product| %>\n  <tr>\n    <td><%= product.name %></td>\n    <td><%= link_to 'Edit', edit_product_path(product), remote: true %></td>\n    <td><%= link_to 'Destroy', product, method: :delete, data: { confirm: 'Are you sure?' } %></td>\n  </tr>\n<% end %>\n\n\nPOINT\n\ntbody\u306f class \u3092\u4ed8\u3051\u3066\u5916\u51fa\u3057\uff08\u30d1\u30fc\u30b7\u30e3\u30eb\uff09\nnew/edit\u306e\u30ea\u30f3\u30af\u306b remote: true \u30aa\u30d7\u30b7\u30e7\u30f3\u3092\u8ffd\u52a0\n\u9069\u5f53\u306a\u5834\u6240\u306b <div id=\"product-modal\" class=\"modal fade\"\u301c \u3092\u633f\u5165\n\n\nModal\u7528\n\n_modal.html.erb\n<div class=\"modal-dialog\">\n  <div class=\"modal-content\">\n    <%= form_for(@product, remote: true) do |f| %>\n      <div class=\"modal-header\">\n        <button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-label=\"Close\">\n          <span aria-hidden=\"true\">&times;</span>\n        </button>\n        <h4 class=\"modal-title\">New/Editing product</h4>\n      </div>\n      <div class=\"modal-body\">\n        <div class=\"field\">\n          <%= f.label :name %><br>\n          <%= f.text_field :name %>\n        </div>\n      </div>\n        <div class=\"modal-footer\">\n          <button type=\"button\" class=\"btn btn-default\" data-dismiss=\"modal\">Close</button>\n          <%= f.submit \"Save\", :class => \"btn btn-primary\" %>\n        </div>\n      </div>\n    <% end %>\n  </div>\n</div>\n\n\nPOINT\n\nform_for\u306b remote: true \u30aa\u30d7\u30b7\u30e7\u30f3\u3092\u8ffd\u52a0\n\n\nNew\n\nnew.js.erb\n$(\"#product-modal\").html(\"<%= escape_javascript(render 'new') %>\")\n$(\"#product-modal\").modal(\"show\")\n\n\n\n_new.html.erb\n<%= render partial: 'modal' %>\n\n\n\nCreate\n\ncreate.js.erb\n<%= render 'save' %>\n\n\n\n_save.js.erb\n$(\".product-index\").html(\"<%= escape_javascript(render 'index') %>\")\n$(\"#product-modal\").modal(\"hide\")\n\n\n\nEdit\n\nedit.js.erb\n$(\"#product-modal\").html(\"<%= escape_javascript(render 'edit') %>\")\n$(\"#product-modal\").modal(\"show\")\n\n\n\n_edit.html.erb\n<%= render partial: 'modal' %>\n\n\n\nUpdate\n\nupdate.js.erb\n<%= render 'save' %>\n\n\n\n_save.js.erb\n# Create\u3068\u5171\u901a\n\n\n\u53c2\u8003\nhttp://richonrails.com/articles/basic-ajax-in-ruby-on-rails\n\n## Controller\n\n```rb\nclass ProductsController < ApplicationController\n  before_action :set_product, only: [:show, :edit, :update, :destroy]\n\n  def index\n    @products = Product.all\n  end\n\n  def show\n  end\n\n  def new\n    @product = Product.new\n  end\n\n  def edit\n  end\n\n  def create\n    @product = Product.create(product_params)\n    @products = Product.all\n  end\n\n  def update\n    @product.update(product_params)\n    @products = Product.all\n  end\n\n  def destroy\n    @product.destroy\n    redirect_to products_url\n  end\n\n  private\n    def set_product\n      @product = Product.find(params[:id])\n    end\n\n    def product_params\n      params.require(:product).permit(:name)\n    end\nend\n```\n\n**POINT**\n\n* create\u3001update\u3067\u30ea\u30c0\u30a4\u30ec\u30af\u30c8\u3057\u306a\u3044\n* create\u3001update\u5f8c\u306f `@products = Product.all` \u3067\u6700\u65b0\u306e\u5024\u3092\u53d6\u5f97\n\n## View\n### Index\n\n```erb:index.html.erb\n<h1>Listing products</h1>\n\n<table class=\"table\">\n  <thead>\n    <tr>\n      <th>Name</th>\n      <th colspan=\"2\"></th>\n    </tr>\n  </thead>\n\n  <tbody class=\"product-index\">\n    <%= render \"index\" %>\n  </tbody>\n</table>\n\n<br>\n\n<%= link_to 'New Product', new_product_path, remote: true %>\n\n<div id=\"product-modal\" class=\"modal fade\" tabindex=\"-1\" role=\"dialog\" aria-hidden=\"true\"></div>\n```\n\n```erb:_index.html.erb\n<% @products.each do |product| %>\n  <tr>\n    <td><%= product.name %></td>\n    <td><%= link_to 'Edit', edit_product_path(product), remote: true %></td>\n    <td><%= link_to 'Destroy', product, method: :delete, data: { confirm: 'Are you sure?' } %></td>\n  </tr>\n<% end %>\n```\n\n**POINT**\n\n* tbody\u306f `class` \u3092\u4ed8\u3051\u3066\u5916\u51fa\u3057\uff08\u30d1\u30fc\u30b7\u30e3\u30eb\uff09\n* new/edit\u306e\u30ea\u30f3\u30af\u306b `remote: true` \u30aa\u30d7\u30b7\u30e7\u30f3\u3092\u8ffd\u52a0\n* \u9069\u5f53\u306a\u5834\u6240\u306b `<div id=\"product-modal\" class=\"modal fade\"\u301c` \u3092\u633f\u5165\n\n### Modal\u7528\n\n```erb:_modal.html.erb\n<div class=\"modal-dialog\">\n  <div class=\"modal-content\">\n    <%= form_for(@product, remote: true) do |f| %>\n      <div class=\"modal-header\">\n        <button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-label=\"Close\">\n          <span aria-hidden=\"true\">&times;</span>\n        </button>\n        <h4 class=\"modal-title\">New/Editing product</h4>\n      </div>\n      <div class=\"modal-body\">\n        <div class=\"field\">\n          <%= f.label :name %><br>\n          <%= f.text_field :name %>\n        </div>\n      </div>\n        <div class=\"modal-footer\">\n          <button type=\"button\" class=\"btn btn-default\" data-dismiss=\"modal\">Close</button>\n          <%= f.submit \"Save\", :class => \"btn btn-primary\" %>\n        </div>\n      </div>\n    <% end %>\n  </div>\n</div>\n```\n\n**POINT**\n\n* form_for\u306b `remote: true` \u30aa\u30d7\u30b7\u30e7\u30f3\u3092\u8ffd\u52a0\n\n\n### New\n\n```erb:new.js.erb\n$(\"#product-modal\").html(\"<%= escape_javascript(render 'new') %>\")\n$(\"#product-modal\").modal(\"show\")\n```\n\n```erb:_new.html.erb\n<%= render partial: 'modal' %>\n```\n\n### Create\n\n```erb:create.js.erb\n<%= render 'save' %>\n```\n\n```erb:_save.js.erb\n$(\".product-index\").html(\"<%= escape_javascript(render 'index') %>\")\n$(\"#product-modal\").modal(\"hide\")\n```\n\n### Edit\n\n```erb:edit.js.erb\n$(\"#product-modal\").html(\"<%= escape_javascript(render 'edit') %>\")\n$(\"#product-modal\").modal(\"show\")\n```\n\n```erb:_edit.html.erb\n<%= render partial: 'modal' %>\n```\n\n### Update\n\n```erb:update.js.erb\n<%= render 'save' %>\n```\n\n```erb:_save.js.erb\n# Create\u3068\u5171\u901a\n```\n", "tags": ["Rails4", "bootstrap3"]}