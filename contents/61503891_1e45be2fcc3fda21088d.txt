{"context": " More than 1 year has passed since last update.\u4ee5\u4e0b\u306e\u30d5\u30a1\u30a4\u30eb\u304c\u3042\u3063\u305f\u3068\u3057\u3066\u3001\n\nmain.tex\nmain.bib\n\nPDF\u3092\u751f\u6210\u3059\u308b\u306b\u306f\u3001\n\nplatex main\npbibtex main\nplatex main\nplatex main\ndvimdfmx main\n\n\u3092\u5b9f\u884c\u3059\u308b\u3002\n\u3053\u308c\u3092\u30d5\u30a1\u30a4\u30eb\u306e\u5909\u66f4\u306b\u5fdc\u3058\u3066\u81ea\u52d5\u3067\u5b9f\u884c\u3057\u305f\u3044\u3002\n\u305f\u3060\u3057\u30012\u301c4\u304c\u4e0d\u8981\u306a\u5834\u5408\u306f\u30b9\u30ad\u30c3\u30d7\u3057\u305f\u3044\u3002\u305d\u3093\u306aRakefile.rb\u304c\u3053\u308c\u2193\u3002\n\nRakefile.rb\nrequire 'rake'\nrequire 'rake/clean'\n\nPAPER = 'main'\nLATEX = 'platex -kanji=utf8'\nBIBTEX = 'pbibtex -kanji=utf8'\nDVIPDFM = 'dvipdfmx'\nZIP = 'zip'\n\ntask :default do\n  Rake::Task[:clean].execute\n  Rake::Task[:latex].execute\n  Rake::Task[:bibtex].execute\n  Rake::Task[:latex].execute\n  Rake::Task[:latex].execute\n  Rake::Task[:dvipdfm].execute\nend\n\ntask :latex do\n  sh(\"#{LATEX} #{PAPER}\")\nend\n\ntask :bibtex do\n  sh(\"#{BIBTEX} #{PAPER}\")\nend\n\ntask :dvipdfm do\n  sh(\"#{DVIPDFM} #{PAPER}\")\nend\n\ntask :archive do\n  sh(\"#{ZIP} -r #{PAPER}.zip *\")\nend\n\ntask :watch do\n  require 'watchr'\n  require 'digest/md5'\n\n  executor = Class.new {\n    def submit(path, &task)\n      current_hash = Digest::MD5.file(path).to_s\n      @hashes ||= {}\n      if @hashes[path] != current_hash\n        task.call()\n        @hashes[path] = current_hash\n      end\n    end\n  }.new\n\n  script = Watchr::Script.new\n\n  script.watch \"#{PAPER}.tex\" do\n    executor.submit \"#{PAPER}.tex\" do\n      Rake::Task[:latex].execute\n      executor.submit \"#{PAPER}.aux\" do\n        Rake::Task[:bibtex].execute\n        Rake::Task[:latex].execute\n        Rake::Task[:latex].execute\n      end\n      Rake::Task[:dvipdfm].execute\n    end\n  end\n\n  script.watch \"#{PAPER}.bib\" do\n    executor.submit \"#{PAPER}.bib\" do\n      Rake::Task[:latex].execute\n      Rake::Task[:bibtex].execute\n      Rake::Task[:latex].execute\n      Rake::Task[:latex].execute\n      Rake::Task[:dvipdfm].execute\n    end\n  end\n\n  Watchr::Controller.new(script, Watchr.handler.new).run\nend\n\nCLEAN.include(%w{aux log dvi bbl blg toc lof lot fdb_latexmk fls out bb xbb DS_Store}.map{|e|\"**/*.#{e}\"}+['**/.DS_Store'])\nCLOBBER.include(\"#{PAPER}.pdf\")\n\n\nrake watch\u3067\u76e3\u8996\u958b\u59cb\u3057\u307e\u3059\u3002\n\u4ee5\u4e0b\u306e\u30d5\u30a1\u30a4\u30eb\u304c\u3042\u3063\u305f\u3068\u3057\u3066\u3001\n\n- `main.tex`\n- `main.bib`\n\nPDF\u3092\u751f\u6210\u3059\u308b\u306b\u306f\u3001\n\n1. `platex main`\n2. `pbibtex main`\n3. `platex main`\n4. `platex main`\n5. `dvimdfmx main`\n\n\u3092\u5b9f\u884c\u3059\u308b\u3002\n\n\u3053\u308c\u3092\u30d5\u30a1\u30a4\u30eb\u306e\u5909\u66f4\u306b\u5fdc\u3058\u3066\u81ea\u52d5\u3067\u5b9f\u884c\u3057\u305f\u3044\u3002\n\n\u305f\u3060\u3057\u30012\u301c4\u304c\u4e0d\u8981\u306a\u5834\u5408\u306f\u30b9\u30ad\u30c3\u30d7\u3057\u305f\u3044\u3002\u305d\u3093\u306a`Rakefile.rb`\u304c\u3053\u308c\u2193\u3002\n\n```Rakefile.rb\nrequire 'rake'\nrequire 'rake/clean'\n\nPAPER = 'main'\nLATEX = 'platex -kanji=utf8'\nBIBTEX = 'pbibtex -kanji=utf8'\nDVIPDFM = 'dvipdfmx'\nZIP = 'zip'\n\ntask :default do\n  Rake::Task[:clean].execute\n  Rake::Task[:latex].execute\n  Rake::Task[:bibtex].execute\n  Rake::Task[:latex].execute\n  Rake::Task[:latex].execute\n  Rake::Task[:dvipdfm].execute\nend\n\ntask :latex do\n  sh(\"#{LATEX} #{PAPER}\")\nend\n\ntask :bibtex do\n  sh(\"#{BIBTEX} #{PAPER}\")\nend\n\ntask :dvipdfm do\n  sh(\"#{DVIPDFM} #{PAPER}\")\nend\n\ntask :archive do\n  sh(\"#{ZIP} -r #{PAPER}.zip *\")\nend\n\ntask :watch do\n  require 'watchr'\n  require 'digest/md5'\n\n  executor = Class.new {\n    def submit(path, &task)\n      current_hash = Digest::MD5.file(path).to_s\n      @hashes ||= {}\n      if @hashes[path] != current_hash\n        task.call()\n        @hashes[path] = current_hash\n      end\n    end\n  }.new\n\n  script = Watchr::Script.new\n\n  script.watch \"#{PAPER}.tex\" do\n    executor.submit \"#{PAPER}.tex\" do\n      Rake::Task[:latex].execute\n      executor.submit \"#{PAPER}.aux\" do\n        Rake::Task[:bibtex].execute\n        Rake::Task[:latex].execute\n        Rake::Task[:latex].execute\n      end\n      Rake::Task[:dvipdfm].execute\n    end\n  end\n\n  script.watch \"#{PAPER}.bib\" do\n    executor.submit \"#{PAPER}.bib\" do\n      Rake::Task[:latex].execute\n      Rake::Task[:bibtex].execute\n      Rake::Task[:latex].execute\n      Rake::Task[:latex].execute\n      Rake::Task[:dvipdfm].execute\n    end\n  end\n\n  Watchr::Controller.new(script, Watchr.handler.new).run\nend\n\nCLEAN.include(%w{aux log dvi bbl blg toc lof lot fdb_latexmk fls out bb xbb DS_Store}.map{|e|\"**/*.#{e}\"}+['**/.DS_Store'])\nCLOBBER.include(\"#{PAPER}.pdf\")\n```\n\n`rake watch`\u3067\u76e3\u8996\u958b\u59cb\u3057\u307e\u3059\u3002\n", "tags": ["Ruby", "TeX", "Rakefile"]}