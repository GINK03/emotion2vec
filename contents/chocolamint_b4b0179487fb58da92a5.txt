{"context": " More than 1 year has passed since last update.\u305d\u3082\u305d\u3082\u5fc5\u305a\u3057\u3082 Marshal.ReleaseComObject \u3092\u547c\u3073\u51fa\u3059\u3079\u304d\u3067\u306f\u306a\u3044\u3068\u3044\u3046\u304a\u8a71\u3082\u3042\u308b\u3088\u3046\u3067\u3059\u3002\u307e\u305f\u307e\u3068\u3081\u307e\u3059\u3002\n\nCOM \u306e\u547c\u3073\u51fa\u3057\nTaskScheduler taskScheduler = null;\ntry\n{\n    taskScheduler = new TaskScheduler.TaskScheduler();\n    ITaskFolder folder = null;\n    try\n    {\n        folder = taskScheduler.GetFolder(\"\");\n        // \u4f55\u304b\u3059\u308b\n    }\n    finally\n    {\n        Marshal.ReleaseComObject(folder);\n    }\n}\nfinally\n{\n    Marshal.ReleaseComObject(taskScheduler);\n}\n\n\u5410\u304d\u6c17\u304c\u3059\u308b\u2026\u2026\u5410\u304d\u6c17\u304c\u3057\u306a\u3044\uff1f\n\n\u307c\u304f\u304c\u304b\u3093\u304c\u3048\u305f\u3055\u3044\u304d\u3087\u3046\u306e\u304b\u3044\u3051\u3064\u3055\u304f\npublic static class ComObject\n{\n    public static void Using<T>(T obj, Action<T> action)\n    {\n        try\n        {\n            action(obj);\n        }\n        finally\n        {\n            // Marshal.IsComObject \u306b\u3088\u308b\u5224\u5b9a\u306f\u30e1\u30bd\u30c3\u30c9\u306e\u5148\u982d\u3067\u304a\u3053\u306a\u3044\u4f8b\u5916\u3092\u30b9\u30ed\u30fc\u3059\u308b\u306e\u3082\u30a2\u30ea\u304b\u3082\n            if (!ReferenceEquals(obj, null) && Marshal.IsComObject(obj))\n            {\n                Marshal.ReleaseComObject(obj);\n            }\n        }\n    }\n}\n\n\u3053\u3046\u3044\u3046\u306e\u3092\u4f5c\u3063\u3066\u304a\u3044\u3066\u3001\u3053\u3046\u3058\u3083\uff01\nComObject.Using(new TaskScheduler.TaskScheduler(), taskScheduler =>\n{\n    taskScheduler.Connect(null, null, null, null);\n\n    ComObject.Using(taskScheduler.GetFolder(\"\"), folder =>\n    {\n        // \u4f55\u304b\u3059\u308b\n    });\n});\n\n\u2026\u2026\u3082\u3046\u5c11\u3057\u306a\u3093\u304b\u3044\u3044\u611f\u3058\u306b\u306a\u3089\u306a\u3044\u304b\u306a\u3041\u3002\n\n(\u53c2\u8003) \u691c\u8a0e\u3057\u305f\u3051\u3069\u30dc\u30c4\u306b\u3057\u305f\u6848\nusing (var taskScheduler = ComObject.Create(new TaskScheduler.TaskScheduler()))\n{\n    taskScheduler.Value.Connect(null, null, null, null);\n\n    using (var folder = ComObject.Create(taskScheduler.Value.GetFolder(\"\")))\n    {\n        // \u4f55\u304b\u3059\u308b\n    });\n});\n\n.Value \u304c\u30a6\u30b6\u3044\u2026\u2026\u3051\u3069\u3001\u7d20\u76f4\u3063\u3061\u3083\u7d20\u76f4\u3002\nComObject \u306e\u751f\u6210\u3092\u30b3\u30f3\u30b9\u30c8\u30e9\u30af\u30bf\u3058\u3083\u306a\u304f\u3066\u30d5\u30a1\u30af\u30c8\u30ea\u30e1\u30bd\u30c3\u30c9\u306b\u3057\u3066\u3044\u308b\u306e\u306f\u578b\u5f15\u6570\u306b\u5bfe\u3057\u3066\u578b\u63a8\u8ad6\u3092\u52b9\u304b\u305b\u305f\u3044\u304b\u3089\u3067\u3059\u3002Tuple.Create \u3068\u4e00\u7dd2\u3067\u3059\u306d\u3002\n\n\u30cd\u30b9\u30c8\u3092\u9632\u3052\u308b\u5999\u6848\uff01\n\u306f\u3047\uff5e\u6c0f\u304b\u3089\u3053\u3093\u306a\u63d0\u6848\u3092\u9802\u304d\u307e\u3057\u305f\u3002\n\n**\u305d\u3082\u305d\u3082\u5fc5\u305a\u3057\u3082 `Marshal.ReleaseComObject` \u3092\u547c\u3073\u51fa\u3059\u3079\u304d\u3067\u306f\u306a\u3044\u3068\u3044\u3046\u304a\u8a71\u3082\u3042\u308b\u3088\u3046\u3067\u3059\u3002\u307e\u305f\u307e\u3068\u3081\u307e\u3059\u3002**\n\n# COM \u306e\u547c\u3073\u51fa\u3057\n\n```csharp\nTaskScheduler taskScheduler = null;\ntry\n{\n    taskScheduler = new TaskScheduler.TaskScheduler();\n    ITaskFolder folder = null;\n    try\n    {\n        folder = taskScheduler.GetFolder(\"\");\n        // \u4f55\u304b\u3059\u308b\n    }\n    finally\n    {\n        Marshal.ReleaseComObject(folder);\n    }\n}\nfinally\n{\n    Marshal.ReleaseComObject(taskScheduler);\n}\n```\n\n\u5410\u304d\u6c17\u304c\u3059\u308b\u2026\u2026\u5410\u304d\u6c17\u304c\u3057\u306a\u3044\uff1f\n\n# \u307c\u304f\u304c\u304b\u3093\u304c\u3048\u305f\u3055\u3044\u304d\u3087\u3046\u306e\u304b\u3044\u3051\u3064\u3055\u304f\n\n```csharp\npublic static class ComObject\n{\n    public static void Using<T>(T obj, Action<T> action)\n    {\n        try\n        {\n            action(obj);\n        }\n        finally\n        {\n            // Marshal.IsComObject \u306b\u3088\u308b\u5224\u5b9a\u306f\u30e1\u30bd\u30c3\u30c9\u306e\u5148\u982d\u3067\u304a\u3053\u306a\u3044\u4f8b\u5916\u3092\u30b9\u30ed\u30fc\u3059\u308b\u306e\u3082\u30a2\u30ea\u304b\u3082\n            if (!ReferenceEquals(obj, null) && Marshal.IsComObject(obj))\n            {\n                Marshal.ReleaseComObject(obj);\n            }\n        }\n    }\n}\n```\n\n\u3053\u3046\u3044\u3046\u306e\u3092\u4f5c\u3063\u3066\u304a\u3044\u3066\u3001\u3053\u3046\u3058\u3083\uff01\n\n```csharp\nComObject.Using(new TaskScheduler.TaskScheduler(), taskScheduler =>\n{\n    taskScheduler.Connect(null, null, null, null);\n\n    ComObject.Using(taskScheduler.GetFolder(\"\"), folder =>\n    {\n        // \u4f55\u304b\u3059\u308b\n    });\n});\n```\n\n\u2026\u2026\u3082\u3046\u5c11\u3057\u306a\u3093\u304b\u3044\u3044\u611f\u3058\u306b\u306a\u3089\u306a\u3044\u304b\u306a\u3041\u3002\n\n# (\u53c2\u8003) \u691c\u8a0e\u3057\u305f\u3051\u3069\u30dc\u30c4\u306b\u3057\u305f\u6848\n\n```csharp\nusing (var taskScheduler = ComObject.Create(new TaskScheduler.TaskScheduler()))\n{\n    taskScheduler.Value.Connect(null, null, null, null);\n\n    using (var folder = ComObject.Create(taskScheduler.Value.GetFolder(\"\")))\n    {\n        // \u4f55\u304b\u3059\u308b\n    });\n});\n```\n\n`.Value` \u304c\u30a6\u30b6\u3044\u2026\u2026\u3051\u3069\u3001\u7d20\u76f4\u3063\u3061\u3083\u7d20\u76f4\u3002\n\n`ComObject` \u306e\u751f\u6210\u3092\u30b3\u30f3\u30b9\u30c8\u30e9\u30af\u30bf\u3058\u3083\u306a\u304f\u3066\u30d5\u30a1\u30af\u30c8\u30ea\u30e1\u30bd\u30c3\u30c9\u306b\u3057\u3066\u3044\u308b\u306e\u306f\u578b\u5f15\u6570\u306b\u5bfe\u3057\u3066\u578b\u63a8\u8ad6\u3092\u52b9\u304b\u305b\u305f\u3044\u304b\u3089\u3067\u3059\u3002`Tuple.Create` \u3068\u4e00\u7dd2\u3067\u3059\u306d\u3002\n \n# \u30cd\u30b9\u30c8\u3092\u9632\u3052\u308b\u5999\u6848\uff01\n\n\u306f\u3047\uff5e\u6c0f\u304b\u3089\u3053\u3093\u306a\u63d0\u6848\u3092\u9802\u304d\u307e\u3057\u305f\u3002\n\n<blockquote class=\"twitter-tweet\">@chocolamint \u3053\u3093\u306a\u611f\u3058\u3068\u304b\uff1f <a href=\"https://gist.github.com/sayurin/ee9b87ab8786489a438a\" target=\"_blank\">https://gist.github.com/sayurin/ee9b87ab8786489a438a</a>\n\u7d50\u5c40\u306e\u3068\u3053\u308d\u3001.NET\u306e\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u53c2\u7167\u3068COM\u306e\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u53c2\u7167\u304c\u4e00\u81f4\u3057\u306a\u3044\u304b\u3089\u3001GC\u3067\u56de\u53ce\u3057\u305f\u304f\u3066\u3082\u672a\u4f7f\u7528\u304b\u5224\u5b9a\u3067\u304d\u306a\u3044\u3068\u304b\u3001\u305d\u3046\u3044\u3046\u3002</p>&mdash; \u306f\u3047\uff5e (@haxe) <a href=\"https://twitter.com/haxe/status/636719585215975424\">August 27 ,2015</a></blockquote>\n\n<script async src=\"//platform.twitter.com/widgets.js\" charset=\"utf-8\"></script>\n", "tags": [".NET", "C#"]}