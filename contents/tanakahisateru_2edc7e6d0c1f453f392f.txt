{"tags": ["PHP", "Symfony22.3"], "context": " More than 1 year has passed since last update.\u30ef\u30f3\u30bf\u30a4\u30e0\u30c8\u30fc\u30af\u30f3\u3092\u8e0f\u3093\u3067\u81ea\u52d5\u7684\u306b\u30ed\u30b0\u30a4\u30f3\u3001\u30b5\u30a4\u30f3\u30a2\u30c3\u30d7\u76f4\u5f8c\u306b\u81ea\u52d5\u30ed\u30b0\u30a4\u30f3\u3057\u3066\u30d7\u30ed\u30d5\u30a3\u30fc\u30eb\u7de8\u96c6\u307e\u3067\u884c\u304b\u305b\u305f\u3044\u3001\u306a\u3069\u3001\u30ed\u30b0\u30a4\u30f3\u30d5\u30a9\u30fc\u30e0\u3078\u5165\u529b\u3055\u305b\u305a\u306b\u3001\u7279\u5225\u306b\u30e6\u30fc\u30b6 \u306b\u30ed\u30b0\u30a4\u30f3\u30bb\u30c3\u30b7\u30e7\u30f3\u3092\u4e0e\u3048\u305f\u3044\u3002\nsecurity.yml \u304c\u3053\u3093\u306a\u611f\u3058\u3067\u3001\u30a8\u30f3\u30c6\u30a3\u30c6\u30a3\u306e\u30d7\u30ed\u30d0\u30a4\u30c0\u3092\u4f7f\u3063\u305f(Symfony\\Component\\Security\\Core\\User\\UserInterface \u3092\u5b9f\u88c5\u3057\u305fUser\u30af\u30e9\u30b9\u3092\u4f7f\u3046) \u30d5\u30a9\u30fc\u30e0\u30ed\u30b0\u30a4\u30f3\u3060\u3063\u305f\u3068\u3057\u305f\u3089...\nsecurity:\n    providers:\n        users:\n            entity:\n                class: HogeFugaBundle:User\n                property: name\n    firewalls:\n        secured_area:  # \u3053\u3053\u306e\u540d\u524d\u3042\u3068\u3067\u4f7f\u3046\n            pattern: ^/...\n            form_login: ~\n            logout: ~\n\n\u3053\u3093\u306a\u3075\u3046\u306b\u3059\u308b\u3068\u30aa\u30c3\u30b1\u30fc\u3002\nuse Hoge\\Bundle\\FugaBundle\\Entity\\User;\nuse Symfony\\Component\\Security\\Core\\Authentication\\Token\\UsernamePasswordToken;\nuse Symfony\\Component\\Security\\Core\\SecurityContext;\n\n        /** @var $user User */\n        $user = $this->get('doctrine')->getRepository(\n            'HogeFugaBundle:User'\n        )->findOneBy(array(\n            'name' => 'tanakahisateru',  // \u30e6\u30fc\u30b6\u540d\n        ));\n\n        $providerKey = 'secured_area';  // \u4e0a\u306e security.firewall \u306e\u3084\u3064\n\n        // \u30a8\u30f3\u30c6\u30a3\u30c6\u30a3\u3068\u30ad\u30fc\u304b\u3089\u8a8d\u8a3c\u30c8\u30fc\u30af\u30f3\u3092\u4f5c\u308b\n        $token = new UsernamePasswordToken(\n            $user, null, $providerKey, $user->getRoles()\n        );\n\n        /** @var $securityContext SecurityContext */\n        $securityContext = $this->get('security.context');\n        // \u8a8d\u8a3c\u30c8\u30fc\u30af\u30f3\u3092\u30bb\u30c3\u30c8\u3002\u3042\u3068\u306fHTTP\u30ec\u30b9\u30dd\u30f3\u30b9\u3092\u8fd4\u305b\u308c\u3070OK\u3002\n        $securityContext->setToken($token);\n\n\u3053\u308c\u3067\u3067\u304d\u305f\u30ed\u30b0\u30a4\u30f3\u30bb\u30c3\u30b7\u30e7\u30f3\u306e\u5f37\u5236\u30ed\u30b0\u30a2\u30a6\u30c8\u306f\u3053\u308c\u3067\u3044\u3051\u307e\u3057\u305f\u3002\n        /** @var $securityContext SecurityContext */\n        $securityContext = $this->get('security.context');\n        $securityContext->setToken(null);\n\n\u30ef\u30f3\u30bf\u30a4\u30e0\u30c8\u30fc\u30af\u30f3\u3092\u8e0f\u3093\u3067\u81ea\u52d5\u7684\u306b\u30ed\u30b0\u30a4\u30f3\u3001\u30b5\u30a4\u30f3\u30a2\u30c3\u30d7\u76f4\u5f8c\u306b\u81ea\u52d5\u30ed\u30b0\u30a4\u30f3\u3057\u3066\u30d7\u30ed\u30d5\u30a3\u30fc\u30eb\u7de8\u96c6\u307e\u3067\u884c\u304b\u305b\u305f\u3044\u3001\u306a\u3069\u3001\u30ed\u30b0\u30a4\u30f3\u30d5\u30a9\u30fc\u30e0\u3078\u5165\u529b\u3055\u305b\u305a\u306b\u3001\u7279\u5225\u306b\u30e6\u30fc\u30b6 \u306b\u30ed\u30b0\u30a4\u30f3\u30bb\u30c3\u30b7\u30e7\u30f3\u3092\u4e0e\u3048\u305f\u3044\u3002\n\nsecurity.yml \u304c\u3053\u3093\u306a\u611f\u3058\u3067\u3001\u30a8\u30f3\u30c6\u30a3\u30c6\u30a3\u306e\u30d7\u30ed\u30d0\u30a4\u30c0\u3092\u4f7f\u3063\u305f(`Symfony\\Component\\Security\\Core\\User\\UserInterface` \u3092\u5b9f\u88c5\u3057\u305fUser\u30af\u30e9\u30b9\u3092\u4f7f\u3046) \u30d5\u30a9\u30fc\u30e0\u30ed\u30b0\u30a4\u30f3\u3060\u3063\u305f\u3068\u3057\u305f\u3089...\n\n```yaml\nsecurity:\n    providers:\n        users:\n            entity:\n                class: HogeFugaBundle:User\n                property: name\n    firewalls:\n        secured_area:  # \u3053\u3053\u306e\u540d\u524d\u3042\u3068\u3067\u4f7f\u3046\n            pattern: ^/...\n            form_login: ~\n            logout: ~\n```\n\n\u3053\u3093\u306a\u3075\u3046\u306b\u3059\u308b\u3068\u30aa\u30c3\u30b1\u30fc\u3002\n\n```php\nuse Hoge\\Bundle\\FugaBundle\\Entity\\User;\nuse Symfony\\Component\\Security\\Core\\Authentication\\Token\\UsernamePasswordToken;\nuse Symfony\\Component\\Security\\Core\\SecurityContext;\n\n        /** @var $user User */\n        $user = $this->get('doctrine')->getRepository(\n            'HogeFugaBundle:User'\n        )->findOneBy(array(\n            'name' => 'tanakahisateru',  // \u30e6\u30fc\u30b6\u540d\n        ));\n\n        $providerKey = 'secured_area';  // \u4e0a\u306e security.firewall \u306e\u3084\u3064\n\n        // \u30a8\u30f3\u30c6\u30a3\u30c6\u30a3\u3068\u30ad\u30fc\u304b\u3089\u8a8d\u8a3c\u30c8\u30fc\u30af\u30f3\u3092\u4f5c\u308b\n        $token = new UsernamePasswordToken(\n            $user, null, $providerKey, $user->getRoles()\n        );\n\n        /** @var $securityContext SecurityContext */\n        $securityContext = $this->get('security.context');\n        // \u8a8d\u8a3c\u30c8\u30fc\u30af\u30f3\u3092\u30bb\u30c3\u30c8\u3002\u3042\u3068\u306fHTTP\u30ec\u30b9\u30dd\u30f3\u30b9\u3092\u8fd4\u305b\u308c\u3070OK\u3002\n        $securityContext->setToken($token);\n```\n\n\u3053\u308c\u3067\u3067\u304d\u305f\u30ed\u30b0\u30a4\u30f3\u30bb\u30c3\u30b7\u30e7\u30f3\u306e\u5f37\u5236\u30ed\u30b0\u30a2\u30a6\u30c8\u306f\u3053\u308c\u3067\u3044\u3051\u307e\u3057\u305f\u3002\n\n```php\n        /** @var $securityContext SecurityContext */\n        $securityContext = $this->get('security.context');\n        $securityContext->setToken(null);\n```"}