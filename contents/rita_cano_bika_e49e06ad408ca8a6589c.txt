{"context": "VBA\u3067\u30ab\u30e9\u30e0\u60c5\u5831\u3092\u4e00\u62ec\u53d6\u5f97\u3059\u308b\u5fc5\u8981\u304c\u3042\u3063\u305f\u306e\u3067\u3001\u30e1\u30e2\u3002\n\u526f\u554f\u3044\u5408\u308f\u305b\u4f7f\u3044\u307e\u304f\u308a\u306a\u306e\u3067\u3001\u6642\u9593\u3042\u308b\u3068\u304d\u306bJOIN\u306a\u3069\u306b\u7f6e\u304d\u63db\u3048\u305f\u3044\u30fb\u30fb\u3002\n'\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u540d'\u3001'\u30c6\u30fc\u30d6\u30eb\u540d'\u306f\u305d\u306e\u8a72\u5f53\u540d\u306b\u7f6e\u304d\u63db\u3048\u3067\uff01\n\nPostgreSQL\u7528\u30ab\u30e9\u30e0\u540d\u53d6\u5f97SQL\nSELECT relname AS table_name         -- \u30c6\u30fc\u30d6\u30eb\u540d\n     , attname AS field              -- \u30ab\u30e9\u30e0\u540d\n     , CASE WHEN attname IN \n     ( SELECT ccu.column_name AS COLUMN_NAME \n         FROM information_schema.table_constraints tc \n            , information_schema.constraint_column_usage ccu \n        WHERE tc.table_catalog = '\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u540d' \n          AND tc.table_name = '\u30c6\u30fc\u30d6\u30eb\u540d' \n          AND tc.constraint_type = 'PRIMARY KEY' \n          AND tc.table_catalog = ccu.table_catalog \n          AND tc.table_schema = ccu.table_schema \n          AND tc.table_name = ccu.table_name \n          AND tc.constraint_name = ccu.constraint_name \n     ) \n            THEN 'PRI' \n            ELSE NULL \n       END AS key                    -- \u30d7\u30e9\u30a4\u30de\u30ea\u30fc\u30ad\u30fc\n     , typname AS Type               -- \u578b\u540d\n     , CASE typname \n            WHEN 'int2' \n            THEN '2' \n            WHEN 'int4' \n            THEN '4' \n            WHEN 'int8' \n            THEN '8' \n            WHEN 'float4' \n            THEN '4' \n            WHEN 'float8' \n            THEN '8' \n            WHEN 'serial4' \n            THEN '4' \n            WHEN 'serial8' \n            THEN '8' \n            WHEN 'timestamp' \n            THEN 14 \n            WHEN 'numeric' \n            THEN ( atttypmod - 4 ) / 65536 \n            ELSE atttypmod - 4 \n       END AS Type_Length            -- \u578b\u306e\u9577\u3055\n     , CASE attnotnull \n            WHEN 't' \n            THEN 'YES' \n            ELSE 'NO' \n       END AS Null                   -- NOT NULL\u5236\u7d04\n     , RES.COLUMN_COMMENT AS Comment -- \u30ab\u30e9\u30e0\u30b3\u30e1\u30f3\u30c8\n  FROM \n     ( pg_type \n        INNER JOIN pg_attribute \n           ON pg_type.oid = pg_attribute.atttypid \n        INNER JOIN pg_class \n           ON pg_class.oid = pg_attribute.attrelid \n     ) \n  LEFT JOIN \n     ( SELECT psat.relname AS TABLE_NAME \n            , pa.attname AS COLUMN_NAME \n            , pd.description AS COLUMN_COMMENT \n         FROM pg_stat_all_tables psat \n            , pg_description pd \n            , pg_attribute pa \n        WHERE psat.schemaname = \n            ( SELECT schemaname \n                FROM pg_stat_user_tables \n               WHERE relname = '\u30c6\u30fc\u30d6\u30eb\u540d' \n            ) \n          AND psat.relname = '\u30c6\u30fc\u30d6\u30eb\u540d' \n          AND psat.relid = pd.objoid \n          AND pd.objsubid <> 0 \n          AND pd.objoid = pa.attrelid \n          AND pd.objsubid = pa.attnum \n        ORDER BY \n              pd.objsubid \n     ) AS RES \n    ON RES.COLUMN_NAME = pg_attribute.attname \n WHERE relkind = 'r' \n   AND relname = '\u30c6\u30fc\u30d6\u30eb\u540d' \n   AND attnum > 0 \n ORDER BY \n       attnum;\n\n\n\u3053\u308c\u7cfb\u306e\u30ab\u30e9\u30e0\u540d\u60c5\u5831\u53d6\u5f97\u306fMySQL\u304c\u4e00\u756a\u7c21\u5358\u3060\u3063\u305f\u3002\n\u3068\u3044\u3046\u3053\u3068\u3067\u304a\u307e\u3051\u306bMySQL\u7528\u3068\u305b\u3063\u304b\u304f\u4f5c\u3063\u305f\u306e\u3067Oracle\u7528\u3082\u3002\n\nMySQL\u7528\u30ab\u30e9\u30e0\u540d\u53d6\u5f97SQL\nSHOW FULL COLUMNS FROM \u30c6\u30fc\u30d6\u30eb\u540d;\n\n\nMySQL\u306e\u3053\u306e\u30b7\u30f3\u30d7\u30eb\u3055\u3088\u3002\n\nOracle\u7528\u30ab\u30e9\u30e0\u540d\u53d6\u5f97SQL\nSELECT T.TABLE_NAME AS table_name -- \u30c6\u30fc\u30d6\u30eb\u540d\n     , C.COLUMN_ID \n     , C.COLUMN_NAME AS Field     -- \u30ab\u30e9\u30e0\u540d\n     , CASE WHEN PK.COLUMN_POSITION IS NOT NULL \n            THEN PK.COLUMN_POSITION \n            ELSE NULL \n       END AS Key                 -- \u30d7\u30e9\u30a4\u30de\u30ea\u30fc\u30ad\u30fc\n     , C.DATA_TYPE AS Type        -- \u578b\u540d\n     , CASE WHEN C.DATA_PRECISION IS NOT NULL \n            THEN '(' || C.DATA_PRECISION || '.' || C.DATA_SCALE || ')' \n            ELSE TO_CHAR(C.DATA_LENGTH) \n       END AS Type_length         -- \u578b\u306e\u9577\u3055\n     , C.NULLABLE AS Null         -- NOT NULL\u5236\u7d04\n     , C.DATA_DEFAULT AS DEFAULT  -- \u30c7\u30d5\u30a9\u30eb\u30c8\u5024\n     , TC.COMMENTS AS Comment     -- \u30ab\u30e9\u30e0\u30b3\u30e1\u30f3\u30c8\n  FROM USER_TABLES T \n INNER JOIN USER_TAB_COMMENTS TC \n    ON \n     ( T.TABLE_NAME = TC.TABLE_NAME \n     ) \n INNER JOIN USER_TAB_COLUMNS C \n    ON \n     ( T.TABLE_NAME = C.TABLE_NAME \n     ) \n INNER JOIN USER_COL_COMMENTS CC \n    ON \n     ( T.TABLE_NAME = CC.TABLE_NAME \n          AND C.COLUMN_NAME = CC.COLUMN_NAME \n     ) \n  LEFT JOIN \n     ( SELECT IND.INDEX_NAME \n            , CONST.TABLE_NAME \n            , IND.COLUMN_NAME \n            , IND.COLUMN_POSITION \n         FROM USER_IND_COLUMNS IND \n        INNER JOIN USER_CONSTRAINTS CONST \n           ON \n            ( IND.INDEX_NAME = CONST.CONSTRAINT_NAME \n                 AND CONSTRAINT_TYPE = 'P' \n            ) \n     ) PK \n    ON \n     ( T.TABLE_NAME = PK.TABLE_NAME \n          AND C.COLUMN_NAME = PK.COLUMN_NAME \n     ) \n WHERE T.TABLE_NAME LIKE '\u30c6\u30fc\u30d6\u30eb\u540d' \n ORDER BY \n       T.TABLE_NAME \n     , C.COLUMN_ID;\n\n\n\u5bfe\u3057\u3066Oracle\u306f\u7d50\u69cb\u91cd\u305f\u3044\u3067\u3059\u3002\n\u53c2\u8003\u5143\uff1a\nPostgreSQL\u306b\u3066\u30c6\u30fc\u30d6\u30eb\u3084\u30ab\u30e9\u30e0\u306e\u5404\u7a2e\u60c5\u5831\u3092\u53d6\u5f97\u3059\u308bSQL (\u30c6\u30fc\u30d6\u30eb\u4e00\u89a7, \u30ab\u30e9\u30e0\u4e00\u89a7, \u30d7\u30e9\u30a4\u30de\u30ea\u30fc\u30ad\u30fc\u60c5\u5831\u53d6\u5f97, \u30c6\u30fc\u30d6\u30eb\u306e\u30b3\u30e1\u30f3\u30c8\u3092\u53d6\u5f97, \u30ab\u30e9\u30e0\u306e\u30b3\u30e1\u30f3\u30c8\u3092\u53d6\u5f97)\nhttp://devlights.hatenablog.com/entry/20080226/p1\nVBA\u3067\u30ab\u30e9\u30e0\u60c5\u5831\u3092\u4e00\u62ec\u53d6\u5f97\u3059\u308b\u5fc5\u8981\u304c\u3042\u3063\u305f\u306e\u3067\u3001\u30e1\u30e2\u3002\n\u526f\u554f\u3044\u5408\u308f\u305b\u4f7f\u3044\u307e\u304f\u308a\u306a\u306e\u3067\u3001\u6642\u9593\u3042\u308b\u3068\u304d\u306bJOIN\u306a\u3069\u306b\u7f6e\u304d\u63db\u3048\u305f\u3044\u30fb\u30fb\u3002\n'\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u540d'\u3001'\u30c6\u30fc\u30d6\u30eb\u540d'\u306f\u305d\u306e\u8a72\u5f53\u540d\u306b\u7f6e\u304d\u63db\u3048\u3067\uff01\n\n```postgres:PostgreSQL\u7528\u30ab\u30e9\u30e0\u540d\u53d6\u5f97SQL\nSELECT relname AS table_name         -- \u30c6\u30fc\u30d6\u30eb\u540d\n     , attname AS field              -- \u30ab\u30e9\u30e0\u540d\n     , CASE WHEN attname IN \n     ( SELECT ccu.column_name AS COLUMN_NAME \n         FROM information_schema.table_constraints tc \n            , information_schema.constraint_column_usage ccu \n        WHERE tc.table_catalog = '\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u540d' \n          AND tc.table_name = '\u30c6\u30fc\u30d6\u30eb\u540d' \n          AND tc.constraint_type = 'PRIMARY KEY' \n          AND tc.table_catalog = ccu.table_catalog \n          AND tc.table_schema = ccu.table_schema \n          AND tc.table_name = ccu.table_name \n          AND tc.constraint_name = ccu.constraint_name \n     ) \n            THEN 'PRI' \n            ELSE NULL \n       END AS key                    -- \u30d7\u30e9\u30a4\u30de\u30ea\u30fc\u30ad\u30fc\n     , typname AS Type               -- \u578b\u540d\n     , CASE typname \n            WHEN 'int2' \n            THEN '2' \n            WHEN 'int4' \n            THEN '4' \n            WHEN 'int8' \n            THEN '8' \n            WHEN 'float4' \n            THEN '4' \n            WHEN 'float8' \n            THEN '8' \n            WHEN 'serial4' \n            THEN '4' \n            WHEN 'serial8' \n            THEN '8' \n            WHEN 'timestamp' \n            THEN 14 \n            WHEN 'numeric' \n            THEN ( atttypmod - 4 ) / 65536 \n            ELSE atttypmod - 4 \n       END AS Type_Length            -- \u578b\u306e\u9577\u3055\n     , CASE attnotnull \n            WHEN 't' \n            THEN 'YES' \n            ELSE 'NO' \n       END AS Null                   -- NOT NULL\u5236\u7d04\n     , RES.COLUMN_COMMENT AS Comment -- \u30ab\u30e9\u30e0\u30b3\u30e1\u30f3\u30c8\n  FROM \n     ( pg_type \n        INNER JOIN pg_attribute \n           ON pg_type.oid = pg_attribute.atttypid \n        INNER JOIN pg_class \n           ON pg_class.oid = pg_attribute.attrelid \n     ) \n  LEFT JOIN \n     ( SELECT psat.relname AS TABLE_NAME \n            , pa.attname AS COLUMN_NAME \n            , pd.description AS COLUMN_COMMENT \n         FROM pg_stat_all_tables psat \n            , pg_description pd \n            , pg_attribute pa \n        WHERE psat.schemaname = \n            ( SELECT schemaname \n                FROM pg_stat_user_tables \n               WHERE relname = '\u30c6\u30fc\u30d6\u30eb\u540d' \n            ) \n          AND psat.relname = '\u30c6\u30fc\u30d6\u30eb\u540d' \n          AND psat.relid = pd.objoid \n          AND pd.objsubid <> 0 \n          AND pd.objoid = pa.attrelid \n          AND pd.objsubid = pa.attnum \n        ORDER BY \n              pd.objsubid \n     ) AS RES \n    ON RES.COLUMN_NAME = pg_attribute.attname \n WHERE relkind = 'r' \n   AND relname = '\u30c6\u30fc\u30d6\u30eb\u540d' \n   AND attnum > 0 \n ORDER BY \n       attnum;\n```\n\n\u3053\u308c\u7cfb\u306e\u30ab\u30e9\u30e0\u540d\u60c5\u5831\u53d6\u5f97\u306fMySQL\u304c\u4e00\u756a\u7c21\u5358\u3060\u3063\u305f\u3002\n\u3068\u3044\u3046\u3053\u3068\u3067\u304a\u307e\u3051\u306bMySQL\u7528\u3068\u305b\u3063\u304b\u304f\u4f5c\u3063\u305f\u306e\u3067Oracle\u7528\u3082\u3002\n\n```mysql:MySQL\u7528\u30ab\u30e9\u30e0\u540d\u53d6\u5f97SQL\nSHOW FULL COLUMNS FROM \u30c6\u30fc\u30d6\u30eb\u540d;\n```\n\nMySQL\u306e\u3053\u306e\u30b7\u30f3\u30d7\u30eb\u3055\u3088\u3002\n\n```sql:Oracle\u7528\u30ab\u30e9\u30e0\u540d\u53d6\u5f97SQL\nSELECT T.TABLE_NAME AS table_name -- \u30c6\u30fc\u30d6\u30eb\u540d\n     , C.COLUMN_ID \n     , C.COLUMN_NAME AS Field     -- \u30ab\u30e9\u30e0\u540d\n     , CASE WHEN PK.COLUMN_POSITION IS NOT NULL \n            THEN PK.COLUMN_POSITION \n            ELSE NULL \n       END AS Key                 -- \u30d7\u30e9\u30a4\u30de\u30ea\u30fc\u30ad\u30fc\n     , C.DATA_TYPE AS Type        -- \u578b\u540d\n     , CASE WHEN C.DATA_PRECISION IS NOT NULL \n            THEN '(' || C.DATA_PRECISION || '.' || C.DATA_SCALE || ')' \n            ELSE TO_CHAR(C.DATA_LENGTH) \n       END AS Type_length         -- \u578b\u306e\u9577\u3055\n     , C.NULLABLE AS Null         -- NOT NULL\u5236\u7d04\n     , C.DATA_DEFAULT AS DEFAULT  -- \u30c7\u30d5\u30a9\u30eb\u30c8\u5024\n     , TC.COMMENTS AS Comment     -- \u30ab\u30e9\u30e0\u30b3\u30e1\u30f3\u30c8\n  FROM USER_TABLES T \n INNER JOIN USER_TAB_COMMENTS TC \n    ON \n     ( T.TABLE_NAME = TC.TABLE_NAME \n     ) \n INNER JOIN USER_TAB_COLUMNS C \n    ON \n     ( T.TABLE_NAME = C.TABLE_NAME \n     ) \n INNER JOIN USER_COL_COMMENTS CC \n    ON \n     ( T.TABLE_NAME = CC.TABLE_NAME \n          AND C.COLUMN_NAME = CC.COLUMN_NAME \n     ) \n  LEFT JOIN \n     ( SELECT IND.INDEX_NAME \n            , CONST.TABLE_NAME \n            , IND.COLUMN_NAME \n            , IND.COLUMN_POSITION \n         FROM USER_IND_COLUMNS IND \n        INNER JOIN USER_CONSTRAINTS CONST \n           ON \n            ( IND.INDEX_NAME = CONST.CONSTRAINT_NAME \n                 AND CONSTRAINT_TYPE = 'P' \n            ) \n     ) PK \n    ON \n     ( T.TABLE_NAME = PK.TABLE_NAME \n          AND C.COLUMN_NAME = PK.COLUMN_NAME \n     ) \n WHERE T.TABLE_NAME LIKE '\u30c6\u30fc\u30d6\u30eb\u540d' \n ORDER BY \n       T.TABLE_NAME \n     , C.COLUMN_ID;\n```\n\n\u5bfe\u3057\u3066Oracle\u306f\u7d50\u69cb\u91cd\u305f\u3044\u3067\u3059\u3002\n\n\n\u53c2\u8003\u5143\uff1a\nPostgreSQL\u306b\u3066\u30c6\u30fc\u30d6\u30eb\u3084\u30ab\u30e9\u30e0\u306e\u5404\u7a2e\u60c5\u5831\u3092\u53d6\u5f97\u3059\u308bSQL (\u30c6\u30fc\u30d6\u30eb\u4e00\u89a7, \u30ab\u30e9\u30e0\u4e00\u89a7, \u30d7\u30e9\u30a4\u30de\u30ea\u30fc\u30ad\u30fc\u60c5\u5831\u53d6\u5f97, \u30c6\u30fc\u30d6\u30eb\u306e\u30b3\u30e1\u30f3\u30c8\u3092\u53d6\u5f97, \u30ab\u30e9\u30e0\u306e\u30b3\u30e1\u30f3\u30c8\u3092\u53d6\u5f97)\nhttp://devlights.hatenablog.com/entry/20080226/p1\n", "tags": ["PostgreSQL", "SQL", "oracle", "MySQL"]}