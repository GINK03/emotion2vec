{"context": "\u51ac\u4f11\u307f\u306e\u81ea\u7531\u7814\u7a76\n\u30c7\u30e2\u3082\u3042\u308b\u3088\n\n\u52d5\u6a5f\n\n\n\u3053\u306e\u8a18\u4e8b\u3092\u8aad\u3093\u3067\u5b66\u751f\u6642\u4ee3\u540c\u3058\u3053\u3068\u3084\u3063\u3066\u305f\u306e\u304c\u61d0\u304b\u3057\u304f\u306a\u3063\u305f\u306e\u3067\n\n\u3053\u306e\u8a18\u4e8b\u3092\u8aad\u3093\u3060\u3089\u3051\u3063\u3053\u3046\u7c21\u5358\u306b\u3067\u304d\u305d\u3046\u3060\u3063\u305f\u306e\u3067\n\n\u30ea\u30d0\u30fc\u30b7\u306e\u30eb\u30fc\u30eb\u3092\u5b66\u3070\u305b\u308b\u3068\u304b\u3058\u3083\u306a\u304f\u7d14\u7c8b\u306b\u5f37\u3044AI\u3092\u76ee\u6307\u3057\u307e\u3059\u3002\n\u30ea\u30dd\u30b8\u30c8\u30ea\n\nDQN\u4ee5\u524d\u306e\u8a71\u984c\n\n\u76e4\u9762\n\u76e4\u9762\u306f6x6\u3068\u3057\u307e\u3057\u305f\u3002\n\u3082\u3068\u3082\u3068\u306f8x8\u3067\u3084\u3063\u3066\u3044\u305f\u306e\u3067\u3059\u304c\u3001\u30e2\u30c7\u30eb\u3001\u5b66\u7fd2\u30c7\u30fc\u30bf\u3068\u3082\u306b\u305d\u308c\u306a\u308a\u306e\u5927\u304d\u3055\u306b\u306a\u308b\u306e\u30676x6\u304f\u3089\u3044\u304c\u304a\u8a66\u3057\u306b\u306f\u3061\u3087\u3046\u3069\u3088\u304b\u3063\u305f\u3067\u3059\u3002\n\u3068\u3044\u3046\u304b6x6\u3067\u5076\u7136\u3046\u307e\u304f\u884c\u3063\u3066\u3053\u308c\u3067\u3044\u3063\u304b\u3063\u3066\u306a\u3063\u305f\n\nAI\u3092\u7528\u610f\n\u5b66\u7fd2\u306e\u305f\u3081\u306e\u68cb\u8b5c\u3092\u5927\u91cf\u751f\u6210\u3057\u305f\u3044\u306e\u3067\u9069\u5f53\u306aAI\u3092\u4f5c\u308a\u307e\u3059\u3002\n\u4eca\u65e5\u306f\u5b8c\u5168\u30e9\u30f3\u30c0\u30e0\u3068\u30e2\u30f3\u30c6\u30ab\u30eb\u30ed\u6728\u63a2\u7d22\u3092\u4f5c\u308a\u307e\u3059\u3002\n\u305d\u3057\u3066\u3067\u304d\u305f\u3082\u306e\u304c\u3053\u3061\u3089\u306b\u306a\u308a\u307e\u3059\u3002\n\u3053\u306e\u8a18\u4e8b\u3067\u306fMTS(n)\u3067\u30d7\u30ec\u30a4\u30a2\u30a6\u30c8\u6570n\u56de\u306e\u30e2\u30f3\u30c6\u30ab\u30eb\u30ed\u6728\u63a2\u7d22\u306eAI\u3092\u793a\u3059\u3082\u306e\u3057\u307e\u3059\u3002\n\n\u68cb\u8b5c\u306e\u751f\u6210\n\u3053\u3061\u3089\u3067\u7d39\u4ecb\u3055\u308c\u3066\u3044\u308bNeural Fitted Q Iteration\u3063\u307d\u3044\u3082\u306e\u3067\u5b66\u7fd2\u3059\u308b\u306e\u3067\u68cb\u8b5c\u3092\u4f5c\u3063\u3066\u304a\u304d\u307e\u3059\u3002\n\u68cb\u8b5c\u306b\u306f\u76e4\u9762\u3068\u624b\u756a\u306e\u9032\u884c\u3092\u8a18\u9332\u3057\u3001\u3068\u308a\u3042\u3048\u305a20\u4e07\u5c40\u5206\u307b\u3069\u7528\u610f\u3057\u307e\u3057\u305f\u3002\nDQN\u3060\u3068\u826f\u8cea\u306a\u68cb\u8b5c\u3092\u7528\u610f\u3057\u306a\u304f\u3066\u3044\u3044\u306e\u3067\u975e\u5e38\u306b\u697d\u3002\u5b8c\u5168\u30e9\u30f3\u30c0\u30e0\u540c\u58eb\u3067\u6570\u5341\u5206\u56de\u3059\u3060\u3051\u3067\u3067\u304d\u307e\u3059\u3002\n\nDQN\u306e\u8a71\u984c\n\u57fa\u672c\u7684\u306a\u3053\u3068\u306f\u3053\u3061\u3089\u306e\u8a18\u4e8b\u53c2\u7167\u3002\n\n\u5165\u529b\nDQN\u306f\u5165\u529b\u3068\u3057\u3066\u72b6\u614bs\u3068\u884c\u52d5a\u3092\u53d6\u308a\u307e\u3059\u3002\n\u4eca\u56de\u306f\u72b6\u614b\u3092\u76e4\u9762\u3068\u624b\u756a\u3001\u884c\u52d5\u3092\u6253\u3063\u305f\u3042\u3068\u306e\u76e4\u9762\u3068\u3057\u307e\u3057\u305f\u3002\nDQN\u3067\u3088\u304f\u3042\u308b\u30a2\u30bf\u30ea\u306e\u30b2\u30fc\u30e0\u3067\u306f\u884c\u52d5\u4ee5\u5916\u306e\u8981\u56e0(\u6575\u306e\u79fb\u52d5\u306a\u3069)\u304c\u6b21\u306e\u30b9\u30c6\u30fc\u30c8\u306b\u5f71\u97ff\u3092\u53ca\u307c\u3059\u305f\u3081\u3001\u884c\u52d5\u306f\u5358\u7d14\u306b\u30ad\u30fc\u5165\u529b\u7b49\u306b\u3057\u304b\u3067\u304d\u307e\u305b\u3093\u3002\u4e00\u65b9\u30ea\u30d0\u30fc\u30b7\u3067\u306f\u81ea\u5206\u306e\u884c\u52d5\u3067\u5b8c\u5168\u306b\u6b21\u306e\u30b9\u30c6\u30fc\u30c8\u304c\u5b9a\u307e\u308b\u306e\u3067\u3053\u306e\u3088\u3046\u306b\u3057\u3066\u307f\u307e\u3057\u305f\u3002\n\n\u5831\u916c\u3068\u51fa\u529b\nDQN\u306f\u5404\u884c\u52d5\u306b\u5831\u916cr\u3092\u5b9a\u3081\u307e\u3059\u3002\n\u4eca\u56de\u306f\u884c\u52d5\u306e\u7d50\u679c\u7d42\u5c40\u3068\u306a\u308a\u3001\u52dd\u3063\u305f\u5834\u5408\u306f+1\u3001\u8ca0\u3051\u305f\u5834\u5408\u306f-1\u3001\u5f15\u304d\u5206\u3051\u3084\u7d42\u5c40\u4ee5\u524d\u306e\u5834\u5408\u306f0\u3068\u3057\u307e\u3057\u305f\u3002\n\u3053\u308c\u306b\u3088\u308a\u4e2d\u9593\u3067\u306e\u30b9\u30b3\u30a2\u306f\u5fc5\u305a[-1, 1]\u306b\u53ce\u307e\u308b\u3053\u3068\u306b\u306a\u308a\u3001\u51fa\u529b\u3092tanh\u306b\u3067\u304d\u307e\u3059\u3002\n\u307e\u305f\u30bc\u30ed\u30b5\u30e0\u30b2\u30fc\u30e0\u3068\u60f3\u5b9a\u3059\u308b\u3053\u3068\u3067\u9ed2\u306e\u30b9\u30b3\u30a2=-\u767d\u306e\u30b9\u30b3\u30a2\u304c\u6210\u308a\u7acb\u3061\u3001\u5f8c\u8ff0\u3059\u308bR\n\u306e\u63a8\u5b9a\u5024\u8a08\u7b97\u306b\u7528\u3044\u308b\u3053\u3068\u304c\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\n\u3064\u3044\u3067\u306bQ\u5024\u306e\u4f1d\u64ad\u3082\u898b\u3084\u3059\u3044\u3067\u3059\u3002\n\nR\u306e\u63a8\u5b9a\u5024\u8a08\u7b97\nr\u3092\u7528\u3044\u3066\u6559\u5e2b\u4fe1\u53f7\u3067\u3042\u308b\u7dcf\u5831\u916cR\u3092\u8a08\u7b97\u3057\u307e\u3059(\u53c2\u7167)\u3002\nQ_\\theta(s, a) = r + \\gamma*\\max_{a'}Q_\\theta(s',a')\nQ\u03b8(s,a)=r+\u03b3\u2217max{Q_\\theta(s, a) = r + \\gamma*\\max_{a'}Q_\\theta(s',a')\n}\n\u6559\u5e2b\u4fe1\u53f7\u306e\u5f0f\u306f\u3053\u308c\u3067\u3059\u304c\u3001\u30ea\u30d0\u30fc\u30b7\u306e\u5834\u5408\u306f\u9ed2\u767d\u4ea4\u4e92\u306b\u306a\u3063\u3066\u3044\u308b\u305f\u3081\u3001s\u306e\u624b\u756a\u3068s'\u306e\u624b\u756a\u304c\u7570\u306a\u308b\u3053\u3068\u3067\u3053\u306e\u5f0f\u3092\u5358\u7d14\u306b\u66f8\u304d\u5199\u3059\u3060\u3051\u3067\u306f\u6b32\u3057\u3044\u5024\u304c\u51fa\u3066\u304f\u308c\u307e\u305b\u3093\u3002\n\u3053\u3053\u3067\u5148\u8ff0\u306e\u30bc\u30ed\u30b5\u30e0\u306e\u4eee\u5b9a\u3092\u7528\u3044\u3066\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u66f8\u304d\u63db\u3048\u307e\u3059\u3002\nQ_\\theta(s, a) = \\left\\{\n\\begin{array}{ll}\n r + \\gamma*\\max_{a'}Q_\\theta(s',a') & (s\u3068s'\u3067\u624b\u756a\u304c\u540c\u3058)\\\\\n r - \\gamma*\\max_{a'}Q_\\theta(s',a') & (s\u3068s'\u3067\u624b\u756a\u304c\u7570\u306a\u308b)\n\\end{array}\n\\right.\n{Q_\\theta(s, a) = \\left\\{\n\\begin{array}{ll}\n r + \\gamma*\\max_{a'}Q_\\theta(s',a') & (s\u3068s'\u3067\u624b\u756a\u304c\u540c\u3058)\\\\\n r - \\gamma*\\max_{a'}Q_\\theta(s',a') & (s\u3068s'\u3067\u624b\u756a\u304c\u7570\u306a\u308b)\n\\end{array}\n\\right.\n}{Q_\\theta(s, a) = \\left\\{\n\\begin{array}{ll}\n r + \\gamma*\\max_{a'}Q_\\theta(s',a') & (s\u3068s'\u3067\u624b\u756a\u304c\u540c\u3058)\\\\\n r - \\gamma*\\max_{a'}Q_\\theta(s',a') & (s\u3068s'\u3067\u624b\u756a\u304c\u7570\u306a\u308b)\n\\end{array}\n\\right.\n}\n\u624b\u756a\u304c\u7570\u306a\u3063\u3066\u3044\u308b\u5834\u5408\u306f\u3001\u30bc\u30ed\u30b5\u30e0\u306e\u4eee\u5b9a\u304b\u3089\u76f8\u624b\u306e\u30b9\u30b3\u30a2\u306e\u7b26\u53f7\u53cd\u8ee2\u304c\u81ea\u8eab\u306e\u30b9\u30b3\u30a2\u3068\u306a\u308b\u306e\u3067\u3001\u3053\u306e\u3088\u3046\u306a\u5f0f\u306b\u306a\u308a\u307e\u3057\u305f\u3002\u30df\u30cb\u30de\u30c3\u30af\u30b9\u6cd5\u3067\u3082\u540c\u3058\u3088\u3046\u306a\u3053\u3068\u3059\u308b\u306e\u3067\u81ea\u7136\u306b\u601d\u3044\u3064\u304d\u307e\u3057\u305f\u304c\u3042\u3063\u3066\u3044\u308b\u304b\u306f\u308f\u304b\u3093\u306a\u3044\u3002\n\u3055\u3089\u306b\u30ea\u30d0\u30fc\u30b7\u306e\u76e4\u9762\u306f\u659c\u3081\u306e\u4e8c\u8ef8\u3001\u304a\u3088\u3073180\u5ea6\u56de\u8ee2\u3057\u305f\u76e4\u9762\u304c\u540c\u3058\u3082\u306e\u3068\u8003\u3048\u3089\u308c\u308b\u305f\u3081\u3001\u305d\u308c\u3089\u56db\u7a2e\u306e\u4e2d\u3067max\u3092\u53d6\u308b\u3053\u3068\u306b\u3088\u3063\u3066\u4f1d\u64ad\u306e\u901f\u5ea6\u3092\u65e9\u3081\u3088\u3046\u3068\u3044\u3046\u30a2\u30a4\u30c7\u30a3\u30a2\u3082\u3076\u3061\u8fbc\u307f\u307e\u3057\u305f\u3002\n\u30b3\u30fc\u30c9\u306f\u3053\u306e\u3078\u3093\u306b\u306a\u308a\u307e\u3059\u304c\u3001\u9ad8\u901f\u5316\u306e\u305f\u3081\u306bmax\u8a08\u7b97\u306e\u305f\u3081\u306epredict\u3092\u4e00\u62ec\u3067\u3084\u3063\u3066\u3057\u3066\u3044\u305f\u308a\u3001\u03b5-greedy\u306e\u30b3\u30fc\u30c9\u304c\u6df7\u5165\u3057\u3066\u3044\u305f\u308a\u3057\u3066\u6050\u308d\u3057\u304f\u8aad\u307f\u306b\u304f\u304f\u4ed5\u4e0a\u304c\u3063\u3066\u304a\u308a\u307e\u3059\u3002\n(2017/1/1\u8ffd\u8a18\uff1a8\u8def\u76e4\u3092\u691c\u8a0e\u3057\u3066\u3044\u308b\u969b\u306b\u6c17\u3065\u304d\u307e\u3057\u305f\u304cNFQ\u3067\u306f\u03b5-greedy\u306f\u8981\u3089\u306a\u3044\u3088\u3046\u3067\u3059\u3002)\n\n\u30e2\u30c7\u30eb\nKeras\u306e\u9577\u6240\u3092\u6d3b\u304b\u3057\u3066\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u30e2\u30c7\u30eb\u306b\u3057\u307e\u3057\u305f\u3002\ndef create_model6():\n\n    board_input = Input(shape=[6, 6])\n    action_input = Input(shape=[6, 6])\n    color_input = Input(shape=[1])\n\n    model_v = Sequential([\n        InputLayer([6, 6]),\n        Reshape([6, 6, 1]),\n        Conv2D(64, 6, 1), # 1x6\n        ELU(),\n        Conv2D(64, 1, 1),\n        ELU(),\n        Flatten()\n    ])\n\n    model_h = Sequential([\n        InputLayer([6, 6]),\n        Reshape([6, 6, 1]),\n        Conv2D(64, 1, 6), # 6x1\n        ELU(),\n        Conv2D(64, 1, 1),\n        ELU(),\n        Flatten()\n    ])\n\n    model_dr = Sequential([\n        InputLayer([6, 6]),\n        Reshape([6*6, 1]),\n        ZeroPadding1D(3),\n        Reshape([6, 7, 1]),\n        LocallyConnected2D(64, 6, 1),\n        ELU(),\n        LocallyConnected2D(64, 1, 1),\n        ELU(),\n        Flatten()\n    ])\n\n    model_dl = Sequential([\n        InputLayer([6, 6]),\n        Reshape([6*6, 1]),\n        ZeroPadding1D(2),\n        Reshape([8, 5, 1]),\n        LocallyConnected2D(64, 8, 1),\n        ELU(),\n        LocallyConnected2D(64, 1, 1),\n        ELU(),\n        Flatten()\n    ])\n\n    color_model = Sequential([\n        InputLayer([1]),\n        Dense(256),\n        ELU(),\n        Dense(1024),\n        ELU()\n    ])\n\n    merge_layer = merge([\n        model_v(board_input),\n        model_h(board_input),\n        model_dl(board_input),\n        model_dr(board_input),\n        color_model(color_input),\n        model_v(action_input),\n        model_h(action_input),\n        model_dl(action_input),\n        model_dr(action_input),\n    ], mode=\"concat\", concat_axis=-1) \n\n    x = Dense(2048)(merge_layer)\n    x = BatchNormalization()(x)\n    x = ELU()(x)\n    x = Dense(512)(x)\n    x = BatchNormalization()(x)\n    x = ELU()(x)\n    x = Dense(128)(x)\n    x = BatchNormalization()(x)\n    x = ELU()(x)\n    output = Dense(1, activation=\"tanh\")(x)\n\n    model = Model(input=[board_input, color_input, action_input], output=[output])\n\n    adam = Adam(lr=1e-4)\n    model.compile(optimizer=adam, loss=\"mse\")\n\n    return model\n\n\u307e\u305a\u73fe\u5728\u3068\u884c\u52d5\u5f8c\u306e\u4e8c\u3064\u306e\u76e4\u9762\u3067\u3059\u304c\u3001\u3053\u308c\u3089\u306f\u91cd\u307f\u5171\u6709\u3057\u305f\u56db\u7a2e\u306e\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306b\u5165\u529b\u3055\u308c\u307e\u3059\u3002\nmodel_v, model_h\u306f\u898b\u305f\u307e\u3093\u307e6x1, 1x6\u7573\u307f\u8fbc\u307f\u306e\u5f8c\u306b1x1\u3067\u66f4\u306b\u7573\u307f\u8fbc\u3093\u3067\u3044\u307e\u3059\u3002\n\u3053\u308c\u306b\u3088\u308a\u7e26\u4e00\u5217\u3001\u6a2a\u4e00\u5217\u306e\u307f\u3092\u898b\u305f\u8a08\u7b97\u304c\u3067\u304d\u307e\u3059\u3002\n\u6b8b\u308a\u306emodel_dl,model_dr\u306f\u659c\u3081\u5217\u306e\u8a08\u7b97\u3067\u3059\u3002\u307e\u305aZeroPadding\u3068Reshape\u3092\u3046\u307e\u304f\u4f7f\u3063\u3066\u659c\u3081\u5217\u3092\u7e26\u4e00\u5217\u306b\u63c3\u3048\u30016x1\u306eLocallyConnected2D\u306b\u304b\u3051\u307e\u3059\u3002\u4f8b\u3068\u3057\u3066model_dr\u3067\u306f\u4ee5\u4e0b\u306e\u56f3\u306e\u3088\u3046\u306b\u659c\u3081\u5217\u3092\u63c3\u3048\u3066\u3044\u307e\u3059\u3002\n\nLocallyConnected2D\u3092\u4f7f\u3063\u3066\u3044\u308b\u306e\u306f\u3053\u308c\u3089\u7e26\u5217\u306e\u793a\u3059\u3082\u306e\u304c\u7570\u306a\u308b\u305f\u3081\u3067\u3059\u3002\u307b\u3093\u3068\u306f\u5206\u96e2\u3057\u305f\u3044\u3093\u3067\u3059\u304c\u30b5\u30dc\u308a\u307e\u3057\u305f\u3002\n\u3042\u3068\u306f\u624b\u756a\u3082\u9069\u5f53\u306b\u5927\u304d\u304f\u3057\u3066\u3001\u5168\u51fa\u529b\u3092\u9023\u7d50\u3057\u3066\u304b\u3089\u306e\u5168\u7d50\u5408\u5c64\u306b\u306a\u308a\u307e\u3059\u3002\nKeras\u306f\u30e2\u30c7\u30eb\u8a2d\u8a08\u306e\u81ea\u7531\u5ea6\u9ad8\u3044\u3093\u3067\u3059\u304c\u3001Model, Sequence\u3068Layer\u304c\u5225\u3051\u9694\u3066\u306a\u304f\u4f7f\u3048\u308b\u3068\u898b\u305b\u304b\u3051\u3066\u4f7f\u3048\u306a\u304b\u3063\u305f\u308a\u3059\u308b\u306e\u3067\u7d50\u69cb\u8ff7\u3044\u307e\u3059\u3002\u6700\u5f8c\u306e\u5168\u7d50\u5408\u5c64\u306e\u3042\u305f\u308a\u304c\u305d\u306e\u82e6\u3057\u307f\u306e\u7523\u7269\u3068\u306a\u3063\u3066\u3044\u307e\u3059\u3002\n\u3042\u3068\u3053\u306e\u8a18\u4e8b\u3067InputLayer\u3092\u77e5\u3063\u3066\u6357\u3063\u305f\u306e\u3067\u3082\u3063\u3068\u3044\u3044\u306d\u3055\u308c\u308b\u3068\u3044\u3044\u3068\u601d\u3046\u3002\n\n\u5b66\u7fd2\u7d4c\u904e\u78ba\u8a8d\n\u7d4c\u904e\u78ba\u8a8d\u306f\u4e8c\u901a\u308a\u306e\u65b9\u6cd5\u3092\u4f7f\u3044\u307e\u3057\u305f\u3002\n\n\u5b9f\u969b\u306b\u6226\u308f\u305b\u308b\n\u9069\u5f53\u306a\u30a4\u30c6\u30ec\u30fc\u30b7\u30e7\u30f3\u56de\u6570\u3054\u3068\u306b\u30e9\u30f3\u30c0\u30e0AI\u3068\u6570\u767e\u6226\u3055\u305b\u3066\u3001\u52dd\u7387\u304c\u3069\u3046\u306a\u3063\u3066\u3044\u308b\u304b\u3092\u898b\u307e\u3057\u305f\u3002\n\u5b9f\u306f\u5f53\u521d\u5b9f\u88c5\u304c\u30d0\u30b0\u3063\u3066\u3044\u3066\u3001\u6c17\u3065\u3044\u3066\u304b\u3089\u4fee\u6b63\u3057\u3066\u7d9a\u304d\u3092\u59cb\u3081\u3066\u307f\u305f\u3089\u305d\u306e\u6642\u70b9\u306799%\u8d85\u3048\u306e\u52dd\u7387\u306b\u306a\u3063\u3066\u3044\u305f\u306e\u3067\u3042\u3093\u307e\u308a\u53c2\u8003\u306b\u306a\u3063\u3066\u3044\u307e\u305b\u3093\u3002\n\u5b66\u7fd2\u904e\u7a0b\u3067\u52dd\u7387\u304c\u6700\u3082\u826f\u3044\u30e2\u30c7\u30eb\u3092\u6b8b\u3059\u306e\u306b\u4f7f\u3044\u307e\u3057\u305f\u3002\n\n\u6700\u5584\u306b\u8fd1\u3044\u5bfe\u5c40\u306e\u30c7\u30fc\u30bf\u3092\u4e0e\u3048\u308b\nMTS(5000)\u540c\u58eb\u3067\u5bfe\u5c40\u3055\u305b\u305f\u68cb\u8b5c\u3092\u5165\u529b\u306b\u3042\u305f\u3048\u3066\u3069\u306e\u3088\u3046\u306a\u5024\u304c\u51fa\u308b\u304b\u898b\u3066\u307f\u307e\u3059\u3002\nDQN\u306f\u6700\u5584\u624b\u3092\u6307\u3057\u7d9a\u3051\u305f\u969b\u306e\u30b9\u30b3\u30a2\u3092\u63a8\u5b9a\u3059\u308b\u306e\u3067\u3001\u30d7\u30ec\u30a4\u30a2\u30a6\u30c8\u6570\u3092\u5927\u304d\u304f\u3068\u3063\u305fMTS\u3067\u6700\u5584\u306b\u8fd1\u3044\u624b\u3092\u6307\u3057\u7d9a\u3051\u305f\u30b9\u30b3\u30a2\u3092\u51fa\u3057\u3066\u307f\u3088\u3046\u3068\u3044\u3046\u30a2\u30a4\u30c7\u30a3\u30a2\u3067\u3059\u3002\n\u5b66\u7fd2\u7d42\u76e4\u3067\u306e\u51fa\u529b\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u306a\u3063\u3066\u3044\u307e\u3057\u305f\u3002\n 0: B: [-0.02196666 -0.02230018 -0.0303785  -0.03168077]\n 1: W: [-0.09994178 -0.10080269 -0.09473281 -0.09523395]\n 2: B: [-0.05049421 -0.0613905  -0.05865757 -0.0515893 ]\n 3: W: [-0.10307723 -0.11034401 -0.1078812  -0.11545543]\n 4: B: [-0.02195507 -0.01722838 -0.00687013 -0.00869585]\n 5: W: [-0.128447   -0.12213746 -0.14925914 -0.14207964]\n 6: B: [-0.22107203 -0.21318831 -0.1865633  -0.18185341]\n 7: W: [ 0.06178221  0.08316899  0.05964577  0.03900897]\n 8: B: [-0.22808655 -0.20577276 -0.16608836 -0.18835764]\n 9: W: [ 0.0713096   0.08927093  0.05861793  0.0417437 ]\n10: B: [-0.25330806 -0.2539109  -0.22571792 -0.20664638]\n11: W: [ 0.05460038  0.07116394  0.07360842  0.01370821]\n12: B: [-0.24553944 -0.22967289 -0.22448763 -0.2255006 ]\n13: W: [ 0.08806669  0.11078909  0.11152182  0.0635582 ]\n14: B: [-0.45493153 -0.45988095 -0.46441916 -0.41323128]\n15: W: [ 0.37723741  0.37333494  0.36738792  0.32914931]\n16: B: [-0.46461144 -0.44231483 -0.42101949 -0.38848421]\n17: W: [ 0.17253573  0.21936594  0.20173906  0.16213408]\n18: B: [-0.50654161 -0.52144158 -0.50978303 -0.51221204]\n19: W: [ 0.42853072  0.47864962  0.42829457  0.39107552]\n20: B: [-0.68370593 -0.69842124 -0.69973147 -0.70182347]\n21: W: [ 0.39964256  0.50497115  0.51084852  0.49810672]\n22: B: [-0.71973562 -0.70337516 -0.62852156 -0.67204589]\n23: W: [ 0.37252051  0.49400631  0.34360072  0.35528785]\n24: B: [-0.81641883 -0.84098679 -0.79452062 -0.82713711]\n25: W: [ 0.80729294  0.81642532  0.79480326  0.78571904]\n26: B: [-0.916417   -0.9247427  -0.90268892 -0.89786631]\n27: W: [ 0.93264407  0.93837488  0.93335259  0.9382773 ]\n28: W: [ 0.93243909  0.93243909  0.9183923   0.9183923 ]\n\n\u4e0a\u304b\u30891\u624b\u76ee\u30012\u624b\u76ee\u3001\u2026\u2026\u306e\u30b9\u30b3\u30a2\u3067\u3001\u6a2a\u65b9\u5411\u306f\u540c\u3058\u72b6\u614b\u3001\u884c\u52d5\u306e\u659c\u3081\u8ef8\u53cd\u8ee2\u3001180\u5ea6\u56de\u8ee2\u3067\u3059\u3002\n\u7d42\u5c40\u6642\u306e\u30b9\u30b3\u30a2\u304c\u5927\u304d\u304f\u306a\u3063\u3066\u3044\u308b\u3053\u3068\u3001\u624b\u756a\u306e\u5165\u308c\u66ff\u308f\u308a\u3067\u7b26\u53f7\u304c\u53cd\u8ee2\u3057\u3066\u3044\u308b\u3053\u3068\u306a\u3069\u304c\u8aad\u307f\u53d6\u308c\u307e\u3059\u3002\u6a2a\u65b9\u5411\u306e\u5024\u304c\u5927\u4f53\u540c\u3058\u304f\u3089\u3044\u306b\u306a\u3063\u3066\u3044\u308b\u306e\u3082\u305d\u308c\u3089\u306e\u5bfe\u7b49\u6027\u3092\u793a\u3057\u3066\u3044\u308b\u3088\u3046\u3067\u826f\u3002\n\u5e8f\u76e4\u306e\u307b\u3046\u306fQ\u5024\u304c\u4f1d\u64ad\u3057\u3066\u3044\u306a\u3044\u306e\u304b\u305d\u3082\u305d\u3082\u4e0d\u5b9a\u306a\u72b6\u614b\u306a\u306e\u304b\u3002\u5272\u5f15\u7387\u03b3\u306f\u3042\u307e\u308a\u52b9\u3044\u3066\u3044\u306a\u3044\u3088\u3046\u3067\u3059\u306d\u2026\u2026\u3002\n\n\u5b66\u7fd2\u7d50\u679c\n\u4ee5\u4e0a\u306e\u3088\u3046\u306a\u611f\u3058\u3067\uff13\u65e5\u307b\u3069\u56de\u3057\u307e\u3057\u305f\u3002\n\u30e1\u30a4\u30c9\u30a4\u30f3\u30a2\u30d3\u30b9\u306e\u65b0\u520a\u3092\u8cb7\u3063\u3066\u5e30\u3063\u3066\u304d\u305f\u3089\u51fa\u529b\u304c\u5168\u90e8nan\u306b\u306a\u3063\u3066\u304a\u308a\u51b7\u3084\u6c57\u3002\u306a\u3093\u3088\u308a\u3093\u306a\u3060\u3089\u3051\u306b\u306a\u3063\u3066\u307b\u3057\u3044\u3002\n\u5e78\u3044\u6b8b\u3063\u3066\u3044\u305f\u30e2\u30c7\u30eb\u3092\u4f7f\u3063\u3066\u52dd\u7387\u3092\u8a55\u4fa1\u3057\u3066\u307f\u307e\u3057\u305f\u3002\n\n\u30e9\u30f3\u30c0\u30e0\u76f8\u624b\u3067995/1000\nMTS(30)\u76f8\u624b\u306795/100\nMTS(100)\u76f8\u624b\u30676/10\nMTS(1000)\u76f8\u624b\u30672/10\n\n\u3046\u30fc\u3093\u5fae\u5999\uff1f\u30e9\u30f3\u30c0\u30e0\u76f8\u624b\u306f\u5f8c\u534a\u6226\u8853\u3060\u3051\u3067\u3082\u512a\u308c\u3066\u3044\u308c\u3070\u52dd\u3066\u308b\u306f\u305a\u306a\u306e\u3067\u3001\u5f8c\u534a\u304b\u3089\u4f1d\u64ad\u3059\u308bDQN\u3060\u3068\u52dd\u7387\u4e0a\u304c\u308a\u3084\u3059\u3044\u304b\u306a\u30fc\u3068\u306f\u601d\u3063\u3066\u3044\u307e\u3057\u305f\u304c\u3001\u5f8c\u534a\u306e\u307b\u3046\u304c\u5f37\u3044\u306f\u305a\u306eMTS\u76f8\u624b\u306b\u3082\u52dd\u3066\u305f\u306e\u306f\u3061\u3087\u3063\u3068\u9a5a\u304d\u307e\u3057\u305f\u3002\u4e2d\u76e4\u307e\u3067\u306b\u512a\u52e2\u3092\u53d6\u308c\u305f\u306e\u3067\u3057\u3087\u3046\u304b\u3002\nnan\u304c\u3067\u306a\u3051\u308c\u3070\u3082\u3063\u3068\u5148\u307e\u3067\u884c\u3051\u3066\u5f37\u304f\u306a\u308a\u305d\u3046\u306a\u611f\u3058\u306f\u3057\u307e\u3059\u3002\n\n\u30c7\u30e2\n\u524d\u304b\u3089GCP\u4f7f\u3063\u3066\u307f\u305f\u304b\u3063\u305f\u306e\u3067\u7121\u6599\u67a0\u4f7f\u3063\u3066\u307f\u307e\u3057\u305f\u3002\n\u843d\u3061\u3066\u306a\u3051\u308c\u3070\u5e74\u672b\u5e74\u59cb\u306e\u9593\u304f\u3089\u3044\u306f\u52d5\u3044\u3066\u308b\u3068\u601d\u3044\u307e\u3059\u3002\nhttp://104.155.201.107:8888/\n\u4e0b\u306e\u30bb\u30ec\u30af\u30c8\u30dc\u30c3\u30af\u30b9\u3067DQN\u3092\u9078\u3076\u3068DQN\u3067\u3059\u3002\n\n\u8003\u5bdf\n\n\u30e2\u30c7\u30eb\u306b\u3064\u3044\u3066\n\u30ea\u30d0\u30fc\u30b7\u306a\u306e\u3067\u7e26\u6a2a\u659c\u3081\u3092\u8003\u616e\u3067\u304d\u308b\u3088\u3046\u306a\u30e2\u30c7\u30eb\u3092\u8a2d\u8a08\u3057\u307e\u3057\u305f\u3002\n\u631f\u3080\u30eb\u30fc\u30eb\u3092\u5b66\u3079\u305f\u304b\u306f\u77e5\u308a\u307e\u305b\u3093\u304c\u958b\u653e\u5ea6\u304f\u3089\u3044\u306f\u898b\u308c\u3066\u305d\u3046\uff1f\n\u5b9f\u969b\u306e\u3068\u3053\u308d\u884c\u52d5\u306e\u4fa1\u5024\u306f\u884c\u52d5\u5f8c\u306e\u76e4\u9762\u3060\u3051\u3067\u3060\u3044\u305f\u3044\u5206\u304b\u308a\u305d\u3046\u306a\u306e\u3067\u3001\u72b6\u614b\u306e\u307b\u3046\u306e\u76e4\u9762\u306f\u5165\u308c\u306a\u304f\u3066\u3082\u826f\u304b\u3063\u305f\u6c17\u304c\u3057\u307e\u3059\u3002\u3069\u3093\u306a\u72b6\u614b\u304b\u3089\u3067\u3082\u884c\u52d5\u306e\u7d50\u679c\u304a\u306a\u3058\u72b6\u614b\u306b\u306a\u308b\u306e\u306a\u3089\u305d\u308c\u3089\u306e\u30b9\u30b3\u30a2\u306f\u540c\u3058\u306f\u305a\u306a\u306e\u3067\u3002\n\u9069\u5f53\u306b\u4f5c\u3063\u305f\u30e2\u30c7\u30eb\u3067\u3060\u3044\u305f\u3044\u3046\u307e\u304f\u884c\u3063\u3066\u3057\u307e\u3063\u305f\u611f\u3058\u306a\u306e\u3067\u3044\u308d\u3044\u308d\u3068\u691c\u8a0e\u306f\u8db3\u308a\u3066\u306a\u3044\u3067\u3059\u3002\u3067\u3082\u5b66\u7fd2\u4e00\u56de\u306b\u6570\u65e5\u304b\u304b\u308b\u306e\u306f\u7d50\u69cb\u304d\u3064\u3044\u3002\n\n\u30b9\u30b3\u30a2\u306b\u3064\u3044\u3066\n\u7d42\u76e4\u306e\u307b\u3046\u306e\u30b9\u30b3\u30a2\u306f\u624b\u756a\u3054\u3068\u306b\u53cd\u8ee2\u3057\u3066\u3044\u308b\u306e\u3067\u5b66\u7fd2\u304c\u9032\u3093\u3067\u3044\u308b\u3088\u3046\u306b\u306f\u898b\u3048\u307e\u3057\u305f\u3002\n\u4e00\u65b9\u3067\u30b9\u30b3\u30a2\u306e\u7d76\u5bfe\u5024\u306f\u03b3^n\u306e\u5f62\u306b\u306a\u308b\u306e\u304c\u7406\u60f3\u5f62\u306a\u306f\u305a\u306a\u306e\u306b\u305d\u308c\u3068\u306f\u3060\u3044\u3076\u96e2\u308c\u3066\u3044\u308b\u3088\u3046\u3067\u3057\u305f\u3002\n\u305d\u3082\u305d\u3082\u771f\u306eR\u306e\u5024\u306f\u3069\u3046\u306a\u308b\u306e\u304b\u2026\u2026\u5f8c\u624b\u6709\u5229\u3089\u3057\u3044\u306e\u3067\u4e00\u624b\u76ee\u304b\u3089\u9ed2\u304c\u30de\u30a4\u30ca\u30b9\u767d\u304c\u30d7\u30e9\u30b9\u306b\u306a\u308b\u306e\u3067\u3057\u3087\u3046\u304b\u3002\n\nTODO\n\nfloat32\u3067\u3084\u3063\u305f\u306e\u3067float64\u306b\u3057\u3066nan\u56de\u907f\u3001\u3088\u308a\u5148\u3092\u76ee\u6307\u3059\u3002\n\u3082\u3063\u3068\u7c21\u5358\u306a\u30e2\u30c7\u30eb\u3067\u3082\u3084\u3063\u3066\u307f\u308b\u3002\n8x8\u3067\u3084\u308b\u3002\n\nThat's it folks!\n\u51ac\u4f11\u307f\u306e\u81ea\u7531\u7814\u7a76\n[\u30c7\u30e2](#\u30c7\u30e2)\u3082\u3042\u308b\u3088\n\n# \u52d5\u6a5f\n- [\u3053\u306e\u8a18\u4e8b](http://qiita.com/gdmiwasawa/items/e1f2c990a3b1318f67e0)\u3092\u8aad\u3093\u3067\u5b66\u751f\u6642\u4ee3\u540c\u3058\u3053\u3068\u3084\u3063\u3066\u305f\u306e\u304c\u61d0\u304b\u3057\u304f\u306a\u3063\u305f\u306e\u3067\n- [\u3053\u306e\u8a18\u4e8b](http://qiita.com/Ugo-Nama/items/08c6a5f6a571335972d5)\u3092\u8aad\u3093\u3060\u3089\u3051\u3063\u3053\u3046\u7c21\u5358\u306b\u3067\u304d\u305d\u3046\u3060\u3063\u305f\u306e\u3067\n\n\u30ea\u30d0\u30fc\u30b7\u306e\u30eb\u30fc\u30eb\u3092\u5b66\u3070\u305b\u308b\u3068\u304b\u3058\u3083\u306a\u304f\u7d14\u7c8b\u306b\u5f37\u3044AI\u3092\u76ee\u6307\u3057\u307e\u3059\u3002\n[\u30ea\u30dd\u30b8\u30c8\u30ea](https://github.com/t-ae/neural-reversi/tree/qiita-6)\n\n# DQN\u4ee5\u524d\u306e\u8a71\u984c\n\n## \u76e4\u9762\n\u76e4\u9762\u306f6x6\u3068\u3057\u307e\u3057\u305f\u3002\n\u3082\u3068\u3082\u3068\u306f8x8\u3067\u3084\u3063\u3066\u3044\u305f\u306e\u3067\u3059\u304c\u3001\u30e2\u30c7\u30eb\u3001\u5b66\u7fd2\u30c7\u30fc\u30bf\u3068\u3082\u306b\u305d\u308c\u306a\u308a\u306e\u5927\u304d\u3055\u306b\u306a\u308b\u306e\u30676x6\u304f\u3089\u3044\u304c\u304a\u8a66\u3057\u306b\u306f\u3061\u3087\u3046\u3069\u3088\u304b\u3063\u305f\u3067\u3059\u3002\n~~\u3068\u3044\u3046\u304b6x6\u3067\u5076\u7136\u3046\u307e\u304f\u884c\u3063\u3066\u3053\u308c\u3067\u3044\u3063\u304b\u3063\u3066\u306a\u3063\u305f~~\n\n## AI\u3092\u7528\u610f\n\u5b66\u7fd2\u306e\u305f\u3081\u306e\u68cb\u8b5c\u3092\u5927\u91cf\u751f\u6210\u3057\u305f\u3044\u306e\u3067\u9069\u5f53\u306aAI\u3092\u4f5c\u308a\u307e\u3059\u3002\n\u4eca\u65e5\u306f\u5b8c\u5168\u30e9\u30f3\u30c0\u30e0\u3068\u30e2\u30f3\u30c6\u30ab\u30eb\u30ed\u6728\u63a2\u7d22\u3092\u4f5c\u308a\u307e\u3059\u3002\n\u305d\u3057\u3066\u3067\u304d\u305f\u3082\u306e\u304c[\u3053\u3061\u3089](https://github.com/t-ae/neural-reversi/blob/qiita-6/player.py)\u306b\u306a\u308a\u307e\u3059\u3002\n\u3053\u306e\u8a18\u4e8b\u3067\u306fMTS(n)\u3067\u30d7\u30ec\u30a4\u30a2\u30a6\u30c8\u6570n\u56de\u306e\u30e2\u30f3\u30c6\u30ab\u30eb\u30ed\u6728\u63a2\u7d22\u306eAI\u3092\u793a\u3059\u3082\u306e\u3057\u307e\u3059\u3002\n\n## \u68cb\u8b5c\u306e\u751f\u6210\n[\u3053\u3061\u3089](http://qiita.com/Ugo-Nama/items/08c6a5f6a571335972d5#%E9%96%A2%E6%95%B0%E8%BF%91%E4%BC%BC%E3%81%AB%E3%83%8B%E3%83%A5%E3%83%BC%E3%83%A9%E3%83%AB%E3%83%8D%E3%83%83%E3%83%88%E3%83%AF%E3%83%BC%E3%82%AF%E3%82%92%E4%BD%BF%E3%81%86)\u3067\u7d39\u4ecb\u3055\u308c\u3066\u3044\u308bNeural Fitted Q Iteration\u3063\u307d\u3044\u3082\u306e\u3067\u5b66\u7fd2\u3059\u308b\u306e\u3067\u68cb\u8b5c\u3092\u4f5c\u3063\u3066\u304a\u304d\u307e\u3059\u3002\n\u68cb\u8b5c\u306b\u306f\u76e4\u9762\u3068\u624b\u756a\u306e\u9032\u884c\u3092\u8a18\u9332\u3057\u3001\u3068\u308a\u3042\u3048\u305a20\u4e07\u5c40\u5206\u307b\u3069\u7528\u610f\u3057\u307e\u3057\u305f\u3002\nDQN\u3060\u3068\u826f\u8cea\u306a\u68cb\u8b5c\u3092\u7528\u610f\u3057\u306a\u304f\u3066\u3044\u3044\u306e\u3067\u975e\u5e38\u306b\u697d\u3002\u5b8c\u5168\u30e9\u30f3\u30c0\u30e0\u540c\u58eb\u3067\u6570\u5341\u5206\u56de\u3059\u3060\u3051\u3067\u3067\u304d\u307e\u3059\u3002\n\n# DQN\u306e\u8a71\u984c\n\u57fa\u672c\u7684\u306a\u3053\u3068\u306f[\u3053\u3061\u3089\u306e\u8a18\u4e8b](http://qiita.com/Ugo-Nama/items/08c6a5f6a571335972d5)\u53c2\u7167\u3002\n\n## \u5165\u529b\nDQN\u306f\u5165\u529b\u3068\u3057\u3066\u72b6\u614b`s`\u3068\u884c\u52d5`a`\u3092\u53d6\u308a\u307e\u3059\u3002\n\u4eca\u56de\u306f\u72b6\u614b\u3092\u76e4\u9762\u3068\u624b\u756a\u3001\u884c\u52d5\u3092\u6253\u3063\u305f\u3042\u3068\u306e\u76e4\u9762\u3068\u3057\u307e\u3057\u305f\u3002\nDQN\u3067\u3088\u304f\u3042\u308b\u30a2\u30bf\u30ea\u306e\u30b2\u30fc\u30e0\u3067\u306f\u884c\u52d5\u4ee5\u5916\u306e\u8981\u56e0(\u6575\u306e\u79fb\u52d5\u306a\u3069)\u304c\u6b21\u306e\u30b9\u30c6\u30fc\u30c8\u306b\u5f71\u97ff\u3092\u53ca\u307c\u3059\u305f\u3081\u3001\u884c\u52d5\u306f\u5358\u7d14\u306b\u30ad\u30fc\u5165\u529b\u7b49\u306b\u3057\u304b\u3067\u304d\u307e\u305b\u3093\u3002\u4e00\u65b9\u30ea\u30d0\u30fc\u30b7\u3067\u306f\u81ea\u5206\u306e\u884c\u52d5\u3067\u5b8c\u5168\u306b\u6b21\u306e\u30b9\u30c6\u30fc\u30c8\u304c\u5b9a\u307e\u308b\u306e\u3067\u3053\u306e\u3088\u3046\u306b\u3057\u3066\u307f\u307e\u3057\u305f\u3002\n\n## \u5831\u916c\u3068\u51fa\u529b\nDQN\u306f\u5404\u884c\u52d5\u306b\u5831\u916c`r`\u3092\u5b9a\u3081\u307e\u3059\u3002\n\u4eca\u56de\u306f\u884c\u52d5\u306e\u7d50\u679c\u7d42\u5c40\u3068\u306a\u308a\u3001\u52dd\u3063\u305f\u5834\u5408\u306f+1\u3001\u8ca0\u3051\u305f\u5834\u5408\u306f-1\u3001\u5f15\u304d\u5206\u3051\u3084\u7d42\u5c40\u4ee5\u524d\u306e\u5834\u5408\u306f0\u3068\u3057\u307e\u3057\u305f\u3002\n\u3053\u308c\u306b\u3088\u308a\u4e2d\u9593\u3067\u306e\u30b9\u30b3\u30a2\u306f\u5fc5\u305a[-1, 1]\u306b\u53ce\u307e\u308b\u3053\u3068\u306b\u306a\u308a\u3001\u51fa\u529b\u3092`tanh`\u306b\u3067\u304d\u307e\u3059\u3002\n\u307e\u305f\u30bc\u30ed\u30b5\u30e0\u30b2\u30fc\u30e0\u3068\u60f3\u5b9a\u3059\u308b\u3053\u3068\u3067`\u9ed2\u306e\u30b9\u30b3\u30a2=-\u767d\u306e\u30b9\u30b3\u30a2`\u304c\u6210\u308a\u7acb\u3061\u3001\u5f8c\u8ff0\u3059\u308b`R`\n\u306e\u63a8\u5b9a\u5024\u8a08\u7b97\u306b\u7528\u3044\u308b\u3053\u3068\u304c\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\n\u3064\u3044\u3067\u306bQ\u5024\u306e\u4f1d\u64ad\u3082\u898b\u3084\u3059\u3044\u3067\u3059\u3002\n\n## R\u306e\u63a8\u5b9a\u5024\u8a08\u7b97\n`r`\u3092\u7528\u3044\u3066\u6559\u5e2b\u4fe1\u53f7\u3067\u3042\u308b\u7dcf\u5831\u916c`R`\u3092\u8a08\u7b97\u3057\u307e\u3059([\u53c2\u7167](http://qiita.com/Ugo-Nama/items/08c6a5f6a571335972d5#deep%E3%81%98%E3%82%83%E3%81%AA%E3%81%84q-networkq%E5%AD%A6%E7%BF%92--%E9%96%A2%E6%95%B0%E8%BF%91%E4%BC%BC))\u3002\n\n```math\nQ_\\theta(s, a) = r + \\gamma*\\max_{a'}Q_\\theta(s',a')\n```\n\n\u6559\u5e2b\u4fe1\u53f7\u306e\u5f0f\u306f\u3053\u308c\u3067\u3059\u304c\u3001\u30ea\u30d0\u30fc\u30b7\u306e\u5834\u5408\u306f\u9ed2\u767d\u4ea4\u4e92\u306b\u306a\u3063\u3066\u3044\u308b\u305f\u3081\u3001`s`\u306e\u624b\u756a\u3068`s'`\u306e\u624b\u756a\u304c\u7570\u306a\u308b\u3053\u3068\u3067\u3053\u306e\u5f0f\u3092\u5358\u7d14\u306b\u66f8\u304d\u5199\u3059\u3060\u3051\u3067\u306f\u6b32\u3057\u3044\u5024\u304c\u51fa\u3066\u304f\u308c\u307e\u305b\u3093\u3002\n\u3053\u3053\u3067\u5148\u8ff0\u306e\u30bc\u30ed\u30b5\u30e0\u306e\u4eee\u5b9a\u3092\u7528\u3044\u3066\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u66f8\u304d\u63db\u3048\u307e\u3059\u3002\n\n```math\nQ_\\theta(s, a) = \\left\\{\n\\begin{array}{ll}\n r + \\gamma*\\max_{a'}Q_\\theta(s',a') & (s\u3068s'\u3067\u624b\u756a\u304c\u540c\u3058)\\\\\n r - \\gamma*\\max_{a'}Q_\\theta(s',a') & (s\u3068s'\u3067\u624b\u756a\u304c\u7570\u306a\u308b)\n\\end{array}\n\\right.\n```\n\n\u624b\u756a\u304c\u7570\u306a\u3063\u3066\u3044\u308b\u5834\u5408\u306f\u3001\u30bc\u30ed\u30b5\u30e0\u306e\u4eee\u5b9a\u304b\u3089\u76f8\u624b\u306e\u30b9\u30b3\u30a2\u306e\u7b26\u53f7\u53cd\u8ee2\u304c\u81ea\u8eab\u306e\u30b9\u30b3\u30a2\u3068\u306a\u308b\u306e\u3067\u3001\u3053\u306e\u3088\u3046\u306a\u5f0f\u306b\u306a\u308a\u307e\u3057\u305f\u3002\u30df\u30cb\u30de\u30c3\u30af\u30b9\u6cd5\u3067\u3082\u540c\u3058\u3088\u3046\u306a\u3053\u3068\u3059\u308b\u306e\u3067\u81ea\u7136\u306b\u601d\u3044\u3064\u304d\u307e\u3057\u305f\u304c\u3042\u3063\u3066\u3044\u308b\u304b\u306f\u308f\u304b\u3093\u306a\u3044\u3002\n\u3055\u3089\u306b\u30ea\u30d0\u30fc\u30b7\u306e\u76e4\u9762\u306f\u659c\u3081\u306e\u4e8c\u8ef8\u3001\u304a\u3088\u3073180\u5ea6\u56de\u8ee2\u3057\u305f\u76e4\u9762\u304c\u540c\u3058\u3082\u306e\u3068\u8003\u3048\u3089\u308c\u308b\u305f\u3081\u3001\u305d\u308c\u3089\u56db\u7a2e\u306e\u4e2d\u3067`max`\u3092\u53d6\u308b\u3053\u3068\u306b\u3088\u3063\u3066\u4f1d\u64ad\u306e\u901f\u5ea6\u3092\u65e9\u3081\u3088\u3046\u3068\u3044\u3046\u30a2\u30a4\u30c7\u30a3\u30a2\u3082\u3076\u3061\u8fbc\u307f\u307e\u3057\u305f\u3002\n\n\u30b3\u30fc\u30c9\u306f[\u3053\u306e\u3078\u3093](https://github.com/t-ae/neural-reversi/blob/qiita-6/train_data_creator.py#L77-L133)\u306b\u306a\u308a\u307e\u3059\u304c\u3001\u9ad8\u901f\u5316\u306e\u305f\u3081\u306b`max`\u8a08\u7b97\u306e\u305f\u3081\u306e`predict`\u3092\u4e00\u62ec\u3067\u3084\u3063\u3066\u3057\u3066\u3044\u305f\u308a\u3001\u03b5-greedy\u306e\u30b3\u30fc\u30c9\u304c\u6df7\u5165\u3057\u3066\u3044\u305f\u308a\u3057\u3066\u6050\u308d\u3057\u304f\u8aad\u307f\u306b\u304f\u304f\u4ed5\u4e0a\u304c\u3063\u3066\u304a\u308a\u307e\u3059\u3002\n(2017/1/1\u8ffd\u8a18\uff1a8\u8def\u76e4\u3092\u691c\u8a0e\u3057\u3066\u3044\u308b\u969b\u306b\u6c17\u3065\u304d\u307e\u3057\u305f\u304cNFQ\u3067\u306f\u03b5-greedy\u306f\u8981\u3089\u306a\u3044\u3088\u3046\u3067\u3059\u3002)\n\n## \u30e2\u30c7\u30eb\nKeras\u306e\u9577\u6240\u3092\u6d3b\u304b\u3057\u3066\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u30e2\u30c7\u30eb\u306b\u3057\u307e\u3057\u305f\u3002\n\n```\ndef create_model6():\n\n    board_input = Input(shape=[6, 6])\n    action_input = Input(shape=[6, 6])\n    color_input = Input(shape=[1])\n\n    model_v = Sequential([\n        InputLayer([6, 6]),\n        Reshape([6, 6, 1]),\n        Conv2D(64, 6, 1), # 1x6\n        ELU(),\n        Conv2D(64, 1, 1),\n        ELU(),\n        Flatten()\n    ])\n\n    model_h = Sequential([\n        InputLayer([6, 6]),\n        Reshape([6, 6, 1]),\n        Conv2D(64, 1, 6), # 6x1\n        ELU(),\n        Conv2D(64, 1, 1),\n        ELU(),\n        Flatten()\n    ])\n\n    model_dr = Sequential([\n        InputLayer([6, 6]),\n        Reshape([6*6, 1]),\n        ZeroPadding1D(3),\n        Reshape([6, 7, 1]),\n        LocallyConnected2D(64, 6, 1),\n        ELU(),\n        LocallyConnected2D(64, 1, 1),\n        ELU(),\n        Flatten()\n    ])\n\n    model_dl = Sequential([\n        InputLayer([6, 6]),\n        Reshape([6*6, 1]),\n        ZeroPadding1D(2),\n        Reshape([8, 5, 1]),\n        LocallyConnected2D(64, 8, 1),\n        ELU(),\n        LocallyConnected2D(64, 1, 1),\n        ELU(),\n        Flatten()\n    ])\n\n    color_model = Sequential([\n        InputLayer([1]),\n        Dense(256),\n        ELU(),\n        Dense(1024),\n        ELU()\n    ])\n\n    merge_layer = merge([\n        model_v(board_input),\n        model_h(board_input),\n        model_dl(board_input),\n        model_dr(board_input),\n        color_model(color_input),\n        model_v(action_input),\n        model_h(action_input),\n        model_dl(action_input),\n        model_dr(action_input),\n    ], mode=\"concat\", concat_axis=-1) \n\n    x = Dense(2048)(merge_layer)\n    x = BatchNormalization()(x)\n    x = ELU()(x)\n    x = Dense(512)(x)\n    x = BatchNormalization()(x)\n    x = ELU()(x)\n    x = Dense(128)(x)\n    x = BatchNormalization()(x)\n    x = ELU()(x)\n    output = Dense(1, activation=\"tanh\")(x)\n\n    model = Model(input=[board_input, color_input, action_input], output=[output])\n\n    adam = Adam(lr=1e-4)\n    model.compile(optimizer=adam, loss=\"mse\")\n\n    return model\n```\n\n\u307e\u305a\u73fe\u5728\u3068\u884c\u52d5\u5f8c\u306e\u4e8c\u3064\u306e\u76e4\u9762\u3067\u3059\u304c\u3001\u3053\u308c\u3089\u306f\u91cd\u307f\u5171\u6709\u3057\u305f\u56db\u7a2e\u306e\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306b\u5165\u529b\u3055\u308c\u307e\u3059\u3002\n`model_v`, `model_h`\u306f\u898b\u305f\u307e\u3093\u307e6x1, 1x6\u7573\u307f\u8fbc\u307f\u306e\u5f8c\u306b1x1\u3067\u66f4\u306b\u7573\u307f\u8fbc\u3093\u3067\u3044\u307e\u3059\u3002\n\u3053\u308c\u306b\u3088\u308a\u7e26\u4e00\u5217\u3001\u6a2a\u4e00\u5217\u306e\u307f\u3092\u898b\u305f\u8a08\u7b97\u304c\u3067\u304d\u307e\u3059\u3002\n\u6b8b\u308a\u306e`model_dl`,`model_dr`\u306f\u659c\u3081\u5217\u306e\u8a08\u7b97\u3067\u3059\u3002\u307e\u305a`ZeroPadding`\u3068`Reshape`\u3092\u3046\u307e\u304f\u4f7f\u3063\u3066\u659c\u3081\u5217\u3092\u7e26\u4e00\u5217\u306b\u63c3\u3048\u30016x1\u306e`LocallyConnected2D`\u306b\u304b\u3051\u307e\u3059\u3002\u4f8b\u3068\u3057\u3066`model_dr`\u3067\u306f\u4ee5\u4e0b\u306e\u56f3\u306e\u3088\u3046\u306b\u659c\u3081\u5217\u3092\u63c3\u3048\u3066\u3044\u307e\u3059\u3002\n<img width=\"527\" alt=\"\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2016-12-27 15.46.43.png\" src=\"https://qiita-image-store.s3.amazonaws.com/0/121603/96758e25-aac6-4c2a-0471-765f8ad5f69d.png\">\n`LocallyConnected2D`\u3092\u4f7f\u3063\u3066\u3044\u308b\u306e\u306f\u3053\u308c\u3089\u7e26\u5217\u306e\u793a\u3059\u3082\u306e\u304c\u7570\u306a\u308b\u305f\u3081\u3067\u3059\u3002\u307b\u3093\u3068\u306f\u5206\u96e2\u3057\u305f\u3044\u3093\u3067\u3059\u304c\u30b5\u30dc\u308a\u307e\u3057\u305f\u3002\n\u3042\u3068\u306f\u624b\u756a\u3082\u9069\u5f53\u306b\u5927\u304d\u304f\u3057\u3066\u3001\u5168\u51fa\u529b\u3092\u9023\u7d50\u3057\u3066\u304b\u3089\u306e\u5168\u7d50\u5408\u5c64\u306b\u306a\u308a\u307e\u3059\u3002\n\nKeras\u306f\u30e2\u30c7\u30eb\u8a2d\u8a08\u306e\u81ea\u7531\u5ea6\u9ad8\u3044\u3093\u3067\u3059\u304c\u3001`Model, Sequence`\u3068`Layer`\u304c\u5225\u3051\u9694\u3066\u306a\u304f\u4f7f\u3048\u308b\u3068\u898b\u305b\u304b\u3051\u3066\u4f7f\u3048\u306a\u304b\u3063\u305f\u308a\u3059\u308b\u306e\u3067\u7d50\u69cb\u8ff7\u3044\u307e\u3059\u3002\u6700\u5f8c\u306e\u5168\u7d50\u5408\u5c64\u306e\u3042\u305f\u308a\u304c\u305d\u306e\u82e6\u3057\u307f\u306e\u7523\u7269\u3068\u306a\u3063\u3066\u3044\u307e\u3059\u3002\n\u3042\u3068[\u3053\u306e\u8a18\u4e8b](http://qiita.com/obsproth/items/cb352dccda36e2fde8ff)\u3067`InputLayer`\u3092\u77e5\u3063\u3066\u6357\u3063\u305f\u306e\u3067\u3082\u3063\u3068\u3044\u3044\u306d\u3055\u308c\u308b\u3068\u3044\u3044\u3068\u601d\u3046\u3002\n\n## \u5b66\u7fd2\u7d4c\u904e\u78ba\u8a8d\n\u7d4c\u904e\u78ba\u8a8d\u306f\u4e8c\u901a\u308a\u306e\u65b9\u6cd5\u3092\u4f7f\u3044\u307e\u3057\u305f\u3002\n\n### \u5b9f\u969b\u306b\u6226\u308f\u305b\u308b\n\u9069\u5f53\u306a\u30a4\u30c6\u30ec\u30fc\u30b7\u30e7\u30f3\u56de\u6570\u3054\u3068\u306b\u30e9\u30f3\u30c0\u30e0AI\u3068\u6570\u767e\u6226\u3055\u305b\u3066\u3001\u52dd\u7387\u304c\u3069\u3046\u306a\u3063\u3066\u3044\u308b\u304b\u3092\u898b\u307e\u3057\u305f\u3002\n\u5b9f\u306f\u5f53\u521d\u5b9f\u88c5\u304c\u30d0\u30b0\u3063\u3066\u3044\u3066\u3001\u6c17\u3065\u3044\u3066\u304b\u3089\u4fee\u6b63\u3057\u3066\u7d9a\u304d\u3092\u59cb\u3081\u3066\u307f\u305f\u3089\u305d\u306e\u6642\u70b9\u306799%\u8d85\u3048\u306e\u52dd\u7387\u306b\u306a\u3063\u3066\u3044\u305f\u306e\u3067\u3042\u3093\u307e\u308a\u53c2\u8003\u306b\u306a\u3063\u3066\u3044\u307e\u305b\u3093\u3002\n\u5b66\u7fd2\u904e\u7a0b\u3067\u52dd\u7387\u304c\u6700\u3082\u826f\u3044\u30e2\u30c7\u30eb\u3092\u6b8b\u3059\u306e\u306b\u4f7f\u3044\u307e\u3057\u305f\u3002\n\n### \u6700\u5584\u306b\u8fd1\u3044\u5bfe\u5c40\u306e\u30c7\u30fc\u30bf\u3092\u4e0e\u3048\u308b\nMTS(5000)\u540c\u58eb\u3067\u5bfe\u5c40\u3055\u305b\u305f\u68cb\u8b5c\u3092\u5165\u529b\u306b\u3042\u305f\u3048\u3066\u3069\u306e\u3088\u3046\u306a\u5024\u304c\u51fa\u308b\u304b\u898b\u3066\u307f\u307e\u3059\u3002\nDQN\u306f\u6700\u5584\u624b\u3092\u6307\u3057\u7d9a\u3051\u305f\u969b\u306e\u30b9\u30b3\u30a2\u3092\u63a8\u5b9a\u3059\u308b\u306e\u3067\u3001\u30d7\u30ec\u30a4\u30a2\u30a6\u30c8\u6570\u3092\u5927\u304d\u304f\u3068\u3063\u305fMTS\u3067\u6700\u5584\u306b\u8fd1\u3044\u624b\u3092\u6307\u3057\u7d9a\u3051\u305f\u30b9\u30b3\u30a2\u3092\u51fa\u3057\u3066\u307f\u3088\u3046\u3068\u3044\u3046\u30a2\u30a4\u30c7\u30a3\u30a2\u3067\u3059\u3002\n\u5b66\u7fd2\u7d42\u76e4\u3067\u306e\u51fa\u529b\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u306a\u3063\u3066\u3044\u307e\u3057\u305f\u3002\n\n```\n 0: B: [-0.02196666 -0.02230018 -0.0303785  -0.03168077]\n 1: W: [-0.09994178 -0.10080269 -0.09473281 -0.09523395]\n 2: B: [-0.05049421 -0.0613905  -0.05865757 -0.0515893 ]\n 3: W: [-0.10307723 -0.11034401 -0.1078812  -0.11545543]\n 4: B: [-0.02195507 -0.01722838 -0.00687013 -0.00869585]\n 5: W: [-0.128447   -0.12213746 -0.14925914 -0.14207964]\n 6: B: [-0.22107203 -0.21318831 -0.1865633  -0.18185341]\n 7: W: [ 0.06178221  0.08316899  0.05964577  0.03900897]\n 8: B: [-0.22808655 -0.20577276 -0.16608836 -0.18835764]\n 9: W: [ 0.0713096   0.08927093  0.05861793  0.0417437 ]\n10: B: [-0.25330806 -0.2539109  -0.22571792 -0.20664638]\n11: W: [ 0.05460038  0.07116394  0.07360842  0.01370821]\n12: B: [-0.24553944 -0.22967289 -0.22448763 -0.2255006 ]\n13: W: [ 0.08806669  0.11078909  0.11152182  0.0635582 ]\n14: B: [-0.45493153 -0.45988095 -0.46441916 -0.41323128]\n15: W: [ 0.37723741  0.37333494  0.36738792  0.32914931]\n16: B: [-0.46461144 -0.44231483 -0.42101949 -0.38848421]\n17: W: [ 0.17253573  0.21936594  0.20173906  0.16213408]\n18: B: [-0.50654161 -0.52144158 -0.50978303 -0.51221204]\n19: W: [ 0.42853072  0.47864962  0.42829457  0.39107552]\n20: B: [-0.68370593 -0.69842124 -0.69973147 -0.70182347]\n21: W: [ 0.39964256  0.50497115  0.51084852  0.49810672]\n22: B: [-0.71973562 -0.70337516 -0.62852156 -0.67204589]\n23: W: [ 0.37252051  0.49400631  0.34360072  0.35528785]\n24: B: [-0.81641883 -0.84098679 -0.79452062 -0.82713711]\n25: W: [ 0.80729294  0.81642532  0.79480326  0.78571904]\n26: B: [-0.916417   -0.9247427  -0.90268892 -0.89786631]\n27: W: [ 0.93264407  0.93837488  0.93335259  0.9382773 ]\n28: W: [ 0.93243909  0.93243909  0.9183923   0.9183923 ]\n```\n\n\u4e0a\u304b\u30891\u624b\u76ee\u30012\u624b\u76ee\u3001\u2026\u2026\u306e\u30b9\u30b3\u30a2\u3067\u3001\u6a2a\u65b9\u5411\u306f\u540c\u3058\u72b6\u614b\u3001\u884c\u52d5\u306e\u659c\u3081\u8ef8\u53cd\u8ee2\u3001180\u5ea6\u56de\u8ee2\u3067\u3059\u3002\n\u7d42\u5c40\u6642\u306e\u30b9\u30b3\u30a2\u304c\u5927\u304d\u304f\u306a\u3063\u3066\u3044\u308b\u3053\u3068\u3001\u624b\u756a\u306e\u5165\u308c\u66ff\u308f\u308a\u3067\u7b26\u53f7\u304c\u53cd\u8ee2\u3057\u3066\u3044\u308b\u3053\u3068\u306a\u3069\u304c\u8aad\u307f\u53d6\u308c\u307e\u3059\u3002\u6a2a\u65b9\u5411\u306e\u5024\u304c\u5927\u4f53\u540c\u3058\u304f\u3089\u3044\u306b\u306a\u3063\u3066\u3044\u308b\u306e\u3082\u305d\u308c\u3089\u306e\u5bfe\u7b49\u6027\u3092\u793a\u3057\u3066\u3044\u308b\u3088\u3046\u3067\u826f\u3002\n\u5e8f\u76e4\u306e\u307b\u3046\u306fQ\u5024\u304c\u4f1d\u64ad\u3057\u3066\u3044\u306a\u3044\u306e\u304b\u305d\u3082\u305d\u3082\u4e0d\u5b9a\u306a\u72b6\u614b\u306a\u306e\u304b\u3002\u5272\u5f15\u7387\u03b3\u306f\u3042\u307e\u308a\u52b9\u3044\u3066\u3044\u306a\u3044\u3088\u3046\u3067\u3059\u306d\u2026\u2026\u3002\n\n# \u5b66\u7fd2\u7d50\u679c\n\u4ee5\u4e0a\u306e\u3088\u3046\u306a\u611f\u3058\u3067\uff13\u65e5\u307b\u3069\u56de\u3057\u307e\u3057\u305f\u3002\n\u30e1\u30a4\u30c9\u30a4\u30f3\u30a2\u30d3\u30b9\u306e\u65b0\u520a\u3092\u8cb7\u3063\u3066\u5e30\u3063\u3066\u304d\u305f\u3089\u51fa\u529b\u304c\u5168\u90e8`nan`\u306b\u306a\u3063\u3066\u304a\u308a\u51b7\u3084\u6c57\u3002\u306a\u3093\u3088\u308a\u3093\u306a\u3060\u3089\u3051\u306b\u306a\u3063\u3066\u307b\u3057\u3044\u3002\n\u5e78\u3044\u6b8b\u3063\u3066\u3044\u305f\u30e2\u30c7\u30eb\u3092\u4f7f\u3063\u3066\u52dd\u7387\u3092\u8a55\u4fa1\u3057\u3066\u307f\u307e\u3057\u305f\u3002\n\n- \u30e9\u30f3\u30c0\u30e0\u76f8\u624b\u3067995/1000\n- MTS(30)\u76f8\u624b\u306795/100\n- MTS(100)\u76f8\u624b\u30676/10\n- MTS(1000)\u76f8\u624b\u30672/10\n\n\u3046\u30fc\u3093\u5fae\u5999\uff1f\u30e9\u30f3\u30c0\u30e0\u76f8\u624b\u306f\u5f8c\u534a\u6226\u8853\u3060\u3051\u3067\u3082\u512a\u308c\u3066\u3044\u308c\u3070\u52dd\u3066\u308b\u306f\u305a\u306a\u306e\u3067\u3001\u5f8c\u534a\u304b\u3089\u4f1d\u64ad\u3059\u308bDQN\u3060\u3068\u52dd\u7387\u4e0a\u304c\u308a\u3084\u3059\u3044\u304b\u306a\u30fc\u3068\u306f\u601d\u3063\u3066\u3044\u307e\u3057\u305f\u304c\u3001\u5f8c\u534a\u306e\u307b\u3046\u304c\u5f37\u3044\u306f\u305a\u306eMTS\u76f8\u624b\u306b\u3082\u52dd\u3066\u305f\u306e\u306f\u3061\u3087\u3063\u3068\u9a5a\u304d\u307e\u3057\u305f\u3002\u4e2d\u76e4\u307e\u3067\u306b\u512a\u52e2\u3092\u53d6\u308c\u305f\u306e\u3067\u3057\u3087\u3046\u304b\u3002\nnan\u304c\u3067\u306a\u3051\u308c\u3070\u3082\u3063\u3068\u5148\u307e\u3067\u884c\u3051\u3066\u5f37\u304f\u306a\u308a\u305d\u3046\u306a\u611f\u3058\u306f\u3057\u307e\u3059\u3002\n\n# \u30c7\u30e2\n\u524d\u304b\u3089GCP\u4f7f\u3063\u3066\u307f\u305f\u304b\u3063\u305f\u306e\u3067\u7121\u6599\u67a0\u4f7f\u3063\u3066\u307f\u307e\u3057\u305f\u3002\n\u843d\u3061\u3066\u306a\u3051\u308c\u3070\u5e74\u672b\u5e74\u59cb\u306e\u9593\u304f\u3089\u3044\u306f\u52d5\u3044\u3066\u308b\u3068\u601d\u3044\u307e\u3059\u3002\nhttp://104.155.201.107:8888/\n\u4e0b\u306e\u30bb\u30ec\u30af\u30c8\u30dc\u30c3\u30af\u30b9\u3067DQN\u3092\u9078\u3076\u3068DQN\u3067\u3059\u3002\n\n# \u8003\u5bdf\n\n## \u30e2\u30c7\u30eb\u306b\u3064\u3044\u3066\n\u30ea\u30d0\u30fc\u30b7\u306a\u306e\u3067\u7e26\u6a2a\u659c\u3081\u3092\u8003\u616e\u3067\u304d\u308b\u3088\u3046\u306a\u30e2\u30c7\u30eb\u3092\u8a2d\u8a08\u3057\u307e\u3057\u305f\u3002\n\u631f\u3080\u30eb\u30fc\u30eb\u3092\u5b66\u3079\u305f\u304b\u306f\u77e5\u308a\u307e\u305b\u3093\u304c\u958b\u653e\u5ea6\u304f\u3089\u3044\u306f\u898b\u308c\u3066\u305d\u3046\uff1f\n\u5b9f\u969b\u306e\u3068\u3053\u308d\u884c\u52d5\u306e\u4fa1\u5024\u306f\u884c\u52d5\u5f8c\u306e\u76e4\u9762\u3060\u3051\u3067\u3060\u3044\u305f\u3044\u5206\u304b\u308a\u305d\u3046\u306a\u306e\u3067\u3001\u72b6\u614b\u306e\u307b\u3046\u306e\u76e4\u9762\u306f\u5165\u308c\u306a\u304f\u3066\u3082\u826f\u304b\u3063\u305f\u6c17\u304c\u3057\u307e\u3059\u3002\u3069\u3093\u306a\u72b6\u614b\u304b\u3089\u3067\u3082\u884c\u52d5\u306e\u7d50\u679c\u304a\u306a\u3058\u72b6\u614b\u306b\u306a\u308b\u306e\u306a\u3089\u305d\u308c\u3089\u306e\u30b9\u30b3\u30a2\u306f\u540c\u3058\u306f\u305a\u306a\u306e\u3067\u3002\n\u9069\u5f53\u306b\u4f5c\u3063\u305f\u30e2\u30c7\u30eb\u3067\u3060\u3044\u305f\u3044\u3046\u307e\u304f\u884c\u3063\u3066\u3057\u307e\u3063\u305f\u611f\u3058\u306a\u306e\u3067\u3044\u308d\u3044\u308d\u3068\u691c\u8a0e\u306f\u8db3\u308a\u3066\u306a\u3044\u3067\u3059\u3002\u3067\u3082\u5b66\u7fd2\u4e00\u56de\u306b\u6570\u65e5\u304b\u304b\u308b\u306e\u306f\u7d50\u69cb\u304d\u3064\u3044\u3002\n\n## \u30b9\u30b3\u30a2\u306b\u3064\u3044\u3066\n\u7d42\u76e4\u306e\u307b\u3046\u306e\u30b9\u30b3\u30a2\u306f\u624b\u756a\u3054\u3068\u306b\u53cd\u8ee2\u3057\u3066\u3044\u308b\u306e\u3067\u5b66\u7fd2\u304c\u9032\u3093\u3067\u3044\u308b\u3088\u3046\u306b\u306f\u898b\u3048\u307e\u3057\u305f\u3002\n\u4e00\u65b9\u3067\u30b9\u30b3\u30a2\u306e\u7d76\u5bfe\u5024\u306f`\u03b3^n`\u306e\u5f62\u306b\u306a\u308b\u306e\u304c\u7406\u60f3\u5f62\u306a\u306f\u305a\u306a\u306e\u306b\u305d\u308c\u3068\u306f\u3060\u3044\u3076\u96e2\u308c\u3066\u3044\u308b\u3088\u3046\u3067\u3057\u305f\u3002\n\u305d\u3082\u305d\u3082\u771f\u306e`R`\u306e\u5024\u306f\u3069\u3046\u306a\u308b\u306e\u304b\u2026\u2026\u5f8c\u624b\u6709\u5229\u3089\u3057\u3044\u306e\u3067\u4e00\u624b\u76ee\u304b\u3089\u9ed2\u304c\u30de\u30a4\u30ca\u30b9\u767d\u304c\u30d7\u30e9\u30b9\u306b\u306a\u308b\u306e\u3067\u3057\u3087\u3046\u304b\u3002\n\n# TODO\n- float32\u3067\u3084\u3063\u305f\u306e\u3067float64\u306b\u3057\u3066nan\u56de\u907f\u3001\u3088\u308a\u5148\u3092\u76ee\u6307\u3059\u3002\n- \u3082\u3063\u3068\u7c21\u5358\u306a\u30e2\u30c7\u30eb\u3067\u3082\u3084\u3063\u3066\u307f\u308b\u3002\n- 8x8\u3067\u3084\u308b\u3002\n\nThat's it folks!\n", "tags": ["Keras", "\u6a5f\u68b0\u5b66\u7fd2", "DeepLearning", "DQN", "Python"]}