{"context": " More than 1 year has passed since last update.\n\n \u56e0\u5b50\u306e\u90e8\u5c4b\u3092\u89e3\u304f\n\u56e0\u5b50\u306e\u90e8\u5c4b\u3068\u306f\u3001\u6570\u72ec\u306b\u4f3c\u305f\u30d1\u30ba\u30eb\u3067\u3059\u3002\u3053\u306e\u30d1\u30ba\u30eb\u3082\u7d44\u5408\u305b\u6700\u9069\u5316\u3092\u4f7f\u3063\u3066\u89e3\u3051\u307e\u3059\u3002\n\u53c2\u8003\n- \u56e0\u5b50\u306e\u90e8\u5c4b wikipedia\n- \u56e0\u5b50\u306e\u90e8\u5c4b \u30cb\u30b3\u30ea\n- \u6570\u72ec\u3092\u7d44\u5408\u305b\u6700\u9069\u3067\u89e3\u304f\n\n \u554f\u984c\u4f8b\n\n\u30cb\u30b3\u30ea\u69d8\u304b\u3089\u627f\u8afe\u9802\u304d\u3001\u4f8b\u984c\u3092\u304a\u501f\u308a\u3057\u307e\u3057\u305f\u3002\u5de6\u304c\u554f\u984c\u3067\u53f3\u304c\u56de\u7b54\u3067\u3059\u3002\n\u554f\u984c\u3067\u306f\u3001\u592a\u3044\u7dda\u3067\u56f2\u307e\u308c\u305f\u90e8\u5c4b\u306b\u5206\u304b\u308c\u3066\u304a\u308a\u3001\u5de6\u4e0a\u306b\u30d2\u30f3\u30c8\u306e\u6570\u5b57\u304c\u3042\u308a\u307e\u3059\u3002\n\u30d2\u30f3\u30c8\u306f\u3001\u305d\u306e\u90e8\u5c4b\u5185\u306e\u6570\u5b57\u306e\u304b\u3051\u7b97\u306b\u306a\u3063\u3066\u3044\u307e\u3059\u3002\n5\u00d75\u306e\u30b5\u30a4\u30ba\u306a\u3089\u3070\u3001\u4f7f\u3048\u308b\u6570\u5b57\u306f1\u304b\u30895\u3067\u3059\u3002\u6570\u72ec\u3068\u540c\u3058\u304f\u7e261\u884c\u3084\u6a2a1\u5217\u3067\u3001\u540c\u3058\u6570\u5b57\u306f\u4f7f\u3048\u307e\u305b\u3093\u3002\n\n \u5b9a\u5f0f\u5316\n\u7d44\u5408\u305b\u6700\u9069\u5316\u306e\u30e2\u30c7\u30eb\u3067\u5927\u4e8b\u306a\u306e\u306f\u3001\u306a\u308b\u3079\u304f1\u6b21\u5f0f\u3067\u8868\u3059\u3053\u3068\u3067\u3059\u3002\n\u5358\u7d14\u306b\u5909\u6570\u306e\u304b\u3051\u7b97\u3092\u30e2\u30c7\u30eb\u5316\u3059\u308b\u3068\u3001\u975e\u7dda\u5f62\u6700\u9069\u5316\u3068\u306a\u308a\u89e3\u304f\u306e\u304c\u56f0\u96e3\u306b\u306a\u308a\u307e\u3059\u3002\n\u4eca\u56de\u306f\u3001\u5bfe\u6570\u3092\u4f7f\u3063\u30661\u6b21\u5f0f\u306b\u3057\u307e\u3059\u3002\u3064\u307e\u308a\u3001\u4e0b\u8a18\u306e\u3088\u3046\u306b\u3068\u3089\u3048\u307e\u3059\u3002\n$2 \\times 3 = 6$  \u2192  $\\log(2) + \\log(3) = \\log(6)$\n\u3053\u306e\u3088\u3046\u306b\u3059\u308c\u3070\u30011\u6b21\u5f0f\u3067\u8868\u73fe\u3067\u304d\u307e\u3059\u3002\u305f\u3060\u3057\u3001\u3053\u306e\u307e\u307e\u3067\u3059\u3068\u7121\u7406\u6570\u3092\u4f7f\u3046\u306e\u3067\u8a08\u7b97\u8aa4\u5dee\u304c\u767a\u751f\u3057\u307e\u3059\u3002\u305d\u3053\u3067\u3001\u5236\u7d04\u5f0f\u3092\u7b49\u53f7\u3067\u306f\u306a\u304f\u3001\u5fae\u5c11\u306e\u7bc4\u56f2\u306b\u5165\u308b\u3088\u3046\u306b\u6307\u5b9a\u3057\u307e\u3059\u3002\n\u5b9a\u5f0f\u5316\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\n\n\n$\\mbox{variables}$\n$x_{ijk} \\in \\{0, 1\\} ~ \\forall i, j, k$\n\u30de\u30b9i,j\u304c\u6570\u5b57k+1\u304b (1)\n\n\n$y_{ij} \\in \\{1 \\cdots n\\} ~ \\forall i, j$\n\u30de\u30b9i,j\u306e\u6570\u5b57 (2)\n\n\n$\\mbox{subject to}$\n$\\sum_k{x_{ijk}} = 1 ~ \\forall i, j$\n\u6570\u5b57\u306f1\u3064 (3)\n\n\n\n$\\sum_k{x_{ikj}} = 1 ~ \\forall i, j$\n\u7e26\u306b\u540c\u3058\u6570\u5b57\u306f\u306a\u3044 (4)\n\n\n\n$\\sum_k{x_{kij}} = 1 ~ \\forall i, j$\n\u6a2a\u306b\u540c\u3058\u6570\u5b57\u306f\u306a\u3044 (5)\n\n\n\n$y_{ij}\u3092x_{ijk}\u3067\u8868\u3059$ (6)\n\n\n\n\u30de\u30b9\u306e\u7a4d\u304c\u30d2\u30f3\u30c8\u306b\u7b49\u3057\u3044 (7)\n\n\n\n Python\u3067\u89e3\u304f\npulp\u3068pandas\u3092\u4f7f\u3044\u307e\u3059\u3002\n\u554f\u984c\u306f\u3001\u6587\u5b57\u5217\u306b\u5165\u3063\u3066\u3044\u308b\u3068\u3057\u307e\u3059\u3002\n\npython\nch = \"\"\"\nABBCD\nAEEFD\nGGHFD\nIJHKK\nILHMM\n\"\"\".strip().split('\\n')\nrooms = [6, 15, 1, 12, 20, 8, 10, 6, 4, 4, 15, 1, 10]\n\n\n\u6e96\u5099\u3092\u3057\u307e\u3059\u3002\n\npython\nimport pandas as pd\nfrom collections import defaultdict\nfrom pulp import *\nfrom math import log\ndef addvar(lowBound=0, count=[0], *args, **kwargs):\n    count[0] += 1\n    return LpVariable('v%d'%count[0], lowBound=lowBound, *args, **kwargs)\nnn, nb = len(ch), len(rooms) # \u6570\u5b57\u306e\u500b\u6570\u3001\u90e8\u5c4b\u306e\u6570\nrn, rb = range(nn), range(nb)\nlognn = [log(k + 1) for k in rn] # 1..nn\u306elog\nlogrm = [log(h) for h in rooms] # \u30d2\u30f3\u30c8\u306elog\n\n\n\u5909\u6570\u306e\u8868\u3092\u4f5c\u3063\u3066\u898b\u3066\u307f\u307e\u3057\u3087\u3046\u3002\n\npython\na = pd.DataFrame([(i, j, [addvar(cat=LpBinary) for k in rn], addvar())\n                  for i in rn for j in rn],\n                 columns=['\u7e26', '\u6a2a', 'Vars', 'Var']) # (1), (2)\nprint(a[:3])\n\n\n\n\u7e26 $i$ \u6a2a $j$ \u306eVars\u306f [$x_{ijk} \\forall k$] \u306b\u3001Var\u306f $y_{ij}$ \u306b\u5bfe\u5fdc\u3057\u307e\u3059\u3002\n\n\n\n\n\n\u7e26\n\u6a2a\nVars\nVar\n\n\n\n\n0\n0\n0\n[v1, v2, v3, v4, v5]\nv6\n\n\n1\n0\n1\n[v7, v8, v9, v10, v11]\nv12\n\n\n2\n0\n2\n[v13, v14, v15, v16, v17]\nv18\n\n\n\n\u5b9a\u5f0f\u5316\u3057\u3066\u89e3\u304d\u307e\u3059\u3002\n\npython\nm = LpProblem() # \u6570\u7406\u30e2\u30c7\u30eb\ndic = defaultdict(list) # \u90e8\u5c4b\u3054\u3068\u306e\u5909\u6570(x)\u306e\u30ea\u30b9\u30c8\nfor _, r in a.iterrows():\n    m += lpSum(r.Vars) == 1 # (3)\n    m += lpDot(rn, r.Vars) + 1 == r.Var # (6)\n    dic[ch[r.\u7e26][r.\u6a2a]].append(r.Vars)\nfor i in rn:\n    for k in rn:\n        m += lpSum(v[k] for v in a.query('\u7e26==%d'%i).Vars) == 1 # (4)\n        m += lpSum(v[k] for v in a.query('\u6a2a==%d'%i).Vars) == 1 # (5)\nfor h in rb:\n    c = lpSum(lpDot(lognn, v) for v in dic[chr(h + 65)]) # \u6570\u5b57\u306e\u7a4d\u306elog\n    m += c >= logrm[h] - 0.001 # (7)\n    m += c <= logrm[h] + 0.001 # (7)\nm.solve() # \u6c42\u89e3\n\n\n\u7d50\u679c\u306e\u8868\u793a\u3092\u3057\u307e\u3059\u3002\n\npython\na['Val'] = a.Var.apply(value)\nprint(a.Val.reshape(5, -1))\n>>>\n[[ 2.  3.  5.  1.  4.]\n [ 3.  5.  4.  2.  1.]\n [ 5.  2.  1.  4.  3.]\n [ 1.  4.  2.  3.  5.]\n [ 4.  1.  3.  5.  2.]]\n\n\n\u4ee5\u4e0a\n# <i class='fa fa-question-circle' /> \u56e0\u5b50\u306e\u90e8\u5c4b\u3092\u89e3\u304f\n**\u56e0\u5b50\u306e\u90e8\u5c4b**\u3068\u306f\u3001\u6570\u72ec\u306b\u4f3c\u305f\u30d1\u30ba\u30eb\u3067\u3059\u3002\u3053\u306e\u30d1\u30ba\u30eb\u3082[\u7d44\u5408\u305b\u6700\u9069\u5316](http://qiita.com/Tsutomu-KKE@github/items/bfbf4c185ed7004b5721)\u3092\u4f7f\u3063\u3066\u89e3\u3051\u307e\u3059\u3002\n\u53c2\u8003\n- [\u56e0\u5b50\u306e\u90e8\u5c4b wikipedia](https://ja.wikipedia.org/wiki/%E5%9B%A0%E5%AD%90%E3%81%AE%E9%83%A8%E5%B1%8B)\n- [\u56e0\u5b50\u306e\u90e8\u5c4b \u30cb\u30b3\u30ea](http://www.nikoli.co.jp/ja/puzzles/inshi_no_heya/)\n- [\u6570\u72ec\u3092\u7d44\u5408\u305b\u6700\u9069\u3067\u89e3\u304f](http://qiita.com/Tsutomu-KKE@github/items/4f919f453aae95b3834b)\n\n# <i class='fa fa-question-circle' /> \u554f\u984c\u4f8b\n![image](https://qiita-image-store.s3.amazonaws.com/0/13955/4d7c337b-b419-93c9-145b-97cbf8384624.png)\n\n\u30cb\u30b3\u30ea\u69d8\u304b\u3089\u627f\u8afe\u9802\u304d\u3001\u4f8b\u984c\u3092\u304a\u501f\u308a\u3057\u307e\u3057\u305f\u3002\u5de6\u304c\u554f\u984c\u3067\u53f3\u304c\u56de\u7b54\u3067\u3059\u3002\n\u554f\u984c\u3067\u306f\u3001\u592a\u3044\u7dda\u3067\u56f2\u307e\u308c\u305f\u90e8\u5c4b\u306b\u5206\u304b\u308c\u3066\u304a\u308a\u3001\u5de6\u4e0a\u306b\u30d2\u30f3\u30c8\u306e\u6570\u5b57\u304c\u3042\u308a\u307e\u3059\u3002\n\u30d2\u30f3\u30c8\u306f\u3001\u305d\u306e\u90e8\u5c4b\u5185\u306e\u6570\u5b57\u306e\u304b\u3051\u7b97\u306b\u306a\u3063\u3066\u3044\u307e\u3059\u3002\n5\u00d75\u306e\u30b5\u30a4\u30ba\u306a\u3089\u3070\u3001\u4f7f\u3048\u308b\u6570\u5b57\u306f1\u304b\u30895\u3067\u3059\u3002\u6570\u72ec\u3068\u540c\u3058\u304f\u7e261\u884c\u3084\u6a2a1\u5217\u3067\u3001\u540c\u3058\u6570\u5b57\u306f\u4f7f\u3048\u307e\u305b\u3093\u3002\n\n# <i class='fa fa-question-circle' /> \u5b9a\u5f0f\u5316\n\u7d44\u5408\u305b\u6700\u9069\u5316\u306e\u30e2\u30c7\u30eb\u3067\u5927\u4e8b\u306a\u306e\u306f\u3001\u306a\u308b\u3079\u304f1\u6b21\u5f0f\u3067\u8868\u3059\u3053\u3068\u3067\u3059\u3002\n\u5358\u7d14\u306b\u5909\u6570\u306e\u304b\u3051\u7b97\u3092\u30e2\u30c7\u30eb\u5316\u3059\u308b\u3068\u3001\u975e\u7dda\u5f62\u6700\u9069\u5316\u3068\u306a\u308a\u89e3\u304f\u306e\u304c\u56f0\u96e3\u306b\u306a\u308a\u307e\u3059\u3002\n\u4eca\u56de\u306f\u3001\u5bfe\u6570\u3092\u4f7f\u3063\u30661\u6b21\u5f0f\u306b\u3057\u307e\u3059\u3002\u3064\u307e\u308a\u3001\u4e0b\u8a18\u306e\u3088\u3046\u306b\u3068\u3089\u3048\u307e\u3059\u3002\n\n$2 \\times 3 = 6$  \u2192  $\\log(2) + \\log(3) = \\log(6)$\n\n\u3053\u306e\u3088\u3046\u306b\u3059\u308c\u3070\u30011\u6b21\u5f0f\u3067\u8868\u73fe\u3067\u304d\u307e\u3059\u3002\u305f\u3060\u3057\u3001\u3053\u306e\u307e\u307e\u3067\u3059\u3068\u7121\u7406\u6570\u3092\u4f7f\u3046\u306e\u3067\u8a08\u7b97\u8aa4\u5dee\u304c\u767a\u751f\u3057\u307e\u3059\u3002\u305d\u3053\u3067\u3001\u5236\u7d04\u5f0f\u3092\u7b49\u53f7\u3067\u306f\u306a\u304f\u3001\u5fae\u5c11\u306e\u7bc4\u56f2\u306b\u5165\u308b\u3088\u3046\u306b\u6307\u5b9a\u3057\u307e\u3059\u3002\n\n\u5b9a\u5f0f\u5316\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\n\n<table>\n<tr><td rowspan=\"2\">$\\mbox{variables}$</td><td>$x_{ijk} \\in \\{0, 1\\} ~ \\forall i, j, k$</td><td>\u30de\u30b9i,j\u304c\u6570\u5b57k+1\u304b (1)</td></tr>\n<tr><td>$y_{ij} \\in \\{1 \\cdots n\\} ~ \\forall i, j$</td><td>\u30de\u30b9i,j\u306e\u6570\u5b57 (2)</td></tr>\n<tr><td>$\\mbox{subject to}$</td><td>$\\sum_k{x_{ijk}} = 1 ~ \\forall i, j$</td><td>\u6570\u5b57\u306f1\u3064 (3)</td></tr>\n<tr><td></td><td>$\\sum_k{x_{ikj}} = 1 ~ \\forall i, j$</td><td>\u7e26\u306b\u540c\u3058\u6570\u5b57\u306f\u306a\u3044 (4)</td></tr>\n<tr><td></td><td>$\\sum_k{x_{kij}} = 1 ~ \\forall i, j$</td><td>\u6a2a\u306b\u540c\u3058\u6570\u5b57\u306f\u306a\u3044 (5)</td></tr>\n<tr><td></td><td colspan=\"2\">$y_{ij}\u3092x_{ijk}\u3067\u8868\u3059$ (6)</td></tr>\n<tr><td></td><td colspan=\"2\">\u30de\u30b9\u306e\u7a4d\u304c\u30d2\u30f3\u30c8\u306b\u7b49\u3057\u3044 (7)</td></tr>\n</table>\n\n# <i class='fa fa-question-circle' /> Python\u3067\u89e3\u304f\n[pulp](http://qiita.com/Tsutomu-KKE@github/items/bfbf4c185ed7004b5721#%E3%82%BD%E3%83%95%E3%83%88%E3%81%AE%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB)\u3068pandas\u3092\u4f7f\u3044\u307e\u3059\u3002\n\n\u554f\u984c\u306f\u3001\u6587\u5b57\u5217\u306b\u5165\u3063\u3066\u3044\u308b\u3068\u3057\u307e\u3059\u3002\n\n```py3:python\nch = \"\"\"\nABBCD\nAEEFD\nGGHFD\nIJHKK\nILHMM\n\"\"\".strip().split('\\n')\nrooms = [6, 15, 1, 12, 20, 8, 10, 6, 4, 4, 15, 1, 10]\n```\n\n\u6e96\u5099\u3092\u3057\u307e\u3059\u3002\n\n```py3:python\nimport pandas as pd\nfrom collections import defaultdict\nfrom pulp import *\nfrom math import log\ndef addvar(lowBound=0, count=[0], *args, **kwargs):\n    count[0] += 1\n    return LpVariable('v%d'%count[0], lowBound=lowBound, *args, **kwargs)\nnn, nb = len(ch), len(rooms) # \u6570\u5b57\u306e\u500b\u6570\u3001\u90e8\u5c4b\u306e\u6570\nrn, rb = range(nn), range(nb)\nlognn = [log(k + 1) for k in rn] # 1..nn\u306elog\nlogrm = [log(h) for h in rooms] # \u30d2\u30f3\u30c8\u306elog\n```\n\n\u5909\u6570\u306e\u8868\u3092\u4f5c\u3063\u3066\u898b\u3066\u307f\u307e\u3057\u3087\u3046\u3002\n\n```py3:python\na = pd.DataFrame([(i, j, [addvar(cat=LpBinary) for k in rn], addvar())\n                  for i in rn for j in rn],\n                 columns=['\u7e26', '\u6a2a', 'Vars', 'Var']) # (1), (2)\nprint(a[:3])\n```\n\n- \u7e26 $i$ \u6a2a $j$ \u306eVars\u306f [$x_{ijk} \\forall k$] \u306b\u3001Var\u306f $y_{ij}$ \u306b\u5bfe\u5fdc\u3057\u307e\u3059\u3002\n\n<table>\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>\u7e26</th>\n      <th>\u6a2a</th>\n      <th>Vars</th>\n      <th>Var</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>0</td>\n      <td>0</td>\n      <td>[v1, v2, v3, v4, v5]</td>\n      <td>v6</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>0</td>\n      <td>1</td>\n      <td>[v7, v8, v9, v10, v11]</td>\n      <td>v12</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>0</td>\n      <td>2</td>\n      <td>[v13, v14, v15, v16, v17]</td>\n      <td>v18</td>\n    </tr>\n  </tbody>\n</table>\n\n\u5b9a\u5f0f\u5316\u3057\u3066\u89e3\u304d\u307e\u3059\u3002\n\n```py3:python\nm = LpProblem() # \u6570\u7406\u30e2\u30c7\u30eb\ndic = defaultdict(list) # \u90e8\u5c4b\u3054\u3068\u306e\u5909\u6570(x)\u306e\u30ea\u30b9\u30c8\nfor _, r in a.iterrows():\n    m += lpSum(r.Vars) == 1 # (3)\n    m += lpDot(rn, r.Vars) + 1 == r.Var # (6)\n    dic[ch[r.\u7e26][r.\u6a2a]].append(r.Vars)\nfor i in rn:\n    for k in rn:\n        m += lpSum(v[k] for v in a.query('\u7e26==%d'%i).Vars) == 1 # (4)\n        m += lpSum(v[k] for v in a.query('\u6a2a==%d'%i).Vars) == 1 # (5)\nfor h in rb:\n    c = lpSum(lpDot(lognn, v) for v in dic[chr(h + 65)]) # \u6570\u5b57\u306e\u7a4d\u306elog\n    m += c >= logrm[h] - 0.001 # (7)\n    m += c <= logrm[h] + 0.001 # (7)\nm.solve() # \u6c42\u89e3\n```\n\n\u7d50\u679c\u306e\u8868\u793a\u3092\u3057\u307e\u3059\u3002\n\n```py3:python\na['Val'] = a.Var.apply(value)\nprint(a.Val.reshape(5, -1))\n>>>\n[[ 2.  3.  5.  1.  4.]\n [ 3.  5.  4.  2.  1.]\n [ 5.  2.  1.  4.  3.]\n [ 1.  4.  2.  3.  5.]\n [ 4.  1.  3.  5.  2.]]\n```\n\n\u4ee5\u4e0a\n", "tags": ["\u7d44\u5408\u305b\u6700\u9069\u5316", "\u6700\u9069\u5316", "\u6570\u5b66", "Python", "\u30d1\u30ba\u30eb"]}