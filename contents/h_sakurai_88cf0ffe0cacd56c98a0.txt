{"context": "\n\n\u306f\u3058\u3081\u306b\n\u8a00\u8a9e\u3092\u4f5c\u308b\u5834\u5408\u306b\u306f BNF \u304c\u3042\u308a\u64cd\u4f5c\u7684\u610f\u5473\u3084\u578b\u4ed8\u3051\u898f\u5247\u3092\u5b9a\u7fa9\u3057\u3066\u3042\u308b\u3068\u8aac\u5f97\u529b\u304c\u5897\u3057\u307e\u3059\u3002\u30b7\u30fc\u30af\u30a8\u30f3\u30c8\u8a08\u7b97\u306e\u63a8\u8ad6\u898f\u5247\u306f\u9577\u65b9\u5f62\u306b\u53ce\u3081\u308b\u3053\u3068\u304c\u51fa\u6765\u308b\u306e\u3067\u3001\uff12\u6b21\u5143\u7684\u306b\u56f3\u3068\u3057\u3066\u66f8\u304f\u306b\u306f\u3068\u3066\u3082\u4fbf\u5229\u306a\u8a18\u8ff0\u65b9\u6cd5\u3067\u3059\u3002\u3057\u304b\u3057\u3001\u8aad\u307f\u66f8\u304d\u3059\u308b\u306b\u306f\u3001\u3088\u304f\u77e5\u3089\u308c\u3066\u3044\u308b\u51e6\u7406\u7cfb\u304c\u306a\u3044\u306e\u3067\u306a\u304b\u306a\u304b\u899a\u3048\u308b\u3053\u3068\u304c\u51fa\u6765\u306a\u3044\u4eba\u3082\u591a\u3044\u306e\u3067\u306f\u306a\u3044\u3067\u3057\u3087\u3046\u304b\uff1f\n\\begin{array}{lr}\n  \u8a55\u4fa1 &\n  \\bbox[3px,border:1px solid black]{\\;t \\longrightarrow t}\n  \\\\[-30px]\n  \\hspace{250px}\n  \\\\[-30px]\n\\end{array}\n\\\\\n\\begin{array}{cr}\n  \\dfrac{\n    t_1 \\longrightarrow t_1' }{\n    t_1\\;t_2 \\longrightarrow t_1'\\;t_2 }\n  & \\text{(E-App1)}\n  \\\\\n  \\dfrac{\n    t_2 \\longrightarrow t_2' }{\n    v_1\\;t_2 \\longrightarrow v_1'\\;t_2}\n  & \\text{(E-App2)}\n  \\\\\n  (\\lambda x.t_{12})\\;v_2 \\longrightarrow\n  [x \\rightarrow t_1]\\;t_{12}\n  & \\text{(E-AppAbs)}\n\\end{array}\n\n\u305d\u3053\u3067\u3001\u3053\u3053\u3067\u306f\u3001Prolog \u3092\u7528\u3044\u3066\u30b7\u30fc\u30af\u30a8\u30f3\u30c8\u8a08\u7b97\u306b\u4f3c\u305b\u305f\u8a18\u8ff0\u3092\u3059\u308b\u624b\u6cd5\u3092\u63d0\u6848\u3057\u307e\u3059\u3002\u8ad6\u7406\u578b\u8a00\u8a9e\u306e\u51e6\u7406\u7cfb\u3067\u3088\u304f\u77e5\u3089\u308c\u3066\u3044\u308b\u8a00\u8a9e\u3068\u3044\u3048\u3070 Prolog \u3067\u3059\u3002\u6b8b\u5ff5\u306a\u304c\u3089Prolog\u306f\u66f8\u304f\u9806\u756a\u304c\u7570\u306a\u308b\u305f\u3081\u30b7\u30fc\u30af\u30a8\u30f3\u30c8\u8a08\u7b97\u3067\u306f\u3042\u308a\u307e\u305b\u3093\u304c\u5de5\u592b\u3092\u3059\u308b\u3053\u3068\u3067\u4f3c\u305b\u308b\u3053\u3068\u304c\u53ef\u80fd\u3067\u3059\u3002\n\u307e\u305a\u8efd\u304fProlog\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3084Helloworld\u3068\u30d5\u30a3\u30dc\u30ca\u30c3\u30c1\u306e\u8a08\u7b97\u3092\u7d39\u4ecb\u3057\u307e\u3059\u3002\u6b21\u306b\u3001\u95a2\u6570\u578b\u8a00\u8a9e\u3067\u6271\u3046\u3088\u3046\u306a\u69cb\u6587\u6728\u3092\u8a55\u4fa1\u3059\u308b\u5927\u30b9\u30c6\u30c3\u30d7\u8a55\u4fa1\u5668\u3092\u4f5c\u6210\u3057\u3001\u30b7\u30fc\u30af\u30a8\u30f3\u30c8\u8a08\u7b97\u306b\u4f3c\u305f\u8868\u8a18\u306b\u66f8\u304d\u63db\u3048\u307e\u3059\u3002\u307e\u305f\u3001if\u3092\u4f7f\u3063\u305f\u65b9\u6cd5\u3092\u7d39\u4ecb\u3057\u3001\u5c0f\u30b9\u30c6\u30c3\u30d7\u8a55\u4fa1\u5668\u3068\u8a55\u4fa1\u6587\u8108\u3092\u7d39\u4ecb\u3057\u307e\u3059\u3002\u305d\u306e\u5f8c\u3001\u5358\u76f8\u578b\u63a8\u8ad6\u3001\u591a\u76f8\u578b\u63a8\u8ad6\u7b49\u3092\u7d39\u4ecb\u3057\u307e\u3059\u3002\u6700\u5f8c\u306b\u3001\u90e8\u5206\u578b\u4ed8\u3051\u306b\u304a\u3051\u308bProlog\u306e\u9650\u754c\u3068\u30a2\u30eb\u30b4\u30ea\u30ba\u30df\u30c3\u30af\u306a\u90e8\u5206\u578b\u4ed8\u3051\u306b\u3088\u308b\u89e3\u6c7a\u65b9\u6cd5\u3092\u8ff0\u3079\u307e\u3059\u3002\n\u3053\u308c\u3089\u306e\u7d39\u4ecb\u3057\u305f\u624b\u6cd5\u3067Prolog\u3092\u4f7f\u3063\u3066\u69d8\u3005\u306a\u8a00\u8a9e\u306e\u51e6\u7406\u7cfb\u3092\u4f5c\u308c\u3070\u3001\u5f62\u5f0f\u7684\u306a\u8a00\u8a9e\u3092\u8aad\u307f\u66f8\u304d\u3059\u308b\u7d20\u990a\u304c\u8eab\u306b\u3064\u304f\u3053\u3068\u3067\u3057\u3087\u3046\u3002\n\n\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\nProlog\u306e\u51e6\u7406\u7cfb\u306f\u69d8\u3005\u3042\u308a\u307e\u3059\u304c\u3001SWI-Prolog\u306fUTF-8\u3082\u4f7f\u3048\u308b\u306e\u3067\u304a\u3059\u3059\u3081\u3067\u3059\u3002\nbrew install swi-prolog\napt-get install swi-prolog\n\nWindows\u7248\u306eSWI-Prolog\u3082\u5b58\u5728\u307e\u3059\u304c\u3001BOM\u306e\u8ffd\u52a0\u304c\u5fc5\u8981\u3068\u306a\u308b\u305f\u3081VM\u4e0a\u3067\u7528\u3044\u308b\u3053\u3068\u3092\u304a\u3059\u3059\u3081\u3057\u307e\u3059\u3002\n\nHello World\n\nhello.pl\n:- write('hello world'),nl.\n:- halt.\n\n\nProlog\u3067\u306f\u8ff0\u8a9e\u3092,\u3067\u533a\u5207\u3063\u3066\u8907\u6570\u8a18\u8ff0\u3059\u308b\u3053\u3068\u306b\u3088\u308a\u30d7\u30ed\u30b0\u30e9\u30e0\u3092\u8a18\u8ff0\u3057\u307e\u3059\u3002\n:-\u304b\u3089.\u307e\u3067\u3092\u3059\u3050\u306b\u5b9f\u884c\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002write\u306f\u6a19\u6e96\u51fa\u529b\u306b\u51fa\u529b\u3059\u308b\u8ff0\u8a9e\u3067\u3001nl\u306f\u6539\u884c\u3092\u51fa\u529b\u3059\u308b\u8ff0\u8a9e\u3067\u3059\u3002halt\u306f\u30d7\u30ed\u30b0\u30e9\u30e0\u3092\u7d42\u4e86\u3059\u308b\u8ff0\u8a9e\u3067\u3059\u3002\n\u62e1\u5f35\u5b50\u306fPerl\u3068\u304b\u3076\u308a\u307e\u3059\u304cpl\u3092\u4f7f\u3044\u307e\u3059\u3002\n$ swipl hello.pl\nhello world\n\n\u5b9f\u884c\u3059\u308b\u306b\u306f\u3001swipl hello.pl \u3068\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3057\u307e\u3059\u3002\n\u30d7\u30ed\u30b0\u30e9\u30e0\u306b\u30d0\u30b0\u304c\u3042\u3063\u305f\u5834\u5408\u306a\u3069\u3067repl\u304c\u8868\u793a\u3055\u308c\u308b\u3053\u3068\u304c\u3042\u308a\u307e\u3059\u3002\n\u305d\u3046\u3044\u3063\u305f\u5834\u5408\u3082\u3001\u3042\u308f\u3066\u305a\u3001?- halt.\u3068\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n\u8db3\u3057\u7b97\u3092\u3059\u308b\u8ff0\u8a9e\nProlog\u306b\u306f\u95a2\u6570\u304c\u306a\u3044\u306e\u3067\u3059\u304c\u3001\u4ee3\u308f\u308a\u306b\u8ff0\u8a9e\u3092\u4f7f\u3044\u307e\u3059\u3002\n\u8ff0\u8a9e\u3067\u5024\u3092\u8fd4\u3059\u306b\u306f\u5909\u6570\u306b\u5024\u3092\u675f\u7e1b\u3059\u308b\u3053\u3068\u3067\u8fd4\u5374\u3057\u307e\u3059\u3002\n\u8db3\u3057\u7b97\u3092\u3059\u308b\u8ff0\u8a9e\u3092\u5b9a\u7fa9\u3057\u3066\u4f7f\u3046\u306b\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u3057\u307e\u3059\u3002\n\nadd.pl\nadd(X,Y,R) :- R is X + Y.\n:- add(1,2,R),writeln(R),halt.\n\n\nC\u8a00\u8a9e\u306evoid\u306a\u95a2\u6570\u3067\u30dd\u30a4\u30f3\u30bf\u3092\u7528\u3044\u3066\u5024\u3092\u8fd4\u3059\u30a4\u30e1\u30fc\u30b8\u306b\u4f3c\u3066\u3044\u307e\u3059\u3002\n\n\u30d5\u30a3\u30dc\u30ca\u30c3\u30c1\n\nfib.pl\nfib(0,0).\nfib(1,1).\nfib(X,R):-\n  X1 is X-1, X2 is X-2,\n  fib(X1, R1), fib(X2, R2), R is R1 + R2.\n\n:- fib(10,R), writeln(R),halt.\n\n\n\u6b8b\u5ff5\u306a\u304c\u3089\u3001\u95a2\u6570\u3092\u30cd\u30b9\u30c8\u3057\u3066\u8a18\u8ff0\u3067\u304d\u306a\u3044\u306e\u3067\u30d5\u30a3\u30dc\u30ca\u30c3\u30c1\u306e\u3088\u3046\u306a\u8a08\u7b97\u306f\u8a18\u8ff0\u91cf\u304c\u5897\u3048\u307e\u3059\u3002\n\u3053\u308c\u3092\u307f\u3066\u30c0\u30e1\u3060\u306a\u3068\u601d\u3063\u3066Prolog\u3092\u3084\u3081\u308b\u4eba\u306f\u591a\u3044\u3067\u3057\u3087\u3046\u3002\n\nProlog\u3067\u66f8\u304f\u5927\u30b9\u30c6\u30c3\u30d7\u8a55\u4fa1\u5668\n\u3053\u3053\u304b\u3089\u304c\u3001Prolog\u306e\u672c\u9818\u767a\u63ee\u3067\u3059\u3002\n\u30e9\u30e0\u30c0\u8a08\u7b97\u306fProlog\u3067\u306f\u308f\u305a\u304b\u6570\u884c\u3067\u8a18\u8ff0\u53ef\u80fd\u3067\u3059\u3002\nHOAS\u7684\u306b\u66f8\u304f\u3068\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u304b\u3051\u307e\u3059\u3002\n\nlambda.pl\n:-op(1000,yfx,$).\neval(I,I) :- integer(I).\neval(E1+E2,R) :- eval(E1,R1),eval(E2,R2), R is R1 + R2.\neval(X->E,X->E).\neval(E1$E2,R) :- eval(E1,X->E),eval(E2,Y),copy_term(X->E,Y->E3),eval(E3,R).\n\n:- eval((Y->X->X+Y)$(1+1)$(3),R),writeln(R).\n:- eval((F->X->Y->(F$X)+(F$Y))$(Z->Z+1)$3$4,R),writeln(R).\n:- halt.\n\n\nHOAS\u7684\u3068\u3044\u3046\u306e\u306f\u3001\u5909\u6570\u540d\u306bProlog\u306e\u5909\u6570\u3092\u76f4\u63a5\u7528\u3044\u3066\u3044\u308b\u304b\u3089\u3067\u3059\u3002\n\u3053\u306e\u65b9\u6cd5\u3067\u306f\u3001(X->X)$(X->X)\u3068\u3044\u3063\u305f\u5f0f\u3092\u66f8\u3044\u305f\u5834\u5408\u306b\u30e9\u30e0\u30c0\u62bd\u8c61\u306e\u5909\u6570\u304c\u5171\u6709\u3055\u308c\u3066\u3057\u307e\u3046\u554f\u984c\u304c\u3042\u308b\u306e\u3067\u6ce8\u610f\u304c\u5fc5\u8981\u3067\u3059\u3002\n\u7f6e\u63db\u64cd\u4f5c\u3092\u3088\u308a\u8a73\u7d30\u306b\u884c\u3046\u306b\u306f\u4f8b\u3048\u3070\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u8a18\u8ff0\u3057\u307e\u3059\u3002\n\nlambda.pl\n:-op(1000,yfx,$).\neval(I,I) :- integer(I).\neval(E1+E2,R) :- eval(E1,R1), eval(E2,R2), R is R1 + R2.\neval(X->E,X->E).\neval(E1$E2,R) :- eval(E1,X->E),eval(E2,E2_),subst(X,Y,E,E3),eval(E3,R).\n\nsubst(X,X,E,E).\nsubst(X,Y,I,I) :- integer(I).\nsubst(X,Y,E1+E2, E1_+E2_) :- \n  subst(X,Y,E1,E1_),subst(X,Y,E2,E2_).\nsubst(X,Y,X->E1,X->E1).\nsubst(X,Y,Y->E1,Y_->E2):- term_to_atom(_,Y_),subst(Y,Y_,E1,E1_),subst(X,Y,E1_,E2).\nsubst(X,Y,X1->E1,X2->E1_) :- subst(X,Y,E1,E1_).\n:- eval((y->x->x+Yx$(1+1)$(3),R),writeln(R).\n:- eval((f->x->y->(f$x)+(f$y))$(z->z+1)$3$4,R),writeln(R).\n:- halt.\n\n\n\u672c\u8cea\u7684\u306a\u7b87\u6240\u306e\u307f\u3092\u7aef\u7684\u306b\u8868\u3059\u3053\u3068\u3082\u53ef\u80fd\u3067\u3059\u3057\u3001\u3088\u308a\u8a73\u7d30\u306b\u8a18\u8ff0\u3059\u308b\u3053\u3068\u3082Prolog\u3092\u7528\u3044\u3066\u53ef\u80fd\u306a\u306e\u3067\u3059\u3002\n\n\u30b7\u30fc\u30af\u30a8\u30f3\u30c8\u8a08\u7b97\u306b\u4f3c\u305b\u305f\u5927\u30b9\u30c6\u30c3\u30d7\u8a55\u4fa1\u5668\n\u30e9\u30e0\u30c0\u8a08\u7b97\u3092\u30b7\u30fc\u30af\u30a8\u30f3\u30c8\u8a08\u7b97\u306e\u56f3\u3067\u8868\u3059\u3068\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u8868\u3059\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\u69cb\u6587\n\\begin{array}{llr}\ne ::= & & \u9805: \\\\\n      & i & \u6574\u6570\\\\\n      & e + e & \u52a0\u7b97 \\\\\n      & e \\;\\text{->}\\; e & \u30e9\u30e0\u30c0\u62bd\u8c61 \\\\\n      & e \\;$\\; e & \u95a2\u6570\u9069\u7528 \\\\\n\\end{array}\n\n\u8a55\u4fa1\u898f\u5247\n\\begin{array}{cr}\ni \\Downarrow i & \\text{(E-Int)}\\\\\n\\dfrac{e_1 \\Downarrow i_1 \\quad e_1 \\Downarrow i_2 \\quad i\\;is\\;i_1+i_2 }\n{ e_1+e_2 \\Downarrow i } & \\text{(E-Add)} \\\\\ne_1\\;\\text{->}\\;e_2 \\Downarrow e_1\\;\\text{->}\\;e_2 & \\text{(E-Abs)} \\\\\n\\dfrac{e_1 \\Downarrow x\\;\\text{->}\\;e\\quad e_1 \\Downarrow v_2\\quad [x\\;\\text{->}\\;e_1]e \\Downarrow v}\n{e_1\\;$\\;e_2 \\Downarrow v} & \\text{(E-App)} \\\\\n\\end{array}\n\n\u3053\u306e\u8a18\u8ff0\u306bProlog\u306e\u30d7\u30ed\u30b0\u30e9\u30e0\u3092\u4f3c\u305b\u3066\u307f\u307e\u3057\u3087\u3046\u3002\n\u8ff0\u8a9eterm_expansion/2\u306f\u8aad\u307f\u8fbc\u307f\u6642\u306b\u8ff0\u8a9e\u5b9a\u7fa9\u3092\u66f8\u304d\u63db\u3048\u53ef\u80fd\u306a\u8ff0\u8a9e\u3067\u3059\u3002\nterm_expansion(A--B,B:-A).\u3068\u66f8\u304f\u3068\u8aad\u307f\u8fbc\u307f\u6642\u306b\u524d\u5f8c\u306e\u9806\u756a\u3092\u53cd\u8ee2\u3067\u304d\u308b\u306e\u3067\u3001\u8ad6\u6587\u306b\u3088\u304f\u7528\u3044\u3089\u308c\u308b\u30b7\u30fc\u30b1\u30f3\u30c8\u8a08\u7b97\u306e\u63a8\u8ad6\u898f\u5247\u306b\u4f3c\u305b\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\nsequent.pl\n:-op(1200,xfx,--).\n:-op(801,xfx,\u21d3).\n:-op(799,xfy,->).\n:-op(500,yfx,$).\nterm_expansion(A--B,B:-A).\n\ninteger(I)\n--                              % (E-Int)\nI \u21d3 I.\n\nE1 \u21d3 R1, E2 \u21d3 R2, R is R1 + R2\n--                %-------------- (E-Add)\nE1+E2 \u21d3 R.\n\n!\n-- %----------------------------- (E-Abs)\nX->E \u21d3 X->E.\n\nE1 \u21d3 X->E, E2 \u21d3 Y,\ncopy_term(X->E,Y->E3), E3 \u21d3 R\n--%------------------------------ (E-App)\nE1 $ E2 \u21d3 R.\n\n:- (Y->X->X+Y)$(1+1)$(3) \u21d3 R,writeln(R).\n:- (F->X->Y->(F$X)+(F$Y))$(Z->Z+1)$3$4 \u21d3 R,writeln(R).\n:- halt.\n\n\nProlog\u306e%\u306f\u4e00\u884c\u30b3\u30e1\u30f3\u30c8\u306a\u306e\u3067\u3001%----- (E-App)\u306e\u3088\u3046\u306b\u7dda\u3092\u597d\u304d\u306a\u9577\u3055\u306b\u3067\u304d\u307e\u3059\u3002\n\u65e5\u672c\u8a9e\u3068\u82f1\u8a9e\u306f\u8a9e\u9806\u304c\u9055\u3046\u306e\u3067\u82f1\u8a9e\u306e\u7fd2\u5f97\u304c\u96e3\u3057\u3044\u3088\u3046\u306b\u3001\u540c\u3058\u30d7\u30ed\u30b0\u30e9\u30e0\u3067\u3082\u524d\u5f8c\u304c\u5909\u308f\u308b\u3060\u3051\u3067\u5370\u8c61\u304c\u304c\u3089\u308a\u3068\u5909\u308f\u308a\u307e\u3059\u3002\u30ab\u30f3\u30de\u533a\u5207\u308a\u306fProlog\u306e\u6587\u6cd5\u4e0a\u3069\u3046\u3057\u3088\u3046\u3082\u3042\u308a\u307e\u305b\u3093\u304c\u3001\u8a9e\u9806\u3092\u5408\u308f\u305b\u308b\u3053\u3068\u3067\u63a8\u8ad6\u898f\u5247\u306b\u3088\u308a\u89aa\u3057\u307f\u3092\u6301\u3064\u3053\u3068\u304c\u3067\u304d\u308b\u3067\u3057\u3087\u3046\u3002\n\nif\u3092\u7528\u3044\u305f\u8a18\u8ff0\nScala\u306e\u57fa\u790e\u3068\u306a\u308bDOT\u306e\u8ad6\u6587\u306a\u3069\u3067\u7528\u3044\u3089\u308c\u3066\u3044\u308b\u3088\u3046\u306a\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u8a18\u8ff0\u3059\u308b\u624b\u6cd5\u3082\u3042\u308a\u307e\u3059\u3002\n\\begin{array}{rcl}\ni & \\Downarrow& i\\\\\ne_1 + e_2 & \\Downarrow & r \\quad if\\;e_1 \\Downarrow r_1,e_2 \\Downarrow r_2, r\\;is\\;r_1 + r_2 \\\\\nx \\rightarrow e & \\Downarrow & x \\rightarrow e\\\\\ne_1\\;e_2 & \\Downarrow & r \\quad  if\\;e_1 \\Downarrow x \\rightarrow e,e_2 \\Downarrow y, [x := y]e \\Downarrow r\\\\\n\\end{array}\n\n\u3053\u306e\u3088\u3046\u306a\u8a18\u8ff0\u306f\u3001if\u3092Prolog\u306e:-\u3068\u8aad\u307f\u66ff\u3048\u307e\u3057\u3087\u3046\u3002\n\nlambda_if.pl\n:-op(1200,xfx,if).\n:-op(801,xfx,\u21d3).\n:-op(799,xfy,->).\n:-op(500,yfx,$).\nterm_expansion(A if B, A :- B).\n\n    I \u21d3 I     if integer(I).\nE1+E2 \u21d3 R     if E1 \u21d3 R1, E2 \u21d3 R2, R is R1 + R2.\n X->E \u21d3 X->E.\nE1$E2 \u21d3 R     if E1 \u21d3 (X->E), E2 \u21d3 Y, copy_term((X->E),(Y->E3)), E3 \u21d3  R.\n\n:- (Y->X->X+Y)$(1+1)$(3) \u21d3 R, writeln(R).\n:- (F->X->Y->(F$X)+(F$Y))$(Z->Z+1)$3$4 \u21d3 R, writeln(R).\n:- halt.\n\n\n\n\u5c0f\u30b9\u30c6\u30c3\u30d7\u8a55\u4fa1\u5668\ni \\longrightarrow i\\;\\text{(E-Int)}\\\\\n\n\\dfrac{t_1 \\longrightarrow t_1'}\n{t_1 + t_2 \\longrightarrow t_1' + t_2}\\text{(E-Add1)} \\;\n\\dfrac{t_2 \\longrightarrow t_2'}\n{v_1 + t_2 \\longrightarrow v_1 + t_2'}\\text{(E-Add2)} \\;\n\\dfrac{v_3\\;is\\; v_1 + v_2}\n{v_1 + v_2 \\longrightarrow v_3} \\text{(E-Add3)} \\\\\n\n\\dfrac{t_1 \\longrightarrow t_1'}\n{t_1 - t_2 \\longrightarrow t_1' - t_2} \\text{(E-Sub1)} \\;\n\\dfrac{t_2 \\longrightarrow t_2'}\n{v_1 - t_2 \\longrightarrow v_1 - t_2'} \\text{(E-Sub2)} \\;\n\\dfrac{v_3\\;is\\; v_1 - v_2}\n{v_1 - v_2 \\longrightarrow v_3}\\text{(E-Sub3)} \\\\\n\n\\dfrac{t_1 \\longrightarrow t_1'}\n{t_1 * t_2 \\longrightarrow t_1' * t_2} \\text{(E-Mul1)} \\;\n\\dfrac{t_2 \\longrightarrow t_2'}\n{v_1 * t_2 \\longrightarrow v_1 * t_2'} \\text{(E-Mul2)} \\;\n\\dfrac{v_3\\;is\\; v_1 * v_2}\n{v_1 * v_2 \\longrightarrow v_3} \\text{(E-Mul3)} \\\\\n\n\\dfrac{t_1 \\longrightarrow t_1'}\n{t_1 / t_2 \\longrightarrow t_1' / t_2} \\text{(E-Div1)} \\;\n\\dfrac{t_2 \\longrightarrow t_2'}\n{v_1 / t_2 \\longrightarrow v_1 / t_2'} \\text{(E-Div2)} \\;\n\\dfrac{v_3\\;is\\; v_1 / v_2}\n{v_1 / v_2 \\longrightarrow v_3} \\text{(E-Div3)} \\\\\n\n\nlambda_smallstep.pl\n:- op(920, xfx, [ --->,-->> ]).\n:- op(1200, xfx, [ -- ]).\nterm_expansion(A -- B, B :- A).\n\n\\+integer(A), A ---> A_\n--%------------------------------------ (E-Add1)\nA + B ---> A_ + B.\n\ninteger(V), \\+integer(B), B ---> B_\n--%------------------------------------ (E-Add2)\nV + B ---> V + B_.\n\ninteger(V1), integer(V2), V is V1 + V2\n--%------------------------------------ (E-Add3)\nV1 + V2 ---> V.\n\n\\+integer(A), A ---> A_\n--%------------------------------------ (E-Sub1)\nA - B ---> A_ - B.\n\ninteger(V), \\+integer(B), B ---> B_\n--%------------------------------------ (E-Sub2)\nV - B ---> V - B_.\n\ninteger(V1), integer(V2), V is V1 - V2\n--%------------------------------------ (E-Sub3)\nV1 - V2 ---> V.\n\n\\+integer(A), A ---> A_\n--%------------------------------------ (E-Mul1)\nA * B ---> A_ * B.\n\ninteger(V), \\+integer(B), B ---> B_\n--%------------------------------------ (E-Mul2)\nV * B ---> V * B_.\n\ninteger(V1), integer(V2), V is V1 * V2\n--%------------------------------------ (E-Mul3)\nV1 * V2 ---> V.\n\n\\+integer(A), A ---> A_\n--%------------------------------------ (E-Div1)\nA / B ---> A_ / B.\n\ninteger(V), \\+integer(B), B ---> B_\n--%------------------------------------ (E-Div2)\nV / B ---> V / B_.\n\ninteger(V1), integer(V2), V is V1 div V2\n--%------------------------------------ (E-Div3)\nV1 / V2 ---> V.\n\nA ---> A :- integer(A).               % (E-Int)\n\nA -->> A_ :- \\+v(A), A ---> B, !, B -->> A_.\nA -->> A.\n\n:- 10 ---> R, writeln(R).\n:- 10 + 20 ---> R1, writeln(R1).\n:- 10 - 20 ---> R2, writeln(R2).\n:- 10 * 20 ---> R3, writeln(R3).\n:- 1*2+3/4 -->> R4, writeln(R4).\n:- halt.\n\n\n\u5c0f\u30b9\u30c6\u30c3\u30d7\u8a55\u4fa1\u5668\u306f\u3001\uff11\u5ea6\u306b\uff11\u3064\u306e\u5909\u63db\u306e\u307f\u3092\u884c\u3044\u307e\u3059\u3002\u5927\u30b9\u30c6\u30c3\u30d7\u8a55\u4fa1\u5668\u3067\u306f\u9014\u4e2d\u7d4c\u904e\u3092\u898b\u308b\u3053\u3068\u304c\u51fa\u6765\u307e\u305b\u3093\u304c\u3001\u5c11\u30b9\u30c6\u30c3\u30d7\u8a55\u4fa1\u5668\u306f\u9014\u4e2d\u306e\u72b6\u614b\u3092\u898b\u308b\u3053\u3068\u304c\u3067\u304d\u308b\u7279\u5fb4\u304c\u3042\u308a\u307e\u3059\u3002\n\n\u8a55\u4fa1\u6587\u8108\n\u30b7\u30fc\u30af\u30a8\u30f3\u30c8\u8a08\u7b97\u306f\u304b\u306a\u308a\u5727\u7e2e\u3057\u3066\u8a18\u8ff0\u3067\u304d\u308b\u306e\u3067\u3059\u304c\u3001\u540c\u3058\u3088\u3046\u306a\u5909\u63db\u898f\u5247\u306f\u52a9\u9577\u3067\u3059\u3002\u8a55\u4fa1\u6587\u8108\u3092\u7528\u3044\u308b\u3068\u3001\u3088\u308a\u63a8\u8ad6\u898f\u5247\u3092\u77ed\u304f\u8a18\u8ff0\u3067\u304d\u307e\u3059\u3002\n\\begin{array}{l}\n\u69cb\u6587\\\\\nt ::= i \\;|\\; t + t \\;|\\; t - t \\;|\\; t * t \\;|\\; t / t \\\\\nv ::= i \\\\\n\u8a55\u4fa1\u6587\u8108\\\\\ne ::= e + t\\;|\\;v + e \\;|\\; e - t \\;|\\; v - e \\;|\\; e * t \\;|\\; v * e \\;|\\; e / t \\;|\\; v / e \\;|\\; []\\\\\n\u8a55\u4fa1\u898f\u5247\\\\\n\\end{array}\\\\\n\\dfrac{v_3\\;is\\; v_1 + v_2}\n{v_1 + v_2 \\longrightarrow v_3} \\text{(E-Add3)} \\;\n\n\\dfrac{v_3\\;is\\; v_1 - v_2}\n{v_1 - v_2 \\longrightarrow v_3}\\text{(E-Sub3)} \\\\\n\n\\dfrac{v_3\\;is\\; v_1 * v_2}\n{v_1 * v_2 \\longrightarrow v_3} \\text{(E-Mul3)} \\;\n\n\\dfrac{v_3\\;is\\; v_1 / v_2}\n{v_1 / v_2 \\longrightarrow v_3} \\text{(E-Div3)} \\\\\n\ni \\longrightarrow i\\;\\text{(E-Int)}\\;\n\n\\dfrac{t_2 \\longrightarrow t_2'}\n{[t_2]e_1 \\longrightarrow [t_2']e_1} \\text{(E-EvalContext)} \\\\\n\n\u307e\u305f\u306f\n\\begin{array}{l}\n\u69cb\u6587\\\\\nt ::= i \\;|\\; t + t \\;|\\; t - t \\;|\\; t * t \\;|\\; t / t \\\\\nv ::= i \\\\\n\n\u8a55\u4fa1\u898f\u5247\\\\\nv_1 + v_2 \\longrightarrow v_3 \\;if\\; v_3\\;is\\; v_1 + v_2\\\\\nv_1 - v_2 \\longrightarrow v_3 \\;if\\; v_3\\;is\\; v_1 - v_2\\\\\nv_1 * v_2 \\longrightarrow v_3 \\;if\\; v_3\\;is\\; v_1 * v_2\\\\\nv_1 / v_2 \\longrightarrow v_3 \\;if\\; v_3\\;is\\; v_1 / v_2\\\\\ni \\longrightarrow i \\\\\n[t_2]e_1 \\longrightarrow [t_2']e_1 \\;if\\; t_2 \\longrightarrow t_2'\\\\\n\\quad where\\;e ::= e + t\\;|\\;v + e \\;|\\; e - t \\;|\\; v - e \\;|\\; e * t \\;|\\; v * e \\;|\\; e / t \\;|\\; v / e \\;|\\; []\\\\\n\n\\end{array}\\\\\n\n\u8a55\u4fa1\u6587\u8108\u306f[]\u3092hole(\u7a74)\u3068\u547c\u3073\u3001\u6b21\u306b\u8a55\u4fa1\u3059\u3079\u304d\u7b87\u6240\u3092\u7a74\u3068\u3057\u3066\u8868\u3057\u307e\u3059\u3002\nt=e[t']\u3068\u8868\u3059\u3053\u3068\u304c\u51fa\u6765\u3066\u3001\u8a55\u4fa1\u6587\u8108e\u306e\u7a74\u306b\u9805t'\u3092\u57cb\u3081\u308b\u3068\u9805t\u306b\u306a\u308a\u307e\u3059\u3002\n\u9805\u304b\u3089\u8a55\u4fa1\u6587\u8108\u3092\u63a2\u3059\u8ff0\u8a9ee/4\u306f\u3001\u9805\u3001\u8a55\u4fa1\u6587\u8108\u3001\u7a74\u306b\u30de\u30c3\u30c1\u3057\u305f\u9805\u3001\u7a74\u3092\u8868\u3059\u5909\u6570\u306e\uff14\u3064\u306e\u5909\u6570\u3092\u53d7\u3051\u53d6\u308a\u3001\u8a55\u4fa1\u6587\u8108\u306b\u7a74\u3092\u57cb\u3081\u305f\u9805\u3092\u53d6\u5f97\u3059\u308b\u306b\u306f\u3001\u7a74\u3068\u306a\u308b\u5909\u6570\u3068\u9805\u3092\u5358\u4e00\u5316\u3059\u308b\u3053\u3068\u3067\u884c\u3044\u307e\u3059\u3002\n\u8a55\u4fa1\u6587\u8108\u3092\u4f7f\u3063\u305f\u5909\u63db\u898f\u5247\u306fProlog\u3067\u66f8\u304f\u3068\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\n\nlambda_evaluation_context.pl\n:- op(920, xfx, [ ---> , -->> ]).\n:- op(1200, xfx, [ -- ]).\nterm_expansion(A -- B, B :- A).\n\nv(A) :- integer(A).\ne(S+T, E+T, P, H) :- \\+v(S), e(S,E,P,H).\ne(V+T, V+E, P, H) :- v(V), \\+v(T), e(T,E,P,H).\ne(S-T, E-T, P, H) :- \\+v(S), e(S,E,P,H).\ne(V-T, V-E, P, H) :- v(V), \\+v(T), e(T,E,P,H).\ne(S*T, E*T, P, H) :- \\+v(S), e(S,E,P,H).\ne(V*T, V*E, P, H) :- v(V), \\+v(T), e(T,E,P,H).\ne(S/T, E/T, P, H) :- \\+v(S), e(S,E,P,H).\ne(V/T, V/E, P, H) :- v(V), \\+v(T), e(T,E,P,H).\ne(T, H, T, H).\n\ne(T1, T1_, T2, T2_), T1\\=T2, T2 ---> T2_\n--%------------------------------------ (E-EvalContext)\nT1 ---> T1_.\n\ninteger(V1), integer(V2), V is V1 + V2\n--%------------------------------------ (E-Plus3)\nV1 + V2 ---> V.\n\ninteger(V1), integer(V2), V is V1 - V2\n--%------------------------------------ (E-Minus3)\nV1 - V2 ---> V.\n\ninteger(V1), integer(V2), V is V1 * V2\n--%------------------------------------ (E-Times3)\nV1 * V2 ---> V.\n\ninteger(V1), integer(V2), V is V1 div V2\n--%------------------------------------ (E-Div3)\nV1 / V2 ---> V.\n\nA ---> A :- integer(A).               % (E-Int)\n\nA -->> A_ :- \\+v(A), A ---> B, !, B -->> A_.\nA -->> A.\n\n:- 10 ---> R, writeln(R).\n:- 10 + 20 ---> R1, writeln(R1).\n:- 10 - 20 ---> R2, writeln(R2).\n:- 10 * 20 ---> R3, writeln(R3).\n:- 1*2+3/4 -->> R4, writeln(R4).\n:- halt.\n\n\nProlog\u3067\u3082\u8a55\u4fa1\u6587\u8108\u3092\u7528\u3044\u305f\u307b\u3046\u304c\u77ed\u304f\u8a18\u8ff0\u3067\u304d\u307e\u3057\u305f\u3002\n\u51e6\u7406\u306f\u9045\u304f\u306a\u308a\u307e\u3059\u304c[]\u3092\u7a74\u3068\u3057\u3066\u8a18\u8ff0\u3059\u308c\u3070\u3001\u7406\u89e3\u3057\u3084\u3059\u3044\u304b\u3082\u3057\u308c\u307e\u305b\u3093:\ne(S+T, E+T, P) :- \\+v(S), e(S, E, P).\ne(V+T, V+E, P) :- v(V), \\+v(T), e(T, E, P).\ne(S-T, E-T, P) :- \\+v(S), e(S, E, P).\ne(V-T, V-E, P) :- v(V), \\+v(T), e(T, E, P).\ne(S*T, E*T, P) :- \\+v(S), e(S, E, P).\ne(V*T, V*E, P) :- v(V), \\+v(T), e(T, E, P).\ne(S/T, E/T, P) :- \\+v(S), e(S, E, P).\ne(V/T, V/E, P) :- v(V), \\+v(T), e(T, E, P).\ne(T, [], T).\n\ne(S, E, T), S\\=T, T ---> T_, subst([], T_, E, S_)\n--%------------------------------------ (E-EvalContext)\nS ---> S_.\n\ne/3\u306f\u9805\u3001\u8a55\u4fa1\u6587\u8108\u3001\u8a55\u4fa1\u6587\u8108\u306e\u7a74\u306b\u30de\u30c3\u30c1\u3057\u305f\u9805\u3092\u5909\u6570\u3068\u3057\u3066\u53d7\u3051\u53d6\u308b\u8ff0\u8a9e\u3067\u3059\u3002\u7a74\u306f[]\u3068\u8868\u3059\u305f\u3081\u3001\u7a74\u3092\u8868\u3059\u5909\u6570\u306f\u8fd4\u5374\u3057\u307e\u305b\u3093\u3002\n\u7a74\u3092\u9805\u3067\u57cb\u3081\u308b\u306b\u306fsubst\u3092\u4f7f\u3063\u3066\u7f6e\u304d\u63db\u3048\u307e\u3059\u3002[]\u3092\u4ed6\u306b\u7528\u3044\u308b\u3053\u3068\u306b\u306a\u3063\u305f\u5834\u5408\u306b\u5bfe\u51e6\u3067\u304d\u306a\u304f\u306a\u308b\u554f\u984c\u306f\u3042\u308b\u3067\u3057\u3087\u3046\u3002\n\n\u5358\u76f8\u578b\u63a8\u8ad6\n\ntypeof.pl\n:- op(1000,yfx,$).\ntype_of(_,I,int) :- integer(I).\ntype_of(C,X,T) :- var(X), member(Y:T,C),X==Y.\ntype_of(C,E1+E2,int) :- type_of(C,E1,int),type_of(C,E2,int).\ntype_of(C,X->E,T->T2) :- type_of([X:T|C],E,T2).\ntype_of(C,E1 $ E2, T) :- type_of(C,E1,T2->T),type_of(C,E2,T2).\n\n:- type_of([], 1+1,T),writeln(T).\n:- type_of([], (X->(X+1)),T),writeln(T).\n:- type_of([], Y->(X->(X+Y)),T),writeln(T).\n:- type_of([], (X->(X+1))$(1+1),T),writeln(T).\n:- halt.\n\n\n\u3068\u66f8\u3051\u307e\u3059\u3002Prolog\u306f\u52d5\u7684\u578b\u4ed8\u3051\u306e\u8a00\u8a9e\u3068\u8a00\u3048\u308b\u3068\u601d\u3044\u307e\u3059\u304c\u3001\u306a\u306b\u3082\u306a\u3044\u4e16\u754c\u306b\u9759\u7684\u578b\u3092\u4f5c\u308b\u5834\u5408\u306b\u306f\u578b\u304c\u306a\u3044\u8a00\u8a9e\u3067\u66f8\u304f\u307b\u3046\u304c\u308f\u304b\u308a\u3084\u3059\u3044\u5834\u5408\u3082\u3042\u308b\u3067\u3057\u3087\u3046\u3002\u30b7\u30fc\u30af\u30a8\u30f3\u30c8\u8a08\u7b97\u306b\u4f3c\u305b\u305f\u8a18\u8ff0\u3084\u3001\u56f3\u3092\u66f8\u3044\u3066\u307f\u308b\u3068\u3088\u308a\u7406\u89e3\u304c\u9032\u3080\u3068\u601d\u3044\u307e\u3059\u306e\u3067\u6311\u6226\u3057\u3066\u307f\u3066\u304f\u3060\u3055\u3044\u3002\n\n\u591a\u76f8\u578b\u63a8\u8ad6\n\u591a\u76f8\u306e\u578b\u63a8\u8ad6\u3082\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u8a18\u8ff0\u53ef\u80fd\u3067\u3059\u3002\n:- set_prolog_flag(occurs_check,true).\n:- op(500,xfy,$).\n\ntype(_, I, int) :- integer(I).\ntype(\u0393, E1+E2, int) :- type(\u0393, E1, int), type(\u0393, E2, int).\ntype(\u0393, X, T1) :- atom(X), member(X:T, \u0393), instantiate(T, T1).\ntype(\u0393, X -> E, T1 -> T2) :- type([X:mono(T1)|\u0393], E, T2).\ntype(\u0393, X $ Y, B) :- type(\u0393,X,A -> B), type(\u0393,Y,A).                               \ntype(\u0393, let(X = E0, E1), T) :- type(\u0393, E0, A), type([X:poly(\u0393,A) | \u0393], E1, T).\n\ninstantiate(poly(\u0393,T),T1) :- copy_term((\u0393,T),(\u0393,T1)).                         \ninstantiate(mono(T),T).\n\nrun(\u0393,E) :- type(\u0393,E,T), writeln(E : T).\n\n:-run([],x->x).\n:-run([],x->x+1).\n:-run([],x->y->(y$x)).\n:-run([],let(id=(x->x),id$id)).\n:-run([],let(id=(x->x),(id$(x->x+1))$(id $ 10))).\n:- halt.\n\n\u5177\u4f53\u5316\u3059\u308b\u969b\u306b\u30b3\u30f3\u30c6\u30ad\u30b9\u30c8\u3068\u578b\u3092\u5408\u308f\u305b\u305f\u4e2d\u3067\u5909\u6570\u306f\u5225\u306a\u3082\u306e\u306b\u66f8\u304d\u63db\u3048\u308b\u3053\u3068\u3067\u5177\u4f53\u5316\u304c\u53ef\u80fd\u306b\u306a\u308a\u307e\u3059\u3002type_of\u3067\u306f\u306a\u304ftype\u3068\u66f8\u3044\u3066\u3042\u3063\u305f\u308a\u3001\u8868\u8a18\u306e\u4e71\u308c\u304c\u3042\u308a\u307e\u3059\u304c\u3001\u69d8\u3005\u306a\u8ad6\u6587\u3067\u3082\u540c\u69d8\u306e\u8868\u8a18\u306e\u9055\u3044\u304c\u3042\u308b\u306e\u3067\u3069\u3046\u66f8\u3044\u3066\u3082\u52d5\u304f\u3068\u3044\u3046\u3053\u3068\u3092\u7406\u89e3\u3059\u308b\u3068\u3001\u5e45\u304c\u5e83\u304c\u308b\u306e\u3067\u306f\u306a\u3044\u304b\u3068\u601d\u3044\u307e\u3059\u3002\n\n\u90e8\u5206\u578b\u4ed8\u3051\u3068\u30a2\u30eb\u30b4\u30ea\u30ba\u30df\u30c3\u30af\u306a\u90e8\u5206\u578b\u4ed8\u3051\n\u90e8\u5206\u578b\u4ed8\u3051\u306e\u898f\u5247\u306f\u69cb\u6587\u4e3b\u5c0e\u306e\u898f\u5247\u3067\u306f\u306a\u304f\u3001\u6df1\u3055\u512a\u5148\u63a2\u7d22\u3092\u8a55\u4fa1\u6226\u7565\u3068\u3057\u3066\u7528\u3044\u308bProlog\u3067\u5b9f\u884c\u3059\u308b\u3068\u7121\u9650\u30eb\u30fc\u30d7\u306b\u9665\u308a\u307e\u3059\u3002Prolog\u3067\u52d5\u4f5c\u3055\u305b\u308b\u306b\u306f\u30a2\u30eb\u30b4\u30ea\u30ba\u30df\u30c3\u30af\u306a\u898f\u5247\u306b\u66f8\u304d\u63db\u3048\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\u30ab\u30a4\u30f3\u30c9\u3092\u6c42\u3081\u308b\u5834\u5408\u306f\u66f4\u306b\u4e8b\u60c5\u304c\u60aa\u304f\u306a\u308a\u3001\u7c21\u5358\u306a\u898f\u5247\u3060\u3051\u3067\u306f\u5bfe\u51e6\u3067\u304d\u306a\u304f\u306a\u308b\u3088\u3046\u3067\u3059\u3002\u69cb\u6587\u4e3b\u5c0e\u3067\u306f\u306a\u3044\u63a8\u8ad6\u898f\u5247\u3092\u7528\u3044\u3066\u8a3c\u660e\u3092\u884c\u3046\u3053\u3068\u306f\u53ef\u80fd\u306a\u306e\u3067\u3001\u30a2\u30eb\u30b4\u30ea\u30ba\u30df\u30c3\u30af\u3067\u306f\u306a\u3044\u898f\u5247\u306b\u3082\u610f\u5473\u306f\u3042\u308b\u306e\u3067\u3059\u3002\n\nrcdsub.pl\n:- op(910, xfx, [ \u22a2 ]).\n:- op(901, xfx, [\u2208]).\n%:- op(900, xfx, [ : ]).\n:- op(501, xfx, <:).\n:- op(500, yfx, $).\n:- op(11, yfx, .>).\n:- op(1200, xfx, [ -- ]).\nterm_expansion(A -- B, B :- A).\n\nmaptpl(F,(A,B)) :- call(F,A), maptpl(F,B).\nmaptpl(F,A) :- call(F,A).\nmaprcd(F,{T}) :- maptpl(F,T).\nmaptpl(F,(A,B),(A_,B_)) :- call(F,A,A_), maptpl(F,B,B_).\nmaptpl(F,A,A_) :- call(F,A,A_).\nmaprcd(F,{T},{T_}) :- maptpl(F,T,T_).\nmembertpl(X,(X,_)).\nmembertpl(X,(_,B)) :- membertpl(X,B).\nmembertpl(X,X).\nmemberrcd(X,{T}) :- membertpl(X,T).\n\nisVal(_ -> _).\nisVal(V) :- isRcdVal(V).\nisRcdVal(T) :- maprcd(isRcdVal1, T).\nisRcdVal1(L=T) :- atom(L), isVal(T).\n\nT <: T.\n_ <: top.\nbot <: _.\n(S1->S2) <: (T1->T2) :- S1 <: T1, S2 <: T2.\nS <: T :- maprcd(subtypercd1(S), T).\nsubtypercd1(S, (Li:Ti)) :- memberrcd(Li:Si,S), Si <: Ti.\n\nX \u2208 (_,X).\nX \u2208 (\u0393,_) :- X \u2208 \u0393.\n\nX : T \u2208 \u0393\n--%-------------------------------------- (TA-Var)\n\u0393 \u22a2 (X : T).\n\n(\u0393, X : T1) \u22a2 E2 : T2\n--%-------------------------------------- (TA-Abs)\n\u0393 \u22a2 ((X : T1) -> E2) : (T1 -> T2).\n\n\u0393 \u22a2 E1 : bot, \u0393 \u22a2 E2 : _\n--%-------------------------------------- (TA-AppBot)\n\u0393 \u22a2 E1 $ E2 : bot.\n\n\u0393 \u22a2 E1 : (T11 -> T12),\n\u0393 \u22a2 E2 : T2, T2 <: T11\n--%-------------------------------------- (TA-App)\n\u0393 \u22a2 E1 $ E2 : T12.\n\n\u0393 \u22a2 E1 : R1, memberrcd(Li:Ti,R1)\n--%-------------------------------------- (TA-Proj)\n\u0393 \u22a2 E1.>Li : Ti.\n\nmaprcd(taRcd1(\u0393),E1,T1)\n--%-------------------------------------- (TA-Rcd)\n\u0393 \u22a2 E1 : T1.\n\ntaRcd1(\u0393,Li=Ei,Li:Ti) :- \u0393 \u22a2 Ei : Ti.\ntypeof(E1:T1) :- [] \u22a2 E1 : T1.\n% test sub\n:- {a:bot,b:top,c:top} <: {b:top,a:bot}.\n:- {a:bot,b:top} <: {b:top,a:bot}.\n:- \\+ ({a:bot} <: {b:top,a:bot}).\n:- \\+ ({a:bot,b:top} <: {b:top,a:bot,c:top}).\n\n% test mapRcd\n:- V=((x:top)-> x), maprcd(writeln,{a=V,b=V,c=V}).\n\n% test isValRcd\n:- \\+ isRcdVal({}).\n:- \\+ isRcdVal(1).\n:- V=((x:top)-> x),isRcdVal({a=V,b=V}).\n:- V=((x:top)-> x),isRcdVal({a=V,b=V,c=V}).\n\n% test typeof\n:- typeof(((x:top)-> x):T),writeln(T),!,T=(top->top).\n:- typeof(((x:top)-> x)$((x:top)-> x):T2),writeln(T2).\n:- typeof(((x:(top->top))-> x) $ ((x:top)-> x):T3),writeln(T3).\n:- typeof((((r:{x:(top->top)})-> r.>x $ r.>x)):T4a),writeln(T4a).\n:- typeof({x=((z:top)->z)}:TT),writeln(TT).\n:- typeof((((r:{x:(top->top)})-> (r.>x $ r.>x)) $ {x=((z:top)->z), y=((z:top)->z)}):T4),writeln(T4).\n:- typeof(((x:bot)-> x):T5),writeln(T5),!,T5=(bot->bot).\n:- typeof(((x:bot)-> (x $ x)):T6),writeln(T6),!,T6=(bot->bot).\n\n:- halt.\n\n\n\n\u307e\u3068\u3081\n\u69d8\u3005\u306a\u4f8b\u3067\u3001\u63a8\u8ad6\u898f\u5247\u3092Prolog\u306b\u66f8\u304d\u63db\u3048\u3066\u307f\u307e\u3057\u305f\u3002\n\u3059\u3079\u3066\u306e\u30b7\u30fc\u30af\u30a8\u30f3\u30c8\u8a08\u7b97\u306e\u63a8\u8ad6\u898f\u5247\u3092Prolog\u306b\u3059\u3050\u306b\u66f8\u304d\u63db\u3048\u308b\u3053\u3068\u306f\u51fa\u6765\u308b\u308f\u3051\u3067\u306f\u3042\u308a\u307e\u305b\u3093\u3002\u3057\u304b\u3057\u306a\u304c\u3089\u3001\u591a\u304f\u306e\u5834\u5408\u306b\u7d20\u76f4\u306bProlog\u306b\u66f8\u304d\u63db\u3048\u308b\u3053\u3068\u304c\u53ef\u80fd\u3067\u3059\u3002Prolog\u306b\u66f8\u304d\u63db\u3048\u51fa\u6765\u306a\u3044\u3088\u3046\u306a\u5834\u5408\u306f\u69cb\u6587\u4e3b\u5c0e\u306e\u898f\u5247\u3067\u306f\u306a\u3044\u306e\u3067\u30a2\u30eb\u30b4\u30ea\u30ba\u30df\u30c3\u30af\u306a\u898f\u5247\u306b\u66f8\u304d\u63db\u3048\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\nProlog\u3067\u7d20\u76f4\u306b\u66f8\u304f\u3053\u3068\u304c\u3067\u304d\u308b\u63a8\u8ad6\u898f\u5247\u3067\u3042\u308c\u3070\u3001\u8ad6\u7406\u578b\u8a00\u8a9e\u3088\u308a\u4f4e\u7d1a\u306a\u8a00\u8a9e\u306b\u66f8\u304d\u63db\u3048\u9ad8\u901f\u5316\u3059\u308b\u3053\u3068\u3082\u5bb9\u6613\u3068\u306a\u308b\u3067\u3057\u3087\u3046\u3002Prolog\u306f\u8ad6\u7406\u578b\u8a00\u8a9e\u306e\u6bb5\u968e\u3067\u5b9f\u88c5\u4e0a\u306e\u554f\u984c\u3092\u89e3\u6c7a\u3059\u308b\u3053\u3068\u304c\u51fa\u6765\u307e\u3059\u3002\u662f\u975e\u7686\u3055\u3093\u3082\u6311\u6226\u3057\u3066\u307f\u3066\u304f\u3060\u3055\u3044\u3002\n\n\u53c2\u8003\u6587\u732e\nTIPER Type Inference Prototyping Engines from Relational Specifications of type systems http://kyagrd.github.io/tiper/\nCoPL\nTAPL\nThe Essence of Dependent Object Types\nCOMFRK vol.1 Prolog \u3067 Scheme \u306e\u64cd\u4f5c\u7684\u610f\u5473\u8ad6\u3092\u5b9f\u88c5 zick\nhttp://comfrk.info/arch/vol1.pdf\n# \u306f\u3058\u3081\u306b\n\n\u8a00\u8a9e\u3092\u4f5c\u308b\u5834\u5408\u306b\u306f BNF \u304c\u3042\u308a\u64cd\u4f5c\u7684\u610f\u5473\u3084\u578b\u4ed8\u3051\u898f\u5247\u3092\u5b9a\u7fa9\u3057\u3066\u3042\u308b\u3068\u8aac\u5f97\u529b\u304c\u5897\u3057\u307e\u3059\u3002\u30b7\u30fc\u30af\u30a8\u30f3\u30c8\u8a08\u7b97\u306e\u63a8\u8ad6\u898f\u5247\u306f\u9577\u65b9\u5f62\u306b\u53ce\u3081\u308b\u3053\u3068\u304c\u51fa\u6765\u308b\u306e\u3067\u3001\uff12\u6b21\u5143\u7684\u306b\u56f3\u3068\u3057\u3066\u66f8\u304f\u306b\u306f\u3068\u3066\u3082\u4fbf\u5229\u306a\u8a18\u8ff0\u65b9\u6cd5\u3067\u3059\u3002\u3057\u304b\u3057\u3001\u8aad\u307f\u66f8\u304d\u3059\u308b\u306b\u306f\u3001\u3088\u304f\u77e5\u3089\u308c\u3066\u3044\u308b\u51e6\u7406\u7cfb\u304c\u306a\u3044\u306e\u3067\u306a\u304b\u306a\u304b\u899a\u3048\u308b\u3053\u3068\u304c\u51fa\u6765\u306a\u3044\u4eba\u3082\u591a\u3044\u306e\u3067\u306f\u306a\u3044\u3067\u3057\u3087\u3046\u304b\uff1f\n\n```math\n\\begin{array}{lr}\n  \u8a55\u4fa1 &\n  \\bbox[3px,border:1px solid black]{\\;t \\longrightarrow t}\n  \\\\[-30px]\n  \\hspace{250px}\n  \\\\[-30px]\n\\end{array}\n\\\\\n\\begin{array}{cr}\n  \\dfrac{\n    t_1 \\longrightarrow t_1' }{\n    t_1\\;t_2 \\longrightarrow t_1'\\;t_2 }\n  & \\text{(E-App1)}\n  \\\\\n  \\dfrac{\n    t_2 \\longrightarrow t_2' }{\n    v_1\\;t_2 \\longrightarrow v_1'\\;t_2}\n  & \\text{(E-App2)}\n  \\\\\n  (\\lambda x.t_{12})\\;v_2 \\longrightarrow\n  [x \\rightarrow t_1]\\;t_{12}\n  & \\text{(E-AppAbs)}\n\\end{array}\n```\n\n\u305d\u3053\u3067\u3001\u3053\u3053\u3067\u306f\u3001Prolog \u3092\u7528\u3044\u3066\u30b7\u30fc\u30af\u30a8\u30f3\u30c8\u8a08\u7b97\u306b\u4f3c\u305b\u305f\u8a18\u8ff0\u3092\u3059\u308b\u624b\u6cd5\u3092\u63d0\u6848\u3057\u307e\u3059\u3002\u8ad6\u7406\u578b\u8a00\u8a9e\u306e\u51e6\u7406\u7cfb\u3067\u3088\u304f\u77e5\u3089\u308c\u3066\u3044\u308b\u8a00\u8a9e\u3068\u3044\u3048\u3070 Prolog \u3067\u3059\u3002\u6b8b\u5ff5\u306a\u304c\u3089Prolog\u306f\u66f8\u304f\u9806\u756a\u304c\u7570\u306a\u308b\u305f\u3081\u30b7\u30fc\u30af\u30a8\u30f3\u30c8\u8a08\u7b97\u3067\u306f\u3042\u308a\u307e\u305b\u3093\u304c\u5de5\u592b\u3092\u3059\u308b\u3053\u3068\u3067\u4f3c\u305b\u308b\u3053\u3068\u304c\u53ef\u80fd\u3067\u3059\u3002\n\n\u307e\u305a\u8efd\u304fProlog\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3084Helloworld\u3068\u30d5\u30a3\u30dc\u30ca\u30c3\u30c1\u306e\u8a08\u7b97\u3092\u7d39\u4ecb\u3057\u307e\u3059\u3002\u6b21\u306b\u3001\u95a2\u6570\u578b\u8a00\u8a9e\u3067\u6271\u3046\u3088\u3046\u306a\u69cb\u6587\u6728\u3092\u8a55\u4fa1\u3059\u308b\u5927\u30b9\u30c6\u30c3\u30d7\u8a55\u4fa1\u5668\u3092\u4f5c\u6210\u3057\u3001\u30b7\u30fc\u30af\u30a8\u30f3\u30c8\u8a08\u7b97\u306b\u4f3c\u305f\u8868\u8a18\u306b\u66f8\u304d\u63db\u3048\u307e\u3059\u3002\u307e\u305f\u3001if\u3092\u4f7f\u3063\u305f\u65b9\u6cd5\u3092\u7d39\u4ecb\u3057\u3001\u5c0f\u30b9\u30c6\u30c3\u30d7\u8a55\u4fa1\u5668\u3068\u8a55\u4fa1\u6587\u8108\u3092\u7d39\u4ecb\u3057\u307e\u3059\u3002\u305d\u306e\u5f8c\u3001\u5358\u76f8\u578b\u63a8\u8ad6\u3001\u591a\u76f8\u578b\u63a8\u8ad6\u7b49\u3092\u7d39\u4ecb\u3057\u307e\u3059\u3002\u6700\u5f8c\u306b\u3001\u90e8\u5206\u578b\u4ed8\u3051\u306b\u304a\u3051\u308bProlog\u306e\u9650\u754c\u3068\u30a2\u30eb\u30b4\u30ea\u30ba\u30df\u30c3\u30af\u306a\u90e8\u5206\u578b\u4ed8\u3051\u306b\u3088\u308b\u89e3\u6c7a\u65b9\u6cd5\u3092\u8ff0\u3079\u307e\u3059\u3002\n\u3053\u308c\u3089\u306e\u7d39\u4ecb\u3057\u305f\u624b\u6cd5\u3067Prolog\u3092\u4f7f\u3063\u3066\u69d8\u3005\u306a\u8a00\u8a9e\u306e\u51e6\u7406\u7cfb\u3092\u4f5c\u308c\u3070\u3001\u5f62\u5f0f\u7684\u306a\u8a00\u8a9e\u3092\u8aad\u307f\u66f8\u304d\u3059\u308b\u7d20\u990a\u304c\u8eab\u306b\u3064\u304f\u3053\u3068\u3067\u3057\u3087\u3046\u3002\n\n## \u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\nProlog\u306e\u51e6\u7406\u7cfb\u306f\u69d8\u3005\u3042\u308a\u307e\u3059\u304c\u3001SWI-Prolog\u306fUTF-8\u3082\u4f7f\u3048\u308b\u306e\u3067\u304a\u3059\u3059\u3081\u3067\u3059\u3002\n\n```bash\nbrew install swi-prolog\napt-get install swi-prolog\n```\n\nWindows\u7248\u306eSWI-Prolog\u3082\u5b58\u5728\u307e\u3059\u304c\u3001BOM\u306e\u8ffd\u52a0\u304c\u5fc5\u8981\u3068\u306a\u308b\u305f\u3081VM\u4e0a\u3067\u7528\u3044\u308b\u3053\u3068\u3092\u304a\u3059\u3059\u3081\u3057\u307e\u3059\u3002\n\n## Hello World\n\n```prolog:hello.pl\n:- write('hello world'),nl.\n:- halt.\n```\n\nProlog\u3067\u306f\u8ff0\u8a9e\u3092,\u3067\u533a\u5207\u3063\u3066\u8907\u6570\u8a18\u8ff0\u3059\u308b\u3053\u3068\u306b\u3088\u308a\u30d7\u30ed\u30b0\u30e9\u30e0\u3092\u8a18\u8ff0\u3057\u307e\u3059\u3002\n:-\u304b\u3089.\u307e\u3067\u3092\u3059\u3050\u306b\u5b9f\u884c\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002write\u306f\u6a19\u6e96\u51fa\u529b\u306b\u51fa\u529b\u3059\u308b\u8ff0\u8a9e\u3067\u3001nl\u306f\u6539\u884c\u3092\u51fa\u529b\u3059\u308b\u8ff0\u8a9e\u3067\u3059\u3002halt\u306f\u30d7\u30ed\u30b0\u30e9\u30e0\u3092\u7d42\u4e86\u3059\u308b\u8ff0\u8a9e\u3067\u3059\u3002\n\u62e1\u5f35\u5b50\u306fPerl\u3068\u304b\u3076\u308a\u307e\u3059\u304cpl\u3092\u4f7f\u3044\u307e\u3059\u3002\n\n```bash\n$ swipl hello.pl\nhello world\n```\n\n\u5b9f\u884c\u3059\u308b\u306b\u306f\u3001`swipl hello.pl` \u3068\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3057\u307e\u3059\u3002\n\u30d7\u30ed\u30b0\u30e9\u30e0\u306b\u30d0\u30b0\u304c\u3042\u3063\u305f\u5834\u5408\u306a\u3069\u3067repl\u304c\u8868\u793a\u3055\u308c\u308b\u3053\u3068\u304c\u3042\u308a\u307e\u3059\u3002\n\u305d\u3046\u3044\u3063\u305f\u5834\u5408\u3082\u3001\u3042\u308f\u3066\u305a\u3001`?- halt.`\u3068\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n## \u8db3\u3057\u7b97\u3092\u3059\u308b\u8ff0\u8a9e\n\nProlog\u306b\u306f\u95a2\u6570\u304c\u306a\u3044\u306e\u3067\u3059\u304c\u3001\u4ee3\u308f\u308a\u306b\u8ff0\u8a9e\u3092\u4f7f\u3044\u307e\u3059\u3002\n\u8ff0\u8a9e\u3067\u5024\u3092\u8fd4\u3059\u306b\u306f\u5909\u6570\u306b\u5024\u3092\u675f\u7e1b\u3059\u308b\u3053\u3068\u3067\u8fd4\u5374\u3057\u307e\u3059\u3002\n\u8db3\u3057\u7b97\u3092\u3059\u308b\u8ff0\u8a9e\u3092\u5b9a\u7fa9\u3057\u3066\u4f7f\u3046\u306b\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u3057\u307e\u3059\u3002\n\n```prolog:add.pl\nadd(X,Y,R) :- R is X + Y.\n:- add(1,2,R),writeln(R),halt.\n```\n\nC\u8a00\u8a9e\u306evoid\u306a\u95a2\u6570\u3067\u30dd\u30a4\u30f3\u30bf\u3092\u7528\u3044\u3066\u5024\u3092\u8fd4\u3059\u30a4\u30e1\u30fc\u30b8\u306b\u4f3c\u3066\u3044\u307e\u3059\u3002\n\n## \u30d5\u30a3\u30dc\u30ca\u30c3\u30c1\n\n```prolog:fib.pl\nfib(0,0).\nfib(1,1).\nfib(X,R):-\n  X1 is X-1, X2 is X-2,\n  fib(X1, R1), fib(X2, R2), R is R1 + R2.\n\n:- fib(10,R), writeln(R),halt.\n```\n\n\u6b8b\u5ff5\u306a\u304c\u3089\u3001\u95a2\u6570\u3092\u30cd\u30b9\u30c8\u3057\u3066\u8a18\u8ff0\u3067\u304d\u306a\u3044\u306e\u3067\u30d5\u30a3\u30dc\u30ca\u30c3\u30c1\u306e\u3088\u3046\u306a\u8a08\u7b97\u306f\u8a18\u8ff0\u91cf\u304c\u5897\u3048\u307e\u3059\u3002\n\u3053\u308c\u3092\u307f\u3066\u30c0\u30e1\u3060\u306a\u3068\u601d\u3063\u3066Prolog\u3092\u3084\u3081\u308b\u4eba\u306f\u591a\u3044\u3067\u3057\u3087\u3046\u3002\n\n# Prolog\u3067\u66f8\u304f\u5927\u30b9\u30c6\u30c3\u30d7\u8a55\u4fa1\u5668\n\n\u3053\u3053\u304b\u3089\u304c\u3001Prolog\u306e\u672c\u9818\u767a\u63ee\u3067\u3059\u3002\n\u30e9\u30e0\u30c0\u8a08\u7b97\u306fProlog\u3067\u306f\u308f\u305a\u304b\u6570\u884c\u3067\u8a18\u8ff0\u53ef\u80fd\u3067\u3059\u3002\n\nHOAS\u7684\u306b\u66f8\u304f\u3068\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u304b\u3051\u307e\u3059\u3002\n\n```prolog:lambda.pl\n:-op(1000,yfx,$).\neval(I,I) :- integer(I).\neval(E1+E2,R) :- eval(E1,R1),eval(E2,R2), R is R1 + R2.\neval(X->E,X->E).\neval(E1$E2,R) :- eval(E1,X->E),eval(E2,Y),copy_term(X->E,Y->E3),eval(E3,R).\n\n:- eval((Y->X->X+Y)$(1+1)$(3),R),writeln(R).\n:- eval((F->X->Y->(F$X)+(F$Y))$(Z->Z+1)$3$4,R),writeln(R).\n:- halt.\n```\n\nHOAS\u7684\u3068\u3044\u3046\u306e\u306f\u3001\u5909\u6570\u540d\u306bProlog\u306e\u5909\u6570\u3092\u76f4\u63a5\u7528\u3044\u3066\u3044\u308b\u304b\u3089\u3067\u3059\u3002\n\u3053\u306e\u65b9\u6cd5\u3067\u306f\u3001(X->X)$(X->X)\u3068\u3044\u3063\u305f\u5f0f\u3092\u66f8\u3044\u305f\u5834\u5408\u306b\u30e9\u30e0\u30c0\u62bd\u8c61\u306e\u5909\u6570\u304c\u5171\u6709\u3055\u308c\u3066\u3057\u307e\u3046\u554f\u984c\u304c\u3042\u308b\u306e\u3067\u6ce8\u610f\u304c\u5fc5\u8981\u3067\u3059\u3002\n\n\u7f6e\u63db\u64cd\u4f5c\u3092\u3088\u308a\u8a73\u7d30\u306b\u884c\u3046\u306b\u306f\u4f8b\u3048\u3070\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u8a18\u8ff0\u3057\u307e\u3059\u3002\n\n```prolog:lambda.pl\n:-op(1000,yfx,$).\neval(I,I) :- integer(I).\neval(E1+E2,R) :- eval(E1,R1), eval(E2,R2), R is R1 + R2.\neval(X->E,X->E).\neval(E1$E2,R) :- eval(E1,X->E),eval(E2,E2_),subst(X,Y,E,E3),eval(E3,R).\n\nsubst(X,X,E,E).\nsubst(X,Y,I,I) :- integer(I).\nsubst(X,Y,E1+E2, E1_+E2_) :- \n  subst(X,Y,E1,E1_),subst(X,Y,E2,E2_).\nsubst(X,Y,X->E1,X->E1).\nsubst(X,Y,Y->E1,Y_->E2):- term_to_atom(_,Y_),subst(Y,Y_,E1,E1_),subst(X,Y,E1_,E2).\nsubst(X,Y,X1->E1,X2->E1_) :- subst(X,Y,E1,E1_).\n:- eval((y->x->x+Yx$(1+1)$(3),R),writeln(R).\n:- eval((f->x->y->(f$x)+(f$y))$(z->z+1)$3$4,R),writeln(R).\n:- halt.\n```\n\n\u672c\u8cea\u7684\u306a\u7b87\u6240\u306e\u307f\u3092\u7aef\u7684\u306b\u8868\u3059\u3053\u3068\u3082\u53ef\u80fd\u3067\u3059\u3057\u3001\u3088\u308a\u8a73\u7d30\u306b\u8a18\u8ff0\u3059\u308b\u3053\u3068\u3082Prolog\u3092\u7528\u3044\u3066\u53ef\u80fd\u306a\u306e\u3067\u3059\u3002\n\n# \u30b7\u30fc\u30af\u30a8\u30f3\u30c8\u8a08\u7b97\u306b\u4f3c\u305b\u305f\u5927\u30b9\u30c6\u30c3\u30d7\u8a55\u4fa1\u5668\n\n\u30e9\u30e0\u30c0\u8a08\u7b97\u3092\u30b7\u30fc\u30af\u30a8\u30f3\u30c8\u8a08\u7b97\u306e\u56f3\u3067\u8868\u3059\u3068\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u8868\u3059\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n\u69cb\u6587\n\n```math\n\\begin{array}{llr}\ne ::= & & \u9805: \\\\\n      & i & \u6574\u6570\\\\\n      & e + e & \u52a0\u7b97 \\\\\n      & e \\;\\text{->}\\; e & \u30e9\u30e0\u30c0\u62bd\u8c61 \\\\\n      & e \\;$\\; e & \u95a2\u6570\u9069\u7528 \\\\\n\\end{array}\n```\n\n\u8a55\u4fa1\u898f\u5247\n\n```math\n\\begin{array}{cr}\ni \\Downarrow i & \\text{(E-Int)}\\\\\n\\dfrac{e_1 \\Downarrow i_1 \\quad e_1 \\Downarrow i_2 \\quad i\\;is\\;i_1+i_2 }\n{ e_1+e_2 \\Downarrow i } & \\text{(E-Add)} \\\\\ne_1\\;\\text{->}\\;e_2 \\Downarrow e_1\\;\\text{->}\\;e_2 & \\text{(E-Abs)} \\\\\n\\dfrac{e_1 \\Downarrow x\\;\\text{->}\\;e\\quad e_1 \\Downarrow v_2\\quad [x\\;\\text{->}\\;e_1]e \\Downarrow v}\n{e_1\\;$\\;e_2 \\Downarrow v} & \\text{(E-App)} \\\\\n\\end{array}\n```\n\n\u3053\u306e\u8a18\u8ff0\u306bProlog\u306e\u30d7\u30ed\u30b0\u30e9\u30e0\u3092\u4f3c\u305b\u3066\u307f\u307e\u3057\u3087\u3046\u3002\n\u8ff0\u8a9eterm_expansion/2\u306f\u8aad\u307f\u8fbc\u307f\u6642\u306b\u8ff0\u8a9e\u5b9a\u7fa9\u3092\u66f8\u304d\u63db\u3048\u53ef\u80fd\u306a\u8ff0\u8a9e\u3067\u3059\u3002\n`term_expansion(A--B,B:-A).`\u3068\u66f8\u304f\u3068\u8aad\u307f\u8fbc\u307f\u6642\u306b\u524d\u5f8c\u306e\u9806\u756a\u3092\u53cd\u8ee2\u3067\u304d\u308b\u306e\u3067\u3001\u8ad6\u6587\u306b\u3088\u304f\u7528\u3044\u3089\u308c\u308b\u30b7\u30fc\u30b1\u30f3\u30c8\u8a08\u7b97\u306e\u63a8\u8ad6\u898f\u5247\u306b\u4f3c\u305b\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n```prolog:sequent.pl\n:-op(1200,xfx,--).\n:-op(801,xfx,\u21d3).\n:-op(799,xfy,->).\n:-op(500,yfx,$).\nterm_expansion(A--B,B:-A).\n\ninteger(I)\n--                              % (E-Int)\nI \u21d3 I.\n\nE1 \u21d3 R1, E2 \u21d3 R2, R is R1 + R2\n--                %-------------- (E-Add)\nE1+E2 \u21d3 R.\n\n!\n-- %----------------------------- (E-Abs)\nX->E \u21d3 X->E.\n\nE1 \u21d3 X->E, E2 \u21d3 Y,\ncopy_term(X->E,Y->E3), E3 \u21d3 R\n--%------------------------------ (E-App)\nE1 $ E2 \u21d3 R.\n\n:- (Y->X->X+Y)$(1+1)$(3) \u21d3 R,writeln(R).\n:- (F->X->Y->(F$X)+(F$Y))$(Z->Z+1)$3$4 \u21d3 R,writeln(R).\n:- halt.\n```\n\nProlog\u306e%\u306f\u4e00\u884c\u30b3\u30e1\u30f3\u30c8\u306a\u306e\u3067\u3001%----- (E-App)\u306e\u3088\u3046\u306b\u7dda\u3092\u597d\u304d\u306a\u9577\u3055\u306b\u3067\u304d\u307e\u3059\u3002\n\u65e5\u672c\u8a9e\u3068\u82f1\u8a9e\u306f\u8a9e\u9806\u304c\u9055\u3046\u306e\u3067\u82f1\u8a9e\u306e\u7fd2\u5f97\u304c\u96e3\u3057\u3044\u3088\u3046\u306b\u3001\u540c\u3058\u30d7\u30ed\u30b0\u30e9\u30e0\u3067\u3082\u524d\u5f8c\u304c\u5909\u308f\u308b\u3060\u3051\u3067\u5370\u8c61\u304c\u304c\u3089\u308a\u3068\u5909\u308f\u308a\u307e\u3059\u3002\u30ab\u30f3\u30de\u533a\u5207\u308a\u306fProlog\u306e\u6587\u6cd5\u4e0a\u3069\u3046\u3057\u3088\u3046\u3082\u3042\u308a\u307e\u305b\u3093\u304c\u3001\u8a9e\u9806\u3092\u5408\u308f\u305b\u308b\u3053\u3068\u3067\u63a8\u8ad6\u898f\u5247\u306b\u3088\u308a\u89aa\u3057\u307f\u3092\u6301\u3064\u3053\u3068\u304c\u3067\u304d\u308b\u3067\u3057\u3087\u3046\u3002\n\n# if\u3092\u7528\u3044\u305f\u8a18\u8ff0\n\nScala\u306e\u57fa\u790e\u3068\u306a\u308bDOT\u306e\u8ad6\u6587\u306a\u3069\u3067\u7528\u3044\u3089\u308c\u3066\u3044\u308b\u3088\u3046\u306a\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u8a18\u8ff0\u3059\u308b\u624b\u6cd5\u3082\u3042\u308a\u307e\u3059\u3002\n\n```math\n\\begin{array}{rcl}\ni & \\Downarrow& i\\\\\ne_1 + e_2 & \\Downarrow & r \\quad if\\;e_1 \\Downarrow r_1,e_2 \\Downarrow r_2, r\\;is\\;r_1 + r_2 \\\\\nx \\rightarrow e & \\Downarrow & x \\rightarrow e\\\\\ne_1\\;e_2 & \\Downarrow & r \\quad  if\\;e_1 \\Downarrow x \\rightarrow e,e_2 \\Downarrow y, [x := y]e \\Downarrow r\\\\\n\\end{array}\n```\n\n\u3053\u306e\u3088\u3046\u306a\u8a18\u8ff0\u306f\u3001if\u3092Prolog\u306e:-\u3068\u8aad\u307f\u66ff\u3048\u307e\u3057\u3087\u3046\u3002\n\n```prolog:lambda_if.pl\n:-op(1200,xfx,if).\n:-op(801,xfx,\u21d3).\n:-op(799,xfy,->).\n:-op(500,yfx,$).\nterm_expansion(A if B, A :- B).\n\n    I \u21d3 I     if integer(I).\nE1+E2 \u21d3 R     if E1 \u21d3 R1, E2 \u21d3 R2, R is R1 + R2.\n X->E \u21d3 X->E.\nE1$E2 \u21d3 R     if E1 \u21d3 (X->E), E2 \u21d3 Y, copy_term((X->E),(Y->E3)), E3 \u21d3  R.\n\n:- (Y->X->X+Y)$(1+1)$(3) \u21d3 R, writeln(R).\n:- (F->X->Y->(F$X)+(F$Y))$(Z->Z+1)$3$4 \u21d3 R, writeln(R).\n:- halt.\n```\n\n# \u5c0f\u30b9\u30c6\u30c3\u30d7\u8a55\u4fa1\u5668\n\n```math\ni \\longrightarrow i\\;\\text{(E-Int)}\\\\\n\n\\dfrac{t_1 \\longrightarrow t_1'}\n{t_1 + t_2 \\longrightarrow t_1' + t_2}\\text{(E-Add1)} \\;\n\\dfrac{t_2 \\longrightarrow t_2'}\n{v_1 + t_2 \\longrightarrow v_1 + t_2'}\\text{(E-Add2)} \\;\n\\dfrac{v_3\\;is\\; v_1 + v_2}\n{v_1 + v_2 \\longrightarrow v_3} \\text{(E-Add3)} \\\\\n\n\\dfrac{t_1 \\longrightarrow t_1'}\n{t_1 - t_2 \\longrightarrow t_1' - t_2} \\text{(E-Sub1)} \\;\n\\dfrac{t_2 \\longrightarrow t_2'}\n{v_1 - t_2 \\longrightarrow v_1 - t_2'} \\text{(E-Sub2)} \\;\n\\dfrac{v_3\\;is\\; v_1 - v_2}\n{v_1 - v_2 \\longrightarrow v_3}\\text{(E-Sub3)} \\\\\n\n\\dfrac{t_1 \\longrightarrow t_1'}\n{t_1 * t_2 \\longrightarrow t_1' * t_2} \\text{(E-Mul1)} \\;\n\\dfrac{t_2 \\longrightarrow t_2'}\n{v_1 * t_2 \\longrightarrow v_1 * t_2'} \\text{(E-Mul2)} \\;\n\\dfrac{v_3\\;is\\; v_1 * v_2}\n{v_1 * v_2 \\longrightarrow v_3} \\text{(E-Mul3)} \\\\\n\n\\dfrac{t_1 \\longrightarrow t_1'}\n{t_1 / t_2 \\longrightarrow t_1' / t_2} \\text{(E-Div1)} \\;\n\\dfrac{t_2 \\longrightarrow t_2'}\n{v_1 / t_2 \\longrightarrow v_1 / t_2'} \\text{(E-Div2)} \\;\n\\dfrac{v_3\\;is\\; v_1 / v_2}\n{v_1 / v_2 \\longrightarrow v_3} \\text{(E-Div3)} \\\\\n```\n\n```prolog:lambda_smallstep.pl\n:- op(920, xfx, [ --->,-->> ]).\n:- op(1200, xfx, [ -- ]).\nterm_expansion(A -- B, B :- A).\n\n\\+integer(A), A ---> A_\n--%------------------------------------ (E-Add1)\nA + B ---> A_ + B.\n\ninteger(V), \\+integer(B), B ---> B_\n--%------------------------------------ (E-Add2)\nV + B ---> V + B_.\n\ninteger(V1), integer(V2), V is V1 + V2\n--%------------------------------------ (E-Add3)\nV1 + V2 ---> V.\n\n\\+integer(A), A ---> A_\n--%------------------------------------ (E-Sub1)\nA - B ---> A_ - B.\n\ninteger(V), \\+integer(B), B ---> B_\n--%------------------------------------ (E-Sub2)\nV - B ---> V - B_.\n\ninteger(V1), integer(V2), V is V1 - V2\n--%------------------------------------ (E-Sub3)\nV1 - V2 ---> V.\n\n\\+integer(A), A ---> A_\n--%------------------------------------ (E-Mul1)\nA * B ---> A_ * B.\n\ninteger(V), \\+integer(B), B ---> B_\n--%------------------------------------ (E-Mul2)\nV * B ---> V * B_.\n\ninteger(V1), integer(V2), V is V1 * V2\n--%------------------------------------ (E-Mul3)\nV1 * V2 ---> V.\n\n\\+integer(A), A ---> A_\n--%------------------------------------ (E-Div1)\nA / B ---> A_ / B.\n\ninteger(V), \\+integer(B), B ---> B_\n--%------------------------------------ (E-Div2)\nV / B ---> V / B_.\n\ninteger(V1), integer(V2), V is V1 div V2\n--%------------------------------------ (E-Div3)\nV1 / V2 ---> V.\n\nA ---> A :- integer(A).               % (E-Int)\n\nA -->> A_ :- \\+v(A), A ---> B, !, B -->> A_.\nA -->> A.\n\n:- 10 ---> R, writeln(R).\n:- 10 + 20 ---> R1, writeln(R1).\n:- 10 - 20 ---> R2, writeln(R2).\n:- 10 * 20 ---> R3, writeln(R3).\n:- 1*2+3/4 -->> R4, writeln(R4).\n:- halt.\n```\n\n\u5c0f\u30b9\u30c6\u30c3\u30d7\u8a55\u4fa1\u5668\u306f\u3001\uff11\u5ea6\u306b\uff11\u3064\u306e\u5909\u63db\u306e\u307f\u3092\u884c\u3044\u307e\u3059\u3002\u5927\u30b9\u30c6\u30c3\u30d7\u8a55\u4fa1\u5668\u3067\u306f\u9014\u4e2d\u7d4c\u904e\u3092\u898b\u308b\u3053\u3068\u304c\u51fa\u6765\u307e\u305b\u3093\u304c\u3001\u5c11\u30b9\u30c6\u30c3\u30d7\u8a55\u4fa1\u5668\u306f\u9014\u4e2d\u306e\u72b6\u614b\u3092\u898b\u308b\u3053\u3068\u304c\u3067\u304d\u308b\u7279\u5fb4\u304c\u3042\u308a\u307e\u3059\u3002\n\n# \u8a55\u4fa1\u6587\u8108\n\n\u30b7\u30fc\u30af\u30a8\u30f3\u30c8\u8a08\u7b97\u306f\u304b\u306a\u308a\u5727\u7e2e\u3057\u3066\u8a18\u8ff0\u3067\u304d\u308b\u306e\u3067\u3059\u304c\u3001\u540c\u3058\u3088\u3046\u306a\u5909\u63db\u898f\u5247\u306f\u52a9\u9577\u3067\u3059\u3002\u8a55\u4fa1\u6587\u8108\u3092\u7528\u3044\u308b\u3068\u3001\u3088\u308a\u63a8\u8ad6\u898f\u5247\u3092\u77ed\u304f\u8a18\u8ff0\u3067\u304d\u307e\u3059\u3002\n\n```math\n\\begin{array}{l}\n\u69cb\u6587\\\\\nt ::= i \\;|\\; t + t \\;|\\; t - t \\;|\\; t * t \\;|\\; t / t \\\\\nv ::= i \\\\\n\u8a55\u4fa1\u6587\u8108\\\\\ne ::= e + t\\;|\\;v + e \\;|\\; e - t \\;|\\; v - e \\;|\\; e * t \\;|\\; v * e \\;|\\; e / t \\;|\\; v / e \\;|\\; []\\\\\n\u8a55\u4fa1\u898f\u5247\\\\\n\\end{array}\\\\\n\\dfrac{v_3\\;is\\; v_1 + v_2}\n{v_1 + v_2 \\longrightarrow v_3} \\text{(E-Add3)} \\;\n\n\\dfrac{v_3\\;is\\; v_1 - v_2}\n{v_1 - v_2 \\longrightarrow v_3}\\text{(E-Sub3)} \\\\\n\n\\dfrac{v_3\\;is\\; v_1 * v_2}\n{v_1 * v_2 \\longrightarrow v_3} \\text{(E-Mul3)} \\;\n\n\\dfrac{v_3\\;is\\; v_1 / v_2}\n{v_1 / v_2 \\longrightarrow v_3} \\text{(E-Div3)} \\\\\n\ni \\longrightarrow i\\;\\text{(E-Int)}\\;\n\n\\dfrac{t_2 \\longrightarrow t_2'}\n{[t_2]e_1 \\longrightarrow [t_2']e_1} \\text{(E-EvalContext)} \\\\\n```\n\n\u307e\u305f\u306f\n\n```math\n\\begin{array}{l}\n\u69cb\u6587\\\\\nt ::= i \\;|\\; t + t \\;|\\; t - t \\;|\\; t * t \\;|\\; t / t \\\\\nv ::= i \\\\\n\n\u8a55\u4fa1\u898f\u5247\\\\\nv_1 + v_2 \\longrightarrow v_3 \\;if\\; v_3\\;is\\; v_1 + v_2\\\\\nv_1 - v_2 \\longrightarrow v_3 \\;if\\; v_3\\;is\\; v_1 - v_2\\\\\nv_1 * v_2 \\longrightarrow v_3 \\;if\\; v_3\\;is\\; v_1 * v_2\\\\\nv_1 / v_2 \\longrightarrow v_3 \\;if\\; v_3\\;is\\; v_1 / v_2\\\\\ni \\longrightarrow i \\\\\n[t_2]e_1 \\longrightarrow [t_2']e_1 \\;if\\; t_2 \\longrightarrow t_2'\\\\\n\\quad where\\;e ::= e + t\\;|\\;v + e \\;|\\; e - t \\;|\\; v - e \\;|\\; e * t \\;|\\; v * e \\;|\\; e / t \\;|\\; v / e \\;|\\; []\\\\\n\n\\end{array}\\\\\n```\n\n\u8a55\u4fa1\u6587\u8108\u306f[]\u3092hole(\u7a74)\u3068\u547c\u3073\u3001\u6b21\u306b\u8a55\u4fa1\u3059\u3079\u304d\u7b87\u6240\u3092\u7a74\u3068\u3057\u3066\u8868\u3057\u307e\u3059\u3002\nt=e[t']\u3068\u8868\u3059\u3053\u3068\u304c\u51fa\u6765\u3066\u3001\u8a55\u4fa1\u6587\u8108e\u306e\u7a74\u306b\u9805t'\u3092\u57cb\u3081\u308b\u3068\u9805t\u306b\u306a\u308a\u307e\u3059\u3002\n\u9805\u304b\u3089\u8a55\u4fa1\u6587\u8108\u3092\u63a2\u3059\u8ff0\u8a9ee/4\u306f\u3001\u9805\u3001\u8a55\u4fa1\u6587\u8108\u3001\u7a74\u306b\u30de\u30c3\u30c1\u3057\u305f\u9805\u3001\u7a74\u3092\u8868\u3059\u5909\u6570\u306e\uff14\u3064\u306e\u5909\u6570\u3092\u53d7\u3051\u53d6\u308a\u3001\u8a55\u4fa1\u6587\u8108\u306b\u7a74\u3092\u57cb\u3081\u305f\u9805\u3092\u53d6\u5f97\u3059\u308b\u306b\u306f\u3001\u7a74\u3068\u306a\u308b\u5909\u6570\u3068\u9805\u3092\u5358\u4e00\u5316\u3059\u308b\u3053\u3068\u3067\u884c\u3044\u307e\u3059\u3002\n\u8a55\u4fa1\u6587\u8108\u3092\u4f7f\u3063\u305f\u5909\u63db\u898f\u5247\u306fProlog\u3067\u66f8\u304f\u3068\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\n\n```prolog:lambda_evaluation_context.pl\n:- op(920, xfx, [ ---> , -->> ]).\n:- op(1200, xfx, [ -- ]).\nterm_expansion(A -- B, B :- A).\n\nv(A) :- integer(A).\ne(S+T, E+T, P, H) :- \\+v(S), e(S,E,P,H).\ne(V+T, V+E, P, H) :- v(V), \\+v(T), e(T,E,P,H).\ne(S-T, E-T, P, H) :- \\+v(S), e(S,E,P,H).\ne(V-T, V-E, P, H) :- v(V), \\+v(T), e(T,E,P,H).\ne(S*T, E*T, P, H) :- \\+v(S), e(S,E,P,H).\ne(V*T, V*E, P, H) :- v(V), \\+v(T), e(T,E,P,H).\ne(S/T, E/T, P, H) :- \\+v(S), e(S,E,P,H).\ne(V/T, V/E, P, H) :- v(V), \\+v(T), e(T,E,P,H).\ne(T, H, T, H).\n\ne(T1, T1_, T2, T2_), T1\\=T2, T2 ---> T2_\n--%------------------------------------ (E-EvalContext)\nT1 ---> T1_.\n\ninteger(V1), integer(V2), V is V1 + V2\n--%------------------------------------ (E-Plus3)\nV1 + V2 ---> V.\n\ninteger(V1), integer(V2), V is V1 - V2\n--%------------------------------------ (E-Minus3)\nV1 - V2 ---> V.\n\ninteger(V1), integer(V2), V is V1 * V2\n--%------------------------------------ (E-Times3)\nV1 * V2 ---> V.\n\ninteger(V1), integer(V2), V is V1 div V2\n--%------------------------------------ (E-Div3)\nV1 / V2 ---> V.\n\nA ---> A :- integer(A).               % (E-Int)\n\nA -->> A_ :- \\+v(A), A ---> B, !, B -->> A_.\nA -->> A.\n\n:- 10 ---> R, writeln(R).\n:- 10 + 20 ---> R1, writeln(R1).\n:- 10 - 20 ---> R2, writeln(R2).\n:- 10 * 20 ---> R3, writeln(R3).\n:- 1*2+3/4 -->> R4, writeln(R4).\n:- halt.\n```\n\nProlog\u3067\u3082\u8a55\u4fa1\u6587\u8108\u3092\u7528\u3044\u305f\u307b\u3046\u304c\u77ed\u304f\u8a18\u8ff0\u3067\u304d\u307e\u3057\u305f\u3002\n\u51e6\u7406\u306f\u9045\u304f\u306a\u308a\u307e\u3059\u304c[]\u3092\u7a74\u3068\u3057\u3066\u8a18\u8ff0\u3059\u308c\u3070\u3001\u7406\u89e3\u3057\u3084\u3059\u3044\u304b\u3082\u3057\u308c\u307e\u305b\u3093:\n\n```\ne(S+T, E+T, P) :- \\+v(S), e(S, E, P).\ne(V+T, V+E, P) :- v(V), \\+v(T), e(T, E, P).\ne(S-T, E-T, P) :- \\+v(S), e(S, E, P).\ne(V-T, V-E, P) :- v(V), \\+v(T), e(T, E, P).\ne(S*T, E*T, P) :- \\+v(S), e(S, E, P).\ne(V*T, V*E, P) :- v(V), \\+v(T), e(T, E, P).\ne(S/T, E/T, P) :- \\+v(S), e(S, E, P).\ne(V/T, V/E, P) :- v(V), \\+v(T), e(T, E, P).\ne(T, [], T).\n\ne(S, E, T), S\\=T, T ---> T_, subst([], T_, E, S_)\n--%------------------------------------ (E-EvalContext)\nS ---> S_.\n```\n\ne/3\u306f\u9805\u3001\u8a55\u4fa1\u6587\u8108\u3001\u8a55\u4fa1\u6587\u8108\u306e\u7a74\u306b\u30de\u30c3\u30c1\u3057\u305f\u9805\u3092\u5909\u6570\u3068\u3057\u3066\u53d7\u3051\u53d6\u308b\u8ff0\u8a9e\u3067\u3059\u3002\u7a74\u306f[]\u3068\u8868\u3059\u305f\u3081\u3001\u7a74\u3092\u8868\u3059\u5909\u6570\u306f\u8fd4\u5374\u3057\u307e\u305b\u3093\u3002\n\u7a74\u3092\u9805\u3067\u57cb\u3081\u308b\u306b\u306fsubst\u3092\u4f7f\u3063\u3066\u7f6e\u304d\u63db\u3048\u307e\u3059\u3002[]\u3092\u4ed6\u306b\u7528\u3044\u308b\u3053\u3068\u306b\u306a\u3063\u305f\u5834\u5408\u306b\u5bfe\u51e6\u3067\u304d\u306a\u304f\u306a\u308b\u554f\u984c\u306f\u3042\u308b\u3067\u3057\u3087\u3046\u3002\n\n# \u5358\u76f8\u578b\u63a8\u8ad6\n\n```prolog:typeof.pl\n:- op(1000,yfx,$).\ntype_of(_,I,int) :- integer(I).\ntype_of(C,X,T) :- var(X), member(Y:T,C),X==Y.\ntype_of(C,E1+E2,int) :- type_of(C,E1,int),type_of(C,E2,int).\ntype_of(C,X->E,T->T2) :- type_of([X:T|C],E,T2).\ntype_of(C,E1 $ E2, T) :- type_of(C,E1,T2->T),type_of(C,E2,T2).\n\n:- type_of([], 1+1,T),writeln(T).\n:- type_of([], (X->(X+1)),T),writeln(T).\n:- type_of([], Y->(X->(X+Y)),T),writeln(T).\n:- type_of([], (X->(X+1))$(1+1),T),writeln(T).\n:- halt.\n```\n\n\u3068\u66f8\u3051\u307e\u3059\u3002Prolog\u306f\u52d5\u7684\u578b\u4ed8\u3051\u306e\u8a00\u8a9e\u3068\u8a00\u3048\u308b\u3068\u601d\u3044\u307e\u3059\u304c\u3001\u306a\u306b\u3082\u306a\u3044\u4e16\u754c\u306b\u9759\u7684\u578b\u3092\u4f5c\u308b\u5834\u5408\u306b\u306f\u578b\u304c\u306a\u3044\u8a00\u8a9e\u3067\u66f8\u304f\u307b\u3046\u304c\u308f\u304b\u308a\u3084\u3059\u3044\u5834\u5408\u3082\u3042\u308b\u3067\u3057\u3087\u3046\u3002\u30b7\u30fc\u30af\u30a8\u30f3\u30c8\u8a08\u7b97\u306b\u4f3c\u305b\u305f\u8a18\u8ff0\u3084\u3001\u56f3\u3092\u66f8\u3044\u3066\u307f\u308b\u3068\u3088\u308a\u7406\u89e3\u304c\u9032\u3080\u3068\u601d\u3044\u307e\u3059\u306e\u3067\u6311\u6226\u3057\u3066\u307f\u3066\u304f\u3060\u3055\u3044\u3002\n\n# \u591a\u76f8\u578b\u63a8\u8ad6\n\n\u591a\u76f8\u306e\u578b\u63a8\u8ad6\u3082\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u8a18\u8ff0\u53ef\u80fd\u3067\u3059\u3002\n\n```\n:- set_prolog_flag(occurs_check,true).\n:- op(500,xfy,$).\n\ntype(_, I, int) :- integer(I).\ntype(\u0393, E1+E2, int) :- type(\u0393, E1, int), type(\u0393, E2, int).\ntype(\u0393, X, T1) :- atom(X), member(X:T, \u0393), instantiate(T, T1).\ntype(\u0393, X -> E, T1 -> T2) :- type([X:mono(T1)|\u0393], E, T2).\ntype(\u0393, X $ Y, B) :- type(\u0393,X,A -> B), type(\u0393,Y,A).                               \ntype(\u0393, let(X = E0, E1), T) :- type(\u0393, E0, A), type([X:poly(\u0393,A) | \u0393], E1, T).\n \ninstantiate(poly(\u0393,T),T1) :- copy_term((\u0393,T),(\u0393,T1)).                         \ninstantiate(mono(T),T).\n \nrun(\u0393,E) :- type(\u0393,E,T), writeln(E : T).\n \n:-run([],x->x).\n:-run([],x->x+1).\n:-run([],x->y->(y$x)).\n:-run([],let(id=(x->x),id$id)).\n:-run([],let(id=(x->x),(id$(x->x+1))$(id $ 10))).\n:- halt.\n```\n\n\u5177\u4f53\u5316\u3059\u308b\u969b\u306b\u30b3\u30f3\u30c6\u30ad\u30b9\u30c8\u3068\u578b\u3092\u5408\u308f\u305b\u305f\u4e2d\u3067\u5909\u6570\u306f\u5225\u306a\u3082\u306e\u306b\u66f8\u304d\u63db\u3048\u308b\u3053\u3068\u3067\u5177\u4f53\u5316\u304c\u53ef\u80fd\u306b\u306a\u308a\u307e\u3059\u3002type_of\u3067\u306f\u306a\u304ftype\u3068\u66f8\u3044\u3066\u3042\u3063\u305f\u308a\u3001\u8868\u8a18\u306e\u4e71\u308c\u304c\u3042\u308a\u307e\u3059\u304c\u3001\u69d8\u3005\u306a\u8ad6\u6587\u3067\u3082\u540c\u69d8\u306e\u8868\u8a18\u306e\u9055\u3044\u304c\u3042\u308b\u306e\u3067\u3069\u3046\u66f8\u3044\u3066\u3082\u52d5\u304f\u3068\u3044\u3046\u3053\u3068\u3092\u7406\u89e3\u3059\u308b\u3068\u3001\u5e45\u304c\u5e83\u304c\u308b\u306e\u3067\u306f\u306a\u3044\u304b\u3068\u601d\u3044\u307e\u3059\u3002\n\n# \u90e8\u5206\u578b\u4ed8\u3051\u3068\u30a2\u30eb\u30b4\u30ea\u30ba\u30df\u30c3\u30af\u306a\u90e8\u5206\u578b\u4ed8\u3051\n\n\u90e8\u5206\u578b\u4ed8\u3051\u306e\u898f\u5247\u306f\u69cb\u6587\u4e3b\u5c0e\u306e\u898f\u5247\u3067\u306f\u306a\u304f\u3001\u6df1\u3055\u512a\u5148\u63a2\u7d22\u3092\u8a55\u4fa1\u6226\u7565\u3068\u3057\u3066\u7528\u3044\u308bProlog\u3067\u5b9f\u884c\u3059\u308b\u3068\u7121\u9650\u30eb\u30fc\u30d7\u306b\u9665\u308a\u307e\u3059\u3002Prolog\u3067\u52d5\u4f5c\u3055\u305b\u308b\u306b\u306f\u30a2\u30eb\u30b4\u30ea\u30ba\u30df\u30c3\u30af\u306a\u898f\u5247\u306b\u66f8\u304d\u63db\u3048\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\u30ab\u30a4\u30f3\u30c9\u3092\u6c42\u3081\u308b\u5834\u5408\u306f\u66f4\u306b\u4e8b\u60c5\u304c\u60aa\u304f\u306a\u308a\u3001\u7c21\u5358\u306a\u898f\u5247\u3060\u3051\u3067\u306f\u5bfe\u51e6\u3067\u304d\u306a\u304f\u306a\u308b\u3088\u3046\u3067\u3059\u3002\u69cb\u6587\u4e3b\u5c0e\u3067\u306f\u306a\u3044\u63a8\u8ad6\u898f\u5247\u3092\u7528\u3044\u3066\u8a3c\u660e\u3092\u884c\u3046\u3053\u3068\u306f\u53ef\u80fd\u306a\u306e\u3067\u3001\u30a2\u30eb\u30b4\u30ea\u30ba\u30df\u30c3\u30af\u3067\u306f\u306a\u3044\u898f\u5247\u306b\u3082\u610f\u5473\u306f\u3042\u308b\u306e\u3067\u3059\u3002\n\n```prolog:rcdsub.pl\n:- op(910, xfx, [ \u22a2 ]).\n:- op(901, xfx, [\u2208]).\n%:- op(900, xfx, [ : ]).\n:- op(501, xfx, <:).\n:- op(500, yfx, $).\n:- op(11, yfx, .>).\n:- op(1200, xfx, [ -- ]).\nterm_expansion(A -- B, B :- A).\n\nmaptpl(F,(A,B)) :- call(F,A), maptpl(F,B).\nmaptpl(F,A) :- call(F,A).\nmaprcd(F,{T}) :- maptpl(F,T).\nmaptpl(F,(A,B),(A_,B_)) :- call(F,A,A_), maptpl(F,B,B_).\nmaptpl(F,A,A_) :- call(F,A,A_).\nmaprcd(F,{T},{T_}) :- maptpl(F,T,T_).\nmembertpl(X,(X,_)).\nmembertpl(X,(_,B)) :- membertpl(X,B).\nmembertpl(X,X).\nmemberrcd(X,{T}) :- membertpl(X,T).\n\nisVal(_ -> _).\nisVal(V) :- isRcdVal(V).\nisRcdVal(T) :- maprcd(isRcdVal1, T).\nisRcdVal1(L=T) :- atom(L), isVal(T).\n\nT <: T.\n_ <: top.\nbot <: _.\n(S1->S2) <: (T1->T2) :- S1 <: T1, S2 <: T2.\nS <: T :- maprcd(subtypercd1(S), T).\nsubtypercd1(S, (Li:Ti)) :- memberrcd(Li:Si,S), Si <: Ti.\n\nX \u2208 (_,X).\nX \u2208 (\u0393,_) :- X \u2208 \u0393.\n\nX : T \u2208 \u0393\n--%-------------------------------------- (TA-Var)\n\u0393 \u22a2 (X : T).\n\n(\u0393, X : T1) \u22a2 E2 : T2\n--%-------------------------------------- (TA-Abs)\n\u0393 \u22a2 ((X : T1) -> E2) : (T1 -> T2).\n\n\u0393 \u22a2 E1 : bot, \u0393 \u22a2 E2 : _\n--%-------------------------------------- (TA-AppBot)\n\u0393 \u22a2 E1 $ E2 : bot.\n\n\u0393 \u22a2 E1 : (T11 -> T12),\n\u0393 \u22a2 E2 : T2, T2 <: T11\n--%-------------------------------------- (TA-App)\n\u0393 \u22a2 E1 $ E2 : T12.\n\n\u0393 \u22a2 E1 : R1, memberrcd(Li:Ti,R1)\n--%-------------------------------------- (TA-Proj)\n\u0393 \u22a2 E1.>Li : Ti.\n\nmaprcd(taRcd1(\u0393),E1,T1)\n--%-------------------------------------- (TA-Rcd)\n\u0393 \u22a2 E1 : T1.\n\ntaRcd1(\u0393,Li=Ei,Li:Ti) :- \u0393 \u22a2 Ei : Ti.\ntypeof(E1:T1) :- [] \u22a2 E1 : T1.\n% test sub\n:- {a:bot,b:top,c:top} <: {b:top,a:bot}.\n:- {a:bot,b:top} <: {b:top,a:bot}.\n:- \\+ ({a:bot} <: {b:top,a:bot}).\n:- \\+ ({a:bot,b:top} <: {b:top,a:bot,c:top}).\n\n% test mapRcd\n:- V=((x:top)-> x), maprcd(writeln,{a=V,b=V,c=V}).\n\n% test isValRcd\n:- \\+ isRcdVal({}).\n:- \\+ isRcdVal(1).\n:- V=((x:top)-> x),isRcdVal({a=V,b=V}).\n:- V=((x:top)-> x),isRcdVal({a=V,b=V,c=V}).\n\n% test typeof\n:- typeof(((x:top)-> x):T),writeln(T),!,T=(top->top).\n:- typeof(((x:top)-> x)$((x:top)-> x):T2),writeln(T2).\n:- typeof(((x:(top->top))-> x) $ ((x:top)-> x):T3),writeln(T3).\n:- typeof((((r:{x:(top->top)})-> r.>x $ r.>x)):T4a),writeln(T4a).\n:- typeof({x=((z:top)->z)}:TT),writeln(TT).\n:- typeof((((r:{x:(top->top)})-> (r.>x $ r.>x)) $ {x=((z:top)->z), y=((z:top)->z)}):T4),writeln(T4).\n:- typeof(((x:bot)-> x):T5),writeln(T5),!,T5=(bot->bot).\n:- typeof(((x:bot)-> (x $ x)):T6),writeln(T6),!,T6=(bot->bot).\n\n:- halt.\n```\n\n# \u307e\u3068\u3081\n\n\u69d8\u3005\u306a\u4f8b\u3067\u3001\u63a8\u8ad6\u898f\u5247\u3092Prolog\u306b\u66f8\u304d\u63db\u3048\u3066\u307f\u307e\u3057\u305f\u3002\n\u3059\u3079\u3066\u306e\u30b7\u30fc\u30af\u30a8\u30f3\u30c8\u8a08\u7b97\u306e\u63a8\u8ad6\u898f\u5247\u3092Prolog\u306b\u3059\u3050\u306b\u66f8\u304d\u63db\u3048\u308b\u3053\u3068\u306f\u51fa\u6765\u308b\u308f\u3051\u3067\u306f\u3042\u308a\u307e\u305b\u3093\u3002\u3057\u304b\u3057\u306a\u304c\u3089\u3001\u591a\u304f\u306e\u5834\u5408\u306b\u7d20\u76f4\u306bProlog\u306b\u66f8\u304d\u63db\u3048\u308b\u3053\u3068\u304c\u53ef\u80fd\u3067\u3059\u3002Prolog\u306b\u66f8\u304d\u63db\u3048\u51fa\u6765\u306a\u3044\u3088\u3046\u306a\u5834\u5408\u306f\u69cb\u6587\u4e3b\u5c0e\u306e\u898f\u5247\u3067\u306f\u306a\u3044\u306e\u3067\u30a2\u30eb\u30b4\u30ea\u30ba\u30df\u30c3\u30af\u306a\u898f\u5247\u306b\u66f8\u304d\u63db\u3048\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\nProlog\u3067\u7d20\u76f4\u306b\u66f8\u304f\u3053\u3068\u304c\u3067\u304d\u308b\u63a8\u8ad6\u898f\u5247\u3067\u3042\u308c\u3070\u3001\u8ad6\u7406\u578b\u8a00\u8a9e\u3088\u308a\u4f4e\u7d1a\u306a\u8a00\u8a9e\u306b\u66f8\u304d\u63db\u3048\u9ad8\u901f\u5316\u3059\u308b\u3053\u3068\u3082\u5bb9\u6613\u3068\u306a\u308b\u3067\u3057\u3087\u3046\u3002Prolog\u306f\u8ad6\u7406\u578b\u8a00\u8a9e\u306e\u6bb5\u968e\u3067\u5b9f\u88c5\u4e0a\u306e\u554f\u984c\u3092\u89e3\u6c7a\u3059\u308b\u3053\u3068\u304c\u51fa\u6765\u307e\u3059\u3002\u662f\u975e\u7686\u3055\u3093\u3082\u6311\u6226\u3057\u3066\u307f\u3066\u304f\u3060\u3055\u3044\u3002\n\n# \u53c2\u8003\u6587\u732e\n\nTIPER Type Inference Prototyping Engines from Relational Specifications of type systems http://kyagrd.github.io/tiper/\n\nCoPL\n\nTAPL\n\nThe Essence of Dependent Object Types\n\nCOMFRK vol.1 Prolog \u3067 Scheme \u306e\u64cd\u4f5c\u7684\u610f\u5473\u8ad6\u3092\u5b9f\u88c5 zick\nhttp://comfrk.info/arch/vol1.pdf\n", "tags": ["Prolog", "\u64cd\u4f5c\u7684\u610f\u5473\u8ad6"]}