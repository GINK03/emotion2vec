{"tags": ["R", "PRML"], "context": " More than 1 year has passed since last update.PRML 2.3.5\u306b\u8a18\u8f09\u306e\u901a\u308a\u3001\u30ac\u30a6\u30b9\u5206\u5e03\u306e\u5e73\u5747\u30d1\u30e9\u30e1\u30fc\u30bfu\u306e\u6700\u5c24\u63a8\u5b9a\u306b\u95a2\u3057\u3066\u3001\u5bfe\u6570\u5c24\u5ea6\u306e\u5fae\u5206\u304c0\u3068\u306a\u308bu\u3092\u6c42\u3081\u308b\u554f\u984c\u3092\u3001\u78ba\u7387\u5909\u6570u\u304c\u4e0e\u3048\u3089\u308c\u305f\u6642\u306e\u78ba\u7387\u5909\u6570z=-d/du [ln p(x|u,\u03c3^2)]\u306e\u6761\u4ef6\u4ed8\u304d\u671f\u5f85\u5024E[z|u]\u304c0\u3068\u306a\u308bu\u3092\u6c42\u3081\u308b\u554f\u984c\u306b\u5e30\u7740\u3057\u3001Robbins-Monro\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u306b\u3088\u308a\u3001x\u306e\u89b3\u6e2c\uff08\u3059\u306a\u308f\u3061z\u306e\u89b3\u6e2c\uff09\u6bce\u306b\u3001\u305d\u306e\u3088\u3046\u306au\u3092\u9010\u6b21\u7684\u306b\u6c42\u3081\u307e\u3059\u3002\n\u30b5\u30f3\u30d7\u30eb\u306f\u30ac\u30a6\u30b9\u5206\u5e03\u304b\u3089\u751f\u6210\u3057\u3001\u89b3\u6e2c\u3057\u305f\u70b9\u3092\u9ed2\u70b9\u3001\u9010\u6b21\u63a8\u5b9a\u3057\u305f\u30d1\u30e9\u30e1\u30fc\u30bfu\u3092\u8d64\u70b9\u3067\u793a\u3057\u307e\u3059\u3002\n\nframe()\nset.seed(0)\npar(mfrow=c(1, 1))\npar(mar=c(2.3, 2.5, 1, 0.1))\npar(mgp=c(1.3, .5, 0))\nN <- 40\nU <- 150\nx <- rnorm(N, U, 10)\numl <- 0\numls <- numeric()\nd <- data.frame(observation=-1, x=NA, new=F)\nfor (n in 1:N) {\n    uml <- uml + (1 / n) * (x[n] - uml)\n    umls <- c(umls, uml)\n    if (n > 1) {\n        previous <- d[d$observation == n - 1, ]\n        previous$observation = n\n        previous$new = F\n        d <- rbind(d, previous)\n    }\n    d <- rbind(d, c(n, x[n], T))\n}\nd <- d[-1, ]\nplot(umls, type=\"o\", col=2, xlim=c(1,N), ylim=c(min(x), max(x)), xlab=\"\", ylab=\"\")\npar(new=T)\nplot(d$observation, d$x, pch=19, cex=ifelse(d$new, 1, 0.1), xlim=c(1,N), ylim=c(min(x), max(x)))\nabline(h=U)\n\nPRML 2.3.5\u306b\u8a18\u8f09\u306e\u901a\u308a\u3001\u30ac\u30a6\u30b9\u5206\u5e03\u306e\u5e73\u5747\u30d1\u30e9\u30e1\u30fc\u30bfu\u306e\u6700\u5c24\u63a8\u5b9a\u306b\u95a2\u3057\u3066\u3001\u5bfe\u6570\u5c24\u5ea6\u306e\u5fae\u5206\u304c0\u3068\u306a\u308bu\u3092\u6c42\u3081\u308b\u554f\u984c\u3092\u3001\u78ba\u7387\u5909\u6570u\u304c\u4e0e\u3048\u3089\u308c\u305f\u6642\u306e\u78ba\u7387\u5909\u6570z=-d/du [ln p(x|u,\u03c3^2)]\u306e\u6761\u4ef6\u4ed8\u304d\u671f\u5f85\u5024E[z|u]\u304c0\u3068\u306a\u308bu\u3092\u6c42\u3081\u308b\u554f\u984c\u306b\u5e30\u7740\u3057\u3001Robbins-Monro\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u306b\u3088\u308a\u3001x\u306e\u89b3\u6e2c\uff08\u3059\u306a\u308f\u3061z\u306e\u89b3\u6e2c\uff09\u6bce\u306b\u3001\u305d\u306e\u3088\u3046\u306au\u3092\u9010\u6b21\u7684\u306b\u6c42\u3081\u307e\u3059\u3002\n\n\u30b5\u30f3\u30d7\u30eb\u306f\u30ac\u30a6\u30b9\u5206\u5e03\u304b\u3089\u751f\u6210\u3057\u3001\u89b3\u6e2c\u3057\u305f\u70b9\u3092\u9ed2\u70b9\u3001\u9010\u6b21\u63a8\u5b9a\u3057\u305f\u30d1\u30e9\u30e1\u30fc\u30bfu\u3092\u8d64\u70b9\u3067\u793a\u3057\u307e\u3059\u3002\n\n![](https://dl.dropbox.com/sh/cwfemibvr7gk4cy/IQesVodEnu/24.RobbinsMonro.png)\n\n```r\nframe()\nset.seed(0)\npar(mfrow=c(1, 1))\npar(mar=c(2.3, 2.5, 1, 0.1))\npar(mgp=c(1.3, .5, 0))\nN <- 40\nU <- 150\nx <- rnorm(N, U, 10)\numl <- 0\numls <- numeric()\nd <- data.frame(observation=-1, x=NA, new=F)\nfor (n in 1:N) {\n\tuml <- uml + (1 / n) * (x[n] - uml)\n\tumls <- c(umls, uml)\n\tif (n > 1) {\n\t\tprevious <- d[d$observation == n - 1, ]\n\t\tprevious$observation = n\n\t\tprevious$new = F\n\t\td <- rbind(d, previous)\n\t}\n\td <- rbind(d, c(n, x[n], T))\n}\nd <- d[-1, ]\nplot(umls, type=\"o\", col=2, xlim=c(1,N), ylim=c(min(x), max(x)), xlab=\"\", ylab=\"\")\npar(new=T)\nplot(d$observation, d$x, pch=19, cex=ifelse(d$new, 1, 0.1), xlim=c(1,N), ylim=c(min(x), max(x)))\nabline(h=U)\n```\n"}