{"context": " More than 1 year has passed since last update.\u6642\u7cfb\u5217\u30c7\u30fc\u30bf\u306e\u89e3\u6790\u3092\u4e8c\u3064\u306e\u30c7\u30fc\u30bf\u306b\u5bfe\u3057\u3066\u5b9f\u65bd\u3057\u307e\u3059\u3002\n\u57fa\u672c\u7684\u306b\u306f\u3001RawData\u306e\u78ba\u8a8d\u3001\u30c8\u30ec\u30f3\u30c9\u3068\u5b63\u7bc0\u6027\u306e\u6392\u9664\u3001\u30e2\u30c7\u30eb\u306e\u30d5\u30a3\u30c3\u30c6\u30a3\u30f3\u30b0\u306e\u9806\u306b\u3084\u3063\u3066\u3044\u304d\u307e\u3059\u3002\n\n\u30c7\u30fc\u30bf\u2460simulated data\nR\u3067\u751f\u6210\u3057\u305f\u30c7\u30fc\u30bf\u306b\u3064\u3044\u3066\u5206\u6790\u3057\u3066\u307f\u307e\u3059\u3002\n\u30c7\u30fc\u30bf\u3092\u4f5c\u6210\u3059\u308b\u30b3\u30fc\u30c9\u306f\u4e0b\u8a18\u3002\n\u30c7\u30fc\u30bf\u306e\u30d7\u30ed\u30c3\u30c8\u3068\u3001\u81ea\u5df1\u76f8\u95a2\u95a2\u6570\u3092\u4f75\u305b\u3066\u51fa\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n#### Generate time seriese data with a linear trend\n>time <- 1:200\n>data.ar <- arima.sim(model=list(ar=c(0.6, 0.3)), n=200, sd=1)\n>data <- data.ar + 30 + 0.05 * time\n>par(mfrow=c(2,1))\n>plot(time, data, type=\"l\", main=\"Raw data plot\")\n>acf(data, main=\"Sample autocorrelation function\")\n```r\n\n\u51fa\u3066\u304f\u308b\u30c7\u30fc\u30bf\u306f\u3053\u3093\u306a\u611f\u3058\u3067\u3059\u3002\n\u30b0\u30e9\u30d5\u3068\u30b3\u30ec\u30ed\u30b0\u30e9\u30e0(Correlogram)\u304b\u3089\u7dda\u5f62\u30c8\u30ec\u30f3\u30c9\u304c\u3042\u308a\u305d\u3046\u306a\u306e\u3067\u3001\u3053\u3044\u3064\u3092\u53d6\u308a\u9664\u304d\u307e\u3059\u3002\n![Screen Shot 2016-02-17 at 14.16.34.png](https://qiita-image-store.s3.amazonaws.com/0/62779/c3f544dd-c86a-bb59-a6ce-af378a0fecc1.png)\n\n\n\n```r\n## Remove the trend\n>linear.model <- lm(data~time)\n>summary(linear.model)\n\nCall:\nlm(formula = data ~ time)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-3.7143 -1.0238 -0.0246  1.0379  3.7570 \n\nCoefficients:\n             Estimate Std. Error t value Pr(>|t|)    \n(Intercept) 27.098000   0.207381   130.7   <2e-16 ***\ntime         0.065674   0.001789    36.7   <2e-16 ***\n\n>residual.series <- data - linear.model$fitted.values\n>par(mfrow=c(3,1))\n>plot(residual.series, main=\"Residual series\")\n>acf(residual.series, main=\"ACF of Residual series\")\n>pacf(residual.series, main=\"PACF of Residual series\")\n\n\n\u6642\u7cfb\u5217\u30d7\u30ed\u30c3\u30c8\u304b\u3089\u5b9a\u5e38\u6027\u304c\u78ba\u8a8d\u3067\u304d\u504f\u81ea\u5df1\u76f8\u95a2\u304b\u3089\u3001AR(2)\u304c\u59a5\u5f53\u306a\u30aa\u30fc\u30c0\u30fc\u3060\u3068\u5224\u65ad\u51fa\u6765\u307e\u3059\u306e\u3067\u3001\u65e9\u901f\u30e2\u30c7\u30eb\u5316\u3002\n## Fit an AR(2) model to the data\nmodel.ar <- arima(residual.series, order=c(2,0,0))\n\npar(mfrow=c(3,1))\nplot(model.ar$residuals, main=\"Residual series\")\nacf(model.ar$residuals, main=\"ACF of Residual series\")\npacf(model.ar$residuals, main=\"PACF of Residual series\")\n\nARIMA()\u95a2\u6570\u306f\u6b8b\u5dee\u3092\u30d7\u30ed\u30c3\u30c8\u3057\u3066\u304f\u308c\u307e\u3059\u3002\n\u30d7\u30ed\u30c3\u30c8\u3092\u898b\u308b\u9650\u308a\u3001\u6b8b\u5dee\u306b\u76f8\u95a2\u306f\u306a\u3055\u305d\u3046\u306a\u306e\u3067\u30e2\u30c7\u30eb\u304c\u59a5\u5f53\u3060\u3063\u305f\u3068\u3044\u3046\u3053\u3068\u3067\u3057\u3087\u3046\u3002\n\n\n\u30c7\u30fc\u30bf\u2461Temperature Data\n\u6e56\u306e\u6e29\u5ea6\u3092\u6e2c\u3063\u305f\u30c7\u30fc\u30bf\u3092\u4f7f\u3063\u3066\u306e\u6642\u7cfb\u5217\u5206\u6790\u3067\u3059\u3002\n\u30c7\u30fc\u30bf\u306f\u79c1\u306eGitHub\u306b\u7f6e\u3044\u3066\u3042\u308a\u307e\u3059\u3002\nGitHub:\n[https://github.com/tkazusa/Sample_code/tree/master/Data]\n> #Data import\n> tempeature <- read.csv(\"temperature.csv\", header=TRUE)\n> t <- 1:nrow(tempeature)\n> x <- tempeature$Temperature\n> par(mfrow=c(2,1))\n> plot(t,x, type=\"l\", main=\"Raw data plot\")\n> acf(x,main=\"Temperature data ACF\")\n\n\n\u56f3\u304b\u3089\u3001\u5148\u307b\u3069\u306e\u4f8b\u3068\u306f\u7570\u306a\u308a\u5b63\u7bc0\u6027\u304c\u51fa\u3066\u3044\u308b\u3053\u3068\u304c\u308f\u304b\u308a\u307e\u3059\u3002\n\u3053\u306e\u5b63\u7bc0\u6027\u3092\u53d6\u308a\u9664\u304f\u305f\u3081\u306b\u3001\u4e0b\u8a18\u306e\u30e2\u30c7\u30eb\u3092\u4f7f\u3044\u307e\u3059\u3002\n[tex:\ns_t = \\beta_0 + \\beta_1 sin(\\frac{2 \\pi t}{12}) + \\beta_2 cos(\\frac{2 \\pi t}{12})\n]\n> model.season <- lm(x~sin(2*pi*t/365) + cos(2*pi*t/365))\n> summary(model.season)\n\nCall:\nlm(formula = x ~ sin(2 * pi * t/365) + cos(2 * pi * t/365))\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-10.3755  -2.1802  -0.0533   2.4349   9.0749 \n\nCoefficients:\n                    Estimate Std. Error t value Pr(>|t|)    \n(Intercept)           6.4263     0.1029   62.47   <2e-16 ***\nsin(2 * pi * t/365)  -2.5477     0.1455  -17.51   <2e-16 ***\ncos(2 * pi * t/365)  -3.7933     0.1455  -26.07   <2e-16 ***\n---\nSignif. codes:  0 \u2018***\u2019 0.001 \u2018**\u2019 0.01 \u2018*\u2019 0.05 \u2018.\u2019 0.1 \u2018 \u2019 1\n\nResidual standard error: 3.404 on 1092 degrees of freedom\nMultiple R-squared:  0.4746,    Adjusted R-squared:  0.4736 \nF-statistic: 493.2 on 2 and 1092 DF,  p-value: < 2.2e-16\n\n> residual.series <- x - model.season$fitted.values\n> par(mfrow=c(3,1))\n> plot(residual.series, main=\"Residual series\", type=\"l\")\n> acf(residual.series, main=\"ACF of Residual series\")\n> pacf(residual.series, main=\"PACF of Residual series\")\n\n\n\u30d7\u30ed\u30c3\u30c8\u304b\u3089Residual\u30c7\u30fc\u30bf\u306f\u5b9a\u5e38\u6027\u304c\u3042\u308a\u3001PACF\u304b\u3089AR(1)\u30e2\u30c7\u30eb\u304c\u59a5\u5f53\u3060\u3068\u5224\u65ad\u3067\u304d\u307e\u3059\u306e\u3067\u3001\u30e2\u30c7\u30eb\u5316\u3057\u307e\u3059\u3002\n\n>## Fit an AR(1) model\n> model.ar <- arima(residual.series, order=c(1,0,0))\n> model.ar\n\nCall:\narima(x = residual.series, order = c(1, 0, 0))\n\nCoefficients:\n         ar1  intercept\n      0.4861     0.0026\ns.e.  0.0264     0.1746\n\nsigma^2 estimated as 8.829:  log likelihood = -2746.36,  aic = 5498.72\n> par(mfrow=c(3,1))\n> plot(model.ar$residuals, main=\"Residual series\")\n> acf(model.ar$residuals, main=\"ACF of Residual series\")\n> pacf(model.ar$residuals, main=\"PACF of Residual series\")\n\n\n\u6b8b\u5dee\u30d7\u30ed\u30c3\u30c8\u3084PACF\u3088\u308a\u7dba\u9e97\u306b\u30e2\u30c7\u30eb\u5316\u3067\u304d\u3066\u3044\u308b\u3068\u5224\u65ad\u3067\u304d\u307e\u3059\u3002\n\u6642\u7cfb\u5217\u30c7\u30fc\u30bf\u306e\u89e3\u6790\u3092\u4e8c\u3064\u306e\u30c7\u30fc\u30bf\u306b\u5bfe\u3057\u3066\u5b9f\u65bd\u3057\u307e\u3059\u3002\n\u57fa\u672c\u7684\u306b\u306f\u3001RawData\u306e\u78ba\u8a8d\u3001\u30c8\u30ec\u30f3\u30c9\u3068\u5b63\u7bc0\u6027\u306e\u6392\u9664\u3001\u30e2\u30c7\u30eb\u306e\u30d5\u30a3\u30c3\u30c6\u30a3\u30f3\u30b0\u306e\u9806\u306b\u3084\u3063\u3066\u3044\u304d\u307e\u3059\u3002\n\n##\u30c7\u30fc\u30bf\u2460simulated data\nR\u3067\u751f\u6210\u3057\u305f\u30c7\u30fc\u30bf\u306b\u3064\u3044\u3066\u5206\u6790\u3057\u3066\u307f\u307e\u3059\u3002\n\u30c7\u30fc\u30bf\u3092\u4f5c\u6210\u3059\u308b\u30b3\u30fc\u30c9\u306f\u4e0b\u8a18\u3002\n\u30c7\u30fc\u30bf\u306e\u30d7\u30ed\u30c3\u30c8\u3068\u3001\u81ea\u5df1\u76f8\u95a2\u95a2\u6570\u3092\u4f75\u305b\u3066\u51fa\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n\n```r\n#### Generate time seriese data with a linear trend\n>time <- 1:200\n>data.ar <- arima.sim(model=list(ar=c(0.6, 0.3)), n=200, sd=1)\n>data <- data.ar + 30 + 0.05 * time\n>par(mfrow=c(2,1))\n>plot(time, data, type=\"l\", main=\"Raw data plot\")\n>acf(data, main=\"Sample autocorrelation function\")\n```r\n\n\u51fa\u3066\u304f\u308b\u30c7\u30fc\u30bf\u306f\u3053\u3093\u306a\u611f\u3058\u3067\u3059\u3002\n\u30b0\u30e9\u30d5\u3068\u30b3\u30ec\u30ed\u30b0\u30e9\u30e0(Correlogram)\u304b\u3089\u7dda\u5f62\u30c8\u30ec\u30f3\u30c9\u304c\u3042\u308a\u305d\u3046\u306a\u306e\u3067\u3001\u3053\u3044\u3064\u3092\u53d6\u308a\u9664\u304d\u307e\u3059\u3002\n![Screen Shot 2016-02-17 at 14.16.34.png](https://qiita-image-store.s3.amazonaws.com/0/62779/c3f544dd-c86a-bb59-a6ce-af378a0fecc1.png)\n\n\n\n```r\n## Remove the trend\n>linear.model <- lm(data~time)\n>summary(linear.model)\n\nCall:\nlm(formula = data ~ time)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-3.7143 -1.0238 -0.0246  1.0379  3.7570 \n\nCoefficients:\n             Estimate Std. Error t value Pr(>|t|)    \n(Intercept) 27.098000   0.207381   130.7   <2e-16 ***\ntime         0.065674   0.001789    36.7   <2e-16 ***\n\n>residual.series <- data - linear.model$fitted.values\n>par(mfrow=c(3,1))\n>plot(residual.series, main=\"Residual series\")\n>acf(residual.series, main=\"ACF of Residual series\")\n>pacf(residual.series, main=\"PACF of Residual series\")\n```\n\n![Screen Shot 2016-02-17 at 14.26.46.png](https://qiita-image-store.s3.amazonaws.com/0/62779/dcb2f70d-241f-e9e8-ddf6-441bf7847db4.png)\n\n\n\u6642\u7cfb\u5217\u30d7\u30ed\u30c3\u30c8\u304b\u3089\u5b9a\u5e38\u6027\u304c\u78ba\u8a8d\u3067\u304d\u504f\u81ea\u5df1\u76f8\u95a2\u304b\u3089\u3001AR(2)\u304c\u59a5\u5f53\u306a\u30aa\u30fc\u30c0\u30fc\u3060\u3068\u5224\u65ad\u51fa\u6765\u307e\u3059\u306e\u3067\u3001\u65e9\u901f\u30e2\u30c7\u30eb\u5316\u3002\n\n```r\n## Fit an AR(2) model to the data\nmodel.ar <- arima(residual.series, order=c(2,0,0))\n\npar(mfrow=c(3,1))\nplot(model.ar$residuals, main=\"Residual series\")\nacf(model.ar$residuals, main=\"ACF of Residual series\")\npacf(model.ar$residuals, main=\"PACF of Residual series\")\n```\n\nARIMA()\u95a2\u6570\u306f\u6b8b\u5dee\u3092\u30d7\u30ed\u30c3\u30c8\u3057\u3066\u304f\u308c\u307e\u3059\u3002\n\u30d7\u30ed\u30c3\u30c8\u3092\u898b\u308b\u9650\u308a\u3001\u6b8b\u5dee\u306b\u76f8\u95a2\u306f\u306a\u3055\u305d\u3046\u306a\u306e\u3067\u30e2\u30c7\u30eb\u304c\u59a5\u5f53\u3060\u3063\u305f\u3068\u3044\u3046\u3053\u3068\u3067\u3057\u3087\u3046\u3002\n\n![Screen Shot 2016-02-17 at 14.36.55.png](https://qiita-image-store.s3.amazonaws.com/0/62779/ea17e761-7324-a8d9-d27e-fa6cdc18a455.png)\n\n\n##\u30c7\u30fc\u30bf\u2461Temperature Data\n\u6e56\u306e\u6e29\u5ea6\u3092\u6e2c\u3063\u305f\u30c7\u30fc\u30bf\u3092\u4f7f\u3063\u3066\u306e\u6642\u7cfb\u5217\u5206\u6790\u3067\u3059\u3002\n\u30c7\u30fc\u30bf\u306f\u79c1\u306eGitHub\u306b\u7f6e\u3044\u3066\u3042\u308a\u307e\u3059\u3002\nGitHub:\n[https://github.com/tkazusa/Sample_code/tree/master/Data]\n\n\n\n```r\n> #Data import\n> tempeature <- read.csv(\"temperature.csv\", header=TRUE)\n> t <- 1:nrow(tempeature)\n> x <- tempeature$Temperature\n> par(mfrow=c(2,1))\n> plot(t,x, type=\"l\", main=\"Raw data plot\")\n> acf(x,main=\"Temperature data ACF\")\n```\n\n![Screen Shot 2016-02-18 at 12.31.34.png](https://qiita-image-store.s3.amazonaws.com/0/62779/2ddceace-ace5-1f63-a077-ace09d45ba03.png)\n\n\u56f3\u304b\u3089\u3001\u5148\u307b\u3069\u306e\u4f8b\u3068\u306f\u7570\u306a\u308a\u5b63\u7bc0\u6027\u304c\u51fa\u3066\u3044\u308b\u3053\u3068\u304c\u308f\u304b\u308a\u307e\u3059\u3002\n\n\n\n\u3053\u306e\u5b63\u7bc0\u6027\u3092\u53d6\u308a\u9664\u304f\u305f\u3081\u306b\u3001\u4e0b\u8a18\u306e\u30e2\u30c7\u30eb\u3092\u4f7f\u3044\u307e\u3059\u3002\n[tex:\ns_t = \\beta_0 + \\beta_1 sin(\\frac{2 \\pi t}{12}) + \\beta_2 cos(\\frac{2 \\pi t}{12})\n]\n\n```r\n> model.season <- lm(x~sin(2*pi*t/365) + cos(2*pi*t/365))\n> summary(model.season)\n\nCall:\nlm(formula = x ~ sin(2 * pi * t/365) + cos(2 * pi * t/365))\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-10.3755  -2.1802  -0.0533   2.4349   9.0749 \n\nCoefficients:\n                    Estimate Std. Error t value Pr(>|t|)    \n(Intercept)           6.4263     0.1029   62.47   <2e-16 ***\nsin(2 * pi * t/365)  -2.5477     0.1455  -17.51   <2e-16 ***\ncos(2 * pi * t/365)  -3.7933     0.1455  -26.07   <2e-16 ***\n---\nSignif. codes:  0 \u2018***\u2019 0.001 \u2018**\u2019 0.01 \u2018*\u2019 0.05 \u2018.\u2019 0.1 \u2018 \u2019 1\n\nResidual standard error: 3.404 on 1092 degrees of freedom\nMultiple R-squared:  0.4746,\tAdjusted R-squared:  0.4736 \nF-statistic: 493.2 on 2 and 1092 DF,  p-value: < 2.2e-16\n\n> residual.series <- x - model.season$fitted.values\n> par(mfrow=c(3,1))\n> plot(residual.series, main=\"Residual series\", type=\"l\")\n> acf(residual.series, main=\"ACF of Residual series\")\n> pacf(residual.series, main=\"PACF of Residual series\")\n```\n\n![Screen Shot 2016-02-18 at 12.52.04.png](https://qiita-image-store.s3.amazonaws.com/0/62779/ec834bb4-47e0-368f-49e2-06574de333e7.png)\n\n\n\u30d7\u30ed\u30c3\u30c8\u304b\u3089Residual\u30c7\u30fc\u30bf\u306f\u5b9a\u5e38\u6027\u304c\u3042\u308a\u3001PACF\u304b\u3089AR(1)\u30e2\u30c7\u30eb\u304c\u59a5\u5f53\u3060\u3068\u5224\u65ad\u3067\u304d\u307e\u3059\u306e\u3067\u3001\u30e2\u30c7\u30eb\u5316\u3057\u307e\u3059\u3002\n\n```r\n\n>## Fit an AR(1) model\n> model.ar <- arima(residual.series, order=c(1,0,0))\n> model.ar\n\nCall:\narima(x = residual.series, order = c(1, 0, 0))\n\nCoefficients:\n         ar1  intercept\n      0.4861     0.0026\ns.e.  0.0264     0.1746\n\nsigma^2 estimated as 8.829:  log likelihood = -2746.36,  aic = 5498.72\n> par(mfrow=c(3,1))\n> plot(model.ar$residuals, main=\"Residual series\")\n> acf(model.ar$residuals, main=\"ACF of Residual series\")\n> pacf(model.ar$residuals, main=\"PACF of Residual series\")\n```\n\n![Screen Shot 2016-02-18 at 13.01.42.png](https://qiita-image-store.s3.amazonaws.com/0/62779/72eef40d-ee9d-7475-1ad7-a3fcc385d13a.png)\n\n\n\u6b8b\u5dee\u30d7\u30ed\u30c3\u30c8\u3084PACF\u3088\u308a\u7dba\u9e97\u306b\u30e2\u30c7\u30eb\u5316\u3067\u304d\u3066\u3044\u308b\u3068\u5224\u65ad\u3067\u304d\u307e\u3059\u3002\n\n", "tags": ["R", "\u7d71\u8a08\u5b66", "\u6642\u7cfb\u5217\u89e3\u6790"]}