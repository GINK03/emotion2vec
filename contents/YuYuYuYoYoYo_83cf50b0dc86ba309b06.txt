{"tags": ["three.js", "animation", "JavaScript"], "context": " More than 1 year has passed since last update.three.js\u3067\u7dda\u304c\u4f38\u3073\u3066\u304f\u30a2\u30cb\u30e1\u30fc\u30b7\u30e7\u30f3\u3092\u3064\u304f\u308b\u3068\u304d\u306b\u5c11\u3057\u30af\u30bb\u304c\u3042\u3063\u305f\u306e\u3067\u30e1\u30e2\u3002\n\u307e\u305a\u306f\u901a\u5e38\u306e\"\u4f38\u3073\u306a\u3044\"\u7dda\u306e\u63cf\u304d\u65b9\u3002\nvar scene, line;\n\nfunction drawNormalLine(){\n    var geometry = new THREE.Geometry();\n    geometry.vertices.push(new THREE.Vector3(-100,0,0));\n    geometry.vertices.push(new THREE.Vector3(100,0,0));\n    var material = new THREE.LineBasicMaterial({color: 0x00FFFF, linewidth: 2});\n    line = new THREE.Line(geometry, material);\n    scene.add(line);\n}\n\n\u3053\u308c\u3067\u3001\nline.geometry.vertices.push(new THREE.Vector3(200,0,0));\nline.geometry.verticesNeedUpdate = true;\n\n\u3068\u304b\u3001\u3084\u3063\u3066\u3044\u3051\u3070\u7dda\u304c\u4f38\u3073\u308b\u3093\u3060\u308d\u3046\u3068\u601d\u3063\u305f\u3089\u4f38\u3073\u306a\u3044\u3002\n\u89e3\u6c7a\u3059\u308b\u306b\u3042\u305f\u308a\u53c2\u8003\u306b\u306a\u3063\u305f\u306e\u306f\u3001\u3053\u306e\u30dd\u30b9\u30c8\u2193\nhttp://stackoverflow.com/questions/31399856/drawing-a-line-with-three-js-dynamically/31411794#31411794\n\u30dd\u30a4\u30f3\u30c8\u306f\u3001\nvar geometry = new THREE.Geometry();\n\u3067\u306f\u306a\u304f\u3001\nvar geometry = new THREE.BufferGeometry();\n\u3092\u4f7f\u3046\u3053\u3068\u3002\n\u57fa\u672c\u7684\u306b\u3001geometry\u306e\u9802\u70b9\u6570\uff08vertices\u306e\u6570\uff09\u3092\u52d5\u7684\u306b\u5897\u3084\u3057\u3066\u3044\u304f\u3053\u3068\u306f\u3067\u304d\u306a\u3044\u3093\u3060\u305d\u3046\u3002\n\u306a\u306e\u3067\u3001\u6700\u521d\u306b\u3042\u308b\u7a0b\u5ea6\u3001\u9802\u70b9\u3092\u914d\u5217\u306b\u3069\u3070\u3063\u3068\u5165\u308c\u3066\u304a\u3044\u3066\u3001\u305d\u306e\u5185\u3044\u304f\u3064\u76ee\u307e\u3067\u306e\u9802\u70b9\u3092\u4f7f\u3046\u304b\u3092\u6307\u5b9a\u3059\u308b\u3002\nfunction drawDynamicLine(){\n    //---\u6700\u5927\u9802\u70b9\u6570\u3092\u3042\u3089\u304b\u3058\u3081\u6307\u5b9a\u3059\u308b\u5fc5\u8981\u304c\u3042\u308b\u3002\u3053\u3053\u3067\u306f30\n    var maxpoints = 30;\n\n    //---BufferGeometry\u3092\u4f7f\u3046\u306e\u304c\u30dd\u30a4\u30f3\u30c8\n    var geometry = new THREE.BufferGeometry();\n\n    //---\u9802\u70b9\u306e\u5834\u6240\u3092\u683c\u7d0d\u3057\u3066\u3044\u304farray\u3092\u7528\u610f\u3002\u5404\u9802\u70b9\uff08x,y,z\uff09\u306e\uff13\u3064\u306e\u6570\u5b57\u304c\u3042\u308b\u306e\u30673\u500d\u3059\u308b\n    var positions = new Float32Array(maxpoints * 3);\n    geometry.addAttribute('position', new THREE.BufferAttribute(positions, 3));\n\n    //---\u914d\u5217\u306b\u9802\u70b9\u306e\u5ea7\u6a19\u3092\u3044\u308c\u3066\u304f\u3002\u3072\u3068\u307e\u305amaxpoints\u3067\u8a2d\u5b9a\u3057\u305f\u9802\u70b9\u6570\u306e\u5185\u30012\u9802\u70b9\u5206\n    var array = geometry.attributes.position.array;\n    array[0] = -100;    //x1\n    array[1] = 0;       //y1\n    array[2] = 0;       //z1\n    array[3] = 100;     //x2\n    array[4] = 0;       //y2\n    array[5] = 0;       //z2\n\n    //---BufferGeometry\u30af\u30e9\u30b9\u306e.addGroup\u3000\u5f15\u6570\u306f( start, count, indexOffset )\n    //---\u3068\u308a\u3042\u3048\u305a\u7528\u610f\u3057\u305f\u9802\u70b9\u306e\u3046\u30610\u756a\u304b\u30892\u756a\u307e\u3067\u7d50\u3076\n    geometry.addGroup(0, 2, 0);\n\n    //---\u3042\u3068\u306f\u3001\u901a\u5e38\u3068\u540c\u3058\n    var material = new THREE.LineBasicMaterial({ color: 0x990000, linewidth : 5});\n    line = new THREE.Line(geometry, material);\n\n    scene.add(line);\n}\n\n\n\u3067\u3001\"\u4f38\u3070\u305b\u308b\"\u7dda\u306e\u6700\u521d\u306e\u90e8\u5206\u304c\u63cf\u3051\u308b\u3002\n\u7528\u610f\u3057\u305f\u9802\u70b9\uff08maxpoints\u3067\u6307\u5b9a\u3057\u305f\u6570\uff09\u306e\u3044\u304f\u3064\u76ee\u307e\u3067\u3092\u4f7f\u3063\u3066\u7dda\u3092\u63cf\u304f\u304b\u3092\u6c7a\u3081\u308b\u306e\u306f\u2193\u306e\u6570\u3002\nline.geometry.drawcalls[0].count\n\u30a2\u30c3\u30d7\u30c7\u30fc\u30c8: .geometry.drawcalls\u304c\u5ec3\u6b62\u3055\u308c\u305f\u3002\n\u7528\u610f\u3057\u305f\u9802\u70b9\uff08maxpoints\u3067\u6307\u5b9a\u3057\u305f\u6570\uff09\u306e\u3044\u304f\u3064\u76ee\u307e\u3067\u3092\u4f7f\u3063\u3066\u7dda\u3092\u63cf\u304f\u306f\u3001\nline.geometry.setDrawRange( start, count );\n\u3067\u66f4\u65b0\u3059\u308b\u3002\n\u306a\u306e\u3067\u3001\u3053\u308c\u4ee5\u964d\u3001\nindex = 3; //---\u65b0\u305f\u306b\u52a0\u3048\u308b\u9802\u70b9\u306eindex (\u3053\u3053\u3067\u306f\u3001\u6700\u592730)\nvar array = geometry.attributes.position.array;\narray[index*3]   = newX; //---\u65b0\u305f\u306b\u52a0\u3048\u308b\u9802\u70b9\u306ex\u5ea7\u6a19\narray[index*3+1] = newY; //---\u65b0\u305f\u306b\u52a0\u3048\u308b\u9802\u70b9\u306ey\u5ea7\u6a19\narray[index*3+2] = newZ; //---\u65b0\u305f\u306b\u52a0\u3048\u308b\u9802\u70b9\u306ez\u5ea7\u6a19\n\n\u3068\u304b\u3067\u3001\u9802\u70b9\u5ea7\u6a19\u3092\u914d\u5217\u306b\u52a0\u3048\u3066\u304b\u3089\u3001\nline.geometry.setDrawRange(0, 3);\n\u3063\u3066\u3084\u308b\u3068\u30010\u756a\u76ee\u304b\u30893\u756a\u76ee\u306e\u9802\u70b9\u307e\u3067\u3092\u542b\u3080\u7dda\u304c\u63cf\u3051\u308b\u3002\n\u306a\u306e\u3067\u3001\u7dda\u304c\u4f38\u3073\u308b\u30a2\u30cb\u30e1\u30fc\u30b7\u30e7\u30f3\u3092\u3064\u304f\u308a\u305f\u3044\u3068\u304d\u306f\u3001\u6700\u521d\u306b\u30b9\u30bf\u30fc\u30c8\u5730\u70b9\u304b\u3089\u30b4\u30fc\u30eb\u5730\u70b9\u307e\u3067\u306e\u9802\u70b9\u3092\u5168\u90e8\u767b\u9332\u3057\u3066\u304a\u3044\u3066\u3001drawcalls[0].count\u306e\u6570\u3092 .setDrawRange(0, 3)\u306e\u6570\u3092\u3001animation\u95a2\u6570\u306e\u4e2d\u3067\u5897\u3084\u3057\u3066\u3044\u3051\u3070\u3001\u4f38\u3073\u3066\u3044\u304f\u306f\u305a\u3002\nhttp://jsfiddle.net/yuyuyuyoyoyo/0zurstzw/9/\nthree.js\u3067\u7dda\u304c\u4f38\u3073\u3066\u304f\u30a2\u30cb\u30e1\u30fc\u30b7\u30e7\u30f3\u3092\u3064\u304f\u308b\u3068\u304d\u306b\u5c11\u3057\u30af\u30bb\u304c\u3042\u3063\u305f\u306e\u3067\u30e1\u30e2\u3002\n\n\u307e\u305a\u306f\u901a\u5e38\u306e\"\u4f38\u3073\u306a\u3044\"\u7dda\u306e\u63cf\u304d\u65b9\u3002\n\n```\nvar scene, line;\n\nfunction drawNormalLine(){\n\tvar geometry = new THREE.Geometry();\n\tgeometry.vertices.push(new THREE.Vector3(-100,0,0));\n\tgeometry.vertices.push(new THREE.Vector3(100,0,0));\n\tvar material = new THREE.LineBasicMaterial({color: 0x00FFFF, linewidth: 2});\n\tline = new THREE.Line(geometry, material);\n\tscene.add(line);\n}\n```\n\n\u3053\u308c\u3067\u3001\n\n```\nline.geometry.vertices.push(new THREE.Vector3(200,0,0));\nline.geometry.verticesNeedUpdate = true;\n```\n\u3068\u304b\u3001\u3084\u3063\u3066\u3044\u3051\u3070\u7dda\u304c\u4f38\u3073\u308b\u3093\u3060\u308d\u3046\u3068\u601d\u3063\u305f\u3089\u4f38\u3073\u306a\u3044\u3002\n\n\u89e3\u6c7a\u3059\u308b\u306b\u3042\u305f\u308a\u53c2\u8003\u306b\u306a\u3063\u305f\u306e\u306f\u3001\u3053\u306e\u30dd\u30b9\u30c8\u2193\nhttp://stackoverflow.com/questions/31399856/drawing-a-line-with-three-js-dynamically/31411794#31411794\n\n\n\u30dd\u30a4\u30f3\u30c8\u306f\u3001\n`var geometry = new THREE.Geometry();`\n\u3067\u306f\u306a\u304f\u3001\n`var geometry = new THREE.BufferGeometry();`\n\u3092\u4f7f\u3046\u3053\u3068\u3002\n\n\u57fa\u672c\u7684\u306b\u3001geometry\u306e\u9802\u70b9\u6570\uff08vertices\u306e\u6570\uff09\u3092\u52d5\u7684\u306b\u5897\u3084\u3057\u3066\u3044\u304f\u3053\u3068\u306f\u3067\u304d\u306a\u3044\u3093\u3060\u305d\u3046\u3002\n\u306a\u306e\u3067\u3001\u6700\u521d\u306b\u3042\u308b\u7a0b\u5ea6\u3001\u9802\u70b9\u3092\u914d\u5217\u306b\u3069\u3070\u3063\u3068\u5165\u308c\u3066\u304a\u3044\u3066\u3001\u305d\u306e\u5185\u3044\u304f\u3064\u76ee\u307e\u3067\u306e\u9802\u70b9\u3092\u4f7f\u3046\u304b\u3092\u6307\u5b9a\u3059\u308b\u3002\n\n```\nfunction drawDynamicLine(){\n\t//---\u6700\u5927\u9802\u70b9\u6570\u3092\u3042\u3089\u304b\u3058\u3081\u6307\u5b9a\u3059\u308b\u5fc5\u8981\u304c\u3042\u308b\u3002\u3053\u3053\u3067\u306f30\n\tvar maxpoints = 30;\n\n\t//---BufferGeometry\u3092\u4f7f\u3046\u306e\u304c\u30dd\u30a4\u30f3\u30c8\n\tvar geometry = new THREE.BufferGeometry();\n\n\t//---\u9802\u70b9\u306e\u5834\u6240\u3092\u683c\u7d0d\u3057\u3066\u3044\u304farray\u3092\u7528\u610f\u3002\u5404\u9802\u70b9\uff08x,y,z\uff09\u306e\uff13\u3064\u306e\u6570\u5b57\u304c\u3042\u308b\u306e\u30673\u500d\u3059\u308b\n\tvar positions = new Float32Array(maxpoints * 3);\n\tgeometry.addAttribute('position', new THREE.BufferAttribute(positions, 3));\n\n\t//---\u914d\u5217\u306b\u9802\u70b9\u306e\u5ea7\u6a19\u3092\u3044\u308c\u3066\u304f\u3002\u3072\u3068\u307e\u305amaxpoints\u3067\u8a2d\u5b9a\u3057\u305f\u9802\u70b9\u6570\u306e\u5185\u30012\u9802\u70b9\u5206\n\tvar array = geometry.attributes.position.array;\n\tarray[0] = -100;\t//x1\n\tarray[1] = 0; \t\t//y1\n\tarray[2] = 0;\t\t//z1\n\tarray[3] = 100;\t\t//x2\n\tarray[4] = 0;\t\t//y2\n\tarray[5] = 0;\t\t//z2\n\n\t//---BufferGeometry\u30af\u30e9\u30b9\u306e.addGroup\u3000\u5f15\u6570\u306f( start, count, indexOffset )\n\t//---\u3068\u308a\u3042\u3048\u305a\u7528\u610f\u3057\u305f\u9802\u70b9\u306e\u3046\u30610\u756a\u304b\u30892\u756a\u307e\u3067\u7d50\u3076\n\tgeometry.addGroup(0, 2, 0);\n\n    //---\u3042\u3068\u306f\u3001\u901a\u5e38\u3068\u540c\u3058\n\tvar material = new THREE.LineBasicMaterial({ color: 0x990000, linewidth : 5});\n\tline = new THREE.Line(geometry, material);\n\n    scene.add(line);\n}\n\n```\n\u3067\u3001\"\u4f38\u3070\u305b\u308b\"\u7dda\u306e\u6700\u521d\u306e\u90e8\u5206\u304c\u63cf\u3051\u308b\u3002\n\n<s>\u7528\u610f\u3057\u305f\u9802\u70b9\uff08maxpoints\u3067\u6307\u5b9a\u3057\u305f\u6570\uff09\u306e\u3044\u304f\u3064\u76ee\u307e\u3067\u3092\u4f7f\u3063\u3066\u7dda\u3092\u63cf\u304f\u304b\u3092\u6c7a\u3081\u308b\u306e\u306f\u2193\u306e\u6570\u3002</s>\n<s>`line.geometry.drawcalls[0].count`</s>\n\n\u30a2\u30c3\u30d7\u30c7\u30fc\u30c8: .geometry.drawcalls\u304c\u5ec3\u6b62\u3055\u308c\u305f\u3002\n\u7528\u610f\u3057\u305f\u9802\u70b9\uff08maxpoints\u3067\u6307\u5b9a\u3057\u305f\u6570\uff09\u306e\u3044\u304f\u3064\u76ee\u307e\u3067\u3092\u4f7f\u3063\u3066\u7dda\u3092\u63cf\u304f\u306f\u3001\n`line.geometry.setDrawRange( start, count );`\n\u3067\u66f4\u65b0\u3059\u308b\u3002\n\u306a\u306e\u3067\u3001\u3053\u308c\u4ee5\u964d\u3001\n\n```\nindex = 3; //---\u65b0\u305f\u306b\u52a0\u3048\u308b\u9802\u70b9\u306eindex (\u3053\u3053\u3067\u306f\u3001\u6700\u592730)\nvar array = geometry.attributes.position.array;\narray[index*3]   = newX; //---\u65b0\u305f\u306b\u52a0\u3048\u308b\u9802\u70b9\u306ex\u5ea7\u6a19\narray[index*3+1] = newY; //---\u65b0\u305f\u306b\u52a0\u3048\u308b\u9802\u70b9\u306ey\u5ea7\u6a19\narray[index*3+2] = newZ; //---\u65b0\u305f\u306b\u52a0\u3048\u308b\u9802\u70b9\u306ez\u5ea7\u6a19\n```\n\u3068\u304b\u3067\u3001\u9802\u70b9\u5ea7\u6a19\u3092\u914d\u5217\u306b\u52a0\u3048\u3066\u304b\u3089\u3001\n\n`line.geometry.setDrawRange(0, 3);`\n\n\u3063\u3066\u3084\u308b\u3068\u30010\u756a\u76ee\u304b\u30893\u756a\u76ee\u306e\u9802\u70b9\u307e\u3067\u3092\u542b\u3080\u7dda\u304c\u63cf\u3051\u308b\u3002\n\n\u306a\u306e\u3067\u3001\u7dda\u304c\u4f38\u3073\u308b\u30a2\u30cb\u30e1\u30fc\u30b7\u30e7\u30f3\u3092\u3064\u304f\u308a\u305f\u3044\u3068\u304d\u306f\u3001\u6700\u521d\u306b\u30b9\u30bf\u30fc\u30c8\u5730\u70b9\u304b\u3089\u30b4\u30fc\u30eb\u5730\u70b9\u307e\u3067\u306e\u9802\u70b9\u3092\u5168\u90e8\u767b\u9332\u3057\u3066\u304a\u3044\u3066\u3001<s>drawcalls[0].count\u306e\u6570\u3092</s> .setDrawRange(0, 3)\u306e\u6570\u3092\u3001animation\u95a2\u6570\u306e\u4e2d\u3067\u5897\u3084\u3057\u3066\u3044\u3051\u3070\u3001\u4f38\u3073\u3066\u3044\u304f\u306f\u305a\u3002\nhttp://jsfiddle.net/yuyuyuyoyoyo/0zurstzw/9/\n\n\n\n"}