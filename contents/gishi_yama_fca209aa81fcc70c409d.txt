{"context": " More than 1 year has passed since last update.\n\n\u7d4c\u7def\n\u4ee5\u524d\u3001\u8868\u984c\u306e\u7d44\u307f\u5408\u308f\u305b\u3092\u4f7f\u3063\u3066\u307f\u308b\u30b5\u30f3\u30d7\u30eb\u30b3\u30fc\u30c9\u3092\u66f8\u3044\u305f\u3002\n\u5b9f\u969b\u306b\u958b\u767a\u3092\u9032\u3081\u3066\u307f\u308b\u3068\u3001Wicket\u306eWebApplication\u30af\u30e9\u30b9\u306eMetaDataKey\u3092\u4f7f\u3063\u3066\u7ba1\u7406\u3059\u308b\u3088\u308a\u3082\u3001Singleton\u306a\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3067Sql2o\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u7ba1\u7406\u3057\u305f\u65b9\u304c\uff08JUnit\u3067\u306e\u30c6\u30b9\u30c8\u306a\u3069\u3082\u542b\u3081\u3066\uff09\u53d6\u308a\u56de\u3057\u304c\u697d\u306a\u6c17\u304c\u3057\u3066\u3001\u3061\u3087\u3063\u3068\u5909\u66f4\u3057\u3066\u4f7f\u3044\u306f\u3058\u3081\u305f\u306e\u3067\u3001\u30e1\u30e2\u3057\u3066\u304a\u304f\u3002\n\u306a\u304a\u3001\u4ee5\u4e0b\u306e\u624b\u9806\u3067\u306fGoogle Guice\u3068Wicket-Guice\u3082\u5229\u7528\u3057\u3066\u3044\u308b\u3002\n\n\u624b\u9806\n\nProperties\u30d5\u30a1\u30a4\u30eb\u306e\u4f5c\u6210\n\u524d\u56de\u3068\u540c\u3058\u3002\n\nSql2o\u306e\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u5316\uff08Singleton\uff09\n\u524d\u56de\u306fWicket\u306eMetaDataKey\u3067\u7ba1\u7406\u3057\u3066\u3044\u305fSql2o\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u3001Sinbleton\u306a\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3067\u7ba1\u7406\u3067\u304d\u308b\u3088\u3046\u306b\u3059\u308b\u3002Singleton\u5316\u306b\u306fGuice\u306e\u6a5f\u80fd\u3092\u4f7f\u3046\u3002\n\nIDBCP.java\n@ImplementedBy(DBCP.class)\npublic interface IDBCP {\n  public HikariDataSource getHikariDataSource() throws SQLException;\n}\n\n\n\nDBCP.java\n@Singleton\npublic class DBCP implements IDBCP {\n\n  private final Sql2o sql2o;\n\n  public DBCP() {\n    String configPath = \n      getClass().getClassLoader().getResource(\"\").getPath() + \"hikari.properties\";\n    sql2o = \n      new Sql2o(new HikariDataSource(new HikariConfig(filePath)), new PostgresQuirks());\n  }\n\n  @Override\n  public sql2o getSql2o() throws SQLException {\n    Return sql2o;\n  }\n\n\n\nMyApplication.java\npublic class MyApplication extends WebApplication {\n\n  @Override\n  protected void init() {\n    super.init();\n    getComponentInstantiationListeners()\n      .add(new GuiceComponentInjector(this, getGuiceModule()));\n    //-- snip --\n  }\n\n  protected Module getGuiceModule() {\n    return new Module() {\n      @Override\n      public void configure(Binder binder) {\n        binder.bind(IDBCP.class).to(DBCP.class).asEagerSingleton();\n      }\n    };\n  }\n  //-- snip --\n}\n\n\n\nSql2o\u306e\u5229\u7528\nSql2o\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306e\u53d6\u5f97\u65b9\u6cd5\u304c\u5909\u308f\u308b\u3060\u3051\u3002\n\nFooPage.java\npublic class FooPage extends WebPage {\n\n  @Inject\n  private IDBCP dbcp;\n\n  public FooPage() {\n    // \u66f8\u7c4d\u30c6\u30fc\u30d6\u30eb\u304b\u3089ISBN\u306e\u30ea\u30b9\u30c8\u3092\u53d6\u5f97\u3059\u308b\u60f3\u5b9a.\n    // \u5b9f\u969b\u306e\u5229\u7528\u3067\u306f \u5225\u30af\u30e9\u30b9\u306e\u30e1\u30bd\u30c3\u30c9\u306e\u8fd4\u5024\u3092Model\u306a\u3069\u3067\u30e9\u30c3\u30d4\u30f3\u30b0\u3059\u308b.\n    try (Connection con = dbcp.getSql2o.open()) {\n      List<String> isbns = con\n        .createQuery(\"select isbn from books\")\n        .executeScalarList(String.class);\n    }\n    // -- snip --\n  }\n}\n\n\n## \u7d4c\u7def\n\u4ee5\u524d\u3001[\u8868\u984c\u306e\u7d44\u307f\u5408\u308f\u305b\u3092\u4f7f\u3063\u3066\u307f\u308b\u30b5\u30f3\u30d7\u30eb\u30b3\u30fc\u30c9\u3092\u66f8\u3044\u305f](http://qiita.com/gishi_yama/items/f00704c1abbf896abf58)\u3002\n\n\u5b9f\u969b\u306b\u958b\u767a\u3092\u9032\u3081\u3066\u307f\u308b\u3068\u3001Wicket\u306eWebApplication\u30af\u30e9\u30b9\u306eMetaDataKey\u3092\u4f7f\u3063\u3066\u7ba1\u7406\u3059\u308b\u3088\u308a\u3082\u3001Singleton\u306a\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3067Sql2o\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u7ba1\u7406\u3057\u305f\u65b9\u304c\uff08JUnit\u3067\u306e\u30c6\u30b9\u30c8\u306a\u3069\u3082\u542b\u3081\u3066\uff09\u53d6\u308a\u56de\u3057\u304c\u697d\u306a\u6c17\u304c\u3057\u3066\u3001\u3061\u3087\u3063\u3068\u5909\u66f4\u3057\u3066\u4f7f\u3044\u306f\u3058\u3081\u305f\u306e\u3067\u3001\u30e1\u30e2\u3057\u3066\u304a\u304f\u3002\n\n\u306a\u304a\u3001\u4ee5\u4e0b\u306e\u624b\u9806\u3067\u306fGoogle Guice\u3068Wicket-Guice\u3082\u5229\u7528\u3057\u3066\u3044\u308b\u3002\n\n## \u624b\u9806\n\n### Properties\u30d5\u30a1\u30a4\u30eb\u306e\u4f5c\u6210\n\n[\u524d\u56de](http://qiita.com/gishi_yama/items/f00704c1abbf896abf58#3-1)\u3068\u540c\u3058\u3002\n\n### Sql2o\u306e\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u5316\uff08Singleton\uff09\n\n\u524d\u56de\u306fWicket\u306eMetaDataKey\u3067\u7ba1\u7406\u3057\u3066\u3044\u305fSql2o\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u3001Sinbleton\u306a\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3067\u7ba1\u7406\u3067\u304d\u308b\u3088\u3046\u306b\u3059\u308b\u3002Singleton\u5316\u306b\u306fGuice\u306e\u6a5f\u80fd\u3092\u4f7f\u3046\u3002\n\n```java:IDBCP.java\n@ImplementedBy(DBCP.class)\npublic interface IDBCP {\n  public HikariDataSource getHikariDataSource() throws SQLException;\n}\n```\n\n```java:DBCP.java\n@Singleton\npublic class DBCP implements IDBCP {\n\n  private final Sql2o sql2o;\n\n  public DBCP() {\n    String configPath = \n      getClass().getClassLoader().getResource(\"\").getPath() + \"hikari.properties\";\n    sql2o = \n      new Sql2o(new HikariDataSource(new HikariConfig(filePath)), new PostgresQuirks());\n  }\n\n  @Override\n  public sql2o getSql2o() throws SQLException {\n    Return sql2o;\n  }\n```\n\n```java:MyApplication.java\npublic class MyApplication extends WebApplication {\n\n  @Override\n  protected void init() {\n    super.init();\n    getComponentInstantiationListeners()\n      .add(new GuiceComponentInjector(this, getGuiceModule()));\n    //-- snip --\n  }\n\n  protected Module getGuiceModule() {\n    return new Module() {\n      @Override\n      public void configure(Binder binder) {\n        binder.bind(IDBCP.class).to(DBCP.class).asEagerSingleton();\n      }\n    };\n  }\n  //-- snip --\n}\n```\n\n### Sql2o\u306e\u5229\u7528\n\nSql2o\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306e\u53d6\u5f97\u65b9\u6cd5\u304c\u5909\u308f\u308b\u3060\u3051\u3002\n\n```java:FooPage.java\npublic class FooPage extends WebPage {\n\n  @Inject\n  private IDBCP dbcp;\n\n  public FooPage() {\n    // \u66f8\u7c4d\u30c6\u30fc\u30d6\u30eb\u304b\u3089ISBN\u306e\u30ea\u30b9\u30c8\u3092\u53d6\u5f97\u3059\u308b\u60f3\u5b9a.\n    // \u5b9f\u969b\u306e\u5229\u7528\u3067\u306f \u5225\u30af\u30e9\u30b9\u306e\u30e1\u30bd\u30c3\u30c9\u306e\u8fd4\u5024\u3092Model\u306a\u3069\u3067\u30e9\u30c3\u30d4\u30f3\u30b0\u3059\u308b.\n    try (Connection con = dbcp.getSql2o.open()) {\n      List<String> isbns = con\n        .createQuery(\"select isbn from books\")\n        .executeScalarList(String.class);\n    }\n    // -- snip --\n  }\n}\n````\n", "tags": ["HikariCP1.3.8", "Sql2o1.5.1", "log4jdbc-log4j21.16", "Wicket6.15.0", "Java1.7.0_60"]}