{"context": " More than 1 year has passed since last update.\n\n\u6982\u8981\n\u30b9\u30de\u30db\u306e\u30d6\u30e9\u30a6\u30b6\u3067\u4f4d\u7f6e\u60c5\u5831\u3092\u53d6\u3063\u3066\u3001ajax\u3067node-red\u306b\u9001\u308b\u3002\njsdo.it\u3067node-red\u306bwebsocket\u3067\u3064\u306a\u3044\u3067\u3001\u30de\u30c3\u30d7\u8868\u793a\u3059\u308b\u3002\n\n\u5199\u771f\n\u30b9\u30de\u30db\u306e\u30d6\u30e9\u30a6\u30b6\u3067\u4f4d\u7f6e\u60c5\u5831\u3092\u53d6\u308b\u3002\n\nnode-red\u3067json\u3068websocket\u3092\u3064\u306a\u3050\u3002\n\nwebsocket\u3067\u30de\u30c3\u30d7\u8868\u793a\u3002\n\n\n\u691c\u51fa\u30b5\u30f3\u30d7\u30eb\u30b3\u30fc\u30c9\nvar lat, lng, alt, accLatlng, accAlt, heading, speed;\nfunction GetLocation(p) {\n    lat = p.coords.latitude;\n    lng = p.coords.longitude;\n    accLatlng = p.coords.accuracy;\n    alt = p.coords.altitude;\n    accAlt = p.coords.altitudeAccuracy;\n    heading = p.coords.heading;\n    speed = p.coords.speed;\n    Render();\n    Publish();\n}\nfunction GetLocationError(error) {\n    alert(\"Geolocation Error\");\n}\nfunction Render() {\n    if (lat !== null)\n    {\n        $('#lat').html(lat);\n    }\n    if (lng !== null)\n    {\n        $('#lng').html(lng);\n    }\n    if (accLatlng !== null)\n    {\n        $('#accLatlng').html(accLatlng);\n    }\n    if (alt !== null)\n    {\n        $('#alt').html(alt);\n    }\n    if (accAlt !== null)\n    {\n        $('#accAlt').html(accAlt);\n    }\n    if (heading !== null)\n    {\n        $('#heading').html(heading);\n    }\n    if (speed !== null)\n    {\n        $('#speed').html(speed); \n    }   \n}\nfunction Publish() {\n    var uri = 'http://node-red /json?latlon=' + lat + ',' + lng;\n    alert(uri);\n    $.ajax({\n        type: 'get',\n        url: uri,\n        success: function(res) {\n            alert('success');\n        },        \n        error: function(res) {            \n        }\n    });\n}\n$(function() {\n    if (navigator.geolocation)\n    {\n        navigator.geolocation.getCurrentPosition(GetLocation, GetLocationError);\n    } \n    else \n    {\n        alert(\"\u304a\u4f7f\u3044\u306e\u7aef\u672b\u306f\u3001GeoLacation API\u306b\u5bfe\u5fdc\u3057\u3066\u3044\u307e\u305b\u3093\u3002\");\n    }\n});\n\n\n\n\u30de\u30c3\u30d7\u8868\u793a\u30b5\u30f3\u30d7\u30eb\u30b3\u30fc\u30c9\nvar map;\nvar point;\nvar marker;\nfunction ido(koko) {\n    eval(koko);\n    latlon = a[\"latlon\"].split(\",\");\n    var my = new google.maps.LatLng(latlon[0], latlon[1]);\n    map.setCenter(my);\n    marker.setPosition(my);\n};\nfunction init() {\n    point = new google.maps.LatLng(38.0, 140.0);\n    var opts = {\n        zoom: 10,\n        mapTypeId: google.maps.MapTypeId.ROADMAP,\n        center: point\n    };\n    map = new google.maps.Map(document.getElementById(\"map\"), opts);\n    marker =  new google.maps.Marker({\n        position: point,\n        map: map\n    });\n}\ngoogle.maps.event.addDomListener(window, 'load', init);\nvar websocket;\nfunction setup() { \n    websocket = new WebSocket(\"ws://node-red /test0\");\n    websocket.onopen = function() {\n    };\n    websocket.onmessage = function(e) {\n        ido(\"a =\" + e.data);\n    };\n    websocket.onerror = function(e) {\n    };\n}\nsetup();\n\n\n#\u6982\u8981\n\u30b9\u30de\u30db\u306e\u30d6\u30e9\u30a6\u30b6\u3067\u4f4d\u7f6e\u60c5\u5831\u3092\u53d6\u3063\u3066\u3001ajax\u3067node-red\u306b\u9001\u308b\u3002\njsdo.it\u3067node-red\u306bwebsocket\u3067\u3064\u306a\u3044\u3067\u3001\u30de\u30c3\u30d7\u8868\u793a\u3059\u308b\u3002\n\n#\u5199\u771f\n\u30b9\u30de\u30db\u306e\u30d6\u30e9\u30a6\u30b6\u3067\u4f4d\u7f6e\u60c5\u5831\u3092\u53d6\u308b\u3002\n![loc.jpg](https://qiita-image-store.s3.amazonaws.com/0/18104/153a86d9-9a24-a93b-1f86-180e55335b36.jpeg)\nnode-red\u3067json\u3068websocket\u3092\u3064\u306a\u3050\u3002\n![latlon.jpg](https://qiita-image-store.s3.amazonaws.com/0/18104/db8a9746-4f1e-02a6-ee40-fc4960a40039.jpeg)\nwebsocket\u3067\u30de\u30c3\u30d7\u8868\u793a\u3002\n![map0.jpg](https://qiita-image-store.s3.amazonaws.com/0/18104/a4a5bb15-14d4-599b-fcdd-902764932ca3.jpeg)\n\n#\u691c\u51fa\u30b5\u30f3\u30d7\u30eb\u30b3\u30fc\u30c9\n```\nvar lat, lng, alt, accLatlng, accAlt, heading, speed;\nfunction GetLocation(p) {\n    lat = p.coords.latitude;\n    lng = p.coords.longitude;\n    accLatlng = p.coords.accuracy;\n    alt = p.coords.altitude;\n    accAlt = p.coords.altitudeAccuracy;\n    heading = p.coords.heading;\n    speed = p.coords.speed;\n    Render();\n    Publish();\n}\nfunction GetLocationError(error) {\n    alert(\"Geolocation Error\");\n}\nfunction Render() {\n    if (lat !== null)\n    {\n        $('#lat').html(lat);\n    }\n    if (lng !== null)\n    {\n        $('#lng').html(lng);\n    }\n    if (accLatlng !== null)\n    {\n        $('#accLatlng').html(accLatlng);\n    }\n    if (alt !== null)\n    {\n        $('#alt').html(alt);\n    }\n    if (accAlt !== null)\n    {\n        $('#accAlt').html(accAlt);\n    }\n    if (heading !== null)\n    {\n        $('#heading').html(heading);\n    }\n    if (speed !== null)\n    {\n        $('#speed').html(speed); \n    }   \n}\nfunction Publish() {\n    var uri = 'http://node-red /json?latlon=' + lat + ',' + lng;\n    alert(uri);\n    $.ajax({\n        type: 'get',\n        url: uri,\n        success: function(res) {\n            alert('success');\n        },        \n        error: function(res) {            \n        }\n    });\n}\n$(function() {\n    if (navigator.geolocation)\n    {\n        navigator.geolocation.getCurrentPosition(GetLocation, GetLocationError);\n    } \n    else \n    {\n        alert(\"\u304a\u4f7f\u3044\u306e\u7aef\u672b\u306f\u3001GeoLacation API\u306b\u5bfe\u5fdc\u3057\u3066\u3044\u307e\u305b\u3093\u3002\");\n    }\n});\n\n```\n#\u30de\u30c3\u30d7\u8868\u793a\u30b5\u30f3\u30d7\u30eb\u30b3\u30fc\u30c9\n```\nvar map;\nvar point;\nvar marker;\nfunction ido(koko) {\n    eval(koko);\n    latlon = a[\"latlon\"].split(\",\");\n    var my = new google.maps.LatLng(latlon[0], latlon[1]);\n    map.setCenter(my);\n    marker.setPosition(my);\n};\nfunction init() {\n    point = new google.maps.LatLng(38.0, 140.0);\n\tvar opts = {\n\t\tzoom: 10,\n\t\tmapTypeId: google.maps.MapTypeId.ROADMAP,\n\t\tcenter: point\n\t};\n    map = new google.maps.Map(document.getElementById(\"map\"), opts);\n    marker =  new google.maps.Marker({\n        position: point,\n        map: map\n    });\n}\ngoogle.maps.event.addDomListener(window, 'load', init);\nvar websocket;\nfunction setup() { \n    websocket = new WebSocket(\"ws://node-red /test0\");\n    websocket.onopen = function() {\n    };\n    websocket.onmessage = function(e) {\n        ido(\"a =\" + e.data);\n    };\n    websocket.onerror = function(e) {\n    };\n}\nsetup();\n\n```\n", "tags": ["node-red", "IoT"]}