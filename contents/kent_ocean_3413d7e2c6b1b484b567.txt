{"context": "\n\n\u306f\u3058\u3081\u306b\n\u7686\u3055\u3093\u3054\u5b58\u77e5\u306e\u901a\u308a Excel 2007 \u4ee5\u964d\u306e Excel \u30d5\u30a1\u30a4\u30eb\u306f Open XML \u898f\u683c\u306b\u6e96\u62e0\u3057\u3066\u304a\u308a\u3001\u305d\u306e\u5b9f\u614b\u306f XML \u30d5\u30a1\u30a4\u30eb\u7fa4\u304c zip \u5727\u7e2e\u3055\u308c\u305f\u3082\u306e\u3067\u3059\u3002\nExcel\u30d5\u30a1\u30a4\u30eb\u3092 zip \u5c55\u958b\u3059\u308b\u3068\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u30d5\u30a1\u30a4\u30eb\u7fa4\u304c\u5b58\u5728\u3059\u308b\u306e\u304c\u78ba\u8a8d\u3067\u304d\u307e\u3059\u3002\n\nExcel\u306e\u5404\u30bb\u30eb\u306b\u5165\u3063\u3066\u3044\u308b\u6587\u5b57\u5217\u306f\u3001\u5168\u3066 xl/sharedStrings.xml \u3068\u3044\u3046\u30d5\u30a1\u30a4\u30eb\u5185\u306b\u683c\u7d0d\u3055\u308c\u3066\u3044\u307e\u3059\u3002\n\u4f8b\u3048\u3070\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306a Excel \u30d5\u30a1\u30a4\u30eb\u304c\u3042\u308b\u3068\u3057\u307e\u3059\u3002\n\n\u3053\u306e\u30d5\u30a1\u30a4\u30eb\u3092 zip \u5c55\u958b\u3057\u3066 sharedStrings.xml \u3092\u30a8\u30c7\u30a3\u30bf\u3067\u958b\u304f\u3068\u3001\u4e2d\u8eab\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u306a\u3063\u3066\u3044\u307e\u3059\u3002\n\n\u3055\u3066\u3001\u8ce2\u660e\u306a\u7686\u69d8\u306a\u3089\u304a\u5206\u304b\u308a\u3044\u305f\u3060\u3051\u305f\u3068\u601d\u3044\u307e\u3059\u304c\u3001\n\u3082\u3057 Excel\u30d5\u30a1\u30a4\u30eb\u5185\u306e\u6587\u5b57\u5217\u3092\u30d7\u30ed\u30b0\u30e9\u30e0\u3067\u7f6e\u63db\u3057\u305f\u3044\u5834\u5408\n(1) Excel\u30d5\u30a1\u30a4\u30eb\u3092 zip \u5c55\u958b\n\u2193\n(2) xl/sharedStrings.xml \u3092\u66f8\u304d\u63db\u3048\n\u2193\n(3) zip \u5727\u7e2e\u3057\u3001\u62e1\u5f35\u5b50\u3092 .xlsx \u306b\u3057\u3066\u4fdd\u5b58\n\u3068\u3044\u3046\uff13\u3064\u306e\u51e6\u7406\u3092\u9806\u306b\u884c\u3048\u3070\u3001Excel \u30d5\u30a1\u30a4\u30eb\u5185\u306e\u6587\u5b57\u5217\u3092\u7f6e\u63db\u3067\u304d\u308b\u3068\u3044\u3046\u3053\u3068\u306b\u306a\u308a\u307e\u3059\u3088\u306d\u3002\n\n\u3053\u306e\u30ed\u30b8\u30c3\u30af\u306b\u57fa\u3065\u304d\u3001\u3055\u3063\u305d\u304f Go \u8a00\u8a9e\u3067\u5b9f\u88c5\u3057\u3066\u307f\u307e\u3057\u305f\u3002\n\u304c\u3001\u3044\u304f\u3064\u304b\u56f0\u96e3\u306b\u3076\u3061\u5f53\u305f\u308a\u307e\u3057\u305f\u306e\u3067\u3001\u305d\u306e\u8a66\u884c\u932f\u8aa4\u3057\u305f\u904e\u7a0b\u3092\u304a\u8a71\u3057\u3057\u307e\u3059\u3002\n\n\u8a66\u884c\u932f\u8aa4 1\n\u4f8b\u3048\u3070\u3001\u300cHello\u300d\u3068\u3044\u3046\u6587\u5b57\u5217\u3092\u300c\u3053\u3093\u306b\u3061\u306f\u300d\u306b\u7f6e\u63db\u3059\u308b\u3068\u3057\u307e\u3059\u3002\n\u3053\u308c\u3060\u3051\u306a\u3089\u5358\u7d14\u306b sharedStrings.xml \u3092\u958b\u3044\u3066  <t>Hello</t>  \u3092  <t>\u3053\u3093\u306b\u3061\u306f</t>  \u306b\u7f6e\u63db\u3059\u308c\u3070\u826f\u3044\u3060\u3051\u306a\u306e\u3067\u3001\u7c21\u5358\u306b\u5b9f\u88c5\u3067\u304d\u305d\u3046\u3067\u3059\u3002\n\u3068\u3053\u308d\u304c\u3053\u306e\u65b9\u6cd5\u3067\u306f\u5bfe\u5fdc\u3067\u304d\u306a\u3044\u30b1\u30fc\u30b9\u304c\u3042\u308a\u307e\u3059\u3002\n\u4f8b\u3048\u3070\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u30bb\u30eb\u5185\u306e\u6587\u5b57\u306e\u30b9\u30bf\u30a4\u30eb\u304c\u8907\u6570\u3042\u308b\u5834\u5408\u3067\u3059\u3002\n\n\u3053\u306e\u5834\u5408\u3001\u6587\u5b57\u5217\u304c\u30b9\u30bf\u30a4\u30eb\u3054\u3068\u306b <r> \u8981\u7d20\u3067\u5206\u5272\u3055\u308c\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\n\n\u3053\u306e\u3088\u3046\u306a\u30b1\u30fc\u30b9\u3092\u60f3\u5b9a\u3059\u308b\u3068\u3001\u5358\u7d14\u306b xml \u30d5\u30a1\u30a4\u30eb\u5185\u306e\u6587\u5b57\u5217\u3092\u7f6e\u63db\u3059\u308b\u3060\u3051\u3067\u306f\u5bfe\u5fdc\u3067\u304d\u305d\u3046\u306b\u3042\u308a\u307e\u305b\u3093\u3002\u305d\u3053\u3067 \"encoding/xml\" \u30d1\u30c3\u30b1\u30fc\u30b8\u3092\u4f7f\u3044\u3001XML\u3092\u30d1\u30fc\u30b9\u3059\u308b\u3053\u3068\u306b\u3057\u307e\u3057\u305f\u3002\n\n\u8a66\u884c\u932f\u8aa4 2 \u300c\u306a\u3093\u3067 Excel \u3059\u3050\u6b7b\u3093\u3067\u3057\u307e\u3046\u3093\u300d\u554f\u984c\u3078\u306e\u5bfe\u51e6\n\u4eca\u56de\u6700\u3082\u60a9\u307e\u3055\u308c\u305f\u306e\u304c\u3053\u308c\u3067\u3059\u3002\nExcel\u30d5\u30a1\u30a4\u30eb\u3092\u751f\u6210\u3057\u305f\u3068\u304d\u306b\u3001\u5c11\u3057\u3067\u3082\u5b9a\u7fa9\u8a2d\u5b9a\u3084\u5024\u3092\u30df\u30b9\u3063\u3066\u3057\u307e\u3046\u3068\u3001Microsoft Excel \u3067\u30d5\u30a1\u30a4\u30eb\u3092\u958b\u3044\u305f\u3068\u304d\u306b\u4ee5\u4e0b\u306e\u30a8\u30e9\u30fc\u304c\u8868\u793a\u3055\u308c\u3066\u3057\u307e\u3046\u306e\u3067\u3059\u3002\n\n\n\u3069\u306e\u3088\u3046\u306a\u72b6\u6cc1\u3067\u3001\u2191 \u306e\u3088\u3046\u306a\u30a8\u30e9\u30fc\u304c\u8868\u793a\u3055\u308c\u308b\u306e\u304b\u3068\u8a00\u3046\u3068\u3001\n\u4f8b\u3048\u3070\u3001sharedStrings.xml \u306b\u306f\u3001\u30eb\u30d3 (\u30d5\u30ea\u30ac\u30ca) \u3092\u683c\u7d0d\u3059\u308b <rPh> \u3068\u3044\u3046\u8981\u7d20\u304c\u3042\u308a\u3001\u305d\u306e\u4e2d\u306b\u30eb\u30d3\u306e\u958b\u59cb\u4f4d\u7f6e\u3068\u7d42\u4e86\u4f4d\u7f6e\u3092\u793a\u3059 sb\u3001eb \u3068\u3044\u3046\u5024\u304c\u3042\u308b\u306e\u3067\u3059\u304c\u3001\u3053\u306e eb \u306e\u5024\u304c\u6587\u5b57\u5217\u306e\u9577\u3055\u3092\u8d85\u3048\u3066\u3044\u305f\u308a\u3059\u308b\u3068\u300c\u554f\u984c\u304c\u3042\u308b\u300d\u3068\u307f\u306a\u3055\u308c\u3001\u4e0a\u8ff0\u306e\u30a8\u30e9\u30fc\u304c\u8868\u793a\u3055\u308c\u307e\u3059\u3002\n\u4eca\u56de\u306f\u3053\u306e\u554f\u984c\u3092\u56de\u907f\u3059\u308b\u305f\u3081\u3001Excel\u4fdd\u5b58\u6642\u306b <rPh> \u8981\u7d20\u3092\u524a\u9664\u3057\u3066\u3057\u307e\u3046\u3053\u3068\u306b\u3057\u307e\u3057\u305f\u3002 (\u30eb\u30d3\u60c5\u5831\u306f\u305f\u3044\u3057\u3066\u91cd\u8981\u306a\u30c7\u30fc\u30bf\u3067\u306f\u306a\u3044\u306e\u3067)\n\n\u5b8c\u6210\uff01\n\u8a66\u884c\u932f\u8aa4\u3092\u7d4c\u3066\u3001\u3064\u3044\u306b\u6210\u529f\u3057\u307e\u3057\u305f\uff01\n\u4eca\u56de\u66f8\u3044\u305f\u30b3\u30fc\u30c9\u3092\u5b9f\u884c\u3059\u308b\u3068\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306b Excel \u30d5\u30a1\u30a4\u30eb\u306e\u6587\u5b57\u5217\u3092\u7f6e\u63db\u3057\u3066\u5225\u30d5\u30a1\u30a4\u30eb\u540d\u3067\u4fdd\u5b58\u3057\u307e\u3059\u3002\n\n\u3068\u3044\u3046\u308f\u3051\u3067\u3001\u30b3\u30fc\u30c9\u3092\u516c\u958b\u3057\u307e\u3059\u3002\n\nmain.go\npackage main\n\nimport (\n    \"encoding/xml\"\n    \"io\"\n    \"io/ioutil\"\n    \"log\"\n    \"os\"\n    \"strings\"\n\n    \"github.com/mholt/archiver\"\n)\n\ntype Sst struct {\n    Xmlns       string `xml:\"xmlns,attr\"`\n    Count       int    `xml:\"count,attr\"`\n    UniqueCount int    `xml:\"uniqueCount,attr\"`\n    Si          []Si   `xml:\"si\"`\n}\n\n//Si String Item\ntype Si struct {\n    T          string     `xml:\"t\"`\n    R          []R        `xml:\"r\"`\n    RPh        []RPh      `xml:\"rPh\"`\n    PhoneticPr PhoneticPr `xml:\"phoneticPr\"`\n}\ntype R struct {\n    RPr []RPr  `xml:\"rPr\"`\n    T   string `xml:\"t\"`\n}\ntype RPh struct {\n    T  string `xml:\"t\"`\n    Sb int    `xml:\"sb,attr\"` //\u30eb\u30d3\u306e\u958b\u59cb\u4f4d\u7f6e\n    Eb int    `xml:\"eb,attr\"` //\u30eb\u30d3\u306e\u7d42\u4e86\u4f4d\u7f6e\n}\ntype RPr struct {\n    Sz      Sz      `xml:\"sz\"`\n    Color   Color   `xml:\"color\"`\n    RFont   RFont   `xml:\"rFont\"`\n    Family  Family  `xml:\"family\"`\n    CharSet CharSet `xml:\"charSet\"`\n}\ntype PhoneticPr struct {\n    FontId int `xml:\"fontId,attr\"`\n}\ntype Sz struct {\n    Val int `xml:\"val,attr\"`\n}\ntype Color struct {\n    Theme int `xml:\"theme,attr\"`\n}\ntype RFont struct {\n    Val string `xml:\"val,attr\"`\n}\ntype Family struct {\n    Val int `xml:\"val,attr\"`\n}\ntype CharSet struct {\n    Val int `xml:\"val,attr\"`\n}\n\n//SearchText \u6587\u5b57\u5217\u3092\u691c\u7d22\u3057 Si (String Item) \u306e\u5834\u6240\u3092\u8fd4\u3059\nfunc (s Sst) SearchText(text string) int {\n    result := -1\n    target := ``\n    for i, si := range s.Si {\n        target = si.T\n        for _, r := range si.R {\n            target += r.T\n        }\n        if target == text {\n            result = i\n        }\n    }\n\n    return result\n}\n\n//UnMarshal XML\u3092\u5165\u529b\nfunc UnMarshal(xmlDoc []byte) Sst {\n    s := Sst{}\n    xml.Unmarshal(xmlDoc, &s)\n    return s\n}\n\n//Marshal XML\u3092\u51fa\u529b\nfunc (s Sst) Marshal() string {\n\n    xTmp := s\n    for i, si := range s.Si {\n        //\u30eb\u30d3\u60c5\u5831\u3092\u524a\u9664\n        xTmp.Si[i].RPh = []RPh{}\n\n        //\u6587\u5b57\u5217\u304c\u7a7a\u306e\u5834\u5408\u3001R\u8981\u7d20\u3092\u524a\u9664\u3059\u308b\n        xTmp.Si[i].R = []R{}\n        for _, sr := range si.R {\n            if sr.T != `` {\n                xTmp.Si[i].R = append(xTmp.Si[i].R, sr)\n            }\n        }\n    }\n\n    buf, _ := xml.MarshalIndent(xTmp, \"\", \"  \")\n    result := `<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>` + string(buf)\n    result = strings.Replace(result, `<Sst `, \"<sst \", -1)\n    result = strings.Replace(result, `</Sst>`, \"</sst>\", -1)\n\n    return result\n}\n\nconst tmpDir = \"tmp\\\\\"\n\nfunc main() {\n    tmpPath := tmpDir + \"\\\\tmp.xlsx\"\n    srcPath := \"src.xlsx\"\n    dstPath := \"dst.xlsx\"\n\n    srcText := []string{\"Hello\", \"World\"}\n    dstText := []string{\"\u3053\u3093\u306b\u3061\u306f\", \"\u4e16\u754c\"}\n\n    //tmp\u30d5\u30a9\u30eb\u30c0\u4f5c\u6210\n    os.MkdirAll(tmpDir, 0777)\n\n    //\u5143\u306e\u30d5\u30a1\u30a4\u30eb\u3092\u30b3\u30d4\u30fc\u3057 tmp \u306b\u4fdd\u5b58\n    fileCopy(srcPath, tmpPath)\n\n    //tmp\u30d5\u30a1\u30a4\u30eb\u3092zip\u5c55\u958b\n    unzip(tmpPath)\n\n    //\u5c55\u958b\u5f8c\u306esharedStrings.xml \u3092\u66f8\u304d\u63db\u3048\u308b\n    replace(srcText, dstText)\n\n    //zip \u5727\u7e2e\u3057\u3001Excel\u30d5\u30a1\u30a4\u30eb\u3092\u751f\u6210\n    zip(dstPath)\n}\n\nfunc failOnError(err error) {\n    if err != nil {\n        log.Fatal(\"Error:\", err)\n    }\n}\n\n//Excel\u30d5\u30a1\u30a4\u30eb\u3092\u6307\u5b9a\u30d1\u30b9\u306b zip \u5c55\u958b\u3059\u308b\nfunc unzip(filePath string) {\n    archiver.Unzip(filePath, tmpDir)\n}\n\n//XML\u30d5\u30a1\u30a4\u30eb\u7fa4\u3092zip\u5727\u7e2e\u3057\u3001Excel\u30d5\u30a1\u30a4\u30eb\u5316\u3059\u308b\nfunc zip(outputPath string) {\n    archiver.Zip(\n        outputPath,\n        []string{tmpDir + \"_rels\", tmpDir + \"docProps\", tmpDir + \"xl\", tmpDir + \"[Content_Types].xml\"})\n}\n\n//\u6587\u5b57\u5217\u3092\u7f6e\u63db\u3057\u3001\u305d\u306e\u7d50\u679c\u306eExcel\u30d5\u30a1\u30a4\u30eb\u3092\u4fdd\u5b58\u3059\u308b\nfunc replace(srcText []string, dstText []string) {\n    filePath := tmpDir + \"xl\\\\sharedStrings.xml\"\n    bs, err := ioutil.ReadFile(filePath)\n    if err != nil {\n        log.Fatal(err)\n    }\n    x := Sst{}\n    x = UnMarshal(bs)\n\n    var siID int\n\n    for i, s := range srcText {\n        siID = x.SearchText(s)\n\n        if siID >= 0 {\n            for j := range x.Si[siID].R {\n                x.Si[siID].R[j].T = ``\n            }\n            x.Si[siID].T = dstText[i]\n        }\n    }\n\n    s := x.Marshal()\n    ioutil.WriteFile(filePath, []byte(s), os.ModePerm)\n}\n\n//\u30d5\u30a1\u30a4\u30eb\u3092\u6307\u5b9a\u30d1\u30b9\u306b\u30b3\u30d4\u30fc\u3059\u308b\nfunc fileCopy(srcPath, dstPath string) {\n    src, err := os.Open(srcPath)\n    if err != nil {\n        panic(err)\n    }\n    defer src.Close()\n\n    dst, err := os.Create(dstPath)\n    if err != nil {\n        panic(err)\n    }\n    defer dst.Close()\n\n    _, err = io.Copy(dst, src)\n    if err != nil {\n        panic(err)\n    }\n}\n\n\n\n\u7d42\u308f\u308a\u306b\nGo\u8a00\u8a9e\u306b\u306f tealeg/xlsx \u3068\u3044\u3046\u975e\u5e38\u306b\u512a\u308c\u305f Excel \u30e9\u30a4\u30d6\u30e9\u30ea\u304c\u3042\u308b\u306e\u3067\u3001\u901a\u5e38\u306f\u305d\u308c\u3092\u5229\u7528\u3057\u305f\u65b9\u304c\u826f\u3044\u3067\u3057\u3087\u3046\u3002\n\u305f\u3060\u3001\u4eca\u56de\u306e\u3088\u3046\u306b\u6587\u5b57\u5217\u7f6e\u63db\u3060\u3051\u306b\u76ee\u7684\u304c\u9650\u5b9a\u3055\u308c\u3066\u3044\u308b\u5834\u5408\u3001\u81ea\u524d\u3067\u7d44\u3093\u3060\u65b9\u304c tealeg/xlsx \u3092\u4f7f\u3046\u3088\u308a\u9ad8\u901f\u306b\u51e6\u7406\u3067\u304d\u308b\u306e\u3067\u306f\u306a\u3044\u304b\u3068\u601d\u3044\u3001\u30c1\u30e3\u30ec\u30f3\u30b8\u3057\u3066\u307f\u305f\u6b21\u7b2c\u3067\u3059\u3002\n\u305d\u308c\u3067\u306f\u307e\u305f\u3002\n#\u306f\u3058\u3081\u306b\n\n\u7686\u3055\u3093\u3054\u5b58\u77e5\u306e\u901a\u308a Excel 2007 \u4ee5\u964d\u306e Excel \u30d5\u30a1\u30a4\u30eb\u306f Open XML \u898f\u683c\u306b\u6e96\u62e0\u3057\u3066\u304a\u308a\u3001\u305d\u306e\u5b9f\u614b\u306f XML \u30d5\u30a1\u30a4\u30eb\u7fa4\u304c zip \u5727\u7e2e\u3055\u308c\u305f\u3082\u306e\u3067\u3059\u3002\n\nExcel\u30d5\u30a1\u30a4\u30eb\u3092 zip \u5c55\u958b\u3059\u308b\u3068\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u30d5\u30a1\u30a4\u30eb\u7fa4\u304c\u5b58\u5728\u3059\u308b\u306e\u304c\u78ba\u8a8d\u3067\u304d\u307e\u3059\u3002\n\n![a002.png](https://qiita-image-store.s3.amazonaws.com/0/124995/13e2778b-bc68-7559-5c47-f18dbf153718.png)\n\n\nExcel\u306e\u5404\u30bb\u30eb\u306b\u5165\u3063\u3066\u3044\u308b\u6587\u5b57\u5217\u306f\u3001\u5168\u3066 xl/sharedStrings.xml \u3068\u3044\u3046\u30d5\u30a1\u30a4\u30eb\u5185\u306b\u683c\u7d0d\u3055\u308c\u3066\u3044\u307e\u3059\u3002\n\n\u4f8b\u3048\u3070\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306a Excel \u30d5\u30a1\u30a4\u30eb\u304c\u3042\u308b\u3068\u3057\u307e\u3059\u3002\n\n![a004.png](https://qiita-image-store.s3.amazonaws.com/0/124995/f45def50-ab84-062f-e64a-86a7d97312c0.png)\n\n\n\u3053\u306e\u30d5\u30a1\u30a4\u30eb\u3092 zip \u5c55\u958b\u3057\u3066 sharedStrings.xml \u3092\u30a8\u30c7\u30a3\u30bf\u3067\u958b\u304f\u3068\u3001\u4e2d\u8eab\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u306a\u3063\u3066\u3044\u307e\u3059\u3002\n\n![a006.png](https://qiita-image-store.s3.amazonaws.com/0/124995/a24bf0d3-f286-ec0c-10ca-0c56689497dd.png)\n\n\n\u3055\u3066\u3001\u8ce2\u660e\u306a\u7686\u69d8\u306a\u3089\u304a\u5206\u304b\u308a\u3044\u305f\u3060\u3051\u305f\u3068\u601d\u3044\u307e\u3059\u304c\u3001\n\u3082\u3057 Excel\u30d5\u30a1\u30a4\u30eb\u5185\u306e\u6587\u5b57\u5217\u3092\u30d7\u30ed\u30b0\u30e9\u30e0\u3067\u7f6e\u63db\u3057\u305f\u3044\u5834\u5408\n\n(1) Excel\u30d5\u30a1\u30a4\u30eb\u3092 zip \u5c55\u958b\n\u2193\n(2) xl/sharedStrings.xml \u3092\u66f8\u304d\u63db\u3048\n\u2193\n(3) zip \u5727\u7e2e\u3057\u3001\u62e1\u5f35\u5b50\u3092 .xlsx \u306b\u3057\u3066\u4fdd\u5b58\n\n\u3068\u3044\u3046\uff13\u3064\u306e\u51e6\u7406\u3092\u9806\u306b\u884c\u3048\u3070\u3001Excel \u30d5\u30a1\u30a4\u30eb\u5185\u306e\u6587\u5b57\u5217\u3092\u7f6e\u63db\u3067\u304d\u308b\u3068\u3044\u3046\u3053\u3068\u306b\u306a\u308a\u307e\u3059\u3088\u306d\u3002\n\n![a008.png](https://qiita-image-store.s3.amazonaws.com/0/124995/1f16366d-e567-1b71-8abc-bced508ce8c1.png)\n\n\n\n\u3053\u306e\u30ed\u30b8\u30c3\u30af\u306b\u57fa\u3065\u304d\u3001\u3055\u3063\u305d\u304f Go \u8a00\u8a9e\u3067\u5b9f\u88c5\u3057\u3066\u307f\u307e\u3057\u305f\u3002\n\n\u304c\u3001\u3044\u304f\u3064\u304b\u56f0\u96e3\u306b\u3076\u3061\u5f53\u305f\u308a\u307e\u3057\u305f\u306e\u3067\u3001\u305d\u306e\u8a66\u884c\u932f\u8aa4\u3057\u305f\u904e\u7a0b\u3092\u304a\u8a71\u3057\u3057\u307e\u3059\u3002\n\n#\u8a66\u884c\u932f\u8aa4 1\n\n\u4f8b\u3048\u3070\u3001\u300cHello\u300d\u3068\u3044\u3046\u6587\u5b57\u5217\u3092\u300c\u3053\u3093\u306b\u3061\u306f\u300d\u306b\u7f6e\u63db\u3059\u308b\u3068\u3057\u307e\u3059\u3002\n\n\u3053\u308c\u3060\u3051\u306a\u3089\u5358\u7d14\u306b sharedStrings.xml \u3092\u958b\u3044\u3066  **`<t>Hello</t>`**  \u3092  **`<t>\u3053\u3093\u306b\u3061\u306f</t>`**  \u306b\u7f6e\u63db\u3059\u308c\u3070\u826f\u3044\u3060\u3051\u306a\u306e\u3067\u3001\u7c21\u5358\u306b\u5b9f\u88c5\u3067\u304d\u305d\u3046\u3067\u3059\u3002\n\n\u3068\u3053\u308d\u304c\u3053\u306e\u65b9\u6cd5\u3067\u306f\u5bfe\u5fdc\u3067\u304d\u306a\u3044\u30b1\u30fc\u30b9\u304c\u3042\u308a\u307e\u3059\u3002\n\u4f8b\u3048\u3070\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u30bb\u30eb\u5185\u306e\u6587\u5b57\u306e\u30b9\u30bf\u30a4\u30eb\u304c\u8907\u6570\u3042\u308b\u5834\u5408\u3067\u3059\u3002\n\n![a010.png](https://qiita-image-store.s3.amazonaws.com/0/124995/9dd12597-30b9-8ea3-c62e-fd67e0bc9037.png)\n\n\u3053\u306e\u5834\u5408\u3001\u6587\u5b57\u5217\u304c\u30b9\u30bf\u30a4\u30eb\u3054\u3068\u306b `<r>` \u8981\u7d20\u3067\u5206\u5272\u3055\u308c\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\n\n![a012.png](https://qiita-image-store.s3.amazonaws.com/0/124995/c50bf060-36ed-ad39-cf69-9121fcbbba57.png)\n\n\n\u3053\u306e\u3088\u3046\u306a\u30b1\u30fc\u30b9\u3092\u60f3\u5b9a\u3059\u308b\u3068\u3001\u5358\u7d14\u306b xml \u30d5\u30a1\u30a4\u30eb\u5185\u306e\u6587\u5b57\u5217\u3092\u7f6e\u63db\u3059\u308b\u3060\u3051\u3067\u306f\u5bfe\u5fdc\u3067\u304d\u305d\u3046\u306b\u3042\u308a\u307e\u305b\u3093\u3002\u305d\u3053\u3067 \"encoding/xml\" \u30d1\u30c3\u30b1\u30fc\u30b8\u3092\u4f7f\u3044\u3001XML\u3092\u30d1\u30fc\u30b9\u3059\u308b\u3053\u3068\u306b\u3057\u307e\u3057\u305f\u3002\n\n\n#\u8a66\u884c\u932f\u8aa4 2 \u300c\u306a\u3093\u3067 Excel \u3059\u3050\u6b7b\u3093\u3067\u3057\u307e\u3046\u3093\u300d\u554f\u984c\u3078\u306e\u5bfe\u51e6\n\n\u4eca\u56de\u6700\u3082\u60a9\u307e\u3055\u308c\u305f\u306e\u304c\u3053\u308c\u3067\u3059\u3002\nExcel\u30d5\u30a1\u30a4\u30eb\u3092\u751f\u6210\u3057\u305f\u3068\u304d\u306b\u3001\u5c11\u3057\u3067\u3082\u5b9a\u7fa9\u8a2d\u5b9a\u3084\u5024\u3092\u30df\u30b9\u3063\u3066\u3057\u307e\u3046\u3068\u3001Microsoft Excel \u3067\u30d5\u30a1\u30a4\u30eb\u3092\u958b\u3044\u305f\u3068\u304d\u306b\u4ee5\u4e0b\u306e\u30a8\u30e9\u30fc\u304c\u8868\u793a\u3055\u308c\u3066\u3057\u307e\u3046\u306e\u3067\u3059\u3002\n\n![a014.png](https://qiita-image-store.s3.amazonaws.com/0/124995/1db65841-eca2-20c7-3dc0-bc8f63b881a1.png)\n\n![a016.png](https://qiita-image-store.s3.amazonaws.com/0/124995/11eba89e-18bc-d248-f391-4c7008eb1fb0.png)\n\n\u3069\u306e\u3088\u3046\u306a\u72b6\u6cc1\u3067\u3001\u2191 \u306e\u3088\u3046\u306a\u30a8\u30e9\u30fc\u304c\u8868\u793a\u3055\u308c\u308b\u306e\u304b\u3068\u8a00\u3046\u3068\u3001\n\u4f8b\u3048\u3070\u3001sharedStrings.xml \u306b\u306f\u3001\u30eb\u30d3 (\u30d5\u30ea\u30ac\u30ca) \u3092\u683c\u7d0d\u3059\u308b `<rPh>` \u3068\u3044\u3046\u8981\u7d20\u304c\u3042\u308a\u3001\u305d\u306e\u4e2d\u306b\u30eb\u30d3\u306e\u958b\u59cb\u4f4d\u7f6e\u3068\u7d42\u4e86\u4f4d\u7f6e\u3092\u793a\u3059 sb\u3001eb \u3068\u3044\u3046\u5024\u304c\u3042\u308b\u306e\u3067\u3059\u304c\u3001\u3053\u306e eb \u306e\u5024\u304c\u6587\u5b57\u5217\u306e\u9577\u3055\u3092\u8d85\u3048\u3066\u3044\u305f\u308a\u3059\u308b\u3068\u300c\u554f\u984c\u304c\u3042\u308b\u300d\u3068\u307f\u306a\u3055\u308c\u3001\u4e0a\u8ff0\u306e\u30a8\u30e9\u30fc\u304c\u8868\u793a\u3055\u308c\u307e\u3059\u3002\n\n\u4eca\u56de\u306f\u3053\u306e\u554f\u984c\u3092\u56de\u907f\u3059\u308b\u305f\u3081\u3001Excel\u4fdd\u5b58\u6642\u306b `<rPh>` \u8981\u7d20\u3092\u524a\u9664\u3057\u3066\u3057\u307e\u3046\u3053\u3068\u306b\u3057\u307e\u3057\u305f\u3002 (\u30eb\u30d3\u60c5\u5831\u306f\u305f\u3044\u3057\u3066\u91cd\u8981\u306a\u30c7\u30fc\u30bf\u3067\u306f\u306a\u3044\u306e\u3067)\n\n#\u5b8c\u6210\uff01\n\n\u8a66\u884c\u932f\u8aa4\u3092\u7d4c\u3066\u3001\u3064\u3044\u306b\u6210\u529f\u3057\u307e\u3057\u305f\uff01\n\u4eca\u56de\u66f8\u3044\u305f\u30b3\u30fc\u30c9\u3092\u5b9f\u884c\u3059\u308b\u3068\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306b Excel \u30d5\u30a1\u30a4\u30eb\u306e\u6587\u5b57\u5217\u3092\u7f6e\u63db\u3057\u3066\u5225\u30d5\u30a1\u30a4\u30eb\u540d\u3067\u4fdd\u5b58\u3057\u307e\u3059\u3002\n\n![a018.png](https://qiita-image-store.s3.amazonaws.com/0/124995/580e34f5-6e86-7650-e636-0c310846c938.png)\n\n\n\u3068\u3044\u3046\u308f\u3051\u3067\u3001\u30b3\u30fc\u30c9\u3092\u516c\u958b\u3057\u307e\u3059\u3002\n\n\n```main.go\npackage main\n\nimport (\n\t\"encoding/xml\"\n\t\"io\"\n\t\"io/ioutil\"\n\t\"log\"\n\t\"os\"\n\t\"strings\"\n\n\t\"github.com/mholt/archiver\"\n)\n\ntype Sst struct {\n\tXmlns       string `xml:\"xmlns,attr\"`\n\tCount       int    `xml:\"count,attr\"`\n\tUniqueCount int    `xml:\"uniqueCount,attr\"`\n\tSi          []Si   `xml:\"si\"`\n}\n\n//Si String Item\ntype Si struct {\n\tT          string     `xml:\"t\"`\n\tR          []R        `xml:\"r\"`\n\tRPh        []RPh      `xml:\"rPh\"`\n\tPhoneticPr PhoneticPr `xml:\"phoneticPr\"`\n}\ntype R struct {\n\tRPr []RPr  `xml:\"rPr\"`\n\tT   string `xml:\"t\"`\n}\ntype RPh struct {\n\tT  string `xml:\"t\"`\n\tSb int    `xml:\"sb,attr\"` //\u30eb\u30d3\u306e\u958b\u59cb\u4f4d\u7f6e\n\tEb int    `xml:\"eb,attr\"` //\u30eb\u30d3\u306e\u7d42\u4e86\u4f4d\u7f6e\n}\ntype RPr struct {\n\tSz      Sz      `xml:\"sz\"`\n\tColor   Color   `xml:\"color\"`\n\tRFont   RFont   `xml:\"rFont\"`\n\tFamily  Family  `xml:\"family\"`\n\tCharSet CharSet `xml:\"charSet\"`\n}\ntype PhoneticPr struct {\n\tFontId int `xml:\"fontId,attr\"`\n}\ntype Sz struct {\n\tVal int `xml:\"val,attr\"`\n}\ntype Color struct {\n\tTheme int `xml:\"theme,attr\"`\n}\ntype RFont struct {\n\tVal string `xml:\"val,attr\"`\n}\ntype Family struct {\n\tVal int `xml:\"val,attr\"`\n}\ntype CharSet struct {\n\tVal int `xml:\"val,attr\"`\n}\n\n//SearchText \u6587\u5b57\u5217\u3092\u691c\u7d22\u3057 Si (String Item) \u306e\u5834\u6240\u3092\u8fd4\u3059\nfunc (s Sst) SearchText(text string) int {\n\tresult := -1\n\ttarget := ``\n\tfor i, si := range s.Si {\n\t\ttarget = si.T\n\t\tfor _, r := range si.R {\n\t\t\ttarget += r.T\n\t\t}\n\t\tif target == text {\n\t\t\tresult = i\n\t\t}\n\t}\n\n\treturn result\n}\n\n//UnMarshal XML\u3092\u5165\u529b\nfunc UnMarshal(xmlDoc []byte) Sst {\n\ts := Sst{}\n\txml.Unmarshal(xmlDoc, &s)\n\treturn s\n}\n\n//Marshal XML\u3092\u51fa\u529b\nfunc (s Sst) Marshal() string {\n\n\txTmp := s\n\tfor i, si := range s.Si {\n\t\t//\u30eb\u30d3\u60c5\u5831\u3092\u524a\u9664\n\t\txTmp.Si[i].RPh = []RPh{}\n\n\t\t//\u6587\u5b57\u5217\u304c\u7a7a\u306e\u5834\u5408\u3001R\u8981\u7d20\u3092\u524a\u9664\u3059\u308b\n\t\txTmp.Si[i].R = []R{}\n\t\tfor _, sr := range si.R {\n\t\t\tif sr.T != `` {\n\t\t\t\txTmp.Si[i].R = append(xTmp.Si[i].R, sr)\n\t\t\t}\n\t\t}\n\t}\n\n\tbuf, _ := xml.MarshalIndent(xTmp, \"\", \"  \")\n\tresult := `<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>` + string(buf)\n\tresult = strings.Replace(result, `<Sst `, \"<sst \", -1)\n\tresult = strings.Replace(result, `</Sst>`, \"</sst>\", -1)\n\n\treturn result\n}\n\nconst tmpDir = \"tmp\\\\\"\n\nfunc main() {\n\ttmpPath := tmpDir + \"\\\\tmp.xlsx\"\n\tsrcPath := \"src.xlsx\"\n\tdstPath := \"dst.xlsx\"\n\n\tsrcText := []string{\"Hello\", \"World\"}\n\tdstText := []string{\"\u3053\u3093\u306b\u3061\u306f\", \"\u4e16\u754c\"}\n\n\t//tmp\u30d5\u30a9\u30eb\u30c0\u4f5c\u6210\n\tos.MkdirAll(tmpDir, 0777)\n\n\t//\u5143\u306e\u30d5\u30a1\u30a4\u30eb\u3092\u30b3\u30d4\u30fc\u3057 tmp \u306b\u4fdd\u5b58\n\tfileCopy(srcPath, tmpPath)\n\n\t//tmp\u30d5\u30a1\u30a4\u30eb\u3092zip\u5c55\u958b\n\tunzip(tmpPath)\n\n\t//\u5c55\u958b\u5f8c\u306esharedStrings.xml \u3092\u66f8\u304d\u63db\u3048\u308b\n\treplace(srcText, dstText)\n\n\t//zip \u5727\u7e2e\u3057\u3001Excel\u30d5\u30a1\u30a4\u30eb\u3092\u751f\u6210\n\tzip(dstPath)\n}\n\nfunc failOnError(err error) {\n\tif err != nil {\n\t\tlog.Fatal(\"Error:\", err)\n\t}\n}\n\n//Excel\u30d5\u30a1\u30a4\u30eb\u3092\u6307\u5b9a\u30d1\u30b9\u306b zip \u5c55\u958b\u3059\u308b\nfunc unzip(filePath string) {\n\tarchiver.Unzip(filePath, tmpDir)\n}\n\n//XML\u30d5\u30a1\u30a4\u30eb\u7fa4\u3092zip\u5727\u7e2e\u3057\u3001Excel\u30d5\u30a1\u30a4\u30eb\u5316\u3059\u308b\nfunc zip(outputPath string) {\n\tarchiver.Zip(\n\t\toutputPath,\n\t\t[]string{tmpDir + \"_rels\", tmpDir + \"docProps\", tmpDir + \"xl\", tmpDir + \"[Content_Types].xml\"})\n}\n\n//\u6587\u5b57\u5217\u3092\u7f6e\u63db\u3057\u3001\u305d\u306e\u7d50\u679c\u306eExcel\u30d5\u30a1\u30a4\u30eb\u3092\u4fdd\u5b58\u3059\u308b\nfunc replace(srcText []string, dstText []string) {\n\tfilePath := tmpDir + \"xl\\\\sharedStrings.xml\"\n\tbs, err := ioutil.ReadFile(filePath)\n\tif err != nil {\n\t\tlog.Fatal(err)\n\t}\n\tx := Sst{}\n\tx = UnMarshal(bs)\n\n\tvar siID int\n\n\tfor i, s := range srcText {\n\t\tsiID = x.SearchText(s)\n\n\t\tif siID >= 0 {\n\t\t\tfor j := range x.Si[siID].R {\n\t\t\t\tx.Si[siID].R[j].T = ``\n\t\t\t}\n\t\t\tx.Si[siID].T = dstText[i]\n\t\t}\n\t}\n\n\ts := x.Marshal()\n\tioutil.WriteFile(filePath, []byte(s), os.ModePerm)\n}\n\n//\u30d5\u30a1\u30a4\u30eb\u3092\u6307\u5b9a\u30d1\u30b9\u306b\u30b3\u30d4\u30fc\u3059\u308b\nfunc fileCopy(srcPath, dstPath string) {\n\tsrc, err := os.Open(srcPath)\n\tif err != nil {\n\t\tpanic(err)\n\t}\n\tdefer src.Close()\n\n\tdst, err := os.Create(dstPath)\n\tif err != nil {\n\t\tpanic(err)\n\t}\n\tdefer dst.Close()\n\n\t_, err = io.Copy(dst, src)\n\tif err != nil {\n\t\tpanic(err)\n\t}\n}\n```\n\n\n#\u7d42\u308f\u308a\u306b\n\nGo\u8a00\u8a9e\u306b\u306f tealeg/xlsx \u3068\u3044\u3046\u975e\u5e38\u306b\u512a\u308c\u305f Excel \u30e9\u30a4\u30d6\u30e9\u30ea\u304c\u3042\u308b\u306e\u3067\u3001\u901a\u5e38\u306f\u305d\u308c\u3092\u5229\u7528\u3057\u305f\u65b9\u304c\u826f\u3044\u3067\u3057\u3087\u3046\u3002\n\n\u305f\u3060\u3001\u4eca\u56de\u306e\u3088\u3046\u306b\u6587\u5b57\u5217\u7f6e\u63db\u3060\u3051\u306b\u76ee\u7684\u304c\u9650\u5b9a\u3055\u308c\u3066\u3044\u308b\u5834\u5408\u3001\u81ea\u524d\u3067\u7d44\u3093\u3060\u65b9\u304c tealeg/xlsx \u3092\u4f7f\u3046\u3088\u308a\u9ad8\u901f\u306b\u51e6\u7406\u3067\u304d\u308b\u306e\u3067\u306f\u306a\u3044\u304b\u3068\u601d\u3044\u3001\u30c1\u30e3\u30ec\u30f3\u30b8\u3057\u3066\u307f\u305f\u6b21\u7b2c\u3067\u3059\u3002\n\u305d\u308c\u3067\u306f\u307e\u305f\u3002\n", "tags": ["Go", "Excel", "golang", "XML"]}