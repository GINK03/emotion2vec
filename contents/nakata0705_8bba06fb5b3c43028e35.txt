{"context": " More than 1 year has passed since last update.\n\n\u3057\u305f\u3053\u3068\n\nSails\u3067\u3068\u308a\u3042\u3048\u305aPhantomJS\u3067\u30da\u30fc\u30b8\u3092\u3068\u3063\u3066\u307f\u305f\u3002\n\n# sails new landload\n# sails generate api property\n# npm install phantomjs\n\n\nconfig/models.js\nmodule.exports.models = {\n    migrate: 'safe'\n};\n\n\n\ncontrollers/PropertyController.js\nvar phantom = require('phantom');\n\nfunction CreateUrlArray(str) {\n  var array = [];\n\n  str.match(/.*(\\[(\\d+)-(\\d+)\\]).*/);\n\n  if (!RegExp.$1 || !RegExp.$2 || !RegExp.$3) {\n    return array;\n  }\n  else {\n    var replace = RegExp.$1;\n    var start = Number(RegExp.$2);\n    var end = Number(RegExp.$3);\n\n    for (var i = 0; i <= end - start; i++) {\n      array[i] = str.replace(replace, (start + i).toString());\n    }\n    return array;\n  }\n};\n\nfunction updateApi(req, res) {\n  phantom.create(function (ph) {\n    ph.createPage(function (page) {\n      page.open(\"http://www.rakumachi.jp/syuuekibukken/area/prefecture/dimAll/?page=1&limit=100\", function (status) {\n        console.log(\"opened rakumachi? \", status);\n        page.evaluate(function () {\n          return document.body.textContent;\n        }, function (result) {\n          res.json(200, {result: result});\n          ph.exit();\n        });\n      });\n    });\n  });\n};\n\nvar PropertyController = {\n  update: updateApi\n};\n\nmodule.exports = PropertyController;\n\n\n\nmodels/Property.js\nmodule.exports = {\n  attributes: {\n  }\n};\n\n\n\n\u306f\u307e\u3063\u305f\u3053\u3068\n\n\u6700\u65b0\u306e2.0\u7cfb\u5217\u306ePhantomJS\u306f\u307e\u3060npm\u304b\u3089\u306f\u53d6\u308c\u306a\u3044\u306e\u3067\u3001\u53e4\u30441.9\u7cfb\u5217\u3092\u4f7f\u3046\u3053\u3068\u306b\u3057\u305f\u3002\n\n# \u3057\u305f\u3053\u3068\n* Sails\u3067\u3068\u308a\u3042\u3048\u305aPhantomJS\u3067\u30da\u30fc\u30b8\u3092\u3068\u3063\u3066\u307f\u305f\u3002\n\n```\n# sails new landload\n# sails generate api property\n# npm install phantomjs\n```\n\n```js:config/models.js\nmodule.exports.models = {\n    migrate: 'safe'\n};\n```\n\n```js:controllers/PropertyController.js\nvar phantom = require('phantom');\n\nfunction CreateUrlArray(str) {\n  var array = [];\n\n  str.match(/.*(\\[(\\d+)-(\\d+)\\]).*/);\n\n  if (!RegExp.$1 || !RegExp.$2 || !RegExp.$3) {\n    return array;\n  }\n  else {\n    var replace = RegExp.$1;\n    var start = Number(RegExp.$2);\n    var end = Number(RegExp.$3);\n\n    for (var i = 0; i <= end - start; i++) {\n      array[i] = str.replace(replace, (start + i).toString());\n    }\n    return array;\n  }\n};\n\nfunction updateApi(req, res) {\n  phantom.create(function (ph) {\n    ph.createPage(function (page) {\n      page.open(\"http://www.rakumachi.jp/syuuekibukken/area/prefecture/dimAll/?page=1&limit=100\", function (status) {\n        console.log(\"opened rakumachi? \", status);\n        page.evaluate(function () {\n          return document.body.textContent;\n        }, function (result) {\n          res.json(200, {result: result});\n          ph.exit();\n        });\n      });\n    });\n  });\n};\n\nvar PropertyController = {\n  update: updateApi\n};\n\nmodule.exports = PropertyController;\n```\n\n```js:models/Property.js\nmodule.exports = {\n  attributes: {\n  }\n};\n```\n\n# \u306f\u307e\u3063\u305f\u3053\u3068\n* \u6700\u65b0\u306e2.0\u7cfb\u5217\u306ePhantomJS\u306f\u307e\u3060npm\u304b\u3089\u306f\u53d6\u308c\u306a\u3044\u306e\u3067\u3001\u53e4\u30441.9\u7cfb\u5217\u3092\u4f7f\u3046\u3053\u3068\u306b\u3057\u305f\u3002\n", "tags": ["Sails.js", "PhantomJS"]}