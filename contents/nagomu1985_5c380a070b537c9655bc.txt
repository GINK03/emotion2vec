{"tags": ["Apache", "PHP", "MySQL", "http2"], "context": " More than 1 year has passed since last update.\u5fd8\u5099\u9332\n\u3010OS\u3011\n\u4eca\u56de\u306fCentOS7.2_x86_64\u7248\u3092\u4f7f\u7528\u3002\u8a73\u7d30\u306f\u4ee5\u4e0b\u3092\u53c2\u7167\u3002\nhttp://www.server-world.info/query?os=CentOS_7&p=install\n\u4e8b\u524d\u6e96\u5099\n\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\u306b\u5fc5\u8981\u306a\u30d1\u30c3\u30b1\u30fc\u30b8\u3092\u4e8b\u524d\u306b\u8a2d\u5b9a\u3057\u3066\u304a\u304f\u5fc5\u8981\u304c\u3042\u308b\u3002\u4ee5\u4e0b\u3092\u5168\u3066\u8a2d\u5b9a\u3059\u308b\u3002\n\u30b7\u30b9\u30c6\u30e0\u5909\u66f4\u304c\u767a\u751f\u3059\u308b\u306e\u3067\u7ba1\u7406\u8005\u6a29\u9650\u304c\u5fc5\u9808\u3002root\u306bsu\u3057\u3066\u304a\u304f\u4e8b\u3002\n\u3010YUM\u30d1\u30c3\u30b1\u30fc\u30b8\u7ba1\u7406\u3011\nyum -y install yum-plugin-priorities\nyum -y update\nyum -y groupinstall \"Base\" \"Development tools\" \"Japanese Support\"\n[EPEL\u30ea\u30dd\u30b8\u30c8\u30ea\u8ffd\u52a0]\nyum -y install epel-release\n[Remi\u30ea\u30dd\u30b8\u30c8\u30ea\u8ffd\u52a0]\nrpm -ivh http://rpms.famillecollet.com/enterprise/remi-release-7.rpm\n[RPMforge\u30ea\u30dd\u30b8\u30c8\u30ea\u8ffd\u52a0]\nyum -y install http://pkgs.repoforge.org/rpmforge-release/rpmforge-release-0.5.3-1.el7.rf.x86_64.rpm\n\u3010Firewall\u7121\u52b9\u3011\nsystemctl stop firewalld\nsystemctl disable firewalld\n\u3010SELinux\u7121\u52b9\u5316\u3011\nvi /etc/selinux/config\nSELINUX=enforcing \nSELINUX=disabled \u2190\u5909\u66f4(\u8d77\u52d5\u6642\u306b\u7121\u52b9\u306b\u3059\u308b)\n\u3010MySQL\u3011\n\u516c\u5f0f\u30b5\u30a4\u30c8\u3088\u308arpm\u3092\u5165\u624b\u3057\u3066\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\nrpm -ivh http://dev.mysql.com/get/mysql57-community-release-el7-7.noarch.rpm\nyum -y install mysql-community-devel mysql-community-server\n\u8a2d\u5b9a\nvim /etc/my.cnf\n--(\u4ee5\u4e0b\u3092\u6700\u7d42\u884c\u306b\u8ffd\u52a0)---\ndefault_password_lifetime=0\nlog_timestamps=SYSTEM\nexplicit_defaults_for_timestamp=TRUE\nskip-character-set-client-handshake\ncharacter-set-server=utf8\n\n\u8d77\u52d5\u30fb\u81ea\u52d5\u8d77\u52d5\nsystemctl start mysqld\nsystemctl enable mysqld\nroot \u306e\u521d\u671f\u30d1\u30b9\u30ef\u30fc\u30c9\u306e\u78ba\u8a8d\ngrep password /var/log/mysqld.log\nA temporary password is generated for root@localhost: \uff1c\u521d\u671f\u30d1\u30b9\u30ef\u30fc\u30c9\uff1e\n\n\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u8a2d\u5b9a\nmysql_secure_installation\nSecuring the MySQL server deployment.\n\nEnter password for user root: \uff1c\u521d\u671f\u30d1\u30b9\u30ef\u30fc\u30c9\uff1e\n\nThe existing password for the user account root has expired. Please set a new password.\n\nNew password: \uff1c\u30d1\u30b9\u30ef\u30fc\u30c9\uff1e\n\nRe-enter new password: \uff1c\u30d1\u30b9\u30ef\u30fc\u30c9\uff1e\n\nEstimated strength of the password: 100\nChange the password for root ? ((Press y|Y for Yes, any other key for No) : \uff1c\u7a7a\u30a8\u30f3\u30bf\u30fc\uff1e\n\uff08\u7565\uff09\nRemove anonymous users? (Press y|Y for Yes, any other key for No) : y\n\uff08\u7565\uff09\nDisallow root login remotely? (Press y|Y for Yes, any other key for No) : y\n\uff08\u7565\uff09\nRemove test database and access to it? (Press y|Y for Yes, any other key for No) : y\n\uff08\u7565\uff09\nReload privilege tables now? (Press y|Y for Yes, any other key for No) : y\nSuccess.\n\nAll done!\n\n\u3010Apache\u95a2\u9023\u3011\nOpenSSL 1.0.2\nyum -y install zlib-devel\ncd /usr/local/src/\nwget https://www.openssl.org/source/openssl-1.0.2e.tar.gz\ntar xvzf openssl-1.0.2e.tar.gz\ncd openssl-1.0.2e/\n./config --prefix=/usr/local/openssl-1.0.2e shared zlib\nmake\nmake test\nmake install\necho /usr/local/openssl-1.0.2e/lib > /etc/ld.so.conf.d/openssl102e.conf\nldconfig\n\nNghttp2\nyum -y install libev-devel\ncd /usr/local/src/\nwget https://github.com/tatsuhiro-t/nghttp2/releases/download/v1.6.0/nghttp2-1.6.0.tar.gz\ntar xvzf nghttp2-1.6.0.tar.gz\ncd nghttp2-1.6.0/\nautoreconf -i\nautomake\nautoconf\nenv OPENSSL_CFLAGS=\"-I/usr/local/openssl-1.0.2e/include\" OPENSSL_LIBS=\"-L/usr/local/openssl-1.0.2e/lib -lssl -lcrypto\" ./configure\nmake\nmake install\necho /usr/local/lib > /etc/ld.so.conf.d/usr-local-lib.conf\nldconfig\n\nARP\ncd /usr/local/src/\nwget http://ftp.riken.jp/net/apache//apr/apr-1.5.2.tar.gz\ntar xvzf apr-1.5.2.tar.gz\ncd apr-1.5.2/\n./configure\nmake\nmake install\n\nARP-util\ncd /usr/local/src/\nwget http://ftp.riken.jp/net/apache//apr/apr-util-1.5.4.tar.gz\ntar xvzf apr-util-1.5.4.tar.gz\ncd apr-util-1.5.4/\n./configure --with-apr=/usr/local/apr\nmake\nmake install\n\nPCRE\nyum -y install pcre-devel\nApache 2.4.18\ncd /usr/local/src/\nwget http://ftp.jaist.ac.jp/pub/apache//httpd/httpd-2.4.18.tar.gz\ntar xvzf httpd-2.4.18.tar.gz\ncd httpd-2.4.18/\n\n./configure \\\n--enable-http2 \\\n--enable-ssl \\\n--with-ssl=/usr/local/openssl-1.0.2e \\\n--enable-so \\\n--enable-mods-shared=all \\\n--enable-mpms-shared=all\n\nmake\nmake install\n\n\u3010PHP\u95a2\u9023\u3011\n\u4f9d\u5b58\u30d1\u30c3\u30b1\u30fc\u30b8\nyum -y install \\\nlibxml2-devel \\\nopenssl-devel \\\nfreetype-devel \\\nlibcurl-devel \\\nnet-snmp-devel \\\nlibpng-devel \\\nlibjpeg-turbo-devel \\\nopenldap-devel \\\nlibmcrypt-devel \\\nreadline-devel \\\ngd-devel \\\nbzip2-devel \\\nlibicu-devel \\\nlibwebp-devel \\\ngmp-devel \\\nlibtidy-devel \\\nlibxslt-devel\n\n\u672c\u4f53\ncd /usr/local/src/\nwget https://github.com/php/php-src/archive/php-7.0.1.tar.gz\ntar xvzf php-7.0.1.tar.gz\ncd php-src-php-7.0.1/\n\n./buildconf --force\n\n./configure \\\n--with-libdir=lib64 \\\n--with-pic \\\n--with-bz2 \\\n--with-freetype-dir \\\n--with-png-dir \\\n--with-xpm-dir \\\n--enable-gd-native-ttf \\\n--with-gettext \\\n--with-gmp \\\n--with-iconv \\\n--with-jpeg-dir \\\n--with-curl \\\n--with-webp-dir \\\n--with-png-dir \\\n--with-openssl \\\n--with-pcre-regex \\\n--with-zlib \\\n--with-layout=GNU \\\n--enable-exif \\\n--enable-ftp \\\n--enable-sockets \\\n--with-kerberos \\\n--enable-shmop \\\n--enable-calendar \\\n--with-libxml-dir \\\n--with-mhash \\\n--with-ldap \\\n--with-readline \\\n--with-snmp \\\n--with-tidy \\\n--with-xsl \\\n--with-gnu-ld \\\n--enable-mysqlnd \\\n--with-mysqli=mysqlnd \\\n--with-pdo-mysql=mysqlnd \\\n--with-mysql-sock=/var/lib/mysql/mysql.sock \\\n--enable-mbstring \\\n--with-mcrypt \\\n--with-gd \\\n--with-apxs2=/usr/local/apache2/bin/apxs\n\nmake\nmake test\nmake install\n\n\u3010yum\u7248\u3011\n\u53c2\u7167\nhttps://webtatic.com/packages/php70/\nrpm -Uvh https://dl.fedoraproject.org/pub/epel/epel-release-latest-7.noarch.rpm\nrpm -Uvh https://mirror.webtatic.com/yum/el7/webtatic-release.rpm\nyum install php70w php70w-common php70w-opcache php70w-cli php70w-mbstring php70w-mysql\n\n\u8a2d\u5b9a\ncp -ip /usr/local/src/php-src-php-7.0.1/php.ini-production /usr/local/etc/php.ini\nmkdir /var/log/php\nchown daemon /var/log/php\nchmod 755 /var/log/php\n\nvim /usr/local/etc/php.ini\nexpose_php = On\n\u3000\u2193\nexpose_php = Off\n\n;date.timezone =\n\u3000\u2193\ndate.timezone = 'Asia/Tokyo'\n\n;error_log = php_errors.log\n\u3000\u2193\nerror_log = \"/var/log/php/php_errors.log\"\n\nApache\u8a2d\u5b9a\nvim /etc/profile\nPATH=$PATH:/usr/local/apache2/bin\n\nsource /etc/profile\nmv -i /usr/local/apache2/conf/httpd.conf /usr/local/apache2/conf/httpd.conf.org\nvim /usr/local/apache2/conf/httpd.conf\n\nServerTokens Prod\nServerSignature Off\nHostnameLookups Off\nServerRoot \"/usr/local/apache2\"\nTimeout 120\nKeepAlive On\nMaxKeepAliveRequests 1000\nKeepAliveTimeout 1\nListen 80\nUser daemon\nGroup daemon\nServerAdmin root@localhost\nServerName localhost:80\n\nLoadModule authn_file_module modules/mod_authn_file.so\n\"#LoadModule authn_dbm_module modules/mod_authn_dbm.so\"\n\"#LoadModule authn_anon_module modules/mod_authn_anon.so\"\n\"#LoadModule authn_dbd_module modules/mod_authn_dbd.so\"\n\"#LoadModule authn_socache_module modules/mod_authn_socache.so\"\nLoadModule authn_core_module modules/mod_authn_core.so\nLoadModule authz_host_module modules/mod_authz_host.so\nLoadModule authz_groupfile_module modules/mod_authz_groupfile.so\nLoadModule authz_user_module modules/mod_authz_user.so\n\"#LoadModule authz_dbm_module modules/mod_authz_dbm.so\"\n\"#LoadModule authz_owner_module modules/mod_authz_owner.so\"\n\"#LoadModule authz_dbd_module modules/mod_authz_dbd.so\"\nLoadModule authz_core_module modules/mod_authz_core.so\nLoadModule access_compat_module modules/mod_access_compat.so\nLoadModule auth_basic_module modules/mod_auth_basic.so\n\"#LoadModule auth_form_module modules/mod_auth_form.so\"\n\"#LoadModule auth_digest_module modules/mod_auth_digest.so\"\n\"#LoadModule allowmethods_module modules/mod_allowmethods.so\"\n\"#LoadModule file_cache_module modules/mod_file_cache.so\"\n\"#LoadModule cache_module modules/mod_cache.so\"\n\"#LoadModule cache_disk_module modules/mod_cache_disk.so\"\n\"#LoadModule cache_socache_module modules/mod_cache_socache.so\"\nLoadModule socache_shmcb_module modules/mod_socache_shmcb.so\n\"#LoadModule socache_dbm_module modules/mod_socache_dbm.so\"\n\"#LoadModule socache_memcache_module modules/mod_socache_memcache.so\"\n\"#LoadModule watchdog_module modules/mod_watchdog.so\"\n\"#LoadModule macro_module modules/mod_macro.so\"\n\"#LoadModule dbd_module modules/mod_dbd.so\"\n\"#LoadModule dumpio_module modules/mod_dumpio.so\"\n\"#LoadModule echo_module modules/mod_echo.so\"\n\"#LoadModule buffer_module modules/mod_buffer.so\"\n\"#LoadModule data_module modules/mod_data.so\"\n\"#LoadModule ratelimit_module modules/mod_ratelimit.so\"\nLoadModule reqtimeout_module modules/mod_reqtimeout.so\n\"#LoadModule ext_filter_module modules/mod_ext_filter.so\"\n\"#LoadModule request_module modules/mod_request.so\"\n\"#LoadModule include_module modules/mod_include.so\"\nLoadModule filter_module modules/mod_filter.so\n\"#LoadModule reflector_module modules/mod_reflector.so\"\n\"#LoadModule substitute_module modules/mod_substitute.so\"\n\"#LoadModule sed_module modules/mod_sed.so\"\n\"#LoadModule charset_lite_module modules/mod_charset_lite.so\"\n\"#LoadModule deflate_module modules/mod_deflate.so\"\nLoadModule mime_module modules/mod_mime.so\nLoadModule http2_module modules/mod_http2.so\nLoadModule log_config_module modules/mod_log_config.so\n\"#LoadModule log_debug_module modules/mod_log_debug.so\"\n\"#LoadModule log_forensic_module modules/mod_log_forensic.so\"\n\"#LoadModule logio_module modules/mod_logio.so\"\nLoadModule env_module modules/mod_env.so\n\"#LoadModule mime_magic_module modules/mod_mime_magic.so\"\n\"#LoadModule expires_module modules/mod_expires.so\"\nLoadModule headers_module modules/mod_headers.so\n\"#LoadModule usertrack_module modules/mod_usertrack.so\"\n\"#LoadModule unique_id_module modules/mod_unique_id.so\"\nLoadModule setenvif_module modules/mod_setenvif.so\nLoadModule version_module modules/mod_version.so\n\"#LoadModule remoteip_module modules/mod_remoteip.so\"\n\"#LoadModule proxy_module modules/mod_proxy.so\"\n\"#LoadModule proxy_connect_module modules/mod_proxy_connect.so\"\n\"#LoadModule proxy_ftp_module modules/mod_proxy_ftp.so\"\n\"#LoadModule proxy_http_module modules/mod_proxy_http.so\"\n\"#LoadModule proxy_fcgi_module modules/mod_proxy_fcgi.so\"\n\"#LoadModule proxy_scgi_module modules/mod_proxy_scgi.so\"\n\"#LoadModule proxy_fdpass_module modules/mod_proxy_fdpass.so\"\n\"#LoadModule proxy_wstunnel_module modules/mod_proxy_wstunnel.so\"\n\"#LoadModule proxy_ajp_module modules/mod_proxy_ajp.so\"\n\"#LoadModule proxy_balancer_module modules/mod_proxy_balancer.so\"\n\"#LoadModule proxy_express_module modules/mod_proxy_express.so\"\n\"#LoadModule session_module modules/mod_session.so\"\n\"#LoadModule session_cookie_module modules/mod_session_cookie.so\"\n\"#LoadModule session_dbd_module modules/mod_session_dbd.so\"\n\"#LoadModule slotmem_shm_module modules/mod_slotmem_shm.so\"\n\"#LoadModule slotmem_plain_module modules/mod_slotmem_plain.so\"\nLoadModule ssl_module modules/mod_ssl.so\n\"#LoadModule dialup_module modules/mod_dialup.so\"\n\"#LoadModule lbmethod_byrequests_module modules/mod_lbmethod_byrequests.so\"\n\"#LoadModule lbmethod_bytraffic_module modules/mod_lbmethod_bytraffic.so\"\n\"#LoadModule lbmethod_bybusyness_module modules/mod_lbmethod_bybusyness.so\"\n\"#LoadModule lbmethod_heartbeat_module modules/mod_lbmethod_heartbeat.so\"\n\"#LoadModule mpm_event_module modules/mod_mpm_event.so\"\nLoadModule mpm_prefork_module modules/mod_mpm_prefork.so\n\"#LoadModule mpm_worker_module modules/mod_mpm_worker.so\"\nLoadModule unixd_module modules/mod_unixd.so\n\"#LoadModule heartbeat_module modules/mod_heartbeat.so\"\n\"#LoadModule heartmonitor_module modules/mod_heartmonitor.so\"\n\"#LoadModule dav_module modules/mod_dav.so\"\nLoadModule status_module modules/mod_status.so\nLoadModule autoindex_module modules/mod_autoindex.so\n\"#LoadModule asis_module modules/mod_asis.so\"\n\"#LoadModule info_module modules/mod_info.so\"\n\"#LoadModule cgid_module modules/mod_cgid.so\"\n\"#LoadModule dav_fs_module modules/mod_dav_fs.so\"\n\"#LoadModule dav_lock_module modules/mod_dav_lock.so\"\n\"#LoadModule vhost_alias_module modules/mod_vhost_alias.so\"\n\"#LoadModule negotiation_module modules/mod_negotiation.so\"\nLoadModule dir_module modules/mod_dir.so\n\"#LoadModule actions_module modules/mod_actions.so\"\n\"#LoadModule speling_module modules/mod_speling.so\"\n\"#LoadModule userdir_module modules/mod_userdir.so\"\nLoadModule alias_module modules/mod_alias.so\n\"#LoadModule rewrite_module modules/mod_rewrite.so\"\nLoadModule php7_module        modules/libphp7.so\n\n\n    AllowOverride none\n    Require all denied\n\n\n\n    DirectoryIndex index.php index.html\n\n\n\n    Require all denied\n\n\nErrorLog \"logs/error_log\"\nLogLevel warn\n\n    LogFormat \"%h %l %u %t \\\"%r\\\" %>s %b \\\"%{Referer}i\\\" \\\"%{User-Agent}i\\\"\" combined\n    LogFormat \"%h %l %u %t \\\"%r\\\" %>s %b\" common\n    \n      LogFormat \"%h %l %u %t \\\"%r\\\" %>s %b \\\"%{Referer}i\\\" \\\"%{User-Agent}i\\\" %I %O\" combinedio\n    \n    CustomLog \"logs/access_log\" combined\n\n\n\n    TypesConfig conf/mime.types\n    AddType application/x-compress .Z\n    AddType application/x-gzip .gz .tgz\n\n\n\n    MIMEMagicFile conf/magic\n\n\n\n    SetHandler application/x-httpd-php\n\nAddType text/html .php\n\n\"# Include conf/extra/httpd-ssl.conf\"\n\n\n    ServerName example.com\n    DocumentRoot \"/usr/local/apache2/htdocs\"\n\n<Directory \"/usr/local/apache2/htdocs\">\n    Options FollowSymLinks\n    AllowOverride None\n    Require all granted\n</Directory>\n\nErrorLog \"logs/error_log\"\nCustomLog \"logs/access_log\" combined\n\n\n\n\n\u8d77\u52d5\u30b9\u30af\u30ea\u30d7\u30c8\ncp -ip /usr/local/src/httpd-2.4.18/build/rpm/httpd.init /etc/rc.d/init.d/httpd\nvim /etc/rc.d/init.d/httpd\n(60\u884c\u76ee\u3042\u305f\u308a)\nhttpd=${HTTPD-/usr/sbin/httpd}\npidfile=${PIDFILE-/var/run/${prog}.pid}\nlockfile=${LOCKFILE-/var/lock/subsys/${prog}}\n\u3000\u2193\nhttpd=${HTTPD-/usr/local/apache2/bin/httpd}\npidfile=${PIDFILE-/usr/local/apache2/logs/${prog}.pid}\nlockfile=${LOCKFILE-/usr/local/apache2/logs/${prog}}\n\nCONFFILE=/etc/httpd/conf/httpd.conf\n\u3000\u2193\nCONFFILE=/usr/local/apache2/conf/httpd.conf\n\n\u8d77\u52d5\u30fb\u81ea\u52d5\u8d77\u52d5\nchkconfig --add httpd\nchkconfig --list | grep httpd\nchkconfig httpd on\napachectl start\n\n\uff0a\u6ce8\u610f\uff1a\u300cservice httpd start\u300d\u3084\u300c/etc/init.d/httpd start\u300d\u3092\u5b9f\u884c\u3059\u308b\u3068 \nsystemd \u306b\u51e6\u7406\u304c\u6e21\u3063\u3066\u3057\u307e\u3044\u3001Apache \u304c\u8d77\u52d5\u3067\u304d\u307e\u305b\u3093\u3002\n\u624b\u52d5\u3067\u306e\u8d77\u52d5\u3084\u505c\u6b62\u306f\u300capachectl\u300d\u3092\u4f7f\u3044\u307e\u3059\u3002\n\u5fd8\u5099\u9332\n\u3010OS\u3011\n\u4eca\u56de\u306fCentOS7.2_x86_64\u7248\u3092\u4f7f\u7528\u3002\u8a73\u7d30\u306f\u4ee5\u4e0b\u3092\u53c2\u7167\u3002\nhttp://www.server-world.info/query?os=CentOS_7&p=install\n\u4e8b\u524d\u6e96\u5099\n\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\u306b\u5fc5\u8981\u306a\u30d1\u30c3\u30b1\u30fc\u30b8\u3092\u4e8b\u524d\u306b\u8a2d\u5b9a\u3057\u3066\u304a\u304f\u5fc5\u8981\u304c\u3042\u308b\u3002\u4ee5\u4e0b\u3092\u5168\u3066\u8a2d\u5b9a\u3059\u308b\u3002\n\u30b7\u30b9\u30c6\u30e0\u5909\u66f4\u304c\u767a\u751f\u3059\u308b\u306e\u3067\u7ba1\u7406\u8005\u6a29\u9650\u304c\u5fc5\u9808\u3002root\u306bsu\u3057\u3066\u304a\u304f\u4e8b\u3002\n\u3010YUM\u30d1\u30c3\u30b1\u30fc\u30b8\u7ba1\u7406\u3011\nyum -y install yum-plugin-priorities\nyum -y update\nyum -y groupinstall \"Base\" \"Development tools\" \"Japanese Support\"\n[EPEL\u30ea\u30dd\u30b8\u30c8\u30ea\u8ffd\u52a0]\nyum -y install epel-release\n[Remi\u30ea\u30dd\u30b8\u30c8\u30ea\u8ffd\u52a0]\nrpm -ivh http://rpms.famillecollet.com/enterprise/remi-release-7.rpm\n[RPMforge\u30ea\u30dd\u30b8\u30c8\u30ea\u8ffd\u52a0]\nyum -y install http://pkgs.repoforge.org/rpmforge-release/rpmforge-release-0.5.3-1.el7.rf.x86_64.rpm\n\u3010Firewall\u7121\u52b9\u3011\nsystemctl stop firewalld\nsystemctl disable firewalld\n\u3010SELinux\u7121\u52b9\u5316\u3011\nvi /etc/selinux/config\nSELINUX=enforcing \nSELINUX=disabled \u2190\u5909\u66f4(\u8d77\u52d5\u6642\u306b\u7121\u52b9\u306b\u3059\u308b)\n\n\u3010MySQL\u3011\n\u516c\u5f0f\u30b5\u30a4\u30c8\u3088\u308arpm\u3092\u5165\u624b\u3057\u3066\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\nrpm -ivh http://dev.mysql.com/get/mysql57-community-release-el7-7.noarch.rpm\nyum -y install mysql-community-devel mysql-community-server\n\u8a2d\u5b9a\nvim /etc/my.cnf\n--(\u4ee5\u4e0b\u3092\u6700\u7d42\u884c\u306b\u8ffd\u52a0)---\n<pre>\ndefault_password_lifetime=0\nlog_timestamps=SYSTEM\nexplicit_defaults_for_timestamp=TRUE\nskip-character-set-client-handshake\ncharacter-set-server=utf8\n</pre>\n\n\u8d77\u52d5\u30fb\u81ea\u52d5\u8d77\u52d5\nsystemctl start mysqld\nsystemctl enable mysqld\n\nroot \u306e\u521d\u671f\u30d1\u30b9\u30ef\u30fc\u30c9\u306e\u78ba\u8a8d\ngrep password /var/log/mysqld.log\n<pre>\nA temporary password is generated for root@localhost: \uff1c\u521d\u671f\u30d1\u30b9\u30ef\u30fc\u30c9\uff1e\n</pre>\n\n\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u8a2d\u5b9a\nmysql_secure_installation\n<pre>\nSecuring the MySQL server deployment.\n \nEnter password for user root: \uff1c\u521d\u671f\u30d1\u30b9\u30ef\u30fc\u30c9\uff1e\n \nThe existing password for the user account root has expired. Please set a new password.\n \nNew password: \uff1c\u30d1\u30b9\u30ef\u30fc\u30c9\uff1e\n \nRe-enter new password: \uff1c\u30d1\u30b9\u30ef\u30fc\u30c9\uff1e\n \nEstimated strength of the password: 100\nChange the password for root ? ((Press y|Y for Yes, any other key for No) : \uff1c\u7a7a\u30a8\u30f3\u30bf\u30fc\uff1e\n\uff08\u7565\uff09\nRemove anonymous users? (Press y|Y for Yes, any other key for No) : y\n\uff08\u7565\uff09\nDisallow root login remotely? (Press y|Y for Yes, any other key for No) : y\n\uff08\u7565\uff09\nRemove test database and access to it? (Press y|Y for Yes, any other key for No) : y\n\uff08\u7565\uff09\nReload privilege tables now? (Press y|Y for Yes, any other key for No) : y\nSuccess.\n \nAll done!\n</pre>\n\n\u3010Apache\u95a2\u9023\u3011\nOpenSSL 1.0.2\nyum -y install zlib-devel\n<pre>\ncd /usr/local/src/\nwget https://www.openssl.org/source/openssl-1.0.2e.tar.gz\ntar xvzf openssl-1.0.2e.tar.gz\ncd openssl-1.0.2e/\n./config --prefix=/usr/local/openssl-1.0.2e shared zlib\nmake\nmake test\nmake install\necho /usr/local/openssl-1.0.2e/lib > /etc/ld.so.conf.d/openssl102e.conf\nldconfig\n</pre>\n\nNghttp2\nyum -y install libev-devel\n<pre>\ncd /usr/local/src/\nwget https://github.com/tatsuhiro-t/nghttp2/releases/download/v1.6.0/nghttp2-1.6.0.tar.gz\ntar xvzf nghttp2-1.6.0.tar.gz\ncd nghttp2-1.6.0/\nautoreconf -i\nautomake\nautoconf\nenv OPENSSL_CFLAGS=\"-I/usr/local/openssl-1.0.2e/include\" OPENSSL_LIBS=\"-L/usr/local/openssl-1.0.2e/lib -lssl -lcrypto\" ./configure\nmake\nmake install\necho /usr/local/lib > /etc/ld.so.conf.d/usr-local-lib.conf\nldconfig\n</pre>\n\nARP\n<pre>\ncd /usr/local/src/\nwget http://ftp.riken.jp/net/apache//apr/apr-1.5.2.tar.gz\ntar xvzf apr-1.5.2.tar.gz\ncd apr-1.5.2/\n./configure\nmake\nmake install\n</pre>\n\nARP-util\n<pre>\ncd /usr/local/src/\nwget http://ftp.riken.jp/net/apache//apr/apr-util-1.5.4.tar.gz\ntar xvzf apr-util-1.5.4.tar.gz\ncd apr-util-1.5.4/\n./configure --with-apr=/usr/local/apr\nmake\nmake install\n</pre>\n\nPCRE\nyum -y install pcre-devel\n\nApache 2.4.18\n<pre>\ncd /usr/local/src/\nwget http://ftp.jaist.ac.jp/pub/apache//httpd/httpd-2.4.18.tar.gz\ntar xvzf httpd-2.4.18.tar.gz\ncd httpd-2.4.18/\n \n./configure \\\n--enable-http2 \\\n--enable-ssl \\\n--with-ssl=/usr/local/openssl-1.0.2e \\\n--enable-so \\\n--enable-mods-shared=all \\\n--enable-mpms-shared=all\n \nmake\nmake install\n</pre>\n\n\u3010PHP\u95a2\u9023\u3011\n\u4f9d\u5b58\u30d1\u30c3\u30b1\u30fc\u30b8\n<pre>\nyum -y install \\\nlibxml2-devel \\\nopenssl-devel \\\nfreetype-devel \\\nlibcurl-devel \\\nnet-snmp-devel \\\nlibpng-devel \\\nlibjpeg-turbo-devel \\\nopenldap-devel \\\nlibmcrypt-devel \\\nreadline-devel \\\ngd-devel \\\nbzip2-devel \\\nlibicu-devel \\\nlibwebp-devel \\\ngmp-devel \\\nlibtidy-devel \\\nlibxslt-devel\n</pre>\n\n\u672c\u4f53\n<pre>\ncd /usr/local/src/\nwget https://github.com/php/php-src/archive/php-7.0.1.tar.gz\ntar xvzf php-7.0.1.tar.gz\ncd php-src-php-7.0.1/\n \n./buildconf --force\n \n./configure \\\n--with-libdir=lib64 \\\n--with-pic \\\n--with-bz2 \\\n--with-freetype-dir \\\n--with-png-dir \\\n--with-xpm-dir \\\n--enable-gd-native-ttf \\\n--with-gettext \\\n--with-gmp \\\n--with-iconv \\\n--with-jpeg-dir \\\n--with-curl \\\n--with-webp-dir \\\n--with-png-dir \\\n--with-openssl \\\n--with-pcre-regex \\\n--with-zlib \\\n--with-layout=GNU \\\n--enable-exif \\\n--enable-ftp \\\n--enable-sockets \\\n--with-kerberos \\\n--enable-shmop \\\n--enable-calendar \\\n--with-libxml-dir \\\n--with-mhash \\\n--with-ldap \\\n--with-readline \\\n--with-snmp \\\n--with-tidy \\\n--with-xsl \\\n--with-gnu-ld \\\n--enable-mysqlnd \\\n--with-mysqli=mysqlnd \\\n--with-pdo-mysql=mysqlnd \\\n--with-mysql-sock=/var/lib/mysql/mysql.sock \\\n--enable-mbstring \\\n--with-mcrypt \\\n--with-gd \\\n--with-apxs2=/usr/local/apache2/bin/apxs\n \nmake\nmake test\nmake install\n</pre>\n\n\u3010yum\u7248\u3011\n\u53c2\u7167\nhttps://webtatic.com/packages/php70/\n<pre>\nrpm -Uvh https://dl.fedoraproject.org/pub/epel/epel-release-latest-7.noarch.rpm\nrpm -Uvh https://mirror.webtatic.com/yum/el7/webtatic-release.rpm\nyum install php70w php70w-common php70w-opcache php70w-cli php70w-mbstring php70w-mysql  \n</pre>\n\n\u8a2d\u5b9a\n<pre>\ncp -ip /usr/local/src/php-src-php-7.0.1/php.ini-production /usr/local/etc/php.ini\nmkdir /var/log/php\nchown daemon /var/log/php\nchmod 755 /var/log/php\n</pre>\n\nvim /usr/local/etc/php.ini\n<pre>\nexpose_php = On\n\u3000\u2193\nexpose_php = Off\n \n;date.timezone =\n\u3000\u2193\ndate.timezone = 'Asia/Tokyo'\n \n;error_log = php_errors.log\n\u3000\u2193\nerror_log = \"/var/log/php/php_errors.log\"\n</pre>\n\nApache\u8a2d\u5b9a\nvim /etc/profile\n<pre>\nPATH=$PATH:/usr/local/apache2/bin\n</pre>\nsource /etc/profile\nmv -i /usr/local/apache2/conf/httpd.conf /usr/local/apache2/conf/httpd.conf.org\nvim /usr/local/apache2/conf/httpd.conf\n<pre>\nServerTokens Prod\nServerSignature Off\nHostnameLookups Off\nServerRoot \"/usr/local/apache2\"\nTimeout 120\nKeepAlive On\nMaxKeepAliveRequests 1000\nKeepAliveTimeout 1\nListen 80\nUser daemon\nGroup daemon\nServerAdmin root@localhost\nServerName localhost:80\n\nLoadModule authn_file_module modules/mod_authn_file.so\n\"#LoadModule authn_dbm_module modules/mod_authn_dbm.so\"\n\"#LoadModule authn_anon_module modules/mod_authn_anon.so\"\n\"#LoadModule authn_dbd_module modules/mod_authn_dbd.so\"\n\"#LoadModule authn_socache_module modules/mod_authn_socache.so\"\nLoadModule authn_core_module modules/mod_authn_core.so\nLoadModule authz_host_module modules/mod_authz_host.so\nLoadModule authz_groupfile_module modules/mod_authz_groupfile.so\nLoadModule authz_user_module modules/mod_authz_user.so\n\"#LoadModule authz_dbm_module modules/mod_authz_dbm.so\"\n\"#LoadModule authz_owner_module modules/mod_authz_owner.so\"\n\"#LoadModule authz_dbd_module modules/mod_authz_dbd.so\"\nLoadModule authz_core_module modules/mod_authz_core.so\nLoadModule access_compat_module modules/mod_access_compat.so\nLoadModule auth_basic_module modules/mod_auth_basic.so\n\"#LoadModule auth_form_module modules/mod_auth_form.so\"\n\"#LoadModule auth_digest_module modules/mod_auth_digest.so\"\n\"#LoadModule allowmethods_module modules/mod_allowmethods.so\"\n\"#LoadModule file_cache_module modules/mod_file_cache.so\"\n\"#LoadModule cache_module modules/mod_cache.so\"\n\"#LoadModule cache_disk_module modules/mod_cache_disk.so\"\n\"#LoadModule cache_socache_module modules/mod_cache_socache.so\"\nLoadModule socache_shmcb_module modules/mod_socache_shmcb.so\n\"#LoadModule socache_dbm_module modules/mod_socache_dbm.so\"\n\"#LoadModule socache_memcache_module modules/mod_socache_memcache.so\"\n\"#LoadModule watchdog_module modules/mod_watchdog.so\"\n\"#LoadModule macro_module modules/mod_macro.so\"\n\"#LoadModule dbd_module modules/mod_dbd.so\"\n\"#LoadModule dumpio_module modules/mod_dumpio.so\"\n\"#LoadModule echo_module modules/mod_echo.so\"\n\"#LoadModule buffer_module modules/mod_buffer.so\"\n\"#LoadModule data_module modules/mod_data.so\"\n\"#LoadModule ratelimit_module modules/mod_ratelimit.so\"\nLoadModule reqtimeout_module modules/mod_reqtimeout.so\n\"#LoadModule ext_filter_module modules/mod_ext_filter.so\"\n\"#LoadModule request_module modules/mod_request.so\"\n\"#LoadModule include_module modules/mod_include.so\"\nLoadModule filter_module modules/mod_filter.so\n\"#LoadModule reflector_module modules/mod_reflector.so\"\n\"#LoadModule substitute_module modules/mod_substitute.so\"\n\"#LoadModule sed_module modules/mod_sed.so\"\n\"#LoadModule charset_lite_module modules/mod_charset_lite.so\"\n\"#LoadModule deflate_module modules/mod_deflate.so\"\nLoadModule mime_module modules/mod_mime.so\nLoadModule http2_module modules/mod_http2.so\nLoadModule log_config_module modules/mod_log_config.so\n\"#LoadModule log_debug_module modules/mod_log_debug.so\"\n\"#LoadModule log_forensic_module modules/mod_log_forensic.so\"\n\"#LoadModule logio_module modules/mod_logio.so\"\nLoadModule env_module modules/mod_env.so\n\"#LoadModule mime_magic_module modules/mod_mime_magic.so\"\n\"#LoadModule expires_module modules/mod_expires.so\"\nLoadModule headers_module modules/mod_headers.so\n\"#LoadModule usertrack_module modules/mod_usertrack.so\"\n\"#LoadModule unique_id_module modules/mod_unique_id.so\"\nLoadModule setenvif_module modules/mod_setenvif.so\nLoadModule version_module modules/mod_version.so\n\"#LoadModule remoteip_module modules/mod_remoteip.so\"\n\"#LoadModule proxy_module modules/mod_proxy.so\"\n\"#LoadModule proxy_connect_module modules/mod_proxy_connect.so\"\n\"#LoadModule proxy_ftp_module modules/mod_proxy_ftp.so\"\n\"#LoadModule proxy_http_module modules/mod_proxy_http.so\"\n\"#LoadModule proxy_fcgi_module modules/mod_proxy_fcgi.so\"\n\"#LoadModule proxy_scgi_module modules/mod_proxy_scgi.so\"\n\"#LoadModule proxy_fdpass_module modules/mod_proxy_fdpass.so\"\n\"#LoadModule proxy_wstunnel_module modules/mod_proxy_wstunnel.so\"\n\"#LoadModule proxy_ajp_module modules/mod_proxy_ajp.so\"\n\"#LoadModule proxy_balancer_module modules/mod_proxy_balancer.so\"\n\"#LoadModule proxy_express_module modules/mod_proxy_express.so\"\n\"#LoadModule session_module modules/mod_session.so\"\n\"#LoadModule session_cookie_module modules/mod_session_cookie.so\"\n\"#LoadModule session_dbd_module modules/mod_session_dbd.so\"\n\"#LoadModule slotmem_shm_module modules/mod_slotmem_shm.so\"\n\"#LoadModule slotmem_plain_module modules/mod_slotmem_plain.so\"\nLoadModule ssl_module modules/mod_ssl.so\n\"#LoadModule dialup_module modules/mod_dialup.so\"\n\"#LoadModule lbmethod_byrequests_module modules/mod_lbmethod_byrequests.so\"\n\"#LoadModule lbmethod_bytraffic_module modules/mod_lbmethod_bytraffic.so\"\n\"#LoadModule lbmethod_bybusyness_module modules/mod_lbmethod_bybusyness.so\"\n\"#LoadModule lbmethod_heartbeat_module modules/mod_lbmethod_heartbeat.so\"\n\"#LoadModule mpm_event_module modules/mod_mpm_event.so\"\nLoadModule mpm_prefork_module modules/mod_mpm_prefork.so\n\"#LoadModule mpm_worker_module modules/mod_mpm_worker.so\"\nLoadModule unixd_module modules/mod_unixd.so\n\"#LoadModule heartbeat_module modules/mod_heartbeat.so\"\n\"#LoadModule heartmonitor_module modules/mod_heartmonitor.so\"\n\"#LoadModule dav_module modules/mod_dav.so\"\nLoadModule status_module modules/mod_status.so\nLoadModule autoindex_module modules/mod_autoindex.so\n\"#LoadModule asis_module modules/mod_asis.so\"\n\"#LoadModule info_module modules/mod_info.so\"\n\"#LoadModule cgid_module modules/mod_cgid.so\"\n\"#LoadModule dav_fs_module modules/mod_dav_fs.so\"\n\"#LoadModule dav_lock_module modules/mod_dav_lock.so\"\n\"#LoadModule vhost_alias_module modules/mod_vhost_alias.so\"\n\"#LoadModule negotiation_module modules/mod_negotiation.so\"\nLoadModule dir_module modules/mod_dir.so\n\"#LoadModule actions_module modules/mod_actions.so\"\n\"#LoadModule speling_module modules/mod_speling.so\"\n\"#LoadModule userdir_module modules/mod_userdir.so\"\nLoadModule alias_module modules/mod_alias.so\n\"#LoadModule rewrite_module modules/mod_rewrite.so\"\nLoadModule php7_module        modules/libphp7.so\n\n<Directory />\n    AllowOverride none\n    Require all denied\n</Directory>\n\n<IfModule dir_module>\n    DirectoryIndex index.php index.html\n</IfModule>\n\n<Files \".ht*\">\n    Require all denied\n</Files>\n\nErrorLog \"logs/error_log\"\nLogLevel warn\n<IfModule log_config_module>\n    LogFormat \"%h %l %u %t \\\"%r\\\" %>s %b \\\"%{Referer}i\\\" \\\"%{User-Agent}i\\\"\" combined\n    LogFormat \"%h %l %u %t \\\"%r\\\" %>s %b\" common\n    <IfModule logio_module>\n      LogFormat \"%h %l %u %t \\\"%r\\\" %>s %b \\\"%{Referer}i\\\" \\\"%{User-Agent}i\\\" %I %O\" combinedio\n    </IfModule>\n    CustomLog \"logs/access_log\" combined\n</IfModule>\n\n<IfModule mime_module>\n    TypesConfig conf/mime.types\n    AddType application/x-compress .Z\n    AddType application/x-gzip .gz .tgz\n</IfModule>\n\n<IfModule mime_magic_module>\n    MIMEMagicFile conf/magic\n</IfModule>\n\n<FilesMatch \\.php$>\n    SetHandler application/x-httpd-php\n</FilesMatch>\nAddType text/html .php\n\n\n\"# Include conf/extra/httpd-ssl.conf\"\n\n\n<VirtualHost *:80>\n    ServerName example.com\n    DocumentRoot \"/usr/local/apache2/htdocs\"\n\n    <Directory \"/usr/local/apache2/htdocs\">\n        Options FollowSymLinks\n        AllowOverride None\n        Require all granted\n    </Directory>\n\n    ErrorLog \"logs/error_log\"\n    CustomLog \"logs/access_log\" combined\n</VirtualHost>\n</pre>\n\n\u8d77\u52d5\u30b9\u30af\u30ea\u30d7\u30c8\ncp -ip /usr/local/src/httpd-2.4.18/build/rpm/httpd.init /etc/rc.d/init.d/httpd\nvim /etc/rc.d/init.d/httpd\n(60\u884c\u76ee\u3042\u305f\u308a)\n<pre>\nhttpd=${HTTPD-/usr/sbin/httpd}\npidfile=${PIDFILE-/var/run/${prog}.pid}\nlockfile=${LOCKFILE-/var/lock/subsys/${prog}}\n\u3000\u2193\nhttpd=${HTTPD-/usr/local/apache2/bin/httpd}\npidfile=${PIDFILE-/usr/local/apache2/logs/${prog}.pid}\nlockfile=${LOCKFILE-/usr/local/apache2/logs/${prog}}\n \nCONFFILE=/etc/httpd/conf/httpd.conf\n\u3000\u2193\nCONFFILE=/usr/local/apache2/conf/httpd.conf\n</pre>\n\u8d77\u52d5\u30fb\u81ea\u52d5\u8d77\u52d5\nchkconfig --add httpd\nchkconfig --list | grep httpd\nchkconfig httpd on\napachectl start\n\n\uff0a\u6ce8\u610f\uff1a\u300cservice httpd start\u300d\u3084\u300c/etc/init.d/httpd start\u300d\u3092\u5b9f\u884c\u3059\u308b\u3068 \nsystemd \u306b\u51e6\u7406\u304c\u6e21\u3063\u3066\u3057\u307e\u3044\u3001Apache \u304c\u8d77\u52d5\u3067\u304d\u307e\u305b\u3093\u3002\n\u624b\u52d5\u3067\u306e\u8d77\u52d5\u3084\u505c\u6b62\u306f\u300capachectl\u300d\u3092\u4f7f\u3044\u307e\u3059\u3002\n"}