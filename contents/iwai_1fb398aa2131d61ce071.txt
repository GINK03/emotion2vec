{"context": " More than 1 year has passed since last update.AWS SDK for PHP v3 \u3067\u975e\u540c\u671f\u3092\u8a66\u3057\u3066\u307f\u305f\u306e\u3068\u3001\u30d6\u30e9\u30f3\u30c1\u3067\u958b\u767a\u3055\u308c\u305f json \u30b5\u30dd\u30fc\u30c8\u3092\u30d1\u30c3\u30c1\u3068\u3057\u3066\u9069\u7528\u3057\u3066\u307f\u3066\u52d5\u4f5c\u78ba\u8a8d\u3057\u3066\u307f\u305f\u3002\n\ncomposer.json\n{\n    \"require\": {\n        \"aws/aws-sdk-php\": \"~3.0@dev\"\n    }\n}\n\n\njson\u30b5\u30dd\u30fc\u30c8\u3092\u30d1\u30c3\u30c1\u3068\u3057\u3066\u9069\u7528\u3057\u3066\u307f\u308b\n$ cd vendor/aws/aws-sdk-php\n$ wget https://github.com/aws/aws-sdk-php/commit/fb0d0b98918477af3b46165036928493c6b8a72b.diff\n$ patch -p1 < fb0d0b98918477af3b46165036928493c6b8a72b.diff\npatching file src/DynamoDb/Marshaler.php\npatching file tests/DynamoDb/DynamoDbClientTest.php\npatching file tests/DynamoDb/MarshalerTest.php\n\n\nDynamoDB\u306b\u30c7\u30fc\u30bf\u3092\u5165\u308c\u3066\u307f\u308b\nuse Aws\\DynamoDb\\DynamoDbClient;\nuse Aws\\DynamoDb\\Marshaler;\n\n$ddbClient = DynamoDbClient::factory([\n    'region'  => 'ap-northeast-1',\n    'version' => 'latest',\n    'key'     =>  '<your aws key>',\n    'secret'  =>  '<your aws secret>'\n]);\n\n$doc = <<<JSON\n{\n  \"content\": {\n    \"to\": [\"123412\"],\n    \"id\": \"4444\",\n    \"text\": \"\u307b\u3052\u307b\u3052\",\n    \"createdTime\": 1418790948656,\n  },\n  \"createdTime\": 1418790948679,\n  \"id\": \"1234\",\n  \"to\": [\"12341234\"]\n}\nJSON;\n\n/** @var \\Aws\\Common\\FutureResult $ddbResult */\n$ddbResult = $ddbClient->putItem([\n    'TableName' => 'table_name',\n    'Item' => [\n        'id'          => [ 'S' => $id ],\n        'createdTime' => [ 'N' => (string)$createdTime ],\n        'doc'         => [ 'M' => (new Marshaler)->marshalDocument(json_encode($doc)) ],\n    ],\n    '@future' => true\n]);\n\n$dbbResult->then(\n    function ($result) {\n        /** @var Aws\\Common\\Result $result **/\n        echo 'done';\n    },\n    function (\\Exception $e) {\n        echo 'fail';\n    }\n);\n\ncreatedTime \u306e\u3068\u3053\u308d\u3092\u6587\u5b57\u5217\u306b\u30ad\u30e3\u30b9\u30c8\u3057\u3066\u3044\u308b\u306e\u306f\u3001Error executing Aws\\DynamoDb\\DynamoDbClient::putItem() on \"https://dynamodb.ap-northeast-1.amazonaws.com\"; SerializationException (client error): class java.lang.Long can not be converted to an String \u3063\u3066\u8d77\u3053\u3089\u308c\u305f\u306e\u3067...\u3002\n\u3053\u3093\u306a\u611f\u3058\u306b\u30c7\u30fc\u30bf\u304c\u5165\u308a\u307e\u3057\u305f\u3068\u3055\n\n[AWS SDK for PHP v3](https://github.com/aws/aws-sdk-php/tree/v3) \u3067\u975e\u540c\u671f\u3092\u8a66\u3057\u3066\u307f\u305f\u306e\u3068\u3001\u30d6\u30e9\u30f3\u30c1\u3067\u958b\u767a\u3055\u308c\u305f json \u30b5\u30dd\u30fc\u30c8\u3092\u30d1\u30c3\u30c1\u3068\u3057\u3066\u9069\u7528\u3057\u3066\u307f\u3066\u52d5\u4f5c\u78ba\u8a8d\u3057\u3066\u307f\u305f\u3002\n\n## composer.json\n\n```json\n{\n    \"require\": {\n        \"aws/aws-sdk-php\": \"~3.0@dev\"\n    }\n}\n```\n\n## json\u30b5\u30dd\u30fc\u30c8\u3092\u30d1\u30c3\u30c1\u3068\u3057\u3066\u9069\u7528\u3057\u3066\u307f\u308b\n\n```bash\n$ cd vendor/aws/aws-sdk-php\n$ wget https://github.com/aws/aws-sdk-php/commit/fb0d0b98918477af3b46165036928493c6b8a72b.diff\n$ patch -p1 < fb0d0b98918477af3b46165036928493c6b8a72b.diff\npatching file src/DynamoDb/Marshaler.php\npatching file tests/DynamoDb/DynamoDbClientTest.php\npatching file tests/DynamoDb/MarshalerTest.php\n```\n\n## DynamoDB\u306b\u30c7\u30fc\u30bf\u3092\u5165\u308c\u3066\u307f\u308b\n\n```php\nuse Aws\\DynamoDb\\DynamoDbClient;\nuse Aws\\DynamoDb\\Marshaler;\n\n$ddbClient = DynamoDbClient::factory([\n    'region'  => 'ap-northeast-1',\n    'version' => 'latest',\n    'key'     =>  '<your aws key>',\n    'secret'  =>  '<your aws secret>'\n]);\n\n$doc = <<<JSON\n{\n  \"content\": {\n    \"to\": [\"123412\"],\n\t\"id\": \"4444\",\n\t\"text\": \"\u307b\u3052\u307b\u3052\",\n\t\"createdTime\": 1418790948656,\n  },\n  \"createdTime\": 1418790948679,\n  \"id\": \"1234\",\n  \"to\": [\"12341234\"]\n}\nJSON;\n\n/** @var \\Aws\\Common\\FutureResult $ddbResult */\n$ddbResult = $ddbClient->putItem([\n    'TableName' => 'table_name',\n    'Item' => [\n        'id'          => [ 'S' => $id ],\n        'createdTime' => [ 'N' => (string)$createdTime ],\n        'doc'         => [ 'M' => (new Marshaler)->marshalDocument(json_encode($doc)) ],\n    ],\n    '@future' => true\n]);\n\n$dbbResult->then(\n    function ($result) {\n        /** @var Aws\\Common\\Result $result **/\n        echo 'done';\n    },\n    function (\\Exception $e) {\n        echo 'fail';\n    }\n);\n```\n\ncreatedTime \u306e\u3068\u3053\u308d\u3092\u6587\u5b57\u5217\u306b\u30ad\u30e3\u30b9\u30c8\u3057\u3066\u3044\u308b\u306e\u306f\u3001```Error executing Aws\\DynamoDb\\DynamoDbClient::putItem() on \"https://dynamodb.ap-northeast-1.amazonaws.com\"; SerializationException (client error): class java.lang.Long can not be converted to an String``` \u3063\u3066\u8d77\u3053\u3089\u308c\u305f\u306e\u3067...\u3002\n\n\n\u3053\u3093\u306a\u611f\u3058\u306b\u30c7\u30fc\u30bf\u304c\u5165\u308a\u307e\u3057\u305f\u3068\u3055\n\n![\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2014-12-17 14.32.58.png](https://qiita-image-store.s3.amazonaws.com/0/4725/68392eda-2d6b-f74e-92f7-99e00cc42d6e.png)\n", "tags": ["AWS", "PHP", "DynamoDB"]}