{"tags": ["drone.io"], "context": "OSS\u7248drone.io\u3067\u306f\u30c6\u30b9\u30c8\u306e\u540c\u6642\u5b9f\u884c\u6570\u306b\u5236\u9650\u304c\u3042\u308a\u3001\u767b\u9332\u3057\u305fdocker node\u306e\u6570\u3092\u540c\u3058\u306b\u306a\u308a\u307e\u3059\u3002\u3053\u306e\u6570\u3092\u8d85\u3048\u3066\u30c6\u30b9\u30c8\u304c\u5b9f\u884c\u3055\u308c\u308b\u3068\u4ed6\u306e\u30c6\u30b9\u30c8\u306f\u305d\u306e\u9593\u5f85\u305f\u3055\u308c\u308b\u3053\u3068\u306b\u306a\u308a\u307e\u3059\u3002\u9577\u6642\u9593\u5b9f\u884c\u3055\u308c\u308b\u30c6\u30b9\u30c8\u304c\u3042\u308b\u3068\u7c21\u5358\u306b\u540c\u6642\u5b9f\u884c\u6570\u3092\u8d85\u3048\u3066\u3057\u307e\u3044\u307e\u3059\u306e\u3067\u3001\u5b9f\u884c\u5f85\u3061\u72b6\u614b\u306b\u306a\u3063\u3066\u3044\u308b\u30c6\u30b9\u30c8\u304c\u3069\u308c\u304f\u3089\u3044\u3042\u308b\u306e\u304b\u3092\u628a\u63e1\u3057\u3066\u304a\u304f\u3068\u904b\u7528\u304c\u697d\u3067\u3059\u3002\n\nSqlite\u304b\u3089\u53d6\u5f97\u3059\u308b\nv0.3\u3067\u306f\u3067\u304d\u305f\u5168job\u306e\u60c5\u5831\u3092API\u304b\u3089\u53d6\u308b\u3053\u3068\u306f\u3067\u304d\u306a\u304f\u306a\u3063\u305f\u305f\u3081\u3001DB\u304b\u3089\u76f4\u63a5\u53d6\u5f97\u3057\u307e\u3057\u3087\u3046\u3002\n$ sqlite3 /var/lib/drone/drone.sqlite \"select count(*) from jobs where job_status = 'pending';\"\n2\n\n\u3088\u308a\u8a73\u7d30\u306a\u60c5\u5831\u306f\u5fc5\u8981\u306a\u5834\u5408\u306f\nselect repo_owner, repo_name, repo_private, build_branch from jobs inner join builds on jobs.job_build_id = builds.build_id inner join repos on builds.build_repo_id = repos.repo_id where job_status = 'pending'\n\n\u3068\u3059\u308b\u3068\u3044\u308d\u3044\u308d\u53d6\u5f97\u53ef\u80fd\u306b\u306a\u308a\u307e\u3059\u3002\n\u30b8\u30e7\u30d6\u30b9\u30c6\u30fc\u30bf\u30b9\u306e\u4e00\u89a7\u3084DB\u30b9\u30ad\u30fc\u30de\u306fgithub\u306b\u3042\u308a\u307e\u3059\u306e\u3067\u53c2\u8003\u306b\u3057\u3066\u304f\u3060\u3055\u3044\u3002\nmunin\u306a\u3069\u3067\u30e2\u30cb\u30bf\u30ea\u30f3\u30b0\u3057\u3066\u3001docker node\u6570\u3092\u8abf\u6574\u3057\u307e\u3057\u3087\u3046\u3002\nOSS\u7248drone.io\u3067\u306f\u30c6\u30b9\u30c8\u306e\u540c\u6642\u5b9f\u884c\u6570\u306b\u5236\u9650\u304c\u3042\u308a\u3001\u767b\u9332\u3057\u305fdocker node\u306e\u6570\u3092\u540c\u3058\u306b\u306a\u308a\u307e\u3059\u3002\u3053\u306e\u6570\u3092\u8d85\u3048\u3066\u30c6\u30b9\u30c8\u304c\u5b9f\u884c\u3055\u308c\u308b\u3068\u4ed6\u306e\u30c6\u30b9\u30c8\u306f\u305d\u306e\u9593\u5f85\u305f\u3055\u308c\u308b\u3053\u3068\u306b\u306a\u308a\u307e\u3059\u3002\u9577\u6642\u9593\u5b9f\u884c\u3055\u308c\u308b\u30c6\u30b9\u30c8\u304c\u3042\u308b\u3068\u7c21\u5358\u306b\u540c\u6642\u5b9f\u884c\u6570\u3092\u8d85\u3048\u3066\u3057\u307e\u3044\u307e\u3059\u306e\u3067\u3001\u5b9f\u884c\u5f85\u3061\u72b6\u614b\u306b\u306a\u3063\u3066\u3044\u308b\u30c6\u30b9\u30c8\u304c\u3069\u308c\u304f\u3089\u3044\u3042\u308b\u306e\u304b\u3092\u628a\u63e1\u3057\u3066\u304a\u304f\u3068\u904b\u7528\u304c\u697d\u3067\u3059\u3002\n\n## Sqlite\u304b\u3089\u53d6\u5f97\u3059\u308b\nv0.3\u3067\u306f\u3067\u304d\u305f\u5168job\u306e\u60c5\u5831\u3092API\u304b\u3089\u53d6\u308b\u3053\u3068\u306f\u3067\u304d\u306a\u304f\u306a\u3063\u305f\u305f\u3081\u3001DB\u304b\u3089\u76f4\u63a5\u53d6\u5f97\u3057\u307e\u3057\u3087\u3046\u3002\n\n```sql\n$ sqlite3 /var/lib/drone/drone.sqlite \"select count(*) from jobs where job_status = 'pending';\"\n2\n```\n\n\u3088\u308a\u8a73\u7d30\u306a\u60c5\u5831\u306f\u5fc5\u8981\u306a\u5834\u5408\u306f\n\n```sql\nselect repo_owner, repo_name, repo_private, build_branch from jobs inner join builds on jobs.job_build_id = builds.build_id inner join repos on builds.build_repo_id = repos.repo_id where job_status = 'pending'\n```\n\u3068\u3059\u308b\u3068\u3044\u308d\u3044\u308d\u53d6\u5f97\u53ef\u80fd\u306b\u306a\u308a\u307e\u3059\u3002\n\n[\u30b8\u30e7\u30d6\u30b9\u30c6\u30fc\u30bf\u30b9\u306e\u4e00\u89a7](https://github.com/drone/drone/blob/v0.4.2/model/const.go)\u3084[DB\u30b9\u30ad\u30fc\u30de](https://github.com/drone/drone/tree/v0.4.2/store/datastore/ddl)\u306fgithub\u306b\u3042\u308a\u307e\u3059\u306e\u3067\u53c2\u8003\u306b\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\nmunin\u306a\u3069\u3067\u30e2\u30cb\u30bf\u30ea\u30f3\u30b0\u3057\u3066\u3001docker node\u6570\u3092\u8abf\u6574\u3057\u307e\u3057\u3087\u3046\u3002\n"}