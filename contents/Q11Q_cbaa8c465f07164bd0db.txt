{"tags": ["VBA", "Excel", "Powerhell", "URLEncode", "URLDecode"], "context": "\n\nScriptcontrol\u304c64bit\u306f\u4f7f\u3048\u306a\u3044\n64\u30d3\u30c3\u30c8\u74b0\u5883\u3067\u306eScriptControl\u306e\u4ee3\u308f\u308a\n\u307e\u3042\u305d\u3093\u306a\u611f\u3058\u3067\u60a9\u3093\u3067\u3044\u305f\u306e\u3067\u3059\u304c\u3001 \u306a\u3093\u3060\u3042\u308b\u3058\u3083\u306a\u3044\u304b\u3002 EXCEL2010 64bit\u7248\u307e\u3067\u306e\u60a9\u307f\u3060\u3063\u305f\u3088\u3046\u3067\u3059\u3002EXCEL2010 64bit\u3092\u304a\u4f7f\u3044\u306e\u5834\u5408\u306fPowershell\u7248\u3092\u4f7f\u3046\u306a\u3069\u306e\u5fc5\u8981\u304c\u3042\u308a\u307e\u3057\u305f\u304c\u3001Excel 2013 \u4ee5\u964d\u3067\u306f\u89e3\u6d88\u3055\u308c\u3066\u3044\u307e\u3059\u3002\u3053\u308c\u3067\u30e6\u30fc\u30b6\u30fc\u30d5\u30a1\u30f3\u30af\u30b7\u30e7\u30f3\u3092\u7d44\u3080\u3068URL\u30a8\u30f3\u30b3\u30fc\u30c9\u304c\u53ef\u80fd\u306b\u306a\u308a\u307e\u3059\u3002\n\u30a2\u30af\u30bb\u30b9\u3067\u3082\u4f7f\u3048\u308b\u3088\u3046\u306bCreateobject\u3057\u305f\u3082\u306e\u3068vbscript\u3082\u4f5c\u3063\u3066\u304a\u304d\u307e\u3057\u305f\u3002\n\nVBA\n\nFor ACCESS\n\nfnURLENCODE2013.VB\nFunction fnURLENCODE2013(str as String)\nDim xlApp: Set xlApp = CreateObject(\"Excel.application\")\nfnURLENCODE2013 = xlApp.WorksheetFunction.EncodeURL(str)\nSet xlApp = Nothing\nEnd Function\n\n\n\nFor EXCEL OR ACCESS (reference setting EXCEL XX.X Object Library)\nEXCEL\u3001EXCEL\u3092\u53c2\u7167\u8a2d\u5b9a\u3057\u305f\u30a2\u30af\u30bb\u30b9\u3067\u4f7f\u3048\u308b\u95a2\u6570\u3067\u3059\n\nfnURLENCODE2013.VB\nFunction fnURLENCODE2013(str as String)\nfnURLENCODE2013 = xlApp.WorksheetFunction.EncodeURL(str)\nEnd Function\n\n\n\nVBS\nEXCEL2013\u4ee5\u964d\u304c\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u3066\u3044\u308b\u5834\u5408\u3001\u3053\u3061\u3089\u3092\u4f7f\u3046\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\nfnURLENCODE2013.VB\nFunction fnURLENCODE2013(str)\nDim xlApp: Set xlApp = CreateObject(\"Excel.application\")\nfnURLENCODE2013 = xlApp.WorksheetFunction.EncodeURL(str)\nSet xlApp = Nothing\nEnd Function\n\n\n\n\u6ce8\u610f\n\u3082\u3061\u308d\u3093\u3053\u308c\u306fEXCEL 2013 \u304c\u306a\u3044\u3068\u3060\u3081\u3067\u3059\u3002\nENCODEURL\u95a2\u6570\n\n\u8b0e\n\u3068\u3053\u308d\u3067\u3001EXCEL2016 64bit +Win 10\u3067\u4e0a\u8a18\u89e3\u8aac\u306e\n=WEBSERVICE(\"http://xml.weather.yahoo.com/forecastrss/\"&ENCODEURL(B2)&\"_f.xml\")\n\u3063\u3066\u52d5\u3044\u305f\u65b9\u3044\u307e\u3059\uff1f\n\u5f53\u65b9\u3067\u306fWEBService\u95a2\u6570\u304c\u3053\u306exml\u306a\u3093\u3068\u304b\u3067\u306f\u52d5\u304b\u306a\u3044\u307f\u305f\u3044\u3067\u3059\u3002\n\n\u5730\u5473\u306a\u4f7f\u3044\u65b9\nNote: This is google Japan\n\u3068\u308a\u3042\u3048\u305aEXCEL\u3092\u8d77\u52d5\u3057\u3066\nA1\nhttps://www.google.co.jp/search?newwindow=1&site=&source=hp&btnG=%E6%A4%9C%E7%B4%A2&q=\nB1\n=ENCODEURL(\"\u305f\u304f\u3042\u3093\u548c\u5c1a\")\nC1\n=Hyperlink(A1&B1)\n\u3068\u3059\u308b\u3068C1\u306b\u691c\u7d22URL\u304c\u3067\u304d\u307e\u3059\n\n\u5730\u5473\u306a\u4f7f\u3044\u65b9\u305d\u306e2\n\nVBA\n\nMakeGoogleSerchString.VB\nSub MakeGoogleSerchString()\nDim objIe: Set objIe = CreateObject(\"InternetExplorer.Application\"): objIe.Visible = True\nConst strG = \"https://www.google.co.jp/search?newwindow=1&site=&source=hp&btnG=%E6%A4%9C%E7%B4%A2&q=\"\nDim buf As String: buf = fnURLENCODE2013(\"\u305f\u304f\u308f\u3093\u548c\u5c1a\")\nDebug.Print strG & buf\nobjIe.navigate strG & buf\n  Do While objIe.Busy = True Or objIe.readyState <> 4\n    DoEvents\n  Loop\nEnd Sub\nFunction fnURLENCODE2013(str as String)\nDim xlApp: Set xlApp = CreateObject(\"Excel.application\")\nfnURLENCODE2013 = xlApp.WorksheetFunction.EncodeURL(str)\nSet xlApp = Nothing\nEnd Function\n\n\n\nVBS\n\u6700\u5f8cURL\u304c\u8868\u793a\u3055\u308c\u3066OK\u3092\u62bc\u3059\u3068IE\u304c\u5b8c\u5168\u306b\u8868\u793a\u3055\u308c\u307e\u3059\u3002\n\nMakeGoogleSerchString.VBS\nDim objIe: Set objIe = CreateObject(\"InternetExplorer.Application\"): objIe.Visible = True\nConst strG = \"https://www.google.co.jp/search?newwindow=1&site=&source=hp&btnG=%E6%A4%9C%E7%B4%A2&q=\"\nDim buf : buf = fnURLENCODE2013(\"\u305f\u304f\u3042\u3093\u548c\u5c1a\")\nWScript.Echo strG & buf\nobjIe.navigate strG & buf\nWScript.Echo strG & buf\nWScript.Quit\n\nFunction fnURLENCODE2013(str)\nDim xlApp: Set xlApp = CreateObject(\"Excel.application\")\nfnURLENCODE2013 = xlApp.WorksheetFunction.EncodeURL(str)\nSet xlApp = Nothing\nEnd Function\n\n\n\n\nPowerShell\u7248\u3082\u6539\u9020\u3057\u305f\u306e\u3067\n\u53c2\u8003: http://blog.powershell-from.jp/?p=222\n~~ Set-ExecutionPolicy \u3092\u5165\u308c\u3066\u307f\u307e\u3057\u305f\u3002\u3053\u308c\u3060\u3068\u4e00\u822c\u7684\u306b\u52d5\u304f\u3067\u3057\u3087\u3046\u3002 ~~\nps1\u30d5\u30a1\u30a4\u30eb\u306e\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u52d5\u304b\u3059\u3068\u304d\u306f\u5fc5\u8981\u3067\u3059\u304c\u3001\u30b3\u30de\u30f3\u30c9\u30e9\u30a4\u30f3\u306f\u305d\u306e\u307e\u307e\u3067\u52d5\u304f\u3093\u3067\u3059\u306d\u3002\u30d1\u30ef\u30fc\u30b7\u30a7\u30eb\u3092\u307f\u305f\u3089sexpr spf\u3092\u5165\u308c\u308b\u810a\u9ac4\u53cd\u5c04\u306f\u6b63\u3057\u304f\u306a\u3044\u3088\u3046\u3067\u3059\u3002(Set-ExecutionPolicy Remotesigned -Scope Process -Force\u306e\u79c1\u7684\u7565\u8a9e)\n\u305f\u3060\u3057\u3057\u3070\u3089\u304f\u9752\u3044\u7a93\u304c\u958b\u304d\u307e\u3059\u3002\u304csexpr\u3092\u5165\u308c\u3066\u3044\u308b\u3088\u308a\u65e9\u304f\u9589\u307e\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3057\u305f\u3002\n\nMakeGoogleSerchString.VB\nSub MakeGoogleSerchString2()\nDim objIe: Set objIe = CreateObject(\"InternetExplorer.Application\"): objIe.Visible = True\nConst strG = \"https://www.google.co.jp/search?newwindow=1&site=&source=hp&btnG=%E6%A4%9C%E7%B4%A2&q=\"\nDim buf As String: buf = EncodeURLPS(\"\u305f\u304f\u3042\u3093\u548c\u5c1a\",\"utf-8\")\nDebug.Print strG & buf\nobjIe.navigate strG & buf\n  Do While objIe.Busy = True Or objIe.readyState <> 4\n    DoEvents\n  Loop\nEnd Sub\n\nPrivate Function EncodeURLPS(ByVal TargetString, ByVal CodeName)\n  Dim Cmd\n  Dim TargetString\n  TargetString = Replace(TargetString, \"`\", \"``\")\n  TargetString = Replace(TargetString, \"\"\"\", \"`\"\"\"\"\"\"\")\n  Cmd = \"PowerShell -Command  -Noexit \"\" set-executionpolicy remotesigned -scope process -force;[void]([Reflection.Assembly]::LoadWithPartialName(\"\"\"\"\"\"System.Web\"\"\"\"\"\"));[Web.HttpUtility]::UrlEncode(\"\"\"\"\"\"\" & TargetString & \"\"\"\"\"\"\", [Text.Encoding]::GetEncoding(\"\"\"\"\"\"\" & CodeName & \"\"\"\"\"\"\"))\"\"\"\n  EncodeURLPS = CreateObject(\"WScript.Shell\").Exec(Cmd).StdOut.ReadLine\nEnd Function\n\n\n\u306a\u304a\u3001powershell\u3092\u5229\u7528\u3057\u305f\u30c7\u30b3\u30fc\u30c9\u306f\u6b21\u306e\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\n\u53c2\u8003: http://blog.powershell-from.jp/?p=222\n\nURLDECODE.VB\n\nSub test()\nConst strUTF8 = \"%E3%81%82%E3%81%84%E3%81%86%E3%81%88%E3%81%8A\"\nDim str\nDim buf\nMsgBox DECodeURLPS(strUTF8)\nEnd Sub\n\nFunction DECodeURLPS(ByVal TargetString)\nDim Cmd\n  TargetString = Replace(TargetString, \"`\", \"``\")\n  TargetString = Replace(TargetString, \"\"\"\", \"`\"\"\"\"\"\"\")\n  Cmd = \"PowerShell -Command \"\"[void]([Reflection.Assembly]::LoadWithPartialName(\"\"\"\"\"\"System.Web\"\"\"\"\"\"));[Web.HttpUtility]::UrlDEcode(\"\"\"\"\"\"\" & TargetString & \"\"\"\"\"\"\")\"\"\" ', [Text.Encoding]::GetEncoding(\"\"\"\"\"\"\" & CodeName & \"\"\"\"\"\"\"))\"\"\"\n  Debug.Print Cmd\n  DECodeURLPS = CreateObject(\"WScript.Shell\").Exec(Cmd).StdOut.ReadLine\nEnd Function\n\n\n\n##Scriptcontrol\u304c64bit\u306f\u4f7f\u3048\u306a\u3044\n[64\u30d3\u30c3\u30c8\u74b0\u5883\u3067\u306eScriptControl\u306e\u4ee3\u308f\u308a](http://www.ka-net.org/office/of32.html)\n\u307e\u3042\u305d\u3093\u306a\u611f\u3058\u3067\u60a9\u3093\u3067\u3044\u305f\u306e\u3067\u3059\u304c\u3001 ~~\u306a\u3093\u3060\u3042\u308b\u3058\u3083\u306a\u3044\u304b\u3002~~ EXCEL2010 64bit\u7248\u307e\u3067\u306e\u60a9\u307f\u3060\u3063\u305f\u3088\u3046\u3067\u3059\u3002EXCEL2010 64bit\u3092\u304a\u4f7f\u3044\u306e\u5834\u5408\u306fPowershell\u7248\u3092\u4f7f\u3046\u306a\u3069\u306e\u5fc5\u8981\u304c\u3042\u308a\u307e\u3057\u305f\u304c\u3001Excel 2013 \u4ee5\u964d\u3067\u306f\u89e3\u6d88\u3055\u308c\u3066\u3044\u307e\u3059\u3002\u3053\u308c\u3067\u30e6\u30fc\u30b6\u30fc\u30d5\u30a1\u30f3\u30af\u30b7\u30e7\u30f3\u3092\u7d44\u3080\u3068URL\u30a8\u30f3\u30b3\u30fc\u30c9\u304c\u53ef\u80fd\u306b\u306a\u308a\u307e\u3059\u3002\n\u30a2\u30af\u30bb\u30b9\u3067\u3082\u4f7f\u3048\u308b\u3088\u3046\u306bCreateobject\u3057\u305f\u3082\u306e\u3068vbscript\u3082\u4f5c\u3063\u3066\u304a\u304d\u307e\u3057\u305f\u3002\n\n###VBA\n\n####For ACCESS\n```VBnet:fnURLENCODE2013.VB\nFunction fnURLENCODE2013(str as String)\nDim xlApp: Set xlApp = CreateObject(\"Excel.application\")\nfnURLENCODE2013 = xlApp.WorksheetFunction.EncodeURL(str)\nSet xlApp = Nothing\nEnd Function\n```\n\n####For EXCEL OR ACCESS (reference setting EXCEL XX.X Object Library)\nEXCEL\u3001EXCEL\u3092\u53c2\u7167\u8a2d\u5b9a\u3057\u305f\u30a2\u30af\u30bb\u30b9\u3067\u4f7f\u3048\u308b\u95a2\u6570\u3067\u3059\n\n```VBnet:fnURLENCODE2013.VB\nFunction fnURLENCODE2013(str as String)\nfnURLENCODE2013 = xlApp.WorksheetFunction.EncodeURL(str)\nEnd Function\n```\n\n###VBS\nEXCEL2013\u4ee5\u964d\u304c\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u3066\u3044\u308b\u5834\u5408\u3001\u3053\u3061\u3089\u3092\u4f7f\u3046\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n\n```VBnet:fnURLENCODE2013.VB\nFunction fnURLENCODE2013(str)\nDim xlApp: Set xlApp = CreateObject(\"Excel.application\")\nfnURLENCODE2013 = xlApp.WorksheetFunction.EncodeURL(str)\nSet xlApp = Nothing\nEnd Function\n```\n\n##\u6ce8\u610f\n\u3082\u3061\u308d\u3093\u3053\u308c\u306fEXCEL 2013 \u304c\u306a\u3044\u3068\u3060\u3081\u3067\u3059\u3002\n[ENCODEURL\u95a2\u6570](https://support.office.com/ja-jp/article/ENCODEURL-%E9%96%A2%E6%95%B0-07c7fb90-7c60-4bff-8687-fac50fe33d0e)\n\n##\u8b0e\n\u3068\u3053\u308d\u3067\u3001EXCEL2016 64bit +Win 10\u3067\u4e0a\u8a18\u89e3\u8aac\u306e\n=WEBSERVICE(\"http://xml.weather.yahoo.com/forecastrss/\"&ENCODEURL(B2)&\"_f.xml\")\n\u3063\u3066\u52d5\u3044\u305f\u65b9\u3044\u307e\u3059\uff1f\n\u5f53\u65b9\u3067\u306fWEBService\u95a2\u6570\u304c\u3053\u306exml\u306a\u3093\u3068\u304b\u3067\u306f\u52d5\u304b\u306a\u3044\u307f\u305f\u3044\u3067\u3059\u3002\n\n##\u5730\u5473\u306a\u4f7f\u3044\u65b9\nNote: This is google Japan\n\u3068\u308a\u3042\u3048\u305aEXCEL\u3092\u8d77\u52d5\u3057\u3066\nA1\nhttps://www.google.co.jp/search?newwindow=1&site=&source=hp&btnG=%E6%A4%9C%E7%B4%A2&q=\nB1\n=ENCODEURL(\"\u305f\u304f\u3042\u3093\u548c\u5c1a\")\nC1\n=Hyperlink(A1&B1)\n\u3068\u3059\u308b\u3068C1\u306b\u691c\u7d22URL\u304c\u3067\u304d\u307e\u3059\n\n##\u5730\u5473\u306a\u4f7f\u3044\u65b9\u305d\u306e2\n###VBA\n```VBnet:MakeGoogleSerchString.VB\nSub MakeGoogleSerchString()\nDim objIe: Set objIe = CreateObject(\"InternetExplorer.Application\"): objIe.Visible = True\nConst strG = \"https://www.google.co.jp/search?newwindow=1&site=&source=hp&btnG=%E6%A4%9C%E7%B4%A2&q=\"\nDim buf As String: buf = fnURLENCODE2013(\"\u305f\u304f\u308f\u3093\u548c\u5c1a\")\nDebug.Print strG & buf\nobjIe.navigate strG & buf\n  Do While objIe.Busy = True Or objIe.readyState <> 4\n    DoEvents\n  Loop\nEnd Sub\nFunction fnURLENCODE2013(str as String)\nDim xlApp: Set xlApp = CreateObject(\"Excel.application\")\nfnURLENCODE2013 = xlApp.WorksheetFunction.EncodeURL(str)\nSet xlApp = Nothing\nEnd Function\n```\n###VBS\n\u6700\u5f8cURL\u304c\u8868\u793a\u3055\u308c\u3066OK\u3092\u62bc\u3059\u3068IE\u304c\u5b8c\u5168\u306b\u8868\u793a\u3055\u308c\u307e\u3059\u3002\n\n```VBnet:MakeGoogleSerchString.VBS\nDim objIe: Set objIe = CreateObject(\"InternetExplorer.Application\"): objIe.Visible = True\nConst strG = \"https://www.google.co.jp/search?newwindow=1&site=&source=hp&btnG=%E6%A4%9C%E7%B4%A2&q=\"\nDim buf : buf = fnURLENCODE2013(\"\u305f\u304f\u3042\u3093\u548c\u5c1a\")\nWScript.Echo strG & buf\nobjIe.navigate strG & buf\nWScript.Echo strG & buf\nWScript.Quit\n\nFunction fnURLENCODE2013(str)\nDim xlApp: Set xlApp = CreateObject(\"Excel.application\")\nfnURLENCODE2013 = xlApp.WorksheetFunction.EncodeURL(str)\nSet xlApp = Nothing\nEnd Function\n\n```\n\n##PowerShell\u7248\u3082\u6539\u9020\u3057\u305f\u306e\u3067\n\u53c2\u8003: http://blog.powershell-from.jp/?p=222\n~~ Set-ExecutionPolicy \u3092\u5165\u308c\u3066\u307f\u307e\u3057\u305f\u3002\u3053\u308c\u3060\u3068\u4e00\u822c\u7684\u306b\u52d5\u304f\u3067\u3057\u3087\u3046\u3002 ~~\nps1\u30d5\u30a1\u30a4\u30eb\u306e\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u52d5\u304b\u3059\u3068\u304d\u306f\u5fc5\u8981\u3067\u3059\u304c\u3001\u30b3\u30de\u30f3\u30c9\u30e9\u30a4\u30f3\u306f\u305d\u306e\u307e\u307e\u3067\u52d5\u304f\u3093\u3067\u3059\u306d\u3002\u30d1\u30ef\u30fc\u30b7\u30a7\u30eb\u3092\u307f\u305f\u3089sexpr spf\u3092\u5165\u308c\u308b\u810a\u9ac4\u53cd\u5c04\u306f\u6b63\u3057\u304f\u306a\u3044\u3088\u3046\u3067\u3059\u3002(Set-ExecutionPolicy Remotesigned -Scope Process -Force\u306e\u79c1\u7684\u7565\u8a9e)\n\u305f\u3060\u3057\u3057\u3070\u3089\u304f\u9752\u3044\u7a93\u304c\u958b\u304d\u307e\u3059\u3002\u304csexpr\u3092\u5165\u308c\u3066\u3044\u308b\u3088\u308a\u65e9\u304f\u9589\u307e\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3057\u305f\u3002\n\n```VBnet:MakeGoogleSerchString.VB\nSub MakeGoogleSerchString2()\nDim objIe: Set objIe = CreateObject(\"InternetExplorer.Application\"): objIe.Visible = True\nConst strG = \"https://www.google.co.jp/search?newwindow=1&site=&source=hp&btnG=%E6%A4%9C%E7%B4%A2&q=\"\nDim buf As String: buf = EncodeURLPS(\"\u305f\u304f\u3042\u3093\u548c\u5c1a\",\"utf-8\")\nDebug.Print strG & buf\nobjIe.navigate strG & buf\n  Do While objIe.Busy = True Or objIe.readyState <> 4\n    DoEvents\n  Loop\nEnd Sub\n\nPrivate Function EncodeURLPS(ByVal TargetString, ByVal CodeName)\n  Dim Cmd\n  Dim TargetString\n  TargetString = Replace(TargetString, \"`\", \"``\")\n  TargetString = Replace(TargetString, \"\"\"\", \"`\"\"\"\"\"\"\")\n  Cmd = \"PowerShell -Command  -Noexit \"\" set-executionpolicy remotesigned -scope process -force;[void]([Reflection.Assembly]::LoadWithPartialName(\"\"\"\"\"\"System.Web\"\"\"\"\"\"));[Web.HttpUtility]::UrlEncode(\"\"\"\"\"\"\" & TargetString & \"\"\"\"\"\"\", [Text.Encoding]::GetEncoding(\"\"\"\"\"\"\" & CodeName & \"\"\"\"\"\"\"))\"\"\"\n  EncodeURLPS = CreateObject(\"WScript.Shell\").Exec(Cmd).StdOut.ReadLine\nEnd Function\n```\n\n\u306a\u304a\u3001powershell\u3092\u5229\u7528\u3057\u305f\u30c7\u30b3\u30fc\u30c9\u306f\u6b21\u306e\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\n\u53c2\u8003: http://blog.powershell-from.jp/?p=222\n\n```VBnet:URLDECODE.VB\n\nSub test()\nConst strUTF8 = \"%E3%81%82%E3%81%84%E3%81%86%E3%81%88%E3%81%8A\"\nDim str\nDim buf\nMsgBox DECodeURLPS(strUTF8)\nEnd Sub\n\nFunction DECodeURLPS(ByVal TargetString)\nDim Cmd\n  TargetString = Replace(TargetString, \"`\", \"``\")\n  TargetString = Replace(TargetString, \"\"\"\", \"`\"\"\"\"\"\"\")\n  Cmd = \"PowerShell -Command \"\"[void]([Reflection.Assembly]::LoadWithPartialName(\"\"\"\"\"\"System.Web\"\"\"\"\"\"));[Web.HttpUtility]::UrlDEcode(\"\"\"\"\"\"\" & TargetString & \"\"\"\"\"\"\")\"\"\" ', [Text.Encoding]::GetEncoding(\"\"\"\"\"\"\" & CodeName & \"\"\"\"\"\"\"))\"\"\"\n  Debug.Print Cmd\n  DECodeURLPS = CreateObject(\"WScript.Shell\").Exec(Cmd).StdOut.ReadLine\nEnd Function\n\n```\n"}