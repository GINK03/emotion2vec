{"context": " More than 1 year has passed since last update.\n\nhivemall\u3092\u5229\u7528\u3057\u3066logistic\u56de\u5e30\u5206\u6790\u3092\u30c8\u30e9\u30a4\u3059\u308b\n\n\u76ee\u7684\n\u4ee5\u4e0b\u306e\u30c7\u30fc\u30bf\u3092\u5229\u7528\u3057\u3066\u3001logistic\u56de\u5e30\u5206\u6790\u3092\u5b9f\u65bd\u3057\u3066\u307f\u307e\u3059\u3002\nlogistic\u56de\u5e30\u5206\u6790\u3092\u5b9f\u65bd\u3059\u308b\u305f\u3081\u306b\u5fc5\u8981\u306a\u6e96\u5099\u3084\u8003\u3048\u306a\u3051\u308c\u3070\u306a\u3089\u306a\u3044\u3053\u3068\u3092\u51fa\u3057\u3066\u3044\u304f\u3053\u3068\u3092\u76ee\u7684\u3068\u3057\u3066\u30c8\u30e9\u30a4\u30a2\u30eb\u306b\u306a\u308a\u307e\u3059\u3002\n\u9280\u884c\u306e\u9867\u5ba2\u30bf\u30fc\u30b2\u30c6\u30a3\u30f3\u30b0\u3010\u7df4\u7fd2\u554f\u984c\u3011\n\n\u691c\u8a3c\u306e\u6d41\u308c\n\n\u30c7\u30fc\u30bf\u306e\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\n\u30c8\u30ec\u30fc\u30cb\u30f3\u30b0\u7528\u30c7\u30fc\u30bf\u306e\u4e00\u90e8\u3092\u30c0\u30df\u30fc\u5909\u6570\u306b\u7f6e\u304d\u63db\u3048\u308b\n\u30c7\u30fc\u30bf\u3092hive\u30af\u30a8\u30ea\u3092\u5229\u7528\u3057\u3066\u3001\u767b\u9332\u3059\u308b\nhivemall\u3092\u5229\u7528\u3057\u3066logistic\u95a2\u6570\u3092\u547c\u3073\u51fa\u3057\u3001feature\u3068weight\u3092\u62bd\u51fa\u3059\u308b\n\u62bd\u51fa\u3057\u305ffeature\u3068weight\u3092\u3001sigmoid\u95a2\u6570\u306b\u9069\u7528\u3057\u3066\u3001\u4e88\u6e2c\u3057\u305f\u3044\u78ba\u7387\u3092\u6c42\u3081\u308b\n\u7591\u554f\u3002\u3002\n\n\u306a\u304a\u3001hadoop\u306fdocker\u3067\u4f5c\u6210\u3057\u3001\u305d\u3053\u306bhive\u3092\u3044\u308c\u307e\u3057\u305f\u3002\n\n1. \u30c7\u30fc\u30bf\u306e\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\n\u4e0b\u8a18\u3088\u308a\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3057\u307e\u3059\u3002\n\u9280\u884c\u306e\u9867\u5ba2\u30bf\u30fc\u30b2\u30c6\u30a3\u30f3\u30b0\u3010\u7df4\u7fd2\u554f\u984c\u3011\n\u53d6\u5f97\u3057\u305f\u30d5\u30a1\u30a4\u30eb\u306f\u3001\u4e0b\u8a18\u306e\uff12\u3064\u3067\u3059\u3002\n\n\u5b66\u7fd2\u7528\u30c7\u30fc\u30bf(train.csv)\n\u691c\u8a3c\u7528\u30c7\u30fc\u30bf(test.csv)\n\n\u5b66\u7fd2\u7528\u30c7\u30fc\u30bf\u3001\u691c\u8a3c\u7528\u30c7\u30fc\u30bf\u306e\u9805\u76ee\u306f\u4e0b\u8a18\u30da\u30fc\u30b8\u3092\u53c2\u7167\u304f\u3060\u3055\u3044\u3002\n\u30c7\u30fc\u30bf\u306e\u9805\u76ee\u306b\u3064\u3044\u3066\u306f\u3053\u3061\u3089\n\u5b66\u7fd2\u7528\u306b\u306f\u3001\u300c\u5b9a\u984d\u9810\u91d1\u7533\u3057\u8fbc\u307f\u6709\u7121\u300d\u3068\u3044\u3046\u30d0\u30a4\u30ca\u30ea\u5024\u304c\u3042\u308a\u307e\u3059\u304c\u3001\u691c\u8a3c\u7528\u306b\u306f\u8a72\u5f53\u306e\u9805\u76ee\u306f\u5b58\u5728\u3057\u307e\u305b\u3093\u3002\n\u307e\u305f\u3001\u300c\u5b9a\u984d\u9810\u91d1\u7533\u3057\u8fbc\u307f\u6709\u7121\u300d\u306e\u5024\u306e\u5185\u8a33\u306f\u3001\u300cunknown, other, failure, success\u300d\u3068\u306a\u3063\u3066\u304a\u308a\u3001\n\u3053\u306e\u307e\u307e\u3067\u306f\u3001\uff12\u5024\u5206\u985e\u306f\u3067\u304d\u306a\u3044\u306e\u3067\u3001\u6b21\u306e\u30b9\u30c6\u30c3\u30d7\u3067\u4ed6\u306e\u9805\u76ee\u3068\u540c\u69d8\u306b\u30c0\u30df\u30fc\u5909\u6570\u3092\u7528\u610f\u3057\u3066\uff12\u5024\u3067\u8a55\u4fa1\u3067\u304d\u308b\u3088\u3046\u306b\u5909\u63db\u3057\u307e\u3059\u3002\n\n2. \u30c8\u30ec\u30fc\u30cb\u30f3\u30b0\u7528\u30c7\u30fc\u30bf\u306e\u4e00\u90e8\u3092\u30c0\u30df\u30fc\u5909\u6570\u306b\u7f6e\u304d\u63db\u3048\u308b\n\u4e88\u6e2c\u3092\u3059\u308b\u305f\u3081\u306b\u5229\u7528\u3059\u308b\u5b66\u7fd2\u7528\u30c7\u30fc\u30bf\u306e\u8aac\u660e\u5909\u6570\u306f\u6570\u5024\u578b\u3060\u3051\u3067\u306f\u306a\u3044\u306e\u3067\u3001\u5e7e\u3064\u304b\u306e\u9805\u76ee\u306b\u3064\u3044\u3066\u306f\u30c0\u30df\u30fc\u5909\u6570\u306b\u7f6e\u304d\u63db\u3048\u307e\u3059\u3002\n\u30b7\u30f3\u30d7\u30eb\u306b\u5229\u7528\u3057\u3066\u307f\u305f\u304b\u3063\u305f\u306e\u3067\u3001\u91cd\u307f\u4ed8\u3051\u306a\u3069\u306f\u305b\u305a\u306b\u3001\u300c1/0\u300d\u306e\uff12\u5024\u306b\u5c55\u958b\u3057\u307e\u3057\u305f\u3002\n\u4f8b\u3048\u3070\u3001\u300c\u8077\u696d\u300d\u3068\u3044\u3046\u9805\u76ee\u306e\u5185\u8a33\u3068\u3057\u3066\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u8981\u7d20\u304c\u3042\u3063\u305f\u306e\u3067\u3001\u305d\u308c\u305e\u308c\u3092\uff12\u5024\u306b\u3059\u308b\u3001\u3068\u3044\u3046\u5bfe\u5fdc\u3092\u3068\u308a\u307e\u3057\u305f\u3002\n\n\u7ba1\u7406\u8077 -> [job_management]\u3068\u3044\u3046\u9805\u76ee\u3092\u7528\u610f\u3057\u3001[0 \u307e\u305f\u306f 1]\u3092\u683c\u7d0d\n\u751f\u5f92\u3000 -> [job_student]\u3068\u3044\u3046\u9805\u76ee\u3092\u7528\u610f\u3057\u3001[0 \u307e\u305f\u306f 1]\u3092\u683c\u7d0d\n\u81ea\u55b6\u696d -> [job_self_employed]\u3068\u3044\u3046\u9805\u76ee\u3092\u7528\u610f\u3057\u3001[0 \u307e\u305f\u306f 1]\u3092\u683c\u7d0d\n\n\u3053\u306e\u3088\u3046\u306bcsv\u30c7\u30fc\u30bf\u3092\u52a0\u5de5\u3057\u307e\u3057\u305f\u3002\n\u7528\u610f\u3057\u305fcsv\u30d5\u30a1\u30a4\u30eb\u3092\u300ctrain_modified.csv\u300d\u3068\u3057\u3066\u4fdd\u5b58\u3057\u307e\u3059\u3002\n\n3. \u30c7\u30fc\u30bf\u3092hive\u30af\u30a8\u30ea\u3092\u5229\u7528\u3057\u3066\u3001\u767b\u9332\u3059\u308b\n\u52a0\u5de5\u3057\u305fcsv\u3092hive\u306b\u767b\u9332\u3059\u308b\u305f\u3081\u306esql\u3092\u7528\u610f\u3057\u307e\u3057\u305f\u3002\ncreate table train_modified (\n id INT\n,age INT\n,job_admin INT\n,job_blue_collar INT\n,job_entrepreneur INT\n,job_housemaid INT\n,job_management INT\n,job_retired INT\n,job_self_employed INT\n,job_services INT\n,job_student INT\n,job_technicia INT\n,job_unemployed INT\n,job_unknown INT\n,martial_divorced INT\n,martial_married INT\n,martial_single INT\n,education_primary INT\n,education_secondary INT\n,education_tertiary INT\n,education_unknown INT\n,default INT\n,balance INT\n,housing INT\n,loan INT\n,contact_cellular INT\n,contact_telephone INT\n,contact_unknown INT\n,day INT\n,month INT\n,duration INT\n,campaign INT\n,pdays INT\n,previous INT\n,poutcome_failure INT\n,poutcome_other INT\n,poutcome_success INT\n,poutcome_unknown INT\n,y INT\n)\nrow format delimited fields terminated by ',' lines terminated by '\\n'\n;\n\n\u30c6\u30fc\u30d6\u30eb\u4f5c\u6210\u5f8c\u306b\u3001\u30c7\u30fc\u30bf\u3092\u767b\u9332\u3057\u307e\u3059\u3002\nhive> load data local inpath 'train_modified.csv' overwrite into table train_modified;\nLoading data to table default.train_modified\nTable default.train_modified stats: [numFiles=1, numRows=0, totalSize=2400543, rawDataSize=0]\nOK\nTime taken: 2.347 seconds\n\n\n4. hivemall\u3092\u5229\u7528\u3057\u3066logistic\u95a2\u6570\u3092\u547c\u3073\u51fa\u3057\u3001feature\u3068weight\u3092\u62bd\u51fa\u3059\u308b\n\u3053\u306e\u30c7\u30fc\u30bf\u306b\u5bfe\u3057\u3066\u3001logistic\u95a2\u6570\u3092\u9069\u7528\u3057\u3066\u307f\u307e\u3057\u305f\u3002\n\u9069\u7528\u7d50\u679c\u306f\u3001after_train\u3068\u3044\u3046\u30c6\u30fc\u30d6\u30eb\u306b\u683c\u7d0d\u3057\u3066\u3044\u307e\u3059\u3002\ndrop   table after_train;\ncreate table after_train\nas SELECT\n  A.feature as feature,\n  CAST(AVG(A.weight) AS FLOAT) AS weight\n FROM (\n  SELECT\n         logress(\n                addBias(array(\n                        concat('1:', age),\n                        concat('2:', job_admin),\n                        concat('3:', job_blue_collar),\n                        concat('4:', job_entrepreneur),\n                        concat('5:', job_housemaid),\n                        concat('6:', job_management),\n                        concat('7:', job_retired),\n                        concat('8:', job_self_employed),\n                        concat('9:', job_services),\n                        concat('10:', job_student),\n                        concat('11:', job_technicia),\n                        concat('12:', job_unemployed),\n                        concat('13:', job_unknown),\n                        concat('14:', martial_divorced),\n                        concat('15:', martial_married),\n                        concat('16:', martial_single),\n                        concat('17:', education_primary),\n                        concat('18:', education_secondary),\n                        concat('19:', education_tertiary),\n                        concat('20:', education_unknown),\n                        concat('21:', default),\n                        concat('22:', balance),\n                        concat('23:', housing),\n                        concat('24:', loan),\n                        concat('25:', contact_cellular),\n                        concat('26:', contact_telephone),\n                        concat('27:', contact_unknown),\n                        concat('28:', day),\n                        concat('29:', month),\n                        concat('30:', duration),\n                        concat('31:', campaign),\n                        concat('32:', pdays),\n                        concat('33:', previous),\n                        concat('34:', poutcome_failure),\n                        concat('35:', poutcome_other),\n                        concat('36:', poutcome_success)\n                        concat('37:', poutcome_unknown)\n                )),\n                CAST(y AS FLOAT)\n        ) AS(feature, weight)\n  FROM\n        train_modified\n  where\n        age is not null\n) A\nGROUP BY A.feature\n;\n\nselect * from after_train order by cast(feature as int);\n\n\u7d50\u679c\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u306a\u308a\u307e\u3057\u305f\u3002\nMapReduce Jobs Launched:\nStage-Stage-1: Map: 1  Reduce: 1   Cumulative CPU: 2.68 sec   HDFS Read: 6722 HDFS Write: 442 SUCCESS\nTotal MapReduce CPU Time Spent: 2 seconds 680 msec\nOK\n0   -42.138206\n1   -1363.4994\n2   -3.3884757\n3   -21.67065\n4   -2.042207\n5   -1.1862803\n6   -4.9170523\n7   5.8933487\n8   -1.23494\n9   -6.55679\n10  2.2537358\n11  0.0\n12  0.5486405\n14  -3.2775824\n15  -30.207083\n16  -8.653541\n17  -9.204702\n18  -27.587534\n19  -4.2532763\n21  -4.1451416\n22  138.73148\n23  -55.038723\n24  -19.064167\n25  -5.8856897\n26  1.1753649\n28  -625.21576\n29  -205.86134\n30  -47.881416\n31  -163.46523\n32  113.86637\n33  22.67969\n34  -6.0288196\n35  -1.7815084\n36  17.137255\nTime taken: 31.432 seconds, Fetched: 34 row(s)\n\n\n5. \u62bd\u51fa\u3057\u305ffeature\u3068weight\u3092\u3001sigmoid\u95a2\u6570\u306b\u9069\u7528\u3057\u3066\u3001\u4e88\u6e2c\u3057\u305f\u3044\u78ba\u7387\u3092\u6c42\u3081\u308b\nfeature\u3068weight\u304c\u624b\u306b\u5165\u3063\u305f\u306e\u3067\u3001sigmoid\u95a2\u6570\u306b\u9069\u7528\u3057\u3066\u307f\u307e\u3057\u305f\u3002\n\u30c0\u30df\u30fc\u5909\u6570\u306b\u9805\u76ee\u7f6e\u63db\u3092\u3057\u305f\u3001\u691c\u8a3c\u7528\u30c7\u30fc\u30bf\u306e\u30c6\u30fc\u30d6\u30eb\u300ctest_modified\u300d\u3092\u5229\u7528\u3057\u307e\u3059\u3002\n\u5404\u9805\u76ee\uff08\u8aac\u660e\u5909\u6570\uff09\u306bweight\u3092\u4e57\u3058\u305f\u7dcf\u548c\u3001\u3092sigmoid\u95a2\u6570\u306b\u4ee3\u5165\u3057\u307e\u3057\u305f\u3002\ndrop   table apply_predict;\ncreate table apply_predict\nas select\n  id,\n  cast(sigmoid(-42.138206 +\n-1363.4994 * tgt.age +\n-3.3884757 * tgt.job_admin +\n-21.67065 * tgt.job_blue_collar +\n-2.042207 * tgt.job_entrepreneur +\n-1.1862803 * tgt.job_housemaid +\n-4.9170523 * tgt.job_management +\n5.8933487 * tgt.job_retired +\n-1.23494 * tgt.job_self_employed +\n-6.55679 * tgt.job_services +\n2.2537358 * tgt.job_student +\n0.0 * tgt.job_technicia +\n0.5486405 * tgt.job_unemployed +\n-3.2775824 * tgt.martial_divorced +\n-30.207083 * tgt.martial_married +\n-8.653541 * tgt.martial_single +\n-9.204702 * tgt.education_primary +\n-27.587534 * tgt.education_secondary +\n-4.2532763 * tgt.education_tertiary +\n-4.1451416 * tgt.default +\n138.73148 * tgt.balance +\n-55.038723 * tgt.housing +\n-19.064167 * tgt.loan +\n-5.8856897 * tgt.contact_cellular +\n1.1753649 * tgt.contact_telephone +\n-625.21576 * tgt.day +\n-205.86134 * tgt.month +\n-47.881416 * tgt.duration +\n-163.46523 * tgt.campaign +\n113.86637 * tgt.pdays +\n22.67969 * tgt.previous +\n-6.0288196 * tgt.poutcome_failure +\n-1.7815084 * tgt.poutcome_other +\n17.137255 * tgt.poutcome_success) as float) as prob\nfrom\n  test_modified as tgt\n;\n\n\u3053\u308c\u3067\u3001\u9867\u5ba2\u3092\u7279\u5b9a\u3059\u308bid\u3068prob\uff08probability\uff09\u3068\u3044\u3046\u30ab\u30e9\u30e0\u3092\u3082\u3064\u30c6\u30fc\u30d6\u30eb\u3092\u624b\u306b\u5165\u308c\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3057\u305f\u3002\n\n6. \u7591\u554f\u3002\u3002\n\u3053\u308c\u3067\u3001\u4e88\u6e2c\u7d50\u679c\u3092\u6c42\u3081\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3057\u305f\u304c\u3001\u4e00\u3064\u7591\u554f\u304c\u767a\u751f\u3057\u307e\u3057\u305f\u3002\n\u4f5c\u6210\u3057\u305f\u30e2\u30c7\u30eb\u306e\u300c\u78ba\u304b\u3089\u3057\u3055\u300d\u306f\u3069\u3046\u3084\u3063\u3066\u691c\u8a3c\u3059\u308b\u306e\u304b\u3001\u3068\u3044\u3046\u554f\u984c\u3067\u3059\u3002\n\u4ee5\u4e0b\u304b\u306a\u3001\u3068\u601d\u3044\u5b9f\u8a3c\u3057\u307e\u3057\u305f\u304c\u7d50\u679c\u304c\uff15\uff10%\u7a0b\u5ea6\u306b\u306a\u3063\u3066\u3057\u307e\u3063\u305f\u306e\u3067\u524d\u63d0\u7b49\u898b\u76f4\u3057\u4e88\u5b9a\u3067\u3059\u3002\n\n\u30c8\u30e9\u30a4\u3057\u305f\u65b9\u6cd5\n\u4f5c\u6210\u3057\u305f\u30e2\u30c7\u30eb\u3092\u300c\u691c\u8a3c\u7528\u30c7\u30fc\u30bf\u300d\u3067\u306f\u306a\u304f\u3001\u300c\u5b66\u7fd2\u7528\u30c7\u30fc\u30bf\u300d\u306b\u4ee3\u5165\u3057\u3066\u3001\u5951\u7d04\u3057\u305f\u304b\u3069\u3046\u304b\u306e\u5b9f\u969b\u306e\u5024\u3068\u6bd4\u8f03\u3057\u3066\u3001\u6b63\u7b54\u7387\u3092\u7b97\u51fa\u3059\u308b\u3002\n\n# hivemall\u3092\u5229\u7528\u3057\u3066logistic\u56de\u5e30\u5206\u6790\u3092\u30c8\u30e9\u30a4\u3059\u308b\n\n## \u76ee\u7684\n\n\u4ee5\u4e0b\u306e\u30c7\u30fc\u30bf\u3092\u5229\u7528\u3057\u3066\u3001logistic\u56de\u5e30\u5206\u6790\u3092\u5b9f\u65bd\u3057\u3066\u307f\u307e\u3059\u3002\nlogistic\u56de\u5e30\u5206\u6790\u3092\u5b9f\u65bd\u3059\u308b\u305f\u3081\u306b\u5fc5\u8981\u306a\u6e96\u5099\u3084\u8003\u3048\u306a\u3051\u308c\u3070\u306a\u3089\u306a\u3044\u3053\u3068\u3092\u51fa\u3057\u3066\u3044\u304f\u3053\u3068\u3092\u76ee\u7684\u3068\u3057\u3066\u30c8\u30e9\u30a4\u30a2\u30eb\u306b\u306a\u308a\u307e\u3059\u3002\n\n[\u9280\u884c\u306e\u9867\u5ba2\u30bf\u30fc\u30b2\u30c6\u30a3\u30f3\u30b0\u3010\u7df4\u7fd2\u554f\u984c\u3011](https://datasciencelab.jp/compe/1)\n\n## \u691c\u8a3c\u306e\u6d41\u308c\n\n1. \u30c7\u30fc\u30bf\u306e\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\n1. \u30c8\u30ec\u30fc\u30cb\u30f3\u30b0\u7528\u30c7\u30fc\u30bf\u306e\u4e00\u90e8\u3092\u30c0\u30df\u30fc\u5909\u6570\u306b\u7f6e\u304d\u63db\u3048\u308b\n1. \u30c7\u30fc\u30bf\u3092hive\u30af\u30a8\u30ea\u3092\u5229\u7528\u3057\u3066\u3001\u767b\u9332\u3059\u308b\n1. hivemall\u3092\u5229\u7528\u3057\u3066logistic\u95a2\u6570\u3092\u547c\u3073\u51fa\u3057\u3001feature\u3068weight\u3092\u62bd\u51fa\u3059\u308b\n1. \u62bd\u51fa\u3057\u305ffeature\u3068weight\u3092\u3001sigmoid\u95a2\u6570\u306b\u9069\u7528\u3057\u3066\u3001\u4e88\u6e2c\u3057\u305f\u3044\u78ba\u7387\u3092\u6c42\u3081\u308b\n1. \u7591\u554f\u3002\u3002\n\n\u306a\u304a\u3001hadoop\u306fdocker\u3067\u4f5c\u6210\u3057\u3001\u305d\u3053\u306bhive\u3092\u3044\u308c\u307e\u3057\u305f\u3002\n\n### 1. \u30c7\u30fc\u30bf\u306e\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\n\n\u4e0b\u8a18\u3088\u308a\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3057\u307e\u3059\u3002\n\n[\u9280\u884c\u306e\u9867\u5ba2\u30bf\u30fc\u30b2\u30c6\u30a3\u30f3\u30b0\u3010\u7df4\u7fd2\u554f\u984c\u3011](https://datasciencelab.jp/compe/1)\n\n\u53d6\u5f97\u3057\u305f\u30d5\u30a1\u30a4\u30eb\u306f\u3001\u4e0b\u8a18\u306e\uff12\u3064\u3067\u3059\u3002\n\n* \u5b66\u7fd2\u7528\u30c7\u30fc\u30bf(train.csv)\n* \u691c\u8a3c\u7528\u30c7\u30fc\u30bf(test.csv)\n\n\u5b66\u7fd2\u7528\u30c7\u30fc\u30bf\u3001\u691c\u8a3c\u7528\u30c7\u30fc\u30bf\u306e\u9805\u76ee\u306f\u4e0b\u8a18\u30da\u30fc\u30b8\u3092\u53c2\u7167\u304f\u3060\u3055\u3044\u3002\n\n[\u30c7\u30fc\u30bf\u306e\u9805\u76ee\u306b\u3064\u3044\u3066\u306f\u3053\u3061\u3089](https://datasciencelab.jp/compe/1/download)\n\n\u5b66\u7fd2\u7528\u306b\u306f\u3001\u300c\u5b9a\u984d\u9810\u91d1\u7533\u3057\u8fbc\u307f\u6709\u7121\u300d\u3068\u3044\u3046\u30d0\u30a4\u30ca\u30ea\u5024\u304c\u3042\u308a\u307e\u3059\u304c\u3001\u691c\u8a3c\u7528\u306b\u306f\u8a72\u5f53\u306e\u9805\u76ee\u306f\u5b58\u5728\u3057\u307e\u305b\u3093\u3002\n\n\u307e\u305f\u3001\u300c\u5b9a\u984d\u9810\u91d1\u7533\u3057\u8fbc\u307f\u6709\u7121\u300d\u306e\u5024\u306e\u5185\u8a33\u306f\u3001\u300cunknown, other, failure, success\u300d\u3068\u306a\u3063\u3066\u304a\u308a\u3001\n\u3053\u306e\u307e\u307e\u3067\u306f\u3001\uff12\u5024\u5206\u985e\u306f\u3067\u304d\u306a\u3044\u306e\u3067\u3001\u6b21\u306e\u30b9\u30c6\u30c3\u30d7\u3067\u4ed6\u306e\u9805\u76ee\u3068\u540c\u69d8\u306b\u30c0\u30df\u30fc\u5909\u6570\u3092\u7528\u610f\u3057\u3066\uff12\u5024\u3067\u8a55\u4fa1\u3067\u304d\u308b\u3088\u3046\u306b\u5909\u63db\u3057\u307e\u3059\u3002\n\n### 2. \u30c8\u30ec\u30fc\u30cb\u30f3\u30b0\u7528\u30c7\u30fc\u30bf\u306e\u4e00\u90e8\u3092\u30c0\u30df\u30fc\u5909\u6570\u306b\u7f6e\u304d\u63db\u3048\u308b\n\n\u4e88\u6e2c\u3092\u3059\u308b\u305f\u3081\u306b\u5229\u7528\u3059\u308b\u5b66\u7fd2\u7528\u30c7\u30fc\u30bf\u306e\u8aac\u660e\u5909\u6570\u306f\u6570\u5024\u578b\u3060\u3051\u3067\u306f\u306a\u3044\u306e\u3067\u3001\u5e7e\u3064\u304b\u306e\u9805\u76ee\u306b\u3064\u3044\u3066\u306f\u30c0\u30df\u30fc\u5909\u6570\u306b\u7f6e\u304d\u63db\u3048\u307e\u3059\u3002\n\n\u30b7\u30f3\u30d7\u30eb\u306b\u5229\u7528\u3057\u3066\u307f\u305f\u304b\u3063\u305f\u306e\u3067\u3001\u91cd\u307f\u4ed8\u3051\u306a\u3069\u306f\u305b\u305a\u306b\u3001\u300c1/0\u300d\u306e\uff12\u5024\u306b\u5c55\u958b\u3057\u307e\u3057\u305f\u3002\n\n\u4f8b\u3048\u3070\u3001\u300c\u8077\u696d\u300d\u3068\u3044\u3046\u9805\u76ee\u306e\u5185\u8a33\u3068\u3057\u3066\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u8981\u7d20\u304c\u3042\u3063\u305f\u306e\u3067\u3001\u305d\u308c\u305e\u308c\u3092\uff12\u5024\u306b\u3059\u308b\u3001\u3068\u3044\u3046\u5bfe\u5fdc\u3092\u3068\u308a\u307e\u3057\u305f\u3002\n\n* \u7ba1\u7406\u8077 -> [job_management]\u3068\u3044\u3046\u9805\u76ee\u3092\u7528\u610f\u3057\u3001[0 \u307e\u305f\u306f 1]\u3092\u683c\u7d0d\n* \u751f\u5f92\u3000 -> [job_student]\u3068\u3044\u3046\u9805\u76ee\u3092\u7528\u610f\u3057\u3001[0 \u307e\u305f\u306f 1]\u3092\u683c\u7d0d\n* \u81ea\u55b6\u696d -> [job_self_employed]\u3068\u3044\u3046\u9805\u76ee\u3092\u7528\u610f\u3057\u3001[0 \u307e\u305f\u306f 1]\u3092\u683c\u7d0d\n\n\u3053\u306e\u3088\u3046\u306bcsv\u30c7\u30fc\u30bf\u3092\u52a0\u5de5\u3057\u307e\u3057\u305f\u3002\n\n\u7528\u610f\u3057\u305fcsv\u30d5\u30a1\u30a4\u30eb\u3092\u300ctrain_modified.csv\u300d\u3068\u3057\u3066\u4fdd\u5b58\u3057\u307e\u3059\u3002\n\n### 3. \u30c7\u30fc\u30bf\u3092hive\u30af\u30a8\u30ea\u3092\u5229\u7528\u3057\u3066\u3001\u767b\u9332\u3059\u308b\n\n\u52a0\u5de5\u3057\u305fcsv\u3092hive\u306b\u767b\u9332\u3059\u308b\u305f\u3081\u306esql\u3092\u7528\u610f\u3057\u307e\u3057\u305f\u3002\n\n```sql\ncreate table train_modified (\n id INT\n,age INT\n,job_admin INT\n,job_blue_collar INT\n,job_entrepreneur INT\n,job_housemaid INT\n,job_management INT\n,job_retired INT\n,job_self_employed INT\n,job_services INT\n,job_student INT\n,job_technicia INT\n,job_unemployed INT\n,job_unknown INT\n,martial_divorced INT\n,martial_married INT\n,martial_single INT\n,education_primary INT\n,education_secondary INT\n,education_tertiary INT\n,education_unknown INT\n,default INT\n,balance INT\n,housing INT\n,loan INT\n,contact_cellular INT\n,contact_telephone INT\n,contact_unknown INT\n,day INT\n,month INT\n,duration INT\n,campaign INT\n,pdays INT\n,previous INT\n,poutcome_failure INT\n,poutcome_other INT\n,poutcome_success INT\n,poutcome_unknown INT\n,y INT\n)\nrow format delimited fields terminated by ',' lines terminated by '\\n'\n;\n```\n\n\u30c6\u30fc\u30d6\u30eb\u4f5c\u6210\u5f8c\u306b\u3001\u30c7\u30fc\u30bf\u3092\u767b\u9332\u3057\u307e\u3059\u3002\n\n```sql\nhive> load data local inpath 'train_modified.csv' overwrite into table train_modified;\nLoading data to table default.train_modified\nTable default.train_modified stats: [numFiles=1, numRows=0, totalSize=2400543, rawDataSize=0]\nOK\nTime taken: 2.347 seconds\n```\n\n### 4. hivemall\u3092\u5229\u7528\u3057\u3066logistic\u95a2\u6570\u3092\u547c\u3073\u51fa\u3057\u3001feature\u3068weight\u3092\u62bd\u51fa\u3059\u308b\n\n\u3053\u306e\u30c7\u30fc\u30bf\u306b\u5bfe\u3057\u3066\u3001logistic\u95a2\u6570\u3092\u9069\u7528\u3057\u3066\u307f\u307e\u3057\u305f\u3002\n\n\u9069\u7528\u7d50\u679c\u306f\u3001after_train\u3068\u3044\u3046\u30c6\u30fc\u30d6\u30eb\u306b\u683c\u7d0d\u3057\u3066\u3044\u307e\u3059\u3002\n\n```sql\ndrop   table after_train;\ncreate table after_train\nas SELECT\n  A.feature as feature,\n  CAST(AVG(A.weight) AS FLOAT) AS weight\n FROM (\n  SELECT\n         logress(\n                addBias(array(\n                        concat('1:', age),\n                        concat('2:', job_admin),\n                        concat('3:', job_blue_collar),\n                        concat('4:', job_entrepreneur),\n                        concat('5:', job_housemaid),\n                        concat('6:', job_management),\n                        concat('7:', job_retired),\n                        concat('8:', job_self_employed),\n                        concat('9:', job_services),\n                        concat('10:', job_student),\n                        concat('11:', job_technicia),\n                        concat('12:', job_unemployed),\n                        concat('13:', job_unknown),\n                        concat('14:', martial_divorced),\n                        concat('15:', martial_married),\n                        concat('16:', martial_single),\n                        concat('17:', education_primary),\n                        concat('18:', education_secondary),\n                        concat('19:', education_tertiary),\n                        concat('20:', education_unknown),\n                        concat('21:', default),\n                        concat('22:', balance),\n                        concat('23:', housing),\n                        concat('24:', loan),\n                        concat('25:', contact_cellular),\n                        concat('26:', contact_telephone),\n                        concat('27:', contact_unknown),\n                        concat('28:', day),\n                        concat('29:', month),\n                        concat('30:', duration),\n                        concat('31:', campaign),\n                        concat('32:', pdays),\n                        concat('33:', previous),\n                        concat('34:', poutcome_failure),\n                        concat('35:', poutcome_other),\n                        concat('36:', poutcome_success)\n                        concat('37:', poutcome_unknown)\n                )),\n                CAST(y AS FLOAT)\n        ) AS(feature, weight)\n  FROM\n        train_modified\n  where\n        age is not null\n) A\nGROUP BY A.feature\n;\n\nselect * from after_train order by cast(feature as int);\n```\n\n\u7d50\u679c\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u306a\u308a\u307e\u3057\u305f\u3002\n\n```sql\nMapReduce Jobs Launched:\nStage-Stage-1: Map: 1  Reduce: 1   Cumulative CPU: 2.68 sec   HDFS Read: 6722 HDFS Write: 442 SUCCESS\nTotal MapReduce CPU Time Spent: 2 seconds 680 msec\nOK\n0\t-42.138206\n1\t-1363.4994\n2\t-3.3884757\n3\t-21.67065\n4\t-2.042207\n5\t-1.1862803\n6\t-4.9170523\n7\t5.8933487\n8\t-1.23494\n9\t-6.55679\n10\t2.2537358\n11\t0.0\n12\t0.5486405\n14\t-3.2775824\n15\t-30.207083\n16\t-8.653541\n17\t-9.204702\n18\t-27.587534\n19\t-4.2532763\n21\t-4.1451416\n22\t138.73148\n23\t-55.038723\n24\t-19.064167\n25\t-5.8856897\n26\t1.1753649\n28\t-625.21576\n29\t-205.86134\n30\t-47.881416\n31\t-163.46523\n32\t113.86637\n33\t22.67969\n34\t-6.0288196\n35\t-1.7815084\n36\t17.137255\nTime taken: 31.432 seconds, Fetched: 34 row(s)\n```\n\n### 5. \u62bd\u51fa\u3057\u305ffeature\u3068weight\u3092\u3001sigmoid\u95a2\u6570\u306b\u9069\u7528\u3057\u3066\u3001\u4e88\u6e2c\u3057\u305f\u3044\u78ba\u7387\u3092\u6c42\u3081\u308b\n\nfeature\u3068weight\u304c\u624b\u306b\u5165\u3063\u305f\u306e\u3067\u3001sigmoid\u95a2\u6570\u306b\u9069\u7528\u3057\u3066\u307f\u307e\u3057\u305f\u3002\n\n\u30c0\u30df\u30fc\u5909\u6570\u306b\u9805\u76ee\u7f6e\u63db\u3092\u3057\u305f\u3001\u691c\u8a3c\u7528\u30c7\u30fc\u30bf\u306e\u30c6\u30fc\u30d6\u30eb\u300ctest_modified\u300d\u3092\u5229\u7528\u3057\u307e\u3059\u3002\n\n\u5404\u9805\u76ee\uff08\u8aac\u660e\u5909\u6570\uff09\u306bweight\u3092\u4e57\u3058\u305f\u7dcf\u548c\u3001\u3092sigmoid\u95a2\u6570\u306b\u4ee3\u5165\u3057\u307e\u3057\u305f\u3002\n\n```sql\ndrop   table apply_predict;\ncreate table apply_predict\nas select\n  id,\n  cast(sigmoid(-42.138206 +\n-1363.4994 * tgt.age +\n-3.3884757 * tgt.job_admin +\n-21.67065 * tgt.job_blue_collar +\n-2.042207 * tgt.job_entrepreneur +\n-1.1862803 * tgt.job_housemaid +\n-4.9170523 * tgt.job_management +\n5.8933487 * tgt.job_retired +\n-1.23494 * tgt.job_self_employed +\n-6.55679 * tgt.job_services +\n2.2537358 * tgt.job_student +\n0.0 * tgt.job_technicia +\n0.5486405 * tgt.job_unemployed +\n-3.2775824 * tgt.martial_divorced +\n-30.207083 * tgt.martial_married +\n-8.653541 * tgt.martial_single +\n-9.204702 * tgt.education_primary +\n-27.587534 * tgt.education_secondary +\n-4.2532763 * tgt.education_tertiary +\n-4.1451416 * tgt.default +\n138.73148 * tgt.balance +\n-55.038723 * tgt.housing +\n-19.064167 * tgt.loan +\n-5.8856897 * tgt.contact_cellular +\n1.1753649 * tgt.contact_telephone +\n-625.21576 * tgt.day +\n-205.86134 * tgt.month +\n-47.881416 * tgt.duration +\n-163.46523 * tgt.campaign +\n113.86637 * tgt.pdays +\n22.67969 * tgt.previous +\n-6.0288196 * tgt.poutcome_failure +\n-1.7815084 * tgt.poutcome_other +\n17.137255 * tgt.poutcome_success) as float) as prob\nfrom\n  test_modified as tgt\n;\n```\n\n\u3053\u308c\u3067\u3001\u9867\u5ba2\u3092\u7279\u5b9a\u3059\u308bid\u3068prob\uff08probability\uff09\u3068\u3044\u3046\u30ab\u30e9\u30e0\u3092\u3082\u3064\u30c6\u30fc\u30d6\u30eb\u3092\u624b\u306b\u5165\u308c\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3057\u305f\u3002\n\n\n### 6. \u7591\u554f\u3002\u3002\n\n\u3053\u308c\u3067\u3001\u4e88\u6e2c\u7d50\u679c\u3092\u6c42\u3081\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3057\u305f\u304c\u3001\u4e00\u3064\u7591\u554f\u304c\u767a\u751f\u3057\u307e\u3057\u305f\u3002\n\n\u4f5c\u6210\u3057\u305f\u30e2\u30c7\u30eb\u306e\u300c\u78ba\u304b\u3089\u3057\u3055\u300d\u306f\u3069\u3046\u3084\u3063\u3066\u691c\u8a3c\u3059\u308b\u306e\u304b\u3001\u3068\u3044\u3046\u554f\u984c\u3067\u3059\u3002\n\n\u4ee5\u4e0b\u304b\u306a\u3001\u3068\u601d\u3044\u5b9f\u8a3c\u3057\u307e\u3057\u305f\u304c\u7d50\u679c\u304c\uff15\uff10%\u7a0b\u5ea6\u306b\u306a\u3063\u3066\u3057\u307e\u3063\u305f\u306e\u3067\u524d\u63d0\u7b49\u898b\u76f4\u3057\u4e88\u5b9a\u3067\u3059\u3002\n\n* \u30c8\u30e9\u30a4\u3057\u305f\u65b9\u6cd5\n  \u4f5c\u6210\u3057\u305f\u30e2\u30c7\u30eb\u3092\u300c\u691c\u8a3c\u7528\u30c7\u30fc\u30bf\u300d\u3067\u306f\u306a\u304f\u3001\u300c\u5b66\u7fd2\u7528\u30c7\u30fc\u30bf\u300d\u306b\u4ee3\u5165\u3057\u3066\u3001\u5951\u7d04\u3057\u305f\u304b\u3069\u3046\u304b\u306e\u5b9f\u969b\u306e\u5024\u3068\u6bd4\u8f03\u3057\u3066\u3001\u6b63\u7b54\u7387\u3092\u7b97\u51fa\u3059\u308b\u3002\n", "tags": ["hadoop", "hivemall", "hive", "\u30ed\u30b8\u30b9\u30c6\u30a3\u30c3\u30af\u56de\u5e30", "\u6a5f\u68b0\u5b66\u7fd2"]}