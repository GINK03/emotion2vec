{"context": "\n\n\u306f\u3058\u3081\u306b\nversion 2\u306edocker-compose.yml\u304c\u30b0\u30b0\u3063\u3066\u3082\u898b\u5f53\u305f\u3089\u306a\u304b\u3063\u305f\u306e\u3067\u4f5c\u308a\u307e\u3057\u305f\u3002\ndocker >= 1.10, docker-compose >= 1.6 \u3067\u304a\u8a66\u3057\u304f\u3060\u3055\u3044\u3002\n\n\u307e\u3063\u3055\u3089\u306aWordpress\u3092\u69cb\u7bc9\u3059\u308b\n\ndocker-compose.yml\nversion: \"2\"\nservices:\n  wordpress:\n    image: wordpress:latest\n    ports:\n      - \"80:80\"\n    depends_on:\n      - db\n    environment:\n      WORDPRESS_DB_HOST: \"db:3306\"\n    networks:\n      - flat-network\n    env_file: .env\n  db:\n    image: mysql:5.7\n    volumes:\n      - \"db-data:/var/lib/mysql\"\n    networks:\n      - flat-network\n    env_file: .env\nvolumes:\n  db-data:\nnetworks:\n  flat-network:\n\n\n\u30d1\u30b9\u30ef\u30fc\u30c9\u306a\u3069\u306f\u5225\u306e\u30d5\u30a1\u30a4\u30eb\u304b\u3089\u8aad\u307f\u8fbc\u3080\u3088\u3046\u306b\u3057\u307e\u3057\u305f\u3002\n\n.env\nWORDPRESS_DB_NAME=wordpress\nWORDPRESS_DB_USER=wp_user\nWORDPRESS_DB_PASSWORD=hogehoge\nMYSQL_RANDOM_ROOT_PASSWORD=yes\nMYSQL_DATABASE=wordpress\nMYSQL_USER=wp_user\nMYSQL_PASSWORD=hogehoge\n\n\n\u3053\u306e2\u30d5\u30a1\u30a4\u30eb\u3092\u7f6e\u3044\u305f\u5f8c\u306b\u4e0b\u8a18\u30b3\u30de\u30f3\u30c9\u5b9f\u884c\u3067\u3001Wordpress\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u753b\u9762\u307e\u3067\u3044\u3051\u307e\u3059\u3002\ndocker-compose up\n\n\n\u7c21\u5358\u3067\u3059\u306d\uff01\n\n\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u6e08\u306eWordpress\u3092\u69cb\u7bc9\u3059\u308b\n\u65e2\u306bWordpress\u306e\u30c0\u30f3\u30d7\u30c7\u30fc\u30bf\u304c\u3042\u308a\u3001\u305d\u308c\u3092install_wordpress.sql\u3068\u3044\u3046\u30d5\u30a1\u30a4\u30eb\u540d\u3067\u4fdd\u5b58\u3057\u3066\u3044\u308b\u3068\u3057\u307e\u3059\u3002\n\u305d\u306e\u5834\u5408\u306f\u4e0b\u8a18\u306e\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002db\u306evolumes2\u884c\u76ee\u3067\u3001\u30b3\u30f3\u30c6\u30ca\u4f5c\u6210\u6642\u306b\u5b9f\u884c\u3055\u308c\u308bSQL\u30d5\u30a1\u30a4\u30eb\u3092\u6307\u5b9a\u3057\u3066\u3044\u307e\u3059\u3002\n\ndocker-compose.yml\nversion: \"2\"\nservices:\n  wordpress:\n    image: wordpress:latest\n    ports:\n      - \"80:80\"\n    depends_on:\n      - db\n    environment:\n      WORDPRESS_DB_HOST: \"db:3306\"\n    networks:\n      - flat-network\n    env_file: .env\n  db:\n    image: mysql:5.7\n    volumes:\n      - \"db-data:/var/lib/mysql\"\n      - \"./install_wordpress.sql:/docker-entrypoint-initdb.d/install_wordpress.sql\"\n    networks:\n      - flat-network\n    env_file: .env\nvolumes:\n  db-data:\nnetworks:\n  flat-network:\n\n\n\ntips\n\nMySQL\u30b3\u30f3\u30c6\u30ca\u306emysqldump\n\u3061\u306a\u307f\u306b\u3001\u52d5\u4f5c\u4e2d\u306eMySQL\u30b3\u30f3\u30c6\u30ca\u304b\u3089dump\u3092\u53d6\u308b\u5834\u5408\u306f\u3053\u3093\u306a\u611f\u3058\u3067\u3044\u3051\u307e\u3057\u305f\u3002\ndocker exec -it MySQL\u30b3\u30f3\u30c6\u30caID sh -c 'mysqldump wordpress -u wp_user -pXXXXXXXX 2> /dev/null' > install_wordpress.sql\n\n\n\u30b3\u30f3\u30c6\u30ca\u306e\u524a\u9664\u306b\u3064\u3044\u3066\ndocker-compose down\n\n\u3068\u3057\u3066\u3082volume\u306f\u524a\u9664\u3055\u308c\u305a\u30c7\u30fc\u30bf\u304c\u6c38\u7d9a\u3057\u3066\u3057\u307e\u3046\u306e\u3067\u3001volume\u3082\u542b\u3081\u3066\u524a\u9664\u3059\u308b\u6642\u306f\ndocker-compose down -v\n\n\u3068\u3059\u308b\u3068\u3088\u3044\u3067\u3059\u3002\n# \u306f\u3058\u3081\u306b\nversion 2\u306edocker-compose.yml\u304c\u30b0\u30b0\u3063\u3066\u3082\u898b\u5f53\u305f\u3089\u306a\u304b\u3063\u305f\u306e\u3067\u4f5c\u308a\u307e\u3057\u305f\u3002\ndocker >= 1.10, docker-compose >= 1.6 \u3067\u304a\u8a66\u3057\u304f\u3060\u3055\u3044\u3002\n\n# \u307e\u3063\u3055\u3089\u306aWordpress\u3092\u69cb\u7bc9\u3059\u308b\n\n```docker-compose.yml\nversion: \"2\"\nservices:\n  wordpress:\n    image: wordpress:latest\n    ports:\n      - \"80:80\"\n    depends_on:\n      - db\n    environment:\n      WORDPRESS_DB_HOST: \"db:3306\"\n    networks:\n      - flat-network\n    env_file: .env\n  db:\n    image: mysql:5.7\n    volumes:\n      - \"db-data:/var/lib/mysql\"\n    networks:\n      - flat-network\n    env_file: .env\nvolumes:\n  db-data:\nnetworks:\n  flat-network:\n```\n\u30d1\u30b9\u30ef\u30fc\u30c9\u306a\u3069\u306f\u5225\u306e\u30d5\u30a1\u30a4\u30eb\u304b\u3089\u8aad\u307f\u8fbc\u3080\u3088\u3046\u306b\u3057\u307e\u3057\u305f\u3002\n\n```:.env\nWORDPRESS_DB_NAME=wordpress\nWORDPRESS_DB_USER=wp_user\nWORDPRESS_DB_PASSWORD=hogehoge\nMYSQL_RANDOM_ROOT_PASSWORD=yes\nMYSQL_DATABASE=wordpress\nMYSQL_USER=wp_user\nMYSQL_PASSWORD=hogehoge\n```\n\u3053\u306e2\u30d5\u30a1\u30a4\u30eb\u3092\u7f6e\u3044\u305f\u5f8c\u306b\u4e0b\u8a18\u30b3\u30de\u30f3\u30c9\u5b9f\u884c\u3067\u3001Wordpress\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u753b\u9762\u307e\u3067\u3044\u3051\u307e\u3059\u3002\n\n```\ndocker-compose up\n```\n\n![wordpress_init.png](https://qiita-image-store.s3.amazonaws.com/0/120222/0e07351b-7167-e793-3272-a5430f8b0a2a.png)\n\n\u7c21\u5358\u3067\u3059\u306d\uff01\n\n# \u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u6e08\u306eWordpress\u3092\u69cb\u7bc9\u3059\u308b\n\u65e2\u306bWordpress\u306e\u30c0\u30f3\u30d7\u30c7\u30fc\u30bf\u304c\u3042\u308a\u3001\u305d\u308c\u3092`install_wordpress.sql`\u3068\u3044\u3046\u30d5\u30a1\u30a4\u30eb\u540d\u3067\u4fdd\u5b58\u3057\u3066\u3044\u308b\u3068\u3057\u307e\u3059\u3002\n\u305d\u306e\u5834\u5408\u306f\u4e0b\u8a18\u306e\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002`db`\u306e`volumes`2\u884c\u76ee\u3067\u3001\u30b3\u30f3\u30c6\u30ca\u4f5c\u6210\u6642\u306b\u5b9f\u884c\u3055\u308c\u308bSQL\u30d5\u30a1\u30a4\u30eb\u3092\u6307\u5b9a\u3057\u3066\u3044\u307e\u3059\u3002\n\n```docker-compose.yml\nversion: \"2\"\nservices:\n  wordpress:\n    image: wordpress:latest\n    ports:\n      - \"80:80\"\n    depends_on:\n      - db\n    environment:\n      WORDPRESS_DB_HOST: \"db:3306\"\n    networks:\n      - flat-network\n    env_file: .env\n  db:\n    image: mysql:5.7\n    volumes:\n      - \"db-data:/var/lib/mysql\"\n      - \"./install_wordpress.sql:/docker-entrypoint-initdb.d/install_wordpress.sql\"\n    networks:\n      - flat-network\n    env_file: .env\nvolumes:\n  db-data:\nnetworks:\n  flat-network:\n```\n\n# tips\n## MySQL\u30b3\u30f3\u30c6\u30ca\u306emysqldump\n\u3061\u306a\u307f\u306b\u3001\u52d5\u4f5c\u4e2d\u306eMySQL\u30b3\u30f3\u30c6\u30ca\u304b\u3089dump\u3092\u53d6\u308b\u5834\u5408\u306f\u3053\u3093\u306a\u611f\u3058\u3067\u3044\u3051\u307e\u3057\u305f\u3002\n\n```\ndocker exec -it MySQL\u30b3\u30f3\u30c6\u30caID sh -c 'mysqldump wordpress -u wp_user -pXXXXXXXX 2> /dev/null' > install_wordpress.sql\n```\n\n## \u30b3\u30f3\u30c6\u30ca\u306e\u524a\u9664\u306b\u3064\u3044\u3066\n\n```\ndocker-compose down\n```\n\u3068\u3057\u3066\u3082`volume`\u306f\u524a\u9664\u3055\u308c\u305a\u30c7\u30fc\u30bf\u304c\u6c38\u7d9a\u3057\u3066\u3057\u307e\u3046\u306e\u3067\u3001`volume`\u3082\u542b\u3081\u3066\u524a\u9664\u3059\u308b\u6642\u306f\n\n```\ndocker-compose down -v\n```\n\u3068\u3059\u308b\u3068\u3088\u3044\u3067\u3059\u3002\n", "tags": ["docker", "docker-compose", "WordPress"]}