{"context": "AmazonES\u3092\u691c\u8a3c\u3059\u308b\u306b\u3042\u305f\u308a\u3001\u65e2\u5b58\u306e\u30aa\u30f3\u30d7\u30ec\u306e\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u3092\u30ea\u30b9\u30c8\u30a2\u3057\u3066\u8a66\u9a13\u3057\u305f\u3044\u304b\u3063\u305f\u306e\u3067\u3001\u904b\u7528\u4e2d\u306eES\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u304b\u3089AmazonES\u3078\u306e\u30ea\u30b9\u30c8\u30a2\u3092\u3084\u3063\u3066\u307f\u305f\u3002\nElasticsearch\u3067\u306f\u3001snpshot&restore\u306fAPI\u4ecb\u3057\u3066\u7c21\u5358\u306b\u884c\u3048\u308b\u304c\u3001AmazonES\u306fAWS\u72ec\u81ea\u8a2d\u5b9a(\u6a29\u9650)\u304c\u7d50\u69cb\u96e3\u3057\u304b\u3063\u305f\u306e\u3067\u305d\u306e\u5185\u5bb9\u3092\u30b7\u30a7\u30a2\u3002\n\u203bAmazon ES Amazon Elasticsearch Service\u306e\u7565(\u9577\u3044\u306e\u3067\u4ee5\u4e0b\u306fESS\u306b\u7565\u3059)\n\u516c\u5f0f\u306e\u7565\u306b\u6e96\u62e0\n\n\n\u5185\u5bb9\nElasticsearch\u3067\u53d6\u5f97\u3057\u305f\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u3092\u3001AmazonES\u4e0a\u306b\u30ea\u30b9\u30c8\u30a2\u3057\u3066\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u304c\u51fa\u6765\u308b\u307e\u3067\u3002\n\u8981\u7d04\u3059\u308b\u3068\u3001Amazon ES\u306e\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u30ea\u30dd\u30b8\u30c8\u30ea\u3068\u3057\u3066s3\u30d0\u30b1\u30c3\u30c8\u3092\u6307\u5b9a\u3057\u3001\u5225\u306eES\u3067\u53d6\u5f97\u3057\u305f\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u3092\u5bfe\u8c61\u306brestore\u3059\u308b\u3053\u3068\u3067\u30c7\u30fc\u30bf\u306e\u5fa9\u5143\u3092\u3059\u308b\u3068\u3044\u3046\u4ed5\u7d44\u307f\n\u203b\u500b\u4eba\u7684\u306b\u306f\u3001IAM\u3092\u3046\u307e\u304f\u7406\u89e3\u51fa\u6765\u3066\u306a\u304b\u3063\u305f\u306e\u3067\u3064\u307e\u305a\u304d\u30dd\u30a4\u30f3\u30c8\u304c\u591a\u304f\u3001\u3084\u3063\u305f\u3053\u3068\u3092\u624b\u9806\u306b\u307e\u3068\u3081\u305f\u3002\n\n\n\u30bf\u30b9\u30af\u30ea\u30b9\u30c8\n\n\ns3\u3092\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u7f6e\u304d\u5834\u3068\u3057\u3066\u8a2d\u5b9a\u3057\u53d6\u5f97 \u624b\u5143\u3067\u53d6\u3063\u3066s3\u306b\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3059\u308c\u3070\u826f\u3044\n\n\u30aa\u30f3\u30d7\u30ec(\u30d0\u30c3\u30af\u30a2\u30c3\u30d7\u5143)\u3067\u306esnapshot\u53d6\u5f97(\u30ed\u30fc\u30ab\u30eb\u306b\u53d6\u5f97\u3059\u308b\u30b1\u30fc\u30b9)\n\nAmazonES\u3067\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u306e\u30ea\u30dd\u30b8\u30c8\u30ea\u3092\u4f5c\u308b(\u3053\u3053\u5927\u5909\u3001\u3001)\n\nAmazonES\u306b\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u304b\u3089\u30ea\u30b9\u30c8\u30a2\n\n\n\u624b\u9806\n\u4f8b)\nweb_aplog-2016.09.0\u3068\u3044\u3046\u540d\u524d\u306e\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u3092\u3001\u30aa\u30f3\u30d7\u30ec\u306eElasticsearch\u304b\u3089Amazon ES\u306b\u30ea\u30b9\u30c8\u30a2\u3059\u308b\n\n1.\u30aa\u30f3\u30d7\u30ec(\u30d0\u30c3\u30af\u30a2\u30c3\u30d7\u5143)\u3067\u306esnapshot\u53d6\u5f97\n\n1.\u30ed\u30fc\u30ab\u30eb\u306e\u30d5\u30a1\u30a4\u30eb\u30b7\u30b9\u30c6\u30e0\u306b\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u30ea\u30dd\u30b8\u30c8\u30ea\u3092\u767b\u9332\n$ curl -XPUT 'http://localhost:9200/_snapshot/snapshot1' -d '{\n      \"type\": \"fs\",\n      \"settings\": {\n          \"location\": \"/opt/work/es_backup/snapshot1\",\n          \"compress\": true\n      }\n  }'\n\n\n2.web_aplog-2016.09.05\u3068\u3044\u3046\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u306e\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u53d6\u5f97\n$ curl -XPUT http://localhost:9200/_snapshot/snapshot1/snapshot_1 - d '{\n  \"indices\": \"web_aplog-2016.09.05\",\n  \"ignore_unavailable\": true,\n  \"include_global_state\": false\n}'\n\n\n\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u306e\u30b9\u30c6\u30fc\u30bf\u30b9\u78ba\u8a8d\n\n\n\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306e\u30d5\u30a1\u30a4\u30eb\u90e1\n\n\n3.\u53d6\u5f97\u3057\u305f\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u3092s3\u30d0\u30b1\u30c3\u30c8(\u5f8c\u306e\u624b\u9806\u3067Amazon ES\u306e\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u30ea\u30dd\u30b8\u30c8\u30ea\u306b\u6307\u5b9a\u3059\u308b)\u306b\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3059\u308b\n\n\u203b\u30d0\u30b1\u30c3\u30c8\u76f4\u4e0b\u306b\u3053\u306e4\u30d5\u30a1\u30a4\u30eb\u3092\u7f6e\u304f\u3053\u3068(\u4e0b\u624b\u306a\u968e\u5c64\u4f5c\u308b\u3068\u5f8c\u3005\u30cf\u30de\u308b\u539f\u56e0\u306b\u306a\u308b\u306e\u3067\u6ce8\u610f)\n\n2.AmazonES\u3067\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u306e\u30ea\u30dd\u30b8\u30c8\u30ea\u3092\u4f5c\u308b(\u3053\u3053\u5927\u5909\u3001\u3001)\n\n1.AmazonES\u7528\u306eIAMRole\u3092\u4f5c\u6210\u3059\u308b\n\u4eee\u3067\u3001AmazonESRelation\u3068\u3044\u3046\u540d\u524d\u306e\u30ed\u30fc\u30eb\u3092\u4f5c\u308b\u3068\u3059\u308b\u3002\n1-1.\u9069\u5f53\u306a\u540d\u524d\u3067\u30ed\u30fc\u30eb\u3092\u4f5c\u308b\n1-2.Type\u3092Amazon EC2\u3067\u4f5c\u3089\u306d\u3070\u306a\u3089\u306a\u3044\n1-3.\u30ed\u30fc\u30eb\u304c\u51fa\u6765\u305f\u3089\u4fe1\u983c\u95a2\u4fc2\u30dd\u30ea\u30b7\u306b\u4e0b\u8a18\u3092\u8ffd\u52a0\u3059\u308b\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Principal\": {\n        \"Service\": \"es.amazonaws.com\"\n      },\n      \"Action\": \"sts:AssumeRole\"\n    }\n  ]\n}\n\n\n2.\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u7f6e\u304d\u5834\u3068\u306a\u308bS3\u30d0\u30b1\u30c3\u30c8\u306b\u5bfe\u3057\u3066\u30011\u3067\u4f5c\u3063\u305f\u30ed\u30fc\u30eb\u306e\u6a29\u9650\u3092\u4ed8\u3051\u3066\u3042\u3052\u308b\nIAM\u529b\u304c\u4f4e\u3059\u304e\u3066\u3001\u500b\u4eba\u7684\u306b\u306f\u7406\u89e3\u3057\u3066\u52d5\u304b\u3059\u306e\u306b\u4e00\u756a\u6642\u9593\u304b\u304b\u3063\u305f\u3068\u3053\u308d\u3002\n\u3010\u3053\u3053\u3067\u3084\u308b\u3053\u3068\u3011\nElasticsearch\u306eAPI\u3067\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u30ea\u30dd\u30b8\u30c8\u30ea\u3068\u3059\u308b\u3001s3\u306b\u5bfe\u3057\u3066\u3001IAM\u30ed\u30fc\u30eb\u306e\u30a2\u30af\u30bb\u30b9\u6a29\u9650\u3092\u4e0e\u3048\u308b\u3002\n2-1.s3\u306e\u30a2\u30af\u30bb\u30b9\u30dd\u30ea\u30b7\u306b\u4e0b\u8a18\u8a2d\u5b9a\u3092\u5165\u308c\u308b\nPrincipal\u306b1\u3067\u4f5c\u3063\u305f\u30ed\u30fc\u30eb\u3092\u30de\u30c3\u30d4\u30f3\u30b0\u3059\u308b\u3053\u3068\u3067\u3001\u8a72\u5f53s3\u30d0\u30b1\u30c3\u30c8\u306b\u5bfe\u3057\u3066AmazonES\u304b\u3089\u306e\u30a2\u30af\u30bb\u30b9\u304c\u53ef\u80fd\u3068\u306a\u308b\u3002\n{\n    \"Version\": \"2012-10-17\",\n    \"Id\": \"xxx\",\n    \"Statement\": [\n        {\n            \"Effect\": \"Allow\",\n            \"Principal\": {\n                \"AWS\": \"arn:aws:iam::[ID]:role/AmazonESRelation\"\n            },\n            \"Action\": \"s3:ListBucket\",\n            \"Resource\": \"arn:aws:s3:::[\u30d0\u30b1\u30c3\u30c8\u540d]\"\n        },\n        {\n            \"Effect\": \"Allow\",\n            \"Principal\": {\n                \"AWS\": \"arn:aws:iam::[ID]:role/AmazonESRelation\"\n            },\n            \"Action\": \"s3:*\",\n            \"Resource\": \"arn:aws:s3:::[\u30d0\u30b1\u30c3\u30c8\u540d]/*\"\n        }\n    ]\n}\n\n\n3.AmazonES\u306b\u5bfe\u3057\u3066\u3001Elasticsearch\u306eREST API\u3092\u4ecb\u3057\u305f\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u30ea\u30dd\u30b8\u30c8\u30ea\u306e\u767b\u9332\n3-1.python\u5b9f\u884c\u74b0\u5883\u3067\u3001boto\u30e9\u30a4\u30d6\u30e9\u30ea\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\npip install python\n\n3-2.AWS\u304c\u30b5\u30f3\u30d7\u30eb\u306epython\u30b3\u30fc\u30c9\u3092\u7528\u610f\u3057\u3066\u304f\u308c\u3066\u3044\u308b\u306e\u3067\u3001\u5404\u5024\u3092\u81ea\u5206\u306e\u74b0\u5883\u306e\u3082\u306e\u306b\u66f8\u304d\u63db\u3048\u308b\u3002\n\u203b\u4e0b\u8a18\u30b5\u30f3\u30d7\u30eb\u306f\u3001AWS\u306e\u30b5\u30dd\u30fc\u30c8\u30da\u30fc\u30b8\u306e\u307e\u307e\u306a\u306e\u3067\u9069\u5b9c\u8aad\u307f\u66ff\u3048\u308b\u3002\nfrom boto.connection import AWSAuthConnection\n\nclass ESConnection(AWSAuthConnection):\n\n    def __init__(self, region, **kwargs):\n        super(ESConnection, self).__init__(**kwargs)\n        self._set_auth_region_name(region)\n        self._set_auth_service_name(\"es\")\n\n    def _required_auth_capability(self):\n        return ['hmac-v4']\n\nif __name__ == \"__main__\":\n\n    client = ESConnection(\n            region='us-east-1',\n            host='search-weblogs-etrt4mbbu254nsfupy6oiytuz4.us-east-1.es.a9.com',\n            aws_access_key_id='my-access-key-id',\n            aws_secret_access_key='my-access-key', is_secure=False)\n\n    print 'Registering Snapshot Repository'\n    resp = client.make_request(method='POST',\n            path='/_snapshot/weblogs-index-backups',\n            data='{\"type\": \"s3\",\"settings\": { \"bucket\": \"es-index-backups\",\"region\": \"us-east-1\",\"role_arn\": \"arn:aws:iam::123456789012:role/MyElasticsearchRole\"}}')\n    body = resp.read()\n    print body\n\n3-3.\u5b9f\u884c\n\u6210\u529f\u3059\u308b\u3068\u4e0b\u8a18\u306e\u3088\u3046\u306b\u51fa\u529b\u3055\u308c\u308b\u3002\n\n\u203b    1,2\u306e\u8a2d\u5b9a\u304c\u51fa\u6765\u3066\u306a\u3044\u3068\u3001\u5c3d\u304f403\u30a8\u30e9\u30fc\u3067\u5f3e\u304b\u308c\u308b\u306e\u3067\u305d\u306e\u5834\u5408\u306f\u90fd\u5ea6\u8ffd\u3063\u3066\u3044\u539f\u56e0\u3092\u78ba\u8a8d\u3002\u3002\n$ python snapshot_setting.py\nRegistering Snapshot Repository\n{\"acknowledged\":true}\n\n\n\n\n4.AmazonES\u306b\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u304b\u3089\u30ea\u30b9\u30c8\u30a2\n4-1.AmazonES\u4e0a\u304b\u3089\u3001s3\u306b\u30aa\u30f3\u30d7\u30ec\u304b\u3089\u30b3\u30d4\u30fc\u3057\u305f\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u306e\u5b58\u5728\u304c\u898b\u308c\u308b\u3053\u3068\u3092\u78ba\u8a8d\n\u203b\u3053\u3053\u3067\u6700\u521d\u306b\u53d6\u3063\u3066s3\u30d0\u30b1\u30c3\u30c8\u306b\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3057\u305f\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u304c\u898b\u308c\u308b\u3088\u3046\u306b\u306a\u3063\u3066\u3044\u308b\u306f\u305a\u3002\n$ curl -XGET [AmazonES\u30a8\u30f3\u30c9\u30dd\u30a4\u30f3\u30c8]/_snapshot/es-snapshot/_all?pretty\n{\n  \"snapshots\" : [ {\n    \"snapshot\" : \"snapshot_1\",\n    \"version_id\" : 1050299,\n    \"version\" : \"1.5.2\",\n    \"indices\" : [ \"web_aplog-2016.09.05\" ],\n    \"state\" : \"SUCCESS\",\n    \"start_time\" : \"2016-09-30T10:22:30.491Z\",\n    \"start_time_in_millis\" : 1475230950491,\n    \"end_time\" : \"2016-09-30T10:25:02.025Z\",\n    \"end_time_in_millis\" : 1475231102025,\n    \"duration_in_millis\" : 151534,\n    \"failures\" : [ ],\n    \"shards\" : {\n      \"total\" : 2,\n      \"failed\" : 0,\n      \"successful\" : 2\n    }\n  } ]\n}\n\n\n\n4-2.\u30ea\u30b9\u30c8\u30a2\n\u3053\u3053\u307e\u3067\u6765\u308c\u3070\u30ea\u30b9\u30c8\u30a2\u51fa\u6765\u305f\u3082\u540c\u7136\u306a\u306e\u3067\u30ea\u30b9\u30c8\u30a2\u306eAPI\u3092\u53e9\u304f\n\n\u30ea\u30b9\u30c8\u30a2\u4e2d\u306f\u3001AmazonES\u306e\u30af\u30e9\u30b9\u30bf\u72b6\u614b\u304cRed\u306b\u306a\u308b\n1250\u4e07docs,2.2G\u306e\u30ea\u30b9\u30c8\u3042\u30672\u520630\u79d2\u304f\u3089\u3044\n\n$ curl -XPOST https://[AmazonES\u30a8\u30f3\u30c9\u30dd\u30a4\u30f3\u30c8]/_snapshot/es-snapshot/snapshot_1/_restore\n{\"accepted\":true}\n\n4-3.\u30ea\u30b9\u30c8\u30a2\u306e\u30b9\u30c6\u30fc\u30bf\u30b9\u78ba\u8a8d\n[AmazonES\u30a8\u30f3\u30c9\u30dd\u30a4\u30f3\u30c8]/_snapshot/es-snapshot/snapshot_1/_status?pretty\n{\n  \"snapshots\" : [ {\n    \"snapshot\" : \"snapshot_1\",\n    \"repository\" : \"es-snapshot\",\n    \"state\" : \"SUCCESS\",\n    \"shards_stats\" : {\n      \"initializing\" : 0,\n      \"started\" : 0,\n      \"finalizing\" : 0,\n      \"done\" : 2,\n      \"failed\" : 0,\n      \"total\" : 2\n    },\n    \"stats\" : {\n      \"number_of_files\" : 212,\n      \"processed_files\" : 212,\n      \"total_size_in_bytes\" : 2425102339,\n      \"processed_size_in_bytes\" : 2425102339,\n      \"start_time_in_millis\" : 1475230950905,\n      \"time_in_millis\" : 151028\n    },\n\n    \"stats\" : {\n      \"number_of_files\" : 212,\n      \"processed_files\" : 212,\n      \"total_size_in_bytes\" : 2425102339,\n      \"processed_size_in_bytes\" : 2425102339,\n      \"start_time_in_millis\" : 1475230950905,\n      \"time_in_millis\" : 151028\n    },\n    \"indices\" : {\n      \"web_aplog-2016.09.05\" : {\n        \"shards_stats\" : {\n          \"initializing\" : 0,\n          \"started\" : 0,\n          \"finalizing\" : 0,\n          \"done\" : 2,\n          \"failed\" : 0,\n          \"total\" : 2\n        },\n        \"stats\" : {\n          \"number_of_files\" : 212,\n          \"processed_files\" : 212,\n          \"total_size_in_bytes\" : 2425102339,\n          \"processed_size_in_bytes\" : 2425102339,\n          \"start_time_in_millis\" : 1475230950905,\n          \"time_in_millis\" : 151028\n        },\n        \"shards\" : {\n          \"0\" : {\n            \"stage\" : \"DONE\",\n            \"stats\" : {\n              \"number_of_files\" : 106,\n              \"processed_files\" : 106,\n              \"total_size_in_bytes\" : 1212374605,\n              \"processed_size_in_bytes\" : 1212374605,\n              \"start_time_in_millis\" : 1475230950905,\n              \"time_in_millis\" : 151028\n            }\n          },\n          \"1\" : {\n            \"stage\" : \"DONE\",\n            \"stats\" : {\n              \"number_of_files\" : 106,\n              \"processed_files\" : 106,\n              \"total_size_in_bytes\" : 1212727734,\n              \"processed_size_in_bytes\" : 1212727734,\n              \"start_time_in_millis\" : 1475230950906,\n              \"time_in_millis\" : 147145\n            }\n          }\n        }\n      }\n    }\n  } ]\n}\n\n\n4-4.GUI\u304b\u3089\u3082\u4e00\u5fdc\u78ba\u8a8d\u3002\n\u3053\u3053\u307e\u3067\u6765\u308c\u3070Kibana\u304b\u3089\u898b\u308b\u3082\u3088\u3057\u3001API\u7a81\u304f\u3082\u3088\u3057\u3068\u3044\u3046\u30ec\u30c7\u30a3\u72b6\u614b\u306b\u306a\u308b\u3002\n[AmazonES WebUI]\n\n[kibana]\n\n\u203btimestamp\u578b\u306e\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u304c\u5c11\u3057\u6c17\u306b\u306a\u308b\u306a(\u5f8c\u3067\u3001\u5171\u901a\u306a\u306e\u304b\u30ea\u30b9\u30c8\u30a2\u306b\u3082\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u52b9\u304f\u306e\u304b\u78ba\u304b\u3081\u3066\u307f\u308b)\n\n\u6240\u611f\n\u632f\u308a\u8fd4\u3063\u3066\u307f\u308b\u3068\u3001IAM\u3092\u3057\u3063\u304b\u308a\u7406\u89e3\u3057\u3066\u3044\u308c\u3070\u305d\u3093\u306a\u306b\u96e3\u3057\u3044\u30dd\u30a4\u30f3\u30c8\u306f\u306a\u304b\u3063\u305f\u306e\u304b\u3082\u3057\u308c\u306a\u3044\u3002\n\u53ea\u3001\u3053\u308c\u3067\u65e2\u5b58\u306e\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u5fa9\u5143\u3057\u3066\u3001Amazon ES\u3067\u306e\u30d1\u30d5\u30a9\u30fc\u30de\u30f3\u30b9\u8a66\u9a13\u304c\u51fa\u6765\u308b\uff01\uff01\n\n\u53c2\u7167\nhttp://docs.aws.amazon.com/ja_jp/elasticsearch-service/latest/developerguide/es-managedomains.html#es-managedomains-snapshot-registerdirectory\nhttps://www.elastic.co/guide/en/elasticsearch/reference/2.3/modules-snapshots.html#_snapshot_status\n\nAmazonES\u3092\u691c\u8a3c\u3059\u308b\u306b\u3042\u305f\u308a\u3001\u65e2\u5b58\u306e\u30aa\u30f3\u30d7\u30ec\u306e\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u3092\u30ea\u30b9\u30c8\u30a2\u3057\u3066\u8a66\u9a13\u3057\u305f\u3044\u304b\u3063\u305f\u306e\u3067\u3001\u904b\u7528\u4e2d\u306eES\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u304b\u3089AmazonES\u3078\u306e\u30ea\u30b9\u30c8\u30a2\u3092\u3084\u3063\u3066\u307f\u305f\u3002\nElasticsearch\u3067\u306f\u3001snpshot&restore\u306fAPI\u4ecb\u3057\u3066\u7c21\u5358\u306b\u884c\u3048\u308b\u304c\u3001AmazonES\u306fAWS\u72ec\u81ea\u8a2d\u5b9a(\u6a29\u9650)\u304c\u7d50\u69cb\u96e3\u3057\u304b\u3063\u305f\u306e\u3067\u305d\u306e\u5185\u5bb9\u3092\u30b7\u30a7\u30a2\u3002\n\n\u203bAmazon ES Amazon Elasticsearch Service\u306e\u7565(\u9577\u3044\u306e\u3067\u4ee5\u4e0b\u306fESS\u306b\u7565\u3059)\n\u516c\u5f0f\u306e\u7565\u306b\u6e96\u62e0\n![Amazon_Web_Services_\u30d5\u3099\u30ed\u30af\u3099__\u3010AWS\u767a\u8868\u3011Amazon_Elasticsearch_Service.jpg](https://qiita-image-store.s3.amazonaws.com/0/40850/437cd926-ac78-6334-cb03-0410afb9b434.jpeg \"Amazon_Web_Services_\u30d5\u3099\u30ed\u30af\u3099__\u3010AWS\u767a\u8868\u3011Amazon_Elasticsearch_Service.jpg\")\n\n#\u5185\u5bb9\n\nElasticsearch\u3067\u53d6\u5f97\u3057\u305f\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u3092\u3001AmazonES\u4e0a\u306b\u30ea\u30b9\u30c8\u30a2\u3057\u3066\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u304c\u51fa\u6765\u308b\u307e\u3067\u3002\n\n\u8981\u7d04\u3059\u308b\u3068\u3001Amazon ES\u306e\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u30ea\u30dd\u30b8\u30c8\u30ea\u3068\u3057\u3066s3\u30d0\u30b1\u30c3\u30c8\u3092\u6307\u5b9a\u3057\u3001\u5225\u306eES\u3067\u53d6\u5f97\u3057\u305f\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u3092\u5bfe\u8c61\u306brestore\u3059\u308b\u3053\u3068\u3067\u30c7\u30fc\u30bf\u306e\u5fa9\u5143\u3092\u3059\u308b\u3068\u3044\u3046\u4ed5\u7d44\u307f\n\n\u203b\u500b\u4eba\u7684\u306b\u306f\u3001IAM\u3092\u3046\u307e\u304f\u7406\u89e3\u51fa\u6765\u3066\u306a\u304b\u3063\u305f\u306e\u3067\u3064\u307e\u305a\u304d\u30dd\u30a4\u30f3\u30c8\u304c\u591a\u304f\u3001\u3084\u3063\u305f\u3053\u3068\u3092\u624b\u9806\u306b\u307e\u3068\u3081\u305f\u3002\n\n\n![\u3088\u304f\u3042\u308b\u8cea\u554f_-_Amazon_Elasticsearch_Service___AWS.jpg](https://qiita-image-store.s3.amazonaws.com/0/40850/5a46d944-58d7-1e03-20e2-27a1a480e2c4.jpeg \"\u3088\u304f\u3042\u308b\u8cea\u554f_-_Amazon_Elasticsearch_Service___AWS.jpg\")\n\n#\u30bf\u30b9\u30af\u30ea\u30b9\u30c8\n\n- [x] ~~s3\u3092\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u7f6e\u304d\u5834\u3068\u3057\u3066\u8a2d\u5b9a\u3057\u53d6\u5f97~~ \u624b\u5143\u3067\u53d6\u3063\u3066s3\u306b\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3059\u308c\u3070\u826f\u3044\n- [x] \u30aa\u30f3\u30d7\u30ec(\u30d0\u30c3\u30af\u30a2\u30c3\u30d7\u5143)\u3067\u306esnapshot\u53d6\u5f97(\u30ed\u30fc\u30ab\u30eb\u306b\u53d6\u5f97\u3059\u308b\u30b1\u30fc\u30b9)\n- [x] AmazonES\u3067\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u306e\u30ea\u30dd\u30b8\u30c8\u30ea\u3092\u4f5c\u308b(\u3053\u3053\u5927\u5909\u3001\u3001)\n- [x] AmazonES\u306b\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u304b\u3089\u30ea\u30b9\u30c8\u30a2\n\n#\u624b\u9806\n\n\u4f8b)\nweb_aplog-2016.09.0\u3068\u3044\u3046\u540d\u524d\u306e\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u3092\u3001\u30aa\u30f3\u30d7\u30ec\u306eElasticsearch\u304b\u3089Amazon ES\u306b\u30ea\u30b9\u30c8\u30a2\u3059\u308b\n\n##1.\u30aa\u30f3\u30d7\u30ec(\u30d0\u30c3\u30af\u30a2\u30c3\u30d7\u5143)\u3067\u306esnapshot\u53d6\u5f97\n\n###1.\u30ed\u30fc\u30ab\u30eb\u306e\u30d5\u30a1\u30a4\u30eb\u30b7\u30b9\u30c6\u30e0\u306b\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u30ea\u30dd\u30b8\u30c8\u30ea\u3092\u767b\u9332\n\n```\n$ curl -XPUT 'http://localhost:9200/_snapshot/snapshot1' -d '{\n      \"type\": \"fs\",\n      \"settings\": {\n          \"location\": \"/opt/work/es_backup/snapshot1\",\n          \"compress\": true\n      }\n  }'\n```\n\n###2.web_aplog-2016.09.05\u3068\u3044\u3046\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u306e\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u53d6\u5f97\n\n```\n$ curl -XPUT http://localhost:9200/_snapshot/snapshot1/snapshot_1 - d '{\n  \"indices\": \"web_aplog-2016.09.05\",\n  \"ignore_unavailable\": true,\n  \"include_global_state\": false\n}'\n```\n\n###\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u306e\u30b9\u30c6\u30fc\u30bf\u30b9\u78ba\u8a8d\n\n![1__nagais_logsrv1__opt_work_es_backup_snapshot1__ssh_.jpg](https://qiita-image-store.s3.amazonaws.com/0/40850/8cc9fdb6-c60a-1a49-9229-ad37bd47af77.jpeg \"1__nagais_logsrv1__opt_work_es_backup_snapshot1__ssh_.jpg\")\n\n###\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306e\u30d5\u30a1\u30a4\u30eb\u90e1\n\n![Banners_and_Alerts_\u3068_1__nagais_logsrv1__opt_work_es_backup_snapshot1__ssh_.jpg](https://qiita-image-store.s3.amazonaws.com/0/40850/5381e4a6-a608-285b-6eb6-426d456e0c54.jpeg \"Banners_and_Alerts_\u3068_1__nagais_logsrv1__opt_work_es_backup_snapshot1__ssh_.jpg\")\n\n\n###3.\u53d6\u5f97\u3057\u305f\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u3092s3\u30d0\u30b1\u30c3\u30c8(\u5f8c\u306e\u624b\u9806\u3067Amazon ES\u306e\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u30ea\u30dd\u30b8\u30c8\u30ea\u306b\u6307\u5b9a\u3059\u308b)\u306b\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3059\u308b\n\n#####\u203b\u30d0\u30b1\u30c3\u30c8\u76f4\u4e0b\u306b\u3053\u306e4\u30d5\u30a1\u30a4\u30eb\u3092\u7f6e\u304f\u3053\u3068(\u4e0b\u624b\u306a\u968e\u5c64\u4f5c\u308b\u3068\u5f8c\u3005\u30cf\u30de\u308b\u539f\u56e0\u306b\u306a\u308b\u306e\u3067\u6ce8\u610f)\n\n##2.AmazonES\u3067\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u306e\u30ea\u30dd\u30b8\u30c8\u30ea\u3092\u4f5c\u308b(\u3053\u3053\u5927\u5909\u3001\u3001)\n\n###1.AmazonES\u7528\u306eIAMRole\u3092\u4f5c\u6210\u3059\u308b\n\n\u4eee\u3067\u3001AmazonESRelation\u3068\u3044\u3046\u540d\u524d\u306e\u30ed\u30fc\u30eb\u3092\u4f5c\u308b\u3068\u3059\u308b\u3002\n\n1-1.\u9069\u5f53\u306a\u540d\u524d\u3067\u30ed\u30fc\u30eb\u3092\u4f5c\u308b\n1-2.Type\u3092Amazon EC2\u3067\u4f5c\u3089\u306d\u3070\u306a\u3089\u306a\u3044\n1-3.\u30ed\u30fc\u30eb\u304c\u51fa\u6765\u305f\u3089\u4fe1\u983c\u95a2\u4fc2\u30dd\u30ea\u30b7\u306b\u4e0b\u8a18\u3092\u8ffd\u52a0\u3059\u308b\n\n\n```\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Principal\": {\n        \"Service\": \"es.amazonaws.com\"\n      },\n      \"Action\": \"sts:AssumeRole\"\n    }\n  ]\n}\n```\n\n###2.\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u7f6e\u304d\u5834\u3068\u306a\u308bS3\u30d0\u30b1\u30c3\u30c8\u306b\u5bfe\u3057\u3066\u30011\u3067\u4f5c\u3063\u305f\u30ed\u30fc\u30eb\u306e\u6a29\u9650\u3092\u4ed8\u3051\u3066\u3042\u3052\u308b\n\nIAM\u529b\u304c\u4f4e\u3059\u304e\u3066\u3001\u500b\u4eba\u7684\u306b\u306f\u7406\u89e3\u3057\u3066\u52d5\u304b\u3059\u306e\u306b\u4e00\u756a\u6642\u9593\u304b\u304b\u3063\u305f\u3068\u3053\u308d\u3002\n\n\u3010\u3053\u3053\u3067\u3084\u308b\u3053\u3068\u3011\nElasticsearch\u306eAPI\u3067\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u30ea\u30dd\u30b8\u30c8\u30ea\u3068\u3059\u308b\u3001s3\u306b\u5bfe\u3057\u3066\u3001IAM\u30ed\u30fc\u30eb\u306e\u30a2\u30af\u30bb\u30b9\u6a29\u9650\u3092\u4e0e\u3048\u308b\u3002\n\n2-1.s3\u306e\u30a2\u30af\u30bb\u30b9\u30dd\u30ea\u30b7\u306b\u4e0b\u8a18\u8a2d\u5b9a\u3092\u5165\u308c\u308b\n\nPrincipal\u306b1\u3067\u4f5c\u3063\u305f\u30ed\u30fc\u30eb\u3092\u30de\u30c3\u30d4\u30f3\u30b0\u3059\u308b\u3053\u3068\u3067\u3001\u8a72\u5f53s3\u30d0\u30b1\u30c3\u30c8\u306b\u5bfe\u3057\u3066AmazonES\u304b\u3089\u306e\u30a2\u30af\u30bb\u30b9\u304c\u53ef\u80fd\u3068\u306a\u308b\u3002\n\n```\n{\n\t\"Version\": \"2012-10-17\",\n\t\"Id\": \"xxx\",\n\t\"Statement\": [\n\t\t{\n\t\t\t\"Effect\": \"Allow\",\n\t\t\t\"Principal\": {\n\t\t\t\t\"AWS\": \"arn:aws:iam::[ID]:role/AmazonESRelation\"\n\t\t\t},\n\t\t\t\"Action\": \"s3:ListBucket\",\n\t\t\t\"Resource\": \"arn:aws:s3:::[\u30d0\u30b1\u30c3\u30c8\u540d]\"\n\t\t},\n\t\t{\n\t\t\t\"Effect\": \"Allow\",\n\t\t\t\"Principal\": {\n\t\t\t\t\"AWS\": \"arn:aws:iam::[ID]:role/AmazonESRelation\"\n\t\t\t},\n\t\t\t\"Action\": \"s3:*\",\n\t\t\t\"Resource\": \"arn:aws:s3:::[\u30d0\u30b1\u30c3\u30c8\u540d]/*\"\n\t\t}\n\t]\n}\n```\n\n##3.AmazonES\u306b\u5bfe\u3057\u3066\u3001Elasticsearch\u306eREST API\u3092\u4ecb\u3057\u305f\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u30ea\u30dd\u30b8\u30c8\u30ea\u306e\u767b\u9332\n\n3-1.python\u5b9f\u884c\u74b0\u5883\u3067\u3001boto\u30e9\u30a4\u30d6\u30e9\u30ea\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n```\npip install python\n```\n\n3-2.AWS\u304c\u30b5\u30f3\u30d7\u30eb\u306epython\u30b3\u30fc\u30c9\u3092\u7528\u610f\u3057\u3066\u304f\u308c\u3066\u3044\u308b\u306e\u3067\u3001\u5404\u5024\u3092\u81ea\u5206\u306e\u74b0\u5883\u306e\u3082\u306e\u306b\u66f8\u304d\u63db\u3048\u308b\u3002\n\n\u203b\u4e0b\u8a18\u30b5\u30f3\u30d7\u30eb\u306f\u3001AWS\u306e\u30b5\u30dd\u30fc\u30c8\u30da\u30fc\u30b8\u306e\u307e\u307e\u306a\u306e\u3067\u9069\u5b9c\u8aad\u307f\u66ff\u3048\u308b\u3002\n\n```\nfrom boto.connection import AWSAuthConnection\n\nclass ESConnection(AWSAuthConnection):\n\n    def __init__(self, region, **kwargs):\n        super(ESConnection, self).__init__(**kwargs)\n        self._set_auth_region_name(region)\n        self._set_auth_service_name(\"es\")\n\n    def _required_auth_capability(self):\n        return ['hmac-v4']\n\nif __name__ == \"__main__\":\n\n    client = ESConnection(\n            region='us-east-1',\n            host='search-weblogs-etrt4mbbu254nsfupy6oiytuz4.us-east-1.es.a9.com',\n            aws_access_key_id='my-access-key-id',\n            aws_secret_access_key='my-access-key', is_secure=False)\n\n    print 'Registering Snapshot Repository'\n    resp = client.make_request(method='POST',\n            path='/_snapshot/weblogs-index-backups',\n            data='{\"type\": \"s3\",\"settings\": { \"bucket\": \"es-index-backups\",\"region\": \"us-east-1\",\"role_arn\": \"arn:aws:iam::123456789012:role/MyElasticsearchRole\"}}')\n    body = resp.read()\n    print body\n```\n\n3-3.\u5b9f\u884c\n\n\u6210\u529f\u3059\u308b\u3068\u4e0b\u8a18\u306e\u3088\u3046\u306b\u51fa\u529b\u3055\u308c\u308b\u3002\n\n#####\u203b\t1,2\u306e\u8a2d\u5b9a\u304c\u51fa\u6765\u3066\u306a\u3044\u3068\u3001\u5c3d\u304f403\u30a8\u30e9\u30fc\u3067\u5f3e\u304b\u308c\u308b\u306e\u3067\u305d\u306e\u5834\u5408\u306f\u90fd\u5ea6\u8ffd\u3063\u3066\u3044\u539f\u56e0\u3092\u78ba\u8a8d\u3002\u3002\n\n```\n$ python snapshot_setting.py\nRegistering Snapshot Repository\n{\"acknowledged\":true}\n\n\n```\n\n##4.AmazonES\u306b\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u304b\u3089\u30ea\u30b9\u30c8\u30a2\n\n4-1.AmazonES\u4e0a\u304b\u3089\u3001s3\u306b\u30aa\u30f3\u30d7\u30ec\u304b\u3089\u30b3\u30d4\u30fc\u3057\u305f\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u306e\u5b58\u5728\u304c\u898b\u308c\u308b\u3053\u3068\u3092\u78ba\u8a8d\n\n\u203b\u3053\u3053\u3067\u6700\u521d\u306b\u53d6\u3063\u3066s3\u30d0\u30b1\u30c3\u30c8\u306b\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3057\u305f\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u304c\u898b\u308c\u308b\u3088\u3046\u306b\u306a\u3063\u3066\u3044\u308b\u306f\u305a\u3002\n\n```\n$ curl -XGET [AmazonES\u30a8\u30f3\u30c9\u30dd\u30a4\u30f3\u30c8]/_snapshot/es-snapshot/_all?pretty\n{\n  \"snapshots\" : [ {\n    \"snapshot\" : \"snapshot_1\",\n    \"version_id\" : 1050299,\n    \"version\" : \"1.5.2\",\n    \"indices\" : [ \"web_aplog-2016.09.05\" ],\n    \"state\" : \"SUCCESS\",\n    \"start_time\" : \"2016-09-30T10:22:30.491Z\",\n    \"start_time_in_millis\" : 1475230950491,\n    \"end_time\" : \"2016-09-30T10:25:02.025Z\",\n    \"end_time_in_millis\" : 1475231102025,\n    \"duration_in_millis\" : 151534,\n    \"failures\" : [ ],\n    \"shards\" : {\n      \"total\" : 2,\n      \"failed\" : 0,\n      \"successful\" : 2\n    }\n  } ]\n}\n\n\n```\n\n4-2.\u30ea\u30b9\u30c8\u30a2\n\n\u3053\u3053\u307e\u3067\u6765\u308c\u3070\u30ea\u30b9\u30c8\u30a2\u51fa\u6765\u305f\u3082\u540c\u7136\u306a\u306e\u3067\u30ea\u30b9\u30c8\u30a2\u306eAPI\u3092\u53e9\u304f\n\n- \u30ea\u30b9\u30c8\u30a2\u4e2d\u306f\u3001AmazonES\u306e\u30af\u30e9\u30b9\u30bf\u72b6\u614b\u304cRed\u306b\u306a\u308b\n- 1250\u4e07docs,2.2G\u306e\u30ea\u30b9\u30c8\u3042\u30672\u520630\u79d2\u304f\u3089\u3044\n\n```\n$ curl -XPOST https://[AmazonES\u30a8\u30f3\u30c9\u30dd\u30a4\u30f3\u30c8]/_snapshot/es-snapshot/snapshot_1/_restore\n{\"accepted\":true}\n```\n\n4-3.\u30ea\u30b9\u30c8\u30a2\u306e\u30b9\u30c6\u30fc\u30bf\u30b9\u78ba\u8a8d\n\n```\n[AmazonES\u30a8\u30f3\u30c9\u30dd\u30a4\u30f3\u30c8]/_snapshot/es-snapshot/snapshot_1/_status?pretty\n{\n  \"snapshots\" : [ {\n    \"snapshot\" : \"snapshot_1\",\n    \"repository\" : \"es-snapshot\",\n    \"state\" : \"SUCCESS\",\n    \"shards_stats\" : {\n      \"initializing\" : 0,\n      \"started\" : 0,\n      \"finalizing\" : 0,\n      \"done\" : 2,\n      \"failed\" : 0,\n      \"total\" : 2\n    },\n    \"stats\" : {\n      \"number_of_files\" : 212,\n      \"processed_files\" : 212,\n      \"total_size_in_bytes\" : 2425102339,\n      \"processed_size_in_bytes\" : 2425102339,\n      \"start_time_in_millis\" : 1475230950905,\n      \"time_in_millis\" : 151028\n    },\n\n    \"stats\" : {\n      \"number_of_files\" : 212,\n      \"processed_files\" : 212,\n      \"total_size_in_bytes\" : 2425102339,\n      \"processed_size_in_bytes\" : 2425102339,\n      \"start_time_in_millis\" : 1475230950905,\n      \"time_in_millis\" : 151028\n    },\n    \"indices\" : {\n      \"web_aplog-2016.09.05\" : {\n        \"shards_stats\" : {\n          \"initializing\" : 0,\n          \"started\" : 0,\n          \"finalizing\" : 0,\n          \"done\" : 2,\n          \"failed\" : 0,\n          \"total\" : 2\n        },\n        \"stats\" : {\n          \"number_of_files\" : 212,\n          \"processed_files\" : 212,\n          \"total_size_in_bytes\" : 2425102339,\n          \"processed_size_in_bytes\" : 2425102339,\n          \"start_time_in_millis\" : 1475230950905,\n          \"time_in_millis\" : 151028\n        },\n        \"shards\" : {\n          \"0\" : {\n            \"stage\" : \"DONE\",\n            \"stats\" : {\n              \"number_of_files\" : 106,\n              \"processed_files\" : 106,\n              \"total_size_in_bytes\" : 1212374605,\n              \"processed_size_in_bytes\" : 1212374605,\n              \"start_time_in_millis\" : 1475230950905,\n              \"time_in_millis\" : 151028\n            }\n          },\n          \"1\" : {\n            \"stage\" : \"DONE\",\n            \"stats\" : {\n              \"number_of_files\" : 106,\n              \"processed_files\" : 106,\n              \"total_size_in_bytes\" : 1212727734,\n              \"processed_size_in_bytes\" : 1212727734,\n              \"start_time_in_millis\" : 1475230950906,\n              \"time_in_millis\" : 147145\n            }\n          }\n        }\n      }\n    }\n  } ]\n}\n\n```\n\n4-4.GUI\u304b\u3089\u3082\u4e00\u5fdc\u78ba\u8a8d\u3002\n\n\u3053\u3053\u307e\u3067\u6765\u308c\u3070Kibana\u304b\u3089\u898b\u308b\u3082\u3088\u3057\u3001API\u7a81\u304f\u3082\u3088\u3057\u3068\u3044\u3046\u30ec\u30c7\u30a3\u72b6\u614b\u306b\u306a\u308b\u3002\n\n[AmazonES WebUI]\n![Amazon_Elasticsearch_Service_Management_Console.jpg](https://qiita-image-store.s3.amazonaws.com/0/40850/45e906ba-a5b2-287f-3611-c8ccdd8fdc57.jpeg \"Amazon_Elasticsearch_Service_Management_Console.jpg\")\n\n[kibana]\n\n![Discover_-_Kibana_4.jpg](https://qiita-image-store.s3.amazonaws.com/0/40850/91a4bf89-7380-5530-d13a-7e544a248820.jpeg \"Discover_-_Kibana_4.jpg\")\n\n\u203btimestamp\u578b\u306e\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u304c\u5c11\u3057\u6c17\u306b\u306a\u308b\u306a(\u5f8c\u3067\u3001\u5171\u901a\u306a\u306e\u304b\u30ea\u30b9\u30c8\u30a2\u306b\u3082\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u52b9\u304f\u306e\u304b\u78ba\u304b\u3081\u3066\u307f\u308b)\n\n##\u6240\u611f\n\n\u632f\u308a\u8fd4\u3063\u3066\u307f\u308b\u3068\u3001IAM\u3092\u3057\u3063\u304b\u308a\u7406\u89e3\u3057\u3066\u3044\u308c\u3070\u305d\u3093\u306a\u306b\u96e3\u3057\u3044\u30dd\u30a4\u30f3\u30c8\u306f\u306a\u304b\u3063\u305f\u306e\u304b\u3082\u3057\u308c\u306a\u3044\u3002\n\u53ea\u3001\u3053\u308c\u3067\u65e2\u5b58\u306e\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u5fa9\u5143\u3057\u3066\u3001Amazon ES\u3067\u306e\u30d1\u30d5\u30a9\u30fc\u30de\u30f3\u30b9\u8a66\u9a13\u304c\u51fa\u6765\u308b\uff01\uff01\n\n##\u53c2\u7167\n\nhttp://docs.aws.amazon.com/ja_jp/elasticsearch-service/latest/developerguide/es-managedomains.html#es-managedomains-snapshot-registerdirectory\n\nhttps://www.elastic.co/guide/en/elasticsearch/reference/2.3/modules-snapshots.html#_snapshot_status\n", "tags": ["AWS", "Elasticsearch", "kibana"]}