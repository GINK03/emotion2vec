{"context": "MySQL GROUP REPLICATION\u7528HAPROXY\u8a2d\u5b9a\nUbuntu16.04\u3092\u60f3\u5b9a\nHAPROXY1.5\u307e\u3067\u306f\u8d77\u52d5\u6642\u306e\u540d\u524d\u89e3\u6c7a\u3092\u6301\u3061\u7d9a\u3051\u3066\u518d\u8d77\u52d5\u3059\u308b\u307e\u3067\u66f4\u65b0\u3067\u304d\u306a\u3044\u306e\u3067\u6ce8\u610f\n\n\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\nsudo apt-get install haproxy\nsudo vi /etc/haproxy/haproxy.cfg\nfrontend mysql-gr-front_write\nbind *:13306\nmode tcp\ndefault_backend mysql-gr-back_write\n\nbackend mysql-gr-back_write\nmode tcp\nbalance leastconn\noption httpchk\nserver mysql1 xxx.xxx.xxx.xxx:3306 check port 6446 inter 1000 rise 1 fall 2 on-marked-up shutdown-backup-sessions\nserver mysql2 xxx.xxx.xxx.xxx:3306 check port 6446 inter 1000 rise 1 fall 2 backup\n\nfrontend mysql-gr-front_read\nbind *:23306\nmode tcp\ndefault_backend mysql-gr-back_read\n\nbackend mysql-gr-back_read\nmode tcp\nbalance leastconn\noption httpchk\nserver mysql1 xxx.xxx.xxx.xxx:3306 check port 6447 inter 1000 rise 1 fall 2\nserver mysql2 xxx.xxx.xxx.xxx:3306 check port 6447 inter 1000 rise 1 fall 2\n\nlisten  stats\n        bind 0.0.0.0:1936\n        mode http\n        maxconn 10\n        stats enable\n        stats hide-version\n        stats refresh 30s\n        stats show-node\n        #stats auth admin:password\n        stats uri /\n\nsudo /etc/init.d/haproxy start\n\n\u8d77\u52d5\nsudo netstat -natp | grep haproxy\n\u30ed\u30b0\u304c\u51fa\u529b\u3055\u308c\u308b\u3088\u3046rsyslog\u306e\u518d\u8d77\u52d5\nsudo /etc/init.d/rsyslog restart\n\n\u72b6\u614b\u76e3\u8996\nhttp://xxx.xxxx.xxx.xxx:1936/\nMySQL GROUP REPLICATION\u7528HAPROXY\u8a2d\u5b9a\nUbuntu16.04\u3092\u60f3\u5b9a\nHAPROXY1.5\u307e\u3067\u306f\u8d77\u52d5\u6642\u306e\u540d\u524d\u89e3\u6c7a\u3092\u6301\u3061\u7d9a\u3051\u3066\u518d\u8d77\u52d5\u3059\u308b\u307e\u3067\u66f4\u65b0\u3067\u304d\u306a\u3044\u306e\u3067\u6ce8\u610f\n\n#\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\nsudo apt-get install haproxy\nsudo vi /etc/haproxy/haproxy.cfg\n\n```\nfrontend mysql-gr-front_write\nbind *:13306\nmode tcp\ndefault_backend mysql-gr-back_write\n\nbackend mysql-gr-back_write\nmode tcp\nbalance leastconn\noption httpchk\nserver mysql1 xxx.xxx.xxx.xxx:3306 check port 6446 inter 1000 rise 1 fall 2 on-marked-up shutdown-backup-sessions\nserver mysql2 xxx.xxx.xxx.xxx:3306 check port 6446 inter 1000 rise 1 fall 2 backup\n\nfrontend mysql-gr-front_read\nbind *:23306\nmode tcp\ndefault_backend mysql-gr-back_read\n\nbackend mysql-gr-back_read\nmode tcp\nbalance leastconn\noption httpchk\nserver mysql1 xxx.xxx.xxx.xxx:3306 check port 6447 inter 1000 rise 1 fall 2\nserver mysql2 xxx.xxx.xxx.xxx:3306 check port 6447 inter 1000 rise 1 fall 2\n\nlisten  stats\n        bind 0.0.0.0:1936\n        mode http\n        maxconn 10\n        stats enable\n        stats hide-version\n        stats refresh 30s\n        stats show-node\n        #stats auth admin:password\n        stats uri /\n```\n\nsudo /etc/init.d/haproxy start\n\n#\u8d77\u52d5\nsudo netstat -natp | grep haproxy\n\u30ed\u30b0\u304c\u51fa\u529b\u3055\u308c\u308b\u3088\u3046rsyslog\u306e\u518d\u8d77\u52d5\nsudo /etc/init.d/rsyslog restart\n\n#\u72b6\u614b\u76e3\u8996\nhttp://xxx.xxxx.xxx.xxx:1936/\n", "tags": ["MySQL", "haproxy"]}