{"tags": ["JavaScript", "jQuery", "Ajax", "CSS"], "context": " More than 1 year has passed since last update.\n\n\u307e\u305aUI\u306e\u4f5c\u6210\n\u96fb\u5353\u306eUI\u3092\u4f5c\u308b\u306e\u3067\u3059\u304c\u3001\u79c1\u3001CSS\u304c\u5168\u304f\u306e\u3069\u7d20\u4eba\u3067\u3059\u3002\n\u8272\u3005\u691c\u7d22\u3057\u3001\u3084\u3063\u3068\u3053\u3055\u4f5c\u308a\u4e0a\u3052\u307e\u3057\u305f\u3002\njQuery\u306e addClass() removeClass() \u3067\u30af\u30e9\u30b9\u3092\u52d5\u7684\u306b\u8db3\u3057\u305f\u308a\u5f15\u3044\u305f\u308a\u3057\u3066\u3001\n\u30d5\u30a9\u30fc\u30ab\u30b9\u3068\u62bc\u4e0b\u72b6\u614b\u3092\u5b9f\u73fe\u3057\u3066\u307f\u307e\u3057\u305f\u3002\n\u7d20\u6750\u7528\u610f\u3057\u306a\u304f\u3066\u3082\u3044\u3044\u306e\u304c\u4fbf\u5229\u3067\u3059\u306d\u3002\n\u4e16\u306e\u4e2d\u306f\u3053\u3046\u306a\u3063\u3066\u3044\u308b\u306e\u304b(\u7b11)\n\u25a0 \u30dc\u30bf\u30f3(HTML)\n<div class=\"grid-element\">\n    <p class=\"canfocus\">1</p>\n</div>\n\n\u25a0 CSS\n.grid-element {\n    width:  80px;\n    height: 40px;\n    float: left;\n\n    margin:  2px 2px;\n    padding: 3px 3px;\n\n    border-top:    5px solid #ddd;\n    border-left:   5px solid #ddd;\n    border-right:  5px solid #bbb;\n    border-bottom: 5px solid #bbb;\n\n    background-color: #eee;\n    text-align:     center;\n}\n\n.focused {\n    font-weight: bold;\n    font-size: x-large;\n}\n\n.pressed {\n    border-top:    5px solid #bbb;\n    border-left:   5px solid #bbb;\n    border-right:  5px solid #ddd;\n    border-bottom: 5px solid #ddd;\n}\n\n\u25a0 \u30d5\u30a9\u30fc\u30ab\u30b9\u3068\u62bc\u4e0b\u3092\u5b9f\u73fe\u3059\u308bJavaScript\n// - mouse down\n$(\"p\").mousedown(function() {\n    console.log(\"mouse down \" + $(this).text());\n    if ($(this).parent().hasClass(\"grid-element\")) {\n        $(this).parent().addClass(\"pressed\");\n    }\n});\n\n// - mouse up\n$(\"p\").mouseup(function() {\n    console.log(\"mouse up \" + $(this).text());\n    $(this).parent().removeClass(\"pressed\");\n});\n\n// - mouse enter\n$(\"p\").mouseenter(function() {\n    if ($(this).hasClass(\"canfocus\")) {\n        $(this).addClass(\"focused\");\n    }\n});\n\n// - mouse leave\n$(\"p\").mouseleave(function() {\n    if ($(this).hasClass(\"canfocus\")) {\n        $(this).removeClass(\"focused\");\n        $(this).parent().removeClass(\"pressed\");\n    }\n});\n\n\n\u96fb\u5353\u6a5f\u80fd\u306e\u5b9f\u88c5\n\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u3001\u30b5\u30fc\u30d0\u306e\u5206\u696d\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u3057\u307e\u3057\u305f\u3002\n\n\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u5074 \uff1a \u30ad\u30fc\u5165\u529b\u30a4\u30d9\u30f3\u30c8\u306e\u9001\u51fa\u3068\u3001\u8a08\u7b97\u5f0f\u306e\u4fdd\u6301\u3001\u7d50\u679c\u51fa\u529b\n\u30b5\u30fc\u30d0\u5074 \uff1a \u5f0f\u306e\u6f14\u7b97\n\n\u30ad\u30fc\u3092\u62bc\u3059\u3054\u3068\u306bajax\u547c\u3073\u51fa\u3059\u3068\u3044\u3046...(\u82e6\u7b11)\n\u52c9\u5f37\u306a\u3093\u3067\u8a31\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\u25a0 \u8a08\u7b97\u5f0f\u3068\u6f14\u7b97\u7d50\u679c\u8868\u793a\u90e8(HTML)\n<div class=\"grid-element3\">\n    <p id=\"fomula\"></p>\n</div>\n\n<div class=\"grid-element3\">\n    <p id=\"result\">(result)</p>\n</div>\n\n\u25a0 JavaScript\n////////////////////////\n//\n// ajax : send fomula & get result.\n//\n////////////////////////\nfunction sendKeyEvent(fomula, lastkey) {\n    console.log(\"fomula : \" + fomula + \" / last key : \" + lastkey);\n    return $.ajax({\n        type: \"post\",\n        url:  \"./ajax_calc_engine.cgi\",\n        data: JSON.stringify({ 'fomula': fomula, 'lastkey': lastkey }),\n        contentType: \"application/json\",\n        dataType:    \"html\"\n    });\n}\n\n////////////////////////\n//\n// update\n//\n////////////////////////\nfunction update(json_data) {\n    if (json_data.result != \"n/a\") {\n        $(\"#fomula\").text(\"\");\n        $(\"#result\").text(json_data.result);\n    }\n    else {\n        $(\"#fomula\").text(json_data.fomula);\n    }\n}\n\n////////////////////////\n//\n// event handler\n//\n////////////////////////\n$(\"p\").click(function() {\n    console.log(\"click \" + $(this).text());\n\n    var key    = $(this).text();\n    var fomula = $(\"#fomula\").text();\n\n    sendKeyEvent(fomula,  key).then(\n        function(html_data) {\n            console.log($.type(html_data));\n            // console.log(html_data);\n            var res = $(html_data).find('#res').text();\n            console.log(res);\n            var json = eval ( \"(\" + res + \")\" );\n\n            update(json);\n        },\n        function() {\n            alert(\"ERROR: ajax failed.\");\n        }\n    );\n});\n\n\u25a0 CGI\n#!/usr/bin/perl\n\nuse lib lib; # library path\n\n# use strict;\nuse warnings;\nuse CGI;\nuse JSON;\n\n# Test script for Ajax trial\n# ajax_calc_engine.cgi\n#   04-Dec, 2015\n# by Saito Tomonobu (Tomonobu.Saito@gmail.com)\n\n# get parameter (a and b)\n$http    = new CGI;\n$json    = $http->param('POSTDATA');\n$data    = decode_json $json;\n$fomula  = $data->{\"fomula\"};\n$lastkey = $data->{\"lastkey\"};\n\n$result  = \"n/a\";\nif ($lastkey eq \"=\") {\n    $result = eval($fomula);\n    if ($@) {\n        $result = \"ERROR: $@\";\n    }\n} else {\n    if ($lastkey =~ /[0-9]/) {\n        $fomula = $fomula . $lastkey;\n    } else {\n        $fomula = $fomula . \" \" . $lastkey . \" \";\n    }\n}\n\n# construct response\nmy $res = {\n    lastkey => $lastkey,\n    fomula  => $fomula,\n    result  => $result,\n};\n\n# output response (json wrapped HTML)\nprint \"Content-type: text/html; charset=utf-8\\n\";\nprint \"\\n\";\nprint \"<html><body><div id='res'>\";\nprint encode_json $res;\nprint \"</div></body></html>\\n\";\n\n# eof\n\n\u8a08\u7b97\u5f0f\u306f\u3001eval\u3067\u6f14\u7b97\u5b9f\u884c\u3002\u3042\u3076\u306a\u3059\u304e\u308bw\u3002\n\u3069\u3053\u306b\u30c7\u30d7\u30ed\u30a4\u3057\u305f\u304b\u306f\u6c7a\u3057\u3066\u8a00\u3048\u307e\u305b\u3093www\u3002\nJavaScript\u5074\u3067\u3082json\u306e\u89e3\u91c8\u3092eval\u3067\u3084\u3063\u3066\u3044\u3066\u624b\u629c\u304d\u306a\u3093\u3067\u3059\u304c\u3001\n\u3053\u308c\u307e\u305f\u52c9\u5f37\u3068\u3044\u3046\u4e8b\u3067\u8a31\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n(\u8ffd\u8a18)\n\u3055\u3059\u304c\u306b\u5371\u306a\u3059\u304e\u308b\u306e\u3067\u3001\u7c21\u6613\u6570\u5f0f\u30c1\u30a7\u30c3\u30af\u3092\u8ffd\u52a0\u3057\u307e\u3057\u305f\u3002\nif ($fomula =~ /^\\s*(-\\s*)?[0-9]+(\\s*[\\+\\-\\*\\/]\\s*(-\\s*)?[0-9]+)*\\s*$/) {\n    $result = eval($fomula);\n    if ($@) {\n        $result = \"ERROR: $@\";\n    }\n}\nelse {\n    $result = \"ERROR: illegal fomula. ($fomula)\";\n}\n\n\n\u304a\u308f\u308a\u306b\n\u3053\u308c\u3067\u975e\u5e38\u306b\u5358\u7d14\u306a\u304c\u3089\u3001\njQuery + CSS + ajax \u3092\u5229\u7528\u3057\u305f\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u304c\u5b8c\u6210\u3067\u3059\u3002\n\u5165\u9580\u30ec\u30d9\u30eb\u306e\u6559\u6750\u306b\u306f\u8010\u3048\u307e\u3059\u304b\u306d\uff1f\n\u3048\u3001\u4eca\u65e5\u65e5\u3001\u5165\u9580\u3060\u3063\u3066\u3082\u3063\u3068\u30ec\u30d9\u30eb\u9ad8\u3044\u305e\u3001\u3063\u3066\uff1f\n\u3054\u3082\u3063\u3068\u3082\u3067\u5fae\u5875\u3082\u53cd\u8ad6\u3067\u304d\u307e\u305b\u3093\u3002\n\u30b3\u30fc\u30c9\u306f\u3053\u3061\u3089\u304b\u3089\u3069\u3046\u305e\nGitHub : https://github.com/Tomonobu3110/jQueryStudy/tree/master/Test/Ajax/calculator\n\u4ee5\u4e0a\u3067\u3059\u3002\n#\u307e\u305aUI\u306e\u4f5c\u6210\n\n\u96fb\u5353\u306eUI\u3092\u4f5c\u308b\u306e\u3067\u3059\u304c\u3001\u79c1\u3001CSS\u304c\u5168\u304f\u306e\u3069\u7d20\u4eba\u3067\u3059\u3002\n\u8272\u3005\u691c\u7d22\u3057\u3001\u3084\u3063\u3068\u3053\u3055\u4f5c\u308a\u4e0a\u3052\u307e\u3057\u305f\u3002\n\njQuery\u306e `addClass()` `removeClass()` \u3067\u30af\u30e9\u30b9\u3092\u52d5\u7684\u306b\u8db3\u3057\u305f\u308a\u5f15\u3044\u305f\u308a\u3057\u3066\u3001\n\u30d5\u30a9\u30fc\u30ab\u30b9\u3068\u62bc\u4e0b\u72b6\u614b\u3092\u5b9f\u73fe\u3057\u3066\u307f\u307e\u3057\u305f\u3002\n\u7d20\u6750\u7528\u610f\u3057\u306a\u304f\u3066\u3082\u3044\u3044\u306e\u304c\u4fbf\u5229\u3067\u3059\u306d\u3002\n\u4e16\u306e\u4e2d\u306f\u3053\u3046\u306a\u3063\u3066\u3044\u308b\u306e\u304b(\u7b11)\n\n\u25a0 \u30dc\u30bf\u30f3(HTML)\n\n```html\n<div class=\"grid-element\">\n    <p class=\"canfocus\">1</p>\n</div>\n```\n\n\u25a0 CSS\n\n```css\n.grid-element {\n    width:  80px;\n    height: 40px;\n    float: left;\n    \n    margin:  2px 2px;\n    padding: 3px 3px;\n    \n    border-top:    5px solid #ddd;\n    border-left:   5px solid #ddd;\n    border-right:  5px solid #bbb;\n    border-bottom: 5px solid #bbb;\n    \n    background-color: #eee;\n    text-align:     center;\n}\n\n.focused {\n\tfont-weight: bold;\n\tfont-size: x-large;\n}\n\n.pressed {\n\tborder-top:    5px solid #bbb;\n    border-left:   5px solid #bbb;\n    border-right:  5px solid #ddd;\n    border-bottom: 5px solid #ddd;\n}\n```\n\n\u25a0 \u30d5\u30a9\u30fc\u30ab\u30b9\u3068\u62bc\u4e0b\u3092\u5b9f\u73fe\u3059\u308bJavaScript\n\n```js\n// - mouse down\n$(\"p\").mousedown(function() {\n\tconsole.log(\"mouse down \" + $(this).text());\n\tif ($(this).parent().hasClass(\"grid-element\")) {\n\t\t$(this).parent().addClass(\"pressed\");\n\t}\n});\n\n// - mouse up\n$(\"p\").mouseup(function() {\n\tconsole.log(\"mouse up \" + $(this).text());\n\t$(this).parent().removeClass(\"pressed\");\n});\n\n// - mouse enter\n$(\"p\").mouseenter(function() {\n\tif ($(this).hasClass(\"canfocus\")) {\n\t\t$(this).addClass(\"focused\");\n\t}\n});\n\n// - mouse leave\n$(\"p\").mouseleave(function() {\n\tif ($(this).hasClass(\"canfocus\")) {\n    \t$(this).removeClass(\"focused\");\n\t\t$(this).parent().removeClass(\"pressed\");\n    }\n});\n```\n\n# \u96fb\u5353\u6a5f\u80fd\u306e\u5b9f\u88c5\n\n\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u3001\u30b5\u30fc\u30d0\u306e\u5206\u696d\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u3057\u307e\u3057\u305f\u3002\n\n- \u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u5074 \uff1a \u30ad\u30fc\u5165\u529b\u30a4\u30d9\u30f3\u30c8\u306e\u9001\u51fa\u3068\u3001\u8a08\u7b97\u5f0f\u306e\u4fdd\u6301\u3001\u7d50\u679c\u51fa\u529b\n- \u30b5\u30fc\u30d0\u5074 \uff1a \u5f0f\u306e\u6f14\u7b97\n\n\u30ad\u30fc\u3092\u62bc\u3059\u3054\u3068\u306bajax\u547c\u3073\u51fa\u3059\u3068\u3044\u3046...(\u82e6\u7b11)\n\u52c9\u5f37\u306a\u3093\u3067\u8a31\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n\u25a0 \u8a08\u7b97\u5f0f\u3068\u6f14\u7b97\u7d50\u679c\u8868\u793a\u90e8(HTML)\n\n```html\n<div class=\"grid-element3\">\n    <p id=\"fomula\"></p>\n</div>\n\n<div class=\"grid-element3\">\n    <p id=\"result\">(result)</p>\n</div>\n```\n\n\u25a0 JavaScript\n\n```js\n////////////////////////\n//\n// ajax : send fomula & get result.\n//\n////////////////////////\nfunction sendKeyEvent(fomula, lastkey) {\n\tconsole.log(\"fomula : \" + fomula + \" / last key : \" + lastkey);\n\treturn $.ajax({\n\t\ttype: \"post\",\n\t\turl:  \"./ajax_calc_engine.cgi\",\n\t\tdata: JSON.stringify({ 'fomula': fomula, 'lastkey': lastkey }),\n\t\tcontentType: \"application/json\",\n\t\tdataType:    \"html\"\n\t});\n}\n\n////////////////////////\n//\n// update\n//\n////////////////////////\nfunction update(json_data) {\n\tif (json_data.result != \"n/a\") {\n\t\t$(\"#fomula\").text(\"\");\n\t\t$(\"#result\").text(json_data.result);\n\t}\n\telse {\n\t\t$(\"#fomula\").text(json_data.fomula);\n\t}\n}\n\n////////////////////////\n//\n// event handler\n//\n////////////////////////\n$(\"p\").click(function() {\n\tconsole.log(\"click \" + $(this).text());\n\t\n\tvar key    = $(this).text();\n\tvar fomula = $(\"#fomula\").text();\n\n\tsendKeyEvent(fomula,  key).then(\n\t\tfunction(html_data) {\n\t\t\tconsole.log($.type(html_data));\n\t\t\t// console.log(html_data);\n\t\t\tvar res = $(html_data).find('#res').text();\n\t\t\tconsole.log(res);\n\t\t\tvar json = eval ( \"(\" + res + \")\" );\n\t\t\t\n\t\t\tupdate(json);\n\t\t},\n\t\tfunction() {\n\t\t\talert(\"ERROR: ajax failed.\");\n\t\t}\n\t);\n});\n```\n\n\u25a0 CGI\n\n```pl\n#!/usr/bin/perl\n\nuse lib lib; # library path\n\n# use strict;\nuse warnings;\nuse CGI;\nuse JSON;\n\n# Test script for Ajax trial\n# ajax_calc_engine.cgi\n#   04-Dec, 2015\n# by Saito Tomonobu (Tomonobu.Saito@gmail.com)\n\n# get parameter (a and b)\n$http    = new CGI;\n$json    = $http->param('POSTDATA');\n$data    = decode_json $json;\n$fomula  = $data->{\"fomula\"};\n$lastkey = $data->{\"lastkey\"};\n\n$result  = \"n/a\";\nif ($lastkey eq \"=\") {\n\t$result = eval($fomula);\n\tif ($@) {\n\t\t$result = \"ERROR: $@\";\n\t}\n} else {\n\tif ($lastkey =~ /[0-9]/) {\n\t\t$fomula = $fomula . $lastkey;\n\t} else {\n\t\t$fomula = $fomula . \" \" . $lastkey . \" \";\n\t}\n}\n\n# construct response\nmy $res = {\n\tlastkey => $lastkey,\n\tfomula  => $fomula,\n\tresult  => $result,\n};\n\n# output response (json wrapped HTML)\nprint \"Content-type: text/html; charset=utf-8\\n\";\nprint \"\\n\";\nprint \"<html><body><div id='res'>\";\nprint encode_json $res;\nprint \"</div></body></html>\\n\";\n\n# eof\n```\n\n\u8a08\u7b97\u5f0f\u306f\u3001eval\u3067\u6f14\u7b97\u5b9f\u884c\u3002\u3042\u3076\u306a\u3059\u304e\u308bw\u3002\n\u3069\u3053\u306b\u30c7\u30d7\u30ed\u30a4\u3057\u305f\u304b\u306f\u6c7a\u3057\u3066\u8a00\u3048\u307e\u305b\u3093www\u3002\n\nJavaScript\u5074\u3067\u3082json\u306e\u89e3\u91c8\u3092eval\u3067\u3084\u3063\u3066\u3044\u3066\u624b\u629c\u304d\u306a\u3093\u3067\u3059\u304c\u3001\n\u3053\u308c\u307e\u305f\u52c9\u5f37\u3068\u3044\u3046\u4e8b\u3067\u8a31\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n(\u8ffd\u8a18)\n\u3055\u3059\u304c\u306b\u5371\u306a\u3059\u304e\u308b\u306e\u3067\u3001\u7c21\u6613\u6570\u5f0f\u30c1\u30a7\u30c3\u30af\u3092\u8ffd\u52a0\u3057\u307e\u3057\u305f\u3002\n\n```pl\nif ($fomula =~ /^\\s*(-\\s*)?[0-9]+(\\s*[\\+\\-\\*\\/]\\s*(-\\s*)?[0-9]+)*\\s*$/) {\n\t$result = eval($fomula);\n\tif ($@) {\n\t\t$result = \"ERROR: $@\";\n\t}\n}\nelse {\n\t$result = \"ERROR: illegal fomula. ($fomula)\";\n}\n```\n\n#\u304a\u308f\u308a\u306b\n\n\u3053\u308c\u3067\u975e\u5e38\u306b\u5358\u7d14\u306a\u304c\u3089\u3001\njQuery + CSS + ajax \u3092\u5229\u7528\u3057\u305f\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u304c\u5b8c\u6210\u3067\u3059\u3002\n\n\u5165\u9580\u30ec\u30d9\u30eb\u306e\u6559\u6750\u306b\u306f\u8010\u3048\u307e\u3059\u304b\u306d\uff1f\n\u3048\u3001\u4eca\u65e5\u65e5\u3001\u5165\u9580\u3060\u3063\u3066\u3082\u3063\u3068\u30ec\u30d9\u30eb\u9ad8\u3044\u305e\u3001\u3063\u3066\uff1f\n\u3054\u3082\u3063\u3068\u3082\u3067\u5fae\u5875\u3082\u53cd\u8ad6\u3067\u304d\u307e\u305b\u3093\u3002\n\n\u30b3\u30fc\u30c9\u306f\u3053\u3061\u3089\u304b\u3089\u3069\u3046\u305e\nGitHub : https://github.com/Tomonobu3110/jQueryStudy/tree/master/Test/Ajax/calculator\n\n\n\u4ee5\u4e0a\u3067\u3059\u3002\n"}