{"tags": ["java8", "Hibernate", "jpa"], "context": " More than 1 year has passed since last update.\u4f9d\u5b58\u95a2\u4fc2\u306f\u3053\u3093\u306a\u611f\u3058\u306b\u8a2d\u5b9a\u3057\u307e\u3057\u305f\u3002\n<dependencies>\n  <dependency>\n    <groupId>org.hibernate</groupId>\n    <artifactId>hibernate-entitymanager</artifactId>\n    <version>4.3.8.Final</version>\n  </dependency>\n  <dependency>\n    <groupId>org.hibernate.javax.persistence</groupId>\n    <artifactId>hibernate-jpa-2.1-api</artifactId>\n    <version>1.0.0.Final</version>\n  </dependency>\n  <dependency>\n    <groupId>org.hibernate</groupId>\n    <artifactId>hibernate-c3p0</artifactId>\n    <version>4.3.8.Final</version>\n  </dependency>\n  <dependency>\n    <groupId>org.mariadb.jdbc</groupId>\n    <artifactId>mariadb-java-client</artifactId>\n    <version>1.1.8</version>\n  </dependency>\n  <dependency>\n    <groupId>org.jinq</groupId>\n    <artifactId>jinq-jpa</artifactId>\n    <version>1.6</version>\n  </dependency>\n</dependencies>\n\nDatabase\u5b9a\u7fa9\u306f\u3053\u3093\u306a\u611f\u3058\u3067\u3059\u3002MariaDB\u3092\u4f7f\u3044\u307e\u3057\u305f\u3002\n\nIDEA\u304b\u3089Add Framework Support\u3092\u9078\u3073\n\nHibernate\u3092\u9078\u629e\n\nImport database schema\u306b\u30c1\u30a7\u30c3\u30af\u3092\u5165\u308c\u3066\u304a\u3051\u3070DB\u304b\u3089\u306eScaffolding\u30a6\u30a3\u30b6\u30fc\u30c9\u304c\u7acb\u3061\u4e0a\u304c\u308a\u307e\u3059\u3002\n\n\u3053\u306e\u4f8b\u3067\u306fmodes\u4ee5\u4e0b\u306bDB\u306e\u30c6\u30fc\u30d6\u30eb\u5b9a\u7fa9\u304b\u3089\u4f5c\u6210\u3055\u308c\u305fentity\u30af\u30e9\u30b9\u304c\u4f5c\u6210\u3055\u308c\u307e\u3059\u3002\n\nresources\\META-INF \u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u304c\u7121\u3051\u308c\u3070\u4f5c\u6210\u3057\u3001persistence.xml\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<persistence xmlns=\"http://java.sun.com/xml/ns/persistence\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xsi:schemaLocation=\"http://java.sun.com/xml/ns/persistence http://java.sun.com/xml/ns/persistence/persistence_2_0.xsd\"\n             version=\"2.0\">\n\n    <persistence-unit name=\"samplePersistenceUnit\" transaction-type=\"RESOURCE_LOCAL\">\n        <provider>org.hibernate.jpa.HibernatePersistenceProvider</provider>\n        <class>com.company.models.CustomerEntity</class>\n        <properties>\n            <property name=\"hibernate.connection.url\" value=\"jdbc:mysql://localhost:3306/sample\"/>\n            <property name=\"hibernate.connection.driver_class\" value=\"org.mariadb.jdbc.Driver\"/>\n            <property name=\"hibernate.connection.username\" value=\"sample\"/>\n            <property name=\"hibernate.connection.password\" value=\"sample\"/>\n            <property name=\"hibernate.archive.autodetection\" value=\"class\"/>\n            <property name=\"hibernate.show_sql\" value=\"true\"/>\n            <property name=\"hibernate.format_sql\" value=\"true\"/>\n            <property name=\"hibernate.dialect\" value=\"org.hibernate.dialect.MySQL5InnoDBDialect\"/>\n            <property name=\"hibernate.c3p0.min_size\" value=\"5\" />\n            <property name=\"hibernate.c3p0.max_size\" value=\"20\" />\n            <property name=\"hibernate.c3p0.timeout\" value=\"500\" />\n            <property name=\"hibernate.c3p0.max_statements\" value=\"50\" />\n            <property name=\"hibernate.c3p0.idle_test_period\" value=\"2000\" />\n\n            <!--\n            <property name=\"hbm2ddl.auto\" value=\"update\"/>\n            -->\n        </properties>\n    </persistence-unit>\n</persistence>\n\n\u52d5\u4f5c\u78ba\u8a8d\u3002\u8d77\u52d5\u30e1\u30bd\u30c3\u30c9\u304b\u3089Select\u3092\u8a66\u3057\u3066\u307f\u307e\u3059\u3002\n\u6700\u521d\u306esetPersistenceProviderResolver\u306f\u3001\u66f8\u3044\u3066\u304a\u304b\u306a\u3044\u3068Hibernate\u304cWarning\u3092\u5410\u304d\u3084\u304c\u308a\u307e\u3059\u3002\npublic class Main {\n\n    public static void main(String[] args) {\n        // http://stackoverflow.com/questions/27332066/hibernate-warning-about-persistenceprovider-occurs-even-if-correct-provider-is-g\n        PersistenceProviderResolverHolder.setPersistenceProviderResolver(\n                new PersistenceProviderResolver() {\n                    private final List<PersistenceProvider> providers_ = asList((PersistenceProvider) new HibernatePersistenceProvider());\n\n                    @Override\n                    public List<PersistenceProvider> getPersistenceProviders() {\n                        return providers_;\n                    }\n\n                    @Override\n                    public void clearCachedProviders() {\n                    }\n                });\n\n\n\n        EntityManagerFactory factory = Persistence.createEntityManagerFactory(\"samplePersistenceUnit\");\n        EntityManager manager = factory.createEntityManager();\n        JinqJPAStreamProvider provider = new JinqJPAStreamProvider(manager.getMetamodel());\n        JPAJinqStream<CustomerEntity> stream = provider.streamAll(manager, CustomerEntity.class)\n                .where(c -> c.getId() > 0 && c.getStatus().equals(\"0\"));\n\n        List<CustomerEntity> list = stream.toList();\n\n    }\n}\n\n\n\u666e\u901a\u306b\u30e9\u30e0\u30c0\u3067\u30af\u30a8\u30ea\u306eWhere\u6761\u4ef6\u304c\u8a18\u8ff0\u3067\u304d\u307e\u3057\u305f\u3002\n\u305f\u3060\u3001AST\u304b\u3089\u30af\u30a8\u30ea\u3092\u751f\u6210\u3059\u308b\u3068\u3053\u308d\u306b\u30cf\u30de\u308a\u30dd\u30a4\u30f3\u30c8\u304c\u591a\u3044\u306e\u3067\u3001\u6b63\u76f4Jinq\u306f\u307e\u3060\u5b9f\u7528\u30ec\u30d9\u30eb\u3067\u306f\u7121\u3044\u3068\u3044\u3046\u306e\u304c\u6b63\u76f4\u306a\u6240\u3002\n\u4f9d\u5b58\u95a2\u4fc2\u306f\u3053\u3093\u306a\u611f\u3058\u306b\u8a2d\u5b9a\u3057\u307e\u3057\u305f\u3002\n\n```xml\n<dependencies>\n  <dependency>\n    <groupId>org.hibernate</groupId>\n    <artifactId>hibernate-entitymanager</artifactId>\n    <version>4.3.8.Final</version>\n  </dependency>\n  <dependency>\n    <groupId>org.hibernate.javax.persistence</groupId>\n    <artifactId>hibernate-jpa-2.1-api</artifactId>\n    <version>1.0.0.Final</version>\n  </dependency>\n  <dependency>\n    <groupId>org.hibernate</groupId>\n    <artifactId>hibernate-c3p0</artifactId>\n    <version>4.3.8.Final</version>\n  </dependency>\n  <dependency>\n    <groupId>org.mariadb.jdbc</groupId>\n    <artifactId>mariadb-java-client</artifactId>\n    <version>1.1.8</version>\n  </dependency>\n  <dependency>\n    <groupId>org.jinq</groupId>\n    <artifactId>jinq-jpa</artifactId>\n    <version>1.6</version>\n  </dependency>\n</dependencies>\n```\n\nDatabase\u5b9a\u7fa9\u306f\u3053\u3093\u306a\u611f\u3058\u3067\u3059\u3002MariaDB\u3092\u4f7f\u3044\u307e\u3057\u305f\u3002\n![2.png](https://qiita-image-store.s3.amazonaws.com/0/28321/e0b0fe78-6d69-21ca-1105-f27be7fd80f0.png)\n\nIDEA\u304b\u3089Add Framework Support\u3092\u9078\u3073\n![3.png](https://qiita-image-store.s3.amazonaws.com/0/28321/76b5e571-67a2-c2e7-6ade-0559d02e0b43.png)\n\nHibernate\u3092\u9078\u629e\n![4.png](https://qiita-image-store.s3.amazonaws.com/0/28321/5318a26a-37d6-60b0-e014-833e1a6e4080.png)\n\nImport database schema\u306b\u30c1\u30a7\u30c3\u30af\u3092\u5165\u308c\u3066\u304a\u3051\u3070DB\u304b\u3089\u306eScaffolding\u30a6\u30a3\u30b6\u30fc\u30c9\u304c\u7acb\u3061\u4e0a\u304c\u308a\u307e\u3059\u3002\n![5.png](https://qiita-image-store.s3.amazonaws.com/0/28321/d052abe7-342a-fd21-2825-93ebddd14a0c.png)\n\u3053\u306e\u4f8b\u3067\u306fmodes\u4ee5\u4e0b\u306bDB\u306e\u30c6\u30fc\u30d6\u30eb\u5b9a\u7fa9\u304b\u3089\u4f5c\u6210\u3055\u308c\u305fentity\u30af\u30e9\u30b9\u304c\u4f5c\u6210\u3055\u308c\u307e\u3059\u3002\n\n\n![6.png](https://qiita-image-store.s3.amazonaws.com/0/28321/e3a021d9-00d7-2cbb-f88a-e958b3016efc.png)\n\nresources\\META-INF \u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u304c\u7121\u3051\u308c\u3070\u4f5c\u6210\u3057\u3001persistence.xml\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\n```xml\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<persistence xmlns=\"http://java.sun.com/xml/ns/persistence\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xsi:schemaLocation=\"http://java.sun.com/xml/ns/persistence http://java.sun.com/xml/ns/persistence/persistence_2_0.xsd\"\n             version=\"2.0\">\n\n    <persistence-unit name=\"samplePersistenceUnit\" transaction-type=\"RESOURCE_LOCAL\">\n        <provider>org.hibernate.jpa.HibernatePersistenceProvider</provider>\n        <class>com.company.models.CustomerEntity</class>\n        <properties>\n            <property name=\"hibernate.connection.url\" value=\"jdbc:mysql://localhost:3306/sample\"/>\n            <property name=\"hibernate.connection.driver_class\" value=\"org.mariadb.jdbc.Driver\"/>\n            <property name=\"hibernate.connection.username\" value=\"sample\"/>\n            <property name=\"hibernate.connection.password\" value=\"sample\"/>\n            <property name=\"hibernate.archive.autodetection\" value=\"class\"/>\n            <property name=\"hibernate.show_sql\" value=\"true\"/>\n            <property name=\"hibernate.format_sql\" value=\"true\"/>\n            <property name=\"hibernate.dialect\" value=\"org.hibernate.dialect.MySQL5InnoDBDialect\"/>\n            <property name=\"hibernate.c3p0.min_size\" value=\"5\" />\n            <property name=\"hibernate.c3p0.max_size\" value=\"20\" />\n            <property name=\"hibernate.c3p0.timeout\" value=\"500\" />\n            <property name=\"hibernate.c3p0.max_statements\" value=\"50\" />\n            <property name=\"hibernate.c3p0.idle_test_period\" value=\"2000\" />\n\n            <!--\n            <property name=\"hbm2ddl.auto\" value=\"update\"/>\n            -->\n        </properties>\n    </persistence-unit>\n</persistence>\n```\n\n\u52d5\u4f5c\u78ba\u8a8d\u3002\u8d77\u52d5\u30e1\u30bd\u30c3\u30c9\u304b\u3089Select\u3092\u8a66\u3057\u3066\u307f\u307e\u3059\u3002\n\u6700\u521d\u306esetPersistenceProviderResolver\u306f\u3001\u66f8\u3044\u3066\u304a\u304b\u306a\u3044\u3068Hibernate\u304cWarning\u3092\u5410\u304d\u3084\u304c\u308a\u307e\u3059\u3002\n\n```java\npublic class Main {\n\n    public static void main(String[] args) {\n        // http://stackoverflow.com/questions/27332066/hibernate-warning-about-persistenceprovider-occurs-even-if-correct-provider-is-g\n        PersistenceProviderResolverHolder.setPersistenceProviderResolver(\n                new PersistenceProviderResolver() {\n                    private final List<PersistenceProvider> providers_ = asList((PersistenceProvider) new HibernatePersistenceProvider());\n\n                    @Override\n                    public List<PersistenceProvider> getPersistenceProviders() {\n                        return providers_;\n                    }\n\n                    @Override\n                    public void clearCachedProviders() {\n                    }\n                });\n\n\n\n        EntityManagerFactory factory = Persistence.createEntityManagerFactory(\"samplePersistenceUnit\");\n        EntityManager manager = factory.createEntityManager();\n        JinqJPAStreamProvider provider = new JinqJPAStreamProvider(manager.getMetamodel());\n        JPAJinqStream<CustomerEntity> stream = provider.streamAll(manager, CustomerEntity.class)\n                .where(c -> c.getId() > 0 && c.getStatus().equals(\"0\"));\n\n        List<CustomerEntity> list = stream.toList();\n\n    }\n}\n\n```\n\u666e\u901a\u306b\u30e9\u30e0\u30c0\u3067\u30af\u30a8\u30ea\u306eWhere\u6761\u4ef6\u304c\u8a18\u8ff0\u3067\u304d\u307e\u3057\u305f\u3002\n\u305f\u3060\u3001AST\u304b\u3089\u30af\u30a8\u30ea\u3092\u751f\u6210\u3059\u308b\u3068\u3053\u308d\u306b\u30cf\u30de\u308a\u30dd\u30a4\u30f3\u30c8\u304c\u591a\u3044\u306e\u3067\u3001\u6b63\u76f4Jinq\u306f\u307e\u3060\u5b9f\u7528\u30ec\u30d9\u30eb\u3067\u306f\u7121\u3044\u3068\u3044\u3046\u306e\u304c\u6b63\u76f4\u306a\u6240\u3002\n"}