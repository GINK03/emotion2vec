{"context": "\n\n\u6ce8\u610f\n\u3053\u306e\u6295\u7a3f\u306fCentOS 6\u306bLEMP\u74b0\u5883\u3092\u69cb\u7bc9\u3059\u308b\uff08OS\u8a2d\u5b9a\u7de8\uff09\u306e\u7d9a\u7de8\u3067\u3059\u3002\n\u6295\u7a3f\u8005\u306f\u30a4\u30f3\u30d5\u30e9\u69cb\u7bc9\u306b\u8208\u5473\u306e\u3042\u308b\u5b66\u751f\uff08\u7d20\u4eba\uff09\u306e\u305f\u3081\u3001\u81ea\u5df1\u8cac\u4efb\u3067\u304a\u306d\u304c\u3044\u3057\u307e\u3059\u3002\n\nLEMP\u74b0\u5883\u306e\u69cb\u7bc9\u30ea\u30f3\u30af\n\nCentOS 6\u306bLEMP\u74b0\u5883\u3092\u69cb\u7bc9\u3059\u308b\uff08OS\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u7de8\uff09\nCentOS 6\u306bLEMP\u74b0\u5883\u3092\u69cb\u7bc9\u3059\u308b\uff08OS\u8a2d\u5b9a\u7de8\uff09\n\u3010\u4eca\u56de\u3011CentOS 6\u306bLEMP\u74b0\u5883\u3092\u69cb\u7bc9\u3059\u308b\uff08\u30bd\u30d5\u30c8\u30a6\u30a7\u30a2\u7de8\uff09\n\n\n\u30df\u30c9\u30eb\u30a6\u30a7\u30a2\u306e\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\n\u521d\u671f\u8a2d\u5b9a\u304c\u5b8c\u4e86\u3057\u307e\u3057\u305f\u3089\u3001\u3044\u3088\u3044\u3088\u30df\u30c9\u30eb\u30a6\u30a7\u30a2\u306e\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\u3092\u884c\u3044\u307e\u3059\u3002\n\u5c0e\u5165\u3059\u308b\u30df\u30c9\u30eb\u30a6\u30a7\u30a2\u306f\n\nNginx\uff08Mainline version\uff09\nPHP 7\nMySQL\n\n\u3067\u3059\u3002\nNginx\u306b\u3064\u3044\u3066\u306fLet's Encrypt\u3092\u4f7f\u7528\u3057\u3066HTTP/2\u5bfe\u5fdc\u3001Google\u306ePageSpeed Module\u3068Cache Purge\u30e2\u30b8\u30e5\u30fc\u30eb\u3092\u5c0e\u5165\u3057\u307e\u3059\u3002\n\u6700\u7d42\u7684\u306bWordPress\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u307e\u3067\u884c\u3044\u307e\u3059\u3002\n\nNginx\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\nWeb\u30b5\u30fc\u30d0\u3068\u3057\u3066 Apache \u3067\u306f\u306a\u304f\u3001Nginx \u3092\u63a1\u7528\u3057\u307e\u3059\u3002\nNginx \u306f\u5c11\u306a\u3044\u30ea\u30bd\u30fc\u30b9\u3067\u52d5\u4f5c\u3059\u308b\u305f\u3081\u3001\u4eca\u56de\u306e\u3088\u3046\u306a\u30ea\u30bd\u30fc\u30b9\u306b\u4f59\u88d5\u304c\u306a\u3044\u5834\u5408\u306b\u6700\u9069\u3067\u3059\u3002\n\u30e2\u30b8\u30e5\u30fc\u30eb\u3092\u8ffd\u52a0\u3059\u308b\u305f\u3081\u3001\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u304b\u3089\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\n\u306a\u304a\u3001\u30b3\u30de\u30f3\u30c9\u304c\u591a\u3044\u305f\u3081\u8aac\u660e\u306f\u5c11\u306a\u3081\u3068\u306a\u3063\u3066\u3044\u307e\u3059\u3002\n\n\u524d\u6e96\u5099\nNginx\u7528\u306e\u30e6\u30fc\u30b6\u30fc\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\nuseradd -s /sbin/nologin nginx\nCentOS\u306eGCC/G++\u306f\u53e4\u3044\u305f\u3081\u3001Devtoolset-2\u30ea\u30dd\u30b8\u30c8\u30ea\u3092\u5c0e\u5165\u3057\u307e\u3059\u3002\uff08PageSpeed Module \u306e\u30a8\u30e9\u30fc\u5bfe\u7b56\uff09\n\u53c2\u8003\uff1aCentOS\u306b\u65b0\u3057\u3044\u30d0\u30fc\u30b8\u30e7\u30f3\u306eGCC/G++(4.8/4.9)\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b - TASK NOTES\n\u4ee5\u4e0b\u306e\u30b3\u30de\u30f3\u30c9\u3092\u9806\u756a\u306b\u5b9f\u884c\u3057\u307e\u3059\u3002\ncd /etc/yum.repos.d/\nwget http://people.centos.org/tru/devtools-2/devtools-2.repo\nyum -y install devtoolset-2-gcc devtoolset-2-binutils devtoolset-2-gcc-c++ devtoolset-2-gcc-gfortran\nscl enable devtoolset-2 bash\ncd\n\n\u5fc5\u8981\u306a\u30d1\u30c3\u30b1\u30fc\u30b8\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\nyum -y install pcre-devel openssl openssl-devel\n\n\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u306e\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\nNginx\u3001Cache Purge\u30e2\u30b8\u30e5\u30fc\u30eb\u3001PageSpeed Module\u30e2\u30b8\u30e5\u30fc\u30eb\u306e\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3057\u307e\u3059\u3002\n\u307e\u305a\u3001Nginx\u306e\u6700\u65b0\u30d0\u30fc\u30b8\u30e7\u30f3\u3092nginx: download\u304b\u3089\u78ba\u8a8d\u3057\u307e\u3059\u3002\nMainline\u7248\u3068Stable\u7248\u304c\u3042\u308a\u307e\u3059\u304c\u3001\u4eca\u56de\u306fMainline\u7248\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3057\u307e\u3059\u3002\n\u5099\u5fd8\u9332: Nginx\u306estable\u7248\u3068mainline\u7248\u306b\u95a2\u3057\u3066\n\u30d0\u30fc\u30b8\u30e7\u30f3\u306e\u78ba\u8a8d\u304c\u6e08\u3093\u3060\u3089\u3001\u4ee5\u4e0b\u306e\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3057\u307e\u3059\u3002\n1.11.10\u306e\u90e8\u5206\u306f\u30d0\u30fc\u30b8\u30e7\u30f3\u305f\u3081\u3001\u78ba\u8a8d\u3057\u305f\u30d0\u30fc\u30b8\u30e7\u30f3\u306b\u5909\u66f4\u3057\u3066\u304f\u3060\u3055\u3044\u3002\nNGINX_VERSION=1.11.10\nwget http://nginx.org/download/nginx-${NGINX_VERSION}.tar.gz\ntar -xvzf nginx-${NGINX_VERSION}.tar.gz\n\n\u6b21\u306b\u3001Cache Purge\u30e2\u30b8\u30e5\u30fc\u30eb\u306e\u6700\u65b0\u30d0\u30fc\u30b8\u30e7\u30f3\u3092FRiCKLE Labs / nginx / ngx_cache_purge\u304b\u3089\u78ba\u8a8d\u3057\u307e\u3059\u3002\n\u30d0\u30fc\u30b8\u30e7\u30f3\u306e\u78ba\u8a8d\u304c\u6e08\u3093\u3060\u3089\u3001\u4ee5\u4e0b\u306e\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3057\u307e\u3059\u3002\n2.3\u306e\u90e8\u5206\u306f\u30d0\u30fc\u30b8\u30e7\u30f3\u305f\u3081\u3001\u78ba\u8a8d\u3057\u305f\u30d0\u30fc\u30b8\u30e7\u30f3\u306b\u5909\u66f4\u3057\u3066\u304f\u3060\u3055\u3044\u3002\nNCP_VERSION=2.3\nwget http://labs.frickle.com/files/ngx_cache_purge-${NCP_VERSION}.tar.gz\ntar -xvzf ngx_cache_purge-${NCP_VERSION}.tar.gz\n\n\n\u6700\u5f8c\u306b\u3001PageSpeed Module\u30e2\u30b8\u30e5\u30fc\u30eb\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3057\u307e\u3059\u3002\u4ed6\u306b\u6bd4\u3079\u5c11\u3057\u9577\u304f\u306a\u3063\u3066\u3044\u307e\u3059\u3002\n\u53c2\u8003\uff1aBuild ngx_pagespeed From Source\nPageSpeed Release Notes\u304b\u3089\u6700\u65b0\u30d0\u30fc\u30b8\u30e7\u30f3\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\n\u4ee5\u4e0b\u306e\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3057\u307e\u3059\u3002\n1.12.34.2\u306e\u90e8\u5206\u306f\u30d0\u30fc\u30b8\u30e7\u30f3\u305f\u3081\u3001\u78ba\u8a8d\u3057\u305f\u30d0\u30fc\u30b8\u30e7\u30f3\u306b\u5909\u66f4\u3057\u3066\u304f\u3060\u3055\u3044\u3002\nNPS_VERSION=1.12.34.2\nwget https://github.com/pagespeed/ngx_pagespeed/archive/v${NPS_VERSION}-beta.zip\nunzip v${NPS_VERSION}-beta.zip\ncd ngx_pagespeed-${NPS_VERSION}-beta/\npsol_url=https://dl.google.com/dl/page-speed/psol/${NPS_VERSION}.tar.gz\n[ -e scripts/format_binary_url.sh ] && psol_url=$(scripts/format_binary_url.sh PSOL_BINARY_URL)\nwget ${psol_url}\ntar -xzvf $(basename ${psol_url})\n\n\n\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u306e\u6e96\u5099\u304c\u6574\u3063\u305f\u3089\u3001\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3092\u884c\u3044\u307e\u3059\u3002\n\u30d1\u30e9\u30e1\u30fc\u30bf\u30fc\u306f\u5fc5\u8981\u306b\u5fdc\u3058\u3066\u5909\u66f4\u3057\u3066\u304f\u3060\u3055\u3044\u3002\ncd ~/nginx-${NGINX_VERSION}/\n./configure --prefix=/etc/nginx --conf-path=/etc/nginx/nginx.conf --sbin-path=/usr/sbin/nginx --error-log-path=/var/log/nginx/error.log --http-fastcgi-temp-path=/var/lib/nginx/fastcgi --http-log-path=/var/log/nginx/access.log --http-scgi-temp-path=/var/lib/nginx/scgi --http-uwsgi-temp-path=/var/lib/nginx/uwsgi --lock-path=/var/lock/subsys/nginx.lock --pid-path=/var/run/nginx.pid --with-http_gzip_static_module --with-http_ssl_module --with-http_v2_module --add-module=$HOME/ngx_pagespeed-${NPS_VERSION}-beta --add-module=$HOME/ngx_cache_purge-${NCP_VERSION} ${PS_NGX_EXTRA_FLAGS}\n\n\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb!!\nmake\nmake install\n\n\n\u521d\u671f\u8a2d\u5b9a\n\u8d77\u52d5\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\nvi /etc/init.d/nginx\n\u300ci\u30ad\u30fc\u300d\u3092\u30af\u30ea\u30c3\u30af\u3057\u3066\u7de8\u96c6\u30e2\u30fc\u30c9\u306b\u79fb\u884c\u3057\u3001\u4ee5\u4e0b\u306e\u30b3\u30fc\u30c9\u3092\u3059\u3079\u3066\u30b3\u30d4\u30da\u3057\u307e\u3059\u3002\n\nnginx\n#!/bin/sh\n#\n# nginx - this script starts and stops the nginx daemon\n#\n# chkconfig:   - 85 15\n# description:  NGINX is an HTTP(S) server, HTTP(S) reverse \\\n#               proxy and IMAP/POP3 proxy server\n# processname: nginx\n# config:      /etc/nginx/nginx.conf\n# config:      /etc/sysconfig/nginx\n# pidfile:     /var/run/nginx.pid\n\n# Source function library.\n. /etc/rc.d/init.d/functions\n\n# Source networking configuration.\n. /etc/sysconfig/network\n\n# Check that networking is up.\n[ \"$NETWORKING\" = \"no\" ] && exit 0\n\nnginx=\"/usr/sbin/nginx\"\nprog=$(basename $nginx)\n\nNGINX_CONF_FILE=\"/etc/nginx/nginx.conf\"\n\n[ -f /etc/sysconfig/nginx ] && . /etc/sysconfig/nginx\n\nlockfile=/var/lock/subsys/nginx\n\nmake_dirs() {\n   # make required directories\n   user=`$nginx -V 2>&1 | grep \"configure arguments:.*--user=\" | sed 's/[^*]*--user=\\([^ ]*\\).*/\\1/g' -`\n   if [ -n \"$user\" ]; then\n      if [ -z \"`grep $user /etc/passwd`\" ]; then\n         useradd -M -s /bin/nologin $user\n      fi\n      options=`$nginx -V 2>&1 | grep 'configure arguments:'`\n      for opt in $options; do\n          if [ `echo $opt | grep '.*-temp-path'` ]; then\n              value=`echo $opt | cut -d \"=\" -f 2`\n              if [ ! -d \"$value\" ]; then\n                  # echo \"creating\" $value\n                  mkdir -p $value && chown -R $user $value\n              fi\n          fi\n       done\n    fi\n}\n\nstart() {\n    [ -x $nginx ] || exit 5\n    [ -f $NGINX_CONF_FILE ] || exit 6\n    make_dirs\n    echo -n $\"Starting $prog: \"\n    daemon $nginx -c $NGINX_CONF_FILE\n    retval=$?\n    echo\n    [ $retval -eq 0 ] && touch $lockfile\n    return $retval\n}\n\nstop() {\n    echo -n $\"Stopping $prog: \"\n    killproc $prog -QUIT\n    retval=$?\n    echo\n    [ $retval -eq 0 ] && rm -f $lockfile\n    return $retval\n}\n\nrestart() {\n    configtest || return $?\n    stop\n    sleep 1\n    start\n}\n\nreload() {\n    configtest || return $?\n    echo -n $\"Reloading $prog: \"\n    killproc $nginx -HUP\n    RETVAL=$?\n    echo\n}\n\nforce_reload() {\n    restart\n}\n\nconfigtest() {\n  $nginx -t -c $NGINX_CONF_FILE\n}\n\nrh_status() {\n    status $prog\n}\n\nrh_status_q() {\n    rh_status >/dev/null 2>&1\n}\n\ncase \"$1\" in\n    start)\n        rh_status_q && exit 0\n        $1\n        ;;\n    stop)\n        rh_status_q || exit 0\n        $1\n        ;;\n    restart|configtest)\n        $1\n        ;;\n    reload)\n        rh_status_q || exit 7\n        $1\n        ;;\n    force-reload)\n        force_reload\n        ;;\n    status)\n        rh_status\n        ;;\n    condrestart|try-restart)\n        rh_status_q || exit 0\n            ;;\n    *)\n        echo $\"Usage: $0 {start|stop|status|restart|condrestart|try-restart|reload|force-reload|configtest}\"\n        exit 2\nesac\n\n\n\u51fa\u5178\uff1aRed Hat NGINX Init Script | NGINX\n\u30da\u30fc\u30b9\u30c8\u3055\u308c\u305f\u3089\u300cESC\u30ad\u30fc\u300d\u3092\u30af\u30ea\u30c3\u30af\u3057\u3066\u3001\u300c:wq\u300d\u3068\u5165\u529b\u3057\u3066\u4fdd\u5b58\u3057\u307e\u3059\u3002\n\u5b9f\u884c\u6a29\u9650\u3092\u4ed8\u4e0e\u3057\u307e\u3059\u3002\nchmod +x /etc/init.d/nginx\n\u3000\n\u516c\u958b\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\nmkdir -p /var/www/wordpress\n\u516c\u958b\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306e\u30d1\u30b9\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\nsed -i 's/root   html/root   \\/var\\/www\\/wordpress/g' /etc/nginx/nginx.conf\nFastCGI\u7528\u306eTEMP\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\nmkdir -p /var/lib/nginx/fastcgi\nNginx\u3092\u8d77\u52d5\u3057\u307e\u3059\u3002\nservice nginx start\n\u7dd1\u8272\u3067OK\u3068\u8868\u793a\u3055\u308c\u305f\u3089\u6210\u529f\u3067\u3059\u3002\u81ea\u52d5\u8d77\u52d5\u306b\u8a2d\u5b9a\u3057\u307e\u3059\u3002\nchkconfig nginx on\n\nLet's Encrypt\u306e\u5c0e\u5165\nLet's Encrypt\u306f\u3001\u7121\u6599\u306eSSL/TLS\u8a3c\u660e\u66f8\u767a\u884c\u30b5\u30fc\u30d3\u30b9\u3067\u3059\u3002\n\u72ec\u81ea\u30c9\u30e1\u30a4\u30f3\u3055\u308c\u3042\u308c\u3070\u3001\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u306e\u767b\u9332\u3060\u3051\u3067\u8a3c\u660e\u66f8\u304c\u81ea\u52d5\u767a\u884c\u3055\u308c\u307e\u3059\u3002\n\u8a73\u3057\u304f\u306fLet's Encrypt \u7dcf\u5408\u30dd\u30fc\u30bf\u30eb\n\u3082\u3057\u304f\u306fLet\u2019s Encrypt\u306eSSL\u8a3c\u660e\u66f8\u3067\u3001\u5b89\u5168\u306a\u30a6\u30a7\u30d6\u30b5\u30a4\u30c8\u3092\u516c\u958b - \u3055\u304f\u3089\u306e\u30ca\u30ec\u30c3\u30b8\nLet\u2019s Encrypt client\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\ngit clone https://github.com/letsencrypt/letsencrypt\n\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u305f\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u79fb\u52d5\u3057\u307e\u3059\u3002\ncd letsencrypt\n\u8a3c\u660e\u66f8\u3092\u767a\u884c\u3057\u307e\u3059\u3002\u30c9\u30e1\u30a4\u30f3\u306e\u90e8\u5206\u306f\u304a\u6301\u3061\u306e\u72ec\u81ea\u30c9\u30e1\u30a4\u30f3\u306b\u5909\u66f4\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n./letsencrypt-auto certonly --webroot -w /var/www/wordpress -d \u30c9\u30e1\u30a4\u30f3m\nEnter email address\u3068\u8868\u793a\u3055\u308c\u305f\u3089\u3001\u304a\u6301\u3061\u306e\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u3092\u5165\u529b\u3057\u307e\u3059\u3002\n\u8a3c\u660e\u66f8\u306e\u671f\u9650\u304c\u8fd1\u3065\u304f\u3068\u767b\u9332\u3057\u305f\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u5b9b\u306b\u901a\u77e5\u304c\u5c4a\u304d\u307e\u3059\u3002\n(A)gree/(C)ancel:\u3068\u8868\u793a\u3055\u308c\u305f\u3089\u3001A\u3092\u5165\u529b\u3057\u307e\u3059\u3002\u5229\u7528\u898f\u7d04\u306e\u540c\u610f\u3067\u3059\u3002\n(Y)es/(N)o:\u3068\u8868\u793a\u3055\u308c\u305f\u3089\u3001Y\u3092\u5165\u529b\u3057\u307e\u3059\u3002\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u306e\u5171\u6709\u3067\u3059\u3002\n\u9ec4\u8272\u3067IMPORTANT NOTES:\u3068\u8868\u793a\u3055\u308c\u305f\u3089\u3001\u8a3c\u660e\u66f8\u306e\u767a\u884c\u306f\u5b8c\u4e86\u3067\u3059\u3002\n\u203b\u9014\u4e2d\u306e\u30a8\u30e9\u30fc\u306f\u300c\u5b89\u5b9a\u52d5\u4f5c\u306e\u305f\u3081\u306b\u306fPython 2.7\u300d\u304c\u5fc5\u8981\u3068\u3044\u3046\u5185\u5bb9\u3067\u3059\u3002\nVersion 0.9.3\u4ee5\u964d\u3067\u3042\u308c\u3070\u3001Let\u2019s Encrypt client\u306f\u6b63\u5e38\u306b\u52d5\u4f5c\u3057\u307e\u3059\u3002\n\u53c2\u8003\uff1aCentOS 6 \u3067\u767a\u751f\u3059\u308b\u30a8\u30e9\u30fc\u306e\u5bfe\u51e6\u6cd5 - Let's Encrypt \u7dcf\u5408\u30dd\u30fc\u30bf\u30eb\nPython 2.6 is no longer supported by the Python core team, please upgrade your Python. A future version of cryptography will drop support for Python 2.6\n\n\n\u8a3c\u660e\u66f8\u306e\u767a\u884c\u306e\u81ea\u52d5\u5316\nLet's Encrypt\u3067\u767a\u884c\u3055\u308c\u308b\u8a3c\u660e\u66f8\u306f\u6709\u52b9\u671f\u9593\u304c90\u65e5\u3067\u3059\u3002\n\u5b9a\u671f\u7684\u306b\u66f4\u65b0\u3059\u308b\u306e\u306f\u624b\u9593\u306e\u305f\u3081\u3001cron\u3067\u81ea\u52d5\u5316\u3057\u307e\u3059\u3002\ncron\u306e\u8a2d\u5b9a\u3092\u958b\u304d\u307e\u3059\u3002\ncrontab -e\n\u81ea\u52d5\u66f4\u65b0\u30b3\u30de\u30f3\u30c9\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n\u300ci\u30ad\u30fc\u300d\u3092\u30af\u30ea\u30c3\u30af\u3057\u3066\u7de8\u96c6\u30e2\u30fc\u30c9\u306b\u79fb\u884c\u3057\u3001\u4ee5\u4e0b\u306e\u30b3\u30fc\u30c9\u3092\u30b3\u30d4\u30da\u3057\u307e\u3059\u3002\n00 06 10 */2 * /root/letsencrypt/letsencrypt-auto renew\n\u203b60\u65e5\u3054\u3068\u306e\u66f4\u65b0\u304c\u63a8\u5968\u3055\u308c\u3066\u3044\u308b\u305f\u3081\u3001\u9694\u6708\u306710\u65e5\u306e\u5348\u524d6\u6642\u306b\u8a2d\u5b9a\u3057\u3066\u3044\u307e\u3059\u3002\n\u30da\u30fc\u30b9\u30c8\u3055\u308c\u305f\u3089\u300cESC\u30ad\u30fc\u300d\u3092\u30af\u30ea\u30c3\u30af\u3057\u3066\u3001\u300c:wq\u300d\u3068\u5165\u529b\u3057\u3066\u4fdd\u5b58\u3057\u307e\u3059\u3002\n\nSSL Labs\u3067A+\u8a55\u4fa1\n\u4e01\u5ea6\u826f\u3044\u6a5f\u4f1a\u306e\u305f\u3081\u3001SSL Labs \u3067A+\u8a55\u4fa1\u3068\u306a\u308b\u3088\u3046\u306b\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n\u203bSSL Labs \u306fSSL\u8a2d\u5b9a\u306e\u8a55\u4fa1\u30c4\u30fc\u30eb\u3002A+\u8a55\u4fa1\uff1d\u5b89\u5168\u3067\u306f\u306a\u3044\u306e\u3067\u6ce8\u610f\u3002\n2048bit\u306eDH\u9375\u3092\u751f\u6210\u3057\u307e\u3059\u3002\nopenssl dhparam 2048 -out /etc/nginx/dhparam.pem\n\nNginx\u306e\u8a2d\u5b9a\nNginx \u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u304c\u5b8c\u4e86\u3057\u307e\u3057\u305f\u3089\u3001\u516c\u958b\u7528\u306e\u8a2d\u5b9a\u3092\u884c\u3044\u307e\u3059\u3002\n\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3092\u7de8\u96c6\u3057\u3066\u3044\u304d\u307e\u3059\u304c\u3001\u8a2d\u5b9a\u5185\u5bb9\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u306a\u3063\u3066\u3044\u307e\u3059\u3002\n\nWordPress\u7528\nSSL\u3001HTTP/2\u7528\n\u30ad\u30e3\u30c3\u30b7\u30e5\u3068\u3057\u3066Fastcgi Cache\u3092\u4f7f\u7528\n\u5b9a\u756a\u306e\u9ad8\u901f\u5316\u8a2d\u5b9a\uff08Gzip\u306a\u3069\uff09\n\u5b9a\u756a\u306e\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u8a2d\u5b9a\uff08X-XSS-Protection\u306a\u3069\uff09\n\u30a2\u30af\u30bb\u30b9\u30ed\u30b0\u306e\u4e00\u90e8\u7121\u52b9\u5316\uff08favicon.ico\u306a\u3069\uff09\n\nSSL\u306e\u90e8\u5206\u306fGenerate Mozilla Security Recommended Web Server Configuration Files\u3092\u53c2\u8003\u306b\u3057\u3066\u3044\u307e\u3059\u3002\n\u30ad\u30e3\u30c3\u30b7\u30e5\u306e\u6709\u52b9\u671f\u9650\u306a\u3069\u306f\u5fc5\u8981\u306b\u5fdc\u3058\u3066\u5909\u66f4\u3057\u3066\u304f\u3060\u3055\u3044\u3002\nNginx\u306e\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u79fb\u52d5\u3057\u307e\u3059\u3002\ncd /etc/nginx/\n\u65e2\u5b58\u306e\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3092\u524a\u9664\u3057\u307e\u3059\u3002\nrm -f nginx.conf\n\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3092\u65b0\u898f\u4f5c\u6210\u3057\u307e\u3059\u3002\nvi nginx.conf\n\u4ee5\u4e0b\u306e\u30b3\u30fc\u30c9\u3092\u3059\u3079\u3066\u30b3\u30d4\u30da\u3057\u307e\u3059\u3002\u7de8\u96c6\u65b9\u6cd5\u306f\u3053\u308c\u307e\u3067\u3068\u540c\u3058\u3067\u3059\u3002\n\nnginx.conf\nuser              nginx;\nworker_processes auto;\nerror_log  /var/log/nginx/error.log;\npid        /var/run/nginx.pid;\n\nevents {\n    worker_connections  2048;\n    multi_accept on;\n    use epoll;\n}\n\nhttp {\n    include       /etc/nginx/mime.types;\n    default_type  application/octet-stream;\n\n    #\u30ed\u30b0\n    log_format  main  '$remote_addr - $remote_user [$time_local] \"$request\" '\n                      '$status $body_bytes_sent \"$http_referer\" '\n                      '\"$http_user_agent\" \"$http_x_forwarded_for\"';\n    access_log  /var/log/nginx/access.log  main;\n\n    #\u9ad8\u901f\u5316\n    sendfile          on;\n    tcp_nopush        on;\n    tcp_nodelay       on;\n    keepalive_timeout 5;\n    connection_pool_size 1024;\n    request_pool_size 8k;\n\n    #\u9759\u7684\u30d5\u30a1\u30a4\u30eb\u9ad8\u901f\u5316\n    open_file_cache max=100000 inactive=20s;\n    open_file_cache_valid 30s;\n    open_file_cache_min_uses 2;\n    open_file_cache_errors on;\n\n    #Gzip\n    gzip              on;\n    gzip_http_version 1.0;\n    gzip_comp_level   1;\n    gzip_proxied      any;\n    gzip_vary         on;\n    gzip_buffers      4 8k;\n    gzip_min_length   1000;\n    gzip_types        text/plain\n                      text/xml\n                      text/css\n                      text/javascript\n                      application/xml\n                      application/xhtml+xml\n                      application/rss+xml\n                      application/atom_xml\n                      application/javascript\n                      application/x-javascript\n                      application/x-httpd-php;\n    gzip_disable      \"MSIE [1-6]\\.\";\n    gzip_disable      \"Mozilla/4\";\n\n    #Fastcgi Cache\n    fastcgi_buffer_size     128k;\n    fastcgi_buffers         256 16k;\n    fastcgi_cache_path      /var/cache/nginx/fcgi_cache levels=1:2 keys_zone=fczone:32m max_size=512m inactive=1d;\n    fastcgi_temp_path       /var/cache/nginx/fcgi_temp 1 2; \n    fastcgi_connect_timeout 360;\n    fastcgi_ignore_client_abort on;\n    fastcgi_read_timeout    600;\n    fastcgi_send_timeout    600;\n    fastcgi_cache_valid     200 1d;\n    fastcgi_cache_valid     302 2h;\n    fastcgi_cache_valid     301 4h;\n    fastcgi_cache_valid     any 1m;\n\n    #\u901a\u4fe1\n    client_max_body_size    100m;\n    client_body_buffer_size 256k;\n    server_tokens     off;\n    server_name_in_redirect off;\n\n    include /etc/nginx/conf.d/wp.conf;\n}\n\n\n\u7d30\u304b\u3044\u8a2d\u5b9a\u7528\u306e\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\nmkdir conf.d\n\u4f5c\u6210\u3057\u305f\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u79fb\u52d5\u3057\u307e\u3059\u3002\ncd conf.d\nWordpress\u7528\u306e\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3092\u65b0\u898f\u4f5c\u6210\u3057\u307e\u3059\u3002\nvi wp.conf\n\u4ee5\u4e0b\u306e\u30b3\u30fc\u30c9\u3092\u3059\u3079\u3066\u30b3\u30d4\u30da\u3057\u307e\u3059\u3002\n\nwp.conf\nserver {\n    listen 80;\n    return 301 https://$host$request_uri;\n}\n\nserver {\n    listen 443 ssl http2;\n    server_name example.com;\n    root        /var/www/wordpress;\n    index       index.php;\n    charset     utf-8;\n    access_log  /var/log/nginx/example.com.access.log  main;\n    error_log   /var/log/nginx/example.com.error.log;\n\n    #SSL\n    ssl_certificate /etc/letsencrypt/live/example.com/fullchain.pem;\n    ssl_certificate_key /etc/letsencrypt/live/example.com/privkey.pem;\n    ssl_session_timeout 1d;\n    ssl_session_cache shared:SSL:50m;\n    ssl_session_tickets off;\n    ssl_dhparam /etc/nginx/dhparam.pem;\n    ssl_protocols TLSv1 TLSv1.1 TLSv1.2;\n    ssl_ciphers 'ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-AES256-GCM-SHA384:DHE-RSA-AES128-GCM-SHA256:DHE-DSS-AES128-GCM-SHA256:kEDH+AESGCM:ECDHE-RSA-AES128-SHA256:ECDHE-ECDSA-AES128-SHA256:ECDHE-RSA-AES128-SHA:ECDHE-ECDSA-AES128-SHA:ECDHE-RSA-AES256-SHA384:ECDHE-ECDSA-AES256-SHA384:ECDHE-RSA-AES256-SHA:ECDHE-ECDSA-AES256-SHA:DHE-RSA-AES128-SHA256:DHE-RSA-AES128-SHA:DHE-DSS-AES128-SHA256:DHE-RSA-AES256-SHA256:DHE-DSS-AES256-SHA:DHE-RSA-AES256-SHA:ECDHE-RSA-DES-CBC3-SHA:ECDHE-ECDSA-DES-CBC3-SHA:AES128-GCM-SHA256:AES256-GCM-SHA384:AES128-SHA256:AES256-SHA256:AES128-SHA:AES256-SHA:AES:CAMELLIA:DES-CBC3-SHA:!aNULL:!eNULL:!EXPORT:!DES:!RC4:!MD5:!PSK:!aECDH:!EDH-DSS-DES-CBC3-SHA:!EDH-RSA-DES-CBC3-SHA:!KRB5-DES-CBC3-SHA';\n    ssl_prefer_server_ciphers on;\n    add_header Strict-Transport-Security max-age=15768000;\n    ssl_stapling on;\n    ssl_stapling_verify on;\n\n    #\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\n    add_header X-XSS-Protection \"1; mode=block\";\n    add_header X-Frame-Options SAMEORIGIN;\n    add_header X-Content-Type-Options nosniff;\n\n    #PageSpeed Module\n    pagespeed on;\n    pagespeed RewriteLevel CoreFilters;\n    pagespeed FileCachePath /var/cache/nginx/ngx_pagespeed_cache;\n    pagespeed XHeaderValue \"Powered By ngx_pagespeed\";\n\n        # \u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u306f\u30ad\u30e3\u30c3\u30b7\u30e5\u3059\u308b\u3088\u3046\u306b\u5909\u6570\u306b0\u3092\u30bb\u30c3\u30c8\n        set $do_not_cache 0;\n\n        # POST\u30a2\u30af\u30bb\u30b9\u306e\u5834\u5408\u3001\u30ad\u30e3\u30c3\u30b7\u30e5\u3057\u306a\u3044\u3088\u3046\u306b\u5909\u6570\u306b1\u3092\u30bb\u30c3\u30c8\n        if ($request_method !~ ^(GET)$) {\n            set $do_not_cache 1;\n        }\n\n        # \u7ba1\u7406\u753b\u9762\u306a\u3069\u306e\u5834\u5408\u3001\u30ad\u30e3\u30c3\u30b7\u30e5\u3057\u306a\u3044\u3088\u3046\u306b\u5909\u6570\u306b1\u3092\u30bb\u30c3\u30c8\n        if ($request_uri ~* \"/wp-admin/|/xmlrpc.php|wp-.*.php|/feed/|index.php|sitemap(_index)?.xml\") {\n            set $do_not_cache 1;\n        }\n\n        #  WordPress\u306b\u30ed\u30b0\u30a4\u30f3\u6e08\u307f\u306e\u5834\u5408\u3001\u30ad\u30e3\u30c3\u30b7\u30e5\u3057\u306a\u3044\u3088\u3046\u306b\u5909\u6570\u306b1\u3092\u30bb\u30c3\u30c8\n        if ($http_cookie ~ ^.*(comment_author_|wordpress_logged_in|wp-postpass_).*$) {\n            set $do_not_cache 1;\n        }\n\n        # \u30e2\u30d0\u30a4\u30eb\u306f\u5225\u30ad\u30e3\u30c3\u30b7\u30e5\u306e\u305f\u3081mobile\u3092\u30bb\u30c3\u30c8\n        set $mobilef '';\n        if ($http_user_agent ~* '(Mobile|Android|Kindle|BlackBerry|Opera Mini|Opera Mobi)') {\n            set $mobilef 'mobile.';\n        }\n    include     /etc/nginx/conf.d/drop.conf;\n\n    location  / {\n        try_files $uri $uri/ /index.php?$args;\n        include     /etc/nginx/conf.d/expires.conf;\n        expires 30d;\n    }\n\n    fastcgi_cache        fczone;\n    fastcgi_cache_key    \"$mobilef$scheme://$host$request_uri\";\n    fastcgi_no_cache     $do_not_cache;\n    fastcgi_cache_bypass $do_not_cache;\n\n    location ~ \\.php$ {\n        if (!-f $request_filename) {\n            return 404;\n            break;\n        }\n\n        fastcgi_pass unix:/var/run/php-fpm/php-fpm.sock;\n        fastcgi_index  index.php;\n        fastcgi_param  SCRIPT_FILENAME  $document_root/$fastcgi_script_name;\n        include    fastcgi_params;\n    }\n\n    location ~ /wp-admin/$ {\n        rewrite ^/wp-admin/$ /wp-admin/index.php last;\n    }\n}\n\n\n\u30c9\u30e1\u30a4\u30f3\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\u30c9\u30e1\u30a4\u30f3\u306e\u90e8\u5206\u306f\u304a\u6301\u3061\u306e\u72ec\u81ea\u30c9\u30e1\u30a4\u30f3\u306b\u5909\u66f4\u3057\u3066\u304f\u3060\u3055\u3044\u3002\nsed -i 's/example.com/\u30c9\u30e1\u30a4\u30f3/g' wp.conf\n\u9759\u7684\u30d5\u30a1\u30a4\u30eb\u306e\u6709\u52b9\u671f\u9650\u7528\u306e\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3092\u65b0\u898f\u4f5c\u6210\u3057\u307e\u3059\u3002\nvi expires.conf\n\u4ee5\u4e0b\u306e\u30b3\u30fc\u30c9\u3092\u3059\u3079\u3066\u30b3\u30d4\u30da\u3057\u307e\u3059\u3002\n\nexpires.conf\n# jpg\u3001jpeg\u3001gif\u3001png\u3001ico\u30d5\u30a1\u30a4\u30eb\u306e\u5834\u5408\u306eexpire\u8a2d\u5b9a\nif ( $request_filename ~ .*\\.(jpe?g|gif|png|ico)$ ) {\n    access_log  off;\n    expires 30d;\n}\n\n# txt\u3001css\u3001js\u30d5\u30a1\u30a4\u30eb\u306e\u5834\u5408\u306eexpire\u8a2d\u5b9a\nif ( $request_filename ~ .*\\.(txt|css|js)$ ) {\n    access_log  off;\n    expires 7d;\n}\n\n\n\u30a2\u30af\u30bb\u30b9\u30ed\u30b0\u7c21\u7565\u5316\u7528\u306e\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3092\u65b0\u898f\u4f5c\u6210\u3057\u307e\u3059\u3002\nvi drop.conf\n\u4ee5\u4e0b\u306e\u30b3\u30fc\u30c9\u3092\u3059\u3079\u3066\u30b3\u30d4\u30da\u3057\u307e\u3059\u3002\n\ndrop.conf\n# favicon.ico\u3078\u306e\u30a2\u30af\u30bb\u30b9\u306e\u5834\u5408\u30a2\u30af\u30bb\u30b9\u30ed\u30b0\u3001Not found\u30ed\u30b0\u3092\u7121\u52b9\u306b\u3059\u308b\nlocation = /favicon.ico {\n    access_log off;\n    log_not_found off;\n}\n\n# robots.txt\u3078\u306e\u30a2\u30af\u30bb\u30b9\u306e\u5834\u5408\u30a2\u30af\u30bb\u30b9\u30ed\u30b0\u3001Not found\u30ed\u30b0\u3092\u7121\u52b9\u306b\u3059\u308b\nlocation = /robots.txt {\n    access_log off;\n    log_not_found off;\n}\n\n# apple-touch-icon.png\u3078\u306e\u30a2\u30af\u30bb\u30b9\u306e\u5834\u5408\u30a2\u30af\u30bb\u30b9\u30ed\u30b0\u3001Not found\u30ed\u30b0\u3092\u7121\u52b9\u306b\u3059\u308b\nlocation = /apple-touch-icon.png {\n    access_log off;\n    log_not_found off;\n}\n\n# apple-touch-icon-precomposed.png\u3078\u306e\u30a2\u30af\u30bb\u30b9\u306e\u5834\u5408\u30a2\u30af\u30bb\u30b9\u30ed\u30b0\u3001Not found\u30ed\u30b0\u3092\u7121\u52b9\u306b\u3059\u308b\nlocation = /apple-touch-icon-precomposed.png {\n    access_log off;\n    log_not_found off;\n}\n\n#Let's Encrypt\u8a8d\u8a3c\u30d5\u30a1\u30a4\u30eb\u3078\u306e\u30a2\u30af\u30bb\u30b9\u306e\u5834\u5408\u306f\u8a31\u53ef\nlocation ~ /.well-known {\n    allow all;\n}\n\n# .\u304b\u3089\u59cb\u307e\u308b\u30d5\u30a1\u30a4\u30eb\u306e\u5834\u5408\u30a2\u30af\u30bb\u30b9\u3092\u62d2\u5426\u3057\u3001\u30a2\u30af\u30bb\u30b9\u30ed\u30b0\u3001Not found\u30ed\u30b0\u3092\u7121\u52b9\u306b\u3059\u308b\nlocation ~ /\\. {\n    deny all;\n    access_log off;\n    log_not_found off;\n}\n\n# wp-config.php\u304a\u3088\u3073wp-blog-header.php\u3078\u306e\u30a2\u30af\u30bb\u30b9\u306e\u5834\u5408\u30a2\u30af\u30bb\u30b9\u30ed\u30b0\u3001Not found\u30ed\u30b0\u3092\u7121\u52b9\u3001\u307e\u305f404\u30b3\u30fc\u30c9\u3092\u8fd4\u3059\nlocation ~* /wp-(config|blog-header)\\.php$ {\n    access_log off;\n    log_not_found off;\n    return 404;\n}\n\n#readme.txt\u304a\u3088\u3073readme-\u3067\u59cb\u307e\u308btxt/html\u30d5\u30a1\u30a4\u30eb\u3078\u306e\u30a2\u30af\u30bb\u30b9\u306e\u5834\u5408\u30a2\u30af\u30bb\u30b9\u30ed\u30b0\u3001Not found\u30ed\u30b0\u3092\u7121\u52b9\u3001\u307e\u305f404\u30b3\u30fc\u30c9\u3092\u8fd4\u3059\nlocation ~* (readme|readme-[^\\.]+)\\.(txt|html?)$ {\n    access_log off;\n    log_not_found off;\n    return 404;\n}\n\n\n\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u306e\u69cb\u6587\u30c1\u30a7\u30c3\u30af\u3092\u884c\u3044\u307e\u3059\u3002\nservice nginx configtest\n\u5909\u66f4\u5185\u5bb9\u3092\u53cd\u6620\u3057\u307e\u3059\u3002\nservice nginx restart\n\nPHP7\u306e\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\nPHP\u306f\u6700\u65b0\u30d0\u30fc\u30b8\u30e7\u30f3\u306e7.1\u3092\u63a1\u7528\u3057\u307e\u3059\u3002\nPHP7\u3067\u306f\u52d5\u304b\u306a\u3044\u30d7\u30ed\u30b0\u30e9\u30e0\u304c\u3042\u308a\u307e\u3059\u304c\u3001WordPress\u3067\u306f\u63a8\u5968\u74b0\u5883\u306e\u305f\u3081\u554f\u984c\u3042\u308a\u307e\u305b\u3093\u3002\nPHP\u3068\u305d\u306e\u4ed6\u5fc5\u8981\u306a\u30d1\u30c3\u30b1\u30fc\u30b8\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\nyum -y install --enablerepo=epel,remi-php71 php php-mbstring php-pear php-devel php-fpm php-mcrypt php-mysql php-gd\nnginx \u7528\u306b\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3092\u5909\u66f4\u3057\u307e\u3059\u3002\nsed -i 's/apache/nginx/g' /etc/php-fpm.d/www.conf\n\u63a5\u7d9a\u3092UNIX\u30c9\u30e1\u30a4\u30f3\u30bd\u30b1\u30c3\u30c8\u306b\u5909\u66f4\u3057\u307e\u3059\u3002\nsed -i 's/listen = 127.0.0.1:9000/listen = \\/var\\/run\\/php-fpm\\/php-fpm.sock/g' /etc/php-fpm.d/www.conf\n\u30d1\u30fc\u30df\u30c3\u30b7\u30e7\u30f3\u3092\u5909\u66f4\u3057\u307e\u3059\u3002\nsed -i 's/listen.mode = 0660/listen.mode = 0660\\nlisten.owner = nginx\\nlisten.group = nginx/g' /etc/php-fpm.d/www.conf\nPHP\u3092\u8d77\u52d5\u3057\u307e\u3059\u3002\nservice php-fpm start\n\u7dd1\u8272\u3067OK\u3068\u8868\u793a\u3055\u308c\u305f\u3089\u6210\u529f\u3067\u3059\u3002\u81ea\u52d5\u8d77\u52d5\u306b\u8a2d\u5b9a\u3057\u307e\u3059\u3002\nchkconfig php-fpm on\nnginx\u306b\u3082\u53cd\u6620\u3057\u307e\u3059\u3002\nservice nginx restart\n\u30d7\u30ed\u30bb\u30b9\u6570\u306a\u3069\u3092\u30ab\u30b9\u30bf\u30de\u30a4\u30ba\u3059\u308b\u3068\u3088\u308a\u9ad8\u901f\u3068\u306a\u308a\u307e\u3059\u3002\n\u8ca0\u8377\u72b6\u6cc1\u306a\u3069\u306b\u3042\u308f\u305b\u3066\n/etc/php-fpm.d/www.conf\n\u3092\u7de8\u96c6\u3059\u308b\u3068\u826f\u3044\u3067\u3057\u3087\u3046\u3002\nCentOS php-fpm\u306e\u8a2d\u5b9a\u3092\u5909\u66f4\u3057\u3066\u30e1\u30e2\u30ea\u6d88\u8cbb\u3092\u6e1b\u3089\u3057\u305f\u65b9\u6cd5 | CrystalSnowman.com\n\nMySQL\u306e\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\n\u30c7\u30fc\u30bf\u30fc\u30d9\u30fc\u30b9\u30b5\u30fc\u30d0\u3068\u3057\u3066MySQL\u3092\u63a1\u7528\u3057\u307e\u3059\u3002\n\u6700\u8fd1\u306fMariaDB\u3082\u6709\u540d\u3067\u3059\u304c\u3001\u5b9f\u7e3e\u3068WordPress\u63a8\u5968\u74b0\u5883\u3068\u3044\u3046\u7406\u7531\u304b\u3089MySQL\u304c\u30aa\u30b9\u30b9\u30e1\u3067\u3059\u3002\nremi\u30ea\u30dd\u30b8\u30c8\u30ea\u304b\u3089MySQL\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\nyum -y install --enablerepo=remi mysql-server mysql-devel\nMySQL\u3092\u8d77\u52d5\u3057\u307e\u3059\u3002\nservice mysqld start\n\u7dd1\u8272\u3067OK\u3068\u8868\u793a\u3055\u308c\u305f\u3089\u6210\u529f\u3067\u3059\u3002\u81ea\u52d5\u8d77\u52d5\u306b\u8a2d\u5b9a\u3057\u307e\u3059\u3002\nchkconfig mysqld on\n\nMySQL\u306e\u8a2d\u5b9a\n\u521d\u671f\u8a2d\u5b9a\u3068WordPress\u7528\u306e\u30c7\u30fc\u30bf\u30fc\u30d9\u30fc\u30b9\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\n\u521d\u671f\u8a2d\u5b9a\n\u4ee5\u4e0b\u306e\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3057\u3066\u521d\u671f\u8a2d\u5b9a\u3092\u958b\u59cb\u3057\u307e\u3059\u3002\nmysql_secure_installation\nEnter current password for root (enter for none):\u3068\u8868\u793a\u3055\u308c\u305f\u3089\u3001Enter\u30ad\u30fc\u3092\u62bc\u3057\u307e\u3059\u3002\n\u203broot\u30d1\u30b9\u30ef\u30fc\u30c9\u306e\u5165\u529b\u3067\u3059\u304c\u3001\u672a\u8a2d\u5b9a\u306e\u305f\u3081\u4f55\u3082\u5165\u529b\u3057\u307e\u305b\u3093\u3002\nSet root password? [Y/n]\u3068\u8868\u793a\u3055\u308c\u305f\u3089\u3001Y\u3092\u5165\u529b\u3057\u307e\u3059\u3002\u30d1\u30b9\u30ef\u30fc\u30c9\u8a2d\u5b9a\u306e\u662f\u975e\u3067\u3059\u3002\nNew password:\u3068\u8868\u793a\u3055\u308c\u305f\u3089\u3001root\u306b\u8a2d\u5b9a\u3059\u308b\u30d1\u30b9\u30ef\u30fc\u30c9\u3092\u5165\u529b\u3057\u307e\u3059\u3002\n\u203bMySQL\u30b5\u30fc\u30d0\u306eroot\u30e6\u30fc\u30b6\u306e\u30d1\u30b9\u30ef\u30fc\u30c9\u3067\u3059\u3002\uff08\u2260\u30b5\u30fc\u30d0\u306eroot\uff09\nRe-enter new password:\u3068\u8868\u793a\u3055\u308c\u305f\u3089\u3001\u78ba\u8a8d\u306e\u305f\u3081\u540c\u3058\u30d1\u30b9\u30ef\u30fc\u30c9\u3092\u5165\u529b\u3057\u307e\u3059\u3002\nRemove anonymous users? [Y/n]\u3068\u8868\u793a\u3055\u308c\u305f\u3089\u3001Y\u3092\u5165\u529b\u3057\u307e\u3059\u3002\u533f\u540d\u30e6\u30fc\u30b6\u306e\u524a\u9664\u3067\u3059\u3002\nDisallow root login remotely? [Y/n]\u3068\u8868\u793a\u3055\u308c\u305f\u3089\u3001Y\u3092\u5165\u529b\u3057\u307e\u3059\u3002\u30ea\u30e2\u30fc\u30c8\u30ed\u30b0\u30a4\u30f3\u306e\u53ef\u5426\u3067\u3059\u3002\nRemove test database and access to it? [Y/n]\u3068\u8868\u793a\u3055\u308c\u305f\u3089\u3001Y\u3092\u5165\u529b\u3057\u307e\u3059\u3002\u30c6\u30b9\u30c8\u30c7\u30fc\u30bf\u30fc\u30d9\u30fc\u30b9\u306e\u524a\u9664\u3067\u3059\u3002\nReload privilege tables now? [Y/n]\u3068\u8868\u793a\u3055\u308c\u305f\u3089\u3001Y\u3092\u5165\u529b\u3057\u307e\u3059\u3002\u8a2d\u5b9a\u306e\u53cd\u6620\u3067\u3059\u3002\n\u65e2\u5b58\u306e\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3092\u524a\u9664\u3057\u307e\u3059\u3002\nmv /etc/my.cnf /etc/my.cnf.backup\n\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3092\u65b0\u898f\u4f5c\u6210\u3057\u307e\u3059\u3002\nvi /etc/my.cnf\n\u4ee5\u4e0b\u306e\u30b3\u30fc\u30c9\u3092\u3059\u3079\u3066\u30b3\u30d4\u30da\u3057\u307e\u3059\u3002\u7de8\u96c6\u65b9\u6cd5\u306f\u3053\u308c\u307e\u3067\u3068\u540c\u3058\u3067\u3059\u3002\n\nmy.cnf\n[mysqld]\ndatadir=/var/lib/mysql\nsocket=/var/lib/mysql/mysql.sock\n\ncharacter-set-server=utf8\n\n# Disabling symbolic-links is recommended to prevent assorted security risks\nsymbolic-links=0\n\n# Settings user and group are ignored when systemd is used (fedora >= 15).\n# If you need to run mysqld under a different user or group,\n# customize your systemd unit file for mysqld according to the\n# instructions in http://fedoraproject.org/wiki/Systemd\nuser=mysql\n\n# Semisynchronous Replication\n# http://dev.mysql.com/doc/refman/5.5/en/replication-semisync.html\n# uncomment next line on MASTER\n;plugin-load=rpl_semi_sync_master=semisync_master.so\n# uncomment next line on SLAVE\n;plugin-load=rpl_semi_sync_slave=semisync_slave.so\n\n# Others options for Semisynchronous Replication\n;rpl_semi_sync_master_enabled=1\n;rpl_semi_sync_master_timeout=10\n;rpl_semi_sync_slave_enabled=1\n\n# http://dev.mysql.com/doc/refman/5.5/en/performance-schema.html\n;performance_schema\n\n[client]\ndefault-character-set=utf8\n\n[mysqldump]\ndefault-character-set=utf8\n\n[mysql]\ndefault-character-set=utf8\n\n[mysqld_safe]\nlog-error=/var/log/mysqld.log\npid-file=/var/run/mysqld/mysqld.pid\n\n\n#\n# include all files from the config directory\n#\n!includedir /etc/my.cnf.d\n\n\n\u5909\u66f4\u5185\u5bb9\u3092\u53cd\u6620\u3057\u307e\u3059\u3002\nservice mysqld restart\n\n\u30c7\u30fc\u30bf\u30fc\u30d9\u30fc\u30b9\u306e\u4f5c\u6210\n\u6b21\u306bWordPress\u7528\u306e\u30c7\u30fc\u30bf\u30fc\u30d9\u30fc\u30b9\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\nmysql -u root -p\n\u5148\u7a0b\u8a2d\u5b9a\u3057\u305f\u30d1\u30b9\u30ef\u30fc\u30c9\u3092\u5165\u529b\u3057\u307e\u3059\u3002\nEnter password:\u3000\u3000\u3000\u2190\u30d1\u30b9\u30ef\u30fc\u30c9\u3092\u5165\u529b\uff08\u8868\u793a\u3055\u308c\u307e\u305b\u3093\uff09\n\u5de6\u5074\u306bmysql>\u3068\u8868\u793a\u3055\u308c\u305f\u3089\u3001\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002'wp_db'\u306e\u90e8\u5206\u306f\u597d\u304d\u306a\u30c7\u30fc\u30bf\u30fc\u30d9\u30fc\u30b9\u540d\u306b\u5909\u66f4\u3057\u3066\u304f\u3060\u3055\u3044\u3002\ncreate database wp_db;\nWordPress\u7528\u306e\u30c7\u30fc\u30bf\u30fc\u30d9\u30fc\u30b9\u30e6\u30fc\u30b6\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n'wp_user'\u306f\u597d\u304d\u306a\u30e6\u30fc\u30b6\u540d\u3001\"\u30e6\u30fc\u30b6\u306b\u8a2d\u5b9a\u3059\u308b\u30d1\u30b9\u30ef\u30fc\u30c9\"\u306f\u5f37\u5ea6\u306e\u9ad8\u3044\u30d1\u30b9\u30ef\u30fc\u30c9\u306b\u5909\u66f4\u3057\u3066\u304f\u3060\u3055\u3044\u3002\nGRANT ALL PRIVILEGES ON wp_db.* TO wp_user@localhost IDENTIFIED BY '\u30e6\u30fc\u30b6\u306b\u8a2d\u5b9a\u3059\u308b\u30d1\u30b9\u30ef\u30fc\u30c9';\n\u5909\u66f4\u5185\u5bb9\u3092\u53cd\u6620\u3057\u307e\u3059\u3002\nFLUSH PRIVILEGES;\n\u4ee5\u4e0b\u306e\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3057\u3066\u3001MySQL\u304b\u3089\u30ed\u30b0\u30a2\u30a6\u30c8\u3057\u307e\u3059\u3002\nexit\n\nWordPress\u306e\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\nWordPress\u306e\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u304b\u3089\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u307e\u3067\u3092\u884c\u3044\u307e\u3059\u3002\n\u30db\u30fc\u30e0\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u79fb\u52d5\u3057\u307e\u3059\u3002\ncd\n\u6700\u65b0\u7248\u306eWordPress\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3057\u307e\u3059\u3002\nwget https://ja.wordpress.org/latest-ja.tar.gz\n\u5727\u7e2e\u30d5\u30a1\u30a4\u30eb\u306e\u305f\u3081\u89e3\u51cd\u3057\u307e\u3059\u3002\ntar -xvzf latest-ja.tar.gz\n\u89e3\u51cd\u3057\u305f\u30d5\u30a1\u30a4\u30eb\u3092\u516c\u958b\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u79fb\u52d5\u3057\u307e\u3059\u3002\ncp -r wordpress /var/www/\n\u30d1\u30fc\u30df\u30c3\u30b7\u30e7\u30f3\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\nchown -R nginx:nginx /var/www/wordpress\n\u30d6\u30e9\u30a6\u30b6\u3092\u958b\u304d\u3001\u4ee5\u4e0b\u306eURL\u306b\u30a2\u30af\u30bb\u30b9\u3057\u307e\u3059\u3002\nhttps://\u30c9\u30e1\u30a4\u30f3\u540d/\n\u3053\u3053\u304b\u3089\u306f\u6307\u793a\u306b\u5f93\u3063\u3066\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3092\u9032\u3081\u3066\u3044\u304f\u3060\u3051\u3067\u3059\u3002\n\u7528\u610f\u3059\u3079\u304d\u3082\u306e\u304c\u8868\u793a\u3055\u308c\u307e\u3059\u3002\u7528\u610f\u6e08\u307f\u306e\u305f\u3081\u300c\u3055\u3042\u3001\u59cb\u3081\u307e\u3057\u3087\u3046\uff01\u300d\u3092\u30af\u30ea\u30c3\u30af\u3057\u307e\u3059\u3002\n\nMySQL\u3067\u8a2d\u5b9a\u3057\u305f\u30c7\u30fc\u30bf\u30fc\u30d9\u30fc\u30b9\u60c5\u5831\u3092\u57cb\u3081\u3066\u3044\u304d\u307e\u3059\u3002\n\n\n\u30c7\u30fc\u30bf\u30fc\u30d9\u30fc\u30b9\u540d\uff1awp_db\n\u30e6\u30fc\u30b6\u540d\uff1awp_user\n\u30d1\u30b9\u30ef\u30fc\u30c9\uff1awp_user\u306b\u8a2d\u5b9a\u3057\u305f\u30d1\u30b9\u30ef\u30fc\u30c9\n\u30c7\u30fc\u30bf\u30fc\u30d9\u30fc\u30b9\u306e\u30db\u30b9\u30c8\u540d\uff1alocalhost\uff08\u5909\u66f4\u4e0d\u8981\uff09\n\u30c6\u30fc\u30d6\u30eb\u63a5\u7d9a\u8f9e\uff1awp_\uff08\u5909\u66f4\u4e0d\u8981\uff09\n\n\u5168\u3066\u57cb\u3081\u7d42\u308f\u3063\u305f\u3089\u300c\u9001\u4fe1\u300d\u3092\u30af\u30ea\u30c3\u30af\u3057\u307e\u3059\u3002\n\u554f\u984c\u304c\u306a\u3051\u308c\u3070\u4ee5\u4e0b\u306e\u753b\u9762\u304c\u8868\u793a\u3055\u308c\u307e\u3059\u3002\n\u9055\u3046\u753b\u9762\u304c\u8868\u793a\u3055\u308c\u308b\u5834\u5408\u306f\u3001\u30e6\u30fc\u30b6\u540d\u3084\u30d1\u30b9\u30ef\u30fc\u30c9\u3092\u78ba\u8a8d\u3057\u3066\u307f\u3066\u304f\u3060\u3055\u3044\u3002\n\u300c\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u5b9f\u884c\u300d\u3092\u30af\u30ea\u30c3\u30af\u3057\u307e\u3059\u3002\n\n\u3053\u306e\u753b\u9762\u3067\u306f\u30b5\u30a4\u30c8\u540d\u3084WordPress\u306e\u7ba1\u7406\u30a2\u30ab\u30a6\u30f3\u30c8\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n\u30d1\u30b9\u30ef\u30fc\u30c9\u306b\u3064\u3044\u3066\u306f\u3001\u81ea\u52d5\u7684\u306b\u751f\u6210\u3055\u308c\u308b\u305f\u3081\u305d\u308c\u3092\u5229\u7528\u3057\u3066\u3082\u826f\u3044\u3067\u3057\u3087\u3046\u3002\n\u3082\u3061\u308d\u3093\u30d1\u30b9\u30ef\u30fc\u30c9\u306f\u63a7\u3048\u3066\u304a\u3044\u3066\u304f\u3060\u3055\u3044\u3002\n\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u306f\u5229\u7528\u53ef\u80fd\u306a\u30a2\u30c9\u30ec\u30b9\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\u5168\u3066\u57cb\u3081\u7d42\u308f\u3063\u305f\u3089\u300cWordPress\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u300d\u3092\u30af\u30ea\u30c3\u30af\u3057\u307e\u3059\u3002\n\n\u4ee5\u4e0a\u3067\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u306f\u5b8c\u4e86\u3067\u3059\u3002\u304a\u75b2\u308c\u69d8\u3067\u3057\u305f\u3002\n\u30d7\u30e9\u30b0\u30a4\u30f3\u306a\u3069\u306f\u304a\u597d\u307f\u3067\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u3066\u69cb\u3044\u307e\u305b\u3093\u304c\u3001Nginx Cache Controller\u306f\u5fc5\u305a\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u3066\u304a\u3044\u3066\u304f\u3060\u3055\u3044\u3002Fastcgi Cache\u306e\u524a\u9664\u30d7\u30e9\u30b0\u30a4\u30f3\u3067\u3059\u3002\n\u8a2d\u5b9a\u5024\u306f\u4ee5\u4e0b\u306e\u901a\u308a\u3067\u3001/etc/nginx/nginx.conf\u306e\u5024\u3068\u540c\u3058\u3067\u3059\u3002\n\n\u30ad\u30e3\u30c3\u30b7\u30e5\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3000\uff1a\u3000/var/cache/nginx/fcgi_cache\n\u30ad\u30e3\u30c3\u30b7\u30e5\u30ec\u30d9\u30eb\u3000\uff1a\u30001:2\n\n\n##\u6ce8\u610f\n\u3053\u306e\u6295\u7a3f\u306f[CentOS 6\u306bLEMP\u74b0\u5883\u3092\u69cb\u7bc9\u3059\u308b\uff08OS\u8a2d\u5b9a\u7de8\uff09](http://qiita.com/hattori-network/items/14d84225ed805ef975b0)\u306e\u7d9a\u7de8\u3067\u3059\u3002\n\u6295\u7a3f\u8005\u306f\u30a4\u30f3\u30d5\u30e9\u69cb\u7bc9\u306b\u8208\u5473\u306e\u3042\u308b\u5b66\u751f\uff08\u7d20\u4eba\uff09\u306e\u305f\u3081\u3001\u81ea\u5df1\u8cac\u4efb\u3067\u304a\u306d\u304c\u3044\u3057\u307e\u3059\u3002\n\n###LEMP\u74b0\u5883\u306e\u69cb\u7bc9\u30ea\u30f3\u30af\n - [CentOS 6\u306bLEMP\u74b0\u5883\u3092\u69cb\u7bc9\u3059\u308b\uff08OS\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u7de8\uff09](http://qiita.com/hattori-network/items/d83cdf71041ae4446d89)\n - [CentOS 6\u306bLEMP\u74b0\u5883\u3092\u69cb\u7bc9\u3059\u308b\uff08OS\u8a2d\u5b9a\u7de8\uff09](http://qiita.com/hattori-network/items/14d84225ed805ef975b0)\n - \u3010\u4eca\u56de\u3011CentOS 6\u306bLEMP\u74b0\u5883\u3092\u69cb\u7bc9\u3059\u308b\uff08\u30bd\u30d5\u30c8\u30a6\u30a7\u30a2\u7de8\uff09\n\n#\u30df\u30c9\u30eb\u30a6\u30a7\u30a2\u306e\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\n\u521d\u671f\u8a2d\u5b9a\u304c\u5b8c\u4e86\u3057\u307e\u3057\u305f\u3089\u3001\u3044\u3088\u3044\u3088\u30df\u30c9\u30eb\u30a6\u30a7\u30a2\u306e\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\u3092\u884c\u3044\u307e\u3059\u3002\n\u5c0e\u5165\u3059\u308b\u30df\u30c9\u30eb\u30a6\u30a7\u30a2\u306f\n\n- Nginx\uff08Mainline version\uff09\n- PHP 7\n- MySQL\n\n\u3067\u3059\u3002\nNginx\u306b\u3064\u3044\u3066\u306f`Let's Encrypt`\u3092\u4f7f\u7528\u3057\u3066HTTP/2\u5bfe\u5fdc\u3001Google\u306e`PageSpeed Module`\u3068`Cache Purge`\u30e2\u30b8\u30e5\u30fc\u30eb\u3092\u5c0e\u5165\u3057\u307e\u3059\u3002\n\u6700\u7d42\u7684\u306bWordPress\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u307e\u3067\u884c\u3044\u307e\u3059\u3002\n\n##Nginx\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\nWeb\u30b5\u30fc\u30d0\u3068\u3057\u3066 Apache \u3067\u306f\u306a\u304f\u3001Nginx \u3092\u63a1\u7528\u3057\u307e\u3059\u3002\nNginx \u306f\u5c11\u306a\u3044\u30ea\u30bd\u30fc\u30b9\u3067\u52d5\u4f5c\u3059\u308b\u305f\u3081\u3001\u4eca\u56de\u306e\u3088\u3046\u306a\u30ea\u30bd\u30fc\u30b9\u306b\u4f59\u88d5\u304c\u306a\u3044\u5834\u5408\u306b\u6700\u9069\u3067\u3059\u3002\n\n\u30e2\u30b8\u30e5\u30fc\u30eb\u3092\u8ffd\u52a0\u3059\u308b\u305f\u3081\u3001\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u304b\u3089\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\n\u306a\u304a\u3001\u30b3\u30de\u30f3\u30c9\u304c\u591a\u3044\u305f\u3081\u8aac\u660e\u306f\u5c11\u306a\u3081\u3068\u306a\u3063\u3066\u3044\u307e\u3059\u3002\n\n###\u524d\u6e96\u5099\nNginx\u7528\u306e\u30e6\u30fc\u30b6\u30fc\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n`useradd -s /sbin/nologin nginx`\n\nCentOS\u306eGCC/G++\u306f\u53e4\u3044\u305f\u3081\u3001Devtoolset-2\u30ea\u30dd\u30b8\u30c8\u30ea\u3092\u5c0e\u5165\u3057\u307e\u3059\u3002\uff08PageSpeed Module \u306e\u30a8\u30e9\u30fc\u5bfe\u7b56\uff09\n\u53c2\u8003\uff1a[CentOS\u306b\u65b0\u3057\u3044\u30d0\u30fc\u30b8\u30e7\u30f3\u306eGCC/G++(4.8/4.9)\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b - TASK NOTES](http://www.task-notes.com/entry/20151114/1447492231)\n\n\u4ee5\u4e0b\u306e\u30b3\u30de\u30f3\u30c9\u3092\u9806\u756a\u306b\u5b9f\u884c\u3057\u307e\u3059\u3002\n\n```\ncd /etc/yum.repos.d/\nwget http://people.centos.org/tru/devtools-2/devtools-2.repo\nyum -y install devtoolset-2-gcc devtoolset-2-binutils devtoolset-2-gcc-c++ devtoolset-2-gcc-gfortran\nscl enable devtoolset-2 bash\ncd\n```\n\n\u5fc5\u8981\u306a\u30d1\u30c3\u30b1\u30fc\u30b8\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\n`yum -y install pcre-devel openssl openssl-devel`\n\n###\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u306e\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\nNginx\u3001Cache Purge\u30e2\u30b8\u30e5\u30fc\u30eb\u3001PageSpeed Module\u30e2\u30b8\u30e5\u30fc\u30eb\u306e\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3057\u307e\u3059\u3002\n\n\u307e\u305a\u3001Nginx\u306e\u6700\u65b0\u30d0\u30fc\u30b8\u30e7\u30f3\u3092[nginx: download](http://nginx.org/en/download.html)\u304b\u3089\u78ba\u8a8d\u3057\u307e\u3059\u3002\n\nMainline\u7248\u3068Stable\u7248\u304c\u3042\u308a\u307e\u3059\u304c\u3001\u4eca\u56de\u306fMainline\u7248\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3057\u307e\u3059\u3002\n[\u5099\u5fd8\u9332: Nginx\u306estable\u7248\u3068mainline\u7248\u306b\u95a2\u3057\u3066](https://gyagya1111.blogspot.jp/2016/06/nginxstablemainline.html)\n\n\u30d0\u30fc\u30b8\u30e7\u30f3\u306e\u78ba\u8a8d\u304c\u6e08\u3093\u3060\u3089\u3001\u4ee5\u4e0b\u306e\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3057\u307e\u3059\u3002\n`1.11.10`\u306e\u90e8\u5206\u306f\u30d0\u30fc\u30b8\u30e7\u30f3\u305f\u3081\u3001\u78ba\u8a8d\u3057\u305f\u30d0\u30fc\u30b8\u30e7\u30f3\u306b\u5909\u66f4\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n```\nNGINX_VERSION=1.11.10\nwget http://nginx.org/download/nginx-${NGINX_VERSION}.tar.gz\ntar -xvzf nginx-${NGINX_VERSION}.tar.gz\n```\n\n\u6b21\u306b\u3001Cache Purge\u30e2\u30b8\u30e5\u30fc\u30eb\u306e\u6700\u65b0\u30d0\u30fc\u30b8\u30e7\u30f3\u3092[FRiCKLE Labs / nginx / ngx_cache_purge](http://labs.frickle.com/nginx_ngx_cache_purge/)\u304b\u3089\u78ba\u8a8d\u3057\u307e\u3059\u3002\n\n\u30d0\u30fc\u30b8\u30e7\u30f3\u306e\u78ba\u8a8d\u304c\u6e08\u3093\u3060\u3089\u3001\u4ee5\u4e0b\u306e\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3057\u307e\u3059\u3002\n`2.3`\u306e\u90e8\u5206\u306f\u30d0\u30fc\u30b8\u30e7\u30f3\u305f\u3081\u3001\u78ba\u8a8d\u3057\u305f\u30d0\u30fc\u30b8\u30e7\u30f3\u306b\u5909\u66f4\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n```\nNCP_VERSION=2.3\nwget http://labs.frickle.com/files/ngx_cache_purge-${NCP_VERSION}.tar.gz\ntar -xvzf ngx_cache_purge-${NCP_VERSION}.tar.gz\n\n```\n\n\u6700\u5f8c\u306b\u3001PageSpeed Module\u30e2\u30b8\u30e5\u30fc\u30eb\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3057\u307e\u3059\u3002\u4ed6\u306b\u6bd4\u3079\u5c11\u3057\u9577\u304f\u306a\u3063\u3066\u3044\u307e\u3059\u3002\n\u53c2\u8003\uff1a[Build ngx_pagespeed From Source](https://modpagespeed.com/doc/build_ngx_pagespeed_from_source)\n\n[PageSpeed Release Notes](https://modpagespeed.com/doc/release_notes)\u304b\u3089\u6700\u65b0\u30d0\u30fc\u30b8\u30e7\u30f3\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\n\n\u4ee5\u4e0b\u306e\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3057\u307e\u3059\u3002\n`1.12.34.2`\u306e\u90e8\u5206\u306f\u30d0\u30fc\u30b8\u30e7\u30f3\u305f\u3081\u3001\u78ba\u8a8d\u3057\u305f\u30d0\u30fc\u30b8\u30e7\u30f3\u306b\u5909\u66f4\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n```\nNPS_VERSION=1.12.34.2\nwget https://github.com/pagespeed/ngx_pagespeed/archive/v${NPS_VERSION}-beta.zip\nunzip v${NPS_VERSION}-beta.zip\ncd ngx_pagespeed-${NPS_VERSION}-beta/\npsol_url=https://dl.google.com/dl/page-speed/psol/${NPS_VERSION}.tar.gz\n[ -e scripts/format_binary_url.sh ] && psol_url=$(scripts/format_binary_url.sh PSOL_BINARY_URL)\nwget ${psol_url}\ntar -xzvf $(basename ${psol_url})\n```\n\n###\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u306e\u6e96\u5099\u304c\u6574\u3063\u305f\u3089\u3001\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3092\u884c\u3044\u307e\u3059\u3002\n\u30d1\u30e9\u30e1\u30fc\u30bf\u30fc\u306f\u5fc5\u8981\u306b\u5fdc\u3058\u3066\u5909\u66f4\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n```\ncd ~/nginx-${NGINX_VERSION}/\n./configure --prefix=/etc/nginx --conf-path=/etc/nginx/nginx.conf --sbin-path=/usr/sbin/nginx --error-log-path=/var/log/nginx/error.log --http-fastcgi-temp-path=/var/lib/nginx/fastcgi --http-log-path=/var/log/nginx/access.log --http-scgi-temp-path=/var/lib/nginx/scgi --http-uwsgi-temp-path=/var/lib/nginx/uwsgi --lock-path=/var/lock/subsys/nginx.lock --pid-path=/var/run/nginx.pid --with-http_gzip_static_module --with-http_ssl_module --with-http_v2_module --add-module=$HOME/ngx_pagespeed-${NPS_VERSION}-beta --add-module=$HOME/ngx_cache_purge-${NCP_VERSION} ${PS_NGX_EXTRA_FLAGS}\n```\n\n\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb!!\n\n```\nmake\nmake install\n```\n\n###\u521d\u671f\u8a2d\u5b9a\n\n\u8d77\u52d5\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n`vi /etc/init.d/nginx`\n\n\u300ci\u30ad\u30fc\u300d\u3092\u30af\u30ea\u30c3\u30af\u3057\u3066\u7de8\u96c6\u30e2\u30fc\u30c9\u306b\u79fb\u884c\u3057\u3001\u4ee5\u4e0b\u306e\u30b3\u30fc\u30c9\u3092\u3059\u3079\u3066\u30b3\u30d4\u30da\u3057\u307e\u3059\u3002\n\n```:nginx\n#!/bin/sh\n#\n# nginx - this script starts and stops the nginx daemon\n#\n# chkconfig:   - 85 15\n# description:  NGINX is an HTTP(S) server, HTTP(S) reverse \\\n#               proxy and IMAP/POP3 proxy server\n# processname: nginx\n# config:      /etc/nginx/nginx.conf\n# config:      /etc/sysconfig/nginx\n# pidfile:     /var/run/nginx.pid\n\n# Source function library.\n. /etc/rc.d/init.d/functions\n\n# Source networking configuration.\n. /etc/sysconfig/network\n\n# Check that networking is up.\n[ \"$NETWORKING\" = \"no\" ] && exit 0\n\nnginx=\"/usr/sbin/nginx\"\nprog=$(basename $nginx)\n\nNGINX_CONF_FILE=\"/etc/nginx/nginx.conf\"\n\n[ -f /etc/sysconfig/nginx ] && . /etc/sysconfig/nginx\n\nlockfile=/var/lock/subsys/nginx\n\nmake_dirs() {\n   # make required directories\n   user=`$nginx -V 2>&1 | grep \"configure arguments:.*--user=\" | sed 's/[^*]*--user=\\([^ ]*\\).*/\\1/g' -`\n   if [ -n \"$user\" ]; then\n      if [ -z \"`grep $user /etc/passwd`\" ]; then\n         useradd -M -s /bin/nologin $user\n      fi\n      options=`$nginx -V 2>&1 | grep 'configure arguments:'`\n      for opt in $options; do\n          if [ `echo $opt | grep '.*-temp-path'` ]; then\n              value=`echo $opt | cut -d \"=\" -f 2`\n              if [ ! -d \"$value\" ]; then\n                  # echo \"creating\" $value\n                  mkdir -p $value && chown -R $user $value\n              fi\n          fi\n       done\n    fi\n}\n\nstart() {\n    [ -x $nginx ] || exit 5\n    [ -f $NGINX_CONF_FILE ] || exit 6\n    make_dirs\n    echo -n $\"Starting $prog: \"\n    daemon $nginx -c $NGINX_CONF_FILE\n    retval=$?\n    echo\n    [ $retval -eq 0 ] && touch $lockfile\n    return $retval\n}\n\nstop() {\n    echo -n $\"Stopping $prog: \"\n    killproc $prog -QUIT\n    retval=$?\n    echo\n    [ $retval -eq 0 ] && rm -f $lockfile\n    return $retval\n}\n\nrestart() {\n    configtest || return $?\n    stop\n    sleep 1\n    start\n}\n\nreload() {\n    configtest || return $?\n    echo -n $\"Reloading $prog: \"\n    killproc $nginx -HUP\n    RETVAL=$?\n    echo\n}\n\nforce_reload() {\n    restart\n}\n\nconfigtest() {\n  $nginx -t -c $NGINX_CONF_FILE\n}\n\nrh_status() {\n    status $prog\n}\n\nrh_status_q() {\n    rh_status >/dev/null 2>&1\n}\n\ncase \"$1\" in\n    start)\n        rh_status_q && exit 0\n        $1\n        ;;\n    stop)\n        rh_status_q || exit 0\n        $1\n        ;;\n    restart|configtest)\n        $1\n        ;;\n    reload)\n        rh_status_q || exit 7\n        $1\n        ;;\n    force-reload)\n        force_reload\n        ;;\n    status)\n        rh_status\n        ;;\n    condrestart|try-restart)\n        rh_status_q || exit 0\n            ;;\n    *)\n        echo $\"Usage: $0 {start|stop|status|restart|condrestart|try-restart|reload|force-reload|configtest}\"\n        exit 2\nesac\n```\n\u51fa\u5178\uff1a[Red Hat NGINX Init Script | NGINX](https://www.nginx.com/resources/wiki/start/topics/examples/redhatnginxinit/)\n\n\u30da\u30fc\u30b9\u30c8\u3055\u308c\u305f\u3089\u300cESC\u30ad\u30fc\u300d\u3092\u30af\u30ea\u30c3\u30af\u3057\u3066\u3001\u300c:wq\u300d\u3068\u5165\u529b\u3057\u3066\u4fdd\u5b58\u3057\u307e\u3059\u3002\n\n\u5b9f\u884c\u6a29\u9650\u3092\u4ed8\u4e0e\u3057\u307e\u3059\u3002\n`chmod +x /etc/init.d/nginx`\n\u3000\n\u516c\u958b\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n`mkdir -p /var/www/wordpress`\n\n\u516c\u958b\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306e\u30d1\u30b9\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n`sed -i 's/root   html/root   \\/var\\/www\\/wordpress/g' /etc/nginx/nginx.conf`\n\nFastCGI\u7528\u306eTEMP\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n`mkdir -p /var/lib/nginx/fastcgi`\n\nNginx\u3092\u8d77\u52d5\u3057\u307e\u3059\u3002\n`service nginx start`\n\n\u7dd1\u8272\u3067`OK`\u3068\u8868\u793a\u3055\u308c\u305f\u3089\u6210\u529f\u3067\u3059\u3002\u81ea\u52d5\u8d77\u52d5\u306b\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n`chkconfig nginx on`\n\n##Let's Encrypt\u306e\u5c0e\u5165\nLet's Encrypt\u306f\u3001\u7121\u6599\u306eSSL/TLS\u8a3c\u660e\u66f8\u767a\u884c\u30b5\u30fc\u30d3\u30b9\u3067\u3059\u3002\n\u72ec\u81ea\u30c9\u30e1\u30a4\u30f3\u3055\u308c\u3042\u308c\u3070\u3001\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u306e\u767b\u9332\u3060\u3051\u3067\u8a3c\u660e\u66f8\u304c\u81ea\u52d5\u767a\u884c\u3055\u308c\u307e\u3059\u3002\n\u8a73\u3057\u304f\u306f[Let's Encrypt \u7dcf\u5408\u30dd\u30fc\u30bf\u30eb](https://letsencrypt.jp/)\n\u3082\u3057\u304f\u306f[Let\u2019s Encrypt\u306eSSL\u8a3c\u660e\u66f8\u3067\u3001\u5b89\u5168\u306a\u30a6\u30a7\u30d6\u30b5\u30a4\u30c8\u3092\u516c\u958b - \u3055\u304f\u3089\u306e\u30ca\u30ec\u30c3\u30b8](http://knowledge.sakura.ad.jp/knowledge/5573/)\n\nLet\u2019s Encrypt client\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\n`git clone https://github.com/letsencrypt/letsencrypt`\n\n\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u305f\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u79fb\u52d5\u3057\u307e\u3059\u3002\n`cd letsencrypt`\n\n\u8a3c\u660e\u66f8\u3092\u767a\u884c\u3057\u307e\u3059\u3002\u30c9\u30e1\u30a4\u30f3\u306e\u90e8\u5206\u306f\u304a\u6301\u3061\u306e\u72ec\u81ea\u30c9\u30e1\u30a4\u30f3\u306b\u5909\u66f4\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n`./letsencrypt-auto certonly --webroot -w /var/www/wordpress -d \u30c9\u30e1\u30a4\u30f3m`\n\n`Enter email address`\u3068\u8868\u793a\u3055\u308c\u305f\u3089\u3001\u304a\u6301\u3061\u306e\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u3092\u5165\u529b\u3057\u307e\u3059\u3002\n\u8a3c\u660e\u66f8\u306e\u671f\u9650\u304c\u8fd1\u3065\u304f\u3068\u767b\u9332\u3057\u305f\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u5b9b\u306b\u901a\u77e5\u304c\u5c4a\u304d\u307e\u3059\u3002\n\n`(A)gree/(C)ancel:`\u3068\u8868\u793a\u3055\u308c\u305f\u3089\u3001`A`\u3092\u5165\u529b\u3057\u307e\u3059\u3002\u5229\u7528\u898f\u7d04\u306e\u540c\u610f\u3067\u3059\u3002\n\n`(Y)es/(N)o:`\u3068\u8868\u793a\u3055\u308c\u305f\u3089\u3001`Y`\u3092\u5165\u529b\u3057\u307e\u3059\u3002\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u306e\u5171\u6709\u3067\u3059\u3002\n\n\u9ec4\u8272\u3067`IMPORTANT NOTES:`\u3068\u8868\u793a\u3055\u308c\u305f\u3089\u3001\u8a3c\u660e\u66f8\u306e\u767a\u884c\u306f\u5b8c\u4e86\u3067\u3059\u3002\n\n\u203b\u9014\u4e2d\u306e\u30a8\u30e9\u30fc\u306f\u300c\u5b89\u5b9a\u52d5\u4f5c\u306e\u305f\u3081\u306b\u306fPython 2.7\u300d\u304c\u5fc5\u8981\u3068\u3044\u3046\u5185\u5bb9\u3067\u3059\u3002\nVersion 0.9.3\u4ee5\u964d\u3067\u3042\u308c\u3070\u3001Let\u2019s Encrypt client\u306f\u6b63\u5e38\u306b\u52d5\u4f5c\u3057\u307e\u3059\u3002\n\u53c2\u8003\uff1a[CentOS 6 \u3067\u767a\u751f\u3059\u308b\u30a8\u30e9\u30fc\u306e\u5bfe\u51e6\u6cd5 - Let's Encrypt \u7dcf\u5408\u30dd\u30fc\u30bf\u30eb](https://letsencrypt.jp/usage/centos6-error.html)\n\n```\nPython 2.6 is no longer supported by the Python core team, please upgrade your Python. A future version of cryptography will drop support for Python 2.6\n```\n\n###\u8a3c\u660e\u66f8\u306e\u767a\u884c\u306e\u81ea\u52d5\u5316\nLet's Encrypt\u3067\u767a\u884c\u3055\u308c\u308b\u8a3c\u660e\u66f8\u306f\u6709\u52b9\u671f\u9593\u304c90\u65e5\u3067\u3059\u3002\n\u5b9a\u671f\u7684\u306b\u66f4\u65b0\u3059\u308b\u306e\u306f\u624b\u9593\u306e\u305f\u3081\u3001cron\u3067\u81ea\u52d5\u5316\u3057\u307e\u3059\u3002\n\ncron\u306e\u8a2d\u5b9a\u3092\u958b\u304d\u307e\u3059\u3002\n`crontab -e`\n\n\u81ea\u52d5\u66f4\u65b0\u30b3\u30de\u30f3\u30c9\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n\u300ci\u30ad\u30fc\u300d\u3092\u30af\u30ea\u30c3\u30af\u3057\u3066\u7de8\u96c6\u30e2\u30fc\u30c9\u306b\u79fb\u884c\u3057\u3001\u4ee5\u4e0b\u306e\u30b3\u30fc\u30c9\u3092\u30b3\u30d4\u30da\u3057\u307e\u3059\u3002\n\n`00 06 10 */2 * /root/letsencrypt/letsencrypt-auto renew`\n\u203b60\u65e5\u3054\u3068\u306e\u66f4\u65b0\u304c\u63a8\u5968\u3055\u308c\u3066\u3044\u308b\u305f\u3081\u3001\u9694\u6708\u306710\u65e5\u306e\u5348\u524d6\u6642\u306b\u8a2d\u5b9a\u3057\u3066\u3044\u307e\u3059\u3002\n\n\u30da\u30fc\u30b9\u30c8\u3055\u308c\u305f\u3089\u300cESC\u30ad\u30fc\u300d\u3092\u30af\u30ea\u30c3\u30af\u3057\u3066\u3001\u300c:wq\u300d\u3068\u5165\u529b\u3057\u3066\u4fdd\u5b58\u3057\u307e\u3059\u3002\n\n###SSL Labs\u3067A+\u8a55\u4fa1\n\u4e01\u5ea6\u826f\u3044\u6a5f\u4f1a\u306e\u305f\u3081\u3001SSL Labs \u3067A+\u8a55\u4fa1\u3068\u306a\u308b\u3088\u3046\u306b\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n\u203bSSL Labs \u306fSSL\u8a2d\u5b9a\u306e\u8a55\u4fa1\u30c4\u30fc\u30eb\u3002A+\u8a55\u4fa1\uff1d\u5b89\u5168\u3067\u306f\u306a\u3044\u306e\u3067\u6ce8\u610f\u3002\n\n2048bit\u306eDH\u9375\u3092\u751f\u6210\u3057\u307e\u3059\u3002\n`openssl dhparam 2048 -out /etc/nginx/dhparam.pem`\n\n##Nginx\u306e\u8a2d\u5b9a\nNginx \u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u304c\u5b8c\u4e86\u3057\u307e\u3057\u305f\u3089\u3001\u516c\u958b\u7528\u306e\u8a2d\u5b9a\u3092\u884c\u3044\u307e\u3059\u3002\n\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3092\u7de8\u96c6\u3057\u3066\u3044\u304d\u307e\u3059\u304c\u3001\u8a2d\u5b9a\u5185\u5bb9\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u306a\u3063\u3066\u3044\u307e\u3059\u3002\n\n- WordPress\u7528\n- SSL\u3001HTTP/2\u7528\n- \u30ad\u30e3\u30c3\u30b7\u30e5\u3068\u3057\u3066Fastcgi Cache\u3092\u4f7f\u7528\n- \u5b9a\u756a\u306e\u9ad8\u901f\u5316\u8a2d\u5b9a\uff08Gzip\u306a\u3069\uff09\n- \u5b9a\u756a\u306e\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u8a2d\u5b9a\uff08X-XSS-Protection\u306a\u3069\uff09\n- \u30a2\u30af\u30bb\u30b9\u30ed\u30b0\u306e\u4e00\u90e8\u7121\u52b9\u5316\uff08favicon.ico\u306a\u3069\uff09\n\nSSL\u306e\u90e8\u5206\u306f[Generate Mozilla Security Recommended Web Server Configuration Files](https://mozilla.github.io/server-side-tls/ssl-config-generator/)\u3092\u53c2\u8003\u306b\u3057\u3066\u3044\u307e\u3059\u3002\n\u30ad\u30e3\u30c3\u30b7\u30e5\u306e\u6709\u52b9\u671f\u9650\u306a\u3069\u306f\u5fc5\u8981\u306b\u5fdc\u3058\u3066\u5909\u66f4\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\nNginx\u306e\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u79fb\u52d5\u3057\u307e\u3059\u3002\n`cd /etc/nginx/`\n\n\u65e2\u5b58\u306e\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3092\u524a\u9664\u3057\u307e\u3059\u3002\n`rm -f nginx.conf`\n\n\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3092\u65b0\u898f\u4f5c\u6210\u3057\u307e\u3059\u3002\n`vi nginx.conf`\n\n\u4ee5\u4e0b\u306e\u30b3\u30fc\u30c9\u3092\u3059\u3079\u3066\u30b3\u30d4\u30da\u3057\u307e\u3059\u3002\u7de8\u96c6\u65b9\u6cd5\u306f\u3053\u308c\u307e\u3067\u3068\u540c\u3058\u3067\u3059\u3002\n\n```:nginx.conf\nuser              nginx;\nworker_processes auto;\nerror_log  /var/log/nginx/error.log;\npid        /var/run/nginx.pid;\n\nevents {\n    worker_connections  2048;\n    multi_accept on;\n    use epoll;\n}\n\nhttp {\n    include       /etc/nginx/mime.types;\n    default_type  application/octet-stream;\n\n    #\u30ed\u30b0\n    log_format  main  '$remote_addr - $remote_user [$time_local] \"$request\" '\n                      '$status $body_bytes_sent \"$http_referer\" '\n                      '\"$http_user_agent\" \"$http_x_forwarded_for\"';\n    access_log  /var/log/nginx/access.log  main;\n\n    #\u9ad8\u901f\u5316\n    sendfile          on;\n    tcp_nopush        on;\n    tcp_nodelay       on;\n    keepalive_timeout 5;\n    connection_pool_size 1024;\n    request_pool_size 8k;\n    \n    #\u9759\u7684\u30d5\u30a1\u30a4\u30eb\u9ad8\u901f\u5316\n    open_file_cache max=100000 inactive=20s;\n    open_file_cache_valid 30s;\n    open_file_cache_min_uses 2;\n    open_file_cache_errors on;\n\n    #Gzip\n    gzip              on;\n    gzip_http_version 1.0;\n    gzip_comp_level   1;\n    gzip_proxied      any;\n    gzip_vary         on;\n    gzip_buffers      4 8k;\n    gzip_min_length   1000;\n    gzip_types        text/plain\n                      text/xml\n                      text/css\n                      text/javascript\n                      application/xml\n                      application/xhtml+xml\n                      application/rss+xml\n                      application/atom_xml\n                      application/javascript\n                      application/x-javascript\n                      application/x-httpd-php;\n    gzip_disable      \"MSIE [1-6]\\.\";\n    gzip_disable      \"Mozilla/4\";\n\n    #Fastcgi Cache\n    fastcgi_buffer_size     128k;\n    fastcgi_buffers         256 16k;\n    fastcgi_cache_path      /var/cache/nginx/fcgi_cache levels=1:2 keys_zone=fczone:32m max_size=512m inactive=1d;\n    fastcgi_temp_path       /var/cache/nginx/fcgi_temp 1 2; \n    fastcgi_connect_timeout 360;\n    fastcgi_ignore_client_abort on;\n    fastcgi_read_timeout    600;\n    fastcgi_send_timeout    600;\n    fastcgi_cache_valid     200 1d;\n    fastcgi_cache_valid     302 2h;\n    fastcgi_cache_valid     301 4h;\n    fastcgi_cache_valid     any 1m;\n\n    #\u901a\u4fe1\n    client_max_body_size    100m;\n    client_body_buffer_size 256k;\n    server_tokens     off;\n    server_name_in_redirect off;\n\n    include /etc/nginx/conf.d/wp.conf;\n}\n```\n\n\u7d30\u304b\u3044\u8a2d\u5b9a\u7528\u306e\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n`mkdir conf.d`\n\n\u4f5c\u6210\u3057\u305f\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u79fb\u52d5\u3057\u307e\u3059\u3002\n`cd conf.d`\n\nWordpress\u7528\u306e\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3092\u65b0\u898f\u4f5c\u6210\u3057\u307e\u3059\u3002\n`vi wp.conf`\n\n\u4ee5\u4e0b\u306e\u30b3\u30fc\u30c9\u3092\u3059\u3079\u3066\u30b3\u30d4\u30da\u3057\u307e\u3059\u3002\n\n```:wp.conf\nserver {\n    listen 80;\n    return 301 https://$host$request_uri;\n}\n\nserver {\n    listen 443 ssl http2;\n    server_name example.com;\n    root        /var/www/wordpress;\n    index       index.php;\n    charset     utf-8;\n    access_log  /var/log/nginx/example.com.access.log  main;\n    error_log   /var/log/nginx/example.com.error.log;\n    \n    #SSL\n    ssl_certificate /etc/letsencrypt/live/example.com/fullchain.pem;\n    ssl_certificate_key /etc/letsencrypt/live/example.com/privkey.pem;\n    ssl_session_timeout 1d;\n    ssl_session_cache shared:SSL:50m;\n    ssl_session_tickets off;\n    ssl_dhparam /etc/nginx/dhparam.pem;\n    ssl_protocols TLSv1 TLSv1.1 TLSv1.2;\n    ssl_ciphers 'ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-AES256-GCM-SHA384:DHE-RSA-AES128-GCM-SHA256:DHE-DSS-AES128-GCM-SHA256:kEDH+AESGCM:ECDHE-RSA-AES128-SHA256:ECDHE-ECDSA-AES128-SHA256:ECDHE-RSA-AES128-SHA:ECDHE-ECDSA-AES128-SHA:ECDHE-RSA-AES256-SHA384:ECDHE-ECDSA-AES256-SHA384:ECDHE-RSA-AES256-SHA:ECDHE-ECDSA-AES256-SHA:DHE-RSA-AES128-SHA256:DHE-RSA-AES128-SHA:DHE-DSS-AES128-SHA256:DHE-RSA-AES256-SHA256:DHE-DSS-AES256-SHA:DHE-RSA-AES256-SHA:ECDHE-RSA-DES-CBC3-SHA:ECDHE-ECDSA-DES-CBC3-SHA:AES128-GCM-SHA256:AES256-GCM-SHA384:AES128-SHA256:AES256-SHA256:AES128-SHA:AES256-SHA:AES:CAMELLIA:DES-CBC3-SHA:!aNULL:!eNULL:!EXPORT:!DES:!RC4:!MD5:!PSK:!aECDH:!EDH-DSS-DES-CBC3-SHA:!EDH-RSA-DES-CBC3-SHA:!KRB5-DES-CBC3-SHA';\n    ssl_prefer_server_ciphers on;\n    add_header Strict-Transport-Security max-age=15768000;\n    ssl_stapling on;\n    ssl_stapling_verify on;\n    \n    #\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\n    add_header X-XSS-Protection \"1; mode=block\";\n    add_header X-Frame-Options SAMEORIGIN;\n    add_header X-Content-Type-Options nosniff;\n\n    #PageSpeed Module\n    pagespeed on;\n    pagespeed RewriteLevel CoreFilters;\n    pagespeed FileCachePath /var/cache/nginx/ngx_pagespeed_cache;\n    pagespeed XHeaderValue \"Powered By ngx_pagespeed\";\n\n        # \u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u306f\u30ad\u30e3\u30c3\u30b7\u30e5\u3059\u308b\u3088\u3046\u306b\u5909\u6570\u306b0\u3092\u30bb\u30c3\u30c8\n        set $do_not_cache 0;\n\n        # POST\u30a2\u30af\u30bb\u30b9\u306e\u5834\u5408\u3001\u30ad\u30e3\u30c3\u30b7\u30e5\u3057\u306a\u3044\u3088\u3046\u306b\u5909\u6570\u306b1\u3092\u30bb\u30c3\u30c8\n        if ($request_method !~ ^(GET)$) {\n            set $do_not_cache 1;\n        }\n        \n        # \u7ba1\u7406\u753b\u9762\u306a\u3069\u306e\u5834\u5408\u3001\u30ad\u30e3\u30c3\u30b7\u30e5\u3057\u306a\u3044\u3088\u3046\u306b\u5909\u6570\u306b1\u3092\u30bb\u30c3\u30c8\n        if ($request_uri ~* \"/wp-admin/|/xmlrpc.php|wp-.*.php|/feed/|index.php|sitemap(_index)?.xml\") {\n            set $do_not_cache 1;\n        }\n\n        #  WordPress\u306b\u30ed\u30b0\u30a4\u30f3\u6e08\u307f\u306e\u5834\u5408\u3001\u30ad\u30e3\u30c3\u30b7\u30e5\u3057\u306a\u3044\u3088\u3046\u306b\u5909\u6570\u306b1\u3092\u30bb\u30c3\u30c8\n        if ($http_cookie ~ ^.*(comment_author_|wordpress_logged_in|wp-postpass_).*$) {\n            set $do_not_cache 1;\n        }\n        \n        # \u30e2\u30d0\u30a4\u30eb\u306f\u5225\u30ad\u30e3\u30c3\u30b7\u30e5\u306e\u305f\u3081mobile\u3092\u30bb\u30c3\u30c8\n        set $mobilef '';\n        if ($http_user_agent ~* '(Mobile|Android|Kindle|BlackBerry|Opera Mini|Opera Mobi)') {\n            set $mobilef 'mobile.';\n        }\n    include     /etc/nginx/conf.d/drop.conf;\n    \n    location  / {\n        try_files $uri $uri/ /index.php?$args;\n        include     /etc/nginx/conf.d/expires.conf;\n        expires 30d;\n    }\n\n    fastcgi_cache        fczone;\n    fastcgi_cache_key    \"$mobilef$scheme://$host$request_uri\";\n    fastcgi_no_cache     $do_not_cache;\n    fastcgi_cache_bypass $do_not_cache;\n\n    location ~ \\.php$ {\n        if (!-f $request_filename) {\n            return 404;\n            break;\n        }\n\n        fastcgi_pass unix:/var/run/php-fpm/php-fpm.sock;\n        fastcgi_index  index.php;\n        fastcgi_param  SCRIPT_FILENAME  $document_root/$fastcgi_script_name;\n        include    fastcgi_params;\n    }\n\n    location ~ /wp-admin/$ {\n        rewrite ^/wp-admin/$ /wp-admin/index.php last;\n    }\n}\n```\n\n\u30c9\u30e1\u30a4\u30f3\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\u30c9\u30e1\u30a4\u30f3\u306e\u90e8\u5206\u306f\u304a\u6301\u3061\u306e\u72ec\u81ea\u30c9\u30e1\u30a4\u30f3\u306b\u5909\u66f4\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n`sed -i 's/example.com/\u30c9\u30e1\u30a4\u30f3/g' wp.conf`\n\n\u9759\u7684\u30d5\u30a1\u30a4\u30eb\u306e\u6709\u52b9\u671f\u9650\u7528\u306e\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3092\u65b0\u898f\u4f5c\u6210\u3057\u307e\u3059\u3002\n`vi expires.conf`\n\n\u4ee5\u4e0b\u306e\u30b3\u30fc\u30c9\u3092\u3059\u3079\u3066\u30b3\u30d4\u30da\u3057\u307e\u3059\u3002\n\n```:expires.conf\n# jpg\u3001jpeg\u3001gif\u3001png\u3001ico\u30d5\u30a1\u30a4\u30eb\u306e\u5834\u5408\u306eexpire\u8a2d\u5b9a\nif ( $request_filename ~ .*\\.(jpe?g|gif|png|ico)$ ) {\n    access_log  off;\n    expires 30d;\n}\n\n# txt\u3001css\u3001js\u30d5\u30a1\u30a4\u30eb\u306e\u5834\u5408\u306eexpire\u8a2d\u5b9a\nif ( $request_filename ~ .*\\.(txt|css|js)$ ) {\n    access_log  off;\n    expires 7d;\n}\n```\n\n\u30a2\u30af\u30bb\u30b9\u30ed\u30b0\u7c21\u7565\u5316\u7528\u306e\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3092\u65b0\u898f\u4f5c\u6210\u3057\u307e\u3059\u3002\n`vi drop.conf`\n\n\u4ee5\u4e0b\u306e\u30b3\u30fc\u30c9\u3092\u3059\u3079\u3066\u30b3\u30d4\u30da\u3057\u307e\u3059\u3002\n\n```:drop.conf\n# favicon.ico\u3078\u306e\u30a2\u30af\u30bb\u30b9\u306e\u5834\u5408\u30a2\u30af\u30bb\u30b9\u30ed\u30b0\u3001Not found\u30ed\u30b0\u3092\u7121\u52b9\u306b\u3059\u308b\nlocation = /favicon.ico {\n    access_log off;\n    log_not_found off;\n}\n\n# robots.txt\u3078\u306e\u30a2\u30af\u30bb\u30b9\u306e\u5834\u5408\u30a2\u30af\u30bb\u30b9\u30ed\u30b0\u3001Not found\u30ed\u30b0\u3092\u7121\u52b9\u306b\u3059\u308b\nlocation = /robots.txt {\n    access_log off;\n    log_not_found off;\n}\n\n# apple-touch-icon.png\u3078\u306e\u30a2\u30af\u30bb\u30b9\u306e\u5834\u5408\u30a2\u30af\u30bb\u30b9\u30ed\u30b0\u3001Not found\u30ed\u30b0\u3092\u7121\u52b9\u306b\u3059\u308b\nlocation = /apple-touch-icon.png {\n    access_log off;\n    log_not_found off;\n}\n\n# apple-touch-icon-precomposed.png\u3078\u306e\u30a2\u30af\u30bb\u30b9\u306e\u5834\u5408\u30a2\u30af\u30bb\u30b9\u30ed\u30b0\u3001Not found\u30ed\u30b0\u3092\u7121\u52b9\u306b\u3059\u308b\nlocation = /apple-touch-icon-precomposed.png {\n    access_log off;\n    log_not_found off;\n}\n\n#Let's Encrypt\u8a8d\u8a3c\u30d5\u30a1\u30a4\u30eb\u3078\u306e\u30a2\u30af\u30bb\u30b9\u306e\u5834\u5408\u306f\u8a31\u53ef\nlocation ~ /.well-known {\n    allow all;\n}\n\n# .\u304b\u3089\u59cb\u307e\u308b\u30d5\u30a1\u30a4\u30eb\u306e\u5834\u5408\u30a2\u30af\u30bb\u30b9\u3092\u62d2\u5426\u3057\u3001\u30a2\u30af\u30bb\u30b9\u30ed\u30b0\u3001Not found\u30ed\u30b0\u3092\u7121\u52b9\u306b\u3059\u308b\nlocation ~ /\\. {\n    deny all;\n    access_log off;\n    log_not_found off;\n}\n\n# wp-config.php\u304a\u3088\u3073wp-blog-header.php\u3078\u306e\u30a2\u30af\u30bb\u30b9\u306e\u5834\u5408\u30a2\u30af\u30bb\u30b9\u30ed\u30b0\u3001Not found\u30ed\u30b0\u3092\u7121\u52b9\u3001\u307e\u305f404\u30b3\u30fc\u30c9\u3092\u8fd4\u3059\nlocation ~* /wp-(config|blog-header)\\.php$ {\n    access_log off;\n    log_not_found off;\n    return 404;\n}\n\n#readme.txt\u304a\u3088\u3073readme-\u3067\u59cb\u307e\u308btxt/html\u30d5\u30a1\u30a4\u30eb\u3078\u306e\u30a2\u30af\u30bb\u30b9\u306e\u5834\u5408\u30a2\u30af\u30bb\u30b9\u30ed\u30b0\u3001Not found\u30ed\u30b0\u3092\u7121\u52b9\u3001\u307e\u305f404\u30b3\u30fc\u30c9\u3092\u8fd4\u3059\nlocation ~* (readme|readme-[^\\.]+)\\.(txt|html?)$ {\n    access_log off;\n    log_not_found off;\n    return 404;\n}\n```\n\n\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u306e\u69cb\u6587\u30c1\u30a7\u30c3\u30af\u3092\u884c\u3044\u307e\u3059\u3002\n`service nginx configtest`\n\n\u5909\u66f4\u5185\u5bb9\u3092\u53cd\u6620\u3057\u307e\u3059\u3002\n`service nginx restart`\n\n##PHP7\u306e\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\nPHP\u306f\u6700\u65b0\u30d0\u30fc\u30b8\u30e7\u30f3\u306e7.1\u3092\u63a1\u7528\u3057\u307e\u3059\u3002\nPHP7\u3067\u306f\u52d5\u304b\u306a\u3044\u30d7\u30ed\u30b0\u30e9\u30e0\u304c\u3042\u308a\u307e\u3059\u304c\u3001WordPress\u3067\u306f\u63a8\u5968\u74b0\u5883\u306e\u305f\u3081\u554f\u984c\u3042\u308a\u307e\u305b\u3093\u3002\n\nPHP\u3068\u305d\u306e\u4ed6\u5fc5\u8981\u306a\u30d1\u30c3\u30b1\u30fc\u30b8\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\n`yum -y install --enablerepo=epel,remi-php71 php php-mbstring php-pear php-devel php-fpm php-mcrypt php-mysql php-gd`\n\nnginx \u7528\u306b\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3092\u5909\u66f4\u3057\u307e\u3059\u3002\n`sed -i 's/apache/nginx/g' /etc/php-fpm.d/www.conf`\n\n\u63a5\u7d9a\u3092UNIX\u30c9\u30e1\u30a4\u30f3\u30bd\u30b1\u30c3\u30c8\u306b\u5909\u66f4\u3057\u307e\u3059\u3002\n`sed -i 's/listen = 127.0.0.1:9000/listen = \\/var\\/run\\/php-fpm\\/php-fpm.sock/g' /etc/php-fpm.d/www.conf`\n\n\u30d1\u30fc\u30df\u30c3\u30b7\u30e7\u30f3\u3092\u5909\u66f4\u3057\u307e\u3059\u3002\n`sed -i 's/listen.mode = 0660/listen.mode = 0660\\nlisten.owner = nginx\\nlisten.group = nginx/g' /etc/php-fpm.d/www.conf`\n\nPHP\u3092\u8d77\u52d5\u3057\u307e\u3059\u3002\n`service php-fpm start`\n\n\u7dd1\u8272\u3067`OK`\u3068\u8868\u793a\u3055\u308c\u305f\u3089\u6210\u529f\u3067\u3059\u3002\u81ea\u52d5\u8d77\u52d5\u306b\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n`chkconfig php-fpm on`\n\nnginx\u306b\u3082\u53cd\u6620\u3057\u307e\u3059\u3002\n`service nginx restart`\n\n\u30d7\u30ed\u30bb\u30b9\u6570\u306a\u3069\u3092\u30ab\u30b9\u30bf\u30de\u30a4\u30ba\u3059\u308b\u3068\u3088\u308a\u9ad8\u901f\u3068\u306a\u308a\u307e\u3059\u3002\n\u8ca0\u8377\u72b6\u6cc1\u306a\u3069\u306b\u3042\u308f\u305b\u3066\n`/etc/php-fpm.d/www.conf`\n\u3092\u7de8\u96c6\u3059\u308b\u3068\u826f\u3044\u3067\u3057\u3087\u3046\u3002\n[CentOS php-fpm\u306e\u8a2d\u5b9a\u3092\u5909\u66f4\u3057\u3066\u30e1\u30e2\u30ea\u6d88\u8cbb\u3092\u6e1b\u3089\u3057\u305f\u65b9\u6cd5 | CrystalSnowman.com](http://www.crystalsnowman.com/?p=1309)\n\n##MySQL\u306e\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\n\u30c7\u30fc\u30bf\u30fc\u30d9\u30fc\u30b9\u30b5\u30fc\u30d0\u3068\u3057\u3066MySQL\u3092\u63a1\u7528\u3057\u307e\u3059\u3002\n\u6700\u8fd1\u306fMariaDB\u3082\u6709\u540d\u3067\u3059\u304c\u3001\u5b9f\u7e3e\u3068WordPress\u63a8\u5968\u74b0\u5883\u3068\u3044\u3046\u7406\u7531\u304b\u3089MySQL\u304c\u30aa\u30b9\u30b9\u30e1\u3067\u3059\u3002\n\nremi\u30ea\u30dd\u30b8\u30c8\u30ea\u304b\u3089MySQL\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\n`yum -y install --enablerepo=remi mysql-server mysql-devel`\n\nMySQL\u3092\u8d77\u52d5\u3057\u307e\u3059\u3002\n`service mysqld start`\n\n\u7dd1\u8272\u3067`OK`\u3068\u8868\u793a\u3055\u308c\u305f\u3089\u6210\u529f\u3067\u3059\u3002\u81ea\u52d5\u8d77\u52d5\u306b\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n`chkconfig mysqld on`\n\n###MySQL\u306e\u8a2d\u5b9a\n\u521d\u671f\u8a2d\u5b9a\u3068WordPress\u7528\u306e\u30c7\u30fc\u30bf\u30fc\u30d9\u30fc\u30b9\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\n###\u521d\u671f\u8a2d\u5b9a\n\u4ee5\u4e0b\u306e\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3057\u3066\u521d\u671f\u8a2d\u5b9a\u3092\u958b\u59cb\u3057\u307e\u3059\u3002\n`mysql_secure_installation`\n\n`Enter current password for root (enter for none):`\u3068\u8868\u793a\u3055\u308c\u305f\u3089\u3001Enter\u30ad\u30fc\u3092\u62bc\u3057\u307e\u3059\u3002\n\u203broot\u30d1\u30b9\u30ef\u30fc\u30c9\u306e\u5165\u529b\u3067\u3059\u304c\u3001\u672a\u8a2d\u5b9a\u306e\u305f\u3081\u4f55\u3082\u5165\u529b\u3057\u307e\u305b\u3093\u3002\n\n`Set root password? [Y/n]`\u3068\u8868\u793a\u3055\u308c\u305f\u3089\u3001`Y`\u3092\u5165\u529b\u3057\u307e\u3059\u3002\u30d1\u30b9\u30ef\u30fc\u30c9\u8a2d\u5b9a\u306e\u662f\u975e\u3067\u3059\u3002\n\n`New password:`\u3068\u8868\u793a\u3055\u308c\u305f\u3089\u3001root\u306b\u8a2d\u5b9a\u3059\u308b\u30d1\u30b9\u30ef\u30fc\u30c9\u3092\u5165\u529b\u3057\u307e\u3059\u3002\n\u203bMySQL\u30b5\u30fc\u30d0\u306eroot\u30e6\u30fc\u30b6\u306e\u30d1\u30b9\u30ef\u30fc\u30c9\u3067\u3059\u3002\uff08\u2260\u30b5\u30fc\u30d0\u306eroot\uff09\n\n`Re-enter new password:`\u3068\u8868\u793a\u3055\u308c\u305f\u3089\u3001\u78ba\u8a8d\u306e\u305f\u3081\u540c\u3058\u30d1\u30b9\u30ef\u30fc\u30c9\u3092\u5165\u529b\u3057\u307e\u3059\u3002\n\n`Remove anonymous users? [Y/n]`\u3068\u8868\u793a\u3055\u308c\u305f\u3089\u3001`Y`\u3092\u5165\u529b\u3057\u307e\u3059\u3002\u533f\u540d\u30e6\u30fc\u30b6\u306e\u524a\u9664\u3067\u3059\u3002\n\n`Disallow root login remotely? [Y/n]`\u3068\u8868\u793a\u3055\u308c\u305f\u3089\u3001`Y`\u3092\u5165\u529b\u3057\u307e\u3059\u3002\u30ea\u30e2\u30fc\u30c8\u30ed\u30b0\u30a4\u30f3\u306e\u53ef\u5426\u3067\u3059\u3002\n\n`Remove test database and access to it? [Y/n]`\u3068\u8868\u793a\u3055\u308c\u305f\u3089\u3001`Y`\u3092\u5165\u529b\u3057\u307e\u3059\u3002\u30c6\u30b9\u30c8\u30c7\u30fc\u30bf\u30fc\u30d9\u30fc\u30b9\u306e\u524a\u9664\u3067\u3059\u3002\n\n`Reload privilege tables now? [Y/n]`\u3068\u8868\u793a\u3055\u308c\u305f\u3089\u3001`Y`\u3092\u5165\u529b\u3057\u307e\u3059\u3002\u8a2d\u5b9a\u306e\u53cd\u6620\u3067\u3059\u3002\n\n\u65e2\u5b58\u306e\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3092\u524a\u9664\u3057\u307e\u3059\u3002\n`mv /etc/my.cnf /etc/my.cnf.backup`\n\n\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3092\u65b0\u898f\u4f5c\u6210\u3057\u307e\u3059\u3002\n`vi /etc/my.cnf`\n\n\u4ee5\u4e0b\u306e\u30b3\u30fc\u30c9\u3092\u3059\u3079\u3066\u30b3\u30d4\u30da\u3057\u307e\u3059\u3002\u7de8\u96c6\u65b9\u6cd5\u306f\u3053\u308c\u307e\u3067\u3068\u540c\u3058\u3067\u3059\u3002\n\n```:my.cnf\n[mysqld]\ndatadir=/var/lib/mysql\nsocket=/var/lib/mysql/mysql.sock\n\ncharacter-set-server=utf8\n\n# Disabling symbolic-links is recommended to prevent assorted security risks\nsymbolic-links=0\n\n# Settings user and group are ignored when systemd is used (fedora >= 15).\n# If you need to run mysqld under a different user or group,\n# customize your systemd unit file for mysqld according to the\n# instructions in http://fedoraproject.org/wiki/Systemd\nuser=mysql\n\n# Semisynchronous Replication\n# http://dev.mysql.com/doc/refman/5.5/en/replication-semisync.html\n# uncomment next line on MASTER\n;plugin-load=rpl_semi_sync_master=semisync_master.so\n# uncomment next line on SLAVE\n;plugin-load=rpl_semi_sync_slave=semisync_slave.so\n\n# Others options for Semisynchronous Replication\n;rpl_semi_sync_master_enabled=1\n;rpl_semi_sync_master_timeout=10\n;rpl_semi_sync_slave_enabled=1\n\n# http://dev.mysql.com/doc/refman/5.5/en/performance-schema.html\n;performance_schema\n\n[client]\ndefault-character-set=utf8\n\n[mysqldump]\ndefault-character-set=utf8\n\n[mysql]\ndefault-character-set=utf8\n\n[mysqld_safe]\nlog-error=/var/log/mysqld.log\npid-file=/var/run/mysqld/mysqld.pid\n\n\n#\n# include all files from the config directory\n#\n!includedir /etc/my.cnf.d\n```\n\n\u5909\u66f4\u5185\u5bb9\u3092\u53cd\u6620\u3057\u307e\u3059\u3002\n`service mysqld restart`\n\n\n###\u30c7\u30fc\u30bf\u30fc\u30d9\u30fc\u30b9\u306e\u4f5c\u6210\n\u6b21\u306bWordPress\u7528\u306e\u30c7\u30fc\u30bf\u30fc\u30d9\u30fc\u30b9\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n`mysql -u root -p`\n\n\u5148\u7a0b\u8a2d\u5b9a\u3057\u305f\u30d1\u30b9\u30ef\u30fc\u30c9\u3092\u5165\u529b\u3057\u307e\u3059\u3002\n`Enter password:\u3000\u3000\u3000\u2190\u30d1\u30b9\u30ef\u30fc\u30c9\u3092\u5165\u529b\uff08\u8868\u793a\u3055\u308c\u307e\u305b\u3093\uff09`\n\n\u5de6\u5074\u306b`mysql>`\u3068\u8868\u793a\u3055\u308c\u305f\u3089\u3001\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002'wp_db'\u306e\u90e8\u5206\u306f\u597d\u304d\u306a\u30c7\u30fc\u30bf\u30fc\u30d9\u30fc\u30b9\u540d\u306b\u5909\u66f4\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n`create database wp_db;`\n\nWordPress\u7528\u306e\u30c7\u30fc\u30bf\u30fc\u30d9\u30fc\u30b9\u30e6\u30fc\u30b6\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n'wp_user'\u306f\u597d\u304d\u306a\u30e6\u30fc\u30b6\u540d\u3001\"\u30e6\u30fc\u30b6\u306b\u8a2d\u5b9a\u3059\u308b\u30d1\u30b9\u30ef\u30fc\u30c9\"\u306f\u5f37\u5ea6\u306e\u9ad8\u3044\u30d1\u30b9\u30ef\u30fc\u30c9\u306b\u5909\u66f4\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n`GRANT ALL PRIVILEGES ON wp_db.* TO wp_user@localhost IDENTIFIED BY '\u30e6\u30fc\u30b6\u306b\u8a2d\u5b9a\u3059\u308b\u30d1\u30b9\u30ef\u30fc\u30c9';`\n\n\u5909\u66f4\u5185\u5bb9\u3092\u53cd\u6620\u3057\u307e\u3059\u3002\n`FLUSH PRIVILEGES;`\n\n\u4ee5\u4e0b\u306e\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3057\u3066\u3001MySQL\u304b\u3089\u30ed\u30b0\u30a2\u30a6\u30c8\u3057\u307e\u3059\u3002\n`exit`\n\n##WordPress\u306e\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\nWordPress\u306e\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u304b\u3089\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u307e\u3067\u3092\u884c\u3044\u307e\u3059\u3002\n\n\u30db\u30fc\u30e0\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u79fb\u52d5\u3057\u307e\u3059\u3002\n`cd`\n\n\u6700\u65b0\u7248\u306eWordPress\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3057\u307e\u3059\u3002\n`wget https://ja.wordpress.org/latest-ja.tar.gz`\n\n\u5727\u7e2e\u30d5\u30a1\u30a4\u30eb\u306e\u305f\u3081\u89e3\u51cd\u3057\u307e\u3059\u3002\n`tar -xvzf latest-ja.tar.gz`\n\n\u89e3\u51cd\u3057\u305f\u30d5\u30a1\u30a4\u30eb\u3092\u516c\u958b\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u79fb\u52d5\u3057\u307e\u3059\u3002\n`cp -r wordpress /var/www/`\n\n\u30d1\u30fc\u30df\u30c3\u30b7\u30e7\u30f3\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n`chown -R nginx:nginx /var/www/wordpress`\n\n\u30d6\u30e9\u30a6\u30b6\u3092\u958b\u304d\u3001\u4ee5\u4e0b\u306eURL\u306b\u30a2\u30af\u30bb\u30b9\u3057\u307e\u3059\u3002\n`https://\u30c9\u30e1\u30a4\u30f3\u540d/`\n\n\u3053\u3053\u304b\u3089\u306f\u6307\u793a\u306b\u5f93\u3063\u3066\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3092\u9032\u3081\u3066\u3044\u304f\u3060\u3051\u3067\u3059\u3002\n\u7528\u610f\u3059\u3079\u304d\u3082\u306e\u304c\u8868\u793a\u3055\u308c\u307e\u3059\u3002\u7528\u610f\u6e08\u307f\u306e\u305f\u3081\u300c\u3055\u3042\u3001\u59cb\u3081\u307e\u3057\u3087\u3046\uff01\u300d\u3092\u30af\u30ea\u30c3\u30af\u3057\u307e\u3059\u3002\n![Installing WordPress (1).jpg](https://qiita-image-store.s3.amazonaws.com/0/167722/6ff4ce78-234a-e760-ad4f-01c204e04cc3.jpeg)\n\nMySQL\u3067\u8a2d\u5b9a\u3057\u305f\u30c7\u30fc\u30bf\u30fc\u30d9\u30fc\u30b9\u60c5\u5831\u3092\u57cb\u3081\u3066\u3044\u304d\u307e\u3059\u3002\n![Installing WordPress (2).jpg](https://qiita-image-store.s3.amazonaws.com/0/167722/bf27f5ea-92c0-ca8f-0f19-820c955c4e8e.jpeg)\n\n- \u30c7\u30fc\u30bf\u30fc\u30d9\u30fc\u30b9\u540d\uff1awp_db\n- \u30e6\u30fc\u30b6\u540d\uff1awp_user\n- \u30d1\u30b9\u30ef\u30fc\u30c9\uff1awp_user\u306b\u8a2d\u5b9a\u3057\u305f\u30d1\u30b9\u30ef\u30fc\u30c9\n- \u30c7\u30fc\u30bf\u30fc\u30d9\u30fc\u30b9\u306e\u30db\u30b9\u30c8\u540d\uff1alocalhost\uff08\u5909\u66f4\u4e0d\u8981\uff09\n- \u30c6\u30fc\u30d6\u30eb\u63a5\u7d9a\u8f9e\uff1awp_\uff08\u5909\u66f4\u4e0d\u8981\uff09\n\n\u5168\u3066\u57cb\u3081\u7d42\u308f\u3063\u305f\u3089\u300c\u9001\u4fe1\u300d\u3092\u30af\u30ea\u30c3\u30af\u3057\u307e\u3059\u3002\n\n\u554f\u984c\u304c\u306a\u3051\u308c\u3070\u4ee5\u4e0b\u306e\u753b\u9762\u304c\u8868\u793a\u3055\u308c\u307e\u3059\u3002\n\u9055\u3046\u753b\u9762\u304c\u8868\u793a\u3055\u308c\u308b\u5834\u5408\u306f\u3001\u30e6\u30fc\u30b6\u540d\u3084\u30d1\u30b9\u30ef\u30fc\u30c9\u3092\u78ba\u8a8d\u3057\u3066\u307f\u3066\u304f\u3060\u3055\u3044\u3002\n\u300c\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u5b9f\u884c\u300d\u3092\u30af\u30ea\u30c3\u30af\u3057\u307e\u3059\u3002\n![Installing WordPress (3).jpg](https://qiita-image-store.s3.amazonaws.com/0/167722/f9962713-e4e4-35d7-6e7d-8504bd7b2d05.jpeg)\n\n\u3053\u306e\u753b\u9762\u3067\u306f\u30b5\u30a4\u30c8\u540d\u3084WordPress\u306e\u7ba1\u7406\u30a2\u30ab\u30a6\u30f3\u30c8\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n\u30d1\u30b9\u30ef\u30fc\u30c9\u306b\u3064\u3044\u3066\u306f\u3001\u81ea\u52d5\u7684\u306b\u751f\u6210\u3055\u308c\u308b\u305f\u3081\u305d\u308c\u3092\u5229\u7528\u3057\u3066\u3082\u826f\u3044\u3067\u3057\u3087\u3046\u3002\n\u3082\u3061\u308d\u3093\u30d1\u30b9\u30ef\u30fc\u30c9\u306f\u63a7\u3048\u3066\u304a\u3044\u3066\u304f\u3060\u3055\u3044\u3002\n\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u306f\u5229\u7528\u53ef\u80fd\u306a\u30a2\u30c9\u30ec\u30b9\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\u5168\u3066\u57cb\u3081\u7d42\u308f\u3063\u305f\u3089\u300cWordPress\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u300d\u3092\u30af\u30ea\u30c3\u30af\u3057\u307e\u3059\u3002\n![Installing WordPress (4).jpg](https://qiita-image-store.s3.amazonaws.com/0/167722/398c355b-e256-e309-d2e7-53498196b545.jpeg)\n\n\u4ee5\u4e0a\u3067\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u306f\u5b8c\u4e86\u3067\u3059\u3002\u304a\u75b2\u308c\u69d8\u3067\u3057\u305f\u3002\n\u30d7\u30e9\u30b0\u30a4\u30f3\u306a\u3069\u306f\u304a\u597d\u307f\u3067\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u3066\u69cb\u3044\u307e\u305b\u3093\u304c\u3001[Nginx Cache Controller](https://ja.wordpress.org/plugins/nginx-champuru/)\u306f\u5fc5\u305a\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u3066\u304a\u3044\u3066\u304f\u3060\u3055\u3044\u3002Fastcgi Cache\u306e\u524a\u9664\u30d7\u30e9\u30b0\u30a4\u30f3\u3067\u3059\u3002\n\u8a2d\u5b9a\u5024\u306f\u4ee5\u4e0b\u306e\u901a\u308a\u3067\u3001/etc/nginx/nginx.conf\u306e\u5024\u3068\u540c\u3058\u3067\u3059\u3002\n\n- \u30ad\u30e3\u30c3\u30b7\u30e5\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3000\uff1a\u3000/var/cache/nginx/fcgi_cache\n- \u30ad\u30e3\u30c3\u30b7\u30e5\u30ec\u30d9\u30eb\u3000\uff1a\u30001:2\n\n![Installing WordPress (5).jpg](https://qiita-image-store.s3.amazonaws.com/0/167722/478cd421-7aa9-3184-8703-b59361d82686.jpeg)\n\n\n", "tags": ["CentOS6.x", "LEMP", "letsencrypt"]}