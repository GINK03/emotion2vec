{"tags": ["Ruby", "migemo", "\u6587\u5b57\u30b3\u30fc\u30c9", "\u4e38\u6570\u5b57", "\u7f6e\u63db"], "context": "\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u7b49\u3067\u2460\u306a\u3069\u306e\u4e38\u6570\u5b57\u304c\u3042\u308b\u3068 migemo \u306e\u529b\u304c\u6d3b\u304b\u305b\u306a\u3044\u306e\u3067\u3001\u3055\u304f\u3063\u3068\u5909\u63db\u3057\u3066\u3057\u307e\u304a\u3046\u3068\u3057\u3066\u8003\u3048\u305f\u30b3\u30fc\u30c9\u3067\u3059\u3002\nlist = [\n  {:type => \"\u25cb\", :size => \"\u4e2d\", :base => 0,  :range => 0x24ea..0x24ea   },\n  {:type => \"\u25cb\", :size => \"\u4e2d\", :base => 1,  :range => 0x2460..0x2473   },\n  {:type => \"\u25cb\", :size => \"\u4e2d\", :base => 21, :range => 0x3251..0x325f   },\n  {:type => \"\u25cb\", :size => \"\u4e2d\", :base => 36, :range => 0x32b1..0x32bf   },\n  {:type => \"\u25cb\", :size => \"\u5c0f\", :base => 0,  :range => 0x1f10b..0x1f10b },\n  {:type => \"\u25cb\", :size => \"\u5c0f\", :base => 1,  :range => 0x2780..0x2789   },\n  {:type => \"\u25cf\", :size => \"\u4e2d\", :base => 0,  :range => 0x24ff..0x24ff   },\n  {:type => \"\u25cf\", :size => \"\u4e2d\", :base => 1,  :range => 0x2776..0x277f   },\n  {:type => \"\u25cf\", :size => \"\u4e2d\", :base => 11, :range => 0x24eb..0x24f4   },\n  {:type => \"\u25cf\", :size => \"\u4e2d\", :base => 0,  :range => 0x1f10c..0x1f10c },\n  {:type => \"\u25cf\", :size => \"\u5c0f\", :base => 1,  :range => 0x278a..0x2793   },\n  {:type => \"\u25ce\", :size => \"\u4e2d\", :base => 1,  :range => 0x24f5..0x24fe   },\n]\n\n# \u30c6\u30fc\u30d6\u30eb\u304c\u6b63\u3057\u3044\u304b\u78ba\u8a8d\u3059\u308b\u7528\nif false\n  list.each do |e|\n    range = e[:base] .. e[:base] + e[:range].size.pred\n    s = e[:range].to_a.pack(\"U*\")\n    p [e[:type], e[:size], range, s]\n  end\nend\n\n# \u7f6e\u63db\u7528\u30cf\u30c3\u30b7\u30e5\u3092\u6e96\u5099\nreplace_hash = list.inject({}) { |a, e|\n  a.merge(e[:range].each.with_index(e[:base]).inject({}) { |a, (v, i)|\n      a.merge([v].pack(\"U\") => \"(#{i})\")\n    })\n}\n\nreplace = -> s { s.gsub(/[#{replace_hash.keys.join}]/o, replace_hash) }\n\n# \u30de\u30c3\u30c1\u3057\u305f\u3068\u3053\u308d\u3060\u3051\u5909\u63db\u3067\u304d\u308b\nreplace[\"\u9805\u76ee\u2460\u3067\u3059\"]           # => \"\u9805\u76ee(1)\u3067\u3059\"\n\n# \u5168\u90e8\u5909\u63db\u3057\u3066\u307f\u308b\nlist.each do |e|\n  s = e[:range].to_a.pack(\"U*\")\n  p [s, replace[s]]\nend\n# >> [\"\u24ea\", \"(0)\"]\n# >> [\"\u2460\u2461\u2462\u2463\u2464\u2465\u2466\u2467\u2468\u2469\u246a\u246b\u246c\u246d\u246e\u246f\u2470\u2471\u2472\u2473\", \"(1)(2)(3)(4)(5)(6)(7)(8)(9)(10)(11)(12)(13)(14)(15)(16)(17)(18)(19)(20)\"]\n# >> [\"\u3251\u3252\u3253\u3254\u3255\u3256\u3257\u3258\u3259\u325a\u325b\u325c\u325d\u325e\u325f\", \"(21)(22)(23)(24)(25)(26)(27)(28)(29)(30)(31)(32)(33)(34)(35)\"]\n# >> [\"\u32b1\u32b2\u32b3\u32b4\u32b5\u32b6\u32b7\u32b8\u32b9\u32ba\u32bb\u32bc\u32bd\u32be\u32bf\", \"(36)(37)(38)(39)(40)(41)(42)(43)(44)(45)(46)(47)(48)(49)(50)\"]\n# >> [\"\ud83c\udd0b\", \"(0)\"]\n# >> [\"\u2780\u2781\u2782\u2783\u2784\u2785\u2786\u2787\u2788\u2789\", \"(1)(2)(3)(4)(5)(6)(7)(8)(9)(10)\"]\n# >> [\"\u24ff\", \"(0)\"]\n# >> [\"\u2776\u2777\u2778\u2779\u277a\u277b\u277c\u277d\u277e\u277f\", \"(1)(2)(3)(4)(5)(6)(7)(8)(9)(10)\"]\n# >> [\"\u24eb\u24ec\u24ed\u24ee\u24ef\u24f0\u24f1\u24f2\u24f3\u24f4\", \"(11)(12)(13)(14)(15)(16)(17)(18)(19)(20)\"]\n# >> [\"\ud83c\udd0c\", \"(0)\"]\n# >> [\"\u278a\u278b\u278c\u278d\u278e\u278f\u2790\u2791\u2792\u2793\", \"(1)(2)(3)(4)(5)(6)(7)(8)(9)(10)\"]\n# >> [\"\u24f5\u24f6\u24f7\u24f8\u24f9\u24fa\u24fb\u24fc\u24fd\u24fe\", \"(1)(2)(3)(4)(5)(6)(7)(8)(9)(10)\"]\n\n\n\u53c2\u7167\n\n\u4e38\u6570\u5b57 - Wikipedia https://ja.wikipedia.org/wiki/%E4%B8%B8%E6%95%B0%E5%AD%97\n\n\n\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u7b49\u3067\u2460\u306a\u3069\u306e\u4e38\u6570\u5b57\u304c\u3042\u308b\u3068 migemo \u306e\u529b\u304c\u6d3b\u304b\u305b\u306a\u3044\u306e\u3067\u3001\u3055\u304f\u3063\u3068\u5909\u63db\u3057\u3066\u3057\u307e\u304a\u3046\u3068\u3057\u3066\u8003\u3048\u305f\u30b3\u30fc\u30c9\u3067\u3059\u3002\n\n```rb\nlist = [\n  {:type => \"\u25cb\", :size => \"\u4e2d\", :base => 0,  :range => 0x24ea..0x24ea   },\n  {:type => \"\u25cb\", :size => \"\u4e2d\", :base => 1,  :range => 0x2460..0x2473   },\n  {:type => \"\u25cb\", :size => \"\u4e2d\", :base => 21, :range => 0x3251..0x325f   },\n  {:type => \"\u25cb\", :size => \"\u4e2d\", :base => 36, :range => 0x32b1..0x32bf   },\n  {:type => \"\u25cb\", :size => \"\u5c0f\", :base => 0,  :range => 0x1f10b..0x1f10b },\n  {:type => \"\u25cb\", :size => \"\u5c0f\", :base => 1,  :range => 0x2780..0x2789   },\n  {:type => \"\u25cf\", :size => \"\u4e2d\", :base => 0,  :range => 0x24ff..0x24ff   },\n  {:type => \"\u25cf\", :size => \"\u4e2d\", :base => 1,  :range => 0x2776..0x277f   },\n  {:type => \"\u25cf\", :size => \"\u4e2d\", :base => 11, :range => 0x24eb..0x24f4   },\n  {:type => \"\u25cf\", :size => \"\u4e2d\", :base => 0,  :range => 0x1f10c..0x1f10c },\n  {:type => \"\u25cf\", :size => \"\u5c0f\", :base => 1,  :range => 0x278a..0x2793   },\n  {:type => \"\u25ce\", :size => \"\u4e2d\", :base => 1,  :range => 0x24f5..0x24fe   },\n]\n\n# \u30c6\u30fc\u30d6\u30eb\u304c\u6b63\u3057\u3044\u304b\u78ba\u8a8d\u3059\u308b\u7528\nif false\n  list.each do |e|\n    range = e[:base] .. e[:base] + e[:range].size.pred\n    s = e[:range].to_a.pack(\"U*\")\n    p [e[:type], e[:size], range, s]\n  end\nend\n\n# \u7f6e\u63db\u7528\u30cf\u30c3\u30b7\u30e5\u3092\u6e96\u5099\nreplace_hash = list.inject({}) { |a, e|\n  a.merge(e[:range].each.with_index(e[:base]).inject({}) { |a, (v, i)|\n      a.merge([v].pack(\"U\") => \"(#{i})\")\n    })\n}\n\nreplace = -> s { s.gsub(/[#{replace_hash.keys.join}]/o, replace_hash) }\n\n# \u30de\u30c3\u30c1\u3057\u305f\u3068\u3053\u308d\u3060\u3051\u5909\u63db\u3067\u304d\u308b\nreplace[\"\u9805\u76ee\u2460\u3067\u3059\"]           # => \"\u9805\u76ee(1)\u3067\u3059\"\n\n# \u5168\u90e8\u5909\u63db\u3057\u3066\u307f\u308b\nlist.each do |e|\n  s = e[:range].to_a.pack(\"U*\")\n  p [s, replace[s]]\nend\n# >> [\"\u24ea\", \"(0)\"]\n# >> [\"\u2460\u2461\u2462\u2463\u2464\u2465\u2466\u2467\u2468\u2469\u246a\u246b\u246c\u246d\u246e\u246f\u2470\u2471\u2472\u2473\", \"(1)(2)(3)(4)(5)(6)(7)(8)(9)(10)(11)(12)(13)(14)(15)(16)(17)(18)(19)(20)\"]\n# >> [\"\u3251\u3252\u3253\u3254\u3255\u3256\u3257\u3258\u3259\u325a\u325b\u325c\u325d\u325e\u325f\", \"(21)(22)(23)(24)(25)(26)(27)(28)(29)(30)(31)(32)(33)(34)(35)\"]\n# >> [\"\u32b1\u32b2\u32b3\u32b4\u32b5\u32b6\u32b7\u32b8\u32b9\u32ba\u32bb\u32bc\u32bd\u32be\u32bf\", \"(36)(37)(38)(39)(40)(41)(42)(43)(44)(45)(46)(47)(48)(49)(50)\"]\n# >> [\"\ud83c\udd0b\", \"(0)\"]\n# >> [\"\u2780\u2781\u2782\u2783\u2784\u2785\u2786\u2787\u2788\u2789\", \"(1)(2)(3)(4)(5)(6)(7)(8)(9)(10)\"]\n# >> [\"\u24ff\", \"(0)\"]\n# >> [\"\u2776\u2777\u2778\u2779\u277a\u277b\u277c\u277d\u277e\u277f\", \"(1)(2)(3)(4)(5)(6)(7)(8)(9)(10)\"]\n# >> [\"\u24eb\u24ec\u24ed\u24ee\u24ef\u24f0\u24f1\u24f2\u24f3\u24f4\", \"(11)(12)(13)(14)(15)(16)(17)(18)(19)(20)\"]\n# >> [\"\ud83c\udd0c\", \"(0)\"]\n# >> [\"\u278a\u278b\u278c\u278d\u278e\u278f\u2790\u2791\u2792\u2793\", \"(1)(2)(3)(4)(5)(6)(7)(8)(9)(10)\"]\n# >> [\"\u24f5\u24f6\u24f7\u24f8\u24f9\u24fa\u24fb\u24fc\u24fd\u24fe\", \"(1)(2)(3)(4)(5)(6)(7)(8)(9)(10)\"]\n```\n\n# \u53c2\u7167\n\n- \u4e38\u6570\u5b57 - Wikipedia https://ja.wikipedia.org/wiki/%E4%B8%B8%E6%95%B0%E5%AD%97\n"}