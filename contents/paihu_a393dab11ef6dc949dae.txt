{"context": "\u591a\u304f\u306eCisco\u6a5f\u5668\u3067\u540c\u3058\u30b3\u30de\u30f3\u30c9(\u4e3b\u306bshow \u7cfb)\u3092\u5b9f\u884c\u3057\u305f\u304f\u306a\u3063\u305f\u306e\u3067\nAnsible\u3067\u5b9f\u884c\u3055\u305b\u3066\u307f\u308b\u3002\nshell \u3067\u3084\u308b\u3068\u304d\u3068\u306e\u5927\u304d\u306a\u9055\u3044\u306f\nInventory\u3092\u3046\u307e\u304f\u66f8\u304f\u3068\u3001\u5b9f\u884c\u5148\u3092\u67d4\u8edf\u306b\u9078\u629e\u3067\u304d\u308b\u3068\u3044\u3046\u3068\u3053\u308d\u3002\nhosts\u30d5\u30a1\u30a4\u30eb\u3092\u305f\u304f\u3055\u3093\u62b1\u3048\u308b\u3088\u308a\u306finventory\u30d5\u30a1\u30a4\u30eb\u306e\u307b\u3046\u304c\u4fee\u6b63\u3059\u308b\u3068\u304d\u306e\u3053\u3068\u3092\u8003\u3048\u308b\u3068\u826f\u3044\u304b\u3068\u3002\nInventory\u30d5\u30a1\u30a4\u30eb\u306e\u30a2\u30af\u30bb\u30b9\u6a29\u306b\u306f\u6ce8\u610f\u3059\u308b\u304b\u3001credential\u306a\u60c5\u5831\u3092\u542b\u3081\u308b\u306e\u3092\u3084\u3081\u307e\u3057\u3087\u3046\u3002\n\n\u4f5c\u3063\u305f\u30d5\u30a1\u30a4\u30eb\n\nplaybook\none.yml\n - hosts: \"{{ host }}\"\n   gather_facts: no\n   connection: local\n\n   tasks:\n     - name: one-shot\n       register: result\n       ios_command:\n          provider: \"{{ cli }}\"\n          commands: \"{{ command }}\"\n\n     - debug: var=result.stdout_lines\n       when: result|success\n\n   vars:\n     cli:\n       host: \"{{ inventory_hostname }}\"\n       username: \"{{ ansible_user }}\"\n       password: \"{{ ansible_password }}\"\n       authorize: true\n       auth_pass: \"{{ ansible_net_auth }}\"\n\n\ninventory file\nhosts\n[group1]\nhost1\nhost2\n\n[group2]\nhost3\nhost4\n\n[all:children]\ngroup1\ngroup2\n\n[all:vars]\nansible_user=login-username\nansible_password=login-password\nansible_net_auth=enable-password\n\n\nshell\none.sh\n#!/bin/bash\nif [ $# -lt 2 ]; then\n    echo \"usage $0 hostgroup command [command]...\"\n    exit 1\nfi\n\nhost=\"$1\"\nshift\n\ncmd=\"[\"\nfor c in \"$@\"; do\n    cmd=\"${cmd}'${c}',\"\ndone\ncmd=\"${cmd%,}]\"\n\nansible-playbook -i $(cd $(dirname $0) && pwd)/hosts $(cd $(dirname $0) && pwd)/one.yml -e \"{\\\"command\\\":\\\"${cmd}\\\",\\\"host\\\":\\\"${host}\\\"}\"\n\n\n\u4f7f\u3044\u65b9\n./one.sh \"host group name\" \"some command1\" \"some command2\" \"some command3\" ...\n\n\u3082\u3057\u304f\u306f\nansible-playbook -i hosts one.yml -e '{\"host\":\"host group name\",\"command\":\"some command\"}'\n\nansible-playbook -i hosts one.yml -e '{\"host\":\"host group name\",\"command\":\"['some command','some command2','some command3'...]\"}'\n\n\n\u591a\u304f\u306eCisco\u6a5f\u5668\u3067\u540c\u3058\u30b3\u30de\u30f3\u30c9(\u4e3b\u306bshow \u7cfb)\u3092\u5b9f\u884c\u3057\u305f\u304f\u306a\u3063\u305f\u306e\u3067\nAnsible\u3067\u5b9f\u884c\u3055\u305b\u3066\u307f\u308b\u3002\n\nshell \u3067\u3084\u308b\u3068\u304d\u3068\u306e\u5927\u304d\u306a\u9055\u3044\u306f\nInventory\u3092\u3046\u307e\u304f\u66f8\u304f\u3068\u3001\u5b9f\u884c\u5148\u3092\u67d4\u8edf\u306b\u9078\u629e\u3067\u304d\u308b\u3068\u3044\u3046\u3068\u3053\u308d\u3002\nhosts\u30d5\u30a1\u30a4\u30eb\u3092\u305f\u304f\u3055\u3093\u62b1\u3048\u308b\u3088\u308a\u306finventory\u30d5\u30a1\u30a4\u30eb\u306e\u307b\u3046\u304c\u4fee\u6b63\u3059\u308b\u3068\u304d\u306e\u3053\u3068\u3092\u8003\u3048\u308b\u3068\u826f\u3044\u304b\u3068\u3002\nInventory\u30d5\u30a1\u30a4\u30eb\u306e\u30a2\u30af\u30bb\u30b9\u6a29\u306b\u306f\u6ce8\u610f\u3059\u308b\u304b\u3001credential\u306a\u60c5\u5831\u3092\u542b\u3081\u308b\u306e\u3092\u3084\u3081\u307e\u3057\u3087\u3046\u3002\n\n\n## \u4f5c\u3063\u305f\u30d5\u30a1\u30a4\u30eb\n### playbook\none.yml\n\n```\n - hosts: \"{{ host }}\"\n   gather_facts: no\n   connection: local\n\n   tasks:\n     - name: one-shot\n       register: result\n       ios_command:\n          provider: \"{{ cli }}\"\n          commands: \"{{ command }}\"\n \n     - debug: var=result.stdout_lines\n       when: result|success\n \n   vars:\n     cli:\n       host: \"{{ inventory_hostname }}\"\n       username: \"{{ ansible_user }}\"\n       password: \"{{ ansible_password }}\"\n       authorize: true\n       auth_pass: \"{{ ansible_net_auth }}\"\n```\n\n### inventory file\nhosts\n\n```\n[group1]\nhost1\nhost2\n\n[group2]\nhost3\nhost4\n\n[all:children]\ngroup1\ngroup2\n\n[all:vars]\nansible_user=login-username\nansible_password=login-password\nansible_net_auth=enable-password\n```\n### shell\none.sh\n\n```\n#!/bin/bash\nif [ $# -lt 2 ]; then\n    echo \"usage $0 hostgroup command [command]...\"\n    exit 1\nfi\n\nhost=\"$1\"\nshift\n\ncmd=\"[\"\nfor c in \"$@\"; do\n    cmd=\"${cmd}'${c}',\"\ndone\ncmd=\"${cmd%,}]\"\n\nansible-playbook -i $(cd $(dirname $0) && pwd)/hosts $(cd $(dirname $0) && pwd)/one.yml -e \"{\\\"command\\\":\\\"${cmd}\\\",\\\"host\\\":\\\"${host}\\\"}\"\n```\n\n## \u4f7f\u3044\u65b9\n```\n./one.sh \"host group name\" \"some command1\" \"some command2\" \"some command3\" ...\n```\n\u3082\u3057\u304f\u306f\n\n```\nansible-playbook -i hosts one.yml -e '{\"host\":\"host group name\",\"command\":\"some command\"}'\n\nansible-playbook -i hosts one.yml -e '{\"host\":\"host group name\",\"command\":\"['some command','some command2','some command3'...]\"}'\n\n```\n\n", "tags": ["Ansible", "Cisco"]}