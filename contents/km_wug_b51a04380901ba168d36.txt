{"tags": ["PHP", "JQery", "JSON", "Ajax", "WakeUp,Girls!"], "context": " More than 1 year has passed since last update.\u5927\u5b66\u306ePHP\u8ab2\u984c\u304c\u306a\u305e\u3060\u3063\u305f\u306e\u3067\u305d\u306e\u611a\u75f4\u3068\u63d0\u51fa\u8ab2\u984c\u3092\u3042\u308c\u3084\u3053\u308c\u3084\u3068...\n\u30ab\u30ab\u30ef\u30c3\u30d7\u6c0f\u306b\u5354\u529b\u3044\u305f\u3060\u3044\u305f\u306e\u3067\u3001\u305d\u306e\u5831\u544a\u3082\u304b\u306d\u3066\u3002\n\u307e\u305a\u554f\u984c\u8a2d\u5b9a\u304b\u3089\u898b\u3066\u3044\u304d\u307e\u3057\u3087\u3046\u3002\nCSV\u5f62\u5f0f\u3067\u4fdd\u5b58\u3055\u308c\u305f\u540d\u7c3f\u304b\u3089\uff0c/etc/passwd \u5f62\u5f0f\u306e\u30d5\u30a1\u30a4\u30eb\u3092\u751f\u6210\u3059\u308b\uff0e\n\u3053\u308c\u304c\u8ab2\u984c\u306e\u76ee\u7684\u3002\nCSV\u30d5\u30a1\u30a4\u30eb\u306e\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u306f\u3010\"\u5b66\u751f\u756a\u53f7\",\"\u6c0f\u540d\"\uff0c\"name\"\u3011\npasswd\u30d5\u30a1\u30a4\u30eb\u306f\u3010login_name:*:UID:GID::::GECOS:home_dir:login_shell\u3011\n\u305f\u3068\u3048\u3070\n\"25115773\",\"\u5c71\u4e0b\u3000\u4e03\u6d77\",\"Yamasita Nanami\"\n\u306b\u5bfe\u3057\u3066\u3001\nyamasita\\:X\\:251773:2511::::yamasita nanami:/home/yamasita:/bin/sh\n\n\u3068\u3044\u3046\u306e\u3092\u4f5c\u6210\u3059\u308b\u3002\u304c\u3044\u304f\u3064\u304b\u5236\u7d04\u304c\u3002\nlogin_name\u306b\u95a2\u3057\u3066\n\u30fb\u3059\u3079\u3066\u5c0f\u6587\u5b57\uff0c\u6587\u5b57\u306f\u300c\u30a2\u30eb\u30d5\u30a1\u30d9\u30c3\u30c8\uff0c\u6570\u5b57\uff0c_\uff0c-\uff0c.\u300d\u306e\u307f\u4f7f\u7528\u53ef\u80fd\u3067\uff0c\u5148\u982d\u306f\u30a2\u30eb\u30d5\u30a1\u30d9\u30c3\u30c8\u3067\u3042\u308b\u3053\u3068\u3002\n\u30fb\u91cd\u8907\u304c\u306a\u3044\u3053\u3068\n\u30fb\u6700\u59278\u6587\u5b57\u307e\u3067\n\u30fb\u91cd\u8907\u3057\u306a\u3044\u9650\u308a\uff0c\u59d3\u3000\u306e\u30ed\u30fc\u30de\u5b57\u8868\u8a18\u3092\u57fa\u672c\u3068\u3059\u308b\u3053\u3068\uff0e\n\u30fb\u30ed\u30fc\u30de\u5b57\u8868\u8a18\u3092\u7d71\u4e00\u3059\u308b\u3053\u3068\nsi->shi, sya->sha, syu->shu, syo->sho, jya->ja, jyu->ju, jyo->jo, tu->tsu, ti->chi, tya->cha, tyu->chu, tyo->cho, hu->fu\n\n\u3053\u3053\u3067\u7591\u554f\u3002\u30e6\u30fc\u30b6\u30fc\u540d\u3063\u3066\u30b7\u30b9\u30c6\u30e0\u5074\u3067\u52dd\u624b\u306b\u5909\u3048\u3066\u3044\u3044\u306e\uff1f\uff1f\n\u3082\u3061\u308d\u3093\u8ab2\u984c\u3060\u304b\u3089\u898f\u5247\u306b\u5f93\u3063\u305f\u540d\u524d\u306b\u306f\u3057\u307e\u3059\u3002\u305d\u308c\u3067\u3082\u30b7\u30b9\u30c6\u30e0\u5074\u304b\u3089\u63d0\u793a\u3055\u308c\u305f\u5019\u88dc\u3057\u304b\u5229\u7528\u3067\u304d\u306a\u3044\u306e\u306f\u304a\u304b\u3057\u3044\u3002\uff08\u8ab2\u984c\u3067\u306f\u30ed\u30fc\u30de\u5b57\u5909\u63db\u3088\u3046\u3059\u308b\u306b\u3001\u4e0a\u306e\u9006\u3092\u7528\u3044\u3066\u5019\u88dc\u3092\u63d0\u793a\u3059\u308b\u3088\u3046\u306a\u3082\u306e\u3082\u3042\u308a\u307e\u3057\u305f\uff09\n\u3068\u3044\u3046\u308f\u3051\u3067\uff01\uff01\u30d6\u30e9\u30a6\u30b6\u3092\u901a\u3057\u3066\u30e6\u30fc\u30b6\u30fc\u306b\u540d\u524d\u3092\u3082\u3089\u304a\u3046\u3058\u3083\u306a\u3044\u304b\u3068\u3002\n\u8981\u3059\u308b\u306b\n\"25115774\",\"\u5965\u91ce\u3000\u9999\u8036\",\"Okuno Kaya\"\n\"25115775\",\"\u5965\u91ce\u3000\u9999\u8036\",\"Okuno Kaya\"\n\"25115776\",\"\u5965\u91ce\u3000\u9999\u8036\",\"Okuno Kaya\"\n\n\u306b\u5bfe\u3057\u3066\u3001\nokuno\\:X\\:251773:2511::::okuno kaya:/home/okuno:/bin/sh <-\u666e\u901a\u306b\nokuno_ka\\:X\\:251773:2511::::okuno kaya:/home/okuno:/bin/sh <-\u91cd\u8907\u3059\u308b\u304b\u30898\u6587\u5b57\u4ee5\u4e0b\u3067\u59d3_\u540d\u306b\u3057\u305f\nokuno???\\:X\\:251773:2511::::okuno kaya:/home/okuno???:/bin/sh <-\u3053\u308c\u3069\u3046\u3059\u308b\uff1f\n\n\u3053\u308c\u3092\u30d6\u30e9\u30a6\u30b6\u5074\u3067\u30e6\u30fc\u30b6\u30fc\u306b\u805e\u3053\u3046\u3068\u3044\u3046\u308f\u3051\u3067\u3059\u3002\n\u3069\u3046\u3084\u3063\u3066\uff1f\uff1f\u3068\u308a\u3042\u3048\u305aform\u3067post\u3067\u3082\u3057\u3066\u308a\u3083\u3044\u3044\u3093\u3058\u3083\u306d\uff1f\u3068\n\u8ab2\u984c\u304cindex.php\u3092\u63d0\u51fa\u3057\u3066\u3001\u305d\u308c\u306b\u30d6\u30e9\u30a6\u30b6\u3067\u30a2\u30af\u30bb\u30b9\u3059\u308b\u3053\u3068\u3067passwd\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u6210\u3067\u304d\u308b\u3088\u3046\u306b\u3059\u308b\u3053\u3068\u3067\u3057\u305f\u3002\n\u3067\u3001\u666e\u901a\u306bform\u3064\u304b\u3046\u3068\u3001\u753b\u9762\u304c\u66f4\u65b0\u3055\u308c\u308b\u308f\u3051\u3067\u3057\u3066\u3001\u305d\u3046\u3057\u305f\u3089\u3001php\u30d5\u30a1\u30a4\u30eb\u306e\u51e6\u7406\u304c\u982d\u304b\u3089\u518d\u958b\u3055\u305b\u308b\u308f\u3051\u3067\u3001\u91cd\u8907\u304c\u8907\u6570\u4eba\u3042\u3063\u305f\u308a\u3059\u308b\u3068\u3069\u3046\u306a\u308b\uff1f\u3068\u304b\u3044\u308d\u3044\u308d\u8003\u3048\u3066\u3001\u60a9\u3093\u3067\u3001WUG\u4ee5\u5916\u8003\u3048\u3089\u308c\u306a\u3044\u982d\u306b\u306a\u3063\u3066\u3057\u307e\u3063\u3066\u30ab\u30ab\u30ef\u30c3\u30d7\u6c0f\u306b\u8cea\u554f\u3055\u305b\u3066\u3082\u3089\u3063\u305f\u308f\u3051\u3067\u3001\u305d\u308c\u3067\u5f97\u305f\u306e\u304cAjax\u306a\u308f\u3051\u3067\u3059\u3002\n\u672c\u5f53\u306b\u30ab\u30ab\u30ef\u30c3\u30d7\u6c0f\u306e\u304a\u304b\u3052\u3067\u8ab2\u984c\u304c\u51fa\u6765\u305f\u3088\u3046\u306a\u3082\u3093\u306a\u3093\u3067\u672c\u5f53\u306b\u611f\u8b1d\u611f\u8b1d\u3067\u3059\u3002\n\u30ab\u30ab\u30ef\u30c3\u30d7\u6c0f\u306b\u306f\u611f\u8b1d\u306e\u5370\u3068\u3057\u3066\u3001\u3053\u306e\u5c71\u4e0b\u4e03\u6d77\u306e\u58f0\u512a\u3086\u3081\u65e5\u8a18\u30d7\u30ec\u30bc\u30f3\u30c8\u3057\u307e\u305b\u3093\u3002\n\u3068\u3044\u3046\u308f\u3051\u3067\u6700\u7d42\u7684\u306b\u4ed5\u69d8\u306a\u3093\u3067\u3059\u304c\u3001php\u30d5\u30a1\u30a4\u30eb\u3092\u4e8c\u3064\u306b\u5206\u3051\u307e\u3057\u305f\u3002\n1\u3064\u76ee\u3067\u6700\u521d\u306e\u51e6\u7406\u3092\u3057\u3066\u30012\u3064\u76ee\u3067\u5b8c\u6210\u3055\u305b\u308b\u611f\u3058\u3067\u3059\u3002\n\u30d6\u30e9\u30a6\u30b6\u304b\u3089csv\u30d5\u30a1\u30a4\u30eb\u306e\u30d1\u30b9\u3092\u53d7\u3051\u53d6\u3063\u3066\u3001\u305d\u308c\u3092\u8aad\u307f\u8fbc\u307fpasswd\u30d5\u30a1\u30a4\u30eb\u306e\u30c6\u30f3\u30d7\u30ec\u3092\u4f5c\u6210\u3002\u91cd\u8907\u3057\u305f\u3068\u3053\u308d\u306f__collision__\u3092\u982d\u306b\u3064\u3051\u3066\u3001\u30e6\u30fc\u30b6\u30fc\u540d\u3068\u3001\u5b66\u7c4d\u756a\u53f7\u3001GID\u3092\u30d6\u30e9\u30a6\u30b6\u306b\u8fd4\u9001\u3002\u30d6\u30e9\u30a6\u30b6\u3067\u30e6\u30fc\u30b6\u30fc\u306b\u5165\u529b\u3057\u3066\u3082\u3089\u3063\u30662\u3064\u76ee\u306ephp\u30d5\u30a1\u30a4\u30eb\u306b\u9001\u4fe1\u3002\u53d7\u3051\u53d6\u3063\u305f\u3082\u306e\u3092\u5143\u306b\u3001\u6700\u7d42\u7684\u306apasswd\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u308b\u3002\u3053\u3053\u3067\u518d\u3073\u91cd\u8907\u304c\u8d77\u304d\u308b\u3068\u3001\u30b5\u30a4\u30c9\u30d6\u30e9\u30a6\u30b6\u306b\u9001\u4fe1\u3057\u3066\u30012\u3064\u76ee\u306ephp\u306e\u307b\u3046\u3067\u30b5\u30a4\u30c9\u51e6\u7406\u3059\u308b\u3002\u7d50\u69cb\u30ac\u30d0\u30ac\u30d0\u306a\u5b9f\u88c5\u3060\u3063\u305f\u308a\u3057\u307e\u3059\u304c\u3001\u305d\u3053\u306f\u307e\u3041\u306d\uff57\uff57\uff57\uff57\n\nindex.php\n<!DOCTYPE html>\n<html>\n    <head>\n        <meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\"> \n        <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    </head>\n    <body>\n        <div>\n            <!-- Main -->\n            <p>input CSV file name( student-list.txt )</p>\n            <input id=\"fileName\" type=\"text\" class=\"form-control input-lg\" /><!--\u5165\u529b\u30b9\u30da\u30fc\u30b9-->\n            <span class=\"input-group-btn\">\n                <input id=\"submitBtn\" class=\"btn btn-submit\" value=\"Submit\" type=\"submit\" /><!--\u30dc\u30bf\u30f3-->\n            </span>\n            <p id =\"message\"></p><!--\u30e1\u30c3\u30bb\u30fc\u30b8\u8868\u793a\u7528-->\n            <!-- Script --><!--\u3053\u3063\u304b\u3089\u30b9\u30af\u30ea\u30d7\u30c8\uff1aJS-->\n            <script src=\"http://code.jquery.com/jquery-2.1.1.min.js\"></script><!--jQuery\u306e\u30ed\u30fc\u30c9-->\n            <script>\n               var responseData = [];\n                $(\"#submitBtn\").click(function() {//\u30dc\u30bf\u30f3\u304c\u62bc\u3055\u308c\u305f\u3068\u304d\u306e\u51e6\u7406\n                 data = { \"fileName\": $(\"#fileName\").val() };//\u30d5\u30a1\u30a4\u30eb\u540d\u3092JSON\u3067\u9001\u4fe1\n                 post(data,\"php1.php\");//post\u30e1\u30bd\u30c3\u30c9\u306e\u547c\u3073\u51fa\u3057\uff5e\n                 return false;\n               });\n               function post(data,url){//\u30dd\u30b9\u30c8\u30ea\u30af\u30a8\u30b9\u30c8\u306e\u95a2\u6570\n                 $.ajax({\n                   type: \"post\",\n                   url: url,\n                   data: JSON.stringify(data),//\u3067\u30fc\u305f\u3092\u30b8\u30a7\u30a4\u30bd\u30f3\u306b\u5909\u63db\n                   contentType: 'application/JSON',//\u305d\u306e\u4ed6\u30aa\u30d7\u30b7\u30e7\u30f3\n                   dataType : 'JSON',\n                   scriptCharset: 'utf-8',\n                   success: function(response) {//\u6210\u529f\u3057\u305f\u3068\u304d\u306b\u547c\u3070\u308c\u308b\n                        responseData=[];\n                        if(check(JSON.stringify(response))){//json\u306e\u4e2d\u8eab\u3061\u3047\u3063\u304f\n                            ask(JSON.stringify(response));//\u5165\u3063\u3066\u305f\u3089\u305d\u308c\u306b\u3057\u305f\u304c\u3063\u3066\u30e6\u30fc\u30b6\u30fc\u30cd\u30fc\u30e0\u3092\u3082\u3089\u3046\u3002\n                            response=null;\n                        }else{//\u7a7a\u306a\u3089\u6210\u529f\u3063\u3066\u4e8b\u3002\n                            $(\"#message\").html(\"<p>passwd file successfly genelated</p>\");\n                        }\n                    },\n                   error: function(xhr,textStatus,err) {//\u5931\u6557\u3057\u305f\u3089\u547c\u3070\u308c\u308bjson\u4ee5\u5916\u306e\u30a8\u30e9\u30fc\u3082\u6709\u308b\u3088\u3002\n                        alert(\"error\u305f\u3076\u3093JSON\");//\u30a8\u30e9\u30fc\u30e1\u30c3\u30bb\u30fc\u30b8\u2193\n                        $(\"#message\").append(\"<br>readyState: \" + xhr.responseText);\n                        $(\"#message\").append(\"<br>readyState: \" + xhr.readyState);\n                        $(\"#message\").append(\"<br>responseText: \"+ xhr.responseText);\n                        $(\"#message\").append(\"<br>status: \" + xhr.status);\n                        $(\"#message\").append(\"<br>text status: \" + textStatus);\n                        $(\"#message\").append(\"<br>error: \" + err);\n                   }                                                                                                         \n                 });                                                                                                         \n               }\n               function check(res){//json\u304c\u7a7a\u306a\u3089\u91cd\u8907\u304c\u306a\u3044\u3068\u5224\u5b9a\n                   var data = JSON.parse(res);//json\u3092\u30d1\u30fc\u30b9\n                   var array = Array.prototype.slice.call(data);//\u914d\u5217\u306b\u5909\u63db\uff1a\u3053\u308c\u30ca\u30a4\u30c8\u3082\u3063\u3068\u9762\u5012\u306b\u306a\u308b\u3002\n                   if(array.length>0){\n                       return true;\n                   }\n                   return false;\n               }                   \n               function ask(res){\n                   var data = JSON.parse(res);\n                   var array = Array.prototype.slice.call(data);\n                   for(var i =0;i<array.length;i++){\n                       askPrompt(array[i]);//\u30d7\u30ed\u30f3\u30d7\u30c8\u3092\u51fa\u3057\u3066\u30e6\u30fc\u30b6\u30fc\u540d\u3092\u3082\u3089\u3046\n                   }\n                   post(responseData,\"php2.php\");//JSON\u3092\u7a4d\u3093\u3060\u914d\u5217\u3092\u9001\u4fe1\n               }\n               function askPrompt(data){//\u30d7\u30ed\u30f3\u30d7\u30c8\u306e\u30e9\u30c3\u30d1\u30fc\u95a2\u6570\n                   _name = data.name;\n                   id = data.id;\n                   example1 = data.ex1;\n                   example2 = data.ex2;\n                    while(true){//null\u3068\u304b\u7a7a\u6587\u5b57\u3092\u3051\u308b\u30028\u6587\u5b57\u5236\u9650\u3082\u3053\u3053\u3067\u3084\u308b\u3002\n                        var name=prompt('\u6b8b\u5ff5\u30e6\u30fc\u30b6\u30fc\u540d('+_name+':'+id+')\u304c\u91cd\u8907\u3057\u307e\u3057\u305f\u3002\u5225\u306e\u3082\u306e\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044\u3002\u203b8\u6587\u5b57\u4ee5\u4e0b(\u4f8b:'+ ((example2==\"null\")?example1 : example1+\",\"+example2 ) +' etc...)', ((example2==\"null\")?example1 : example2));\n                        if(name!==null && name!=='' && name.length <9){\n                            break;\n                        }else{\n                            alert(\"input error\");\n                        }\n                    }\n                    responseData.push({name:_name,newName:name,id:id});//Json\u5f62\u5f0f\u914d\u5217\u306b\u3064\u3093\u3069\u304f\n            }\n            </script>\n        </div>\n    </body>\n</html>\n\n\n\u5b9f\u969b\u3053\u308c\u63d0\u51fa\u306fphp\u30d5\u30a1\u30a4\u30eb\u306a\u3093\u3059\u3051\u3069\u306d\uff57\uff57\uff57\nJson\u30c7\u30b3\u30fc\u30c9\u3057\u305f\u306eJS\u3067\u306f\u914d\u5217\u3058\u3083\u306a\u304f\u3066Object\u306e\u584a\u307f\u305f\u3044\u306a\u6271\u3044\u53d7\u3051\u3066\u3001\u305c\u3093\u305c\u3093\u4f7f\u3044\u52dd\u624b\u60aa\u3044\u3093\u3059\u308f\u3002\u3060\u30f5\u3089\u3001Array.prototype.slice.call\u3064\u304b\u3063\u3066\u914d\u5217\u306b\u3002\u3044\u308d\u3044\u308d\u3084\u308a\u65b9\u6709\u308b\u306e\u304b\u306a\uff1f\u3063\u3066\u611f\u3058\u3067\u3059\u3002\u6c17\u306b\u306a\u308b\u306a\u3089gg\u3063\u3066\u304f\u3060\u3055\u3044\u3002web\u521d\u5fc3\u8005\u306e\u81ea\u5206\u306b\u306f\u4eca\u5f97\u305f\u77e5\u8b58\u3067\u5341\u5206\u3067\u3059\u3002\u3061\u306a\u307f\u306b\u3053\u308c\u914d\u5217\u306b\u51fa\u6765\u306a\u304b\u3063\u305f\u3089\u3001JS\u3060\u304b\u3089\u5e73\u6c17\u3067undefined\u3068\u304b\u306a\u3063\u3066\u307e\u3059\u3002JS\u6016\u3059\u304e\u3002\n\u3068\u3001Ajax\u306eerror\u6642\u306e\u95a2\u6570\u3001\u3053\u308c\u30ea\u30af\u30a8\u30b9\u304c\u6210\u529f\u3057\u305f\u304b\u3069\u3046\u304b\u3060\u3051\u3058\u3083\u306a\u3044\u3093\u3067\u3059\u306d\u3002\n\u3088\u3046\u3059\u308b\u306b\u3001error\u95a2\u6570\u304c\u547c\u3070\u308c\u3066\u3001xhr.status\u304c200\u306a\u3093\u3066\u826f\u304f\u6709\u308b\u3093\u3067\u3059\u306d\u3002\u6210\u529f\u3060\u3051\u3069\u5931\u6557\u30c4\u30f3\u30c7\u30ec\u3055\u3093\u304b\u306a\uff1f\uff1f\u3068\u601d\u3063\u305f\u3093\u3067\u3059\u3051\u3069\u3001\u3053\u308c\u30ea\u30af\u30a8\u30b9\u30c8\u6210\u529f\u3057\u305f\u305c\u3063\u3066\u8a71\u3067\u3001\u5b9f\u969bJSON\u306e\u69cb\u6587\u304a\u304b\u3057\u304b\u3063\u305f\u308a\u3059\u308b\u3068\u3001parseError\u3068\u304b\u304c\u3067\u3066\u3001\u901a\u4fe1\u306f\u6210\u529f\u3060\u3051\u3069\u3082\u3089\u3063\u305f\u306e\u306f\u4f55\u304b\u5909\u3060\u305c\u3068\u304b\u3082\u3001error\u306a\u3093\u3067\u3059\u306d\u3002\n\u3042\u304a\u3068\u306f\u3001\u81ea\u5206\u304c\u73cd\u3057\u304f2\u9805\u6f14\u7b97\u5b50\uff08\uff1f\u6f14\u7b97\u5b50\uff09\u4f7f\u3063\u3066\u308b\u3002\n\u308f\u3093\u3089\u3044\u306a\u30fc\u3068\u304b\u3044\u3046\u3084\u3064\u3067\u3059\u304b\uff1f\u77e5\u308a\u307e\u305b\u3093\u3002\u5225\u306b\u7af6\u6280\u30d7\u30ed\u30b0\u30e9\u30de\u3058\u3083\u306a\u3044\u3093\u3067\u3002\n\u3042\u3001\u3082\u3046WUG\u8981\u7d20\u306a\u3044\u3063\u3059\u3088\u3002\u305f\u3076\u3093\u3002\n\nphp1.php\n<?php\n/*\n *\u3046\u308b\u305b\u3048\u30d5\u30a1\u30a4\u30eb\u540d\u9069\u5f53\u3068\u304b\u8a00\u3046\u306a\u3002\n *\u3046\u308b\u305b\u3048\u5909\u6570\u540d\u610f\u5473\u4e0d\u660e\u3068\u304b\u8a00\u3046\u306a\u4ffa\u3082\u308f\u304b\u3089\u3093\u306e\u3058\u3083\uff57\uff57\uff57\uff57\uff57\n */\n\n\n\n//ajax\u4ee5\u5916\u306e\u63a5\u7d9a\u3092\u62d2\u5426\n$request = isset($_SERVER['HTTP_X_REQUESTED_WITH']) ? strtolower($_SERVER['HTTP_X_REQUESTED_WITH']) : '';\nif($request !== 'xmlhttprequest'){\n    echo \"error\";\n    exit;\n}\n\n$jsonString = file_get_contents('php://input');//json\u3092\u53d6\u5f97\n$json = json_decode($jsonString,true);//json\u3092\u30c7\u30b3\u30fc\u30c9\u3001\u914d\u5217\u306b\u3076\u3063\u3053\u3080\n$fileName  = $json[\"fileName\"];//json\u304b\u3089\u30d5\u30a1\u30a4\u30eb\u540d\u3092\u53d6\u5f97\nif(file_exists(\"./etc\")===False){//etc\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u304c\u6709\u308b\u304b\u30c1\u30a7\u30c3\u30af\n    if(mkdir(\"./etc\",0666)===False){//\u4f5c\u308b\u7121\u7406\u3060\u3063\u305f\u3089\u30b2\u30fc\u30e0\u30aa\u30fc\u30d0\u30fc\n        echo \"<p>directiry error</p>\";\n        exit;\n    }\n}\nif(($passFile =  fopen(\"./etc/.passwdtmp\", \"w\"))===False){//\u30d1\u30b9\u30d5\u30a1\u30a4\u30eb\u306e\u30c6\u30f3\u30d7\u308c\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u6210\n    echo \"<p>passwd file open error...</p>\";\n    exit;\n}\nif($fileName===null || $fileName === False || ($file=fopen($fileName, \"r\"))===False){//\u30d5\u30a1\u30a4\u30eb\u30aa\u30fc\u30d7\u30f3\n    echo \"file open error\";\n    exit;\n}else{\n    $content;\n    $collision=array();//\u885d\u7a81\u7528\u306eSON\u306e\u914d\u5217\n    $collisionIndex=0;//\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\n    while($content = fgets($file)){//CSV\u306e\u8aad\u307f\u8fbc\u307f\n        $strAry = explode(\",\", $content); //0:ID 1:\u540d\u524d 2:name\n        for($i = 0;$i<sizeof($strAry);$i++){\n            $strAry[$i] = preg_replace(\"/\\\"/\", \"\", $strAry[$i]);//\u201d\u3092\u524a\u9664             \n        }\n        $strAry[2] = preg_replace(\"/\\n/\", \"\", \"$strAry[2]\");//name\u306e\u6539\u884c\u524a\u9664\n        $strAry[2] = preg_replace(\"/[\\s]+/\", \" \", \"$strAry[2]\");//name\u306e\u7a7a\u767d\u9023\u7d9a\u3092\u524a\u9664\n        $strAry[2] = replaceRomaji(mb_strtolower($strAry[2]));//\u5c0f\u6587\u5b57\u306b\u5909\u63db\n        $tmpAry = explode(\" \",$strAry[2]);//\u540d\u524d\u3092\u7a7a\u767d\u3067\u533a\u5207\u308b\n        //\u57fa\u672c\u7684\u306b\u5168\u90e8\u95a2\u6570\u306b\u3057\u3066\u307e\u3059\u3002\n        $GID=getGID($strAry[0]);\n        $login_name=getLoginName($tmpAry[0],$tmpAry[1],$GID);//\u30ed\u30b0\u30a4\u30f3\u540d\u751f\u6210\u306e\u305f\u3081\u59d3\u3068\u540d\u3068GID\uff08\u91cd\u8907\u30c1\u30a7\u30c3\u30af\uff09\u3092\u6e21\u3059\n        $UID=getUID($strAry[0]);\n        $GECOS=getGECOS($strAry[2]);\n        $home_dir=\"/home/\".$login_name;\n        $login_shell=\"/bin/sh\";\n        $tmpStr = preg_replace(\"/__collision__/\",\"\",$login_name);//\u4ee5\u4e0b\u91cd\u8907\u6642\u306e\u8a18\u8ff0\u91cd\u8907\u3057\u305f\u3089__collision__\u3092\u3064\u3051\u308b\n        if(preg_match(\"/__collision__/\",$login_name)===1){//json\u3067\u6e21\u3059\u306e\u306f\u540d\u524dUID\u3068\u540d\u524d\u306e\u5019\u88dc\u306e\u4e09\u3064(4\u3064\uff09\n            array_push($collision,array(\"name\"=> $tmpStr,\n                                            \"id\"=>$UID,\n                                            \"ex1\"=>  substr($tmpStr,0,5).\"123\",\n                                            \"ex2\"=>  genelateName($tmpStr)));\n        }\n        //login_name:*:UID:GID::::GECOS:home_dir:login_shell\n        $content = $login_name.\":x:\".$UID.\":\".$GID.\"::::\".$GECOS.\":\".$home_dir.\":\".$login_shell.\"\\n\";//passwd\u3088\u3046\u306e\u6587\u5b57\u5217\n        fputs($passFile, $content, strlen($content));//\u66f8\u304d\u8fbc\u307f\n    }\n    if(sizeof($collision)<1){//\u91cd\u8907\u306a\u3057\u306a\u3089\n        fclose($file);\n        rename($fileName,\"./etc/passwd\");//\u30c6\u30f3\u30d7\u30ec\u3092passwd\u306b\u304b\u3048\u308b\u3002\n        header( 'Content-Type: application/json; charset=utf-8' );\n        echo  json_encode($collision);        \n    }else{//\u91cd\u8907\u3042\u308b\u306a\u3089\u305d\u306e\u307e\u307eGO\uff01\n        ob_clean();\n        header( 'Content-Type: application/json; charset=utf-8' );\n        echo  json_encode($collision);\n    }\n}\nfunction getGECOS($str){\n    //\u95a2\u6570\u4f5c\u3063\u305f\u3051\u3069\u5b9f\u88c5\u3059\u308b\u3082\u3093\u306a\u304b\u3063\u305f\uff5e\uff5e\uff5e\uff57\uff57\uff57\uff57\uff57\uff57\uff57\n    return $str;\n}\nfunction getUID($num){\n    return substr($num, 0,3).substr($num,-3);\n}    \nfunction getGID($num){\n    return substr($num,0,4);\n}\nfunction getLoginName($name,$name2,$num){//\u91cd\u8907\u30c1\u30a7\u30c3\u30af\u8fbc\u307f\u4ed5\u69d8\u5909\u66f4\n    $name = substr($name, 0,8);\n    if(isUsed($name,$num)===True){//\u91cd\u8907\u30c1\u30a7\u30c3\u30af\n        if(strlen($name)<7){//\u59d3_\u540d\u306b\u3057\u3066\u307f\u308b\n            $name = $name.\"_\".substr($name2, 0,(8-strlen($name)-1));\n            if(isUsed($name,$num)===True){//\u305d\u308c\u3067\u3082\u91cd\u8907\u3057\u305f\u3089__collision__\u3092\u4ed8\u52a0\n                $name = \"__collision__\".$name;\n            }\n        }\n    }\n    return $name;\n}\nfunction isUsed($name,$num){//\u4f7f\u7528\u30c1\u30a7\u30c3\u30af\u30d5\u30a1\u30a4\u30eb\u3092\u958b\u3044\u3066\u635c\u67fb\n    if(($file = @fopen(\"./etc/.passwdtmp\", \"r\"))===False){\n        echo \"pass file open error\";\n        exit;\n    }\n    while(False !== ($str = fgets($file))){\n        $tmp = explode(\":\", $str);\n        $str = $tmp[0];\n        $gid = $tmp[3];\n        if($str===$name && $gid === $num){//\u540d\u524d\u3068GID\u91cd\u8907\n            fclose($file);\n            return True;\n        }\n    }\n    fclose($file);\n    return False;\n}\nfunction genelateName($str){//\u30ed\u30fc\u30de\u5b57\u3092\u3054\u306b\u3087\u3054\u306b\u3087\u540d\u524d\u306e\u4f8b\u3092\u751f\u3080\n    $tmp = $str;\n    $replaceAry=array(\n        array(\"hu\",\"fu\"),\n        array(\"si\",\"shi\"),\n        array(\"sya\",\"sha\"),\n        array(\"syu\",\"shu\"),\n        array(\"syo\",\"sho\"),\n        array(\"jya\",\"ja\"),\n        array(\"jyu\",\"ju\"),\n        array(\"jyo\",\"jo\"),\n        array(\"tu\",\"tsu\"),\n        array(\"ti\",\"chi\"),\n        array(\"tya\",\"cha\"),\n        array(\"tyu\",\"chu\"),\n        array(\"tyo\",\"cho\"),\n    );\n    for($i=0;$i<sizeof($replaceAry);$i++){\n        $str = str_replace($replaceAry[$i][1], $replaceAry[$i][0], $str);\n    }\n    if($str==$tmp){\n        return \"null\";\n    }\n    return substr($str,0,8);//8\u6587\u5b57\u5236\u9650        \n}\nfunction replaceRomaji($str){//\u30ed\u30fc\u30de\u5b57\u3092\u3054\u306b\u3087\u3054\u306b\u3087\u6574\u5f62\u3059\u308b\n    //si->shi, sya->sha, syu->shu, syo->sho, jya->ja, jyu->ju, jyo->jo, tu->tsu, ti->chi, tya->cha, tyu->chu, tyo->cho, hu->fu\n    $replaceAry=array(\n        array(\"hu\",\"fu\"),//\u30b4\u30ea\u62bc\u3057\u306a\u3093\u3060\u306a\uff5e\uff5e\uff57\uff57\uff57\uff57\uff57\u3000shu\u304csfu\u306b\u306a\u308b\u306echu\u304ccfu\u306b\u306a\u308b\u306e\u306ffix\u6e08\u307f\n        array(\"si\",\"shi\"),\n        array(\"sya\",\"sha\"),\n        array(\"syu\",\"shu\"),\n        array(\"syo\",\"sho\"),\n        array(\"jya\",\"ja\"),\n        array(\"jyu\",\"ju\"),\n        array(\"jyo\",\"jo\"),\n        array(\"tu\",\"tsu\"),\n        array(\"ti\",\"chi\"),\n        array(\"tya\",\"cha\"),\n        array(\"tyu\",\"chu\"),\n        array(\"tyo\",\"cho\"),\n        array(\"cfu\",\"chu\"),\n        array(\"sfu\",\"shu\")        \n    );\n    for($i=0;$i<sizeof($replaceAry);$i++){\n        $str = str_replace($replaceAry[$i][0], $replaceAry[$i][1], $str);\n    }\n    return $str;\n}\n\n\n\u3044\u3044\u611f\u3058\u306e\u30b0\u30c0\u30b0\u30c0\u30d7\u30ed\u30b0\u30e9\u30e0\u3067\u3059\u306d\u3002\n$jsonString = file_get_contents('php://input');\n\u3053\u308c\u3067json\u304c\u53d7\u3051\u53d6\u308c\u308b\u3093\u3067\u3059\u306d\u3002php://input\u306f\u8aad\u307f\u8fbc\u307f\u5c02\u7528\u306e\u30b9\u30c8\u30ea\u30fc\u30e0\u3067\u3001\u30ea\u30af\u30a8\u30b9\u30c8\u306ebody\u90e8\u304b\u3089\u751f\u306e\u30c7\u30fc\u30bf\u3092\u8aad\u307f\u8fbc\u3080\u3053\u3068\u304c\u3067\u304d\u308b\u3082\u306e\u306a\u3093\u3067\u3059\u306d\u3002\u307e\u3041\u3001\u6700\u521d\u306f\u30d5\u30a1\u30a4\u30eb\u540d\u3057\u304b\u98db\u3093\u3067\u3053\u306a\u3044\u3093\u3067\u3059\u3051\u3069\u3002\n\u3042\u3068\u306f\u3001\u306b\u3087\u306b\u3087\u306b\u3087\u306b\u3087\u306b\u3087\uff5e\u3063\u3066\u611f\u3058\u3067passwd\u30d5\u30a1\u30a4\u30eb\u4f5c\u6210\u3068\u304b\u91cd\u8907\u30c1\u30a7\u30c3\u30af\u3068\u304b\u3057\u3066\u307e\u3059\u3002\n\u8fd4\u3059\u3068\u304d\u306f\u3001\u30d8\u30c3\u30c0\u3064\u3051\u3066\u914d\u5217\u3092json_encode\u3057\u3066echo\u3059\u308b\u3060\u3051\u3002\u601d\u3063\u305f\u4ee5\u4e0a\u306b\u7c21\u5358\u306a\u308f\u3051\u3067\u3059\u3002\n\nphp2.php\n<?php\n//ajax\u4ee5\u5916\u306e\u63a5\u7d9a\u3092\u62d2\u5426\n$request = isset($_SERVER['HTTP_X_REQUESTED_WITH']) ? strtolower($_SERVER['HTTP_X_REQUESTED_WITH']) : '';\nif($request !== 'xmlhttprequest'){\n    echo \"error\";\n    exit;\n}\n$json_string  = file_get_contents(\"php://input\");\necho $json_string;\n$response = json_decode($json_string,true);//json\u306e\u914d\u5217\nif(sizeof($response)<1){\n    echo \"done?\";\n    exit;\n}\n$tmpfile = fopen(\"./etc/.passwdtmp\",\"r\");\n$passfile = fopen(\"./etc/passwd\",\"w\");\nif($passfile===false || $tmpfile===false){\n    echo \"<script>alert('Server Erorr');</script>\";\n    exit;\n}\n$responseIndex=0;\n$flg=true;//\u30d5\u30e9\u30b0\uff1a\u5909\u66f4\u9805\u76ee\u306e\u6709\u308a\u7121\u3057\u3092\u610f\u5473\u3059\u308b\u3002\u30bb\u30b0\u30e1\u30f3\u30c8\u30a8\u30e9\u30fc\u4e88\u9632\n$collision = array();\nwhile(($content=fgets($tmpfile))!==False){\n    //login_name:*:UID:GID::::GECOS:home_dir:login_shell\n    //{name:\u5143\u306e\u540d\u524d,newName:\u65b0\u3057\u3044\u540d\u524d,id:id});\n    $inputBuffer = \"\";\n    $array = explode(\":\", $content);\n    if($flg == true &&\n       $array[0]===(\"__collision__\".$response[$responseIndex][\"name\"]) &&\n       $array[2]===$response[$responseIndex][\"id\"]){//\u885d\u7a81\u3057\u305f\u306e\u3068\u30c1\u30a7\u30c3\u30af\u5165\u308c\u66ff\u3048\n        if(isUsed($response[$responseIndex][\"newName\"],$array[3])){//\u65b0\u3057\u3044\u306e\u304c\u91cd\u8907\u3057\u3066\u305f\u3089\u7a81\u3063\u3071\u306d\u308b\n            array_push($collision , array(\"name\" => $response[$responseIndex][\"name\"],\n                                          \"id\" =>$response[$responseIndex][\"id\"],\n                                          \"ex1\"=> substr($response[$responseIndex][\"name\"],0,5).\"123\",\n                                          \"ex2\"=> genelateName($response[$responseIndex][\"name\"])));\n            $inputBuffer = $content;\n            $responseIndex++;\n            if($responseIndex>=sizeof($response)){\n                $flg =false;\n            }\n        } else {\n            $array[0]=$response[$responseIndex][\"newName\"];\n            $str = \"__collision__\".$response[$responseIndex][\"name\"];\n            $array[sizeof($array)-2] = preg_replace(\"/$str/\",\n                                                    $response[$responseIndex][\"newName\"],\n                                                    $array[sizeof($array)-2]);\n            for($i = 0; $i < sizeof($array)-1;$i++){\n                $inputBuffer = $inputBuffer.$array[$i].\":\";\n            }\n            $inputBuffer = $inputBuffer.$array[sizeof($array)-1];\n            $responseIndex++;\n            if($responseIndex>=sizeof($response)){\n                $flg =false;\n            }\n        }\n    }else{\n        $inputBuffer = $content;\n    }\n    fputs($passfile, $inputBuffer, strlen($inputBuffer));//\u66f8\u304d\u8fbc\u307f\n}\n    fclose($tmpfile);\n    fclose($passfile);\nif(sizeof($collision)>0){\n    if(unlink(\"./etc/.passwdtmp\")===false){//\u3066\u3093\u3077\u3089\u30d5\u30a1\u30a4\u30eb\u524a\u9664\n        echo \"server error...\";\n        exit;\n    }else{\n        if(rename(\"./etc/passwd\",\"./etc/.passwdtmp\")===false){//\u4fee\u6b63\u7248\u3092\u3066\u3093\u3077\u3089\u306b\n            echo \"server error...\";\n            exit;\n        }\n    }\n    ob_clean();\n    header( 'Content-Type: application/json; charset=utf-8' );\n    echo  json_encode($collision);\n}else{\n    if(unlink(\"./etc/.passwdtmp\")===false){//\u3066\u3093\u3077\u3089\u30d5\u30a1\u30a4\u30eb\u524a\u9664\n        echo \"server error...\";\n        exit;\n    }\n    ob_clean();\n    header( 'Content-Type: application/json; charset=utf-8' );\n    echo  json_encode($collision);\n}\n\nfunction isUsed($name,$num){\n    if(($file = @fopen(\"./etc/passwd\", \"r\"))===False){\n        echo \"pass file open error\";\n        exit;\n    }\n    while(False !== ($str = fgets($file))){\n        $tmp = explode(\":\", $str);\n        $str = $tmp[0];\n        $gid = $tmp[3];\n        if($str===$name && $gid === $num){\n            fclose($file);\n            return True;\n        }\n    }\n    fclose($file);\n    return False;\n}\nfunction genelateName($str){\n    $tmp = $str;\n    $replaceAry=array(\n        array(\"hu\",\"fu\"),\n        array(\"si\",\"shi\"),\n        array(\"sya\",\"sha\"),\n        array(\"syu\",\"shu\"),\n        array(\"syo\",\"sho\"),\n        array(\"jya\",\"ja\"),\n        array(\"jyu\",\"ju\"),\n        array(\"jyo\",\"jo\"),\n        array(\"tu\",\"tsu\"),\n        array(\"ti\",\"chi\"),\n        array(\"tya\",\"cha\"),\n        array(\"tyu\",\"chu\"),\n        array(\"tyo\",\"cho\"),\n    );\n    for($i=0;$i<sizeof($replaceAry);$i++){\n        $str = str_replace($replaceAry[$i][1], $replaceAry[$i][0], $str);\n    }\n    if($str==$tmp){\n        return null;\n    }\n    return substr($str,0,8);//8\u6587\u5b57\u5236\u9650        \n}\n\n\n\u307b\u3068\u3093\u3069\u4e00\u7dd2\u306a\u3093\u3059\u3088\u306d\u3002\n\u7279\u306b\u96e3\u3057\u3044\u3053\u3068\u3084\u3063\u3066\u306a\u3044\u3057\u3001\u8aad\u3081\u3070\u308f\u304b\u308b\u3057\u3001\u8aad\u307e\u306a\u304f\u3066\u3082\u3044\u3044\u3067\u3059\uff57\uff57\n\u30d5\u30a1\u30a4\u30eb\u66f4\u65b0\u3057\u3066\u307e\u3059\u306d\u3002\u3061\u306a\u307f\u306b\u3001Json\u9001\u308b\u524d\u306b\u3001\u30b9\u30c8\u30ea\u30fc\u30e0\u3092\u304a\u6383\u9664\u3057\u306a\u3044\u3068\u5909\u306a\u306e\u4e00\u7dd2\u306b\u9001\u3063\u3066\u3001JS\u5074\u3067\u610f\u5473\u4e0d\u660e\u306a\u30a8\u30e9\u30fc\u306b\u8972\u308f\u308c\u3066\u5410\u304d\u305d\u3046\u306b\u306a\u308b\u306e\u3067\u6c17\u3092\u3064\u3051\u307e\u3057\u3087\u3046\u3002\nob_clean();\u3053\u308c\u3060\u3051\u306f\u3068\u308a\u3042\u3048\u305a\u66f8\u3044\u3068\u304d\u307e\u3057\u3087\u3046\u3002\n\u4ee5\u4e0a\u3067\u3059\u304b\u306d\uff1f\uff1f\u8ab2\u984c\u3082\u7d42\u308f\u3063\u3066\u590f\u4f11\u307f\u3067\u3059\uff01\uff01\uff01\n\u3068\u308a\u3042\u3048\u305a\u3001\u308f\u3050\u3070\u3093\uff01\u3084\u3070\u3044\u3093\u3067\u898b\u3066\u304f\u3060\u3055\u3044\u306d\uff01\uff01\uff01\n\u3053\u306e\u52d5\u753b\u306e\u304a\u304b\u3052\u3067\u304c\u3093\u3070\u308c\u307e\u3057\u305f\u3002\u6700\u5f8c\u307e\u3067\u7686\u3055\u3093\u3042\u308a\u304c\u3068\u3046\u3054\u3056\u3044\u307e\u3059\u3002\n\u6b21\u56de\u306f\n\u5927\u5b66\u8ab2\u984c\uff08\u8d85\u304c\u3093\u3070\u3063\u30661\u65e5\u3067\u5b8c\u6210\u3055\u305b\u305f\uff09Java\u00d7\u81ea\u7136\u8a00\u8a9e\u51e6\u7406\u00d7DocomoAPI\u306e\u8a71\nor\nIoT\u3067\u904a\u3093\u3067\u307f\u305f\n\u306e\u3069\u3063\u3061\u304b\u3067\u3059\u306d\u3002\n\u30d7WUG\u30e9\u30de\u30fc\u3068\u3057\u3066\u3053\u308c\u304b\u3089\u3082\u304c\u3093\u3070\u3063\u307a\uff01\uff01\n\u305d\u308c\u3067WUG\uff5e  \n\u5927\u5b66\u306ePHP\u8ab2\u984c\u304c\u306a\u305e\u3060\u3063\u305f\u306e\u3067\u305d\u306e\u611a\u75f4\u3068\u63d0\u51fa\u8ab2\u984c\u3092\u3042\u308c\u3084\u3053\u308c\u3084\u3068...\n[\u30ab\u30ab\u30ef\u30c3\u30d7\u6c0f](http://kakawup.github.io/)\u306b\u5354\u529b\u3044\u305f\u3060\u3044\u305f\u306e\u3067\u3001\u305d\u306e\u5831\u544a\u3082\u304b\u306d\u3066\u3002\n\n\u307e\u305a\u554f\u984c\u8a2d\u5b9a\u304b\u3089\u898b\u3066\u3044\u304d\u307e\u3057\u3087\u3046\u3002\nCSV\u5f62\u5f0f\u3067\u4fdd\u5b58\u3055\u308c\u305f\u540d\u7c3f\u304b\u3089\uff0c/etc/passwd \u5f62\u5f0f\u306e\u30d5\u30a1\u30a4\u30eb\u3092\u751f\u6210\u3059\u308b\uff0e\n\u3053\u308c\u304c\u8ab2\u984c\u306e\u76ee\u7684\u3002\nCSV\u30d5\u30a1\u30a4\u30eb\u306e\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u306f\u3010\"\u5b66\u751f\u756a\u53f7\",\"\u6c0f\u540d\"\uff0c\"name\"\u3011\npasswd\u30d5\u30a1\u30a4\u30eb\u306f\u3010login_name:*:UID:GID::::GECOS:home_dir:login_shell\u3011\n\u305f\u3068\u3048\u3070\n`\"25115773\",\"\u5c71\u4e0b\u3000\u4e03\u6d77\",\"Yamasita Nanami\"`\n\u306b\u5bfe\u3057\u3066\u3001\n`yamasita\\:X\\:251773:2511::::yamasita nanami:/home/yamasita:/bin/sh\n`\n\u3068\u3044\u3046\u306e\u3092\u4f5c\u6210\u3059\u308b\u3002\u304c\u3044\u304f\u3064\u304b\u5236\u7d04\u304c\u3002\n\n```\nlogin_name\u306b\u95a2\u3057\u3066\n\u30fb\u3059\u3079\u3066\u5c0f\u6587\u5b57\uff0c\u6587\u5b57\u306f\u300c\u30a2\u30eb\u30d5\u30a1\u30d9\u30c3\u30c8\uff0c\u6570\u5b57\uff0c_\uff0c-\uff0c.\u300d\u306e\u307f\u4f7f\u7528\u53ef\u80fd\u3067\uff0c\u5148\u982d\u306f\u30a2\u30eb\u30d5\u30a1\u30d9\u30c3\u30c8\u3067\u3042\u308b\u3053\u3068\u3002\n\u30fb\u91cd\u8907\u304c\u306a\u3044\u3053\u3068\n\u30fb\u6700\u59278\u6587\u5b57\u307e\u3067\n\u30fb\u91cd\u8907\u3057\u306a\u3044\u9650\u308a\uff0c\u59d3\u3000\u306e\u30ed\u30fc\u30de\u5b57\u8868\u8a18\u3092\u57fa\u672c\u3068\u3059\u308b\u3053\u3068\uff0e\n\u30fb\u30ed\u30fc\u30de\u5b57\u8868\u8a18\u3092\u7d71\u4e00\u3059\u308b\u3053\u3068\nsi->shi, sya->sha, syu->shu, syo->sho, jya->ja, jyu->ju, jyo->jo, tu->tsu, ti->chi, tya->cha, tyu->chu, tyo->cho, hu->fu\n```\n\n\u3053\u3053\u3067\u7591\u554f\u3002\u30e6\u30fc\u30b6\u30fc\u540d\u3063\u3066\u30b7\u30b9\u30c6\u30e0\u5074\u3067\u52dd\u624b\u306b\u5909\u3048\u3066\u3044\u3044\u306e\uff1f\uff1f\n\u3082\u3061\u308d\u3093\u8ab2\u984c\u3060\u304b\u3089\u898f\u5247\u306b\u5f93\u3063\u305f\u540d\u524d\u306b\u306f\u3057\u307e\u3059\u3002\u305d\u308c\u3067\u3082\u30b7\u30b9\u30c6\u30e0\u5074\u304b\u3089\u63d0\u793a\u3055\u308c\u305f\u5019\u88dc\u3057\u304b\u5229\u7528\u3067\u304d\u306a\u3044\u306e\u306f\u304a\u304b\u3057\u3044\u3002\uff08\u8ab2\u984c\u3067\u306f\u30ed\u30fc\u30de\u5b57\u5909\u63db\u3088\u3046\u3059\u308b\u306b\u3001\u4e0a\u306e\u9006\u3092\u7528\u3044\u3066\u5019\u88dc\u3092\u63d0\u793a\u3059\u308b\u3088\u3046\u306a\u3082\u306e\u3082\u3042\u308a\u307e\u3057\u305f\uff09\n\u3068\u3044\u3046\u308f\u3051\u3067\uff01\uff01\u30d6\u30e9\u30a6\u30b6\u3092\u901a\u3057\u3066\u30e6\u30fc\u30b6\u30fc\u306b\u540d\u524d\u3092\u3082\u3089\u304a\u3046\u3058\u3083\u306a\u3044\u304b\u3068\u3002\n\u8981\u3059\u308b\u306b\n\n```\n\"25115774\",\"\u5965\u91ce\u3000\u9999\u8036\",\"Okuno Kaya\"\n\"25115775\",\"\u5965\u91ce\u3000\u9999\u8036\",\"Okuno Kaya\"\n\"25115776\",\"\u5965\u91ce\u3000\u9999\u8036\",\"Okuno Kaya\"\n```\n\n\u306b\u5bfe\u3057\u3066\u3001\n\n```\nokuno\\:X\\:251773:2511::::okuno kaya:/home/okuno:/bin/sh <-\u666e\u901a\u306b\nokuno_ka\\:X\\:251773:2511::::okuno kaya:/home/okuno:/bin/sh <-\u91cd\u8907\u3059\u308b\u304b\u30898\u6587\u5b57\u4ee5\u4e0b\u3067\u59d3_\u540d\u306b\u3057\u305f\nokuno???\\:X\\:251773:2511::::okuno kaya:/home/okuno???:/bin/sh <-\u3053\u308c\u3069\u3046\u3059\u308b\uff1f\n```\n\n\u3053\u308c\u3092\u30d6\u30e9\u30a6\u30b6\u5074\u3067\u30e6\u30fc\u30b6\u30fc\u306b\u805e\u3053\u3046\u3068\u3044\u3046\u308f\u3051\u3067\u3059\u3002\n\u3069\u3046\u3084\u3063\u3066\uff1f\uff1f\u3068\u308a\u3042\u3048\u305aform\u3067post\u3067\u3082\u3057\u3066\u308a\u3083\u3044\u3044\u3093\u3058\u3083\u306d\uff1f\u3068\n\u8ab2\u984c\u304cindex.php\u3092\u63d0\u51fa\u3057\u3066\u3001\u305d\u308c\u306b\u30d6\u30e9\u30a6\u30b6\u3067\u30a2\u30af\u30bb\u30b9\u3059\u308b\u3053\u3068\u3067passwd\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u6210\u3067\u304d\u308b\u3088\u3046\u306b\u3059\u308b\u3053\u3068\u3067\u3057\u305f\u3002\n\u3067\u3001\u666e\u901a\u306bform\u3064\u304b\u3046\u3068\u3001\u753b\u9762\u304c\u66f4\u65b0\u3055\u308c\u308b\u308f\u3051\u3067\u3057\u3066\u3001\u305d\u3046\u3057\u305f\u3089\u3001php\u30d5\u30a1\u30a4\u30eb\u306e\u51e6\u7406\u304c\u982d\u304b\u3089\u518d\u958b\u3055\u305b\u308b\u308f\u3051\u3067\u3001\u91cd\u8907\u304c\u8907\u6570\u4eba\u3042\u3063\u305f\u308a\u3059\u308b\u3068\u3069\u3046\u306a\u308b\uff1f\u3068\u304b\u3044\u308d\u3044\u308d\u8003\u3048\u3066\u3001\u60a9\u3093\u3067\u3001[WUG](http://wug-portal.jp/)\u4ee5\u5916\u8003\u3048\u3089\u308c\u306a\u3044\u982d\u306b\u306a\u3063\u3066\u3057\u307e\u3063\u3066\u30ab\u30ab\u30ef\u30c3\u30d7\u6c0f\u306b\u8cea\u554f\u3055\u305b\u3066\u3082\u3089\u3063\u305f\u308f\u3051\u3067\u3001\u305d\u308c\u3067\u5f97\u305f\u306e\u304cAjax\u306a\u308f\u3051\u3067\u3059\u3002\n\u672c\u5f53\u306b\u30ab\u30ab\u30ef\u30c3\u30d7\u6c0f\u306e\u304a\u304b\u3052\u3067\u8ab2\u984c\u304c\u51fa\u6765\u305f\u3088\u3046\u306a\u3082\u3093\u306a\u3093\u3067\u672c\u5f53\u306b\u611f\u8b1d\u611f\u8b1d\u3067\u3059\u3002\n\u30ab\u30ab\u30ef\u30c3\u30d7\u6c0f\u306b\u306f\u611f\u8b1d\u306e\u5370\u3068\u3057\u3066\u3001\u3053\u306e[\u5c71\u4e0b\u4e03\u6d77\u306e\u58f0\u512a\u3086\u3081\u65e5\u8a18](https://shop.gakken.co.jp/shop/order/k_ok/goodsdisp.asp?code=3200002588)\u30d7\u30ec\u30bc\u30f3\u30c8\u3057\u307e\u305b\u3093\u3002\n\n\u3068\u3044\u3046\u308f\u3051\u3067\u6700\u7d42\u7684\u306b\u4ed5\u69d8\u306a\u3093\u3067\u3059\u304c\u3001php\u30d5\u30a1\u30a4\u30eb\u3092\u4e8c\u3064\u306b\u5206\u3051\u307e\u3057\u305f\u3002\n1\u3064\u76ee\u3067\u6700\u521d\u306e\u51e6\u7406\u3092\u3057\u3066\u30012\u3064\u76ee\u3067\u5b8c\u6210\u3055\u305b\u308b\u611f\u3058\u3067\u3059\u3002\n\u30d6\u30e9\u30a6\u30b6\u304b\u3089csv\u30d5\u30a1\u30a4\u30eb\u306e\u30d1\u30b9\u3092\u53d7\u3051\u53d6\u3063\u3066\u3001\u305d\u308c\u3092\u8aad\u307f\u8fbc\u307fpasswd\u30d5\u30a1\u30a4\u30eb\u306e\u30c6\u30f3\u30d7\u30ec\u3092\u4f5c\u6210\u3002\u91cd\u8907\u3057\u305f\u3068\u3053\u308d\u306f\\_\\_collision__\u3092\u982d\u306b\u3064\u3051\u3066\u3001\u30e6\u30fc\u30b6\u30fc\u540d\u3068\u3001\u5b66\u7c4d\u756a\u53f7\u3001GID\u3092\u30d6\u30e9\u30a6\u30b6\u306b\u8fd4\u9001\u3002\u30d6\u30e9\u30a6\u30b6\u3067\u30e6\u30fc\u30b6\u30fc\u306b\u5165\u529b\u3057\u3066\u3082\u3089\u3063\u30662\u3064\u76ee\u306ephp\u30d5\u30a1\u30a4\u30eb\u306b\u9001\u4fe1\u3002\u53d7\u3051\u53d6\u3063\u305f\u3082\u306e\u3092\u5143\u306b\u3001\u6700\u7d42\u7684\u306apasswd\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u308b\u3002\u3053\u3053\u3067\u518d\u3073\u91cd\u8907\u304c\u8d77\u304d\u308b\u3068\u3001\u30b5\u30a4\u30c9\u30d6\u30e9\u30a6\u30b6\u306b\u9001\u4fe1\u3057\u3066\u30012\u3064\u76ee\u306ephp\u306e\u307b\u3046\u3067\u30b5\u30a4\u30c9\u51e6\u7406\u3059\u308b\u3002\u7d50\u69cb\u30ac\u30d0\u30ac\u30d0\u306a\u5b9f\u88c5\u3060\u3063\u305f\u308a\u3057\u307e\u3059\u304c\u3001\u305d\u3053\u306f\u307e\u3041\u306d\uff57\uff57\uff57\uff57\n\n```html:index.php\n<!DOCTYPE html>\n<html>\n    <head>\n        <meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\"> \n        <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    </head>\n    <body>\n        <div>\n            <!-- Main -->\n            <p>input CSV file name( student-list.txt )</p>\n            <input id=\"fileName\" type=\"text\" class=\"form-control input-lg\" /><!--\u5165\u529b\u30b9\u30da\u30fc\u30b9-->\n            <span class=\"input-group-btn\">\n                <input id=\"submitBtn\" class=\"btn btn-submit\" value=\"Submit\" type=\"submit\" /><!--\u30dc\u30bf\u30f3-->\n            </span>\n            <p id =\"message\"></p><!--\u30e1\u30c3\u30bb\u30fc\u30b8\u8868\u793a\u7528-->\n            <!-- Script --><!--\u3053\u3063\u304b\u3089\u30b9\u30af\u30ea\u30d7\u30c8\uff1aJS-->\n            <script src=\"http://code.jquery.com/jquery-2.1.1.min.js\"></script><!--jQuery\u306e\u30ed\u30fc\u30c9-->\n            <script>\n               var responseData = [];\n                $(\"#submitBtn\").click(function() {//\u30dc\u30bf\u30f3\u304c\u62bc\u3055\u308c\u305f\u3068\u304d\u306e\u51e6\u7406\n                 data = { \"fileName\": $(\"#fileName\").val() };//\u30d5\u30a1\u30a4\u30eb\u540d\u3092JSON\u3067\u9001\u4fe1\n                 post(data,\"php1.php\");//post\u30e1\u30bd\u30c3\u30c9\u306e\u547c\u3073\u51fa\u3057\uff5e\n                 return false;\n               });\n               function post(data,url){//\u30dd\u30b9\u30c8\u30ea\u30af\u30a8\u30b9\u30c8\u306e\u95a2\u6570\n                 $.ajax({\n                   type: \"post\",\n                   url: url,\n                   data: JSON.stringify(data),//\u3067\u30fc\u305f\u3092\u30b8\u30a7\u30a4\u30bd\u30f3\u306b\u5909\u63db\n                   contentType: 'application/JSON',//\u305d\u306e\u4ed6\u30aa\u30d7\u30b7\u30e7\u30f3\n                   dataType : 'JSON',\n                   scriptCharset: 'utf-8',\n                   success: function(response) {//\u6210\u529f\u3057\u305f\u3068\u304d\u306b\u547c\u3070\u308c\u308b\n                        responseData=[];\n                        if(check(JSON.stringify(response))){//json\u306e\u4e2d\u8eab\u3061\u3047\u3063\u304f\n                            ask(JSON.stringify(response));//\u5165\u3063\u3066\u305f\u3089\u305d\u308c\u306b\u3057\u305f\u304c\u3063\u3066\u30e6\u30fc\u30b6\u30fc\u30cd\u30fc\u30e0\u3092\u3082\u3089\u3046\u3002\n                            response=null;\n                        }else{//\u7a7a\u306a\u3089\u6210\u529f\u3063\u3066\u4e8b\u3002\n                            $(\"#message\").html(\"<p>passwd file successfly genelated</p>\");\n                        }\n                    },\n                   error: function(xhr,textStatus,err) {//\u5931\u6557\u3057\u305f\u3089\u547c\u3070\u308c\u308bjson\u4ee5\u5916\u306e\u30a8\u30e9\u30fc\u3082\u6709\u308b\u3088\u3002\n                        alert(\"error\u305f\u3076\u3093JSON\");//\u30a8\u30e9\u30fc\u30e1\u30c3\u30bb\u30fc\u30b8\u2193\n                        $(\"#message\").append(\"<br>readyState: \" + xhr.responseText);\n                        $(\"#message\").append(\"<br>readyState: \" + xhr.readyState);\n                        $(\"#message\").append(\"<br>responseText: \"+ xhr.responseText);\n                        $(\"#message\").append(\"<br>status: \" + xhr.status);\n                        $(\"#message\").append(\"<br>text status: \" + textStatus);\n                        $(\"#message\").append(\"<br>error: \" + err);\n                   }                                                                                                         \n                 });                                                                                                         \n               }\n               function check(res){//json\u304c\u7a7a\u306a\u3089\u91cd\u8907\u304c\u306a\u3044\u3068\u5224\u5b9a\n                   var data = JSON.parse(res);//json\u3092\u30d1\u30fc\u30b9\n                   var array = Array.prototype.slice.call(data);//\u914d\u5217\u306b\u5909\u63db\uff1a\u3053\u308c\u30ca\u30a4\u30c8\u3082\u3063\u3068\u9762\u5012\u306b\u306a\u308b\u3002\n                   if(array.length>0){\n                       return true;\n                   }\n                   return false;\n               }                   \n               function ask(res){\n                   var data = JSON.parse(res);\n                   var array = Array.prototype.slice.call(data);\n                   for(var i =0;i<array.length;i++){\n                       askPrompt(array[i]);//\u30d7\u30ed\u30f3\u30d7\u30c8\u3092\u51fa\u3057\u3066\u30e6\u30fc\u30b6\u30fc\u540d\u3092\u3082\u3089\u3046\n                   }\n                   post(responseData,\"php2.php\");//JSON\u3092\u7a4d\u3093\u3060\u914d\u5217\u3092\u9001\u4fe1\n               }\n               function askPrompt(data){//\u30d7\u30ed\u30f3\u30d7\u30c8\u306e\u30e9\u30c3\u30d1\u30fc\u95a2\u6570\n                   _name = data.name;\n                   id = data.id;\n                   example1 = data.ex1;\n                   example2 = data.ex2;\n                    while(true){//null\u3068\u304b\u7a7a\u6587\u5b57\u3092\u3051\u308b\u30028\u6587\u5b57\u5236\u9650\u3082\u3053\u3053\u3067\u3084\u308b\u3002\n                        var name=prompt('\u6b8b\u5ff5\u30e6\u30fc\u30b6\u30fc\u540d('+_name+':'+id+')\u304c\u91cd\u8907\u3057\u307e\u3057\u305f\u3002\u5225\u306e\u3082\u306e\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044\u3002\u203b8\u6587\u5b57\u4ee5\u4e0b(\u4f8b:'+ ((example2==\"null\")?example1 : example1+\",\"+example2 ) +' etc...)', ((example2==\"null\")?example1 : example2));\n                        if(name!==null && name!=='' && name.length <9){\n                            break;\n                        }else{\n                            alert(\"input error\");\n                        }\n                    }\n                    responseData.push({name:_name,newName:name,id:id});//Json\u5f62\u5f0f\u914d\u5217\u306b\u3064\u3093\u3069\u304f\n            }\n            </script>\n        </div>\n    </body>\n</html>\n```\n\n\u5b9f\u969b\u3053\u308c\u63d0\u51fa\u306fphp\u30d5\u30a1\u30a4\u30eb\u306a\u3093\u3059\u3051\u3069\u306d\uff57\uff57\uff57\nJson\u30c7\u30b3\u30fc\u30c9\u3057\u305f\u306eJS\u3067\u306f\u914d\u5217\u3058\u3083\u306a\u304f\u3066Object\u306e\u584a\u307f\u305f\u3044\u306a\u6271\u3044\u53d7\u3051\u3066\u3001\u305c\u3093\u305c\u3093\u4f7f\u3044\u52dd\u624b\u60aa\u3044\u3093\u3059\u308f\u3002\u3060\u30f5\u3089\u3001`Array.prototype.slice.call`\u3064\u304b\u3063\u3066\u914d\u5217\u306b\u3002\u3044\u308d\u3044\u308d\u3084\u308a\u65b9\u6709\u308b\u306e\u304b\u306a\uff1f\u3063\u3066\u611f\u3058\u3067\u3059\u3002\u6c17\u306b\u306a\u308b\u306a\u3089gg\u3063\u3066\u304f\u3060\u3055\u3044\u3002web\u521d\u5fc3\u8005\u306e\u81ea\u5206\u306b\u306f\u4eca\u5f97\u305f\u77e5\u8b58\u3067\u5341\u5206\u3067\u3059\u3002\u3061\u306a\u307f\u306b\u3053\u308c\u914d\u5217\u306b\u51fa\u6765\u306a\u304b\u3063\u305f\u3089\u3001JS\u3060\u304b\u3089\u5e73\u6c17\u3067undefined\u3068\u304b\u306a\u3063\u3066\u307e\u3059\u3002JS\u6016\u3059\u304e\u3002\n\u3068\u3001Ajax\u306eerror\u6642\u306e\u95a2\u6570\u3001\u3053\u308c\u30ea\u30af\u30a8\u30b9\u304c\u6210\u529f\u3057\u305f\u304b\u3069\u3046\u304b\u3060\u3051\u3058\u3083\u306a\u3044\u3093\u3067\u3059\u306d\u3002\n\u3088\u3046\u3059\u308b\u306b\u3001error\u95a2\u6570\u304c\u547c\u3070\u308c\u3066\u3001`xhr.status`\u304c200\u306a\u3093\u3066\u826f\u304f\u6709\u308b\u3093\u3067\u3059\u306d\u3002\u6210\u529f\u3060\u3051\u3069\u5931\u6557\u30c4\u30f3\u30c7\u30ec\u3055\u3093\u304b\u306a\uff1f\uff1f\u3068\u601d\u3063\u305f\u3093\u3067\u3059\u3051\u3069\u3001\u3053\u308c\u30ea\u30af\u30a8\u30b9\u30c8\u6210\u529f\u3057\u305f\u305c\u3063\u3066\u8a71\u3067\u3001\u5b9f\u969bJSON\u306e\u69cb\u6587\u304a\u304b\u3057\u304b\u3063\u305f\u308a\u3059\u308b\u3068\u3001parseError\u3068\u304b\u304c\u3067\u3066\u3001\u901a\u4fe1\u306f\u6210\u529f\u3060\u3051\u3069\u3082\u3089\u3063\u305f\u306e\u306f\u4f55\u304b\u5909\u3060\u305c\u3068\u304b\u3082\u3001error\u306a\u3093\u3067\u3059\u306d\u3002\n\u3042\u304a\u3068\u306f\u3001\u81ea\u5206\u304c\u73cd\u3057\u304f2\u9805\u6f14\u7b97\u5b50\uff08\uff1f\u6f14\u7b97\u5b50\uff09\u4f7f\u3063\u3066\u308b\u3002\n\u308f\u3093\u3089\u3044\u306a\u30fc\u3068\u304b\u3044\u3046\u3084\u3064\u3067\u3059\u304b\uff1f\u77e5\u308a\u307e\u305b\u3093\u3002\u5225\u306b\u7af6\u6280\u30d7\u30ed\u30b0\u30e9\u30de\u3058\u3083\u306a\u3044\u3093\u3067\u3002\n\n\u3042\u3001\u3082\u3046WUG\u8981\u7d20\u306a\u3044\u3063\u3059\u3088\u3002\u305f\u3076\u3093\u3002\n\n```php:php1.php\n<?php\n/*\n *\u3046\u308b\u305b\u3048\u30d5\u30a1\u30a4\u30eb\u540d\u9069\u5f53\u3068\u304b\u8a00\u3046\u306a\u3002\n *\u3046\u308b\u305b\u3048\u5909\u6570\u540d\u610f\u5473\u4e0d\u660e\u3068\u304b\u8a00\u3046\u306a\u4ffa\u3082\u308f\u304b\u3089\u3093\u306e\u3058\u3083\uff57\uff57\uff57\uff57\uff57\n */\n\n\n\n//ajax\u4ee5\u5916\u306e\u63a5\u7d9a\u3092\u62d2\u5426\n$request = isset($_SERVER['HTTP_X_REQUESTED_WITH']) ? strtolower($_SERVER['HTTP_X_REQUESTED_WITH']) : '';\nif($request !== 'xmlhttprequest'){\n    echo \"error\";\n    exit;\n}\n \n$jsonString = file_get_contents('php://input');//json\u3092\u53d6\u5f97\n$json = json_decode($jsonString,true);//json\u3092\u30c7\u30b3\u30fc\u30c9\u3001\u914d\u5217\u306b\u3076\u3063\u3053\u3080\n$fileName  = $json[\"fileName\"];//json\u304b\u3089\u30d5\u30a1\u30a4\u30eb\u540d\u3092\u53d6\u5f97\nif(file_exists(\"./etc\")===False){//etc\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u304c\u6709\u308b\u304b\u30c1\u30a7\u30c3\u30af\n    if(mkdir(\"./etc\",0666)===False){//\u4f5c\u308b\u7121\u7406\u3060\u3063\u305f\u3089\u30b2\u30fc\u30e0\u30aa\u30fc\u30d0\u30fc\n        echo \"<p>directiry error</p>\";\n        exit;\n    }\n}\nif(($passFile =  fopen(\"./etc/.passwdtmp\", \"w\"))===False){//\u30d1\u30b9\u30d5\u30a1\u30a4\u30eb\u306e\u30c6\u30f3\u30d7\u308c\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u6210\n    echo \"<p>passwd file open error...</p>\";\n    exit;\n}\nif($fileName===null || $fileName === False || ($file=fopen($fileName, \"r\"))===False){//\u30d5\u30a1\u30a4\u30eb\u30aa\u30fc\u30d7\u30f3\n    echo \"file open error\";\n    exit;\n}else{\n    $content;\n    $collision=array();//\u885d\u7a81\u7528\u306eSON\u306e\u914d\u5217\n    $collisionIndex=0;//\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\n    while($content = fgets($file)){//CSV\u306e\u8aad\u307f\u8fbc\u307f\n        $strAry = explode(\",\", $content); //0:ID 1:\u540d\u524d 2:name\n        for($i = 0;$i<sizeof($strAry);$i++){\n            $strAry[$i] = preg_replace(\"/\\\"/\", \"\", $strAry[$i]);//\u201d\u3092\u524a\u9664             \n        }\n        $strAry[2] = preg_replace(\"/\\n/\", \"\", \"$strAry[2]\");//name\u306e\u6539\u884c\u524a\u9664\n        $strAry[2] = preg_replace(\"/[\\s]+/\", \" \", \"$strAry[2]\");//name\u306e\u7a7a\u767d\u9023\u7d9a\u3092\u524a\u9664\n        $strAry[2] = replaceRomaji(mb_strtolower($strAry[2]));//\u5c0f\u6587\u5b57\u306b\u5909\u63db\n        $tmpAry = explode(\" \",$strAry[2]);//\u540d\u524d\u3092\u7a7a\u767d\u3067\u533a\u5207\u308b\n        //\u57fa\u672c\u7684\u306b\u5168\u90e8\u95a2\u6570\u306b\u3057\u3066\u307e\u3059\u3002\n        $GID=getGID($strAry[0]);\n        $login_name=getLoginName($tmpAry[0],$tmpAry[1],$GID);//\u30ed\u30b0\u30a4\u30f3\u540d\u751f\u6210\u306e\u305f\u3081\u59d3\u3068\u540d\u3068GID\uff08\u91cd\u8907\u30c1\u30a7\u30c3\u30af\uff09\u3092\u6e21\u3059\n        $UID=getUID($strAry[0]);\n        $GECOS=getGECOS($strAry[2]);\n        $home_dir=\"/home/\".$login_name;\n        $login_shell=\"/bin/sh\";\n        $tmpStr = preg_replace(\"/__collision__/\",\"\",$login_name);//\u4ee5\u4e0b\u91cd\u8907\u6642\u306e\u8a18\u8ff0\u91cd\u8907\u3057\u305f\u3089__collision__\u3092\u3064\u3051\u308b\n        if(preg_match(\"/__collision__/\",$login_name)===1){//json\u3067\u6e21\u3059\u306e\u306f\u540d\u524dUID\u3068\u540d\u524d\u306e\u5019\u88dc\u306e\u4e09\u3064(4\u3064\uff09\n            array_push($collision,array(\"name\"=> $tmpStr,\n                                            \"id\"=>$UID,\n                                            \"ex1\"=>  substr($tmpStr,0,5).\"123\",\n                                            \"ex2\"=>  genelateName($tmpStr)));\n        }\n        //login_name:*:UID:GID::::GECOS:home_dir:login_shell\n        $content = $login_name.\":x:\".$UID.\":\".$GID.\"::::\".$GECOS.\":\".$home_dir.\":\".$login_shell.\"\\n\";//passwd\u3088\u3046\u306e\u6587\u5b57\u5217\n        fputs($passFile, $content, strlen($content));//\u66f8\u304d\u8fbc\u307f\n    }\n    if(sizeof($collision)<1){//\u91cd\u8907\u306a\u3057\u306a\u3089\n        fclose($file);\n        rename($fileName,\"./etc/passwd\");//\u30c6\u30f3\u30d7\u30ec\u3092passwd\u306b\u304b\u3048\u308b\u3002\n        header( 'Content-Type: application/json; charset=utf-8' );\n        echo  json_encode($collision);        \n    }else{//\u91cd\u8907\u3042\u308b\u306a\u3089\u305d\u306e\u307e\u307eGO\uff01\n        ob_clean();\n        header( 'Content-Type: application/json; charset=utf-8' );\n        echo  json_encode($collision);\n    }\n}\nfunction getGECOS($str){\n    //\u95a2\u6570\u4f5c\u3063\u305f\u3051\u3069\u5b9f\u88c5\u3059\u308b\u3082\u3093\u306a\u304b\u3063\u305f\uff5e\uff5e\uff5e\uff57\uff57\uff57\uff57\uff57\uff57\uff57\n    return $str;\n}\nfunction getUID($num){\n    return substr($num, 0,3).substr($num,-3);\n}    \nfunction getGID($num){\n    return substr($num,0,4);\n}\nfunction getLoginName($name,$name2,$num){//\u91cd\u8907\u30c1\u30a7\u30c3\u30af\u8fbc\u307f\u4ed5\u69d8\u5909\u66f4\n    $name = substr($name, 0,8);\n    if(isUsed($name,$num)===True){//\u91cd\u8907\u30c1\u30a7\u30c3\u30af\n        if(strlen($name)<7){//\u59d3_\u540d\u306b\u3057\u3066\u307f\u308b\n            $name = $name.\"_\".substr($name2, 0,(8-strlen($name)-1));\n            if(isUsed($name,$num)===True){//\u305d\u308c\u3067\u3082\u91cd\u8907\u3057\u305f\u3089__collision__\u3092\u4ed8\u52a0\n                $name = \"__collision__\".$name;\n            }\n        }\n    }\n    return $name;\n}\nfunction isUsed($name,$num){//\u4f7f\u7528\u30c1\u30a7\u30c3\u30af\u30d5\u30a1\u30a4\u30eb\u3092\u958b\u3044\u3066\u635c\u67fb\n    if(($file = @fopen(\"./etc/.passwdtmp\", \"r\"))===False){\n        echo \"pass file open error\";\n        exit;\n    }\n    while(False !== ($str = fgets($file))){\n        $tmp = explode(\":\", $str);\n        $str = $tmp[0];\n        $gid = $tmp[3];\n        if($str===$name && $gid === $num){//\u540d\u524d\u3068GID\u91cd\u8907\n            fclose($file);\n            return True;\n        }\n    }\n    fclose($file);\n    return False;\n}\nfunction genelateName($str){//\u30ed\u30fc\u30de\u5b57\u3092\u3054\u306b\u3087\u3054\u306b\u3087\u540d\u524d\u306e\u4f8b\u3092\u751f\u3080\n    $tmp = $str;\n    $replaceAry=array(\n        array(\"hu\",\"fu\"),\n        array(\"si\",\"shi\"),\n        array(\"sya\",\"sha\"),\n        array(\"syu\",\"shu\"),\n        array(\"syo\",\"sho\"),\n        array(\"jya\",\"ja\"),\n        array(\"jyu\",\"ju\"),\n        array(\"jyo\",\"jo\"),\n        array(\"tu\",\"tsu\"),\n        array(\"ti\",\"chi\"),\n        array(\"tya\",\"cha\"),\n        array(\"tyu\",\"chu\"),\n        array(\"tyo\",\"cho\"),\n    );\n    for($i=0;$i<sizeof($replaceAry);$i++){\n        $str = str_replace($replaceAry[$i][1], $replaceAry[$i][0], $str);\n    }\n    if($str==$tmp){\n        return \"null\";\n    }\n    return substr($str,0,8);//8\u6587\u5b57\u5236\u9650        \n}\nfunction replaceRomaji($str){//\u30ed\u30fc\u30de\u5b57\u3092\u3054\u306b\u3087\u3054\u306b\u3087\u6574\u5f62\u3059\u308b\n    //si->shi, sya->sha, syu->shu, syo->sho, jya->ja, jyu->ju, jyo->jo, tu->tsu, ti->chi, tya->cha, tyu->chu, tyo->cho, hu->fu\n    $replaceAry=array(\n        array(\"hu\",\"fu\"),//\u30b4\u30ea\u62bc\u3057\u306a\u3093\u3060\u306a\uff5e\uff5e\uff57\uff57\uff57\uff57\uff57\u3000shu\u304csfu\u306b\u306a\u308b\u306echu\u304ccfu\u306b\u306a\u308b\u306e\u306ffix\u6e08\u307f\n        array(\"si\",\"shi\"),\n        array(\"sya\",\"sha\"),\n        array(\"syu\",\"shu\"),\n        array(\"syo\",\"sho\"),\n        array(\"jya\",\"ja\"),\n        array(\"jyu\",\"ju\"),\n        array(\"jyo\",\"jo\"),\n        array(\"tu\",\"tsu\"),\n        array(\"ti\",\"chi\"),\n        array(\"tya\",\"cha\"),\n        array(\"tyu\",\"chu\"),\n        array(\"tyo\",\"cho\"),\n        array(\"cfu\",\"chu\"),\n        array(\"sfu\",\"shu\")        \n    );\n    for($i=0;$i<sizeof($replaceAry);$i++){\n        $str = str_replace($replaceAry[$i][0], $replaceAry[$i][1], $str);\n    }\n    return $str;\n}\n```\n\u3044\u3044\u611f\u3058\u306e\u30b0\u30c0\u30b0\u30c0\u30d7\u30ed\u30b0\u30e9\u30e0\u3067\u3059\u306d\u3002\n`$jsonString = file_get_contents('php://input');`\n\u3053\u308c\u3067json\u304c\u53d7\u3051\u53d6\u308c\u308b\u3093\u3067\u3059\u306d\u3002`php://input`\u306f\u8aad\u307f\u8fbc\u307f\u5c02\u7528\u306e\u30b9\u30c8\u30ea\u30fc\u30e0\u3067\u3001\u30ea\u30af\u30a8\u30b9\u30c8\u306ebody\u90e8\u304b\u3089\u751f\u306e\u30c7\u30fc\u30bf\u3092\u8aad\u307f\u8fbc\u3080\u3053\u3068\u304c\u3067\u304d\u308b\u3082\u306e\u306a\u3093\u3067\u3059\u306d\u3002\u307e\u3041\u3001\u6700\u521d\u306f\u30d5\u30a1\u30a4\u30eb\u540d\u3057\u304b\u98db\u3093\u3067\u3053\u306a\u3044\u3093\u3067\u3059\u3051\u3069\u3002\n\u3042\u3068\u306f\u3001\u306b\u3087\u306b\u3087\u306b\u3087\u306b\u3087\u306b\u3087\uff5e\u3063\u3066\u611f\u3058\u3067passwd\u30d5\u30a1\u30a4\u30eb\u4f5c\u6210\u3068\u304b\u91cd\u8907\u30c1\u30a7\u30c3\u30af\u3068\u304b\u3057\u3066\u307e\u3059\u3002\n\u8fd4\u3059\u3068\u304d\u306f\u3001\u30d8\u30c3\u30c0\u3064\u3051\u3066\u914d\u5217\u3092json_encode\u3057\u3066echo\u3059\u308b\u3060\u3051\u3002\u601d\u3063\u305f\u4ee5\u4e0a\u306b\u7c21\u5358\u306a\u308f\u3051\u3067\u3059\u3002\n\n```php:php2.php\n<?php\n//ajax\u4ee5\u5916\u306e\u63a5\u7d9a\u3092\u62d2\u5426\n$request = isset($_SERVER['HTTP_X_REQUESTED_WITH']) ? strtolower($_SERVER['HTTP_X_REQUESTED_WITH']) : '';\nif($request !== 'xmlhttprequest'){\n    echo \"error\";\n    exit;\n}\n$json_string  = file_get_contents(\"php://input\");\necho $json_string;\n$response = json_decode($json_string,true);//json\u306e\u914d\u5217\nif(sizeof($response)<1){\n    echo \"done?\";\n    exit;\n}\n$tmpfile = fopen(\"./etc/.passwdtmp\",\"r\");\n$passfile = fopen(\"./etc/passwd\",\"w\");\nif($passfile===false || $tmpfile===false){\n    echo \"<script>alert('Server Erorr');</script>\";\n    exit;\n}\n$responseIndex=0;\n$flg=true;//\u30d5\u30e9\u30b0\uff1a\u5909\u66f4\u9805\u76ee\u306e\u6709\u308a\u7121\u3057\u3092\u610f\u5473\u3059\u308b\u3002\u30bb\u30b0\u30e1\u30f3\u30c8\u30a8\u30e9\u30fc\u4e88\u9632\n$collision = array();\nwhile(($content=fgets($tmpfile))!==False){\n    //login_name:*:UID:GID::::GECOS:home_dir:login_shell\n    //{name:\u5143\u306e\u540d\u524d,newName:\u65b0\u3057\u3044\u540d\u524d,id:id});\n    $inputBuffer = \"\";\n    $array = explode(\":\", $content);\n    if($flg == true &&\n       $array[0]===(\"__collision__\".$response[$responseIndex][\"name\"]) &&\n       $array[2]===$response[$responseIndex][\"id\"]){//\u885d\u7a81\u3057\u305f\u306e\u3068\u30c1\u30a7\u30c3\u30af\u5165\u308c\u66ff\u3048\n        if(isUsed($response[$responseIndex][\"newName\"],$array[3])){//\u65b0\u3057\u3044\u306e\u304c\u91cd\u8907\u3057\u3066\u305f\u3089\u7a81\u3063\u3071\u306d\u308b\n            array_push($collision , array(\"name\" => $response[$responseIndex][\"name\"],\n                                          \"id\" =>$response[$responseIndex][\"id\"],\n                                          \"ex1\"=> substr($response[$responseIndex][\"name\"],0,5).\"123\",\n                                          \"ex2\"=> genelateName($response[$responseIndex][\"name\"])));\n            $inputBuffer = $content;\n            $responseIndex++;\n            if($responseIndex>=sizeof($response)){\n                $flg =false;\n            }\n        } else {\n            $array[0]=$response[$responseIndex][\"newName\"];\n            $str = \"__collision__\".$response[$responseIndex][\"name\"];\n            $array[sizeof($array)-2] = preg_replace(\"/$str/\",\n                                                    $response[$responseIndex][\"newName\"],\n                                                    $array[sizeof($array)-2]);\n            for($i = 0; $i < sizeof($array)-1;$i++){\n                $inputBuffer = $inputBuffer.$array[$i].\":\";\n            }\n            $inputBuffer = $inputBuffer.$array[sizeof($array)-1];\n            $responseIndex++;\n            if($responseIndex>=sizeof($response)){\n                $flg =false;\n            }\n        }\n    }else{\n        $inputBuffer = $content;\n    }\n    fputs($passfile, $inputBuffer, strlen($inputBuffer));//\u66f8\u304d\u8fbc\u307f\n}\n    fclose($tmpfile);\n    fclose($passfile);\nif(sizeof($collision)>0){\n    if(unlink(\"./etc/.passwdtmp\")===false){//\u3066\u3093\u3077\u3089\u30d5\u30a1\u30a4\u30eb\u524a\u9664\n        echo \"server error...\";\n        exit;\n    }else{\n        if(rename(\"./etc/passwd\",\"./etc/.passwdtmp\")===false){//\u4fee\u6b63\u7248\u3092\u3066\u3093\u3077\u3089\u306b\n            echo \"server error...\";\n            exit;\n        }\n    }\n    ob_clean();\n    header( 'Content-Type: application/json; charset=utf-8' );\n    echo  json_encode($collision);\n}else{\n    if(unlink(\"./etc/.passwdtmp\")===false){//\u3066\u3093\u3077\u3089\u30d5\u30a1\u30a4\u30eb\u524a\u9664\n        echo \"server error...\";\n        exit;\n    }\n    ob_clean();\n    header( 'Content-Type: application/json; charset=utf-8' );\n    echo  json_encode($collision);\n}\n\nfunction isUsed($name,$num){\n    if(($file = @fopen(\"./etc/passwd\", \"r\"))===False){\n        echo \"pass file open error\";\n        exit;\n    }\n    while(False !== ($str = fgets($file))){\n        $tmp = explode(\":\", $str);\n        $str = $tmp[0];\n        $gid = $tmp[3];\n        if($str===$name && $gid === $num){\n            fclose($file);\n            return True;\n        }\n    }\n    fclose($file);\n    return False;\n}\nfunction genelateName($str){\n    $tmp = $str;\n    $replaceAry=array(\n        array(\"hu\",\"fu\"),\n        array(\"si\",\"shi\"),\n        array(\"sya\",\"sha\"),\n        array(\"syu\",\"shu\"),\n        array(\"syo\",\"sho\"),\n        array(\"jya\",\"ja\"),\n        array(\"jyu\",\"ju\"),\n        array(\"jyo\",\"jo\"),\n        array(\"tu\",\"tsu\"),\n        array(\"ti\",\"chi\"),\n        array(\"tya\",\"cha\"),\n        array(\"tyu\",\"chu\"),\n        array(\"tyo\",\"cho\"),\n    );\n    for($i=0;$i<sizeof($replaceAry);$i++){\n        $str = str_replace($replaceAry[$i][1], $replaceAry[$i][0], $str);\n    }\n    if($str==$tmp){\n        return null;\n    }\n    return substr($str,0,8);//8\u6587\u5b57\u5236\u9650        \n}\n```\n\u307b\u3068\u3093\u3069\u4e00\u7dd2\u306a\u3093\u3059\u3088\u306d\u3002\n\u7279\u306b\u96e3\u3057\u3044\u3053\u3068\u3084\u3063\u3066\u306a\u3044\u3057\u3001\u8aad\u3081\u3070\u308f\u304b\u308b\u3057\u3001\u8aad\u307e\u306a\u304f\u3066\u3082\u3044\u3044\u3067\u3059\uff57\uff57\n\u30d5\u30a1\u30a4\u30eb\u66f4\u65b0\u3057\u3066\u307e\u3059\u306d\u3002\u3061\u306a\u307f\u306b\u3001Json\u9001\u308b\u524d\u306b\u3001\u30b9\u30c8\u30ea\u30fc\u30e0\u3092\u304a\u6383\u9664\u3057\u306a\u3044\u3068\u5909\u306a\u306e\u4e00\u7dd2\u306b\u9001\u3063\u3066\u3001JS\u5074\u3067\u610f\u5473\u4e0d\u660e\u306a\u30a8\u30e9\u30fc\u306b\u8972\u308f\u308c\u3066\u5410\u304d\u305d\u3046\u306b\u306a\u308b\u306e\u3067\u6c17\u3092\u3064\u3051\u307e\u3057\u3087\u3046\u3002\n`ob_clean();`\u3053\u308c\u3060\u3051\u306f\u3068\u308a\u3042\u3048\u305a\u66f8\u3044\u3068\u304d\u307e\u3057\u3087\u3046\u3002\n\n\n\u4ee5\u4e0a\u3067\u3059\u304b\u306d\uff1f\uff1f\u8ab2\u984c\u3082\u7d42\u308f\u3063\u3066\u590f\u4f11\u307f\u3067\u3059\uff01\uff01\uff01\n\u3068\u308a\u3042\u3048\u305a\u3001[\u308f\u3050\u3070\u3093\uff01](http://www.nicovideo.jp/watch/1438763483)\u3084\u3070\u3044\u3093\u3067\u898b\u3066\u304f\u3060\u3055\u3044\u306d\uff01\uff01\uff01\n\u3053\u306e\u52d5\u753b\u306e\u304a\u304b\u3052\u3067\u304c\u3093\u3070\u308c\u307e\u3057\u305f\u3002\u6700\u5f8c\u307e\u3067\u7686\u3055\u3093\u3042\u308a\u304c\u3068\u3046\u3054\u3056\u3044\u307e\u3059\u3002\n\u6b21\u56de\u306f\n\u5927\u5b66\u8ab2\u984c\uff08\u8d85\u304c\u3093\u3070\u3063\u30661\u65e5\u3067\u5b8c\u6210\u3055\u305b\u305f\uff09Java\u00d7\u81ea\u7136\u8a00\u8a9e\u51e6\u7406\u00d7DocomoAPI\u306e\u8a71\nor\nIoT\u3067\u904a\u3093\u3067\u307f\u305f\n\u306e\u3069\u3063\u3061\u304b\u3067\u3059\u306d\u3002\n\n\u30d7WUG\u30e9\u30de\u30fc\u3068\u3057\u3066\u3053\u308c\u304b\u3089\u3082\u304c\u3093\u3070\u3063\u307a\uff01\uff01\n\u305d\u308c\u3067WUG\uff5e :open_hands: \n"}