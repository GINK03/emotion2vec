{"context": " More than 1 year has passed since last update.Ruby on Rails4\u3067\u52d5\u3044\u3066\u3044\u308b\u30b5\u30a4\u30c8\u306e\u3001\u8907\u6570\u53f0\u306eweb\u30b5\u30fc\u30d0\u306b\u6700\u65b0\u30bd\u30fc\u30b9\u3092\u9069\u7528\u3057\u3066\u3001\u66f4\u65b0\u304c\u3042\u308c\u3070\u518d\u8d77\u52d5\u3055\u305b\u305f\u304f\u306a\u308a\u307e\u3057\u305f\u306e\u3067\u3001capistrano\u306e\u30b3\u30fc\u30c9\u3092\u66f8\u304d\u307e\u3057\u305f\u3002\n\n/config/deploy.rb\nnamespace :apache do\n  task :deploy do\n    on roles(:web) do\n      within \"git\u7ba1\u7406\u4e0b\u306e\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\" do\n        puts '> git pull'\n        out = capture(:git, \"pull\")\n        puts out\n        if out != 'Already up-to-date.' \n          puts '> sudo service apache2 restart'\n          puts capture(:sudo, \"service apache2 restart\")\n        end\n      end\n    end\n  end\nend\n\n\nweb\u30b5\u30fc\u30d0\u306e\u5b9a\u7fa9\u306f\u3001\u74b0\u5883\u3054\u3068(staging.rb,production.rb\u306a\u3069)\u306b\u5225\u30d5\u30a1\u30a4\u30eb\u3067\u5b9a\u7fa9\u3057\u3066\u304a\u308a\u307e\u3059\u3002\n\n/config/deploy/staging.rb\n :\nrole :web, %w{hoge.com fuga.com}\n :\n\n\n\u3053\u308c\u3092Jenkins\u306b\u767b\u9332\u3057\u3066\u3001Jenkins\u304b\u3089\u5b9f\u884c\u3059\u308b\u3053\u3068\u3067\u30bf\u30b9\u30af\u306e\u5b9f\u884c\u8005\u306e\u5c65\u6b74\u3092\u6b8b\u3057\u3066\u3044\u307e\u3059\u3002\n\u305d\u3082\u305d\u3082capistrano\u306e\u30bf\u30b9\u30af\u306e\u8a18\u8ff0\u8a00\u8a9e\u304c\u308f\u304b\u3089\u305a\u60a9\u307f\u307e\u3057\u305f\u304c\u3001\u306a\u3093\u3068\u304b\u52d5\u304d\u307e\u3057\u305f\u3002\ncd \u3067\u304d\u306a\u3044\u3067\u304d\u306a\u3044  \u3068\u601d\u3063\u3066\u3044\u305f\u3089\u3001within \u3067\u884c\u3051\u308b\u306e\u3067\u3059\u306d\u30fc\u3002  \nRuby on Rails4\u3067\u52d5\u3044\u3066\u3044\u308b\u30b5\u30a4\u30c8\u306e\u3001\u8907\u6570\u53f0\u306eweb\u30b5\u30fc\u30d0\u306b\u6700\u65b0\u30bd\u30fc\u30b9\u3092\u9069\u7528\u3057\u3066\u3001\u66f4\u65b0\u304c\u3042\u308c\u3070\u518d\u8d77\u52d5\u3055\u305b\u305f\u304f\u306a\u308a\u307e\u3057\u305f\u306e\u3067\u3001capistrano\u306e\u30b3\u30fc\u30c9\u3092\u66f8\u304d\u307e\u3057\u305f\u3002\n\n```/config/deploy.rb\nnamespace :apache do\n  task :deploy do\n    on roles(:web) do\n      within \"git\u7ba1\u7406\u4e0b\u306e\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\" do\n        puts '> git pull'\n        out = capture(:git, \"pull\")\n        puts out\n        if out != 'Already up-to-date.' \n          puts '> sudo service apache2 restart'\n          puts capture(:sudo, \"service apache2 restart\")\n        end\n      end\n    end\n  end\nend\n```\n\n\nweb\u30b5\u30fc\u30d0\u306e\u5b9a\u7fa9\u306f\u3001\u74b0\u5883\u3054\u3068(staging.rb,production.rb\u306a\u3069)\u306b\u5225\u30d5\u30a1\u30a4\u30eb\u3067\u5b9a\u7fa9\u3057\u3066\u304a\u308a\u307e\u3059\u3002\n\n```/config/deploy/staging.rb\n :\nrole :web, %w{hoge.com fuga.com}\n :\n```\n\n\u3053\u308c\u3092Jenkins\u306b\u767b\u9332\u3057\u3066\u3001Jenkins\u304b\u3089\u5b9f\u884c\u3059\u308b\u3053\u3068\u3067\u30bf\u30b9\u30af\u306e\u5b9f\u884c\u8005\u306e\u5c65\u6b74\u3092\u6b8b\u3057\u3066\u3044\u307e\u3059\u3002\n\n\n\u305d\u3082\u305d\u3082capistrano\u306e\u30bf\u30b9\u30af\u306e\u8a18\u8ff0\u8a00\u8a9e\u304c\u308f\u304b\u3089\u305a\u60a9\u307f\u307e\u3057\u305f\u304c\u3001\u306a\u3093\u3068\u304b\u52d5\u304d\u307e\u3057\u305f\u3002\ncd \u3067\u304d\u306a\u3044\u3067\u304d\u306a\u3044 :tired_face: \u3068\u601d\u3063\u3066\u3044\u305f\u3089\u3001within \u3067\u884c\u3051\u308b\u306e\u3067\u3059\u306d\u30fc\u3002 :smiley: \n\n", "tags": ["capistrano3"]}