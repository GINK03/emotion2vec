{"context": " More than 1 year has passed since last update.\u30bf\u30a4\u30c8\u30eb\u901a\u308a\u306e\u5185\u5bb9\u3067\u3059\u3002\u958b\u767a\u74b0\u5883\u306f\u4ee5\u4e0b\u306e\u901a\u308a\u3067\u3059\u3002\n\u958b\u767a\u30de\u30b7\u30f3\n\u3000OS: Windows 7 Home Premium SP1 x64\n\u3000Ruby: 2.0.0-p481 64bit\n\u3000\n\u53c2\u8003\u30b5\u30a4\u30c8\u306f\u3053\u3061\u3089\n\n\u5b9f\u88c5\u307e\u3067\u306b\u639b\u304b\u3063\u305f\u6642\u9593\n8.5h\n\n\u6539\u4fee\u30dd\u30a4\u30f3\u30c8\n\u30fb\u4f1a\u54e1\u5236\u30b5\u30fc\u30d3\u30b9\u3067\u4f7f\u7528\u3059\u308b\u3053\u3068\u3092\u60f3\u5b9a\u3057\u3001\u8a8d\u8a3c\u60c5\u5831\u306fyaml\u30d5\u30a1\u30a4\u30eb\u3067\u306f\u306a\u304f\u3001DB\u306b\u683c\u7d0d\u3057\u305f\u3082\u306e\u3092\u4f7f\u3046\u3002\n\u30fb\u30d5\u30a1\u30a4\u30eb\u3092\u5206\u96e2\u3059\u308b\u3002\n\u3000\u30fbGarb::Model\u3092\u62e1\u5f35\u3057\u305f\u30af\u30e9\u30b9\u3092\u8a18\u8ff0\u3059\u308b\u30d5\u30a1\u30a4\u30eb\u306f\u5225\u306e\u30af\u30e9\u30b9\u30d5\u30a1\u30a4\u30eb\u306b\u307e\u3068\u3081\u3066\u66f8\u304f\u3002\n\u3000\u30fb\u671f\u9593\u8a2d\u5b9a\u3092\u66f8\u3044\u305f\u30cf\u30c3\u30b7\u30e5\u306f\u30b3\u30f3\u30c8\u30ed\u30fc\u30e9\u306b\u66f8\u304f\u3002\n\u3000\u30fb\u5143\u30d5\u30a1\u30a4\u30eb\u306f\u3001\u30e6\u30fc\u30b6\u8a8d\u8a3c\u3057\u305f\u7d50\u679c\u3060\u3051\u3092\u8fd4\u3059\u3002\n\n\u5b9f\u30d5\u30a1\u30a4\u30eb\napp\u76f4\u4e0b\u306bservices\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092\u4f5c\u6210\u3057\u3001\u8a8d\u8a3c\u7528\u30af\u30e9\u30b9\u30d5\u30a1\u30a4\u30eb\u3068\u62e1\u5f35\u30af\u30e9\u30b9\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u6210\u3002\n\u30e6\u30fc\u30b6\u60c5\u5831\u3092\u683c\u7d0d\u3057\u3066\u3044\u308b\u30c6\u30fc\u30d6\u30eb\u306b\u7d10\u3065\u304f\u65e2\u5b58\u306e\u30b3\u30f3\u30c8\u30ed\u30fc\u30e9(users)\u3078\u5b9f\u30c7\u30fc\u30bf\u306e\u53d6\u5f97\u30b3\u30fc\u30c9\u3092\u66f8\u3044\u3066\u3044\u307e\u3059\u3002\n\nanalytics_service.rb\nrequire 'rubygems'\nrequire 'garb'\nrequire 'uri'\nrequire 'active_support/time'\nrequire 'yaml'\n\n# \u8a8d\u8a3c\u30af\u30e9\u30b9\nclass AnalyticsService\n  def load_profile(user_data)\n\n    # \u30bb\u30c3\u30b7\u30e7\u30f3\u30ed\u30b0\u30a4\u30f3\n    Garb::Session.login(\n        user_data.analytics_email,\n        user_data.analytics_password\n    )\n\n    # \u30d7\u30ed\u30d5\u30a1\u30a4\u30eb\u60c5\u5831\u306e\u53d6\u5f97\n      profile = Garb::Management::Profile.all.detect { |p|\n        p.web_property_id == user_data.property_id\n        p.id == user_data.profile_id\n      }\n  end\nend\n\n\n\nanalytics_service_class.rb\nrequire 'rubygems'\nrequire 'garb'\nrequire 'uri'\nrequire 'active_support/time'\nrequire 'yaml'\n\n# \u62e1\u5f35\u30af\u30e9\u30b9\nclass AnalyticsServiceClass\n\n  class PageTitle\n      extend Garb::Model\n      metrics :pageviews\n      dimensions :date\n  end\nend\n\n\n\nusers_controller.rb(\u4e00\u90e8\u629c\u7c8b)\n                :\n  def show \n    @user = User.find(params[:id])\n    analytics = AnalyticsService.new\n    ga_profile = analytics.load_profile(@user)\n    cond = {\n        :start_date => Time.parse(\"2012-12-05\"),\n        :end_date   => Time.parse('2013-01-05'),\n        # :filters    => { :page_path.contains => '^/items/' }\n    }\n      @data = AnalyticsServiceClass::PageTitle.results(ga_profile, cond)\n  end\n                :\n\n\n@data\u3078\u683c\u7d0d\u3057\u305f\u30c7\u30fc\u30bf\u306f\u3001\u30d3\u30e5\u30fc\u306e\u4e2d\u3067\u8868\u793a\u3055\u305b\u3066\u3044\u307e\u3059\u3002\n\n\u30a8\u30e9\u30fc\u3001\u30d0\u30b0\u60c5\u5831\njson \u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u304c1.8.1 \u306e\u72b6\u614b\u3067\u30a8\u30e9\u30fc\u304c\u767a\u751f\u3057\u307e\u3057\u305f\u3002\nGarb::Management::Profile.all.detect \u30e1\u30bd\u30c3\u30c9\u3092\u5b9f\u884c\u3057\u305f\u969b\u3001\u4ee5\u4e0b\u306e\u30a8\u30e9\u30fc\u304c\u8868\u793a\u3055\u308c\u307e\u3059\u3002\n\nMultiJson::AdapterError (Did not recognize your adapter specification (193: %1 \u306f\u6709\u52b9\u306a Win32 \u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3067\u306f\u3042\u308a\u307e\u305b\u3093\u3002 - C:/Ruby200/lib/ruby/gems/2.0.0/gems/json-1.8.1/lib/json/ext/parser.so).):\napp/services/analytics_service.rb:26:in load_profile' app/controllers/users_controller.rb:13:inshow'\n\n\u76f4\u63a5\u306e\u539f\u56e0\u306f\u4e0d\u660e\u3067\u3059\u304c\u3001google-api-client \u3092\u4f7f\u7528\u3057\u3066\u540c\u3058\u30a8\u30e9\u30fc\u304c\u767a\u751f\u3057\u305f\u306e\u3067\u3001\u3069\u3046\u3084\u3089API\u81ea\u4f53\u306e\u4e0d\u5177\u5408\u306e\u53ef\u80fd\u6027\u304c\u3057\u307e\u3057\u305f\u3002\n\u305d\u3053\u3067\u3001json \u3092 1.8.0 \u3078\u56fa\u5b9a\u3057\u305f\u3068\u3053\u308d\u3001\u30a8\u30e9\u30fc\u306f\u8d77\u304d\u306a\u304f\u306a\u308a\u307e\u3057\u305f\u3002\nGemfile\u3078\u4ee5\u4e0b\u306e\u8a18\u8f09\u3092\u8ffd\u52a0\u3057\u3066\u3001bundle update \u3092\u5b9f\u884c\u3057\u3066\u3044\u307e\u3059\u3002\ngem 'json', '1.8.0'\n\n\u611f\u60f3\nRails\u306f\u59cb\u3081\u305f\u3070\u304b\u308a\u3067\u7d4c\u9a13\u3082\u6d45\u304f\u3001Ruby\u81ea\u4f53\u3082\u5927\u3057\u3066\u7d4c\u9a13\u304c\u306a\u3044\u306e\u3067\u30af\u30e9\u30b9\u306e\u8a2d\u8a08\u306f\u3053\u308c\u3067\u826f\u3044\u306e\u304b\uff1f\u3068\u81ea\u554f\u81ea\u7b54\u3057\u306a\u304c\u3089\u9032\u3081\u307e\u3057\u305f\u3002\u30af\u30e9\u30b9\u3092\u5165\u308c\u5b50\u306b\u3059\u308b\u306e\u304c\u672c\u5f53\u306b\u826f\u3044\u65b9\u6cd5\u306a\u306e\u304b\u3001\u672a\u3060\u308f\u304b\u3063\u3066\u3044\u307e\u305b\u3093\u3057\u3002\n\u305f\u3060\u3001\u305d\u3046\u3044\u3046\u3053\u3068\u3092\u8abf\u3079\u306a\u304c\u3089\u9032\u3081\u3066\u3001\u51fa\u6765\u306a\u304b\u3063\u305f\u3053\u3068\u304c\u51fa\u6765\u308b\u3088\u3046\u306b\u306a\u308b\u306e\u306f\u4f55\u3068\u3082\u8a00\u3048\u305a\u5145\u5b9f\u611f\u304c\u3042\u308a\u307e\u3059\u3002\n\u307e\u305f\u3001\u3053\u306e\u30d7\u30ed\u30b0\u30e9\u30e0\u306f Perl\u3067\u66f8\u3044\u305f\u3082\u306e\u3092Rails\u306b\u7f6e\u304d\u63db\u3048\u3066\u3044\u308b\u3064\u3082\u308a\u3067\u3059\u3002\n\u30bf\u30a4\u30c8\u30eb\u901a\u308a\u306e\u5185\u5bb9\u3067\u3059\u3002\u958b\u767a\u74b0\u5883\u306f\u4ee5\u4e0b\u306e\u901a\u308a\u3067\u3059\u3002\n\n\u958b\u767a\u30de\u30b7\u30f3\n\u3000OS: Windows 7 Home Premium SP1 x64\n\u3000Ruby: 2.0.0-p481 64bit\n\u3000\n\n\u53c2\u8003\u30b5\u30a4\u30c8\u306f[\u3053\u3061\u3089](http://mn-memo.com/archives/894)\n\n## \u5b9f\u88c5\u307e\u3067\u306b\u639b\u304b\u3063\u305f\u6642\u9593\n8.5h\n\n## \u6539\u4fee\u30dd\u30a4\u30f3\u30c8\n\n\u30fb\u4f1a\u54e1\u5236\u30b5\u30fc\u30d3\u30b9\u3067\u4f7f\u7528\u3059\u308b\u3053\u3068\u3092\u60f3\u5b9a\u3057\u3001\u8a8d\u8a3c\u60c5\u5831\u306fyaml\u30d5\u30a1\u30a4\u30eb\u3067\u306f\u306a\u304f\u3001DB\u306b\u683c\u7d0d\u3057\u305f\u3082\u306e\u3092\u4f7f\u3046\u3002\n\u30fb\u30d5\u30a1\u30a4\u30eb\u3092\u5206\u96e2\u3059\u308b\u3002\n\u3000\u30fbGarb::Model\u3092\u62e1\u5f35\u3057\u305f\u30af\u30e9\u30b9\u3092\u8a18\u8ff0\u3059\u308b\u30d5\u30a1\u30a4\u30eb\u306f\u5225\u306e\u30af\u30e9\u30b9\u30d5\u30a1\u30a4\u30eb\u306b\u307e\u3068\u3081\u3066\u66f8\u304f\u3002\n\u3000\u30fb\u671f\u9593\u8a2d\u5b9a\u3092\u66f8\u3044\u305f\u30cf\u30c3\u30b7\u30e5\u306f\u30b3\u30f3\u30c8\u30ed\u30fc\u30e9\u306b\u66f8\u304f\u3002\n\u3000\u30fb\u5143\u30d5\u30a1\u30a4\u30eb\u306f\u3001\u30e6\u30fc\u30b6\u8a8d\u8a3c\u3057\u305f\u7d50\u679c\u3060\u3051\u3092\u8fd4\u3059\u3002\n\n## \u5b9f\u30d5\u30a1\u30a4\u30eb\napp\u76f4\u4e0b\u306bservices\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092\u4f5c\u6210\u3057\u3001\u8a8d\u8a3c\u7528\u30af\u30e9\u30b9\u30d5\u30a1\u30a4\u30eb\u3068\u62e1\u5f35\u30af\u30e9\u30b9\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u6210\u3002\n\u30e6\u30fc\u30b6\u60c5\u5831\u3092\u683c\u7d0d\u3057\u3066\u3044\u308b\u30c6\u30fc\u30d6\u30eb\u306b\u7d10\u3065\u304f\u65e2\u5b58\u306e\u30b3\u30f3\u30c8\u30ed\u30fc\u30e9(users)\u3078\u5b9f\u30c7\u30fc\u30bf\u306e\u53d6\u5f97\u30b3\u30fc\u30c9\u3092\u66f8\u3044\u3066\u3044\u307e\u3059\u3002\n\n```rb:analytics_service.rb\nrequire 'rubygems'\nrequire 'garb'\nrequire 'uri'\nrequire 'active_support/time'\nrequire 'yaml'\n\n# \u8a8d\u8a3c\u30af\u30e9\u30b9\nclass AnalyticsService\n  def load_profile(user_data)\n\n    # \u30bb\u30c3\u30b7\u30e7\u30f3\u30ed\u30b0\u30a4\u30f3\n    Garb::Session.login(\n        user_data.analytics_email,\n        user_data.analytics_password\n    )\n\n    # \u30d7\u30ed\u30d5\u30a1\u30a4\u30eb\u60c5\u5831\u306e\u53d6\u5f97\n      profile = Garb::Management::Profile.all.detect { |p|\n        p.web_property_id == user_data.property_id\n        p.id == user_data.profile_id\n      }\n  end\nend\n```\n\n```rb:analytics_service_class.rb\nrequire 'rubygems'\nrequire 'garb'\nrequire 'uri'\nrequire 'active_support/time'\nrequire 'yaml'\n\n# \u62e1\u5f35\u30af\u30e9\u30b9\nclass AnalyticsServiceClass\n\n  class PageTitle\n      extend Garb::Model\n      metrics :pageviews\n      dimensions :date\n  end\nend\n```\n\n```rb:users_controller.rb(\u4e00\u90e8\u629c\u7c8b)\n                :\n  def show \n    @user = User.find(params[:id])\n    analytics = AnalyticsService.new\n    ga_profile = analytics.load_profile(@user)\n    cond = {\n        :start_date => Time.parse(\"2012-12-05\"),\n        :end_date   => Time.parse('2013-01-05'),\n        # :filters    => { :page_path.contains => '^/items/' }\n    }\n      @data = AnalyticsServiceClass::PageTitle.results(ga_profile, cond)\n  end\n                :\n```\n\n@data\u3078\u683c\u7d0d\u3057\u305f\u30c7\u30fc\u30bf\u306f\u3001\u30d3\u30e5\u30fc\u306e\u4e2d\u3067\u8868\u793a\u3055\u305b\u3066\u3044\u307e\u3059\u3002\n\n## \u30a8\u30e9\u30fc\u3001\u30d0\u30b0\u60c5\u5831\njson \u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u304c1.8.1 \u306e\u72b6\u614b\u3067\u30a8\u30e9\u30fc\u304c\u767a\u751f\u3057\u307e\u3057\u305f\u3002\n\nGarb::Management::Profile.all.detect \u30e1\u30bd\u30c3\u30c9\u3092\u5b9f\u884c\u3057\u305f\u969b\u3001\u4ee5\u4e0b\u306e\u30a8\u30e9\u30fc\u304c\u8868\u793a\u3055\u308c\u307e\u3059\u3002\n\n>\nMultiJson::AdapterError (Did not recognize your adapter specification (193: %1 \u306f\u6709\u52b9\u306a Win32 \u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3067\u306f\u3042\u308a\u307e\u305b\u3093\u3002 - C:/Ruby200/lib/ruby/gems/2.0.0/gems/json-1.8.1/lib/json/ext/parser.so).):\napp/services/analytics_service.rb:26:in load_profile' app/controllers/users_controller.rb:13:inshow'\n>\n\n\u76f4\u63a5\u306e\u539f\u56e0\u306f\u4e0d\u660e\u3067\u3059\u304c\u3001google-api-client \u3092\u4f7f\u7528\u3057\u3066\u540c\u3058\u30a8\u30e9\u30fc\u304c\u767a\u751f\u3057\u305f\u306e\u3067\u3001\u3069\u3046\u3084\u3089API\u81ea\u4f53\u306e\u4e0d\u5177\u5408\u306e\u53ef\u80fd\u6027\u304c\u3057\u307e\u3057\u305f\u3002\n\u305d\u3053\u3067\u3001json \u3092 1.8.0 \u3078\u56fa\u5b9a\u3057\u305f\u3068\u3053\u308d\u3001\u30a8\u30e9\u30fc\u306f\u8d77\u304d\u306a\u304f\u306a\u308a\u307e\u3057\u305f\u3002\n\nGemfile\u3078\u4ee5\u4e0b\u306e\u8a18\u8f09\u3092\u8ffd\u52a0\u3057\u3066\u3001bundle update \u3092\u5b9f\u884c\u3057\u3066\u3044\u307e\u3059\u3002\n`gem 'json', '1.8.0'`\n\n## \u611f\u60f3\nRails\u306f\u59cb\u3081\u305f\u3070\u304b\u308a\u3067\u7d4c\u9a13\u3082\u6d45\u304f\u3001Ruby\u81ea\u4f53\u3082\u5927\u3057\u3066\u7d4c\u9a13\u304c\u306a\u3044\u306e\u3067\u30af\u30e9\u30b9\u306e\u8a2d\u8a08\u306f\u3053\u308c\u3067\u826f\u3044\u306e\u304b\uff1f\u3068\u81ea\u554f\u81ea\u7b54\u3057\u306a\u304c\u3089\u9032\u3081\u307e\u3057\u305f\u3002\u30af\u30e9\u30b9\u3092\u5165\u308c\u5b50\u306b\u3059\u308b\u306e\u304c\u672c\u5f53\u306b\u826f\u3044\u65b9\u6cd5\u306a\u306e\u304b\u3001\u672a\u3060\u308f\u304b\u3063\u3066\u3044\u307e\u305b\u3093\u3057\u3002\n\u305f\u3060\u3001\u305d\u3046\u3044\u3046\u3053\u3068\u3092\u8abf\u3079\u306a\u304c\u3089\u9032\u3081\u3066\u3001\u51fa\u6765\u306a\u304b\u3063\u305f\u3053\u3068\u304c\u51fa\u6765\u308b\u3088\u3046\u306b\u306a\u308b\u306e\u306f\u4f55\u3068\u3082\u8a00\u3048\u305a\u5145\u5b9f\u611f\u304c\u3042\u308a\u307e\u3059\u3002\n\n\u307e\u305f\u3001\u3053\u306e\u30d7\u30ed\u30b0\u30e9\u30e0\u306f **Perl**\u3067\u66f8\u3044\u305f\u3082\u306e\u3092Rails\u306b\u7f6e\u304d\u63db\u3048\u3066\u3044\u308b\u3064\u3082\u308a\u3067\u3059\u3002\n\n\n\n\n\n\n\n\n\n\n\n", "tags": ["Rails44.0.5", "GoogleAnalytics", "Garb0.9.8", "Ruby2.0.0", "\u30b9\u30af\u30ec\u30a4\u30d4\u30f3\u30b0\u30c4\u30fc\u30eb"]}