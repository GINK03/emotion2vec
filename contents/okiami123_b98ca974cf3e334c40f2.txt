{"tags": ["VBA", "Excel", "File", "Folder"], "context": " \u3053\u306e\u8a18\u4e8b\u306f\u6700\u7d42\u66f4\u65b0\u65e5\u304b\u30891\u5e74\u4ee5\u4e0a\u304c\u7d4c\u904e\u3057\u3066\u3044\u307e\u3059\u3002\u6bce\u5ea6\u6bce\u5ea6\u3001\u601d\u3044\u51fa\u3059\u306e\u3082\u9762\u5012\u306a\u306e\u3067\u3002\u30d5\u30a1\u30a4\u30eb\u64cd\u4f5c\u3067\u3088\u304f\u4f7f\u3046\u30de\u30af\u30ed\u4e00\u5f0f\u3067\u3059\u3002\n\n\u3010\u30d5\u30a9\u30eb\u30c0\u524a\u9664\u3011\nmyFol=\u5f15\u6570\u306f\u30d5\u30eb\u30d1\u30b9\u306b\u3057\u307e\u3059\nFunction FolderDelete(ByVal myFol As String)\n    Set objFile=CreateObject(\"Scripting.FileSystemObject\")\n         If objFile.FolderExists(myFol) Then\n             objFile.GetFolder(myFol).Delete\n         End If\n    Set objFile=Nothing\nEnd Function\n\n\n\u3010\u30d5\u30a1\u30a4\u30eb\u30b3\u30d4\u30fc\u3011\nsrcFile,dstFile\u3082\u30d5\u30eb\u30d1\u30b9\u6307\u5b9a\nFunction FileCopy(ByVal srcFile As String, ByVal dstFile As String)\n    Set objFS=CreateObject(\"Scripting.FileSystemObject\")\n        objFS.CopyFile srcFile, dstFile\n    Set objFS=Nothing\nEnd Function\n\n\n\u3010\u30d5\u30a1\u30a4\u30eb\u79fb\u52d5\u3011\nFunction FileMove(ByVal srcFile As String, ByVal dstFile As String)\n    Set objFS=CreateObject(\"Scripting.FileSystemObject\")\n        objFS.MoveFile srcFile, dstFile\n    Set objFS=Nothing\nEnd Function\n\n\n\u3010\u30d5\u30a9\u30eb\u30c0\u4f5c\u6210\u3011\n\u6df1\u3044\u30cd\u30b9\u30c8\u307e\u3067\u4e00\u6c17\u306b\u4f5c\u6210(\u89aa\u30d5\u30a9\u30eb\u30c0\u304c\u5b58\u5728\u3057\u306a\u3051\u308c\u3070\u4f5c\u308b\uff09\nSub myMkDir(ByVal sPath as String)\n    Dim iStart  As Integer\n    Dim aDirs   As Variant\n    Dim sCurDir As String\n    Dim i       As Integer\n\n        If sPath <> \"\" Then\n            aDirs=Split(sPath, \"\\\")\n            If Left(sPath,2)=\"\\\\\" Then\n                iStart=3\n            Else\n                iStart=1\n            End If\n\n            sCurDir=Left(sPath,InStr(iStart,sPath,\"\\\")\n                For i=iStart to UBound(aDirs)\n                    sCurDir = sCurDir & aDirs(i) & \"\\\"\n                    If Dir(sCurDir, vbDirectory)=vbNullString Then\n                        MkDir sCurDir\n                    End If \n                Next\n         End If\nEnd Sub\n\n\n\u3010\u30d5\u30a9\u30eb\u30c0\u5185\u306e\u30b5\u30d6\u30d5\u30a9\u30eb\u30c0\u6570\u3092\u53d6\u5f97\u3059\u308b\u3011\n\u3082\u3061\u308d\u3093\u3001\u30b5\u30d6\u30d5\u30a9\u30eb\u30c0\u540d\u3082\u53d6\u5f97\u3067\u304d\u307e\u3059\nFunction FolCnt(ByVal myFol As String) As Integer\n    Dim objFSO As Object\n    Dim objRoot As Object\n\n    Set objFSO=CreateObject(\"Scripting.FileSystemObject\")\n    Set objFolder=objFSO\n    Set objRoot=objFSO.GetFolder(myFol)\n\n    myCnt=0\n\n    For Each Fol In objRoot.SubFolders\n        Debug.Print Fol\n        If Fol.Name Like \"*\u307b\u3052\u307b\u3052*\" Then\n            myCnt = myCnt + 1\n        End If\n   Next Fol\n\n   FolCnt = myCnt\n\nEnd Function\n\n\n\u3010\u30d5\u30a1\u30a4\u30eb\u306e\u30bf\u30a4\u30e0\u30b9\u30bf\u30f3\u30d7\u3092\u53d6\u5f97\u3059\u308b\u3011\nSub GetFileTimeStamp()\n\nDim objFileSys As Object\nDim strScriptPath As String\nDim strFilePath   As String\nDim objFile       As Object\n\nSet objFileSys = CreateObject(\"Scripting.FileSystemObject\")\n    strScriptPath=\"C:\\aaa\\bbb\\\"\n\n    strFilePath=objFileSys.BuildPath(strScriptPath, \"aaa.xlsx\")\n    Set objFile = objFileSys.GetFile(strFilePath)\n\n    Debug.Print \"\u4f5c\u6210\u65e5:\" & objFile.DateCreated\n    Debug.Print \"\u6700\u7d42\u30a2\u30af\u30bb\u30b9:\" & objFile.DateLastAccessed\n    Debug.Print \"\u6700\u7d42\u66f4\u65b0\u65e5:\" & objFile.DateLastModified\n\nSet objFile = Nothing\nSet objFileSys = Nothing\n\nEnd Sub\n\n\u6bce\u5ea6\u6bce\u5ea6\u3001\u601d\u3044\u51fa\u3059\u306e\u3082\u9762\u5012\u306a\u306e\u3067\u3002\u30d5\u30a1\u30a4\u30eb\u64cd\u4f5c\u3067\u3088\u304f\u4f7f\u3046\u30de\u30af\u30ed\u4e00\u5f0f\u3067\u3059\u3002\n\n#####\u3010\u30d5\u30a9\u30eb\u30c0\u524a\u9664\u3011\nmyFol=\u5f15\u6570\u306f\u30d5\u30eb\u30d1\u30b9\u306b\u3057\u307e\u3059\n\n```\nFunction FolderDelete(ByVal myFol As String)\n    Set objFile=CreateObject(\"Scripting.FileSystemObject\")\n         If objFile.FolderExists(myFol) Then\n             objFile.GetFolder(myFol).Delete\n         End If\n    Set objFile=Nothing\nEnd Function\n```\n\n#####\u3010\u30d5\u30a1\u30a4\u30eb\u30b3\u30d4\u30fc\u3011  \nsrcFile,dstFile\u3082\u30d5\u30eb\u30d1\u30b9\u6307\u5b9a\n\n```\nFunction FileCopy(ByVal srcFile As String, ByVal dstFile As String)\n    Set objFS=CreateObject(\"Scripting.FileSystemObject\")\n        objFS.CopyFile srcFile, dstFile\n    Set objFS=Nothing\nEnd Function\n```\n\n#####\u3010\u30d5\u30a1\u30a4\u30eb\u79fb\u52d5\u3011\n\n```\nFunction FileMove(ByVal srcFile As String, ByVal dstFile As String)\n    Set objFS=CreateObject(\"Scripting.FileSystemObject\")\n        objFS.MoveFile srcFile, dstFile\n    Set objFS=Nothing\nEnd Function\n```\n\n#####\u3010\u30d5\u30a9\u30eb\u30c0\u4f5c\u6210\u3011 \n\u6df1\u3044\u30cd\u30b9\u30c8\u307e\u3067\u4e00\u6c17\u306b\u4f5c\u6210(\u89aa\u30d5\u30a9\u30eb\u30c0\u304c\u5b58\u5728\u3057\u306a\u3051\u308c\u3070\u4f5c\u308b\uff09\n\n```\nSub myMkDir(ByVal sPath as String)\n    Dim iStart  As Integer\n    Dim aDirs   As Variant\n    Dim sCurDir As String\n    Dim i       As Integer\n   \n        If sPath <> \"\" Then\n            aDirs=Split(sPath, \"\\\")\n            If Left(sPath,2)=\"\\\\\" Then\n                iStart=3\n            Else\n                iStart=1\n            End If\n\n            sCurDir=Left(sPath,InStr(iStart,sPath,\"\\\")\n                For i=iStart to UBound(aDirs)\n                    sCurDir = sCurDir & aDirs(i) & \"\\\"\n                    If Dir(sCurDir, vbDirectory)=vbNullString Then\n                        MkDir sCurDir\n                    End If \n                Next\n         End If\nEnd Sub\n```\n\n#####\u3010\u30d5\u30a9\u30eb\u30c0\u5185\u306e\u30b5\u30d6\u30d5\u30a9\u30eb\u30c0\u6570\u3092\u53d6\u5f97\u3059\u308b\u3011\n\u3082\u3061\u308d\u3093\u3001\u30b5\u30d6\u30d5\u30a9\u30eb\u30c0\u540d\u3082\u53d6\u5f97\u3067\u304d\u307e\u3059\n\n```\nFunction FolCnt(ByVal myFol As String) As Integer\n    Dim objFSO As Object\n    Dim objRoot As Object\n\n    Set objFSO=CreateObject(\"Scripting.FileSystemObject\")\n    Set objFolder=objFSO\n    Set objRoot=objFSO.GetFolder(myFol)\n\n    myCnt=0\n\n    For Each Fol In objRoot.SubFolders\n        Debug.Print Fol\n        If Fol.Name Like \"*\u307b\u3052\u307b\u3052*\" Then\n            myCnt = myCnt + 1\n        End If\n   Next Fol\n\n   FolCnt = myCnt\n\nEnd Function\n```\n\n#####\u3010\u30d5\u30a1\u30a4\u30eb\u306e\u30bf\u30a4\u30e0\u30b9\u30bf\u30f3\u30d7\u3092\u53d6\u5f97\u3059\u308b\u3011\n\n```\nSub GetFileTimeStamp()\n\nDim objFileSys As Object\nDim strScriptPath As String\nDim strFilePath   As String\nDim objFile       As Object\n\nSet objFileSys = CreateObject(\"Scripting.FileSystemObject\")\n    strScriptPath=\"C:\\aaa\\bbb\\\"\n    \n    strFilePath=objFileSys.BuildPath(strScriptPath, \"aaa.xlsx\")\n    Set objFile = objFileSys.GetFile(strFilePath)\n\n    Debug.Print \"\u4f5c\u6210\u65e5:\" & objFile.DateCreated\n    Debug.Print \"\u6700\u7d42\u30a2\u30af\u30bb\u30b9:\" & objFile.DateLastAccessed\n    Debug.Print \"\u6700\u7d42\u66f4\u65b0\u65e5:\" & objFile.DateLastModified\n\nSet objFile = Nothing\nSet objFileSys = Nothing\n\nEnd Sub\n```\n\n\n\n\n"}