{"context": " More than 1 year has passed since last update.\n\n\u80cc\u666f\nmackerel\u306f\u516c\u5f0f\u30d7\u30e9\u30b0\u30a4\u30f3\u3067\u7c21\u5358\u306bmysqld\u3092\u76e3\u8996\u3067\u304d\u308b\u3002\n\nmackerel-pluguin-mysql\n\n\u3057\u304b\u3057\u3001\u30c7\u30d5\u30a9\u30eb\u30c8\u8a2d\u5b9a\u3067\u306froot\u30e6\u30fc\u30b6\u30fc\u3092\u4f7f\u3063\u3066\u3057\u307e\u3046\u306e\u3067\u3001\u5225\u9014\u30e6\u30fc\u30b6\u30fc\u3092\u4f5c\u6210\u3059\u308b\u3053\u3068\u306b\u3057\u305f\u3002\n\n\u4f5c\u696d\u624b\u9806\n\nmysql\u5074\u306e\u30e6\u30fc\u30b6\u30fc\u4f5c\u6210\nmysql\u306b\u7279\u6a29\u3067\u30ed\u30b0\u30a4\u30f3\u3002\u4ee5\u4e0b\u306f\u4f8b\u306a\u306e\u3067\u3001\u74b0\u5883\u306b\u5408\u308f\u305b\u3066\u3002\n$ mysql -u root\n\n\u30e6\u30fc\u30b6\u30fc\u3092\u4f5c\u308b\u3002\u4ee5\u4e0b\u306e\u4f8b\u3067\u306f\u300emonitor_user\u300f\u3068\u3044\u3046\u540d\u524d\u306b\u3057\u305f\u3002\nmysql> create user 'monitor_user'@'127.0.0.1';\nmysql> grant PROCESS, REPLICATION CLIENT on *.* to 'monitor_user'@'127.0.0.1';\nmysql> flush privileges;\n\n\u3069\u3046\u305b\u30ed\u30fc\u30ab\u30eb\u30db\u30b9\u30c8\u3060\u3057\u3001mackerel-plugin\u5074\u306b\u5e73\u6587\u3067\u30d1\u30b9\u30ef\u30fc\u30c9\u3092\u66f8\u304f\u5fc5\u8981\u304c\u3042\u308b\u306e\u3067\u3001\u30d1\u30b9\u30ef\u30fc\u30c9\u8a2d\u5b9a\u306f\u306a\u3057\u3002\n\u203b \u6a29\u9650\u306b\u904e\u4e0d\u8db3\u304c\u3042\u308c\u3070\u6559\u3048\u3066\u4e0b\u3055\u3044\u3002\n\n\u30c6\u30b9\u30c8\n$ /usr/local/bin/mackerel-plugin-mysql -username=monitor_user -tempfile /tmp/mackerel-plugin-mysql-localhost-3306\nmysql.innodb_lock_structures.innodb_lock_structs    0   1434080228\nmysql.innodb_adaptive_hash_index.hash_index_cells_total 34679   1434080228\nmysql.innodb_adaptive_hash_index.hash_index_cells_used  0   1434080228\nmysql.innodb_buffer_pool_read.read_ahead    0   1434080228\n\u4ee5\u4e0b\u7565\n\n\u3044\u3063\u3071\u3044\u51fa\u308c\u3070OK\u3002\u6a29\u9650\u30a8\u30e9\u30fc\u304c\u51fa\u305f\u3089\u6a29\u9650\u4e0d\u8db3\u3002\ntempfile\u4f5c\u6210\u3067permission denied\u306e\u6642\u306fsudo\u3068\u304b\u3057\u306a\u3044\u3068\u30c0\u30e1\u304b\u3068\u3002\n\nmackerel-agent\u3078\u306e\u8a2d\u5b9a\u9069\u7528\nmackerel-agent.conf\u3092\u4fee\u6b63\u3059\u308b\u3002\n\n/etc/mackerel-agent/mackerel-agent.conf\n[plugin.metrics.mysql]\ncommand = \"/usr/local/bin/mackerel-plugin-mysql -username=monitor_user\"\n\n\n\u8a2d\u5b9a\u9069\u7528\n$ service mackerel-agent restart\n\n\n#\u80cc\u666f\n\nmackerel\u306f\u516c\u5f0f\u30d7\u30e9\u30b0\u30a4\u30f3\u3067\u7c21\u5358\u306bmysqld\u3092\u76e3\u8996\u3067\u304d\u308b\u3002\n\n* [mackerel-pluguin-mysql](https://github.com/mackerelio/mackerel-agent-plugins/tree/master/mackerel-plugin-mysql)\n\n\u3057\u304b\u3057\u3001\u30c7\u30d5\u30a9\u30eb\u30c8\u8a2d\u5b9a\u3067\u306froot\u30e6\u30fc\u30b6\u30fc\u3092\u4f7f\u3063\u3066\u3057\u307e\u3046\u306e\u3067\u3001\u5225\u9014\u30e6\u30fc\u30b6\u30fc\u3092\u4f5c\u6210\u3059\u308b\u3053\u3068\u306b\u3057\u305f\u3002\n\n#\u4f5c\u696d\u624b\u9806\n\n## mysql\u5074\u306e\u30e6\u30fc\u30b6\u30fc\u4f5c\u6210\n\nmysql\u306b\u7279\u6a29\u3067\u30ed\u30b0\u30a4\u30f3\u3002\u4ee5\u4e0b\u306f\u4f8b\u306a\u306e\u3067\u3001\u74b0\u5883\u306b\u5408\u308f\u305b\u3066\u3002\n\n```bash\n$ mysql -u root\n```\n\n\u30e6\u30fc\u30b6\u30fc\u3092\u4f5c\u308b\u3002\u4ee5\u4e0b\u306e\u4f8b\u3067\u306f\u300emonitor_user\u300f\u3068\u3044\u3046\u540d\u524d\u306b\u3057\u305f\u3002\n\n```mysql\nmysql> create user 'monitor_user'@'127.0.0.1';\nmysql> grant PROCESS, REPLICATION CLIENT on *.* to 'monitor_user'@'127.0.0.1';\nmysql> flush privileges;\n```\n\n\u3069\u3046\u305b\u30ed\u30fc\u30ab\u30eb\u30db\u30b9\u30c8\u3060\u3057\u3001mackerel-plugin\u5074\u306b\u5e73\u6587\u3067\u30d1\u30b9\u30ef\u30fc\u30c9\u3092\u66f8\u304f\u5fc5\u8981\u304c\u3042\u308b\u306e\u3067\u3001\u30d1\u30b9\u30ef\u30fc\u30c9\u8a2d\u5b9a\u306f\u306a\u3057\u3002\n\u203b \u6a29\u9650\u306b\u904e\u4e0d\u8db3\u304c\u3042\u308c\u3070\u6559\u3048\u3066\u4e0b\u3055\u3044\u3002\n\n\n## \u30c6\u30b9\u30c8\n\n```bash\n$ /usr/local/bin/mackerel-plugin-mysql -username=monitor_user -tempfile /tmp/mackerel-plugin-mysql-localhost-3306\nmysql.innodb_lock_structures.innodb_lock_structs\t0\t1434080228\nmysql.innodb_adaptive_hash_index.hash_index_cells_total\t34679\t1434080228\nmysql.innodb_adaptive_hash_index.hash_index_cells_used\t0\t1434080228\nmysql.innodb_buffer_pool_read.read_ahead\t0\t1434080228\n\u4ee5\u4e0b\u7565\n```\n\n\u3044\u3063\u3071\u3044\u51fa\u308c\u3070OK\u3002\u6a29\u9650\u30a8\u30e9\u30fc\u304c\u51fa\u305f\u3089\u6a29\u9650\u4e0d\u8db3\u3002\ntempfile\u4f5c\u6210\u3067permission denied\u306e\u6642\u306fsudo\u3068\u304b\u3057\u306a\u3044\u3068\u30c0\u30e1\u304b\u3068\u3002\n\n## mackerel-agent\u3078\u306e\u8a2d\u5b9a\u9069\u7528\n\nmackerel-agent.conf\u3092\u4fee\u6b63\u3059\u308b\u3002\n\n```/etc/mackerel-agent/mackerel-agent.conf\n[plugin.metrics.mysql]\ncommand = \"/usr/local/bin/mackerel-plugin-mysql -username=monitor_user\"\n```\n\n\u8a2d\u5b9a\u9069\u7528\n\n```bash\n$ service mackerel-agent restart\n```\n", "tags": ["Mackerel", "MySQL"]}