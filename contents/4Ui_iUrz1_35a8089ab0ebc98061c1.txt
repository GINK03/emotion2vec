{"context": "\u6700\u8fd1TensorFlow\u3092\u4f7f\u3044\u59cb\u3081\u305f\u306e\u3067\u3059\u304c\uff0c\u5b66\u7fd2\u4e2d\u306b\u7a81\u7136\u7cbe\u5ea6\u304c\u4f4e\u4e0b\u3057\u3066\u5909\u308f\u3089\u306a\u304f\u306a\u308b\u554f\u984c\u304c\u8d77\u304d\u3066\u3044\u307e\u3057\u305f\uff0e\n\u4ee5\u4e0b\u3060\u306870\u30b9\u30c6\u30c3\u30d7\u76ee\u304b\u3089\u7a81\u7136\u7cbe\u5ea6\u304c\u4f4e\u4e0b\u3057\u3066\u307e\u3059\uff0e\n.\n.\n.\nstep:67 train:0.894584 test:0.756296\nstep:68 train:0.900654 test:0.756944\nstep:69 train:0.897526 test:0.758796\nstep:70 train:0.361345 test:0.333333\nstep:71 train:0.361345 test:0.333333\nstep:72 train:0.361345 test:0.333333\nstep:73 train:0.361345 test:0.333333\n.\n.\n.\n\n\u91cd\u307f\u3092\u898b\u3066\u307f\u308b\u3068\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u306a\u3063\u3066\u3044\u307e\u3057\u305f\uff0e\n(pdb) w1\narray([[[[ nan,  nan,  nan, ...,  nan,  nan,  nan],\n         [ nan,  nan,  nan, ...,  nan,  nan,  nan],\n         [ nan,  nan,  nan, ...,  nan,  nan,  nan]],\n\n        [[ nan,  nan,  nan, ...,  nan,  nan,  nan],\n         [ nan,  nan,  nan, ...,  nan,  nan,  nan],\n         [ nan,  nan,  nan, ...,  nan,  nan,  nan]], \n.\n.\n.\n\nNaN\u306b\u306a\u3063\u3066\u3044\u308b\u3068\u3044\u3046\u3053\u3068\u3067\uff0c\"tensorflow nan\"\u3067\u691c\u7d22\u3057\u3066\u307f\u308b\u3068\u89e3\u6c7a\u65b9\u6cd5\u304c\u51fa\u3066\u304d\u307e\u3057\u305f\uff0e\nhttp://stackoverflow.com/questions/33712178/tensorflow-nan-bug\n\u554f\u984c\u7b87\u6240\u306f\u4ea4\u5dee\u30a8\u30f3\u30c8\u30ed\u30d4\u30fc\u306e\u8a08\u7b97\u90e8\u5206\u3067\u3042\u308a\uff0c\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u3057\u3066\u3044\u307e\u3057\u305f(y_conv\u306fsoftmax\u95a2\u6570\u306b\u3088\u308b\u5404\u30e9\u30d9\u30eb\u306e\u78ba\u7387)\uff0e\ncross_entropy = -tf.reduce_sum(labels*tf.log(y_conv))\n\n\u3053\u306e\u307e\u307e\u3060\u3068log(0)\u306b\u306a\u308a\uff0cNaN\u304c\u51fa\u3066\u304f\u308b\u53ef\u80fd\u6027\u304c\u3042\u308a\u307e\u3059\uff0e\n\u305d\u3053\u3067\uff0c\u4ee5\u4e0b\u306e\u3088\u3046\u306b1e-10~1.0\u306e\u7bc4\u56f2\u306b\u6b63\u898f\u5316\u3057\u3066\u304b\u3089log\u3092\u3068\u308b\u3053\u3068\u3067\u89e3\u6c7a\u3067\u304d\u307e\u3057\u305f\uff0e\ncross_entropy = -tf.reduce_sum(labels*tf.log(tf.clip_by_value(y_conv,1e-10,1.0)))\n\ntf.nn.softmax_cross_entropy_with_logits\u3068\u3044\u3046\u95a2\u6570\u304c\u3042\u308a\uff0c\u305d\u308c\u3092\u4f7f\u3063\u3066\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u3057\u305f\u65b9\u304c\u3044\u3044\u307f\u305f\u3044\u3067\u3059\uff0e \u2192\u3053\u306e\u65b9\u6cd5\u3060\u3068\u3046\u307e\u304f\u3044\u304d\u307e\u305b\u3093\u3067\u3057\u305f\uff0e\n\u6700\u8fd1TensorFlow\u3092\u4f7f\u3044\u59cb\u3081\u305f\u306e\u3067\u3059\u304c\uff0c\u5b66\u7fd2\u4e2d\u306b\u7a81\u7136\u7cbe\u5ea6\u304c\u4f4e\u4e0b\u3057\u3066\u5909\u308f\u3089\u306a\u304f\u306a\u308b\u554f\u984c\u304c\u8d77\u304d\u3066\u3044\u307e\u3057\u305f\uff0e\n\u4ee5\u4e0b\u3060\u306870\u30b9\u30c6\u30c3\u30d7\u76ee\u304b\u3089\u7a81\u7136\u7cbe\u5ea6\u304c\u4f4e\u4e0b\u3057\u3066\u307e\u3059\uff0e\n\n```\n.\n.\n.\nstep:67 train:0.894584 test:0.756296\nstep:68 train:0.900654 test:0.756944\nstep:69 train:0.897526 test:0.758796\nstep:70 train:0.361345 test:0.333333\nstep:71 train:0.361345 test:0.333333\nstep:72 train:0.361345 test:0.333333\nstep:73 train:0.361345 test:0.333333\n.\n.\n.\n```\n\n\u91cd\u307f\u3092\u898b\u3066\u307f\u308b\u3068\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u306a\u3063\u3066\u3044\u307e\u3057\u305f\uff0e\n\n```\n(pdb) w1\narray([[[[ nan,  nan,  nan, ...,  nan,  nan,  nan],\n         [ nan,  nan,  nan, ...,  nan,  nan,  nan],\n         [ nan,  nan,  nan, ...,  nan,  nan,  nan]],\n\n        [[ nan,  nan,  nan, ...,  nan,  nan,  nan],\n         [ nan,  nan,  nan, ...,  nan,  nan,  nan],\n         [ nan,  nan,  nan, ...,  nan,  nan,  nan]], \n.\n.\n.\n```\n\nNaN\u306b\u306a\u3063\u3066\u3044\u308b\u3068\u3044\u3046\u3053\u3068\u3067\uff0c\"tensorflow nan\"\u3067\u691c\u7d22\u3057\u3066\u307f\u308b\u3068\u89e3\u6c7a\u65b9\u6cd5\u304c\u51fa\u3066\u304d\u307e\u3057\u305f\uff0e\nhttp://stackoverflow.com/questions/33712178/tensorflow-nan-bug\n\n\u554f\u984c\u7b87\u6240\u306f\u4ea4\u5dee\u30a8\u30f3\u30c8\u30ed\u30d4\u30fc\u306e\u8a08\u7b97\u90e8\u5206\u3067\u3042\u308a\uff0c\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u3057\u3066\u3044\u307e\u3057\u305f(y_conv\u306fsoftmax\u95a2\u6570\u306b\u3088\u308b\u5404\u30e9\u30d9\u30eb\u306e\u78ba\u7387)\uff0e\n\n```py3:\ncross_entropy = -tf.reduce_sum(labels*tf.log(y_conv))\n```\n\n\u3053\u306e\u307e\u307e\u3060\u3068log(0)\u306b\u306a\u308a\uff0cNaN\u304c\u51fa\u3066\u304f\u308b\u53ef\u80fd\u6027\u304c\u3042\u308a\u307e\u3059\uff0e\n\u305d\u3053\u3067\uff0c\u4ee5\u4e0b\u306e\u3088\u3046\u306b1e-10~1.0\u306e\u7bc4\u56f2\u306b\u6b63\u898f\u5316\u3057\u3066\u304b\u3089log\u3092\u3068\u308b\u3053\u3068\u3067\u89e3\u6c7a\u3067\u304d\u307e\u3057\u305f\uff0e\n\n```py3:\ncross_entropy = -tf.reduce_sum(labels*tf.log(tf.clip_by_value(y_conv,1e-10,1.0)))\n```\n\n~~tf.nn.softmax_cross_entropy_with_logits\u3068\u3044\u3046\u95a2\u6570\u304c\u3042\u308a\uff0c\u305d\u308c\u3092\u4f7f\u3063\u3066\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u3057\u305f\u65b9\u304c\u3044\u3044\u307f\u305f\u3044\u3067\u3059\uff0e~~ \u2192\u3053\u306e\u65b9\u6cd5\u3060\u3068\u3046\u307e\u304f\u3044\u304d\u307e\u305b\u3093\u3067\u3057\u305f\uff0e\n", "tags": ["TensorFlow", "Python", "python3", "\u6a5f\u68b0\u5b66\u7fd2", "performance"]}