{"tags": ["CentOS", "openssl", "nginx", "http2"], "context": "\n\n\u74b0\u5883\n\nCentOS 6.8\nopenssl 1.0.1(yum\u304b\u3089\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb)\u2192openssl 1.0.2\nnginx 1.11.3(yum\u304b\u3089\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb)\u2192nginx 1.11.4\uff082016/09/20\u6642\u70b9\u6700\u65b0\u7248\uff09\n\n\nopenssl\u306e\u8a2d\u5b9a\ncd /usr/local/src\nsudo wget https://www.openssl.org/source/openssl-1.0.2-latest.tar.gz\nsudo tar -zxf openssl-1.0.2-latest.tar.gz\n\nopenssl\u306f\u4ee5\u4e0a\u3002\n\nnginx\u306e\u8a2d\u5b9a\nhttp://nginx.org/en/download.html\n\u4e0a\u8a18\u304b\u3089\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u305f\u3044\u30d0\u30fc\u30b8\u30e7\u30f3\u3092\u9078\u629e\u3002\ncd /usr/local/src\nsudo wget http://nginx.org/download/nginx-1.11.4.tar.gz\nsudo tar -zxf nginx-1.11.4.tar.gz\n\n\nnjs\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\nnginx\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u306b\u5fc5\u8981\u306a\u3001njs\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3002\n\u81ea\u5206\u306e\u74b0\u5883\u3067\u306f1.0.1\u3060\u3063\u305f\u306e\u3067\u4e0b\u8a18\u8a2d\u5b9a\u3092\u3057\u307e\u3057\u305f\u3002\uff08nginx -V\u3067\u78ba\u8a8d\uff09\nhttp://hg.nginx.org/njs/rev/cdb8d20935ee\ncd /usr/local/src\nsudo wget http://hg.nginx.org/njs/archive/cdb8d20935ee.tar.gz\nsudo tar -zxf cdb8d20935ee.tar.gz\n\nsudo mv ./njs-cdb8d20935ee ./nginx-1.11.4\ncd ./nginx-1.11.4\nsudo mv njs-cdb8d20935ee njs-0.1.0\ncd ./nginx-1.11.4/njs-0.1.0\nsudo ./configure\n\n\n\nnginx\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\nnginx -V\u3067configure\u306e\u8a2d\u5b9a\u3092\u78ba\u8a8d\u3057\u3001--with-openssl=/usr/local/src/openssl-1.0.2h\u3092\u8ffd\u52a0\u3059\u308b\uff08openssl\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u306f\u78ba\u8a8d\u3057\u3066\u304f\u3060\u3055\u3044\uff09\ncd ../\nsudo ./configure --prefix=/etc/nginx --sbin-path=/usr/sbin/nginx --modules-path=/usr/lib64/nginx/modules --conf-path=/etc/nginx/nginx.conf --error-log-path=/var/log/nginx/error.log --http-log-path=/var/log/nginx/access.log --pid-path=/var/run/nginx.pid --lock-path=/var/run/nginx.lock --http-client-body-temp-path=/var/cache/nginx/client_temp --http-proxy-temp-path=/var/cache/nginx/proxy_temp --http-fastcgi-temp-path=/var/cache/nginx/fastcgi_temp --http-uwsgi-temp-path=/var/cache/nginx/uwsgi_temp --http-scgi-temp-path=/var/cache/nginx/scgi_temp --user=nginx --group=nginx --with-http_ssl_module --with-http_realip_module --with-http_addition_module --with-http_sub_module --with-http_dav_module --with-http_flv_module --with-http_mp4_module --with-http_gunzip_module --with-http_gzip_static_module --with-http_random_index_module --with-http_secure_link_module --with-http_stub_status_module --with-http_auth_request_module --with-http_xslt_module=dynamic --with-http_image_filter_module=dynamic --with-http_geoip_module=dynamic --with-http_perl_module=dynamic --add-dynamic-module=njs-0.1.0/nginx --with-threads --with-stream --with-stream_ssl_module --with-stream_geoip_module=dynamic --with-http_slice_module --with-mail --with-mail_ssl_module --with-file-aio --with-ipv6 --with-http_v2_module --with-cc-opt='-O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic' --with-openssl=/usr/local/src/openssl-1.0.2h\nsudo make\nsudo make install\n\n\nnginx\u306e\u30ea\u30b9\u30bf\u30fc\u30c8\nsudo service restart nginx\nnginx -v\n\n\u4e0a\u8a18\u30671.11.4\u306b\u5207\u308a\u66ff\u308f\u3063\u3066\u3044\u308b\u304b\u78ba\u8a8d\u3002\n\n.conf\u30d5\u30a1\u30a4\u30eb\u306e\u8a2d\u5b9a\n\u3042\u3068\u306fnginx\u306e\u8a2d\u5b9a\uff08nginx.conf\u3084sites-available/*.conf\uff09\u306b\u3001\nlisten 443 ssl http2;\n\nhttp2\u3092\u8ffd\u52a0\u3057\u3066\u3042\u3052\u308c\u3070\u7121\u4e8bHTTP/2\u3067\u30b5\u30fc\u30d0\u30fc\u304c\u52d5\u4f5c\u3057\u307e\u3059\u3002\n\n\u5feb\u9069HTTP/2\u30e9\u30a4\u30d5\u3092\uff01\n## \u74b0\u5883\n- CentOS 6.8\n- openssl 1.0.1(yum\u304b\u3089\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb)\u2192openssl 1.0.2\n- nginx 1.11.3(yum\u304b\u3089\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb)\u2192nginx 1.11.4\uff082016/09/20\u6642\u70b9\u6700\u65b0\u7248\uff09\n\n## openssl\u306e\u8a2d\u5b9a\n\n```\ncd /usr/local/src\nsudo wget https://www.openssl.org/source/openssl-1.0.2-latest.tar.gz\nsudo tar -zxf openssl-1.0.2-latest.tar.gz\n```\n\nopenssl\u306f\u4ee5\u4e0a\u3002\n\n## nginx\u306e\u8a2d\u5b9a\n\nhttp://nginx.org/en/download.html\n\n\u4e0a\u8a18\u304b\u3089\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u305f\u3044\u30d0\u30fc\u30b8\u30e7\u30f3\u3092\u9078\u629e\u3002\n\n```\ncd /usr/local/src\nsudo wget http://nginx.org/download/nginx-1.11.4.tar.gz\nsudo tar -zxf nginx-1.11.4.tar.gz\n```\n\n### njs\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\nnginx\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u306b\u5fc5\u8981\u306a\u3001njs\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3002\n\u81ea\u5206\u306e\u74b0\u5883\u3067\u306f1.0.1\u3060\u3063\u305f\u306e\u3067\u4e0b\u8a18\u8a2d\u5b9a\u3092\u3057\u307e\u3057\u305f\u3002\uff08nginx -V\u3067\u78ba\u8a8d\uff09\n\nhttp://hg.nginx.org/njs/rev/cdb8d20935ee\n\n```\ncd /usr/local/src\nsudo wget http://hg.nginx.org/njs/archive/cdb8d20935ee.tar.gz\nsudo tar -zxf cdb8d20935ee.tar.gz\n\nsudo mv ./njs-cdb8d20935ee ./nginx-1.11.4\ncd ./nginx-1.11.4\nsudo mv njs-cdb8d20935ee njs-0.1.0\ncd ./nginx-1.11.4/njs-0.1.0\nsudo ./configure\n\n```\n\n\n### nginx\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\nnginx -V\u3067configure\u306e\u8a2d\u5b9a\u3092\u78ba\u8a8d\u3057\u3001--with-openssl=/usr/local/src/openssl-1.0.2h\u3092\u8ffd\u52a0\u3059\u308b\uff08openssl\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u306f\u78ba\u8a8d\u3057\u3066\u304f\u3060\u3055\u3044\uff09\n\n```\ncd ../\nsudo ./configure --prefix=/etc/nginx --sbin-path=/usr/sbin/nginx --modules-path=/usr/lib64/nginx/modules --conf-path=/etc/nginx/nginx.conf --error-log-path=/var/log/nginx/error.log --http-log-path=/var/log/nginx/access.log --pid-path=/var/run/nginx.pid --lock-path=/var/run/nginx.lock --http-client-body-temp-path=/var/cache/nginx/client_temp --http-proxy-temp-path=/var/cache/nginx/proxy_temp --http-fastcgi-temp-path=/var/cache/nginx/fastcgi_temp --http-uwsgi-temp-path=/var/cache/nginx/uwsgi_temp --http-scgi-temp-path=/var/cache/nginx/scgi_temp --user=nginx --group=nginx --with-http_ssl_module --with-http_realip_module --with-http_addition_module --with-http_sub_module --with-http_dav_module --with-http_flv_module --with-http_mp4_module --with-http_gunzip_module --with-http_gzip_static_module --with-http_random_index_module --with-http_secure_link_module --with-http_stub_status_module --with-http_auth_request_module --with-http_xslt_module=dynamic --with-http_image_filter_module=dynamic --with-http_geoip_module=dynamic --with-http_perl_module=dynamic --add-dynamic-module=njs-0.1.0/nginx --with-threads --with-stream --with-stream_ssl_module --with-stream_geoip_module=dynamic --with-http_slice_module --with-mail --with-mail_ssl_module --with-file-aio --with-ipv6 --with-http_v2_module --with-cc-opt='-O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic' --with-openssl=/usr/local/src/openssl-1.0.2h\nsudo make\nsudo make install\n```\n\n### nginx\u306e\u30ea\u30b9\u30bf\u30fc\u30c8\n\n```\nsudo service restart nginx\nnginx -v\n```\n\n\u4e0a\u8a18\u30671.11.4\u306b\u5207\u308a\u66ff\u308f\u3063\u3066\u3044\u308b\u304b\u78ba\u8a8d\u3002\n\n### .conf\u30d5\u30a1\u30a4\u30eb\u306e\u8a2d\u5b9a\n\n\u3042\u3068\u306fnginx\u306e\u8a2d\u5b9a\uff08nginx.conf\u3084sites-available/*.conf\uff09\u306b\u3001\n\n```\nlisten 443 ssl http2;\n```\n\nhttp2\u3092\u8ffd\u52a0\u3057\u3066\u3042\u3052\u308c\u3070\u7121\u4e8bHTTP/2\u3067\u30b5\u30fc\u30d0\u30fc\u304c\u52d5\u4f5c\u3057\u307e\u3059\u3002\n![_tanshio_2016-9\u6708-20.jpg](https://qiita-image-store.s3.amazonaws.com/0/39134/5e8a5192-55be-53db-678c-ab42705dcbdc.jpeg)\n\u5feb\u9069HTTP/2\u30e9\u30a4\u30d5\u3092\uff01\n\n"}