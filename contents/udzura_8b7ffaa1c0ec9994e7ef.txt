{"context": " More than 1 year has passed since last update.\n\nDokku \u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\u516c\u5f0f \u306e\u901a\u308a\u3001 Ubuntu 14.04 \u3067\u3042\u308c\u3070\u306a\u306b\u3082\u8003\u3048\u306a\u304f\u3066\u3082\u5165\u308b\u3002\n$ wget -qO- https://raw.github.com/progrium/dokku/v0.2.3/bootstrap.sh | sudo DOKKU_TAG=v0.2.3 bash\n\n\u4f8b\u3048\u3070\u3001 dokku.example.local \u3068\u3044\u3046\u30c9\u30e1\u56e0\u3067\u89e3\u6c7a\u3067\u304d\u308b\u3088\u3046\u306a\u30b5\u30fc\u30d0\u306bDokku\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u3066\u304a\u3051\u3070\u3001\u52dd\u624b\u306b /home/dokku/VHOST \u306e\u4e2d\u8eab\u304c dokku.example.local \u306b\u306a\u308b\uff08\u5927\u4e8b\u306a\u90e8\u5206\uff09\u3002\u30a2\u30d7\u30ea\u3092\u30c7\u30d7\u30ed\u30a4\u3057\u305f\u3089 foobar.dokku.example.local \u3068\u3044\u3046\u3068\u3053\u308d\u306b\u30db\u30b9\u30c8\u3055\u308c\u308b\u3002\n\u3067\u3001\u305d\u306e\u3042\u3068\u3001Heroku\u4e26\u307f\u306b\u7c21\u5358\u306b\u30c7\u30d7\u30ed\u30a4\u3067\u304d\u308b\u3088\u3046\u306b\u3059\u308b\u307e\u3067\u304c\u82e5\u5e72\u3081\u3093\u3069\u3044\u306e\u3067\u8a73\u3057\u304f\u66f8\u3044\u3066\u304a\u304f\u3002\n\n\u516c\u958b\u9375\u3092\u767b\u9332\u3059\u308b\u3002\n\u3053\u306e\u307e\u307e\u3067\u306f\u30d7\u30c3\u30b7\u30e5\u3067\u304d\u306a\u3044\u306e\u3067\u767b\u9332\u3002dokku.example.local\u306b\u30ed\u30b0\u30a4\u30f3\u3057\u3066\u3053\u3093\u306a\u611f\u3058\u3067\u826f\u3044\u306e\u3067\u306f\u3002\ncurl https://github.com/udzura.keys | sudo sshcommand acl-add dokku udzura\n\ndokku@dokku.example.local \u306bSSH\u30ed\u30b0\u30a4\u30f3\u3067\u304d\u308b\u3088\u3046\u306b\u3059\u308b\u3002\n\u7814\u4fee\u3068\u304b\u3067\u4f7f\u3046\u5834\u5408\u3001\u3081\u3093\u3069~\u306a\u306e\u3067\u793e\u5185Dokku\u5c02\u7528\u306e\u516c\u958b\u9375\u3092\u767b\u9332\u3057\u3066\u79d8\u5bc6\u9375\u3092\u914d\u3063\u3066\u3082\u826f\u3044\u304b\u3082\u3002\n\n\u30d7\u30c3\u30b7\u30e5\u3057\u3066\u307f\u308b\n\u9069\u5f53\u306aSinatra\u30d7\u30ed\u30b8\u30a7\u30af\u30c8:\n\napp.rb\nrequire 'sinatra'\nget '/' do\n  \"Hello, from dokku!!\"\nend\n\n\n\nGemfile\nsource \"https://rubygems.org\"\nruby '2.1.1'\n\ngem 'sinatra'\n\n\n\nProcfile\nweb: bundle exec ruby app.rb -p $PORT\n\n\n\u307e\u308b\u3063\u304d\u308aheroku\u3068\u540c\u3058\u3082\u306e\u3002\u3053\u306eGit\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092\u3001\u3053\u3093\u306a\u611f\u3058\u3067\u30d7\u30c3\u30b7\u30e5\u3002sinatra-sample \u306f\u4efb\u610f\u3002\u305d\u3053\u306e\u540d\u524d\u304c\u305d\u306e\u307e\u307e\u30b5\u30d6\u30c9\u30e1\u9662\u306b\u306a\u308b\n$ git remote add dokku dokku@dokku.example.local:sinatra-sample\n$ git push dokku master\n\n\u3059\u308b\u3068\u306a\u3093\u304bHeroku\u3063\u307d\u3044\u8868\u793a\u304c\u51fa\u3066\u304f\u308b\u3002\nCounting objects: 5, done.\nDelta compression using up to 8 threads.\nCompressing objects: 100% (3/3), done.\nWriting objects: 100% (3/3), 323 bytes | 0 bytes/s, done.\nTotal 3 (delta 1), reused 0 (delta 0)\n-----> Cleaning up ...\nremote: Cloning into '/tmp/tmp.5eBkCHIIsz'...\n-----> Building sinatra-sample ...\nremote: done.\nremote: HEAD is now at 2c0f55f... Fix typo ooooo\n       Ruby app detected\n-----> Compiling Ruby/Rack\n-----> Using Ruby version: ruby-2.1.1\n-----> Installing dependencies using 1.5.2\n       Running: bundle install --without development:test --path vendor/bundle --binstubs vendor/bundle/bin -j4 --deployment\n       Using rack (1.5.2)\n       Using tilt (1.4.1)\n       Using bundler (1.5.2)\n...\n=====> Application deployed:\n       http://sinatra-sample.dokku.example.local\n\nHeroku\u3068\u540c\u3058buildpack\u3092\u4f7f\u3063\u3066\u3044\u308b\u306e\u3067\u3001\u5f53\u7136\u3068\u8a00\u3048\u3070\u5f53\u7136...\u3002\n\u3067\u3001\u3053\u306e sinatra-sample.dokku.example.local \u3092\u6211\u3005\u304c\u3053\u306e\u307e\u307e\u89e3\u6c7a\u3067\u304d\u308b\u8a33\u3082\u7121\u3044\u306e\u3067\u3001\u5168\u90e8\u30a8\u30c8\u30bb\u30db\u30b9\u30c4\u306b\u30a8\u30f3\u30c8\u30ea\u3092\u66f8\u3044\u3066\u3044\u3063\u3066\u3082\u826f\u3044\u3051\u3069\u3001\u5c11\u3057\u3060\u3051\u697d\u306a\u65b9\u6cd5\u306b\u3059\u308b\u3002\n\ndnsmasq \u3067 *.dokku.example.local \u3092\u5168\u90e8 dokku.example.local \u3068\u540c\u3058\u3068\u3053\u306b\u5411\u3051\u308b\nxip.io \u3092\u4f7f\u3046\u4eba\u3082\u591a\u3044\u307f\u305f\u3044\u3060\u3051\u3069\u3001\u3061\u3087\u3063\u3068... \u3068\u601d\u3063\u305f\u306e\u3067dnsmasq\u3092\u4f7f\u3044\u305f\u3044\u3002\n\u307e\u305a\u306f\u304a\u3082\u3080\u308d\u306b\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3002\u307f\u306a\u3055\u3093\u3082\u3061\u308d\u3093\u3001Mac.....\u3067\u3059\u3088\u306d...\n$ brew install dnsmasq\n$ cp /usr/local/opt/dnsmasq/dnsmasq.conf.example /usr/local/etc/dnsmasq.conf\n$ sudo cp -fv /usr/local/opt/dnsmasq/*.plist /Library/LaunchDaemons\n\n\u304a\u3082\u3080\u308d\u306b\u8a2d\u5b9a\u3001\u307c\u304f\u306f http://tell-k.hatenablog.com/entry/2014/04/28/002437 \u3092\u898b\u305f\u3002 dokku.example.local \u304c 192.168.0.123 \u306b\u5411\u3044\u3066\u3044\u308b\u524d\u63d0\u3067\u3002\n\ndnsmasq.conf\nbind-interfaces\naddress=/dokku.example.local/192.168.0.123\n\n\n/etc/resolver/dokku.example.local \u3068\u3044\u3046\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u308b\u3002\n\ndokku.example.local\nnameserver 127.0.0.1\n\n\n\u8d77\u52d5\u3002\nsudo launchctl load /Library/LaunchDaemons/homebrew.mxcl.dnsmasq.plist\n\n\u3053\u3053\u307e\u3067\u3057\u305f\u3089\u3001\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306e\u8a2d\u5b9a\u3067\u4e00\u756a\u76ee\u306eDNS\u3092 127.0.0.1 \u306b\u3059\u308b\u5fc5\u8981\u304c\u3042\u308b\u304b\u3082\u3002\u8981\u51fa\u5178\u3067\u3042\u308b...\u3002\n\n\u78ba\u8a8d\n$ dig @127.0.0.1 hogehoge.dokku.example.local                                 \n\n; <<>> DiG 9.8.3-P1 <<>> @127.0.0.1 hogehoge.dokku.example.local\n; (1 server found)\n;; global options: +cmd\n;; Got answer:\n;; ->>HEADER<<- opcode: QUERY, status: NOERROR, id: 20679\n;; flags: qr aa rd ra; QUERY: 1, ANSWER: 1, AUTHORITY: 0, ADDITIONAL: 0\n\n;; QUESTION SECTION:\n;hogehoge.dokku.example.local.         IN      A\n\n;; ANSWER SECTION:\nhogehoge.dokku.example.local.  0       IN      A       192.168.0.123\n...\n\n$ ping -c 1 sinatra-sample.dokku.example.local\nPING sinatra-sample.dokku.example.local (192.168.0.123): 56 data bytes\n64 bytes from 192.168.0.123: icmp_seq=0 ttl=59 time=23.631 ms\n\n\u3055\u3066\u3001\u304a\u3082\u3080\u308d\u306b http://sinatra-sample.dokku.example.local \u3092\u958b\u304f\u3068\u300cHello, from dokku!!\u300d\u3063\u3066\u51fa\u3066\u304f\u308b\u306f\u305a\u3002\u51fa\u3066\u304f\u308b\u3068\u826f\u3044\u3067\u3059\u306d\uff08Heroku\u3063\u307d\u304f\u521d\u56de\u30a2\u30af\u30bb\u30b9\u306b\u6642\u9593\u304c\u639b\u304b\u308b\u3002\u3053\u3093\u306a\u3068\u3053\u307e\u3067Heroku\u30af\u30ed\u30fc\u30f3\u306a\u306e...\uff09\u3002\n\nTroubleshoot: \u306a\u3093\u304b\u8d77\u52d5\u3057\u306a\u3044\n\u30ed\u30b0\u3092\u898b\u308b\u306b\u306f\u30ed\u30b0\u30a4\u30f3\u3057\u306a\u3044\u3068\u3044\u3051\u306a\u3044\u305e\u3046:\n$ ssh -t dokku@dokku.example.local logs sinatra-sample\n\n\u305d\u306e\u4ed6\u30b3\u30de\u30f3\u30c9\u304c\u8272\u3005\u3042\u308b\u306e\u3067 help \u3059\u308b\u3068\u826f\u3055\u305d\u3046\u3002\u30a8\u30a4\u30ea\u30a2\u30b9\u3092\u8cbc\u308c\u3070heroku\u30b3\u30de\u30f3\u30c9\u306e\u3088\u3046\u306b\u4f7f\u3048\u308b...\n### Dokku \u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n[\u516c\u5f0f](https://github.com/progrium/dokku) \u306e\u901a\u308a\u3001 Ubuntu 14.04 \u3067\u3042\u308c\u3070\u306a\u306b\u3082\u8003\u3048\u306a\u304f\u3066\u3082\u5165\u308b\u3002\n\n```bash\n$ wget -qO- https://raw.github.com/progrium/dokku/v0.2.3/bootstrap.sh | sudo DOKKU_TAG=v0.2.3 bash\n```\n\n\u4f8b\u3048\u3070\u3001 `dokku.example.local` \u3068\u3044\u3046\u30c9\u30e1\u56e0\u3067\u89e3\u6c7a\u3067\u304d\u308b\u3088\u3046\u306a\u30b5\u30fc\u30d0\u306bDokku\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u3066\u304a\u3051\u3070\u3001\u52dd\u624b\u306b `/home/dokku/VHOST` \u306e\u4e2d\u8eab\u304c `dokku.example.local` \u306b\u306a\u308b\uff08\u5927\u4e8b\u306a\u90e8\u5206\uff09\u3002\u30a2\u30d7\u30ea\u3092\u30c7\u30d7\u30ed\u30a4\u3057\u305f\u3089 `foobar.dokku.example.local` \u3068\u3044\u3046\u3068\u3053\u308d\u306b\u30db\u30b9\u30c8\u3055\u308c\u308b\u3002\n\n\u3067\u3001\u305d\u306e\u3042\u3068\u3001Heroku\u4e26\u307f\u306b\u7c21\u5358\u306b\u30c7\u30d7\u30ed\u30a4\u3067\u304d\u308b\u3088\u3046\u306b\u3059\u308b\u307e\u3067\u304c\u82e5\u5e72\u3081\u3093\u3069\u3044\u306e\u3067\u8a73\u3057\u304f\u66f8\u3044\u3066\u304a\u304f\u3002\n\n### \u516c\u958b\u9375\u3092\u767b\u9332\u3059\u308b\u3002\n\n\u3053\u306e\u307e\u307e\u3067\u306f\u30d7\u30c3\u30b7\u30e5\u3067\u304d\u306a\u3044\u306e\u3067\u767b\u9332\u3002`dokku.example.local`\u306b\u30ed\u30b0\u30a4\u30f3\u3057\u3066\u3053\u3093\u306a\u611f\u3058\u3067\u826f\u3044\u306e\u3067\u306f\u3002\n\n```bash\ncurl https://github.com/udzura.keys | sudo sshcommand acl-add dokku udzura\n```\n\n`dokku@dokku.example.local` \u306bSSH\u30ed\u30b0\u30a4\u30f3\u3067\u304d\u308b\u3088\u3046\u306b\u3059\u308b\u3002\n\n\u7814\u4fee\u3068\u304b\u3067\u4f7f\u3046\u5834\u5408\u3001\u3081\u3093\u3069~\u306a\u306e\u3067\u793e\u5185Dokku\u5c02\u7528\u306e\u516c\u958b\u9375\u3092\u767b\u9332\u3057\u3066\u79d8\u5bc6\u9375\u3092\u914d\u3063\u3066\u3082\u826f\u3044\u304b\u3082\u3002\n\n### \u30d7\u30c3\u30b7\u30e5\u3057\u3066\u307f\u308b\n\n\u9069\u5f53\u306aSinatra\u30d7\u30ed\u30b8\u30a7\u30af\u30c8:\n\n```rb:app.rb\nrequire 'sinatra'\nget '/' do\n  \"Hello, from dokku!!\"\nend\n```\n\n```rb:Gemfile\nsource \"https://rubygems.org\"\nruby '2.1.1'\n\ngem 'sinatra'\n```\n\n```rb:Procfile\nweb: bundle exec ruby app.rb -p $PORT\n```\n\n\u307e\u308b\u3063\u304d\u308aheroku\u3068\u540c\u3058\u3082\u306e\u3002\u3053\u306eGit\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092\u3001\u3053\u3093\u306a\u611f\u3058\u3067\u30d7\u30c3\u30b7\u30e5\u3002`sinatra-sample` \u306f\u4efb\u610f\u3002\u305d\u3053\u306e\u540d\u524d\u304c\u305d\u306e\u307e\u307e\u30b5\u30d6\u30c9\u30e1\u9662\u306b\u306a\u308b\n\n```bash\n$ git remote add dokku dokku@dokku.example.local:sinatra-sample\n$ git push dokku master\n```\n\n\u3059\u308b\u3068\u306a\u3093\u304bHeroku\u3063\u307d\u3044\u8868\u793a\u304c\u51fa\u3066\u304f\u308b\u3002\n\n```\nCounting objects: 5, done.\nDelta compression using up to 8 threads.\nCompressing objects: 100% (3/3), done.\nWriting objects: 100% (3/3), 323 bytes | 0 bytes/s, done.\nTotal 3 (delta 1), reused 0 (delta 0)\n-----> Cleaning up ...\nremote: Cloning into '/tmp/tmp.5eBkCHIIsz'...\n-----> Building sinatra-sample ...\nremote: done.\nremote: HEAD is now at 2c0f55f... Fix typo ooooo\n       Ruby app detected\n-----> Compiling Ruby/Rack\n-----> Using Ruby version: ruby-2.1.1\n-----> Installing dependencies using 1.5.2\n       Running: bundle install --without development:test --path vendor/bundle --binstubs vendor/bundle/bin -j4 --deployment\n       Using rack (1.5.2)\n       Using tilt (1.4.1)\n       Using bundler (1.5.2)\n...\n=====> Application deployed:\n       http://sinatra-sample.dokku.example.local\n```\n\nHeroku\u3068\u540c\u3058buildpack\u3092\u4f7f\u3063\u3066\u3044\u308b\u306e\u3067\u3001\u5f53\u7136\u3068\u8a00\u3048\u3070\u5f53\u7136...\u3002\n\n\u3067\u3001\u3053\u306e `sinatra-sample.dokku.example.local` \u3092\u6211\u3005\u304c\u3053\u306e\u307e\u307e\u89e3\u6c7a\u3067\u304d\u308b\u8a33\u3082\u7121\u3044\u306e\u3067\u3001\u5168\u90e8\u30a8\u30c8\u30bb\u30db\u30b9\u30c4\u306b\u30a8\u30f3\u30c8\u30ea\u3092\u66f8\u3044\u3066\u3044\u3063\u3066\u3082\u826f\u3044\u3051\u3069\u3001\u5c11\u3057\u3060\u3051\u697d\u306a\u65b9\u6cd5\u306b\u3059\u308b\u3002\n\n### dnsmasq \u3067 `*.dokku.example.local` \u3092\u5168\u90e8 `dokku.example.local` \u3068\u540c\u3058\u3068\u3053\u306b\u5411\u3051\u308b\n\nxip.io \u3092\u4f7f\u3046\u4eba\u3082\u591a\u3044\u307f\u305f\u3044\u3060\u3051\u3069\u3001\u3061\u3087\u3063\u3068... \u3068\u601d\u3063\u305f\u306e\u3067dnsmasq\u3092\u4f7f\u3044\u305f\u3044\u3002\n\n\u307e\u305a\u306f\u304a\u3082\u3080\u308d\u306b\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3002\u307f\u306a\u3055\u3093\u3082\u3061\u308d\u3093\u3001Mac.....\u3067\u3059\u3088\u306d...\n\n```bash\n$ brew install dnsmasq\n$ cp /usr/local/opt/dnsmasq/dnsmasq.conf.example /usr/local/etc/dnsmasq.conf\n$ sudo cp -fv /usr/local/opt/dnsmasq/*.plist /Library/LaunchDaemons\n```\n\n\u304a\u3082\u3080\u308d\u306b\u8a2d\u5b9a\u3001\u307c\u304f\u306f http://tell-k.hatenablog.com/entry/2014/04/28/002437 \u3092\u898b\u305f\u3002 `dokku.example.local` \u304c `192.168.0.123` \u306b\u5411\u3044\u3066\u3044\u308b\u524d\u63d0\u3067\u3002\n\n```ini:dnsmasq.conf\nbind-interfaces\naddress=/dokku.example.local/192.168.0.123\n```\n\n`/etc/resolver/dokku.example.local` \u3068\u3044\u3046\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u308b\u3002\n\n```hosts:dokku.example.local\nnameserver 127.0.0.1\n```\n\n\u8d77\u52d5\u3002\n\n```bash\nsudo launchctl load /Library/LaunchDaemons/homebrew.mxcl.dnsmasq.plist\n```\n\n\u3053\u3053\u307e\u3067\u3057\u305f\u3089\u3001\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306e\u8a2d\u5b9a\u3067\u4e00\u756a\u76ee\u306eDNS\u3092 `127.0.0.1` \u306b\u3059\u308b\u5fc5\u8981\u304c\u3042\u308b\u304b\u3082\u3002\u8981\u51fa\u5178\u3067\u3042\u308b...\u3002\n\n### \u78ba\u8a8d\n\n```bash\n$ dig @127.0.0.1 hogehoge.dokku.example.local                                 \n\n; <<>> DiG 9.8.3-P1 <<>> @127.0.0.1 hogehoge.dokku.example.local\n; (1 server found)\n;; global options: +cmd\n;; Got answer:\n;; ->>HEADER<<- opcode: QUERY, status: NOERROR, id: 20679\n;; flags: qr aa rd ra; QUERY: 1, ANSWER: 1, AUTHORITY: 0, ADDITIONAL: 0\n\n;; QUESTION SECTION:\n;hogehoge.dokku.example.local.         IN      A\n\n;; ANSWER SECTION:\nhogehoge.dokku.example.local.  0       IN      A       192.168.0.123\n...\n\n$ ping -c 1 sinatra-sample.dokku.example.local\nPING sinatra-sample.dokku.example.local (192.168.0.123): 56 data bytes\n64 bytes from 192.168.0.123: icmp_seq=0 ttl=59 time=23.631 ms\n```\n\n\u3055\u3066\u3001\u304a\u3082\u3080\u308d\u306b http://sinatra-sample.dokku.example.local \u3092\u958b\u304f\u3068\u300c`Hello, from dokku!!`\u300d\u3063\u3066\u51fa\u3066\u304f\u308b\u306f\u305a\u3002\u51fa\u3066\u304f\u308b\u3068\u826f\u3044\u3067\u3059\u306d\uff08Heroku\u3063\u307d\u304f\u521d\u56de\u30a2\u30af\u30bb\u30b9\u306b\u6642\u9593\u304c\u639b\u304b\u308b\u3002\u3053\u3093\u306a\u3068\u3053\u307e\u3067Heroku\u30af\u30ed\u30fc\u30f3\u306a\u306e...\uff09\u3002\n\n### Troubleshoot: \u306a\u3093\u304b\u8d77\u52d5\u3057\u306a\u3044\n\n\u30ed\u30b0\u3092\u898b\u308b\u306b\u306f\u30ed\u30b0\u30a4\u30f3\u3057\u306a\u3044\u3068\u3044\u3051\u306a\u3044\u305e\u3046:\n\n```bash\n$ ssh -t dokku@dokku.example.local logs sinatra-sample\n```\n\n\u305d\u306e\u4ed6\u30b3\u30de\u30f3\u30c9\u304c\u8272\u3005\u3042\u308b\u306e\u3067 `help` \u3059\u308b\u3068\u826f\u3055\u305d\u3046\u3002\u30a8\u30a4\u30ea\u30a2\u30b9\u3092\u8cbc\u308c\u3070`heroku`\u30b3\u30de\u30f3\u30c9\u306e\u3088\u3046\u306b\u4f7f\u3048\u308b...\n", "tags": ["docker", "dokku"]}