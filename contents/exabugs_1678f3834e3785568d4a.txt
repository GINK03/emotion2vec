{"context": "\n\n\u6982\u8981\n2016/04/07 \u306b LINE \u306e \u300cBOT API Trial Account\u300d \u304c\u7121\u511f\u63d0\u4f9b\u958b\u59cb\u3002\nAWS Lambda \u3067 LINE \u30dc\u30c3\u30c8 (\u30aa\u30a6\u30e0\u8fd4\u3057) \u3092\u4f5c\u6210\u3059\u308b\u3002\n\u53c2\u7167\u3059\u308b from \u3092\u9593\u9055\u3048\u3084\u3059\u3044\u306e\u3067\u3001\u6ce8\u610f\u306e\u3053\u3068\u3002\n\n\u306f\u3058\u3081\u306b\n\u4ee5\u524d\u3001Lambda \u3067 Slack \u30dc\u30c3\u30c8 \u300c\u30e9\u30f3\u30dc\u30fc\u300d\u3092\u4f5c\u6210\u3057\u307e\u3057\u305f\u3002\n\nAWS Lambda \u3092\u4f7f\u3063\u3066 Slack \u30dc\u30c3\u30c8 (\u547d\u540d: Lambot [\u30e9\u30f3\u30dc\u30fc]) \u3092\u4f4e\u4e88\u7b97\u3067\u4f5c\u308d\u3046\u3058\u3083\u306a\u3044\u304b\nAWS Lambda\u3067 \u5f62\u614b\u7d20\u89e3\u6790 \u3067\u304d\u308b\u8ce2\u3044Slack\u30dc\u30c3\u30c8\u3092\u4f4e\u4e88\u7b97\u3067\u4f5c\u308d\u3046\u3058\u3083\u306a\u3044\u304b (2)\n\nLINE \u3067\u3082 API \u304c\u516c\u958b\u3055\u308c\u305f\u3068\u306e\u3053\u3068\u3067\u3001\u300c\u30e9\u30f3\u30dc\u30fc\uff13\u300d\u3092\u4f5c\u308d\u3046\u3058\u3083\u306a\u3044\u304b\u3001\u3068\u3044\u3046\u4e3b\u65e8\u3067\u3059\u3002\n\nLINE\n\u4ee5\u4e0b\u306e\u624b\u9806\u3067\u3001\u3054\u81ea\u8eab\u306e LINE \u30a2\u30ab\u30a6\u30f3\u30c8\u3067 developer \u767b\u9332\u3092\u3057\u307e\u3059\u3002\n\n\u767b\u9332\u65b9\u6cd5\n\n\nhttps://developers.line.me/ \u306b\u30a2\u30af\u30bb\u30b9\n\u53f3\u4e0a\u306eChannels\u3092\u30af\u30ea\u30c3\u30af\u3057\u3001\u3054\u81ea\u8eab\u306e LINE \u30a2\u30ab\u30a6\u30f3\u30c8\u3067\u30ed\u30b0\u30a4\u30f3\nChannel ID\u3001Channel Secret\u3001MID \u304c\u53d6\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\n\n\nAWS Lambda\nLambda \u30b3\u30fc\u30c9\u306f\u4ee5\u4e0b\u306b\u306a\u308a\u307e\u3059\u3002\n\n\u5148\u982d3\u884c\u306e // Your ID \u306f\u3001\u9069\u5b9c\u3001\u3054\u81ea\u8eab\u306e ID \u306b\u7f6e\u304d\u63db\u3048\u3066\u304f\u3060\u3055\u3044\u3002\nto \u306b from \u306e\u5024\u3092\u8a2d\u5b9a\u3059\u308b\u306e\u3067\u3059\u304c\u3001\u3053\u3053\u304c\u4e00\u756a\u306e LINE \u30dc\u30c3\u30c8 \u306e\u30cf\u30de\u308a\u3069\u3053\u308d\u3067\u3059\u3002\n\u5f15\u6570\u3067\u6e21\u3055\u308c\u3066\u304f\u308bjson\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306e\u3001\u5916\u5074\u3068\u5185\u5074\u306e2\u7b87\u6240\u306b from \u304c\u3042\u308b\u306e\u3067\u3059\u304c\u3001\u3010\u5185\u5074 (content) \u306e from \u304c\u6b63\u89e3\u3011 \u3067\u3059\u3002\u305d\u308c\u3092 to \u306b\u8a2d\u5b9a\u3057\u3066\u4e0b\u3055\u3044\u3002\ntoChannel, eventType \u306f\u6307\u5b9a\u3055\u308c\u3066\u3044\u307e\u3059\u306e\u3067\u5909\u66f4\u3057\u306a\u3044\u3067\u4e0b\u3055\u3044!!!\u3002\u8a73\u7d30\u306f\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u53c2\u7167\u3057\u3066\u304f\u3060\u3055\u3044\u3002\nLINE \u304b\u3089\u306e \u30b3\u30fc\u30eb\u30d0\u30c3\u30af \u306f Application/json \u5f62\u5f0f\u306a\u306e\u3067\u3001Slack \u306e\u6642\u306e\u3088\u3046\u306a\u9762\u5012\u306a \u30d5\u30a9\u30fc\u30e0\u2192json \u5909\u63db\u306f\u4e0d\u8981\u3067\u3059\u3002\n(API Gatewary \u3067 POST \u3092\u53d7\u3051\u3066\u3001Lambda \u306b\u6d41\u3057\u3066\u3084\u308b\u3060\u3051\u3067 OK \u3067\u3059\u3002)\n\n\u3044\u3044\u5fd8\u308c\u3066\u307e\u3057\u305f\u304c\u3001\u30e2\u30b8\u30e5\u30fc\u30eb (request) \u3092\u4f7f\u3046\u306e\u3067\u3001npm install \u3057\u305f\u5f8c\u3001\u5168\u4f53\u3092 zip \u3057\u3066\u304b\u3089 Lambda \u306b\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3057\u3066\u4e0b\u3055\u3044\u3002 Lamba \u3067\u30a4\u30f3\u30e9\u30a4\u30f3\u7de8\u96c6\u3067\u304d\u308b\u3088\u3046\u306b\u3001request \u30e2\u30b8\u30e5\u30fc\u30eb\u3092\u4f7f\u308f\u306a\u3044\u3088\u3046\u306b\u5909\u66f4\u3057\u307e\u3057\u305f\u3002\n\nAPI \u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u306f\u3053\u3061\u3089\nhttps://developers.line.me/bot-api/api-reference\n\nindex.js\n'use strict';\n\nvar ChannelID = 1470000000; // Your ID\nvar ChannelSecret = \"def889cei00000000000000000000000000000\"; // Your ID\nvar MID = \"u0e0450000000000000000000\"; // Your ID\n\n\nvar https = require('https');\n\nfunction send(data, callback) {\n  var body = JSON.stringify(data);\n\n  var req = https.request({\n    hostname: \"trialbot-api.line.me\",\n    port: 443,\n    path: \"/v1/events\",\n    method: \"POST\",\n    headers: {\n      \"Content-Type\": \"application/json\",\n      \"Content-Length\": Buffer.byteLength(body),\n      'X-Line-ChannelID': ChannelID,\n      'X-Line-ChannelSecret': ChannelSecret,\n      'X-Line-Trusted-User-With-ACL': MID\n    }\n  });\n\n  req.end(body, function (err) {\n    err && console.log(err);\n    callback(err);\n  });\n}\n\nexports.handler = function (event, context, callback) {\n  var result = event.result && event.result[0];\n  if (result) {\n    var content = result.content || {};\n    var message = {\n      \"to\": [content.from],\n      \"toChannel\": 1383378250, // 1383378250 Fixed value\n      \"eventType\": \"138311608800106203\", // \u201c138311608800106203\u201d Fixed value.\n      \"content\": {\n        \"contentType\": 1,\n        \"toType\": 1,\n        \"text\": content.text\n      }\n    };\n    send(message, function () {\n      callback();\n    });\n  } else {\n    callback();\n  }\n};\n\n\nGitHub \u306f\u3053\u3061\u3089\nhttps://github.com/exabugs/Lambot-Line/blob/master/index.js\n\n\u5b8c\u6210\n\n\n\u304a\u308f\u308a\u306b\n\nLINE \u306f API \u516c\u958b\u304c\u9045\u3044\u3002\u671f\u3092\u9003\u3057\u305f\u611f\u304c\u3042\u308a\u307e\u3059\u306d\u3002\nSlack \u30dc\u30c3\u30c8 \u306f\u30c1\u30e3\u30cd\u30eb\u3092\u76f8\u624b\u306b\u3059\u308b\u306e\u306b\u5bfe\u3057\u3066\u3001LINE \u30dc\u30c3\u30c8 \u306f\u57fa\u672c\u7684\u306b\u306f\u4e00\u4eba\u3092\u76f8\u624b\u306b\u3059\u308b\u611f\u3058\u3067\u3059\u306d\u3002\u305d\u306e\u70b9\u3067\u3001LINE \u306f\u7269\u8db3\u308a\u306a\u3055\u3092\u611f\u3058\u307e\u3059\u3002\nAPI \u305d\u306e\u3082\u306e\u3082\u3001\u4f7f\u3044\u3084\u3059\u3044\u3068\u306f\u8a00\u3048\u306a\u3044\u611f\u3058\u3002\u3046\u301c\u3093\u3001\u3069\u3046\u3067\u3057\u3087\u3046\u3002\n\u30a8\u30e9\u30fc\u30b3\u30fc\u30c9\u9177\u3044\u3067\u3059\u3002\u300c500 \u5185\u90e8\u30a8\u30e9\u30fc\u300d \u306f\u3055\u3063\u3071\u308a\u308f\u304b\u308a\u307e\u305b\u3093\u3067\u3057\u305f\u3002\n\u307e\u3060\u3001\u30d7\u30ec\u30d3\u30e5\u30fc\u3067\u3059\u3082\u3093\u306d\u3002\u6b63\u5f0f\u516c\u958b\u307e\u3067\u306b\u306f\u3001\u304d\u3063\u3068\u826f\u304f\u306a\u308b\u3068\u601d\u3044\u307e\u3059\u3002\n\u52d5\u753b\u3084\u30b9\u30bf\u30f3\u30d7\u3092\u9001\u3063\u305f\u308a\u53d7\u3051\u305f\u308a\u51fa\u6765\u308b\u3088\u3046\u3067\u3059\u304c\u3001\u307e\u305f\u6b21\u56de\u3002\n\n## \u6982\u8981\n2016/04/07 \u306b LINE \u306e \u300cBOT API Trial Account\u300d \u304c\u7121\u511f\u63d0\u4f9b\u958b\u59cb\u3002\nAWS Lambda \u3067 LINE \u30dc\u30c3\u30c8 (\u30aa\u30a6\u30e0\u8fd4\u3057) \u3092\u4f5c\u6210\u3059\u308b\u3002\n\u53c2\u7167\u3059\u308b from \u3092\u9593\u9055\u3048\u3084\u3059\u3044\u306e\u3067\u3001\u6ce8\u610f\u306e\u3053\u3068\u3002\n\n## \u306f\u3058\u3081\u306b\n\u4ee5\u524d\u3001Lambda \u3067 Slack \u30dc\u30c3\u30c8 \u300c\u30e9\u30f3\u30dc\u30fc\u300d\u3092\u4f5c\u6210\u3057\u307e\u3057\u305f\u3002\n\n - [AWS Lambda \u3092\u4f7f\u3063\u3066 Slack \u30dc\u30c3\u30c8 (\u547d\u540d: Lambot [\u30e9\u30f3\u30dc\u30fc]) \u3092\u4f4e\u4e88\u7b97\u3067\u4f5c\u308d\u3046\u3058\u3083\u306a\u3044\u304b](http://qiita.com/exabugs/items/e868df55333d0805acb2)\n - [AWS Lambda\u3067 \u5f62\u614b\u7d20\u89e3\u6790 \u3067\u304d\u308b\u8ce2\u3044Slack\u30dc\u30c3\u30c8\u3092\u4f4e\u4e88\u7b97\u3067\u4f5c\u308d\u3046\u3058\u3083\u306a\u3044\u304b (2)](http://qiita.com/exabugs/items/f399451fd14ded21f777)\n\nLINE \u3067\u3082 API \u304c\u516c\u958b\u3055\u308c\u305f\u3068\u306e\u3053\u3068\u3067\u3001\u300c\u30e9\u30f3\u30dc\u30fc\uff13\u300d\u3092\u4f5c\u308d\u3046\u3058\u3083\u306a\u3044\u304b\u3001\u3068\u3044\u3046\u4e3b\u65e8\u3067\u3059\u3002\n\n\n\n## LINE\n\n\u4ee5\u4e0b\u306e\u624b\u9806\u3067\u3001\u3054\u81ea\u8eab\u306e LINE \u30a2\u30ab\u30a6\u30f3\u30c8\u3067 developer \u767b\u9332\u3092\u3057\u307e\u3059\u3002\n\n#### \u767b\u9332\u65b9\u6cd5\n 1. https://developers.line.me/ \u306b\u30a2\u30af\u30bb\u30b9\n 1. \u53f3\u4e0a\u306eChannels\u3092\u30af\u30ea\u30c3\u30af\u3057\u3001\u3054\u81ea\u8eab\u306e LINE \u30a2\u30ab\u30a6\u30f3\u30c8\u3067\u30ed\u30b0\u30a4\u30f3\n 1. Channel ID\u3001Channel Secret\u3001MID \u304c\u53d6\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\n\n\n\n\n## AWS Lambda\n\nLambda \u30b3\u30fc\u30c9\u306f\u4ee5\u4e0b\u306b\u306a\u308a\u307e\u3059\u3002\n\n\n - \u5148\u982d3\u884c\u306e // Your ID \u306f\u3001\u9069\u5b9c\u3001\u3054\u81ea\u8eab\u306e ID \u306b\u7f6e\u304d\u63db\u3048\u3066\u304f\u3060\u3055\u3044\u3002\n - to \u306b from \u306e\u5024\u3092\u8a2d\u5b9a\u3059\u308b\u306e\u3067\u3059\u304c\u3001\u3053\u3053\u304c\u4e00\u756a\u306e LINE \u30dc\u30c3\u30c8 \u306e\u30cf\u30de\u308a\u3069\u3053\u308d\u3067\u3059\u3002  \n   \u5f15\u6570\u3067\u6e21\u3055\u308c\u3066\u304f\u308bjson\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306e\u3001\u5916\u5074\u3068\u5185\u5074\u306e2\u7b87\u6240\u306b from \u304c\u3042\u308b\u306e\u3067\u3059\u304c\u3001\u3010\u5185\u5074 (content) \u306e from \u304c\u6b63\u89e3\u3011 \u3067\u3059\u3002\u305d\u308c\u3092 to \u306b\u8a2d\u5b9a\u3057\u3066\u4e0b\u3055\u3044\u3002\n - toChannel, eventType \u306f\u6307\u5b9a\u3055\u308c\u3066\u3044\u307e\u3059\u306e\u3067\u5909\u66f4\u3057\u306a\u3044\u3067\u4e0b\u3055\u3044!!!\u3002\u8a73\u7d30\u306f\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u53c2\u7167\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n - LINE \u304b\u3089\u306e \u30b3\u30fc\u30eb\u30d0\u30c3\u30af \u306f Application/json \u5f62\u5f0f\u306a\u306e\u3067\u3001Slack \u306e\u6642\u306e\u3088\u3046\u306a\u9762\u5012\u306a \u30d5\u30a9\u30fc\u30e0\u2192json \u5909\u63db\u306f\u4e0d\u8981\u3067\u3059\u3002  \n (API Gatewary \u3067 POST \u3092\u53d7\u3051\u3066\u3001Lambda \u306b\u6d41\u3057\u3066\u3084\u308b\u3060\u3051\u3067 OK \u3067\u3059\u3002)\n - ~~\u3044\u3044\u5fd8\u308c\u3066\u307e\u3057\u305f\u304c\u3001\u30e2\u30b8\u30e5\u30fc\u30eb (request) \u3092\u4f7f\u3046\u306e\u3067\u3001npm install \u3057\u305f\u5f8c\u3001\u5168\u4f53\u3092 zip \u3057\u3066\u304b\u3089 Lambda \u306b\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3057\u3066\u4e0b\u3055\u3044\u3002~~ Lamba \u3067\u30a4\u30f3\u30e9\u30a4\u30f3\u7de8\u96c6\u3067\u304d\u308b\u3088\u3046\u306b\u3001request \u30e2\u30b8\u30e5\u30fc\u30eb\u3092\u4f7f\u308f\u306a\u3044\u3088\u3046\u306b\u5909\u66f4\u3057\u307e\u3057\u305f\u3002\n\nAPI \u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u306f\u3053\u3061\u3089\nhttps://developers.line.me/bot-api/api-reference\n\n```js:index.js\n'use strict';\n\nvar ChannelID = 1470000000; // Your ID\nvar ChannelSecret = \"def889cei00000000000000000000000000000\"; // Your ID\nvar MID = \"u0e0450000000000000000000\"; // Your ID\n\n\nvar https = require('https');\n\nfunction send(data, callback) {\n  var body = JSON.stringify(data);\n\n  var req = https.request({\n    hostname: \"trialbot-api.line.me\",\n    port: 443,\n    path: \"/v1/events\",\n    method: \"POST\",\n    headers: {\n      \"Content-Type\": \"application/json\",\n      \"Content-Length\": Buffer.byteLength(body),\n      'X-Line-ChannelID': ChannelID,\n      'X-Line-ChannelSecret': ChannelSecret,\n      'X-Line-Trusted-User-With-ACL': MID\n    }\n  });\n\n  req.end(body, function (err) {\n    err && console.log(err);\n    callback(err);\n  });\n}\n\nexports.handler = function (event, context, callback) {\n  var result = event.result && event.result[0];\n  if (result) {\n    var content = result.content || {};\n    var message = {\n      \"to\": [content.from],\n      \"toChannel\": 1383378250, // 1383378250 Fixed value\n      \"eventType\": \"138311608800106203\", // \u201c138311608800106203\u201d Fixed value.\n      \"content\": {\n        \"contentType\": 1,\n        \"toType\": 1,\n        \"text\": content.text\n      }\n    };\n    send(message, function () {\n      callback();\n    });\n  } else {\n    callback();\n  }\n};\n```\n\nGitHub \u306f\u3053\u3061\u3089\nhttps://github.com/exabugs/Lambot-Line/blob/master/index.js\n\n## \u5b8c\u6210\n\n![IMG_27492.png](https://qiita-image-store.s3.amazonaws.com/0/69410/a8711768-b62b-9f97-274e-0407afc96f3f.png)\n\n\n## \u304a\u308f\u308a\u306b\n\n - LINE \u306f API \u516c\u958b\u304c\u9045\u3044\u3002\u671f\u3092\u9003\u3057\u305f\u611f\u304c\u3042\u308a\u307e\u3059\u306d\u3002\n - Slack \u30dc\u30c3\u30c8 \u306f\u30c1\u30e3\u30cd\u30eb\u3092\u76f8\u624b\u306b\u3059\u308b\u306e\u306b\u5bfe\u3057\u3066\u3001LINE \u30dc\u30c3\u30c8 \u306f\u57fa\u672c\u7684\u306b\u306f\u4e00\u4eba\u3092\u76f8\u624b\u306b\u3059\u308b\u611f\u3058\u3067\u3059\u306d\u3002\u305d\u306e\u70b9\u3067\u3001LINE \u306f\u7269\u8db3\u308a\u306a\u3055\u3092\u611f\u3058\u307e\u3059\u3002\n - API \u305d\u306e\u3082\u306e\u3082\u3001\u4f7f\u3044\u3084\u3059\u3044\u3068\u306f\u8a00\u3048\u306a\u3044\u611f\u3058\u3002\u3046\u301c\u3093\u3001\u3069\u3046\u3067\u3057\u3087\u3046\u3002\n - \u30a8\u30e9\u30fc\u30b3\u30fc\u30c9\u9177\u3044\u3067\u3059\u3002\u300c500 \u5185\u90e8\u30a8\u30e9\u30fc\u300d \u306f\u3055\u3063\u3071\u308a\u308f\u304b\u308a\u307e\u305b\u3093\u3067\u3057\u305f\u3002\n - \u307e\u3060\u3001\u30d7\u30ec\u30d3\u30e5\u30fc\u3067\u3059\u3082\u3093\u306d\u3002\u6b63\u5f0f\u516c\u958b\u307e\u3067\u306b\u306f\u3001\u304d\u3063\u3068\u826f\u304f\u306a\u308b\u3068\u601d\u3044\u307e\u3059\u3002\n - \u52d5\u753b\u3084\u30b9\u30bf\u30f3\u30d7\u3092\u9001\u3063\u305f\u308a\u53d7\u3051\u305f\u308a\u51fa\u6765\u308b\u3088\u3046\u3067\u3059\u304c\u3001\u307e\u305f\u6b21\u56de\u3002\n", "tags": ["Line", "AWS", "lambda", "APIGateway", "bot"]}