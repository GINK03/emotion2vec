{"context": " More than 1 year has passed since last update.\n\n\u6982\u8981\nRaspberry pi\u306bssh\u63a5\u7d9a\u3059\u308b\u969b\u306e\u30b0\u30ed\u30fc\u30d0\u30ebIP\u3092\u3001\u5b9a\u671f\u7684\u306bGoogleSpreadsheet\u306b\u66f8\u304d\u8fbc\u3080python\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u4f5c\u3063\u3066\u307f\u305f\u3002\n\n\u4e8b\u524d\u6e96\u5099\n\nconfig.ini\u306e\u4f5c\u6210\n\u4e0b\u8a18\u306e\u60c5\u5831\u3092config.ini\u3078\u307e\u3068\u3081\u3066\u304a\u304f\u3002\n\nGoogle\u30a2\u30ab\u30a6\u30f3\u30c8\nGoogle\u30a2\u30d7\u30ea\u30d1\u30b9\u30ef\u30fc\u30c9\uff08\u30a2\u30d7\u30ea\u56fa\u6709\uff09\nIP\u66f8\u304d\u51fa\u3057\u7528\u306b\u7528\u610f\u3057\u305fGoogle\u30b9\u30d7\u30ec\u30c3\u30c9\u30b7\u30fc\u30c8\u306e\u30b9\u30d7\u30ec\u30c3\u30c9\u30b7\u30fc\u30c8ID\n\n\nconfig.ini\n[google]\nusername = ****\npassword = ****\nspreadsheet_key = *****\uff08\u30b9\u30d7\u30ec\u30c3\u30c9\u30b7\u30fc\u30c8ID\uff09\n\n\n\u306a\u304a\u3001\u30b9\u30d7\u30ec\u30c3\u30c9\u30b7\u30fc\u30c8ID\u306f\u3001*****\u90e8\u5206\u306b\u76f8\u5f53\nhttps://docs.google.com/spreadsheets/d/*******/edit#gid=0\n\n\n\u5fc5\u8981\u306a\u30e9\u30a4\u30d6\u30e9\u30ea\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\ngdata\u4f7f\u3044\u307e\u3059\u3002\nsudo apt-get install python-gdata\n\n\nGoogle\u30b9\u30d7\u30ec\u30c3\u30c9\u30b7\u30fc\u30c8\u3092\u6271\u3046\u72ec\u81ea\u30af\u30e9\u30b9\u4f5c\u6210\nIP\u3068\u4f4d\u7f6e\uff08\u884c\u3001\u5217\uff09\u3092\u4e0e\u3048\u308c\u3070\u3001\u30a2\u30c3\u30d7\u30c7\u30fc\u30c8\u3067\u304d\u308b\u30af\u30e9\u30b9\u4f5c\u3063\u3066\u307f\u305f\u3002\n- \u66f8\u304d\u51fa\u3059IP\n- \u884c\n- \u5217 \n\u306a\u304a\u3001\u30b7\u30fc\u30c8\u306f\u30c7\u30d5\u30a9\u30eb\u30c8\u30671\u756a\u76ee\u306e\u30b7\u30fc\u30c8\uff08od6\uff09\u3092\u9078\u629e\n\u53c2\u8003\uff1ahttp://qiita.com/debiru/items/27a48dfb3b1c010cd478\n\nmySpreadsheet.py\nimport gdata.spreadsheets.client\nimport gdata.spreadsheet.service\nimport ConfigParser\n\nclass mySpreadsheet:\n\n  user = ''\n  passwd = ''\n  key = ''\n  sheet_id= ''\n\n  def __init__(self,config):\n    inifile = ConfigParser.SafeConfigParser()\n    inifile.read(config)\n    self.user = unicode(inifile.get(\"google\",\"username\"))\n    self.passwd = unicode(inifile.get(\"google\",\"password\"))\n    self.key = unicode(inifile.get(\"google\",\"spreadsheet_key\"))\n    self.sheet_id = 'od6'\n\n  def updateCell(self,value,row,col):\n    client = gdata.spreadsheet.service.SpreadsheetsService(self.user,self.passwd)\n    client.ProgrammaticLogin()\n    cell = client.UpdateCell(inputValue = value,\n                             row = row, col = col,\n                             key = self.key,\n                             wksht_id = self.sheet_id)\n\nif __name__ == \"__main__\":\n  m = mySpreadsheet('config.ini')\n  m.updateCell('hoge',1,1)\n\n\n\nIP\u306e\u53d6\u5f97\u304b\u3089google\u30b9\u30d7\u30ec\u30c3\u30c9\u30b7\u30fc\u30c8\u3078\u306e\u30a2\u30c3\u30d7\u30c7\u30fc\u30c8\u307e\u3067\n\u4e0a\u8a18\u30af\u30e9\u30b9\u3092\u8aad\u307f\u8fbc\u307f\u3001IP\u6e21\u305b\u3070OK\n\nupdateip.py\nimport json\nfrom urllib2 import urlopen\nfrom mySpreadsheet import *\n\nm = mySpreadsheet('config.ini')\nip = json.load(urlopen('http://httpbin.org/ip'))['origin']\nm.updateCell(ip,1,2)\nprint ip\n\n\n# \u6982\u8981\nRaspberry pi\u306bssh\u63a5\u7d9a\u3059\u308b\u969b\u306e\u30b0\u30ed\u30fc\u30d0\u30ebIP\u3092\u3001\u5b9a\u671f\u7684\u306bGoogleSpreadsheet\u306b\u66f8\u304d\u8fbc\u3080python\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u4f5c\u3063\u3066\u307f\u305f\u3002\n\n# \u4e8b\u524d\u6e96\u5099\n## config.ini\u306e\u4f5c\u6210\n\u4e0b\u8a18\u306e\u60c5\u5831\u3092config.ini\u3078\u307e\u3068\u3081\u3066\u304a\u304f\u3002\n\n- Google\u30a2\u30ab\u30a6\u30f3\u30c8\n- Google\u30a2\u30d7\u30ea\u30d1\u30b9\u30ef\u30fc\u30c9\uff08\u30a2\u30d7\u30ea\u56fa\u6709\uff09\n- IP\u66f8\u304d\u51fa\u3057\u7528\u306b\u7528\u610f\u3057\u305fGoogle\u30b9\u30d7\u30ec\u30c3\u30c9\u30b7\u30fc\u30c8\u306e\u30b9\u30d7\u30ec\u30c3\u30c9\u30b7\u30fc\u30c8ID\n\n```config.ini\n[google]\nusername = ****\npassword = ****\nspreadsheet_key = *****\uff08\u30b9\u30d7\u30ec\u30c3\u30c9\u30b7\u30fc\u30c8ID\uff09\n```\n\n\u306a\u304a\u3001\u30b9\u30d7\u30ec\u30c3\u30c9\u30b7\u30fc\u30c8ID\u306f\u3001*****\u90e8\u5206\u306b\u76f8\u5f53\n\n    https://docs.google.com/spreadsheets/d/*******/edit#gid=0\n\n## \u5fc5\u8981\u306a\u30e9\u30a4\u30d6\u30e9\u30ea\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\ngdata\u4f7f\u3044\u307e\u3059\u3002\n\n    sudo apt-get install python-gdata\n\n# Google\u30b9\u30d7\u30ec\u30c3\u30c9\u30b7\u30fc\u30c8\u3092\u6271\u3046\u72ec\u81ea\u30af\u30e9\u30b9\u4f5c\u6210\nIP\u3068\u4f4d\u7f6e\uff08\u884c\u3001\u5217\uff09\u3092\u4e0e\u3048\u308c\u3070\u3001\u30a2\u30c3\u30d7\u30c7\u30fc\u30c8\u3067\u304d\u308b\u30af\u30e9\u30b9\u4f5c\u3063\u3066\u307f\u305f\u3002\n- \u66f8\u304d\u51fa\u3059IP\n- \u884c\n- \u5217 \n\n\u306a\u304a\u3001\u30b7\u30fc\u30c8\u306f\u30c7\u30d5\u30a9\u30eb\u30c8\u30671\u756a\u76ee\u306e\u30b7\u30fc\u30c8\uff08od6\uff09\u3092\u9078\u629e\n\n\u53c2\u8003\uff1ahttp://qiita.com/debiru/items/27a48dfb3b1c010cd478\n\n```mySpreadsheet.py\nimport gdata.spreadsheets.client\nimport gdata.spreadsheet.service\nimport ConfigParser\n\nclass mySpreadsheet:\n\n  user = ''\n  passwd = ''\n  key = ''\n  sheet_id= ''\n\n  def __init__(self,config):\n    inifile = ConfigParser.SafeConfigParser()\n    inifile.read(config)\n    self.user = unicode(inifile.get(\"google\",\"username\"))\n    self.passwd = unicode(inifile.get(\"google\",\"password\"))\n    self.key = unicode(inifile.get(\"google\",\"spreadsheet_key\"))\n    self.sheet_id = 'od6'\n\n  def updateCell(self,value,row,col):\n    client = gdata.spreadsheet.service.SpreadsheetsService(self.user,self.passwd)\n    client.ProgrammaticLogin()\n    cell = client.UpdateCell(inputValue = value,\n                             row = row, col = col,\n                             key = self.key,\n                             wksht_id = self.sheet_id)\n\nif __name__ == \"__main__\":\n  m = mySpreadsheet('config.ini')\n  m.updateCell('hoge',1,1)\n```\n\n# IP\u306e\u53d6\u5f97\u304b\u3089google\u30b9\u30d7\u30ec\u30c3\u30c9\u30b7\u30fc\u30c8\u3078\u306e\u30a2\u30c3\u30d7\u30c7\u30fc\u30c8\u307e\u3067\n\u4e0a\u8a18\u30af\u30e9\u30b9\u3092\u8aad\u307f\u8fbc\u307f\u3001IP\u6e21\u305b\u3070OK\n\n```updateip.py\nimport json\nfrom urllib2 import urlopen\nfrom mySpreadsheet import *\n\nm = mySpreadsheet('config.ini')\nip = json.load(urlopen('http://httpbin.org/ip'))['origin']\nm.updateCell(ip,1,2)\nprint ip\n```\n\n", "tags": ["Python", "RaspberryPi", "GoogleSpreadSheet"]}