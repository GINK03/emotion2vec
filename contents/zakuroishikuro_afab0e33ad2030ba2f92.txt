{"context": " More than 1 year has passed since last update.JXA\u3092\u77e5\u3089\u306a\u3044\u65b9\u306f\u3068\u308a\u3042\u3048\u305a\u4ee5\u4e0b\u306e\u8a18\u4e8b\u3092\u3069\u3046\u305e\u3002\n\n\nJavaScript for Automation Release Notes - \u516c\u5f0f\u306e\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\n\u9cf6\u5d8b\u5de5\u623f / AppleScript / JavaScript for Automation (JXA)\ndtinth/JXA-Cookbook\n\u77e5\u3089\u306a\u3044\u3046\u3061\u306bMac\u304c\u30b7\u30b9\u30c6\u30e0\u6a19\u6e96\u3067JavaScript\u3067\u64cd\u4f5c\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u3063\u3066\u305f (JXA) - Qiita\n\n\u3053\u3053\u3067\u306f\u30ad\u30fc\u30dc\u30fc\u30c9\u3084\u30de\u30a6\u30b9\u306e\u64cd\u4f5c\u3092\u30a8\u30df\u30e5\u30ec\u30fc\u30c8\u3059\u308b\u65b9\u6cd5\u3092\u66f8\u304d\u307e\u3059\u3002\n\u5404\u30a2\u30d7\u30ea\u306b\u7528\u610f\u3055\u308c\u305f\u6a5f\u80fd\u306f\u30b9\u30af\u30ea\u30d7\u30c8\u30a8\u30c7\u30a3\u30bf\u304b\u3089\u898b\u3089\u308c\u308b\u300c\u7528\u8a9e\u8aac\u660e\u300d\u7b49\u306b\u4efb\u305b\u307e\u3059\u3002\n\u3061\u3087\u3063\u3068\u3057\u305f\u30b3\u30fc\u30c9\u3092\u8a66\u3059\u306b\u306fosascript\u30b3\u30de\u30f3\u30c9\u306e\u30a4\u30f3\u30bf\u30e9\u30af\u30c6\u30a3\u30d6\u30e2\u30fc\u30c9\u304c\u4fbf\u5229\u3067\u3059\u3002\n$ osascript -l JavaScript -i\n\n\u3067\u8d77\u52d5\u3067\u304d\u307e\u3059\u3002\n\nSystem Events\nSystem Events\u306f\u30b9\u30af\u30ea\u30d7\u30c8\u5c02\u7528\u306e\u3001GUI\u3092\u6301\u305f\u306a\u3044\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3067\u3059\u3002\n\nSystemEvents\u3092\u53d6\u5f97\nvar se = Application(\"System Events\"); //\u53c2\u7167\u3092\u53d6\u5f97\n\n\n\u3053\u308c\u3092\u4f7f\u3063\u3066\u30e6\u30fc\u30b6\u306e\u64cd\u4f5c\u3092\u30a8\u30df\u30e5\u30ec\u30fc\u30c8\u3067\u304d\u307e\u3059\u3002\n\u4ee5\u4e0b\u3088\u308a\u3001\u5909\u6570se\u306b\u306fApplication(\"System Events\")\u3092\u53c2\u7167\u3057\u3066\u3044\u308b\u3082\u306e\u3068\u3057\u307e\u3059\u3002\n\n\u30ad\u30fc\u30dc\u30fc\u30c9\u306e\u64cd\u4f5c\u3092\u30a8\u30df\u30e5\u30ec\u30fc\u30c8\n\u30ad\u30fc\u30dc\u30fc\u30c9\u3092\u64cd\u4f5c\u3059\u308b\u306b\u306f.keystroke()\u3068.keyCode()\u3092\u4f7f\u3044\u307e\u3059\u3002\n\n.keystroke()\n\u6e21\u3055\u308c\u305f\u6587\u5b57\u5217\u306e\u30ad\u30fc\u3092\u6253\u9375\u3057\u307e\u3059\u3002\n\n\u300cA\u300d\u30ad\u30fc\u3092\u62bc\u3059\nse.keystroke(\"a\");\n\n\n2\u3064\u76ee\u306e\u5f15\u6570\u3067\u3001\u540c\u6642\u62bc\u3057\u3059\u308b\u7279\u6b8a\u30ad\u30fc\u3092\u6307\u5b9a\u3067\u304d\u307e\u3059\u3002\n\u8907\u6570\u306e\u5834\u5408\u306f\u914d\u5217\u3067\u6e21\u3057\u307e\u3059\u3002\n\n\u7279\u6b8a\u30ad\u30fc\u3092\u7d44\u307f\u5408\u308f\u305b\u3066\u62bc\u3059\n// command + h (\u30a6\u30a3\u30f3\u30c9\u30a6\u3092\u96a0\u3059)\nse.keystroke(\"h\", {using:\"command down\"});\n\n// command + alt + h (\u4ed6\u306e\u30a6\u30a3\u30f3\u30c9\u30a6\u3092\u96a0\u3059)\nse.keystroke(\"h\", {using:[\"command down\", \"option down\"]});\n\n\n\u540c\u6642\u62bc\u3057\u306b\u6307\u5b9a\u3067\u304d\u308b\u7279\u6b8a\u30ad\u30fc\u306f\u4ee5\u4e0b\u306e4\u7a2e\u985e\u306e\u307f\u3067\u3059\u3002\n\n\n\n\n\u6587\u5b57\u5217\n\n\n\n\n\u2318\n\"command down\"\n\n\n\u2303\n\"control down\"\n\n\n\u21e7\n\"shift down\"\n\n\n\u2325\n\"option down\"\n\n\n\n2\u6587\u5b57\u4ee5\u4e0a\u306a\u3089\u9806\u756a\u306b\u6253\u9375\u3055\u308c\u307e\u3059\u3002\n\n\u8907\u6570\u306e\u30ad\u30fc\u3092\u9806\u756a\u306b\u62bc\u3059\nse.keystroke(\"abc\");\n\n\n\nabc\n\n\u30a8\u30b9\u30b1\u30fc\u30d7\u6587\u5b57\u3082\u53ef\u80fd\u3067\u3059\u3002\n\\n\u3067\u30a8\u30f3\u30bf\u30fc\u30ad\u30fc\u304c\u62bc\u3055\u308c\u307e\u3059\u3057\u3001\\b\u3067delete\u30ad\u30fc\u304c\u62bc\u3055\u308c\u307e\u3059\u3002\n(\u30ad\u30fc\u30dc\u30fc\u30c9\u306e\u6253\u9375\u306e\u30a8\u30df\u30e5\u30ec\u30fc\u30c8\u306a\u306e\u3067\u3001\u65e5\u672c\u8a9e\u306f\u7121\u7406\u3067\u3059\u3002)\n(\u8ffd\u8a18: \u3068\u3001\u601d\u3063\u305f\u3051\u3069\\n\u306f\u30a8\u30f3\u30bf\u30fc\u3058\u3083\u306a\u3044\u3063\u307d\u3044\u3067\u3059\u3002\u3053\u3053\u3061\u3087\u3063\u3068\u602a\u3057\u3044\u306e\u3067\u3042\u3093\u307e\u308a\u4fe1\u3058\u306a\u3044\u3067\u304f\u3060\u3055\u3044\u3002)\n\n\u30a8\u30b9\u30b1\u30fc\u30d7\u6587\u5b57\u3092\u62bc\u3059\nse.keystroke(\"//one\\n//twoooooo\\b\\b\\b\\b\\b\\n\");\n\n\n\n//one\n//two\n\n2\u6587\u5b57\u4ee5\u4e0a\u306e\u6587\u5b57\u5217\u3092\u6e21\u3057\u305f\u72b6\u614b\u3067\u7279\u6b8a\u30ad\u30fc\u3092\u6307\u5b9a\u3059\u308b\u3068 \u3059\u3079\u3066\u306e\u6587\u5b57\u3067 \u540c\u6642\u62bc\u3057\u3055\u308c\u307e\u3059\u3002\n\n\u8907\u6570\u306e\u30ad\u30fc\u3092\u7279\u6b8a\u30ad\u30fc\u3068\u4e00\u7dd2\u306b\u9806\u756a\u306b\u62bc\u3059\n// \u65b0\u3057\u3044\u30a6\u30a3\u30f3\u30c9\u30a6\u30923\u3064\u958b\u304f\nse.keystroke(\"nnn\", {using:\"command down\"});\n\n\n\u5927\u6587\u5b57\u3082\u305d\u306e\u307e\u307e\u5165\u529b\u3067\u304d\u307e\u3057\u305f\u3002\n\u5927\u6587\u5b57\u306fshift + \u5c0f\u6587\u5b57\u306a\u306e\u3067\u3001\"shift down\"\u3092\u66f8\u304f\u5fc5\u8981\u306f\u306a\u304f\u306a\u308a\u307e\u3059\u3002\ncommand + shift + n\u3068\u3044\u3046\u30b7\u30e7\u30fc\u30c8\u30ab\u30c3\u30c8\u30ad\u30fc\u3092\u62bc\u3057\u305f\u3044\u5834\u5408\u3001.keystroke(\"N\", {using:\"command down\"})\u3060\u3051\u3067\u3044\u3051\u307e\u3059\u3002\n\n.keyCode()\n.keystroke\u3067\u62bc\u305b\u306a\u3044\u30ad\u30fc\u306e\u5834\u5408\u306f.keyCode\u3092\u4f7f\u3044\u307e\u3059\u3002\n.keystroke\u3068\u540c\u69d8\u306b\u3001\u7279\u6b8a\u30ad\u30fc\u306e\u540c\u6642\u62bc\u3057\u3082\u53ef\u80fd\u3067\u3059\u3002\n(\u8ffd\u8a18: Macbook\u306eJIS\u30ad\u30fc\u30dc\u30fc\u30c9\u3067\u3057\u304b\u8a66\u3057\u3066\u3044\u307e\u305b\u3093\u304c\u3001\u30ad\u30fc\u30dc\u30fc\u30c9\u306e\u914d\u5217\u306b\u3088\u3063\u3066\u3082\u7570\u306a\u308b\u3063\u307d\u3044\u306e\u3067\u3053\u3053\u306b\u66f8\u3044\u3066\u3042\u308b\u901a\u308a\u306b\u306f\u306a\u3089\u306a\u3044\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u3002)\n\u5404\u30ad\u30fc\u3092\u8868\u3059\u6570\u5024\u3092\u5165\u529b\u3057\u3066\u4f7f\u3044\u307e\u3059\u3002\n\u305f\u3068\u3048\u3070\u3001\u300c\u82f1\u6570\u300d\u30ad\u30fc\u306f102\u3001\u300c\u304b\u306a\u300d\u30ad\u30fc\u306f104\u3067\u3059\u3002\n\n\u30ad\u30fc\u30b3\u30fc\u30c9\u3092\u6307\u5b9a\u3057\u3066\u62bc\u3059\n// \u300c\u304b\u306a\u300d\u30ad\u30fc\u3092\u62bc\u3059\nse.keyCode(104);\n\n// \u300c\u82f1\u6570\u300d\u30ad\u30fc\u3092\u62bc\u3059\nse.keyCode(102);\n\n\n.keyCode\u3082\u8907\u6570\u306e\u5165\u529b\u304c\u53ef\u80fd\u3067\u3059\u3002\n\u30ad\u30fc\u30b3\u30fc\u30c9\u306e\u914d\u5217\u3092\u6e21\u3057\u307e\u3059\u3002\n\n\u8907\u6570\u306e\u30ad\u30fc\u30b3\u30fc\u30c9\u3092\u9806\u756a\u306b\u62bc\u3059\nse.keyCode(104); //\u300c\u304b\u306a\u300d\u30ad\u30fc\u3092\u62bc\u3059\n\nse.keyCode([40, 31, 45, 45, 45, 34, 8, 4, 34, 13, 0]);\n\n\n\u300c\u3053\u3093\u306b\u3061\u308f\u300d\u3068\u5165\u529b\u3055\u308c\u307e\u3057\u305f\u304b\uff1f\n\n\u30ad\u30fc\u30b3\u30fc\u30c9\u306e\u78ba\u8a8d\u65b9\u6cd5\n\u3060\u3044\u305f\u3044\u3053\u306e\u30da\u30fc\u30b8\u306b\u66f8\u3044\u3066\u3042\u308a\u307e\u3059\u3002\n\nHys.LOG : Mac \u306e\u30ad\u30fc\u30b3\u30fc\u30c9 2012 (Full Keyboard)\n\n\u307e\u305f\u306f\u4ee5\u4e0b\u306e\u30b3\u30de\u30f3\u30c9\u3067\u3001\u30d0\u30fc\u30c1\u30e3\u30eb\u30ad\u30fc\u30dc\u30fc\u30c9\u306e\u30ad\u30fc\u30b3\u30fc\u30c9\u3092\u5168\u90e8\u898b\u308c\u307e\u3059\u3002\u305f\u3076\u3093\u5168\u90e8\u3002\ngrep 'kVK_.*=' /System/Library/Frameworks/Carbon.framework/Frameworks/HIToolbox.framework/Headers/Events.h\n\n\u30ad\u30fc\u30dc\u30fc\u30c9\u3092\u62bc\u3057\u3066\u30ad\u30fc\u30b3\u30fc\u30c9\u3092\u500b\u5225\u306b\u78ba\u8a8d\u3057\u305f\u3044\u5834\u5408\u3001Karabiner (\u5143KeyRemap4MacBook) \u306eEvent Viewer\u304c\u4fbf\u5229\u3067\u3059\u3002\n\nKarabiner - OS X\u7528\u306e\u30bd\u30d5\u30c8\u30a6\u30a7\u30a2#\u30ad\u30fc\u30ea\u30de\u30c3\u30d7\u306e\u7d50\u679c\u3092\u78ba\u8a8d\u3059\u308b\u65b9\u6cd5\n\nEvent Viewer\u306f\u3001\u62bc\u3057\u305f\u30ad\u30fc\u306e\u30ad\u30fc\u30b3\u30fc\u30c9\u309216\u9032\u6570\u3067\u8868\u793a\u3057\u3066\u304f\u308c\u307e\u3059\u3002\nJavaScript\u306f\u666e\u901a\u306b16\u9032\u6570\u306e\u6570\u5024\u3082\u6271\u3048\u308b\u306e\u3067\u3001\u3082\u3061\u308d\u3093\u305d\u306e\u307e\u307e\u5165\u529b\u3067\u304d\u307e\u3059\u3002\n\n16\u9032\u6570\n// true\n102 == 0x66;\n\n// \u300c\u82f1\u6570\u300d\u30ad\u30fc\u3092\u62bc\u3059\nse.keyCode(0x66);\n\n\n\n\u51fa\u6765\u306a\u3044\u3053\u3068\n\n\u62bc\u3057\u305f\u307e\u307e\u306b\u3059\u308b\u3053\u3068 (\u62bc\u3059\u3053\u3068\u3057\u304b\u7121\u7406)\n\u7279\u6b8a\u30ad\u30fc\u4ee5\u5916\u306e\u30ad\u30fc\u3092\u540c\u6642\u62bc\u3057\u3059\u308b\u3053\u3068\n\n(\u3059\u308b\u65b9\u6cd5\u304c\u3042\u308c\u3070\u6559\u3048\u3066\u304f\u3060\u3055\u3044\u3002)\n\u3042\u3068\u3001.keystroke\u3067\u306f\u30bf\u30d6\u3001\u30b9\u30da\u30fc\u30b9\u3092\u305d\u306e\u307e\u307e\u5165\u529b\u3067\u304d\u306a\u3044\u3088\u3046\u3067\u3059\u3002\n(\u6e21\u3059\u6587\u5b57\u5217\u306b\u30b9\u30da\u30fc\u30b9\u3084\u30bf\u30d6\u304c\u542b\u307e\u308c\u3066\u3044\u308b\u3068\u3001\u306a\u305c\u304b\u65e5\u672c\u8a9e\u5165\u529b\u304cON\u306b\u306a\u308a\u307e\u3059)\n(\u8ffd\u8a18: \u30bf\u30d6\u306f\"\\t\"\u3067\u5165\u529b\u3067\u304d\u307e\u3057\u305f\u3002\u30b3\u30e1\u30f3\u30c8\u3042\u308a\u304c\u3068\u3046\u3054\u3056\u3044\u307e\u3059\uff01)\n.keycode\u3067\u4ee3\u7528\u3059\u308b\u5834\u5408\u306f\u30b9\u30da\u30fc\u30b9\u30ad\u30fc\u306f0x31\u3001\u30bf\u30d6\u30ad\u30fc\u306f0x30\u3067\u3059\u3002\n\u6587\u5b57\u5217\u3092\u30ad\u30fc\u30b3\u30fc\u30c9\u306e\u914d\u5217\u306b\u3059\u308b\u95a2\u6570\u3092\u4f5c\u308b\u3068\u9762\u767d\u3044\u304b\u3082\u3067\u3059\u306d\u3002\n\n\u6587\u5b57\u5217\u3092\u30ad\u30fc\u30b3\u30fc\u30c9\u306e\u914d\u5217\u306b(\u9069\u5f53\u306b)\u5909\u63db\u3059\u308b\u95a2\u6570\nCODES = {\"a\":0,\"b\":11,\"c\":8,\"d\":2,\"e\":14,\"f\":3,\"g\":5,\"h\":4,\"i\":34,\"j\":38,\"k\":40,\"l\":37,\"m\":46,\"n\":45,\"o\":31,\"p\":35,\"q\":12,\"r\":15,\"s\":1,\"t\":17,\"u\":32,\"v\":9,\"w\":13,\"x\":7,\"y\":16,\"z\":6,\"0\":29,\"1\":18,\"2\":19,\"3\":20,\"4\":21,\"5\":23,\"6\":22,\"7\":26,\"8\":28,\"9\":25,\"-\":27,\"+\":24,\"[\":33,\"]\":30,\"=\":42,\";\":41,\"\u2018\":39,\",\":43,\".\":47,\"/\":44,\" \":49,\"\\t\":48,\"\\n\":52};\n\nfunction codes(str){\n  var codes = [];\n  for (var i = 0, code, char; char = str[i++];) {\n    code = CODES[char.toLowerCase()];\n    if (code != undefined) codes.push(code);\n  };\n  return codes;\n};\n\n\n\n\u6587\u5b57\u5217\u304b\u3089\u5909\u63db\u3057\u305f\u3082\u306e\u3092\u8a66\u3057\u306b\u4f7f\u3063\u3066\u307f\u308b\nApplication(\"System Events\").keyCode([34, 49, 17, 4, 31, 32, 5, 4, 17, 49, 13, 4, 0, 17, 49, 34, 2, 49, 2, 31, 49, 13, 0, 1, 43, 49, 34, 2, 49, 35, 15, 14, 17, 14, 45, 2, 49, 34, 49, 13, 0, 1, 49, 31, 45, 14, 49, 31, 3, 49, 17, 4, 31, 1, 14, 49, 2, 14, 0, 3, 27, 46, 32, 17, 14, 1, 47]);\n\n\n\n\u30de\u30a6\u30b9\u30af\u30ea\u30c3\u30af\u3092\u30a8\u30df\u30e5\u30ec\u30fc\u30c8\n\u30de\u30a6\u30b9\u306e\u30af\u30ea\u30c3\u30af\u306b\u3082System Events\u3092\u4f7f\u3044\u307e\u3059\u3002\n\u3053\u3061\u3089\u306f\u30ad\u30fc\u30dc\u30fc\u30c9\u306e\u30a8\u30df\u30e5\u30ec\u30fc\u30c8\u3068\u306f\u5c11\u3057\u52dd\u624b\u304c\u9055\u3044\u307e\u3059\u3002\n\u300c\u3042\u306e\u30a6\u30a3\u30f3\u30c9\u30a6\u306e\u3042\u306e\u30dc\u30bf\u30f3\u3092\u62bc\u3057\u305f\u3044\u300d\n\u3068\u3044\u3046\u3088\u3046\u306b\u3001Mac\u306e\u753b\u9762\u5185\u306e\u90e8\u54c1(\u4ee5\u4e0bGUI)\u3092\u6307\u5b9a\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\n\u3053\u306e\u6a5f\u80fd\u3092\u4f7f\u3046\u305f\u3081\u306b\u306f\u3001GUI\u306b\u30a2\u30af\u30bb\u30b9\u3059\u308b\u8a31\u53ef\u3092\u5f97\u306a\u3051\u308c\u3070\u3044\u3051\u307e\u305b\u3093\u3002\n\u74b0\u5883\u8a2d\u5b9a > \u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u3068\u30d7\u30e9\u30a4\u30d0\u30b7\u30fc > \u30d7\u30e9\u30a4\u30d0\u30b7\u30fc > \u30a2\u30af\u30bb\u30b7\u30d3\u30ea\u30c6\u30a3\n\u3092\u958b\u304d\u3001\u30b9\u30af\u30ea\u30d7\u30c8\u30a8\u30c7\u30a3\u30bf\u304b\u30bf\u30fc\u30df\u30ca\u30eb\u3001\u4f7f\u3063\u3066\u3044\u308b\u3082\u306e\u306b\u8a31\u53ef\u3092\u4e0e\u3048\u3066\u304f\u3060\u3055\u3044\u3002\n\n\u3067\u304d\u307e\u3057\u305f\u304b\uff1f\nSystem Events\u306euiElementsEnabled()\u3067\u78ba\u8a8d\u3067\u304d\u307e\u3059\u3002\n\nGUI\u306b\u30a2\u30af\u30bb\u30b9\u53ef\u80fd\u304b\u78ba\u8a8d\nui = Application(\"System Events\").uiElementsEnabled();\n// Application(\"AppleScript Utility\").guiScriptingEnabled(); \u3082\u540c\u3058\u3002\n\nconsole.log(ui ? \"\u305b\u3063\u3066\u3044\u3067\u304d\u3066\u308b\u3088\u3002\" : \"\u305b\u3063\u3066\u3044\u3067\u304d\u3066\u306a\u3044\u3088\u3002\");\n\n\n\u3061\u306a\u307f\u306b\u30b7\u30b9\u30c6\u30e0\u74b0\u5883\u8a2d\u5b9a\u3082JXA\u3067\u64cd\u4f5c\u3067\u304d\u308b\u306e\u3067\u3001\u4ee5\u4e0b\u306e\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u5b9f\u884c\u3059\u308c\u3070\u4e0a\u306e\u753b\u50cf\u306b\u3042\u308b\u8a2d\u5b9a\u753b\u9762\u304c\u958b\u304d\u307e\u3059\u3002\n(\u6307\u5b9a\u3057\u305f\u753b\u9762\u3092\u8868\u793a\u3067\u304d\u308b\u3060\u3051\u3002\u30b9\u30af\u30ea\u30d7\u30c8\u3067\u8a2d\u5b9a\u5909\u66f4\u306f\u3067\u304d\u306a\u3044\u3002)\nvar pref = Application(\"System Preferences\");\npref.panes.byId(\"com.apple.preference.security\").anchors[\"Privacy_Accessibility\"].reveal();\npref.activate();\n\n\n\u3068\u308a\u3042\u3048\u305a\u30af\u30ea\u30c3\u30af\u3057\u3066\u307f\u308b\nApple\u30e1\u30cb\u30e5\u30fc\u306e\u300c\u3053\u306eMac\u306b\u3064\u3044\u3066\u300d\u3092\u62bc\u3057\u3066\u307f\u307e\u3059\u3002\n\n\u300c\u3053\u306eMac\u306b\u3064\u3044\u3066\u300d\u3092\u30af\u30ea\u30c3\u30af\nvar finder = Application(\"System Events\").processes[\"Finder\"];\n\nvar e = finder.menuBars[0].menuBarItems[\"Apple\"].menus[\"Apple\"].menuItems[\"\u3053\u306e Mac \u306b\u3064\u3044\u3066\"];\n\ne.click(); // \u8981\u7d20\u3092\u9078\u3093\u3067.click()\u3092\u547c\u3076\u3060\u3051\n\n\n\u3061\u3083\u3093\u3068\u300c\u3053\u306eMac\u306b\u3064\u3044\u3066\u300d\u304c\u8868\u793a\u3055\u308c\u307e\u3057\u305f\u304b\uff1f\n\u3042\u3001\u914d\u5217\u3092\u8fd4\u3059\u30e1\u30bd\u30c3\u30c9\u306f[]\u306b\u6587\u5b57\u5217\u3092\u6e21\u3059\u3068name\u3092\u6307\u5b9a\u3057\u3066\u8981\u7d20\u3092\u53d6\u5f97\u3067\u304d\u307e\u3059\u3002\n(byname\u304c\u547c\u3073\u51fa\u3055\u308c\u307e\u3059\u3002)\n(\u8ffd\u8a18\uff1a\u3053\u306e\u30b3\u30fc\u30c9\u306f\u30e1\u30cb\u30e5\u30fc\u30d0\u30fc\u3092\u30af\u30ea\u30c3\u30af\u3057\u3066\u3044\u307e\u3059\u3002Mac\u306e\u3044\u3064\u304b\u306e\u30a2\u30c3\u30d7\u30c7\u30fc\u30c8\u3067\u30e1\u30cb\u30e5\u30fc\u30d0\u30fc\u306f\u96a0\u3059\u3088\u3046\u306b\u8a2d\u5b9a\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3057\u305f\u3002Mac\u306e\u30e1\u30cb\u30e5\u30fc\u30d0\u30fc\u304c\u96a0\u308c\u3066\u3044\u308b\u5834\u5408\u306b\u306f\u52d5\u304d\u307e\u305b\u3093\u3002)\n\nUIElement\n\u307e\u305a\u306fSystem Events\u304b\u3089\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u30d7\u30ed\u30bb\u30b9\u3092\u53d6\u5f97\u3057\u307e\u3059\u3002\n\u30d7\u30ed\u30bb\u30b9\u304b\u3089\u30e1\u30cb\u30e5\u30fc\u3084\u30a6\u30a3\u30f3\u30c9\u30a6\u3092\u53d6\u5f97\u3057\u3001\u30a6\u30a3\u30f3\u30c9\u30a6\u304b\u3089\u30dc\u30bf\u30f3\u3092\u53d6\u5f97\u3057\u3001\u3068\u3044\u3046\u98a8\u306b\u5b50\u8981\u7d20\u3092\u53d6\u5f97\u3057\u3066\u3044\u304f\u3053\u3068\u306b\u306a\u308a\u307e\u3059\u3002\n\u30d7\u30ed\u30bb\u30b9\u3082\u542b\u3081\u3001\u305d\u308c\u3089\u306f \u5168\u3066UIElement\u306e\u30b5\u30d6\u30af\u30e9\u30b9 \u3067\u3059\u3002\n(System Events\u81ea\u4f53\u306f\u9055\u3044\u307e\u3059\u3002)\nUIElement\u306e\u5b50\u8981\u7d20\u306f.uiElements\u3067\u53d6\u5f97\u3067\u304d\u307e\u3059\u3002\n\u307e\u305f\u306f.menuBars\u3084.windows\u3068\u3044\u3046\u3088\u3046\u306a\u30af\u30e9\u30b9\u540d\u306e\u8907\u6570\u5f62\u30d7\u30ed\u30d1\u30c6\u30a3\u3067\u3082\u53d6\u5f97\u3067\u304d\u307e\u3059\u3002\nSystem Events\u304b\u3089\u53c2\u7167\u3067\u304d\u308b\u5168\u3066\u306eUI Elements\u3092\u4e00\u89a7\u3059\u308b\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u66f8\u3044\u305f\u306e\u3067\u4f7f\u3063\u3066\u307f\u3066\u304f\u3060\u3055\u3044\u3002\nhttps://github.com/zakuroishikuro/JXA-scripts/blob/master/ui-finder.js\n\n(\u3053\u308c\u4f7f\u3063\u3066\u3060\u3044\u305f\u3044\u3069\u3093\u306a\u611f\u3058\u304b\u5206\u304b\u3063\u305f\u3089\u3001\u3053\u3053\u304b\u3089\u4e0b\u306f\u8aad\u307e\u306a\u304f\u3066\u3044\u3044\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u3002\u9577\u3044\u3057\u3002\u6821\u6b63\u3057\u305f\u3044\u3051\u3069\u3081\u3093\u3069\u3044\u306e\u3067\u7121\u7406\u3067\u3059\u3002)\n\nApplicationProcess\nSystem Events\u304b\u3089uiElements\u3092\u53d6\u5f97\u3057\u3066\u3044\u304d\u307e\u3059\u3002\n\nApplicationProcess\u3092\u53d6\u5f97\nvar se = Application(\"System Events\");\nvar elements = se.uiElements();\n\nconsole.log(\"\u53c2\u7167\u53ef\u80fd\u306a\u30d7\u30ed\u30bb\u30b9\u6570: \" + elements.length);\n\nvar e = elements[0]; //\u6700\u521d\u306e\u4e00\u3064\u3092\u53d6\u308a\u51fa\u3059\n\nconsole.log(\"\u6700\u521d\u306e\u30d7\u30ed\u30bb\u30b9: \");\nconsole.log(\"  class: \" + e.class());\nconsole.log(\"   name: \" + e.name());\n\n\n\n\u53c2\u7167\u53ef\u80fd\u306a\u30d7\u30ed\u30bb\u30b9\u6570: 49\n\u6700\u521d\u306e\u30d7\u30ed\u30bb\u30b9: \n class: applicationProcess\n  name: loginwindow\n\n\u914d\u5217\u306e\u6700\u521d\u306b\u306f\u3001loginwindow\u3068\u3044\u3046\u540d\u524d\u306eApplicationProcess\u304c\u5165\u3063\u3066\u3044\u307e\u3057\u305f\u3002\nApplicationProcess\u306fProcess\u306e\u30b5\u30d6\u30af\u30e9\u30b9\u3067\u3001Process\u306fUIElement\u306e\u30b5\u30d6\u30af\u30e9\u30b9\u3067\u3059\u3002\n.uiElements\u3060\u3051\u3067\u306a\u304f\u3001\u305d\u306e\u30b5\u30d6\u30af\u30e9\u30b9\u3092\u8907\u6570\u5f62\u306b\u3057\u305f\u30d7\u30ed\u30d1\u30c6\u30a3\u540d\u3067\u3082\u53d6\u5f97\u3067\u304d\u307e\u3059\u3002\nSystem Events\u306e .uiElements .processes .applicationProcesses\u306f\u5168\u3066\u540c\u3058\u3067\u3059\u3002\u597d\u304d\u306a\u547c\u3073\u65b9\u3067\u69cb\u3044\u307e\u305b\u3093\u3002\n\n\u30b5\u30d6\u30af\u30e9\u30b9\u306e\u8907\u6570\u7cfb\u3067\u3082\u53d6\u5f97\u53ef\u80fd\nvar elements    = se.uiElements();\nvar processes     = se.processes();\nvar app_processes = se.applicationProcesses();\n\nconsole.log(elements.length);\nconsole.log(processes.length);\nconsole.log(app_processes.length);\n\n\n\n49\n49\n49\n\n\u3042\u3068\u3001\u7d1b\u3089\u308f\u3057\u3044\u3067\u3059\u304cApplication\u30af\u30e9\u30b9\u3068\u306f\u7570\u306a\u308b\u3053\u3068\u306b\u6ce8\u610f\u3057\u3066\u304f\u3060\u3055\u3044\u3002\nSystem Events\u81ea\u4f53\u306fUIElements\u3067\u306a\u304fApplication\u3067\u3059\u3002UIElement\u306e\u30e1\u30bd\u30c3\u30c9\u306f\u547c\u3079\u307e\u305b\u3093\u3002\n\u3059\u3079\u3066\u306e\u30d7\u30ed\u30bb\u30b9\u306e\u540d\u524d\u3092\u8868\u793a\u3057\u3066\u307f\u307e\u3057\u3087\u3046\u3002\n\u30af\u30e9\u30b9\u306f\u5168\u3066ApplicationProcess\u3067\u3059\u3002\n\n\u30a2\u30af\u30bb\u30b9\u53ef\u80fd\u306a\u5168\u3066\u306e\u30d7\u30ed\u30bb\u30b9\u306e\u540d\u524d\u3092\u8868\u793a\nprocesses = se.processes();\n\nprocesses.forEach(function(p, i){ console.log(i + \": \" + p.name()) });\n\n\n\n0: loginwindow\n1: SystemUIServer\n2: Dock\n3: Finder\n(\u4e2d\u7565)\n33: com.apple.WebKit.WebContent\n34: Kobito\n35: JapaneseIM\n36: System Events\n\n\nUI Elements\u3092\u8fbf\u3063\u3066\u307f\u308b\n\u4e0a\u306e\u30b3\u30fc\u30c9\u306b\u3042\u308b\n\n\u300c\u3053\u306eMac\u306b\u3064\u3044\u3066\u300d\u306e\u30d1\u30b9\nfinder.menuBars[0].menuBarItems[\"Apple\"].menus[\"Apple\"].menuItems[\"\u3053\u306e Mac \u306b\u3064\u3044\u3066\"];\n\n\n\u307f\u305f\u3044\u306a\u30d1\u30b9\u3092\u8abf\u3079\u308b\u305f\u3081\u306b\u3001.uiElements\u3092\u4e00\u3064\u305a\u3064\u8fbf\u3063\u3066\u307f\u307e\u3057\u3087\u3046\u3002\n\u3044\u3061\u3044\u3061\u8868\u793a\u306e\u51e6\u7406\u3092\u66f8\u304f\u306e\u306f\u3081\u3093\u3069\u304f\u3055\u3044\u306e\u3067\u3001\u5b50UI Element\u306e\u540d\u524d\u3068\u30af\u30e9\u30b9\u3092\u5168\u3066\u8868\u793a\u3059\u308b\u95a2\u6570\u3092\u7528\u610f\u3057\u307e\u3057\u305f\u3002\n\n\u5b50UI\u306e\u60c5\u5831\u3092\u8868\u793a\u3059\u308b(class,name,description\u306e\u9806)\nfunction wrap(e){\n  return e.class() + \" - \" + e.name() + \" (\" + e.description() + \")\";\n}\n\nfunction print(target){\n  var childs = target.uiElements();\n\n  console.log(\"\\n\" + wrap(target) + \" has \" + childs.length + \" UI Elements.\");\n\n  childs.forEach(function(child, i){\n    console.log(\"-  \" + i + \": \" + wrap(child))\n  });\n\n  console.log(); //\u6539\u884c\n};\n\n\n\u3055\u3063\u305d\u304f\u8868\u793a\u3057\u3066\u3044\u304d\u307e\u3059\u3002\n\nFinder\u306e\u30d7\u30ed\u30bb\u30b9\u76f4\u4e0b\u306euiElements\nprint(finder);\n\n\n\nFinder (applicationProcess) has 2 UI Elements.\n-  0: menuBar - null (\u30e1\u30cb\u30e5\u30fc\u30d0\u30fc)\n-  1: scrollArea - null (\u30c7\u30b9\u30af\u30c8\u30c3\u30d7)\n\n\u30e1\u30cb\u30e5\u30fc\u30d0\u30fc\u3068\u30c7\u30b9\u30af\u30c8\u30c3\u30d7\u304c\u898b\u3048\u307e\u3057\u305f\u3002\n\u30e1\u30cb\u30e5\u30fc\u30d0\u30fc\u3092\u8fbf\u308a\u307e\u3059\u3002\n\nmenuBars\nprint( finder.menuBars[0] );\n\n\n\nmenuBar - null (\u30e1\u30cb\u30e5\u30fc\u30d0\u30fc) has 8 UI Elements.\n-  0: menuBarItem - Apple (\u30e1\u30cb\u30e5\u30fc\u30d0\u30fc\u9805\u76ee)\n-  1: menuBarItem - Finder (\u30e1\u30cb\u30e5\u30fc\u30d0\u30fc\u9805\u76ee)\n-  2: menuBarItem - \u30d5\u30a1\u30a4\u30eb (\u30e1\u30cb\u30e5\u30fc\u30d0\u30fc\u9805\u76ee)\n-  3: menuBarItem - \u7de8\u96c6 (\u30e1\u30cb\u30e5\u30fc\u30d0\u30fc\u9805\u76ee)\n-  4: menuBarItem - \u8868\u793a (\u30e1\u30cb\u30e5\u30fc\u30d0\u30fc\u9805\u76ee)\n-  5: menuBarItem - \u79fb\u52d5 (\u30e1\u30cb\u30e5\u30fc\u30d0\u30fc\u9805\u76ee)\n-  6: menuBarItem - \u30a6\u30a4\u30f3\u30c9\u30a6 (\u30e1\u30cb\u30e5\u30fc\u30d0\u30fc\u9805\u76ee)\n-  7: menuBarItem - \u30d8\u30eb\u30d7 (\u30e1\u30cb\u30e5\u30fc\u30d0\u30fc\u9805\u76ee)\n\n\u30af\u30e9\u30b9\u540d\u306b\u5408\u308f\u305b\u3066.menuBars\u3068\u3057\u3066\u3044\u307e\u3059\u304c\u3001.uiElements\u3067\u3082\u540c\u3058\u3067\u3059\n\u30e1\u30cb\u30e5\u30fc\u304b\u3089\u300cApple\u300d\u3092\u9078\u3073\u307e\u3059\u3002\n\nmenuBarItems\nprint( finder.menuBars[0].menuBarItems[\"Apple\"] );\n\n\n\nmenuBarItem - Apple (\u30e1\u30cb\u30e5\u30fc\u30d0\u30fc\u9805\u76ee) has 1 UI Elements.\n-  0: menu - Apple (\u30e1\u30cb\u30e5\u30fc)\n\n...\u30e1\u30cb\u30e5\u30fc\u306e\u4e2d\u306b\u30e1\u30cb\u30e5\u30fc\u304c\u8907\u6570\u3042\u308b\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u3057\u306d\u3002\u4ed5\u65b9\u306a\u3044\u306d\u3002\n\nmenus\nprint( finder.menuBars[0].menuBarItems[\"Apple\"].menus[0] );\n\n\n\nmenu - Apple (\u30e1\u30cb\u30e5\u30fc) has 19 UI Elements.\n-  0: menuItem - \u3053\u306e Mac \u306b\u3064\u3044\u3066 (\u30e1\u30cb\u30e5\u30fc\u9805\u76ee)\n-  1: menuItem - \u30b7\u30b9\u30c6\u30e0\u60c5\u5831... (\u30e1\u30cb\u30e5\u30fc\u9805\u76ee)\n-  2: menuItem - null (\u30e1\u30cb\u30e5\u30fc\u9805\u76ee)\n-  3: menuItem - \u30b7\u30b9\u30c6\u30e0\u74b0\u5883\u8a2d\u5b9a... (\u30e1\u30cb\u30e5\u30fc\u9805\u76ee)\n~~~~~~~~\u4e2d\u7565~~~~~~~~~\n-  14: menuItem - \u30b7\u30b9\u30c6\u30e0\u7d42\u4e86... (\u30e1\u30cb\u30e5\u30fc\u9805\u76ee)\n-  15: menuItem - \u30b7\u30b9\u30c6\u30e0\u7d42\u4e86 (\u30e1\u30cb\u30e5\u30fc\u9805\u76ee)\n-  16: menuItem - null (\u30e1\u30cb\u30e5\u30fc\u9805\u76ee)\n-  17: menuItem - (USER) \u3092\u30ed\u30b0\u30a2\u30a6\u30c8... (\u30e1\u30cb\u30e5\u30fc\u9805\u76ee)\n-  18: menuItem - (USER) \u3092\u30ed\u30b0\u30a2\u30a6\u30c8 (\u30e1\u30cb\u30e5\u30fc\u9805\u76ee)\n\n...\u3084\u3063\u3068\u898b\u3048\u307e\u3057\u305f\u306d\u3002\u304a\u75b2\u308c\u3055\u307e\u3067\u3057\u305f\u3002\n\u666e\u901a\u306f\u3053\u3093\u306a\u3081\u3093\u3069\u304f\u3055\u3044\u3053\u3068\u3057\u307e\u305b\u3093\u3002\n\u3069\u3046\u306a\u3063\u3066\u3044\u308b\u306e\u304b\u3092\u77e5\u3063\u3066\u304a\u3051\u3070\u4fbf\u5229\u3068\u3044\u3046\u3060\u3051\u3067\u3059\u3002\n\u30e1\u30cb\u30e5\u30fc\u3084\u30a6\u30a3\u30f3\u30c9\u30a6\u3092\u6301\u305f\u306a\u3044\u30d7\u30ed\u30bb\u30b9\u3082\u3042\u308a\u307e\u3059\u3002\n\u305f\u3068\u3048\u3070\u3001Dock\u306e\u30d7\u30ed\u30bb\u30b9\u306f\u81ea\u8eab\u306e\u30a2\u30a4\u30b3\u30f3\u306e\u914d\u5217\u3057\u304b\u6301\u3063\u3066\u3044\u307e\u305b\u3093\u3002\n\n\u5b50UI\u3092\u5168\u3066\u53d6\u5f97 (.entireContents)\n\u5b50UI\u3092\u4e00\u62ec\u3067\u53d6\u5f97\u3059\u308b\u65b9\u6cd5\u304c\u3042\u308a\u307e\u3059\u3002\nUIElement\u304b\u3089.entireContents\u3092\u547c\u3076\u306e\u3067\u3059\u3002\n\nUIElement#entireContents\nall = finder.entireContents();\n\nall.length;\n\n\n\n338\n\nall.slice(0, 5);\n\n\n[Application(\"System Events\").applicationProcesses.byName(\"Finder\").menuBars.at(0), Application(\"System Events\").applicationProcesses.byName(\"Finder\").menuBars.at(0).menuBarItems.byName(\"Apple\"), Application(\"System Events\").applicationProcesses.byName(\"Finder\").menuBars.at(0).menuBarItems.byName(\"Apple\").menus.byName(\"Apple\"), Application(\"System Events\").applicationProcesses.byName(\"Finder\").menuBars.at(0).menuBarItems.byName(\"Apple\").menus.byName(\"Apple\").menuItems.byName(\"\u3053\u306e Mac \u306b\u3064\u3044\u3066\"), Application(\"System Events\").applicationProcesses.byName(\"Finder\").menuBars.at(0).menuBarItems.byName(\"Apple\").menus.byName(\"Apple\").menuItems.byName(\"\u30b7\u30b9\u30c6\u30e0\u60c5\u5831...\")]\n\n...\u898b\u8f9b\u3044\u3002\n\u591a\u3059\u304e\u3066\u624b\u306b\u4f59\u308a\u307e\u3059\u3057\u3001\u6271\u3044\u3082\u56f0\u96e3\u3067\u3059\u3002\n.entireContents\u304b\u3089\u306f[]\u3067\u4f4d\u7f6e\u3084\u540d\u524d\u3067\u6307\u5b9a\u3057\u3066\u53d6\u308a\u51fa\u3059\u3053\u3068\u306f\u3067\u304d\u307e\u305b\u3093\u3002\n.uiElements[\"\u306a\u307e\u3048\"]\u307f\u305f\u3044\u306a\u7d5e\u308a\u8fbc\u307f\u304c\u3067\u304d\u306a\u3044\u306e\u3067\u3059\u3002\n(\u3053\u308c\u306b\u6c17\u3065\u304f\u307e\u3067\u76f8\u5f53\u82e6\u52b4\u3057\u307e\u3057\u305f\u3002\u30cd\u30c3\u30c8\u3067\u60c5\u5831\u3092\u63a2\u3057\u3066\u3082\u5168\u304f\u898b\u5f53\u305f\u308a\u307e\u305b\u3093\u3057...)\n.entireContents()\u3092\u547c\u3076\u3068UIElement\u306e\u914d\u5217\u304c\u53d6\u5f97\u3067\u304d\u308b\u306e\u3067\u3001\u305d\u3053\u304b\u3089\u4f4d\u7f6e\u3067\u6307\u5b9a\u3057\u3066\u4f7f\u3046\u3057\u304b\u3042\u308a\u307e\u305b\u3093\u3002\n\u76ee\u7684\u306e\u9805\u76ee\u306fforEach\u3068\u304b\u3067\u5730\u9053\u306b\u63a2\u3059\u3057\u304b\u306a\u3044\u3067\u3059\u3002\nUIElement\u306fconsole.log()\u3057\u3066\u3082[object ObjectSpecifier]\u3068\u3057\u304b\u8868\u793a\u3055\u308c\u307e\u305b\u3093\u3002\n\u6a19\u6e96\u51fa\u529b\u306b\u306f\u3053\u306e\u30d1\u30b9\u3063\u307d\u3044\u3082\u306e\u304c\u8868\u793a\u3055\u308c\u3066\u3044\u307e\u3059\u304c\u3001\u3053\u308c\u3092JXA\u5185\u3067\u6587\u5b57\u5217\u3068\u3057\u3066\u5f97\u308b\u65b9\u6cd5\u306f(\u305f\u3076\u3093)\u306a\u3044\u3067\u3059\u3002\n\n(\u8ffd\u8a182015/2/17:\u3042\u308a\u307e\u3057\u305f\u3002\u666e\u901a\u306bApple\u306e\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u306b\u66f8\u3044\u3066\u3042\u308a\u307e\u3057\u305f\u3002\nAutomation.getDisplayString(hoge)\n\n\nJXA\u306f\u6700\u5f8c\u306b\u8a55\u4fa1\u3057\u305f\u5f0f\u306e\u7d50\u679c\u3092\u5fc5\u305a\u51fa\u529b\u3059\u308b\u306e\u3067\u3001\u305d\u308c\u3092\u30d1\u30a4\u30d7\u3067\u30d5\u30a1\u30a4\u30eb\u306b\u4fdd\u5b58\u3059\u308c\u3070\u4e00\u5fdc\u306f\u6587\u5b57\u5217\u3067\u5f97\u3089\u308c\u307e\u3059\u3002\n\u3042\u3068\u306fRuby\u304b\u306a\u3093\u304b\u3067,\u3067\u5206\u5272\u3057\u3066\u7d5e\u308a\u8fbc\u3080\u3068\u304b\u30fb\u30fb\u30fb\u3002\n$ osascript -l JavaScript -e 'Application(\"System Events\").processes[\"Finder\"].entireContents()' > contents.txt\n\n\nX, Y\u5ea7\u6a19\u3092\u6307\u5b9a\u3057\u3066\u30af\u30ea\u30c3\u30af\n\n\u5ea7\u6a19\u3092\u6307\u5b9a\u3057\u3066\u30af\u30ea\u30c3\u30af\nfinder_app = Application(\"Finder\");\nfinder_app.activate();\n\ndelay(0.1); // activate\u306b\u306a\u308b\u307e\u3067\u5c11\u3057\u304b\u304b\u308b\u306e\u3067\u30010.1\u79d2\u5f85\u3064\n\nfinder = Application(\"System Events\").processes[finder_app.name()];\n\nx = 100;\ny = 10;\n\nfinder.click( {at:[x, y]} );\n\n\nProcess\u30af\u30e9\u30b9\u306eclick()\u306b\u306f\u5ea7\u6a19\u3092\u6e21\u305b\u307e\u3059\u3002\n\u3053\u306e\u30b3\u30fc\u30c9\u3092\u5b9f\u884c\u3057\u305f\u5834\u5408\u3001Finder\u306e\u300cFinder\u300d\u30e1\u30cb\u30e5\u30fc\u304c\u30af\u30ea\u30c3\u30af\u3055\u308c\u307e\u3059\u3002(\u3055\u308c\u308b\u306f\u305a\u3067\u3059\u3002)\n[x, y]\u306f\u30b0\u30ed\u30fc\u30d0\u30eb\u5ea7\u6a19\u3067\u3059\u3002\nUIElement\u5185\u306e\u76f8\u5bfe\u7684\u306a\u5ea7\u6a19\u3067\u306f\u306a\u304f\u3001\u753b\u9762\u5185\u306e\u7d76\u5bfe\u5ea7\u6a19\u3067\u3059\u3002\nCSS\u30d4\u30af\u30bb\u30eb\u3067\u3059\u304b\u3089\u3001Retina\u30c7\u30a3\u30b9\u30d7\u30ec\u30a4\u3067\u3082\u305d\u3046\u3067\u306a\u304f\u3066\u3082\u540c\u3058\u4f4d\u7f6e\u3092\u6307\u3057\u307e\u3059\u3002\nRetina\u30c7\u30a3\u30b9\u30d7\u30ec\u30a4\u306e\u5834\u5408\u306f\u30d4\u30af\u30bb\u30eb\u6570 / 2\u306e\u6570\u5024\u3092\u6307\u5b9a\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\u300c2560 * 1600\u300d\u30d4\u30af\u30bb\u30eb\u306eRetina\u30c7\u30a3\u30b9\u30d7\u30ec\u30a4\u306e\u5834\u5408\u3001x\u306f\u300c0\u301c1279\u300d\u3067\u3001y\u306f\u300c0\u301c799\u300d\u3067\u3059\u3002\n\u305d\u306e\u5ea7\u6a19\u306e\u4f4d\u7f6e\u306b\u305d\u306e\u30d7\u30ed\u30bb\u30b9\u304c\u6301\u3064UIElement\u304c\u5b58\u5728\u3059\u308c\u3070\u30af\u30ea\u30c3\u30af\u3055\u308c\u307e\u3059\u3002\n\u305d\u3057\u3066\u3001\u305d\u306eUIElement\u306e\u53c2\u7167\u304c\u623b\u308a\u5024\u3068\u3057\u3066\u8fd4\u3063\u3066\u304d\u307e\u3059\u3002\nUIElement\u304c\u5b58\u5728\u3057\u306a\u3051\u308c\u3070\u4f55\u3082\u8d77\u304d\u305a\u3001null\u304c\u8fd4\u3063\u3066\u304d\u307e\u3059\u3002\n\u305d\u306e\u30d7\u30ed\u30bb\u30b9\u304c\u6301\u3063\u3066\u3044\u306a\u3044UIElement\u306f\u30af\u30ea\u30c3\u30af\u3067\u304d\u307e\u305b\u3093\u3002\nFinder\u306e\u30d7\u30ed\u30bb\u30b9\u306b\u30c9\u30c3\u30af\u3092\u30af\u30ea\u30c3\u30af\u3055\u305b\u3088\u3046\u3068\u3057\u3066\u3082\u30c7\u30b9\u30af\u30c8\u30c3\u30d7\u306e\u53c2\u7167\u304c\u8fd4\u3063\u3066\u304f\u308b\u3060\u3051\u3067\u3059\u3002\n\u30e1\u30cb\u30e5\u30fc\u3092\u30af\u30ea\u30c3\u30af\u3057\u305f\u3044\u306a\u3089\u3001\u6700\u524d\u9762\u306e\u30a2\u30d7\u30ea\u306e\u30d7\u30ed\u30bb\u30b9\u3092\u6307\u5b9a\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\n\u3044\u307e\u3044\u3061\u7528\u9014\u304c\u5206\u304b\u308a\u307e\u305b\u3093\u3002\n\u3061\u306a\u307f\u306bUIElement\u306f.position()\u3092\u547c\u3079\u3070\u5ea7\u6a19\u3092\u53d6\u5f97\u3067\u304d\u307e\u3059\u3002\n\n\u51fa\u6765\u306a\u3044\u3053\u3068\n\n\u53f3\u30af\u30ea\u30c3\u30af\n\u30db\u30a4\u30fc\u30eb\u30af\u30ea\u30c3\u30af\n\u30c9\u30e9\u30c3\u30b0\n\u30c9\u30e9\u30c3\u30b0&\u30c9\u30ed\u30c3\u30d7\n\n(\u3059\u308b\u65b9\u6cd5\u3042\u308c\u3070\u6559\u3048\u3066\u304f\u3060\u3055\u3044\u3002)\n\nUI Element\u3092\u63a2\u7d22\u3059\u308b\u30c4\u30fc\u30eb\n\u305d\u308d\u305d\u308d\u529b\u5c3d\u304d\u3066\u304d\u305f\u306e\u3067\u3042\u308b\u5834\u6240\u3060\u3051\u3002\n\nAccessibility Inspector\nXCode\u306e\u4e2d\u306b\u3042\u308a\u307e\u3059\u3002\n\u305d\u306e\u307e\u307eJXA\u3067\u4f7f\u3048\u308b\u60c5\u5831\u304c\u8868\u793a\u3055\u308c\u308b\u308f\u3051\u3067\u306f\u3042\u308a\u307e\u305b\u3093\u304c\u3001\u30d2\u30f3\u30c8\u306b\u306f\u306a\u308b\u3068\u601d\u3044\u307e\u3059\u3002\n\n\nUI Browser\n\u3051\u3063\u3053\u3046\u4eba\u6c17\u3089\u3057\u3044\u3002\n$55\u3067\u3059\u300230\u65e5\u9593\u7121\u6599\u3002\nUI Browser\n\n\u86c7\u8db3\nApple Script\u306f\u771f\u9762\u76ee\u306b\u52c9\u5f37\u3059\u308b\u6c17\u304c\u304a\u304d\u305a\u3001\u6700\u8fd1JXA\u3092\u59cb\u3081\u305f\u306b\u308f\u304b\u306a\u306e\u3067\u4f55\u304b\u9593\u9055\u3063\u305f\u8a18\u8ff0\u3092\u3057\u3066\u3044\u305f\u3089\u6559\u3048\u3066\u3044\u305f\u3060\u3051\u308b\u3068\u3042\u308a\u304c\u305f\u3044\u3067\u3059\u3002\n\u6bb4\u308a\u66f8\u304d\u306e\u6587\u7ae0\u3059\u3044\u307e\u305b\u3093\u3057\u305f\u3002\n\n\u53c2\u8003\u30ea\u30f3\u30af\n\nHys.LOG : Mac \u306e\u30ad\u30fc\u30b3\u30fc\u30c9 2012 (Full Keyboard)\nGUI\u30b9\u30af\u30ea\u30d7\u30c6\u30a3\u30f3\u30b0\u3067\u4f7f\u3044\u305f\u304f\u306a\u308b\u9053\u5177 - \u30b6\u30ea\u30ac\u30cb\u304c\u898b\u3066\u3044\u305f...\u3002\nAS Hole\uff08AppleScript\u306e\u7a74\uff09 By Piyomaru Software \u00bb UI Browser 2.5\u304c\u767b\u5834 \u00bb Blog Archive\nApple Script\uff1aUIElementInspector \u304c\u4fbf\u5229\u3067\u3059 - thyVikings : iMac, iPad, iMat by aged engine\n\nJXA\u3092\u77e5\u3089\u306a\u3044\u65b9\u306f\u3068\u308a\u3042\u3048\u305a\u4ee5\u4e0b\u306e\u8a18\u4e8b\u3092\u3069\u3046\u305e\u3002\n\n- [JavaScript for Automation Release Notes](https://developer.apple.com/library/mac/releasenotes/InterapplicationCommunication/RN-JavaScriptForAutomation/) - \u516c\u5f0f\u306e\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\n- [\u9cf6\u5d8b\u5de5\u623f / AppleScript / JavaScript for Automation (JXA)](http://tonbi.jp/AppleScript/JavaScript/)\n- [dtinth/JXA-Cookbook](https://github.com/dtinth/JXA-Cookbook)\n- [\u77e5\u3089\u306a\u3044\u3046\u3061\u306bMac\u304c\u30b7\u30b9\u30c6\u30e0\u6a19\u6e96\u3067JavaScript\u3067\u64cd\u4f5c\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u3063\u3066\u305f (JXA) - Qiita](http://qiita.com/zakuroishikuro/items/1b02378bf9e940602d87)\n\n\u3053\u3053\u3067\u306f\u30ad\u30fc\u30dc\u30fc\u30c9\u3084\u30de\u30a6\u30b9\u306e\u64cd\u4f5c\u3092\u30a8\u30df\u30e5\u30ec\u30fc\u30c8\u3059\u308b\u65b9\u6cd5\u3092\u66f8\u304d\u307e\u3059\u3002\n\u5404\u30a2\u30d7\u30ea\u306b\u7528\u610f\u3055\u308c\u305f\u6a5f\u80fd\u306f\u30b9\u30af\u30ea\u30d7\u30c8\u30a8\u30c7\u30a3\u30bf\u304b\u3089\u898b\u3089\u308c\u308b\u300c\u7528\u8a9e\u8aac\u660e\u300d\u7b49\u306b\u4efb\u305b\u307e\u3059\u3002\n\n\u3061\u3087\u3063\u3068\u3057\u305f\u30b3\u30fc\u30c9\u3092\u8a66\u3059\u306b\u306f`osascript`\u30b3\u30de\u30f3\u30c9\u306e\u30a4\u30f3\u30bf\u30e9\u30af\u30c6\u30a3\u30d6\u30e2\u30fc\u30c9\u304c\u4fbf\u5229\u3067\u3059\u3002\n\n```\n$ osascript -l JavaScript -i\n```\n\u3067\u8d77\u52d5\u3067\u304d\u307e\u3059\u3002\n\n# System Events\n\n`System Events`\u306f\u30b9\u30af\u30ea\u30d7\u30c8\u5c02\u7528\u306e\u3001GUI\u3092\u6301\u305f\u306a\u3044\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3067\u3059\u3002\n\n```js:SystemEvents\u3092\u53d6\u5f97\nvar se = Application(\"System Events\"); //\u53c2\u7167\u3092\u53d6\u5f97\n```\n\n\u3053\u308c\u3092\u4f7f\u3063\u3066\u30e6\u30fc\u30b6\u306e\u64cd\u4f5c\u3092\u30a8\u30df\u30e5\u30ec\u30fc\u30c8\u3067\u304d\u307e\u3059\u3002\n\u4ee5\u4e0b\u3088\u308a\u3001\u5909\u6570`se`\u306b\u306f`Application(\"System Events\")`\u3092\u53c2\u7167\u3057\u3066\u3044\u308b\u3082\u306e\u3068\u3057\u307e\u3059\u3002\n\n# \u30ad\u30fc\u30dc\u30fc\u30c9\u306e\u64cd\u4f5c\u3092\u30a8\u30df\u30e5\u30ec\u30fc\u30c8\n\n\u30ad\u30fc\u30dc\u30fc\u30c9\u3092\u64cd\u4f5c\u3059\u308b\u306b\u306f`.keystroke()`\u3068`.keyCode()`\u3092\u4f7f\u3044\u307e\u3059\u3002\n\n## .keystroke()\n\n\u6e21\u3055\u308c\u305f\u6587\u5b57\u5217\u306e\u30ad\u30fc\u3092\u6253\u9375\u3057\u307e\u3059\u3002\n\n```js:\u300cA\u300d\u30ad\u30fc\u3092\u62bc\u3059\nse.keystroke(\"a\");\n```\n\n2\u3064\u76ee\u306e\u5f15\u6570\u3067\u3001\u540c\u6642\u62bc\u3057\u3059\u308b\u7279\u6b8a\u30ad\u30fc\u3092\u6307\u5b9a\u3067\u304d\u307e\u3059\u3002\n\u8907\u6570\u306e\u5834\u5408\u306f\u914d\u5217\u3067\u6e21\u3057\u307e\u3059\u3002\n\n```js:\u7279\u6b8a\u30ad\u30fc\u3092\u7d44\u307f\u5408\u308f\u305b\u3066\u62bc\u3059\n// command + h (\u30a6\u30a3\u30f3\u30c9\u30a6\u3092\u96a0\u3059)\nse.keystroke(\"h\", {using:\"command down\"});\n\n// command + alt + h (\u4ed6\u306e\u30a6\u30a3\u30f3\u30c9\u30a6\u3092\u96a0\u3059)\nse.keystroke(\"h\", {using:[\"command down\", \"option down\"]});\n```\n\n\u540c\u6642\u62bc\u3057\u306b\u6307\u5b9a\u3067\u304d\u308b\u7279\u6b8a\u30ad\u30fc\u306f\u4ee5\u4e0b\u306e4\u7a2e\u985e\u306e\u307f\u3067\u3059\u3002\n\n||\u6587\u5b57\u5217|\n---|---\n|\u2318|\"command down\"|\n|\u2303|\"control down\"|\n|\u21e7|\"shift down\"|\n|\u2325|\"option down\"|\n\n2\u6587\u5b57\u4ee5\u4e0a\u306a\u3089\u9806\u756a\u306b\u6253\u9375\u3055\u308c\u307e\u3059\u3002\n\n```js:\u8907\u6570\u306e\u30ad\u30fc\u3092\u9806\u756a\u306b\u62bc\u3059\nse.keystroke(\"abc\");\n```\n\n> abc\n\n\u30a8\u30b9\u30b1\u30fc\u30d7\u6587\u5b57\u3082\u53ef\u80fd\u3067\u3059\u3002\n`\\n`\u3067\u30a8\u30f3\u30bf\u30fc\u30ad\u30fc\u304c\u62bc\u3055\u308c\u307e\u3059\u3057\u3001`\\b`\u3067delete\u30ad\u30fc\u304c\u62bc\u3055\u308c\u307e\u3059\u3002\n(\u30ad\u30fc\u30dc\u30fc\u30c9\u306e\u6253\u9375\u306e\u30a8\u30df\u30e5\u30ec\u30fc\u30c8\u306a\u306e\u3067\u3001\u65e5\u672c\u8a9e\u306f\u7121\u7406\u3067\u3059\u3002)\n\n(\u8ffd\u8a18: \u3068\u3001\u601d\u3063\u305f\u3051\u3069`\\n`\u306f\u30a8\u30f3\u30bf\u30fc\u3058\u3083\u306a\u3044\u3063\u307d\u3044\u3067\u3059\u3002\u3053\u3053\u3061\u3087\u3063\u3068\u602a\u3057\u3044\u306e\u3067\u3042\u3093\u307e\u308a\u4fe1\u3058\u306a\u3044\u3067\u304f\u3060\u3055\u3044\u3002)\n\n```js:\u30a8\u30b9\u30b1\u30fc\u30d7\u6587\u5b57\u3092\u62bc\u3059\nse.keystroke(\"//one\\n//twoooooo\\b\\b\\b\\b\\b\\n\");\n```\n\n>//one\n>//two\n\n2\u6587\u5b57\u4ee5\u4e0a\u306e\u6587\u5b57\u5217\u3092\u6e21\u3057\u305f\u72b6\u614b\u3067\u7279\u6b8a\u30ad\u30fc\u3092\u6307\u5b9a\u3059\u308b\u3068 **\u3059\u3079\u3066\u306e\u6587\u5b57\u3067** \u540c\u6642\u62bc\u3057\u3055\u308c\u307e\u3059\u3002\n\n```js:\u8907\u6570\u306e\u30ad\u30fc\u3092\u7279\u6b8a\u30ad\u30fc\u3068\u4e00\u7dd2\u306b\u9806\u756a\u306b\u62bc\u3059\n// \u65b0\u3057\u3044\u30a6\u30a3\u30f3\u30c9\u30a6\u30923\u3064\u958b\u304f\nse.keystroke(\"nnn\", {using:\"command down\"});\n```\n\n\u5927\u6587\u5b57\u3082\u305d\u306e\u307e\u307e\u5165\u529b\u3067\u304d\u307e\u3057\u305f\u3002\n\u5927\u6587\u5b57\u306fshift + \u5c0f\u6587\u5b57\u306a\u306e\u3067\u3001\"shift down\"\u3092\u66f8\u304f\u5fc5\u8981\u306f\u306a\u304f\u306a\u308a\u307e\u3059\u3002\ncommand + shift + n\u3068\u3044\u3046\u30b7\u30e7\u30fc\u30c8\u30ab\u30c3\u30c8\u30ad\u30fc\u3092\u62bc\u3057\u305f\u3044\u5834\u5408\u3001`.keystroke(\"N\", {using:\"command down\"})`\u3060\u3051\u3067\u3044\u3051\u307e\u3059\u3002\n\n## .keyCode()\n\n`.keystroke`\u3067\u62bc\u305b\u306a\u3044\u30ad\u30fc\u306e\u5834\u5408\u306f`.keyCode`\u3092\u4f7f\u3044\u307e\u3059\u3002\n`.keystroke`\u3068\u540c\u69d8\u306b\u3001\u7279\u6b8a\u30ad\u30fc\u306e\u540c\u6642\u62bc\u3057\u3082\u53ef\u80fd\u3067\u3059\u3002\n\n(\u8ffd\u8a18: Macbook\u306eJIS\u30ad\u30fc\u30dc\u30fc\u30c9\u3067\u3057\u304b\u8a66\u3057\u3066\u3044\u307e\u305b\u3093\u304c\u3001\u30ad\u30fc\u30dc\u30fc\u30c9\u306e\u914d\u5217\u306b\u3088\u3063\u3066\u3082\u7570\u306a\u308b\u3063\u307d\u3044\u306e\u3067\u3053\u3053\u306b\u66f8\u3044\u3066\u3042\u308b\u901a\u308a\u306b\u306f\u306a\u3089\u306a\u3044\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u3002)\n\n\u5404\u30ad\u30fc\u3092\u8868\u3059\u6570\u5024\u3092\u5165\u529b\u3057\u3066\u4f7f\u3044\u307e\u3059\u3002\n\u305f\u3068\u3048\u3070\u3001\u300c\u82f1\u6570\u300d\u30ad\u30fc\u306f102\u3001\u300c\u304b\u306a\u300d\u30ad\u30fc\u306f104\u3067\u3059\u3002\n\n```js:\u30ad\u30fc\u30b3\u30fc\u30c9\u3092\u6307\u5b9a\u3057\u3066\u62bc\u3059\n// \u300c\u304b\u306a\u300d\u30ad\u30fc\u3092\u62bc\u3059\nse.keyCode(104);\n\n// \u300c\u82f1\u6570\u300d\u30ad\u30fc\u3092\u62bc\u3059\nse.keyCode(102);\n```\n\n`.keyCode`\u3082\u8907\u6570\u306e\u5165\u529b\u304c\u53ef\u80fd\u3067\u3059\u3002\n\u30ad\u30fc\u30b3\u30fc\u30c9\u306e\u914d\u5217\u3092\u6e21\u3057\u307e\u3059\u3002\n\n```js:\u8907\u6570\u306e\u30ad\u30fc\u30b3\u30fc\u30c9\u3092\u9806\u756a\u306b\u62bc\u3059\nse.keyCode(104); //\u300c\u304b\u306a\u300d\u30ad\u30fc\u3092\u62bc\u3059\n\nse.keyCode([40, 31, 45, 45, 45, 34, 8, 4, 34, 13, 0]);\n```\n\n\u300c\u3053\u3093\u306b\u3061\u308f\u300d\u3068\u5165\u529b\u3055\u308c\u307e\u3057\u305f\u304b\uff1f\n\n### \u30ad\u30fc\u30b3\u30fc\u30c9\u306e\u78ba\u8a8d\u65b9\u6cd5\n\n\u3060\u3044\u305f\u3044\u3053\u306e\u30da\u30fc\u30b8\u306b\u66f8\u3044\u3066\u3042\u308a\u307e\u3059\u3002\n\n- [Hys.LOG : Mac \u306e\u30ad\u30fc\u30b3\u30fc\u30c9 2012 (Full Keyboard)](http://hyslog.com/blog/2012/06/25/569)\n\n\u307e\u305f\u306f\u4ee5\u4e0b\u306e\u30b3\u30de\u30f3\u30c9\u3067\u3001\u30d0\u30fc\u30c1\u30e3\u30eb\u30ad\u30fc\u30dc\u30fc\u30c9\u306e\u30ad\u30fc\u30b3\u30fc\u30c9\u3092\u5168\u90e8\u898b\u308c\u307e\u3059\u3002\u305f\u3076\u3093\u5168\u90e8\u3002\n\n```\ngrep 'kVK_.*=' /System/Library/Frameworks/Carbon.framework/Frameworks/HIToolbox.framework/Headers/Events.h\n```\n\n\u30ad\u30fc\u30dc\u30fc\u30c9\u3092\u62bc\u3057\u3066\u30ad\u30fc\u30b3\u30fc\u30c9\u3092\u500b\u5225\u306b\u78ba\u8a8d\u3057\u305f\u3044\u5834\u5408\u3001Karabiner (\u5143KeyRemap4MacBook) \u306eEvent Viewer\u304c\u4fbf\u5229\u3067\u3059\u3002\n\n- [Karabiner - OS X\u7528\u306e\u30bd\u30d5\u30c8\u30a6\u30a7\u30a2#\u30ad\u30fc\u30ea\u30de\u30c3\u30d7\u306e\u7d50\u679c\u3092\u78ba\u8a8d\u3059\u308b\u65b9\u6cd5](https://pqrs.org/osx/karabiner/document.html#eventviewer)\n\nEvent Viewer\u306f\u3001\u62bc\u3057\u305f\u30ad\u30fc\u306e\u30ad\u30fc\u30b3\u30fc\u30c9\u309216\u9032\u6570\u3067\u8868\u793a\u3057\u3066\u304f\u308c\u307e\u3059\u3002\nJavaScript\u306f\u666e\u901a\u306b16\u9032\u6570\u306e\u6570\u5024\u3082\u6271\u3048\u308b\u306e\u3067\u3001\u3082\u3061\u308d\u3093\u305d\u306e\u307e\u307e\u5165\u529b\u3067\u304d\u307e\u3059\u3002\n\n```js:16\u9032\u6570\n// true\n102 == 0x66;\n\n// \u300c\u82f1\u6570\u300d\u30ad\u30fc\u3092\u62bc\u3059\nse.keyCode(0x66);\n```\n\n## \u51fa\u6765\u306a\u3044\u3053\u3068\n\n- \u62bc\u3057\u305f\u307e\u307e\u306b\u3059\u308b\u3053\u3068 (\u62bc\u3059\u3053\u3068\u3057\u304b\u7121\u7406)\n- \u7279\u6b8a\u30ad\u30fc\u4ee5\u5916\u306e\u30ad\u30fc\u3092\u540c\u6642\u62bc\u3057\u3059\u308b\u3053\u3068\n\n(\u3059\u308b\u65b9\u6cd5\u304c\u3042\u308c\u3070\u6559\u3048\u3066\u304f\u3060\u3055\u3044\u3002)\n\n\u3042\u3068\u3001`.keystroke`\u3067\u306f\u30bf\u30d6\u3001\u30b9\u30da\u30fc\u30b9\u3092\u305d\u306e\u307e\u307e\u5165\u529b\u3067\u304d\u306a\u3044\u3088\u3046\u3067\u3059\u3002\n(\u6e21\u3059\u6587\u5b57\u5217\u306b\u30b9\u30da\u30fc\u30b9\u3084\u30bf\u30d6\u304c\u542b\u307e\u308c\u3066\u3044\u308b\u3068\u3001\u306a\u305c\u304b\u65e5\u672c\u8a9e\u5165\u529b\u304cON\u306b\u306a\u308a\u307e\u3059)\n(\u8ffd\u8a18: \u30bf\u30d6\u306f\"\\t\"\u3067\u5165\u529b\u3067\u304d\u307e\u3057\u305f\u3002\u30b3\u30e1\u30f3\u30c8\u3042\u308a\u304c\u3068\u3046\u3054\u3056\u3044\u307e\u3059\uff01)\n\n`.keycode`\u3067\u4ee3\u7528\u3059\u308b\u5834\u5408\u306f\u30b9\u30da\u30fc\u30b9\u30ad\u30fc\u306f`0x31`\u3001\u30bf\u30d6\u30ad\u30fc\u306f`0x30`\u3067\u3059\u3002\n\n\u6587\u5b57\u5217\u3092\u30ad\u30fc\u30b3\u30fc\u30c9\u306e\u914d\u5217\u306b\u3059\u308b\u95a2\u6570\u3092\u4f5c\u308b\u3068\u9762\u767d\u3044\u304b\u3082\u3067\u3059\u306d\u3002\n\n```js:\u6587\u5b57\u5217\u3092\u30ad\u30fc\u30b3\u30fc\u30c9\u306e\u914d\u5217\u306b(\u9069\u5f53\u306b)\u5909\u63db\u3059\u308b\u95a2\u6570\nCODES = {\"a\":0,\"b\":11,\"c\":8,\"d\":2,\"e\":14,\"f\":3,\"g\":5,\"h\":4,\"i\":34,\"j\":38,\"k\":40,\"l\":37,\"m\":46,\"n\":45,\"o\":31,\"p\":35,\"q\":12,\"r\":15,\"s\":1,\"t\":17,\"u\":32,\"v\":9,\"w\":13,\"x\":7,\"y\":16,\"z\":6,\"0\":29,\"1\":18,\"2\":19,\"3\":20,\"4\":21,\"5\":23,\"6\":22,\"7\":26,\"8\":28,\"9\":25,\"-\":27,\"+\":24,\"[\":33,\"]\":30,\"=\":42,\";\":41,\"\u2018\":39,\",\":43,\".\":47,\"/\":44,\" \":49,\"\\t\":48,\"\\n\":52};\n\nfunction codes(str){\n  var codes = [];\n  for (var i = 0, code, char; char = str[i++];) {\n    code = CODES[char.toLowerCase()];\n    if (code != undefined) codes.push(code);\n  };\n  return codes;\n};\n```\n\n```js:\u6587\u5b57\u5217\u304b\u3089\u5909\u63db\u3057\u305f\u3082\u306e\u3092\u8a66\u3057\u306b\u4f7f\u3063\u3066\u307f\u308b\nApplication(\"System Events\").keyCode([34, 49, 17, 4, 31, 32, 5, 4, 17, 49, 13, 4, 0, 17, 49, 34, 2, 49, 2, 31, 49, 13, 0, 1, 43, 49, 34, 2, 49, 35, 15, 14, 17, 14, 45, 2, 49, 34, 49, 13, 0, 1, 49, 31, 45, 14, 49, 31, 3, 49, 17, 4, 31, 1, 14, 49, 2, 14, 0, 3, 27, 46, 32, 17, 14, 1, 47]);\n```\n\n# \u30de\u30a6\u30b9\u30af\u30ea\u30c3\u30af\u3092\u30a8\u30df\u30e5\u30ec\u30fc\u30c8\n\n\u30de\u30a6\u30b9\u306e\u30af\u30ea\u30c3\u30af\u306b\u3082`System Events`\u3092\u4f7f\u3044\u307e\u3059\u3002\n\n\u3053\u3061\u3089\u306f\u30ad\u30fc\u30dc\u30fc\u30c9\u306e\u30a8\u30df\u30e5\u30ec\u30fc\u30c8\u3068\u306f\u5c11\u3057\u52dd\u624b\u304c\u9055\u3044\u307e\u3059\u3002\n\u300c\u3042\u306e\u30a6\u30a3\u30f3\u30c9\u30a6\u306e\u3042\u306e\u30dc\u30bf\u30f3\u3092\u62bc\u3057\u305f\u3044\u300d\n\u3068\u3044\u3046\u3088\u3046\u306b\u3001Mac\u306e\u753b\u9762\u5185\u306e\u90e8\u54c1(\u4ee5\u4e0bGUI)\u3092\u6307\u5b9a\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\n\n\u3053\u306e\u6a5f\u80fd\u3092\u4f7f\u3046\u305f\u3081\u306b\u306f\u3001GUI\u306b\u30a2\u30af\u30bb\u30b9\u3059\u308b\u8a31\u53ef\u3092\u5f97\u306a\u3051\u308c\u3070\u3044\u3051\u307e\u305b\u3093\u3002\n`\u74b0\u5883\u8a2d\u5b9a > \u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u3068\u30d7\u30e9\u30a4\u30d0\u30b7\u30fc > \u30d7\u30e9\u30a4\u30d0\u30b7\u30fc > \u30a2\u30af\u30bb\u30b7\u30d3\u30ea\u30c6\u30a3`\n\u3092\u958b\u304d\u3001\u30b9\u30af\u30ea\u30d7\u30c8\u30a8\u30c7\u30a3\u30bf\u304b\u30bf\u30fc\u30df\u30ca\u30eb\u3001\u4f7f\u3063\u3066\u3044\u308b\u3082\u306e\u306b\u8a31\u53ef\u3092\u4e0e\u3048\u3066\u304f\u3060\u3055\u3044\u3002\n\n![\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2015-02-10 17.09.16.png](https://qiita-image-store.s3.amazonaws.com/0/18902/e8e5e39d-d844-5b69-38aa-7ccc2c239e3f.png \"\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2015-02-10 17.09.16.png\")\n\n\u3067\u304d\u307e\u3057\u305f\u304b\uff1f\n`System Events`\u306e`uiElementsEnabled()`\u3067\u78ba\u8a8d\u3067\u304d\u307e\u3059\u3002\n\n```js:GUI\u306b\u30a2\u30af\u30bb\u30b9\u53ef\u80fd\u304b\u78ba\u8a8d\nui = Application(\"System Events\").uiElementsEnabled();\n// Application(\"AppleScript Utility\").guiScriptingEnabled(); \u3082\u540c\u3058\u3002\n\nconsole.log(ui ? \"\u305b\u3063\u3066\u3044\u3067\u304d\u3066\u308b\u3088\u3002\" : \"\u305b\u3063\u3066\u3044\u3067\u304d\u3066\u306a\u3044\u3088\u3002\");\n```\n\n\u3061\u306a\u307f\u306b\u30b7\u30b9\u30c6\u30e0\u74b0\u5883\u8a2d\u5b9a\u3082JXA\u3067\u64cd\u4f5c\u3067\u304d\u308b\u306e\u3067\u3001\u4ee5\u4e0b\u306e\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u5b9f\u884c\u3059\u308c\u3070\u4e0a\u306e\u753b\u50cf\u306b\u3042\u308b\u8a2d\u5b9a\u753b\u9762\u304c\u958b\u304d\u307e\u3059\u3002\n(\u6307\u5b9a\u3057\u305f\u753b\u9762\u3092\u8868\u793a\u3067\u304d\u308b\u3060\u3051\u3002\u30b9\u30af\u30ea\u30d7\u30c8\u3067\u8a2d\u5b9a\u5909\u66f4\u306f\u3067\u304d\u306a\u3044\u3002)\n\n```js\nvar pref = Application(\"System Preferences\");\npref.panes.byId(\"com.apple.preference.security\").anchors[\"Privacy_Accessibility\"].reveal();\npref.activate();\n```\n\n## \u3068\u308a\u3042\u3048\u305a\u30af\u30ea\u30c3\u30af\u3057\u3066\u307f\u308b\n\nApple\u30e1\u30cb\u30e5\u30fc\u306e\u300c\u3053\u306eMac\u306b\u3064\u3044\u3066\u300d\u3092\u62bc\u3057\u3066\u307f\u307e\u3059\u3002\n\n```js:\u300c\u3053\u306eMac\u306b\u3064\u3044\u3066\u300d\u3092\u30af\u30ea\u30c3\u30af\nvar finder = Application(\"System Events\").processes[\"Finder\"];\n\nvar e = finder.menuBars[0].menuBarItems[\"Apple\"].menus[\"Apple\"].menuItems[\"\u3053\u306e Mac \u306b\u3064\u3044\u3066\"];\n\ne.click(); // \u8981\u7d20\u3092\u9078\u3093\u3067.click()\u3092\u547c\u3076\u3060\u3051\n```\n\n\u3061\u3083\u3093\u3068\u300c\u3053\u306eMac\u306b\u3064\u3044\u3066\u300d\u304c\u8868\u793a\u3055\u308c\u307e\u3057\u305f\u304b\uff1f\n\u3042\u3001\u914d\u5217\u3092\u8fd4\u3059\u30e1\u30bd\u30c3\u30c9\u306f`[]`\u306b\u6587\u5b57\u5217\u3092\u6e21\u3059\u3068name\u3092\u6307\u5b9a\u3057\u3066\u8981\u7d20\u3092\u53d6\u5f97\u3067\u304d\u307e\u3059\u3002\n(`byname`\u304c\u547c\u3073\u51fa\u3055\u308c\u307e\u3059\u3002)\n\n(\u8ffd\u8a18\uff1a\u3053\u306e\u30b3\u30fc\u30c9\u306f\u30e1\u30cb\u30e5\u30fc\u30d0\u30fc\u3092\u30af\u30ea\u30c3\u30af\u3057\u3066\u3044\u307e\u3059\u3002Mac\u306e\u3044\u3064\u304b\u306e\u30a2\u30c3\u30d7\u30c7\u30fc\u30c8\u3067\u30e1\u30cb\u30e5\u30fc\u30d0\u30fc\u306f\u96a0\u3059\u3088\u3046\u306b\u8a2d\u5b9a\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3057\u305f\u3002Mac\u306e\u30e1\u30cb\u30e5\u30fc\u30d0\u30fc\u304c\u96a0\u308c\u3066\u3044\u308b\u5834\u5408\u306b\u306f\u52d5\u304d\u307e\u305b\u3093\u3002)\n\n## UIElement\n\n\u307e\u305a\u306fSystem Events\u304b\u3089\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u30d7\u30ed\u30bb\u30b9\u3092\u53d6\u5f97\u3057\u307e\u3059\u3002\n\u30d7\u30ed\u30bb\u30b9\u304b\u3089\u30e1\u30cb\u30e5\u30fc\u3084\u30a6\u30a3\u30f3\u30c9\u30a6\u3092\u53d6\u5f97\u3057\u3001\u30a6\u30a3\u30f3\u30c9\u30a6\u304b\u3089\u30dc\u30bf\u30f3\u3092\u53d6\u5f97\u3057\u3001\u3068\u3044\u3046\u98a8\u306b\u5b50\u8981\u7d20\u3092\u53d6\u5f97\u3057\u3066\u3044\u304f\u3053\u3068\u306b\u306a\u308a\u307e\u3059\u3002\n\n\u30d7\u30ed\u30bb\u30b9\u3082\u542b\u3081\u3001\u305d\u308c\u3089\u306f **\u5168\u3066`UIElement`\u306e\u30b5\u30d6\u30af\u30e9\u30b9** \u3067\u3059\u3002\n(System Events\u81ea\u4f53\u306f\u9055\u3044\u307e\u3059\u3002)\n\nUIElement\u306e\u5b50\u8981\u7d20\u306f`.uiElements`\u3067\u53d6\u5f97\u3067\u304d\u307e\u3059\u3002\n\u307e\u305f\u306f`.menuBars`\u3084`.windows`\u3068\u3044\u3046\u3088\u3046\u306a\u30af\u30e9\u30b9\u540d\u306e\u8907\u6570\u5f62\u30d7\u30ed\u30d1\u30c6\u30a3\u3067\u3082\u53d6\u5f97\u3067\u304d\u307e\u3059\u3002\n\n`System Events`\u304b\u3089\u53c2\u7167\u3067\u304d\u308b\u5168\u3066\u306eUI Elements\u3092\u4e00\u89a7\u3059\u308b\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u66f8\u3044\u305f\u306e\u3067\u4f7f\u3063\u3066\u307f\u3066\u304f\u3060\u3055\u3044\u3002\nhttps://github.com/zakuroishikuro/JXA-scripts/blob/master/ui-finder.js\n\n![\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2015-02-11 20.42.06.png](https://qiita-image-store.s3.amazonaws.com/0/18902/bcfc7c54-f130-66b4-4885-f8040c594647.png \"\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2015-02-11 20.42.06.png\")\n\n(\u3053\u308c\u4f7f\u3063\u3066\u3060\u3044\u305f\u3044\u3069\u3093\u306a\u611f\u3058\u304b\u5206\u304b\u3063\u305f\u3089\u3001\u3053\u3053\u304b\u3089\u4e0b\u306f\u8aad\u307e\u306a\u304f\u3066\u3044\u3044\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u3002\u9577\u3044\u3057\u3002\u6821\u6b63\u3057\u305f\u3044\u3051\u3069\u3081\u3093\u3069\u3044\u306e\u3067\u7121\u7406\u3067\u3059\u3002)\n\n### ApplicationProcess\n\n`System Events`\u304b\u3089uiElements\u3092\u53d6\u5f97\u3057\u3066\u3044\u304d\u307e\u3059\u3002\n\n```js:ApplicationProcess\u3092\u53d6\u5f97\nvar se = Application(\"System Events\");\nvar elements = se.uiElements();\n\nconsole.log(\"\u53c2\u7167\u53ef\u80fd\u306a\u30d7\u30ed\u30bb\u30b9\u6570: \" + elements.length);\n\nvar e = elements[0]; //\u6700\u521d\u306e\u4e00\u3064\u3092\u53d6\u308a\u51fa\u3059\n\nconsole.log(\"\u6700\u521d\u306e\u30d7\u30ed\u30bb\u30b9: \");\nconsole.log(\"  class: \" + e.class());\nconsole.log(\"   name: \" + e.name());\n```\n\n>\u53c2\u7167\u53ef\u80fd\u306a\u30d7\u30ed\u30bb\u30b9\u6570: 49\n>\u6700\u521d\u306e\u30d7\u30ed\u30bb\u30b9: \n>  class: applicationProcess\n>   name: loginwindow\n\n\n\u914d\u5217\u306e\u6700\u521d\u306b\u306f\u3001loginwindow\u3068\u3044\u3046\u540d\u524d\u306e`ApplicationProcess`\u304c\u5165\u3063\u3066\u3044\u307e\u3057\u305f\u3002\n\n`ApplicationProcess`\u306f`Process`\u306e\u30b5\u30d6\u30af\u30e9\u30b9\u3067\u3001`Process`\u306f`UIElement`\u306e\u30b5\u30d6\u30af\u30e9\u30b9\u3067\u3059\u3002\n`.uiElements`\u3060\u3051\u3067\u306a\u304f\u3001\u305d\u306e\u30b5\u30d6\u30af\u30e9\u30b9\u3092\u8907\u6570\u5f62\u306b\u3057\u305f\u30d7\u30ed\u30d1\u30c6\u30a3\u540d\u3067\u3082\u53d6\u5f97\u3067\u304d\u307e\u3059\u3002\nSystem Events\u306e `.uiElements` `.processes` `.applicationProcesses`\u306f\u5168\u3066\u540c\u3058\u3067\u3059\u3002\u597d\u304d\u306a\u547c\u3073\u65b9\u3067\u69cb\u3044\u307e\u305b\u3093\u3002\n\n```js:\u30b5\u30d6\u30af\u30e9\u30b9\u306e\u8907\u6570\u7cfb\u3067\u3082\u53d6\u5f97\u53ef\u80fd\nvar elements    = se.uiElements();\nvar processes     = se.processes();\nvar app_processes = se.applicationProcesses();\n\nconsole.log(elements.length);\nconsole.log(processes.length);\nconsole.log(app_processes.length);\n```\n> 49\n> 49\n> 49\n\n\u3042\u3068\u3001\u7d1b\u3089\u308f\u3057\u3044\u3067\u3059\u304c`Application`\u30af\u30e9\u30b9\u3068\u306f\u7570\u306a\u308b\u3053\u3068\u306b\u6ce8\u610f\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n`System Events`\u81ea\u4f53\u306f`UIElements`\u3067\u306a\u304f`Application`\u3067\u3059\u3002UIElement\u306e\u30e1\u30bd\u30c3\u30c9\u306f\u547c\u3079\u307e\u305b\u3093\u3002\n\n\u3059\u3079\u3066\u306e\u30d7\u30ed\u30bb\u30b9\u306e\u540d\u524d\u3092\u8868\u793a\u3057\u3066\u307f\u307e\u3057\u3087\u3046\u3002\n\u30af\u30e9\u30b9\u306f\u5168\u3066`ApplicationProcess`\u3067\u3059\u3002\n\n```js:\u30a2\u30af\u30bb\u30b9\u53ef\u80fd\u306a\u5168\u3066\u306e\u30d7\u30ed\u30bb\u30b9\u306e\u540d\u524d\u3092\u8868\u793a\nprocesses = se.processes();\n\nprocesses.forEach(function(p, i){ console.log(i + \": \" + p.name()) });\n```\n> 0: loginwindow\n> 1: SystemUIServer\n> 2: Dock\n> 3: Finder\n> (\u4e2d\u7565)\n> 33: com.apple.WebKit.WebContent\n> 34: Kobito\n> 35: JapaneseIM\n> 36: System Events\n\n## UI Elements\u3092\u8fbf\u3063\u3066\u307f\u308b\n\n\u4e0a\u306e\u30b3\u30fc\u30c9\u306b\u3042\u308b\n\n```js:\u300c\u3053\u306eMac\u306b\u3064\u3044\u3066\u300d\u306e\u30d1\u30b9\nfinder.menuBars[0].menuBarItems[\"Apple\"].menus[\"Apple\"].menuItems[\"\u3053\u306e Mac \u306b\u3064\u3044\u3066\"];\n```\n\u307f\u305f\u3044\u306a\u30d1\u30b9\u3092\u8abf\u3079\u308b\u305f\u3081\u306b\u3001`.uiElements`\u3092\u4e00\u3064\u305a\u3064\u8fbf\u3063\u3066\u307f\u307e\u3057\u3087\u3046\u3002\n\n\u3044\u3061\u3044\u3061\u8868\u793a\u306e\u51e6\u7406\u3092\u66f8\u304f\u306e\u306f\u3081\u3093\u3069\u304f\u3055\u3044\u306e\u3067\u3001\u5b50UI Element\u306e\u540d\u524d\u3068\u30af\u30e9\u30b9\u3092\u5168\u3066\u8868\u793a\u3059\u308b\u95a2\u6570\u3092\u7528\u610f\u3057\u307e\u3057\u305f\u3002\n\n```js:\u5b50UI\u306e\u60c5\u5831\u3092\u8868\u793a\u3059\u308b(class,name,description\u306e\u9806)\nfunction wrap(e){\n  return e.class() + \" - \" + e.name() + \" (\" + e.description() + \")\";\n}\n\nfunction print(target){\n  var childs = target.uiElements();\n  \n  console.log(\"\\n\" + wrap(target) + \" has \" + childs.length + \" UI Elements.\");\n  \n  childs.forEach(function(child, i){\n    console.log(\"-  \" + i + \": \" + wrap(child))\n  });\n  \n  console.log(); //\u6539\u884c\n};\n```\n\n\u3055\u3063\u305d\u304f\u8868\u793a\u3057\u3066\u3044\u304d\u307e\u3059\u3002\n\n```js:Finder\u306e\u30d7\u30ed\u30bb\u30b9\u76f4\u4e0b\u306euiElements\nprint(finder);\n```\n\n>Finder (applicationProcess) has 2 UI Elements.\n>-  0: menuBar - null (\u30e1\u30cb\u30e5\u30fc\u30d0\u30fc)\n>-  1: scrollArea - null (\u30c7\u30b9\u30af\u30c8\u30c3\u30d7)\n\n\u30e1\u30cb\u30e5\u30fc\u30d0\u30fc\u3068\u30c7\u30b9\u30af\u30c8\u30c3\u30d7\u304c\u898b\u3048\u307e\u3057\u305f\u3002\n\u30e1\u30cb\u30e5\u30fc\u30d0\u30fc\u3092\u8fbf\u308a\u307e\u3059\u3002\n\n```js:menuBars\nprint( finder.menuBars[0] );\n```\n\n>menuBar - null (\u30e1\u30cb\u30e5\u30fc\u30d0\u30fc) has 8 UI Elements.\n>-  0: menuBarItem - Apple (\u30e1\u30cb\u30e5\u30fc\u30d0\u30fc\u9805\u76ee)\n>-  1: menuBarItem - Finder (\u30e1\u30cb\u30e5\u30fc\u30d0\u30fc\u9805\u76ee)\n>-  2: menuBarItem - \u30d5\u30a1\u30a4\u30eb (\u30e1\u30cb\u30e5\u30fc\u30d0\u30fc\u9805\u76ee)\n>-  3: menuBarItem - \u7de8\u96c6 (\u30e1\u30cb\u30e5\u30fc\u30d0\u30fc\u9805\u76ee)\n>-  4: menuBarItem - \u8868\u793a (\u30e1\u30cb\u30e5\u30fc\u30d0\u30fc\u9805\u76ee)\n>-  5: menuBarItem - \u79fb\u52d5 (\u30e1\u30cb\u30e5\u30fc\u30d0\u30fc\u9805\u76ee)\n>-  6: menuBarItem - \u30a6\u30a4\u30f3\u30c9\u30a6 (\u30e1\u30cb\u30e5\u30fc\u30d0\u30fc\u9805\u76ee)\n>-  7: menuBarItem - \u30d8\u30eb\u30d7 (\u30e1\u30cb\u30e5\u30fc\u30d0\u30fc\u9805\u76ee)\n\n\u30af\u30e9\u30b9\u540d\u306b\u5408\u308f\u305b\u3066`.menuBars`\u3068\u3057\u3066\u3044\u307e\u3059\u304c\u3001`.uiElements`\u3067\u3082\u540c\u3058\u3067\u3059\n\u30e1\u30cb\u30e5\u30fc\u304b\u3089\u300cApple\u300d\u3092\u9078\u3073\u307e\u3059\u3002\n\n```js:menuBarItems\nprint( finder.menuBars[0].menuBarItems[\"Apple\"] );\n```\n>menuBarItem - Apple (\u30e1\u30cb\u30e5\u30fc\u30d0\u30fc\u9805\u76ee) has 1 UI Elements.\n>-  0: menu - Apple (\u30e1\u30cb\u30e5\u30fc)\n\n...\u30e1\u30cb\u30e5\u30fc\u306e\u4e2d\u306b\u30e1\u30cb\u30e5\u30fc\u304c\u8907\u6570\u3042\u308b\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u3057\u306d\u3002\u4ed5\u65b9\u306a\u3044\u306d\u3002\n\n```js:menus\nprint( finder.menuBars[0].menuBarItems[\"Apple\"].menus[0] );\n```\n\n>menu - Apple (\u30e1\u30cb\u30e5\u30fc) has 19 UI Elements.\n>-  0: menuItem - \u3053\u306e Mac \u306b\u3064\u3044\u3066 (\u30e1\u30cb\u30e5\u30fc\u9805\u76ee)\n>-  1: menuItem - \u30b7\u30b9\u30c6\u30e0\u60c5\u5831... (\u30e1\u30cb\u30e5\u30fc\u9805\u76ee)\n>-  2: menuItem - null (\u30e1\u30cb\u30e5\u30fc\u9805\u76ee)\n>-  3: menuItem - \u30b7\u30b9\u30c6\u30e0\u74b0\u5883\u8a2d\u5b9a... (\u30e1\u30cb\u30e5\u30fc\u9805\u76ee)\n>~~~~~~~~~~\u4e2d\u7565~~~~~~~~~~~\n>-  14: menuItem - \u30b7\u30b9\u30c6\u30e0\u7d42\u4e86... (\u30e1\u30cb\u30e5\u30fc\u9805\u76ee)\n>-  15: menuItem - \u30b7\u30b9\u30c6\u30e0\u7d42\u4e86 (\u30e1\u30cb\u30e5\u30fc\u9805\u76ee)\n>-  16: menuItem - null (\u30e1\u30cb\u30e5\u30fc\u9805\u76ee)\n>-  17: menuItem - (USER) \u3092\u30ed\u30b0\u30a2\u30a6\u30c8... (\u30e1\u30cb\u30e5\u30fc\u9805\u76ee)\n>-  18: menuItem - (USER) \u3092\u30ed\u30b0\u30a2\u30a6\u30c8 (\u30e1\u30cb\u30e5\u30fc\u9805\u76ee)\n\n...\u3084\u3063\u3068\u898b\u3048\u307e\u3057\u305f\u306d\u3002\u304a\u75b2\u308c\u3055\u307e\u3067\u3057\u305f\u3002\n\n\u666e\u901a\u306f\u3053\u3093\u306a\u3081\u3093\u3069\u304f\u3055\u3044\u3053\u3068\u3057\u307e\u305b\u3093\u3002\n\u3069\u3046\u306a\u3063\u3066\u3044\u308b\u306e\u304b\u3092\u77e5\u3063\u3066\u304a\u3051\u3070\u4fbf\u5229\u3068\u3044\u3046\u3060\u3051\u3067\u3059\u3002\n\n\u30e1\u30cb\u30e5\u30fc\u3084\u30a6\u30a3\u30f3\u30c9\u30a6\u3092\u6301\u305f\u306a\u3044\u30d7\u30ed\u30bb\u30b9\u3082\u3042\u308a\u307e\u3059\u3002\n\u305f\u3068\u3048\u3070\u3001Dock\u306e\u30d7\u30ed\u30bb\u30b9\u306f\u81ea\u8eab\u306e\u30a2\u30a4\u30b3\u30f3\u306e\u914d\u5217\u3057\u304b\u6301\u3063\u3066\u3044\u307e\u305b\u3093\u3002\n\n## \u5b50UI\u3092\u5168\u3066\u53d6\u5f97 (.entireContents)\n\n\u5b50UI\u3092\u4e00\u62ec\u3067\u53d6\u5f97\u3059\u308b\u65b9\u6cd5\u304c\u3042\u308a\u307e\u3059\u3002\nUIElement\u304b\u3089`.entireContents`\u3092\u547c\u3076\u306e\u3067\u3059\u3002\n\n```js:UIElement#entireContents\nall = finder.entireContents();\n\nall.length;\n```\n>338\n\n```\u6700\u521d\u306e5\u3064\u3092\u53d6\u308a\u51fa\u3057\u3066\u307f\u308b\nall.slice(0, 5);\n```\n>[Application(\"System Events\").applicationProcesses.byName(\"Finder\").menuBars.at(0), Application(\"System Events\").applicationProcesses.byName(\"Finder\").menuBars.at(0).menuBarItems.byName(\"Apple\"), Application(\"System Events\").applicationProcesses.byName(\"Finder\").menuBars.at(0).menuBarItems.byName(\"Apple\").menus.byName(\"Apple\"), Application(\"System Events\").applicationProcesses.byName(\"Finder\").menuBars.at(0).menuBarItems.byName(\"Apple\").menus.byName(\"Apple\").menuItems.byName(\"\u3053\u306e Mac \u306b\u3064\u3044\u3066\"), Application(\"System Events\").applicationProcesses.byName(\"Finder\").menuBars.at(0).menuBarItems.byName(\"Apple\").menus.byName(\"Apple\").menuItems.byName(\"\u30b7\u30b9\u30c6\u30e0\u60c5\u5831...\")]\n\n...\u898b\u8f9b\u3044\u3002\n\n\u591a\u3059\u304e\u3066\u624b\u306b\u4f59\u308a\u307e\u3059\u3057\u3001\u6271\u3044\u3082\u56f0\u96e3\u3067\u3059\u3002\n\n**`.entireContents`\u304b\u3089\u306f`[]`\u3067\u4f4d\u7f6e\u3084\u540d\u524d\u3067\u6307\u5b9a\u3057\u3066\u53d6\u308a\u51fa\u3059\u3053\u3068\u306f\u3067\u304d\u307e\u305b\u3093\u3002**\n`.uiElements[\"\u306a\u307e\u3048\"]`\u307f\u305f\u3044\u306a\u7d5e\u308a\u8fbc\u307f\u304c\u3067\u304d\u306a\u3044\u306e\u3067\u3059\u3002\n(\u3053\u308c\u306b\u6c17\u3065\u304f\u307e\u3067\u76f8\u5f53\u82e6\u52b4\u3057\u307e\u3057\u305f\u3002\u30cd\u30c3\u30c8\u3067\u60c5\u5831\u3092\u63a2\u3057\u3066\u3082\u5168\u304f\u898b\u5f53\u305f\u308a\u307e\u305b\u3093\u3057...)\n\n`.entireContents()`\u3092\u547c\u3076\u3068UIElement\u306e\u914d\u5217\u304c\u53d6\u5f97\u3067\u304d\u308b\u306e\u3067\u3001\u305d\u3053\u304b\u3089\u4f4d\u7f6e\u3067\u6307\u5b9a\u3057\u3066\u4f7f\u3046\u3057\u304b\u3042\u308a\u307e\u305b\u3093\u3002\n\u76ee\u7684\u306e\u9805\u76ee\u306fforEach\u3068\u304b\u3067\u5730\u9053\u306b\u63a2\u3059\u3057\u304b\u306a\u3044\u3067\u3059\u3002\n\nUIElement\u306f`console.log()`\u3057\u3066\u3082`[object ObjectSpecifier]`\u3068\u3057\u304b\u8868\u793a\u3055\u308c\u307e\u305b\u3093\u3002\n\u6a19\u6e96\u51fa\u529b\u306b\u306f\u3053\u306e\u30d1\u30b9\u3063\u307d\u3044\u3082\u306e\u304c\u8868\u793a\u3055\u308c\u3066\u3044\u307e\u3059\u304c\u3001\u3053\u308c\u3092JXA\u5185\u3067\u6587\u5b57\u5217\u3068\u3057\u3066\u5f97\u308b\u65b9\u6cd5\u306f(\u305f\u3076\u3093)\u306a\u3044\u3067\u3059\u3002\n\n----\n\n(\u8ffd\u8a182015/2/17:\u3042\u308a\u307e\u3057\u305f\u3002\u666e\u901a\u306bApple\u306e\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u306b\u66f8\u3044\u3066\u3042\u308a\u307e\u3057\u305f\u3002\n\n```\nAutomation.getDisplayString(hoge)\n```\n\n----\n\nJXA\u306f\u6700\u5f8c\u306b\u8a55\u4fa1\u3057\u305f\u5f0f\u306e\u7d50\u679c\u3092\u5fc5\u305a\u51fa\u529b\u3059\u308b\u306e\u3067\u3001\u305d\u308c\u3092\u30d1\u30a4\u30d7\u3067\u30d5\u30a1\u30a4\u30eb\u306b\u4fdd\u5b58\u3059\u308c\u3070\u4e00\u5fdc\u306f\u6587\u5b57\u5217\u3067\u5f97\u3089\u308c\u307e\u3059\u3002\n\u3042\u3068\u306fRuby\u304b\u306a\u3093\u304b\u3067`, `\u3067\u5206\u5272\u3057\u3066\u7d5e\u308a\u8fbc\u3080\u3068\u304b\u30fb\u30fb\u30fb\u3002\n\n```\n$ osascript -l JavaScript -e 'Application(\"System Events\").processes[\"Finder\"].entireContents()' > contents.txt\n```\n\n## X, Y\u5ea7\u6a19\u3092\u6307\u5b9a\u3057\u3066\u30af\u30ea\u30c3\u30af\n\n```js:\u5ea7\u6a19\u3092\u6307\u5b9a\u3057\u3066\u30af\u30ea\u30c3\u30af\nfinder_app = Application(\"Finder\");\nfinder_app.activate();\n\ndelay(0.1); // activate\u306b\u306a\u308b\u307e\u3067\u5c11\u3057\u304b\u304b\u308b\u306e\u3067\u30010.1\u79d2\u5f85\u3064\n\nfinder = Application(\"System Events\").processes[finder_app.name()];\n\nx = 100;\ny = 10;\n\nfinder.click( {at:[x, y]} );\n```\n\n`Process`\u30af\u30e9\u30b9\u306e`click()`\u306b\u306f\u5ea7\u6a19\u3092\u6e21\u305b\u307e\u3059\u3002\n\u3053\u306e\u30b3\u30fc\u30c9\u3092\u5b9f\u884c\u3057\u305f\u5834\u5408\u3001Finder\u306e\u300cFinder\u300d\u30e1\u30cb\u30e5\u30fc\u304c\u30af\u30ea\u30c3\u30af\u3055\u308c\u307e\u3059\u3002(\u3055\u308c\u308b\u306f\u305a\u3067\u3059\u3002)\n\n`[x, y]`\u306f\u30b0\u30ed\u30fc\u30d0\u30eb\u5ea7\u6a19\u3067\u3059\u3002\nUIElement\u5185\u306e\u76f8\u5bfe\u7684\u306a\u5ea7\u6a19\u3067\u306f\u306a\u304f\u3001\u753b\u9762\u5185\u306e\u7d76\u5bfe\u5ea7\u6a19\u3067\u3059\u3002\n\nCSS\u30d4\u30af\u30bb\u30eb\u3067\u3059\u304b\u3089\u3001Retina\u30c7\u30a3\u30b9\u30d7\u30ec\u30a4\u3067\u3082\u305d\u3046\u3067\u306a\u304f\u3066\u3082\u540c\u3058\u4f4d\u7f6e\u3092\u6307\u3057\u307e\u3059\u3002\nRetina\u30c7\u30a3\u30b9\u30d7\u30ec\u30a4\u306e\u5834\u5408\u306f\u30d4\u30af\u30bb\u30eb\u6570 / 2\u306e\u6570\u5024\u3092\u6307\u5b9a\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\u300c2560 * 1600\u300d\u30d4\u30af\u30bb\u30eb\u306eRetina\u30c7\u30a3\u30b9\u30d7\u30ec\u30a4\u306e\u5834\u5408\u3001x\u306f\u300c0\u301c1279\u300d\u3067\u3001y\u306f\u300c0\u301c799\u300d\u3067\u3059\u3002\n\n\u305d\u306e\u5ea7\u6a19\u306e\u4f4d\u7f6e\u306b\u305d\u306e\u30d7\u30ed\u30bb\u30b9\u304c\u6301\u3064UIElement\u304c\u5b58\u5728\u3059\u308c\u3070\u30af\u30ea\u30c3\u30af\u3055\u308c\u307e\u3059\u3002\n\u305d\u3057\u3066\u3001\u305d\u306eUIElement\u306e\u53c2\u7167\u304c\u623b\u308a\u5024\u3068\u3057\u3066\u8fd4\u3063\u3066\u304d\u307e\u3059\u3002\nUIElement\u304c\u5b58\u5728\u3057\u306a\u3051\u308c\u3070\u4f55\u3082\u8d77\u304d\u305a\u3001null\u304c\u8fd4\u3063\u3066\u304d\u307e\u3059\u3002\n\n\u305d\u306e\u30d7\u30ed\u30bb\u30b9\u304c\u6301\u3063\u3066\u3044\u306a\u3044UIElement\u306f\u30af\u30ea\u30c3\u30af\u3067\u304d\u307e\u305b\u3093\u3002\nFinder\u306e\u30d7\u30ed\u30bb\u30b9\u306b\u30c9\u30c3\u30af\u3092\u30af\u30ea\u30c3\u30af\u3055\u305b\u3088\u3046\u3068\u3057\u3066\u3082\u30c7\u30b9\u30af\u30c8\u30c3\u30d7\u306e\u53c2\u7167\u304c\u8fd4\u3063\u3066\u304f\u308b\u3060\u3051\u3067\u3059\u3002\n\n\u30e1\u30cb\u30e5\u30fc\u3092\u30af\u30ea\u30c3\u30af\u3057\u305f\u3044\u306a\u3089\u3001\u6700\u524d\u9762\u306e\u30a2\u30d7\u30ea\u306e\u30d7\u30ed\u30bb\u30b9\u3092\u6307\u5b9a\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\n\n\u3044\u307e\u3044\u3061\u7528\u9014\u304c\u5206\u304b\u308a\u307e\u305b\u3093\u3002\n\u3061\u306a\u307f\u306bUIElement\u306f`.position()`\u3092\u547c\u3079\u3070\u5ea7\u6a19\u3092\u53d6\u5f97\u3067\u304d\u307e\u3059\u3002\n\n## \u51fa\u6765\u306a\u3044\u3053\u3068\n\n- \u53f3\u30af\u30ea\u30c3\u30af\n- \u30db\u30a4\u30fc\u30eb\u30af\u30ea\u30c3\u30af\n- \u30c9\u30e9\u30c3\u30b0\n- \u30c9\u30e9\u30c3\u30b0&\u30c9\u30ed\u30c3\u30d7\n\n(\u3059\u308b\u65b9\u6cd5\u3042\u308c\u3070\u6559\u3048\u3066\u304f\u3060\u3055\u3044\u3002)\n\n# UI Element\u3092\u63a2\u7d22\u3059\u308b\u30c4\u30fc\u30eb\n\n\u305d\u308d\u305d\u308d\u529b\u5c3d\u304d\u3066\u304d\u305f\u306e\u3067\u3042\u308b\u5834\u6240\u3060\u3051\u3002\n\n## Accessibility Inspector\n\nXCode\u306e\u4e2d\u306b\u3042\u308a\u307e\u3059\u3002\n\u305d\u306e\u307e\u307eJXA\u3067\u4f7f\u3048\u308b\u60c5\u5831\u304c\u8868\u793a\u3055\u308c\u308b\u308f\u3051\u3067\u306f\u3042\u308a\u307e\u305b\u3093\u304c\u3001\u30d2\u30f3\u30c8\u306b\u306f\u306a\u308b\u3068\u601d\u3044\u307e\u3059\u3002\n\n![\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2015-02-10 19.38.43.png](https://qiita-image-store.s3.amazonaws.com/0/18902/69ca3c77-904c-c4a5-5174-3d82fa11f32c.png \"\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2015-02-10 19.38.43.png\")\n\n## UI Browser\n\n\u3051\u3063\u3053\u3046\u4eba\u6c17\u3089\u3057\u3044\u3002\n$55\u3067\u3059\u300230\u65e5\u9593\u7121\u6599\u3002\n\n[UI Browser](http://pfiddlesoft.com/uibrowser/)\n\n# \u86c7\u8db3\n\nApple Script\u306f\u771f\u9762\u76ee\u306b\u52c9\u5f37\u3059\u308b\u6c17\u304c\u304a\u304d\u305a\u3001\u6700\u8fd1JXA\u3092\u59cb\u3081\u305f\u306b\u308f\u304b\u306a\u306e\u3067\u4f55\u304b\u9593\u9055\u3063\u305f\u8a18\u8ff0\u3092\u3057\u3066\u3044\u305f\u3089\u6559\u3048\u3066\u3044\u305f\u3060\u3051\u308b\u3068\u3042\u308a\u304c\u305f\u3044\u3067\u3059\u3002\n\n\u6bb4\u308a\u66f8\u304d\u306e\u6587\u7ae0\u3059\u3044\u307e\u305b\u3093\u3057\u305f\u3002\n\n# \u53c2\u8003\u30ea\u30f3\u30af\n\n- [Hys.LOG : Mac \u306e\u30ad\u30fc\u30b3\u30fc\u30c9 2012 (Full Keyboard)](http://hyslog.com/blog/2012/06/25/569)\n- [GUI\u30b9\u30af\u30ea\u30d7\u30c6\u30a3\u30f3\u30b0\u3067\u4f7f\u3044\u305f\u304f\u306a\u308b\u9053\u5177 - \u30b6\u30ea\u30ac\u30cb\u304c\u898b\u3066\u3044\u305f...\u3002](http://d.hatena.ne.jp/zariganitosh/20100118/1263805168)\n- [AS Hole\uff08AppleScript\u306e\u7a74\uff09 By Piyomaru Software \u00bb UI Browser 2.5\u304c\u767b\u5834 \u00bb Blog Archive](http://piyocast.com/as/archives/3171)\n- [Apple Script\uff1aUIElementInspector \u304c\u4fbf\u5229\u3067\u3059 - thyVikings : iMac, iPad, iMat by aged engine](http://thyvikings.cool.coocan.jp/wordpress/?p=16869)\n", "tags": ["Mac", "JavaScript", "jXA"]}