{"context": " More than 1 year has passed since last update.\n\n\u6982\u8981\n\u3068\u3042\u308b C++ \u306e\u30bd\u30d5\u30c8\u30a6\u30a7\u30a2\u958b\u767a\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3067\u65b0\u4eba\u3082\u305d\u308d\u305d\u308d\u5352\u696d\u304b\u306a\u3068\u3044\u3046\u82e5\u3044\u30a4\u30b1\u30e1\u30f3\u304f\u3093\u304c\n\u300c\u5148\u8f29\uff01\u3046\u3061\u306e\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306e\u30d0\u30a4\u30ca\u30ea\u30fc\u5b9f\u884c\u30d5\u30a1\u30a4\u30eb\u306b\u542b\u307e\u308c\u3066\u3044\u308b\u5909\u6570 mojimoji \u306e\u5024\u3092\u30d3\u30eb\u30c9\uff08\u7ffb\u8a33\uff0b\u30ea\u30f3\u30af\uff09\u3057\u305f\u5f8c\u3067\u66f8\u304d\u63db\u3048\u308b\u306a\u3093\u3066\u7121\u8336\u306a\u4e8b\u3092\u3057\u305f\u3044\u304b\u3082\u3057\u308c\u306a\u3044\u3067\u3059\uff01\uff01\u300d\n\u305d\u3093\u306a\u72b6\u6cc1\u304c\u767a\u751f\u3057\u3066\u3044\u305f\u306e\u3067\u65e9\u8d77\u304d\u3057\u3066\u696d\u52d9\u6642\u9593\u5916\u306b Qiita \u306b\u3084\u308a\u65b9\u3092\u66f8\u3044\u3066\u304a\u304f\u30b5\u30f3\u30bf\u30af\u30ed\u30fc\u30b9\u98a8\u306e\u30b7\u30e3\u30a4\u306a\u30d7\u30ec\u30bc\u30f3\u30c8\u65b9\u5f0f\u3092\u53d6\u308b\u3053\u3068\u306b\u3057\u305f\u79c1\u3060\u3063\u305f\u3002\uff08\u20200\uff09\n\n\u72b6\u6cc1\u306e\u4f8b\n\na.cxx \u306b\u306f\u30d3\u30eb\u30c9\u5f8c\u306b\u66f8\u304d\u63db\u3048\u305f\u3044\u5909\u6570 mojimoji \u3084 mojisize \u304c\u542b\u307e\u308c\u3066\u3044\u308b\u3068\u3057\u307e\u3059\u3002\n\n\u4f8b\u3048\u3070\u2193\u3053\u3093\u306a\u306e\u3067\u3059\u306d\u3002\nstatic volatile constexpr char mojimoji[] = \"abcd1234\";\nstatic volatile constexpr unsigned char mojisize = sizeof( mojimoji );\n\n#include <iostream>\n\nauto main() -> int\n{\n  std::cout << ( const char* )mojimoji << \" \" << std::to_string( mojisize );\n}\n\ng++ -std=c++14 -O3 a.cxx \u306a\u3069\u3057\u3066\u7ffb\u8a33\u3059\u308b\u3068 \u5b9f\u884c\u30d5\u30a1\u30a4\u30eb a \uff08mingw \u306a\u3089 a.exe \uff09 \u304c\u3067\u304d\u3066\u3001\u3053\u308c\u306f\u5b9f\u884c\u3059\u308b\u3068 abcd1234 9 \u3068\u8868\u793a\u3057\u3066\u304f\u308c\u307e\u3059\u3002\uff08\u20201\uff09\n\u3055\u3066\u3001\u4f8b\u3048\u3070\u3053\u308c\u3092 ajipon 9 \u3068\u8868\u793a\u3059\u308b\u3088\u3046\u306b C++ \u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u81ea\u4f53\u306e\u30ea\u30d3\u30eb\u30c9\u7121\u3057\u3067\u3001\u30dd\u30b9\u30c8\u30d7\u30ed\u30bb\u30b9\u3060\u3051\u3067\u3069\u3046\u306b\u304b\u3057\u305f\u3044\u306e\u3067\u3059\u3002\n\n\u65b9\u6cd5\n\n\u78ba\u8a8d\n\nnm: \u30b7\u30f3\u30dc\u30eb\u30a8\u30f3\u30c8\u30ea\u30fc\u306e\u78ba\u8a8d\n\u306f\u3058\u3081\u306b\u3001 a.exe \u306b mojimoji \u3084 mojisize \u306e\u30b7\u30f3\u30dc\u30eb\u30a8\u30f3\u30c8\u30ea\u30fc\u304c\u3042\u308b\u304b\u78ba\u8a8d\u3057\u3066\u307f\u307e\u3057\u3087\u3046:\nnm -C a.exe | grep moji \u3059\u308b\u3068\u3001\n00000000004a7018 d mojimoji\n00000000004a7010 d mojisize\n\n\u3042\u308a\u307e\u3057\u305f\u3002\uff08\u20202\uff09\u3053\u306e\u3088\u3046\u306b\u51fa\u3066\u304f\u308b\u72b6\u614b\u306a\u3089\u7c21\u5358\u306b\u3069\u3046\u306b\u304b\u306a\u308b\u3067\u3057\u3087\u3046\u3002\u305f\u3076\u3093\u3002\n\u3053\u306e\u8868\u793a\u304b\u3089\u306f\u3001\u30d0\u30a4\u30ca\u30ea\u30fc\u306e\u5b9f\u884c\u6642\u306e\u4eee\u60f3\u30e1\u30e2\u30ea\u30fc\u4e0a\u306e\u30a2\u30c9\u30ec\u30b9\uff08\u4eca\u56de\u306f\u4f7f\u3044\u307e\u305b\u3093\uff09\u3001 d \u306a\u306e\u3067\u30c7\u30fc\u30bf\u30bb\u30af\u30b7\u30e7\u30f3\u306b\u5c45\u308b\u3053\u3068\u3001\u305d\u3057\u3066\u30b7\u30f3\u30dc\u30eb\u540d\u304c mojimoji \u306a\u3069\u3067\u5b58\u5728\u3057\u3066\u3044\u308b\u3068\u308f\u304b\u308a\u307e\u3059\u3002\n\nobjdump: \u30b7\u30f3\u30dc\u30eb\u306e\u4f4d\u7f6e\n\n\u30bb\u30af\u30b7\u30e7\u30f3\u60c5\u5831\nobjdump -x a.exe | grep -10 Sections: \u306a\u3069\u3057\u3066\u30bb\u30af\u30b7\u30e7\u30f3\u60c5\u5831\u3092\u78ba\u8a8d\u3057\u307e\u3057\u3087\u3046:\n          pc+0x04: alloc small area: rsp = rsp - 0x28\n        Handler: 00000000004a6780.\n        User data:\n          000: ff ff 01 00\n 00000000004d4998 (rva: 000d4998): 00000000004a6d40 - 00000000004a6d4a\n        Version: 1, Flags: none\n        Nbr codes: 2, Prologue size: 0x04, Frame offset: 0x0, Frame reg: rbp\n          pc+0x04: FPReg: rbp = rsp + 0x0 (info = 0x0)\n          pc+0x01: push rbp\n\nSections:\nIdx Name          Size      VMA               LMA               File off  Algn\n  0 .text         000a5db0  0000000000401000  0000000000401000  00000600  2**4\n                  CONTENTS, ALLOC, LOAD, READONLY, CODE, DATA\n  1 .data         00002f28  00000000004a7000  00000000004a7000  000a6400  2**5\n                  CONTENTS, ALLOC, LOAD, DATA\n  2 .rdata        0000fbe0  00000000004aa000  00000000004aa000  000a9400  2**6\n                  CONTENTS, ALLOC, LOAD, READONLY, DATA\n  3 .pdata        0000b04c  00000000004ba000  00000000004ba000  000b9000  2**2\n                  CONTENTS, ALLOC, LOAD, READONLY, DATA\n  4 .xdata        0000e9a0  00000000004c6000  00000000004c6000  000c4200  2**2\n\n.data \u30bb\u30af\u30b7\u30e7\u30f3\u306f\u30d0\u30a4\u30ca\u30ea\u30fc\u30d5\u30a1\u30a4\u30eb\u4e0a\u306e\u30aa\u30d5\u30bb\u30c3\u30c8\u30a2\u30c9\u30ec\u30b9 000a6400 \u306b\u5c45\u308b\u3068\u308f\u304b\u308a\u307e\u3057\u305f\u3002\u20203\n\n\u30b7\u30f3\u30dc\u30eb\u306e\u30a2\u30c9\u30ec\u30b9\n\u7d9a\u3044\u3066\u3001 objdump -x a.exe | grep moji \u306a\u3069\u3057\u3066 mojimoji \u306e\u30a2\u30c9\u30ec\u30b9\u30aa\u30d5\u30bb\u30c3\u30c8\u3092\u78ba\u8a8d\u3057\u307e\u3057\u3087\u3046:\n[134](sec  2)(fl 0x00)(ty   0)(scl   3) (nx 0) 0x0000000000000018 _ZL8mojimoji\n[138](sec  2)(fl 0x00)(ty   0)(scl   3) (nx 0) 0x0000000000000010 _ZL8mojisize\n\n_ZL8mojimoji \uff08\u30de\u30f3\u30b0\u30ea\u30f3\u30b0\u3055\u308c\u305f mojimoji\uff09\u3068 _ZL8mojisize \uff08\u30de\u30f3\u30b0\u30ea\u30f3\u30b0\u3055\u308c\u305f mojisize\uff09\u304c\u30bb\u30af\u30b7\u30e7\u30f3\u306e\u30a2\u30c9\u30ec\u30b9\u30aa\u30d5\u30bb\u30c3\u30c8 0x18 \u3068 0x10 \u306b\u305d\u308c\u305e\u308c\u5c45\u308b\u3068\u308f\u304b\u308a\u307e\u3059\u3002\n\n\u3053\u3053\u307e\u3067\u306b\u308f\u304b\u3063\u3066\u3044\u308b\u4e8b\u3092\u6574\u7406\n\n\nmojimoji \u306f .data \u30bb\u30af\u30b7\u30e7\u30f3\u306b\u5c45\u308b\n\n.data \u30bb\u30af\u30b7\u30e7\u30f3\u306f\u30d5\u30a1\u30a4\u30eb\u30aa\u30d5\u30bb\u30c3\u30c8 0x0a6400 \u30d0\u30a4\u30c8\u306b\u5c45\u308b\n\nmojimoji ( \u30de\u30f3\u30b0\u30ea\u30f3\u30b0\u3055\u308c\u305f\u72b6\u614b\u3060\u3068 _ZL8mojimoji ) \u306f\u30bb\u30af\u30b7\u30e7\u30f3\u306e\u30aa\u30d5\u30bb\u30c3\u30c8 0x18 \u306b\u5c45\u308b\n\n\n\nmojisize \uff08 _ZL8mojisize \uff09 \u306f\u30bb\u30af\u30b7\u30e7\u30f3\u306e\u30aa\u30d5\u30bb\u30c3\u30c8 0x10 \u306b\u5c45\u308b\n\n\n\n\u3068\u3001\u8a00\u3046\u308f\u3051\u3067\u3001\u30d0\u30a4\u30ca\u30ea\u30fc\u30d5\u30a1\u30a4\u30eb a.exe \u306e\u30aa\u30d5\u30bb\u30c3\u30c8\u3067:\n\n\n0x0a6400 + 0x18 = 0x0a6418 : mojimoji \u304c\u5c45\u308b\n\n0x0a6400 + 0x10 = 0x0a6410 : mojisize \u304c\u5c45\u308b\n\n\u3068\u306a\u308a\u307e\u3059\u3002\n\n\u5b9f\u969b\u306e\u30c7\u30fc\u30bf\u3092\u78ba\u8a8d\nod -A x -j 0x0a6418 -a a.exe | head -n1 \u3057\u3066\u30d0\u30a4\u30ca\u30ea\u30fc\u30d5\u30a1\u30a4\u30eb a.exe \u306e\u30d5\u30a1\u30a4\u30eb\u30aa\u30d5\u30bb\u30c3\u30c8\u30a2\u30c9\u30ec\u30b9 0x0a6418 \u304b\u3089\u306e mojimoji \u306e\u30d0\u30a4\u30c8\u5217\u3092ASCII\u6587\u5b57\u306e\u30c0\u30f3\u30d7\u3067\u78ba\u8a8d\u3057\u3066\u307f\u307e\u3059:\n0a6418   a   b   c   d   1   2   3   4 nul nul nul nul nul nul nul nul\n\n\u5c45\u307e\u3057\u305f\u30fd(\u00b4\u30fc\uff40)\u30ce\nod -A x -j 0x0a6410 -t d1 a.exe | head -n1 \u3057\u3066 0x0a6410 \u306e mojisize \u3092 10\u9032\u6570\u306e\u30c0\u30f3\u30d7\u3067\u78ba\u8a8d\u3057\u3066\u307f\u307e\u3059:\n0a6410    9    0    0    0    0    0    0    0   97   98   99  100   49   50   51   52\n\n\u5c45\u307e\u3057\u305f\u30fd(\u00b4\u30fc\uff40)\u30ce\n\n\u30d0\u30a4\u30ca\u30ea\u30fc\u30d5\u30a1\u30a4\u30eb\u306e\u5909\u6570\u3092\u66f8\u304d\u63db\u3048\u3066\u5b9f\u884c\ncp a.exe b.exe \u306a\u3069\u3057\u3066\u30b3\u30d4\u30fc\u3057\u305f b.exe \u306e 0x0a6418 \u304b\u3089\u306e 9 bytes \u3092 \"ajipon\\0\\0\\0\" \u306b\u66f8\u304d\u63db\u3048\u3066 b.exe \u3092\u5b9f\u884c\u3057\u3066\u307f\u307e\u3057\u3087\u3046: \u20204\n./b\najipon 9\n\n\u3067\u304d\u307e\u3057\u305f\u30fd(\u00b4\u30fc\uff40)\u30ce\n\n\u8a3b\n\n\u20200: \u8a18\u4e8b\u5192\u982d\u306e\u6982\u8981\u672c\u6587\u4e2d\u306e\u3069\u3046\u3067\u3082\u3088\u3055\u305d\u3046\u306a\u8868\u73fe\u306f\u30d5\u30a3\u30af\u30b7\u30e7\u30f3\u3067\u3059\u3002\n\u20201: volatile \u3092\u4ed8\u3051\u306a\u3044\u3068 -O3 \u3067\u30b7\u30f3\u30dc\u30eb\u304c\u5439\u304d\u98db\u3076\u53ef\u80fd\u6027\u304c\u3042\u308a\u307e\u3059\u3002nm\u306a\u3069\u3067\u30b7\u30f3\u30dc\u30eb\u304c\u898b\u3064\u304b\u3089\u306a\u3044\u5834\u5408\u306e\u539f\u56e0\u3068\u306a\u308b\u53ef\u80fd\u6027\u304c\u3042\u308a\u307e\u3059\u3002\n\u20202: nm \u306e\u30aa\u30d7\u30b7\u30e7\u30f3 -C \u3092\u4ed8\u3051\u306a\u3044\u3068 C++ \u306e\u30de\u30f3\u30b0\u30ea\u30f3\u30b0\u3055\u308c\u305f\u30b7\u30f3\u30dc\u30eb\u540d\u304c\u8868\u793a\u3055\u308c\u308b\u4e8b\u306b\u306a\u308a\u307e\u3059\u3002\u8907\u96d1\u306a\u968e\u5c64\u69cb\u9020\u306b\u306a\u3063\u3066\u3044\u305f\u308a\u3059\u308b\u3068\u3072\u3046\u307e\u3093\u306e\u8133\u306b\u306f\u8f9b\u3044\u306e\u3067 C++er \u306f nm \u306e -C \u306f c++ \u306e -std=c++14 \u3068\u540c\u3058\u304f\u3089\u3044\u6a19\u6e96\u7684\u306b\u4ed8\u3051\u308b\u3082\u306e\u3060\u3068\u601d\u3063\u3066\u5dee\u3057\u652f\u3048\u3042\u308a\u307e\u305b\u3093\u3002\n\u20203: grep \u305b\u305a\u306b > a.objdump.txt \u3084 | less \u306a\u3069\u3057\u3066\u8aad\u3080\u3068\u51fa\u529b\u306b\u3061\u3083\u3093\u3068\u30ab\u30e9\u30e0\u304c\u305d\u308c\u305e\u308c\u4f55\u3067\u3042\u308b\u304b\u4e01\u5be7\u306b\u51fa\u529b\u3055\u308c\u3066\u3044\u305f\u308a\u3057\u307e\u3059\u3002\u3084\u308a\u65b9\u3068\u3057\u3066\u306e\u5b9f\u7528\u4e0a\u306f\u4e0d\u8981\u3067\u3059\u304c1\u5ea6\u306f\u51fa\u529b\u5168\u4f53\u3092\u773a\u3081\u3066\u304a\u304f\u4e8b\u3092\u304a\u52e7\u3081\u3057\u307e\u3059\u3002\n\u20204: \u30b3\u30de\u30f3\u30c9\u3060\u3051\u3067\u30d0\u30a4\u30ca\u30ea\u30fc\u5dee\u5206\u3092\u66f8\u304d\u63db\u3048\u308b\u306e\u306f\u9762\u5012\u304b\u306a\u3068\u601d\u3063\u305f\u306e\u3067\u4eca\u56de\u306f\u66f8\u304d\u63db\u3048\u306b Bz \u3092\u4f7f\u3044\u307e\u3057\u305f\u3002\n\n# \u6982\u8981\n\n\u3068\u3042\u308b C++ \u306e\u30bd\u30d5\u30c8\u30a6\u30a7\u30a2\u958b\u767a\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3067\u65b0\u4eba\u3082\u305d\u308d\u305d\u308d\u5352\u696d\u304b\u306a\u3068\u3044\u3046\u82e5\u3044\u30a4\u30b1\u30e1\u30f3\u304f\u3093\u304c\n\n\u300c\u5148\u8f29\uff01\u3046\u3061\u306e\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306e\u30d0\u30a4\u30ca\u30ea\u30fc\u5b9f\u884c\u30d5\u30a1\u30a4\u30eb\u306b\u542b\u307e\u308c\u3066\u3044\u308b\u5909\u6570 `mojimoji` \u306e\u5024\u3092\u30d3\u30eb\u30c9\uff08\u7ffb\u8a33\uff0b\u30ea\u30f3\u30af\uff09\u3057\u305f\u5f8c\u3067\u66f8\u304d\u63db\u3048\u308b\u306a\u3093\u3066\u7121\u8336\u306a\u4e8b\u3092\u3057\u305f\u3044\u304b\u3082\u3057\u308c\u306a\u3044\u3067\u3059\uff01\uff01\u300d\n\n\u305d\u3093\u306a\u72b6\u6cc1\u304c\u767a\u751f\u3057\u3066\u3044\u305f\u306e\u3067\u65e9\u8d77\u304d\u3057\u3066\u696d\u52d9\u6642\u9593\u5916\u306b Qiita \u306b\u3084\u308a\u65b9\u3092\u66f8\u3044\u3066\u304a\u304f\u30b5\u30f3\u30bf\u30af\u30ed\u30fc\u30b9\u98a8\u306e\u30b7\u30e3\u30a4\u306a\u30d7\u30ec\u30bc\u30f3\u30c8\u65b9\u5f0f\u3092\u53d6\u308b\u3053\u3068\u306b\u3057\u305f\u79c1\u3060\u3063\u305f\u3002\uff08\u20200\uff09\n\n# \u72b6\u6cc1\u306e\u4f8b\n\n- a.cxx \u306b\u306f\u30d3\u30eb\u30c9\u5f8c\u306b\u66f8\u304d\u63db\u3048\u305f\u3044\u5909\u6570 `mojimoji` \u3084 `mojisize` \u304c\u542b\u307e\u308c\u3066\u3044\u308b\u3068\u3057\u307e\u3059\u3002\n\n\u4f8b\u3048\u3070\u2193\u3053\u3093\u306a\u306e\u3067\u3059\u306d\u3002\n\n```cpp\nstatic volatile constexpr char mojimoji[] = \"abcd1234\";\nstatic volatile constexpr unsigned char mojisize = sizeof( mojimoji );\n\n#include <iostream>\n\nauto main() -> int\n{\n  std::cout << ( const char* )mojimoji << \" \" << std::to_string( mojisize );\n}\n```\n\n`g++ -std=c++14 -O3 a.cxx` \u306a\u3069\u3057\u3066\u7ffb\u8a33\u3059\u308b\u3068 \u5b9f\u884c\u30d5\u30a1\u30a4\u30eb `a` \uff08mingw \u306a\u3089 `a.exe` \uff09 \u304c\u3067\u304d\u3066\u3001\u3053\u308c\u306f\u5b9f\u884c\u3059\u308b\u3068 `abcd1234 9` \u3068\u8868\u793a\u3057\u3066\u304f\u308c\u307e\u3059\u3002\uff08\u20201\uff09\n\n\u3055\u3066\u3001\u4f8b\u3048\u3070\u3053\u308c\u3092 `ajipon 9` \u3068\u8868\u793a\u3059\u308b\u3088\u3046\u306b C++ \u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u81ea\u4f53\u306e\u30ea\u30d3\u30eb\u30c9\u7121\u3057\u3067\u3001\u30dd\u30b9\u30c8\u30d7\u30ed\u30bb\u30b9\u3060\u3051\u3067\u3069\u3046\u306b\u304b\u3057\u305f\u3044\u306e\u3067\u3059\u3002\n\n# \u65b9\u6cd5\n\n## \u78ba\u8a8d\n\n### nm: \u30b7\u30f3\u30dc\u30eb\u30a8\u30f3\u30c8\u30ea\u30fc\u306e\u78ba\u8a8d\n\n\u306f\u3058\u3081\u306b\u3001 `a.exe` \u306b `mojimoji` \u3084 `mojisize` \u306e\u30b7\u30f3\u30dc\u30eb\u30a8\u30f3\u30c8\u30ea\u30fc\u304c\u3042\u308b\u304b\u78ba\u8a8d\u3057\u3066\u307f\u307e\u3057\u3087\u3046:\n\n`nm -C a.exe | grep moji` \u3059\u308b\u3068\u3001\n\n```\n00000000004a7018 d mojimoji\n00000000004a7010 d mojisize\n```\n\n\u3042\u308a\u307e\u3057\u305f\u3002\uff08\u20202\uff09\u3053\u306e\u3088\u3046\u306b\u51fa\u3066\u304f\u308b\u72b6\u614b\u306a\u3089\u7c21\u5358\u306b\u3069\u3046\u306b\u304b\u306a\u308b\u3067\u3057\u3087\u3046\u3002\u305f\u3076\u3093\u3002\n\n\u3053\u306e\u8868\u793a\u304b\u3089\u306f\u3001\u30d0\u30a4\u30ca\u30ea\u30fc\u306e\u5b9f\u884c\u6642\u306e\u4eee\u60f3\u30e1\u30e2\u30ea\u30fc\u4e0a\u306e\u30a2\u30c9\u30ec\u30b9\uff08\u4eca\u56de\u306f\u4f7f\u3044\u307e\u305b\u3093\uff09\u3001 `d` \u306a\u306e\u3067\u30c7\u30fc\u30bf\u30bb\u30af\u30b7\u30e7\u30f3\u306b\u5c45\u308b\u3053\u3068\u3001\u305d\u3057\u3066\u30b7\u30f3\u30dc\u30eb\u540d\u304c `mojimoji` \u306a\u3069\u3067\u5b58\u5728\u3057\u3066\u3044\u308b\u3068\u308f\u304b\u308a\u307e\u3059\u3002\n\n### objdump: \u30b7\u30f3\u30dc\u30eb\u306e\u4f4d\u7f6e\n\n#### \u30bb\u30af\u30b7\u30e7\u30f3\u60c5\u5831\n\n`objdump -x a.exe | grep -10 Sections:` \u306a\u3069\u3057\u3066\u30bb\u30af\u30b7\u30e7\u30f3\u60c5\u5831\u3092\u78ba\u8a8d\u3057\u307e\u3057\u3087\u3046:\n\n```\n          pc+0x04: alloc small area: rsp = rsp - 0x28\n        Handler: 00000000004a6780.\n        User data:\n          000: ff ff 01 00\n 00000000004d4998 (rva: 000d4998): 00000000004a6d40 - 00000000004a6d4a\n        Version: 1, Flags: none\n        Nbr codes: 2, Prologue size: 0x04, Frame offset: 0x0, Frame reg: rbp\n          pc+0x04: FPReg: rbp = rsp + 0x0 (info = 0x0)\n          pc+0x01: push rbp\n\nSections:\nIdx Name          Size      VMA               LMA               File off  Algn\n  0 .text         000a5db0  0000000000401000  0000000000401000  00000600  2**4\n                  CONTENTS, ALLOC, LOAD, READONLY, CODE, DATA\n  1 .data         00002f28  00000000004a7000  00000000004a7000  000a6400  2**5\n                  CONTENTS, ALLOC, LOAD, DATA\n  2 .rdata        0000fbe0  00000000004aa000  00000000004aa000  000a9400  2**6\n                  CONTENTS, ALLOC, LOAD, READONLY, DATA\n  3 .pdata        0000b04c  00000000004ba000  00000000004ba000  000b9000  2**2\n                  CONTENTS, ALLOC, LOAD, READONLY, DATA\n  4 .xdata        0000e9a0  00000000004c6000  00000000004c6000  000c4200  2**2\n```\n\n`.data` \u30bb\u30af\u30b7\u30e7\u30f3\u306f\u30d0\u30a4\u30ca\u30ea\u30fc\u30d5\u30a1\u30a4\u30eb\u4e0a\u306e\u30aa\u30d5\u30bb\u30c3\u30c8\u30a2\u30c9\u30ec\u30b9 `000a6400` \u306b\u5c45\u308b\u3068\u308f\u304b\u308a\u307e\u3057\u305f\u3002\u20203\n\n#### \u30b7\u30f3\u30dc\u30eb\u306e\u30a2\u30c9\u30ec\u30b9\n\n\u7d9a\u3044\u3066\u3001 `objdump -x a.exe | grep moji` \u306a\u3069\u3057\u3066 `mojimoji` \u306e\u30a2\u30c9\u30ec\u30b9\u30aa\u30d5\u30bb\u30c3\u30c8\u3092\u78ba\u8a8d\u3057\u307e\u3057\u3087\u3046:\n\n```\n[134](sec  2)(fl 0x00)(ty   0)(scl   3) (nx 0) 0x0000000000000018 _ZL8mojimoji\n[138](sec  2)(fl 0x00)(ty   0)(scl   3) (nx 0) 0x0000000000000010 _ZL8mojisize\n```\n\n`_ZL8mojimoji` \uff08\u30de\u30f3\u30b0\u30ea\u30f3\u30b0\u3055\u308c\u305f `mojimoji`\uff09\u3068 `_ZL8mojisize` \uff08\u30de\u30f3\u30b0\u30ea\u30f3\u30b0\u3055\u308c\u305f `mojisize`\uff09\u304c\u30bb\u30af\u30b7\u30e7\u30f3\u306e\u30a2\u30c9\u30ec\u30b9\u30aa\u30d5\u30bb\u30c3\u30c8 `0x18` \u3068 `0x10` \u306b\u305d\u308c\u305e\u308c\u5c45\u308b\u3068\u308f\u304b\u308a\u307e\u3059\u3002\n\n### \u3053\u3053\u307e\u3067\u306b\u308f\u304b\u3063\u3066\u3044\u308b\u4e8b\u3092\u6574\u7406\n\n- `mojimoji` \u306f `.data` \u30bb\u30af\u30b7\u30e7\u30f3\u306b\u5c45\u308b\n- `.data` \u30bb\u30af\u30b7\u30e7\u30f3\u306f\u30d5\u30a1\u30a4\u30eb\u30aa\u30d5\u30bb\u30c3\u30c8 `0x0a6400` \u30d0\u30a4\u30c8\u306b\u5c45\u308b\n- `mojimoji` ( \u30de\u30f3\u30b0\u30ea\u30f3\u30b0\u3055\u308c\u305f\u72b6\u614b\u3060\u3068 `_ZL8mojimoji` ) \u306f\u30bb\u30af\u30b7\u30e7\u30f3\u306e\u30aa\u30d5\u30bb\u30c3\u30c8 `0x18` \u306b\u5c45\u308b\n    - `mojisize` \uff08 `_ZL8mojisize` \uff09 \u306f\u30bb\u30af\u30b7\u30e7\u30f3\u306e\u30aa\u30d5\u30bb\u30c3\u30c8 `0x10` \u306b\u5c45\u308b\n\n\u3068\u3001\u8a00\u3046\u308f\u3051\u3067\u3001\u30d0\u30a4\u30ca\u30ea\u30fc\u30d5\u30a1\u30a4\u30eb `a.exe` \u306e\u30aa\u30d5\u30bb\u30c3\u30c8\u3067:\n\n- `0x0a6400` + `0x18` = `0x0a6418` : `mojimoji` \u304c\u5c45\u308b\n- `0x0a6400` + `0x10` = `0x0a6410` : `mojisize` \u304c\u5c45\u308b\n\n\u3068\u306a\u308a\u307e\u3059\u3002\n\n### \u5b9f\u969b\u306e\u30c7\u30fc\u30bf\u3092\u78ba\u8a8d\n\n`od -A x -j 0x0a6418 -a a.exe | head -n1` \u3057\u3066\u30d0\u30a4\u30ca\u30ea\u30fc\u30d5\u30a1\u30a4\u30eb `a.exe` \u306e\u30d5\u30a1\u30a4\u30eb\u30aa\u30d5\u30bb\u30c3\u30c8\u30a2\u30c9\u30ec\u30b9 `0x0a6418` \u304b\u3089\u306e `mojimoji` \u306e\u30d0\u30a4\u30c8\u5217\u3092ASCII\u6587\u5b57\u306e\u30c0\u30f3\u30d7\u3067\u78ba\u8a8d\u3057\u3066\u307f\u307e\u3059:\n\n```\n0a6418   a   b   c   d   1   2   3   4 nul nul nul nul nul nul nul nul\n```\n\n\u5c45\u307e\u3057\u305f\u30fd(\u00b4\u30fc\uff40)\u30ce\n\n`od -A x -j 0x0a6410 -t d1 a.exe | head -n1` \u3057\u3066 `0x0a6410` \u306e `mojisize` \u3092 10\u9032\u6570\u306e\u30c0\u30f3\u30d7\u3067\u78ba\u8a8d\u3057\u3066\u307f\u307e\u3059:\n\n```\n0a6410    9    0    0    0    0    0    0    0   97   98   99  100   49   50   51   52\n```\n\n\u5c45\u307e\u3057\u305f\u30fd(\u00b4\u30fc\uff40)\u30ce\n\n## \u30d0\u30a4\u30ca\u30ea\u30fc\u30d5\u30a1\u30a4\u30eb\u306e\u5909\u6570\u3092\u66f8\u304d\u63db\u3048\u3066\u5b9f\u884c\n\n`cp a.exe b.exe` \u306a\u3069\u3057\u3066\u30b3\u30d4\u30fc\u3057\u305f `b.exe` \u306e `0x0a6418` \u304b\u3089\u306e 9 bytes \u3092 `\"ajipon\\0\\0\\0\"` \u306b\u66f8\u304d\u63db\u3048\u3066 `b.exe` \u3092\u5b9f\u884c\u3057\u3066\u307f\u307e\u3057\u3087\u3046: \u20204\n\n```\n./b\najipon 9\n```\n\n\u3067\u304d\u307e\u3057\u305f\u30fd(\u00b4\u30fc\uff40)\u30ce\n\n# \u8a3b\n\n- \u20200: \u8a18\u4e8b\u5192\u982d\u306e\u6982\u8981\u672c\u6587\u4e2d\u306e\u3069\u3046\u3067\u3082\u3088\u3055\u305d\u3046\u306a\u8868\u73fe\u306f\u30d5\u30a3\u30af\u30b7\u30e7\u30f3\u3067\u3059\u3002\n- \u20201: `volatile` \u3092\u4ed8\u3051\u306a\u3044\u3068 `-O3` \u3067\u30b7\u30f3\u30dc\u30eb\u304c\u5439\u304d\u98db\u3076\u53ef\u80fd\u6027\u304c\u3042\u308a\u307e\u3059\u3002`nm`\u306a\u3069\u3067\u30b7\u30f3\u30dc\u30eb\u304c\u898b\u3064\u304b\u3089\u306a\u3044\u5834\u5408\u306e\u539f\u56e0\u3068\u306a\u308b\u53ef\u80fd\u6027\u304c\u3042\u308a\u307e\u3059\u3002\n- \u20202: `nm` \u306e\u30aa\u30d7\u30b7\u30e7\u30f3 `-C` \u3092\u4ed8\u3051\u306a\u3044\u3068 C++ \u306e\u30de\u30f3\u30b0\u30ea\u30f3\u30b0\u3055\u308c\u305f\u30b7\u30f3\u30dc\u30eb\u540d\u304c\u8868\u793a\u3055\u308c\u308b\u4e8b\u306b\u306a\u308a\u307e\u3059\u3002\u8907\u96d1\u306a\u968e\u5c64\u69cb\u9020\u306b\u306a\u3063\u3066\u3044\u305f\u308a\u3059\u308b\u3068\u3072\u3046\u307e\u3093\u306e\u8133\u306b\u306f\u8f9b\u3044\u306e\u3067 C++er \u306f `nm` \u306e `-C` \u306f `c++` \u306e `-std=c++14` \u3068\u540c\u3058\u304f\u3089\u3044\u6a19\u6e96\u7684\u306b\u4ed8\u3051\u308b\u3082\u306e\u3060\u3068\u601d\u3063\u3066\u5dee\u3057\u652f\u3048\u3042\u308a\u307e\u305b\u3093\u3002\n- \u20203: `grep` \u305b\u305a\u306b ` > a.objdump.txt` \u3084 ` | less` \u306a\u3069\u3057\u3066\u8aad\u3080\u3068\u51fa\u529b\u306b\u3061\u3083\u3093\u3068\u30ab\u30e9\u30e0\u304c\u305d\u308c\u305e\u308c\u4f55\u3067\u3042\u308b\u304b\u4e01\u5be7\u306b\u51fa\u529b\u3055\u308c\u3066\u3044\u305f\u308a\u3057\u307e\u3059\u3002\u3084\u308a\u65b9\u3068\u3057\u3066\u306e\u5b9f\u7528\u4e0a\u306f\u4e0d\u8981\u3067\u3059\u304c1\u5ea6\u306f\u51fa\u529b\u5168\u4f53\u3092\u773a\u3081\u3066\u304a\u304f\u4e8b\u3092\u304a\u52e7\u3081\u3057\u307e\u3059\u3002\n- \u20204: \u30b3\u30de\u30f3\u30c9\u3060\u3051\u3067\u30d0\u30a4\u30ca\u30ea\u30fc\u5dee\u5206\u3092\u66f8\u304d\u63db\u3048\u308b\u306e\u306f\u9762\u5012\u304b\u306a\u3068\u601d\u3063\u305f\u306e\u3067\u4eca\u56de\u306f\u66f8\u304d\u63db\u3048\u306b [Bz](http://www.forest.impress.co.jp/library/software/binaryeditbz/) \u3092\u4f7f\u3044\u307e\u3057\u305f\u3002\n\n", "tags": ["C++", "od", "objdump", "nm", "Binary"]}