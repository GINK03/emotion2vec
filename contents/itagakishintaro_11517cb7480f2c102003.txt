{"context": " More than 1 year has passed since last update.WebAPI\u3067\u3068\u3063\u305f\u30c7\u30fc\u30bf\u3092Google Map\u306b\u306e\u305b\u308b\u306e\u7d9a\u304d\u7684\u306b\u3002\n\n\n\u6d41\u308c\n\n\u5e9c\u7701\u3054\u3068\u306e\u60c5\u5831\u30b7\u30b9\u30c6\u30e0\u4e88\u7b97\u3092WebAPI\u304b\u3089\u3068\u3063\u3066\u304f\u308b\n\u5e9c\u7701\u540d\u304b\u3089\u4f4f\u6240\u3092\u3068\u3063\u3066\u304f\u308b\nGoogle Map\u3092\u63cf\u753b\nGoogle Map\u306e\u4e0a\u306b\u5e9c\u7701\u3054\u3068\u306b\u4e88\u7b97\u984d\u306b\u5fdc\u3058\u305f\u30b0\u30e9\u30d5\u3092D3.js\u3067\u63cf\u304f\n\n\n\u4f7f\u3046\u3082\u306e\n\nIT Dashboard WebAPI\n\n\u60c5\u5831\u30b7\u30b9\u30c6\u30e0\u4e88\u7b97\u304c\u3042\u308b\u306e\u3067\u3001\u305d\u308c\u3092\u4f7f\u3044\u307e\u3059\u3002\nhttp://www.itdashboard.go.jp/DataFeeds/webapi#300\n\nGoogle Geocoding API\n\n\u4f4f\u6240\u3092\u53d6\u5f97\u3059\u308b\u306e\u306b\u4f7f\u3044\u307e\u3059\u3002\nhttps://developers.google.com/maps/documentation/webservices/?hl=ja\n\nGoogle Map API\n\n\u5730\u56f3\u306b\u4f7f\u3044\u307e\u3059\u3002\nhttps://developers.google.com/maps/?hl=ja\n\n\u5e9c\u7701\u3054\u3068\u306e\u60c5\u5831\u30b7\u30b9\u30c6\u30e0\u4e88\u7b97\u3092WebAPI\u304b\u3089\u3068\u3063\u3066\u304f\u308b\nfusho_array{\n    \u5e9c\u7701\u540d{\n        budget: \u4e88\u7b97,\n        lat: \u7def\u5ea6,\n        lng: \u7d4c\u5ea6\n    }\n}\n\n\u306e\u5f62\u5f0f\u3067\u30c7\u30fc\u30bf\u3092\u5165\u308c\u305f\u3044\u3068\u601d\u3044\u307e\u3059\u3002\n\u307e\u305a\u306f\u3001\u7def\u5ea6\u7d4c\u5ea6\u306f\u7a7a\u3067\u5e9c\u7701\u540d\u3060\u3051\u3092\u5165\u308c\u307e\u3059\u3002\nIT Dashboard\u306e\u4ee5\u4e0b\u306e\u30da\u30fc\u30b8\u306b\u30b5\u30f3\u30d7\u30eb\u30b3\u30fc\u30c9\u3082\u3042\u308a\u307e\u3059\u3002\n\u30dd\u30a4\u30f3\u30c8\u306f\u3001\u540c\u3058\u5e9c\u7701\u3067\u3082\u30b7\u30b9\u30c6\u30e0\u3054\u3068\u306b\u4e88\u7b97\u304c\u3068\u308c\u308b\u306e\u3067\u5408\u8a08\u3057\u3066\u3084\u308b\u5fc5\u8981\u304c\u3042\u308b\u3068\u3053\u308d\u3067\u3059\u3002if-else\u3067\u5206\u5c90\u3057\u3066\u3044\u308b\u3068\u3053\u308d\u304c\u305d\u3046\u3067\u3059\u3002\nhttp://www.itdashboard.go.jp/DataFeeds/webapi#300\n\u3042\u307e\u308a\u3088\u304f\u306a\u3044\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u304c\u3001\u4e0a\u8a18\u6d41\u308c\u3092\u30b7\u30fc\u30b1\u30f3\u30b7\u30e3\u30eb\u306b\u5b9f\u884c\u3057\u305f\u3044\u305f\u3081\u3001async: false\u3092\u5165\u308c\u3066\u3001\u540c\u671f\u51e6\u7406\u306b\u3057\u3066\u3044\u307e\u3059\u3002\nfunction getFushoITBudget() {\n    $.ajax({\n        url: \"http://www.itdashboard.go.jp/PublicApi/getData.json\",\n        data: {\n            dataset: \"Budget\",\n            field: \"organization,sum_budget\"\n        },\n        async: false\n    }).done(function(data) {\n        $.each(data.raw_data, function(i, item) {\n            if (fusho_array[item.organization] === undefined) {\n                fusho_array[item.organization] = {\n                    \"budget\": item.sum_budget\n                };\n            } else {\n                fusho_array[item.organization].budget = Number(fusho_array[item.organization].budget) + item.sum_budget;\n            }\n        });\n    });\n}\n\n\n\u5e9c\u7701\u540d\u304b\u3089\u4f4f\u6240\u3092\u3068\u3063\u3066\u304f\u308b\n\u3069\u3046\u3082\u3001\u5e9c\u7701\u540d\u306b\u3088\u3063\u3066\u306f\u3001\u4f4f\u6240\u304c\u53d6\u308c\u306a\u3044\u3082\u306e\u3082\u3042\u308b\u3088\u3046\u3067\u3059\u3002\n\u305d\u3053\u3067\u3001\u5206\u5c90\u3092\u5165\u308c\u3066\u3001\u3068\u308c\u306a\u304b\u3063\u305f\u3082\u306e\u306f\u30ed\u30b0\u306b\u5410\u3044\u3066\u3044\u307e\u3059\u3002\n\u3053\u3061\u3089\u3082\u3001\u4e0a\u8a18\u6d41\u308c\u3092\u30b7\u30fc\u30b1\u30f3\u30b7\u30e3\u30eb\u306b\u5b9f\u884c\u3057\u305f\u3044\u305f\u3081\u3001async: false\u3092\u5165\u308c\u3066\u3001\u540c\u671f\u51e6\u7406\u306b\u3057\u3066\u3044\u307e\u3059\u3002\nfunction getFushoAddress() {\n    $.each(fusho_array, function(name, object) {\n        var geocoding = \"http://maps.googleapis.com/maps/api/geocode/json\";\n        $.ajax({\n            url: geocoding,\n            data: {\n                address: name\n            },\n            async: false\n        }).done(function(data) {\n            if (data.results[0] === undefined) {\n                console.log(name);\n            } else {\n                fusho_array[name][\"lat\"] = data.results[0].geometry.location.lat;\n                fusho_array[name][\"lng\"] = data.results[0].geometry.location.lng;\n            }\n        });\n    });\n}\n\n\nGoogle Map\u3092\u63cf\u753b\nid\u304cmap-canvas\u306e\u8981\u7d20\u306bGoogle Map\u3092\u8868\u793a\u3057\u307e\u3059\u3002\nmap\u306e\u30aa\u30d7\u30b7\u30e7\u30f3(mapOptions)\u306e\u4e2d\u5fc3\u5730\u70b9\u306f\u3001\u3068\u308a\u3042\u3048\u305a\u3001\u971e\u304c\u95a2\u306e\u7def\u5ea6\u7d4c\u5ea6\u3092\u30cf\u30fc\u30c9\u30b3\u30fc\u30c7\u30a3\u30f3\u30b0\u3057\u3066\u3044\u307e\u3059\u3002\uff53\nfunction handleLoadGoogleMap() {\n    var mapOptions = {\n        center: new google.maps.LatLng(35.673838, 139.750899),\n        zoom: 16,\n        mapTypeId: google.maps.MapTypeId.ROADMAP,\n        mapTypeControl: false,\n        disableDefaultUI: true\n    };\n    mymap = new google.maps.Map(document.getElementById(\"map-canvas\"), mapOptions);\n}\n\n\nGoogle Map\u306e\u4e0a\u306b\u5e9c\u7701\u3054\u3068\u306b\u4e88\u7b97\u984d\u306b\u5fdc\u3058\u305f\u30b0\u30e9\u30d5\u3092D3.js\u3067\u63cf\u304f\n\u6b21\u306e\u30b5\u30a4\u30c8\u3092\u53c2\u8003\u306b\u3055\u305b\u3066\u3082\u3089\u3044\u307e\u3057\u305f\u3002\nhttp://shimz.me/blog/d3-js/3733\noverlay\u3092\u4f7f\u3046\u3068\u3053\u308d\u4ee5\u5916\u306f\u901a\u5e38\u306ed3.js\u3067\u3059\u3002\n\u30dd\u30a4\u30f3\u30c8\u306f\u3001\u6b21\u306e\u7def\u5ea6\u7d4c\u5ea6\u3092px\u5ea7\u6a19\u306b\u5909\u63db\u3057\u3066\u3044\u308b\u3068\u3053\u308d\u3002\n// \u7def\u5ea6\u7d4c\u5ea6\u3092px\u5ea7\u6a19\u306b\u5909\u63db\nvar point = this.getProjection().fromLatLngToDivPixel(new google.maps.LatLng(object.lat, object.lng));\n\n<style>\n.SvgOverlay {\n    position: relative;\n}\n.SvgOverlay svg {\n    position: absolute;\n    top: 0;\n    left: 0;\n    width: 8000px;\n    height: 8000px;\n}\n</style>\n\nfunction overlayITBudget() {\n    $.each(fusho_array, function(name, object) {\n        // D3js\u3067\u30b0\u30e9\u30d5\u3092\u8868\u793a\n        if (object.lat !== undefined) {\n            var overlay = new google.maps.OverlayView(); //OverLay\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306e\u4f5c\u6210\n            overlay.onAdd = function() {\n                //\u30aa\u30fc\u30d0\u30fc\u30ec\u30a4\u8a2d\u5b9a\n                var layer = d3.select(\"#map-canvas\").append(\"div\").attr(\"class\", \"SvgOverlay\");\n                var svg = layer.append(\"svg\");\n\n                // \u7def\u5ea6\u7d4c\u5ea6\u3092px\u5ea7\u6a19\u306b\u5909\u63db\n                var point = this.getProjection().fromLatLngToDivPixel(new google.maps.LatLng(object.lat, object.lng));\n                overlay.draw = function() {\n                    // \u4e88\u7b97\u3067\u68d2\u30b0\u30e9\u30d5\u3067\u8868\u793a\n                    svg.selectAll(\".node\")\n                        .data([point]).enter()\n                        .append(\"line\")\n                        .attr(\"class\", \"node\")\n                        .attr(\"x1\", function(d) {\n                            return d.x;\n                        })\n                        .attr(\"x2\", function(d) {\n                            return d.x;\n                        })\n                        .attr(\"y1\", function(d) {\n                            return d.y - object.budget / 1000000000;\n                        })\n                        .attr(\"y2\", function(d) {\n                            return d.y;\n                        })\n                        .style(\"stroke\", \"gray\")\n                        .style(\"stroke-width\", \"10px\");\n                    // \u5e9c\u7701\u540d\u3092\u30c6\u30ad\u30b9\u30c8\u3067\u8868\u793a\n                    svg.selectAll(\"text\")\n                        .data([point]).enter()\n                        .append(\"text\")\n                        .attr(\"x\", function(d) {\n                            return d.x;\n                        })\n                        .attr(\"y\", function(d) {\n                            return d.y;\n                        })\n                        .attr(\"fill\", \"blue\")\n                        .attr(\"font-size\", \"12px\")\n                        .text(name);\n                }\n                overlay.draw();\n            }\n            overlay.setMap(mymap);\n        }\n    });\n}\n\n\n\u5b8c\u6210\u54c1\n<!DOCTYPE html>\n<html lang='ja'>\n\n<head>\n    <meta charset='utf-8'>\n    <title>\u5e9c\u7701map</title>\n\n    <script type='text/javascript' src='https://maps.googleapis.com/maps/api/js?sensor=false'>\n    </script>\n    <script src='js/d3.min.js'></script>\n    <script src='js/markerwithlabel_packed.js'></script>\n<style>\n#map-canvas {\n    width: 100%;\n    height: 600px;\n}\n.labels {\n    color: black;\n    background-color: white;\n    font-family: 'Lucida Grande', 'Hiragino Kaku Gothic ProN', '\u30d2\u30e9\u30ae\u30ce\u89d2\u30b4 ProN W3', Meiryo, \u30e1\u30a4\u30ea\u30aa, sans-serif;\n    font-size: 10px;\n    text-align: center;\n    border: 1px solid black;\n    white-space: nowrap;\n}\n.SvgOverlay {\n    position: relative;\n}\n.SvgOverlay svg {\n    position: absolute;\n    top: 0;\n    left: 0;\n    width: 8000px;\n    height: 8000px;\n}\n</style>\n</head>\n\n<body>\n    <h1>\u5e9c\u7701\u60c5\u5831\u30b7\u30b9\u30c6\u30e0\u4e88\u7b97</h1>\n    <div id='map-canvas'></div>\n\n    <script src='js/jquery-2.1.1.min.js'></script>\n    <script type=\"text/javascript\">\n    var mymap;\n    var fusho_array = {};\n    google.maps.event.addDomListener(window, 'load', draw);\n\n    function draw() {\n        getFushoITBudget();\n        getFushoAddress();\n        handleLoadGoogleMap();\n        overlayITBudget();\n    }\n\n    function getFushoITBudget() {\n        $.ajax({\n            url: \"http://www.itdashboard.go.jp/PublicApi/getData.json\",\n            data: {\n                dataset: \"Budget\",\n                field: \"organization,sum_budget\"\n            },\n            async: false\n        }).done(function(data) {\n            $.each(data.raw_data, function(i, item) {\n                if (fusho_array[item.organization] === undefined) {\n                    fusho_array[item.organization] = {\n                        \"budget\": item.sum_budget\n                    };\n                } else {\n                    fusho_array[item.organization].budget = Number(fusho_array[item.organization].budget) + item.sum_budget;\n                }\n            });\n        });\n    }\n\n    function getFushoAddress() {\n        $.each(fusho_array, function(name, object) {\n            var geocoding = \"http://maps.googleapis.com/maps/api/geocode/json\";\n            $.ajax({\n                url: geocoding,\n                data: {\n                    address: name\n                },\n                async: false\n            }).done(function(data) {\n                if (data.results[0] === undefined) {\n                    console.log(name);\n                } else {\n                    fusho_array[name][\"lat\"] = data.results[0].geometry.location.lat;\n                    fusho_array[name][\"lng\"] = data.results[0].geometry.location.lng;\n                }\n            });\n        });\n    }\n\n    function handleLoadGoogleMap() {\n        var mapOptions = {\n            center: new google.maps.LatLng(35.673838, 139.750899),\n            zoom: 16,\n            mapTypeId: google.maps.MapTypeId.ROADMAP,\n            mapTypeControl: false,\n            disableDefaultUI: true\n        };\n        mymap = new google.maps.Map(document.getElementById(\"map-canvas\"), mapOptions);\n    }\n\n    function overlayITBudget() {\n        $.each(fusho_array, function(name, object) {\n            // D3js\u3067\u30b0\u30e9\u30d5\u3092\u8868\u793a\n            if (object.lat !== undefined) {\n                var overlay = new google.maps.OverlayView(); //OverLay\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306e\u4f5c\u6210\n                overlay.onAdd = function() {\n                    //\u30aa\u30fc\u30d0\u30fc\u30ec\u30a4\u8a2d\u5b9a\n                    var layer = d3.select(\"#map-canvas\").append(\"div\").attr(\"class\", \"SvgOverlay\");\n                    var svg = layer.append(\"svg\");\n\n                    // \u7def\u5ea6\u7d4c\u5ea6\u3092px\u5ea7\u6a19\u306b\u5909\u63db\n                    var point = this.getProjection().fromLatLngToDivPixel(new google.maps.LatLng(object.lat, object.lng));\n                    overlay.draw = function() {\n                        // \u4e88\u7b97\u3067\u68d2\u30b0\u30e9\u30d5\u3067\u8868\u793a\n                        svg.selectAll(\".node\")\n                            .data([point]).enter()\n                            .append(\"line\")\n                            .attr(\"class\", \"node\")\n                            .attr(\"x1\", function(d) {\n                                return d.x;\n                            })\n                            .attr(\"x2\", function(d) {\n                                return d.x;\n                            })\n                            .attr(\"y1\", function(d) {\n                                return d.y - object.budget / 1000000000;\n                            })\n                            .attr(\"y2\", function(d) {\n                                return d.y;\n                            })\n                            .style(\"stroke\", \"gray\")\n                            .style(\"stroke-width\", \"10px\");\n                        // \u5e9c\u7701\u540d\u3092\u30c6\u30ad\u30b9\u30c8\u3067\u8868\u793a\n                        svg.selectAll(\"text\")\n                            .data([point]).enter()\n                            .append(\"text\")\n                            .attr(\"x\", function(d) {\n                                return d.x;\n                            })\n                            .attr(\"y\", function(d) {\n                                return d.y;\n                            })\n                            .attr(\"fill\", \"blue\")\n                            .attr(\"font-size\", \"12px\")\n                            .text(name);\n                    }\n                    overlay.draw();\n                }\n                overlay.setMap(mymap);\n            }\n        });\n    }\n    </script>\n</body>\n\n</html>\n\n\n[WebAPI\u3067\u3068\u3063\u305f\u30c7\u30fc\u30bf\u3092Google Map\u306b\u306e\u305b\u308b](http://qiita.com/itagakishintaro/items/b0561d053241dc3f10a9)\u306e\u7d9a\u304d\u7684\u306b\u3002\n\n![fusho.png](https://qiita-image-store.s3.amazonaws.com/0/50720/5bb2c91f-3eed-fcc7-997a-e0e5e86a92d1.png \"fusho.png\")\n\n\n# \u6d41\u308c\n\n1. \u5e9c\u7701\u3054\u3068\u306e\u60c5\u5831\u30b7\u30b9\u30c6\u30e0\u4e88\u7b97\u3092WebAPI\u304b\u3089\u3068\u3063\u3066\u304f\u308b\n2. \u5e9c\u7701\u540d\u304b\u3089\u4f4f\u6240\u3092\u3068\u3063\u3066\u304f\u308b\n3. Google Map\u3092\u63cf\u753b\n4. Google Map\u306e\u4e0a\u306b\u5e9c\u7701\u3054\u3068\u306b\u4e88\u7b97\u984d\u306b\u5fdc\u3058\u305f\u30b0\u30e9\u30d5\u3092D3.js\u3067\u63cf\u304f\n\n# \u4f7f\u3046\u3082\u306e\n\n* IT Dashboard WebAPI\n\n\u60c5\u5831\u30b7\u30b9\u30c6\u30e0\u4e88\u7b97\u304c\u3042\u308b\u306e\u3067\u3001\u305d\u308c\u3092\u4f7f\u3044\u307e\u3059\u3002\nhttp://www.itdashboard.go.jp/DataFeeds/webapi#300\n\n* Google Geocoding API\n\n\u4f4f\u6240\u3092\u53d6\u5f97\u3059\u308b\u306e\u306b\u4f7f\u3044\u307e\u3059\u3002\nhttps://developers.google.com/maps/documentation/webservices/?hl=ja\n\n* Google Map API\n\n\u5730\u56f3\u306b\u4f7f\u3044\u307e\u3059\u3002\nhttps://developers.google.com/maps/?hl=ja\n\n# \u5e9c\u7701\u3054\u3068\u306e\u60c5\u5831\u30b7\u30b9\u30c6\u30e0\u4e88\u7b97\u3092WebAPI\u304b\u3089\u3068\u3063\u3066\u304f\u308b\n\n```\nfusho_array{\n\t\u5e9c\u7701\u540d{\n\t\tbudget: \u4e88\u7b97,\n\t\tlat: \u7def\u5ea6,\n\t\tlng: \u7d4c\u5ea6\n\t}\n}\n```\n\u306e\u5f62\u5f0f\u3067\u30c7\u30fc\u30bf\u3092\u5165\u308c\u305f\u3044\u3068\u601d\u3044\u307e\u3059\u3002\n\n\u307e\u305a\u306f\u3001\u7def\u5ea6\u7d4c\u5ea6\u306f\u7a7a\u3067\u5e9c\u7701\u540d\u3060\u3051\u3092\u5165\u308c\u307e\u3059\u3002\nIT Dashboard\u306e\u4ee5\u4e0b\u306e\u30da\u30fc\u30b8\u306b\u30b5\u30f3\u30d7\u30eb\u30b3\u30fc\u30c9\u3082\u3042\u308a\u307e\u3059\u3002\n\u30dd\u30a4\u30f3\u30c8\u306f\u3001\u540c\u3058\u5e9c\u7701\u3067\u3082\u30b7\u30b9\u30c6\u30e0\u3054\u3068\u306b\u4e88\u7b97\u304c\u3068\u308c\u308b\u306e\u3067\u5408\u8a08\u3057\u3066\u3084\u308b\u5fc5\u8981\u304c\u3042\u308b\u3068\u3053\u308d\u3067\u3059\u3002if-else\u3067\u5206\u5c90\u3057\u3066\u3044\u308b\u3068\u3053\u308d\u304c\u305d\u3046\u3067\u3059\u3002\n\nhttp://www.itdashboard.go.jp/DataFeeds/webapi#300\n\n\u3042\u307e\u308a\u3088\u304f\u306a\u3044\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u304c\u3001\u4e0a\u8a18\u6d41\u308c\u3092\u30b7\u30fc\u30b1\u30f3\u30b7\u30e3\u30eb\u306b\u5b9f\u884c\u3057\u305f\u3044\u305f\u3081\u3001`async: false`\u3092\u5165\u308c\u3066\u3001\u540c\u671f\u51e6\u7406\u306b\u3057\u3066\u3044\u307e\u3059\u3002\n\n```js\nfunction getFushoITBudget() {\n    $.ajax({\n        url: \"http://www.itdashboard.go.jp/PublicApi/getData.json\",\n        data: {\n            dataset: \"Budget\",\n            field: \"organization,sum_budget\"\n        },\n        async: false\n    }).done(function(data) {\n        $.each(data.raw_data, function(i, item) {\n            if (fusho_array[item.organization] === undefined) {\n                fusho_array[item.organization] = {\n                    \"budget\": item.sum_budget\n                };\n            } else {\n                fusho_array[item.organization].budget = Number(fusho_array[item.organization].budget) + item.sum_budget;\n            }\n        });\n    });\n}\n```\n\n# \u5e9c\u7701\u540d\u304b\u3089\u4f4f\u6240\u3092\u3068\u3063\u3066\u304f\u308b\n\n\u3069\u3046\u3082\u3001\u5e9c\u7701\u540d\u306b\u3088\u3063\u3066\u306f\u3001\u4f4f\u6240\u304c\u53d6\u308c\u306a\u3044\u3082\u306e\u3082\u3042\u308b\u3088\u3046\u3067\u3059\u3002\n\u305d\u3053\u3067\u3001\u5206\u5c90\u3092\u5165\u308c\u3066\u3001\u3068\u308c\u306a\u304b\u3063\u305f\u3082\u306e\u306f\u30ed\u30b0\u306b\u5410\u3044\u3066\u3044\u307e\u3059\u3002\n\n\u3053\u3061\u3089\u3082\u3001\u4e0a\u8a18\u6d41\u308c\u3092\u30b7\u30fc\u30b1\u30f3\u30b7\u30e3\u30eb\u306b\u5b9f\u884c\u3057\u305f\u3044\u305f\u3081\u3001`async: false`\u3092\u5165\u308c\u3066\u3001\u540c\u671f\u51e6\u7406\u306b\u3057\u3066\u3044\u307e\u3059\u3002\n\n```js\nfunction getFushoAddress() {\n    $.each(fusho_array, function(name, object) {\n        var geocoding = \"http://maps.googleapis.com/maps/api/geocode/json\";\n        $.ajax({\n            url: geocoding,\n            data: {\n                address: name\n            },\n            async: false\n        }).done(function(data) {\n            if (data.results[0] === undefined) {\n                console.log(name);\n            } else {\n                fusho_array[name][\"lat\"] = data.results[0].geometry.location.lat;\n                fusho_array[name][\"lng\"] = data.results[0].geometry.location.lng;\n            }\n        });\n    });\n}\n```\n\n# Google Map\u3092\u63cf\u753b\n\nid\u304cmap-canvas\u306e\u8981\u7d20\u306bGoogle Map\u3092\u8868\u793a\u3057\u307e\u3059\u3002\nmap\u306e\u30aa\u30d7\u30b7\u30e7\u30f3(mapOptions)\u306e\u4e2d\u5fc3\u5730\u70b9\u306f\u3001\u3068\u308a\u3042\u3048\u305a\u3001\u971e\u304c\u95a2\u306e\u7def\u5ea6\u7d4c\u5ea6\u3092\u30cf\u30fc\u30c9\u30b3\u30fc\u30c7\u30a3\u30f3\u30b0\u3057\u3066\u3044\u307e\u3059\u3002\uff53\n\n```js\nfunction handleLoadGoogleMap() {\n    var mapOptions = {\n        center: new google.maps.LatLng(35.673838, 139.750899),\n        zoom: 16,\n        mapTypeId: google.maps.MapTypeId.ROADMAP,\n        mapTypeControl: false,\n        disableDefaultUI: true\n    };\n    mymap = new google.maps.Map(document.getElementById(\"map-canvas\"), mapOptions);\n}\n```\n\n# Google Map\u306e\u4e0a\u306b\u5e9c\u7701\u3054\u3068\u306b\u4e88\u7b97\u984d\u306b\u5fdc\u3058\u305f\u30b0\u30e9\u30d5\u3092D3.js\u3067\u63cf\u304f\n\n\u6b21\u306e\u30b5\u30a4\u30c8\u3092\u53c2\u8003\u306b\u3055\u305b\u3066\u3082\u3089\u3044\u307e\u3057\u305f\u3002\nhttp://shimz.me/blog/d3-js/3733\n\n`overlay`\u3092\u4f7f\u3046\u3068\u3053\u308d\u4ee5\u5916\u306f\u901a\u5e38\u306ed3.js\u3067\u3059\u3002\n\u30dd\u30a4\u30f3\u30c8\u306f\u3001\u6b21\u306e\u7def\u5ea6\u7d4c\u5ea6\u3092px\u5ea7\u6a19\u306b\u5909\u63db\u3057\u3066\u3044\u308b\u3068\u3053\u308d\u3002\n\n```js\n// \u7def\u5ea6\u7d4c\u5ea6\u3092px\u5ea7\u6a19\u306b\u5909\u63db\nvar point = this.getProjection().fromLatLngToDivPixel(new google.maps.LatLng(object.lat, object.lng));\n```\n\n```css\n<style>\n.SvgOverlay {\n    position: relative;\n}\n.SvgOverlay svg {\n    position: absolute;\n    top: 0;\n    left: 0;\n    width: 8000px;\n    height: 8000px;\n}\n</style>\n```\n\n```js\nfunction overlayITBudget() {\n    $.each(fusho_array, function(name, object) {\n        // D3js\u3067\u30b0\u30e9\u30d5\u3092\u8868\u793a\n        if (object.lat !== undefined) {\n            var overlay = new google.maps.OverlayView(); //OverLay\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306e\u4f5c\u6210\n            overlay.onAdd = function() {\n                //\u30aa\u30fc\u30d0\u30fc\u30ec\u30a4\u8a2d\u5b9a\n                var layer = d3.select(\"#map-canvas\").append(\"div\").attr(\"class\", \"SvgOverlay\");\n                var svg = layer.append(\"svg\");\n\n                // \u7def\u5ea6\u7d4c\u5ea6\u3092px\u5ea7\u6a19\u306b\u5909\u63db\n                var point = this.getProjection().fromLatLngToDivPixel(new google.maps.LatLng(object.lat, object.lng));\n                overlay.draw = function() {\n                    // \u4e88\u7b97\u3067\u68d2\u30b0\u30e9\u30d5\u3067\u8868\u793a\n                    svg.selectAll(\".node\")\n                        .data([point]).enter()\n                        .append(\"line\")\n                        .attr(\"class\", \"node\")\n                        .attr(\"x1\", function(d) {\n                            return d.x;\n                        })\n                        .attr(\"x2\", function(d) {\n                            return d.x;\n                        })\n                        .attr(\"y1\", function(d) {\n                            return d.y - object.budget / 1000000000;\n                        })\n                        .attr(\"y2\", function(d) {\n                            return d.y;\n                        })\n                        .style(\"stroke\", \"gray\")\n                        .style(\"stroke-width\", \"10px\");\n                    // \u5e9c\u7701\u540d\u3092\u30c6\u30ad\u30b9\u30c8\u3067\u8868\u793a\n                    svg.selectAll(\"text\")\n                        .data([point]).enter()\n                        .append(\"text\")\n                        .attr(\"x\", function(d) {\n                            return d.x;\n                        })\n                        .attr(\"y\", function(d) {\n                            return d.y;\n                        })\n                        .attr(\"fill\", \"blue\")\n                        .attr(\"font-size\", \"12px\")\n                        .text(name);\n                }\n                overlay.draw();\n            }\n            overlay.setMap(mymap);\n        }\n    });\n}\n```\n\n# \u5b8c\u6210\u54c1\n\n```\n<!DOCTYPE html>\n<html lang='ja'>\n\n<head>\n    <meta charset='utf-8'>\n    <title>\u5e9c\u7701map</title>\n\n    <script type='text/javascript' src='https://maps.googleapis.com/maps/api/js?sensor=false'>\n    </script>\n    <script src='js/d3.min.js'></script>\n    <script src='js/markerwithlabel_packed.js'></script>\n<style>\n#map-canvas {\n    width: 100%;\n    height: 600px;\n}\n.labels {\n    color: black;\n    background-color: white;\n    font-family: 'Lucida Grande', 'Hiragino Kaku Gothic ProN', '\u30d2\u30e9\u30ae\u30ce\u89d2\u30b4 ProN W3', Meiryo, \u30e1\u30a4\u30ea\u30aa, sans-serif;\n    font-size: 10px;\n    text-align: center;\n    border: 1px solid black;\n    white-space: nowrap;\n}\n.SvgOverlay {\n    position: relative;\n}\n.SvgOverlay svg {\n    position: absolute;\n    top: 0;\n    left: 0;\n    width: 8000px;\n    height: 8000px;\n}\n</style>\n</head>\n\n<body>\n    <h1>\u5e9c\u7701\u60c5\u5831\u30b7\u30b9\u30c6\u30e0\u4e88\u7b97</h1>\n    <div id='map-canvas'></div>\n\n    <script src='js/jquery-2.1.1.min.js'></script>\n    <script type=\"text/javascript\">\n    var mymap;\n    var fusho_array = {};\n    google.maps.event.addDomListener(window, 'load', draw);\n\n    function draw() {\n        getFushoITBudget();\n        getFushoAddress();\n        handleLoadGoogleMap();\n        overlayITBudget();\n    }\n\n    function getFushoITBudget() {\n        $.ajax({\n            url: \"http://www.itdashboard.go.jp/PublicApi/getData.json\",\n            data: {\n                dataset: \"Budget\",\n                field: \"organization,sum_budget\"\n            },\n            async: false\n        }).done(function(data) {\n            $.each(data.raw_data, function(i, item) {\n                if (fusho_array[item.organization] === undefined) {\n                    fusho_array[item.organization] = {\n                        \"budget\": item.sum_budget\n                    };\n                } else {\n                    fusho_array[item.organization].budget = Number(fusho_array[item.organization].budget) + item.sum_budget;\n                }\n            });\n        });\n    }\n\n    function getFushoAddress() {\n        $.each(fusho_array, function(name, object) {\n            var geocoding = \"http://maps.googleapis.com/maps/api/geocode/json\";\n            $.ajax({\n                url: geocoding,\n                data: {\n                    address: name\n                },\n                async: false\n            }).done(function(data) {\n                if (data.results[0] === undefined) {\n                    console.log(name);\n                } else {\n                    fusho_array[name][\"lat\"] = data.results[0].geometry.location.lat;\n                    fusho_array[name][\"lng\"] = data.results[0].geometry.location.lng;\n                }\n            });\n        });\n    }\n\n    function handleLoadGoogleMap() {\n        var mapOptions = {\n            center: new google.maps.LatLng(35.673838, 139.750899),\n            zoom: 16,\n            mapTypeId: google.maps.MapTypeId.ROADMAP,\n            mapTypeControl: false,\n            disableDefaultUI: true\n        };\n        mymap = new google.maps.Map(document.getElementById(\"map-canvas\"), mapOptions);\n    }\n\n    function overlayITBudget() {\n        $.each(fusho_array, function(name, object) {\n            // D3js\u3067\u30b0\u30e9\u30d5\u3092\u8868\u793a\n            if (object.lat !== undefined) {\n                var overlay = new google.maps.OverlayView(); //OverLay\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306e\u4f5c\u6210\n                overlay.onAdd = function() {\n                    //\u30aa\u30fc\u30d0\u30fc\u30ec\u30a4\u8a2d\u5b9a\n                    var layer = d3.select(\"#map-canvas\").append(\"div\").attr(\"class\", \"SvgOverlay\");\n                    var svg = layer.append(\"svg\");\n\n                    // \u7def\u5ea6\u7d4c\u5ea6\u3092px\u5ea7\u6a19\u306b\u5909\u63db\n                    var point = this.getProjection().fromLatLngToDivPixel(new google.maps.LatLng(object.lat, object.lng));\n                    overlay.draw = function() {\n                        // \u4e88\u7b97\u3067\u68d2\u30b0\u30e9\u30d5\u3067\u8868\u793a\n                        svg.selectAll(\".node\")\n                            .data([point]).enter()\n                            .append(\"line\")\n                            .attr(\"class\", \"node\")\n                            .attr(\"x1\", function(d) {\n                                return d.x;\n                            })\n                            .attr(\"x2\", function(d) {\n                                return d.x;\n                            })\n                            .attr(\"y1\", function(d) {\n                                return d.y - object.budget / 1000000000;\n                            })\n                            .attr(\"y2\", function(d) {\n                                return d.y;\n                            })\n                            .style(\"stroke\", \"gray\")\n                            .style(\"stroke-width\", \"10px\");\n                        // \u5e9c\u7701\u540d\u3092\u30c6\u30ad\u30b9\u30c8\u3067\u8868\u793a\n                        svg.selectAll(\"text\")\n                            .data([point]).enter()\n                            .append(\"text\")\n                            .attr(\"x\", function(d) {\n                                return d.x;\n                            })\n                            .attr(\"y\", function(d) {\n                                return d.y;\n                            })\n                            .attr(\"fill\", \"blue\")\n                            .attr(\"font-size\", \"12px\")\n                            .text(name);\n                    }\n                    overlay.draw();\n                }\n                overlay.setMap(mymap);\n            }\n        });\n    }\n    </script>\n</body>\n\n</html>\n```\n", "tags": ["d3.js", "GoogleMap"]}