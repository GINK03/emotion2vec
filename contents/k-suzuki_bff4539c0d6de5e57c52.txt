{"context": " More than 1 year has passed since last update.\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u3092\u4f5c\u6210\u3057\u3001EIP\u306e\u53d6\u5f97\u3057\u3066\u3001\u30a2\u30bf\u30c3\u30c1\u3057\u3001Route53\u3092\u767b\u9332\u3059\u308b\u307e\u3067\u3092\u884c\u3046\u3001playbook\u3092\u4f5c\u6210\u3057\u3066\u307f\u307e\u3057\u305f\u3002\n\nsample.yml\n\n# Instance\n   - name: Launch Instance\n     ec2:\n       aws_access_key: \"{{ aws_access_key }}\"\n       aws_secret_key: \"{{ aws_secret_key }}\"\n       region: \"{{ region }}\"\n       key_name: \"{{ keypair }}\"\n       instance_type: \"{{ instance_type }}\"\n       image: \"{{ ami }}\"\n       wait: \"{{ instance_running_wait }}\"\n       group: \"{{ security_group }}\"\n       count: 1\n       vpc_subnet_id: \"{{ vpc_subnet_id }}\"\n       assign_public_ip: \"{{ assign_public_ip }}\"\n       instance_tags:\n          Name: \"{{ instance_name }}\"\n          User: \"{{ user_name }}\"\n          Group: \"{{ group_name }}\"\n       volumes:\n          - volume_size: \"{{ ebs_volume_size }}\"\n            device_name: \"{{ ebs_device_name }}\"\n            delete_on_termination: true\n     register: ec2\n\n# Elastic IP\n   - name: associate new elastic IPs with each of the instances\n     ec2_eip:\n       aws_access_key: \"{{ aws_access_key }}\"\n       aws_secret_key: \"{{ aws_secret_key }}\"\n       instance_id : \"{{ item }}\"\n       region: \"{{ region }}\"\n       in_vpc: yes\n     with_items: ec2.instance_ids\n     register: eip\n\n# Route53\n   - name: Add new route53 record\n     route53:\n      aws_access_key: \"{{ aws_access_key  }}\"\n      aws_secret_key: \"{{ aws_secret_key  }}\"\n      command: create\n      zone: \"{{ r53_zone }}\"\n      record: \"{{ r53_record }}\"\n      type: \"{{ r53_type }}\"\n      ttl: \"{{ r53_ttl }}\"\n      value: \"{{ item.public_ip }}\"\n      overwrite: yes\n     with_items: eip.results\n\n\n\nec2\u306e\u89e3\u8aac\nassign_public_ip\uff1a\u30d1\u30d6\u30ea\u30c3\u30afIP\u3092\u30a2\u30b5\u30a4\u30f3\u3059\u308b\u304b\u3069\u3046\u304b\uff08yes/no\uff09\ndelete_on_termination\uff1a\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u524a\u9664\u3068\u540c\u6642\u306bEBS\u3092\u524a\u9664\u3059\u308b\u304b\u3069\u3046\u304b\uff08true/false\uff09\n\nElastic IP\nin_vpc\uff1aVPC\u5185\u304b\u3069\u3046\u304b\uff08yes/no\uff09\n\nRoute53\noverwrite\uff1a\u4e0a\u66f8\u304d\u3059\u308b\u304b\u3069\u3046\u304b\uff08yes/no)\n\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u3092\u4f5c\u6210\u3057\u3001EIP\u306e\u53d6\u5f97\u3057\u3066\u3001\u30a2\u30bf\u30c3\u30c1\u3057\u3001Route53\u3092\u767b\u9332\u3059\u308b\u307e\u3067\u3092\u884c\u3046\u3001playbook\u3092\u4f5c\u6210\u3057\u3066\u307f\u307e\u3057\u305f\u3002\n\n```yaml:sample.yml\n\n# Instance\n   - name: Launch Instance\n     ec2:\n       aws_access_key: \"{{ aws_access_key }}\"\n       aws_secret_key: \"{{ aws_secret_key }}\"\n       region: \"{{ region }}\"\n       key_name: \"{{ keypair }}\"\n       instance_type: \"{{ instance_type }}\"\n       image: \"{{ ami }}\"\n       wait: \"{{ instance_running_wait }}\"\n       group: \"{{ security_group }}\"\n       count: 1\n       vpc_subnet_id: \"{{ vpc_subnet_id }}\"\n       assign_public_ip: \"{{ assign_public_ip }}\"\n       instance_tags:\n          Name: \"{{ instance_name }}\"\n          User: \"{{ user_name }}\"\n          Group: \"{{ group_name }}\"\n       volumes:\n          - volume_size: \"{{ ebs_volume_size }}\"\n            device_name: \"{{ ebs_device_name }}\"\n            delete_on_termination: true\n     register: ec2\n\n# Elastic IP\n   - name: associate new elastic IPs with each of the instances\n     ec2_eip:\n       aws_access_key: \"{{ aws_access_key }}\"\n       aws_secret_key: \"{{ aws_secret_key }}\"\n       instance_id : \"{{ item }}\"\n       region: \"{{ region }}\"\n       in_vpc: yes\n     with_items: ec2.instance_ids\n     register: eip\n\n# Route53\n   - name: Add new route53 record\n     route53:\n      aws_access_key: \"{{ aws_access_key  }}\"\n      aws_secret_key: \"{{ aws_secret_key  }}\"\n      command: create\n      zone: \"{{ r53_zone }}\"\n      record: \"{{ r53_record }}\"\n      type: \"{{ r53_type }}\"\n      ttl: \"{{ r53_ttl }}\"\n      value: \"{{ item.public_ip }}\"\n      overwrite: yes\n     with_items: eip.results\n```\n\n# ec2\u306e\u89e3\u8aac\nassign_public_ip\uff1a\u30d1\u30d6\u30ea\u30c3\u30afIP\u3092\u30a2\u30b5\u30a4\u30f3\u3059\u308b\u304b\u3069\u3046\u304b\uff08yes/no\uff09\ndelete_on_termination\uff1a\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u524a\u9664\u3068\u540c\u6642\u306bEBS\u3092\u524a\u9664\u3059\u308b\u304b\u3069\u3046\u304b\uff08true/false\uff09\n\n# Elastic IP\nin_vpc\uff1aVPC\u5185\u304b\u3069\u3046\u304b\uff08yes/no\uff09\n\n# Route53\noverwrite\uff1a\u4e0a\u66f8\u304d\u3059\u308b\u304b\u3069\u3046\u304b\uff08yes/no)\n\n\n", "tags": ["Ansible", "ansible-playbook"]}