{"context": " More than 1 year has passed since last update.\n\n\u306f\u3058\u3081\u306b\n2007\u5e74\u306bMac\u306bPaSoRi\u3092\u63a5\u7d9a\u3057\u3066Suica\u3084PASMO\u306e\u5c65\u6b74\u60c5\u5831\u3092\u8aad\u307f\u51fa\u3059\u30d7\u30ed\u30b0\u30e9\u30e0\u3092\u66f8\u3044\u3066\u516c\u958b\u3057\u307e\u3057\u305f\u304c\u3001\u305d\u306e\u5f8c\u307b\u3063\u305f\u3089\u304b\u3057\u3066\u3044\u307e\u3057\u305f\u3002\nSony \u3055\u3093\u304c\u975e\u63a5\u89e6IC\u30ab\u30fc\u30c9\u30ea\u30fc\u30c0\u30fc\uff0f\u30e9\u30a4\u30bf\u30fc\u3000PaSoRi\u00ae(\u30d1\u30bd\u30ea) \u300cRC-S390\u300d\u3092\u767a\u58f2\u3057\u3001iPhone/iPad \u7b49\u3067\u5229\u7528\u304c\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u3063\u3066\u3044\u3044\u306e\u3067\u3059\u304c\u3001\u6298\u89d2\u306eWi-Fi \u5bfe\u5fdc\u306e PaSoRi \u306a\u306e\u3067\u3001Mac\u3067\u3082\u5229\u7528\u3067\u304d\u308c\u3070\u3068\u601d\u3063\u3066\u5fc3\u5f85\u3061\u306b\u3057\u3066\u3044\u308b\u3082\u306e\u306e\u3001\u672a\u3060\u306bSony\u3055\u3093\u304b\u3089\u30a2\u30d7\u30ea\u306e\u63d0\u4f9b\u306f\u3042\u308a\u307e\u305b\u3093\u3002\n\u53e4\u3044\u60c5\u5831\u3067\u3059\u304c\u3001Suica\uff08\u542bPASMO\u7b49\uff09\u306e\u30c7\u30fc\u30bf\u69cb\u9020\u7b49\u3092\u958b\u767a\u8005\u306e\u7686\u3055\u3093\u306b\u516c\u958b\u3057\u3066\u3001Mac\u7248\u3092\u4f5c\u3063\u3066\u3082\u3089\u3044\u305f\u3044\u3068\u3044\u3046\u4ed6\u529b\u672c\u9858\u306e\u6295\u7a3f\u3067\u3059\u3002\n\nSuica\u306e\u30c7\u30fc\u30bf\u69cb\u9020\n\u3053\u306e\u60c5\u5831\u306f\u3001\u81ea\u5206\u306e Suica \u306e\u30c7\u30fc\u30bf\u3092\u30c0\u30f3\u30d7\u3057\u3066\u30ea\u30d0\u30fc\u30b9\u3057\u305f\u7d50\u679c\u3067\u3059\u306e\u3067\u3001\u79c1\u306e\u63a8\u6e2c\u3067\u3042\u3063\u3066\u3001\u6b63\u3057\u3044\u3068\u3044\u3046\u4fdd\u8a3c\u306f\u3042\u308a\u307e\u305b\u3093\u3002\u305f\u307e\u305f\u307e\u3046\u307e\u304f\u884c\u3063\u3066\u3044\u308b\u306e\u304b\u3082\u3057\u308c\u306a\u3044\u3068\u3044\u3046\u3053\u3068\u3067\u8cac\u4efb\u306f\u8ca0\u3048\u307e\u305b\u3093\u3002\nSuica\u306e\u30c7\u30fc\u30bf\u306f\u6b8b\u91d1\u3084\u901a\u756a\u306a\u3069\u4e00\u90e8\u306e\u30d0\u30a4\u30c8\u306e\u4e26\u3073\u304c\u9006\uff08\u30ea\u30c8\u30eb\u30a8\u30f3\u30c7\u30a3\u30a2\u30f3\uff09\u3067\u3059\u3002\n\n\n\u6700\u521d\u306e1\u30d0\u30a4\u30c8: \u30c7\u30fc\u30bf\u7a2e\u5225\n\n\n0x1B \u3060\u3068\u30af\u30ec\u30b8\u30c3\u30c8\u5165\u91d1\n0x07 or 0x08\u3060\u3068\u5165\u91d1\n0x46\u3060\u3068\u30b5\u30f3\u30af\u30b9\u30c1\u30e3\u30fc\u30b8\u306e\u5165\u91d1\n0x16\u304c\u81ea\u52d5\u6539\u672d\u4e57\u964d\n0xC7\u304c\u8cfc\u8cb7\u306e\u3088\u3046\u3067\u3059\n\n\n\n\n5\u30d0\u30a4\u30c8\u76ee\u304b\u3089\uff12\u30d0\u30a4\u30c8:\u65e5\u4ed8\n\n\n\u5148\u982d\u304b\u30897\u30d3\u30c3\u30c8\u304c\u5e74\n\uff14\u30d3\u30c3\u30c8\u304c\u6708\n\u6b8b\u308a\uff15\u30d3\u30c3\u30c8\u304c\u65e5\u306e\u3088\u3046\u3067\u3059\u3002\n\u3000\uff08\u3053\u3053\u304c\u9762\u5012\u3067\u3057\u305f\u3002\u30d1\u30ba\u30eb\u3092\u89e3\u304f\u307f\u305f\u3044\u3067\u697d\u3057\u304b\u3063\u305f\u3051\u3069\u3002\uff09\n\n\n\n7\u30d0\u30a4\u30c8\u76ee\u304b\u3089\u306e\uff12\u30d0\u30a4\u30c8\uff1a\u5165\u3063\u305f\u99c5\uff08\u30b3\u30fc\u30c9\uff09\n\n\u7d9a\u304f\uff12\u30d0\u30a4\u30c8\uff1a\u51fa\u305f\u99c5\uff08\u30b3\u30fc\u30c9\uff09\n\n\u99c5\u306e\u30b3\u30fc\u30c9\u306f\u3001\u8def\u7dda\u30b3\u30fc\u30c9\uff0f\u99c5\u30b3\u30fc\u30c9\u306e\u7d44\u5408\u308f\u305b\u3067\u3001\u6709\u5fd7\u306b\u3088\u308b\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u304c\u516c\u958b\u3055\u308c\u3066\u3044\u307e\u3059\u3002IC SFCard Fan DB Srevice\u3000\u3053\u306e\u30bd\u30d5\u30c8\u3067\u306f\u30b3\u30fc\u30c9\u304b\u3089\u306e\u5909\u63db\u306f\u3057\u3066\u3044\u307e\u305b\u3093\u3002\n\n\n1\uff12\u30d0\u30a4\u30c8\u76ee\u304b\u3089\uff12\u30d0\u30a4\u30c8\uff1a\u6b8b\u91d1\uff08\u30ea\u30c8\u30eb\u30a8\u30f3\u30c7\u30a3\u30a2\u30f3\uff09\n\n\nMac\u3067Suica\u3092\u8aad\u3080\u30d7\u30ed\u30b0\u30e9\u30e0\n2007\u5e74\u306b\u516c\u958b\u3057\u305f\u30d7\u30ed\u30b0\u30e9\u30e0\u3067\u3059\u3002\n\u6b86\u3069\u306e\u6a5f\u80fd\u306f\u30cd\u30c3\u30c8\u4e0a\u306b\u516c\u958b\u3055\u308c\u3066\u3044\u308blibpasoril]\u306b\u4f9d\u5b58\u3057\u3066\u3044\u307e\u3059\u304c\u73fe\u6642\u70b9\u3067\u306f\u516c\u958b\u3055\u308c\u3066\u3044\u307e\u305b\u3093\u3002\uff08\u6b8b\u5ff5\u3067\u3059\uff09\n\u66f4\u306blibpasori\u306flibusb\u3092\u5229\u7528\u3057\u3066\u3044\u307e\u3059\u3002\uff08Wi-Fi\u5229\u7528\u306a\u3089\u5225\u306e\u30e9\u30a4\u30d6\u30e9\u30ea\u30fc\u304c\u5fc5\u8981\u3067\u3057\u3087\u3046\uff09\n\u30bd\u30fc\u30b9\u306f\u3053\u3053\u306b\u518d\u63b2\u3057\u307e\u3059\u304c\u3001\u8a73\u7d30\u306f Mac\u3067 Suica \u3084 PASMO \u306e\u5c65\u6b74\u3092\u8aad\u3080\n\u3092\u5fa1\u89a7\u304f\u3060\u3055\u3044\u3002\n\nSuicaValue.c\n#include <stdio.h>\n#include <stdlib.h>\n#include \"libpasori.h\"\n\nint\nmain(void){\n    pasori* p;\n    felica* f;\n    int i;\n    int m;\n    int wk, wk2;\n    uint8 b[16];\n\n    p = pasori_open(NULL);\n    if(!p){\n        printf(\"error\\n\");\n        exit(-1);\n    }\n    pasori_init(p);\n    f = felica_polling(p,0x0003,0,0);\n    printf(\"*** Suica Value ***\\n\");\n    i=0;\n        while(!felica_read_without_encryption02(f,0x090f,0,i,b)){\n            printf(\"[%02d] : \",i);\n            printf(\"%02X \",b[0]);\n            printf(\"%02X \",b[1]);\n            printf(\"%02X\",b[2]);\n            printf(\"%02X \",b[3]);\n            wk=b[4]>>1;\n            wk=wk&0x7F;\n            printf(\"%02d/\",wk);\n            wk=b[4]&0x01;\n            wk=wk<<3;\n            wk2=b[5]>>5;\n            wk2=wk2&0x07;\n            wk=wk+wk2;\n            printf(\"%02d/\",wk);\n            wk=b[5]&0x1F;\n            printf(\"%02d \",wk);\n            printf(\"%02X-%02X -> \",b[6],b[7]);\n            printf(\"%02X-%02X      \",b[8],b[9]);\n            printf(\"  % 6d Yen        \",b[11]*256+b[10]);\n            printf(\"%02X%02X%02X%02X\\n\",b[12],b[13],b[14],b[15]);\n        i++;\n    }\n    pasori_close(p);\n    return 0;\n}\n\n\n\u66f4\u306b\u3001\u3053\u308c\u3092\u5229\u7528\u3057\u3066\u898b\u3084\u3059\u304f\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u3059\u308bAppleScript\u306e\u30bd\u30fc\u30b9\u3082\u518d\u63b2\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n\nSuicaValue.scpt\n-- \u300cSuicaValue.scpt\u300d\n-- PaSoRi\u3067Suica\u306e\u5c65\u6b74\u3092\u62bd\u51fa\u3057\u3066\u8868\u793a\u3059\u308b\u30b9\u30af\u30ea\u30d7\u30c8\u3067\u3059\u3002\n-- Suica\u3092\u8aad\u3080\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u300cSuicaValue\u300d\u306f\u30db\u30fc\u30e0\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u76f4\u4e0b\u306b\u7f6e\u3044\u3066\u5b9f\u884c\u6a29\u3092\u4e0e\u3048\u3066\u304a\u3044\u3066\u4e0b\u3055\u3044\u3002\n-- \u6700\u521d\u306b\u99c5\u540d\u306e\u691c\u7d22\uff0f\u8868\u793a\u3092\u3059\u308b\u304b\u3092\u554f\u3044\u5408\u308f\u305b\u307e\u3059\u3002\u99c5\u540d\u306e\u691c\u7d22\uff0f\u8868\u793a\u3067\u306f\u30a4\u30f3\u30bf\u30fc\u30cd\u30c3\u30c8\u306b\u63a5\u7d9a\u3057\u3066\u691c\u7d22\u3057\u307e\u3059\u306e\u3067\u3001\n-- \u30cd\u30c3\u30c8\u306b\u63a5\u7d9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u304c\u5fc5\u8981\u3067\u3059\u3002\uff08\u5546\u54c1\u306e\u8cfc\u5165\u3067\u306f\u8868\u793a\u3055\u308c\u307e\u305b\u3093\uff09\n-- \u7d50\u679c\u3092\u8868\u793a\u5f8c\u306b\uff2f\uff2b\u30dc\u30bf\u30f3\u3092\u62bc\u3059\u3068\u3001\u8868\u793a\u7d50\u679c\u306e\u30c6\u30ad\u30b9\u30c8\u3092\u30af\u30ea\u30c3\u30d7\u30dc\u30fc\u30c9\u306b\u30b3\u30d4\u30fc\u3057\u3066\u7d42\u4e86\u3057\u307e\u3059\u3002\n-- \u3053\u306e\u30b9\u30af\u30ea\u30d7\u30c8\u3067\u306f\u3001IC SFCardFan\u306e\u30da\u30fc\u30b8\uff08http://www.denno.net/SFCardFan/\uff09\u306b\u3042\u308bSOAP\u306e\u30b5\u30fc\u30d3\u30b9\u3092\n-- \u5229\u7528\u3057\u3066\u99c5\u540d\u3068\u5e97\u540d\u3092\u691c\u7d22\u3057\u3066\u3044\u307e\u3059\u3002\uff08\u30b5\u30fc\u30d3\u30b9\u306e\u63d0\u4f9b\u306b\u611f\u8b1d\u3057\u307e\u3059\uff09\n\nproperty SOAP_Endpoint_URL : \"http://www.denno.net/SFCardFan/soapserver.php\"\nproperty SOAP_app : \"soap\"\nproperty method_name_ST : \"getStationName\"\nproperty method_name_SH : \"getShopName\"\nproperty method_namespace_URI : \"\"\nproperty SOAP_action : \"\"\n\ndisplay dialog \"\u3000\u99c5\u540d\uff0f\u5e97\u540d\u691c\u7d22\u3092\u3057\u307e\u3059\u304b\uff1f\" & return & \"\uff08\u30a4\u30f3\u30bf\u30fc\u30cd\u30c3\u30c8\u306b\u63a5\u7d9a\u3057\u307e\u3059\uff09\" buttons {\"Yes\", \"No\"} default button 2\nset SerchOn to button returned of result\n\n-- SuicaValue \u306e\u3042\u308b\u5834\u6240\u3092\u6307\u5b9a\nset cmdPath to \"$HOME/SuicaValue\"\ndo shell script cmdPath\nset SuicaValue to result as text\n\nset dataCount to the number of paragraphs of SuicaValue\nset sortedData to \"\"\nrepeat with i from 0 to dataCount - 2\n    set eachData to paragraph (dataCount - i) of SuicaValue\n    set Proc to word 2 of eachData\n    if Proc = \"00\" then\n    else\n        set lineData to characters 19 thru 26 of eachData & \" \"\n        set zankin to (characters 43 thru 55 of eachData) as text\n        if Proc = \"1B\" or Proc = \"07\" or Proc = \"08\" or Proc = \"46\" then\n            set lineData to (lineData & \" \u5165\u91d1\u5f8c \" & word 1 of zankin as string) & \"\u5186\"\n            set lineData to lineData & \" \u5834\u6240\uff1a\" & (characters 28 thru 32 of eachData)\n        else if Proc = \"C7\" or Proc = \"C8\" then\n            set lineData to (lineData & \" \u8cfc\u5165\u5f8c \" & word 1 of zankin as string) & \"\u5186\"\n            set lineData to lineData & \" \u5e97\u8217\uff1a\" & (characters 28 thru 32 of eachData)\n            set lineData to lineData & \"\u30fc\" & (characters 37 thru 41 of eachData)\n            if SerchOn = \"Yes\" then\n                set shop to my shopname(Proc as string, (characters 37 thru 41 of eachData) as string)\n                set lineData to lineData & \"\u3000\" & shop\n            end if\n        else\n            set lineData to lineData & \" \u4e57\u8eca\u5f8c \" & word 1 of zankin & \"\u5186\"\n            set lineData to lineData & \" \u533a\u9593\uff1a\" & (characters 28 thru 32 of eachData)\n            set lineData to lineData & \"\uff5e\" & (characters 37 thru 41 of eachData)\n            -- \u99c5\u540d\u306e\u691c\u7d22\n            if SerchOn = \"Yes\" then\n                set fromStation to my stationname((characters 28 thru 32 of eachData) as string)\n                set toStation to my stationname((characters 37 thru 41 of eachData) as string)\n                set lineData to lineData & \"\u3000\" & fromStation & \" --> \" & toStation\n            end if\n        end if\n        set sortedData to sortedData & lineData & (ASCII character 13)\n    end if\nend repeat\ndisplay dialog sortedData\nset the clipboard to sortedData as string\n\n-- \u51e6\u7406\u7d42\u4e86\uff08\u7d50\u679c\u3092\u30af\u30ea\u30c3\u30d7\u30dc\u30fc\u30c9\u306b\u30b3\u30d4\u30fc\uff09\n\n-- \u99c5\u540d\u306e\u691c\u7d22\non stationname(LSCode)\n    set LC to Hex2Dec((characters 1 thru 2 of LSCode) as string)\n    set SC to Hex2Dec((characters 4 thru 5 of LSCode) as string)\n    if LC < 128 then\n        set AC to \"0\"\n    else\n        set AC to \"1\"\n    end if\n    set the method_parameters to {AreaCode:AC, LineCode:LC, StationCode:SC}\n    copy my SOAP_call_ST(SOAP_Endpoint_URL, method_name_ST, method_namespace_URI, method_parameters, SOAP_action) to {call_indicator, call_result}\n    if the call_indicator is false then\n        beep\n        display dialog \"An error occurred.\" & return & return & call_result buttons {\"Cancel\"} default button 1\n    else\n        try\n            set findName to value of item 6 of item 1 of every item of call_result\n        on error\n            set findName to \"\u99c5\u540d\u4e0d\u660e\"\n        end try\n        return findName\n    end if\nend stationname\n\n-- \u5e97\u8217\u540d\u306e\u691c\u7d22\non shopname(TermCode, LSCode)\n    set TC to Hex2Dec(TermCode)\n    set LC to Hex2Dec((characters 1 thru 2 of LSCode) as string)\n    set SC to Hex2Dec((characters 4 thru 5 of LSCode) as string)\n    set AC to \"1\"\n    set the method_parameters to {AreaCode:AC, TerminalCode:TC, LineCode:LC, StationCode:SC}\n    copy my SOAP_call_SH(SOAP_Endpoint_URL, method_name_SH, method_namespace_URI, method_parameters, SOAP_action) to {call_indicator, call_result}\n    if the call_indicator is false then\n        beep\n        display dialog \"An error occurred.\" & return & return & call_result buttons {\"Cancel\"} default button 1\n    else\n        try\n            set findName to value of item 5 of item 1 of every item of call_result\n            set findName to findName & \"\u3001\" & value of item 6 of item 1 of every item of call_result\n        on error\n            set findName to \"\u5e97\u540d\u4e0d\u660e\"\n        end try\n        return findName\n    end if\nend shopname\n\n-- SOAP \u691c\u7d22\uff08\u99c5\u540d\uff09\non SOAP_call_ST(SOAP_Endpoint_URL, method_name_ST, method_namespace_URI, method_parameters, SOAP_action)\n    try\n        using terms from application \"http://www.apple.com/\"\n            tell application SOAP_Endpoint_URL\n                set this_result to call soap {method name:method_name_ST, method namespace uri:method_namespace_URI, parameters:method_parameters, SOAPAction:SOAP_action}\n            end tell\n        end using terms from\n        return {true, this_result}\n    on error error_message number error_number\n        if the error_number is -916 then set the error_message to \"\u30a4\u30f3\u30bf\u30fc\u30cd\u30c3\u30c8\u306b\u63a5\u7d9a\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f\u3002\"\n        return {false, error_message}\n    end try\nend SOAP_call_ST\n\n-- SOAP \u691c\u7d22\uff08\u5e97\u8217\uff09\non SOAP_call_SH(SOAP_Endpoint_URL, method_name_SH, method_namespace_URI, method_parameters, SOAP_action)\n    try\n        using terms from application \"http://www.apple.com/\"\n            tell application SOAP_Endpoint_URL\n                set this_result to call soap {method name:method_name_SH, method namespace uri:method_namespace_URI, parameters:method_parameters, SOAPAction:SOAP_action}\n            end tell\n        end using terms from\n        return {true, this_result}\n    on error error_message number error_number\n        if the error_number is -916 then set the error_message to \"\u30a4\u30f3\u30bf\u30fc\u30cd\u30c3\u30c8\u306b\u63a5\u7d9a\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f\u3002\"\n        return {false, error_message}\n    end try\nend SOAP_call_SH\n\n-- 16\u9032\u309210\u9032\u306b\u5909\u63db\uff08\uff12\u6841\u306e\u307f\uff09\non Hex2Dec(HEX)\n    set ans to ((offset of (character 1 of HEX) in \"0123456789ABCDEF\") - 1) * 16\n    set ans to ans + (offset of (character 2 of HEX) in \"0123456789ABCDEF\") - 1\n    return ans\nend Hex2Dec\n\n\n## \u306f\u3058\u3081\u306b\n\n2007\u5e74\u306bMac\u306bPaSoRi\u3092\u63a5\u7d9a\u3057\u3066Suica\u3084PASMO\u306e\u5c65\u6b74\u60c5\u5831\u3092\u8aad\u307f\u51fa\u3059\u30d7\u30ed\u30b0\u30e9\u30e0\u3092\u66f8\u3044\u3066\u516c\u958b\u3057\u307e\u3057\u305f\u304c\u3001\u305d\u306e\u5f8c\u307b\u3063\u305f\u3089\u304b\u3057\u3066\u3044\u307e\u3057\u305f\u3002\nSony \u3055\u3093\u304c\u975e\u63a5\u89e6IC\u30ab\u30fc\u30c9\u30ea\u30fc\u30c0\u30fc\uff0f\u30e9\u30a4\u30bf\u30fc\u3000PaSoRi\u00ae(\u30d1\u30bd\u30ea) \u300cRC-S390\u300d\u3092\u767a\u58f2\u3057\u3001iPhone/iPad \u7b49\u3067\u5229\u7528\u304c\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u3063\u3066\u3044\u3044\u306e\u3067\u3059\u304c\u3001\u6298\u89d2\u306eWi-Fi \u5bfe\u5fdc\u306e PaSoRi \u306a\u306e\u3067\u3001Mac\u3067\u3082\u5229\u7528\u3067\u304d\u308c\u3070\u3068\u601d\u3063\u3066\u5fc3\u5f85\u3061\u306b\u3057\u3066\u3044\u308b\u3082\u306e\u306e\u3001\u672a\u3060\u306bSony\u3055\u3093\u304b\u3089\u30a2\u30d7\u30ea\u306e\u63d0\u4f9b\u306f\u3042\u308a\u307e\u305b\u3093\u3002\n\u53e4\u3044\u60c5\u5831\u3067\u3059\u304c\u3001Suica\uff08\u542bPASMO\u7b49\uff09\u306e\u30c7\u30fc\u30bf\u69cb\u9020\u7b49\u3092\u958b\u767a\u8005\u306e\u7686\u3055\u3093\u306b\u516c\u958b\u3057\u3066\u3001Mac\u7248\u3092\u4f5c\u3063\u3066\u3082\u3089\u3044\u305f\u3044\u3068\u3044\u3046\u4ed6\u529b\u672c\u9858\u306e\u6295\u7a3f\u3067\u3059\u3002\n\n## Suica\u306e\u30c7\u30fc\u30bf\u69cb\u9020\n\u3053\u306e\u60c5\u5831\u306f\u3001\u81ea\u5206\u306e Suica \u306e\u30c7\u30fc\u30bf\u3092\u30c0\u30f3\u30d7\u3057\u3066\u30ea\u30d0\u30fc\u30b9\u3057\u305f\u7d50\u679c\u3067\u3059\u306e\u3067\u3001**\u79c1\u306e\u63a8\u6e2c\u3067\u3042\u3063\u3066\u3001\u6b63\u3057\u3044\u3068\u3044\u3046\u4fdd\u8a3c\u306f\u3042\u308a\u307e\u305b\u3093\u3002**\u305f\u307e\u305f\u307e\u3046\u307e\u304f\u884c\u3063\u3066\u3044\u308b\u306e\u304b\u3082\u3057\u308c\u306a\u3044\u3068\u3044\u3046\u3053\u3068\u3067\u8cac\u4efb\u306f\u8ca0\u3048\u307e\u305b\u3093\u3002\n\nSuica\u306e\u30c7\u30fc\u30bf\u306f\u6b8b\u91d1\u3084\u901a\u756a\u306a\u3069\u4e00\u90e8\u306e\u30d0\u30a4\u30c8\u306e\u4e26\u3073\u304c\u9006\uff08\u30ea\u30c8\u30eb\u30a8\u30f3\u30c7\u30a3\u30a2\u30f3\uff09\u3067\u3059\u3002\n\n1. \u6700\u521d\u306e1\u30d0\u30a4\u30c8: \u30c7\u30fc\u30bf\u7a2e\u5225\n> * 0x1B \u3060\u3068\u30af\u30ec\u30b8\u30c3\u30c8\u5165\u91d1\n> * 0x07 or 0x08\u3060\u3068\u5165\u91d1\n> * 0x46\u3060\u3068\u30b5\u30f3\u30af\u30b9\u30c1\u30e3\u30fc\u30b8\u306e\u5165\u91d1\n> * 0x16\u304c\u81ea\u52d5\u6539\u672d\u4e57\u964d\n> * 0xC7\u304c\u8cfc\u8cb7\u306e\u3088\u3046\u3067\u3059\n\n1. 5\u30d0\u30a4\u30c8\u76ee\u304b\u3089\uff12\u30d0\u30a4\u30c8:\u65e5\u4ed8\n> * \u5148\u982d\u304b\u30897\u30d3\u30c3\u30c8\u304c\u5e74\n> * \uff14\u30d3\u30c3\u30c8\u304c\u6708\n> * \u6b8b\u308a\uff15\u30d3\u30c3\u30c8\u304c\u65e5\u306e\u3088\u3046\u3067\u3059\u3002\n\u3000\uff08\u3053\u3053\u304c\u9762\u5012\u3067\u3057\u305f\u3002\u30d1\u30ba\u30eb\u3092\u89e3\u304f\u307f\u305f\u3044\u3067\u697d\u3057\u304b\u3063\u305f\u3051\u3069\u3002\uff09\n\n1. 7\u30d0\u30a4\u30c8\u76ee\u304b\u3089\u306e\uff12\u30d0\u30a4\u30c8\uff1a\u5165\u3063\u305f\u99c5\uff08\u30b3\u30fc\u30c9\uff09\n1. \u7d9a\u304f\uff12\u30d0\u30a4\u30c8\uff1a\u51fa\u305f\u99c5\uff08\u30b3\u30fc\u30c9\uff09\n> \u99c5\u306e\u30b3\u30fc\u30c9\u306f\u3001\u8def\u7dda\u30b3\u30fc\u30c9\uff0f\u99c5\u30b3\u30fc\u30c9\u306e\u7d44\u5408\u308f\u305b\u3067\u3001\u6709\u5fd7\u306b\u3088\u308b\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u304c\u516c\u958b\u3055\u308c\u3066\u3044\u307e\u3059\u3002[IC SFCard Fan DB Srevice](http://www.denno.net/SFCardFan/webservice.html)\u3000\u3053\u306e\u30bd\u30d5\u30c8\u3067\u306f\u30b3\u30fc\u30c9\u304b\u3089\u306e\u5909\u63db\u306f\u3057\u3066\u3044\u307e\u305b\u3093\u3002\n\n1. 1\uff12\u30d0\u30a4\u30c8\u76ee\u304b\u3089\uff12\u30d0\u30a4\u30c8\uff1a\u6b8b\u91d1\uff08\u30ea\u30c8\u30eb\u30a8\u30f3\u30c7\u30a3\u30a2\u30f3\uff09\n\n## Mac\u3067Suica\u3092\u8aad\u3080\u30d7\u30ed\u30b0\u30e9\u30e0\n2007\u5e74\u306b\u516c\u958b\u3057\u305f\u30d7\u30ed\u30b0\u30e9\u30e0\u3067\u3059\u3002\n\u6b86\u3069\u306e\u6a5f\u80fd\u306f\u30cd\u30c3\u30c8\u4e0a\u306b\u516c\u958b\u3055\u308c\u3066\u3044\u308blibpasoril]\u306b\u4f9d\u5b58\u3057\u3066\u3044\u307e\u3059\u304c\u73fe\u6642\u70b9\u3067\u306f\u516c\u958b\u3055\u308c\u3066\u3044\u307e\u305b\u3093\u3002\uff08\u6b8b\u5ff5\u3067\u3059\uff09\n\u66f4\u306blibpasori\u306f[libusb](http://libusb.info/)\u3092\u5229\u7528\u3057\u3066\u3044\u307e\u3059\u3002\uff08Wi-Fi\u5229\u7528\u306a\u3089\u5225\u306e\u30e9\u30a4\u30d6\u30e9\u30ea\u30fc\u304c\u5fc5\u8981\u3067\u3057\u3087\u3046\uff09\n\n\u30bd\u30fc\u30b9\u306f\u3053\u3053\u306b\u518d\u63b2\u3057\u307e\u3059\u304c\u3001\u8a73\u7d30\u306f [Mac\u3067 Suica \u3084 PASMO \u306e\u5c65\u6b74\u3092\u8aad\u3080](http://www.imfj.net/people/nomura/soft/PaSoRi/SuicaValue.html)\n\u3092\u5fa1\u89a7\u304f\u3060\u3055\u3044\u3002\n\n```c:SuicaValue.c\n#include <stdio.h>\n#include <stdlib.h>\n#include \"libpasori.h\"\n\nint\nmain(void){\n\tpasori* p;\n\tfelica* f;\n\tint i;\n\tint m;\n\tint wk, wk2;\n\tuint8 b[16];\n\t\n\tp = pasori_open(NULL);\n\tif(!p){\n\t\tprintf(\"error\\n\");\n\t\texit(-1);\n\t}\n\tpasori_init(p);\n\tf = felica_polling(p,0x0003,0,0);\n\tprintf(\"*** Suica Value ***\\n\");\n\ti=0;\n\t\twhile(!felica_read_without_encryption02(f,0x090f,0,i,b)){\n\t\t\tprintf(\"[%02d] : \",i);\n\t\t\tprintf(\"%02X \",b[0]);\n\t\t\tprintf(\"%02X \",b[1]);\n\t\t\tprintf(\"%02X\",b[2]);\n\t\t\tprintf(\"%02X \",b[3]);\n\t\t\twk=b[4]>>1;\n\t\t\twk=wk&0x7F;\n\t\t\tprintf(\"%02d/\",wk);\n\t\t\twk=b[4]&0x01;\n\t\t\twk=wk<<3;\n\t\t\twk2=b[5]>>5;\n\t\t\twk2=wk2&0x07;\n\t\t\twk=wk+wk2;\n\t\t\tprintf(\"%02d/\",wk);\n\t\t\twk=b[5]&0x1F;\n\t\t\tprintf(\"%02d \",wk);\n\t\t\tprintf(\"%02X-%02X -> \",b[6],b[7]);\n\t\t\tprintf(\"%02X-%02X      \",b[8],b[9]);\n\t\t\tprintf(\"  % 6d Yen        \",b[11]*256+b[10]);\n\t\t\tprintf(\"%02X%02X%02X%02X\\n\",b[12],b[13],b[14],b[15]);\n\t\ti++;\n\t}\n\tpasori_close(p);\n\treturn 0;\n}\n```\n\n\u66f4\u306b\u3001\u3053\u308c\u3092\u5229\u7528\u3057\u3066\u898b\u3084\u3059\u304f\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u3059\u308bAppleScript\u306e\u30bd\u30fc\u30b9\u3082\u518d\u63b2\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n\n``` AppleScript:SuicaValue.scpt\n-- \u300cSuicaValue.scpt\u300d\n-- PaSoRi\u3067Suica\u306e\u5c65\u6b74\u3092\u62bd\u51fa\u3057\u3066\u8868\u793a\u3059\u308b\u30b9\u30af\u30ea\u30d7\u30c8\u3067\u3059\u3002\n-- Suica\u3092\u8aad\u3080\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u300cSuicaValue\u300d\u306f\u30db\u30fc\u30e0\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u76f4\u4e0b\u306b\u7f6e\u3044\u3066\u5b9f\u884c\u6a29\u3092\u4e0e\u3048\u3066\u304a\u3044\u3066\u4e0b\u3055\u3044\u3002\n-- \u6700\u521d\u306b\u99c5\u540d\u306e\u691c\u7d22\uff0f\u8868\u793a\u3092\u3059\u308b\u304b\u3092\u554f\u3044\u5408\u308f\u305b\u307e\u3059\u3002\u99c5\u540d\u306e\u691c\u7d22\uff0f\u8868\u793a\u3067\u306f\u30a4\u30f3\u30bf\u30fc\u30cd\u30c3\u30c8\u306b\u63a5\u7d9a\u3057\u3066\u691c\u7d22\u3057\u307e\u3059\u306e\u3067\u3001\n-- \u30cd\u30c3\u30c8\u306b\u63a5\u7d9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u304c\u5fc5\u8981\u3067\u3059\u3002\uff08\u5546\u54c1\u306e\u8cfc\u5165\u3067\u306f\u8868\u793a\u3055\u308c\u307e\u305b\u3093\uff09\n-- \u7d50\u679c\u3092\u8868\u793a\u5f8c\u306b\uff2f\uff2b\u30dc\u30bf\u30f3\u3092\u62bc\u3059\u3068\u3001\u8868\u793a\u7d50\u679c\u306e\u30c6\u30ad\u30b9\u30c8\u3092\u30af\u30ea\u30c3\u30d7\u30dc\u30fc\u30c9\u306b\u30b3\u30d4\u30fc\u3057\u3066\u7d42\u4e86\u3057\u307e\u3059\u3002\n-- \u3053\u306e\u30b9\u30af\u30ea\u30d7\u30c8\u3067\u306f\u3001IC SFCardFan\u306e\u30da\u30fc\u30b8\uff08http://www.denno.net/SFCardFan/\uff09\u306b\u3042\u308bSOAP\u306e\u30b5\u30fc\u30d3\u30b9\u3092\n-- \u5229\u7528\u3057\u3066\u99c5\u540d\u3068\u5e97\u540d\u3092\u691c\u7d22\u3057\u3066\u3044\u307e\u3059\u3002\uff08\u30b5\u30fc\u30d3\u30b9\u306e\u63d0\u4f9b\u306b\u611f\u8b1d\u3057\u307e\u3059\uff09\n\nproperty SOAP_Endpoint_URL : \"http://www.denno.net/SFCardFan/soapserver.php\"\nproperty SOAP_app : \"soap\"\nproperty method_name_ST : \"getStationName\"\nproperty method_name_SH : \"getShopName\"\nproperty method_namespace_URI : \"\"\nproperty SOAP_action : \"\"\n\ndisplay dialog \"\u3000\u99c5\u540d\uff0f\u5e97\u540d\u691c\u7d22\u3092\u3057\u307e\u3059\u304b\uff1f\" & return & \"\uff08\u30a4\u30f3\u30bf\u30fc\u30cd\u30c3\u30c8\u306b\u63a5\u7d9a\u3057\u307e\u3059\uff09\" buttons {\"Yes\", \"No\"} default button 2\nset SerchOn to button returned of result\n\n-- SuicaValue \u306e\u3042\u308b\u5834\u6240\u3092\u6307\u5b9a\nset cmdPath to \"$HOME/SuicaValue\"\ndo shell script cmdPath\nset SuicaValue to result as text\n\nset dataCount to the number of paragraphs of SuicaValue\nset sortedData to \"\"\nrepeat with i from 0 to dataCount - 2\n\tset eachData to paragraph (dataCount - i) of SuicaValue\n\tset Proc to word 2 of eachData\n\tif Proc = \"00\" then\n\telse\n\t\tset lineData to characters 19 thru 26 of eachData & \" \"\n\t\tset zankin to (characters 43 thru 55 of eachData) as text\n\t\tif Proc = \"1B\" or Proc = \"07\" or Proc = \"08\" or Proc = \"46\" then\n\t\t\tset lineData to (lineData & \" \u5165\u91d1\u5f8c \" & word 1 of zankin as string) & \"\u5186\"\n\t\t\tset lineData to lineData & \" \u5834\u6240\uff1a\" & (characters 28 thru 32 of eachData)\n\t\telse if Proc = \"C7\" or Proc = \"C8\" then\n\t\t\tset lineData to (lineData & \" \u8cfc\u5165\u5f8c \" & word 1 of zankin as string) & \"\u5186\"\n\t\t\tset lineData to lineData & \" \u5e97\u8217\uff1a\" & (characters 28 thru 32 of eachData)\n\t\t\tset lineData to lineData & \"\u30fc\" & (characters 37 thru 41 of eachData)\n\t\t\tif SerchOn = \"Yes\" then\n\t\t\t\tset shop to my shopname(Proc as string, (characters 37 thru 41 of eachData) as string)\n\t\t\t\tset lineData to lineData & \"\u3000\" & shop\n\t\t\tend if\n\t\telse\n\t\t\tset lineData to lineData & \" \u4e57\u8eca\u5f8c \" & word 1 of zankin & \"\u5186\"\n\t\t\tset lineData to lineData & \" \u533a\u9593\uff1a\" & (characters 28 thru 32 of eachData)\n\t\t\tset lineData to lineData & \"\uff5e\" & (characters 37 thru 41 of eachData)\n\t\t\t-- \u99c5\u540d\u306e\u691c\u7d22\n\t\t\tif SerchOn = \"Yes\" then\n\t\t\t\tset fromStation to my stationname((characters 28 thru 32 of eachData) as string)\n\t\t\t\tset toStation to my stationname((characters 37 thru 41 of eachData) as string)\n\t\t\t\tset lineData to lineData & \"\u3000\" & fromStation & \" --> \" & toStation\n\t\t\tend if\n\t\tend if\n\t\tset sortedData to sortedData & lineData & (ASCII character 13)\n\tend if\nend repeat\ndisplay dialog sortedData\nset the clipboard to sortedData as string\n\n-- \u51e6\u7406\u7d42\u4e86\uff08\u7d50\u679c\u3092\u30af\u30ea\u30c3\u30d7\u30dc\u30fc\u30c9\u306b\u30b3\u30d4\u30fc\uff09\n\n-- \u99c5\u540d\u306e\u691c\u7d22\non stationname(LSCode)\n\tset LC to Hex2Dec((characters 1 thru 2 of LSCode) as string)\n\tset SC to Hex2Dec((characters 4 thru 5 of LSCode) as string)\n\tif LC < 128 then\n\t\tset AC to \"0\"\n\telse\n\t\tset AC to \"1\"\n\tend if\n\tset the method_parameters to {AreaCode:AC, LineCode:LC, StationCode:SC}\n\tcopy my SOAP_call_ST(SOAP_Endpoint_URL, method_name_ST, method_namespace_URI, method_parameters, SOAP_action) to {call_indicator, call_result}\n\tif the call_indicator is false then\n\t\tbeep\n\t\tdisplay dialog \"An error occurred.\" & return & return & call_result buttons {\"Cancel\"} default button 1\n\telse\n\t\ttry\n\t\t\tset findName to value of item 6 of item 1 of every item of call_result\n\t\ton error\n\t\t\tset findName to \"\u99c5\u540d\u4e0d\u660e\"\n\t\tend try\n\t\treturn findName\n\tend if\nend stationname\n\n-- \u5e97\u8217\u540d\u306e\u691c\u7d22\non shopname(TermCode, LSCode)\n\tset TC to Hex2Dec(TermCode)\n\tset LC to Hex2Dec((characters 1 thru 2 of LSCode) as string)\n\tset SC to Hex2Dec((characters 4 thru 5 of LSCode) as string)\n\tset AC to \"1\"\n\tset the method_parameters to {AreaCode:AC, TerminalCode:TC, LineCode:LC, StationCode:SC}\n\tcopy my SOAP_call_SH(SOAP_Endpoint_URL, method_name_SH, method_namespace_URI, method_parameters, SOAP_action) to {call_indicator, call_result}\n\tif the call_indicator is false then\n\t\tbeep\n\t\tdisplay dialog \"An error occurred.\" & return & return & call_result buttons {\"Cancel\"} default button 1\n\telse\n\t\ttry\n\t\t\tset findName to value of item 5 of item 1 of every item of call_result\n\t\t\tset findName to findName & \"\u3001\" & value of item 6 of item 1 of every item of call_result\n\t\ton error\n\t\t\tset findName to \"\u5e97\u540d\u4e0d\u660e\"\n\t\tend try\n\t\treturn findName\n\tend if\nend shopname\n\n-- SOAP \u691c\u7d22\uff08\u99c5\u540d\uff09\non SOAP_call_ST(SOAP_Endpoint_URL, method_name_ST, method_namespace_URI, method_parameters, SOAP_action)\n\ttry\n\t\tusing terms from application \"http://www.apple.com/\"\n\t\t\ttell application SOAP_Endpoint_URL\n\t\t\t\tset this_result to call soap {method name:method_name_ST, method namespace uri:method_namespace_URI, parameters:method_parameters, SOAPAction:SOAP_action}\n\t\t\tend tell\n\t\tend using terms from\n\t\treturn {true, this_result}\n\ton error error_message number error_number\n\t\tif the error_number is -916 then set the error_message to \"\u30a4\u30f3\u30bf\u30fc\u30cd\u30c3\u30c8\u306b\u63a5\u7d9a\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f\u3002\"\n\t\treturn {false, error_message}\n\tend try\nend SOAP_call_ST\n\n-- SOAP \u691c\u7d22\uff08\u5e97\u8217\uff09\non SOAP_call_SH(SOAP_Endpoint_URL, method_name_SH, method_namespace_URI, method_parameters, SOAP_action)\n\ttry\n\t\tusing terms from application \"http://www.apple.com/\"\n\t\t\ttell application SOAP_Endpoint_URL\n\t\t\t\tset this_result to call soap {method name:method_name_SH, method namespace uri:method_namespace_URI, parameters:method_parameters, SOAPAction:SOAP_action}\n\t\t\tend tell\n\t\tend using terms from\n\t\treturn {true, this_result}\n\ton error error_message number error_number\n\t\tif the error_number is -916 then set the error_message to \"\u30a4\u30f3\u30bf\u30fc\u30cd\u30c3\u30c8\u306b\u63a5\u7d9a\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f\u3002\"\n\t\treturn {false, error_message}\n\tend try\nend SOAP_call_SH\n\n-- 16\u9032\u309210\u9032\u306b\u5909\u63db\uff08\uff12\u6841\u306e\u307f\uff09\non Hex2Dec(HEX)\n\tset ans to ((offset of (character 1 of HEX) in \"0123456789ABCDEF\") - 1) * 16\n\tset ans to ans + (offset of (character 2 of HEX) in \"0123456789ABCDEF\") - 1\n\treturn ans\nend Hex2Dec\n```\n", "tags": ["Mac", "C", "OSX", "AppleScript"]}