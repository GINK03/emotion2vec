{"context": "Docker\u516c\u5f0f\u306eUbuntu\u3067\u306eDocker\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u624b\u9806 \u3092\nAnsible\u3067\u81ea\u52d5\u5316\u3057\u3066\u3001Playbook\u914d\u5e03\u53ef\u80fd\u306a\u72b6\u614b\u306b\u3057\u3066\u304a\u3053\u3046\u3068\u601d\u3044\u307e\u3059\u3002\n\n\u4e8b\u524d\u6e96\u5099\n\u4e8b\u524d\u6e96\u5099\u3068\u3057\u3066\u3001Ansible\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u624b\u9806\n\napt-get update\napt-get install -y software-properties-common\napt-add-repository ppa:ansible/ansible\napt-get install -y ansible\n\n\nDocker\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\nplaybook.yml\n# hosts\u306a\u3069\u306e\u8a18\u8ff0\u306b\u3064\u3044\u3066\u306f\u7701\u7565\u3057\u307e\u3059\u3002\n- name: Check kernel version.\n  fail: msg=\"Kernel {{ ansible_kernel }} is not supported.\"\n  when: \"ansible_kernel | version_compare('3.10', '<')\"\n\n- name: apt-get install packages\n  apt: pkg={{ item }} state=present update_cache=yes\n  with_items:\n    - curl\n    - linux-image-extra-{{ ansible_kernel }}\n    - linux-image-extra-virtual\n    - apt-transport-https\n    - ca-certificates\n\n- name: Check docker gpg key.\n  shell: apt-key list | grep 2C52609D\n  register: docker_gpg\n  ignore_errors: True\n  changed_when: False\n\n- name: Add Docker\u2019s official GPG key\n  shell: curl -fsSL https://yum.dockerproject.org/gpg | sudo apt-key add -\n  when: docker_gpg | failed\n\n- name: define lsb_release -cs\n  shell: lsb_release -cs\n  ignore_errors: True\n  register: lsb_release\n\n- name: set up the stable repository\n  shell: add-apt-repository \"deb https://apt.dockerproject.org/repo/ ubuntu-{{ lsb_release.stdout }} main\"\n\n- name: Install docker-engine.\n  apt: name=docker-engine state=present update_cache=yes\n  notify:\n    - restart docker\n\n\n\u3042\u3068\u306fdocker version \u306a\u3069\u3067\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3057\u3066\u307f\u3066\u304f\u3060\u3055\u3044\u3002\n\u8aa4\u8a18\u306b\u3064\u3044\u3066\u306e\u3054\u6307\u6458\u3084\u3001\u3088\u308a\u3088\u3044\u65b9\u6cd5\u306e\u3054\u63d0\u6848\u306a\u3069\u306f\u6b53\u8fce\u3057\u307e\u3059\uff01\n\u4ee5\u4e0a\u3067\u3059\u3002\u304a\u75b2\u308c\u69d8\u3067\u3057\u305f\u30fc\u3002\n[Docker\u516c\u5f0f\u306eUbuntu\u3067\u306eDocker\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u624b\u9806](https://docs.docker.com/engine/installation/linux/ubuntu/) \u3092\nAnsible\u3067\u81ea\u52d5\u5316\u3057\u3066\u3001Playbook\u914d\u5e03\u53ef\u80fd\u306a\u72b6\u614b\u306b\u3057\u3066\u304a\u3053\u3046\u3068\u601d\u3044\u307e\u3059\u3002\n# \u4e8b\u524d\u6e96\u5099\n\u4e8b\u524d\u6e96\u5099\u3068\u3057\u3066\u3001Ansible\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u624b\u9806\n```\napt-get update\napt-get install -y software-properties-common\napt-add-repository ppa:ansible/ansible\napt-get install -y ansible\n```\n\n# Docker\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n``` playbook.yml\n# hosts\u306a\u3069\u306e\u8a18\u8ff0\u306b\u3064\u3044\u3066\u306f\u7701\u7565\u3057\u307e\u3059\u3002\n- name: Check kernel version.\n  fail: msg=\"Kernel {{ ansible_kernel }} is not supported.\"\n  when: \"ansible_kernel | version_compare('3.10', '<')\"\n\n- name: apt-get install packages\n  apt: pkg={{ item }} state=present update_cache=yes\n  with_items:\n    - curl\n    - linux-image-extra-{{ ansible_kernel }}\n    - linux-image-extra-virtual\n    - apt-transport-https\n    - ca-certificates\n\n- name: Check docker gpg key.\n  shell: apt-key list | grep 2C52609D\n  register: docker_gpg\n  ignore_errors: True\n  changed_when: False\n\n- name: Add Docker\u2019s official GPG key\n  shell: curl -fsSL https://yum.dockerproject.org/gpg | sudo apt-key add -\n  when: docker_gpg | failed\n\n- name: define lsb_release -cs\n  shell: lsb_release -cs\n  ignore_errors: True\n  register: lsb_release\n\n- name: set up the stable repository\n  shell: add-apt-repository \"deb https://apt.dockerproject.org/repo/ ubuntu-{{ lsb_release.stdout }} main\"\n\n- name: Install docker-engine.\n  apt: name=docker-engine state=present update_cache=yes\n  notify:\n    - restart docker\n```\n\u3042\u3068\u306f`docker version` \u306a\u3069\u3067\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3057\u3066\u307f\u3066\u304f\u3060\u3055\u3044\u3002  \n\u8aa4\u8a18\u306b\u3064\u3044\u3066\u306e\u3054\u6307\u6458\u3084\u3001\u3088\u308a\u3088\u3044\u65b9\u6cd5\u306e\u3054\u63d0\u6848\u306a\u3069\u306f\u6b53\u8fce\u3057\u307e\u3059\uff01\n\u4ee5\u4e0a\u3067\u3059\u3002\u304a\u75b2\u308c\u69d8\u3067\u3057\u305f\u30fc\u3002\n\n", "tags": ["ubuntu16.04", "Ansible", "docker"]}