{"tags": ["R", "\u78ba\u7387\u5fae\u5206\u65b9\u7a0b\u5f0f", "\u6570\u5b66", "\u6642\u7cfb\u5217\u89e3\u6790", "statistics"], "context": " More than 1 year has passed since last update.\n\nR Package sde\u3000\u3092\u3064\u304b\u3063\u3066\u307f\u308b\n\n\u3010\u53c2\u8003\u6587\u732e\u3011\n\nIacus, Stefano M.\uff08\u8457\uff09 \"Simulation and Inference for Stochastic Differential Equations\"\n\n\n\n\u520a\u884c\u5143 Springer\u793e \u516c\u5f0f\u30a6\u30a7\u30d6\u30b5\u30a4\u30c8\u3078\u306e\u30ea\u30f3\u30af \n\n\n\u3010\u4ee5\u4e0b\u3001 sde \u306ehelp()\u30da\u30fc\u30b8\u30de\u30cb\u30e5\u30a2\u30eb\u3092\u53c2\u8003\u306b\u4f7f\u3063\u3066\u307f\u308b\u3011\n\n\u30d1\u30c3\u30b1\u30fc\u30b8\u306e\u8aad\u8fbc\u307f\nrequire(\"sde\")\n\n\n\n\u30d6\u30e9\u30a6\u30f3\u904b\u52d5\u7cfb\u5217\u3092\u767a\u751f\u3055\u305b\u3066\u307f\u308b\n\n\u3010\u95a2\u6570\u3011 BM() \u203b Brownian motion\u95a2\u6570\n\n\n\u203b\u30d6\u30e9\u30a6\u30f3\u904b\u52d5 \u5909\u6570\u306e\u767a\u751f\u30b7\u30df\u30e5\u30ec\u30fc\u30b7\u30e7\u30f3\u95a2\u6570\n\n\u30d6\u30e9\u30a6\u30f3\u904b\u52d5\u306e\u5f15\u6570\u30d1\u30e9\u30e1\u30fc\u30bf\u7fa4\u3068\u4eca\u56de\u306e\u8a2d\u5b9a\n\n\u203b\u95a2\u6570\u3092\u5b9f\u884c\u3059\u308b\u305f\u3073\u306b\u3001\u767a\u751f\u3055\u308c\u308b\u30d6\u30e9\u30a6\u30f3\uff08\u78ba\u7387\u904e\u7a0b\uff09\u6642\u7cfb\u5217\u5024\u306f\u5909\u5316\u3059\u308b\n\n\n\u521d\u671f\u5024 xxx :    0\n\u521d\u671f\u6642\u523b t0t0t_0 : 0\n\u6700\u7d42\u6642\u523b TTT :  1\n\u5404\u6642\u7cfb\u5217\u5909\u6570\u306e\u6570 NNN : 1,000\n\n\n\u203b\uff08\u6642\u7cfb\u5217\u5909\u6570\u306e\u6570 = \u30b0\u30e9\u30d5\u6a2a\u8ef8\u306e\u523b\u307f\u5e45 )\n\n( TTT - t0t0t_0 )/ NNN \n\n\n\u5b9f\u884c\uff081\u56de\u76ee\uff09\nBMpath <- BM(x = 0, t0 = 0, T = 1, N = 1000) \n\nplot(BMpath)\n\n\n\n\u5b9f\u884c\uff082\u56de\u76ee\uff09\nBMpath <- BM(x = 0, t0 = 0, T = 1, N = 1000) \n\nplot(BMpath)\n\n\n\n\u5b9f\u884c\uff083\u56de\u76ee\uff09\nBMpath <- BM(x = 0, t0 = 0, T = 1, N = 1000) \n\nplot(BMpath)\n\n\n\n\u682a\u4fa1\u904e\u7a0b\u306e\u30c0\u30df\u30fc\u3068\u3057\u3066\u4f7f\u308f\u308c\u308b\u5e7e\u4f55\u30d6\u30e9\u30a6\u30f3\u904b\u52d5\u7cfb\u5217\u3092\u767a\u751f\u3055\u305b\u3066\u307f\u308b\n\n\u3010\u95a2\u6570\u3011 GBM() \u203b Geometric Brownian motion\u95a2\u6570\n\n\n\u203b\u5e7e\u4f55\u30d6\u30e9\u30a6\u30f3\u904b\u52d5 \u5909\u6570\u306e\u767a\u751f\u30b7\u30df\u30e5\u30ec\u30fc\u30b7\u30e7\u30f3\u95a2\u6570\n\n\u3010\u516c\u5f0f\u3011\ndx(t)=\u03bcx(t)dt+\u03c3x(t)dWtdx(t)=\u03bcx(t)dt+\u03c3x(t)dWt{\ndx(t)=\\mu x(t)dt+\\sigma x(t)dW_t\n\n}\n\n\u3010GBM()\u95a2\u6570\u306e\u8fd4\u308a\u5024\u3011\nX(t)=xer\u2212\u03c322\u2217t+\u03c3WtX(t)=xer\u2212\u03c322\u2217t+\u03c3Wt{\nX(t)=x \\mathrm{e}^\\frac {r- \\sigma^2} {2}*t+\\sigma W_t\n\n}\n\n\u3010\u89e3\u304f\u5f0f\u3011\nX(t)=xe0\u2212122\u2217t+1WtX(t)=xe0\u2212122\u2217t+1Wt{\nX(t)=x \\mathrm{e}^\\frac {0 - 1^2} {2}*t+1 W_t\n\n}\n\n\u203b\u95a2\u6570\u3092\u5b9f\u884c\u3059\u308b\u305f\u3073\u306b\u3001\uff08\u78ba\u7387\u904e\u7a0b\uff09\u306e\u30b7\u30df\u30e5\u30ec\u30fc\u30b7\u30e7\u30f3\u7d50\u679c\uff08\u6642\u7cfb\u5217\u5024\u306e\u63a8\u79fb\uff09\u306f\u5909\u5316\u3059\u308b\n\n-\uff08\u203b\u8fd4\u308a\u5024\uff09 \u89b3\u6e2c\u4e0d\u80fd\u306a\u6642\u7cfb\u5217\u5909\u6570 (an invisible ts object): xxx\n- \u6700\u7d42\u6642\u523b TTT :  1\n- \u521d\u671f\u5024 xxx :    1\n- \u91d1\u5229 rrr :      0\n- \u30dc\u30e9\u30c6\u30a3\u30ea\u30c6\u30a3 \u03c3\u03c3\u03c3 : 1\n- \u5404\u6642\u7cfb\u5217\u5909\u6570\u306e\u6570 NNN : 1,000\n\n\u203b\uff08\u6642\u7cfb\u5217\u5909\u6570\u306e\u6570 = \u30b0\u30e9\u30d5\u6a2a\u8ef8\u306e\u523b\u307f\u5e45 )\n\n( TTT - t0t0t_0 )/ NNN \n\n\n\u5b9f\u884c\uff081\u56de\u76ee\uff09\nGBMpath <- GBM(x=1, r=0, sigma=1, T=1, N=100)\n\nplot(GBMpath)\n\n\n\n\u5b9f\u884c\uff082\u56de\u76ee\uff09\nGBMpath <- GBM(x=1, r=0, sigma=1, T=1, N=100)\n\nplot(GBMpath)\n\n\n\n\u5b9f\u884c\uff083\u56de\u76ee\uff09\nGBMpath <- GBM(x=1, r=0, sigma=1, T=1, N=100)\n\nplot(GBMpath)\n\n\n\nhelp\u30da\u30fc\u30b8\u306e\u30b5\u30f3\u30d7\u30eb\u4f8b\u306b\u6cbf\u3063\u3066\u78ba\u7387\u5fae\u5206\u65b9\u7a0b\u5f0f\u3092\u89e3\u3044\u3066\u307f\u308b\n\n\uff08\u89e3\u306e\u6642\u7cfb\u5217\u63a8\u79fb\u306e\u6982\u5f62\u3092\u30b0\u30e9\u30d5\u3067\u78ba\u8a8d\uff09\n\n\u3010\u95a2\u6570\u3011 sde.sim()\n\n\uff08stochastic differential equation simulation\u95a2\u6570\uff09\n\n\n\u203b\u8fd4\u308a\u5024\uff1a N+1\u500b\uff08\u6642\u70b9\uff09\u306e\u89e3\u306e\u30d9\u30af\u30c8\u30eb\uff08ts\u578b\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\uff09\n\n\uff08\u6ce8\uff09\u4e0a\u8a18 N \u306f\u3001\u95a2\u6570\u306e\u5f15\u6570\u306b\u4e0e\u3048\u3066\u8a2d\u5b9a\u3059\u308b\uff08\u4ee5\u4e0b\u53c2\u7167\uff09\n\n\u3010sde.sim()\u95a2\u6570\u306e\u66f8\u5f0f\u3011\n\nsde.sim(t0 = 0, T = 1, X0 = 1, N = 100, 100, drift, sigma, drift.x, sigma.x, drift.xx, sigma.xx, drift.t, method = c(\"euler\", \"milstein\", \"KPS\", \"milstein2\", \"cdist\",\"ozaki\",\"shoji\",\"EA\"), alpha = 0.5, eta = 0.5, pred.corr = T, rcdist = NULL, theta = NULL, model = c(\"CIR\", \"VAS\", \"OU\", \"BS\"), k1, k2, phi, max.psi = 1000, rh, A, M=1)\n\n\u521d\u671f\u6642\u523b : t0t0t_0\n\u6700\u7d42\u6642\u523b : TTT\n\u521d\u671f\u5024 : x0x0x_0\n\u30b7\u30df\u30e5\u30ec\u30fc\u30b7\u30e7\u30f3\u56de\u6570\uff08\u78ba\u7387\u5909\u6570\u306e\u500b\u6570\uff09: NNN\n\u51fa\u529b\u3059\u308b\u6642\u7cfb\u5217\u63a8\u79fb(trajectory)\u306e\u6570: MMM\n\u30b7\u30df\u30e5\u30ec\u30fc\u30b7\u30e7\u30f3\u306eTime Step: \u03b4\u03b4\u03b4\n\u30c9\u30ea\u30d5\u30c8\u9805\u306e\u4fc2\u6570\uff08\u78ba\u5b9a\u9805\uff09: drift\n\u62e1\u6563\u9805\u4fc2\u6570\uff08\u78ba\u7387\u9805\uff09\uff1asigma\n\u30c9\u30ea\u30d5\u30c8\u9805\u4fc2\u6570\u306e\u504f\u5fae\u5206\u5024\uff1adrift.x\n\n\u62e1\u6563\u9805\u4fc2\u6570\u306e\u504f\u5fae\u5206\u5024: sigma.x\n\n\u30c9\u30ea\u30d5\u30c8\u9805\u4fc2\u6570\u306e2\u6b21\u504f\u5fae\u5206\u5024: drift.xx\n\n\u62e1\u6563\u9805\u4fc2\u6570\u306e2\u6b21\u504f\u5fae\u5206\u5024: sigma.xx\n\n\u30c9\u30ea\u30d5\u30c8\u6642\u9593\u9805\u4fc2\u6570\u306e\u504f\u5fae\u5206\u5024: drift.t\n\n\u30b7\u30df\u30e5\u30ec\u30fc\u30b7\u30e7\u30f3\u6f14\u7b97\u6cd5: method\n\n\n\uff08\u4ee5\u4e0b\u7565\uff09\n\n\u30aa\u30eb\u30f3\u30b7\u30e5\u30bf\u30a4\u30f3\uff1d\u30a6\u30fc\u30ec\u30f3\u30d9\u30c3\u30af\u904e\u7a0b\uff08\u300c\u5e73\u5747\u56de\u5e30\u904e\u7a0b\u300d\uff09 (Ornstein-Uhlenbeck process)\n\n\u3010\u516c\u5f0f\u3011\ndr(t)=\u2212\u03b8(r(t)\u2212\u03bc)dt+\u03c3dWtdr(t)=\u2212\u03b8(r(t)\u2212\u03bc)dt+\u03c3dWt{\ndr(t)=-\\theta(r(t)-\\mu)dt+\\sigma dW_t\n\n}\n\n\u3010\u89e3\u304f\u5f0f\u3011\ndX(t)=\u22125(X(t)\u22120)dt+3.5dWtdX(t)=\u22125(X(t)\u22120)dt+3.5dWt{\ndX(t)=-5(X(t)-0)dt+3.5 dW_t\n\n}\n\n\u03b8\u03b8\u03b8 : 5\nrrr : X\n\u03bc\u03bc\u03bc : 0\n\u03c3\u03c3\u03c3 : 3.5\n\n\uff08Wikipedia\uff09\u30aa\u30eb\u30f3\u30b7\u30e5\u30bf\u30a4\u30f3\uff1d\u30a6\u30fc\u30ec\u30f3\u30d9\u30c3\u30af\u904e\u7a0b\n\n\u300c\u30aa\u30eb\u30f3\u30b7\u30e5\u30bf\u30a4\u30f3\uff1d\u30a6\u30fc\u30ec\u30f3\u30d9\u30c3\u30af\u904e\u7a0b\u306f\u3001\u96e2\u6563\u6642\u9593AR(1)\u904e\u7a0b\u306e\u9023\u7d9a\u6642\u9593\u30d0\u30fc\u30b8\u30e7\u30f3\u3067\u3042\u308b\u3068\u8a00\u3048\u308b\u300d\n\nset.seed(123)\n\nd <- expression(-5 * x)   # \uff08\u6ce8\u610f\uff09\u5c0f\u6587\u5b57\u306e\"x\"\ns <- expression(3.5) \n\nX <- sde.sim(X0=10,drift=d, sigma=s)  # \uff08\u6ce8\u610f\uff09\u5927\u6587\u5b57\u306e\"X\"\n\nplot(X,main=\"Ornstein-Uhlenbeck\")   # \uff08\u6ce8\u610f\uff09\u5927\u6587\u5b57\u306e\"X\"\n\n\n\nMultiple trajectories of the O-U process\n\n\u203b \u5f15\u6570 M \u306b\uff13\u3092\u4e0e\u3048\u3066\u3001\u5fae\u5206\u65b9\u7a0b\u5f0f\u306e\u89e3\u3068\u3057\u3066\u3001\uff13\u672c\u306e\u6642\u7cfb\u5217\uff08\u904e\u7a0b\uff09\u3092\u5f97\u3066\u3044\u308b\nset.seed(123)\n\nX <- sde.sim(X0=10,drift=d, sigma=s, M=3) # \uff08\u6ce8\u610f\uff09\u5927\u6587\u5b57\u306e\"X\"\n\nplot(X,main=\"Multiple trajectories of O-U\")  # \uff08\u6ce8\u610f\uff09\u5927\u6587\u5b57\u306e\"X\"\n\n\n\n\u203b\uff08\u30b1\u30fc\u30b9\uff12\uff09\u5f15\u6570 M \u306b\uff15\u3092\u4e0e\u3048\u305f\u5834\u5408\nset.seed(123)\n\nX <- sde.sim(X0=10,drift=d, sigma=s, M=5) \n\nplot(X,main=\"Multiple trajectories of O-U\\n \uff08M=5 \uff09\") \n\n\n\n\u30b3\u30c3\u30af\u30b9\u30fb\u30a4\u30f3\u30ac\u30fc\u30bd\u30eb\u30fb\u30ed\u30b9\u30fb\u30e2\u30c7\u30eb \uff08CIR\u30e2\u30c7\u30eb: Cox-Ingersoll-Ross process\uff09\n\n\u3010\u516c\u5f0f\u3011\ndrt=a(b\u2212rt)dt+\u03c3rt\u2212\u221adWtdrt=a(b\u2212rt)dt+\u03c3rtdWt{\ndr_t=a(b-r_t)dt+\\sigma \\sqrt{r_t} dW_t\n\n}\n\n\u3010\u89e3\u304f\u5f0f\u3011\ndXt=3(2\u2212Xt)dt+2Xt\u2212\u2212\u221adWtdXt=3(2\u2212Xt)dt+2XtdWt{\ndX_t=3(2-X_t)dt+2 \\sqrt{X_t} dW_t\n\n}\n\nrrr : X\naaa : 3\nbbb : 2\n\u03c3\u03c3\u03c3 : 2\n\n\uff08Wikipedia\uff09\u30b3\u30c3\u30af\u30b9\u30fb\u30a4\u30f3\u30ac\u30fc\u30bd\u30eb\u30fb\u30ed\u30b9\u30fb\u30e2\u30c7\u30eb\n\n\u300c\u6570\u7406\u30d5\u30a1\u30a4\u30ca\u30f3\u30b9\u306b\u304a\u3044\u3066\u5229\u5b50\u7387\u306e\u6642\u9593\u7684\u5909\u52d5\u3092\u8a18\u8ff0\u3059\u308b\u6570\u7406\u30e2\u30c7\u30eb\u306e\u4e00\u3064\u300d\n\nset.seed(123)\n\nd <- expression( 6-3*x ) \ns <- expression( 2*sqrt(x) ) \n\nX <- sde.sim(X0=10,drift=d, sigma=s)   # \uff08\u6ce8\u610f\uff09\u5927\u6587\u5b57\u306e\"X\"\n\nplot(X,main=\"Cox-Ingersoll-Ross\")  # \uff08\u6ce8\u610f\uff09\u5927\u6587\u5b57\u306e\"X\"\n\n\n\nCox-Ingersoll-Ross using the conditional distribution \"rcCIR\"\nset.seed(123)\n\nX <- sde.sim(X0=10, theta=c(6, 3, 2), rcdist=rcCIR, method=\"cdist\") \n\nplot(X, main=\"Cox-Ingersoll-Ross\")\n\n\n\nExact simulation \u203b\u540c\u7fa9\u8a9e \"perfect simulation\" , \"perfect simulation\",  CFTP(coupling from the past)\n\uff08\u53c2\u8003\uff09\u6731\u9df2\u306e\u675cWiki\n\nMarkov\u30e2\u30c7\u30eb\u306e\u5b9a\u5e38\u72b6\u614b\u3067\u306e\u30b5\u30f3\u30d7\u30ea\u30f3\u30b0\u3059\u308b\u65b9\u6cd5\uff0e\nMCMC\u306b\u3088\u308b\u30b5\u30f3\u30d7\u30ea\u30f3\u30b0\u306f\u8fd1\u4f3c\u3060\u304c\uff0c\u30d1\u30fc\u30d5\u30a7\u30af\u30c8\u30b5\u30f3\u30d7\u30ea\u30f3\u30b0\u306f\u771f\u306e\u540c\u6642\u5206\u5e03\u306b\u5f93\u3046\u30b5\u30f3\u30d7\u30eb\u3092\u5f97\u308b\u3088\u3046\u306b\u8a2d\u8a08\u3055\u308c\u3066\u3044\u308b\uff0e\u3067\u3082\uff0c\u8a08\u7b97\u306f\u305a\u3063\u3068\u5927\u5909\uff0e\n\u904e\u53bb\u304b\u3089\u306e\u30ab\u30c3\u30d7\u30ea\u30f3\u30b0\u304c\u4ee3\u8868\u7684\u306a\u624b\u6cd5\uff0e\n\nset.seed(123)\n\nd <- expression(sin(x))\nd.x <- expression(cos(x)) \n\nA <- function(x) 1-cos(x)\n\nX <- sde.sim(method=\"EA\", delta=1/20, X0=0, N=500, drift=d, drift.x = d.x, A=A)\n\nplot(X, main=\"Periodic drift\")\n\n\n\n\uff08\u53c2\u8003\u30a6\u30a7\u30d6\u30b5\u30a4\u30c8)\n\n(1) \u7a81\u7136\u7d42\u308f\u308b\u304b\u3082\u3057\u308c\u306a\u3044\u30d6\u30ed\u30b0 \uff082014-03-31\u4ed8\u8a18\u4e8b\uff09\n(2) \u3071\u3089\u3071\u3089\u3081\u304f\u308b\u30b7\u30ea\u30fc\u30ba\u3010\u78ba\u7387\u5fae\u5206\u65b9\u7a0b\u5f0f\u3011\u3010R\u3011\n\n\n\uff08\u53c2\u8003 YouTube \u52d5\u753b\uff08\u203b \u82f1\u8a9e\uff09\uff09\n\n(1)  \uff08 YouTube \u3078\u306e\u30ea\u30f3\u30af \uff09 Stochastic Differential Equations with R \n\n\n\n\u4e0a\u8a18\u306e\u52d5\u753b\u304c\u7b2c\uff11\u56de\u76ee\u306e\uff11\uff10\u672c\u4ee5\u4e0a\u306e\u52d5\u753b\u30b7\u30ea\u30fc\u30ba\uff08\u82f1\u8a9e\uff09\u3067\u3059\n\n\u52d5\u753b\u6295\u7a3f\u8005\u306f\u3001Quant Education \u3055\u3093\u3067\u3059\u3002\n\n\u7d71\u8a08\u6570\u5024\u8a08\u7b97\u30fb\u6642\u7cfb\u5217\u89e3\u6790\u306a\u3069\u3001R \u3084\u305d\u306e\u4ed6\u306e\u30c4\u30fc\u30eb\u3092\u7528\u3044\u305f\u5b9f\u88c5\u65b9\u6cd5\u306e\u4f7f\u3044\u65b9\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb\u753b\u9762\u3092\u63d0\u4f9b\u3057\u3066\u304f\u308c\u3066\u3044\u307e\u3059\n\n\uff08 YouTube Quant Education \u6295\u7a3f\u52d5\u753b\u30ea\u30b9\u30c8\u3078\u306e\u30ea\u30f3\u30af \uff09\n\n\nI have worked as a Senior Quant for a big bank and studied at London School of Economics, Oxford University and Cambridge University.\nThe purpose of this channel is to widely disseminate the knowledge of tools and techniques used in Mathematical/Quantitative Finance and Quantitative Business Analytics. Please also visit QuantEdu.com for more courses. All the material here is taken from textbooks and is standard approach, my judgement and feeling is not part of the lectures.\nI also do consulting and onsite training for R, Probability, Time Series and Monte Carlo simulation. I am based in Pennsylvania, USA. Contact (training/partnership) :: quantedu.com@gmail.com or leave me a message on this channel.\n\n\nR Package ***_sde_***\u3000\u3092\u3064\u304b\u3063\u3066\u307f\u308b\n========================================================\n\n# \u3010\u53c2\u8003\u6587\u732e\u3011\n## Iacus, Stefano M.\uff08\u8457\uff09 _\"Simulation and Inference for Stochastic Differential Equations\"_\n\n![Book.jpg](https://qiita-image-store.s3.amazonaws.com/0/43487/643ce799-ec9b-cea2-8bad-076e7b56146b.jpeg)\n\n## [\u520a\u884c\u5143 Springer\u793e \u516c\u5f0f\u30a6\u30a7\u30d6\u30b5\u30a4\u30c8\u3078\u306e\u30ea\u30f3\u30af ](http://www.springer.com/statistics/computational+statistics/book/978-0-387-75838-1)\n\n# \u3010\u4ee5\u4e0b\u3001 _sde_ \u306ehelp()\u30da\u30fc\u30b8\u30de\u30cb\u30e5\u30a2\u30eb\u3092\u53c2\u8003\u306b\u4f7f\u3063\u3066\u307f\u308b\u3011\n\n# \u30d1\u30c3\u30b1\u30fc\u30b8\u306e\u8aad\u8fbc\u307f\n\n```{r}\nrequire(\"sde\")\n\n```\n\n# \u30d6\u30e9\u30a6\u30f3\u904b\u52d5\u7cfb\u5217\u3092\u767a\u751f\u3055\u305b\u3066\u307f\u308b\n\n### \u3010\u95a2\u6570\u3011 BM() \u203b **_Brownian motion\u95a2\u6570_**\n#### \u203b\u30d6\u30e9\u30a6\u30f3\u904b\u52d5 \u5909\u6570\u306e\u767a\u751f\u30b7\u30df\u30e5\u30ec\u30fc\u30b7\u30e7\u30f3\u95a2\u6570\n\n# \u30d6\u30e9\u30a6\u30f3\u904b\u52d5\u306e\u5f15\u6570\u30d1\u30e9\u30e1\u30fc\u30bf\u7fa4\u3068\u4eca\u56de\u306e\u8a2d\u5b9a\n#### ***_\u203b\u95a2\u6570\u3092\u5b9f\u884c\u3059\u308b\u305f\u3073\u306b\u3001\u767a\u751f\u3055\u308c\u308b\u30d6\u30e9\u30a6\u30f3\uff08\u78ba\u7387\u904e\u7a0b\uff09\u6642\u7cfb\u5217\u5024\u306f\u5909\u5316\u3059\u308b_***\n\n- \u521d\u671f\u5024 $x$ :    0\n- \u521d\u671f\u6642\u523b $t_0$ : 0\n- \u6700\u7d42\u6642\u523b $T$ :  1\n- \u5404\u6642\u7cfb\u5217\u5909\u6570\u306e\u6570 $N$ : 1,000\n\n#### \u203b\uff08\u6642\u7cfb\u5217\u5909\u6570\u306e\u6570 = \u30b0\u30e9\u30d5\u6a2a\u8ef8\u306e\u523b\u307f\u5e45 ) \n- ( $T$ - $t_0$ )/ $N$ \n\n\n### \u5b9f\u884c\uff081\u56de\u76ee\uff09\n```{r}\nBMpath <- BM(x = 0, t0 = 0, T = 1, N = 1000) \n\nplot(BMpath)\n```\n\n![graph.1.png](https://qiita-image-store.s3.amazonaws.com/0/43487/63629ff4-511f-c35d-e81f-c6a05597be7e.png)\n\n\n### \u5b9f\u884c\uff082\u56de\u76ee\uff09\n```{r}\nBMpath <- BM(x = 0, t0 = 0, T = 1, N = 1000) \n\nplot(BMpath)\n```\n\n![graph.2.png](https://qiita-image-store.s3.amazonaws.com/0/43487/eff1b037-9340-28b9-f645-357c37bfb992.png)\n\n\n### \u5b9f\u884c\uff083\u56de\u76ee\uff09\n```{r}\nBMpath <- BM(x = 0, t0 = 0, T = 1, N = 1000) \n\nplot(BMpath)\n```\n\n![graph.3.png](https://qiita-image-store.s3.amazonaws.com/0/43487/f6707e12-baff-6416-e028-ba71226d8265.png)\n\n\n# \u682a\u4fa1\u904e\u7a0b\u306e\u30c0\u30df\u30fc\u3068\u3057\u3066\u4f7f\u308f\u308c\u308b\u5e7e\u4f55\u30d6\u30e9\u30a6\u30f3\u904b\u52d5\u7cfb\u5217\u3092\u767a\u751f\u3055\u305b\u3066\u307f\u308b\n\n### \u3010\u95a2\u6570\u3011 GBM() \u203b **_Geometric Brownian motion\u95a2\u6570_**\n#### \u203b\u5e7e\u4f55\u30d6\u30e9\u30a6\u30f3\u904b\u52d5 \u5909\u6570\u306e\u767a\u751f\u30b7\u30df\u30e5\u30ec\u30fc\u30b7\u30e7\u30f3\u95a2\u6570\n\n### \u3010\u516c\u5f0f\u3011\n\n```math\n\ndx(t)=\\mu x(t)dt+\\sigma x(t)dW_t\n\n```\n\n### \u3010GBM()\u95a2\u6570\u306e\u8fd4\u308a\u5024\u3011\n```math\n\nX(t)=x \\mathrm{e}^\\frac {r- \\sigma^2} {2}*t+\\sigma W_t\n\n```\n\n### \u3010\u89e3\u304f\u5f0f\u3011\n\n```math\n\nX(t)=x \\mathrm{e}^\\frac {0 - 1^2} {2}*t+1 W_t\n\n```\n\n#### ***_\u203b\u95a2\u6570\u3092\u5b9f\u884c\u3059\u308b\u305f\u3073\u306b\u3001\uff08\u78ba\u7387\u904e\u7a0b\uff09\u306e\u30b7\u30df\u30e5\u30ec\u30fc\u30b7\u30e7\u30f3\u7d50\u679c\uff08\u6642\u7cfb\u5217\u5024\u306e\u63a8\u79fb\uff09\u306f\u5909\u5316\u3059\u308b_***\n\n-\uff08\u203b\u8fd4\u308a\u5024\uff09 \u89b3\u6e2c\u4e0d\u80fd\u306a\u6642\u7cfb\u5217\u5909\u6570 (an invisible ts object): $x$\n- \u6700\u7d42\u6642\u523b $T$ :  1\n- \u521d\u671f\u5024 $x$ :    1\n- \u91d1\u5229 $r$ :      0\n- \u30dc\u30e9\u30c6\u30a3\u30ea\u30c6\u30a3 $\u03c3$ : 1\n- \u5404\u6642\u7cfb\u5217\u5909\u6570\u306e\u6570 $N$ : 1,000\n\n#### \u203b\uff08\u6642\u7cfb\u5217\u5909\u6570\u306e\u6570 = \u30b0\u30e9\u30d5\u6a2a\u8ef8\u306e\u523b\u307f\u5e45 ) \n- ( $T$ - $t_0$ )/ $N$ \n\n### \u5b9f\u884c\uff081\u56de\u76ee\uff09\n```{r}\nGBMpath <- GBM(x=1, r=0, sigma=1, T=1, N=100)\n\nplot(GBMpath)\n```\n\n![graph.4.png](https://qiita-image-store.s3.amazonaws.com/0/43487/0498954f-0f5d-5cbe-7ae4-6560749f3120.png)\n\n\n### \u5b9f\u884c\uff082\u56de\u76ee\uff09\n```{r}\nGBMpath <- GBM(x=1, r=0, sigma=1, T=1, N=100)\n\nplot(GBMpath)\n```\n\n![graph.5.png](https://qiita-image-store.s3.amazonaws.com/0/43487/8cbc548c-d4a1-7452-549a-300009b500c3.png)\n\n\n### \u5b9f\u884c\uff083\u56de\u76ee\uff09\n```{r}\nGBMpath <- GBM(x=1, r=0, sigma=1, T=1, N=100)\n\nplot(GBMpath)\n```\n\n![graph.6.png](https://qiita-image-store.s3.amazonaws.com/0/43487/fabcf152-0488-cfa1-d250-45c528841a36.png)\n\n\n# help\u30da\u30fc\u30b8\u306e\u30b5\u30f3\u30d7\u30eb\u4f8b\u306b\u6cbf\u3063\u3066\u78ba\u7387\u5fae\u5206\u65b9\u7a0b\u5f0f\u3092\u89e3\u3044\u3066\u307f\u308b\n###  \uff08\u89e3\u306e\u6642\u7cfb\u5217\u63a8\u79fb\u306e\u6982\u5f62\u3092\u30b0\u30e9\u30d5\u3067\u78ba\u8a8d\uff09\n\n### \u3010\u95a2\u6570\u3011 sde.sim()  \n#### **_\uff08stochastic differential equation simulation\u95a2\u6570\uff09_**\n#### \u203b\u8fd4\u308a\u5024\uff1a N+1\u500b\uff08\u6642\u70b9\uff09\u306e\u89e3\u306e\u30d9\u30af\u30c8\u30eb\uff08ts\u578b\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\uff09\n##### \uff08\u6ce8\uff09\u4e0a\u8a18 N \u306f\u3001\u95a2\u6570\u306e\u5f15\u6570\u306b\u4e0e\u3048\u3066\u8a2d\u5b9a\u3059\u308b\uff08\u4ee5\u4e0b\u53c2\u7167\uff09\n\n### \u3010sde.sim()\u95a2\u6570\u306e\u66f8\u5f0f\u3011\n#### sde.sim(t0 = 0, T = 1, X0 = 1, N = 100, 100, drift, sigma, drift.x, sigma.x, drift.xx, sigma.xx, drift.t, method = c(\"euler\", \"milstein\", \"KPS\", \"milstein2\", \"cdist\",\"ozaki\",\"shoji\",\"EA\"), alpha = 0.5, eta = 0.5, pred.corr = T, rcdist = NULL, theta = NULL, model = c(\"CIR\", \"VAS\", \"OU\", \"BS\"), k1, k2, phi, max.psi = 1000, rh, A, M=1)\n\n- \u521d\u671f\u6642\u523b : $t_0$\n- \u6700\u7d42\u6642\u523b : $T$\n- \u521d\u671f\u5024 : $x_0$\n- \u30b7\u30df\u30e5\u30ec\u30fc\u30b7\u30e7\u30f3\u56de\u6570\uff08\u78ba\u7387\u5909\u6570\u306e\u500b\u6570\uff09: $N$\n- \u51fa\u529b\u3059\u308b\u6642\u7cfb\u5217\u63a8\u79fb(trajectory)\u306e\u6570: $M$\n- \u30b7\u30df\u30e5\u30ec\u30fc\u30b7\u30e7\u30f3\u306eTime Step: $\u03b4$\n- \u30c9\u30ea\u30d5\u30c8\u9805\u306e\u4fc2\u6570\uff08\u78ba\u5b9a\u9805\uff09: drift\n- \u62e1\u6563\u9805\u4fc2\u6570\uff08\u78ba\u7387\u9805\uff09\uff1asigma\n- \u30c9\u30ea\u30d5\u30c8\u9805\u4fc2\u6570\u306e\u504f\u5fae\u5206\u5024\uff1adrift.x\t\n- \u62e1\u6563\u9805\u4fc2\u6570\u306e\u504f\u5fae\u5206\u5024: sigma.x\t\n- \u30c9\u30ea\u30d5\u30c8\u9805\u4fc2\u6570\u306e2\u6b21\u504f\u5fae\u5206\u5024: drift.xx\t\n- \u62e1\u6563\u9805\u4fc2\u6570\u306e2\u6b21\u504f\u5fae\u5206\u5024: sigma.xx\t\n- \u30c9\u30ea\u30d5\u30c8\u6642\u9593\u9805\u4fc2\u6570\u306e\u504f\u5fae\u5206\u5024: drift.t\t\n- \u30b7\u30df\u30e5\u30ec\u30fc\u30b7\u30e7\u30f3\u6f14\u7b97\u6cd5: method\n\n###             \uff08\u4ee5\u4e0b\u7565\uff09\n\n\n\n\n\n# \u30aa\u30eb\u30f3\u30b7\u30e5\u30bf\u30a4\u30f3\uff1d\u30a6\u30fc\u30ec\u30f3\u30d9\u30c3\u30af\u904e\u7a0b\uff08\u300c\u5e73\u5747\u56de\u5e30\u904e\u7a0b\u300d\uff09 (Ornstein-Uhlenbeck process)\n\n### \u3010\u516c\u5f0f\u3011\n```math\n\ndr(t)=-\\theta(r(t)-\\mu)dt+\\sigma dW_t\n\n```\n\n### \u3010\u89e3\u304f\u5f0f\u3011\n```math\n\ndX(t)=-5(X(t)-0)dt+3.5 dW_t\n\n```\n\n- $\u03b8$ : 5\n- $r$ : X\n- $\u03bc$ : 0\n- $\u03c3$ : 3.5\n\n[\uff08Wikipedia\uff09\u30aa\u30eb\u30f3\u30b7\u30e5\u30bf\u30a4\u30f3\uff1d\u30a6\u30fc\u30ec\u30f3\u30d9\u30c3\u30af\u904e\u7a0b](http://ja.wikipedia.org/wiki/%E3%82%AA%E3%83%AB%E3%83%B3%E3%82%B7%E3%83%A5%E3%82%BF%E3%82%A4%E3%83%B3%EF%BC%9D%E3%82%A6%E3%83%BC%E3%83%AC%E3%83%B3%E3%83%99%E3%83%83%E3%82%AF%E9%81%8E%E7%A8%8B)\n\n>\u300c\u30aa\u30eb\u30f3\u30b7\u30e5\u30bf\u30a4\u30f3\uff1d\u30a6\u30fc\u30ec\u30f3\u30d9\u30c3\u30af\u904e\u7a0b\u306f\u3001\u96e2\u6563\u6642\u9593AR(1)\u904e\u7a0b\u306e\u9023\u7d9a\u6642\u9593\u30d0\u30fc\u30b8\u30e7\u30f3\u3067\u3042\u308b\u3068\u8a00\u3048\u308b\u300d\n\n```{r}\nset.seed(123)\n\nd <- expression(-5 * x)   # \uff08\u6ce8\u610f\uff09\u5c0f\u6587\u5b57\u306e\"x\"\ns <- expression(3.5) \n\nX <- sde.sim(X0=10,drift=d, sigma=s)  # \uff08\u6ce8\u610f\uff09\u5927\u6587\u5b57\u306e\"X\"\n\nplot(X,main=\"Ornstein-Uhlenbeck\")   # \uff08\u6ce8\u610f\uff09\u5927\u6587\u5b57\u306e\"X\"\n```\n\n![graph.7.png](https://qiita-image-store.s3.amazonaws.com/0/43487/52ca1d54-c519-3fbc-f8e3-03b58f5d2e1f.png)\n\n\n# Multiple trajectories of the O-U process\n\n### \u203b \u5f15\u6570 _M_ \u306b\uff13\u3092\u4e0e\u3048\u3066\u3001\u5fae\u5206\u65b9\u7a0b\u5f0f\u306e\u89e3\u3068\u3057\u3066\u3001\uff13\u672c\u306e\u6642\u7cfb\u5217\uff08\u904e\u7a0b\uff09\u3092\u5f97\u3066\u3044\u308b\n\n```{r}\nset.seed(123)\n\nX <- sde.sim(X0=10,drift=d, sigma=s, M=3) # \uff08\u6ce8\u610f\uff09\u5927\u6587\u5b57\u306e\"X\"\n\nplot(X,main=\"Multiple trajectories of O-U\")  # \uff08\u6ce8\u610f\uff09\u5927\u6587\u5b57\u306e\"X\"\n```\n\n![graph.8.png](https://qiita-image-store.s3.amazonaws.com/0/43487/89470ed9-c558-23ce-2d82-4167efa37038.png)\n\n\n### \u203b\uff08\u30b1\u30fc\u30b9\uff12\uff09\u5f15\u6570 _M_ \u306b\uff15\u3092\u4e0e\u3048\u305f\u5834\u5408\n\n```{r}\nset.seed(123)\n\nX <- sde.sim(X0=10,drift=d, sigma=s, M=5) \n\nplot(X,main=\"Multiple trajectories of O-U\\n \uff08M=5 \uff09\") \n```\n\n![addition.graph.png](https://qiita-image-store.s3.amazonaws.com/0/43487/e9f6ff2d-ff59-ca8f-9233-cb570149587d.png)\n\n\n# \u30b3\u30c3\u30af\u30b9\u30fb\u30a4\u30f3\u30ac\u30fc\u30bd\u30eb\u30fb\u30ed\u30b9\u30fb\u30e2\u30c7\u30eb \uff08CIR\u30e2\u30c7\u30eb: Cox-Ingersoll-Ross process\uff09\n\n### \u3010\u516c\u5f0f\u3011\n\n```math\n\ndr_t=a(b-r_t)dt+\\sigma \\sqrt{r_t} dW_t\n\n```\n### \u3010\u89e3\u304f\u5f0f\u3011\n\n```math\n\ndX_t=3(2-X_t)dt+2 \\sqrt{X_t} dW_t\n\n```\n- $r$ : X\n- $a$ : 3\n- $b$ : 2\n- $\u03c3$ : 2\n\n[\uff08Wikipedia\uff09\u30b3\u30c3\u30af\u30b9\u30fb\u30a4\u30f3\u30ac\u30fc\u30bd\u30eb\u30fb\u30ed\u30b9\u30fb\u30e2\u30c7\u30eb](http://ja.wikipedia.org/wiki/%E3%82%B3%E3%83%83%E3%82%AF%E3%82%B9%E3%83%BB%E3%82%A4%E3%83%B3%E3%82%AC%E3%83%BC%E3%82%BD%E3%83%AB%E3%83%BB%E3%83%AD%E3%82%B9%E3%83%BB%E3%83%A2%E3%83%87%E3%83%AB)\n\n>\u300c\u6570\u7406\u30d5\u30a1\u30a4\u30ca\u30f3\u30b9\u306b\u304a\u3044\u3066\u5229\u5b50\u7387\u306e\u6642\u9593\u7684\u5909\u52d5\u3092\u8a18\u8ff0\u3059\u308b\u6570\u7406\u30e2\u30c7\u30eb\u306e\u4e00\u3064\u300d\n\n\n```{r}\nset.seed(123)\n\nd <- expression( 6-3*x ) \ns <- expression( 2*sqrt(x) ) \n\nX <- sde.sim(X0=10,drift=d, sigma=s)   # \uff08\u6ce8\u610f\uff09\u5927\u6587\u5b57\u306e\"X\"\n\nplot(X,main=\"Cox-Ingersoll-Ross\")  # \uff08\u6ce8\u610f\uff09\u5927\u6587\u5b57\u306e\"X\"\n```\n\n![graph.9.png](https://qiita-image-store.s3.amazonaws.com/0/43487/43cf16b7-e37f-5f16-a959-7d2067a92caa.png)\n\n\n###  Cox-Ingersoll-Ross using the conditional distribution \"rcCIR\"\n\n\n```{r}\nset.seed(123)\n\nX <- sde.sim(X0=10, theta=c(6, 3, 2), rcdist=rcCIR, method=\"cdist\") \n\nplot(X, main=\"Cox-Ingersoll-Ross\")\n```\n\n![graph.10.png](https://qiita-image-store.s3.amazonaws.com/0/43487/e19f3ff9-c15a-b39d-1b8a-f231db02aac9.png)\n\n\n### Exact simulation \u203b\u540c\u7fa9\u8a9e \"perfect simulation\" , \"perfect simulation\",  CFTP(coupling from the past)\n[\uff08\u53c2\u8003\uff09\u6731\u9df2\u306e\u675cWiki](http://ibisforest.org/index.php?%E3%83%91%E3%83%BC%E3%83%95%E3%82%A7%E3%82%AF%E3%83%88%E3%82%B5%E3%83%B3%E3%83%97%E3%83%AA%E3%83%B3%E3%82%B0)\n\n> Markov\u30e2\u30c7\u30eb\u306e\u5b9a\u5e38\u72b6\u614b\u3067\u306e\u30b5\u30f3\u30d7\u30ea\u30f3\u30b0\u3059\u308b\u65b9\u6cd5\uff0e\n> MCMC\u306b\u3088\u308b\u30b5\u30f3\u30d7\u30ea\u30f3\u30b0\u306f\u8fd1\u4f3c\u3060\u304c\uff0c\u30d1\u30fc\u30d5\u30a7\u30af\u30c8\u30b5\u30f3\u30d7\u30ea\u30f3\u30b0\u306f\u771f\u306e\u540c\u6642\u5206\u5e03\u306b\u5f93\u3046\u30b5\u30f3\u30d7\u30eb\u3092\u5f97\u308b\u3088\u3046\u306b\u8a2d\u8a08\u3055\u308c\u3066\u3044\u308b\uff0e\u3067\u3082\uff0c\u8a08\u7b97\u306f\u305a\u3063\u3068\u5927\u5909\uff0e\n> \u904e\u53bb\u304b\u3089\u306e\u30ab\u30c3\u30d7\u30ea\u30f3\u30b0\u304c\u4ee3\u8868\u7684\u306a\u624b\u6cd5\uff0e\n\n \n```{r}\nset.seed(123)\n\nd <- expression(sin(x))\nd.x <- expression(cos(x)) \n\nA <- function(x) 1-cos(x)\n\nX <- sde.sim(method=\"EA\", delta=1/20, X0=0, N=500, drift=d, drift.x = d.x, A=A)\n\nplot(X, main=\"Periodic drift\")\n```\n\n![graph.11.png](https://qiita-image-store.s3.amazonaws.com/0/43487/91cc4476-36ff-6bea-d74e-851dec924269.png)\n\n# \uff08\u53c2\u8003\u30a6\u30a7\u30d6\u30b5\u30a4\u30c8)\n\n- (1) [\u7a81\u7136\u7d42\u308f\u308b\u304b\u3082\u3057\u308c\u306a\u3044\u30d6\u30ed\u30b0 \uff082014-03-31\u4ed8\u8a18\u4e8b\uff09](http://mkprob.hatenablog.com/entry/2014/03/31/014427)\n\n- (2) [\u3071\u3089\u3071\u3089\u3081\u304f\u308b\u30b7\u30ea\u30fc\u30ba\u3010\u78ba\u7387\u5fae\u5206\u65b9\u7a0b\u5f0f\u3011\u3010R\u3011](http://d.hatena.ne.jp/ryamada/touch/searchdiary?word=*%5B%B3%CE%CE%A8%C8%F9%CA%AC%CA%FD%C4%F8%BC%B0%5D)\n\n# \uff08\u53c2\u8003 _YouTube_ \u52d5\u753b\uff08\u203b \u82f1\u8a9e\uff09\uff09\n\n- (1) [ \uff08 _YouTube_ \u3078\u306e\u30ea\u30f3\u30af \uff09 _Stochastic Differential Equations with R_   ](https://www.youtube.com/watch?v=DO_8sjv8NfM&list=PLRj8HuwfWZEsXW2pzAwAWYC8EZbD2ieOq)\n\n##### \u4e0a\u8a18\u306e\u52d5\u753b\u304c\u7b2c\uff11\u56de\u76ee\u306e\uff11\uff10\u672c\u4ee5\u4e0a\u306e\u52d5\u753b\u30b7\u30ea\u30fc\u30ba\uff08\u82f1\u8a9e\uff09\u3067\u3059\n\n#### \u52d5\u753b\u6295\u7a3f\u8005\u306f\u3001_Quant Education_ \u3055\u3093\u3067\u3059\u3002\n#### \u7d71\u8a08\u6570\u5024\u8a08\u7b97\u30fb\u6642\u7cfb\u5217\u89e3\u6790\u306a\u3069\u3001_R_ \u3084\u305d\u306e\u4ed6\u306e\u30c4\u30fc\u30eb\u3092\u7528\u3044\u305f\u5b9f\u88c5\u65b9\u6cd5\u306e\u4f7f\u3044\u65b9\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb\u753b\u9762\u3092\u63d0\u4f9b\u3057\u3066\u304f\u308c\u3066\u3044\u307e\u3059\n\n##### [\uff08 _YouTube_ _Quant Education_ \u6295\u7a3f\u52d5\u753b\u30ea\u30b9\u30c8\u3078\u306e\u30ea\u30f3\u30af \uff09](https://www.youtube.com/channel/UC37c5dtVf3BHWFr5v9NKSKw)\n>  I have worked as a Senior Quant for a big bank and studied at London School of Economics, Oxford University and Cambridge University.\nThe purpose of this channel is to widely disseminate the knowledge of tools and techniques used in Mathematical/Quantitative Finance and Quantitative Business Analytics. Please also visit QuantEdu.com for more courses. All the material here is taken from textbooks and is standard approach, my judgement and feeling is not part of the lectures.\nI also do consulting and onsite training for R, Probability, Time Series and Monte Carlo simulation. I am based in Pennsylvania, USA. Contact (training/partnership) :: quantedu.com@gmail.com or leave me a message on this channel.\n"}