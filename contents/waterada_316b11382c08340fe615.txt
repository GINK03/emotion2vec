{"context": " More than 1 year has passed since last update.\n\n\u6982\u8981\nExcel \u306e\u95a2\u6570\u3084\u3001VBA \u306e\u4e2d\u3067\u6b63\u898f\u8868\u73fe\u3092\u4f7f\u3044\u305f\u3044\u3068\u601d\u3046\u3053\u3068\u306f\u591a\u3044\u3068\u601d\u3044\u307e\u3059\u3002\n\u4e0b\u8a18\u306e\u3088\u3046\u306b\u3059\u308b\u3068\u4f7f\u3048\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3088\u3002\n\nVBA \u306e\u753b\u9762\u304b\u3089\u4e0b\u8a18\u306e\u30e2\u30b8\u30e5\u30fc\u30eb\u3092\u8ffd\u52a0\u3057\u307e\u3059\u3002\nOption Explicit\n\n'\u6b63\u898f\u8868\u73fe\u3067\u4e00\u62ec\u7f6e\u304d\u63db\u3048\nPublic Function RegExpReplace(SrcStr As String, RegStr As String, RepStr As String) As String\n    RegExpReplace = GetRegExp(RegStr:=RegStr, IgnoreCase:=False, IsGlobal:=True).Replace(SrcStr, RepStr)\nEnd Function\n\n'\u6b63\u898f\u8868\u73fe\u3067\u691c\u7d22\nPublic Function RegExpMatch(SrcStr As String, RegStr As String) As Boolean\n    RegExpMatch = GetRegExp(RegStr:=RegStr, IgnoreCase:=False, IsGlobal:=False).Test(SrcStr)\nEnd Function\n\n'\u6b63\u898f\u8868\u73fe\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u53d6\u5f97\nPrivate Function GetRegExp(RegStr As String, Optional IgnoreCase As Boolean = False, Optional IsGlobal As Boolean = True) As Variant\n    Dim Reg\n    Set Reg = CreateObject(\"VBScript.RegExp\")\n    Reg.Pattern = RegStr '\u6b63\u898f\u8868\u73fe\u6587\u5b57\u5217\n    Reg.IgnoreCase = IgnoreCase     '\u5927\u6587\u5b57\u3068\u5c0f\u6587\u5b57\u3092\u533a\u5225\u3057\u306a\u3044\u304b\n    Reg.Global = IsGlobal          '\u6587\u5b57\u5217\u5168\u4f53\u3092\u691c\u7d22\n    Set GetRegExp = Reg\nEnd Function\n\n\u3084\u308b\u3053\u3068\u306f\u3001\u3053\u308c\u3060\u3051\u3067\u3059\u3002\n\u305f\u3060\u3057\u3001 xlsx \u3058\u3083\u306a\u304f\u3066\u3001xlsm \uff08\u30de\u30af\u30ed\u542b\u3080\u5f62\u5f0f\uff09\u3067\u4fdd\u5b58\u3057\u306a\u3044\u3068\u3044\u3051\u307e\u305b\u3093\u3051\u3069\u306d\u3002\n\n\u4f7f\u3044\u65b9\uff08\u95a2\u6570\u3068\u3057\u3066\u4f7f\u3046\u5834\u5408\uff09\n\u305f\u3068\u3048\u3070\u3001\u4e0b\u8a18\u306e\u3088\u3046\u306b\u3059\u308c\u3070 A1 \u306e\u6587\u5b57\u5217\u4e2d\u306b\u542b\u307e\u308c\u308b\u6570\u5b57\u304c [] \u3067\u56f2\u307e\u308c\u308b\u3053\u3068\u306b\u306a\u308a\u307e\u3059\u3002\n=RegExpReplace(A1, \"(\\d+)\", \"[$1]\")\n\n\u4e0b\u8a18\u306e\u3088\u3046\u306b\u3059\u308c\u3070 A1 \u306e\u6587\u5b57\u5217\u4e2d\u306b\u6570\u5b57\u304c\u542b\u307e\u308c\u308b\u304b\u3069\u3046\u304b\u3092 TRUE / FALSE \u3067\u8fd4\u3059\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\n=RegExpMatch(A1, \"\\d\")\n\n\n\u4f7f\u3044\u65b9\uff08VBA\u3068\u3057\u3066\u4f7f\u3046\u5834\u5408\uff09\n\u95a2\u6570\u3068\u540c\u69d8\u306b\u4e0b\u8a18\u306e\u3088\u3046\u306b\u4f7f\u3048\u307e\u3059\u3002\nstrReplaced = RegExpReplace(strTarget, \"(\\d+)\", \"[$1]\")\n\nboolMatched = RegExpMatch(strTarget, \"\\d\")\n\n# \u6982\u8981\n\nExcel \u306e\u95a2\u6570\u3084\u3001VBA \u306e\u4e2d\u3067\u6b63\u898f\u8868\u73fe\u3092\u4f7f\u3044\u305f\u3044\u3068\u601d\u3046\u3053\u3068\u306f\u591a\u3044\u3068\u601d\u3044\u307e\u3059\u3002\n\u4e0b\u8a18\u306e\u3088\u3046\u306b\u3059\u308b\u3068\u4f7f\u3048\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3088\u3002\n\n\n# VBA \u306e\u753b\u9762\u304b\u3089\u4e0b\u8a18\u306e\u30e2\u30b8\u30e5\u30fc\u30eb\u3092\u8ffd\u52a0\u3057\u307e\u3059\u3002\n\n```vbnet\nOption Explicit\n\n'\u6b63\u898f\u8868\u73fe\u3067\u4e00\u62ec\u7f6e\u304d\u63db\u3048\nPublic Function RegExpReplace(SrcStr As String, RegStr As String, RepStr As String) As String\n    RegExpReplace = GetRegExp(RegStr:=RegStr, IgnoreCase:=False, IsGlobal:=True).Replace(SrcStr, RepStr)\nEnd Function\n\n'\u6b63\u898f\u8868\u73fe\u3067\u691c\u7d22\nPublic Function RegExpMatch(SrcStr As String, RegStr As String) As Boolean\n    RegExpMatch = GetRegExp(RegStr:=RegStr, IgnoreCase:=False, IsGlobal:=False).Test(SrcStr)\nEnd Function\n\n'\u6b63\u898f\u8868\u73fe\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u53d6\u5f97\nPrivate Function GetRegExp(RegStr As String, Optional IgnoreCase As Boolean = False, Optional IsGlobal As Boolean = True) As Variant\n    Dim Reg\n    Set Reg = CreateObject(\"VBScript.RegExp\")\n    Reg.Pattern = RegStr '\u6b63\u898f\u8868\u73fe\u6587\u5b57\u5217\n    Reg.IgnoreCase = IgnoreCase     '\u5927\u6587\u5b57\u3068\u5c0f\u6587\u5b57\u3092\u533a\u5225\u3057\u306a\u3044\u304b\n    Reg.Global = IsGlobal          '\u6587\u5b57\u5217\u5168\u4f53\u3092\u691c\u7d22\n    Set GetRegExp = Reg\nEnd Function\n```\n\n\u3084\u308b\u3053\u3068\u306f\u3001\u3053\u308c\u3060\u3051\u3067\u3059\u3002\n\u305f\u3060\u3057\u3001 xlsx \u3058\u3083\u306a\u304f\u3066\u3001xlsm \uff08\u30de\u30af\u30ed\u542b\u3080\u5f62\u5f0f\uff09\u3067\u4fdd\u5b58\u3057\u306a\u3044\u3068\u3044\u3051\u307e\u305b\u3093\u3051\u3069\u306d\u3002\n\n# \u4f7f\u3044\u65b9\uff08\u95a2\u6570\u3068\u3057\u3066\u4f7f\u3046\u5834\u5408\uff09\n\n\u305f\u3068\u3048\u3070\u3001\u4e0b\u8a18\u306e\u3088\u3046\u306b\u3059\u308c\u3070 A1 \u306e\u6587\u5b57\u5217\u4e2d\u306b\u542b\u307e\u308c\u308b\u6570\u5b57\u304c [] \u3067\u56f2\u307e\u308c\u308b\u3053\u3068\u306b\u306a\u308a\u307e\u3059\u3002\n\n```\n=RegExpReplace(A1, \"(\\d+)\", \"[$1]\")\n```\n\n\u4e0b\u8a18\u306e\u3088\u3046\u306b\u3059\u308c\u3070 A1 \u306e\u6587\u5b57\u5217\u4e2d\u306b\u6570\u5b57\u304c\u542b\u307e\u308c\u308b\u304b\u3069\u3046\u304b\u3092 TRUE / FALSE \u3067\u8fd4\u3059\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\n\n```\n=RegExpMatch(A1, \"\\d\")\n```\n\n\n# \u4f7f\u3044\u65b9\uff08VBA\u3068\u3057\u3066\u4f7f\u3046\u5834\u5408\uff09\n\n\u95a2\u6570\u3068\u540c\u69d8\u306b\u4e0b\u8a18\u306e\u3088\u3046\u306b\u4f7f\u3048\u307e\u3059\u3002\n\n```vbnet\nstrReplaced = RegExpReplace(strTarget, \"(\\d+)\", \"[$1]\")\n```\n\n```vbnet\nboolMatched = RegExpMatch(strTarget, \"\\d\")\n```\n", "tags": ["Excel", "ExcelVBA"]}