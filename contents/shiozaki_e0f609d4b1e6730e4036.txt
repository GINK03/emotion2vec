{"context": "AA\u3068BB\u3092\u914d\u5217\u3068\u3057\u3066\u6642\u306b\u3001A\u2216BA \\setminus B\u3068\u306a\u308b\u914d\u5217\u3092\u8fd4\u3059UDF\u95a2\u6570\u3092\u4f5c\u3063\u3066\u307f\u307e\u3057\u305f\u3002\n#standardSQL\nCREATE TEMPORARY FUNCTION ARRAY_INT64_INCLUDE(arr ARRAY<INT64>, val INT64)\nRETURNS BOOL AS ((\n  SELECT LOGICAL_OR(elem = val) FROM UNNEST(arr) as elem\n));\n\nCREATE TEMPORARY FUNCTION ARRAY_INT64_SUB(arr1 ARRAY<INT64>, arr2 ARRAY<INT64>)\nRETURNS ARRAY<INT64> AS ((\n  SELECT ARRAY(SELECT val FROM UNNEST(arr1) AS val WHERE NOT(ARRAY_INT64_INCLUDE(arr2, val)))\n));\n\nSELECT ARRAY_INT64_SUB([1, 2, 3, 4, 5], [2, 3, 4])\n\n\n$A$\u3068$B$\u3092\u914d\u5217\u3068\u3057\u3066\u6642\u306b\u3001$A \\setminus B$\u3068\u306a\u308b\u914d\u5217\u3092\u8fd4\u3059UDF\u95a2\u6570\u3092\u4f5c\u3063\u3066\u307f\u307e\u3057\u305f\u3002\n\n```sql\n#standardSQL\nCREATE TEMPORARY FUNCTION ARRAY_INT64_INCLUDE(arr ARRAY<INT64>, val INT64)\nRETURNS BOOL AS ((\n  SELECT LOGICAL_OR(elem = val) FROM UNNEST(arr) as elem\n));\n\nCREATE TEMPORARY FUNCTION ARRAY_INT64_SUB(arr1 ARRAY<INT64>, arr2 ARRAY<INT64>)\nRETURNS ARRAY<INT64> AS ((\n  SELECT ARRAY(SELECT val FROM UNNEST(arr1) AS val WHERE NOT(ARRAY_INT64_INCLUDE(arr2, val)))\n));\n\nSELECT ARRAY_INT64_SUB([1, 2, 3, 4, 5], [2, 3, 4])\n```\n", "tags": ["SQL", "google", "bigquery", "GoogleCloudPlatform", "gcp"]}