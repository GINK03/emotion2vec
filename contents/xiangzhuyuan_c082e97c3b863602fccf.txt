{"context": "\u521a\u624d\u8bf4\u5230\u4e86 Store \n\u63a5\u4e0b\u6765\u8bf4 \u6570\u636e\u6d41\nRedux \u4f7f\u7528\u5355\u5411\u6570\u636e\u6d41\n\u8fd9\u5c31\u610f\u5473\u7740\u5728 app \u91cc\u6240\u6709\u7684\u6570\u636e\u90fd\u4f1a\u7ecf\u8fc7\u540c\u6837 \u7684\u751f\u547d\u5468\u671f\u6a21\u5f0f. \u8ba9\u4f60\u7684\u7a0b\u5e8f\u903b\u8f91\u66f4\u52a0\u53ef\u4ee5\u9884\u6d4b\u548c\u5bb9\u6613\u7406\u89e3.\u5bf9\u4e8e\u6570\u636e\u7684\u5904\u7406\u540c\u6837\u8981\u4f18\u5316\u7cbe\u534e. \u800c\u4e0d\u662f\u8ba9\u4f60\u6b7b\u5728\u591a\u4efd\u540c\u6837\u7684\u6570\u636e, \u4f60\u624b\u91cc\u7684\u6570\u636e\u540c\u6837\u80fd\u591f\u88ab\u4ed6\u4eba\u6765\u4fee\u6539. \u90fd\u4e0d\u77e5\u9053\u81ea\u5df1\u600e\u4e48\u6b7b\u7684.\n\u5982\u679c\u8fd8\u662f\u6ca1\u6709\u88ab\u8bf4\u670d,\u5efa\u8bae\u8bfb\u4e00\u4e0b 1 2 \u540c\u65f6\u5efa\u8bae\u8bfb\u4e00\u4e0b Redux \u4e0d\u7b80\u5355\u662f Flux \u7684\u53d8\u79cd\u5b83\u540c\u6837\u8bf4\u660e\u4e86\u4e00\u4e9b\u4e3a\u4ec0\u4e48\u8981\u5355\u5411\u6570\u636e\u6d41\u7684\u597d\u5904.\nRedux \u5e94\u7528\u91cc\u7684\u6570\u636e\u5927\u81f4\u4f1a\u8d704\u6b65:\n\n\u5f53\u4f60\u8c03\u7528` store.dispatch(action). \u89e6\u53d1\u4e86\u4e00\u4e2a\u52a8\u4f5c.\n\n\u4e00\u4e2a\u52a8\u4f5c\u5c31\u662f\u4e00\u4e2a\u7b80\u5355\u7684\u5bf9\u8c61,\u8bf4\u660e\u4e86\u4f1a\u53d1\u751f\u4ec0\u4e48.\n\n { type: 'LIKE_ARTICLE', articleId: 42 }\n { type: 'FETCH_USER_SUCCESS', response: { id: 3, name: 'Mary' } }\n { type: 'ADD_TODO', text: 'Read the Redux docs.' }\n\n\u63cf\u8ff0\u4e86\u4e00\u4e2a\u52a8\u4f5c, \u5df2\u7ecf\u4e00\u4e9b\u53c2\u6570\u7528\u6765\u6307\u660e\u52a8\u4f5c\u4f5c\u7528\u7684\u5bf9\u8c61.\n\u597d\u6bd4\u8fd9\u6837\u8bf4: \u4e00\u4e2a\u52a8\u4f5c\u5c31\u662f'\u67d0\u67d0\u559c\u6b22\u627e\u4e2a\u6587\u7ae0', \u770b redux \u7684\u6587\u7ae0`\u7b49\u7b49.\n\u4f60\u53ef\u4ee5\u5728 redux app \u7684\u4efb\u4f55\u5730\u65b9\u4f7f\u7528` store.dispatch(action), \u5305\u62ec\u7ec4\u4ef6\u6216\u8005 XHR \u7684\u56de\u8c03, \u751a\u81f3\u662f\u4e00\u4e2a\u5faa\u73af\u8c03\u7528.\n\nRedux store \u8c03\u7528\u4f60\u7ed9\u5b83\u7684 reducer \u51fd\u6570\n\nstore \u662f\u4f1a\u4f20\u9012\u4e24\u4e2a\u53c2\u6570\u7ed9reducer \u7684. \u7b2c\u4e00\u4e2a\u662f\u5f53\u524d\u7684\u72b6\u6001, \u7b2c\u4e8c\u4e2a\u662f action, \u7136\u540e\u8fd4\u56de action \u4f5c\u7528\u4e4b\u540e\u7684\u6700\u65b0\u72b6\u6001. \u518d\u6765\u770b\u4e2a\u4f8b\u5b50:\n let previousState = { // \u5f53\u524d\u7684\u72b6\u6001\n   visibleTodoFilter: 'SHOW_ALL',  //\u8981\u663e\u793a\u4ec0\u4e48\u7c7b\u578b\n   todos: [  //\u6240\u6709\u7684 todo\n     {\n       text: 'Read the docs.',\n       complete: false\n     }\n   ]\n }\n\n // \u8fd9\u662f\u4e00\u4e2a\u6dfb\u52a0 todo \u7684\u52a8\u4f5c\n let action = {\n   type: 'ADD_TODO',\n   text: 'Understand the flow.'\n }\n\n // \u83b7\u53d6\u6700\u65b0\u7684\u72b6\u6001\n let nextState = todoApp(previousState, action)\n\n\n\n\u4e00\u5b9a\u8981\u4fdd\u8bc1reducer \u90fd\u662f pure \u7684\u51fd\u6570,\u4e5f\u5c31\u662f\u8bf4\u6bcf\u6b21\u7ed9\u540c\u6837\u7684\u53c2\u6570\u8fd4\u56de\u7ed3\u679c\u90fd\u662f\u4e00\u6837\u7684.\n\n\n\u6839 reducer \u53ef\u4ee5\u7ec4\u5408\u591a\u4e2a reducer \u5230\u4e00\u4e2a\u5355\u72ec\u7684\u72b6\u6001\u6811\u91cc.\n\n\u5982\u4f55\u7ec4\u7ec7*\u6839 reducer *\u5b8c\u5168\u662f\u4e2a\u4eba\u559c\u597d, Redux \u63d0\u4f9b\u4e00\u4e2acombineReducers() \u51fd\u6570\u7528\u6765\u5e2e\u52a9\u7ec4\u7ec7\u5206\u6563\u7684 Reducer. \u4e0b\u9762\u518d\u770b\u770b\u4ed6\u4eec\u662f\u5982\u4f55\u88ab\u7ec4\u7ec7\u8d77\u6765\u7684:\n function todos(state = [], action) {\n   // Somehow calculate it...\n   return nextState\n }\n\n function visibleTodoFilter(state = 'SHOW_ALL', action) {\n   // Somehow calculate it...\n   return nextState\n }\n\n let todoApp = combineReducers({\n   todos,\n   visibleTodoFilter\n })\n\n\u5f53\u4f60\u89e6\u53d1\u4e00\u4e2a\u52a8\u4f5c, \u7136\u540e todoAPP \u5c31\u4f1a\u8c03\u7528\u7531combineReducers\u8fd4\u56de\u7684\u5bf9\u5e94\u7684 reducer:\nlet nextTodos = todos(state.todos, action)\nlet nextVisibleTodoFilter = visibleTodoFilter(state.visibleTodoFilter, action)\n\n\u5176\u5b9e\u4e0a\u9762\u7684\u60c5\u51b5\u5c31\u662f\u8fd4\u56de\n return {\n   todos: nextTodos,\n   visibleTodoFilter: nextVisibleTodoFilter\n }\n\n\n\n\nRedux Store \u4f1a\u628a\u6240\u6709\u7684 reducer \u8fd4\u56de\u7684 state \u5199\u4f1a\u5355\u72ec\u5b8c\u6574\u7684 state \u91cc.\n\n\u81f3\u6b64,\u7b97\u662f\u6211\u4eec\u5df2\u7ecf\u5b8c\u6210\u7684 backend \u903b\u8f91, \u63a5\u4e0b\u6765\u6211\u4eec\u4f1a\u5b66\u4e60\u5982\u4f55\u7ed3\u5408react \u5b8c\u5168 UI \u90e8\u5206.\n\nindex\nlearning Redux from todo\n\nlearning Redux from todo[1]\nlearning Redux from todo[2]\nlearning Redux from todo[3]\nlearning Redux from todo[4]\nlearning Redux from todo[5]\n\n\n\u521a\u624d\u8bf4\u5230\u4e86 [Store ](http://qiita.com/xiangzhuyuan/items/9ce23a8c9f3b26c48838)\n\n\u63a5\u4e0b\u6765\u8bf4 **\u6570\u636e\u6d41**\n\nRedux \u4f7f\u7528**\u5355\u5411\u6570\u636e\u6d41**\n\n\u8fd9\u5c31\u610f\u5473\u7740\u5728 app \u91cc\u6240\u6709\u7684\u6570\u636e\u90fd\u4f1a\u7ecf\u8fc7\u540c\u6837 \u7684\u751f\u547d\u5468\u671f\u6a21\u5f0f. \u8ba9\u4f60\u7684\u7a0b\u5e8f\u903b\u8f91\u66f4\u52a0\u53ef\u4ee5\u9884\u6d4b\u548c\u5bb9\u6613\u7406\u89e3.\u5bf9\u4e8e\u6570\u636e\u7684\u5904\u7406\u540c\u6837\u8981\u4f18\u5316\u7cbe\u534e. \u800c\u4e0d\u662f\u8ba9\u4f60\u6b7b\u5728\u591a\u4efd\u540c\u6837\u7684\u6570\u636e, \u4f60\u624b\u91cc\u7684\u6570\u636e\u540c\u6837\u80fd\u591f\u88ab\u4ed6\u4eba\u6765\u4fee\u6539. \u90fd\u4e0d\u77e5\u9053\u81ea\u5df1\u600e\u4e48\u6b7b\u7684.\n\n\u5982\u679c\u8fd8\u662f\u6ca1\u6709\u88ab\u8bf4\u670d,\u5efa\u8bae\u8bfb\u4e00\u4e0b [1](http://redux.js.org/docs/introduction/Motivation.html) [2](https://medium.com/@dan_abramov/the-case-for-flux-379b7d1982c6) \u540c\u65f6\u5efa\u8bae\u8bfb\u4e00\u4e0b[ Redux \u4e0d\u7b80\u5355\u662f Flux \u7684\u53d8\u79cd](http://redux.js.org/docs/introduction/PriorArt.html)\u5b83\u540c\u6837\u8bf4\u660e\u4e86\u4e00\u4e9b\u4e3a\u4ec0\u4e48\u8981\u5355\u5411\u6570\u636e\u6d41\u7684\u597d\u5904.\n\nRedux \u5e94\u7528\u91cc\u7684\u6570\u636e\u5927\u81f4\u4f1a\u8d704\u6b65:\n\n1. \u5f53\u4f60\u8c03\u7528` store.dispatch(action). \u89e6\u53d1\u4e86\u4e00\u4e2a\u52a8\u4f5c.\n\n\u4e00\u4e2a\u52a8\u4f5c\u5c31\u662f\u4e00\u4e2a\u7b80\u5355\u7684\u5bf9\u8c61,\u8bf4\u660e\u4e86\u4f1a\u53d1\u751f\u4ec0\u4e48.\n\n```\n\n { type: 'LIKE_ARTICLE', articleId: 42 }\n { type: 'FETCH_USER_SUCCESS', response: { id: 3, name: 'Mary' } }\n { type: 'ADD_TODO', text: 'Read the Redux docs.' }\n```\n\n\u63cf\u8ff0\u4e86\u4e00\u4e2a\u52a8\u4f5c, \u5df2\u7ecf\u4e00\u4e9b\u53c2\u6570\u7528\u6765\u6307\u660e\u52a8\u4f5c\u4f5c\u7528\u7684\u5bf9\u8c61.\n\u597d\u6bd4\u8fd9\u6837\u8bf4: \u4e00\u4e2a\u52a8\u4f5c\u5c31\u662f'\u67d0\u67d0\u559c\u6b22\u627e\u4e2a\u6587\u7ae0', \u770b redux \u7684\u6587\u7ae0`\u7b49\u7b49.\n\n**\u4f60\u53ef\u4ee5\u5728 redux app \u7684\u4efb\u4f55\u5730\u65b9\u4f7f\u7528` store.dispatch(action), \u5305\u62ec\u7ec4\u4ef6\u6216\u8005 XHR \u7684\u56de\u8c03, \u751a\u81f3\u662f\u4e00\u4e2a\u5faa\u73af\u8c03\u7528.**\n\n2. Redux store \u8c03\u7528\u4f60\u7ed9\u5b83\u7684 reducer \u51fd\u6570\n\n**store \u662f\u4f1a\u4f20\u9012\u4e24\u4e2a\u53c2\u6570\u7ed9` reducer` \u7684. \u7b2c\u4e00\u4e2a\u662f\u5f53\u524d\u7684\u72b6\u6001, \u7b2c\u4e8c\u4e2a\u662f action, \u7136\u540e\u8fd4\u56de action \u4f5c\u7528\u4e4b\u540e\u7684\u6700\u65b0\u72b6\u6001.** \u518d\u6765\u770b\u4e2a\u4f8b\u5b50:\n\n```\n let previousState = { // \u5f53\u524d\u7684\u72b6\u6001\n   visibleTodoFilter: 'SHOW_ALL',  //\u8981\u663e\u793a\u4ec0\u4e48\u7c7b\u578b\n   todos: [  //\u6240\u6709\u7684 todo\n     {\n       text: 'Read the docs.',\n       complete: false\n     }\n   ]\n }\n\n // \u8fd9\u662f\u4e00\u4e2a\u6dfb\u52a0 todo \u7684\u52a8\u4f5c\n let action = {\n   type: 'ADD_TODO',\n   text: 'Understand the flow.'\n }\n\n // \u83b7\u53d6\u6700\u65b0\u7684\u72b6\u6001\n let nextState = todoApp(previousState, action)\n\n\n```\n\n\u4e00\u5b9a\u8981\u4fdd\u8bc1` reducer` \u90fd\u662f **pure** \u7684\u51fd\u6570,\u4e5f\u5c31\u662f\u8bf4\u6bcf\u6b21\u7ed9\u540c\u6837\u7684\u53c2\u6570\u8fd4\u56de\u7ed3\u679c\u90fd\u662f\u4e00\u6837\u7684.\n \n 3. **\u6839 reducer** \u53ef\u4ee5\u7ec4\u5408\u591a\u4e2a reducer \u5230\u4e00\u4e2a\u5355\u72ec\u7684\u72b6\u6001\u6811\u91cc.\n\n\u5982\u4f55\u7ec4\u7ec7*\u6839 reducer *\u5b8c\u5168\u662f\u4e2a\u4eba\u559c\u597d, Redux \u63d0\u4f9b\u4e00\u4e2a` combineReducers()` \u51fd\u6570\u7528\u6765\u5e2e\u52a9\u7ec4\u7ec7\u5206\u6563\u7684 Reducer. \u4e0b\u9762\u518d\u770b\u770b\u4ed6\u4eec\u662f\u5982\u4f55\u88ab\u7ec4\u7ec7\u8d77\u6765\u7684:\n\n\n```\n function todos(state = [], action) {\n   // Somehow calculate it...\n   return nextState\n }\n\n function visibleTodoFilter(state = 'SHOW_ALL', action) {\n   // Somehow calculate it...\n   return nextState\n }\n\n let todoApp = combineReducers({\n   todos,\n   visibleTodoFilter\n })\n```\n\n\u5f53\u4f60\u89e6\u53d1\u4e00\u4e2a\u52a8\u4f5c, \u7136\u540e todoAPP \u5c31\u4f1a\u8c03\u7528\u7531`combineReducers`\u8fd4\u56de\u7684\u5bf9\u5e94\u7684 reducer:\n\n\n```\nlet nextTodos = todos(state.todos, action)\nlet nextVisibleTodoFilter = visibleTodoFilter(state.visibleTodoFilter, action)\n```\n\n\u5176\u5b9e\u4e0a\u9762\u7684\u60c5\u51b5\u5c31\u662f\u8fd4\u56de\n\n```\n return {\n   todos: nextTodos,\n   visibleTodoFilter: nextVisibleTodoFilter\n }\n\n```\n\n4. **Redux Store** \u4f1a\u628a\u6240\u6709\u7684 **reducer** \u8fd4\u56de\u7684 state \u5199\u4f1a\u5355\u72ec\u5b8c\u6574\u7684 state \u91cc.\n\n \n\u81f3\u6b64,\u7b97\u662f\u6211\u4eec\u5df2\u7ecf\u5b8c\u6210\u7684 backend \u903b\u8f91, \u63a5\u4e0b\u6765\u6211\u4eec\u4f1a\u5b66\u4e60\u5982\u4f55\u7ed3\u5408` react` \u5b8c\u5168 UI \u90e8\u5206.\n\n\n\n---\n\n\nindex\n\nlearning Redux from todo\n\n- [learning Redux from todo[1]](http://qiita.com/xiangzhuyuan/items/a26e97c6cac476369e37)\n- [learning Redux from todo[2]](http://qiita.com/xiangzhuyuan/items/86c5c6508e8481c2dd3a)\n- [learning Redux from todo[3]](http://qiita.com/xiangzhuyuan/items/9ce23a8c9f3b26c48838)\n- [learning Redux from todo[4]](http://qiita.com/xiangzhuyuan/items/c082e97c3b863602fccf)\n- [learning Redux from todo[5]](http://qiita.com/xiangzhuyuan/items/4e6f61a27c068b4f33e7)\n\n", "tags": ["redux"]}