{"context": " More than 1 year has passed since last update.\u30e6\u30cb\u30d0\u30fc\u30b5\u30eb\u30a2\u30ca\u30ea\u30c6\u30a3\u30af\u30b9\u7528\u306e e\u30b3\u30de\u30fc\u30b9\u30bf\u30b0\u306e\u8a2d\u5b9a\u3067\u3059\u3002\n\u96fb\u8eca\u306e\u4e2d\u3067\u66f8\u3044\u305f\u306e\u3067\u3001\u307e\u3060\u52d5\u4f5c\u78ba\u8a8d\u3057\u3066\u3044\u307e\u305b\u3093\u3002\u3054\u5229\u7528\u306f\u81ea\u5df1\u8cac\u4efb\u3067m(_ _)m\n\ndata/class/pages/shopping/LC_Page_Shopping_Complete.php\n    /**\n     * Page \u306e\u30a2\u30af\u30b7\u30e7\u30f3.\n     *\n     * @return void\n     */\n    public function action()\n    {\n        $this->arrInfo = SC_Helper_DB_Ex::sfGetBasisData();\n        $objPurchase = new SC_Helper_Purchase_Ex();\n        // e\u30b3\u30de\u30fc\u30b9\u30b3\u30f3\u30d0\u30fc\u30b8\u30e7\u30f3\u30bf\u30b0\u7528\u8a2d\u5b9a\n        if (is_numeric($_SESSION['order_id'])) {\n            $this->arrOrder = $objPurchase->getOrder($_SESSION['order_id']);\n            $this->arrOrderDetail = $objPurchase->getOrderDetail($_SESSION['order_id']);\n        }\n    }\n\n\n\n2.4\u7cfb\u306e\u5834\u5408\u306f\u4ee5\u4e0b\u306e\u51e6\u7406\u3067\u3044\u3051\u308b\u306f\u305a\n        // 2.4\u7cfb\u306e\u5834\u5408\u306f\u4ee5\u4e0b 120\u884c\u76ee\u4ed8\u8fd1\n        $objQuery = new SC_Query();\n        $arrOrder = $objQuery->select('*', 'dtb_order', 'order_id = ?', array($_SESSION['order_id']));\n        $this->arrOrder = $arrOrder[0];\n        $this->arrOrderDetail = $objQuery->select('*', 'dtb_order_detail', 'order_id = ?', array($_SESSION['order_id']));\n\n\n\ndata/Smarty/templates/xxxx/site_main.tpl\nbody \u76f4\u4e0b\u306b\u914d\u7f6e\u3057\u307e\u3059.\nPC\u7528\u3001\u30b9\u30de\u30fc\u30c8\u30d5\u30a9\u30f3\u7528\u305d\u308c\u305e\u308c\u306e\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u306b\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n        <script>\n          (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){\n          (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),\n          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)\n          })(window,document,'script','//www.google-analytics.com/analytics.js','ga');\n\n          ga('create', 'UA-XXXXXXX-X', 'auto');\n          ga('require', 'ecommerce', 'ecommerce.js');\n          ga('send', 'pageview');\n\n          <!--{if $smarty.server.$PHP_SELF == \"`$smarty.const.ROOT_URLPATH`shopping/complete.php\" && $arrOrder|@count > 0 && $arrOrderDetail|@count > 0}-->\n            ga('ecommerce:addTransaction', {\n               'id': '<!--{$arrOrder.order_id|h}-->',              // Transaction ID. Required.\n               'affiliation': '<!--{$arrSiteInfo.shop_name|h}-->', // Affiliation or store name.\n               'revenue': '<!--{$arrOrder.payment_total|h}-->',    // Grand Total.\n            });\n\n            <!--{foreach from=$arrOrderDetail item=orderDetail name=orderDetail}-->\n                ga('ecommerce:addItem', {\n                   'id': '<!--{$arrOrder.order_id|h}-->',          // Transaction ID. Required.\n                   'name': '<!--{$orderDetail.product_name|h}--><!--{if $orderDetail.classcategory_name1 != \"\"}--> / <!--{$orderDetail.classcategory_name1|h}--><!--{/if}--><!--{if $orderDetail.classcategory_name2 != \"\"}--> / <!--{$orderDetail.classcategory_name2|h}--><!--{/if}-->', // Product name. Required.\n                   'sku': '<!--{$orderDetail.product_code|h}-->',  // SKU/code.\n                   'price': '<!--{$orderDetail.price|h}-->',       // Unit price.\n                   'quantity': '<!--{$orderDetail.quantity|h}-->'  // Quantity.\n                });\n            <!--{/foreach}-->\n            ga('ecommerce:send');\n          <!--{/if}-->\n        </script>\n\n\n\u30e6\u30cb\u30d0\u30fc\u30b5\u30eb\u30a2\u30ca\u30ea\u30c6\u30a3\u30af\u30b9\u7528\u306e e\u30b3\u30de\u30fc\u30b9\u30bf\u30b0\u306e\u8a2d\u5b9a\u3067\u3059\u3002\n\n*\u96fb\u8eca\u306e\u4e2d\u3067\u66f8\u3044\u305f\u306e\u3067\u3001\u307e\u3060\u52d5\u4f5c\u78ba\u8a8d\u3057\u3066\u3044\u307e\u305b\u3093\u3002\u3054\u5229\u7528\u306f\u81ea\u5df1\u8cac\u4efb\u3067m(_ _)m*\n\n## data/class/pages/shopping/LC_Page_Shopping_Complete.php\n\n```php\n    /**\n     * Page \u306e\u30a2\u30af\u30b7\u30e7\u30f3.\n     *\n     * @return void\n     */\n    public function action()\n    {\n        $this->arrInfo = SC_Helper_DB_Ex::sfGetBasisData();\n        $objPurchase = new SC_Helper_Purchase_Ex();\n        // e\u30b3\u30de\u30fc\u30b9\u30b3\u30f3\u30d0\u30fc\u30b8\u30e7\u30f3\u30bf\u30b0\u7528\u8a2d\u5b9a\n        if (is_numeric($_SESSION['order_id'])) {\n            $this->arrOrder = $objPurchase->getOrder($_SESSION['order_id']);\n            $this->arrOrderDetail = $objPurchase->getOrderDetail($_SESSION['order_id']);\n        }\n    }\n\n```\n\n#### 2.4\u7cfb\u306e\u5834\u5408\u306f\u4ee5\u4e0b\u306e\u51e6\u7406\u3067\u3044\u3051\u308b\u306f\u305a\n\n```php\n        // 2.4\u7cfb\u306e\u5834\u5408\u306f\u4ee5\u4e0b 120\u884c\u76ee\u4ed8\u8fd1\n        $objQuery = new SC_Query();\n        $arrOrder = $objQuery->select('*', 'dtb_order', 'order_id = ?', array($_SESSION['order_id']));\n        $this->arrOrder = $arrOrder[0];\n        $this->arrOrderDetail = $objQuery->select('*', 'dtb_order_detail', 'order_id = ?', array($_SESSION['order_id']));\n\n```\n## data/Smarty/templates/xxxx/site_main.tpl\n\nbody \u76f4\u4e0b\u306b\u914d\u7f6e\u3057\u307e\u3059.\nPC\u7528\u3001\u30b9\u30de\u30fc\u30c8\u30d5\u30a9\u30f3\u7528\u305d\u308c\u305e\u308c\u306e\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u306b\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n\n```html\n        <script>\n          (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){\n          (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),\n          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)\n          })(window,document,'script','//www.google-analytics.com/analytics.js','ga');\n\n          ga('create', 'UA-XXXXXXX-X', 'auto');\n          ga('require', 'ecommerce', 'ecommerce.js');\n          ga('send', 'pageview');\n\n          <!--{if $smarty.server.$PHP_SELF == \"`$smarty.const.ROOT_URLPATH`shopping/complete.php\" && $arrOrder|@count > 0 && $arrOrderDetail|@count > 0}-->\n            ga('ecommerce:addTransaction', {\n               'id': '<!--{$arrOrder.order_id|h}-->',              // Transaction ID. Required.\n               'affiliation': '<!--{$arrSiteInfo.shop_name|h}-->', // Affiliation or store name.\n               'revenue': '<!--{$arrOrder.payment_total|h}-->',    // Grand Total.\n            });\n\n            <!--{foreach from=$arrOrderDetail item=orderDetail name=orderDetail}-->\n                ga('ecommerce:addItem', {\n                   'id': '<!--{$arrOrder.order_id|h}-->',          // Transaction ID. Required.\n                   'name': '<!--{$orderDetail.product_name|h}--><!--{if $orderDetail.classcategory_name1 != \"\"}--> / <!--{$orderDetail.classcategory_name1|h}--><!--{/if}--><!--{if $orderDetail.classcategory_name2 != \"\"}--> / <!--{$orderDetail.classcategory_name2|h}--><!--{/if}-->', // Product name. Required.\n                   'sku': '<!--{$orderDetail.product_code|h}-->',  // SKU/code.\n                   'price': '<!--{$orderDetail.price|h}-->',       // Unit price.\n                   'quantity': '<!--{$orderDetail.quantity|h}-->'  // Quantity.\n                });\n            <!--{/foreach}-->\n            ga('ecommerce:send');\n          <!--{/if}-->\n        </script>\n\n```\n", "tags": ["EC-CUBE2.13 \u7cfb", "GoogleAnalytics"]}