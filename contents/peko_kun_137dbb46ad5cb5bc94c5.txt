{"context": " More than 1 year has passed since last update.\n\n\u3084\u308b\u3053\u3068\nZabbix-2.2\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\n\u30b5\u30fc\u30d0\u306f\u4ee5\u4e0b\u306e\u69cb\u6210\u3067\u3059\u3002\nOS\uff1a CentOS 6.5\nDB\uff1a PostgreSQL 8.4.20\nWebServer\uff1a Nginx 1.4.6\n\u516c\u5f0f\u30de\u30cb\u30e5\u30a2\u30eb\u3084\u300cZabbix \u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u300d\u3067\u30b0\u30b0\u308b\u3068\u3001MySQL+Apache\u306e\u7d44\u307f\u5408\u308f\u305b\u3060\u3063\u305f\u306e\u3067\u3001\u5fd8\u308c\u306a\u3044\u3088\u3046\u306b\u30e1\u30e2\u3067\u3059\u3002\n\u57fa\u672c\u7684\u306b\u306f\u516c\u5f0f\u30de\u30cb\u30e5\u30a2\u30eb\u306eInstallation\u3092\u53c2\u8003\u306b\u3057\u307e\u3057\u305f\u3002\n\u3042\u3068\u3001package\u304b\u3089\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3057\u305f\u3002\n\u306a\u306e\u3067Installation from packages\u3092\u53c2\u7167\u3057\u307e\u3057\u305f\u3002\n\u3053\u3061\u3089\u306e\u30d6\u30ed\u30b0\u3082\u53c2\u8003\u306b\u3057\u307e\u3057\u305f\u3002\nZabbix 2.2 \u3092 yum\u3067\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\uff08Linux CentOS6.4\uff09\n\n\u624b\u9806\n\n1. yum\u30ea\u30dd\u30b8\u30c8\u30ea\u3092\u767b\u9332\n# rpm -ivh http://repo.zabbix.com/zabbix/2.2/rhel/6/x86_64/zabbix-release-2.2-1.el6.noarch.rpm\n\n\n2. Zabbix\u30d1\u30c3\u30b1\u30fc\u30b8\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n# yum install zabbix-server-pgsql zabbix-web-pgsql zabbix-web-japanese\n# yum install zabbix-agent\n# yum install zabbix-get\n\nPostgreSQL\u306a\u306e\u3067*-pgsql\u3092\nFront Web\u3067\u65e5\u672c\u8a9e\u3092\u4f7f\u3048\u308b\u3088\u3046\u306b\u3059\u308b\u305f\u3081\u306bzabbix-web-japanese\u3092\n\u3042\u308b\u3068\u4f55\u304b\u3068\u4fbf\u5229\u3089\u3057\u3044zabbix-get\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3057\u305f\u3002\n\n3. \u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u521d\u671f\u5316\nZabbix\u7528\u306e\u30e6\u30fc\u30b6\u3068DB\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\nDB\u306fzabbix\u30e6\u30fc\u30b6\u3092\u30aa\u30fc\u30ca\u30fc\u306b\u3057\u307e\u3057\u305f\u3002\n\u30e6\u30fc\u30b6\u4f5c\u6210\u6642\u306b\u805e\u304b\u308c\u308b\u30ed\u30fc\u30eb\u306f\u5168\u3066No\u3067\u3059\u3002\n# createuser -W zabbix\n# createdb -O zabix zabbix\n\n\u30c6\u30fc\u30d6\u30eb\u3092\u4f5c\u6210\u3057\u3066\u3001\u521d\u671f\u30c7\u30fc\u30bf\u3092\u767b\u9332\u3057\u307e\u3059\u3002\n# cd /usr/share/doc/zabbix-server-pgsql-2.2.3/create\n# psql -W -d zabbix -f schema.sql zabbix\n# psql -W -d zabbix -f images.sql zabbix\n# psql -W -d zabbix -f data.sql zabbix\n\n\n4. Zabbix\u306e\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3092\u7de8\u96c6\nZabbix\u306e\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3092DB\u306b\u5408\u308f\u305b\u3066\u7de8\u96c6\u3057\u307e\u3059\u3002\nDBName, DBUser\u306f\u30c7\u30d5\u30a9\u30eb\u30c8\u3067OK\u3067\u3057\u305f\u3002\nDBPort\u306fPostgreSQL\u306e\u30dd\u30fc\u30c8\u3092\u6307\u5b9a\u3057\u307e\u3059\u3002\nDBName=zabbix\nDBUser=zabbix\nDBPassword=<password>\nDBPort=5432\n\n\n5. PostgreSQL\u306epg_hba.conf\u3092\u7de8\u96c6\nlocalhost\u304b\u3089\u306e\u63a5\u7d9a\u3092\u8a31\u53ef\u3059\u308b\u3088\u3046\u306bident\u3092trust\u306b\u5909\u66f4\u3057\u307e\u3057\u305f\u3002\n127.0.0.1/32 trust\u3060\u3051\u3067\u3044\u3044\u306e\u304b\u3068\u601d\u3044\u307e\u3057\u305f\u304c\u3060\u3081\u3060\u3063\u305f\u306e\u3067\u3001::1/128\u3082trust\u306b\u3057\u307e\u3057\u305f\u3002\nhost    all         all         127.0.0.1/32          trust\nhost    all         all         ::1/128               trust\n\nZabbix\u304b\u3089PostgreSQL\u306b\u63a5\u7d9a\u3067\u304d\u306a\u3044\u5834\u5408\u3001\u4e0b\u306e\u3088\u3046\u306a\u30e1\u30c3\u30bb\u30fc\u30b8\u304czabbix_server.log\u306b\u51fa\u529b\u3055\u308c\u307e\u3059\u3002\n 31936:20140415:202234.778 [Z3001] connection to database 'zabbix' failed: [0] FATAL:  Ident authentication failed for user \"zabbix\"\n\n\n6. Zabbix\u30b5\u30fc\u30d0\u3092\u8d77\u52d5\n# service zabbix-server start\n\n7. Nginx\u3067PHP\u3092\u52d5\u304b\u305b\u308b\u3088\u3046\u306b\u3059\u308b\nCentOS\u306b\u3066nginx\u3067PHP\u3092\u52d5\u304b\u3059\n\u3053\u3061\u3089\u3092\u53c2\u8003\u306b\u3001php-fpm \u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u3066Nginx\u3067PHP\u3092\u52d5\u304b\u305b\u308b\u3088\u3046\u306b\u3057\u307e\u3057\u305f\u3002\nfastcgi-param\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u3057\u307e\u3057\u305f\u3002\nfastcgi_param  SCRIPT_FILENAME  $document_root$fastcgi_script_name;\n\n8. /etc/zabbix/web\u306e\u30aa\u30fc\u30ca\u30fc\u3092\u5909\u66f4\u3059\u308b\n/etc/zabbix/web \u306e\u30aa\u30fc\u30ca\u30fc\u3001\u30b0\u30eb\u30fc\u30d7\u304capache\u306b\u306a\u3063\u3066\u3044\u308b\u306e\u3067nginx\u306b\u5909\u66f4\u3057\u307e\u3059\u3002\n# chown nginx:nginx /etc/zabbix/web\n\u5909\u66f4\u3057\u306a\u3044\u3067\u30a2\u30af\u30bb\u30b9\u3059\u308b\u3068\u4e0b\u306e\u3088\u3046\u306a\u30e1\u30c3\u30bb\u30fc\u30b8\u304cNginx\u306e\u30a8\u30e9\u30fc\u30ed\u30b0\u306b\u51fa\u529b\u3055\u308c\u307e\u3057\u305f\u3002\n2014/04/15 22:57:20 [error] 1850#0: *16 FastCGI sent in stderr: \"PHP message: PHP Warning:  require_once(/etc/zabbix/web/maintenance.inc.php): failed to open stream: Permission denied in /usr/share/nginx/html/zabbix/include/classes/core/ZBase.php on line 276\nPHP message: PHP Fatal error:  require_once(): Failed opening required '/etc/zabbix/web/maintenance.inc.php' \n(\u4ee5\u4e0b\u7701\u7565)\n\n\n9. Nginx\u306edocument_root\u306bzabbix\u3078\u306e\u30ea\u30f3\u30af\u3092\u5f35\u308b\n# cd /usr/share/nginx/html\n# ln -s /usr/share/zabbix .\n\n\n10. \u30d6\u30e9\u30a6\u30b6\u3067\u30a2\u30af\u30bb\u30b9\u3057\u3066\u521d\u671f\u8a2d\u5b9a\u3092\u3059\u308b\nhttp://hostname/zabbix/index.php\n\u521d\u671f\u8a2d\u5b9a\u6642\u306bPHP\u306e\u8a2d\u5b9a\u3067\u6761\u4ef6\u3092\u6e80\u305f\u3057\u3066\u3044\u306a\u3044\u3068\u5148\u306b\u9032\u3081\u307e\u305b\u3093\u3002\n/etc/php.ini \u3092\u7de8\u96c6\u3057\u3066\u3001php-fpm\u3092\u518d\u8d77\u52d5\u3057\u307e\u3057\u305f\u3002\n\n\u304a\u308f\u308a\u306b\nNginx\u3067\u306ePHP\u8a2d\u5b9a\u304c\u3044\u307e\u3044\u3061\u306a\u611f\u3058\u3067\u3059\u3002\n\u3042\u3068\u3001Zabbix\u8981\u4ef6\u3092\u6e80\u305f\u3059\u305f\u3081\u306b/etc/php.ini\u3092\u7de8\u96c6\u3057\u305f\u306e\u3067\u3059\u304c\u3001\u4ed6\u306e\u65b9\u6cd5\u304c\u306a\u3044\u304b\u6c17\u306b\u306a\u308a\u307e\u3059\u3002\nApache\u3060\u3068Directory\u30c7\u30a3\u30ec\u30af\u30c6\u30a3\u30d6\u306bphp_value memory_limit 128M\u306e\u3088\u3046\u306a\u8a2d\u5b9a\u304c\u3067\u304d\u308b\u3089\u3057\u3044\u3067\u3059\u3002\n\u3069\u3046\u3057\u305f\u3089\u3088\u3044\u306e\u3060\u308d\u3046\uff1f\n\n## \u3084\u308b\u3053\u3068\n\nZabbix-2.2\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\n\n\u30b5\u30fc\u30d0\u306f\u4ee5\u4e0b\u306e\u69cb\u6210\u3067\u3059\u3002\nOS\uff1a CentOS 6.5\nDB\uff1a PostgreSQL 8.4.20\nWebServer\uff1a Nginx 1.4.6\n\n[\u516c\u5f0f\u30de\u30cb\u30e5\u30a2\u30eb](https://www.zabbix.com/documentation/2.2)\u3084\u300cZabbix \u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u300d\u3067\u30b0\u30b0\u308b\u3068\u3001MySQL+Apache\u306e\u7d44\u307f\u5408\u308f\u305b\u3060\u3063\u305f\u306e\u3067\u3001\u5fd8\u308c\u306a\u3044\u3088\u3046\u306b\u30e1\u30e2\u3067\u3059\u3002\n\n\u57fa\u672c\u7684\u306b\u306f\u516c\u5f0f\u30de\u30cb\u30e5\u30a2\u30eb\u306e[Installation](https://www.zabbix.com/documentation/2.2/manual/installation)\u3092\u53c2\u8003\u306b\u3057\u307e\u3057\u305f\u3002\n\u3042\u3068\u3001package\u304b\u3089\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3057\u305f\u3002\n\u306a\u306e\u3067[Installation from packages](https://www.zabbix.com/documentation/2.2/manual/installation/install_from_packages)\u3092\u53c2\u7167\u3057\u307e\u3057\u305f\u3002\n\u3053\u3061\u3089\u306e\u30d6\u30ed\u30b0\u3082\u53c2\u8003\u306b\u3057\u307e\u3057\u305f\u3002\n[Zabbix 2.2 \u3092 yum\u3067\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\uff08Linux CentOS6.4\uff09](http://arpanet617.blog.fc2.com/blog-entry-53.html)\n\n## \u624b\u9806\n\n#### 1. yum\u30ea\u30dd\u30b8\u30c8\u30ea\u3092\u767b\u9332\n\n```\n# rpm -ivh http://repo.zabbix.com/zabbix/2.2/rhel/6/x86_64/zabbix-release-2.2-1.el6.noarch.rpm\n```\n\n#### 2. Zabbix\u30d1\u30c3\u30b1\u30fc\u30b8\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n```\n# yum install zabbix-server-pgsql zabbix-web-pgsql zabbix-web-japanese\n# yum install zabbix-agent\n# yum install zabbix-get\n```\n\nPostgreSQL\u306a\u306e\u3067*-pgsql\u3092\nFront Web\u3067\u65e5\u672c\u8a9e\u3092\u4f7f\u3048\u308b\u3088\u3046\u306b\u3059\u308b\u305f\u3081\u306bzabbix-web-japanese\u3092\n\u3042\u308b\u3068\u4f55\u304b\u3068\u4fbf\u5229\u3089\u3057\u3044zabbix-get\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3057\u305f\u3002\n\n#### 3. \u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u521d\u671f\u5316\n\nZabbix\u7528\u306e\u30e6\u30fc\u30b6\u3068DB\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\nDB\u306fzabbix\u30e6\u30fc\u30b6\u3092\u30aa\u30fc\u30ca\u30fc\u306b\u3057\u307e\u3057\u305f\u3002\n\u30e6\u30fc\u30b6\u4f5c\u6210\u6642\u306b\u805e\u304b\u308c\u308b\u30ed\u30fc\u30eb\u306f\u5168\u3066No\u3067\u3059\u3002\n\n```\n# createuser -W zabbix\n# createdb -O zabix zabbix\n```\n\n\u30c6\u30fc\u30d6\u30eb\u3092\u4f5c\u6210\u3057\u3066\u3001\u521d\u671f\u30c7\u30fc\u30bf\u3092\u767b\u9332\u3057\u307e\u3059\u3002\n\n```\n# cd /usr/share/doc/zabbix-server-pgsql-2.2.3/create\n# psql -W -d zabbix -f schema.sql zabbix\n# psql -W -d zabbix -f images.sql zabbix\n# psql -W -d zabbix -f data.sql zabbix\n```\n\n#### 4. Zabbix\u306e\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3092\u7de8\u96c6\n\nZabbix\u306e\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3092DB\u306b\u5408\u308f\u305b\u3066\u7de8\u96c6\u3057\u307e\u3059\u3002\nDBName, DBUser\u306f\u30c7\u30d5\u30a9\u30eb\u30c8\u3067OK\u3067\u3057\u305f\u3002\nDBPort\u306fPostgreSQL\u306e\u30dd\u30fc\u30c8\u3092\u6307\u5b9a\u3057\u307e\u3059\u3002\n\n```\nDBName=zabbix\nDBUser=zabbix\nDBPassword=<password>\nDBPort=5432\n```\n\n#### 5. PostgreSQL\u306epg_hba.conf\u3092\u7de8\u96c6\n\nlocalhost\u304b\u3089\u306e\u63a5\u7d9a\u3092\u8a31\u53ef\u3059\u308b\u3088\u3046\u306bident\u3092trust\u306b\u5909\u66f4\u3057\u307e\u3057\u305f\u3002\n127.0.0.1/32 trust\u3060\u3051\u3067\u3044\u3044\u306e\u304b\u3068\u601d\u3044\u307e\u3057\u305f\u304c\u3060\u3081\u3060\u3063\u305f\u306e\u3067\u3001::1/128\u3082trust\u306b\u3057\u307e\u3057\u305f\u3002\n\n```\nhost    all         all         127.0.0.1/32          trust\nhost    all         all         ::1/128               trust\n```\n\nZabbix\u304b\u3089PostgreSQL\u306b\u63a5\u7d9a\u3067\u304d\u306a\u3044\u5834\u5408\u3001\u4e0b\u306e\u3088\u3046\u306a\u30e1\u30c3\u30bb\u30fc\u30b8\u304czabbix_server.log\u306b\u51fa\u529b\u3055\u308c\u307e\u3059\u3002\n\n```\n 31936:20140415:202234.778 [Z3001] connection to database 'zabbix' failed: [0] FATAL:  Ident authentication failed for user \"zabbix\"\n```\n\n#### 6. Zabbix\u30b5\u30fc\u30d0\u3092\u8d77\u52d5\n\n`# service zabbix-server start`\n\n#### 7. Nginx\u3067PHP\u3092\u52d5\u304b\u305b\u308b\u3088\u3046\u306b\u3059\u308b\n\n[CentOS\u306b\u3066nginx\u3067PHP\u3092\u52d5\u304b\u3059](http://qiita.com/utano320/items/36b6eac2bbd5bb5657f6)\n\u3053\u3061\u3089\u3092\u53c2\u8003\u306b\u3001php-fpm \u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u3066Nginx\u3067PHP\u3092\u52d5\u304b\u305b\u308b\u3088\u3046\u306b\u3057\u307e\u3057\u305f\u3002\nfastcgi-param\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u3057\u307e\u3057\u305f\u3002\n`fastcgi_param  SCRIPT_FILENAME  $document_root$fastcgi_script_name;`\n\n#### 8. /etc/zabbix/web\u306e\u30aa\u30fc\u30ca\u30fc\u3092\u5909\u66f4\u3059\u308b\n\n/etc/zabbix/web \u306e\u30aa\u30fc\u30ca\u30fc\u3001\u30b0\u30eb\u30fc\u30d7\u304capache\u306b\u306a\u3063\u3066\u3044\u308b\u306e\u3067nginx\u306b\u5909\u66f4\u3057\u307e\u3059\u3002\n`# chown nginx:nginx /etc/zabbix/web`\n\n\u5909\u66f4\u3057\u306a\u3044\u3067\u30a2\u30af\u30bb\u30b9\u3059\u308b\u3068\u4e0b\u306e\u3088\u3046\u306a\u30e1\u30c3\u30bb\u30fc\u30b8\u304cNginx\u306e\u30a8\u30e9\u30fc\u30ed\u30b0\u306b\u51fa\u529b\u3055\u308c\u307e\u3057\u305f\u3002\n\n```\n2014/04/15 22:57:20 [error] 1850#0: *16 FastCGI sent in stderr: \"PHP message: PHP Warning:  require_once(/etc/zabbix/web/maintenance.inc.php): failed to open stream: Permission denied in /usr/share/nginx/html/zabbix/include/classes/core/ZBase.php on line 276\nPHP message: PHP Fatal error:  require_once(): Failed opening required '/etc/zabbix/web/maintenance.inc.php' \n(\u4ee5\u4e0b\u7701\u7565)\n```\n\n#### 9. Nginx\u306edocument_root\u306bzabbix\u3078\u306e\u30ea\u30f3\u30af\u3092\u5f35\u308b\n\n```\n# cd /usr/share/nginx/html\n# ln -s /usr/share/zabbix .\n```\n\n#### 10. \u30d6\u30e9\u30a6\u30b6\u3067\u30a2\u30af\u30bb\u30b9\u3057\u3066\u521d\u671f\u8a2d\u5b9a\u3092\u3059\u308b\n\nhttp://hostname/zabbix/index.php\n\n\u521d\u671f\u8a2d\u5b9a\u6642\u306bPHP\u306e\u8a2d\u5b9a\u3067\u6761\u4ef6\u3092\u6e80\u305f\u3057\u3066\u3044\u306a\u3044\u3068\u5148\u306b\u9032\u3081\u307e\u305b\u3093\u3002\n/etc/php.ini \u3092\u7de8\u96c6\u3057\u3066\u3001php-fpm\u3092\u518d\u8d77\u52d5\u3057\u307e\u3057\u305f\u3002\n\n## \u304a\u308f\u308a\u306b\n\nNginx\u3067\u306ePHP\u8a2d\u5b9a\u304c\u3044\u307e\u3044\u3061\u306a\u611f\u3058\u3067\u3059\u3002\n\u3042\u3068\u3001Zabbix\u8981\u4ef6\u3092\u6e80\u305f\u3059\u305f\u3081\u306b/etc/php.ini\u3092\u7de8\u96c6\u3057\u305f\u306e\u3067\u3059\u304c\u3001\u4ed6\u306e\u65b9\u6cd5\u304c\u306a\u3044\u304b\u6c17\u306b\u306a\u308a\u307e\u3059\u3002\nApache\u3060\u3068Directory\u30c7\u30a3\u30ec\u30af\u30c6\u30a3\u30d6\u306b`php_value memory_limit 128M`\u306e\u3088\u3046\u306a\u8a2d\u5b9a\u304c\u3067\u304d\u308b\u3089\u3057\u3044\u3067\u3059\u3002\n\u3069\u3046\u3057\u305f\u3089\u3088\u3044\u306e\u3060\u308d\u3046\uff1f\n", "tags": ["zabbix2.2"]}