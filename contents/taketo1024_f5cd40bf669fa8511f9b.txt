{"context": "\u3069\u3046\u3082\u3001\u4f50\u91ce\u3067\u3059\u3002\u524d\u56de\u306f $n$ \u6642\u9593\u6642\u8a08\u306e\u74b0 $\\mathbb{Z}_ n$ \u3092\u4f5c\u308a\u3001 $n = 5$ \u306e\u3068\u304d\u3053\u308c\u304c\u4f53\u3068\u306a\u308b\u3053\u3068\u3092\u898b\u307e\u3057\u305f\u3002\u4eca\u56de\u306f $\\mathbb{Z}_ n$ \u304c\u4f53\u3068\u306a\u308b\u6761\u4ef6\u3092\u660e\u3089\u304b\u306b\u3057\u3001\u305d\u306e\u4f53\u3092\u30d7\u30ed\u30b0\u30e9\u30e0\u3067\u5b9f\u73fe\u3057\u307e\u3057\u3087\u3046\u3002\n\n\u76ee\u6b21\uff1a\n\n\u6570\u3068\u306f\u4f55\u304b\uff1f\n\u7fa4\u30fb\u74b0\u30fb\u4f53\u306e\u5b9a\u7fa9\n\u6709\u7406\u6570\u3092\u4f5c\u3063\u3066\u307f\u3088\u3046\n\u6642\u8a08\u306e\u4e16\u754c\u306e\u300c\u74b0\u300d\n\n\u5c0f\u3055\u306a\u300c\u4f53\u300d\u3092\u4f5c\u308d\u3046 \u2190 \u30a4\u30de\u30b3\u30b3 \n\u591a\u9805\u5f0f\u306f\u6574\u6570\u306b\u3088\u304f\u4f3c\u3066\u308b\n\u4ee3\u6570\u62e1\u5927\u3067\u6570\u3092\u4f5c\u308d\u3046\uff01\n\n\n\u5270\u4f59\u74b0\u304c\u4f53\u306b\u306a\u308b\u6761\u4ef6\u306f\uff1f\n\u524d\u56de Z_5 \u306f\u4f53\u3067 Z_6 \u306f\u4f53\u3067\u306a\u3044\u3053\u3068\u78ba\u8a8d\u3057\u307e\u3057\u305f\u3002\nn = 2 ... 10 \u306e\u7bc4\u56f2\u3067 Z_<n> \u306e\u4e57\u6cd5\u8868\u3092\u51fa\u529b\u3057\u3066\u307f\u307e\u3057\u3087\u3046\u3002 Z_<n> \u304c\u4f53\u306b\u306a\u308b\u3068\u3044\u3046\u3053\u3068\u306f\u300c$0$ \u4ee5\u5916\u306e\u5168\u3066\u306e\u6570\u306f\u3001\u639b\u3051\u3066 $1$ \u306b\u306a\u308b\u6570\uff08\u9006\u6570\uff09\u304c\u3042\u308b\u300d\u3068\u3044\u3046\u3053\u3068\u3067\u3059\u3002\u884c\u3092\u9806\u756a\u306b\u898b\u3066\u884c\u3063\u3066\u3001\u4e00\u3064\u3067\u3082 1 \u3092\u542b\u307e\u306a\u3044\u3082\u306e\u304c\u3042\u3063\u305f\u3089 NG \u3067\u3059\u3002\nn = 2:\n\n*   |   0   1\n--------------\n0   |   0   0\n1   |   0   1\n\nn = 3:\n\n*   |   0   1   2\n------------------\n0   |   0   0   0\n1   |   0   1   2\n2   |   0   2   1\n\nn = 4:\n\n*   |   0   1   2   3\n----------------------\n0   |   0   0   0   0\n1   |   0   1   2   3\n2   |   0   2   0   2   // NG\n3   |   0   3   2   1\n\nn = 5:\n\n*   |   0   1   2   3   4\n--------------------------\n0   |   0   0   0   0   0\n1   |   0   1   2   3   4\n2   |   0   2   4   1   3\n3   |   0   3   1   4   2\n4   |   0   4   3   2   1\n\nn = 6:\n\n*   |   0   1   2   3   4   5\n------------------------------\n0   |   0   0   0   0   0   0\n1   |   0   1   2   3   4   5\n2   |   0   2   4   0   2   4   // NG\n3   |   0   3   0   3   0   3   // NG\n4   |   0   4   2   0   4   2   // NG\n5   |   0   5   4   3   2   1\n\nn = 7:\n\n*   |   0   1   2   3   4   5   6\n----------------------------------\n0   |   0   0   0   0   0   0   0\n1   |   0   1   2   3   4   5   6\n2   |   0   2   4   6   1   3   5\n3   |   0   3   6   2   5   1   4\n4   |   0   4   1   5   2   6   3\n5   |   0   5   3   1   6   4   2\n6   |   0   6   5   4   3   2   1\n\nn = 8:\n\n*   |   0   1   2   3   4   5   6   7\n--------------------------------------\n0   |   0   0   0   0   0   0   0   0\n1   |   0   1   2   3   4   5   6   7\n2   |   0   2   4   6   0   2   4   6   // NG\n3   |   0   3   6   1   4   7   2   5\n4   |   0   4   0   4   0   4   0   4   // NG\n5   |   0   5   2   7   4   1   6   3\n6   |   0   6   4   2   0   6   4   2   // NG\n7   |   0   7   6   5   4   3   2   1\n\nn = 9:\n\n*   |   0   1   2   3   4   5   6   7   8\n------------------------------------------\n0   |   0   0   0   0   0   0   0   0   0\n1   |   0   1   2   3   4   5   6   7   8\n2   |   0   2   4   6   8   1   3   5   7\n3   |   0   3   6   0   3   6   0   3   6   // NG\n4   |   0   4   8   3   7   2   6   1   5\n5   |   0   5   1   6   2   7   3   8   4\n6   |   0   6   3   0   6   3   0   6   3   // NG\n7   |   0   7   5   3   1   8   6   4   2\n8   |   0   8   7   6   5   4   3   2   1\n\nn = 10:\n\n*   |   0   1   2   3   4   5   6   7   8   9\n----------------------------------------------\n0   |   0   0   0   0   0   0   0   0   0   0\n1   |   0   1   2   3   4   5   6   7   8   9\n2   |   0   2   4   6   8   0   2   4   6   8   // NG\n3   |   0   3   6   9   2   5   8   1   4   7\n4   |   0   4   8   2   6   0   4   8   2   6   // NG\n5   |   0   5   0   5   0   5   0   5   0   5   // NG\n6   |   0   6   2   8   4   0   6   2   8   4   // NG\n7   |   0   7   4   1   8   5   2   9   6   3\n8   |   0   8   6   4   2   0   8   6   4   2   // NG\n9   |   0   9   8   7   6   5   4   3   2   1\n\nNG \u304c\u4e00\u3064\u3082\u4ed8\u3044\u3066\u306a\u3044\u306e\u306f n = 2, 3, 5, 7\u3001\u305d\u3046\u3067\u306a\u3044\u3082\u306e\u306f n = 4, 6, 8, 9, 10 \u3067\u3059\u3002Z_<n> \u304c\u4f53\u3068\u306a\u308b n \u306e\u6761\u4ef6\u306f\u306a\u3093\u3060\u304b\u5206\u304b\u308a\u307e\u3059\u304b\uff1f\n\uff08\u306f\u3044\u3001\u7b54\u3048\u3069\u3046\u305e\uff01\uff09\n\u5206\u304b\u3089\u306a\u3044\u3068\u3044\u3046\u65b9\u306f\u7d20\u6570\u3092\u6570\u3048\u3066\u843d\u3061\u7740\u3044\u305f\u4e0a\u3067\u3001\u3082\u3046\u4e00\u5ea6\u898b\u3066\u307f\u3066\u304f\u3060\u3055\u3044\uff08\u7b54\u3048\u306f\u8a18\u4e8b\u306e\u5f8c\u534a\u3067\uff01\uff09\n\n\u300c\u30e6\u30fc\u30af\u30ea\u30c3\u30c9\u4e92\u9664\u6cd5\u300d\u3068\u300c\u30d9\u30ba\u30fc\u306e\u7b49\u5f0f\u300d\nZ_<n> \u304c\u4f53\u3068\u306a\u308b n \u306e\u6761\u4ef6\u3092\u660e\u3089\u304b\u306b\u3059\u308b\u305f\u3081\u3001\u300c\u30e6\u30fc\u30af\u30ea\u30c3\u30c9\u4e92\u9664\u6cd5\u300d\u3068\u300c\u30d9\u30ba\u30fc\u306e\u7b49\u5f0f\u300d\u3092\u7d39\u4ecb\u3057\u307e\u3059\u3002\u3053\u306e\u8b70\u8ad6\u306f\u6b21\u56de\u3088\u308a\u4e00\u822c\u5316\u3057\u3066\u4f7f\u3046\u306e\u3067\u3001\u8a73\u3057\u3081\u306b\u8aac\u660e\u3057\u307e\u3059\u3002\n\u300c\u30e6\u30fc\u30af\u30ea\u30c3\u30c9\u306e\u4e92\u9664\u6cd5\u300d\u306f\u4e8c\u3064\u306e\u6570\u306e\u6700\u5927\u516c\u7d04\u6570\u3092\u6c42\u3081\u308b\u305f\u3081\u306e\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u3067\u3059\u3002\u300c\u4e92\u9664\u300d\u3068\u3044\u3046\u8a00\u8449\u306e\u901a\u308a\u3001\u6570\u3092\u4ea4\u4e92\u306b\u5272\u3063\u3066\u3044\u3063\u3066\u3001\u300c\u6700\u5f8c\u306e\u4f59\u308a\u300d\u304c\u6700\u5927\u516c\u7d04\u6570\u306b\u306a\u308b\u3068\u3044\u3046\u3082\u306e\u3067\u3059\u3002\n\u8a66\u3057\u306b $\\gcd(1732, 194)$ \u3092\u6c42\u3081\u3066\u307f\u307e\u3057\u3087\u3046\u3002\n\\begin{eqnarray}\n\\bf{1732} &=& 8 &\\cdot& \\bf{194} &+& 180 \\\\\n194 &=& 1 &\\cdot& 180 &+& 14 \\\\\n180 &=& 12 &\\cdot& 14 &+& 12 \\\\\n14 &=& 1 &\\cdot& 12 &+& 2 \\\\\n12 &=& 6 &\\cdot& \\bf{2} &+& 0\n\\end{eqnarray}\n\n\u5272\u3063\u305f\u6570\u304c\u6b21\u306b\u5272\u3089\u308c\u308b\u6570\u306b\u3001\u4f59\u3063\u305f\u6570\u304c\u6b21\u306b\u5272\u308b\u6570\u306b\u3001\u6570\u304c\u5de6\u4e0b\u3078\u3068\u79fb\u3063\u3066\u3044\u308b\u306e\u304c\u898b\u3048\u307e\u3059\u304b\uff1f\u6700\u5f8c\u306f\u4f59\u308a $0$ \u3068\u306a\u308b\u306e\u3067\u3001\u305d\u306e\u3068\u304d\u306e\u9664\u6570 $2$ \u304c\u6700\u5927\u516c\u7d04\u6570\u3060\u3068\u3044\u3046\u3053\u3068\u3067\u3059\u3002\n\\begin{eqnarray}\n\\gcd(1732, 194) &=& \\gcd(194, 180) \\\\\n&=& \\gcd(180, 14) \\\\\n&=& \\gcd(14, 12) \\\\\n&=& \\gcd(12, 2) \\\\\n&=& 2\n\\end{eqnarray}\n\ngcd \u306e\u5b9f\u88c5\u306f\u3053\u3093\u306a\u3067\u3059\uff1a\nfunc gcd(a: Z, _ b: Z) -> Z {\n    switch b {\n    case 0:\n        return a\n    default:\n        return gcd(b, a % b)\n    }\n}\n\n\u7c21\u5358\u3067\u3059\u306d\u3002\n\u3061\u306a\u307f\u306b\u3053\u306e\u5b9f\u88c5\u3001 $a < b$ \u3067\u3082\u3061\u3083\u3093\u3068\u52d5\u304f\u306e\u306f\u5206\u304b\u308a\u307e\u3059\u304b\uff1f\n\u6b21\u306b\u300c\u30d9\u30ba\u30fc\u306e\u7b49\u5f0f\u300d\u3092\u7d39\u4ecb\u3057\u307e\u3059\uff1a\n\n$0$ \u3067\u306a\u3044\u6574\u6570 $a, b$ \u306b\u5bfe\u3057\u3001$ax + by = \\gcd(a, b)$ \u3068\u306a\u308b\u6574\u6570 $x, y$ \u304c\u5b58\u5728\u3059\u308b\u3002\n\n\u3053\u306e\u5b9a\u7406\u306f\u300c\u5de6\u53f3\u306b $a$\u6b69\u3001$b$\u6b69 \u9032\u3080\u306e\u3092\u4f55\u56de\u304b\u7e70\u308a\u8fd4\u3057\u3066\u308c\u3070\u3001\u3044\u305a\u308c\u30b9\u30bf\u30fc\u30c8\u5730\u70b9\u304b\u3089\u53f3\u306b $d = \\gcd(a, b)$ \u6b69\u9032\u3093\u3060\u3068\u3053\u308d\u306b\u8fbf\u308a\u7740\u3051\u308b\u300d\u3068\u3044\u3046\u611f\u3058\u3067\u3059\u3002\n\n\u5148\u307b\u3069\u306e\u4f8b\u3067\u306f $\\gcd(1732, 194) = 2$ \u3060\u3063\u305f\u306e\u3067\u300c\u30d9\u30ba\u30fc\u306e\u7b49\u5f0f\u300d\u3092\u6e80\u305f\u3059 $1732x + 194y = 2$ \u3068\u306a\u308b $(x, y)$ \u304c\u3042\u308b\u3068\u3044\u3046\u3053\u3068\u306a\u306e\u3067\u3059\u304c\u3001\u3053\u308c\u306f\u30e6\u30fc\u30af\u30ea\u30c3\u30c9\u4e92\u9664\u6cd5\u3092\u4e0b\u304b\u3089\u89e3\u304d\u76f4\u305b\u3070\u81ea\u305a\u3068\u6c42\u307e\u308a\u307e\u3059\u3002\n\u4e92\u9664\u6cd5\u306e\u8a08\u7b97\u5f0f\u3092\u300c\u4f59\u308a $= \\cdots$\u300d\u306e\u5f62\u306b\u66f8\u304d\u76f4\u3059\u3068\uff1a\n\\begin{eqnarray}\n\\bf{2} &=& 14 &-& 1 &\\cdot& 12\\\\\n12 &=& 180 &-& 12 &\\cdot& 14\\\\\n14 &=& 194 &-& 1 &\\cdot& 180\\\\\n180 &=& \\bf{1732} &-& 8 &\\cdot& \\bf{194}\\\\\n\\end{eqnarray}\n\n\u3053\u308c\u3092\u4e0a\u306b\u5411\u304b\u3063\u3066\u9806\u306b\u4ee3\u5165\u3057\u3066\u3044\u3051\u3070\u3001\n\\begin{eqnarray}\n\\bf{2} &=& 14 \\ \\ &-& 1 \\cdot 12\\\\\n       &=& 14 \\ \\ &-& 1 \\cdot (180 - 12 \\cdot 14)\\\\\n       &=& -1 \\cdot 180 \\ \\ &+& 13 \\cdot 14 \\\\\n       &=& -1 \\cdot 180 \\ \\ &+& 13 \\cdot (194 - 1 \\cdot 180) \\\\\n       &=& 13 \\cdot 194 \\ \\ &-& 14 \\cdot 180\\\\\n       &=& 13 \\cdot 194 \\ \\ &-& 14 \\cdot (1732 - 8 \\cdot 194)\\\\\n       &=& -14 \\cdot \\bf{1732} \\ &+& 125 \\cdot \\bf{194}\\\\\n\\end{eqnarray}\n\n\u3068\u3044\u3046\u308f\u3051\u3067\u3001$(x, y) = (-14, 125)$ \u304c\u5f97\u3089\u308c\u307e\u3059\uff08\u5b9f\u969b $14\\cdot1732 + 125\\cdot194 =$ $-24248 + 24250 = 2$ \uff09\u3002\n\u3053\u306e\u307e\u307e\u5b9f\u88c5\u3059\u308b\u306e\u306f\u96e3\u3057\u3044\u306e\u3067\u3001\u3082\u3046\u5c11\u3057\u8b70\u8ad6\u3092\u4e00\u822c\u5316\u3057\u307e\u3059\u3002 $(a_0, b_0) = (a, b)$ \u304b\u3089\u59cb\u3081\u3066\u3001\u9806\u306b\u300c\u88ab\u9664\u6570 $a_n$\u300d\u3068\u300c\u9664\u6570 $b_n$\u300d\u3092\u4f5c\u3063\u3066\u3044\u304d\u307e\u3059\u3002$n$ \u56de\u76ee\u306e\u5272\u308a\u7b97\u306b\u304a\u3051\u308b\u5546\u3092 $q_n$, \u4f59\u308a\u3092 $r_n$ \u3068\u3059\u308b\u3068\uff1a\na_n = p_n \\cdot b_n + r_n \\ \\ (0 \\le r_n \\lt \\left|b_n\\right|)\n\n\u305d\u306e\u6b21\u306f $b_n$ \u3092 $r_n$ \u3067\u5272\u308b\u306e\u3067\u3001\n\\begin{eqnarray}\na_{n+1} &=& b_n \\\\\nb_{n+1} &=& r_n = a_n - p_n \\cdot b_n\n\\end{eqnarray}\n\n\u3053\u308c\u3067\u6700\u5f8c\u306b $b_N = 0$ \u3068\u306a\u3063\u305f\u3068\u304d\u306e $a_N$ \u304c $\\gcd(a_0, b_0)$ \u3067\u3059\u3002\u3053\u306e\u6f38\u5316\u5f0f\u3092\u300c\u884c\u5217\u3068\u30d9\u30af\u30c8\u30eb\u306e\u7a4d\u300d\u306e\u5f62\u3067\u66f8\u304d\u76f4\u3059\u3068\uff1a\n\\begin{eqnarray}\n\\left(\n\\begin{array}{c}\na_{n+1} \\\\\nb_{n+1} \n\\end{array}\n\\right)\n&=& \n\\left(\n\\begin{array}{c}\nb_n \\\\\na_n - p_n \\cdot b_n\n\\end{array}\n\\right) \\\\\n\\\\\n&=& \n\\left(\n\\begin{array}{cc}\n0 & 1 \\\\\n1 & -p_n\n\\end{array}\n\\right)\n\\left(\n\\begin{array}{c}\na_n \\\\\nb_n\n\\end{array}\n\\right)\n\\end{eqnarray}\n\n\u3053\u308c\u3092 $N$ \u304b\u3089 $0$ \u307e\u3067\u4e0b\u3052\u3066\u3044\u3051\u3070\u3001\n\\begin{eqnarray}\n\\left(\n\\begin{array}{c}\na_N \\\\\n0\n\\end{array}\n\\right)\n&=& \n\\left(\n\\begin{array}{cc}\n0 & 1 \\\\\n1 & -p_{N-1}\n\\end{array}\n\\right)\n\\left(\n\\begin{array}{c}\na_{N-1} \\\\\nb_{N-1}\n\\end{array}\n\\right)\n\\\\ \\\\ \n&=& \n\\left(\n\\begin{array}{cc}\n0 & 1 \\\\\n1 & -p_{N-1}\n\\end{array}\n\\right)\n\\left(\n\\begin{array}{cc}\n0 & 1 \\\\\n1 & -p_{N-2}\n\\end{array}\n\\right)\n\\left(\n\\begin{array}{c}\na_{N-2} \\\\\nb_{N-2}\n\\end{array}\n\\right)\n\\\\\n\\\\\n&=&\\cdots\n\\\\\n\\\\\n&=&\n\\left(\n\\begin{array}{cc}\n0 & 1 \\\\\n1 & -p_{N-1}\n\\end{array}\n\\right)\n\\cdots\n\\left(\n\\begin{array}{cc}\n0 & 1 \\\\\n1 & -p_{0}\n\\end{array}\n\\right)\n\\left(\n\\begin{array}{c}\na_0 \\\\\nb_0\n\\end{array}\n\\right)\n\\end{eqnarray}\n\n\u3068\u306a\u308a\u307e\u3059\u3002\n\u3064\u307e\u308a $(a_0, b_0)$ \u306b\u639b\u304b\u3063\u3066\u308b $N$ \u500b\u306e\u884c\u5217\u306e\u7a4d\uff1a\n\\left(\n\\begin{array}{cc}\n0 & 1 \\\\\n1 & -p_{N-1}\n\\end{array}\n\\right)\n\\cdots\n\\left(\n\\begin{array}{cc}\n0 & 1 \\\\\n1 & -p_{0}\n\\end{array}\n\\right)\n=\n\\left(\n\\begin{array}{cc}\nx & y \\\\\n? & ?\n\\end{array}\n\\right)\n\n\u306e\u4e00\u884c\u76ee\u3053\u305d\u304c\u300c\u30d9\u30ba\u30fc\u306e\u7b49\u5f0f\u300d\u306b\u51fa\u3066\u304f\u308b\u6574\u6570\u306e\u7d44 $(x, y)$ \u3067\u3059\uff01\n\u3053\u3053\u307e\u3067\u5206\u304b\u308c\u3070\u5b9f\u88c5\u3067\u304d\u307e\u3059\u306d\uff01\n\u6574\u6570 a, b \u306b\u5bfe\u3057\u3066\u300c\u30d9\u30ba\u30fc\u306e\u7b49\u5f0f\u300d$ax + by = \\gcd(a, b) = d$ \u3092\u6e80\u305f\u3059 (x, y, d) \u3092\u8fd4\u3059\u95a2\u6570 bezout \u3092\u5b9f\u88c5\u3057\u307e\u3059\u3002\u307e\u305a\u306f\u4e92\u9664\u6cd5\u3067\u5546\u306e\u5217 $(q_0, q_1, ..., q_N)$ \u3068\u4f59\u308a $d$ \u3092\u6c42\u3081\u3001\u305d\u306e\u5f8c\u306b\u5546\u306e\u5217\u304b\u3089\u5b9a\u307e\u308b\u884c\u5217\u306e\u7a4d\u3092\u8a08\u7b97\u3057\u3066 $(x, y)$ \u3092\u6c42\u3081\u307e\u3059\uff1a\nfunc bezout(a: Z, _ b: Z) -> (x: Z, y: Z, d: Z) {\n    typealias M = Matrix<Z, TPInt_2, TPInt_2>\n\n    func euclid(a: Z, _ b: Z, _ qs: [Z]) -> (qs: [Z], d: Z) {\n        switch b {\n        case 0:\n            return (qs, a)\n        default:\n            let (q, r) = (a / b, a % b)\n            return euclid(b, r, [q] + qs)\n        }\n    }\n\n    let (qs, d) = euclid(a, b, [])\n\n    let m = qs.reduce(M.identity) { (m: M, q: Z) -> M in\n        m * M(0), 1, 1, -q)\n    }\n\n    return (x: m[0, 0], y: m[0, 1], d: d)\n}\n\n\u3044\u304d\u306a\u308a\u672a\u5b9a\u7fa9\u306e\u578b M = Matrix<Z, TPInt_2, TPInt_2> \u3092\u51fa\u3057\u3066\u3057\u307e\u3044\u307e\u3057\u305f\u304c\u3001\u3053\u308c\u306f\u3042\u3089\u304b\u3058\u3081\u4f5c\u3063\u3066\u3042\u3063\u305f\u300c$\\mathbb{Z}$\u4fc2\u6570\u306e2\u6b21\u6b63\u65b9\u884c\u5217\u300d\u3067\u3059\u3002\u8ffd\u3063\u3066\u5b9f\u88c5\u306f\u516c\u958b\u3059\u308b\u306e\u3067\u8a31\u3057\u3066\u304f\u3060\u3055\u3044 \n\u78ba\u8a8d\u3057\u3066\u307f\u307e\u3057\u3087\u3046\uff1a\nlet (x, y, d) = bezout(1732, 194)  // (-14, 125, 2)\n1732 * x + 194 * y == d            // true\n\n\u3081\u3067\u305f\u304f\u4e0a\u306e\u8a08\u7b97\u3067\u6c42\u3081\u305f\u901a\u308a\u306e\u7d50\u679c\u304c\u5f97\u3089\u308c\u307e\u3057\u305f\uff01\n\n\u6539\u3081\u3066\u3001\u5270\u4f59\u74b0\u304c\u4f53\u306b\u306a\u308b\u6761\u4ef6\u3068\u306f\uff1f\n\u5143\u3005\u8003\u3048\u305f\u304b\u3063\u305f\u306e\u306f\u300c $\\mathbb{Z}_ n$ \u304c\u4f53\u306b\u306a\u308b\u6761\u4ef6\u306f\u4f55\u304b\uff1f\u300d\u3068\u3044\u3046\u3053\u3068\u3067\u3059\u3002\u3053\u3053\u3067 $a \\in \\mathbb{Z}_n$ \u3068 $n$ \u306b\u5bfe\u3059\u308b\u300c\u30d9\u30ba\u30fc\u306e\u7b49\u5f0f\u300d\u306f\uff1a\nax + ny = \\gcd(a, n)\n\n\u3053\u308c\u3092 $\\bmod{n}$ \u3059\u308b\u3068\u3001$ny$ \u306e\u90e8\u5206\u306f $n$ \u306e\u500d\u6570\u306a\u306e\u3067\u6d88\u3048\u3066\u3001\na \\cdot x \\equiv \\gcd(a, n) \\pmod{n}\n\n\u3053\u3053\u3067\u3082\u3057 $\\gcd(a, n) = 1$ \u306a\u3089\u3070\u3001\u307e\u3055\u3057\u304f\u3053\u306e $x$ \u304c $\\bmod{n}$ \u306b\u304a\u3051\u308b $a$ \u306e\u9006\u6570\u3068\u3044\u3046\u3053\u3068\u306b\u306a\u308a\u307e\u3059\u3002\u9006\u306b $\\gcd(a, n) = d \\ne 1$ \u306a\u3089\u3070\u3001$a \\cdot x \\equiv 1 \\pmod{n}$ \u306a\u308b $x$ \u306f\u3042\u308a\u5f97\u307e\u305b\u3093\uff08$1$ \u304c $d$ \u306e\u500d\u6570\u3068\u3044\u3046\u3053\u3068\u306b\u306a\u3063\u3066\u3057\u307e\u3044\u307e\u3059\uff09\u3002\n$\\bmod{n}$ \u3067 $a$ \u306e\u9006\u6570\u304c\u5b58\u5728\u3059\u308b\u6761\u4ef6\u306f\u300c$\\gcd(a, n) = 1$\u300d\u3059\u306a\u308f\u3061\u300c$a, n$ \u306f\u4e92\u306b\u7d20\u300d\u3068\u3044\u3046\u3053\u3068\u3067\u3059\u3002\u305d\u3057\u3066 $\\mathbb{Z}_ n$ \u304c\u300c\u4f53\u300d\u3060\u3068\u3044\u3046\u3053\u3068\u306f\u3001$a = 1 ... n-1$ \u306e\u5168\u3066\u306b\u5bfe\u3057\u3066 $n$ \u304c\u4e92\u3044\u306b\u7d20\u3068\u3044\u3046\u3053\u3068\u306a\u306e\u3067\u3001\u6c42\u3081\u308b\u6761\u4ef6\u306f\uff1a\n$\\mathbb{Z}_n$ \u304c\u4f53 $\\ \\Leftrightarrow\\ $ $n$ \u306f \u7d20\u6570\n\u3068\u3044\u3046\u3053\u3068\u3067\u3057\u305f\uff01\n\u7d20\u6570\uff08Prime Number\uff09$p$ \u306b\u5bfe\u3057\u3066 $\\mathbb{Z}_ p$ \u3092\u4f53\u3068\u898b\u305f\u3082\u306e\u3092 $\\mathbb{F}_ p$ \u3068\u66f8\u304d\u300c\u4f4d\u6570 $p$ \u306e \u6709\u9650\u4f53\u300d\u3068\u8a00\u3044\u307e\u3059\u3002\u5192\u982d\u3067\u898b\u305f\u306e\u306f\u4f4d\u6570 $p = 2, 3, 5, 7$ \u306e\u6709\u9650\u4f53 $\\mathbb{F}_ 2, \\mathbb{F}_ 3, \\mathbb{F}_ 5, \\mathbb{F}_ 7$ \u306e\u4e57\u7b97\u8868\u3067\u3057\u305f\u3002\n\n\u6709\u9650\u4f53\u3092\u5b9f\u88c5\u3057\u3088\u3046\uff01\n\u6700\u5f8c\u306b\u3053\u306e\u6709\u9650\u4f53 F_<p> \u3092\u5b9f\u88c5\u3057\u3066\u7d42\u308f\u308a\u307e\u3057\u3087\u3046\u3002\u74b0\u3068\u3057\u3066\u306e\u6f14\u7b97\u306f Z_<n> \u3067\u5b9f\u88c5\u6e08\u307f\u306a\u306e\u3067\u3001\u300c\u7a4d\u306b\u95a2\u3059\u308b\u9006\u5143\u300d\u3092\u5b9f\u88c5\u3059\u308c\u3070\u305d\u308c\u3067\u4f53\u3068\u306a\u308a\u307e\u3059\u3002\u4e0a\u3067\u5b9f\u88c5\u3057\u305f bezout \u3092\u4f7f\u3063\u3066\uff1a\nstruct F_<p: TPInt>: Field {\n    let value: Z\n    ...\n\n    var inverse: F_<p> {\n        if value == 0 {\n            fatalError(\"0-inverse\")\n        }\n\n        // find: a * x + p * y = 1\n        // then: a^-1 = x (mod p)\n        let (x, _, r) = bezout(a, mod)\n\n        if r != 1 {\n            fatalError(\"\\(mod) is non-prime.\")\n        }\n\n        return F_(x)\n    }\n}\n\n\u3081\u3067\u305f\u304f $\\mathbb{F}_p$ \u3067\u304d\u307e\u3057\u305f\uff01\n\u6700\u5f8c\u306b\u30aa\u30de\u30b1\u3068\u3057\u3066 $\\mathbb{F} _p$ \u306e\u300c\u3079\u304d\u4e57\u8868\u300d\u3092\u898b\u3066\u307f\u307e\u3057\u3087\u3046\uff1a\np = 2:\n\n^   |   0   1\n--------------\n1   |   1   1\n\np = 3:\n\n^   |   0   1   2\n------------------\n1   |   1   1   1\n2   |   1   2   1\n\np = 5:\n\n^   |   0   1   2   3   4\n--------------------------\n1   |   1   1   1   1   1\n2   |   1   2   4   3   1\n3   |   1   3   4   2   1\n4   |   1   4   1   4   1\n\np = 7:\n\n^   |   0   1   2   3   4   5   6\n----------------------------------\n1   |   1   1   1   1   1   1   1\n2   |   1   2   4   1   2   4   1\n3   |   1   3   2   6   4   5   1\n4   |   1   4   2   1   4   2   1\n5   |   1   5   4   6   2   3   1\n6   |   1   6   1   6   1   6   1\n\n\u3053\u306e\u8868\u306b\u306f (a, n) \u6210\u5206\u306b\u300ca \u306e n \u4e57\u300d\u304c\u8868\u793a\u3055\u308c\u3066\u3044\u307e\u3059\u3002\u5217\u306e\u4e00\u756a\u53f3\u5074\u304c\u5168\u90e8 1 \u306b\u306a\u3063\u3066\u3044\u307e\u3059\u3002\u3053\u308c\u306f 0 \u3067\u306a\u3044 a in F_p \u306b\u5bfe\u3057\u3066 a ^ (p - 1) \u304c F_p \u3068\u3057\u3066 1 \u306b\u7b49\u3057\u3044\u3068\u3044\u3046\u3053\u3068\u3067\u3059\u3002\u3064\u307e\u308a\uff1a\n\n\u3010\u30d5\u30a7\u30eb\u30de\u30fc\u306e\u5c0f\u5b9a\u7406\u3011\n\u7d20\u6570 $p$ \u3068\u6574\u6570 $a$ \u304c\u4e92\u306b\u7d20\u306e\u3068\u304d\u3001 $a^{p-1} \\equiv 1 \\pmod{p}$\n\n\u3092\u793a\u3057\u3066\u3044\u307e\u3059\uff01\n\u524d\u56de\u7d39\u4ecb\u3057\u305f\u300e\u6642\u8a08\u306e\u4e16\u754c\u306e\u6574\u6570\u8ad6\u300f\u3067\u306f\u4ed6\u306b\u3082\u300c\u30aa\u30a4\u30e9\u30fc\u57fa\u6e96\u300d\u3084\u300c\u5e73\u65b9\u5270\u4f59\u306e\u76f8\u4e92\u6cd5\u5247\u300d\u306a\u3069\u3079\u304d\u4e57\u6cd5\u5247\u306b\u95a2\u3059\u308b\u9762\u767d\u3044\u8a71\u304c\u7d39\u4ecb\u3055\u308c\u3066\u3044\u307e\u3059\u3002\u662f\u975e\u898b\u3066\u307f\u3066\u304f\u3060\u3055\u3044\uff01\n\u6b21\u56de\u306f\u300c\u591a\u9805\u5f0f\u74b0\u300d\u3092\u4f5c\u308a\u307e\u3059\u3002\u6574\u6570\u74b0\u304b\u3089\u6709\u9650\u4f53\u3092\u4f5c\u3063\u305f\u3088\u3046\u306b\u591a\u9805\u5f0f\u74b0\u304b\u3089\u62e1\u5927\u4f53\u3092\u4f5c\u308b\u306e\u304c\u30b7\u30ea\u30fc\u30ba\u306e\u30b4\u30fc\u30eb\u3067\u3042\u3063\u305f\u300c\u4ee3\u6570\u62e1\u5927\u300d\u3067\u3059\u2026\uff01\n\n\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\nGitHub: SwiftyAlgebra\n\nQuotientRing\nIntQuotientRing\n\n\n\u5ba3\u4f1d\n\n3/19(\u571f) \u300c\u7b2c6\u56de \u30d7\u30ed\u30b0\u30e9\u30de\u306e\u305f\u3081\u306e\u6570\u5b66\u52c9\u5f37\u4f1a\u300d\n\u30d7\u30ed\u30b0\u30e9\u30de\u306e\u305f\u3081\u306e\u6570\u5b66\u52c9\u5f37\u4f1a Facebook \u30da\u30fc\u30b8\n\n\u500b\u4eba\u30d6\u30ed\u30b0 Imaginary & Imaginative\n\n\n\u3069\u3046\u3082\u3001\u4f50\u91ce\u3067\u3059\u3002\u524d\u56de\u306f $n$ \u6642\u9593\u6642\u8a08\u306e\u74b0 $\\mathbb{Z}_ n$ \u3092\u4f5c\u308a\u3001 $n = 5$ \u306e\u3068\u304d\u3053\u308c\u304c\u4f53\u3068\u306a\u308b\u3053\u3068\u3092\u898b\u307e\u3057\u305f\u3002\u4eca\u56de\u306f $\\mathbb{Z}_ n$ \u304c\u4f53\u3068\u306a\u308b\u6761\u4ef6\u3092\u660e\u3089\u304b\u306b\u3057\u3001\u305d\u306e\u4f53\u3092\u30d7\u30ed\u30b0\u30e9\u30e0\u3067\u5b9f\u73fe\u3057\u307e\u3057\u3087\u3046\u3002\n\n## \u76ee\u6b21\uff1a\n\n1. [\u6570\u3068\u306f\u4f55\u304b\uff1f](bd356c59dc0559ee9a0b)\n2. [\u7fa4\u30fb\u74b0\u30fb\u4f53\u306e\u5b9a\u7fa9](733e0ecf12da359db729)\n3. [\u6709\u7406\u6570\u3092\u4f5c\u3063\u3066\u307f\u3088\u3046](222a6a418fb29a0684f8)\n4. [\u6642\u8a08\u306e\u4e16\u754c\u306e\u300c\u74b0\u300d](91fbc70136b0e5706c09)\n5. [\u5c0f\u3055\u306a\u300c\u4f53\u300d\u3092\u4f5c\u308d\u3046](f5cd40bf669fa8511f9b) _\u2190 \u30a4\u30de\u30b3\u30b3_ \n6. [\u591a\u9805\u5f0f\u306f\u6574\u6570\u306b\u3088\u304f\u4f3c\u3066\u308b](83be0ad7d2f2e4f3f44d)\n7. [\u4ee3\u6570\u62e1\u5927\u3067\u6570\u3092\u4f5c\u308d\u3046\uff01](ccf7ece3dfeb98b38946)\n\n# \u5270\u4f59\u74b0\u304c\u4f53\u306b\u306a\u308b\u6761\u4ef6\u306f\uff1f\n\n\u524d\u56de `Z_5` \u306f\u4f53\u3067 `Z_6` \u306f\u4f53\u3067\u306a\u3044\u3053\u3068\u78ba\u8a8d\u3057\u307e\u3057\u305f\u3002\n\n`n = 2 ... 10` \u306e\u7bc4\u56f2\u3067 `Z_<n>` \u306e\u4e57\u6cd5\u8868\u3092\u51fa\u529b\u3057\u3066\u307f\u307e\u3057\u3087\u3046\u3002 `Z_<n>` \u304c\u4f53\u306b\u306a\u308b\u3068\u3044\u3046\u3053\u3068\u306f\u300c$0$ \u4ee5\u5916\u306e\u5168\u3066\u306e\u6570\u306f\u3001\u639b\u3051\u3066 $1$ \u306b\u306a\u308b\u6570\uff08\u9006\u6570\uff09\u304c\u3042\u308b\u300d\u3068\u3044\u3046\u3053\u3068\u3067\u3059\u3002\u884c\u3092\u9806\u756a\u306b\u898b\u3066\u884c\u3063\u3066\u3001\u4e00\u3064\u3067\u3082 `1` \u3092\u542b\u307e\u306a\u3044\u3082\u306e\u304c\u3042\u3063\u305f\u3089 NG \u3067\u3059\u3002\n\n```\nn = 2:\n\n*\t|\t0\t1\n--------------\n0\t|\t0\t0\n1\t|\t0\t1\n```\n```\nn = 3:\n\n*\t|\t0\t1\t2\n------------------\n0\t|\t0\t0\t0\n1\t|\t0\t1\t2\n2\t|\t0\t2\t1\n```\n```\nn = 4:\n\n*\t|\t0\t1\t2\t3\n----------------------\n0\t|\t0\t0\t0\t0\n1\t|\t0\t1\t2\t3\n2\t|\t0\t2\t0\t2\t// NG\n3\t|\t0\t3\t2\t1\n```\n```\nn = 5:\n\n*\t|\t0\t1\t2\t3\t4\n--------------------------\n0\t|\t0\t0\t0\t0\t0\n1\t|\t0\t1\t2\t3\t4\n2\t|\t0\t2\t4\t1\t3\n3\t|\t0\t3\t1\t4\t2\n4\t|\t0\t4\t3\t2\t1\n```\n```\nn = 6:\n\n*\t|\t0\t1\t2\t3\t4\t5\n------------------------------\n0\t|\t0\t0\t0\t0\t0\t0\n1\t|\t0\t1\t2\t3\t4\t5\n2\t|\t0\t2\t4\t0\t2\t4\t// NG\n3\t|\t0\t3\t0\t3\t0\t3\t// NG\n4\t|\t0\t4\t2\t0\t4\t2\t// NG\n5\t|\t0\t5\t4\t3\t2\t1\n```\n```\nn = 7:\n\n*\t|\t0\t1\t2\t3\t4\t5\t6\n----------------------------------\n0\t|\t0\t0\t0\t0\t0\t0\t0\n1\t|\t0\t1\t2\t3\t4\t5\t6\n2\t|\t0\t2\t4\t6\t1\t3\t5\n3\t|\t0\t3\t6\t2\t5\t1\t4\n4\t|\t0\t4\t1\t5\t2\t6\t3\n5\t|\t0\t5\t3\t1\t6\t4\t2\n6\t|\t0\t6\t5\t4\t3\t2\t1\n```\n```\nn = 8:\n\n*\t|\t0\t1\t2\t3\t4\t5\t6\t7\n--------------------------------------\n0\t|\t0\t0\t0\t0\t0\t0\t0\t0\n1\t|\t0\t1\t2\t3\t4\t5\t6\t7\n2\t|\t0\t2\t4\t6\t0\t2\t4\t6\t// NG\n3\t|\t0\t3\t6\t1\t4\t7\t2\t5\n4\t|\t0\t4\t0\t4\t0\t4\t0\t4\t// NG\n5\t|\t0\t5\t2\t7\t4\t1\t6\t3\n6\t|\t0\t6\t4\t2\t0\t6\t4\t2\t// NG\n7\t|\t0\t7\t6\t5\t4\t3\t2\t1\n```\n```\nn = 9:\n\n*\t|\t0\t1\t2\t3\t4\t5\t6\t7\t8\n------------------------------------------\n0\t|\t0\t0\t0\t0\t0\t0\t0\t0\t0\n1\t|\t0\t1\t2\t3\t4\t5\t6\t7\t8\n2\t|\t0\t2\t4\t6\t8\t1\t3\t5\t7\n3\t|\t0\t3\t6\t0\t3\t6\t0\t3\t6\t// NG\n4\t|\t0\t4\t8\t3\t7\t2\t6\t1\t5\n5\t|\t0\t5\t1\t6\t2\t7\t3\t8\t4\n6\t|\t0\t6\t3\t0\t6\t3\t0\t6\t3\t// NG\n7\t|\t0\t7\t5\t3\t1\t8\t6\t4\t2\n8\t|\t0\t8\t7\t6\t5\t4\t3\t2\t1\n```\n```\nn = 10:\n\n*\t|\t0\t1\t2\t3\t4\t5\t6\t7\t8\t9\n----------------------------------------------\n0\t|\t0\t0\t0\t0\t0\t0\t0\t0\t0\t0\n1\t|\t0\t1\t2\t3\t4\t5\t6\t7\t8\t9\n2\t|\t0\t2\t4\t6\t8\t0\t2\t4\t6\t8\t// NG\n3\t|\t0\t3\t6\t9\t2\t5\t8\t1\t4\t7\n4\t|\t0\t4\t8\t2\t6\t0\t4\t8\t2\t6\t// NG\n5\t|\t0\t5\t0\t5\t0\t5\t0\t5\t0\t5\t// NG\n6\t|\t0\t6\t2\t8\t4\t0\t6\t2\t8\t4\t// NG\n7\t|\t0\t7\t4\t1\t8\t5\t2\t9\t6\t3\n8\t|\t0\t8\t6\t4\t2\t0\t8\t6\t4\t2\t// NG\n9\t|\t0\t9\t8\t7\t6\t5\t4\t3\t2\t1\n```\n\n`NG` \u304c\u4e00\u3064\u3082\u4ed8\u3044\u3066\u306a\u3044\u306e\u306f `n = 2, 3, 5, 7`\u3001\u305d\u3046\u3067\u306a\u3044\u3082\u306e\u306f `n = 4, 6, 8, 9, 10` \u3067\u3059\u3002`Z_<n>` \u304c\u4f53\u3068\u306a\u308b `n` \u306e\u6761\u4ef6\u306f\u306a\u3093\u3060\u304b\u5206\u304b\u308a\u307e\u3059\u304b\uff1f\n\n\uff08\u306f\u3044\u3001\u7b54\u3048\u3069\u3046\u305e\uff01\uff09\n\n\u5206\u304b\u3089\u306a\u3044\u3068\u3044\u3046\u65b9\u306f\u7d20\u6570\u3092\u6570\u3048\u3066\u843d\u3061\u7740\u3044\u305f\u4e0a\u3067\u3001\u3082\u3046\u4e00\u5ea6\u898b\u3066\u307f\u3066\u304f\u3060\u3055\u3044\uff08\u7b54\u3048\u306f\u8a18\u4e8b\u306e\u5f8c\u534a\u3067\uff01\uff09\n\n## \u300c\u30e6\u30fc\u30af\u30ea\u30c3\u30c9\u4e92\u9664\u6cd5\u300d\u3068\u300c\u30d9\u30ba\u30fc\u306e\u7b49\u5f0f\u300d\n\n`Z_<n>` \u304c\u4f53\u3068\u306a\u308b `n` \u306e\u6761\u4ef6\u3092\u660e\u3089\u304b\u306b\u3059\u308b\u305f\u3081\u3001\u300c\u30e6\u30fc\u30af\u30ea\u30c3\u30c9\u4e92\u9664\u6cd5\u300d\u3068\u300c\u30d9\u30ba\u30fc\u306e\u7b49\u5f0f\u300d\u3092\u7d39\u4ecb\u3057\u307e\u3059\u3002\u3053\u306e\u8b70\u8ad6\u306f\u6b21\u56de\u3088\u308a\u4e00\u822c\u5316\u3057\u3066\u4f7f\u3046\u306e\u3067\u3001\u8a73\u3057\u3081\u306b\u8aac\u660e\u3057\u307e\u3059\u3002\n\n\u300c\u30e6\u30fc\u30af\u30ea\u30c3\u30c9\u306e\u4e92\u9664\u6cd5\u300d\u306f\u4e8c\u3064\u306e\u6570\u306e\u6700\u5927\u516c\u7d04\u6570\u3092\u6c42\u3081\u308b\u305f\u3081\u306e\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u3067\u3059\u3002\u300c\u4e92\u9664\u300d\u3068\u3044\u3046\u8a00\u8449\u306e\u901a\u308a\u3001\u6570\u3092\u4ea4\u4e92\u306b\u5272\u3063\u3066\u3044\u3063\u3066\u3001\u300c\u6700\u5f8c\u306e\u4f59\u308a\u300d\u304c\u6700\u5927\u516c\u7d04\u6570\u306b\u306a\u308b\u3068\u3044\u3046\u3082\u306e\u3067\u3059\u3002\n\n\u8a66\u3057\u306b $\\gcd(1732, 194)$ \u3092\u6c42\u3081\u3066\u307f\u307e\u3057\u3087\u3046\u3002\n\n```math\n\\begin{eqnarray}\n\\bf{1732} &=& 8 &\\cdot& \\bf{194} &+& 180 \\\\\n194 &=& 1 &\\cdot& 180 &+& 14 \\\\\n180 &=& 12 &\\cdot& 14 &+& 12 \\\\\n14 &=& 1 &\\cdot& 12 &+& 2 \\\\\n12 &=& 6 &\\cdot& \\bf{2} &+& 0\n\\end{eqnarray}\n```\n\n\u5272\u3063\u305f\u6570\u304c\u6b21\u306b\u5272\u3089\u308c\u308b\u6570\u306b\u3001\u4f59\u3063\u305f\u6570\u304c\u6b21\u306b\u5272\u308b\u6570\u306b\u3001\u6570\u304c\u5de6\u4e0b\u3078\u3068\u79fb\u3063\u3066\u3044\u308b\u306e\u304c\u898b\u3048\u307e\u3059\u304b\uff1f\u6700\u5f8c\u306f\u4f59\u308a $0$ \u3068\u306a\u308b\u306e\u3067\u3001\u305d\u306e\u3068\u304d\u306e\u9664\u6570 $2$ \u304c\u6700\u5927\u516c\u7d04\u6570\u3060\u3068\u3044\u3046\u3053\u3068\u3067\u3059\u3002\n\n```math\n\\begin{eqnarray}\n\\gcd(1732, 194) &=& \\gcd(194, 180) \\\\\n&=& \\gcd(180, 14) \\\\\n&=& \\gcd(14, 12) \\\\\n&=& \\gcd(12, 2) \\\\\n&=& 2\n\\end{eqnarray}\n```\n\n`gcd` \u306e\u5b9f\u88c5\u306f\u3053\u3093\u306a\u3067\u3059\uff1a\n\n```\nfunc gcd(a: Z, _ b: Z) -> Z {\n    switch b {\n    case 0:\n        return a\n    default:\n        return gcd(b, a % b)\n    }\n}\n```\n\n\u7c21\u5358\u3067\u3059\u306d\u3002\n\u3061\u306a\u307f\u306b\u3053\u306e\u5b9f\u88c5\u3001 $a < b$ \u3067\u3082\u3061\u3083\u3093\u3068\u52d5\u304f\u306e\u306f\u5206\u304b\u308a\u307e\u3059\u304b\uff1f\n\n\u6b21\u306b\u300c\u30d9\u30ba\u30fc\u306e\u7b49\u5f0f\u300d\u3092\u7d39\u4ecb\u3057\u307e\u3059\uff1a\n\n> $0$ \u3067\u306a\u3044\u6574\u6570 $a, b$ \u306b\u5bfe\u3057\u3001$ax + by = \\gcd(a, b)$ \u3068\u306a\u308b\u6574\u6570 $x, y$ \u304c\u5b58\u5728\u3059\u308b\u3002\n\n\u3053\u306e\u5b9a\u7406\u306f\u300c\u5de6\u53f3\u306b $a$\u6b69\u3001$b$\u6b69 \u9032\u3080\u306e\u3092\u4f55\u56de\u304b\u7e70\u308a\u8fd4\u3057\u3066\u308c\u3070\u3001\u3044\u305a\u308c\u30b9\u30bf\u30fc\u30c8\u5730\u70b9\u304b\u3089\u53f3\u306b $d = \\gcd(a, b)$ \u6b69\u9032\u3093\u3060\u3068\u3053\u308d\u306b\u8fbf\u308a\u7740\u3051\u308b\u300d\u3068\u3044\u3046\u611f\u3058\u3067\u3059\u3002\n\n![](https://qiita-image-store.s3.amazonaws.com/0/8146/2b05d843-0dd9-9dd7-d2d8-9d94fd0b7160.png)\n\n\u5148\u307b\u3069\u306e\u4f8b\u3067\u306f $\\gcd(1732, 194) = 2$ \u3060\u3063\u305f\u306e\u3067\u300c\u30d9\u30ba\u30fc\u306e\u7b49\u5f0f\u300d\u3092\u6e80\u305f\u3059 $1732x + 194y = 2$ \u3068\u306a\u308b $(x, y)$ \u304c\u3042\u308b\u3068\u3044\u3046\u3053\u3068\u306a\u306e\u3067\u3059\u304c\u3001\u3053\u308c\u306f\u30e6\u30fc\u30af\u30ea\u30c3\u30c9\u4e92\u9664\u6cd5\u3092\u4e0b\u304b\u3089\u89e3\u304d\u76f4\u305b\u3070\u81ea\u305a\u3068\u6c42\u307e\u308a\u307e\u3059\u3002\n\n\u4e92\u9664\u6cd5\u306e\u8a08\u7b97\u5f0f\u3092\u300c\u4f59\u308a $= \\cdots$\u300d\u306e\u5f62\u306b\u66f8\u304d\u76f4\u3059\u3068\uff1a\n\n```math\n\\begin{eqnarray}\n\\bf{2} &=& 14 &-& 1 &\\cdot& 12\\\\\n12 &=& 180 &-& 12 &\\cdot& 14\\\\\n14 &=& 194 &-& 1 &\\cdot& 180\\\\\n180 &=& \\bf{1732} &-& 8 &\\cdot& \\bf{194}\\\\\n\\end{eqnarray}\n```\n\n\u3053\u308c\u3092\u4e0a\u306b\u5411\u304b\u3063\u3066\u9806\u306b\u4ee3\u5165\u3057\u3066\u3044\u3051\u3070\u3001\n\n```math\n\\begin{eqnarray}\n\\bf{2} &=& 14 \\ \\ &-& 1 \\cdot 12\\\\\n       &=& 14 \\ \\ &-& 1 \\cdot (180 - 12 \\cdot 14)\\\\\n       &=& -1 \\cdot 180 \\ \\ &+& 13 \\cdot 14 \\\\\n       &=& -1 \\cdot 180 \\ \\ &+& 13 \\cdot (194 - 1 \\cdot 180) \\\\\n       &=& 13 \\cdot 194 \\ \\ &-& 14 \\cdot 180\\\\\n       &=& 13 \\cdot 194 \\ \\ &-& 14 \\cdot (1732 - 8 \\cdot 194)\\\\\n       &=& -14 \\cdot \\bf{1732} \\ &+& 125 \\cdot \\bf{194}\\\\\n\\end{eqnarray}\n```\n\n\u3068\u3044\u3046\u308f\u3051\u3067\u3001$(x, y) = (-14, 125)$ \u304c\u5f97\u3089\u308c\u307e\u3059\uff08\u5b9f\u969b $14\\cdot1732 + 125\\cdot194 =$ $-24248 + 24250 = 2$ \uff09\u3002\n\n\u3053\u306e\u307e\u307e\u5b9f\u88c5\u3059\u308b\u306e\u306f\u96e3\u3057\u3044\u306e\u3067\u3001\u3082\u3046\u5c11\u3057\u8b70\u8ad6\u3092\u4e00\u822c\u5316\u3057\u307e\u3059\u3002 $(a_0, b_0) = (a, b)$ \u304b\u3089\u59cb\u3081\u3066\u3001\u9806\u306b\u300c\u88ab\u9664\u6570 $a_n$\u300d\u3068\u300c\u9664\u6570 $b_n$\u300d\u3092\u4f5c\u3063\u3066\u3044\u304d\u307e\u3059\u3002$n$ \u56de\u76ee\u306e\u5272\u308a\u7b97\u306b\u304a\u3051\u308b\u5546\u3092 $q_n$, \u4f59\u308a\u3092 $r_n$ \u3068\u3059\u308b\u3068\uff1a\n\n```math\na_n = p_n \\cdot b_n + r_n \\ \\ (0 \\le r_n \\lt \\left|b_n\\right|)\n```\n\n\u305d\u306e\u6b21\u306f $b_n$ \u3092 $r_n$ \u3067\u5272\u308b\u306e\u3067\u3001\n\n```math\n\\begin{eqnarray}\na_{n+1} &=& b_n \\\\\nb_{n+1} &=& r_n = a_n - p_n \\cdot b_n\n\\end{eqnarray}\n```\n\n\u3053\u308c\u3067\u6700\u5f8c\u306b $b_N = 0$ \u3068\u306a\u3063\u305f\u3068\u304d\u306e $a_N$ \u304c $\\gcd(a_0, b_0)$ \u3067\u3059\u3002\u3053\u306e\u6f38\u5316\u5f0f\u3092\u300c\u884c\u5217\u3068\u30d9\u30af\u30c8\u30eb\u306e\u7a4d\u300d\u306e\u5f62\u3067\u66f8\u304d\u76f4\u3059\u3068\uff1a\n\n```math\n\\begin{eqnarray}\n\\left(\n\\begin{array}{c}\na_{n+1} \\\\\nb_{n+1} \n\\end{array}\n\\right)\n&=& \n\\left(\n\\begin{array}{c}\nb_n \\\\\na_n - p_n \\cdot b_n\n\\end{array}\n\\right) \\\\\n\\\\\n&=& \n\\left(\n\\begin{array}{cc}\n0 & 1 \\\\\n1 & -p_n\n\\end{array}\n\\right)\n\\left(\n\\begin{array}{c}\na_n \\\\\nb_n\n\\end{array}\n\\right)\n\\end{eqnarray}\n```\n\n\u3053\u308c\u3092 $N$ \u304b\u3089 $0$ \u307e\u3067\u4e0b\u3052\u3066\u3044\u3051\u3070\u3001\n\n```math\n\\begin{eqnarray}\n\\left(\n\\begin{array}{c}\na_N \\\\\n0\n\\end{array}\n\\right)\n&=& \n\\left(\n\\begin{array}{cc}\n0 & 1 \\\\\n1 & -p_{N-1}\n\\end{array}\n\\right)\n\\left(\n\\begin{array}{c}\na_{N-1} \\\\\nb_{N-1}\n\\end{array}\n\\right)\n\\\\ \\\\ \n&=& \n\\left(\n\\begin{array}{cc}\n0 & 1 \\\\\n1 & -p_{N-1}\n\\end{array}\n\\right)\n\\left(\n\\begin{array}{cc}\n0 & 1 \\\\\n1 & -p_{N-2}\n\\end{array}\n\\right)\n\\left(\n\\begin{array}{c}\na_{N-2} \\\\\nb_{N-2}\n\\end{array}\n\\right)\n\\\\\n\\\\\n&=&\\cdots\n\\\\\n\\\\\n&=&\n\\left(\n\\begin{array}{cc}\n0 & 1 \\\\\n1 & -p_{N-1}\n\\end{array}\n\\right)\n\\cdots\n\\left(\n\\begin{array}{cc}\n0 & 1 \\\\\n1 & -p_{0}\n\\end{array}\n\\right)\n\\left(\n\\begin{array}{c}\na_0 \\\\\nb_0\n\\end{array}\n\\right)\n\\end{eqnarray}\n```\n\n\u3068\u306a\u308a\u307e\u3059\u3002\n\u3064\u307e\u308a $(a_0, b_0)$ \u306b\u639b\u304b\u3063\u3066\u308b $N$ \u500b\u306e\u884c\u5217\u306e\u7a4d\uff1a\n\n```math\n\\left(\n\\begin{array}{cc}\n0 & 1 \\\\\n1 & -p_{N-1}\n\\end{array}\n\\right)\n\\cdots\n\\left(\n\\begin{array}{cc}\n0 & 1 \\\\\n1 & -p_{0}\n\\end{array}\n\\right)\n=\n\\left(\n\\begin{array}{cc}\nx & y \\\\\n? & ?\n\\end{array}\n\\right)\n```\n\n\u306e\u4e00\u884c\u76ee\u3053\u305d\u304c\u300c\u30d9\u30ba\u30fc\u306e\u7b49\u5f0f\u300d\u306b\u51fa\u3066\u304f\u308b\u6574\u6570\u306e\u7d44 $(x, y)$ \u3067\u3059\uff01\n\u3053\u3053\u307e\u3067\u5206\u304b\u308c\u3070\u5b9f\u88c5\u3067\u304d\u307e\u3059\u306d\uff01\n\n\u6574\u6570 `a, b` \u306b\u5bfe\u3057\u3066\u300c\u30d9\u30ba\u30fc\u306e\u7b49\u5f0f\u300d$ax + by = \\gcd(a, b) = d$ \u3092\u6e80\u305f\u3059 `(x, y, d)` \u3092\u8fd4\u3059\u95a2\u6570 `bezout` \u3092\u5b9f\u88c5\u3057\u307e\u3059\u3002\u307e\u305a\u306f\u4e92\u9664\u6cd5\u3067\u5546\u306e\u5217 $(q_0, q_1, ..., q_N)$ \u3068\u4f59\u308a $d$ \u3092\u6c42\u3081\u3001\u305d\u306e\u5f8c\u306b\u5546\u306e\u5217\u304b\u3089\u5b9a\u307e\u308b\u884c\u5217\u306e\u7a4d\u3092\u8a08\u7b97\u3057\u3066 $(x, y)$ \u3092\u6c42\u3081\u307e\u3059\uff1a\n\n```\nfunc bezout(a: Z, _ b: Z) -> (x: Z, y: Z, d: Z) {\n    typealias M = Matrix<Z, TPInt_2, TPInt_2>\n    \n    func euclid(a: Z, _ b: Z, _ qs: [Z]) -> (qs: [Z], d: Z) {\n        switch b {\n        case 0:\n            return (qs, a)\n        default:\n            let (q, r) = (a / b, a % b)\n            return euclid(b, r, [q] + qs)\n        }\n    }\n    \n    let (qs, d) = euclid(a, b, [])\n\n    let m = qs.reduce(M.identity) { (m: M, q: Z) -> M in\n        m * M(0), 1, 1, -q)\n    }\n    \n    return (x: m[0, 0], y: m[0, 1], d: d)\n}\n```\n\n\u3044\u304d\u306a\u308a\u672a\u5b9a\u7fa9\u306e\u578b `M = Matrix<Z, TPInt_2, TPInt_2>` \u3092\u51fa\u3057\u3066\u3057\u307e\u3044\u307e\u3057\u305f\u304c\u3001\u3053\u308c\u306f\u3042\u3089\u304b\u3058\u3081\u4f5c\u3063\u3066\u3042\u3063\u305f\u300c$\\mathbb{Z}$\u4fc2\u6570\u306e2\u6b21\u6b63\u65b9\u884c\u5217\u300d\u3067\u3059\u3002\u8ffd\u3063\u3066\u5b9f\u88c5\u306f\u516c\u958b\u3059\u308b\u306e\u3067\u8a31\u3057\u3066\u304f\u3060\u3055\u3044:pray: \n\n\u78ba\u8a8d\u3057\u3066\u307f\u307e\u3057\u3087\u3046\uff1a\n\n```swift\nlet (x, y, d) = bezout(1732, 194)  // (-14, 125, 2)\n1732 * x + 194 * y == d            // true\n```\n\n\u3081\u3067\u305f\u304f\u4e0a\u306e\u8a08\u7b97\u3067\u6c42\u3081\u305f\u901a\u308a\u306e\u7d50\u679c\u304c\u5f97\u3089\u308c\u307e\u3057\u305f\uff01\n\n## \u6539\u3081\u3066\u3001\u5270\u4f59\u74b0\u304c\u4f53\u306b\u306a\u308b\u6761\u4ef6\u3068\u306f\uff1f\n\n\u5143\u3005\u8003\u3048\u305f\u304b\u3063\u305f\u306e\u306f\u300c $\\mathbb{Z}_ n$ \u304c\u4f53\u306b\u306a\u308b\u6761\u4ef6\u306f\u4f55\u304b\uff1f\u300d\u3068\u3044\u3046\u3053\u3068\u3067\u3059\u3002\u3053\u3053\u3067 $a \\in \\mathbb{Z}_n$ \u3068 $n$ \u306b\u5bfe\u3059\u308b\u300c\u30d9\u30ba\u30fc\u306e\u7b49\u5f0f\u300d\u306f\uff1a\n\n```math\nax + ny = \\gcd(a, n)\n```\n\n\u3053\u308c\u3092 $\\bmod{n}$ \u3059\u308b\u3068\u3001$ny$ \u306e\u90e8\u5206\u306f $n$ \u306e\u500d\u6570\u306a\u306e\u3067\u6d88\u3048\u3066\u3001\n\n```math\na \\cdot x \\equiv \\gcd(a, n) \\pmod{n}\n```\n\n\u3053\u3053\u3067\u3082\u3057 $\\gcd(a, n) = 1$ \u306a\u3089\u3070\u3001\u307e\u3055\u3057\u304f\u3053\u306e $x$ \u304c $\\bmod{n}$ \u306b\u304a\u3051\u308b $a$ \u306e\u9006\u6570\u3068\u3044\u3046\u3053\u3068\u306b\u306a\u308a\u307e\u3059\u3002\u9006\u306b $\\gcd(a, n) = d \\ne 1$ \u306a\u3089\u3070\u3001$a \\cdot x \\equiv 1 \\pmod{n}$ \u306a\u308b $x$ \u306f\u3042\u308a\u5f97\u307e\u305b\u3093\uff08$1$ \u304c $d$ \u306e\u500d\u6570\u3068\u3044\u3046\u3053\u3068\u306b\u306a\u3063\u3066\u3057\u307e\u3044\u307e\u3059\uff09\u3002\n\n$\\bmod{n}$ \u3067 $a$ \u306e\u9006\u6570\u304c\u5b58\u5728\u3059\u308b\u6761\u4ef6\u306f\u300c$\\gcd(a, n) = 1$\u300d\u3059\u306a\u308f\u3061\u300c$a, n$ \u306f\u4e92\u306b\u7d20\u300d\u3068\u3044\u3046\u3053\u3068\u3067\u3059\u3002\u305d\u3057\u3066 $\\mathbb{Z}_ n$ \u304c\u300c\u4f53\u300d\u3060\u3068\u3044\u3046\u3053\u3068\u306f\u3001$a = 1 ... n-1$ \u306e**\u5168\u3066**\u306b\u5bfe\u3057\u3066 $n$ \u304c\u4e92\u3044\u306b\u7d20\u3068\u3044\u3046\u3053\u3068\u306a\u306e\u3067\u3001\u6c42\u3081\u308b\u6761\u4ef6\u306f\uff1a\n\n$\\mathbb{Z}_n$ \u304c\u4f53 $\\ \\Leftrightarrow\\ $ $n$ \u306f **\u7d20\u6570**\n\n\u3068\u3044\u3046\u3053\u3068\u3067\u3057\u305f\uff01\n\n\u7d20\u6570\uff08Prime Number\uff09$p$ \u306b\u5bfe\u3057\u3066 $\\mathbb{Z}_ p$ \u3092\u4f53\u3068\u898b\u305f\u3082\u306e\u3092 $\\mathbb{F}_ p$ \u3068\u66f8\u304d\u300c\u4f4d\u6570 $p$ \u306e **\u6709\u9650\u4f53**\u300d\u3068\u8a00\u3044\u307e\u3059\u3002\u5192\u982d\u3067\u898b\u305f\u306e\u306f\u4f4d\u6570 $p = 2, 3, 5, 7$ \u306e\u6709\u9650\u4f53 $\\mathbb{F}_ 2, \\mathbb{F}_ 3, \\mathbb{F}_ 5, \\mathbb{F}_ 7$ \u306e\u4e57\u7b97\u8868\u3067\u3057\u305f\u3002\n\n## \u6709\u9650\u4f53\u3092\u5b9f\u88c5\u3057\u3088\u3046\uff01\n\n\u6700\u5f8c\u306b\u3053\u306e\u6709\u9650\u4f53 `F_<p>` \u3092\u5b9f\u88c5\u3057\u3066\u7d42\u308f\u308a\u307e\u3057\u3087\u3046\u3002\u74b0\u3068\u3057\u3066\u306e\u6f14\u7b97\u306f `Z_<n>` \u3067\u5b9f\u88c5\u6e08\u307f\u306a\u306e\u3067\u3001\u300c\u7a4d\u306b\u95a2\u3059\u308b\u9006\u5143\u300d\u3092\u5b9f\u88c5\u3059\u308c\u3070\u305d\u308c\u3067\u4f53\u3068\u306a\u308a\u307e\u3059\u3002\u4e0a\u3067\u5b9f\u88c5\u3057\u305f `bezout` \u3092\u4f7f\u3063\u3066\uff1a\n\n```swift\nstruct F_<p: TPInt>: Field {\n    let value: Z\n    ...\n\n    var inverse: F_<p> {\n        if value == 0 {\n            fatalError(\"0-inverse\")\n        }\n        \n        // find: a * x + p * y = 1\n        // then: a^-1 = x (mod p)\n        let (x, _, r) = bezout(a, mod)\n\n        if r != 1 {\n            fatalError(\"\\(mod) is non-prime.\")\n        }\n        \n        return F_(x)\n    }\n}\n```\n\n\u3081\u3067\u305f\u304f $\\mathbb{F}_p$ \u3067\u304d\u307e\u3057\u305f\uff01\n\u6700\u5f8c\u306b\u30aa\u30de\u30b1\u3068\u3057\u3066 $\\mathbb{F} _p$ \u306e\u300c\u3079\u304d\u4e57\u8868\u300d\u3092\u898b\u3066\u307f\u307e\u3057\u3087\u3046\uff1a\n\n```\np = 2:\n\n^\t|\t0\t1\n--------------\n1\t|\t1\t1\n```\n\n```\np = 3:\n\n^\t|\t0\t1\t2\n------------------\n1\t|\t1\t1\t1\n2\t|\t1\t2\t1\n```\n\n```\np = 5:\n\n^\t|\t0\t1\t2\t3\t4\n--------------------------\n1\t|\t1\t1\t1\t1\t1\n2\t|\t1\t2\t4\t3\t1\n3\t|\t1\t3\t4\t2\t1\n4\t|\t1\t4\t1\t4\t1\n```\n\n```\np = 7:\n\n^\t|\t0\t1\t2\t3\t4\t5\t6\n----------------------------------\n1\t|\t1\t1\t1\t1\t1\t1\t1\n2\t|\t1\t2\t4\t1\t2\t4\t1\n3\t|\t1\t3\t2\t6\t4\t5\t1\n4\t|\t1\t4\t2\t1\t4\t2\t1\n5\t|\t1\t5\t4\t6\t2\t3\t1\n6\t|\t1\t6\t1\t6\t1\t6\t1\n```\n\n\u3053\u306e\u8868\u306b\u306f `(a, n)` \u6210\u5206\u306b\u300c`a` \u306e `n` \u4e57\u300d\u304c\u8868\u793a\u3055\u308c\u3066\u3044\u307e\u3059\u3002\u5217\u306e\u4e00\u756a\u53f3\u5074\u304c\u5168\u90e8 `1` \u306b\u306a\u3063\u3066\u3044\u307e\u3059\u3002\u3053\u308c\u306f `0` \u3067\u306a\u3044 `a in F_p` \u306b\u5bfe\u3057\u3066 `a ^ (p - 1)` \u304c `F_p` \u3068\u3057\u3066 `1` \u306b\u7b49\u3057\u3044\u3068\u3044\u3046\u3053\u3068\u3067\u3059\u3002\u3064\u307e\u308a\uff1a\n\n> \u3010\u30d5\u30a7\u30eb\u30de\u30fc\u306e\u5c0f\u5b9a\u7406\u3011\n> \u7d20\u6570 $p$ \u3068\u6574\u6570 $a$ \u304c\u4e92\u306b\u7d20\u306e\u3068\u304d\u3001 $a^{p-1} \\equiv 1 \\pmod{p}$\n\n\u3092\u793a\u3057\u3066\u3044\u307e\u3059\uff01\n\n\u524d\u56de\u7d39\u4ecb\u3057\u305f\u300e[\u6642\u8a08\u306e\u4e16\u754c\u306e\u6574\u6570\u8ad6](http://www.slideshare.net/junpeitsuji/maths4pg)\u300f\u3067\u306f\u4ed6\u306b\u3082\u300c\u30aa\u30a4\u30e9\u30fc\u57fa\u6e96\u300d\u3084\u300c\u5e73\u65b9\u5270\u4f59\u306e\u76f8\u4e92\u6cd5\u5247\u300d\u306a\u3069\u3079\u304d\u4e57\u6cd5\u5247\u306b\u95a2\u3059\u308b\u9762\u767d\u3044\u8a71\u304c\u7d39\u4ecb\u3055\u308c\u3066\u3044\u307e\u3059\u3002\u662f\u975e\u898b\u3066\u307f\u3066\u304f\u3060\u3055\u3044\uff01\n\n\u6b21\u56de\u306f\u300c\u591a\u9805\u5f0f\u74b0\u300d\u3092\u4f5c\u308a\u307e\u3059\u3002\u6574\u6570\u74b0\u304b\u3089\u6709\u9650\u4f53\u3092\u4f5c\u3063\u305f\u3088\u3046\u306b\u591a\u9805\u5f0f\u74b0\u304b\u3089\u62e1\u5927\u4f53\u3092\u4f5c\u308b\u306e\u304c\u30b7\u30ea\u30fc\u30ba\u306e\u30b4\u30fc\u30eb\u3067\u3042\u3063\u305f**\u300c\u4ee3\u6570\u62e1\u5927\u300d**\u3067\u3059\u2026\uff01\n\n## \u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\n\nGitHub: [SwiftyAlgebra](https://github.com/taketo1024/SwiftyAlgebra/blob/master/README.md)\n\n* [QuotientRing](https://github.com/taketo1024/SwiftyAlgebra/blob/master/Algebra.playground/Sources/Quotient/QuotientRing.swift)\n* [IntQuotientRing](https://github.com/taketo1024/SwiftyAlgebra/blob/master/Algebra.playground/Sources/Quotient/IntQuotientRing.swift)\n\n## \u5ba3\u4f1d\n* 3/19(\u571f) \u300c[\u7b2c6\u56de \u30d7\u30ed\u30b0\u30e9\u30de\u306e\u305f\u3081\u306e\u6570\u5b66\u52c9\u5f37\u4f1a](http://eventdots.jp/event/582339)\u300d\n* \u30d7\u30ed\u30b0\u30e9\u30de\u306e\u305f\u3081\u306e\u6570\u5b66\u52c9\u5f37\u4f1a [Facebook \u30da\u30fc\u30b8](https://www.facebook.com/\u30d7\u30ed\u30b0\u30e9\u30de\u306e\u305f\u3081\u306e\u6570\u5b66\u52c9\u5f37\u4f1a-1566085336971723/?ref=bookmarks)\n* \u500b\u4eba\u30d6\u30ed\u30b0 [Imaginary & Imaginative](http://taketo1024.hateblo.jp)\n", "tags": ["Swift", "math", "algebra", "\u6570\u5b66", "\u4ee3\u6570\u5b66"]}