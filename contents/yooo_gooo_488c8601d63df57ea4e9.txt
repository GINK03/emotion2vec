{"context": " More than 1 year has passed since last update.\n\n\u4e8b\u524d\u6e96\u5099\n\nGoogle URL Shortener API\u7528\u306bAPI\u30ad\u30fc\u3092\u53d6\u5f97\u3059\u308b\n\u30ca\u30d3\u30b2\u30fc\u30b7\u30e7\u30f3\u30e1\u30cb\u30e5\u30fc\u7528 Google Apps\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u65b0\u898f\u4f5c\u6210\n\u65b0\u898f\u30b9\u30af\u30ea\u30d7\u30c8\u306e\u300cGoogle API\u3092\u4f7f\u7528\u300d\u30e1\u30cb\u30e5\u30fc\u3067API\u30ad\u30fc\u3092\u5165\u529b\nURL Shortener API\u3092ON\n\n\nnavigationMenu.gs\nfunction getShortURL(url) {\n    var long = UrlShortener.newUrl();\n    long.setLongUrl(url);\n    var short = UrlShortener.Url.insert(long);\n    return short.getId();\n}\n\nfunction getNavigationMenu(){\n  var cache = CacheService.getPublicCache().get(\"cache-navi\");\n  if(cache==null){\n    cache = HtmlService.createTemplateFromFile(\"navi\").evaluate().getContent();\n    CacheService.getPublicCache().put(\"cache-navi\", cache, 60*60*24*365);\n  }\n  return cache;\n}\n\n\n\u6c4e\u7528\u30e1\u30cb\u30e5\u30fc\u306e\u30ad\u30e3\u30c3\u30b7\u30e5\u671f\u9593\u306f\u4e00\u5e74\u9593\u306b\u3057\u305f\u3002\n\u6b21\u306bHTML\u3002\n\nnavi.html\n<ul id=\"navigation-menu\" class=\"ui-widget-header ui-corner-all ui-buttonset\">\n  <li><a href=\"<?=getShortURL('https://script.google.com/macros/s/hogehoge1/exec') ?>\">HOME</a></li>\n  <li><a href=\"<?=getShortURL('https://script.google.com/macros/s/hogehoge2/exec') ?>\">INDEX</a></li>\n  <li><a href=\"<?=getShortURL('https://script.google.com/macros/s/hogehoge3/exec') ?>\">BLOG</a></li>\n</ul>\n\n\n\u3000<a>\u30bf\u30b0\u306eURL\u306f\u8cbc\u308a\u305f\u3044\u30ea\u30f3\u30af\u306eURL\u3092\u5165\u308c\u308b\u3002\n\u4e0a\u8a18gs\u3068html\u304c\u51fa\u6765\u305f\u3089\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u30ad\u30fc\u3092 \u30d5\u30a1\u30a4\u30eb>\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u30d7\u30ed\u30d1\u30c6\u30a3 \u30e1\u30cb\u30e5\u30fc\u304b\u3089\u53d6\u5f97\u3002\u203b1\n\n\u672c\u4f53GAS\u6e96\u5099\n\n\u633f\u5165\u3057\u305f\u3044GoogleAppsScript\u3092\u958b\u304f\n\u30ea\u30bd\u30fc\u30b9>\u30e9\u30a4\u30d6\u30e9\u30ea\u7ba1\u7406\u30e1\u30cb\u30e5\u30fc\u3067\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u30ad\u30fc\u203b\uff11\u3092\u5165\u529b\u3002\n\u8b58\u5225\u5b50\u3092\u300cNavigationMenu\u300d\u306b\u3059\u308b\u3002\n\n\u3042\u3068\u306f\u4f5c\u3063\u3066\u3042\u308bHTML\u306e  \u30bf\u30b0\u4e00\u884c\u76ee\u306b\n\n<? output.append(NavigationMenu.getNavigationMenu()); ?>\n\n\u3092\u633f\u5165\u3057\u307e\u3059\u3002\n<head>\u30bf\u30b0\u306bJQuery\u3068JQueryUI\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u57cb\u3081\u8fbc\u3093\u3067\u3042\u308b\u3068\u306a\u304a\u3088\u3044\u3002\n\u3042\u3068\u3001JQueryUI\u7528CSS\u3068\u304b\u30fb\u30fb\u30fb\n  <script type=\"text/javascript\" src=\"http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js\"> </script>\n  <script src=\"https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.21/jquery-ui.min.js\"></script>\n\n<link rel=\"stylesheet\" href=\"http://ajax.googleapis.com/ajax/libs/jqueryui/1.7.2/themes/smoothness/jquery-ui.css\" type=\"text/css\" />\n\n\u3067\u3001\u6700\u5f8c\u306bCSS\u3067\u8abf\u6574\u3057\u307e\u3059\u3002\u305f\u3068\u3048\u3070\u3053\u3093\u306a\u611f\u3058\u3002\n    body,div,ul,li {\n      margin: 0;\n      padding: 0;\n      border: 0;\n    }\n    #navigation-menu  {\n      padding: 2px 2px 2px 2px;\n    }\n    li {\n      display :inline;\n      font-size:12px;\n    }\n\n\n\u305f\u3076\u3093\u3053\u308c\u3067doGet\u3067evaluate()\u3057\u305fHTML\u4e0a\u90e8\u306b\u30ca\u30d3\u30b2\u30fc\u30b7\u30e7\u30f3\u30e1\u30cb\u30e5\u30fc\u304c\u3064\u3044\u3066\u3044\u308b\u306f\u305a\u3002\n###\u4e8b\u524d\u6e96\u5099\n\n+ Google URL Shortener API\u7528\u306bAPI\u30ad\u30fc\u3092\u53d6\u5f97\u3059\u308b\n+ \u30ca\u30d3\u30b2\u30fc\u30b7\u30e7\u30f3\u30e1\u30cb\u30e5\u30fc\u7528 Google Apps\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u65b0\u898f\u4f5c\u6210\n+ \u65b0\u898f\u30b9\u30af\u30ea\u30d7\u30c8\u306e\u300cGoogle API\u3092\u4f7f\u7528\u300d\u30e1\u30cb\u30e5\u30fc\u3067API\u30ad\u30fc\u3092\u5165\u529b\n+ URL Shortener API\u3092ON\n\n```navigationMenu.gs\nfunction getShortURL(url) {\n    var long = UrlShortener.newUrl();\n    long.setLongUrl(url);\n    var short = UrlShortener.Url.insert(long);\n    return short.getId();\n}\n\nfunction getNavigationMenu(){\n  var cache = CacheService.getPublicCache().get(\"cache-navi\");\n  if(cache==null){\n    cache = HtmlService.createTemplateFromFile(\"navi\").evaluate().getContent();\n    CacheService.getPublicCache().put(\"cache-navi\", cache, 60*60*24*365);\n  }\n  return cache;\n}\n```\n\n\u6c4e\u7528\u30e1\u30cb\u30e5\u30fc\u306e\u30ad\u30e3\u30c3\u30b7\u30e5\u671f\u9593\u306f\u4e00\u5e74\u9593\u306b\u3057\u305f\u3002\n\u6b21\u306bHTML\u3002\n\n```navi.html\n<ul id=\"navigation-menu\" class=\"ui-widget-header ui-corner-all ui-buttonset\">\n  <li><a href=\"<?=getShortURL('https://script.google.com/macros/s/hogehoge1/exec') ?>\">HOME</a></li>\n  <li><a href=\"<?=getShortURL('https://script.google.com/macros/s/hogehoge2/exec') ?>\">INDEX</a></li>\n  <li><a href=\"<?=getShortURL('https://script.google.com/macros/s/hogehoge3/exec') ?>\">BLOG</a></li>\n</ul>\n```\n\n\u3000\\<a\\>\u30bf\u30b0\u306eURL\u306f\u8cbc\u308a\u305f\u3044\u30ea\u30f3\u30af\u306eURL\u3092\u5165\u308c\u308b\u3002\n\n\u4e0a\u8a18gs\u3068html\u304c\u51fa\u6765\u305f\u3089\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u30ad\u30fc\u3092 \u30d5\u30a1\u30a4\u30eb>\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u30d7\u30ed\u30d1\u30c6\u30a3 \u30e1\u30cb\u30e5\u30fc\u304b\u3089\u53d6\u5f97\u3002\u203b1\n\n###\u672c\u4f53GAS\u6e96\u5099\n\n1. \u633f\u5165\u3057\u305f\u3044GoogleAppsScript\u3092\u958b\u304f\n2. \u30ea\u30bd\u30fc\u30b9>\u30e9\u30a4\u30d6\u30e9\u30ea\u7ba1\u7406\u30e1\u30cb\u30e5\u30fc\u3067\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u30ad\u30fc\u203b\uff11\u3092\u5165\u529b\u3002\n3. \u8b58\u5225\u5b50\u3092\u300cNavigationMenu\u300d\u306b\u3059\u308b\u3002\n\n\u3042\u3068\u306f\u4f5c\u3063\u3066\u3042\u308bHTML\u306e <HTML><body> \u30bf\u30b0\u4e00\u884c\u76ee\u306b\n\n```\n<? output.append(NavigationMenu.getNavigationMenu()); ?>\n```\n\n\u3092\u633f\u5165\u3057\u307e\u3059\u3002\n\\<head\\>\u30bf\u30b0\u306bJQuery\u3068JQueryUI\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u57cb\u3081\u8fbc\u3093\u3067\u3042\u308b\u3068\u306a\u304a\u3088\u3044\u3002\n\u3042\u3068\u3001JQueryUI\u7528CSS\u3068\u304b\u30fb\u30fb\u30fb\n\n```\n  <script type=\"text/javascript\" src=\"http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js\"> </script>\n  <script src=\"https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.21/jquery-ui.min.js\"></script>\n```\n\n```\n<link rel=\"stylesheet\" href=\"http://ajax.googleapis.com/ajax/libs/jqueryui/1.7.2/themes/smoothness/jquery-ui.css\" type=\"text/css\" />\n```\n\n\u3067\u3001\u6700\u5f8c\u306bCSS\u3067\u8abf\u6574\u3057\u307e\u3059\u3002\u305f\u3068\u3048\u3070\u3053\u3093\u306a\u611f\u3058\u3002\n\n```css\n    body,div,ul,li {\n      margin: 0;\n      padding: 0;\n      border: 0;\n    }\n    #navigation-menu  {\n      padding: 2px 2px 2px 2px;\n    }\n    li {\n      display :inline;\n      font-size:12px;\n    }\n\n```\n\n\n\u305f\u3076\u3093\u3053\u308c\u3067doGet\u3067evaluate()\u3057\u305fHTML\u4e0a\u90e8\u306b\u30ca\u30d3\u30b2\u30fc\u30b7\u30e7\u30f3\u30e1\u30cb\u30e5\u30fc\u304c\u3064\u3044\u3066\u3044\u308b\u306f\u305a\u3002\n\n\n", "tags": ["JavaScript", "GoogleAppsScript"]}