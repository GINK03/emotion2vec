{"context": " More than 1 year has passed since last update.\n\n\u524d\u56de\n\uff11\uff1ahttp://qiita.com/GushiSnow/items/cc1440e0a8ea199e78c5\n\n\u30c7\u30fc\u30bf\u6e96\u5099\u7de8\u5f8c\u7de8\n\n11\uff1aOpenFst\u3092\u7528\u3044\u3066sil\u306b\u304a\u3051\u308b\u91cd\u307f\u4ed8\u304d\u72b6\u614b\u5909\u63db\u5668\u3092\u4f5c\u6210\u3057\u3066\u304a\u304f\u3002\n\u91cd\u307f\u4ed8\u304d\u72b6\u614b\u5909\u63db\u5668\u306b\u3064\u3044\u3066\u8efd\u304f\u8aac\u660e\n\u91cd\u307f\u4ed8\u304d\u72b6\u614b\u5909\u63db\u5668\u306f\u97f3\u58f0\u8a8d\u8b58\u3001\u6a5f\u68b0\u5b66\u7fd2\u3001\u6587\u5b57\u8a8d\u8b58\u306a\u3069\u5e45\u5e83\u304f\u4f7f\u7528\u3055\u308c\u3066\u3044\u308b\u3002Kaldi\u3082\u4f7f\u7528\u3057\u3066\u3044\u308b\u3002\n\u8a73\u7d30\nhttp://www.openfst.org/twiki/bin/view/FST/FstQuickTour\n\u4e0b\u8a18\u306e\u3088\u3046\u306b\u5165\u529b\u3068\u51fa\u529b\u306e\u30da\u30a2\u304c\u3042\u308a\u3001\u305d\u306e\u30da\u30a2\u306b\u5bfe\u3057\u3066\u91cd\u307f\u304c\u3064\u3044\u3066\u304a\u308a\u3001\u521d\u671f\u306e\u72b6\u614b\u304b\u3089\u306e\u5909\u9077\u3092\u8868\u3059\u3002\n\n\u4eca\u56de\u306e\u5834\u5408\u306f\n\u5165\u529b\u304c\u97f3\u7d20\n\u51fa\u529b\u304c\u5358\u8a9e\n\u3068\u306a\u308a\u3001\u4e0b\u8a18\u30b3\u30de\u30f3\u30c9\u3067\u4f5c\u6210\u3055\u308c\u308b\n#sil\u306e\u307f\u51fa\u529b\nutils/make_lexicon_fst_silprob.pl $tmpdir/lexiconp_silprob_disambig.txt $s    rcdir/silprob.txt $silphone '#'$ndisambig | \\\n\n#\u7f6e\u304d\u63db\u3048\u51e6\u7406                               \nsed 's=\\#[0-9][0-9]*=<eps>=g' | \\for indirect one, use twice the learning rate\n\n#\u97f3\u7d20\u3092\u5165\u529b\u3001\u5358\u8a9e\u3092\u51fa\u529b\u3068\u3057\u3066\u91cd\u307f\u4ed8\u304d\u72b6\u614b\u5909\u63db\u5668\u306e\u4f5c\u6210                                      \nfstcompile --isymbols=$dir/phones.txt --osymbols=$dir/words.txt \\      \n--keep_isymbols=false --keep_osymbols=false |   \\ \n\n#\uff11\uff14\uff1a\u91cd\u307f\u4ed8\u304d\u72b6\u614b\u5909\u63db\u5668\u3092\u30bd\u30fc\u30c8\uff1a\u4e0b\u8a18\u306b\u4f8b\u3092\u793a\u3059                     \nfstarcsort --sort_type=olabel > $dir/L.fst || exit 1\n\n\u30bd\u30fc\u30c8\u306e\u4f8b\n\u30bd\u30fc\u30c8\u524d\n\n\u30bd\u30fc\u30c8\u5f8c\n\n\u30bd\u30fc\u30c8\u524d\u3068\u30bd\u30fc\u30c8\u5f8c\u3067\u51fa\u529b\u30e9\u30d9\u30eb\u306e\u6607\u9806\u306b\u4e26\u3093\u3067\u3044\u308b\u3053\u3068\u304c\u308f\u304b\u308b\u3002\n\u4e0a\u56f3\u3067\u306f\u91cd\u307f\u306f\u8868\u793a\u3055\u308c\u3066\u3044\u306a\u3044\u3002\n\u4e0a\u8a18\u306e\u30b3\u30de\u30f3\u30c9\u3067\u51fa\u529b\u3055\u308c\u305ffst\u30d5\u30a1\u30a4\u30eb\u306e\u4e2d\u8eab\u3092\u78ba\u8a8d\u3059\u308b\u65b9\u6cd5\nfstprint --isymbols=./data/lang/phones.txt\uff08\u97f3\u7d20\u30d5\u30a1\u30a4\u30eb\uff09 --osymbols=./data/lang/words.txt\uff08\u5358\u8a9e\u30d5\u30a1\u30a4\u30eb\uff09 ../../../test_japanese/data/lang_test_tg/L.fst\uff08fst\u30d5\u30a1\u30a4\u30eb\uff09 test.txt\uff08\u51fa\u529b\u3055\u308c\u308b\u30d5\u30a1\u30a4\u30eb\uff09\n\n\u51fa\u529b\u3055\u308c\u305f\u30d5\u30a1\u30a4\u30eb\u306e\u4e2d\u8eab\n\n\n\n\u30e9\u30d9\u30eb\n\u6b21\u306b\u9077\u79fb\u3059\u308b\u30e9\u30d9\u30eb\n\u97f3\u7d20\n\u5358\u8a9e\n\u91cd\u307f\n\n\n\n\n0\n1\n\n\n0.693147182\n\n\n0\n1\nSIL\n\n0.693147182\n\n\n1\n1\nSIL\n!SIL\n\n\n\n1\n1\nSIL_E\n'EM\n0.693147182\n\n\n1\n2\nSIL_E\n'EM\n0.693147182\n\n\n1\n1\nSIL_B\nA\n0.693147182\n\n\n1\n2\nSIL_B\nA\n0.693147182\n\n\n1\n\n\n\n\n\n\n2\n1\nSIL\n\n\n\n\n\n\u3053\u308c\u3089\u3092\u56f3\u306b\u76f4\u3057\u3066\u307f\u305f\u3044\u5834\u5408\nshell-session\nfstdraw --isymbols=./data/lang/phones.txt\uff08\u97f3\u7d20\u30d5\u30a1\u30a4\u30eb\uff09 --osymbols=./data/lang/words.txt\uff08\u5358\u8a9e\u30d5\u30a1\u30a4\u30eb\uff09 ../../../test_japanese/data/lang_test_tg/L.fst(fst\u30d5\u30a1\u30a4\u30eb) test.dot\uff08dot\u8a18\u8ff0\u5f0f\u30d5\u30a1\u30a4\u30eb\uff09\n\ndot\u30d5\u30a1\u30a4\u30eb\u3092\u753b\u50cf\u30d5\u30a1\u30a4\u30eb\u306b\u5909\u63db\u3057\u3066\u958b\u304f\ndot -Tjpg test.dot > test.jpg\nxli test.jpg\n\n\u4e0b\u8a18\u306e\u3088\u3046\u306b\u51fa\u529b\u3055\u308c\u308b\n\n\u8868\u3067\u793a\u3057\u305f\u30e9\u30d9\u30eb\u3001\u6b21\u306b\u9077\u79fb\u3059\u308b\u30e9\u30d9\u30eb\u3001\u97f3\u7d20\u3001\u5358\u8a9e\u3001\u91cd\u307f\u3068\u5bfe\u5fdc\u3059\u308b\u3053\u3068\u304c\u5206\u304b\u308b\u3002\n\n\uff11\uff12\uff1autils/sym2int.pl\u3092\u7528\u3044\u3066\u3001\u4e0b\u8a18\u306e\u30d5\u30a1\u30a4\u30eb\u3092int\u5f62\u5f0f\u306b\u5909\u63db\u3059\u308b\u3002\noov.txt\nphones.txt\nroots.txt\nword_boundary.txt\n\n\uff11\uff13\uff1adisambiguation symbols\u306efst\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u6210\u3059\u308b\u3002\n\n\uff11\uff14\uff1a\u51fa\u529b\u3055\u308c\u305f\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092\u30c1\u30a7\u30c3\u30af\u3059\u308b\u3002\n\n\u8a00\u8a9e\u30e2\u30c7\u30eb\u306b\u5bfe\u3057\u3066\u91cd\u307f\u4ed8\u304d\u72b6\u614b\u5909\u63db\u5668\u306e\u4f5c\u6210\u3092\u884c\u3046\ncat $lmdir/lm.arpa | \\                                                                 \ngrep -v '<s> <s>' | \\                                                                \ngrep -v '</s> <s>' | \\                                                               \ngrep -v '</s> </s>' | \\                                                              \narpa2fst - | fstprint | \\                                                            \nutils/remove_oovs.pl $tmpdir/oovs.txt | \\                                            \nutils/eps2disambig.pl | utils/s2eps.pl | fstcompile --isymbols=$test/words.txt \\     \n--osymbols=$test/words.txt  --keep_isymbols=false --keep_osymbols=false | \\        \nfstrmepsilon | fstarcsort --sort_type=ilabel > $test/G.fst                           \n\nfstisstochastic $test/G.fst\n\n\n\n\u7a7a\u6587\u5b57\u306b\u5bfe\u3057\u3066\u3082fst\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u6210\u3059\u308b\nawk '{if(NF==1){ printf(\"0 0 %s %s\\n\", $1,$1); }} END{print \"0 0 #0 #0\"; print \"0\";}' \\\n   < \"$lexicon\"  >$tmpdir/g/select_empty.fst.txt                               \n\n fstcompile --isymbols=$test/words.txt --osymbols=$test/words.txt \\                     \n  $tmpdir/g/select_empty.fst.txt | \\\n\n fstarcsort --sort_type=olabel | fstcompose - $test/G.fst > $tmpdir/g/empty_words.fst   \n\n fstinfo $tmpdir/g/empty_words.fst | grep cyclic | grep -w 'y' &&                       \n echo \"Language model has cycles with empty words\" && exit 1                          \n\n rm -rf $tmpdir    \n\n\u3053\u308c\u3067\u30c7\u30fc\u30bf\u6e96\u5099\u306f\u7d42\u4e86\u3067\u3059\u3002\n\u6b21\u304b\u3089\u306f\u30c7\u30fc\u30bf\u304b\u3089\u306e\u7279\u5fb4\u91cf\u62bd\u51fa\u306b\u5165\u308a\u307e\u3059\u3002\n#\u524d\u56de\n\n\uff11\uff1ahttp://qiita.com/GushiSnow/items/cc1440e0a8ea199e78c5\n\n#\u30c7\u30fc\u30bf\u6e96\u5099\u7de8\u5f8c\u7de8\n\n####11\uff1aOpenFst\u3092\u7528\u3044\u3066sil\u306b\u304a\u3051\u308b\u91cd\u307f\u4ed8\u304d\u72b6\u614b\u5909\u63db\u5668\u3092\u4f5c\u6210\u3057\u3066\u304a\u304f\u3002\n\n\u91cd\u307f\u4ed8\u304d\u72b6\u614b\u5909\u63db\u5668\u306b\u3064\u3044\u3066\u8efd\u304f\u8aac\u660e\n\n\u91cd\u307f\u4ed8\u304d\u72b6\u614b\u5909\u63db\u5668\u306f\u97f3\u58f0\u8a8d\u8b58\u3001\u6a5f\u68b0\u5b66\u7fd2\u3001\u6587\u5b57\u8a8d\u8b58\u306a\u3069\u5e45\u5e83\u304f\u4f7f\u7528\u3055\u308c\u3066\u3044\u308b\u3002Kaldi\u3082\u4f7f\u7528\u3057\u3066\u3044\u308b\u3002\n\n\u8a73\u7d30\nhttp://www.openfst.org/twiki/bin/view/FST/FstQuickTour\n\n\u4e0b\u8a18\u306e\u3088\u3046\u306b\u5165\u529b\u3068\u51fa\u529b\u306e\u30da\u30a2\u304c\u3042\u308a\u3001\u305d\u306e\u30da\u30a2\u306b\u5bfe\u3057\u3066\u91cd\u307f\u304c\u3064\u3044\u3066\u304a\u308a\u3001\u521d\u671f\u306e\u72b6\u614b\u304b\u3089\u306e\u5909\u9077\u3092\u8868\u3059\u3002\n\n![symbolicfst.jpg](https://qiita-image-store.s3.amazonaws.com/0/10496/3d7192ac-393c-7918-deb1-4e728b412447.jpeg)\n\n\u4eca\u56de\u306e\u5834\u5408\u306f\n\n\u5165\u529b\u304c\u97f3\u7d20\n\u51fa\u529b\u304c\u5358\u8a9e\n\n\u3068\u306a\u308a\u3001\u4e0b\u8a18\u30b3\u30de\u30f3\u30c9\u3067\u4f5c\u6210\u3055\u308c\u308b\n\n```shelll\n#sil\u306e\u307f\u51fa\u529b\nutils/make_lexicon_fst_silprob.pl $tmpdir/lexiconp_silprob_disambig.txt $s    rcdir/silprob.txt $silphone '#'$ndisambig | \\\n\n#\u7f6e\u304d\u63db\u3048\u51e6\u7406                               \nsed 's=\\#[0-9][0-9]*=<eps>=g' | \\for indirect one, use twice the learning rate\n\n#\u97f3\u7d20\u3092\u5165\u529b\u3001\u5358\u8a9e\u3092\u51fa\u529b\u3068\u3057\u3066\u91cd\u307f\u4ed8\u304d\u72b6\u614b\u5909\u63db\u5668\u306e\u4f5c\u6210                                      \nfstcompile --isymbols=$dir/phones.txt --osymbols=$dir/words.txt \\      \n--keep_isymbols=false --keep_osymbols=false |   \\ \n\n#\uff11\uff14\uff1a\u91cd\u307f\u4ed8\u304d\u72b6\u614b\u5909\u63db\u5668\u3092\u30bd\u30fc\u30c8\uff1a\u4e0b\u8a18\u306b\u4f8b\u3092\u793a\u3059                     \nfstarcsort --sort_type=olabel > $dir/L.fst || exit 1\n```\n\u30bd\u30fc\u30c8\u306e\u4f8b\n\n\u30bd\u30fc\u30c8\u524d\n\n![arcsort1.jpg](https://qiita-image-store.s3.amazonaws.com/0/10496/f35d33ec-64c4-e69b-4206-3fcd0ad3a119.jpeg)\n\n\u30bd\u30fc\u30c8\u5f8c\n![arcsort3.jpg](https://qiita-image-store.s3.amazonaws.com/0/10496/73c3d570-b20f-2d87-09d3-692568a0cfbd.jpeg)\n\n\n\u30bd\u30fc\u30c8\u524d\u3068\u30bd\u30fc\u30c8\u5f8c\u3067\u51fa\u529b\u30e9\u30d9\u30eb\u306e\u6607\u9806\u306b\u4e26\u3093\u3067\u3044\u308b\u3053\u3068\u304c\u308f\u304b\u308b\u3002\n\u4e0a\u56f3\u3067\u306f\u91cd\u307f\u306f\u8868\u793a\u3055\u308c\u3066\u3044\u306a\u3044\u3002\n\n\u4e0a\u8a18\u306e\u30b3\u30de\u30f3\u30c9\u3067\u51fa\u529b\u3055\u308c\u305ffst\u30d5\u30a1\u30a4\u30eb\u306e\u4e2d\u8eab\u3092\u78ba\u8a8d\u3059\u308b\u65b9\u6cd5\n\n```shell-session\nfstprint --isymbols=./data/lang/phones.txt\uff08\u97f3\u7d20\u30d5\u30a1\u30a4\u30eb\uff09 --osymbols=./data/lang/words.txt\uff08\u5358\u8a9e\u30d5\u30a1\u30a4\u30eb\uff09 ../../../test_japanese/data/lang_test_tg/L.fst\uff08fst\u30d5\u30a1\u30a4\u30eb\uff09 test.txt\uff08\u51fa\u529b\u3055\u308c\u308b\u30d5\u30a1\u30a4\u30eb\uff09\n```\n\u51fa\u529b\u3055\u308c\u305f\u30d5\u30a1\u30a4\u30eb\u306e\u4e2d\u8eab\n\n|  \u30e9\u30d9\u30eb |\u6b21\u306b\u9077\u79fb\u3059\u308b\u30e9\u30d9\u30eb| \u97f3\u7d20|\u5358\u8a9e|\u91cd\u307f |\n|:-----------|------------:|:------------:|:------------:|:------------:|\n|0 |      1| <eps> |  <eps> |  0.693147182\n|0 |      1| SIL   |  <eps> |  0.693147182\n|1 |      1| SIL   |  !SIL|\n|1 |      1| SIL_E |  'EM |    0.693147182\n|1 |      2| SIL_E |  'EM |    0.693147182\n|1 |      1| SIL_B |  A   |    0.693147182\n|1 |      2| SIL_B |  A   |    0.693147182\n|1|||\n|2 |      1 |SIL   |  <eps>|\n\n\u3053\u308c\u3089\u3092\u56f3\u306b\u76f4\u3057\u3066\u307f\u305f\u3044\u5834\u5408\n```shell-session\nfstdraw --isymbols=./data/lang/phones.txt\uff08\u97f3\u7d20\u30d5\u30a1\u30a4\u30eb\uff09 --osymbols=./data/lang/words.txt\uff08\u5358\u8a9e\u30d5\u30a1\u30a4\u30eb\uff09 ../../../test_japanese/data/lang_test_tg/L.fst(fst\u30d5\u30a1\u30a4\u30eb) test.dot\uff08dot\u8a18\u8ff0\u5f0f\u30d5\u30a1\u30a4\u30eb\uff09\n```\n\ndot\u30d5\u30a1\u30a4\u30eb\u3092\u753b\u50cf\u30d5\u30a1\u30a4\u30eb\u306b\u5909\u63db\u3057\u3066\u958b\u304f\n\n```shell-session\ndot -Tjpg test.dot > test.jpg\nxli test.jpg\n```\n\u4e0b\u8a18\u306e\u3088\u3046\u306b\u51fa\u529b\u3055\u308c\u308b\n\n![test2.jpg](https://qiita-image-store.s3.amazonaws.com/0/10496/8dcf4a6f-06ff-7a52-2732-010eca18b099.jpeg)\n\n\u8868\u3067\u793a\u3057\u305f\u30e9\u30d9\u30eb\u3001\u6b21\u306b\u9077\u79fb\u3059\u308b\u30e9\u30d9\u30eb\u3001\u97f3\u7d20\u3001\u5358\u8a9e\u3001\u91cd\u307f\u3068\u5bfe\u5fdc\u3059\u308b\u3053\u3068\u304c\u5206\u304b\u308b\u3002\n\n####\uff11\uff12\uff1autils/sym2int.pl\u3092\u7528\u3044\u3066\u3001\u4e0b\u8a18\u306e\u30d5\u30a1\u30a4\u30eb\u3092int\u5f62\u5f0f\u306b\u5909\u63db\u3059\u308b\u3002\n\noov.txt\nphones.txt\nroots.txt\nword_boundary.txt\n\n####\uff11\uff13\uff1adisambiguation symbols\u306efst\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u6210\u3059\u308b\u3002\n\n####\uff11\uff14\uff1a\u51fa\u529b\u3055\u308c\u305f\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092\u30c1\u30a7\u30c3\u30af\u3059\u308b\u3002\n\n##\u8a00\u8a9e\u30e2\u30c7\u30eb\u306b\u5bfe\u3057\u3066\u91cd\u307f\u4ed8\u304d\u72b6\u614b\u5909\u63db\u5668\u306e\u4f5c\u6210\u3092\u884c\u3046\n\n```shell-session\ncat $lmdir/lm.arpa | \\                                                                 \ngrep -v '<s> <s>' | \\                                                                \ngrep -v '</s> <s>' | \\                                                               \ngrep -v '</s> </s>' | \\                                                              \narpa2fst - | fstprint | \\                                                            \nutils/remove_oovs.pl $tmpdir/oovs.txt | \\                                            \nutils/eps2disambig.pl | utils/s2eps.pl | fstcompile --isymbols=$test/words.txt \\     \n--osymbols=$test/words.txt  --keep_isymbols=false --keep_osymbols=false | \\        \nfstrmepsilon | fstarcsort --sort_type=ilabel > $test/G.fst                           \n\nfstisstochastic $test/G.fst\n\n```\n\n###\u7a7a\u6587\u5b57\u306b\u5bfe\u3057\u3066\u3082fst\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u6210\u3059\u308b\n\n```shell-session\nawk '{if(NF==1){ printf(\"0 0 %s %s\\n\", $1,$1); }} END{print \"0 0 #0 #0\"; print \"0\";}' \\\n   < \"$lexicon\"  >$tmpdir/g/select_empty.fst.txt                               \n         \n fstcompile --isymbols=$test/words.txt --osymbols=$test/words.txt \\                     \n  $tmpdir/g/select_empty.fst.txt | \\\n                                                   \n fstarcsort --sort_type=olabel | fstcompose - $test/G.fst > $tmpdir/g/empty_words.fst   \n\n fstinfo $tmpdir/g/empty_words.fst | grep cyclic | grep -w 'y' &&                       \n echo \"Language model has cycles with empty words\" && exit 1                          \n\n rm -rf $tmpdir    \n```\n\n\u3053\u308c\u3067\u30c7\u30fc\u30bf\u6e96\u5099\u306f\u7d42\u4e86\u3067\u3059\u3002\n\u6b21\u304b\u3089\u306f\u30c7\u30fc\u30bf\u304b\u3089\u306e\u7279\u5fb4\u91cf\u62bd\u51fa\u306b\u5165\u308a\u307e\u3059\u3002\n", "tags": ["Kaldi", "\u97f3\u58f0\u8a8d\u8b58"]}