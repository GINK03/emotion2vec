{"context": "\n\n\u6982\u8981\nJenkins Plugin\u3092\u4f7f\u3046\u3068Jenkins\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u3092\u4e0a\u3052\u305f\u6642\u306b\u52d5\u4f5c\u3057\u306a\u304f\u306a\u3063\u305f\u308a\u3001\u305d\u3082\u305d\u3082GUI\u8a2d\u5b9a\u304c\u9762\u5012\u3060\u3063\u305f\u308a\u3067\u3001\u5b9f\u306f\u30b7\u30a7\u30eb\u3067\u66f8\u3044\u305f\u65b9\u304c\u697d\u3058\u3083\u3093\u3002\u3068\u601d\u3063\u3066\u3044\u308b\u306e\u3067\u305d\u3046\u3057\u307e\u3059\u3002\n\uff08\u5168\u304f\u4f7f\u308f\u306a\u3044\u308f\u3051\u3067\u306f\u306a\u304f\u3001Jenkins2\u3067\u306e\u304a\u52e7\u3081Plugin\u3092\u305d\u306e\u307e\u307e\u5165\u308c\u3068\u304f\u3050\u3089\u3044\u306f\u3084\u308a\u307e\u3059\uff09\n\u6642\u304c\u7d4c\u3064\u306e\u306f\u65e9\u3044\u3082\u306e\u3067\u3001Hudson\u5144\u3055\u3093\u3067\u3057\u305f\u304c\u3001\u3044\u3064\u306e\u9593\u306b\u3084\u3089Jenkins\u304a\u3058\u3055\u3093\u3067\u3059\u3002\nJenkins\u3082\u30d0\u30fc\u30b8\u30e7\u30f32\u304c\u51fa\u3066\u3001Jenkinsfile\u306a\u3069\u304c\u3042\u308a\u3001\u4fbf\u5229\u306b\u306a\u308a\u3064\u3064\u3042\u308a\u307e\u3059\u3002\u304c\u3001\u305d\u308c\u3067\u3082\u30b7\u30a7\u30eb\u3067\u3084\u308a\u307e\u3059\u3002\n\u305d\u3082\u305d\u3082\u3001\u3044\u307e\u3069\u304d\u306ffastlane\u3067\u30d3\u30eb\u30c9\u3057\u305f\u308a\u3001Web\u30b5\u30fc\u30d3\u30b9\u4f7f\u3063\u305f\u308a\u3068\u601d\u3044\u307e\u3059\u3002\u304c\u3001Jenkins + \u30b7\u30a7\u30eb\u3067\u3084\u308a\u307e\u3059\u3002\n\u30b7\u30a7\u30eb\u3067\u66f8\u3044\u3066\u304a\u304f\u30e1\u30ea\u30c3\u30c8\u306f\u3001\u30b3\u30de\u30f3\u30c9\u30ec\u30d9\u30eb\u3067\u4f55\u3092\u3057\u3066\u3044\u308b\u306e\u304b\u304c\u7406\u89e3\u3067\u304d\u308b\u3053\u3068\u3067\u3057\u3087\u3046\u3002\n\n\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\nhomebrew\u3067\u5165\u308c\u3066\u307e\u3059\u3002\n$ brew update\n$ brew cask install java\n$ brew install jenkins\n\n\u8a2d\u5b9a\u306f\u30cd\u30c3\u30c8\u3067\u63a2\u305b\u3070\u3059\u3050\u51fa\u3066\u304f\u308b\u306e\u3067\u5272\u611b\u3002\n\n\u60f3\u5b9a\u904b\u7528\njenkins\u306e\u30d1\u30e9\u30e1\u30fc\u30bf\u30fc\u4ed8\u304d\u30d3\u30eb\u30c9\u3092\u4f7f\u3044\u3001\u4ee5\u4e0b\u306e2\u70b9\u3092\u6307\u5b9a\u3057\u3066\u30d3\u30eb\u30c9\u3067\u304d\u308b\u3088\u3046\u306b\u3057\u307e\u3059\u3002\n\ngit\u306e\u30d6\u30e9\u30f3\u30c1\n\u63a5\u7d9a\u5148\u30b5\u30fc\u30d0\u30fc\u540d(develop,staging,production\u306a\u3069)\n\n\u3053\u3093\u306a\u904b\u7528\u3092\u60f3\u5b9a\u3057\u3066\u3044\u307e\u3059\u3002\n\ngithub\u3067push\u3057\u305f\u3053\u3068\u3092\u691c\u77e5\u3059\u308bJob\u304c\u3053\u306eJob\u304c\u547c\u3073\u3060\u3057\u307e\u3059\u3002\uff08\u5225\u306e\u8a18\u4e8b\u3067\u66f8\u304d\u307e\u3059\uff09\n\u30b9\u30c6\u30fc\u30b8\u30f3\u30b0\u3068\u672c\u756a\u74b0\u5883\u63a5\u7d9a\u7528\u30a2\u30d7\u30ea\u3092\u5171\u5b58\u3067\u304d\u308b\u3088\u3046\u306b\u4e8c\u3064\u306e\u30d7\u30ed\u30d3\u30b8\u30cb\u30f3\u30b0\u30d5\u30a1\u30a4\u30eb(\u5225\u3005\u306eBundle Identifier)\u3092\u7528\u610f\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n\u30d3\u30eb\u30c9\u6642\u306bCFBundleShortVersionString\u306b\u3069\u306ebranch\u30fb\u63a5\u7d9a\u5148\u306e\u7d44\u5408\u305b\u306e\u30a2\u30d7\u30ea\u306a\u306e\u304b\u304c\u308f\u304b\u308b\u3088\u3046\u306bsuffix\u3092\u5165\u308c\u307e\u3059\u3002\n(\u4f8b\u3048\u3070\u3001review\u30d6\u30e9\u30f3\u30c1+staging\u30b5\u30fc\u30d0=.alpha, release\u30d6\u30e9\u30f3\u30c1+staging\u30b5\u30fc\u30d0=.beta\u306a\u3069)\n\u30d3\u30eb\u30c9\u5f8c\u306f\u3001Fabric\u3092\u5229\u7528\u3057\u3066\u81ea\u52d5\u3067\u30c6\u30b9\u30c8\u7aef\u672b\u306b\u914d\u4fe1\u3057\u307e\u3059\u3002\nFabric\u3067\u898b\u305f\u3068\u304d\u306b\u30d0\u30fc\u30b8\u30e7\u30f3\u3092\u898b\u308c\u3070\u30012\u3067\u8a2d\u5b9a\u3057\u305fsuffix\u304c\u3042\u308b\u306e\u3067\u3001\u63a5\u7d9a\u5148\u304c\u308f\u304b\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\n\n\nJob\n\nJenkins\u306eGUI\u8a2d\u5b9a\n\u307e\u305a\u306f\u3001GUI\u4e0a\u3067\u8a18\u8ff0\u3057\u307e\u3059\n\n\u30d3\u30eb\u30c9\u306e\u30d1\u30e9\u30e1\u30fc\u30bf\u5316\u306b\u30c1\u30a7\u30c3\u30af\u3092\u5165\u308c\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u3057\u307e\u3059\u3002\n\n\n\n\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u7ba1\u7406\u306e   Branch Specifier\u3067\u4e0a\u8a18\u306e\u30d1\u30e9\u30e1\u30fc\u30bf\u3067\u8a2d\u5b9a\u3057\u305f\u5909\u6570\u3092\u8a18\u8ff0\u3057\u307e\u3059\u3002\n\n\n\n\u30d3\u30eb\u30c9\u306e\u30b7\u30a7\u30eb\u306e\u5b9f\u884c\u3092\u8a18\u8ff0\u3057\u307e\u3059\u3002\n~PROVISIONING_PROFILE\u306f\u7aef\u672b\u3092\u767b\u9332\u3059\u308b\u305f\u3073\u306b\u5909\u308f\u308b\u306e\u3067\u3001git\u3067\u7ba1\u7406\u3057\u305f\u5024\u3092\u4f7f\u3046\u3068tags\u304b\u3089\u904e\u53bb\u30d0\u30fc\u30b8\u30e7\u30f3\u304c\u30d3\u30eb\u30c9\u3067\u304d\u306a\u304f\u306a\u308b\u306e\u3067GUI\u304b\u3089\u6e21\u3059\u3088\u3046\u306b\u3057\u307e\u3059\u3002\n\u63a5\u7d9a\u3059\u308b\u74b0\u5883\u306b\u3088\u3063\u3066\u5229\u7528\u3059\u308bPROVISIONING_PROFILE\u304c\u9055\u3046\u306e\u3067\u5206\u5c90\u3057\u3066\u3044\u307e\u3059\u3002\n\u3042\u3068\u306f\u3001~\ngit\u3067\u7ba1\u7406\u3057\u3066\u3044\u308b\u30b7\u30a7\u30eb\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u547c\u3073\u51fa\u3059\u3060\u3051\u3067\u3059\u3002\n\n#!/bin/bash -l\nexport WORKSPACE\nsh -x ${WORKSPACE}/jenkins/main.sh $branch $server\n\n\u8ffd\u8a18\ncocoapods\u3067\u3001use_frameworks!\u306e\u3088\u3046\u306b\u30d5\u30ec\u30fc\u30e0\u30ef\u30fc\u30af\u3068\u3057\u3066\u30e9\u30a4\u30d6\u30e9\u30ea\u3092\u53d6\u308a\u8fbc\u3080\u3068xcodebuild\u6642\u306bPROVISIONING_PROFILE\u306e\u6307\u5b9a\u3092\u3059\u308b\u3068\u3067\u304d\u307e\u305b\u3093\u3002\u305d\u3082\u305d\u3082-exportOptionsPlist\u3092\u4f7f\u3063\u3066\u3044\u308c\u3070PROVISIONINGPROFILE\u306e\u6307\u5b9a\u306f\u5fc5\u8981\u306a\u3044\u306e\u3067\u524a\u9664\u3057\u307e\u3057\u305f\u3002\u3069\u306ePROVISIONING_PROFILE\u3092\u5229\u7528\u3059\u308b\u304b\u306fXcode\u3067\u306eBuild Settings\u5185\u306eCode Signing Identitiy\u3067\u8a2d\u5b9a\u3057\u3066\u304a\u3051\u3070\u826f\u3044\u3067\u3059\u3002\n\nJenkins\u5916\u306e\u30b7\u30a7\u30eb\ngit\u3067\u7ba1\u7406\u3057\u307e\u3059\u3002\u305d\u308c\u305e\u308c\u52d5\u304f\u5358\u4f4d\u3067\u5225\u306e\u30b7\u30a7\u30eb\u306b\u3057\u307e\u3059\u3002 \n$shellFilePath \u306f\u30b7\u30a7\u30eb\u30d5\u30a1\u30a4\u30eb\u306e\u30d1\u30b9\u3067\u3059\u3002\nmain.sh\u306f\u3001\u305d\u308c\u3089\u30b7\u30a7\u30eb\u3092\u547c\u3073\u51fa\u3059\u30b7\u30a7\u30eb\u306b\u306a\u308a\u307e\u3059\u3002\n\nmain.sh\n#!/bin/bash -l\nset -eux\n: usage\n: sh -x ~/jenkins/build.sh develop staging\n\n: $1 $2\nbranch=$1\nserver=$2\n\nshellFilePath=\"${WORKSPACE}/jenkins\"\n\n# \u30af\u30ea\u30fc\u30f3\u51e6\u7406\n. ${shellFilePath}/clean.sh\nclean\ninstall\n\n. ${shellFilePath}/setupVariable.sh\nsetupVar $branch $server\n# suffix,buildType,fileName,groupAlias\u304c\u8a2d\u5b9a\u3055\u308c\u308b\n. ${shellFilePath}/setupVariable.sh\n\n. ${shellFilePath}/replaceVersion.sh\nreplaceVersion $suffix\n# CFBundleShortVersionString,CFBundleVersion\u304c\u8a2d\u5b9a\u3055\u308c\u308b\n. ${shellFilePath}/replaceVersion.sh\n\nbuildPath=\"${WORKSPACE}/build/${buildType}-iphoneos\"\n\n. ${shellFilePath}/archive.sh\narchive $buildType \"$buildPath\"\n\n. ${shellFilePath}/exportIpa.sh\nexportIpa \"$buildPath\" \"$fileName\"\nrenameIpa \"$buildPath\" $fileName $CFBundleShortVersionString $CFBundleVersion\n# newFileName\u304c\u8a2d\u5b9a\u3055\u308c\u308b\n. ${shellFilePath}/exportIpa.sh\nnewPathName=\"${buildPath}/$newFileName\"\nzipDSYM $fileName \"$newPathName\"\n\n# crashlytics send\n. ${shellFilePath}/sendFabric.sh\nsend \"$newPathName\" $groupAlias\n\n\n\n\u30af\u30ea\u30fc\u30f3\u3068Cocoapods\u306e\u51e6\u7406\n\u4ee5\u4e0b\u3092\u884c\u3044\u307e\u3059\u3002\n\n\nxcodebuild clean\u3000\u3068 build\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u4ee5\u4e0b\u306e\u524a\u9664\npod install\n\n\nclean.sh\n#!/bin/bash -l\nset -eux\n\nfunction clean() {\n    xcodebuild clean -workspace ${WORKSPACE}/\uff1c\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u540d\uff1e.xcworkspace \\\n    -scheme \uff1c\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u540d\uff1e\n    rm -rf ${WORKSPACE}/build/*\n}\n\nfunction install() {\n    pushd \uff1c\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u540d\uff1e\n    pod install\n    popd\n}\n\n\n\n\u5909\u6570\u8a2d\u5b9a\u51e6\u7406\nJob\u5185\u306e\u51e6\u7406\u3067\u5229\u7528\u3059\u308b\u5909\u6570\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n$groupAlias \u306fFabric Beta\u3067\u914d\u4fe1\u3059\u308b\u30b0\u30eb\u30fc\u30d7\u540d\u3067\u3059\u3002\n$suffix \u306f\u8868\u793a\u3055\u308c\u308b\u30d0\u30fc\u30b8\u30e7\u30f3\u306esuffix\u3067\u3059\u3002\u4f8b\uff1a1.0.0.beta\u306ebeta\u90e8\u5206\n$buildType \u306f\u3001archive\u6642\u306e -configuration \u306b\u6307\u5b9a\u3059\u308b\u5024\u3002\n\u3061\u306a\u307f\u306b\u30d6\u30e9\u30f3\u30c1\u904b\u7528\u306f\u901a\u5e38develop\u30d6\u30e9\u30f3\u30c1\u3067\u958b\u767a\u3092\u884c\u3044\u3001\u30b9\u30d7\u30ea\u30f3\u30c8\u30ec\u30d3\u30e5\u30fc\u306e\u5ea6\u306breview\u30d6\u30e9\u30f3\u30c1\u306bPush\u3057\u3066\u3001\u7dcf\u5408\u30c6\u30b9\u30c8\u304c\u59cb\u307e\u3063\u305f\u3089release\u30d6\u30e9\u30f3\u30c1\u306bPush\u3057\u3066\u3044\u307e\u3059\u3002\n\nsetupVariable.sh\n#!/bin/bash -l\nset -ux\n\nsetupVar() {\n    : usage\n    : '$1=branch name, $2=server name'\n    : $1 $2\n\n    local branch=$1\n    local server=$2\n\n    # \u5909\u6570\u8a2d\u5b9a\n    if [ $server = \"staging\" ]; then\n      buildType=\"Staging\"\n      fileName=\"\u30b9\u30c6\u30fc\u30b8\u30f3\u30b0\"\n      if [ $branch = \"review\" ]; then\n        suffix=\"alpha\"\n        groupAlias='appteam,serverteam'\n      elif [ $branch = \"release\" ]; then\n        suffix=\"beta\"\n        groupAlias='pmteam,appteam,serverteam,planningteam'\n      fi\n    elif [ $server = \"production\" ]; then\n      buildType=\"Release\"\n      fileName=\"\u672c\u756a\u74b0\u5883\"\n      if [ $branch = \"release\" ]; then\n        suffix=\"rc\"\n        groupAlias='pmteam,appteam,serverteam,planningteam'\n      elif [ $branch = \"master\" ]; then\n        suffix=\"gm\"\n        groupAlias='pmteam,appteam,serverteam,planningteam,manager'\n      fi\n    fi\n\n    # \u4e0a\u8a18\u3067\u8a2d\u5b9a\u3055\u308c\u306a\u304b\u3063\u305f\u5834\u5408(\u6700\u521d\u306e\u300csuffix=\u300d\u306f\u982d\u306b:\u304c\u3042\u308c\u3070\u306a\u304f\u3066\u3082\u826f\u3044\u304cdebug\u7528\u306b\u8a18\u8ff0)\n    suffix=${suffix:-\"develop\"}\n    buildType=${buildType:-\"Debug\"}\n    fileName=${fileName:-\"\u958b\u767a\u74b0\u5883\"}\n    groupAlias=${groupAlias:-\"appteam,serverteam\"}\n}\n\n\n\n\u8868\u793a\u30d0\u30fc\u30b8\u30e7\u30f3\u5909\u66f4\nFabric\u3067\u898b\u305f\u3068\u304d\u306b\u3069\u306e\u74b0\u5883\u306a\u306e\u304b\u304c\u308f\u304b\u308b\u3088\u3046\u306b\u30d0\u30fc\u30b8\u30e7\u30f3\u306bsuffix\u3092\u3064\u3051\u308b\u51e6\u7406\u3067\u3059\u3002\n\u30d3\u30eb\u30c9\u756a\u53f7\u3082Jenkins\u306e\u30d3\u30eb\u30c9\u756a\u53f7\u306b\u3057\u307e\u3059\u3002\n\nreplaceVersion.sh\n#!/bin/bash -l\nset -ux\n\nreplaceVersion(){\n    : usage\n    : 'arg $1=suffix'\n    : $1\n\n    local suffix=$1\n    CFBundleShortVersionString=`/usr/libexec/PlistBuddy -c \"Print CFBundleShortVersionString\" ${WORKSPACE}/\uff1c\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u540d\uff1e/Supporting\\ Files/\uff1c\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u540d\uff1e-Info.plist`\n    CFBundleVersion=`/usr/libexec/PlistBuddy -c \"Print CFBundleVersion\" ${WORKSPACE}/\uff1c\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u540d\uff1e/Supporting\\ Files/\uff1c\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u540d\uff1e-Info.plist`\n    /usr/libexec/PlistBuddy -c \"Set :CFBundleShortVersionString ${CFBundleShortVersionString}.${suffix}\" ${WORKSPACE}/\uff1c\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u540d\uff1e/Supporting\\ Files/\uff1c\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u540d\uff1e-Info.plist\n    /usr/libexec/PlistBuddy -c \"Set :CFBundleVersion ${BUILD_NUMBER}\" ${WORKSPACE}/\uff1c\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u540d\uff1e/Supporting\\ Files/\uff1c\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u540d\uff1e-Info.plist\n\n    CFBundleShortVersionString=`/usr/libexec/PlistBuddy -c \"Print CFBundleShortVersionString\" ${WORKSPACE}/\uff1c\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u540d\uff1e/\uff1c\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u540d\uff1e/Supporting\\ Files/\uff1c\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u540d\uff1e-Info.plist`\n    CFBundleVersion=`/usr/libexec/PlistBuddy -c \"Print CFBundleVersion\" ${WORKSPACE}/\uff1c\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u540d\uff1e/Supporting\\ Files/\uff1c\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u540d\uff1e-Info.plist`\n}\n\n\n\n\n\u30a2\u30fc\u30ab\u30a4\u30d6\u51e6\u7406\n2\u756a\u76ee\u306e\u5f15\u6570\u306e `$buildPath \u306b\u306f\u30d3\u30eb\u30c9\u30d1\u30b9\u304c\u5165\u3063\u3066\u3044\u307e\u3059\u3002\uff08\u4f8b: ${WORKSPACE}/build/Debug-iphoneos\uff09\n\u305d\u3053\u3067\u6307\u5b9a\u3057\u305f\u5834\u6240\u306b xcarchive \u304c\u4f5c\u6210\u3055\u308c\u307e\u3059\u3002\n#!/bin/bash -l\nset -ux\n\narchive() {\n    : usage\n    : 'arg $1=buildType $2=buildPath $3=fileName\n\n    : $1 $2 $3\n    local buildType=$1\n    local buildPath=$2\n    local fileName=$3\n\n    # arhive\u51e6\u7406\n    xcodebuild -workspace \"${WORKSPACE}/\uff1c\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u540d\uff1e/\uff1c\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u540d\uff1e.xcworkspace\" \\\n    -scheme \uff1c\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u540d\uff1e \\\n    -configuration \"${buildType}\" \\\n    archive -archivePath \"${buildPath}/${fileName}.xcarchive\"\n}\n\n\nIPA\u4f5c\u6210\u51e6\u7406\nxcarchive\u304b\u3089ipa\u3068\u305d\u306edSYM\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\nexportIpa.sh\n#!/bin/bash -l\nset -ux\n\nexportIpa() {\n    : usage\n    : 'arg $1=buildPath $2=fileName $3=buildType\n    : $1 $2 $3\n\n    local buildPath=$1\n    local fileName=$2\n    local buildType=$3\n    xcodebuild \\\n        -exportArchive -archivePath \"${buildPath}/${fileName}.xcarchive\" \\\n        -exportPath \"${buildPath}\" \\\n        -exportOptionsPlist \"${WORKSPACE}/jenkins/exportOptions_${buildType}.plist\"\n}\n\nrenameIpa() {\n    : usage\n    : 'arg $1=buildPath $2=fileName $3=CFBundleShortVersionString $4=CFBundleVersion'\n    : $1 $2 $3 $4\n\n    local buildPath=$1\n    local fileName=$2\n    local CFBundleShortVersionString=$3\n    local CFBundleVersion=$4\n    local now=`date +\"%Y.%m.%d\"`\n\n    mv \"${buildPath}/<\u30d7\u30ed\u30c0\u30af\u30c8\u540d>.ipa\" \"${buildPath}/${fileName}-v${CFBundleShortVersionString}-${CFBundleVersion}-${now}.ipa\"\n    newFileName=${fileName}-v${CFBundleShortVersionString}-${CFBundleVersion}-${now}\n}\n\nzipDSYM() {\n    : usage\n    : 'arg $1=fileName $2=newPathName'\n    : $1 $2\n\n    local fileName=$1\n    local newPathName=$2\n\n    pushd $buildPath\n    zip -r \"${newPathName}.app.dSYM.zip\" \"${fileName}.xcarchive\"\n    popd\n}\n\n\n\nexportOptions_Debug.plist\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<!DOCTYPE plist PUBLIC \"-//Apple//DTD PLIST 1.0//EN\" \"http://www.apple.com/DTDs/PropertyList-1.0.dtd\">\n<plist version=\"1.0\">\n<dict>\n    <key>method</key>\n    <string>development</string>\n</dict>\n</plist>\n\n\n\nexportOptions_Staging.plist\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<!DOCTYPE plist PUBLIC \"-//Apple//DTD PLIST 1.0//EN\" \"http://www.apple.com/DTDs/PropertyList-1.0.dtd\">\n<plist version=\"1.0\">\n<dict>\n    <key>method</key>\n    <string>ad-hoc</string>\n</dict>\n</plist>\n\n\n\nFabric\u3067\u8ee2\u9001\n\u4f5c\u6210\u3057\u305fIPA\u3092\u3042\u3089\u304b\u3058\u3081\u767b\u9332\u3057\u3066\u3044\u305f\u30b0\u30eb\u30fc\u30d7\u5145\u306b\u8ee2\u9001\u3057\u307e\u3059\u3002\n#!/bin/bash -l\nset -ux\n\nsend() {\n    : usage\n    : 'arg $1=newPathName $2=groupAlias'\n    : $1 $2\n    newPathName=$1\n    groupAlias=$2\n\n    $WORKSPACE/Pods/Crashlytics/submit <API_KEY> <BUILD_SECRET> -debug YES -groupAliases \"${groupAlias}\" -ipaPath \"${newPathName}.ipa\"\n}\n\n# \u6982\u8981\n\nJenkins Plugin\u3092\u4f7f\u3046\u3068Jenkins\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u3092\u4e0a\u3052\u305f\u6642\u306b\u52d5\u4f5c\u3057\u306a\u304f\u306a\u3063\u305f\u308a\u3001\u305d\u3082\u305d\u3082GUI\u8a2d\u5b9a\u304c\u9762\u5012\u3060\u3063\u305f\u308a\u3067\u3001\u5b9f\u306f\u30b7\u30a7\u30eb\u3067\u66f8\u3044\u305f\u65b9\u304c\u697d\u3058\u3083\u3093\u3002\u3068\u601d\u3063\u3066\u3044\u308b\u306e\u3067\u305d\u3046\u3057\u307e\u3059\u3002\n\uff08\u5168\u304f\u4f7f\u308f\u306a\u3044\u308f\u3051\u3067\u306f\u306a\u304f\u3001Jenkins2\u3067\u306e\u304a\u52e7\u3081Plugin\u3092\u305d\u306e\u307e\u307e\u5165\u308c\u3068\u304f\u3050\u3089\u3044\u306f\u3084\u308a\u307e\u3059\uff09\n\n\u6642\u304c\u7d4c\u3064\u306e\u306f\u65e9\u3044\u3082\u306e\u3067\u3001Hudson\u5144\u3055\u3093\u3067\u3057\u305f\u304c\u3001\u3044\u3064\u306e\u9593\u306b\u3084\u3089Jenkins\u304a\u3058\u3055\u3093\u3067\u3059\u3002\nJenkins\u3082\u30d0\u30fc\u30b8\u30e7\u30f32\u304c\u51fa\u3066\u3001Jenkinsfile\u306a\u3069\u304c\u3042\u308a\u3001\u4fbf\u5229\u306b\u306a\u308a\u3064\u3064\u3042\u308a\u307e\u3059\u3002\u304c\u3001\u305d\u308c\u3067\u3082\u30b7\u30a7\u30eb\u3067\u3084\u308a\u307e\u3059\u3002\n\u305d\u3082\u305d\u3082\u3001\u3044\u307e\u3069\u304d\u306ffastlane\u3067\u30d3\u30eb\u30c9\u3057\u305f\u308a\u3001Web\u30b5\u30fc\u30d3\u30b9\u4f7f\u3063\u305f\u308a\u3068\u601d\u3044\u307e\u3059\u3002\u304c\u3001Jenkins + \u30b7\u30a7\u30eb\u3067\u3084\u308a\u307e\u3059\u3002\n\n\u30b7\u30a7\u30eb\u3067\u66f8\u3044\u3066\u304a\u304f\u30e1\u30ea\u30c3\u30c8\u306f\u3001\u30b3\u30de\u30f3\u30c9\u30ec\u30d9\u30eb\u3067\u4f55\u3092\u3057\u3066\u3044\u308b\u306e\u304b\u304c\u7406\u89e3\u3067\u304d\u308b\u3053\u3068\u3067\u3057\u3087\u3046\u3002\n\n# \u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\nhomebrew\u3067\u5165\u308c\u3066\u307e\u3059\u3002\n\n```\n$ brew update\n$ brew cask install java\n$ brew install jenkins\n```\n\n\u8a2d\u5b9a\u306f\u30cd\u30c3\u30c8\u3067\u63a2\u305b\u3070\u3059\u3050\u51fa\u3066\u304f\u308b\u306e\u3067\u5272\u611b\u3002\n\n# \u60f3\u5b9a\u904b\u7528\n\njenkins\u306e\u30d1\u30e9\u30e1\u30fc\u30bf\u30fc\u4ed8\u304d\u30d3\u30eb\u30c9\u3092\u4f7f\u3044\u3001\u4ee5\u4e0b\u306e2\u70b9\u3092\u6307\u5b9a\u3057\u3066\u30d3\u30eb\u30c9\u3067\u304d\u308b\u3088\u3046\u306b\u3057\u307e\u3059\u3002\n\n* git\u306e\u30d6\u30e9\u30f3\u30c1\n* \u63a5\u7d9a\u5148\u30b5\u30fc\u30d0\u30fc\u540d(develop,staging,production\u306a\u3069)\n\n\u3053\u3093\u306a\u904b\u7528\u3092\u60f3\u5b9a\u3057\u3066\u3044\u307e\u3059\u3002\n\n1. github\u3067push\u3057\u305f\u3053\u3068\u3092\u691c\u77e5\u3059\u308bJob\u304c\u3053\u306eJob\u304c\u547c\u3073\u3060\u3057\u307e\u3059\u3002\uff08\u5225\u306e\u8a18\u4e8b\u3067\u66f8\u304d\u307e\u3059\uff09\n2. \u30b9\u30c6\u30fc\u30b8\u30f3\u30b0\u3068\u672c\u756a\u74b0\u5883\u63a5\u7d9a\u7528\u30a2\u30d7\u30ea\u3092\u5171\u5b58\u3067\u304d\u308b\u3088\u3046\u306b\u4e8c\u3064\u306e\u30d7\u30ed\u30d3\u30b8\u30cb\u30f3\u30b0\u30d5\u30a1\u30a4\u30eb(\u5225\u3005\u306eBundle Identifier)\u3092\u7528\u610f\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n3. \u30d3\u30eb\u30c9\u6642\u306bCFBundleShortVersionString\u306b\u3069\u306ebranch\u30fb\u63a5\u7d9a\u5148\u306e\u7d44\u5408\u305b\u306e\u30a2\u30d7\u30ea\u306a\u306e\u304b\u304c\u308f\u304b\u308b\u3088\u3046\u306bsuffix\u3092\u5165\u308c\u307e\u3059\u3002   \n(\u4f8b\u3048\u3070\u3001review\u30d6\u30e9\u30f3\u30c1+staging\u30b5\u30fc\u30d0=```.alpha```, release\u30d6\u30e9\u30f3\u30c1+staging\u30b5\u30fc\u30d0=```.beta```\u306a\u3069)\n4. \u30d3\u30eb\u30c9\u5f8c\u306f\u3001Fabric\u3092\u5229\u7528\u3057\u3066\u81ea\u52d5\u3067\u30c6\u30b9\u30c8\u7aef\u672b\u306b\u914d\u4fe1\u3057\u307e\u3059\u3002\n5. Fabric\u3067\u898b\u305f\u3068\u304d\u306b\u30d0\u30fc\u30b8\u30e7\u30f3\u3092\u898b\u308c\u3070\u30012\u3067\u8a2d\u5b9a\u3057\u305fsuffix\u304c\u3042\u308b\u306e\u3067\u3001\u63a5\u7d9a\u5148\u304c\u308f\u304b\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\n\n# Job\n\n## Jenkins\u306eGUI\u8a2d\u5b9a\n\n\u307e\u305a\u306f\u3001GUI\u4e0a\u3067\u8a18\u8ff0\u3057\u307e\u3059\n\n* \u30d3\u30eb\u30c9\u306e\u30d1\u30e9\u30e1\u30fc\u30bf\u5316\u306b\u30c1\u30a7\u30c3\u30af\u3092\u5165\u308c\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u3057\u307e\u3059\u3002\n\n ![\u30d2\u3099\u30eb\u30c8\u3099\u306e\u30cf\u309a\u30e9\u30e1\u30fc\u30bf\u30fc\u5316.png](https://qiita-image-store.s3.amazonaws.com/0/10494/777b2593-71bb-02e6-a581-adff4bcb9ac9.png \"\u30d2\u3099\u30eb\u30c8\u3099\u306e\u30cf\u309a\u30e9\u30e1\u30fc\u30bf\u30fc\u5316.png\")\n\n\n* \u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u7ba1\u7406\u306e\tBranch Specifier\u3067\u4e0a\u8a18\u306e\u30d1\u30e9\u30e1\u30fc\u30bf\u3067\u8a2d\u5b9a\u3057\u305f\u5909\u6570\u3092\u8a18\u8ff0\u3057\u307e\u3059\u3002\n\n ![git.png](https://qiita-image-store.s3.amazonaws.com/0/10494/b935d06c-0325-32ca-1aa7-bf012a291150.png \"git.png\")\n\n\n* \u30d3\u30eb\u30c9\u306e\u30b7\u30a7\u30eb\u306e\u5b9f\u884c\u3092\u8a18\u8ff0\u3057\u307e\u3059\u3002   \n~~~PROVISIONING_PROFILE\u306f\u7aef\u672b\u3092\u767b\u9332\u3059\u308b\u305f\u3073\u306b\u5909\u308f\u308b\u306e\u3067\u3001git\u3067\u7ba1\u7406\u3057\u305f\u5024\u3092\u4f7f\u3046\u3068tags\u304b\u3089\u904e\u53bb\u30d0\u30fc\u30b8\u30e7\u30f3\u304c\u30d3\u30eb\u30c9\u3067\u304d\u306a\u304f\u306a\u308b\u306e\u3067GUI\u304b\u3089\u6e21\u3059\u3088\u3046\u306b\u3057\u307e\u3059\u3002\n\u63a5\u7d9a\u3059\u308b\u74b0\u5883\u306b\u3088\u3063\u3066\u5229\u7528\u3059\u308bPROVISIONING_PROFILE\u304c\u9055\u3046\u306e\u3067\u5206\u5c90\u3057\u3066\u3044\u307e\u3059\u3002\n\u3042\u3068\u306f\u3001~~~\ngit\u3067\u7ba1\u7406\u3057\u3066\u3044\u308b\u30b7\u30a7\u30eb\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u547c\u3073\u51fa\u3059\u3060\u3051\u3067\u3059\u3002\n\n```\n#!/bin/bash -l\nexport WORKSPACE\nsh -x ${WORKSPACE}/jenkins/main.sh $branch $server\n```\n\n_**\u8ffd\u8a18**_\n_cocoapods\u3067\u3001```use_frameworks!```\u306e\u3088\u3046\u306b\u30d5\u30ec\u30fc\u30e0\u30ef\u30fc\u30af\u3068\u3057\u3066\u30e9\u30a4\u30d6\u30e9\u30ea\u3092\u53d6\u308a\u8fbc\u3080\u3068xcodebuild\u6642\u306bPROVISIONING_PROFILE\u306e\u6307\u5b9a\u3092\u3059\u308b\u3068\u3067\u304d\u307e\u305b\u3093\u3002\u305d\u3082\u305d\u3082```-exportOptionsPlist```\u3092\u4f7f\u3063\u3066\u3044\u308c\u3070PROVISIONING_PROFILE\u306e\u6307\u5b9a\u306f\u5fc5\u8981\u306a\u3044\u306e\u3067\u524a\u9664\u3057\u307e\u3057\u305f\u3002\u3069\u306ePROVISIONING_PROFILE\u3092\u5229\u7528\u3059\u308b\u304b\u306fXcode\u3067\u306eBuild Settings\u5185\u306eCode Signing Identitiy\u3067\u8a2d\u5b9a\u3057\u3066\u304a\u3051\u3070\u826f\u3044\u3067\u3059\u3002\n\n\n\n## Jenkins\u5916\u306e\u30b7\u30a7\u30eb\n\ngit\u3067\u7ba1\u7406\u3057\u307e\u3059\u3002\u305d\u308c\u305e\u308c\u52d5\u304f\u5358\u4f4d\u3067\u5225\u306e\u30b7\u30a7\u30eb\u306b\u3057\u307e\u3059\u3002 \n```$shellFilePath``` \u306f\u30b7\u30a7\u30eb\u30d5\u30a1\u30a4\u30eb\u306e\u30d1\u30b9\u3067\u3059\u3002\nmain.sh\u306f\u3001\u305d\u308c\u3089\u30b7\u30a7\u30eb\u3092\u547c\u3073\u51fa\u3059\u30b7\u30a7\u30eb\u306b\u306a\u308a\u307e\u3059\u3002\n\n```main.sh\n#!/bin/bash -l\nset -eux\n: usage\n: sh -x ~/jenkins/build.sh develop staging\n\n: $1 $2\nbranch=$1\nserver=$2\n\nshellFilePath=\"${WORKSPACE}/jenkins\"\n\n# \u30af\u30ea\u30fc\u30f3\u51e6\u7406\n. ${shellFilePath}/clean.sh\nclean\ninstall\n\n. ${shellFilePath}/setupVariable.sh\nsetupVar $branch $server\n# suffix,buildType,fileName,groupAlias\u304c\u8a2d\u5b9a\u3055\u308c\u308b\n. ${shellFilePath}/setupVariable.sh\n\n. ${shellFilePath}/replaceVersion.sh\nreplaceVersion $suffix\n# CFBundleShortVersionString,CFBundleVersion\u304c\u8a2d\u5b9a\u3055\u308c\u308b\n. ${shellFilePath}/replaceVersion.sh\n\nbuildPath=\"${WORKSPACE}/build/${buildType}-iphoneos\"\n\n. ${shellFilePath}/archive.sh\narchive $buildType \"$buildPath\"\n\n. ${shellFilePath}/exportIpa.sh\nexportIpa \"$buildPath\" \"$fileName\"\nrenameIpa \"$buildPath\" $fileName $CFBundleShortVersionString $CFBundleVersion\n# newFileName\u304c\u8a2d\u5b9a\u3055\u308c\u308b\n. ${shellFilePath}/exportIpa.sh\nnewPathName=\"${buildPath}/$newFileName\"\nzipDSYM $fileName \"$newPathName\"\n\n# crashlytics send\n. ${shellFilePath}/sendFabric.sh\nsend \"$newPathName\" $groupAlias\n```\n\n### \u30af\u30ea\u30fc\u30f3\u3068Cocoapods\u306e\u51e6\u7406\n\n\u4ee5\u4e0b\u3092\u884c\u3044\u307e\u3059\u3002\n\n* ```xcodebuild clean```\u3000\u3068 build\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u4ee5\u4e0b\u306e\u524a\u9664\n* ```pod install```\n\n```clean.sh\n#!/bin/bash -l\nset -eux\n\nfunction clean() {\n    xcodebuild clean -workspace ${WORKSPACE}/\uff1c\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u540d\uff1e.xcworkspace \\\n    -scheme \uff1c\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u540d\uff1e\n    rm -rf ${WORKSPACE}/build/*\n}\n\nfunction install() {\n    pushd \uff1c\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u540d\uff1e\n    pod install\n    popd\n}\n```\n\n### \u5909\u6570\u8a2d\u5b9a\u51e6\u7406\n\nJob\u5185\u306e\u51e6\u7406\u3067\u5229\u7528\u3059\u308b\u5909\u6570\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n```$groupAlias``` \u306fFabric Beta\u3067\u914d\u4fe1\u3059\u308b\u30b0\u30eb\u30fc\u30d7\u540d\u3067\u3059\u3002\n```$suffix``` \u306f\u8868\u793a\u3055\u308c\u308b\u30d0\u30fc\u30b8\u30e7\u30f3\u306esuffix\u3067\u3059\u3002\u4f8b\uff1a1.0.0.beta\u306ebeta\u90e8\u5206\n```$buildType``` \u306f\u3001archive\u6642\u306e ```-configuration``` \u306b\u6307\u5b9a\u3059\u308b\u5024\u3002\n\n\u3061\u306a\u307f\u306b\u30d6\u30e9\u30f3\u30c1\u904b\u7528\u306f\u901a\u5e38develop\u30d6\u30e9\u30f3\u30c1\u3067\u958b\u767a\u3092\u884c\u3044\u3001\u30b9\u30d7\u30ea\u30f3\u30c8\u30ec\u30d3\u30e5\u30fc\u306e\u5ea6\u306breview\u30d6\u30e9\u30f3\u30c1\u306bPush\u3057\u3066\u3001\u7dcf\u5408\u30c6\u30b9\u30c8\u304c\u59cb\u307e\u3063\u305f\u3089release\u30d6\u30e9\u30f3\u30c1\u306bPush\u3057\u3066\u3044\u307e\u3059\u3002\n\n```setupVariable.sh\n#!/bin/bash -l\nset -ux\n\nsetupVar() {\n    : usage\n    : '$1=branch name, $2=server name'\n    : $1 $2\n\n    local branch=$1\n    local server=$2\n\n    # \u5909\u6570\u8a2d\u5b9a\n    if [ $server = \"staging\" ]; then\n      buildType=\"Staging\"\n      fileName=\"\u30b9\u30c6\u30fc\u30b8\u30f3\u30b0\"\n      if [ $branch = \"review\" ]; then\n        suffix=\"alpha\"\n        groupAlias='appteam,serverteam'\n      elif [ $branch = \"release\" ]; then\n        suffix=\"beta\"\n        groupAlias='pmteam,appteam,serverteam,planningteam'\n      fi\n    elif [ $server = \"production\" ]; then\n      buildType=\"Release\"\n      fileName=\"\u672c\u756a\u74b0\u5883\"\n      if [ $branch = \"release\" ]; then\n        suffix=\"rc\"\n        groupAlias='pmteam,appteam,serverteam,planningteam'\n      elif [ $branch = \"master\" ]; then\n        suffix=\"gm\"\n        groupAlias='pmteam,appteam,serverteam,planningteam,manager'\n      fi\n    fi\n\n    # \u4e0a\u8a18\u3067\u8a2d\u5b9a\u3055\u308c\u306a\u304b\u3063\u305f\u5834\u5408(\u6700\u521d\u306e\u300csuffix=\u300d\u306f\u982d\u306b:\u304c\u3042\u308c\u3070\u306a\u304f\u3066\u3082\u826f\u3044\u304cdebug\u7528\u306b\u8a18\u8ff0)\n    suffix=${suffix:-\"develop\"}\n    buildType=${buildType:-\"Debug\"}\n    fileName=${fileName:-\"\u958b\u767a\u74b0\u5883\"}\n    groupAlias=${groupAlias:-\"appteam,serverteam\"}\n}\n```\n\n### \u8868\u793a\u30d0\u30fc\u30b8\u30e7\u30f3\u5909\u66f4\n\nFabric\u3067\u898b\u305f\u3068\u304d\u306b\u3069\u306e\u74b0\u5883\u306a\u306e\u304b\u304c\u308f\u304b\u308b\u3088\u3046\u306b\u30d0\u30fc\u30b8\u30e7\u30f3\u306bsuffix\u3092\u3064\u3051\u308b\u51e6\u7406\u3067\u3059\u3002\n\u30d3\u30eb\u30c9\u756a\u53f7\u3082Jenkins\u306e\u30d3\u30eb\u30c9\u756a\u53f7\u306b\u3057\u307e\u3059\u3002\n\n```replaceVersion.sh\n#!/bin/bash -l\nset -ux\n\nreplaceVersion(){\n    : usage\n    : 'arg $1=suffix'\n    : $1\n\n    local suffix=$1\n    CFBundleShortVersionString=`/usr/libexec/PlistBuddy -c \"Print CFBundleShortVersionString\" ${WORKSPACE}/\uff1c\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u540d\uff1e/Supporting\\ Files/\uff1c\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u540d\uff1e-Info.plist`\n    CFBundleVersion=`/usr/libexec/PlistBuddy -c \"Print CFBundleVersion\" ${WORKSPACE}/\uff1c\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u540d\uff1e/Supporting\\ Files/\uff1c\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u540d\uff1e-Info.plist`\n    /usr/libexec/PlistBuddy -c \"Set :CFBundleShortVersionString ${CFBundleShortVersionString}.${suffix}\" ${WORKSPACE}/\uff1c\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u540d\uff1e/Supporting\\ Files/\uff1c\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u540d\uff1e-Info.plist\n    /usr/libexec/PlistBuddy -c \"Set :CFBundleVersion ${BUILD_NUMBER}\" ${WORKSPACE}/\uff1c\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u540d\uff1e/Supporting\\ Files/\uff1c\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u540d\uff1e-Info.plist\n\n    CFBundleShortVersionString=`/usr/libexec/PlistBuddy -c \"Print CFBundleShortVersionString\" ${WORKSPACE}/\uff1c\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u540d\uff1e/\uff1c\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u540d\uff1e/Supporting\\ Files/\uff1c\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u540d\uff1e-Info.plist`\n    CFBundleVersion=`/usr/libexec/PlistBuddy -c \"Print CFBundleVersion\" ${WORKSPACE}/\uff1c\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u540d\uff1e/Supporting\\ Files/\uff1c\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u540d\uff1e-Info.plist`\n}\n\n```\n\n### \u30a2\u30fc\u30ab\u30a4\u30d6\u51e6\u7406\n\n2\u756a\u76ee\u306e\u5f15\u6570\u306e ```$buildPath`` \u306b\u306f\u30d3\u30eb\u30c9\u30d1\u30b9\u304c\u5165\u3063\u3066\u3044\u307e\u3059\u3002\uff08\u4f8b: ${WORKSPACE}/build/Debug-iphoneos\uff09\n\u305d\u3053\u3067\u6307\u5b9a\u3057\u305f\u5834\u6240\u306b xcarchive \u304c\u4f5c\u6210\u3055\u308c\u307e\u3059\u3002\n\n```\n#!/bin/bash -l\nset -ux\n\narchive() {\n    : usage\n    : 'arg $1=buildType $2=buildPath $3=fileName\n\n    : $1 $2 $3\n    local buildType=$1\n    local buildPath=$2\n    local fileName=$3\n\n    # arhive\u51e6\u7406\n    xcodebuild -workspace \"${WORKSPACE}/\uff1c\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u540d\uff1e/\uff1c\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u540d\uff1e.xcworkspace\" \\\n    -scheme \uff1c\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u540d\uff1e \\\n    -configuration \"${buildType}\" \\\n    archive -archivePath \"${buildPath}/${fileName}.xcarchive\"\n}\n```\n\n### IPA\u4f5c\u6210\u51e6\u7406\n\nxcarchive\u304b\u3089ipa\u3068\u305d\u306edSYM\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\n```exportIpa.sh\n#!/bin/bash -l\nset -ux\n\nexportIpa() {\n    : usage\n    : 'arg $1=buildPath $2=fileName $3=buildType\n    : $1 $2 $3\n\n    local buildPath=$1\n    local fileName=$2\n    local buildType=$3\n    xcodebuild \\\n        -exportArchive -archivePath \"${buildPath}/${fileName}.xcarchive\" \\\n        -exportPath \"${buildPath}\" \\\n        -exportOptionsPlist \"${WORKSPACE}/jenkins/exportOptions_${buildType}.plist\"\n}\n\nrenameIpa() {\n    : usage\n    : 'arg $1=buildPath $2=fileName $3=CFBundleShortVersionString $4=CFBundleVersion'\n    : $1 $2 $3 $4\n\n    local buildPath=$1\n    local fileName=$2\n    local CFBundleShortVersionString=$3\n    local CFBundleVersion=$4\n    local now=`date +\"%Y.%m.%d\"`\n\n    mv \"${buildPath}/<\u30d7\u30ed\u30c0\u30af\u30c8\u540d>.ipa\" \"${buildPath}/${fileName}-v${CFBundleShortVersionString}-${CFBundleVersion}-${now}.ipa\"\n    newFileName=${fileName}-v${CFBundleShortVersionString}-${CFBundleVersion}-${now}\n}\n\nzipDSYM() {\n    : usage\n    : 'arg $1=fileName $2=newPathName'\n    : $1 $2\n\n    local fileName=$1\n    local newPathName=$2\n\n    pushd $buildPath\n    zip -r \"${newPathName}.app.dSYM.zip\" \"${fileName}.xcarchive\"\n    popd\n}\n```\n\n```exportOptions_Debug.plist\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<!DOCTYPE plist PUBLIC \"-//Apple//DTD PLIST 1.0//EN\" \"http://www.apple.com/DTDs/PropertyList-1.0.dtd\">\n<plist version=\"1.0\">\n<dict>\n    <key>method</key>\n    <string>development</string>\n</dict>\n</plist>\n```\n\n```exportOptions_Staging.plist\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<!DOCTYPE plist PUBLIC \"-//Apple//DTD PLIST 1.0//EN\" \"http://www.apple.com/DTDs/PropertyList-1.0.dtd\">\n<plist version=\"1.0\">\n<dict>\n    <key>method</key>\n    <string>ad-hoc</string>\n</dict>\n</plist>\n```\n\n\n### Fabric\u3067\u8ee2\u9001\n\n\u4f5c\u6210\u3057\u305fIPA\u3092\u3042\u3089\u304b\u3058\u3081\u767b\u9332\u3057\u3066\u3044\u305f\u30b0\u30eb\u30fc\u30d7\u5145\u306b\u8ee2\u9001\u3057\u307e\u3059\u3002\n\n```\n#!/bin/bash -l\nset -ux\n\nsend() {\n    : usage\n    : 'arg $1=newPathName $2=groupAlias'\n    : $1 $2\n    newPathName=$1\n    groupAlias=$2\n\n    $WORKSPACE/Pods/Crashlytics/submit <API_KEY> <BUILD_SECRET> -debug YES -groupAliases \"${groupAlias}\" -ipaPath \"${newPathName}.ipa\"\n}\n```\n", "tags": ["CI", "shell", "Jenkins", "fabric", "iOS"]}