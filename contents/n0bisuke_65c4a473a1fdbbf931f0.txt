{"context": " More than 1 year has passed since last update.go-json-rest\u3092\u4f7f\u3063\u3066API\u30b5\u30fc\u30d0\u30fc\u3092\u7acb\u3066\u3066CORS\u5bfe\u5fdc\u3059\u308b\u8a71\u3092\u524d\u306b\u66f8\u3044\u305f\u306e\u3067\u3059\u304c\u3001Safari\u3060\u3051\u6319\u52d5\u3067\u30cf\u30de\u3063\u305f\u8a71\u3067\u3059\u3002\n\n\u53c2\u8003: Go\u8a00\u8a9e(Go-Json-Rest)\u3067API\u30b5\u30fc\u30d0\u30fc\u3092\u7acb\u3066\u308b\u3068\u304d\u306eCORS\u8a2d\u5b9a (Basic\u8a8d\u8a3c\u6a5f\u80fd\u4ed8\u304d\u3082)\n\n\n\u30cf\u30de\u308a\u5185\u5bb9\n\u524d\u306e\u30b3\u30fc\u30c9\u3068\u540c\u3058\u5185\u5bb9\u3067\u3059\u3002\nChrome\u3084Firefox\u306e\u5834\u5408\u306f\u3053\u308c\u3067\u554f\u984c\u7121\u304f\u52d5\u4f5c\u3057\u3066\u3044\u307e\u3057\u305f\u3002\n\nGo\u5074\n\n\napp.go\n\n/*\u7701\u7565*/\n  api.Use(&rest.CorsMiddleware{\n        RejectNonCorsRequests: false,\n        OriginValidator: func(origin string, request *rest.Request) bool {\n            return origin == \"http://localhost:3000\" || origin == \"http://192.168.43.158:3000\" || origin == \"http://localhost\"\n        },\n        AllowedMethods: []string{\"GET\", \"POST\", \"OPTIONS\"},\n        AllowedHeaders: []string{\"Accept\",\"Authorization\",\"content-type\"},\n        AccessControlAllowCredentials: true,\n        AccessControlMaxAge:           3600,\n    })\n\n/*\u7701\u7565*/\n\n\n\n\n\u30d5\u30ed\u30f3\u30c8\u5074\n\n\napi.js\n\n$(function(){\n  var host = 'localhost:8080';\n  var rand_param = '?ie=' + parseInt((new Date())/1000, 10);\n  var endpoint = '/countries';\n  var url = 'http://'+host+endpoint+rand_param;\n\n  function make_base_auth(user, password) {\n    var tok = user + ':' + password;\n    var hash = btoa(tok);\n    return \"Basic \" + hash;\n  }\n\n  $.ajax({\n      url: url,\n      beforeSend: function (xhr){\n        xhr.setRequestHeader('Authorization', make_base_auth('userud', 'password'));\n      },\n  }).done(function(data){\n      console.log(data);\n  }).fail(function(data){\n      console.log(data);\n  });\n\n});\n\n\n\n\u3053\u3053\u307e\u3067\u306f\u524d\u56de\u3068\u540c\u69d8\u306e\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u3067\u3059\u3002\n\nchrome\u3084firefox\u3060\u3068\u666e\u901a\u3067\u3059\u3002\n\n\nsafari\u3060\u3051\u3067\u30a8\u30e9\u30fc\u304c\u767a\u751f\u3002(\u3057\u304b\u3082POST\u306e\u307f)\n\n\u203b safari\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u306f8.0.7(OS\u306fYosemite)\u3067\u3059\u3002\n\n\niPhone\u3067\u78ba\u8a8d\u3057\u3066\u3001\u6700\u521d\u306fiPhone\u3060\u3051\u306e\u554f\u984c\u304b\u3068\u601d\u3044\u304d\u3084\u3001Safari\u7279\u6709\u306e\u554f\u984c\u307f\u305f\u3044\u3067\u3059\u3002\n\u203b GET\u30e1\u30bd\u30c3\u30c9\u306f\u554f\u984c\u7121\u304f\u52d5\u4f5c\u3057\u3066\u307e\u3057\u305f\u3002\n\n\u89e3\u6c7a: Access-Control-Allow-Headers\u306borigin\u3092\u8ffd\u52a0\u3057\u307e\u3057\u3087\u3046\u3002\n\u8272\u3005\u8a66\u884c\u932f\u8aa4\u3057\u305f\u7d50\u679c\u89e3\u6c7a\u3057\u307e\u3057\u305f\u3002\nAccess-Control-Allow-Headers\u306borigin\u3092\u8ffd\u52a0\u3059\u308b\u3053\u3068\u3067\u89e3\u6c7a\u3057\u307e\u3057\u305f\u3002\u9006\u306b\u8a00\u3048\u3070\u3001Safari\u4ee5\u5916\u306f\u3053\u306e\u6307\u5b9a\u304c\u7121\u304f\u3066\u3082\u52d5\u3044\u3066\u304f\u308c\u308b\u3093\u3067\u3059\u306d\u3002\ngo-json-rest\u306e\u5b9f\u88c5\u306e\u5834\u5408\u306fAllowedHeaders\u306borigin\u3092\u8ffd\u52a0\u3057\u307e\u3059\u3002\u3053\u308c\u3067safari\u3067\u3082\u5927\u4e08\u592b\u3067\u3059\u3002\n\napp.go\n\n/*\u7701\u7565*/\nAllowedHeaders: []string{\"origin\", \"Accept\",\"Authorization\",\"content-type\"},    \n/*\u7701\u7565*/\n\n\n\u3053\u308c\u3060\u3051\u3067\u534a\u65e5\u304f\u3089\u3044\u30cf\u30de\u3063\u305f...\nSafari\u3060\u3051\u3067\u767a\u751f\u3057\u305f\u554f\u984c\u3060\u3063\u305f\u306e\u3067\u30d6\u30e9\u30a6\u30b6\u3054\u3068\u306exhr\u5b9f\u88c5\u3068\u304b\u306e\u95a2\u4fc2\u304b\u3068\u601d\u3063\u3066\u30d5\u30ed\u30f3\u30c8\u5074\u8abf\u67fb\u3070\u304b\u308a\u3057\u3066\u307e\u3057\u305f\u3002\n\u3053\u3061\u3089\u306e\u8a18\u4e8b(Golang\u3067XMLHttpRequestLevel2+CORS\u306e\u30d7\u30ea\u30d5\u30e9\u30a4\u30c8\u304c\u901a\u308b\u30b5\u30fc\u30d0\u30fc\u3092\u7acb\u3066\u308b(BasicAuth\u4ed8\u304d))\u3092\u3082\u3068\u306b\u30b5\u30fc\u30d0\u30fc\u3092\u69cb\u7bc9\u3057\u306a\u304a\u3057\u3066\u307f\u305f\u3089\u540c\u3058JS\u30b3\u30fc\u30c9\u3067\u901a\u3063\u305f\u306e\u3067Go\u5074\u306e\u5b9f\u88c5\u306b\u554f\u984c\u304c\u3042\u308a\u305d\u3046\u3060\u3068\u3044\u3046\u7cf8\u53e3\u3067\u3059\u3002\n\n\u307e\u3068\u3081\nGET\u30e1\u30bd\u30c3\u30c9\u306f\u554f\u984c\u7121\u304f\u52d5\u4f5c\u3057\u3066\u3044\u305f\u306e\u3067\u3084\u3084\u3053\u3057\u304b\u3063\u305f\u3067\u3059\u3002\nAccess-Control-Allow-Headers\u306f\u3057\u3063\u304b\u308a\u8a2d\u5b9a\u3057\u307e\u3057\u3087\u3046\u3002\n\u52c9\u5f37\u306b\u306a\u308a\u307e\u3057\u305f\u3002\u2192 \u7570\u306a\u308b\u30c9\u30e1\u30a4\u30f3\u306eURL\u304b\u3089\u30c7\u30fc\u30bf\u3092\u53c2\u7167\u3059\u308b\u65b9\u6cd5 - Cross-Origin Resource Sharing\n\n[go-json-rest](https://github.com/ant0ine/go-json-rest)\u3092\u4f7f\u3063\u3066API\u30b5\u30fc\u30d0\u30fc\u3092\u7acb\u3066\u3066CORS\u5bfe\u5fdc\u3059\u308b\u8a71\u3092\u524d\u306b\u66f8\u3044\u305f\u306e\u3067\u3059\u304c\u3001Safari\u3060\u3051\u6319\u52d5\u3067\u30cf\u30de\u3063\u305f\u8a71\u3067\u3059\u3002\n\n> \u53c2\u8003: [Go\u8a00\u8a9e(Go-Json-Rest)\u3067API\u30b5\u30fc\u30d0\u30fc\u3092\u7acb\u3066\u308b\u3068\u304d\u306eCORS\u8a2d\u5b9a (Basic\u8a8d\u8a3c\u6a5f\u80fd\u4ed8\u304d\u3082)](http://qiita.com/n0bisuke/items/45ab414fc11959fc27c7)\n\n##\u30cf\u30de\u308a\u5185\u5bb9\n\n\u524d\u306e\u30b3\u30fc\u30c9\u3068\u540c\u3058\u5185\u5bb9\u3067\u3059\u3002\nChrome\u3084Firefox\u306e\u5834\u5408\u306f\u3053\u308c\u3067\u554f\u984c\u7121\u304f\u52d5\u4f5c\u3057\u3066\u3044\u307e\u3057\u305f\u3002\n\n* Go\u5074\n\n```app.go\n\n/*\u7701\u7565*/\n  api.Use(&rest.CorsMiddleware{\n        RejectNonCorsRequests: false,\n        OriginValidator: func(origin string, request *rest.Request) bool {\n            return origin == \"http://localhost:3000\" || origin == \"http://192.168.43.158:3000\" || origin == \"http://localhost\"\n        },\n        AllowedMethods: []string{\"GET\", \"POST\", \"OPTIONS\"},\n        AllowedHeaders: []string{\"Accept\",\"Authorization\",\"content-type\"},\n        AccessControlAllowCredentials: true,\n        AccessControlMaxAge:           3600,\n    })\n    \n/*\u7701\u7565*/\n\n```\n\n* \u30d5\u30ed\u30f3\u30c8\u5074\n\n```api.js\n\n$(function(){\n  var host = 'localhost:8080';\n  var rand_param = '?ie=' + parseInt((new Date())/1000, 10);\n  var endpoint = '/countries';\n  var url = 'http://'+host+endpoint+rand_param;\n\n  function make_base_auth(user, password) {\n    var tok = user + ':' + password;\n    var hash = btoa(tok);\n    return \"Basic \" + hash;\n  }\n\n  $.ajax({\n      url: url,\n      beforeSend: function (xhr){\n        xhr.setRequestHeader('Authorization', make_base_auth('userud', 'password'));\n      },\n  }).done(function(data){\n      console.log(data);\n  }).fail(function(data){\n      console.log(data);\n  });\n\n});\n\n```\n\n\u3053\u3053\u307e\u3067\u306f\u524d\u56de\u3068\u540c\u69d8\u306e\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u3067\u3059\u3002\n\n###chrome\u3084firefox\u3060\u3068\u666e\u901a\u3067\u3059\u3002\n\n![](http://i.gyazo.com/de17e883ed38fe4c2291e09dc6b7e72e.png)\n\n### safari\u3060\u3051\u3067\u30a8\u30e9\u30fc\u304c\u767a\u751f\u3002(\u3057\u304b\u3082POST\u306e\u307f)\n\n> \u203b safari\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u306f8.0.7(OS\u306fYosemite)\u3067\u3059\u3002\n\n![](http://i.gyazo.com/43a6608cd776748c471ebf25072c61fc.png)\n\niPhone\u3067\u78ba\u8a8d\u3057\u3066\u3001\u6700\u521d\u306fiPhone\u3060\u3051\u306e\u554f\u984c\u304b\u3068\u601d\u3044\u304d\u3084\u3001Safari\u7279\u6709\u306e\u554f\u984c\u307f\u305f\u3044\u3067\u3059\u3002\n\n\u203b GET\u30e1\u30bd\u30c3\u30c9\u306f\u554f\u984c\u7121\u304f\u52d5\u4f5c\u3057\u3066\u307e\u3057\u305f\u3002\n\n## \u89e3\u6c7a: Access-Control-Allow-Headers\u306borigin\u3092\u8ffd\u52a0\u3057\u307e\u3057\u3087\u3046\u3002\n\n\u8272\u3005\u8a66\u884c\u932f\u8aa4\u3057\u305f\u7d50\u679c\u89e3\u6c7a\u3057\u307e\u3057\u305f\u3002\n\n[Access-Control-Allow-Headers](https://developer.mozilla.org/ja/docs/HTTP_access_control#Access-Control-Allow-Headers)\u306borigin\u3092\u8ffd\u52a0\u3059\u308b\u3053\u3068\u3067\u89e3\u6c7a\u3057\u307e\u3057\u305f\u3002\u9006\u306b\u8a00\u3048\u3070\u3001Safari\u4ee5\u5916\u306f\u3053\u306e\u6307\u5b9a\u304c\u7121\u304f\u3066\u3082\u52d5\u3044\u3066\u304f\u308c\u308b\u3093\u3067\u3059\u306d\u3002\n\n[go-json-rest](https://github.com/ant0ine/go-json-rest)\u306e\u5b9f\u88c5\u306e\u5834\u5408\u306f`AllowedHeaders`\u306b`origin`\u3092\u8ffd\u52a0\u3057\u307e\u3059\u3002\u3053\u308c\u3067safari\u3067\u3082\u5927\u4e08\u592b\u3067\u3059\u3002\n\n```app.go\n\n/*\u7701\u7565*/\nAllowedHeaders: []string{\"origin\", \"Accept\",\"Authorization\",\"content-type\"},    \n/*\u7701\u7565*/\n```\n\n\u3053\u308c\u3060\u3051\u3067\u534a\u65e5\u304f\u3089\u3044\u30cf\u30de\u3063\u305f...\nSafari\u3060\u3051\u3067\u767a\u751f\u3057\u305f\u554f\u984c\u3060\u3063\u305f\u306e\u3067\u30d6\u30e9\u30a6\u30b6\u3054\u3068\u306exhr\u5b9f\u88c5\u3068\u304b\u306e\u95a2\u4fc2\u304b\u3068\u601d\u3063\u3066\u30d5\u30ed\u30f3\u30c8\u5074\u8abf\u67fb\u3070\u304b\u308a\u3057\u3066\u307e\u3057\u305f\u3002\n\n\u3053\u3061\u3089\u306e\u8a18\u4e8b([Golang\u3067XMLHttpRequestLevel2+CORS\u306e\u30d7\u30ea\u30d5\u30e9\u30a4\u30c8\u304c\u901a\u308b\u30b5\u30fc\u30d0\u30fc\u3092\u7acb\u3066\u308b(BasicAuth\u4ed8\u304d)](http://qiita.com/futosu/items/b49f7d9e28101daaa99e))\u3092\u3082\u3068\u306b\u30b5\u30fc\u30d0\u30fc\u3092\u69cb\u7bc9\u3057\u306a\u304a\u3057\u3066\u307f\u305f\u3089\u540c\u3058JS\u30b3\u30fc\u30c9\u3067\u901a\u3063\u305f\u306e\u3067Go\u5074\u306e\u5b9f\u88c5\u306b\u554f\u984c\u304c\u3042\u308a\u305d\u3046\u3060\u3068\u3044\u3046\u7cf8\u53e3\u3067\u3059\u3002\n\n## \u307e\u3068\u3081\n\nGET\u30e1\u30bd\u30c3\u30c9\u306f\u554f\u984c\u7121\u304f\u52d5\u4f5c\u3057\u3066\u3044\u305f\u306e\u3067\u3084\u3084\u3053\u3057\u304b\u3063\u305f\u3067\u3059\u3002\nAccess-Control-Allow-Headers\u306f\u3057\u3063\u304b\u308a\u8a2d\u5b9a\u3057\u307e\u3057\u3087\u3046\u3002\n\n\n\u52c9\u5f37\u306b\u306a\u308a\u307e\u3057\u305f\u3002\u2192 [\u7570\u306a\u308b\u30c9\u30e1\u30a4\u30f3\u306eURL\u304b\u3089\u30c7\u30fc\u30bf\u3092\u53c2\u7167\u3059\u308b\u65b9\u6cd5 - Cross-Origin Resource Sharing](http://koiroha.blogspot.jp/2014/09/cross-origin-resource-sharing.html)\n", "tags": ["Go", "api", "JavaScript", "golang", "CORS"]}