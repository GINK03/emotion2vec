{"context": " More than 1 year has passed since last update.Visual Studio 2013\u304b\u3089\u306fSQL Server Compact Edition\u306f\u30b5\u30dd\u30fc\u30c8\u3055\u308c\u306a\u304f\u306a\u308a\u307e\u3057\u305f\u3002\n\u516c\u5f0f\u306b\u306f\u3001\u300cSQL Server 2012/2014 Express\u306eLocalDB\u3092\u4f7f\u3048\u300d\u307e\u305f\u306f\u300cSQLite\u3092\u4f7f\u3048\u300d\u3063\u3066\u3053\u3068\u306e\u3088\u3046\u306a\u306e\u3067\u3059\u304c\u3001\u305d\u3046\u306f\u3044\u3063\u3066\u3082\u3044\u308d\u3044\u308d\u90fd\u5408\u304c\u3042\u3063\u3066SQLCE\u3092\u4f7f\u3044\u305f\u3044\u5834\u5408\u3082\u3042\u308a\u307e\u3059\u3088\u306d\u3002\n\u305d\u3046\u3044\u3046\u6642\u306f\u3069\u3046\u3059\u308c\u3070\u3044\u3044\u304b\u3068\u3044\u3046\u3068\u3001System.Data.SqlServerCe.dll \u30a2\u30bb\u30f3\u30d6\u30ea\u306b\u542b\u307e\u308c\u308b System.Data.SqlServerCe.SqlCeEngine\u30af\u30e9\u30b9\u306e\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u751f\u6210\u3057\u3066CreateDatabase()\u30e1\u30bd\u30c3\u30c9\u3092\u547c\u3079\u3070\u3001.sdf\u30d5\u30a1\u30a4\u30eb\u304c\u4f5c\u3089\u308c\u307e\u3059\u3002\nPowerShell\u3067\u66f8\u3044\u305f\u4f8b\u304c\u3001Jeremiah Clark's Blog \u306b\u3042\u308a\u307e\u3057\u305f\u306e\u3067\u307e\u308b\u3063\u3068\u53c2\u7167\u3057\u307e\u3059\u3002\n$binpath = \"C:\\Program Files\\Microsoft SQL Server Compact Edition\\v4.0\\Desktop\\\";\n\n$connectionString = \"Data Source='C:\\temp\\testDB.sdf';\"\n\n$engine = New-Object \"System.Data.SqlServerCe.SqlCeEngine\" $connectionString\n$engine.CreateDatabase()\n$engine.Dispose()\n\n$connection = New-Object \"System.Data.SqlServerCe.SqlCeConnection\" $connectionString\n$command = New-Object \"System.Data.SqlServerCe.SqlCeCommand\"\n$command.CommandType = [System.Data.CommandType]\"Text\"\n$command.Connection = $connection\n\n$connection.Open()\n\n$command.CommandText = \"CREATE TABLE [Files] ([Id] int NOT NULL  IDENTITY (1,1), [Name] nvarchar(450) NOT NULL);\"\n$command.ExecuteNonQuery()        \n\n$command.CommandText = \"ALTER TABLE [Files] ADD CONSTRAINT [PK_Files] PRIMARY KEY ([Id]);\"\n$command.ExecuteNonQuery()\n\n$command.CommandText = \"CREATE UNIQUE INDEX [IX_Files_Value] ON [Files] ([Name] ASC);\"\n$command.ExecuteNonQuery()\n\n$command.Dispose()\n$connection.Close();\n$connection.Dispose;\n\nVisual Studio 2013\u304b\u3089\u306fSQL Server Compact Edition\u306f\u30b5\u30dd\u30fc\u30c8\u3055\u308c\u306a\u304f\u306a\u308a\u307e\u3057\u305f\u3002\n\u516c\u5f0f\u306b\u306f\u3001\u300cSQL Server 2012/2014 Express\u306eLocalDB\u3092\u4f7f\u3048\u300d\u307e\u305f\u306f\u300cSQLite\u3092\u4f7f\u3048\u300d\u3063\u3066\u3053\u3068\u306e\u3088\u3046\u306a\u306e\u3067\u3059\u304c\u3001\u305d\u3046\u306f\u3044\u3063\u3066\u3082\u3044\u308d\u3044\u308d\u90fd\u5408\u304c\u3042\u3063\u3066SQLCE\u3092\u4f7f\u3044\u305f\u3044\u5834\u5408\u3082\u3042\u308a\u307e\u3059\u3088\u306d\u3002\n\u305d\u3046\u3044\u3046\u6642\u306f\u3069\u3046\u3059\u308c\u3070\u3044\u3044\u304b\u3068\u3044\u3046\u3068\u3001`System.Data.SqlServerCe.dll` \u30a2\u30bb\u30f3\u30d6\u30ea\u306b\u542b\u307e\u308c\u308b `System.Data.SqlServerCe.SqlCeEngine`\u30af\u30e9\u30b9\u306e\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u751f\u6210\u3057\u3066`CreateDatabase()`\u30e1\u30bd\u30c3\u30c9\u3092\u547c\u3079\u3070\u3001.sdf\u30d5\u30a1\u30a4\u30eb\u304c\u4f5c\u3089\u308c\u307e\u3059\u3002\n\nPowerShell\u3067\u66f8\u3044\u305f\u4f8b\u304c\u3001[Jeremiah Clark's Blog](http://blogs.msdn.com/b/miah/archive/2011/08/08/powershell-and-sql-server-compact-4-0-a-happy-mix.aspx) \u306b\u3042\u308a\u307e\u3057\u305f\u306e\u3067\u307e\u308b\u3063\u3068\u53c2\u7167\u3057\u307e\u3059\u3002\n\n```ps1\n$binpath = \"C:\\Program Files\\Microsoft SQL Server Compact Edition\\v4.0\\Desktop\\\";\n[Reflection.Assembly]::LoadFile(\"$binpath\\System.Data.SqlServerCe.dll\")\n$connectionString = \"Data Source='C:\\temp\\testDB.sdf';\"\n\n$engine = New-Object \"System.Data.SqlServerCe.SqlCeEngine\" $connectionString\n$engine.CreateDatabase()\n$engine.Dispose()\n\n$connection = New-Object \"System.Data.SqlServerCe.SqlCeConnection\" $connectionString\n$command = New-Object \"System.Data.SqlServerCe.SqlCeCommand\"\n$command.CommandType = [System.Data.CommandType]\"Text\"\n$command.Connection = $connection\n\n$connection.Open()\n\n$command.CommandText = \"CREATE TABLE [Files] ([Id] int NOT NULL  IDENTITY (1,1), [Name] nvarchar(450) NOT NULL);\"\n$command.ExecuteNonQuery()        \n\n$command.CommandText = \"ALTER TABLE [Files] ADD CONSTRAINT [PK_Files] PRIMARY KEY ([Id]);\"\n$command.ExecuteNonQuery()\n\n$command.CommandText = \"CREATE UNIQUE INDEX [IX_Files_Value] ON [Files] ([Name] ASC);\"\n$command.ExecuteNonQuery()\n\n$command.Dispose()\n$connection.Close();\n$connection.Dispose;\n```\n", "tags": ["PowerShell", "SQLServerCompactEdition"]}