{"context": " More than 1 year has passed since last update.\n\n\u76ee\u6b21\n1 \u306f\u3058\u3081\u306b\n2 \u30bf\u30c3\u30c1\u3055\u308c\u3066\u3044\u308b\u5834\u6240\u306b\u7d75\u3092\u52d5\u304b\u3059\n3 \u52d5\u304f\u7bc4\u56f2\u3092\u753b\u9762\u5185\u306b\u5236\u9650\u3059\u308b\n4 \u307e\u3068\u3081\n\n\u306f\u3058\u3081\u306b\n\u3053\u306e\u8a18\u4e8b\u306f\u3001\u753b\u9762\u4e0b\u306b\u81ea\u6a5f\u3092\u8868\u793a\u3057\u3001\u305d\u308c\u3092\u6a2a\u65b9\u5411\u306b\u306e\u307f\u52d5\u304b\u3057\u305f\u3044\u4eba\u5411\u3051\u306e\u3001\u899a\u66f8\u3067\u3059\u3002\n\n\u30bf\u30c3\u30c1\u3055\u308c\u3066\u3044\u308b\u5834\u6240\u306b\u7d75\u3092\u52d5\u304b\u3059\n\u4e0b\u8a18\u30b3\u30fc\u30c9\u306f\u3001\u7d75\u3092(\u753b\u9762\u6a2a\u5e45/2,\u9ad8\u3055100)\u306b\u8868\u793a\u3057\u305f\u3042\u3068\u3001\u30bf\u30c3\u30c1\u3055\u308c\u3066\u3044\u308b\u9593\u3001\u6a2a\u65b9\u5411\u306b\u306e\u307f\u52d5\u304b\u3059\u4f8b\u3067\u3059\u3002\n\nGameScene.lua\n\nlocal GameScene = class(\"GameScene\",function()\n    return cc.Scene:create()\nend)\n\nfunction GameScene.create()\n    local scene = GameScene.new()\n    scene:addChild(scene:createLayer())\n    return scene\nend\n\n\nfunction GameScene:ctor()\n    self.visibleSize = cc.Director:getInstance():getVisibleSize()\n    self.origin = cc.Director:getInstance():getVisibleOrigin()\n    self.schedulerID = nil\nend\n\nfunction GameScene:playBgMusic()\n--[[local bgMusicPath = cc.FileUtils:getInstance():fullPathForFilename(\"background.mp3\") \n    cc.SimpleAudioEngine:getInstance():playMusic(bgMusicPath, true)\n    local effectPath = cc.FileUtils:getInstance():fullPathForFilename(\"effect1.wav\")\n    cc.SimpleAudioEngine:getInstance():preloadEffect(effectPath)]]\nend\n\n-- create farm\nfunction GameScene:createLayer()\n    local layer = cc.Layer:create()\n\n    -- \u30b9\u30d7\u30e9\u30a4\u30c8\u3092\u8ffd\u52a0\n    local sprite = cc.Sprite:create(\"land.png\")\n    sprite:setPosition(self.visibleSize.width/2,100)\n    layer:addChild(sprite)\n\n    -- \u30bf\u30c3\u30c1\u958b\u59cb\u6642\u306b\u547c\u3070\u308c\u308b\u95a2\u6570\n    local function onTouchBegan(touch, event)\n\n        return true -- \u958b\u59cb\u30a4\u30d9\u30f3\u30c8\u306e\u95a2\u6570\u306ftrue\u3092\u8fd4\u3059\n    end\n\n    -- \u30bf\u30c3\u30c1\u3057\u306a\u304c\u3089\u6307\u3092\u52d5\u304b\u3057\u3066\u3044\u308b\u6642\u306b\u547c\u3070\u308c\u308b\u95a2\u6570\n    local function onTouchMoved(touch, event)\n        -- a)\u30bf\u30c3\u30c1\u70b9\u306e\u5ea7\u6a19\u3092\u53d6\u5f97\n        local location = touch:getLocation()\n\n        -- b)\u30bf\u30c3\u30c1\u70b9\u306ex\u5ea7\u6a19\u3078\u7d75\u3092\u79fb\u52d5\n        sprite:setPositionX(location.x)\n    end\n\n    -- \u30bf\u30c3\u30c1\u3092\u96e2\u3057\u305f\u6642\u306b\u547c\u3070\u308c\u308b\u95a2\u6570\n    local function onTouchEnded(touch, event)\n\n    end\n\n    -- \u30bf\u30c3\u30c1\u30a4\u30d9\u30f3\u30c8\u3067\u547c\u3070\u308c\u308b\u95a2\u6570\u3092\u767b\u9332\n    local listener = cc.EventListenerTouchOneByOne:create()\n    listener:registerScriptHandler(onTouchBegan, cc.Handler.EVENT_TOUCH_BEGAN )\n    listener:registerScriptHandler(onTouchMoved, cc.Handler.EVENT_TOUCH_MOVED )\n    listener:registerScriptHandler(onTouchEnded, cc.Handler.EVENT_TOUCH_ENDED )\n\n    -- \u3053\u306e\u30ec\u30a4\u30e4\u30fc\u3067\u306e\u30bf\u30c3\u30c1\u30a4\u30d9\u30f3\u30c8\u53d6\u5f97\u3092\u6709\u52b9\u5316\n    local eventDispatcher = layer:getEventDispatcher()\n    eventDispatcher:addEventListenerWithSceneGraphPriority(listener, layer)\n\n    return layer\nend\n\nreturn GameScene\n\n\na)\u3067\u30bf\u30c3\u30c1\u4e2d\u306e\u5ea7\u6a19\u3092\u53d6\u5f97\u3057\u3001b)\u3067\u7d75\u306e\u4f4d\u7f6e\u3092\u30bf\u30c3\u30c1\u4e2d\u306ex\u5ea7\u6a19\u306b\u5909\u66f4\u3057\u3066\u3044\u307e\u3059\u3002\u5b9f\u884c\u3059\u308b\u3068\u30bf\u30c3\u30c1\u4e2d\u7d75\u3092\u52d5\u304b\u3059\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u304c\u3001\u753b\u9762\u306e\u7aef\u304b\u3089\u7d75\u304c\u98db\u3073\u51fa\u3059\u3068\u3053\u308d\u307e\u3067\u52d5\u304b\u305b\u3066\u3057\u307e\u3044\u307e\u3059\u3002\n\n\n\u52d5\u304f\u7bc4\u56f2\u3092\u753b\u9762\u5185\u306b\u5236\u9650\u3059\u308b\n\u8868\u793a\u753b\u9762\u5185\u3067\u7d75\u3092\u52d5\u304b\u3059\u306b\u306fb)\u3092\u4e0b\u8a18\u306e\u3088\u3046\u306b\u5909\u66f4\u3057\u307e\u3059\u3002\n\nGameScene.lua\n...\n        -- b)\u30bf\u30c3\u30c1\u70b9\u306ex\u5ea7\u6a19\u3078\u7d75\u3092\u79fb\u52d5\n        local dx = location.x\n        local offsetX = sprite:getContentSize().width/2\n        -- \u30bf\u30c3\u30c1\u4f4d\u7f6eX\u304c\u7d75\u306e\u6a2a\u5e45\u534a\u5206\u3088\u308a\u3082\u5de6\u306e\u5834\u5408\u306f\u3001\u8868\u793a\u4f4d\u7f6edx\u3092\u7d75\u306e\u6a2a\u5e45\u534a\u5206\u306e\u4f4d\u7f6e\u306b\u3059\u308b\n        if location.x < offsetX then\n            dx = offsetX\n        -- \u30bf\u30c3\u30c1\u4f4d\u7f6eX\u304c(\u753b\u9762\u6a2a\u5e45-\u7d75\u306e\u6a2a\u5e45\u534a\u5206)\u3088\u308a\u3082\u53f3\u306e\u5834\u5408\u306f\u3001\u8868\u793a\u4f4d\u7f6edx\u3092(\u753b\u9762\u6a2a\u5e45-\u7d75\u306e\u6a2a\u5e45\u534a\u5206)\u306e\u4f4d\u7f6e\u306b\u3059\u308b\n        elseif self.visibleSize.width-offsetX < location.x then\n            dx = self.visibleSize.width-offsetX\n        end\n        -- \u7d75\u306e\u8868\u793a\u4f4d\u7f6e\u3092\u66f4\u65b0\n        sprite:setPositionX(dx)\n...\n\n\n\u4e0a\u8a18\u30b3\u30fc\u30c9\u3067\u3001\u307e\u305a\u73fe\u5728\u30bf\u30c3\u30c1\u3055\u308c\u3066\u3044\u308bX\u5ea7\u6a19\u3092\u4e00\u65e6dx\u306b\u4fdd\u5b58\u3001\u7d75\u306e\u6a2a\u5e45/2\u3092offsetX\u3068\u3057\u3066\u5909\u6570\u306b\u683c\u7d0d\u3057\u3001\u305d\u306e\u4e0b\u3067\u3001dx\u3092offsetX\u301c(\u753b\u9762\u5e45-offsetX)\u306e\u7bc4\u56f2\u306b\u53ce\u3081\u307e\u3059\u3002\u5b9f\u884c\u3059\u308b\u3068\u3001\u7d75\u306f\u753b\u9762\u304b\u3089\u306f\u307f\u51fa\u3055\u306a\u3044\u7bc4\u56f2\u3067\u6a2a\u306b\u52d5\u304b\u305b\u307e\u3059\u3002\n\n\u307e\u3068\u3081\n\u4eca\u56de\u306e\u4f8b\u306f\u3001\u4f8b\u3048\u3070\u3001\u30a4\u30f3\u30d9\u30fc\u30c0\u30fc\u30b2\u30fc\u30e0\u306e\u3088\u3046\u306a\u3001\u753b\u9762\u4e0b\u306b\u8868\u793a\u3057\u305f\u81ea\u6a5f\u3092\u52d5\u304b\u3059\u306e\u306b\u4f7f\u3048\u307e\u3059\u3002\n#\u76ee\u6b21\n1 \u306f\u3058\u3081\u306b\n2 \u30bf\u30c3\u30c1\u3055\u308c\u3066\u3044\u308b\u5834\u6240\u306b\u7d75\u3092\u52d5\u304b\u3059\n3 \u52d5\u304f\u7bc4\u56f2\u3092\u753b\u9762\u5185\u306b\u5236\u9650\u3059\u308b\n4 \u307e\u3068\u3081\n\n#\u306f\u3058\u3081\u306b\n\u3053\u306e\u8a18\u4e8b\u306f\u3001\u753b\u9762\u4e0b\u306b\u81ea\u6a5f\u3092\u8868\u793a\u3057\u3001\u305d\u308c\u3092\u6a2a\u65b9\u5411\u306b\u306e\u307f\u52d5\u304b\u3057\u305f\u3044\u4eba\u5411\u3051\u306e\u3001\u899a\u66f8\u3067\u3059\u3002\n\n\n#\u30bf\u30c3\u30c1\u3055\u308c\u3066\u3044\u308b\u5834\u6240\u306b\u7d75\u3092\u52d5\u304b\u3059\n\u4e0b\u8a18\u30b3\u30fc\u30c9\u306f\u3001\u7d75\u3092(\u753b\u9762\u6a2a\u5e45/2,\u9ad8\u3055100)\u306b\u8868\u793a\u3057\u305f\u3042\u3068\u3001\u30bf\u30c3\u30c1\u3055\u308c\u3066\u3044\u308b\u9593\u3001\u6a2a\u65b9\u5411\u306b\u306e\u307f\u52d5\u304b\u3059\u4f8b\u3067\u3059\u3002\n\n```GameScene.lua\n\nlocal GameScene = class(\"GameScene\",function()\n    return cc.Scene:create()\nend)\n\nfunction GameScene.create()\n    local scene = GameScene.new()\n    scene:addChild(scene:createLayer())\n    return scene\nend\n\n\nfunction GameScene:ctor()\n    self.visibleSize = cc.Director:getInstance():getVisibleSize()\n    self.origin = cc.Director:getInstance():getVisibleOrigin()\n    self.schedulerID = nil\nend\n\nfunction GameScene:playBgMusic()\n--[[local bgMusicPath = cc.FileUtils:getInstance():fullPathForFilename(\"background.mp3\") \n    cc.SimpleAudioEngine:getInstance():playMusic(bgMusicPath, true)\n    local effectPath = cc.FileUtils:getInstance():fullPathForFilename(\"effect1.wav\")\n    cc.SimpleAudioEngine:getInstance():preloadEffect(effectPath)]]\nend\n\n-- create farm\nfunction GameScene:createLayer()\n    local layer = cc.Layer:create()\n\n    -- \u30b9\u30d7\u30e9\u30a4\u30c8\u3092\u8ffd\u52a0\n    local sprite = cc.Sprite:create(\"land.png\")\n    sprite:setPosition(self.visibleSize.width/2,100)\n    layer:addChild(sprite)\n\n    -- \u30bf\u30c3\u30c1\u958b\u59cb\u6642\u306b\u547c\u3070\u308c\u308b\u95a2\u6570\n    local function onTouchBegan(touch, event)\n\n        return true -- \u958b\u59cb\u30a4\u30d9\u30f3\u30c8\u306e\u95a2\u6570\u306ftrue\u3092\u8fd4\u3059\n    end\n    \n    -- \u30bf\u30c3\u30c1\u3057\u306a\u304c\u3089\u6307\u3092\u52d5\u304b\u3057\u3066\u3044\u308b\u6642\u306b\u547c\u3070\u308c\u308b\u95a2\u6570\n    local function onTouchMoved(touch, event)\n        -- a)\u30bf\u30c3\u30c1\u70b9\u306e\u5ea7\u6a19\u3092\u53d6\u5f97\n        local location = touch:getLocation()\n        \n        -- b)\u30bf\u30c3\u30c1\u70b9\u306ex\u5ea7\u6a19\u3078\u7d75\u3092\u79fb\u52d5\n        sprite:setPositionX(location.x)\n    end\n    \n    -- \u30bf\u30c3\u30c1\u3092\u96e2\u3057\u305f\u6642\u306b\u547c\u3070\u308c\u308b\u95a2\u6570\n    local function onTouchEnded(touch, event)\n\n    end\n\n    -- \u30bf\u30c3\u30c1\u30a4\u30d9\u30f3\u30c8\u3067\u547c\u3070\u308c\u308b\u95a2\u6570\u3092\u767b\u9332\n    local listener = cc.EventListenerTouchOneByOne:create()\n    listener:registerScriptHandler(onTouchBegan, cc.Handler.EVENT_TOUCH_BEGAN )\n    listener:registerScriptHandler(onTouchMoved, cc.Handler.EVENT_TOUCH_MOVED )\n    listener:registerScriptHandler(onTouchEnded, cc.Handler.EVENT_TOUCH_ENDED )\n\n    -- \u3053\u306e\u30ec\u30a4\u30e4\u30fc\u3067\u306e\u30bf\u30c3\u30c1\u30a4\u30d9\u30f3\u30c8\u53d6\u5f97\u3092\u6709\u52b9\u5316\n    local eventDispatcher = layer:getEventDispatcher()\n    eventDispatcher:addEventListenerWithSceneGraphPriority(listener, layer)\n    \n    return layer\nend\n\nreturn GameScene\n```\n\na)\u3067\u30bf\u30c3\u30c1\u4e2d\u306e\u5ea7\u6a19\u3092\u53d6\u5f97\u3057\u3001b)\u3067\u7d75\u306e\u4f4d\u7f6e\u3092\u30bf\u30c3\u30c1\u4e2d\u306ex\u5ea7\u6a19\u306b\u5909\u66f4\u3057\u3066\u3044\u307e\u3059\u3002\u5b9f\u884c\u3059\u308b\u3068\u30bf\u30c3\u30c1\u4e2d\u7d75\u3092\u52d5\u304b\u3059\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u304c\u3001\u753b\u9762\u306e\u7aef\u304b\u3089\u7d75\u304c\u98db\u3073\u51fa\u3059\u3068\u3053\u308d\u307e\u3067\u52d5\u304b\u305b\u3066\u3057\u307e\u3044\u307e\u3059\u3002\n\n![Hero Controller.png](https://qiita-image-store.s3.amazonaws.com/0/90495/697fb878-584d-6950-3001-cbc1c2a862f2.png)\n\n\n#\u52d5\u304f\u7bc4\u56f2\u3092\u753b\u9762\u5185\u306b\u5236\u9650\u3059\u308b\n\u8868\u793a\u753b\u9762\u5185\u3067\u7d75\u3092\u52d5\u304b\u3059\u306b\u306fb)\u3092\u4e0b\u8a18\u306e\u3088\u3046\u306b\u5909\u66f4\u3057\u307e\u3059\u3002\n\n```GameScene.lua\n...\n        -- b)\u30bf\u30c3\u30c1\u70b9\u306ex\u5ea7\u6a19\u3078\u7d75\u3092\u79fb\u52d5\n        local dx = location.x\n        local offsetX = sprite:getContentSize().width/2\n        -- \u30bf\u30c3\u30c1\u4f4d\u7f6eX\u304c\u7d75\u306e\u6a2a\u5e45\u534a\u5206\u3088\u308a\u3082\u5de6\u306e\u5834\u5408\u306f\u3001\u8868\u793a\u4f4d\u7f6edx\u3092\u7d75\u306e\u6a2a\u5e45\u534a\u5206\u306e\u4f4d\u7f6e\u306b\u3059\u308b\n        if location.x < offsetX then\n            dx = offsetX\n        -- \u30bf\u30c3\u30c1\u4f4d\u7f6eX\u304c(\u753b\u9762\u6a2a\u5e45-\u7d75\u306e\u6a2a\u5e45\u534a\u5206)\u3088\u308a\u3082\u53f3\u306e\u5834\u5408\u306f\u3001\u8868\u793a\u4f4d\u7f6edx\u3092(\u753b\u9762\u6a2a\u5e45-\u7d75\u306e\u6a2a\u5e45\u534a\u5206)\u306e\u4f4d\u7f6e\u306b\u3059\u308b\n        elseif self.visibleSize.width-offsetX < location.x then\n            dx = self.visibleSize.width-offsetX\n        end\n        -- \u7d75\u306e\u8868\u793a\u4f4d\u7f6e\u3092\u66f4\u65b0\n        sprite:setPositionX(dx)\n...\n```\n\n\u4e0a\u8a18\u30b3\u30fc\u30c9\u3067\u3001\u307e\u305a\u73fe\u5728\u30bf\u30c3\u30c1\u3055\u308c\u3066\u3044\u308bX\u5ea7\u6a19\u3092\u4e00\u65e6dx\u306b\u4fdd\u5b58\u3001\u7d75\u306e\u6a2a\u5e45/2\u3092offsetX\u3068\u3057\u3066\u5909\u6570\u306b\u683c\u7d0d\u3057\u3001\u305d\u306e\u4e0b\u3067\u3001dx\u3092offsetX\u301c(\u753b\u9762\u5e45-offsetX)\u306e\u7bc4\u56f2\u306b\u53ce\u3081\u307e\u3059\u3002\u5b9f\u884c\u3059\u308b\u3068\u3001\u7d75\u306f\u753b\u9762\u304b\u3089\u306f\u307f\u51fa\u3055\u306a\u3044\u7bc4\u56f2\u3067\u6a2a\u306b\u52d5\u304b\u305b\u307e\u3059\u3002\n\n#\u307e\u3068\u3081\n\u4eca\u56de\u306e\u4f8b\u306f\u3001\u4f8b\u3048\u3070\u3001\u30a4\u30f3\u30d9\u30fc\u30c0\u30fc\u30b2\u30fc\u30e0\u306e\u3088\u3046\u306a\u3001\u753b\u9762\u4e0b\u306b\u8868\u793a\u3057\u305f\u81ea\u6a5f\u3092\u52d5\u304b\u3059\u306e\u306b\u4f7f\u3048\u307e\u3059\u3002\n", "tags": ["Android", "Lua", "iOS", "cocos2d-x"]}