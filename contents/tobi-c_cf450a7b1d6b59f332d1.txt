{"context": "Go\u8a00\u8a9e\u3067SA-IS\uff08Suffix Array - Induced Sorting)\u3092\u5b9f\u88c5\u3057\u307e\u3057\u305f\u3002SA-IS\u306f\u63a5\u5c3e\u8f9e\u914d\u5217\uff08Suffix Array\uff09\u306e\u69cb\u7bc9\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u3067\u3059\u3002\u672c\u8a18\u4e8b\u306e\u5185\u5bb9\u306f\u6b21\u306e3\u672c\u306b\u306a\u308a\u307e\u3059\u3002\n\n\nGo\u8a00\u8a9e\u3067\u5b9f\u88c5\u3057\u305fSA-IS(go-sais)\u306b\u3064\u3044\u3066\u7d39\u4ecb\u3057\u307e\u3059\nSA-IS\u306e\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u306b\u3064\u3044\u3066\u89e3\u8aac\u3057\u307e\u3059\n\nGo\u8a00\u8a9e\u306e\u5165\u9580\u66f8\u3092\u57f7\u7b46\u3057\u307e\u3057\u305f\n\n\n\nGo\u8a00\u8a9e\u306eSA-IS\u5b9f\u88c5\nGo\u8a00\u8a9e\u306e\u6a19\u6e96\u30d1\u30c3\u30b1\u30fc\u30b8\u306b\u306f\u3001\u65e2\u306b\u63a5\u5c3e\u8f9e\u914d\u5217\u306e\u5b9f\u88c5(index/suffixarray)\u304c\u5b58\u5728\u3057\u307e\u3059\u3002\u6a19\u6e96\u30d1\u30c3\u30b1\u30fc\u30b8\u306e\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u3092\u898b\u305f\u3068\u3053\u308dLarsson-Sadakane\u6cd5(qsufsort)\u3067\u3042\u3063\u305f\u305f\u3081\u3001\u3088\u308a\u9ad8\u901f\u3068\u8a00\u308f\u308c\u3066\u3044\u308bSA-IS\u3092\u5b9f\u88c5\u3057\u307e\u3057\u305f\u3002\nhttps://github.com/tobi-c/go-sais\n\n\u5b9f\u88c5\u5185\u5bb9\nSA-IS\u306f\u63a5\u5c3e\u8f9e\u914d\u5217\u306e\u69cb\u7bc9\u90e8\u5206\u306e\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u3067\u3059\u3002\u305d\u306e\u305f\u3081\u3001\u69cb\u7bc9\u90e8\u5206\u306e\u5b9f\u88c5\u306e\u307f\u6a19\u6e96\u30d1\u30c3\u30b1\u30fc\u30b8\u304b\u3089\u7f6e\u304d\u63db\u3048\u3066\u3044\u307e\u3059\u3002\u63a5\u5c3e\u8f9e\u914d\u5217\u3092\u4f7f\u7528\u3057\u305f\u691c\u7d22\u90e8\u5206\u3084\u30c6\u30b9\u30c8\u306a\u3069\u306f\u6a19\u6e96\u30d1\u30c3\u30b1\u30fc\u30b8\u306e\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u304b\u3089\u30b3\u30d4\u30fc\u3057\u307e\u3057\u305f\u3002\n\n\u30d9\u30f3\u30c1\u30de\u30fc\u30af\n\u4e0b\u8a18\u30b3\u30de\u30f3\u30c9\u3067go-sais\u3068\u6a19\u6e96\u30d1\u30c3\u30b1\u30fc\u30b8\u306e\u30d9\u30f3\u30c1\u30de\u30fc\u30af\u3092\u53d6\u5f97\u3057\u307e\u3057\u305f\u3002\n$ go test -bench . github.com/tobi-c/go-sais/suffixarray\n\n$ go test -bench . index/suffixarray\n\n\u53d6\u5f97\u7d50\u679c\u306f\u4e0b\u8a18\u306e\u8868\u306e\u3068\u304a\u308a\u3067\u3059\u3002\n\n\n\n\nNewIndexRandom\nNewIndexRepeat\nSaveRestore\n\n\n\n\ngo-sais/suffixarray\n778500400 ns/op\n162400650 ns/op\n45003666 ns/op\n\n\nindex/suffixarray(\u6a19\u6e96\u30d1\u30c3\u30b1\u30fc\u30b8)\n1448997500 ns/op\n2484993800 ns/op\n45519330 ns/op\n\n\n\nNewIndexRandam\u306f\u30e9\u30f3\u30c0\u30e0\u306e\u6587\u5b57\u5217\u306b\u5bfe\u3057\u3066\u63a5\u5c3e\u8f9e\u914d\u5217\u3092\u69cb\u7bc9\u3057\u3066\u3044\u307e\u3059\u3002\ngo-sais\u306f\u3001\u6a19\u6e96\u30d1\u30c3\u30b1\u30fc\u30b8\u3068\u6bd4\u3079\u3066\u7d04\u534a\u5206(53%)\u306e\u6642\u9593\u3067\u5b9f\u884c\u3067\u304d\u307e\u3057\u305f\u3002\nNewIndexRepeat\u306f\u7e70\u308a\u8fd4\u3057\u304c\u7d9a\u304f\u6587\u5b57\u5217\u306b\u5bfe\u3057\u3066\u63a5\u5c3e\u8f9e\u914d\u5217\u3092\u69cb\u7bc9\u3057\u3066\u3044\u307e\u3059\u3002\ngo-sais\u306f\u3001\u6a19\u6e96\u30d1\u30c3\u30b1\u30fc\u30b8\u3068\u6bd4\u3079\u3066\u7d041/17(5.8%)\u306e\u6642\u9593\u3067\u5b9f\u884c\u3067\u304d\u307e\u3057\u305f\u3002\nSaveRestore\u306f\u3001\u63a5\u5c3e\u8f9e\u914d\u5217\u306e\u66f8\u8fbc\u307f\u3068\u8aad\u8fbc\u307f\u306e\u51e6\u7406\u3067\u3059\u3002\n\u305d\u306e\u90e8\u5206\u306e\u5b9f\u88c5\u306b\u5dee\u304c\u306a\u3044\u305f\u3081\u3001\u307b\u307c\u540c\u7b49\u306a\u5b9f\u884c\u6642\u9593\u3067\u3059\u3002\n\u30d9\u30f3\u30c1\u30de\u30fc\u30af\u3067\u4f7f\u7528\u3059\u308b\u6587\u5b57\u5217\u304c\u30e9\u30f3\u30c0\u30e0\u306e\u305f\u3081\u3001\u5927\u96d1\u628a\u306a\u6307\u6a19\u3067\u3059\u304c\u305d\u308c\u306a\u308a\u306b\u9ad8\u901f\u5316\u3055\u308c\u307e\u3057\u305f\u3002\u7279\u306b\u7e70\u308a\u8fd4\u3057\u304c\u7d9a\u304f\u6587\u5b57\u5217\u3067\u306f\u3001\u6a19\u6e96\u30d1\u30c3\u30b1\u30fc\u30b8\u306e\u5b9f\u88c5\u306b\u6bd4\u3079\u3066\u5927\u5e45\u306b\u6642\u9593\u304c\u77ed\u7e2e\u3067\u304d\u307e\u3057\u305f\u3002\uff08\u7e70\u308a\u8fd4\u3057\u304c\u7d9a\u304f\u6587\u5b57\u5217\u306fSA-IS\u306b\u3068\u3063\u3066\u90fd\u5408\u306e\u3088\u3044\u30c7\u30fc\u30bf\u306e\u3088\u3046\u3067\u3059\uff09\n\n\nSA-IS\u306e\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\n\u3053\u3053\u304b\u3089\u306fSA-IS\u306e\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u306e\u89e3\u8aac\u3067\u3059\u3002\u307e\u305a\u306f\u63a5\u5c3e\u8f9e\u914d\u5217\u306a\u3069\u306e\u5404\u7a2e\u5b9a\u7fa9\u306b\u3064\u3044\u3066\u8a18\u8f09\u3057\u3001\u305d\u306e\u5f8c\u306b\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u306e\u624b\u9806\u306b\u3064\u3044\u3066\u8aac\u660e\u3057\u307e\u3059\u3002\n\u3082\u3057\u53b3\u5bc6\u306a\u8a71\u3092\u77e5\u308a\u305f\u3044\u5834\u5408\u306f\u4e0b\u8a18\u8ad6\u6587\u3092\u3054\u53c2\u7167\u304f\u3060\u3055\u3044\u3002C\u8a00\u8a9e\u306e\u5b9f\u88c5\u3082\u8f09\u3063\u3066\u3044\u307e\u3059\u3002\n(pdf)Two Efficient Algorithms for Linear Suffix Array Construction. Ge Nong, Sen Zhang and Wai Hong Chan\n\n\u63a5\u5c3e\u8f9e\u914d\u5217\u306a\u3069\u306e\u5b9a\u7fa9\n\u63a5\u5c3e\u8f9e\u3001\u63a5\u5c3e\u8f9e\u914d\u5217\u306e\u5b9a\u7fa9\u3084SA-IS\u3067\u4f7f\u7528\u3059\u308bType\u5206\u3051\u3001LSM\u90e8\u5206\u6587\u5b57\u5217\u3001LMS-Prefix\u306b\u3064\u3044\u3066\u8aac\u660e\u3057\u307e\u3059\n\n\u63a5\u5c3e\u8f9e\n\u63a5\u5c3e\u8f9e\uff08Suffix\uff09\u3068\u306f\u3001\u5bfe\u8c61\u6587\u5b57\u5217\u306e\u5404\u4f4d\u7f6e\u3092\u958b\u59cb\u4f4d\u7f6e\u3068\u3057\u3066\u3001\u305d\u306e\u958b\u59cb\u4f4d\u7f6e\u304b\u3089\u672b\u5c3e\u307e\u3067\u306e\u90e8\u5206\u6587\u5b57\u5217\u306e\u3053\u3068\u3067\u3059\u3002\u3053\u3053\u3067\u306fsuf(\u6587\u5b57\u5217, \u958b\u59cb\u4f4d\u7f6e)\u3068\u8a18\u8ff0\u3057\u307e\u3059\u3002\n\u305f\u3068\u3048\u3070\u6587\u5b57\u5217\"base\"\u306e\u63a5\u5c3e\u8f9e\u306f\u6b21\u306e4\u3064\u3067\u3059\u3002\nsuf(\"base\", 0) = \"base\"\nsuf(\"base\", 1) =  \"ase\"\nsuf(\"base\", 2) =   \"se\"\nsuf(\"base\", 3) =    \"e\"\n\n\u3053\u306e\u3088\u3046\u306b\u63a5\u5c3e\u8f9e\u306e\u6570\u306f\u3001\u5bfe\u8c61\u3068\u306a\u308b\u6587\u5b57\u5217\u306e\u6587\u5b57\u6570\u3060\u3051\u5b58\u5728\u3057\u307e\u3059\uff08\u4e0a\u8a18\u306e\u4f8b\u3060\u3068\u6587\u5b57\u5217\u306e\u9577\u3055\u304c4\u306e\u305f\u3081\u3001\u63a5\u5c3e\u8f9e\u30824\u3064\uff09\u3002\n\n\n\u63a5\u5c3e\u8f9e\u914d\u5217\n\u63a5\u5c3e\u8f9e\u914d\u5217\uff08Suffix Array\uff09\u3068\u306f\u3001\u5bfe\u8c61\u6587\u5b57\u5217\u306e\u63a5\u5c3e\u8f9e\u3092\u6587\u5b57\u5217\u9806\u3067\u30bd\u30fc\u30c8\u3057\u3001\u305d\u306e\u958b\u59cb\u4f4d\u7f6e\u3092\u683c\u7d0d\u3057\u305f\u914d\u5217\u3067\u3059\u3002\u5148\u307b\u3069\u306e\u6587\u5b57\u5217\"base\"\u306e\u63a5\u5c3e\u8f9e\u914d\u5217\u306f\u6b21\u306e\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\n\n\n\n\u63a5\u5c3e\u8f9e\n\u63a5\u5c3e\u8f9e\u914d\u5217\n\n\n\n\nsuf(\"base\", 1) = \"ase\"\n1\n\n\nsuf(\"base\", 0) = \"base\"\n0\n\n\nsuf(\"base\", 3) = \"e\"\n3\n\n\nsuf(\"base\", 2) = \"se\"\n2\n\n\n\n\u3053\u306e\u4f8b\u306e\u5834\u5408\u3001\u3044\u305a\u308c\u3082\u5148\u982d\u6587\u5b57\u304c\u7570\u306a\u308b\u305f\u3081\u3001\u305d\u306e\u5148\u982d\u6587\u5b57\u306e\u307f\u3067\u30bd\u30fc\u30c8\u3067\u304d\u307e\u3059\u3002\"ase\"\u304c\u63a5\u5c3e\u8f9e\u914d\u5217\u306e\u6700\u521d\u306e\u8981\u7d20\u306b\u306a\u308a\u3001\u305d\u306e\u5f8c\u306b\"base\", \"e\", \"se\"\u3068\u7d9a\u304d\u307e\u3059\u3002\u63a5\u5c3e\u8f9e\u914d\u5217\u81ea\u4f53\u306b\u683c\u7d0d\u3059\u308b\u306e\u306f\u63a5\u5c3e\u8f9e\u306e\u6587\u5b57\u5217\u305d\u306e\u3082\u306e\u3067\u306f\u306a\u304f\u3001\u5143\u306e\u6587\u5b57\u5217(\"base\")\u306e\u958b\u59cb\u4f4d\u7f6e\u3067\u3059\u3002\u305d\u306e\u305f\u3081\u3001\u4eca\u56de\u306e\u4f8b\u3067\u306f[\"ase\", \"base\", \"e\", \"se\"]\u3067\u306f\u306a\u304f\u3001[1, 0, 3, 2]\u3068\u3044\u3063\u305f\u914d\u5217\u304c\u63a5\u5c3e\u8f9e\u914d\u5217\u306b\u306a\u308a\u307e\u3059\u3002\nSA-IS\u306f\u3053\u306e\u63a5\u5c3e\u8f9e\u914d\u5217\u3092\u69cb\u7bc9\u3059\u308b\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u3067\u3059\u3002\n\n\n\u756a\u5175($)\n\u756a\u5175\u3068\u306f\u3001\u6587\u5b57\u5217\u306e\u6700\u5f8c\u3092\u8868\u3059\u6587\u5b57\u306e\u3053\u3068\u3067\u3059\u3002\u305f\u3068\u3048\u3070C\u8a00\u8a9e\u306e\u30cc\u30eb\u6587\u5b57(\\0)\u306a\u3069\u304c\u3042\u308a\u307e\u3059\u3002\u63a5\u5c3e\u8f9e\u914d\u5217\u3067\u306f\u3001\u3053\u306e\u756a\u5175\u3092\u63a5\u5c3e\u8f9e\u306e\u9806\u5e8f\u3092\u4e00\u610f\u306b\u3059\u308b\u305f\u3081\u306b\u4ed6\u306e\u3069\u3093\u306a\u6587\u5b57\u3088\u308a\u3082\u5c0f\u3055\u3044\u6587\u5b57\u3068\u3057\u3066\u6271\u3044\u307e\u3059\u3002\u307e\u305f\u3053\u3053\u3067\u306f\u756a\u5175\u3092'$'\u3067\u8a18\u8ff0\u3057\u307e\u3059\u3002\n\u305f\u3068\u3048\u3070\u6587\u5b57\u5217\"aa\"\u306e\u63a5\u5c3e\u8f9e\u914d\u5217\u3092\u8003\u3048\u308b\u3068\u3001suf(\"aa\", 0) = \"aa\"\u3068suf(\"aa\", 1) = \"a\"\u306e\u3069\u3061\u3089\u304c\u5c0f\u3055\u3044\u304b\u3092\u6c7a\u3081\u306a\u3051\u308c\u3070\u306a\u308a\u307e\u305b\u3093\u3002\u3053\u306e\u3068\u304d\u6587\u5b57\u5217\u306e\u6700\u5f8c\u306f\u5fc5\u305a'$'\u3068\u3057\u3066\"aa$\"\u306b\u3059\u308c\u3070\u3001suf(\"aa$\", 0) = \"aa$\"\u3001suf(\"aa$\", 1) = \"a$\" \u3068\u306a\u308a\u30012\u6587\u5b57\u76ee\u306e\u300c'a' > '$'\u300d\u304b\u3089\u300c\"aa$\" > \"a$\"\u300d\u3068\u5224\u65ad\u3067\u304d\u307e\u3059\u3002\n\n\n\u63a5\u5c3e\u8f9e\u306eType (S-Type, L-Type, LMS-Type)\nSA-IS\u3067\u306f\u3001\u5bfe\u8c61\u6587\u5b57\u5217\u306e\u5404\u6587\u5b57\u306b\u5bfe\u3057\u3066\u3001S-Type\u3068L-Type\u3068\u3044\u3063\u305f2\u3064\u306eType\u306b\u533a\u5206\u3051\u3057\u307e\u3059\u3002\u5404\u6587\u5b57\u306eType\u306f\u6b21\u306e\u3068\u304a\u308a\u3067\u3059\u3002\n\u6587\u5b57\u5217S\u306b\u5bfe\u3057\u3066\n  * \u756a\u5175($)\u306fS-Type\n  * S[i] < S[i+1]\u306e\u5834\u5408 \uff1a S[i]\u306fS-Type\n  * S[i] > S[i+1]\u306e\u5834\u5408 \uff1a S[i]\u306fL-Type\n  * S[i] = S[i+1]\u306e\u5834\u5408 \uff1a S[i]\u306fS[i+1]\u3068\u540c\u3058Type\n                           (S[i+1]\u304cS-Type\u306a\u3089\u3070\u3001S[i]\u306fS-Type,\n                            S[i+1]\u304cL-Type\u306a\u3089\u3070\u3001S[i]\u306fL-Type)\n\n(S[i]\u306f\u6587\u5b57\u5217S\u306ei\u756a\u76ee\u306e\u6587\u5b57\u3092\u8868\u3059)\n\n\u307e\u305f\u300cS[i-1]\u304cL-Type\u3001\u304b\u3064\u3001S[i]\u304cS-Type\u300d\u306e\u5834\u5408\u3001S[i]\u306e\u3053\u3068\u3092LMS-Type(Leftmost S-Type)\u3068\u547c\u3073\u307e\u3059\u3002\n\u4f8b\u3068\u3057\u3066\u6587\u5b57\u5217S=\"aababcabddabcab$\"\u306eType\u5206\u3051\u3092\u793a\u3057\u307e\u3059\u3002\n\n\n\ni\n0\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n\n\n\n\nS\na\na\nb\na\nb\nc\na\nb\nd\nd\na\nb\nc\na\nb\n$\n\n\ntype\nS\nS\nL\nS\nS\nL\nS\nS\nL\nL\nS\nS\nL\nS\nL\nS\n\n\nLMS\n\n\n\n*\n\n\n*\n\n\n\n*\n\n\n*\n\n*\n\n\n\n\u7dda\u30b0\u30e9\u30d5\u306b\u3059\u308b\u3068\u3001S-Type\u304c\u53f3\u4e0a\u304c\u308a\u3001L-Type\u304c\u53f3\u4e0b\u304c\u308a\u3001LMS-Type\u304cV\u5b57\u306e\u90e8\u5206\u306b\u8a72\u5f53\u3057\u307e\u3059\u3002\n\n\u3053\u306eType\u306f\u3001\u63a5\u5c3e\u8f9e\u306esuf(S, i)\u3068suf(S, i+1)\u306e\u6bd4\u8f03\u306b\u4f7f\u7528\u3067\u304d\u307e\u3059\u3002S[i]\u304cS-Type\u306a\u3089\u3070\u300csuf(S, i) < suf(S, i+1)\u300d\u3001S[i]\u304cL-Type\u306a\u3089\u3070\u300csuf(S, i) > suf(S, i+1)\u300d\u3067\u3059\u3002\u305f\u3068\u3048\u3070\u4e0a\u8a18\u306e\u4f8b\u306eS[8]\u306fL-Type\u3067\u3042\u308b\u305f\u3081\u3001\u300csuf(S, 8) > suf(S, 9)\u300d\u306b\u306a\u308a\u307e\u3059\u3002\u300csuf(S, 8) = \"ddabcab$\"\u300d \u3068\u300csuf(S, 9) = \"dabcab$\"\u300d\u3092\u78ba\u8a8d\u3057\u3066\u307f\u308b\u3068\u300c\"ddabcab$\" > \"dabcab$\"\u300d\u3067\u3042\u308a\u3001Type\u5206\u3051\u304c\u793a\u3057\u305f\u7d50\u679c\u901a\u308a\u3067\u3059\u3002\nS-Type\u304b\u3089\u958b\u59cb\u3059\u308b\u63a5\u5c3e\u8f9e\u306e\u3053\u3068\u3092\u300cS-Type\u306e\u63a5\u5c3e\u8f9e\u300d\u3068\u547c\u3076\u3053\u3068\u306b\u3057\u307e\u3059\u3002\u540c\u69d8\u306bL-Type\u3001LMS-Type\u304b\u3089\u958b\u59cb\u3059\u308b\u63a5\u5c3e\u8f9e\u306e\u3053\u3068\u3092\u300cL-Type\u306e\u63a5\u5c3e\u8f9e\u300d\u300cLMS-Type\u306e\u63a5\u5c3e\u8f9e\u300d\u3068\u3057\u307e\u3059\u3002\n\n\nLMS\u90e8\u5206\u6587\u5b57\u5217\nLMS\u90e8\u5206\u6587\u5b57\u5217\u3068\u306f\u3001LMS-Type\u306e\u4f4d\u7f6e\u3067\u5207\u308a\u51fa\u3057\u305f\u90e8\u5206\u6587\u5b57\u5217\u306e\u3053\u3068\u3067\u3059\u3002\u307e\u305f\u6700\u5f8c\u306e\"$\"\u3082LMS\u90e8\u5206\u6587\u5b57\u5217\u306b\u306a\u308a\u307e\u3059\u3002\u305f\u3068\u3048\u3070\u5148\u7a0b\u306e\u4f8b\u306e\u6587\u5b57\u5217S=\"aababcabddabcab$\"\u306eLMS\u90e8\u5206\u6587\u5b57\u5217\u306f\u3001\"abca\", \"abdda\", \"abca\",\"ab$\",\"$\"\u306e5\u3064\u3067\u3059\u3002\u8868\u3067\u66f8\u304f\u3068\u6b21\u306e\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\n\n\n\ni\n0\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n\n\n\n\nS\na\na\nb\na\nb\nc\na\nb\nd\nd\na\nb\nc\na\nb\n$\n\n\ntype\nS\nS\nL\nS\nS\nL\nS\nS\nL\nL\nS\nS\nL\nS\nL\nS\n\n\nLMS\n\n\n\n*\n\n\n*\n\n\n\n*\n\n\n*\n\n*\n\n\n\"abca\"\n\n\n\na\nb\nc\na\n\n\n\n\n\n\n\n\n\n\n\n\"abdda\"\n\n\n\n\n\n\na\nb\nd\nd\na\n\n\n\n\n\n\n\n\"abca\"\n\n\n\n\n\n\n\n\n\n\na\nb\nc\na\n\n\n\n\n\"ab$\"\n\n\n\n\n\n\n\n\n\n\n\n\n\na\nb\n$\n\n\n\"$\"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n$\n\n\n\n\n\nLMS-Prefix\nLMS-Prefix\u3068\u306f\u3001\u63a5\u5c3e\u8f9e\u3092LMS-Type\u306e\u4f4d\u7f6e\u3067\u5207\u308a\u53d6\u3063\u305f\u90e8\u5206\u6587\u5b57\u5217\u306e\u3053\u3068\u3067\u3059\u3002\n\u5148\u982d\u6587\u5b57\u304cLMS-Type\u306e\u5834\u5408\u3001\u6b21\u306eLMS-Type\u307e\u3067\u304c\u5bfe\u8c61\u3067\u3059\u3002\u307e\u305f\"$\"\u3082LMS-Prefix\u306b\u306a\u308a\u307e\u3059\u3002\n\u3053\u3053\u3067\u306fsuf(S, i)\u306eLMS-Prefix\u3092pre(S, i)\u3068\u8a18\u8ff0\u3057\u307e\u3059\u3002\n\u305f\u3068\u3048\u3070\u63a5\u5c3e\u8f9esuf(S, 6) = \"abddabcab$\"\u306eLMS-Prefix\u306f\u3001S[10]\u306e'a'\u304cLMS-Type\u3067\u3042\u308b\u305f\u3081\u3001pre(S, 6) = \"abdda\"\u306b\u306a\u308a\u307e\u3059\u3002LMS-Prefix\u306e\u4e00\u89a7\u306f\u6b21\u306e\u3068\u304a\u308a\u3067\u3059\u3002\n\n\n\ni\n0\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n\n\n\n\nS[i]\na\na\nb\na\nb\nc\na\nb\nd\nd\na\nb\nc\na\nb\n$\n\n\ntype\nS\nS\nL\nS\nS\nL\nS\nS\nL\nL\nS\nS\nL\nS\nL\nS\n\n\nLMS\n\n\n\n*\n\n\n*\n\n\n\n*\n\n\n*\n\n*\n\n\npre(S,0)\na\na\nb\na\n\n\n\n\n\n\n\n\n\n\n\n\n\n\npre(S,1)\n\na\nb\na\n\n\n\n\n\n\n\n\n\n\n\n\n\n\npre(S,2)\n\n\nb\na\n\n\n\n\n\n\n\n\n\n\n\n\n\n\npre(S,3)\n\n\n\na\nb\nc\na\n\n\n\n\n\n\n\n\n\n\n\npre(S,4)\n\n\n\n\nb\nc\na\n\n\n\n\n\n\n\n\n\n\n\npre(S,5)\n\n\n\n\n\nc\na\n\n\n\n\n\n\n\n\n\n\n\npre(S,6)\n\n\n\n\n\n\na\nb\nd\nd\na\n\n\n\n\n\n\n\npre(S,7)\n\n\n\n\n\n\n\nb\nd\nd\na\n\n\n\n\n\n\n\npre(S,8)\n\n\n\n\n\n\n\n\nd\nd\na\n\n\n\n\n\n\n\npre(S,9)\n\n\n\n\n\n\n\n\n\nd\na\n\n\n\n\n\n\n\npre(S,10)\n\n\n\n\n\n\n\n\n\n\na\nb\nc\na\n\n\n\n\npre(S,11)\n\n\n\n\n\n\n\n\n\n\n\nb\nc\na\n\n\n\n\npre(S,12)\n\n\n\n\n\n\n\n\n\n\n\n\nc\na\n\n\n\n\npre(S,13)\n\n\n\n\n\n\n\n\n\n\n\n\n\na\nb\n$\n\n\npre(S,14)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nb\n$\n\n\npre(S,15)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n$\n\n\n\n\u5148\u982d\u6587\u5b57\u304cLMS-Type\u3067\u3042\u308bLMS-Prefix\u306f\u3001LMS\u90e8\u5206\u6587\u5b57\u5217\u3068\u4e00\u81f4\u3057\u307e\u3059\u3002\u3053\u306e\u8868\u3067\u306f\u3001pre(S, 3) = \"abca\", pre(S, 6) = \"abdda\", pre(S, 10) = \"abca\", pre(S, 13) = \"ab$\", pre(S, 15) = \"$\"\u304c\u8a72\u5f53\u3057\u307e\u3059\u3002SA-IS\u3067\u306fLMS\u90e8\u5206\u6587\u5b57\u5217\u3092\u6587\u5b57\u5217\u9806\u3067\u30bd\u30fc\u30c8\u3057\u307e\u3059\u304c\u3001\u305d\u306e\u3068\u304dLMS-Prefix\u3092\u30bd\u30fc\u30c8\u3059\u308b\u3053\u3068\u3067LMS\u90e8\u5206\u6587\u5b57\u5217\u306e\u30bd\u30fc\u30c8\u3092\u5b9f\u73fe\u3057\u307e\u3059\u3002\n\n\n\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u306e\u8aac\u660e\nSA-IS\u306f\u63a5\u5c3e\u8f9e\u914d\u5217\u3092\u69cb\u7bc9\u3059\u308b\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u3067\u3059\u3002\u6b21\u306e\u624b\u9806\u3067\u69cb\u7bc9\u3057\u307e\u3059\u3002\n\nLMS\u90e8\u5206\u6587\u5b57\u5217\u306e\u30bd\u30fc\u30c8\nLMS-Type\u306e\u63a5\u5c3e\u8f9e\u306e\u30bd\u30fc\u30c8\nS-Type\u3001L-Type\u306e\u63a5\u5c3e\u8f9e\u306e\u30bd\u30fc\u30c8\n\n\u3053\u306e\u3046\u3061\u3001\u300c1. LMS\u90e8\u5206\u6587\u5b57\u5217\u306e\u30bd\u30fc\u30c8\u300d\u3068\u300c3. S-Type\u3001L-Type\u306e\u63a5\u5c3e\u8f9e\u306e\u30bd\u30fc\u30c8\u300d\u306f\u540c\u3058\u3088\u3046\u306a\u64cd\u4f5c\u3067\u5b9f\u73fe\u3057\u3066\u3044\u307e\u3059\u3002\u300c3. \u63a5\u5c3e\u8f9e\u306e\u30bd\u30fc\u30c8\u300d\u306e\u307b\u3046\u304c\u6bd4\u8f03\u7684\u7c21\u5358\u3067\u3042\u308b\u305f\u3081\u3001\u305d\u3061\u3089\u304b\u3089\u8aac\u660e\u3057\u3066\u3044\u304d\u307e\u3059\u3002\n\u307e\u305f\u3001\u305d\u308c\u305e\u308c\u306e\u5909\u6570\u306f\u4e0b\u8a18\u306e\u610f\u5473\u306b\u306a\u308a\u307e\u3059\u3002\nS  : \u5165\u529b\u3068\u306a\u308b\u6587\u5b57\u5217\u3002\u4f8b\u3067\u306fS=\"aababcabddabcab$\"\u3092\u4f7f\u7528\u3002\nSA : \u7d50\u679c\uff08\u63a5\u5c3e\u8f9e\u914d\u5217\uff09\u3092\u683c\u7d0d\u3059\u308b\u914d\u5217\u3002\u69cb\u7bc9\u9014\u4e2d\u306e\u5024\u3092\u683c\u7d0d\u3059\u308b\u305f\u3081\u306b\u3082\u4f7f\u7528\u3002\u4f8b\u3067\u306f\u9577\u305516\u306e\u914d\u5217\u3002\n\n\n3. S-Type\u3001L-Type\u306e\u63a5\u5c3e\u8f9e\u306e\u30bd\u30fc\u30c8\n\u3053\u306e\u51e6\u7406\u3067\u306f\u524d\u63d0\u3068\u3057\u3066\u3001LMS-Type\u306e\u307f\u306e\u63a5\u5c3e\u8f9e\u914d\u5217\u304c\u69cb\u7bc9\u6e08\u307f\u3068\u3057\u307e\u3059\uff08\u300c2. LMS-Type\u306e\u63a5\u5c3e\u8f9e\u306e\u30bd\u30fc\u30c8\u300d\u304b\u3089\uff09\u3002\u300c3. S-Type\u3001L-Type\u306e\u63a5\u5c3e\u8f9e\u306e\u30bd\u30fc\u30c8\u300d\u306f\u3001\u6b21\u306e3\u3064\u306e\u51e6\u7406\u3067\u5b9f\u65bd\u3057\u307e\u3059\u3002\n\n3.1. LMS-Type\u306e\u914d\u7f6e\n3.2. L-Type\u306e\u30bd\u30fc\u30c8\n3.3. S-Type\u306e\u30bd\u30fc\u30c8\n\n\u3053\u308c\u3089\u306e\u51e6\u7406\u306f\u3001\u3044\u308f\u3086\u308b\u30d0\u30b1\u30c3\u30c8\u30bd\u30fc\u30c8\u3092\u8ef8\u306b\u3057\u3066\u5b9f\u884c\u3057\u307e\u3059\u3002\n\n3.1. LMS-Type\u306e\u914d\u7f6e\nLMS-Type\u306e\u63a5\u5c3e\u8f9e\u914d\u5217\u306f\u69cb\u7bc9\u6e08\u307f\u306e\u305f\u3081\u3001\u305d\u306e\u8981\u7d20\uff08LMS-Type\u306e\u63a5\u5c3e\u8f9e\u306e\u958b\u59cb\u4f4d\u7f6e\uff09\u3092\u914d\u5217SA\u306b\u8a2d\u5b9a\u3057\u307e\u3059\u3002\u3053\u306e\u3068\u304d\u3001SA\u306e\u8a2d\u5b9a\u306f\u6b21\u306e\u3088\u3046\u306b\u884c\u3044\u307e\u3059\u3002\n\n\u30bd\u30fc\u30c8\u6e08\u307f\u306eLMS-Type\u306e\u9806\u5e8f\u306f\u5d29\u3055\u306a\u3044\nSA\u306e\u8a2d\u5b9a\u7b87\u6240\u306f\u3001\u5148\u982d\u6587\u5b57\u3054\u3068\u306e\u306b\u533a\u5206\u3051\u3057\u305f\u7bc4\u56f2\u3002\u540c\u3058\u5148\u982d\u6587\u5b57\u3092\u5834\u5408\u306f\u53f3\u8a70\u3081\u3067\u8a2d\u5b9a\n\n\u4e0a\u8a18\u306e\u3088\u3046\u306b\u8a2d\u5b9a\u3059\u308b\u305f\u3081\u3001\u307e\u305a\u5148\u982d\u6587\u5b57\u3054\u3068\u306e\u30d0\u30b1\u30c3\u30c8\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\u30d1\u30b1\u30c3\u30c8\u306b\u683c\u7d0d\u3059\u308b\u5024\u306f\u3001\u6587\u5b57\u306e\u51fa\u73fe\u56de\u6570\u3092\u30ab\u30a6\u30f3\u30c8\u3057\u3001\u305d\u308c\u305e\u308c\u306e\u6587\u5b57\u3067SA\u3092\u533a\u5206\u3051\u3057\u305f\u53f3\u7aef\u306e\u4f4d\u7f6e\u3067\u3059\u3002\u30d0\u30b1\u30c3\u30c8\u8a2d\u5b9a\u306e\u30b3\u30fc\u30c9\u306f\u6b21\u306e\u3068\u304a\u308a\u3067\u3059\uff08\u30b3\u30fc\u30c9\u306fGo\u8a00\u8a9e\u306b\u4f3c\u305f\u7591\u4f3c\u30b3\u30fc\u30c9\u3067\u3059\uff09\n// bucket\u306fSA\u306e\u8981\u7d20\u306e\u6700\u5927\u5024\u3092\u683c\u7d0d\u3067\u304d\u308b\u914d\u5217\n// (bucket\u306e\u8981\u7d20\u306e\u521d\u671f\u5024\u306f\u5168\u30660\u3068\u3059\u308b\uff09\n\n// SA\u306b\u51fa\u73fe\u3059\u308b\u6587\u5b57\u306e\u30ab\u30a6\u30f3\u30c8\nfor i := 0; i < len(SA); i++ {\n    bucket[S[i]]++\n}\n\n// \u5148\u982d\u6587\u5b57\u306e\u683c\u7d0d\u4f4d\u7f6e\u3092\u6c7a\u3081\u308b(\u53f3\u8a70\u3081\u7528)\nsum := -1\nfor i := 0; i < len(bucket); i++ {\n    sum += bucket[i]\n    bucket[i] += sum\n}\n\n\u6b21\u306b\u3053\u306e\u30d0\u30b1\u30c3\u30c8\u3092\u4f7f\u7528\u3057\u3066\u3001LMS-Type\u306e\u63a5\u5c3e\u8f9e\u914d\u5217\u3092\u672b\u5c3e\u304b\u3089\u5148\u982d\u307e\u3067\u9806\u306b\u51e6\u7406\u3057\u307e\u3059\u3002LMS-Type\u306e\u6587\u5b57\u3067\u30d0\u30b1\u30c3\u30c8\u306e\u5024\u3092\u53d6\u5f97\u3057\u3001\u305d\u306e\u4f4d\u7f6e\u306bLMS-Type\u306e\u300c\u63a5\u5c3e\u8f9e\u306e\u958b\u59cb\u4f4d\u7f6e\uff08\u63a5\u5c3e\u8f9e\u914d\u5217\u306e\u8981\u7d20\uff09\u300d\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002SA\u306b\u8a2d\u5b9a\u5f8c\u3001\u30d0\u30b1\u30c3\u30c8\u306e\u5024\u3092-1\u3057\u3066\u8a2d\u5b9a\u4f4d\u7f6e\u30921\u3064\u624b\u524d\u306b\u79fb\u52d5\u3057\u307e\u3059\u3002\n// LMSSA\u306f\u300cLMS-Type\u306e\u63a5\u5c3e\u8f9e\u914d\u5217\u300d\nfor k := len(LMSSA) - 1; k >= 0; k-- {\n    i := LMSSA[k]   \u3000\n    ch := S[i]         // LMS-Type\u306e\u5148\u982d\u6587\u5b57\u3092\u53d6\u5f97\n\n    SA[bucket[ch]] = i // LMS-Type\u306e\u300c\u63a5\u5c3e\u8f9e\u306e\u958b\u59cb\u4f4d\u7f6e\u300d\u3092\u8a2d\u5b9a\n    bucket[ch]--       // \u30d0\u30b1\u30c3\u30c8\u3092-1\n}\n\n\u4f8b\n\n\u6587\u5b57\u5217S=\"aababcabddabcab$\"\u306eLMS-Type\u306e\u958b\u59cb\u4f4d\u7f6e\u306f\u30013, 6, 10, 13, 15\u3067\u3057\u305f\u3002\u305d\u308c\u305e\u308c\u306e\u63a5\u5c3e\u8f9e\u3067\u30bd\u30fc\u30c8\u3059\u308b\u3068\u6b21\u306e\u9806\u5e8f\u306b\u306a\u308a\u307e\u3059\u3002\nsuf(S, 15) = \"$\"\nsuf(S, 13) = \"ab$\"\nsuf(S, 10) = \"abcab$\"\nsuf(S,  3) = \"abcabddabcab$\"\nsuf(S,  6) = \"abddabcab$\"\n\n\u524d\u63d0\u3068\u3057\u3066\u3053\u306e\u9806\u5e8f\u3092\u6301\u3064\u914d\u5217LMSSA=[15,13,10,3,6]\u306f\u69cb\u7bc9\u6e08\u307f\u3068\u3057\u307e\u3059\u3002\n\u6b21\u306b\u30d0\u30b1\u30c3\u30c8\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\n\n\n\n$\na\nb\nc\nd\n\n\n\n\n\u6587\u5b57\u306e\u30ab\u30a6\u30f3\u30c8\n1\n6\n5\n2\n2\n\n\n\u30d0\u30b1\u30c3\u30c8\u306e\u5024\n0\n6\n11\n13\n15\n\n\n\u5404\u6587\u5b57\u306e\u533a\u5206\u3051\n0\n1\uff5e6\n7\uff5e11\n12\uff5e13\n14\uff5e15\n\n\n\n\u30d0\u30b1\u30c3\u30c8\u306e\u5024\u306f\u3001\u6587\u5b57\u306e\u30ab\u30a6\u30f3\u30c8\u3092\u5148\u982d\u304b\u3089\u9806\u306b\u7d2f\u7a4d\u3057\u305f\u5024\u304b\u3089-1\u3057\u305f\u3082\u306e\u3067\u3059\u3002\n\u305f\u3068\u3048\u3070'b'\u306e\u30d0\u30b1\u30c3\u30c8\u306e\u5024\u300c11\u300d\u306f\u3001'$','a','b'\u306e\u6587\u5b57\u306e\u30ab\u30a6\u30f3\u30c8\u306e\u7d2f\u8a08-1(1 + 6 + 5 - 1)\u3067\u3059\u3002\n\u30d0\u30b1\u30c3\u30c8\u306e\u5024\u304b\u3089\u3001\u5404\u6587\u5b57\u306e\u533a\u5206\u3051\u304c\u5224\u65ad\u3067\u304d\u307e\u3059\u3002\n\u3053\u306e\u30d0\u30b1\u30c3\u30c8\u3068\u914d\u5217LSMSA\u3092\u4f7f\u7528\u3057\u3066\u3001\u6b21\u306e\u3088\u3046\u306bSA\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n\n\n\ni\n0\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n\n\n\n\u5148\u982d\u6587\u5b57\u306e\u7bc4\u56f2\n$\na\nb\nc\nd\n\n\nSA[i]\n15\n\n\n13\n10\n3\n6\n\n\n\n\n\n\n\n\n\n\n\n\u5148\u982d\u6587\u5b57\u3054\u3068\u306e\u7bc4\u56f2\u306b\u914d\u5217LMSSA\u306e\u5024\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\nSA\u306b\u306f\u672a\u8a2d\u5b9a\u306e\u7b87\u6240\uff08\u7a7a\u6b04\u90e8\u5206\uff09\u304c\u3042\u308a\u307e\u3059\u304c\u3001LMSSA\u306e\u9806\u5e8f\u3092\u5d29\u3057\u3066\u3044\u306a\u3044\u72b6\u614b\u3067\u3059\u3002\n\n\n3.2. L-Type\u306e\u30bd\u30fc\u30c8\n3.1\u3067\u8a2d\u5b9a\u3057\u305fLMS-Type\u306e\u4f4d\u7f6e\u3092\u5229\u7528\u3057\u3066\u3001\u3059\u3079\u3066\u306eL-Type\u306e\u300c\u63a5\u5c3e\u8f9e\u306e\u958b\u59cb\u4f4d\u7f6e\u300d\u3092\u914d\u5217SA\u306b\u8a2d\u5b9a\u3057\u307e\u3059\u3002\u624b\u9806\u3068\u3057\u3066\u306f\u3001\u307e\u305aLMS-Type\u306e\u6642\u3068\u540c\u69d8\u306b\u5148\u982d\u6587\u5b57\u3054\u3068\u306e\u30d0\u30b1\u30c3\u30c8\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\u30d0\u30b1\u30c3\u30c8\u306f\u57fa\u672c\u7684\u306b3.1\u306e\u3068\u304d\u3068\u540c\u3058\u3067\u3059\u304c\u5de6\u8a70\u3081\u7528\u3067\u3059\u3002\n// bucket\u306fSA\u306e\u8981\u7d20\u306e\u6700\u5927\u5024\u3092\u683c\u7d0d\u3067\u304d\u308b\u914d\u5217\n// (bucket\u306e\u8981\u7d20\u306e\u521d\u671f\u5024\u306f\u5168\u30660\u3068\u3059\u308b\uff09\n\n// SA\u306b\u51fa\u73fe\u3059\u308b\u6587\u5b57\u306e\u30ab\u30a6\u30f3\u30c8\nfor i := 0; i < len(SA); i++ {\n    bucket[S[i]]++\n}\n\n// \u5148\u982d\u6587\u5b57\u306e\u683c\u7d0d\u4f4d\u7f6e\u3092\u6c7a\u3081\u308b(\u5de6\u8a70\u3081\u7528)\nsum := 0\nfor i := 0; i < len(bucket); i++ {\n    b := bucket[i]\n    bucket[i] += sum\n    sum += b\n}\n\n\u6b21\u306b\u3053\u306e\u30d0\u30b1\u30c3\u30c8\u3068LMS-Type\u3092\u8a2d\u5b9a\u3057\u305f\u914d\u5217SA\u3092\u4f7f\u7528\u3057\u3066\u3001L-Type\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002SA\u3092\u5148\u982d\u304b\u3089\u672b\u5c3e\u307e\u3067\u9806\u306b\u51e6\u7406\u3057\u3001SA[i]-1\u304cL-Type\u306a\u3089\u3070\u3001SA[i]-1\u3092SA\u306b\u8a2d\u5b9a\u3057\u307e\u3059\u3002\u3053\u306e\u3068\u304dSA\u306b\u8a2d\u5b9a\u3059\u308b\u4f4d\u7f6e\u306f\u3001\u30d0\u30b1\u30c3\u30c8\u3092\u4f7f\u7528\u3057\u3066\u305d\u306e\u5148\u982d\u6587\u5b57\u306e\u7bc4\u56f2\u306b\u5de6\u8a70\u3081\u3057\u307e\u3059\u3002\nfor i := 0; i < len(SA); i++ {\n    if \u300cSA[i]\u306b\u5024\u304c\u3042\u308b\u300d\u304b\u3064\u300cSA[i]-1\u304cL-Type\u300d {\n        ltypeIndex := SA[i]-1\n        ch := S[ltypeIndex]         // \u63a5\u5c3e\u8f9e\u306e\u5148\u982d\u6587\u5b57\u3092\u53d6\u5f97 \n        SA[bucket[ch]] = ltypeIndex // L-Type\u306e\u300c\u63a5\u5c3e\u8f9e\u306e\u958b\u59cb\u4f4d\u7f6e\u300d\u3092\u8a2d\u5b9a\n        bucket[ch]++                // \u30d0\u30b1\u30c3\u30c8\u3092+1\n    }\n}\n\n\u3053\u306e\u624b\u9806\u3067\u3059\u3079\u3066\u306eL-Type\u304c\u63a5\u5c3e\u8f9e\u306e\u6587\u5b57\u5217\u9806\u3067SA\u306b\u8a2d\u5b9a\u3055\u308c\u307e\u3059\u3002\u3059\u3079\u3066\u306eL-Type\u3092\u7db2\u7f85\u3067\u304d\u308b\u306e\u306f\u3001\u6b21\u306e\u3088\u3046\u306a\u7406\u7531\u3067\u3059\u3002\n\nSA[i]\u304cLMS-Type\u306a\u3089\u3070\u3001\u305d\u306e\u5b9a\u7fa9\u304b\u3089SA[i]-1\u306fL-Type\nSA[i]\u304cL-Type\u304b\u3064SA[i]-1\u304cS-Type\u306a\u3089\u3070\u3001\u6b21\u306bL-Type\u304c\u51fa\u73fe\u3059\u308b\u306e\u306fLMS-Type\u306e\u624b\u524d\nSA[i]-1\u304cL-Type\u306a\u3089\u3070\u3001suf(S, SA[i]-1) > suf(S, SA[i])\n\n\u307e\u305f\u5de6\u8a70\u3081\u3067\u6587\u5b57\u5217\u9806\u306b\u30bd\u30fc\u30c8\u3067\u304d\u308b\u7406\u7531\u306f\u3001\u4e0a\u8a18\u306b\u52a0\u3048\u3066\u6b21\u306e\u3088\u3046\u306a\u63a5\u5c3e\u8f9e\u306e\u6027\u8cea\u306e\u305f\u3081\u3067\u3059\u3002\n\nsuf(S, SA[i]-1)\u3068suf(S, SA[j]-1)\u304c\u540c\u3058\u5148\u982d\u6587\u5b57\u306a\u3089\u3070\u3001\u305d\u306e\u9806\u5e8f\u306fsuf(S, SA[i])\u3068suf(S, SA[j])\u306e\u9806\u5e8f\u3067\u6c7a\u307e\u308b\n\n\u3053\u308c\u306b\u3088\u3063\u3066\u624b\u524d\u306b\u51fa\u73fe\u3057\u305f\u5024\u3092\u5de6\u8a70\u3081\u3067\u8a2d\u5b9a\u3059\u308c\u3070\u3001\u63a5\u5c3e\u8f9e\u914d\u5217\u306e\u9806\u5e8f\u3069\u304a\u308a\u306b\u306a\u308a\u307e\u3059\u3002\n\u4f8b\n\n\u5de6\u8a70\u3081\u7528\u306e\u30d0\u30b1\u30c3\u30c8\u3092\u7528\u610f\u3057\u307e\u3059\u3002\n\n\n\n\n$\na\nb\nc\nd\n\n\n\n\n\u6587\u5b57\u306e\u30ab\u30a6\u30f3\u30c8\n1\n6\n5\n2\n2\n\n\n\u30d0\u30b1\u30c3\u30c8\u306e\u5024\n0\n1\n7\n12\n14\n\n\n\u5404\u6587\u5b57\u306e\u533a\u5206\u3051\n0\n1\uff5e6\n7\uff5e11\n12\uff5e13\n14\uff5e15\n\n\n\n\u30d0\u30b1\u30c3\u30c8\u306e\u5024\u306f\u3001\u6587\u5b57\u306e\u30ab\u30a6\u30f3\u30c8\u3092\u5148\u982d\u304b\u3089\u9806\u306b\u7d2f\u7a4d\u3057\u305f\u5024\u3067\u3059\u3002\u305f\u3060\u3057\u81ea\u8eab\u306e\u30ab\u30a6\u30f3\u30c8\u306f\u9664\u304d\u307e\u3059\u3002\n\u305f\u3068\u3048\u3070'b'\u306e\u30d0\u30b1\u30c3\u30c8\u306e\u5024\u300c7\u300d\u306f\u3001'$','a'\u306e\u6587\u5b57\u306e\u30ab\u30a6\u30f3\u30c8\u306e\u7d2f\u7a4d\u3057\u305f\u6570(1 + 6)\u3067\u3059\u3002\n\u6b21\u306bL-Type\u306e\u8a2d\u5b9a\u3092SA\u306e\u5148\u982d\u304b\u3089\u9806\u306b\u51e6\u7406\u3057\u307e\u3059\u3002\n\u300cSA[0] = 15\u300d\u306e\u51e6\u7406\u306f\u300cSA[0]-1 = 14\u300d\u306e\u8a2d\u5b9a\u3067\u3059\u3002\u8a2d\u5b9a\u306f\u6b21\u306e\u624b\u9806\u3067\u884c\u3044\u307e\u3059\u3002\n\nS[14]='b'\u306e\u305f\u3081\u3001b\u306e\u30d0\u30b1\u30c3\u30c8\u3092\u53c2\u7167\u3057\u30667\u3092\u53d6\u5f97\nSA[7]\u306b14\u3092\u8a2d\u5b9a(\u4e0b\u8a18\u8868\u306e\u9752\u6587\u5b57\u306e\u90e8\u5206)\nb\u306e\u30d0\u30b1\u30c3\u30c8\u3092+1\n\n\u3053\u306e\u51e6\u7406\u3092SA\u306e\u672b\u5c3e\u307e\u3067\u9806\u306b\u51e6\u7406\u3057\u307e\u3059\u3002\u8a2d\u5b9a\u306e\u6d41\u308c\u306f\u6b21\u306e\u8868\u306e\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\n\n\n\ni\n0\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n\n\n\n\u5148\u982d\u6587\u5b57\u306e\u7bc4\u56f2\n$\na\nb\nc\nd\n\n\nSA[i]:\u521d\u671f\u72b6\u614b\n15\n\n\n13\n10\n3\n6\n\n\n\n\n\n\n\n\n\n\n\nSA[0] = 15\u306e\u51e6\u7406\n15\n\n\n13\n10\n3\n6\n14\n\n\n\n\n\n\n\n\n\n\nSA[3] = 12\u306e\u51e6\u7406\n15\n\n\n13\n10\n3\n6\n14\n\n\n\n\n12\n\n\n\n\n\nSA[4] = 10\u306e\u51e6\u7406\n15\n\n\n13\n10\n3\n6\n14\n\n\n\n\n12\n\n9\n\n\n\nSA[5] =  3\u306e\u51e6\u7406\n15\n\n\n13\n10\n3\n6\n14\n2\n\n\n\n12\n\n9\n\n\n\nSA[6] =  6\u306e\u51e6\u7406\n15\n\n\n13\n10\n3\n6\n14\n2\n\n\n\n12\n5\n9\n\n\n\nSA[7] = 14, SA[8] = 2, SA[12] = 12, SA[13] = 5\u306f\u3001SA[i]-1\u304cS-Type\u306e\u305f\u3081\u30b9\u30ad\u30c3\u30d7\n\n\nSA[14] = 9\u306e\u51e6\u7406\n15\n\n\n13\n10\n3\n6\n14\n2\n\n\n\n12\n5\n9\n8\n\n\n\u3053\u306e\u51e6\u7406\u3067\u3059\u3079\u3066\u306eL-Type\u306e\u63a5\u5c3e\u8f9e\u3092\u6587\u5b57\u5217\u9806\u306b\u8a2d\u5b9a\u3067\u304d\u307e\u3057\u305f\u3002\n\n\n3.3. S-Type\u306e\u30bd\u30fc\u30c8\n\u4eca\u5ea6\u306f\u300c3.2. L-Type\u306e\u30bd\u30fc\u30c8\u300d\u3067\u8a2d\u5b9a\u3057\u305fL-Type\u3092\u5229\u7528\u3057\u3066\u3001\u3059\u3079\u3066\u306eS-Type\u306e\u300c\u63a5\u5c3e\u8f9e\u306e\u958b\u59cb\u4f4d\u7f6e\u300d\u3092\u914d\u5217SA\u306b\u8a2d\u5b9a\u3057\u307e\u3059\uff08\u305f\u3060\u3057\u756a\u5175($)\u306f\u9664\u304f\uff09\u3002\u300c3.1. LMS-Type\u306e\u914d\u7f6e\u300d\u3067SA\u5185\u306b\u8a2d\u5b9a\u3057\u305fLMS-Type\u306e\u958b\u59cb\u4f4d\u7f6e\u306f\u3053\u306e\u51e6\u7406\u3067\u4e0a\u66f8\u304d\u3055\u308c\u307e\u3059\u3002\u624b\u9806\u3068\u3057\u3066\u306f\u6b21\u306e\u3068\u304a\u308a\u3067\u3059\u3002\n\n\u5148\u982d\u6587\u5b57\u3054\u3068\u306e\u30d0\u30b1\u30c3\u30c8\u3092\u4f5c\u6210\uff08\u53f3\u8a70\u3081\u7528\u30023.1.\u3068\u540c\u3058\uff09\nSA\u3092\u672b\u5c3e\u304b\u3089\u5148\u982d\u307e\u3067\u9806\u306b\u51e6\u7406\u3057\u3001SA[i]-1\u304cS-Type\u306a\u3089\u3070SA\u306b\u8a2d\u5b9a\uff083.2\u306e\u985e\u4f3c\u51e6\u7406\uff09\n\nS-Type\u3092SA\u306b\u8a2d\u5b9a\u3059\u308b\u51e6\u7406\u306f\u6b21\u306e\u3068\u304a\u308a\u3067\u3059\u3002\nfor i := len(SA)-1; 0 <= i; i-- {\n    if \u300cSA[i]\u306b\u5024\u304c\u3042\u308b\u300d\u304b\u3064\u300cSA[i]-1\u304cS-Type\u300d {\n        stypeIndex := SA[i]-1\n        ch := S[stypeIndex]         // \u63a5\u5c3e\u8f9e\u306e\u5148\u982d\u6587\u5b57\u3092\u53d6\u5f97 \n        SA[bucket[ch]] = stypeIndex // S-Type\u306e\u300c\u63a5\u5c3e\u8f9e\u306e\u958b\u59cb\u4f4d\u7f6e\u300d\u3092\u8a2d\u5b9a\n        bucket[ch]--                // \u30d0\u30b1\u30c3\u30c8\u3092-1\n    }\n}\n\n\u3053\u306e\u624b\u9806\u3067\u3059\u3079\u3066\u306eS-Type\u304c\u63a5\u5c3e\u8f9e\u306e\u6587\u5b57\u5217\u9806\u3067SA\u306b\u8a2d\u5b9a\u3055\u308c\u3001\u63a5\u5c3e\u8f9e\u914d\u5217\u304c\u5b8c\u6210\u3057\u307e\u3059\u3002\n\u4f8b\n\n\u7528\u610f\u3059\u308b\u30d0\u30b1\u30c3\u30c8\u306f3.1.\u3068\u540c\u3058\u3067\u3059\u3002S-Type\u3092\u8a2d\u5b9a\u3059\u308b\u51e6\u7406\u306f\u3001SA\u306e\u672b\u5c3e\u304b\u3089\u51e6\u7406\u3057\u307e\u3059\u3002\n\u300cSA[15] = 8\u300d\u3067\u306e\u51e6\u7406\u306f\u300cSA[15]-1 = 7\u300d\u306e\u8a2d\u5b9a\u3067\u3059\u3002\u8a2d\u5b9a\u306f\u6b21\u306e\u624b\u9806\u3067\u884c\u3044\u307e\u3059\u3002\n\nS[7] = 'b'\u3067\u3042\u308b\u305f\u3081\u3001b\u306e\u30d0\u30b1\u30c3\u30c8\u3092\u53c2\u7167\u3057\u306611\u3092\u53d6\u5f97\nSA[11]\u306b7\u3092\u8a2d\u5b9a(\u4e0b\u8a18\u8868\u306e\u9752\u6587\u5b57\u306e\u90e8\u5206)\nb\u306e\u30d0\u30b1\u30c3\u30c8\u3092-1\n\n\u3053\u306e\u51e6\u7406\u3092SA\u306e\u5148\u982d\u307e\u3067\u9806\u306b\u51e6\u7406\u3057\u307e\u3059\u3002\u8a2d\u5b9a\u306e\u6d41\u308c\u306f\u6b21\u306e\u8868\u306e\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\n\n\n\ni\n0\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n\n\n\n\u5148\u982d\u6587\u5b57 \u306e \u7bc4\u56f2\n$\na\nb\nc\nd\n\n\nSA[i]:\u521d\u671f\u72b6\u614b\n15\n\n\n13\n10\n3\n6\n14\n2\n\n\n\n12\n5\n9\n8\n\n\nSA[15] = 8\u306e\u51e6\u7406\n15\n\n\n13\n10\n3\n6\n14\n2\n\n\n7\n12\n5\n9\n8\n\n\nSA[14] = 9\u306f\u30019-1 = 8\u304cL-Type\u306e\u305f\u3081\u30b9\u30ad\u30c3\u30d7\n\n\nSA[11] = 5\u306e\u51e6\u7406\n15\n\n\n13\n10\n3\n6\n14\n2\n\n4\n7\n12\n5\n9\n8\n\n\nSA[10] = 12\u306e\u51e6\u7406\n15\n\n\n13\n10\n3\n6\n14\n2\n11\n4\n7\n12\n5\n9\n8\n\n\nSA[11] = 7\u306e\u51e6\u7406\n15\n\n\n13\n10\n3\n6\n14\n2\n11\n4\n7\n12\n5\n9\n8\n\n\nSA[10] = 4\u306e\u51e6\u7406\n15\n\n\n13\n10\n3\n6\n14\n2\n11\n4\n7\n12\n5\n9\n8\n\n\nSA[9] = 11\u306e\u51e6\u7406\n15\n\n\n13\n10\n3\n6\n14\n2\n11\n4\n7\n12\n5\n9\n8\n\n\nSA[8] = 2\u306e\u51e6\u7406\n15\n\n\n1\n10\n3\n6\n14\n2\n11\n4\n7\n12\n5\n9\n8\n\n\nSA[7] = 14\u306e\u51e6\u7406\n15\n\n13\n1\n10\n3\n6\n14\n2\n11\n4\n7\n12\n5\n9\n8\n\n\nSA[6] = 6, SA[5] = 3, SA[4] = 10\u306f\u3001SA[i]-1\u304cL-Type\u306e\u305f\u3081\u30b9\u30ad\u30c3\u30d7\n\n\nSA[3] = 1\u306e\u51e6\u7406\n15\n0\n13\n1\n10\n3\n6\n14\n2\n11\n4\n7\n12\n5\n9\n8\n\n\nSA[2] = 3, SA[0] = 15\u306f\u3001SA[i]-1\u304cL-Type\u306e\u305f\u3081\u30b9\u30ad\u30c3\u30d7\u3002SA[1] = 0\u306fSA[i]-1\u304c\u30de\u30a4\u30ca\u30b9\u306e\u305f\u3081\u30b9\u30ad\u30c3\u30d7\n\n\n\u3053\u306eS-Type\u306e\u30bd\u30fc\u30c8\u304c\u7d42\u308f\u308b\u3068\u3001SA\u306f\u6587\u5b57\u5217S\u306e\u63a5\u5c3e\u8f9e\u914d\u5217\u306b\u306a\u308a\u307e\u3059\u3002\n\n\n\n1. LMS\u90e8\u5206\u6587\u5b57\u5217\u306e\u30bd\u30fc\u30c8\n\u300c3. S-Type\u3001L-Type\u306e\u63a5\u5c3e\u8f9e\u306e\u30bd\u30fc\u30c8\u300d\u306e\u51e6\u7406\u3067\u306f\u3001LMS-Type\u306e\u63a5\u5c3e\u8f9e\u914d\u5217\u304c\u5fc5\u8981\u3067\u3057\u305f\u3002\u300c1. LMS\u90e8\u5206\u6587\u5b57\u5217\u306e\u30bd\u30fc\u30c8\u300d\u3068\u300c2. LMS-Type\u306e\u63a5\u5c3e\u8f9e\u306e\u30bd\u30fc\u30c8\u300d\u306f\u3001\u3053\u306eLMS-Type\u306e\u63a5\u5c3e\u8f9e\u914d\u5217\u3092\u4f5c\u6210\u3059\u308b\u307e\u3067\u306e\u51e6\u7406\u306b\u306a\u308a\u307e\u3059\u3002\n\u300c1. LMS\u90e8\u5206\u6587\u5b57\u5217\u306e\u30bd\u30fc\u30c8\u300d\u306e\u624b\u9806\u306f\u6b21\u306e\u3068\u304a\u308a\u3067\u3059\u3002\n\n1.1. LMS-Type\u306e\u30bd\u30fc\u30c8\uff08\u5148\u982d\u6587\u5b57\u306e\u307f\uff09\n1.2. L-Type\u306e\u30bd\u30fc\u30c8\n1.3. S-Type\u306e\u30bd\u30fc\u30c8\n1.4. LMS-Prefix\u306e\u914d\u5217\u304b\u3089LMS\u90e8\u5206\u6587\u5b57\u5217\u306e\u62bd\u51fa\n\n1.1\uff5e1.3\u306e\u51e6\u7406\u3067LMS-Prefix\u306e\u30bd\u30fc\u30c8\u3092\u884c\u3044\u30011.4\u3067LMS-Prefix\u306e\u914d\u5217\u304b\u3089LMS\u90e8\u5206\u6587\u5b57\u5217\u306e\u62bd\u51fa\u3092\u884c\u3044\u307e\u3059\u3002\n\u307e\u305f1.1\uff5e1.3\u306e\u51e6\u7406\u306f\u30013.1\uff5e3.3\u306e\u51e6\u7406\u3068\u307b\u3068\u3093\u3069\u540c\u3058\u51e6\u7406\u306b\u306a\u3063\u3066\u3044\u307e\u3059\u3002\n\n1.1. LMS-Type\u306e\u30bd\u30fc\u30c8\uff08\u5148\u982d\u6587\u5b57\u306e\u307f\uff09\n\u3053\u306e\u51e6\u7406\u306f\u3001\u300c3.1. LMS-Type\u306e\u914d\u7f6e\u300d\u306e\u985e\u4f3c\u51e6\u7406\u3067\u3059\u3002\u3057\u304b\u3057\u3001\u30bd\u30fc\u30c8\u6e08\u307f\u306eLMS-Type\u304c\u307e\u3060\u5b58\u5728\u3057\u306a\u3044\u305f\u3081\u3001\u30d0\u30b1\u30c3\u30c8\u3092\u4f7f\u7528\u3057\u3066\u5148\u982d\u6587\u5b57\u306e\u307f\u3067\u30bd\u30fc\u30c8\u3057\u307e\u3059\u30022\u6587\u5b57\u76ee\u4ee5\u964d\u306e\u9806\u756a\u306f\u3053\u3053\u3067\u306f\u6c7a\u3081\u3089\u308c\u307e\u305b\u3093\u3002\u624b\u9806\u3068\u3057\u3066\u306f\u6b21\u306e\u3068\u304a\u308a\u3067\u3059\u3002\n\n\u5148\u982d\u6587\u5b57\u3054\u3068\u306e\u30d0\u30b1\u30c3\u30c8\u3092\u8a2d\u5b9a(\u53f3\u8a70\u3081\u7528\u30023.1.\u3068\u540c\u3058\uff09\n\u6587\u5b57S\u3092\u5148\u982d\u304b\u3089\u672b\u5c3e\u307e\u3067\u9806\u306b\u51e6\u7406\u3057\u3001LMS-Type\u306e\u6587\u5b57\u4f4d\u7f6e\u3092\u914d\u5217SA\u306b\u683c\u7d0d\n\nLMS-Type\u306e\u8a2d\u5b9a\u306f\u3001\u6587\u5b57\u5217S\u306b\u5bfe\u3057\u3066\u672b\u5c3e\u304b\u3089\u5148\u982d\u307e\u3067\u9806\u306b\u51e6\u7406\u3057\u307e\u3059\u3002\nfor i := len(S)-1; 0 <= i; i-- {\n    if \u300cS[i]\u304cLMS-Type\u300d {\n        ch := S[i]         // \u63a5\u5c3e\u8f9e\u306e\u5148\u982d\u6587\u5b57\u3092\u53d6\u5f97 \n        SA[bucket[ch]] = i // LMS-Type\u306e\u300c\u6587\u5b57\u4f4d\u7f6e\uff08\u63a5\u5c3e\u8f9e\u306e\u958b\u59cb\u4f4d\u7f6e\uff09\u300d\u3092\u8a2d\u5b9a\n        bucket[ch]--       // \u30d0\u30b1\u30c3\u30c8\u3092-1\n    }\n}\n\n\u4f8b\n\n\u7528\u610f\u3059\u308b\u30d0\u30b1\u30c3\u30c8\u306f3.1.\u3068\u540c\u3058\u3067\u3059\u3002\nLMS-Type\u306e\u8a2d\u5b9a\u51e6\u7406\u306f\u6b21\u306e\u3068\u304a\u308a\u3067\u3059\u3002\n\n\n\ni\n0\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n\n\n\n\u5148\u982d\u6587\u5b57\u306e\u7bc4\u56f2\n$\na\nb\nc\nd\n\n\nSA[i]\n15\n\n\n3\n6\n10\n13\n\n\n\n\n\n\n\n\n\n\n\n3.1\u306e\u7d50\u679c\u3068\u6bd4\u3079\u308b\u3068\u3001\u5148\u982d\u6587\u5b57a\u306e\u7bc4\u56f2\u5185\u3067\u9806\u756a\u304c\u5165\u308c\u66ff\u308f\u3063\u3066\u3044\u307e\u3059\u3002\n\n\n1.2. L-Type\u306e\u30bd\u30fc\u30c8\n\u51e6\u7406\u81ea\u4f53\u306f\u300c3.2. L-Type\u306e\u30bd\u30fc\u30c8\u300d\u3068\u540c\u3058\u3067\u3059\u3002\u3057\u304b\u3057\u30011.1.\u3067LMS-Type\u304c\u6b63\u3057\u304f\u30bd\u30fc\u30c8\u3055\u308c\u3066\u3044\u306a\u3044\u305f\u3081\u3001\u63a5\u5c3e\u8f9e\u914d\u5217\u3068\u3057\u3066\u306f\u6b63\u3057\u3044\u9806\u756a\u306b\u306a\u308a\u307e\u305b\u3093\u3002\n\u4f8b\n\n\u51e6\u7406\u306f3.2\u3068\u5168\u3066\u540c\u3058\u3067\u3042\u308b\u305f\u3081\u7701\u7565\u3057\u307e\u3059\u3002\u7d50\u679c\u306f\u6b21\u306e\u3068\u304a\u308a\u3067\u3059\u3002\n\n\n\ni\n0\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n\n\n\n\u5148\u982d\u6587\u5b57\u306e\u7bc4\u56f2\n$\na\nb\nc\nd\n\n\nSA[i]\n15\n\n\n3\n6\n10\n13\n14\n2\n\n\n\n5\n12\n9\n8\n\n\n3.2\u306e\u7d50\u679c\u3068\u6bd4\u3079\u308b\u3068SA[12]=5\u3068SA[13]=12\u306e\u90e8\u5206\u304c\u5165\u308c\u66ff\u308f\u3063\u3066\u3044\u307e\u3059\u3002\n\u3053\u308c\u306f1.1\u30672\u6587\u5b57\u76ee\u306e\u9806\u5e8f\u3092\u6c7a\u3081\u3089\u308c\u306a\u304b\u3063\u305f\u305f\u3081\u3067\u3059\u3002\n\n\n1.3. S-Type\u306e\u30bd\u30fc\u30c8\n\u3053\u306e\u51e6\u7406\u3082\u624b\u9806\u81ea\u4f53\u306f\u300c3.3. S-Type\u306e\u30bd\u30fc\u30c8\u300d\u3068\u540c\u3058\u3067\u3059\u3002\n\u4f8b\n\n\u51e6\u7406\u306f3.3\u3068\u5168\u3066\u540c\u3058\u3067\u3042\u308b\u305f\u3081\u7701\u7565\u3057\u307e\u3059\u3002\u7d50\u679c\u306f\u6b21\u306e\u3068\u304a\u308a\u3067\u3059\u3002\n\n\n\ni\n0\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n\n\n\n\u5148\u982d\u6587\u5b57\u306e\u7bc4\u56f2\n$\na\nb\nc\nd\n\n\nSA[i]\n15\n0\n13\n1\n3\n10\n6\n14\n2\n4\n11\n7\n5\n12\n9\n8\n\n\n pre(S, SA[i])  \uff08LMS-Prefix\uff09\n$    \naaba \nab$  \naba  \nabca \nabca \nabdda\nb$   \nba   \nbca  \nbca  \ncdda \nca   \nca   \nda   \ndda  \n\n\n3.3\u306e\u7d50\u679c\u3068\u6bd4\u3079\u308b\u3068SA[9]=4\u3068SA[10]=11\u3001SA[4]=3\u3068SA[5]=10\u304c\u5165\u308c\u66ff\u308f\u3063\u3066\u3044\u307e\u3059\u3002\n\u3053\u306e\u3088\u3046\u306b\u63a5\u5c3e\u8f9e\u306e\u6587\u5b57\u5217\u9806\u3067\u306f\u3001\u4e00\u90e8\u304c\u30bd\u30fc\u30c8\u3067\u304d\u3066\u3044\u306a\u3044\u72b6\u614b\u3067\u3059\u3002\n\u3057\u304b\u3057\u3001\u4e00\u65b9\u3067LMS-Prefix\u306e\u6587\u5b57\u5217\u9806\u3067\u306f\u30bd\u30fc\u30c8\u3057\u305f\u72b6\u614b\u306b\u306a\u3063\u3066\u3044\u307e\u3059\u3002\n\n\n1.4. LMS-Prefix\u306e\u914d\u5217\u304b\u3089LMS\u90e8\u5206\u6587\u5b57\u5217\u306e\u62bd\u51fa\nLMS\u90e8\u5206\u6587\u5b57\u5217\u4ee5\u5916\u306e\u5024\u306f\u4e0d\u8981\u3067\u3059\u3002LMS\u90e8\u5206\u6587\u5b57\u5217\u306f\u3001LMS-Type\u304b\u3089\u958b\u59cb\u3059\u308bLMS-Prefix\u3068\u4e00\u81f4\u3059\u308b\u305f\u3081\u3001\u305d\u306e\u5024\u306e\u307f\u6b8b\u3057\u307e\u3059\u3002\n\u4f8b\n\nLMS-Type\u306e\u958b\u59cb\u4f4d\u7f6e\u306f3, 6, 10, 13, 15\u3067\u3042\u308b\u305f\u3081\u3001\u305d\u306e\u90e8\u5206\u306e\u307f\u304c\u6b8b\u3059\u3088\u3046\u306b\u3057\u307e\u3059\u3002\n\n\nSA[i] (LMS\u90e8\u5206\u6587\u5b57\u5217\u306e\u958b\u59cb\u4f4d\u7f6e)\n15\n13\n3\n10\n6\n\n\n pre(S, SA[i]) (LMS-Prefix)\n$    \nab$  \nabca \nabca \nabdda\n\n\n\u3053\u306e\u62bd\u51fa\u306b\u3088\u3063\u3066\u3001\u30bd\u30fc\u30c8\u3057\u305fLMS\u90e8\u5206\u6587\u5b57\u5217\u306e\u914d\u5217\u304c\u4f5c\u6210\u3067\u304d\u307e\u3057\u305f\u3002\n\n\n\n2. LMS-Type\u306e\u63a5\u5c3e\u8f9e\u306e\u30bd\u30fc\u30c8\n\u3053\u3053\u3067\u306f\u3001\u30bd\u30fc\u30c8\u6e08\u307f\u306eLMS\u90e8\u5206\u6587\u5b57\u5217\u3092\u4f7f\u7528\u3057\u3066\u3001LMS-Type\u306e\u307f\u306e\u63a5\u5c3e\u8f9e\u914d\u5217\u3092\u69cb\u7bc9\u3057\u307e\u3059\u3002\u5b9f\u65bd\u624b\u9806\u306f\u4e0b\u8a18\u306e2\u3064\u3067\u3059\u3002\n\n2.1. LMS\u90e8\u5206\u6587\u5b57\u5217\u306b\u9806\u5e8f\u756a\u53f7\u4ed8\u4e0e\u3068\u91cd\u8907\u30c1\u30a7\u30c3\u30af\n2.2. \u9806\u5e8f\u756a\u53f7\u306e\u63a5\u5c3e\u8f9e\u914d\u5217\u3092\u6c42\u3081\u308b\uff08\u518d\u5e30\u547c\u3073\u51fa\u3057\uff09\n\n\u3053\u306e\u3046\u3061\u30012.1\u306e\u91cd\u8907\u30c1\u30a7\u30c3\u30af\u3067\u3059\u3079\u3066\u306eLMS\u90e8\u5206\u6587\u5b57\u5217\u304c\u91cd\u8907\u3057\u306a\u3044\u306a\u3089\u3070\u3001LMS\u90e8\u5206\u6587\u5b57\u5217\u306e\u958b\u59cb\u4f4d\u7f6e\u3068LMS-Type\u306e\u63a5\u5c3e\u8f9e\u914d\u5217\u304c\u4e00\u81f4\u3059\u308b\u305f\u3081\u30012.2\u306e\u51e6\u7406\u306f\u4e0d\u8981\u3068\u306a\u308a\u307e\u3059\u3002\n\n2.1 LMS\u90e8\u5206\u6587\u5b57\u5217\u306b\u9806\u5e8f\u756a\u53f7\u4ed8\u4e0e\u3068\u91cd\u8907\u30c1\u30a7\u30c3\u30af\n\u9806\u5e8f\u756a\u53f7(name)\u3068\u306f\u3001LMS\u90e8\u5206\u6587\u5b57\u5217\u306e\u6587\u5b57\u5217\u9806\u306b\u63a1\u756a\u3057\u305f\u5024\u3067\u3059\u3002\u305f\u3060\u3057\u3001LMS\u90e8\u5206\u6587\u5b57\u5217\u304c\u540c\u3058\u5024\u306e\u5834\u5408\u306f\u540c\u3058\u756a\u53f7\u3068\u3057\u307e\u3059\u3002\u63a1\u756a\u3057\u305f\u9806\u5e8f\u756a\u53f7\u306f\u3001LMS\u90e8\u5206\u6587\u5b57\u5217\u306e\u958b\u59cb\u4f4d\u7f6e\u9806\u306b\u306a\u308b\u3088\u3046\u306b\u683c\u7d0d\u3057\u307e\u3059\u3002\n// LMSSubstrings\u306f\u3001LMS\u90e8\u5206\u6587\u5b57\u5217\u306e\u958b\u59cb\u4f4d\u7f6e\u3092\u683c\u7d0d\u3057\u305f\u914d\u5217\n// Names\u306f\u9806\u5e8f\u756a\u53f7\u3092\u683c\u7d0d\u3059\u308b\u914d\u5217\nname := 0\nNames[LMSSubstring[0]/2] = name\nfor i := 1; i < len(LMSSubstrings); i++  {\n    if LMSSubstrings[i-1]\u3068 LMSSubstrings[i] \u306eLMS\u90e8\u5206\u6587\u5b57\u5217\u304c\u4e0d\u4e00\u81f4 {\n        name++\n    }\n\n    // LMS\u90e8\u5206\u6587\u5b57\u5217\u306e\u958b\u59cb\u4f4d\u7f6e\u9806\u306b\u9806\u5e8f\u756a\u53f7\u3092\u683c\u7d0d\n    Names[LMSSubstrings[i]/2] = name\n}\n\n// Names\u306e\u672a\u8a2d\u5b9a\u90e8\u5206\u306f\u53d6\u308a\u9664\u304f\n\n\u3053\u306e\u3068\u304d\u3001\u9806\u5e8f\u756a\u53f7\u3092\u683c\u7d0d\u3059\u308b\u914d\u5217(Names)\u306e\u9577\u3055\u306f\u3001\u5143\u306e\u6587\u5b57\u5217\u306e1/2\u3067\u8db3\u308a\u307e\u3059\uff08\u9577\u3055\u304c\u6700\u5927\u306b\u306a\u308b\u5834\u5408\u306f\u3001L-Type\u3068S-Type\u304c\u4ea4\u4e92\u306b\u51fa\u73fe\u3059\u308b\u6587\u5b57\u5217\u306e\u305f\u3081\uff09\u3002\u5143\u306e\u6587\u5b57\u5217\u3088\u308a\u9577\u3055\u304c\u5c0f\u3055\u304f\u306a\u308b\u305f\u3081\u30012.2\u3067\u518d\u5e30\u547c\u3073\u51fa\u3057\u3092\u884c\u3063\u3066\u3082\u3044\u305a\u308c\u505c\u6b62\u3057\u307e\u3059\u3002\n\u4f8b\n\n\u307e\u305a\u30bd\u30fc\u30c8\u6e08\u307f\u306eLMS\u90e8\u5206\u6587\u5b57\u5217\u306b\u5bfe\u3057\u3066\u9806\u5e8f\u756a\u53f7\u3092\u63a1\u756a\u3057\u307e\u3059\u3002\n\n\n\nLMS\u90e8\u5206\u6587\u5b57\u5217\u306e\u958b\u59cb\u4f4d\u7f6e\n15\n13\n3\n10\n6\n\n\n\n\nLMS\u90e8\u5206\u6587\u5b57\u5217\n$\nab$\nabca\nabca\nabdda\n\n\n\u9806\u5e8f\u756a\u53f7\n0\n1\n2\n2\n3\n\n\n\n\"abca\"\u306f\u540c\u3058\u6587\u5b57\u5217\u30672\u56de\u767b\u5834\u3057\u3066\u3044\u308b\u305f\u3081\u3001\u540c\u3058\u9806\u5e8f\u756a\u53f7\u304c\u5272\u308a\u5f53\u305f\u308a\u307e\u3059\u3002\u3082\u3057\u3059\u3079\u3066\u3066\u7570\u306a\u308b\u9806\u5e8f\u756a\u53f7\u304c\u5272\u308a\u5f53\u305f\u308c\u3070\u300c3. S-Type\u3001L-Type\u306e\u63a5\u5c3e\u8f9e\u306e\u30bd\u30fc\u30c8\u300d\u306b\u9032\u307f\u307e\u3059\u3002\n\u6b21\u306b\u9806\u5e8f\u756a\u53f7\u3092LMS\u90e8\u5206\u6587\u5b57\u5217\u306e\u958b\u59cb\u4f4d\u7f6e\u9806\u306b\u4e26\u3073\u66ff\u3048\u307e\u3059\u3002\n\n\n\nLMS\u90e8\u5206\u6587\u5b57\u5217\u306e\u958b\u59cb\u4f4d\u7f6e\n3\n6\n10\n13\n15\n\n\n\n\nLMS\u90e8\u5206\u6587\u5b57\u5217\nabca\nabdda\nabca\nab$\n$\n\n\n\u9806\u5e8f\u756a\u53f7\n2\n3\n2\n1\n0\n\n\n\n\u3053\u306e\u51e6\u7406\u306b\u3088\u3063\u3066\u9806\u5e8f\u756a\u53f7\u306e\u914d\u5217[2, 3, 2, 1, 0]\u304c\u53d6\u5f97\u3067\u304d\u307e\u3059\u3002\u9806\u5e8f\u756a\u53f7\u306e\u914d\u5217[2, 3, 2, 1, 0]\u306e\u63a5\u5c3e\u8f9e\u306f\u3001\u6b21\u306e\u3088\u3046\u306bLMS-Type\u306e\u63a5\u5c3e\u8f9e\u3068\u5bfe\u5fdc\u3057\u3066\u3044\u307e\u3059\u3002\n\n\n\nNo\n\u9806\u5e8f\u756a\u53f7\u306e\u914d\u5217\u306e\u63a5\u5c3e\u8f9e\nLMS-Type\u306e\u63a5\u5c3e\u8f9e\nLMS-Type\u306e\u63a5\u5c3e\u8f9e\u306e\u958b\u59cb\u4f4d\u7f6e\n\n\n\n\n0\n[2,3,2,1,0]\nabcabddabcab$\n3\n\n\n1\n[3,2,1,0]\nabddabcab$\n6\n\n\n2\n[2,1,0]\nabcab$\n10\n\n\n3\n[1,0]\nab$\n13\n\n\n4\n[0]\n$\n15\n\n\n\n\n\n2.2. \u9806\u5e8f\u756a\u53f7\u306e\u63a5\u5c3e\u8f9e\u914d\u5217\u3092\u53d6\u5f97\uff08\u518d\u5e30\u547c\u3073\u51fa\u3057\uff09\n\u9806\u5e8f\u756a\u53f7\u306e\u914d\u5217\uff08Names\uff09\u306e\u63a5\u5c3e\u8f9e\u914d\u5217\u306f\u3001LMS-Type\u306e\u63a5\u5c3e\u8f9e\u914d\u5217\u306e\u9806\u5e8f\u3068\u4e00\u81f4\u3057\u307e\u3059\u3002LMS-Type\u306e\u63a5\u5c3e\u8f9e\u914d\u5217\u306f\u3001SAIS\u5168\u4f53\u306e\u518d\u5e30\u547c\u3073\u51fa\u3057\u306b\u3088\u3063\u3066\u53d6\u5f97\u3057\u307e\u3059\u3002\n\u4f8b\n\n\u9806\u5e8f\u756a\u53f7\u306e\u914d\u5217[2, 3, 2, 1, 0]\u306e\u63a5\u5c3e\u8f9e\u914d\u5217\u306f[4, 3, 2, 0, 1]\u3067\u3059\u3002\u5bfe\u5fdc\u3059\u308bLMS-Type\u306e\u63a5\u5c3e\u8f9e\u306f\u6b21\u306e\u3068\u304a\u308a\u3067\u3059\u3002\n\n\n\nNo\n\u9806\u5e8f\u756a\u53f7\u306e\u914d\u5217\u306e\u63a5\u5c3e\u8f9e\nLMS-Type\u306e\u63a5\u5c3e\u8f9e\nLMS-Type\u306e\u63a5\u5c3e\u8f9e\u306e\u958b\u59cb\u4f4d\u7f6e\n\n\n\n\n4\n[0]\n$\n15\n\n\n3\n[1,0]\nab$\n13\n\n\n2\n[2,1,0]\nabcab$\n10\n\n\n0\n[2,3,2,1,0]\nabcabddabcab$\n3\n\n\n1\n[3,2,1,0]\nabddabcab$\n6\n\n\n\n\u5bfe\u5fdc\u3059\u308bLMS-Type\u306e\u63a5\u5c3e\u8f9e\u304c\u6587\u5b57\u5217\u9806\u306b\u30bd\u30fc\u30c8\u3055\u308c\u307e\u3059\u3002\u3053\u306e\u8868\u306e\u300cLMS-Type\u306e\u63a5\u5c3e\u8f9e\u306e\u958b\u59cb\u4f4d\u7f6e\u300d\u304cLMS-Type\u306e\u63a5\u5c3e\u8f9e\u914d\u5217\uff08\u300c3. S-Type\u3001L-Type\u306e\u63a5\u5c3e\u8f9e\u306e\u30bd\u30fc\u30c8\u300d\u306e\u914d\u5217LMSSA\uff09\u306b\u306a\u308a\u307e\u3059\u3002\n\n\n\n\u307e\u3068\u3081\n\u63a5\u5c3e\u8f9e\u914d\u5217\u3092\u69cb\u7bc9\u3059\u308bSA-IS\u306e\u624b\u9806\u306b\u3064\u3044\u3066\u8aac\u660e\u3057\u307e\u3057\u305f\u3002\u300c1. LMS\u90e8\u5206\u6587\u5b57\u5217\u306e\u30bd\u30fc\u30c8\u300d\u3068\u300c3. S-Type\u3001L-Type\u306e\u63a5\u5c3e\u8f9e\u306e\u30bd\u30fc\u30c8\u300d\u3067\u306f\u3001\u7d50\u679c\u3092\u683c\u7d0d\u3059\u308bSA\u306e\u9818\u57df\u3092\u4f7f\u7528\u3057\u3066\u7701\u30e1\u30e2\u30ea\u5316\u3057\u3066\u3044\u308b\u69d8\u5b50\u304c\u898b\u3048\u305f\u3068\u601d\u3044\u307e\u3059\u3002SA-IS\u306f\u65e5\u672c\u8a9e\u306e\u8aac\u660e\u3082\u591a\u3044\u305f\u3081\u3001\u3053\u3061\u3089\u306e\u5185\u5bb9\u3067\u306f\u3044\u307e\u3044\u3061\u3060\u3063\u305f\u65b9\u306f\u53c2\u8003URL\u3092\u3054\u53c2\u7167\u304f\u3060\u3055\u3044\u3002\n\n\u53c2\u8003URL\n\nsais(https://sites.google.com/site/yuta256/sais)\n\u63a5\u5c3e\u8f9e\u914d\u5217\u69cb\u7bc9\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u306e Java 7 \u306b\u3088\u308b\u5b9f\u88c5\nSA-IS - Shogo Computing Laboratory\nSAIS(Suffix Array - Induced Sorting) - EchizenBlog-Zwei\nSA-IS: SuffixArray\u7dda\u5f62\u69cb\u7bc9 - sile\u306e\u30d6\u30ed\u30b0\n\u30d3\u30fc\u30e0\u306e\u5831\u544a\u66f8: Suffix Array \u3092\u4f5c\u308b - SA-IS \u306e\u5b9f\u88c5\nSA-IS - (iwi) \uff5b \u53cd\u7701\u3057\u307e\u3059 - TopCoder\u90e8\n\u63a5\u5c3e\u8f9e\u914d\u5217(Suffix Array)\u306e\u52b9\u7387\u7684\u306a\u5b9f\u88c5\u624b\u6cd5\u306b\u3064\u3044\u3066 - xxxxxeeeee\u306e\u65e5\u8a18\n\u9ad8\u901f\u6587\u5b57\u5217\u89e3\u6790\u306e\u4e16\u754c\n\n\n\nGo\u8a00\u8a9e\u5165\u9580\n\nGo\u8a00\u8a9e\u5165\u9580\u3068\u3044\u3046\u30bf\u30a4\u30c8\u30eb\u306e\u672c\u3092\u57f7\u7b46\u3057\u307e\u3057\u305f\u3002\u305d\u306e\u540d\u306e\u901a\u308aGo\u8a00\u8a9e\u306e\u5165\u9580\u66f8\u3067\u3059\u3002\u5f8c\u534a\u306fRaspberry Pi\u3092\u4f7f\u3063\u305fLED\u3092\u70b9\u6ec5\u3084\u6e29\u5ea6\u30c7\u30fc\u30bf\u306e\u53ce\u96c6\u306a\u3069\u3082\u8a18\u8f09\u3057\u3066\u3044\u307e\u3059\u3002go-sais\u306e\u5b9f\u88c5\u306e\u6587\u6cd5\u90e8\u5206\u306f\u3001\u3053\u306e\u5165\u9580\u66f8\u306e\u5185\u5bb9\u3067\u7406\u89e3\u3067\u304d\u308b\u3068\u601d\u3044\u307e\u3059\uff08\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u81ea\u4f53\u306e\u7406\u89e3\u306f\u307e\u305f\u5225\u306b\u5fc5\u8981\u3067\u3059\u304c\u3002\u3002\uff09\nGo\u8a00\u8a9e\u3067SA-IS\uff08Suffix Array - Induced Sorting)\u3092\u5b9f\u88c5\u3057\u307e\u3057\u305f\u3002SA-IS\u306f[\u63a5\u5c3e\u8f9e\u914d\u5217\uff08Suffix Array\uff09](https://ja.wikipedia.org/wiki/%E6%8E%A5%E5%B0%BE%E8%BE%9E%E9%85%8D%E5%88%97)\u306e\u69cb\u7bc9\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u3067\u3059\u3002\u672c\u8a18\u4e8b\u306e\u5185\u5bb9\u306f\u6b21\u306e3\u672c\u306b\u306a\u308a\u307e\u3059\u3002\n\n* [Go\u8a00\u8a9e\u3067\u5b9f\u88c5\u3057\u305fSA-IS(go-sais)](https://github.com/tobi-c/go-sais)\u306b\u3064\u3044\u3066\u7d39\u4ecb\u3057\u307e\u3059\n* SA-IS\u306e\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u306b\u3064\u3044\u3066\u89e3\u8aac\u3057\u307e\u3059\n* [Go\u8a00\u8a9e\u306e\u5165\u9580\u66f8](https://www.amazon.co.jp/dp/4865940413)\u3092\u57f7\u7b46\u3057\u307e\u3057\u305f\n\n\n---\n# Go\u8a00\u8a9e\u306eSA-IS\u5b9f\u88c5\nGo\u8a00\u8a9e\u306e\u6a19\u6e96\u30d1\u30c3\u30b1\u30fc\u30b8\u306b\u306f\u3001\u65e2\u306b\u63a5\u5c3e\u8f9e\u914d\u5217\u306e\u5b9f\u88c5(index/suffixarray)\u304c\u5b58\u5728\u3057\u307e\u3059\u3002\u6a19\u6e96\u30d1\u30c3\u30b1\u30fc\u30b8\u306e\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u3092\u898b\u305f\u3068\u3053\u308dLarsson-Sadakane\u6cd5(qsufsort)\u3067\u3042\u3063\u305f\u305f\u3081\u3001\u3088\u308a\u9ad8\u901f\u3068\u8a00\u308f\u308c\u3066\u3044\u308bSA-IS\u3092\u5b9f\u88c5\u3057\u307e\u3057\u305f\u3002\n\nhttps://github.com/tobi-c/go-sais\n\n## \u5b9f\u88c5\u5185\u5bb9\nSA-IS\u306f\u63a5\u5c3e\u8f9e\u914d\u5217\u306e\u69cb\u7bc9\u90e8\u5206\u306e\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u3067\u3059\u3002\u305d\u306e\u305f\u3081\u3001\u69cb\u7bc9\u90e8\u5206\u306e\u5b9f\u88c5\u306e\u307f\u6a19\u6e96\u30d1\u30c3\u30b1\u30fc\u30b8\u304b\u3089\u7f6e\u304d\u63db\u3048\u3066\u3044\u307e\u3059\u3002\u63a5\u5c3e\u8f9e\u914d\u5217\u3092\u4f7f\u7528\u3057\u305f\u691c\u7d22\u90e8\u5206\u3084\u30c6\u30b9\u30c8\u306a\u3069\u306f\u6a19\u6e96\u30d1\u30c3\u30b1\u30fc\u30b8\u306e\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u304b\u3089\u30b3\u30d4\u30fc\u3057\u307e\u3057\u305f\u3002\n\n##\u30d9\u30f3\u30c1\u30de\u30fc\u30af\n\u4e0b\u8a18\u30b3\u30de\u30f3\u30c9\u3067go-sais\u3068\u6a19\u6e96\u30d1\u30c3\u30b1\u30fc\u30b8\u306e\u30d9\u30f3\u30c1\u30de\u30fc\u30af\u3092\u53d6\u5f97\u3057\u307e\u3057\u305f\u3002\n\n```\n$ go test -bench . github.com/tobi-c/go-sais/suffixarray\n\n$ go test -bench . index/suffixarray\n```\n\n\u53d6\u5f97\u7d50\u679c\u306f\u4e0b\u8a18\u306e\u8868\u306e\u3068\u304a\u308a\u3067\u3059\u3002\n\n|   |NewIndexRandom|NewIndexRepeat|SaveRestore|\n|---|--:|--:|--:|\n|go-sais/suffixarray| 778500400 ns/op | 162400650 ns/op|45003666 ns/op |\n|index/suffixarray<br>(\u6a19\u6e96\u30d1\u30c3\u30b1\u30fc\u30b8)    | 1448997500 ns/op| 2484993800 ns/op | 45519330 ns/op|\n\nNewIndexRandam\u306f\u30e9\u30f3\u30c0\u30e0\u306e\u6587\u5b57\u5217\u306b\u5bfe\u3057\u3066\u63a5\u5c3e\u8f9e\u914d\u5217\u3092\u69cb\u7bc9\u3057\u3066\u3044\u307e\u3059\u3002\ngo-sais\u306f\u3001\u6a19\u6e96\u30d1\u30c3\u30b1\u30fc\u30b8\u3068\u6bd4\u3079\u3066\u7d04\u534a\u5206(53%)\u306e\u6642\u9593\u3067\u5b9f\u884c\u3067\u304d\u307e\u3057\u305f\u3002\n\nNewIndexRepeat\u306f\u7e70\u308a\u8fd4\u3057\u304c\u7d9a\u304f\u6587\u5b57\u5217\u306b\u5bfe\u3057\u3066\u63a5\u5c3e\u8f9e\u914d\u5217\u3092\u69cb\u7bc9\u3057\u3066\u3044\u307e\u3059\u3002\ngo-sais\u306f\u3001\u6a19\u6e96\u30d1\u30c3\u30b1\u30fc\u30b8\u3068\u6bd4\u3079\u3066\u7d041/17(5.8%)\u306e\u6642\u9593\u3067\u5b9f\u884c\u3067\u304d\u307e\u3057\u305f\u3002\n\nSaveRestore\u306f\u3001\u63a5\u5c3e\u8f9e\u914d\u5217\u306e\u66f8\u8fbc\u307f\u3068\u8aad\u8fbc\u307f\u306e\u51e6\u7406\u3067\u3059\u3002\n\u305d\u306e\u90e8\u5206\u306e\u5b9f\u88c5\u306b\u5dee\u304c\u306a\u3044\u305f\u3081\u3001\u307b\u307c\u540c\u7b49\u306a\u5b9f\u884c\u6642\u9593\u3067\u3059\u3002\n\n\u30d9\u30f3\u30c1\u30de\u30fc\u30af\u3067\u4f7f\u7528\u3059\u308b\u6587\u5b57\u5217\u304c\u30e9\u30f3\u30c0\u30e0\u306e\u305f\u3081\u3001\u5927\u96d1\u628a\u306a\u6307\u6a19\u3067\u3059\u304c\u305d\u308c\u306a\u308a\u306b\u9ad8\u901f\u5316\u3055\u308c\u307e\u3057\u305f\u3002\u7279\u306b\u7e70\u308a\u8fd4\u3057\u304c\u7d9a\u304f\u6587\u5b57\u5217\u3067\u306f\u3001\u6a19\u6e96\u30d1\u30c3\u30b1\u30fc\u30b8\u306e\u5b9f\u88c5\u306b\u6bd4\u3079\u3066\u5927\u5e45\u306b\u6642\u9593\u304c\u77ed\u7e2e\u3067\u304d\u307e\u3057\u305f\u3002\uff08\u7e70\u308a\u8fd4\u3057\u304c\u7d9a\u304f\u6587\u5b57\u5217\u306fSA-IS\u306b\u3068\u3063\u3066\u90fd\u5408\u306e\u3088\u3044\u30c7\u30fc\u30bf\u306e\u3088\u3046\u3067\u3059\uff09\n\n\n---\n\n# SA-IS\u306e\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\n\u3053\u3053\u304b\u3089\u306fSA-IS\u306e\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u306e\u89e3\u8aac\u3067\u3059\u3002\u307e\u305a\u306f\u63a5\u5c3e\u8f9e\u914d\u5217\u306a\u3069\u306e\u5404\u7a2e\u5b9a\u7fa9\u306b\u3064\u3044\u3066\u8a18\u8f09\u3057\u3001\u305d\u306e\u5f8c\u306b\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u306e\u624b\u9806\u306b\u3064\u3044\u3066\u8aac\u660e\u3057\u307e\u3059\u3002\n\n\u3082\u3057\u53b3\u5bc6\u306a\u8a71\u3092\u77e5\u308a\u305f\u3044\u5834\u5408\u306f\u4e0b\u8a18\u8ad6\u6587\u3092\u3054\u53c2\u7167\u304f\u3060\u3055\u3044\u3002C\u8a00\u8a9e\u306e\u5b9f\u88c5\u3082\u8f09\u3063\u3066\u3044\u307e\u3059\u3002\n[(pdf)Two Efficient Algorithms for Linear Suffix Array Construction. Ge Nong, Sen Zhang and Wai Hong Chan](https://storage.googleapis.com/google-code-archive-downloads/v2/code.google.com/ge-nong/Two%20Efficient%20Algorithms%20for%20Linear%20Time%20Suffix%20Array%20Construction.pdf)\n\n## \u63a5\u5c3e\u8f9e\u914d\u5217\u306a\u3069\u306e\u5b9a\u7fa9\n\u63a5\u5c3e\u8f9e\u3001\u63a5\u5c3e\u8f9e\u914d\u5217\u306e\u5b9a\u7fa9\u3084SA-IS\u3067\u4f7f\u7528\u3059\u308bType\u5206\u3051\u3001LSM\u90e8\u5206\u6587\u5b57\u5217\u3001LMS-Prefix\u306b\u3064\u3044\u3066\u8aac\u660e\u3057\u307e\u3059\n\n### \u63a5\u5c3e\u8f9e\n\u63a5\u5c3e\u8f9e\uff08Suffix\uff09\u3068\u306f\u3001\u5bfe\u8c61\u6587\u5b57\u5217\u306e\u5404\u4f4d\u7f6e\u3092\u958b\u59cb\u4f4d\u7f6e\u3068\u3057\u3066\u3001\u305d\u306e\u958b\u59cb\u4f4d\u7f6e\u304b\u3089\u672b\u5c3e\u307e\u3067\u306e\u90e8\u5206\u6587\u5b57\u5217\u306e\u3053\u3068\u3067\u3059\u3002\u3053\u3053\u3067\u306fsuf(\u6587\u5b57\u5217, \u958b\u59cb\u4f4d\u7f6e)\u3068\u8a18\u8ff0\u3057\u307e\u3059\u3002\n\n\u305f\u3068\u3048\u3070\u6587\u5b57\u5217\"base\"\u306e\u63a5\u5c3e\u8f9e\u306f\u6b21\u306e4\u3064\u3067\u3059\u3002\n\n\tsuf(\"base\", 0) = \"base\"\n\tsuf(\"base\", 1) =  \"ase\"\n\tsuf(\"base\", 2) =   \"se\"\n\tsuf(\"base\", 3) =    \"e\"\n\n\u3053\u306e\u3088\u3046\u306b\u63a5\u5c3e\u8f9e\u306e\u6570\u306f\u3001\u5bfe\u8c61\u3068\u306a\u308b\u6587\u5b57\u5217\u306e\u6587\u5b57\u6570\u3060\u3051\u5b58\u5728\u3057\u307e\u3059\uff08\u4e0a\u8a18\u306e\u4f8b\u3060\u3068\u6587\u5b57\u5217\u306e\u9577\u3055\u304c4\u306e\u305f\u3081\u3001\u63a5\u5c3e\u8f9e\u30824\u3064\uff09\u3002\n\n---\n### \u63a5\u5c3e\u8f9e\u914d\u5217\n[\u63a5\u5c3e\u8f9e\u914d\u5217\uff08Suffix Array\uff09](https://ja.wikipedia.org/wiki/%E6%8E%A5%E5%B0%BE%E8%BE%9E%E9%85%8D%E5%88%97)\u3068\u306f\u3001\u5bfe\u8c61\u6587\u5b57\u5217\u306e\u63a5\u5c3e\u8f9e\u3092\u6587\u5b57\u5217\u9806\u3067\u30bd\u30fc\u30c8\u3057\u3001\u305d\u306e\u958b\u59cb\u4f4d\u7f6e\u3092\u683c\u7d0d\u3057\u305f\u914d\u5217\u3067\u3059\u3002\u5148\u307b\u3069\u306e\u6587\u5b57\u5217\"base\"\u306e\u63a5\u5c3e\u8f9e\u914d\u5217\u306f\u6b21\u306e\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\n\n|\u63a5\u5c3e\u8f9e                  |\u63a5\u5c3e\u8f9e\u914d\u5217  |\n|------------------------|------------|\n|suf(\"base\", 1) = \"ase\"  | 1          |\n|suf(\"base\", 0) = \"base\" | 0          |\n|suf(\"base\", 3) = \"e\"    | 3          |\n|suf(\"base\", 2) = \"se\"   | 2          |\n\n\u3053\u306e\u4f8b\u306e\u5834\u5408\u3001\u3044\u305a\u308c\u3082\u5148\u982d\u6587\u5b57\u304c\u7570\u306a\u308b\u305f\u3081\u3001\u305d\u306e\u5148\u982d\u6587\u5b57\u306e\u307f\u3067\u30bd\u30fc\u30c8\u3067\u304d\u307e\u3059\u3002\"ase\"\u304c\u63a5\u5c3e\u8f9e\u914d\u5217\u306e\u6700\u521d\u306e\u8981\u7d20\u306b\u306a\u308a\u3001\u305d\u306e\u5f8c\u306b\"base\", \"e\", \"se\"\u3068\u7d9a\u304d\u307e\u3059\u3002\u63a5\u5c3e\u8f9e\u914d\u5217\u81ea\u4f53\u306b\u683c\u7d0d\u3059\u308b\u306e\u306f\u63a5\u5c3e\u8f9e\u306e\u6587\u5b57\u5217\u305d\u306e\u3082\u306e\u3067\u306f\u306a\u304f\u3001\u5143\u306e\u6587\u5b57\u5217(\"base\")\u306e\u958b\u59cb\u4f4d\u7f6e\u3067\u3059\u3002\u305d\u306e\u305f\u3081\u3001\u4eca\u56de\u306e\u4f8b\u3067\u306f[\"ase\", \"base\", \"e\", \"se\"]\u3067\u306f\u306a\u304f\u3001[1, 0, 3, 2]\u3068\u3044\u3063\u305f\u914d\u5217\u304c\u63a5\u5c3e\u8f9e\u914d\u5217\u306b\u306a\u308a\u307e\u3059\u3002\n\nSA-IS\u306f\u3053\u306e\u63a5\u5c3e\u8f9e\u914d\u5217\u3092\u69cb\u7bc9\u3059\u308b\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u3067\u3059\u3002\n\n---\n### \u756a\u5175($)\n [\u756a\u5175](https://ja.wikipedia.org/wiki/%E7%95%AA%E5%85%B5)\u3068\u306f\u3001\u6587\u5b57\u5217\u306e\u6700\u5f8c\u3092\u8868\u3059\u6587\u5b57\u306e\u3053\u3068\u3067\u3059\u3002\u305f\u3068\u3048\u3070C\u8a00\u8a9e\u306e\u30cc\u30eb\u6587\u5b57(\\0)\u306a\u3069\u304c\u3042\u308a\u307e\u3059\u3002\u63a5\u5c3e\u8f9e\u914d\u5217\u3067\u306f\u3001\u3053\u306e\u756a\u5175\u3092\u63a5\u5c3e\u8f9e\u306e\u9806\u5e8f\u3092\u4e00\u610f\u306b\u3059\u308b\u305f\u3081\u306b\u4ed6\u306e\u3069\u3093\u306a\u6587\u5b57\u3088\u308a\u3082\u5c0f\u3055\u3044\u6587\u5b57\u3068\u3057\u3066\u6271\u3044\u307e\u3059\u3002\u307e\u305f\u3053\u3053\u3067\u306f\u756a\u5175\u3092'\\$'\u3067\u8a18\u8ff0\u3057\u307e\u3059\u3002\n \n\u305f\u3068\u3048\u3070\u6587\u5b57\u5217\"aa\"\u306e\u63a5\u5c3e\u8f9e\u914d\u5217\u3092\u8003\u3048\u308b\u3068\u3001suf(\"aa\", 0) = \"aa\"\u3068suf(\"aa\", 1) = \"a\"\u306e\u3069\u3061\u3089\u304c\u5c0f\u3055\u3044\u304b\u3092\u6c7a\u3081\u306a\u3051\u308c\u3070\u306a\u308a\u307e\u305b\u3093\u3002\u3053\u306e\u3068\u304d\u6587\u5b57\u5217\u306e\u6700\u5f8c\u306f\u5fc5\u305a'\\$'\u3068\u3057\u3066\"aa\\$\"\u306b\u3059\u308c\u3070\u3001suf(\"aa\\$\", 0) = \"aa\\$\"\u3001suf(\"aa\\$\", 1) = \"a\\$\" \u3068\u306a\u308a\u30012\u6587\u5b57\u76ee\u306e\u300c'a' > '\\$'\u300d\u304b\u3089\u300c\"aa\\$\" > \"a\\$\"\u300d\u3068\u5224\u65ad\u3067\u304d\u307e\u3059\u3002\n\n---\n### \u63a5\u5c3e\u8f9e\u306eType (S-Type, L-Type, LMS-Type)\nSA-IS\u3067\u306f\u3001\u5bfe\u8c61\u6587\u5b57\u5217\u306e\u5404\u6587\u5b57\u306b\u5bfe\u3057\u3066\u3001S-Type\u3068L-Type\u3068\u3044\u3063\u305f2\u3064\u306eType\u306b\u533a\u5206\u3051\u3057\u307e\u3059\u3002\u5404\u6587\u5b57\u306eType\u306f\u6b21\u306e\u3068\u304a\u308a\u3067\u3059\u3002\n\n\t\u6587\u5b57\u5217S\u306b\u5bfe\u3057\u3066\n\t  * \u756a\u5175($)\u306fS-Type\n\t  * S[i] < S[i+1]\u306e\u5834\u5408 \uff1a S[i]\u306fS-Type\n\t  * S[i] > S[i+1]\u306e\u5834\u5408 \uff1a S[i]\u306fL-Type\n\t  * S[i] = S[i+1]\u306e\u5834\u5408 \uff1a S[i]\u306fS[i+1]\u3068\u540c\u3058Type\n\t                           (S[i+1]\u304cS-Type\u306a\u3089\u3070\u3001S[i]\u306fS-Type,\n\t                            S[i+1]\u304cL-Type\u306a\u3089\u3070\u3001S[i]\u306fL-Type)\n\n    (S[i]\u306f\u6587\u5b57\u5217S\u306ei\u756a\u76ee\u306e\u6587\u5b57\u3092\u8868\u3059)\n\n\u307e\u305f\u300cS[i-1]\u304cL-Type\u3001\u304b\u3064\u3001S[i]\u304cS-Type\u300d\u306e\u5834\u5408\u3001S[i]\u306e\u3053\u3068\u3092LMS-Type(Leftmost S-Type)\u3068\u547c\u3073\u307e\u3059\u3002\n\n\u4f8b\u3068\u3057\u3066\u6587\u5b57\u5217S=\"aababcabddabcab\\$\"\u306eType\u5206\u3051\u3092\u793a\u3057\u307e\u3059\u3002\n\n|i   |0|1|2|3|4|5|6|7|8|9|10|11|12|13|14|15|\n|:--:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|\n|S   |a|a|b|a|b|c|a|b|d|d|a|b|c|a|b|$| \n|type|S|S|L|S|S|L|S|S|L|L|S|S|L|S|L|S|\n|LMS | | | | * | | | * | | | | * | | | * | | * |\n\n\u7dda\u30b0\u30e9\u30d5\u306b\u3059\u308b\u3068\u3001S-Type\u304c\u53f3\u4e0a\u304c\u308a\u3001L-Type\u304c\u53f3\u4e0b\u304c\u308a\u3001LMS-Type\u304cV\u5b57\u306e\u90e8\u5206\u306b\u8a72\u5f53\u3057\u307e\u3059\u3002\n\n![sais1.png](https://qiita-image-store.s3.amazonaws.com/0/130444/160a9f77-08bf-76d0-d8ae-6be48b0eaf26.png)\n\n\u3053\u306eType\u306f\u3001\u63a5\u5c3e\u8f9e\u306esuf(S, i)\u3068suf(S, i+1)\u306e\u6bd4\u8f03\u306b\u4f7f\u7528\u3067\u304d\u307e\u3059\u3002S[i]\u304cS-Type\u306a\u3089\u3070\u300csuf(S, i) < suf(S, i+1)\u300d\u3001S[i]\u304cL-Type\u306a\u3089\u3070\u300csuf(S, i) > suf(S, i+1)\u300d\u3067\u3059\u3002\u305f\u3068\u3048\u3070\u4e0a\u8a18\u306e\u4f8b\u306eS[8]\u306fL-Type\u3067\u3042\u308b\u305f\u3081\u3001\u300csuf(S, 8) > suf(S, 9)\u300d\u306b\u306a\u308a\u307e\u3059\u3002\u300csuf(S, 8) = \"ddabcab\\$\"\u300d \u3068\u300csuf(S, 9) = \"dabcab\\$\"\u300d\u3092\u78ba\u8a8d\u3057\u3066\u307f\u308b\u3068\u300c\"ddabcab\\$\" > \"dabcab\\$\"\u300d\u3067\u3042\u308a\u3001Type\u5206\u3051\u304c\u793a\u3057\u305f\u7d50\u679c\u901a\u308a\u3067\u3059\u3002\n\nS-Type\u304b\u3089\u958b\u59cb\u3059\u308b\u63a5\u5c3e\u8f9e\u306e\u3053\u3068\u3092\u300cS-Type\u306e\u63a5\u5c3e\u8f9e\u300d\u3068\u547c\u3076\u3053\u3068\u306b\u3057\u307e\u3059\u3002\u540c\u69d8\u306bL-Type\u3001LMS-Type\u304b\u3089\u958b\u59cb\u3059\u308b\u63a5\u5c3e\u8f9e\u306e\u3053\u3068\u3092\u300cL-Type\u306e\u63a5\u5c3e\u8f9e\u300d\u300cLMS-Type\u306e\u63a5\u5c3e\u8f9e\u300d\u3068\u3057\u307e\u3059\u3002\n\n---\n### LMS\u90e8\u5206\u6587\u5b57\u5217\nLMS\u90e8\u5206\u6587\u5b57\u5217\u3068\u306f\u3001LMS-Type\u306e\u4f4d\u7f6e\u3067\u5207\u308a\u51fa\u3057\u305f\u90e8\u5206\u6587\u5b57\u5217\u306e\u3053\u3068\u3067\u3059\u3002\u307e\u305f\u6700\u5f8c\u306e\"\\$\"\u3082LMS\u90e8\u5206\u6587\u5b57\u5217\u306b\u306a\u308a\u307e\u3059\u3002\u305f\u3068\u3048\u3070\u5148\u7a0b\u306e\u4f8b\u306e\u6587\u5b57\u5217S=\"aababcabddabcab\\$\"\u306eLMS\u90e8\u5206\u6587\u5b57\u5217\u306f\u3001\"abca\", \"abdda\", \"abca\",\"ab\\$\",\"\\$\"\u306e5\u3064\u3067\u3059\u3002\u8868\u3067\u66f8\u304f\u3068\u6b21\u306e\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\n\n|i   |0|1|2|3|4|5|6|7|8|9|10|11|12|13|14|15|\n|:--:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|\n|S   |a|a|b|a|b|c|a|b|d|d|a|b|c|a|b|$| \n|type|S|S|L|S|S|L|S|S|L|L|S|S|L|S|L|S|\n|LMS | | | | * | | | * | | | | * | | | * | | * |\n|\"abca\"| | | |a|b|c|a| | | | | | | | | |\n|\"abdda\"| | | | | | |a|b|d|d|a| | | | | |\n|\"abca\"| | | | | | | | | | |a|b|c|a| | |\n|\"ab$\"| | | | | | | | | | | | | |a|b|$|\n|\"$\"| | | | | | | | | | | | | | | |$|\n\n---\n### LMS-Prefix\nLMS-Prefix\u3068\u306f\u3001\u63a5\u5c3e\u8f9e\u3092LMS-Type\u306e\u4f4d\u7f6e\u3067\u5207\u308a\u53d6\u3063\u305f\u90e8\u5206\u6587\u5b57\u5217\u306e\u3053\u3068\u3067\u3059\u3002\n\u5148\u982d\u6587\u5b57\u304cLMS-Type\u306e\u5834\u5408\u3001\u6b21\u306eLMS-Type\u307e\u3067\u304c\u5bfe\u8c61\u3067\u3059\u3002\u307e\u305f\"\\$\"\u3082LMS-Prefix\u306b\u306a\u308a\u307e\u3059\u3002\n\u3053\u3053\u3067\u306fsuf(S, i)\u306eLMS-Prefix\u3092pre(S, i)\u3068\u8a18\u8ff0\u3057\u307e\u3059\u3002\n\n\u305f\u3068\u3048\u3070\u63a5\u5c3e\u8f9esuf(S, 6) = \"abddabcab\\$\"\u306eLMS-Prefix\u306f\u3001S[10]\u306e'a'\u304cLMS-Type\u3067\u3042\u308b\u305f\u3081\u3001pre(S, 6) = \"abdda\"\u306b\u306a\u308a\u307e\u3059\u3002LMS-Prefix\u306e\u4e00\u89a7\u306f\u6b21\u306e\u3068\u304a\u308a\u3067\u3059\u3002\n\n|i          |0  |1  |2  |3  |4  |5  |6  |7  |8  |9  |10 |11 |12 |13 |14 |15 |\n|:---------:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|\n|S[i]       |a  |a  |b  |a  |b  |c  |a  |b  |d  |d  |a  |b  |c  |a  |b  |$  |\n|type       |S  |S  |L  |S  |S  |L  |S  |S  |L  |L  |S  |S  |L  |S  |L  |S  |  \n|LMS        |   |   |   | * |   |   | * |   |   |   | * |   |   | * |   | * | \n|pre(S,0)   |  a|  a|  b|  a|   |   |   |   |   |   |   |   |   |   |   |   |  \n|pre(S,1)   |   |  a|  b|  a|   |   |   |   |   |   |   |   |   |   |   |   | \n|pre(S,2)   |   |   |  b|  a|   |   |   |   |   |   |   |   |   |   |   |   | \n|pre(S,3)   |   |   |   |  <font color=\"blue\">a</font>|  <font color=\"blue\">b</font>|  <font color=\"blue\">c</font>|  <font color=\"blue\">a</font>|   |   |   |   |   |   |   |   |   | \n|pre(S,4)   |   |   |   |   |  b|  c|  a|   |   |   |   |   |   |   |   |   | \n|pre(S,5)   |   |   |   |   |   |  c|  a|   |   |   |   |   |   |   |   |   | \n|pre(S,6)   |   |   |   |   |   |   |  <font color=\"blue\">a</font>|  <font color=\"blue\">b</font>|  <font color=\"blue\">d</font>|  <font color=\"blue\">d</font>|  <font color=\"blue\">a</font>|   |   |   |   |   | \n|pre(S,7)   |   |   |   |   |   |   |   |  b|  d|  d|  a|   |   |   |   |   | \n|pre(S,8)   |   |   |   |   |   |   |   |   |  d|  d|  a|   |   |   |   |   | \n|pre(S,9)   |   |   |   |   |   |   |   |   |   |  d|  a|   |   |   |   |   | \n|pre(S,10)   |   |   |   |   |   |   |   |   |   |   |  <font color=\"blue\">a</font>|  <font color=\"blue\">b</font>|  <font color=\"blue\">c</font>|  <font color=\"blue\">a</font>|   |   | \n|pre(S,11)   |   |   |   |   |   |   |   |   |   |   |   |  b|  c|  a|   |   | \n|pre(S,12)   |   |   |   |   |   |   |   |   |   |   |   |   |  c|  a|   |   | \n|pre(S,13)   |   |   |   |   |   |   |   |   |   |   |   |   |   |  <font color=\"blue\">a</font>| <font color=\"blue\">b</font>|  <font color=\"blue\">$</font>| \n|pre(S,14)   |   |   |   |   |   |   |   |   |   |   |   |   |   |   |  b|  $| \n|pre(S,15)   |   |   |   |   |   |   |   |   |   |   |   |   |   |   |   |  <font color=\"blue\">$</font>| \n\n\n\u5148\u982d\u6587\u5b57\u304cLMS-Type\u3067\u3042\u308bLMS-Prefix\u306f\u3001LMS\u90e8\u5206\u6587\u5b57\u5217\u3068\u4e00\u81f4\u3057\u307e\u3059\u3002\u3053\u306e\u8868\u3067\u306f\u3001pre(S, 3) = \"abca\", pre(S, 6) = \"abdda\", pre(S, 10) = \"abca\", pre(S, 13) = \"ab\\$\", pre(S, 15) = \"\\$\"\u304c\u8a72\u5f53\u3057\u307e\u3059\u3002SA-IS\u3067\u306fLMS\u90e8\u5206\u6587\u5b57\u5217\u3092\u6587\u5b57\u5217\u9806\u3067\u30bd\u30fc\u30c8\u3057\u307e\u3059\u304c\u3001\u305d\u306e\u3068\u304dLMS-Prefix\u3092\u30bd\u30fc\u30c8\u3059\u308b\u3053\u3068\u3067LMS\u90e8\u5206\u6587\u5b57\u5217\u306e\u30bd\u30fc\u30c8\u3092\u5b9f\u73fe\u3057\u307e\u3059\u3002\n\n\n---\n## \u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u306e\u8aac\u660e\nSA-IS\u306f\u63a5\u5c3e\u8f9e\u914d\u5217\u3092\u69cb\u7bc9\u3059\u308b\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u3067\u3059\u3002\u6b21\u306e\u624b\u9806\u3067\u69cb\u7bc9\u3057\u307e\u3059\u3002\n\n\n1. LMS\u90e8\u5206\u6587\u5b57\u5217\u306e\u30bd\u30fc\u30c8\n2. LMS-Type\u306e\u63a5\u5c3e\u8f9e\u306e\u30bd\u30fc\u30c8\n3. S-Type\u3001L-Type\u306e\u63a5\u5c3e\u8f9e\u306e\u30bd\u30fc\u30c8\n\n\u3053\u306e\u3046\u3061\u3001\u300c1. LMS\u90e8\u5206\u6587\u5b57\u5217\u306e\u30bd\u30fc\u30c8\u300d\u3068\u300c3. S-Type\u3001L-Type\u306e\u63a5\u5c3e\u8f9e\u306e\u30bd\u30fc\u30c8\u300d\u306f\u540c\u3058\u3088\u3046\u306a\u64cd\u4f5c\u3067\u5b9f\u73fe\u3057\u3066\u3044\u307e\u3059\u3002\u300c3. \u63a5\u5c3e\u8f9e\u306e\u30bd\u30fc\u30c8\u300d\u306e\u307b\u3046\u304c\u6bd4\u8f03\u7684\u7c21\u5358\u3067\u3042\u308b\u305f\u3081\u3001\u305d\u3061\u3089\u304b\u3089\u8aac\u660e\u3057\u3066\u3044\u304d\u307e\u3059\u3002\n\n\u307e\u305f\u3001\u305d\u308c\u305e\u308c\u306e\u5909\u6570\u306f\u4e0b\u8a18\u306e\u610f\u5473\u306b\u306a\u308a\u307e\u3059\u3002\n\n```\nS  : \u5165\u529b\u3068\u306a\u308b\u6587\u5b57\u5217\u3002\u4f8b\u3067\u306fS=\"aababcabddabcab$\"\u3092\u4f7f\u7528\u3002\nSA : \u7d50\u679c\uff08\u63a5\u5c3e\u8f9e\u914d\u5217\uff09\u3092\u683c\u7d0d\u3059\u308b\u914d\u5217\u3002\u69cb\u7bc9\u9014\u4e2d\u306e\u5024\u3092\u683c\u7d0d\u3059\u308b\u305f\u3081\u306b\u3082\u4f7f\u7528\u3002\u4f8b\u3067\u306f\u9577\u305516\u306e\u914d\u5217\u3002\n```\n\n### 3. S-Type\u3001L-Type\u306e\u63a5\u5c3e\u8f9e\u306e\u30bd\u30fc\u30c8\n\u3053\u306e\u51e6\u7406\u3067\u306f\u524d\u63d0\u3068\u3057\u3066\u3001LMS-Type\u306e\u307f\u306e\u63a5\u5c3e\u8f9e\u914d\u5217\u304c\u69cb\u7bc9\u6e08\u307f\u3068\u3057\u307e\u3059\uff08\u300c2. LMS-Type\u306e\u63a5\u5c3e\u8f9e\u306e\u30bd\u30fc\u30c8\u300d\u304b\u3089\uff09\u3002\u300c3. S-Type\u3001L-Type\u306e\u63a5\u5c3e\u8f9e\u306e\u30bd\u30fc\u30c8\u300d\u306f\u3001\u6b21\u306e3\u3064\u306e\u51e6\u7406\u3067\u5b9f\u65bd\u3057\u307e\u3059\u3002\n\n\n* 3.1. LMS-Type\u306e\u914d\u7f6e\n* 3.2. L-Type\u306e\u30bd\u30fc\u30c8\n* 3.3. S-Type\u306e\u30bd\u30fc\u30c8\n\n\u3053\u308c\u3089\u306e\u51e6\u7406\u306f\u3001\u3044\u308f\u3086\u308b[\u30d0\u30b1\u30c3\u30c8\u30bd\u30fc\u30c8](https://ja.wikipedia.org/wiki/%E3%83%90%E3%82%B1%E3%83%83%E3%83%88%E3%82%BD%E3%83%BC%E3%83%88)\u3092\u8ef8\u306b\u3057\u3066\u5b9f\u884c\u3057\u307e\u3059\u3002\n\n#### 3.1. LMS-Type\u306e\u914d\u7f6e\n  LMS-Type\u306e\u63a5\u5c3e\u8f9e\u914d\u5217\u306f\u69cb\u7bc9\u6e08\u307f\u306e\u305f\u3081\u3001\u305d\u306e\u8981\u7d20\uff08LMS-Type\u306e\u63a5\u5c3e\u8f9e\u306e\u958b\u59cb\u4f4d\u7f6e\uff09\u3092\u914d\u5217SA\u306b\u8a2d\u5b9a\u3057\u307e\u3059\u3002\u3053\u306e\u3068\u304d\u3001SA\u306e\u8a2d\u5b9a\u306f\u6b21\u306e\u3088\u3046\u306b\u884c\u3044\u307e\u3059\u3002\n\n* \u30bd\u30fc\u30c8\u6e08\u307f\u306eLMS-Type\u306e\u9806\u5e8f\u306f\u5d29\u3055\u306a\u3044\n* SA\u306e\u8a2d\u5b9a\u7b87\u6240\u306f\u3001\u5148\u982d\u6587\u5b57\u3054\u3068\u306e\u306b\u533a\u5206\u3051\u3057\u305f\u7bc4\u56f2\u3002\u540c\u3058\u5148\u982d\u6587\u5b57\u3092\u5834\u5408\u306f\u53f3\u8a70\u3081\u3067\u8a2d\u5b9a\n\n\u4e0a\u8a18\u306e\u3088\u3046\u306b\u8a2d\u5b9a\u3059\u308b\u305f\u3081\u3001\u307e\u305a\u5148\u982d\u6587\u5b57\u3054\u3068\u306e\u30d0\u30b1\u30c3\u30c8\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\u30d1\u30b1\u30c3\u30c8\u306b\u683c\u7d0d\u3059\u308b\u5024\u306f\u3001\u6587\u5b57\u306e\u51fa\u73fe\u56de\u6570\u3092\u30ab\u30a6\u30f3\u30c8\u3057\u3001\u305d\u308c\u305e\u308c\u306e\u6587\u5b57\u3067SA\u3092\u533a\u5206\u3051\u3057\u305f\u53f3\u7aef\u306e\u4f4d\u7f6e\u3067\u3059\u3002\u30d0\u30b1\u30c3\u30c8\u8a2d\u5b9a\u306e\u30b3\u30fc\u30c9\u306f\u6b21\u306e\u3068\u304a\u308a\u3067\u3059\uff08\u30b3\u30fc\u30c9\u306fGo\u8a00\u8a9e\u306b\u4f3c\u305f\u7591\u4f3c\u30b3\u30fc\u30c9\u3067\u3059\uff09\n\n```go:\n// bucket\u306fSA\u306e\u8981\u7d20\u306e\u6700\u5927\u5024\u3092\u683c\u7d0d\u3067\u304d\u308b\u914d\u5217\n// (bucket\u306e\u8981\u7d20\u306e\u521d\u671f\u5024\u306f\u5168\u30660\u3068\u3059\u308b\uff09\n\n// SA\u306b\u51fa\u73fe\u3059\u308b\u6587\u5b57\u306e\u30ab\u30a6\u30f3\u30c8\nfor i := 0; i < len(SA); i++ {\n    bucket[S[i]]++\n}\n\n// \u5148\u982d\u6587\u5b57\u306e\u683c\u7d0d\u4f4d\u7f6e\u3092\u6c7a\u3081\u308b(\u53f3\u8a70\u3081\u7528)\nsum := -1\nfor i := 0; i < len(bucket); i++ {\n    sum += bucket[i]\n    bucket[i] += sum\n}\n```\n\n\u6b21\u306b\u3053\u306e\u30d0\u30b1\u30c3\u30c8\u3092\u4f7f\u7528\u3057\u3066\u3001LMS-Type\u306e\u63a5\u5c3e\u8f9e\u914d\u5217\u3092\u672b\u5c3e\u304b\u3089\u5148\u982d\u307e\u3067\u9806\u306b\u51e6\u7406\u3057\u307e\u3059\u3002LMS-Type\u306e\u6587\u5b57\u3067\u30d0\u30b1\u30c3\u30c8\u306e\u5024\u3092\u53d6\u5f97\u3057\u3001\u305d\u306e\u4f4d\u7f6e\u306bLMS-Type\u306e\u300c\u63a5\u5c3e\u8f9e\u306e\u958b\u59cb\u4f4d\u7f6e\uff08\u63a5\u5c3e\u8f9e\u914d\u5217\u306e\u8981\u7d20\uff09\u300d\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002SA\u306b\u8a2d\u5b9a\u5f8c\u3001\u30d0\u30b1\u30c3\u30c8\u306e\u5024\u3092-1\u3057\u3066\u8a2d\u5b9a\u4f4d\u7f6e\u30921\u3064\u624b\u524d\u306b\u79fb\u52d5\u3057\u307e\u3059\u3002\n\n```go:\n// LMSSA\u306f\u300cLMS-Type\u306e\u63a5\u5c3e\u8f9e\u914d\u5217\u300d\nfor k := len(LMSSA) - 1; k >= 0; k-- {\n    i := LMSSA[k]   \u3000\n\tch := S[i]         // LMS-Type\u306e\u5148\u982d\u6587\u5b57\u3092\u53d6\u5f97\n\n\tSA[bucket[ch]] = i // LMS-Type\u306e\u300c\u63a5\u5c3e\u8f9e\u306e\u958b\u59cb\u4f4d\u7f6e\u300d\u3092\u8a2d\u5b9a\n\tbucket[ch]--       // \u30d0\u30b1\u30c3\u30c8\u3092-1\n}\n```\n\n\n**\u4f8b**\n\n> \u6587\u5b57\u5217S=\"aababcabddabcab$\"\u306eLMS-Type\u306e\u958b\u59cb\u4f4d\u7f6e\u306f\u30013, 6, 10, 13, 15\u3067\u3057\u305f\u3002\u305d\u308c\u305e\u308c\u306e\u63a5\u5c3e\u8f9e\u3067\u30bd\u30fc\u30c8\u3059\u308b\u3068\u6b21\u306e\u9806\u5e8f\u306b\u306a\u308a\u307e\u3059\u3002\n>\n> ```\n> suf(S, 15) = \"$\"\n> suf(S, 13) = \"ab$\"\n> suf(S, 10) = \"abcab$\"\n> suf(S,  3) = \"abcabddabcab$\"\n> suf(S,  6) = \"abddabcab$\"\n> ```\n>\n> \u524d\u63d0\u3068\u3057\u3066\u3053\u306e\u9806\u5e8f\u3092\u6301\u3064\u914d\u5217LMSSA=[15,13,10,3,6]\u306f\u69cb\u7bc9\u6e08\u307f\u3068\u3057\u307e\u3059\u3002\n> \u6b21\u306b\u30d0\u30b1\u30c3\u30c8\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n> \n> |   | $ | a | b | c | d |\n> |---|:-:|:-:|:-:|:-:|:-:|\n> |\u6587\u5b57\u306e\u30ab\u30a6\u30f3\u30c8| 1 | 6 | 5 | 2 | 2 |\n> |\u30d0\u30b1\u30c3\u30c8\u306e\u5024| 0 | 6 | 11 | 13 | 15 |\n> |\u5404\u6587\u5b57\u306e\u533a\u5206\u3051| 0 | 1\uff5e6 | 7\uff5e11 | 12\uff5e13 | 14\uff5e15 |\n> \n> \u30d0\u30b1\u30c3\u30c8\u306e\u5024\u306f\u3001\u6587\u5b57\u306e\u30ab\u30a6\u30f3\u30c8\u3092\u5148\u982d\u304b\u3089\u9806\u306b\u7d2f\u7a4d\u3057\u305f\u5024\u304b\u3089-1\u3057\u305f\u3082\u306e\u3067\u3059\u3002\n> \u305f\u3068\u3048\u3070'b'\u306e\u30d0\u30b1\u30c3\u30c8\u306e\u5024\u300c11\u300d\u306f\u3001'\\$','a','b'\u306e\u6587\u5b57\u306e\u30ab\u30a6\u30f3\u30c8\u306e\u7d2f\u8a08-1(1 + 6 + 5 - 1)\u3067\u3059\u3002\n> \u30d0\u30b1\u30c3\u30c8\u306e\u5024\u304b\u3089\u3001\u5404\u6587\u5b57\u306e\u533a\u5206\u3051\u304c\u5224\u65ad\u3067\u304d\u307e\u3059\u3002\n> \u3053\u306e\u30d0\u30b1\u30c3\u30c8\u3068\u914d\u5217LSMSA\u3092\u4f7f\u7528\u3057\u3066\u3001\u6b21\u306e\u3088\u3046\u306bSA\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n> \n> <table>\n>   <thead>\n>     <tr>\n>       <th style=\"text-align: center\">i</th>\n>       <th>0</th>\n>       <th>1</th>\n>       <th>2</th>\n>       <th>3</th>\n>       <th>4</th>\n>       <th>5</th>\n>       <th>6</th>\n>       <th>7</th>\n>       <th>8</th>\n>       <th>9</th>\n>       <th>10</th>\n>       <th>11</th>\n>       <th>12</th>\n>       <th>13</th>\n>       <th>14</th>\n>       <th>15</th>\n>     </tr>\n>   </thead>\n>   <tr>\n>     <td>\u5148\u982d\u6587\u5b57\u306e\u7bc4\u56f2</td>\n>     <td style=\"text-align: center\" colspan=\"1\">$</td>\n>     <td style=\"text-align: center\" colspan=\"6\">a</td>\n>     <td style=\"text-align: center\" colspan=\"5\">b</td>\n>     <td style=\"text-align: center\" colspan=\"2\">c</td>\n>     <td style=\"text-align: center\" colspan=\"2\">d</td>\n>   </tr>\n>   <tr>\n>     <td style=\"text-align: center\">SA[i]</td>\n>     <td>15</td>\n>     <td></td>\n>     <td></td>\n>     <td>13</td>\n>     <td>10</td>\n>     <td>3</td>\n>     <td>6</td>\n>     <td></td>\n>     <td></td>\n>     <td></td>\n>     <td></td>\n>     <td></td>\n>     <td></td>\n>     <td></td>\n>     <td></td>\n>     <td></td>\n>   </tr>\n> </table>\n> \n> \u5148\u982d\u6587\u5b57\u3054\u3068\u306e\u7bc4\u56f2\u306b\u914d\u5217LMSSA\u306e\u5024\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n> SA\u306b\u306f\u672a\u8a2d\u5b9a\u306e\u7b87\u6240\uff08\u7a7a\u6b04\u90e8\u5206\uff09\u304c\u3042\u308a\u307e\u3059\u304c\u3001LMSSA\u306e\u9806\u5e8f\u3092\u5d29\u3057\u3066\u3044\u306a\u3044\u72b6\u614b\u3067\u3059\u3002\n>\n\n\t\n#### 3.2. L-Type\u306e\u30bd\u30fc\u30c8\n3.1\u3067\u8a2d\u5b9a\u3057\u305fLMS-Type\u306e\u4f4d\u7f6e\u3092\u5229\u7528\u3057\u3066\u3001\u3059\u3079\u3066\u306eL-Type\u306e\u300c\u63a5\u5c3e\u8f9e\u306e\u958b\u59cb\u4f4d\u7f6e\u300d\u3092\u914d\u5217SA\u306b\u8a2d\u5b9a\u3057\u307e\u3059\u3002\u624b\u9806\u3068\u3057\u3066\u306f\u3001\u307e\u305aLMS-Type\u306e\u6642\u3068\u540c\u69d8\u306b\u5148\u982d\u6587\u5b57\u3054\u3068\u306e\u30d0\u30b1\u30c3\u30c8\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\u30d0\u30b1\u30c3\u30c8\u306f\u57fa\u672c\u7684\u306b3.1\u306e\u3068\u304d\u3068\u540c\u3058\u3067\u3059\u304c\u5de6\u8a70\u3081\u7528\u3067\u3059\u3002\n\n``` go:\n// bucket\u306fSA\u306e\u8981\u7d20\u306e\u6700\u5927\u5024\u3092\u683c\u7d0d\u3067\u304d\u308b\u914d\u5217\n// (bucket\u306e\u8981\u7d20\u306e\u521d\u671f\u5024\u306f\u5168\u30660\u3068\u3059\u308b\uff09\n\n// SA\u306b\u51fa\u73fe\u3059\u308b\u6587\u5b57\u306e\u30ab\u30a6\u30f3\u30c8\nfor i := 0; i < len(SA); i++ {\n    bucket[S[i]]++\n}\n\n// \u5148\u982d\u6587\u5b57\u306e\u683c\u7d0d\u4f4d\u7f6e\u3092\u6c7a\u3081\u308b(\u5de6\u8a70\u3081\u7528)\nsum := 0\nfor i := 0; i < len(bucket); i++ {\n    b := bucket[i]\n    bucket[i] += sum\n    sum += b\n}\n```\n\n\u6b21\u306b\u3053\u306e\u30d0\u30b1\u30c3\u30c8\u3068LMS-Type\u3092\u8a2d\u5b9a\u3057\u305f\u914d\u5217SA\u3092\u4f7f\u7528\u3057\u3066\u3001L-Type\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002SA\u3092\u5148\u982d\u304b\u3089\u672b\u5c3e\u307e\u3067\u9806\u306b\u51e6\u7406\u3057\u3001SA[i]-1\u304cL-Type\u306a\u3089\u3070\u3001SA[i]-1\u3092SA\u306b\u8a2d\u5b9a\u3057\u307e\u3059\u3002\u3053\u306e\u3068\u304dSA\u306b\u8a2d\u5b9a\u3059\u308b\u4f4d\u7f6e\u306f\u3001\u30d0\u30b1\u30c3\u30c8\u3092\u4f7f\u7528\u3057\u3066\u305d\u306e\u5148\u982d\u6587\u5b57\u306e\u7bc4\u56f2\u306b\u5de6\u8a70\u3081\u3057\u307e\u3059\u3002\n\n```go:\nfor i := 0; i < len(SA); i++ {\n\tif \u300cSA[i]\u306b\u5024\u304c\u3042\u308b\u300d\u304b\u3064\u300cSA[i]-1\u304cL-Type\u300d {\n        ltypeIndex := SA[i]-1\n\t\tch := S[ltypeIndex]         // \u63a5\u5c3e\u8f9e\u306e\u5148\u982d\u6587\u5b57\u3092\u53d6\u5f97 \n\t\tSA[bucket[ch]] = ltypeIndex // L-Type\u306e\u300c\u63a5\u5c3e\u8f9e\u306e\u958b\u59cb\u4f4d\u7f6e\u300d\u3092\u8a2d\u5b9a\n\t    bucket[ch]++                // \u30d0\u30b1\u30c3\u30c8\u3092+1\n\t}\n}\n```\n\n\u3053\u306e\u624b\u9806\u3067\u3059\u3079\u3066\u306eL-Type\u304c\u63a5\u5c3e\u8f9e\u306e\u6587\u5b57\u5217\u9806\u3067SA\u306b\u8a2d\u5b9a\u3055\u308c\u307e\u3059\u3002\u3059\u3079\u3066\u306eL-Type\u3092\u7db2\u7f85\u3067\u304d\u308b\u306e\u306f\u3001\u6b21\u306e\u3088\u3046\u306a\u7406\u7531\u3067\u3059\u3002\n\n* SA[i]\u304cLMS-Type\u306a\u3089\u3070\u3001\u305d\u306e\u5b9a\u7fa9\u304b\u3089SA[i]-1\u306fL-Type\n* SA[i]\u304cL-Type\u304b\u3064SA[i]-1\u304cS-Type\u306a\u3089\u3070\u3001\u6b21\u306bL-Type\u304c\u51fa\u73fe\u3059\u308b\u306e\u306fLMS-Type\u306e\u624b\u524d\n* SA[i]-1\u304cL-Type\u306a\u3089\u3070\u3001suf(S, SA[i]-1) > suf(S, SA[i])\n\n\u307e\u305f\u5de6\u8a70\u3081\u3067\u6587\u5b57\u5217\u9806\u306b\u30bd\u30fc\u30c8\u3067\u304d\u308b\u7406\u7531\u306f\u3001\u4e0a\u8a18\u306b\u52a0\u3048\u3066\u6b21\u306e\u3088\u3046\u306a\u63a5\u5c3e\u8f9e\u306e\u6027\u8cea\u306e\u305f\u3081\u3067\u3059\u3002\n\n* suf(S, SA[i]-1)\u3068suf(S, SA[j]-1)\u304c\u540c\u3058\u5148\u982d\u6587\u5b57\u306a\u3089\u3070\u3001\u305d\u306e\u9806\u5e8f\u306fsuf(S, SA[i])\u3068suf(S, SA[j])\u306e\u9806\u5e8f\u3067\u6c7a\u307e\u308b\n\n\u3053\u308c\u306b\u3088\u3063\u3066\u624b\u524d\u306b\u51fa\u73fe\u3057\u305f\u5024\u3092\u5de6\u8a70\u3081\u3067\u8a2d\u5b9a\u3059\u308c\u3070\u3001\u63a5\u5c3e\u8f9e\u914d\u5217\u306e\u9806\u5e8f\u3069\u304a\u308a\u306b\u306a\u308a\u307e\u3059\u3002\n\n**\u4f8b**\n\n> \u5de6\u8a70\u3081\u7528\u306e\u30d0\u30b1\u30c3\u30c8\u3092\u7528\u610f\u3057\u307e\u3059\u3002\n> \n> |   | $ | a | b | c | d |\n> |---|:-:|:-:|:-:|:-:|:-:|\n> |\u6587\u5b57\u306e\u30ab\u30a6\u30f3\u30c8| 1 | 6 | 5 | 2 | 2 |\n> |\u30d0\u30b1\u30c3\u30c8\u306e\u5024| 0 | 1 | 7 | 12 | 14 |\n> |\u5404\u6587\u5b57\u306e\u533a\u5206\u3051| 0 | 1\uff5e6 | 7\uff5e11 | 12\uff5e13 | 14\uff5e15 |\n> \n> \u30d0\u30b1\u30c3\u30c8\u306e\u5024\u306f\u3001\u6587\u5b57\u306e\u30ab\u30a6\u30f3\u30c8\u3092\u5148\u982d\u304b\u3089\u9806\u306b\u7d2f\u7a4d\u3057\u305f\u5024\u3067\u3059\u3002\u305f\u3060\u3057\u81ea\u8eab\u306e\u30ab\u30a6\u30f3\u30c8\u306f\u9664\u304d\u307e\u3059\u3002\n> \u305f\u3068\u3048\u3070'b'\u306e\u30d0\u30b1\u30c3\u30c8\u306e\u5024\u300c7\u300d\u306f\u3001'\\$','a'\u306e\u6587\u5b57\u306e\u30ab\u30a6\u30f3\u30c8\u306e\u7d2f\u7a4d\u3057\u305f\u6570(1 + 6)\u3067\u3059\u3002\n> \n> \u6b21\u306bL-Type\u306e\u8a2d\u5b9a\u3092SA\u306e\u5148\u982d\u304b\u3089\u9806\u306b\u51e6\u7406\u3057\u307e\u3059\u3002\n> \u300cSA[0] = 15\u300d\u306e\u51e6\u7406\u306f\u300cSA[0]-1 = 14\u300d\u306e\u8a2d\u5b9a\u3067\u3059\u3002\u8a2d\u5b9a\u306f\u6b21\u306e\u624b\u9806\u3067\u884c\u3044\u307e\u3059\u3002\n> \n> * S[14]='b'\u306e\u305f\u3081\u3001b\u306e\u30d0\u30b1\u30c3\u30c8\u3092\u53c2\u7167\u3057\u30667\u3092\u53d6\u5f97\n> * SA[7]\u306b14\u3092\u8a2d\u5b9a(\u4e0b\u8a18\u8868\u306e\u9752\u6587\u5b57\u306e\u90e8\u5206)\n> * b\u306e\u30d0\u30b1\u30c3\u30c8\u3092+1\n> \n> \u3053\u306e\u51e6\u7406\u3092SA\u306e\u672b\u5c3e\u307e\u3067\u9806\u306b\u51e6\u7406\u3057\u307e\u3059\u3002\u8a2d\u5b9a\u306e\u6d41\u308c\u306f\u6b21\u306e\u8868\u306e\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\n> \n> <table>\n>   <thead>\n>     <tr>\n>       <th style=\"text-align: center\">i</th>\n>       <th style=\"text-align: center\">0</th>\n>       <th style=\"text-align: center\">1</th>\n>       <th style=\"text-align: center\">2</th>\n>       <th style=\"text-align: center\">3</th>\n>       <th style=\"text-align: center\">4</th>\n>       <th style=\"text-align: center\">5</th>\n>       <th style=\"text-align: center\">6</th>\n>       <th style=\"text-align: center\">7</th>\n>       <th style=\"text-align: center\">8</th>\n>       <th style=\"text-align: center\">9</th>\n>       <th style=\"text-align: center\">10</th>\n>       <th style=\"text-align: center\">11</th>\n>       <th style=\"text-align: center\">12</th>\n>       <th style=\"text-align: center\">13</th>\n>       <th style=\"text-align: center\">14</th>\n>       <th style=\"text-align: center\">15</th>\n>     </tr>\n>   </thead>\n>   <tr>\n>     <td>\u5148\u982d\u6587\u5b57\u306e\u7bc4\u56f2</td>\n>     <td style=\"text-align: center\" colspan=\"1\">$</td>\n>     <td style=\"text-align: center\" colspan=\"6\">a</td>\n>     <td style=\"text-align: center\" colspan=\"5\">b</td>\n>     <td style=\"text-align: center\" colspan=\"2\">c</td>\n>     <td style=\"text-align: center\" colspan=\"2\">d</td>\n>   </tr>\n>   <tr>\n>     <td>SA[i]:\u521d\u671f\u72b6\u614b</td>\n>     <td style=\"text-align: center\">15</td>\n>     <td style=\"text-align: center\"></td>\n>     <td style=\"text-align: center\"></td>\n>     <td style=\"text-align: center\">13</td>\n>     <td style=\"text-align: center\">10</td>\n>     <td style=\"text-align: center\">3</td>\n>     <td style=\"text-align: center\">6</td>\n>     <td style=\"text-align: center\"></td>\n>     <td style=\"text-align: center\"></td>\n>     <td style=\"text-align: center\"></td>\n>     <td style=\"text-align: center\"></td>\n>     <td style=\"text-align: center\"></td>\n>     <td style=\"text-align: center\"></td>\n>     <td style=\"text-align: center\"></td>\n>     <td style=\"text-align: center\"></td>\n>     <td style=\"text-align: center\"></td>\n>   </tr>\n>   <tr>\n>     <td>SA[0] = 15\u306e\u51e6\u7406</td>\n>     <td style=\"text-align: center\"><font color=\"red\">15</font></td>\n>     <td style=\"text-align: center\"></td>\n>     <td style=\"text-align: center\"></td>\n>     <td style=\"text-align: center\">13</td>\n>     <td style=\"text-align: center\">10</td>\n>     <td style=\"text-align: center\">3</td>\n>     <td style=\"text-align: center\">6</td>\n>     <td style=\"text-align: center\"><font color=\"blue\">14</font></td>\n>     <td style=\"text-align: center\"></td>\n>     <td style=\"text-align: center\"></td>\n>     <td style=\"text-align: center\"></td>\n>     <td style=\"text-align: center\"></td>\n>     <td style=\"text-align: center\"></td>\n>     <td style=\"text-align: center\"></td>\n>     <td style=\"text-align: center\"></td>\n>     <td style=\"text-align: center\"></td>\n>   </tr>\n>   <tr>\n>     <td>SA[3] = 12\u306e\u51e6\u7406</td>\n>     <td style=\"text-align: center\">15</td>\n>     <td style=\"text-align: center\"></td>\n>     <td style=\"text-align: center\"></td>\n>     <td style=\"text-align: center\"><font color=\"red\">13</font></td>\n>     <td >10</td>\n>     <td style=\"text-align: center\">3</td>\n>     <td style=\"text-align: center\">6</td>\n>     <td style=\"text-align: center\">14</td>\n>     <td style=\"text-align: center\"></td>\n>     <td style=\"text-align: center\"></td>\n>     <td style=\"text-align: center\"></td>\n>     <td style=\"text-align: center\"></td>\n>     <td style=\"text-align: center\"><font color=\"blue\">12</font></td>\n>     <td style=\"text-align: center\"></td>\n>     <td style=\"text-align: center\"></td>\n>     <td style=\"text-align: center\"></td>\n>   </tr>\n>   <tr>\n>     <td>SA[4] = 10\u306e\u51e6\u7406</td>\n>     <td style=\"text-align: center\">15</td>\n>     <td style=\"text-align: center\"></td>\n>     <td style=\"text-align: center\"></td>\n>     <td style=\"text-align: center\">13</td>\n>     <td style=\"text-align: center\"><font color=\"red\">10</font></td>\n>     <td style=\"text-align: center\">3</td>\n>     <td style=\"text-align: center\">6</td>\n>     <td style=\"text-align: center\">14</td>\n>     <td style=\"text-align: center\"></td>\n>     <td style=\"text-align: center\"></td>\n>     <td style=\"text-align: center\"></td>\n>     <td style=\"text-align: center\"></td>\n>     <td style=\"text-align: center\">12</td>\n>     <td style=\"text-align: center\"></td>\n>     <td style=\"text-align: center\"><font color=\"blue\">9</font></td>\n>     <td style=\"text-align: center\"></td>\n>   </tr>\n>   <tr>\n>     <td>SA[5] =  3\u306e\u51e6\u7406</td>\n>     <td style=\"text-align: center\">15</td>\n>     <td style=\"text-align: center\"></td>\n>     <td style=\"text-align: center\"></td>\n>     <td style=\"text-align: center\">13</td>\n>     <td style=\"text-align: center\">10</td>\n>     <td style=\"text-align: center\"><font color=\"red\">3</font></td>\n>     <td style=\"text-align: center\">6</td>\n>     <td style=\"text-align: center\">14</td>\n>     <td style=\"text-align: center\"><font color=\"blue\">2</font></td>\n>     <td style=\"text-align: center\"></td>\n>     <td style=\"text-align: center\"></td>\n>     <td style=\"text-align: center\"></td>\n>     <td style=\"text-align: center\">12</td>\n>     <td style=\"text-align: center\"></td>\n>     <td style=\"text-align: center\">9</td>\n>     <td style=\"text-align: center\"></td>\n>   </tr>\n>   <tr>\n>     <td>SA[6] =  6\u306e\u51e6\u7406</td>\n>     <td style=\"text-align: center\">15</td>\n>     <td style=\"text-align: center\"></td>\n>     <td style=\"text-align: center\"></td>\n>     <td style=\"text-align: center\">13</td>\n>     <td style=\"text-align: center\">10</td>\n>     <td style=\"text-align: center\">3</td>\n>     <td style=\"text-align: center\"><font color=\"red\">6</font></td>\n>     <td style=\"text-align: center\">14</td>\n>     <td style=\"text-align: center\">2</td>\n>     <td style=\"text-align: center\"></td>\n>     <td style=\"text-align: center\"></td>\n>     <td style=\"text-align: center\"></td>\n>     <td style=\"text-align: center\">12</td>\n>     <td style=\"text-align: center\"><font color=\"blue\">5</font></td>\n>     <td style=\"text-align: center\">9</td>\n>     <td style=\"text-align: center\"></td>\n>   </tr>\n>   <tr>\n>     <td colspan=\"17\">SA[7] = 14, SA[8] = 2, SA[12] = 12, SA[13] = 5\u306f\u3001SA[i]-1\u304cS-Type\u306e\u305f\u3081\u30b9\u30ad\u30c3\u30d7</td>\n>   </tr>\n>   <tr>\n>     <td>SA[14] = 9\u306e\u51e6\u7406</td>\n>     <td style=\"text-align: center\">15</td>\n>     <td style=\"text-align: center\"></td>\n>     <td style=\"text-align: center\"></td>\n>     <td style=\"text-align: center\">13</td>\n>     <td style=\"text-align: center\">10</td>\n>     <td style=\"text-align: center\">3</td>\n>     <td style=\"text-align: center\">6</td>\n>     <td style=\"text-align: center\">14</td>\n>     <td style=\"text-align: center\">2</td>\n>     <td style=\"text-align: center\"></td>\n>     <td style=\"text-align: center\"></td>\n>     <td style=\"text-align: center\"></td>\n>     <td style=\"text-align: center\">12</td>\n>     <td style=\"text-align: center\">5</td>\n>     <td style=\"text-align: center\"><font color=\"red\">9</font></td>\n>     <td style=\"text-align: center\"><font color=\"blue\">8</font></td>\n>   </tr>\n> </table>\n> \n> \u3053\u306e\u51e6\u7406\u3067\u3059\u3079\u3066\u306eL-Type\u306e\u63a5\u5c3e\u8f9e\u3092\u6587\u5b57\u5217\u9806\u306b\u8a2d\u5b9a\u3067\u304d\u307e\u3057\u305f\u3002\n\n#### 3.3. S-Type\u306e\u30bd\u30fc\u30c8\n\u4eca\u5ea6\u306f\u300c3.2. L-Type\u306e\u30bd\u30fc\u30c8\u300d\u3067\u8a2d\u5b9a\u3057\u305fL-Type\u3092\u5229\u7528\u3057\u3066\u3001\u3059\u3079\u3066\u306eS-Type\u306e\u300c\u63a5\u5c3e\u8f9e\u306e\u958b\u59cb\u4f4d\u7f6e\u300d\u3092\u914d\u5217SA\u306b\u8a2d\u5b9a\u3057\u307e\u3059\uff08\u305f\u3060\u3057\u756a\u5175($)\u306f\u9664\u304f\uff09\u3002\u300c3.1. LMS-Type\u306e\u914d\u7f6e\u300d\u3067SA\u5185\u306b\u8a2d\u5b9a\u3057\u305fLMS-Type\u306e\u958b\u59cb\u4f4d\u7f6e\u306f\u3053\u306e\u51e6\u7406\u3067\u4e0a\u66f8\u304d\u3055\u308c\u307e\u3059\u3002\u624b\u9806\u3068\u3057\u3066\u306f\u6b21\u306e\u3068\u304a\u308a\u3067\u3059\u3002\n\n* \u5148\u982d\u6587\u5b57\u3054\u3068\u306e\u30d0\u30b1\u30c3\u30c8\u3092\u4f5c\u6210\uff08\u53f3\u8a70\u3081\u7528\u30023.1.\u3068\u540c\u3058\uff09\n* SA\u3092\u672b\u5c3e\u304b\u3089\u5148\u982d\u307e\u3067\u9806\u306b\u51e6\u7406\u3057\u3001SA[i]-1\u304cS-Type\u306a\u3089\u3070SA\u306b\u8a2d\u5b9a\uff083.2\u306e\u985e\u4f3c\u51e6\u7406\uff09\n\nS-Type\u3092SA\u306b\u8a2d\u5b9a\u3059\u308b\u51e6\u7406\u306f\u6b21\u306e\u3068\u304a\u308a\u3067\u3059\u3002\n\n```go:\nfor i := len(SA)-1; 0 <= i; i-- {\n\tif \u300cSA[i]\u306b\u5024\u304c\u3042\u308b\u300d\u304b\u3064\u300cSA[i]-1\u304cS-Type\u300d {\n        stypeIndex := SA[i]-1\n\t\tch := S[stypeIndex]         // \u63a5\u5c3e\u8f9e\u306e\u5148\u982d\u6587\u5b57\u3092\u53d6\u5f97 \n\t\tSA[bucket[ch]] = stypeIndex // S-Type\u306e\u300c\u63a5\u5c3e\u8f9e\u306e\u958b\u59cb\u4f4d\u7f6e\u300d\u3092\u8a2d\u5b9a\n\t    bucket[ch]--                // \u30d0\u30b1\u30c3\u30c8\u3092-1\n\t}\n}\n```\n\n\u3053\u306e\u624b\u9806\u3067\u3059\u3079\u3066\u306eS-Type\u304c\u63a5\u5c3e\u8f9e\u306e\u6587\u5b57\u5217\u9806\u3067SA\u306b\u8a2d\u5b9a\u3055\u308c\u3001\u63a5\u5c3e\u8f9e\u914d\u5217\u304c\u5b8c\u6210\u3057\u307e\u3059\u3002\n\n**\u4f8b**\n\n> \u7528\u610f\u3059\u308b\u30d0\u30b1\u30c3\u30c8\u306f3.1.\u3068\u540c\u3058\u3067\u3059\u3002S-Type\u3092\u8a2d\u5b9a\u3059\u308b\u51e6\u7406\u306f\u3001SA\u306e\u672b\u5c3e\u304b\u3089\u51e6\u7406\u3057\u307e\u3059\u3002\n> \n> \u300cSA[15] = 8\u300d\u3067\u306e\u51e6\u7406\u306f\u300cSA[15]-1 = 7\u300d\u306e\u8a2d\u5b9a\u3067\u3059\u3002\u8a2d\u5b9a\u306f\u6b21\u306e\u624b\u9806\u3067\u884c\u3044\u307e\u3059\u3002\n> \n> * S[7] = 'b'\u3067\u3042\u308b\u305f\u3081\u3001b\u306e\u30d0\u30b1\u30c3\u30c8\u3092\u53c2\u7167\u3057\u306611\u3092\u53d6\u5f97\n> * SA[11]\u306b7\u3092\u8a2d\u5b9a(\u4e0b\u8a18\u8868\u306e\u9752\u6587\u5b57\u306e\u90e8\u5206)\n> * b\u306e\u30d0\u30b1\u30c3\u30c8\u3092-1\n> \n> \u3053\u306e\u51e6\u7406\u3092SA\u306e\u5148\u982d\u307e\u3067\u9806\u306b\u51e6\u7406\u3057\u307e\u3059\u3002\u8a2d\u5b9a\u306e\u6d41\u308c\u306f\u6b21\u306e\u8868\u306e\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\n> \n> <table>\n>   <thead>\n>     <tr>\n>       <th style=\"text-align: center\">i</th>\n>       <th style=\"text-align: center\">0</th>\n>       <th style=\"text-align: center\">1</th>\n>       <th style=\"text-align: center\">2</th>\n>       <th style=\"text-align: center\">3</th>\n>       <th style=\"text-align: center\">4</th>\n>       <th style=\"text-align: center\">5</th>\n>       <th style=\"text-align: center\">6</th>\n>       <th style=\"text-align: center\">7</th>\n>       <th style=\"text-align: center\">8</th>\n>       <th style=\"text-align: center\">9</th>\n>       <th style=\"text-align: center\">10</th>\n>       <th style=\"text-align: center\">11</th>\n>       <th style=\"text-align: center\">12</th>\n>       <th style=\"text-align: center\">13</th>\n>       <th style=\"text-align: center\">14</th>\n>       <th style=\"text-align: center\">15</th>\n>     </tr>\n>   </thead>\n>   <tr>\n>     <td>\u5148\u982d\u6587\u5b57 \u306e \u7bc4\u56f2</td>\n>     <td style=\"text-align: center\" colspan=\"1\">$</td>\n>     <td style=\"text-align: center\" colspan=\"6\">a</td>\n>     <td style=\"text-align: center\" colspan=\"5\">b</td>\n>     <td style=\"text-align: center\" colspan=\"2\">c</td>\n>     <td style=\"text-align: center\" colspan=\"2\">d</td>\n>   </tr>\n>   <tr>\n>     <td>SA[i]:\u521d\u671f\u72b6\u614b</td>\n>     <td style=\"text-align: center\">15</td>\n>     <td style=\"text-align: center\"></td>\n>     <td style=\"text-align: center\"></td>\n>     <td style=\"text-align: center; color: gray\">13</td>\n>     <td style=\"text-align: center; color: gray\">10</td>\n>     <td style=\"text-align: center; color: gray\">3</td>\n>     <td style=\"text-align: center; color: gray\">6</td>\n>     <td style=\"text-align: center\">14</td>\n>     <td style=\"text-align: center\">2</td>\n>     <td style=\"text-align: center\"></td>\n>     <td style=\"text-align: center\"></td>\n>     <td style=\"text-align: center\"></td>\n>     <td style=\"text-align: center\">12</td>\n>     <td style=\"text-align: center\">5</td>\n>     <td style=\"text-align: center\">9</td>\n>     <td style=\"text-align: center\">8</td>\n>   </tr>\n>   </tr>\n>   <tr>\n>     <td>SA[15] = 8\u306e\u51e6\u7406</td>\n>     <td style=\"text-align: center\">15</td>\n>     <td style=\"text-align: center\"></td>\n>     <td style=\"text-align: center\"></td>\n>     <td style=\"text-align: center; color: gray\">13</td>\n>     <td style=\"text-align: center; color: gray\">10</td>\n>     <td style=\"text-align: center; color: gray\">3</td>\n>     <td style=\"text-align: center; color: gray\">6</td>\n>     <td style=\"text-align: center\">14</td>\n>     <td style=\"text-align: center\">2</td>\n>     <td style=\"text-align: center\"></td>\n>     <td style=\"text-align: center\"></td>\n>     <td style=\"text-align: center\"><font color=\"blue\">7</font></td>\n>     <td style=\"text-align: center\">12</td>\n>     <td style=\"text-align: center\">5</td>\n>     <td style=\"text-align: center\">9</td>\n>     <td style=\"text-align: center\"><font color=\"red\">8</font></td>\n>   </tr>\n>   <tr>\n>     <td colspan=\"17\">SA[14] = 9\u306f\u30019-1 = 8\u304cL-Type\u306e\u305f\u3081\u30b9\u30ad\u30c3\u30d7</td>\n>   </tr>\n>   <tr>\n>     <td>SA[11] = 5\u306e\u51e6\u7406</td>\n>     <td style=\"text-align: center\">15</td>\n>     <td style=\"text-align: center\"></td>\n>     <td style=\"text-align: center\"></td>\n>     <td style=\"text-align: center; color: gray\">13</td>\n>     <td style=\"text-align: center; color: gray\">10</td>\n>     <td style=\"text-align: center; color: gray\">3</td>\n>     <td style=\"text-align: center; color: gray\">6</td>\n>     <td style=\"text-align: center\">14</td>\n>     <td style=\"text-align: center\">2</td>\n>     <td style=\"text-align: center\"></td>\n>     <td style=\"text-align: center\"><font color=\"blue\">4</font></td>\n>     <td style=\"text-align: center\">7</td>\n>     <td style=\"text-align: center\">12</td>\n>     <td style=\"text-align: center\"><font color=\"red\">5</font></td>\n>     <td style=\"text-align: center\">9</td>\n>     <td style=\"text-align: center\">8</td>\n>   </tr>\n>   <tr>\n>     <td>SA[10] = 12\u306e\u51e6\u7406</td>\n>     <td style=\"text-align: center\">15</td>\n>     <td style=\"text-align: center\"></td>\n>     <td style=\"text-align: center\"></td>\n>     <td style=\"text-align: center; color: gray\">13</td>\n>     <td style=\"text-align: center; color: gray\">10</td>\n>     <td style=\"text-align: center; color: gray\">3</td>\n>     <td style=\"text-align: center; color: gray\">6</td>\n>     <td style=\"text-align: center\">14</td>\n>     <td style=\"text-align: center\">2</td>\n>     <td style=\"text-align: center\"><font color=\"blue\">11</font></td>\n>     <td style=\"text-align: center\">4</td>\n>     <td style=\"text-align: center\">7</td>\n>     <td style=\"text-align: center\"><font color=\"red\">12</font></td>\n>     <td style=\"text-align: center\">5</td>\n>     <td style=\"text-align: center\">9</td>\n>     <td style=\"text-align: center\">8</td>\n>   </tr>\n>   <tr>\n>     <td>SA[11] = 7\u306e\u51e6\u7406</td>\n>     <td style=\"text-align: center\">15</td>\n>     <td style=\"text-align: center\"></td>\n>     <td style=\"text-align: center\"></td>\n>     <td style=\"text-align: center; color: gray\">13</td>\n>     <td style=\"text-align: center; color: gray\">10</td>\n>     <td style=\"text-align: center; color: gray\">3</td>\n>     <td style=\"text-align: center\"><font color=\"blue\">6</font></td>\n>     <td style=\"text-align: center\">14</td>\n>     <td style=\"text-align: center\">2</td>\n>     <td style=\"text-align: center\">11</td>\n>     <td style=\"text-align: center\">4</td>\n>     <td style=\"text-align: center\"><font color=\"red\">7</font></td>\n>     <td style=\"text-align: center\">12</td>\n>     <td style=\"text-align: center\">5</td>\n>     <td style=\"text-align: center\">9</td>\n>     <td style=\"text-align: center\">8</td>\n>   </tr>\n>   <tr>\n>     <td>SA[10] = 4\u306e\u51e6\u7406</td>\n>     <td style=\"text-align: center\">15</td>\n>     <td style=\"text-align: center\"></td>\n>     <td style=\"text-align: center\"></td>\n>     <td style=\"text-align: center; color: gray\">13</td>\n>     <td style=\"text-align: center; color: gray\">10</td>\n>     <td style=\"text-align: center\"><font color=\"blue\">3</font></td>\n>     <td style=\"text-align: center\">6</td>\n>     <td style=\"text-align: center\">14</td>\n>     <td style=\"text-align: center\">2</td>\n>     <td style=\"text-align: center\">11</td>\n>     <td style=\"text-align: center\"><font color=\"red\">4</font></td>\n>     <td style=\"text-align: center\">7</td>\n>     <td style=\"text-align: center\">12</td>\n>     <td style=\"text-align: center\">5</td>\n>     <td style=\"text-align: center\">9</td>\n>     <td style=\"text-align: center\">8</td>\n>   </tr>\n>   <tr>\n>     <td>SA[9] = 11\u306e\u51e6\u7406</td>\n>     <td style=\"text-align: center\">15</td>\n>     <td style=\"text-align: center\"></td>\n>     <td style=\"text-align: center\"></td>\n>     <td style=\"text-align: center; color: gray\">13</td>\n>     <td style=\"text-align: center\"><font color=\"blue\">10</font></td>\n>     <td style=\"text-align: center\">3</td>\n>     <td style=\"text-align: center\">6</td>\n>     <td style=\"text-align: center\">14</td>\n>     <td style=\"text-align: center\">2</td>\n>     <td style=\"text-align: center\"><font color=\"red\">11</font></td>\n>     <td style=\"text-align: center\">4</td>\n>     <td style=\"text-align: center\">7</td>\n>     <td style=\"text-align: center\">12</td>\n>     <td style=\"text-align: center\">5</td>\n>     <td style=\"text-align: center\">9</td>\n>     <td style=\"text-align: center\">8</td>\n>   </tr>\n>   <tr>\n>     <td>SA[8] = 2\u306e\u51e6\u7406</td>\n>     <td style=\"text-align: center\">15</td>\n>     <td style=\"text-align: center\"></td>\n>     <td style=\"text-align: center\"></td>\n>     <td style=\"text-align: center\"><font color=\"blue\">1</font></td>\n>     <td style=\"text-align: center\">10</td>\n>     <td style=\"text-align: center\">3</td>\n>     <td style=\"text-align: center\">6</td>\n>     <td style=\"text-align: center\">14</td>\n>     <td style=\"text-align: center\"><font color=\"red\">2</font></td>\n>     <td style=\"text-align: center\">11</td>\n>     <td style=\"text-align: center\">4</td>\n>     <td style=\"text-align: center\">7</td>\n>     <td style=\"text-align: center\">12</td>\n>     <td style=\"text-align: center\">5</td>\n>     <td style=\"text-align: center\">9</td>\n>     <td style=\"text-align: center\">8</td>\n>   </tr>\n>   <tr>\n>     <td>SA[7] = 14\u306e\u51e6\u7406</td>\n>     <td style=\"text-align: center\">15</td>\n>     <td style=\"text-align: center\"></td>\n>     <td style=\"text-align: center\"><font color=\"blue\">13</font></td>\n>     <td style=\"text-align: center\">1</td>\n>     <td style=\"text-align: center\">10</td>\n>     <td style=\"text-align: center\">3</td>\n>     <td style=\"text-align: center\">6</td>\n>     <td style=\"text-align: center\"><font color=\"red\">14</font></td>\n>     <td style=\"text-align: center\">2</td>\n>     <td style=\"text-align: center\">11</td>\n>     <td style=\"text-align: center\">4</td>\n>     <td style=\"text-align: center\">7</td>\n>     <td style=\"text-align: center\">12</td>\n>     <td style=\"text-align: center\">5</td>\n>     <td style=\"text-align: center\">9</td>\n>     <td style=\"text-align: center\">8</td>\n>   </tr>\n>   <tr>\n>     <td colspan=\"17\">SA[6] = 6, SA[5] = 3, SA[4] = 10\u306f\u3001SA[i]-1\u304cL-Type\u306e\u305f\u3081\u30b9\u30ad\u30c3\u30d7</td>\n>   </tr>\n>   <tr>\n>     <td>SA[3] = 1\u306e\u51e6\u7406</td>\n>     <td style=\"text-align: center\">15</td>\n>     <td style=\"text-align: center\"><font color=\"blue\">0</font></td>\n>     <td style=\"text-align: center\">13</td>\n>     <td style=\"text-align: center\"><font color=\"red\">1</font></td>\n>     <td style=\"text-align: center\">10</td>\n>     <td style=\"text-align: center\">3</td>\n>     <td style=\"text-align: center\">6</td>\n>     <td style=\"text-align: center\">14</td>\n>     <td style=\"text-align: center\">2</td>\n>     <td style=\"text-align: center\">11</td>\n>     <td style=\"text-align: center\">4</td>\n>     <td style=\"text-align: center\">7</td>\n>     <td style=\"text-align: center\">12</td>\n>     <td style=\"text-align: center\">5</td>\n>     <td style=\"text-align: center\">9</td>\n>     <td style=\"text-align: center\">8</td>\n>   </tr>\n>   <tr>\n>     <td colspan=\"17\">SA[2] = 3, SA[0] = 15\u306f\u3001SA[i]-1\u304cL-Type\u306e\u305f\u3081\u30b9\u30ad\u30c3\u30d7\u3002SA[1] = 0\u306fSA[i]-1\u304c\u30de\u30a4\u30ca\u30b9\u306e\u305f\u3081\u30b9\u30ad\u30c3\u30d7</td>\n>   </tr>\n> </table>\n> \n> \u3053\u306eS-Type\u306e\u30bd\u30fc\u30c8\u304c\u7d42\u308f\u308b\u3068\u3001SA\u306f\u6587\u5b57\u5217S\u306e\u63a5\u5c3e\u8f9e\u914d\u5217\u306b\u306a\u308a\u307e\u3059\u3002\n\n---\n### 1. LMS\u90e8\u5206\u6587\u5b57\u5217\u306e\u30bd\u30fc\u30c8\n\u300c3. S-Type\u3001L-Type\u306e\u63a5\u5c3e\u8f9e\u306e\u30bd\u30fc\u30c8\u300d\u306e\u51e6\u7406\u3067\u306f\u3001LMS-Type\u306e\u63a5\u5c3e\u8f9e\u914d\u5217\u304c\u5fc5\u8981\u3067\u3057\u305f\u3002\u300c1. LMS\u90e8\u5206\u6587\u5b57\u5217\u306e\u30bd\u30fc\u30c8\u300d\u3068\u300c2. LMS-Type\u306e\u63a5\u5c3e\u8f9e\u306e\u30bd\u30fc\u30c8\u300d\u306f\u3001\u3053\u306eLMS-Type\u306e\u63a5\u5c3e\u8f9e\u914d\u5217\u3092\u4f5c\u6210\u3059\u308b\u307e\u3067\u306e\u51e6\u7406\u306b\u306a\u308a\u307e\u3059\u3002\n\u300c1. LMS\u90e8\u5206\u6587\u5b57\u5217\u306e\u30bd\u30fc\u30c8\u300d\u306e\u624b\u9806\u306f\u6b21\u306e\u3068\u304a\u308a\u3067\u3059\u3002\n\n* 1.1. LMS-Type\u306e\u30bd\u30fc\u30c8\uff08\u5148\u982d\u6587\u5b57\u306e\u307f\uff09\n* 1.2. L-Type\u306e\u30bd\u30fc\u30c8\n* 1.3. S-Type\u306e\u30bd\u30fc\u30c8\n* 1.4. LMS-Prefix\u306e\u914d\u5217\u304b\u3089LMS\u90e8\u5206\u6587\u5b57\u5217\u306e\u62bd\u51fa\n\n1.1\uff5e1.3\u306e\u51e6\u7406\u3067LMS-Prefix\u306e\u30bd\u30fc\u30c8\u3092\u884c\u3044\u30011.4\u3067LMS-Prefix\u306e\u914d\u5217\u304b\u3089LMS\u90e8\u5206\u6587\u5b57\u5217\u306e\u62bd\u51fa\u3092\u884c\u3044\u307e\u3059\u3002\n\u307e\u305f1.1\uff5e1.3\u306e\u51e6\u7406\u306f\u30013.1\uff5e3.3\u306e\u51e6\u7406\u3068\u307b\u3068\u3093\u3069\u540c\u3058\u51e6\u7406\u306b\u306a\u3063\u3066\u3044\u307e\u3059\u3002\n\n#### 1.1. LMS-Type\u306e\u30bd\u30fc\u30c8\uff08\u5148\u982d\u6587\u5b57\u306e\u307f\uff09\n  \u3053\u306e\u51e6\u7406\u306f\u3001\u300c3.1. LMS-Type\u306e\u914d\u7f6e\u300d\u306e\u985e\u4f3c\u51e6\u7406\u3067\u3059\u3002\u3057\u304b\u3057\u3001\u30bd\u30fc\u30c8\u6e08\u307f\u306eLMS-Type\u304c\u307e\u3060\u5b58\u5728\u3057\u306a\u3044\u305f\u3081\u3001\u30d0\u30b1\u30c3\u30c8\u3092\u4f7f\u7528\u3057\u3066\u5148\u982d\u6587\u5b57\u306e\u307f\u3067\u30bd\u30fc\u30c8\u3057\u307e\u3059\u30022\u6587\u5b57\u76ee\u4ee5\u964d\u306e\u9806\u756a\u306f\u3053\u3053\u3067\u306f\u6c7a\u3081\u3089\u308c\u307e\u305b\u3093\u3002\u624b\u9806\u3068\u3057\u3066\u306f\u6b21\u306e\u3068\u304a\u308a\u3067\u3059\u3002\n\n* \u5148\u982d\u6587\u5b57\u3054\u3068\u306e\u30d0\u30b1\u30c3\u30c8\u3092\u8a2d\u5b9a(\u53f3\u8a70\u3081\u7528\u30023.1.\u3068\u540c\u3058\uff09\n* \u6587\u5b57S\u3092\u5148\u982d\u304b\u3089\u672b\u5c3e\u307e\u3067\u9806\u306b\u51e6\u7406\u3057\u3001LMS-Type\u306e\u6587\u5b57\u4f4d\u7f6e\u3092\u914d\u5217SA\u306b\u683c\u7d0d\n\nLMS-Type\u306e\u8a2d\u5b9a\u306f\u3001\u6587\u5b57\u5217S\u306b\u5bfe\u3057\u3066\u672b\u5c3e\u304b\u3089\u5148\u982d\u307e\u3067\u9806\u306b\u51e6\u7406\u3057\u307e\u3059\u3002\n\n```go:\nfor i := len(S)-1; 0 <= i; i-- {\n\tif \u300cS[i]\u304cLMS-Type\u300d {\n\t\tch := S[i]         // \u63a5\u5c3e\u8f9e\u306e\u5148\u982d\u6587\u5b57\u3092\u53d6\u5f97 \n\t\tSA[bucket[ch]] = i // LMS-Type\u306e\u300c\u6587\u5b57\u4f4d\u7f6e\uff08\u63a5\u5c3e\u8f9e\u306e\u958b\u59cb\u4f4d\u7f6e\uff09\u300d\u3092\u8a2d\u5b9a\n\t\tbucket[ch]--       // \u30d0\u30b1\u30c3\u30c8\u3092-1\n\t}\n}\n```\n\n**\u4f8b**\n> \u7528\u610f\u3059\u308b\u30d0\u30b1\u30c3\u30c8\u306f3.1.\u3068\u540c\u3058\u3067\u3059\u3002\n> LMS-Type\u306e\u8a2d\u5b9a\u51e6\u7406\u306f\u6b21\u306e\u3068\u304a\u308a\u3067\u3059\u3002\n> \n> <table>\n>   <thead>\n>     <tr>\n>       <th style=\"text-align: center\">i</th>\n>       <th style=\"text-align: center\">0</th>\n>       <th style=\"text-align: center\">1</th>\n>       <th style=\"text-align: center\">2</th>\n>       <th style=\"text-align: center\">3</th>\n>       <th style=\"text-align: center\">4</th>\n>       <th style=\"text-align: center\">5</th>\n>       <th style=\"text-align: center\">6</th>\n>       <th style=\"text-align: center\">7</th>\n>       <th style=\"text-align: center\">8</th>\n>       <th style=\"text-align: center\">9</th>\n>       <th style=\"text-align: center\">10</th>\n>       <th style=\"text-align: center\">11</th>\n>       <th style=\"text-align: center\">12</th>\n>       <th style=\"text-align: center\">13</th>\n>       <th style=\"text-align: center\">14</th>\n>       <th style=\"text-align: center\">15</th>\n>     </tr>\n>   </thead>\n>   <tr>\n>     <td>\u5148\u982d\u6587\u5b57\u306e\u7bc4\u56f2</td>\n>     <td style=\"text-align: center\" colspan=\"1\">$</td>\n>     <td style=\"text-align: center\" colspan=\"6\">a</td>\n>     <td style=\"text-align: center\" colspan=\"5\">b</td>\n>     <td style=\"text-align: center\" colspan=\"2\">c</td>\n>     <td style=\"text-align: center\" colspan=\"2\">d</td>\n>   </tr>\n>   <tr>\n>     <td>SA[i]</td>\n>     <td style=\"text-align: center\">15</td>\n>     <td style=\"text-align: center\"></td>\n>     <td style=\"text-align: center\"></td>\n>     <td style=\"text-align: center\">3</td>\n>     <td style=\"text-align: center\">6</td>\n>     <td style=\"text-align: center\">10</td>\n>     <td style=\"text-align: center\">13</td>\n>     <td style=\"text-align: center\"></td>\n>     <td style=\"text-align: center\"></td>\n>     <td style=\"text-align: center\"></td>\n>     <td style=\"text-align: center\"></td>\n>     <td style=\"text-align: center\"></td>\n>     <td style=\"text-align: center\"></td>\n>     <td style=\"text-align: center\"></td>\n>     <td style=\"text-align: center\"></td>\n>     <td style=\"text-align: center\"></td>\n>   </tr>\n> </table>\n> \n> 3.1\u306e\u7d50\u679c\u3068\u6bd4\u3079\u308b\u3068\u3001\u5148\u982d\u6587\u5b57a\u306e\u7bc4\u56f2\u5185\u3067\u9806\u756a\u304c\u5165\u308c\u66ff\u308f\u3063\u3066\u3044\u307e\u3059\u3002\n\n#### 1.2. L-Type\u306e\u30bd\u30fc\u30c8\n\u51e6\u7406\u81ea\u4f53\u306f\u300c3.2. L-Type\u306e\u30bd\u30fc\u30c8\u300d\u3068\u540c\u3058\u3067\u3059\u3002\u3057\u304b\u3057\u30011.1.\u3067LMS-Type\u304c\u6b63\u3057\u304f\u30bd\u30fc\u30c8\u3055\u308c\u3066\u3044\u306a\u3044\u305f\u3081\u3001\u63a5\u5c3e\u8f9e\u914d\u5217\u3068\u3057\u3066\u306f\u6b63\u3057\u3044\u9806\u756a\u306b\u306a\u308a\u307e\u305b\u3093\u3002\n\n**\u4f8b**\n\n> \u51e6\u7406\u306f3.2\u3068\u5168\u3066\u540c\u3058\u3067\u3042\u308b\u305f\u3081\u7701\u7565\u3057\u307e\u3059\u3002\u7d50\u679c\u306f\u6b21\u306e\u3068\u304a\u308a\u3067\u3059\u3002\n> \n> <table>\n>   <thead>\n>     <tr>\n>       <th style=\"text-align: center\">i</th>\n>       <th style=\"text-align: center\">0</th>\n>       <th style=\"text-align: center\">1</th>\n>       <th style=\"text-align: center\">2</th>\n>       <th style=\"text-align: center\">3</th>\n>       <th style=\"text-align: center\">4</th>\n>       <th style=\"text-align: center\">5</th>\n>       <th style=\"text-align: center\">6</th>\n>       <th style=\"text-align: center\">7</th>\n>       <th style=\"text-align: center\">8</th>\n>       <th style=\"text-align: center\">9</th>\n>       <th style=\"text-align: center\">10</th>\n>       <th style=\"text-align: center\">11</th>\n>       <th style=\"text-align: center\">12</th>\n>       <th style=\"text-align: center\">13</th>\n>       <th style=\"text-align: center\">14</th>\n>       <th style=\"text-align: center\">15</th>\n>     </tr>\n>   </thead>\n>   <tr>\n>     <td>\u5148\u982d\u6587\u5b57\u306e\u7bc4\u56f2</td>\n>     <td style=\"text-align: center\" colspan=\"1\">$</td>\n>     <td style=\"text-align: center\" colspan=\"6\">a</td>\n>     <td style=\"text-align: center\" colspan=\"5\">b</td>\n>     <td style=\"text-align: center\" colspan=\"2\">c</td>\n>     <td style=\"text-align: center\" colspan=\"2\">d</td>\n>   </tr>\n>   <tr>\n>     <td>SA[i]</td>\n>     <td style=\"text-align: center\">15</td>\n>     <td style=\"text-align: center\"></td>\n>     <td style=\"text-align: center\"></td>\n>     <td style=\"text-align: center\">3</td>\n>     <td style=\"text-align: center\">6</td>\n>     <td style=\"text-align: center\">10</td>\n>     <td style=\"text-align: center\">13</td>\n>     <td style=\"text-align: center\">14</td>\n>     <td style=\"text-align: center\">2</td>\n>     <td style=\"text-align: center\"></td>\n>     <td style=\"text-align: center\"></td>\n>     <td style=\"text-align: center\"></td>\n>     <td style=\"text-align: center; color: blue\">5</td>\n>     <td style=\"text-align: center; color: blue\">12</td>\n>     <td style=\"text-align: center\">9</td>\n>     <td style=\"text-align: center\">8</td>\n>   </tr>\n> </table>\n> \n> 3.2\u306e\u7d50\u679c\u3068\u6bd4\u3079\u308b\u3068SA[12]=5\u3068SA[13]=12\u306e\u90e8\u5206\u304c\u5165\u308c\u66ff\u308f\u3063\u3066\u3044\u307e\u3059\u3002\n> \u3053\u308c\u306f1.1\u30672\u6587\u5b57\u76ee\u306e\u9806\u5e8f\u3092\u6c7a\u3081\u3089\u308c\u306a\u304b\u3063\u305f\u305f\u3081\u3067\u3059\u3002\n\n#### 1.3. S-Type\u306e\u30bd\u30fc\u30c8\n\u3053\u306e\u51e6\u7406\u3082\u624b\u9806\u81ea\u4f53\u306f\u300c3.3. S-Type\u306e\u30bd\u30fc\u30c8\u300d\u3068\u540c\u3058\u3067\u3059\u3002\n\n**\u4f8b**\n\n> \u51e6\u7406\u306f3.3\u3068\u5168\u3066\u540c\u3058\u3067\u3042\u308b\u305f\u3081\u7701\u7565\u3057\u307e\u3059\u3002\u7d50\u679c\u306f\u6b21\u306e\u3068\u304a\u308a\u3067\u3059\u3002\n> \n> <table>\n>   <thead>\n>     <tr>\n>       <th style=\"text-align: center\">i</th>\n>       <th style=\"text-align: center\">0</th>\n>       <th style=\"text-align: center\">1</th>\n>       <th style=\"text-align: center\">2</th>\n>       <th style=\"text-align: center\">3</th>\n>       <th style=\"text-align: center\">4</th>\n>       <th style=\"text-align: center\">5</th>\n>       <th style=\"text-align: center\">6</th>\n>       <th style=\"text-align: center\">7</th>\n>       <th style=\"text-align: center\">8</th>\n>       <th style=\"text-align: center\">9</th>\n>       <th style=\"text-align: center\">10</th>\n>       <th style=\"text-align: center\">11</th>\n>       <th style=\"text-align: center\">12</th>\n>       <th style=\"text-align: center\">13</th>\n>       <th style=\"text-align: center\">14</th>\n>       <th style=\"text-align: center\">15</th>\n>     </tr>\n>   </thead>\n>   <tr>\n>     <td>\u5148\u982d\u6587\u5b57\u306e\u7bc4\u56f2</td>\n>     <td style=\"text-align: center\" colspan=\"1\">$</td>\n>     <td style=\"text-align: center\" colspan=\"6\">a</td>\n>     <td style=\"text-align: center\" colspan=\"5\">b</td>\n>     <td style=\"text-align: center\" colspan=\"2\">c</td>\n>     <td style=\"text-align: center\" colspan=\"2\">d</td>\n>   </tr>\n>   <tr>\n>     <td>SA[i]</td>\n>     <td style=\"text-align: center\">15</td>\n>     <td style=\"text-align: center\">0</td>\n>     <td style=\"text-align: center\">13</td>\n>     <td style=\"text-align: center\">1</td>\n>     <td style=\"text-align: center\">3</td>\n>     <td style=\"text-align: center\">10</td>\n>     <td style=\"text-align: center\">6</td>\n>     <td style=\"text-align: center\">14</td>\n>     <td style=\"text-align: center\">2</td>\n>     <td style=\"text-align: center\">4</td>\n>     <td style=\"text-align: center\">11</td>\n>     <td style=\"text-align: center\">7</td>\n>     <td style=\"text-align: center\">5</td>\n>     <td style=\"text-align: center\">12</td>\n>     <td style=\"text-align: center\">9</td>\n>     <td style=\"text-align: center\">8</td>\n>   </tr>\n>   <tr>\n>     <td> pre(S, SA[i]) <br> \uff08LMS-Prefix\uff09</td>\n>     <td style=\"text-align: center; font-size:x-small\">$    </td>\n>     <td style=\"text-align: center; font-size:x-small\">aaba </td>\n>     <td style=\"text-align: center; font-size:x-small\">ab$  </td>\n>     <td style=\"text-align: center; font-size:x-small\">aba  </td>\n>     <td style=\"text-align: center; font-size:x-small\">abca </td>\n>     <td style=\"text-align: center; font-size:x-small\">abca </td>\n>     <td style=\"text-align: center; font-size:x-small\">abdda</td>\n>     <td style=\"text-align: center; font-size:x-small\">b$   </td>\n>     <td style=\"text-align: center; font-size:x-small\">ba   </td>\n>     <td style=\"text-align: center; font-size:x-small\">bca  </td>\n>     <td style=\"text-align: center; font-size:x-small\">bca  </td>\n>     <td style=\"text-align: center; font-size:x-small\">cdda </td>\n>     <td style=\"text-align: center; font-size:x-small\">ca   </td>\n>     <td style=\"text-align: center; font-size:x-small\">ca   </td>\n>     <td style=\"text-align: center; font-size:x-small\">da   </td>\n>     <td style=\"text-align: center; font-size:x-small\">dda  </td>\n>   </tr>\n> </table>\n>\n> 3.3\u306e\u7d50\u679c\u3068\u6bd4\u3079\u308b\u3068SA[9]=4\u3068SA[10]=11\u3001SA[4]=3\u3068SA[5]=10\u304c\u5165\u308c\u66ff\u308f\u3063\u3066\u3044\u307e\u3059\u3002\n> \u3053\u306e\u3088\u3046\u306b\u63a5\u5c3e\u8f9e\u306e\u6587\u5b57\u5217\u9806\u3067\u306f\u3001\u4e00\u90e8\u304c\u30bd\u30fc\u30c8\u3067\u304d\u3066\u3044\u306a\u3044\u72b6\u614b\u3067\u3059\u3002\n> \u3057\u304b\u3057\u3001\u4e00\u65b9\u3067LMS-Prefix\u306e\u6587\u5b57\u5217\u9806\u3067\u306f\u30bd\u30fc\u30c8\u3057\u305f\u72b6\u614b\u306b\u306a\u3063\u3066\u3044\u307e\u3059\u3002\n\n#### 1.4. LMS-Prefix\u306e\u914d\u5217\u304b\u3089LMS\u90e8\u5206\u6587\u5b57\u5217\u306e\u62bd\u51fa\nLMS\u90e8\u5206\u6587\u5b57\u5217\u4ee5\u5916\u306e\u5024\u306f\u4e0d\u8981\u3067\u3059\u3002LMS\u90e8\u5206\u6587\u5b57\u5217\u306f\u3001LMS-Type\u304b\u3089\u958b\u59cb\u3059\u308bLMS-Prefix\u3068\u4e00\u81f4\u3059\u308b\u305f\u3081\u3001\u305d\u306e\u5024\u306e\u307f\u6b8b\u3057\u307e\u3059\u3002\n\n**\u4f8b**\n> LMS-Type\u306e\u958b\u59cb\u4f4d\u7f6e\u306f3, 6, 10, 13, 15\u3067\u3042\u308b\u305f\u3081\u3001\u305d\u306e\u90e8\u5206\u306e\u307f\u304c\u6b8b\u3059\u3088\u3046\u306b\u3057\u307e\u3059\u3002\n> \n> <table>\n>   <tr>\n>     <td>SA[i] <br>(LMS\u90e8\u5206\u6587\u5b57\u5217\u306e\u958b\u59cb\u4f4d\u7f6e)</td>\n>     <td style=\"text-align: center\">15</td>\n>     <td style=\"text-align: center\">13</td>\n>     <td style=\"text-align: center\">3</td>\n>     <td style=\"text-align: center\">10</td>\n>     <td style=\"text-align: center\">6</td>\n>   </tr>\n>   <tr>\n>     <td> pre(S, SA[i]) <br>(LMS-Prefix)</td>\n>     <td style=\"text-align: center\">$    </td>\n>     <td style=\"text-align: center\">ab$  </td>\n>     <td style=\"text-align: center\">abca </td>\n>     <td style=\"text-align: center\">abca </td>\n>     <td style=\"text-align: center\">abdda</td>\n>   </tr>\n> </table>\n> \n> \u3053\u306e\u62bd\u51fa\u306b\u3088\u3063\u3066\u3001\u30bd\u30fc\u30c8\u3057\u305fLMS\u90e8\u5206\u6587\u5b57\u5217\u306e\u914d\u5217\u304c\u4f5c\u6210\u3067\u304d\u307e\u3057\u305f\u3002\n\n---\n### 2. LMS-Type\u306e\u63a5\u5c3e\u8f9e\u306e\u30bd\u30fc\u30c8\n\u3053\u3053\u3067\u306f\u3001\u30bd\u30fc\u30c8\u6e08\u307f\u306eLMS\u90e8\u5206\u6587\u5b57\u5217\u3092\u4f7f\u7528\u3057\u3066\u3001LMS-Type\u306e\u307f\u306e\u63a5\u5c3e\u8f9e\u914d\u5217\u3092\u69cb\u7bc9\u3057\u307e\u3059\u3002\u5b9f\u65bd\u624b\u9806\u306f\u4e0b\u8a18\u306e2\u3064\u3067\u3059\u3002\n\n* 2.1. LMS\u90e8\u5206\u6587\u5b57\u5217\u306b\u9806\u5e8f\u756a\u53f7\u4ed8\u4e0e\u3068\u91cd\u8907\u30c1\u30a7\u30c3\u30af\n* 2.2. \u9806\u5e8f\u756a\u53f7\u306e\u63a5\u5c3e\u8f9e\u914d\u5217\u3092\u6c42\u3081\u308b\uff08\u518d\u5e30\u547c\u3073\u51fa\u3057\uff09\n\n\u3053\u306e\u3046\u3061\u30012.1\u306e\u91cd\u8907\u30c1\u30a7\u30c3\u30af\u3067\u3059\u3079\u3066\u306eLMS\u90e8\u5206\u6587\u5b57\u5217\u304c\u91cd\u8907\u3057\u306a\u3044\u306a\u3089\u3070\u3001LMS\u90e8\u5206\u6587\u5b57\u5217\u306e\u958b\u59cb\u4f4d\u7f6e\u3068LMS-Type\u306e\u63a5\u5c3e\u8f9e\u914d\u5217\u304c\u4e00\u81f4\u3059\u308b\u305f\u3081\u30012.2\u306e\u51e6\u7406\u306f\u4e0d\u8981\u3068\u306a\u308a\u307e\u3059\u3002\n\n#### 2.1 LMS\u90e8\u5206\u6587\u5b57\u5217\u306b\u9806\u5e8f\u756a\u53f7\u4ed8\u4e0e\u3068\u91cd\u8907\u30c1\u30a7\u30c3\u30af\n\u9806\u5e8f\u756a\u53f7(name)\u3068\u306f\u3001LMS\u90e8\u5206\u6587\u5b57\u5217\u306e\u6587\u5b57\u5217\u9806\u306b\u63a1\u756a\u3057\u305f\u5024\u3067\u3059\u3002\u305f\u3060\u3057\u3001LMS\u90e8\u5206\u6587\u5b57\u5217\u304c\u540c\u3058\u5024\u306e\u5834\u5408\u306f\u540c\u3058\u756a\u53f7\u3068\u3057\u307e\u3059\u3002\u63a1\u756a\u3057\u305f\u9806\u5e8f\u756a\u53f7\u306f\u3001LMS\u90e8\u5206\u6587\u5b57\u5217\u306e\u958b\u59cb\u4f4d\u7f6e\u9806\u306b\u306a\u308b\u3088\u3046\u306b\u683c\u7d0d\u3057\u307e\u3059\u3002\n\n```go:\n// LMSSubstrings\u306f\u3001LMS\u90e8\u5206\u6587\u5b57\u5217\u306e\u958b\u59cb\u4f4d\u7f6e\u3092\u683c\u7d0d\u3057\u305f\u914d\u5217\n// Names\u306f\u9806\u5e8f\u756a\u53f7\u3092\u683c\u7d0d\u3059\u308b\u914d\u5217\nname := 0\nNames[LMSSubstring[0]/2] = name\nfor i := 1; i < len(LMSSubstrings); i++  {\n    if LMSSubstrings[i-1]\u3068 LMSSubstrings[i] \u306eLMS\u90e8\u5206\u6587\u5b57\u5217\u304c\u4e0d\u4e00\u81f4 {\n        name++\n    }\n  \n    // LMS\u90e8\u5206\u6587\u5b57\u5217\u306e\u958b\u59cb\u4f4d\u7f6e\u9806\u306b\u9806\u5e8f\u756a\u53f7\u3092\u683c\u7d0d\n    Names[LMSSubstrings[i]/2] = name\n}\n\n// Names\u306e\u672a\u8a2d\u5b9a\u90e8\u5206\u306f\u53d6\u308a\u9664\u304f\n```\n\n\u3053\u306e\u3068\u304d\u3001\u9806\u5e8f\u756a\u53f7\u3092\u683c\u7d0d\u3059\u308b\u914d\u5217(Names)\u306e\u9577\u3055\u306f\u3001\u5143\u306e\u6587\u5b57\u5217\u306e1/2\u3067\u8db3\u308a\u307e\u3059\uff08\u9577\u3055\u304c\u6700\u5927\u306b\u306a\u308b\u5834\u5408\u306f\u3001L-Type\u3068S-Type\u304c\u4ea4\u4e92\u306b\u51fa\u73fe\u3059\u308b\u6587\u5b57\u5217\u306e\u305f\u3081\uff09\u3002\u5143\u306e\u6587\u5b57\u5217\u3088\u308a\u9577\u3055\u304c\u5c0f\u3055\u304f\u306a\u308b\u305f\u3081\u30012.2\u3067\u518d\u5e30\u547c\u3073\u51fa\u3057\u3092\u884c\u3063\u3066\u3082\u3044\u305a\u308c\u505c\u6b62\u3057\u307e\u3059\u3002\n\n**\u4f8b**\n\n> \u307e\u305a\u30bd\u30fc\u30c8\u6e08\u307f\u306eLMS\u90e8\u5206\u6587\u5b57\u5217\u306b\u5bfe\u3057\u3066\u9806\u5e8f\u756a\u53f7\u3092\u63a1\u756a\u3057\u307e\u3059\u3002\n> \n> \n> |LMS\u90e8\u5206\u6587\u5b57\u5217\u306e\u958b\u59cb\u4f4d\u7f6e|15 |13 |3  |10 |6  |\n> |-----------------------|:-:|:-:|:-:|:-:|:-:|\n> |LMS\u90e8\u5206\u6587\u5b57\u5217          |$  |ab$|abca|abca|abdda|\n> |\u9806\u5e8f\u756a\u53f7               |0  |1  |2  |2  |3  |\n> \n> \n> \"abca\"\u306f\u540c\u3058\u6587\u5b57\u5217\u30672\u56de\u767b\u5834\u3057\u3066\u3044\u308b\u305f\u3081\u3001\u540c\u3058\u9806\u5e8f\u756a\u53f7\u304c\u5272\u308a\u5f53\u305f\u308a\u307e\u3059\u3002\u3082\u3057\u3059\u3079\u3066\u3066\u7570\u306a\u308b\u9806\u5e8f\u756a\u53f7\u304c\u5272\u308a\u5f53\u305f\u308c\u3070\u300c3. S-Type\u3001L-Type\u306e\u63a5\u5c3e\u8f9e\u306e\u30bd\u30fc\u30c8\u300d\u306b\u9032\u307f\u307e\u3059\u3002\n> \n> \u6b21\u306b\u9806\u5e8f\u756a\u53f7\u3092LMS\u90e8\u5206\u6587\u5b57\u5217\u306e\u958b\u59cb\u4f4d\u7f6e\u9806\u306b\u4e26\u3073\u66ff\u3048\u307e\u3059\u3002\n> \n> |LMS\u90e8\u5206\u6587\u5b57\u5217\u306e\u958b\u59cb\u4f4d\u7f6e|3 |6 |10  |13 |15  |\n> |-----------------------|:-:|:-:|:-:|:-:|:-:|\n> |LMS\u90e8\u5206\u6587\u5b57\u5217          |abca  |abdda|abca|ab$|$|\n> |\u9806\u5e8f\u756a\u53f7               |2  |3  |2  |1  |0  |\n> \n> \n> \u3053\u306e\u51e6\u7406\u306b\u3088\u3063\u3066\u9806\u5e8f\u756a\u53f7\u306e\u914d\u5217[2, 3, 2, 1, 0]\u304c\u53d6\u5f97\u3067\u304d\u307e\u3059\u3002\u9806\u5e8f\u756a\u53f7\u306e\u914d\u5217[2, 3, 2, 1, 0]\u306e\u63a5\u5c3e\u8f9e\u306f\u3001\u6b21\u306e\u3088\u3046\u306bLMS-Type\u306e\u63a5\u5c3e\u8f9e\u3068\u5bfe\u5fdc\u3057\u3066\u3044\u307e\u3059\u3002\n> \n> |No |\u9806\u5e8f\u756a\u53f7\u306e\u914d\u5217\u306e\u63a5\u5c3e\u8f9e|LMS-Type\u306e\u63a5\u5c3e\u8f9e|LMS-Type\u306e\u63a5\u5c3e\u8f9e\u306e\u958b\u59cb\u4f4d\u7f6e|\n> |--:|----------------:|--------------:|-----------------------:|\n> |0  |[2,3,2,1,0]|abcabddabcab$|3 |\n> |1  |[3,2,1,0]  |abddabcab$   |6 |\n> |2  |[2,1,0]    |abcab$       |10|\n> |3  |[1,0]      |ab$          |13|\n> |4  |[0]        |$            |15|\n\n\n#### 2.2. \u9806\u5e8f\u756a\u53f7\u306e\u63a5\u5c3e\u8f9e\u914d\u5217\u3092\u53d6\u5f97\uff08\u518d\u5e30\u547c\u3073\u51fa\u3057\uff09\n\u9806\u5e8f\u756a\u53f7\u306e\u914d\u5217\uff08Names\uff09\u306e\u63a5\u5c3e\u8f9e\u914d\u5217\u306f\u3001LMS-Type\u306e\u63a5\u5c3e\u8f9e\u914d\u5217\u306e\u9806\u5e8f\u3068\u4e00\u81f4\u3057\u307e\u3059\u3002LMS-Type\u306e\u63a5\u5c3e\u8f9e\u914d\u5217\u306f\u3001SAIS\u5168\u4f53\u306e\u518d\u5e30\u547c\u3073\u51fa\u3057\u306b\u3088\u3063\u3066\u53d6\u5f97\u3057\u307e\u3059\u3002\n\n**\u4f8b**\n>\u9806\u5e8f\u756a\u53f7\u306e\u914d\u5217[2, 3, 2, 1, 0]\u306e\u63a5\u5c3e\u8f9e\u914d\u5217\u306f[4, 3, 2, 0, 1]\u3067\u3059\u3002\u5bfe\u5fdc\u3059\u308bLMS-Type\u306e\u63a5\u5c3e\u8f9e\u306f\u6b21\u306e\u3068\u304a\u308a\u3067\u3059\u3002\n>\n>|No |\u9806\u5e8f\u756a\u53f7\u306e\u914d\u5217\u306e\u63a5\u5c3e\u8f9e|LMS-Type\u306e\u63a5\u5c3e\u8f9e|LMS-Type\u306e\u63a5\u5c3e\u8f9e\u306e\u958b\u59cb\u4f4d\u7f6e|\n>|--:|----------------:|--------------:|-----------------------:|\n>|4  |[0]        |$            |15|\n>|3  |[1,0]      |ab$          |13|\n>|2  |[2,1,0]    |abcab$       |10|\n>|0  |[2,3,2,1,0]|abcabddabcab$|3 |\n>|1  |[3,2,1,0]  |abddabcab$   |6 |\n>\n>\u5bfe\u5fdc\u3059\u308bLMS-Type\u306e\u63a5\u5c3e\u8f9e\u304c\u6587\u5b57\u5217\u9806\u306b\u30bd\u30fc\u30c8\u3055\u308c\u307e\u3059\u3002\u3053\u306e\u8868\u306e\u300cLMS-Type\u306e\u63a5\u5c3e\u8f9e\u306e\u958b\u59cb\u4f4d\u7f6e\u300d\u304cLMS-Type\u306e\u63a5\u5c3e\u8f9e\u914d\u5217\uff08\u300c3. S-Type\u3001L-Type\u306e\u63a5\u5c3e\u8f9e\u306e\u30bd\u30fc\u30c8\u300d\u306e\u914d\u5217LMSSA\uff09\u306b\u306a\u308a\u307e\u3059\u3002\n\n---\n### \u307e\u3068\u3081\n\u63a5\u5c3e\u8f9e\u914d\u5217\u3092\u69cb\u7bc9\u3059\u308bSA-IS\u306e\u624b\u9806\u306b\u3064\u3044\u3066\u8aac\u660e\u3057\u307e\u3057\u305f\u3002\u300c1. LMS\u90e8\u5206\u6587\u5b57\u5217\u306e\u30bd\u30fc\u30c8\u300d\u3068\u300c3. S-Type\u3001L-Type\u306e\u63a5\u5c3e\u8f9e\u306e\u30bd\u30fc\u30c8\u300d\u3067\u306f\u3001\u7d50\u679c\u3092\u683c\u7d0d\u3059\u308bSA\u306e\u9818\u57df\u3092\u4f7f\u7528\u3057\u3066\u7701\u30e1\u30e2\u30ea\u5316\u3057\u3066\u3044\u308b\u69d8\u5b50\u304c\u898b\u3048\u305f\u3068\u601d\u3044\u307e\u3059\u3002SA-IS\u306f\u65e5\u672c\u8a9e\u306e\u8aac\u660e\u3082\u591a\u3044\u305f\u3081\u3001\u3053\u3061\u3089\u306e\u5185\u5bb9\u3067\u306f\u3044\u307e\u3044\u3061\u3060\u3063\u305f\u65b9\u306f\u53c2\u8003URL\u3092\u3054\u53c2\u7167\u304f\u3060\u3055\u3044\u3002\n\n## \u53c2\u8003URL\n* [sais(https://sites.google.com/site/yuta256/sais)](https://sites.google.com/site/yuta256/sais)\n* [\u63a5\u5c3e\u8f9e\u914d\u5217\u69cb\u7bc9\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u306e Java 7 \u306b\u3088\u308b\u5b9f\u88c5](https://github.com/hiroshi-cl/sa/wiki)\n* [SA-IS - Shogo Computing Laboratory](http://shogo82148.github.io/homepage/memo/algorithm/suffix-array/sa-is.html)\n* [SAIS(Suffix Array - Induced Sorting) - EchizenBlog-Zwei](http://d.hatena.ne.jp/echizen_tm/20100325/1269533804)\n* [SA-IS: SuffixArray\u7dda\u5f62\u69cb\u7bc9 - sile\u306e\u30d6\u30ed\u30b0](http://sile.hatenablog.jp/entry/20101213/1292190698)\n* [\u30d3\u30fc\u30e0\u306e\u5831\u544a\u66f8: Suffix Array \u3092\u4f5c\u308b - SA-IS \u306e\u5b9f\u88c5](http://blog.beam2d.net/2011/08/suffix-array-sa-is.html)\n* [SA-IS - (iwi) \uff5b \u53cd\u7701\u3057\u307e\u3059 - TopCoder\u90e8](http://topcoder.g.hatena.ne.jp/iwiwi/20110720/1311168147)\n* [\u63a5\u5c3e\u8f9e\u914d\u5217(Suffix Array)\u306e\u52b9\u7387\u7684\u306a\u5b9f\u88c5\u624b\u6cd5\u306b\u3064\u3044\u3066 - xxxxxeeeee\u306e\u65e5\u8a18](http://d.hatena.ne.jp/xxxxxeeeee/20110810/1312996441)\n* [\u9ad8\u901f\u6587\u5b57\u5217\u89e3\u6790\u306e\u4e16\u754c](https://sites.google.com/site/daisukeokanohara/iwanami_string_world)\n\n---\n\n# [Go\u8a00\u8a9e\u5165\u9580](https://www.amazon.co.jp/dp/4865940413)\nGo\u8a00\u8a9e\u5165\u9580\u3068\u3044\u3046\u30bf\u30a4\u30c8\u30eb\u306e\u672c\u3092\u57f7\u7b46\u3057\u307e\u3057\u305f\u3002\u305d\u306e\u540d\u306e\u901a\u308aGo\u8a00\u8a9e\u306e\u5165\u9580\u66f8\u3067\u3059\u3002\u5f8c\u534a\u306fRaspberry Pi\u3092\u4f7f\u3063\u305fLED\u3092\u70b9\u6ec5\u3084\u6e29\u5ea6\u30c7\u30fc\u30bf\u306e\u53ce\u96c6\u306a\u3069\u3082\u8a18\u8f09\u3057\u3066\u3044\u307e\u3059\u3002go-sais\u306e\u5b9f\u88c5\u306e\u6587\u6cd5\u90e8\u5206\u306f\u3001\u3053\u306e\u5165\u9580\u66f8\u306e\u5185\u5bb9\u3067\u7406\u89e3\u3067\u304d\u308b\u3068\u601d\u3044\u307e\u3059\uff08\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u81ea\u4f53\u306e\u7406\u89e3\u306f\u307e\u305f\u5225\u306b\u5fc5\u8981\u3067\u3059\u304c\u3002\u3002\uff09\n", "tags": ["Go", "golang", "\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0"]}