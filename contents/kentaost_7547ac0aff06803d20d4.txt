{"context": " More than 1 year has passed since last update.\n\n\u6982\u8981\nEC2\u4e0a\u306eLinux\u306fkdump\u304c\u4f7f\u3048\u306a\u3044\u305f\u3081\u3001crash dump\u89e3\u6790\u304c\u3067\u304d\u306a\u3044\u3002\n\u305b\u3081\u3066kernel panic\u6642\u306e\u30ab\u30fc\u30cd\u30eb\u30ed\u30b0\u3050\u3089\u3044\u306f\u4f55\u3068\u304b\u53d6\u5f97\u3067\u304d\u306a\u3044\u3082\u306e\u304b\u3068\u8003\u3048\u3066\u8a66\u884c\u932f\u8aa4\u3057\u305f\u3068\u3053\u308d\u3001netconsole\u3092\u4f7f\u3046\u3053\u3068\u3067stack trace\u304c\u53d6\u5f97\u3067\u304d\u308b\u3053\u3068\u304c\u308f\u304b\u3063\u305f\u3002\n\n\u52d5\u4f5c\u691c\u8a3c\n\u4eca\u56de\u306fEC2(\u6700\u65b0\u306eAmazonLinux)\u3092\u7528\u3044\u3066\u691c\u8a3c\u3057\u305f(\u540c\u4e00VPC\u3067\u540c\u4e00\u30b5\u30d6\u30cd\u30c3\u30c8\u5185\u306e2\u3064\u306e\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u9593\u3067\u5b9f\u65bd)\u3002netconsole\u304c\u5c0e\u5165\u3067\u304d\u3070\u4ed6\u306e\u30c7\u30a3\u30b9\u30c8\u30ea\u30d3\u30e5\u30fc\u30b7\u30e7\u30f3\u3067\u3082\u5b9f\u884c\u3067\u304d\u308b\u306e\u3067\u306f\u306a\u304b\u308d\u3046\u304b\u3002\n\n(\u53d7\u4fe1\u5074)kernel panic\u6642\u306e\u30ab\u30fc\u30cd\u30eb\u30ed\u30b0\u304c\u9001\u3089\u308c\u3066\u304f\u308b\u304b\u78ba\u8a8d\u3059\u308b\u305f\u3081\u306b\u3001listen\u30e2\u30fc\u30c9\u3067nc\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3057\u3066\u5f85\u6a5f\u3059\u308b\n$nc -u -l [destination port]\n\n\n(\u9001\u4fe1\u5074)netconsole\u3092\u8a2d\u5b9a\u3059\u308b\n#modprobe netconsole netconsole=[source port]@[source ip]/eth0,[destination port]@[destination ip]/[MAC address]\n#dmesg\n\n(\u7565)\n[16170.226317] netpoll: netconsole: local port [source port]\n[16170.229153] netpoll: netconsole: local IPv4 address [source ip]\n[16170.232371] netpoll: netconsole: interface 'eth0'\n[16170.234837] netpoll: netconsole: remote port [destination port]\n[16170.237250] netpoll: netconsole: remote IPv4 address [destination ip]\n[16170.240764] netpoll: netconsole: remote ethernet address [MAC address]\n[16170.244360] console [netcon0] enabled\n[16170.246398] netconsole: network logging started\n\n\n(\u9001\u4fe1\u5074)sysrq\u3092\u4f7f\u3063\u3066crash\u3055\u305b\u308b\n#echo 1 > /proc/sys/kernel/sysrq\n#echo c > /proc/sysrq-trigger\n\n\n(\u53d7\u4fe1\u5074)\u53d7\u4fe1\u5074\u3067\u9001\u4fe1\u5074kernel panic\u767a\u751f\u6642\u306b\u51fa\u529b\u3055\u308c\u308b\u30e1\u30c3\u30bb\u30fc\u30b8\u304c\u898b\u308c\u308b\u304b\u78ba\u8a8d\u3059\u308b\n$nc -u -l [destination port]\n\n[16248.310268] SysRq : Trigger a crash\n[16248.312360] BUG: unable to handle kernel NULL pointer dereference at           (null)\n[16248.314138] IP: [<ffffffff81328256>] sysrq_handle_crash+0x16/0x20\n[16248.314138] PGD 3b7a1067 PUD 3b7a0067 PMD 0\n[16248.314138] Oops: 0002 [#1] SMP\n[16248.314138] Modules linked in: netconsole ipv6 binfmt_misc evbug evdev psmouse i2c_piix4 button i2c_core ext4 crc16 jbd2 mbcache dm_mirror dm_region_hash dm_log dm_mod\n[16248.314138] CPU: 0 PID: 2633 Comm: bash Not tainted 3.14.27-25.47.amzn1.x86_64 #1\n[16248.314138] Hardware name: Xen HVM domU, BIOS 4.2.amazon 12/03/2014\n[16248.314138] task: ffff88003b3732a0 ti: ffff88003b22e000 task.ti: ffff88003b22e000\n[16248.314138] RIP: 0010:[<ffffffff81328256>]  [<ffffffff81328256>] sysrq_handle_crash+0x16/0x20\n[16248.314138] RSP: 0018:ffff88003b22fe88  EFLAGS: 00010082\n[16248.314138] RAX: 000000000000000f RBX: ffffffff81a92380 RCX: 0000000000000000\n[16248.314138] RDX: ffff88003fc0ea78 RSI: ffff88003fc0d148 RDI: 0000000000000063\n[16248.314138] RBP: ffff88003b22fe88 R08: 0000000000000096 R09: 0000000000000186\n[16248.314138] R10: 0000000000000185 R11: 0000000000000003 R12: 0000000000000002\n[16248.314138] R13: 0000000000000063 R14: 0000000000000246 R15: 0000000000000008\n[16248.314138] FS:  00007f5a9bbb0700(0000) GS:ffff88003fc00000(0000) knlGS:0000000000000000\n[16248.314138] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033\n[16248.314138] CR2: 0000000000000000 CR3: 000000003d63e000 CR4: 00000000001406f0\n[16248.314138] Stack:\n[16248.314138]  ffff88003b22fec0 ffffffff81328a08 0000000000000002 00007f5a9bbb7000\n[16248.314138]  ffff88003b22ff50 0000000000000002 0000000001b9ed00 ffff88003b22fed8\n[16248.314138]  ffffffff81328eb2 ffff88003b32eb40 ffff88003b22fef8 ffffffff8120abfd\n[16248.314138] Call Trace:\n[16248.314138]  [<ffffffff81328a08>] __handle_sysrq+0x138/0x1a0\n[16248.314138]  [<ffffffff81328eb2>] write_sysrq_trigger+0x32/0x40\n[16248.314138]  [<ffffffff8120abfd>] proc_reg_write+0x3d/0x80\n[16248.314138]  [<ffffffff811a67fa>] vfs_write+0xba/0x1e0\n[16248.314138]  [<ffffffff811a71e6>] SyS_write+0x46/0xb0\n[16248.314138]  [<ffffffff810e9e86>] ? __audit_syscall_exit+0x236/0x2e0\n[16248.314138]  [<ffffffff81495269>] system_call_fastpath+0x16/0x1b\n[16248.314138] Code: 65 34 75 e5 4c 89 ef e8 f9 f7 ff ff eb db 0f 1f 80 00 00 00 00 0f 1f 44 00 00 55 c7 05 74 85 90 00 01 00 00 00 48 89 e5 0f ae f8 <c6> 04 25 00 00 00 00 01 5d c3 0f 1f 44 00 00 55 31 c0 c7 05 7e\n[16248.314138] RIP  [<ffffffff81328256>] sysrq_handle_crash+0x16/0x20\n[16248.314138]  RSP <ffff88003b22fe88>\n[16248.314138] CR2: 0000000000000000\n[16248.314138] ---[ end trace a7b90b5075702d43 ]---\n[16248.314138] Kernel panic - not syncing: Fatal exception\n\n\u304a\u304a\uff01\uff01\u898b\u308c\u307e\u3057\u305f\u306d\u3002\u3053\u308c\u3067\u3068\u308a\u3042\u3048\u305akernel panic\u767a\u751f\u6642\u306estack trace\u3050\u3089\u3044\u306f\u78ba\u8a8d\u304c\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3057\u305f\u3002\n\n\u307e\u3068\u3081\n\u4eca\u56de\u306e\u52d5\u4f5c\u691c\u8a3c\u3067\u306fnc\u3092\u4f7f\u3063\u3066\u30ab\u30fc\u30cd\u30eb\u30ed\u30b0\u306e\u8ee2\u9001\u304c\u53ef\u80fd\u3067\u3042\u308b\u304b\u78ba\u8a8d\u3057\u305f\u304c\u3001\u53d7\u4fe1\u5074\u3067syslog\u306e\u8a2d\u5b9a\u3092\u3057\u3066\u304a\u304f\u3053\u3068\u3067crash\u3057\u305f\u969b\u306b\u9001\u3089\u308c\u3066\u304f\u308b\u60c5\u5831\u3092\u7ba1\u7406\u3067\u304d\u305d\u3046\u3002\u307e\u305fpanic_on_oops=1\u3057\u3066\u3044\u308c\u3070oops\u304b\u3089\u306ekernel panic\u767a\u751f\u6642\u3067\u3082\u53d6\u5f97\u3067\u304d\u308b\u3002\nEC2\u4e0a\u306eLinux\u74b0\u5883\u3067\u306f\u3001kernel panic\u6642\u306e\u30c0\u30f3\u30d7\u3068\u3063\u3066\u306e\u969c\u5bb3\u89e3\u6790\u3092\u8ae6\u3081\u305d\u3046\u306a\u3068\u3053\u308d\u3060\u3063\u305f\u306e\u3067\u3053\u308c\u3060\u3051\u3067\u3082\u6551\u308f\u308c\u305f\u6c17\u6301\u3061\u306b\u306a\u3063\u3066\u3044\u308b\u3002\n\n##\u6982\u8981\nEC2\u4e0a\u306eLinux\u306fkdump\u304c\u4f7f\u3048\u306a\u3044\u305f\u3081\u3001crash dump\u89e3\u6790\u304c\u3067\u304d\u306a\u3044\u3002\n\u305b\u3081\u3066kernel panic\u6642\u306e\u30ab\u30fc\u30cd\u30eb\u30ed\u30b0\u3050\u3089\u3044\u306f\u4f55\u3068\u304b\u53d6\u5f97\u3067\u304d\u306a\u3044\u3082\u306e\u304b\u3068\u8003\u3048\u3066\u8a66\u884c\u932f\u8aa4\u3057\u305f\u3068\u3053\u308d\u3001netconsole\u3092\u4f7f\u3046\u3053\u3068\u3067stack trace\u304c\u53d6\u5f97\u3067\u304d\u308b\u3053\u3068\u304c\u308f\u304b\u3063\u305f\u3002\n\n\n##\u52d5\u4f5c\u691c\u8a3c\n\u4eca\u56de\u306fEC2(\u6700\u65b0\u306eAmazonLinux)\u3092\u7528\u3044\u3066\u691c\u8a3c\u3057\u305f(\u540c\u4e00VPC\u3067\u540c\u4e00\u30b5\u30d6\u30cd\u30c3\u30c8\u5185\u306e2\u3064\u306e\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u9593\u3067\u5b9f\u65bd)\u3002netconsole\u304c\u5c0e\u5165\u3067\u304d\u3070\u4ed6\u306e\u30c7\u30a3\u30b9\u30c8\u30ea\u30d3\u30e5\u30fc\u30b7\u30e7\u30f3\u3067\u3082\u5b9f\u884c\u3067\u304d\u308b\u306e\u3067\u306f\u306a\u304b\u308d\u3046\u304b\u3002\n\n###(\u53d7\u4fe1\u5074)kernel panic\u6642\u306e\u30ab\u30fc\u30cd\u30eb\u30ed\u30b0\u304c\u9001\u3089\u308c\u3066\u304f\u308b\u304b\u78ba\u8a8d\u3059\u308b\u305f\u3081\u306b\u3001listen\u30e2\u30fc\u30c9\u3067nc\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3057\u3066\u5f85\u6a5f\u3059\u308b\n```bash\n$nc -u -l [destination port]\n```\n\n###(\u9001\u4fe1\u5074)netconsole\u3092\u8a2d\u5b9a\u3059\u308b\n```bash\n#modprobe netconsole netconsole=[source port]@[source ip]/eth0,[destination port]@[destination ip]/[MAC address]\n#dmesg\n```\n```\n(\u7565)\n[16170.226317] netpoll: netconsole: local port [source port]\n[16170.229153] netpoll: netconsole: local IPv4 address [source ip]\n[16170.232371] netpoll: netconsole: interface 'eth0'\n[16170.234837] netpoll: netconsole: remote port [destination port]\n[16170.237250] netpoll: netconsole: remote IPv4 address [destination ip]\n[16170.240764] netpoll: netconsole: remote ethernet address [MAC address]\n[16170.244360] console [netcon0] enabled\n[16170.246398] netconsole: network logging started\n```\n\n###(\u9001\u4fe1\u5074)sysrq\u3092\u4f7f\u3063\u3066crash\u3055\u305b\u308b\n```bash\n#echo 1 > /proc/sys/kernel/sysrq\n#echo c > /proc/sysrq-trigger\n```\n\n###(\u53d7\u4fe1\u5074)\u53d7\u4fe1\u5074\u3067\u9001\u4fe1\u5074kernel panic\u767a\u751f\u6642\u306b\u51fa\u529b\u3055\u308c\u308b\u30e1\u30c3\u30bb\u30fc\u30b8\u304c\u898b\u308c\u308b\u304b\u78ba\u8a8d\u3059\u308b\n```bash\n$nc -u -l [destination port]\n```\n```\n[16248.310268] SysRq : Trigger a crash\n[16248.312360] BUG: unable to handle kernel NULL pointer dereference at           (null)\n[16248.314138] IP: [<ffffffff81328256>] sysrq_handle_crash+0x16/0x20\n[16248.314138] PGD 3b7a1067 PUD 3b7a0067 PMD 0\n[16248.314138] Oops: 0002 [#1] SMP\n[16248.314138] Modules linked in: netconsole ipv6 binfmt_misc evbug evdev psmouse i2c_piix4 button i2c_core ext4 crc16 jbd2 mbcache dm_mirror dm_region_hash dm_log dm_mod\n[16248.314138] CPU: 0 PID: 2633 Comm: bash Not tainted 3.14.27-25.47.amzn1.x86_64 #1\n[16248.314138] Hardware name: Xen HVM domU, BIOS 4.2.amazon 12/03/2014\n[16248.314138] task: ffff88003b3732a0 ti: ffff88003b22e000 task.ti: ffff88003b22e000\n[16248.314138] RIP: 0010:[<ffffffff81328256>]  [<ffffffff81328256>] sysrq_handle_crash+0x16/0x20\n[16248.314138] RSP: 0018:ffff88003b22fe88  EFLAGS: 00010082\n[16248.314138] RAX: 000000000000000f RBX: ffffffff81a92380 RCX: 0000000000000000\n[16248.314138] RDX: ffff88003fc0ea78 RSI: ffff88003fc0d148 RDI: 0000000000000063\n[16248.314138] RBP: ffff88003b22fe88 R08: 0000000000000096 R09: 0000000000000186\n[16248.314138] R10: 0000000000000185 R11: 0000000000000003 R12: 0000000000000002\n[16248.314138] R13: 0000000000000063 R14: 0000000000000246 R15: 0000000000000008\n[16248.314138] FS:  00007f5a9bbb0700(0000) GS:ffff88003fc00000(0000) knlGS:0000000000000000\n[16248.314138] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033\n[16248.314138] CR2: 0000000000000000 CR3: 000000003d63e000 CR4: 00000000001406f0\n[16248.314138] Stack:\n[16248.314138]  ffff88003b22fec0 ffffffff81328a08 0000000000000002 00007f5a9bbb7000\n[16248.314138]  ffff88003b22ff50 0000000000000002 0000000001b9ed00 ffff88003b22fed8\n[16248.314138]  ffffffff81328eb2 ffff88003b32eb40 ffff88003b22fef8 ffffffff8120abfd\n[16248.314138] Call Trace:\n[16248.314138]  [<ffffffff81328a08>] __handle_sysrq+0x138/0x1a0\n[16248.314138]  [<ffffffff81328eb2>] write_sysrq_trigger+0x32/0x40\n[16248.314138]  [<ffffffff8120abfd>] proc_reg_write+0x3d/0x80\n[16248.314138]  [<ffffffff811a67fa>] vfs_write+0xba/0x1e0\n[16248.314138]  [<ffffffff811a71e6>] SyS_write+0x46/0xb0\n[16248.314138]  [<ffffffff810e9e86>] ? __audit_syscall_exit+0x236/0x2e0\n[16248.314138]  [<ffffffff81495269>] system_call_fastpath+0x16/0x1b\n[16248.314138] Code: 65 34 75 e5 4c 89 ef e8 f9 f7 ff ff eb db 0f 1f 80 00 00 00 00 0f 1f 44 00 00 55 c7 05 74 85 90 00 01 00 00 00 48 89 e5 0f ae f8 <c6> 04 25 00 00 00 00 01 5d c3 0f 1f 44 00 00 55 31 c0 c7 05 7e\n[16248.314138] RIP  [<ffffffff81328256>] sysrq_handle_crash+0x16/0x20\n[16248.314138]  RSP <ffff88003b22fe88>\n[16248.314138] CR2: 0000000000000000\n[16248.314138] ---[ end trace a7b90b5075702d43 ]---\n[16248.314138] Kernel panic - not syncing: Fatal exception\n```\n\n\u304a\u304a\uff01\uff01\u898b\u308c\u307e\u3057\u305f\u306d\u3002\u3053\u308c\u3067\u3068\u308a\u3042\u3048\u305akernel panic\u767a\u751f\u6642\u306estack trace\u3050\u3089\u3044\u306f\u78ba\u8a8d\u304c\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3057\u305f\u3002\n\n##\u307e\u3068\u3081\n\u4eca\u56de\u306e\u52d5\u4f5c\u691c\u8a3c\u3067\u306fnc\u3092\u4f7f\u3063\u3066\u30ab\u30fc\u30cd\u30eb\u30ed\u30b0\u306e\u8ee2\u9001\u304c\u53ef\u80fd\u3067\u3042\u308b\u304b\u78ba\u8a8d\u3057\u305f\u304c\u3001\u53d7\u4fe1\u5074\u3067syslog\u306e\u8a2d\u5b9a\u3092\u3057\u3066\u304a\u304f\u3053\u3068\u3067crash\u3057\u305f\u969b\u306b\u9001\u3089\u308c\u3066\u304f\u308b\u60c5\u5831\u3092\u7ba1\u7406\u3067\u304d\u305d\u3046\u3002\u307e\u305fpanic_on_oops=1\u3057\u3066\u3044\u308c\u3070oops\u304b\u3089\u306ekernel panic\u767a\u751f\u6642\u3067\u3082\u53d6\u5f97\u3067\u304d\u308b\u3002\n\nEC2\u4e0a\u306eLinux\u74b0\u5883\u3067\u306f\u3001kernel panic\u6642\u306e\u30c0\u30f3\u30d7\u3068\u3063\u3066\u306e\u969c\u5bb3\u89e3\u6790\u3092\u8ae6\u3081\u305d\u3046\u306a\u3068\u3053\u308d\u3060\u3063\u305f\u306e\u3067\u3053\u308c\u3060\u3051\u3067\u3082\u6551\u308f\u308c\u305f\u6c17\u6301\u3061\u306b\u306a\u3063\u3066\u3044\u308b\u3002\n", "tags": ["EC2", "kernel", "AmazonLinux", "Linux", "AWS"]}