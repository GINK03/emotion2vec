{"context": " More than 1 year has passed since last update.\u30ec\u30b7\u30d4\u3067\u3059\u3002\n\u203bsetup\u30bf\u30b9\u30af\u306f\u3001\u968f\u6642\u5909\u66f4\u3057\u3066\u304f\u3060\u3055\u3044\u3002\nset_default(:conf_file) { \"/etc/td-agent/td-agent.conf\" }\n\nnamespace :td_agent do\n  desc \"start td-agent\"\n  task :start,  roles: :web do\n    run \"#{sudo} /etc/init.d/td-agent start\"\n  end\n\n  desc \"stop td-agent\"\n  task :stop,  roles: :web do\n    run \"#{sudo} /etc/init.d/td-agent stop\"\n  end\n\n  desc \"restart td-agent\"\n  task :restart,  roles: :web do\n    run \"#{sudo} /etc/init.d/td-agent restart\"\n  end\n\n  desc \"reload the config file\"\n  task :reload, roles: :web do\n    run \"#{sudo} /etc/init.d/td-agent reload\"\n  end\n\n  desc \"install td-agent by yum\"\n  task :install, roles: :web do\n    run \"#{sudo} yum -y install td-agent\"\n    run \"#{sudo} /usr/lib64/fluent/ruby/bin/fluent-gem install fluent-plugin-forest\"\n    run \"#{sudo} /usr/lib64/fluent/ruby/bin/fluent-gem install fluent-plugin-tail-ex\"\n  end\n\n  desc \"setup config files and log files\"\n  task :setup, roles: :web do\n    run \"#{sudo} mkdir -p /var/log/fluent\"\n    run \"#{sudo} chgrp td-agent /var/log/fluent\"\n    run \"#{sudo} chown td-agent /var/log/fluent\"\n    run \"#{sudo} chmod +x /etc/td-agent\"\n    run \"#{sudo} chmod o+w #{conf_file}\"\n    template(\"td_agent.erb\", conf_file)\n  end\n\n  namespace :log do\n    task :tail, roles: :web do\n      run \"#{sudo} tail -f /var/log/td-agent/td-agent.log\"\n    end\n  end\nend\n\nafter \"deploy:install\", \"td_agent:install\"\nafter \"deploy:install\", \"td_agent:setup\"\nafter \"deploy:cleanup\", \"td_agent:restart\"\n\n\n\u30ec\u30b7\u30d4\u3067\u3059\u3002\n\n\u203bsetup\u30bf\u30b9\u30af\u306f\u3001\u968f\u6642\u5909\u66f4\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n```\nset_default(:conf_file) { \"/etc/td-agent/td-agent.conf\" }\n\nnamespace :td_agent do\n  desc \"start td-agent\"\n  task :start,  roles: :web do\n    run \"#{sudo} /etc/init.d/td-agent start\"\n  end\n\n  desc \"stop td-agent\"\n  task :stop,  roles: :web do\n    run \"#{sudo} /etc/init.d/td-agent stop\"\n  end\n\n  desc \"restart td-agent\"\n  task :restart,  roles: :web do\n    run \"#{sudo} /etc/init.d/td-agent restart\"\n  end\n\n  desc \"reload the config file\"\n  task :reload, roles: :web do\n    run \"#{sudo} /etc/init.d/td-agent reload\"\n  end\n\n  desc \"install td-agent by yum\"\n  task :install, roles: :web do\n    run \"#{sudo} yum -y install td-agent\"\n    run \"#{sudo} /usr/lib64/fluent/ruby/bin/fluent-gem install fluent-plugin-forest\"\n    run \"#{sudo} /usr/lib64/fluent/ruby/bin/fluent-gem install fluent-plugin-tail-ex\"\n  end\n\n  desc \"setup config files and log files\"\n  task :setup, roles: :web do\n    run \"#{sudo} mkdir -p /var/log/fluent\"\n    run \"#{sudo} chgrp td-agent /var/log/fluent\"\n    run \"#{sudo} chown td-agent /var/log/fluent\"\n    run \"#{sudo} chmod +x /etc/td-agent\"\n    run \"#{sudo} chmod o+w #{conf_file}\"\n    template(\"td_agent.erb\", conf_file)\n  end\n\n  namespace :log do\n    task :tail, roles: :web do\n      run \"#{sudo} tail -f /var/log/td-agent/td-agent.log\"\n    end\n  end\nend\n\nafter \"deploy:install\", \"td_agent:install\"\nafter \"deploy:install\", \"td_agent:setup\"\nafter \"deploy:cleanup\", \"td_agent:restart\"\n```\n\n", "tags": ["capistrano", "Rails", "td-agent", "fluentd"]}