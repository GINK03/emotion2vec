{"tags": [".NET", "C#"], "context": " More than 1 year has passed since last update..NET\u3067Markdown\u30a8\u30c7\u30a3\u30bf\u3092\u4f5c\u308b\u5834\u5408\u3001HTML\u306b\u5909\u63db\u3059\u308b\u90e8\u5206\u306b\u306fMarkdownSharp\u3084MarkdownDeep\u3092NuGet\u3067\u53d6\u5f97\u3057\u3066\u4f7f\u3046\u306e\u304c\u4e00\u756a\u624b\u3063\u53d6\u308a\u65e9\u3044\u3068\u601d\u3044\u307e\u3059\u3002\n\u305f\u3060\u3001\u3053\u308c\u3089\u306e\u30e9\u30a4\u30d6\u30e9\u30ea\u3060\u3068GitHub Flavored Markdown(GFM)\u306e\u8a18\u6cd5\u306b\u5bfe\u5fdc\u3057\u304d\u308c\u307e\u305b\u3093\u3002\n\u7279\u306b\u30d0\u30c3\u30af\u30af\u30aa\u30fc\u30c8\u3092\u4f7f\u3063\u305f\u30b3\u30fc\u30c9\u90e8\u5206\u306e\u8a18\u8ff0\u306b\u306f\u3001\u5148\u306b\u6319\u3052\u305f\u4e8c\u3064\u306f\u5bfe\u5fdc\u3057\u3066\u306a\u3044\u3067\u3059\u3002\nJavaScript\u754c\u9688\u3067\u306fGFM\u306b\u5bfe\u5fdc\u3057\u305f\u30e9\u30a4\u30d6\u30e9\u30ea\u304c\u7d50\u69cb\u3042\u308b\u306a\u3041\u3001\u3068\u3044\u3046\u3053\u3068\u3067\u3001\u305d\u306e\u4e2d\u3067\u3082\u3088\u3055\u3052\u306amarked.js\u3092.NET\u304b\u3089\u4f7f\u3063\u3066\u307f\u3088\u3046\u3068\u601d\u3044\u307e\u3059\u3002\n\nClearScript\u3068marked.js\u3092NuGet\u3067\u53d6\u5f97\u3059\u308b\nClearScript\u3092\u4f7f\u3046\u3068\u3001JavaScript\u306eAPI\u3092.NET\u304b\u3089\u305f\u305f\u304f\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\nClearScript\u306e\u6982\u8981\u306b\u3064\u3044\u3066\u306f\u3053\u3061\u3089\u306e\u8a18\u4e8b\u304c\u8a73\u3057\u3044\u3067\u3059\u3002\nNuGet\u304b\u3089\u3001JavaScriptEngine.V8\u3068marked.js\u3092\u53d6\u5f97\u3057\u307e\u3059\u3002\nPM> Install-Package JavaScriptEngineSwitcher.V8\nPM> Install-Package marked\n\nmarked.js\u306fScripts\u30d5\u30a9\u30eb\u30c0\u4ee5\u4e0b\u306b\u914d\u7f6e\u3055\u308c\u307e\u3059\u3002\nmarked.js\u306e\u30d7\u30ed\u30d1\u30c6\u30a3\u3067\u3001\u30d3\u30eb\u30c9\u30a2\u30af\u30b7\u30e7\u30f3\u3092\u300c\u57cb\u3081\u8fbc\u307e\u308c\u305f\u30ea\u30bd\u30fc\u30b9\u300d\u306b\u5909\u66f4\u3057\u307e\u3059\u3002\n\n\nMarkdown\u30d1\u30fc\u30b5\u30fc\u3092\u5b9f\u88c5\u3059\u308b\npublic class MarkdownParser : IDisposable\n{\n    private IJsEngine _jsEngine;\n    private bool _disposed;\n\n    public MarkdownParser(IJsEngine jsEngine)\n    {\n        if (jsEngine == null) throw new ArgumentNullException(\"jsEngine\");\n\n        _jsEngine = jsEngine;\n        _jsEngine.ExecuteResource(\"\u65e2\u5b9a\u306e\u540d\u524d\u7a7a\u9593.Scripts.marked.js\", GetType());\n    }\n\n    public string Transform(string markdown)\n    {\n        return _jsEngine.CallFunction<string>(\"marked\", markdown);\n    }\n\n    public void Dispose()\n    {\n        if (_disposed) return;\n        _disposed = true;\n\n        if (_jsEngine == null) return;\n        _jsEngine.Dispose();\n        _jsEngine = null;\n    }\n}\n\n_jsEngine.ExecuteResource(\"\u65e2\u5b9a\u306e\u540d\u524d\u7a7a\u9593.Scripts.marked.js\", GetType());\n\u30b3\u30f3\u30b9\u30c8\u30e9\u30af\u30bf\u306e\u3053\u306e\u90e8\u5206\u3067\u3001JavaScript\u30a8\u30f3\u30b8\u30f3\u306bJavaScript\u3092\u8aad\u307f\u8fbc\u307e\u305b\u307e\u3059\u3002\n\u57cb\u3081\u8fbc\u307e\u308c\u305f\u30ea\u30bd\u30fc\u30b9\u3078\u306e\u30d1\u30b9\u306f\u3001\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306e\u65e2\u5b9a\u306e\u540d\u524d\u7a7a\u9593\uff0b\u76f8\u5bfe\u30d1\u30b9\u306a\u306e\u3067\u3001\u9069\u5b9c\u5909\u66f4\u3002\npublic string Transform(string markdown)\n{\n    return _jsEngine.CallFunction<string>(\"marked\", markdown);\n}\n\n\u3042\u3068\u306f\u3001CallFunction\u30e1\u30bd\u30c3\u30c9\u306b\u3001marked.js\u306e\u95a2\u6570\u3068\u3001\u5909\u63db\u5bfe\u8c61\u306eMarkdown\u30c6\u30ad\u30b9\u30c8\u3092\u6e21\u3057\u3066\u3042\u3052\u308b\u3060\u3051\u3067\u3059\u3002\n\u30d1\u30fc\u30b5\u30fc\u306e\u5b9f\u88c5\u306f\u3053\u308c\u3060\u3051\u3002\n\n\u5b9f\u884c\u3059\u308b\n\u30b3\u30f3\u30bd\u30fc\u30eb\u30a2\u30d7\u30ea\u3067\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u30b3\u30fc\u30c9\u3092\u5b9f\u884c\u3059\u308b\u3068\nclass Program\n{\n    static void Main()\n    {\n        const string markdown = @\"\n    ```cs\n    public class Foo\n    {\n        public string Bar { get; set; }\n\n        public string Buz()\n        {\n            return Bar;\n        }\n    }\n    ```\n\";\n\n        var parser = new MarkdownParser(new V8JsEngine());\n\n        var html = parser.Transform(markdown);\n\n        Console.WriteLine(html);\n        Console.ReadLine();\n    }\n}\n\n\n\u3061\u3083\u3093\u3068HTML\u306b\u5909\u63db\u3055\u308c\u307e\u3057\u305f\u3002\n\u203bconst string markdown\u4ee5\u4e0b\u306e\u90e8\u5206\u306b\u3064\u3044\u3066\u306f\u3001\u8a18\u4e8b\u4e0a\u3067\u300c```\u300d\u3092\u3046\u307e\u304f\u8868\u73fe\u3067\u304d\u306a\u304b\u3063\u305f\u306e\u3067\u3001\u524d\u306b\u30b9\u30da\u30fc\u30b9\u3092\u8a2d\u3051\u3066\u307e\u3059\u304c\u3001\u30b3\u30fc\u30c9\u4e0a\u306f\u30b9\u30da\u30fc\u30b9\u306a\u3057\u3067\u304d\u3061\u3093\u3068\u5909\u63db\u3055\u308c\u307e\u3059\u3002\n\n\u30b5\u30f3\u30d7\u30eb\u30b3\u30fc\u30c9\nGitHub\u306bhighlight.js\u3092\u4f7f\u3063\u3066\u30b7\u30f3\u30bf\u30c3\u30af\u30b9\u30cf\u30a4\u30e9\u30a4\u30c8\u3082\u884c\u3046\u3088\u3046\u306a\u30b5\u30f3\u30d7\u30eb\u3092\u3042\u3052\u3066\u307e\u3059\u3002\n.NET\u3067Markdown\u30a8\u30c7\u30a3\u30bf\u3092\u4f5c\u308b\u5834\u5408\u3001HTML\u306b\u5909\u63db\u3059\u308b\u90e8\u5206\u306b\u306fMarkdownSharp\u3084MarkdownDeep\u3092NuGet\u3067\u53d6\u5f97\u3057\u3066\u4f7f\u3046\u306e\u304c\u4e00\u756a\u624b\u3063\u53d6\u308a\u65e9\u3044\u3068\u601d\u3044\u307e\u3059\u3002\n\u305f\u3060\u3001\u3053\u308c\u3089\u306e\u30e9\u30a4\u30d6\u30e9\u30ea\u3060\u3068[GitHub Flavored Markdown(GFM)](https://help.github.com/articles/github-flavored-markdown/)\u306e\u8a18\u6cd5\u306b\u5bfe\u5fdc\u3057\u304d\u308c\u307e\u305b\u3093\u3002\n\u7279\u306b\u30d0\u30c3\u30af\u30af\u30aa\u30fc\u30c8\u3092\u4f7f\u3063\u305f\u30b3\u30fc\u30c9\u90e8\u5206\u306e\u8a18\u8ff0\u306b\u306f\u3001\u5148\u306b\u6319\u3052\u305f\u4e8c\u3064\u306f\u5bfe\u5fdc\u3057\u3066\u306a\u3044\u3067\u3059\u3002\n\nJavaScript\u754c\u9688\u3067\u306fGFM\u306b\u5bfe\u5fdc\u3057\u305f\u30e9\u30a4\u30d6\u30e9\u30ea\u304c\u7d50\u69cb\u3042\u308b\u306a\u3041\u3001\u3068\u3044\u3046\u3053\u3068\u3067\u3001\u305d\u306e\u4e2d\u3067\u3082\u3088\u3055\u3052\u306a[marked.js](https://github.com/chjj/marked)\u3092.NET\u304b\u3089\u4f7f\u3063\u3066\u307f\u3088\u3046\u3068\u601d\u3044\u307e\u3059\u3002\n\n## ClearScript\u3068marked.js\u3092NuGet\u3067\u53d6\u5f97\u3059\u308b\n[ClearScript](https://clearscript.codeplex.com/)\u3092\u4f7f\u3046\u3068\u3001JavaScript\u306eAPI\u3092.NET\u304b\u3089\u305f\u305f\u304f\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\nClearScript\u306e\u6982\u8981\u306b\u3064\u3044\u3066\u306f[\u3053\u3061\u3089](http://msdn.microsoft.com/ja-jp/magazine/dn781353.aspx)\u306e\u8a18\u4e8b\u304c\u8a73\u3057\u3044\u3067\u3059\u3002\n\nNuGet\u304b\u3089\u3001JavaScriptEngine.V8\u3068marked.js\u3092\u53d6\u5f97\u3057\u307e\u3059\u3002\n\n```\nPM> Install-Package JavaScriptEngineSwitcher.V8\nPM> Install-Package marked\n```\n\nmarked.js\u306fScripts\u30d5\u30a9\u30eb\u30c0\u4ee5\u4e0b\u306b\u914d\u7f6e\u3055\u308c\u307e\u3059\u3002\nmarked.js\u306e\u30d7\u30ed\u30d1\u30c6\u30a3\u3067\u3001\u30d3\u30eb\u30c9\u30a2\u30af\u30b7\u30e7\u30f3\u3092\u300c\u57cb\u3081\u8fbc\u307e\u308c\u305f\u30ea\u30bd\u30fc\u30b9\u300d\u306b\u5909\u66f4\u3057\u307e\u3059\u3002\n\n![markedjsproperty.png](https://qiita-image-store.s3.amazonaws.com/0/18730/94ed9a42-4c9a-9089-cd89-5a68247fa309.png)\n\n## Markdown\u30d1\u30fc\u30b5\u30fc\u3092\u5b9f\u88c5\u3059\u308b\n\n```csharp\npublic class MarkdownParser : IDisposable\n{\n    private IJsEngine _jsEngine;\n    private bool _disposed;\n\n    public MarkdownParser(IJsEngine jsEngine)\n    {\n        if (jsEngine == null) throw new ArgumentNullException(\"jsEngine\");\n\n        _jsEngine = jsEngine;\n        _jsEngine.ExecuteResource(\"\u65e2\u5b9a\u306e\u540d\u524d\u7a7a\u9593.Scripts.marked.js\", GetType());\n    }\n\n    public string Transform(string markdown)\n    {\n        return _jsEngine.CallFunction<string>(\"marked\", markdown);\n    }\n\n    public void Dispose()\n    {\n        if (_disposed) return;\n        _disposed = true;\n\n        if (_jsEngine == null) return;\n        _jsEngine.Dispose();\n        _jsEngine = null;\n    }\n}\n```\n\n`_jsEngine.ExecuteResource(\"\u65e2\u5b9a\u306e\u540d\u524d\u7a7a\u9593.Scripts.marked.js\", GetType());`\n\n\u30b3\u30f3\u30b9\u30c8\u30e9\u30af\u30bf\u306e\u3053\u306e\u90e8\u5206\u3067\u3001JavaScript\u30a8\u30f3\u30b8\u30f3\u306bJavaScript\u3092\u8aad\u307f\u8fbc\u307e\u305b\u307e\u3059\u3002\n\u57cb\u3081\u8fbc\u307e\u308c\u305f\u30ea\u30bd\u30fc\u30b9\u3078\u306e\u30d1\u30b9\u306f\u3001\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306e\u65e2\u5b9a\u306e\u540d\u524d\u7a7a\u9593\uff0b\u76f8\u5bfe\u30d1\u30b9\u306a\u306e\u3067\u3001\u9069\u5b9c\u5909\u66f4\u3002\n\n```csharp\npublic string Transform(string markdown)\n{\n    return _jsEngine.CallFunction<string>(\"marked\", markdown);\n}\n```\n\n\u3042\u3068\u306f\u3001CallFunction<T>\u30e1\u30bd\u30c3\u30c9\u306b\u3001marked.js\u306e\u95a2\u6570\u3068\u3001\u5909\u63db\u5bfe\u8c61\u306eMarkdown\u30c6\u30ad\u30b9\u30c8\u3092\u6e21\u3057\u3066\u3042\u3052\u308b\u3060\u3051\u3067\u3059\u3002\n\u30d1\u30fc\u30b5\u30fc\u306e\u5b9f\u88c5\u306f\u3053\u308c\u3060\u3051\u3002\n\n## \u5b9f\u884c\u3059\u308b\n\u30b3\u30f3\u30bd\u30fc\u30eb\u30a2\u30d7\u30ea\u3067\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u30b3\u30fc\u30c9\u3092\u5b9f\u884c\u3059\u308b\u3068\n\n```csharp\nclass Program\n{\n    static void Main()\n    {\n        const string markdown = @\"\n    ```cs\n    public class Foo\n    {\n        public string Bar { get; set; }\n\n        public string Buz()\n        {\n            return Bar;\n        }\n    }\n    ```\n\";\n\n        var parser = new MarkdownParser(new V8JsEngine());\n\n        var html = parser.Transform(markdown);\n\n        Console.WriteLine(html);\n        Console.ReadLine();\n    }\n}\n```\n\n![markdownparserconsole.png](https://qiita-image-store.s3.amazonaws.com/0/18730/2dca7669-63d2-6592-b2c5-9329a7e7375c.png)\n\n\u3061\u3083\u3093\u3068HTML\u306b\u5909\u63db\u3055\u308c\u307e\u3057\u305f\u3002\n\u203bconst string markdown\u4ee5\u4e0b\u306e\u90e8\u5206\u306b\u3064\u3044\u3066\u306f\u3001\u8a18\u4e8b\u4e0a\u3067\u300c\\```\u300d\u3092\u3046\u307e\u304f\u8868\u73fe\u3067\u304d\u306a\u304b\u3063\u305f\u306e\u3067\u3001\u524d\u306b\u30b9\u30da\u30fc\u30b9\u3092\u8a2d\u3051\u3066\u307e\u3059\u304c\u3001\u30b3\u30fc\u30c9\u4e0a\u306f\u30b9\u30da\u30fc\u30b9\u306a\u3057\u3067\u304d\u3061\u3093\u3068\u5909\u63db\u3055\u308c\u307e\u3059\u3002\n\n## \u30b5\u30f3\u30d7\u30eb\u30b3\u30fc\u30c9\n[GitHub](https://github.com/mad4-red/GFMParserSample.Net)\u306b[highlight.js](https://highlightjs.org/)\u3092\u4f7f\u3063\u3066\u30b7\u30f3\u30bf\u30c3\u30af\u30b9\u30cf\u30a4\u30e9\u30a4\u30c8\u3082\u884c\u3046\u3088\u3046\u306a\u30b5\u30f3\u30d7\u30eb\u3092\u3042\u3052\u3066\u307e\u3059\u3002\n"}