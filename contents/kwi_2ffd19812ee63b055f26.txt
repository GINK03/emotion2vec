{"context": " More than 1 year has passed since last update.wikipedia\u306e\u6280\u8853\u8a73\u7d30\u306b\u306f\u6b21\u306e\u3088\u3046\u306b\u66f8\u3044\u3066\u3042\u308b\u3002\nhcitool -i hci0 cmd 0x08 0x0006 a0 00 a0 00 03 00 00 00 00 00 00 00 00 07 00\n################################## 02 01 06 1a ff 4c 00 02 15  # Apple's fixed iBeacon advertising prefix\nhcitool -i hci0 cmd 0x08 0x0008 1E 02 01 1A 1A FF 4C 00 02 15 FB 0B 57 A2 82 28 44 CD 91 3A 94 A1 22 BA 12 06 00 01 00 02 D1 00\nhcitool -i hci0 cmd 0x08 0x000a 01\n\n\u3053\u308c\u3092\u305f\u3060\u30b3\u30d4\u30fc\u3059\u308b\u3060\u3051\u3067\u306f\u733f\u4e26\u307f\u3060\u2026\u3002\u305b\u3063\u304b\u304f\u306a\u306e\u3067 hcitool \u306e\u5f15\u6570\u3092\u5206\u89e3\u3057\u3066\u3044\u304f\u3002\n\u307e\u305a -i hci0 \u306f\u7279\u306b\u554f\u984c\u306a\u3044\u3002hciconfig\u3067\u898b\u3048\u308b\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9\u4e00\u89a7\u3068\u540c\u3058\u3067\u3001hci0\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9\u306b\u5bfe\u3057\u3066\u64cd\u4f5c\u3092\u884c\u3063\u3066\u3044\u308b\u3002\ncmd\u306fhcitool\u306e\u30b5\u30d6\u30b3\u30de\u30f3\u30c9\u3002man page\u306b\u306f\u3053\u3046\u66f8\u3044\u3066\u3042\u308b\u3002\ncmd <ofg> <ocf> [parameters]\n  Submit an arbitrary HCI command to local device.\n  ogf, ocf and parameters are hexadecimal bytes.\n\nogf, ocf \u3068\u3044\u3046\u306e\u306f\u3001bluetooth\u4ed5\u69d8\u306eCore\u306b\u66f8\u304b\u308c\u3066\u3044\u3066\u3001\u4eca\u306a\u3089Core Version4.2 \u306e vol. 2, part E, section 5.4.1 \u306b\u66f8\u304b\u308c\u3066\u3044\u308b\u3002ogf = OpCode Group Field, ocf = OpCode Command Field\u3068\u3044\u3046\u3053\u3068\u3089\u3057\u3044\u3002ogf 6bit, ocf 10bit\u306e\u3001\u5408\u8a0816bit\u3067\u6c7a\u307e\u308b\u3002\nogf 0x08 = LE Controller Commands \u306b\u306a\u3063\u3066\u3044\u308b(vol. 2, part E, section 7.8)\nocf \u306b\u3064\u3044\u3066\u306f\u6b21\u306e\u901a\u308a\n\n0x0006 = HCI_LE_SET_Advertising_Parameters (vol. 2, part E, section 7.8.5)\n0x0008 = HCI_LE_SET_Advertising_Data (vol. 2, part E, section 7.8.7)\n0x000a = HCI_LE_Set_Advertise_Enable (vol. 2, part E, section 7.8.9)\n\n\u305d\u306e\u5f8c\u308d\u306eparameters\u306b\u95a2\u3057\u3066\u306f\u3001section 5.4.1\u306e\u30d1\u30b1\u30c3\u30c8\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u3068\u7a81\u304d\u5408\u308f\u305b\u3066\u9010\u4e00\u8aad\u3093\u3067\u3044\u304f\u3002\u307e\u305a\u3001parameter total length \u306f\u3001hcitool cmd \u304c\u8a08\u7b97\u3057\u3066\u57cb\u3081\u3066\u304f\u308c\u308b\u3002\u305d\u306e\u5f8c\u308d\u306eparameters\u306fOpCode\u3054\u3068\u306b\u5909\u308f\u308b\u3002\n\nadvertising parameters\nsection 7.8.5 \u306b\u5f93\u3063\u3066\u3001\u6b21\u306e\u5185\u5bb9\u3092\u5206\u89e3\u3057\u3066\u307f\u308b\u3002\n# hcitool -i hci0 cmd 0x08 0x0006 a0 00 a0 00 03 00 00 00 00 00 00 00 00 07 00\n\n\n\n\nparameters\nhex\nmeaning\n\n\n\n\nAdvertising_Interval_Min\na0 00\n0x00a0 * 0.625 msec = 100 msec\n\n\nAdvertising_Interval_Max\na0 00\n0x00a0 * 0.625 msec = 100 msec\n\n\nAdvertising_Type\n03\nNon connectable undirected advertising ADV_NONCONN_IND\n\n\nOwn_Address_Type\n00\nPublic Device Address(default)\n\n\nPeer_Address_Type\n00\nPublic Device Address(default)\n\n\nPeer_Address\n00 00 00 00 00 00\naddress of the device to be connected = BDADDR_ANY\n\n\nAdvertising_Channel_Map\n07\nDefault(all channels 37, 38, 39)\n\n\nAdvertising_Filter_Policy\n00\nProcess scan adn connection requests from all devices(no white list in use)(default)\n\n\n\n\nadvertising data\nsection 7.8.7 \u306b\u5f93\u3063\u3066\u3001\u6b21\u306e\u5185\u5bb9\u3092\u5206\u89e3\u3057\u3066\u307f\u308b\n# hcitool -i hci0 cmd 0x08 0x0008 1E 02 01 1A 1A FF 4C 00 02 15 FB 0B 57 A2 82 28 44 CD 91 3A 94 A1 22 BA 12 06 00 01 00 02 D1 00\n\n\n\n\nparameters\nhex\nmeaning\n\n\n\n\nAdvertising_Data_Length\n1E\n30\n\n\nAdvertising_Data\n\u6b8b\u308a\u5168\u3066\nvol. 3, part C, section 11\u306b\u5f93\u3063\u3066\u8aad\u3080\n\n\n\nvol. 3, part C, section 11\u306b\u3088\u308b\u3068\u3001AD structure\u306e\u914d\u5217\u306b\u306a\u3063\u3066\u3044\u308b\u3002AD Type\u306fGeneric Access Profile\u306b\u5b9a\u7fa9\u304c\u3042\u308b\u3002\nad_structure{\n Length = 02\n Data {\n  AD Type = 01 ... <<Flags>>\n  AD Data = 1A ... \u8b0e\n }\n}\nad_structure{\n Length = 1A (26)\n Data {\n  AD Type = FF ... <<Manufacturer Specific Data>>\n  AD Data {\n   Company Identifier Code = 4C 00 ... Apple, Inc(0x004C)\n   additional manufacturer specific data {\n    type = 02 ... ibeacon AD indicator\n    length = 15 (21)\n    data {\n     uuid = FB 0B 57 A2 82 28 44 CD 91 3A 94 A1 22 BA 12 06\n     major = 00 01\n     minor = 00 02\n     power = D1\n    }\n    padding = 00\n   }\n  }\n }\n\nFlags \u306b\u3064\u3044\u3066\u306f CSS v5 \u3067\u306f Reserved \u3068\u3055\u308c\u3066\u3044\u308b\u30d3\u30c3\u30c8\u3092\u4f7f\u3063\u3066\u3044\u308b\u3002CSS v6 \u306b\u306f\u5b9a\u7fa9\u304c\u3042\u308b\u304b\u3082\u3002\n\n[wikipedia](https://en.wikipedia.org/wiki/IBeacon)\u306e\u6280\u8853\u8a73\u7d30\u306b\u306f\u6b21\u306e\u3088\u3046\u306b\u66f8\u3044\u3066\u3042\u308b\u3002\n\n```bash\nhcitool -i hci0 cmd 0x08 0x0006 a0 00 a0 00 03 00 00 00 00 00 00 00 00 07 00\n################################## 02 01 06 1a ff 4c 00 02 15  # Apple's fixed iBeacon advertising prefix\nhcitool -i hci0 cmd 0x08 0x0008 1E 02 01 1A 1A FF 4C 00 02 15 FB 0B 57 A2 82 28 44 CD 91 3A 94 A1 22 BA 12 06 00 01 00 02 D1 00\nhcitool -i hci0 cmd 0x08 0x000a 01\n```\n\n\u3053\u308c\u3092\u305f\u3060\u30b3\u30d4\u30fc\u3059\u308b\u3060\u3051\u3067\u306f\u733f\u4e26\u307f\u3060\u2026\u3002\u305b\u3063\u304b\u304f\u306a\u306e\u3067 `hcitool` \u306e\u5f15\u6570\u3092\u5206\u89e3\u3057\u3066\u3044\u304f\u3002\n\n\u307e\u305a `-i hci0` \u306f\u7279\u306b\u554f\u984c\u306a\u3044\u3002`hciconfig`\u3067\u898b\u3048\u308b\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9\u4e00\u89a7\u3068\u540c\u3058\u3067\u3001`hci0`\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9\u306b\u5bfe\u3057\u3066\u64cd\u4f5c\u3092\u884c\u3063\u3066\u3044\u308b\u3002\n\n`cmd`\u306f`hcitool`\u306e\u30b5\u30d6\u30b3\u30de\u30f3\u30c9\u3002[man page](http://git.kernel.org/cgit/bluetooth/bluez.git/tree/tools/hcitool.1)\u306b\u306f\u3053\u3046\u66f8\u3044\u3066\u3042\u308b\u3002\n\n```bash\ncmd <ofg> <ocf> [parameters]\n  Submit an arbitrary HCI command to local device.\n  ogf, ocf and parameters are hexadecimal bytes.\n```\n`ogf`, `ocf` \u3068\u3044\u3046\u306e\u306f\u3001[bluetooth\u4ed5\u69d8](https://www.bluetooth.org/ja-jp/specification/adopted-specifications)\u306eCore\u306b\u66f8\u304b\u308c\u3066\u3044\u3066\u3001\u4eca\u306a\u3089Core Version4.2 \u306e vol. 2, part E, section 5.4.1 \u306b\u66f8\u304b\u308c\u3066\u3044\u308b\u3002ogf = OpCode Group Field, ocf = OpCode Command Field\u3068\u3044\u3046\u3053\u3068\u3089\u3057\u3044\u3002ogf 6bit, ocf 10bit\u306e\u3001\u5408\u8a0816bit\u3067\u6c7a\u307e\u308b\u3002\n\nogf 0x08 = LE Controller Commands \u306b\u306a\u3063\u3066\u3044\u308b(vol. 2, part E, section 7.8)\n\nocf \u306b\u3064\u3044\u3066\u306f\u6b21\u306e\u901a\u308a\n\n* 0x0006 = HCI_LE_SET_Advertising_Parameters (vol. 2, part E, section 7.8.5)\n* 0x0008 = HCI_LE_SET_Advertising_Data (vol. 2, part E, section 7.8.7)\n* 0x000a = HCI_LE_Set_Advertise_Enable (vol. 2, part E, section 7.8.9)\n\n\u305d\u306e\u5f8c\u308d\u306eparameters\u306b\u95a2\u3057\u3066\u306f\u3001section 5.4.1\u306e\u30d1\u30b1\u30c3\u30c8\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u3068\u7a81\u304d\u5408\u308f\u305b\u3066\u9010\u4e00\u8aad\u3093\u3067\u3044\u304f\u3002\u307e\u305a\u3001parameter total length \u306f\u3001hcitool cmd \u304c\u8a08\u7b97\u3057\u3066\u57cb\u3081\u3066\u304f\u308c\u308b\u3002\u305d\u306e\u5f8c\u308d\u306eparameters\u306fOpCode\u3054\u3068\u306b\u5909\u308f\u308b\u3002\n\n\nadvertising parameters\n-------------------------\n\nsection 7.8.5 \u306b\u5f93\u3063\u3066\u3001\u6b21\u306e\u5185\u5bb9\u3092\u5206\u89e3\u3057\u3066\u307f\u308b\u3002\n\n```text\n# hcitool -i hci0 cmd 0x08 0x0006 a0 00 a0 00 03 00 00 00 00 00 00 00 00 07 00\n```\n\n|parameters|hex|meaning|\n|------------|---|-------|\n|Advertising_Interval_Min|a0 00|0x00a0 * 0.625 msec = 100 msec|\n|Advertising_Interval_Max|a0 00|0x00a0 * 0.625 msec = 100 msec|\n|Advertising_Type| 03 |Non connectable undirected advertising ADV_NONCONN_IND|\n|Own_Address_Type|00|Public Device Address(default)|\n|Peer_Address_Type| 00 |Public Device Address(default)|\n|Peer_Address| 00 00 00 00 00 00 |address of the device to be connected = BDADDR_ANY|\n|Advertising_Channel_Map|07|Default(all channels 37, 38, 39)|\n|Advertising_Filter_Policy| 00 |Process scan adn connection requests from all devices(no white list in use)(default)|\n\nadvertising data\n-----------------\n\nsection 7.8.7 \u306b\u5f93\u3063\u3066\u3001\u6b21\u306e\u5185\u5bb9\u3092\u5206\u89e3\u3057\u3066\u307f\u308b\n\n```\n# hcitool -i hci0 cmd 0x08 0x0008 1E 02 01 1A 1A FF 4C 00 02 15 FB 0B 57 A2 82 28 44 CD 91 3A 94 A1 22 BA 12 06 00 01 00 02 D1 00\n```\n\n|parameters|hex|meaning|\n|---------|---|------|\n|Advertising_Data_Length|1E|30|\n|Advertising_Data|\u6b8b\u308a\u5168\u3066|vol. 3, part C, section 11\u306b\u5f93\u3063\u3066\u8aad\u3080|\n\nvol. 3, part C, section 11\u306b\u3088\u308b\u3068\u3001AD structure\u306e\u914d\u5217\u306b\u306a\u3063\u3066\u3044\u308b\u3002AD Type\u306f[Generic Access Profile](https://www.bluetooth.org/en-us/specification/assigned-numbers/generic-access-profile)\u306b\u5b9a\u7fa9\u304c\u3042\u308b\u3002\n\n```text\nad_structure{\n Length = 02\n Data {\n  AD Type = 01 ... <<Flags>>\n  AD Data = 1A ... \u8b0e\n }\n}\nad_structure{\n Length = 1A (26)\n Data {\n  AD Type = FF ... <<Manufacturer Specific Data>>\n  AD Data {\n   Company Identifier Code = 4C 00 ... Apple, Inc(0x004C)\n   additional manufacturer specific data {\n    type = 02 ... ibeacon AD indicator\n    length = 15 (21)\n    data {\n     uuid = FB 0B 57 A2 82 28 44 CD 91 3A 94 A1 22 BA 12 06\n     major = 00 01\n     minor = 00 02\n     power = D1\n    }\n    padding = 00\n   }\n  }\n }\n```\n\nFlags \u306b\u3064\u3044\u3066\u306f CSS v5 \u3067\u306f Reserved \u3068\u3055\u308c\u3066\u3044\u308b\u30d3\u30c3\u30c8\u3092\u4f7f\u3063\u3066\u3044\u308b\u3002CSS v6 \u306b\u306f\u5b9a\u7fa9\u304c\u3042\u308b\u304b\u3082\u3002\n\n\n", "tags": ["bluetooth", "BLE", "iBeacon"]}