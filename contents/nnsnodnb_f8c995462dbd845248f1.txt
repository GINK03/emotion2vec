{"context": "\n\n\u306f\u3058\u3081\u306b\n\u524d\u56de\u3082\u4f3c\u305f\u3088\u3046\u306a\u8a18\u4e8b\u3092\u66f8\u3044\u305f\u306e\u3067\u3059\u304c\u3001\n\u5b9f\u9a13\u305b\u305a\u306b\u66f8\u3044\u3066\u3001\u5b9f\u969b\u306b\u81ea\u5206\u304c\u3084\u3063\u3066\u307f\u3066\u52d5\u304b\u306a\u304b\u3063\u305f\u306e\u3067\u4fee\u6b63\u7b49\u542b\u3081\u3066\u6539\u3081\u3066\u8a18\u4e8b\u3092\u66f8\u304d\u307e\u3059\uff01\nPython\u3067iOS\u30a2\u30d7\u30ea\u306b\u30d7\u30c3\u30b7\u30e5\u901a\u77e5\u3092\u9001\u308d\u3046\n\n\u74b0\u5883\n\nPython 2.7.11\npip 8.1.2\napns==2.0.1\n\n\n\u74b0\u5883\u69cb\u6210\nVirtualenv\u3067\u4eee\u60f3\u74b0\u5883\u3092\u69cb\u7bc9\u5f8c\u306bpip\u306b\u3066apns\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n$ pip install apns\n\n\n\u6e96\u5099\n\u30ad\u30fc\u30c1\u30a7\u30fc\u30f3\u304b\u3089\u30d7\u30c3\u30b7\u30e5\u901a\u77e5\u3092\u3059\u308bpem\u30d5\u30a1\u30a4\u30eb\u3092\u66f8\u304d\u51fa\u3059\u3002\n\n\nDevelop\u7528\u3068Distribution\u7528\u306ep12\u30d5\u30a1\u30a4\u30eb\u3092\u516c\u958b\u9375\u3068\u79d8\u5bc6\u9375\u3092\u542b\u3081\u305f\u5f62\u3067\u66f8\u304d\u51fa\u3059\u3002\n\n\u79d8\u5bc6\u9375\u306b\u95a2\u3057\u3066\u306f\u540c\u540d\u306e\u3082\u306e\u3092\u4f7f\u3046\u3068\u4f7f\u3044\u307e\u308f\u305b\u308b\u306e\u3067\u540c\u540d\u306b\u3057\u3066\u304a\u304f\u3002\n2. \u79d8\u5bc6\u9375\u3082\u540c\u69d8\u306b\u3057\u3066 \u79d8\u5bc6\u9375 \u306e\u307f\u3092p12\u5f62\u5f0f\u3067\u66f8\u304d\u51fa\u3059\n3. \u305d\u308c\u305e\u308c3\u3064\u3042\u308bpem\u30d5\u30a1\u30a4\u30eb\u3092\u4ee5\u4e0b\u30b3\u30de\u30f3\u30c9\u3067pem\u30d5\u30a1\u30a4\u30eb\u306b\u5909\u63db\u3059\u308b\n$ openssl pkcs12 -in secret.p12 -out secret.pem -nodes -clcerts\n\n\u540d\u524d\u306f\u308f\u304b\u308b\u3088\u3046\u306b\u5909\u66f4\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\u66f8\u304d\u51fa\u3059\u3068\u304d\u306b\u30d1\u30b9\u30ef\u30fc\u30c9\u306a\u3057\u3067\u8a2d\u5b9a\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\n\n1\u3064\u306e\u7aef\u672b\u306b\u9001\u308b\nDeveloper\u7528\u306epem\u30d5\u30a1\u30a4\u30eb\u3092\u8a2d\u5b9a\u3057\u3066\u3044\u307e\u3059\u3002\n\nsingle.py\n# coding: utf-8\n\nimport time\nfrom apns import APNs, Payload\n\napns = APNs(use_sandbox=True, cert_file='develop.pem', key_file='secret.pem')\n\ntoken_hex = '45f9f318ac6506742a54a3b8bb6493c72cdad9afe2c154d5295e9db15cdf83a7'\n\ncontent = \"\u30c6\u30b9\u30c8!!\"\ncontent = content.decode('utf-8')\n\npayload = Payload(alert=content, sound=\"default\", badge=1)\napns.gateway_server.send_notification(token_hex, payload)\n\n\ncert_file \u306f\u516c\u958b\u9375\u3002 key_file \u306f\u79d8\u5bc6\u9375\u3067\u3059\u3002\n\n\u8907\u6570\u7aef\u672b\u306b\u9001\u308b\n\u4eca\u56de\u306fDeployGate\u306b\u3042\u3052\u305f\u3082\u306e\u3092\u30c6\u30b9\u30c8\u3057\u305f\u306e\u3067Distribution\u7528\u306epem\u30d5\u30a1\u30a4\u30eb\u3092\u8a2d\u5b9a\u3057\u3066\u3044\u307e\u3059\u3002\n\nmulti.py\n# coding: utf-8\n\nimport time\nfrom apns import APNs, Frame, Payload\n\napns = APNs(use_sandbox=False, cert_file='distribution.pem', key_file='secret.pem', enhanced=True)\n\ntoken_hex = ['417a7b3329c86240b159b816313a3ae51ff9059b98ac29bc7cbcbd36dd41e2a9',\n             '446d18e7a621d371a8683d0d33bf9080091efbf693f5b591f9ec307a1e627d46']\n\nmessage = \"\u30e1\u30c3\u30bb\u30fc\u30b8\uff01\uff01\"\nmessage = message.decode('utf-8')\n\npayload = Payload(alert=message, sound=\"default\", badge=1, custom={'uri': 'https://nnsnodnb.moe'})\n\nframe = Frame()\nidentifier = 1\nexpiry = time.time() + 3600\npriority = 10\n\nfor token in token_hex:\n    frame.add_item(token, payload, identifier, expiry, priority)\n\napns.gateway_server.send_notification_multiple(frame)\n\n\n\u8907\u6570\u7aef\u672b\u306b\u9001\u308b\u3068\u304d\u306f\u3001 APNs \u306e\u8981\u7d20\u306b enhanced \u3092\u8a2d\u5b9a\u3059\u308b\u306e\u304c\u809d\u306b\u306a\u3063\u3066\u3044\u308b\u3088\u3046\u3067\u3059\u3002\n\u30ea\u30f3\u30af\u306f\u53d6\u308a\u5fd8\u308c\u305f\u306e\u3067\u3059\u304c\u3001PyAPNs\u30d1\u30c3\u30b1\u30fc\u30b8\u306eGitHub\u306eIssue\u306b\u4e0a\u304c\u3063\u3066\u3044\u307e\u3057\u305f\u3002\n\u307e\u305f\u3001\u540c\u3058\u3088\u3046\u306b Payload \u306b mutable_content=True \u3092\u8a2d\u5b9a\u3059\u308b\u3053\u3068\u3067iOS10\u304b\u3089\u306e\u753b\u50cf\u3064\u304d\u30d7\u30c3\u30b7\u30e5\u306b\u5bfe\u5fdc\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u308b\u306e\u304b\u306a\uff1f\n\n\u7d50\u679c\n\n\u73fe\u5728\u3001\u79c1\u7528\u3067\u958b\u767a\u4e2d\u306e\u3082\u306e\u306a\u306e\u3067\u30a2\u30a4\u30b3\u30f3\u7b49\u306f\u898b\u305b\u3089\u308c\u307e\u305b\u3093\u304c\u3001\u3053\u3093\u306a\u611f\u3058\u306b\u901a\u77e5\u304c\u5c4a\u304d\u307e\u3057\u305f\uff01\ncustom \u306e\u3068\u3053\u308d\u306bJSON\u3092\u57cb\u3081\u8fbc\u3080\u3053\u3068\u304c\u3067\u304d\u308b\u306e\u3067\u7d50\u69cb\u7c21\u5358\u306b\u305d\u308c\u3063\u307d\u3044\u3053\u3068\u304c\u3067\u304d\u305d\u3046\u3067\u3059\u306d\uff01\n\n\u305d\u306e\u4ed6\nGitHub\u306e\u30ea\u30dd\u30b8\u30c8\u30ea\u3067\u3059\u3002\nnnsnodnb/APNs-Push-Notification\n\u4eca\u56de\u4f7f\u7528\u3057\u305f\u30d1\u30c3\u30b1\u30fc\u30b8\ndjacobs/PyAPNs\n\u3069\u3046\u3084\u3089Python3\u306b\u306f\u5bfe\u5fdc\u3057\u3066\u3044\u306a\u3044\u306e\u3067\u81ea\u5206\u3067\u3069\u3046\u306b\u304b\u3059\u308b\u3057\u304b\u306a\u3055\u305d\u3046\u3067\u3059\u306d\u3002\n2to3\u3057\u3066\u3082\u4f55\u6545\u304b\u5909\u308f\u3089\u306a\u3044\uff01\uff1f\n\n## \u306f\u3058\u3081\u306b\n\n\u524d\u56de\u3082\u4f3c\u305f\u3088\u3046\u306a\u8a18\u4e8b\u3092\u66f8\u3044\u305f\u306e\u3067\u3059\u304c\u3001\n\u5b9f\u9a13\u305b\u305a\u306b\u66f8\u3044\u3066\u3001\u5b9f\u969b\u306b\u81ea\u5206\u304c\u3084\u3063\u3066\u307f\u3066\u52d5\u304b\u306a\u304b\u3063\u305f\u306e\u3067\u4fee\u6b63\u7b49\u542b\u3081\u3066\u6539\u3081\u3066\u8a18\u4e8b\u3092\u66f8\u304d\u307e\u3059\uff01\n\n[Python\u3067iOS\u30a2\u30d7\u30ea\u306b\u30d7\u30c3\u30b7\u30e5\u901a\u77e5\u3092\u9001\u308d\u3046](http://qiita.com/nnsnodnb/items/ba415c2a56a037cce526)\n\n## \u74b0\u5883\n\n- Python 2.7.11\n- pip 8.1.2\n- apns==2.0.1\n\n## \u74b0\u5883\u69cb\u6210\n\nVirtualenv\u3067\u4eee\u60f3\u74b0\u5883\u3092\u69cb\u7bc9\u5f8c\u306bpip\u306b\u3066apns\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n```bash\n$ pip install apns\n```\n\n## \u6e96\u5099\n\n\u30ad\u30fc\u30c1\u30a7\u30fc\u30f3\u304b\u3089\u30d7\u30c3\u30b7\u30e5\u901a\u77e5\u3092\u3059\u308bpem\u30d5\u30a1\u30a4\u30eb\u3092\u66f8\u304d\u51fa\u3059\u3002\n\n![\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8_2016-09-17_\u5348\u524d11_04_45.png](https://qiita-image-store.s3.amazonaws.com/0/97280/6651accb-2648-dace-c57d-6ed544882735.png \"\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8_2016-09-17_\u5348\u524d11_04_45.png\")\n\n1. Develop\u7528\u3068Distribution\u7528\u306ep12\u30d5\u30a1\u30a4\u30eb\u3092\u516c\u958b\u9375\u3068\u79d8\u5bc6\u9375\u3092\u542b\u3081\u305f\u5f62\u3067\u66f8\u304d\u51fa\u3059\u3002\n \n   \u79d8\u5bc6\u9375\u306b\u95a2\u3057\u3066\u306f\u540c\u540d\u306e\u3082\u306e\u3092\u4f7f\u3046\u3068\u4f7f\u3044\u307e\u308f\u305b\u308b\u306e\u3067\u540c\u540d\u306b\u3057\u3066\u304a\u304f\u3002\n2. \u79d8\u5bc6\u9375\u3082\u540c\u69d8\u306b\u3057\u3066 **\u79d8\u5bc6\u9375** \u306e\u307f\u3092p12\u5f62\u5f0f\u3067\u66f8\u304d\u51fa\u3059\n3. \u305d\u308c\u305e\u308c3\u3064\u3042\u308bpem\u30d5\u30a1\u30a4\u30eb\u3092\u4ee5\u4e0b\u30b3\u30de\u30f3\u30c9\u3067pem\u30d5\u30a1\u30a4\u30eb\u306b\u5909\u63db\u3059\u308b\n\n```bash\n$ openssl pkcs12 -in secret.p12 -out secret.pem -nodes -clcerts\n```\n\n\u540d\u524d\u306f\u308f\u304b\u308b\u3088\u3046\u306b\u5909\u66f4\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\u66f8\u304d\u51fa\u3059\u3068\u304d\u306b\u30d1\u30b9\u30ef\u30fc\u30c9\u306a\u3057\u3067\u8a2d\u5b9a\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n## \u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\n\n### 1\u3064\u306e\u7aef\u672b\u306b\u9001\u308b\n\nDeveloper\u7528\u306epem\u30d5\u30a1\u30a4\u30eb\u3092\u8a2d\u5b9a\u3057\u3066\u3044\u307e\u3059\u3002\n\n```python:single.py\n# coding: utf-8\n\nimport time\nfrom apns import APNs, Payload\n\napns = APNs(use_sandbox=True, cert_file='develop.pem', key_file='secret.pem')\n\ntoken_hex = '45f9f318ac6506742a54a3b8bb6493c72cdad9afe2c154d5295e9db15cdf83a7'\n\ncontent = \"\u30c6\u30b9\u30c8!!\"\ncontent = content.decode('utf-8')\n\npayload = Payload(alert=content, sound=\"default\", badge=1)\napns.gateway_server.send_notification(token_hex, payload)\n```\n\n`cert_file` \u306f\u516c\u958b\u9375\u3002 `key_file` \u306f\u79d8\u5bc6\u9375\u3067\u3059\u3002\n\n### \u8907\u6570\u7aef\u672b\u306b\u9001\u308b\n\n\u4eca\u56de\u306fDeployGate\u306b\u3042\u3052\u305f\u3082\u306e\u3092\u30c6\u30b9\u30c8\u3057\u305f\u306e\u3067Distribution\u7528\u306epem\u30d5\u30a1\u30a4\u30eb\u3092\u8a2d\u5b9a\u3057\u3066\u3044\u307e\u3059\u3002\n\n```python:multi.py\n# coding: utf-8\n\nimport time\nfrom apns import APNs, Frame, Payload\n\napns = APNs(use_sandbox=False, cert_file='distribution.pem', key_file='secret.pem', enhanced=True)\n\ntoken_hex = ['417a7b3329c86240b159b816313a3ae51ff9059b98ac29bc7cbcbd36dd41e2a9',\n             '446d18e7a621d371a8683d0d33bf9080091efbf693f5b591f9ec307a1e627d46']\n\nmessage = \"\u30e1\u30c3\u30bb\u30fc\u30b8\uff01\uff01\"\nmessage = message.decode('utf-8')\n\npayload = Payload(alert=message, sound=\"default\", badge=1, custom={'uri': 'https://nnsnodnb.moe'})\n\nframe = Frame()\nidentifier = 1\nexpiry = time.time() + 3600\npriority = 10\n\nfor token in token_hex:\n    frame.add_item(token, payload, identifier, expiry, priority)\n\napns.gateway_server.send_notification_multiple(frame)\n```\n\n\u8907\u6570\u7aef\u672b\u306b\u9001\u308b\u3068\u304d\u306f\u3001 `APNs` \u306e\u8981\u7d20\u306b `enhanced` \u3092\u8a2d\u5b9a\u3059\u308b\u306e\u304c\u809d\u306b\u306a\u3063\u3066\u3044\u308b\u3088\u3046\u3067\u3059\u3002\n\u30ea\u30f3\u30af\u306f\u53d6\u308a\u5fd8\u308c\u305f\u306e\u3067\u3059\u304c\u3001PyAPNs\u30d1\u30c3\u30b1\u30fc\u30b8\u306eGitHub\u306eIssue\u306b\u4e0a\u304c\u3063\u3066\u3044\u307e\u3057\u305f\u3002\n\n\u307e\u305f\u3001\u540c\u3058\u3088\u3046\u306b `Payload` \u306b `mutable_content=True` \u3092\u8a2d\u5b9a\u3059\u308b\u3053\u3068\u3067iOS10\u304b\u3089\u306e\u753b\u50cf\u3064\u304d\u30d7\u30c3\u30b7\u30e5\u306b\u5bfe\u5fdc\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u308b\u306e\u304b\u306a\uff1f\n\n## \u7d50\u679c\n\n![IMG_0136.png](https://qiita-image-store.s3.amazonaws.com/0/97280/1178c1f4-71b4-bcde-d771-1872047d7353.png \"IMG_0136.png\")\n\n\u73fe\u5728\u3001\u79c1\u7528\u3067\u958b\u767a\u4e2d\u306e\u3082\u306e\u306a\u306e\u3067\u30a2\u30a4\u30b3\u30f3\u7b49\u306f\u898b\u305b\u3089\u308c\u307e\u305b\u3093\u304c\u3001\u3053\u3093\u306a\u611f\u3058\u306b\u901a\u77e5\u304c\u5c4a\u304d\u307e\u3057\u305f\uff01\n`custom` \u306e\u3068\u3053\u308d\u306bJSON\u3092\u57cb\u3081\u8fbc\u3080\u3053\u3068\u304c\u3067\u304d\u308b\u306e\u3067\u7d50\u69cb\u7c21\u5358\u306b\u305d\u308c\u3063\u307d\u3044\u3053\u3068\u304c\u3067\u304d\u305d\u3046\u3067\u3059\u306d\uff01\n\n## \u305d\u306e\u4ed6\n\nGitHub\u306e\u30ea\u30dd\u30b8\u30c8\u30ea\u3067\u3059\u3002\n\n[nnsnodnb/APNs-Push-Notification](https://bitbucket.org/nnsnodnb/apns-push-notification)\n\n\n\u4eca\u56de\u4f7f\u7528\u3057\u305f\u30d1\u30c3\u30b1\u30fc\u30b8\n\n[djacobs/PyAPNs](https://github.com/djacobs/PyAPNs)\n\n\n\u3069\u3046\u3084\u3089Python3\u306b\u306f\u5bfe\u5fdc\u3057\u3066\u3044\u306a\u3044\u306e\u3067\u81ea\u5206\u3067\u3069\u3046\u306b\u304b\u3059\u308b\u3057\u304b\u306a\u3055\u305d\u3046\u3067\u3059\u306d\u3002\n2to3\u3057\u3066\u3082\u4f55\u6545\u304b\u5909\u308f\u3089\u306a\u3044\uff01\uff1f\n", "tags": ["Push\u901a\u77e5", "Python", "iOS"]}