{"context": " More than 1 year has passed since last update.Python for Data Analysis\u306e\u65e5\u672c\u8a9e\u7248\u767a\u58f2\u8a18\u5ff5\u306b\n\u3088\u304f\u4f7f\u3044\u305d\u3046\u306a\u3082\u306e\u3068\u304b\u8a70\u307e\u308a\u305d\u3046\u306a\u3068\u3053\u308d\u3068\u304b\n\u3081\u3061\u3083\u304f\u3061\u3083\u9577\u304f\u306a\u3063\u3066\u3057\u307e\u3063\u305f\u306e\u3067\u76ee\u6b21\n\n\u8907\u6570\u306eSeries\u3092\u7d50\u5408\u3057\u3066DataFrame\u306b\n\nDataFrame\u306e\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u53c2\u7167\n\ncolumn\u306e\u53c2\u7167\nrow\u306e\u53c2\u7167\n\u884c\u3068\u5217\u3092\u540c\u6642\u306b\u7bc4\u56f2\u6307\u5b9a\u3057\u3066\u53c2\u7167 (ix\u306b\u3088\u308b\u53c2\u7167)\n\n\nSeries\u306e\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u53c2\u7167\nbool\u5024\u306b\u3088\u308b\u30de\u30b9\u30ad\u30f3\u30b0\nSeries\u540c\u58eb, DataFrame\u540c\u58eb\u306e\u6f14\u7b97\n\u968e\u5c64\u7684\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\nstack\u30e1\u30bd\u30c3\u30c9\u3068unstack\u30e1\u30bd\u30c3\u30c9\n\n\u540d\u524d\u4ed8\u3051\n\n\u884c\u307e\u305f\u306f\u5217\u306e\u540d\u524d\u4ed8\u3051\n\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u30e9\u30d9\u30eb\u81ea\u4f53\u306e\u540d\u524d\u4ed8\u3051\n\n\n\u30d3\u30f3\u30cb\u30f3\u30b0\n\u5217\u3068\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u306e\u5909\u63db\n\u30e9\u30f3\u30c0\u30e0\u30b5\u30f3\u30d7\u30ea\u30f3\u30b0\n\u30ab\u30c6\u30b4\u30ea\u30ab\u30eb\u30c7\u30fc\u30bf\u3092\u30c0\u30df\u30fc\u5909\u6570\u5316\n\u30b0\u30eb\u30fc\u30d4\u30f3\u30b0\n\n\n\u8907\u6570\u306eSeries\u3092\u7d50\u5408\u3057\u3066DataFrame\u306b\nconcat\u3092\u4f7f\u3063\u3066\u3067axis=1\u306b\u3059\u308c\u3070\u826f\u3044\ns1 = pd.Series([1,2,3,4,5], index=[0,1,2,3,4])\ns2 = pd.Series([10,20,30,40,50], index=[10,11,12,13,14])\ns3 = pd.Series([100,200,300,400,500], index=[0,2,4,6,8])\nprint pd.concat([s1, s2, s3], axis=1)\n\"\"\"\n     0   1    2\n0    1 NaN  100\n1    2 NaN  NaN\n2    3 NaN  200\n3    4 NaN  NaN\n4    5 NaN  300\n6  NaN NaN  400\n8  NaN NaN  500\n10 NaN  10  NaN\n11 NaN  20  NaN\n12 NaN  30  NaN\n13 NaN  40  NaN\n14 NaN  50  NaN\n\"\"\"\n\n\nDataFrame\u306e\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u53c2\u7167\n\u8272\u3005\u7528\u610f\u3055\u308c\u3066\u3044\u3066\u6df7\u4e71\u3059\u308b\n\u3081\u3093\u3069\u304f\u3055\u3044\u3051\u3069ix\u306b\u3088\u308b\u53c2\u7167\u304c\u4e00\u756a\u308f\u304b\u308a\u6613\u3044\u3068\u601d\u3046\n# DataFrame\u3092\u7528\u610f\ndf = DataFrame(arange(30).reshape((6, 5)), index=list(\"ASDFGH\"), columns=list(\"abcde\"))\nprint df\n\"\"\"\n    a   b   c   d   e\nA   0   1   2   3   4\nS   5   6   7   8   9\nD  10  11  12  13  14\nF  15  16  17  18  19\nG  20  21  22  23  24\nH  25  26  27  28  29\n\"\"\"\n\n\ncolumn\u306e\u53c2\u7167\n\u30ab\u30e9\u30e0\u306e\u53c2\u7167\u306f\u30ab\u30e9\u30e0\u540d\u3092\u6307\u5b9a\u3059\u308b\n\u8907\u6570\u6307\u5b9a\u3059\u308b\u5834\u5408\u306f\u30ea\u30b9\u30c8\u5f62\u5f0f\u306b\u3057\u3066\u6307\u5b9a\n\u6307\u5b9a\u3059\u308b\u30ab\u30e9\u30e0\u304c1\u3064\u306e\u5834\u5408\u306f\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u5909\u6570\u304c\u30ab\u30e9\u30e0\u540d\u3067\u7528\u610f\u3055\u308c\u3066\u3044\u308b\u306e\u3067\u305d\u308c\u3092\u6307\u5b9a\u3057\u3066\u3082\u826f\u3044\n# \u30ab\u30e9\u30e0\u540d\u3092\u6307\u5b9a\nprint df[\"a\"]\n\"\"\"\nA     0\nS     5\nD    10\nF    15\nG    20\nH    25\nName: a, dtype: int64\n\"\"\"\n\n# \u8907\u6570\u306e\u30ab\u30e9\u30e0\u540d\u3092\u6307\u5b9a\nprint df[[\"a\", \"c\", \"e\"]]\n\"\"\"\n    a   c   e\nA   0   2   4\nS   5   7   9\nD  10  12  14\nF  15  17  19\nG  20  22  24\nH  25  27  29\n\"\"\"\n\n# \u30ab\u30e9\u30e0\u540d\u306e\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u5909\u6570\u3092\u6307\u5b9a\nprint df.a\n\"\"\"\nA     0\nS     5\nD    10\nF    15\nG    20\nH    25\n\"\"\"\n\n\nrow\u306e\u53c2\u7167\n\u30b9\u30e9\u30a4\u30b7\u30f3\u30b0\u306a\u3069\u306b\u3088\u3063\u3066\u6307\u5b9a\n\u884c\u306b\u4ed8\u3044\u3066\u3044\u308b\u540d\u524d (\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u30e9\u30d9\u30eb) \u306b\u3088\u308b\u6307\u5b9a\u306f\u5f8c\u8ff0\nprint df[0:3]\n\"\"\"\n    a   b   c   d   e\nA   0   1   2   3   4\nS   5   6   7   8   9\nD  10  11  12  13  14\n\"\"\"\n\n# \u8ca0\u306e\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u6307\u5b9a\nprint df[-2:]\n\"\"\"\n    a   b   c   d   e\nG  20  21  22  23  24\nH  25  26  27  28  29\n\"\"\"\n\n\n\u884c\u3068\u5217\u3092\u540c\u6642\u306b\u7bc4\u56f2\u6307\u5b9a\u3057\u3066\u53c2\u7167 (ix\u306b\u3088\u308b\u53c2\u7167)\nix\u30a2\u30c8\u30ea\u30d3\u30e5\u30fc\u30c8\u3092\u30b9\u30e9\u30a4\u30b7\u30f3\u30b0\u3059\u308b\u4e8b\u3067\u53c2\u7167\u304c\u53ef\u80fd\n\u5b9f\u969b\u3053\u308c\u3060\u3051\u899a\u3048\u3066\u304a\u3051\u3070\u3069\u3093\u306a\u6642\u306b\u3082\u540c\u3058\u5f62\u5f0f\u3067\u4f7f\u3048\u308b\u3057\u4fbf\u5229\n\u6307\u5b9a\u306fNumPy\u306e\uff12\u6b21\u5143\u914d\u5217\u306e\u30b9\u30e9\u30a4\u30b7\u30f3\u30b0\u306e\u3088\u3046\u306b[\u884c, \u5217]\u3067\u884c\u3046\n\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u30e9\u30d9\u30eb\u306b\u3088\u308b\u6307\u5b9a\u3082\u53ef\u80fd\n\u305f\u3060\u3057\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u30e9\u30d9\u30eb\u306b\u3088\u308b\u30b9\u30e9\u30a4\u30b7\u30f3\u30b0\u306e\u5834\u5408\u3001\u5f8c\u308d\u306e\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u30e9\u30d9\u30eb\u306f\u7bc4\u56f2\u306b\u542b\u307e\u308c\u308b\u4e8b\u306b\u6ce8\u610f\n# \u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u306b\u3088\u308b\u6307\u5b9a\nprint df.ix[0, 3]\n\"\"\"\n3\n\"\"\"\n\n# \u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u306b\u3088\u308b\u30b9\u30e9\u30a4\u30b7\u30f3\u30b0\nprint df.ix[0:3, 0:2]\n\"\"\"\n    a   b\nA   0   1\nS   5   6\nD  10  11\n\"\"\"\n\n# \u96e2\u308c\u305f\u884c\u307e\u305f\u306f\u5217\u3092\u8907\u6570\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u3067\u6307\u5b9a\nprint df.ix[[0, 2, 4], [0, 2, 4]]\n\"\"\"\n    a   c   e\nA   0   2   4\nD  10  12  14\nG  20  22  24\n\"\"\"\n\n# \u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u30e9\u30d9\u30eb\u306b\u3088\u308b\u6307\u5b9a\nprint df.ix[\"D\", \"a\"]\n\"\"\"\n10\n\"\"\"\n\n# \u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u30e9\u30d9\u30eb\u306b\u3088\u308b\u7bc4\u56f2\u6307\u5b9a\nprint df.ix[\"A\":\"D\", \"a\":\"b\"]\n\"\"\"\n    a   b\nA   0   1\nS   5   6\nD  10  11\n\"\"\"\n\n# \u96e2\u308c\u305f\u884c\u307e\u305f\u306f\u5217\u3092\u8907\u6570\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u30e9\u30d9\u30eb\u3067\u6307\u5b9a\nprint df.ix[[\"A\", \"H\", \"S\"], [\"c\", \"b\", \"a\"]]\n\"\"\"\n    c   b   a\nA   2   1   0\nH  27  26  25\nS   7   6   5\n\"\"\"\n\n\nSeries\u306e\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u53c2\u7167\nDataFrame\u3092\u3084\u3063\u305f\u306e\u3067\u3064\u3044\u3067\u306bSeries\u3082\nDataFrame\u3068\u9055\u3063\u3066\u6700\u521d\u304b\u3089\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u306b\u3088\u308b\u6307\u5b9a\u3082\u3001\n\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u30e9\u30d9\u30eb\u306b\u3088\u308b\u6307\u5b9a\u3082\u53ef\u80fd\u306a\u306e\u3067\u7279\u306b\u3064\u307e\u308b\u6240\u306f\u7121\u3044\u3068\u601d\u3046\n\u30b9\u30e9\u30a4\u30b7\u30f3\u30b0\u3082\u53ef\u80fd\n# Series\u3092\u7528\u610f\ns1 = pd.Series(range(6), index=list(\"abcdef\"))\nprint s1\n\"\"\"\na    0\nb    1\nc    2\nd    3\ne    4\nf    5\ndtype: int64\n\"\"\"\n\n# \u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u306b\u3088\u308b\u6307\u5b9a\nprint s1[0:3]\n\"\"\"\na    0\nb    1\nc    2\ndtype: int64\n\"\"\"\n\n# \u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u30e9\u30d9\u30eb\u306b\u3088\u308b\u6307\u5b9a\nprint [\"b\":\"e\"]\n\"\"\"\nb    1\nc    2\nd    3\ne    4\ndtype: int64\n\"\"\"\n\n\nbool\u5024\u306b\u3088\u308b\u30de\u30b9\u30ad\u30f3\u30b0\nNumPy\u306endarray\u306e\u3088\u3046\u306bSeries\u307e\u305f\u306fDataFrame\u306b\u5bfe\u3057\u3066\u8a55\u4fa1\u3092\u884c\u3046\u3068\u3001\u305d\u308c\u305e\u308c\u306e\u8981\u7d20\u306b\u5bfe\u3057\u3066\u305d\u306e\u8a55\u4fa1\u304c\u884c\u308f\u308c\u305fbool\u306eSeries\u307e\u305f\u306fDataFrame\u304c\u304b\u3048\u3063\u3066\u304f\u308b\nprint df > 5\n\"\"\"\n       a      b      c      d      e\nA  False  False  False  False  False\nS  False   True   True   True   True\nD   True   True   True   True   True\nF   True   True   True   True   True\nG   True   True   True   True   True\nH   True   True   True   True   True\n\"\"\"\n\nprint s1 > 3\n\"\"\"\na    False\nb    False\nc    False\nd    False\ne     True\nf     True\ndtype: bool\n\"\"\"\n\n\u8fd4\u3063\u3066\u304d\u305f\u3082\u306e\u3067\u5143\u306eSeries\u307e\u305f\u306fDataFrame\u3092\u30de\u30b9\u30af\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u308b\n# DataFrame\u306e\u30de\u30b9\u30af\nprint df[df > 5]\n\"\"\"\n    a   b   c   d   e\nA NaN NaN NaN NaN NaN\nS NaN   6   7   8   9\nD  10  11  12  13  14\nF  15  16  17  18  19\nG  20  21  22  23  24\nH  25  26  27  28  29\n\"\"\"\n\n# Series\u306e\u30de\u30b9\u30af\nprint s1[s1 > 3]\n\"\"\"\ne    4\nf    5\ndtype: int64\n\"\"\"\n\n\nSeries\u540c\u58eb, DataFrame\u540c\u58eb\u306e\u6f14\u7b97\n\u540c\u3058\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u30e9\u30d9\u30eb\u540c\u58eb\u3067\u6f14\u7b97\u304c\u884c\u308f\u308c\u308b\n\u540c\u3058\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u30e9\u30d9\u30eb\u304c\u306a\u3044\u3082\u306e\u306fNaN\u306b\u306a\u308b\nNaN\u306b\u3057\u305f\u304f\u306a\u3044\u5834\u5408\u306ffill_value\u3067NaN\u306b0\u3092\u5145\u3066\u3066\u304b\u3089\u6f14\u7b97\u3059\u308c\u3070\u3088\u3044\n# Series\u3092\u7528\u610f\ns1 = pd.Series(range(6), index=list(\"abcdef\"))\ns2 = pd.Series([10,20,30,40,50], index=list(\"asdfg\"))\n\nprint s1\n\"\"\"\na    0\nb    1\nc    2\nd    3\ne    4\nf    5\ndtype: int64\n\"\"\"\n\nprint s2\n\"\"\"\na    10\ns    20\nd    30\nf    40\ng    50\ndtype: int64\n\"\"\"\n\n# s1 + s2\u3067\u3082\u3088\u3044\nprint s1.add(s2)\n\"\"\"\na    10\nb   NaN\nc   NaN\nd    33\ne   NaN\nf    45\ng   NaN\ns   NaN\ndtype: float64\n\"\"\"\n\n# NaN\u30920\u306b\u7f6e\u63db\u3057\u3066\u304b\u3089\u6f14\u7b97\nprint s1.add(s2, fill_value=0)\n\"\"\"\na    10\nb     1\nc     2\nd    33\ne     4\nf    45\ng    50\ns    20\ndtype: float64\n\"\"\"\n\n# DataFrame\u3092\u6e96\u5099\ndf1 = DataFrame(arange(30).reshape((6,5)), index=list(\"ASDFGH\"), columns=list(\"abcde\"))\ndf2 = DataFrame(arange(42).reshape((7,6)), index=list(\"ASDFGHJ\"), columns=list(\"abcdef\"))\n\nprint df1\n\"\"\"\n    a   b   c   d   e\nA   0   1   2   3   4\nS   5   6   7   8   9\nD  10  11  12  13  14\nF  15  16  17  18  19\nG  20  21  22  23  24\nH  25  26  27  28  29\n\"\"\"\n\nprint df2\n\"\"\"\n    a   b   c   d   e   f\nA   0   1   2   3   4   5\nS   6   7   8   9  10  11\nD  12  13  14  15  16  17\nF  18  19  20  21  22  23\nG  24  25  26  27  28  29\nH  30  31  32  33  34  35\nJ  36  37  38  39  40  41\n\"\"\"\n\n# df1 + df2\u3067\u3082\u3088\u3044\nprint df1.add(df2)\n\"\"\"\n    a   b   c   d   e   f\nA   0   2   4   6   8 NaN\nD  22  24  26  28  30 NaN\nF  33  35  37  39  41 NaN\nG  44  46  48  50  52 NaN\nH  55  57  59  61  63 NaN\nJ NaN NaN NaN NaN NaN NaN\nS  11  13  15  17  19 NaN\n\"\"\"\n\n# NaN\u30920\u306b\u7f6e\u63db\u3057\u3066\u304b\u3089\u6f14\u7b97\nprint df1.add(df2, fill_value=0)\n\"\"\"\n    a   b   c   d   e   f\nA   0   2   4   6   8   5\nD  22  24  26  28  30  17\nF  33  35  37  39  41  23\nG  44  46  48  50  52  29\nH  55  57  59  61  63  35\nJ  36  37  38  39  40  41\nS  11  13  15  17  19  11\n\"\"\"\n\n\u307e\u305f\u3001\u6f14\u7b97\u3059\u308b\u30c7\u30fc\u30bf\u306e\u7247\u65b9\u306e\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u30e9\u30d9\u30eb\u304c\u3082\u3046\u7247\u65b9\u306e\u30c7\u30fc\u30bf\u306e\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u30e9\u30d9\u30eb\u306b\u5b8c\u5168\u306b\u542b\u307e\u308c\u308b\u5834\u5408\u306freindex\u3067fill_value\u3057\u3066\u304b\u3089\u6f14\u7b97\u3092\u3057\u3066\u3082\u826f\u3044\n# \u4e0a\u306edf1\u3068df2\u3092\u4f8b\u306b\n# df1\u306e\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u30e9\u30d9\u30eb\u306fdf2\u306b\u5b8c\u5168\u306b\u542b\u307e\u308c\u3066\u3044\u308b\nprint df1.index.isin(df2.index).all(), df1.columns.isin(df2.columns).all()\n\"\"\"\nTrue True\n\"\"\"\n\nprint df1.reindex(index=df2.index, columns=df2.columns, fill_value=0) + df2\n\"\"\"\n    a   b   c   d   e   f\nA   0   2   4   6   8   5\nS  11  13  15  17  19  11\nD  22  24  26  28  30  17\nF  33  35  37  39  41  23\nG  44  46  48  50  52  29\nH  55  57  59  61  63  35\nJ  36  37  38  39  40  41\n\"\"\"\n\n\n\u968e\u5c64\u7684\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\n\u4e00\u3064\u306e\u884c\u307e\u305f\u306f\u5217\u306b\u5bfe\u3057\u3066\u8907\u6570\u306e\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u30e9\u30d9\u30eb\u3092\u3064\u3051\u308b\u3053\u3068\u304c\u3067\u304d\u308b\n\u968e\u5c64\u7684\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u306e\u30e9\u30d9\u30eb\u3067\u30bd\u30fc\u30c8\u3059\u308b\u5834\u5408\u306fsortlevel\u30e1\u30bd\u30c3\u30c9\u3092\u4f7f\u3046\n# Series\ns = Series(range(10), index=[list(\"aaabbbccdd\"),[1,2,3,2,1,3,1,2,1,2]])\nprint s\n\"\"\"\na  1    0\n   2    1\n   3    2\nb  2    3\n   1    4\n   3    5\nc  1    6\n   2    7\nd  1    8\n   2    9\ndtype: int64\n\"\"\"\n\n# \u5916\u5074\u306e\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u30e9\u30d9\u30eb\u3092\u53c2\u7167\nprint s[\"a\"]\n\"\"\"\n1    0\n2    1\n3    2\ndtype: int64\n\"\"\"\n\n# \u5185\u5074\u306e\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u30e9\u30d9\u30eb\u3092\u53c2\u7167\nprint s[:, 1]\n\"\"\"\na    0\nb    4\nc    6\nd    8\ndtype: int64\n\"\"\"\n\n# \u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u30e9\u30d9\u30eb\u306e\u968e\u5c64\u3092\u5909\u66f4\n# 0\u968e\u5c64\u76ee\u306e\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u30e9\u30d9\u30eb\u30681\u968e\u5c64\u76ee\u306e\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u30e9\u30d9\u30eb\u3092\u5165\u308c\u66ff\u3048\n# s.swaplevel(1, 0)\u3067\u3082\u3088\u3044\nprint s.swaplevel(0, 1)\n\"\"\"\n1  a    0\n2  a    1\n3  a    2\n2  b    3\n1  b    4\n3  b    5\n1  c    6\n2  c    7\n1  d    8\n2  d    9\ndtype: int64\n\"\"\"\n\n# \u5916\u5074\u306e\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u30e9\u30d9\u30eb\u3067\u30bd\u30fc\u30c8\nprint s.swaplevel(0,1).sortlevel(0)\n\"\"\"\n1  a    0\n   b    4\n   c    6\n   d    8\n2  a    1\n   b    3\n   c    7\n   d    9\n3  a    2\n   b    5\ndtype: int64\n\"\"\"\n\n\nstack\u30e1\u30bd\u30c3\u30c9\u3068unstack\u30e1\u30bd\u30c3\u30c9\nstack\u306f\u5217\u304b\u3089\u884c\u3078\u306e\u30d4\u30dc\u30c3\u30c8\u5909\u63db\nunstack\u306f\u884c\u304b\u3089\u5217\u3078\u306e\u30d4\u30dc\u30c3\u30c8\u5909\u63db\n\u884c\u3068\u5217\u306e\u5909\u63db\u306a\u306e\u3067DataFrame\u304b\u968e\u5c64\u7684\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u30e9\u30d9\u30eb\u3092\u6301\u3064Series\u3067\u306a\u3044\u3068\u4f7f\u3048\u306a\u3044\n# \u968e\u5c64\u7684\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u30e9\u30d9\u30eb\u3092\u3082\u3064Series\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\nprint s\n\"\"\"\na  1    0\n   2    1\n   3    2\nb  2    3\n   1    4\n   3    5\nc  1    6\n   2    7\nd  1    8\n   2    9\ndtype: int64\n\"\"\"\n\n# \u884c\u3092\u5217\u3078\u5909\u63db\nprint s.unstack()\n\"\"\"\n   1  2   3\na  0  1   2\nb  4  3   5\nc  6  7 NaN\nd  8  9 NaN\n\"\"\"\n\nprint df\n\"\"\"\n    a   b   c   d   e\nA   0   1   2   3   4\nS   5   6   7   8   9\nD  10  11  12  13  14\nF  15  16  17  18  19\nG  20  21  22  23  24\nH  25  26  27  28  29\n\"\"\"\n\n# \u5217\u3092\u884c\u3078\nprint df.stack()\n\"\"\"\nA  a     0\n   b     1\n   c     2\n   d     3\n   e     4\nS  a     5\n   b     6\n   c     7\n   d     8\n   e     9\nD  a    10\n   b    11\n   c    12\n   d    13\n   e    14\nF  a    15\n   b    16\n   c    17\n   d    18\n   e    19\nG  a    20\n   b    21\n   c    22\n   d    23\n   e    24\nH  a    25\n   b    26\n   c    27\n   d    28\n   e    29\ndtype: int64\n\"\"\"\n\n# \u884c\u3092\u5217\u3078\nprint df.unstack()\n\"\"\"\na  A     0\n   S     5\n   D    10\n   F    15\n   G    20\n   H    25\nb  A     1\n   S     6\n   D    11\n   F    16\n   G    21\n   H    26\nc  A     2\n   S     7\n   D    12\n   F    17\n   G    22\n   H    27\nd  A     3\n   S     8\n   D    13\n   F    18\n   G    23\n   H    28\ne  A     4\n   S     9\n   D    14\n   F    19\n   G    24\n   H    29\ndtype: int64\n\"\"\"\n\n\n\u540d\u524d\u4ed8\u3051\n\n\u884c\u307e\u305f\u306f\u5217\u306e\u540d\u524d\u4ed8\u3051\n\u884c\u306e\u5834\u5408\u306findex\u3001\u5217\u306e\u5834\u5408\u306fcolumns\u5c5e\u6027\u3092\u4e0a\u66f8\u304d\u3059\u308b\u3068\u540d\u524d\u3092\u5909\u3048\u308b\u3053\u3068\u304c\u3067\u304d\u308b\n\u3082\u3057\u304f\u306frename\u30e1\u30bd\u30c3\u30c9\u3092\u4f7f\u3063\u3066\u5909\u66f4\u524d\u306e\u540d\u524d\u3068\u5909\u66f4\u5f8c\u306e\u540d\u524d\u3092\u8f9e\u66f8\u5f62\u5f0f\u3067\u6e21\u3059\nrename\u30e1\u30bd\u30c3\u30c9\u3092\u4f7f\u3046\u3068\u30c7\u30fc\u30bf\u306e\u30b3\u30d4\u30fc\u304c\u8fd4\u3055\u308c\u3001\u5143\u306e\u30c7\u30fc\u30bf\u306f\u5909\u66f4\u3055\u308c\u306a\u3044\nprint df\n\"\"\"\n    a   b   c   d   e\nA   0   1   2   3   4\nS   5   6   7   8   9\nD  10  11  12  13  14\nF  15  16  17  18  19\nG  20  21  22  23  24\nH  25  26  27  28  29\n\"\"\"\n\n# \u884c\u540d\u3092\u5909\u66f4\ndf.index = [\"AAA\", \"SSS\", \"DDD\", \"FFF\", \"GGG\", \"HHH\"]\n# \u5217\u540d\u3092\u5909\u66f4\ndf.columns=[\"one\", \"two\", \"three\", \"four\", \"five\"]\n\nprint df\n\"\"\"\n     one  two  three  four  five\nAAA    0    1      2     3     4\nSSS    5    6      7     8     9\nDDD   10   11     12    13    14\nFFF   15   16     17    18    19\nGGG   20   21     22    23    24\nHHH   25   26     27    28    29\n\"\"\"\n\n# rename\u3092\u4f7f\u3046\nprint df.rename(index={\"AAA\":\"a\", \"SSS\":\"s\", \"DDD\":\"d\", \"FFF\":\"f\", \"GGG\":\"g\", \"HHH\":\"h\"},\ncolumns={\"one\":1, \"two\":2, \"three\":3, \"four\":4, \"five\":5})\n\"\"\"\n    1   2   3   4   5\na   0   1   2   3   4\ns   5   6   7   8   9\nd  10  11  12  13  14\nf  15  16  17  18  19\ng  20  21  22  23  24\nh  25  26  27  28  29\n\"\"\"\n\n\n\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u30e9\u30d9\u30eb\u81ea\u4f53\u306e\u540d\u524d\u4ed8\u3051\n\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u30e9\u30d9\u30eb\u81ea\u4f53\u306b\u540d\u524d\u3092\u4ed8\u3051\u308b\u4e8b\u304c\u304c\u3067\u304d\u308b\n\u4ed8\u3051\u305f\u540d\u524d\u306fswaplevel\u3084unstack\u306a\u3069\u306e\u8ef8\u306e\u5909\u63db\u3092\u3059\u308b\u3068\u304d\u306b\u4f7f\u3046\u3053\u3068\u304c\u3067\u304d\u308b\n# \u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u306e\u540d\u524d\u3092\u5909\u66f4\ndf.index.names = [\"UPPER\"]\n# \u30ab\u30e9\u30e0\u306e\u540d\u524d\u3092\u5909\u66f4\ndf.columns.names = [\"lower\"]\n\nprint df\n\"\"\"\nlower  one  two  three  four  five\nUPPER                             \nAAA      0    1      2     3     4\nSSS      5    6      7     8     9\nDDD     10   11     12    13    14\nFFF     15   16     17    18    19\nGGG     20   21     22    23    24\nHHH     25   26     27    28    29\n\"\"\"\n\n\n\u30d3\u30f3\u30cb\u30f3\u30b0\n(\u30d3\u30f3\u3068\u306f\u30d2\u30b9\u30c8\u30b0\u30e9\u30e0\u306e\u67f1\u306e\u3053\u3068)\npd.cut\u30e1\u30bd\u30c3\u30c9\u3092\u4f7f\u3046\u3068\u30c7\u30fc\u30bf\u306e\u5024\u3092\u30d3\u30f3\u306b\u5206\u5272\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u308b\n# \u5e74\u9f62\u3068\u6027\u5225\u306e\u30c7\u30fc\u30bf\ndf = DataFrame([[20,\"F\"],[22,\"M\"],[25,\"M\"],[27,\"M\"],[21,\"F\"],[23,\"M\"],[37,\"F\"],[31,\"M\"],[61,\"F\"],[45,\"M\"],[41,\"F\"],[32,\"M\"]], columns=[\"age\", \"sex\"])\nprint df\n\"\"\"\n   age sex\n0   20   F\n1   22   M\n2   25   M\n3   27   M\n4   21   F\n5   23   M\n6   37   F\n7   31   M\n8   61   F\n9   45   M\n10  41   F\n11  32   M\n\"\"\"\n\n# \u30d3\u30f3\u306b\u5206\u5272\u3059\u308b\u3068\u304d\u306e\u5024\nbins = [18, 25, 35, 60, 100]\n# \u30d3\u30f3\u306e\u540d\u524d\ngroup_names = [\"Youth\", \"YoungAdult\", \"MiddleAged\", \"Senior\"]\n# \u30d3\u30f3\u5316\nprint pd.cut(df.age, bins, labels=group_names)\n\"\"\"\nCategorical: \n[Youth, Youth, Youth, YoungAdult, Youth, Youth, nan, YoungAdult, nan, nan, nan, YoungAdult]\nLevels (4): Index(['Youth', 'YoungAdult', 'MiddleAged', 'Senior'], dtype=object)\n\"\"\"\n\n# df\u306b\u30d3\u30f3\u306e\u5217\u3092\u8ffd\u52a0\ndf[\"bin\"] = pd.cut(df.age, bins, labels=group_names)\nprint df\n\"\"\"\n    age sex         bin\n0    20   F       Youth\n1    22   M       Youth\n2    25   M       Youth\n3    27   M  YoungAdult\n4    21   F       Youth\n5    23   M       Youth\n6    37   F  MiddleAged\n7    31   M  YoungAdult\n8    61   F      Senior\n9    45   M  MiddleAged\n10   41   F  MiddleAged\n11   32   M  YoungAdult\n\"\"\"\n\n\n\u5217\u3068\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u306e\u5909\u63db\n\u7279\u5b9a\u306e\u5217\u306e\u307f\u3092\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u306b\u5909\u63db\u3057\u305f\u3044\u5834\u5408\u306fDataFrame\u306eset_index\u30e1\u30bd\u30c3\u30c9\u3092\u4f7f\u3046\nprint df\n\"\"\"\n    age sex         bin\n0    20   F       Youth\n1    22   M       Youth\n2    25   M       Youth\n3    27   M  YoungAdult\n4    21   F       Youth\n5    23   M       Youth\n6    37   F  MiddleAged\n7    31   M  YoungAdult\n8    61   F      Senior\n9    45   M  MiddleAged\n10   41   F  MiddleAged\n11   32   M  YoungAdult\n\"\"\"\n\n# bin\u5217\u3092\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u306b\u5909\u63db\nprint df.set_index(\"bin\")\n\"\"\"\n            age sex\nbin                \nYouth        20   F\nYouth        22   M\nYouth        25   M\nYoungAdult   27   M\nYouth        21   F\nYouth        23   M\nMiddleAged   37   F\nYoungAdult   31   M\nSenior       61   F\nMiddleAged   45   M\nMiddleAged   41   F\nYoungAdult   32   M\n\"\"\"\n\n# \u8907\u6570\u306e\u5217\u3092\u968e\u5c64\u7684\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u306b\u5909\u63db\u3059\u308b\u306b\u306f\u30ea\u30b9\u30c8\u3092\u5f15\u6570\u306b\u4e0e\u3048\u308b\nprint df.set_index([\"bin\", \"sex\"])\n\"\"\"\n                age\nbin        sex     \nYouth      F     20\n           M     22\n           M     25\nYoungAdult M     27\nYouth      F     21\n           M     23\nMiddleAged F     37\nYoungAdult M     31\nSenior     F     61\nMiddleAged M     45\n           F     41\nYoungAdult M     32\n\"\"\"\n\n# \u30bd\u30fc\u30c8\nprint df.set_index([\"bin\", \"sex\"]).sortlevel(\"bin\")\n\"\"\"\n                age\nbin        sex     \nMiddleAged F     37\n           F     41\n           M     45\nSenior     F     61\nYoungAdult M     27\n           M     31\n           M     32\nYouth      F     20\n           F     21\n           M     22\n           M     25\n           M     23\n\"\"\"\n\n\n\u30e9\u30f3\u30c0\u30e0\u30b5\u30f3\u30d7\u30ea\u30f3\u30b0\nDataFrame\u306etake\u3092\u4f7f\u3046\u3068\u5fc5\u8981\u306a\u884c\u3060\u3051\u53d6\u308a\u51fa\u3059\u3053\u3068\u304c\u3067\u304d\u308b\n\u3053\u308c\u3092\u5229\u7528\u3057\u3066\u30e9\u30f3\u30c0\u30e0\u306b\u5217\u3092\u53d6\u308a\u51fa\u305b\u3070\u30e9\u30f3\u30c0\u30e0\u30b5\u30f3\u30d7\u30ea\u30f3\u30b0\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u308b\n# \u30b5\u30f3\u30d7\u30ea\u30f3\u30b0\u3059\u308b\u884c\u3092\u6307\u5b9a\nprint df.take([1, 3, 5])\n\"\"\"\n   age sex         bin\n1   22   M       Youth\n3   27   M  YoungAdult\n5   23   M       Youth\n\"\"\"\n\n# \u30e9\u30f3\u30c0\u30e0\u306b5\u3064\u30b5\u30f3\u30d7\u30ea\u30f3\u30b0\nsampler = np.random.permutation(len(df))\nprint df.take(sampler[:5])\n\"\"\"\n   age sex         bin\n8   61   F      Senior\n2   25   M       Youth\n7   31   M  YoungAdult\n1   22   M       Youth\n0   20   F       Youth\n\"\"\"\n\n\n\u30ab\u30c6\u30b4\u30ea\u30ab\u30eb\u30c7\u30fc\u30bf\u3092\u30c0\u30df\u30fc\u5909\u6570\u5316\npandas\u306eget_dummies\u30e1\u30bd\u30c3\u30c9\u3092\u4f7f\u3046\u3068\u30ab\u30c6\u30b4\u30ea\u30ab\u30eb\u30c7\u30fc\u30bf (\u8cea\u7684\u30c7\u30fc\u30bf) \u3092\u30c0\u30df\u30fc\u5909\u6570\u306b\u5909\u63db\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u308b\n\u6570\u91cf\u5316I\u985e\u3068\u304b\u3059\u308b\u3068\u304d\u306b\u4f7f\u3046\u30a2\u30ec\n# \u6027\u5225column\u3092\u30c0\u30df\u30fc\u5909\u6570\u5316\ndum = pd.get_dummies(df[\"sex\"])\nprint dum\n\"\"\"\n    F  M\n0   1  0\n1   0  1\n2   0  1\n3   0  1\n4   1  0\n5   0  1\n6   1  0\n7   0  1\n8   1  0\n9   0  1\n10  1  0\n11  0  1\n\"\"\"\n\n# df\u306b\u8ffd\u52a0\ndf = pd.concat((df, dum), axis=1)\ndf = df.drop(\"sex\", axis=1)\nprint df\n\"\"\"\n    age         bin  F  M\n0    20       Youth  1  0\n1    22       Youth  0  1\n2    25       Youth  0  1\n3    27  YoungAdult  0  1\n4    21       Youth  1  0\n5    23       Youth  0  1\n6    37  MiddleAged  1  0\n7    31  YoungAdult  0  1\n8    61      Senior  1  0\n9    45  MiddleAged  0  1\n10   41  MiddleAged  1  0\n11   32  YoungAdult  0  1\n\"\"\"\n\n\n\u30b0\u30eb\u30fc\u30d4\u30f3\u30b0\ngroupby\u3092\u4f7f\u3046\u3053\u3068\u3067\u5024\u306b\u3088\u308b\u30b0\u30eb\u30fc\u30d4\u30f3\u30b0\u304c\u884c\u3048\u308b\n\u305d\u308c\u305e\u308c\u306e\u30b0\u30eb\u30fc\u30d7\u306b\u540c\u3058\u51e6\u7406\u3092\u9069\u7528\u3059\u308b\u306b\u306fgroupby\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306eapply\u30e1\u30bd\u30c3\u30c9\u3092\u4f7f\u3046\nprint df.groupby(\"bin\")\n\"\"\"\n<pandas.core.groupby.DataFrameGroupBy object at 0x106af9a90>\n\"\"\"\n\n# \u30b0\u30eb\u30fc\u30d7\u3054\u3068\u306bmean\u3092\u8a08\u7b97\nf = lambda x: x.mean()\nprint df.groupby(\"bin\").apply(f)\n\"\"\"\n             age         F         M\nbin                                 \nMiddleAged  41.0  0.666667  0.333333\nSenior      61.0  1.000000  0.000000\nYoungAdult  30.0  0.000000  1.000000\nYouth       22.2  0.400000  0.600000\n\"\"\"\n\n\u4f8b: \u30d3\u30f3\u5206\u6790\n\u30d3\u30f3\u306e\u5024\u30b0\u30eb\u30fc\u30d4\u30f3\u30b0\u3057\u3001\u305d\u308c\u305e\u308c\u306e\u30d3\u30f3\u3054\u3068\u306b\u7d71\u8a08\u91cf\u3092\u51fa\u3059\nframe = DataFrame({\"data1\": np.random.randn(1000), \"data2\":np.random.randn(1000)})\nfactor = pd.cut(frame.data1, 4)  # data1\u306e\u5024\u306e\u7bc4\u56f2\u3092\u5747\u7b49\u306b4\u3064\u306e\u30d3\u30f3\u306b\u5206\u5272\n\n# apply\u3059\u308b\u305f\u3081\u306e\u95a2\u6570\u3092\u5b9a\u7fa9\ndef get_stats(group):\n    return {\"min\": group.min(), \"max\": group.max(), \"count\": group.count(), \"mean\": group.mean()}\n\n# data2\u306e\u5024\u306e\u7d71\u8a08\u91cf\u3092data1\u306e\u30d3\u30f3\u3054\u3068\u306b\u51fa\u3059\ngrouped = frame.data2.groupby(factor)\nprint grouped.apply(get_stats).unstack()\n\"\"\"\n                  count       max      mean       min\ndata1                                                \n(-3.205, -1.673]     44  2.544910 -0.108558 -1.984124\n(-1.673, -0.147]    414  3.420818  0.003078 -3.168528\n(-0.147, 1.379]     447  2.563359 -0.018062 -3.175148\n(1.379, 2.905]       95  2.498611  0.140166 -2.439985\n\"\"\"\n\nagg\u30e1\u30bd\u30c3\u30c9\u3092\u4f7f\u3046\u3068GroupBy\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306e\u30ab\u30e9\u30e0\u3054\u3068\u306b\u540c\u3058\u95a2\u6570\u3092\u9069\u7528\u3067\u304d\u308b\ndf[\"random\"] = [random.choice((0,1)) for i in range(len(df))]\nprint df\n\"\"\"\n    age sex  random\n0    20   F       1\n1    22   M       1\n2    25   M       1\n3    27   M       0\n4    21   F       1\n5    23   M       1\n6    37   F       1\n7    31   M       0\n8    61   F       1\n9    45   M       1\n10   41   F       0\n11   32   M       0\n\"\"\"\n\nprint df.groupby(\"sex\").agg([np.max, np.min, np.mean])\n\"\"\"\n      age                   random                \n     amax  amin       mean    amax  amin      mean\nsex                                               \nF      61    20  36.000000       1     0  0.800000\nM      45    22  29.285714       1     0  0.571429\n\"\"\"\n\n\nPython for Data Analysis\u306e\u65e5\u672c\u8a9e\u7248\u767a\u58f2\u8a18\u5ff5\u306b\n\u3088\u304f\u4f7f\u3044\u305d\u3046\u306a\u3082\u306e\u3068\u304b\u8a70\u307e\u308a\u305d\u3046\u306a\u3068\u3053\u308d\u3068\u304b\n\n\u3081\u3061\u3083\u304f\u3061\u3083\u9577\u304f\u306a\u3063\u3066\u3057\u307e\u3063\u305f\u306e\u3067\u76ee\u6b21\n\n* [\u8907\u6570\u306eSeries\u3092\u7d50\u5408\u3057\u3066DataFrame\u306b](http://qiita.com/airtoxin/items/d66a22c5c7074e23be17#2-1)\n* [DataFrame\u306e\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u53c2\u7167](http://qiita.com/airtoxin/items/d66a22c5c7074e23be17#2-2)\n * [column\u306e\u53c2\u7167](http://qiita.com/airtoxin/items/d66a22c5c7074e23be17#3-1)\n * [row\u306e\u53c2\u7167](http://qiita.com/airtoxin/items/d66a22c5c7074e23be17#3-2)\n * [\u884c\u3068\u5217\u3092\u540c\u6642\u306b\u7bc4\u56f2\u6307\u5b9a\u3057\u3066\u53c2\u7167 (ix\u306b\u3088\u308b\u53c2\u7167)](http://qiita.com/airtoxin/items/d66a22c5c7074e23be17#3-3)\n* [Series\u306e\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u53c2\u7167](http://qiita.com/airtoxin/items/d66a22c5c7074e23be17#2-3)\n* [bool\u5024\u306b\u3088\u308b\u30de\u30b9\u30ad\u30f3\u30b0](http://qiita.com/airtoxin/items/d66a22c5c7074e23be17#2-4)\n* [Series\u540c\u58eb, DataFrame\u540c\u58eb\u306e\u6f14\u7b97](http://qiita.com/airtoxin/items/d66a22c5c7074e23be17#2-5)\n* [\u968e\u5c64\u7684\u30a4\u30f3\u30c7\u30c3\u30af\u30b9](http://qiita.com/airtoxin/items/d66a22c5c7074e23be17#2-6)\n* [stack\u30e1\u30bd\u30c3\u30c9\u3068unstack\u30e1\u30bd\u30c3\u30c9](http://qiita.com/airtoxin/items/d66a22c5c7074e23be17#2-7)\n* [\u540d\u524d\u4ed8\u3051](http://qiita.com/airtoxin/items/d66a22c5c7074e23be17#2-8)\n * [\u884c\u307e\u305f\u306f\u5217\u306e\u540d\u524d\u4ed8\u3051](http://qiita.com/airtoxin/items/d66a22c5c7074e23be17#3-4)\n * [\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u30e9\u30d9\u30eb\u81ea\u4f53\u306e\u540d\u524d\u4ed8\u3051](http://qiita.com/airtoxin/items/d66a22c5c7074e23be17#3-5)\n* [\u30d3\u30f3\u30cb\u30f3\u30b0](http://qiita.com/airtoxin/items/d66a22c5c7074e23be17#2-9)\n* [\u5217\u3068\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u306e\u5909\u63db](http://qiita.com/airtoxin/items/d66a22c5c7074e23be17#2-10)\n* [\u30e9\u30f3\u30c0\u30e0\u30b5\u30f3\u30d7\u30ea\u30f3\u30b0](http://qiita.com/airtoxin/items/d66a22c5c7074e23be17#2-11)\n* [\u30ab\u30c6\u30b4\u30ea\u30ab\u30eb\u30c7\u30fc\u30bf\u3092\u30c0\u30df\u30fc\u5909\u6570\u5316](http://qiita.com/airtoxin/items/d66a22c5c7074e23be17#2-12)\n* [\u30b0\u30eb\u30fc\u30d4\u30f3\u30b0](http://qiita.com/airtoxin/items/d66a22c5c7074e23be17#2-13)\n\n##\u8907\u6570\u306eSeries\u3092\u7d50\u5408\u3057\u3066DataFrame\u306b\nconcat\u3092\u4f7f\u3063\u3066\u3067axis=1\u306b\u3059\u308c\u3070\u826f\u3044\n\n```py\ns1 = pd.Series([1,2,3,4,5], index=[0,1,2,3,4])\ns2 = pd.Series([10,20,30,40,50], index=[10,11,12,13,14])\ns3 = pd.Series([100,200,300,400,500], index=[0,2,4,6,8])\nprint pd.concat([s1, s2, s3], axis=1)\n\"\"\"\n     0   1    2\n0    1 NaN  100\n1    2 NaN  NaN\n2    3 NaN  200\n3    4 NaN  NaN\n4    5 NaN  300\n6  NaN NaN  400\n8  NaN NaN  500\n10 NaN  10  NaN\n11 NaN  20  NaN\n12 NaN  30  NaN\n13 NaN  40  NaN\n14 NaN  50  NaN\n\"\"\"\n```\n\n##DataFrame\u306e\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u53c2\u7167\n\u8272\u3005\u7528\u610f\u3055\u308c\u3066\u3044\u3066\u6df7\u4e71\u3059\u308b\n\u3081\u3093\u3069\u304f\u3055\u3044\u3051\u3069ix\u306b\u3088\u308b\u53c2\u7167\u304c\u4e00\u756a\u308f\u304b\u308a\u6613\u3044\u3068\u601d\u3046\n\n```py\n# DataFrame\u3092\u7528\u610f\ndf = DataFrame(arange(30).reshape((6, 5)), index=list(\"ASDFGH\"), columns=list(\"abcde\"))\nprint df\n\"\"\"\n    a   b   c   d   e\nA   0   1   2   3   4\nS   5   6   7   8   9\nD  10  11  12  13  14\nF  15  16  17  18  19\nG  20  21  22  23  24\nH  25  26  27  28  29\n\"\"\"\n```\n\n###column\u306e\u53c2\u7167\n\u30ab\u30e9\u30e0\u306e\u53c2\u7167\u306f\u30ab\u30e9\u30e0\u540d\u3092\u6307\u5b9a\u3059\u308b\n\u8907\u6570\u6307\u5b9a\u3059\u308b\u5834\u5408\u306f\u30ea\u30b9\u30c8\u5f62\u5f0f\u306b\u3057\u3066\u6307\u5b9a\n\u6307\u5b9a\u3059\u308b\u30ab\u30e9\u30e0\u304c1\u3064\u306e\u5834\u5408\u306f\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u5909\u6570\u304c\u30ab\u30e9\u30e0\u540d\u3067\u7528\u610f\u3055\u308c\u3066\u3044\u308b\u306e\u3067\u305d\u308c\u3092\u6307\u5b9a\u3057\u3066\u3082\u826f\u3044\n\n```py\n# \u30ab\u30e9\u30e0\u540d\u3092\u6307\u5b9a\nprint df[\"a\"]\n\"\"\"\nA     0\nS     5\nD    10\nF    15\nG    20\nH    25\nName: a, dtype: int64\n\"\"\"\n\n# \u8907\u6570\u306e\u30ab\u30e9\u30e0\u540d\u3092\u6307\u5b9a\nprint df[[\"a\", \"c\", \"e\"]]\n\"\"\"\n    a   c   e\nA   0   2   4\nS   5   7   9\nD  10  12  14\nF  15  17  19\nG  20  22  24\nH  25  27  29\n\"\"\"\n\n# \u30ab\u30e9\u30e0\u540d\u306e\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u5909\u6570\u3092\u6307\u5b9a\nprint df.a\n\"\"\"\nA     0\nS     5\nD    10\nF    15\nG    20\nH    25\n\"\"\"\n```\n\n###row\u306e\u53c2\u7167\n\u30b9\u30e9\u30a4\u30b7\u30f3\u30b0\u306a\u3069\u306b\u3088\u3063\u3066\u6307\u5b9a\n\u884c\u306b\u4ed8\u3044\u3066\u3044\u308b\u540d\u524d (\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u30e9\u30d9\u30eb) \u306b\u3088\u308b\u6307\u5b9a\u306f\u5f8c\u8ff0\n\n```py\nprint df[0:3]\n\"\"\"\n    a   b   c   d   e\nA   0   1   2   3   4\nS   5   6   7   8   9\nD  10  11  12  13  14\n\"\"\"\n\n# \u8ca0\u306e\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u6307\u5b9a\nprint df[-2:]\n\"\"\"\n    a   b   c   d   e\nG  20  21  22  23  24\nH  25  26  27  28  29\n\"\"\"\n```\n\n###\u884c\u3068\u5217\u3092\u540c\u6642\u306b\u7bc4\u56f2\u6307\u5b9a\u3057\u3066\u53c2\u7167 (ix\u306b\u3088\u308b\u53c2\u7167)\nix\u30a2\u30c8\u30ea\u30d3\u30e5\u30fc\u30c8\u3092\u30b9\u30e9\u30a4\u30b7\u30f3\u30b0\u3059\u308b\u4e8b\u3067\u53c2\u7167\u304c\u53ef\u80fd\n\u5b9f\u969b\u3053\u308c\u3060\u3051\u899a\u3048\u3066\u304a\u3051\u3070\u3069\u3093\u306a\u6642\u306b\u3082\u540c\u3058\u5f62\u5f0f\u3067\u4f7f\u3048\u308b\u3057\u4fbf\u5229\n\u6307\u5b9a\u306fNumPy\u306e\uff12\u6b21\u5143\u914d\u5217\u306e\u30b9\u30e9\u30a4\u30b7\u30f3\u30b0\u306e\u3088\u3046\u306b[\u884c, \u5217]\u3067\u884c\u3046\n\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u30e9\u30d9\u30eb\u306b\u3088\u308b\u6307\u5b9a\u3082\u53ef\u80fd\n\u305f\u3060\u3057\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u30e9\u30d9\u30eb\u306b\u3088\u308b\u30b9\u30e9\u30a4\u30b7\u30f3\u30b0\u306e\u5834\u5408\u3001\u5f8c\u308d\u306e\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u30e9\u30d9\u30eb\u306f\u7bc4\u56f2\u306b\u542b\u307e\u308c\u308b\u4e8b\u306b\u6ce8\u610f\n\n```py\n# \u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u306b\u3088\u308b\u6307\u5b9a\nprint df.ix[0, 3]\n\"\"\"\n3\n\"\"\"\n\n# \u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u306b\u3088\u308b\u30b9\u30e9\u30a4\u30b7\u30f3\u30b0\nprint df.ix[0:3, 0:2]\n\"\"\"\n    a   b\nA   0   1\nS   5   6\nD  10  11\n\"\"\"\n\n# \u96e2\u308c\u305f\u884c\u307e\u305f\u306f\u5217\u3092\u8907\u6570\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u3067\u6307\u5b9a\nprint df.ix[[0, 2, 4], [0, 2, 4]]\n\"\"\"\n    a   c   e\nA   0   2   4\nD  10  12  14\nG  20  22  24\n\"\"\"\n\n# \u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u30e9\u30d9\u30eb\u306b\u3088\u308b\u6307\u5b9a\nprint df.ix[\"D\", \"a\"]\n\"\"\"\n10\n\"\"\"\n\n# \u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u30e9\u30d9\u30eb\u306b\u3088\u308b\u7bc4\u56f2\u6307\u5b9a\nprint df.ix[\"A\":\"D\", \"a\":\"b\"]\n\"\"\"\n    a   b\nA   0   1\nS   5   6\nD  10  11\n\"\"\"\n\n# \u96e2\u308c\u305f\u884c\u307e\u305f\u306f\u5217\u3092\u8907\u6570\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u30e9\u30d9\u30eb\u3067\u6307\u5b9a\nprint df.ix[[\"A\", \"H\", \"S\"], [\"c\", \"b\", \"a\"]]\n\"\"\"\n    c   b   a\nA   2   1   0\nH  27  26  25\nS   7   6   5\n\"\"\"\n```\n\n##Series\u306e\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u53c2\u7167\nDataFrame\u3092\u3084\u3063\u305f\u306e\u3067\u3064\u3044\u3067\u306bSeries\u3082\nDataFrame\u3068\u9055\u3063\u3066\u6700\u521d\u304b\u3089\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u306b\u3088\u308b\u6307\u5b9a\u3082\u3001\n\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u30e9\u30d9\u30eb\u306b\u3088\u308b\u6307\u5b9a\u3082\u53ef\u80fd\u306a\u306e\u3067\u7279\u306b\u3064\u307e\u308b\u6240\u306f\u7121\u3044\u3068\u601d\u3046\n\u30b9\u30e9\u30a4\u30b7\u30f3\u30b0\u3082\u53ef\u80fd\n\n```py\n# Series\u3092\u7528\u610f\ns1 = pd.Series(range(6), index=list(\"abcdef\"))\nprint s1\n\"\"\"\na    0\nb    1\nc    2\nd    3\ne    4\nf    5\ndtype: int64\n\"\"\"\n\n# \u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u306b\u3088\u308b\u6307\u5b9a\nprint s1[0:3]\n\"\"\"\na    0\nb    1\nc    2\ndtype: int64\n\"\"\"\n\n# \u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u30e9\u30d9\u30eb\u306b\u3088\u308b\u6307\u5b9a\nprint [\"b\":\"e\"]\n\"\"\"\nb    1\nc    2\nd    3\ne    4\ndtype: int64\n\"\"\"\n```\n\n##bool\u5024\u306b\u3088\u308b\u30de\u30b9\u30ad\u30f3\u30b0\nNumPy\u306endarray\u306e\u3088\u3046\u306bSeries\u307e\u305f\u306fDataFrame\u306b\u5bfe\u3057\u3066\u8a55\u4fa1\u3092\u884c\u3046\u3068\u3001\u305d\u308c\u305e\u308c\u306e\u8981\u7d20\u306b\u5bfe\u3057\u3066\u305d\u306e\u8a55\u4fa1\u304c\u884c\u308f\u308c\u305fbool\u306eSeries\u307e\u305f\u306fDataFrame\u304c\u304b\u3048\u3063\u3066\u304f\u308b\n\n```py\nprint df > 5\n\"\"\"\n       a      b      c      d      e\nA  False  False  False  False  False\nS  False   True   True   True   True\nD   True   True   True   True   True\nF   True   True   True   True   True\nG   True   True   True   True   True\nH   True   True   True   True   True\n\"\"\"\n\nprint s1 > 3\n\"\"\"\na    False\nb    False\nc    False\nd    False\ne     True\nf     True\ndtype: bool\n\"\"\"\n```\n\n\u8fd4\u3063\u3066\u304d\u305f\u3082\u306e\u3067\u5143\u306eSeries\u307e\u305f\u306fDataFrame\u3092\u30de\u30b9\u30af\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u308b\n\n```py\n# DataFrame\u306e\u30de\u30b9\u30af\nprint df[df > 5]\n\"\"\"\n    a   b   c   d   e\nA NaN NaN NaN NaN NaN\nS NaN   6   7   8   9\nD  10  11  12  13  14\nF  15  16  17  18  19\nG  20  21  22  23  24\nH  25  26  27  28  29\n\"\"\"\n\n# Series\u306e\u30de\u30b9\u30af\nprint s1[s1 > 3]\n\"\"\"\ne    4\nf    5\ndtype: int64\n\"\"\"\n```\n\n##Series\u540c\u58eb, DataFrame\u540c\u58eb\u306e\u6f14\u7b97\n\u540c\u3058\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u30e9\u30d9\u30eb\u540c\u58eb\u3067\u6f14\u7b97\u304c\u884c\u308f\u308c\u308b\n\u540c\u3058\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u30e9\u30d9\u30eb\u304c\u306a\u3044\u3082\u306e\u306fNaN\u306b\u306a\u308b\nNaN\u306b\u3057\u305f\u304f\u306a\u3044\u5834\u5408\u306ffill_value\u3067NaN\u306b0\u3092\u5145\u3066\u3066\u304b\u3089\u6f14\u7b97\u3059\u308c\u3070\u3088\u3044\n\n```py\n# Series\u3092\u7528\u610f\ns1 = pd.Series(range(6), index=list(\"abcdef\"))\ns2 = pd.Series([10,20,30,40,50], index=list(\"asdfg\"))\n\nprint s1\n\"\"\"\na    0\nb    1\nc    2\nd    3\ne    4\nf    5\ndtype: int64\n\"\"\"\n\nprint s2\n\"\"\"\na    10\ns    20\nd    30\nf    40\ng    50\ndtype: int64\n\"\"\"\n\n# s1 + s2\u3067\u3082\u3088\u3044\nprint s1.add(s2)\n\"\"\"\na    10\nb   NaN\nc   NaN\nd    33\ne   NaN\nf    45\ng   NaN\ns   NaN\ndtype: float64\n\"\"\"\n\n# NaN\u30920\u306b\u7f6e\u63db\u3057\u3066\u304b\u3089\u6f14\u7b97\nprint s1.add(s2, fill_value=0)\n\"\"\"\na    10\nb     1\nc     2\nd    33\ne     4\nf    45\ng    50\ns    20\ndtype: float64\n\"\"\"\n\n# DataFrame\u3092\u6e96\u5099\ndf1 = DataFrame(arange(30).reshape((6,5)), index=list(\"ASDFGH\"), columns=list(\"abcde\"))\ndf2 = DataFrame(arange(42).reshape((7,6)), index=list(\"ASDFGHJ\"), columns=list(\"abcdef\"))\n\nprint df1\n\"\"\"\n    a   b   c   d   e\nA   0   1   2   3   4\nS   5   6   7   8   9\nD  10  11  12  13  14\nF  15  16  17  18  19\nG  20  21  22  23  24\nH  25  26  27  28  29\n\"\"\"\n\nprint df2\n\"\"\"\n    a   b   c   d   e   f\nA   0   1   2   3   4   5\nS   6   7   8   9  10  11\nD  12  13  14  15  16  17\nF  18  19  20  21  22  23\nG  24  25  26  27  28  29\nH  30  31  32  33  34  35\nJ  36  37  38  39  40  41\n\"\"\"\n\n# df1 + df2\u3067\u3082\u3088\u3044\nprint df1.add(df2)\n\"\"\"\n    a   b   c   d   e   f\nA   0   2   4   6   8 NaN\nD  22  24  26  28  30 NaN\nF  33  35  37  39  41 NaN\nG  44  46  48  50  52 NaN\nH  55  57  59  61  63 NaN\nJ NaN NaN NaN NaN NaN NaN\nS  11  13  15  17  19 NaN\n\"\"\"\n\n# NaN\u30920\u306b\u7f6e\u63db\u3057\u3066\u304b\u3089\u6f14\u7b97\nprint df1.add(df2, fill_value=0)\n\"\"\"\n    a   b   c   d   e   f\nA   0   2   4   6   8   5\nD  22  24  26  28  30  17\nF  33  35  37  39  41  23\nG  44  46  48  50  52  29\nH  55  57  59  61  63  35\nJ  36  37  38  39  40  41\nS  11  13  15  17  19  11\n\"\"\"\n```\n\n\u307e\u305f\u3001\u6f14\u7b97\u3059\u308b\u30c7\u30fc\u30bf\u306e\u7247\u65b9\u306e\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u30e9\u30d9\u30eb\u304c\u3082\u3046\u7247\u65b9\u306e\u30c7\u30fc\u30bf\u306e\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u30e9\u30d9\u30eb\u306b\u5b8c\u5168\u306b\u542b\u307e\u308c\u308b\u5834\u5408\u306freindex\u3067fill_value\u3057\u3066\u304b\u3089\u6f14\u7b97\u3092\u3057\u3066\u3082\u826f\u3044\n\n```py\n# \u4e0a\u306edf1\u3068df2\u3092\u4f8b\u306b\n# df1\u306e\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u30e9\u30d9\u30eb\u306fdf2\u306b\u5b8c\u5168\u306b\u542b\u307e\u308c\u3066\u3044\u308b\nprint df1.index.isin(df2.index).all(), df1.columns.isin(df2.columns).all()\n\"\"\"\nTrue True\n\"\"\"\n\nprint df1.reindex(index=df2.index, columns=df2.columns, fill_value=0) + df2\n\"\"\"\n    a   b   c   d   e   f\nA   0   2   4   6   8   5\nS  11  13  15  17  19  11\nD  22  24  26  28  30  17\nF  33  35  37  39  41  23\nG  44  46  48  50  52  29\nH  55  57  59  61  63  35\nJ  36  37  38  39  40  41\n\"\"\"\n```\n\n##\u968e\u5c64\u7684\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\n\u4e00\u3064\u306e\u884c\u307e\u305f\u306f\u5217\u306b\u5bfe\u3057\u3066\u8907\u6570\u306e\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u30e9\u30d9\u30eb\u3092\u3064\u3051\u308b\u3053\u3068\u304c\u3067\u304d\u308b\n\u968e\u5c64\u7684\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u306e\u30e9\u30d9\u30eb\u3067\u30bd\u30fc\u30c8\u3059\u308b\u5834\u5408\u306fsortlevel\u30e1\u30bd\u30c3\u30c9\u3092\u4f7f\u3046\n\n```py\n# Series\ns = Series(range(10), index=[list(\"aaabbbccdd\"),[1,2,3,2,1,3,1,2,1,2]])\nprint s\n\"\"\"\na  1    0\n   2    1\n   3    2\nb  2    3\n   1    4\n   3    5\nc  1    6\n   2    7\nd  1    8\n   2    9\ndtype: int64\n\"\"\"\n\n# \u5916\u5074\u306e\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u30e9\u30d9\u30eb\u3092\u53c2\u7167\nprint s[\"a\"]\n\"\"\"\n1    0\n2    1\n3    2\ndtype: int64\n\"\"\"\n\n# \u5185\u5074\u306e\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u30e9\u30d9\u30eb\u3092\u53c2\u7167\nprint s[:, 1]\n\"\"\"\na    0\nb    4\nc    6\nd    8\ndtype: int64\n\"\"\"\n\n# \u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u30e9\u30d9\u30eb\u306e\u968e\u5c64\u3092\u5909\u66f4\n# 0\u968e\u5c64\u76ee\u306e\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u30e9\u30d9\u30eb\u30681\u968e\u5c64\u76ee\u306e\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u30e9\u30d9\u30eb\u3092\u5165\u308c\u66ff\u3048\n# s.swaplevel(1, 0)\u3067\u3082\u3088\u3044\nprint s.swaplevel(0, 1)\n\"\"\"\n1  a    0\n2  a    1\n3  a    2\n2  b    3\n1  b    4\n3  b    5\n1  c    6\n2  c    7\n1  d    8\n2  d    9\ndtype: int64\n\"\"\"\n\n# \u5916\u5074\u306e\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u30e9\u30d9\u30eb\u3067\u30bd\u30fc\u30c8\nprint s.swaplevel(0,1).sortlevel(0)\n\"\"\"\n1  a    0\n   b    4\n   c    6\n   d    8\n2  a    1\n   b    3\n   c    7\n   d    9\n3  a    2\n   b    5\ndtype: int64\n\"\"\"\n```\n\n##stack\u30e1\u30bd\u30c3\u30c9\u3068unstack\u30e1\u30bd\u30c3\u30c9\nstack\u306f\u5217\u304b\u3089\u884c\u3078\u306e\u30d4\u30dc\u30c3\u30c8\u5909\u63db\nunstack\u306f\u884c\u304b\u3089\u5217\u3078\u306e\u30d4\u30dc\u30c3\u30c8\u5909\u63db\n\u884c\u3068\u5217\u306e\u5909\u63db\u306a\u306e\u3067DataFrame\u304b\u968e\u5c64\u7684\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u30e9\u30d9\u30eb\u3092\u6301\u3064Series\u3067\u306a\u3044\u3068\u4f7f\u3048\u306a\u3044\n\n```py\n# \u968e\u5c64\u7684\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u30e9\u30d9\u30eb\u3092\u3082\u3064Series\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\nprint s\n\"\"\"\na  1    0\n   2    1\n   3    2\nb  2    3\n   1    4\n   3    5\nc  1    6\n   2    7\nd  1    8\n   2    9\ndtype: int64\n\"\"\"\n\n# \u884c\u3092\u5217\u3078\u5909\u63db\nprint s.unstack()\n\"\"\"\n   1  2   3\na  0  1   2\nb  4  3   5\nc  6  7 NaN\nd  8  9 NaN\n\"\"\"\n\nprint df\n\"\"\"\n    a   b   c   d   e\nA   0   1   2   3   4\nS   5   6   7   8   9\nD  10  11  12  13  14\nF  15  16  17  18  19\nG  20  21  22  23  24\nH  25  26  27  28  29\n\"\"\"\n\n# \u5217\u3092\u884c\u3078\nprint df.stack()\n\"\"\"\nA  a     0\n   b     1\n   c     2\n   d     3\n   e     4\nS  a     5\n   b     6\n   c     7\n   d     8\n   e     9\nD  a    10\n   b    11\n   c    12\n   d    13\n   e    14\nF  a    15\n   b    16\n   c    17\n   d    18\n   e    19\nG  a    20\n   b    21\n   c    22\n   d    23\n   e    24\nH  a    25\n   b    26\n   c    27\n   d    28\n   e    29\ndtype: int64\n\"\"\"\n\n# \u884c\u3092\u5217\u3078\nprint df.unstack()\n\"\"\"\na  A     0\n   S     5\n   D    10\n   F    15\n   G    20\n   H    25\nb  A     1\n   S     6\n   D    11\n   F    16\n   G    21\n   H    26\nc  A     2\n   S     7\n   D    12\n   F    17\n   G    22\n   H    27\nd  A     3\n   S     8\n   D    13\n   F    18\n   G    23\n   H    28\ne  A     4\n   S     9\n   D    14\n   F    19\n   G    24\n   H    29\ndtype: int64\n\"\"\"\n```\n\n##\u540d\u524d\u4ed8\u3051\n\n###\u884c\u307e\u305f\u306f\u5217\u306e\u540d\u524d\u4ed8\u3051\n\u884c\u306e\u5834\u5408\u306findex\u3001\u5217\u306e\u5834\u5408\u306fcolumns\u5c5e\u6027\u3092\u4e0a\u66f8\u304d\u3059\u308b\u3068\u540d\u524d\u3092\u5909\u3048\u308b\u3053\u3068\u304c\u3067\u304d\u308b\n\u3082\u3057\u304f\u306frename\u30e1\u30bd\u30c3\u30c9\u3092\u4f7f\u3063\u3066\u5909\u66f4\u524d\u306e\u540d\u524d\u3068\u5909\u66f4\u5f8c\u306e\u540d\u524d\u3092\u8f9e\u66f8\u5f62\u5f0f\u3067\u6e21\u3059\nrename\u30e1\u30bd\u30c3\u30c9\u3092\u4f7f\u3046\u3068\u30c7\u30fc\u30bf\u306e\u30b3\u30d4\u30fc\u304c\u8fd4\u3055\u308c\u3001\u5143\u306e\u30c7\u30fc\u30bf\u306f\u5909\u66f4\u3055\u308c\u306a\u3044\n\n```py\nprint df\n\"\"\"\n    a   b   c   d   e\nA   0   1   2   3   4\nS   5   6   7   8   9\nD  10  11  12  13  14\nF  15  16  17  18  19\nG  20  21  22  23  24\nH  25  26  27  28  29\n\"\"\"\n\n# \u884c\u540d\u3092\u5909\u66f4\ndf.index = [\"AAA\", \"SSS\", \"DDD\", \"FFF\", \"GGG\", \"HHH\"]\n# \u5217\u540d\u3092\u5909\u66f4\ndf.columns=[\"one\", \"two\", \"three\", \"four\", \"five\"]\n\nprint df\n\"\"\"\n     one  two  three  four  five\nAAA    0    1      2     3     4\nSSS    5    6      7     8     9\nDDD   10   11     12    13    14\nFFF   15   16     17    18    19\nGGG   20   21     22    23    24\nHHH   25   26     27    28    29\n\"\"\"\n\n# rename\u3092\u4f7f\u3046\nprint df.rename(index={\"AAA\":\"a\", \"SSS\":\"s\", \"DDD\":\"d\", \"FFF\":\"f\", \"GGG\":\"g\", \"HHH\":\"h\"},\ncolumns={\"one\":1, \"two\":2, \"three\":3, \"four\":4, \"five\":5})\n\"\"\"\n    1   2   3   4   5\na   0   1   2   3   4\ns   5   6   7   8   9\nd  10  11  12  13  14\nf  15  16  17  18  19\ng  20  21  22  23  24\nh  25  26  27  28  29\n\"\"\"\n```\n\n###\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u30e9\u30d9\u30eb\u81ea\u4f53\u306e\u540d\u524d\u4ed8\u3051\n\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u30e9\u30d9\u30eb\u81ea\u4f53\u306b\u540d\u524d\u3092\u4ed8\u3051\u308b\u4e8b\u304c\u304c\u3067\u304d\u308b\n\u4ed8\u3051\u305f\u540d\u524d\u306fswaplevel\u3084unstack\u306a\u3069\u306e\u8ef8\u306e\u5909\u63db\u3092\u3059\u308b\u3068\u304d\u306b\u4f7f\u3046\u3053\u3068\u304c\u3067\u304d\u308b\n\n```py\n# \u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u306e\u540d\u524d\u3092\u5909\u66f4\ndf.index.names = [\"UPPER\"]\n# \u30ab\u30e9\u30e0\u306e\u540d\u524d\u3092\u5909\u66f4\ndf.columns.names = [\"lower\"]\n\nprint df\n\"\"\"\nlower  one  two  three  four  five\nUPPER                             \nAAA      0    1      2     3     4\nSSS      5    6      7     8     9\nDDD     10   11     12    13    14\nFFF     15   16     17    18    19\nGGG     20   21     22    23    24\nHHH     25   26     27    28    29\n\"\"\"\n```\n\n##\u30d3\u30f3\u30cb\u30f3\u30b0\n(\u30d3\u30f3\u3068\u306f\u30d2\u30b9\u30c8\u30b0\u30e9\u30e0\u306e\u67f1\u306e\u3053\u3068)\npd.cut\u30e1\u30bd\u30c3\u30c9\u3092\u4f7f\u3046\u3068\u30c7\u30fc\u30bf\u306e\u5024\u3092\u30d3\u30f3\u306b\u5206\u5272\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u308b\n\n```py\n# \u5e74\u9f62\u3068\u6027\u5225\u306e\u30c7\u30fc\u30bf\ndf = DataFrame([[20,\"F\"],[22,\"M\"],[25,\"M\"],[27,\"M\"],[21,\"F\"],[23,\"M\"],[37,\"F\"],[31,\"M\"],[61,\"F\"],[45,\"M\"],[41,\"F\"],[32,\"M\"]], columns=[\"age\", \"sex\"])\nprint df\n\"\"\"\n   age sex\n0   20   F\n1   22   M\n2   25   M\n3   27   M\n4   21   F\n5   23   M\n6   37   F\n7   31   M\n8   61   F\n9   45   M\n10  41   F\n11  32   M\n\"\"\"\n\n# \u30d3\u30f3\u306b\u5206\u5272\u3059\u308b\u3068\u304d\u306e\u5024\nbins = [18, 25, 35, 60, 100]\n# \u30d3\u30f3\u306e\u540d\u524d\ngroup_names = [\"Youth\", \"YoungAdult\", \"MiddleAged\", \"Senior\"]\n# \u30d3\u30f3\u5316\nprint pd.cut(df.age, bins, labels=group_names)\n\"\"\"\nCategorical: \n[Youth, Youth, Youth, YoungAdult, Youth, Youth, nan, YoungAdult, nan, nan, nan, YoungAdult]\nLevels (4): Index(['Youth', 'YoungAdult', 'MiddleAged', 'Senior'], dtype=object)\n\"\"\"\n\n# df\u306b\u30d3\u30f3\u306e\u5217\u3092\u8ffd\u52a0\ndf[\"bin\"] = pd.cut(df.age, bins, labels=group_names)\nprint df\n\"\"\"\n    age sex         bin\n0    20   F       Youth\n1    22   M       Youth\n2    25   M       Youth\n3    27   M  YoungAdult\n4    21   F       Youth\n5    23   M       Youth\n6    37   F  MiddleAged\n7    31   M  YoungAdult\n8    61   F      Senior\n9    45   M  MiddleAged\n10   41   F  MiddleAged\n11   32   M  YoungAdult\n\"\"\"\n```\n\n##\u5217\u3068\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u306e\u5909\u63db\n\u7279\u5b9a\u306e\u5217\u306e\u307f\u3092\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u306b\u5909\u63db\u3057\u305f\u3044\u5834\u5408\u306fDataFrame\u306eset_index\u30e1\u30bd\u30c3\u30c9\u3092\u4f7f\u3046\n\n```py\nprint df\n\"\"\"\n    age sex         bin\n0    20   F       Youth\n1    22   M       Youth\n2    25   M       Youth\n3    27   M  YoungAdult\n4    21   F       Youth\n5    23   M       Youth\n6    37   F  MiddleAged\n7    31   M  YoungAdult\n8    61   F      Senior\n9    45   M  MiddleAged\n10   41   F  MiddleAged\n11   32   M  YoungAdult\n\"\"\"\n\n# bin\u5217\u3092\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u306b\u5909\u63db\nprint df.set_index(\"bin\")\n\"\"\"\n            age sex\nbin                \nYouth        20   F\nYouth        22   M\nYouth        25   M\nYoungAdult   27   M\nYouth        21   F\nYouth        23   M\nMiddleAged   37   F\nYoungAdult   31   M\nSenior       61   F\nMiddleAged   45   M\nMiddleAged   41   F\nYoungAdult   32   M\n\"\"\"\n\n# \u8907\u6570\u306e\u5217\u3092\u968e\u5c64\u7684\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u306b\u5909\u63db\u3059\u308b\u306b\u306f\u30ea\u30b9\u30c8\u3092\u5f15\u6570\u306b\u4e0e\u3048\u308b\nprint df.set_index([\"bin\", \"sex\"])\n\"\"\"\n                age\nbin        sex     \nYouth      F     20\n           M     22\n           M     25\nYoungAdult M     27\nYouth      F     21\n           M     23\nMiddleAged F     37\nYoungAdult M     31\nSenior     F     61\nMiddleAged M     45\n           F     41\nYoungAdult M     32\n\"\"\"\n\n# \u30bd\u30fc\u30c8\nprint df.set_index([\"bin\", \"sex\"]).sortlevel(\"bin\")\n\"\"\"\n                age\nbin        sex     \nMiddleAged F     37\n           F     41\n           M     45\nSenior     F     61\nYoungAdult M     27\n           M     31\n           M     32\nYouth      F     20\n           F     21\n           M     22\n           M     25\n           M     23\n\"\"\"\n```\n\n##\u30e9\u30f3\u30c0\u30e0\u30b5\u30f3\u30d7\u30ea\u30f3\u30b0\nDataFrame\u306etake\u3092\u4f7f\u3046\u3068\u5fc5\u8981\u306a\u884c\u3060\u3051\u53d6\u308a\u51fa\u3059\u3053\u3068\u304c\u3067\u304d\u308b\n\u3053\u308c\u3092\u5229\u7528\u3057\u3066\u30e9\u30f3\u30c0\u30e0\u306b\u5217\u3092\u53d6\u308a\u51fa\u305b\u3070\u30e9\u30f3\u30c0\u30e0\u30b5\u30f3\u30d7\u30ea\u30f3\u30b0\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u308b\n\n```py\n# \u30b5\u30f3\u30d7\u30ea\u30f3\u30b0\u3059\u308b\u884c\u3092\u6307\u5b9a\nprint df.take([1, 3, 5])\n\"\"\"\n   age sex         bin\n1   22   M       Youth\n3   27   M  YoungAdult\n5   23   M       Youth\n\"\"\"\n\n# \u30e9\u30f3\u30c0\u30e0\u306b5\u3064\u30b5\u30f3\u30d7\u30ea\u30f3\u30b0\nsampler = np.random.permutation(len(df))\nprint df.take(sampler[:5])\n\"\"\"\n   age sex         bin\n8   61   F      Senior\n2   25   M       Youth\n7   31   M  YoungAdult\n1   22   M       Youth\n0   20   F       Youth\n\"\"\"\n```\n\n##\u30ab\u30c6\u30b4\u30ea\u30ab\u30eb\u30c7\u30fc\u30bf\u3092\u30c0\u30df\u30fc\u5909\u6570\u5316\npandas\u306eget_dummies\u30e1\u30bd\u30c3\u30c9\u3092\u4f7f\u3046\u3068\u30ab\u30c6\u30b4\u30ea\u30ab\u30eb\u30c7\u30fc\u30bf (\u8cea\u7684\u30c7\u30fc\u30bf) \u3092\u30c0\u30df\u30fc\u5909\u6570\u306b\u5909\u63db\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u308b\n\u6570\u91cf\u5316I\u985e\u3068\u304b\u3059\u308b\u3068\u304d\u306b\u4f7f\u3046\u30a2\u30ec\n\n```py\n# \u6027\u5225column\u3092\u30c0\u30df\u30fc\u5909\u6570\u5316\ndum = pd.get_dummies(df[\"sex\"])\nprint dum\n\"\"\"\n    F  M\n0   1  0\n1   0  1\n2   0  1\n3   0  1\n4   1  0\n5   0  1\n6   1  0\n7   0  1\n8   1  0\n9   0  1\n10  1  0\n11  0  1\n\"\"\"\n\n# df\u306b\u8ffd\u52a0\ndf = pd.concat((df, dum), axis=1)\ndf = df.drop(\"sex\", axis=1)\nprint df\n\"\"\"\n    age         bin  F  M\n0    20       Youth  1  0\n1    22       Youth  0  1\n2    25       Youth  0  1\n3    27  YoungAdult  0  1\n4    21       Youth  1  0\n5    23       Youth  0  1\n6    37  MiddleAged  1  0\n7    31  YoungAdult  0  1\n8    61      Senior  1  0\n9    45  MiddleAged  0  1\n10   41  MiddleAged  1  0\n11   32  YoungAdult  0  1\n\"\"\"\n```\n\n## \u30b0\u30eb\u30fc\u30d4\u30f3\u30b0\ngroupby\u3092\u4f7f\u3046\u3053\u3068\u3067\u5024\u306b\u3088\u308b\u30b0\u30eb\u30fc\u30d4\u30f3\u30b0\u304c\u884c\u3048\u308b\n\u305d\u308c\u305e\u308c\u306e\u30b0\u30eb\u30fc\u30d7\u306b\u540c\u3058\u51e6\u7406\u3092\u9069\u7528\u3059\u308b\u306b\u306fgroupby\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306eapply\u30e1\u30bd\u30c3\u30c9\u3092\u4f7f\u3046\n\n```py\nprint df.groupby(\"bin\")\n\"\"\"\n<pandas.core.groupby.DataFrameGroupBy object at 0x106af9a90>\n\"\"\"\n\n# \u30b0\u30eb\u30fc\u30d7\u3054\u3068\u306bmean\u3092\u8a08\u7b97\nf = lambda x: x.mean()\nprint df.groupby(\"bin\").apply(f)\n\"\"\"\n             age         F         M\nbin                                 \nMiddleAged  41.0  0.666667  0.333333\nSenior      61.0  1.000000  0.000000\nYoungAdult  30.0  0.000000  1.000000\nYouth       22.2  0.400000  0.600000\n\"\"\"\n```\n\n\u4f8b: \u30d3\u30f3\u5206\u6790\n\u30d3\u30f3\u306e\u5024\u30b0\u30eb\u30fc\u30d4\u30f3\u30b0\u3057\u3001\u305d\u308c\u305e\u308c\u306e\u30d3\u30f3\u3054\u3068\u306b\u7d71\u8a08\u91cf\u3092\u51fa\u3059\n\n```py\nframe = DataFrame({\"data1\": np.random.randn(1000), \"data2\":np.random.randn(1000)})\nfactor = pd.cut(frame.data1, 4)  # data1\u306e\u5024\u306e\u7bc4\u56f2\u3092\u5747\u7b49\u306b4\u3064\u306e\u30d3\u30f3\u306b\u5206\u5272\n\n# apply\u3059\u308b\u305f\u3081\u306e\u95a2\u6570\u3092\u5b9a\u7fa9\ndef get_stats(group):\n    return {\"min\": group.min(), \"max\": group.max(), \"count\": group.count(), \"mean\": group.mean()}\n\n# data2\u306e\u5024\u306e\u7d71\u8a08\u91cf\u3092data1\u306e\u30d3\u30f3\u3054\u3068\u306b\u51fa\u3059\ngrouped = frame.data2.groupby(factor)\nprint grouped.apply(get_stats).unstack()\n\"\"\"\n                  count       max      mean       min\ndata1                                                \n(-3.205, -1.673]     44  2.544910 -0.108558 -1.984124\n(-1.673, -0.147]    414  3.420818  0.003078 -3.168528\n(-0.147, 1.379]     447  2.563359 -0.018062 -3.175148\n(1.379, 2.905]       95  2.498611  0.140166 -2.439985\n\"\"\"\n```\n\nagg\u30e1\u30bd\u30c3\u30c9\u3092\u4f7f\u3046\u3068GroupBy\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306e\u30ab\u30e9\u30e0\u3054\u3068\u306b\u540c\u3058\u95a2\u6570\u3092\u9069\u7528\u3067\u304d\u308b\n\n```py\ndf[\"random\"] = [random.choice((0,1)) for i in range(len(df))]\nprint df\n\"\"\"\n    age sex  random\n0    20   F       1\n1    22   M       1\n2    25   M       1\n3    27   M       0\n4    21   F       1\n5    23   M       1\n6    37   F       1\n7    31   M       0\n8    61   F       1\n9    45   M       1\n10   41   F       0\n11   32   M       0\n\"\"\"\n\nprint df.groupby(\"sex\").agg([np.max, np.min, np.mean])\n\"\"\"\n      age                   random                \n     amax  amin       mean    amax  amin      mean\nsex                                               \nF      61    20  36.000000       1     0  0.800000\nM      45    22  29.285714       1     0  0.571429\n\"\"\"\n```", "tags": ["pandas", "Python"]}