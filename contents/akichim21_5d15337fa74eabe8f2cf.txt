{"context": "\n\npoltergeist\u306e\u8a2d\u5b9a\nCapybara.configure do |config|\n  config.run_server = false\n  config.current_driver = :poltergeist\n  config.javascript_driver = :poltergeist\n  config.default_max_wait_time = 10\nend\n\nCapybara.register_driver :poltergeist do |app|\n  Capybara::Poltergeist::Driver.new(app, {\n    timeout: 10,\n    js_errors: false,\n    phantomjs_options: ['--load-images=no', '--ignore-ssl-errors=yes', '--ssl-protocol=any'],\n  })\nend\n\n\nCapybara::Session\u306e\u30e9\u30c3\u30d1\u30fc\u30af\u30e9\u30b9\u3092\u4f5c\u308b\nclass BaseBrowser\n  attr_reader :session\n  def initialize(url, options = {})\n    @session = Capybara::Session.new(:poltergeist)\n\n    @session.visit(url)\n  end\nend\n\n\n\u30c7\u30d5\u30a9\u30eb\u30c8\u8a00\u8a9e\u8a2d\u5b9a\u3092\u65e5\u672c\u8a9e\u306b\u3059\u308b\nsession.driver.headers = {\n  'Accept-Language' => 'ja'\n}\n\nja \u3068 ja-JP\u3060\u3068ja\u306e\u304c\u826f\u3055\u305d\u3046\nhttp://memorva.jp/internet/pc/browser_language.php\n\niphone\u3084Mac\u3067\u30a2\u30af\u30bb\u30b9\u3059\u308b\nMac\nsession.driver.headers = {\n  \"User-Agent\" => \"Mac Safari\"\n}\n\niphone\nsession.driver.headers = {\n  \"User-Agent\" => 'Mozilla/5.0 (iPhone; U; CPU iPhone OS 5_0 like Mac OS X) AppleWebKit/534.46 (KHTML, like Gecko) Mobile/9A334 Safari/7534.48.3'\n}\n\n\n\u975e\u8868\u793a\u306e\u30c6\u30ad\u30b9\u30c8\u3092\u53d6\u5f97\u3059\u308b\nsession.find('css_class', visible: false).text(:all)\nsession.all('css_class', visible: false).map { |tag| tag.text(:all) }\n\nvisible: false\ntext\u306ball\u3092\u6e21\u3059\n\najax\u306e\u5f85\u6a5f\u30e1\u30bd\u30c3\u30c9(Capybara.default_max_wait_time = 10\u3067\u3042\u308c\u3070\u5185\u90e8\u306710\u79d2\u5f85\u3063\u3066\u304f\u308c\u308b)\ndef wait_for_ajax(loading_element)\n  session.has_css?(loading_element)\nend\n\n\n\npoltergeist\u3092kill\ndef finish\n  session.driver.quit\n  @session = nil\nend\n\n\u3053\u308c\u3092\u3057\u306a\u3044\u3068\u30d0\u30c3\u30c1\u306e\u30eb\u30fc\u30d7\u306a\u3069\u3067session\u3092\u7acb\u3061\u4e0a\u3052\u7d9a\u3051\u3066\u308b\u3068poltergeist\u304c\u6b7b\u306a\u305a\u306b\u30e1\u30e2\u30ea\u304c\u81a8\u308c\u308b\u3002\u306a\u306e\u3067\u5b9f\u884c\u7d42\u4e86\u6642\u3084\u4f8b\u5916\u6642\u3067\u629c\u3051\u308b\u6642\u306a\u3069\u306b\u5fc5\u305afinish\u3092\u547c\u3073\u51fa\u3059\u3002\n## poltergeist\u306e\u8a2d\u5b9a\n```\nCapybara.configure do |config|\n  config.run_server = false\n  config.current_driver = :poltergeist\n  config.javascript_driver = :poltergeist\n  config.default_max_wait_time = 10\nend\n\nCapybara.register_driver :poltergeist do |app|\n  Capybara::Poltergeist::Driver.new(app, {\n    timeout: 10,\n    js_errors: false,\n    phantomjs_options: ['--load-images=no', '--ignore-ssl-errors=yes', '--ssl-protocol=any'],\n  })\nend\n```\n\n## Capybara::Session\u306e\u30e9\u30c3\u30d1\u30fc\u30af\u30e9\u30b9\u3092\u4f5c\u308b\n```\nclass BaseBrowser\n  attr_reader :session\n  def initialize(url, options = {})\n    @session = Capybara::Session.new(:poltergeist)\n\n    @session.visit(url)\n  end\nend\n```\n\n## \u30c7\u30d5\u30a9\u30eb\u30c8\u8a00\u8a9e\u8a2d\u5b9a\u3092\u65e5\u672c\u8a9e\u306b\u3059\u308b\n```\nsession.driver.headers = {\n  'Accept-Language' => 'ja'\n}\n```\n\nja \u3068 ja-JP\u3060\u3068ja\u306e\u304c\u826f\u3055\u305d\u3046\nhttp://memorva.jp/internet/pc/browser_language.php\n\n## iphone\u3084Mac\u3067\u30a2\u30af\u30bb\u30b9\u3059\u308b\nMac\n\n```\nsession.driver.headers = {\n  \"User-Agent\" => \"Mac Safari\"\n}\n```\n\niphone\n\n```\nsession.driver.headers = {\n  \"User-Agent\" => 'Mozilla/5.0 (iPhone; U; CPU iPhone OS 5_0 like Mac OS X) AppleWebKit/534.46 (KHTML, like Gecko) Mobile/9A334 Safari/7534.48.3'\n}\n```\n\n## \u975e\u8868\u793a\u306e\u30c6\u30ad\u30b9\u30c8\u3092\u53d6\u5f97\u3059\u308b\n```\nsession.find('css_class', visible: false).text(:all)\nsession.all('css_class', visible: false).map { |tag| tag.text(:all) }\n```\nvisible: false\ntext\u306ball\u3092\u6e21\u3059\n\n\n## ajax\u306e\u5f85\u6a5f\u30e1\u30bd\u30c3\u30c9(Capybara.default_max_wait_time = 10\u3067\u3042\u308c\u3070\u5185\u90e8\u306710\u79d2\u5f85\u3063\u3066\u304f\u308c\u308b)\n```\ndef wait_for_ajax(loading_element)\n  session.has_css?(loading_element)\nend\n\n```\n\n## poltergeist\u3092kill\n```\ndef finish\n  session.driver.quit\n  @session = nil\nend\n```\n\u3053\u308c\u3092\u3057\u306a\u3044\u3068\u30d0\u30c3\u30c1\u306e\u30eb\u30fc\u30d7\u306a\u3069\u3067session\u3092\u7acb\u3061\u4e0a\u3052\u7d9a\u3051\u3066\u308b\u3068poltergeist\u304c\u6b7b\u306a\u305a\u306b\u30e1\u30e2\u30ea\u304c\u81a8\u308c\u308b\u3002\u306a\u306e\u3067\u5b9f\u884c\u7d42\u4e86\u6642\u3084\u4f8b\u5916\u6642\u3067\u629c\u3051\u308b\u6642\u306a\u3069\u306b\u5fc5\u305afinish\u3092\u547c\u3073\u51fa\u3059\u3002\n\n## \n", "tags": ["Capybara", "\u30af\u30ed\u30fc\u30e9\u30fc", "Ruby"]}