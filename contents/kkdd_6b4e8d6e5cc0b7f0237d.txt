{"context": "\u3053\u3093\u306b\u3061\u306f\u3002\n\u6700\u5c0f\u4e8c\u4e57\u6cd5\u306f J(x)\u225c(y\u2212Ax)T(y\u2212Ax)J (\\boldsymbol{x}) \\triangleq \\left(\\boldsymbol{y} - A \\boldsymbol{x} \\right)^\\textrm{T} \\left(\\boldsymbol{y} - A \\boldsymbol{x} \\right) \u3092\u6700\u5c0f\u3068\u3059\u308b xmin\\boldsymbol{x}_{\\min} \u3092\u8a08\u7b97\u3057\u307e\u3059\u3002\u4e09\u89d2\u884c\u5217\u3092\u7d4c\u308b\u306e\u304c\u8a08\u7b97\u52b9\u7387\u304c\u826f\u304f\u3001\u5e38\u9053\u3067\u3059\u3002\u8a08\u7b97\u3092\u8981\u7d04\u3057\u307e\u3059\u3068\u3001\n\n\u884c\u5217 \u02dcA\u225c[Ay]\\tilde{A} \\triangleq \\begin{bmatrix} A & \\boldsymbol{y} \\end{bmatrix} \u3092\u7528\u610f\u3057\u3001\u305d\u308c\u304b\u3089\uff08\u6b63\u65b9\uff09\u4e0a\u4e09\u89d2\u884c\u5217 \u02dcR\u225c[R\u02dcy0T\u03b1]\\tilde{R} \\triangleq \\begin{bmatrix} R  & \\tilde{\\boldsymbol{y}} \\\\ \\boldsymbol{0}^\\textrm{T} & \\alpha \\end{bmatrix} \u3092\u6c42\u3081\u3001\n\u3053\u308c\u3092\u4f7f\u3044\u3001Rx=\u02dcyR\\,\\boldsymbol{x} = \\tilde{\\boldsymbol{y}} \u3092\u89e3\u3044\u3066\u3001xmin\\boldsymbol{x}_{\\min} \u3092\u6c42\u3081\u308b\u3002\n\n\u3053\u308c\u306ePython\u5b9f\u88c5\u4f8b\u306f\uff08Ay = \u02dcA\\tilde{A}\u3001Ry = \u02dcR\\tilde{R}\uff09\u3001\ndef lsqsolv(Ay):\n    n = Ay.shape[1] - 1\n    Ry = triangulateupper(Ay)\n    return numpy.linalg.solve(Ry[0:n,0:n], Ry[0:n,n]) # x_min\n\ndef triangulateupper(A):\n    return numpy.linalg.cholesky(numpy.dot(A.transpose(),A)).transpose()\n\n\n\u4e0a\u8a18\u4f8b\u306e\u4e09\u89d2\u884c\u5217\u5316\u306f\u8a08\u7b97\u52b9\u7387\u91cd\u8996\u306e Cholesky \u5206\u89e3\u3092\u5229\u7528\u3057\u3066\u3044\u307e\u3059\u304c\u3001\u591a\u304f\u306e\u5834\u5408\u3067\u306f\u6570\u5024\u5b89\u5b9a\u6027\u91cd\u8996\u306e QR \u5206\u89e3\u3092\u304a\u52e7\u3081\u307e\u3059\u3002\n\n\n\u95a2\u4fc2\u5f0f\u3092\u307e\u3068\u3081\u307e\u3059\u3068\uff08\u02dcQ\\tilde{Q}, QQ \u306f\u76f4\u4ea4\u884c\u5217\uff09\u3001\n\\begin{align*}\nJ (\\boldsymbol{x}) &\\triangleq \\left(\\boldsymbol{y} - A \\boldsymbol{x} \\right)^\\textrm{T} \\left(\\boldsymbol{y} - A \\boldsymbol{x} \\right) \\\\\n&= \\begin{bmatrix} \\boldsymbol{x}\\\\ -1\\end{bmatrix}^\\textrm{T} \\tilde{A}^\\textrm{T} \\, \\tilde{A} \\,\\begin{bmatrix}  \\boldsymbol{x}\\\\ -1\\end{bmatrix} \\\\\n&= \\begin{bmatrix} \\boldsymbol{x}\\\\ -1\\end{bmatrix}^\\textrm{T} \\tilde{R}^\\textrm{T} \\, \\tilde{R} \\,\\begin{bmatrix}  \\boldsymbol{x}\\\\ -1\\end{bmatrix} \\\\\nA &= Q R \\\\\n\\tilde{A} &= \\tilde{Q} \\tilde{R} \\\\\n\\tilde{R}^\\textrm{T} \\, \\tilde{R} &= \\tilde{A}^\\textrm{T} \\tilde{A} \\\\\n\\tilde{A} &\\triangleq \\begin{bmatrix} A & \\boldsymbol{y} \\end{bmatrix} \\\\\n\\tilde{R} &\\triangleq \\begin{bmatrix} R  & \\tilde{\\boldsymbol{y}} \\\\ \\boldsymbol{0}^\\textrm{T} & \\alpha \\end{bmatrix} \\\\\n\\tilde{\\boldsymbol{y}} &\\triangleq Q^\\textrm{T} \\boldsymbol{y} \\\\\n\\alpha &\\triangleq \\left( \\min_{\\boldsymbol{x}} J (\\boldsymbol{x}) \\right)^{1/2} \\\\\n \\\\\n\\end{align*}\nJ(x)\u225c(y\u2212Ax)T(y\u2212Ax)=[x\u22121]T\u02dcAT\u02dcA[x\u22121]=[x\u22121]T\u02dcRT\u02dcR[x\u22121]A=QR\u02dcA=\u02dcQ\u02dcR\u02dcRT\u02dcR=\u02dcAT\u02dcA\u02dcA\u225c[Ay]\u02dcR\u225c[R\u02dcy0T\u03b1]\u02dcy\u225cQTy\u03b1\u225c(minxJ(x))1/2{\\begin{align*}\nJ (\\boldsymbol{x}) &\\triangleq \\left(\\boldsymbol{y} - A \\boldsymbol{x} \\right)^\\textrm{T} \\left(\\boldsymbol{y} - A \\boldsymbol{x} \\right) \\\\\n&= \\begin{bmatrix} \\boldsymbol{x}\\\\ -1\\end{bmatrix}^\\textrm{T} \\tilde{A}^\\textrm{T} \\, \\tilde{A} \\,\\begin{bmatrix}  \\boldsymbol{x}\\\\ -1\\end{bmatrix} \\\\\n&= \\begin{bmatrix} \\boldsymbol{x}\\\\ -1\\end{bmatrix}^\\textrm{T} \\tilde{R}^\\textrm{T} \\, \\tilde{R} \\,\\begin{bmatrix}  \\boldsymbol{x}\\\\ -1\\end{bmatrix} \\\\\nA &= Q R \\\\\n\\tilde{A} &= \\tilde{Q} \\tilde{R} \\\\\n\\tilde{R}^\\textrm{T} \\, \\tilde{R} &= \\tilde{A}^\\textrm{T} \\tilde{A} \\\\\n\\tilde{A} &\\triangleq \\begin{bmatrix} A & \\boldsymbol{y} \\end{bmatrix} \\\\\n\\tilde{R} &\\triangleq \\begin{bmatrix} R  & \\tilde{\\boldsymbol{y}} \\\\ \\boldsymbol{0}^\\textrm{T} & \\alpha \\end{bmatrix} \\\\\n\\tilde{\\boldsymbol{y}} &\\triangleq Q^\\textrm{T} \\boldsymbol{y} \\\\\n\\alpha &\\triangleq \\left( \\min_{\\boldsymbol{x}} J (\\boldsymbol{x}) \\right)^{1/2} \\\\\n \\\\\n\\end{align*}\n}\n\u3053\u3093\u306b\u3061\u306f\u3002\n\u6700\u5c0f\u4e8c\u4e57\u6cd5\u306f $J (\\boldsymbol{x}) \\triangleq \\left(\\boldsymbol{y} - A \\boldsymbol{x} \\right)^\\textrm{T} \\left(\\boldsymbol{y} - A \\boldsymbol{x} \\right)$ \u3092\u6700\u5c0f\u3068\u3059\u308b $\\boldsymbol{x}_{\\min}$ \u3092\u8a08\u7b97\u3057\u307e\u3059\u3002\u4e09\u89d2\u884c\u5217\u3092\u7d4c\u308b\u306e\u304c\u8a08\u7b97\u52b9\u7387\u304c\u826f\u304f\u3001\u5e38\u9053\u3067\u3059\u3002\u8a08\u7b97\u3092\u8981\u7d04\u3057\u307e\u3059\u3068\u3001\n\n1. \u884c\u5217 $\\tilde{A} \\triangleq \\begin{bmatrix} A & \\boldsymbol{y} \\end{bmatrix}$ \u3092\u7528\u610f\u3057\u3001\u305d\u308c\u304b\u3089\uff08\u6b63\u65b9\uff09\u4e0a\u4e09\u89d2\u884c\u5217 $\\tilde{R} \\triangleq \\begin{bmatrix} R  & \\tilde{\\boldsymbol{y}} \\\\\\ \\boldsymbol{0}^\\textrm{T} & \\alpha \\end{bmatrix}$ \u3092\u6c42\u3081\u3001\n2. \u3053\u308c\u3092\u4f7f\u3044\u3001$R\\,\\boldsymbol{x} = \\tilde{\\boldsymbol{y}}$ \u3092\u89e3\u3044\u3066\u3001$\\boldsymbol{x}_{\\min}$ \u3092\u6c42\u3081\u308b\u3002\n\n\u3053\u308c\u306ePython\u5b9f\u88c5\u4f8b\u306f\uff08```Ay``` = $\\tilde{A}$\u3001```Ry``` = $\\tilde{R}$\uff09\u3001\n\n```python\ndef lsqsolv(Ay):\n    n = Ay.shape[1] - 1\n    Ry = triangulateupper(Ay)\n    return numpy.linalg.solve(Ry[0:n,0:n], Ry[0:n,n]) # x_min\n\ndef triangulateupper(A):\n    return numpy.linalg.cholesky(numpy.dot(A.transpose(),A)).transpose()\n```\n* \u4e0a\u8a18\u4f8b\u306e\u4e09\u89d2\u884c\u5217\u5316\u306f\u8a08\u7b97\u52b9\u7387\u91cd\u8996\u306e Cholesky \u5206\u89e3\u3092\u5229\u7528\u3057\u3066\u3044\u307e\u3059\u304c\u3001\u591a\u304f\u306e\u5834\u5408\u3067\u306f\u6570\u5024\u5b89\u5b9a\u6027\u91cd\u8996\u306e QR \u5206\u89e3\u3092\u304a\u52e7\u3081\u307e\u3059\u3002\n\n-------------\n\u95a2\u4fc2\u5f0f\u3092\u307e\u3068\u3081\u307e\u3059\u3068\uff08$\\tilde{Q}$, $Q$ \u306f\u76f4\u4ea4\u884c\u5217\uff09\u3001\n\n```math\n\\begin{align*}\nJ (\\boldsymbol{x}) &\\triangleq \\left(\\boldsymbol{y} - A \\boldsymbol{x} \\right)^\\textrm{T} \\left(\\boldsymbol{y} - A \\boldsymbol{x} \\right) \\\\\n&= \\begin{bmatrix} \\boldsymbol{x}\\\\ -1\\end{bmatrix}^\\textrm{T} \\tilde{A}^\\textrm{T} \\, \\tilde{A} \\,\\begin{bmatrix}  \\boldsymbol{x}\\\\ -1\\end{bmatrix} \\\\\n&= \\begin{bmatrix} \\boldsymbol{x}\\\\ -1\\end{bmatrix}^\\textrm{T} \\tilde{R}^\\textrm{T} \\, \\tilde{R} \\,\\begin{bmatrix}  \\boldsymbol{x}\\\\ -1\\end{bmatrix} \\\\\nA &= Q R \\\\\n\\tilde{A} &= \\tilde{Q} \\tilde{R} \\\\\n\\tilde{R}^\\textrm{T} \\, \\tilde{R} &= \\tilde{A}^\\textrm{T} \\tilde{A} \\\\\n\\tilde{A} &\\triangleq \\begin{bmatrix} A & \\boldsymbol{y} \\end{bmatrix} \\\\\n\\tilde{R} &\\triangleq \\begin{bmatrix} R  & \\tilde{\\boldsymbol{y}} \\\\ \\boldsymbol{0}^\\textrm{T} & \\alpha \\end{bmatrix} \\\\\n\\tilde{\\boldsymbol{y}} &\\triangleq Q^\\textrm{T} \\boldsymbol{y} \\\\\n\\alpha &\\triangleq \\left( \\min_{\\boldsymbol{x}} J (\\boldsymbol{x}) \\right)^{1/2} \\\\\n \\\\\n\\end{align*}\n```\n", "tags": ["\u6700\u5c0f\u4e8c\u4e57\u6cd5", "Python", "numpy", "\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0", "\u7dda\u5f62\u4ee3\u6570"]}