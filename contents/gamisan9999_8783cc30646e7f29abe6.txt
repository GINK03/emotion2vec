{"context": "\u4ffa\u3067\u3059\u3002\nEC2\u306ePrivate IP\u306b\u81ea\u5206\u3067\u8003\u3048\u305f\u540d\u524d\u3092\u3064\u3051\u308b\u4e59\u306a\u3053\u3068\u3092\u3057\u3066\u307f\u305f\u3044\u6642\u306e\u30e1\u30e2\u3067\u3059\u3002\ncount\u3068element\u3092\u4f7f\u3046\u3053\u3068\u3067terraform\u3067Launch\u3059\u308bEC2\u306e\u53f0\u6570\u304c\u5909\u52d5\u3057\u3066\u3082\u3044\u3044\u611f\u3058\u306bDNS\u767b\u9332\u3055\u308c\u307e\u3059\n\u4ee5\u4e0b\u4f8b\n\u524d\u63d0: VPC DNS hostname\u306f\u6709\u52b9\u306b\u3059\u308b\u3053\u3068\n\nEC2\n\nvariables\n\nvariable \"unko\" {\n  default = {\n    name = \"unko\"\n    ami = \"ami-XXXXXXXX\"\n    instance_type = \"c4.2xlarge\"\n    iam_instance_profile = \"unko\"\n    source_dest_check = true\n    ebs_optimized = true\n    root_block_device = \"gp2\"\n    root_block_device_size = 100\n    count = 2\n  }\n}\n\n\nec2.tf\n\nresource \"aws_instance\" \"unko\" {\n..\u7701\u7565..\n  count = \"${lookup(var.unko, \"count\")}\"\n}\n\n\nRoute53\nresource \"aws_route53_zone\" \"unko\" {\n  name = \"unko\"\n  vpc_id = \"${aws_vpc.unko.id}\"\n  vpc_region = \"ap-northeast-1\"\n  tags {\n    Type = \"Internal DNS\"\n  }\n}\n\nresource \"aws_route53_record\" \"unko\" {\n  zone_id = \"${aws_route53_zone.unko.zone_id}\"\n  name = \"unko-${count.index + 1}-${element(aws_instance.unko.*.availability_zone, count.index)}\"\n  type = \"A\"\n  ttl = \"5\"\n  count = \"${lookup(var.unko, \"count\")}\"\n  records = [\n    \"${element(aws_instance.unko.*.private_ip, count.index)}\"\n  ]\n}\n\n$ terraform apply\n\n\u3053\u308c\u3067OK\n\u5b8c\n\u4ffa\u3067\u3059\u3002\n\nEC2\u306ePrivate IP\u306b\u81ea\u5206\u3067\u8003\u3048\u305f\u540d\u524d\u3092\u3064\u3051\u308b\u4e59\u306a\u3053\u3068\u3092\u3057\u3066\u307f\u305f\u3044\u6642\u306e\u30e1\u30e2\u3067\u3059\u3002\ncount\u3068element\u3092\u4f7f\u3046\u3053\u3068\u3067terraform\u3067Launch\u3059\u308bEC2\u306e\u53f0\u6570\u304c\u5909\u52d5\u3057\u3066\u3082\u3044\u3044\u611f\u3058\u306bDNS\u767b\u9332\u3055\u308c\u307e\u3059\n\n\u4ee5\u4e0b\u4f8b\n\n\u524d\u63d0: VPC DNS hostname\u306f\u6709\u52b9\u306b\u3059\u308b\u3053\u3068\n\n# EC2\n\n- variables\n\n```\nvariable \"unko\" {\n  default = {\n    name = \"unko\"\n    ami = \"ami-XXXXXXXX\"\n    instance_type = \"c4.2xlarge\"\n    iam_instance_profile = \"unko\"\n    source_dest_check = true\n    ebs_optimized = true\n    root_block_device = \"gp2\"\n    root_block_device_size = 100\n    count = 2\n  }\n}\n```\n\n- ec2.tf\n\n```\nresource \"aws_instance\" \"unko\" {\n..\u7701\u7565..\n  count = \"${lookup(var.unko, \"count\")}\"\n}\n```\n\n# Route53\n\n```\nresource \"aws_route53_zone\" \"unko\" {\n  name = \"unko\"\n  vpc_id = \"${aws_vpc.unko.id}\"\n  vpc_region = \"ap-northeast-1\"\n  tags {\n    Type = \"Internal DNS\"\n  }\n}\n\nresource \"aws_route53_record\" \"unko\" {\n  zone_id = \"${aws_route53_zone.unko.zone_id}\"\n  name = \"unko-${count.index + 1}-${element(aws_instance.unko.*.availability_zone, count.index)}\"\n  type = \"A\"\n  ttl = \"5\"\n  count = \"${lookup(var.unko, \"count\")}\"\n  records = [\n    \"${element(aws_instance.unko.*.private_ip, count.index)}\"\n  ]\n}\n```\n\n```\n$ terraform apply\n```\n\n\u3053\u308c\u3067OK\n\n`\u5b8c`\n", "tags": ["Terraform", "\u4ffa\u3067\u3082\u308f\u304b\u308b\u30b7\u30ea\u30fc\u30ba"]}