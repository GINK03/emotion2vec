{"context": "\n\n\u74b0\u5883\n\n\u30d0\u30fc\u30b8\u30e7\u30f3\n$ python --version\nPython 2.7.12 :: Continuum Analytics, Inc.\n$ pip freeze | grep pandas\npandas==0.19.1\n\n\n\u30b5\u30f3\u30d7\u30eb\u30d5\u30a1\u30a4\u30eb\n$ file --mime sample.tsv\nsample.tsv: text/plain; charset=utf-8\n$ cat sample.tsv\nID  \u8a00\u8a9e\n1   \u65e5\u672c\u8a9e\n2   \u82f1\u8a9e\n\n\ncodecs\n\u307e\u305a codecs \u3067\u3059\u304c\n>>> open(\"sample.tsv\", \"r\").read()\n'ID\\t\\xe8\\xa8\\x80\\xe8\\xaa\\x9e\\n1\\t\\xe6\\x97\\xa5\\xe6\\x9c\\xac\\xe8\\xaa\\x9e\\n2\\t\\xe8\\x8b\\xb1\\xe8\\xaa\\x9e\\n'\n>>> import codecs\n>>> codecs.open(\"sample.tsv\", \"r\", \"utf-8\").read()\nu'ID\\t\\u8a00\\u8a9e\\n1\\t\\u65e5\\u672c\\u8a9e\\n2\\t\\u82f1\\u8a9e\\n'\n\ncodecs \u3067\u8aad\u307f\u8fbc\u3080\u3068 unicode \u306b\u3057\u3066\u304f\u308c\u307e\u3059\u3002\n\npandas\ntsv \u3092\u8aad\u307f\u8fbc\u3080\u6642\u306b\u4fbf\u5229\u306a read_table \u95a2\u6570\u3002\n>>> import pandas as pd\n>>> df = pd.read_table(open(\"sample.tsv\", \"r\"))\n>>> df\n   ID   \u8a00\u8a9e\n0   1  \u65e5\u672c\u8a9e\n1   2   \u82f1\u8a9e\n>>> df.columns\nIndex([u'ID', u'\u8a00\u8a9e'], dtype='object')\n>>> df[u\"\u8a00\u8a9e\"]\nTraceback (most recent call last):\n  ...\nKeyError: u'\\u8a00\\u8a9e'\n>>> list(df.columns)\n['ID', '\\xe8\\xa8\\x80\\xe8\\xaa\\x9e']\n>>> type(list(df.columns)[1])\n<type 'str'>\n>>> df[\"\u8a00\u8a9e\"]\n0    \u65e5\u672c\u8a9e\n1     \u82f1\u8a9e\nName: \u8a00\u8a9e, dtype: object\n\ndf.columns \u306e\u8868\u793a\u306b u \u304c\u7740\u3044\u3066\u308b\u306e\u306f\u3088\u304f\u308f\u304b\u308a\u307e\u305b\u3093\u304c\u3001\n\u6587\u5b57\u5217\u306e\u578b\u304c str \u306a\u306e\u306f\u7d0d\u5f97\u3067\u3059\u306d\u3002\n\ncodecs & pandas\n\nwith read_table\n\n\u3067\u306f\u3000codecs \u3092\u4f7f\u3063\u3066 read_table \u3067\u8aad\u307f\u8fbc\u3080\u3068\n>>> df = pd.read_table(codecs.open(\"sample.tsv\", \"r\", \"utf-8\"))\n>>> df\n   ID   \u8a00\u8a9e\n0   1  \u65e5\u672c\u8a9e\n1   2   \u82f1\u8a9e\n>>> df[u\"\u8a00\u8a9e\"]\nTraceback (most recent call last):\n  ...\nKeyError: u'\\u8a00\\u8a9e'\n>>> df[\"\u8a00\u8a9e\"]\n0    \u65e5\u672c\u8a9e\n1     \u82f1\u8a9e\nName: \u8a00\u8a9e, dtype: object\n\n\u306a\u305c\u304b str \u306b\u306a\u308b\u307f\u305f\u3044\u3067\u3059\u3002\n\nwithout read_table\n\n>>> from collections import defaultdict\n>>> data = defaultdict(list)\n>>> f = codecs.open(\"sample.tsv\", \"r\", \"utf-8\")\n>>> labels = f.readline()[:-1].split(\"\\t\") # \u6539\u884c\u4ee5\u5916\u3092\u30bf\u30d6\u3067\u5206\u5272\n>>> values = f.readline()[:-1].split(\"\\t\") # \u6539\u884c\u4ee5\u5916\u3092\u30bf\u30d6\u3067\u5206\u5272\n>>> for label, value in zip(labels, values):\n...     data[label].append(value)\n... \n>>> df = pd.DataFrame(data)\n>>> df\n  ID   \u8a00\u8a9e\n0  1  \u65e5\u672c\u8a9e\n>>> df[\"\u8a00\u8a9e\"]\nTraceback (most recent call last):\n  ...\nKeyError: '\\xe8\\xa8\\x80\\xe8\\xaa\\x9e'\n>>> df[u\"\u8a00\u8a9e\"]\n0    \u65e5\u672c\u8a9e\nName: \u8a00\u8a9e, dtype: object\n>>> list(df.columns)\n[u'ID', u'\\u8a00\\u8a9e']\n>>> type(list(df.columns)[1])\n<type 'unicode'>\n\nread_table \u3092\u4f7f\u308f\u305a\u306b\ncodecs \u3067\u8aad\u307f\u8fbc\u3093\u3060\u5834\u5408\u306f\u3001\n \u60f3\u5b9a\u901a\u308a\u3067\u3057\u305f\u3002\n\n## \u74b0\u5883\n\n### \u30d0\u30fc\u30b8\u30e7\u30f3\n\n```console\n$ python --version\nPython 2.7.12 :: Continuum Analytics, Inc.\n$ pip freeze | grep pandas\npandas==0.19.1\n```\n\n### \u30b5\u30f3\u30d7\u30eb\u30d5\u30a1\u30a4\u30eb\n\n```console\n$ file --mime sample.tsv\nsample.tsv: text/plain; charset=utf-8\n$ cat sample.tsv\nID\t\u8a00\u8a9e\n1\t\u65e5\u672c\u8a9e\n2\t\u82f1\u8a9e\n```\n\n## codecs\n\n\u307e\u305a `codecs` \u3067\u3059\u304c\n\n```python\n>>> open(\"sample.tsv\", \"r\").read()\n'ID\\t\\xe8\\xa8\\x80\\xe8\\xaa\\x9e\\n1\\t\\xe6\\x97\\xa5\\xe6\\x9c\\xac\\xe8\\xaa\\x9e\\n2\\t\\xe8\\x8b\\xb1\\xe8\\xaa\\x9e\\n'\n>>> import codecs\n>>> codecs.open(\"sample.tsv\", \"r\", \"utf-8\").read()\nu'ID\\t\\u8a00\\u8a9e\\n1\\t\\u65e5\\u672c\\u8a9e\\n2\\t\\u82f1\\u8a9e\\n'\n```\n\n`codecs` \u3067\u8aad\u307f\u8fbc\u3080\u3068 `unicode` \u306b\u3057\u3066\u304f\u308c\u307e\u3059\u3002\n\n## pandas\n\n`tsv` \u3092\u8aad\u307f\u8fbc\u3080\u6642\u306b\u4fbf\u5229\u306a `read_table` \u95a2\u6570\u3002\n\n```python\n>>> import pandas as pd\n>>> df = pd.read_table(open(\"sample.tsv\", \"r\"))\n>>> df\n   ID   \u8a00\u8a9e\n0   1  \u65e5\u672c\u8a9e\n1   2   \u82f1\u8a9e\n>>> df.columns\nIndex([u'ID', u'\u8a00\u8a9e'], dtype='object')\n>>> df[u\"\u8a00\u8a9e\"]\nTraceback (most recent call last):\n  ...\nKeyError: u'\\u8a00\\u8a9e'\n>>> list(df.columns)\n['ID', '\\xe8\\xa8\\x80\\xe8\\xaa\\x9e']\n>>> type(list(df.columns)[1])\n<type 'str'>\n>>> df[\"\u8a00\u8a9e\"]\n0    \u65e5\u672c\u8a9e\n1     \u82f1\u8a9e\nName: \u8a00\u8a9e, dtype: object\n```\n\n`df.columns` \u306e\u8868\u793a\u306b `u` \u304c\u7740\u3044\u3066\u308b\u306e\u306f\u3088\u304f\u308f\u304b\u308a\u307e\u305b\u3093\u304c\u3001\n\u6587\u5b57\u5217\u306e\u578b\u304c `str` \u306a\u306e\u306f\u7d0d\u5f97\u3067\u3059\u306d\u3002\n\n## codecs & pandas\n\n### with `read_table`\n\n\u3067\u306f\u3000`codecs` \u3092\u4f7f\u3063\u3066 `read_table` \u3067\u8aad\u307f\u8fbc\u3080\u3068\n\n```python\n>>> df = pd.read_table(codecs.open(\"sample.tsv\", \"r\", \"utf-8\"))\n>>> df\n   ID   \u8a00\u8a9e\n0   1  \u65e5\u672c\u8a9e\n1   2   \u82f1\u8a9e\n>>> df[u\"\u8a00\u8a9e\"]\nTraceback (most recent call last):\n  ...\nKeyError: u'\\u8a00\\u8a9e'\n>>> df[\"\u8a00\u8a9e\"]\n0    \u65e5\u672c\u8a9e\n1     \u82f1\u8a9e\nName: \u8a00\u8a9e, dtype: object\n```\n\n\u306a\u305c\u304b `str` \u306b\u306a\u308b\u307f\u305f\u3044\u3067\u3059\u3002\n\n### without `read_table`\n\n```python\n>>> from collections import defaultdict\n>>> data = defaultdict(list)\n>>> f = codecs.open(\"sample.tsv\", \"r\", \"utf-8\")\n>>> labels = f.readline()[:-1].split(\"\\t\") # \u6539\u884c\u4ee5\u5916\u3092\u30bf\u30d6\u3067\u5206\u5272\n>>> values = f.readline()[:-1].split(\"\\t\") # \u6539\u884c\u4ee5\u5916\u3092\u30bf\u30d6\u3067\u5206\u5272\n>>> for label, value in zip(labels, values):\n...     data[label].append(value)\n... \n>>> df = pd.DataFrame(data)\n>>> df\n  ID   \u8a00\u8a9e\n0  1  \u65e5\u672c\u8a9e\n>>> df[\"\u8a00\u8a9e\"]\nTraceback (most recent call last):\n  ...\nKeyError: '\\xe8\\xa8\\x80\\xe8\\xaa\\x9e'\n>>> df[u\"\u8a00\u8a9e\"]\n0    \u65e5\u672c\u8a9e\nName: \u8a00\u8a9e, dtype: object\n>>> list(df.columns)\n[u'ID', u'\\u8a00\\u8a9e']\n>>> type(list(df.columns)[1])\n<type 'unicode'>\n```\n\n`read_table` \u3092\u4f7f\u308f\u305a\u306b\n `codecs` \u3067\u8aad\u307f\u8fbc\u3093\u3060\u5834\u5408\u306f\u3001\n \u60f3\u5b9a\u901a\u308a\u3067\u3057\u305f\u3002\n \n \n", "tags": ["pandas", "Python", "codecs"]}