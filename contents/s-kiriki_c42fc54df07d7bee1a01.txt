{"context": " More than 1 year has passed since last update.Vagrant\u3067\u3064\u304f\u3063\u305f\u74b0\u5883\u3092\u3001Chef\u3067\u30d7\u30ed\u30d3\u30b8\u30e7\u30cb\u30f3\u30b0\u3057\u3001\u305d\u308c\u3092serverspec\u3067\u30c6\u30b9\u30c8\u3057\u307e\u3059\u3002\n\n\u524d\u63d0\u74b0\u5883\n\u4ee5\u4e0b\u306e\u3082\u306e\u304c\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u3066\u3044\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\n\nVagnrat\nchef-solo\nknife\nserverspec\n\n\n\u4f5c\u696d\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306e\u7528\u610f\n> mkdir infra-tdd\n> cd infra-tdd\n\n\nVagrant\u306e\u7acb\u3061\u4e0a\u3052\nVagrant\u3092\u7acb\u3061\u4e0a\u3052\u307e\u3059\nvagrant box add **** \u3067\u3042\u3089\u304b\u3058\u3081box\u3092\u767b\u9332\u3059\u308b\u5fc5\u8981\u3042\u308a\u3002\nvagrant init opscode-centos-6.4\nvagrant up\n\n\u3053\u308c\u3067Vagrant\u30b5\u30fc\u30d0\u30fc\u304c\u7acb\u3061\u4e0a\u304c\u308b\u306e\u3067\u3001\n> vagrant ssh\n\n\u3067Vagrant\u30b5\u30fc\u30d0\u30fc\u306bssh\u30ed\u30b0\u30a4\u30f3\u3067\u304d\u308c\u3070OK\u3002\nVagrant\u30b5\u30fc\u30d0\u30fc\u306e\u63a5\u7d9a\u60c5\u5831\u3092\u6b21\u306e\u30b3\u30de\u30f3\u30c9\u3067.ssh/config\u306b\u8ffd\u8a18\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n> vagrant ssh-config --host infra-tdd >> ~/.ssh/config\n\n\nChef\u30ec\u30dd\u30b8\u30c8\u30ea\u306e\u6e96\u5099\nknife-solo\u3092\u4f7f\u3063\u3066Chef\u30ec\u30dd\u30b8\u30c8\u30ea\u3092\u521d\u671f\u5316\u3057\u307e\u3059\u3002\n> knife solo init .\n\n\u6b21\u306b\u3001\u5148\u307b\u3069\u306eVagrant\u30b5\u30fc\u30d0\u30fc\u3092Chef\u306enode\u3068\u3057\u3066\u8ffd\u52a0\u3057\u3066\u3042\u3052\u307e\u3059\u3002\n> knife solo bootstrap infra-tdd\n\n\u3053\u308c\u3067node\u3068\u3057\u3066\u8ffd\u52a0\u3055\u308c\u308b\u307b\u304b\u3001Vagrant\u30b5\u30fc\u30d0\u30fc\u306bChef\u304c\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u307e\u3059\u3002\n\n\u30c6\u30b9\u30c8\u306e\u7528\u610f\n\u4eca\u56de\u306fTDD\u306a\u306e\u3067\u3001serverspec\u3092\u4f7f\u3063\u3066\u30c6\u30b9\u30c8\u3092\u5148\u306b\u66f8\u3044\u3066\u884c\u304d\u307e\u3059\u3002\n> serverspec-init\n\n\u3092\u5b9f\u884c\u3059\u308b\u3068\u3001\u3044\u308d\u3044\u308d\u805e\u304b\u308c\u308b\u306e\u3067\u7b54\u3048\u3066\u3044\u304d\u307e\u3059\u3002\nSelect OS type:\n\n  1) UN*X\n  2) Windows\n\nSelect number: 1\n\nSelect a backend type:\n\n  1) SSH\n  2) Exec (local)\n\nSelect number: 1\n\nVagrant instance y/n: y\nAuto-configure Vagrant from Vagrantfile? y/n: y\n + spec/\n + spec/default/\n + spec/default/httpd_spec.rb\n + spec/spec_helper.rb\n + Rakefile\n\n\nspec/default/httpd_spec.rb\u3068\u3044\u3046\u30d5\u30a1\u30a4\u30eb\u304c\u65e2\u306b\u4f5c\u3089\u308c\u3066\u3044\u308b\u306e\u3067\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u7de8\u96c6(\u4f59\u8a08\u306a\u90e8\u5206\u3092\u524a\u3063\u305f\u3060\u3051\u3067\u3059)\n\nspec/default/httpd_spec.rb\nrequire 'spec_helper'\n\ndescribe package('httpd') do\n  it { should be_installed }\nend\n\n\n\u300chttpd\u304c\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u3066\u3044\u308b\u3079\u304d\u300d\u3068\u3044\u3063\u305fTDD\u306a\u3089\u306cBDD(\u632f\u308b\u821e\u3044\u99c6\u52d5\u958b\u767a)\u3063\u307d\u3044\u611f\u3058\u3067\u30c6\u30b9\u30c8\u304c\u66f8\u3051\u307e\u3059\u3002\n\n\u30c6\u30b9\u30c8\u306e\u5b9f\u65bd\n\u3044\u3088\u3044\u3088\u30c6\u30b9\u30c8\u3092\u5b9f\u65bd\u3057\u3066\u307f\u307e\u3059\u3002\n> rake spec\n\n\u3053\u308c\u3060\u3051\u3067\u30c6\u30b9\u30c8\u304c\u5b9f\u884c\u3055\u308c\u307e\u3059\u3002\u5b9f\u884c\u7d50\u679c\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\n\n/System/Library/Frameworks/Ruby.framework/Versions/2.0/usr/bin/ruby -S rspec spec/default/httpd_spec.rb\nF\n\nFailures:\n\n  1) Package \"httpd\" should be installed\n     On host `default`\n     Failure/Error: it { should be_installed }\n       sudo rpm -q httpd\n       \u30d1\u30c3\u30b1\u30fc\u30b8 httpd \u306f\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u3066\u3044\u307e\u305b\u3093\u3002\n       expected Package \"httpd\" to be installed\n     # ./spec/default/httpd_spec.rb:4:in `block (2 levels) in <top (required)>'\n\nFinished in 3.6 seconds\n1 example, 1 failure\n\nFailed examples:\n\nrspec ./spec/default/httpd_spec.rb:4 # Package \"httpd\" should be installed\n/System/Library/Frameworks/Ruby.framework/Versions/2.0/usr/bin/ruby -S rspec spec/default/httpd_spec.rb failed\n\n\nhttpd\u304c\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u3066\u3044\u306a\u3044\u306e\u3067\u3001\u30c6\u30b9\u30c8\u304c\u901a\u308a\u307e\u305b\u3093\u3002\n\n\u30ec\u30b7\u30d4\u306e\u7528\u610f\n\u6b21\u306b\u3001\u30c6\u30b9\u30c8\u3092\u901a\u3059\u305f\u3081\u306eapache\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\u30ec\u30b7\u30d4\u3092\u6e96\u5099\u3057\u3066\u3044\u304d\u307e\u3059\u3002\n> knife cookbook create apache -o site-cookbooks\n\nsite-cookbooks/apache/recipes/default.rb\u304c\u51fa\u6765\u3066\u307e\u3059\u306e\u3067\u3001\u3053\u308c\u3092\u7de8\u96c6\u3057\u307e\u3059\n\nsite-cookbooks/apache/recipes/default.rb\npackage \"httpd\" do\n action :install\nend\n\nservice \"httpd\" do\n action [ :enable, :start ]\nend\n\n\n\u3053\u306e\u30ec\u30b7\u30d4\u3092node\u306e\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb(nodes/infra-tdd.json)\u306b\u8ffd\u52a0\n\nnodes/infra-tdd.json\n{\n  \"run_list\": [\n    \"recipe[apache]\"\n  ]\n}\n\n\n\n\u30d7\u30ed\u30d3\u30b8\u30e7\u30cb\u30f3\u30b0\u306e\u5b9f\u884c\u3068\u30c6\u30b9\u30c8\u518d\u5b9f\u65bd\n\u4ee5\u4e0b\u306e\u30b3\u30de\u30f3\u30c9\u3067infra-add(Vagrant\u30b5\u30fc\u30d0\u30fc)\u306b\u5bfe\u3057\u3066Chef\u306b\u3088\u308b\u30d7\u30ed\u30d3\u30b8\u30e7\u30cb\u30f3\u30b0\u304c\u884c\u308f\u308c\u307e\u3059\u3002\n> knife solo cook infra-tdd\n\n\u3053\u308c\u3067\u3001httpd\u304c\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u305f\u306f\u305a\u306a\u306e\u3067\u3001serverspec\u306b\u3088\u308b\u30c6\u30b9\u30c8\u3092\u518d\u5b9f\u65bd\u3057\u3066\u307f\u307e\u3059\u3002\n> rake spec\n\n/System/Library/Frameworks/Ruby.framework/Versions/2.0/usr/bin/ruby -S rspec spec/default/httpd_spec.rb\n.\n\nFinished in 4.01 seconds\n1 example, 0 failures\n\n\n\u4eca\u56de\u306f\u3061\u3083\u3093\u3068\u30c6\u30b9\u30c8\u304c\u6210\u529f\u3057\u307e\u3057\u305f\u3002\n\u4ee5\u4e0a\u306e\u3088\u3046\u306a\u6d41\u308c\u3067Vagrant\u3001Chef\u3001serverspec\u3092\u3064\u304b\u3063\u305fTDD\u304c\u884c\u3048\u307e\u3059\u3002\nVagrant\u3067\u3064\u304f\u3063\u305f\u74b0\u5883\u3092\u3001Chef\u3067\u30d7\u30ed\u30d3\u30b8\u30e7\u30cb\u30f3\u30b0\u3057\u3001\u305d\u308c\u3092serverspec\u3067\u30c6\u30b9\u30c8\u3057\u307e\u3059\u3002\n\n##\u524d\u63d0\u74b0\u5883\n\u4ee5\u4e0b\u306e\u3082\u306e\u304c\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u3066\u3044\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\n\n* Vagnrat\n* chef-solo\n* knife\n* serverspec\n\n##\u4f5c\u696d\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306e\u7528\u610f\n\n```\n> mkdir infra-tdd\n> cd infra-tdd\n```\n\n##Vagrant\u306e\u7acb\u3061\u4e0a\u3052\n\nVagrant\u3092\u7acb\u3061\u4e0a\u3052\u307e\u3059\nvagrant box add **** \u3067\u3042\u3089\u304b\u3058\u3081box\u3092\u767b\u9332\u3059\u308b\u5fc5\u8981\u3042\u308a\u3002\n\n```\nvagrant init opscode-centos-6.4\nvagrant up\n```\n\n\u3053\u308c\u3067Vagrant\u30b5\u30fc\u30d0\u30fc\u304c\u7acb\u3061\u4e0a\u304c\u308b\u306e\u3067\u3001\n\n```\n> vagrant ssh\n```\n\n\u3067Vagrant\u30b5\u30fc\u30d0\u30fc\u306bssh\u30ed\u30b0\u30a4\u30f3\u3067\u304d\u308c\u3070OK\u3002\n\n\nVagrant\u30b5\u30fc\u30d0\u30fc\u306e\u63a5\u7d9a\u60c5\u5831\u3092\u6b21\u306e\u30b3\u30de\u30f3\u30c9\u3067.ssh/config\u306b\u8ffd\u8a18\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n\n```\n> vagrant ssh-config --host infra-tdd >> ~/.ssh/config\n```\n\n##Chef\u30ec\u30dd\u30b8\u30c8\u30ea\u306e\u6e96\u5099\nknife-solo\u3092\u4f7f\u3063\u3066Chef\u30ec\u30dd\u30b8\u30c8\u30ea\u3092\u521d\u671f\u5316\u3057\u307e\u3059\u3002\n\n```\n> knife solo init .\n```\n\n\u6b21\u306b\u3001\u5148\u307b\u3069\u306eVagrant\u30b5\u30fc\u30d0\u30fc\u3092Chef\u306enode\u3068\u3057\u3066\u8ffd\u52a0\u3057\u3066\u3042\u3052\u307e\u3059\u3002\n\n```\n> knife solo bootstrap infra-tdd\n```\n\n\u3053\u308c\u3067node\u3068\u3057\u3066\u8ffd\u52a0\u3055\u308c\u308b\u307b\u304b\u3001Vagrant\u30b5\u30fc\u30d0\u30fc\u306bChef\u304c\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u307e\u3059\u3002\n\n##\u30c6\u30b9\u30c8\u306e\u7528\u610f\n\u4eca\u56de\u306fTDD\u306a\u306e\u3067\u3001serverspec\u3092\u4f7f\u3063\u3066\u30c6\u30b9\u30c8\u3092\u5148\u306b\u66f8\u3044\u3066\u884c\u304d\u307e\u3059\u3002\n\n```\n> serverspec-init\n```\n\n\u3092\u5b9f\u884c\u3059\u308b\u3068\u3001\u3044\u308d\u3044\u308d\u805e\u304b\u308c\u308b\u306e\u3067\u7b54\u3048\u3066\u3044\u304d\u307e\u3059\u3002\n\n```\nSelect OS type:\n\n  1) UN*X\n  2) Windows\n\nSelect number: 1\n\nSelect a backend type:\n\n  1) SSH\n  2) Exec (local)\n\nSelect number: 1\n\nVagrant instance y/n: y\nAuto-configure Vagrant from Vagrantfile? y/n: y\n + spec/\n + spec/default/\n + spec/default/httpd_spec.rb\n + spec/spec_helper.rb\n + Rakefile\n \n```\n\n`spec/default/httpd_spec.rb`\u3068\u3044\u3046\u30d5\u30a1\u30a4\u30eb\u304c\u65e2\u306b\u4f5c\u3089\u308c\u3066\u3044\u308b\u306e\u3067\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u7de8\u96c6(\u4f59\u8a08\u306a\u90e8\u5206\u3092\u524a\u3063\u305f\u3060\u3051\u3067\u3059)\n\n```spec/default/httpd_spec.rb\nrequire 'spec_helper'\n\ndescribe package('httpd') do\n  it { should be_installed }\nend\n```\n\n\u300chttpd\u304c\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u3066\u3044\u308b\u3079\u304d\u300d\u3068\u3044\u3063\u305fTDD\u306a\u3089\u306cBDD(\u632f\u308b\u821e\u3044\u99c6\u52d5\u958b\u767a)\u3063\u307d\u3044\u611f\u3058\u3067\u30c6\u30b9\u30c8\u304c\u66f8\u3051\u307e\u3059\u3002\n\n##\u30c6\u30b9\u30c8\u306e\u5b9f\u65bd\n\n\u3044\u3088\u3044\u3088\u30c6\u30b9\u30c8\u3092\u5b9f\u65bd\u3057\u3066\u307f\u307e\u3059\u3002\n\n```\n> rake spec\n```\n\u3053\u308c\u3060\u3051\u3067\u30c6\u30b9\u30c8\u304c\u5b9f\u884c\u3055\u308c\u307e\u3059\u3002\u5b9f\u884c\u7d50\u679c\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\n\n```\n\n/System/Library/Frameworks/Ruby.framework/Versions/2.0/usr/bin/ruby -S rspec spec/default/httpd_spec.rb\nF\n\nFailures:\n\n  1) Package \"httpd\" should be installed\n     On host `default`\n     Failure/Error: it { should be_installed }\n       sudo rpm -q httpd\n       \u30d1\u30c3\u30b1\u30fc\u30b8 httpd \u306f\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u3066\u3044\u307e\u305b\u3093\u3002\n       expected Package \"httpd\" to be installed\n     # ./spec/default/httpd_spec.rb:4:in `block (2 levels) in <top (required)>'\n\nFinished in 3.6 seconds\n1 example, 1 failure\n\nFailed examples:\n\nrspec ./spec/default/httpd_spec.rb:4 # Package \"httpd\" should be installed\n/System/Library/Frameworks/Ruby.framework/Versions/2.0/usr/bin/ruby -S rspec spec/default/httpd_spec.rb failed\n\n```\n\nhttpd\u304c\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u3066\u3044\u306a\u3044\u306e\u3067\u3001\u30c6\u30b9\u30c8\u304c\u901a\u308a\u307e\u305b\u3093\u3002\n\n\n##\u30ec\u30b7\u30d4\u306e\u7528\u610f\n\n\u6b21\u306b\u3001\u30c6\u30b9\u30c8\u3092\u901a\u3059\u305f\u3081\u306eapache\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\u30ec\u30b7\u30d4\u3092\u6e96\u5099\u3057\u3066\u3044\u304d\u307e\u3059\u3002\n\n```\n> knife cookbook create apache -o site-cookbooks\n```\n\n`site-cookbooks/apache/recipes/default.rb`\u304c\u51fa\u6765\u3066\u307e\u3059\u306e\u3067\u3001\u3053\u308c\u3092\u7de8\u96c6\u3057\u307e\u3059\n\n```site-cookbooks/apache/recipes/default.rb\npackage \"httpd\" do\n action :install\nend\n\nservice \"httpd\" do\n action [ :enable, :start ]\nend\n```\n\n\u3053\u306e\u30ec\u30b7\u30d4\u3092node\u306e\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb(nodes/infra-tdd.json)\u306b\u8ffd\u52a0\n\n```nodes/infra-tdd.json\n{\n  \"run_list\": [\n    \"recipe[apache]\"\n  ]\n}\n```\n\n##\u30d7\u30ed\u30d3\u30b8\u30e7\u30cb\u30f3\u30b0\u306e\u5b9f\u884c\u3068\u30c6\u30b9\u30c8\u518d\u5b9f\u65bd\n\n\u4ee5\u4e0b\u306e\u30b3\u30de\u30f3\u30c9\u3067infra-add(Vagrant\u30b5\u30fc\u30d0\u30fc)\u306b\u5bfe\u3057\u3066Chef\u306b\u3088\u308b\u30d7\u30ed\u30d3\u30b8\u30e7\u30cb\u30f3\u30b0\u304c\u884c\u308f\u308c\u307e\u3059\u3002\n\n```\n> knife solo cook infra-tdd\n```\n\n\u3053\u308c\u3067\u3001httpd\u304c\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u305f\u306f\u305a\u306a\u306e\u3067\u3001serverspec\u306b\u3088\u308b\u30c6\u30b9\u30c8\u3092\u518d\u5b9f\u65bd\u3057\u3066\u307f\u307e\u3059\u3002\n\n```\n> rake spec\n\n/System/Library/Frameworks/Ruby.framework/Versions/2.0/usr/bin/ruby -S rspec spec/default/httpd_spec.rb\n.\n\nFinished in 4.01 seconds\n1 example, 0 failures\n\n```\n\n\u4eca\u56de\u306f\u3061\u3083\u3093\u3068\u30c6\u30b9\u30c8\u304c\u6210\u529f\u3057\u307e\u3057\u305f\u3002\n\u4ee5\u4e0a\u306e\u3088\u3046\u306a\u6d41\u308c\u3067Vagrant\u3001Chef\u3001serverspec\u3092\u3064\u304b\u3063\u305fTDD\u304c\u884c\u3048\u307e\u3059\u3002\n\n\n\n\n\n\n\n\n\n\n\n", "tags": ["chef11.12.8", "vagrant1.6.3", "serverspec", "TDD"]}