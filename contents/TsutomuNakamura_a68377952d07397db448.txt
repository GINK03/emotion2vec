{"tags": ["Linux", "lvm"], "context": " More than 1 year has passed since last update.\n\n\u524d\u56de\u8a18\u4e8b\nLVM\u3067RAID1\u306e\u69cb\u7bc9\u3001\u969c\u5bb3\u5bfe\u5fdc\u3001\u4ed6RAID\u30dc\u30ea\u30e5\u30fc\u30e0\u306e\u8ffd\u52a0\n\n\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u306b\u3064\u3044\u3066\n\u3053\u3053\u3067\u306f\u3001\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u304c\u3069\u306e\u3088\u3046\u306b\u4fbf\u5229\u306a\u306e\u304b\u3001\u305d\u3057\u3066\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u3092\u3069\u306e\u3088\u3046\u306b\u4f5c\u6210\u3001\u4f7f\u7528\u3059\u308b\u304b\u306b\u3064\u3044\u3066\u8aac\u660e\u3057\u3066\u3044\u304d\u307e\u3059\u3002\n\u3053\u3053\u3067\u306f\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u306e\u30e6\u30fc\u30b9\u30b1\u30fc\u30b9\u3092\u60f3\u5b9a\u3057\u305f\u4f7f\u7528\u65b9\u6cd5\u306b\u3064\u3044\u3066\u8aac\u660e\u3057\u3066\u3044\u304d\u307e\u3059\u3002\n\n \u4e00\u8cab\u6027\u306e\u3042\u308b\u72b6\u614b\u306e\u4fdd\u6301\n \u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u53d6\u5f97\u6642\u70b9\u306e\u30c7\u30fc\u30bf\u306e\u72b6\u614b\u3092\u305d\u306e\u307e\u307e\u4fdd\u7ba1\u3059\u308b\u3088\u3046\u306a\u30d0\u30c3\u30af\u30a2\u30c3\u30d7\u306b\u4f7f\u7528\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n \u4f8b\u3048\u3070\u6bce\u65e5AM02:00 \u6642\u70b9\u3067DB \u30c7\u30fc\u30bf\u3092\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u3068\u3057\u3066\u53d6\u5f97\u3057\u3066\u304a\u304f\u3053\u3068\u3067\u3001\u305d\u306e\u65e5\u306eAM02:00 \u6642\u70b9\u306e\u30c7\u30fc\u30bf\u3092\u305d\u306e\u307e\u307e\u306e\u72b6\u614b\u3067\u30c7\u30fc\u30bf\u3092\u4fdd\u6301\u3057\u3066\u304a\u304f\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n \u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u306f\u30aa\u30ea\u30b8\u30ca\u30eb\u30dc\u30ea\u30e5\u30fc\u30e0\u53c8\u306f\u3001\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u30dc\u30ea\u30e5\u30fc\u30e0\u306e\u3044\u305a\u308c\u304b\u304c\u7834\u640d\u3059\u308b\u3068\u72b6\u614b\u306e\u5fa9\u65e7\u304c\u3067\u304d\u306a\u304f\u306a\u308b\u306e\u3067\u3001\u30d0\u30c3\u30af\u30a2\u30c3\u30d7\u3068\u306f\u547c\u3073\u3065\u3089\u3044(\u500b\u4eba\u7684\u4e3b\u89b3)\n\n\n \u30d5\u30a7\u30a4\u30eb\u30d0\u30c3\u30af\n \u4f55\u304b\u51e6\u7406\u3092\u884c\u3063\u3066\u5931\u6557\u3057\u305f\u6642\u306b\u30d5\u30a7\u30a4\u30eb\u30d0\u30c3\u30af\u3092\u3059\u308b\u76ee\u7684\u3067\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u3092\u53d6\u5f97\u3057\u3066\u304a\u304f\u3053\u3068\u3082\u3067\u304d\u307e\u3059\u3002\n \u4f8b\u3048\u3070\u3001\u4eca\u307e\u3067\u554f\u984c\u306a\u304f\u52d5\u3044\u3066\u3044\u305f\u306e\u306b\u3001\u30d1\u30c3\u30b1\u30fc\u30b8\u3092\u30a2\u30c3\u30d7\u30b0\u30ec\u30fc\u30c9\u3057\u305f\u9014\u7aef\u306b\u554f\u984c\u304c\u767a\u751f\u3057\u305f\u5834\u5408\u3001\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u3092\u53d6\u5f97\u3057\u3066\u3044\u305f\u6642\u70b9\u306b\u623b\u308b\u3053\u3068\u3067\u3001\u72b6\u614b\u306e\u5207\u308a\u623b\u3057\u3092\u884c\u3046\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u306f\u3053\u308c\u3089\u4ee5\u5916\u306b\u3082\u7528\u9014\u306f\u3042\u308a\u307e\u3059\u304c\u3001\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u7528\u306e\u8ad6\u7406\u30dc\u30ea\u30e5\u30fc\u30e0\u3068\u30aa\u30ea\u30b8\u30ca\u30eb\u30dc\u30ea\u30e5\u30fc\u30e0\u3092\u5206\u3051\u3066\u3001\u30c0\u30a6\u30f3\u30bf\u30a4\u30e0\u306a\u3057\u306b\u30d0\u30c3\u30af\u30a2\u30c3\u30d7\u306e\u53d6\u5f97\u3092\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u3001\u4f5c\u696d\u3092\u6b62\u3081\u308b\u5fc5\u8981\u304c\u306a\u304f\u306a\u308a\u307e\u3059\u3002\n\n\u74b0\u5883\n\u4eca\u56de\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u306e\u52d5\u4f5c\u78ba\u8a8d\u3092\u884c\u3046\u74b0\u5883\u3068\u3057\u3066\u3001\u6b21\u306e\u3088\u3046\u306a\u74b0\u5883\u3092\u4f7f\u7528\u3057\u3066\u3044\u307e\u3059\u3002\n\n\n OS\n\n Fedora21\n\n\n\n \u30c7\u30a3\u30b9\u30af\n LVM \u3067OS \u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u6e08\u307f\n\n\n \u30aa\u30ea\u30b8\u30ca\u30eb\u30c7\u30d0\u30a4\u30b9\n /dev/lv-test/original-volume (\u7d0416GB)\n\n\n \u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u30c7\u30d0\u30a4\u30b9\n /dev/sdc1 (LVM \u306e\u7d041GB \u306e\u9818\u57df)\n\n# pvdisplay\n  --- Physical volume ---\n  PV Name               /dev/sdb1\n  VG Name               lvm-test\n  PV Size               20.00 GiB / not usable 3.00 MiB\n  Allocatable           yes (but full)\n  PE Size               4.00 MiB\n  Total PE              5119\n  Free PE               0\n  Allocated PE          5119\n  PV UUID               dVsuOL-GDdS-xVm1-rv6I-HeiK-bH1D-U7z86Z\n\n# vgdisplay\n  --- Volume group ---\n  VG Name               lvm-test\n  System ID             \n  Format                lvm2\n  Metadata Areas        1\n  Metadata Sequence No  2\n  VG Access             read/write\n  VG Status             resizable\n  MAX LV                0\n  Cur LV                1\n  Open LV               0\n  Max PV                0\n  Cur PV                1\n  Act PV                1\n  VG Size               20.00 GiB\n  PE Size               4.00 MiB\n  Total PE              5119\n  Alloc PE / Size       5119 / 20.00 GiB\n  Free  PE / Size       0 / 0   \n  VG UUID               un2LXy-Jqiv-eea5-ymVf-0vOL-KCH6-6yNuIY\n\n# lvdisplay\n  --- Logical volume ---\n  LV Path                /dev/lvm-test/original\n  LV Name                original\n  VG Name                lvm-test\n  LV UUID                yCNmOc-iZqq-0CIl-fA1Z-0omo-2boC-60IycV\n  LV Write Access        read/write\n  LV Creation host, time fedora-lvm01, 2015-03-21 19:10:48 +0900\n  LV Status              available\n  # open                 0\n  LV Size                20.00 GiB\n  Current LE             5119\n  Segments               1\n  Allocation             inherit\n  Read ahead sectors     auto\n  - currently set to     256\n  Block device           253:0\n\n# parted /dev/lvm-test/original 'print'\nModel: Linux device-mapper (linear) (dm)\nDisk /dev/dm-0: 21.5GB\nSector size (logical/physical): 512B/512B\nPartition Table: loop\nDisk Flags: \n\nNumber  Start  End     Size    File system  Flags\n 1      0.00B  21.5GB  21.5GB  ext4\n\n\u4eca\u56de\u306f/dev/lvm-test/original \u8ad6\u7406\u30c7\u30d0\u30a4\u30b9\u306e\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u3092\u3053\u308c\u304b\u3089\u4f5c\u6210\u3059\u308b/dev/lvm-test/snap \u4e0a\u306e\u8ad6\u7406\u30c7\u30d0\u30a4\u30b9\u306b\u53d6\u5f97\u3057\u3066\u3044\u304d\u307e\u3059\u3002\nlvm-test \u8ad6\u7406\u30dc\u30ea\u30e5\u30fc\u30e0\u30b0\u30eb\u30fc\u30d7\u306f\u7a7a\u304d\u306e\u30a8\u30af\u30b9\u30c6\u30f3\u30c8\u304c\u306a\u3044\u3053\u3068\u304c\u78ba\u8a8d\u3067\u304d\u307e\u3059(Free PE /size    0 / 0)\u3002\n\u305d\u306e\u305f\u3081\u3001\u4eca\u56de\u306f\u7269\u7406\u30c7\u30d0\u30a4\u30b9/dev/sdc \u4e0a\u306b\u7269\u7406\u30dc\u30ea\u30e5\u30fc\u30e0\u3092\u4f5c\u6210\u3057\u3001lvm-test \u30dc\u30ea\u30e5\u30fc\u30e0\u30b0\u30eb\u30fc\u30d7\u306b\u8ffd\u52a0\u3057\u3001\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u30dc\u30ea\u30e5\u30fc\u30e0\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\u306a\u304a\u3001\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u3092\u53d6\u5f97\u3059\u308b\u5834\u5408\u306f\u3001\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u30dc\u30ea\u30e5\u30fc\u30e0\u306f\u540c\u3058\u30b0\u30eb\u30fc\u30d7\u3067\u306a\u3051\u308c\u3070\u3044\u3051\u307e\u305b\u3093\u3002\n\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u3092\u6709\u52b9\u7684\u306b\u4f7f\u3046\u305f\u3081\u306b\u306f\u3001snapshot merge \u6a5f\u80fd\u304c\u3042\u308b\u3068\u3001\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u304b\u3089\u30d5\u30a7\u30a4\u30eb\u30d0\u30c3\u30af\u3059\u308b\u3068\u304d\u306b\u975e\u5e38\u306b\u4fbf\u5229\u3067\u3059\u3002\n\u78ba\u8a8d\u3059\u308b\u306b\u306f\u3001dmsetup targets \u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3057\u307e\u3059\u3002\n# dmsetup targets\nzero             v1.1.0\nmirror           v1.13.2\nsnapshot-merge   v1.2.0\nsnapshot-origin  v1.8.1\nsnapshot         v1.12.0\nstriped          v1.5.1\nlinear           v1.2.1\nerror            v1.2.0\n\n\n\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u30dc\u30ea\u30e5\u30fc\u30e0\u306e\u4f5c\u6210\n\u307e\u305a\u3001\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u306e\u53d6\u5f97\u5143\u3068\u306a\u308b/dev/lvm-test/original \u3092\u30de\u30a6\u30f3\u30c8\u3057\u307e\u3059\u3002\n# mkdir /mnt/{original,snap}\n# mount /dev/lvm-test/original /mnt/original\n# df -h \nFilesystem                      Size  Used Avail Use% Mounted on\n/dev/sda3                        35G  1.5G   32G   5% /\ndevtmpfs                        2.0G     0  2.0G   0% /dev\ntmpfs                           2.0G     0  2.0G   0% /dev/shm\ntmpfs                           2.0G  532K  2.0G   1% /run\ntmpfs                           2.0G     0  2.0G   0% /sys/fs/cgroup\ntmpfs                           2.0G  4.0K  2.0G   1% /tmp\n/dev/sda1                       477M  113M  335M  26% /boot\ntmpfs                           394M     0  394M   0% /run/user/1000\n/dev/mapper/lvm--test-original   20G   44M   19G   1% /mnt/original\n\n\u4eca\u56de\u306f/dev/sdc \u7269\u7406\u30c7\u30d0\u30a4\u30b9\u4e0a\u306b/dev/lvm-test/snap \u8ad6\u7406\u30dc\u30ea\u30e5\u30fc\u30e0\u3092\u4f5c\u6210\u3057\u3001/dev/lvm-test/original \u8ad6\u7406\u30dc\u30ea\u30e5\u30fc\u30e0\u306e\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u9818\u57df\u3092\u4f5c\u6210\u3057\u3066\u3044\u304d\u307e\u3059\u3002\n\u3042\u3068\u3067\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u306e\u52d5\u304d\u3092\u78ba\u8a8d\u3057\u3084\u3059\u3044\u3088\u3046\u306b\u4e8b\u524d\u306b\u6b21\u306e\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3057\u3066\u3001100MiB \u306e\u30c6\u30b9\u30c8\u7528\u306e\u30d5\u30a1\u30a4\u30eb\u3092\u3044\u304f\u3064\u304b\u4f5c\u6210\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n# mkdir /opt/lvm-test\n# for I in {1..100}; do echo \"dd if#/dev/urandom of=/mnt/original/file_\"$(printf \"%04d\" ${I})\" bs=$((1 * 1024)) count$((1 * 1024 * 100))\"; done | xargs -I{} -P 2 bash -c {}\n.......\n# ls -ltr /mnt/original | tail\n-rw-r--r--. 1 root root 104857600 Mar 21 19:28 file_0091\n-rw-r--r--. 1 root root 104857600 Mar 21 19:28 file_0092\n-rw-r--r--. 1 root root 104857600 Mar 21 19:28 file_0093\n-rw-r--r--. 1 root root 104857600 Mar 21 19:28 file_0094\n-rw-r--r--. 1 root root 104857600 Mar 21 19:29 file_0095\n-rw-r--r--. 1 root root 104857600 Mar 21 19:29 file_0096\n-rw-r--r--. 1 root root 104857600 Mar 21 19:29 file_0097\n-rw-r--r--. 1 root root 104857600 Mar 21 19:29 file_0098\n-rw-r--r--. 1 root root 104857600 Mar 21 19:29 file_0099\n-rw-r--r--. 1 root root 104857600 Mar 21 19:29 file_0100\n\n\u4eca\u56de\u3001\u30aa\u30ea\u30b8\u30ca\u30eb\u306e\u8ad6\u7406\u30dc\u30ea\u30e5\u30fc\u30e0\u306e\u5168\u4f53\u30b5\u30a4\u30ba\u306f20GB \u3042\u308a\u307e\u3059\u304c\u3001\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u30dc\u30ea\u30e5\u30fc\u30e0\u306f\u305d\u308c\u3068\u540c\u3058\u30b5\u30a4\u30ba\u3092\u4f5c\u6210\u3059\u308b\u5fc5\u8981\u306f\u3042\u308a\u307e\u305b\u3093\u3002\n\u30aa\u30ea\u30b8\u30ca\u30eb\u306e\u30dc\u30ea\u30e5\u30fc\u30e0\u5185\u306e\u30c7\u30fc\u30bf\u306e\u5909\u66f4\u91cf\u306b\u3088\u3063\u3066\u3001\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u30dc\u30ea\u30e5\u30fc\u30e0\u306e\u5fc5\u8981\u306a\u5bb9\u91cf\u306f\u5909\u308f\u3063\u3066\u304f\u308b\u306e\u3067\u3001\u5b8c\u5168\u306a\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u30dc\u30ea\u30e5\u30fc\u30e0\u306b\u5fc5\u8981\u306a\u5bb9\u91cf\u3092\u898b\u7a4d\u3082\u308b\u3053\u3068\u306f\u3053\u3053\u3067\u306f\u3067\u304d\u307e\u305b\u3093\u3002\n\u3068\u308a\u3042\u3048\u305a\u30011GB \u306e\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u3092\u4f5c\u6210\u3057\u3066\u3044\u304d\u307e\u3059\u3002\n\n/dev/sdc\u306b\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30f3\u3092\u4f5c\u6210\u3059\u308b\n# fdisk /dev/sdc\n\nWelcome to fdisk (util-linux 2.25.2).\nChanges will remain in memory only, until you decide to write them.\nBe careful before using the write command.\n\n\nCommand (m for help): n\nPartition type\n   p   primary (0 primary, 0 extended, 4 free)\n   e   extended (container for logical partitions)\nSelect (default p): \n\nUsing default response p.\nPartition number (1-4, default 1): \nFirst sector (2048-41943039, default 2048): \nLast sector, +sectors or +size{K,M,G,T,P} (2048-41943039, default 41943039): +1G\n\nCreated a new partition 1 of type 'Linux' and of size 1 GiB.\n\nCommand (m for help): t\nSelected partition 1\nHex code (type L to list all codes): L\n\n 0  Empty           24  NEC DOS         81  Minix / old Lin bf  Solaris        \n 1  FAT12           27  Hidden NTFS Win 82  Linux swap / So c1  DRDOS/sec (FAT-\n 2  XENIX root      39  Plan 9          83  Linux           c4  DRDOS/sec (FAT-\n 3  XENIX usr       3c  PartitionMagic  84  OS/2 hidden C:  c6  DRDOS/sec (FAT-\n 4  FAT16 <32M      40  Venix 80286     85  Linux extended  c7  Syrinx         \n 5  Extended        41  PPC PReP Boot   86  NTFS volume set da  Non-FS data    \n 6  FAT16           42  SFS             87  NTFS volume set db  CP/M / CTOS / .\n 7  HPFS/NTFS/exFAT 4d  QNX4.x          88  Linux plaintext de  Dell Utility   \n 8  AIX             4e  QNX4.x 2nd part 8e  Linux LVM       df  BootIt         \n 9  AIX bootable    4f  QNX4.x 3rd part 93  Amoeba          e1  DOS access     \n a  OS/2 Boot Manag 50  OnTrack DM      94  Amoeba BBT      e3  DOS R/O        \n b  W95 FAT32       51  OnTrack DM6 Aux 9f  BSD/OS          e4  SpeedStor      \n c  W95 FAT32 (LBA) 52  CP/M            a0  IBM Thinkpad hi eb  BeOS fs        \n e  W95 FAT16 (LBA) 53  OnTrack DM6 Aux a5  FreeBSD         ee  GPT            \n f  W95 Ext'd (LBA) 54  OnTrackDM6      a6  OpenBSD         ef  EFI (FAT-12/16/\n10  OPUS            55  EZ-Drive        a7  NeXTSTEP        f0  Linux/PA-RISC b\n11  Hidden FAT12    56  Golden Bow      a8  Darwin UFS      f1  SpeedStor      \n12  Compaq diagnost 5c  Priam Edisk     a9  NetBSD          f4  SpeedStor      \n14  Hidden FAT16 <3 61  SpeedStor       ab  Darwin boot     f2  DOS secondary  \n16  Hidden FAT16    63  GNU HURD or Sys af  HFS / HFS+      fb  VMware VMFS    \n17  Hidden HPFS/NTF 64  Novell Netware  b7  BSDI fs         fc  VMware VMKCORE \n18  AST SmartSleep  65  Novell Netware  b8  BSDI swap       fd  Linux raid auto\n1b  Hidden W95 FAT3 70  DiskSecure Mult bb  Boot Wizard hid fe  LANstep        \n1c  Hidden W95 FAT3 75  PC/IX           be  Solaris boot    ff  BBT            \n1e  Hidden W95 FAT1 80  Old Minix      \nHex code (type L to list all codes): 8e\nChanged type of partition 'Linux' to 'Linux LVM'.\n\nCommand (m for help): w\nThe partition table has been altered.\nCalling ioctl() to re-read partition table.\nSyncing disks.\n\n\n\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u7528\u306e\u7269\u7406\u30dc\u30ea\u30e5\u30fc\u30e0\u3001\u8ad6\u7406\u30dc\u30ea\u30e5\u30fc\u30e0\u30b0\u30eb\u30fc\u30d7\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\n\u7269\u7406\u30dc\u30ea\u30e5\u30fc\u30e0\u306e\u4f5c\u6210\n# pvcreate /dev/sdc1\n  Physical volume \"/dev/sdc1\" successfully created\n\n# pvdisplay\n  --- Physical volume ---\n  PV Name               /dev/sdb1\n  VG Name               lvm-test\n  PV Size               20.00 GiB / not usable 3.00 MiB\n  Allocatable           yes (but full)\n  PE Size               4.00 MiB\n  Total PE              5119\n  Free PE               0\n  Allocated PE          5119\n  PV UUID               dVsuOL-GDdS-xVm1-rv6I-HeiK-bH1D-U7z86Z\n\n  --- Physical volume ---\n  PV Name               /dev/sdc1\n  VG Name               lvm-test\n  PV Size               1.00 GiB / not usable 4.00 MiB\n  Allocatable           yes \n  PE Size               4.00 MiB\n  Total PE              255\n  Free PE               255\n  Allocated PE          0\n  PV UUID               MakOcI-ATCw-d23w-YI85-Mbzi-Qk2T-yvpjTO\n\n\n\n\n\u8ad6\u7406\u30dc\u30ea\u30e5\u30fc\u30e0\u30b0\u30eb\u30fc\u30d7\u306b\u8ffd\u52a0\n# vgextend lvm-test /dev/sdc1\n  Volume group \"lvm-test\" successfully extended\n\n# vgdisplay\n  --- Volume group ---\n  VG Name               lvm-test\n  System ID             \n  Format                lvm2\n  Metadata Areas        2\n  Metadata Sequence No  5\n  VG Access             read/write\n  VG Status             resizable\n  MAX LV                0\n  Cur LV                1\n  Open LV               1\n  Max PV                0\n  Cur PV                2\n  Act PV                2\n  VG Size               20.99 GiB\n  PE Size               4.00 MiB\n  Total PE              5374\n  Alloc PE / Size       5119 / 20.00 GiB\n  Free  PE / Size       255 / 1020.00 MiB\n  VG UUID               un2LXy-Jqiv-eea5-ymVf-0vOL-KCH6-6yNuIY\n\n\n\n\u5229\u7528\u53ef\u80fd\u306a\u9818\u57df\u304c\u5897\u3048\u3066\u3044\u308b\u3053\u3068\u304c\u78ba\u8a8d\u3067\u304d\u307e\u3059(Free  PE / Size       255 / 1020.00 MiB)\u3002\n\u306a\u304a\u3001\u4eca\u56de\u306ffdisk \u30b3\u30de\u30f3\u30c9\u3067\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30f3\u3092\u4f5c\u6210\u3059\u308b\u3068\u304d\u306b\u3074\u3063\u305f\u308a1G \u3092\u6307\u5b9a\u3057\u305f\u305f\u3081\u3001\u82e5\u5e72\u306e\u8aa4\u5dee\u306b\u3088\u308a1020MiB \u5206\u306e\u9818\u57df\u306e\u307f\u5229\u7528\u3067\u304d\u307e\u3059\u3002\n\u78ba\u5b9f\u306b1GiB \u306e\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u9818\u57df\u304c\u5fc5\u8981\u306a\u5834\u5408\u306f\u3001\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30f3\u4f5c\u6210\u6642\u306b\u5c11\u3057\u4f59\u88d5\u3092\u3082\u3063\u3066\u78ba\u4fdd\u3059\u308b\u3088\u3046\u306b\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\u65b0\u3057\u304f\u51fa\u6765\u305f\u7a7a\u304d\u9818\u57df\u3092\u4f7f\u7528\u3057\u3066\u3001\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u30dc\u30ea\u30e5\u30fc\u30e0\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\n\u73fe\u5728\u306e\u6b8b\u308a\u9818\u57df\u3059\u3079\u3066\u3092\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u9818\u57df\u3068\u3057\u3066\u5229\u7528\u3059\u308b\n# lvcreate -s -l 100%FREE -n snap /dev/lvm-test/original\n  Logical volume \"snap\" created.\n\n\n\n\u660e\u793a\u7684\u306b1GB\u306e\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u9818\u57df\u3092\u53d6\u5f97\u3059\u308b\u5834\u5408\n# lvcreate -s -L 1G -n snap /dev/lvm-test/original\n\n\n\u3053\u308c\u3067\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u304c\u4f5c\u6210\u3055\u308c\u307e\u3057\u305f\u3002\n\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u306e\u72b6\u614b\u3092\u78ba\u8a8d\u3057\u3066\u307f\u307e\u3059\u3002\n# lvscan\n  ACTIVE   Original '/dev/lvm-test/original' [20.00 GiB] inherit\n  ACTIVE   Snapshot '/dev/lvm-test/snap' [1020.00 MiB] inherit\n\n# lvdisplay /dev/lvm-test/snap\n  --- Logical volume ---\n  LV Path                /dev/lvm-test/snap\n  LV Name                snap\n  VG Name                lvm-test\n  LV UUID                TTD2tT-9DXp-kliH-gocI-rqGo-f5pt-TNge40\n  LV Write Access        read/write\n  LV Creation host, time fedora-lvm01, 2015-03-22 12:25:16 +0900\n  LV snapshot status     active destination for original\n  LV Status              available\n  # open                 0\n  LV Size                20.00 GiB\n  Current LE             5119\n  COW-table size         1020.00 MiB\n  COW-table LE           255\n  Allocated to snapshot  0.00%\n  Snapshot chunk size    4.00 KiB\n  Segments               1\n  Allocation             inherit\n  Read ahead sectors     auto\n  - currently set to     256\n  Block device           253:3\n\n\n\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u30dc\u30ea\u30e5\u30fc\u30e0\u3092\u30de\u30a6\u30f3\u30c8\u3057\u3066\u3001\u5185\u5bb9\u3092\u78ba\u8a8d\u3057\u3066\u307f\u307e\u3059\u3002\n# mount -o ro /dev/lvm-test/snap /mnt/snap\n\n# df /mnt/original /mnt/snap\nFilesystem                     1K-blocks     Used Available Use% Mounted on\n/dev/mapper/lvm--test-original  20507260 10285196   9157312  53% /mnt/original\n/dev/mapper/lvm--test-snap      20507260 10285196   9157312  53% /mnt/snap\n\n# ls -ltr /mnt/original/ | tail\n-rw-r--r--. 1 root root 104857600 Mar 21 19:28 file_0091\n-rw-r--r--. 1 root root 104857600 Mar 21 19:28 file_0092\n-rw-r--r--. 1 root root 104857600 Mar 21 19:28 file_0093\n-rw-r--r--. 1 root root 104857600 Mar 21 19:28 file_0094\n-rw-r--r--. 1 root root 104857600 Mar 21 19:29 file_0095\n-rw-r--r--. 1 root root 104857600 Mar 21 19:29 file_0096\n-rw-r--r--. 1 root root 104857600 Mar 21 19:29 file_0097\n-rw-r--r--. 1 root root 104857600 Mar 21 19:29 file_0098\n-rw-r--r--. 1 root root 104857600 Mar 21 19:29 file_0099\n-rw-r--r--. 1 root root 104857600 Mar 21 19:29 file_0100\n\n# ls -ltr /mnt/snap | tail\n-rw-r--r--. 1 root root 104857600 Mar 21 19:28 file_0091\n-rw-r--r--. 1 root root 104857600 Mar 21 19:28 file_0092\n-rw-r--r--. 1 root root 104857600 Mar 21 19:28 file_0093\n-rw-r--r--. 1 root root 104857600 Mar 21 19:28 file_0094\n-rw-r--r--. 1 root root 104857600 Mar 21 19:29 file_0095\n-rw-r--r--. 1 root root 104857600 Mar 21 19:29 file_0096\n-rw-r--r--. 1 root root 104857600 Mar 21 19:29 file_0097\n-rw-r--r--. 1 root root 104857600 Mar 21 19:29 file_0098\n-rw-r--r--. 1 root root 104857600 Mar 21 19:29 file_0099\n-rw-r--r--. 1 root root 104857600 Mar 21 19:29 file_0100\n\n\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u304c\u3069\u306e\u3088\u3046\u306b\u4f7f\u7528\u3055\u308c\u308b\u304b\u3001original \u8ad6\u7406\u30dc\u30ea\u30e5\u30fc\u30e0\u4e0a\u306b\u30d5\u30a1\u30a4\u30eb\u3092\u66f8\u304d\u8fbc\u3093\u3067\u78ba\u8a8d\u3057\u3066\u307f\u307e\u3059\u3002\n# dd if#/dev/urandom of=/mnt/original/dummy01 bs=1024 count$((1 * 1024 * 100))\n102400+0 records in\n102400+0 records out\n104857600 bytes (105 MB) copied, 5.74177 s, 18.3 MB/s\n\n\u30d5\u30a1\u30a4\u30eb\u3092\u66f8\u304d\u8fbc\u3093\u3060\u3089\u3001\u307e\u305f\u4e21\u65b9\u306e\u30dc\u30ea\u30e5\u30fc\u30e0\u3092\u78ba\u8a8d\u3057\u3066\u307f\u307e\u3059\u3002\n# df /mnt/original /mnt/snap\nFilesystem                     1K-blocks     Used Available Use% Mounted on\n/dev/mapper/lvm--test-original  20507260 10387596   9054912  54% /mnt/original\n/dev/mapper/lvm--test-snap      20507260 10285196   9157312  53% /mnt/snap\n\n# ls -ltr /mnt/original/ | tail\n-rw-r--r--. 1 root root 104857600 Mar 21 19:28 file_0092\n-rw-r--r--. 1 root root 104857600 Mar 21 19:28 file_0093\n-rw-r--r--. 1 root root 104857600 Mar 21 19:28 file_0094\n-rw-r--r--. 1 root root 104857600 Mar 21 19:29 file_0095\n-rw-r--r--. 1 root root 104857600 Mar 21 19:29 file_0096\n-rw-r--r--. 1 root root 104857600 Mar 21 19:29 file_0097\n-rw-r--r--. 1 root root 104857600 Mar 21 19:29 file_0098\n-rw-r--r--. 1 root root 104857600 Mar 21 19:29 file_0099\n-rw-r--r--. 1 root root 104857600 Mar 21 19:29 file_0100\n-rw-r--r--. 1 root root 104857600 Mar 22 12:36 dummy01\n\n# ls -ltr /mnt/snap | tail\n-rw-r--r--. 1 root root 104857600 Mar 21 19:28 file_0091\n-rw-r--r--. 1 root root 104857600 Mar 21 19:28 file_0092\n-rw-r--r--. 1 root root 104857600 Mar 21 19:28 file_0093\n-rw-r--r--. 1 root root 104857600 Mar 21 19:28 file_0094\n-rw-r--r--. 1 root root 104857600 Mar 21 19:29 file_0095\n-rw-r--r--. 1 root root 104857600 Mar 21 19:29 file_0096\n-rw-r--r--. 1 root root 104857600 Mar 21 19:29 file_0097\n-rw-r--r--. 1 root root 104857600 Mar 21 19:29 file_0098\n-rw-r--r--. 1 root root 104857600 Mar 21 19:29 file_0099\n-rw-r--r--. 1 root root 104857600 Mar 21 19:29 file_0100\n\n\u4e0a\u8a18\u306e\u3088\u3046\u306b\u3001original \u5074\u306f\u30d5\u30a1\u30a4\u30eb\u304c\u8ffd\u52a0\u3055\u308c\u3066\u3044\u307e\u3059\u304c\u3001snap \u5074\u306e\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u30dc\u30ea\u30e5\u30fc\u30e0\u306b\u3064\u3044\u3066\u306f\u5909\u5316\u3057\u3066\u3044\u306a\u3044\u3053\u3068\u304c\u308f\u304b\u308a\u307e\u3059\u3002\n\u6b21\u306blvdisplay \u3067\u8ad6\u7406\u30dc\u30ea\u30e5\u30fc\u30e0\u306e\u72b6\u614b\u3092\u78ba\u8a8d\u3057\u3066\u307f\u307e\u3057\u3087\u3046\u3002\n# lvdisplay /dev/lvm-test/snap\n  --- Logical volume ---\n  LV Path                /dev/lvm-test/snap\n  LV Name                snap\n  VG Name                lvm-test\n  LV UUID                TTD2tT-9DXp-kliH-gocI-rqGo-f5pt-TNge40\n  LV Write Access        read/write\n  LV Creation host, time fedora-lvm01, 2015-03-22 12:25:16 +0900\n  LV snapshot status     active destination for original\n  LV Status              available\n  # open                 1\n  LV Size                20.00 GiB\n  Current LE             5119\n  COW-table size         1020.00 MiB\n  COW-table LE           255\n  Allocated to snapshot  9.85%\n  Snapshot chunk size    4.00 KiB\n  Segments               1\n  Allocation             inherit\n  Read ahead sectors     auto\n  - currently set to     256\n  Block device           253:3\n\n\n\u305d\u3046\u3059\u308b\u3068\u3001Allocated to snapshot \u306e\u5024\u304c\u5897\u3048\u3066\u3044\u308b\u3053\u3068\u304c\u308f\u304b\u308a\u307e\u3059\u3002\n\u30dc\u30ea\u30e5\u30fc\u30e0\u306e\u5143\u306e\u72b6\u614b\u3092\u4fdd\u6301\u3059\u308b\u305f\u3081\u306b\u5229\u7528\u3055\u308c\u3066\u3044\u307e\u3059\u3002\n\u6b21\u306b\u3001original \u5074\u306e\u30d5\u30a1\u30a4\u30eb\u3092\u524a\u9664\u3057\u3066\u307f\u307e\u3059\u3002\n# rm /mnt/original/file_0100\n\n# ls -ltr /mnt/original/ | tail\n-rw-r--r--. 1 root root 104857600 Mar 21 19:28 file_0091\n-rw-r--r--. 1 root root 104857600 Mar 21 19:28 file_0092\n-rw-r--r--. 1 root root 104857600 Mar 21 19:28 file_0093\n-rw-r--r--. 1 root root 104857600 Mar 21 19:28 file_0094\n-rw-r--r--. 1 root root 104857600 Mar 21 19:29 file_0095\n-rw-r--r--. 1 root root 104857600 Mar 21 19:29 file_0096\n-rw-r--r--. 1 root root 104857600 Mar 21 19:29 file_0097\n-rw-r--r--. 1 root root 104857600 Mar 21 19:29 file_0098\n-rw-r--r--. 1 root root 104857600 Mar 21 19:29 file_0099\n-rw-r--r--. 1 root root 104857600 Mar 22 12:36 dummy01\n\n# ls -ltr /mnt/snap | tail\n-rw-r--r--. 1 root root 104857600 Mar 21 19:28 file_0091\n-rw-r--r--. 1 root root 104857600 Mar 21 19:28 file_0092\n-rw-r--r--. 1 root root 104857600 Mar 21 19:28 file_0093\n-rw-r--r--. 1 root root 104857600 Mar 21 19:28 file_0094\n-rw-r--r--. 1 root root 104857600 Mar 21 19:29 file_0095\n-rw-r--r--. 1 root root 104857600 Mar 21 19:29 file_0096\n-rw-r--r--. 1 root root 104857600 Mar 21 19:29 file_0097\n-rw-r--r--. 1 root root 104857600 Mar 21 19:29 file_0098\n-rw-r--r--. 1 root root 104857600 Mar 21 19:29 file_0099\n-rw-r--r--. 1 root root 104857600 Mar 21 19:29 file_0100\n\n# lvdisplay /dev/lvm-test/snap\n  --- Logical volume ---\n  LV Path                /dev/lvm-test/snap\n  LV Name                snap\n  VG Name                lvm-test\n  LV UUID                TTD2tT-9DXp-kliH-gocI-rqGo-f5pt-TNge40\n  LV Write Access        read/write\n  LV Creation host, time fedora-lvm01, 2015-03-22 12:25:16 +0900\n  LV snapshot status     active destination for original\n  LV Status              available\n  # open                 1\n  LV Size                20.00 GiB\n  Current LE             5119\n  COW-table size         1020.00 MiB\n  COW-table LE           255\n  Allocated to snapshot  9.86%\n  Snapshot chunk size    4.00 KiB\n  Segments               1\n  Allocation             inherit\n  Read ahead sectors     auto\n  - currently set to     256\n  Block device           253:3\n\n\n\u524a\u9664\u6642\u3082\u3001\u5143\u306e\u72b6\u614b\u3092\u4fdd\u6301\u3059\u308b\u305f\u3081\u306b\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u9818\u57df\u304c\u5229\u7528\u3055\u308c\u3066\u3044\u307e\u3059\u304c\u3001\u524a\u9664\u51e6\u7406\u306b\u3088\u3063\u3066\u30d5\u30a1\u30a4\u30eb\u306e\u30c7\u30fc\u30bf\u90e8\u5206\u3059\u3079\u3066\u304c\u66f8\u304d\u63db\u308f\u308b\u308f\u3051\u3067\u306f\u306a\u3044\u306e\u3067\u3001\u3053\u306e\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\n\n\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u304b\u3089\u5fa9\u5143\u3059\u308b\n\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u304b\u3089\u30aa\u30ea\u30b8\u30ca\u30eb\u30dc\u30ea\u30e5\u30fc\u30e0\u306e\u72b6\u614b\u3092\u30d5\u30a7\u30a4\u30eb\u30d0\u30c3\u30af\u3059\u308b\u306b\u306f\u3001lvconvert \u30b3\u30de\u30f3\u30c9\u3092\u4f7f\u7528\u3057\u307e\u3059\u3002\n\u307e\u305a\u3001\u30aa\u30ea\u30b8\u30ca\u30eb\u30dc\u30ea\u30e5\u30fc\u30e0\u3068\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u30dc\u30ea\u30e5\u30fc\u30e0\u304c\u30de\u30a6\u30f3\u30c8\u3055\u308c\u3066\u3044\u308b\u5834\u5408\u306f\u3001\u30a2\u30f3\u30de\u30a6\u30f3\u30c8\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n# umount /mnt/original \n# umount /mnt/snap\n\nlvconvert \u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3057\u3066\u3001\u30d5\u30a7\u30a4\u30eb\u30d0\u30c3\u30af\u3057\u307e\u3059\u3002\n\u306a\u304a\u3001\u3053\u306e\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3059\u308b\u3053\u3068\u3067/dev/lvm-test/snap \u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u30dc\u30ea\u30e5\u30fc\u30e0\u306f\u524a\u9664\u3055\u308c\u307e\u3059\u3002\n# lvconvert --merge /dev/lvm-test/snap\n  Merging of volume snap started.\n  original: Merged: 90.2%\n  original: Merged: 100.0%\n  Merge of snapshot into logical volume original has finished.\n  Logical volume \"snap\" successfully removed\n\n\u30d5\u30a7\u30a4\u30eb\u30d0\u30c3\u30af\u304c\u5b8c\u4e86\u3057\u305f\u3089\u3001\u30aa\u30ea\u30b8\u30ca\u30eb\u30dc\u30ea\u30e5\u30fc\u30e0\u3092\u78ba\u8a8d\u3057\u3066\u307f\u307e\u3057\u3087\u3046\u3002\n# mount /dev/lvm-test/original /mnt/original\n# ls -ltr /mnt/original/ | tail\n-rw-r--r--. 1 root root 104857600 Mar 21 19:28 file_0091\n-rw-r--r--. 1 root root 104857600 Mar 21 19:28 file_0092\n-rw-r--r--. 1 root root 104857600 Mar 21 19:28 file_0093\n-rw-r--r--. 1 root root 104857600 Mar 21 19:28 file_0094\n-rw-r--r--. 1 root root 104857600 Mar 21 19:29 file_0095\n-rw-r--r--. 1 root root 104857600 Mar 21 19:29 file_0096\n-rw-r--r--. 1 root root 104857600 Mar 21 19:29 file_0097\n-rw-r--r--. 1 root root 104857600 Mar 21 19:29 file_0098\n-rw-r--r--. 1 root root 104857600 Mar 21 19:29 file_0099\n-rw-r--r--. 1 root root 104857600 Mar 21 19:29 file_0100\n\n# lvdisplay\n  --- Logical volume ---\n  LV Path                /dev/lvm-test/original\n  LV Name                original\n  VG Name                lvm-test\n  LV UUID                yCNmOc-iZqq-0CIl-fA1Z-0omo-2boC-60IycV\n  LV Write Access        read/write\n  LV Creation host, time fedora-lvm01, 2015-03-21 19:10:48 +0900\n  LV Status              available\n  # open                 1\n  LV Size                20.00 GiB\n  Current LE             5119\n  Segments               1\n  Allocation             inherit\n  Read ahead sectors     auto\n  - currently set to     256\n  Block device           253:1\n\n\n\u30aa\u30ea\u30b8\u30ca\u30eb\u30dc\u30ea\u30e5\u30fc\u30e0\u304c\u5143\u306e\u72b6\u614b\u306b\u306a\u3063\u3066\u304a\u308a\u3001\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u30dc\u30ea\u30e5\u30fc\u30e0\u3082\u524a\u9664\u3055\u308c\u3066\u3044\u307e\u3059\u3002\n\n\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u304c\u6ea2\u308c\u308b\u30b1\u30fc\u30b9\n\u30aa\u30ea\u30b8\u30ca\u30eb\u30dc\u30ea\u30e5\u30fc\u30e0\u306b\u66f8\u304d\u8fbc\u307f\u304c\u5927\u91cf\u767a\u751f\u3057\u3001\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u304c\u3042\u3075\u308c\u308b\u30b1\u30fc\u30b9\u306b\u3064\u3044\u3066\u898b\u3066\u307f\u307e\u3057\u3087\u3046\u3002\n\u5148\u307b\u3069\u3001\u30aa\u30ea\u30b8\u30ca\u30eb\u30dc\u30ea\u30e5\u30fc\u30e0\u306b100MiB \u306e\u30c0\u30df\u30fc\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u6210\u3057\u305f\u5f8c\u306e\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u9818\u57df\u306e\u4f7f\u7528\u7387\u306f\u7d0410% \u3068\u306a\u3063\u3066\u3044\u307e\u3057\u305f\u3002\n# lvdisplay /dev/lvm-test/snap\n  --- Logical volume ---\n......\n  COW-table size         1020.00 MiB\n  COW-table LE           255\n  Allocated to snapshot  9.86%\n  Snapshot chunk size    4.00 KiB\n......\n\n\n\u3053\u306e\u307e\u307e\u3001\u30aa\u30ea\u30b8\u30ca\u30eb\u30dc\u30ea\u30e5\u30fc\u30e0\u306b\u8ffd\u52a0\u3067100MiB * 10\u7a0b\u5ea6\u306e\u30d5\u30a1\u30a4\u30eb\u3092\u66f8\u304d\u8fbc\u3093\u3067\u307f\u307e\u3059\u3002\n# lvscan\n  ACTIVE   Original '/dev/lvm-test/original' [20.00 GiB] inherit\n  ACTIVE   Snapshot '/dev/lvm-test/snap' [1020.00 MiB] inherit\n\n# for I in {1..10}; do dd if#/dev/urandom of=/mnt/original/overflow_\"$(printf \"%04d\" ${I})\" bs=$((1 * 1024)) count$((1 * 1024 * 100)); done\n\n\u72b6\u614b\u3092\u78ba\u8a8d\u3057\u3066\u307f\u307e\u3059\u3002\n# lvscan\n  ACTIVE   Original '/dev/lvm-test/original' [20.00 GiB] inherit\n  inactive Snapshot '/dev/lvm-test/snap' [1020.00 MiB] inherit\n\n\u5909\u66f4\u72b6\u614b\u3092\u4fdd\u6301\u3057\u304d\u308c\u306a\u304f\u306a\u3063\u305f\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u9818\u57df\u304cinactive \u306b\u306a\u3063\u3066\u3044\u308b\u3053\u3068\u304c\u308f\u304b\u308a\u307e\u3059\u3002\n\u3053\u306e\u72b6\u614b\u3067\u3001\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u304b\u3089\u30aa\u30ea\u30b8\u30ca\u30eb\u30dc\u30ea\u30e5\u30fc\u30e0\u3092\u30d5\u30a7\u30a4\u30eb\u30d0\u30c3\u30af\u3057\u3088\u3046\u3068\u3059\u308b\u3068\u3069\u306e\u3088\u3046\u306b\u306a\u308b\u3067\u3057\u3087\u3046\u304b\u3002\n# umount /mnt/original\n# umount /mnt/snap\numount: /mnt/snap: not mounted\n\n# lvconvert --merge /dev/lvm-test/snap\n  Unable to merge invalidated snapshot LV \"snap\".\n  Unable to merge LV \"snap\" into its origin.\n\n\u4e0a\u8a18\u306e\u3088\u3046\u306b\u3001\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u304b\u3089\u30d5\u30a7\u30a4\u30eb\u30d0\u30c3\u30af\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u306a\u3044\u3088\u3046\u306b\u306a\u3063\u3066\u3044\u308b\u3053\u3068\u304c\u308f\u304b\u308a\u307e\u3059\u3002\n\u3053\u306e\u3088\u3046\u306a\u72b6\u614b\u306b\u306a\u3063\u305f\u3089\u3001\u5143\u306e\u72b6\u614b\u306e\u5fa9\u5143\u306f\u3042\u304d\u3089\u3081\u3066\u304f\u3060\u3055\u3044\u30fb\u30fb\u30fb\u30fb\u30fb\u30fb\u3002\n\u4f7f\u3044\u9053\u306e\u306a\u304f\u306a\u3063\u305f\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u306f\u524a\u9664\u3057\u307e\u3057\u3087\u3046\u3002\n\u4f7f\u3044\u9053\u306e\u306a\u304f\u306a\u3063\u305f\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u3092\u524a\u9664\u3059\u308b\u306b\u306f\u3001lvremove \u30b3\u30de\u30f3\u30c9\u3092\u4f7f\u7528\u3057\u307e\u3059\u3002\n# lvremove /dev/lvm-test/snap\n\n\n\u6b21\u306e\u8a18\u4e8b\nLinux\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u6642\u306bLVM on RAID1 \u306a\u74b0\u5883\u3092\u69cb\u7bc9\u3059\u308b\n# \u524d\u56de\u8a18\u4e8b\n[LVM\u3067RAID1\u306e\u69cb\u7bc9\u3001\u969c\u5bb3\u5bfe\u5fdc\u3001\u4ed6RAID\u30dc\u30ea\u30e5\u30fc\u30e0\u306e\u8ffd\u52a0](http://qiita.com/TsutomuNakamura/items/c9c277049e0032ed6116 \"LVM\u3067RAID1\u306e\u69cb\u7bc9\u3001\u969c\u5bb3\u5bfe\u5fdc\u3001\u4ed6RAID\u30dc\u30ea\u30e5\u30fc\u30e0\u306e\u8ffd\u52a0\")\n\n# \u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u306b\u3064\u3044\u3066 \n\u3053\u3053\u3067\u306f\u3001\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u304c\u3069\u306e\u3088\u3046\u306b\u4fbf\u5229\u306a\u306e\u304b\u3001\u305d\u3057\u3066\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u3092\u3069\u306e\u3088\u3046\u306b\u4f5c\u6210\u3001\u4f7f\u7528\u3059\u308b\u304b\u306b\u3064\u3044\u3066\u8aac\u660e\u3057\u3066\u3044\u304d\u307e\u3059\u3002\n\u3053\u3053\u3067\u306f\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u306e\u30e6\u30fc\u30b9\u30b1\u30fc\u30b9\u3092\u60f3\u5b9a\u3057\u305f\u4f7f\u7528\u65b9\u6cd5\u306b\u3064\u3044\u3066\u8aac\u660e\u3057\u3066\u3044\u304d\u307e\u3059\u3002\n\n<dl>\n  <dt> \u4e00\u8cab\u6027\u306e\u3042\u308b\u72b6\u614b\u306e\u4fdd\u6301</dt>\n  <dd> \u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u53d6\u5f97\u6642\u70b9\u306e\u30c7\u30fc\u30bf\u306e\u72b6\u614b\u3092\u305d\u306e\u307e\u307e\u4fdd\u7ba1\u3059\u308b\u3088\u3046\u306a\u30d0\u30c3\u30af\u30a2\u30c3\u30d7\u306b\u4f7f\u7528\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002</dd>\n  <dd> \u4f8b\u3048\u3070\u6bce\u65e5AM02:00 \u6642\u70b9\u3067DB \u30c7\u30fc\u30bf\u3092\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u3068\u3057\u3066\u53d6\u5f97\u3057\u3066\u304a\u304f\u3053\u3068\u3067\u3001\u305d\u306e\u65e5\u306eAM02:00 \u6642\u70b9\u306e\u30c7\u30fc\u30bf\u3092\u305d\u306e\u307e\u307e\u306e\u72b6\u614b\u3067\u30c7\u30fc\u30bf\u3092\u4fdd\u6301\u3057\u3066\u304a\u304f\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002</dd>\n  <dd> \u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u306f\u30aa\u30ea\u30b8\u30ca\u30eb\u30dc\u30ea\u30e5\u30fc\u30e0\u53c8\u306f\u3001\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u30dc\u30ea\u30e5\u30fc\u30e0\u306e\u3044\u305a\u308c\u304b\u304c\u7834\u640d\u3059\u308b\u3068\u72b6\u614b\u306e\u5fa9\u65e7\u304c\u3067\u304d\u306a\u304f\u306a\u308b\u306e\u3067\u3001\u30d0\u30c3\u30af\u30a2\u30c3\u30d7\u3068\u306f\u547c\u3073\u3065\u3089\u3044(\u500b\u4eba\u7684\u4e3b\u89b3)</dd>\n</dl>\n\n<dl>\n  <dt> \u30d5\u30a7\u30a4\u30eb\u30d0\u30c3\u30af</dt>\n  <dd> \u4f55\u304b\u51e6\u7406\u3092\u884c\u3063\u3066\u5931\u6557\u3057\u305f\u6642\u306b\u30d5\u30a7\u30a4\u30eb\u30d0\u30c3\u30af\u3092\u3059\u308b\u76ee\u7684\u3067\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u3092\u53d6\u5f97\u3057\u3066\u304a\u304f\u3053\u3068\u3082\u3067\u304d\u307e\u3059\u3002</dd>\n  <dd> \u4f8b\u3048\u3070\u3001\u4eca\u307e\u3067\u554f\u984c\u306a\u304f\u52d5\u3044\u3066\u3044\u305f\u306e\u306b\u3001\u30d1\u30c3\u30b1\u30fc\u30b8\u3092\u30a2\u30c3\u30d7\u30b0\u30ec\u30fc\u30c9\u3057\u305f\u9014\u7aef\u306b\u554f\u984c\u304c\u767a\u751f\u3057\u305f\u5834\u5408\u3001\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u3092\u53d6\u5f97\u3057\u3066\u3044\u305f\u6642\u70b9\u306b\u623b\u308b\u3053\u3068\u3067\u3001\u72b6\u614b\u306e\u5207\u308a\u623b\u3057\u3092\u884c\u3046\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002</dd>\n</dl>\n\n\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u306f\u3053\u308c\u3089\u4ee5\u5916\u306b\u3082\u7528\u9014\u306f\u3042\u308a\u307e\u3059\u304c\u3001\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u7528\u306e\u8ad6\u7406\u30dc\u30ea\u30e5\u30fc\u30e0\u3068\u30aa\u30ea\u30b8\u30ca\u30eb\u30dc\u30ea\u30e5\u30fc\u30e0\u3092\u5206\u3051\u3066\u3001\u30c0\u30a6\u30f3\u30bf\u30a4\u30e0\u306a\u3057\u306b\u30d0\u30c3\u30af\u30a2\u30c3\u30d7\u306e\u53d6\u5f97\u3092\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u3001\u4f5c\u696d\u3092\u6b62\u3081\u308b\u5fc5\u8981\u304c\u306a\u304f\u306a\u308a\u307e\u3059\u3002\n\n# \u74b0\u5883 \n\u4eca\u56de\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u306e\u52d5\u4f5c\u78ba\u8a8d\u3092\u884c\u3046\u74b0\u5883\u3068\u3057\u3066\u3001\u6b21\u306e\u3088\u3046\u306a\u74b0\u5883\u3092\u4f7f\u7528\u3057\u3066\u3044\u307e\u3059\u3002\n<dl>\n  <dt> OS</dt>\n  <dd> Fedora21</dd>\n</dl>\n\n<dl>\n  <dt> \u30c7\u30a3\u30b9\u30af</dt>\n  <dd> LVM \u3067OS \u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u6e08\u307f</dd>\n</dl>\n\n<dl>\n  <dt> \u30aa\u30ea\u30b8\u30ca\u30eb\u30c7\u30d0\u30a4\u30b9</dt>\n  <dd> /dev/lv-test/original-volume (\u7d0416GB)</dd>\n</dl>\n\n<dl>\n  <dt> \u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u30c7\u30d0\u30a4\u30b9</dt>\n  <dt> /dev/sdc1 (LVM \u306e\u7d041GB \u306e\u9818\u57df)</dt>\n</dl>\n\n\n```text\n# pvdisplay\n  --- Physical volume ---\n  PV Name               /dev/sdb1\n  VG Name               lvm-test\n  PV Size               20.00 GiB / not usable 3.00 MiB\n  Allocatable           yes (but full)\n  PE Size               4.00 MiB\n  Total PE              5119\n  Free PE               0\n  Allocated PE          5119\n  PV UUID               dVsuOL-GDdS-xVm1-rv6I-HeiK-bH1D-U7z86Z\n   \n# vgdisplay\n  --- Volume group ---\n  VG Name               lvm-test\n  System ID             \n  Format                lvm2\n  Metadata Areas        1\n  Metadata Sequence No  2\n  VG Access             read/write\n  VG Status             resizable\n  MAX LV                0\n  Cur LV                1\n  Open LV               0\n  Max PV                0\n  Cur PV                1\n  Act PV                1\n  VG Size               20.00 GiB\n  PE Size               4.00 MiB\n  Total PE              5119\n  Alloc PE / Size       5119 / 20.00 GiB\n  Free  PE / Size       0 / 0   \n  VG UUID               un2LXy-Jqiv-eea5-ymVf-0vOL-KCH6-6yNuIY\n   \n# lvdisplay\n  --- Logical volume ---\n  LV Path                /dev/lvm-test/original\n  LV Name                original\n  VG Name                lvm-test\n  LV UUID                yCNmOc-iZqq-0CIl-fA1Z-0omo-2boC-60IycV\n  LV Write Access        read/write\n  LV Creation host, time fedora-lvm01, 2015-03-21 19:10:48 +0900\n  LV Status              available\n  # open                 0\n  LV Size                20.00 GiB\n  Current LE             5119\n  Segments               1\n  Allocation             inherit\n  Read ahead sectors     auto\n  - currently set to     256\n  Block device           253:0\n   \n# parted /dev/lvm-test/original 'print'\nModel: Linux device-mapper (linear) (dm)\nDisk /dev/dm-0: 21.5GB\nSector size (logical/physical): 512B/512B\nPartition Table: loop\nDisk Flags: \n\nNumber  Start  End     Size    File system  Flags\n 1      0.00B  21.5GB  21.5GB  ext4\n```\n\n\n\n\u4eca\u56de\u306f`/dev/lvm-test/original` \u8ad6\u7406\u30c7\u30d0\u30a4\u30b9\u306e\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u3092\u3053\u308c\u304b\u3089\u4f5c\u6210\u3059\u308b`/dev/lvm-test/snap` \u4e0a\u306e\u8ad6\u7406\u30c7\u30d0\u30a4\u30b9\u306b\u53d6\u5f97\u3057\u3066\u3044\u304d\u307e\u3059\u3002\n`lvm-test` \u8ad6\u7406\u30dc\u30ea\u30e5\u30fc\u30e0\u30b0\u30eb\u30fc\u30d7\u306f\u7a7a\u304d\u306e\u30a8\u30af\u30b9\u30c6\u30f3\u30c8\u304c\u306a\u3044\u3053\u3068\u304c\u78ba\u8a8d\u3067\u304d\u307e\u3059(Free PE /size    0 / 0)\u3002\n\u305d\u306e\u305f\u3081\u3001\u4eca\u56de\u306f\u7269\u7406\u30c7\u30d0\u30a4\u30b9`/dev/sdc` \u4e0a\u306b\u7269\u7406\u30dc\u30ea\u30e5\u30fc\u30e0\u3092\u4f5c\u6210\u3057\u3001`lvm-test` \u30dc\u30ea\u30e5\u30fc\u30e0\u30b0\u30eb\u30fc\u30d7\u306b\u8ffd\u52a0\u3057\u3001\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u30dc\u30ea\u30e5\u30fc\u30e0\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\u306a\u304a\u3001\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u3092\u53d6\u5f97\u3059\u308b\u5834\u5408\u306f\u3001\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u30dc\u30ea\u30e5\u30fc\u30e0\u306f\u540c\u3058\u30b0\u30eb\u30fc\u30d7\u3067\u306a\u3051\u308c\u3070\u3044\u3051\u307e\u305b\u3093\u3002\n\n\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u3092\u6709\u52b9\u7684\u306b\u4f7f\u3046\u305f\u3081\u306b\u306f\u3001`snapshot merge` \u6a5f\u80fd\u304c\u3042\u308b\u3068\u3001\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u304b\u3089\u30d5\u30a7\u30a4\u30eb\u30d0\u30c3\u30af\u3059\u308b\u3068\u304d\u306b\u975e\u5e38\u306b\u4fbf\u5229\u3067\u3059\u3002\n\u78ba\u8a8d\u3059\u308b\u306b\u306f\u3001`dmsetup targets` \u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3057\u307e\u3059\u3002\n\n```text\n# dmsetup targets\nzero             v1.1.0\nmirror           v1.13.2\nsnapshot-merge   v1.2.0\nsnapshot-origin  v1.8.1\nsnapshot         v1.12.0\nstriped          v1.5.1\nlinear           v1.2.1\nerror            v1.2.0\n```\n\n\n# \u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u30dc\u30ea\u30e5\u30fc\u30e0\u306e\u4f5c\u6210 \n\u307e\u305a\u3001\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u306e\u53d6\u5f97\u5143\u3068\u306a\u308b`/dev/lvm-test/original` \u3092\u30de\u30a6\u30f3\u30c8\u3057\u307e\u3059\u3002\n\n```text\n# mkdir /mnt/{original,snap}\n# mount /dev/lvm-test/original /mnt/original\n# df -h \nFilesystem                      Size  Used Avail Use% Mounted on\n/dev/sda3                        35G  1.5G   32G   5% /\ndevtmpfs                        2.0G     0  2.0G   0% /dev\ntmpfs                           2.0G     0  2.0G   0% /dev/shm\ntmpfs                           2.0G  532K  2.0G   1% /run\ntmpfs                           2.0G     0  2.0G   0% /sys/fs/cgroup\ntmpfs                           2.0G  4.0K  2.0G   1% /tmp\n/dev/sda1                       477M  113M  335M  26% /boot\ntmpfs                           394M     0  394M   0% /run/user/1000\n/dev/mapper/lvm--test-original   20G   44M   19G   1% /mnt/original\n```\n\n\n\u4eca\u56de\u306f`/dev/sdc` \u7269\u7406\u30c7\u30d0\u30a4\u30b9\u4e0a\u306b`/dev/lvm-test/snap` \u8ad6\u7406\u30dc\u30ea\u30e5\u30fc\u30e0\u3092\u4f5c\u6210\u3057\u3001`/dev/lvm-test/original` \u8ad6\u7406\u30dc\u30ea\u30e5\u30fc\u30e0\u306e\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u9818\u57df\u3092\u4f5c\u6210\u3057\u3066\u3044\u304d\u307e\u3059\u3002\n\u3042\u3068\u3067\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u306e\u52d5\u304d\u3092\u78ba\u8a8d\u3057\u3084\u3059\u3044\u3088\u3046\u306b\u4e8b\u524d\u306b\u6b21\u306e\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3057\u3066\u3001100MiB \u306e\u30c6\u30b9\u30c8\u7528\u306e\u30d5\u30a1\u30a4\u30eb\u3092\u3044\u304f\u3064\u304b\u4f5c\u6210\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n\n```text\n# mkdir /opt/lvm-test\n# for I in {1..100}; do echo \"dd if#/dev/urandom of=/mnt/original/file_\"$(printf \"%04d\" ${I})\" bs=$((1 * 1024)) count$((1 * 1024 * 100))\"; done | xargs -I{} -P 2 bash -c {}\n.......\n# ls -ltr /mnt/original | tail\n-rw-r--r--. 1 root root 104857600 Mar 21 19:28 file_0091\n-rw-r--r--. 1 root root 104857600 Mar 21 19:28 file_0092\n-rw-r--r--. 1 root root 104857600 Mar 21 19:28 file_0093\n-rw-r--r--. 1 root root 104857600 Mar 21 19:28 file_0094\n-rw-r--r--. 1 root root 104857600 Mar 21 19:29 file_0095\n-rw-r--r--. 1 root root 104857600 Mar 21 19:29 file_0096\n-rw-r--r--. 1 root root 104857600 Mar 21 19:29 file_0097\n-rw-r--r--. 1 root root 104857600 Mar 21 19:29 file_0098\n-rw-r--r--. 1 root root 104857600 Mar 21 19:29 file_0099\n-rw-r--r--. 1 root root 104857600 Mar 21 19:29 file_0100\n```\n\n\n\u4eca\u56de\u3001\u30aa\u30ea\u30b8\u30ca\u30eb\u306e\u8ad6\u7406\u30dc\u30ea\u30e5\u30fc\u30e0\u306e\u5168\u4f53\u30b5\u30a4\u30ba\u306f20GB \u3042\u308a\u307e\u3059\u304c\u3001\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u30dc\u30ea\u30e5\u30fc\u30e0\u306f\u305d\u308c\u3068\u540c\u3058\u30b5\u30a4\u30ba\u3092\u4f5c\u6210\u3059\u308b\u5fc5\u8981\u306f\u3042\u308a\u307e\u305b\u3093\u3002\n\u30aa\u30ea\u30b8\u30ca\u30eb\u306e\u30dc\u30ea\u30e5\u30fc\u30e0\u5185\u306e\u30c7\u30fc\u30bf\u306e\u5909\u66f4\u91cf\u306b\u3088\u3063\u3066\u3001\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u30dc\u30ea\u30e5\u30fc\u30e0\u306e\u5fc5\u8981\u306a\u5bb9\u91cf\u306f\u5909\u308f\u3063\u3066\u304f\u308b\u306e\u3067\u3001\u5b8c\u5168\u306a\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u30dc\u30ea\u30e5\u30fc\u30e0\u306b\u5fc5\u8981\u306a\u5bb9\u91cf\u3092\u898b\u7a4d\u3082\u308b\u3053\u3068\u306f\u3053\u3053\u3067\u306f\u3067\u304d\u307e\u305b\u3093\u3002\n\u3068\u308a\u3042\u3048\u305a\u30011GB \u306e\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u3092\u4f5c\u6210\u3057\u3066\u3044\u304d\u307e\u3059\u3002\n\n```text:/dev/sdc\u306b\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30f3\u3092\u4f5c\u6210\u3059\u308b\n# fdisk /dev/sdc\n\nWelcome to fdisk (util-linux 2.25.2).\nChanges will remain in memory only, until you decide to write them.\nBe careful before using the write command.\n\n\nCommand (m for help): n\nPartition type\n   p   primary (0 primary, 0 extended, 4 free)\n   e   extended (container for logical partitions)\nSelect (default p): \n\nUsing default response p.\nPartition number (1-4, default 1): \nFirst sector (2048-41943039, default 2048): \nLast sector, +sectors or +size{K,M,G,T,P} (2048-41943039, default 41943039): +1G\n\nCreated a new partition 1 of type 'Linux' and of size 1 GiB.\n\nCommand (m for help): t\nSelected partition 1\nHex code (type L to list all codes): L\n\n 0  Empty           24  NEC DOS         81  Minix / old Lin bf  Solaris        \n 1  FAT12           27  Hidden NTFS Win 82  Linux swap / So c1  DRDOS/sec (FAT-\n 2  XENIX root      39  Plan 9          83  Linux           c4  DRDOS/sec (FAT-\n 3  XENIX usr       3c  PartitionMagic  84  OS/2 hidden C:  c6  DRDOS/sec (FAT-\n 4  FAT16 <32M      40  Venix 80286     85  Linux extended  c7  Syrinx         \n 5  Extended        41  PPC PReP Boot   86  NTFS volume set da  Non-FS data    \n 6  FAT16           42  SFS             87  NTFS volume set db  CP/M / CTOS / .\n 7  HPFS/NTFS/exFAT 4d  QNX4.x          88  Linux plaintext de  Dell Utility   \n 8  AIX             4e  QNX4.x 2nd part 8e  Linux LVM       df  BootIt         \n 9  AIX bootable    4f  QNX4.x 3rd part 93  Amoeba          e1  DOS access     \n a  OS/2 Boot Manag 50  OnTrack DM      94  Amoeba BBT      e3  DOS R/O        \n b  W95 FAT32       51  OnTrack DM6 Aux 9f  BSD/OS          e4  SpeedStor      \n c  W95 FAT32 (LBA) 52  CP/M            a0  IBM Thinkpad hi eb  BeOS fs        \n e  W95 FAT16 (LBA) 53  OnTrack DM6 Aux a5  FreeBSD         ee  GPT            \n f  W95 Ext'd (LBA) 54  OnTrackDM6      a6  OpenBSD         ef  EFI (FAT-12/16/\n10  OPUS            55  EZ-Drive        a7  NeXTSTEP        f0  Linux/PA-RISC b\n11  Hidden FAT12    56  Golden Bow      a8  Darwin UFS      f1  SpeedStor      \n12  Compaq diagnost 5c  Priam Edisk     a9  NetBSD          f4  SpeedStor      \n14  Hidden FAT16 <3 61  SpeedStor       ab  Darwin boot     f2  DOS secondary  \n16  Hidden FAT16    63  GNU HURD or Sys af  HFS / HFS+      fb  VMware VMFS    \n17  Hidden HPFS/NTF 64  Novell Netware  b7  BSDI fs         fc  VMware VMKCORE \n18  AST SmartSleep  65  Novell Netware  b8  BSDI swap       fd  Linux raid auto\n1b  Hidden W95 FAT3 70  DiskSecure Mult bb  Boot Wizard hid fe  LANstep        \n1c  Hidden W95 FAT3 75  PC/IX           be  Solaris boot    ff  BBT            \n1e  Hidden W95 FAT1 80  Old Minix      \nHex code (type L to list all codes): 8e\nChanged type of partition 'Linux' to 'Linux LVM'.\n\nCommand (m for help): w\nThe partition table has been altered.\nCalling ioctl() to re-read partition table.\nSyncing disks.\n```\n\n\n\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u7528\u306e\u7269\u7406\u30dc\u30ea\u30e5\u30fc\u30e0\u3001\u8ad6\u7406\u30dc\u30ea\u30e5\u30fc\u30e0\u30b0\u30eb\u30fc\u30d7\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\n```text:\u7269\u7406\u30dc\u30ea\u30e5\u30fc\u30e0\u306e\u4f5c\u6210\n# pvcreate /dev/sdc1\n  Physical volume \"/dev/sdc1\" successfully created\n\n# pvdisplay\n  --- Physical volume ---\n  PV Name               /dev/sdb1\n  VG Name               lvm-test\n  PV Size               20.00 GiB / not usable 3.00 MiB\n  Allocatable           yes (but full)\n  PE Size               4.00 MiB\n  Total PE              5119\n  Free PE               0\n  Allocated PE          5119\n  PV UUID               dVsuOL-GDdS-xVm1-rv6I-HeiK-bH1D-U7z86Z\n   \n  --- Physical volume ---\n  PV Name               /dev/sdc1\n  VG Name               lvm-test\n  PV Size               1.00 GiB / not usable 4.00 MiB\n  Allocatable           yes \n  PE Size               4.00 MiB\n  Total PE              255\n  Free PE               255\n  Allocated PE          0\n  PV UUID               MakOcI-ATCw-d23w-YI85-Mbzi-Qk2T-yvpjTO\n   \n```\n\n\n\n```text:\u8ad6\u7406\u30dc\u30ea\u30e5\u30fc\u30e0\u30b0\u30eb\u30fc\u30d7\u306b\u8ffd\u52a0\n# vgextend lvm-test /dev/sdc1\n  Volume group \"lvm-test\" successfully extended\n\n# vgdisplay\n  --- Volume group ---\n  VG Name               lvm-test\n  System ID             \n  Format                lvm2\n  Metadata Areas        2\n  Metadata Sequence No  5\n  VG Access             read/write\n  VG Status             resizable\n  MAX LV                0\n  Cur LV                1\n  Open LV               1\n  Max PV                0\n  Cur PV                2\n  Act PV                2\n  VG Size               20.99 GiB\n  PE Size               4.00 MiB\n  Total PE              5374\n  Alloc PE / Size       5119 / 20.00 GiB\n  Free  PE / Size       255 / 1020.00 MiB\n  VG UUID               un2LXy-Jqiv-eea5-ymVf-0vOL-KCH6-6yNuIY\n   \n```\n\n\n\u5229\u7528\u53ef\u80fd\u306a\u9818\u57df\u304c\u5897\u3048\u3066\u3044\u308b\u3053\u3068\u304c\u78ba\u8a8d\u3067\u304d\u307e\u3059(Free  PE / Size       255 / 1020.00 MiB)\u3002\n\u306a\u304a\u3001\u4eca\u56de\u306ffdisk \u30b3\u30de\u30f3\u30c9\u3067\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30f3\u3092\u4f5c\u6210\u3059\u308b\u3068\u304d\u306b\u3074\u3063\u305f\u308a1G \u3092\u6307\u5b9a\u3057\u305f\u305f\u3081\u3001\u82e5\u5e72\u306e\u8aa4\u5dee\u306b\u3088\u308a1020MiB \u5206\u306e\u9818\u57df\u306e\u307f\u5229\u7528\u3067\u304d\u307e\u3059\u3002\n\u78ba\u5b9f\u306b1GiB \u306e\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u9818\u57df\u304c\u5fc5\u8981\u306a\u5834\u5408\u306f\u3001\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30f3\u4f5c\u6210\u6642\u306b\u5c11\u3057\u4f59\u88d5\u3092\u3082\u3063\u3066\u78ba\u4fdd\u3059\u308b\u3088\u3046\u306b\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n\u65b0\u3057\u304f\u51fa\u6765\u305f\u7a7a\u304d\u9818\u57df\u3092\u4f7f\u7528\u3057\u3066\u3001\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u30dc\u30ea\u30e5\u30fc\u30e0\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\n```text:\u73fe\u5728\u306e\u6b8b\u308a\u9818\u57df\u3059\u3079\u3066\u3092\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u9818\u57df\u3068\u3057\u3066\u5229\u7528\u3059\u308b\n# lvcreate -s -l 100%FREE -n snap /dev/lvm-test/original\n  Logical volume \"snap\" created.\n```\n\n\n\n```text:\u660e\u793a\u7684\u306b1GB\u306e\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u9818\u57df\u3092\u53d6\u5f97\u3059\u308b\u5834\u5408\n# lvcreate -s -L 1G -n snap /dev/lvm-test/original\n```\n\n\n\u3053\u308c\u3067\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u304c\u4f5c\u6210\u3055\u308c\u307e\u3057\u305f\u3002\n\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u306e\u72b6\u614b\u3092\u78ba\u8a8d\u3057\u3066\u307f\u307e\u3059\u3002\n\n\n```text\n# lvscan\n  ACTIVE   Original '/dev/lvm-test/original' [20.00 GiB] inherit\n  ACTIVE   Snapshot '/dev/lvm-test/snap' [1020.00 MiB] inherit\n\n# lvdisplay /dev/lvm-test/snap\n  --- Logical volume ---\n  LV Path                /dev/lvm-test/snap\n  LV Name                snap\n  VG Name                lvm-test\n  LV UUID                TTD2tT-9DXp-kliH-gocI-rqGo-f5pt-TNge40\n  LV Write Access        read/write\n  LV Creation host, time fedora-lvm01, 2015-03-22 12:25:16 +0900\n  LV snapshot status     active destination for original\n  LV Status              available\n  # open                 0\n  LV Size                20.00 GiB\n  Current LE             5119\n  COW-table size         1020.00 MiB\n  COW-table LE           255\n  Allocated to snapshot  0.00%\n  Snapshot chunk size    4.00 KiB\n  Segments               1\n  Allocation             inherit\n  Read ahead sectors     auto\n  - currently set to     256\n  Block device           253:3\n   \n```\n\n\n\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u30dc\u30ea\u30e5\u30fc\u30e0\u3092\u30de\u30a6\u30f3\u30c8\u3057\u3066\u3001\u5185\u5bb9\u3092\u78ba\u8a8d\u3057\u3066\u307f\u307e\u3059\u3002\n\n```text\n# mount -o ro /dev/lvm-test/snap /mnt/snap\n\n# df /mnt/original /mnt/snap\nFilesystem                     1K-blocks     Used Available Use% Mounted on\n/dev/mapper/lvm--test-original  20507260 10285196   9157312  53% /mnt/original\n/dev/mapper/lvm--test-snap      20507260 10285196   9157312  53% /mnt/snap\n\n# ls -ltr /mnt/original/ | tail\n-rw-r--r--. 1 root root 104857600 Mar 21 19:28 file_0091\n-rw-r--r--. 1 root root 104857600 Mar 21 19:28 file_0092\n-rw-r--r--. 1 root root 104857600 Mar 21 19:28 file_0093\n-rw-r--r--. 1 root root 104857600 Mar 21 19:28 file_0094\n-rw-r--r--. 1 root root 104857600 Mar 21 19:29 file_0095\n-rw-r--r--. 1 root root 104857600 Mar 21 19:29 file_0096\n-rw-r--r--. 1 root root 104857600 Mar 21 19:29 file_0097\n-rw-r--r--. 1 root root 104857600 Mar 21 19:29 file_0098\n-rw-r--r--. 1 root root 104857600 Mar 21 19:29 file_0099\n-rw-r--r--. 1 root root 104857600 Mar 21 19:29 file_0100\n\n# ls -ltr /mnt/snap | tail\n-rw-r--r--. 1 root root 104857600 Mar 21 19:28 file_0091\n-rw-r--r--. 1 root root 104857600 Mar 21 19:28 file_0092\n-rw-r--r--. 1 root root 104857600 Mar 21 19:28 file_0093\n-rw-r--r--. 1 root root 104857600 Mar 21 19:28 file_0094\n-rw-r--r--. 1 root root 104857600 Mar 21 19:29 file_0095\n-rw-r--r--. 1 root root 104857600 Mar 21 19:29 file_0096\n-rw-r--r--. 1 root root 104857600 Mar 21 19:29 file_0097\n-rw-r--r--. 1 root root 104857600 Mar 21 19:29 file_0098\n-rw-r--r--. 1 root root 104857600 Mar 21 19:29 file_0099\n-rw-r--r--. 1 root root 104857600 Mar 21 19:29 file_0100\n```\n\n\n\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u304c\u3069\u306e\u3088\u3046\u306b\u4f7f\u7528\u3055\u308c\u308b\u304b\u3001original \u8ad6\u7406\u30dc\u30ea\u30e5\u30fc\u30e0\u4e0a\u306b\u30d5\u30a1\u30a4\u30eb\u3092\u66f8\u304d\u8fbc\u3093\u3067\u78ba\u8a8d\u3057\u3066\u307f\u307e\u3059\u3002\n\n```text\n# dd if#/dev/urandom of=/mnt/original/dummy01 bs=1024 count$((1 * 1024 * 100))\n102400+0 records in\n102400+0 records out\n104857600 bytes (105 MB) copied, 5.74177 s, 18.3 MB/s\n```\n\n\n\u30d5\u30a1\u30a4\u30eb\u3092\u66f8\u304d\u8fbc\u3093\u3060\u3089\u3001\u307e\u305f\u4e21\u65b9\u306e\u30dc\u30ea\u30e5\u30fc\u30e0\u3092\u78ba\u8a8d\u3057\u3066\u307f\u307e\u3059\u3002\n\n```text\n# df /mnt/original /mnt/snap\nFilesystem                     1K-blocks     Used Available Use% Mounted on\n/dev/mapper/lvm--test-original  20507260 10387596   9054912  54% /mnt/original\n/dev/mapper/lvm--test-snap      20507260 10285196   9157312  53% /mnt/snap\n\n# ls -ltr /mnt/original/ | tail\n-rw-r--r--. 1 root root 104857600 Mar 21 19:28 file_0092\n-rw-r--r--. 1 root root 104857600 Mar 21 19:28 file_0093\n-rw-r--r--. 1 root root 104857600 Mar 21 19:28 file_0094\n-rw-r--r--. 1 root root 104857600 Mar 21 19:29 file_0095\n-rw-r--r--. 1 root root 104857600 Mar 21 19:29 file_0096\n-rw-r--r--. 1 root root 104857600 Mar 21 19:29 file_0097\n-rw-r--r--. 1 root root 104857600 Mar 21 19:29 file_0098\n-rw-r--r--. 1 root root 104857600 Mar 21 19:29 file_0099\n-rw-r--r--. 1 root root 104857600 Mar 21 19:29 file_0100\n-rw-r--r--. 1 root root 104857600 Mar 22 12:36 dummy01\n\n# ls -ltr /mnt/snap | tail\n-rw-r--r--. 1 root root 104857600 Mar 21 19:28 file_0091\n-rw-r--r--. 1 root root 104857600 Mar 21 19:28 file_0092\n-rw-r--r--. 1 root root 104857600 Mar 21 19:28 file_0093\n-rw-r--r--. 1 root root 104857600 Mar 21 19:28 file_0094\n-rw-r--r--. 1 root root 104857600 Mar 21 19:29 file_0095\n-rw-r--r--. 1 root root 104857600 Mar 21 19:29 file_0096\n-rw-r--r--. 1 root root 104857600 Mar 21 19:29 file_0097\n-rw-r--r--. 1 root root 104857600 Mar 21 19:29 file_0098\n-rw-r--r--. 1 root root 104857600 Mar 21 19:29 file_0099\n-rw-r--r--. 1 root root 104857600 Mar 21 19:29 file_0100\n```\n\n\n\u4e0a\u8a18\u306e\u3088\u3046\u306b\u3001original \u5074\u306f\u30d5\u30a1\u30a4\u30eb\u304c\u8ffd\u52a0\u3055\u308c\u3066\u3044\u307e\u3059\u304c\u3001snap \u5074\u306e\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u30dc\u30ea\u30e5\u30fc\u30e0\u306b\u3064\u3044\u3066\u306f\u5909\u5316\u3057\u3066\u3044\u306a\u3044\u3053\u3068\u304c\u308f\u304b\u308a\u307e\u3059\u3002\n\u6b21\u306blvdisplay \u3067\u8ad6\u7406\u30dc\u30ea\u30e5\u30fc\u30e0\u306e\u72b6\u614b\u3092\u78ba\u8a8d\u3057\u3066\u307f\u307e\u3057\u3087\u3046\u3002\n\n```text\n# lvdisplay /dev/lvm-test/snap\n  --- Logical volume ---\n  LV Path                /dev/lvm-test/snap\n  LV Name                snap\n  VG Name                lvm-test\n  LV UUID                TTD2tT-9DXp-kliH-gocI-rqGo-f5pt-TNge40\n  LV Write Access        read/write\n  LV Creation host, time fedora-lvm01, 2015-03-22 12:25:16 +0900\n  LV snapshot status     active destination for original\n  LV Status              available\n  # open                 1\n  LV Size                20.00 GiB\n  Current LE             5119\n  COW-table size         1020.00 MiB\n  COW-table LE           255\n  Allocated to snapshot  9.85%\n  Snapshot chunk size    4.00 KiB\n  Segments               1\n  Allocation             inherit\n  Read ahead sectors     auto\n  - currently set to     256\n  Block device           253:3\n   \n```\n\n\n\u305d\u3046\u3059\u308b\u3068\u3001`Allocated to snapshot` \u306e\u5024\u304c\u5897\u3048\u3066\u3044\u308b\u3053\u3068\u304c\u308f\u304b\u308a\u307e\u3059\u3002\n\u30dc\u30ea\u30e5\u30fc\u30e0\u306e\u5143\u306e\u72b6\u614b\u3092\u4fdd\u6301\u3059\u308b\u305f\u3081\u306b\u5229\u7528\u3055\u308c\u3066\u3044\u307e\u3059\u3002\n\u6b21\u306b\u3001original \u5074\u306e\u30d5\u30a1\u30a4\u30eb\u3092\u524a\u9664\u3057\u3066\u307f\u307e\u3059\u3002\n\n\n```text\n# rm /mnt/original/file_0100\n\n# ls -ltr /mnt/original/ | tail\n-rw-r--r--. 1 root root 104857600 Mar 21 19:28 file_0091\n-rw-r--r--. 1 root root 104857600 Mar 21 19:28 file_0092\n-rw-r--r--. 1 root root 104857600 Mar 21 19:28 file_0093\n-rw-r--r--. 1 root root 104857600 Mar 21 19:28 file_0094\n-rw-r--r--. 1 root root 104857600 Mar 21 19:29 file_0095\n-rw-r--r--. 1 root root 104857600 Mar 21 19:29 file_0096\n-rw-r--r--. 1 root root 104857600 Mar 21 19:29 file_0097\n-rw-r--r--. 1 root root 104857600 Mar 21 19:29 file_0098\n-rw-r--r--. 1 root root 104857600 Mar 21 19:29 file_0099\n-rw-r--r--. 1 root root 104857600 Mar 22 12:36 dummy01\n\n# ls -ltr /mnt/snap | tail\n-rw-r--r--. 1 root root 104857600 Mar 21 19:28 file_0091\n-rw-r--r--. 1 root root 104857600 Mar 21 19:28 file_0092\n-rw-r--r--. 1 root root 104857600 Mar 21 19:28 file_0093\n-rw-r--r--. 1 root root 104857600 Mar 21 19:28 file_0094\n-rw-r--r--. 1 root root 104857600 Mar 21 19:29 file_0095\n-rw-r--r--. 1 root root 104857600 Mar 21 19:29 file_0096\n-rw-r--r--. 1 root root 104857600 Mar 21 19:29 file_0097\n-rw-r--r--. 1 root root 104857600 Mar 21 19:29 file_0098\n-rw-r--r--. 1 root root 104857600 Mar 21 19:29 file_0099\n-rw-r--r--. 1 root root 104857600 Mar 21 19:29 file_0100\n\n# lvdisplay /dev/lvm-test/snap\n  --- Logical volume ---\n  LV Path                /dev/lvm-test/snap\n  LV Name                snap\n  VG Name                lvm-test\n  LV UUID                TTD2tT-9DXp-kliH-gocI-rqGo-f5pt-TNge40\n  LV Write Access        read/write\n  LV Creation host, time fedora-lvm01, 2015-03-22 12:25:16 +0900\n  LV snapshot status     active destination for original\n  LV Status              available\n  # open                 1\n  LV Size                20.00 GiB\n  Current LE             5119\n  COW-table size         1020.00 MiB\n  COW-table LE           255\n  Allocated to snapshot  9.86%\n  Snapshot chunk size    4.00 KiB\n  Segments               1\n  Allocation             inherit\n  Read ahead sectors     auto\n  - currently set to     256\n  Block device           253:3\n   \n```\n\n\n\u524a\u9664\u6642\u3082\u3001\u5143\u306e\u72b6\u614b\u3092\u4fdd\u6301\u3059\u308b\u305f\u3081\u306b\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u9818\u57df\u304c\u5229\u7528\u3055\u308c\u3066\u3044\u307e\u3059\u304c\u3001\u524a\u9664\u51e6\u7406\u306b\u3088\u3063\u3066\u30d5\u30a1\u30a4\u30eb\u306e\u30c7\u30fc\u30bf\u90e8\u5206\u3059\u3079\u3066\u304c\u66f8\u304d\u63db\u308f\u308b\u308f\u3051\u3067\u306f\u306a\u3044\u306e\u3067\u3001\u3053\u306e\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\n\n# \u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u304b\u3089\u5fa9\u5143\u3059\u308b \n\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u304b\u3089\u30aa\u30ea\u30b8\u30ca\u30eb\u30dc\u30ea\u30e5\u30fc\u30e0\u306e\u72b6\u614b\u3092\u30d5\u30a7\u30a4\u30eb\u30d0\u30c3\u30af\u3059\u308b\u306b\u306f\u3001`lvconvert` \u30b3\u30de\u30f3\u30c9\u3092\u4f7f\u7528\u3057\u307e\u3059\u3002\n\u307e\u305a\u3001\u30aa\u30ea\u30b8\u30ca\u30eb\u30dc\u30ea\u30e5\u30fc\u30e0\u3068\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u30dc\u30ea\u30e5\u30fc\u30e0\u304c\u30de\u30a6\u30f3\u30c8\u3055\u308c\u3066\u3044\u308b\u5834\u5408\u306f\u3001\u30a2\u30f3\u30de\u30a6\u30f3\u30c8\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n\n\n```text\n# umount /mnt/original \n# umount /mnt/snap\n```\n\n\n`lvconvert` \u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3057\u3066\u3001\u30d5\u30a7\u30a4\u30eb\u30d0\u30c3\u30af\u3057\u307e\u3059\u3002\n\u306a\u304a\u3001\u3053\u306e\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3059\u308b\u3053\u3068\u3067`/dev/lvm-test/snap` \u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u30dc\u30ea\u30e5\u30fc\u30e0\u306f\u524a\u9664\u3055\u308c\u307e\u3059\u3002\n\n```text\n# lvconvert --merge /dev/lvm-test/snap\n  Merging of volume snap started.\n  original: Merged: 90.2%\n  original: Merged: 100.0%\n  Merge of snapshot into logical volume original has finished.\n  Logical volume \"snap\" successfully removed\n```\n\n\n\u30d5\u30a7\u30a4\u30eb\u30d0\u30c3\u30af\u304c\u5b8c\u4e86\u3057\u305f\u3089\u3001\u30aa\u30ea\u30b8\u30ca\u30eb\u30dc\u30ea\u30e5\u30fc\u30e0\u3092\u78ba\u8a8d\u3057\u3066\u307f\u307e\u3057\u3087\u3046\u3002\n\n```text\n# mount /dev/lvm-test/original /mnt/original\n# ls -ltr /mnt/original/ | tail\n-rw-r--r--. 1 root root 104857600 Mar 21 19:28 file_0091\n-rw-r--r--. 1 root root 104857600 Mar 21 19:28 file_0092\n-rw-r--r--. 1 root root 104857600 Mar 21 19:28 file_0093\n-rw-r--r--. 1 root root 104857600 Mar 21 19:28 file_0094\n-rw-r--r--. 1 root root 104857600 Mar 21 19:29 file_0095\n-rw-r--r--. 1 root root 104857600 Mar 21 19:29 file_0096\n-rw-r--r--. 1 root root 104857600 Mar 21 19:29 file_0097\n-rw-r--r--. 1 root root 104857600 Mar 21 19:29 file_0098\n-rw-r--r--. 1 root root 104857600 Mar 21 19:29 file_0099\n-rw-r--r--. 1 root root 104857600 Mar 21 19:29 file_0100\n\n# lvdisplay\n  --- Logical volume ---\n  LV Path                /dev/lvm-test/original\n  LV Name                original\n  VG Name                lvm-test\n  LV UUID                yCNmOc-iZqq-0CIl-fA1Z-0omo-2boC-60IycV\n  LV Write Access        read/write\n  LV Creation host, time fedora-lvm01, 2015-03-21 19:10:48 +0900\n  LV Status              available\n  # open                 1\n  LV Size                20.00 GiB\n  Current LE             5119\n  Segments               1\n  Allocation             inherit\n  Read ahead sectors     auto\n  - currently set to     256\n  Block device           253:1\n   \n```\n\n\n\u30aa\u30ea\u30b8\u30ca\u30eb\u30dc\u30ea\u30e5\u30fc\u30e0\u304c\u5143\u306e\u72b6\u614b\u306b\u306a\u3063\u3066\u304a\u308a\u3001\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u30dc\u30ea\u30e5\u30fc\u30e0\u3082\u524a\u9664\u3055\u308c\u3066\u3044\u307e\u3059\u3002\n\n# \u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u304c\u6ea2\u308c\u308b\u30b1\u30fc\u30b9 \n\u30aa\u30ea\u30b8\u30ca\u30eb\u30dc\u30ea\u30e5\u30fc\u30e0\u306b\u66f8\u304d\u8fbc\u307f\u304c\u5927\u91cf\u767a\u751f\u3057\u3001\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u304c\u3042\u3075\u308c\u308b\u30b1\u30fc\u30b9\u306b\u3064\u3044\u3066\u898b\u3066\u307f\u307e\u3057\u3087\u3046\u3002\n\u5148\u307b\u3069\u3001\u30aa\u30ea\u30b8\u30ca\u30eb\u30dc\u30ea\u30e5\u30fc\u30e0\u306b100MiB \u306e\u30c0\u30df\u30fc\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u6210\u3057\u305f\u5f8c\u306e\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u9818\u57df\u306e\u4f7f\u7528\u7387\u306f\u7d0410% \u3068\u306a\u3063\u3066\u3044\u307e\u3057\u305f\u3002\n\n```text\n# lvdisplay /dev/lvm-test/snap\n  --- Logical volume ---\n......\n  COW-table size         1020.00 MiB\n  COW-table LE           255\n  Allocated to snapshot  9.86%\n  Snapshot chunk size    4.00 KiB\n......\n   \n```\n\n\n\u3053\u306e\u307e\u307e\u3001\u30aa\u30ea\u30b8\u30ca\u30eb\u30dc\u30ea\u30e5\u30fc\u30e0\u306b\u8ffd\u52a0\u3067`100MiB * 10 `\u7a0b\u5ea6\u306e\u30d5\u30a1\u30a4\u30eb\u3092\u66f8\u304d\u8fbc\u3093\u3067\u307f\u307e\u3059\u3002\n\n```text\n# lvscan\n  ACTIVE   Original '/dev/lvm-test/original' [20.00 GiB] inherit\n  ACTIVE   Snapshot '/dev/lvm-test/snap' [1020.00 MiB] inherit\n\n# for I in {1..10}; do dd if#/dev/urandom of=/mnt/original/overflow_\"$(printf \"%04d\" ${I})\" bs=$((1 * 1024)) count$((1 * 1024 * 100)); done\n```\n\n\n\u72b6\u614b\u3092\u78ba\u8a8d\u3057\u3066\u307f\u307e\u3059\u3002\n\n```text\n# lvscan\n  ACTIVE   Original '/dev/lvm-test/original' [20.00 GiB] inherit\n  inactive Snapshot '/dev/lvm-test/snap' [1020.00 MiB] inherit\n```\n\n\n\u5909\u66f4\u72b6\u614b\u3092\u4fdd\u6301\u3057\u304d\u308c\u306a\u304f\u306a\u3063\u305f\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u9818\u57df\u304cinactive \u306b\u306a\u3063\u3066\u3044\u308b\u3053\u3068\u304c\u308f\u304b\u308a\u307e\u3059\u3002\n\u3053\u306e\u72b6\u614b\u3067\u3001\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u304b\u3089\u30aa\u30ea\u30b8\u30ca\u30eb\u30dc\u30ea\u30e5\u30fc\u30e0\u3092\u30d5\u30a7\u30a4\u30eb\u30d0\u30c3\u30af\u3057\u3088\u3046\u3068\u3059\u308b\u3068\u3069\u306e\u3088\u3046\u306b\u306a\u308b\u3067\u3057\u3087\u3046\u304b\u3002\n\n\n```text\n# umount /mnt/original\n# umount /mnt/snap\numount: /mnt/snap: not mounted\n\n# lvconvert --merge /dev/lvm-test/snap\n  Unable to merge invalidated snapshot LV \"snap\".\n  Unable to merge LV \"snap\" into its origin.\n```\n\n\n\u4e0a\u8a18\u306e\u3088\u3046\u306b\u3001\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u304b\u3089\u30d5\u30a7\u30a4\u30eb\u30d0\u30c3\u30af\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u306a\u3044\u3088\u3046\u306b\u306a\u3063\u3066\u3044\u308b\u3053\u3068\u304c\u308f\u304b\u308a\u307e\u3059\u3002\n\n\u3053\u306e\u3088\u3046\u306a\u72b6\u614b\u306b\u306a\u3063\u305f\u3089\u3001\u5143\u306e\u72b6\u614b\u306e\u5fa9\u5143\u306f\u3042\u304d\u3089\u3081\u3066\u304f\u3060\u3055\u3044\u30fb\u30fb\u30fb\u30fb\u30fb\u30fb\u3002\n\u4f7f\u3044\u9053\u306e\u306a\u304f\u306a\u3063\u305f\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u306f\u524a\u9664\u3057\u307e\u3057\u3087\u3046\u3002\n\u4f7f\u3044\u9053\u306e\u306a\u304f\u306a\u3063\u305f\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u3092\u524a\u9664\u3059\u308b\u306b\u306f\u3001`lvremove` \u30b3\u30de\u30f3\u30c9\u3092\u4f7f\u7528\u3057\u307e\u3059\u3002\n\n```text\n# lvremove /dev/lvm-test/snap\n```\n\n# \u6b21\u306e\u8a18\u4e8b\n[Linux\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u6642\u306bLVM on RAID1 \u306a\u74b0\u5883\u3092\u69cb\u7bc9\u3059\u308b](http://qiita.com/TsutomuNakamura/items/1b7928b3595a6ca2a304 \"Linux\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u6642\u306bLVM on RAID1 \u306a\u74b0\u5883\u3092\u69cb\u7bc9\u3059\u308b\")\n"}