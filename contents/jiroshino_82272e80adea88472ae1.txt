{"context": " More than 1 year has passed since last update.\n\n\u6cd5\u7dda\u30de\u30c3\u30d4\u30f3\u30b0(Normal mapping)\n\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306e\u6cd5\u7dda\u60c5\u5831\u3092\u30d3\u30c3\u30c8\u30de\u30c3\u30d7\u306b\u66f8\u304d\u8fbc\u3093\u3060\u3082\u306e\u3092\u6cd5\u7dda\u30de\u30c3\u30d7(Normal map)\u3068\u3044\u3044\u3001\u305d\u308c\u3092\u4f7f\u3063\u3066\u51f9\u51f8\u611f\u3092\u51fa\u3057\u305f\u63cf\u753b\u3092\u3057\u307e\u3059\u3002\u6cd5\u7dda\u30de\u30c3\u30d7\u306f\u3001XYZ\u3092\u305d\u308c\u305e\u308cRGB\u306b\u5bfe\u5fdc\u3055\u305b\u3001\u5024\u30920\u301c255\u3068\u3057\u3066\u3001\u305d\u308c\u305e\u308c128\u3092\u5f15\u3044\u305f\u5024\u306b\u3057\u3066\u5411\u304d\u3092\u8868\u73fe\u3057\u3066\u3044\u307e\u3059\u3002\n\u307e\u305f\u3001\u6cd5\u7dda\u30de\u30c3\u30d7\u3092\u6271\u3046\u305f\u3081\u306b\u306f\u3001\u9802\u70b9\u306e\u4f4d\u7f6eXYZ\u3068\u30c6\u30af\u30b9\u30c1\u30e3\u306eUV\u5ea7\u6a19\u306e\u3046\u3061\u3001UVZ\u3092\u4f7f\u3063\u305f\u63a5\u7a7a\u9593 (Tangent Space)\u304c\u5fc5\u8981\u306b\u306a\u308a\u307e\u3059\u3002\u5ea7\u6a19\u7cfb\u306e\u3082\u3046\uff11\u3064\u306e\u8ef8\u3067\u3042\u308b\u5f93\u6cd5\u7dda(Binormal)\u30d9\u30af\u30c8\u30eb\u306f\u3001\u901a\u5e38\u306f\u30b7\u30a7\u30fc\u30c0\u30fc\u5185\u3067\u3001\u6cd5\u7dda\u30d9\u30af\u30c8\u30eb\u3068\u63a5\u30d9\u30af\u30c8\u30eb\u304b\u3089\u5916\u7a4d\u3092\u4f7f\u3063\u3066\u8a08\u7b97\u3057\u307e\u3059\u3002\n\n\u9802\u70b9\u30b7\u30a7\u30fc\u30c0\u30fc\u306e\u30d7\u30ed\u30b0\u30e9\u30e0\u306f\u6b21\u306e\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\n\n\nnormal.vsh\n// \u9802\u70b9\u5ea7\u6a19\nattribute highp vec3 inVertex;\n// \u6cd5\u7dda\u30d9\u30af\u30c8\u30eb\nattribute mediump vec3  inNormal;\n// \u30c6\u30af\u30b9\u30c1\u30e3\u5ea7\u6a19\nattribute mediump vec2 inTexCoord;\n// \u63a5\u30d9\u30af\u30c8\u30eb\nattribute mediump vec3  inTangent;\n\n// \u30e2\u30c7\u30eb\u2212\u30d3\u30e5\u30fc\u884c\u5217\nuniform highp mat4 ModelViewMatrix;\n// \u5c04\u5f71\u884c\u5217\nuniform highp mat4 ProjectionMatrix;\n// \u30e9\u30a4\u30c8\u306e\u5411\u304d\u30d9\u30af\u30c8\u30eb\nuniform mediump vec3 LightDirection;\n\n// \u6cd5\u7dda\u30d9\u30af\u30c8\u30eb(\u30d5\u30e9\u30b0\u30e1\u30f3\u30c8\u30b7\u30a7\u30fc\u30c0\u30fc\u306b\u6e21\u3059\u5024)\nvarying mediump vec3 Normal;\n// \u30c6\u30af\u30b9\u30c1\u30e3\u5ea7\u6a19(\u30d5\u30e9\u30b0\u30e1\u30f3\u30c8\u30b7\u30a7\u30fc\u30c0\u30fc\u306b\u6e21\u3059\u5024)\nvarying mediump vec2 TexCoord;\n// \u30e9\u30a4\u30c8\u306e\u30d9\u30af\u30c8\u30eb(\u30d5\u30e9\u30b0\u30e1\u30f3\u30c8\u30b7\u30a7\u30fc\u30c0\u30fc\u306b\u6e21\u3059\u5024)\nvarying mediump vec3 LightVec;\n\n// \u30de\u30c6\u30ea\u30a2\u30eb\n\nvoid main()\n{\n    // \u9802\u70b9\u5ea7\u6a19\u3092\u5ea7\u6a19\u5909\u63db\u3059\u308b\u3002\n    gl_Position = ProjectionMatrix * ModelViewMatrix * vec4(inVertex, 1.0);\n\n    // \u30d5\u30e9\u30b0\u30e1\u30f3\u30c8\u30b7\u30a7\u30fc\u30c0\u30fc\u306b\u30c6\u30af\u30b9\u30c1\u30e3\u5ea7\u6a19\u3092\u6e21\u3059\n    TexCoord = inTexCoord;\n\n    // \u30e9\u30a4\u30c8\u306e\u5411\u304d\u30d9\u30af\u30c8\u30eb\u3092\u9006\u306b\u3057\u3066\u3001\u5ff5\u306e\u70ba\u306b\u6b63\u898f\u5316\u3059\u308b\n    highp vec3 lightDirection = normalize(-LightDirection);\n    // \u5f93\u6cd5\u7dda\u30d9\u30af\u30c8\u30eb\u3092\u8a08\u7b97\u3059\u308b\n    highp vec3 bitangent = cross(inNormal, inTangent);\n    // \u63a5\u7a7a\u9593\u3067\u306e\u30e9\u30a4\u30c8\u306e\u5411\u304d\u3092\u5909\u63db\u3059\u308b\u884c\u5217\u3092\u4f5c\u6210\u3059\u308b\n    highp mat3 tangentSpaceXform = mat3(inTangent, bitangent, inNormal);\n    // \u30e9\u30a4\u30c8\u306e\u5411\u304d\u30d9\u30af\u30c8\u30eb\u3092\u8a08\u7b97\u3059\u308b\n    LightVec = lightDirection * tangentSpaceXform;\n}\n\n\n\n\u30d5\u30e9\u30b0\u30e1\u30f3\u30c8\u30b7\u30a7\u30fc\u30c0\u30fc\u306e\u30d7\u30ed\u30b0\u30e9\u30e0\u306f\u6b21\u306e\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\n\n\nnormal.fsh\n// \u62e1\u6563\u53cd\u5c04\u5149\u7528\u30c6\u30af\u30b9\u30c1\u30e3\nuniform sampler2D  DiffuseTexture;\n// \u6cd5\u7dda\u30de\u30c3\u30d7\nuniform sampler2D  NormalTexture;\n// \u30e9\u30a4\u30c8\u306e\u5411\u304d\nuniform mediump vec3  LightDirection;\n// \u8996\u70b9\u306b\u5411\u304b\u3046\u30d9\u30af\u30c8\u30eb\nuniform mediump vec3 Eye;\n// \u93e1\u9762\u53cd\u5c04\u5149\u306e\u5f37\u5ea6\nuniform mediump float Power;\n\n// \u6cd5\u7dda\u30d9\u30af\u30c8\u30eb(\u9802\u70b9\u30b7\u30a7\u30fc\u30c0\u30fc\u304b\u3089\u6e21\u3055\u308c\u305f\u5024)\nvarying mediump vec3 Normal;\n// \u30c6\u30af\u30b9\u30c1\u30e3\u5ea7\u6a19(\u9802\u70b9\u30b7\u30a7\u30fc\u30c0\u30fc\u304b\u3089\u6e21\u3055\u308c\u305f\u5024)\nvarying mediump vec2 TexCoord;\n// \u63a5\u7a7a\u9593\u3067\u306e\u30e9\u30a4\u30c8\u306e\u5411\u304d(\u30d5\u30e9\u30b0\u30e1\u30f3\u30c8\u30b7\u30a7\u30fc\u30c0\u30fc\u304b\u3089\u6e21\u3055\u308c\u305f\u5024)\nvarying mediump vec3 LightVec;\n\n// \u62e1\u6563\u53cd\u5c04\u5149\u306b\u5bfe\u3059\u308b\u53cd\u5c04\u7387\nconst mediump vec3 Diffuse = vec3(0.7, 0.7, 0.7);\n// \u93e1\u9762\u53cd\u5c04\u5149\u306b\u5bfe\u3059\u308b\u53cd\u5c04\u7387\nconst mediump vec4 Specular = vec4(1.0, 1.0, 1.0, 1.0);\n// \u74b0\u5883\u5149\nconst mediump vec3 Ambient = vec3(0.2, 0.2, 0.2);\n\nvoid main()\n{\n    // \u6cd5\u7dda\u30de\u30c3\u30d7\u304b\u3089\u6cd5\u7dda\u3092\u53d6\u5f97\u3059\u308b\n    mediump vec3 N = texture2D(NormalTexture, TexCoord).rgb * 2.0 - 1.0;\n    // \u30e9\u30a4\u30c8\u306e\u5411\u304d\u30d9\u30af\u30c8\u30eb\u3092\u9006\u306b\u3057\u3066\u3001\u5ff5\u306e\u70ba\u306b\u6b63\u898f\u5316\u3059\u308b\n    mediump vec3 L = normalize(-LightDirection);\n    // \u8996\u70b9\u306b\u5411\u304b\u3046\u30d9\u30af\u30c8\u30eb\n    mediump vec3 E = Eye;\n    // \u30cf\u30fc\u30d5\u30d9\u30af\u30c8\u30eb\n    mediump vec3 H = normalize(L + E);\n\n    // \u62e1\u6563\u53cd\u5c04\u5149\u3092\u8a08\u7b97\u3059\u308b\n    mediump float df = max(0.0, dot(N, L));\n    // \u93e1\u9762\u53cd\u5c04\u5149\u3092\u8a08\u7b97\u3059\u308b\n    mediump float sf = max(0.0, dot(N, H));\n    sf = pow(sf, Power);\n\n    // \u6700\u7d42\u7684\u306a\u8272\u3092\u5149\u306e\u660e\u308b\u3055\u3068\u30c6\u30af\u30b9\u30c1\u30e3\u306e\u8272\u304b\u3089\u6c7a\u3081\u308b\u3002\n    gl_FragColor = Ambient + df * texture2D(DiffuseTexture, TexCoord) * Diffuse + sf * Specular;\n}\n\n\n\n## \u6cd5\u7dda\u30de\u30c3\u30d4\u30f3\u30b0(Normal mapping)\n\n\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306e\u6cd5\u7dda\u60c5\u5831\u3092\u30d3\u30c3\u30c8\u30de\u30c3\u30d7\u306b\u66f8\u304d\u8fbc\u3093\u3060\u3082\u306e\u3092\u6cd5\u7dda\u30de\u30c3\u30d7(Normal map)\u3068\u3044\u3044\u3001\u305d\u308c\u3092\u4f7f\u3063\u3066\u51f9\u51f8\u611f\u3092\u51fa\u3057\u305f\u63cf\u753b\u3092\u3057\u307e\u3059\u3002\u6cd5\u7dda\u30de\u30c3\u30d7\u306f\u3001XYZ\u3092\u305d\u308c\u305e\u308cRGB\u306b\u5bfe\u5fdc\u3055\u305b\u3001\u5024\u30920\u301c255\u3068\u3057\u3066\u3001\u305d\u308c\u305e\u308c128\u3092\u5f15\u3044\u305f\u5024\u306b\u3057\u3066\u5411\u304d\u3092\u8868\u73fe\u3057\u3066\u3044\u307e\u3059\u3002\n\u307e\u305f\u3001\u6cd5\u7dda\u30de\u30c3\u30d7\u3092\u6271\u3046\u305f\u3081\u306b\u306f\u3001\u9802\u70b9\u306e\u4f4d\u7f6eXYZ\u3068\u30c6\u30af\u30b9\u30c1\u30e3\u306eUV\u5ea7\u6a19\u306e\u3046\u3061\u3001UVZ\u3092\u4f7f\u3063\u305f\u63a5\u7a7a\u9593 (Tangent Space)\u304c\u5fc5\u8981\u306b\u306a\u308a\u307e\u3059\u3002\u5ea7\u6a19\u7cfb\u306e\u3082\u3046\uff11\u3064\u306e\u8ef8\u3067\u3042\u308b\u5f93\u6cd5\u7dda(Binormal)\u30d9\u30af\u30c8\u30eb\u306f\u3001\u901a\u5e38\u306f\u30b7\u30a7\u30fc\u30c0\u30fc\u5185\u3067\u3001\u6cd5\u7dda\u30d9\u30af\u30c8\u30eb\u3068\u63a5\u30d9\u30af\u30c8\u30eb\u304b\u3089\u5916\u7a4d\u3092\u4f7f\u3063\u3066\u8a08\u7b97\u3057\u307e\u3059\u3002\n\n- \u9802\u70b9\u30b7\u30a7\u30fc\u30c0\u30fc\u306e\u30d7\u30ed\u30b0\u30e9\u30e0\u306f\u6b21\u306e\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\n\n```normal.vsh\n// \u9802\u70b9\u5ea7\u6a19\nattribute highp vec3 inVertex;\n// \u6cd5\u7dda\u30d9\u30af\u30c8\u30eb\nattribute mediump vec3  inNormal;\n// \u30c6\u30af\u30b9\u30c1\u30e3\u5ea7\u6a19\nattribute mediump vec2 inTexCoord;\n// \u63a5\u30d9\u30af\u30c8\u30eb\nattribute mediump vec3  inTangent;\n\n// \u30e2\u30c7\u30eb\u2212\u30d3\u30e5\u30fc\u884c\u5217\nuniform highp mat4 ModelViewMatrix;\n// \u5c04\u5f71\u884c\u5217\nuniform highp mat4 ProjectionMatrix;\n// \u30e9\u30a4\u30c8\u306e\u5411\u304d\u30d9\u30af\u30c8\u30eb\nuniform mediump vec3 LightDirection;\n\n// \u6cd5\u7dda\u30d9\u30af\u30c8\u30eb(\u30d5\u30e9\u30b0\u30e1\u30f3\u30c8\u30b7\u30a7\u30fc\u30c0\u30fc\u306b\u6e21\u3059\u5024)\nvarying mediump vec3 Normal;\n// \u30c6\u30af\u30b9\u30c1\u30e3\u5ea7\u6a19(\u30d5\u30e9\u30b0\u30e1\u30f3\u30c8\u30b7\u30a7\u30fc\u30c0\u30fc\u306b\u6e21\u3059\u5024)\nvarying mediump vec2 TexCoord;\n// \u30e9\u30a4\u30c8\u306e\u30d9\u30af\u30c8\u30eb(\u30d5\u30e9\u30b0\u30e1\u30f3\u30c8\u30b7\u30a7\u30fc\u30c0\u30fc\u306b\u6e21\u3059\u5024)\nvarying mediump vec3 LightVec;\n\n// \u30de\u30c6\u30ea\u30a2\u30eb\n\nvoid main()\n{\n\t// \u9802\u70b9\u5ea7\u6a19\u3092\u5ea7\u6a19\u5909\u63db\u3059\u308b\u3002\n\tgl_Position = ProjectionMatrix * ModelViewMatrix * vec4(inVertex, 1.0);\n    \n\t// \u30d5\u30e9\u30b0\u30e1\u30f3\u30c8\u30b7\u30a7\u30fc\u30c0\u30fc\u306b\u30c6\u30af\u30b9\u30c1\u30e3\u5ea7\u6a19\u3092\u6e21\u3059\n\tTexCoord = inTexCoord;\n\n\t// \u30e9\u30a4\u30c8\u306e\u5411\u304d\u30d9\u30af\u30c8\u30eb\u3092\u9006\u306b\u3057\u3066\u3001\u5ff5\u306e\u70ba\u306b\u6b63\u898f\u5316\u3059\u308b\n\thighp vec3 lightDirection = normalize(-LightDirection);\n\t// \u5f93\u6cd5\u7dda\u30d9\u30af\u30c8\u30eb\u3092\u8a08\u7b97\u3059\u308b\n\thighp vec3 bitangent = cross(inNormal, inTangent);\n\t// \u63a5\u7a7a\u9593\u3067\u306e\u30e9\u30a4\u30c8\u306e\u5411\u304d\u3092\u5909\u63db\u3059\u308b\u884c\u5217\u3092\u4f5c\u6210\u3059\u308b\n\thighp mat3 tangentSpaceXform = mat3(inTangent, bitangent, inNormal);\n\t// \u30e9\u30a4\u30c8\u306e\u5411\u304d\u30d9\u30af\u30c8\u30eb\u3092\u8a08\u7b97\u3059\u308b\n\tLightVec = lightDirection * tangentSpaceXform;\n}\n```\n\n- \u30d5\u30e9\u30b0\u30e1\u30f3\u30c8\u30b7\u30a7\u30fc\u30c0\u30fc\u306e\u30d7\u30ed\u30b0\u30e9\u30e0\u306f\u6b21\u306e\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\n\n```normal.fsh\n// \u62e1\u6563\u53cd\u5c04\u5149\u7528\u30c6\u30af\u30b9\u30c1\u30e3\nuniform sampler2D  DiffuseTexture;\n// \u6cd5\u7dda\u30de\u30c3\u30d7\nuniform sampler2D  NormalTexture;\n// \u30e9\u30a4\u30c8\u306e\u5411\u304d\nuniform mediump vec3  LightDirection;\n// \u8996\u70b9\u306b\u5411\u304b\u3046\u30d9\u30af\u30c8\u30eb\nuniform mediump vec3 Eye;\n// \u93e1\u9762\u53cd\u5c04\u5149\u306e\u5f37\u5ea6\nuniform mediump float Power;\n\n// \u6cd5\u7dda\u30d9\u30af\u30c8\u30eb(\u9802\u70b9\u30b7\u30a7\u30fc\u30c0\u30fc\u304b\u3089\u6e21\u3055\u308c\u305f\u5024)\nvarying mediump vec3 Normal;\n// \u30c6\u30af\u30b9\u30c1\u30e3\u5ea7\u6a19(\u9802\u70b9\u30b7\u30a7\u30fc\u30c0\u30fc\u304b\u3089\u6e21\u3055\u308c\u305f\u5024)\nvarying mediump vec2 TexCoord;\n// \u63a5\u7a7a\u9593\u3067\u306e\u30e9\u30a4\u30c8\u306e\u5411\u304d(\u30d5\u30e9\u30b0\u30e1\u30f3\u30c8\u30b7\u30a7\u30fc\u30c0\u30fc\u304b\u3089\u6e21\u3055\u308c\u305f\u5024)\nvarying mediump vec3 LightVec;\n\n// \u62e1\u6563\u53cd\u5c04\u5149\u306b\u5bfe\u3059\u308b\u53cd\u5c04\u7387\nconst mediump vec3 Diffuse = vec3(0.7, 0.7, 0.7);\n// \u93e1\u9762\u53cd\u5c04\u5149\u306b\u5bfe\u3059\u308b\u53cd\u5c04\u7387\nconst mediump vec4 Specular = vec4(1.0, 1.0, 1.0, 1.0);\n// \u74b0\u5883\u5149\nconst mediump vec3 Ambient = vec3(0.2, 0.2, 0.2);\n\nvoid main()\n{\n\t// \u6cd5\u7dda\u30de\u30c3\u30d7\u304b\u3089\u6cd5\u7dda\u3092\u53d6\u5f97\u3059\u308b\n\tmediump vec3 N = texture2D(NormalTexture, TexCoord).rgb * 2.0 - 1.0;\n\t// \u30e9\u30a4\u30c8\u306e\u5411\u304d\u30d9\u30af\u30c8\u30eb\u3092\u9006\u306b\u3057\u3066\u3001\u5ff5\u306e\u70ba\u306b\u6b63\u898f\u5316\u3059\u308b\n\tmediump vec3 L = normalize(-LightDirection);\n\t// \u8996\u70b9\u306b\u5411\u304b\u3046\u30d9\u30af\u30c8\u30eb\n\tmediump vec3 E = Eye;\n\t// \u30cf\u30fc\u30d5\u30d9\u30af\u30c8\u30eb\n\tmediump vec3 H = normalize(L + E);\n\n\t// \u62e1\u6563\u53cd\u5c04\u5149\u3092\u8a08\u7b97\u3059\u308b\n\tmediump float df = max(0.0, dot(N, L));\n\t// \u93e1\u9762\u53cd\u5c04\u5149\u3092\u8a08\u7b97\u3059\u308b\n\tmediump float sf = max(0.0, dot(N, H));\n\tsf = pow(sf, Power);\n\n\t// \u6700\u7d42\u7684\u306a\u8272\u3092\u5149\u306e\u660e\u308b\u3055\u3068\u30c6\u30af\u30b9\u30c1\u30e3\u306e\u8272\u304b\u3089\u6c7a\u3081\u308b\u3002\n\tgl_FragColor = Ambient + df * texture2D(DiffuseTexture, TexCoord) * Diffuse + sf * Specular;\n}\n```\n", "tags": ["PowerVR", "GraphicsSDK", "OpenGLES"]}