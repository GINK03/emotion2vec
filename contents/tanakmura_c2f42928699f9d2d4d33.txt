{"tags": ["avx512"], "context": " More than 1 year has passed since last update.512bit \u5185\u306e 128bit \u306b\u542b\u307e\u308c\u308b32bit\u50244\u500b\u3092\u307e\u305c\u307e\u305c\u3057\u307e\u3059\u3002x86\u306e\u4f1d\u7d71\u306b\u5f93\u3044\u3001128bit \u5883\u754c\u306f\u8d85\u3048\u3089\u308c\u307e\u305b\u3093\u3002\n\n#include <immintrin.h>\n#include <stdio.h>\n\nint in0[16] = {100,\n               101,\n               102,\n               103,\n               104,\n               105,\n               106,\n               107,\n               108,\n               109,\n               110,\n               111,\n               112,\n               113,\n               114,\n               115};\n\n\nint out[16];\n\nstatic inline int __attribute__((always_inline))\ntest(const int imm)\n{\n    __m512i v = _mm512_loadu_si512(in0);\n    v = _mm512_shuffle_epi32(v, imm);\n\n    _mm512_storeu_si512(out, v);\n\n    for (int i=0; i<16; i++) {\n        printf(\"%2d:%3d\\n\", i, out[i]);\n    }\n}\n\n\n\nint\nmain(void)\n{\n    test(_MM_SHUFFLE(3,3,3,3));\n    puts(\"--\");\n    test(_MM_SHUFFLE(3,2,1,0));\n    puts(\"--\");\n    test(_MM_SHUFFLE(0,0,2,2));\n}\n\n$ sde -- ./a.out \n 0:103\n 1:103\n 2:103\n 3:103\n 4:107\n 5:107\n 6:107\n 7:107\n 8:111\n 9:111\n10:111\n11:111\n12:115\n13:115\n14:115\n15:115\n--\n 0:100\n 1:101\n 2:102\n 3:103\n 4:104\n 5:105\n 6:106\n 7:107\n 8:108\n 9:109\n10:110\n11:111\n12:112\n13:113\n14:114\n15:115\n--\n 0:102\n 1:102\n 2:100\n 3:100\n 4:106\n 5:106\n 6:104\n 7:104\n 8:110\n 9:110\n10:108\n11:108\n12:114\n13:114\n14:112\n15:112\n\n\u660e\u65e5\u306f @tanakmura \u304c vpermt2d \u306b\u3064\u3044\u3066\u66f8\u304d\u307e\u3059\u3002\n512bit \u5185\u306e 128bit \u306b\u542b\u307e\u308c\u308b32bit\u50244\u500b\u3092\u307e\u305c\u307e\u305c\u3057\u307e\u3059\u3002x86\u306e\u4f1d\u7d71\u306b\u5f93\u3044\u3001128bit \u5883\u754c\u306f\u8d85\u3048\u3089\u308c\u307e\u305b\u3093\u3002\n\n```cpp\n\n#include <immintrin.h>\n#include <stdio.h>\n\nint in0[16] = {100,\n               101,\n               102,\n               103,\n               104,\n               105,\n               106,\n               107,\n               108,\n               109,\n               110,\n               111,\n               112,\n               113,\n               114,\n               115};\n               \n\nint out[16];\n\nstatic inline int __attribute__((always_inline))\ntest(const int imm)\n{\n    __m512i v = _mm512_loadu_si512(in0);\n    v = _mm512_shuffle_epi32(v, imm);\n\n    _mm512_storeu_si512(out, v);\n\n    for (int i=0; i<16; i++) {\n        printf(\"%2d:%3d\\n\", i, out[i]);\n    }\n}\n\n\n\nint\nmain(void)\n{\n    test(_MM_SHUFFLE(3,3,3,3));\n    puts(\"--\");\n    test(_MM_SHUFFLE(3,2,1,0));\n    puts(\"--\");\n    test(_MM_SHUFFLE(0,0,2,2));\n}\n```\n\n```\n$ sde -- ./a.out \n 0:103\n 1:103\n 2:103\n 3:103\n 4:107\n 5:107\n 6:107\n 7:107\n 8:111\n 9:111\n10:111\n11:111\n12:115\n13:115\n14:115\n15:115\n--\n 0:100\n 1:101\n 2:102\n 3:103\n 4:104\n 5:105\n 6:106\n 7:107\n 8:108\n 9:109\n10:110\n11:111\n12:112\n13:113\n14:114\n15:115\n--\n 0:102\n 1:102\n 2:100\n 3:100\n 4:106\n 5:106\n 6:104\n 7:104\n 8:110\n 9:110\n10:108\n11:108\n12:114\n13:114\n14:112\n15:112\n```\n\n\u660e\u65e5\u306f @tanakmura \u304c vpermt2d \u306b\u3064\u3044\u3066\u66f8\u304d\u307e\u3059\u3002\n"}