{"tags": ["C\u8a00\u8a9e"], "context": "\n\n\u4e09\u884c\u3067\u983c\u30801\n\n\nrealloc(ptr, 0)\u304cfree(ptr)\u3068\u7b49\u4fa1\u3060\u3063\u305f\u306e\u306f\u904e\u53bb\u306e\u8a71\nrealloc\u306e\u7b2c\u4e8c\u5f15\u6570\u306f\u7d76\u5bfe\u306b0\u306b\u3059\u308b\u306a\nISO C\u3082POSIX\u3082\u4fe1\u7528\u3059\u308b\u306a\n\n\u3053\u308c\u306fC\u8a00\u8a9e Advent Calendar 2016\u306e14\u65e5\u76ee\u306e\u8a18\u4e8b\u3067\u3059\u3002\n\n\u8a71\u306e\u6795\n\u79c1\u304c\u3053\u3068\u3042\u308b\u3054\u3068\u306b\u8a00\u3063\u3066\u3044\u308b\u6301\u3061\u30cd\u30bf\u3068\u3057\u3066\u3001bzero\u95a2\u6570\u3092\u524a\u9664\u3059\u308b\u306a\u3063\u3066\u306e\u304c\u3042\u308a\u307e\u3059\u3002bzero\u95a2\u6570\u306fISO C\u306e\u6a19\u6e96\u95a2\u6570\u3067\u306f\u3042\u308a\u307e\u305b\u3093\u304c\u3001X/Open\u3068\u3044\u3046\u53e4\u306e\u898f\u683c\u56e3\u4f53\u304c\u5b9a\u7fa9\u3057\u3066\u3044\u305f\u3082\u306e\u3067\u3001\u73fe\u5728\u3067\u3082UNIX\u7cfbOS\u3067\u306f\u666e\u901a\u306b\u4f7f\u3048\u307e\u3059\u3002\u3053\u308c\u306f\u3001\u6307\u5b9a\u3055\u308c\u305f\u30e1\u30e2\u30ea\u30d6\u30ed\u30c3\u30af\u3092\u5358\u7d14\u306b\u30bc\u30ed\u30d0\u30a4\u30c8\u3067\u30af\u30ea\u30a2\u3059\u308b\u305f\u3081\u306e\u95a2\u6570\u3067\u3059\u3002\u305f\u3068\u3048\u3070\u6b21\u306e\u3088\u3046\u306b\u3057\u3066\u4f7f\u3044\u307e\u3059:\n#include <strings.h>\n\n    char buf[42];\n    bzero(buf, sizeof (buf));\n\n\u6a19\u6e96C\u8a00\u8a9e\u306b\u89aa\u3057\u3093\u3067\u3044\u308b\u4eba\u9593\u306a\u3089\u3070\u5206\u304b\u308b\u3068\u601d\u3044\u307e\u3059\u304c\u3001\u3053\u308c\u306f\u3088\u308a\u6c4e\u7528\u7684\u306a\u95a2\u6570\u3067\u3042\u308b\u3068\u3053\u308d\u306ememset\u3092\u4f7f\u3063\u3066\u6b21\u306e\u3088\u3046\u306b\u66f8\u304f\u3053\u3068\u304c\u3067\u304d\u307e\u3059:\n#include <string.h>\n\n    char buf[42];\n    memset(buf, 0, sizeof (buf));\n\n\u300c\u3058\u3083\u3042bzero\u306a\u3093\u3066\u8981\u3089\u306a\u3044\u3093\u3058\u3083\u306a\u3044\u306e\uff1f\u300d\u3068\u3044\u3046\u610f\u898b\u3082\u307e\u3042\u3082\u3063\u3068\u3082\u306a\u306e\u3067\u3059\u304c\u3001\u3057\u304b\u3057\u306a\u304c\u3089\u3001memset\u95a2\u6570\u306e99%\u306f\u30bc\u30ed\u30af\u30ea\u30a2\u306e\u305f\u3081\u306b\u4f7f\u308f\u308c\u308b\u3068\u8a00\u3063\u3066\u3082\u904e\u8a00\u3067\u306f\u306a\u3044\u306e\u3067\u306f\u306a\u3044\u304b\u3068\u601d\u3046\u307b\u3069\u3001\u3053\u306e\u95a2\u6570\u306e\u7b2c\u4e8c\u5f15\u6570\u306f0\u306e\u3053\u3068\u304c\u591a\u3044\u3068\u601d\u3044\u307e\u3059\u3002\u3057\u304b\u3082\u3001memset\u95a2\u6570\u306e\u7b2c\u4e8c\u5f15\u6570\u3068\u7b2c\u4e09\u5f15\u6570\u306f\u975e\u5e38\u306b\u7d1b\u3089\u308f\u3057\u3044\u305f\u3081\u3001\u3057\u3070\u3057\u3070\u53d6\u308a\u9055\u3048\u3089\u308c\u308b\u30d0\u30b0\u306e\u6e29\u5e8a\u3068\u306a\u308a\u307e\u3059\u3002\n\u3057\u305f\u304c\u3063\u3066\u3001\u79c1\u306a\u3093\u305e\u306f\u30bc\u30ed\u30af\u30ea\u30a2\u5c02\u7528\u306e\u95a2\u6570\u3092\u7528\u610f\u3057\u3066\u304a\u3044\u3066\u3082\u30d0\u30c1\u306f\u5f53\u305f\u3089\u306a\u3044\u3068\u601d\u3046\u306e\u3067\u3059\u304c\u3001\u305d\u3046\u3044\u3046\u610f\u898b\u3092reject\u3059\u308b\u6642\u306b\u5fc5\u305a\u4f7f\u308f\u308c\u308b\u5370\u7c60\u306e\u3088\u3046\u306a\u8a00\u8449\u304c\u3042\u308a\u307e\u3059\u3002\u305d\u308c\u304c\u76f4\u4ea4\u6027\u3068\u3044\u3046\u8003\u3048\u65b9\u3067\u3059\u3002\u3064\u307e\u308a\u3001\u6a19\u6e96\u95a2\u6570\u3068\u3057\u3066\u306f\u3001\u6a5f\u80fd\u304c\u91cd\u8907\u3057\u306a\u3044(=\u76f4\u4ea4\u3057\u305f)\u30df\u30cb\u30de\u30eb\u306a\u95a2\u6570\u30bb\u30c3\u30c8\u3060\u3051\u3092\u7528\u610f\u3057\u3066\u3001\u30d7\u30ed\u30b0\u30e9\u30de\u306b\u306f\u305d\u306e\u7d44\u307f\u5408\u308f\u305b\u3067\u3042\u3089\u3086\u308b\u3053\u3068\u3092\u5b9f\u73fe\u3055\u305b\u3088\u3046\u3068\u3044\u3046\u8003\u3048\u65b9\u3067\u3059\u3002\u3053\u308c\u306b\u5f93\u3048\u3070\u3001\u300c\u65e2\u306bmemset\u95a2\u6570\u3067\u3067\u304d\u308b\u3053\u3068\u306e\u305f\u3081\u306b\u3001\u65b0\u3057\u304f\u95a2\u6570\u3092\u7528\u610f\u3059\u308b\u5fc5\u8981\u306f\u306a\u3044\u306e\u3060\u300d\u3068\u3044\u3046\u3053\u3068\u3067\u3059\u306d\u3002POSIX\u3082\u305d\u3046\u3044\u3046\u601d\u60f3\u306b\u6bd2\u3055\u308c\u3066\u3044\u308b\u90e8\u5206\u304c\u3042\u308b\u305f\u3081\u3001\u54c0\u308cbzero\u95a2\u6570\u306fPOSIX:2004\u3067\u5ec3\u6b62\u4e88\u5b9a\u3068\u3055\u308c\u3001POSIX:2008\u3067\u846c\u308a\u53bb\u3089\u308c\u305f\u3068\u3044\u3046\u308f\u3051\u3067\u3059\u3002\u307e\u3042\u3001\u3042\u3093\u307e\u308a\u540d\u524d\u3082\u826f\u304f\u306a\u304b\u3063\u305f\u3057\u3001<strings.h>\u306a\u3093\u3066VAX\u6642\u4ee3\u306e\u907a\u7269\u307f\u305f\u3044\u306a\u30d8\u30c3\u30c0\u30d5\u30a1\u30a4\u30eb\u3092\u30a4\u30f3\u30af\u30eb\u30fc\u30c9\u3057\u306a\u3044\u3068\u3044\u3051\u306a\u304b\u3063\u305f\u3057\u3067\u3001\u4ed5\u65b9\u304c\u306a\u3044\u304b\u306a\u3042\u3001\u3068\u3044\u3046\u5074\u9762\u3082\u3042\u308a\u307e\u3059\u304c\u3002\u4e00\u65b9\u305d\u306e\u9803Win32\u306fZeroMemory\u30de\u30af\u30ed\u3092\u4f7f\u3044\u7d9a\u3051\u305f\u3002\n\u3067\u3082\u3001\u76f4\u4ea4\u6027\u306b\u62d8\u308b\u306e\u3067\u3042\u308c\u3070\u3001\u65e2\u306bISO C\u306b\u306f\u76f4\u4ea4\u6027\u3092\u6b20\u3044\u305f\u5197\u9577\u306a\u95a2\u6570\u7fa4\u304c\u5b58\u5728\u3057\u3066\u3044\u307e\u3057\u305f\u3002\u305d\u308c\u306f\u3001malloc/realloc/calloc/free\u3067\u3059\u3002\u3053\u308c\u3089\u306f\u3001ISO C:1995(C95)\u307e\u3067\u306f\u3059\u3079\u3066realloc\u3068memset\u306e\u7d44\u307f\u5408\u308f\u305b\u3067\u8868\u73fe\u53ef\u80fd\u3067\u3057\u305f:\nptr = realloc(NULL, size);  /* malloc(size) \u3068\u7b49\u4fa1 */\nrealloc(ptr, 0);            /* free(ptr) \u3068\u7b49\u4fa1 */\n\n/* \u4ee5\u4e0b\u306fcalloc(memb, size)\u3068\u7b49\u4fa1(\u305f\u3060\u3057\u639b\u3051\u7b97\u306e\u30aa\u30fc\u30d0\u30fc\u30d5\u30ed\u30fc\u6642\u306e\u632f\u308b\u821e\u3044\u3092\u9664\u304f) */\nptr = realloc(NULL, memb*size);\nif (ptr)\n    memset(ptr, 0, memb*size);\n\n\u3057\u305f\u304c\u3063\u3066\u3001malloc\u3082calloc\u3082free\u3082\u5197\u9577\u306a\u5b58\u5728\u3060\u3063\u305f\u306e\u3067\u3059\u3002\n\nrealloc(ptr, 0)\u306e\u5909\u9077\n\u307e\u3042\u3001\u3053\u3053\u307e\u3067\u306f\u8a71\u306e\u6795\u3068\u3044\u3046\u3053\u3068\u3067\u3001\u5225\u306bbzero\u3082\u76f4\u4ea4\u6027\u3082\u3069\u3046\u3067\u3082\u3088\u304f\u3066\u3001\u672c\u984c\u306frealloc\u306e\u4ed5\u69d8\u306b\u3064\u3044\u3066\u3067\u3059\u3002\u4e0a\u3067\u66f8\u3044\u305frealloc\u306e\u4e07\u80fd\u6027\u306f\u3001\u5b9f\u306f\u904e\u53bb\u306e\u3082\u306e\u3067\u3059\u3002\u73fe\u884c\u898f\u683c\u3067\u3042\u308bISO C:2011(C11)\u3084\u3001\u305d\u306e\u4e00\u3064\u524d\u306eISO C:1999(C99)\u3078\u3068\u53b3\u683c\u306b\u6e96\u62e0\u3057\u305frealloc\u306b\u306f\u3001free\u3068\u7b49\u4fa1\u306a\u6a5f\u80fd\u306f\u3042\u308a\u307e\u305b\u3093\u3002\n\u975eNULL\u306aptr\u306b\u5bfe\u3059\u308brealloc(ptr, 0)\u306e\u7d50\u679c\u306b\u306f\u6b21\u306e\u3088\u3046\u306a\u5909\u9077\u304c\u3042\u308a\u307e\u3059:\nC90/C95\nrealloc(ptr, 0)\u306fNULL\u3092\u8fd4\u3057\u3001ptr\u306f\u89e3\u653e\u3055\u308c\u308b\u3002\nC99/C11\nrealloc(ptr, 0)\u306f\u6b21\u306e\u3046\u3061\u306e\u3044\u305a\u308c\u304b\u3068\u306a\u308b:\n\nNULL\u304c\u8fd4\u3055\u308c\u308b\u3002\u3053\u306e\u6642\u3001ptr\u306f\u89e3\u653e\u3055\u308c\u305a\u6709\u52b9\u306a\u30dd\u30a4\u30f3\u30bf\u3068\u3057\u3066\u6b8b\u3063\u3066\u3044\u308b\u3002\n\u6709\u52b9\u306a\u30dd\u30a4\u30f3\u30bf\u304c\u8fd4\u3055\u308c\u308b\u3002\u305d\u308c\u304cptr\u3068\u7b49\u3057\u3044\u3053\u3068\u3082\u3042\u308b\u3002\n\n\u73fe\u5728\u306e\u30c9\u30e9\u30d5\u30c8\nrealloc(ptr, 0)\u306f\u6b21\u306e\u3046\u3061\u306e\u3044\u305a\u308c\u304b\u3068\u306a\u308b:\n\nNULL\u304c\u8fd4\u3055\u308c\u308b\u3002\u3053\u306e\u6642\u3001ptr\u304c\u89e3\u653e\u3055\u308c\u305a\u6709\u52b9\u306a\u30dd\u30a4\u30f3\u30bf\u3068\u3057\u3066\u6b8b\u308b\u304b\u3001\u305d\u308c\u3068\u3082\u89e3\u653e\u3055\u308c\u308b\u304b\u306f\u5b9f\u88c5\u4f9d\u5b58\u3067\u3042\u308b\u3002\n\u6709\u52b9\u306a\u30dd\u30a4\u30f3\u30bf\u304c\u8fd4\u3055\u308c\u308b\u3002\u305d\u308c\u304cptr\u3068\u7b49\u3057\u3044\u3053\u3068\u3082\u3042\u308b\u3002\n\nC90/C95\u3068C99/C11\u306f\u5b8c\u5168\u306b\u77db\u76fe\u3057\u3066\u304a\u308a\u3001\u73fe\u5728\u306e\u30c9\u30e9\u30d5\u30c8\u306f\u3001\u3053\u306e\u4e21\u65b9\u3092\u6298\u8877\u3057\u305f\u3082\u306e\u3068\u306a\u3063\u3066\u304a\u308a\u307e\u3059\u3002\u7d50\u5c40\u3001\u3053\u306e\u4e8c\u5ea6\u306e\u5909\u66f4\u306f\u3001\u4e21\u65b9\u3068\u3082\u4e92\u63db\u6027\u3092\u7834\u58ca\u3057\u3066\u3044\u307e\u3059\u3002\u3064\u307e\u308a\u3001\n\n\nC90/C95 \u2192 C99/C11 realloc(ptr, 0)\u304cfree(ptr)\u3068\u7b49\u4fa1\u3067\u3042\u308b\u3068\u671f\u5f85\u3057\u3066\u3044\u308b(=\u6b63\u3057\u304fC90/C95\u306b\u6e96\u62e0\u3057\u305f)\u30d7\u30ed\u30b0\u30e9\u30e0\u304c\u7834\u58ca\u3055\u308c\u308b\u3002\n\nC99/C11 \u2192 \u73fe\u5728\u306e\u30c9\u30e9\u30d5\u30c8 NULL\u304c\u8fd4\u3063\u3066\u304d\u305f\u3068\u304d\u306bptr\u304c\u6709\u52b9\u306a\u30dd\u30a4\u30f3\u30bf\u3068\u3057\u3066\u6b8b\u3063\u3066\u3044\u308b\u3053\u3068\u306b\u671f\u5f85\u3057\u3066\u5f8b\u5100\u306bfree(ptr)\u3092\u547c\u3076(=\u6b63\u3057\u304fC99/C11\u306b\u6e96\u62e0\u3057\u305f)\u30d7\u30ed\u30b0\u30e9\u30e0\u304c\u7834\u58ca\u3055\u308c\u308b\u3002\n\n\u56f0\u3063\u305f\u3053\u3068\u3067\u3059\u306d\u3002\n\u307e\u3001\u305d\u3082\u305d\u3082realloc\u3092free\u306e\u4ee3\u308f\u308a\u306b\u4f7f\u3046\u306a\u3088\u3063\u3066\u8a71\u3067\u306f\u3042\u308b\u306e\u3067\u3059\u304c\u3001\u53e4\u304f\u304b\u3089C\u8a00\u8a9e\u3092\u4f7f\u3063\u3066\u3044\u308b\u4eba\u9593\u306b\u306f\u3001realloc(ptr, 0)\u304cfree(ptr)\u3068\u7b49\u4fa1\u3060\u3068\u3044\u3046\u306e\u306f\u534a\u3070\u5e38\u8b58\u5316\u3057\u3066\u3044\u305f\u5272\u306b\u3001\u305d\u308c\u304cC99\u3067\u7834\u58ca\u3055\u308c\u305f\u3068\u3044\u3046\u3053\u3068\u306f\u610f\u5916\u3068\u77e5\u3089\u308c\u3066\u306a\u3044\u306e\u3067\u306f\u306a\u3044\u304b\u3068\u601d\u3044\u307e\u3059\u3002\n\nPOSIX\u306f\u3069\u3046\u304b\nPOSIX\u3067\u3082\u73fe\u884c\u306ePOSIX:2008\u3067\u306fC99\u3068\u540c\u69d8\u306e\u898f\u5b9a\u306b\u306a\u3063\u3066\u3044\u307e\u3059\u3002\u4e00\u65b9\u3001POSIX:2004\u3067\u306fC95\u3068\u540c\u69d8\u3068\u306a\u3063\u3066\u3044\u307e\u3057\u305f\u3002\u3057\u304b\u3057\u306a\u304c\u3089\u3001POSIX:2004\u306eNormative Reference\u3068\u3055\u308c\u3066\u3044\u308b\u306e\u306fC99\u3067\u3059\u306e\u3067\u3001\u3053\u308c\u306f\u5358\u7d14\u306aPOSIX:2004\u306e\u30df\u30b9\u3067\u3059\u306d\u3002\n\n\u4e16\u306e\u4e2d\u306e\u5b9f\u88c5\u306f\u3069\u3046\u304b\n\u3082\u3068\u3082\u3068\u306e\u4ed5\u69d8\u304c\u300crealloc(ptr, 0)\u306ffree(ptr)\u3068\u7b49\u4fa1\u300d\u3067\u3059\u304b\u3089\u30011999\u5e74\u3054\u308d\u307e\u3067\u306erealloc\u5b9f\u88c5\u306e\u307b\u3068\u3093\u3069\u306f\u305d\u3046\u3044\u3046\u4ed5\u69d8\u3060\u3063\u305f\u3068\u601d\u3044\u307e\u3059\u304c\u3001C99\u306b\u304a\u3044\u3066\u4e92\u63db\u6027\u306e\u306a\u3044\u5909\u66f4\u304c\u3055\u308c\u3066\u3057\u307e\u3063\u3066\u3044\u308b\u306e\u3067\u3001\u3053\u3053\u3067\u4e16\u306e\u4e2d\u306e\u5b9f\u88c5\u3082\u300c\u904e\u53bb\u306e\u4e92\u63db\u6027\u3092\u5b88\u308b\u300d\u304b\u300cC99\u3092\u6e80\u305f\u3059\u300d\u304b\u306e\u4e8c\u8005\u629e\u4e00\u3092\u8feb\u3089\u308c\u308b\u3053\u3068\u306b\u306a\u308a\u307e\u3057\u305f\u3002\u73fe\u884c\u306e\u898f\u683c\u30c9\u30e9\u30d5\u30c8\u306b\u5909\u66f4\u3055\u308c\u308b\u304d\u3063\u304b\u3051\u3068\u306a\u3063\u305fDefect Report #400\u3067\u306f\u3001\u6b21\u306e3\u3064\u306e\u5b9f\u88c5\u304c\u7d39\u4ecb\u3055\u308c\u3066\u3044\u307e\u3059(ptr\u304c\u975eNULL\u306e\u5834\u5408\u306e\u307f\u3092\u629c\u7c8b\u3001errno\u306fISO C\u7684\u306b\u306f\u3042\u3093\u307e\u308a\u610f\u5473\u304c\u7121\u3044\u306e\u3067\u3053\u308c\u3082\u7701\u7565):\n\nAIX : realloc(ptr, 0)\u306fNULL\u3092\u8fd4\u3057\u3001ptr\u3092\u89e3\u653e\u3059\u308b\nBSD : realloc(ptr, 0)\u306fNULL\u3092\u8fd4\u3057\u3001ptr\u306f\u305d\u306e\u307e\u307e\u306b\u3059\u308b\nglibc : realloc(ptr, 0)\u306fNULL\u3092\u8fd4\u3057\u3001ptr\u3092\u89e3\u653e\u3059\u308b\n\n\u3053\u306e\u4e09\u3064\u306e\u5b9f\u88c5\u3067\u306f\u3059\u3079\u3066NULL\u3092\u8fd4\u3057\u307e\u3059\u304c\u3001AIX\u3068glibc\u306fC90/C95\u306e\u3001BSD\u306fC99/C11\u306e\u4ed5\u69d8\u306b\u5f93\u3063\u3066\u3044\u307e\u3059\u3002BSD\u304cC99\u306b\u8ffd\u5f93\u3057\u3066\u3044\u308b\u306e\u306f\u610f\u5916\u3067\u3059\u304c\u3001\u3053\u308c\u306f\u304a\u305d\u3089\u304fjemalloc\u304c\u30b9\u30af\u30e9\u30c3\u30c1\u304b\u3089\u66f8\u304d\u8d77\u3053\u3055\u308c\u305f\u3068\u304d\u306bC99\u306b\u53b3\u683c\u306b\u6e96\u62e0\u3057\u305f\u306e\u3060\u3068\u601d\u3044\u307e\u3059\u3002\u73fe\u5728\u306e\u30c9\u30e9\u30d5\u30c8\u306f\u3001\u5b9f\u88c5\u304c\u6df7\u5728\u3057\u3066\u3044\u308b\u3053\u306e\u73fe\u72b6\u3092\u8ffd\u8a8d\u3059\u308b\u5f62\u3067\u5b9a\u3081\u3089\u308c\u305f\u3088\u3046\u3067\u3059\u3002\n\n\u7d50\u8ad6\n\u3068\u3044\u3046\u308f\u3051\u3067\u3001realloc\u306e\u7b2c\u4e8c\u5f15\u6570\u306b0\u3092\u6e21\u3057\u3066\u306f\u3044\u3051\u307e\u305b\u3093\u3002C99\u4ee5\u964d\u306e\u73fe\u5728\u306e\u4e16\u754c\u3067\u306f\u3001\u524d\u7bc0\u3067\u8ff0\u3079\u305f\u901a\u308a\u3001\u5b9f\u88c5\u306b\u3088\u3063\u3066\u4ed5\u69d8\u304c\u5206\u88c2\u3057\u3066\u3044\u308b\u305f\u3081\u3001\u30e1\u30e2\u30ea\u30ea\u30fc\u30af\u3057\u306a\u3044\u3088\u3046\u306b\u3059\u308b\u30dd\u30fc\u30bf\u30d6\u30eb\u306a\u65b9\u6cd5\u304c\u5b58\u5728\u3057\u306a\u3044\u304b\u3089\u3067\u3059\u3002\n\u305d\u3082\u305d\u3082\u3001realloc\u3068\u3044\u3046\u306e\u306f\u4f7f\u3044\u65b9\u3092\u9593\u9055\u3048\u3084\u3059\u3044\u95a2\u6570\u3067\u3001\n\n\u6e21\u3057\u305fptr\u3068\u623b\u308a\u5024\u304c\u9055\u3046\u5834\u5408\u306e\u6271\u3044\u3092\u30df\u30b9\u3059\u308b\n\u610f\u56f3\u7684\u3067\u306f\u306a\u304f\u3001\u3046\u3063\u304b\u308a\u7b2c\u4e8c\u5f15\u6570\u306b0\u3092\u6e21\u3057\u3066\u3057\u307e\u3046\nNULL\u304c\u8fd4\u3063\u3066\u304d\u305f\u5834\u5408\u306e\u6271\u3044\u3092\u30df\u30b9\u3059\u308b\n\n\u3068\u3044\u3046\u30d0\u30b0\u3092\u826f\u304f\u898b\u304b\u3051\u307e\u3059\u3002\u7d50\u679c\u3068\u3057\u3066\u3001\u826f\u304f\u3066DoS\u3001\u60aa\u304f\u3066\u4efb\u610f\u30b3\u30fc\u30c9\u5b9f\u884c\u306e\u8106\u5f31\u6027\u306e\u6e29\u5e8a\u306b\u306a\u3063\u3066\u304d\u305f\u308a\u3057\u3066\u304d\u307e\u3057\u305f\u3002realloc\u3092\u4f7f\u3046\u3068\u304d\u306f\u5341\u5206\u306b\u6ce8\u610f\u3057\u307e\u3057\u3087\u3046\u306d\u3002\n\n\u4f59\u8ac71: \u898f\u683c\u306e\u6587\u8a00\u306e\u5909\u9077\n\nC90/C95\n\u3061\u3087\u3063\u3068\u624b\u5143\u306bISO C:1990/1995\u306e\u898f\u683c\u66f8\u304c\u306a\u3044\u305f\u3081\u3001\u300c\u6a19\u6e96C\u30e9\u30a4\u30d6\u30e9\u30ea ANSI/ISO/JIS C\u898f\u683c(P.J.\u30d7\u30e9\u30a6\u30ac\u30fc\u8457\u30fb\u798f\u5bcc\u5bdb\u3001\u9580\u5009\u660e\u5f66\u3001\u6e05\u6c34\u6075\u4ecb\u8a33)\u300d\u304b\u3089realloc\u306e\u5b9a\u7fa9\u3092\u5f15\u7528\u3057\u307e\u3059(\u3053\u306e\u672c\u306e\u300cC\u898f\u683c\u306b\u304a\u3051\u308b\u5b9a\u7fa9\u300d\u30bb\u30af\u30b7\u30e7\u30f3\u306f\u3001JIS C:1993\u306e\u898f\u683c\u66f8\u304b\u3089\u306e\u8ee2\u8f09\u3068\u306a\u3063\u3066\u3044\u308b\u306e\u3067\u3001\u5185\u5bb9\u306b\u95a2\u3057\u3066\u306fISO C:1990/1995\u3068\u7b49\u4fa1\u3067\u3059):\n\n7.10.3.4 realloc \u95a2\u6570\n\u5f62\u5f0f\n#include <stdlib.h>\nvoid *realloc(void *ptr, size_t size);\n\n\u6a5f\u80fd\n\u3000realloc\u95a2\u6570\u306f\u3001ptr\u304c\u6307\u3059\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306e\u5927\u304d\u3055\u3092\u3001size\u304c\u793a\u3059\u5927\u304d\u3055\u306b\u5909\u66f4\u3059\u308b\u3002\u65b0\u3057\u3044\u5927\u304d\u3055\u3068\u53e4\u3044\u5927\u304d\u3055\u306e\u5c0f\u3055\u3044\u65b9\u307e\u3067\u306e\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306e\u5185\u5bb9\u306f\u3001\u5909\u66f4\u3057\u306a\u3044\u3002\u65b0\u3057\u3044\u5927\u304d\u3055\u306e\u307b\u3046\u304c\u5927\u304d\u3044\u3068\u304d\u3001\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306e\u65b0\u3057\u304f\u5272\u308a\u4ed8\u3051\u3089\u308c\u305f\u90e8\u5206\u306e\u5024\u306f\u3001\u4e0d\u5b9a\u3068\u3059\u308b\u3002ptr\u304c\u7a7a\u30dd\u30a4\u30f3\u30bf\u306e\u3068\u304d\u3001realloc\u95a2\u6570\u306f\u3001\u6307\u5b9a\u3055\u308c\u305f\u5927\u304d\u3055\u3067\u306emalloc\u95a2\u6570\u3068\u540c\u3058\u52d5\u4f5c\u3092\u3059\u308b\u3002\u305d\u308c\u4ee5\u5916\u306e\u5834\u5408\u3001ptr\u304ccalloc\u95a2\u6570\u3001malloc\u95a2\u6570\u3082\u3057\u304f\u306frealloc\u95a2\u6570\u306e\u547c\u51fa\u3057\u306b\u3088\u3063\u3066\u4ee5\u524d\u306b\u8fd4\u3055\u308c\u305f\u30dd\u30a4\u30f3\u30bf\u3068\u4e00\u81f4\u3057\u306a\u3044\u3068\u304d\u3001\u307e\u305f\u306f\u9818\u57df\u304cfree\u95a2\u6570\u3082\u3057\u304f\u306frealloc\u95a2\u6570\u306e\u547c\u51fa\u3057\u306b\u3088\u3063\u3066\u89e3\u653e\u3055\u308c\u3066\u3044\u308b\u3068\u304d\u3001\u305d\u306e\u52d5\u4f5c\u306f\u672a\u5b9a\u7fa9\u3068\u3059\u308b\u3002\u9818\u57df\u306e\u5272\u4ed8\u3051\u304c\u3067\u304d\u306a\u304b\u3063\u305f\u3068\u304d\u3001ptr\u304c\u6307\u3059\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306f\u5909\u5316\u3057\u306a\u3044\u3002size\u304c0\u3067\u304b\u3064ptr\u304c\u7a7a\u30dd\u30a4\u30f3\u30bf\u3067\u306a\u3044\u3068\u304d\u3001ptr\u304c\u6307\u3059\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u958b\u653e\u3059\u308b\u3002\n\u8fd4\u5374\u5024\n\u3000realloc\u95a2\u6570\u306f\u3001\u7a7a\u30dd\u30a4\u30f3\u30bf\u307e\u305f\u306f\u5272\u308a\u4ed8\u3051\u305f\u9818\u57df\u3078\u306e\u30dd\u30a4\u30f3\u30bf\u306e\u3069\u3061\u3089\u304b\u3092\u8fd4\u3059\u3002\u305f\u3060\u3057\u3001\u5272\u308a\u4ed8\u3051\u305f\u9818\u57df\u306f\u3001\u4ee5\u524d\u306e\u4f4d\u7f6e\u3068\u540c\u3058\u3067\u3042\u308b\u3068\u306f\u9650\u3089\u306a\u3044\u3002\n\n\u672c\u6587\u4e2d\u3001\u79c1\u304c\u592a\u5b57\u3067\u5f37\u8abf\u3057\u305f\u90e8\u5206\u304c\u3001\u4eca\u56de\u306e\u8a71\u984c\u306b\u95a2\u4fc2\u3059\u308b\u3068\u3053\u308d\u3067\u3059\u3002\n\nC99/C11\nANSI/ISO/IEC/9899-1999\u304b\u3089\u306e\u5f15\u7528\u3067\u3059:\n\n7.20.3 Memory management functions\n(\u4e2d\u7565)\nIf the size of the space requested is zero, the behavior is implementationdefined: either a null pointer is returned, or the behavior is as if the size were some nonzero value, except that the returned pointer shall not be used to access an object.\n(\u4e2d\u7565)\n7.20.3.4 The realloc function\nSynopsis\n#include <stdlib.h>\nvoid *realloc(void *ptr, size_t size);\n\nDescription\nThe realloc function deallocates the old object pointed to by ptr and returns a pointer to a new object that has the size specified by size. The contents of the new object shall be the same as that of the old object prior to deallocation, up to the lesser of the new and old sizes. Any bytes in the new object beyond the size of the old object have indeterminate values.\nIf ptr is a null pointer, the realloc function behaves like the malloc function for the specified size. Otherwise, if ptr does not match a pointer earlier returned by the calloc, malloc, or realloc function, or if the space has been deallocated by a call to the free or realloc function, the behavior is undefined. If memory for the new object cannot be allocated, the old object is not deallocated and its value is unchanged.\nReturns\nThe realloc function returns a pointer to the new object (which may have the same value as a pointer to the old object), or a null pointer if the new object could not be allocated.\n\n\u672c\u6587\u4e2d\u3001\u79c1\u304c\u592a\u5b57\u3067\u5f37\u8abf\u3057\u305f\u90e8\u5206\u304c\u3001\u4eca\u56de\u306e\u8a71\u984c\u306b\u95a2\u4fc2\u3059\u308b\u3068\u3053\u308d\u3067\u3059\u3002\n\n\u73fe\u5728\u306e\u30c9\u30e9\u30d5\u30c8\n\u5148\u307b\u3069\u7d39\u4ecb\u3057\u305fDR#400\u306e\u3088\u3046\u306b\u5909\u66f4\u3055\u308c\u307e\u3059:\n\n7.22.3 Memory management functions\n7.22.3.5 The realloc function\nIf memory for the new object cannot be allocated, the old object is not deallocated and its value is unchanged.\n\u2193\nIf size is non-zero and memory for the new object is not allocated, the old object is not deallocated. If size is zero and memory for the new object is not allocated, it is implementation-defined whether the old object is deallocated. If the old object is not deallocated, its value shall be unchanged.\n\nThe realloc function returns a pointer to the new object (which may have the same value as a pointer to the old object), or a null pointer if the new object could not be allocated.\n\u2193\nThe realloc function returns a pointer to the new object (which may have the same value as a pointer to the old object), or a null pointer if the new object has not been allocated.\n\n7.31 Future library directions\n7.31.12 General utilities <stdlib.h>\nInvoking realloc with a size argument equal to zero is an obsolescent feature.\n\n\u5909\u66f4\u70b9\u3092\u592a\u5b57\u3067\u5f37\u8abf\u3057\u3066\u304a\u304d\u307e\u3057\u305f\u3002\u904e\u53bb\u306b\u6ce8\u91c8\u306a\u3057\u306b\u884c\u3063\u305f\u975e\u4e92\u63db\u306a\u5909\u66f4\u3092\u300cobsolescent\u300d\u3067\u6e08\u307e\u305b\u305f\u3088\u3053\u306e\u5b50\u3002\n\n\u4f59\u8ac72: C99\u3067\u4f55\u304c\u8d77\u3053\u3063\u305f\u306e\u304b\n\u73fe\u5728\u306eC Standard Committee\u306e\u8b70\u8ad6\u306e\u5185\u5bb9\u306f\u6bd4\u8f03\u7684\u3088\u304f\u516c\u958b\u3055\u308c\u3066\u3044\u308b\u305f\u3081\u3001\u305f\u3068\u3048\u3070\u5148\u307b\u3069\u306eDR#400\u304c\u3069\u306e\u3088\u3046\u306a\u8b70\u8ad6\u3092\u7d4c\u3066\u6c7a\u5b9a\u3055\u308c\u305f\u306e\u304b\u306f2\u3064\u306e\u8b70\u4e8b\u9332(N1603(PDF), N1642(PDF))\u3092\u898b\u308b\u3068\u5206\u304b\u308a\u307e\u3059\u3002\u3057\u304b\u3057\u3001C99\u306e\u3053\u308d\u306e\u8b70\u4e8b\u9332\u306f\u3082\u3063\u3068\u5927\u96d1\u628a\u3067\u3001\u3057\u304b\u3082\u307b\u3068\u3093\u3069\u30c9\u30e9\u30d5\u30c8\u304c\u516c\u958b\u3055\u308c\u3066\u3044\u306a\u3044\u305f\u3081\u3001\u3044\u3064\u3001\u3069\u306e\u6bb5\u968e\u3067\u5909\u66f4\u304c\u884c\u308f\u308c\u305f\u306e\u304b\u306f\u826f\u304f\u5206\u304b\u3089\u306a\u3044\u90e8\u5206\u304c\u3042\u308a\u307e\u3059\u3002\n\u79c1\u304c\u8abf\u3079\u305f\u9650\u308a\u3001\u6b21\u306e\u3053\u3068\u304c\u5206\u304b\u308a\u307e\u3057\u305f:\n\n\n1998\u5e748\u67083\u65e5\u306e\u30c9\u30e9\u30d5\u30c8(N843)\u3067\u306f\u3001\u307e\u3060If the realloc function returns a  null  pointer when  size is zero and ptr is not a null pointer, the object it pointed to has been freed.\u306e\u6587\u8a00\u304c\u3042\u308b\u3002\n1998\u5e7410\u67085-9\u65e5\u306eSanta Cruz\u306b\u304a\u3051\u308b\u4f1a\u5408\u306e\u8b70\u4e8b\u9332\u306b\u3001\u300crealloc rewording\u300d\u306e\u6587\u5b57\u304c\u3042\u308b\u3002(Status of approved proposals for C9X, FCD (Pre-Portland)(N858))\n\n\u3053\u306e\u300crewording\u300d\u3067\u3001\u300crewording\u300d\u3067\u306f\u6e08\u307e\u306a\u3044\u5909\u66f4\u304c\u884c\u308f\u308c\u305f\u306e\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u3002\n\u554f\u984c\u306f\u3001\u3053\u306e\u5909\u66f4\u304c\u610f\u56f3\u7684\u306a\u306e\u304b\u3001\u305d\u308c\u3068\u3082\u4f55\u3089\u304b\u306e\u9593\u9055\u3044\u306a\u306e\u304b\u3068\u3044\u3046\u3053\u3068\u306a\u306e\u3067\u3059\u304c\u3001C99\u306eAnnex J (informative) Portability issues\u3068\u3044\u3046\u7ae0\u3067\u793a\u3055\u308c\u3066\u3044\u308b\u300cunspecified behavior\u300d\u306e\u5217\u6319\u306e\u4e2d\u306b\u3001\u6b21\u306e\u4e00\u6587\u304c\u3042\u308a\u307e\u3059:\nThe amount of storage allocated by a successful call to the calloc, malloc, or\nrealloc function when 0 bytes was requested (7.20.3).\n\u3053\u3053\u306f\u898f\u683c\u672c\u4f53\u3067\u306f\u306a\u304f\u5358\u306a\u308b\u53c2\u8003\u60c5\u5831\u3067\u3059\u304c\u3001\u308f\u3056\u308f\u3056\u3053\u306e\u3088\u3046\u306b\u660e\u8a18\u3057\u3066\u3042\u308b\u3068\u3044\u3046\u3053\u3068\u306f\u3001size\u304c0\u306e\u5834\u5408\u306e\u52d5\u4f5c\u304c\u4e00\u3064\u306b\u5b9a\u307e\u3089\u306a\u3044(=free\u3068\u7b49\u4fa1\u3060\u3063\u305fC95\u307e\u3067\u3068\u306f\u660e\u78ba\u306b\u975e\u4e92\u63db\u3067\u3042\u308b)\u3053\u3068\u3092\u627f\u77e5\u306e\u4e0a\u3067\u3001\u3042\u306e\u3088\u3046\u306a\u898f\u683c\u672c\u6587\u306b\u3057\u305f\u3068\u3044\u3046\u308f\u3051\u3067\u3059 2016-12-14\u8ffd\u8a18:\u30b3\u30e1\u30f3\u30c8\u3067C90\u898f\u683c\u304b\u3089\u306e\u5f15\u7528\u3092\u3057\u3066\u3044\u305f\u3060\u3044\u3066\u307e\u3059\u304c\u3001\u4f55\u6545\u304bC90\u306b\u3082\u540c\u69d8\u306e\u8a18\u8ff0\u304c\u3042\u3063\u305f\u306e\u3067\u3001\u3053\u306e\u8a18\u8ff0\u3092\u3082\u3063\u3066\u300c\u610f\u56f3\u7684\u3067\u3042\u308b\u300d\u3068\u3059\u308b\u6839\u62e0\u304c\u5168\u304f\u7121\u304f\u306a\u308a\u307e\u3057\u305f\u3002\u3068\u3044\u3046\u304bC90\u306e\u6821\u6b63\u3082\u30ac\u30d0\u30ac\u30d0\u3084\u3093\u3051\u3002\n\u3057\u304b\u3057\u306a\u304c\u3089\u4e00\u65b9\u3067\u3001C\u8a00\u8a9e\u306e\u6a19\u6e96\u5316\u59d4\u54e1\u4f1a\u306e\u51fa\u3057\u3066\u3044\u308bRationale for International Standard \u2014 Programming Languages \u2014 C Revision 5.10 April-2003 (PDF)\u3068\u3044\u3046\u6587\u66f8\u306b\u306f\u3001\u898f\u683c\u66f8\u3068\u306f\u77db\u76fe\u3057\u305f\u3053\u3068\u304c\u66f8\u3044\u3066\u3042\u308a\u307e\u3059:\nIf the first argument is not null, and the second argument is 0, then the call frees the memory pointed to by the first argument, and a null argument may be returned; C99 is consistent with the policy of not allowing zero-sized objects.\n\u5f53\u7136\u3001Rationale\u306b\u306f\u898f\u683c\u3068\u3057\u3066\u306e\u52b9\u529b\u306f\u306a\u3044\u306e\u3067\u3001\u898f\u683c\u672c\u6587\u306e\u65b9\u304c\u512a\u5148\u3055\u308c\u307e\u3059\u304c\u3001\u305b\u3063\u304b\u304fRationale\u3092\u7528\u610f\u3057\u3066\u304a\u304d\u306a\u304c\u3089\u3001\u300c\u306a\u305c\u305d\u3046\u3044\u3046\u5909\u66f4\u3092\u884c\u3063\u305f\u306e\u304b\u300d\u304c\u66f8\u304b\u308c\u3066\u3044\u306a\u3044\u306e\u307f\u306a\u3089\u305a\u3001\u898f\u683c\u3068\u77db\u76fe\u3057\u305f\u3053\u3068\u304c\u66f8\u304b\u308c\u3066\u3044\u308b\u306e\u306f\u56f0\u3063\u305f\u3082\u306e\u3067\u3059\u306d\u3002\n\n\u811a\u6ce8\n\n\n\n\n\u306a\u304a\u3001\u3053\u306e\u8a71\u306f\u3082\u3068\u3082\u3068\u30c4\u30a4\u30c3\u30bf\u30fc\u3067\u3084\u3063\u3066\u305f\u3082\u306e\u3092\u8a18\u4e8b\u3068\u3057\u3066\u66f8\u304d\u8d77\u3053\u3057\u305f\u3082\u306e\u3067\u3059\u3002\u307e\u3068\u3081\u00a0\u21a9\n\n\n\n# \u4e09\u884c\u3067\u983c\u3080[^1]\n\n\n[^1]: \u306a\u304a\u3001\u3053\u306e\u8a71\u306f\u3082\u3068\u3082\u3068\u30c4\u30a4\u30c3\u30bf\u30fc\u3067\u3084\u3063\u3066\u305f\u3082\u306e\u3092\u8a18\u4e8b\u3068\u3057\u3066\u66f8\u304d\u8d77\u3053\u3057\u305f\u3082\u306e\u3067\u3059\u3002[\u307e\u3068\u3081](http://togetter.com/li/1056979)\n\n- **realloc(ptr, 0)\u304cfree(ptr)\u3068\u7b49\u4fa1\u3060\u3063\u305f\u306e\u306f\u904e\u53bb\u306e\u8a71**\n- realloc\u306e\u7b2c\u4e8c\u5f15\u6570\u306f\u7d76\u5bfe\u306b0\u306b\u3059\u308b\u306a\n- ISO C\u3082POSIX\u3082\u4fe1\u7528\u3059\u308b\u306a\n\n\u3053\u308c\u306f[C\u8a00\u8a9e Advent Calendar 2016](http://qiita.com/advent-calendar/2016/the-c-programming-language)\u306e14\u65e5\u76ee\u306e\u8a18\u4e8b\u3067\u3059\u3002\n\n# \u8a71\u306e\u6795\n\n\u79c1\u304c\u3053\u3068\u3042\u308b\u3054\u3068\u306b\u8a00\u3063\u3066\u3044\u308b\u6301\u3061\u30cd\u30bf\u3068\u3057\u3066\u3001**bzero\u95a2\u6570\u3092\u524a\u9664\u3059\u308b\u306a**\u3063\u3066\u306e\u304c\u3042\u308a\u307e\u3059\u3002bzero\u95a2\u6570\u306fISO C\u306e\u6a19\u6e96\u95a2\u6570\u3067\u306f\u3042\u308a\u307e\u305b\u3093\u304c\u3001X/Open\u3068\u3044\u3046\u53e4\u306e\u898f\u683c\u56e3\u4f53\u304c\u5b9a\u7fa9\u3057\u3066\u3044\u305f\u3082\u306e\u3067\u3001\u73fe\u5728\u3067\u3082UNIX\u7cfbOS\u3067\u306f\u666e\u901a\u306b\u4f7f\u3048\u307e\u3059\u3002\u3053\u308c\u306f\u3001\u6307\u5b9a\u3055\u308c\u305f\u30e1\u30e2\u30ea\u30d6\u30ed\u30c3\u30af\u3092\u5358\u7d14\u306b\u30bc\u30ed\u30d0\u30a4\u30c8\u3067\u30af\u30ea\u30a2\u3059\u308b\u305f\u3081\u306e\u95a2\u6570\u3067\u3059\u3002\u305f\u3068\u3048\u3070\u6b21\u306e\u3088\u3046\u306b\u3057\u3066\u4f7f\u3044\u307e\u3059:\n\n```c\n#include <strings.h>\n\n    char buf[42];\n    bzero(buf, sizeof (buf));\n```\n\n\u6a19\u6e96C\u8a00\u8a9e\u306b\u89aa\u3057\u3093\u3067\u3044\u308b\u4eba\u9593\u306a\u3089\u3070\u5206\u304b\u308b\u3068\u601d\u3044\u307e\u3059\u304c\u3001\u3053\u308c\u306f\u3088\u308a\u6c4e\u7528\u7684\u306a\u95a2\u6570\u3067\u3042\u308b\u3068\u3053\u308d\u306ememset\u3092\u4f7f\u3063\u3066\u6b21\u306e\u3088\u3046\u306b\u66f8\u304f\u3053\u3068\u304c\u3067\u304d\u307e\u3059:\n\n```c\n#include <string.h>\n\n    char buf[42];\n    memset(buf, 0, sizeof (buf));\n```\n\n\u300c\u3058\u3083\u3042bzero\u306a\u3093\u3066\u8981\u3089\u306a\u3044\u3093\u3058\u3083\u306a\u3044\u306e\uff1f\u300d\u3068\u3044\u3046\u610f\u898b\u3082\u307e\u3042\u3082\u3063\u3068\u3082\u306a\u306e\u3067\u3059\u304c\u3001\u3057\u304b\u3057\u306a\u304c\u3089\u3001**memset\u95a2\u6570\u306e99%\u306f\u30bc\u30ed\u30af\u30ea\u30a2\u306e\u305f\u3081\u306b\u4f7f\u308f\u308c\u308b**\u3068\u8a00\u3063\u3066\u3082\u904e\u8a00\u3067\u306f\u306a\u3044\u306e\u3067\u306f\u306a\u3044\u304b\u3068\u601d\u3046\u307b\u3069\u3001\u3053\u306e\u95a2\u6570\u306e\u7b2c\u4e8c\u5f15\u6570\u306f0\u306e\u3053\u3068\u304c\u591a\u3044\u3068\u601d\u3044\u307e\u3059\u3002\u3057\u304b\u3082\u3001**memset\u95a2\u6570\u306e\u7b2c\u4e8c\u5f15\u6570\u3068\u7b2c\u4e09\u5f15\u6570\u306f\u975e\u5e38\u306b\u7d1b\u3089\u308f\u3057\u3044**\u305f\u3081\u3001\u3057\u3070\u3057\u3070\u53d6\u308a\u9055\u3048\u3089\u308c\u308b\u30d0\u30b0\u306e\u6e29\u5e8a\u3068\u306a\u308a\u307e\u3059\u3002\n\n\u3057\u305f\u304c\u3063\u3066\u3001\u79c1\u306a\u3093\u305e\u306f\u30bc\u30ed\u30af\u30ea\u30a2\u5c02\u7528\u306e\u95a2\u6570\u3092\u7528\u610f\u3057\u3066\u304a\u3044\u3066\u3082\u30d0\u30c1\u306f\u5f53\u305f\u3089\u306a\u3044\u3068\u601d\u3046\u306e\u3067\u3059\u304c\u3001\u305d\u3046\u3044\u3046\u610f\u898b\u3092reject\u3059\u308b\u6642\u306b\u5fc5\u305a\u4f7f\u308f\u308c\u308b\u5370\u7c60\u306e\u3088\u3046\u306a\u8a00\u8449\u304c\u3042\u308a\u307e\u3059\u3002\u305d\u308c\u304c**\u76f4\u4ea4\u6027**\u3068\u3044\u3046\u8003\u3048\u65b9\u3067\u3059\u3002\u3064\u307e\u308a\u3001**\u6a19\u6e96\u95a2\u6570\u3068\u3057\u3066\u306f\u3001\u6a5f\u80fd\u304c\u91cd\u8907\u3057\u306a\u3044(=\u76f4\u4ea4\u3057\u305f)\u30df\u30cb\u30de\u30eb\u306a\u95a2\u6570\u30bb\u30c3\u30c8\u3060\u3051\u3092\u7528\u610f\u3057\u3066\u3001\u30d7\u30ed\u30b0\u30e9\u30de\u306b\u306f\u305d\u306e\u7d44\u307f\u5408\u308f\u305b\u3067\u3042\u3089\u3086\u308b\u3053\u3068\u3092\u5b9f\u73fe\u3055\u305b\u3088\u3046**\u3068\u3044\u3046\u8003\u3048\u65b9\u3067\u3059\u3002\u3053\u308c\u306b\u5f93\u3048\u3070\u3001\u300c\u65e2\u306bmemset\u95a2\u6570\u3067\u3067\u304d\u308b\u3053\u3068\u306e\u305f\u3081\u306b\u3001\u65b0\u3057\u304f\u95a2\u6570\u3092\u7528\u610f\u3059\u308b\u5fc5\u8981\u306f\u306a\u3044\u306e\u3060\u300d\u3068\u3044\u3046\u3053\u3068\u3067\u3059\u306d\u3002POSIX\u3082\u305d\u3046\u3044\u3046\u601d\u60f3\u306b\u6bd2\u3055\u308c\u3066\u3044\u308b\u90e8\u5206\u304c\u3042\u308b\u305f\u3081\u3001\u54c0\u308cbzero\u95a2\u6570\u306fPOSIX:2004\u3067\u5ec3\u6b62\u4e88\u5b9a\u3068\u3055\u308c\u3001POSIX:2008\u3067\u846c\u308a\u53bb\u3089\u308c\u305f\u3068\u3044\u3046\u308f\u3051\u3067\u3059\u3002\u307e\u3042\u3001\u3042\u3093\u307e\u308a\u540d\u524d\u3082\u826f\u304f\u306a\u304b\u3063\u305f\u3057\u3001\\<strings.h\\>\u306a\u3093\u3066VAX\u6642\u4ee3\u306e\u907a\u7269\u307f\u305f\u3044\u306a\u30d8\u30c3\u30c0\u30d5\u30a1\u30a4\u30eb\u3092\u30a4\u30f3\u30af\u30eb\u30fc\u30c9\u3057\u306a\u3044\u3068\u3044\u3051\u306a\u304b\u3063\u305f\u3057\u3067\u3001\u4ed5\u65b9\u304c\u306a\u3044\u304b\u306a\u3042\u3001\u3068\u3044\u3046\u5074\u9762\u3082\u3042\u308a\u307e\u3059\u304c\u3002\u4e00\u65b9\u305d\u306e\u9803Win32\u306fZeroMemory\u30de\u30af\u30ed\u3092\u4f7f\u3044\u7d9a\u3051\u305f\u3002\n\n\u3067\u3082\u3001\u76f4\u4ea4\u6027\u306b\u62d8\u308b\u306e\u3067\u3042\u308c\u3070\u3001\u65e2\u306bISO C\u306b\u306f\u76f4\u4ea4\u6027\u3092\u6b20\u3044\u305f\u5197\u9577\u306a\u95a2\u6570\u7fa4\u304c\u5b58\u5728\u3057\u3066\u3044\u307e\u3057\u305f\u3002\u305d\u308c\u306f\u3001malloc/realloc/calloc/free\u3067\u3059\u3002\u3053\u308c\u3089\u306f\u3001**ISO C:1995(C95)\u307e\u3067\u306f**\u3059\u3079\u3066realloc\u3068memset\u306e\u7d44\u307f\u5408\u308f\u305b\u3067\u8868\u73fe\u53ef\u80fd\u3067\u3057\u305f:\n\n```c\nptr = realloc(NULL, size);  /* malloc(size) \u3068\u7b49\u4fa1 */\nrealloc(ptr, 0);            /* free(ptr) \u3068\u7b49\u4fa1 */\n\n/* \u4ee5\u4e0b\u306fcalloc(memb, size)\u3068\u7b49\u4fa1(\u305f\u3060\u3057\u639b\u3051\u7b97\u306e\u30aa\u30fc\u30d0\u30fc\u30d5\u30ed\u30fc\u6642\u306e\u632f\u308b\u821e\u3044\u3092\u9664\u304f) */\nptr = realloc(NULL, memb*size);\nif (ptr)\n    memset(ptr, 0, memb*size);\n```\n\n\u3057\u305f\u304c\u3063\u3066\u3001malloc\u3082calloc\u3082free\u3082\u5197\u9577\u306a\u5b58\u5728\u3060\u3063\u305f\u306e\u3067\u3059\u3002\n\n# realloc(ptr, 0)\u306e\u5909\u9077\n\n\u307e\u3042\u3001\u3053\u3053\u307e\u3067\u306f\u8a71\u306e\u6795\u3068\u3044\u3046\u3053\u3068\u3067\u3001\u5225\u306bbzero\u3082\u76f4\u4ea4\u6027\u3082\u3069\u3046\u3067\u3082\u3088\u304f\u3066\u3001\u672c\u984c\u306frealloc\u306e\u4ed5\u69d8\u306b\u3064\u3044\u3066\u3067\u3059\u3002\u4e0a\u3067\u66f8\u3044\u305frealloc\u306e\u4e07\u80fd\u6027\u306f\u3001\u5b9f\u306f\u904e\u53bb\u306e\u3082\u306e\u3067\u3059\u3002\u73fe\u884c\u898f\u683c\u3067\u3042\u308bISO C:2011(C11)\u3084\u3001\u305d\u306e\u4e00\u3064\u524d\u306eISO C:1999(C99)\u3078\u3068\u53b3\u683c\u306b\u6e96\u62e0\u3057\u305frealloc\u306b\u306f\u3001free\u3068\u7b49\u4fa1\u306a\u6a5f\u80fd\u306f\u3042\u308a\u307e\u305b\u3093\u3002\n\n\u975eNULL\u306aptr\u306b\u5bfe\u3059\u308brealloc(ptr, 0)\u306e\u7d50\u679c\u306b\u306f\u6b21\u306e\u3088\u3046\u306a\u5909\u9077\u304c\u3042\u308a\u307e\u3059:\n\n**C90/C95**\nrealloc(ptr, 0)\u306fNULL\u3092\u8fd4\u3057\u3001ptr\u306f\u89e3\u653e\u3055\u308c\u308b\u3002\n\n**C99/C11**\nrealloc(ptr, 0)\u306f\u6b21\u306e\u3046\u3061\u306e\u3044\u305a\u308c\u304b\u3068\u306a\u308b:\n\n- NULL\u304c\u8fd4\u3055\u308c\u308b\u3002\u3053\u306e\u6642\u3001ptr\u306f\u89e3\u653e\u3055\u308c\u305a\u6709\u52b9\u306a\u30dd\u30a4\u30f3\u30bf\u3068\u3057\u3066\u6b8b\u3063\u3066\u3044\u308b\u3002\n- \u6709\u52b9\u306a\u30dd\u30a4\u30f3\u30bf\u304c\u8fd4\u3055\u308c\u308b\u3002\u305d\u308c\u304cptr\u3068\u7b49\u3057\u3044\u3053\u3068\u3082\u3042\u308b\u3002\n\n**\u73fe\u5728\u306e\u30c9\u30e9\u30d5\u30c8**\nrealloc(ptr, 0)\u306f\u6b21\u306e\u3046\u3061\u306e\u3044\u305a\u308c\u304b\u3068\u306a\u308b:\n\n- NULL\u304c\u8fd4\u3055\u308c\u308b\u3002\u3053\u306e\u6642\u3001ptr\u304c\u89e3\u653e\u3055\u308c\u305a\u6709\u52b9\u306a\u30dd\u30a4\u30f3\u30bf\u3068\u3057\u3066\u6b8b\u308b\u304b\u3001\u305d\u308c\u3068\u3082\u89e3\u653e\u3055\u308c\u308b\u304b\u306f\u5b9f\u88c5\u4f9d\u5b58\u3067\u3042\u308b\u3002\n- \u6709\u52b9\u306a\u30dd\u30a4\u30f3\u30bf\u304c\u8fd4\u3055\u308c\u308b\u3002\u305d\u308c\u304cptr\u3068\u7b49\u3057\u3044\u3053\u3068\u3082\u3042\u308b\u3002\n\nC90/C95\u3068C99/C11\u306f\u5b8c\u5168\u306b\u77db\u76fe\u3057\u3066\u304a\u308a\u3001\u73fe\u5728\u306e\u30c9\u30e9\u30d5\u30c8\u306f\u3001\u3053\u306e\u4e21\u65b9\u3092\u6298\u8877\u3057\u305f\u3082\u306e\u3068\u306a\u3063\u3066\u304a\u308a\u307e\u3059\u3002\u7d50\u5c40\u3001\u3053\u306e\u4e8c\u5ea6\u306e\u5909\u66f4\u306f\u3001\u4e21\u65b9\u3068\u3082\u4e92\u63db\u6027\u3092\u7834\u58ca\u3057\u3066\u3044\u307e\u3059\u3002\u3064\u307e\u308a\u3001\n\n- **C90/C95 \u2192 C99/C11** realloc(ptr, 0)\u304cfree(ptr)\u3068\u7b49\u4fa1\u3067\u3042\u308b\u3068\u671f\u5f85\u3057\u3066\u3044\u308b(=\u6b63\u3057\u304fC90/C95\u306b\u6e96\u62e0\u3057\u305f)\u30d7\u30ed\u30b0\u30e9\u30e0\u304c\u7834\u58ca\u3055\u308c\u308b\u3002\n- **C99/C11 \u2192 \u73fe\u5728\u306e\u30c9\u30e9\u30d5\u30c8** NULL\u304c\u8fd4\u3063\u3066\u304d\u305f\u3068\u304d\u306bptr\u304c\u6709\u52b9\u306a\u30dd\u30a4\u30f3\u30bf\u3068\u3057\u3066\u6b8b\u3063\u3066\u3044\u308b\u3053\u3068\u306b\u671f\u5f85\u3057\u3066\u5f8b\u5100\u306bfree(ptr)\u3092\u547c\u3076(=\u6b63\u3057\u304fC99/C11\u306b\u6e96\u62e0\u3057\u305f)\u30d7\u30ed\u30b0\u30e9\u30e0\u304c\u7834\u58ca\u3055\u308c\u308b\u3002\n\n\u56f0\u3063\u305f\u3053\u3068\u3067\u3059\u306d\u3002\n\n\u307e\u3001**\u305d\u3082\u305d\u3082realloc\u3092free\u306e\u4ee3\u308f\u308a\u306b\u4f7f\u3046\u306a\u3088**\u3063\u3066\u8a71\u3067\u306f\u3042\u308b\u306e\u3067\u3059\u304c\u3001\u53e4\u304f\u304b\u3089C\u8a00\u8a9e\u3092\u4f7f\u3063\u3066\u3044\u308b\u4eba\u9593\u306b\u306f\u3001realloc(ptr, 0)\u304cfree(ptr)\u3068\u7b49\u4fa1\u3060\u3068\u3044\u3046\u306e\u306f\u534a\u3070\u5e38\u8b58\u5316\u3057\u3066\u3044\u305f\u5272\u306b\u3001\u305d\u308c\u304cC99\u3067\u7834\u58ca\u3055\u308c\u305f\u3068\u3044\u3046\u3053\u3068\u306f\u610f\u5916\u3068\u77e5\u3089\u308c\u3066\u306a\u3044\u306e\u3067\u306f\u306a\u3044\u304b\u3068\u601d\u3044\u307e\u3059\u3002\n\n# POSIX\u306f\u3069\u3046\u304b\n\nPOSIX\u3067\u3082\u73fe\u884c\u306ePOSIX:2008\u3067\u306f[C99\u3068\u540c\u69d8\u306e\u898f\u5b9a](http://pubs.opengroup.org/onlinepubs/9699919799/functions/realloc.html)\u306b\u306a\u3063\u3066\u3044\u307e\u3059\u3002\u4e00\u65b9\u3001POSIX:2004\u3067\u306f[C95\u3068\u540c\u69d8](http://pubs.opengroup.org/onlinepubs/009695399/functions/realloc.html)\u3068\u306a\u3063\u3066\u3044\u307e\u3057\u305f\u3002\u3057\u304b\u3057\u306a\u304c\u3089\u3001[POSIX:2004\u306eNormative Reference\u3068\u3055\u308c\u3066\u3044\u308b\u306e\u306fC99](http://pubs.opengroup.org/onlinepubs/009695399/basedefs/xbd_chap01.html#tag_01_03)\u3067\u3059\u306e\u3067\u3001\u3053\u308c\u306f\u5358\u7d14\u306aPOSIX:2004\u306e\u30df\u30b9\u3067\u3059\u306d\u3002\n\n# \u4e16\u306e\u4e2d\u306e\u5b9f\u88c5\u306f\u3069\u3046\u304b\n\n\u3082\u3068\u3082\u3068\u306e\u4ed5\u69d8\u304c\u300crealloc(ptr, 0)\u306ffree(ptr)\u3068\u7b49\u4fa1\u300d\u3067\u3059\u304b\u3089\u30011999\u5e74\u3054\u308d\u307e\u3067\u306erealloc\u5b9f\u88c5\u306e\u307b\u3068\u3093\u3069\u306f\u305d\u3046\u3044\u3046\u4ed5\u69d8\u3060\u3063\u305f\u3068\u601d\u3044\u307e\u3059\u304c\u3001C99\u306b\u304a\u3044\u3066\u4e92\u63db\u6027\u306e\u306a\u3044\u5909\u66f4\u304c\u3055\u308c\u3066\u3057\u307e\u3063\u3066\u3044\u308b\u306e\u3067\u3001\u3053\u3053\u3067\u4e16\u306e\u4e2d\u306e\u5b9f\u88c5\u3082\u300c\u904e\u53bb\u306e\u4e92\u63db\u6027\u3092\u5b88\u308b\u300d\u304b\u300cC99\u3092\u6e80\u305f\u3059\u300d\u304b\u306e\u4e8c\u8005\u629e\u4e00\u3092\u8feb\u3089\u308c\u308b\u3053\u3068\u306b\u306a\u308a\u307e\u3057\u305f\u3002[\u73fe\u884c\u306e\u898f\u683c\u30c9\u30e9\u30d5\u30c8\u306b\u5909\u66f4\u3055\u308c\u308b\u304d\u3063\u304b\u3051\u3068\u306a\u3063\u305fDefect Report #400](http://www.open-std.org/jtc1/sc22/wg14/www/docs/dr_400.htm)\u3067\u306f\u3001\u6b21\u306e3\u3064\u306e\u5b9f\u88c5\u304c\u7d39\u4ecb\u3055\u308c\u3066\u3044\u307e\u3059(ptr\u304c\u975eNULL\u306e\u5834\u5408\u306e\u307f\u3092\u629c\u7c8b\u3001errno\u306fISO C\u7684\u306b\u306f\u3042\u3093\u307e\u308a\u610f\u5473\u304c\u7121\u3044\u306e\u3067\u3053\u308c\u3082\u7701\u7565):\n\n- AIX : realloc(ptr, 0)\u306fNULL\u3092\u8fd4\u3057\u3001ptr\u3092\u89e3\u653e\u3059\u308b\n- BSD : realloc(ptr, 0)\u306fNULL\u3092\u8fd4\u3057\u3001ptr\u306f\u305d\u306e\u307e\u307e\u306b\u3059\u308b\n- glibc : realloc(ptr, 0)\u306fNULL\u3092\u8fd4\u3057\u3001ptr\u3092\u89e3\u653e\u3059\u308b\n\n\u3053\u306e\u4e09\u3064\u306e\u5b9f\u88c5\u3067\u306f\u3059\u3079\u3066NULL\u3092\u8fd4\u3057\u307e\u3059\u304c\u3001AIX\u3068glibc\u306fC90/C95\u306e\u3001BSD\u306fC99/C11\u306e\u4ed5\u69d8\u306b\u5f93\u3063\u3066\u3044\u307e\u3059\u3002BSD\u304cC99\u306b\u8ffd\u5f93\u3057\u3066\u3044\u308b\u306e\u306f\u610f\u5916\u3067\u3059\u304c\u3001\u3053\u308c\u306f\u304a\u305d\u3089\u304fjemalloc\u304c\u30b9\u30af\u30e9\u30c3\u30c1\u304b\u3089\u66f8\u304d\u8d77\u3053\u3055\u308c\u305f\u3068\u304d\u306bC99\u306b\u53b3\u683c\u306b\u6e96\u62e0\u3057\u305f\u306e\u3060\u3068\u601d\u3044\u307e\u3059\u3002\u73fe\u5728\u306e\u30c9\u30e9\u30d5\u30c8\u306f\u3001\u5b9f\u88c5\u304c\u6df7\u5728\u3057\u3066\u3044\u308b\u3053\u306e\u73fe\u72b6\u3092\u8ffd\u8a8d\u3059\u308b\u5f62\u3067\u5b9a\u3081\u3089\u308c\u305f\u3088\u3046\u3067\u3059\u3002\n\n# \u7d50\u8ad6\n\n\u3068\u3044\u3046\u308f\u3051\u3067\u3001**realloc\u306e\u7b2c\u4e8c\u5f15\u6570\u306b0\u3092\u6e21\u3057\u3066\u306f\u3044\u3051\u307e\u305b\u3093**\u3002C99\u4ee5\u964d\u306e\u73fe\u5728\u306e\u4e16\u754c\u3067\u306f\u3001\u524d\u7bc0\u3067\u8ff0\u3079\u305f\u901a\u308a\u3001\u5b9f\u88c5\u306b\u3088\u3063\u3066\u4ed5\u69d8\u304c\u5206\u88c2\u3057\u3066\u3044\u308b\u305f\u3081\u3001\u30e1\u30e2\u30ea\u30ea\u30fc\u30af\u3057\u306a\u3044\u3088\u3046\u306b\u3059\u308b\u30dd\u30fc\u30bf\u30d6\u30eb\u306a\u65b9\u6cd5\u304c\u5b58\u5728\u3057\u306a\u3044\u304b\u3089\u3067\u3059\u3002\n\n\u305d\u3082\u305d\u3082\u3001realloc\u3068\u3044\u3046\u306e\u306f\u4f7f\u3044\u65b9\u3092\u9593\u9055\u3048\u3084\u3059\u3044\u95a2\u6570\u3067\u3001\n\n- \u6e21\u3057\u305fptr\u3068\u623b\u308a\u5024\u304c\u9055\u3046\u5834\u5408\u306e\u6271\u3044\u3092\u30df\u30b9\u3059\u308b\n- \u610f\u56f3\u7684\u3067\u306f\u306a\u304f\u3001\u3046\u3063\u304b\u308a\u7b2c\u4e8c\u5f15\u6570\u306b0\u3092\u6e21\u3057\u3066\u3057\u307e\u3046\n- NULL\u304c\u8fd4\u3063\u3066\u304d\u305f\u5834\u5408\u306e\u6271\u3044\u3092\u30df\u30b9\u3059\u308b\n\n\u3068\u3044\u3046\u30d0\u30b0\u3092\u826f\u304f\u898b\u304b\u3051\u307e\u3059\u3002\u7d50\u679c\u3068\u3057\u3066\u3001\u826f\u304f\u3066DoS\u3001\u60aa\u304f\u3066\u4efb\u610f\u30b3\u30fc\u30c9\u5b9f\u884c\u306e\u8106\u5f31\u6027\u306e\u6e29\u5e8a\u306b\u306a\u3063\u3066\u304d\u305f\u308a\u3057\u3066\u304d\u307e\u3057\u305f\u3002**realloc\u3092\u4f7f\u3046\u3068\u304d\u306f\u5341\u5206\u306b\u6ce8\u610f\u3057\u307e\u3057\u3087\u3046\u306d**\u3002\n\n# \u4f59\u8ac71: \u898f\u683c\u306e\u6587\u8a00\u306e\u5909\u9077\n\n## C90/C95\n\n\u3061\u3087\u3063\u3068\u624b\u5143\u306bISO C:1990/1995\u306e\u898f\u683c\u66f8\u304c\u306a\u3044\u305f\u3081\u3001\u300c\u6a19\u6e96C\u30e9\u30a4\u30d6\u30e9\u30ea ANSI/ISO/JIS C\u898f\u683c(P.J.\u30d7\u30e9\u30a6\u30ac\u30fc\u8457\u30fb\u798f\u5bcc\u5bdb\u3001\u9580\u5009\u660e\u5f66\u3001\u6e05\u6c34\u6075\u4ecb\u8a33)\u300d\u304b\u3089realloc\u306e\u5b9a\u7fa9\u3092\u5f15\u7528\u3057\u307e\u3059(\u3053\u306e\u672c\u306e\u300cC\u898f\u683c\u306b\u304a\u3051\u308b\u5b9a\u7fa9\u300d\u30bb\u30af\u30b7\u30e7\u30f3\u306f\u3001JIS C:1993\u306e\u898f\u683c\u66f8\u304b\u3089\u306e\u8ee2\u8f09\u3068\u306a\u3063\u3066\u3044\u308b\u306e\u3067\u3001\u5185\u5bb9\u306b\u95a2\u3057\u3066\u306fISO C:1990/1995\u3068\u7b49\u4fa1\u3067\u3059):\n\n____\n**7.10.3.4 realloc \u95a2\u6570**\n**\u5f62\u5f0f**\n\n```c:\n#include <stdlib.h>\nvoid *realloc(void *ptr, size_t size);\n```\n\n**\u6a5f\u80fd**\n\u3000realloc\u95a2\u6570\u306f\u3001ptr\u304c\u6307\u3059\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306e\u5927\u304d\u3055\u3092\u3001size\u304c\u793a\u3059\u5927\u304d\u3055\u306b\u5909\u66f4\u3059\u308b\u3002\u65b0\u3057\u3044\u5927\u304d\u3055\u3068\u53e4\u3044\u5927\u304d\u3055\u306e\u5c0f\u3055\u3044\u65b9\u307e\u3067\u306e\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306e\u5185\u5bb9\u306f\u3001\u5909\u66f4\u3057\u306a\u3044\u3002\u65b0\u3057\u3044\u5927\u304d\u3055\u306e\u307b\u3046\u304c\u5927\u304d\u3044\u3068\u304d\u3001\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306e\u65b0\u3057\u304f\u5272\u308a\u4ed8\u3051\u3089\u308c\u305f\u90e8\u5206\u306e\u5024\u306f\u3001\u4e0d\u5b9a\u3068\u3059\u308b\u3002**ptr\u304c\u7a7a\u30dd\u30a4\u30f3\u30bf\u306e\u3068\u304d\u3001realloc\u95a2\u6570\u306f\u3001\u6307\u5b9a\u3055\u308c\u305f\u5927\u304d\u3055\u3067\u306emalloc\u95a2\u6570\u3068\u540c\u3058\u52d5\u4f5c\u3092\u3059\u308b**\u3002\u305d\u308c\u4ee5\u5916\u306e\u5834\u5408\u3001ptr\u304ccalloc\u95a2\u6570\u3001malloc\u95a2\u6570\u3082\u3057\u304f\u306frealloc\u95a2\u6570\u306e\u547c\u51fa\u3057\u306b\u3088\u3063\u3066\u4ee5\u524d\u306b\u8fd4\u3055\u308c\u305f\u30dd\u30a4\u30f3\u30bf\u3068\u4e00\u81f4\u3057\u306a\u3044\u3068\u304d\u3001\u307e\u305f\u306f\u9818\u57df\u304cfree\u95a2\u6570\u3082\u3057\u304f\u306frealloc\u95a2\u6570\u306e\u547c\u51fa\u3057\u306b\u3088\u3063\u3066\u89e3\u653e\u3055\u308c\u3066\u3044\u308b\u3068\u304d\u3001\u305d\u306e\u52d5\u4f5c\u306f\u672a\u5b9a\u7fa9\u3068\u3059\u308b\u3002\u9818\u57df\u306e\u5272\u4ed8\u3051\u304c\u3067\u304d\u306a\u304b\u3063\u305f\u3068\u304d\u3001ptr\u304c\u6307\u3059\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306f\u5909\u5316\u3057\u306a\u3044\u3002**size\u304c0\u3067\u304b\u3064ptr\u304c\u7a7a\u30dd\u30a4\u30f3\u30bf\u3067\u306a\u3044\u3068\u304d\u3001ptr\u304c\u6307\u3059\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u958b\u653e\u3059\u308b\u3002**\n\n**\u8fd4\u5374\u5024**\n\u3000realloc\u95a2\u6570\u306f\u3001\u7a7a\u30dd\u30a4\u30f3\u30bf\u307e\u305f\u306f\u5272\u308a\u4ed8\u3051\u305f\u9818\u57df\u3078\u306e\u30dd\u30a4\u30f3\u30bf\u306e\u3069\u3061\u3089\u304b\u3092\u8fd4\u3059\u3002\u305f\u3060\u3057\u3001\u5272\u308a\u4ed8\u3051\u305f\u9818\u57df\u306f\u3001\u4ee5\u524d\u306e\u4f4d\u7f6e\u3068\u540c\u3058\u3067\u3042\u308b\u3068\u306f\u9650\u3089\u306a\u3044\u3002\n____\n\u672c\u6587\u4e2d\u3001\u79c1\u304c\u592a\u5b57\u3067\u5f37\u8abf\u3057\u305f\u90e8\u5206\u304c\u3001\u4eca\u56de\u306e\u8a71\u984c\u306b\u95a2\u4fc2\u3059\u308b\u3068\u3053\u308d\u3067\u3059\u3002\n\n## C99/C11\n\nANSI/ISO/IEC/9899-1999\u304b\u3089\u306e\u5f15\u7528\u3067\u3059:\n____\n**7.20.3 Memory management functions**\n(\u4e2d\u7565)\nIf the size of the space requested is zero, the behavior is implementationdefined: either a null pointer is returned, or the behavior is as if the size were some nonzero value, except that the returned pointer shall not be used to access an object.\n(\u4e2d\u7565)\n\n**7.20.3.4 The realloc function**\n**Synopsis**\n\n```c:\n#include <stdlib.h>\nvoid *realloc(void *ptr, size_t size);\n```\n\n**Description**\nThe realloc function deallocates the old object pointed to by ptr and returns a pointer to a new object that has the size specified by size. The contents of the new object shall be the same as that of the old object prior to deallocation, up to the lesser of the new and old sizes. Any bytes in the new object beyond the size of the old object have indeterminate values.\n\nIf ptr is a null pointer, the realloc function behaves like the malloc function for the specified size. Otherwise, if ptr does not match a pointer earlier returned by the calloc, malloc, or realloc function, or if the space has been deallocated by a call to the free or realloc function, the behavior is undefined. **If memory for the new object cannot be allocated, the old object is not deallocated and its value is unchanged.**\n\n**Returns**\nThe realloc function returns a pointer to the new object (which may have the same value as a pointer to the old object), or **a null pointer if the new object could not be allocated.**\n____\n\u672c\u6587\u4e2d\u3001\u79c1\u304c\u592a\u5b57\u3067\u5f37\u8abf\u3057\u305f\u90e8\u5206\u304c\u3001\u4eca\u56de\u306e\u8a71\u984c\u306b\u95a2\u4fc2\u3059\u308b\u3068\u3053\u308d\u3067\u3059\u3002\n\n## \u73fe\u5728\u306e\u30c9\u30e9\u30d5\u30c8\n\n\u5148\u307b\u3069\u7d39\u4ecb\u3057\u305f[DR#400](http://www.open-std.org/jtc1/sc22/wg14/www/docs/dr_400.htm)\u306e\u3088\u3046\u306b\u5909\u66f4\u3055\u308c\u307e\u3059:\n\n____\n7.22.3 Memory management functions\n7.22.3.5 The realloc function\n\nIf memory for the new object cannot be allocated, the old object is not deallocated and its value is unchanged.\n\u2193\nIf **size is non-zero and** memory for the new object is not allocated, the old object is not deallocated. **If size is zero and memory for the new object is not allocated, it is implementation-defined whether the old object is deallocated. If the old object is not deallocated, its value shall be unchanged.**\n____\nThe realloc function returns a pointer to the new object (which may have the same value as a pointer to the old object), or a null pointer if the new object **could not be** allocated.\n\u2193\nThe realloc function returns a pointer to the new object (which may have the same value as a pointer to the old object), or a null pointer if the new object **has not been** allocated.\n____\n7.31 Future library directions\n7.31.12 General utilities \\<stdlib.h\\>\n**Invoking realloc with a size argument equal to zero is an obsolescent feature.**\n____\n\n\u5909\u66f4\u70b9\u3092\u592a\u5b57\u3067\u5f37\u8abf\u3057\u3066\u304a\u304d\u307e\u3057\u305f\u3002\u904e\u53bb\u306b\u6ce8\u91c8\u306a\u3057\u306b\u884c\u3063\u305f\u975e\u4e92\u63db\u306a\u5909\u66f4\u3092\u300cobsolescent\u300d\u3067\u6e08\u307e\u305b\u305f\u3088\u3053\u306e\u5b50\u3002\n\n# \u4f59\u8ac72: C99\u3067\u4f55\u304c\u8d77\u3053\u3063\u305f\u306e\u304b\n\n\u73fe\u5728\u306eC Standard Committee\u306e\u8b70\u8ad6\u306e\u5185\u5bb9\u306f\u6bd4\u8f03\u7684\u3088\u304f\u516c\u958b\u3055\u308c\u3066\u3044\u308b\u305f\u3081\u3001\u305f\u3068\u3048\u3070\u5148\u307b\u3069\u306eDR#400\u304c\u3069\u306e\u3088\u3046\u306a\u8b70\u8ad6\u3092\u7d4c\u3066\u6c7a\u5b9a\u3055\u308c\u305f\u306e\u304b\u306f2\u3064\u306e\u8b70\u4e8b\u9332([N1603(PDF)](http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1603.pdf), [N1642(PDF)](http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1642.pdf))\u3092\u898b\u308b\u3068\u5206\u304b\u308a\u307e\u3059\u3002\u3057\u304b\u3057\u3001C99\u306e\u3053\u308d\u306e\u8b70\u4e8b\u9332\u306f\u3082\u3063\u3068\u5927\u96d1\u628a\u3067\u3001\u3057\u304b\u3082\u307b\u3068\u3093\u3069\u30c9\u30e9\u30d5\u30c8\u304c\u516c\u958b\u3055\u308c\u3066\u3044\u306a\u3044\u305f\u3081\u3001\u3044\u3064\u3001\u3069\u306e\u6bb5\u968e\u3067\u5909\u66f4\u304c\u884c\u308f\u308c\u305f\u306e\u304b\u306f\u826f\u304f\u5206\u304b\u3089\u306a\u3044\u90e8\u5206\u304c\u3042\u308a\u307e\u3059\u3002\n\n\u79c1\u304c\u8abf\u3079\u305f\u9650\u308a\u3001\u6b21\u306e\u3053\u3068\u304c\u5206\u304b\u308a\u307e\u3057\u305f:\n\n- [1998\u5e748\u67083\u65e5\u306e\u30c9\u30e9\u30d5\u30c8(N843)](http://www.open-std.org/jtc1/sc22/wg14/www/docs/n843.htm)\u3067\u306f\u3001\u307e\u3060`If the realloc function returns a  null  pointer when  size is zero and ptr is not a null pointer, the object it pointed to has been freed.`\u306e\u6587\u8a00\u304c\u3042\u308b\u3002\n- 1998\u5e7410\u67085-9\u65e5\u306eSanta Cruz\u306b\u304a\u3051\u308b\u4f1a\u5408\u306e\u8b70\u4e8b\u9332\u306b\u3001\u300crealloc rewording\u300d\u306e\u6587\u5b57\u304c\u3042\u308b\u3002([Status of approved proposals for C9X, FCD (Pre-Portland)(N858)](http://www.open-std.org/jtc1/sc22/wg14/www/docs/n858.htm))\n\n\u3053\u306e\u300crewording\u300d\u3067\u3001\u300crewording\u300d\u3067\u306f\u6e08\u307e\u306a\u3044\u5909\u66f4\u304c\u884c\u308f\u308c\u305f\u306e\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u3002\n\n\u554f\u984c\u306f\u3001\u3053\u306e\u5909\u66f4\u304c\u610f\u56f3\u7684\u306a\u306e\u304b\u3001\u305d\u308c\u3068\u3082\u4f55\u3089\u304b\u306e\u9593\u9055\u3044\u306a\u306e\u304b\u3068\u3044\u3046\u3053\u3068\u306a\u306e\u3067\u3059\u304c\u3001C99\u306eAnnex J (informative) Portability issues\u3068\u3044\u3046\u7ae0\u3067\u793a\u3055\u308c\u3066\u3044\u308b\u300cunspecified behavior\u300d\u306e\u5217\u6319\u306e\u4e2d\u306b\u3001\u6b21\u306e\u4e00\u6587\u304c\u3042\u308a\u307e\u3059:\n\n`The amount of storage allocated by a successful call to the calloc, malloc, or\nrealloc function when 0 bytes was requested (7.20.3).`\n\n\u3053\u3053\u306f\u898f\u683c\u672c\u4f53\u3067\u306f\u306a\u304f\u5358\u306a\u308b\u53c2\u8003\u60c5\u5831\u3067\u3059\u304c\u3001~~\u308f\u3056\u308f\u3056\u3053\u306e\u3088\u3046\u306b\u660e\u8a18\u3057\u3066\u3042\u308b\u3068\u3044\u3046\u3053\u3068\u306f\u3001size\u304c0\u306e\u5834\u5408\u306e\u52d5\u4f5c\u304c\u4e00\u3064\u306b\u5b9a\u307e\u3089\u306a\u3044(=free\u3068\u7b49\u4fa1\u3060\u3063\u305fC95\u307e\u3067\u3068\u306f\u660e\u78ba\u306b\u975e\u4e92\u63db\u3067\u3042\u308b)\u3053\u3068\u3092\u627f\u77e5\u306e\u4e0a\u3067\u3001\u3042\u306e\u3088\u3046\u306a\u898f\u683c\u672c\u6587\u306b\u3057\u305f\u3068\u3044\u3046\u308f\u3051\u3067\u3059~~ **2016-12-14\u8ffd\u8a18:**\u30b3\u30e1\u30f3\u30c8\u3067C90\u898f\u683c\u304b\u3089\u306e\u5f15\u7528\u3092\u3057\u3066\u3044\u305f\u3060\u3044\u3066\u307e\u3059\u304c\u3001\u4f55\u6545\u304bC90\u306b\u3082\u540c\u69d8\u306e\u8a18\u8ff0\u304c\u3042\u3063\u305f\u306e\u3067\u3001\u3053\u306e\u8a18\u8ff0\u3092\u3082\u3063\u3066\u300c\u610f\u56f3\u7684\u3067\u3042\u308b\u300d\u3068\u3059\u308b\u6839\u62e0\u304c\u5168\u304f\u7121\u304f\u306a\u308a\u307e\u3057\u305f\u3002**\u3068\u3044\u3046\u304bC90\u306e\u6821\u6b63\u3082\u30ac\u30d0\u30ac\u30d0\u3084\u3093\u3051\u3002**\n\u3057\u304b\u3057\u306a\u304c\u3089\u4e00\u65b9\u3067\u3001C\u8a00\u8a9e\u306e\u6a19\u6e96\u5316\u59d4\u54e1\u4f1a\u306e\u51fa\u3057\u3066\u3044\u308b[Rationale for International Standard \u2014 Programming Languages \u2014 C Revision 5.10 April-2003 (PDF)](http://www.open-std.org/jtc1/sc22/wg14/www/C99RationaleV5.10.pdf)\u3068\u3044\u3046\u6587\u66f8\u306b\u306f\u3001\u898f\u683c\u66f8\u3068\u306f\u77db\u76fe\u3057\u305f\u3053\u3068\u304c\u66f8\u3044\u3066\u3042\u308a\u307e\u3059:\n\n`If the first argument is not null, and the second argument is 0, then the call frees the memory pointed to by the first argument, and a null argument may be returned; C99 is consistent with the policy of not allowing zero-sized objects. `\n\n\u5f53\u7136\u3001Rationale\u306b\u306f\u898f\u683c\u3068\u3057\u3066\u306e\u52b9\u529b\u306f\u306a\u3044\u306e\u3067\u3001\u898f\u683c\u672c\u6587\u306e\u65b9\u304c\u512a\u5148\u3055\u308c\u307e\u3059\u304c\u3001\u305b\u3063\u304b\u304fRationale\u3092\u7528\u610f\u3057\u3066\u304a\u304d\u306a\u304c\u3089\u3001\u300c\u306a\u305c\u305d\u3046\u3044\u3046\u5909\u66f4\u3092\u884c\u3063\u305f\u306e\u304b\u300d\u304c\u66f8\u304b\u308c\u3066\u3044\u306a\u3044\u306e\u307f\u306a\u3089\u305a\u3001\u898f\u683c\u3068\u77db\u76fe\u3057\u305f\u3053\u3068\u304c\u66f8\u304b\u308c\u3066\u3044\u308b\u306e\u306f\u56f0\u3063\u305f\u3082\u306e\u3067\u3059\u306d\u3002\n\n# \u811a\u6ce8\n"}