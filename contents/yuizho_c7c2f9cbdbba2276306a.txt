{"context": " More than 1 year has passed since last update.\u306f\u3058\u3081\u3066Robolectric(robolectric:3.0)\u3092\u4f7f\u7528\u3057\u3066\u30c6\u30b9\u30c8\u3092\u66f8\u3044\u305f\u6642\u306e\u5099\u5fd8\u9332\u3002\nRobolectric\u516c\u5f0f\u30da\u30fc\u30b8\n\nAPI level\u306a\u3093\u3061\u3083\u3089\u3068\u8a00\u308f\u308c\u3066\u30c6\u30b9\u30c8\u304c\u5931\u6557\u3059\u308b\u3002\n\n\u73fe\u8c61\nRobolectric\u516c\u5f0f\u30da\u30fc\u30b8-Getting Started\n\u306e\u30b3\u30fc\u30c9\u3092\u53c2\u8003\u306b\u30c6\u30b9\u30c8\u3092\u5b9f\u884c\u3057\u305f\u3089\u3001Robolectric does not support API level... \u306e\u30a8\u30e9\u30fc\u304c\u767a\u751f\u3002\njava.lang.UnsupportedOperationException: Robolectric does not support API level 22.\n...\n\n\n\u5bfe\u5fdc\nRobolectric\u306fAPI level 21\u307e\u3067\u3057\u304b\u5bfe\u5fdc\u3057\u3066\u3044\u306a\u3044(2016/2/13\u73fe\u5728)\u3002\n\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u30a8\u30e9\u30fc\u304c\u51fa\u308b\u3088\u3046\u306a\u3089\u3001Config\u30a2\u30ce\u30c6\u30fc\u30b7\u30e7\u30f3\u3067API level\u3092\u660e\u793a\u7684\u306b\u6307\u5b9a\u3059\u308b\u5fc5\u8981\u304c\u3042\u308b\u3002\n@RunWith(RobolectricGradleTestRunner.class)\n@Config(constants = BuildConfig.class, sdk = 21)\npublic class MainActivityTest {\n\n\nFragment\u304c\u6307\u5b9a\u3057\u305fLayout\u306b\u8868\u793a\u3055\u308c\u3066\u308b\u3053\u3068\u306e\u30c6\u30b9\u30c8\u304c\u3046\u307e\u304f\u3044\u304b\u306a\u3044\n\n\u73fe\u8c61\nActivity\u3092\u8d77\u52d5\u3057\u305f\u969b\u306b\u3001Fragment\u304c\u6307\u5b9a\u3057\u305fLayout\u4e0a\u306b\u8868\u793a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u30c6\u30b9\u30c8\u3057\u305f\u3044\u304c\u3001\u30c6\u30b9\u30c8\u7d50\u679c\u304cnull\u306b\u306a\u3063\u3066\u3057\u307e\u3046\u3002\n@Test\npublic void \u8d77\u52d5\u6642\u306bFooFragment\u304cLayout\u306b\u8868\u793a\u3055\u308c\u308b\u3053\u3068() {\n    Fragment fragment = testActivity.getSupportFragmentManager().findFragmentById(R.id.fragment_container);\n    assertThat(fragment, not(nullValue()));\n}\n\n\u4ee5\u4e0b\u306e\u30b3\u30fc\u30c9\u3060\u3068\u306c\u308b\u307d\u304c\u767a\u751f\n@Test\npublic void \u8d77\u52d5\u6642\u306bFooFragment\u304cLayout\u306b\u8868\u793a\u3055\u308c\u308b\u3053\u3068() {\n    Fragment fragment = testActivity.FooFragmentManager().findFragmentByTag(FavSiteFragment.TAG);\n    // Fragment\u304c\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308bLayout\u306eId\u3092\u53d6\u5f97\n    int actual = ((ViewGroup) fragment.getView().getParent()).getId();\u3000\u3000// \u3053\u3053\u3067\u306c\u308b\u307d\u304c\u8d77\u304d\u308b\n    int expected = R.id.fragment_container;\n    assertThat(actual, is(expected));\n}\n\n\n\u5bfe\u5fdc\n\u30c6\u30b9\u30c8\u7528\u306eActivity\u3092\u69cb\u7bc9\u30fb\u53d6\u5f97\u3059\u308b\u7b87\u6240\u3067\u3001Robolectric.buildActivity(MainActivity.class).create().get()\u3068\u8a18\u8ff0\u3057\u3066\u3057\u307e\u3063\u3066\u3044\u305f\u305f\u3081\u3001onCreate\u307e\u3067\u5b9f\u884c\u3055\u308c\u305f\u72b6\u614b\u3067\u30c6\u30b9\u30c8\u3057\u3066\u3044\u305f\u3002\n\u3064\u307e\u308a\u3001Fragment\u304cLayout\u306b\u8868\u793a\u3055\u308c\u308b\u524d\u306e\u72b6\u614b\u3067\u30c6\u30b9\u30c8\u3092\u5b9f\u884c\u3057\u3066\u3057\u307e\u3063\u3066\u3044\u305f\u3002\nActivity\u306e\u753b\u9762\u304c\u69cb\u7bc9\u3055\u308c\u308b\u30bf\u30a4\u30df\u30f3\u30b0\u3067\u3042\u308b\u3001onStart\u307e\u3067\u5b9f\u884c\u3057\u3066\u3084\u308b\u5fc5\u8981\u304c\u3042\u308b\u3002\nAcrivity\u306e\u30e9\u30a4\u30d5\u30b5\u30a4\u30af\u30eb\nprivate MainActivity testActivity;\n@Before\npublic void setUp() {\n    // onStart\u307e\u3067\u5b9f\u884c\u3055\u308c\u305fAcrivity\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\n    testActivity = Robolectric.buildActivity(MainActivity.class).create().start().get();\n}\n\n\nFragmentTestUtil.startFragment\u3092\u4f7f\u7528\u3059\u308b\u3068\u30a8\u30e9\u30fc\u304c\u767a\u751f\u3059\u308b\n\n\u73fe\u8c61\nFragment\u306e\u30c6\u30b9\u30c8\u3092\u884c\u3046\u305f\u3081\u306b\u3001FragmentTestUtil.startFragment(Fragment fragment)\u3092\u4f7f\u7528\u3059\u308b\u3068\u4f8b\u5916\u304c\u767a\u751f\u3059\u308b\u3002\nFragmentTestUtil\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\n\n\u5bfe\u5fdc\nFragmentTestUtil.startFragment(Fragment fragment)\u3092\u4f7f\u7528\u3059\u308b\u3068\u3001FragmentTestUtil.$FragmentUtilActivity\u4e0a\u3067Fragment\u3092\u52d5\u304b\u305d\u3046\u3068\u3059\u308b\u3002FragmentTestUtil.startFragment(Fragment fragment, Class<? extends FragmentActivity> fragmentActivityClass)\u3092\u4f7f\u7528\u3057\u3066\u3001Activity\u3092\u6307\u5b9a\u3057\u3066\u3084\u308c\u3070\u3088\u3044\u3002\nGitHub-FragmentTestUtil\u30bd\u30fc\u30b9\n@Test\npublic void test() {\n    FooFragment fragment = new FooFragment();\n    FragmentTestUtil.startFragment(fragment, MainActivity.class);\n    ...\n\n\nJMockito\u3068\u7d44\u307f\u5408\u308f\u305b\u3066\u4f7f\u7528\u3059\u308b\u3068\u3001\u4f8b\u5916\u304c\u767a\u751f\u3059\u308b (\u8a02\u6b63\u3042\u308a)\n2016/02/05\u8ffd\u8a18 \n\u4e0b\u8a18\u306e\u65b9\u6cd5\u3067\u4e00\u5fdc\u306f\u52d5\u4f5c\u3057\u305f\u304c\u3001\u8b0e\u306e\u30a8\u30e9\u30fc\u304c\u983b\u767a\u3057\u305f\u305f\u3081\u3001Robolectric\u306eCustom Shadow\u4f7f\u7528\u3059\u308b\u65b9\u6cd5\u306b\u5207\u308a\u304b\u3048\u307e\u3057\u305f\u3002\nCustom Shadow\u306e\u4f7f\u7528\u65b9\u6cd5\u306b\u3064\u3044\u3066\u306f\u3001\u516c\u5f0f\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u901a\u308a\u66f8\u3044\u305f\u306e\u306bCustom Shadow\u30af\u30e9\u30b9\u304c\u4f7f\u7528\u3067\u304d\u306a\u3044\u3092\u53c2\u7167\u3057\u3066\u304f\u3060\u3055\u3044\u3002\nMockit\u3068\u7d44\u307f\u5408\u308f\u305b\u3066\u4f7f\u7528\u3057\u305f\u6642\u306f\u666e\u901a\u306b\u52d5\u4f5c\u3057\u305f\u3057\u3001PowerMock\u3068\u304b\u3082\u52d5\u304f\u3068\u306e\u60c5\u5831\u3092\u898b\u304b\u3051\u305f\u306e\u3067\u3001JMockito\u4ee5\u5916\u306e\u30e2\u30c3\u30af\u30e9\u30a4\u30d6\u30e9\u30ea\u3092\u4f7f\u7528\u3059\u308b\u3053\u3068\u3082\u691c\u8a0e\u3059\u3079\u304d\u3060\u3068\u601d\u3046\u3002\nJMockito\u306e\u66f4\u65b0\u5c65\u6b74\u3092\u307f\u308b\u3068\u3001\n\nJMockit now works fine with the Robolectric Android testing tool (tested with Robolectric 2.2 and 2.3).\n\n\u3068\u3042\u308b\u306e\u3067\u3001Robolectric3.x\u304b\u3089\u554f\u984c\u304c\u518d\u767a\u3057\u305f\u3068\u3044\u3046\u3053\u3068\u306a\u306e\u304b\u306a\uff1f\nhttp://jmockit.org/changes.html\n\n\u73fe\u8c61\nJMockit\u3068\u7d44\u307f\u5408\u308f\u305b\u3066\u3001\u4e00\u90e8\u30af\u30e9\u30b9\u3092\u30e2\u30c3\u30af\u306b\u7f6e\u304d\u304b\u3048\u305f\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u30c6\u30b9\u30c8\u3092\u5b9f\u884c\u3059\u308b\u3068IllegalStateException\u304c\u767a\u751f\u3059\u308b\u3002\nRobolectricGradleTestRunner\u3092RunWith\u30a2\u30ce\u30c6\u30fc\u30b7\u30e7\u30f3\u3067\u6307\u5b9a\u305b\u305a\u306b\u30c6\u30b9\u30c8\u3092\u5b9f\u884c\u3059\u308b\u3068\u6b63\u5e38\u306b\u30c6\u30b9\u30c8\u304c\u5b9f\u884c\u3055\u308c\u308b(JMockit\u3082\u60f3\u5b9a\u901a\u308a\u52d5\u4f5c\u3059\u308b)\u3002\n@RunWith(RobolectricGradleTestRunner.class)\n@Config(constants = BuildConfig.class, sdk = 21)\npublic class SiteFragmentTest {\n    @Mocked\n    Foo foo;\n    @Test\n    public void test() {\n        new NonStrictExpectations() {\n            {\n                foo.getName();\n                result = \"foo\";\n            }\n            ...\n\njava.lang.IllegalStateException: Invalid place to record expectations\n...\n\n\n\u5bfe\u5fdc\nJMockit\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u3092\u5909\u3048\u3066\u307f\u305f\u308a(JMockit-Development history)\u3001RobolectricGradleTestRunner\u3092\u7d99\u627f\u3057\u305f\u30c6\u30b9\u30c8\u30e9\u30f3\u30ca\u30fc\u3092\u4f5c\u6210\u3057\u305f\u308a(StackOverflow-can jmockit and robolectric coexist?)\u3057\u305f\u304c\u3069\u308c\u3082\u3046\u307e\u304f\u3044\u304b\u305a\u3002\nRobolectric\u3068\u4f75\u7528\u3057\u305f\u30b1\u30fc\u30b9\u3067\u306f\u306a\u3044\u304c\u3001MockUp\u3092\u4f7f\u7528\u3059\u308c\u3070\u52d5\u304f\u3068\u306e\u60c5\u5831\u304c\u3042\u3063\u305f\u306e\u3067\u3001\u8a66\u3057\u3066\u307f\u308b\u3068\u4e00\u5fdc\u52d5\u4f5c\u3057\u305f\u3002\n\u3057\u304b\u3057\u3001\u3082\u3063\u3068\u826f\u3044\u65b9\u6cd5\u306f\u306a\u3044\u3082\u306e\u304b\u2026\u2026\n\u4eca\u66f4SaStruts\u306e\u30e6\u30cb\u30c3\u30c8\u30c6\u30b9\u30c8\u3068\u30e2\u30c3\u30af\u306e\u6b8b\u5ff5\u306a\u95a2\u4fc2\u306b\u6ce3\u304f\n@RunWith(RobolectricGradleTestRunner.class)\n@Config(constants = BuildConfig.class, sdk = 21)\npublic class SiteFragmentTest {\n    @Test\n    public void test() {\n            new MockUp<Foo>() {\n                @Mock\n                public String getName() {\n                    return \"foo\";\n                }\n            };\n            ...\n\n\n\u516c\u5f0f\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u901a\u308a\u66f8\u3044\u305f\u306e\u306bCustom Shadow\u30af\u30e9\u30b9\u304c\u4f7f\u7528\u3067\u304d\u306a\u3044\nRobolectric\u3067\u306f\u30e2\u30c3\u30af\u30e9\u30a4\u30d6\u30e9\u30ea\u3092\u4f7f\u7528\u3059\u308b\u4ee3\u308f\u308a\u306bCustom Shadow\u30af\u30e9\u30b9\u3092\u4f5c\u6210\u3059\u308b\u3053\u3068\u3067\u3001\u7279\u5b9a\u306e\u30af\u30e9\u30b9\u306e\u632f\u308b\u821e\u3044\u3092\u7f6e\u304d\u304b\u3048\u3066\u30c6\u30b9\u30c8\u3092\u5b9f\u884c\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u308b\u3002\n\n\u73fe\u8c61\n\u516c\u5f0f\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u901a\u308a\u3001Custom Shadow\u30af\u30e9\u30b9\u3092\u4f5c\u6210\u3057\u3001\u30c6\u30b9\u30c8\u30af\u30e9\u30b9\u306eConfig\u30a2\u30ce\u30c6\u30fc\u30b7\u30e7\u30f3\u306bShadow\u30af\u30e9\u30b9\u3092\u6307\u5b9a\u3057\u305f\u306e\u306b\u632f\u308b\u821e\u3044\u304c\u7f6e\u304d\u304b\u308f\u3089\u306a\u3044\u3002\n// \u516c\u5f0f\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u3088\u308a\n@Implements(Foo.class)\npublic class FooShadow {\n    // bar\u30e1\u30bd\u30c3\u30c9\u306e\u632f\u308b\u821e\u3044\u3092\u7f6e\u304d\u304b\u3048\n    @Implementation\n    public void bar() {\n        // do nothing\n    }\n  }\n}\n\n@RunWith(RobolectricGradleTestRunner.class)\n@Config(constants = BuildConfig.class, sdk = 21, shadows={FooShadow.class})\npublic class BazTest {\n// ...\n\nhttp://robolectric.org/custom-shadows/\n\n\u5bfe\u5fdc\nCustomShadow\u30af\u30e9\u30b9\u3092\u4f7f\u7528\u3059\u308b\u305f\u3081\u306b\u306f\u3001Robolectric\u304cShadow\u30af\u30e9\u30b9\u306b\u7f6e\u304d\u304b\u3048\u308b\u30af\u30e9\u30b9\u3092\u77e5\u3063\u3066\u3044\u308b\u5fc5\u8981\u304c\u3042\u308b\u3002\n\u305d\u306e\u305f\u3081\u3001RobolectricGradleTestRunner\u306e\u304b\u308f\u308a\u306b\u3001\u3053\u308c\u3092\u7d99\u627f\u3057\u305f\u30ab\u30b9\u30bf\u30e0\u30c6\u30b9\u30c8\u30e9\u30f3\u30ca\u30fc\u4f5c\u6210\u3057\u3001\u305d\u306e\u4e2d\u3067Shadow\u30af\u30e9\u30b9\u306b\u7f6e\u304d\u304b\u3048\u308b\u30af\u30e9\u30b9\u3092\u767b\u9332\u3057\u3066\u3084\u308c\u3070\u3088\u3044\u3002\npublic class CustomTestRunner extends RobolectricGradleTestRunner {\n    public CustomTestRunner(Class<?> testClass) throws InitializationError {\n        super(testClass);\n    }\n    @Override\n    public InstrumentationConfiguration createClassLoaderConfig() {\n        // Shadow\u30af\u30e9\u30b9\u306b\u7f6e\u304d\u304b\u3048\u308b\u30af\u30e9\u30b9\u3092\u767b\u9332addInstrumentedClass\u3067\u767b\u9332\n        return InstrumentationConfiguration.newBuilder()\n                .addInstrumentedClass(Foo.class.getName())\n                .build();\n    }\n}\n\n// \u4f5c\u6210\u3057\u305f\u30ab\u30b9\u30bf\u30e0\u30c6\u30b9\u30c8\u30e9\u30f3\u30ca\u30fc\u3092\u4f7f\u7528\n@RunWith(CustomTestRunner.class)\n@Config(constants = BuildConfig.class, sdk = 21, shadows={FooShadow.class})\npublic class BazTest {\n// \u30c6\u30b9\u30c8\u5b9f\u884c\u6642\u3001Foo\u30af\u30e9\u30b9\u3092\u4f7f\u7528\u3057\u3066\u3044\u308b\u7b87\u6240\u304cFooShadow\u30af\u30e9\u30b9\u306b\u7f6e\u304d\u304b\u3048\u3089\u308c\u308b\n// ...\n\nhttp://stackoverflow.com/questions/31920865/how-to-create-custom-shadows-in-robolectric-3-0\n\u306a\u304a\u3001\u4f5c\u6210\u3057\u305fCustom Shadow\u30af\u30e9\u30b9\u306fConfig\u30a2\u30ce\u30c6\u30fc\u30b7\u30e7\u30f3\u306b\u6307\u5b9a\u3057\u3066\u30c6\u30b9\u30c8\u3092\u5b9f\u884c\u3057\u305f\u6642\u306e\u307f\u7f6e\u304d\u304b\u308f\u308b\u3088\u3046\u306b\u306a\u3063\u3066\u3044\u308b\u3002Config\u30a2\u30ce\u30c6\u30fc\u30b7\u30e7\u30f3\u306b\u6307\u5b9a\u3057\u3066\u3044\u306a\u3044\u5834\u5408\u306f\u5143\u306e\u30af\u30e9\u30b9(\u4e0a\u8a18\u306e\u5834\u5408\u306fFoo\u30af\u30e9\u30b9)\u304c\u305d\u306e\u307e\u307e\u4f7f\u7528\u3055\u308c\u308b\u3002\n\u306f\u3058\u3081\u3066Robolectric(robolectric:3.0)\u3092\u4f7f\u7528\u3057\u3066\u30c6\u30b9\u30c8\u3092\u66f8\u3044\u305f\u6642\u306e\u5099\u5fd8\u9332\u3002\n[Robolectric\u516c\u5f0f\u30da\u30fc\u30b8](http://robolectric.org/)\n\n## API level\u306a\u3093\u3061\u3083\u3089\u3068\u8a00\u308f\u308c\u3066\u30c6\u30b9\u30c8\u304c\u5931\u6557\u3059\u308b\u3002\n### \u73fe\u8c61\n[Robolectric\u516c\u5f0f\u30da\u30fc\u30b8-Getting Started](http://robolectric.org/getting-started/)\n\u306e\u30b3\u30fc\u30c9\u3092\u53c2\u8003\u306b\u30c6\u30b9\u30c8\u3092\u5b9f\u884c\u3057\u305f\u3089\u3001Robolectric does not support API level... \u306e\u30a8\u30e9\u30fc\u304c\u767a\u751f\u3002\n\n```\njava.lang.UnsupportedOperationException: Robolectric does not support API level 22.\n...\n```\n\n### \u5bfe\u5fdc\nRobolectric\u306fAPI level 21\u307e\u3067\u3057\u304b\u5bfe\u5fdc\u3057\u3066\u3044\u306a\u3044(2016/2/13\u73fe\u5728)\u3002\n\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u30a8\u30e9\u30fc\u304c\u51fa\u308b\u3088\u3046\u306a\u3089\u3001Config\u30a2\u30ce\u30c6\u30fc\u30b7\u30e7\u30f3\u3067API level\u3092\u660e\u793a\u7684\u306b\u6307\u5b9a\u3059\u308b\u5fc5\u8981\u304c\u3042\u308b\u3002\n\n``` Java\n@RunWith(RobolectricGradleTestRunner.class)\n@Config(constants = BuildConfig.class, sdk = 21)\npublic class MainActivityTest {\n```\n\n## Fragment\u304c\u6307\u5b9a\u3057\u305fLayout\u306b\u8868\u793a\u3055\u308c\u3066\u308b\u3053\u3068\u306e\u30c6\u30b9\u30c8\u304c\u3046\u307e\u304f\u3044\u304b\u306a\u3044\n\n### \u73fe\u8c61\nActivity\u3092\u8d77\u52d5\u3057\u305f\u969b\u306b\u3001Fragment\u304c\u6307\u5b9a\u3057\u305fLayout\u4e0a\u306b\u8868\u793a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u30c6\u30b9\u30c8\u3057\u305f\u3044\u304c\u3001\u30c6\u30b9\u30c8\u7d50\u679c\u304cnull\u306b\u306a\u3063\u3066\u3057\u307e\u3046\u3002\n\n``` Java\n@Test\npublic void \u8d77\u52d5\u6642\u306bFooFragment\u304cLayout\u306b\u8868\u793a\u3055\u308c\u308b\u3053\u3068() {\n    Fragment fragment = testActivity.getSupportFragmentManager().findFragmentById(R.id.fragment_container);\n    assertThat(fragment, not(nullValue()));\n}\n```\n\u4ee5\u4e0b\u306e\u30b3\u30fc\u30c9\u3060\u3068\u306c\u308b\u307d\u304c\u767a\u751f\n\n``` Java\n@Test\npublic void \u8d77\u52d5\u6642\u306bFooFragment\u304cLayout\u306b\u8868\u793a\u3055\u308c\u308b\u3053\u3068() {\n    Fragment fragment = testActivity.FooFragmentManager().findFragmentByTag(FavSiteFragment.TAG);\n    // Fragment\u304c\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308bLayout\u306eId\u3092\u53d6\u5f97\n    int actual = ((ViewGroup) fragment.getView().getParent()).getId();\u3000\u3000// \u3053\u3053\u3067\u306c\u308b\u307d\u304c\u8d77\u304d\u308b\n    int expected = R.id.fragment_container;\n    assertThat(actual, is(expected));\n}\n```\n\n### \u5bfe\u5fdc\n\u30c6\u30b9\u30c8\u7528\u306eActivity\u3092\u69cb\u7bc9\u30fb\u53d6\u5f97\u3059\u308b\u7b87\u6240\u3067\u3001Robolectric.buildActivity(MainActivity.class).create().get()\u3068\u8a18\u8ff0\u3057\u3066\u3057\u307e\u3063\u3066\u3044\u305f\u305f\u3081\u3001onCreate\u307e\u3067\u5b9f\u884c\u3055\u308c\u305f\u72b6\u614b\u3067\u30c6\u30b9\u30c8\u3057\u3066\u3044\u305f\u3002\n\u3064\u307e\u308a\u3001Fragment\u304cLayout\u306b\u8868\u793a\u3055\u308c\u308b\u524d\u306e\u72b6\u614b\u3067\u30c6\u30b9\u30c8\u3092\u5b9f\u884c\u3057\u3066\u3057\u307e\u3063\u3066\u3044\u305f\u3002\n\nActivity\u306e\u753b\u9762\u304c\u69cb\u7bc9\u3055\u308c\u308b\u30bf\u30a4\u30df\u30f3\u30b0\u3067\u3042\u308b\u3001onStart\u307e\u3067\u5b9f\u884c\u3057\u3066\u3084\u308b\u5fc5\u8981\u304c\u3042\u308b\u3002\n[Acrivity\u306e\u30e9\u30a4\u30d5\u30b5\u30a4\u30af\u30eb](http://mixi-inc.github.io/AndroidTraining/fundamentals/2.02.activity-and-fragment.html)\n\n``` Java\nprivate MainActivity testActivity;\n@Before\npublic void setUp() {\n    // onStart\u307e\u3067\u5b9f\u884c\u3055\u308c\u305fAcrivity\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\n    testActivity = Robolectric.buildActivity(MainActivity.class).create().start().get();\n}\n```\n\n## FragmentTestUtil.startFragment\u3092\u4f7f\u7528\u3059\u308b\u3068\u30a8\u30e9\u30fc\u304c\u767a\u751f\u3059\u308b\n### \u73fe\u8c61\nFragment\u306e\u30c6\u30b9\u30c8\u3092\u884c\u3046\u305f\u3081\u306b\u3001FragmentTestUtil.startFragment(Fragment fragment)\u3092\u4f7f\u7528\u3059\u308b\u3068\u4f8b\u5916\u304c\u767a\u751f\u3059\u308b\u3002\n[FragmentTestUtil\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8](http://robolectric.org/javadoc/3.0/org/robolectric/util/FragmentTestUtil.html)\n\n### \u5bfe\u5fdc\nFragmentTestUtil.startFragment(Fragment fragment)\u3092\u4f7f\u7528\u3059\u308b\u3068\u3001FragmentTestUtil.$FragmentUtilActivity\u4e0a\u3067Fragment\u3092\u52d5\u304b\u305d\u3046\u3068\u3059\u308b\u3002FragmentTestUtil.startFragment(Fragment fragment, Class<? extends FragmentActivity> fragmentActivityClass)\u3092\u4f7f\u7528\u3057\u3066\u3001Activity\u3092\u6307\u5b9a\u3057\u3066\u3084\u308c\u3070\u3088\u3044\u3002\n[GitHub-FragmentTestUtil\u30bd\u30fc\u30b9](https://github.com/robolectric/robolectric/blob/master/robolectric/src/main/java/org/robolectric/util/FragmentTestUtil.java)\n\n``` Java\n@Test\npublic void test() {\n    FooFragment fragment = new FooFragment();\n    FragmentTestUtil.startFragment(fragment, MainActivity.class);\n    ...\n```\n\n## JMockito\u3068\u7d44\u307f\u5408\u308f\u305b\u3066\u4f7f\u7528\u3059\u308b\u3068\u3001\u4f8b\u5916\u304c\u767a\u751f\u3059\u308b (\u8a02\u6b63\u3042\u308a)\n__2016/02/05\u8ffd\u8a18__ \n\u4e0b\u8a18\u306e\u65b9\u6cd5\u3067\u4e00\u5fdc\u306f\u52d5\u4f5c\u3057\u305f\u304c\u3001\u8b0e\u306e\u30a8\u30e9\u30fc\u304c\u983b\u767a\u3057\u305f\u305f\u3081\u3001Robolectric\u306eCustom Shadow\u4f7f\u7528\u3059\u308b\u65b9\u6cd5\u306b\u5207\u308a\u304b\u3048\u307e\u3057\u305f\u3002\nCustom Shadow\u306e\u4f7f\u7528\u65b9\u6cd5\u306b\u3064\u3044\u3066\u306f\u3001__\u516c\u5f0f\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u901a\u308a\u66f8\u3044\u305f\u306e\u306bCustom Shadow\u30af\u30e9\u30b9\u304c\u4f7f\u7528\u3067\u304d\u306a\u3044__\u3092\u53c2\u7167\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\nMockit\u3068\u7d44\u307f\u5408\u308f\u305b\u3066\u4f7f\u7528\u3057\u305f\u6642\u306f\u666e\u901a\u306b\u52d5\u4f5c\u3057\u305f\u3057\u3001PowerMock\u3068\u304b\u3082\u52d5\u304f\u3068\u306e\u60c5\u5831\u3092\u898b\u304b\u3051\u305f\u306e\u3067\u3001JMockito\u4ee5\u5916\u306e\u30e2\u30c3\u30af\u30e9\u30a4\u30d6\u30e9\u30ea\u3092\u4f7f\u7528\u3059\u308b\u3053\u3068\u3082\u691c\u8a0e\u3059\u3079\u304d\u3060\u3068\u601d\u3046\u3002\n\nJMockito\u306e\u66f4\u65b0\u5c65\u6b74\u3092\u307f\u308b\u3068\u3001\n> JMockit now works fine with the Robolectric Android testing tool (tested with Robolectric 2.2 and 2.3).\n\n\u3068\u3042\u308b\u306e\u3067\u3001Robolectric3.x\u304b\u3089\u554f\u984c\u304c\u518d\u767a\u3057\u305f\u3068\u3044\u3046\u3053\u3068\u306a\u306e\u304b\u306a\uff1f\nhttp://jmockit.org/changes.html\n\n### \u73fe\u8c61\n~~JMockit\u3068\u7d44\u307f\u5408\u308f\u305b\u3066\u3001\u4e00\u90e8\u30af\u30e9\u30b9\u3092\u30e2\u30c3\u30af\u306b\u7f6e\u304d\u304b\u3048\u305f\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u30c6\u30b9\u30c8\u3092\u5b9f\u884c\u3059\u308b\u3068IllegalStateException\u304c\u767a\u751f\u3059\u308b\u3002\nRobolectricGradleTestRunner\u3092RunWith\u30a2\u30ce\u30c6\u30fc\u30b7\u30e7\u30f3\u3067\u6307\u5b9a\u305b\u305a\u306b\u30c6\u30b9\u30c8\u3092\u5b9f\u884c\u3059\u308b\u3068\u6b63\u5e38\u306b\u30c6\u30b9\u30c8\u304c\u5b9f\u884c\u3055\u308c\u308b(JMockit\u3082\u60f3\u5b9a\u901a\u308a\u52d5\u4f5c\u3059\u308b)\u3002~~\n\n``` Java\n@RunWith(RobolectricGradleTestRunner.class)\n@Config(constants = BuildConfig.class, sdk = 21)\npublic class SiteFragmentTest {\n    @Mocked\n    Foo foo;\n    @Test\n    public void test() {\n        new NonStrictExpectations() {\n            {\n                foo.getName();\n                result = \"foo\";\n            }\n            ...\n```\n\n```\njava.lang.IllegalStateException: Invalid place to record expectations\n...\n```\n\n### \u5bfe\u5fdc\n\n~~JMockit\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u3092\u5909\u3048\u3066\u307f\u305f\u308a[(JMockit-Development history)](http://jmockit.org/changes.html)\u3001RobolectricGradleTestRunner\u3092\u7d99\u627f\u3057\u305f\u30c6\u30b9\u30c8\u30e9\u30f3\u30ca\u30fc\u3092\u4f5c\u6210\u3057\u305f\u308a[(StackOverflow-can jmockit and robolectric coexist?)](http://stackoverflow.com/questions/14780965/can-jmockit-and-robolectric-coexist)\u3057\u305f\u304c\u3069\u308c\u3082\u3046\u307e\u304f\u3044\u304b\u305a\u3002~~\n~~Robolectric\u3068\u4f75\u7528\u3057\u305f\u30b1\u30fc\u30b9\u3067\u306f\u306a\u3044\u304c\u3001MockUp\u3092\u4f7f\u7528\u3059\u308c\u3070\u52d5\u304f\u3068\u306e\u60c5\u5831\u304c\u3042\u3063\u305f\u306e\u3067\u3001\u8a66\u3057\u3066\u307f\u308b\u3068\u4e00\u5fdc\u52d5\u4f5c\u3057\u305f\u3002\n\u3057\u304b\u3057\u3001\u3082\u3063\u3068\u826f\u3044\u65b9\u6cd5\u306f\u306a\u3044\u3082\u306e\u304b\u2026\u2026\n[\u4eca\u66f4SaStruts\u306e\u30e6\u30cb\u30c3\u30c8\u30c6\u30b9\u30c8\u3068\u30e2\u30c3\u30af\u306e\u6b8b\u5ff5\u306a\u95a2\u4fc2\u306b\u6ce3\u304f](http://www.bunkei-programmer.net/entry/2014/09/07/000946)~~\n\n```Java\n@RunWith(RobolectricGradleTestRunner.class)\n@Config(constants = BuildConfig.class, sdk = 21)\npublic class SiteFragmentTest {\n    @Test\n    public void test() {\n            new MockUp<Foo>() {\n                @Mock\n                public String getName() {\n                    return \"foo\";\n                }\n            };\n            ...\n```\n\n## \u516c\u5f0f\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u901a\u308a\u66f8\u3044\u305f\u306e\u306bCustom Shadow\u30af\u30e9\u30b9\u304c\u4f7f\u7528\u3067\u304d\u306a\u3044\nRobolectric\u3067\u306f\u30e2\u30c3\u30af\u30e9\u30a4\u30d6\u30e9\u30ea\u3092\u4f7f\u7528\u3059\u308b\u4ee3\u308f\u308a\u306bCustom Shadow\u30af\u30e9\u30b9\u3092\u4f5c\u6210\u3059\u308b\u3053\u3068\u3067\u3001\u7279\u5b9a\u306e\u30af\u30e9\u30b9\u306e\u632f\u308b\u821e\u3044\u3092\u7f6e\u304d\u304b\u3048\u3066\u30c6\u30b9\u30c8\u3092\u5b9f\u884c\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u308b\u3002\n### \u73fe\u8c61\n\u516c\u5f0f\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u901a\u308a\u3001Custom Shadow\u30af\u30e9\u30b9\u3092\u4f5c\u6210\u3057\u3001\u30c6\u30b9\u30c8\u30af\u30e9\u30b9\u306eConfig\u30a2\u30ce\u30c6\u30fc\u30b7\u30e7\u30f3\u306bShadow\u30af\u30e9\u30b9\u3092\u6307\u5b9a\u3057\u305f\u306e\u306b\u632f\u308b\u821e\u3044\u304c\u7f6e\u304d\u304b\u308f\u3089\u306a\u3044\u3002\n\n```Java\n// \u516c\u5f0f\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u3088\u308a\n@Implements(Foo.class)\npublic class FooShadow {\n    // bar\u30e1\u30bd\u30c3\u30c9\u306e\u632f\u308b\u821e\u3044\u3092\u7f6e\u304d\u304b\u3048\n    @Implementation\n    public void bar() {\n        // do nothing\n    }\n  }\n}\n```\n\n```Java\n@RunWith(RobolectricGradleTestRunner.class)\n@Config(constants = BuildConfig.class, sdk = 21, shadows={FooShadow.class})\npublic class BazTest {\n// ...\n```\nhttp://robolectric.org/custom-shadows/\n### \u5bfe\u5fdc\nCustomShadow\u30af\u30e9\u30b9\u3092\u4f7f\u7528\u3059\u308b\u305f\u3081\u306b\u306f\u3001Robolectric\u304cShadow\u30af\u30e9\u30b9\u306b\u7f6e\u304d\u304b\u3048\u308b\u30af\u30e9\u30b9\u3092\u77e5\u3063\u3066\u3044\u308b\u5fc5\u8981\u304c\u3042\u308b\u3002\n\u305d\u306e\u305f\u3081\u3001RobolectricGradleTestRunner\u306e\u304b\u308f\u308a\u306b\u3001\u3053\u308c\u3092\u7d99\u627f\u3057\u305f\u30ab\u30b9\u30bf\u30e0\u30c6\u30b9\u30c8\u30e9\u30f3\u30ca\u30fc\u4f5c\u6210\u3057\u3001\u305d\u306e\u4e2d\u3067Shadow\u30af\u30e9\u30b9\u306b\u7f6e\u304d\u304b\u3048\u308b\u30af\u30e9\u30b9\u3092\u767b\u9332\u3057\u3066\u3084\u308c\u3070\u3088\u3044\u3002\n\n```Java\npublic class CustomTestRunner extends RobolectricGradleTestRunner {\n    public CustomTestRunner(Class<?> testClass) throws InitializationError {\n        super(testClass);\n    }\n    @Override\n    public InstrumentationConfiguration createClassLoaderConfig() {\n        // Shadow\u30af\u30e9\u30b9\u306b\u7f6e\u304d\u304b\u3048\u308b\u30af\u30e9\u30b9\u3092\u767b\u9332addInstrumentedClass\u3067\u767b\u9332\n        return InstrumentationConfiguration.newBuilder()\n                .addInstrumentedClass(Foo.class.getName())\n                .build();\n    }\n}\n```\n\n```Java\n// \u4f5c\u6210\u3057\u305f\u30ab\u30b9\u30bf\u30e0\u30c6\u30b9\u30c8\u30e9\u30f3\u30ca\u30fc\u3092\u4f7f\u7528\n@RunWith(CustomTestRunner.class)\n@Config(constants = BuildConfig.class, sdk = 21, shadows={FooShadow.class})\npublic class BazTest {\n// \u30c6\u30b9\u30c8\u5b9f\u884c\u6642\u3001Foo\u30af\u30e9\u30b9\u3092\u4f7f\u7528\u3057\u3066\u3044\u308b\u7b87\u6240\u304cFooShadow\u30af\u30e9\u30b9\u306b\u7f6e\u304d\u304b\u3048\u3089\u308c\u308b\n// ...\n```\nhttp://stackoverflow.com/questions/31920865/how-to-create-custom-shadows-in-robolectric-3-0\n\n\u306a\u304a\u3001\u4f5c\u6210\u3057\u305fCustom Shadow\u30af\u30e9\u30b9\u306fConfig\u30a2\u30ce\u30c6\u30fc\u30b7\u30e7\u30f3\u306b\u6307\u5b9a\u3057\u3066\u30c6\u30b9\u30c8\u3092\u5b9f\u884c\u3057\u305f\u6642\u306e\u307f\u7f6e\u304d\u304b\u308f\u308b\u3088\u3046\u306b\u306a\u3063\u3066\u3044\u308b\u3002Config\u30a2\u30ce\u30c6\u30fc\u30b7\u30e7\u30f3\u306b\u6307\u5b9a\u3057\u3066\u3044\u306a\u3044\u5834\u5408\u306f\u5143\u306e\u30af\u30e9\u30b9(\u4e0a\u8a18\u306e\u5834\u5408\u306fFoo\u30af\u30e9\u30b9)\u304c\u305d\u306e\u307e\u307e\u4f7f\u7528\u3055\u308c\u308b\u3002\n", "tags": ["Android", "robolectric"]}