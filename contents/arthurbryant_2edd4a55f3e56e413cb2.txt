{"tags": ["EC2", "SSL", "development", "RubyOnRails", "passenger"], "context": "\n\n\u80cc\u666f\nMac 10.10.4, AWS (EC2 Amazon Linux), Ruby on Rails, passenager\n\n\u8a3c\u660e\u66f8\u751f\u6210\nSSL\u8a3c\u660e\u66f8\u306e\u751f\u6210\u306fwikipedia\u306e\u30da\u30fc\u30b8\u3092\u5f93\u3048\u3070\u3044\u3044\u3067\u3057\u3087\u3046\u3002\n\u305f\u3060\u3057\u3001\u6700\u521d\u304b\u3089\u30d1\u30b9\u30d5\u30ec\u30fc\u30ba\u30ec\u30b9\u306e\u30ad\u30fc\u3092\u4f7f\u3063\u3066\u4e0b\u3055\u3044\u3002\nopenssl rsa -in server.key.back -out server.key\n\n\u7d42\u308f\u3063\u305f\u3089\u3001\u4ee5\u4e0b\u306e\uff13\u3064\u306e\u30d5\u30a1\u30a4\u30eb\u304c\u3042\u308b\u306f\u305a\nserver.key, server.csr, server.crt\n\n\nEC2\u3067\u306e\u8a2d\u5b9a\n\nmod_ssl\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3057\u3087\u3046\n\nyum -y install mod_ssl\n\n\nSSL\u8a2d\u5b9a\n\n# vim /etc/httpd/conf.d/ssl.conf\n\nSSLCertificateFile /etc/httpd/conf/ssl.crt/server.crt\n\nSSLCertificateKeyFile /etc/httpd/conf/ssl.key/server.key\n\n\n\u8a3c\u660e\u30d5\u30a1\u30a4\u30eb\u3092\u7f6e\u3044\u3068\u304d\u307e\u3057\u3087\u3046\u3002\n\nmkdir /etc/httpd/conf/ssl.key -m 700\nmkdir /etc/httpd/conf/ssl.crt\nmv server.key /etc/httpd/conf/ssl.key/\nmv server.crt /etc/httpd/conf/ssl.crt/\nchmod 400 /etc/httpd/conf/ssl.key \n\n\n\u6b21\u306fApache\u30d5\u30a1\u30a4\u30eb\u306e\u8a2d\u5b9a\n\n\u4e0b\u306e\u5185\u5bb9\u3092/etc/httpd/conf/httpd.conf\u306b\u8ffd\u52a0\u3057\u3066\u4e0b\u3055\u3044\u3002\nNameVirtualHost *:443\n<VirtualHost *:443>\n    ServerName example.com\n    RailsEnv development\n    DocumentRoot /home/ec2-user/project/public\n    <Directory /home/ec2-user/project/public>\n        AllowOverride all\n        Options -MultiViews\n    </Directory>\n    SSLEngine on\n    SSLCertificateFile /etc/httpd/conf/ssl.crt/server.crt\n    SSLCertificateKeyFile /etc/httpd/conf/ssl.key/server.key\n</VirtualHost>\n\n\n\u30cf\u30de\u30c3\u305f\u3053\u3068\n\nRails\u306e\u74b0\u5883\u3092\u8a2d\u5b9a\u3057\u306a\u3044\u5834\u5408\n\nError: no selected database\n\nRailsEnv development\u304c\u306a\u3044\u3068\u304a\u305d\u3089\u304fproduction\u74b0\u5883\u3068\u8a8d\u8b58\u3055\u308c\u3061\u3083\u3046\u306e\u3067\u3001database\u304c\u898b\u3064\u304b\u3089\u306a\u3044\u30a8\u30e9\u30fc\u304c\u51fa\u305f\u3002\n\nNameVirtualHost\u3092\u5fd8\u308c\u305f\n\nNameVirtualHost *:443\u304c\u306a\u3051\u308c\u3070\n[warn] _default_ VirtualHost overlap on port 443, the first has precedence\n\ndefault 80\u306b\u30aa\u30fc\u30d0\u30fc\u30e9\u30c3\u30d7\u3057\u3066\u3057\u307e\u3063\u305f\u3002\n##\u80cc\u666f\nMac 10.10.4, AWS (EC2 Amazon Linux), Ruby on Rails, passenager\n\n##\u8a3c\u660e\u66f8\u751f\u6210\nSSL\u8a3c\u660e\u66f8\u306e\u751f\u6210\u306f[wikipedia\u306e\u30da\u30fc\u30b8](http://www.maruko2.com/mw/Apache/SSL%E8%87%AA%E5%B7%B1%E8%A8%BC%E6%98%8E%E6%9B%B8%E3%81%AE%E4%BD%9C%E6%88%90%E3%81%A8mod_ssl%E3%81%AE%E8%A8%AD%E5%AE%9A#.E8.A8.BC.E6.98.8E.E6.9B.B8.EF.BC.88.E5.85.AC.E9.96.8B.E9.8D.B5.EF.BC.89.E3.81.AE.E4.BD.9C.E6.88.90_.28server.crt.29)\u3092\u5f93\u3048\u3070\u3044\u3044\u3067\u3057\u3087\u3046\u3002\n\n\u305f\u3060\u3057\u3001\u6700\u521d\u304b\u3089\u30d1\u30b9\u30d5\u30ec\u30fc\u30ba\u30ec\u30b9\u306e\u30ad\u30fc\u3092\u4f7f\u3063\u3066\u4e0b\u3055\u3044\u3002\n\n```\nopenssl rsa -in server.key.back -out server.key\n```\n\n\u7d42\u308f\u3063\u305f\u3089\u3001\u4ee5\u4e0b\u306e\uff13\u3064\u306e\u30d5\u30a1\u30a4\u30eb\u304c\u3042\u308b\u306f\u305a\n\n```\nserver.key, server.csr, server.crt\n```\n\n##EC2\u3067\u306e\u8a2d\u5b9a\n\n* mod_ssl\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3057\u3087\u3046\n\n```\nyum -y install mod_ssl\n```\n\n* SSL\u8a2d\u5b9a\n\n```\n# vim /etc/httpd/conf.d/ssl.conf\n\nSSLCertificateFile /etc/httpd/conf/ssl.crt/server.crt\n\nSSLCertificateKeyFile /etc/httpd/conf/ssl.key/server.key\n```\n\n* \u8a3c\u660e\u30d5\u30a1\u30a4\u30eb\u3092\u7f6e\u3044\u3068\u304d\u307e\u3057\u3087\u3046\u3002\n\n```\nmkdir /etc/httpd/conf/ssl.key -m 700\nmkdir /etc/httpd/conf/ssl.crt\nmv server.key /etc/httpd/conf/ssl.key/\nmv server.crt /etc/httpd/conf/ssl.crt/\nchmod 400 /etc/httpd/conf/ssl.key \n```\n\n* \u6b21\u306fApache\u30d5\u30a1\u30a4\u30eb\u306e\u8a2d\u5b9a\n\n\u4e0b\u306e\u5185\u5bb9\u3092/etc/httpd/conf/httpd.conf\u306b\u8ffd\u52a0\u3057\u3066\u4e0b\u3055\u3044\u3002\n\n```\nNameVirtualHost *:443\n<VirtualHost *:443>\n    ServerName example.com\n    RailsEnv development\n    DocumentRoot /home/ec2-user/project/public\n    <Directory /home/ec2-user/project/public>\n        AllowOverride all\n        Options -MultiViews\n    </Directory>\n    SSLEngine on\n    SSLCertificateFile /etc/httpd/conf/ssl.crt/server.crt\n    SSLCertificateKeyFile /etc/httpd/conf/ssl.key/server.key\n</VirtualHost>\n```\n\n##\u30cf\u30de\u30c3\u305f\u3053\u3068\n\n* Rails\u306e\u74b0\u5883\u3092\u8a2d\u5b9a\u3057\u306a\u3044\u5834\u5408\n\n```\nError: no selected database\n```\n\n**RailsEnv development**\u304c\u306a\u3044\u3068\u304a\u305d\u3089\u304fproduction\u74b0\u5883\u3068\u8a8d\u8b58\u3055\u308c\u3061\u3083\u3046\u306e\u3067\u3001database\u304c\u898b\u3064\u304b\u3089\u306a\u3044\u30a8\u30e9\u30fc\u304c\u51fa\u305f\u3002\n\n* NameVirtualHost\u3092\u5fd8\u308c\u305f\n\n**NameVirtualHost *:443**\u304c\u306a\u3051\u308c\u3070\n\n```\n[warn] _default_ VirtualHost overlap on port 443, the first has precedence\n```\n\ndefault 80\u306b\u30aa\u30fc\u30d0\u30fc\u30e9\u30c3\u30d7\u3057\u3066\u3057\u307e\u3063\u305f\u3002\n"}