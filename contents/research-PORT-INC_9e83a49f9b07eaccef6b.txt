{"tags": ["\u6a5f\u68b0\u5b66\u7fd2", "\u6570\u5b66", "\u7d71\u8a08"], "context": " More than 1 year has passed since last update. \n\\newcommand{\\b}[1]{\\mathbf{#1}} \n\n\n\u30c7\u30a3\u30ea\u30af\u30ec\u5206\u5e03\u306e\u6700\u5c24\u63a8\u5b9a\n\u4eca\u56de\u306f\u30c7\u30a3\u30ea\u5206\u5e03\u306e\u6700\u5c24\u63a8\u5b9a\u6cd5\u306b\u3088\u308b\u6570\u5024\u6700\u9069\u89e3\u3092\u5f97\u308b\u65b9\u6cd5\u306b\u3064\u3044\u3066\u8aac\u660e\u3057\u305f\u3044\u3068\u601d\u3046\u3002\n\u4e8c\u9805\u5206\u5e03\u3084\u6307\u6570\u5206\u5e03\u3001\u6b63\u898f\u5206\u5e03\u306a\u3069\u306e\u7c21\u5358\u306a\u5206\u5e03\u3067\u306f\u89e3\u6790\u89e3\u3092\u5f97\u3089\u308c\u304c\u3001\u30c7\u30a3\u30ec\u30af\u30ec\u5206\u5e03\u306e\u3088\u3046\u306a\u9ad8\u6b21\u5143\u3067\u8907\u96d1\u306a\u78ba\u7387\u5206\u5e03\u306b\u306a\u308b\u3068\u6700\u5c24\u63a8\u5b9a\u3084MAP\u63a8\u5b9a\u3067\u89e3\u6790\u89e3\u3092\u6c42\u3081\u308b\u3053\u3068\u306f\u57fa\u672c\u7684\u306b\u51fa\u6765\u306a\u3044\u3002\u305d\u3053\u3067\u3001\u6570\u5024\u7684\u306a\u8a08\u7b97\u51e6\u7406\u3092\u3057\u3066\u6c42\u3081\u308b\u5fc5\u8981\u304c\u3042\u308b\u3002\n\u7279\u306b\u30c7\u30a3\u30ec\u30af\u30ec\u5206\u5e03\u306f\u30ca\u30a4\u30fc\u30d6\u30d9\u30a4\u30ba\u3084\u6df7\u5408\u30e2\u30c7\u30eb\u306a\u3069\u306e\u5171\u5f79\u4e8b\u524d\u5206\u5e03\u3068\u3057\u3066\u6d3b\u8e8d\u3059\u308b\u306e\u3067\u69d8\u3005\u306a\u5206\u91ce\u3067\u5fc5\u8981\u306b\u306a\u308b\u3002\n\u81ea\u5206\u306e\u5834\u5408\u306f\u6a5f\u68b0\u5b66\u7fd2\u30d7\u30ed\u30d5\u30a7\u30c3\u30b7\u30e7\u30ca\u30eb\u30b7\u30ea\u30fc\u30ba\u306e\u30c8\u30d4\u30c3\u30af\u30e2\u30c7\u30eb\u306e2\u7ae0\u30e6\u30cb\u30b0\u30e9\u30e0\u30e2\u30c7\u30eb\u3092\u8aad\u3093\u3067\u3044\u308b\u6642\u306b\u5fc5\u8981\u306b\u306a\u3063\u305f\u3002\n\u305d\u3053\u3067\u30d7\u30ed\u30d5\u30a7\u30c3\u30b7\u30e7\u30ca\u30eb\u30b7\u30ea\u30fc\u30ba\u306e\u66f8\u7c4d\u306b\u3082\u7d39\u4ecb\u3055\u308c\u3066\u3044\u305f\u4ee5\u4e0b\u306e\u8ad6\u6587\u306e\u884c\u9593\u3092\u57cb\u3081\u306a\u304c\u3089\u9032\u3081\u3066\u3044\u304f\u3002\nEstimating a Dirichlet distribution Thomas P. Minka 2000 (revised 2003, 2009, 2012)\n\u307e\u305f\u3001\u3053\u306e\u8cc7\u6599\u306f\u30c7\u30a3\u30ac\u30f3\u30de\u95a2\u6570\u306e\u6f38\u8fd1\u5c55\u958b\u304b\u3089\u57fa\u672c\u7684\u306a\u3053\u3068\u307e\u3067\u3001\u306a\u308b\u3079\u304f\u7701\u7565\u305b\u305a\u4e00\u304b\u3089\u5168\u3066\u8aac\u660e\u3057\u3066\u3044\u308b\u3002\u307e\u305f\u3001\u8ad6\u6587\u3067\u3053\u306e\u6587\u7ae0\u306b\u5bfe\u5fdc\u3059\u308b\u306e\u306f2\u30da\u30fc\u30b8\u306e\u9014\u4e2d\u307e\u3067\u3067\u3042\u308b\u3002\n\n\u5b9a\u5f0f\u5316\n\u30c7\u30a3\u30ec\u30af\u30ec\u5206\u5e03\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u78ba\u7387\u5206\u5e03\u3067\u3042\u308b\u3002\nP(p|\u03b1)=\u0393(\u2211nk=1\u03b1k)\u220fnk=1\u0393(\u03b1k)n\u220fk=1p\u03b1k\u22121kn\u2211k=1pk=1,\u00a0\u00a0\u00a0\u00a0pk\u22650 \n\\begin{eqnarray} \nP(\\b{p} | \\b{\\alpha}) = \\frac{\\Gamma(\\sum_{k=1}^n \\alpha_k)}{\\prod_{k=1}^{n} \\Gamma(\\alpha_k)} \\prod_{k=1}^{n} p_k^{\\alpha_k - 1} \\\\ \n\\sum_{k=1}^{n} p_k = 1, ~~~~ p_k \\ge 0 \n\\end{eqnarray} \n\n\u3053\u3053\u3067 \u03b1 \\b{\\alpha}  \u306fn\u6b21\u5143\u30d9\u30af\u30c8\u30eb\u3067\u3042\u308b\u3002\n\n\u6700\u5c24\u63a8\u5b9a\u6cd5\u3067\u6700\u9069\u89e3\u3092\u6c42\u3081\u308b\n\u3055\u3066 \u03b1 \\b{\\alpha}  \u3092\u56fa\u5b9a\u3057\u3066\u30c7\u30a3\u30ec\u30af\u30ec\u5206\u5e03\u304b\u3089\u4ee5\u4e0b\u306e\u3088\u3046\u306b N \u500b\u306e\u78ba\u7387\u30d9\u30af\u30c8\u30eb DataSet={p(1),p(2),...,p(N)} DataSet = \\{ \\b{p^{(1)}}, \\b{p^{(2)}}, ..., \\b{p^{(N)}} \\}  \u304c\u89b3\u6e2c\u51fa\u6765\u305f\u6642\u306b\u305d\u306e\u78ba\u7387\u3092\u6700\u5927\u5316\u3055\u305b\u308b\u3088\u3046\u306a \u03b1 \\b{\\alpha}  \u3092\u6c42\u3081\u308b\u3002\u5c24\u5ea6\u3092 L(\u03b1) L(\\b{\\alpha})  \u3068\u3059\u308b\u3068\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u8868\u305b\u308b\u3002\nL(\u03b1)=log(N\u220fi=1P(p(i)|\u03b1))=N\u2211k=1{\u00a0(N\u2211i=1(\u03b1k\u22121)\u00a0log(p(i)k))+N\u00a0log(\u0393(n\u2211k\u2032=1\u03b1k\u2032))\u2212N\u00a0log(\u0393(\u03b1k))\u00a0}=N\u2211k=1{\u00a0N\u00a0log(\u0393(n\u2211k\u2032=1\u03b1k\u2032))+\u00a0N(\u03b1k\u22121)\u00a0log(~pk)\u2212N\u00a0log(\u0393(\u03b1k))\u00a0} \n\\begin{eqnarray} \nL(\\b{\\alpha}) & = & log(\\prod_{i=1}^{N} P(\\b{p^{(i)}} | \\b{\\alpha})) \\\\ \n& = & \\sum_{k=1}^{N} \\{~ (\\sum_{i=1}^{N} (\\alpha_k - 1) ~ log(p_k^{(i)})) + N ~ log( \\Gamma(\\sum_{k'=1}^{n}  \\alpha_{k'})) - N ~ log(\\Gamma(\\alpha_k)) ~\\} \\\\ \n& = & \\sum_{k=1}^{N} \\{ ~ N ~ log( \\Gamma(\\sum_{k'=1}^{n}  \\alpha_{k'})) + ~ N (\\alpha_k - 1) ~ log(\\tilde{p_k})  - N ~ log(\\Gamma(\\alpha_k)) ~\\} \n\\end{eqnarray} \n\n\u3053\u3053\u3067 log(~pk) log(\\tilde{p_k})  \u306b\u3064\u3044\u3066\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u5b9a\u7fa9\u3057\u305f\u3002\nlog(~pk)=1NN\u2211i=1log(p(i)k) \n\\begin{eqnarray} \nlog(\\tilde{p_k}) = \\frac{1}{N} \\sum_{i=1}^{N} log(p_k^{(i)}) \n\\end{eqnarray} \n\n\u3055\u3066 L(\u03b1) L(\\alpha)  \u306e\u6975\u5024\u3092\u5f97\u308b\u305f\u3081\u306b\u3001\u307e\u305a\u95a2\u6570\u3092\u5fae\u5206\u3057\u3066\u307f\u308b\u3002\n\u2202L(\u03b1)\u2202\u03b1i=Nn\u2211k=1{\u2202\u03b1k\u2202\u03b1ilog(~pk)\u2212\u2202log(\u0393(\u03b1k))\u2202\u03b1i}+N\u2202\u2202\u03b1i\u0393(n\u2211k=1\u03b1k)=n\u2211k=1{\u03b4k,ilog(~pk)\u2212\u03b4k,i\u03c8(\u03b1k)}+N\u00a0\u03c8(n\u2211k=1\u03b1k)\u2202\u2211nk=1\u03b1k\u2202\u03b1i=N{\u03c8(n\u2211k=1\u03b1k)\u2212\u03c8(\u03b1i)+log(~pi)} \n\\begin{eqnarray} \n\\frac{\\partial L(\\b{\\alpha})}{\\partial \\alpha_i} & = & N \\sum_{k=1}^{n} \\{ \\frac{\\partial \\alpha_k}{\\partial \\alpha_i} log(\\tilde{p_k}) - \\frac{\\partial log(\\Gamma(\\alpha_k))}{\\partial \\alpha_i} \\} + N \\frac{\\partial}{\\partial \\alpha_i} \\Gamma(\\sum_{k=1}^{n} \\alpha_k) \\\\ \n& = & \\sum_{k=1}^{n} \\{ \\delta_{k,i} log(\\tilde{p_k}) - \\delta_{k, i} \\psi(\\alpha_k) \\} + N ~ \\psi(\\sum_{k=1}^{n} \\alpha_k) \\frac{\\partial \\sum_{k=1}^{n} \\alpha_k}{\\partial \\alpha_i} \\\\ \n& = & N \\{ \\psi(\\sum_{k=1}^{n} \\alpha_k) - \\psi(\\alpha_i) + log(\\tilde{p_i}) \\} \n\\end{eqnarray} \n\n\u3053\u3053\u3067 \u03d5(x) \\phi(x)  \u3092Log\u30b9\u30b1\u30fc\u30eb\u306e\u30ac\u30f3\u30de\u95a2\u6570\u306e\u5fae\u5206\u3001\u30c7\u30a3\u30ac\u30f3\u30de\u95a2\u6570\u3068\u3057\u3066\u65b0\u3057\u304f\u5b9a\u7fa9\u3057\u305f\u3002\n\u03d5(x)=ddxlog(\u0393(x))=\u0393\u2032(x)\u0393(x) \n\\begin{eqnarray} \n\\phi(x) = \\frac{d}{dx} log(\\Gamma(x)) = \\frac{\\Gamma'(x)}{\\Gamma(x)} \n\\end{eqnarray} \n\nL(\u03b1) L(\\b{\\alpha})  \u306f\u51f8\u6027\u3092\u6301\u3063\u3066\u3044\u308b\u3053\u3068\u3092\u793a\u305b\u308b\u306e\u3067\u6975\u5024\u306f\u4e00\u3064\u3002\n\u3059\u306a\u308f\u3061\n\u2202L(\u03b1)\u2202\u03b1=0 \n\\begin{eqnarray} \n\\frac{\\partial L(\\b{\\alpha})}{\\partial \\b{\\alpha}} = \\b{0} \n\\end{eqnarray} \n\n\u3092\u6e80\u305f\u3059\u70b9\u304c\u6700\u5927\u5024\u3092\u53d6\u308b \u03b1\\alpha \u306b\u306a\u308b\u3002\n\u89e3\u6790\u89e3\u304c\u306a\u3044\u306e\u3067\u3053\u306e\u5024\u3092\u6570\u5024\u89e3\u6790\u3067\u6c42\u3081\u308b\u3002\u4e0d\u52d5\u70b9\u53cd\u5fa9\u6cd5\u3068\u30cb\u30e5\u30fc\u30c8\u30f3\u6cd5\u3001\u6700\u6025\u52fe\u914d\u6cd5\u306e3\u3064\u306e\u65b9\u6cd5\u304c\u5229\u7528\u3067\u304d\u308b\u3002\u8ad6\u6587\u3067\u306f\u4e0d\u52d5\u70b9\u53cd\u5fa9\u6cd5\u3068\u30cb\u30e5\u30fc\u30c8\u30f3\u6cd5\u306b\u3064\u3044\u3066\u306e\u8aac\u660e\u3092\u3057\u3066\u3044\u308b\u306e\u3067\u305d\u308c\u306b\u5f93\u3046\u3002\n\n\u4e0d\u52d5\u70b9\u53cd\u5fa9\u6cd5\u306b\u3088\u308b\u89e3\u6cd5\n\u307e\u305a\u4e00\u822c\u7684\u306a\u4e0d\u52d5\u70b9\u53cd\u5fa9\u6cd5\u306e1\u5909\u6570\u306e\u5834\u5408\u306b\u3064\u3044\u3066\u8aac\u660e\u3059\u308b\u3002\n\u3053\u306e\u65b9\u6cd5\u306f\u4ee5\u4e0b\u306e\u69d8\u306a\u4e0d\u7b49\u5f0f\u3092\u6e80\u305f\u3059 x \u306b\u5bfe\u3057\u3066\nx=f(x) \nx = f(x) \n\n\u6b21\u306e\u3088\u3046\u306a\u6f38\u5316\u5f0f\u3092\u7e70\u308a\u8fd4\u3057\u7528\u3044\u308b\u3053\u3068\u3067\u7b54\u3048\u3092\u6c42\u3081\u308b\u65b9\u6cd5\u3067\u3042\u308b\u3002\nx(t)=f(x(t\u22121)) \nx^{(t)} = f(x^{(t-1)}) \n\n\u3082\u3061\u308d\u3093\u3069\u306e\u3088\u3046\u306a\u95a2\u6570 f(x) f(x)  \u306b\u5bfe\u3057\u3066\u3082\u4e0a\u8a18\u306e\u6f38\u5316\u5f0f\u3092\u7528\u3044\u3066\u7b54\u3048\u3092\u6c42\u3081\u308b\u3053\u3068\u304c\u3067\u304d\u308b\u308f\u3051\u3067\u306f\u306a\u3044\u3002\u30ea\u30d7\u30b7\u30c3\u30c4\u9023\u7d9a\u6027\u3068\u3044\u3046\u6027\u8cea\u3092\u6e80\u305f\u3059\u5834\u5408\u306e\u307f\u53ef\u80fd\u3067\u3042\u308b\u304c\u305d\u306e\u8a3c\u660e\u306f\u3053\u3053\u3067\u306f\u884c\u308f\u306a\u3044\u3002\n\u3055\u3066\u3053\u306e\u95a2\u4fc2\u6027\u3092\u591a\u6b21\u5143\u5909\u6570\u306e\u95a2\u6570\u3067\u3042\u308b (11) \u306e\u65b9\u7a0b\u5f0f\u306b\u5bfe\u3057\u3066\u3082\u6210\u308a\u7acb\u3064\u3068\u4eee\u5b9a\u3059\u308b\u3068\u4ee5\u4e0b\u306e\u5f0f\u3092\u7528\u3044\u3066\u66f4\u65b0\u3059\u308c\u3070\u76ee\u7684\u306e\u5024\u3092\u6c42\u3081\u3089\u308c\u305d\u3046\u3067\u3042\u308b\u3002\n\u03c8(\u03b1(t)i)=\u03c8(n\u2211k=1\u03b1(t\u22121)k)+log(~pi)\u03b1(t)i=\u03c8\u22121(\u03c8(n\u2211k=1\u03b1(t\u22121)k)+log(~pi)) \n\\begin{eqnarray} \n\\psi(\\alpha_i^{(t)})  & = & \\psi(\\sum_{k=1}^n \\alpha_k^{(t-1)}) + log(\\tilde{p_i}) \\\\ \n\\alpha_i^{(t)} & = & \\psi^{-1}(\\psi(\\sum_{k=1}^n \\alpha_k^{(t-1)}) + log(\\tilde{p_i})) \\\\ \n\\end{eqnarray} \n\n\u3053\u308c\u3092\u793a\u3059\u305f\u3081\u306b\u4ee5\u4e0b\u306e\u30bb\u30af\u30b7\u30e7\u30f3\u306e Appendix B \u3067\u4e0e\u3048\u305f\u4e0d\u7b49\u5f0f\u3092\u5229\u7528\u3057\u3066\u5c24\u5ea6\u306e\u4e0b\u9650\u3092\u6c42\u3081\u3066\u305d\u306e\u4e0b\u9650\u306e\u6700\u5927\u306e\u6c42\u3081\u308b\u3053\u3068\u3067\u3001\u4e0a\u8a18\u306e\u66f4\u65b0\u5f0f\u3068\u540c\u3058\u5f0f\u3092\u5f97\u3089\u308c\u308b\u3053\u3068\u3092\u793a\u3059\u3002 \u02dcx=\u2211nk=1\u03b1(t\u22121)k \\tilde{x} = \\sum_{k=1}^n \\alpha_k^{(t-1)}  \u3068\u3057\u3066\u56fa\u5b9a\u3057\u305f\u6642\u3001(5)\u306e\u4e00\u756a\u76ee\u306e\u9805\u306b\u5bfe\u3057 Appendix B \u306e\u4e0d\u7b49\u5f0f\u3092\u9069\u7528\u3059\u308b\u3053\u3068\u3067\nL(\u03b1)N\u2265log{\u0393(n\u2211k=1\u03b1(t\u22121)k)exp((n\u2211k=1\u03b1k\u2212\u03b1(t\u22121)k)\u03c8(n\u2211k=1\u03b1(t\u22121)k)))}\u2212n\u2211k=1log(\u0393(\u03b1k))+n\u2211k=1(\u03b1k\u22121)log(~pk)=(n\u2211k=1\u03b1k)\u03c8(n\u2211k=1\u03b1(t\u22121)k)\u2212n\u2211k=1log(\u0393(\u03b1k))+n\u2211k=1(\u03b1k\u22121)log(~pk)+const(\u03b1(t\u22121)k) \n\\begin{eqnarray} \n\\frac{L(\\b{\\alpha})}{N} & \\ge & log \\{ \\Gamma(\\sum_{k=1}^n \\alpha_k^{(t-1)}) exp((\\sum_{k=1}^n \\alpha_k - \\alpha_k^{(t-1)})\\psi(\\sum_{k=1}^n \\alpha_k^{(t-1)}))) \\} \\nonumber \\\\ \n& & - \\sum_{k=1}^{n} log(\\Gamma(\\alpha_k)) + \\sum_{k=1}^n (\\alpha_k-1)log(\\tilde{p_k})  \\nonumber \\\\ \n& = & (\\sum_{k=1}^n \\alpha_k) \\psi(\\sum_{k=1}^n \\alpha_k^{(t-1)}) - \\sum_{k=1}^{n} log(\\Gamma(\\alpha_k)) + \\sum_{k=1}^n (\\alpha_k-1)log(\\tilde{p_k}) + const(\\alpha_k^{(t-1)}) \n\\end{eqnarray} \n\n\u3053\u3053\u3067 \u03b1(t\u22121)k \\alpha_k^{(t-1)}  \u306f\u5b9a\u6570\u3068\u307f\u306a\u3057\u3066\u3044\u308b\u3002\u3088\u3063\u3066\u3001\u3053\u308c\u3089\u306e\u9805\u306e\u307f\u306e\u90e8\u5206\u3092 const(\u03b1(t\u22121)k) const(\\alpha_k^{(t-1)})  \u3067\u307e\u3068\u3081\u305f\u3002\n\u4e0a\u8a18\u306e\u4e0d\u7b49\u5f0f\u306e\u53f3\u8fba\u3092 G(\u03b1) G(\\b{\\alpha})  \u3068\u3057\u3066 \u03b11,\u03b12,...\u03b1k \\alpha_1, \\alpha_2, ... \\alpha_k  \u306b\u3064\u3044\u3066\u6700\u5927\u5316\u3055\u305b\u308b\u3068\u4e0d\u52d5\u70b9\u53cd\u5fa9\u6cd5\u306e\u66f4\u65b0\u5f0f\u3068\u540c\u3058\u5f0f\u3092\u5f97\u308b\u3002\n\u2202\u2202\u03b1iG(\u03b1)=\u03c8(n\u2211k=1\u03b1(t\u22121)k)\u2212n\u2211k=1\u2202\u03b1k\u2202\u03b1i\u03c8(\u03b1k)+n\u2211k=1\u2202\u03b1k\u2202\u03b1ilog(~pk)=\u03c8(n\u2211k=1\u03b1(t\u22121)k)\u2212\u03c8(\u03b1i)+log(~pi) \n\\begin{eqnarray} \n\\frac{\\partial}{\\partial \\alpha_i} G(\\b{\\alpha}) & = & \\psi(\\sum_{k=1}^n \\alpha_k^{(t-1)}) - \\sum_{k=1}^n \\frac{\\partial \\alpha_k}{\\partial \\alpha_i} \\psi(\\alpha_k) + \\sum_{k=1}^n \\frac{\\partial \\alpha_k}{\\partial \\alpha_i} log(\\tilde{p_k}) \\\\ \n& = & \\psi(\\sum_{k=1}^n \\alpha_k^{(t-1)}) - \\psi(\\alpha_i) +  log(\\tilde{p_i}) \n\\end{eqnarray} \n\n\u5fae\u5206 = 0 \u3067\u505c\u7559\u70b9\u304c\u5f97\u3089\u308c\u308b\u306e\u3067\n\u2202\u2202\u03b1iG(\u03b1)=0\u03c8(n\u2211k=1\u03b1(t\u22121)k)\u2212\u03c8(\u03b1i)+log(~pi)=0\u03c8(\u03b1i)=\u03c8(n\u2211k=1\u03b1(t\u22121)k)+log(~pi) \n\\begin{eqnarray} \n\\frac{\\partial}{\\partial \\alpha_i} G(\\b{\\alpha}) & = & 0 \\\\ \n\\psi(\\sum_{k=1}^n \\alpha_k^{(t-1)}) - \\psi(\\alpha_i) +  log(\\tilde{p_i}) & = & 0 \\\\ \n\\psi(\\alpha_i) & = & \\psi(\\sum_{k=1}^n \\alpha_k^{(t-1)}) + log(\\tilde{p_i}) \n\\end{eqnarray} \n\n\u3053\u306e\u3088\u3046\u306b\u4e0b\u9650\u5024\u306e\u6700\u5927\u5316\u3067\u3082\u4e0d\u52d5\u70b9\u53cd\u5fa9\u6cd5\u3092\u4eee\u5b9a\u3057\u3066\u5c0e\u51fa\u3057\u305f\u66f4\u65b0\u5f0f\u3092\u540c\u3058\u5f0f\u304c\u5f97\u3089\u308c\u305f\u3002\uff08\u4e0b\u9650\u5024\u306e\u6700\u5927\u5316\u3092\u7e70\u308a\u8fd4\u3057\u884c\u3046\u3068\u3044\u3046\u610f\u5473\u3067EM\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u306b\u4f3c\u3066\u3044\u308b\uff09\n\u3053\u3053\u3067\u4e0b\u9650\u306e G(\u03b1) G(\\b{\\alpha})  \u3092\u6700\u5927\u5024\u3092\u3068\u308b\u30d1\u30e9\u30e1\u30fc\u30bf\u30fc\u304c \u03c8(\u03b1i)=\u03c8(\u03b1(t)k) \\psi(\\alpha_i) = \\psi(\\alpha_k^{(t)})  \u3068\u306a\u3063\u3066\u3044\u308b\u3002\n\n\u30cb\u30e5\u30fc\u30c8\u30f3\u6cd5\u306b\u3088\u308b\u89e3\u6cd5\n\u30cb\u30e5\u30fc\u30c8\u30f3\u6cd5\u306b\u3088\u308b\u89e3\u6cd5\u3082\u7d39\u4ecb\u3059\u308b\u3002\n\u591a\u6b21\u5143\u306e\u30cb\u30e5\u30fc\u30c8\u30f3\u6cd5\u306f\u4ee5\u4e0b\u3092\u6e80\u305f\u3059 x \\b{x}  \u3092\u5f97\u308b\u65b9\u6cd5\u3067\u3042\u308b\u3002\nf(x)=0 \n\\begin{eqnarray} \n\\b{f}(\\b{x}) = \\b{0} \n\\end{eqnarray} \n\nf(x) \\b{f}(\\b{x})  \u3092\u9069\u5f53\u306a\u70b9 x\u2217 \\b{x^{\\ast}}  \u306b\u5bfe\u3057\u3066\u30c6\u30a4\u30e9\u30fc\u5c55\u958b\u3059\u308b\u3068\nf(x)=f(x\u2217)+\u2202f(x\u2217)\u2202x(x\u2212x\u2217)+O((x\u2212x\u2217)2) \n\\begin{eqnarray} \n\\b{f}(\\b{x}) = \\b{f}(\\b{x^{\\ast}}) + \\frac{\\partial \\b{f}(\\b{x^{\\ast}})}{\\partial \\b{x}}(\\b{x} - \\b{x^{\\ast}}) + O((\\b{x} - \\b{x^{\\ast}})^2) \n\\end{eqnarray} \n\n\u4e8c\u6b21\u4ee5\u964d\u306e\u5fae\u5c0f\u91cf\u3092\u7121\u8996\u3057\u3066f(x)=0\\b{f}(\\b{x}) = \\b{0} \u3092\u4ee3\u5165\u3057\u3001 x\\b{x} \u306b\u3064\u3044\u3066\u89e3\u304f\u3068\u4ee5\u4e0b\u306e\u5f0f\u3092\u5f97\u308b\u3002\nx=x\u2217\u2212(\u2202f(x\u2217)\u2202x)\u22121f(x\u2217) \n\\begin{eqnarray} \n\\b{x} = \\b{x^{\\ast}} - \\left(\\frac{\\partial \\b{f}(\\b{x^{\\ast}})}{\\partial \\b{x}}\\right)^{-1} \\b{f}(\\b{x^{\\ast}}) \n\\end{eqnarray} \n\n\u3053\u308c\u304c\u30cb\u30e5\u30fc\u30c8\u30f3\u6cd5\u306e\u66f4\u65b0\u5f0f\u3067\u3042\u308b\u3002\n\u3055\u3066\u4eca\u6c42\u3081\u305f\u3044\u5024\u306f \u2202L(\u03b1)\u2202\u03b1=0 \\frac{\\partial L(\\b{\\alpha})}{\\partial \\b{\\alpha}} = \\b{0}  \u306a\u306e\u3067\u3001L(\u03b1) L(\\b{\\alpha})  \u3092\u3082\u3046\u4e00\u5ea6\u5fae\u5206\u3059\u308b\u3002\n1N\u22022L(\u03b1)\u2202\u03b1j\u2202\u03b1i=\u03c8\u2032(n\u2211k=1\u03b1k)(n\u2211k=1\u2202\u03b1k\u2202\u03b1j)+\u03c8\u2032(\u03b1i)\u2202\u03b1i\u2202\u03b1j=\u03c8\u2032(n\u2211k=1\u03b1k)\u2212\u03c8\u2032(\u03b1i)\u03b4i,j \n\\begin{eqnarray} \n\\frac{1}{N} \\frac{\\partial^2 L(\\b{\\alpha})}{\\partial \\alpha_j \\partial \\alpha_i} & =  & \\psi'(\\sum_{k=1}^n \\alpha_k) (\\sum_{k=1}^n \\frac{\\partial \\alpha_k}{\\partial \\alpha_j}) + \\psi'(\\alpha_i) \\frac{\\partial \\alpha_i}{\\partial \\alpha_j} \\\\ \n& = & \\psi'(\\sum_{k=1}^n \\alpha_k) - \\psi'(\\alpha_i) \\delta_{i,j} \n\\end{eqnarray} \n\n{H(\u03b1)}i,j=\u2202L(\u03b1)\u2202\u03b1j\u2202\u03b1i\\{ \\b{H(\\b{\\alpha})} \\}_{i,j} = \\frac{\\partial L(\\b{\\alpha})}{\\partial \\alpha_j \\partial \\alpha_i} \u3068\u3057\u3066\u65b0\u3057\u304f\u30d8\u30c3\u30bb\u884c\u5217\u3092\u5b9a\u7fa9\u3059\u308b\u3002\u307e\u305f\u3001 z=N\u00a0\u03c8\u2032(\u2211nk=1\u03b1k) z = N ~ \\psi'(\\sum_{k=1}^n \\alpha_k)  \u3068 {Q}i,j=\u2212N\u00a0\u03c8\u2032(\u03b1i)\u03b4i,j \\{ \\b{Q} \\}_{i,j} = - N ~ \\psi'(\\alpha_i) \\delta_{i,j} , {g(\u03b1)}i=\u2202L(\u03b1)\u2202\u03b1i \\{\\b{g}(\\b{\\alpha})\\}_{i} = \\frac{\\partial L(\\alpha)}{\\partial \\alpha_i}  \u3068\u65b0\u3057\u3044\u884c\u5217\u30fb\u95a2\u6570\u30fb\u30d9\u30af\u30c8\u30eb z,Q,g z, \\b{Q}, \\b{g}  \u3092\u5b9a\u3081\u308b\u3002\u30d8\u30c3\u30bb\u884c\u5217 H \\b{H}  \u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u8868\u305b\u308b\u3002\nH=Q+11tz \n\\begin{eqnarray} \n\\b{H} = \\b{Q} + \\b{1 1^t}z \n\\end{eqnarray} \n\nL(\u03b1) L(\\b{\\alpha})  \u306b\u5bfe\u3057\u3066\u30cb\u30e5\u30fc\u30c8\u30f3\u6cd5\u3092\u9069\u7528\u3059\u308b\u3068\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u8868\u305b\u308b\u3002\n\u03b1(t)=\u03b1(t\u22121)\u2212H\u22121(\u03b1(t\u22121))g(\u03b1(t\u22121)) \n\\begin{eqnarray} \n\\b{\\alpha^{(t)}} = \\b{\\alpha^{(t-1)}} - \\b{H}^{-1}(\\b{\\alpha^{(t-1)}}) \\b{g}(\\b{\\alpha^{(t-1)}}) \n\\end{eqnarray} \n\n\u66f4\u65b0\u5f0f\u3067\u306f H,g \\b{H}, \\b{g}  \u304c\u305d\u308c\u305e\u308c x(t\u22121) \\b{x^{(t-1)}}  \u306b\u4f9d\u5b58\u3057\u3066\u3044\u308b\u3053\u3068\u3092\u660e\u793a\u7684\u306b\u793a\u3059\u305f\u3081\u306b\u62ec\u5f27\u3092\u5165\u308c\u305f\u3002\u30cb\u30e5\u30fc\u30c8\u30f3\u6cd5\u3067\u306f H \\b{H}  \u306e\u9006\u884c\u5217\u3092\u7528\u3044\u308b\u306e\u3067\u3001\u3053\u308c\u3092\u89e3\u6790\u7684\u306b\u8868\u3057\u305f\u3044\u3002\u305d\u306e\u305f\u3081\u306b Appendix C \u3067\u8aac\u660e\u3057\u3066\u3044\u308b Sherman\u2013Morrison \u306e\u516c\u5f0f\u3092\u7528\u3044\u3066\u5f0f\u306e\u5909\u5f62\u3092\u884c\u3046\u3068\nH\u22121g=(Q+11tz)\u22121g=Q\u22121g\u2212Q\u2212111tQ\u22121g1z+1tQ\u221211=Q\u22121g\u2212Q\u221211(1tQ\u22121g1z+1tQ\u221211)=Q\u22121(g\u22121b) \n\\begin{eqnarray} \n\\b{H}^{-1}\\b{g} & = & (\\b{Q} + \\b{1 1^t} z)^{-1}\\b{g} \\\\ \n& = & \\b{Q}^{-1}\\b{g} - \\frac{\\b{Q^{-1} 1 1^t Q^{-1} g}}{\\frac{1}{z}+\\b{1^t Q^{-1} 1}} \\\\ \n& = & \\b{Q}^{-1}\\b{g} - \\b{Q^{-1} 1} (\\frac{\\b{1^t Q^{-1} g}}{\\frac{1}{z}+\\b{1^t Q^{-1} 1}}) \\\\ \n& = & \\b{Q}^{-1} (\\b{g} - \\b{1}b) \n\\end{eqnarray} \n\n\u3053\u3053\u3067 b b  \u306f\u4ee5\u4e0b\u306e\u5b9a\u6570\u3067\u3042\u308b\u3002\nb=1tQ\u22121g1z+1tQ\u221211 \n\\begin{eqnarray} \nb = \\frac{\\b{1^t Q^{-1} g}}{\\frac{1}{z}+\\b{1^t Q^{-1} 1}} \n\\end{eqnarray} \n\nH\u22121g \\b{H}^{-1} \\b{g} \u3000\u306e\u5404\u9805\u3092\u5177\u4f53\u7684\u306b\u6c42\u3081\u308b\u3068\u3000{Q}i,j=\u2212N\u00a0\u03c8\u2032(\u03b1i)\u03b4i,j \\{\\b{Q}\\}_{i,j} = - N ~ \\psi'(\\alpha_i) \\delta_{i,j}  \u3092\u76f4\u63a5\u4ee3\u5165\u3059\u308b\u3053\u3068\u3067\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u306a\u308b\u3002\n{H\u22121g}k={Q\u22121(g\u22121b)}k=\u2211j{Q\u22121}k,j(g\u22121b)j=\u2211j\u03b4k,j\u2212N\u00a0\u03c8\u2032(\u03b1k)(gj\u2212b)=gk\u2212b\u2212N\u00a0\u03c8\u2032(\u03b1k)=gk\u2212b{Q}k,k \n\\begin{eqnarray} \n\\{\\b{H}^{-1} \\b{g}\\}_{k} & = & \\{ \\b{Q}^{-1} (\\b{g} - \\b{1}b) \\}_{k} \\\\ \n& = & \\sum_{j} \\{\\b{Q^{-1}}\\}_{k,j} (\\b{g} - \\b{1} b)_{j} \\\\ \n& = & \\sum_{j} \\frac{\\delta_{k,j}}{-N ~ \\psi'(\\alpha_k)} (g_j - b) \\\\ \n& = & \\frac{g_k - b}{-N ~ \\psi'(\\alpha_k)} \\\\ \n& = & \\frac{g_k - b}{\\{\\b{Q}\\}_{k,k}} \n\\end{eqnarray} \n\n\n\u30cb\u30e5\u30fc\u30c8\u30f3\u6cd5\u307e\u3068\u3081\n\u3053\u308c\u3089\u306e\u7d50\u679c\u3092\u307e\u3068\u3081\u308b\u3068\u30cb\u30e5\u30fc\u30c8\u30f3\u6cd5\u306e\u66f4\u65b0\u5f0f\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u7c21\u6f54\u306b\u8868\u305b\u308b\u3002\n\u03b1(t)=\u03b1(t\u22121)\u2212H\u22121g{H\u22121g}k=(gk\u2212b){Q\u22121}k,kb=1tQ\u22121g1z+1tQ\u221211{g}k=N\u00a0\u03c8(n\u2211k=1\u03b1(t\u22121)k)\u2212N\u00a0\u03c8(\u03b1(t\u22121)k)+N\u00a0log(~pk)z=N\u00a0\u03c8\u2032(n\u2211k=1\u03b1(t\u22121)k){Q\u22121}i,j=\u2212\u03b4i,jN\u00a0\u03c8\u2032(\u03b1(t\u22121)i) \n\\begin{eqnarray} \n\\b{\\alpha}^{(t)} & = & \\b{\\alpha}^{(t-1)} - \\b{H^{-1} g} \\\\ \n\\{\\b{H^{-1} g}\\}_{k} & = & (g_k - b)\\{\\b{Q^{-1}}\\}_{k,k} \\\\ \nb & = & \\frac{\\b{1^t Q^{-1} g}}{\\frac{1}{z} + \\b{1^t Q^{-1} 1}} \\\\ \n\\{\\b{g}\\}_{k} & = & N ~ \\psi(\\sum_{k=1}^n \\alpha_k^{(t-1)}) - N ~ \\psi(\\alpha_k^{(t-1)}) + N ~ log(\\tilde{p_k}) \\\\ \nz & = & N ~ \\psi'(\\sum_{k=1}^n \\alpha_k^{(t-1)}) \\\\ \n\\{\\b{Q}^{-1}\\}_{i,j} & = & - \\frac{\\delta_{i,j}}{N ~ \\psi'(\\alpha_i^{(t-1)})} \\\\ \n\\end{eqnarray} \n\n\nAppendix List\n\nAppendix A: \u30c7\u30a3\u30ac\u30f3\u30de\u95a2\u6570\u306e\u8a08\u7b97\u3068\u6027\u8cea\n\n\u30c7\u30a3\u30ac\u30f3\u30de\u95a2\u6570\u306e\u6f38\u8fd1\u5c55\u958b\n\u6700\u521d\u306f\u30c7\u30a3\u30ac\u30f3\u30de\u95a2\u6570\u306e\u5177\u4f53\u7684\u306a\u7d1a\u6570\u8868\u793a\u3092\u5c0e\u304f\u3002\n\u30c7\u30a3\u30ac\u30f3\u30de\u95a2\u6570\u306e\u5b9a\u7fa9\u306f \u2202\u2202xlog\u0393(x) \\frac{\\partial}{\\partial x} log \\Gamma(x)  \u3067\u3042\u308b\u3002log log  \u304c\u5165\u3063\u3066\u3044\u308b\u306e\u3067\u3001\u307e\u305a\u30ac\u30f3\u30de\u95a2\u6570\u3092\u639b\u3051\u7b97\u306e\u4e57\u7a4d\u8868\u793a\u3068\u3057\u3066\u8868\u305b\u308b\u3068\u4fbf\u5229\u3067\u3042\u308d\u3046\u3002\u3053\u308c\u306f\u30ef\u30a4\u30a8\u30eb\u30b7\u30e5\u30c8\u30e9\u30b9\u306e\u7121\u9650\u4e57\u7a4d\u8868\u793a\u3092\u7528\u3044\u308b\u3053\u3068\u3067\u89e3\u6c7a\u3059\u308b\u3002\n\u30ef\u30a4\u30a8\u30eb\u30b7\u30e5\u30c8\u30e9\u30b9\u306e\u7121\u9650\u4e57\u7a4d\u8868\u793a\u306f\u4ee5\u4e0b\u306e\u95a2\u4fc2\u5f0f\u306e\u3053\u3068\u3092\u6307\u3059\n\u0393(x)=limn\u2192\u221en!nx(n+x)(n+x\u22121)...(x+1)x \n\\begin{eqnarray} \n\\Gamma(x) & =  & \\lim_{n \\to \\infty} \\frac{n!n^x}{(n+x)(n+x-1)...(x+1)x} \n\\end{eqnarray} \n\n\u3053\u306e\u5f0f\u306e\u5c0e\u51fa\u65b9\u6cd5\u306b\u3064\u3044\u3066\u3082\u3001\u6570\u5b66\u7684\u306a\u53b3\u5bc6\u6027\u306f\u72a0\u7272\u306b\u3057\u3066\u3067\u304d\u308b\u3060\u3051\u76f4\u611f\u7684\u306b\u8aac\u660e\u3059\u308b\u3002\u307e\u305a\u968e\u4e57\u3092\u8868\u3059\u30ac\u30f3\u30de\u95a2\u6570\u304c\u4e0e\u3048\u3089\u308c\u3066\u3044\u308b\u3068\u3057\u3088\u3046\u3002\u3053\u306e\u30ac\u30f3\u30de\u95a2\u6570\u306e\u5177\u4f53\u7684\u306a\u5f62\u3092\u77e5\u3089\u306a\u304b\u3063\u305f\u3068\u3057\u3066\u30ac\u30f3\u30de\u95a2\u6570\u3092\u81ea\u7136\u6570\u304b\u3089\u5b9f\u6570\u306b\u62e1\u5f35\u3057\u305f\u3044\u3002\u305d\u306e\u3088\u3046\u306a\u30b1\u30fc\u30b9\u3068\u3057\u3066\u8003\u3048\u3088\u3046\u3002\n\u6700\u521d\u306e\u51fa\u767a\u70b9\u306f\u4ee5\u4e0b\u306e\u8fd1\u4f3c\u5f0f\u3067\u3042\u308b\u3002\nk<<n k << n  \u306e\u6642\n\u0393(n+k+1)\u0393(n+1)=(n+k)(n+k\u22121)...(n+1)\u2245nk \n\\begin{eqnarray} \n\\frac{\\Gamma(n+k+1)}{\\Gamma(n+1)} & = & (n+k)(n+k-1)...(n+1) \\\\ \n& \\cong & n^k \n\\end{eqnarray} \n\n\u3067\u3042\u308b\u3002\u3053\u3053\u3067 k k  \u306b\u5bfe\u3057\u3066\u81ea\u7136\u6570\u304b\u3089\u5b9f\u6570\u3078\u306e\u62e1\u5f35\u3092\u8a66\u307f\u308b\u3002\u4e0a\u8a18\u306e\u95a2\u4fc2\u3092\u5b9f\u6570 x x  \u306b\u3064\u3044\u3066\u3082\u6210\u308a\u7acb\u3064\u3068\u62e1\u5f35\u3059\u308b\u306e\u306f\u81ea\u7136\u3067\u3042\u308d\u3046\u3002\u3059\u306a\u308f\u3061 x<<n x << n  \u3068\u3057\u3066\n\u0393(n+x+1)\u0393(n+1)\u2245nx \n\\begin{eqnarray} \n\\frac{\\Gamma(n+x+1)}{\\Gamma(n+1)} & \\cong & n^x \n\\end{eqnarray} \n\n\u5341\u5206\u5927\u304d\u306a n \u306b\u3064\u3044\u3066 \u4e0a\u8a18\u306e\u5f0f\u304c\u6210\u308a\u7acb\u3064\u3068\u4eee\u5b9a\u3057\u3001\u305d\u308c\u305e\u308c\u4e21\u8fba\u3092\u5c55\u958b\u3059\u308b\u3068\nlimn\u2192\u221e(n+x)(n+x\u22121)...(x+1)x\u0393(x)n!=limn\u2192\u221enx\u0393(x)=limn\u2192\u221en!nx(n+x)(n+x\u22121)...(x+1)x \n\\begin{eqnarray} \n\\lim_{n \\to \\infty} \\frac{(n+x)(n+x-1)...(x+1)x\\Gamma(x)}{n!} & = & \\lim_{n \\to \\infty} n^x \\\\ \n\\Gamma(x) & =  & \\lim_{n \\to \\infty} \\frac{n!n^x}{(n+x)(n+x-1)...(x+1)x} \n\\end{eqnarray} \n\n\u3068\u30ef\u30a4\u30a8\u30eb\u30b7\u30e5\u30c8\u30e9\u30b9\u306e\u7121\u9650\u4e57\u7a4d\u8868\u793a\u3092\u5c0e\u304f\u3053\u3068\u304c\u3067\u304d\u308b\u3002\n\u3055\u3066\u3053\u308c\u3092\u7528\u3044\u3066\u30c7\u30a3\u30ac\u30f3\u30de\u95a2\u6570\u306e\u5177\u4f53\u7684\u306a\u5f62\u3092\u6c42\u3081\u308b\u3002\n\u2202\u2202xlog(\u0393(x))=limn\u2192\u221e\u2202\u2202xlog(n!nx\u220fni=0(i+x))=limn\u2192\u221e\u2202\u2202x{n\u2211i=1log(i)\u2212log(i+x)}\u2212log(x)+x\u00a0log(n)=limn\u2192\u221e{\u2212n\u2211i=11i+x\u22121x+log(n)}=\u22121x+limn\u2192\u221e{(n\u2211i=11i\u22121i+x)\u2212(n\u2211i=1\u22121i+log(n))}=\u2212\u03b3\u22121x+(\u221e\u2211i=11i\u22121i+x) \n\\begin{eqnarray} \n\\frac{\\partial}{\\partial x} log(\\Gamma(x)) & = & \\lim_{n \\to \\infty} \\frac{\\partial}{\\partial x} log(\\frac{n!n^x}{\\prod_{i=0}^n (i+x)}) \\\\ \n& = & \\lim_{n \\to \\infty} \\frac{\\partial}{\\partial x} \\{ \n \\sum_{i=1}^n log(i) - log(i+x) \\} - log(x) + x ~ log(n) \\\\ \n& = & \\lim_{n \\to \\infty} \\{- \\sum_{i=1}^n \\frac{1}{i+x} - \\frac{1}{x} + log(n) \\} \\\\ \n& = & - \\frac{1}{x} + \\lim_{n \\to \\infty} \\{ (\\sum_{i=1}^n \\frac{1}{i} - \\frac{1}{i+x}) - (\\sum_{i=1}^n -\\frac{1}{i}  + log(n)) \\} \\\\ \n& = & -\\gamma - \\frac{1}{x} +  (\\sum_{i=1}^{\\infty} \\frac{1}{i} - \\frac{1}{i+x}) \\\\ \n\\end{eqnarray} \n\n\u305f\u3060\u3057 \u03b3 \\gamma  \u306f\u30aa\u30a4\u30e9\u30fc\u5b9a\u6570\u3067\u4ee5\u4e0b\u306e\u6975\u9650\u3067\u3042\u308b\u3002\n\u03b3=limn\u2192\u221e(log(n)\u2212n\u2211i=11i) \n\\begin{eqnarray} \n\\gamma = \\lim_{n \\to \\infty} (log(n) - \\sum_{i=1}^n \\frac{1}{i}) \n\\end{eqnarray} \n\n\u3053\u3053\u3067\u4ee5\u4e0b\u306e\u95a2\u4fc2\u5f0f\u304c\u6210\u308a\u7acb\u3064\u3053\u3068\u306b\u6ce8\u76ee\u3059\u308b\u3068\n\u03d5(x+1)=\u2202\u2202xlog\u0393(x+1)=\u2202\u2202x(log(x)+\u0393(x))=1x+\u03d5(x) \n\\begin{eqnarray} \n\\phi(x + 1) & = & \\frac{\\partial}{\\partial x} log \\Gamma(x + 1) \\\\ \n& = & \\frac{\\partial}{\\partial x} (log(x) + \\Gamma(x)) \\\\ \n& = & \\frac{1}{x} + \\phi(x) \n\\end{eqnarray} \n\n\u5148\u307b\u3069\u306e\u5f0f\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u8868\u305b\u308b\u3002\n\u03c8(x+1)=\u2212\u03b3+(\u221e\u2211i=11i\u22121i+x) \n\\begin{eqnarray} \n\\psi(x+1) = -\\gamma  + (\\sum_{i=1}^{\\infty} \\frac{1}{i} - \\frac{1}{i+x}) \n\\end{eqnarray} \n\n\u3053\u306e\u3088\u3046\u306b\u5177\u4f53\u7684\u306a\u30c7\u30a3\u30ac\u30f3\u30de\u95a2\u6570\u306e\u7d1a\u6570\u8868\u793a\u304c\u5f97\u3089\u308c\u305f\u3002\n\u307e\u305f\u4e8c\u968e\u5fae\u5206\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u306a\u308b\u3002\n\u03c8\u2032(x+1)=\u221e\u2211i=11(i+x)2 \n\\begin{eqnarray} \n\\psi'(x+1) = \\sum_{i=1}^{\\infty} \\frac{1}{(i+x)^2} \\\\ \n\\end{eqnarray} \n\n\u3053\u306e\u4e8c\u968e\u5fae\u5206\u306f\u90062\u4e57\u548c\u306a\u306e\u3067\u53ce\u675f\u306f\u6975\u3081\u3066\u9045\u3044\u3002\n\u305d\u306e\u305f\u3081\u3088\u308a\u53ce\u675f\u304c\u65e9\u3044\u95a2\u6570\u306e\u7d1a\u6570\u3068\u3057\u3066\u8868\u3057\u305f\u3044\u3002\u305d\u306e\u305f\u3081\u306b\u30aa\u30a4\u30e9\u30fc\u30de\u30af\u30ed\u30fc\u30ea\u30f3\u306e\u548c\u516c\u5f0f\u3092\u4f7f\u3063\u3066\u30d9\u30eb\u30cc\u30fc\u30a4\u6570\u306e\u7d1a\u6570\u3068\u3057\u3066\u8868\u3059\u3002\n\n\u30aa\u30a4\u30e9\u30fc\u30de\u30af\u30ed\u30fc\u30ea\u30f3\u306e\u548c\u516c\u5f0f\n\u30aa\u30a4\u30e9\u30fc\u306e\u548c\u516c\u5f0f\u3092\u8aac\u660e\u3059\u308b\u3002\u5fae\u5206\u6f14\u7b97\u5b50\u3092 D=ddx D = \\frac{d}{dx}  \u3068\u3059\u308b\u3002\n\u3053\u306e\u6642\u30c6\u30a4\u30e9\u30fc\u5c55\u958b\u3092\u7528\u3044\u308b\u3068\nf(x+n)=\u221e\u2211k=0Dkf(x)k!nk=(\u221e\u2211k=0(nD)kn!)f(x)=enDf(x) \n\\begin{eqnarray} \nf(x+n) & = & \\sum_{k=0}^{\\infty} \\frac{D^k f(x)}{k !} n^k \\\\ \n& = & (\\sum_{k=0}^{\\infty} \\frac{(n D)^k }{n!}) f(x) \\\\ \n& = & e^{nD} f(x) \n\\end{eqnarray} \n\n\u3053\u308c\u3088\u308a\nN\u22121\u2211k=0f(x+n)=N\u22121\u2211n=0enDf(x)=eN\u00a0D\u22121eD\u22121f(x)=1eD\u22121(f(x+N)\u2212f(x))=(D\u22121+\u221e\u2211n=1Bnn!D(n\u22121))(f(x+N)\u2212f(x)) \n\\begin{eqnarray} \n\\sum_{k=0}^{N-1} f(x+n) & = & \\sum_{n=0}^{N-1} e^{nD} f(x) \\\\ \n& = & \\frac{e^{N ~ D} - 1}{e^D - 1} f(x) \\\\ \n& = & \\frac{1}{e^D - 1} (f(x + N) - f(x)) \\\\ \n& = & (D^{-1} + \\sum_{n=1}^{\\infty} \\frac{B_n}{n!} D^{(n-1)}) (f(x + N) - f(x)) \n\\end{eqnarray} \n\n\u3053\u3053\u3067\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u6bcd\u95a2\u6570\u306e\u30c6\u30a4\u30e9\u30fc\u5c55\u958b\u3092\u7528\u3044\u3066\u30d9\u30eb\u30cc\u30fc\u30a4\u95a2\u6570 Bn B_n  \u3092\u5b9a\u7fa9\u3057\u305f\u3002\nxex\u22121=\u221e\u2211n=0Bnn!xn \n\\begin{eqnarray} \n\\frac{x}{e^x - 1} = \\sum_{n=0}^{\\infty} \\frac{B_n}{n!} x^n \n\\end{eqnarray} \n\n\u4e21\u8fba\u306e limx\u21920 \\lim{x \\to 0}  \u306e\u6975\u9650\u3092\u8003\u3048\u308c\u3070 B0=1 B_0 = 1  \u3067\u3042\u308b\u3053\u3068\u304c\u5206\u304b\u308b\u3002\u307e\u305f D\u22121 D^{-1}  \u306e\u9006\u6f14\u7b97\u306e\u7a4d\u5206\u3067\u3042\u308b\u3053\u3068\u306f\u6b21\u306e\u3088\u3046\u306b\u3057\u3066\u7406\u89e3\u3067\u304d\u308b\u3002\ng(x)=D\u22121f(x)Dg(x)=D\u2218D\u22121f(x)ddxg(x)=f(x)g(x)=\u222bx\u03b1f(t)dt+C \n\\begin{eqnarray} \ng(x) & = & D^{-1} f(x) \\\\ \nD g(x) & = & D \\circ D^{-1} f(x) \\\\ \n\\frac{d}{dx} g(x) & = & f(x) \\\\ \ng(x) & = & \\int_{\\alpha}^{x} f(t) dt + C \n\\end{eqnarray} \n\n\u3053\u308c\u3089\u3088\u308a\u5143\u306e\u65b9\u7a0b\u5f0f\u306b x=0 x = 0  \u3092\u4ee3\u5165\u3057\u3066 N \u306b\u5bfe\u3057\u3066\u6975\u9650\u3092\u53d6\u308b\u3068\n\u221e\u2211k=0f(n)\u2212\u222b\u221e0f(n)dn=limN\u2192\u221eCN+\u221e\u2211n=1Bnn!(f(n\u22121)(N)\u2212f(n\u22121)(0)) \n\\begin{eqnarray} \n\\sum_{k=0}^{\\infty} f(n) - \\int_{0}^{\\infty} f(n) dn & =  & \\lim_{N \\to \\infty} C_N + \\sum_{n=1}^{\\infty} \\frac{B_n}{n!} (f^{(n-1)}(N) - f^{(n-1)}(0)) \n\\end{eqnarray} \n\n\u6bcd\u95a2\u6570\u540c\u58eb\u306e\u5f15\u304d\u7b97\u3092\u8a08\u7b97\u3059\u308b\u3053\u3068\u30673\u4ee5\u4e0a\u306e\u5947\u6570\u3067\u5168\u3066  B_n = 0  B_n = 0  \u306b\u306a\u308b\u3053\u3068\u3092\u8a3c\u660e\u3059\u308b\u3002  g(x) = \\frac{x}{e^x - 1}  g(x) = \\frac{x}{e^x - 1}  \u3068\u3057\u3066\n \n\\begin{eqnarray} \\\\ \ng(x) - g(-x) & = & \\frac{x}{e^x - 1} - \\frac{-x}{e^{-x} - 1} \\\\ \n& = & \\frac{x(1-e^x)}{e^x-1} = -x \n\\end{eqnarray} \n \n\\begin{eqnarray} \\\\ \ng(x) - g(-x) & = & \\frac{x}{e^x - 1} - \\frac{-x}{e^{-x} - 1} \\\\ \n& = & \\frac{x(1-e^x)}{e^x-1} = -x \n\\end{eqnarray} \n\n\u3053\u308c\u3088\u308a\n \n\\sum_{k=0}^{\\infty} \\frac{2 B_{2k+1}}{(2k+1)!} x^{2k} = -x \n \n\\sum_{k=0}^{\\infty} \\frac{2 B_{2k+1}}{(2k+1)!} x^{2k} = -x \n\n\u3067\u4e21\u8fba\u3092\u6bd4\u3079\u308b\u3053\u3068\u3067  B_1 = - \\frac{1}{2}  B_1 = - \\frac{1}{2}  \u304b\u3064  B_n = 0, n \\ge 3  B_n = 0, n \\ge 3  \u3067\u3042\u308b\u3053\u3068\u304c\u5206\u304b\u308b\u3002\u3053\u308c\u3092\u7528\u3044\u3066\u30aa\u30a4\u30e9\u30fc\u30de\u30af\u30ed\u30fc\u30ea\u30f3\u306e\u516c\u5f0f\u3092\u66f8\u304d\u306a\u304a\u305b\u3070\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u306a\u308b\u3002\n \n\\begin{eqnarray} \n\\sum_{k=0}^{\\infty} f(n) - \\int_{0}^{\\infty} f(n) dn & =  & \\lim_{N \\to \\infty} C_N + \\frac{1}{2} (f(N) - f(0)) +  \\nonumber\\\\ \n& & ~~~~~~ \\sum_{n=1}^{\\infty} \\frac{B_{2n}}{(2n)!} (f^{(2n-1)}(N) - f^{(2n-1)}(0)) \n\\end{eqnarray} \n \n\\begin{eqnarray} \n\\sum_{k=0}^{\\infty} f(n) - \\int_{0}^{\\infty} f(n) dn & =  & \\lim_{N \\to \\infty} C_N + \\frac{1}{2} (f(N) - f(0)) +  \\nonumber\\\\ \n& & ~~~~~~ \\sum_{n=1}^{\\infty} \\frac{B_{2n}}{(2n)!} (f^{(2n-1)}(N) - f^{(2n-1)}(0)) \n\\end{eqnarray} \n\n\u3053\u3053\u3067  C  C  \u306f\u9069\u5f53\u306a\u5b9a\u6570\u3067\u3042\u308b\u3002\uff08\u53f3\u8fba\u306e\u6975\u9650\u304c\u53ce\u675f\u3059\u308b\u5834\u5408\u306e\u5270\u4f59\u9805\uff09\n\n\u30c7\u30a3\u30ac\u30f3\u30de\u95a2\u6570\u306e\u6f38\u8fd1\u8868\u793a\n\u30aa\u30a4\u30e9\u30fc\u30de\u30af\u30ed\u30fc\u30ea\u30f3\u306e\u516c\u5f0f\u306b\u5bfe\u3057\u3066\u4ee5\u4e0b\u306e\u3088\u3046\u306b  f(n) = \\frac{1}{(n+x)^2}  f(n) = \\frac{1}{(n+x)^2}  \u3092\u5b9a\u7fa9\u3059\u308c\u3070\u30c7\u30a3\u30ac\u30f3\u30de\u95a2\u6570\u306e\u5fae\u5206\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u8868\u305b\u308b\u3002\n \n\\begin{eqnarray} \n\\psi'(x) - \\int_{0}^{\\infty} \\frac{1}{(n+x)^2} dn & = & C + \\frac{1}{2x^2} + \\sum_{n=1}^{\\infty} \\frac{B_n}{x^{2n+1}} \\\\ \n\\psi'(x) & = & C + \\frac{1}{x} + \\frac{1}{2x^2} + \\sum_{n=1}^{\\infty} \\frac{B_{2n}}{x^{2n+1}} \n\\end{eqnarray} \n \n\\begin{eqnarray} \n\\psi'(x) - \\int_{0}^{\\infty} \\frac{1}{(n+x)^2} dn & = & C + \\frac{1}{2x^2} + \\sum_{n=1}^{\\infty} \\frac{B_n}{x^{2n+1}} \\\\ \n\\psi'(x) & = & C + \\frac{1}{x} + \\frac{1}{2x^2} + \\sum_{n=1}^{\\infty} \\frac{B_{2n}}{x^{2n+1}} \n\\end{eqnarray} \n\n\u4e21\u8fba  \\lim x \\to \\infty  \\lim x \\to \\infty  \u306e\u6975\u9650\u3092\u8003\u3048\u308c\u3070  C = 0  C = 0  \u3067\u3042\u308b\u3053\u3068\u304c\u5206\u304b\u308b\u3002\n \n\\begin{eqnarray} \n\\psi'(x) & = & \\frac{1}{x} + \\frac{1}{2x^2} + \\sum_{n=1}^{\\infty} \\frac{B_{2n}}{x^{2n+1}} \n\\end{eqnarray} \n \n\\begin{eqnarray} \n\\psi'(x) & = & \\frac{1}{x} + \\frac{1}{2x^2} + \\sum_{n=1}^{\\infty} \\frac{B_{2n}}{x^{2n+1}} \n\\end{eqnarray} \n\n\u3053\u306e\u4e21\u8fba\u3092\u7a4d\u5206\u3059\u308c\u3070\u76ee\u7684\u306e\u30c7\u30a3\u30ac\u30f3\u30de\u95a2\u6570\u306e\u7d1a\u6570\u8868\u793a\u304c\u5f97\u3089\u308c\u308b\u3002\n \n\\begin{eqnarray} \n\\psi(x) & = & C + log(x) - \\frac{1}{x} - \\sum_{n=1}^{\\infty} \\frac{B_{2n}}{2n ~ x^{2n}} \n\\end{eqnarray} \n \n\\begin{eqnarray} \n\\psi(x) & = & C + log(x) - \\frac{1}{x} - \\sum_{n=1}^{\\infty} \\frac{B_{2n}}{2n ~ x^{2n}} \n\\end{eqnarray} \n\n\u3053\u3053\u3067  \\psi(x+1) = \\psi(x) + \\frac{1}{x}  \\psi(x+1) = \\psi(x) + \\frac{1}{x}  \u3092\u7e70\u308a\u8fd4\u3057\u9069\u7528\u3059\u308b\u3053\u3068\u3067\u81ea\u7136\u6570 M \u306b\u5bfe\u3057\u3066\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u9589\u3058\u305f\u5f62\u3067\u8868\u3059\u3053\u3068\u304c\u51fa\u6765\u308b\u3002\n \n\\begin{eqnarray} \n\\psi(M) & = & \\sum_{k=1}^{M-1} \\frac{1}{k} + \\psi(1) \\\\ \n& = &\\sum_{k=1}^{M-1} \\frac{1}{k} - \\gamma \n\\end{eqnarray} \n \n\\begin{eqnarray} \n\\psi(M) & = & \\sum_{k=1}^{M-1} \\frac{1}{k} + \\psi(1) \\\\ \n& = &\\sum_{k=1}^{M-1} \\frac{1}{k} - \\gamma \n\\end{eqnarray} \n\n\u3057\u305f\u304c\u3063\u3066\u3053\u306e\u3088\u3046\u306a\u81ea\u7136\u6570 M \u3092\u5148\u307b\u3069\u306e\u5f0f\u306b\u4ee3\u5165\u3057\u3066\u305d\u306e\u6975\u9650\u3092\u53d6\u308b\u3068\n \n\\begin{eqnarray} \n\\lim_{M \\to \\infty} \\psi(M) - log(M) & = & C + \\lim_{M \\to \\infty} - \\frac{1}{M} - \\sum_{n=1}^{\\infty} \\frac{B_{2n}}{2n ~ M^{2n}} \\\\ \nC & = & \\lim_{M \\to \\infty} -\\gamma + \\{ \\sum_{k=1}^{M-1} \\frac{1}{k} - log(M) \\} \\\\ \n& = & - \\gamma + \\gamma = 0 \\\\ \n\\end{eqnarray} \n \n\\begin{eqnarray} \n\\lim_{M \\to \\infty} \\psi(M) - log(M) & = & C + \\lim_{M \\to \\infty} - \\frac{1}{M} - \\sum_{n=1}^{\\infty} \\frac{B_{2n}}{2n ~ M^{2n}} \\\\ \nC & = & \\lim_{M \\to \\infty} -\\gamma + \\{ \\sum_{k=1}^{M-1} \\frac{1}{k} - log(M) \\} \\\\ \n& = & - \\gamma + \\gamma = 0 \\\\ \n\\end{eqnarray} \n\n\u3088\u3063\u3066\u5b9a\u6570\u306f 0 \u306b\u306a\u308b\u3053\u3068\u304c\u5206\u304b\u308b\u3002\n\u3053\u308c\u3089\u3092\u307e\u3068\u3081\u308b\u3068\u30c7\u30a3\u30ac\u30f3\u30de\u95a2\u6570\u3068\u30c7\u30a3\u30ac\u30f3\u30de\u95a2\u6570\u306e\u5fae\u5206  \\psi(x), \\psi'(x) \\psi(x), \\psi'(x) \u306f\u305d\u308c\u305e\u308c\u4ee5\u4e0b\u306e\u7d1a\u6570\u3092\u6570\u5024\u8a08\u7b97\u3059\u308c\u3070\u3088\u3044\u3002\u307e\u305f\u30d9\u30eb\u30cc\u30fc\u30a4\u6570\u306e\u6c42\u3081\u65b9\u306b\u3064\u3044\u3066\u306f Appendix D \u306b\u3066\u8aac\u660e\u3057\u3066\u3044\u308b\u3002\n \n\\begin{eqnarray} \n\\psi'(x) & = & \\frac{1}{x} + \\frac{1}{2x^2} + \\sum_{n=1}^{\\infty} \\frac{B_{2n}}{x^{2n+1}} \\\\ \n\\psi(x) & = & log(x) - \\frac{1}{x} - \\sum_{n=1}^{\\infty} \\frac{B_{2n}}{2n ~ x^{2n}} \n\\end{eqnarray} \n \n\\begin{eqnarray} \n\\psi'(x) & = & \\frac{1}{x} + \\frac{1}{2x^2} + \\sum_{n=1}^{\\infty} \\frac{B_{2n}}{x^{2n+1}} \\\\ \n\\psi(x) & = & log(x) - \\frac{1}{x} - \\sum_{n=1}^{\\infty} \\frac{B_{2n}}{2n ~ x^{2n}} \n\\end{eqnarray} \n\n\nAppendix B: \u30c7\u30a3\u30ac\u30f3\u30de\u95a2\u6570\u306e\u4e0d\u7b49\u5f0f\n\u8a3c\u660e\u3059\u308b\u3079\u304d\u4e0d\u7b49\u5f0f\u306f\n \n\\begin{eqnarray} \n\\Gamma(x) \\ge \\Gamma(\\tilde{x})~exp((x-\\tilde{x}) \\psi(x)) \n\\end{eqnarray} \n \n\\begin{eqnarray} \n\\Gamma(x) \\ge \\Gamma(\\tilde{x})~exp((x-\\tilde{x}) \\psi(x)) \n\\end{eqnarray} \n\n\u3067\u3042\u308b\u3002\n\u3053\u306e\u4e0d\u7b49\u5f0f\u3092\u8a3c\u660e\u3059\u308b\u524d\u306b\u307e\u305a\u30c7\u30a3\u30ac\u30f3\u30de\u95a2\u6570\u306e\u5358\u8abf\u6027\u3092\u5229\u7528\u3059\u308b\u3002\u3053\u306e\u4e8b\u5b9f\u306f\u3000 \\psi'(x+1) = \\sum_{i=1}^{\\infty} \\frac{1}{(i+x)^2} > 0  \\psi'(x+1) = \\sum_{i=1}^{\\infty} \\frac{1}{(i+x)^2} > 0  \u304b\u3089\u660e\u3089\u304b\u3067\u3042\u308b\u3002\u3053\u306e\u5358\u8abf\u5897\u52a0\u6027\u3092\u5e73\u5747\u5024\u306e\u5b9a\u7406\u3068\u7d44\u307f\u5408\u308f\u305b\u308c\u3070\u76ee\u7684\u306e\u4e0d\u7b49\u5f0f\u304c\u5f97\u3089\u308c\u308b\u3002\n\u4efb\u610f\u306e  y > x  y > x  \u306b\u5bfe\u3057\u3066\u5e73\u5747\u5024\u306e\u5b9a\u7406\u3088\u308a\n \n\\begin{eqnarray} \n\\frac{log(\\Gamma(y)) - log(\\Gamma(x))}{y-x} = \\left.\\frac{d~  log(\\Gamma(x))}{dx}\\right|_{x=z} = \\psi(z) ~~~~ (x < z < y) \n\\end{eqnarray} \n \n\\begin{eqnarray} \n\\frac{log(\\Gamma(y)) - log(\\Gamma(x))}{y-x} = \\left.\\frac{d~  log(\\Gamma(x))}{dx}\\right|_{x=z} = \\psi(z) ~~~~ (x < z < y) \n\\end{eqnarray} \n\n\u3053\u3053\u3067\u30c7\u30a3\u30ac\u30f3\u30de\u95a2\u6570\u306e\u5358\u8abf\u6027\u3092\u5229\u7528\u3059\u308b\u3068\n \n\\begin{eqnarray} \n\\frac{log(\\Gamma(y)) - log(\\Gamma(x))}{y-x} > \\psi(x) \n\\end{eqnarray} \n \n\\begin{eqnarray} \n\\frac{log(\\Gamma(y)) - log(\\Gamma(x))}{y-x} > \\psi(x) \n\\end{eqnarray} \n\n\u540c\u69d8\u306b\u3057\u3066  y < x  y < x  \u306b\u5bfe\u3057\u3066\u3082\n \n\\begin{eqnarray} \n\\frac{log(\\Gamma(x)) - log(\\Gamma(y))}{x-y} = \\left.\\frac{d~  log(\\Gamma(x))}{dx}\\right|_{x=z} = \\psi(z)  ~~~~ (y < z < x) \n\\end{eqnarray} \n \n\\begin{eqnarray} \n\\frac{log(\\Gamma(x)) - log(\\Gamma(y))}{x-y} = \\left.\\frac{d~  log(\\Gamma(x))}{dx}\\right|_{x=z} = \\psi(z)  ~~~~ (y < z < x) \n\\end{eqnarray} \n\n\u3088\u308a\u5358\u8abf\u6027\u304b\u3089\u4ee5\u4e0b\u304c\u6210\u308a\u7acb\u3064\n \n\\begin{eqnarray} \n\\frac{log(\\Gamma(x)) - log(\\Gamma(y))}{x-y} < \\psi(x) \n\\end{eqnarray} \n \n\\begin{eqnarray} \n\\frac{log(\\Gamma(x)) - log(\\Gamma(y))}{x-y} < \\psi(x) \n\\end{eqnarray} \n\n\u3053\u308c\u3089\u306e\u7d50\u679c\u3092\u5408\u308f\u305b\u308c\u3070\u4ee5\u4e0b\u306e\u4e0d\u7b49\u5f0f\u304c\u4efb\u610f\u306e  \\tilde{x}  \\tilde{x}  \u306b\u5bfe\u3057\u3066\u6210\u308a\u7acb\u3064\u3053\u3068\u306f\u660e\u3089\u304b\u3067\u3042\u308b\u3002\n \n\\begin{eqnarray} \nlog(\\Gamma(x)) - log(\\Gamma(\\tilde{x})) \\ge \\psi(x)(x-\\tilde{x}) \n\\end{eqnarray} \n \n\\begin{eqnarray} \nlog(\\Gamma(x)) - log(\\Gamma(\\tilde{x})) \\ge \\psi(x)(x-\\tilde{x}) \n\\end{eqnarray} \n\n\u4e21\u8fba\u306e\u6307\u6570\u3092\u3068\u3063\u3066\u5f0f\u3092\u5909\u5f62\u3055\u305b\u308b\u3068\u76ee\u7684\u306e\u4e0d\u7b49\u5f0f\u3092\u5f97\u308b\u3002\n \n\\begin{eqnarray} \n\\Gamma(x) \\ge \\Gamma(\\tilde{x})~exp((x-\\tilde{x}) \\psi(x)) \n\\end{eqnarray} \n \n\\begin{eqnarray} \n\\Gamma(x) \\ge \\Gamma(\\tilde{x})~exp((x-\\tilde{x}) \\psi(x)) \n\\end{eqnarray} \n\n\nAppendix C: Sherman\u2013Morrison \u306e\u516c\u5f0f\u5c0e\u51fa\nSherman Morrison \u306e\u516c\u5f0f\u3068\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u95a2\u4fc2\u5f0f\u306e\u3053\u3068\u3067\u3042\u308b\u3002\n \n\\begin{eqnarray} \n(\\b{A} + \\b{u} \\b{v^t})^{-1} & = & \\b{A}^{-1} - \\frac{\\b{A}^{-1}\\b{u}\\b{v^t}\\b{A^{-1}}}{1+\\b{v^t}\\b{A^{-1}}\\b{u}} \n\\end{eqnarray} \n \n\\begin{eqnarray} \n(\\b{A} + \\b{u} \\b{v^t})^{-1} & = & \\b{A}^{-1} - \\frac{\\b{A}^{-1}\\b{u}\\b{v^t}\\b{A^{-1}}}{1+\\b{v^t}\\b{A^{-1}}\\b{u}} \n\\end{eqnarray} \n\n\u5de6\u8fba\u306e\u5f62\u3092\u3057\u305f\u5f0f\u3067  \\b{A^{-1}}  \\b{A^{-1}}  \u306e\u9006\u884c\u5217\u306e\u5024\u304c\u65e2\u306b\u5206\u304b\u3063\u3066\u3044\u308b\u5834\u5408\u3001\u5de6\u306e\u5f0f\u3067\u306f\u306a\u304f\u53f3\u306e\u5f0f\u3067\u8a08\u7b97\u3092\u3059\u308b\u3068\u9006\u884c\u5217\u3092\u6c42\u3081\u308b\u3053\u3068\u306a\u304f\u76ee\u7684\u306e\u5024\u3092\u5f97\u308b\u3053\u3068\u304c\u3067\u304d\u308b\u3002\u306a\u305c\u306a\u3089\u3070\u3001\u9006\u884c\u5217\u306f\u30ac\u30a6\u30b9\u30b8\u30e7\u30eb\u30c0\u30f3\u306e\u6d88\u53bb\u6cd5\u3084LU\u5206\u89e3\u306a\u57fa\u672c\u7684\u306b  O(n^3)  O(n^3)  \u3067\u91cd\u3044\u51e6\u7406\u306a\u306e\u3067\u306a\u308b\u3079\u304f\u8a08\u7b97\u3057\u305f\u304f\u306a\u3044\u304b\u3089\u3067\u3042\u308b\u3002\u307e\u305f\u6271\u3046\u30d1\u30e9\u30e1\u30fc\u30bf\u30fc\u304c\u591a\u3044\u5834\u5408\u305d\u3082\u305d\u3082\u6c42\u3081\u308b\u3053\u3068\u304c\u51fa\u6765\u306a\u3044\u3002\n\u3055\u3066\u3001\u4e0a\u8a18\u306e\u5f0f\u3092\u8a3c\u660e\u3059\u308b\u305f\u3081\u306b\u5929\u4e0b\u308a\u7684\u306b  \\b{A} + \\b{u}\\b{v^t}  \\b{A} + \\b{u}\\b{v^t}  \u3092\u639b\u3051\u3066\u6052\u7b49\u884c\u5217\u306b\u306a\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3057\u3066\u3082\u3088\u3044\u306e\u3060\u304c\u3001\u305d\u306e\u3088\u3046\u306a\u65b9\u6cd5\u3067\u306f\u5fc5\u8981\u306a\u6642\u306b\u81ea\u5206\u3067\u5c0e\u51fa\u3067\u304d\u306a\u3044\u306e\u3067\u56f0\u308b\u3002\n\u305d\u3053\u3067\u4ee5\u4e0b\u3067\u306f\u30ce\u30a4\u30de\u30f3\u7d1a\u6570\u3092\u7528\u3044\u305f\u65b9\u6cd5\u3068\u4ee3\u6570\u7684\u306a\u65b9\u7a0b\u5f0f\u306b\u5e30\u7740\u3055\u305b\u3066\u6c42\u3081\u308b\u65b9\u6cd5\u306e\u4e8c\u3064\u3092\u7d39\u4ecb\u3059\u308b\u3002\u81ea\u5206\u306e\u30aa\u30b9\u30b9\u30e1\u306f\uff08\u53b3\u5bc6\u6027\u306f\u591a\u5c11\u6b20\u3051\u308b\u3082\u306e\u306e\uff09\u30ce\u30a4\u30de\u30f3\u7d1a\u6570\u3092\u4f7f\u3063\u305f\u65b9\u6cd5\u3067\u3042\u308b\u3002\n\u3053\u306e\u65b9\u6cd5\u3055\u3048\u899a\u3048\u3066\u304a\u3051\u3070 woodbury \u306e\u516c\u5f0f\u306a\u3069\u9006\u95a2\u6570\u3067\u8868\u305b\u308c\u305f\u5f0f\u306e\u5909\u5f62\u304c\u81ea\u7531\u306b\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u308b\u3002\u305d\u306e\u4e0a\u3001\u672a\u77e5\u306e\u554f\u984c\u306b\u51fa\u4f1a\u3063\u305f\u6642\u3082\u5fdc\u7528\u304c\u304d\u304f\u304b\u3089\u3067\u3042\u308b\u3002\n\n\u30ce\u30a4\u30de\u30f3\u7d1a\u6570\u3092\u7528\u3044\u305f\u65b9\u6cd5\n\u30ce\u30a4\u30de\u30f3\u7d1a\u6570\u3068\u306f\u4ee5\u4e0b\u306e\u3053\u3068\u3067\n \n\\begin{eqnarray} \n(\\b{A} - \\b{I})^{-1} & = & \\b{I} + \\b{A} + \\b{A^{2}} + \\b{A^{3}} + .... \n\\end{eqnarray} \n \n\\begin{eqnarray} \n(\\b{A} - \\b{I})^{-1} & = & \\b{I} + \\b{A} + \\b{A^{2}} + \\b{A^{3}} + .... \n\\end{eqnarray} \n\n |x| < 1  |x| < 1  \u306b\u304a\u3044\u3066\u6210\u308a\u7acb\u3064\u7121\u9650\u7d1a\u6570\u3092\u884c\u5217\u3067\u8868\u3057\u305f\u3082\u306e\u3067\u3042\u308b\u3002\n \n\\begin{eqnarray} \n\\frac{1}{1-x} & = & 1 + x^2 + x^3 + .... \n\\end{eqnarray} \n \n\\begin{eqnarray} \n\\frac{1}{1-x} & = & 1 + x^2 + x^3 + .... \n\\end{eqnarray} \n\n\u30ce\u30a4\u30de\u30f3\u7d1a\u6570\u3082  |\\b{A}| < 1  |\\b{A}| < 1  \u304c\u6210\u308a\u7acb\u305f\u306a\u3051\u308c\u3070\u306a\u3089\u305a\u3001\u6210\u308a\u7acb\u305f\u306a\u3044\u5834\u5408\u306f\u53f3\u8fba\u306e\u7121\u9650\u7d1a\u6570\u304c\u767a\u6563\u3059\u308b\u305f\u3081\u30ce\u30a4\u30de\u30f3\u7d1a\u6570\u306e\u7b49\u5f0f\u3092\u4f7f\u7528\u3057\u3066\u306f\u306a\u3089\u306a\u3044\u3002 \u306a\u306e\u3067\u3053\u306e\u7b49\u5f0f\u3092\u9014\u4e2d\u3067\u4f7f\u3046\u5834\u5408\u3001\u3053\u306e\u5236\u7d04\u3092\u6e80\u305f\u3057\u3066\u3044\u308b\u884c\u5217\u306b\u3057\u304b\u8a3c\u660e\u3057\u305f\u3053\u3068\u306b\u306a\u3089\u306a\u3044\u3053\u3068\u306f\u6ce8\u610f\u3059\u308b\u3079\u304d\u3067\u3042\u308b\u3002\n\u3055\u3066\u8a3c\u660e\u81ea\u4f53\u306f\u7c21\u5358\u3067\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u5f0f\u5909\u5f62\u3092\u884c\u3048\u3070\u3088\u3044\u3002\n \n\\begin{eqnarray} \n(\\b{A} + \\b{u} \\b{v^t} )^{-1} & = & \\{ \\b{A} (\\b{I} + \\b{A^{-1}  \\b{u} \\b{v^t}}) \\}^{-1} \\\\ \n& = & (\\b{I} + \\b{A^{-1}}\\b{u}\\b{v^t}) \\b{A}^{-1} \\\\ \n& = & (\\sum_{k=0}^{\\infty} (-\\b{A^{-1}}\\b{u}\\b{v^t})^k)\\b{A}^{-1} \\\\ \n& = & (\\b{I} - \\b{A^{-1}} \\b{u} \\sum_{k=1}^{\\infty}(\\b{v^t A^{-1} u})^{k-1}\\b{v}) \\b{A}^{-1} \\\\ \n& = & (\\b{I} - \\b{A^{-1}} \\b{u} ~ \\frac{\\b{v^t}}{1 + \\b{v^t A^{-1} u}}) \\b{A}^{-1} \\\\ \n& = & \\b{A}^{-1} - \\frac{\\b{A^{-1} u v^t A^{-1}}}{1 + \\b{v^t A^{-1} u}} \n\\end{eqnarray} \n \n\\begin{eqnarray} \n(\\b{A} + \\b{u} \\b{v^t} )^{-1} & = & \\{ \\b{A} (\\b{I} + \\b{A^{-1}  \\b{u} \\b{v^t}}) \\}^{-1} \\\\ \n& = & (\\b{I} + \\b{A^{-1}}\\b{u}\\b{v^t}) \\b{A}^{-1} \\\\ \n& = & (\\sum_{k=0}^{\\infty} (-\\b{A^{-1}}\\b{u}\\b{v^t})^k)\\b{A}^{-1} \\\\ \n& = & (\\b{I} - \\b{A^{-1}} \\b{u} \\sum_{k=1}^{\\infty}(\\b{v^t A^{-1} u})^{k-1}\\b{v}) \\b{A}^{-1} \\\\ \n& = & (\\b{I} - \\b{A^{-1}} \\b{u} ~ \\frac{\\b{v^t}}{1 + \\b{v^t A^{-1} u}}) \\b{A}^{-1} \\\\ \n& = & \\b{A}^{-1} - \\frac{\\b{A^{-1} u v^t A^{-1}}}{1 + \\b{v^t A^{-1} u}} \n\\end{eqnarray} \n\n\n\u65b9\u7a0b\u5f0f\u3092\u7528\u3044\u305f\u65b9\u6cd5\n\u65b9\u7a0b\u5f0f\u3092\u7528\u3044\u305f\u65b9\u6cd5\u3067\u306f\u4ee5\u4e0b\u306e  \\b{x}  \\b{x}  \u6c42\u3081\u308b\u904e\u7a0b\u3067\u76ee\u7684\u306e\u5f0f\u3092\u5f97\u308b\u3053\u3068\u304c\u3067\u304d\u308b\u3002\n \n\\begin{eqnarray} \n(\\b{A} + \\b{uv^t}) \\b{x} = \\b{b} \n\\end{eqnarray} \n \n\\begin{eqnarray} \n(\\b{A} + \\b{uv^t}) \\b{x} = \\b{b} \n\\end{eqnarray} \n\n\u4e21\u8fba\u306b  \\b{v^t}  \\b{v^t}  \u3092\u639b\u3051\u3066  \\alpha = \\b{v^t x} \\alpha = \\b{v^t x} \u3068\u304a\u304f\u3068\n \n\\begin{eqnarray} \n\\b{Ax} + \\b{u}\\b{v^tx} & = & \\b{b} \\\\ \n\\b{Ax} + \\b{u}\\alpha & = & \\b{b} \\\\ \n\\b{v^t x} & = & \\b{v^t} (\\b{A^{-1}b} - \\b{A^{-1} u \\alpha}) \\\\ \n\\alpha & = & \\frac{\\b{v^t A^{-1} b}}{1+\\b{v^t A^{-1} u}} \n\\end{eqnarray} \n \n\\begin{eqnarray} \n\\b{Ax} + \\b{u}\\b{v^tx} & = & \\b{b} \\\\ \n\\b{Ax} + \\b{u}\\alpha & = & \\b{b} \\\\ \n\\b{v^t x} & = & \\b{v^t} (\\b{A^{-1}b} - \\b{A^{-1} u \\alpha}) \\\\ \n\\alpha & = & \\frac{\\b{v^t A^{-1} b}}{1+\\b{v^t A^{-1} u}} \n\\end{eqnarray} \n\n\u3053\u308c\u3088\u308a\u4e0a\u8a18\u306e  \\alpha  \\alpha  \u3092\u5143\u306e\u5f0f\u306b\u4ee3\u5165\u3059\u308b\u3068\u6c42\u3081\u305f\u3044\u5f0f\u304c\u5f97\u3089\u308c\u308b\u3002\n \n\\begin{eqnarray} \n\\b{x} & = & \\b{A^{-1}b} - \\b{A^{-1} u}\\alpha  \\\\ \n\\b{x} & = & (\\b{A^{-1}} - \\frac{\\b{A^{-1} u v^t A^{-1}}}{1+\\b{v^t A^{-1} u}}) \\b{b} \n\\end{eqnarray} \n \n\\begin{eqnarray} \n\\b{x} & = & \\b{A^{-1}b} - \\b{A^{-1} u}\\alpha  \\\\ \n\\b{x} & = & (\\b{A^{-1}} - \\frac{\\b{A^{-1} u v^t A^{-1}}}{1+\\b{v^t A^{-1} u}}) \\b{b} \n\\end{eqnarray} \n\n\u3053\u308c\u3088\u308a\u3001\u76f4\u63a5\u9006\u884c\u5217\u3092\u639b\u3051\u305f\u5834\u5408\u3068\u6bd4\u8f03\u3057\u3066\u4ee5\u4e0b\u304c\u6210\u308a\u7acb\u3064\u3053\u3068\u304c\u5206\u304b\u308b\u3002\n \n(\\b{A} + \\b{uv^t})^{-1} = \\b{A^{-1}} - \\frac{\\b{A^{-1} u v^t A^{-1}}}{1+\\b{v^t A^{-1} u}} \n \n(\\b{A} + \\b{uv^t})^{-1} = \\b{A^{-1}} - \\frac{\\b{A^{-1} u v^t A^{-1}}}{1+\\b{v^t A^{-1} u}} \n\n\nWoodbury \u306e\u516c\u5f0f\n\u4eca\u56de\u306f\u4f7f\u308f\u306a\u3044\u304c\u4ee5\u4e0b\u306e\u3088\u3046\u306b Woodbury \u306e\u516c\u5f0f\u3082\u30ce\u30a4\u30de\u30f3\u7d1a\u6570\u3092\u7528\u3044\u305f\u65b9\u6cd5\u3067\u7c21\u5358\u306b\u5c0e\u51fa\u3067\u304d\u308b\u3002Woodbury \u306e\u516c\u5f0f\u306f\u4ee5\u4e0b\u306e\u901a\u308a\u3002\n \n\\begin{eqnarray} \n(\\b{A} + \\b{BCD})^{-1} = \\b{A}^{-1} - \\b{A^{-1} B} (\\b{C^{-1}} + \\b{D A^{-1} B})^{-1} \\b{D A^{-1}} \n\\end{eqnarray} \n \n\\begin{eqnarray} \n(\\b{A} + \\b{BCD})^{-1} = \\b{A}^{-1} - \\b{A^{-1} B} (\\b{C^{-1}} + \\b{D A^{-1} B})^{-1} \\b{D A^{-1}} \n\\end{eqnarray} \n\n\u3053\u306e\u516c\u5f0f\u306f \n\n \\b{A}  \\b{A}  \u304c  n \\times n  n \\times n  \n \\b{B}  \\b{B}  \u304c  n \\times k  n \\times k  \n \\b{C}  \\b{C}  \u304c  k \\times k  k \\times k  \n \\b{D}  \\b{D}  \u304c  k \\times n  k \\times n  \n\n\u306e\u6642\u306b  k << n  k << n  \u3067\u3042\u308b\u5834\u5408\u3067  \\b{A}^{-1}, \\b{C}^{-1}  \\b{A}^{-1}, \\b{C}^{-1}  \u304c\u6c42\u3081\u3089\u308c\u3066\u3044\u308b\u6642\u3001\u5de6\u8fba\u3088\u308a\u53f3\u8fba\u3092\u8a08\u7b97\u3057\u305f\u65b9\u304c\u9065\u304b\u306b\u8a08\u7b97\u91cf\u304c\u5c0f\u3055\u304f\u306a\u308b\u305f\u3081\u3001\u305d\u306e\u3088\u3046\u306a\u5834\u9762\u3067\u4f7f\u308f\u308c\u308b\u3002\n\u3055\u3066\u3001Sherman\u2013Morrison \u306e\u30ce\u30a4\u30de\u30f3\u7d1a\u6570\u3067\u5c0e\u3044\u305f\u6642\u3068\u540c\u69d8\u306b\u3053\u306e\u5f0f\u3092\u8a3c\u660e\u3057\u3066\u307f\u3088\u3046\u3002\n \n\\begin{eqnarray} \n(\\b{A} + \\b{B C D})^{-1}  & = &  \\{ \\b{A} (\\b{I} + \\b{A^{-1} B C D}) \\}^{-1} \\\\ \n& = & (\\b{I} + \\b{A^{-1} B C D})^{-1} \\b{A^{-1}} \\\\ \n& = & (\\sum_{k=0}^{\\infty} (\\b{- A^{-1} B C D})^{k}) \\b{A^{-1}} \\\\ \n& = & (\\b{I} - \\b{A^{-1} B} \\{ \\sum_{k=1}^{\\infty} (\\b{- C D A^{-1} B})^{k-1} \\} \\b{C D} ) ~ \\b{A^{-1}} \\\\ \n& = & \\b{A^{-1}} - \\b{A^{-1} B}(\\b{I} + \\b{C D A^{-1} B})^{-1} \\b{C D A^{-1}} \\\\ \n& = & \\b{A^{-1}} - \\b{A^{-1} B}(\\b{C^{-1}} + \\b{D A^{-1} B})^{-1} \\b{D A^{-1}} \n\\end{eqnarray} \n \n\\begin{eqnarray} \n(\\b{A} + \\b{B C D})^{-1}  & = &  \\{ \\b{A} (\\b{I} + \\b{A^{-1} B C D}) \\}^{-1} \\\\ \n& = & (\\b{I} + \\b{A^{-1} B C D})^{-1} \\b{A^{-1}} \\\\ \n& = & (\\sum_{k=0}^{\\infty} (\\b{- A^{-1} B C D})^{k}) \\b{A^{-1}} \\\\ \n& = & (\\b{I} - \\b{A^{-1} B} \\{ \\sum_{k=1}^{\\infty} (\\b{- C D A^{-1} B})^{k-1} \\} \\b{C D} ) ~ \\b{A^{-1}} \\\\ \n& = & \\b{A^{-1}} - \\b{A^{-1} B}(\\b{I} + \\b{C D A^{-1} B})^{-1} \\b{C D A^{-1}} \\\\ \n& = & \\b{A^{-1}} - \\b{A^{-1} B}(\\b{C^{-1}} + \\b{D A^{-1} B})^{-1} \\b{D A^{-1}} \n\\end{eqnarray} \n\n\u3068\u3053\u306e\u3088\u3046\u306b\u30ce\u30a4\u30de\u30f3\u7d1a\u6570\u3092\u7528\u3044\u308c\u3070\u6bd4\u8f03\u7684\u7c21\u5358\u306b\u5f0f\u3092\u5c0e\u304f\u3053\u3068\u304c\u51fa\u6765\u308b\u3002\n\nAppendix D: \u30d9\u30eb\u30cc\u30fc\u30a4\u6570\u306e\u6c42\u3081\u65b9\n\u30c7\u30a3\u30ac\u30f3\u30de\u95a2\u6570\u3084\u305d\u306e\u5fae\u5206\u306e\u6f38\u8fd1\u5c55\u958b\u306b\u306f\u30d9\u30eb\u30cc\u30fc\u30a4\u6570\u304c\u5fc5\u8981\u3067\u3042\u308b\u3002\u30d9\u30eb\u30cc\u30fc\u30a4\u6570\u3092\u6c42\u3081\u308b\u9589\u3058\u305f\u5f62\u306e\u6570\u5f0f\u306f\u5b58\u5728\u3057\u306a\u3044\u306e\u3067\u3001\u6f38\u5316\u5f0f\u3092\u5229\u7528\u3057\u3066\u518d\u5e30\u7684\u306b\u5024\u3092\u6c42\u3081\u308b\u3002\u30d9\u30eb\u30cc\u30fc\u30a4\u6570\u306e\u6bcd\u95a2\u6570\u306e\u5f62\u3092\u601d\u3044\u51fa\u3059\u3068\n \n\\begin{eqnarray} \n\\frac{x}{e^x-1} & = & \\sum_{n=0}^{\\infty} \\frac{B_n}{n!} x^n \\\\ \n\\end{eqnarray} \n \n\\begin{eqnarray} \n\\frac{x}{e^x-1} & = & \\sum_{n=0}^{\\infty} \\frac{B_n}{n!} x^n \\\\ \n\\end{eqnarray} \n\n\u3088\u308a\u3001\u4e21\u8fba\u306b  e^x - 1  e^x - 1  \u3092\u639b\u3051\u308b\u3053\u3068\u3067\n \n\\begin{eqnarray} \nx & = & \\sum_{n=0}^{\\infty} \\frac{B_n}{n!} (e^x - 1) x^n \\\\ \n& = & \\sum_{n=0}^{\\infty} \\sum_{k=0}^{\\infty} \\frac{B_n}{(k+1)! n!} x^{n + k + 1} \\\\ \n& = & \\sum_{l=0}^{\\infty} \\sum_{n+k=l  \\substack n, k \\ge 0} \\frac{B_n}{(l - n + 1)!~n!} x^{l+1} \\\\ \n& = & \\sum_{l=0}^{\\infty} (\\sum_{n=0}^{l} \\frac{1}{(l+1)!} \\dbinom{l+1}{n} ~ B_n) x^{l+1} \\\\ \n\\end{eqnarray} \n \n\\begin{eqnarray} \nx & = & \\sum_{n=0}^{\\infty} \\frac{B_n}{n!} (e^x - 1) x^n \\\\ \n& = & \\sum_{n=0}^{\\infty} \\sum_{k=0}^{\\infty} \\frac{B_n}{(k+1)! n!} x^{n + k + 1} \\\\ \n& = & \\sum_{l=0}^{\\infty} \\sum_{n+k=l  \\substack n, k \\ge 0} \\frac{B_n}{(l - n + 1)!~n!} x^{l+1} \\\\ \n& = & \\sum_{l=0}^{\\infty} (\\sum_{n=0}^{l} \\frac{1}{(l+1)!} \\dbinom{l+1}{n} ~ B_n) x^{l+1} \\\\ \n\\end{eqnarray} \n\n\u4e21\u8fba\u306e\u4fc2\u6570\u3092\u6bd4\u8f03\u3059\u308b\u3053\u3068\u3067\u3001  B_0 = 1  B_0 = 1  \u304b\u3064  n \\ge 2  n \\ge 2  \u306b\u304a\u3044\u3066\n \n\\begin{eqnarray} \n\\sum_{n=0}^{l} \\dbinom{l+1}{n} B_n = 0 \\\\ \nB_l = - \\frac{1}{l+1} \\sum_{n=0}^{l-1} \\dbinom{l+1}{n} B_n \n\\end{eqnarray} \n \n\\begin{eqnarray} \n\\sum_{n=0}^{l} \\dbinom{l+1}{n} B_n = 0 \\\\ \nB_l = - \\frac{1}{l+1} \\sum_{n=0}^{l-1} \\dbinom{l+1}{n} B_n \n\\end{eqnarray} \n\n\u304c\u6210\u308a\u7acb\u3064\u3053\u3068\u304c\u5206\u304b\u308b\u3002\n\u518d\u5e30\u7684\u306b\u4e0a\u8a18\u306e\u5f0f\u3092\u8a08\u7b97\u3059\u308b\u3053\u3068\u3067\u3001\u4efb\u610f\u306e  B_n  B_n  \u306e\u5024\u304c\u5206\u304b\u308b\u3002\n\u53c2\u8003\u307e\u3067\u306b ruby \u3067\u66f8\u3044\u305f\u30b3\u30fc\u30c9\u306840\u307e\u3067\u306e\u30d9\u30eb\u30cc\u30fc\u30a4\u6570\u306e\u5177\u4f53\u7684\u306a\u5024\u3092\u8868\u3068\u3057\u3066\u6b8b\u3057\u3066\u304a\u304f\u3002\ndef fac(n)\n  return 1 if n == 0\n  return (1..n).reduce(&:*)\nend\ndef comb(n, k) fac(n) / (fac(n - k) * fac(k)) end\ndef bernoulli_number(m)\n  @memo ||= {}\n  return @memo[m] if @memo[m]\n  return 1 if m == 0\n  return @memo[m] = (0..(m-1)).map {|n|\n    comb(m + 1, n) * bernoulli_number(n)\n  }.reduce(&:+) * Rational(-1, m + 1)\nend\n(0..100).each {|x| puts \"#{x}: #{bernoulli_number(x)}\"}\n\n\n\n\nindex\nvalue\n\n\n\n\n0\n1\n\n\n1\n-1/2\n\n\n2\n1/6\n\n\n3\n0/1\n\n\n4\n-1/30\n\n\n5\n0/1\n\n\n6\n1/42\n\n\n7\n0/1\n\n\n8\n-1/30\n\n\n9\n0/1\n\n\n10\n5/66\n\n\n11\n0/1\n\n\n12\n-691/2730\n\n\n13\n0/1\n\n\n14\n7/6\n\n\n15\n0/1\n\n\n16\n-3617/510\n\n\n17\n0/1\n\n\n18\n43867/798\n\n\n19\n0/1\n\n\n20\n-174611/330\n\n\n21\n0/1\n\n\n22\n854513/138\n\n\n23\n0/1\n\n\n24\n-236364091/2730\n\n\n25\n0/1\n\n\n26\n8553103/6\n\n\n27\n0/1\n\n\n28\n-23749461029/870\n\n\n29\n0/1\n\n\n30\n8615841276005/14322\n\n\n31\n0/1\n\n\n32\n-7709321041217/510\n\n\n33\n0/1\n\n\n34\n2577687858367/6\n\n\n35\n0/1\n\n\n36\n-26315271553053477373/1919190\n\n\n37\n0/1\n\n\n38\n2929993913841559/6\n\n\n39\n0/1\n\n\n40\n-261082718496449122051/13530\n\n\n\n\n$$\n\\newcommand{\\b}[1]{\\mathbf{#1}}\n$$\n\n# \u30c7\u30a3\u30ea\u30af\u30ec\u5206\u5e03\u306e\u6700\u5c24\u63a8\u5b9a\n\u4eca\u56de\u306f\u30c7\u30a3\u30ea\u5206\u5e03\u306e\u6700\u5c24\u63a8\u5b9a\u6cd5\u306b\u3088\u308b\u6570\u5024\u6700\u9069\u89e3\u3092\u5f97\u308b\u65b9\u6cd5\u306b\u3064\u3044\u3066\u8aac\u660e\u3057\u305f\u3044\u3068\u601d\u3046\u3002\n\u4e8c\u9805\u5206\u5e03\u3084\u6307\u6570\u5206\u5e03\u3001\u6b63\u898f\u5206\u5e03\u306a\u3069\u306e\u7c21\u5358\u306a\u5206\u5e03\u3067\u306f\u89e3\u6790\u89e3\u3092\u5f97\u3089\u308c\u304c\u3001\u30c7\u30a3\u30ec\u30af\u30ec\u5206\u5e03\u306e\u3088\u3046\u306a\u9ad8\u6b21\u5143\u3067\u8907\u96d1\u306a\u78ba\u7387\u5206\u5e03\u306b\u306a\u308b\u3068\u6700\u5c24\u63a8\u5b9a\u3084MAP\u63a8\u5b9a\u3067\u89e3\u6790\u89e3\u3092\u6c42\u3081\u308b\u3053\u3068\u306f\u57fa\u672c\u7684\u306b\u51fa\u6765\u306a\u3044\u3002\u305d\u3053\u3067\u3001\u6570\u5024\u7684\u306a\u8a08\u7b97\u51e6\u7406\u3092\u3057\u3066\u6c42\u3081\u308b\u5fc5\u8981\u304c\u3042\u308b\u3002\n\n\u7279\u306b\u30c7\u30a3\u30ec\u30af\u30ec\u5206\u5e03\u306f\u30ca\u30a4\u30fc\u30d6\u30d9\u30a4\u30ba\u3084\u6df7\u5408\u30e2\u30c7\u30eb\u306a\u3069\u306e\u5171\u5f79\u4e8b\u524d\u5206\u5e03\u3068\u3057\u3066\u6d3b\u8e8d\u3059\u308b\u306e\u3067\u69d8\u3005\u306a\u5206\u91ce\u3067\u5fc5\u8981\u306b\u306a\u308b\u3002\n\u81ea\u5206\u306e\u5834\u5408\u306f\u6a5f\u68b0\u5b66\u7fd2\u30d7\u30ed\u30d5\u30a7\u30c3\u30b7\u30e7\u30ca\u30eb\u30b7\u30ea\u30fc\u30ba\u306e\u30c8\u30d4\u30c3\u30af\u30e2\u30c7\u30eb\u306e2\u7ae0\u30e6\u30cb\u30b0\u30e9\u30e0\u30e2\u30c7\u30eb\u3092\u8aad\u3093\u3067\u3044\u308b\u6642\u306b\u5fc5\u8981\u306b\u306a\u3063\u305f\u3002\n\n\u305d\u3053\u3067\u30d7\u30ed\u30d5\u30a7\u30c3\u30b7\u30e7\u30ca\u30eb\u30b7\u30ea\u30fc\u30ba\u306e\u66f8\u7c4d\u306b\u3082\u7d39\u4ecb\u3055\u308c\u3066\u3044\u305f\u4ee5\u4e0b\u306e\u8ad6\u6587\u306e\u884c\u9593\u3092\u57cb\u3081\u306a\u304c\u3089\u9032\u3081\u3066\u3044\u304f\u3002\n\n[Estimating a Dirichlet distribution Thomas P. Minka 2000 (revised 2003, 2009, 2012)](http://www.msr-waypoint.com/en-us/um/people/minka/papers/dirichlet/minka-dirichlet.pdf)\n\n\u307e\u305f\u3001\u3053\u306e\u8cc7\u6599\u306f**\u30c7\u30a3\u30ac\u30f3\u30de\u95a2\u6570\u306e\u6f38\u8fd1\u5c55\u958b\u304b\u3089\u57fa\u672c\u7684\u306a\u3053\u3068\u307e\u3067\u3001\u306a\u308b\u3079\u304f\u7701\u7565\u305b\u305a\u4e00\u304b\u3089\u5168\u3066\u8aac\u660e\u3057\u3066\u3044\u308b\u3002**\u307e\u305f\u3001\u8ad6\u6587\u3067\u3053\u306e\u6587\u7ae0\u306b\u5bfe\u5fdc\u3059\u308b\u306e\u306f2\u30da\u30fc\u30b8\u306e\u9014\u4e2d\u307e\u3067\u3067\u3042\u308b\u3002\n\n\n\n## \u5b9a\u5f0f\u5316\n\u30c7\u30a3\u30ec\u30af\u30ec\u5206\u5e03\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u78ba\u7387\u5206\u5e03\u3067\u3042\u308b\u3002\n\n$$\n\\begin{eqnarray}\nP(\\b{p} | \\b{\\alpha}) = \\frac{\\Gamma(\\sum_{k=1}^n \\alpha_k)}{\\prod_{k=1}^{n} \\Gamma(\\alpha_k)} \\prod_{k=1}^{n} p_k^{\\alpha_k - 1} \\\\\\\n\\sum_{k=1}^{n} p_k = 1, ~~~~ p_k \\ge 0\n\\end{eqnarray}\n$$\n\n\u3053\u3053\u3067 $ \\b{\\alpha} $ \u306fn\u6b21\u5143\u30d9\u30af\u30c8\u30eb\u3067\u3042\u308b\u3002\n\n\n## \u6700\u5c24\u63a8\u5b9a\u6cd5\u3067\u6700\u9069\u89e3\u3092\u6c42\u3081\u308b\n\n\u3055\u3066 $ \\b{\\alpha} $ \u3092\u56fa\u5b9a\u3057\u3066\u30c7\u30a3\u30ec\u30af\u30ec\u5206\u5e03\u304b\u3089\u4ee5\u4e0b\u306e\u3088\u3046\u306b N \u500b\u306e\u78ba\u7387\u30d9\u30af\u30c8\u30eb $ DataSet = \\\\{ \\b{p^{(1)}}, \\b{p^{(2)}}, ..., \\b{p^{(N)}} \\\\} $ \u304c\u89b3\u6e2c\u51fa\u6765\u305f\u6642\u306b\u305d\u306e\u78ba\u7387\u3092\u6700\u5927\u5316\u3055\u305b\u308b\u3088\u3046\u306a $ \\b{\\alpha} $ \u3092\u6c42\u3081\u308b\u3002\u5c24\u5ea6\u3092 $ L(\\b{\\alpha}) $ \u3068\u3059\u308b\u3068\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u8868\u305b\u308b\u3002\n\n$$\n\\begin{eqnarray}\nL(\\b{\\alpha}) & = & log(\\prod_{i=1}^{N} P(\\b{p^{(i)}} | \\b{\\alpha})) \\\\\\\n& = & \\sum_{k=1}^{N} \\\\{~ (\\sum_{i=1}^{N} (\\alpha_k - 1) ~ log(p_k^{(i)})) + N ~ log( \\Gamma(\\sum_{k'=1}^{n}  \\alpha_{k'})) - N ~ log(\\Gamma(\\alpha_k)) ~\\\\} \\\\\\\n& = & \\sum_{k=1}^{N} \\\\{ ~ N ~ log( \\Gamma(\\sum_{k'=1}^{n}  \\alpha_{k'})) + ~ N (\\alpha_k - 1) ~ log(\\tilde{p_k})  - N ~ log(\\Gamma(\\alpha_k)) ~\\\\}\n\\end{eqnarray}\n$$\n\n\u3053\u3053\u3067 $ log(\\tilde{p_k}) $ \u306b\u3064\u3044\u3066\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u5b9a\u7fa9\u3057\u305f\u3002\n\n$$\n\\begin{eqnarray}\nlog(\\tilde{p_k}) = \\frac{1}{N} \\sum_{i=1}^{N} log(p_k^{(i)})\n\\end{eqnarray}\n$$\n\n\u3055\u3066 $ L(\\alpha) $ \u306e\u6975\u5024\u3092\u5f97\u308b\u305f\u3081\u306b\u3001\u307e\u305a\u95a2\u6570\u3092\u5fae\u5206\u3057\u3066\u307f\u308b\u3002\n\n$$\n\\begin{eqnarray}\n\\frac{\\partial L(\\b{\\alpha})}{\\partial \\alpha_i} & = & N \\sum_{k=1}^{n} \\\\{ \\frac{\\partial \\alpha_k}{\\partial \\alpha_i} log(\\tilde{p_k}) - \\frac{\\partial log(\\Gamma(\\alpha_k))}{\\partial \\alpha_i} \\\\} + N \\frac{\\partial}{\\partial \\alpha_i} \\Gamma(\\sum_{k=1}^{n} \\alpha_k) \\\\\\\n& = & \\sum_{k=1}^{n} \\\\{ \\delta_{k,i} log(\\tilde{p_k}) - \\delta_{k, i} \\psi(\\alpha_k) \\\\} + N ~ \\psi(\\sum_{k=1}^{n} \\alpha_k) \\frac{\\partial \\sum_{k=1}^{n} \\alpha_k}{\\partial \\alpha_i} \\\\\\\n& = & N \\\\{ \\psi(\\sum_{k=1}^{n} \\alpha_k) - \\psi(\\alpha_i) + log(\\tilde{p_i}) \\\\}\n\\end{eqnarray}\n$$\n\n\u3053\u3053\u3067 $ \\phi(x) $ \u3092Log\u30b9\u30b1\u30fc\u30eb\u306e\u30ac\u30f3\u30de\u95a2\u6570\u306e\u5fae\u5206\u3001\u30c7\u30a3\u30ac\u30f3\u30de\u95a2\u6570\u3068\u3057\u3066\u65b0\u3057\u304f\u5b9a\u7fa9\u3057\u305f\u3002\n\n$$\n\\begin{eqnarray}\n\\phi(x) = \\frac{d}{dx} log(\\Gamma(x)) = \\frac{\\Gamma'(x)}{\\Gamma(x)}\n\\end{eqnarray}\n$$\n\n $ L(\\b{\\alpha}) $ \u306f\u51f8\u6027\u3092\u6301\u3063\u3066\u3044\u308b\u3053\u3068\u3092\u793a\u305b\u308b\u306e\u3067\u6975\u5024\u306f\u4e00\u3064\u3002\n\u3059\u306a\u308f\u3061\n\n$$\n\\begin{eqnarray}\n\\frac{\\partial L(\\b{\\alpha})}{\\partial \\b{\\alpha}} = \\b{0}\n\\end{eqnarray}\n$$\n\n\u3092\u6e80\u305f\u3059\u70b9\u304c\u6700\u5927\u5024\u3092\u53d6\u308b $\\alpha$ \u306b\u306a\u308b\u3002\n\u89e3\u6790\u89e3\u304c\u306a\u3044\u306e\u3067\u3053\u306e\u5024\u3092\u6570\u5024\u89e3\u6790\u3067\u6c42\u3081\u308b\u3002\u4e0d\u52d5\u70b9\u53cd\u5fa9\u6cd5\u3068\u30cb\u30e5\u30fc\u30c8\u30f3\u6cd5\u3001\u6700\u6025\u52fe\u914d\u6cd5\u306e3\u3064\u306e\u65b9\u6cd5\u304c\u5229\u7528\u3067\u304d\u308b\u3002\u8ad6\u6587\u3067\u306f\u4e0d\u52d5\u70b9\u53cd\u5fa9\u6cd5\u3068\u30cb\u30e5\u30fc\u30c8\u30f3\u6cd5\u306b\u3064\u3044\u3066\u306e\u8aac\u660e\u3092\u3057\u3066\u3044\u308b\u306e\u3067\u305d\u308c\u306b\u5f93\u3046\u3002\n\n\n### \u4e0d\u52d5\u70b9\u53cd\u5fa9\u6cd5\u306b\u3088\u308b\u89e3\u6cd5\n\u307e\u305a\u4e00\u822c\u7684\u306a\u4e0d\u52d5\u70b9\u53cd\u5fa9\u6cd5\u306e1\u5909\u6570\u306e\u5834\u5408\u306b\u3064\u3044\u3066\u8aac\u660e\u3059\u308b\u3002\n\u3053\u306e\u65b9\u6cd5\u306f\u4ee5\u4e0b\u306e\u69d8\u306a\u4e0d\u7b49\u5f0f\u3092\u6e80\u305f\u3059 x \u306b\u5bfe\u3057\u3066\n\n$$\nx = f(x)\n$$\n\n\u6b21\u306e\u3088\u3046\u306a\u6f38\u5316\u5f0f\u3092\u7e70\u308a\u8fd4\u3057\u7528\u3044\u308b\u3053\u3068\u3067\u7b54\u3048\u3092\u6c42\u3081\u308b\u65b9\u6cd5\u3067\u3042\u308b\u3002\n\n$$\nx^{(t)} = f(x^{(t-1)})\n$$\n\n\u3082\u3061\u308d\u3093\u3069\u306e\u3088\u3046\u306a\u95a2\u6570 $ f(x) $ \u306b\u5bfe\u3057\u3066\u3082\u4e0a\u8a18\u306e\u6f38\u5316\u5f0f\u3092\u7528\u3044\u3066\u7b54\u3048\u3092\u6c42\u3081\u308b\u3053\u3068\u304c\u3067\u304d\u308b\u308f\u3051\u3067\u306f\u306a\u3044\u3002\u30ea\u30d7\u30b7\u30c3\u30c4\u9023\u7d9a\u6027\u3068\u3044\u3046\u6027\u8cea\u3092\u6e80\u305f\u3059\u5834\u5408\u306e\u307f\u53ef\u80fd\u3067\u3042\u308b\u304c\u305d\u306e\u8a3c\u660e\u306f\u3053\u3053\u3067\u306f\u884c\u308f\u306a\u3044\u3002\n\u3055\u3066\u3053\u306e\u95a2\u4fc2\u6027\u3092\u591a\u6b21\u5143\u5909\u6570\u306e\u95a2\u6570\u3067\u3042\u308b (11) \u306e\u65b9\u7a0b\u5f0f\u306b\u5bfe\u3057\u3066\u3082\u6210\u308a\u7acb\u3064\u3068\u4eee\u5b9a\u3059\u308b\u3068\u4ee5\u4e0b\u306e\u5f0f\u3092\u7528\u3044\u3066\u66f4\u65b0\u3059\u308c\u3070\u76ee\u7684\u306e\u5024\u3092\u6c42\u3081\u3089\u308c\u305d\u3046\u3067\u3042\u308b\u3002\n\n$$\n\\begin{eqnarray}\n\\psi(\\alpha_i^{(t)})  & = & \\psi(\\sum_{k=1}^n \\alpha_k^{(t-1)}) + log(\\tilde{p_i}) \\\\\\\n\\alpha_i^{(t)} & = & \\psi^{-1}(\\psi(\\sum_{k=1}^n \\alpha_k^{(t-1)}) + log(\\tilde{p_i})) \\\\\\\n\\end{eqnarray}\n$$\n\n\u3053\u308c\u3092\u793a\u3059\u305f\u3081\u306b\u4ee5\u4e0b\u306e\u30bb\u30af\u30b7\u30e7\u30f3\u306e Appendix B \u3067\u4e0e\u3048\u305f\u4e0d\u7b49\u5f0f\u3092\u5229\u7528\u3057\u3066\u5c24\u5ea6\u306e\u4e0b\u9650\u3092\u6c42\u3081\u3066\u305d\u306e\u4e0b\u9650\u306e\u6700\u5927\u306e\u6c42\u3081\u308b\u3053\u3068\u3067\u3001\u4e0a\u8a18\u306e\u66f4\u65b0\u5f0f\u3068\u540c\u3058\u5f0f\u3092\u5f97\u3089\u308c\u308b\u3053\u3068\u3092\u793a\u3059\u3002 $ \\tilde{x} = \\sum_{k=1}^n \\alpha_k^{(t-1)} $ \u3068\u3057\u3066\u56fa\u5b9a\u3057\u305f\u6642\u3001(5)\u306e\u4e00\u756a\u76ee\u306e\u9805\u306b\u5bfe\u3057 Appendix B \u306e\u4e0d\u7b49\u5f0f\u3092\u9069\u7528\u3059\u308b\u3053\u3068\u3067\n\n$$\n\\begin{eqnarray}\n\\frac{L(\\b{\\alpha})}{N} & \\ge & log \\\\{ \\Gamma(\\sum_{k=1}^n \\alpha_k^{(t-1)}) exp((\\sum_{k=1}^n \\alpha_k - \\alpha_k^{(t-1)})\\psi(\\sum_{k=1}^n \\alpha_k^{(t-1)}))) \\\\} \\nonumber \\\\\\\n& & - \\sum_{k=1}^{n} log(\\Gamma(\\alpha_k)) + \\sum_{k=1}^n (\\alpha_k-1)log(\\tilde{p_k})  \\nonumber \\\\\\\n& = & (\\sum_{k=1}^n \\alpha_k) \\psi(\\sum_{k=1}^n \\alpha_k^{(t-1)}) - \\sum_{k=1}^{n} log(\\Gamma(\\alpha_k)) + \\sum_{k=1}^n (\\alpha_k-1)log(\\tilde{p_k}) + const(\\alpha_k^{(t-1)})\n\\end{eqnarray}\n$$\n\n\u3053\u3053\u3067 $ \\alpha_k^{(t-1)} $ \u306f\u5b9a\u6570\u3068\u307f\u306a\u3057\u3066\u3044\u308b\u3002\u3088\u3063\u3066\u3001\u3053\u308c\u3089\u306e\u9805\u306e\u307f\u306e\u90e8\u5206\u3092 $ const(\\alpha_k^{(t-1)}) $ \u3067\u307e\u3068\u3081\u305f\u3002\n\u4e0a\u8a18\u306e\u4e0d\u7b49\u5f0f\u306e\u53f3\u8fba\u3092 $ G(\\b{\\alpha}) $ \u3068\u3057\u3066 $ \\alpha_1, \\alpha_2, ... \\alpha_k $ \u306b\u3064\u3044\u3066\u6700\u5927\u5316\u3055\u305b\u308b\u3068\u4e0d\u52d5\u70b9\u53cd\u5fa9\u6cd5\u306e\u66f4\u65b0\u5f0f\u3068\u540c\u3058\u5f0f\u3092\u5f97\u308b\u3002\n\n$$\n\\begin{eqnarray}\n\\frac{\\partial}{\\partial \\alpha_i} G(\\b{\\alpha}) & = & \\psi(\\sum_{k=1}^n \\alpha_k^{(t-1)}) - \\sum_{k=1}^n \\frac{\\partial \\alpha_k}{\\partial \\alpha_i} \\psi(\\alpha_k) + \\sum_{k=1}^n \\frac{\\partial \\alpha_k}{\\partial \\alpha_i} log(\\tilde{p_k}) \\\\\\\n& = & \\psi(\\sum_{k=1}^n \\alpha_k^{(t-1)}) - \\psi(\\alpha_i) +  log(\\tilde{p_i})\n\\end{eqnarray}\n$$\n\n\u5fae\u5206 = 0 \u3067\u505c\u7559\u70b9\u304c\u5f97\u3089\u308c\u308b\u306e\u3067\n\n$$\n\\begin{eqnarray}\n\\frac{\\partial}{\\partial \\alpha_i} G(\\b{\\alpha}) & = & 0 \\\\\\\n\\psi(\\sum_{k=1}^n \\alpha_k^{(t-1)}) - \\psi(\\alpha_i) +  log(\\tilde{p_i}) & = & 0 \\\\\\\n\\psi(\\alpha_i) & = & \\psi(\\sum_{k=1}^n \\alpha_k^{(t-1)}) + log(\\tilde{p_i})\n\\end{eqnarray}\n$$\n\n\u3053\u306e\u3088\u3046\u306b\u4e0b\u9650\u5024\u306e\u6700\u5927\u5316\u3067\u3082\u4e0d\u52d5\u70b9\u53cd\u5fa9\u6cd5\u3092\u4eee\u5b9a\u3057\u3066\u5c0e\u51fa\u3057\u305f\u66f4\u65b0\u5f0f\u3092\u540c\u3058\u5f0f\u304c\u5f97\u3089\u308c\u305f\u3002\uff08\u4e0b\u9650\u5024\u306e\u6700\u5927\u5316\u3092\u7e70\u308a\u8fd4\u3057\u884c\u3046\u3068\u3044\u3046\u610f\u5473\u3067EM\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u306b\u4f3c\u3066\u3044\u308b\uff09\n\n\u3053\u3053\u3067\u4e0b\u9650\u306e $ G(\\b{\\alpha}) $ \u3092\u6700\u5927\u5024\u3092\u3068\u308b\u30d1\u30e9\u30e1\u30fc\u30bf\u30fc\u304c $ \\psi(\\alpha_i) = \\psi(\\alpha_k^{(t)}) $ \u3068\u306a\u3063\u3066\u3044\u308b\u3002\n\n\n### \u30cb\u30e5\u30fc\u30c8\u30f3\u6cd5\u306b\u3088\u308b\u89e3\u6cd5\n\u30cb\u30e5\u30fc\u30c8\u30f3\u6cd5\u306b\u3088\u308b\u89e3\u6cd5\u3082\u7d39\u4ecb\u3059\u308b\u3002\n\u591a\u6b21\u5143\u306e\u30cb\u30e5\u30fc\u30c8\u30f3\u6cd5\u306f\u4ee5\u4e0b\u3092\u6e80\u305f\u3059 $ \\b{x} $ \u3092\u5f97\u308b\u65b9\u6cd5\u3067\u3042\u308b\u3002\n\n$$\n\\begin{eqnarray}\n\\b{f}(\\b{x}) = \\b{0}\n\\end{eqnarray}\n$$\n\n$ \\b{f}(\\b{x}) $ \u3092\u9069\u5f53\u306a\u70b9 $ \\b{x^{\\ast}} $ \u306b\u5bfe\u3057\u3066\u30c6\u30a4\u30e9\u30fc\u5c55\u958b\u3059\u308b\u3068\n\n$$\n\\begin{eqnarray}\n\\b{f}(\\b{x}) = \\b{f}(\\b{x^{\\ast}}) + \\frac{\\partial \\b{f}(\\b{x^{\\ast}})}{\\partial \\b{x}}(\\b{x} - \\b{x^{\\ast}}) + O((\\b{x} - \\b{x^{\\ast}})^2)\n\\end{eqnarray}\n$$\n\n\u4e8c\u6b21\u4ee5\u964d\u306e\u5fae\u5c0f\u91cf\u3092\u7121\u8996\u3057\u3066$\\b{f}(\\b{x}) = \\b{0}$ \u3092\u4ee3\u5165\u3057\u3001 $\\b{x}$ \u306b\u3064\u3044\u3066\u89e3\u304f\u3068\u4ee5\u4e0b\u306e\u5f0f\u3092\u5f97\u308b\u3002\n\n$$\n\\begin{eqnarray}\n\\b{x} = \\b{x^{\\ast}} - \\left(\\frac{\\partial \\b{f}(\\b{x^{\\ast}})}{\\partial \\b{x}}\\right)^{-1} \\b{f}(\\b{x^{\\ast}})\n\\end{eqnarray}\n$$\n\n\u3053\u308c\u304c\u30cb\u30e5\u30fc\u30c8\u30f3\u6cd5\u306e\u66f4\u65b0\u5f0f\u3067\u3042\u308b\u3002\n\n\u3055\u3066\u4eca\u6c42\u3081\u305f\u3044\u5024\u306f $ \\frac{\\partial L(\\b{\\alpha})}{\\partial \\b{\\alpha}} = \\b{0} $ \u306a\u306e\u3067\u3001$ L(\\b{\\alpha}) $ \u3092\u3082\u3046\u4e00\u5ea6\u5fae\u5206\u3059\u308b\u3002\n\n$$\n\\begin{eqnarray}\n\\frac{1}{N} \\frac{\\partial^2 L(\\b{\\alpha})}{\\partial \\alpha_j \\partial \\alpha_i} & =  & \\psi'(\\sum_{k=1}^n \\alpha_k) (\\sum_{k=1}^n \\frac{\\partial \\alpha_k}{\\partial \\alpha_j}) + \\psi'(\\alpha_i) \\frac{\\partial \\alpha_i}{\\partial \\alpha_j} \\\\\\\n& = & \\psi'(\\sum_{k=1}^n \\alpha_k) - \\psi'(\\alpha_i) \\delta_{i,j}\n\\end{eqnarray}\n$$\n\n$\\\\{ \\b{H(\\b{\\alpha})} \\\\}\\_{i,j} = \\frac{\\partial L(\\b{\\alpha})}{\\partial \\alpha_j \\partial \\alpha_i}$ \u3068\u3057\u3066\u65b0\u3057\u304f\u30d8\u30c3\u30bb\u884c\u5217\u3092\u5b9a\u7fa9\u3059\u308b\u3002\u307e\u305f\u3001 $ z = N ~ \\psi'(\\sum_{k=1}^n \\alpha_k) $ \u3068 $ \\\\{ \\b{Q} \\\\}\\_{i,j} = - N ~ \\psi'(\\alpha_i) \\delta_{i,j} $, $ \\\\{\\b{g}(\\b{\\alpha})\\\\}\\_{i} = \\frac{\\partial L(\\alpha)}{\\partial \\alpha_i} $ \u3068\u65b0\u3057\u3044\u884c\u5217\u30fb\u95a2\u6570\u30fb\u30d9\u30af\u30c8\u30eb $ z, \\b{Q}, \\b{g} $ \u3092\u5b9a\u3081\u308b\u3002\u30d8\u30c3\u30bb\u884c\u5217 $ \\b{H} $ \u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u8868\u305b\u308b\u3002\n\n$$\n\\begin{eqnarray}\n\\b{H} = \\b{Q} + \\b{1 1^t}z\n\\end{eqnarray}\n$$\n\n$ L(\\b{\\alpha}) $ \u306b\u5bfe\u3057\u3066\u30cb\u30e5\u30fc\u30c8\u30f3\u6cd5\u3092\u9069\u7528\u3059\u308b\u3068\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u8868\u305b\u308b\u3002\n\n$$\n\\begin{eqnarray}\n\\b{\\alpha^{(t)}} = \\b{\\alpha^{(t-1)}} - \\b{H}^{-1}(\\b{\\alpha^{(t-1)}}) \\b{g}(\\b{\\alpha^{(t-1)}})\n\\end{eqnarray}\n$$\n\n\u66f4\u65b0\u5f0f\u3067\u306f $ \\b{H}, \\b{g} $ \u304c\u305d\u308c\u305e\u308c $ \\b{x^{(t-1)}} $ \u306b\u4f9d\u5b58\u3057\u3066\u3044\u308b\u3053\u3068\u3092\u660e\u793a\u7684\u306b\u793a\u3059\u305f\u3081\u306b\u62ec\u5f27\u3092\u5165\u308c\u305f\u3002\u30cb\u30e5\u30fc\u30c8\u30f3\u6cd5\u3067\u306f $ \\b{H} $ \u306e\u9006\u884c\u5217\u3092\u7528\u3044\u308b\u306e\u3067\u3001\u3053\u308c\u3092\u89e3\u6790\u7684\u306b\u8868\u3057\u305f\u3044\u3002\u305d\u306e\u305f\u3081\u306b Appendix C \u3067\u8aac\u660e\u3057\u3066\u3044\u308b Sherman\u2013Morrison \u306e\u516c\u5f0f\u3092\u7528\u3044\u3066\u5f0f\u306e\u5909\u5f62\u3092\u884c\u3046\u3068\n\n$$\n\\begin{eqnarray}\n\\b{H}^{-1}\\b{g} & = & (\\b{Q} + \\b{1 1^t} z)^{-1}\\b{g} \\\\\\\n& = & \\b{Q}^{-1}\\b{g} - \\frac{\\b{Q^{-1} 1 1^t Q^{-1} g}}{\\frac{1}{z}+\\b{1^t Q^{-1} 1}} \\\\\\\n& = & \\b{Q}^{-1}\\b{g} - \\b{Q^{-1} 1} (\\frac{\\b{1^t Q^{-1} g}}{\\frac{1}{z}+\\b{1^t Q^{-1} 1}}) \\\\\\\n& = & \\b{Q}^{-1} (\\b{g} - \\b{1}b)\n\\end{eqnarray}\n$$\n\n\u3053\u3053\u3067 $ b $ \u306f\u4ee5\u4e0b\u306e\u5b9a\u6570\u3067\u3042\u308b\u3002\n\n$$\n\\begin{eqnarray}\nb = \\frac{\\b{1^t Q^{-1} g}}{\\frac{1}{z}+\\b{1^t Q^{-1} 1}}\n\\end{eqnarray}\n$$\n\n$ \\b{H}^{-1} \\b{g} $\u3000\u306e\u5404\u9805\u3092\u5177\u4f53\u7684\u306b\u6c42\u3081\u308b\u3068\u3000$ \\\\{\\b{Q}\\\\}\\_{i,j} = - N ~ \\psi'(\\alpha_i) \\delta_{i,j} $ \u3092\u76f4\u63a5\u4ee3\u5165\u3059\u308b\u3053\u3068\u3067\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u306a\u308b\u3002\n\n$$\n\\begin{eqnarray}\n\\\\{\\b{H}^{-1} \\b{g}\\\\}\\_{k} & = & \\\\{ \\b{Q}^{-1} (\\b{g} - \\b{1}b) \\\\}\\_{k} \\\\\\\n& = & \\sum_{j} \\\\{\\b{Q^{-1}}\\\\}\\_{k,j} (\\b{g} - \\b{1} b)\\_{j} \\\\\\\n& = & \\sum_{j} \\frac{\\delta_{k,j}}{-N ~ \\psi'(\\alpha_k)} (g_j - b) \\\\\\\n& = & \\frac{g_k - b}{-N ~ \\psi'(\\alpha_k)} \\\\\\\n& = & \\frac{g_k - b}{\\\\{\\b{Q}\\\\}\\_{k,k}}\n\\end{eqnarray}\n$$\n\n\n##### \u30cb\u30e5\u30fc\u30c8\u30f3\u6cd5\u307e\u3068\u3081\n\n\u3053\u308c\u3089\u306e\u7d50\u679c\u3092\u307e\u3068\u3081\u308b\u3068\u30cb\u30e5\u30fc\u30c8\u30f3\u6cd5\u306e\u66f4\u65b0\u5f0f\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u7c21\u6f54\u306b\u8868\u305b\u308b\u3002\n\n\n$$\n\\begin{eqnarray}\n\\b{\\alpha}^{(t)} & = & \\b{\\alpha}^{(t-1)} - \\b{H^{-1} g} \\\\\\\n\\\\{\\b{H^{-1} g}\\\\}\\_{k} & = & (g_k - b)\\\\{\\b{Q^{-1}}\\\\}\\_{k,k} \\\\\\\nb & = & \\frac{\\b{1^t Q^{-1} g}}{\\frac{1}{z} + \\b{1^t Q^{-1} 1}} \\\\\\\n\\\\{\\b{g}\\\\}\\_{k} & = & N ~ \\psi(\\sum_{k=1}^n \\alpha_k^{(t-1)}) - N ~ \\psi(\\alpha_k^{(t-1)}) + N ~ log(\\tilde{p_k}) \\\\\\\nz & = & N ~ \\psi'(\\sum_{k=1}^n \\alpha_k^{(t-1)}) \\\\\\\n\\\\{\\b{Q}^{-1}\\\\}\\_{i,j} & = & - \\frac{\\delta\\_{i,j}}{N ~ \\psi'(\\alpha_i^{(t-1)})} \\\\\\\n\\end{eqnarray}\n$$\n\n\n### Appendix List\n\n#### Appendix A: \u30c7\u30a3\u30ac\u30f3\u30de\u95a2\u6570\u306e\u8a08\u7b97\u3068\u6027\u8cea\n###### \u30c7\u30a3\u30ac\u30f3\u30de\u95a2\u6570\u306e\u6f38\u8fd1\u5c55\u958b\n\n\u6700\u521d\u306f\u30c7\u30a3\u30ac\u30f3\u30de\u95a2\u6570\u306e\u5177\u4f53\u7684\u306a\u7d1a\u6570\u8868\u793a\u3092\u5c0e\u304f\u3002\n\n\u30c7\u30a3\u30ac\u30f3\u30de\u95a2\u6570\u306e\u5b9a\u7fa9\u306f $ \\frac{\\partial}{\\partial x} log \\Gamma(x) $ \u3067\u3042\u308b\u3002$ log $ \u304c\u5165\u3063\u3066\u3044\u308b\u306e\u3067\u3001\u307e\u305a\u30ac\u30f3\u30de\u95a2\u6570\u3092\u639b\u3051\u7b97\u306e\u4e57\u7a4d\u8868\u793a\u3068\u3057\u3066\u8868\u305b\u308b\u3068\u4fbf\u5229\u3067\u3042\u308d\u3046\u3002\u3053\u308c\u306f\u30ef\u30a4\u30a8\u30eb\u30b7\u30e5\u30c8\u30e9\u30b9\u306e\u7121\u9650\u4e57\u7a4d\u8868\u793a\u3092\u7528\u3044\u308b\u3053\u3068\u3067\u89e3\u6c7a\u3059\u308b\u3002\n\n\u30ef\u30a4\u30a8\u30eb\u30b7\u30e5\u30c8\u30e9\u30b9\u306e\u7121\u9650\u4e57\u7a4d\u8868\u793a\u306f\u4ee5\u4e0b\u306e\u95a2\u4fc2\u5f0f\u306e\u3053\u3068\u3092\u6307\u3059\n\n$$\n\\begin{eqnarray}\n\\Gamma(x) & =  & \\lim_{n \\to \\infty} \\frac{n!n^x}{(n+x)(n+x-1)...(x+1)x}\n\\end{eqnarray}\n$$\n\n\u3053\u306e\u5f0f\u306e\u5c0e\u51fa\u65b9\u6cd5\u306b\u3064\u3044\u3066\u3082\u3001\u6570\u5b66\u7684\u306a\u53b3\u5bc6\u6027\u306f\u72a0\u7272\u306b\u3057\u3066\u3067\u304d\u308b\u3060\u3051\u76f4\u611f\u7684\u306b\u8aac\u660e\u3059\u308b\u3002\u307e\u305a\u968e\u4e57\u3092\u8868\u3059\u30ac\u30f3\u30de\u95a2\u6570\u304c\u4e0e\u3048\u3089\u308c\u3066\u3044\u308b\u3068\u3057\u3088\u3046\u3002**\u3053\u306e\u30ac\u30f3\u30de\u95a2\u6570\u306e\u5177\u4f53\u7684\u306a\u5f62\u3092\u77e5\u3089\u306a\u304b\u3063\u305f\u3068\u3057\u3066\u30ac\u30f3\u30de\u95a2\u6570\u3092\u81ea\u7136\u6570\u304b\u3089\u5b9f\u6570\u306b\u62e1\u5f35\u3057\u305f\u3044\u3002**\u305d\u306e\u3088\u3046\u306a\u30b1\u30fc\u30b9\u3068\u3057\u3066\u8003\u3048\u3088\u3046\u3002\n\n\u6700\u521d\u306e\u51fa\u767a\u70b9\u306f\u4ee5\u4e0b\u306e\u8fd1\u4f3c\u5f0f\u3067\u3042\u308b\u3002\n$ k << n $ \u306e\u6642\n\n$$\n\\begin{eqnarray}\n\\frac{\\Gamma(n+k+1)}{\\Gamma(n+1)} & = & (n+k)(n+k-1)...(n+1) \\\\\\\n& \\cong & n^k\n\\end{eqnarray}\n$$\n\n\u3067\u3042\u308b\u3002\u3053\u3053\u3067 $ k $ \u306b\u5bfe\u3057\u3066\u81ea\u7136\u6570\u304b\u3089\u5b9f\u6570\u3078\u306e\u62e1\u5f35\u3092\u8a66\u307f\u308b\u3002\u4e0a\u8a18\u306e\u95a2\u4fc2\u3092\u5b9f\u6570 $ x $ \u306b\u3064\u3044\u3066\u3082\u6210\u308a\u7acb\u3064\u3068\u62e1\u5f35\u3059\u308b\u306e\u306f\u81ea\u7136\u3067\u3042\u308d\u3046\u3002\u3059\u306a\u308f\u3061 $ x << n $ \u3068\u3057\u3066\n\n$$\n\\begin{eqnarray}\n\\frac{\\Gamma(n+x+1)}{\\Gamma(n+1)} & \\cong & n^x\n\\end{eqnarray}\n$$\n\n\u5341\u5206\u5927\u304d\u306a n \u306b\u3064\u3044\u3066 \u4e0a\u8a18\u306e\u5f0f\u304c\u6210\u308a\u7acb\u3064\u3068\u4eee\u5b9a\u3057\u3001\u305d\u308c\u305e\u308c\u4e21\u8fba\u3092\u5c55\u958b\u3059\u308b\u3068\n\n$$\n\\begin{eqnarray}\n\\lim_{n \\to \\infty} \\frac{(n+x)(n+x-1)...(x+1)x\\Gamma(x)}{n!} & = & \\lim_{n \\to \\infty} n^x \\\\\\\n\\Gamma(x) & =  & \\lim_{n \\to \\infty} \\frac{n!n^x}{(n+x)(n+x-1)...(x+1)x}\n\\end{eqnarray}\n$$\n\n\u3068\u30ef\u30a4\u30a8\u30eb\u30b7\u30e5\u30c8\u30e9\u30b9\u306e\u7121\u9650\u4e57\u7a4d\u8868\u793a\u3092\u5c0e\u304f\u3053\u3068\u304c\u3067\u304d\u308b\u3002\n\n\u3055\u3066\u3053\u308c\u3092\u7528\u3044\u3066\u30c7\u30a3\u30ac\u30f3\u30de\u95a2\u6570\u306e\u5177\u4f53\u7684\u306a\u5f62\u3092\u6c42\u3081\u308b\u3002\n\n\n$$\n\\begin{eqnarray}\n\\frac{\\partial}{\\partial x} log(\\Gamma(x)) & = & \\lim_{n \\to \\infty} \\frac{\\partial}{\\partial x} log(\\frac{n!n^x}{\\prod_{i=0}^n (i+x)}) \\\\\\\n& = & \\lim_{n \\to \\infty} \\frac{\\partial}{\\partial x} \\\\{\n \\sum_{i=1}^n log(i) - log(i+x) \\\\} - log(x) + x ~ log(n) \\\\\\\n& = & \\lim_{n \\to \\infty} \\\\{- \\sum_{i=1}^n \\frac{1}{i+x} - \\frac{1}{x} + log(n) \\\\} \\\\\\\n& = & - \\frac{1}{x} + \\lim_{n \\to \\infty} \\\\{ (\\sum_{i=1}^n \\frac{1}{i} - \\frac{1}{i+x}) - (\\sum_{i=1}^n -\\frac{1}{i}  + log(n)) \\\\} \\\\\\\n& = & -\\gamma - \\frac{1}{x} +  (\\sum_{i=1}^{\\infty} \\frac{1}{i} - \\frac{1}{i+x}) \\\\\\\n\\end{eqnarray}\n$$\n\n\n\u305f\u3060\u3057 $ \\gamma $ \u306f\u30aa\u30a4\u30e9\u30fc\u5b9a\u6570\u3067\u4ee5\u4e0b\u306e\u6975\u9650\u3067\u3042\u308b\u3002\n\n$$\n\\begin{eqnarray}\n\\gamma = \\lim_{n \\to \\infty} (log(n) - \\sum_{i=1}^n \\frac{1}{i})\n\\end{eqnarray}\n$$\n\n\u3053\u3053\u3067\u4ee5\u4e0b\u306e\u95a2\u4fc2\u5f0f\u304c\u6210\u308a\u7acb\u3064\u3053\u3068\u306b\u6ce8\u76ee\u3059\u308b\u3068\n\n$$\n\\begin{eqnarray}\n\\phi(x + 1) & = & \\frac{\\partial}{\\partial x} log \\Gamma(x + 1) \\\\\\\n& = & \\frac{\\partial}{\\partial x} (log(x) + \\Gamma(x)) \\\\\\\n& = & \\frac{1}{x} + \\phi(x)\n\\end{eqnarray}\n$$\n\n\u5148\u307b\u3069\u306e\u5f0f\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u8868\u305b\u308b\u3002\n\n$$\n\\begin{eqnarray}\n\\psi(x+1) = -\\gamma  + (\\sum_{i=1}^{\\infty} \\frac{1}{i} - \\frac{1}{i+x})\n\\end{eqnarray}\n$$\n\n\u3053\u306e\u3088\u3046\u306b\u5177\u4f53\u7684\u306a\u30c7\u30a3\u30ac\u30f3\u30de\u95a2\u6570\u306e\u7d1a\u6570\u8868\u793a\u304c\u5f97\u3089\u308c\u305f\u3002\n\u307e\u305f\u4e8c\u968e\u5fae\u5206\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u306a\u308b\u3002\n\n$$\n\\begin{eqnarray}\n\\psi'(x+1) = \\sum_{i=1}^{\\infty} \\frac{1}{(i+x)^2} \\\\\\\n\\end{eqnarray}\n$$\n\n\u3053\u306e\u4e8c\u968e\u5fae\u5206\u306f\u90062\u4e57\u548c\u306a\u306e\u3067\u53ce\u675f\u306f\u6975\u3081\u3066\u9045\u3044\u3002\n\u305d\u306e\u305f\u3081\u3088\u308a\u53ce\u675f\u304c\u65e9\u3044\u95a2\u6570\u306e\u7d1a\u6570\u3068\u3057\u3066\u8868\u3057\u305f\u3044\u3002\u305d\u306e\u305f\u3081\u306b\u30aa\u30a4\u30e9\u30fc\u30de\u30af\u30ed\u30fc\u30ea\u30f3\u306e\u548c\u516c\u5f0f\u3092\u4f7f\u3063\u3066\u30d9\u30eb\u30cc\u30fc\u30a4\u6570\u306e\u7d1a\u6570\u3068\u3057\u3066\u8868\u3059\u3002\n\n######  \u30aa\u30a4\u30e9\u30fc\u30de\u30af\u30ed\u30fc\u30ea\u30f3\u306e\u548c\u516c\u5f0f\n\u30aa\u30a4\u30e9\u30fc\u306e\u548c\u516c\u5f0f\u3092\u8aac\u660e\u3059\u308b\u3002\u5fae\u5206\u6f14\u7b97\u5b50\u3092 $ D = \\frac{d}{dx} $ \u3068\u3059\u308b\u3002\n\u3053\u306e\u6642\u30c6\u30a4\u30e9\u30fc\u5c55\u958b\u3092\u7528\u3044\u308b\u3068\n\n$$\n\\begin{eqnarray}\nf(x+n) & = & \\sum_{k=0}^{\\infty} \\frac{D^k f(x)}{k !} n^k \\\\\\\n& = & (\\sum_{k=0}^{\\infty} \\frac{(n D)^k }{n!}) f(x) \\\\\\\n& = & e^{nD} f(x)\n\\end{eqnarray}\n$$\n\n\u3053\u308c\u3088\u308a\n\n$$\n\\begin{eqnarray}\n\\sum_{k=0}^{N-1} f(x+n) & = & \\sum_{n=0}^{N-1} e^{nD} f(x) \\\\\\\n& = & \\frac{e^{N ~ D} - 1}{e^D - 1} f(x) \\\\\\\n& = & \\frac{1}{e^D - 1} (f(x + N) - f(x)) \\\\\\\n& = & (D^{-1} + \\sum_{n=1}^{\\infty} \\frac{B_n}{n!} D^{(n-1)}) (f(x + N) - f(x))\n\\end{eqnarray}\n$$\n\n\u3053\u3053\u3067\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u6bcd\u95a2\u6570\u306e\u30c6\u30a4\u30e9\u30fc\u5c55\u958b\u3092\u7528\u3044\u3066\u30d9\u30eb\u30cc\u30fc\u30a4\u95a2\u6570 $ B_n $ \u3092\u5b9a\u7fa9\u3057\u305f\u3002\n\n$$\n\\begin{eqnarray}\n\\frac{x}{e^x - 1} = \\sum_{n=0}^{\\infty} \\frac{B_n}{n!} x^n\n\\end{eqnarray}\n$$\n\n\u4e21\u8fba\u306e $ \\lim{x \\to 0} $ \u306e\u6975\u9650\u3092\u8003\u3048\u308c\u3070 $ B_0 = 1 $ \u3067\u3042\u308b\u3053\u3068\u304c\u5206\u304b\u308b\u3002\u307e\u305f $ D^{-1} $ \u306e\u9006\u6f14\u7b97\u306e\u7a4d\u5206\u3067\u3042\u308b\u3053\u3068\u306f\u6b21\u306e\u3088\u3046\u306b\u3057\u3066\u7406\u89e3\u3067\u304d\u308b\u3002\n\n$$\n\\begin{eqnarray}\ng(x) & = & D^{-1} f(x) \\\\\\\nD g(x) & = & D \\circ D^{-1} f(x) \\\\\\\n\\frac{d}{dx} g(x) & = & f(x) \\\\\\\ng(x) & = & \\int_{\\alpha}^{x} f(t) dt + C\n\\end{eqnarray}\n$$\n\n\u3053\u308c\u3089\u3088\u308a\u5143\u306e\u65b9\u7a0b\u5f0f\u306b $ x = 0 $ \u3092\u4ee3\u5165\u3057\u3066 N \u306b\u5bfe\u3057\u3066\u6975\u9650\u3092\u53d6\u308b\u3068\n\n$$\n\\begin{eqnarray}\n\\sum_{k=0}^{\\infty} f(n) - \\int_{0}^{\\infty} f(n) dn & =  & \\lim_{N \\to \\infty} C_N + \\sum_{n=1}^{\\infty} \\frac{B_n}{n!} (f^{(n-1)}(N) - f^{(n-1)}(0))\n\\end{eqnarray}\n$$\n\n\u6bcd\u95a2\u6570\u540c\u58eb\u306e\u5f15\u304d\u7b97\u3092\u8a08\u7b97\u3059\u308b\u3053\u3068\u30673\u4ee5\u4e0a\u306e\u5947\u6570\u3067\u5168\u3066 $ B_n = 0 $ \u306b\u306a\u308b\u3053\u3068\u3092\u8a3c\u660e\u3059\u308b\u3002 $ g(x) = \\frac{x}{e^x - 1} $ \u3068\u3057\u3066\n\n$$\n\\begin{eqnarray} \\\\\\\ng(x) - g(-x) & = & \\frac{x}{e^x - 1} - \\frac{-x}{e^{-x} - 1} \\\\\\\n& = & \\frac{x(1-e^x)}{e^x-1} = -x\n\\end{eqnarray}\n$$\n\n\u3053\u308c\u3088\u308a\n\n$$\n\\sum_{k=0}^{\\infty} \\frac{2 B_{2k+1}}{(2k+1)!} x^{2k} = -x\n$$\n\n\u3067\u4e21\u8fba\u3092\u6bd4\u3079\u308b\u3053\u3068\u3067 $ B_1 = - \\frac{1}{2} $ \u304b\u3064 $ B_n = 0, n \\ge 3 $ \u3067\u3042\u308b\u3053\u3068\u304c\u5206\u304b\u308b\u3002\u3053\u308c\u3092\u7528\u3044\u3066\u30aa\u30a4\u30e9\u30fc\u30de\u30af\u30ed\u30fc\u30ea\u30f3\u306e\u516c\u5f0f\u3092\u66f8\u304d\u306a\u304a\u305b\u3070\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u306a\u308b\u3002\n\n$$\n\\begin{eqnarray}\n\\sum_{k=0}^{\\infty} f(n) - \\int_{0}^{\\infty} f(n) dn & =  & \\lim_{N \\to \\infty} C_N + \\frac{1}{2} (f(N) - f(0)) +  \\nonumber\\\\\\\n& & ~~~~~~ \\sum_{n=1}^{\\infty} \\frac{B_{2n}}{(2n)!} (f^{(2n-1)}(N) - f^{(2n-1)}(0))\n\\end{eqnarray}\n$$\n\n\u3053\u3053\u3067 $ C $ \u306f\u9069\u5f53\u306a\u5b9a\u6570\u3067\u3042\u308b\u3002\uff08\u53f3\u8fba\u306e\u6975\u9650\u304c\u53ce\u675f\u3059\u308b\u5834\u5408\u306e\u5270\u4f59\u9805\uff09\n\n\n###### \u30c7\u30a3\u30ac\u30f3\u30de\u95a2\u6570\u306e\u6f38\u8fd1\u8868\u793a\n\u30aa\u30a4\u30e9\u30fc\u30de\u30af\u30ed\u30fc\u30ea\u30f3\u306e\u516c\u5f0f\u306b\u5bfe\u3057\u3066\u4ee5\u4e0b\u306e\u3088\u3046\u306b $ f(n) = \\frac{1}{(n+x)^2} $ \u3092\u5b9a\u7fa9\u3059\u308c\u3070\u30c7\u30a3\u30ac\u30f3\u30de\u95a2\u6570\u306e\u5fae\u5206\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u8868\u305b\u308b\u3002\n\n$$\n\\begin{eqnarray}\n\\psi'(x) - \\int_{0}^{\\infty} \\frac{1}{(n+x)^2} dn & = & C + \\frac{1}{2x^2} + \\sum_{n=1}^{\\infty} \\frac{B_n}{x^{2n+1}} \\\\\\\n\\psi'(x) & = & C + \\frac{1}{x} + \\frac{1}{2x^2} + \\sum_{n=1}^{\\infty} \\frac{B_{2n}}{x^{2n+1}}\n\\end{eqnarray}\n$$\n\n\u4e21\u8fba $ \\lim x \\to \\infty $ \u306e\u6975\u9650\u3092\u8003\u3048\u308c\u3070 $ C = 0 $ \u3067\u3042\u308b\u3053\u3068\u304c\u5206\u304b\u308b\u3002\n\n$$\n\\begin{eqnarray}\n\\psi'(x) & = & \\frac{1}{x} + \\frac{1}{2x^2} + \\sum_{n=1}^{\\infty} \\frac{B_{2n}}{x^{2n+1}}\n\\end{eqnarray}\n$$\n\n\u3053\u306e\u4e21\u8fba\u3092\u7a4d\u5206\u3059\u308c\u3070\u76ee\u7684\u306e\u30c7\u30a3\u30ac\u30f3\u30de\u95a2\u6570\u306e\u7d1a\u6570\u8868\u793a\u304c\u5f97\u3089\u308c\u308b\u3002\n\n$$\n\\begin{eqnarray}\n\\psi(x) & = & C + log(x) - \\frac{1}{x} - \\sum_{n=1}^{\\infty} \\frac{B_{2n}}{2n ~ x^{2n}}\n\\end{eqnarray}\n$$\n\n\u3053\u3053\u3067 $ \\psi(x+1) = \\psi(x) + \\frac{1}{x} $ \u3092\u7e70\u308a\u8fd4\u3057\u9069\u7528\u3059\u308b\u3053\u3068\u3067\u81ea\u7136\u6570 M \u306b\u5bfe\u3057\u3066\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u9589\u3058\u305f\u5f62\u3067\u8868\u3059\u3053\u3068\u304c\u51fa\u6765\u308b\u3002\n\n$$\n\\begin{eqnarray}\n\\psi(M) & = & \\sum_{k=1}^{M-1} \\frac{1}{k} + \\psi(1) \\\\\\\n& = &\\sum_{k=1}^{M-1} \\frac{1}{k} - \\gamma\n\\end{eqnarray}\n$$\n\n\u3057\u305f\u304c\u3063\u3066\u3053\u306e\u3088\u3046\u306a\u81ea\u7136\u6570 M \u3092\u5148\u307b\u3069\u306e\u5f0f\u306b\u4ee3\u5165\u3057\u3066\u305d\u306e\u6975\u9650\u3092\u53d6\u308b\u3068\n\n$$\n\\begin{eqnarray}\n\\lim_{M \\to \\infty} \\psi(M) - log(M) & = & C + \\lim_{M \\to \\infty} - \\frac{1}{M} - \\sum_{n=1}^{\\infty} \\frac{B_{2n}}{2n ~ M^{2n}} \\\\\\\nC & = & \\lim_{M \\to \\infty} -\\gamma + \\\\{ \\sum_{k=1}^{M-1} \\frac{1}{k} - log(M) \\\\} \\\\\\\n& = & - \\gamma + \\gamma = 0 \\\\\\\n\\end{eqnarray}\n$$\n\n\u3088\u3063\u3066\u5b9a\u6570\u306f 0 \u306b\u306a\u308b\u3053\u3068\u304c\u5206\u304b\u308b\u3002\n\u3053\u308c\u3089\u3092\u307e\u3068\u3081\u308b\u3068\u30c7\u30a3\u30ac\u30f3\u30de\u95a2\u6570\u3068\u30c7\u30a3\u30ac\u30f3\u30de\u95a2\u6570\u306e\u5fae\u5206 $ \\psi(x), \\psi'(x)$ \u306f\u305d\u308c\u305e\u308c\u4ee5\u4e0b\u306e\u7d1a\u6570\u3092\u6570\u5024\u8a08\u7b97\u3059\u308c\u3070\u3088\u3044\u3002\u307e\u305f\u30d9\u30eb\u30cc\u30fc\u30a4\u6570\u306e\u6c42\u3081\u65b9\u306b\u3064\u3044\u3066\u306f Appendix D \u306b\u3066\u8aac\u660e\u3057\u3066\u3044\u308b\u3002\n\n$$\n\\begin{eqnarray}\n\\psi'(x) & = & \\frac{1}{x} + \\frac{1}{2x^2} + \\sum_{n=1}^{\\infty} \\frac{B_{2n}}{x^{2n+1}} \\\\\\\n\\psi(x) & = & log(x) - \\frac{1}{x} - \\sum_{n=1}^{\\infty} \\frac{B_{2n}}{2n ~ x^{2n}}\n\\end{eqnarray}\n$$\n\n\n#### Appendix B: \u30c7\u30a3\u30ac\u30f3\u30de\u95a2\u6570\u306e\u4e0d\u7b49\u5f0f\n\u8a3c\u660e\u3059\u308b\u3079\u304d\u4e0d\u7b49\u5f0f\u306f\n\n$$\n\\begin{eqnarray}\n\\Gamma(x) \\ge \\Gamma(\\tilde{x})~exp((x-\\tilde{x}) \\psi(x))\n\\end{eqnarray}\n$$\n\n\u3067\u3042\u308b\u3002\n\u3053\u306e\u4e0d\u7b49\u5f0f\u3092\u8a3c\u660e\u3059\u308b\u524d\u306b\u307e\u305a\u30c7\u30a3\u30ac\u30f3\u30de\u95a2\u6570\u306e\u5358\u8abf\u6027\u3092\u5229\u7528\u3059\u308b\u3002\u3053\u306e\u4e8b\u5b9f\u306f\u3000$ \\psi'(x+1) = \\sum_{i=1}^{\\infty} \\frac{1}{(i+x)^2} > 0 $ \u304b\u3089\u660e\u3089\u304b\u3067\u3042\u308b\u3002\u3053\u306e\u5358\u8abf\u5897\u52a0\u6027\u3092\u5e73\u5747\u5024\u306e\u5b9a\u7406\u3068\u7d44\u307f\u5408\u308f\u305b\u308c\u3070\u76ee\u7684\u306e\u4e0d\u7b49\u5f0f\u304c\u5f97\u3089\u308c\u308b\u3002\n\n\u4efb\u610f\u306e $ y > x $ \u306b\u5bfe\u3057\u3066\u5e73\u5747\u5024\u306e\u5b9a\u7406\u3088\u308a\n\n$$\n\\begin{eqnarray}\n\\frac{log(\\Gamma(y)) - log(\\Gamma(x))}{y-x} = \\left.\\frac{d~  log(\\Gamma(x))}{dx}\\right|_{x=z} = \\psi(z) ~~~~ (x < z < y)\n\\end{eqnarray}\n$$\n\n\u3053\u3053\u3067\u30c7\u30a3\u30ac\u30f3\u30de\u95a2\u6570\u306e\u5358\u8abf\u6027\u3092\u5229\u7528\u3059\u308b\u3068\n\n$$\n\\begin{eqnarray}\n\\frac{log(\\Gamma(y)) - log(\\Gamma(x))}{y-x} > \\psi(x)\n\\end{eqnarray}\n$$\n\n\u540c\u69d8\u306b\u3057\u3066 $ y < x $ \u306b\u5bfe\u3057\u3066\u3082\n\n$$\n\\begin{eqnarray}\n\\frac{log(\\Gamma(x)) - log(\\Gamma(y))}{x-y} = \\left.\\frac{d~  log(\\Gamma(x))}{dx}\\right|_{x=z} = \\psi(z)  ~~~~ (y < z < x)\n\\end{eqnarray}\n$$\n\n\u3088\u308a\u5358\u8abf\u6027\u304b\u3089\u4ee5\u4e0b\u304c\u6210\u308a\u7acb\u3064\n\n$$\n\\begin{eqnarray}\n\\frac{log(\\Gamma(x)) - log(\\Gamma(y))}{x-y} < \\psi(x)\n\\end{eqnarray}\n$$\n\n\u3053\u308c\u3089\u306e\u7d50\u679c\u3092\u5408\u308f\u305b\u308c\u3070\u4ee5\u4e0b\u306e\u4e0d\u7b49\u5f0f\u304c\u4efb\u610f\u306e $ \\tilde{x} $ \u306b\u5bfe\u3057\u3066\u6210\u308a\u7acb\u3064\u3053\u3068\u306f\u660e\u3089\u304b\u3067\u3042\u308b\u3002\n\n$$\n\\begin{eqnarray}\nlog(\\Gamma(x)) - log(\\Gamma(\\tilde{x})) \\ge \\psi(x)(x-\\tilde{x})\n\\end{eqnarray}\n$$\n\n\u4e21\u8fba\u306e\u6307\u6570\u3092\u3068\u3063\u3066\u5f0f\u3092\u5909\u5f62\u3055\u305b\u308b\u3068\u76ee\u7684\u306e\u4e0d\u7b49\u5f0f\u3092\u5f97\u308b\u3002\n\n$$\n\\begin{eqnarray}\n\\Gamma(x) \\ge \\Gamma(\\tilde{x})~exp((x-\\tilde{x}) \\psi(x))\n\\end{eqnarray}\n$$\n\n\n#### Appendix C: Sherman\u2013Morrison \u306e\u516c\u5f0f\u5c0e\u51fa\nSherman Morrison \u306e\u516c\u5f0f\u3068\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u95a2\u4fc2\u5f0f\u306e\u3053\u3068\u3067\u3042\u308b\u3002\n\n$$\n\\begin{eqnarray}\n(\\b{A} + \\b{u} \\b{v^t})^{-1} & = & \\b{A}^{-1} - \\frac{\\b{A}^{-1}\\b{u}\\b{v^t}\\b{A^{-1}}}{1+\\b{v^t}\\b{A^{-1}}\\b{u}}\n\\end{eqnarray}\n$$\n\n\u5de6\u8fba\u306e\u5f62\u3092\u3057\u305f\u5f0f\u3067 $ \\b{A^{-1}} $ \u306e\u9006\u884c\u5217\u306e\u5024\u304c\u65e2\u306b\u5206\u304b\u3063\u3066\u3044\u308b\u5834\u5408\u3001\u5de6\u306e\u5f0f\u3067\u306f\u306a\u304f\u53f3\u306e\u5f0f\u3067\u8a08\u7b97\u3092\u3059\u308b\u3068\u9006\u884c\u5217\u3092\u6c42\u3081\u308b\u3053\u3068\u306a\u304f\u76ee\u7684\u306e\u5024\u3092\u5f97\u308b\u3053\u3068\u304c\u3067\u304d\u308b\u3002\u306a\u305c\u306a\u3089\u3070\u3001\u9006\u884c\u5217\u306f\u30ac\u30a6\u30b9\u30b8\u30e7\u30eb\u30c0\u30f3\u306e\u6d88\u53bb\u6cd5\u3084LU\u5206\u89e3\u306a\u57fa\u672c\u7684\u306b $ O(n^3) $ \u3067\u91cd\u3044\u51e6\u7406\u306a\u306e\u3067\u306a\u308b\u3079\u304f\u8a08\u7b97\u3057\u305f\u304f\u306a\u3044\u304b\u3089\u3067\u3042\u308b\u3002\u307e\u305f\u6271\u3046\u30d1\u30e9\u30e1\u30fc\u30bf\u30fc\u304c\u591a\u3044\u5834\u5408\u305d\u3082\u305d\u3082\u6c42\u3081\u308b\u3053\u3068\u304c\u51fa\u6765\u306a\u3044\u3002\n\n\u3055\u3066\u3001\u4e0a\u8a18\u306e\u5f0f\u3092\u8a3c\u660e\u3059\u308b\u305f\u3081\u306b\u5929\u4e0b\u308a\u7684\u306b $ \\b{A} + \\b{u}\\b{v^t} $ \u3092\u639b\u3051\u3066\u6052\u7b49\u884c\u5217\u306b\u306a\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3057\u3066\u3082\u3088\u3044\u306e\u3060\u304c\u3001\u305d\u306e\u3088\u3046\u306a\u65b9\u6cd5\u3067\u306f\u5fc5\u8981\u306a\u6642\u306b\u81ea\u5206\u3067\u5c0e\u51fa\u3067\u304d\u306a\u3044\u306e\u3067\u56f0\u308b\u3002\n\n\u305d\u3053\u3067\u4ee5\u4e0b\u3067\u306f\u30ce\u30a4\u30de\u30f3\u7d1a\u6570\u3092\u7528\u3044\u305f\u65b9\u6cd5\u3068\u4ee3\u6570\u7684\u306a\u65b9\u7a0b\u5f0f\u306b\u5e30\u7740\u3055\u305b\u3066\u6c42\u3081\u308b\u65b9\u6cd5\u306e\u4e8c\u3064\u3092\u7d39\u4ecb\u3059\u308b\u3002\u81ea\u5206\u306e\u30aa\u30b9\u30b9\u30e1\u306f\uff08\u53b3\u5bc6\u6027\u306f\u591a\u5c11\u6b20\u3051\u308b\u3082\u306e\u306e\uff09\u30ce\u30a4\u30de\u30f3\u7d1a\u6570\u3092\u4f7f\u3063\u305f\u65b9\u6cd5\u3067\u3042\u308b\u3002\n\n\u3053\u306e\u65b9\u6cd5\u3055\u3048\u899a\u3048\u3066\u304a\u3051\u3070 woodbury \u306e\u516c\u5f0f\u306a\u3069\u9006\u95a2\u6570\u3067\u8868\u305b\u308c\u305f\u5f0f\u306e\u5909\u5f62\u304c\u81ea\u7531\u306b\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u308b\u3002\u305d\u306e\u4e0a\u3001\u672a\u77e5\u306e\u554f\u984c\u306b\u51fa\u4f1a\u3063\u305f\u6642\u3082\u5fdc\u7528\u304c\u304d\u304f\u304b\u3089\u3067\u3042\u308b\u3002\n\n##### \u30ce\u30a4\u30de\u30f3\u7d1a\u6570\u3092\u7528\u3044\u305f\u65b9\u6cd5\n\n\u30ce\u30a4\u30de\u30f3\u7d1a\u6570\u3068\u306f\u4ee5\u4e0b\u306e\u3053\u3068\u3067\n\n$$\n\\begin{eqnarray}\n(\\b{A} - \\b{I})^{-1} & = & \\b{I} + \\b{A} + \\b{A^{2}} + \\b{A^{3}} + ....\n\\end{eqnarray}\n$$\n\n$ |x| < 1 $ \u306b\u304a\u3044\u3066\u6210\u308a\u7acb\u3064\u7121\u9650\u7d1a\u6570\u3092\u884c\u5217\u3067\u8868\u3057\u305f\u3082\u306e\u3067\u3042\u308b\u3002\n\n$$\n\\begin{eqnarray}\n\\frac{1}{1-x} & = & 1 + x^2 + x^3 + ....\n\\end{eqnarray}\n$$\n\n\u30ce\u30a4\u30de\u30f3\u7d1a\u6570\u3082 $ |\\b{A}| < 1 $ \u304c\u6210\u308a\u7acb\u305f\u306a\u3051\u308c\u3070\u306a\u3089\u305a\u3001\u6210\u308a\u7acb\u305f\u306a\u3044\u5834\u5408\u306f**\u53f3\u8fba\u306e\u7121\u9650\u7d1a\u6570\u304c\u767a\u6563\u3059\u308b\u305f\u3081\u30ce\u30a4\u30de\u30f3\u7d1a\u6570\u306e\u7b49\u5f0f\u3092\u4f7f\u7528\u3057\u3066\u306f\u306a\u3089\u306a\u3044\u3002** \u306a\u306e\u3067\u3053\u306e\u7b49\u5f0f\u3092\u9014\u4e2d\u3067\u4f7f\u3046\u5834\u5408\u3001\u3053\u306e\u5236\u7d04\u3092\u6e80\u305f\u3057\u3066\u3044\u308b\u884c\u5217\u306b\u3057\u304b\u8a3c\u660e\u3057\u305f\u3053\u3068\u306b\u306a\u3089\u306a\u3044\u3053\u3068\u306f\u6ce8\u610f\u3059\u308b\u3079\u304d\u3067\u3042\u308b\u3002\n\n\u3055\u3066\u8a3c\u660e\u81ea\u4f53\u306f\u7c21\u5358\u3067\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u5f0f\u5909\u5f62\u3092\u884c\u3048\u3070\u3088\u3044\u3002\n\n$$\n\\begin{eqnarray}\n(\\b{A} + \\b{u} \\b{v^t} )^{-1} & = & \\\\{ \\b{A} (\\b{I} + \\b{A^{-1}  \\b{u} \\b{v^t}}) \\\\}^{-1} \\\\\\\n& = & (\\b{I} + \\b{A^{-1}}\\b{u}\\b{v^t}) \\b{A}^{-1} \\\\\\\n& = & (\\sum_{k=0}^{\\infty} (-\\b{A^{-1}}\\b{u}\\b{v^t})^k)\\b{A}^{-1} \\\\\\\n& = & (\\b{I} - \\b{A^{-1}} \\b{u} \\sum_{k=1}^{\\infty}(\\b{v^t A^{-1} u})^{k-1}\\b{v}) \\b{A}^{-1} \\\\\\\n& = & (\\b{I} - \\b{A^{-1}} \\b{u} ~ \\frac{\\b{v^t}}{1 + \\b{v^t A^{-1} u}}) \\b{A}^{-1} \\\\\\\n& = & \\b{A}^{-1} - \\frac{\\b{A^{-1} u v^t A^{-1}}}{1 + \\b{v^t A^{-1} u}}\n\\end{eqnarray}\n$$\n\n##### \u65b9\u7a0b\u5f0f\u3092\u7528\u3044\u305f\u65b9\u6cd5\n\u65b9\u7a0b\u5f0f\u3092\u7528\u3044\u305f\u65b9\u6cd5\u3067\u306f\u4ee5\u4e0b\u306e $ \\b{x} $ \u6c42\u3081\u308b\u904e\u7a0b\u3067\u76ee\u7684\u306e\u5f0f\u3092\u5f97\u308b\u3053\u3068\u304c\u3067\u304d\u308b\u3002\n\n$$\n\\begin{eqnarray}\n(\\b{A} + \\b{uv^t}) \\b{x} = \\b{b}\n\\end{eqnarray}\n$$\n\n\u4e21\u8fba\u306b $ \\b{v^t} $ \u3092\u639b\u3051\u3066 $ \\alpha = \\b{v^t x}$ \u3068\u304a\u304f\u3068\n\n$$\n\\begin{eqnarray}\n\\b{Ax} + \\b{u}\\b{v^tx} & = & \\b{b} \\\\\\\n\\b{Ax} + \\b{u}\\alpha & = & \\b{b} \\\\\\\n\\b{v^t x} & = & \\b{v^t} (\\b{A^{-1}b} - \\b{A^{-1} u \\alpha}) \\\\\\\n\\alpha & = & \\frac{\\b{v^t A^{-1} b}}{1+\\b{v^t A^{-1} u}}\n\\end{eqnarray}\n$$\n\n\u3053\u308c\u3088\u308a\u4e0a\u8a18\u306e $ \\alpha $ \u3092\u5143\u306e\u5f0f\u306b\u4ee3\u5165\u3059\u308b\u3068\u6c42\u3081\u305f\u3044\u5f0f\u304c\u5f97\u3089\u308c\u308b\u3002\n\n$$\n\\begin{eqnarray}\n\\b{x} & = & \\b{A^{-1}b} - \\b{A^{-1} u}\\alpha  \\\\\\\n\\b{x} & = & (\\b{A^{-1}} - \\frac{\\b{A^{-1} u v^t A^{-1}}}{1+\\b{v^t A^{-1} u}}) \\b{b}\n\\end{eqnarray}\n$$\n\n\u3053\u308c\u3088\u308a\u3001\u76f4\u63a5\u9006\u884c\u5217\u3092\u639b\u3051\u305f\u5834\u5408\u3068\u6bd4\u8f03\u3057\u3066\u4ee5\u4e0b\u304c\u6210\u308a\u7acb\u3064\u3053\u3068\u304c\u5206\u304b\u308b\u3002\n\n$$\n(\\b{A} + \\b{uv^t})^{-1} = \\b{A^{-1}} - \\frac{\\b{A^{-1} u v^t A^{-1}}}{1+\\b{v^t A^{-1} u}}\n$$\n\n\n\n##### Woodbury \u306e\u516c\u5f0f\n\u4eca\u56de\u306f\u4f7f\u308f\u306a\u3044\u304c\u4ee5\u4e0b\u306e\u3088\u3046\u306b Woodbury \u306e\u516c\u5f0f\u3082\u30ce\u30a4\u30de\u30f3\u7d1a\u6570\u3092\u7528\u3044\u305f\u65b9\u6cd5\u3067\u7c21\u5358\u306b\u5c0e\u51fa\u3067\u304d\u308b\u3002Woodbury \u306e\u516c\u5f0f\u306f\u4ee5\u4e0b\u306e\u901a\u308a\u3002\n\n$$\n\\begin{eqnarray}\n(\\b{A} + \\b{BCD})^{-1} = \\b{A}^{-1} - \\b{A^{-1} B} (\\b{C^{-1}} + \\b{D A^{-1} B})^{-1} \\b{D A^{-1}}\n\\end{eqnarray}\n$$\n\n\u3053\u306e\u516c\u5f0f\u306f \n\n- $ \\b{A} $ \u304c $ n \\times n $ \n- $ \\b{B} $ \u304c $ n \\times k $ \n- $ \\b{C} $ \u304c $ k \\times k $ \n- $ \\b{D} $ \u304c $ k \\times n $ \n\n\u306e\u6642\u306b $ k << n $ \u3067\u3042\u308b\u5834\u5408\u3067 $ \\b{A}^{-1}, \\b{C}^{-1} $ \u304c\u6c42\u3081\u3089\u308c\u3066\u3044\u308b\u6642\u3001\u5de6\u8fba\u3088\u308a\u53f3\u8fba\u3092\u8a08\u7b97\u3057\u305f\u65b9\u304c\u9065\u304b\u306b\u8a08\u7b97\u91cf\u304c\u5c0f\u3055\u304f\u306a\u308b\u305f\u3081\u3001\u305d\u306e\u3088\u3046\u306a\u5834\u9762\u3067\u4f7f\u308f\u308c\u308b\u3002\n\n\u3055\u3066\u3001Sherman\u2013Morrison \u306e\u30ce\u30a4\u30de\u30f3\u7d1a\u6570\u3067\u5c0e\u3044\u305f\u6642\u3068\u540c\u69d8\u306b\u3053\u306e\u5f0f\u3092\u8a3c\u660e\u3057\u3066\u307f\u3088\u3046\u3002\n\n$$\n\\begin{eqnarray}\n(\\b{A} + \\b{B C D})^{-1}  & = &  \\\\{ \\b{A} (\\b{I} + \\b{A^{-1} B C D}) \\\\}^{-1} \\\\\\\n& = & (\\b{I} + \\b{A^{-1} B C D})^{-1} \\b{A^{-1}} \\\\\\\n& = & (\\sum_{k=0}^{\\infty} (\\b{- A^{-1} B C D})^{k}) \\b{A^{-1}} \\\\\\\n& = & (\\b{I} - \\b{A^{-1} B} \\\\{ \\sum_{k=1}^{\\infty} (\\b{- C D A^{-1} B})^{k-1} \\\\} \\b{C D} ) ~ \\b{A^{-1}} \\\\\\\n& = & \\b{A^{-1}} - \\b{A^{-1} B}(\\b{I} + \\b{C D A^{-1} B})^{-1} \\b{C D A^{-1}} \\\\\\\n& = & \\b{A^{-1}} - \\b{A^{-1} B}(\\b{C^{-1}} + \\b{D A^{-1} B})^{-1} \\b{D A^{-1}}\n\\end{eqnarray}\n$$\n\n\u3068\u3053\u306e\u3088\u3046\u306b\u30ce\u30a4\u30de\u30f3\u7d1a\u6570\u3092\u7528\u3044\u308c\u3070\u6bd4\u8f03\u7684\u7c21\u5358\u306b\u5f0f\u3092\u5c0e\u304f\u3053\u3068\u304c\u51fa\u6765\u308b\u3002\n\n\n#### Appendix D: \u30d9\u30eb\u30cc\u30fc\u30a4\u6570\u306e\u6c42\u3081\u65b9\n\u30c7\u30a3\u30ac\u30f3\u30de\u95a2\u6570\u3084\u305d\u306e\u5fae\u5206\u306e\u6f38\u8fd1\u5c55\u958b\u306b\u306f\u30d9\u30eb\u30cc\u30fc\u30a4\u6570\u304c\u5fc5\u8981\u3067\u3042\u308b\u3002\u30d9\u30eb\u30cc\u30fc\u30a4\u6570\u3092\u6c42\u3081\u308b\u9589\u3058\u305f\u5f62\u306e\u6570\u5f0f\u306f\u5b58\u5728\u3057\u306a\u3044\u306e\u3067\u3001\u6f38\u5316\u5f0f\u3092\u5229\u7528\u3057\u3066\u518d\u5e30\u7684\u306b\u5024\u3092\u6c42\u3081\u308b\u3002\u30d9\u30eb\u30cc\u30fc\u30a4\u6570\u306e\u6bcd\u95a2\u6570\u306e\u5f62\u3092\u601d\u3044\u51fa\u3059\u3068\n\n$$\n\\begin{eqnarray}\n\\frac{x}{e^x-1} & = & \\sum_{n=0}^{\\infty} \\frac{B_n}{n!} x^n \\\\\\\n\\end{eqnarray}\n$$\n\n\u3088\u308a\u3001\u4e21\u8fba\u306b $ e^x - 1 $ \u3092\u639b\u3051\u308b\u3053\u3068\u3067\n\n$$\n\\begin{eqnarray}\nx & = & \\sum_{n=0}^{\\infty} \\frac{B_n}{n!} (e^x - 1) x^n \\\\\\\n& = & \\sum_{n=0}^{\\infty} \\sum_{k=0}^{\\infty} \\frac{B_n}{(k+1)! n!} x^{n + k + 1} \\\\\\\n& = & \\sum_{l=0}^{\\infty} \\sum_{n+k=l  \\substack n, k \\ge 0} \\frac{B_n}{(l - n + 1)!~n!} x^{l+1} \\\\\\\n& = & \\sum_{l=0}^{\\infty} (\\sum_{n=0}^{l} \\frac{1}{(l+1)!} \\dbinom{l+1}{n} ~ B_n) x^{l+1} \\\\\\\n\\end{eqnarray}\n$$\n\n\u4e21\u8fba\u306e\u4fc2\u6570\u3092\u6bd4\u8f03\u3059\u308b\u3053\u3068\u3067\u3001 $ B_0 = 1 $ \u304b\u3064 $ n \\ge 2 $ \u306b\u304a\u3044\u3066\n\n$$\n\\begin{eqnarray}\n\\sum_{n=0}^{l} \\dbinom{l+1}{n} B_n = 0 \\\\\\\nB_l = - \\frac{1}{l+1} \\sum_{n=0}^{l-1} \\dbinom{l+1}{n} B_n\n\\end{eqnarray}\n$$\n\n\u304c\u6210\u308a\u7acb\u3064\u3053\u3068\u304c\u5206\u304b\u308b\u3002\n\u518d\u5e30\u7684\u306b\u4e0a\u8a18\u306e\u5f0f\u3092\u8a08\u7b97\u3059\u308b\u3053\u3068\u3067\u3001\u4efb\u610f\u306e $ B_n $ \u306e\u5024\u304c\u5206\u304b\u308b\u3002\n\n\u53c2\u8003\u307e\u3067\u306b ruby \u3067\u66f8\u3044\u305f\u30b3\u30fc\u30c9\u306840\u307e\u3067\u306e\u30d9\u30eb\u30cc\u30fc\u30a4\u6570\u306e\u5177\u4f53\u7684\u306a\u5024\u3092\u8868\u3068\u3057\u3066\u6b8b\u3057\u3066\u304a\u304f\u3002\n\n\n```rb\ndef fac(n)\n  return 1 if n == 0\n  return (1..n).reduce(&:*)\nend\ndef comb(n, k) fac(n) / (fac(n - k) * fac(k)) end\ndef bernoulli_number(m)\n  @memo ||= {}\n  return @memo[m] if @memo[m]\n  return 1 if m == 0\n  return @memo[m] = (0..(m-1)).map {|n|\n    comb(m + 1, n) * bernoulli_number(n)\n  }.reduce(&:+) * Rational(-1, m + 1)\nend\n(0..100).each {|x| puts \"#{x}: #{bernoulli_number(x)}\"}\n```\n|index|value|\n|-----:|-----:|\n|0|1|\n|1|-1/2|\n|2|1/6|\n|3|0/1|\n|4|-1/30|\n|5|0/1|\n|6|1/42|\n|7|0/1|\n|8|-1/30|\n|9|0/1|\n|10|5/66|\n|11|0/1|\n|12|-691/2730|\n|13|0/1|\n|14|7/6|\n|15|0/1|\n|16|-3617/510|\n|17|0/1|\n|18|43867/798|\n|19|0/1|\n|20|-174611/330|\n|21|0/1|\n|22|854513/138|\n|23|0/1|\n|24|-236364091/2730|\n|25|0/1|\n|26|8553103/6|\n|27|0/1|\n|28|-23749461029/870|\n|29|0/1|\n|30|8615841276005/14322|\n|31|0/1|\n|32|-7709321041217/510|\n|33|0/1|\n|34|2577687858367/6|\n|35|0/1|\n|36|-26315271553053477373/1919190|\n|37|0/1|\n|38|2929993913841559/6|\n|39|0/1|\n|40|-261082718496449122051/13530|\n\n"}