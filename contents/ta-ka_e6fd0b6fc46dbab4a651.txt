{"context": "\n\n\u306f\u3058\u3081\u306b\npython\u3067SVM\uff08\u30b5\u30dd\u30fc\u30c8\u30d9\u30af\u30bf\u30fc\u30de\u30b7\u30f3\uff09\u3092\u5b9f\u88c5\u3057\u307e\u3057\u305f\uff0e\n\u6559\u79d1\u66f8\u3068\u3057\u3066\u300e\u306f\u3058\u3081\u3066\u306e\u30d1\u30bf\u30fc\u30f3\u8a8d\u8b58\u300f\u3092\u4f7f\u3044\u307e\u3057\u305f\uff0e\n\u672c\u8a18\u4e8b\u306e\u69cb\u6210\n\n\u306f\u3058\u3081\u306b\nSVM\n\n\n\u30de\u30fc\u30b8\u30f3\u6700\u5927\u5316\n\u4e3b\u554f\u984c\n\u30e9\u30b0\u30e9\u30f3\u30b8\u30e5\u672a\u5b9a\u4e57\u6570\u6cd5\nKKT\u6761\u4ef6\n\u53cc\u5bfe\u554f\u984c\n\n\n\u89e3\u306e\u6c42\u3081\u65b9\npython\u3067\u306e\u5b9f\u88c5\n\u7d50\u679c\n\u304a\u308f\u308a\u306b\n\u8ffd\u8a18\u60c5\u5831\n\n\nSVM\nSVM\u3068\u306f\uff0c\u6700\u5927\u30de\u30fc\u30b8\u30f3\u3092\u5b9f\u73fe\u3059\u308b2\u30af\u30e9\u30b9\u7dda\u5f62\u8b58\u5225\u5b66\u7fd2\u6cd5\u3067\u3059\uff0e\n\u6559\u79d1\u66f8\u306b\u3088\u308b\u3068\uff0c\u4ed6\u30af\u30e9\u30b9\u306e\u8b58\u5225\u306f $K-1$ \u500b\u306e\u4e00\u5bfe\u591aSVM\u3067\u5b9f\u73fe\u3059\u308b\u3053\u3068\u304c\u591a\u3044\u3088\u3046\u3067\u3059\uff0e\n\n\u30de\u30fc\u30b8\u30f3\u6700\u5927\u5316\n\u6b21\u306e\u3088\u3046\u306a\u30c7\u30fc\u30bf\u96c6\u5408\u3092\u8003\u3048\u307e\u3059\uff0e \u30c7\u30fc\u30bf\u306e\u7dcf\u6570\u3092 $N$ \u3068\u3059\u308b\u3068\uff0c$i = 1,...,N$\u3068\u306a\u308a\u307e\u3059\uff0e\n\\begin{align}\n& D_L = \\bigl\\{(t_i, {\\boldsymbol{x}}_i)\\bigr\\} \\\\\n& t_i = \\{-1, +1\\}\n\\end{align}\n\n\u7dda\u5f62\u8b58\u5225\u95a2\u6570\u306e\u30de\u30fc\u30b8\u30f3\u3092 $\\kappa$ \u3068\u3059\u308b\u3068\uff0c\u5168\u3066\u306e\u5b66\u7fd2\u30c7\u30fc\u30bf\u3067\u6b21\u5f0f\u304c\u6210\u308a\u7acb\u3061\u307e\u3059\uff0e\n|\\boldsymbol{w}^T{\\boldsymbol{x}}_i + b| \\geq \\kappa\n\n$\\kappa$ \u3067\u6b63\u898f\u5316\u3057\u305f\u3082\u306e\u3092 $\\boldsymbol{w}$\uff0c $b$ \u3068\u7f6e\u304d\u76f4\u3057\uff0c\u6559\u5e2b\u3068\u306e\u7a4d\u3092\u3068\u308b\u3053\u3068\u3067\u7d76\u5bfe\u5024\u3092\u306f\u305a\u3057\u307e\u3059\uff0e\nt_i(\\boldsymbol{w}^T{\\boldsymbol{x}}_i + b) \\geq 1 \\tag{1}\n\n\u56f3\u306e\u3088\u3046\u306b\u30af\u30e9\u30b9\u9593\u30de\u30fc\u30b8\u30f3\u306f\uff0c\u8b58\u5225\u8d85\u5e73\u9762\u306b\u6700\u3082\u8fd1\u3044\u30c7\u30fc\u30bf\u3092 $\\boldsymbol{w}$ \u65b9\u5411\u306b\u5c04\u5f71\u3057\u305f\u9577\u3055\u306e\u5dee\u3068\u3057\u3066\u6c42\u3081\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\uff0e\n\n$t_{i} = +1$ \u306e\u30af\u30e9\u30b9\u306e\u4e2d\u3067\u8b58\u5225\u8d85\u5e73\u9762\u306b\u6700\u3082\u8fd1\u3044\u30c7\u30fc\u30bf\u306f\uff0c$\\boldsymbol{w}$ \u65b9\u5411\u306b\u5c04\u5f71\u3057\u305f\u9577\u3055\u304c\u305d\u306e\u30af\u30e9\u30b9\u5185\u3067\u6700\u5c0f\u3068\u306a\u308a\uff0c\n$t_{i} = -1$ \u306e\u30af\u30e9\u30b9\u306e\u4e2d\u3067\u8b58\u5225\u8d85\u5e73\u9762\u306b\u6700\u3082\u8fd1\u3044\u30c7\u30fc\u30bf\u306f\uff0c$\\boldsymbol{w}$ \u65b9\u5411\u306b\u5c04\u5f71\u3057\u305f\u9577\u3055\u304c\u305d\u306e\u30af\u30e9\u30b9\u5185\u3067\u6700\u5927\u3068\u306a\u308a\u307e\u3059\uff0e\n\u30af\u30e9\u30b9\u9593\u30de\u30fc\u30b8\u30f3 $\\rho(\\boldsymbol{w}, b)$ \u306f\u6b21\u5f0f\u3067\u8868\u3055\u308c\u307e\u3059\uff0e\n\\begin{align}\n\\rho(\\boldsymbol{w}, b) &= \\min_{\\boldsymbol{x} \\in C_{y=+1}}\\frac{{\\boldsymbol{w}}^T\\boldsymbol{x}}{||\\boldsymbol{w}||} - \\max_{\\boldsymbol{x} \\in C_{y=-1}}\\frac{{\\boldsymbol{w}}^T\\boldsymbol{x}}{||\\boldsymbol{w}||} \\\\\n\\\\\n&= \\frac{1-b}{||\\boldsymbol{w}||} - \\frac{-1-b}{||\\boldsymbol{w}||} \\\\\n\\\\\n&= \\frac{2}{||\\boldsymbol{w}||} \\tag{2}\n\\end{align}\n\n\u5f0f(2)\u3088\u308a\uff0c$||\\boldsymbol{w}||$ \u3092\u6700\u5c0f\u5316\u3059\u308c\u3070\uff0c\u30af\u30e9\u30b9\u9593\u30de\u30fc\u30b8\u30f3\u306f\u6700\u5927\u5316\u3055\u308c\u308b\u3053\u3068\u304c\u5206\u304b\u308a\u307e\u3059\uff0e\n\u307e\u305f\uff0c\u30af\u30e9\u30b9\u9593\u30de\u30fc\u30b8\u30f3\u306f\u8b58\u5225\u8d85\u5e73\u9762\u306b\u6700\u3082\u8fd1\u3044\u30c7\u30fc\u30bf\u3060\u3051\u3067\u6c7a\u307e\u308a\u307e\u3059\uff0e\u3053\u306e\u8b58\u5225\u8d85\u5e73\u9762\u306b\u6700\u3082\u8fd1\u3044\u30c7\u30fc\u30bf\u306e\u3053\u3068\u3092\u30b5\u30dd\u30fc\u30c8\u30d9\u30af\u30bf\u30fc\u3068\u547c\u3073\u307e\u3059\uff0e\n\n\u4e3b\u554f\u984c\n\u5f0f(1)\u306e\u5236\u7d04\u6761\u4ef6\u306e\u3082\u3068\uff0c\u5f0f(2)\u306b\u8868\u3055\u308c\u308b\u30af\u30e9\u30b9\u9593\u30de\u30fc\u30b8\u30f3\u3092\u6700\u5927\u5316\u3059\u308b\u3053\u3068\u3092\u8003\u3048\u307e\u3059\uff0e\u3053\u308c\u3092\u4e3b\u554f\u984c\u3068\u3057\u307e\u3059\uff0e\n\u8a55\u4fa1\u95a2\u6570\uff08\u6700\u5c0f\u5316\uff09\nL_p(\\boldsymbol{w}) = \\frac{1}{2}{\\boldsymbol{w}}^{T}\\boldsymbol{w}\n\n\u4e0d\u7b49\u5f0f\u5236\u7d04\u6761\u4ef6\nt_i(\\boldsymbol{w}^T{\\boldsymbol{x}}_i + b) - 1 \\geq 0\n\n\n\u30e9\u30b0\u30e9\u30f3\u30b8\u30e5\u672a\u5b9a\u4e57\u6570\u6cd5\n\u4e3b\u554f\u984c\u3092\u89e3\u304f\u305f\u3081\u306b\u30e9\u30b0\u30e9\u30f3\u30b8\u30e5\u672a\u5b9a\u4e57\u6570\u6cd5\u3092\u4f7f\u3044\u307e\u3059\uff0e\n\n\u30e9\u30b0\u30e9\u30f3\u30b8\u30e5\u306e\u672a\u5b9a\u4e57\u6570\u6cd5\uff08\u30e9\u30b0\u30e9\u30f3\u30b8\u30e5\u306e\u307f\u3066\u3044\u3058\u3087\u3046\u3059\u3046\u307b\u3046\u3001\u82f1: method of Lagrange multiplier\uff09\u3068\u306f\u3001\u675f\u7e1b\u6761\u4ef6\u306e\u3082\u3068\u3067\u6700\u9069\u5316\u3092\u884c\u3046\u305f\u3081\u306e\u6570\u5b66\uff08\u89e3\u6790\u5b66\uff09\u7684\u306a\u65b9\u6cd5\u3067\u3042\u308b\u3002\u3044\u304f\u3064\u304b\u306e\u5909\u6570\u306b\u5bfe\u3057\u3066\u3001\u3044\u304f\u3064\u304b\u306e\u95a2\u6570\u306e\u5024\u3092\u56fa\u5b9a\u3059\u308b\u3068\u3044\u3046\u675f\u7e1b\u6761\u4ef6\u306e\u3082\u3068\u3067\u3001\u5225\u306e\u3042\u308b1\u3064\u306e\u95a2\u6570\u306e\u6975\u5024\u3092\u6c42\u3081\u308b\u3068\u3044\u3046\u554f\u984c\u3092\u8003\u3048\u308b\u3002\u5404\u675f\u7e1b\u6761\u4ef6\u306b\u5bfe\u3057\u3066\u5b9a\u6570\uff08\u672a\u5b9a\u4e57\u6570\u3001Lagrange multiplier\uff09\u3092\u7528\u610f\u3057\u3001\u3053\u308c\u3089\u3092\u4fc2\u6570\u3068\u3059\u308b\u7dda\u5f62\u7d50\u5408\u3092\u65b0\u3057\u3044\u95a2\u6570\uff08\u672a\u5b9a\u4e57\u6570\u3082\u65b0\u305f\u306a\u5909\u6570\u3068\u3059\u308b\uff09\u3068\u3057\u3066\u8003\u3048\u308b\u3053\u3068\u3067\u3001\u675f\u7e1b\u554f\u984c\u3092\u666e\u901a\u306e\u6975\u5024\u554f\u984c\u3068\u3057\u3066\u89e3\u304f\u3053\u3068\u304c\u3067\u304d\u308b\u65b9\u6cd5\u3067\u3042\u308b\u3002\nwikipedia\u3088\u308a\u5f15\u7528\n\n\n\u5177\u4f53\u4f8b\n\u4f55\u3092\u8a00\u3063\u3066\u3044\u308b\u304b\u3055\u3063\u3071\u308a\u5206\u304b\u3089\u306a\u3044\u306e\u3067\uff0c\u5177\u4f53\u4f8b\u3092\u6319\u3052\u3066\u8aac\u660e\u3057\u307e\u3059\uff0e\n$g(x, y) = x^2 + y^2 - 2 = 0$ \u306e\u6761\u4ef6\u4e0b\u3067 $f(x, y) = y - x$ \u306e\u6700\u5927\u5316\u3092\u8003\u3048\u307e\u3059\uff0e\n\u3053\u308c\u306f\u534a\u5f84 $\\sqrt{2}$ \u306e\u5186\u5468\u4e0a\u306e $(x, y)$ \u3092\u4f7f\u3063\u3066\uff0c\u76f4\u7dda\u306e\u5207\u7247\u3092\u6700\u5927\u5316\u3059\u308b\u3068\u3044\u3046\u554f\u984c\u306b\u306a\u308a\u307e\u3059\uff0e\n\n\u56f3\u304b\u3089\uff0c\u5186\u3068\u76f4\u7dda\u304c\u63a5\u3059\u308b\u3068\u304d $f(x, y)$ \u304c\u5236\u7d04\u6761\u4ef6\u306e\u3082\u3068\u6700\u5927\u5024 $2$ \u3092\u53d6\u308b\u3053\u3068\u304c\u5206\u304b\u308a\u307e\u3059\uff0e\n\u3053\u308c\u3092\u30e9\u30b0\u30e9\u30f3\u30b8\u30e5\u672a\u5b9a\u4e57\u6570\u6cd5\u3092\u4f7f\u3063\u3066\u89e3\u3044\u3066\u307f\u307e\u3057\u3087\u3046\uff0e\n\\begin{align}\nL(x, y, \\lambda) &= f(x, y) + \\lambda g(x, y) \\\\\n\\\\\n&= y - x + \\lambda(x^2 + y^2 - 2) \\tag{3}\n\\end{align}\n\n\u5f0f(3)\u306e\u30e9\u30b0\u30e9\u30f3\u30b8\u30e5\u95a2\u6570\u3092 $x, y, \\lambda$ \u3067\u504f\u5fae\u5206\u3057\uff0c\u305d\u308c\u305e\u308c\u30a4\u30b3\u30fc\u30eb $0$ \u3068\u3057\u307e\u3059\uff0e\n\\begin{align}\n& \\frac{\\partial L}{\\partial x} = -1 + 2\\lambda x = 0 \\\\\n& \\frac{\\partial L}{\\partial y} = 1 + 2\\lambda y = 0 \\\\\n& \\frac{\\partial L}{\\partial \\lambda} = x^2 + y^2 - 2 = 0\n\\end{align}\n\n1\uff0c2\u756a\u76ee\u306e\u5f0f\u30923\u756a\u76ee\u306e\u5f0f\u306b\u4ee3\u5165\u3057\u307e\u3059\uff0e\n\\begin{align}\n& \\Bigl(\\frac{1}{2\\lambda}\\Bigr)^2 + \\Bigl(-\\frac{1}{2\\lambda}\\Bigr)^2 - 2 = 0 \\\\\n\\\\\n& \\lambda = \\pm \\frac{1}{2}, x = \\pm 1, y = \\mp 1\n\\end{align}\n\n\u3088\u3063\u3066\uff0c$g(x, y) = 0$ \u306e\u5236\u7d04\u6761\u4ef6\u4e0b\u3067 $f(x, y) = y - x$ \u306f\u6700\u5927\u5024 $2$ \u3092\u53d6\u308a\u307e\u3059\uff0e\n\u3053\u306e\u6700\u5927\u5024\u306b\u3064\u3044\u30663\u6b21\u5143\u3067\u8003\u3048\u3066\u307f\u307e\u3059\uff0e3\u6b21\u5143\u7a7a\u9593\u3067\u306f\uff0c$z = f(x, y) = y - x$ \u306f\u659c\u9762\u306b\uff0c$g(x, y) = x^2 + y^2 - 1 = 0$ \u306f\u5186\u67f1\u306b\u306a\u308a\u307e\u3059\uff0e\n$g(x, y) = 0$ \u306e\u5236\u7d04\u6761\u4ef6\u4e0b\u3067 $z = y - x$ \u306e\u6700\u5927\u5024\u3092\u6c42\u3081\u305f\u3044\u306e\u3067\uff0c\u659c\u9762\u3068\u5186\u67f1\u304c\u4ea4\u308f\u308b\u9762\u306b\u95a2\u3057\u3066\uff0c$z$ \u5ea7\u6a19\u306e\u6700\u5927\u5024\u3092\u898b\u3064\u3051\u308c\u3070\u826f\u3044\u3053\u3068\u3068\u306a\u308a\u307e\u3059\uff0e\n\u3064\u307e\u308a\uff0c$x^2 + y^2 - 2 = 0$ \u306e\u5186\u3092 $z = y - x$ \u5e73\u9762\u306b\u5c04\u5f71\u3057\u305f\u3068\u304d\u306e $z$ \u8ef8\u65b9\u5411\u306e\u6700\u5927\u5024\u304c\u6c42\u3081\u305f\u3044\u5024\u3067\u3059\uff0e\n\u3053\u308c\u3092\u56f3\u3067\u8868\u3057\u307e\u3059\uff0e\u771f\u6a2a\u304b\u3089\u898b\u305f\u3068\u304d\uff0c\u659c\u9762\u3068\u5186\u67f1\u304c\u4ea4\u308f\u3063\u3066\u3044\u308b\u90e8\u5206\u306e\u4e2d\u3067\uff0c$z$ \u8ef8\u65b9\u5411\u306e\u6700\u5927\u5024\u306f $2$ \u3067\u3042\u308b\u3053\u3068\u304c\u5206\u304b\u308a\uff0c\u3053\u308c\u306f\u8a08\u7b97\u7d50\u679c\u3068\u4e00\u81f4\u3057\u307e\u3059\uff0e\n\n\n\u89e3\u8aac\n\u306a\u305c\u30e9\u30b0\u30e9\u30f3\u30b8\u30e5\u672a\u5b9a\u4e57\u6570\u6cd5\u3067\uff0c\u6700\u5c0f\u5024\u3092\u6c42\u3081\u3089\u308c\u308b\u306e\u304b\u89e3\u8aac\u3057\u3066\u307f\u307e\u3059\uff0e\uff08\u8aa4\u308a\u3092\u542b\u3080\u304b\u3082\u3057\u308c\u307e\u305b\u3093\uff09\n\u5236\u7d04\u6761\u4ef6 $g(\\boldsymbol{x}) = 0$\uff08\u4ee5\u4e0b\uff0c\u5236\u7d04\u9762\u3068\u3059\u308b\uff09\u306e\u3082\u3068\uff0c\u8a55\u4fa1\u95a2\u6570 $f(\\boldsymbol{x})$ \u304c $\\boldsymbol{x}^\\star$ \u306b\u304a\u3044\u3066\u6700\u5927\u5024\u3092\u3068\u308b\u3068\u304d\uff0c$\\boldsymbol{\\nabla}f(\\boldsymbol{x})$ \u306f\u5236\u7d04\u9762\u306b\u5bfe\u3057\u3066\u5782\u76f4\u3067\u306a\u3051\u308c\u3070\u306a\u308a\u307e\u305b\u3093\uff0e\n\u306a\u305c\u306a\u3089\uff0c\u5782\u76f4\u3067\u306a\u3044\u3068\u4eee\u5b9a\u3059\u308b\u3068\uff0c\u5236\u7d04\u9762\u306e\u65b9\u5411\u306b\u6cbf\u3063\u3066 $f(\\boldsymbol{x})$ \u3092\u3055\u3089\u306b\u5927\u304d\u304f\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u308b\u304b\u3089\u3067\u3059\uff0e\u307e\u305f\uff0c$\\boldsymbol{\\nabla}g(\\boldsymbol{x})$ \u3082\u5236\u7d04\u9762\u306b\u5bfe\u3057\u3066\u5782\u76f4\u306b\u306a\u308a\u307e\u3059\uff0e\n\u3088\u3063\u3066 $\\boldsymbol{x}^\\star$ \u306b\u304a\u3044\u3066 $\\boldsymbol{\\nabla}f, \\boldsymbol{\\nabla}g$ \u306f\u5e73\u884c\u306a\u30d9\u30af\u30c8\u30eb\u3068\u306a\u308a\uff0c\u6b21\u5f0f\u304c\u6210\u308a\u7acb\u3061\u307e\u3059\uff0e\n\\boldsymbol{\\nabla}f + \\lambda\\boldsymbol{\\nabla}g = 0 \\tag{4}\n\n\u3053\u3053\u3067\uff0c\u30e9\u30b0\u30e9\u30f3\u30b8\u30e5\u95a2\u6570\u3092\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u5b9a\u7fa9\u3057\u307e\u3059\uff0e\nL(\\boldsymbol{x}, \\lambda) \\equiv f(\\boldsymbol{x}) + \\lambda g(\\boldsymbol{x})\n\n\u30e9\u30b0\u30e9\u30f3\u30b8\u30e5\u95a2\u6570 $L(\\boldsymbol{x}, \\lambda)$ \u3092 $\\boldsymbol{x}, \\lambda$ \u3067\u504f\u5fae\u5206\u3059\u308b\u3053\u3068\u3067\u5f0f(4)\u304a\u3088\u3073\u5236\u7d04\u6761\u4ef6\u3092\u5c0e\u304f\u3053\u3068\u304c\u3067\u304d\u307e\u3059\uff0e\n\u3053\u308c\u3092\u89e3\u304f\u3053\u3068\u3067\u505c\u7559\u70b9 $\\boldsymbol{x}^\\star$ \u304c\u5f97\u3089\u308c\u307e\u3059\uff0e\u3053\u306e $\\boldsymbol{x}^\\star$ \u306e\u4e2d\u306b\uff0c$f(\\boldsymbol{x})$ \u3092\u6700\u5927\u5316\u3059\u308b $\\boldsymbol{x}$ \u304c\u5b58\u5728\u3057\u307e\u3059\uff0e\n\nKKT\u6761\u4ef6\n\u3067\u306f\uff0c\u3053\u306e\u30e9\u30b0\u30e9\u30f3\u30b8\u30e5\u306e\u672a\u5b9a\u4e57\u6570\u6cd5\u3092\u4e3b\u554f\u984c\u306b\u9069\u7528\u3057\u307e\u3059\uff0e\n\u30e9\u30b0\u30e9\u30f3\u30b8\u30e5\u95a2\u6570\u3092\u6b21\u5f0f\u306e\u3088\u3046\u306b\u5b9a\u7fa9\u3057\u307e\u3059\uff0e\n\\tilde{L}_{p}(\\boldsymbol{w}, b, \\boldsymbol{\\alpha}) = \\frac{1}{2}{\\boldsymbol{w}}^T\\boldsymbol{w} - \\sum_{i=1}^{N}\\alpha_i(t_i(\\boldsymbol{w}^T{\\boldsymbol{x}}_i + b) - 1) \\tag{5}\n\n\u3053\u3053\u3067\uff0c$\\boldsymbol{\\alpha} = {(\\alpha_1, ..., \\alpha_N)}^T (\\alpha_i \\geq 0)$ \u3067\u3042\u308a\uff0c$\\alpha_i$ \u304c\u30e9\u30b0\u30e9\u30f3\u30b8\u30e5\u672a\u5b9a\u4e57\u6570\u3067\u3059\uff0e\n\u3053\u306e\u6700\u9069\u5316\u554f\u984c\u306e\u89e3 $\\boldsymbol{w}_0, b_0$ \u306f\uff0c\u4ee5\u4e0b\u306eKKT\u6761\u4ef6\u3092\u6e80\u305f\u3059\u89e3\u3068\u3057\u3066\u5f97\u3089\u308c\u307e\u3059\uff0e\n< KKT\u6761\u4ef6 >\n\\begin{align}\n& \\left.\\frac{\\partial \\tilde{L}_p(\\boldsymbol{w}, b, \\boldsymbol{\\alpha})}{\\partial \\boldsymbol{w}}\\right|_{\\boldsymbol{w} = \\boldsymbol{w}_0} = \\boldsymbol{w}_0 - \\sum_{i=1}^{N}\\alpha_{i}t_i{\\boldsymbol{x}}_i = 0 \\tag{6} \\\\\n& \\frac{\\partial \\tilde{L}_p(\\boldsymbol{w}, b, \\boldsymbol{\\alpha})}{\\partial b} = \\sum_{i=1}^{N}\\alpha_{i}t_i = 0 \\tag{7} \\\\\n& \\\\\n& t_i(\\boldsymbol{w}^T{\\boldsymbol{x}}_i + b) - 1 \\geq 0 \\tag{8} \\\\\n& \\\\\n& \\alpha_i \\geq 0 \\tag{9} \\\\\n& \\\\\n& \\alpha_i(t_i(\\boldsymbol{w}^T{\\boldsymbol{x}}_i + b) - 1) = 0 \\tag{10}\n\\end{align}\n\n\u5f0f(6),(7)\u306f\u30e9\u30b0\u30e9\u30f3\u30b8\u30e5\u95a2\u6570\u306e\u504f\u5fae\u5206\u30a4\u30b3\u30fc\u30eb $0$\uff0c\u5f0f(8)\u306f\u4e3b\u554f\u984c\u306e\u5236\u7d04\u6761\u4ef6\uff0c\u5f0f(10)\u306f\u76f8\u88dc\u6027\u6761\u4ef6\u3067\u3059\uff0e\n\u5f0f(10)\u306e\u76f8\u88dc\u6027\u6761\u4ef6\u3088\u308a\nt_i(\\boldsymbol{w}^T\\boldsymbol{x}_i + b) - 1 > 0 \\Rightarrow \\alpha_i = 0 \\\\\nt_i(\\boldsymbol{w}^T\\boldsymbol{x}_i + b) - 1 = 0 \\Rightarrow \\alpha_i \\geq 0\n\n\u76f8\u88dc\u6027\u6761\u4ef6\u306f\uff0c\u30b5\u30dd\u30fc\u30c8\u30d9\u30af\u30bf\u30fc\u4ee5\u5916\u306e\u30c7\u30fc\u30bf\u306b\u3088\u308b\u5236\u7d04\u6761\u4ef6\u306e\u52b9\u679c\u306f\u306a\u304f\u3001\u30b5\u30dd\u30fc\u30c8\u30d9\u30af\u30bf\u30fc\u3060\u3051\u3067\u8b58\u5225\u8d85\u5e73\u9762\u304c\u6c7a\u5b9a\u3055\u308c\u308b\u3053\u3068\u3092\u793a\u3057\u3066\u3044\u307e\u3059\uff0e\n\uff08\u8abf\u3079\u3066\u307f\u308b\u3068KKT\u6761\u4ef6\u306f\u304b\u306a\u308a\u5965\u304c\u6df1\u305d\u3046\u306a\u306e\u3067\uff0c\u3053\u308c\u304f\u3089\u3044\u306e\u3075\u3093\u308f\u308a\u3068\u3057\u305f\u7406\u89e3\u3067\u6b21\u306b\u9032\u3080\u3053\u3068\u306b\u3057\u307e\u3059\uff09\n\n\u53cc\u5bfe\u554f\u984c\n\u5f0f(5)\u3092\u5c55\u958b\u3057\uff0c\u6700\u9069\u89e3\u304a\u3088\u3073\u5f0f(6),(7)\u3092\u4ee3\u5165\u3057\u307e\u3059\uff0e\n\\begin{align}\nL_{d}(\\boldsymbol{\\alpha}) &= \\frac{1}{2}{\\boldsymbol{w}_{0}}^{T}\\boldsymbol{w}_{0} - \\sum_{i=1}^{N}\\alpha_{i}t_{i}{\\boldsymbol{w}_{0}}^{T}{\\boldsymbol{x}}_{i} - b\\sum_{i=1}^{N}\\alpha_{i}t_{i} + \\sum_{i=1}^{N}\\alpha_{i} \\\\\n&= \\frac{1}{2}{\\boldsymbol{w}_{0}}^{T}\\boldsymbol{w}_{0} - {\\boldsymbol{w}_{0}}^{T}\\boldsymbol{w}_{0} - 0 + \\sum_{i=1}^{N}\\alpha_{i} \\\\\n&= \\sum_{i=1}^{N}\\alpha_{i} - \\frac{1}{2}{\\boldsymbol{w}_{0}}^{T}\\boldsymbol{w}_{0} \\\\\n&= \\sum_{i=1}^{N}\\alpha_{i} - \\frac{1}{2}\\sum_{i=1}^{N}\\sum_{j=1}^{N}\\alpha_{i}\\alpha_{j}t_{i}t_{j}{\\boldsymbol{x}_i}^T{\\boldsymbol{x}}_j\n\\end{align}\n\n\u5f0f(6)\u3088\u308a\uff0c\u6700\u9069\u89e3\u304c\u30e9\u30b0\u30e9\u30f3\u30b8\u30e5\u672a\u5b9a\u4e57\u6570\u3068\u5b66\u7fd2\u30c7\u30fc\u30bf\u306e\u7dda\u5f62\u548c\u3067\u8868\u3055\u308c\u308b\u3053\u3068\u304b\u3089\uff0c$\\alpha_{i}$ \u3092\u6c42\u3081\u308b\u554f\u984c\u306b\u7f6e\u304d\u63db\u3048\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\uff0e\n\u6700\u9069\u306a\u30e9\u30b0\u30e9\u30f3\u30b8\u30e5\u672a\u5b9a\u4e57\u6570\u306f\uff0c$L_{d}(\\boldsymbol{\\alpha})$ \u3092\u6700\u5927\u306b\u3059\u308b $\\boldsymbol{\\alpha}$ \u306b\u3088\u308a\u5f97\u3089\u308c\u307e\u3059\uff0e\u3053\u308c\u3092\u4e3b\u554f\u984c\u306b\u5bfe\u3059\u308b\u53cc\u5bfe\u554f\u984c\u3068\u547c\u3073\u307e\u3059\uff0e\n$N$ \u500b\u306e $1$ \u3092\u4e26\u3079\u305f\u30d9\u30af\u30c8\u30eb\u3092 $\\boldsymbol{1}$\uff0c\u5b66\u7fd2\u30c7\u30fc\u30bf\u3067\u4f5c\u3089\u308c\u305f\u884c\u5217\u3092 $\\boldsymbol{H}$\uff0c\u6559\u5e2b\u30c7\u30fc\u30bf\u30d9\u30af\u30c8\u30eb\u3092 $\\boldsymbol{t}$ \u3068\u3057\u307e\u3059\uff0e\n\\begin{align}\n& \\boldsymbol{1} = (1,...,1)^T \\\\\n\\\\\n& \\boldsymbol{H} = (H_{ij} = {t_it_j\\boldsymbol{x}_i}^T\\boldsymbol{x}_j) \\\\\n\\\\\n& \\boldsymbol{t} = (t_1,...,t_N)^T\n\\end{align}\n\n\u8a55\u4fa1\u95a2\u6570\uff08\u6700\u5927\u5316\uff09\nL_{d}(\\boldsymbol{\\alpha}) = \\boldsymbol{\\alpha}^T\\boldsymbol{1} - \\frac{1}{2}\\boldsymbol{\\alpha}^T\\boldsymbol{H}\\boldsymbol{\\alpha}\n\n\u7b49\u5f0f\u5236\u7d04\u6761\u4ef6\n\\boldsymbol{\\alpha}^T\\boldsymbol{t} = 0\n\n\u53cc\u5bfe\u554f\u984c\u3092\u89e3\u3044\u3066\u5f97\u3089\u308c\u305f\u30e9\u30f3\u30b0\u30e9\u30f3\u30b8\u30e5\u672a\u5b9a\u4e57\u6570\u306e\u6700\u9069\u89e3\u3092 $\\tilde{\\boldsymbol{\\alpha}} = (\\tilde{\\alpha}_1,...,\\tilde{\\alpha}_N)^T$ \u3068\u3059\u308b\u3068\uff0c\u6700\u9069\u89e3\u306f\u6b21\u306e\u3088\u3046\u306b\u6c42\u3081\u3089\u308c\u307e\u3059\uff0e\n\\begin{align}\n& \\boldsymbol{w}_0 = \\sum_{i=1}^{N}\\tilde{\\alpha}_{i}t_i{\\boldsymbol{x}}_i \\\\\n& b_0 = \\frac{1}{t_s} - {\\boldsymbol{w}_0}^T\\boldsymbol{x}_s\n\\end{align}\n\n$\\boldsymbol{x}_s, t_s$ \u306f\u30b5\u30dd\u30fc\u30c8\u30d9\u30af\u30bf\u30fc\u306e\u30c7\u30fc\u30bf\u304a\u3088\u3073\u6559\u5e2b\u3092\u8868\u3057\u307e\u3059\uff0e\n\n\u89e3\u306e\u6c42\u3081\u65b9\n\u4e3b\u554f\u984c\u3092\u53cc\u5bfe\u554f\u984c\u306b\u7f6e\u304d\u63db\u3048\uff0c\u6700\u9069\u306a $\\tilde{\\boldsymbol{\\alpha}}$ \u3092\u6c42\u3081\u308c\u3070\uff0c\u30de\u30fc\u30b8\u30f3\u6700\u5927\u5316\u306f\u5b9f\u73fe\u3067\u304d\u308b\u3053\u3068\u3092\u5c0e\u304d\u307e\u3057\u305f\uff0e\n$L_{d}(\\boldsymbol{\\alpha})$ \u3092\u6700\u5927\u306b\u3059\u308b $\\boldsymbol{\\alpha}$ \u3092\u30d7\u30ed\u30b0\u30e9\u30e0\u3067\u6c42\u3081\u308b\u305f\u3081\u306b\u6700\u6025\u964d\u4e0b\u6cd5\u3092\u4f7f\u3044\u307e\u3059\uff0e\n\u53cc\u5bfe\u554f\u984c\u306e\u5236\u7d04\u6761\u4ef6\u3092\u6e80\u305f\u3059\u3088\u3046\u7f70\u91d1\u9805\u3092\u52a0\u3048\uff0c\u4ee5\u4e0b\u306e\u3088\u3046\u306b $L_{d}(\\boldsymbol{\\alpha})$ \u3092\u518d\u5b9a\u7fa9\u3057\u307e\u3057\u305f\uff0e\nL_{d}(\\boldsymbol{\\alpha}) = \\boldsymbol{\\alpha}^T\\boldsymbol{1} - \\frac{1}{2}\\boldsymbol{\\alpha}^T\\boldsymbol{H}\\boldsymbol{\\alpha} - \\frac{1}{2}\\beta\\boldsymbol{\\alpha}^T\\boldsymbol{t}\\boldsymbol{t}^T\\boldsymbol{\\alpha}\n\n\u3067\u306f\uff0c\u5b9f\u969b\u306b\u6700\u6025\u964d\u4e0b\u6cd5\u3067 $\\alpha_i$ \u3092\u66f4\u65b0\u3057\u307e\u3059\uff0e\n\\begin{align}\n{\\alpha_i}' &= {\\alpha_i} + \\eta\\frac{L_{d}(\\boldsymbol{\\alpha})}{\\alpha_i}\u3000\\\\\n&= {\\alpha_i} + \\eta(1 - \\sum_{j=1}^{N}\\alpha_{j}t_{i}t_{j}{\\boldsymbol{x}_i}^T{\\boldsymbol{x}}_j - \\beta\\sum_{j=1}^{N}\\alpha_{j}t_{i}t_j)\n\\end{align}\n\n\u3053\u3053\u307e\u3067\u96e3\u3057\u3044\u8a08\u7b97\u3092\u3057\u3066\u304d\u307e\u3057\u305f\u304c\uff0c\u6700\u7d42\u7684\u306b\u5f97\u3089\u308c\u308b\u6570\u5f0f\u306f\u7f8e\u3057\u3044\u3067\u3059\u306d\uff0e\n\u3053\u308c\u3067 $L_{d}(\\boldsymbol{\\alpha})$ \u3092\u6700\u5927\u306b\u3059\u308b $\\boldsymbol{\\alpha}$ \u306f\u5f97\u3089\u308c\u307e\u3059\uff0e\n\npython\u3067\u306e\u5b9f\u88c5\n\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u5b9f\u88c5\u3057\u307e\u3057\u305f\uff0e\n$\\alpha_i$ \u306e\u66f4\u65b0\u304c\u7c21\u5358\u306b\u3067\u304d\u307e\u3059\uff0e\u307e\u305f\uff0c\u7f70\u91d1\u9805\u306e\u52b9\u679c\u3067\uff0c$\\boldsymbol{\\alpha}^T\\boldsymbol{t} = 0$ \u306e\u6761\u4ef6\u3092\u6e80\u305f\u3059\u3088\u3046\u306b\u66f4\u65b0\u304c\u884c\u308f\u308c\u307e\u3059\uff0e\n\nsvm.py\nimport numpy\nfrom matplotlib import pyplot\nimport sys\n\ndef f(x, y):\n    return x - y\n\nif __name__ == '__main__':\n\n    param = sys.argv\n\n    numpy.random.seed()\n    N = 30\n    d = 2\n    X = numpy.random.randn(N, d)\n    T = numpy.array([1 if f(x, y) > 0 else - 1 for x, y in X])\n    alpha = numpy.zeros(N)\n    beta = 1.0\n    eta_al = 0.0001 # update ratio of alpha\n    eta_be = 0.1 # update ratio of beta\n    itr = 1000\n\n    for _itr in range(itr):\n        for i in range(N):\n            delta = 1 - (T[i] * X[i]).dot(alpha * T * X.T).sum() - beta * T[i] * alpha.dot(T)\n            alpha[i] += eta_al * delta\n        for i in range(N):\n            beta += eta_be * alpha.dot(T) ** 2 / 2\n\n    index = alpha > 0\n    w = (alpha * T).T.dot(X)\n    b = (T[index] - X[index].dot(w)).mean()\n\n    if '-d' in param or '-s' in param:\n        seq = numpy.arange(-3, 3, 0.02)\n        pyplot.figure(figsize = (6, 6))\n        pyplot.xlim(-3, 3)\n        pyplot.ylim(-3, 3)\n        pyplot.plot(seq, -(w[0] * seq + b) / w[1], 'k-')\n        pyplot.plot(X[T ==  1,0], X[T ==  1,1], 'ro')\n        pyplot.plot(X[T == -1,0], X[T == -1,1], 'bo')\n\n        if '-s' in param:\n            pyplot.savefig('graph.png')\n\n        if '-d' in param:\n            pyplot.show()\n\n\n\n\u7d50\u679c\n\u4e0b\u306e\u56f3\u306e\u3088\u3046\u306a\u7d50\u679c\u304c\u5f97\u3089\u308c\u307e\u3057\u305f\uff0e\u30c7\u30fc\u30bf\u70b9\u306e\u8272\u304c\u30af\u30e9\u30b9\u3092\u8868\u3057\u3066\u3044\u307e\u3059\uff0e\n\u8a08\u7b97\u306b\u3088\u308a\u6c42\u3081\u3089\u308c\u305f\u76f4\u7dda\u3092\u4e00\u7dd2\u306b\u63cf\u753b\u3057\u305f\u3068\u3053\u308d\uff0c\u305d\u308c\u3063\u307d\u3044\u7d50\u679c\u306f\u5f97\u3089\u308c\u307e\u3057\u305f\uff0e\n\n\n\u304a\u308f\u308a\u306b\n\u4e0d\u7b49\u5f0f\u6761\u4ef6\u4e0b\u3067\u30de\u30fc\u30b8\u30f3\u6700\u5927\u5316\u3092\u76ee\u7684\u3068\u3057\u305f\u4e3b\u554f\u984c\u3092\u8a2d\u5b9a\u3057\uff0c\u3053\u308c\u3092\u30e9\u30b0\u30e9\u30f3\u30b8\u30e5\u672a\u5b9a\u4e57\u6570\u6cd5\u3092\u4f7f\u3046\u3053\u3068\u3067\u53cc\u5bfe\u554f\u984c\u3078\u7f6e\u304d\u63db\u3048\uff0c\u6700\u9069\u306a $\\boldsymbol{w}_0, b_0$ \u3092\u6c42\u3081\u3089\u308c\u308b\u3053\u3068\u304c\u5206\u304b\u308a\u307e\u3057\u305f\uff0e\n\n\u8ffd\u8a18\u60c5\u5831\n\n2016/05/01\n@skyshk \u3055\u3093\u304b\u3089\u30b3\u30e1\u30f3\u30c8\u3092\u3044\u305f\u3060\u3044\u3066\u30b3\u30fc\u30c9\u3092\u4fee\u6b63\u3057\u307e\u3057\u305f\uff0e\n\n# \u306f\u3058\u3081\u306b\n\npython\u3067SVM\uff08\u30b5\u30dd\u30fc\u30c8\u30d9\u30af\u30bf\u30fc\u30de\u30b7\u30f3\uff09\u3092\u5b9f\u88c5\u3057\u307e\u3057\u305f\uff0e\n\u6559\u79d1\u66f8\u3068\u3057\u3066[\u300e\u306f\u3058\u3081\u3066\u306e\u30d1\u30bf\u30fc\u30f3\u8a8d\u8b58\u300f](http://www.amazon.co.jp/\u306f\u3058\u3081\u3066\u306e\u30d1\u30bf\u30fc\u30f3\u8a8d\u8b58-\u5e73\u4e95-\u6709\u4e09/dp/4627849710)\u3092\u4f7f\u3044\u307e\u3057\u305f\uff0e\n\n\u672c\u8a18\u4e8b\u306e\u69cb\u6210\n\n* \u306f\u3058\u3081\u306b\n* SVM\n    * \u30de\u30fc\u30b8\u30f3\u6700\u5927\u5316\n    * \u4e3b\u554f\u984c\n    * \u30e9\u30b0\u30e9\u30f3\u30b8\u30e5\u672a\u5b9a\u4e57\u6570\u6cd5\n    * KKT\u6761\u4ef6\n    * \u53cc\u5bfe\u554f\u984c\n* \u89e3\u306e\u6c42\u3081\u65b9\n* python\u3067\u306e\u5b9f\u88c5\n* \u7d50\u679c\n* \u304a\u308f\u308a\u306b\n* \u8ffd\u8a18\u60c5\u5831\n\n\n# SVM\n\nSVM\u3068\u306f\uff0c\u6700\u5927\u30de\u30fc\u30b8\u30f3\u3092\u5b9f\u73fe\u3059\u308b2\u30af\u30e9\u30b9\u7dda\u5f62\u8b58\u5225\u5b66\u7fd2\u6cd5\u3067\u3059\uff0e\n\u6559\u79d1\u66f8\u306b\u3088\u308b\u3068\uff0c\u4ed6\u30af\u30e9\u30b9\u306e\u8b58\u5225\u306f $K-1$ \u500b\u306e\u4e00\u5bfe\u591aSVM\u3067\u5b9f\u73fe\u3059\u308b\u3053\u3068\u304c\u591a\u3044\u3088\u3046\u3067\u3059\uff0e\n\n## \u30de\u30fc\u30b8\u30f3\u6700\u5927\u5316\n\n\u6b21\u306e\u3088\u3046\u306a\u30c7\u30fc\u30bf\u96c6\u5408\u3092\u8003\u3048\u307e\u3059\uff0e \u30c7\u30fc\u30bf\u306e\u7dcf\u6570\u3092 $N$ \u3068\u3059\u308b\u3068\uff0c$i = 1,...,N$\u3068\u306a\u308a\u307e\u3059\uff0e\n\n```math\n\\begin{align}\n& D_L = \\bigl\\{(t_i, {\\boldsymbol{x}}_i)\\bigr\\} \\\\\n& t_i = \\{-1, +1\\}\n\\end{align}\n```\n\n\u7dda\u5f62\u8b58\u5225\u95a2\u6570\u306e\u30de\u30fc\u30b8\u30f3\u3092 $\\kappa$ \u3068\u3059\u308b\u3068\uff0c\u5168\u3066\u306e\u5b66\u7fd2\u30c7\u30fc\u30bf\u3067\u6b21\u5f0f\u304c\u6210\u308a\u7acb\u3061\u307e\u3059\uff0e\n\n```math\n|\\boldsymbol{w}^T{\\boldsymbol{x}}_i + b| \\geq \\kappa\n```\n\n$\\kappa$ \u3067\u6b63\u898f\u5316\u3057\u305f\u3082\u306e\u3092 $\\boldsymbol{w}$\uff0c $b$ \u3068\u7f6e\u304d\u76f4\u3057\uff0c\u6559\u5e2b\u3068\u306e\u7a4d\u3092\u3068\u308b\u3053\u3068\u3067\u7d76\u5bfe\u5024\u3092\u306f\u305a\u3057\u307e\u3059\uff0e\n\n```math\nt_i(\\boldsymbol{w}^T{\\boldsymbol{x}}_i + b) \\geq 1 \\tag{1}\n```\n\n\u56f3\u306e\u3088\u3046\u306b\u30af\u30e9\u30b9\u9593\u30de\u30fc\u30b8\u30f3\u306f\uff0c\u8b58\u5225\u8d85\u5e73\u9762\u306b\u6700\u3082\u8fd1\u3044\u30c7\u30fc\u30bf\u3092 $\\boldsymbol{w}$ \u65b9\u5411\u306b\u5c04\u5f71\u3057\u305f\u9577\u3055\u306e\u5dee\u3068\u3057\u3066\u6c42\u3081\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\uff0e\n\n<img width=420 alt=\"mergin.png\" src=\"https://qiita-image-store.s3.amazonaws.com/0/82527/7bb67956-8b00-fa8a-c832-52fd8072aff6.png\">\n\n$t_{i} = +1$ \u306e\u30af\u30e9\u30b9\u306e\u4e2d\u3067\u8b58\u5225\u8d85\u5e73\u9762\u306b\u6700\u3082\u8fd1\u3044\u30c7\u30fc\u30bf\u306f\uff0c$\\boldsymbol{w}$ \u65b9\u5411\u306b\u5c04\u5f71\u3057\u305f\u9577\u3055\u304c\u305d\u306e\u30af\u30e9\u30b9\u5185\u3067\u6700\u5c0f\u3068\u306a\u308a\uff0c\n$t_{i} = -1$ \u306e\u30af\u30e9\u30b9\u306e\u4e2d\u3067\u8b58\u5225\u8d85\u5e73\u9762\u306b\u6700\u3082\u8fd1\u3044\u30c7\u30fc\u30bf\u306f\uff0c$\\boldsymbol{w}$ \u65b9\u5411\u306b\u5c04\u5f71\u3057\u305f\u9577\u3055\u304c\u305d\u306e\u30af\u30e9\u30b9\u5185\u3067\u6700\u5927\u3068\u306a\u308a\u307e\u3059\uff0e\n\u30af\u30e9\u30b9\u9593\u30de\u30fc\u30b8\u30f3 $\\rho(\\boldsymbol{w}, b)$ \u306f\u6b21\u5f0f\u3067\u8868\u3055\u308c\u307e\u3059\uff0e\n\n```math\n\\begin{align}\n\\rho(\\boldsymbol{w}, b) &= \\min_{\\boldsymbol{x} \\in C_{y=+1}}\\frac{{\\boldsymbol{w}}^T\\boldsymbol{x}}{||\\boldsymbol{w}||} - \\max_{\\boldsymbol{x} \\in C_{y=-1}}\\frac{{\\boldsymbol{w}}^T\\boldsymbol{x}}{||\\boldsymbol{w}||} \\\\\n\\\\\n&= \\frac{1-b}{||\\boldsymbol{w}||} - \\frac{-1-b}{||\\boldsymbol{w}||} \\\\\n\\\\\n&= \\frac{2}{||\\boldsymbol{w}||} \\tag{2}\n\\end{align}\n```\n\n\u5f0f(2)\u3088\u308a\uff0c$||\\boldsymbol{w}||$ \u3092\u6700\u5c0f\u5316\u3059\u308c\u3070\uff0c\u30af\u30e9\u30b9\u9593\u30de\u30fc\u30b8\u30f3\u306f\u6700\u5927\u5316\u3055\u308c\u308b\u3053\u3068\u304c\u5206\u304b\u308a\u307e\u3059\uff0e\n\u307e\u305f\uff0c\u30af\u30e9\u30b9\u9593\u30de\u30fc\u30b8\u30f3\u306f\u8b58\u5225\u8d85\u5e73\u9762\u306b\u6700\u3082\u8fd1\u3044\u30c7\u30fc\u30bf\u3060\u3051\u3067\u6c7a\u307e\u308a\u307e\u3059\uff0e\u3053\u306e\u8b58\u5225\u8d85\u5e73\u9762\u306b\u6700\u3082\u8fd1\u3044\u30c7\u30fc\u30bf\u306e\u3053\u3068\u3092\u30b5\u30dd\u30fc\u30c8\u30d9\u30af\u30bf\u30fc\u3068\u547c\u3073\u307e\u3059\uff0e\n\n## \u4e3b\u554f\u984c\n\n\u5f0f(1)\u306e\u5236\u7d04\u6761\u4ef6\u306e\u3082\u3068\uff0c\u5f0f(2)\u306b\u8868\u3055\u308c\u308b\u30af\u30e9\u30b9\u9593\u30de\u30fc\u30b8\u30f3\u3092\u6700\u5927\u5316\u3059\u308b\u3053\u3068\u3092\u8003\u3048\u307e\u3059\uff0e\u3053\u308c\u3092\u4e3b\u554f\u984c\u3068\u3057\u307e\u3059\uff0e\n\n\u8a55\u4fa1\u95a2\u6570\uff08\u6700\u5c0f\u5316\uff09\n\n```math\nL_p(\\boldsymbol{w}) = \\frac{1}{2}{\\boldsymbol{w}}^{T}\\boldsymbol{w}\n```\n\n\u4e0d\u7b49\u5f0f\u5236\u7d04\u6761\u4ef6\n\n```math\nt_i(\\boldsymbol{w}^T{\\boldsymbol{x}}_i + b) - 1 \\geq 0\n```\n\n## \u30e9\u30b0\u30e9\u30f3\u30b8\u30e5\u672a\u5b9a\u4e57\u6570\u6cd5\n\n\u4e3b\u554f\u984c\u3092\u89e3\u304f\u305f\u3081\u306b\u30e9\u30b0\u30e9\u30f3\u30b8\u30e5\u672a\u5b9a\u4e57\u6570\u6cd5\u3092\u4f7f\u3044\u307e\u3059\uff0e\n> \u30e9\u30b0\u30e9\u30f3\u30b8\u30e5\u306e\u672a\u5b9a\u4e57\u6570\u6cd5\uff08\u30e9\u30b0\u30e9\u30f3\u30b8\u30e5\u306e\u307f\u3066\u3044\u3058\u3087\u3046\u3059\u3046\u307b\u3046\u3001\u82f1: method of Lagrange multiplier\uff09\u3068\u306f\u3001\u675f\u7e1b\u6761\u4ef6\u306e\u3082\u3068\u3067\u6700\u9069\u5316\u3092\u884c\u3046\u305f\u3081\u306e\u6570\u5b66\uff08\u89e3\u6790\u5b66\uff09\u7684\u306a\u65b9\u6cd5\u3067\u3042\u308b\u3002\u3044\u304f\u3064\u304b\u306e\u5909\u6570\u306b\u5bfe\u3057\u3066\u3001\u3044\u304f\u3064\u304b\u306e\u95a2\u6570\u306e\u5024\u3092\u56fa\u5b9a\u3059\u308b\u3068\u3044\u3046\u675f\u7e1b\u6761\u4ef6\u306e\u3082\u3068\u3067\u3001\u5225\u306e\u3042\u308b1\u3064\u306e\u95a2\u6570\u306e\u6975\u5024\u3092\u6c42\u3081\u308b\u3068\u3044\u3046\u554f\u984c\u3092\u8003\u3048\u308b\u3002\u5404\u675f\u7e1b\u6761\u4ef6\u306b\u5bfe\u3057\u3066\u5b9a\u6570\uff08\u672a\u5b9a\u4e57\u6570\u3001Lagrange multiplier\uff09\u3092\u7528\u610f\u3057\u3001\u3053\u308c\u3089\u3092\u4fc2\u6570\u3068\u3059\u308b\u7dda\u5f62\u7d50\u5408\u3092\u65b0\u3057\u3044\u95a2\u6570\uff08\u672a\u5b9a\u4e57\u6570\u3082\u65b0\u305f\u306a\u5909\u6570\u3068\u3059\u308b\uff09\u3068\u3057\u3066\u8003\u3048\u308b\u3053\u3068\u3067\u3001\u675f\u7e1b\u554f\u984c\u3092\u666e\u901a\u306e\u6975\u5024\u554f\u984c\u3068\u3057\u3066\u89e3\u304f\u3053\u3068\u304c\u3067\u304d\u308b\u65b9\u6cd5\u3067\u3042\u308b\u3002\n[wikipedia](https://ja.wikipedia.org/wiki/\u30e9\u30b0\u30e9\u30f3\u30b8\u30e5\u306e\u672a\u5b9a\u4e57\u6570\u6cd5)\u3088\u308a\u5f15\u7528\n\n### \u5177\u4f53\u4f8b\n\u4f55\u3092\u8a00\u3063\u3066\u3044\u308b\u304b\u3055\u3063\u3071\u308a\u5206\u304b\u3089\u306a\u3044\u306e\u3067\uff0c\u5177\u4f53\u4f8b\u3092\u6319\u3052\u3066\u8aac\u660e\u3057\u307e\u3059\uff0e\n$g(x, y) = x^2 + y^2 - 2 = 0$ \u306e\u6761\u4ef6\u4e0b\u3067 $f(x, y) = y - x$ \u306e\u6700\u5927\u5316\u3092\u8003\u3048\u307e\u3059\uff0e\n\u3053\u308c\u306f\u534a\u5f84 $\\sqrt{2}$ \u306e\u5186\u5468\u4e0a\u306e $(x, y)$ \u3092\u4f7f\u3063\u3066\uff0c\u76f4\u7dda\u306e\u5207\u7247\u3092\u6700\u5927\u5316\u3059\u308b\u3068\u3044\u3046\u554f\u984c\u306b\u306a\u308a\u307e\u3059\uff0e\n\n<img width=360 alt=\"rag2.png\" src=\"https://qiita-image-store.s3.amazonaws.com/0/82527/a4c5207b-7bb5-c525-d5bb-1a851abdc91d.png\">\n\n\u56f3\u304b\u3089\uff0c\u5186\u3068\u76f4\u7dda\u304c\u63a5\u3059\u308b\u3068\u304d $f(x, y)$ \u304c\u5236\u7d04\u6761\u4ef6\u306e\u3082\u3068\u6700\u5927\u5024 $2$ \u3092\u53d6\u308b\u3053\u3068\u304c\u5206\u304b\u308a\u307e\u3059\uff0e\n\u3053\u308c\u3092\u30e9\u30b0\u30e9\u30f3\u30b8\u30e5\u672a\u5b9a\u4e57\u6570\u6cd5\u3092\u4f7f\u3063\u3066\u89e3\u3044\u3066\u307f\u307e\u3057\u3087\u3046\uff0e\n\n```math\n\\begin{align}\nL(x, y, \\lambda) &= f(x, y) + \\lambda g(x, y) \\\\\n\\\\\n&= y - x + \\lambda(x^2 + y^2 - 2) \\tag{3}\n\\end{align}\n```\n\n\u5f0f(3)\u306e\u30e9\u30b0\u30e9\u30f3\u30b8\u30e5\u95a2\u6570\u3092 $x, y, \\lambda$ \u3067\u504f\u5fae\u5206\u3057\uff0c\u305d\u308c\u305e\u308c\u30a4\u30b3\u30fc\u30eb $0$ \u3068\u3057\u307e\u3059\uff0e\n\n```math\n\\begin{align}\n& \\frac{\\partial L}{\\partial x} = -1 + 2\\lambda x = 0 \\\\\n& \\frac{\\partial L}{\\partial y} = 1 + 2\\lambda y = 0 \\\\\n& \\frac{\\partial L}{\\partial \\lambda} = x^2 + y^2 - 2 = 0\n\\end{align}\n```\n\n1\uff0c2\u756a\u76ee\u306e\u5f0f\u30923\u756a\u76ee\u306e\u5f0f\u306b\u4ee3\u5165\u3057\u307e\u3059\uff0e\n\n```math\n\\begin{align}\n& \\Bigl(\\frac{1}{2\\lambda}\\Bigr)^2 + \\Bigl(-\\frac{1}{2\\lambda}\\Bigr)^2 - 2 = 0 \\\\\n\\\\\n& \\lambda = \\pm \\frac{1}{2}, x = \\pm 1, y = \\mp 1\n\\end{align}\n```\n\n\u3088\u3063\u3066\uff0c$g(x, y) = 0$ \u306e\u5236\u7d04\u6761\u4ef6\u4e0b\u3067 $f(x, y) = y - x$ \u306f\u6700\u5927\u5024 $2$ \u3092\u53d6\u308a\u307e\u3059\uff0e\n\u3053\u306e\u6700\u5927\u5024\u306b\u3064\u3044\u30663\u6b21\u5143\u3067\u8003\u3048\u3066\u307f\u307e\u3059\uff0e3\u6b21\u5143\u7a7a\u9593\u3067\u306f\uff0c$z = f(x, y) = y - x$ \u306f\u659c\u9762\u306b\uff0c$g(x, y) = x^2 + y^2 - 1 = 0$ \u306f\u5186\u67f1\u306b\u306a\u308a\u307e\u3059\uff0e\n$g(x, y) = 0$ \u306e\u5236\u7d04\u6761\u4ef6\u4e0b\u3067 $z = y - x$ \u306e\u6700\u5927\u5024\u3092\u6c42\u3081\u305f\u3044\u306e\u3067\uff0c\u659c\u9762\u3068\u5186\u67f1\u304c\u4ea4\u308f\u308b\u9762\u306b\u95a2\u3057\u3066\uff0c$z$ \u5ea7\u6a19\u306e\u6700\u5927\u5024\u3092\u898b\u3064\u3051\u308c\u3070\u826f\u3044\u3053\u3068\u3068\u306a\u308a\u307e\u3059\uff0e\n\u3064\u307e\u308a\uff0c$x^2 + y^2 - 2 = 0$ \u306e\u5186\u3092 $z = y - x$ \u5e73\u9762\u306b\u5c04\u5f71\u3057\u305f\u3068\u304d\u306e $z$ \u8ef8\u65b9\u5411\u306e\u6700\u5927\u5024\u304c\u6c42\u3081\u305f\u3044\u5024\u3067\u3059\uff0e\n\u3053\u308c\u3092\u56f3\u3067\u8868\u3057\u307e\u3059\uff0e\u771f\u6a2a\u304b\u3089\u898b\u305f\u3068\u304d\uff0c\u659c\u9762\u3068\u5186\u67f1\u304c\u4ea4\u308f\u3063\u3066\u3044\u308b\u90e8\u5206\u306e\u4e2d\u3067\uff0c$z$ \u8ef8\u65b9\u5411\u306e\u6700\u5927\u5024\u306f $2$ \u3067\u3042\u308b\u3053\u3068\u304c\u5206\u304b\u308a\uff0c\u3053\u308c\u306f\u8a08\u7b97\u7d50\u679c\u3068\u4e00\u81f4\u3057\u307e\u3059\uff0e\n\n<img width=600 alt=\"lagrange.png\" src=\"https://qiita-image-store.s3.amazonaws.com/0/82527/aca4e678-adb7-0689-2da9-85e032ea43e0.png\">\n\n### \u89e3\u8aac\n\u306a\u305c\u30e9\u30b0\u30e9\u30f3\u30b8\u30e5\u672a\u5b9a\u4e57\u6570\u6cd5\u3067\uff0c\u6700\u5c0f\u5024\u3092\u6c42\u3081\u3089\u308c\u308b\u306e\u304b\u89e3\u8aac\u3057\u3066\u307f\u307e\u3059\uff0e\uff08\u8aa4\u308a\u3092\u542b\u3080\u304b\u3082\u3057\u308c\u307e\u305b\u3093\uff09\n\u5236\u7d04\u6761\u4ef6 $g(\\boldsymbol{x}) = 0$\uff08\u4ee5\u4e0b\uff0c\u5236\u7d04\u9762\u3068\u3059\u308b\uff09\u306e\u3082\u3068\uff0c\u8a55\u4fa1\u95a2\u6570 $f(\\boldsymbol{x})$ \u304c $\\boldsymbol{x}^\\star$ \u306b\u304a\u3044\u3066\u6700\u5927\u5024\u3092\u3068\u308b\u3068\u304d\uff0c$\\boldsymbol{\\nabla}f(\\boldsymbol{x})$ \u306f\u5236\u7d04\u9762\u306b\u5bfe\u3057\u3066\u5782\u76f4\u3067\u306a\u3051\u308c\u3070\u306a\u308a\u307e\u305b\u3093\uff0e\n\u306a\u305c\u306a\u3089\uff0c\u5782\u76f4\u3067\u306a\u3044\u3068\u4eee\u5b9a\u3059\u308b\u3068\uff0c\u5236\u7d04\u9762\u306e\u65b9\u5411\u306b\u6cbf\u3063\u3066 $f(\\boldsymbol{x})$ \u3092\u3055\u3089\u306b\u5927\u304d\u304f\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u308b\u304b\u3089\u3067\u3059\uff0e\u307e\u305f\uff0c$\\boldsymbol{\\nabla}g(\\boldsymbol{x})$ \u3082\u5236\u7d04\u9762\u306b\u5bfe\u3057\u3066\u5782\u76f4\u306b\u306a\u308a\u307e\u3059\uff0e\n\u3088\u3063\u3066 $\\boldsymbol{x}^\\star$ \u306b\u304a\u3044\u3066 $\\boldsymbol{\\nabla}f, \\boldsymbol{\\nabla}g$ \u306f\u5e73\u884c\u306a\u30d9\u30af\u30c8\u30eb\u3068\u306a\u308a\uff0c\u6b21\u5f0f\u304c\u6210\u308a\u7acb\u3061\u307e\u3059\uff0e\n\n```math\n\\boldsymbol{\\nabla}f + \\lambda\\boldsymbol{\\nabla}g = 0 \\tag{4}\n```\n\n\u3053\u3053\u3067\uff0c\u30e9\u30b0\u30e9\u30f3\u30b8\u30e5\u95a2\u6570\u3092\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u5b9a\u7fa9\u3057\u307e\u3059\uff0e\n\n```math\nL(\\boldsymbol{x}, \\lambda) \\equiv f(\\boldsymbol{x}) + \\lambda g(\\boldsymbol{x})\n```\n\n\u30e9\u30b0\u30e9\u30f3\u30b8\u30e5\u95a2\u6570 $L(\\boldsymbol{x}, \\lambda)$ \u3092 $\\boldsymbol{x}, \\lambda$ \u3067\u504f\u5fae\u5206\u3059\u308b\u3053\u3068\u3067\u5f0f(4)\u304a\u3088\u3073\u5236\u7d04\u6761\u4ef6\u3092\u5c0e\u304f\u3053\u3068\u304c\u3067\u304d\u307e\u3059\uff0e\n\u3053\u308c\u3092\u89e3\u304f\u3053\u3068\u3067\u505c\u7559\u70b9 $\\boldsymbol{x}^\\star$ \u304c\u5f97\u3089\u308c\u307e\u3059\uff0e\u3053\u306e $\\boldsymbol{x}^\\star$ \u306e\u4e2d\u306b\uff0c$f(\\boldsymbol{x})$ \u3092\u6700\u5927\u5316\u3059\u308b $\\boldsymbol{x}$ \u304c\u5b58\u5728\u3057\u307e\u3059\uff0e\n\n## KKT\u6761\u4ef6\n\n\u3067\u306f\uff0c\u3053\u306e\u30e9\u30b0\u30e9\u30f3\u30b8\u30e5\u306e\u672a\u5b9a\u4e57\u6570\u6cd5\u3092\u4e3b\u554f\u984c\u306b\u9069\u7528\u3057\u307e\u3059\uff0e\n\u30e9\u30b0\u30e9\u30f3\u30b8\u30e5\u95a2\u6570\u3092\u6b21\u5f0f\u306e\u3088\u3046\u306b\u5b9a\u7fa9\u3057\u307e\u3059\uff0e\n\n```math\n\\tilde{L}_{p}(\\boldsymbol{w}, b, \\boldsymbol{\\alpha}) = \\frac{1}{2}{\\boldsymbol{w}}^T\\boldsymbol{w} - \\sum_{i=1}^{N}\\alpha_i(t_i(\\boldsymbol{w}^T{\\boldsymbol{x}}_i + b) - 1) \\tag{5}\n```\n\n\u3053\u3053\u3067\uff0c$\\boldsymbol{\\alpha} = {(\\alpha_1, ..., \\alpha_N)}^T (\\alpha_i \\geq 0)$ \u3067\u3042\u308a\uff0c$\\alpha_i$ \u304c\u30e9\u30b0\u30e9\u30f3\u30b8\u30e5\u672a\u5b9a\u4e57\u6570\u3067\u3059\uff0e\n\u3053\u306e\u6700\u9069\u5316\u554f\u984c\u306e\u89e3 $\\boldsymbol{w}_0, b_0$ \u306f\uff0c\u4ee5\u4e0b\u306eKKT\u6761\u4ef6\u3092\u6e80\u305f\u3059\u89e3\u3068\u3057\u3066\u5f97\u3089\u308c\u307e\u3059\uff0e\n\n**< KKT\u6761\u4ef6 >**\n\n```math\n\\begin{align}\n& \\left.\\frac{\\partial \\tilde{L}_p(\\boldsymbol{w}, b, \\boldsymbol{\\alpha})}{\\partial \\boldsymbol{w}}\\right|_{\\boldsymbol{w} = \\boldsymbol{w}_0} = \\boldsymbol{w}_0 - \\sum_{i=1}^{N}\\alpha_{i}t_i{\\boldsymbol{x}}_i = 0 \\tag{6} \\\\\n& \\frac{\\partial \\tilde{L}_p(\\boldsymbol{w}, b, \\boldsymbol{\\alpha})}{\\partial b} = \\sum_{i=1}^{N}\\alpha_{i}t_i = 0 \\tag{7} \\\\\n& \\\\\n& t_i(\\boldsymbol{w}^T{\\boldsymbol{x}}_i + b) - 1 \\geq 0 \\tag{8} \\\\\n& \\\\\n& \\alpha_i \\geq 0 \\tag{9} \\\\\n& \\\\\n& \\alpha_i(t_i(\\boldsymbol{w}^T{\\boldsymbol{x}}_i + b) - 1) = 0 \\tag{10}\n\\end{align}\n```\n\n\u5f0f(6),(7)\u306f\u30e9\u30b0\u30e9\u30f3\u30b8\u30e5\u95a2\u6570\u306e\u504f\u5fae\u5206\u30a4\u30b3\u30fc\u30eb $0$\uff0c\u5f0f(8)\u306f\u4e3b\u554f\u984c\u306e\u5236\u7d04\u6761\u4ef6\uff0c\u5f0f(10)\u306f\u76f8\u88dc\u6027\u6761\u4ef6\u3067\u3059\uff0e\n\u5f0f(10)\u306e\u76f8\u88dc\u6027\u6761\u4ef6\u3088\u308a\n\n```math\nt_i(\\boldsymbol{w}^T\\boldsymbol{x}_i + b) - 1 > 0 \\Rightarrow \\alpha_i = 0 \\\\\nt_i(\\boldsymbol{w}^T\\boldsymbol{x}_i + b) - 1 = 0 \\Rightarrow \\alpha_i \\geq 0\n```\n\n\u76f8\u88dc\u6027\u6761\u4ef6\u306f\uff0c\u30b5\u30dd\u30fc\u30c8\u30d9\u30af\u30bf\u30fc\u4ee5\u5916\u306e\u30c7\u30fc\u30bf\u306b\u3088\u308b\u5236\u7d04\u6761\u4ef6\u306e\u52b9\u679c\u306f\u306a\u304f\u3001\u30b5\u30dd\u30fc\u30c8\u30d9\u30af\u30bf\u30fc\u3060\u3051\u3067\u8b58\u5225\u8d85\u5e73\u9762\u304c\u6c7a\u5b9a\u3055\u308c\u308b\u3053\u3068\u3092\u793a\u3057\u3066\u3044\u307e\u3059\uff0e\n\uff08\u8abf\u3079\u3066\u307f\u308b\u3068KKT\u6761\u4ef6\u306f\u304b\u306a\u308a\u5965\u304c\u6df1\u305d\u3046\u306a\u306e\u3067\uff0c\u3053\u308c\u304f\u3089\u3044\u306e\u3075\u3093\u308f\u308a\u3068\u3057\u305f\u7406\u89e3\u3067\u6b21\u306b\u9032\u3080\u3053\u3068\u306b\u3057\u307e\u3059\uff09\n\n## \u53cc\u5bfe\u554f\u984c\n\n\u5f0f(5)\u3092\u5c55\u958b\u3057\uff0c\u6700\u9069\u89e3\u304a\u3088\u3073\u5f0f(6),(7)\u3092\u4ee3\u5165\u3057\u307e\u3059\uff0e\n\n```math\n\\begin{align}\nL_{d}(\\boldsymbol{\\alpha}) &= \\frac{1}{2}{\\boldsymbol{w}_{0}}^{T}\\boldsymbol{w}_{0} - \\sum_{i=1}^{N}\\alpha_{i}t_{i}{\\boldsymbol{w}_{0}}^{T}{\\boldsymbol{x}}_{i} - b\\sum_{i=1}^{N}\\alpha_{i}t_{i} + \\sum_{i=1}^{N}\\alpha_{i} \\\\\n&= \\frac{1}{2}{\\boldsymbol{w}_{0}}^{T}\\boldsymbol{w}_{0} - {\\boldsymbol{w}_{0}}^{T}\\boldsymbol{w}_{0} - 0 + \\sum_{i=1}^{N}\\alpha_{i} \\\\\n&= \\sum_{i=1}^{N}\\alpha_{i} - \\frac{1}{2}{\\boldsymbol{w}_{0}}^{T}\\boldsymbol{w}_{0} \\\\\n&= \\sum_{i=1}^{N}\\alpha_{i} - \\frac{1}{2}\\sum_{i=1}^{N}\\sum_{j=1}^{N}\\alpha_{i}\\alpha_{j}t_{i}t_{j}{\\boldsymbol{x}_i}^T{\\boldsymbol{x}}_j\n\\end{align}\n```\n\n\u5f0f(6)\u3088\u308a\uff0c\u6700\u9069\u89e3\u304c\u30e9\u30b0\u30e9\u30f3\u30b8\u30e5\u672a\u5b9a\u4e57\u6570\u3068\u5b66\u7fd2\u30c7\u30fc\u30bf\u306e\u7dda\u5f62\u548c\u3067\u8868\u3055\u308c\u308b\u3053\u3068\u304b\u3089\uff0c$\\alpha_{i}$ \u3092\u6c42\u3081\u308b\u554f\u984c\u306b\u7f6e\u304d\u63db\u3048\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\uff0e\n\u6700\u9069\u306a\u30e9\u30b0\u30e9\u30f3\u30b8\u30e5\u672a\u5b9a\u4e57\u6570\u306f\uff0c$L_{d}(\\boldsymbol{\\alpha})$ \u3092\u6700\u5927\u306b\u3059\u308b $\\boldsymbol{\\alpha}$ \u306b\u3088\u308a\u5f97\u3089\u308c\u307e\u3059\uff0e\u3053\u308c\u3092\u4e3b\u554f\u984c\u306b\u5bfe\u3059\u308b\u53cc\u5bfe\u554f\u984c\u3068\u547c\u3073\u307e\u3059\uff0e\n$N$ \u500b\u306e $1$ \u3092\u4e26\u3079\u305f\u30d9\u30af\u30c8\u30eb\u3092 $\\boldsymbol{1}$\uff0c\u5b66\u7fd2\u30c7\u30fc\u30bf\u3067\u4f5c\u3089\u308c\u305f\u884c\u5217\u3092 $\\boldsymbol{H}$\uff0c\u6559\u5e2b\u30c7\u30fc\u30bf\u30d9\u30af\u30c8\u30eb\u3092 $\\boldsymbol{t}$ \u3068\u3057\u307e\u3059\uff0e\n\n```math\n\\begin{align}\n& \\boldsymbol{1} = (1,...,1)^T \\\\\n\\\\\n& \\boldsymbol{H} = (H_{ij} = {t_it_j\\boldsymbol{x}_i}^T\\boldsymbol{x}_j) \\\\\n\\\\\n& \\boldsymbol{t} = (t_1,...,t_N)^T\n\\end{align}\n```\n\n\u8a55\u4fa1\u95a2\u6570\uff08\u6700\u5927\u5316\uff09\n\n```math\nL_{d}(\\boldsymbol{\\alpha}) = \\boldsymbol{\\alpha}^T\\boldsymbol{1} - \\frac{1}{2}\\boldsymbol{\\alpha}^T\\boldsymbol{H}\\boldsymbol{\\alpha}\n```\n\n\u7b49\u5f0f\u5236\u7d04\u6761\u4ef6\n\n```math\n\\boldsymbol{\\alpha}^T\\boldsymbol{t} = 0\n```\n\n\u53cc\u5bfe\u554f\u984c\u3092\u89e3\u3044\u3066\u5f97\u3089\u308c\u305f\u30e9\u30f3\u30b0\u30e9\u30f3\u30b8\u30e5\u672a\u5b9a\u4e57\u6570\u306e\u6700\u9069\u89e3\u3092 $\\tilde{\\boldsymbol{\\alpha}} = (\\tilde{\\alpha}_1,...,\\tilde{\\alpha}_N)^T$ \u3068\u3059\u308b\u3068\uff0c\u6700\u9069\u89e3\u306f\u6b21\u306e\u3088\u3046\u306b\u6c42\u3081\u3089\u308c\u307e\u3059\uff0e\n\n```math\n\\begin{align}\n& \\boldsymbol{w}_0 = \\sum_{i=1}^{N}\\tilde{\\alpha}_{i}t_i{\\boldsymbol{x}}_i \\\\\n& b_0 = \\frac{1}{t_s} - {\\boldsymbol{w}_0}^T\\boldsymbol{x}_s\n\\end{align}\n```\n\n$\\boldsymbol{x}_s, t_s$ \u306f\u30b5\u30dd\u30fc\u30c8\u30d9\u30af\u30bf\u30fc\u306e\u30c7\u30fc\u30bf\u304a\u3088\u3073\u6559\u5e2b\u3092\u8868\u3057\u307e\u3059\uff0e\n\n\n# \u89e3\u306e\u6c42\u3081\u65b9\n\n\u4e3b\u554f\u984c\u3092\u53cc\u5bfe\u554f\u984c\u306b\u7f6e\u304d\u63db\u3048\uff0c\u6700\u9069\u306a $\\tilde{\\boldsymbol{\\alpha}}$ \u3092\u6c42\u3081\u308c\u3070\uff0c\u30de\u30fc\u30b8\u30f3\u6700\u5927\u5316\u306f\u5b9f\u73fe\u3067\u304d\u308b\u3053\u3068\u3092\u5c0e\u304d\u307e\u3057\u305f\uff0e\n$L_{d}(\\boldsymbol{\\alpha})$ \u3092\u6700\u5927\u306b\u3059\u308b $\\boldsymbol{\\alpha}$ \u3092\u30d7\u30ed\u30b0\u30e9\u30e0\u3067\u6c42\u3081\u308b\u305f\u3081\u306b\u6700\u6025\u964d\u4e0b\u6cd5\u3092\u4f7f\u3044\u307e\u3059\uff0e\n\u53cc\u5bfe\u554f\u984c\u306e\u5236\u7d04\u6761\u4ef6\u3092\u6e80\u305f\u3059\u3088\u3046\u7f70\u91d1\u9805\u3092\u52a0\u3048\uff0c\u4ee5\u4e0b\u306e\u3088\u3046\u306b $L_{d}(\\boldsymbol{\\alpha})$ \u3092\u518d\u5b9a\u7fa9\u3057\u307e\u3057\u305f\uff0e\n\n```math\nL_{d}(\\boldsymbol{\\alpha}) = \\boldsymbol{\\alpha}^T\\boldsymbol{1} - \\frac{1}{2}\\boldsymbol{\\alpha}^T\\boldsymbol{H}\\boldsymbol{\\alpha} - \\frac{1}{2}\\beta\\boldsymbol{\\alpha}^T\\boldsymbol{t}\\boldsymbol{t}^T\\boldsymbol{\\alpha}\n```\n\n\u3067\u306f\uff0c\u5b9f\u969b\u306b\u6700\u6025\u964d\u4e0b\u6cd5\u3067 $\\alpha_i$ \u3092\u66f4\u65b0\u3057\u307e\u3059\uff0e\n\n```math\n\\begin{align}\n{\\alpha_i}' &= {\\alpha_i} + \\eta\\frac{L_{d}(\\boldsymbol{\\alpha})}{\\alpha_i}\u3000\\\\\n&= {\\alpha_i} + \\eta(1 - \\sum_{j=1}^{N}\\alpha_{j}t_{i}t_{j}{\\boldsymbol{x}_i}^T{\\boldsymbol{x}}_j - \\beta\\sum_{j=1}^{N}\\alpha_{j}t_{i}t_j)\n\\end{align}\n```\n\n\u3053\u3053\u307e\u3067\u96e3\u3057\u3044\u8a08\u7b97\u3092\u3057\u3066\u304d\u307e\u3057\u305f\u304c\uff0c\u6700\u7d42\u7684\u306b\u5f97\u3089\u308c\u308b\u6570\u5f0f\u306f\u7f8e\u3057\u3044\u3067\u3059\u306d\uff0e\n\u3053\u308c\u3067 $L_{d}(\\boldsymbol{\\alpha})$ \u3092\u6700\u5927\u306b\u3059\u308b $\\boldsymbol{\\alpha}$ \u306f\u5f97\u3089\u308c\u307e\u3059\uff0e\n\n# python\u3067\u306e\u5b9f\u88c5\n\n\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u5b9f\u88c5\u3057\u307e\u3057\u305f\uff0e\n$\\alpha_i$ \u306e\u66f4\u65b0\u304c\u7c21\u5358\u306b\u3067\u304d\u307e\u3059\uff0e\u307e\u305f\uff0c\u7f70\u91d1\u9805\u306e\u52b9\u679c\u3067\uff0c$\\boldsymbol{\\alpha}^T\\boldsymbol{t} = 0$ \u306e\u6761\u4ef6\u3092\u6e80\u305f\u3059\u3088\u3046\u306b\u66f4\u65b0\u304c\u884c\u308f\u308c\u307e\u3059\uff0e\n\n```svm.py\nimport numpy\nfrom matplotlib import pyplot\nimport sys\n\ndef f(x, y):\n\treturn x - y\n\nif __name__ == '__main__':\n\n\tparam = sys.argv\n\t\n\tnumpy.random.seed()\n\tN = 30\n\td = 2\n\tX = numpy.random.randn(N, d)\n\tT = numpy.array([1 if f(x, y) > 0 else - 1 for x, y in X])\n\talpha = numpy.zeros(N)\n\tbeta = 1.0\n\teta_al = 0.0001 # update ratio of alpha\n\teta_be = 0.1 # update ratio of beta\n\titr = 1000\n\t\n\tfor _itr in range(itr):\n\t\tfor i in range(N):\n\t\t\tdelta = 1 - (T[i] * X[i]).dot(alpha * T * X.T).sum() - beta * T[i] * alpha.dot(T)\n\t\t\talpha[i] += eta_al * delta\n\t\tfor i in range(N):\n\t\t\tbeta += eta_be * alpha.dot(T) ** 2 / 2\n\n\tindex = alpha > 0\n\tw = (alpha * T).T.dot(X)\n\tb = (T[index] - X[index].dot(w)).mean()\n\t\n\tif '-d' in param or '-s' in param:\n\t\tseq = numpy.arange(-3, 3, 0.02)\n\t\tpyplot.figure(figsize = (6, 6))\n\t\tpyplot.xlim(-3, 3)\n\t\tpyplot.ylim(-3, 3)\n\t\tpyplot.plot(seq, -(w[0] * seq + b) / w[1], 'k-')\n\t\tpyplot.plot(X[T ==  1,0], X[T ==  1,1], 'ro')\n\t\tpyplot.plot(X[T == -1,0], X[T == -1,1], 'bo')\n\n\t\tif '-s' in param:\n\t\t\tpyplot.savefig('graph.png')\n\n\t\tif '-d' in param:\n\t\t\tpyplot.show()\n```\n\n\n# \u7d50\u679c\n\n\u4e0b\u306e\u56f3\u306e\u3088\u3046\u306a\u7d50\u679c\u304c\u5f97\u3089\u308c\u307e\u3057\u305f\uff0e\u30c7\u30fc\u30bf\u70b9\u306e\u8272\u304c\u30af\u30e9\u30b9\u3092\u8868\u3057\u3066\u3044\u307e\u3059\uff0e\n\u8a08\u7b97\u306b\u3088\u308a\u6c42\u3081\u3089\u308c\u305f\u76f4\u7dda\u3092\u4e00\u7dd2\u306b\u63cf\u753b\u3057\u305f\u3068\u3053\u308d\uff0c\u305d\u308c\u3063\u307d\u3044\u7d50\u679c\u306f\u5f97\u3089\u308c\u307e\u3057\u305f\uff0e\n\n<img width=420 alt=\"result.png\" src=\"https://qiita-image-store.s3.amazonaws.com/0/82527/d38d90f8-7a4f-e473-317a-652a69bf477c.png\">\n\n\n# \u304a\u308f\u308a\u306b\n\n\u4e0d\u7b49\u5f0f\u6761\u4ef6\u4e0b\u3067\u30de\u30fc\u30b8\u30f3\u6700\u5927\u5316\u3092\u76ee\u7684\u3068\u3057\u305f\u4e3b\u554f\u984c\u3092\u8a2d\u5b9a\u3057\uff0c\u3053\u308c\u3092\u30e9\u30b0\u30e9\u30f3\u30b8\u30e5\u672a\u5b9a\u4e57\u6570\u6cd5\u3092\u4f7f\u3046\u3053\u3068\u3067\u53cc\u5bfe\u554f\u984c\u3078\u7f6e\u304d\u63db\u3048\uff0c\u6700\u9069\u306a $\\boldsymbol{w}_0, b_0$ \u3092\u6c42\u3081\u3089\u308c\u308b\u3053\u3068\u304c\u5206\u304b\u308a\u307e\u3057\u305f\uff0e\n\n\n# \u8ffd\u8a18\u60c5\u5831\n\n* 2016/05/01\n@skyshk \u3055\u3093\u304b\u3089\u30b3\u30e1\u30f3\u30c8\u3092\u3044\u305f\u3060\u3044\u3066\u30b3\u30fc\u30c9\u3092\u4fee\u6b63\u3057\u307e\u3057\u305f\uff0e\n", "tags": ["\u6a5f\u68b0\u5b66\u7fd2", "svm", "Python"]}