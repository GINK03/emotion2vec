{"context": " More than 1 year has passed since last update.\u30d1\u30fc\u30d5\u30a7\u30af\u30c8RoR\u306e\u52c9\u5f37\u30e1\u30e2\u3067\u3059\u3002\nActive Record\u5468\u308a\u306e\u6574\u7406\u3002\u3069\u3046\u3044\u3046SQL\u304c\u6d41\u308c\u308b\u304b\u3001\u5e38\u306b\u610f\u8b58\u3057\u3066\u3044\u304d\u305f\u3044\u3002\n\n\u30e2\u30c7\u30eb\n\n\u4e00\u5bfe\u591a\u306e\u95a2\u4fc2\n\u4f8b\uff09User(\u4e00)\u306f\u8907\u6570\u306eTicket(\u591a)\u3092\u6301\u3064\n\n\nclass User << ActiveRecord::Base\n  has_many :tickets\n...\n\nend\n\n\n\nclass Ticket << ActiveRecord::Base\n  belongs_to :user\n...\n\nend\n\n\n\u4e0a\u8a18\u306e\u8a2d\u5b9a\u3092\u5165\u308c\u308b\u3053\u3068\u3067\u3001Ticket\u30e2\u30c7\u30eb\u306euser_id\u304c\u5916\u90e8\u30ad\u30fc\u3067\u3042\u308a\u3001User\u30e2\u30c7\u30eb\u306e id\u304c\u53c2\u7167\u30ad\u30fc\u3067\u3042\u308b\u3068\u3001Active Record\u304c\u89e3\u91c8\u3057\u3066\u304f\u308c\u308b\u3002\n\nirb(main):007:0> user = User.find(1)\n  User Load (0.7ms)  SELECT  `users`.* FROM `users`  WHERE `users`.`id` = 1 LIMIT 1\n\n#user(id=1)\u306e\u6301\u3064\u5168\u30c1\u30b1\u30c3\u30c8\u3092\u8868\u793a\n#where\u53e5\u3067user_id = 1\u304c\u6761\u4ef6\u306b\u5165\u308b\u3000\u3000\u3000\nirb(main):008:0> user.tickets\n  Ticket Load (1.3ms)  SELECT `tickets`.* FROM `tickets`  WHERE `tickets`.`user_id` = 1\n\n\n\nirb(main):023:0* ticket = Ticket.find(4)\n  Ticket Load (0.4ms)  SELECT  `tickets`.* FROM `tickets`  WHERE `tickets`.`id` = 4 LIMIT 1\n\n#ticket(id=4)\u3092\u6240\u6709\u3059\u308b\u30e6\u30fc\u30b6(1\u3064)\u3092\u8868\u793a\n#where\u53e5\u3067user.id = ticket.user_id(1)\u304c\u5165\u308b\nirb(main):024:0> ticket.user\n  User Load (0.7ms)  SELECT  `users`.* FROM `users`  WHERE `users`.`id` = 1 LIMIT 1\n\n\n\n\u591a\u5bfe\u591a\u306e\u95a2\u4fc2\nUser(\u4e00)\u306f\u8907\u6570\u306eEvent\u306b\u53c2\u52a0\u3057\u3066\u3044\u308b\u3002\nEvent(\u4e00)\u306b\u306f\u8907\u6570\u306eUser\u304c\u53c2\u52a0\u3059\u308b\u3002\n\n\u3053\u308c\u3092\u3001\u4f8b\u3048\u3070events\u306buser_id, users\u306bevent_id\u3092\u6301\u305f\u305b\u305f\u5834\u5408\u3001\u540c\u3058User\u304c\u3001\u9055\u3046event_id\u3067\u8907\u6570\u5b58\u5728\u3059\u308b\u306a\u3069\u306e\u554f\u984c\u304c\u8d77\u304d\u308b\u3002\n\u89e3\u6c7a\u65b9\u6cd5\u3068\u3057\u3066\u3001\u4e2d\u9593\u30e2\u30c7\u30eb(Ticket)\u3067\u8868\u73fe\u3092\u3059\u308b\u3002\n\nclass User < ActiveRecord::Base\n has_many :tickets\n has_many :events, through: :tickets #Event\u3068Ticket\u3092event_id\u3067\u5185\u90e8\u7d50\u5408\u3057\u3001ticket.user_id=\u30e6\u30fc\u30b6ID\u3067\u7d5e\u308a\u3053\u307f\u3057\u3066Event\u3078\u30a2\u30af\u30bb\u30b9\n...\n\nend\n\nclass Event < ActiveRecord::Base\n  has_many :tickets\n  has_many :users, through: :tickets #User\u3068Ticket\u3092user_id\u3067\u5185\u90e8\u7d50\u5408\u3057\u3001ticket.event=id=\u30a4\u30f4\u30d9\u30f3\u30c8ID\u3067\u7d5e\u308a\u8fbc\u307f\u3057\u3066User\u3078\u30a2\u30af\u30bb\u30b9\n...\n\nend\n\n\nclass Ticket < ActiveRecord::Base\n  belongs_to :user\n  belongs_to :event\n...\n\nend\n\nirb(main):001:0> u = User.find(1)\n  User Load (0.3ms)  SELECT  `users`.* FROM `users`  WHERE `users`.`id` = 1 LIMIT 1\nirb(main):002:0> u.events\n  Event Load (0.5ms)  SELECT `events`.* FROM `events` INNER JOIN `tickets` ON `events`.`id` = `tickets`.`event_id` WHERE `tickets`.`user_id` = 1\n\nirb(main):007:0* event=Event.find(1)\n  Event Load (1.1ms)  SELECT  `events`.* FROM `events`  WHERE `events`.`id` = 1 LIMIT 1\nirb(main):008:0> event.users\n User Load (0.4ms)  SELECT `users`.* FROM `users` INNER JOIN `tickets` ON `users`.`id` = `tickets`.`user_id` WHERE `tickets`.`event_id` = 1\n\n\n\u30d1\u30fc\u30d5\u30a7\u30af\u30c8RoR\u306e\u52c9\u5f37\u30e1\u30e2\u3067\u3059\u3002\nActive Record\u5468\u308a\u306e\u6574\u7406\u3002\u3069\u3046\u3044\u3046SQL\u304c\u6d41\u308c\u308b\u304b\u3001\u5e38\u306b\u610f\u8b58\u3057\u3066\u3044\u304d\u305f\u3044\u3002\n\n#\u30e2\u30c7\u30eb\n\n##\u4e00\u5bfe\u591a\u306e\u95a2\u4fc2\n\n\u4f8b\uff09User(\u4e00)\u306f\u8907\u6570\u306eTicket(\u591a)\u3092\u6301\u3064\n\n![image](https://qiita-image-store.s3.amazonaws.com/0/20721/50b8af6b-2e01-fb21-7a74-d7aecb88b2a8.png)\n\n```rb\n\nclass User << ActiveRecord::Base\n  has_many :tickets\n...\n\nend\n\n```\n\n```rb\n\nclass Ticket << ActiveRecord::Base\n  belongs_to :user\n...\n\nend\n\n```\n\n\u4e0a\u8a18\u306e\u8a2d\u5b9a\u3092\u5165\u308c\u308b\u3053\u3068\u3067\u3001Ticket\u30e2\u30c7\u30eb\u306euser_id\u304c\u5916\u90e8\u30ad\u30fc\u3067\u3042\u308a\u3001User\u30e2\u30c7\u30eb\u306e id\u304c\u53c2\u7167\u30ad\u30fc\u3067\u3042\u308b\u3068\u3001Active Record\u304c\u89e3\u91c8\u3057\u3066\u304f\u308c\u308b\u3002\n\n```irb\n\nirb(main):007:0> user = User.find(1)\n  User Load (0.7ms)  SELECT  `users`.* FROM `users`  WHERE `users`.`id` = 1 LIMIT 1\n\n#user(id=1)\u306e\u6301\u3064\u5168\u30c1\u30b1\u30c3\u30c8\u3092\u8868\u793a\n#where\u53e5\u3067user_id = 1\u304c\u6761\u4ef6\u306b\u5165\u308b\u3000\u3000\u3000\nirb(main):008:0> user.tickets\n  Ticket Load (1.3ms)  SELECT `tickets`.* FROM `tickets`  WHERE `tickets`.`user_id` = 1\n\n\n\nirb(main):023:0* ticket = Ticket.find(4)\n  Ticket Load (0.4ms)  SELECT  `tickets`.* FROM `tickets`  WHERE `tickets`.`id` = 4 LIMIT 1\n\n#ticket(id=4)\u3092\u6240\u6709\u3059\u308b\u30e6\u30fc\u30b6(1\u3064)\u3092\u8868\u793a\n#where\u53e5\u3067user.id = ticket.user_id(1)\u304c\u5165\u308b\nirb(main):024:0> ticket.user\n  User Load (0.7ms)  SELECT  `users`.* FROM `users`  WHERE `users`.`id` = 1 LIMIT 1\n\n```\n\n##\u591a\u5bfe\u591a\u306e\u95a2\u4fc2\nUser(\u4e00)\u306f\u8907\u6570\u306eEvent\u306b\u53c2\u52a0\u3057\u3066\u3044\u308b\u3002\nEvent(\u4e00)\u306b\u306f\u8907\u6570\u306eUser\u304c\u53c2\u52a0\u3059\u308b\u3002\n\n![image](https://qiita-image-store.s3.amazonaws.com/0/20721/cb4e553e-f4ff-d957-a137-2e6354668de3.png)\n\n\u3053\u308c\u3092\u3001\u4f8b\u3048\u3070events\u306buser_id, users\u306bevent_id\u3092\u6301\u305f\u305b\u305f\u5834\u5408\u3001\u540c\u3058User\u304c\u3001\u9055\u3046event_id\u3067\u8907\u6570\u5b58\u5728\u3059\u308b\u306a\u3069\u306e\u554f\u984c\u304c\u8d77\u304d\u308b\u3002\n\n\u89e3\u6c7a\u65b9\u6cd5\u3068\u3057\u3066\u3001\u4e2d\u9593\u30e2\u30c7\u30eb(Ticket)\u3067\u8868\u73fe\u3092\u3059\u308b\u3002\n\n![image](https://qiita-image-store.s3.amazonaws.com/0/20721/7ef288d7-2436-196a-a50c-235e91f37617.png)\n\n\n```rb\nclass User < ActiveRecord::Base\n has_many :tickets\n has_many :events, through: :tickets #Event\u3068Ticket\u3092event_id\u3067\u5185\u90e8\u7d50\u5408\u3057\u3001ticket.user_id=\u30e6\u30fc\u30b6ID\u3067\u7d5e\u308a\u3053\u307f\u3057\u3066Event\u3078\u30a2\u30af\u30bb\u30b9\n...\n\nend\n```\n\n\n```rb\nclass Event < ActiveRecord::Base\n  has_many :tickets\n  has_many :users, through: :tickets #User\u3068Ticket\u3092user_id\u3067\u5185\u90e8\u7d50\u5408\u3057\u3001ticket.event=id=\u30a4\u30f4\u30d9\u30f3\u30c8ID\u3067\u7d5e\u308a\u8fbc\u307f\u3057\u3066User\u3078\u30a2\u30af\u30bb\u30b9\n...\n\nend\n```\n\n```rb\n\nclass Ticket < ActiveRecord::Base\n  belongs_to :user\n  belongs_to :event\n...\n\nend\n```\n\n```irb\nirb(main):001:0> u = User.find(1)\n  User Load (0.3ms)  SELECT  `users`.* FROM `users`  WHERE `users`.`id` = 1 LIMIT 1\nirb(main):002:0> u.events\n  Event Load (0.5ms)  SELECT `events`.* FROM `events` INNER JOIN `tickets` ON `events`.`id` = `tickets`.`event_id` WHERE `tickets`.`user_id` = 1\n\nirb(main):007:0* event=Event.find(1)\n  Event Load (1.1ms)  SELECT  `events`.* FROM `events`  WHERE `events`.`id` = 1 LIMIT 1\nirb(main):008:0> event.users\n User Load (0.4ms)  SELECT `users`.* FROM `users` INNER JOIN `tickets` ON `users`.`id` = `tickets`.`user_id` WHERE `tickets`.`event_id` = 1\n\n```\n\n\n\n\n", "tags": ["ActiveRecord4.1.1", "Rails4.1.1", "Ruby2.1.2"]}