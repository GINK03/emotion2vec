{"context": " More than 1 year has passed since last update.\n\n\u306f\u3058\u3081\u306b\nLivet\u3067\u30ec\u30dd\u30fc\u30c8\u3092\u4f5c\u6210\u3059\u308b\u306e\u306b\u7c21\u5358\u306b\u3067\u304d\u306a\u3044\u304b\u691c\u8a0e\u3057\u305f\u304c\u3001UserControl\u3092\u4f7f\u3044\u30d7\u30ed\u30d1\u30c6\u30a3\u3092\u8a2d\u5b9a\u3059\u308b\u3053\u3068\u3067\u6bd4\u8f03\u7684\u7c21\u5358\u306b\u30ec\u30dd\u30fc\u30c8\u3092\u8868\u793a\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u3063\u305f\u3002\n\u30e1\u30c3\u30bb\u30f3\u30b8\u30e3\u30fc\u3067\u3067\u304d\u306a\u3044\u304b\u8abf\u3079\u3066\u307f\u305f\u304cUserControl\u306e\u307b\u3046\u3067\u5b9f\u73fe\u3067\u304d\u305f\u3002\n\u3042\u307e\u308a\u3001Livet\u3067\u306eReportViewer\u306e\u4e8b\u4f8b\u304c\u898b\u5f53\u305f\u3089\u306a\u304b\u3063\u305f\u306e\u3067\u63b2\u8f09\u3059\u308b\u3002\n\n\u30e6\u30fc\u30b6\u30fc\u30b3\u30f3\u30c8\u30ed\u30fc\u30eb\n\nReportControl.xaml\n<UserControl x:Class=\"Sample.Controls.ReportControl\"\n             xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\n             xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"\n             xmlns:mc=\"http://schemas.openxmlformats.org/markup-compatibility/2006\" \n             xmlns:d=\"http://schemas.microsoft.com/expression/blend/2008\" \n             xmlns:rv=\"clr-namespace:Microsoft.Reporting.WinForms;assembly=Microsoft.ReportViewer.WinForms\"\n             mc:Ignorable=\"d\" \n             d:DesignHeight=\"300\" d:DesignWidth=\"300\">\n    <Grid>\n        <WindowsFormsHost>\n            <rv:ReportViewer x:Name=\"_reportViewer\" />\n        </WindowsFormsHost>\n    </Grid>\n</UserControl>\n\n\n\nReporControl.xaml.cs\nusing Microsoft.Reporting.WinForms;\nusing System.ComponentModel;\nusing System.Windows;\nusing System.Windows.Controls;\n\nnamespace Sample.Controls\n{\n\n    public class  ReportArgument\n    {\n        public ReportDataSource DataSource {get; set;}\n        public string ResourceName {get; set;}\n\n        public ReportArgument (string dataSourceName, \n                object dataSource, string resourceName)\n        {\n            DataSource = new ReportDataSource(dataSourceName, dataSource);\n            ResourceName = resourceName;\n        }\n    }\n\n    /// <summary>\n    /// ReportControl.xaml \u306e\u76f8\u4e92\u4f5c\u7528\u30ed\u30b8\u30c3\u30af\n    /// </summary>\n    public partial class ReportControl : UserControl\n    {\n        /// <summary>\n        /// DataSource\u30d7\u30ed\u30d1\u30c6\u30a3\n        /// </summary>\n        public static readonly DependencyProperty DataSourceProperty =\n                DependencyProperty.Register(\n                \"DataSource\",\n                typeof(object),\n                typeof(ReportControl),\n                new PropertyMetadata(null, ValueChanged)\n            );\n\n        [Bindable(true)]\n        public object DataSource\n        {\n            get { return GetValue(DataSourceProperty); }\n            set { SetValue(DataSourceProperty, value); }\n        }\n\n        public ReportControl()\n        {\n            InitializeComponent();\n        }\n\n        private static void ValueChanged(DependencyObject d, \n                DependencyPropertyChangedEventArgs e)\n        {\n            var obj = (ReportControl)d;\n            var val = e.NewValue as ReportArgument;\n            if (val == null)\n                return;\n\n            obj.SetReportData(val);\n        }\n\n        private void SetReportData(ReportArgument reportData)\n        {\n            if (reportData == null)\n                return;\n\n            var dsrc = _reportViewer.LocalReport.DataSources;\n            while (dsrc.Count > 0)\n                dsrc.RemoveAt(0);\n\n            dsrc.Add(reportData.DataSource);\n            _reportViewer.LocalReport.ReportEmbeddedResource = reportData.ResourceName;\n            _reportViewer.RefreshReport();\n        }\n\n    }\n}\n\n\n\n\n\u4f7f\u3044\u65b9\nReportArgument\u30af\u30e9\u30b9\u3092\u4f7f\u3044\u30c7\u30fc\u30bf\u306e\u3084\u308a\u53d6\u308a\u3092\u884c\u3046\u3002\n\nMainWindowViewModel.cs\n    public class MainWindowViewModel : ViewModel\n    {\n        private DSet DSet = AppContext.Instance.DSet;\n\n        #region ReportData\u5909\u66f4\u901a\u77e5\u30d7\u30ed\u30d1\u30c6\u30a3\n        private ReportArgument _ReportData;\n\n        public ReportArgument ReportData\n        {\n            get\n            { return _ReportData; }\n            set\n            { \n                if (_ReportData == value)\n                    return;\n                _ReportData = value;\n                RaisePropertyChanged();\n            }\n        }\n        #endregion\n\n        public MainWindowViewModel()\n        {\n            ReportData = \n                new ReportArgument(\"DataSet1\", DSet.WK, \n                        \"Sample.Reports.Report.rdlc\");\n        }\n\n        public void Initialize()\n        {\n        }\n    }\n\n\n\n\nMainWindow.xaml\n    <Grid>\n        <Controls:ReportControl DataSource=\"{Binding ReportData}\" />\n    </Grid>\n\n\n#\u306f\u3058\u3081\u306b\nLivet\u3067\u30ec\u30dd\u30fc\u30c8\u3092\u4f5c\u6210\u3059\u308b\u306e\u306b\u7c21\u5358\u306b\u3067\u304d\u306a\u3044\u304b\u691c\u8a0e\u3057\u305f\u304c\u3001UserControl\u3092\u4f7f\u3044\u30d7\u30ed\u30d1\u30c6\u30a3\u3092\u8a2d\u5b9a\u3059\u308b\u3053\u3068\u3067\u6bd4\u8f03\u7684\u7c21\u5358\u306b\u30ec\u30dd\u30fc\u30c8\u3092\u8868\u793a\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u3063\u305f\u3002\n\u30e1\u30c3\u30bb\u30f3\u30b8\u30e3\u30fc\u3067\u3067\u304d\u306a\u3044\u304b\u8abf\u3079\u3066\u307f\u305f\u304cUserControl\u306e\u307b\u3046\u3067\u5b9f\u73fe\u3067\u304d\u305f\u3002\n\u3042\u307e\u308a\u3001Livet\u3067\u306eReportViewer\u306e\u4e8b\u4f8b\u304c\u898b\u5f53\u305f\u3089\u306a\u304b\u3063\u305f\u306e\u3067\u63b2\u8f09\u3059\u308b\u3002\n\n#\u30e6\u30fc\u30b6\u30fc\u30b3\u30f3\u30c8\u30ed\u30fc\u30eb\n\n```xml:ReportControl.xaml\n<UserControl x:Class=\"Sample.Controls.ReportControl\"\n             xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\n             xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"\n             xmlns:mc=\"http://schemas.openxmlformats.org/markup-compatibility/2006\" \n             xmlns:d=\"http://schemas.microsoft.com/expression/blend/2008\" \n             xmlns:rv=\"clr-namespace:Microsoft.Reporting.WinForms;assembly=Microsoft.ReportViewer.WinForms\"\n             mc:Ignorable=\"d\" \n             d:DesignHeight=\"300\" d:DesignWidth=\"300\">\n    <Grid>\n        <WindowsFormsHost>\n            <rv:ReportViewer x:Name=\"_reportViewer\" />\n        </WindowsFormsHost>\n    </Grid>\n</UserControl>\n```\n\n```csharp:ReporControl.xaml.cs\nusing Microsoft.Reporting.WinForms;\nusing System.ComponentModel;\nusing System.Windows;\nusing System.Windows.Controls;\n\nnamespace Sample.Controls\n{\n\n    public class  ReportArgument\n    {\n        public ReportDataSource DataSource {get; set;}\n        public string ResourceName {get; set;}\n\n        public ReportArgument (string dataSourceName, \n                object dataSource, string resourceName)\n\t    {\n            DataSource = new ReportDataSource(dataSourceName, dataSource);\n            ResourceName = resourceName;\n\t    }\n    }\n\n    /// <summary>\n    /// ReportControl.xaml \u306e\u76f8\u4e92\u4f5c\u7528\u30ed\u30b8\u30c3\u30af\n    /// </summary>\n    public partial class ReportControl : UserControl\n    {\n        /// <summary>\n        /// DataSource\u30d7\u30ed\u30d1\u30c6\u30a3\n        /// </summary>\n        public static readonly DependencyProperty DataSourceProperty =\n                DependencyProperty.Register(\n                \"DataSource\",\n                typeof(object),\n                typeof(ReportControl),\n                new PropertyMetadata(null, ValueChanged)\n            );\n\n        [Bindable(true)]\n        public object DataSource\n        {\n            get { return GetValue(DataSourceProperty); }\n            set { SetValue(DataSourceProperty, value); }\n        }\n\n        public ReportControl()\n        {\n            InitializeComponent();\n        }\n\n        private static void ValueChanged(DependencyObject d, \n                DependencyPropertyChangedEventArgs e)\n        {\n            var obj = (ReportControl)d;\n            var val = e.NewValue as ReportArgument;\n            if (val == null)\n                return;\n\n            obj.SetReportData(val);\n        }\n\n        private void SetReportData(ReportArgument reportData)\n        {\n            if (reportData == null)\n                return;\n\n            var dsrc = _reportViewer.LocalReport.DataSources;\n            while (dsrc.Count > 0)\n                dsrc.RemoveAt(0);\n\n            dsrc.Add(reportData.DataSource);\n            _reportViewer.LocalReport.ReportEmbeddedResource = reportData.ResourceName;\n            _reportViewer.RefreshReport();\n        }\n\n    }\n}\n\n```\n\n#\u4f7f\u3044\u65b9\nReportArgument\u30af\u30e9\u30b9\u3092\u4f7f\u3044\u30c7\u30fc\u30bf\u306e\u3084\u308a\u53d6\u308a\u3092\u884c\u3046\u3002\n\n```csharp:MainWindowViewModel.cs\n    public class MainWindowViewModel : ViewModel\n    {\n        private DSet DSet = AppContext.Instance.DSet;\n\n        #region ReportData\u5909\u66f4\u901a\u77e5\u30d7\u30ed\u30d1\u30c6\u30a3\n        private ReportArgument _ReportData;\n\n        public ReportArgument ReportData\n        {\n            get\n            { return _ReportData; }\n            set\n            { \n                if (_ReportData == value)\n                    return;\n                _ReportData = value;\n                RaisePropertyChanged();\n            }\n        }\n        #endregion\n\n        public MainWindowViewModel()\n        {\n            ReportData = \n                new ReportArgument(\"DataSet1\", DSet.WK, \n                        \"Sample.Reports.Report.rdlc\");\n        }\n\n        public void Initialize()\n        {\n        }\n    }\n\n```\n\n```xml:MainWindow.xaml\n    <Grid>\n        <Controls:ReportControl DataSource=\"{Binding ReportData}\" />\n    </Grid>\n```\n", "tags": ["C#", "WPF"]}