{"context": " More than 1 year has passed since last update.\u6b21\u306e\u3088\u3046\u306a\u30c6\u30fc\u30d6\u30eb\u304c\u3042\u3063\u305f\u3068\u3057\u307e\u3059\u3002\nimport sqlalchemy as sa\nfrom sqlalchemy.ext.declarative import declarative_base\n\nbase = declarative_base()\n\nclass Xyz(base):\n    __tablename__ = 'xyz'\n    id = sa.Column(sa.INTEGER, primary_key=True)\n    c1 = sa.Column(sa.INTEGER)\n    c2 = sa.Column(sa.INTEGER)\n    c3 = sa.Column(sa.INTEGER)\n    c4 = sa.Column(sa.INTEGER)\n    c5 = sa.Column(sa.INTEGER)\n    c6 = sa.Column(sa.INTEGER)\n    c7 = sa.Column(sa.INTEGER)\n    c8 = sa.Column(sa.INTEGER)\n    c9 = sa.Column(sa.INTEGER)\n\n    @classmethod\n    def from_c3(cls, n):\n        return session.query(cls).filter_by(c3=n).one()\n\n\u3053\u306e from_c3() \u304c\u6642\u9593\u304c\u304b\u304b\u3063\u3066\u3044\u308b\u5834\u5408\u3001ORM\u304cSQL\u3092\u751f\u6210\u3059\u308b\u306e\u306b\u304b\u304b\u3063\u3066\u3044\u308b\u6642\u9593\u306f\u6b21\u306e\u3088\u3046\u306b\u3057\u3066\u8abf\u3079\u3089\u308c\u307e\u3059\u3002\nfrom sqlalchemy.orm import Query\nfrom timeit import timeit\n\nf1 = lambda: str(Query(Xyz).filter_by(c3=123))\nprint f1()\nprint timeit(f1, number=10000)\n\n'''\u7d50\u679c\nSELECT xyz.id AS xyz_id, xyz.c1 AS xyz_c1, xyz.c2 AS xyz_c2, xyz.c3 AS xyz_c3, xyz.c4 AS xyz_c4, xyz.c5 AS xyz_c5, xyz.c6 AS xyz_c6, xyz.c7 AS xyz_c7, xyz.c8 AS xyz_c8, xyz.c9 AS xyz_c9 \nFROM xyz \nWHERE xyz.c3 = :c3_1\n4.91327404976\n'''\n\n\u3053\u308c\u306b\u6642\u9593\u304c\u304b\u304b\u3063\u3066\u3044\u308b\u5834\u5408\u306f\u3001\u751f\u6210\u3057\u305fSQL\u3092\u30ad\u30e3\u30c3\u30b7\u30e5\u3059\u308b\u3053\u3068\u3067\u30af\u30a8\u30ea\u3092\u9ad8\u901f\u5316\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\ncompiled = str(Query(Xyz).filter_by(c3=sa.bindparam('c3')))\nf2 = lambda: str(Query(Xyz).from_statement(compiled).params(c3=123))\nprint f2()\nprint timeit(f2, number=10000)\n\n'''\u7d50\u679c\nSELECT xyz.id AS xyz_id, xyz.c1 AS xyz_c1, xyz.c2 AS xyz_c2, xyz.c3 AS xyz_c3, xyz.c4 AS xyz_c4, xyz.c5 AS xyz_c5, xyz.c6 AS xyz_c6, xyz.c7 AS xyz_c7, xyz.c8 AS xyz_c8, xyz.c9 AS xyz_c9 \nFROM xyz \nWHERE xyz.c3 = :c3\n1.09750509262\n'''\n\n\u3053\u306eSQL\u751f\u6210\u6642\u9593\u306f\u30b9\u30ad\u30fc\u30de\u306e\u8907\u96d1\u3055\u306b\u4f9d\u5b58\u3059\u308b\u306e\u3067\u3001\u3082\u3063\u3068\u30ab\u30e9\u30e0\u6570\u304c\u591a\u3044\u30c6\u30fc\u30d6\u30eb\u3067\u306f\u3082\u3063\u3068\u6642\u9593\u3092\u7bc0\u7d04\u3067\u304d\u307e\u3059\u3002\n\n\u8ffd\u8a18\nfilter_by(c3=sa.bindparam('c3') \u3088\u308a\u3082 filter('c3=:c3') \u306e\u65b9\u304c\u304a\u624b\u8efd\u3067\u3059\u306d\u3002\n\u6b21\u306e\u3088\u3046\u306a\u30c6\u30fc\u30d6\u30eb\u304c\u3042\u3063\u305f\u3068\u3057\u307e\u3059\u3002\n\n```python\nimport sqlalchemy as sa\nfrom sqlalchemy.ext.declarative import declarative_base\n\nbase = declarative_base()\n\nclass Xyz(base):\n    __tablename__ = 'xyz'\n    id = sa.Column(sa.INTEGER, primary_key=True)\n    c1 = sa.Column(sa.INTEGER)\n    c2 = sa.Column(sa.INTEGER)\n    c3 = sa.Column(sa.INTEGER)\n    c4 = sa.Column(sa.INTEGER)\n    c5 = sa.Column(sa.INTEGER)\n    c6 = sa.Column(sa.INTEGER)\n    c7 = sa.Column(sa.INTEGER)\n    c8 = sa.Column(sa.INTEGER)\n    c9 = sa.Column(sa.INTEGER)\n\n\t@classmethod\n\tdef from_c3(cls, n):\n\t\treturn session.query(cls).filter_by(c3=n).one()\n```\n\n\u3053\u306e ``from_c3()`` \u304c\u6642\u9593\u304c\u304b\u304b\u3063\u3066\u3044\u308b\u5834\u5408\u3001ORM\u304cSQL\u3092\u751f\u6210\u3059\u308b\u306e\u306b\u304b\u304b\u3063\u3066\u3044\u308b\u6642\u9593\u306f\u6b21\u306e\u3088\u3046\u306b\u3057\u3066\u8abf\u3079\u3089\u308c\u307e\u3059\u3002\n\n```python\nfrom sqlalchemy.orm import Query\nfrom timeit import timeit\n\nf1 = lambda: str(Query(Xyz).filter_by(c3=123))\nprint f1()\nprint timeit(f1, number=10000)\n\n'''\u7d50\u679c\nSELECT xyz.id AS xyz_id, xyz.c1 AS xyz_c1, xyz.c2 AS xyz_c2, xyz.c3 AS xyz_c3, xyz.c4 AS xyz_c4, xyz.c5 AS xyz_c5, xyz.c6 AS xyz_c6, xyz.c7 AS xyz_c7, xyz.c8 AS xyz_c8, xyz.c9 AS xyz_c9 \nFROM xyz \nWHERE xyz.c3 = :c3_1\n4.91327404976\n'''\n```\n\n\u3053\u308c\u306b\u6642\u9593\u304c\u304b\u304b\u3063\u3066\u3044\u308b\u5834\u5408\u306f\u3001\u751f\u6210\u3057\u305fSQL\u3092\u30ad\u30e3\u30c3\u30b7\u30e5\u3059\u308b\u3053\u3068\u3067\u30af\u30a8\u30ea\u3092\u9ad8\u901f\u5316\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n```python\ncompiled = str(Query(Xyz).filter_by(c3=sa.bindparam('c3')))\nf2 = lambda: str(Query(Xyz).from_statement(compiled).params(c3=123))\nprint f2()\nprint timeit(f2, number=10000)\n\n'''\u7d50\u679c\nSELECT xyz.id AS xyz_id, xyz.c1 AS xyz_c1, xyz.c2 AS xyz_c2, xyz.c3 AS xyz_c3, xyz.c4 AS xyz_c4, xyz.c5 AS xyz_c5, xyz.c6 AS xyz_c6, xyz.c7 AS xyz_c7, xyz.c8 AS xyz_c8, xyz.c9 AS xyz_c9 \nFROM xyz \nWHERE xyz.c3 = :c3\n1.09750509262\n'''\n```\n\n\u3053\u306eSQL\u751f\u6210\u6642\u9593\u306f\u30b9\u30ad\u30fc\u30de\u306e\u8907\u96d1\u3055\u306b\u4f9d\u5b58\u3059\u308b\u306e\u3067\u3001\u3082\u3063\u3068\u30ab\u30e9\u30e0\u6570\u304c\u591a\u3044\u30c6\u30fc\u30d6\u30eb\u3067\u306f\u3082\u3063\u3068\u6642\u9593\u3092\u7bc0\u7d04\u3067\u304d\u307e\u3059\u3002\n\n## \u8ffd\u8a18\n`filter_by(c3=sa.bindparam('c3')` \u3088\u308a\u3082 `filter('c3=:c3')` \u306e\u65b9\u304c\u304a\u624b\u8efd\u3067\u3059\u306d\u3002\n", "tags": ["sqlalchemy", "Python"]}