{"tags": ["Emscripten", "libvpx", "WebM", "asm.js"], "context": "\n\nemscripten\u3067libvpx.js\u3092\u4f5c\u308b\n\n\u30d3\u30eb\u30c9\u306e\u6d41\u308c\n.o .a \u30a2\u30bb\u30f3\u30d6\u30ea\u3092\u4f5c\u308b\u4ee3\u308f\u308a\u306b --emit-llvm \u3067 llvm bitcode \u3092\u51fa\u529b\u3057\u3001\u305d\u308c\u3092 emcc \u3067 asm.js \u306b\u30d3\u30eb\u30c9\u3059\u308b\n\nconfigure \u3092\u66f8\u304d\u63db\u3048\u308b\n\u53c2\u8003\n\nhttps://bitbucket.org/desmaj/libvpx.js/src/1ea3218282b6eb129061341831d23409dd539054/configure.patch\n\nhttps://chromium.googlesource.com/webm/libvpx/+/904b957ae965bd3d67f15a75cd9db7954f810d33 \u6642\u70b9\u306e\u5834\u5408\u3060\u3068\n\nconfigure.patch\ndiff --git a/build/make/configure.sh b/build/make/configure.sh\nindex ac60f50..f95dbdc 100644\n--- a/build/make/configure.sh\n+++ b/build/make/configure.sh\n@@ -456,7 +456,7 @@ NM=${NM}\n\n CFLAGS  = ${CFLAGS}\n CXXFLAGS  = ${CXXFLAGS}\n-ARFLAGS = -crs\\$(if \\$(quiet),,v)\n+ARFLAGS = crs\\$(if \\$(quiet),,v)\n LDFLAGS = ${LDFLAGS}\n ASFLAGS = ${ASFLAGS}\n extralibs = ${extralibs}\n@@ -1337,6 +1337,22 @@ EOF\n           ;;\n       esac\n       ;;\n+    asmjs-unknown-emscripten)\n+      # echo \"@ \" $toolchain \" = asmjs-unknown-emscripten\"\"\n+      # echo \"@ \" $tgt_isa \"-\" $tgt_os \"-\" $tgt_cc\n+      CC=emcc\n+      LD=llvm-link\n+      AR=llvm-ar\n+      AS=llvm-as\n+      NM=llvm-nm\n+      tune_cflags=\"\"\n+      tune_asflags=\"\"\n+      add_cflags -emit-llvm\n+      #add_ldflags\n+      #add_asflags \n+      disabled multithread\n+      HAVE_GNU_STRIP=no\n+      ;;\n     *-gcc|generic-gnu)\n       link_with_cc=gcc\n       enable_feature gcc\ndiff --git a/configure b/configure\nindex 379c2f4..deb0965 100755\n--- a/configure\n+++ b/configure\n@@ -155,6 +155,7 @@ all_platforms=\"${all_platforms} x86_64-win64-vs11\"\n all_platforms=\"${all_platforms} x86_64-win64-vs12\"\n all_platforms=\"${all_platforms} x86_64-win64-vs14\"\n all_platforms=\"${all_platforms} generic-gnu\"\n+all_platforms=\"${all_platforms} asmjs-unknown-emscripten\"\n\n # all_targets is a list of all targets that can be configured\n # note that these should be in dependency order for now.\n\n\n\u306e\u3088\u3046\u306b\u3059\u308c\u3070\u3088\u3044\n\n\nllvm-ar \u306f ar \u3068\u9055\u3063\u3066\u30aa\u30d7\u30b7\u30e7\u30f3\u306b - \u304c\u3064\u304b\u306a\u3044\n\n\n\u30d3\u30eb\u30c9\u306e\u624b\u9806\n\u53c2\u8003\n\nhttps://bitbucket.org/desmaj/libvpx.js/src/1ea3218282b6eb129061341831d23409dd539054/build.sh\nhttps://github.com/bemasc/Broadway/blob/master/vp8/README\n\n\nbuild.sh\ngit clone https://chromium.googlesource.com/webm/libvpx\ncd libvpx\npatch -p1 -i ./configure.patch\nsource /path/to/emsdk_env.sh\nemsdk activate latest\nemconfigure ./configure \\\n  --disable-optimizations \\\n  --disable-runtime-cpu-detect \\\n  --disable-examples \\\n  --disable-docs \\\n  --disable-vp9 \\\n  --disable-vp8-encoder \\\n  --disable-unit_tests \\\n  --disable-install_bins \\\n  --disable-install_libs \\\n  --disable-encode_perf_tests \\\n  --disable-decode_perf_tests \\\n  --disable-vp8_encoder \\\n  --target=asmjs-unknown-emscripten \\\n  --extra-cflags=\"-O2\"\nemmake make\nexported_functions=\"['_vpx_codec_version_str', '_vpx_codec_dec_init_ver', '_vpx_codec_enc_init_ver', '_vpx_codec_vp8_dx', '_vpx_codec_iface_name', '_vpx_codec_err_to_string', '_vpx_codec_error_detail', '_vpx_codec_error', '_vpx_codec_decode', '_vpx_codec_get_frame', '_vpx_codec_encode', '_vpx_codec_get_cx_data', '_vpx_img_alloc']\"\nemcc \\\n  -s ALLOW_MEMORY_GROWTH=1 \\\n  -s EXPORTED_FUNCTIONS=\"$exported_functions\" \\\n  libvpx.a \\\n  -o libvpx.js\n\n\n\nvp8 \u306e decoder \u3060\u3051\u307b\u3057\u304b\u3063\u305f\u306e\u3067 --disable-vp9 --disable-vp8-encoder \u3092\u3057\u305f\u3002\n\n-s ALLOW_MEMORY_GROWTH=1 \u306e\u4ee3\u308f\u308a\u306b -O2 \u304c\u3067\u304d\u305f\u3089 asm.js\u3000\u306e\u6700\u9069\u5316\u304c\u50cd\u3044\u3066\u5b09\u3057\u3044\n\n\n\nJS \u3068\u306e Interface\n\nJS \u3068\u306e interface \u306e\u4f8b\u306f\u4e0b\u8a18\u304c\u53c2\u8003\u306b\u306a\u308b\u3002 \u5fc5\u8981\u306b\u5fdc\u3058\u3066\u3053\u306e\u3088\u3046\u306a JS \u3092\u66f8\u3044\u3066 --post-js \u3059\u308b\u3068\u3088\u3044\n\n\nhttps://bitbucket.org/desmaj/libvpx.js/src/1ea3218282b6eb129061341831d23409dd539054/epilogue.libvpx.js\nhttps://bitbucket.org/desmaj/libvpx.js/src/1ea3218282b6eb129061341831d23409dd539054/examples/browser/encode.js\n\n\n\n\nlibvpx \u306e\u4f7f\u3044\u65b9\u306b\u3064\u3044\u3066\n\nlibvpx \u305d\u306e\u3082\u306e\u306e\u4f7f\u3044\u65b9\u306f libvpx \u306e\u30ea\u30dd\u30b8\u30c8\u30ea\u306e\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u3084\u30b5\u30f3\u30d7\u30eb\u30b3\u30fc\u30c9\u3092\u8ffd\u3048\u3070\u3088\u3044\n\n\nhttps://chromium.googlesource.com/webm/libvpx/+/904b957ae965bd3d67f15a75cd9db7954f810d33/examples/simple_decoder.c\nhttps://chromium.googlesource.com/webm/libvpx/+/904b957ae965bd3d67f15a75cd9db7954f810d33/usage.dox\nhttps://chromium.googlesource.com/webm/libvpx/+/904b957ae965bd3d67f15a75cd9db7954f810d33/usage_dx.dox\n\n\n\n\nVP8 \u3001 VP9 \u306e \u8a73\u7d30\u306b\u3064\u3044\u3066\n\nVP8\n\n\u5727\u7e2e\u65b9\u5f0f\u3001\u5b9f\u969b\u306e\u30d0\u30a4\u30ca\u30ea\u306e\u683c\u7d0d\u65b9\u5f0f - https://tools.ietf.org/html/rfc6386\n\n\u5727\u7e2e\u306e\u6982\u8981 - http://blog.webmproject.org/2010/07/inside-webm-technology-vp8-intra-and.html\n\n\n\nVP9\n\n\u5727\u7e2e\u65b9\u5f0f\u3001\u5b9f\u969b\u306e\u30d0\u30a4\u30ca\u30ea\u306e\u683c\u7d0d\u65b9\u5f0f - https://storage.googleapis.com/downloads.webmproject.org/docs/vp9/vp9-bitstream-specification-v0.6-20160331-draft.pdf\n\n\u30d0\u30a4\u30ca\u30ea\u306e\u683c\u7d0d\u65b9\u5f0f - http://downloads.webmproject.org/docs/vp9/vp9-bitstream_superframe-and-uncompressed-header_v1.0.pdf\n\n\u6982\u8981 - https://blogs.gnome.org/rbultje/2016/12/13/overview-of-the-vp9-video-codec/\n\n\u6982\u8981 - https://forum.doom9.org/showthread.php?t=168947\n\n\n\nemscripten \u306e\u60c5\u5831\u3092\u5f97\u308b\u306b\u306f\n\n\nhttps://github.com/kripken/emscripten \u3092 clone \u3057\u3066 git grep \u3059\u308b\u3068\u5b66\u3073\u304c\u3042\u308b\n\n\n\nhttps://github.com/kripken/emscripten/tree/master/site/source/docs \u306b\u306f\u307e\u3060\u66f8\u304b\u308c\u3066\u3044\u306a\u3044\u3053\u3068\u3082\u591a\u3044\n\n\n\nhttps://github.com/kripken/emscripten/issues \u3067\u691c\u7d22\u3059\u308b\n\n# emscripten\u3067libvpx.js\u3092\u4f5c\u308b\n\n## \u30d3\u30eb\u30c9\u306e\u6d41\u308c\n\n`.o` `.a` \u30a2\u30bb\u30f3\u30d6\u30ea\u3092\u4f5c\u308b\u4ee3\u308f\u308a\u306b `--emit-llvm` \u3067 llvm bitcode \u3092\u51fa\u529b\u3057\u3001\u305d\u308c\u3092 emcc \u3067 asm.js \u306b\u30d3\u30eb\u30c9\u3059\u308b\n\n## configure \u3092\u66f8\u304d\u63db\u3048\u308b\n\n\u53c2\u8003\n\n* https://bitbucket.org/desmaj/libvpx.js/src/1ea3218282b6eb129061341831d23409dd539054/configure.patch\n\nhttps://chromium.googlesource.com/webm/libvpx/+/904b957ae965bd3d67f15a75cd9db7954f810d33 \u6642\u70b9\u306e\u5834\u5408\u3060\u3068\n\n\n```diff:configure.patch\ndiff --git a/build/make/configure.sh b/build/make/configure.sh\nindex ac60f50..f95dbdc 100644\n--- a/build/make/configure.sh\n+++ b/build/make/configure.sh\n@@ -456,7 +456,7 @@ NM=${NM}\n \n CFLAGS  = ${CFLAGS}\n CXXFLAGS  = ${CXXFLAGS}\n-ARFLAGS = -crs\\$(if \\$(quiet),,v)\n+ARFLAGS = crs\\$(if \\$(quiet),,v)\n LDFLAGS = ${LDFLAGS}\n ASFLAGS = ${ASFLAGS}\n extralibs = ${extralibs}\n@@ -1337,6 +1337,22 @@ EOF\n           ;;\n       esac\n       ;;\n+    asmjs-unknown-emscripten)\n+      # echo \"@ \" $toolchain \" = asmjs-unknown-emscripten\"\"\n+      # echo \"@ \" $tgt_isa \"-\" $tgt_os \"-\" $tgt_cc\n+      CC=emcc\n+      LD=llvm-link\n+      AR=llvm-ar\n+      AS=llvm-as\n+      NM=llvm-nm\n+      tune_cflags=\"\"\n+      tune_asflags=\"\"\n+      add_cflags -emit-llvm\n+      #add_ldflags\n+      #add_asflags \n+      disabled multithread\n+      HAVE_GNU_STRIP=no\n+      ;;\n     *-gcc|generic-gnu)\n       link_with_cc=gcc\n       enable_feature gcc\ndiff --git a/configure b/configure\nindex 379c2f4..deb0965 100755\n--- a/configure\n+++ b/configure\n@@ -155,6 +155,7 @@ all_platforms=\"${all_platforms} x86_64-win64-vs11\"\n all_platforms=\"${all_platforms} x86_64-win64-vs12\"\n all_platforms=\"${all_platforms} x86_64-win64-vs14\"\n all_platforms=\"${all_platforms} generic-gnu\"\n+all_platforms=\"${all_platforms} asmjs-unknown-emscripten\"\n \n # all_targets is a list of all targets that can be configured\n # note that these should be in dependency order for now.\n```\n\n\u306e\u3088\u3046\u306b\u3059\u308c\u3070\u3088\u3044\n\n* `llvm-ar` \u306f `ar` \u3068\u9055\u3063\u3066\u30aa\u30d7\u30b7\u30e7\u30f3\u306b `-` \u304c\u3064\u304b\u306a\u3044\n\n## \u30d3\u30eb\u30c9\u306e\u624b\u9806\n\n\u53c2\u8003\n\n* https://bitbucket.org/desmaj/libvpx.js/src/1ea3218282b6eb129061341831d23409dd539054/build.sh\n* https://github.com/bemasc/Broadway/blob/master/vp8/README\n\n\n```bash:build.sh\ngit clone https://chromium.googlesource.com/webm/libvpx\ncd libvpx\npatch -p1 -i ./configure.patch\nsource /path/to/emsdk_env.sh\nemsdk activate latest\nemconfigure ./configure \\\n  --disable-optimizations \\\n  --disable-runtime-cpu-detect \\\n  --disable-examples \\\n  --disable-docs \\\n  --disable-vp9 \\\n  --disable-vp8-encoder \\\n  --disable-unit_tests \\\n  --disable-install_bins \\\n  --disable-install_libs \\\n  --disable-encode_perf_tests \\\n  --disable-decode_perf_tests \\\n  --disable-vp8_encoder \\\n  --target=asmjs-unknown-emscripten \\\n  --extra-cflags=\"-O2\"\nemmake make\nexported_functions=\"['_vpx_codec_version_str', '_vpx_codec_dec_init_ver', '_vpx_codec_enc_init_ver', '_vpx_codec_vp8_dx', '_vpx_codec_iface_name', '_vpx_codec_err_to_string', '_vpx_codec_error_detail', '_vpx_codec_error', '_vpx_codec_decode', '_vpx_codec_get_frame', '_vpx_codec_encode', '_vpx_codec_get_cx_data', '_vpx_img_alloc']\"\nemcc \\\n  -s ALLOW_MEMORY_GROWTH=1 \\\n  -s EXPORTED_FUNCTIONS=\"$exported_functions\" \\\n  libvpx.a \\\n  -o libvpx.js\n```\n\n* vp8 \u306e decoder \u3060\u3051\u307b\u3057\u304b\u3063\u305f\u306e\u3067 `--disable-vp9` `--disable-vp8-encoder` \u3092\u3057\u305f\u3002\n* `-s ALLOW_MEMORY_GROWTH=1` \u306e\u4ee3\u308f\u308a\u306b `-O2` \u304c\u3067\u304d\u305f\u3089 asm.js\u3000\u306e\u6700\u9069\u5316\u304c\u50cd\u3044\u3066\u5b09\u3057\u3044\n* \n\n## JS \u3068\u306e Interface\n* JS \u3068\u306e interface \u306e\u4f8b\u306f\u4e0b\u8a18\u304c\u53c2\u8003\u306b\u306a\u308b\u3002 \u5fc5\u8981\u306b\u5fdc\u3058\u3066\u3053\u306e\u3088\u3046\u306a JS \u3092\u66f8\u3044\u3066 `--post-js` \u3059\u308b\u3068\u3088\u3044\n  * https://bitbucket.org/desmaj/libvpx.js/src/1ea3218282b6eb129061341831d23409dd539054/epilogue.libvpx.js\n  * https://bitbucket.org/desmaj/libvpx.js/src/1ea3218282b6eb129061341831d23409dd539054/examples/browser/encode.js\n\n## libvpx \u306e\u4f7f\u3044\u65b9\u306b\u3064\u3044\u3066\n\n* libvpx \u305d\u306e\u3082\u306e\u306e\u4f7f\u3044\u65b9\u306f libvpx \u306e\u30ea\u30dd\u30b8\u30c8\u30ea\u306e\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u3084\u30b5\u30f3\u30d7\u30eb\u30b3\u30fc\u30c9\u3092\u8ffd\u3048\u3070\u3088\u3044\n  * https://chromium.googlesource.com/webm/libvpx/+/904b957ae965bd3d67f15a75cd9db7954f810d33/examples/simple_decoder.c\n  * https://chromium.googlesource.com/webm/libvpx/+/904b957ae965bd3d67f15a75cd9db7954f810d33/usage.dox\n  * https://chromium.googlesource.com/webm/libvpx/+/904b957ae965bd3d67f15a75cd9db7954f810d33/usage_dx.dox\n\n\n## VP8 \u3001 VP9 \u306e \u8a73\u7d30\u306b\u3064\u3044\u3066\n\n### VP8\n\n* \u5727\u7e2e\u65b9\u5f0f\u3001\u5b9f\u969b\u306e\u30d0\u30a4\u30ca\u30ea\u306e\u683c\u7d0d\u65b9\u5f0f - https://tools.ietf.org/html/rfc6386\n* \u5727\u7e2e\u306e\u6982\u8981 - http://blog.webmproject.org/2010/07/inside-webm-technology-vp8-intra-and.html\n\n### VP9\n\n* \u5727\u7e2e\u65b9\u5f0f\u3001\u5b9f\u969b\u306e\u30d0\u30a4\u30ca\u30ea\u306e\u683c\u7d0d\u65b9\u5f0f - https://storage.googleapis.com/downloads.webmproject.org/docs/vp9/vp9-bitstream-specification-v0.6-20160331-draft.pdf\n* \u30d0\u30a4\u30ca\u30ea\u306e\u683c\u7d0d\u65b9\u5f0f - http://downloads.webmproject.org/docs/vp9/vp9-bitstream_superframe-and-uncompressed-header_v1.0.pdf\n* \u6982\u8981 - https://blogs.gnome.org/rbultje/2016/12/13/overview-of-the-vp9-video-codec/\n* \u6982\u8981 - https://forum.doom9.org/showthread.php?t=168947\n\n\n### emscripten \u306e\u60c5\u5831\u3092\u5f97\u308b\u306b\u306f\n\n* https://github.com/kripken/emscripten \u3092 clone \u3057\u3066 git grep \u3059\u308b\u3068\u5b66\u3073\u304c\u3042\u308b\n  * https://github.com/kripken/emscripten/tree/master/site/source/docs \u306b\u306f\u307e\u3060\u66f8\u304b\u308c\u3066\u3044\u306a\u3044\u3053\u3068\u3082\u591a\u3044\n* https://github.com/kripken/emscripten/issues \u3067\u691c\u7d22\u3059\u308b\n"}