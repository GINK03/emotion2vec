{"context": "\n\n\u5b9f\u88c5\u7de8\nAzure Notification Hubs \u304b\u3089 Push\u901a\u77e5\u3092\u53d7\u3051\u53d6\u308biOS/Android\u306e\u30a2\u30d7\u30ea\u3092\u5b9f\u88c5\u3057\u3066\u3044\u304d\u307e\u3059\u3002\n\niOS \u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u4f5c\u6210\n\n\nAzure Mobile Services iOS SDK 1.2.4 \u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\nXcode\u3067\u3001iOS \u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092\u4f5c\u6210\n\n\nXcode\u306e\u30e1\u30cb\u30e5\u30fc\u304b\u3089[File]->[New]->[Project...]\u3092\u9078\u629e\n[Single View Application]\u3092\u9078\u629e\u3057\u3001[Next]\u3092\u30af\u30ea\u30c3\u30af\n\u3000\u3000  \n\n[Product Name][Organization Name]\u7b49\u3092\u5165\u529b\u3057\u3001[Next]\u3092\u30af\u30ea\u30c3\u30af\n\n\n\n\n[TARGETS]\u3067\u30bf\u30fc\u30b2\u30c3\u30c8\u306e[Bundle Identifier]\u3092\u3002Apple Developer\u3067\u4f5c\u6210\u3057\u305f\u3082\u306e\u306b\u5909\u66f4\u3001Team\u3092\u9078\u629e\n\n\nProvisioning Profile\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\n\n\nXcode\u306e\u30e1\u30cb\u30e5\u30fc\u304b\u3089 [Prefarences...]\u306e[Accounts]\u3092\u958b\u304f\n\n\n[Apple ID]->[Team]\u3092\u9078\u629e\u3057\u3001[View Details...]\u3092\u958b\u304d\u3001\u4f5c\u6210\u3057\u305f Provisioning Profile\u3000\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\n\u3000\u3000\n\n\n\niOS 1.2.4 SDK\u306e\u8ffd\u52a0\n\n\n\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3057\u305fAzure Mobile Services iOS SDK 1.2.4 \u3000\u3092\u89e3\u51cd\n\n\nXcode\u306e\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306b\u3001WindowsAzureMessaging.framework \u3092\u30c9\u30e9\u30c3\u30b0\u30a2\u30f3\u30c9\u30c9\u30ed\u30c3\u30d7\n[Destination]\u306e[Copy items if needed]\u3092\u30c1\u30a7\u30c3\u30af\u3057\u3001[Finish]\u3092\u30af\u30ea\u30c3\u30af\n\n4.\u3000[WindowsAzureMessaging.framework]\u304c\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306b\u8ffd\u52a0\u3055\u308c\u308b\n\u3000\u3000\u3000\u3000  \n\n\n\n\nSwift\u3067[WindowsAzureMessaging.framework]\u3092\u4f7f\u7528\u3059\u308b\u305f\u3081\u306b\u3001[Objective-C Bridging Header]\u3092\u8ffd\u52a0\n\n\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u540d\u3068\u540c\u3058\u30b0\u30eb\u30fc\u30d7\u3092\u53f3\u30af\u30ea\u30c3\u30af\u3057\u3001[New File...]\u3092\u30af\u30ea\u30c3\u30af\n\n\n[Header File]\u3092\u9078\u629e\u3057\u3001[Next]\u3092\u30af\u30ea\u30c3\u30af\n\n\n\u4efb\u610f\u306e\u30d5\u30a1\u30a4\u30eb\u540d\u3067Header\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u6210\n\n\n[PROJECT]\u3092\u958b\u304d\u3001[Build Settings]\u3067\u3001[Objective-C Bridging Header]\u3092\u691c\u7d22\u3057\u3001\u4f5c\u6210\u3057\u305fHeader\u30d5\u30a1\u30a4\u30eb\u306e\u30d1\u30b9\u3092\u5165\u529b\u3002\u5909\u6570\u3092\u4f7f\u7528\u3057\u3066\u30d1\u30b9\u3092\u6307\u5b9a\u3002\n$(SRCROOT)/$(PROJECT)/AzureMessaging-Bridging-Header.h\n\n\nHeader\u30d5\u30a1\u30a4\u30eb\u306b import\u3092\u8a18\u8ff0\n\n#ifndef AzureMessaging_Bridging_Header_h\n#define AzureMessaging_Bridging_Header_h\n\n#import \"WindowsAzureMessaging/WindowsAzureMessaging.h\"\n\n#endif /* AzureMessaging_Bridging_Header_h */\n\n\n\nAppDelegate\u306b\u3001APNs\u306e\u5b9f\u88c5\u3092\u8ffd\u52a0\n1.\u3000application(_:didRegisterUserNotificationSettings:)\u306b\u3001APNs\u3078\u767b\u9332\nfunc application(application: UIApplication, didRegisterUserNotificationSettings notificationSettings: UIUserNotificationSettings) {\n    // APNs\u3078\u767b\u9332\n    application.registerForRemoteNotifications()\n}\n\n2.\u3000application(_:didRegisterForRemoteNotificationsWithDeviceToken:)\u3067\u3001APNs\u3067\u767a\u884c\u3055\u308c\u308b deviceToken\u3092NotificationHub\u3078\u767b\u9332\n\nSBNotificationHub\u306econnectionString\u306b\u3001Notification Hub\u306e[DefaultFullSharedAccessSignature]\u306e\u6587\u5b57\u5217\u3092\u6307\u5b9a\u3001notificationHubPath\u306b\u3001Notification Hub\u306e\u540d\u524d\u3092\u6307\u5b9a\n\nfunc application(application: UIApplication, didRegisterForRemoteNotificationsWithDeviceToken deviceToken: NSData) {\n    // NotificationHub\u3078\u767b\u9332\n    let hub = SBNotificationHub(\n        connectionString: \"Endpoint=sb://x.servicebus.windows.net/;SharedAccessKeyName=DefaultListenSharedAccessSignature;SharedAccessKey=...\",\n        notificationHubPath: \"AzureNotificationHubsExample\")\n    hub.registerNativeWithDeviceToken(deviceToken, tags: nil) { (error) in\n        if (error != nil) {\n            print(\"Error registering for notifications.\", error)\n        } else {\n            print(\"Success registering for notifications.\", deviceToken)\n        }\n    }\n}\n\n3.\u3000application(_:didReceiveRemoteNotification:)\u3067\u3001APNs\u304b\u3089Push\u901a\u77e5\u3055\u308c\u308b\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u53d7\u3051\u53d6\u308a\u3001\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u304c\u30a2\u30af\u30c6\u30a3\u30d6\u306a\u5834\u5408\u306b\u30a2\u30e9\u30fc\u30c8\u30c0\u30a4\u30a2\u30ed\u30b0\u3092\u8868\u793a\nfunc application(application: UIApplication, didReceiveRemoteNotification userInfo: [NSObject:AnyObject]) {\n    switch (application.applicationState) {\n    case UIApplicationState.Active:\n        let alert = UIAlertController(title: \"\", message: userInfo.description, preferredStyle: .Alert)\n        let defaultAction = UIAlertAction(title: \"OK\", style: .Cancel, handler: nil)\n        alert.addAction(defaultAction)\n        self.window?.rootViewController?.presentViewController(alert, animated: true, completion: nil)\n    case UIApplicationState.Background, UIApplicationState.Inactive:\n        print(userInfo.description)\n    }\n}\n\n\n\n\nAndroid \u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u4f5c\u6210\n\n\nAndroid Studio\u3067\u3001\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u4f5c\u6210\n\n[Application Name][Company Domain][Project Location]\u3092\u5165\u529b\u3057\u3066[Next]\u3092\u30af\u30ea\u30c3\u30af\n\n\n[Empty Activity]\u3092\u9078\u629e\u3057\u3066[Next]\u3092\u30af\u30ea\u30c3\u30af\n\n\n[Activity Name]\u7b49\u306f\u305d\u306e\u307e\u307e\u3067[Finish]\u3092\u30af\u30ea\u30c3\u30af\n\n\n\n\n\nFirebase Cloud Messaging Client SDK\u306e\u8a2d\u5b9a\n1.\u3000\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3057\u305f google-services.json \u3092\u8ffd\u52a0\u3002[Project]\u8868\u793a\u306b\u5207\u308a\u66ff\u3048\u3001[app]\u30e2\u30b8\u30e5\u30fc\u30eb\u306e\u4e0b\u306b\u30b3\u30d4\u30fc\n\n2.\u3000\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306ebuild.gradle\u306e\u5909\u66f4\nbuildscript {\n    // ...\n    dependencies {\n        // ...\n        classpath 'com.google.gms:google-services:3.0.0'\n    }\n}\n\n3.\u3000[app]\u30e2\u30b8\u30e5\u30fc\u30eb\u306ebuild.gradle\u306e\u4fee\u6b63\nandroid {\n  // ...\n}\n\ndependencies {\n  // ...\n  compile 'com.google.firebase:firebase-messaging:9.6.1'\n}\n\n// ADD THIS AT THE BOTTOM\napply plugin: 'com.google.gms.google-services'\n\n4.\u3000Gradle\u306eSync\u3092\u884c\u3046\n\ngradle\u30d5\u30a1\u30a4\u30eb\u306e\u4fee\u6b63\u3057\u305f\u305f\u3081Sync\u3092\u884c\u3046\n\u901a\u77e5\u306e[Sync Now]\u3092\u30af\u30ea\u30c3\u30af \n\n\n\u3082\u3057\u304f\u306f\u3001\u30e1\u30cb\u30e5\u30fc\u306e[File]->[Synchronize]\u3092\u30af\u30ea\u30c3\u30af\n\n\n\nAzure Notification Hubs\u3000\u30e9\u30a4\u30d6\u30e9\u30ea\u306e\u8ffd\u52a0\n1.\u3000[app]\u30e2\u30b8\u30e5\u30fc\u30eb\u306ebuild.grade\u306e dependencies \u306b\u30e9\u30a4\u30d6\u30e9\u30ea\u3092\u8ffd\u52a0\ndependencies {\n  // ...\n  compile 'com.microsoft.azure:notification-hubs-android-sdk:0.4@aar'\n  compile 'com.microsoft.azure:azure-notifications-handler:1.0.1@aar'\n}\n\n2.\u3000\u30e9\u30a4\u30d6\u30e9\u30ea\u306e\u30ea\u30dd\u30b8\u30c8\u30ea\u306e\u6307\u5b9a\u3092repositories\u306b\u8ffd\u52a0\nrepositories {\n    maven {\n        url \"http://dl.bintray.com/microsoftazuremobile/SDK\"\n    }\n}\n\n3.\u3000Gradle\u306eSync\u3092\u884c\u3046\n4.\u3000\u30a8\u30e9\u30fc\u306e\u89e3\u6d88\n\n\u4ee5\u4e0b\u306e\u30a8\u30e9\u30fc\u304c\u767a\u751f\u3059\u308b\u5834\u5408\u3001AndroidManifest.xml\u3092\u4fee\u6b63\u3059\u308b\u5fc5\u8981\u304c\u3042\u308b\n\nError:Execution failed for task ':app:processDebugManifest'.\n> Manifest merger failed : Attribute application@icon value=(@mipmap/ic_launcher) from AndroidManifest.xml:7:9-43\n    is also present at [com.microsoft.azure:azure-notifications-handler:1.0.1] AndroidManifest.xml:13:9-45 value=(@drawable/ic_launcher).\n    Suggestion: add 'tools:replace=\"android:icon\"' to <application> element at AndroidManifest.xml:5:5-18:19 to override.\n\n\nAndroidManifest.xml\u3092\u4fee\u6b63\n\n\nmanifest\u306b xmlns:tools=\"http://schemas.android.com/tools\"\u3092\u8ffd\u52a0\napplication\u306b tools:replace=\"android:icon\"\u3092\u8ffd\u52a0\n\n\n\n<?xml version=\"1.0\" encoding=\"utf-8\"?>\n<manifest xmlns:android=\"http://schemas.android.com/apk/res/android\"\n    xmlns:tools=\"http://schemas.android.com/tools\"\n    package=\"com.example.azure.nh.example\">\n\n<application\n    tools:replace=\"android:icon\"\n\n5.\u3000\u30e1\u30cb\u30e5\u30fc\u306e[Build]->[Make Project]\u3092\u30af\u30ea\u30c3\u30af\u3057\u30d3\u30eb\u30c9\u3092\u884c\u3046\n\n\nFirebase Cloud Messaging(FCM) \u306e\u767b\u9332\u306e\u5b9f\u88c5\u3092\u8ffd\u52a0\n\n\nFCM\u3078\u767b\u9332,token\u306e\u53d6\u5f97\u3068\u3001Azure Notification Hubs \u3078\u306e\u767b\u9332\n\n FirebaseInstanceIdService \u3092\u7d99\u627f\u3057\u305f Service\u30af\u30e9\u30b9\u3092\u4f5c\u6210\n\n\nFCM\u3067Token\u304c\u66f4\u65b0\u3055\u308c\u308b\u3068 onTokenRefresh() \u304c\u547c\u3073\u51fa\u3055\u308c\u308b\u3002\n\nFirebaseInstanceId.getInstance().getToken()\u3067\u3001token\u3092\u53d6\u5f97\u3057\u3001NotificationHub\u3078\u767b\u9332\u3059\u308b\u3002\nNotificationHub\u3092notificationHubPath \u306bNotification Hub\u306e[DefaultFullSharedAccessSignature]\u306e\u6587\u5b57\u5217\u3092\u6307\u5b9a\u3001connectionString\u306b\u3001Notification Hub\u306e\u540d\u524d\u3092\u6307\u5b9a\u3057\u3066\u4f5c\u6210\nNotificationHub.register(pnsHandle); \u3067\u3001token\u3092\u767b\u9332\nRegistration.getRegistrationId(); \u3067\u3001NotificationHub\u306eregistrationId\u3092\u53d6\u5f97\n\n\n\n import com.google.firebase.iid.FirebaseInstanceIdService;\n\n public class MyFirebaseInstanceIDService extends FirebaseInstanceIdService {\n\n     private static final String TAG = MyFirebaseInstanceIDService.class.getSimpleName();\n\n     @Override\n     public void onTokenRefresh() {\n         String refreshedToken = FirebaseInstanceId.getInstance().getToken();\n         Log.d(TAG, \"Refreshed token: \" + refreshedToken);\n\n         sendRegistrationToServer(refreshedToken);\n     }\n\n    private void sendRegistrationToServer(String refreshedToken) {\n        NotificationHub hub = new NotificationHub(\n                \"AzureNotificationHubsExample\",\n                \"Endpoint=sb://x.windows.net/;SharedAccessKeyName=DefaultListenSharedAccessSignature;SharedAccessKey=...\",\n                this);\n\n        try {\n            Registration registration = hub.register(refreshedToken);\n            String registrationId = registration.getRegistrationId();\n\n            Log.d(TAG, \"Registration ID: \" + registrationId);\n        } catch (Exception e) {\n            e.printStackTrace();\n        }\n    }\n }\n\n\n\nAndroidManifest.xml\u306b\u4f5c\u6210\u3057\u305fService\u30af\u30e9\u30b9\u3092\u8ffd\u52a0\n\n\n<intent-filter>\u306b<action android:name=\"com.google.firebase.INSTANCE_ID_EVENT\"/>\u3092\u8a18\u8ff0\n\n     <application\n\n        <!-- [firebase_iid_service] -->\n        <service android:name=\".MyFirebaseInstanceIDService\">\n            <intent-filter>\n                <action android:name=\"com.google.firebase.INSTANCE_ID_EVENT\"/>\n            </intent-filter>\n        </service>\n\n    </application>\n\n\n\n\n\n\u901a\u77e5\u3092\u53d7\u3051\u53d6\u308b\u51e6\u7406\u306e\u5b9f\u88c5\u3092\u8ffd\u52a0\n\n\nFirebaseMessagingService \u3092\u7d99\u627f\u3057\u305f Service\u30af\u30e9\u30b9\u3092\u4f5c\u6210\n\nonMessageReceived() \u3067\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u53d7\u4fe1\nRemoteMessage.getData()\u3067\u3001\u30da\u30a4\u30ed\u30fc\u30c9\u3092\u53d6\u5f97\u3057\u3001Notification\u306b\u8868\u793a\n\npublic class MyFirebaseMessagingService extends FirebaseMessagingService {\n    private static final String TAG = MyFirebaseMessagingService.class.getSimpleName();\n\n    @Override\n    public void onMessageReceived(RemoteMessage remoteMessage) {\n        Log.d(TAG, \"From: \" + remoteMessage.getFrom());\n        if (remoteMessage.getData().size() > 0) {\n            Log.d(TAG, \"Message data payload: \" + remoteMessage.getData());\n\n            notifyNotification(remoteMessage.getData().toString());\n        }\n    }\n\n    private void notifyNotification(String messageBody) {\n\n        NotificationCompat.Builder notificationBuilder = new NotificationCompat.Builder(this)\n                .setContentTitle(\"FCM Message\")\n                .setContentText(messageBody);\n\n        NotificationManager notificationManager =\n                (NotificationManager) getSystemService(Context.NOTIFICATION_SERVICE);\n\n        notificationManager.notify(0, notificationBuilder.build());\n    }\n}\n\n\n\nAndroidManifest.xml\u306b\u4f5c\u6210\u3057\u305fService\u30af\u30e9\u30b9\u3092\u8ffd\u52a0\n\n\n<intent-filter>\u306b<action android:name=\"com.google.firebase.MESSAGING_EVENT\"/>\u3092\u8a18\u8ff0\n\n     <application\n\n        <!-- [firebase_service] -->\n        <service\n            android:name=\".MyFirebaseMessagingService\">\n            <intent-filter>\n                <action android:name=\"com.google.firebase.MESSAGING_EVENT\"/>\n            </intent-filter>\n        </service>\n\n    </application>\n\n\n\n\n\n\nAzure Notification Hubs \u304b\u3089\u901a\u77e5\u3092\u9001\u4fe1\n\n\nAzure \u30dd\u30fc\u30bf\u30eb \u3067\u3001Notification Hubs\u3092\u958b\u304f\n[Test Send]\u3092\u30af\u30ea\u30c3\u30af \n\n\n\n\n\n[Platform]\u306b[Apple]\u3092\u9078\u629e\u3057[Send]\u3092\u30af\u30ea\u30c3\u30af\n\n\n\n\n\n[Platform]\u306b[Apple]\u3092\u9078\u629e\u3057[Send]\u3092\u30af\u30ea\u30c3\u30af\n\n\n\n\n\n[Send]\u306e\u4e0b\u306b\u9001\u4fe1\u7d50\u679c\u304c\u8868\u793a\u3055\u308c\u308b\n\n\n\n\n\n\niOS/Android\u3067\u901a\u77e5\u3092\u53d7\u3051\u53d6\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\n\n\u3053\u308c\u308c\u3067\u3001Azure Notification Hubs\u304b\u3089\u306ePush\u901a\u77e5\u3092\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u304c\u53d7\u3051\u53d6\u308c\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3057\u305f\u3002\n\u6b21\u306f\u3001\u914d\u4fe1\u7de8\u306b\u306a\u308a\u307e\u3059\u3002\n# \u5b9f\u88c5\u7de8\nAzure Notification Hubs \u304b\u3089 Push\u901a\u77e5\u3092\u53d7\u3051\u53d6\u308biOS/Android\u306e\u30a2\u30d7\u30ea\u3092\u5b9f\u88c5\u3057\u3066\u3044\u304d\u307e\u3059\u3002\n\n## iOS \u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u4f5c\u6210\n1. [Azure Mobile Services iOS SDK 1.2.4](https://github.com/Azure/azure-mobile-services/blob/master/CHANGELOG.ios.md#sdk-downloads) \u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\n2. Xcode\u3067\u3001iOS \u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092\u4f5c\u6210\n  1. Xcode\u306e\u30e1\u30cb\u30e5\u30fc\u304b\u3089[File]->[New]->[Project...]\u3092\u9078\u629e\n  2. [Single View Application]\u3092\u9078\u629e\u3057\u3001[Next]\u3092\u30af\u30ea\u30c3\u30af\n\u3000\u3000  ![2016_09_15_17_25.png](https://qiita-image-store.s3.amazonaws.com/0/12177/367899b9-a9ae-616f-63c2-45cad6df141a.png)\n  3. [Product Name][Organization Name]\u7b49\u3092\u5165\u529b\u3057\u3001[Next]\u3092\u30af\u30ea\u30c3\u30af\n    ![2016_09_15_17_27.png](https://qiita-image-store.s3.amazonaws.com/0/12177/2ff7d0d0-9b7a-8586-d5b8-90074c4ae4fa.png)\n3. [TARGETS]\u3067\u30bf\u30fc\u30b2\u30c3\u30c8\u306e[Bundle Identifier]\u3092\u3002Apple Developer\u3067\u4f5c\u6210\u3057\u305f\u3082\u306e\u306b\u5909\u66f4\u3001Team\u3092\u9078\u629e\n  ![2016_09_15_17_28.png](https://qiita-image-store.s3.amazonaws.com/0/12177/7976bd19-5b2e-0244-f228-e9dc3cf379f1.png)\n4. Provisioning Profile\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\n  1. Xcode\u306e\u30e1\u30cb\u30e5\u30fc\u304b\u3089 [Prefarences...]\u306e[Accounts]\u3092\u958b\u304f\n    ![2016_09_13_20_00.png](https://qiita-image-store.s3.amazonaws.com/0/12177/c80ef029-6755-0d83-1898-aaaceb204866.png)\n  2. [Apple ID]->[Team]\u3092\u9078\u629e\u3057\u3001[View Details...]\u3092\u958b\u304d\u3001\u4f5c\u6210\u3057\u305f Provisioning Profile\u3000\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\n  \u3000\u3000![2016_09_13_20_10.png](https://qiita-image-store.s3.amazonaws.com/0/12177/c32421d5-cac0-430a-1a40-1d26c6fc1bba.png)\n5. iOS 1.2.4 SDK\u306e\u8ffd\u52a0\n  1. \u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3057\u305f[Azure Mobile Services iOS SDK 1.2.4](https://github.com/Azure/azure-mobile-services/blob/master/CHANGELOG.ios.md#sdk-downloads) \u3000\u3092\u89e3\u51cd\n    ![2016_09_15_17_31.png](https://qiita-image-store.s3.amazonaws.com/0/12177/7cc63f67-a458-1bab-0e82-6f704bd5d16b.png)\n  2. Xcode\u306e\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306b\u3001WindowsAzureMessaging.framework \u3092\u30c9\u30e9\u30c3\u30b0\u30a2\u30f3\u30c9\u30c9\u30ed\u30c3\u30d7\n  3. [Destination]\u306e[Copy items if needed]\u3092\u30c1\u30a7\u30c3\u30af\u3057\u3001[Finish]\u3092\u30af\u30ea\u30c3\u30af\n    ![2016_09_15_17_48.png](https://qiita-image-store.s3.amazonaws.com/0/12177/2982486e-d935-c0b1-b84f-13ceb61e9acd.png)\n  4.\u3000[WindowsAzureMessaging.framework]\u304c\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306b\u8ffd\u52a0\u3055\u308c\u308b\n\u3000\u3000\u3000\u3000  ![2016_09_15_17_51.png](https://qiita-image-store.s3.amazonaws.com/0/12177/9355d03f-f5d6-008f-5268-2a76f052a228.png)\n6. Swift\u3067[WindowsAzureMessaging.framework]\u3092\u4f7f\u7528\u3059\u308b\u305f\u3081\u306b\u3001[Objective-C Bridging Header]\u3092\u8ffd\u52a0\n  1. \u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u540d\u3068\u540c\u3058\u30b0\u30eb\u30fc\u30d7\u3092\u53f3\u30af\u30ea\u30c3\u30af\u3057\u3001[New File...]\u3092\u30af\u30ea\u30c3\u30af\n    ![2016_09_14_17_38.png](https://qiita-image-store.s3.amazonaws.com/0/12177/fd805a95-a3bf-3e95-3265-6e02b0a35479.png)\n  2. [Header File]\u3092\u9078\u629e\u3057\u3001[Next]\u3092\u30af\u30ea\u30c3\u30af\n    ![2016_09_14_17_39.png](https://qiita-image-store.s3.amazonaws.com/0/12177/85ee1382-625d-f1db-c706-6ff73b4fb75f.png)\n  3. \u4efb\u610f\u306e\u30d5\u30a1\u30a4\u30eb\u540d\u3067Header\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u6210\n    ![2016_09_14_17_40.png](https://qiita-image-store.s3.amazonaws.com/0/12177/0fe90255-045b-5507-4cb0-28ed72356cd0.png)\n  4. [PROJECT]\u3092\u958b\u304d\u3001[Build Settings]\u3067\u3001[Objective-C Bridging Header]\u3092\u691c\u7d22\u3057\u3001\u4f5c\u6210\u3057\u305fHeader\u30d5\u30a1\u30a4\u30eb\u306e\u30d1\u30b9\u3092\u5165\u529b\u3002\u5909\u6570\u3092\u4f7f\u7528\u3057\u3066\u30d1\u30b9\u3092\u6307\u5b9a\u3002\n    ``` $(SRCROOT)/$(PROJECT)/AzureMessaging-Bridging-Header.h ```\n    ![2016_09_14_17_42.png](https://qiita-image-store.s3.amazonaws.com/0/12177/32f2358f-512d-be22-be99-a882759ff0d5.png)\n\n  5. Header\u30d5\u30a1\u30a4\u30eb\u306b import\u3092\u8a18\u8ff0\n\n    ```javascript\n    #ifndef AzureMessaging_Bridging_Header_h\n    #define AzureMessaging_Bridging_Header_h\n       \n    #import \"WindowsAzureMessaging/WindowsAzureMessaging.h\"\n    \n    #endif /* AzureMessaging_Bridging_Header_h */\n    ```\n\n7. AppDelegate\u306b\u3001APNs\u306e\u5b9f\u88c5\u3092\u8ffd\u52a0\n  1.\u3000application(_:didRegisterUserNotificationSettings:)\u306b\u3001APNs\u3078\u767b\u9332\n\n    ```swift\n    func application(application: UIApplication, didRegisterUserNotificationSettings notificationSettings: UIUserNotificationSettings) {\n        // APNs\u3078\u767b\u9332\n        application.registerForRemoteNotifications()\n    }\n    ```\n  2.\u3000application(_:didRegisterForRemoteNotificationsWithDeviceToken:)\u3067\u3001APNs\u3067\u767a\u884c\u3055\u308c\u308b deviceToken\u3092NotificationHub\u3078\u767b\u9332\n    * SBNotificationHub\u306econnectionString\u306b\u3001Notification Hub\u306e[DefaultFullSharedAccessSignature]\u306e\u6587\u5b57\u5217\u3092\u6307\u5b9a\u3001notificationHubPath\u306b\u3001Notification Hub\u306e\u540d\u524d\u3092\u6307\u5b9a\n\n    ```swift\n    func application(application: UIApplication, didRegisterForRemoteNotificationsWithDeviceToken deviceToken: NSData) {\n        // NotificationHub\u3078\u767b\u9332\n        let hub = SBNotificationHub(\n            connectionString: \"Endpoint=sb://x.servicebus.windows.net/;SharedAccessKeyName=DefaultListenSharedAccessSignature;SharedAccessKey=...\",\n            notificationHubPath: \"AzureNotificationHubsExample\")\n        hub.registerNativeWithDeviceToken(deviceToken, tags: nil) { (error) in\n            if (error != nil) {\n                print(\"Error registering for notifications.\", error)\n            } else {\n                print(\"Success registering for notifications.\", deviceToken)\n            }\n        }\n    }\n    ```\n  3.\u3000application(_:didReceiveRemoteNotification:)\u3067\u3001APNs\u304b\u3089Push\u901a\u77e5\u3055\u308c\u308b\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u53d7\u3051\u53d6\u308a\u3001\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u304c\u30a2\u30af\u30c6\u30a3\u30d6\u306a\u5834\u5408\u306b\u30a2\u30e9\u30fc\u30c8\u30c0\u30a4\u30a2\u30ed\u30b0\u3092\u8868\u793a\n\n    ```swift\n    func application(application: UIApplication, didReceiveRemoteNotification userInfo: [NSObject:AnyObject]) {\n        switch (application.applicationState) {\n        case UIApplicationState.Active:\n            let alert = UIAlertController(title: \"\", message: userInfo.description, preferredStyle: .Alert)\n            let defaultAction = UIAlertAction(title: \"OK\", style: .Cancel, handler: nil)\n            alert.addAction(defaultAction)\n            self.window?.rootViewController?.presentViewController(alert, animated: true, completion: nil)\n        case UIApplicationState.Background, UIApplicationState.Inactive:\n            print(userInfo.description)\n        }\n    }\n    ```\n\n\n## Android \u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u4f5c\u6210\n1. Android Studio\u3067\u3001\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u4f5c\u6210\n    1. [Application Name][Company Domain][Project Location]\u3092\u5165\u529b\u3057\u3066[Next]\u3092\u30af\u30ea\u30c3\u30af\n       ![2016_09_16_11_21.png](https://qiita-image-store.s3.amazonaws.com/0/12177/be6325db-3507-7a6b-daaf-ee48307a5425.png)\n    2. [Empty Activity]\u3092\u9078\u629e\u3057\u3066[Next]\u3092\u30af\u30ea\u30c3\u30af\n       ![2016_09_16_11_22.png](https://qiita-image-store.s3.amazonaws.com/0/12177/70eb0f9c-6e3c-6d2a-605c-1058e77da075.png)\n    3. [Activity Name]\u7b49\u306f\u305d\u306e\u307e\u307e\u3067[Finish]\u3092\u30af\u30ea\u30c3\u30af\n       ![2016_09_16_11_23.png](https://qiita-image-store.s3.amazonaws.com/0/12177/372ae8b5-f478-a832-a697-f57a9c0ce311.png)\n\n2. Firebase Cloud Messaging Client SDK\u306e\u8a2d\u5b9a\n  1.\u3000\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3057\u305f google-services.json \u3092\u8ffd\u52a0\u3002[Project]\u8868\u793a\u306b\u5207\u308a\u66ff\u3048\u3001[app]\u30e2\u30b8\u30e5\u30fc\u30eb\u306e\u4e0b\u306b\u30b3\u30d4\u30fc\n    ![2016_09_27_14_34.png](https://qiita-image-store.s3.amazonaws.com/0/12177/4fa7e3f5-e82c-723a-bc43-bacfe128304e.png)\n  2.\u3000\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306ebuild.gradle\u306e\u5909\u66f4\n\n    ```groovy\n    buildscript {\n        // ...\n        dependencies {\n            // ...\n            classpath 'com.google.gms:google-services:3.0.0'\n        }\n    }\n    ```\n  3.\u3000[app]\u30e2\u30b8\u30e5\u30fc\u30eb\u306ebuild.gradle\u306e\u4fee\u6b63\n\n    ```groovy\n    android {\n      // ...\n    }\n    \n    dependencies {\n      // ...\n      compile 'com.google.firebase:firebase-messaging:9.6.1'\n    }\n    \n    // ADD THIS AT THE BOTTOM\n    apply plugin: 'com.google.gms.google-services'\n    ```\n  4.\u3000Gradle\u306eSync\u3092\u884c\u3046\n    * gradle\u30d5\u30a1\u30a4\u30eb\u306e\u4fee\u6b63\u3057\u305f\u305f\u3081Sync\u3092\u884c\u3046\n    * \u901a\u77e5\u306e[Sync Now]\u3092\u30af\u30ea\u30c3\u30af \n      ![2016_09_28_10_36.png](https://qiita-image-store.s3.amazonaws.com/0/12177/a34ade36-ea59-a8db-b7f8-f83e1afa3cca.png)\n    * \u3082\u3057\u304f\u306f\u3001\u30e1\u30cb\u30e5\u30fc\u306e[File]->[Synchronize]\u3092\u30af\u30ea\u30c3\u30af\n\n3. Azure Notification Hubs\u3000\u30e9\u30a4\u30d6\u30e9\u30ea\u306e\u8ffd\u52a0\n  1.\u3000[app]\u30e2\u30b8\u30e5\u30fc\u30eb\u306ebuild.grade\u306e dependencies \u306b\u30e9\u30a4\u30d6\u30e9\u30ea\u3092\u8ffd\u52a0\n\n    ```groovy\n    dependencies {\n      // ...\n      compile 'com.microsoft.azure:notification-hubs-android-sdk:0.4@aar'\n      compile 'com.microsoft.azure:azure-notifications-handler:1.0.1@aar'\n    }\n    ```\n  2.\u3000\u30e9\u30a4\u30d6\u30e9\u30ea\u306e\u30ea\u30dd\u30b8\u30c8\u30ea\u306e\u6307\u5b9a\u3092repositories\u306b\u8ffd\u52a0\n\n    ```groovy\n    repositories {\n        maven {\n            url \"http://dl.bintray.com/microsoftazuremobile/SDK\"\n        }\n    }\n    ```\n  3.\u3000Gradle\u306eSync\u3092\u884c\u3046\n  4.\u3000\u30a8\u30e9\u30fc\u306e\u89e3\u6d88\n    * \u4ee5\u4e0b\u306e\u30a8\u30e9\u30fc\u304c\u767a\u751f\u3059\u308b\u5834\u5408\u3001AndroidManifest.xml\u3092\u4fee\u6b63\u3059\u308b\u5fc5\u8981\u304c\u3042\u308b\n\n    ```sh\n    Error:Execution failed for task ':app:processDebugManifest'.\n    > Manifest merger failed : Attribute application@icon value=(@mipmap/ic_launcher) from AndroidManifest.xml:7:9-43\n    \tis also present at [com.microsoft.azure:azure-notifications-handler:1.0.1] AndroidManifest.xml:13:9-45 value=(@drawable/ic_launcher).\n    \tSuggestion: add 'tools:replace=\"android:icon\"' to <application> element at AndroidManifest.xml:5:5-18:19 to override.\n    ```\n    * AndroidManifest.xml\u3092\u4fee\u6b63\n      * manifest\u306b ```xmlns:tools=\"http://schemas.android.com/tools\"```\u3092\u8ffd\u52a0\n      * application\u306b ```tools:replace=\"android:icon\"```\u3092\u8ffd\u52a0\n\n    ```xml\n    <?xml version=\"1.0\" encoding=\"utf-8\"?>\n    <manifest xmlns:android=\"http://schemas.android.com/apk/res/android\"\n        xmlns:tools=\"http://schemas.android.com/tools\"\n        package=\"com.example.azure.nh.example\">\n\n    <application\n        tools:replace=\"android:icon\"\n    ```\n  5.\u3000\u30e1\u30cb\u30e5\u30fc\u306e[Build]->[Make Project]\u3092\u30af\u30ea\u30c3\u30af\u3057\u30d3\u30eb\u30c9\u3092\u884c\u3046\n\n4. Firebase Cloud Messaging(FCM) \u306e\u767b\u9332\u306e\u5b9f\u88c5\u3092\u8ffd\u52a0\n  1. FCM\u3078\u767b\u9332,token\u306e\u53d6\u5f97\u3068\u3001Azure Notification Hubs \u3078\u306e\u767b\u9332\n     1.  FirebaseInstanceIdService \u3092\u7d99\u627f\u3057\u305f Service\u30af\u30e9\u30b9\u3092\u4f5c\u6210\n         1. FCM\u3067Token\u304c\u66f4\u65b0\u3055\u308c\u308b\u3068 onTokenRefresh() \u304c\u547c\u3073\u51fa\u3055\u308c\u308b\u3002\n         2. ```FirebaseInstanceId.getInstance().getToken()```\u3067\u3001token\u3092\u53d6\u5f97\u3057\u3001NotificationHub\u3078\u767b\u9332\u3059\u308b\u3002\n         3. NotificationHub\u3092notificationHubPath \u306bNotification Hub\u306e[DefaultFullSharedAccessSignature]\u306e\u6587\u5b57\u5217\u3092\u6307\u5b9a\u3001connectionString\u306b\u3001Notification Hub\u306e\u540d\u524d\u3092\u6307\u5b9a\u3057\u3066\u4f5c\u6210\n         4. NotificationHub.register(pnsHandle); \u3067\u3001token\u3092\u767b\u9332\n         5. Registration.getRegistrationId(); \u3067\u3001NotificationHub\u306eregistrationId\u3092\u53d6\u5f97\n\n         ```java\n         import com.google.firebase.iid.FirebaseInstanceIdService;\n\n         public class MyFirebaseInstanceIDService extends FirebaseInstanceIdService {\n\n             private static final String TAG = MyFirebaseInstanceIDService.class.getSimpleName();\n\n             @Override\n             public void onTokenRefresh() {\n                 String refreshedToken = FirebaseInstanceId.getInstance().getToken();\n                 Log.d(TAG, \"Refreshed token: \" + refreshedToken);\n\n                 sendRegistrationToServer(refreshedToken);\n             }\n\n            private void sendRegistrationToServer(String refreshedToken) {\n                NotificationHub hub = new NotificationHub(\n                        \"AzureNotificationHubsExample\",\n                        \"Endpoint=sb://x.windows.net/;SharedAccessKeyName=DefaultListenSharedAccessSignature;SharedAccessKey=...\",\n                        this);\n        \n                try {\n                    Registration registration = hub.register(refreshedToken);\n                    String registrationId = registration.getRegistrationId();\n\n                    Log.d(TAG, \"Registration ID: \" + registrationId);\n                } catch (Exception e) {\n                    e.printStackTrace();\n                }\n            }\n         }\n         ```\n    2. AndroidManifest.xml\u306b\u4f5c\u6210\u3057\u305fService\u30af\u30e9\u30b9\u3092\u8ffd\u52a0\n     * ```<intent-filter>```\u306b```<action android:name=\"com.google.firebase.INSTANCE_ID_EVENT\"/>```\u3092\u8a18\u8ff0\n\n        ```xml\n             <application\n\n                <!-- [firebase_iid_service] -->\n                <service android:name=\".MyFirebaseInstanceIDService\">\n                    <intent-filter>\n                        <action android:name=\"com.google.firebase.INSTANCE_ID_EVENT\"/>\n                    </intent-filter>\n                </service>\n\n            </application>\n        ```\n \n5. \u901a\u77e5\u3092\u53d7\u3051\u53d6\u308b\u51e6\u7406\u306e\u5b9f\u88c5\u3092\u8ffd\u52a0\n  1. FirebaseMessagingService \u3092\u7d99\u627f\u3057\u305f Service\u30af\u30e9\u30b9\u3092\u4f5c\u6210\n     1. onMessageReceived() \u3067\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u53d7\u4fe1\n     2. RemoteMessage.getData()\u3067\u3001\u30da\u30a4\u30ed\u30fc\u30c9\u3092\u53d6\u5f97\u3057\u3001Notification\u306b\u8868\u793a\n\n        ```java\n        public class MyFirebaseMessagingService extends FirebaseMessagingService {\n            private static final String TAG = MyFirebaseMessagingService.class.getSimpleName();\n\n            @Override\n            public void onMessageReceived(RemoteMessage remoteMessage) {\n                Log.d(TAG, \"From: \" + remoteMessage.getFrom());\n                if (remoteMessage.getData().size() > 0) {\n                    Log.d(TAG, \"Message data payload: \" + remoteMessage.getData());\n\n                    notifyNotification(remoteMessage.getData().toString());\n                }\n            }\n\n            private void notifyNotification(String messageBody) {\n\n                NotificationCompat.Builder notificationBuilder = new NotificationCompat.Builder(this)\n                        .setContentTitle(\"FCM Message\")\n                        .setContentText(messageBody);\n\n                NotificationManager notificationManager =\n                        (NotificationManager) getSystemService(Context.NOTIFICATION_SERVICE);\n\n                notificationManager.notify(0, notificationBuilder.build());\n            }\n        }\n        ```\n  2. AndroidManifest.xml\u306b\u4f5c\u6210\u3057\u305fService\u30af\u30e9\u30b9\u3092\u8ffd\u52a0\n     * ```<intent-filter>```\u306b```<action android:name=\"com.google.firebase.MESSAGING_EVENT\"/>```\u3092\u8a18\u8ff0\n\n        ```xml\n             <application\n\n                <!-- [firebase_service] -->\n                <service\n                    android:name=\".MyFirebaseMessagingService\">\n                    <intent-filter>\n                        <action android:name=\"com.google.firebase.MESSAGING_EVENT\"/>\n                    </intent-filter>\n                </service>\n\n            </application>\n        ```\n\n## Azure Notification Hubs \u304b\u3089\u901a\u77e5\u3092\u9001\u4fe1\n\n1. [Azure \u30dd\u30fc\u30bf\u30eb](https://portal.azure.com) \u3067\u3001Notification Hubs\u3092\u958b\u304f\n2. [Test Send]\u3092\u30af\u30ea\u30c3\u30af \n  * ![2016_10_03_12_42.png](https://qiita-image-store.s3.amazonaws.com/0/12177/84492ad9-f4b7-a2d2-a16f-92c9a1178d1d.png)\n3. [Platform]\u306b[Apple]\u3092\u9078\u629e\u3057[Send]\u3092\u30af\u30ea\u30c3\u30af\n  * ![2016_10_03_12_44.png](https://qiita-image-store.s3.amazonaws.com/0/12177/c7048619-c2df-d357-2e91-d46a18aa7ce6.png)\n4. [Platform]\u306b[Apple]\u3092\u9078\u629e\u3057[Send]\u3092\u30af\u30ea\u30c3\u30af\n  * ![2016_10_03_12_49.png](https://qiita-image-store.s3.amazonaws.com/0/12177/4fd2903e-a385-9e9f-6f62-737bf3429677.png)\n5. [Send]\u306e\u4e0b\u306b\u9001\u4fe1\u7d50\u679c\u304c\u8868\u793a\u3055\u308c\u308b\n  * ![2016_10_03_14_32.png](https://qiita-image-store.s3.amazonaws.com/0/12177/cc2c617e-54ab-7c46-c306-3641ee33c578.png)\n  * ![2016_10_03_14_33.png](https://qiita-image-store.s3.amazonaws.com/0/12177/bfa6320b-5b32-c12e-37a2-d1625915616c.png)\n6. iOS/Android\u3067\u901a\u77e5\u3092\u53d7\u3051\u53d6\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\n\n\n\u3053\u308c\u308c\u3067\u3001Azure Notification Hubs\u304b\u3089\u306ePush\u901a\u77e5\u3092\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u304c\u53d7\u3051\u53d6\u308c\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3057\u305f\u3002\n\u6b21\u306f\u3001[\u914d\u4fe1\u7de8](http://qiita.com/granoeste/items/c4f3d7d14b0efcb4b8ec)\u306b\u306a\u308a\u307e\u3059\u3002\n\n", "tags": ["Azure", "APNS", "FCM", "iOS", "Android"]}