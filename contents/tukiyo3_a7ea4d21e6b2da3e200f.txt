{"context": " More than 1 year has passed since last update.\u4ee5\u4e0b\u3067\u6210\u529f\n\nDebian4 i386\nDebian5 i386\nCentOS5 i386\nCentOS6 x86_64\nUbuntu 14.04_64\n\n\n\u53c2\u8003\n\nPhysical to container - OpenVZ Linux Containers Wiki\n\n\n\u79fb\u884c\u3057\u305f\u3044\u30b5\u30fc\u30d0\u306b\u3066\u5b9f\u65bd\n\nqcow2\u30a4\u30e1\u30fc\u30b8\u306e\u5834\u5408KVM - qcow2\u30a4\u30e1\u30fc\u30b8\u306e\u30de\u30a6\u30f3\u30c8 - Qiita\n\n\n\nexcludes.excl\n.bash_history\n/dev/*\n/mnt/*\n/tmp/*\n/proc/*\n/sys/*\n/usr/src/*\n\n\n\u3092\u7528\u610f\u3057\u3001\n\n\u7121\u5727\u7e2e\ntar --numeric-owner -cpf /mnt/mysystem.tar / -X excludes.excl\n\n\n\n/tmp/mysystem.tar \u3092 Proxmox \u306bscp\u3002\n\n\nProxmox\u306b\u3066\u5b9f\u65bd\nmkdir /var/lib/vz/private/233\nmkdir /var/lib/vz/root/233\ncp /etc/vz/conf/{100,233}.conf \n\n\n/etc/vz/conf/233.conf\n- VE_ROOT=\"/var/lib/vz/root/100\"\n- VE_PRIVATE=\"/var/lib/vz/private/100\"\n+ VE_ROOT=\"/var/lib/vz/root/233\"\n+ VE_PRIVATE=\"/var/lib/vz/private/233\"\n\n\ncd /var/lib/vz/private/233\ntar jxf mysystem.tar.bz2\nmkdir proc\n\n\n\n\u30b3\u30f3\u30c6\u30ca\u7528\u4fee\u6b63 (CentOS)\n\nUbuntu\u306f\u4e0b\u306b\u8a18\u8f09\n\n\n\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u4fee\u6b63\n\netc/inittab\nsed -i -e 's@^[0-9].*getty.*tty@#&@g' etc/inittab\n\necho \"1:2345:respawn:/sbin/mingetty tty1\" >> etc/inittab\n\n\n\netc/fstab\nmv etc/fstab{,.old}\negrep '/dev/pts|/dev/shm|/proc|/sys' etc/fstab.old > etc/fstab\n\n\nchroot .\n\n\n/dev\nmknod --mode 666 /dev/ptmx c 5 2\nmkdir /dev/pts\n/sbin/MAKEDEV -d /dev ttyp ptyp\n\nrm -f /dev/null\nmknod --mode 666 /dev/null c 1 3\n\nmknod --mode 444 /dev/urandom c 1 9\n\n\n\nudev\nmkdir /etc/udev/devices\n\n/sbin/MAKEDEV -d /dev {p,t}ty{a,p}{0,1,2,3,4,5,6,7,8,9,a,b,c,d,e,f} console core full kmem kmsg mem null port ptmx random urandom zero ram0\n\n/sbin/MAKEDEV -d /etc/udev/devices {p,t}ty{a,p}{0,1,2,3,4,5,6,7,8,9,a,b,c,d,e,f} console core full kmem kmsg mem null port ptmx random urandom zero ram0\n\n\n\n\u4e0d\u8981\u306a\u30b5\u30fc\u30d3\u30b9\u505c\u6b62\nfor s in \\\n  acpid \\\n  amd \\\n  checkfs \\\n  checkroot \\\n  clock \\\n  consolefont \\\n  hdparm \\\n  klogd \\\n  keymaps \\\n  kudzu \\\n  lm_sensors \\\n  microcodectl \\\n  netplugd \\\n  irqbalance \\\n  auditd \\\n  lvm2-monitor \\\n  ntp\ndo\n  /sbin/chkconfig $s off\ndone\n\n\nOpenVz\u5074\u3067\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u8a2d\u5b9a\u3092\u884c\u3046\u305f\u3081\u4e00\u65e6\u524a\u9664\nrm /etc/sysconfig/network-scripts/ifcfg-bond*\nrm /etc/sysconfig/network-scripts/ifcfg-eth*\n\n\nOSTEMPLATE\u5024\u3092\u4fee\u6b63\n\nOpenVZ - \u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u8a2d\u5b9a\u304c\u3055\u308c\u306a\u3044\u5834\u5408\u306e\u5bfe\u51e6\u6cd5 - Qiita\n\n\nOpenVz\u306e\u30b3\u30f3\u30c6\u30ca\u304b\u3089nfs\u30de\u30a6\u30f3\u30c8\u3057\u305f\u3044\n\nNFS - OpenVZ Linux Containers Wiki\n\n\n/etc/pve/openvz/233.conf\n+ FEATURES=\"nfs:on\"\n\n\n\nOpenVz\u306e\u30b3\u30f3\u30c6\u30ca\u3067nfsd\u3092\u52d5\u304b\u3057\u305f\u3044\n\n/etc/pve/openvz/233.conf\n+ FEATURES=\"nfsd:on\"\n\n\n\n\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u8a2d\u5b9a\u4f8b\n\n/etc/sysconfig/network-scripts/ifcfg-eth0\nDEVICE=\"eth0\"\nONBOOT=yes\nNETBOOT=yes\nIPV6INIT=no\nTYPE=Ethernet\nNAME=\"eth0\"\n\nBOOTPROTO=static\nDNS1=\"8.8.8.8\"\nDNS2=\"8.8.4.4\"\nDOMAIN=local\nIPADDR=192.168.33.11\nNETMASK=255.255.255.0\nGATEWAY=192.168.33.1\n\n\n\n/etc/sysconfig/network-scripts/ifcfg-eth1\nDEVICE=\"eth1\"\nONBOOT=yes\nNETBOOT=yes\nIPV6INIT=no\nTYPE=Ethernet\nNAME=\"eth1\"\n\nBOOTPROTO=static\nIPADDR=192.168.0.11\nNETMASK=255.255.255.0\n\n\n\n\u305d\u306e\u4ed6\n\nLinux - OS\u306e\u30aa\u30f3\u30e9\u30a4\u30f3\u30d0\u30c3\u30af\u30a2\u30c3\u30d7 - Qiita\nOpenVz\u304b\u3089docker\u3078\u306e\u30c7\u30fc\u30bf\u79fb\u884c\u304c\u7c21\u5358\u3060\u3063\u305f - Qiita\nOpenVZ \u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u306e\u4f5c\u6210 - Qiita\n\n\nDebian\u306e\u5834\u5408\n\n\u30b5\u30fc\u30d3\u30b9\u505c\u6b62\n\ndebian\u306e\u5834\u5408\nupdate-rc.d -f \u30b5\u30fc\u30d3\u30b9\u540d remove\n\n\n\n\u4e8b\u524d\u306btemplate\u304b\u3089\u30b3\u30f3\u30c6\u30ca\u4f5c\u6210\nvzctl stop 100\nmv /var/lib/vz/private/100{,.bak}\nmv ./bkup /var/lib/vz/private/100\u2028vzctl start 100\nvzctl enter 100\n\n\n\n\u30b3\u30f3\u30c6\u30ca\u7528\u4fee\u6b63 (Ubuntu)\nmkdir dev tmp proc mnt sys\nchmod 777 tmp\n\n\nresolvconf: Error: /run/resolvconf/interface either does not exist or is not a directory\n\n\n\u5bfe\u51e6\n# crontab -e\n@reboot echo \"nameserver 8.8.8.8\" > /etc/resolv.conf\n\n\n\n\ndf -h \u306e\u7d50\u679c\u304c\u30db\u30b9\u30c8\u306eHDD\u3092\u8868\u793a\u3059\u308b\u5834\u5408\nQuota\u304c\u304a\u304b\u3057\u3044\u3002\n\n\u30db\u30b9\u30c8\u306eHDD\u306e\u5bb9\u91cf\u304c\u8868\u793a\u3055\u308c\u3066\u3044\u308b\uff01\uff01\nroot@container1:/# df -h .\nFilesystem      Size  Used Avail Use% Mounted on\n/dev/simfs      917G  379G  492G  44% /\n\n\n\nQuota\u4fee\u6b63\u624b\u9806\nvzctl stop 391\nvzquota off 391 -f\nvzquota drop 391\nvzquota start 391\n\n\n\n\u6cbb\u3063\u305f\nroot@container1:/# df -h .\nFilesystem      Size  Used Avail Use% Mounted on\n/dev/simfs      330G  260G   71G  79% /\n\n\n\u4ee5\u4e0b\u3067\u6210\u529f\n\n* Debian4 i386\n* Debian5 i386\n* CentOS5 i386\n* CentOS6 x86_64\n* Ubuntu 14.04_64\n\n## \u53c2\u8003\n\n* [Physical to container - OpenVZ Linux Containers Wiki](http://wiki.openvz.org/Physical_to_container)\n\n# \u79fb\u884c\u3057\u305f\u3044\u30b5\u30fc\u30d0\u306b\u3066\u5b9f\u65bd\n\n* qcow2\u30a4\u30e1\u30fc\u30b8\u306e\u5834\u5408[KVM - qcow2\u30a4\u30e1\u30fc\u30b8\u306e\u30de\u30a6\u30f3\u30c8 - Qiita](http://qiita.com/tukiyo3/items/afc601ea72c546edb990)\n\n```bash:excludes.excl\n.bash_history\n/dev/*\n/mnt/*\n/tmp/*\n/proc/*\n/sys/*\n/usr/src/*\n```\n\n\u3092\u7528\u610f\u3057\u3001\n\n```bash:\u7121\u5727\u7e2e\ntar --numeric-owner -cpf /mnt/mysystem.tar / -X excludes.excl\n```\n\n* /tmp/mysystem.tar \u3092 Proxmox \u306bscp\u3002\n\n\n# Proxmox\u306b\u3066\u5b9f\u65bd\n\n```bash:\nmkdir /var/lib/vz/private/233\nmkdir /var/lib/vz/root/233\ncp /etc/vz/conf/{100,233}.conf \n```\n\n```diff:/etc/vz/conf/233.conf\n- VE_ROOT=\"/var/lib/vz/root/100\"\n- VE_PRIVATE=\"/var/lib/vz/private/100\"\n+ VE_ROOT=\"/var/lib/vz/root/233\"\n+ VE_PRIVATE=\"/var/lib/vz/private/233\"\n```\n\n```bash:\ncd /var/lib/vz/private/233\ntar jxf mysystem.tar.bz2\nmkdir proc\n```\n\n----\n\n# \u30b3\u30f3\u30c6\u30ca\u7528\u4fee\u6b63 (CentOS)\n\n* Ubuntu\u306f\u4e0b\u306b\u8a18\u8f09\n\n## \u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u4fee\u6b63\n\n```bash:etc/inittab\nsed -i -e 's@^[0-9].*getty.*tty@#&@g' etc/inittab\n\necho \"1:2345:respawn:/sbin/mingetty tty1\" >> etc/inittab\n```\n\n```bash:etc/fstab\nmv etc/fstab{,.old}\negrep '/dev/pts|/dev/shm|/proc|/sys' etc/fstab.old > etc/fstab\n```\n\n```bash:\nchroot .\n```\n\n```bash:/dev\nmknod --mode 666 /dev/ptmx c 5 2\nmkdir /dev/pts\n/sbin/MAKEDEV -d /dev ttyp ptyp\n\nrm -f /dev/null\nmknod --mode 666 /dev/null c 1 3\n\nmknod --mode 444 /dev/urandom c 1 9\n```\n\n```bash:udev\nmkdir /etc/udev/devices\n\n/sbin/MAKEDEV -d /dev {p,t}ty{a,p}{0,1,2,3,4,5,6,7,8,9,a,b,c,d,e,f} console core full kmem kmsg mem null port ptmx random urandom zero ram0\n\n/sbin/MAKEDEV -d /etc/udev/devices {p,t}ty{a,p}{0,1,2,3,4,5,6,7,8,9,a,b,c,d,e,f} console core full kmem kmsg mem null port ptmx random urandom zero ram0\n```\n\n## \u4e0d\u8981\u306a\u30b5\u30fc\u30d3\u30b9\u505c\u6b62\n\n```bash:\nfor s in \\\n  acpid \\\n  amd \\\n  checkfs \\\n  checkroot \\\n  clock \\\n  consolefont \\\n  hdparm \\\n  klogd \\\n  keymaps \\\n  kudzu \\\n  lm_sensors \\\n  microcodectl \\\n  netplugd \\\n  irqbalance \\\n  auditd \\\n  lvm2-monitor \\\n  ntp\ndo\n  /sbin/chkconfig $s off\ndone\n```\n\n## OpenVz\u5074\u3067\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u8a2d\u5b9a\u3092\u884c\u3046\u305f\u3081\u4e00\u65e6\u524a\u9664\n\n```bash:\nrm /etc/sysconfig/network-scripts/ifcfg-bond*\nrm /etc/sysconfig/network-scripts/ifcfg-eth*\n```\n\n## OSTEMPLATE\u5024\u3092\u4fee\u6b63\n\n* [OpenVZ - \u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u8a2d\u5b9a\u304c\u3055\u308c\u306a\u3044\u5834\u5408\u306e\u5bfe\u51e6\u6cd5 - Qiita](http://qiita.com/tukiyo3/items/ba2bde32a51d5ff7a177)\n\n## OpenVz\u306e\u30b3\u30f3\u30c6\u30ca\u304b\u3089nfs\u30de\u30a6\u30f3\u30c8\u3057\u305f\u3044\n\n* [NFS - OpenVZ Linux Containers Wiki](https://openvz.org/NFS)\n\n```diff:/etc/pve/openvz/233.conf\n+ FEATURES=\"nfs:on\"\n```\n\n## OpenVz\u306e\u30b3\u30f3\u30c6\u30ca\u3067nfsd\u3092\u52d5\u304b\u3057\u305f\u3044\n\n```diff:/etc/pve/openvz/233.conf\n+ FEATURES=\"nfsd:on\"\n```\n\n# \u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u8a2d\u5b9a\u4f8b\n\n```bash:/etc/sysconfig/network-scripts/ifcfg-eth0\nDEVICE=\"eth0\"\nONBOOT=yes\nNETBOOT=yes\nIPV6INIT=no\nTYPE=Ethernet\nNAME=\"eth0\"\n\nBOOTPROTO=static\nDNS1=\"8.8.8.8\"\nDNS2=\"8.8.4.4\"\nDOMAIN=local\nIPADDR=192.168.33.11\nNETMASK=255.255.255.0\nGATEWAY=192.168.33.1\n```\n\n```bash:/etc/sysconfig/network-scripts/ifcfg-eth1\nDEVICE=\"eth1\"\nONBOOT=yes\nNETBOOT=yes\nIPV6INIT=no\nTYPE=Ethernet\nNAME=\"eth1\"\n\nBOOTPROTO=static\nIPADDR=192.168.0.11\nNETMASK=255.255.255.0\n```\n\n\n## \u305d\u306e\u4ed6\n\n* [Linux - OS\u306e\u30aa\u30f3\u30e9\u30a4\u30f3\u30d0\u30c3\u30af\u30a2\u30c3\u30d7 - Qiita](http://qiita.com/tukiyo3/items/b45edbf7fae2bb81a0f3)\n* [OpenVz\u304b\u3089docker\u3078\u306e\u30c7\u30fc\u30bf\u79fb\u884c\u304c\u7c21\u5358\u3060\u3063\u305f - Qiita](http://qiita.com/tukiyo3/items/d9e00f232f3d8d8bcb31)\n* [OpenVZ \u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u306e\u4f5c\u6210 - Qiita](http://qiita.com/yoshi-naoyuki/items/ab70d8653dc02b4a35bd)\n\n# Debian\u306e\u5834\u5408\n\n## \u30b5\u30fc\u30d3\u30b9\u505c\u6b62\n\n```bash:debian\u306e\u5834\u5408\nupdate-rc.d -f \u30b5\u30fc\u30d3\u30b9\u540d remove\n```\n\n## \u4e8b\u524d\u306btemplate\u304b\u3089\u30b3\u30f3\u30c6\u30ca\u4f5c\u6210\n\n```bash:\nvzctl stop 100\nmv /var/lib/vz/private/100{,.bak}\nmv ./bkup /var/lib/vz/private/100\u2028vzctl start 100\nvzctl enter 100\n```\n\n----\n\n# \u30b3\u30f3\u30c6\u30ca\u7528\u4fee\u6b63 (Ubuntu)\n\n```bash:\nmkdir dev tmp proc mnt sys\nchmod 777 tmp\n```\n\n> resolvconf: Error: /run/resolvconf/interface either does not exist or is not a directory\n\n```bash:\u5bfe\u51e6\n# crontab -e\n@reboot echo \"nameserver 8.8.8.8\" > /etc/resolv.conf\n```\n\n----\n\n# df -h \u306e\u7d50\u679c\u304c\u30db\u30b9\u30c8\u306eHDD\u3092\u8868\u793a\u3059\u308b\u5834\u5408\n\nQuota\u304c\u304a\u304b\u3057\u3044\u3002\n\n```bash:\u30db\u30b9\u30c8\u306eHDD\u306e\u5bb9\u91cf\u304c\u8868\u793a\u3055\u308c\u3066\u3044\u308b\uff01\uff01\nroot@container1:/# df -h .\nFilesystem      Size  Used Avail Use% Mounted on\n/dev/simfs      917G  379G  492G  44% /\n```\n\n```bash:Quota\u4fee\u6b63\u624b\u9806\nvzctl stop 391\nvzquota off 391 -f\nvzquota drop 391\nvzquota start 391\n```\n\n```bash:\u6cbb\u3063\u305f\nroot@container1:/# df -h .\nFilesystem      Size  Used Avail Use% Mounted on\n/dev/simfs      330G  260G   71G  79% /\n```\n", "tags": ["OpenVZ", "proxmox"]}