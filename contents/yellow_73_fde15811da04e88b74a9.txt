{"context": " More than 1 year has passed since last update.\n\n\u306f\u3058\u3081\u306b\n\u7a7a\u6e2f\u8fd1\u304f\u306e\u6c34\u5e73\u8868\u9762\u3092\u3064\u304f\u308b\u3067\u3001\u7a7a\u6e2f\u8fd1\u304f\u306b\u8a2d\u5b9a\u3055\u308c\u308b\u5236\u9650\u8868\u9762\u306e\u3046\u3061\u6c34\u5e73\u8868\u9762\u3092\u3056\u3063\u304f\u308a\u4f5c\u308a\u307e\u3057\u305f\u3002\n\u7d9a\u3044\u3066\u9032\u5165\u5e73\u9762\u3092\u4f5c\u3063\u3066\u307f\u3088\u3046\u3068\u601d\u3063\u305f\u306e\u3067\u3059\u304c\u3001\u305f\u3044\u3078\u3093\u306a\u3053\u3068\u304c\u5224\u660e\u3002\u6ed1\u8d70\u8def\u9577\u3068\u6ed1\u8d70\u8def\u5e45\u306f\u3042\u308a\u307e\u3059\u304c\u3001\u6ed1\u8d70\u8def\u306e\u5f62\u72b6\u30c7\u30fc\u30bf\u304c\u7121\u3044\u3068\u3044\u3046\u3002\u306a\u306e\u3067\u3001\u81ea\u5206\u3067\u4f5c\u3063\u3066\u307f\u3088\u3046\u3068\u601d\u3044\u307e\u3059\u3002\n\u305d\u306e\u524d\u6bb5\u968e\u3068\u3057\u3066\u3001\u6ed1\u8d70\u8def\u30c6\u30fc\u30d6\u30eb\u3092\u4f5c\u308a\u3001\u56fd\u571f\u6570\u5024\u60c5\u5831\uff08\u7a7a\u6e2f\uff09\u3092\u305d\u306e\u307e\u307e\u53e9\u304d\u8fbc\u3093\u3060 airport \u30c6\u30fc\u30d6\u30eb\u3068\u30ea\u30ec\u30fc\u30b7\u30e7\u30f3\u3092\u306f\u308a\u307e\u3059\u3002\n\u306a\u304a\u3001\u7a7a\u6e2f\u306b1\u672c\u4ee5\u4e0a\u306e\u6ed1\u8d70\u8def\u304c\u5b58\u5728\u3057\u307e\u3059\u3002\u8907\u6570\u306f\u5341\u5206\u306b\u3042\u308a\u3048\u307e\u3059\u3002\u306a\u306e\u3067\u3001\u4eee\u306b\u6ed1\u8d70\u8def\u3092runway\u3068\u3057\u305f\u3089\u3001airport\u3068runway\u306f1\u5bfe\u591a\u306e\u95a2\u4fc2\u306b\u306a\u308a\u307e\u3059\u3002\n\n\u3054\u6ce8\u610f\n\u4eca\u56de\u306fPostGIS\u5ea6\u304c\u30bc\u30ed\u3067\u3059\u3002\n\n\u524d\u6bb5\u968e\n\n\u6ed1\u8d70\u8def\u30c7\u30fc\u30bf\u306e\u78ba\u8a8d\n\u3068\u308a\u3042\u3048\u305a\u6ed1\u8d70\u8def\u9577\u3068\u6ed1\u8d70\u8def\u5e45\u3092\u898b\u3066\u307f\u307e\u3057\u3087\u3046\u3002\ndb=# SELECT c28_005, c28_012, c28_013 FROM airport WHERE c28_005='\u6771\u4eac\u56fd\u969b\u7a7a\u6e2f';\n   c28_005    |       c28_012       |   c28_013   \n--------------+---------------------+-------------\n \u6771\u4eac\u56fd\u969b\u7a7a\u6e2f | 3000,2500,3360,2500 | 60,60,60,60\n(1 \u884c)\n\n\u5404\u6ed1\u8d70\u8def\u3092\u30b3\u30f3\u30de\u533a\u5207\u308a\u306b\u3057\u305f\u6587\u5b57\u5217\u3067\u53ce\u3081\u3089\u308c\u3066\u3044\u307e\u3059\u3002\u78ba\u304b\u306b\u7fbd\u7530\u7a7a\u6e2f\u306f\u6ed1\u8d70\u8def\u304c4\u672c\u3042\u308a\u307e\u3059\u306d\u3002\n\u76ee\u3067\u78ba\u8a8d\u306f\u3067\u304d\u305f\u3051\u308c\u3069\u3082\u3001\u3053\u306ecsv\u3092\u5206\u96e2\u3057\u3066\u3084\u3089\u306a\u3044\u3068\u30011\u5bfe\u591a\u306erunway\u30c6\u30fc\u30d6\u30eb\u306f\u4f5c\u308c\u307e\u305b\u3093\u3002split\u307f\u305f\u3044\u306a\u3082\u306e\u3092\u4f7f\u3063\u3066\u884c\u306b\u5206\u96e2\u3057\u306a\u3044\u3068\u3044\u3051\u306a\u3044\u3067\u3059\u306d\u3002\n\u306a\u304a\u3001\u3053\u306e\u554f\u984c\u306f\u56fd\u571f\u6570\u5024\u60c5\u5831\u304c\u304a\u304b\u3057\u3044\u3053\u3068\u3092\u3057\u3066\u3044\u308b\u308f\u3051\u3067\u306f\u306a\u304f\u3001\u30b7\u30a7\u30fc\u30d7\u30d5\u30a1\u30a4\u30eb\u3068\u3044\u3046\u30c7\u30fc\u30bf\u66f8\u5f0f\u306e\u9650\u754c\u3067\u3001\u4ed5\u65b9\u306a\u304f\u3053\u3046\u3057\u3066\u3044\u308b\u3088\u3046\u3067\u3059\u3002\u5b9f\u969b\u3001\u540c\u3058zip\u306b\u7d0d\u3081\u3089\u308c\u3066\u3044\u308bGML\u30d5\u30a1\u30a4\u30eb\u3067\u306f\u3001\u6ed1\u8d70\u8def\u304c\u8907\u6570\u3042\u308b\u5834\u5408\u306b\u306fRunway\u8981\u7d20\u304c\u8907\u6570\u73fe\u308c\u308b\u3088\u3046\u306b\u306a\u3063\u3066\u3044\u3066\u3001\u3053\u306e\u3088\u3046\u306a\u30b3\u30f3\u30de\u533a\u5207\u308a\u3067\u306f\u3042\u308a\u307e\u305b\u3093\u3002\n\n\u7d0b\u5225\u7a7a\u6e2f\u306e\u30c1\u30a7\u30c3\u30af\n\u524d\u56de\u3082\u51fa\u3066\u304d\u307e\u3057\u305f\u304c\u3001airport\u30c6\u30fc\u30d6\u30eb\u3067\u306f\u3001\u7d0b\u5225\u7a7a\u6e2f\u306f2\u884c\u306b\u5206\u304b\u308c\u3066\u3044\u307e\u3059\u3002\u6ed1\u8d70\u8def\u95a2\u9023\u3067\u56f0\u308b\u3053\u3068\u306f\u306a\u3044\u304b\u78ba\u8a8d\u3057\u307e\u3059\u3002\ndb=# SELECT c28_005, c28_012, c28_013 FROM airport WHERE c28_005='\u7d0b\u5225\u7a7a\u6e2f';\n c28_005  | c28_012 | c28_013 \n----------+---------+---------\n \u7d0b\u5225\u7a7a\u6e2f | 2000    | 45\n \u7d0b\u5225\u7a7a\u6e2f | 2000    | 45\n(2 \u884c)\n\ndb=# =# SELECT DISTINCT c28_005, c28_012, c28_013 FROM airport WHERE c28_005='\u7d0b\u5225\u7a7a\u6e2f';\n c28_005  | c28_012 | c28_013 \n----------+---------+---------\n \u7d0b\u5225\u7a7a\u6e2f | 2000    | 45\n(1 \u884c)\n\nDISTINCT\u306b\u3059\u308b\u30681\u884c\u306b\u306a\u3063\u305f\u306e\u3067\u3001\u554f\u984c\u306a\u3055\u3052\u3067\u3059\u3002\n\nsplite\u7684\u306a\u95a2\u6570\nregexp_split_to_array, regexp_split_to_table \u304c\u3042\u3066\u306f\u307e\u308a\u307e\u3059\u3002\n\u3069\u3061\u3089\u3082\u6307\u5b9a\u3055\u308c\u305f\u6b63\u898f\u8868\u73fe\u3092\u30c7\u30ea\u30df\u30bf\u3068\u3057\u3066\u7e4b\u304c\u3063\u3066\u3044\u308b\u6587\u5b57\u5217\u3092\u5206\u5272\u3057\u307e\u3059\u3002\u7d50\u679c\u306b\u306f\u30c7\u30ea\u30df\u30bf\u306f\u304f\u3063\u3064\u304d\u307e\u305b\u3093\u3002\nregexp_split_to_array\u306f\u3001\u5206\u5272\u3057\u305f\u7d50\u679c\u3092\u6587\u5b57\u5217\u914d\u5217\u3067\u8fd4\u3057\u3001regexp_split_to_table\u306f\u3001\u6587\u5b57\u5217\u96c6\u5408(setof text)\u3067\u8fd4\u3057\u307e\u3059\u3002\ndb=# SELECT regexp_split_to_table('11,12,13,14', ',');\n regexp_split_to_table \n-----------------------\n 11\n 12\n 13\n 14\n(4 \u884c)\n\ndb=# SELECT regexp_split_to_array('11,12,13,14', ',');\n regexp_split_to_array \n-----------------------\n {11,12,13,14}\n(1 \u884c)\n\n\nregexp_split_to_table\u30922\u30ab\u30e9\u30e0\u3067\u4f7f\u3046\u306e\u3092\u305f\u3081\u3089\u3046\n\u5206\u5272\u81ea\u4f53\u306f\u554f\u984c\u306a\u3055\u305d\u3046\u3067\u3059\u304c\u3001\u4eca\u56de\u306f\u3001\u6ed1\u8d70\u8def\u9577\u3068\u6ed1\u8d70\u8def\u5e45\u306e2\u30ab\u30e9\u30e0\u3067\u540c\u6642\u306b\u5206\u5272\u3057\u306a\u3044\u3068\u3044\u3051\u307e\u305b\u3093\u3002\n\u3053\u3093\u306a\u304b\u3093\u3058\u3067\u3059\u3002\ndb=# SELECT\n  regexp_split_to_table('11,12,13,14',','),\n  regexp_split_to_table('21,22,23,24',',');\n regexp_split_to_table | regexp_split_to_table \n-----------------------+-----------------------\n 11                    | 21\n 12                    | 22\n 13                    | 23\n 14                    | 24\n(4 \u884c)\n\n\u3053\u308c\u3060\u3068\u554f\u984c\u3042\u308a\u307e\u305b\u3093\u3002\u3068\u3053\u308d\u304c\u3001\u6b21\u306e\u5834\u5408\u306f\u3069\u3046\u3067\u3057\u3087\u3046\u3002\ndb=# SELECT\n  regexp_split_to_table('11,12,13,14',','),\n  regexp_split_to_table('21,22,23',',');\n regexp_split_to_table | regexp_split_to_table \n-----------------------+-----------------------\n 11                    | 21\n 12                    | 22\n 13                    | 23\n 14                    | 21\n 11                    | 22\n 12                    | 23\n 13                    | 21\n 14                    | 22\n 11                    | 23\n 12                    | 21\n 13                    | 22\n 14                    | 23\n(12 \u884c)\n\n\u30c7\u30ab\u30eb\u30c8\u7a4d\u306b\u306a\u3063\u3066\u3057\u307e\u3044\u307e\u3059\u3002\n\n\u914d\u5217\u8981\u7d20\u756a\u53f7\u3092\u5f97\u308b\n\u3058\u3083\u3042\u30012\u30ab\u30e9\u30e0\u3067\u914d\u5217\u3092\u751f\u6210\u3057\u3066\u3001\u4e00\u65b9\u306e\u6dfb\u3048\u5b57\u306e\u30b7\u30ea\u30fc\u30ba\u3092\u62bd\u51fa\u3057\u3066\u30eb\u30fc\u30d7\u3092\u56de\u3057\u3066\u3001\u3082\u3046\u4e00\u65b9\u306e\u914d\u5217\u306f\u6dfb\u3048\u5b57\u3092\u4f7f\u3046\u3001\u3068\u3044\u3046\u306e\u304c\u3044\u3044\u304b\u306a\u3001\u3068\u8003\u3048\u307e\u3057\u305f\u3002\n\u914d\u5217\u306e\u6dfb\u3048\u5b57\u306e\u30b7\u30ea\u30fc\u30ba\u3063\u3066\u51fa\u308b\u306e\uff1f\u3068\u601d\u3063\u305f\u3089\u3042\u308a\u307e\u3057\u305f\u3002\ndb=# SELECT generate_subscripts(ARRAY[20,19,21,23,17], 1);\n generate_subscripts \n---------------------\n                   1\n                   2\n                   3\n                   4\n                   5\n(5 \u884c)\n\ngenerate_subscripts\u306e\u7b2c2\u5f15\u6570\u306f\u3001\u6b21\u5143\u3067\u3059\u3002\u4eca\u56de\u306f1\u6b21\u5143\u914d\u5217\u3092\u4f7f\u3063\u3066\u3044\u308b\u306e\u30671\u3057\u304b\u3042\u308a\u3048\u307e\u305b\u3093\u3002\n\u3053\u308c\u3067\u6dfb\u3048\u5b57\u304c\u51fa\u3066\u304f\u308b\u306e\u3067\u3001\u4e2d\u8eab\u3092\u53d6\u308a\u51fa\u3057\u3066\u307f\u307e\u3059\u3002\ndb=# SELECT arr[ix] FROM (\n  SELECT generate_subscripts(arr,1) AS ix, arr\n  FROM (\n    SELECT ARRAY[20,19,21,23,17] AS arr) AS Q1\n  ) AS Q2;\n arr \n-----\n  20\n  19\n  21\n  23\n  17\n(5 \u884c)\n\n2\u30ab\u30e9\u30e0\u3067\u3084\u3063\u3066\u307f\u307e\u3057\u3087\u3046\u3002\ndb=# SELECT ary1[arg] AS e1, ary2[arg] AS e2 FROM (\n  SELECT ary1, ary2, generate_subscripts(ary1, 1) AS arg FROM (\n    SELECT ARRAY[20,19,21,23,17] AS ary1, ARRAY[17,23,21,19,20] AS ary2\n  ) AS Q1\n) AS Q2;\n e1 | e2 \n----+----\n 20 | 17\n 19 | 23\n 21 | 21\n 23 | 19\n 17 | 20\n(5 \u884c)\n\n\u51fa\u307e\u3059\u306d\u3002\n\n\u30af\u30a8\u30ea\u3092\u6bb5\u968e\u7684\u306b\u4f5c\u3063\u3066\u3044\u304f\n\u3067\u306f\u6ed1\u8d70\u8def\u30c6\u30fc\u30d6\u30eb\u306b\u5165\u308c\u308b\u30bf\u30d7\u30eb\u3092\u4f5c\u3063\u3066\u3044\u3063\u3066\u307f\u307e\u3059\u3002\n\u307e\u305a\u3001\u7d0b\u5225\u7a7a\u6e2f\u306e\u91cd\u8907\u3092\u9664\u3044\u3066(DISTINCT)\u3001\u30b3\u30f3\u30de\u533a\u5207\u308a\u6587\u5b57\u5217\u3092\u914d\u5217\u306b\u3057\u307e\u3059\u3002\n```\ndb=# SELECT\n  c28_005,\n  regexp_split_to_array(c28_012, ',') AS arr_length,\n  regexp_split_to_array(c28_013, ',') AS arr_width\nFROM (\n  SELECT DISTINCT c28_005, c28_012, c28_013 FROM airport\n) AS Q1;\n\n\n\nc28_005\narr_length\narr_width\n\n\n\n\n\u5965\u5c3b\u7a7a\u6e2f\n{1500}\n{45}\n\n\n\n...\n \u5927\u962a\u56fd\u969b\u7a7a\u6e2f   | {1828,3000}           | {45,60}\n...\n(96 \u884c)\n```\n\u6b21\u306b\u914d\u5217\u6dfb\u5b57\u96c6\u5408\u3092\u51fa\u3057\u307e\u3059\u3002\u3053\u306e\u6642\u70b9\u3067\u306farr_length, arr_width \u306b\u306f\u4f55\u3082\u3057\u3066\u3044\u307e\u305b\u3093\u3002\ndb=# SELECT\n  c28_005,\n  generate_subscripts(arr_length, 1) AS number,\n  arr_length,\n  arr_width\nFROM (\n  SELECT\n    c28_005,\n    regexp_split_to_array(c28_012, ',') AS arr_length,\n    regexp_split_to_array(c28_013, ',') AS arr_width\n  FROM (\n    SELECT DISTINCT c28_005, c28_012, c28_013 FROM airport\n  ) AS Q1\n) AS Q2;\n\n    c28_005     | number |      arr_length       |   arr_width   \n----------------+--------+-----------------------+---------------\n \u5965\u5c3b\u7a7a\u6e2f       |      1 | {1500}                | {45}\n...\n \u5927\u962a\u56fd\u969b\u7a7a\u6e2f   |      1 | {1828,3000}           | {45,60}\n \u5927\u962a\u56fd\u969b\u7a7a\u6e2f   |      2 | {1828,3000}           | {45,60}\n...\n(107 \u884c)\n\n\u914d\u5217\u6dfb\u5b57(number)\u3092\u4f7f\u3063\u3066\u3001\u914d\u5217\u306e\u8981\u7d20\u3092\u62bd\u51fa\u3057\u305f\u3089\u3067\u304d\u3042\u304c\u308a\u3002\n\u3042\u3068\u3001regexp_split_to_array\u3067\u751f\u6210\u3055\u308c\u308b\u306e\u306f\u6587\u5b57\u5217\u914d\u5217\u3067\u3001\u6700\u7d42\u7684\u306b\u306f\u6574\u6570\u306b\u3057\u305f\u3044\u306e\u3067\u3001\u30ad\u30e3\u30b9\u30c8\u3057\u3061\u3083\u3044\u307e\u3057\u3087\u3046\u3002\ndb=# SELECT \n  c28_005,\n  number,\n  arr_length[number]::INT AS length,\n  arr_width[number]::INT AS width\nFROM (\n  SELECT\n    c28_005,\n    generate_subscripts(arr_length, 1) AS number,\n    arr_length,\n    arr_width\n  FROM (\n    SELECT\n      c28_005,\n      regexp_split_to_array(c28_012, ',') AS arr_length,\n      regexp_split_to_array(c28_013, ',') AS arr_width\n    FROM (\n      SELECT DISTINCT c28_005, c28_012, c28_013 FROM airport\n    ) AS Q1\n  ) AS Q2\n) AS Q3;\n\n    c28_005     | number | length | width \n----------------+--------+--------+-------\n \u5965\u5c3b\u7a7a\u6e2f       |      1 |   1500 |    45\n...\n \u5927\u962a\u56fd\u969b\u7a7a\u6e2f   |      1 |   1828 |    45\n \u5927\u962a\u56fd\u969b\u7a7a\u6e2f   |      2 |   3000 |    60\n...\n(107 \u884c)\n\n\n\u30c6\u30fc\u30d6\u30eb\u306b\u5165\u308c\u308b\n\u307e\u305a\u3001\u30c6\u30fc\u30d6\u30eb\u3092\u4f5c\u308a\u307e\u3059\u3002\npsql\ndb=# CREATE TABLE t_runway (\n  gid SERIAL PRIMARY KEY,\n  name TEXT REFERENCES g_airport(name),\n  number INT,\n  length INT,\n  width INT,\n  UNIQUE (name, number)\n);\n\n\u633f\u5165\u3057\u307e\u3059\u3002\ndb=# INSERT INTO t_runway (name, number, length, width)\nSELECT \n  c28_005,\n  number,\n  arr_length[number]::INT AS length,\n  arr_width[number]::INT AS width\nFROM (\n  SELECT\n    c28_005,\n    generate_subscripts(arr_length, 1) AS number,\n    arr_length,\n    arr_width\n  FROM (\n    SELECT\n      c28_005,\n      regexp_split_to_array(c28_012, ',') AS arr_length,\n      regexp_split_to_array(c28_013, ',') AS arr_width\n    FROM (\n      SELECT DISTINCT c28_005, c28_012, c28_013 FROM airport\n    ) AS Q1\n  ) AS Q2\n) AS Q3;\n\nINSERT 0 107\n\n\u6700\u5f8c\u306b\u30c6\u30fc\u30d6\u30eb\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\ndb=# SELECT * FROM t_runway;\n gid |      name      | number | length | width \n-----+----------------+--------+--------+-------\n  16 | \u5965\u5c3b\u7a7a\u6e2f       |      1 |   1500 |    45\n  17 | \u65b0\u5343\u6b73\u7a7a\u6e2f     |      1 |   3000 |    60\n  18 | \u65b0\u5343\u6b73\u7a7a\u6e2f     |      2 |   3000 |    60\n  19 | \u798f\u4e95\u7a7a\u6e2f       |      1 |   1200 |    30\n  20 | \u4e0b\u5730\u5cf6\u7a7a\u6e2f     |      1 |   3000 |    60\n  21 | \u5e83\u5cf6\u7a7a\u6e2f       |      1 |   3000 |    60\n  22 | \u4e09\u6ca2\u98db\u884c\u5834     |      1 |   3050 |    45\n...\n(107 \u884c)\n\n\n\u304a\u308f\u308a\u306b\nregexp_split_to_array\u3068generate_subscripts\u3092\u4f7f\u3063\u3066\u30012\u30ab\u30e9\u30e0\u306e\u6587\u5b57\u5217\u3092\u5206\u5272\u3057\u3066\u30c6\u30fc\u30d6\u30eb\u306b\u7d0d\u3081\u307e\u3057\u305f\u3002\n\u6587\u5b57\u5217\u5206\u5272\u306f\u3067\u304d\u308c\u3070\u907f\u3051\u305f\u3044\u3068\u3053\u308d\u3067\u3059\u304c\u3001\u30a4\u30f3\u30dd\u30fc\u30c8\u5143\u306e\u66f8\u5f0f\u306e\u5236\u7d04\u304b\u3089\u3001\u5206\u5272\u305b\u3056\u308b\u3092\u3048\u306a\u3044\u5834\u5408\u3082\u3042\u308a\u307e\u3059\u3002\u305d\u3046\u3044\u3063\u305f\u5834\u5408\u3067\u3082PostgreSQL\u306f\u3001\u305d\u3046\u3044\u3063\u305f\u3053\u3068\u306b\u3082\u5bfe\u5fdc\u3057\u3066\u304f\u308c\u307e\u3057\u305f\u3002\n\u6b21\u56de\u306f\u3001QGIS\u3068\u9023\u643a\u3057\u3066\u81ea\u529b\u3067\u6ed1\u8d70\u8def\u3092\u4f5c\u3063\u3066\u3001\u9032\u5165\u8868\u9762\u3092\u4f5c\u308b\u306e\u304b\u2026\u3002\n# \u306f\u3058\u3081\u306b\n\n[\u7a7a\u6e2f\u8fd1\u304f\u306e\u6c34\u5e73\u8868\u9762\u3092\u3064\u304f\u308b](http://qiita.com/yellow_73/items/9ed131a71707353ba005)\u3067\u3001\u7a7a\u6e2f\u8fd1\u304f\u306b\u8a2d\u5b9a\u3055\u308c\u308b\u5236\u9650\u8868\u9762\u306e\u3046\u3061\u6c34\u5e73\u8868\u9762\u3092\u3056\u3063\u304f\u308a\u4f5c\u308a\u307e\u3057\u305f\u3002\n\n\u7d9a\u3044\u3066\u9032\u5165\u5e73\u9762\u3092\u4f5c\u3063\u3066\u307f\u3088\u3046\u3068\u601d\u3063\u305f\u306e\u3067\u3059\u304c\u3001\u305f\u3044\u3078\u3093\u306a\u3053\u3068\u304c\u5224\u660e\u3002\u6ed1\u8d70\u8def\u9577\u3068\u6ed1\u8d70\u8def\u5e45\u306f\u3042\u308a\u307e\u3059\u304c\u3001\u6ed1\u8d70\u8def\u306e\u5f62\u72b6\u30c7\u30fc\u30bf\u304c\u7121\u3044\u3068\u3044\u3046\u3002\u306a\u306e\u3067\u3001\u81ea\u5206\u3067\u4f5c\u3063\u3066\u307f\u3088\u3046\u3068\u601d\u3044\u307e\u3059\u3002\n\n\u305d\u306e\u524d\u6bb5\u968e\u3068\u3057\u3066\u3001\u6ed1\u8d70\u8def\u30c6\u30fc\u30d6\u30eb\u3092\u4f5c\u308a\u3001\u56fd\u571f\u6570\u5024\u60c5\u5831\uff08\u7a7a\u6e2f\uff09\u3092\u305d\u306e\u307e\u307e\u53e9\u304d\u8fbc\u3093\u3060 ``airport`` \u30c6\u30fc\u30d6\u30eb\u3068\u30ea\u30ec\u30fc\u30b7\u30e7\u30f3\u3092\u306f\u308a\u307e\u3059\u3002\n\n\u306a\u304a\u3001\u7a7a\u6e2f\u306b1\u672c\u4ee5\u4e0a\u306e\u6ed1\u8d70\u8def\u304c\u5b58\u5728\u3057\u307e\u3059\u3002\u8907\u6570\u306f\u5341\u5206\u306b\u3042\u308a\u3048\u307e\u3059\u3002\u306a\u306e\u3067\u3001\u4eee\u306b\u6ed1\u8d70\u8def\u3092runway\u3068\u3057\u305f\u3089\u3001airport\u3068runway\u306f1\u5bfe\u591a\u306e\u95a2\u4fc2\u306b\u306a\u308a\u307e\u3059\u3002\n\n## \u3054\u6ce8\u610f\n\n\u4eca\u56de\u306fPostGIS\u5ea6\u304c\u30bc\u30ed\u3067\u3059\u3002\n\n# \u524d\u6bb5\u968e\n\n## \u6ed1\u8d70\u8def\u30c7\u30fc\u30bf\u306e\u78ba\u8a8d\n\n\u3068\u308a\u3042\u3048\u305a\u6ed1\u8d70\u8def\u9577\u3068\u6ed1\u8d70\u8def\u5e45\u3092\u898b\u3066\u307f\u307e\u3057\u3087\u3046\u3002\n\n```psql\ndb=# SELECT c28_005, c28_012, c28_013 FROM airport WHERE c28_005='\u6771\u4eac\u56fd\u969b\u7a7a\u6e2f';\n   c28_005    |       c28_012       |   c28_013   \n--------------+---------------------+-------------\n \u6771\u4eac\u56fd\u969b\u7a7a\u6e2f | 3000,2500,3360,2500 | 60,60,60,60\n(1 \u884c)\n```\n\n\u5404\u6ed1\u8d70\u8def\u3092\u30b3\u30f3\u30de\u533a\u5207\u308a\u306b\u3057\u305f\u6587\u5b57\u5217\u3067\u53ce\u3081\u3089\u308c\u3066\u3044\u307e\u3059\u3002\u78ba\u304b\u306b\u7fbd\u7530\u7a7a\u6e2f\u306f\u6ed1\u8d70\u8def\u304c4\u672c\u3042\u308a\u307e\u3059\u306d\u3002\n\n\u76ee\u3067\u78ba\u8a8d\u306f\u3067\u304d\u305f\u3051\u308c\u3069\u3082\u3001\u3053\u306ecsv\u3092\u5206\u96e2\u3057\u3066\u3084\u3089\u306a\u3044\u3068\u30011\u5bfe\u591a\u306erunway\u30c6\u30fc\u30d6\u30eb\u306f\u4f5c\u308c\u307e\u305b\u3093\u3002split\u307f\u305f\u3044\u306a\u3082\u306e\u3092\u4f7f\u3063\u3066\u884c\u306b\u5206\u96e2\u3057\u306a\u3044\u3068\u3044\u3051\u306a\u3044\u3067\u3059\u306d\u3002\n\n\u306a\u304a\u3001\u3053\u306e\u554f\u984c\u306f\u56fd\u571f\u6570\u5024\u60c5\u5831\u304c\u304a\u304b\u3057\u3044\u3053\u3068\u3092\u3057\u3066\u3044\u308b\u308f\u3051\u3067\u306f\u306a\u304f\u3001\u30b7\u30a7\u30fc\u30d7\u30d5\u30a1\u30a4\u30eb\u3068\u3044\u3046\u30c7\u30fc\u30bf\u66f8\u5f0f\u306e\u9650\u754c\u3067\u3001\u4ed5\u65b9\u306a\u304f\u3053\u3046\u3057\u3066\u3044\u308b\u3088\u3046\u3067\u3059\u3002\u5b9f\u969b\u3001\u540c\u3058zip\u306b\u7d0d\u3081\u3089\u308c\u3066\u3044\u308bGML\u30d5\u30a1\u30a4\u30eb\u3067\u306f\u3001\u6ed1\u8d70\u8def\u304c\u8907\u6570\u3042\u308b\u5834\u5408\u306b\u306fRunway\u8981\u7d20\u304c\u8907\u6570\u73fe\u308c\u308b\u3088\u3046\u306b\u306a\u3063\u3066\u3044\u3066\u3001\u3053\u306e\u3088\u3046\u306a\u30b3\u30f3\u30de\u533a\u5207\u308a\u3067\u306f\u3042\u308a\u307e\u305b\u3093\u3002\n\n## \u7d0b\u5225\u7a7a\u6e2f\u306e\u30c1\u30a7\u30c3\u30af\n\n\u524d\u56de\u3082\u51fa\u3066\u304d\u307e\u3057\u305f\u304c\u3001``airport``\u30c6\u30fc\u30d6\u30eb\u3067\u306f\u3001\u7d0b\u5225\u7a7a\u6e2f\u306f2\u884c\u306b\u5206\u304b\u308c\u3066\u3044\u307e\u3059\u3002\u6ed1\u8d70\u8def\u95a2\u9023\u3067\u56f0\u308b\u3053\u3068\u306f\u306a\u3044\u304b\u78ba\u8a8d\u3057\u307e\u3059\u3002\n\n```psql\ndb=# SELECT c28_005, c28_012, c28_013 FROM airport WHERE c28_005='\u7d0b\u5225\u7a7a\u6e2f';\n c28_005  | c28_012 | c28_013 \n----------+---------+---------\n \u7d0b\u5225\u7a7a\u6e2f | 2000    | 45\n \u7d0b\u5225\u7a7a\u6e2f | 2000    | 45\n(2 \u884c)\n\ndb=# =# SELECT DISTINCT c28_005, c28_012, c28_013 FROM airport WHERE c28_005='\u7d0b\u5225\u7a7a\u6e2f';\n c28_005  | c28_012 | c28_013 \n----------+---------+---------\n \u7d0b\u5225\u7a7a\u6e2f | 2000    | 45\n(1 \u884c)\n```\n\nDISTINCT\u306b\u3059\u308b\u30681\u884c\u306b\u306a\u3063\u305f\u306e\u3067\u3001\u554f\u984c\u306a\u3055\u3052\u3067\u3059\u3002\n\n# splite\u7684\u306a\u95a2\u6570\n\nregexp_split_to_array, regexp_split_to_table \u304c\u3042\u3066\u306f\u307e\u308a\u307e\u3059\u3002\n\n\u3069\u3061\u3089\u3082\u6307\u5b9a\u3055\u308c\u305f\u6b63\u898f\u8868\u73fe\u3092\u30c7\u30ea\u30df\u30bf\u3068\u3057\u3066\u7e4b\u304c\u3063\u3066\u3044\u308b\u6587\u5b57\u5217\u3092\u5206\u5272\u3057\u307e\u3059\u3002\u7d50\u679c\u306b\u306f\u30c7\u30ea\u30df\u30bf\u306f\u304f\u3063\u3064\u304d\u307e\u305b\u3093\u3002\n\nregexp_split_to_array\u306f\u3001\u5206\u5272\u3057\u305f\u7d50\u679c\u3092\u6587\u5b57\u5217\u914d\u5217\u3067\u8fd4\u3057\u3001regexp_split_to_table\u306f\u3001\u6587\u5b57\u5217\u96c6\u5408(setof text)\u3067\u8fd4\u3057\u307e\u3059\u3002\n\n```psql\ndb=# SELECT regexp_split_to_table('11,12,13,14', ',');\n regexp_split_to_table \n-----------------------\n 11\n 12\n 13\n 14\n(4 \u884c)\n\ndb=# SELECT regexp_split_to_array('11,12,13,14', ',');\n regexp_split_to_array \n-----------------------\n {11,12,13,14}\n(1 \u884c)\n```\n\n## regexp_split_to_table\u30922\u30ab\u30e9\u30e0\u3067\u4f7f\u3046\u306e\u3092\u305f\u3081\u3089\u3046\n\n\u5206\u5272\u81ea\u4f53\u306f\u554f\u984c\u306a\u3055\u305d\u3046\u3067\u3059\u304c\u3001\u4eca\u56de\u306f\u3001\u6ed1\u8d70\u8def\u9577\u3068\u6ed1\u8d70\u8def\u5e45\u306e2\u30ab\u30e9\u30e0\u3067\u540c\u6642\u306b\u5206\u5272\u3057\u306a\u3044\u3068\u3044\u3051\u307e\u305b\u3093\u3002\n\n\u3053\u3093\u306a\u304b\u3093\u3058\u3067\u3059\u3002\n\n```psql\ndb=# SELECT\n  regexp_split_to_table('11,12,13,14',','),\n  regexp_split_to_table('21,22,23,24',',');\n regexp_split_to_table | regexp_split_to_table \n-----------------------+-----------------------\n 11                    | 21\n 12                    | 22\n 13                    | 23\n 14                    | 24\n(4 \u884c)\n```\n\n\u3053\u308c\u3060\u3068\u554f\u984c\u3042\u308a\u307e\u305b\u3093\u3002\u3068\u3053\u308d\u304c\u3001\u6b21\u306e\u5834\u5408\u306f\u3069\u3046\u3067\u3057\u3087\u3046\u3002\n\n```psql\ndb=# SELECT\n  regexp_split_to_table('11,12,13,14',','),\n  regexp_split_to_table('21,22,23',',');\n regexp_split_to_table | regexp_split_to_table \n-----------------------+-----------------------\n 11                    | 21\n 12                    | 22\n 13                    | 23\n 14                    | 21\n 11                    | 22\n 12                    | 23\n 13                    | 21\n 14                    | 22\n 11                    | 23\n 12                    | 21\n 13                    | 22\n 14                    | 23\n(12 \u884c)\n```\n\n\u30c7\u30ab\u30eb\u30c8\u7a4d\u306b\u306a\u3063\u3066\u3057\u307e\u3044\u307e\u3059\u3002\n\n\n## \u914d\u5217\u8981\u7d20\u756a\u53f7\u3092\u5f97\u308b\n\n\u3058\u3083\u3042\u30012\u30ab\u30e9\u30e0\u3067\u914d\u5217\u3092\u751f\u6210\u3057\u3066\u3001\u4e00\u65b9\u306e\u6dfb\u3048\u5b57\u306e\u30b7\u30ea\u30fc\u30ba\u3092\u62bd\u51fa\u3057\u3066\u30eb\u30fc\u30d7\u3092\u56de\u3057\u3066\u3001\u3082\u3046\u4e00\u65b9\u306e\u914d\u5217\u306f\u6dfb\u3048\u5b57\u3092\u4f7f\u3046\u3001\u3068\u3044\u3046\u306e\u304c\u3044\u3044\u304b\u306a\u3001\u3068\u8003\u3048\u307e\u3057\u305f\u3002\n\n\u914d\u5217\u306e\u6dfb\u3048\u5b57\u306e\u30b7\u30ea\u30fc\u30ba\u3063\u3066\u51fa\u308b\u306e\uff1f\u3068\u601d\u3063\u305f\u3089\u3042\u308a\u307e\u3057\u305f\u3002\n\n```psql\ndb=# SELECT generate_subscripts(ARRAY[20,19,21,23,17], 1);\n generate_subscripts \n---------------------\n                   1\n                   2\n                   3\n                   4\n                   5\n(5 \u884c)\n```\n\n``generate_subscripts``\u306e\u7b2c2\u5f15\u6570\u306f\u3001\u6b21\u5143\u3067\u3059\u3002\u4eca\u56de\u306f1\u6b21\u5143\u914d\u5217\u3092\u4f7f\u3063\u3066\u3044\u308b\u306e\u30671\u3057\u304b\u3042\u308a\u3048\u307e\u305b\u3093\u3002\n\n\u3053\u308c\u3067\u6dfb\u3048\u5b57\u304c\u51fa\u3066\u304f\u308b\u306e\u3067\u3001\u4e2d\u8eab\u3092\u53d6\u308a\u51fa\u3057\u3066\u307f\u307e\u3059\u3002\n\n```psql\ndb=# SELECT arr[ix] FROM (\n  SELECT generate_subscripts(arr,1) AS ix, arr\n  FROM (\n    SELECT ARRAY[20,19,21,23,17] AS arr) AS Q1\n  ) AS Q2;\n arr \n-----\n  20\n  19\n  21\n  23\n  17\n(5 \u884c)\n```\n\n2\u30ab\u30e9\u30e0\u3067\u3084\u3063\u3066\u307f\u307e\u3057\u3087\u3046\u3002\n\n```psql\ndb=# SELECT ary1[arg] AS e1, ary2[arg] AS e2 FROM (\n  SELECT ary1, ary2, generate_subscripts(ary1, 1) AS arg FROM (\n    SELECT ARRAY[20,19,21,23,17] AS ary1, ARRAY[17,23,21,19,20] AS ary2\n  ) AS Q1\n) AS Q2;\n e1 | e2 \n----+----\n 20 | 17\n 19 | 23\n 21 | 21\n 23 | 19\n 17 | 20\n(5 \u884c)\n```\n\n\u51fa\u307e\u3059\u306d\u3002\n\n# \u30af\u30a8\u30ea\u3092\u6bb5\u968e\u7684\u306b\u4f5c\u3063\u3066\u3044\u304f\n\n\u3067\u306f\u6ed1\u8d70\u8def\u30c6\u30fc\u30d6\u30eb\u306b\u5165\u308c\u308b\u30bf\u30d7\u30eb\u3092\u4f5c\u3063\u3066\u3044\u3063\u3066\u307f\u307e\u3059\u3002\n\n\u307e\u305a\u3001\u7d0b\u5225\u7a7a\u6e2f\u306e\u91cd\u8907\u3092\u9664\u3044\u3066(DISTINCT)\u3001\u30b3\u30f3\u30de\u533a\u5207\u308a\u6587\u5b57\u5217\u3092\u914d\u5217\u306b\u3057\u307e\u3059\u3002\n```\ndb=# SELECT\n  c28_005,\n  regexp_split_to_array(c28_012, ',') AS arr_length,\n  regexp_split_to_array(c28_013, ',') AS arr_width\nFROM (\n  SELECT DISTINCT c28_005, c28_012, c28_013 FROM airport\n) AS Q1;\n\n    c28_005     |      arr_length       |   arr_width   \n----------------+-----------------------+---------------\n \u5965\u5c3b\u7a7a\u6e2f       | {1500}                | {45}\n...\n \u5927\u962a\u56fd\u969b\u7a7a\u6e2f   | {1828,3000}           | {45,60}\n...\n(96 \u884c)\n```\n\n\u6b21\u306b\u914d\u5217\u6dfb\u5b57\u96c6\u5408\u3092\u51fa\u3057\u307e\u3059\u3002\u3053\u306e\u6642\u70b9\u3067\u306farr_length, arr_width \u306b\u306f\u4f55\u3082\u3057\u3066\u3044\u307e\u305b\u3093\u3002\n\n``` psql\ndb=# SELECT\n  c28_005,\n  generate_subscripts(arr_length, 1) AS number,\n  arr_length,\n  arr_width\nFROM (\n  SELECT\n    c28_005,\n    regexp_split_to_array(c28_012, ',') AS arr_length,\n    regexp_split_to_array(c28_013, ',') AS arr_width\n  FROM (\n    SELECT DISTINCT c28_005, c28_012, c28_013 FROM airport\n  ) AS Q1\n) AS Q2;\n\n    c28_005     | number |      arr_length       |   arr_width   \n----------------+--------+-----------------------+---------------\n \u5965\u5c3b\u7a7a\u6e2f       |      1 | {1500}                | {45}\n...\n \u5927\u962a\u56fd\u969b\u7a7a\u6e2f   |      1 | {1828,3000}           | {45,60}\n \u5927\u962a\u56fd\u969b\u7a7a\u6e2f   |      2 | {1828,3000}           | {45,60}\n...\n(107 \u884c)\n```\n\n\u914d\u5217\u6dfb\u5b57(number)\u3092\u4f7f\u3063\u3066\u3001\u914d\u5217\u306e\u8981\u7d20\u3092\u62bd\u51fa\u3057\u305f\u3089\u3067\u304d\u3042\u304c\u308a\u3002\n\n\u3042\u3068\u3001regexp_split_to_array\u3067\u751f\u6210\u3055\u308c\u308b\u306e\u306f\u6587\u5b57\u5217\u914d\u5217\u3067\u3001\u6700\u7d42\u7684\u306b\u306f\u6574\u6570\u306b\u3057\u305f\u3044\u306e\u3067\u3001\u30ad\u30e3\u30b9\u30c8\u3057\u3061\u3083\u3044\u307e\u3057\u3087\u3046\u3002\n\n```psql\ndb=# SELECT \n  c28_005,\n  number,\n  arr_length[number]::INT AS length,\n  arr_width[number]::INT AS width\nFROM (\n  SELECT\n    c28_005,\n    generate_subscripts(arr_length, 1) AS number,\n    arr_length,\n    arr_width\n  FROM (\n    SELECT\n      c28_005,\n      regexp_split_to_array(c28_012, ',') AS arr_length,\n      regexp_split_to_array(c28_013, ',') AS arr_width\n    FROM (\n      SELECT DISTINCT c28_005, c28_012, c28_013 FROM airport\n    ) AS Q1\n  ) AS Q2\n) AS Q3;\n\n    c28_005     | number | length | width \n----------------+--------+--------+-------\n \u5965\u5c3b\u7a7a\u6e2f       |      1 |   1500 |    45\n...\n \u5927\u962a\u56fd\u969b\u7a7a\u6e2f   |      1 |   1828 |    45\n \u5927\u962a\u56fd\u969b\u7a7a\u6e2f   |      2 |   3000 |    60\n...\n(107 \u884c)\n```\n\n# \u30c6\u30fc\u30d6\u30eb\u306b\u5165\u308c\u308b\n\n\u307e\u305a\u3001\u30c6\u30fc\u30d6\u30eb\u3092\u4f5c\u308a\u307e\u3059\u3002\n```psql\ndb=# CREATE TABLE t_runway (\n  gid SERIAL PRIMARY KEY,\n  name TEXT REFERENCES g_airport(name),\n  number INT,\n  length INT,\n  width INT,\n  UNIQUE (name, number)\n);\n```\n\n\u633f\u5165\u3057\u307e\u3059\u3002\n\n```psql\ndb=# INSERT INTO t_runway (name, number, length, width)\nSELECT \n  c28_005,\n  number,\n  arr_length[number]::INT AS length,\n  arr_width[number]::INT AS width\nFROM (\n  SELECT\n    c28_005,\n    generate_subscripts(arr_length, 1) AS number,\n    arr_length,\n    arr_width\n  FROM (\n    SELECT\n      c28_005,\n      regexp_split_to_array(c28_012, ',') AS arr_length,\n      regexp_split_to_array(c28_013, ',') AS arr_width\n    FROM (\n      SELECT DISTINCT c28_005, c28_012, c28_013 FROM airport\n    ) AS Q1\n  ) AS Q2\n) AS Q3;\n\nINSERT 0 107\n```\n\n\u6700\u5f8c\u306b\u30c6\u30fc\u30d6\u30eb\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\n\n```psql\ndb=# SELECT * FROM t_runway;\n gid |      name      | number | length | width \n-----+----------------+--------+--------+-------\n  16 | \u5965\u5c3b\u7a7a\u6e2f       |      1 |   1500 |    45\n  17 | \u65b0\u5343\u6b73\u7a7a\u6e2f     |      1 |   3000 |    60\n  18 | \u65b0\u5343\u6b73\u7a7a\u6e2f     |      2 |   3000 |    60\n  19 | \u798f\u4e95\u7a7a\u6e2f       |      1 |   1200 |    30\n  20 | \u4e0b\u5730\u5cf6\u7a7a\u6e2f     |      1 |   3000 |    60\n  21 | \u5e83\u5cf6\u7a7a\u6e2f       |      1 |   3000 |    60\n  22 | \u4e09\u6ca2\u98db\u884c\u5834     |      1 |   3050 |    45\n...\n(107 \u884c)\n```\n\n# \u304a\u308f\u308a\u306b\n\n``regexp_split_to_array``\u3068``generate_subscripts``\u3092\u4f7f\u3063\u3066\u30012\u30ab\u30e9\u30e0\u306e\u6587\u5b57\u5217\u3092\u5206\u5272\u3057\u3066\u30c6\u30fc\u30d6\u30eb\u306b\u7d0d\u3081\u307e\u3057\u305f\u3002\n\n\u6587\u5b57\u5217\u5206\u5272\u306f\u3067\u304d\u308c\u3070\u907f\u3051\u305f\u3044\u3068\u3053\u308d\u3067\u3059\u304c\u3001\u30a4\u30f3\u30dd\u30fc\u30c8\u5143\u306e\u66f8\u5f0f\u306e\u5236\u7d04\u304b\u3089\u3001\u5206\u5272\u305b\u3056\u308b\u3092\u3048\u306a\u3044\u5834\u5408\u3082\u3042\u308a\u307e\u3059\u3002\u305d\u3046\u3044\u3063\u305f\u5834\u5408\u3067\u3082PostgreSQL\u306f\u3001\u305d\u3046\u3044\u3063\u305f\u3053\u3068\u306b\u3082\u5bfe\u5fdc\u3057\u3066\u304f\u308c\u307e\u3057\u305f\u3002\n\n\u6b21\u56de\u306f\u3001QGIS\u3068\u9023\u643a\u3057\u3066\u81ea\u529b\u3067\u6ed1\u8d70\u8def\u3092\u4f5c\u3063\u3066\u3001\u9032\u5165\u8868\u9762\u3092\u4f5c\u308b\u306e\u304b\u2026\u3002\n\n\n", "tags": ["PostGIS", "PostgreSQL"]}