{"context": "\n\n\u306f\u3058\u3081\u306b\nMySQL \u306e\u30b5\u30fc\u30d0\u304c\u305f\u304f\u3055\u3093\u3042\u3063\u3066\u3001\u30e6\u30fc\u30b6\u3084\u6a29\u9650\u304c\u307e\u3061\u307e\u3061\u3060\u3063\u305f\u308a\u3001\u3061\u3087\u3063\u3068\u305a\u3064\u9055\u3046\u72b6\u614b\u3060\u3063\u305f\u308a\u3059\u308b\u306e\u3092\u662f\u6b63\u3059\u308b\u305f\u3081\u306b\u3001\u5168DB\u30b5\u30fc\u30d0\u304b\u3089\u5168\u30a2\u30ab\u30a6\u30f3\u30c8\u3068\u6a29\u9650\u3092\u62bd\u51fa\u3057\u3066\u307f\u305f\u3002\nDB\u6a5f\u3060\u3051\u306760\u53f0\u304f\u3089\u3044\u3042\u308b\u3093\u3067\u3002\u3002\u3002\n\n\u3053\u308c\u3060\u3051\n$ mysql -u root -p -h server -N -e 'select concat(\"SHOW GRANTS FOR `\",user, \"`@`\",host, \"`;\") from mysql.user order by user,host;' > showgrants.sql\n$ mysql -u root -p -h server -N < showgrants.sql > createuser.sql\n\n\u307e\u3041SQL\u3067SQL\u4f5c\u3063\u3066\u5b9f\u884c\u3059\u308b\u3060\u3051\u306a\u3093\u3060\u3051\u3069\u306d\u3002\n$ cat showgrants.sql\nSHOW GRANTS FOR `hoge`@`10.10.10.%`;\nSHOW GRANTS FOR `munin`@`localhost`;\nSHOW GRANTS FOR `root`@`localhost`;\nSHOW GRANTS FOR `zabbix`@`localhost`;\n\n\u3042\u3001\u3082\u3061\u308d\u3093\u306f\u3057\u3087\u3063\u3066\u3042\u308a\u307e\u3059\u3002\n$ cat king-dbm01/createuser.sql\nGRANT USAGE ON *.* TO 'hoge'@'10.10.10.%' IDENTIFIED BY PASSWORD '\u30d1\u30b9\u30ef\u30fc\u30c9\u306a\u6587\u5b57\u5217'\nGRANT SELECT, PROCESS, SUPER, REPLICATION CLIENT ON *.* TO 'munin'@'localhost' IDENTIFIED BY PASSWORD '*CF5C09FAD38AFB92F43C9BEE1A0F69CE3736770D' WITH GRANT OPTION\nGRANT ALL PRIVILEGES ON *.* TO 'root'@'localhost' IDENTIFIED BY PASSWORD '\u30d1\u30b9\u30ef\u30fc\u30c9\u306a\u6587\u5b57\u5217' WITH GRANT OPTION\nGRANT PROXY ON ''@'' TO 'root'@'localhost' WITH GRANT OPTION\nGRANT REPLICATION SLAVE, REPLICATION CLIENT ON *.* TO 'zabbix'@'localhost' IDENTIFIED BY PASSWORD '\u30d1\u30b9\u30ef\u30fc\u30c9\u306a\u6587\u5b57\u5217'\n\n\n\u30b7\u30a7\u30eb\u3067\u30b5\u30fc\u30d0\u6bce\u306b\u3076\u3093\u56de\u3057\u3066\uff08.my.cnf \u66f8\u3044\u3066\u30d1\u30b9\u30ef\u30fc\u30c9\u8a2d\u5b9a\u3057\u3066 -p \u3068\u304b\u5916\u3057\u3066\uff09\u30b5\u30fc\u30d0\u540d/\u30d5\u30a1\u30a4\u30eb\u3001\u307f\u305f\u3044\u306a\u611f\u3058\u3067\u5168\u90e8\u62bd\u51fa\u3057\u305f\u3002\n\u6700\u521d\u306e SQL \u3067 user, host \u3067\u30bd\u30fc\u30c8\u3057\u3066\u308b\u306e\u3067\u3001diff \u3068\u308b\u306e\u3082\u7c21\u5358\u3002\nmysql.user \u304b\u3089\u30e6\u30fc\u30b6\u4e00\u89a7\u4f5c\u308b\u3060\u3051\u3067\u306f\u6f0f\u308c\u3061\u3083\u3046\u6a29\u9650\uff08FILE\u3068\u304b\u5f8c\u4ed8\u3059\u308b\u3088\u3046\u306a\u3084\u3064\uff09\u3082\u3061\u3083\u3093\u3068\u30c1\u30a7\u30c3\u30af\u3067\u304d\u305f\uff08\u6f0f\u308c\u3066\u305f\u3002\u3002\u3002_no\n-N \u3067\u30d8\u30c3\u30c0\u6d88\u3059\u306e\u304c\u30df\u30bd\nuser,host \u3092 `` \u3067\u62ec\u308b\u3053\u3068\u3067\u7121\u540d\u30a2\u30ab\u30a6\u30f3\u30c8\u3068\u304b\u3082\u3061\u3083\u3093\u3068\u51e6\u7406\u3067\u304d\u308b\u306e\u3082GOOD\n\n\u305a\u3063\u3068\u5f8c\u3067\u307e\u305f\u4f7f\u3046\u304b\u3082\u3057\u308c\u306a\u3044\u304b\u3089 qiita \u306b\u30e1\u30e2\u3063\u3066\u3053\u3068\u3067\u3002\n\n\u691c\u8a3c\u6c42\u3080\n\u3046\u3061\u306eDB\u6a5f\u3067\u306f\u3053\u308c\u3067\u554f\u984c\u306a\u304f\u5168\u90e8\u30c1\u30a7\u30c3\u30af\u3067\u304d\u305f\u3068\u601d\u3046\u3093\u3060\u3051\u3069\u3001\u4f55\u304b\u554f\u984c\u3068\u304b\u304a\u304b\u3057\u3044\u3068\u3053\u3068\u304b\u3042\u3063\u305f\u3089\u30b3\u30e1\u30f3\u30c8\u3067\u6559\u3048\u3066\u304f\u308c\u308b\u3068\u3046\u308c\u3057\u3059\u3002\n\n\u304a\u307e\u3051\n\nmysqldump\n$ mysqldump -u root -p -x --allow-keywords mysql > test.dump\n\n\u3053\u3046\u3044\u3046\u306e\u3060\u3068\u3001\u3044\u3089\u3093\u30c6\u30fc\u30d6\u30eb\u60c5\u5831\u3082\u3054\u3063\u305d\u308a\u5165\u3063\u3066\u308b\u3057\u3001MySQL\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u9055\u3044\u3067\u56f0\u308b\uff08mysql_upgrade\u3068\u304b\u3042\u308b\u3051\u3069\uff09\u3057\u3001\u306a\u306b\u3088\u308a\u305d\u3082\u305d\u3082\u6a29\u9650\u5468\u308a\u306e\u30c1\u30a7\u30c3\u30af\u306b\u306f\u4f7f\u3048\u306a\u3044\u3002\n\nselect user,host,password from mysql.user\n\u30e6\u30fc\u30b6\u306f\u4e00\u89a7\u3067\u304d\u308b\u3051\u3069\u3001\u3053\u306e\u5f8c show grants \u6587\u4f5c\u308b\u306e\u3082\uff11\u3064\u305a\u3064\u6295\u3052\u308b\u306e\u3082\u9762\u5012\u3060\u3063\u305f\u306e\u3067\u4f5c\u3063\u305f\u3063\u3066\u611f\u3058\u3002\n# \u306f\u3058\u3081\u306b\n\nMySQL \u306e\u30b5\u30fc\u30d0\u304c\u305f\u304f\u3055\u3093\u3042\u3063\u3066\u3001\u30e6\u30fc\u30b6\u3084\u6a29\u9650\u304c\u307e\u3061\u307e\u3061\u3060\u3063\u305f\u308a\u3001\u3061\u3087\u3063\u3068\u305a\u3064\u9055\u3046\u72b6\u614b\u3060\u3063\u305f\u308a\u3059\u308b\u306e\u3092\u662f\u6b63\u3059\u308b\u305f\u3081\u306b\u3001\u5168DB\u30b5\u30fc\u30d0\u304b\u3089\u5168\u30a2\u30ab\u30a6\u30f3\u30c8\u3068\u6a29\u9650\u3092\u62bd\u51fa\u3057\u3066\u307f\u305f\u3002\nDB\u6a5f\u3060\u3051\u306760\u53f0\u304f\u3089\u3044\u3042\u308b\u3093\u3067\u3002\u3002\u3002\n\n# \u3053\u308c\u3060\u3051\n\n<pre>\n$ mysql -u root -p -h server -N -e 'select concat(\"SHOW GRANTS FOR `\",user, \"`@`\",host, \"`;\") from mysql.user order by user,host;' > showgrants.sql\n$ mysql -u root -p -h server -N < showgrants.sql > createuser.sql\n</pre>\n\n\u307e\u3041SQL\u3067SQL\u4f5c\u3063\u3066\u5b9f\u884c\u3059\u308b\u3060\u3051\u306a\u3093\u3060\u3051\u3069\u306d\u3002\n\n<pre>\n$ cat showgrants.sql\nSHOW GRANTS FOR `hoge`@`10.10.10.%`;\nSHOW GRANTS FOR `munin`@`localhost`;\nSHOW GRANTS FOR `root`@`localhost`;\nSHOW GRANTS FOR `zabbix`@`localhost`;\n</pre>\n\n\u3042\u3001\u3082\u3061\u308d\u3093\u306f\u3057\u3087\u3063\u3066\u3042\u308a\u307e\u3059\u3002\n\n<pre>\n$ cat king-dbm01/createuser.sql\nGRANT USAGE ON *.* TO 'hoge'@'10.10.10.%' IDENTIFIED BY PASSWORD '\u30d1\u30b9\u30ef\u30fc\u30c9\u306a\u6587\u5b57\u5217'\nGRANT SELECT, PROCESS, SUPER, REPLICATION CLIENT ON *.* TO 'munin'@'localhost' IDENTIFIED BY PASSWORD '*CF5C09FAD38AFB92F43C9BEE1A0F69CE3736770D' WITH GRANT OPTION\nGRANT ALL PRIVILEGES ON *.* TO 'root'@'localhost' IDENTIFIED BY PASSWORD '\u30d1\u30b9\u30ef\u30fc\u30c9\u306a\u6587\u5b57\u5217' WITH GRANT OPTION\nGRANT PROXY ON ''@'' TO 'root'@'localhost' WITH GRANT OPTION\nGRANT REPLICATION SLAVE, REPLICATION CLIENT ON *.* TO 'zabbix'@'localhost' IDENTIFIED BY PASSWORD '\u30d1\u30b9\u30ef\u30fc\u30c9\u306a\u6587\u5b57\u5217'\n</pre>\n\n* \u30b7\u30a7\u30eb\u3067\u30b5\u30fc\u30d0\u6bce\u306b\u3076\u3093\u56de\u3057\u3066\uff08.my.cnf \u66f8\u3044\u3066\u30d1\u30b9\u30ef\u30fc\u30c9\u8a2d\u5b9a\u3057\u3066 -p \u3068\u304b\u5916\u3057\u3066\uff09\u30b5\u30fc\u30d0\u540d/\u30d5\u30a1\u30a4\u30eb\u3001\u307f\u305f\u3044\u306a\u611f\u3058\u3067\u5168\u90e8\u62bd\u51fa\u3057\u305f\u3002\n* \u6700\u521d\u306e SQL \u3067 user, host \u3067\u30bd\u30fc\u30c8\u3057\u3066\u308b\u306e\u3067\u3001diff \u3068\u308b\u306e\u3082\u7c21\u5358\u3002\n* mysql.user \u304b\u3089\u30e6\u30fc\u30b6\u4e00\u89a7\u4f5c\u308b\u3060\u3051\u3067\u306f\u6f0f\u308c\u3061\u3083\u3046\u6a29\u9650\uff08FILE\u3068\u304b\u5f8c\u4ed8\u3059\u308b\u3088\u3046\u306a\u3084\u3064\uff09\u3082\u3061\u3083\u3093\u3068\u30c1\u30a7\u30c3\u30af\u3067\u304d\u305f\uff08\u6f0f\u308c\u3066\u305f\u3002\u3002\u3002_no\n* -N \u3067\u30d8\u30c3\u30c0\u6d88\u3059\u306e\u304c\u30df\u30bd\n* user,host \u3092 `` \u3067\u62ec\u308b\u3053\u3068\u3067\u7121\u540d\u30a2\u30ab\u30a6\u30f3\u30c8\u3068\u304b\u3082\u3061\u3083\u3093\u3068\u51e6\u7406\u3067\u304d\u308b\u306e\u3082GOOD\n\n\u305a\u3063\u3068\u5f8c\u3067\u307e\u305f\u4f7f\u3046\u304b\u3082\u3057\u308c\u306a\u3044\u304b\u3089 qiita \u306b\u30e1\u30e2\u3063\u3066\u3053\u3068\u3067\u3002\n\n# \u691c\u8a3c\u6c42\u3080\n\n\u3046\u3061\u306eDB\u6a5f\u3067\u306f\u3053\u308c\u3067\u554f\u984c\u306a\u304f\u5168\u90e8\u30c1\u30a7\u30c3\u30af\u3067\u304d\u305f\u3068\u601d\u3046\u3093\u3060\u3051\u3069\u3001\u4f55\u304b\u554f\u984c\u3068\u304b\u304a\u304b\u3057\u3044\u3068\u3053\u3068\u304b\u3042\u3063\u305f\u3089\u30b3\u30e1\u30f3\u30c8\u3067\u6559\u3048\u3066\u304f\u308c\u308b\u3068\u3046\u308c\u3057\u3059\u3002\n\n\n# \u304a\u307e\u3051\n\n## mysqldump\n\n<pre>\n$ mysqldump -u root -p -x --allow-keywords mysql > test.dump\n</pre>\n\n\u3053\u3046\u3044\u3046\u306e\u3060\u3068\u3001\u3044\u3089\u3093\u30c6\u30fc\u30d6\u30eb\u60c5\u5831\u3082\u3054\u3063\u305d\u308a\u5165\u3063\u3066\u308b\u3057\u3001MySQL\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u9055\u3044\u3067\u56f0\u308b\uff08mysql_upgrade\u3068\u304b\u3042\u308b\u3051\u3069\uff09\u3057\u3001\u306a\u306b\u3088\u308a\u305d\u3082\u305d\u3082\u6a29\u9650\u5468\u308a\u306e\u30c1\u30a7\u30c3\u30af\u306b\u306f\u4f7f\u3048\u306a\u3044\u3002\n\n## select user,host,password from mysql.user\n\n\u30e6\u30fc\u30b6\u306f\u4e00\u89a7\u3067\u304d\u308b\u3051\u3069\u3001\u3053\u306e\u5f8c show grants \u6587\u4f5c\u308b\u306e\u3082\uff11\u3064\u305a\u3064\u6295\u3052\u308b\u306e\u3082\u9762\u5012\u3060\u3063\u305f\u306e\u3067\u4f5c\u3063\u305f\u3063\u3066\u611f\u3058\u3002\n", "tags": ["MySQL", "mysqldump", "SQL"]}