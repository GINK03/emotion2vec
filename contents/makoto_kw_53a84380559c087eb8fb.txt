{"tags": ["chef", "chef-solo"], "context": " More than 1 year has passed since last update.\u3088\u304f\u4f7f\u3046\u3082\u306e\u3092\u9006\u5f15\u304d\u3067\u304d\u308b\u3088\u3046\u306b\u3002\n\n\u30a2\u30f3\u30c1\u30d1\u30bf\u30fc\u30f3\u3092\u77e5\u308b\nhttp://www.slideshare.net/JulianDunn/beginner-chef-antipatterns\nhttp://www.creationline.com/lab/3080\n\n\u3059\u3079\u3066\u306eChef\u30c7\u30fc\u30bf\u30921\u3064\u306e\u5de8\u5927\u306aGit\u30ec\u30dd\u30b8\u30c8\u30ea\u306b\u5165\u308c\u3066\u3057\u307e\u3046\n\n\ncookbooks\u306b\u306f\u30d0\u30fc\u30b8\u30e7\u30f3\u304c\u3042\u308b\u304c\u3001environments\u3084roles\u306b\u306f\u306a\u3044\ncookbooks\u3068\u3057\u3066\u5206\u5272\u3059\u3079\u304d\u3082\u306e\u306f\u30ea\u30dd\u30b8\u30c8\u30ea\u3092\u5206\u3051\u308b\u3079\u304d\n\n\n\u4f1a\u793e\u540d\u3064\u304d\u306e\u5de8\u5927\u306aCookbook\u3092\u4f5c\u3063\u3066\u3057\u307e\u3046\n\n\n\u672c\u6765\u7d44\u307f\u5408\u308f\u305b\u308b\u3079\u304d\u3067\u306a\u3044\u3082\u306e\u304c\u6df7\u3056\u308b\u5371\u967a\u304c\u3042\u308b\n\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u5225\u306b\u5206\u3051\u308b\u3079\u304d\n\n\n Environments\u3092\u8ad6\u7406\u7684\u306a\u74b0\u5883\u4ee5\u4e0a\u306e\u76ee\u7684\u3067\u4f7f\u3063\u3066\u3057\u307e\u3046\n\n\ndevelopment\u3068\u304bproduction\u3068\u304b\u8ad6\u7406\u7684\u306a\u74b0\u5883\u3067\u4f7f\u3044\u3001\u30af\u30e9\u30b9\u30bf\u3068\u304b\u30c7\u30fc\u30bf\u30bb\u30f3\u30bf\u30fc\u3068\u3044\u3063\u305f\u5272\u308a\u5f53\u3066\u306b\u4f7f\u308f\u306a\u3044\n\n\nCommunity Cookbook\u3092\u30d5\u30a9\u30fc\u30af\u3057\u3066\u3057\u307e\u3046\n\n\n\u958b\u767a\u5143\u306e\u30d0\u30b0\u4fee\u6b63\u3084\u6a5f\u80fd\u8ffd\u52a0\u3068\u3044\u3063\u305f\u6069\u6075\u3092\u53d7\u3051\u53d6\u308c\u306a\u3044\u3001\u306a\u308b\u3079\u304f\u30e9\u30c3\u30d7\u3059\u308b\u65b9\u304c\u826f\u3044\n\n\nRole\u5185\u3067run_list\u3092\u7ba1\u7406\u3057\u3066\u3057\u307e\u3046\n\n\nrole\u306f\u30d0\u30fc\u30b8\u30e7\u30f3\u304c\u4ed8\u304b\u306a\u3044\u3001\u4ee3\u308f\u308a\u306b include_recipe \u3092\u4f7f\u3044recipe\u3067\u307e\u3068\u3081\u308b\n\n\n\u7121\u79e9\u5e8f\u306adata bag\u3092\u4f5c\u3063\u3066\u3057\u307e\u3046\n\n\ndata bag\u3068data bag item\u3068\u3044\u30462\u968e\u5c64\u306a\u306e\u3067\u4f5c\u308b\u524d\u306b\u8a08\u753b\u3057\u3066\u304a\u304f\n\n\nchef-shell\u3092\u77e5\u3089\u306a\u3044\u3001\u4f7f\u308f\u306a\u3044\n\n\nCookbook\u958b\u767a\u3001\u30c7\u30d0\u30c3\u30b0\u306b\u9069\u3057\u3066\u3044\u308b\n\n\nLWRP\u3092\u6016\u304c\u3063\u3066\u3057\u307e\u3046\n\n\n\u8a00\u3046\u307b\u3069LWRP\u306e\u5b9f\u88c5\u306f\u96e3\u3057\u304f\u306a\u3044\n\n\n\u5916\u90e8\u767a\u7965\u3060\u304b\u3089\u5229\u7528\u3057\u306a\u3044\u75c7\u5019\u7fa4\u306b\u9665\u3063\u3066\u3057\u307e\u3046\n\n\n\u307e\u305a\u4f7f\u3048\u308b\u3082\u306e\u304c\u3042\u308b\u304b\u63a2\u3057\u3001\u5909\u66f4\u304c\u5fc5\u8981\u306a\u3089\u30b3\u30f3\u30c8\u30ea\u30d3\u30e5\u30fc\u30c8\u3059\u308b\n\n\n\u5b64\u72ec\u306aChef\u4f7f\u3044\u306b\u306a\u3063\u3066\u3057\u307e\u3046\n\n\n\u3042\u308b\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\u306b\u81ea\u5206\u3088\u308a\u8a73\u3057\u3044\u30e1\u30f3\u30d0\u30fc\u304c\u3044\u308b\u306a\u3089\u4efb\u305b\u3001\u30c1\u30fc\u30e0\u3067\u8cac\u4efb\u3092\u6301\u3064\n\n\n\n\n\u30ec\u30b7\u30d4\u3092\u30c1\u30a7\u30c3\u30af\u3059\u308b\nhttp://acrmp.github.io/foodcritic/\ngem i foodcritic\nfoodcritic -C .\n\nFC001\u306a\u3069\u8b66\u544a\u306e\u5185\u5bb9\u306b\u3064\u3044\u3066\u306f\u30b5\u30a4\u30c8\u306b\u8f09\u3063\u3066\u3044\u308b\u3002\n\nFC001\u4ee5\u5916\u3092\u30c1\u30a7\u30c3\u30af\u3059\u308b\nFC001\u306fdeprecated\u306b\u306a\u3063\u305f\u3002FC001\u3092\u9664\u5916\u3057\u3066\u691c\u8a3c\u3059\u308b\u306b\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u3059\u308b\u3002\nfoodcritic -t ~FC001 site-cookbooks\n\n\n\u30ed\u30b0\u3092\u51fa\u3059\nlog\u30ea\u30bd\u30fc\u30b9\u3092\u4f7f\u3046\u3002\u3067\u3082\u30ec\u30b7\u30d4\u306e\u4e00\u6642\u7684\u306a\u30c7\u30d0\u30c3\u30b0\u306a\u3089ruby\u306eputs\u3084p\u3067\u3082\u3044\u3044\u304b\u3082\u3057\u308c\u306a\u3044\u3002\nlog \"a debug string\" do\n  level :debug\nend\n\nlog \"message\" do\n  message \"This is the message that will be added to the log.\"\n  level :info\nend\n\n\nVagrant\u306e\u30d7\u30ed\u30d3\u30b8\u30e7\u30cb\u30f3\u30b0\u3067\u30ed\u30b0\u30ec\u30d9\u30eb\u3092\u5909\u66f4\u3059\u308b\nlog_level\u5c5e\u6027\u3092\u4f7f\u3046\u3002\nhttp://docs.vagrantup.com/v2/provisioning/chef_common.html\nconfig.vm.provision :chef_solo do |chef|\n  chef.log_level = :debug\n\n\nnode\u306e\u5c5e\u6027\u3092\u51fa\u529b\u3059\u308b\n\u3068\u308a\u3042\u3048\u305ajson\u3067\nputs JSON.pretty_generate(node)\n\n\u307e\u305f\u306f\u30ec\u30b7\u30d4\u5185\u3067\u4f7f\u3044\u305d\u3046\u306a\u3082\u306e\u3060\u3051\u78ba\u8a8d\u3002\n[:platform, :platform_version, :ipaddress, :fqdn, :hostname, :domain].each do |key|\n  puts \"node['#{key}'] = #{node[key]}\"\nend\n\n\n\u7f6e\u304d\u63db\u308f\u3063\u305f\u30d5\u30a1\u30a4\u30eb\u306e\u30d0\u30c3\u30af\u30a2\u30c3\u30d7\u3092\u898b\u308b\ntemplate\u30ea\u30bd\u30fc\u30b9\u306a\u3069\u3067\u30d5\u30a1\u30a4\u30eb\u3092\u7f6e\u304d\u63db\u3048\u305f\u5834\u5408\u306b\u3001\u5143\u306e\u30d5\u30a1\u30a4\u30eb\u306f\u30ea\u30e2\u30fc\u30c8\u30b5\u30fc\u30d0\u306e /var/chef/backup/ \u306b\u4fdd\u5b58\u3055\u308c\u3066\u3044\u308b\u3002\n\n\u30d1\u30b9\u30ef\u30fc\u30c9\u306e\u30cf\u30c3\u30b7\u30e5\u3092\u751f\u6210\u3059\u308b\nUnix\u3067\u306f\u30d1\u30b9\u30ef\u30fc\u30c9\u3092 $\uff1c\u30cf\u30c3\u30b7\u30e5\u65b9\u5f0f\uff1e$\uff1csalt\uff1e$\uff1c\u30cf\u30c3\u30b7\u30e5\u5f8c\u306e\u30d1\u30b9\u30ef\u30fc\u30c9\uff1e \u3067\u8868\u73fe\u3057\u3066\u3044\u308b\u3002\u4ee5\u4e0b\u306e\u30b3\u30de\u30f3\u30c9\u3067\u305d\u308c\u306b\u5bfe\u5fdc\u3057\u305fMD5\u306ehash\u3092\u51fa\u529b\u3067\u304d\u308b\u3002\nopenssl passwd -1 'password'\n\n\nEnvironment\u3067\u5206\u5c90\u3059\u308b\nnode.chef_environment \u3092\u898b\u308b\nif node.chef_environment == 'development'\nend\n\n\nOS\u3067\u5206\u5c90\u3059\u308b\n\nOS\ncase node[\"platform\"]\nwhen \"debian\", \"ubuntu\"\n  # do debian/ubuntu things\nwhen \"redhat\", \"centos\", \"fedora\"\n  # do redhat/centos/fedora things\nend\n\n\nOS\u30ab\u30c6\u30b4\u30ea\nxx\u7cfb\u3067\u5206\u5c90\u3059\u308b\u5834\u5408\u3002yum\u304bapt\u3067package\u540d\u304c\u5909\u308f\u3063\u305f\u308a\u30d1\u30b9\u304c\u5909\u308f\u3063\u305f\u308a\u3059\u308b\u3068\u304d\u306a\u3069\u3067\u4f7f\u3046\u3002\ncase node[\"platform_family\"]\nwhen \"debian\"\n  # do things on debian-ish platforms (debian, ubuntu, linuxmint)\nwhen \"rhel\"\n  # do things on RHEL platforms (redhat, centos, scientific, etc)\nend\n\n\n\u30c6\u30f3\u30dd\u30e9\u30ea\u30d5\u30a1\u30a4\u30eb\u306e\u30d1\u30b9\u3092\u7d44\u307f\u7acb\u3066\u308b\nfoodcritic \u306e FC013\u3067 /tmp \u3067\u306f\u306a\u304f Chef::Config[:file_cache_path] \u3092\u4f7f\u3048\u3068\u3042\u308b\u3002\nremote_file \"#{Chef::Config[:file_cache_path]}/large-file.tar.gz\" do\n  source \"http://www.example.org/large-file.tar.gz\"\nend\n\n\n\u4e8b\u524d\u306b\u7528\u610f\u3057\u305f\u9759\u7684\u30d5\u30a1\u30a4\u30eb\u3092\u914d\u7f6e\u3059\u308b\ncookbook_file\u30ea\u30bd\u30fc\u30b9\u3092\u4f7f\u3046\u3002\n\u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u306f\u30d5\u30a1\u30a4\u30eb\u306f\u4e0a\u66f8\u304d\u306b\u306a\u308b\u3002\u4e0a\u66f8\u304d\u304c\u56f0\u308b\u5834\u5408\u306f action: create_if_missing \u3084 not_if {File.exist?} \u306a\u3069\u3092\u4f7f\u3046\u3002\n# files/default/testfile\ncookbook_file \"/#{Chef::Config[:file_cache_path]}/testfile\" do\n  source \"testfile\"\n  mode 00644\n  owner 'root'\n  group 'root'\nend\n\n\u914d\u7f6e\u3059\u308b\u5143\u30d5\u30a1\u30a4\u30eb\u306f\u4ee5\u4e0b\u306e\u9806\u756a\u3067 files \u306e\u30b5\u30d6\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u304b\u3089\u691c\u7d22\u3055\u308c\u308b\u3002\n\n\u30db\u30b9\u30c8\u540d host-#{node[:fqdn]}\n\nOS-\u30d5\u30eb\u30d0\u30fc\u30b8\u30e7\u30f3 #{node[:platform]}-#{node[:platform_version]}\n\nOS-\u30e1\u30b8\u30e3\u30fc\u30d0\u30fc\u30b8\u30e7\u30f3 #{node[:platform]}-#{version_components}\n\nOS node[:platform]\n\ndefault\n\nfiles/\n   host-foo.example.com\n   ubuntu-10.04\n   ubuntu-10\n   ubuntu\n   default\n\n\n\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u3092\u4f7f\u3063\u3066\u30d5\u30a1\u30a4\u30eb\u3092\u914d\u7f6e\u3059\u308b\ntemplate\u30ea\u30bd\u30fc\u30b9\u3092\u4f7f\u3046\u3002\ncookbook_file\u30ea\u30bd\u30fc\u30b9\u3068\u306e\u9055\u3044\u306f\u7528\u610f\u3067\u304d\u308b\u30d5\u30a1\u30a4\u30eb\u304cerb\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u3067\u3042\u308a\u52d5\u7684\u306b\u51fa\u529b\u3092\u5909\u3048\u3089\u308c\u308b\u3068\u3053\u308d\u3002\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u306e\u30c7\u30d5\u30a9\u30eb\u30c8\u306e\u30b3\u30f3\u30c6\u30ad\u30b9\u30c8\u306fnode\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3067\u3001variables\u5c5e\u6027\u3067\u4efb\u610f\u306ehash\u3092\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u306b\u6e21\u3059\u3053\u3068\u3082\u53ef\u80fd\u3002\ntemplate \"/etc/apache2/ports.conf\" do\n  source 'apache/ports.conf.erb'\n  mode '0644'\nend\n\n\u30bd\u30fc\u30b9\u306e\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u30d5\u30a1\u30a4\u30eb\u306f files \u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3067\u306f\u306a\u304f\u3001templates \u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u914d\u7f6e\u3059\u308b\u3002\ntemplates/\n   host-foo.example.com\n   ubuntu-10.04\n   ubuntu-10\n   ubuntu\n   default\n\n\n\u66f8\u304d\u63db\u3048\u3066\u3057\u307e\u3063\u305f\u30d5\u30a1\u30a4\u30eb\u306e\u524d\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u3092\u898b\u308b\ncookbook_file\u30ea\u30bd\u30fc\u30b9\u3084template\u30ea\u30bd\u30fc\u30b9\u3067\u65e2\u5b58\u306e\u30d5\u30a1\u30a4\u30eb\u3092\u4e0a\u66f8\u304d\u3057\u3066\u3057\u307e\u3063\u305f\u5834\u5408\u306b\u4e16\u4ee3\u30d0\u30c3\u30af\u30a2\u30c3\u30d7\u304c/var/chef/backup \u306b\u3042\u308b\u3002\n\n\u7a7a\u306e\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u6210\u3059\u308b\nfile\u30ea\u30bd\u30fc\u30b9\u306e: create_if_missing\u30a2\u30af\u30b7\u30e7\u30f3\u3092\u4f7f\u3046\u3002(\u30d5\u30a1\u30a4\u30eb\u304c\u7121\u3044\u6642\u9650\u5b9a)\nfile \"/tmp/something\" do\n  action :create_if_missing\nend\n\n\n\u30d5\u30a1\u30a4\u30eb\u3092\u524a\u9664\u3059\u308b\nfile\u30ea\u30bd\u30fc\u30b9\u3092\u4f7f\u3046\u3002\nfile \"/tmp/something\" do\n  action :delete\nend\n\n\u524a\u9664\u5bfe\u8c61\u304c\u30b7\u30f3\u30dc\u30ea\u30c3\u30af\u30ea\u30f3\u30af\u306e\u5834\u5408\u306f\u8b66\u544a\u304c\u3067\u308b\u306e\u3067\u3001link\u30ea\u30bd\u30fc\u30b9\u3092\u4f7f\u3046\u306e\u304c\u30a8\u30ec\u30ac\u30f3\u30c8\u3002\nlink \"/tmp/mylink\" do\n  action :delete\n  only_if \"test -L /tmp/mylink\"\nend\n\n\n\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092\u4f5c\u6210\u3059\u308b\ndirectory\u30ea\u30bd\u30fc\u30b9\u3092\u4f7f\u3046\u3002\ndirectory \"/var/lib/foo\" do\n  owner \"root\"\n  group \"root\"\n  mode 00755\n  action :create\nend\n\n\u89aa\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u304c\u5b58\u5728\u3057\u306a\u3044\u3068\u5931\u6557\u3059\u308b\u3002recursive true\u3092\u3064\u3051\u308b\u3068\u89aa\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092\u518d\u5e30\u7684\u306b\u4f5c\u6210\u3059\u308b\u3002\n\n\u30b7\u30f3\u30dc\u30ea\u30c3\u30af\u30ea\u30f3\u30af\u3092\u4f5c\u6210\u3059\u308b\nlink\u30ea\u30bd\u30fc\u30b9\u3092\u4f7f\u3046\u3002\nlink \"/tmp/passwd\" do\n  to \"/etc/passwd\"\nend\n\nlink \"/tmp/passwd\" do\n  to \"/etc/passwd\"\n  link_type :hard\nend\n\nlink \"/tmp/mylink\" do\n  action :delete\n  only_if \"test -L /tmp/mylink\"\nend\n\n\n\u30d5\u30a1\u30a4\u30eb\u304c\u306a\u3051\u308c\u3070\u30ea\u30bd\u30fc\u30b9\u3092\u5b9f\u884c\u3059\u308b\nnot_if\u3067\u30d5\u30a1\u30a4\u30eb\u3092\u30c1\u30a7\u30c3\u30af\u3059\u308b\u3002\nexecute \"create file hoge\" do\n  command \"touch /tmp/hoge\"\n  not_if {File.exist?(\"/tmp/hoge\")}\nend\n\nDir.exist? \u3082\u4f7f\u3048\u308b(ruby\u306e\u4e16\u754c)\n\n\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3059\u308b\nexecute\u30ea\u30bd\u30fc\u30b9\u3092\u4f7f\u3046\u3002\nexecute 'bundle install' do\n  cwd '/myapp'\n  not_if 'bundle check' # This is not run inside /myapp\nend\n\n\n\u30b7\u30a7\u30eb\u30d5\u30a1\u30a4\u30eb\u3092\u5b9f\u884c\u3059\u308b\n\u6b63\u78ba\u306b\u306f\u4ee5\u4e0b\u306e\u4f8b\u306fbash\u30ea\u30bd\u30fc\u30b9\u304b\u3089\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3002\nbash \"install_ruby_build\" do\n  cwd \"#{Chef::Config[:file_cache_path]}/ruby-build\"\n  user \"rbenv\"\n  group \"rbenv\"\n  code <<-EOH\n    ./install.sh\n  EOH\n  environment 'PREFIX' => \"/usr/local\"\nend\n\n\nGit\u30ea\u30dd\u30b8\u30c8\u30ea\u304b\u3089\u30d5\u30a1\u30a4\u30eb\u3092\u53d6\u5f97\u3059\u308b\ngit\u30ea\u30bd\u30fc\u30b9\u3092\u4f7f\u3046\u3002revision\u5c5e\u6027\u306b\u30bf\u30b0\u306a\u3069\u3092\u6307\u5b9a\u3067\u304d\u308b\u3002\ngit \"/home/#{node[:user]}/redmine\"  do\n  repository \"git://github.com/edavis10/redmine.git\"\n  revision '2.5.1'\n  user node[:user]\n  group node[:user]\nend\n\n\n\u30a6\u30a7\u30d6\u306b\u3042\u308b\u30a2\u30fc\u30ab\u30a4\u30d6\u30d5\u30a1\u30a4\u30eb\u3092\u5c55\u958b\u3059\u308b\nremote_file\u30ea\u30bd\u30fc\u30b9\u3067\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3002bash\u30ea\u30bd\u30fc\u30b9\u3067\u5c55\u958b\u3002\n#  the following code sample is similar to the ``upload_progress_module`` recipe in the ``nginx`` cookbook: https://github.com/opscode-cookbooks/nginx\n\nsrc_filename = \"foo123-nginx-module-v#{node['nginx']['foo123']['version']}.tar.gz\"\nsrc_filepath = \"#{Chef::Config['file_cache_path']}/#{src_filename}\"\nextract_path = \"#{Chef::Config['file_cache_path']}/nginx_foo123_module/#{node['nginx']['foo123']['checksum']}\"\n\nremote_file src_filepath do\n  source node['nginx']['foo123']['url']\n  checksum node['nginx']['foo123']['checksum']\n  owner 'root'\n  group 'root'\n  mode 00644\nend\n\nbash 'extract_module' do\n  cwd ::File.dirname(src_filepath)\n  code <<-EOH\n    mkdir -p #{extract_path}\n    tar xzf #{src_filename} -C #{extract_path}\n    mv #{extract_path}/*/* #{extract_path}/\n    EOH\n  not_if { ::File.exist?(extract_path) }\nend\n\n\nhosts\u30d5\u30a1\u30a4\u30eb\u306b\u30a8\u30f3\u30c8\u30ea\u3092\u8ffd\u52a0\u3059\u308b\nhostsfile cookbook \u3092\u8ffd\u52a0\u3057\u3001hostsfile_entry \u30ea\u30bd\u30fc\u30b9\u3092\u4f7f\u3046\u3002\nhostsfile_entry '1.2.3.4' do\n  hostname  'www2.example.com'\n  aliases   ['foo.com', 'foobar.com']\n  comment   'Append by Recipe X'\n  action    :append\nend\n\n\n\u30d5\u30a1\u30a4\u30eb\u3092\u7f6e\u304d\u63db\u3048\u305f\u306e\u3067\u30b5\u30fc\u30d3\u30b9\u3092\u518d\u8d77\u52d5\u3059\u308b\nNotifications\u3092\u4f7f\u3046\u3002\ntemplate '/etc/httpd/conf/httpd.conf' do\n  source 'httpd/httpd.conf.erb'\n  notifies :restart, 'service[httpd]'\nend\nservice 'httpd' do\n  action [ :enable ]\nend\n\nnotifies\u3067\u6307\u5b9a\u3059\u308b\u30ea\u30bd\u30fc\u30b9\u540d\u304c\u5b58\u5728\u3057\u306a\u3044\u3068\u3044\u3051\u306a\u3044\u306e\u3067 service\u30ea\u30bd\u30fc\u30b9\u3067 :enable \u3084 :nothing\u306a\u3069\u306eAction\u3067\u8a18\u8ff0\u3057\u3066\u304a\u304f\u3002\n\nOhai\u3067\u53d6\u5f97\u3057\u3066\u4f7f\u3048\u308b\u5c5e\u6027\n\n\n\n\u5c5e\u6027\n\u8aac\u660e\n\n\n\n\nnode['platform']\nnode\u306e\u30d7\u30e9\u30c3\u30c8\u30d5\u30a9\u30fc\u30e0\n\n\nnode['platform_version']\n\u30d7\u30e9\u30c3\u30c8\u30d5\u30a9\u30fc\u30e0\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\n\n\nnode['ipaddress']\nIP\u30a2\u30c9\u30ec\u30b9\u3002node\u304c\u30c7\u30d5\u30a9\u30eb\u30c8\u30eb\u30fc\u30c8\u3092\u6301\u3063\u3066\u3044\u308b\u5834\u5408\u306fIPv4\u30a2\u30c9\u30ec\u30b9\u3001\u3082\u3063\u3066\u3044\u306a\u3044\u5834\u5408\u306fnil\n\n\nnode['macaddress']\nMAC\u30a2\u30c9\u30ec\u30b9\n\n\nnode['fqdn']\n\u5b8c\u5168\u4fee\u98fe\u30c9\u30e1\u30a4\u30f3\u540d\n\n\nnode['hostname']\n\u30db\u30b9\u30c8\u540d\n\n\nnode['domain']\n\u30c9\u30e1\u30a4\u30f3\n\n\nnode['recipes']\n\u95a2\u9023\u4ed8\u3051\u3089\u308c\u305f\u30ec\u30b7\u30d4\u306e\u30ea\u30b9\u30c8\n\n\nnode['roles']\n\u95a2\u9023\u4ed8\u3051\u3089\u308c\u305frole\u306e\u30ea\u30b9\u30c8\n\n\nnode['ohai_time']\nOhai\u304c\u6700\u5f8c\u306b\u5b9f\u884c\u3055\u308c\u305f\u6642\u523b\u3002knife status\u30b5\u30d6\u30b3\u30de\u30f3\u30c9\u3067\u30b5\u30fc\u30d0\u306b\u4fdd\u5b58\u3057\u53c2\u7167\u3067\u304d\u308b\n\n\n\n\n\u3088\u304f\u4f7f\u3046\u3082\u306e\u3092\u9006\u5f15\u304d\u3067\u304d\u308b\u3088\u3046\u306b\u3002\n\n## \u30a2\u30f3\u30c1\u30d1\u30bf\u30fc\u30f3\u3092\u77e5\u308b\n\nhttp://www.slideshare.net/JulianDunn/beginner-chef-antipatterns\nhttp://www.creationline.com/lab/3080\n\n1. \u3059\u3079\u3066\u306eChef\u30c7\u30fc\u30bf\u30921\u3064\u306e\u5de8\u5927\u306aGit\u30ec\u30dd\u30b8\u30c8\u30ea\u306b\u5165\u308c\u3066\u3057\u307e\u3046\n * cookbooks\u306b\u306f\u30d0\u30fc\u30b8\u30e7\u30f3\u304c\u3042\u308b\u304c\u3001environments\u3084roles\u306b\u306f\u306a\u3044\n * cookbooks\u3068\u3057\u3066\u5206\u5272\u3059\u3079\u304d\u3082\u306e\u306f\u30ea\u30dd\u30b8\u30c8\u30ea\u3092\u5206\u3051\u308b\u3079\u304d\n1. \u4f1a\u793e\u540d\u3064\u304d\u306e\u5de8\u5927\u306aCookbook\u3092\u4f5c\u3063\u3066\u3057\u307e\u3046\n * \u672c\u6765\u7d44\u307f\u5408\u308f\u305b\u308b\u3079\u304d\u3067\u306a\u3044\u3082\u306e\u304c\u6df7\u3056\u308b\u5371\u967a\u304c\u3042\u308b\n * \u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u5225\u306b\u5206\u3051\u308b\u3079\u304d\n1.  Environments\u3092\u8ad6\u7406\u7684\u306a\u74b0\u5883\u4ee5\u4e0a\u306e\u76ee\u7684\u3067\u4f7f\u3063\u3066\u3057\u307e\u3046\n * development\u3068\u304bproduction\u3068\u304b\u8ad6\u7406\u7684\u306a\u74b0\u5883\u3067\u4f7f\u3044\u3001\u30af\u30e9\u30b9\u30bf\u3068\u304b\u30c7\u30fc\u30bf\u30bb\u30f3\u30bf\u30fc\u3068\u3044\u3063\u305f\u5272\u308a\u5f53\u3066\u306b\u4f7f\u308f\u306a\u3044\n1. Community Cookbook\u3092\u30d5\u30a9\u30fc\u30af\u3057\u3066\u3057\u307e\u3046\n * \u958b\u767a\u5143\u306e\u30d0\u30b0\u4fee\u6b63\u3084\u6a5f\u80fd\u8ffd\u52a0\u3068\u3044\u3063\u305f\u6069\u6075\u3092\u53d7\u3051\u53d6\u308c\u306a\u3044\u3001\u306a\u308b\u3079\u304f\u30e9\u30c3\u30d7\u3059\u308b\u65b9\u304c\u826f\u3044\n1. Role\u5185\u3067run_list\u3092\u7ba1\u7406\u3057\u3066\u3057\u307e\u3046\n * role\u306f\u30d0\u30fc\u30b8\u30e7\u30f3\u304c\u4ed8\u304b\u306a\u3044\u3001\u4ee3\u308f\u308a\u306b ``include_recipe`` \u3092\u4f7f\u3044recipe\u3067\u307e\u3068\u3081\u308b\n1. \u7121\u79e9\u5e8f\u306adata bag\u3092\u4f5c\u3063\u3066\u3057\u307e\u3046\n * data bag\u3068data bag item\u3068\u3044\u30462\u968e\u5c64\u306a\u306e\u3067\u4f5c\u308b\u524d\u306b\u8a08\u753b\u3057\u3066\u304a\u304f\n1. chef-shell\u3092\u77e5\u3089\u306a\u3044\u3001\u4f7f\u308f\u306a\u3044\n * Cookbook\u958b\u767a\u3001\u30c7\u30d0\u30c3\u30b0\u306b\u9069\u3057\u3066\u3044\u308b\n1. LWRP\u3092\u6016\u304c\u3063\u3066\u3057\u307e\u3046\n * \u8a00\u3046\u307b\u3069LWRP\u306e\u5b9f\u88c5\u306f\u96e3\u3057\u304f\u306a\u3044\n1. \u5916\u90e8\u767a\u7965\u3060\u304b\u3089\u5229\u7528\u3057\u306a\u3044\u75c7\u5019\u7fa4\u306b\u9665\u3063\u3066\u3057\u307e\u3046\n * \u307e\u305a\u4f7f\u3048\u308b\u3082\u306e\u304c\u3042\u308b\u304b\u63a2\u3057\u3001\u5909\u66f4\u304c\u5fc5\u8981\u306a\u3089\u30b3\u30f3\u30c8\u30ea\u30d3\u30e5\u30fc\u30c8\u3059\u308b\n1. \u5b64\u72ec\u306aChef\u4f7f\u3044\u306b\u306a\u3063\u3066\u3057\u307e\u3046\n * \u3042\u308b\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\u306b\u81ea\u5206\u3088\u308a\u8a73\u3057\u3044\u30e1\u30f3\u30d0\u30fc\u304c\u3044\u308b\u306a\u3089\u4efb\u305b\u3001\u30c1\u30fc\u30e0\u3067\u8cac\u4efb\u3092\u6301\u3064\n\n## \u30ec\u30b7\u30d4\u3092\u30c1\u30a7\u30c3\u30af\u3059\u308b\n\n\nhttp://acrmp.github.io/foodcritic/\n\n```bash\ngem i foodcritic\nfoodcritic -C .\n```\n\n[FC001](http://acrmp.github.io/foodcritic/#FC001)\u306a\u3069\u8b66\u544a\u306e\u5185\u5bb9\u306b\u3064\u3044\u3066\u306f\u30b5\u30a4\u30c8\u306b\u8f09\u3063\u3066\u3044\u308b\u3002\n\n### FC001\u4ee5\u5916\u3092\u30c1\u30a7\u30c3\u30af\u3059\u308b\n\n``FC001``\u306fdeprecated\u306b\u306a\u3063\u305f\u3002``FC001``\u3092\u9664\u5916\u3057\u3066\u691c\u8a3c\u3059\u308b\u306b\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u3059\u308b\u3002\n\n```bash\nfoodcritic -t ~FC001 site-cookbooks\n```\n\n\n## \u30ed\u30b0\u3092\u51fa\u3059\n\n[log](http://docs.opscode.com/resource_log.html)\u30ea\u30bd\u30fc\u30b9\u3092\u4f7f\u3046\u3002\u3067\u3082\u30ec\u30b7\u30d4\u306e\u4e00\u6642\u7684\u306a\u30c7\u30d0\u30c3\u30b0\u306a\u3089ruby\u306e``puts``\u3084``p``\u3067\u3082\u3044\u3044\u304b\u3082\u3057\u308c\u306a\u3044\u3002\n\n```ruby\nlog \"a debug string\" do\n  level :debug\nend\n\nlog \"message\" do\n  message \"This is the message that will be added to the log.\"\n  level :info\nend\n```\n\n## Vagrant\u306e\u30d7\u30ed\u30d3\u30b8\u30e7\u30cb\u30f3\u30b0\u3067\u30ed\u30b0\u30ec\u30d9\u30eb\u3092\u5909\u66f4\u3059\u308b\n\n``log_level``\u5c5e\u6027\u3092\u4f7f\u3046\u3002\nhttp://docs.vagrantup.com/v2/provisioning/chef_common.html\n\n```ruby\nconfig.vm.provision :chef_solo do |chef|\n  chef.log_level = :debug\n```\n\n## node\u306e\u5c5e\u6027\u3092\u51fa\u529b\u3059\u308b\n\n\u3068\u308a\u3042\u3048\u305ajson\u3067\n\n```ruby\nputs JSON.pretty_generate(node)\n```\n\n\u307e\u305f\u306f\u30ec\u30b7\u30d4\u5185\u3067\u4f7f\u3044\u305d\u3046\u306a\u3082\u306e\u3060\u3051\u78ba\u8a8d\u3002\n\n```ruby\n[:platform, :platform_version, :ipaddress, :fqdn, :hostname, :domain].each do |key|\n  puts \"node['#{key}'] = #{node[key]}\"\nend\n```\n\n## \u7f6e\u304d\u63db\u308f\u3063\u305f\u30d5\u30a1\u30a4\u30eb\u306e\u30d0\u30c3\u30af\u30a2\u30c3\u30d7\u3092\u898b\u308b\n\n``template``\u30ea\u30bd\u30fc\u30b9\u306a\u3069\u3067\u30d5\u30a1\u30a4\u30eb\u3092\u7f6e\u304d\u63db\u3048\u305f\u5834\u5408\u306b\u3001\u5143\u306e\u30d5\u30a1\u30a4\u30eb\u306f\u30ea\u30e2\u30fc\u30c8\u30b5\u30fc\u30d0\u306e ``/var/chef/backup/`` \u306b\u4fdd\u5b58\u3055\u308c\u3066\u3044\u308b\u3002\n\n\n\n## \u30d1\u30b9\u30ef\u30fc\u30c9\u306e\u30cf\u30c3\u30b7\u30e5\u3092\u751f\u6210\u3059\u308b\n\nUnix\u3067\u306f\u30d1\u30b9\u30ef\u30fc\u30c9\u3092 ``$\uff1c\u30cf\u30c3\u30b7\u30e5\u65b9\u5f0f\uff1e$\uff1csalt\uff1e$\uff1c\u30cf\u30c3\u30b7\u30e5\u5f8c\u306e\u30d1\u30b9\u30ef\u30fc\u30c9\uff1e`` \u3067\u8868\u73fe\u3057\u3066\u3044\u308b\u3002\u4ee5\u4e0b\u306e\u30b3\u30de\u30f3\u30c9\u3067\u305d\u308c\u306b\u5bfe\u5fdc\u3057\u305fMD5\u306ehash\u3092\u51fa\u529b\u3067\u304d\u308b\u3002\n\n```bash\nopenssl passwd -1 'password'\n```\n\n## Environment\u3067\u5206\u5c90\u3059\u308b\n\n``node.chef_environment`` \u3092\u898b\u308b\n\n```ruby\nif node.chef_environment == 'development'\nend\n```\n\n## OS\u3067\u5206\u5c90\u3059\u308b\n\n### OS\n\n```ruby\ncase node[\"platform\"]\nwhen \"debian\", \"ubuntu\"\n  # do debian/ubuntu things\nwhen \"redhat\", \"centos\", \"fedora\"\n  # do redhat/centos/fedora things\nend\n```\n\n### OS\u30ab\u30c6\u30b4\u30ea\n\nxx\u7cfb\u3067\u5206\u5c90\u3059\u308b\u5834\u5408\u3002yum\u304bapt\u3067package\u540d\u304c\u5909\u308f\u3063\u305f\u308a\u30d1\u30b9\u304c\u5909\u308f\u3063\u305f\u308a\u3059\u308b\u3068\u304d\u306a\u3069\u3067\u4f7f\u3046\u3002\n\n```ruby\ncase node[\"platform_family\"]\nwhen \"debian\"\n  # do things on debian-ish platforms (debian, ubuntu, linuxmint)\nwhen \"rhel\"\n  # do things on RHEL platforms (redhat, centos, scientific, etc)\nend\n```\n\n## \u30c6\u30f3\u30dd\u30e9\u30ea\u30d5\u30a1\u30a4\u30eb\u306e\u30d1\u30b9\u3092\u7d44\u307f\u7acb\u3066\u308b\n\nfoodcritic \u306e [FC013](http://acrmp.github.io/foodcritic/#FC013)\u3067 ``/tmp`` \u3067\u306f\u306a\u304f ``Chef::Config[:file_cache_path]`` \u3092\u4f7f\u3048\u3068\u3042\u308b\u3002\n\n```ruby\nremote_file \"#{Chef::Config[:file_cache_path]}/large-file.tar.gz\" do\n  source \"http://www.example.org/large-file.tar.gz\"\nend\n```\n\n## \u4e8b\u524d\u306b\u7528\u610f\u3057\u305f\u9759\u7684\u30d5\u30a1\u30a4\u30eb\u3092\u914d\u7f6e\u3059\u308b\n\n[cookbook_file](http://docs.opscode.com/resource_cookbook_file.html)\u30ea\u30bd\u30fc\u30b9\u3092\u4f7f\u3046\u3002\n\n\u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u306f\u30d5\u30a1\u30a4\u30eb\u306f\u4e0a\u66f8\u304d\u306b\u306a\u308b\u3002\u4e0a\u66f8\u304d\u304c\u56f0\u308b\u5834\u5408\u306f ``action: create_if_missing`` \u3084 ``not_if {File.exist?}`` \u306a\u3069\u3092\u4f7f\u3046\u3002\n\n\n```ruby\n# files/default/testfile\ncookbook_file \"/#{Chef::Config[:file_cache_path]}/testfile\" do\n  source \"testfile\"\n  mode 00644\n  owner 'root'\n  group 'root'\nend\n```\n\n\n\u914d\u7f6e\u3059\u308b\u5143\u30d5\u30a1\u30a4\u30eb\u306f\u4ee5\u4e0b\u306e\u9806\u756a\u3067 ``files`` \u306e\u30b5\u30d6\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u304b\u3089\u691c\u7d22\u3055\u308c\u308b\u3002\n\n1. \u30db\u30b9\u30c8\u540d ``host-#{node[:fqdn]}``\n1. OS-\u30d5\u30eb\u30d0\u30fc\u30b8\u30e7\u30f3 ``#{node[:platform]}-#{node[:platform_version]}``\n1. OS-\u30e1\u30b8\u30e3\u30fc\u30d0\u30fc\u30b8\u30e7\u30f3 ``#{node[:platform]}-#{version_components}``\n1. OS ``node[:platform]``\n1. ``default``\n\n```\nfiles/\n   host-foo.example.com\n   ubuntu-10.04\n   ubuntu-10\n   ubuntu\n   default\n```\n\n## \u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u3092\u4f7f\u3063\u3066\u30d5\u30a1\u30a4\u30eb\u3092\u914d\u7f6e\u3059\u308b\n\n[template](http://docs.opscode.com/resource_template.html)\u30ea\u30bd\u30fc\u30b9\u3092\u4f7f\u3046\u3002\n\n[cookbook_file](http://docs.opscode.com/resource_cookbook_file.html)\u30ea\u30bd\u30fc\u30b9\u3068\u306e\u9055\u3044\u306f\u7528\u610f\u3067\u304d\u308b\u30d5\u30a1\u30a4\u30eb\u304cerb\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u3067\u3042\u308a\u52d5\u7684\u306b\u51fa\u529b\u3092\u5909\u3048\u3089\u308c\u308b\u3068\u3053\u308d\u3002\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u306e\u30c7\u30d5\u30a9\u30eb\u30c8\u306e\u30b3\u30f3\u30c6\u30ad\u30b9\u30c8\u306f``node``\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3067\u3001``variables``\u5c5e\u6027\u3067\u4efb\u610f\u306ehash\u3092\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u306b\u6e21\u3059\u3053\u3068\u3082\u53ef\u80fd\u3002\n\n```ruby\ntemplate \"/etc/apache2/ports.conf\" do\n  source 'apache/ports.conf.erb'\n  mode '0644'\nend\n```\n\n\u30bd\u30fc\u30b9\u306e\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u30d5\u30a1\u30a4\u30eb\u306f ``files`` \u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3067\u306f\u306a\u304f\u3001``templates`` \u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u914d\u7f6e\u3059\u308b\u3002\n\n```\ntemplates/\n   host-foo.example.com\n   ubuntu-10.04\n   ubuntu-10\n   ubuntu\n   default\n```\n\n## \u66f8\u304d\u63db\u3048\u3066\u3057\u307e\u3063\u305f\u30d5\u30a1\u30a4\u30eb\u306e\u524d\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u3092\u898b\u308b\n\n[cookbook_file](http://docs.opscode.com/resource_cookbook_file.html)\u30ea\u30bd\u30fc\u30b9\u3084[template](http://docs.opscode.com/resource_template.html)\u30ea\u30bd\u30fc\u30b9\u3067\u65e2\u5b58\u306e\u30d5\u30a1\u30a4\u30eb\u3092\u4e0a\u66f8\u304d\u3057\u3066\u3057\u307e\u3063\u305f\u5834\u5408\u306b\u4e16\u4ee3\u30d0\u30c3\u30af\u30a2\u30c3\u30d7\u304c``/var/chef/backup`` \u306b\u3042\u308b\u3002\n\n## \u7a7a\u306e\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u6210\u3059\u308b\n\n[file](http://docs.opscode.com/resource_file.html)\u30ea\u30bd\u30fc\u30b9\u306e``: create_if_missing``\u30a2\u30af\u30b7\u30e7\u30f3\u3092\u4f7f\u3046\u3002(\u30d5\u30a1\u30a4\u30eb\u304c\u7121\u3044\u6642\u9650\u5b9a)\n\n```ruby\nfile \"/tmp/something\" do\n  action :create_if_missing\nend\n```\n\n## \u30d5\u30a1\u30a4\u30eb\u3092\u524a\u9664\u3059\u308b\n\n[file](http://docs.opscode.com/resource_file.html)\u30ea\u30bd\u30fc\u30b9\u3092\u4f7f\u3046\u3002\n\n```ruby\nfile \"/tmp/something\" do\n  action :delete\nend\n```\n\n\u524a\u9664\u5bfe\u8c61\u304c\u30b7\u30f3\u30dc\u30ea\u30c3\u30af\u30ea\u30f3\u30af\u306e\u5834\u5408\u306f\u8b66\u544a\u304c\u3067\u308b\u306e\u3067\u3001[link](http://docs.opscode.com/resource_link.html)\u30ea\u30bd\u30fc\u30b9\u3092\u4f7f\u3046\u306e\u304c\u30a8\u30ec\u30ac\u30f3\u30c8\u3002\n\n```ruby\nlink \"/tmp/mylink\" do\n  action :delete\n  only_if \"test -L /tmp/mylink\"\nend\n```\n\n## \u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092\u4f5c\u6210\u3059\u308b\n\n[directory](http://docs.opscode.com/resource_directory.html)\u30ea\u30bd\u30fc\u30b9\u3092\u4f7f\u3046\u3002\n\n```ruby\ndirectory \"/var/lib/foo\" do\n  owner \"root\"\n  group \"root\"\n  mode 00755\n  action :create\nend\n```\n\n\u89aa\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u304c\u5b58\u5728\u3057\u306a\u3044\u3068\u5931\u6557\u3059\u308b\u3002``recursive true``\u3092\u3064\u3051\u308b\u3068\u89aa\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092\u518d\u5e30\u7684\u306b\u4f5c\u6210\u3059\u308b\u3002\n\n## \u30b7\u30f3\u30dc\u30ea\u30c3\u30af\u30ea\u30f3\u30af\u3092\u4f5c\u6210\u3059\u308b\n\n[link](http://docs.opscode.com/resource_link.html)\u30ea\u30bd\u30fc\u30b9\u3092\u4f7f\u3046\u3002\n\n```ruby\nlink \"/tmp/passwd\" do\n  to \"/etc/passwd\"\nend\n\nlink \"/tmp/passwd\" do\n  to \"/etc/passwd\"\n  link_type :hard\nend\n\nlink \"/tmp/mylink\" do\n  action :delete\n  only_if \"test -L /tmp/mylink\"\nend\n```\n\n## \u30d5\u30a1\u30a4\u30eb\u304c\u306a\u3051\u308c\u3070\u30ea\u30bd\u30fc\u30b9\u3092\u5b9f\u884c\u3059\u308b\n\n``not_if``\u3067\u30d5\u30a1\u30a4\u30eb\u3092\u30c1\u30a7\u30c3\u30af\u3059\u308b\u3002\n\n```ruby\nexecute \"create file hoge\" do\n  command \"touch /tmp/hoge\"\n  not_if {File.exist?(\"/tmp/hoge\")}\nend\n```\n\n``Dir.exist?`` \u3082\u4f7f\u3048\u308b(ruby\u306e\u4e16\u754c)\n\n\n## \u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3059\u308b\n\n[execute](http://docs.getchef.com/resource_execute.html)\u30ea\u30bd\u30fc\u30b9\u3092\u4f7f\u3046\u3002\n\n```ruby\nexecute 'bundle install' do\n  cwd '/myapp'\n  not_if 'bundle check' # This is not run inside /myapp\nend\n```\n\n## \u30b7\u30a7\u30eb\u30d5\u30a1\u30a4\u30eb\u3092\u5b9f\u884c\u3059\u308b\n\n\u6b63\u78ba\u306b\u306f\u4ee5\u4e0b\u306e\u4f8b\u306f[bash](http://docs.opscode.com/resource_bash.html)\u30ea\u30bd\u30fc\u30b9\u304b\u3089\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3002\n\n```ruby\nbash \"install_ruby_build\" do\n  cwd \"#{Chef::Config[:file_cache_path]}/ruby-build\"\n  user \"rbenv\"\n  group \"rbenv\"\n  code <<-EOH\n    ./install.sh\n  EOH\n  environment 'PREFIX' => \"/usr/local\"\nend\n```\n\n## Git\u30ea\u30dd\u30b8\u30c8\u30ea\u304b\u3089\u30d5\u30a1\u30a4\u30eb\u3092\u53d6\u5f97\u3059\u308b\n\n[git](http://docs.opscode.com/resource_git.html)\u30ea\u30bd\u30fc\u30b9\u3092\u4f7f\u3046\u3002``revision``\u5c5e\u6027\u306b\u30bf\u30b0\u306a\u3069\u3092\u6307\u5b9a\u3067\u304d\u308b\u3002\n\n```ruby\ngit \"/home/#{node[:user]}/redmine\"  do\n  repository \"git://github.com/edavis10/redmine.git\"\n  revision '2.5.1'\n  user node[:user]\n  group node[:user]\nend\n```\n\n## \u30a6\u30a7\u30d6\u306b\u3042\u308b\u30a2\u30fc\u30ab\u30a4\u30d6\u30d5\u30a1\u30a4\u30eb\u3092\u5c55\u958b\u3059\u308b\n\n[remote_file](http://docs.opscode.com/resource_remote_file.html)\u30ea\u30bd\u30fc\u30b9\u3067\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3002[bash](http://docs.opscode.com/resource_bash.html)\u30ea\u30bd\u30fc\u30b9\u3067\u5c55\u958b\u3002\n\n```ruby\n#  the following code sample is similar to the ``upload_progress_module`` recipe in the ``nginx`` cookbook: https://github.com/opscode-cookbooks/nginx\n\nsrc_filename = \"foo123-nginx-module-v#{node['nginx']['foo123']['version']}.tar.gz\"\nsrc_filepath = \"#{Chef::Config['file_cache_path']}/#{src_filename}\"\nextract_path = \"#{Chef::Config['file_cache_path']}/nginx_foo123_module/#{node['nginx']['foo123']['checksum']}\"\n\nremote_file src_filepath do\n  source node['nginx']['foo123']['url']\n  checksum node['nginx']['foo123']['checksum']\n  owner 'root'\n  group 'root'\n  mode 00644\nend\n\nbash 'extract_module' do\n  cwd ::File.dirname(src_filepath)\n  code <<-EOH\n    mkdir -p #{extract_path}\n    tar xzf #{src_filename} -C #{extract_path}\n    mv #{extract_path}/*/* #{extract_path}/\n    EOH\n  not_if { ::File.exist?(extract_path) }\nend\n```\n## hosts\u30d5\u30a1\u30a4\u30eb\u306b\u30a8\u30f3\u30c8\u30ea\u3092\u8ffd\u52a0\u3059\u308b\n\n``hostsfile`` cookbook \u3092\u8ffd\u52a0\u3057\u3001[hostsfile_entry](https://github.com/customink-webops/hostsfile) \u30ea\u30bd\u30fc\u30b9\u3092\u4f7f\u3046\u3002\n\n```ruby\nhostsfile_entry '1.2.3.4' do\n  hostname  'www2.example.com'\n  aliases   ['foo.com', 'foobar.com']\n  comment   'Append by Recipe X'\n  action    :append\nend\n```\n\n## \u30d5\u30a1\u30a4\u30eb\u3092\u7f6e\u304d\u63db\u3048\u305f\u306e\u3067\u30b5\u30fc\u30d3\u30b9\u3092\u518d\u8d77\u52d5\u3059\u308b\n\n[Notifications](http://docs.getchef.com/resource_common.html#notifications)\u3092\u4f7f\u3046\u3002\n\n```\ntemplate '/etc/httpd/conf/httpd.conf' do\n  source 'httpd/httpd.conf.erb'\n  notifies :restart, 'service[httpd]'\nend\nservice 'httpd' do\n  action [ :enable ]\nend\n```\n\n``notifies``\u3067\u6307\u5b9a\u3059\u308b\u30ea\u30bd\u30fc\u30b9\u540d\u304c\u5b58\u5728\u3057\u306a\u3044\u3068\u3044\u3051\u306a\u3044\u306e\u3067 [service](http://docs.getchef.com/resource_service.html)\u30ea\u30bd\u30fc\u30b9\u3067 ``:enable`` \u3084 ``:nothing``\u306a\u3069\u306eAction\u3067\u8a18\u8ff0\u3057\u3066\u304a\u304f\u3002\n\n\n## Ohai\u3067\u53d6\u5f97\u3057\u3066\u4f7f\u3048\u308b\u5c5e\u6027\n\n|\u5c5e\u6027|\u8aac\u660e|\n|:--|:--|\n|node['platform']|node\u306e\u30d7\u30e9\u30c3\u30c8\u30d5\u30a9\u30fc\u30e0|\n|node['platform_version']|\u30d7\u30e9\u30c3\u30c8\u30d5\u30a9\u30fc\u30e0\u306e\u30d0\u30fc\u30b8\u30e7\u30f3|\n|node['ipaddress']|IP\u30a2\u30c9\u30ec\u30b9\u3002node\u304c\u30c7\u30d5\u30a9\u30eb\u30c8\u30eb\u30fc\u30c8\u3092\u6301\u3063\u3066\u3044\u308b\u5834\u5408\u306fIPv4\u30a2\u30c9\u30ec\u30b9\u3001\u3082\u3063\u3066\u3044\u306a\u3044\u5834\u5408\u306fnil|\n|node['macaddress']|MAC\u30a2\u30c9\u30ec\u30b9|\n|node['fqdn']|\u5b8c\u5168\u4fee\u98fe\u30c9\u30e1\u30a4\u30f3\u540d|\n|node['hostname']|\u30db\u30b9\u30c8\u540d|\n|node['domain']|\u30c9\u30e1\u30a4\u30f3|\n|node['recipes']|\u95a2\u9023\u4ed8\u3051\u3089\u308c\u305f\u30ec\u30b7\u30d4\u306e\u30ea\u30b9\u30c8|\n|node['roles']|\u95a2\u9023\u4ed8\u3051\u3089\u308c\u305frole\u306e\u30ea\u30b9\u30c8|\n|node['ohai_time']|Ohai\u304c\u6700\u5f8c\u306b\u5b9f\u884c\u3055\u308c\u305f\u6642\u523b\u3002knife status\u30b5\u30d6\u30b3\u30de\u30f3\u30c9\u3067\u30b5\u30fc\u30d0\u306b\u4fdd\u5b58\u3057\u53c2\u7167\u3067\u304d\u308b|\n\n\n\n\n"}