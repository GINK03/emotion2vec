{"context": " More than 1 year has passed since last update.\n\nInstall packages\n\ngit\ncurl\n\nsudo aptitude install git curl build-essential libssl-dev libmysqlclient-dev\n\n\nCreate user\nCreate redmine user:\nsudo adduser \\\n  --system \\\n  --shell /bin/sh \\\n  --gecos 'redmine' \\\n  --group \\\n  --disabled-password \\\n  --home /home/redmine \\\n  redmine\n\n\nCreate database\nmysql -uroot -p\n\nmysql> create database redmine;\nmysql> grant all on redmine.* to redmine@localhost identified by \"poli1kew\";\nmysql> quit\n\n\nLogin with redmine\nBe redmine user:\nsudo su - redmine -s /bin/bash\n\nInstall rvm:\nbash -s stable < <(curl -s https://raw.github.com/wayneeseguin/rvm/master/binscripts/rvm-installer)\n\nEnable .bashrc config:\nbash .bashrc\n\nNow you'll need to ask RVM if it needs any more programs and if so you'll need to install them to do this type:\nrvm requirements\n\noutput example:\n# For Ruby / Ruby HEAD (MRI, Rubinius, & REE), install the following:\n  ruby: /usr/bin/apt-get install build-essential openssl libreadline6 libreadline6-dev curl git-core zlib1g zlib1g-dev libssl-dev libyaml-dev libsqlite3-dev sqlite3 libxml2-dev libxslt-dev autoconf libc6-dev ncurses-dev automake libtool bison subversion\n\nExit redmine and install requirements:\nexit\nsudo aptitude install build-essential openssl libreadline6 libreadline6-dev curl git-core zlib1g zlib1g-dev libssl-dev libyaml-dev libsqlite3-dev sqlite3 libxml2-dev libxslt-dev autoconf libc6-dev ncurses-dev automake libtool bison subversion\n\nBe redemine again:\nsudo su - redmine -s /bin/bash\n\nConfirm available ruby versions:\nrvm list known\n\nInstall ruby 1.8.7:\nrvm install 1.8.7\n\nSwitch to ruby 1.8.7:\nrvm 1.8.7\n\nCreate gemset 'redmine':\nrvm gemset create redmine\n\nInstall gems:\ngem install mysql   --no-ri --no-rdoc\ngem install rack    --no-ri --no-rdoc -v=1.1.0\ngem install unicorn --no-ri --no-rdoc\ngem install i18n    --no-ri --no-rdoc -v=0.4.2\n\n\nInstall redmine\nFetch redmine package via wget:\ncd\nwget http://rubyforge.org/frs/download.php/75910/redmine-1.3.2.tar.gz\ntar xzvf redmine-1.3.2.tar.gz\n\nCreate symbolic link:\nln -s redmine-1.3.2 redmine\ncd redmine\n\nSetup database config:\ncp config/database.yml.example config/database.yml\n\n\ndatabase.yml\nproduction:\n  adapter: mysql\n  database: redmine\n  host: localhost\n  username: redmine\n  password: poli1kew\n  encoding: utf8\n\n\n\u30bb\u30c3\u30b7\u30e7\u30f3\u30b9\u30c8\u30a2\u79d8\u5bc6\u9375\u3092\u751f\u6210\u3057\u3066\u304f\u305f\u3099\u3055\u3044:\nrake config/initializers/session_store.rb\n\n\u30c6\u3099\u30fc\u30bf\u30d8\u3099\u30fc\u30b9\u4e0a\u306b\u30c6\u30fc\u30d5\u3099\u30eb\u3092\u4f5c\u6210\u3057\u3066\u304f\u305f\u3099\u3055\u3044\u3002Redmine\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u30c6\u3099\u30a3\u30ec\u30af\u30c8\u30ea\u3066\u3099\u4e0b\u8a18\u30b3\u30de\u30f3\u30c8\u3099\u3092\u5b9f\u884c\u3057\u307e\u3059:\nRAILS_ENV=production rake db:migrate\n\n\u4e0b\u8a18\u30b3\u30de\u30f3\u30c8\u3099\u3092\u5b9f\u884c\u3057\u3001\u30c6\u3099\u30d5\u30a9\u30eb\u30c8\u30c6\u3099\u30fc\u30bf\u3092\u30c6\u3099\u30fc\u30bf\u30d8\u3099\u30fc\u30b9\u306b\u767b\u9332\u3057\u3066\u304f\u305f\u3099\u3055\u3044:\nRAILS_ENV=production rake redmine:load_default_data\n\nLogout redmine:\nexit\n\n\nunicorn \u3066\u3099 redmine \u3092\u8d77\u52d5\u3059\u308b\u305f\u3081\u9811\u5f35\u308b\nunicorn \u306e\u30b3\u30f3\u30d5\u30a3\u30af\u3099\u3092\u66f8\u304f\n\n\u30ef\u30fc\u30ab\u30d5\u309a\u30ed\u30bb\u30b9\u306f\uff12\u3064\nfork \u5f8c\u306b\u5b9f\u884c\u30e6\u30fc\u30b5\u3099\u3092 redmine \u3078\u5909\u66f4\u3059\u308b\n\nsudo vim /home/redmine/redmine/config/unicorn.conf\n\n\nunicorn.conf\n$unicorn_user = \"redmine\"\n$unicorn_group = \"redmine\"\n\nworker_processes 2\nworking_directory '/home/redmine/redmine'\n\nlisten      \"127.0.0.1:50008\", :tcp_nopush => true\ntimeout     30\n\npid         \"tmp/pids/unicorn.pid\"\nstderr_path \"log/unicorn.log\"\nstdout_path \"log/unicorn.log\"\n\npreload_app  true\n\nbefore_fork do |server, worker|\n  defined?(ActiveRecord::Base) and ActiveRecord::Base.connection.disconnect!\nend\n\nafter_fork do |server, worker|\n  defined?(ActiveRecord::Base) and ActiveRecord::Base.establish_connection\n\n  begin\n    uid, gid = Process.euid, Process.egid\n    user, group = $unicorn_user, $unicorn_group\n    target_uid = Etc.getpwnam(user).uid\n    target_gid = Etc.getgrnam(group).gid\n    worker.tmp.chown(target_uid, target_gid)\n    if uid != target_uid or gid != target_gid\n      Process.initgroups(user, target_gid)\n      Process::GID.change_privilege(target_gid)\n      Process::UID.change_privilege(target_uid)\n    end\n  rescue\n    if RAILS_ENV = \"development\"\n      STDERR.puts \"could not change user, oh well\"\n    else\n      raise e\n    end\n  end\nend\n\n\n\u8d77\u52d5\u30b9\u30af\u30ea\u30d5\u309a\u30c8\u3092\u66f8\u304f:\nsudo vim /etc/init.d/redmine\n\n\nredmine\n#!/bin/bash\n#\n# unicorn_rails_redmine Startup script for unicorn.\n#\n# chkconfig: - 85 15\n# description: redmine on unicorn start/stop script.\n#\n\n#\n# set rvm environment valiables.\n#\nexport PATH=/home/redmine/.rvm/gems/ruby-1.8.7-p358@redmine/bin:/home/redmine/.rvm/gems/ruby-1.8.7-p358@global/bin:/home/redmine/.rvm/gems/ruby-1.8.7-p358/bin:/home/redmine/.rvm/rubies/ruby-1.8.7-p358/bin:/home/redmine/.rvm/bin:/usr/kerberos/bin:/usr/local/bin:/bin:/usr/bin:/home/redmine/bin\nexport GEM_HOME=/home/redmine/.rvm/gems/ruby-1.8.7-p358@redmine\nexport GEM_PATH=/home/redmine/.rvm/gems/ruby-1.8.7-p358@redmine:/home/redmine/.rvm/gems/ruby-1.8.7-p358@global:/home/redmine/.rvm/gems/ruby-1.8.7-p358\nexport BUNDLE_PATH=\nexport MY_RUBY_HOME=/home/redmine/.rvm/rubies/ruby-1.8.7-p358\nexport IRBRC=/home/redmine/.rvm/rubies/ruby-1.8.7-p358/.irbrc\n\nset -u\nset -e\n\nAPP_NAME=redmine\nAPP_ROOT=\"/home/redmine/$APP_NAME\"\nCNF=\"$APP_ROOT/config/unicorn.conf\"\nPID=\"$APP_ROOT/tmp/pids/unicorn.pid\"\nENV=production\n\nUNICORN_OPTS=\"-D -E $ENV -c $CNF\"\n\nold_pid=\"$PID.oldbin\"\n\ncd $APP_ROOT || exit 1\n\nsig () {\n        test -s \"$PID\" && kill -$1 `cat $PID`\n}\n\noldsig () {\n        test -s $old_pid && kill -$1 `cat $old_pid`\n}\n\ncase ${1-help} in\nstart)\n        sig 0 && echo >&2 \"Already running\" && exit 0\n        cd $APP_ROOT ; unicorn_rails $UNICORN_OPTS\n        ;;\nstop)\n        sig QUIT && exit 0\n        echo >&2 \"Not running\"\n        ;;\nforce-stop)\n        sig TERM && exit 0\n        echo >&2 \"Not running\"\n        ;;\nrestart|reload)\n        sig HUP && echo reloaded OK && exit 0\n        echo >&2 \"Couldn't reload, starting instead\"\n        unicorn_rails $UNICORN_OPTS\n        ;;\nupgrade)\n        sig USR2 && exit 0\n        echo >&2 \"Couldn't upgrade, starting instead\"\n        unicorn_rails $UNICORN_OPTS\n        ;;\nrotate)\n        sig USR1 && echo rotated logs OK && exit 0\n        echo >&2 \"Couldn't rotate logs\" && exit 1\n        ;;\n*)\n        echo >&2 \"Usage: $0 <start|stop|restart|upgrade|rotate|force-stop>\"\n        exit 1\n        ;;\nesac\n\n\nEnable boot script:\nsudo chmod +x /etc/init.d/redmine\nsudo rcconf \n\nStart redmine:\nsudo service redmine start\n\n\nIntegrate unicorn with nginx\nStop apache if running:\nsudo service apache2 stop\n\nInstall nginx:\nsudo aptitude install nginx\n\nCreate config file for nginx:\nsudo vim /etc/nginx/sites-available/redmine.suin.org\n\n\n/etc/nginx/sites-available/redmine.suin.org\nupstream redmine {\n    server 127.0.0.1:50008;\n}\n\nserver {\n    listen 80;\n    server_name redmine.suin.org;\n\n    location / {\n\n        root /home/redmine/redmine/public;\n\n        if (!-f $request_filename) {\n            proxy_pass http://redmine; \n            break;\n        }\n    }\n\n}\n\n\nsudo ln -s /etc/nginx/sites-available/redmine.suin.org /etc/nginx/sites-enabled/redmine.suin.org\n\nStart nginx:\nsudo service nginx start\n\n\n## Install packages\n\n* git\n* curl\n\n```\nsudo aptitude install git curl build-essential libssl-dev libmysqlclient-dev\n```\n\n## Create user\n\nCreate ```redmine``` user:\n\n```\nsudo adduser \\\n  --system \\\n  --shell /bin/sh \\\n  --gecos 'redmine' \\\n  --group \\\n  --disabled-password \\\n  --home /home/redmine \\\n  redmine\n```\n\n## Create database\n\n```\nmysql -uroot -p\n```\n\n```\nmysql> create database redmine;\nmysql> grant all on redmine.* to redmine@localhost identified by \"poli1kew\";\nmysql> quit\n```\n\n## Login with redmine\n\nBe ```redmine``` user:\n\n```\nsudo su - redmine -s /bin/bash\n```\n\nInstall ```rvm```:\n\n```\nbash -s stable < <(curl -s https://raw.github.com/wayneeseguin/rvm/master/binscripts/rvm-installer)\n```\n\nEnable ```.bashrc``` config:\n\n```\nbash .bashrc\n```\n\nNow you'll need to ask RVM if it needs any more programs and if so you'll need to install them to do this type:\n\n\n```\nrvm requirements\n```\n\noutput example:\n\n```\n# For Ruby / Ruby HEAD (MRI, Rubinius, & REE), install the following:\n  ruby: /usr/bin/apt-get install build-essential openssl libreadline6 libreadline6-dev curl git-core zlib1g zlib1g-dev libssl-dev libyaml-dev libsqlite3-dev sqlite3 libxml2-dev libxslt-dev autoconf libc6-dev ncurses-dev automake libtool bison subversion\n```\n\nExit redmine and install requirements:\n\n```\nexit\nsudo aptitude install build-essential openssl libreadline6 libreadline6-dev curl git-core zlib1g zlib1g-dev libssl-dev libyaml-dev libsqlite3-dev sqlite3 libxml2-dev libxslt-dev autoconf libc6-dev ncurses-dev automake libtool bison subversion\n```\n\nBe redemine again:\n\n```\nsudo su - redmine -s /bin/bash\n```\n\nConfirm available ruby versions:\n\n```\nrvm list known\n```\n\nInstall ruby 1.8.7:\n\n```\nrvm install 1.8.7\n```\n\nSwitch to ruby 1.8.7:\n\n```\nrvm 1.8.7\n```\n\nCreate gemset 'redmine':\n\n```\nrvm gemset create redmine\n```\n\nInstall gems:\n\n```\ngem install mysql   --no-ri --no-rdoc\ngem install rack    --no-ri --no-rdoc -v=1.1.0\ngem install unicorn --no-ri --no-rdoc\ngem install i18n    --no-ri --no-rdoc -v=0.4.2\n```\n\n## Install redmine \n\nFetch redmine package via wget:\n\n```\ncd\nwget http://rubyforge.org/frs/download.php/75910/redmine-1.3.2.tar.gz\ntar xzvf redmine-1.3.2.tar.gz\n```\n\nCreate symbolic link:\n\n```\nln -s redmine-1.3.2 redmine\ncd redmine\n```\n\nSetup database config:\n\n```\ncp config/database.yml.example config/database.yml\n```\n\n```yaml:database.yml\nproduction:\n  adapter: mysql\n  database: redmine\n  host: localhost\n  username: redmine\n  password: poli1kew\n  encoding: utf8\n```\n\n\u30bb\u30c3\u30b7\u30e7\u30f3\u30b9\u30c8\u30a2\u79d8\u5bc6\u9375\u3092\u751f\u6210\u3057\u3066\u304f\u305f\u3099\u3055\u3044:\n\n```\nrake config/initializers/session_store.rb\n```\n\n\u30c6\u3099\u30fc\u30bf\u30d8\u3099\u30fc\u30b9\u4e0a\u306b\u30c6\u30fc\u30d5\u3099\u30eb\u3092\u4f5c\u6210\u3057\u3066\u304f\u305f\u3099\u3055\u3044\u3002Redmine\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u30c6\u3099\u30a3\u30ec\u30af\u30c8\u30ea\u3066\u3099\u4e0b\u8a18\u30b3\u30de\u30f3\u30c8\u3099\u3092\u5b9f\u884c\u3057\u307e\u3059:\n\n```\nRAILS_ENV=production rake db:migrate\n```\n\n\u4e0b\u8a18\u30b3\u30de\u30f3\u30c8\u3099\u3092\u5b9f\u884c\u3057\u3001\u30c6\u3099\u30d5\u30a9\u30eb\u30c8\u30c6\u3099\u30fc\u30bf\u3092\u30c6\u3099\u30fc\u30bf\u30d8\u3099\u30fc\u30b9\u306b\u767b\u9332\u3057\u3066\u304f\u305f\u3099\u3055\u3044:\n\n```\nRAILS_ENV=production rake redmine:load_default_data\n```\n\nLogout redmine:\n\n```\nexit\n```\n\n## unicorn \u3066\u3099 redmine \u3092\u8d77\u52d5\u3059\u308b\u305f\u3081\u9811\u5f35\u308b\n\nunicorn \u306e\u30b3\u30f3\u30d5\u30a3\u30af\u3099\u3092\u66f8\u304f\n\n* \u30ef\u30fc\u30ab\u30d5\u309a\u30ed\u30bb\u30b9\u306f\uff12\u3064\n* fork \u5f8c\u306b\u5b9f\u884c\u30e6\u30fc\u30b5\u3099\u3092 redmine \u3078\u5909\u66f4\u3059\u308b\n\n```\nsudo vim /home/redmine/redmine/config/unicorn.conf\n```\n\n```unicorn.conf\n$unicorn_user = \"redmine\"\n$unicorn_group = \"redmine\"\n\nworker_processes 2\nworking_directory '/home/redmine/redmine'\n\nlisten      \"127.0.0.1:50008\", :tcp_nopush => true\ntimeout     30\n\npid         \"tmp/pids/unicorn.pid\"\nstderr_path \"log/unicorn.log\"\nstdout_path \"log/unicorn.log\"\n\npreload_app  true\n\nbefore_fork do |server, worker|\n  defined?(ActiveRecord::Base) and ActiveRecord::Base.connection.disconnect!\nend\n\nafter_fork do |server, worker|\n  defined?(ActiveRecord::Base) and ActiveRecord::Base.establish_connection\n\n  begin\n    uid, gid = Process.euid, Process.egid\n    user, group = $unicorn_user, $unicorn_group\n    target_uid = Etc.getpwnam(user).uid\n    target_gid = Etc.getgrnam(group).gid\n    worker.tmp.chown(target_uid, target_gid)\n    if uid != target_uid or gid != target_gid\n      Process.initgroups(user, target_gid)\n      Process::GID.change_privilege(target_gid)\n      Process::UID.change_privilege(target_uid)\n    end\n  rescue\n    if RAILS_ENV = \"development\"\n      STDERR.puts \"could not change user, oh well\"\n    else\n      raise e\n    end\n  end\nend\n```\n\n\u8d77\u52d5\u30b9\u30af\u30ea\u30d5\u309a\u30c8\u3092\u66f8\u304f:\n\n```\nsudo vim /etc/init.d/redmine\n```\n\n```sh:redmine\n#!/bin/bash\n#\n# unicorn_rails_redmine Startup script for unicorn.\n#\n# chkconfig: - 85 15\n# description: redmine on unicorn start/stop script.\n#\n\n#\n# set rvm environment valiables.\n#\nexport PATH=/home/redmine/.rvm/gems/ruby-1.8.7-p358@redmine/bin:/home/redmine/.rvm/gems/ruby-1.8.7-p358@global/bin:/home/redmine/.rvm/gems/ruby-1.8.7-p358/bin:/home/redmine/.rvm/rubies/ruby-1.8.7-p358/bin:/home/redmine/.rvm/bin:/usr/kerberos/bin:/usr/local/bin:/bin:/usr/bin:/home/redmine/bin\nexport GEM_HOME=/home/redmine/.rvm/gems/ruby-1.8.7-p358@redmine\nexport GEM_PATH=/home/redmine/.rvm/gems/ruby-1.8.7-p358@redmine:/home/redmine/.rvm/gems/ruby-1.8.7-p358@global:/home/redmine/.rvm/gems/ruby-1.8.7-p358\nexport BUNDLE_PATH=\nexport MY_RUBY_HOME=/home/redmine/.rvm/rubies/ruby-1.8.7-p358\nexport IRBRC=/home/redmine/.rvm/rubies/ruby-1.8.7-p358/.irbrc\n\nset -u\nset -e\n\nAPP_NAME=redmine\nAPP_ROOT=\"/home/redmine/$APP_NAME\"\nCNF=\"$APP_ROOT/config/unicorn.conf\"\nPID=\"$APP_ROOT/tmp/pids/unicorn.pid\"\nENV=production\n\nUNICORN_OPTS=\"-D -E $ENV -c $CNF\"\n\nold_pid=\"$PID.oldbin\"\n\ncd $APP_ROOT || exit 1\n\nsig () {\n        test -s \"$PID\" && kill -$1 `cat $PID`\n}\n\noldsig () {\n        test -s $old_pid && kill -$1 `cat $old_pid`\n}\n\ncase ${1-help} in\nstart)\n        sig 0 && echo >&2 \"Already running\" && exit 0\n        cd $APP_ROOT ; unicorn_rails $UNICORN_OPTS\n        ;;\nstop)\n        sig QUIT && exit 0\n        echo >&2 \"Not running\"\n        ;;\nforce-stop)\n        sig TERM && exit 0\n        echo >&2 \"Not running\"\n        ;;\nrestart|reload)\n        sig HUP && echo reloaded OK && exit 0\n        echo >&2 \"Couldn't reload, starting instead\"\n        unicorn_rails $UNICORN_OPTS\n        ;;\nupgrade)\n        sig USR2 && exit 0\n        echo >&2 \"Couldn't upgrade, starting instead\"\n        unicorn_rails $UNICORN_OPTS\n        ;;\nrotate)\n        sig USR1 && echo rotated logs OK && exit 0\n        echo >&2 \"Couldn't rotate logs\" && exit 1\n        ;;\n*)\n        echo >&2 \"Usage: $0 <start|stop|restart|upgrade|rotate|force-stop>\"\n        exit 1\n        ;;\nesac\n```\n\nEnable boot script:\n\n```\nsudo chmod +x /etc/init.d/redmine\nsudo rcconf \n```\n\nStart redmine:\n\n```\nsudo service redmine start\n```\n\n## Integrate unicorn with nginx\n\nStop apache if running:\n\n```\nsudo service apache2 stop\n```\n\nInstall nginx:\n\n```\nsudo aptitude install nginx\n```\n\nCreate config file for nginx:\n\n```\nsudo vim /etc/nginx/sites-available/redmine.suin.org\n```\n\n```:/etc/nginx/sites-available/redmine.suin.org\nupstream redmine {\n    server 127.0.0.1:50008;\n}\n\nserver {\n    listen 80;\n    server_name redmine.suin.org;\n\n    location / {\n\n        root /home/redmine/redmine/public;\n\n        if (!-f $request_filename) {\n            proxy_pass http://redmine; \n            break;\n        }\n    }\n\n}\n```\n\n```\nsudo ln -s /etc/nginx/sites-available/redmine.suin.org /etc/nginx/sites-enabled/redmine.suin.org\n```\n\nStart nginx:\n\n```\nsudo service nginx start\n```\n\n\n\n\n", "tags": ["Redmine", "rvm", "unicorn", "Ubuntu", "nginx"]}